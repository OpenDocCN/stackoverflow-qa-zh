# StackOverflow 问答 000543000-000543999

# php - 我的 SQL 触发器

> ID：543000
> 
> 赞同：3
> 
> 时间：2009-02-12T20:03:31.207
> 
> 标签：php, mysql, triggers

是否可以设置一个 mysql 触发器，当数据库中有插入时，它会触发该记录的 id 号，以及如何使用 php 捕获它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T20:18:15.290

除非我不完全理解您的问题，否则您不需要为此触发 - 只需使用数据库驱动程序的“最后插入的 ID”功能。

这是一个在 PHP 中使用基本 mysql 驱动程序的示例。

```
<?php

$db = mysql_connect( 'localhost', 'user', 'pass' );

$result = mysql_query( "insert into table (col1, col2) values ('foo', 'bar')", $db );

$lastId = mysql_insert_id(); 
```

这是一种获取 ID 的安全连接方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T20:32:14.743

如前面的答案所述，您不需要使用触发器来返回身份。您可以使用 [文档][1] 中描述的 mysql_insert_id() 命令。

但是，如果您需要在触发器中使用新的插入 ID，请使用 NEW.[identity_column_name]，如下所示：

```
CREATE TABLE temp (
    temp_id int auto_increment,
    value varchar(10),
    PRIMARY_KEY(temp_id)
);

CREATE TRIGGER after_insert_temp AFTER INSERT ON temp
FOR EACH ROW 
BEGIN
    DECLARE @identity;
    SET @identity = NEW.temp_id;
    -- do something with @identity
END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T20:15:06.873

我不确定你在问什么。您是否想在数据库中插入一行并获取分配给它的 id？如果是这样，请这样做

printf("最后插入的记录有 id %d\n", mysql_insert_id());

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T20:20:02.773

您不需要触发器来完成您正在尝试做的事情。

简单地调用 PHP`mysql_insert_id`将返回从最后执行的 INSERT 查询生成的 ID。

此处描述：http: [//us2.php.net/manual/en/function.mysql-insert-id.php](http://us2.php.net/manual/en/function.mysql-insert-id.php)

# asp.net - ASP.net GridView 控件是一个巧妙的设计吗？

> ID：543026
> 
> 赞同：3
> 
> 时间：2009-02-12T20:09:48.697
> 
> 标签：asp.net, gridview, crud

很长一段时间以来我一直在使用gridview。我和它有一种“不能和你一起生活，也不能没有你”的关系。

从网格内编辑、插入和删除的想法很棒，但必须做类似的事情

```
var sometext = ((TextBox)editRow.FindControl("tbSomeText")).Text; 
```

对我来说似乎很不聪明。有没有人想出解决方案或知道（资源）您在哪里执行 CRUD 操作 + 从网格内进行分页和排序，并且不必编写丑陋的代码（如上）。我不是在寻找使用 DataSource 对象的解决方案，因为我不是它的最大粉丝。如果有人能告诉我如何在 asp.net 中没有 GridView 的情况下生活，我会很高兴。

我知道有 AJAX 实现，但我正在寻找完全服务器端的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T20:16:02.393

我总是使用中继器控件而不是其他控件。因为我觉得它很自由。我自己构建了 html，可以做很多事情，比如分页排序。但是当然，您需要为中继器付出更多努力才能实现这些功能。

对于 CRUD 操作，我使用 jQuery 厚框（模态弹出窗口和 iframe）。

我的选择是中继器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T20:38:41.433

如果您正在尝试制作一个基本的 CRUD 网站，请查看[ASP.NET 3.5 Dynamic Data](http://www.asp.net/learn/3.5-SP1/)，这是一个很棒的网站，可以添加为具有 CRUD 能力的纯数据访问网站。但是，它非常可定制。

Gridview 有它的优势，大约两三年前，我曾经在 .Net 2.0 时代喜欢它。但是，从那时起，有了更好的 .Net 3.5 控件（如 ListView），可以让您更好地自定义内容。我还会看看（Telerik、Infragistics、ComponentArt、ComponentOne、DevExpress）的许多第三方网格工具，它们比内置的 gridview 控件具有更多的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T20:55:26.433

我鄙视它，每次我使用它或看到其他开发人员使用它时，他们几乎总是最终选择其他东西。我从未听过任何与我合作过的开发人员说“我喜欢 GridView”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T09:40:58.200

您可以连接 GridView 和 DetailsView，并使用基本的 SQL 脚本或复杂的业务对象以及 DetailsView。

我发现 DetailsView 非常有用。

# c# - 如何判断我的程序运行的机器是否使用超线程？（C＃）

> ID：543039
> 
> 赞同：2
> 
> 时间：2009-02-12T20:15:04.987
> 
> 标签：c#, hyperthreading

我有一些代码需要知道我的特定机器上有多少实际内核可用，以及是否启用了超线程。

有没有办法在 C# 中做到这一点？

更新：这些机器是 XP 和 Vista 的混合体

更新：访问“Win32_Processor.NumberOfCores”或“Win32_Processor.NumberOfLogicalProcessors”会在其中一台机器（但不是全部）上引发异常（带有消息“未找到”的 ManagmentException）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T20:22:54.983

在 Vista 和更高版本上，您可以通过 PInvoke 使用 GetLogicalProcessorInformation 来获取逻辑处理器单元的数量。

在 Windows XP 上，无法通过 C# 可靠地将超线程与其他多处理器/内核配置区分开来。有人发布的 WMI 解决方案将多核处理器归类为超线程。

在 Vista 之前，唯一可靠的方法是检查处理器的 CPUID。要使用它，您可以创建一个可以从托管代码调用的本机 DLL。以下英特尔代码[示例](http://www.mail-archive.com/redhat-devel-list@redhat.com/msg06114.html)将是一个很好的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T20:20:28.670

至少对第一个问题的简单回答：*Environment.ProcessorCount*应该返回机器上的内核数。

**编辑**：[这](http://community.devpinoy.org/blogs/cvega/archive/2006/04/07/2658.aspx)是一种检查是否启用超线程的非基于 WMI 的方法（并不是说它一定更好）。另见[这篇](http://www.codeproject.com/KB/system/countingprocessors.aspx?df=100&forumid=149329&exp=0&select=1577587)文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T20:18:37.600

System.Environment.ProcessorCount 将告诉您运行代码的机器上有多少个内核。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T20:19:14.790

检查 Environment.ProcessorCount 属性，它会返回一个整数，至于超线程，我不确定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T20:24:06.307

[StackOverflow 问题 188503](https://stackoverflow.com/questions/188503/detecting-the-number-of-processors)有你需要的信息...

引用该问题的最佳答案：

```
System.Environment.ProcessorCount 
```

返回逻辑处理器的数量（参见[MSDN](http://msdn.microsoft.com/en-us/library/system.environment.processorcount.aspx?ppud=4)）

要区分超线程和单独的内核，听起来好像您需要一点 WMI。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T20:49:17.010

[GetLogicalProcessorInformation](http://msdn.microsoft.com/en-us/library/ms683194.aspx)足以满足 HT 方面的需求，但遗憾的是它仅在 XP SP3、64 位 XP/Vista/Server 2003 中可用（我相信在 vista 前略有损坏）

[Joe Duffy](http://www.bluebytesoftware.com/blog/CommentView,guid,e1791031-e477-4b8c-b342-933f198ef137.aspx)将其封装在 c# 中，但尚未发布源代码，尽管 Mark Russinovich 已经发布了他用它创建的工具 (Coreinfo)，您可能可以反编译它以查看代码。

# xml - 是否可以从 xml 文档中链接到外部 url？

> ID：543046
> 
> 赞同：0
> 
> 时间：2009-02-12T20:16:54.543
> 
> 标签：xml, hyperlink

我正在使用从 xml 文档中提取图像的 Flash Web 模板。单击图像后，我想从图像链接到网站的另一部分。

以下是文档中的一些示例代码：

```
<gallery id="1" name="public relations">
    <image width="121" height="161" image="images/pr/pr_01.jpg"/> 
```

我希望图像“pr_01.jpg 链接到一个 url。

这可能吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T20:27:54.237

我相信 xml 中的超链接标签是：

```
<test><xhtml:a href="link here">Test Link</xhtml:a></test> 
```

至于单击图像时获取链接，以前没有这样做过。我会继续调查的。

# database - vb2008如何直接读写数据库文件？

> ID：543047
> 
> 赞同：0
> 
> 时间：2009-02-12T20:17:05.230
> 
> 标签：database, vb.net

如何在 vb2008 中使用数据库服务器可读的文件格式读取和写入文件？

我几乎没有使用数据库的经验，而且我似乎找不到任何不涉及某种类型的服务器作为中间人的教程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T20:21:21.257

这实际上取决于您正在使用哪种类型的数据库文件。如果您有 Access 数据库文件，则可以使用以下代码打开与数据库的连接。

```
Dim DBConn as New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\MyDBFile.mdb;") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T20:21:19.307

如果您不想要服务器，请使用 SQLite。有一些 .NET 绑定可以很好地工作。

读取和写入原始数据库文件将是一项艰巨的任务——如果你必须问如何去做，你不应该这样做。它需要做很多工作，以至于片刻都不值得考虑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T20:59:30.230

通常，大多数数据库感知软件使用软件库适配器写入数据库。像[ODBC](http://en.wikipedia.org/wiki/Odbc)。

您可能正在寻找的是批量加载程序可以理解的文件格式。像[这样](http://www.classes.cs.uchicago.edu/archive/2005/fall/23500-1/mysql-load.html)的东西（MySQL 示例）。

# java - 默认 XML 命名空间、JDOM 和 XPath

> ID：543049
> 
> 赞同：13
> 
> 时间：2009-02-12T20:17:41.953
> 
> 标签：java, xml, xpath, jdom

我想使用 JDOM 读取 XML 文件，然后使用 XPath 从 JDOM 文档中提取数据。它可以很好地创建 Document 对象，但是当我使用 XPath 查询 Document 以获取元素列表时，我什么也得不到。

我的 XML 文档在根元素中定义了一个默认命名空间。有趣的是，当我删除默认命名空间时，它成功运行 XPath 查询并返回我想要的元素。我还必须做什么才能让我的 XPath 查询返回结果？

XML:

```
<?xml version="1.0" encoding="UTF-8"?>
<collection xmlns="http://www.foo.com">
<dvd id="A">
  <title>Lord of the Rings: The Fellowship of the Ring</title>
  <length>178</length>
  <actor>Ian Holm</actor>
  <actor>Elijah Wood</actor>
  <actor>Ian McKellen</actor>
</dvd>
<dvd id="B">
  <title>The Matrix</title>
  <length>136</length>
  <actor>Keanu Reeves</actor>
  <actor>Laurence Fishburne</actor>
</dvd>
</collection> 
```

爪哇：

```
public static void main(String args[]) throws Exception {
    SAXBuilder builder = new SAXBuilder();
    Document d = builder.build("xpath.xml");
    XPath xpath = XPath.newInstance("collection/dvd");
    xpath.addNamespace(d.getRootElement().getNamespace());
    System.out.println(xpath.selectNodes(d));
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-12T20:36:35.310

**XPath 1.0**不支持默认命名空间的概念（**XPath 2.0**支持）。任何不带前缀的标签总是被假定为无名命名空间的一部分。

使用**XPath 1.0**时，您需要这样的东西：

```
public static void main(String args[]) throws Exception {
    SAXBuilder builder = new SAXBuilder();
    Document d = builder.build("xpath.xml");
    XPath xpath = XPath.newInstance("x:collection/x:dvd");
    xpath.addNamespace("x", d.getRootElement().getNamespaceURI());
    System.out.println(xpath.selectNodes(d));
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-12T23:13:39.737

我有一个类似的问题，但我的问题是我混合了 XML 输入，其中一些定义了命名空间，而另一些则没有。为了简化我的问题，我在加载文档后运行了以下 JDOM 片段。

```
for (Element el : doc.getRootElement().getDescendants(new ElementFilter())) {
    if (el.getNamespace() != null) el.setNamespace(null);
} 
```

删除所有命名空间后，我可以使用简单的*getChild("elname")*样式导航或简单的 XPath 查询。

我不建议将此技术作为通用解决方案，但在我的情况下它绝对有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-23T03:30:31.020

您还可以执行以下操作

`/*[local-name() = 'collection']/*[local-name() = 'dvd']/`

[这](https://msdn.microsoft.com/en-us/library/ms256086%28v=vs.110%29.aspx)是有用的 xpath 查询列表。

# c++ - 简单的提升提交；建议？

> ID：543062
> 
> 赞同：5
> 
> 时间：2009-02-12T20:19:01.980
> 
> 标签：c++, boost

寻找一些一般性的建议...

我使用 boost 已经有一段时间了，我已经编写了几个小模块和函数（例如：see [this SO question](https://stackoverflow.com/questions/209793/any-way-to-cast-with-class-operator-only)），我认为cold适合包含在boost中。我去过项目页面查看提交过程，但似乎是“在里面，或者不要打扰”。我可以订阅开发人员的邮件列表，但我不确定我是否有资格在那里发帖：我当然对所有各种 boost 模块都不是很熟悉，而且在模板元编程方面也不如群众积极参与。

对于“正常”的人来说，我是否缺少一种途径来为可以纳入提升的事物发送想法？还是 boost 有点像“名义上的开放，除非你把它变成全职工作”类型的项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T20:40:06.907

我认为你不应该犹豫去提升开发。您的代码很可能不会被接受，但很有可能您将能够收集到有价值的反馈并学到很多东西。那里的人会证明为什么它不能以当前的形式被接受，或者如何使给定的功能更通用等等。我认为总的来说它对你是有益的。

如果您对 boost-devel 不满意，请订阅并关注一段时间。还有一些关于阅读/关注列表的个人评论：

*   找出谁是谁——有些人只活跃在非常狭窄的领域，而另一些人往往在许多不同的领域有很多话要说
*   为新邮件创建某种过滤规则（列表的负载相当重） - 有些邮件真的不感兴趣
*   观察提交的图书馆的审查过程，批评意见，建议。
*   订阅 boost-devel、boost 和 boost-users - 他们往往相互关联。如果您对这些项目感兴趣，可以抛出 sprit、threads 和 ublas 列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T21:55:40.017

我一直在关注开发列表一段时间。我的感觉和你一样：也许我和这些人不在同一个联赛，但你确实从那里的讨论中学到了很多东西。

在我在那里的这段时间里，我发现了一些常见的提交模式：首先查询对图书馆的兴趣，然后提供图书馆供审查。注意代码的许可：如果它与 boost 许可不兼容，大多数人甚至都不会看。花时间审查一些专有代码似乎是为别人免费工作。

还可以考虑编写文档和发布，使图书馆可以在互联网上访问，并让其他人使用/查看它。这将增加（不是双关语）你的机会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T23:43:32.520

为什么你的东西必须直接进入 boost ？为什么不先将它“放在那里”并获得您满意的许可证……如果用户对它有足够的兴趣，那么“嘿，这应该是提升”可能是下一个合乎逻辑的步骤，或者不是。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T20:42:57.417

我尝试将我的[UTF-8 CPP](http://utfcpp.sourceforge.net/)库提交给 Boost。从订阅他们的开发邮件列表开始，并发送了几个非正式的审查请求，但觉得它没有任何结果，所以我放弃了，从未提交过正式的审查请求。

祝你提交顺利。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T21:15:28.803

你看过[http://www.boost.org/development/submissions.html](http://www.boost.org/development/submissions.html)吗？

# actionscript-3 - as3 的“玻璃窗格”拦截舞台上所有事物的事件？

> ID：543069
> 
> 赞同：0
> 
> 时间：2009-02-12T20:20:05.037
> 
> 标签：actionscript-3

as3中是否有类似java'glasspane'的东西？

*当您希望能够捕捉事件或在已经包含一个或多个组件的区域上绘画时，玻璃窗格非常有用。例如，您可以通过让玻璃窗格拦截事件来停用多组件区域的鼠标事件。或者，您可以使用玻璃窗格在多个组件上显示图像。* [http://java.sun.com/docs/books/tutorial/uiswing/components/rootpane.html](http://java.sun.com/docs/books/tutorial/uiswing/components/rootpane.html)

为什么要这样做？虽然 Flash 中正在进行一些动画，但我想防止触发任何鼠标事件。我可以系统地删除所有侦听器，然后在动画之后重新添加它们，但如果有类似玻璃板的东西，它可能是实现相同效果的更简单方法。

我目前的想法是：

1.  在舞台上添加精灵
2.  拉伸到舞台的宽度和高度，
3.  给精灵最高的 z 顺序，
4.  抓住这个精灵上的所有事件，并停止它们的传播？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T20:32:10.250

如果你设置

```
enabled=false;
mouseChildren=false; 
```

在最顶层的 DisplayObject 上，它应该为您的应用禁用所有鼠标事件。我用过它，它很管用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-14T21:30:11.737

对于更具体的方法，例如仅阻止点击但让鼠标按下等，我使用这种方法。它在捕获阶段使用“clickBlocker”阶段事件处理程序，停止传播到任何其他对象。

```
public function blockClicks():void{
    if(!stage) return;
    stage.addEventListener(MouseEvent.CLICK, clickBlocker, true); //useCapture!
}

private function clickBlocker(event:MouseEvent):void{
    trace("Me (the stage) gets the "+event.type+" first, and I block it @"+event.stageX+"/"+event.stageY);
    event.stopImmediatePropagation();
} 
```

# c++ - C++ cwchar 错误

> ID：543073
> 
> 赞同：2
> 
> 时间：2009-02-12T20:20:38.093
> 
> 标签：c++, compiler-construction

我正在尝试在 vxWorks gcc 平台上编译 regex_search 函数。我正在用一个例子进行测试，看看我是否可以毫无问题地使用它。示例文件包括以下三个标头。

```
#include <string> 
#include <map> 
#include <boost/regex.hpp> 
```

我得到的错误如下

```
include/c++/3.4.4/cwchar:73: error:   `::mbstate_t' has not been declared
include/c++/3.4.4/cwchar:114: error: `::btowc' has not been declared
.........
.........(similar "not defined" errors)

c++/3.4.4/cwctype:20: error: `::wctrans_t' has not been declared
c++/3.4.4/cwctype:20: error: `::wctype_t' has not been declared
.........
.........(similar "not defined" errors) 
```

我想知道 cwchar 和 cwtype 标头的作用。当我打开它们并查看时，它们包含许多预处理器#ifdefs，它们似乎正在检查编译器特定信息。

我的主管要求我关闭它们。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T20:49:16.230

如果您的主管希望您关闭 cw-support，您可以尝试在项目设置中定义 BOOST_NO_CWCHAR 和 BOOST_NO_CWCTYPE。

见[http://www.boost.org/doc/libs/1_37_0/libs/config/doc/html/boost_config/boost_macro_reference.html](http://www.boost.org/doc/libs/1_37_0/libs/config/doc/html/boost_config/boost_macro_reference.html)

# java - 什么将取代 Java 7 中的 Beans Binding？

> ID：543081
> 
> 赞同：2
> 
> 时间：2009-02-12T20:23:29.320
> 
> 标签：java, beans-binding

我在某处读到 - 链接让我无法理解 - Beans Binding 不会成为 Java 7 的一部分。有人知道什么会取代它吗？

此外，在当前版本的 Java 中是否有任何替代 bean 绑定的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T08:02:52.413

我推荐[JGoodies Binding](https://binding.dev.java.net/)用于字段和[Glazed Lists](http://publicobject.com/glazedlists)用于集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T09:54:25.657

如果它不是 Java 7 的一部分，我怀疑任何东西都会取代它，它可能更像是它没有做到，并且会在以后添加（尽管我不知道任何细节）。一些想法：

*   您可以使用与 Java 5 或更高版本[绑定的 bean](https://beansbinding.dev.java.net/servlets/ProjectDocumentList)（即使它不是 Java 7 的一部分）
*   如果 Swing 不是必需的，您可以考虑[JFace 数据绑定](http://wiki.eclipse.org/index.php/JFace_Data_Binding)

# c# - 用于处理嵌入表单的自定义类

> ID：543087
> 
> 赞同：2
> 
> 时间：2009-02-12T20:26:03.790
> 
> 标签：c#, winforms, generics, .net-3.5, refactoring

我在 C# 中有一个自定义类文件，我继承并部分扩展了它。我现在正试图*重新考虑*它，因为我有足够的专业知识知道使用*泛型*之类的东西（我认为）我可以大大压缩这个类。

作为一个没有经验的独立开发者，我将非常感谢任何可以提供的指导或建设性的批评。

不要温柔！我很感激你的时间，祝你有幸福的一天！我先发制人地为长度感到抱歉。

```
using System.Windows.Forms;
using DevExpress.XtraEditors;
using DevExpress.XtraTab;

namespace psWinForms
{
    public static class WinFormCustomHandling
    {
        public static void ShowXFormInControl(Form frm, 
            ref XtraTabPage ctl, FormBorderStyle style)
        {
            frm.TopLevel = false;
            frm.ControlBox = false;
            frm.Parent = ctl;
            frm.FormBorderStyle = style;
            frm.Left = 0;
            frm.Top = 0;
            frm.Width = ctl.Width + 4;
            frm.Dock = DockStyle.Fill;
            frm.Show();

            //IMPORTANT: .Show() fires a form load event
            frm.BringToFront();
        }

        public static void ShowXFormInControl(Form frm, 
            ref XtraPanel ctl, FormBorderStyle style)
        {
            frm.TopLevel = false;
            frm.ControlBox = false;
            frm.Parent = ctl;
            frm.FormBorderStyle = style;
            frm.Left = 0;
            frm.Top = 0;
            frm.Width = ctl.Width + 4;
            frm.Dock = DockStyle.Fill;
            frm.Show();
            //IMPORTANT: .Show() fires a form load event
            frm.BringToFront();

        }

        public static void ShowXFormInControl(XtraForm Xfrm, 
            ref XtraTabPage ctl, FormBorderStyle style)
        {
            Xfrm.TopLevel = false;
            Xfrm.ControlBox = false;
            Xfrm.Parent = ctl;
            Xfrm.FormBorderStyle = style;
            Xfrm.Left = 0;
            Xfrm.Top = 0;
            Xfrm.Width = ctl.Width + 4;
            Xfrm.Dock = DockStyle.Fill;
            Xfrm.Show();
            //IMPORTANT: .Show() fires a form load event
            Xfrm.BringToFront();

        }

        public static void ShowXFormInControl(XtraForm Xfrm, 
            ref XtraPanel ctl, FormBorderStyle style)
        {
            Xfrm.TopLevel = false;
            Xfrm.ControlBox = false;
            Xfrm.Parent = ctl;
            Xfrm.FormBorderStyle = style;
            Xfrm.Left = 0;
            Xfrm.Top = 0;
            Xfrm.Width = ctl.Width + 4;
            Xfrm.Dock = DockStyle.Fill;
            Xfrm.Show();
            //IMPORTANT: .Show() fires a form load event
            Xfrm.BringToFront();

        }

        public static void ShowFormInControl(Form frm, 
            ref Panel ctl, FormBorderStyle style)
        {
            {
                frm.TopLevel = false;
                frm.ControlBox = false;
                frm.Parent = ctl;
                frm.FormBorderStyle = style;
                frm.Left = 0;
                frm.Top = 0;
                frm.Width = ctl.Width + 4;
                frm.Dock = DockStyle.Fill;
                frm.Show();
                //IMPORTANT: .Show() fires a form load event
                frm.BringToFront();
            }
            //.SetBounds(ctl.Left, ctl.Top, ctl.Width, ctl.Height)
        }
        public static void ShowFormInControl(Form frm, 
            ref TabPage ctl, FormBorderStyle style)
        {
            {
                frm.TopLevel = false;
                frm.ControlBox = false;
                frm.Parent = ctl;
                frm.FormBorderStyle = style;
                frm.Left = 0;
                frm.Top = 0;
                frm.Width = ctl.Width + 4;
                frm.Dock = DockStyle.Fill;
                frm.Show();
                //IMPORTANT: .Show() fires a form load event
                frm.BringToFront();
            }
        }
        public static void ShowFormInControl(Form frm, 
            Panel ctl, FormBorderStyle style, FormWindowState state)
        {
            {
                frm.TopLevel = false;
                frm.ControlBox = false;
                frm.Parent = ctl;
                frm.FormBorderStyle = style;
                frm.Left = 0;
                frm.Top = 0;
                frm.Width = ctl.Width + 4;
                frm.WindowState = state;
                frm.Dock = DockStyle.Fill;
                frm.Show();
                //IMPORTANT: .Show() fires a form load event
                frm.BringToFront();
            }
            //.SetBounds(ctl.Left, ctl.Top, ctl.Width, ctl.Height)
        }
        public static void ShowFormInControl(Form frm, 
            TabPage ctl, FormBorderStyle style, FormWindowState state)
        {
            {
                frm.TopLevel = false;
                frm.ControlBox = false;
                frm.Parent = ctl;
                frm.FormBorderStyle = style;
                frm.Left = 0;
                frm.Top = 0;
                frm.Width = ctl.Width + 4;
                frm.WindowState = state;
                frm.Dock = DockStyle.Fill;
                frm.Show();
                //IMPORTANT: .Show() fires a form load event
                frm.BringToFront();
            }
        }
        public static void ShowFormInControl(Form frm, 
            ref Panel ctl, FormBorderStyle style, int left, int top)
        {
            {
                frm.TopLevel = false;
                frm.ControlBox = false;
                frm.Parent = ctl;
                frm.FormBorderStyle = style;
                frm.Left = left;
                frm.Top = top;
                frm.Width = ctl.Width + 4;
                frm.Dock = DockStyle.Fill;
                frm.Show();
                //IMPORTANT: .Show() fires a form load event
                //.Activate()
                frm.BringToFront();
            }
            //.SetBounds(ctl.Left, ctl.Top, ctl.Width, ctl.Height)
        }
        public static void ShowFormInControl(Form frm, 
            ref TabPage ctl, FormBorderStyle style, int left, int top)
        {
            {
                frm.TopLevel = false;
                frm.ControlBox = false;
                frm.Parent = ctl;
                frm.FormBorderStyle = style;
                frm.Left = left;
                frm.Top = top;
                frm.Width = ctl.Width + 4;
                frm.Dock = DockStyle.Fill;
                frm.Show();
                //IMPORTANT: .Show() fires a form load event
                //.Activate()
                frm.BringToFront();
            }
        }
        public static void ShowFormInControl(Form frm, 
            Panel ctl, FormBorderStyle style, int left, int top, string title)
        {
            {
                frm.TopLevel = false;
                frm.ControlBox = false;
                frm.Parent = ctl;
                frm.FormBorderStyle = style;
                frm.Left = left;
                frm.Top = top;
                frm.Width = ctl.Width + 4;
                frm.Text = title;
                frm.Dock = DockStyle.Fill;
                frm.Show();
                //IMPORTANT: .Show() fires a form load event
                frm.BringToFront();
            }
            //.SetBounds(ctl.Left, ctl.Top, ctl.Width, ctl.Height)
        }
        public static void ShowFormInControl(Form frm, 
            TabPage ctl, FormBorderStyle style, int left, int top, string title)
        {
            {
                frm.TopLevel = false;
                frm.ControlBox = false;
                frm.Parent = ctl;
                frm.FormBorderStyle = style;
                frm.Left = left;
                frm.Top = top;
                frm.Width = ctl.Width + 4;
                frm.Text = title;
                frm.Dock = DockStyle.Fill;
                frm.Show();
                //IMPORTANT: .Show() fires a form load event
                frm.BringToFront();
            }
        }
    }
} 
```

* * *

我有最糟糕的时间在这里发布代码，结果看起来不错！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T13:13:32.837

您不需要泛型来执行此操作：

```
public static void ShowFormInControl(Control ctl, Form frm) {
  frm.TopLevel = false;
  frm.FormBorderStyle = FormBorderStyle.None;  // Others rarely make sense
  frm.Dock = DockStyle.Fill;
  frm.Visible = true;
  ctl.Controls.Add(frm);
} 
```

示例用法：

```
public Form1() {
  InitializeComponent();
  ShowFormInControl(this.panel1, new Form2());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T20:36:18.010

你试过 ReSharper 吗？ [http://www.jetbrains.com/resharper/](http://www.jetbrains.com/resharper/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T20:42:40.113

我不能 100% 确定我从那里得到了所有可能的情况，但是通过泛型和重载，您可以将其压缩成更容易维护的东西。这是我的尝试：

```
using System.Windows.Forms;
using DevExpress.XtraEditors;
using DevExpress.XtraTab;

namespace psWinForms
{
    public static class WinFormCustomHandling
    {
        public static void ShowFormInControl<FormType, ControlType> (FormType frm, ref ControlType ctl, FormBorderStyle style)
          where FormType : Form
          where ControlType : Control
        {
             ShowFormInControl<ControlType>(frm, ref ctl, style, 0, 0);
        }

        public static void ShowFormInControl<FormType, ControlType> (FormType frm, ref ControlType ctl, FormBorderStyle style, FormWindowState? state)
          where FormType : Form
          where ControlType : Control
        {
            if (state.HasValue)
                frm.WindowState = state;
            ShowFormInControl<ControlType>(frm, ref ctl, style, 0, 0);
        }

        public static void ShowFormInControl<FormType, ControlType> (FormType frm, ref ControlType ctl, FormBorderStyle style, int left, int top)
          where FormType : Form
          where ControlType : Control
        {
            ShowFormInControl (frm, ref ctl, style, left, top, null);
        }

        public static void ShowFormInControl<FormType, ControlType> (FormType frm, ref ControlType ctl, FormBorderStyle style, int left, int top, string title)
          where FormType : Form
          where ControlType : Control
        {
            frm.TopLevel = false;
            frm.ControlBox = false;
            frm.Parent = ctl;
            frm.FormBorderStyle = style;
            frm.Left = left;
            frm.Top = top;
            frm.Width = ctl.Width + 4;
            if (null != title)
                frm.Text = title;
            frm.Dock = DockStyle.Fill;
            frm.Show();
            //IMPORTANT: .Show() fires a form load event
            frm.BringToFront();
        }
    }
} 
```

# python - 关于通过 python 发送电子邮件的两个问题（RFC822，登录信息）

> ID：543096
> 
> 赞同：-2
> 
> 时间：2009-02-12T20:31:56.083
> 
> 标签：python, smtp, passwords, rfc822

# 1 -

在我的电子邮件发送脚本中，我将间隔的电子邮件存储在一个字符串中，然后我使用 ", ".join(to.split())。但是，看起来脚本只发送到第一封电子邮件 - 它与 RFC822 格式有关吗？如果是这样，我该如何解决这个问题？

# 2 -

我觉得我的密码在我的脚本中可见有点前卫。有没有办法从 cookie 中检索此信息或从 firefox 中保存密码？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T10:40:48.960

用于或标题`', '.join()`中的列表，但标题仅用于显示。决定邮件实际去向的是 RCPT 信封。假设您使用的是 smtplib，这是第二个参数：`To:``Cc:`

```
connection.sendmail(senderaddress, to.split(), mailtext) 
```

2：这是可能的，但远非简单。浏览器不希望外部程序查看其对安全敏感的存储数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T15:30:45.817

对于您问题的第二部分，您可以查看 netrc 模块（[http://docs.python.org/library/netrc.html](http://docs.python.org/library/netrc.html)）。

这并不比脚本中的密码好多少，但它确实允许使用计算机的任何人读取脚本，而您的主目录中的文件中只有您可以读取密码。

# silverlight - Silverlight 套接字或数据库请求？

> ID：543100
> 
> 赞同：1
> 
> 时间：2009-02-12T20:32:37.970
> 
> 标签：silverlight, chat

我目前正在为一项任务编写一个基于回合的在线 rpg。在游戏中玩家可以互相聊天并在完成一个回合后发送他们的动作。处理玩家之间数据交换的最佳方式是什么。套接字或将所有信息存储在数据库中，并且程序会定期请求检查任何更新？除非有更好的方法。

请注意，这款游戏的规模很大，即很多玩家会同时在同一个服务器上玩多款游戏，所以我必须尽量提高效率。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T20:54:36.670

在 Silverlight 中，您只能连接回为 Silverlight 应用程序提供服务的主机，因此排除了客户端-客户端套接字。您游戏中的所有内容（包括聊天）都必须通过服务器进行。

Windows Communication Foundation (WCF) 非常适合在 Silverlight2 中使用。让你的游戏回合制让事情变得更容易一些，因为这意味着你不必在玩家之间实时保持完全相同的游戏状态（即：不以最大 100 毫秒的延迟为目标）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T20:35:14.453

如果可能，请使用 WCF。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T15:33:53.697

有两种主要的可能性。您可以应用**Sockets**通信，也可以使用**Duplex WCF**。以下是权衡：

套接字 => 性能优于较低的生产力
双工 WCF => 性能较差但生产力更高

对于这两种场景，网上都有一些很好的例子，但如果决定使用 WCF 解决方案，这里有一些资源：

Peter McG的一个[非常好的教程](http://petermcg.wordpress.com/2008/09/03/silverlight-polling-duplex-part-1-architecture/)。
来自 msdn 的有关[双工 WCF 的信息。](http://msdn.microsoft.com/en-us/library/cc645026(VS.95).aspx)

# sql - 语法错误

> ID：543101
> 
> 赞同：3
> 
> 时间：2009-02-12T20:32:54.477
> 
> 标签：sql

下面的陈述有什么问题？我不断收到以下错误消息.... 服务器：消息 156，级别 15，状态 1，第 4 行 关键字“THEN”附近的语法不正确。

```
update oildatasetstatus
set oildatasetstatusid = 
    case 
    WHEN 5 THEN 16        
    WHEN 6 THEN 17        
    WHEN 7 THEN 18        
    WHEN 8 THEN 18        
    WHEN 9 THEN 18        
    WHEN 10 THEN 19        
    WHEN 11 THEN 20    
    End
where oildatasetlabstatusid in 
(
                select oildatasetstatusid
                from OilDataSetStatus
                inner join OilDataSet on OilDataSet.OilDataSetID = 
                    OilDataSetStatus.OilDataSetID
                where SamplePointID in 
                (
                                select SamplePointID 
                                from SamplePoint
                                where CustomerSiteID in
                                (
                                                select CustomerSiteID
                                                from CustomerSite
                                                where CustomerID = 2
                                )
                )
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T20:37:52.000

我认为您缺少要在 CASE 语句中评估的语句。

```
update oildatasetstatus set oildatasetstatusid =
case oildatasetstatusid
 WHEN 5 THEN 16
 WHEN 6 THEN 17
 WHEN 7 THEN 18
 WHEN 8 THEN 18
 WHEN 9 THEN 18
 WHEN 10 THEN 19
 WHEN 11 THEN 20
End
where oildatasetlabstatusid in ( select oildatasetstatusid from OilDataSetStatus inner join OilDataSet on OilDataSet.OilDataSetID = OilDataSetStatus.OilDataSetID where SamplePointID in ( select SamplePointID from SamplePoint where CustomerSiteID in ( select CustomerSiteID from CustomerSite where CustomerID = 2 ) ) ) 
```

试一试？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T20:45:40.780

您的案例陈述没有要处理的对象。

你可以通过两种方式做到这一点：

```
set oildatasetstatusid = 
    case oildatasetstatusid
    WHEN 5 THEN 16        
    WHEN 6 THEN 17        
    WHEN 7 THEN 18        
    WHEN 8 THEN 18        
    WHEN 9 THEN 18        
    WHEN 10 THEN 19        
    WHEN 11 THEN 20    
    End 
```

或者

```
set oildatasetstatusid = 
    case 
    WHEN oildatasetstatusid = 5 THEN 16        
    WHEN oildatasetstatusid = 6 THEN 17        
    WHEN oildatasetstatusid = 7 THEN 18        
    WHEN oildatasetstatusid = 8 THEN 18        
    WHEN oildatasetstatusid = 9 THEN 18        
    WHEN oildatasetstatusid = 10 THEN 19        
    WHEN oildatasetstatusid = 11 THEN 20    
    End 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T20:36:24.357

看起来您的 case 语句需要指定针对给定值测试哪一列。

例如：

```
 update  oildatasetstatus
    set     oildatasetstatusid = case WHEN oildatasetstatusid = 5 THEN 16
                                      WHEN oildatasetstatusid = 6 THEN 17
                                      WHEN oildatasetstatusid = 7 THEN 18
                                      WHEN oildatasetstatusid = 8 THEN 18
                                      WHEN oildatasetstatusid = 9 THEN 18
                                      WHEN oildatasetstatusid = 10 THEN 19
                                      WHEN oildatasetstatusid = 11 THEN 20
                                 End
    where   oildatasetlabstatusid in (
            select  oildatasetstatusid
            from    OilDataSetStatus
                    inner join OilDataSet on OilDataSet.OilDataSetID = OilDataSetStatus.OilDataSetID
            where   SamplePointID in (
                    select  SamplePointID
                    from    SamplePoint
                    where   CustomerSiteID in ( select  CustomerSiteID
                                                from    CustomerSite
                                                where   CustomerID = 2 ) ) ) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T21:07:41.677

您现在对语句进行编码的方式将起作用（一旦您将列引用添加到 case 语句，正如其他帖子所提到的那样），但是，让您的其余语法不被注释会在您的情况下对其他人造成伤害.

虽然您可能只需要运行一次此查询，但我和其他人遇到了类似的情况，其中一个`Update`到多个行还依赖于远离我们源的 3 或 4 个表的数据，并且必须运行多次（如在报告中）。

通过将子选择折叠到单个`select`语句中并将结果保存到`#Temp`表或`@Table`变量中，您只需进行一次查找，然后从结果集中选择进行更新。

下面是一个使用 @table 变量的示例：

```
declare @OilStatus table (oilDatasetStatusID int)
insert into @OilStatus
    select odss.oildatasetstatusid
    from OildataSetStatus odss
    join oilDataSet ods on ods.OilDataSetID = odss.OilDataSetID
    join SamplePoint sp on sp.SamplePointID = odss.SamplePointID
    join CustomerSite cs on cs.CustomerSiteID = sp.CustomerSiteID
    where cs.CustomerID = 2

update oildatasetstatus
set oildatasetstatusid = 
    case oildatasetstatusid
        WHEN 5 THEN 16        
        WHEN 6 THEN 17        
        WHEN 7 THEN 18        
        WHEN 8 THEN 18        
        WHEN 9 THEN 18        
        WHEN 10 THEN 19        
        WHEN 11 THEN 20    
end
where oildatasetlabstatusid in ( select oilDatasetStatusID from @OilStatus ) 
```

由于我没有您的确切架构，因此在尝试实现上述示例时可能会出现错误，但我认为您会明白的。

此外，每当在单个语句中使用多个表时，请尝试在每个列名前加上别名或完整的表名。它有助于防止 sql 引擎和阅读您的代码的人迷路。

# precision - 使用泰勒级数避免精度损失

> ID：543104
> 
> 赞同：1
> 
> 时间：2009-02-12T20:33:48.077
> 
> 标签：precision, numerical-analysis, taylor-series, significance

我正在尝试使用泰勒级数来开发一个数值合理的算法来解决一个函数。我已经有一段时间了，但还没有运气。我不确定我做错了什么。

功能是

```
f(x)=1 + x - sin(x)/ln(1+x)   x~0 
```

另外：为什么这个函数甚至会出现精度损失？当 x 接近于零时，sin(x)/ln(1+x) 甚至不接近与 x 相同的数字。我看不出意义在哪里消失了。

为了解决这个问题，我相信我需要对 sin(x) 和 ln(1+x) 使用泰勒展开，它们是

```
x - x^3/3! + x^5/5! - x^7/7! + ... 
```

和

```
x - x^2/2 + x^3/3 - x^4/4 + ... 
```

分别。我曾尝试使用相似的分母来组合 x 和 sin(x)/ln(1+x) 分量，甚至将这三个分量组合起来，但最终似乎没有任何效果。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T20:51:51.933

可能会出现精度损失，因为当`x ~ 0`,`ln(1+x)`也接近 0 时，您最终会除以一个非常小的数字。计算机在这方面不是很擅长；-)

如果你`ln(1+x)`直接使用泰勒级数，那会有点痛苦，因为你最终会被无穷多个项除。对于这样的情况，我通常更喜欢从定义中计算整个函数的泰勒级数：

```
f(x) = f(0) + f'(0) x + f''(0) x/2 + f'''(0) x/6 + ... 
```

你会从中得到

```
f(x) = 2 + 3x/2 - x^2/4 - x^3/24 - x^4/240 - 23x^5/1440 + 31x^6/2880 ... 
```

（我作弊并将其插入 Mathematica ;-) 就像史蒂夫所说，这个系列并没有很快收敛，尽管我现在想不出更好的方法。

*编辑*：我想我误读了这个问题——如果你想做的只是找到函数的零点，那么肯定有比使用泰勒级数更好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T20:47:25.470

由于这是家庭作业，我只想尝试在正确的方向上给出一些指示。

## 解决方案 1

不要使用 Talyor 级数近似，而是尝试简单地使用[求根算法](http://en.wikipedia.org/wiki/Root-finding_algorithm)，例如 Newton-Raphson 方法、线性插值或区间二分法（甚至将它们组合起来）。它们非常易于实现，并且有了适当地选择起始值，根可以很快收敛到精确的值。

## 解决方案 2

如果您出于某种原因确实需要使用泰勒级数近似，则只需扩展 sin(x)、ln(x) 和其他任何内容。（乘以 ln(x) 以删除您案例中的分母将起作用）。然后你需要使用某种多项式方程求解器。如果您想要合理的准确度，则需要超越我想象的 3 次或 4 次方，这意味着简单的分析解决方案并不容易。但是，您可能想要研究像[Durand-Kerner 方法](http://en.wikipedia.org/wiki/Durand-Kerner_method)这样的方法来求解任意阶的一般多项式。不过，如果您需要使用高阶项，这种方法只会导致并发症，所以我肯定会推荐解决方案 1。

希望有帮助...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T20:50:04.433

我认为您需要查看 ln(x+1) 在 x -->0 时会发生什么，您会明白为什么这个函数在 x = 0 附近表现不佳。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T20:40:15.317

我没有仔细研究过这个，但你应该知道一些泰勒级数收敛得非常非常缓慢。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T20:48:42.457

直接计算 f 的泰勒级数即可。

[Maxima](http://en.wikipedia.org/wiki/Maxima_(software))给了我（关于 x=0 的前 4 个术语）：

```
(%i1) f(x):=1 + x - sin(x)/log(1+x);
                                           - sin(x)
(%o1)                     f(x) := 1 + x + ----------
                                          log(1 + x)

(%i2) taylor(f(x),x,0,4);
                                2    3    4
                           x   x    x    x
(%o2)/T/                   - + -- + -- + --- + . . .
                           2   4    24   240 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-15T18:24:01.290

所使用的方法是正确的 - 只要确保您的计算器处于弧度模式。

# drupal - 在 Drupal 5 中将不同的默认内容过滤器分配给不同用户角色的最佳方法是什么

> ID：543105
> 
> 赞同：1
> 
> 时间：2009-02-12T20:34:36.280
> 
> 标签：drupal

情况是这样的：我希望一个用户组将一个过滤器作为博客的默认过滤器，而另一组 - 另一个过滤器，不会影响其他内容类型的过滤器默认设置。我知道有几个模块可以解决这个问题，但你将如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T21:02:25.217

查看[默认过滤器](http://drupal.org/project/default_filter)模块---我认为这应该做你想要的。它允许为每种内容类型的每个角色设置默认内容过滤器，并允许对每个默认值进行加权（因此，如果用户具有多个角色，则一个默认值优于另一个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T01:19:48.107

我是[Filter Default](http://drupal.org/project/filter_default)模块的粉丝，但如果您使用的是 Drupal 6 ，他们会将用户指向[Better Formats模块。](http://drupal.org/project/better_formats)

因此，如果您使用 Drupal 6，请使用[Better Formats](http://drupal.org/project/better_formats)。Drupal 5 使用[过滤器默认值](http://drupal.org/project/filter_default)

-埃德

# http - WCF 有自己的网络服务器吗？

> ID：543108
> 
> 赞同：1
> 
> 时间：2009-02-12T20:34:59.277
> 
> 标签：http, windows-services, wcf-binding

我只是偶然发现，托管在 Windows 服务中的 WCF 服务不适用于 HTTP 绑定。它似乎实现了自己的 Web 服务器，但我从未在任何地方看到过这种功能，也找不到任何关于 HTTP 侦听器功能的文档（就工作线程等而言）。有人有指针吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T20:39:07.220

如果你用谷歌搜索自托管和 WCF，你会找到大量的信息。通过这种方式可以获得 WCF 的全部功能。该服务可以接受多个调用，WCF 可以为您执行多线程。您还可以查看 WCF REST 入门工具包以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T20:40:36.437

好吧，如果它要支持任何使用 HTTP 协议的东西，那么它的定义必须是一个 Web 服务器。

这些能力是服务主机的能力。无论您为限制设置什么，都将成为服务器的功能。

但是，如果您要在服务上承担大量负载，您可能需要考虑在 IIS 中托管，因为它在应用程序回收、容错等方面提供了更多功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T20:41:35.093

[System.ServiceModel.ServiceHost](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.aspx)是你的意思吗？wcf 配置和 ServiceBehavior 允许您设置并发设置等。

# iphone - iphone - 以编程方式设置（系统范围）代理设置？

> ID：543111
> 
> 赞同：7
> 
> 时间：2009-02-12T20:35:24.063
> 
> 标签：iphone, cocoa, cocoa-touch, proxy

我是 iPhone 开发的新手，所以如果这是一个愚蠢的问题，我很抱歉。我正在开发一个应用程序，其目的是通过我公司的代理路由所有 iPhone 活动。

有没有办法在 iPhone 中以编程方式设置系统范围的代理设置（这也将在 3G 连接上生效）？

我知道有一种方法可以为每个 wifi 连接手动设置代理设置。检测新网络并在其上设置代理是可以接受的。但是，我还需要能够在 3G 连接上设置代理。

另外，奖金：有没有办法以编程方式更改“限制”设置？

如果有人有任何提示或可以指出我正确的方向，我将不胜感激。谢谢。

编辑：请理解这是出于合法目的。苹果必须批准应用商店的添加，所以这不像是我试图传播病毒。请仅提供建设性的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-22T13:12:37.843

如果您在商业环境中配置 iPhone，您应该查看[企业部署指南](http://manuals.info.apple.com/en_US/Enterprise_Deployment_Guide.pdf)。具体来说，您应该考虑使用 iPhone 配置实用程序来创建一个 *.mobileconfig 配置文件，该配置文件可以分发到您网络中的所有电话。*.mobileconfig plist 支持在手机上更改以下代理配置设置：

```
PropNetProxiesHTTPEnable (Integer, 1 = Proxy enabled)
PropNetProxiesHTTPProxy (String, Proxy server address)
PropNetProxiesHTTPPort (Integer, Proxy port number)
HTTPProxyUsername (String, optional username)
HTTPProxyPassword (String, optional password)
PropNetProxiesProxyAutoConfigEnable (Integer, 1 = Auto proxy enabled)
PropNetProxiesProxyAutoConfigURLString (String, URL that points to a PAC file where the configuration information is stored) 
```

iPhone 配置实用程序当前不支持添加或编辑这些设置，因此您可能需要亲自使用 Property List Editor 应用程序。此外，最新版本的企业部署指南似乎不包含我在上面包含的设置，但您应该能够在[文档的先前版本中](https://zivwiki.uni-muenster.de/pub/Anleitungen/Ipod_Touch_Und_Iphone/Enterprise_Deployment_Guide.pdf)找到它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-12T22:15:35.197

很确定这在 Apple 提供的 SDK 沙​​箱之外。不过可能有越狱的可能。

# .net - 添加插件支持：要继承的接口或基类？

> ID：543116
> 
> 赞同：3
> 
> 时间：2009-02-12T20:36:18.693
> 
> 标签：.net, inheritance, plugins, interface, extensibility

我正在为我的 .NET 应用程序添加插件支持。基类对我来说听起来很合理，因此人们可以继承它并**覆盖**某些调用，也可以保留默认功能或使用一些内部帮助函数。

为什么我要选择接口而不是基插件类来继承？你能告诉我应该选择哪种设计，为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T21:13:27.343

您应该考虑查看 System.Addin (MAF) 命名空间或托管可扩展性框架 (MEF)。MEF 将是首选，即使它仍然是预发布版本，因为它比 MAF 简单得多。这些选择中的任何一个都简化了您需要执行的大量管道工作，以便加载加载项并与它们进行交互。

至于在接口和抽象类之间做出选择，如果您使用 MAF 或 MEF，其中一些将为您完成。在这种情况下，最基本的区别是，通过提供抽象基类，您可以为自定义插件（由您或其他开发人员编写）提供继承点，并确保某些方法/属性提供默认行为并强制派生类实现某些所需的方法/属性。缺点是您仅限于单个基类。

接口绕过单一基类限制，仍然为自定义插件提供继承点，并确保实现某些方法/属性但不能提供任何类型的默认行为。您也不能在接口中指定除公共成员之外的任何内容，而抽象类可以具有抽象或虚拟非公共成员（通常是受保护的）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T20:40:06.017

使用插件合约的接口。如果某种类型的插件可能共享某些功能，请创建一个实现该接口的抽象基类。还要确保您的合同在实际应用程序之外的程序集中。

请记住，在 .NET 中，您没有多重继承。**要求**实现者放弃他们的继承槽来为他们提供一点功能并不是一个好主意。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T20:48:23.050

为什么它必须是一个或另一个？

您可以将插件必须遵循的合同定义为随处引用的接口。

另外，您还可以定义一个实现该接口的基类，但只有一些抽象方法会被一些您无法为其提供默认实现的接口函数调用。

```
public interface IPlugin
{
    void Initialize ();
    void Stuff ();
}

public class PluginBase : IPlugin
{
    protected abstract DoInitialize ();
    protected abstract DoStuff ();

    void IPlugin.Initialize { this.DoInitialize (); }
    void IPlugin.Stuff { this.DoStuff (); }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T20:39:56.423

这里有一篇关于这个主题的好帖子： [插件 API 设计](https://stackoverflow.com/questions/351498/plugin-api-design)

我个人会使用一个接口，让插件实现所有细节。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T20:40:18.280

我认为你应该做的显而易见的事情是让插件为它想要处理的单个事件注册回调（委托）。这是大多数框架在 .net 中的工作方式

换句话说，既不是基类也不是接口。此解决方案的优点是您的插件不必符合任何给定的外部接口或基类，它只需注册它需要的功能。

例如，任何给定的 asp.net 控件中的“事件”部分都是这样做的：看看[UserControl](http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol_events.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-21T16:26:34.723

每个人都忘记提及的是向后兼容性。您可以在不破坏现有客户端的情况下向基类添加新方法，而您无法修改现有接口而不影响它们。

有一些替代方法可以避免接口的兼容性问题。例如，当您为应用程序包含新扩展时，您可以创建一个从旧接口继承的新接口。但这有一个缺点，即使用 IClientInterfaceV2 和 IClientInterfaceV3 等类型使您的体系结构膨胀。

我个人的建议是采用一种类似于*scwagner*建议的方法，并创建一个基类和一个接口。并包括对接口用户的警告，说明未来的版本可能会破坏其实现，并且建议使用基类继承策略以避免未来的兼容性问题。

# visual-studio-2008 - 软件补丁/更新/升级上的数据库更改管理

> ID：543119
> 
> 赞同：0
> 
> 时间：2009-02-12T20:36:31.300
> 
> 标签：visual-studio-2008, deployment, change-management

几周以来，我一直在尝试通过示例找到更详细的解释，如何管理软件补丁上的数据库更改。

情况：

*   我将 wpf 应用程序版本部署给用户。应用程序使用 MSSQL 数据文件来存储应用程序的数据（使用客户端配置文件和 SqlServer Compact 3.5 先决条件进行部署）
*   在进一步的开发数据库模式更改中，我也添加了一些额外的数据
*   我正在尝试使用 Visual Studio 2008 发布和 msi 运行补丁/次要/主要升级

我想更新用户应用程序和数据库文件，但不触摸存储在该数据库中的数据。似乎很容易，但我无法在网上找到如何通过 Visual Studio 发布来完成这项工作

到目前为止，我收集到的有 2 个选择：

*   为每个版本创建 sql 更新脚本，并在修补后的第一个程序启动时尝试更新数据库。
*   创建数据库设置项目并尝试从那里编写脚本（不知道如何执行此操作）。

我很高兴听到你们中的一些人正在使用或会使用这种情况。一些示例链接/详细说明如何 todo 会很棒。我不太擅长这个部署/数据库的东西......但是......:)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T21:07:16.797

在我当前的项目中，我们使用了一种称为持续数据库集成的技术。

我们将所有 sql 更改脚本（可以是创建/更改表、存储过程，还可以迁移数据等）收集到 ac# 项目中，并与软件的其余部分同时部署它们。

使用这种技术，我们可以确保所有开发人员数据库也是最新的，因为它集成在 Visual Studio 构建系统中。

我们为本地构建和部署运行此 MSBuild 脚本。它检查数据库中的版本号，并运行任何具有更高版本号的脚本。

我不太喜欢 MSBuild，但它完成了工作。

Martin Fowler 有一篇关于[进化数据库设计](http://martinfowler.com/articles/evodb.html)的文章，其中有一些背景知识。

如果您使用 SQL Server 管理工作室进行更改，您可以使用“生成更改脚本”让它为您编写更改脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T20:50:49.440

这篇关于“ [.Net 中的 Rails 样式数据库迁移](http://www.infoq.com/news/2009/01/migrations_dotnet)”的文章可能会有用。自从 Rails 兴起以来，已经有很多关于数据库迁移最佳实践的工作，这些工作可以在其他语言和平台中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-14T22:36:07.510

如果您将 Installer 类添加到您的 DLL 或 EXE 中，它将在安装过程中调用它的 Install 方法（请查看我们的 MSDN 了解详细信息，VS 可以为您制作一个迷你安装程序，然后您可以复制骨架和属性）。然后，您可以针对 CE 运行 SQL 命令并备份现有的 CE 文件，甚至在出现问题时进行回滚（安装程序类具有在整个设置级别上遵循完整跨国步骤的方法 - 最重要的事情 :-)

# java - Java 2D 和调整大小

> ID：543130
> 
> 赞同：4
> 
> 时间：2009-02-12T20:39:10.730
> 
> 标签：java, image, resize, 2d, image-scaling

我有一些想要重用的旧 Java 2D 代码，但我想知道，这是获得最高质量图像的最佳方式吗？

```
 public static BufferedImage getScaled(BufferedImage imgSrc, Dimension dim) {

    //  This code ensures that all the pixels in the image are loaded.
    Image scaled = imgSrc.getScaledInstance(
            dim.width, dim.height, Image.SCALE_SMOOTH);

    // This code ensures that all the pixels in the image are loaded.
    Image temp = new ImageIcon(scaled).getImage();

    // Create the buffered image.
    BufferedImage bufferedImage = new BufferedImage(temp.getWidth(null), 
            temp.getHeight(null), BufferedImage.TYPE_INT_RGB);

    // Copy image to buffered image.
    Graphics g = bufferedImage.createGraphics();
    // Clear background and paint the image.
    g.setColor(Color.white);
    g.fillRect(0, 0, temp.getWidth(null),temp.getHeight(null));
    g.drawImage(temp, 0, 0, null);
    g.dispose();

    // j2d's image scaling quality is rather poor, especially when
    // scaling down an image to a much smaller size. We'll post filter  
    // our images using a trick found at 
    // http://blogs.cocoondev.org/mpo/archives/003584.html
    // to increase the perceived quality....
    float origArea = imgSrc.getWidth() * imgSrc.getHeight();
    float newArea = dim.width * dim.height;
    if (newArea <= (origArea / 2.)) {
        bufferedImage = blurImg(bufferedImage);
    }

    return bufferedImage;
}

public static BufferedImage blurImg(BufferedImage src) {
    // soften factor - increase to increase blur strength
    float softenFactor = 0.010f;
    // convolution kernel (blur)
    float[] softenArray = {
            0,              softenFactor,       0, 
            softenFactor, 1-(softenFactor*4), softenFactor, 
            0,              softenFactor,       0};

    Kernel kernel = new Kernel(3, 3, softenArray);
    ConvolveOp cOp = new ConvolveOp(kernel, ConvolveOp.EDGE_NO_OP, null);
    return cOp.filter(src, null);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T21:41:43.920

Chris Campbell 有一篇关于缩放图像的出色而详细的文章 - 请参阅**[这篇文章](http://today.java.net/pub/a/today/2007/04/03/perils-of-image-getscaledinstance.html)**。

**[Chet Haase 和 Romain Guy 在他们的书《 Filthy Rich Clients](http://filthyrichclients.org/)**》中也有关于图像缩放的详细且内容丰富的文章。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-06T17:32:18.197

在此处添加一些澄清信息。

不，这不是在 Java 中获得好看的缩放图像的*最佳方法。*Java2D 团队不推荐使用 getScaledInstance 和底层的 AreaAveragingScaleFilter，而支持一些更高级的方法。

如果您只是想获得一个好看的缩略图，那么使用 David 建议的 Chris Campbell 的方法是可行的方法。值得一提的是，我已经在名为[imgscalr](http://www.thebuzzmedia.com/software/imgscalr-java-image-scaling-library/)（Apache 2 许可证）的 Java 图像缩放库中实现了该算法以及其他 2 种更快的方法。该库的重点是在一个易于使用的高度优化的库中专门解决这个问题：

```
BufferedImage thumbnail = Scalr.resize(srcImg, 150); 
```

为了在 Java 中获得最好的缩放实例，方法调用看起来像这样：

```
BufferedImage scaledImg = Scalr.resize(img, Method.QUALITY, 
                                       150, 100, Scalr.OP_ANTIALIAS); 
```

该库将使用 Java2D 团队推荐的增量缩放方法缩放原始图像，然后将非常温和的卷积运算应用于图像，使其看起来更漂亮，有效地对其进行轻微的抗锯齿处理。这对于小缩略图来说非常好，对于大图像来说不是那么重要。

如果您以前没有使用过 convolveops，那么要获得外观完美的内核以使操作在所有用例中看起来都很好，就需要做很多工作。Scalr 类上定义的 OP 常量是与巴西的一个社交网站合作一周的结果，该网站推出了 imgscalr 来处理其成员的个人资料图片。我们来回尝试了 10 种不同的内核，直到我们找到了一个足够细微的内核，不会使图像看起来柔和或模糊，但仍能平滑像素值之间的过渡，因此图像看起来不会“锐利”和噪点在小尺寸。

如果您想要*最好看的*缩放图像而不考虑速度，请使用 Juha 的使用 java-image-scaling 库的建议。它是一个非常全面的 Java2D Ops 集合，包括对[Lanczsos 算法](http://en.wikipedia.org/wiki/Lanczos_algorithm)的支持，它将为您提供最好的结果。

我会远离 JAI，不是因为它不好，而是因为它只是一个与您要解决的问题不同/更广泛的工具。前面提到的 3 种方法中的任何一种都将为您提供漂亮的缩略图，而无需以更少的代码行将全新的成像平台添加到您的项目中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T20:45:32.697

您可以使用 JAI（Java 高级成像）来获得更复杂的图像大小调整选项。请参阅[https://jai.dev.java.net/](https://jai.dev.java.net/)。这些比 java.awt.image 包更灵活。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-13T10:20:29.527

您还可以查看[java-image-scaling](http://code.google.com/p/java-image-scaling/)库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-20T12:56:58.743

您可以使用开源库调整图像大小 [在此处输入链接描述](http://www.thebuzzmedia.com/software/imgscalr-java-image-scaling-library/)

我已经完成了从大图像到小图像的处理，结果非常好，保持了良好的纵横比。

```
import java.awt.image.BufferedImage;
import java.io.File;
import javax.imageio.ImageIO;
import javax.swing.JOptionPane;
import org.imgscalr.*;
import org.imgscalr.Scalr.Method;

public class ImageScaller {
static String SRC_FILES_PATH = "I:\\BigGreen\\";
static String IMAGE_FILE_PATH = "I:\\Resized\\";
public ImageScaller() {         
}   
public static void main(String[] args) {
    // TODO Auto-generated method stub
    try
    {
        ResizeLoad(SRC_FILES_PATH);
    }
    catch(Exception ex)
    {
        System.out.println(ex.toString());
    }
}
public static int ResizeLoad(String path)
{
    String file;
    File folder ;
    File[] listOfFiles = null;       
    listOfFiles = null;
    try
    {           
        folder = new File(path);
        listOfFiles = folder.listFiles();   

        for (int i = 0; i < listOfFiles.length; i++)                    
        {                   
            if (listOfFiles[i].isFile())
            {
                file = listOfFiles[i].getName();
                ScalledImageWrite(listOfFiles[i].getPath(),file);                                   
                //System.out.println(file);
                }
            }
        System.out.println("All Resized");
        }

    catch (Exception e) 
      {
          JOptionPane.showMessageDialog(null,e.toString(),"Resize & Load :Exception",JOptionPane.WARNING_MESSAGE);                
      }
    return listOfFiles.length;
}
private static File ScalledImageWrite(String path,String fileName) 
  {
      try
      {
          BufferedImage img = ImageIO.read(new File(path));            
          BufferedImage scaledImg = Scalr.resize(img, Method.AUTOMATIC, 24, 24);                 
          File destFile = new File(IMAGE_FILE_PATH + fileName);      
          ImageIO.write(scaledImg, "png", destFile);                  
          //System.out.println("Done resizing");
          return destFile;
      }
      catch (Exception e) 
      {
          JOptionPane.showMessageDialog(null,e.toString(),"Scalled Images Write: Exception",JOptionPane.WARNING_MESSAGE);
          return null;
      }
  }

} 
```

这是此代码的图形格式输出。 ![在此处输入图像描述](https://i.stack.imgur.com/2rLWq.png)

# c# - 在更新面板的列表框中保持滚动位置，而不是页面

> ID：543131
> 
> 赞同：7
> 
> 时间：2009-02-12T20:39:11.980
> 
> 标签：c#, asp.net, listbox

我在更新面板中有一个列表框。当我向下滚动并选择一个项目时，它会滚动回列表框的顶部。我听说 dom 不会跟踪回发时的滚动位置。有没有人有关于如何解决这个问题的解决方案/示例？

谢谢， XaiSoft

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T21:02:17.587

您遇到了这个问题，因为当异步请求返回时，它会用一个新元素`UpdatePanel`完全替换您的滚动元素。`<select>`

**可能的解决方案：**

1.  在提交之前（通过调用方法）使用 JavaScript 将元素的`scrollTop`属性存储`<select>`在隐藏的表单元素中，然后在 AJAX 调用返回时将其设置为新的。这将是乏味的、容易出错的，并且可能不是很兼容（参见[此处](http://siderite.blogspot.com/2007/06/setting-vertical-scroll-property-in.html)）。`UpdatePanel``ClientScriptManager.RegisterOnSubmitStatement``<select>`

2.  使用 JavaScript 存储`<select>`的`selectedIndex`属性并在 AJAX 调用返回时重新选择该项目。显然，如果用户还没有选择任何东西，这将不起作用。

3.  **[不要使用`UpdatePanel`s](http://encosia.com/2007/07/11/why-aspnet-ajax-updatepanels-are-dangerous/)**。改用[jQuery](http://jquery.com/) + [ASP.NET 页面方法](http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-12-14T13:57:39.723

```
 var xPos, yPos;
    var prm = Sys.WebForms.PageRequestManager.getInstance();

    function BeginRequestHandler(sender, args) {
        if (($get('Panel1')) != null) {
            xPos = $get('Panel1').scrollLeft;
            yPos = $get('Panel1').scrollTop;
        }
    }

    function EndRequestHandler(sender, args) {
        if (($get('Panel1')) != null) {
            $get('Panel1').scrollLeft = xPos;
            $get('Panel1').scrollTop = yPos;
        }
    }
    prm.add_beginRequest(BeginRequestHandler);
    prm.add_endRequest(EndRequestHandler);

    //Note: "Panel1" Panel or div u want to maintain scroll position
    //Note: This Java Script should be added after Scriptmanager***** 
```

//在没有更新面板的情况下保持面板/div的滚动位置

```
 window.onload = function() {
        var strCook = document.cookie;
        if (strCook.indexOf("!~") != 0) {
            var intS = strCook.indexOf("!~");
            var intE = strCook.indexOf("~!");
            var strPos = strCook.substring(intS + 2, intE);
            document.getElementById('Panel1').scrollTop = strPos;
        }
    }
    function SetDivPosition() {
        var intY = document.getElementById('Panel1').scrollTop;
        document.title = intY;
        document.cookie = "yPos=!~" + intY + "~!";
    }

   //Note: "Panel1" Panel id or div id for which u want to maintain scroll position 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T21:04:22.823

似乎以下代码示例以下列方式滚动：

*   Internet Explorer 8：回发后，所选项目是第一个可见项目。

*   Firefox：回发后，所选项目始终可见（但可能是最后一个可见项目）。

*   Chrome：如您所说，回发后，由于列表框滚动到顶部，所选项目可能会被隐藏。

```
<asp:UpdatePanel ID="up1" runat="server">
    <内容模板>
        <asp:ListBox ID="lb1" runat="server" Height="100px" AutoPostBack="true">
            <asp:ListItem>A</asp:ListItem>
            <asp:ListItem>B</asp:ListItem>
            <asp:ListItem>C</asp:ListItem>
            <asp:ListItem>D</asp:ListItem>
            <asp:ListItem>E</asp:ListItem>
            <asp:ListItem>F</asp:ListItem>
            <asp:ListItem>G</asp:ListItem>
            <asp:ListItem>H</asp:ListItem>
        </asp:列表框>
    </内容模板>
</asp:UpdatePanel>

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-23T21:31:09.203

您仍然可以使用`UpdatePanel`包含 a来实现部分回发`ListBox`，但通过在 上设置以下内容来防止它被新实例覆盖`UpdatePanel`：

```
ChildrenAsTriggers="False" 
```

如[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.childrenastriggers.aspx)中所述：

> 获取或设置一个值，该值指示来自 UpdatePanel 控件的直接子控件的回发是否更新面板的内容。如果您不希望 UpdatePanel 控件的直接子控件的回发导致面板内容的更新，请将 ChildrenAsTriggers 属性设置为 false。

对此的一个警告是，如果您尝试从服务器端对 ListBox 进行任何其他可视化操作（即，将`CSS`属性添加到回发上的项目），那么在发生另一个不相关的回发之前，您不会看到它们呈现。如果您所做的只是进行选择，那么设置`ChildrenAsTriggers="False"`将起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-18T18:46:52.407

对于我正在处理的企业应用程序，事实证明 MasterPage.Master 页面正在处理 Sys.WebForms.PageRequestManager.getInstance().add_endRequest 事件并在其中设置 window.scroll(0,0)。内容页面显然在内容页面的 UpdatePanel 的每个触发器上执行 window.scroll(0,0)。我尝试覆盖内容页面中的 add_endRequest 功能，但无法使其正常工作。最终我只是修改了 Master.Master 不做 window.scroll(0,0)。

# python - 范式混合的粒度

> ID：543140
> 
> 赞同：2
> 
> 时间：2009-02-12T20:41:14.033
> 
> 标签：python, ruby, coding-style

在使用 Python、C++、D 或 Ruby 等多范式语言时，您在单个应用程序中混合了多少范式？在单个模块中？您是否认为以细粒度混合功能、过程和 OO 范式会导致更清晰、更简洁的代码，因为您为每个子问题使用了正确的工具，或者因为您以 3 种不同的方式做类似的事情而导致不一致的混乱？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T20:47:40.227

不同的范式以不同的方式混合在一起。例如，使用 OOP 并不能消除对外部库中子例程和过程代码的使用。它只是将程序移动到不同的地方。

纯粹用一种范式编程是不可能的。你可能认为你在编程时脑子里只有一个，但那是你的错觉。您生成的代码将沿着边界并在许多范式的范围内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T23:23:48.177

我不确定我是否曾经这样想。

一旦你开始“用 Ruby 思考”，多范式就会合并到……好吧，Ruby。

Ruby 是面向对象的，但我发现诸如功能方面的其他方面往往意味着 OO 语言中存在的一些“传统”设计模式根本不相关。迭代器是一个经典的例子……迭代是在 Ruby 中优雅地处理的东西，重量级的 OO 迭代模式不再真正适用。这似乎在整个语言中都是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T22:21:02.420

混合范式的优势在于让您以最自然和最简洁的方式表达解决方案。当它有助于保持程序逻辑更小时，这是一件非常好的事情。例如，与传统循环相比，按某些标准过滤列表用函数式解决方案表示要简单几倍。

另一方面，为了从混合两种或多种范式中受益，程序员应该对所有这些范式都相当流利。所以这是一个强大的工具，应该小心使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T21:10:58.503

不同的问题需要不同的解决方案，但如果您在同一层以相同的方式解决问题，它会有所帮助。疯狂地变化只会让你和项目中的其他人感到困惑。

对于 C++，我发现静态类型的 OOP（在 Python 中使用 zope.interface）适用于更高级别的部分（连接、更新、信令等），而功能性的东西可以解决许多较低级别的问题（解析、nuts 'n螺栓数据处理等）更好。

通常，动态类型的脚本系统非常适合选择和配置特定的应用程序、游戏级别等。这可能是语言本身（即 Python）或其他东西（xml 脚本引擎 + C++ 中动态链接的必要系统）。

# sql - 是否可以获取 SELECT 的结果并将它们输入 VALUES 子句？

> ID：543141
> 
> 赞同：1
> 
> 时间：2009-02-12T20:41:29.977
> 
> 标签：sql, database, select, insert

例如，有没有办法执行以下操作：

```
INSERT INTO table2 VALUES(SELECT x FROM table1 WHERE x > 5 LIMIT 4) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T20:43:00.520

删除 VALUES 和括号：

```
INSERT INTO table2 SELECT x FROM table1 WHERE x > 5 LIMIT 4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T20:46:09.200

```
INSERT INTO SomeTable(column1, column2, column5)
SELECT x as column1, y as column2, a as column5
FROM differentTable
WHERE .... 
```

# network-protocols - 什么时候前向纠错对数据包来说是个好主意？

> ID：543145
> 
> 赞同：3
> 
> 时间：2009-02-12T20:42:06.917
> 
> 标签：network-protocols, error-correction

系统可以使用 UDP 并使用前向纠错来传输整个消息，而无需重新传输，即使丢失了一些数据包。这在实践中是否运作良好，或者额外的开销是否过多浪费？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T20:48:40.490

我认为它对于语音 (VoIP) 等一些应用程序很有用，在这些应用程序中，您希望避免错误，并且**您永远不想停止**（重新传输 NAK 数据包）并等待（直到重新传输）。

所以它可以在 UDP 的[实时传输协议](http://en.wikipedia.org/wiki/Real-time_Transport_Protocol)风格之上实现。

> 延迟不是很可怕吗？

您是在问前向纠错是否会增加端到端延迟？如果是这样，我认为答案是否定的，但它确实增加了所需的带宽。

我相信你总是需要*一些*延迟来避免抖动；例如，您可能会说“让我们将整个语音通道延迟 200 毫秒，因此任何/每个数据包都可能需要 0 到 200 毫秒才能通过互联网，然后重新组装并通过 D-to-A 转换器发送另一端。”

鉴于这些数字，那么没有前向纠错可能意味着，在每 200 毫秒的周期内，您发送 10 个数据包，每个数据包包含 20 毫秒的数据……如果一个数据包丢失，那么这就是另一个数据包的间隙（故障）结尾。

然而，进行一些前向纠错可能意味着，在每 200 毫秒的周期内，您仍然发送 10 个数据包……每个数据包包含 20 毫秒的数据，加上已经在另一个数据包中传输的 10 毫秒的数据（或者，也许您发送 30 个数据包而不是 20 个）。然后，如果任何单个数据包丢失，它所携带的数据将被冗余传送（其他两个数据包各有一半），这避免了解码输出中的任何故障。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T23:08:46.323

这对于存储介质（例如硬盘驱动器和光盘）也很有意义，因为您不能只返回源头来获取未损坏的数据。事实上，硬盘驱动器和光盘都非常广泛地使用前向纠错。

前向纠错也广泛用于无线通信中，其中错误往往一次只敲掉几位。不是将整个数据包丢失为单个位错误，而是使用前向纠错来修复损坏的位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T20:48:09.523

取决于应用程序。

对于游戏等应用程序，纠错始终是必要的，因为如果丢失一些数据，它不会产生很大的影响。

但是，如果应用程序需要特定的有序数据，则需要进行某种纠错。

**这不是“开销”的问题，更多的是关于“应用程序”的问题。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T22:44:28.207

简单的答案是，如果您通过高带宽高延迟（意思是“长距离”）链路发送，前向纠错是有意义的。否则，它可能不会。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-30T16:39:48.030

当重传的“价格”高于你愿意支付的。
以卫星为例，它的传播时间很长，最好多发送几个字节，然后再发送一个数据包。

# vba - 按 Enter 时防止移动到下一条记录？

> ID：543147
> 
> 赞同：10
> 
> 时间：2009-02-12T20:42:15.780
> 
> 标签：vba, ms-access

我在 Access 2003 中有一个只能处理单个记录的表单。我可以将`Cycle`属性设置为`Current Record`，但当我按 Enter 时，表单仍会跳转到下一条记录。我的第一个想法是`KeyPreview`财产，但我没有看到。我的另一个想法可能是`KeyPress`或`KeyUp`事件，但我想我会问，以防意外后果。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T21:05:29.467

Cycle 属性只影响 TAB 键。

控制作为全局属性的 Enter 键的行为。

转到工具/选项 - 键盘选项卡，然后在“输入后移动”上选择“下一个字段”

您也可以使用 KeyPress 和 KeyDown 事件来捕获 Enter 键，但这需要更多的工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-23T20:56:54.530

这也可以在 vba 中完成。

```
Application.GetOption "Move After Enter" 'get current setting
Application.SetOption "Move After Enter", 0 'don't move
Application.SetOption "Move After Enter", 1 'Next Field
Application.SetOption "Move After Enter", 2 'Next Record 
```

[http://www.pcreview.co.uk/forums/enter-key-moving-next-field-t3454281.html](http://www.pcreview.co.uk/forums/enter-key-moving-next-field-t3454281.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-24T16:24:25.640

`TAB`在添加记录结束时按下, `Alt`, `PgUP`, `PgDn`,等键`Enter`（主要在最后一个字段之后），数据库会自动保存您在表单上输入的所有信息并清除字段，以便您可以输入下一个值. 所以发生的情况是数据已保存但表单看起来是空的。

要做的3件事：

1.  表单循环属性设置为当前记录。
2.  表单键预览属性设置为是。
3.  将以下代码添加到表单的 KeyDown 事件中：

    ```
    '33 - PgUp; 34 - PgDown; 9 - Tab; 18=Alt; 13=Enter

    Select Case KeyCode
    Case 33, 34, 18, 9, 13
    KeyCode = 0    
    Case Else
    'Debug.Print KeyCode, Shift
    End Select 
    ```

    我在网上搜索时发现了这一点，并且不对代码承担任何责任/责任，但我不知道我在哪里找到它。为我工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T21:16:21.453

Cycle 属性仅适用于 Tab 键。

您可以选择两种选择。

您可以在 KeyDown/KeyUp/KeyPressed 中捕获 Enter 键
- 或者 -
您可以将数据源过滤到您希望他们编辑的一条记录，并禁用通过该表单添加新记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-02T17:11:43.820

您可以将以下代码添加到表单“更新前”事件中。如果用户想移动到下一条记录，它会要求用户保存然后关闭表单，然后才能移动到另一个记录。

```
 Private Sub Form_BeforeUpdate(Cancel As Integer)
    Select Case MsgBox("Save?", vbYesNo)
      Case vbYes
        DoCmd.Close
      Case vbNo
        Cancel = True
    End Select
  End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-15T19:19:50.167

如果您进入文件页面上的访问选项，请转到客户端设置，第一个设置将让您选择按 Enter 键时焦点更改的位置。至少在 Access 2013 中。

# svn - Collabnet SVN 日志文件，有吗？

> ID：543151
> 
> 赞同：5
> 
> 时间：2009-02-12T20:43:25.667
> 
> 标签：svn, collabnet

我的 svn 服务器表现得很时髦。我们在 Windows 机器上使用 Collabnet svn 二进制文件。

有谁知道服务器是否有日志文件，我可以检查以找出锁定我的服务器的原因（大型提交挂起）？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T20:58:30.390

如果您使用 mod_dav_svn，SVN 日志消息将在 Apache 日志中。如果您在 1.6 之前运行 svnserve，请引用[邮件列表发布](http://svn.haxx.se/users/archive-2008-07/0444.shtml)：

> svnserve 没有任何日志记录功能。

由于 1.6 版 svnserve 可以写入[日志文件](http://subversion.apache.org/docs/release-notes/1.6.html#svnserve-logging)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-06T12:02:52.173

$ svnserve --version svnserve，版本 1.6.12 (r955767)

使用 --log-file=/var/log/svnserve.log 启动你的守护进程（例如）

它不记录身份验证，但您可以知道访问了哪些存储库以及用户发出了哪些命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-07T15:04:16.563

将以下行添加到 Apache `subversion.conf`：

```
CustomLog logs/svn_logfile "%t %u@%h %>s repo:%{SVN-REPOS-NAME}e %{SVN-ACTION}e (%B Bytes in %T Sec)" env=SVN-ACTION 
```

示例输出：

```
[07/Apr/2015:09:54:40 -0500] user@127.0.0.1 200 repo:java commit r24 (758 Bytes in 2 Sec) 
```

# c# - 在 C# 中打印到 LPT1

> ID：543155
> 
> 赞同：6
> 
> 时间：2009-02-12T20:44:57.910
> 
> 标签：c#, file, driver, printing

如何使用文件 LPT1\. 在 C# 中直接打印到点阵打印机。

我用 fopen 在 C++ 上完成了它，但我不知道如何在 c# 中完成它。

非常感谢您

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-12T20:56:36.960

在 Windows 中将打印机设置为 Generic/Text Only，然后打印到它。

这是我用来打印到具有自己编码文本格式的标签打印机的代码。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Drawing;
using System.Drawing.Printing;
using System.Windows.Forms;
using System.Runtime.InteropServices;
using System.IO;

namespace whatever {

public class RawPrinterHelper
{
    // Structure and API declarions:
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
    public class DOCINFOA
    {
        [MarshalAs(UnmanagedType.LPStr)]
        public string pDocName;
        [MarshalAs(UnmanagedType.LPStr)]
        public string pOutputFile;
        [MarshalAs(UnmanagedType.LPStr)]
        public string pDataType;
    }
    [DllImport("winspool.Drv", EntryPoint = "OpenPrinterA", SetLastError = true, CharSet = CharSet.Ansi, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
    public static extern bool OpenPrinter([MarshalAs(UnmanagedType.LPStr)] string szPrinter, out IntPtr hPrinter, IntPtr pd);

    [DllImport("winspool.Drv", EntryPoint = "ClosePrinter", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
    public static extern bool ClosePrinter(IntPtr hPrinter);

    [DllImport("winspool.Drv", EntryPoint = "StartDocPrinterA", SetLastError = true, CharSet = CharSet.Ansi, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
    public static extern bool StartDocPrinter(IntPtr hPrinter, Int32 level, [In, MarshalAs(UnmanagedType.LPStruct)] DOCINFOA di);

    [DllImport("winspool.Drv", EntryPoint = "EndDocPrinter", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
    public static extern bool EndDocPrinter(IntPtr hPrinter);

    [DllImport("winspool.Drv", EntryPoint = "StartPagePrinter", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
    public static extern bool StartPagePrinter(IntPtr hPrinter);

    [DllImport("winspool.Drv", EntryPoint = "EndPagePrinter", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
    public static extern bool EndPagePrinter(IntPtr hPrinter);

    [DllImport("winspool.Drv", EntryPoint = "WritePrinter", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
    public static extern bool WritePrinter(IntPtr hPrinter, IntPtr pBytes, Int32 dwCount, out Int32 dwWritten);

    // SendBytesToPrinter()
    // When the function is given a printer name and an unmanaged array
    // of bytes, the function sends those bytes to the print queue.
    // Returns true on success, false on failure.
    public static bool SendBytesToPrinter(string szPrinterName, IntPtr pBytes, Int32 dwCount)
    {
        Int32 dwError = 0, dwWritten = 0;
        IntPtr hPrinter = new IntPtr(0);
        DOCINFOA di = new DOCINFOA();
        bool bSuccess = false; // Assume failure unless you specifically succeed.

        di.pDocName = "My C#.NET RAW Document";
        di.pDataType = "RAW";

        // Open the printer.
        if (OpenPrinter(szPrinterName.Normalize(), out hPrinter, IntPtr.Zero))
        {
            // Start a document.
            if (StartDocPrinter(hPrinter, 1, di))
            {
                // Start a page.
                if (StartPagePrinter(hPrinter))
                {
                    // Write your bytes.
                    bSuccess = WritePrinter(hPrinter, pBytes, dwCount, out dwWritten);
                    EndPagePrinter(hPrinter);
                }
                EndDocPrinter(hPrinter);
            }
            ClosePrinter(hPrinter);
        }
        // If you did not succeed, GetLastError may give more information
        // about why not.
        if (bSuccess == false)
        {
            dwError = Marshal.GetLastWin32Error();
        }
        return bSuccess;
    }

    public static bool SendFileToPrinter(string szPrinterName, string szFileName)
    {
        // Open the file.
        FileStream fs = new FileStream(szFileName, FileMode.Open);
        // Create a BinaryReader on the file.
        BinaryReader br = new BinaryReader(fs);
        // Dim an array of bytes big enough to hold the file's contents.
        Byte[] bytes = new Byte[fs.Length];
        bool bSuccess = false;
        // Your unmanaged pointer.
        IntPtr pUnmanagedBytes = new IntPtr(0);
        int nLength;

        nLength = Convert.ToInt32(fs.Length);
        // Read the contents of the file into the array.
        bytes = br.ReadBytes(nLength);
        // Allocate some unmanaged memory for those bytes.
        pUnmanagedBytes = Marshal.AllocCoTaskMem(nLength);
        // Copy the managed byte array into the unmanaged array.
        Marshal.Copy(bytes, 0, pUnmanagedBytes, nLength);
        // Send the unmanaged bytes to the printer.
        bSuccess = SendBytesToPrinter(szPrinterName, pUnmanagedBytes, nLength);
        // Free the unmanaged memory that you allocated earlier.
        Marshal.FreeCoTaskMem(pUnmanagedBytes);
        return bSuccess;
    }
    public static bool SendStringToPrinter(string szPrinterName, string szString)
    {
        IntPtr pBytes;
        Int32 dwCount;
        // How many characters are in the string?
        dwCount = szString.Length;
        // Assume that the printer is expecting ANSI text, and then convert
        // the string to ANSI text.
        pBytes = Marshal.StringToCoTaskMemAnsi(szString);
        // Send the converted ANSI string to the printer.
        bool success = SendBytesToPrinter(szPrinterName, pBytes, dwCount);
        Marshal.FreeCoTaskMem(pBytes);
        return success;
    }
}
} 
```

然后从另一个类中调用它，如下所示：

```
 private bool PrintLabels(string printerName)
    {
        return RawPrinterHelper.SendStringToPrinter(printerName, this.Text);
    } 
```

（编辑：如果有人看到任何与非托管资源相关的主要 fubars，请在评论中告诉我）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:16:56.163

也许您不能打印到设备“LPT1”，而是打印到您必须首先安装的“哑电传打印机”。如果它们存在于现代 Windows 中......所以你应该打印到“mydumbprinter”，它又使用 LPT1 作为打印机端口。当我按照上面 Cocowalla 的 Source 链接进行操作时，在我看来，您可以在 PrinterDialog 中选择一台打印机。生成的打印机名称更可能是“Laserjet”而不是“LPT1”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-04T14:47:50.403

在 C# 中，首先您需要使用该`CreateFile`方法连接到该端口，然后打开一个文件流到该端口以最终写入它。这是一个示例类，它将两行写入`LPT1`.

```
using Microsoft.Win32.SafeHandles;
using System;
using System.IO;
using System.Runtime.InteropServices;

namespace YourNamespace
{
public static class Print2LPT
        {
            [DllImport("kernel32.dll", SetLastError = true)]
            static extern SafeFileHandle CreateFile(string lpFileName, FileAccess dwDesiredAccess,uint dwShareMode, IntPtr lpSecurityAttributes, FileMode dwCreationDisposition, uint dwFlagsAndAttributes, IntPtr hTemplateFile);

            public static bool Print()
            {
                string nl = Convert.ToChar(13).ToString() + Convert.ToChar(10).ToString();
                bool IsConnected= false;

                string sampleText ="Hello World!" + nl +
                "Enjoy Printing...";     
                try
                {
                    Byte[] buffer = new byte[sampleText.Length];
                    buffer = System.Text.Encoding.ASCII.GetBytes(sampleText);

                    SafeFileHandle fh = CreateFile("LPT1:", FileAccess.Write, 0, IntPtr.Zero, FileMode.OpenOrCreate, 0, IntPtr.Zero);
                    if (!fh.IsInvalid)
                    {
                        IsConnected= true;                    
                        FileStream lpt1 = new FileStream(fh,FileAccess.ReadWrite);
                        lpt1.Write(buffer, 0, buffer.Length);
                        lpt1.Close();
                    }

                }
                catch (Exception ex)
                {
                    string message = ex.Message;
                }

                return IsConnected;
            }
        }
} 
```

假设您的打印机连接在`LPT1`端口上，如果没有，您将需要调整`CreateFile`方法以匹配您正在使用的端口。

您可以使用以下行在程序中的任何位置调用该方法

```
Print2LPT.Print(); 
```

我认为这是解决您的问题的最短和最有效的解决方案。

# objective-c - Cocoa @selector 用法说明

> ID：543161
> 
> 赞同：24
> 
> 时间：2009-02-12T20:46:20.043
> 
> 标签：objective-c

我是 Cocoa/Cocoa Touch 的新手，并且正在阅读一本开发书籍。我遇到过使用 @selector() 运算符的情况。我对应该如何以及何时使用 @selector() 运算符有点迷茫。有人可以提供一个简短而甜蜜的解释和示例，说明为什么要使用它以及它给开发人员带来什么好处？

顺便说一句，这里是取自 Apple 的 iPhone 开发站点的示例代码，它使用了 @selector()

```
if ([elementName isEqualToString:@"entry"])
{

    parsedEarthquakesCounter++;

    // An entry in the RSS feed represents an earthquake, so create an instance of it.
    self.currentEarthquakeObject = [[Earthquake alloc] init];
    // Add the new Earthquake object to the application's array of earthquakes.
    [(id)[[UIApplication sharedApplication] delegate]
            performSelectorOnMainThread:@selector(addToEarthquakeList:)
            withObject:self.currentEarthquakeObject waitUntilDone:YES];
    return;
} 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-12T20:54:26.810

选择器运算符提供了一种方法来引用对象提供的方法，有点类似于 C 中的函数指针。它很有用，因为它允许您解耦调用对象上的方法的过程。例如，一段代码可以提供一种方法，而另一段代码可以将该方法应用于给定的一组对象。

例子：

测试一个对象是否实现了某个方法：

```
[object respondsToSelector:@selector(methodName)] 
```

存储一个稍后调用对象的方法；

```
SEL method = @selector(methodName);
[object performSelector:method]; 
```

在不同的线程上调用方法（对 GUI 工作有用）。

```
[object performSelectorOnMainThread:@selector(methodName)] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T14:10:47.223

除了上面所说的之外，您还可以将 @selector 包装在 NSInvocation 中以供以后使用。您可以在创建 NSInvocation 很长时间后为其设置参数，并在需要触发消息时激活它。这给了你很大的力量。

对于这个概念的介绍，Scott Stevenson 有一篇很棒的文章，题为[“Dynamic Objective-C with NSInvocation”](http://theocacao.com/document.page/264)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T20:55:31.877

`@selector()`每次需要将方法的名称作为参数传递给另一个方法、函数或变量值时使用。直接传递名称在 Objective-C 中不起作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T21:39:14.910

一个参考：

[http://en.wikipedia.org/wiki/Multiple_dispatch](http://en.wikipedia.org/wiki/Multiple_dispatch)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-05-17T21:46:06.540

一个实际示例是[validateMenuItem](http://developer.apple.com/mac/library/documentation/cocoa/Reference/ApplicationKit/Protocols/NSMenuValidation_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/validateMenuItem:)方法，其中菜单项通过其目标操作进行标识。

简化示例：

```
- (BOOL)validateMenuItem:(NSMenuItem *)item {
    if ([item action] == @selector(selectFiles:) && otherCondition) {
        return YES;
    } else {
        return NO;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-23T07:27:18.163

您可以使用选择器来调用对象上的方法——这为在 Cocoa 中实现目标-动作设计模式提供了基础。

```
[myObject performSelector:@selector(runMYmethod:) withObject:parameters]; 
```

相当于：

```
[myObject runMYmethod:parameters]; 
```

# c# - 在简单的模板系统中用内容替换标签

> ID：543163
> 
> 赞同：0
> 
> 时间：2009-02-12T20:46:25.613
> 
> 标签：c#, regex, templates, replace

我正在尝试构建一个简单的“用户模板”系统，以便我的用户可以编辑 RSS 提要项目和系统生成的电子邮件的布局，而不会弄乱视图文件等。这是我用来将字符串中的标签替换为内容的函数：

```
private const string URL_TAG_REGEX = @"{{(?<TagName>\w*)}}";
private static string ReplaceTags(string content, 
    Dictionary<string, object> values) {
        Regex r = new Regex(UT_TAG_REGEX);
        foreach (string tag in values.Keys) {
            content = r.Replace(content, 
                m => (m.Groups["TagName"].Value == tag ? 
                    values[tag].ToString() : string.Empty));
        }
    return content;
} 
```

我的测试模板如下所示：

```
<a href="{{link}}">{{title}}</a> - {{date}}<br />
{{description}} 
```

并正在渲染：

```
<%= UserTemplates.Render("overview_rss_item", new {
        link = item.Link,
        title = item.Title,
        date = item.PublishDate,
        description = item.Description
    }) %> 
```

Render 方法负责打开文件并将匿名对象转换为字典。它主要工作，除了只有 {{link}} 标记被匹配。其余的将替换为 string.Empty。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T20:53:39.603

因为您要替换所有匹配项，并且如果该值不等于标记，您将用 String.Empty 替换它。试试这个：

```
 foreach (string tag in values.Keys) {
        content = r.Replace(content, 
            m => (m.Groups["TagName"].Value == tag ? 
                values[tag].ToString() : m.Value));
    } 
```

# opengl - OpenGL displayList 大小的限制

> ID：543168
> 
> 赞同：5
> 
> 时间：2009-02-12T20:47:56.110
> 
> 标签：opengl, jogl

有谁知道将太多 OpenGL 调用放入显示列表是否会导致它失败？如果是这样，有没有人估计有多少电话可以做到这一点？跟显存有关系吗？

我从 JOGL 调用 OpenGL，但我认为这并不重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T21:20:32.007

根据此[文档页面](http://www.opengl.org/sdk/docs/man/xhtml/glNewList.xml)，如果您尝试编译一个太大的列表，您应该会收到一条`GL_OUT_OF_MEMORY`错误消息。
确保`glGetError()`在创建列表之前和之后调用并处理所有结果，直到`GL_NO_ERROR`返回。

似乎没有办法估计列表可以包含的命令数量。这可能是因为每个命令的大小取决于其参数和使用的设备特定编码。这些列表保存在卡的视频内存中，因此如果您使用的是相对非过时的卡，这对于任何大小合理的列表通常都不是问题。如果您确实发现这确实是问题，您可能可以使用顶点数组甚至 VBO

# apache - 如何使用 .htaccess 将 aspx 页面重定向到 php 页面？

> ID：543179
> 
> 赞同：1
> 
> 时间：2009-02-12T20:49:23.873
> 
> 标签：apache, .htaccess, http-status-code-301

我最近从 asp.net 主机转移到 PHP 主机。我正在尝试使用 .htaccess 设置旧网址的 301 重定向。这是我想要完成的事情：

```
old url: http://www.vasanth.in/downloads/download.aspx?file=file.zip
new url: http://www.vasanth.in/downloads/download.php?f=file.zip 
```

我尝试了以下方法：

```
RedirectMatch 301 /downloads/download.aspx\?file=(.*)$ http://www.vasanth.in/downloads/download.php\?f=$1 
```

这似乎不起作用？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T20:57:37.550

使用`mod_rewrite`，像这样：

```
RewriteEngine On
RewriteCond %{QUERY_STRING} ^file=(.+)$
RewriteRule ^(.+)\.aspx$ $1.php?f=%1 
```

# visual-studio - Visual Studio 安装项目——添加预构建步骤

> ID：543180
> 
> 赞同：2
> 
> 时间：2009-02-12T20:49:51.690
> 
> 标签：visual-studio, installation, prebuild

我想让我的生成安装项目的构建过程只需单击一下。但是，我还想在构建步骤中添加 {smartassembly} 以混淆构建，但仅限于我们的构建机器上。如何向 Visual Studio 2008 vdproj 添加预构建步骤？

基本上，我想移动命令行参数来混淆从构建应用程序到安装程序的一部分的构建，所以只有构建机器需要有许可证。

或者，我们是否应该为所有开发人员获取 {smartassembly}？这是一个非常大的成本变化（从一个构建许可证到 5 个并不是一笔小数目），所以这里的推理必须非常无懈可击。我打算将它添加到只负责构建的机器上，而不是让所有开发人员都拥有它，然后强迫开发人员尝试在客户实际拥有的发布版本中重现错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T23:19:51.453

是的，事实证明我是个白痴。UI 有所不同，但构建前和构建后的项目都在属性中，就好像它是 UI 属性，而不是项目属性一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T22:29:13.573

为什么不为您的解决方案/项目设置不同的目标/构建/配置。它是唯一一个在构建机器上构建的。

（仅针对该项目/目标/配置的预/后构建步骤）

如果这不起作用，我会问写它的公司他们的建议。

# sql-server-2005 - SQL 函数和递归

> ID：543181
> 
> 赞同：3
> 
> 时间：2009-02-12T20:49:55.167
> 
> 标签：sql-server-2005, recursion

假设您在 SQL Server 中编写了一个有条件地调用自身的函数。如果您是从头开始编写函数，完成它并尝试创建它，SQL Server 会报错。

抱怨是您从函数调用的函数不存在。当然不是，它是递归的！

要真正让它工作，你必须注释掉递归调用，创建函数，取消注释调用，并改变函数。如果您曾经更改函数接受的参数（在这种情况下，它会抱怨您的新递归调用中的参数太多或太少），那么您必须经历这些废话。

有没有办法解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T21:04:02.543

对于存储过程，您应该会收到这样的错误，您可以忽略：

无法将行添加到当前对象的 sysdepends，因为它依赖于缺少的对象“sub_proc1”。**该对象仍将被创建。**

对于用户定义的函数，它有点棘手，但如果你在递归调用中完全限定函数名，它就可以工作（至少在 SQL 2k8 上对我来说是这样）。

```
CREATE FUNCTION recursiveUDF () RETURNS int
AS
BEGIN

    DECLARE @X int

     --Fails with "recursiveUDF is not a recognized built-in function name."
    SET @X = recursiveUDF()          

     --works!
    SET @X = dbo.recursiveUDF()  

    RETURN 1
END 
```

# .net - 如何提供对插件辅助功能的访问？

> ID：543193
> 
> 赞同：1
> 
> 时间：2009-02-12T20:53:28.980
> 
> 标签：.net, plugins

在我的 .NET 应用程序中，我允许人们添加他们的插件。但是我有几个帮助函数可以帮助他们。

为插件提供对这些功能的访问的最佳方式是什么？

我是否应该在项目中添加一个新的 DLL 并将所有辅助方法/类放在那里并告诉插件开发人员链接该 DLL？

我目前正在设计这个系统，之前从未开发过插件系统，所以不想做出愚蠢的决定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T20:59:44.397

我认为向项目添加 DLL 并将其作为“帮助”机制提供的方法没有任何问题。但是，请记住，您无法真正控制它们如何在 DLL 中实例化类，并且必须检查所有函数的所有输入以确保它们有效，而不是 null 等。

另一个想法是提供一个具有辅助函数（甚至是其他辅助接口的引用）的接口，并将其传递给插件。这样您就不必担心对象的创建，并且他们将如何使用加载项的向量将仅限于您在界面中公开的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T21:01:08.183

托管可扩展性框架 (MEF) 的创建是为了将插件添加到您的代码中

[MEF 编程指南](http://www.codeplex.com/MEF/Wiki/View.aspx?title=Guide&referringTitle=Home)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T21:01:10.180

最终，您将通过程序集公开您的 API，所以是的，将作为 API 一部分的所有类、静态方法等放入单个程序集中可能是最简单的，这样您的插件编写者将拥有一个参考点。

# python - 如何将远程调试器附加到 Python 进程？

> ID：543196
> 
> 赞同：55
> 
> 时间：2009-02-12T20:54:08.277
> 
> 标签：python, remote-debugging

我厌倦了插入

```
import pdb; pdb.set_trace() 
```

进入我的 Python 程序并通过控制台进行调试。如何连接远程调试器并从文明的用户界面插入断点？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-13T05:32:18.313

使用[Winpdb](http://winpdb.org/)。它是一个**独立于平台**的图形 GPL Python 调试器，支持通过网络进行远程调试、多线程、命名空间修改、嵌入式调试、加密通信，并且比 pdb 快 20 倍。

特征：

*   GPL 许可证。Winpdb 是免费软件。
*   与 CPython 2.3 到 2.6 和 Python 3000 兼容
*   与 wxPython 2.6 到 2.8 兼容
*   独立于平台，并在 Ubuntu Gutsy 和 Windows XP 上测试。
*   用户界面：rpdb2 是基于控制台的，而 winpdb 需要 wxPython 2.6 或更高版本。

[![截屏](https://i.stack.imgur.com/GwX8x.jpg)](https://i.stack.imgur.com/GwX8x.jpg)
[（来源：[winpdb.org](http://winpdb.org/images/screenshot_winpdb_small.jpg)）]

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-12T21:07:19.540

好吧，你可以得到与使用扭曲沙井非常相似的东西，它的工作原理如下：

```
from twisted.internet import reactor
from twisted.cred import portal, checkers 
from twisted.conch import manhole, manhole_ssh 

def getManholeFactory(namespace):
    realm = manhole_ssh.TerminalRealm()
    def getManhole(_): 
        return manhole.Manhole(namespace) 
    realm.chainedProtocolFactory.protocolFactory = getManhole
    p = portal.Portal(realm)
    p.registerChecker(
        checkers.InMemoryUsernamePassword DatabaseDontUse(admin='foobar'))
    f = manhole_ssh.ConchFactory(p)
    return f

reactor.listenTCP(2222, getManholeFactory(globals()))
reactor.run() 
```

然后你只需通过 ssh 登录程序；

```
$ ssh admin@localhost -p 2222
admin@localhost's password: 
```

使用**foobar**作为密码。

当你登录时，你会得到一个正常的 python 提示，你可以在其中戳数据。这与将回溯发送到主机并不完全相同。

现在，这可能很难集成到 GUI 程序中，在这种情况下，您可能需要选择另一个反应器，例如对于使用 gtk2reactor 等的基于 gtk 的程序。

如果您希望发送实际的回溯，您需要为 stderr、stdin 和 stdout 创建一个套接字通道，该通道通过网络而不是打印到本地主机。使用twisted应该不会太难完成。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-04-04T21:55:19.330

有点晚了，但这是一个非常轻量级的远程调试解决方案，由[http://michaeldehaan.net/post/35403909347/tips-on-using-debuggers-with-ansible](http://michaeldehaan.net/post/35403909347/tips-on-using-debuggers-with-ansible)提供：

1.  `pip install epdb`在远程主机上。
2.  确保您的防火墙设置不允许非本地连接到远程主机上的端口 8080，因为`epdb`默认侦听任何地址 ( `INADDR_ANY`)，而不是 127.0.0.1。
3.  而不是`import pdb; pdb.set_trace()`在你的程序中使用，使用`import epdb; epdb.serve()`.
4.  安全登录到远程主机，因为`epdb.connect()`使用 telnet。
5.  使用 附加到程序`python -c 'import epdb; epdb.connect()'`。

当然，调整安全位以适应您的本地网络设置和安全立场。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-02T15:37:29.857

来自现代 IDE 的两种解决方案：

1.  PTVS跨平台远程调试

2.  PyCharm/PyDev 远程调试

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-06T12:09:02.397

我发现 pudb 在紧急情况下很有用

```
pip install pudb 
```

项目描述 [https://pypi.org/project/pudb/](https://pypi.org/project/pudb/)

教程： [https ://vimeo.com/5255125](https://vimeo.com/5255125)

# python - 在文件中的 url 字符串中添加引号

> ID：543199
> 
> 赞同：2
> 
> 时间：2009-02-12T20:54:42.770
> 
> 标签：python, ruby, perl

我需要脚本来在 url.txt 的 url 字符串中添加引号

从`http://www.site.com/info.xx`到`"http://www.site.com/info.xx"`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T20:57:35.990

```
url = '"%s"' % url 
```

例子：

```
line = 'http://www.site.com/info.xx  \n'
url = '"%s"' % line.strip()
print url # "http://www.site.com/info.xx" 
```

请记住，在引号前添加反斜杠会将其转义，因此不会结束字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T21:00:20.493

```
url = '"%s"' % url 
```

例子：

```
>>> url = "http://www.site.com/info.xx"
>>> print url
http://www.site.com/info.xx
>>> url = '"%s"' % url
>>> print url
"http://www.site.com/info.xx"
>>> 
```

从文件中解析它：

```
from __future__ import with_statement

def parseUrlsTXT(filename):
    with open(filename, 'r') as f:
        for line in f.readlines():
            url = '"%s"' % line[:-1]
            print url 
```

用法：

```
parseUrlsTXT('/your/dir/path/URLs.txt') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T10:54:29.713

一个简单的 Perl 脚本：

```
#!/usr/bin/perl

use strict;
use warnings;

while (my $line = <>) {
    $line =~ s/\s*(.*)\s*/$1/;
    print qq/"$line"\n/;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T20:59:12.853

写一个...
perl 是我最喜欢的脚本语言... 看来您可能更喜欢 Python。

只需读入文件并在其前后添加 \" ..
这在 perl 中非常简单。

这似乎更像是一个请求而不是一个问题......这应该在stackoverflow上吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T21:42:06.993

如果 ' `url.txt`' 包含 url 列表，每行一个 url 则：

*   引用第一个非空白字符序列：

    ```
    $ perl -pe"s~\S+~\"$&\"~" url.txt 
    ```

*   或修剪空格并引用其余部分：

    ```
    $ perl -nE"$_=trim; say qq(\"$_\")" url.txt 
    ```

# visual-studio - cmake RUNTIME_OUTPUT_DIRECTORY 在 Windows 上

> ID：543203
> 
> 赞同：24
> 
> 时间：2009-02-12T20:55:52.813
> 
> 标签：cmake, cmake, visual-studio, build-process, cross-platform, cmake

我正在使用[cmake](/questions/tagged/cmake "显示标记为“cmake”的问题")来管理我的跨平台构建，除了这个问题，我已经解决了所有问题。我设置`RUNTIME_OUTPUT_DIRECTORY`为`bin/`存储数据文件的目录。在 Linux 上，这可以正常工作。在 Windows 上，可执行文件根据构建类型放置在`Debug`/`Release`子目录中。有没有办法让[cmake](/questions/tagged/cmake "显示标记为“cmake”的问题")将可执行文件复制到正确的目录，或者（甚至更好）完全停止使用这些子目录？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-08-15T14:12:35.810

多年来，我一直在使用[Ogapo](https://stackoverflow.com/users/123518/ogapo)报告的精细前缀属性破解。有用。

但从 CMake 2.8 版开始，官方支持避免在 Windows 上使用 Release/Debug 子目录。

使用全局`CMAKE_<ARTIFACT>_OUTPUT_DIRECTORY_<CONFIGURATION>`变量或每个目标`<ARTIFACT>_OUTPUT_DIRECTORY_<CONFIGURATION>`属性，如下所示：

```
SET( CMAKE_RUNTIME_OUTPUT_DIRECTORY_DEBUG "${OUTPUT_DIRECTORY}")
SET( CMAKE_RUNTIME_OUTPUT_DIRECTORY_RELEASE "${OUTPUT_DIRECTORY}")
SET( CMAKE_LIBRARY_OUTPUT_DIRECTORY_DEBUG "${OUTPUT_DIRECTORY}")
SET( CMAKE_LIBRARY_OUTPUT_DIRECTORY_RELEASE "${OUTPUT_DIRECTORY}")
SET( CMAKE_ARCHIVE_OUTPUT_DIRECTORY_DEBUG "${OUTPUT_DIRECTORY}")
SET( CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELEASE "${OUTPUT_DIRECTORY}") 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-16T06:20:18.280

我不确定这些目录是故意的还是错误的，但冒着向前不兼容的风险，您可以添加：

```
if (MSVC_IDE)
    # hack to get around the "Debug" and "Release" directories cmake tries to add on Windows
    set_target_properties (${NAME} PROPERTIES PREFIX "../")
endif() 
```

这一直对我有用

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T18:36:46.823

我发现了一些关于这个主题的很好的讨论：

[http://www.cmake.org/pipermail/cmake/2008-April/021355.html](http://www.cmake.org/pipermail/cmake/2008-April/021355.html)

[http://www.vtk.org/Bug/bug_view_advanced_pa​​ge.php?bug_id=8366](http://www.vtk.org/Bug/bug_view_advanced_page.php?bug_id=8366)

是否可以使用已弃用的*EXECUTABLE_OUTPUT_PATH*而不是*RUNTIME_OUTPUT_DIRECTORY*？我不确定两者之间发生了哪些功能变化，但可能值得一试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T17:15:18.867

一些 cmake 变量具有构建特定版本。

```
CMAKE_C_FLAGS 
    the compiler flags for compiling C sources. Note you can also specify switches with ADD_DEFINITIONS(). 
CMAKE_C_FLAGS_DEBUG 
    compiler flags for compiling a debug build from C sources. 
CMAKE_C_FLAGS_RELEASE 
    compiler flags for compiling a release build from C sources. 
CMAKE_C_FLAGS_RELWITHDEBINFO 
    compiler flags for compiling a release build with debug flags from C sources. 
```

我还没有验证这些变量是否存在，但也许将`RUNTIME_OUTPUT_DIRECTORY_DEBUG`&&设置`RUNTIME_OUTPUT_DIRECTORY_RELEASE`为相同的东西可能会起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-21T17:00:09.963

到目前为止，我找到的最佳答案是简单地为我的每个目标和数据文件编写[CMake 安装命令](http://www.itk.org/Wiki/CMake:Install_Commands)，并将 MSVC 调试器设置为在安装目录之外运行。这具有使用 CPack 创建安装程序的额外好处。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-09T16:28:00.920

对我来说是一个全球性的：

```
set(CMAKE_STATIC_LIBRARY_PREFIX "../lib")
set(CMAKE_SHARED_LIBRARY_PREFIX "../lib") 
```

完成了工作，所以我不必为每个库设置它（CMake 2.8.4）

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-02-20T14:01:14.620

您需要更改 Visual Studio 项目的构建位置。转到项目属性并在编译选项卡上将“构建输出路径”指定为您希望的任何位置。

***笔记***

不知道这有多相关，因为我不了解 CMake。

您可以在 Visual Studio 生成事件中使用以下令牌：

`$(TargetPath)`

这将是构建项目的位置的路径，因此根据您的项目设置，这将是 Debug 或 Release 文件夹。

# latex - 如何在 LaTeX 中为段落编号？

> ID：543208
> 
> 赞同：25
> 
> 时间：2009-02-12T20:56:55.010
> 
> 标签：latex, paragraph

给定一堆段落：

```
Para. A ...

Para. B ...

Para. C ... 
```

如何让 LaTeX 自动为它们编号，即

```
1\. Para. A. ...

2\. Para. B. ...

3\. Para. C. ... 
```

我看过以下建议：

```
\newcounter{parnum}
\newcommand{\N}{%
   \noindent\refstepcounter{parnum}%
    \makebox[\parindent][l]{\textbf{\arabic{parnum}.}}}
% Use a generous paragraph indent so numbers can be fit inside the
% indentation space.
\setlength{\parindent}{2em} 
```

从这里：[comp.text.tex：Re：如何在 LaTeX 中为段落编号？](http://www.archivum.info/comp.text.tex/2008-08/msg00383.html)

然后在每个要编号的段落前使用\N，即

```
\N Para. A. ...

\N Para. B. ...

\N Para. C. ... 
```

我还看到了对[Sarovar](http://sarovar.org/projects/parano/)和[numberpar](http://mechanics.civil.tohoku.ac.jp/~bear/bear-collections/style-files/numberpar.sty)的引用，但两者都被称为“不稳定”或“不可预测”，以及诸如“随机中断”之类的东西，这让我很警惕。

我想就什么可能是最好的行动方案提出一些意见，在这里，我认为这是一个值得讨论的话题。

感谢您对此的关注和关注。

**编辑**：我试过以下

```
\begin{enumerate}
\item Para No. 1
\item Para No. 2
...
\end{enumerate} 
```

然而，它会导致排版问题，特别是因为我正在穿插部分标题ala。

```
\begin{enumerate}
\item Para No. 1
\item Para No. 2
\section{Part II}
\item Para No. 5
\item Para No. 6
...
\end{enumerate} 
```

并且标题“第二部分”的部分有时会出现在页面的最底部（即它与以下文本不一致）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-12T21:27:03.487

我认为有三种可能的解决方案（至少！）不涉及滚动您自己或其他人的宏，具体取决于您要执行的操作。

1 如果整个文档都需要编号，请使用`\paragraph`，这是一个较低级别的切片命令（如 \chapter、\section、\subsection 等）

有关更多信息，请参阅[LaTeX wikibook](http://en.wikibooks.org/wiki/LaTeX/Document_Structure#Sectioning_Commands)。

```
\setcounter{secnumdepth}{5}
...
\paragraph{If we want to} do something ... 
```

（您可能会发现这种过度杀伤/丑陋，因为它需要节和小节的正确嵌套结构而不是）

请注意，如果您使用 memoir 文档类（我毫不犹豫地推荐），则该`\setcounter`行变为`\maxsecnumdepth{paragraph}`

2 如果只是一小部分，请使用列表：

```
\begin{enumerate}
\item Para No. 1
\item Para No. 2
...
\end{enumerate} 
```

`\begin{list}...\end{list{}`3如果您想调整格式，可以使用通用列表 ( )。[除了A Guide to LaTeX](http://www.amazon.co.uk/Guide-LATEX-Helmut-Kopka/dp/0321173856/ref=sr_1_1?ie=UTF8&s=books&qid=1234476587&sr=1-1)中的那篇文章之外，我还没有立即找到一个好的在线参考资料

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-24T14:01:47.463

就我而言，我最终通过重新定义一个`\P`像段落一样工作的新宏来解决这个问题。

```
\newcounter{paranum}
\newcommand{\P}{\vspace{10pt}\noindent\textbf{\refstepcounter{paranum}\theparanum}\textbf} 
```

写一个新的“段落”我做

```
\P{Paragraph title No. 1} ...text...
...
\P{Paragraph title No. 2} ...text... 
```

使枚举链接到我使用的部分

```
\newcounter{paranum}[section]
\newcommand{\P}{\vspace{10pt}\noindent\textbf{\thesection.\refstepcounter{paranum}\theparanum}\textbf} 
```

我知道这实际上是拙劣的，但最终为我工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T21:21:51.143

我相信另一种选择是`ledmac`包装。这是文档中的引用：

> 普通的 \label、\ref 和 \label \pageref 宏可以在编号文本中使用，并以熟悉的方式操作。例如，这是一种在编号文本中对段落进行编号的方法，然后除了行号和页码之外，还可以引用段落编号。

```
\newcounter{para} \setcounter{para}{0}
\newcommand{\newpara}{%
  \refstepcounter{para}%
  \noindent\llap{\thepar. }\quad}
\newcommand{\oldpara}[1]{%
  \noindent\llap{\ref{#1}. }\quad} 
```

> \newpara 和 \oldpara 的定义将数字放在左边距并且段落的第一行缩进。您现在可以编写如下内容：

```
\linenummargin{right}
\beginnumbering
\pstart
\newpara\label{P1} A paragraph about \ldots
\pend
  In paragraph~\ref{P1} the author \ldots
\pstart
\oldpara{P1} This has the same
             \edtext{number}{\Afootnote{\ref{P1} is the paragraph, not line}}
  as the first paragraph.
\pend
\endnumbering 
```

但是，我自己从未尝试过。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-28T05:49:01.813

这个问题的一个解决方案是使用由印度特里凡得琅河谷技术公司的 CV Radhakrishnan 编写的*parano包。*

我从以下网页知道这个解决方案 [http://www.ub-filosofie.ro/~solcan/wt/gnu/n/np.html](http://www.ub-filosofie.ro/~solcan/wt/gnu/n/np.html)

# linux - 如何为 i2c 设备编写新的 Linux 驱动程序？

> ID：543212
> 
> 赞同：0
> 
> 时间：2009-02-12T20:57:38.690
> 
> 标签：linux, linux-device-driver, i2c

我有一个带有一些 i2c 控制功能的 USB 设备，我想添加一个用户空间 API 来处理这些位。如何将 i2c 支持添加到设备的现有驱动程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T21:05:48.903

这本出色的[Linux 设备驱动程序](http://lwn.net/Kernel/LDD3/)书涵盖了编写 Linux 设备驱动程序所需的大量内容，包括 USB 细节（参见第 13 章）。

# visual-studio - Visual Studio 2008 中的每种语言设置

> ID：543214
> 
> 赞同：0
> 
> 时间：2009-02-12T20:58:07.333
> 
> 标签：visual-studio, visual-studio-2008

我想根据项目的语言（或项目本身）有不同的窗口布局和插件配置。每次切换项目时是否必须使用“工具->导入和导出设置”并配置插件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T11:30:10.590

[http://geekswithblogs.net/sdorman/archive/2007/04/25/111981.aspx](http://geekswithblogs.net/sdorman/archive/2007/04/25/111981.aspx)

# maven-2 - 为什么添加一个测试 jar 会炸毁这个 Maven 构建？

> ID：543215
> 
> 赞同：2
> 
> 时间：2009-02-12T20:58:28.283
> 
> 标签：maven-2, build, testing

好的，所以我现在对 Maven 2*有点*恼火。我们得到的项目设置很简单：一个“核心”项目，它同时依赖于“批处理”和“网络”项目，以及一个“耳朵”项目，它依赖于“网络”。很简单的东西。

好吧，因为 core 用的比较多，而且这是团队第一次真正做 TDD（测试驱动开发），已经创建了很多模拟，但主要是在 web 项目中 - 批处理项目非常简单此时此刻。

这个当前的（模糊的）XML 包含在 web pom 中，以包含核心项目作为依赖项：

```
<dependency>
<groupId>${project.groupId}</groupId>
<artifactId>XYZ-core</artifactId>
<version>${project.version}</version>
</dependency> 
```

如果*只*包含这个，pom 就可以工作，以及包含的其余 jar 文件。包含的 jar 文件之一是 servlet api，2.4 是版本：

```
<dependency>
<groupId>javax.servlet</groupId>
<artifactId>servlet-api</artifactId>
<version>${version.servlet-api}</version>
<scope>provided</scope>
</dependency> 
```

这设置为提供的范围，因为它将由 Web 容器提供。那里没有惊喜。就在 web pom 中，它运行测试并安装没有问题。

但是，现在网络上有所有这些模拟。Batch 也可以使用其中的一些模拟。因此，我自然希望将核心*测试*作为批处理和 Web 中的范围测试，这样我就可以将模拟（模拟核心功能）移动到核心的测试中，以便在项目之间共享它们。以下片段（混淆）在批处理项目中有效：

```
<dependency>
<groupId>${project.groupId}</groupId>
<artifactId>XYZ-core</artifactId>
<classifier>tests</classifier>
<version>${project.version}</version>
<scope>test</scope>
</dependency> 
```

但是，当我将它添加到 web pom 时，当我尝试构建 web.xml 时，我得到了这一切。

## XYZ.java:[33,16] 无法解析符号符号：类 HttpServletRequest

如果将其删除，则 Web 构建成功。

有任何想法吗？maven 版本是 2.0.4。我可以尝试升级，但这意味着很多麻烦。

编辑： web 的主要类无法使用该错误进行编译（也没有找到 HttpServletResponse）。即使跳过测试（-Dmaven.test.skip=true），也会发生此错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T05:26:31.380

Maven 2.0.4 已经三年了，并且早于 Maven 2 与插件版本交互方式的一个相当关键的变化。在 Maven 2.0.9 之前，Maven 构建将下载所有所需插件的最新版本。您可能会遇到不一致的情况，因为您使用的是 Maven 2.0.4 的较新插件。在做任何事情之前，尽管有麻烦，请更新到 Maven 2.0.9 以上的任何内容。我很惊讶您仍然可以使用 2.0.4 构建。

此时，您应该考虑更新到 2.0.10 或 2.1.0。主要区别在于 2.1.0 包含一些并行下载改进和对加密服务器密码的支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T06:51:50.243

你应该检查 mvn help:effective-pom 有和没有有问题的块。

你也可能被[这个虫子](http://jira.codehaus.org/browse/MNG-2045)咬伤，但你必须看看它是否适用于你的出身情况。

无论如何，您真的应该至少在 maven 2.0.9 的临时区域中尝试它...您可以编辑 maven 启动脚本，这样它就不会影响您现有的存储库等。唯一可以确定的方法您不会受到已经解决的错误的影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T22:56:13.460

这不是您的 Maven 发行版本身的问题。

通常，`mvn dependency:tree`在尝试排除某些依赖项未包含在其预期工件或范围中的原因时使用。

在您的情况下，尽管您将 servlet-api 工件作为提供的依赖项提供，但您实际上需要在测试阶段可用的实现。在我看来，您批量运行的测试从不导入从 javax.servlet 导入任何内容的模拟类，但是您在 web 中的测试确实会导入从 javax.servlet 导入某些内容的模拟 - 当然，如果我在那里错了，请纠正我.

我会考虑添加一些码头实现作为测试范围的依赖项，看看这是否能让你更进一步。

# workflow - 在 trac Workflow 中添加多用户审批流程

> ID：543224
> 
> 赞同：0
> 
> 时间：2009-02-12T20:59:58.700
> 
> 标签：workflow, trac

我为我组织的项目管理工具选择了trac；我想修改默认工作流程如下：

*   所有成员都可以创建新的“增强”票证
*   所有新的“增强”工单都需要经过相同的 4 个人的批准，然后才能分配给开发人员进行工作。“缺陷”和“任务”工单不需要经过审批。

我知道我必须修改 trac.ini 的 [ticket-workflow] 区域；但在票证基本上获得批准之前，我无法弄清楚如何限制开发人员分配。

我了解这不是最佳的工作流程/流程；但这是我继承的东西，必须遵守，直到我可以改变它。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T21:39:47.077

您可以安装[TypedTicketWorkflowPlugin](http://trac-hacks.org/wiki/TypedTicketWorkflowPlugin)以将某些转换仅限于特定的工单类型。`[ticket-workflow]`然后按照（未经测试）的方式更新您的部分：

```
[ticket-workflow]
assign = new,reopened -> assigned
assign.operations = set_owner
assign.permissions = TICKET_MODIFY
assign.tickettype = defect, task

approve = new,reopened -> approved
approve.permissions = TICKET_ADMIN
approve.tickettype = enhancement

assign_enhancement = approved -> assigned
assign_enhancement.name = assign
assign_enhancement.operations = set_owner
assign_enhancement.permissions = TICKET_MODIFY 
```

您可能需要调整您的`approve.permissions`选项，以仅允许合适的人员批准增强请求。不过，我不确定您是否可以直接在选项中设置用户名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T15:30:28.983

除了 Remy 写的内容之外，为了获得您请求的多用户批准位，您可以尝试创建不同的批准状态，例如

新的，重新打开 -> 批准 1 -> 批准 2 -> 批准 3 -> 批准 4 -> 分配

（以上显然不是实际的`[ticket-workflow]`- 语法）

# ruby - 读取文件时如何避免绊倒 UTF-8 BOM

> ID：543225
> 
> 赞同：49
> 
> 时间：2009-02-12T20:59:59.653
> 
> 标签：ruby, file, unicode, byte-order-mark

我正在使用最近添加了 Unicode BOM 标头 (U+FEFF) 的数据馈送，而我的 rake 任务现在被它搞砸了。

我可以跳过前 3 个字节，`file.gets[3..-1]`但是有没有更优雅的方式来读取 Ruby 中的文件，它可以正确处理这个问题，无论 BOM 是否存在？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2011-10-15T20:48:43.207

使用 ruby​​ 1.9.2，您可以使用该模式`r:bom|utf-8`

```
text_without_bom = nil #define the variable outside the block to keep the data
File.open('file.txt', "r:bom|utf-8"){|file|
  text_without_bom = file.read
} 
```

或者

```
text_without_bom = File.read('file.txt', encoding: 'bom|utf-8') 
```

或者

```
text_without_bom = File.read('file.txt', mode: 'r:bom|utf-8') 
```

BOM 在文件中是否可用并不重要。

* * *

您还可以将 encoding 选项与其他命令一起使用：

```
text_without_bom = File.readlines(@filename, "r:utf-8") 
```

（你得到一个包含所有行的数组）。

或使用 CSV：

```
require 'csv'
CSV.open(@filename, 'r:bom|utf-8'){|csv|
  csv.each{ |row| p row }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-13T15:04:40.653

我不会盲目地跳过前三个字节；如果生产者再次*停止*添加 BOM 怎么办？你应该做的是*检查*前几个字节，如果它们是 0xEF 0xBB 0xBF，则忽略它们。这就是 BOM 字符 (U+FEFF) 采用 UTF-8 的形式；我更喜欢在尝试解码流之前处理它，因为 BOM 处理从一种语言/工具/框架到另一种语言/工具/框架是如此不一致。

事实上，这就是您*应该*如何处理 BOM 的方式。如果文件以 UTF-16 格式提供，则必须在开始解码之前检查前两个字节，以便知道将其读取为 big-endian 还是 little-endian。当然，UTF-8 BOM 与字节顺序无关，它只是为了让您知道编码是 UTF-8，以防您还不知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-03T15:05:20.387

当存在 0xEF 0xBB 0xBF 的 BOM 时，我不会“相信”某些文件被编码为 UTF-8，你可能会失败。通常在检测 UTF-8 BOM 时，当然应该是真正的 UTF-8 编码文件。但是，例如，如果有人刚刚将 UTF-8 BOM 添加到 ISO 文件中，如果其中有高于 0x0F 的字节，您将无法对此类文件进行如此糟糕的编码。如果内部只有最多 0x0F 的字节，则可以信任该文件，因为在这种情况下，它是一个 UTF-8 兼容的 ASCII 文件，同时它也是一个有效的 UTF-8 文件。

如果文件中不仅有字节 <= 0x0F（在 BOM 之后），为了确保它是正确的 UTF-8 编码，您必须检查有效序列，并且 - 即使所有序列都有效 - 还要检查每个序列中的代码点使用可能的最短序列，并检查是否没有与高或低代理匹配的代码点。还要检查一个序列的最大字节数是否不超过 4，最高代码点是否为 0x10FFFF。最高代码点还将起始字节的有效负载位限制为不高于 0x4，并且第一个后续字节的有效负载不高于 0xF。如果所有提到的检查都成功通过，那么您的 UTF-8 BOM 说明了真相。

# apache - 从特定页面的请求中删除所有查询字符串

> ID：543228
> 
> 赞同：0
> 
> 时间：2009-02-12T21:00:14.393
> 
> 标签：apache, .htaccess, mod-rewrite, redirect, query-string

我有一个 flex 应用程序，由于某种原因我不知道为什么，当您使用 google chrome 并使用 URL 中的任何查询字符串访问页面时，应用程序的行为异常。

该页面虽然不需要查询字符串。但是像 adwords 等很多东西都在查询字符串中传递变量以进行跟踪。

但是对于这个特定页面，我想在页面加载之前通过 mod_rewrite 删除所有查询字符串，以便谷歌浏览器上的用户仍然可以使用该应用程序。

有谁知道如何从请求中删除所有查询字符串到特定页面？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T21:38:58.060

我得到了它：

```
RewriteCond %{QUERY_STRING} .+ 
RewriteRule ^mothers-rings$ /mothers-rings? [R=301] 
```

# c# - 帮助使用 C# 在 .NET 3.5 中设计可重用的路由系统

> ID：543232
> 
> 赞同：0
> 
> 时间：2009-02-12T21:01:20.193
> 
> 标签：c#, asp.net

我正在构建一些需要支持审批的 ASP.NET 网络表单。批准将基于可能表示为树的组织结构图完成。我一直在考虑批准路由（确定应该将某些东西路由给谁的过程）应该与正在执行的操作分开。这将允许我对多个解决方案使用相同的批准路由。这有意义吗？？？.NET 的开源中是否存在类似的东西，我可以看看我应该如何实现/设计它？

这是我想做的一个例子：

创建了一个新的采购订单并需要对其进行审批，第一个业务规则 A 在执行业务规则 B 之前需要 2 个更高级别的授权。

员工 --> 主管 --> 部门经理

我想我会将用户传递给审批路由服务，但我不确定我应该得到什么。我认为我应该返回完整的路线，以防在提交后对组织结构图/树进行更新。

例子：

提出请求的员工在整个请求期间都在 CS（“客户服务”）中。** CS 员工 --> CS 主管 --> CS 部门经理

员工在请求期间转移到销售部门。** 销售员工 --> 销售主管 --> 销售部门经理

由于用户移动部门，事情变得混乱，这就是为什么我认为应该保存整个路线。合乎逻辑？我认为员工变动不会很普遍，但我想确保我预先应用最佳实践......在注入异常之前预先最合乎逻辑的解决方案。

任何关于设计的反馈/想法都会受到极大的赞赏，如果存在实现这种类型的解决方案的东西，我很想听听它，以及对人们过去尝试做一些本土事情的经验的任何反馈。这看起来很简单，但在我编码之前，我想看看其他人的想法......我敢肯定有一些我没有想过的关键事情。

我在这个项目中使用的编程技术是 IIS 7.0、VS2008、.NET 3.5 和 C#。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T21:04:49.733

您是否考虑过使用 Windows Workflow 来控制您的路由？在“WF ASP.NET”上进行快速搜索会显示很多关于执行此操作以控制导航等的信息。这可能是您的最佳选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T21:25:01.573

控制审批流程或任何未来可能发生变化的业务流程的工作流程正是 Windows 工作流程的全部内容，我赞同 Scott 的建议。（将其设为 wiki 答案，因为我只是在回应 Scotts 的答案并提供链接。）

[入门指南在这里](http://social.msdn.microsoft.com/content/en-us/msft/netframework/wf/GettingStarted)

# class - VBA 用户窗体对象

> ID：543243
> 
> 赞同：1
> 
> 时间：2009-02-12T21:04:16.927
> 
> 标签：class, vba, ms-office, userform

我真的在这里为某些事情苦苦挣扎。我有一个类模块，我们称之为 FormMan，它有一堆与我项目中的大量用户表单相关的方法。一种特殊的方法可以从很多不同的地方调用，而且非常简单——它只是将用户定义的控件数量添加到表单并扩展表单高度以适应这些新控件。

用户传递控件的数量和用户窗体。

```
oF.AddControlsToForm iNumberOfControls,frmTest 
```

在 FormMan 类模块中：

```
Public Sub Addcontrols(iNum as integer, oForm as userform)

//stuff happens here, oForm is used extensively

oForm.Height = i  //object does not support this property or method
frmTest.Height = i //works

oForm.Show //object does not...
frmTest.show  //works

end sub 
```

在 Locals 窗口中，oForm 没有高度属性，所以很公平。但 oForm 已被定义为 frmTest。我可以说`oForm.BackColor = vbred`，我可以设置`ctl = oform.TextBox1`例如

这是一个通用过程，可以将一堆控件添加到任何形式。在将表单分配给 oForm 之前，我已经尝试加载并显示表单。

为什么用户窗体的高度和显示属性和方法，而不是声明为用户窗体的对象？我究竟做错了什么？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T21:17:15.710

这里的问题是 UserForm 和 frmTest 对象不是同一类型。事实上，frmTest 是 UserForm 的一个子类型，它通过添加 Height 属性以及其他成员来扩展它。

您可能不得不求助于将您的函数参数声明为 Object。

```
Public Sub Addcontrols(iNum as integer, oForm as Object) 
```

这应该可以按您的意愿工作，尽管不幸的是您会牺牲类型安全。大多数 OO 概念在 VBA 的上下文中往往会分崩离析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T21:20:51.287

关于 VBA，首先要记住的是它是准 OO，而不是完全 OO。我在这个问题上遇到了很多古怪的问题，所以我现在倾向于避免完全依赖 VBA 的一致性。

话虽如此，试试这个：

```
Dim fname = oForm.Name (or whatever the property is for this subobject)
With VBA.UserForms.Add(fname)
   .Height = x
   .Show
End With 
```

是不是很诡异？！？！我没有准备好等待的代码示例，所以我不能保证成功，但这感觉是正确的方法。

# c# - 关于装饰器和策略模式 C# 的设计 OOP 问题

> ID：543254
> 
> 赞同：3
> 
> 时间：2009-02-12T21:06:44.427
> 
> 标签：c#, oop, design-patterns, decorator, strategy-pattern

例如说你有一个基础抽象类

```
public abstract Foo
{
  IFlyable _fly;
  ISwimmable _swim;

  void performSwim()
  {
    _swim.swim();
  }

 void performFly()
 {
   _fly.fly();
 }
} 
```

并拥有系统中的行为/算法

```
interface IFlyable { void fly(); }
interface ISwimmable { void swim(); }
interface IVoteable { void vote(); } 
```

等等等等

现在你有多个实现它的类，具体的 IFlyable、ISwimmable 等

```
class Bar: Foo { _swim = new ConcerteSwim(); }
class Baz: Foo { _fly = new ConcreteFly(); } 
```

等等等等

一种是使用 Foo 基类中的策略模式来交换行为。

我们也可以使用装饰器模式将其包装为特定的行为，但由于装饰器使用基类包装它，如果稍后我们向对象添加更多行为，我们如何真正允许打开关闭原则在不触及基类的情况下工作。由于这些行为在我们添加更多时可能具有不同的签名，而不仅仅是例如调用装饰器

```
void performSwim()
{
     swimWithMoreSpeed() + foo.performSwim()
} 
```

我想我的问题是如果我添加更多行为，我怎么能不修改基类并且仍然能够说添加 IWeaponBehavior、ISomeBehaviour 到一个类。

例如我想上课

```
public class XYF: Foo
{

} 
```

但是我想给它一些 ISomeBehaviour 的行为，有没有办法可以说用这些行为包装它，或者更像是一个 ConcreteFoo 用这些行为包装它，现在做一些事情而不是在具体 xyz 上实现接口虽然这让你实现了这么多种具体的行为类，比如游泳行为、空行为等，但没有办法摆脱它。

有没有办法在设计模式中做到这一点？它几乎看起来像是一种混合模式。

我知道，如果它像鸭子一样走路，像鸭子一样嘎嘎叫，但需要电池，那么你的抽象就有问题了。

希望这是有道理的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T21:48:17.413

试试装饰器模式。要支持新行为，您只需实现一个新类，该类继承自`Foo`、实现`IWeaponBehavior`和装饰另一个`Foo`对象。然后您现在可以将其`WeaponDecorator`用作`Foo`or`IWeaponBehavior`并且仍然可以访问`Foo`它所装饰的基础。

基类：

```
public abstract Foo { void Jump(); } 
```

具有基本行为的具体子类：

```
public Bar : Foo { void Jump() { /* jump! */ } }
public Baz : Foo { } 
```

行为接口：

```
interface IFlyable { void Fly(); }
interface ISwimmable { void Swim(); } 
```

具有行为的装饰器子类：

```
public FlyableFoo : Foo, IFlyable
{
    public Foo Base { get; set; }
    public FlyableFoo(Foo base) { Base = base; }
    void Fly() { Base.Jump(); /* fly! */ }
} 
```

现在我们可以使用它的特定实现进行任何`Foo`飞行`Jump()`：

```
Baz baz = new Baz();
FlyableFoo flybaz = new FlyableFoo(baz);
flybaz.Fly(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T22:43:01.263

访客模式怎么样？它允许基类的实现者改变行为，而无需强制基类针对每个新实现进行更改：

```
public interface IFlyable { void fly(); }
public interface ISwimmable { void swim(); }
public interface IVoteable { void vote(); }

public abstract class Animal
{
    public abstract void Accept(AnimalVisiter Visitor);
    //some common behaviour is here
    public bool LegsKicking { get; set; }
    public bool ArmsFlapping { get; set; }
}

//This class now absorbs new responisbilities, so base class doesn't have to
public class AnimalVisiter
{
    public void Visit(ISwimmable Subject)
    {
        Subject.swim();
    }

    public void Visit(IVoteable Subject)
    {
        Subject.vote();
    }

    public void Visit(IFlyable Subject)
    {
        Subject.fly();
    }
}

public class SwimmingHuman : Animal, ISwimmable
{
    public void swim()
    {
        LegsKicking = true;
    }

    public override void Accept(AnimalVisiter Visitor)
    {
        Visitor.Visit(this);
    }
}

public class VotingHuman : Animal, IVoteable
{

    public override void Accept(AnimalVisiter Visitor)
    {
        Visitor.Visit(this);
    }

    public void vote()
    {
        VoteCast = true;
    }
    //some specific behaviour goes here
    public bool VoteCast { get; set; }
}

public class SwimmingTiger : Animal, ISwimmable
{

    public void swim()
    {
        LegsKicking = true;
        //also wag tail, flap ears
    }

    public override void Accept(AnimalVisiter Visitor)
    {
        Visitor.Visit(this);
    }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-02-12T21:39:53.520

所以这是我对此的看法：

```
public enum ActionType
{
   Swim, Vote, Fly
};

public interface IBehavior
{
   public boolean ActionReady;
   public ActionType _type;

   public void performMyAction();
}

public abstract Foo
{
  IBevahior[] behaviors;

  // if you want to keep track of behavior states as on or off
  void perform()
  {
    for(int i = 0; i< behaviors.length; i++)
    {
       if(behaviors[i].ActionReady)
       {
          behaviors[i].performMyAction();
       }
    }
  }

  // if you want to call behaviors individually
  void performType(ActionType type)  // however you want to make the distinction
  {
     for(int i = 0; i < behaviors.length; i++)
     {
        if(behaviors[i].type = type)
        {
            behaviors[i].performMyAction();
        }
     }
  }
} 
```

然后让您的接口（如 ISwimmable 等）从 IBehavior 继承。

# c# - 您如何确保 .Net 始终从命名空间树的根目录搜索命名空间？

> ID：543256
> 
> 赞同：0
> 
> 时间：2009-02-12T21:07:16.297
> 
> 标签：c#, namespaces

有没有办法告诉 .Net 从命名空间树的*根目录搜索命名空间？*

假设我有这两个完全独立的命名空间：

```
Apple.Orange.Banana
Orange.Grape.Peach 
```

假设他们来自不同的程序员，每个人中的“橙色”完全是巧合。

如果我在“Apple.Orange.Banana”中并且我试图导入（或引用）“Orange.Grape.Peach”，.Net 我试图从“Apple.Orange.Banana”中的“Orange”中搜索的东西”。

我该如何告诉它，“从*根本上看*，而不是我现在所在的位置。” 这会很棒：

```
~Orange.Grape.Peach 
```

但是，唉，这不存在。

我知道你们中的一些人会说我应该更好地规划命名空间，但是当我使用来自两个地方的代码时会发生什么，这些代码带有我无法更改的预定义命名空间，并且正如我上面提到的那样它们冲突？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T21:19:02.803

您是否尝试过使用 global:: 解析范围？例如，如果您有以下情况：

```
private global::Orange.Grape.Peach.classname x; 
```

此外，根据命名空间是在命名空间声明之外还是内部导入，您会获得不同的分辨率，因此

```
using System.Linq;
namespace MyLinq 
{
   // ...
} 
```

可以提供不同的解析规则：

```
namespace MyLinq 
{
   using System.Linq;

   // ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T21:13:27.013

您可以像这样为根 Orange 起别名：

```
using RootOrange = Orange; 
```

然后你可以这样做：

```
RootOrange.Grape.Peach 
```

# design-patterns - mixin被认为是一种设计模式吗？

> ID：543262
> 
> 赞同：11
> 
> 时间：2009-02-12T21:07:44.110
> 
> 标签：design-patterns, mixins

混入被认为是一种设计模式吗？结构？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T22:07:02.220

它们是一种语言功能。“模式”与特征不同，因为它解决了一组可能以相互矛盾的方式影响情况的力量。特征，通过它们的存在或不存在，往往会*产生*模式解决的力量。许多设计模式（Double Dispatch 是一个很好的例子）开始解决语言限制（在这种情况下方法分派在单个参数上）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T21:13:19.603

是的，它是在 Ruby 中的。

[Ruby 中的设计模式](https://rads.stackoverflow.com/amzn/click/com/0321490452)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T21:25:01.480

是的，它在 D 中。

“设计模式是软件设计中常见问题的通用可重用解决方案”——维基百科

D 被编译为机器代码，通过使用 mixins，您可以使用它来使模板比在 C++ 中更有用。

[http://www.digitalmars.com/d/1.0/template-mixin.html](http://www.digitalmars.com/d/1.0/template-mixin.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-25T13:02:28.777

Mixin 不是设计模式。大多数时候它们是语言功能！例如，在语言 D 中，“mixin”是一个关键字。将关键字用于其预期目的不是模式。关键字/语言特征的典型用法可能被称为“成语”。

层次结构是“无”、成语、设计模式、架构模式。

# c# - Assert.AreNotEqual 和 Assert.AreNotSame 有什么区别？

> ID：543263
> 
> 赞同：63
> 
> 时间：2009-02-12T21:07:54.330
> 
> 标签：c#, .net, unit-testing, testing, assert

在 C# 中，有什么区别

```
Assert.AreNotEqual 
```

和

```
Assert.AreNotSame 
```

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-02-12T21:21:10.320

这里给出的几乎所有答案都是正确的，但可能值得举一个例子：

```
public static string GetSecondWord(string text)
{
    // Yes, an appalling implementation...
    return text.Split(' ')[1];
}

string expected = "world";
string actual = GetSecondWord("hello world");

// Good: the two strings should be *equal* as they have the same contents
Assert.AreEqual(expected, actual);

// Bad: the two string *references* won't be the same
Assert.AreSame(expected, actual); 
```

`AreNotEqual`并且`AreNotSame`只是`AreEqual`和`AreSame`当然的倒置。

[编辑：对当前接受的答案](https://stackoverflow.com/questions/543263/whats-the-difference-between-assert-arenotequal-and-assert-arenotsame/543337#543337)的反驳......

如果您使用`Assert.AreSame`值类型，它们将被装箱。换句话说，它相当于做：

```
int firstNumber = 1;
int secondNumber = 1;
object boxedFirstNumber = firstNumber;
object boxedSecondNumber = secondNumber;

// There are overloads for AreEqual for various value types
// (assuming NUnit here)
Assert.AreEqual(firstNumber, secondNumber);

// ... but not for AreSame, as it's not intended for use with value types
Assert.AreSame(boxedFirstNumber, boxedSecondNumber); 
```

既`firstNumber`没有也没有`secondNumber`对象值，因为`int`是值类型。调用失败的原因`AreSame`是因为在 .NET 中，每次对值进行装箱都会创建一个新框。（在 Java 中它有时不会——这让我很困惑。）

基本上你不应该*在*`AreSame`比较值类型时使用。比较*引用*类型时，`AreSame`如果要检查相同的引用，请使用；用于`AreEqual`检查 下的等价性`Equals`。编辑：请注意，有些*情况*下 NUnit 不`Equals`直接使用；它具有对集合的内置支持，其中集合中的元素被测试是否相等。

答案中的主张是：

> Using the example above changing the int to string, AreSame and AreEqual will return the same value.

entirely depends on how the variables are initialized. If they use string literals, then yes, interning will take care of that. If, however, you use:

```
string firstString = 1.ToString();
string secondString = 1.ToString(); 
```

then `AreSame` and `AreEqual` will almost certainly *not* return the same value.

As for:

> The general rule of thumb is to use AreEqual on value types and AreSame on reference types.

I almost *never* want to check for reference identity. It's rarely useful to me. I want to check for *equivalence* which is what `AreEqual` checks for. (I'm not saying that `AreSame` shouldn't be there - it's a useful method, just far more rarely than `AreEqual`.)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-12T21:10:30.767

两件事可以相等，但对象不同。AreNotEqual 通过相等测试检查对象*值*，而 AreNotSame 检查它们是否不是完全相同的对象。

很明显我们为什么要测试 AreNotEqual 的东西（我们关心被测试的值）；AreNotSame 怎么样？当您传递引用并希望确保在完成混洗后两个引用仍然是同一个对象时，就会发现它在测试中的用处。

在现实世界的案例中，我们使用大量缓存对象来减少到数据库的往返次数。在将对象移交给缓存系统后，我们的单元测试确保在某些情况下我们会返回相同的对象（缓存是有效的），而在其他情况下我们会返回一个*新*的对象（缓存无效）。请注意，在这种情况下，AreNotEqual 是不够的。如果对象在数据库中有一个新的时间戳，但*数据*没有“足够不同”而无法通过相等性测试，则 AreNotEqual 不会注意到我们刷新了*对象*。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-02-12T21:11:17.300

[AreNotSame](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.assert.arenotsame.aspx)进行引用比较，而[AreNotEqual](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.assert.arenotequal.aspx)进行相等比较。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-12T21:13:25.830

Assert.AreNotEqual 断言两个值不相等。

Assert.AreNotSame 断言两个变量不指向同一个对象。

示例 1：

```
诠释 i = 1;
诠释 j = 我;
// 值相等：
断言.AreEqual(i, j);
// 两个值类型*不*代表同一个对象：
断言.AreNotSame(i, j);

```

示例 2：

```
字符串 s = "A";
字符串 t = s;
// 值相等：
断言.AreEqual(s, t);
// 引用类型*可以*指向同一个对象：
断言.AreSame(s, t);

```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-12T21:11:34.897

AreNotSame 使用引用相等 ( `object.ReferenceEquals`) - 即它们是对象的相同实际实例吗？AreNotEqual 使用概念上的相等 ( `.Equals`) - 即它们是否*被视为*相等。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-12T21:13:06.220

不是说 AreNotEqual 根据 Equals() 方法检查两个对象不相等的情况，而 AreNotSame 则检查两个对象引用不相同的情况。因此，如果 x 和 y 是两个在 Equals() 方面相等但已分别分配的对象，则 AreNotEqual() 将触发断言失败，而另一个则不会。

# javascript - Javascript新手，有人可以逐行解释这段代码吗？

> ID：543264
> 
> 赞同：3
> 
> 时间：2009-02-12T21:08:09.587
> 
> 标签：javascript

我使用此代码来保持滚动位置，但不知道它的含义。如果有人有时间，您能否逐步解释一下它在做什么。这里是：

```
<script language="javascript"  type="text/javascript">
    var xPos, yPos;
    var prm = Sys.WebForms.PageRequestManager.getInstance();

        function BeginRequestHandler(sender, args) {

        if ($get('<%=lstAuctions.ClientID %>') != null) {

            xPos = $get('<%=lstAuctions.ClientID %>').scrollLeft;
            yPos = $get('<%=lstAuctions.ClientID %>').scrollTop;
        }
    }

    function EndRequestHandler(sender, args) {

        if ($get('<%=lstAuctions.ClientID %>') != null) {

            $get('<%=lstAuctions.ClientID %>').scrollLeft = xPos;
            $get('<%=lstAuctions.ClientID %>').scrollTop = yPos;
        }
    }

    prm.add_beginRequest(BeginRequestHandler);
    prm.add_endRequest(EndRequestHandler);

</script> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T21:13:08.263

```
var xPos, yPos; // global variable declaration
var prm = Sys.WebForms.PageRequestManager.getInstance(); // Some webforms javascript manager

/*
* Begin function with 2 arguments
*/
function BeginRequestHandler(sender, args) {

    // check if the element generated by .net with id 'lstAuctions.ClientID' exists
    if ($get('<%=lstAuctions.ClientID %>') != null) {

        // get its scroll left and top position and
        // assign it to the global variables
        xPos = $get('<%=lstAuctions.ClientID %>').scrollLeft;
        yPos = $get('<%=lstAuctions.ClientID %>').scrollTop;
    }
}

/*
* this method gets executed last, it uses the 
* already set global variables to assign the old scrollpositions again
*/
function EndRequestHandler(sender, args) {

    if ($get('<%=lstAuctions.ClientID %>') != null) {
        // assign the previous scroll positions
        $get('<%=lstAuctions.ClientID %>').scrollLeft = xPos;
        $get('<%=lstAuctions.ClientID %>').scrollTop = yPos;
    }
}

// first function gets executed on the beginning of a request
prm.add_beginRequest(BeginRequestHandler);
// second function gets executed on the end of the request
prm.add_endRequest(EndRequestHandler); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T21:15:49.457

[Sys.WebForms.PageRequestManager](http://msdn.microsoft.com/en-us/library/bb398822.aspx)是一个 ASP.Net AJAX 构造。

特别是在您的代码中，有一些分配的变量（xPos、yPos、prm）和两个定义的函数（BeginRequestHandler、EndRequestHandler）。代码末尾是两个函数调用（prm.add_beginRequest、prm.add_endRequest），它们将这些函数分配为事件处理程序。

$get 调用是库的一部分，作为从客户端获取数据的快捷方式。它是非常隐蔽的 javascript，但它只是通过 ASP.Net AJAX 客户端库的语法实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T21:20:27.467

你确实问...

```
// declare 2 variables
var xPos, yPos;
// get an instance of the PageRequestManager - this looks like an MS ajax helper class
var prm = Sys.WebForms.PageRequestManager.getInstance();

// declare a function
function BeginRequestHandler(sender, args) {

    // get the ClientSide HTML DOM element which corresponds to the lstAuctions asp control on the serverside
    if ($get('<%=lstAuctions.ClientID %>') != null) {
        // if the element is not null (eg: page is not broken)

        // get the x Position of the object relative to what is displayed by the scrolled window (if you scroll sideways this value changes)
        xPos = $get('<%=lstAuctions.ClientID %>').scrollLeft;
        // get the y Position of the object relative to what is displayed by the scrolled window (if you scroll up/down this value changes)
        yPos = $get('<%=lstAuctions.ClientID %>').scrollTop;
    }
}

// declare a function
function EndRequestHandler(sender, args) {

    // get the ClientSide HTML DOM element which corresponds to the lstAuctions asp control on the serverside
    if ($get('<%=lstAuctions.ClientID %>') != null) {
        // if the element is not null (eg: page is not broken)

        // set the x position of the object to what we got last time (horizontal scroll the page)
        $get('<%=lstAuctions.ClientID %>').scrollLeft = xPos;

        // set the y position of the object to what we got last time (vertical scroll the page)
        $get('<%=lstAuctions.ClientID %>').scrollTop = yPos;
    }
}

// tell the page request manager to call our BeginRequestHandler method when it begins it's request
prm.add_beginRequest(BeginRequestHandler);

// tell the page request manager to call our EndRequestHandler method when it ends it's request
prm.add_endRequest(EndRequestHandler); 
```

基本上，看起来页面正在使用 MS ajax 库来显示一些动态内容（可能用另一个列表替换一个列表），但保留了用户滚动到的位置，因此页面在新的页面不会“跳转”内容替换旧内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T21:11:19.187

[向左滚动](http://msdn.microsoft.com/en-us/library/ms534617(VS.85).aspx)

[滚动顶部](http://msdn.microsoft.com/en-us/library/ms534390(VS.85).aspx)

[Sys.WebForms.PageRequestManager 类](http://msdn.microsoft.com/en-us/library/bb311028.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T21:18:04.443

变量 xPos, yPos;

**声明两个全局变量。

* * *

函数 BeginRequestHandler(sender, args) {

**声明一个新函数。此函数可能用于事件处理程序

if ($get('<%=lstAuctions.ClientID %>') != null) {

**这是 <% %> 配对中定义的内联 ASP/ASP.NET 代码的组合。

xPos = $get('<%=lstAuctions.ClientID %>').scrollLeft;

**将页面的当前滚动位置捕获到局部变量中。

yPos = $get('<%=lstAuctions.ClientID %>').scrollTop;

**将页面的当前滚动位置捕获到局部变量中。

* * *

功能 EndRequestHandler（发件人，参数）{

**声明一个新函数。此函数可能用于事件处理程序

if ($get('<%=lstAuctions.ClientID %>') != null) {

**这是 <% %> 配对中定义的内联 ASP/ASP.NET 代码的组合。

$get('<%=lstAuctions.ClientID %>').scrollLeft = xPos;

**将页面的滚动位置设置为 xPos 的值。

$get('<%=lstAuctions.ClientID %>').scrollTop = yPos;

**将页面的滚动位置设置为 xPos 的值。

* * *

var prm = Sys.WebForms.PageRequestManager.getInstance();

**向 PageRequestManager 声明并初始化一个新变量。

prm.add_beginRequest(BeginRequestHandler);

**将上面定义的事件处理程序添加到当前页面的 beginRequest 中。

prm.add_endRequest(EndRequestHandler);

**将上面定义的事件处理程序添加到当前页面的 endRequest 中。

# asp.net-mvc - 在 LINQ to SQL 数据上下文中插入项目 - 直到应用程序重新启动才会出现

> ID：543269
> 
> 赞同：1
> 
> 时间：2009-02-12T21:09:23.467
> 
> 标签：asp.net-mvc, linq-to-sql

我有一个 ASP.NET MVC（使用候选版本）应用程序，它与一个类库一起使用，其中使用 LINQ to SQL 进行数据持久性。

app/db 维护的一件事是“文件夹”的概念 - 类似于磁盘文件夹，但具有仅存在于数据库中的层次结构。从用户的角度来看，其他数据库对象位于这些文件夹中。

类库中的每个类都有自己的对我的 DataContext 对象的静态引用。此外，每个 MVC 控制器都有自己的 DataContext 对象。

我有两个返回 JSON 数据的操作。一种是“GetFoldersJSON”，它以适合选择（下拉）列表的格式返回文件夹结构。另一种是“AddFolderJSON”，它接受一些表单数据，将新文件夹插入数据库，然后返回 GetFoldersJSON() 用于将新文件夹列表发送给客户端。创建新文件夹后，客户端使用 AJAX 和这些操作刷新下拉列表。

这个操作的流程是这样的：

1.  AddFolderJSON() 操作 - 使用新文件夹名称、父文件夹等获取表单信息。

2.  创建新的文件夹对象。执行 dataContext.Folders.InsertOnSubmit(newFolder); 执行 dataContext.SubmitChanges(); 执行 dataContext.Refresh(OverwriteThingy, dataContext.Folders); GetFoldersJSON() 返回结果

3.  GetFoldersJSON() 使用位于文件夹定义中的函数 - 扩展 OR 映射文件夹对象的部分类。此函数使用如下代码递归地将文件夹和子文件夹添加到平面列表中：

    ```
    var rootFolders = from f in db.Folders
                      where f.ParentFolder == null
                      orderby f.name
                      select f; 
    ```

db 当然是本地的静态 DataContext 引用。

然后是一个简单的循环：

```
 foreach (var fldr in rootFolders)
    {
        AddFolderContents(list, fldr);
    } 
```

AddFolderContents() 函数然后将当前文件夹添加到列表中，并继续为当前文件夹的每个子文件夹调用自身，从而创建层次结构。

这适用于数据库中已有的数据，但是当我们在创建新文件夹后运行此过程时，新文件夹不会显示。如果我们刷新页面，它仍然不显示。在应用程序重新启动之前，它实际上不会显示。

我几乎在任何地方都尝试过 Refresh() 调用，在这种情况下似乎没有效果。

有没有办法告诉 LINQ to SQL “嘿，我知道你在想什么，但是把它全部删除，然后从数据库中获取所有数据，现在！”？

我有一种唠叨的感觉，我以前听说过这个，但在这里找不到它的描述。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T22:32:19.790

我有一种感觉，您没有按照预期的方式使用 DataContext 对象（保存静态引用）。

DataContext 对象旨在用作“工作单元”......实例化它，做你的工作，处理它。需要做更多的工作吗？实例化另一个，做你的工作，处理它。

在[这个 MSDN 页面](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.aspx)中，微软说：

> DataContext 是通过数据库连接映射的所有实体的源。它跟踪您对所有检索到的实体所做的更改，并维护一个“身份缓存”，以保证多次检索到的实体通过使用相同的对象实例来表示。
> 
> 通常，DataContext 实例旨在持续一个“工作单元”，但是您的应用程序定义了该术语。DataContext 是轻量级的，创建起来并不昂贵。典型的 LINQ to SQL 应用程序在方法范围内创建 DataContext 实例，或者将其作为表示一组相关数据库操作的逻辑集的短期类的成员。

同样，如果您阅读 Joseph 和 Ben Albahari 的[10 LINQ Myths](http://www.albahari.com/nutshell/10linqmyths.aspx)页面的底部（他们是[C# In A Nutshell](http://www.albahari.com/nutshell/)的作者），您将看到有关使用静态数据上下文的引用：

> 此策略将导致数据陈旧，因为 DataContext 实例跟踪的对象不会简单地通过重新查询来刷新。
> 
> 在分布式应用程序的中间层使用单个静态 DataContext 实例会导致更多麻烦，因为 DataContext 实例不是线程安全的。
> 
> 正确的方法是根据需要实例化新的 DataContext 对象，使 DataContext 实例的生命周期相当短。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T21:17:34.727

> 有没有办法告诉 LINQ to SQL “嘿，我知道你在想什么，但是把它全部删除，然后从数据库中获取所有数据，现在！”？

db = new customDataContext();

> db 当然是本地的静态 DataContext 引用

是的，注意那里。ASP.NET 是多线程的，您不想共享不安全的线程 DataContext 实例。

* * *

似乎您正在通过其父母访问子文件夹。DataContext 缓存它已经读取的对象的状态，并在进一步查询时将这些相同的实例返回给您。需要通知父实例它有一个新的子实例。检查生成的 ParentFolder 属性，看看它是否通知父文件夹。如果是这样，您在做生意：

```
child.ParentFolder = parent; 
```

如果没有，你需要这样做：

```
parent.Children.Add(child); 
```

不要通过 id 来做，在这种情况下，自动生成的代码不会通知父对象。

```
child.ParentFolderId = parent.Id; //bad, broken, do not do 
```

在您的 SubmitChanges 调用之前执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T22:07:52.047

我的第一直觉是：-

David B 为您提供了其中一种可能性，即 DataContect 的新功能，但还有另一种。

```
db.Refresh(System.Data.Linq.RefreshMode.KeepChanges, myObjectsCollection) 
```

myObjectionCollection 是您希望从数据库中刷新的所有 Linq 对象的集合。（即在你的情况下大部分都是）。

当心它是 sllllooooowwwww ！显然它在 EF 中更好 - 请参见[此处](https://stackoverflow.com/questions/484691/enitity-framework-with-long-running-object-context)。

然而，在更仔细地重新阅读时，我不确定它发生了什么。Linq 应该找到新记录（但不是更新的记录），即使没有刷新它们也应该出现。

嗯……

# database - 数据库允许应用程序始终通过 SP 执行 CRUD 操作是最佳实践吗？

> ID：543274
> 
> 赞同：3
> 
> 时间：2009-02-12T21:10:07.880
> 
> 标签：database, linq-to-sql, database-design

我听说过这背后的推理，我很好奇其他人是否认为这是最佳实践/好主意。

一个原因是，限制对数据库表的直接访问，并强制应用程序/用户使用 SP（存储过程）进行 CRUD 操作将允许 DBA

1.  在将 SP 投入生产之前进行细粒度控制以批准/审查 SP
2.  避免开发人员编写的可能导致服务器负载/其他服务器问题的随机查询

这意味着开发人员不能在表上编写 Linq 查询（尽管涉及 SP 的 Linq 查询是可能的）这也意味着开发人员必须忘记编译时检查以及完全控制数据，而主要使用另一种语言（ SQL) 来处理数据。

我不反对这一点，也不认为这是一个好主意。我只是想知道其他人的想法。这种方法还有什么其他优点和缺点。

**更新**：正如[Thomas 在他的回答](https://stackoverflow.com/questions/543274/is-it-a-best-practise-for-a-database-to-allow-apps-do-crud-operations-always-thro/543578#543578)中提到的，我倾向于认为 SP 是逻辑，只要不是“业务逻辑”，就可以使用“SQL 中的数据库编程”来执行逻辑。业务逻辑需要分离、编译时检查和集成检查点等等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T21:25:49.607

就个人而言，我从来没有发现 procs 对于 CRUD 中的“R”足够灵活。我通常使用视图。但是通过**视图和过程访问数据库还允许您抽象出数据库表，从而**在未来为数据模型提供更大的灵活性......几乎就像在接口上工作一样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T22:51:17.200

完全取决于您的环境。这个问题的答案真的不是一个编码问题，而是一个商业决策。

如果您的数据库只支持一个应用程序，并且与它合理地紧密集成，那么出于灵活性的原因，最好将您的逻辑放在您的应用程序中。在这些情况下，将数据库简单地作为使用通用功能的普通数据存储库来处理几乎不会让您失去什么并获得灵活性 - 与供应商、实施、部署和许多其他方面。

另一方面，如果您正在处理*公司*数据库，那么强烈建议您尽可能地降低安全性。至少应该启用所有适当的约束，并且如果可能的话，应该仅通过视图和过程访问数据。在这些情况下，抱怨程序员应该被忽略，因为......

1.  对于企业数据库，资产是有价值的，无效的数据或操作可能会产生危及业务的后果。在这些情况下，您主要关心的是业务，而不是您的编码人员访问的方便程度。
2.  根据定义，此类数据库由多个应用程序访问。您需要使用存储过程提供的抽象，以便在升级应用程序 A 并且您没有升级应用程序 B 的资源时可以更改数据库。
3.  类似地，将业务逻辑封装在 SP 中而不是应用程序代码中，可以比将此类逻辑嵌入应用程序代码中更容易和可靠地在整个业务中实现对此类逻辑的更改。例如，如果税收计算发生变化，如果必须在一个 SP 中更改计算，而不是在多个应用程序中更改，那么它的工作量会减少，而且更健壮。这里的经验法则是业务规则应该在最接近其唯一数据的点实现 - 因此，如果您有一个专业应用程序，那么该应用程序的逻辑可以在该应用程序中实现，但逻辑更广泛适用业务应在 SP 中实施。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T21:23:04.743

我在一个采用这种方法的团队中工作。

还有其他好处，比如

1.  安全性——如果您不能直接访问基表，它可以作为深度防御方法的一部分。
2.  PDM 的灵活性 - 您可以出于性能原因对 PDM 进行大规模更改，并且只要您保留“合同”（SP、视图），应用程序层就不会意识到这一点。
3.  面向未来 - 您已经准备好迎接另一个可能用另一种语言编写的应用程序来访问您的数据库。

当您有专门的数据库人员或团队时，它的效果最好。

我正在饶有兴趣地关注这个领域，因为它似乎与使用 ORM 时所需的技术背道而驰。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T22:55:51.043

使用存储过程（以及不使用动态 SQL 的过程）允许数据库人员进行性能调整，更重要的是，它限制了对数据库表和视图的访问，因此除了 dba 之外没有人可以更改它们。如果您有财务应用程序并希望防止内部欺诈，这一点非常重要。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-12T23:18:03.610

这篇博客文章很好地反驳了“存储过程总是更好”的人群。

[http://statestreetgang.net/post/2008/04/My-Statement-on-Stored-Procedures.aspx](http://statestreetgang.net/post/2008/04/My-Statement-on-Stored-Procedures.aspx)

就个人而言，我持观望态度，倾向于使用它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T21:19:52.927

这在很大程度上取决于您的数据和环境。

如果您要让不同的读者和作者广泛使用您的数据库，请使用 SPROC：这样您就可以保持绝对控制。

如果您在一个更封闭的商店中信任开发人员，请使用 LINQ。它允许更灵活地访问数据，并使未来对数据库的更改变得轻而易举。（例如，如果您向表中添加一个字段，您只需要重新生成 LINQ 数据访问部分类就完成了；否则您将不得不重写一堆 SPROC，以及更改应用程序中的数据访问层.)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T21:22:37.990

要使用您的列表：

这意味着开发人员不需要在表上编写 Linq 查询。这也意味着开发人员可以忘记对数据库访问代码的编译时检查，让了解数据库的人完全控制数据。并且开发者不需要使用另一种语言（SQL 或 Linq）来处理数据。

换句话说，这取决于您的工作环境。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T21:49:33.433

是的，尤其是在 Oracle 中。

在 Oracle 中，触发器和外键需要很多`SQL/PLSQL`上下文切换。

我个人通过以下方式开发需要*大量操作的数据库：* `CRUD`

1.  我既不使用触发器也不使用外键。
    *   不授予用户对表的修改权限。
    *   数据库中的所有`DML`内容都是这样执行的：
        1.  将要插入/更新/删除的数据加载到`TEMP`表中
    *   调用存储过程，其中：
        1.  检查数据的一致性，如`BEFORE I/U/D`触发器和外键
            *   数据被`MERGE`'d到表中
            *   检查数据的一致性，如`AFTER I/U/D`触发器和外键

在数据库中，我有一个服务表，其中包含`foreign key`字段之间的这些类似关系。

过程的存根是从该表中自动生成的，并且每次表更改时都需要重新创建。

所有检查都由处理数千行的单个查询执行，而不是在循环中调用触发器数千次。

这是对修改性能的*巨大*提升。

如果您需要`UPDATE`，例如，`50,000`行表中的`10,000,000`行，这可能需要`10`几秒钟而不是`200`几秒钟甚至更多。

* * *

当然，只有当您需要对*非常*大的操作做出*非常*快速的响应时，它才会物有所值。

 *用这种方式设计数据库非常困难，如果不习惯很容易出错。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-14T20:22:28.367

正如其他人所指出的，这在很大程度上取决于您的环境。

但是，即使在您希望保护任务关键数据的公司情况下，也不一定强制要求对 CRUD 使用存储过程。如前所述，使用存储过程来实现数据库插入假设存储过程将比应用程序程序员更聪明。存储过程是逻辑，因此编写它们的技能是程序员的技能。所以，如果你碰巧有一个 DBA 也是比你的程序员更好的程序员，那么一定要让他们编写存储过程来让你的程序员诚实。某些地方可能会出现这种情况。值得牢记的是 Thomas Hansen 的观点，即使用存储过程会导致整个组织被锁定在给定存储过程的逻辑中。同样，一些组织可能想要或需要这个。

另一种方法是使用一些存储过程来保证一致性，但仍然允许临时插入。根据数据库的不同，这可以实现更简洁的界面和更高的一致性。

存储过程可能会更快一些，但这不太可能成为大型组织的主数据库的主要考虑因素（小型组织可能不想要那么多层）。

如果您要添加大量数据，批处理文件和关闭事务等操作很有用。但在我看来，CRUD 并不意味着要创建大量数据，而是像大多数用户级应用程序那样创建、读取、编辑和删除数据的小实例。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-12T21:20:56.887

看起来您不相信开发人员会编写行为良好的查询。

这大概是经验之谈。

我建议，如果糟糕的开发人员在编写垃圾 sql 代码，他们也在编写糟糕的应用程序代码，这意味着管理工作做得很差。

问题不在于动态 SQL（即使已参数化）与存储过程：而是管理不善。

这不会通过强制通过存储过程访问数据库来解决。

无论如何，即使只通过存储过程提供对数据库的访问，糟糕的编码人员仍然能够给数据库带来压力。

现实情况是，如果您使数据库中的数据难以获取，开发人员将使用其他技术不将数据放入数据库中，或者歪曲数据库。例如，假设您有一个博客字段来存储 pdf 或其他内容，那么如何阻止它们序列化对象并将它们存储在 blob 中，以便在代码中检索和反序列化？

我会小心的。

确保存储过程最终进入源代码控制，并且构建工具可以自动将存储过程部署到适当的数据库环境（连续或每天）...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-12T21:22:01.893

另一个明显的好处是性能，一旦 SP 被编译，它们将比代码中的 SQL 执行得更快。您已经说明了 SP 对关注安全性和控制的大型组织的主要好处。它使您的 DBA 在出现性能问题时更容易监控针对 DB 运行的 SQL，也将其全部放在 DB 中。

一个缺点是可移植性，如果您正在编写一个商业应用程序并且客户坚持要您适应他们现有的数据库，那么与内联 SQL 相比，与 SP 相比，您将需要做更多的工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-12T21:57:18.937

数据库是一个*桶*，一旦您开始将其视为业务逻辑的一部分，您最终将处于一个非常紧张和不舒服的地方，并创建 MUD 而不是 SW...

分离逻辑和数据。SP是*逻辑*......！

邪恶的舌头（我就是）声称 SP 是数据库供应商的技术，用于创建锁定技术，这将使创建使更改数据库供应商变得容易的抽象变得更加困难......

SP 在 99.9% 的情况下使用 ANTI 设计模式……！

# jquery - 对 jQuery 工具提示的建议

> ID：543277
> 
> 赞同：18
> 
> 时间：2009-02-12T21:11:00.110
> 
> 标签：jquery, tooltip

我正在寻找允许以下类型行为的 jQuery 工具提示插件。

```
<a href="somewhere.html">
 <span>
  <img src="someimage.jpg" style="display: none;" />
  Here is the tooltip content.
 </span>
 Here is the link to somewhere.
</a> 
```

我希望的行为是将鼠标悬停在“这里是某个地方的链接”上，并弹出一个工具提示，显示包含“someimage.jpg”和“这里是工具提示内容”的跨度内容。

我希望工具提示跟踪以及鼠标在链接上的移动以及工具提示的外观（背景颜色、不透明度、边框颜色等）是可配置的。

我发现的两个最受欢迎的工具提示“clueTip”和 Jörn Zaefferer 的“工具提示”似乎不符合要求，除非我遗漏了什么。

最终，链接和图像将动态生成。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-12T21:40:57.510

OHHHHHHHH 有史以来最好的！

[http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/](http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/)

演示：（查找“链接到雅虎”示例以满足您的所有需求）

[http://jquery.bassistance.de/tooltip/demo/](http://jquery.bassistance.de/tooltip/demo/)

编辑：我看到你提到了 Jorn（我不知道他的名字），但寻找“雅虎”的例子，它应该做你想做的事。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-13T14:54:55.963

telling you the true, I tried a couple of them but I'm sticking with one that I really like:

> [http://craigsworks.com/simpletip/sandbox/](http://craigsworks.com/simpletip/sandbox/)

there are plenty of things you can change and they look fantastic Anywhere! :)

[![alt text](https://i.stack.imgur.com/UXGXm.png)](https://i.stack.imgur.com/UXGXm.png)
[(source: [balexandre.com](http://www.balexandre.com/temp/StackOverflow_jquerySimpleTip.png))]

***Updated***

As pbz said, this is no longer available for copyright infrangiments, but the same can be found in the 'original' developer at

> [http://www.nickstakenburg.com/projects/prototip2/](http://www.nickstakenburg.com/projects/prototip2/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-12T21:17:23.493

我是一个超级粉丝[`BeautyTips`](http://www.lullabot.com/files/bt/bt-latest/DEMO/index.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-12T21:25:07.500

它必须是jquery吗？如果你愿意，你可以只用 CSS 来做。

```
a.info
{
    position: relative;
    z-index: 24;
}

a.info:hover
{
    z-index: 25;    
}

a.info span
{
    display: none;
}

a.info:hover span
{
    display: block;
    position: absolute;
    top: 2em;
    left: 2em;
    width: 15em;
    padding: 6px;
    border: 1px solid black;
    background-color: #eeeeee;
    color: #000;
} 
```

然后，您可以像拥有它一样使用它。

```
<a href="somewhere.html" class="info">
 <span>
  <img src="images/someImage.jpg" />
  Here is the tooltip content.
 </span>
 Here is the link to somewhere.
</a> 
```

**编辑**

阅读我每天的博客剂量[这篇文章](http://feedproxy.google.com/~r/nettuts/~3/7Ccp2w-2t38/)引起了我的注意。他们创建了一个 jquery 插件，可以做你想做的事，弹出一个带有样式选项和鼠标移动的图像。在这里查看结果。

[http://james.padolsey.com/demos/imgPreview/full/](http://james.padolsey.com/demos/imgPreview/full/)

您应该能够按照教程编写插件或下载示例插件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-06T19:46:40.353

这应该可以让您在工具提示框中放置您想要的任何内容。
[http://code.google.com/p/next-msg/](http://code.google.com/p/next-msg/)

**另外它有主题** ![在此处输入图像描述](https://i.stack.imgur.com/Tjeh4.jpg)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-09-29T19:59:10.360

[qTip](http://craigsworks.com/projects/qtip/) - 毫无疑问

也看[这里](https://stackoverflow.com/questions/625920/jquery-popup-bubble)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-25T12:22:54.163

您也可以尝试一个名为 Likno Web Tooltips Builder 的工具： [http ://www.likno.com/jquery-tooltips/index.php](http://www.likno.com/jquery-tooltips/index.php)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-19T20:50:35.753

这是一个几乎可以做任何事情的 jQuery 工具提示，看起来也很棒：

提示：[http ://projects.nickstakenburg.com/tipped](http://projects.nickstakenburg.com/tipped)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-02-04T15:24:53.940

简直是最好的 [http://flowplayer.org/tools/tooltip/index.html](http://flowplayer.org/tools/tooltip/index.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-15T23:46:21.857

这是我使用的一个很棒的，它有一个位置和鼠标跟随选项，还带有一堆开箱即用的主题。[http://www.websanova.com/plugins/websanova/tooltip](http://www.websanova.com/plugins/websanova/tooltip)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-12T22:49:54.910

我想过使用这个： http: [//www.codylindley.com/blogstuff/js/jtip/](http://www.codylindley.com/blogstuff/js/jtip/)

这： http: [//onehackoranother.com/projects/jquery/tipsy/](http://onehackoranother.com/projects/jquery/tipsy/)

其他推荐的可能更适合您的需求

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-05-02T09:38:56.870

我推荐 ClueTip：[http](http://plugins.learningjquery.com/cluetip/) ://plugins.learningjquery.com/cluetip/它易于使用，支持工具提示中的换行符（带有可自由配置的分隔符），并且似乎在表格单元格中运行良好（[http: //bassistance.de/jquery-plugins/jquery-plugin-tooltip/](http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/)）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-06-18T13:04:48.720

新提示 -->

```
 New Tooltip JQuery plugin with support in browsers from IE7+, Firefox, Chrome 
```

对于事件处理回调和任何类型的元素都非常有吸引力且易于定制。

试试看 ：

JQuery 插件注册表： http: [//plugins.jquery.com/newtip/](http://plugins.jquery.com/newtip/)

Github 主页：[https ://github.com/chandra7mca/newtip](https://github.com/chandra7mca/newtip)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-12-12T12:28:58.967

jQuery UI 现在有一个内置的工具提示模块：http: [//jqueryui.com/tooltip/](http://jqueryui.com/tooltip/)

工作正常，易于定制。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-04-28T18:20:43.600

我还[为工具提示构建了一个 jQuery 插件](http://stefangabos.ro/jquery/zebra-tooltips/)- 它非常小 - 缩小了 5KB，非常易于设置和使用，并且有很多配置选项；无论垂直/水平滚动或窗口大小如何，它都会将提示定位在视口内；宽度和背景颜色可以在初始化时更改。它不使用任何图像——它对所有花哨的东西都使用 CSS，并为旧浏览器优雅地降级。它甚至可以在 IE6 中工作 :) 而且，默认情况下，它看起来像这样：

![截屏](https://i.stack.imgur.com/ExGy0.png)

# javascript - 如何在 IE 中修复动画后的移位

> ID：543282
> 
> 赞同：0
> 
> 时间：2009-02-12T21:12:13.710
> 
> 标签：javascript, jquery, internet-explorer, animation

我刚刚制作了一个文本动画（淡入；动画（顶部，不透明度）），最后，文本向左移动了大约 5px，然后很快又回到了原来的位置。这仅发生在 IE 中；所有其他主要浏览器都表现正常。

关于它为什么会发生以及如何解决它的任何想法？我特别对修复 IE7 感兴趣。

谢谢。

（PS，为了避免 ClearType 故障，我删除了 filter 属性。）

**HTML**

```
<div id="logomarca">
    <h1 id="marca">txt</h1>
    <p id="spec">txt</p>
</div> 
```

**CSS**

```
div#logomarca{     
position:absolute;
left:50%;
top:0%;
margin-top:-83px;
margin-left:-83px;
width:160px;
height:45px;
    }
p#spec{position:absolute; } 
```

**Javascript**

```
 $(document).ready(function(){
    $("div#logomarca").show();
    $("p#spec").fadeTo(0, 0.00,
        function() { if($.browser.msie) { this.style.removeAttribute('filter'); }; } 
    ); //hide() is not working with fadeIn
    if($.browser.msie) { 
                $("p#spec").css({ 
                "margin-top": "8px",  
                "margin-left": "-165px", 
                display: "none"  
                }); 
            };  
    $("div#logomarca").animate({
        top: "+=50%",
        opacity: 1.00
        }, 2500, 
        function() { if($.browser.msie) { this.style.removeAttribute('filter'); }; } 
        );
    $(this).delay(3200,function(){  
        if($.browser.msie) { $("p#spec").show(); };
$("p#spec").fadeTo(0, 0.00  ); 
        $("p#spec").animate({
            opacity: 1.00,
            top: "+=20"     
            }, 2500,
            function() { if($.browser.msie) { 
                this.style.removeAttribute('filter'); 
                }; }            
            );
        $(this).delay(3500,function(){  
            $("p#spec").fadeTo(800, 0.0);
            $(this).delay(650,function(){  
                $("h1#marca").fadeTo(1500, 0.0);
                });
            });
        });
 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T21:27:44.140

如果您可以发布一个最小化的工作示例，这样我们就可以查看代码，这将有所帮助。

我最好的猜测是，您需要用块级元素（`div`或`p`）包装您的元素，并为该元素提供 ' `position: relative;`' 以便 IE 运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:15:33.927

将边距更改为填充，看看是否有帮助。我最近遇到了一个非常相似的问题，并且解决了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T21:25:01.213

尝试包装在具有固定尺寸的 div 中。

# cocoa - 删除正确选择的 NSManagedObjects

> ID：543283
> 
> 赞同：0
> 
> 时间：2009-02-12T21:12:22.227
> 
> 标签：cocoa, core-data, cocoa-bindings, menu

看看这个很棒的截图，我想你可以想象我会问什么......

[截图 http://a4.s3.p.quickshareit.com/files/screenshot_75d0fc54a05ec7eae3f410.png](http://a4.s3.p.quickshareit.com/files/screenshot_75d0fc54a05ec7eae3f410.png) 玩家：

> 右侧：首选项面板和`NSTableView`
> 左侧：带有 a 的主窗口`NSPopUpButton`（在`NSMenu`;] 下）

弹出窗口的选定对象绑定到 tableview 中的其中之一。当我从表格视图中删除（在选定的弹出窗口中）对象时，会出现这个丑陋的东西（你可以在那里看到）。**我正在使用 CoreData 并且 NSArrayController 绑定到一个实体。**

我发现了 2 件有趣的事情：

```
NSManagedObjectContextObjectsDidChangeNotification  
[NSPopUpButton synchronizeTitleAndSelectedItem]; 
```

首先，我知道有人从 tableview 中删除了一个项目；不幸的是，第二个对我的问题不起作用......

那么知道如何炸掉这个丑陋的东西吗？=D

顺便说一句：如果你对这个不错的应用程序和原生 URL 缩短器感兴趣，你应该[看这里](http://frocensoftware.bplaced.net/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T22:56:10.667

如果我理解您对如何正确构建所有内容的描述，则您的 NSPopupButton 中的 selectedObject 将绑定到您的 NSTableView 中的某个值。我的猜测是您正在使用 dataSource 方法为表提供数据，并使用绑定将弹出窗口中的数据与表匹配。

您可能应该为实际数据集使用 NSArrayController，将其内容数组绑定到控制器中的 NSMutablearray，并将 tableView 和 NSPopupButton 绑定到 arrayController，而不是将一个控件绑定到另一个控件。您描述的问题似乎与 NSManagedObject 没有太大关系，除了在这种情况下看到 -description 的默认实现，但更多的是以非常规方式使用绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T10:11:07.007

我有！
我刚刚取消绑定 NSPopUpButton 的选定对象并再次绑定它。`only`当所选对象从列表中删除时，它会执行此操作。;)

# c++ - C++ 中与平台无关的 GUID 生成？

> ID：543306
> 
> 赞同：59
> 
> 时间：2009-02-12T21:17:46.927
> 
> 标签：c++, cross-platform, guid, uuid

在不依赖特定于平台的工具的情况下，以编程方式在 C++ 中生成 GUID 或 UUID 的最佳方法是什么？我正在尝试为模拟中的对象制作唯一标识符，但由于该项目是跨平台的，因此不能依赖 Microsoft 的实现。

笔记：

*   因为这是一个模拟器，我真的不需要密码随机性。
*   最好是 32 位数字。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-02-12T21:26:16.733

如果你负担得起使用 Boost，那么有一个[UUID](http://www.boost.org/libs/uuid)库应该可以解决问题。使用起来非常简单——检查文档和[这个答案](https://stackoverflow.com/a/3248017/61574)。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-10-26T17:56:56.120

在 Linux 上：man uuid

on win：查看 msdn 中的 UUID 结构和 UuidCreate 函数

[编辑] 该功能将如下所示

```
extern "C"
{
#ifdef WIN32
#include <Rpc.h>
#else
#include <uuid/uuid.h>
#endif
}

std::string newUUID()
{
#ifdef WIN32
    UUID uuid;
    UuidCreate ( &uuid );

    unsigned char * str;
    UuidToStringA ( &uuid, &str );

    std::string s( ( char* ) str );

    RpcStringFreeA ( &str );
#else
    uuid_t uuid;
    uuid_generate_random ( uuid );
    char s[37];
    uuid_unparse ( uuid, s );
#endif
    return s;
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-06-01T01:04:26.890

如果您负担不起使用 Boost，那么我实现了一个非常小的库，它只是充当每个操作系统的本机 guid 实现的包装器。它应该适用于 Windows（使用`CoCreateGuid`）、Linux（使用`libuuid`）、MacOS（使用`CFUUID`）、iOS（也使用`CFUUID`）和 Android（使用 JNI 调用`java.util.UUID`）。guid 生成函数在每个系统上都有不同的实现，但只有一个通用实现用于比较、字符串化和解析。

它已获得 MIT 许可，可在 GitHub 上获取：

[https://github.com/graeme-hill/crossguid](https://github.com/graeme-hill/crossguid)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T21:25:05.240

最好只使用目标平台上存在的任何 guid/uuid。做对是困难的（我们去购物吧；））。

来自不同但执行良好的实现的任何两个标识符之间发生冲突的概率应该远远超出在这个宇宙的生命周期中发生的任何合理机会。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T21:24:48.220

GUID 生成器通常依赖于机器的硬件特性，通常是 MAC 地址或 IP。您唯一可以做的绝对独立于平台的事情是使用手动播种或从某个时间源播种的某种[PRNG 。](http://en.wikipedia.org/wiki/PRNG)这通常不会生成真正的全球唯一标识符，因为您可以保证世界上没有人生成相同的数字。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-12T21:36:30.313

一个另类（？）解决方案是使用 Web 服务来获取 GUID，但我怀疑这对于 C++ 程序来说是一个很好的解决方案，尤其是在它没有启用网络的情况下。

如果您选择使用此选项，这里有一个 URL 可能会派上用场：http: [//www.hoskinson.net/GuidGenerator/default.asp](http://www.hoskinson.net/GuidGenerator/default.asp)

# ruby-on-rails - print + each() 块 - 为什么加入不起作用？

> ID：543307
> 
> 赞同：1
> 
> 时间：2009-02-12T21:18:04.150
> 
> 标签：ruby-on-rails, ruby, syntax

我期待这个输出：

```
output:xyz 
```

但如果我输入以下内容：

```
a = ["x", "y", "z"]
print "output:" + a.each {|i| print i}.to_s 
```

为什么我在单词输出之前和之后都会得到一个“xyz”？

```
xyzoutput:xyz 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T21:28:12.737

在 irb 中：

```
>> %w{x y z}.each {|i| i }
=> ["x", "y", "z"] 
```

调用的返回值是调用`each`它的`Enumerable`对象。所以你基本上打印出你传递给的块中数组的每个元素，`each`然后将数组转换为字符串并再次打印它，将它与字符串连接起来`"output:"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T22:27:00.973

可能你想要的是：

```
puts "output: #{a.join}" 
```

或者，更详细地说，如果这个想法更清晰：

```
puts "output: #{a.map {|element| element.to_s}.join}" 
```

# python - 以编程方式停止执行 python 脚本？

> ID：543309
> 
> 赞同：260
> 
> 时间：2009-02-12T21:18:06.050
> 
> 标签：python

是否可以使用命令在任何行停止执行 python 脚本？

像

```
some code

quit() # quit at this point

some more code (that's not executed) 
```

* * *

## 回答 #1

> 赞同：410
> 
> 时间：2009-02-12T21:20:20.227

[sys.exit()](https://docs.python.org/2/library/sys.html#sys.exit)将完全按照您的意愿行事。

```
import sys
sys.exit("Error message") 
```

* * *

## 回答 #2

> 赞同：159
> 
> 时间：2009-02-12T21:27:46.107

你可以`raise SystemExit(0)`不用费尽心思去`import sys; sys.exit(0)`.

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-02-12T21:22:07.883

你想要`sys.exit()`。来自 Python 的文档：

```
 >>> import sys
    >>> print sys.exit.__doc__
    exit([status]) 
```

通过引发 SystemExit(status) 退出解释器。如果省略状态或无，则默认为零（即成功）。如果状态是数字，它将被用作系统退出状态。如果是另一种对象，则打印出来，系统退出状态为一（即失败）。

所以，基本上，你会做这样的事情：

```
from sys import exit

# Code!

exit(0) # Successful exit 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-02-13T00:52:04.040

和内置函数`exit()`可以满足`quit()`您的需求。不需要导入 sys。

或者，您可以 raise `SystemExit`，但您需要注意不要在任何地方捕获它（只要您在所有 try.. 块中指定异常类型，就不会发生这种情况）。

# oracle - 对于 Oracle SQL，跨多个表和列获取不同的值

> ID：543311
> 
> 赞同：0
> 
> 时间：2009-02-12T21:18:15.990
> 
> 标签：oracle, distinct

我有以下示例查询，

```
select o.ENTRY_ID, o.DESCRIPTION, o.ENTRY_DATE, l.COMPANY_ID 
from TABLE1 o, TABLE2 l 
where o.ENTRY_ID = l.ENTRY_ID 
and COMPANY_ID in (10, 11, 12, 13) 
```

这将返回一组类似于以下的数据：

```
ENTRY_ID, DESCRIPTION, ENTRY_DATE, COMPANY_ID
1, Description 1, 2/12/2008, 10
2, Description 2, 2/12/2008, 10
3, Description 3, 2/10/2008, 10
4, Description 4, 2/11/2008, 10
4, Description 4, 2/11/2008, 11
4, Description 4, 2/11/2008, 12
4, Description 4, 2/11/2008, 13 
```

如果一个条目与多个公司相关联，则此查询将为与其关联的每个公司返回相同的条目 1 次。

我希望查询与 COMPANY_ID 不同，这样如果一个条目与多个公司相关联，它只会返回一次。

这是我想要返回的结果集：

```
ENTRY_ID, DESCRIPTION, ENTRY_DATE, COMPANY_ID
    1, Description 1, 2/12/2008, 10
    2, Description 2, 2/12/2008, 10
    3, Description 3, 2/10/2008, 10
    4, Description 4, 2/11/2008, 10 
```

但是，以下内容也是可以接受的，

```
ENTRY_ID, DESCRIPTION, ENTRY_DATE, COMPANY_ID
    1, Description 1, 2/12/2008, 10
    2, Description 2, 2/12/2008, 10
    3, Description 3, 2/10/2008, 10
    4, Description 4, 2/11/2008, 11 
```

我想要不同的 ENTRY_ID。在我现在得到的结果集中，我得到了 ENTRY_ID 的四个条目，因为四个不同的公司共享该条目。当多个公司共享条目时，我只希望返回一个条目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T21:27:50.413

```
SELECT ENTRY_ID, DESCRIPTION, ENTRY_DATE, COMPANY_ID
FROM (
  SELECT o.ENTRY_ID, o.DESCRIPTION, o.ENTRY_DATE, l.COMPANY_ID,
         ROW_NUMBER() OVER (PARTITION BY company_id ORDER BY entry_date DESC, entry_id DESC) AS rn
  FROM TABLE1 o, TABLE2 l 
  WHERE o.ENTRY_ID = l.ENTRY_ID 
    AND COMPANY_ID in (10, 11, 12, 13)
  )
WHERE rn = 1 
```

这将返回最后一个`ENTRY_DATE`或更大的条目，`ENTRY_ID`有多个条目等于最后一个`ENTRY_DATE`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T02:42:44.197

如果您很高兴获得最大的`COMPANY_ID`回报：

```
select o.ENTRY_ID, o.DESCRIPTION, o.ENTRY_DATE, MAX( l.COMPANY_ID ) AS COMPANY_ID
from TABLE1 o, TABLE2 l 
where o.ENTRY_ID = l.ENTRY_ID 
and COMPANY_ID in (10, 11, 12, 13)
group by o.ENTRY_ID, o.DESCRIPTION, o.ENTRY_DATE; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T08:58:29.050

*我希望查询与 COMPANY_ID 不同，这样如果一个条目与多个公司相关联，它只会返回一次。*

问题不清楚，你想要不同的条目还是不同的公司。也许您还可以显示您想要的输出，以便我们更好地理解。

如果您想要不同的条目并且 company_id 与它一起列出并不重要，这里是查询：

```
选择 * 从 (
select o.ENTRY_ID, o.DESCRIPTION, o.ENTRY_DATE, l.COMPANY_ID, row_number() over (partition by o.ENTRY_ID, o.DESCRIPTION, o.ENTRY_DATE order by l.COMPANY_ID) rn
从表 1 o，表 2 升
其中 o.ENTRY_ID = l.ENTRY_ID
和 COMPANY_ID 在 (10, 11, 12, 13)
)
其中 rn=1；
```

# wpf - 如何正确处理带有 MessageBox 确认的 PreviewMouseDown 事件？

> ID：543312
> 
> 赞同：2
> 
> 时间：2009-02-12T21:18:16.270
> 
> 标签：wpf, treeview, savechanges

之前我问[过如何取消 WPF TreeViewItem.Selected 事件](https://stackoverflow.com/questions/542392/how-can-i-cancel-a-users-wpf-treeview-click)。

回答者建议我在选择发生之前处理 PreviewMouseDown 事件。那讲得通。

我试过这样做...

XAML...

```
<TreeView Name="TreeViewThings"
    ...
    PreviewMouseDown="TreeViewThings_PreviewMouseDown"
    TreeViewItem.Expanded="TreeViewThings_Expanded"
    TreeViewItem.Selected="TreeViewThings_Selected" > 
```

视觉基本...

```
子 TreeViewThings_PreviewMouseDown(...)
    如果 UnsavedChangesExist() 那么
        e.Handled = UserCancelled()
    别的
        e.Handled = False
    万一
结束子

函数 UnsavedChangesExist() 作为布尔值
    ...
结束功能

函数 UserCancelled() 作为布尔值
    Return MessageBox.Show("放弃未保存的更改？", _
                           “未保存的更改”，_
                           MessageBoxButton.OKCancel, _
                           MessageBoxImage.Question) = MessageBoxResult.Cancel
结束功能

```

这只是一种工作......

*   如果没有未保存的更改，那么它会正常进行并执行 TreeViewThings_Selected()。

如果有未保存的更改，那么我会看到 MessageBox...

[MessageBox：继续并放弃未保存的更改？确定/取消 http://img25.imageshack.us/img25/141/discard2yk0.gif](http://img25.imageshack.us/img25/141/discard2yk0.gif)

*   如果我然后选择取消，它会取消。

*   但是，如果我改为选择“确定”来放弃我未保存的更改，那么它无论如何都会取消——即使 e.Handled = False。它不会继续并执行 TreeViewThings_Selected()。

我认为有一个 MessageBox 以某种方式搞砸了这一事实。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-17T18:14:10.183

The problem is that the messagebox causes your tree to lose focus. Have you tried setting the focus back to the tree after the messagebox is dismissed?

# resharper - ReSharper：它可以作为联合程序员吗？

> ID：543318
> 
> 赞同：6
> 
> 时间：2009-02-12T21:19:11.400
> 
> 标签：resharper

[这里](https://stackoverflow.com/questions/543087/custom-class-for-dealing-with-embedding-in-forms/543115#543115)的评论让我思考。如果您是一名新开发人员，没有导师，也没有人为您的项目进行协作；一个工具，在这种情况下是**ReSharper ，是否能够发挥这种作用？**它是否需要另一个工具或过程、系统或人来完成此任务。

我无法很快找到一个开发伙伴，而且我担心 StackOverFlow 会在我用完无知的问题之前很久就禁止我。就我而言， **ReSharper**、**StyleCop**、**ReFlector**等工具能否发挥重要作用。

在**ReSharpers**案例中，重构功能是否真的从学习的角度发挥作用，或者仅仅是`*poof*`您的代码更好，几乎没有机会了解为什么我应该提取该方法存根？

我非常想达到我*能够*在这里回答尽可能多的问题的地步。

祝您有美好的一天，感谢您的宝贵时间。

* * *

根据迄今为止的答案进行编辑：

因此，如果答案是否定的，它不会完成这些事情，而且我不会很快得到一个*真正的* *人，任何人都可以提供替代方案吗？*

谢谢你！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T21:24:13.027

我会说不。ReSharper 通常会为您提供更改某些内容的选项（例如“作为扩展方法调用”），然后如果您接受它，它会为您提供将其更改回来的选项。

当您知道要更改代码时，这很好，但它并不能说明您*为什么*要更改它。有一些建议更“明显好”，但距离拥有导师还有很长的路要走。

不要误会我的意思：ReSharper 是一个很棒的工具，它可能会为您节省大量时间，但它可能*不会*改进您的设计和实施技能。它将帮助您*更快*地掌握这些技能。

不过，不要担心在这里问很多问题——我们喜欢它:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T21:26:39.790

好吧，它并不能帮助您编写*更智能*或设计更好的代码。但它确实可以帮助您清理杂乱的代码并帮助您坚持一些最佳实践。但是您应该知道，某些设置默认情况下并不好。例如，它给了我关于如何使用 'var' 而不是它的真实类型的提示。在许多情况下，我认为这不合适。

例如，您可以将 resharper 与 fxcop 结合使用。这样它可以保持你的风格干净。对于其他指导类型的事情，我会推荐“Uncle bob”的“干净代码”副本。那本书让你真正思考函数应该做什么。

然后你应该进入架构并阅读一些关于它的文档。没有工具可以检查您是否正确执行了这些操作。

导师仍然是改进代码的最佳方式，但 resharper 和 fxcop 将使您能够根据约定编写更简洁的代码。因此，当老年人检查您的代码时，他们会说“WTF”是一回事:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T22:29:21.653

ReSharper 不能替代真人。

替代方案：结识其他开发人员、加入用户组、参加极客午餐、Code Camp、网络。

小团体聚在一起后，安排出去喝啤酒，聊会儿商店。喝几杯啤酒就能学到很多东西，真是太棒了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T21:25:46.593

我的意见是：见 jon skeet 的回答

如果 resharper 可以回答关于 SO 的问题，它会告诉你同样的事情

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T21:55:30.160

我想说 resharper 永远不会取代让另一个开发人员指导你的经验，但你会从 resharper 中学到很多东西。如果你没有导师可以学习，另一个可以教你很多东西的工具是一个名为 NDepend 的应用程序。NDepend 将分析您的代码并提出重构建议，并向您展示可以在哪些方面做得更好。

我建议您同时使用这两种工具，您将学到一些非常有价值的课程！祝你好运！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T21:22:36.977

在重构方面，Resharper 和你一样好。如果您不知道为什么要提取方法或其他什么，那么您只会在错误的地方和错误的原因中进行操作。它不会使事情变得更可维护或可扩展或任何其他伟大的承诺。你必须知道你在做什么。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T21:24:55.770

Resharper 是一个很棒的工具。当我第一次开始使用它时，Resharper 引起了我的注意，有很多我不知道的事情。

使用了几个星期后，并没有什么新发现。从那时起，它就成为了一种生产力工具。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T21:26:48.590

ReSharper 永远无法取代专业人士，毫无疑问，它是一个很棒的工具，但我的建议是，给自己找一个导师。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-12T21:49:00.657

我同意所有关于人类比工具更好的说法。也就是说：我仍然会使用任何您可以使用的静态或动态代码检查工具。阅读每条警告并尝试了解它产生的原因。然后修复它。理解和尝试学习是第一位的。

还投资一些书籍。在 SO 上可以找到一长串建议。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-12T21:50:52.447

我有点不同意这里的很多答案。Resharper 可以帮助您发展您的编程技能。它通常会建议您编写的代码的替代方案。程序员仍然可以决定哪种替代方案更好，但是查看替代方案然后在线研究它们可能是一个很好的学习工具。

这当然是不够的。如果你不能和工作中的人一起工作，我会在网上找人合作。开始阅读开源项目的代码，如果你发现一些你认为你可以贡献的东西！这是获得反馈的好方法。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-12T22:46:03.283

它不会像其他程序员一样好，但它会比没有好得多，特别是如果你是该语言的新手。那里有很多糟糕的代码，其中很多将至少部分由 StyleCop/FxCop 修复。这是朝着正确方向迈出的一步。

除此之外，我会尝试参与一些小型开源项目，或者至少阅读一些开源代码，看看其他人是如何做事的。您也可以尝试参加用户群聚餐。

对于您的特殊情况：我认为您已经通过思考和关心此类事情并参与诸如 SO、阅读书籍和博客之类的地方而领先于普通开发人员。如果你是唯一的开发人员，你可能会花更多时间来设计你正在构建的东西。

我和你处于同样的位置，所以我知道考虑“落后”是什么感觉，因为你无法向任何人学习，但这就是互联网的用途:) 如果我们一起工作，我们至少可以部分取代失踪的团队成员

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-12T21:23:01.517

我无法想象一个软件工具怎么可能取代一个真正的人作为老师。虽然我个人对您提到的工具没有任何经验，但我无法想象一个软件工具可以像人类一样解释某事，或者可以接近预测您可能遇到的每一个问题.

当我身边没有开发人员时，我发现与任何愿意倾听的人交谈会很有帮助。通常，说话的行为可以帮助我了解一些事情。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-12T21:25:15.240

快速回答，**没有**。它不是人工智能，也远不及真正的联合程序员所能提供的。

我每天都使用 ReSharper，没有它就活不下去。但是我的程序员同事对 ReSharper 无法做到的事情提供了更多的洞察力。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-12T21:45:18.343

任何工具都无法为您提供重大问题的答案。（我应该使用线程池还是创建自己的线程池？我应该使用监视器还是互斥体？等等）

尽管如此，很少有人有机会与真正有天赋的导师一起工作，有些人仍然设法成为了不起的开发人员。

# c# - 如何在 ASP.NET 中返回 XML？

> ID：543319
> 
> 赞同：64
> 
> 时间：2009-02-12T21:19:20.743
> 
> 标签：c#, asp.net, xml

对于在 ASP.NET 中返回 XML 的任务，我遇到了许多半解决方案。不过，我不想盲目地复制和粘贴一些在大多数情况下都能正常工作的代码；我想要*正确*的代码，我想知道*为什么*它是正确的。我要批评；我想要信息；我要知识；我想要理解。

下面是代码片段，按照复杂度递增的顺序，代表我见过的一些部分解决方案，包括每个问题引起的一些进一步的问题，我想在这里回答。

一个彻底的答案必须说明为什么我们*必须*拥有或*不能*拥有以下任何东西，或者解释为什么它不相关。

*   响应。清除（）；
*   Response.ContentType = "文本/xml";
*   Response.ContentEncoding = 编码.UTF8;
*   Response.ContentEncoding = 编码.UTF16;
*   Response.ContentType = "文本/xml; charset=utf-8";
*   Response.ContentType = "文本/xml; charset=utf-16";
*   响应结束（）
*   使用去掉前端文件内容的 aspx
*   使用 ashx 文件

最后，假设您需要编写一个辅助函数的内容，如下所示：

```
///<summary>Use this call inside your (Page_Xxx) method to write the
///xml to the web client. </summary>
///<remarks>See for https://stackoverflow.com/questions/543319/how-to-return-xml-in-asp-net
///for proper usage.</remarks>
public static void ReturnXmlDocumentToWebClient(
    XmlDocument document,
    Page page)
{
   ...
} 
```

* * *

我看到的每个解决方案都从获取一个空的 aspx 页面开始，然后从前端文件中修剪所有 HTML（这会导致 Visual Studio 中的警告）：

```
<%@ Page Language="C#"
      AutoEventWireup="true"
      CodeFile="GetTheXml.aspx.cs"
      Inherits="GetTheXml" %> 
```

接下来我们使用`Page_Load`事件写入输出：

```
protected void Page_Load(object sender, EventArgs e)
{
   String xml = "<foo>Hello, world!</foo>";

   Response.Write(xml);
} 
```

* * *

我们是否需要将**ContentType**更改为**"text/xml"**？IE：

```
protected void Page_Load(object sender, EventArgs e)
{
   String xml = "<foo>Hello, world!</foo>";

   Response.ContentType = "text/xml";
   Response.Write(xml);
} 
```

* * *

我们需要先打电话`Response.Clear`吗？

```
protected void Page_Load(object sender, EventArgs e)
{
   String xml = "<foo>Hello, world!</foo>";

   Response.Clear();
   Response.ContentType = "text/xml";
   Response.Write(xml);
} 
```

我们真的需要这样称呼吗？是否没有`Response.Clear`确保前面文件中的代码在`<% ... %>`不必要的情况下为空（甚至不是空格或回车）的先前步骤？

是否`Response.Clear`使它更健壮，以防有人在代码前端文件中留下空白行或空格？

使用 ashx 是否与空白 aspx 主文件相同，因为它知道它不会输出 HTML？

* * *

我们需要打电话`Response.End`吗？IE：

```
protected void Page_Load(object sender, EventArgs e)
{
   String xml = "<foo>Hello, world!</foo>";

   Response.Clear();
   Response.ContentType = "text/xml";
   Response.Write(xml);
   Response.End();
} 
```

在那之后还可能发生什么`Response.Write`需要我们立即结束**响应**？

* * *

content-type 是否`text/xml`足够，或者应该是**text/xml；字符集=utf-8**？

```
protected void Page_Load(object sender, EventArgs e)
{
   String xml = "<foo>Hello, world!</foo>";

   Response.Clear();
   Response.ContentType = "text/xml; charset=utf-8";
   Response.Write(xml);
   Response.End();
} 
```

或者它**不**应该是那样的吗？在内容类型中有一个字符集，但没有设置属性，会搞砸服务器吗？

为什么不是其他内容类型，例如：

*   UTF-8
*   UTF-16
*   UTF-16

* * *

应该在 中指定字符集`Response.ContentEncoding`吗？

```
protected void Page_Load(object sender, EventArgs e)
{
   String xml = "<foo>Hello, world!</foo>";

   Response.Clear();
   Response.ContentType = "text/xml";
   Response.ContentEncoding = Encoding.UTF8;
   Response.Write(xml);
   Response.End();
} 
```

使用`Response.ContentEncoding`比将其塞入更好`Response.ContentType`吗？是不是更糟？支持前者吗？是后者吗？

* * *

我实际上并不想写出一个字符串；我想写一个`XmlDocument`. [有人建议我可以使用`XmlWriter`](https://stackoverflow.com/questions/374535/how-to-return-xml-in-aspnet)：

```
protected void Page_Load(object sender, EventArgs e)
{
   XmlDocument xml = GetXmlDocumentToShowTheUser();

   Response.Clear();
   Response.ContentType = "text/xml";
   Response.ContentEncoding = Encoding.UTF8;

   using (TextWriter textWriter = new StreamWriter(
         Response.OutputStream,
         Encoding.UTF8))
   {
       XmlTextWriter xmlWriter = new XmlTextWriter(textWriter);
       // Write XML using xmlWriter
       //TODO: How to do this?
   }
} 
```

注意使用`Response.OutputStream`, 而不是`Response.Write`. 这个好吗？坏的？更好的？更差？快点？慢点？内存更密集？更少的内存密集型？

* * *

我[读到](http://www.deez.info/sengelha/2006/02/06/how-return-xml-from-aspx-in-aspnet-11/#comment-24670)你应该渲染

> 页面的 Render() 方法中的 XML 以避免使用 Page_Load() 时遇到的分块问题。

什么是**分块**？分块有什么问题，使用 using 如何`Page_Render`消除它们？

* * *

我不想将`XmlDocument`对象的内容写入字符串然后再写入，因为这会浪费内存。也就是说，其中任何一个都是不好的：

```
Response.Write(doc.ToString());
Response.Write(doc.InnerXml);
xmlWrite.WriteString(doc.ToString());
xmlWrite.WriteString(doc.InnerXml); 
```

* * *

**类似问题**

[如何在 ASP.NET 中返回 XML](https://stackoverflow.com/questions/374535/how-to-return-xml-in-aspnet)

**参考**

[如何在 ASP.NET 1.1 中从 ASPX 返回 XML](http://www.deez.info/sengelha/2006/02/06/how-return-xml-from-aspx-in-aspnet-11)

[将 XML 输出写入 ASP.NET 网页](http://forums.asp.net/t/1298093.aspx)

[如何从 ASP.NET 输出 XML？](http://bytes.com/groups/net-asp/647876-how-do-you-output-xml-asp-net)

[在 ASP.NET 中创建 ASHX 处理程序](http://www.aspcode.net/Creating-an-ASHX-handler-in-ASPNET.aspx)

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2010-01-29T16:37:29.873

我找到了在 ASP.NET 中将 XML 返回到客户端的正确方法。我认为，如果我指出错误的方式，它将使正确的方式更容易理解。

**不正确：**

```
Response.Write(doc.ToString()); 
```

**不正确：**

```
Response.Write(doc.InnerXml); 
```

**不正确：**

```
Response.ContentType = "text/xml";
Response.ContentEncoding = System.Text.Encoding.UTF8;
doc.Save(Response.OutputStream); 
```

**正确的：**

```
Response.ContentType = "text/xml"; //Must be 'text/xml'
Response.ContentEncoding = System.Text.Encoding.UTF8; //We'd like UTF-8
doc.Save(Response.Output); //Save to the text-writer
      //using the encoding of the text-writer
      //(which comes from response.contentEncoding) 
```

* * *

## 使用 TextWriter

不要使用**_**`Response.OutputStream`

**使用**_**`Response.Output`**

 **两者都是流，但是`Output`是[TextWriter](http://msdn.microsoft.com/en-us/library/system.io.textwriter.aspx)。当 an`XmlDocument`将自身保存到**TextWriter**时，它将使用该TextWriter 指定的**编码**。XmlDocument 将自动更改 xml 声明节点以匹配 TextWriter 使用的编码。例如在这种情况下 XML 声明节点：

```
<?xml version="1.0" encoding="ISO-8859-1"?> 
```

会成为

```
<?xml version="1.0" encoding="UTF-8"?> 
```

这是因为 TextWriter 已设置为 UTF-8。（稍后会详细介绍）。由于向 TextWriter 提供字符数据，它将使用适合其设置编码的字节序列对其进行编码。

**不正确**：

```
doc.Save(Response.OutputStream); 
```

在此示例中，文档被错误地保存到 OutputStream，它不执行编码更改，并且可能与响应的内容编码或 XML 声明节点的指定编码不匹配。

**正确的**

```
doc.Save(Response.Output); 
```

XML 文档正确保存到 TextWriter 对象，确保正确处理编码。

* * *

## 设置编码

标头中给客户端的编码：

```
Response.ContentEncoding = ... 
```

必须匹配 XML 文档的编码：

```
<?xml version="1.0" encoding="..."?> 
```

必须与发送给客户端的字节序列中存在的实际编码相匹配。要使所有这三件事一致，请设置单行：

```
Response.ContentEncoding = System.Text.Encoding.UTF8; 
```

在**Response**对象上设置编码时，它会在**TextWriter**上设置相同的编码。TextWriter 的编码集导致**XmlDocument**更改**xml 声明**：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

保存文档时：

```
doc.Save(someTextWriter); 
```

* * *

## 保存到响应输出

您不想将文档保存到二进制流，或写入字符串：

**不正确：**

```
doc.Save(Response.OutputStream); 
```

此处 XML 被错误地保存到二进制流中。最终的字节编码序列与 XML 声明或 Web 服务器响应的内容编码不匹配。

**不正确：**

```
Response.Write(doc.ToString());
Response.Write(doc.InnerXml); 
```

此处 XML 被错误地转换为没有编码的字符串。XML 声明节点未更新以反映响应的编码，并且响应未正确编码以匹配响应的编码。此外，将 XML 存储在中间字符串中会浪费内存。

您**不想**将 XML 保存为字符串，或者将 XML 填充为字符串和`response.Write`字符串，因为：

```
- doesn't follow the encoding specified
- doesn't set the XML declaration node to match
- wastes memory 
```

**使用**_**`doc.Save(Response.Output);`**

 **不要使用**_**`doc.Save(Response.OutputStream);`

不要使用**_**`Response.Write(doc.ToString());`

不要**使用**'Response.Write(doc.InnerXml);`

* * *

## 设置内容类型

响应的 ContentType 必须设置为`"text/xml"`。否则，客户端将不知道您正在向其发送 XML。

## 最终答案

```
Response.Clear(); //Optional: if we've sent anything before
Response.ContentType = "text/xml"; //Must be 'text/xml'
Response.ContentEncoding = System.Text.Encoding.UTF8; //We'd like UTF-8
doc.Save(Response.Output); //Save to the text-writer
    //using the encoding of the text-writer
    //(which comes from response.contentEncoding)
Response.End(); //Optional: will end processing 
```

# 完整示例

Rob Kennedy 有一个很好的观点，即我没有包括从头到尾的例子。

**GetPatronInformation.ashx**：

```
<%@ WebHandler Language="C#" Class="Handler" %>

using System;
using System.Web;
using System.Xml;
using System.IO;
using System.Data.Common;

//Why a "Handler" and not a full ASP.NET form?
//Because many people online critisized my original solution
//that involved the aspx (and cutting out all the HTML in the front file),
//noting the overhead of a full viewstate build-up/tear-down and processing,
//when it's not a web-form at all. (It's a pure processing.)

public class Handler : IHttpHandler
{
   public void ProcessRequest(HttpContext context)
   {
      //GetXmlToShow will look for parameters from the context
      XmlDocument doc = GetXmlToShow(context);

      //Don't forget to set a valid xml type.
      //If you leave the default "text/html", the browser will refuse to display it correctly
      context.Response.ContentType = "text/xml";

      //We'd like UTF-8.
      context.Response.ContentEncoding = System.Text.Encoding.UTF8;
      //context.Response.ContentEncoding = System.Text.Encoding.UnicodeEncoding; //But no reason you couldn't use UTF-16:
      //context.Response.ContentEncoding = System.Text.Encoding.UTF32; //Or UTF-32
      //context.Response.ContentEncoding = new System.Text.Encoding(500); //Or EBCDIC (500 is the code page for IBM EBCDIC International)
      //context.Response.ContentEncoding = System.Text.Encoding.ASCII; //Or ASCII
      //context.Response.ContentEncoding = new System.Text.Encoding(28591); //Or ISO8859-1
      //context.Response.ContentEncoding = new System.Text.Encoding(1252); //Or Windows-1252 (a version of ISO8859-1, but with 18 useful characters where they were empty spaces)

      //Tell the client don't cache it (it's too volatile)
      //Commenting out NoCache allows the browser to cache the results (so they can view the XML source)
      //But leaves the possiblity that the browser might not request a fresh copy
      //context.Response.Cache.SetCacheability(HttpCacheability.NoCache);

      //And now we tell the browser that it expires immediately, and the cached copy you have should be refreshed
      context.Response.Expires = -1;

      context.Response.Cache.SetAllowResponseInBrowserHistory(true); //"works around an Internet&nbsp;Explorer bug"

      doc.Save(context.Response.Output); //doc saves itself to the textwriter, using the encoding of the text-writer (which comes from response.contentEncoding)

      #region Notes
      /*
       * 1\. Use Response.Output, and NOT Response.OutputStream.
       *  Both are streams, but Output is a TextWriter.
       *  When an XmlDocument saves itself to a TextWriter, it will use the encoding
       *  specified by the TextWriter. The XmlDocument will automatically change any
       *  XML declaration node, i.e.:
       *     <?xml version="1.0" encoding="ISO-8859-1"?>
       *  to match the encoding used by the Response.Output's encoding setting
       * 2\. The Response.Output TextWriter's encoding settings comes from the
       *  Response.ContentEncoding value.
       * 3\. Use doc.Save, not Response.Write(doc.ToString()) or Response.Write(doc.InnerXml)
       * 3\. You DON'T want to save the XML to a string, or stuff the XML into a string
       *  and response.Write that, because that
       *   - doesn't follow the encoding specified
       *   - wastes memory
       *
       * To sum up: by Saving to a TextWriter: the XML Declaration node, the XML contents,
       * and the HTML Response content-encoding will all match.
       */
      #endregion Notes
   }

   private XmlDocument GetXmlToShow(HttpContext context)
   {
      //Use context.Request to get the account number they want to return
      //GET /GetPatronInformation.ashx?accountNumber=619

      //Or since this is sample code, pull XML out of your rear:
      XmlDocument doc = new XmlDocument();
      doc.LoadXml("<Patron><Name>Rob Kennedy</Name></Patron>");

      return doc;
   }

   public bool IsReusable { get { return false; } }
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-12T21:40:03.270

理想情况下，您会使用 ashx 发送 XML，尽管我确实允许 ASPX 中的代码拦截正常执行。

```
Response.Clear() 
```

如果您不确定是否已经在响应中倾倒了任何内容，那么我不会使用它，然后去找它并摆脱它。

```
Response.ContentType = "text/xml" 
```

毫无疑问，如果没有这种内容类型，普通客户端不会接受 XML 格式的内容。

```
 Response.Charset = "UTF-8"; 
```

让响应类正确处理构建内容类型标头。除非您有非常非常好的理由不这样做，否则请使用 UTF-8。

```
Response.Cache.SetCacheability(HttpCacheability.NoCache);
Response.Cache.SetAllowResponseInBrowserHistory(true); 
```

如果您不发送缓存标头，某些浏览器（即 IE）会缓存响应，后续请求不一定会到达服务器。如果您希望它通过 HTTPS 工作（由于 IE 中的另一个错误），您还需要 AllowResponseInBrowser。

要发送 XmlDocument 的内容，只需使用：

 ~~~~```
dom.Save(Response.OutputStream); 
```~~  ~~```
dom.Save(Response.Output); 
```

只要确保编码匹配，（使用 UTF-8 的另一个好理由）。

该`XmlDocument`对象将自动将其嵌入`encoding="..."`编码调整为`Response`（例如`UTF-8`）

```
Response.End() 
```

如果你真的必须在 ASPX 中但它有点激烈，在 ASHX 中不要这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T21:44:47.923

以下是我认为的正确方式的示例。至少这是我使用的。您需要执行 Response.Clear 以摆脱任何已填充的标头。您需要传递正确的 text/xml 的 ContentType。这就是您提供 xml 的方式。通常，您希望将其作为字符集 UTF-8 提供，因为这是大多数解析器所期望的。但我认为不必如此。但是，如果您更改它，请确保更改您的 xml 文档声明并在其中指明字符集。您需要使用 XmlWriter，这样您才能真正使用 UTF-8 而不是默认的字符集。并让它以 UTF-8 正确编码您的 xml 数据。

```
 ' -----------------------------------------------------------------------------
   ' OutputDataSetAsXML
   '
   ' Description: outputs the given dataset as xml to the response object
   '
   ' Arguments:
   '    dsSource           - source data set
   '
   ' Dependencies:
   '
   ' History
   ' 2006-05-02 - WSR : created
   '
   Private Sub OutputDataSetAsXML(ByRef dsSource As System.Data.DataSet)

      Dim xmlDoc As System.Xml.XmlDataDocument
      Dim xmlDec As System.Xml.XmlDeclaration
      Dim xmlWriter As System.Xml.XmlWriter

      ' setup response
      Me.Response.Clear()
      Me.Response.ContentType = "text/xml"
      Me.Response.Charset = "utf-8"
      xmlWriter = New System.Xml.XmlTextWriter(Me.Response.OutputStream, System.Text.Encoding.UTF8)

      ' create xml data document with xml declaration
      xmlDoc = New System.Xml.XmlDataDocument(dsSource)
      xmlDoc.DataSet.EnforceConstraints = False
      xmlDec = xmlDoc.CreateXmlDeclaration("1.0", "UTF-8", Nothing)
      xmlDoc.PrependChild(xmlDec)

      ' write xml document to response
      xmlDoc.WriteTo(xmlWriter)
      xmlWriter.Flush()
      xmlWriter.Close()
      Response.End()

   End Sub
   ' ----------------------------------------------------------------------------- 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T22:18:33.100

似乎这里至少有 10 个问题合二为一，几点。

Response.Clear - 这真的取决于应用程序中发生的其他事情 - 如果您在管道的早期有 httpmodules 可能正在编写您不想要的东西 - 然后清除它。测试它并找出答案。Fiddler 或 Wireshark 对此很有用。

内容类型为 text/xml - 是的 - 好主意 - 阅读 HTTP 规范，了解为什么这很重要。IMO 任何从事网络工作的人都应该至少阅读 1.0 和 1.1 规范一次。

编码 - 你的 xml 是如何编码的 - 如果它是 utf-8，那么就这么说，如果不是，说其他合适的东西，只要确保它们都匹配。

Page - 就个人而言，会使用 ashx 或 httpmodule，如果您正在使用 page，并且希望它更快一点，请摆脱 autoeventwireup 并手动绑定事件处理程序。

首先将 xml 转储到字符串中可能会有点浪费内存，但这在很大程度上取决于 xml 的大小，您是否会注意到。

正如其他人所建议的那样，将 xml 保存到输出流可能是最快的，我通常会这样做，但如果您不确定，请对其进行测试，不要依赖您在互联网上阅读的内容。不要只相信我说的任何话。

对于另一种方法，如果 xml 没有太大变化，您可以将其写入磁盘并直接提供文件，这可能会非常高效，但就像编程中的所有内容一样，这取决于......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-21T04:16:37.980

令我惊讶的是，似乎没有人提到您可以使用 .NET 4.0 中提供的 XDocument / XElement 并使输出 XML 变得更加容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-18T17:26:18.340

**下面是处理程序将在服务器端返回包含 xml 数据的流数据的方式。**

**这是将返回数据的处理程序代码。**

```
 public void ProcessRequest(HttpContext context)
    {

        StringBuilder xmlBuilder = new StringBuilder();

        xmlBuilder.Append("<Names>");
        xmlBuilder.Append("<Name>");
        xmlBuilder.Append("Sheo");
        xmlBuilder.Append("</Name>");
        xmlBuilder.Append("</Names>");
        context.Response.ContentType = "application/octet-stream";
        context.Response.BinaryWrite(Encoding.UTF8.GetBytes(xmlBuilder.ToString()));
        context.Response.End();

    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-18T17:33:32.360

**下面是调用处理程序并接收流数据并加载到 xml 文档中的服务器端代码**

```
 Stream stream = null;
       **Create a web request with the specified URL**
        WebRequest myWebRequest = WebRequest.Create(@"http://localhost/XMLProvider/XMLProcessorHandler.ashx");
        **Senda a web request and wait for response.**
        WebResponse webResponse = myWebRequest.GetResponse();
        **Get the stream object from response object**
        stream = webResponse.GetResponseStream();

       XmlDocument xmlDoc = new XmlDocument();
      **Load stream data into xml**
       xmlDoc.Load(stream); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-25T11:53:56.180

```
XmlDocument xd = new XmlDocument();
xd.LoadXml(xmlContent);

context.Response.Clear();
context.Response.ContentType = "text/xml";
context.Response.ContentEncoding = System.Text.Encoding.UTF8;
xd.Save(context.Response.Output);
context.Response.Flush();
context.Response.SuppressContent = true;
context.ApplicationInstance.CompleteRequest(); 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-02-12T21:28:40.130

您基本上已经回答了所有问题，所以我不确定这里的重点是什么？

FWIW*我*会使用 httphandler - 调用页面生命周期并不得不处理裁剪视图状态和会话的部分以及你有什么对 XML 文档没有意义似乎没有意义。这就像买一辆车，然后把它拆成零件来制造你的摩托车。

内容类型很重要，它是请求者知道如何处理响应的方式。

# bash - 如何将标准输入从 shell 脚本重定向到 shell 脚本中的命令？

> ID：543336
> 
> 赞同：6
> 
> 时间：2009-02-12T21:22:21.190
> 
> 标签：bash, stdin

如何将标准输入从 shell 脚本重定向到 shell 脚本中的命令？我正在尝试将标准输入传递给 java System.in 流。

我想换

```
find . -type f | $JAVA_HOME/bin/java com.domain.BatchProcess 
```

和

```
 find . -type f | ./batch.sh 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T21:25:17.923

如果您在脚本中执行命令，它将替换 shell 并继承它的文件描述符，包括 stdin、stdout 和 stderr。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T18:39:40.213

如果命令：

```
$JAVA_HOME/bin/java com.domain.BatchProcess 
```

期待来自标准输入的输入，然后将其放入脚本并运行您的第二个命令将起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T21:27:30.070

它会自动完成。

# git - 列出 Git 存储库中曾经存在的所有文件

> ID：543346
> 
> 赞同：124
> 
> 时间：2009-02-12T21:23:43.183
> 
> 标签：git

您是否有一种简洁的方法来列出指定分支中曾经存在的所有文件？

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2009-02-12T21:39:18.870

这是 Strager[解决方案](https://stackoverflow.com/a/543383/313192)的简化变体：

```
git log --pretty=format: --name-status | cut -f2- | sort -u 
```

**编辑：**感谢 Jakub 在评论中教了我更多信息，这个版本的管道更短，让 git 有更多机会把事情做好。

```
git log --pretty=format: --name-only --diff-filter=A | sort -u 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-23T11:45:32.730

这对于检查文件名是否存在于*repo*中是正确的，而不仅仅是在当前分支上。

```
git log --all --pretty=format: --name-only --diff-filter=A | sort - | grep fubar 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T21:29:46.227

您可以运行`git-log --name-status`，这会回显如下内容：

```
commit afdbbaf52ab24ef7ce1daaf75f3aaf18c4d2fee0
Author: Your Name <your@email.com>
Date:   Tue Aug 12 13:28:34 2008 -0700

    Added test file.

A       test 
```

然后解压文件添加：

```
git-log --name-status | sed -ne 's/^A[^u]//p' | sort -u 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-05-17T11:32:23.800

这是两个有用的别名： FindFile`ff`和 FindFilewithCopies `ffc`：

```
# Find if one file ever had into repository
ff = "!git log --pretty=format: --name-status --all -M -B | sort -u | grep $1   #"
# The same as above but showing copied files
ffc = "!git log --pretty=format: --name-status --all -C -M -B | sort -u | grep $1 #" 
```

您可以获得有关文件名和操作的信息。

样品用途：

```
$ git ff create
A       database/migrations/2014_10_12_000000_create_users_table.php
A       database/migrations/2014_10_12_100000_create_password_resets_table.php
A       database/migrations/2015_05_11_200932_create_boletin_table.php
A       database/migrations/2015_05_15_133500_create_usuarios_table.php
D       database/migrations/2015_05_12_000000_create_users_table.php
M       database/migrations/2015_05_11_200932_create_boletin_table.php
R051    database/migrations/2014_10_12_000000_create_users_table.php    database/migrations/2015_05_12_000000_create_users_table.php

$ git ffc create
A       database/migrations/2014_10_12_000000_create_users_table.php
A       database/migrations/2014_10_12_100000_create_password_resets_table.php
A       database/migrations/2015_05_11_200932_create_boletin_table.php
A       database/migrations/2015_05_15_133500_create_usuarios_table.php
C052    database/migrations/2014_10_12_000000_create_users_table.php    database/migrations/2015_05_11_210246_create_boletin_nosend_table.php
D       database/migrations/2015_05_12_000000_create_users_table.php
M       database/migrations/2015_05_11_200932_create_boletin_table.php
R051    database/migrations/2014_10_12_000000_create_users_table.php    database/migrations/2015_05_12_000000_create_users_table.php 
```

# javascript - 无法通过 JQuery 表单插件的简单验证提交表单

> ID：543348
> 
> 赞同：0
> 
> 时间：2009-02-12T21:23:57.100
> 
> 标签：javascript, jquery, asp.net-mvc, ajax

我正在使用 jQuery Form 插件提交 AJAX 请求。我正在尝试在提交之前进行一些简单的验证（确保填写了字段）。我没有尝试在提交之前运行任何 AJAX 验证。在我将 beforeSubmit 添加到 ajaxform() 方法的选项之前，表单会提交并且我的控制器代码会运行良好。一旦我添加了带有验证函数名称的 beforeSubmit 选项，无论我从 validate 方法返回 false、true 还是什么都没有，表单都不会提交。这是我设置表单的初始代码：

```
$(document).ready(function() {
var options = {
    beforeSubmit: function(data, form, options) { return validate(data, form, options); },
    url: '/PromoManagement/Images/AddImages?partial=true',
    success: updateImageList
};

    $('#frmAddImages').ajaxForm(options);
}); 
```

这是我的验证功能：

```
function validate(data, form, options) {
    var returnMessage = new Array();

    $('#txtImagePath,#txtImageCaption').removeClass('validationError-input');
    clearValidation();

    if ($('#txtImagePath').val().length == 0) {
        returnMessage.push('<li>Image Path is required</li>');
        $('#txtImagePath').addClass('validationError-input');
    }
    else { 
        if (!parseFileExtension($('#txtImagePath').val())) {
            returnMessage.push('<li>Please provide an image with an extension of .jpg, .gif, or .png</li>');
            $('#txtImagePath').addClass('validationError-input');    
        }    
    }

    if (returnMessage.length > 0) {
        $('.errorList').show();
    }

    if (returnMessage.length != 0) {
        buildValidationList(returnMessage);
        return false;
    }
    else {
        return true;
    }

} 
```

如果没有遇到错误，我尝试不返回任何内容，但我得到了相同的结果。我能够闯入验证代码并查看函数返回的内容，这总是如预期的那样。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T21:40:38.853

我认为 beforeSubmit 没有将表单传递给 validate 函数。尝试将 validate 包装在匿名函数中并提供正确的表单参数。

**编辑**看起来 beforeSubmit 函数需要三个参数（[API](http://malsup.com/jquery/form/#api)），第二个是表单。我已经更新了我的示例以反映这一点。查看您的代码后，您似乎并没有使用它——所以它也已更新。我不确定到底发生了什么，因为它似乎应该工作。您是否确认您的验证功能中没有任何 javascript 错误？

```
beforeSubmit: function(data,form,options) {
    return validate();
} 
```

# django - 如何在 Django 中拥有同一个模型的两个外键？

> ID：543377
> 
> 赞同：54
> 
> 时间：2009-02-12T21:28:01.207
> 
> 标签：django, django-models

我想对同一个模型有两个外键：

```
class Test(models.model):
    example1 = models.ForeignKey(Example)
    example2 = models.ForeignKey(Example) 
```

我收到如下错误：

> 字段“example1”的访问器与相关字段“Example.test_set”冲突。将related_name 参数添加到“example1”的定义中。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-02-12T21:35:53.293

尝试使用[`related_name`](http://docs.djangoproject.com/en/dev/ref/models/fields/#foreignkey)：

```
class Test(models.model):
    example1 = models.ForeignKey('Example', related_name='example1')
    example2 = models.ForeignKey('Example', related_name='example2') 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-12T21:36:36.303

Django 使用一些 python 魔法来定义模型之间的关系，其中一些涉及在关系中使用模型的名称（这就是 'test__set' 中的 'test' 的来源。）我猜发生了什么，是它尝试将“test__set”两次放入示例模型中，一次用于您定义的每个外键。

错误消息建议尝试：定义一个`related_name`可以使用的参数（覆盖其中一个'test_set'），而不是自动生成两个冲突的名称。

更多信息[在这里](http://www.djangoproject.com/documentation/models/m2o_recursive/)：页面已被删除

当前与模型关系相关的页面： [https ://docs.djangoproject.com/en/2.0/ref/models/fields/#module-django.db.models.fields.related](https://docs.djangoproject.com/en/2.0/ref/models/fields/#module-django.db.models.fields.related)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-13T03:06:37.900

只需按照错误消息告诉您的操作即可，如果您不确定这意味着什么，请查阅`related_name`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-07-23T20:27:59.633

在 django 2.0 中试试这个：

```
user = models.ForeignKey(User, on_delete=models.PROTECT, null=True,  related_name='user')
paper = models.ForeignKey(paperRecord, on_delete=models.PROTECT, null=True,  related_name='paper') 
```

# html - 编辑对决：在句子末尾保留换行符

> ID：543379
> 
> 赞同：7
> 
> 时间：2009-02-12T21:28:12.987
> 
> 标签：html, latex, editor, collaboration

在编辑非 WYSIWYG（LaTeX、HTML 等）散文时，您可能希望在句子末尾添加换行符。这有几个优点：

1.  更容易重新排列句子。
2.  更容易注释掉句子。
3.  更容易发现连续/过长的句子。
4.  更容易评论*句子*。

例如：

```
% The following isn't strictly true; maybe excise or comment out for now:
After all, people who use Word or other WYSIWYG editors are aiding and 
abetting terrorists. 
```

最重要的优势可能是它使版本控制下的协作编辑变得更加容易。否则，您最终会遇到冲突，它只会告诉您“这个巨大段落的以下两个版本存在冲突”。

但是在句子末尾保留换行符说起来容易做起来难......

```
As you edit the prose
it will get all chopped up, like this.
Normally you'd do a "reformat paragraph"
to clean it up, but then
you lose the newlines at the ends of your sentences! 
```

以下问题询问如何在 emacs 中解决此问题：

[如何让 Emacs 填充句子而不是段落？](https://stackoverflow.com/questions/539984/how-do-i-get-emacs-to-fill-sentences)

我想知道人们如何在其他编辑器中处理这个问题，包括 vim、TeXShop、TextMate 以及您认为在这里收集的任何其他工具。也欢迎有关软包装与硬包装的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T23:40:55.973

我认为最简单的解决方案是仅在句号后添加换行符。您的编辑将永远不会分割线。

请注意，对于散文，您可以很好地依靠编辑器的换行功能来​​换行长句子 - 除非您坚持像使用代码一样缩进它（我在乳胶中缩进不多），

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T07:17:51.150

普通的文本编辑器不应尝试更改您编写的文件，除非您明确要求它这样做。它可能会更改文件在屏幕上的外观以提高可读性，仅此而已。

因此，根据我的经验，大多数体面的编辑器都会进行软换行，并在插入它们的任何地方保持换行符。

就这样。我必须承认我看不出有什么大惊小怪的，除非您使用一些非常奇怪的文本编辑器，它们坚持进行硬换行并需要变通方法。

如果您想保持格式对 diff 有用，只需在每个句子后换行，并接受 diff 将在句子级别上起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T00:04:19.537

**维姆：**

您可以关闭文本换行 ( `set formatoption-=t`)，除非您按 Enter，否则它不会添加换行符。更好的是，如果你能弄清楚如何设置`'comments'`选项以便它识别你的评论，你可以只为你的评论设置自动换行宽度，而不是其他任何东西：

```
set comments=b:%
set textwidth=80
set formatoption+=c
set formatoption-=t 
```

这是我使用的方法，所以我的评论很整洁，但除非我自己做，否则我的代码不会被破坏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T19:10:20.427

在 vim 中，您可以使用 . 填充到当前句子的末尾`gw)`。它不会为您重新格式化整个段落或区域，但是如果您小心地在每个句子后插入换行符，并且在`gw)`编写时重新格式化，它会很好地工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-08T15:07:29.327

无论您做什么，如果您处于协作环境中，请不要使用自动硬包装整个文档的编辑器。朋友不要让朋友使用 WinEdt。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T01:25:52.680

> 我想知道人们在其他编辑器中是如何处理这个问题的，

FWIW 在 Windows 平台上，[Zeus](http://www.zeusedit.com)编辑器具有可配置的*右边距*和内置的*换行*功能。

例如，将右边距设置为**60 个**字符，标记示例文本，然后使用*宏、换行段落*菜单，[Zeus](http://www.zeusedit.com)将重新格式化文本，如下所示：

```
As you edit the proseit will get all chopped up, 
like this. Normally you'd do a "reformat 
paragraph"to clean it up, but thenyou lose the 
newlines at the ends of your sentences! 
```

换行很*困难*，因为上面的所有行都插入了行尾字符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T15:29:47.097

你不想在句子末尾换行。

确保做你列出的 4 件事更容易，但这与世界其他地方的做法不同（即使世界的原因与 CR LF = 换行符背后的推理一样愚蠢）。

而你最大的优势不是真的：

> 否则，您最终会遇到冲突，它只会告诉您“这个巨大段落的以下两个版本存在冲突”。
> 
> > 它怎么知道什么时候是基于行的，什么时候是基于句子的？

您可以使用 Meld 或一些类似的 diff 工具并让它完成工作。

# mysql - 将数据从不断附加的文件中分离到一个新文件中

> ID：543387
> 
> 赞同：4
> 
> 时间：2009-02-12T21:30:38.377
> 
> 标签：mysql, windows, ms-access, scripting, batch-file

我正在使用宏将 Microsoft Access 数据库中的表导出到 csv 文件，以便导入 mysql 数据库。我最终使用了一个批处理文件，它会在导出之前在文本文件中放置一个标记，然后将最后一个标记之后的所有内容放入一个新文件中。这很好用，除了访问不会追加，而是每次都会重新创建文件，因此不可能使用任何类型的标记。

有什么方法可以使用访问或批处理文件或其他方式来a）强制访问附加到文件，或放置自己的标记，或b）每次都导出到不同的文件，文件名可能是诸如日期之类的变量，或者 c) 通过外部操作来克服这种行为

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T08:40:32.950

您可以简单地创建一些代码来打开文件并将数据附加到其中，而不是使用宏来导出表。

**如何使用**

只需将代码复制到应用程序中的 VBA 模块并像这样调用它：

```
' Export the Table "Orders" to "orders.csv", appending the data to the       '
' existing file if there is one.                                             '
ExportQueryToCSV "Orders", "C:\orders.csv", AppendToFile:=True

' Export the result of the query to "stock.csv" using tabs as delimiters     '
' and no header or quotes around strings                                     '
ExportQueryToCSV "SELECT * FROM Stock WHERE PartID=2", _
                 "C:\stock.csv", _
                 AppendToFile:=False, _
                 IncludeHeader:=False, _
                 Delimiter:=chr(9), _
                 QuoteString:=false 
```

**代码**

```
'----------------------------------------------------------------------------'
' Export the given query to the given CSV file.                              '
'                                                                            '
' Options are:                                                               '
' - AppendToFile : to append the record to the file if it exists instead of  ' 
'                  overwriting it (default is false)                         '
' - Delimiter    : what separator to use (default is the coma)               '
' - QuoteString  : Whether string and memo fields should be quoted           '
'                  (default yes)                                             '
' - IncludeHeader: Whether a header with the field names should be the first '
'                  line (default no)                                         '
' Some limitations and improvements:                                         '
' - Memo containing line returns will break the CSV                          '
' - better formatting for numbers, dates, etc                                '
'----------------------------------------------------------------------------'
Public Sub ExportQueryToCSV(Query As String, _
                            FilePath As String, _
                            Optional AppendToFile As Boolean = False, _
                            Optional Delimiter As String = ",", _
                            Optional QuoteStrings As Boolean = True, _
                            Optional IncludeHeader As Boolean = True)
    Dim db As DAO.Database
    Dim rs As DAO.RecordSet

    Set db = CurrentDb
    Set rs = db.OpenRecordset(Query, dbOpenSnapshot)
    If Not (rs Is Nothing) Then
        Dim intFile As Integer

        ' Open the file, either as a new file or in append mode as required '
        intFile = FreeFile()
        If AppendToFile And (Len(Dir(FilePath, vbNormal)) > 0) Then
            Open FilePath For Append As #intFile
        Else
            Open FilePath For Output As #intFile
        End If

        With rs
            Dim fieldbound As Long, i As Long
            Dim record As String
            Dim field As DAO.field

            fieldbound = .Fields.count - 1

            ' Print the header if required '
            If IncludeHeader Then
                Dim header As String
                For i = 0 To fieldbound
                    header = header & .Fields(i).Name
                    If i < fieldbound Then
                        header = header & Delimiter
                    End If
                Next i
                Print #intFile, header
            End If

            ' print each record'
            Do While Not .EOF
                record = ""
                For i = 0 To fieldbound
                    Set field = .Fields(i)
                    If ((field.Type = dbText) Or (field.Type = dbMemo)) And QuoteStrings Then
                        record = record & """" & Nz(.Fields(i).value, "") & """"
                    Else
                        record = record & Nz(.Fields(i).value)
                    End If
                    If i < fieldbound Then
                        record = record & Delimiter
                    End If
                    Set field = Nothing
                Next i
                Print #intFile, record
                .MoveNext
            Loop
            .Close
        End With
        Set rs = Nothing
        Close #intFile
    End If
    Set rs = Nothing
    Set db = Nothing
End Sub 
```

请注意，它并不完美，您可能必须调整代码以反映您希望如何格式化数据，但在大多数情况下默认值应该没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T21:42:25.370

a) 强制访问附加到文件，或放置自己的标记

不会。导出每次都希望写入一个全新的文件，如果文件已经存在，则会出现问题。

b) 每次导出到不同的文件，文件名可能是一个变量，例如日期

是的，将路径/文件名构建为字符串，并将日期/时间附加到末尾

c）通过外部操纵克服这种行为

好吧，您可以将新的内容转储到一个虚拟文件中，然后使用批处理脚本或系统调用来执行以下操作：

```
echo marker >> goodfile.csv
type dummy >> goodfile.csv
del dummy 
```

但是，如果您只想添加新记录，更好的方法是只处理虚拟文件，而不是尝试寻找最后一个标记并处理低于该标记的所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T01:52:43.303

您还可以使用 VBScript 执行用于导出的查询，并将这些记录附加到现有文件中。

# html - 是否有类似 Webmaster's Toolkit 的东西可以在 Linux 上运行？

> ID：543396
> 
> 赞同：0
> 
> 时间：2009-02-12T21:33:33.020
> 
> 标签：html, css, linux

当我在处理 HTML 或 CSS 时，我不断地试图弄清楚“这个元素内部有多少填充像素？它是什么颜色？左边距是三个像素宽还是四个？”

是否有一个 Linux 应用程序或一组应用程序可以放大屏幕的一部分并在该放大的空间内提供像素标尺和颜色选择器？就像名为“Webmaster's Toolkit”的 Windows 应用程序 - [http://spicebrains.com](http://spicebrains.com)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T21:59:02.007

获取[Firebug](http://getfirebug.com/)，缺一不可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T22:21:52.683

优秀的 Firebug 教程：

1.  [Firebug 教程 - 日志记录、分析和命令行（第一部分）](http://michaelsync.net/2007/09/09/firebug-tutorial-logging-profiling-and-commandline-part-i)

2.  [Firebug 教程 - 日志记录、分析和命令行（第二部分）](http://michaelsync.net/2007/09/10/firebug-tutorial-logging-profiling-and-commandline-part-ii)

3.  [Firebug 教程 - 在 Firebug 中使用命令行 API](http://michaelsync.net/2007/09/15/firebug-tutorial-commandline-api)

4.  [Firebug 教程：第 4 部分 - 网络、CSS 和 DOM 选项卡](http://michaelsync.net/2007/10/15/firebug-tutorial-section-4-net-css-and-dom-tabs)

**更新：**这就是我所说的。（我的萤火虫是西班牙语，但你明白了）。
如果你点击“小”红色箭头所在的位置，你会得到一把漂亮的尺子。

[替代文字 http://img25.imageshack.us/img25/573/pantallazogm6.png](http://img25.imageshack.us/img25/573/pantallazogm6.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T21:43:55.037

有一个用于 Firefox 的 webdev 插件，可以提供所有这些信息。

[Web开发人员](http://chrispederick.com/work/web-developer/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T00:00:28.640

测量像素的一种非常简单的方法是截取屏幕截图并将其拖到 GIMP 中。您可以使用吸管获取颜色，并使用选取框（选择）工具获取尺寸。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T12:00:37.880

要在屏幕上测量距离，请查看`kruler`或`screenruler`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T21:36:06.150

Well Web 开发者扩展提供了一个像素标尺。您可以将它与 gnome 可访问放大镜结合使用吗？我猜。

# python - Python 字符串格式化

> ID：543399
> 
> 赞同：5
> 
> 时间：2009-02-12T21:34:14.517
> 
> 标签：python

我看到你们在使用

```
url = '"%s"' % url # This part

>>> url = "http://www.site.com/info.xx"
>>> print url
http://www.site.com/info.xx
>>> url = '"%s"' % url
>>> print url
"http://www.site.com/info.xx" 
```

它是高级 Python 吗？有教程吗？我怎样才能了解它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-12T21:43:26.770

这是常见的字符串格式，非常有用。它类似于 C 风格的 printf 格式。请参阅Python.org 文档中的[字符串格式化操作](http://docs.python.org/library/stdtypes.html#string-formatting)。您可以像这样使用多个参数：

```
"%3d\t%s" % (42, "the answer to ...") 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-12T21:37:36.927

那行代码使用 Python 字符串格式。您可以在此处阅读有关如何使用它的更多信息：http: [//docs.python.org/library/stdtypes.html#string-formatting](http://docs.python.org/library/stdtypes.html#string-formatting)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T21:37:33.820

它不是高级的，你可以使用 ' 或 " 来定义一个字符串。

检查[文档](http://docs.python.org/reference/lexical_analysis.html#strings)。

# graphics - JPEG 压缩图像可以在不损失质量的情况下旋转吗？

> ID：543402
> 
> 赞同：28
> 
> 时间：2009-02-12T21:35:09.850
> 
> 标签：graphics, compression, jpeg, lossy-compression

JPEG 是一种有损压缩方案，因此解压缩-操作-再压缩通常会进一步降低每一步的图像质量。**是否可以旋转 JPEG 图像而不会造成进一步的损失？**根据我对 JPEG 算法的了解，天真地似乎可以通过一些努力来避免进一步的损失。哪些常见的图像处理程序（例如 GIMP、Paint Shop Pro、Windows 照片库）和图形库在执行旋转时会导致质量损失，哪些不会？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-15T16:03:08.373

有一个名为 jpegtran 的程序

> jpegtran – 用于在不同 JPEG 格式之间进行无损转码的实用程序。

要无损旋转图像，您可以执行以下操作：

```
$ jpegtran -rotate 180 -perfect -outfile rotated.jpg origin.jpg 
```

[以下是提供基于 IJG 代码的 JPEG 无损旋转功能的应用程序](http://jpegclub.org/losslessapps.html)列表

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-12T22:23:12.633

是的，在某些情况下是可能的：90 度旋转和翻转图像。JPEG 算法的核心——有损部分——涉及将图像分解为 8x8 像素块，对块执行[离散余弦变换](http://en.wikipedia.org/wiki/JPEG#Discrete_cosine_transform)，然后量化结果。除此之外，还有一些色彩空间转换和块的无损压缩。

旋转或翻转 8x8 块将给出具有相同基本系数的 DCT，但可能会转置和/或根据变换进行一些符号变化。因此，无损旋转或翻转图像的基本步骤包括：

1.  解压缩并提取块
2.  转置和/或符号翻转每个块的 DCT 系数
3.  将块重新排列成新的顺序（否则 8x8 块将被旋转但仍在旧位置）
4.  使用无损压缩步骤重新压缩所有内容。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-12T21:40:45.810

绝对 - 只需更改 EXIF 数据中的方向值。绝大多数图像程序将尊重此设置并显示“旋转”的图片。

如果某些标准为真，也可以“手动”（例如以编程方式）以无损方式旋转图像 - 旋转必须是 90/180 度并且宽度/高度必须是块大小的倍数。您也可以翻转/镜像它。不过，我不知道图像程序是否足够聪明，可以对这种操作进行特殊处理。我猜不会。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-12T21:47:59.427

从[JPEG 常见问题解答](http://www.faqs.org/faqs/jpeg-faq/part1/)：

> “有一些专门的操作可以在不解压缩 JPEG 文件的情况下完成，因此不会产生通常在常规图像编辑器中加载和重新保存图像所产生的代际损失。特别是它是如果图像尺寸是文件块大小的倍数（对于彩色 JPEG，通常为 16x16、16x8 或 8x8 像素），则可以进行 90 度旋转和无损翻转。
> ...
> 
> 但是您确实需要特殊的软件；在常规图像编辑器中旋转图像不会是无损的。”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T21:41:11.503

不是 jpg 专家，但对于 90、180、270 度旋转，答案似乎是肯定的。（甚至可能是 360！:)）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-12T21:42:07.150

是的，有可能。
快速的谷歌搜索给出了[执行此操作的程序列表](http://jpegclub.org/losslessapps.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T21:43:48.440

如果您说的是旋转 JPEG 图像，那么就没有进一步的压缩了，对吧？它是关于旋转像素位置。

使用任何程序进行旋转都可能会改变中间尺寸，因为它需要保留原始图像，这可能是一个需要考虑的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-12T21:44:25.630

除非您旋转 90 度的倍数，否则您的图像将不得不执行某种可能会降低图像质量的插值。在这里使用一个好的插值算法会有所帮助。

至于打开和重新压缩，我不确定你实际上会得到更差的质量，但是我不确定 JPEG 究竟是如何工作的。

我建议您尝试压缩、操作和重新压缩，看看结果是否足够好。什么是足够好的取决于您的应用程序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-21T14:21:46.957

根据Sean McHugh关于[理解数字图像插值的优秀文章：](http://www.cambridgeincolour.com/tutorials/image-interpolation.htm)

> 每次旋转或扭曲图像时也会发生插值。(...) 90° 旋转是无损的，因为没有像素必须重新定位到两个像素之间的边界上（因此被分割）。

并最终以

> 尽可能避免旋转照片；如果不平整的照片需要它，请旋转一次。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-09T22:09:12.890

如果它可以帮助：

Trying to do better than the Microsoft (Windows 7) native picture viewer and its right-click rotation options, I tried several apps of the following link : [http://jpegclub.org/losslessapps.html](http://jpegclub.org/losslessapps.html)

For instance, I tried FastStone Image Viewer, XnView, Photosurfer, JPEG Lossless Rotator, ExifPro Image Viewer.

NONE of them yields a bigger picture than the basic Windows 7 picture viewer after a simple 90° rotation. It's admittedly limited to conclude so quickly, but I still don't have found a real lossless rotation .jpeg app for the moment, and in any case not better than the built-in Windows one.

# wpf - 如果我的应用程序未设置 StartupUri，则不会解析 App.xaml 文件？

> ID：543414
> 
> 赞同：46
> 
> 时间：2009-02-12T21:37:15.770
> 
> 标签：wpf, xaml, resources, startup

背景：我正在使用 MVVM 创建一个 WPF 应用程序，并使用 DI 容器来构建我的 ViewModels

我的 App.xaml 看起来像这样：

```
<Application x:Class="WpfApp.App"
    ...xmlns etc...
    StartupUri="MainWindow.xaml">
    <Application.Resources>
        <app:ServiceLocator x:Key="serviceLocator" />
    </Application.Resources>
</Application> 
```

MainWindow.xaml 看起来像这样：

```
<Window x:Class="CompositeMefWpfApp.MainWindow"
    ...xmlns etc... >
    <Control.DataContext>
        <Binding Path="MainWindowViewModel" Source="{StaticResource serviceLocator}" />
    </Control.DataContext> 
```

现在，这一切都很好，但是`StartupUri`被硬编码到 XAML 中，这是我不想要的。
根据我找到的几篇博文和文章的指导，我删除了`StartupUri`，并尝试通过在 App.xaml.cs 中`MainWindow`挂钩来创建 ，如下所示：`OnStartup`

```
protected override void OnStartup( StartupEventArgs e )
{
    base.OnStartup(e);
    new MainWindow().Show();
} 
```

问题是，应用程序在尝试显示窗口时崩溃，但有以下例外：

> 找不到名为“{serviceLocator}”的资源。资源名称区分大小写。标记文件“WpfApp;component/mainwindow.xaml”第 8 行位置 45 中的对象“System.Windows.Data.Binding”出错。

据我所知，该`<Application.Resources>`部分根本没有从 xaml 文件中读出。我可以在 OnStartup 中放置一些代码以编程方式添加资源，如下所示：

```
Resources.BeginInit();
Resources.Add("serviceLocator", new ServiceLocator());
Resources.EndInit(); 
```

然而，这是一个丑陋的黑客，如果我想稍后在 app.xaml 文件中添加其他内容，这对我没有帮助:-(

我应该挂钩其他事件吗？有没有解决的办法？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-02-17T02:01:12.240

不要覆盖 OnStartup，而是尝试使用事件：

```
<Application x:Class="My.App"
    xmlns="..."
    Startup="Application_Startup"
    ShutdownMode="OnExplicitShutdown">
        <Application.Resources>
            <app:ServiceLocator x:Key="serviceLocator" />
        </Application.Resources>
    </Application> 
```

后面的代码：

```
public partial class App : Application
{
    public App()
    { }
    private void Application_Startup(object sender, StartupEventArgs e)
    {
        // TODO: Parse commandline arguments and other startup work 
        new MainWindow().Show();
    }
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-10-09T15:38:19.397

最简单的解决方法是定义**x:Name**：

```
<Application x:Name="App" ...
    <Application.Resources>
        ...
    </Application.Resources>
</Application> 
```

更多信息：[http ://connect.microsoft.com/VisualStudio/feedback/details/472729/wpf-cannot-find-resource-defined-in-the-app-xaml-file](http://connect.microsoft.com/VisualStudio/feedback/details/472729/wpf-cannot-find-resource-defined-in-the-app-xaml-file)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-08-19T16:17:26.327

我遇到了类似/同样的问题。有一个 VS 代码生成错误，当仅包含一个条目且没有属性`<Application.Resources>`时，有时不会插入连接到程序其余部分所需的代码。`<Application.Resources>``StartupUri`

详细信息： http: [//bengribaudo.com/blog/2010/08/19/106/bug-single-application-resources-entry-ignored](http://bengribaudo.com/blog/2010/08/19/106/bug-single-application-resources-entry-ignored) *（免责声明--链接指向我的博客）*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-23T15:35:24.177

要解决这个已知错误，您也可以以编程方式添加资源。

```
var rd = new ResourceDictionary()
rd.Source = new Uri("pack://application:,,,/Resources;component/Colors.xaml");
Resources.MergedDictionaries.Add(rd); 
```

这段代码可以放在`App`类的构造器中。

# wcf - 在 WCF 中批处理消息？

> ID：543422
> 
> 赞同：1
> 
> 时间：2009-02-12T21:38:33.710
> 
> 标签：wcf

这是我的场景......我将收到来自外部来源的单个消息流。这些数据的性质和我必须对它们进行的处理是，我可以在一批中包含的消息越多，我平均可以处理的消息就越多。举个例子：

1.  Messages 1 进来，WCF 服务开始处理消息
2.  消息 2 和 3 在步骤 1 完成处理之前进入。一起处理 2 和 3。

这里显然有一些假设，即我们不能在第 1 步完成之前开始处理第 2 步，但我们可以在一次运行中处理多条消息。

我最初的想法是简单地使用 msmq 绑定，以便在处理一批时消息可以排队。但后来我意识到 WCF 只会一次传递每条消息。而且我什至不确定它是否会等到一条消息完成处理后再拉下一条消息并处理该消息（可能在线程中？），这在这种情况下会很糟糕。

所以，我只是想知道是否有人可以就如何使用 WCF 完成这样的系统提供一些指导。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T00:52:34.133

## 最大化吞吐量

解决方案可能是根本不考虑 WCF。您可能需要一个在与 ServiceHost 不同的线程上运行的状态机。该状态机将托管，例如，包装，队列或类似类型的类。将为状态机提供一个委托，用于处理消息。当您的 WCF ServiceHost 接收到消息时，它会将消息推送到封装在您的状态机中的队列中，这就是它所关心的全部。

当状态机以您指定的时间间隔进行迭代时，它将以您想要的任何数量从队列中弹出消息。理想情况下，您应该将其设计为在您的服务配置设置中进行限制。这将允许您试验哪种批处理大小最有效，类似于将行更新批处理到数据库表以提高性能的有用性。

## 批处理消息

当然，您可以将您的消息信封（基本上，您作为参数传递给 OperationContract 方法的类型）设计为基本上是 1 到 N 条消息的容器。这肯定会通过最小化消息数量来优化字节的传递。但是，无论是一条消息到达还是 N 条消息同时到达都不会改变正确处理这些消息所需的逻辑，除了添加某种循环来遍历 N 条消息。您愿意考虑 MSMQ 的事实表明您的消息传递范式已经是异步的，因此它应该与我描述的最大化吞吐量的方法一起工作。

# date - 哪个更有用，输出相对于现在或相对于主要动作的时间点的日期？

> ID：543430
> 
> 赞同：3
> 
> 时间：2009-02-12T21:39:58.153
> 
> 标签：date, usability

我刚刚在阅读[“致乔尔和杰夫的公开信”](http://blog.objectmentor.com/articles/2009/02/06/on-open-letter-to-joel-spolsky-and-jeff-atwood)，我注意到评论上的日期与发布博客条目的时间有关。这意味着第一个条目将始终保持为“12 分钟后”，而下一个条目将始终为“14 分钟后”。

从可用性的角度来看，列出相对于现在或主要动作发生时间的时间是否更有意义？

在第一次看到这个时，我觉得这有点令人困惑（我想是因为我没想到会这样），但它很快就在我身上成长了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T22:12:25.140

正如 Steve Krug 在[Don't Make Me Think](https://rads.stackoverflow.com/amzn/click/com/0321344758)中所建议的那样，当用户访问您的站点时，请去掉他们脑海中浮现的问号。如果它令人困惑，它可能不会有帮助。

虽然是一个有趣的概念，但在这种情况下，我认为它比有用更令人困惑。如果我看到“18 分钟前回答”和“17 分钟前回答”我有一个完美的参考框架。这也是我在许多其他网站上看到的东西，所以它不需要我学习任何新东西。

另一方面，如果我看到两条包含“5 分钟后”和“6 分钟后”的评论，我没有明确的参考框架。第一个可能是在原始问题之后，但另一个？是在上一条评论之后 6 分钟吗？还是在原始问题后 6 分钟，因此在其他评论后一分钟？最后，这不是您通常在网站上看到的内容，因此会有片刻的“嗯？” 跟着“wtf?” 或“酷！”。不是一个应该留给机会的反应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T21:45:28.730

像大多数事情一样，唯一真正的答案是“视情况而定”。在考虑每个评论必须与其他周围评论有上下文的依赖评论列表时，相对时间可能是有意义的。

但是，在您的银行对帐单上显示 ATM 提款交易时，每个项目都是独立的，相对时间可能不是向读者准确指示交易发生时间的最佳方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T21:46:56.543

我认为这取决于上下文。如果参考点是博客文章，那么我认为将与该文章相关的评论时间显示在文章之后是完全有意义的。

如果参考点不清楚，使用“现在”作为参考会更有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T07:52:39.193

您省略了指定绝对日期和时间的选项，这是我更喜欢的选项。

例如，在 Stack Overflow 上，我总是必须计算自上次检查新答案以来已经过去了多少小时，这样我就知道要回溯多远。

# tomcat - 在 Netbeans 中运行时停止 Tomcat

> ID：543439
> 
> 赞同：12
> 
> 时间：2009-02-12T21:40:58.383
> 
> 标签：tomcat, netbeans

我使用 NetBeans 运行 Apache Tomcat 6。当我的代码出现故障时，例如 NullPointerException，tomcat 失败并且不会运行任何其他请求。

我的问题是我无法让 tomcat 停止，我必须重新启动整个 Netbeans IDE。

有任何想法吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2010-10-25T09:48:29.177

在 Netbeans 6.9.1（Windows）上，您应该在左侧看到“服务”选项卡以及“项目”、“文件”等其他选项卡。单击“服务”选项卡。单击“服务器”的“+”。带有绿色三角形（播放图标）的所有内容都表示该服务正在运行。右键单击“Apache Tomcat 6.X.XX”并选择“停止”。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-16T03:02:09.707

我发现，Netbeans 似乎很难控制 Tomcat。应用程序部署的次数越多，Tomcat 就越不稳定，直到我遇到您描述的问题。在大型应用程序上，它只需要一次部署。我的解决方法包括通过 Netbeans 中的“服务”选项卡（在 Servers/Tomcat6/applicationContext 下）取消部署应用程序，然后在*每次*运行应用程序之前停止 Tomcat 实例。如果 Netbeans 无法取消部署应用程序，我将浏览器指向 Tomcat 管理器 Web 应用程序（通常为[http://localhost:8080/manager/html](http://localhost:8080/manager/html)) 并从那里取消部署它。如果 Netbeans 无法停止 Tomcat，我会杀死 Tomcat 正在使用的 JVM（Windows 中的 CTRL + ALT + DEL）。使用这三种方法，我可以在大约 95% 的时间内避免重新启动 Netbeans。当我感到非常沮丧时，我从命令行使用 Jetty 运行我的项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T20:03:40.903

我不知道您使用的是哪个 Netbeans 版本，但要停止正在运行的 Tomcat 实例，请右键单击 Tomcat 项目的节点并从弹出菜单中选择停止 Tomcat。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T07:06:08.873

您使用的是 NetBeans 附带的嵌入式 Tomcat 吗？我建议您[在本地下载并解压缩 Tomcat 6](http://tomcat.apache.org/download-60.cgi)，将其添加到 NetBeans 并将其用于您的 Web 应用程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-31T16:07:12.467

您可以简单地转到服务并找到“apache tomcat”。右键单击并使其手动（这样当您再次打开机器时它不会自动启动）。在左侧面板上停止服务。您可以稍后在需要时启动它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-18T22:36:28.980

我必须仔细检查，但是当我在 Linux 上运行 NB 时，我相当确定右下角有一个带有“x”的小图标/窗口来终止正在运行的进程（即停止运行）。我没有在mac上看到它，但为什么不呢？

也许我记错了，但是杀死tomcat很尴尬，如此处所述。

# tsql - 如何缩短 TSQL 中的长 UNION ALL 查询

> ID：543442
> 
> 赞同：1
> 
> 时间：2009-02-12T21:41:36.557
> 
> 标签：tsql, logic

我需要缩短这个查询，虽然我很擅长 SQL，但我仍在学习。

```
 SELECT
        'doejoh',
        DATETIME,
        [Recipient-Address], [Message-Subject], [Sender-Address] 
    FROM
        dbo.Logs 
    WHERE
        LEFT([Recipient-Address], 6) IN ('doejoh') 
UNION ALL 
    SELECT
        'doejoh',
        DATETIME,
        [Recipient-Address], [Message-Subject], [Sender-Address] 
    FROM
        dbo.Logs 
    WHERE
        LEFT([Recipient-Address], 10) IN ('john.doe@g') 
UNION ALL 
    SELECT
        'doejoh',
        DATETIME,
        [Recipient-Address], [Message-Subject], [Sender-Address] 
    FROM
        dbo.Logs 
    WHERE
            LEFT([Sender-Address], 6) IN ('doejoh') 
    UNION ALL 
    SELECT
        'doejoh',
        DATETIME,
        [Recipient-Address], [Message-Subject], [Sender-Address] 
    FROM
        dbo.Logs 
    WHERE
            LEFT([Sender-Address], 10) IN ('john.doe@g')
    ORDER BY
        DateTime 
```

我必须使用这个联合，因为在同一张表中，每个用户及其电子邮件地址有 4 种不同的可能性。话虽如此，我有 30 个用户，所以在整个查询中 30x4 将是 120 个组。第一列必须是用户名的原因是因为我在 Crystal Report 中使用该列。

我只是想为我的查询创建一些逻辑来缩短它，同时将每个用户“分配”到他们适当的第一列。

**编辑添加**

虽然这会缩短我的查询，但我仍然需要有 30 个联合：

```
SELECT
   'doejoh',
   DATETIME,
   [Recipient-Address], [Message-Subject], [Sender-Address] 
FROM
   dbo.Logs 
WHERE
   LEFT([Recipient-Address], 6) IN ('doejoh') OR
   LEFT([Recipient-Address], 10) IN ('john.doe@g') OR
   LEFT([Sender-Address], 6) IN ('doejoh') OR
   LEFT([Sender-Address], 10) IN ('john.doe@g')
ORDER BY
   DateTime 
```

因为下一个用户将与前一个用户联合：

```
UNION ALL 
SELECT
   'doejan',
   DATETIME,
   [Recipient-Address], [Message-Subject], [Sender-Address] 
FROM
   dbo.Logs 
WHERE
   LEFT([Recipient-Address], 6) IN ('doejan') OR
   LEFT([Recipient-Address], 10) IN ('jane.doe@g') OR
   LEFT([Sender-Address], 6) IN ('doejan') OR
   LEFT([Sender-Address], 10) IN ('jan.doe@g') 
```

等等等等……还有更短的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T21:44:22.120

您应该将查询重写为：

```
SELECT
   'doejoh',
   DATETIME,
   [Recipient-Address], [Message-Subject], [Sender-Address] 
FROM
   dbo.Logs 
WHERE
   LEFT([Recipient-Address], 6) IN ('doejoh') OR
   LEFT([Recipient-Address], 10) IN ('john.doe@g') OR
   LEFT([Sender-Address], 6) IN ('doejoh') OR
   LEFT([Sender-Address], 10) IN ('john.doe@g')
ORDER BY
   DateTime 
```

我认为在选择方面应该是一样的，只是更快更容易理解。

马克

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T21:47:11.443

有没有理由这样的事情不起作用？

```
CREATE TABLE #TempNames
(
    shortname nvarchar(6),
    longname nvarchar(10)
)

INSERT INTO #TempNames (shortname, longname) VALUES('doejoh', 'john.doe@g')
INSERT INTO #TempNames (shortname, longname) VALUES('doejan', 'jan.doe@g')
INSERT INTO #TempNames (shortname, longname) VALUES('smibob', 'bob.smith@g')

SELECT
    #TempName.shortname,
    DATETIME,
    [Recipient-Address], [Message-Subject], [Sender-Address]
FROM
    dbo.Logs
INNER JOIN
    #TempNames
ON
    LEFT([Recipient-Address], 6) = #TempNames.shortname
OR
    LEFT([Recipient-Address], 10) = #TempNames.longname
OR
    LEFT([Sender-Address], 6) = #TempNames.shortname
OR
    LEFT([Sender-Address], 10) = #TempNames.longname 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T21:46:24.347

创建一个映射表并加入它。

例如。就像是

```
select user_name, DateTime .... 
from Logs
join Users on 
   LEFT([Recipient-Address], 6) IN (user_name) OR
   LEFT([Recipient-Address], 10) IN (user_email) OR
   LEFT([Sender-Address], 6) IN (user_name) OR
   LEFT([Sender-Address], 10) IN (user_email) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T21:45:35.503

你不能只用...

```
SELECT
    'doejoh',
    DATETIME,
    [Recipient-Address], [Message-Subject], [Sender-Address] 
FROM
    dbo.Logs 
 WHERE
    (LEFT([Recipient-Address], 10) IN ('john.doe@g'))
or  (LEFT([Recipient-Address], 6) IN ('doejoh') )
or  ( LEFT([Sender-Address], 10) IN ('john.doe@g'))
or  (LEFT([Sender-Address], 6) IN ('doejoh') ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T21:58:38.247

用这 30 个人的电子邮件地址创建一个表。表：电子邮件列：short6、long10、电子邮件

然后只使用 1 个联合

```
Select Emails.short6, Logs.DateTime, Logs.[Recipient-Address], Logs.[Message-Subject], Logs.[Sender-Address]
From Emails JOIN Log on Emails.email = Log.[Recipient-Address]
Where LEFT([Recipient-Address], 6) = Emails.short6 
or LEFT([Recipient-Address], 10) = Emails.long10

union all

Select Emails.short6, Logs.DateTime, Logs.[Recipient-Address], Logs.[Message-Subject], Logs.[Sender-Address]
From Emails JOIN Log on Emails.email = Log.[Sender-Address]
Where LEFT([Sender-Address], 6) = Emails.short6 
or LEFT([Sender-Address], 10) = Emails.long10 
```

# apache-flex - 是 flex 动作脚本吗？

> ID：543450
> 
> 赞同：7
> 
> 时间：2009-02-12T21:42:55.180
> 
> 标签：apache-flex, flash, actionscript

我使用 Flash 已经有很长时间了，主要是作为一个动画工具，稍微涉足 actionscript。多年来，我已经从主要制作动画转向主要制作小型 Flash 游戏或在业余时间进行概念验证。我一直很不愿意学习 as3，因为我不是一个程序员，但我的一个朋友说服了我。

我一直在查资料，我不断遇到 Flex，我不完全确定 flex 是什么，我希望有人可以向我解释。从我所查找的内容来看，如果有意义的话，听起来 flex 只是 Flash 之外的动作脚本。这是我应该调查的人吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-12T21:56:59.827

Flash 和 Flex 都使用 ActionScript 语言——Flash CS3 和 Flex 2 都支持 ActionScript 3（与 ECMAScript Edition 4 兼容），而旧版本的 Flash 仅支持 ActionScript 2。

两者的区别在于：

1) Flash 旨在促进交互式内容的创建，而 Flex 则面向应用程序开发。

2) Flash 将您的应用程序结构存储在二进制 FLA 文件中，而 Flex 使用基于 Flex 标记语言 MXML 的文本文件。

3) 不同的部署模型。

Flex 最初旨在将企业程序员带到 Flash 平台。因此，Flex 提供了专为满足核心程序员的特殊需求而设计的工具。

看看[这篇博](http://paragmetha.blog.com/1831276/)文，它很好地说明了 Flash 和 Felx 的优缺点。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-12T21:58:08.763

Flex 有很多东西，但简而言之，Flex 是一种结合了 MXML 和 ActionScript 的技术，允许您快速构建用于 Flash Player 的富 Internet 应用程序。将 MXML 视为 HTML。它是一种构建用户界面的标记语言。很高兴知道 MXML 被编译为 ActionScript，因此完全可以在 ActionScript 中编写所有内容并避免使用 MXML，尽管在大多数情况下我不建议这样做。它只是 ActionScript 之上的一层。

Flex 框架是一组 UI 组件、数据集合、验证器、服务类等等，它们构成了您的应用程序的构建块。

Flex SDK 是构建源代码所需的框架和编译器。

Flex Builder 是可用于创建 Flex 应用程序的工具。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-12T23:41:40.433

**Flex**是框架的名称。该框架允许您使用一种称为 MXML 的标记语言来定义结构（类似于 HTML）和一种称为 ActionScript 的脚本语言来定义行为（类似于 JavaScript）。Flex 带有一套完整的 UI、数据等组件，可以更快地构建应用程序。

**Flash**是您从 Adob​​e 购买的动画包。在 Flash 中，您可以在时间轴上创建动画并使用称为 ActionScript 的脚本语言定义行为。

Flex 和 Flash 都以“ **Flash 平台**”为目标。换句话说，Flash 平台（Flash 插件）播放 SWF，并且有许多工具可以构建 SWF。Flex 和 Flash 只是其中的两个。

例如，还有许多针对 Flash 平台的开源工具，如[MTASC](http://www.mtac.org) (AS2)、[Haxe](http://www.haxe.org)和[SWFMill](http://www.swfmill.org)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T22:03:23.277

> 听起来 flex 只是 Flash 之外的动作脚本

不是“外部”，因为它仍然在 Flash 插件上运行。它更像是一个使用 AS3 编写应用程序并在 Flash 之上运行它们的框架。

也许“外部闪光”的想法来自 AIR。那只是一个看起来不像的浏览器！它呈现 HTML（使用 WebKit）、JS 和 Flash。唯一缺少的是 URL 栏。这个简单的区别就足以让 webapps 看起来更像桌面应用程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-10T18:49:36.757

需要注意的另一件有趣的事情是，Flex 仅支持 ActionScript 3，因此不能用于制作与 FlashLite 一起用于嵌入式设备的应用程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T21:56:29.797

Flex 是 Adob​​e 用 ActionScript 和基于 XML 的声明性语言 MXML（用于以声明性样式构建用户界面）编写的混合开源/专有框架 + 编译器。该框架主要由 GUI 和相关类组成。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-28T23:15:06.443

Flex MXML 是学习创建 UI 的绝佳方式。我只有几个月的时间，我真的很欣赏它的高质量移动应用程序开发风格。我是这里的老派 Timeline dewb，所以这对我来说是一个学习曲线。绝对是 Actionscript 3，有很多不同的方式：D

干杯

# sql - 不同值的 SQL 分组聚合

> ID：543451
> 
> 赞同：0
> 
> 时间：2009-02-12T21:43:04.307
> 
> 标签：sql, sql-server, outer-join

我有一个看起来像这样的数据库表：

```
 ForeignId: int
Key: varchar
Value: varchar 
```

其中 ForeignId 和 Key 构成唯一主键

我可以很容易地确定为给定文档集定义的总键集

```
 SELECT DISTINCT [Key] FROM [Table] WHERE [ForeignId] IN (...) 
```

但是，我想做的是进一步区分每个属性的每个值的值，如果每个 ForeignId 都相同（如果值不同，则为 NULL 或其他一些标记值）。

如果我这样做：

```
ForeignId 键值
1 1 安
1 2 乙
1 3℃
2 1 安
2 2 Z
3 1 安
3 2 Z

```

我想要像这样的输出：

```
核心价值
1 A -- 所有 3 个都相同
2 NULL -- 多个不同的值（B 和 Z）
3 NULL -- 只为一个 ForeignId 定义

```

我能想到的最好的是

```
 SELECT [Key], MAX([Value]), MIN([Value]) FROM [Table]
WHERE [ForeignId] IN (...)
GROUP BY [Key] 
```

并寻找返回的最大值和最小值不同的任何实例。如果它们相同，我假设所有值都匹配，如果它们不同，我知道有多个不同的值。

这里缺少的是第三部分，如果任何单个项目根本没有定义，我需要将值标记为不同。在上面的示例中，我当前的代码将返回键 3 的值 C，即使它没有为某些 ForeignId 定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T22:54:39.017

好的 - 所以如果我理解你的问题，你需要生成一个包含两列的列表，键和值。

该列表将为每个键都有一行，值列可以定义为：

如果没有为所有 ForeignID 定义，则为 NULL' 如果为所有键定义但包含多个值，则为 NULL 如果为所有键定义，则该值始终相同？

所以，我认为我们想做这样的事情：

```
选择
    表键，
    数据.VAL
从
    桌子
左连接
(
   SELECT KEY, VALUE from TABLE GROUP BY KEY, VALUE HAVING COUNT(*) = x
） 数据

```

其中 x 是不同键的数量（您可能希望将其放入子查询中）。

左连接将确保您列出所有键，子查询仅在分组计数等于键数的情况下返回值。

我无法访问 sql（在家，新 PC）来测试我的语法，但我认为这个想法应该让你走上正确的道路。

如果我误解了您的问题，请告诉我

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T23:01:59.483

我认为如果不使用某种代码（存储过程可以工作）而它真的很难看（而且很可能很慢），你就无法做到这一点。

这是我最好的尝试。比较难看。我不想在生产中使用它。我质疑它的表现如何（时间方面）。这是 MySQL 的说法，因为那是我所熟悉的

```
SELECT key, IF(EXISTS (SELECT 1 FROM table t
                        WHERE t.key = key AND t.value != value),
               null, value)
FROM table
GROUP BY key
ORDER BY key 
```

以下是各部分的解释：

```
SELECT 1 FROM table t WHERE t.key = key AND t.value != value 
```

如果表中有另一行具有相同的键但不同的值，则返回一行。

IF 检查上面的查询是否返回了一行。如果确实如此（EXISTS 有效），则返回 null（因为存在具有不同值的行）。如果它没有返回一行，那么它们都匹配并且我们返回值。

GROUP BY 确保每个键只执行一次。

ORDER BY 让它很漂亮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T23:07:14.573

克里斯几乎拥有它。添加另一个组，你是金子。

```
SELECT
    TABLE.KEY,
    data.VAL
FROM
    TABLE
LEFT JOIN
(
   SELECT KEY, VALUE FROM TABLE GROUP BY KEY, VALUE HAVING COUNT(*) = x
) data on Table.Key = data.Key
group by Table.Key, data.VAL 
```

# php - PHP数组提取对象

> ID：543454
> 
> 赞同：1
> 
> 时间：2009-02-12T21:43:30.123
> 
> 标签：php, arrays, extract, javabeans, casting

假设我有一个用户定义类的对象数组。想知道如何在 PHP 中提取数组的元素。

```
// class definition
class User
{
public $fname;
public $lname;
}

// array of objects of the class defined above
$objUser1 = new User():
$objUser2 = new User():
$objUser3 = new User():
$objUser4 = new User():

$alUser = array();
$alUser[] = $objUser1;
$alUser[] = $objUser2;
$alUser[] = $objUser3;
$alUser[] = $objUser4;

// trying to iterate and extract values using typcasting - this does not work, what is the alternative.
foreach($alUser as $user)
{
$obj = (User) $user; // gives error - unexpected $user;
} 
```

这就是我在从 Java ArrayList 中提取对象时在 java 中所做的事情，因此认为 PHP 的方式可能是相似的。谁能解释一下。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T21:45:41.180

```
foreach ($alUser as $user) {
    $obj = $user;
} 
```

为什么需要为此进行类型转换？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T21:55:43.760

PHP 是一种动态类型的语言。大多数情况下不需要强制转换。

无法强制转换为用户：请参阅 PHP 的关于[类型杂耍和强制转换](http://us3.php.net/manual/en/language.types.type-juggling.php)的文档。

此示例将打印“ `$user is a object (User)`”四次。

```
foreach($alUser as $user) {
    echo '$user is a ' . get_type($user);

    if(is_object($user)) {
        echo ' (' . get_class($user) . ')';

    echo "\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-02T19:08:27.633

例如 Eclipse PDT 确定代码完成对象的类型会很好。否则你会陷入回溯，数组的创建位置以及放入其中的对象，然后查看类文件以查看可用的函数（或临时创建一个新的 theObject() 以查看可用的方法/属性，如果你知道它是什么类型的对象。如果许多对象调用在其中创建这些数组和对象的函数，其他时候可能就不那么容易了，因此必须回溯以查看这些数组是如何生成的）。听说其他一些 IDE 可能能够像 phpEd 那样更好地确定类型？

# .net - 是否有支持 ESE 的 ORM？

> ID：543456
> 
> 赞同：3
> 
> 时间：2009-02-12T21:43:49.563
> 
> 标签：.net, orm, extensible-storage-engine

好吧，[我开始](https://github.com/SamSaffron/simplestorageengine/tree/master)基于[ESE 互操作](http://www.codeplex.com/ManagedEsent)项目为[ESE](http://msdn.microsoft.com/en-us/library/ms684493(VS.85).aspx)编写托管 ORM 。

我想知道是否有人知道其他支持 ESE 的 ORM？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-27T00:46:12.260

[好吧，我做到了:-)](http://const.me/source-code/esent-serialization/)

# php - PHP vs ASP.net 的使用

> ID：543458
> 
> 赞同：2
> 
> 时间：2009-02-12T21:43:55.850
> 
> 标签：php, asp.net

有多少人喜欢 PHP 而不是 ASP.net 是因为它的开源性质？

我发现有更多基于 PHP 的开源项目（因此代码更可重用），因为喜欢分享的人都被这种语言所吸引。我知道一些开源 ASP.net 项目，但它们并不成熟或活跃。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-12T21:53:20.973

我做了三年的 ASP.NET 开发。一年多前，我开始了 PHP 开发。两者都足以完成您面前的任何 Web 应用程序任务。在这个时间点上，我更喜欢 PHP……不是因为它的*开源*性质，而是因为我认为它们演变的主要区别。

PHP 是针对特定问题的解决方案；一开始，Rasmus Lerdorf 需要一种方法来维护他的主页。在我看来，PHP 在很大程度上是由于人们需要特定功能而发展起来的。

另一方面，ASP.NET 被设计为 ASP 的继承者。因为 .NET 在当时是微软未来愿景的基石，所以两人结为夫妻。每个版本的 ASP.NET 中包含的功能都基于 Redmond 的一个团队，该团队在考虑营销策略的同时优先考虑消费者的请求。

因此，虽然我认为 ASP.NET 是一种设计更加一致的产品，但它并不需要提供 PHP 所提供的广泛选项。一是必然的结果，二是企业规划的结果。

我喜欢两者，并计划在未来与两者一起发展。现在，我的选择是 PHP，但不一定是因为它的*开源*性质，而仅仅是它的性质。如果明天关闭源，我会继续使用 PHP。我并不是要对语义争论不休，我只是认为在这种情况下，访问 PHP 的源代码（或缺少源代码）与我对它的偏好与 ASP.NET 的偏好无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T21:54:47.960

我更喜欢 PHP，部分原因是为了开源项目和社区，但也因为我发现 *nix 环境更美味。

每个功能的一部分是它的生态系统，所以语言选择的一个主要组成部分是你是想住在 *nix 领域还是 windows 领域。

两个完全不同的世界，我更喜欢 *nix 一个。

当然，我只说 *nix 上的 PHP，因为我看到 Windows 上的 PHP 有点像小鱼缸里的鱼，而不是海洋。如果您想使用 Windows，请使用 asp.NET，而不是 php。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T21:53:11.600

我更喜欢 PHP 仅仅是因为易于设置和使用。像[xampp](http://www.apachefriends.org/en/xampp.html)这样的工具让我可以在几分钟内将一台随机机器变成一个开发平台和 Web 服务器，而且是免费的，而且配置相对轻松。

# design-patterns - 您使用什么标准来确定是否实施软件工厂？

> ID：543464
> 
> 赞同：-1
> 
> 时间：2009-02-12T21:45:15.567
> 
> 标签：design-patterns, code-generation, organization

前几天我正在与一位同事讨论为您的开发组织实施软件工厂与使用更多像活动记录这样的脚手架解决方案的相似之处。我们都认为，当您拥有更多的开发人员并且您希望在代码库中保持一定程度的一致性和约定时，实施软件工厂可能被某些人认为是一个好主意。

再想一想，我意识到我真的很喜欢供个人使用的软件工厂的想法，因为它们让我更容易编写我正在从事的有趣的项目，因为它们让我在写作时省去了很多麻烦“样板”代码。话虽如此，我敢打赌，在更大的组织中强制使用软件工厂可能会在团队内部引起一些冲突，因为一些开发人员可能认为这会损害他们的创造力？

所以我想知道（来自那些已经实施工厂的组织的成员）是什么***标准***来决定组织内工厂的使用，当风险可能是一群不开心的开发人员时?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T00:34:21.180

我建议这取决于你的工厂生产什么。肯定有许多“陈词滥调”代码的示例，其生产可以自动化，从而使开发团队可以将他们的创造力集中在真正需要人类智能的代码部分。

用回调或其他扩展点组织构建的工件也很重要（并且完全有可能！）；同样，关键是要确保开发人员能够看到您的工作正在*支持*他们，而不是*取代*他们。

上述情况意味着您（和您的团队）将*被迫*做更多的前期计划，以最大限度地减少摩擦和“哦，我们忘记了，我们也需要......”事件的协调。这可能会产生一些抱怨。然而，如果你做得对，你会在某个时候站出来，通过调整工厂来处理一些外部需求，而不会中断他们自己的工作。到那时，他们中的更多人应该开始将您视为盟友。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T23:59:17.367

本着 SO 的精神，恕我直言，与一个好的框架（Spring、Windsor、Active Record）相比，没有任何组织能够从软件工厂中获得更多收益。

软件工厂只对那些建造工厂的人来说是有趣的，工厂的比喻非常贴切。在 SF 环境中，编码可能会变得重复和无聊，您实际上是在告诉您的团队，顺便说一句，您实际上太愚蠢了，无法弄清楚这一点，因此我们将确保您不会犯任何错误。我知道这听起来很刺耳，但这就是结果（是的，当我们尝试它时，我处于等式的有趣方面）。可以通过各种方式鼓励（我讨厌强制执行）一致性和约定，代码审查是最好的，但很难做到，代码分析（FxCop 等人）是最差的，但它们确实涵盖了基础知识。

SF 方法的另一个问题是，当工厂不能满足特定需求时，编码人员就会丢失，他们与底层技术隔离到如此程度，以至于他们没有关于正在发生的事情的概念模型。这就像要求生产线无人机制造引擎，他们不知道从哪里开始。另一方面，一个体面的机械师会知道该做什么（或去哪里）。你应该用优秀的工具来授权你的团队，而不是用不必要的工厂方法来限制他们。

# python - Eclipse中不同项目使用不同版本的python

> ID：543466
> 
> 赞同：15
> 
> 时间：2009-02-12T21:45:27.530
> 
> 标签：python, eclipse

所以，我正在慢慢地在一些 Python 3.0 中工作，但我仍然有很多依赖 2.5 的东西。

但是，在 Eclipse 中，每次我在 3.0 和 2.5 之间更改项目时，我都需要通过

项目 -> 属性 -> 项目类型。

**问题 1：**如果我只是在下拉框中切换解释器，那似乎并没有改变任何东西。我需要单击“单击此处配置未列出的解释器”，然后将我希望使用的解释器**UP 。**

**问题 2：**如果我在余生中为每个项目切换到 3.0，那会很好，但我仍然在项目之间进行大量切换，我认为这种情况不会很快发生变化。所以，我只是想节省一些操作。

有没有办法配置 Eclipse 以便它记住我想要与哪个项目关联的解释器？

如果我创建了一个全新的工作区怎么办？“解释器”是工作区的属性吗？

此外，当我通过 File -> New -> Pydev Project 创建新项目时，我选择什么似乎并不重要。我最后通过“属性”选择的东西就是 eclipse 使用的东西。

这是 Eclipse 3.4.0，在 Windows XP 中运行。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-13T13:16:16.140

您可以通过 Run Configurations 菜单为每个脚本设置解释器版本。

为此，请转到 Run -> Run Configurations，然后在 Python Run 下创建一个新条目。填写您的项目名称和主脚本，然后转到 Interpeter 选项卡，您可以选择要用于该脚本的解释器。

I've used this to have Python 2.2, 2.5, and 3.0 projects in the same workspace.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T12:14:14.027

好的 -

看起来“解释器”绝对是您的“工作区”的属性。我并没有真正考虑太多，因为我一直认为工作空间是“我保存任何东西的文件夹”，而不是用于一种开发的一致统一环境。

此外，您不能在一个 Eclipse 实例中的工作区之间切换（它会关闭并重新启动），但是您可以一次运行两个 Eclipse 实例，每个工作区一个。

现在，我想我喜欢 Eclipse 以这种方式处理它的事实。它有一种更“模块化”的感觉，而最初困扰我的东西我现在认为它是明智的。我不需要担心有两个口译员可供选择，或者选择默认或向上移动一个。我只需要担心我在哪个工作区。

希望这可以帮助某人。. .

*编辑：正如**Kiv**所指出的，“解释器”不是您的“工作区”的属性（如上所述）。相反，对于任何项目，都有一个“运行配置”（顺便说一句，还有一个调试配置）。运行配置允许用户设置可执行文件、路径和许多其他选项。*

*我确信这些事情对于长期用户来说是知道的，但是在我更改 python 版本之前我从来没有处理过这个问题。**

# content-management-system - 有没有好的 Google 协作平台竞争对手？

> ID：543473
> 
> 赞同：3
> 
> 时间：2009-02-12T21:46:05.767
> 
> 标签：content-management-system, service, intranet

我们的一个客户是一个会员组织，他们正在寻找与 Google 协作平台功能紧密结合的功能。

他们想要一个系统，其中他们的成员可以拥有自己的内容管理站点，一个或多个管理员可以通过提交一个简单的表单来创建该站点。

然后成员组织可以添加/删除页面、添加/编辑/删除内容、添加他们自己的用户、修改他们的配色方案和布局。

他们希望能够拥有像“member_org_url_to_be_named/member_name”这样的 url 结构 - 但它也可以是子域（即“member_name.member_org_url_to_be_named”）。

因此，他们需要一个安全层次结构才能拥有不同级别的用户：

管理员 - 可以添加/编辑/删除站点、用户等。

会员管理员 - 可以在其站点内添加/编辑内容，添加也能够在其站点内添加/编辑内容的用户。

会员用户 - 可以在他们的网站内添加/编辑内容。

根据我所见所闻，Google 协作平台似乎能够处理此功能。但是，要与能够明确告诉我这一点的人取得联系有点困难。所以我想知道是否有任何其他平台可以处理这个工作流程。

显然，我很想听听任何以前实施过这样的系统的人的意见。我也很想听听任何实际使用过 Google 协作平台的人的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T21:49:14.353

（免责声明：我为 Google 工作。不过，我对 Google 协作平台了解不多。）

您是否真的*尝试过*为此使用 Google 协作平台？让我感到震惊的是，它不应该花很长时间来试一试。如果您有任何与 Google 协作平台相关的问题，[Google 协作平台帮助中心](http://www.google.com/support/sites/)和[用户论坛](http://www.google.com/support/forum/p/sites?hl=en)可能是不错的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T18:24:07.430

这听起来像是带有角色的内容管理。Drupal 非常适合这个目的。

[http://drupal.org/](http://drupal.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T22:07:04.263

我用过一点点 Google 协作平台（免费的“标准版”），很容易设置 + 很容易通过 nearfreespeech.net 重新配置我的 DNS 记录，以便将 CNAME 和 MX 记录设置到我拥有的域中。

邮件列表的东西很好用。网站编辑对任何人来说都非常容易使用，但有点笨拙，有点笨拙，并且似乎与通过 FTP/SFTP/等上传/下载的概念“玩得很好”。我不喜欢我小组的用户一直花时间开发网站的想法，如果我遇到问题，我无法备份或转移给 Google 以外的其他人。

我不知道这些问题是否在 Google 协作平台的付费版本中得到解决。目前，我肯定会继续使用电子邮件邮件列表功能，但会在其他地方寻找类似的效果更好的东西。

（如果你发现了什么，请发布！）

# php - 你如何编写和测试你的正则表达式？

> ID：543475
> 
> 赞同：2
> 
> 时间：2009-02-12T21:46:12.053
> 
> 标签：php, regex, testing, wizard

他们是否有任何向导或工具来为 PHP 创建和测试正则表达式，因为这太难了:(？谢谢 :)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-12T21:47:25.513

[RegexBuddy](http://www.regexbuddy.com/)是为此目的而广受欢迎的应用程序。它还需要 40 美元，并且只能在 Windows 上运行。

有关强大的免费替代品，请参阅[此答案](https://stackoverflow.com/a/32290/1269037)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T21:47:44.810

[reAnimator](http://osteele.com/tools/reanimator/)是一个很好的工具，可以将你的正则表达式可视化为状态机——我发现它有时很有用。

Python 还允许您[查看正则表达式解析树](https://stackoverflow.com/questions/101268/hidden-features-of-python/143636#143636)，如果您学会阅读它，这将很有帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-12T21:51:37.297

使用示例数据进行单元测试。创建两个数组，一个包含匹配数据，一个包含不匹配数据（如有必要）以测试边缘情况。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-12T21:49:40.827

有强大的[在线工具](https://stackoverflow.com/a/32290/1269037)。离线，

*   [Regex Coach](http://weitz.de/regex-coach/)是一个很棒的免费离线正则表达式工具，我经常使用它。
*   我也喜欢[RegEx Buddy](http://www.regexbuddy.com/)，但它要 40 美元而且我很便宜。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-07-13T21:24:14.097

试用和~~错误~~成功。

因为我花时间实际学习它，而不是依靠其他东西来为我做。

这同样适用于任何语言/工具——花一点时间来学习语法和一般精神，你会*比*依赖智能感知、代码提示等更有效率。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-13T05:18:19.313

[Expresso](http://www.ultrapico.com/Expresso.htm)是免费的 Windows 程序，对正在分析的正则表达式进行了很好的分解和解释。

对于可以立即从浏览器运行的在线工具，请参阅[此答案](https://stackoverflow.com/a/32290/1269037)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-12T21:53:48.853

我总是用这个： http: [//gskinner.com/RegExr/](http://gskinner.com/RegExr/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-26T05:21:55.093

Regex Buddy 太过分了（40 美元），只能在 Windows 上运行。早在 2009 年，这也许是一个不错的选择。

现在我们拥有免费的强大在线工具来构建和测试正则表达式。[Regex101](http://regex101.com/)就是其中之一：

*   让您选择 RE 引擎（PCRE、JavaScript、Python）
*   为比赛着色
*   即时解释正则表达式
*   有一个调试器
*   可以创建到正则表达式操场的永久链接。

[我的其他答案](https://stackoverflow.com/a/32290/1269037)中有更多正则表达式测试工具。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-12T22:14:27.977

我真的很喜欢[RegexPal](http://regexpal.com/)，它简单、清晰、无需安装且可在线免费获得。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-13T01:21:34.047

在线...有一个带有 js/pcre/posix 实现的 ajax 正则表达式检查器，可以在您键入时进行检查.. 很酷。

[http://www.rexv.org](http://www.rexv.org)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-12T21:49:36.460

反复试验。

和`print_r`。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-07-15T09:36:52.667

由于您在谈论 PHP，您可能对[Codebench](http://www.geertdedeckere.be/article/introducing-codebench)感兴趣。它是一个工具，不是专门用来分解正则表达式（你已经列出了很多），而是对它们进行基准测试。由于它相当通用，因此您还可以比较非正则表达式解决方案，因为本机字符串函数通常更快。此外，它还允许您针对多个主题（目标）进行基准测试。希望你觉得它有用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-12T23:01:14.697

这是另一个用于 Java 的在线正则表达式测试器：

[http://www.fileformat.info/tool/regex.htm](http://www.fileformat.info/tool/regex.htm)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-02-26T05:36:09.797

对于在线测试 Regx [http://www.regexr.com/](http://www.regexr.com/)使用此站点，如果您的 regx 在此工作，那么您可以使用 preg_match() 函数在 writecodeonline.com 上检查它的 php。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-11-29T17:12:52.450

我正在使用单元测试。这样，我可以逐步增加我的正则表达式，确保我测试的第一个案例仍然通过。如果我必须修改它，我有我所有的测试来支持我。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-12T21:48:24.217

在测试正则表达式时，我通常使用[Rubular 。](http://rubular.com)您也可以试试[txt2re.com](http://txt2re.com/)，它可以很方便地帮助您找出表达式，甚至可以生成相关的 PHP 代码。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-07-13T20:56:14.777

我曾经使用过正则表达式教练。但是因为它是基于 Perl 的，而且我大部分时间都在测试 .NET 正则表达式，所以我现在使用这个[在线 .NET 正则表达式测试器](http://regexhero.net/)。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-07-13T21:26:11.770

我喜欢 emacs 重建器。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-07-13T21:28:55.180

我编写了自己的工具：[Regular Expression Tester](http://chris.photobooks.com/regex/default.htm)。与许多其他基于 Web 的工具不同，这个工具可以将正则表达式分解为标记并描述每个标记的作用。它非常适合检查新的表达方式，或者你很久以前写的但不太记得的表达方式。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-03-02T23:07:51.257

我写了一个python库来完成这个，它在[cloudtb.re下](https://github.com/cloudformdesign/cloudtb/blob/master/cloudtb/re.py)

```
text = 'so foo is the opposite of bar but without foo there is no bar?'
exp = '(foo).*?(bar)'
searched = cre.research(exp, text)
print(searched) 
```

![打印正则表达式](https://i.stack.imgur.com/ksQUu.png)

# interface - Groovy：为接口委托元类？

> ID：543479
> 
> 赞同：5
> 
> 时间：2009-02-12T21:46:34.423
> 
> 标签：interface, groovy, metaprogramming, metaclass

使用 Groovy 的包名称约定，我可以像这样拦截对 Java 方法的 Groovy 方法调用：

```
package groovy.runtime.metaclass.org.myGang.myPackage

class FooMetaClass extends groovy.lang.DelegatingMetaClass
{
    FooMetaClass(MetaClass delegate)
    {
        super(delegate);
    }

    public Object getProperty(Object a, String key)
    {
        return a.someMethod(key)
    }
} 
```

如果我真的创建了一个 Foo 类的对象，这很好用：

```
def myFoo = new Foo()
def fooProperty = myFoo.bar // metaclass invokes myFoo.someMethod("bar") 
```

但是，如果 Foo 是一个接口，并且我想拦截对它的任何实现的方法调用怎么办？

```
def myFoo = FooFactory.create()   // I don't know what class this will be
fooProperty = myFoo.bar 
```

有没有办法实现这一点，而无需为接口的每个已知实现使用 DelegatingMetaClass？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T21:42:25.807

您可以创建一个名为“groovy.runtime.metaclass.CustomMetaClassCreationHandle”的类来全局处理元类创建过程。

在这个类中，你可以重写这个方法：

```
protected MetaClass createNormalMetaClass(Class theClass, MetaClassRegistry registry) {
  // if theClass instanceof Foo, return your special metaclass
  // else return super.createNormalMetaClass(theClass, registry)
} 
```

# c# - LINQ Select Distinct with Anonymous Types

> ID：543482
> 
> 赞同：159
> 
> 时间：2009-02-12T21:46:57.497
> 
> 标签：c#, linq, distinct, anonymous-types, equality

所以我有一个对象集合。确切的类型并不重要。从中我想提取一对特定属性的所有唯一对，因此：

```
myObjectCollection.Select(item=>new
                                {
                                     Alpha = item.propOne,
                                     Bravo = item.propTwo
                                }
                 ).Distinct(); 
```

所以我的问题是：在这种情况下 Distinct 会使用默认对象 equals （这对我来说没用，因为每个对象都是新的）还是可以告诉它做不同的 equals （在这种情况下，Alpha 和 Bravo 的值相等=> 相等的实例）？如果不这样做，有什么方法可以达到这个结果？

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2009-02-12T21:59:11.240

阅读 K. Scott Allen 的精彩文章：

[人人平等……匿名类型](http://odetocode.com/Blogs/scott/archive/2008/03/25/11916.aspx)

简短的回答（我引用）：

> 原来 C# 编译器覆盖了匿名类型的 Equals 和 GetHashCode。这两个重写方法的实现使用类型上的所有公共属性来计算对象的哈希码并测试是否相等。如果相同匿名类型的两个对象的属性值都相同——对象是相等的。

因此，在返回匿名类型的查询上使用 Distinct() 方法是完全安全的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-27T00:45:41.590

```
public class DelegateComparer<T> : IEqualityComparer<T>
{
    private Func<T, T, bool> _equals;
    private Func<T, int> _hashCode;
    public DelegateComparer(Func<T, T, bool> equals, Func<T, int> hashCode)
    {
        _equals= equals;
        _hashCode = hashCode;
    }
    public bool Equals(T x, T y)
    {
        return _equals(x, y);
    }

    public int GetHashCode(T obj)
    {
        if(_hashCode!=null)
            return _hashCode(obj);
        return obj.GetHashCode();
    }       
}

public static class Extensions
{
    public static IEnumerable<T> Distinct<T>(this IEnumerable<T> items, 
        Func<T, T, bool> equals, Func<T,int> hashCode)
    {
        return items.Distinct(new DelegateComparer<T>(equals, hashCode));    
    }
    public static IEnumerable<T> Distinct<T>(this IEnumerable<T> items,
        Func<T, T, bool> equals)
    {
        return items.Distinct(new DelegateComparer<T>(equals,null));
    }
}

var uniqueItems=students.Select(s=> new {FirstName=s.FirstName, LastName=s.LastName})
            .Distinct((a,b) => a.FirstName==b.FirstName, c => c.FirstName.GetHashCode()).ToList(); 
```

很抱歉之前的格式混乱

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-10-26T20:58:11.043

有趣的是它在 C# 中有效，但在 VB 中无效

返回 26 个字母：

```
var MyBet = "aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ";
MyBet.ToCharArray()
.Select(x => new {lower = x.ToString().ToLower(), upper = x.ToString().ToUpper()})
.Distinct()
.Dump(); 
```

返回 52...

```
Dim MyBet = "aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ"
MyBet.ToCharArray() _
.Select(Function(x) New With {.lower = x.ToString.ToLower(), .upper = x.ToString.ToUpper()}) _
.Distinct() _
.Dump() 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-12T22:07:45.200

我跑了一个小测试，发现如果属性是值类型，它似乎工作正常。如果它们不是值类型，则该类型需要提供它自己的 Equals 和 GetHashCode 实现才能使其工作。我认为字符串会起作用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T00:35:19.587

您可以创建自己的采用 lambda 表达式的 Distinct Extension 方法。这是一个例子

创建一个派生自 IEqualityComparer 接口的类

```
public class DelegateComparer<T> : IEqualityComparer<T>
{
    private Func<T, T, bool> _equals;
    private Func<T, int> _hashCode;
    public DelegateComparer(Func<T, T, bool> equals, Func<T, int> hashCode)
    {
        _equals= equals;
        _hashCode = hashCode;
    }
    public bool Equals(T x, T y)
    {
        return _equals(x, y);
    }

    public int GetHashCode(T obj)
    {
        if(_hashCode!=null)
            return _hashCode(obj);
        return obj.GetHashCode();
    }       
} 
```

然后创建您的独特扩展方法

```
public static class Extensions
{
    public static IEnumerable<T> Distinct<T>(this IEnumerable<T> items, 
        Func<T, T, bool> equals, Func<T,int> hashCode)
    {
        return items.Distinct(new DelegateComparer<T>(equals, hashCode));    
    }
    public static IEnumerable<T> Distinct<T>(this IEnumerable<T> items,
        Func<T, T, bool> equals)
    {
        return items.Distinct(new DelegateComparer<T>(equals,null));
    }
} 
```

你可以使用这个方法找到不同的项目

```
var uniqueItems=students.Select(s=> new {FirstName=s.FirstName, LastName=s.LastName})
            .Distinct((a,b) => a.FirstName==b.FirstName, c => c.FirstName.GetHashCode()).ToList(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T22:00:16.013

如果`Alpha`和`Bravo`都继承自一个公共类，您将能够通过实现来指示父类中的相等性检查`IEquatable<T>`。

例如：

```
public class CommonClass : IEquatable<CommonClass>
{
    // needed for Distinct()
    public override int GetHashCode() 
    {
        return base.GetHashCode();
    }

    public bool Equals(CommonClass other)
    {
        if (other == null) return false;
        return [equality test];
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-16T14:51:48.703

嘿，我遇到了同样的问题，我找到了解决方案。您必须实现 IEquatable 接口或简单地覆盖 (Equals & GetHashCode) 方法。但这不是技巧，GetHashCode 方法中的技巧。你不应该返回你的类对象的哈希码，但你应该返回你想要比较的属性的哈希值。

```
public override bool Equals(object obj)
    {
        Person p = obj as Person;
        if ( obj == null )
            return false;
        if ( object.ReferenceEquals( p , this ) )
            return true;
        if ( p.Age == this.Age && p.Name == this.Name && p.IsEgyptian == this.IsEgyptian )
            return true;
        return false;
        //return base.Equals( obj );
    }
    public override int GetHashCode()
    {
        return Name.GetHashCode();
    } 
```

如您所见，我有一个名为 person 的类，有 3 个属性（Name、Age、IsEgyptian“因为我是”） 在 GetHashCode 中，我返回了 Name 属性的哈希值，而不是 Person 对象。

试试看，它会在 ISA 上运行。谢谢你，莫达瑟·萨迪克

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-07-13T20:24:30.960

为了让它在 VB.NET 中工作，你需要`Key`在匿名类型的每个属性之前指定关键字，就像这样：

```
myObjectCollection.Select(Function(item) New With
{
    Key .Alpha = item.propOne,
    Key .Bravo = item.propTwo
}).Distinct() 
```

我为此苦苦挣扎，我认为 VB.NET 不支持这种类型的功能，但实际上它确实支持。

# python - 在 ctypes 中带有指向其自身类型的指针的结构

> ID：543483
> 
> 赞同：4
> 
> 时间：2009-02-12T21:47:04.670
> 
> 标签：python, ctypes

我正在尝试使用 ctypes 映射结构定义：

```
struct attrl {
               struct attrl *next;
               char         *name;
               char         *resource;
               char         *value;
           }; 
```

我不确定如何处理 ctypes 映射中结构的“下一个”字段。像这样的定义：

```
class attrl(Structure):
    _fields_ = [
        ("next", attrl),
        ("name", c_char_p), 
        ("resource", c_char_p), 
        ("value", c_char_p)
    ] 
```

结果是：

```
NameError: name 'attrl' is not defined 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T21:54:01.643

您需要相当于前向声明，[如此处所述](http://python.net/crew/theller/ctypes/tutorial.html#incomplete-types)。

# sql-server - 批量修改 SQL Server 中的唯一 ID

> ID：543502
> 
> 赞同：0
> 
> 时间：2009-02-12T21:49:29.783
> 
> 标签：sql-server, database, scripting, identity

[这有点不寻常的问题，我知道……]

我需要的是一个脚本，它将每个唯一的 id 值更改为我们数据库中的新值。问题是我们有可以在我们的软件实例之间导出的配置表，这些配置表是 id 敏感的（破坏现有的 id）。多年前，我们在我们的开发“标准配置”和我们客户的实例之间建立了一个“足够宽”的 id 差距，现在这个差距*不够*大:( - 例如，当客户导入我们的标准配置时，我们会遇到 id 冲突。

执行以下操作的 sql 脚本绝对是我们可以做的最简单/最短时间范围的事情。例如，修复代码太复杂且容易出错。请注意，我们并没有“消除”这里的问题。只需将差距从 1000 变为 1000000 或更多（现有的差距需要 5 年才能填补）。

我相信最简单的解决方案是：

*   将我们所有的表更改为 UPDATE_CASCADE（它们都不是 - 这将大大简化脚本）
*   使用我们想要的新的最低 id 创建一个身份表
*   对于每个表，将 id 修改为标识表中的下一个（在必要时使用标识插入修饰符标志）。也许在处理完每个表之后，我们可以重置身份表。
*   关闭 UPDATE_CASCADE，并删除标识表。

有没有人有任何脚本（或部分脚本？）。我会投票赞成任何有用的东西:)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T23:46:03.357

不幸的是 UPDATE_CASCADE 在 Sql Server 的世界中不存在。我建议您为每个表重新键入您执行以下操作（伪代码）

```
BACKUP DATABASE
CHECK BACKUP WORKS!

FOR EACH TABLE TO BE RE-KEYED
   DROP ALL FOREIGN KEY CONSTRAINTS, INDEXES ETC FROM TABLE

   SELECT ID + Number, ALL_OTHER_FIELDS INTO TEMP_TABLE FROM TABLE
   RENAME TABLE OLD_TABLE
   RENAME TEMP_TABLE TABLE

   FOR ALL TABLES REFERENCING THIS TABLE
       UPDATE FOREIGN_KEY_TABLE SET FK_ID = FK_ID + new number
   END FOR

   RE-APPLY FOREIGN KEY CONSTRAINTS, INDEXES ETC FROM TABLE

END FOR 
```

检查一切仍然有效...

这个过程可以通过 DMO/SMO 对象自动化，但根据所涉及的表的数量，我会说使用 management studio 生成可以然后编辑的脚本可能会更快。毕竟，您只需要这样做一次/5 年。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T01:45:02.727

在这里，我们使用 SQL 2005 的代码。它很大，很hacky，但它*可以*工作（除非您有一个由其他两个主键组合而成的主键）。

如果有人可以使用 MrTelly 更快的 id 添加来重写它（这不需要为每个更新的行从游标构建 sql），那么我会将其标记为已接受的答案。（如果我没有注意到新答案，请对此表示赞同 - 然后我会注意到 :)）

```
BEGIN TRAN
SET NOCOUNT ON;

DECLARE @newLowId INT
SET @newLowId = 1000000

DECLARE @sql VARCHAR(4000)

--**** SELECT ALL TABLES WITH IDENTITY COLUMNS ****
DECLARE tables  SCROLL CURSOR
FOR 
SELECT '[' + SCHEMA_NAME(schema_id) + '].[' + t.name + ']', c.name
FROM sys.identity_columns c
INNER JOIN sys.objects t
    on c.object_id = t.object_id
WHERE t.type_Desc = 'USER_TABLE'

OPEN tables

DECLARE @Table VARCHAR(100)
DECLARE @IdColumn VARCHAR(100)

CREATE Table #IdTable(
  id INT IDENTITY(1,1),
  s CHAR(1)
)

FETCH FIRST FROM tables
INTO @Table, @IdColumn

WHILE @@FETCH_STATUS = 0
BEGIN
    PRINT('
****************** '+@Table+' ******************
')
    --Reset the idtable to the 'low' id mark - remove this line if you want all records to have distinct ids across the database
    DELETE FROM #IdTable
    DBCC CHECKIDENT('#IdTable', RESEED, @newLowId)

    --**** GENERATE COLUMN SQL (for inserts and deletes - updating identities is not allowed) ****
    DECLARE tableColumns CURSOR FOR
        SELECT column_name FROM information_schema.columns
        WHERE '[' + table_schema + '].[' + table_name + ']' = @Table
        AND column_name <> @IdColumn
    OPEN tableColumns
    DECLARE @columnName VARCHAR(100)
    DECLARE @columns VARCHAR(4000)
    SET @columns = ''
    FETCH NEXT FROM tableColumns INTO @columnName
    WHILE @@FETCH_STATUS = 0
    BEGIN
        SET @columns = @columns + @columnName
        FETCH NEXT FROM tableColumns INTO @columnName
        IF @@FETCH_STATUS = 0 SET @columns = @columns + ', '
    END

    CLOSE tableColumns
    DEALLOCATE tableColumns

    --**** GENERATE FOREIGN ROW UPDATE SQL ****
    DECLARE foreignkeys SCROLL CURSOR
    FOR 
    SELECT con.name, 
        '[' + SCHEMA_NAME(f.schema_id) + '].[' + f.name + ']' fTable, fc.column_name , 
        '[' + SCHEMA_NAME(p.schema_id) + '].[' + p.name + ']' pTable,  pc.column_name 
    FROM sys.foreign_keys con
    INNER JOIN sysforeignkeys syscon
        ON con.object_id = syscon.constid
    INNER JOIN sys.objects f
        ON con.parent_object_id = f.object_id
    INNER JOIN information_schema.columns fc
        ON fc.table_schema = SCHEMA_NAME(f.schema_id)
        AND fc.table_name = f.name
        AND fc.ordinal_position = syscon.fkey

    INNER JOIN sys.objects p
        ON con.referenced_object_id = p.object_id
    INNER JOIN information_schema.columns pc
        ON pc.table_schema = SCHEMA_NAME(p.schema_id)
        AND pc.table_name = p.name
        AND pc.ordinal_position = syscon.rkey
    WHERE '[' + SCHEMA_NAME(p.schema_id) + '].[' + p.name + ']' = @Table

    OPEN foreignkeys

    DECLARE @FKeyName VARCHAR(100)
    DECLARE @FTable VARCHAR(100)
    DECLARE @FColumn VARCHAR(100)
    DECLARE @PTable VARCHAR(100)
    DECLARE @PColumn VARCHAR(100)

    --**** RE-WRITE ALL IDS IN THE TABLE ****
    SET @sql='DECLARE tablerows CURSOR FOR
    SELECT CAST('+@IdColumn+' AS VARCHAR) FROM '+@Table+' ORDER BY '+@IdColumn
    PRINT(@sql)
    exec(@sql)

    OPEN tablerows
    DECLARE @rowid VARCHAR(100)
    DECLARE @id VARCHAR(100)

    FETCH NEXT FROM tablerows INTO @rowid
    WHILE @@FETCH_STATUS = 0
    BEGIN
        --generate new id
        INSERT INTO #IdTable VALUES ('')
        SELECT @id = CAST(@@IDENTITY AS VARCHAR)
        IF @rowId <> @Id
        BEGIN
            PRINT('Modifying '+@Table+': changing '+@rowId+' to '+@id)
            SET @sql='SET IDENTITY_INSERT ' + @Table + ' ON
    INSERT INTO '+@Table+' ('+@IdColumn+','+@columns+') SELECT '+@id+','+@columns+' FROM '+@Table+' WHERE '+@IdColumn+'='+@rowId

            --Updating all foreign rows...
            FETCH FIRST FROM foreignkeys
            INTO @FKeyName, @FTable, @FColumn, @PTable, @PColumn

            WHILE @@FETCH_STATUS = 0
            BEGIN
                SET @sql = @sql + '
    UPDATE '+@FTable+' SET '+@FColumn+'='+@id+' WHERE '+@FColumn+' ='+@rowId
                FETCH NEXT FROM foreignkeys
                INTO @FKeyName, @FTable, @FColumn, @PTable, @PColumn
            END
            SET @sql=@sql + '
    DELETE FROM '+@Table+' WHERE '+@IdColumn+'='+@rowId

            PRINT(@sql)
            exec(@sql)
        END
        FETCH NEXT FROM tablerows INTO @rowid
    END

    CLOSE tablerows
    DEALLOCATE tablerows
    CLOSE foreignkeys
    DEALLOCATE foreignkeys

    --Revert to normal identity operation - update the identity to the latest id...
    DBCC CHECKIDENT(@Table, RESEED, @@IDENTITY)
    SET @sql='SET IDENTITY_INSERT ' + @Table + ' OFF'
    PRINT(@sql)
    exec(@sql)

    FETCH NEXT FROM tables
    INTO @Table, @IdColumn
END

CLOSE tables
DEALLOCATE tables

DROP TABLE #IdTable
--COMMIT
--ROLLBACK 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-12T22:11:24.783

为什么不将负数用于标准配置值，而继续将正数用于其他事物？

# windows-installer - Msiexec REINSTALL=ALL REINSTALLMODE=vamus 不重新安装任何东西

> ID：543505
> 
> 赞同：2
> 
> 时间：2009-02-12T21:49:40.047
> 
> 标签：windows-installer

基本上我正在尝试升级我的应用程序，据我了解，以下内容应该无条件地重新安装所有组件： msiexec /i myapp.msi REINSTALL=ALL REINSTALLMODE=vamus

然而，在详细日志中，我看到：MSI (s) (A0:60) [15:40:10:948]: Component: A; 安装：本地；请求：空；行动：空

MSI (s) (A0:60) [15:40:10:948]：组件：B；安装：本地；请求：空；行动：空

MSI (s) (A0:60) [15:40:10:948]：组件：C；安装：本地；请求：空；行动：空

MSI (s) (A0:60) [15:40:10:948]：组件：D；安装：本地；请求：空；行动：空

等每个组件。如果我从目标文件夹中删除或重命名文件，它将正确安装新版本，但是如果该文件存在于该位置，它将忽略它，而不是用当前 msi 文件中的副本替换它。

有没有人对可能出现的问题有任何见解？

编辑：安装程序是在 WiX 中创建的。产品 ID 和 UpgradeCode 保持不变，而 PackageID 设置为 * 所以应该为每个构建生成一个新的，所以据我所知应该是正确的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T23:31:42.003

这有点棘手，我遇到了同样的问题。为了使更新安装工作，更新包必须包含原始包中的所有组件。这意味着您永远无法删除组件。您可以从组件中删除文件，甚至是所有文件，但不允许删除组件。否则，在进行补丁或次要更新时，更新安装实际上不会做任何事情。ComponentID 存储在 Windows 注册表中，Windows Installer 服务使用它们来检查系统上是否安装了组件。

如果您删除了组件怎么办？您可以尝试将它们添加回来，但它们具有相同的包 ID，这是困难的部分，甚至是不可能的部分。

如果它仍然不起作用，您必须选择新安装，并且必须自己弄清楚必须更新的内容。

或者，您可以进行重大更新，先卸载再安装。Windows 安装程序不关心这种方式的功能组件结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-16T13:40:53.477

Windows 安装程序将主动阻止将二进制文件降级到即使使用“绝对强制”也难以完成的程度，就像您使用 REINSTALLMODE=amus 所做的那样。这是微软防止 Windows 早期存在的“DLL 地狱”战略的一部分。在那些日子里，可以用旧版本覆盖系统 DLL 文件，从而破坏左右和任何地方的东西。Windows Installer 具有多层保护以防止二进制文件降级。

在您需要能够像您提到的那样降级文件的情况下，唯一真正有效的方法是使用重大升级。与卸载和重新安装相关产品相比，重大升级并不是真正的升级。这使您可以避免使 MSI 次要升级正常工作所涉及的许多复杂性。

即使在降级方面进行重大升级也存在复杂性。您必须在 InstallExecuteSequence 中尽早对现有产品的卸载进行排序，以便在 Windows Installer 在文件计算期间过多地分析系统之前从系统中删除旧产品。此操作将系统状态与 MSI 中的文件进行比较，并确定需要（重新）安装哪些文件。如果版本逻辑表明 MSI 中的文件是降级文件，则最终结果可能是磁盘上的文件被删除并且根本没有安装旧文件。可能需要使用自定义操作提前从磁盘中删除文件以使降级可靠，或者使用目标文件夹的绝对路径在不同版本之间不同的安装文件夹。这将愚弄微星“

%ProgramFiles%\我的公司\我的产品\1 %ProgramFiles%\我的公司\我的产品\1.1

我不喜欢这个“移动目标”安装文件夹——我认为这不是 MSI 文件应该安装的方式，但它可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T23:18:44.373

是否更新了版本号并配置了升级？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-27T13:31:54.097

我有同样的问题。

对我有用的是完全删除 REINSTALL=ALL REINSTALLMODE=vamus

我认为主要问题是重新安装模式下的 v 选项，根据下面链接上的文档，“不要使用 v 重新安装选项代码来首次安装应用程序或功能”，我正在安装一个新的我的产品版本在旧版本之上。

[https://msdn.microsoft.com/en-us/library/windows/desktop/aa371182(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/aa371182(v=vs.85).aspx)

# c++ - 在 C++ Boost 库中，为什么某些头文件上有“.ipp”扩展名

> ID：543507
> 
> 赞同：43
> 
> 时间：2009-02-12T21:49:42.777
> 
> 标签：c++, boost

在 C++ Boost 库中，为什么某些头文件上有“.ipp”扩展名？

看起来它们是同名“.hpp”文件中包含的头文件。

这种约定在 Boost 之外很常见吗？

拥有特殊文件类型的理由是什么？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-02-12T21:55:32.640

来自模板大师之一的[解释：](http://lists.boost.org/Archives/boost/2003/08/51197.php)

> 如果您想将模板源拆分为接口和实现（有很多很好的理由这样做，包括控制实例化），您不能很好地使用相同的名称（foo.hpp）两次，而 foo.cpp不适合任何一个。foo.ipp 清楚地将该文件描述为旨在包含在 foo.hpp 中的实现文件。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-12T21:51:59.933

我相信“ipp”代表“实施”文件。即，它们实际上包含代码（用于内联函数和模板），而不仅仅是声明（位于标头 --.H 或 .HPP -- 文件中）

# javascript - 在 IE8 中获取 div 的最后一个孩子？

> ID：543513
> 
> 赞同：19
> 
> 时间：2009-02-12T21:50:41.807
> 
> 标签：javascript, jquery, css, internet-explorer-8, css-selectors

除了 using 之外，还有其他方法可以获取 div 元素的最后一个子元素`div:last-child`，这至少在 IE8 中不起作用？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-12T21:54:36.103

在 jQuery 中很简单：

```
$("div :last-child") 
```

在纯 CSS 中它无法完成。

否则，您将无法在 Javascript 中遍历 DOM。

还要注意区别：

*   `"div :last-child"`: div 的每个最后一个孩子；和
*   `"div:last-child"`：每个 div**是**最后一个孩子。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-12T21:55:22.047

不幸的是，我不知道没有使用 :last-child 的方式在 CSS 中执行此操作，（如您所说）在 IE 中失败。

如果您在谈论 javascript，那么可以使用 Node.lastChild：

```
var div = document.getElementById("mydiv");
var lastChild = div.lastChild; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-13T04:46:48.827

使用 jQuery 查找合适的元素：`$("div:last-child").addClass("last-child");`

然后使用 CSS 来指定演示：`div .last-child { /* your rules */ }`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-12T21:54:21.847

您可以以编程方式分配“最后一个”类并选择该类或使用 javascript。您可能还可以通过使用一些 Microsoft 的 IE 仅 css 脚本的东西来试一试。但我对它们了解不多，也不认为这是一种选择。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-12-09T22:00:34.107

我使用纯 JavaScript 通过从目标元素的 lastChild 循环返回节点来执行此操作。如果您的 HTML 中有空格，则 lastChild 可能是文本节点，因此我们循环直到找到元素节点（节点类型 1）或直到我们用完节点（previousSibling 将返回 null）。

例如，要查找页面中的最后一个元素，我从 body 的 lastChild 循环返回：

```
var targetElement = document.getElementsByTagName("body")[0],
    lastChildElement = targetElement.lastChild;

while (lastChildElement && lastChildElement.nodeType !== 1) {
    lastChildElement = lastChildElement.previousSibling;
}

if (lastChildElement) {
    // Do something
} 
```

如果 body 中没有元素，lastChildElement 将作为 null 退出此循环。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-30T17:38:43.797

在某些情况下，您绝对不想使用 $("div:last-child") 开箱即用。需要注意的重要一点是，这不会满足调用后对 DOM 的更改 - 例如，如果添加新元素作为最后一个子元素，则您需要更新内容。这也不仅仅是重复先前调用的情况。您需要撤销对前一个最后一个孩子的初始调用。

如果您正在做任何模糊的动态，请注意这一点。CSS 伪类*绝对*是最好的解决方案，它只是在 IE 中严重缺乏支持。如果您的设计可以应对 IE 中缺少最后一个子节点的支持，并且您正在使用渐进式丰富，那么我强烈推荐 CSS 方法而不是 JS。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-04T00:30:44.407

**快进 >> 4 年后 (2013)**
现在可以使用 CSS v3 (CSS3) 并得到所有主要浏览器的支持（IE >= 版本 9）。
如果您使用**IE <= version 8**时光倒流，那么**jQuery version < 1.x**会帮您解决问题（正如其他答案所指出的那样）。
阅读更多[http://www.w3schools.com/cssref/sel_last-child.asp](http://www.w3schools.com/cssref/sel_last-child.asp)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-13T05:03:16.293

```
var divs = $("id").getElementsByTagName('div');
var lastChild = divs[divs.length-1]; 
```

# c++ - C ++中的结构与类

> ID：543515
> 
> 赞同：29
> 
> 时间：2009-02-12T21:51:16.923
> 
> 标签：c++, class

什么时候应该有人在 C++ 中使用结构而不是类，反之亦然？当管理某些信息的成熟类看起来有点过分但想要表明所包含的信息都是相关的时，我发现自己使用结构。我想知道有哪些好的指导方针可以判断一个比另一个更合适？

编辑：在阅读提交问题后显示的相关材料 Stack Overflow 时发现这些链接：

[什么时候应该在 C++ 中使用类和结构？](https://stackoverflow.com/questions/54585/when-should-you-use-a-class-vs-a-struct-in-c)
[C ++中的结构和类有什么区别？](https://stackoverflow.com/questions/92859/what-are-the-differences-between-struct-and-class-in-c)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-12T21:53:49.833

从技术上讲，两者之间的唯一区别是结构是公共的：默认情况下，类是私有的：

除此之外，没有技术差异。

struct vs class 然后成为语言的纯粹表达细微差别。

通常，您避免将复杂的方法放入结构中，并且大多数时候结构数据成员将保持公开。在一个类中，您要强制执行强封装。

struct = data 是公开的，具有非常简单的辅助方法

class = 强封装，只能通过方法修改/访问数据

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T21:53:59.710

我将结构用于不提供构造函数或运算符的简单类型容器。

其他一切的课程。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T21:56:44.290

当您只需要一个没有需要保留的逻辑不变量的“东西桶”时，请使用结构。将课程用于其他任何事情。

另请参阅[C++ 常见问题解答关于该主题的内容](https://isocpp.org/wiki/faq/classes-and-objects#struct-vs-class)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T21:53:16.780

**如果有方法，请使用类，如果没有，请使用结构。**

一个类应该隐藏它所有的内部结构，只暴露方法或属性。结构倾向于公开其所有内部结构并且没有访问器方法。

在只有一位代码访问某些（相关）数据的情况下，结构可能是完全合理的。如果需要多位代码修改数据，或者如果它有点复杂，那么一个类会是一个更好的选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T21:54:20.240

类和结构之间的区别在于结构是变量组，类表示对象。对象具有属性和方法，并且是层次结构的一部分。

如果您使用 C++ 来利用 OO 功能，最好使用更自然的类/对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T21:55:50.580

为了一致性，我总是使用类，即使只是容器。它纯粹是一种风格选择，因为两者之间的差异可以忽略不计。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T21:56:45.833

如果你需要控制对数据的*访问*，你应该使用类。如果您不关心谁在访问什么，以及他们在其中存储了什么，那么结构可能更合适。

此外，如果您需要对数据本身的完整性进行任何检查，则使用类更合适。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-12T21:54:40.753

查看现有问题：

[C++中的struct和class有什么区别](https://stackoverflow.com/questions/92859/what-are-the-differences-between-struct-and-class-in-c)

[什么时候应该在 C++ 中使用类和结构？](https://stackoverflow.com/questions/54585/when-should-you-use-a-class-vs-a-struct-in-c)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-12T21:54:59.067

就个人而言，当我只需要一个数据容器（无成员函数）时，我会使用结构。否则，我使用类。

如果我需要一个简单的仿函数，我唯一一次例外：例如

```
struct compare { bool operator() { ... } };
sort(v.begin(), v.end(), compare()); 
```

对`public:`标签的需求只会使代码变得不必要。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-12T21:55:26.243

C++ 中的结构是具有公共默认访问方法的类，因此从技术上讲，除了该默认方法之外没有区别，您可以等效地使用两者。

然而，有一些期望和自然趋势，部分原因是 C++ 中的结构来自 C。

我的方法：如果它有任何私有数据、构造函数/析构函数或任何复杂的成员函数（不仅仅是在 set/get 时进行转换等），请使用 class.

# c# - WPF设计问题

> ID：543527
> 
> 赞同：2
> 
> 时间：2009-02-12T21:52:59.790
> 
> 标签：c#, .net, wpf, layout

假设我正在开发一个聊天，首先你来到一个登录窗口，当你登录时我想使用同一个窗口但改变控制：P 如何设计这个最好的方法？

有什么好的方法来实现这个我应该使用什么根元素？

非常感谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T00:56:15.717

查看 Josh Smith 在 MSDN 杂志 ( [http://msdn.microsoft.com/en-us/magazine/dd419663.aspx](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx) ) 上的文章。他描述了一种有趣的方法，您在主窗口上有一个内容演示者，使用数据模板来切换窗口显示的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T21:58:18.217

如果您想在同一个窗口中执行所有这些操作，您可以使用一个 Grid 作为根元素并托管一个登录元素（可能是另一个用于布局的网格）和聊天窗口。这些元素将相互堆叠，具体取决于您声明它们的顺序。要最初隐藏聊天元素，请将其可见性设置为`Collapsed`

然后，您可以`Collapsed`在用户提交登录详细信息时将登录元素的 Visibility 设置为 ，并将聊天元素的 Visibility 设置为`Visible`。

我曾经做过类似的事情，对我来说效果很好。

希望有帮助。

**编辑**我在 Kaxaml 中将它组合在一起供您使用（并且因为我喜欢使用 XAML）：

```
<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
    <Border x:Name="_loginForm" BorderBrush="#888" BorderThickness="3" CornerRadius="5"
            HorizontalAlignment="Center" VerticalAlignment="Center" Padding="10" Visibility="Visible">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition/>
          <RowDefinition/>
          <RowDefinition/>
          <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="100"/>
          <ColumnDefinition Width="100"/>
        </Grid.ColumnDefinitions>
        <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Center" Height="30">Welcome to chat</TextBlock>
        <TextBlock Grid.Row="1" Grid.Column="0">User Name</TextBlock>
        <TextBox   Grid.Row="1" Grid.Column="1" x:Name="_userName" />
        <TextBlock Grid.Row="2" Grid.Column="0">Password</TextBlock>
        <TextBox   Grid.Row="2" Grid.Column="1" x:Name="_password"></TextBox>
        <Button    Grid.Row="3" Grid.Column="1">Log In</Button>
      </Grid>
    </Border>
    <DockPanel x:Name="_chatForm" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" LastChildFill="True" Visibility="Collapsed">
      <DockPanel DockPanel.Dock="Bottom" LastChildFill="True" Height="70">
        <Button DockPanel.Dock="Right" Width="70">_Send</Button>
        <TextBox x:Name="_input" HorizontalAlignment="Stretch">Hello world</TextBox>
      </DockPanel>
      <ListBox x:Name="_messageHistory" />
    </DockPanel>
  </Grid>
</Page> 
```

最初该元素`_loginForm`是可见的。您将为登录按钮的 Click 事件附加一个处理程序，该处理程序将隐藏它并显示它`_chatForm`。

这个例子展示了几个布局控件的使用——Grid、DockPanel 和 StackPanel。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T22:08:30.580

或者，您可以使用 StackPanel 进行布局。举个简单的例子，您的面板中可以有 2 个元素；自定义登录控件以及聊天“显示”控件。成功登录后，从您的堆栈中删除自定义登录控件，以便只有聊天可见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T23:30:54.313

这是WPF！动画它们进出视野......你现在可以做到这一点。Google Code 上有一个名为 Witty（用 WPF 编写的桌面 Twitter 客户端）的协作项目，他们做了一些非常酷的事情，您可能想从中借鉴。想一想，还有另一个 WPF Twitter 客户端 (blu) 可以执行您可能想要查看的类似动画。

在 Witty 中，“设置”对话框是一个普通窗口，但是当您在选项卡之间切换时，故事板会将您请求的窗口部分滑入视图中。我还没有在这个级别调试过应用程序，但我假设他们有一个水平的 StackPanel，其中填充了固定到对话框的高度和宽度的容器，并且他们用故事板将它们滑入和滑出。

看看这两个应用程序的想法。您可能想做类似的事情，但由于这是一个 WPF 应用程序，所以天空才是真正的极限。

[机智](http://code.google.com/p/wittytwitter/)

[蓝光](http://www.thirteen23.com/experiences/desktop/blu/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T09:14:13.287

这里已经有一些答案，如何在视图级别交换两个元素。这篇文章提供了一种从根本上创建具有可互换视图的模块化应用程序设计的方法。

您可以查看[Composite Application Library](http://www.codeplex.com/CompositeWPF)。它是一个小型库（由 Microsoft 开发），除其他外有助于使您的应用程序更加模块化。有了它，您可以定义 GUI 的区域，这些区域可以具有可互换的视图。

在您包含的 xaml 中导入 CAL 命名空间并使用 RegionManager 定义一个区域：

```
<Window ...
      xmlns:cal="http://www.codeplex.com/CompositeWPF"
 ...>
...
<ItemsControl cal:RegionManager.RegionName="MyRegion" />
... 
```

然后你可以在这个区域交换视图，最好是在一个*模块*中：

```
_regionManager.Regions["MyRegion"].Add(new LoginView()); 
```

...交换...

```
_regionManager.Regions["MyRegion"].Add(new ChatView()); 
```

当然，这只是您可以做什么的概述。为了实施此解决方案，您必须进一步了解 CAL。它有很好的文档和大量的例子可供学习。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T16:14:53.510

我认为更直观的解决方案是使用 Frame 控件作为窗口的基本控件 - 并使用 NavigateService 将 Frame 的源更改为不同的 Page 控件（可以在单独的程序集中或在同一个项目中定义作为不同的 XAML 文件）。

你的窗口：

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Frame Source="LogonPage.xaml" NavigationUIVisibility="Hidden" />

</Window> 
```

还有你单独的LogonPage：

```
<Page 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="Logon">

    <!-- Your content of the page goes here... -->
</Page> 
```

# c# - Silverlight DataGrid 样式

> ID：543532
> 
> 赞同：1
> 
> 时间：2009-02-12T21:53:34.470
> 
> 标签：c#, silverlight, coding-style

我有一个 DataGrid，它的 ItemsSource 绑定到一个不断变化的 Observable 集合。这个集合的内部是一个业务对象。根据业务对象属性的一些值，我希望能够在创建 ItemsSource 后修改 DataGrid 中显示的每个项目的文本颜色。

有没有人这样做过或遇到过类似的事情？提前致谢。

```
<DataTemplate x:Key="MyTemplate">
        <Grid x:Name="LayoutRoot">
            <TextBlock Text="{Binding MyText}" 
                       Foreground="{Binding MyStatus, Converter={StaticResource colorConverter}}" />
        </Grid>
    </DataTemplate> 
```

我添加了上面的代码并将 TemplateColumn 插入到网格中，如下所示：

```
<data:DataGridTemplateColumn Header="Testing"
                                                 CellTemplate="{StaticResource MyTemplate}"/> 
```

代码工作正常并提取正确的文本，但转换器永远不会触发，并且前景的绑定永远不会从它开始调用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T21:56:14.727

是的。数据绑定时使用[值转换器。](http://silverlight.net/forums/p/25575/89560.aspx)

```
<UserControl.Resources>
    <myconverters:BackColor x:Key="BackColor" />
</UserControl.Resources>

<Grid x:Name="LayoutRoot" Background="{Binding SomeValue, Converter={StaticResource BackColor}" >
</Grid> 
```

然后让您的转换器类实现 IValueConverter 并返回某种 Brush 对象。您通常不必实现 ConvertBack()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T22:13:05.857

添加到BC的答案：

您可以制作 DataGridTemplateColumn 并为列中的单元格指定数据模板。在数据模板中，您可以绑定文本颜色。

```
<swcd:DataGrid ... >
    <swcd:DataGrid.Columns>
        <swcd:DataGridTemplateColumn Header="MyColumn" CellTemplate="{StaticResource MyColumnDataGridCellTemplate}"/>
         ... 
```

在资源中：

```
<DataTemplate x:Key="MyColumnDataGridCellTemplate">
    <Grid>
         <TextBlock Text="{Binding someproperty}" Foreground="{Binding someotherproperty, Converter={StaticResource MyConverter}}"/>
          ... 
```

# javascript - 将 eval() 限制在一个狭窄的范围内

> ID：543533
> 
> 赞同：35
> 
> 时间：2009-02-12T21:53:40.380
> 
> 标签：javascript, eval

我有一个 javascript 文件，它读取另一个文件，该文件可能包含需要 eval()-ed 的 javascript 片段。脚本片段应该符合严格的 javascript 子集，它限制了它们可以做什么以及它们可以更改哪些变量，但我想知道是否有某种方法可以通过阻止 eval 看到全局范围内的变量来强制执行此操作. 类似于以下内容：

```
function safeEval( fragment )
{
    var localVariable = g_Variable;

    {
        // do magic scoping here so that the eval fragment can see localVariable
        // but not g_Variable or anything else outside function scope

        eval( fragment );
    }
} 
```

实际的代码不需要看起来像这样——我对任何和所有奇怪的闭包技巧都持开放态度，等等。但我确实想知道这是否*可能*。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-02-12T22:39:15.140

**简短的回答**：不。如果它在全球范围内，它对任何东西都可用。

**长答案**：如果您正在编写*真正*想要阅读或弄乱您的执行环境的`eval()`不受信任的代码，那么您就完蛋了。但是，如果您拥有并信任所有正在执行的代码，包括正在执行的代码，您可以通过覆盖执行上下文来伪造它：*`eval()`*

 *```
function maskedEval(scr)
{
    // set up an object to serve as the context for the code
    // being evaluated. 
    var mask = {};
    // mask global properties 
    for (p in this)
        mask[p] = undefined;

    // execute script in private context
    (new Function( "with(this) { " + scr + "}")).call(mask);
} 
```

再次，我必须强调：

> 这只会将**受信任**的代码从执行它的上下文中屏蔽掉。如果您不信任该代码，请不要使用`eval()`它（或将其传递给 new `Function()`，或以任何其他类似 的方式使用它`eval()`）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-04-09T13:01:10.223

Shog9♦ 的回答很棒。但是，如果您的代码只是一个表达式，则代码将被执行并且不会返回任何内容。对于表达式，使用

```
function evalInContext(context, js) {

  return eval('with(context) { ' + js + ' }');

} 
```

以下是如何使用它：

```
var obj = {key: true};

evalInContext(obj, 'key ? "YES" : "NO"'); 
```

它会返回`"YES"`。

如果不确定要执行的代码是表达式还是语句，可以将它们组合起来：

```
function evalInContext(context, js) {

  var value;

  try {
    // for expressions
    value = eval('with(context) { ' + js + ' }');
  } catch (e) {
    if (e instanceof SyntaxError) {
      try {
        // for statements
        value = (new Function('with(this) { ' + js + ' }')).call(context);
      } catch (e) {}
    }
  }

  return value;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-05-25T05:27:06.250

类似于`with`上面块方法中的动态函数包装脚本，这允许您将伪全局添加到要执行的代码中。您可以通过将特定事物添加到上下文中来“隐藏”它们。

```
function evalInContext(source, context) {
    source = '(function(' + Object.keys(context).join(', ') + ') {' + source + '})';

    var compiled = eval(source);

    return compiled.apply(context, values());

    // you likely don't need this - use underscore, jQuery, etc
    function values() {
        var result = [];
        for (var property in context)
            if (context.hasOwnProperty(property))
                result.push(context[property]);
        return result;
    }
} 
```

有关示例，请参见[http://jsfiddle.net/PRh8t/ 。](http://jsfiddle.net/PRh8t/)请注意，`Object.keys`并非所有浏览器都支持。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T21:56:51.217

你不能限制 eval 的范围

顺便说一句，看到[这个帖子](https://stackoverflow.com/questions/86513/why-is-using-javascript-eval-function-a-bad-idea)

在宏伟的计划中，可能有其他方法可以完成您想要完成的事情，但您不能以任何方式限制 eval 的范围。您也许可以在 javascript 中将某些变量隐藏为伪私有变量，但我认为这不是您想要的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-06-05T09:37:05.643

有一个名为 Google Caja 的项目。您可以使用 Caja “沙盒”第三方 javascript。[https://developers.google.com/caja/](https://developers.google.com/caja/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-08-11T20:44:16.037

这是一个想法。如果您使用静态分析器（例如，您可以使用[esprima](http://esprima.org/)构建的东西）来确定 eval'd 代码使用哪些外部变量，并为它们取别名。“外部代码”是指 eval'd 代码*使用*但未*声明*的变量。这是一个例子：

```
eval(safeEval(
     "var x = window.theX;"
    +"y = Math.random();"
    +"eval('window.z = 500;');")) 
```

其中 safeEval 返回使用阻止访问外部变量的上下文修改的 javascript 字符串：

```
";(function(y, Math, window) {"
  +"var x = window.theX;"
  +"y = Math.random();"
  +"eval(safeEval('window.z = 500;');"
"})();" 
```

你现在可以用这个做几件事：

*   您可以确保 eval'd 代码不能读取外部变量的值，也不能写入它们（通过`undefined`作为函数参数传递，或不传递参数）。或者，在不安全地访问变量的情况下，您可以简单地抛出异常。
*   您还确保由 eval 创建的变量不会影响周围的范围
*   您可以通过在闭包之外声明这些变量而不是函数参数来允许 eval 在周围范围内创建变量
*   *您可以通过复制*外部变量的值并将它们用作函数的参数来允许只读访问
*   您可以通过告诉 safeEval 不对这些特定名称起别名来允许对特定变量进行读写访问
*   您可以检测 eval 不修改特定变量的情况*，*并允许自动将其排除在别名之外（例如，在这种情况下，数学没有被修改）
*   您可以通过传入可能与周围上下文*不同的参数值来为 eval 提供运行的上下文*
*   您还可以通过从函数返回函数参数来捕获上下文更改，以便您可以在 eval 之外检查它们。

请注意，使用`eval`是一种特殊情况，因为就其性质而言，它实际上不能被包装在另一个函数中（这就是我们必须这样做的原因`eval(safeEval(...))`）。

当然，完成所有这些工作可能会减慢您的代码速度，但肯定有一些地方的命中无关紧要。希望这可以帮助某人。如果有人创建了概念证明，我很乐意在这里看到它的链接；)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-11-18T14:14:10.960

不要使用`eval`. 还有一个替代方案，`js.js`:[用 JS 编写的 JS 解释器](https://github.com/jterrace/js.js/)，这样您就可以在您设法设置的任何环境中运行 JS 程序。以下是项目页面中其 API 的示例：

```
var jsObjs = JSJS.Init();
var rval = JSJS.EvaluateScript(jsObjs.cx, jsObjs.glob, "1 + 1");
var d = JSJS.ValueToNumber(jsObjs.cx, rval);
window.alert(d); // 2
JSJS.End(jsObjs); 
```

如您所见，没什么可怕的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-02-07T00:49:02.803

不要执行你不信任的代码。全局变量将始终可访问。如果您确实信任该代码，则可以使用其范围内的特定变量执行它，如下所示：

```
(new Function("a", "b", "alert(a + b);"))(1, 2); 
```

这相当于：

```
(function (a, b) {
    alert(a + b);
})(1, 2); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-04-15T04:54:56.887

我偶然发现我可以使用 Proxy 来限制范围对象，将变量屏蔽到范围之外似乎要容易得多。我不确定这种方法是否有缺点，但到目前为止它对我来说效果很好。

```
function maskedEval(src,ctx={})
{
    ctx = new Proxy(ctx,{
        has:()=>true
    })
    // execute script in private context
    let func = (new Function( "with(this) { " + src + "}"));
    func.call(ctx);
} 
```

```
a = 1;
maskedEval("console.log(a)",{console:console});
maskedEval("console.log(a)",{console:console,a:22});

maskedEval("a = 1",{a:22})
console.log(a) 
```

# python - 为什么 KeyboardInterrupt 在 python 中不起作用？

> ID：543534
> 
> 赞同：12
> 
> 时间：2009-02-12T21:53:42.207
> 
> 标签：python

为什么像下面这样的代码不能捕获 CTRL-C？

```
MAXVAL = 10000
STEP_INTERVAL = 10

for i in range(1, MAXVAL, STEP_INTERVAL):
    try:
        print str(i)
    except KeyboardInterrupt:
        break

print "done" 
```

我的期望是——如果在程序运行时按下 CTRL-C，`KeyboardInterrupt`应该退出循环。它不是。

对我做错了什么有帮助吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-12T22:04:34.567

听起来程序在按下 control-c 时已经完成，但是您的操作系统还没有完成向您显示所有输出。.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-12T23:01:11.560

代码流程如下：

1.  `for`从列表中获取新对象（由 生成`range`）并将其设置`i`为
2.  `try`
3.  `print`
4.  回到`1`

如果您在第 1 部分中按 CTRL-C 它在`try`/之外`except`，因此它不会捕获异常。

试试这个：

```
MaxVal = 10000
StepInterval = 10

try:
    for i in range(1, MaxVal, StepInterval):
        print i
except KeyboardInterrupt:
    pass

print "done" 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-02-22T14:10:10.273

我遇到了同样的问题，我刚刚发现了解决方案：

您正在像 PyCharm 这样的 IDE 中运行此代码。IDE 将 ctrl+c (keyboardinterrupt) 作为副本。尝试在终端中运行您的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T22:01:18.477

有用。

我使用的是 Ubuntu Linux，你呢？使用 MaxVal = 10000000 之类的东西再次测试它

# c - 如果您在单独的线程中关闭（2）文件描述符，select（2）会做什么？

> ID：543541
> 
> 赞同：27
> 
> 时间：2009-02-12T21:54:19.037
> 
> 标签：c, linux, multithreading, posix

`select(2)`当它正在监视读取的文件描述符被另一个线程关闭时，该函数的行为是什么？

通过一些粗略的测试，它确实会立即返回。我怀疑结果是（a）它仍然继续等待数据，但如果你真的试图从中读取，你会得到 EBADF（可能 - 存在潜在的竞争）或（b）它假装好像文件描述符从未传入。如果后一种情况为真，则传入一个没有超时的 fd 如果它被关闭将导致死锁。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-19T17:09:17.503

从一些额外的调查来看，dwc 和bothie 似乎都是正确的。

[Bothie 对这个问题的回答](https://stackoverflow.com/questions/543541/what-does-select2-do-if-you-close2-a-file-descriptor-in-a-separate-thread/546396#546396)归结为：这是未定义的行为。这并不意味着它必然是不可预测的，而是不同的操作系统做的不同。在这种情况下，像 Solaris 和 HP-UX 这样的系统似乎会返回`select(2)`，但 Linux 并没有基于2001 年[的 linux-kernel 邮件列表中的这篇文章](http://lkml.indiana.edu/hypermail/linux/kernel/0106.0/0768.html)。

linux-kernel 邮件列表上的论点本质上是依赖于未定义（和损坏）的行为。在 Linux 的情况下，调用`close(2)`文件描述符有效地减少了它的引用计数。由于还有`select(2)`一个引用它的调用，fd 将保持打开状态并等待输入，直到`select(2)`返回。这基本上是[dwc 的回答](https://stackoverflow.com/questions/543541/what-does-select2-do-if-you-close2-a-file-descriptor-in-a-separate-thread/543676#543676)。您将在文件描述符上收到一个事件，然后将其关闭。假设 fd 没有被回收，尝试从中读取将导致 EBADF。（MarkR 在[他的回答](https://stackoverflow.com/questions/543541/what-does-select2-do-if-you-close2-a-file-descriptor-in-a-separate-thread/543595#543595)中提出了一个问题，尽管我认为在大多数情况下通过适当的同步可能是可以避免的。）

所以谢谢大家的帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-12T21:59:52.660

我希望它的行为就像已经到达文件结尾一样，也就是说，它会返回显示为就绪的文件描述符，但随后任何读取它的尝试都会返回“错误的文件描述符”。

话虽如此，无论如何这样做都是非常糟糕的做法，因为您总是有潜在的竞争条件，因为*另一个*具有相同编号的文件描述符可能会在另一个线程关闭后立即被另一个线程打开，然后选择线程将结束起来等待错误的。

一旦你关闭一个文件，它的编号就可以重用，并且可能会被下一次调用 open()、socket() 等重用，即使是另一个线程。所以你真的，真的需要避免这种事情。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-13T15:40:17.400

select 系统调用是一种等待文件描述符改变状态而程序没有其他事情可做的方法。主要用于服务器应用程序，它打开一堆文件描述符，然后等待对它们执行任何操作（接受新连接、读取请求或发送响应）。这些文件描述符将以非阻塞 io 模式打开，以便服务器进程在任何时候都不会挂在系统调用中。

这另外意味着，不需要单独的线程，因为可以在线程中完成的所有工作也可以在 select 调用之前完成。如果工作需要很长时间，它可以被中断，选择被调用超时={0,0}，文件描述符得到处理，然后工作被恢复。

现在，您在另一个线程中关闭一个文件描述符。为什么你有那个额外的线程，为什么要关闭文件描述符？

POSIX 标准没有提供任何提示，在这种情况下会发生什么，所以你正在做的是未定义的行为。预计不同操作系统之间甚至同一操作系统版本之间的结果会有很大差异。

问候， 博多

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T22:13:07.917

你在问什么有点令人困惑......

Select() 应该在“有趣”的变化时返回。如果 close() 只是减少了引用计数并且文件仍然打开以便在某处写入，那么 select() 没有理由唤醒。

如果另一个线程在唯一打开的描述符上做了 close() ，那么它会变得更有趣，但我需要查看代码的简单版本，看看是否真的有问题。

# java - Java中具有精确布局的点阵快速打印

> ID：543549
> 
> 赞同：4
> 
> 时间：2009-02-12T21:54:49.630
> 
> 标签：java, printing, reporting, legacy, dot-matrix

我想知道在 Java 中为 EPSON Dot Matrix 打印机构建报告的实用方法。目前，我正在使用 LX300+II 型号。

我知道使用这台打印机基本上有两种方法：

1.  作为打字机，直接将原始 ASCII 数据输出到并口
2.  图形打印，带有图形字体和精确定位。

如何同时使用快速打印字体（由**1**提供）和精确定位（由**2**提供）？

我知道这是可能的，因为几年前，我必须为 EPSON FX 2180 制作报告，其中包括在 Windows 中安装的带有本机打印字体的驱动程序。这允许在这里做我想要的。

现在我正在使用 JasperReports 进行图形报告并且工作正常，但我确实有一些报告*需要*用点阵打印机*快速*打印。有什么可以替代的呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T21:59:54.983

TextPrinter 会[满足](http://java4less.com/textprinter/Documentation.html)您的需求吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T05:45:47.830

如果您想在点阵打印机中快速打印，您需要在“纯文本”模式下进行。以下代码适用于我：

```
try {
    // LPT1 is the printer port
    try (FileWriter out = new FileWriter("LPT1:")) {
        out.write("String1\nString2\nString3\n");
        out.flush();
    }
} catch (IOException e) {
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-20T07:31:03.267

//java用打印机点阵打印

```
String bill = "your text";

InputStream br = new ByteArrayInputStream(bill.getBytes());
BufferedReader in = new BufferedReader(new InputStreamReader(br));
String line;
//if you use windows
FileWriter out = new FileWriter("////IP Printer//printer name");
//if you use linux you can try SMB:(samba)
while((line = in.readLine()) != null)
{  
    System.out.println("line"+line);
    out.write(line);
    out.write(0x0D);  CR
    out.write('\n');
    writer.println(line);
}
out.close();
in.close();
writer.close(); 
```

//它对我有用...

# sql-server-2005 - 更改计算列引用的 SQL 函数

> ID：543561
> 
> 赞同：9
> 
> 时间：2009-02-12T21:55:48.270
> 
> 标签：sql-server-2005, calculated-columns, sql-function, non-deterministic

如果将表的列设置为计算列，其公式调用函数，则更改底层函数会变得很痛苦。每次更改时，您都必须找到其公式引用函数的每一列，删除引用，保存表，更改函数，添加所有内容，然后再次保存。即使是很小的变化也是噩梦。

你能告诉 SQL Server 你不关心公式是否引用了函数，而是继续更改底层函数吗？

附加详细信息：计算列不被 FK 约束持久化或引用，因为它是不确定的。该函数考虑了当前时间。它处理的是记录是否过期的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T22:12:42.207

不，据我所知，您不能这样做 - 您必须首先删除所有引用函数的计算列，更改函数，然后重新创建计算列。

也许 MS 会在 SQL Server 2010/2011 中给我们一个“CREATE OR ALTER FUNCTION”命令？:-)

马克

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-14T17:02:45.837

ALTER 的后果可能是巨大的。

您是否对列进行了索引？在带有模式绑定的视图中使用它？坚持了吗？与外键有关系吗？

如果 ALTER 更改了数据类型、可空性或确定性怎么办？

用依赖关系停止 ALTER FUNCTION 比处理这么多场景更容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-07T20:19:46.703

很抱歉这个迟到的答案，但它可能很有用。

您可以为每个将调用您的真实函数的计算列使用一个虚拟函数。

> 示例：
> 计算列使用公式： dbo.link_comp('123')
> 此函数转发参数并调用并返回函数 dbo.link('123') （您的真实函数）
> 两个函数只需要使用相同的参数并返回相同的类型。

然后，被锁定的函数是 dbo.link_comp，您仍然可以 ALTER dbo.link。
此外，如果您的函数是从其他 SQL 调用的，您仍然可以使用您的真实函数名称 dbo.link，虚拟函数 dbo.link_comp 仅用于计算列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-28T14:07:40.610

假设表 T1 包含 C1、C2、C3、C4、C5 列，其中 C4 是计算列

还假设您希望将其替换为 NewFunc 的 C4 引用函数 OldFunc

首先，将所有行中的非计算列移动到临时表

```
Select C1, C2, C3, C5 into TmpT1 from T1
Go 
```

接下来，从 T1 中删除所有行

```
Delete From T1
go 
```

现在您可以修改 C4 列

```
Alter table T1 alter column C4 as dbo.NewFunc()
Go 
```

现在将保存的数据放回原始表中

```
Insert Into T1 (C1,C2,C3,C5) select C1,C2,C3,C5 from TmpT1 
```

现在删除临时表

```
Drop Table TmpT1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-23T09:52:01.913

我知道聚会迟到了，但我今天遇到了同样的问题，没有找到任何真正解决问题的方法，所以我迅速编写了一个脚本。

本质上，它使用该函数创建一个临时表，其中包含每个计算列的列信息，从表中删除列。然后，您更新您的函数并让它使用它们的定义再次重新创建所有列。

如果您必须更改定义中的参数（就像我需要的那样），您可以简单地将该部分编写到再次创建定义的位置。

如果您在索引或其他需求中有计算列，则可以轻松扩展代码，但这超出了我的需求范围。

希望它对其他人有用。

```
/* Create temporary table to hold definitions */
CREATE TABLE [#FUNCTION]
(
    [TABLE_NAME] nvarchar(255) NOT NULL,
    [COLUMN_NAME] nvarchar(255) NOT NULL,
    [DEFINITION] nvarchar(255) NOT NULL
)
GO

/* Add data to temp table */
INSERT INTO [#FUNCTION] ( [TABLE_NAME], [COLUMN_NAME], [DEFINITION] )
SELECT TABLE_NAME, COLUMN_NAME, definition FROM INFORMATION_SCHEMA.COLUMNS
INNER JOIN sys.computed_columns ON ( object_id = object_id( TABLE_NAME ) AND name = COLUMN_NAME )
WHERE definition LIKE '%MyFunctionName%'
GO

/* Remove columns */
DECLARE @TABLE_NAME nvarchar(255)
DECLARE @COLUMN_NAME nvarchar(255)

DECLARE c_CursorName CURSOR LOCAL FOR SELECT [TABLE_NAME], [COLUMN_NAME] FROM [#FUNCTION]
OPEN c_CursorName

FETCH NEXT FROM c_CursorName INTO @TABLE_NAME, @COLUMN_NAME

WHILE @@FETCH_STATUS = 0
BEGIN
    EXEC( 'ALTER TABLE [' + @TABLE_NAME + '] DROP COLUMN [' + @COLUMN_NAME + ']' )

    FETCH NEXT FROM c_CursorName INTO @TABLE_NAME, @COLUMN_NAME
END

CLOSE c_CursorName
DEALLOCATE c_CursorName
GO

/* Update function */
-- Update function here
GO

/* Recreate computed columns */
DECLARE @TABLE_NAME nvarchar(255)
DECLARE @COLUMN_NAME nvarchar(255)
DECLARE @DEFINITION nvarchar(255)

DECLARE c_CursorName CURSOR LOCAL FOR SELECT [TABLE_NAME], [COLUMN_NAME], [DEFINITION] FROM [#FUNCTION]
OPEN c_CursorName

FETCH NEXT FROM c_CursorName INTO @TABLE_NAME, @COLUMN_NAME, @DEFINITION

WHILE @@FETCH_STATUS = 0
BEGIN
    EXEC( 'ALTER TABLE [' + @TABLE_NAME + '] ADD [' + @COLUMN_NAME + '] AS ' + @DEFINITION )

    FETCH NEXT FROM c_CursorName INTO @TABLE_NAME, @COLUMN_NAME, @DEFINITION
END

CLOSE c_CursorName
DEALLOCATE c_CursorName
GO

/* Remove temp table */
DROP TABLE [#FUNCTION]
GO 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T16:41:22.760

您可以尝试使用一些好的模式比较工具，为您创建脚本:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T07:23:33.267

~~您可以将列更改为不计算，并通过 TRIGGER 对其进行更新。~~

或者您可以将表重命名为其他名称，删除计算列，并创建一个视图来代替原始表（即使用原始表名）并包括您需要的“计算”列。

编辑：请注意，这可能会将您的 INSERT 插入到原始表名（现在是 VIEW）中。显然，您可以保留旧表，删除计算列，然后创建一个包含计算列的单独 VIEW。

我们必须在计算列上工作足够多次，才能确定它们带来的麻烦多于获得的收益。Fail-saf inserts(1)，试图将视图插入到具有计算列的表中，需要弄乱 SET ARITHABORT 等等。

(1) 我们有故障安全插件，例如：

插入 MyTable SELECT * FROM MyOtherTable WHERE ...

如果将新列添加到一个表而不是另一个表，则它们被设计为失败。使用计算列，我们必须明确命名所有列，这使我们失去了安全网。

# c++ - VC++ 中的 getopt()

> ID：543570
> 
> 赞同：11
> 
> 时间：2009-02-12T21:56:43.493
> 
> 标签：c++, windows, visual-studio-2008

**在Linux**下编程时，我非常喜欢使用 GNU [**getopt**](http://www.gnu.org/software/libtool/manual/libc/Getopt.html)。我了解，getopt() 在 MS VC++ 下不可用。

 ****笔记：**

*   Win32环境
*   使用 Visual Studio
*   没有[升压](http://www.boost.org/)
*   没有 MFC
*   不关心便携性

**问题：**

*   我怎样才能相应地移植 getopt() ？
    *   移植时我应该注意哪些准则？
*   **具有相同**功能的已知端口？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T22:02:36.413

这可能会有所帮助，它也很容易集成

[http://www.codeproject.com/KB/cpp/xgetopt.aspx](http://www.codeproject.com/KB/cpp/xgetopt.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-17T10:43:38.723

有一些最初由 IBM 提供的旧代码可按原样使用。它只有 getopt 的实现，而不是 _long 变体。可在[http://plexfx.org/news/files/70411c2c371bd686273a8bebc42c45c5-3.html上找到](http://plexfx.org/news/files/70411c2c371bd686273a8bebc42c45c5-3.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T16:21:12.963

您必须查看许可证要求，但 GCC 库的源代码是免费提供的。只需从那里获取 getopt() 即可。

# java - GroupLayout：值得学习吗？

> ID：543574
> 
> 赞同：10
> 
> 时间：2009-02-12T21:56:52.743
> 
> 标签：java, eclipse, user-interface, swing, netbeans

我对java（特别是swing）比较陌生，最近一直在制作一些相当简单的应用程序，边学习边学习。最新的一个有很多表单组件，例如 JLabels、JTextFields、JButtons 等。所有这些组件都使用可视化构建器放置在 NetBeans 中。我不得不说我并没有真正使用 NetBeans，我只是在设计 GUI 并将代码直接复制到 Eclipse。

我的问题是：是否值得对 GroupLayout 和手工编码有很好的理解（因此对我的 GUI 有更多的控制）还是继续原样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-12T22:44:59.040

我会说值得花一些时间来了解`GroupLayout`，因为了解您的 IDE 正在做什么总是一个好主意。了解幕后发生的事情实际上会让您更加灵活，因为如果您最终遇到无法访问 Netbeans 的情况，您将知道如何复制它为您生成的布局。此外，在您获得相当多的经验之后，您可能最终会节省总体时间。与使用可视化编辑器相比，您通常可以更快地手动开发简单的 GUI，尤其是考虑到将代码从 Netbeans 复制并粘贴到 Eclipse 所花费的时间。

当然，学习如何`GroupLayout`手动使用也可以让您更轻松地过渡到 Java 提供的任何其他布局管理器，这反过来又可以简化代码并节省更多时间。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-12T22:33:01.567

[`GroupLayout`](http://java.sun.com/javase/6/docs/api/javax/swing/GroupLayout.html)并不是真正为手动编码而设计的；它比任何其他布局管理器都要详细得多（可能除外[`GridBagLayout`](http://java.sun.com/javase/6/docs/api/java/awt/GridBagLayout.html)）。既然你说你是 Swing 新手，我建议从基本的布局管理器（[`BorderLayout`](http://java.sun.com/javase/6/docs/api/java/awt/BorderLayout.html)和[`FlowLayout`](http://java.sun.com/javase/6/docs/api/java/awt/FlowLayout.html)）开始；您可以通过右键单击面板或框架并选择“设置布局”在 NetBeans 中使用它们。在你熟悉了这些之后，我建议你检查一下[`MiGLayout`](http://www.miglayout.com/)。

回答您的另一个问题：我认为 NetBeans 表单设计器类似于计算器；如果您已经了解基础知识，这是一个很棒的工具，但如果您只是将它用作拐杖，您将永远学不到任何东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-11-24T14:34:56.857

**`GroupLayout`值得学习以编程方式使用。**

`GroupLayout`在我创建的几乎每个使用标准 Swing 组件的面板上，我都将其用作默认布局。我发现结果总是非常令人赏心悦目，并且调整大小非常好。我总是设置这些选项：

```
groupLayout.setAutoCreateGaps(true);
groupLayout.setAutoCreateContainerGaps(true); 
```

反复使用这种布局不仅给了我漂亮的布局，而且给了我所需的低级经验，能够将一些复杂的面板与许多在编译时未知的组件组合在一起。我还发现，当组件的数量是动态的时，我可以布置所有组件，然后打开和关闭它们，而`setVisible(boolean)`无需重新创建水平和垂直组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T03:53:16.693

大多数更复杂的布局管理器并不意味着手动编码。你可以做到，但几个月后你可能会难以理解自己的布局。GroupLayout 也不例外，更糟糕的是它根本不直观，你必须扭曲你的想法，强迫你的布局进入 GroupLayout 术语。

我认为这些布局管理器不值得学习。GridBagLayout 是最糟糕的。它有比你想象的更多的选择，而且它们似乎从来没有像你认为的那样做。MiGLayout 非常强大，相当直观，并且主要执行您认为的操作，但我仍然认为它太强大太复杂了，对程序员来说也是如此。GroupLayout 没有那么强大，没有那么直观，也不值得这么麻烦。

多年布置和维护 Java GUI 的建议是学习和使用最强大的布局管理器，你可以在两个小时内掌握并且永远不会忘记，然后使用这个布局管理器和基本的布局管理器使用嵌套容器布局你的 GUI BorderLayout/GridLayout/FlowLayout/BoxLayout。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-16T09:12:55.170

如果您倾向于使用 VB 程序样式，您会花时间在 GroupLayouts 上。否则，请尝试通过合适的示例来了解 GridBagLayout Manager。对于那些希望每个 gui 组件都在我们的笔控制下（我们应该编写而不是 IDE）的人来说，这是最好的。一个好的 java 开发人员应该花时间在 gui 对象和业务对象上，并且必须知道如何将它们分开。L.Sankaranarayanan。

# lisp - 最令人印象深刻的 Lisp 应用程序是什么？

> ID：543579
> 
> 赞同：49
> 
> 时间：2009-02-12T21:57:38.733
> 
> 标签：lisp

我知道这是主观的，但仍然可以提供一些用 Lisp 编写的严肃应用程序列表（也许连同它是什么 Lisp）？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-12T22:02:09.113

Emacs。

至少有一部分是用 Emacs Lisp 编写的。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-02-12T22:10:52.197

[ITA Software 的](http://itasoftware.com/careers/l_e_t_lisp.html?catid=8)机票搜索服务。请参阅[此处](http://www.demarcken.org/carl/papers/ITA-software-travel-complexity/ITA-software-travel-complexity.pdf)以了解为什么这令人印象深刻。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-02-12T22:15:37.940

LISP 它[自己！](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-26.html#%_sec_4.1):)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-02-14T00:50:55.797

镖。一个用 Common Lisp 编写的物流应用程序，用于第一次海湾战争，将科威特从萨达姆侯赛因手中解放出来。可以说，当这个应用程序准备好时，战争就开始了。开发人员在巨大的时间压力下工作以使其成为可能。

据说这个单一的应用程序已经收回了所有（！）美国政府在人工智能研究方面的投资。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-02-12T22:04:30.200

我特别喜欢[千里马](http://maxima.sourceforge.net/)。我最近发现的另一个不错的项目是[Nyquist](http://www.cs.cmu.edu/~music/nyquist/)。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-02-22T11:40:04.087

最令人印象深刻的 Lisp 应用程序之一肯定是[Cyc](http://www.cyc.com/)。Cyc 是 Doug Lenat 发起的一个项目，它试图将常识性知识放入基于知识的系统中。不仅仅是一点点，而是真的很多知识。人类已经学到了很多不同的东西，人们认为人工智能软件对这些东西一无所知是一个限制。蜂蜜的典型颜色是什么？我们是坐在椅子上还是椅子底下？一杯新鲜的咖啡是热的。外面下雨，里面不下雨。海水含有盐分，但池塘里的水不含盐分。大多数鸟都会飞。有些鸟不会飞。令人惊讶的是，人们知道这些事实、规则和概念的数量之多。

Cyc 自 1984 年以来一直在不断发展，知识库包含（数字来自 2004 年）超过 250 万条事实和规则。它还包含超过 15 万个概念（类似于 OOP 中的类）。Cyc 是用 SubL（Common Lisp 的一种方言）开发的。

知识以 CycL（一种基于声明性逻辑的语言）输入。受过专门训练的人正在输入知识。Cyc 检查该新知识是否与现有知识相冲突。它还可以得出新的结论，并且可以查询它。对于它的答案，它也可以产生解释。Cyc 还实现了许多特定领域的启发式方法。

早期该项目开始在 Lisp Machines 上开发，但今天该软件是可移植的，也可供感兴趣的学生和研究人员使用（OpenCyc 和 ResearchCyc）。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-02-18T23:43:16.187

NASA 使用 Lisp Machines 来检查航天飞机的启动情况。来自 1990 年的 Symbolics 新闻稿：

“最近，美国国家航空航天局 (NASA) 使用 Symbolics 的高清技术实时分析发现号发射的高清电视视频图像。这种高清系统使 NASA 工程师能够即时回放关键发射系统。工程师们能够增强和放大升空的高分辨率图像，以分析航天飞机瓷砖的状况并发现潜在问题。”

他们使用了一堆带有特殊图像处理板的 Lisp 机器。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-02-12T22:09:41.467

[Sawfish](http://sawfish.wikia.com/wiki/Main_Page)很久以前是 GNOME 的默认窗口管理器。现在它们默认使用 Metacity，但您仍然可以使用 Sawfish（也是独立的）并且它仍在积极开发中。

Sawfish 功能非常丰富且可定制。正是您对 LISP 窗口管理器的期望。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-13T08:31:11.067

最终成为雅虎！购物是用 Lisp 完成的。 [见原作者描述](http://www.paulgraham.com/avg.html)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-13T08:12:36.900

AutoCAD G2 雅虎商店

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-13T08:21:14.023

**Obidos，原始的亚马逊网络服务器**

根据史蒂夫·耶格的说法。

*   [http://steve.yegge.googlepages.com/tour-de-babel](http://steve.yegge.googlepages.com/tour-de-babel)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-02-18T23:30:01.040

白宫出版服务器

在克林顿政府时期，一个 Lisp 应用程序被用来向美国公民通报政府新闻。该应用程序是用 Common Lisp 编写的，并在两台 Symbolics Lisp 机器（后来在 Open Genera 虚拟 Lisp 机器上）上的 CL-HTTP Web 服务器之上运行。它还使用了 Statice 面向对象的数据库。该应用程序提供了政府领域的分类，可以通过网络或电子邮件界面查询出版物。例如，公民可以在某一周内了解副总统戈尔关于环境问题的看法。这是乔治·W·布什上任时关闭的申请。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-12T22:13:14.547

[Orbitz.com](http://www.paulgraham.com/carl.html)？

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-02-25T14:58:33.570

我真正喜欢的另一个应用程序是[PWGL](http://www2.siba.fi/PWGL/)。

PWGL 是一种用于计算机辅助作曲和声音合成的可视化编程语言。它是一个[LispWorks](http://www.lispworks.com)应用程序，可用于 Windows 和 Mac OS X（免费下载）。它使用了许多复杂的图形（在 OpenGL 中完成），例如在其高级注释编辑器中。它可以处理和创造声音。它还可以使用 Midi 输入和输出。它的教程中包含大量示例。如果您有 LispWorks，您还可以加载二进制文件并使用它编写自己的代码。

该应用程序的功能真的很棒，如果您愿意学习它的用法，对于爱好作曲家和爱好声音设计师来说，这将是数小时的乐趣。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2012-04-18T08:39:06.643

可能，不是最令人印象深刻，但确实值得一提，考虑到这主要是一个人的努力： http: [//piano.aero/](http://piano.aero/)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-02-14T00:01:38.083

很难说哪个 Lisp 软件*最*令人印象深刻，但我会将[Symbolics Genera](http://lispm.dyndns.org/genera-concepts/genera.html)和[相关软件](http://lispm.dyndns.org/symbolics-ui-examples/symbolics-ui-examples.html)添加到值得一提的成就列表中。也不要忘记[SLIME](http://common-lisp.net/project/slime/)。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-12T22:14:45.010

LISP，或者至少是 LISP 评估器。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-13T06:26:59.743

有关Lisp 的许多商业用途的列表，请参阅此[问题。](https://stackoverflow.com/questions/406729/what-are-some-examples-of-lisp-being-used-in-production-outside-of-ai-and-academ)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-13T12:46:12.733

[http://www.thanandar.de/](http://www.thanandar.de/ "Thanandar 浏览器游戏")

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-10-13T20:39:43.843

IRCAM 的 OpenMusic（计算机辅助作曲环境）。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-01-02T15:40:29.970

Zone: The Battleground 的匹配服务器是用 Common Lisp 编写的。[他们的网站。](http://www.xitol.net)

# sql - 等于（=）与 LIKE

> ID：543580
> 
> 赞同：331
> 
> 时间：2009-02-12T21:57:40.513
> 
> 标签：sql, performance, equals, sql-like

使用 SQL 时，使用`=`in`WHERE`子句而不是有什么好处`LIKE`？

不用任何特殊运算符，`LIKE`都是`=`一样的吧？

* * *

## 回答 #1

> 赞同：328
> 
> 时间：2010-02-25T19:27:35.837

# 不同的运营商

`LIKE`并且`=`是不同的运营商。这里的大多数答案都集中在通配符支持上，这不是这些运算符之间的唯一区别！

`=`是对数字和字符串进行操作的比较运算符。比较字符串时，比较运算符会比较*整个字符串*。

`LIKE`是一个*逐字符*比较的字符串运算符。

更复杂的是，两个运算符都使用了一个[排序规则](http://dev.mysql.com/doc/refman/5.1/en/charset-general.html)，它会对比较结果产生重要影响。

# 激励例子

让我们首先确定一个示例，其中这些运算符产生明显不同的结果。请允许我引用 MySQL 手册：

> 根据 SQL 标准，LIKE 在每个字符的基础上执行匹配，因此它可以产生与 = 比较运算符不同的结果：

```
mysql> SELECT 'ä' LIKE 'ae' COLLATE latin1_german2_ci;
+-----------------------------------------+
| 'ä' LIKE 'ae' COLLATE latin1_german2_ci |
+-----------------------------------------+
|                                       0 |
+-----------------------------------------+
mysql> SELECT 'ä' = 'ae' COLLATE latin1_german2_ci;
+--------------------------------------+
| 'ä' = 'ae' COLLATE latin1_german2_ci |
+--------------------------------------+
|                                    1 |
+--------------------------------------+ 
```

请注意，MySQL 手册的这一页称为*字符串比较函数*，`=`没有讨论，这意味着`=`严格来说它不是字符串比较函数。

# 如何`=`工作？

[SQL 标准 § 8.2](http://www.contrib.andrew.cmu.edu/%7Eshadow/sql/sql1992.txt)描述了如何比较`=`字符串：

> 两个字符串的比较确定如下：
> 
> a) 如果 X 的字符长度不等于 Y 的字符长度，则为了比较，较短的字符串被有效地替换为已扩展至较长字符串长度的自身副本通过在一个或多个填充字符的右侧连接，其中填充字符是根据 CS 选择的。如果 CS 具有 NO PAD 属性，则填充字符是一个依赖于实现的字符，它不同于 X 和 Y 字符集中的任何字符，其排序小于 CS 下的任何字符串。否则，填充字符是 <space>。
> 
> **b) X 和 Y 的比较结果由整理序列 CS 给出。**
> 
> c) 根据整理顺序，即使两个字符串的长度不同或包含不同的字符序列，它们也可能比较相等。当操作 MAX、MIN、DISTINCT、对分组列的引用以及 UNION、EXCEPT 和 INTERSECT 操作符引用字符串时，这些操作从一组这样的相等值中选择的具体值取决于实现。

（强调补充。）

这是什么意思？这意味着在比较字符串时，`=`运算符只是当前排序规则的一个薄包装器。排序规则是具有用于比较字符串的各种规则的库。下面是一个[来自 MySQL 的二进制排序规则](https://github.com/mysql/mysql-server/blob/5.7/strings/ctype-bin.c)示例：

```
static int my_strnncoll_binary(const CHARSET_INFO *cs __attribute__((unused)),
                               const uchar *s, size_t slen,
                               const uchar *t, size_t tlen,
                               my_bool t_is_prefix)
{
  size_t len= MY_MIN(slen,tlen);
  int cmp= memcmp(s,t,len);
  return cmp ? cmp : (int)((t_is_prefix ? len : slen) - tlen);
} 
```

这种特殊的排序规则恰好是逐字节比较（这就是它被称为“二进制”的原因——它没有给字符串赋予任何特殊含义）。其他排序规则可能会提供更高级的比较。

例如，这里是一个支持不区分大小写比较的[UTF-8 排序规则。](https://github.com/mysql/mysql-server/blob/5.7/strings/ctype-utf8.c#L8241)代码太长，无法在此处粘贴，但请转到该链接并阅读`my_strnncollsp_utf8mb4()`. 此排序规则一次可以处理多个字节，并且可以应用各种转换（例如不区分大小写的比较）。`=`运算符完全从变幻莫测的排序规则中抽象出来。

# 如何`LIKE`工作？

[SQL 标准 § 8.5](http://www.contrib.andrew.cmu.edu/%7Eshadow/sql/sql1992.txt)描述了如何比较`LIKE`字符串：

> <谓词>
> 
> `M LIKE P`
> 
> 如果存在将 M 划分为子串的情况，则为真：
> 
> i) M 的子串是 M 的 0 个或多个连续的<字符表示>的序列，并且 M 的每个 <字符表示>恰好是一个子串的一部分。
> 
> ii) 如果 P 的第 i 个子串说明符是任意字符说明符，则 M 的第 i 个子串是任何单个 <character representation>。
> 
> iii) 如果 P 的第 i 个子串说明符是任意字符串说明符，则 M 的第 i 个子串是 0 个或多个 <character representation> 的任意序列。
> 
> **iv) 如果 P 的第 i 个子字符串说明符既不是任意字符说明符也不是任意字符串说明符，则根据 <like predicate> 的整理顺序，M 的第 i 个子字符串等于该子字符串说明符，没有将 <space> 字符附加到 M，并且具有与该子字符串说明符相同的长度。**
> 
> v) M 的子串数等于 P 的子串说明符数。

（强调补充。）

这很罗嗦，所以让我们分解一下。项 ii 和 iii 分别指通配符`_`和`%`。如果`P`不包含任何通配符，则仅适用第 iv 项。这是 OP 提出的感兴趣的案例。

在这种情况下，它使用当前排序规则将每个“子字符串”（单个字符）`M`与每个子字符串进行比较。`P`

# 结论

底线是比较字符串时，`=`比较整个字符串，而`LIKE`一次比较一个字符。两种比较都使用当前排序规则。这种差异在某些情况下会导致不同的结果，如本文的第一个示例所示。

你应该使用哪一个？没有人能告诉你——你需要使用适合你用例的那个。不要通过切换比较运算符过早地进行优化。

* * *

## 回答 #2

> 赞同：178
> 
> 时间：2009-02-12T22:25:09.213

等于 (=) 运算符是“比较运算符比较两个值是否相等”。换句话说，在 SQL 语句中，除非等式两边相等，否则它不会返回 true。例如：

```
SELECT * FROM Store WHERE Quantity = 200; 
```

LIKE 运算符“实现了模式匹配比较”，它试图将“字符串值与包含通配符的模式字符串进行匹配”。例如：

```
SELECT * FROM Employees WHERE Name LIKE 'Chris%'; 
```

LIKE 通常仅与字符串一起使用，而等于（我相信）更快。等于运算符将通配符视为文字字符。返回结果的差异如下：

```
SELECT * FROM Employees WHERE Name = 'Chris'; 
```

和

```
SELECT * FROM Employees WHERE Name LIKE 'Chris'; 
```

将返回相同的结果，尽管使用 LIKE 通常需要更长的时间作为模式匹配。然而，

```
SELECT * FROM Employees WHERE Name = 'Chris%'; 
```

和

```
SELECT * FROM Employees WHERE Name LIKE 'Chris%'; 
```

将返回不同的结果，其中使用“=”只会返回“Chris%”的结果，而 LIKE 运算符将返回以“Chris”开头的任何内容。

希望有帮助。可以在[这里](http://www.firstsql.com/tutor2.htm)找到一些好的信息。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2015-02-19T15:17:37.793

这是我对[SQL 'like' vs '=' 性能](https://stackoverflow.com/questions/6142235/sql-like-vs-performance/28609481#28609481)问题的另一个答案的复制/粘贴：

一个使用 mysql 5.5 的个人示例：我在 2 个表之间有一个内部连接，一个是 300 万行，另一个是 10000 行。

在如下索引上使用 like 时（无通配符），大约需要 30 秒：

```
where login like '12345678' 
```

使用“解释”我得到：

![在此处输入图像描述](https://i.stack.imgur.com/GI2XI.png)

在同一查询上使用“=”时，大约需要 0.1 秒：

```
where login ='12345678' 
```

使用“解释”我得到：

![在此处输入图像描述](https://i.stack.imgur.com/Nu93R.png)

如您所见，`like`完全取消了索引查找，因此查询花费了 300 倍以上的时间。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-02-12T22:05:55.233

`LIKE`并且`=`是不同的。`LIKE`是您将在搜索查询中使用的内容。它还允许使用通配符，例如`_`（简单字符通配符）和`%`（多字符通配符）。

`=`如果您想要完全匹配，应该使用它，它会更快。

[这个网站解释`LIKE`](http://www.techonthenet.com/sql/like.php)

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-02-12T22:03:03.463

一个区别——除了可以在 LIKE 中使用通配符——在于尾随空格：= 运算符忽略尾随空格，但 LIKE 不会。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-02-12T22:04:14.147

取决于数据库系统。

一般不用特殊字符，是的，=和LIKE是一样的。

但是，某些数据库系统可能会使用不同的运算符以不同的方式处理排序规则设置。

例如，在 MySQL 中，与 = 对字符串的比较默认情况下始终不区分大小写，因此没有特殊字符的 LIKE 是相同的。在其他一些 RDBMS 上，LIKE 不区分大小写，而 = 则不区分大小写。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2012-11-14T08:30:41.840

对于这个例子，我们理所当然地认为 varcharcol 不包含`''`并且没有针对该列的空单元格

```
select * from some_table where varcharCol = ''
select * from some_table where varcharCol like '' 
```

第一个导致 0 行输出，而第二个显示整个列表。= 是严格匹配大小写的，而 like 就像一个过滤器。如果过滤器没有条件，则每个数据都是有效的。

like - 由于它的目的，它的工作速度有点慢，并且旨在与 varchar 和类似数据一起使用。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-02-12T21:59:50.320

在运行时构建查询时，使用 = 可避免字符串中的通配符和特殊字符冲突。

这使得程序员的生活更轻松，因为不必转义所有可能滑入 LIKE 子句并且不会产生预期结果的特殊通配符。毕竟，= 是 99% 的用例场景，每次都必须逃避它们会很痛苦。

*在 90 年代翻白眼*

我也怀疑它有点慢，但如果模式中没有通配符，我怀疑它是否重要。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-02-12T22:10:26.737

如果您搜索完全匹配，您可以同时使用 = 和 LIKE。

在这种情况下使用“=”会稍微快一点（搜索完全匹配） - 您可以通过在 SQL Server Management Studio 中两次使用相同的查询来自己检查这一点，一次使用“=”，一次使用“LIKE”，并且然后使用“查询”/“包括实际执行计划”。

执行这两个查询，您应该会看到两次结果，以及两个实际的执行计划。在我的例子中，它们被分成 50% 和 50%，但是“=”执行计划的“估计子树成本”更小（当您将鼠标悬停在最左边的“SELECT”框上时显示） - 但同样，它真的差别不大。

但是，当您开始在 LIKE 表达式中使用通配符进行搜索时，搜索性能会下降。搜索“LIKE Mill%”仍然可以很快 - SQL Server 可以在该列上使用索引，如果有的话。搜索“LIKE %expression%”非常慢，因为 SQL Server 满足此搜索的唯一方法是执行全表扫描。所以要小心你的LIKE！

马克

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2010-04-12T21:09:57.177

为了解决有关性能的原始问题，它归结为**索引利用率**。当发生简单的表扫描时，“LIKE”和“=”是**相同**的。当涉及到索引时，这**取决于**LIKE 子句是如何形成的。更具体地说，通配符的位置是什么？

* * *

考虑以下：

```
CREATE TABLE test(
    txt_col  varchar(10) NOT NULL
)
go

insert test (txt_col)
select CONVERT(varchar(10), row_number() over (order by (select 1))) r
  from master..spt_values a, master..spt_values b
go

CREATE INDEX IX_test_data 
    ON test (txt_col);
go 

--Turn on Show Execution Plan
set statistics io on

--A LIKE Clause with a wildcard at the beginning
DBCC DROPCLEANBUFFERS
SELECT txt_Col from test where txt_col like '%10000'
--Results in
--Table 'test'. Scan count 3, logical reads 15404, physical reads 2, read-ahead reads 15416, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
--Index SCAN is 85% of Query Cost

--A LIKE Clause with a wildcard in the middle
DBCC DROPCLEANBUFFERS
SELECT txt_Col from test where txt_col like '1%99'
--Results in
--Table 'test'. Scan count 1, logical reads 3023, physical reads 3, read-ahead reads 3018, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
--Index Seek is 100% of Query Cost for test data, but it may result in a Table Scan depending on table size/structure

--A LIKE Clause with no wildcards
DBCC DROPCLEANBUFFERS
SELECT txt_Col from test where txt_col like '10000'
--Results in
--Table 'test'. Scan count 1, logical reads 3, physical reads 2, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
--Index Seek is 100% of Query Cost
GO

--an "=" clause = does Index Seek same as above
DBCC DROPCLEANBUFFERS
SELECT txt_Col from test where txt_col = '10000'
--Results in
--Table 'test'. Scan count 1, logical reads 3, physical reads 2, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
--Index Seek is 100% of Query Cost
GO

DROP TABLE test 
```

使用“=”与“LIKE”时，查询计划的创建也可能存在微不足道的差异。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-11-10T22:40:05.723

`=`除了通配符之外， AND之间的区别`LIKE`还取决于 SQL 服务器的类型和列类型。

举个例子：

```
CREATE TABLE testtable (
  varchar_name VARCHAR(10),
  char_name CHAR(10),
  val INTEGER
);

INSERT INTO testtable(varchar_name, char_name, val)
    VALUES ('A', 'A', 10), ('B', 'B', 20);

SELECT 'VarChar Eq Without Space', val FROM testtable WHERE varchar_name='A'
UNION ALL
SELECT 'VarChar Eq With Space', val FROM testtable WHERE varchar_name='A '
UNION ALL
SELECT 'VarChar Like Without Space', val FROM testtable WHERE varchar_name LIKE 'A'
UNION ALL
SELECT 'VarChar Like Space', val FROM testtable WHERE varchar_name LIKE 'A '
UNION ALL
SELECT 'Char Eq Without Space', val FROM testtable WHERE char_name='A'
UNION ALL
SELECT 'Char Eq With Space', val FROM testtable WHERE char_name='A '
UNION ALL
SELECT 'Char Like Without Space', val FROM testtable WHERE char_name LIKE 'A'
UNION ALL
SELECT 'Char Like With Space', val FROM testtable WHERE char_name LIKE 'A ' 
```

*   使用[MS SQL Server 2012](http://sqlfiddle.com/#!6/f9586/2)时，比较中将忽略尾随空格，但`LIKE`列类型为`VARCHAR`.

*   使用[MySQL 5.5](http://sqlfiddle.com/#!2/f9586/2)，尾随空格将被忽略`=`，但对于和`LIKE`都不会。`CHAR``VARCHAR`

*   使用[PostgreSQL 9.1](http://sqlfiddle.com/#!6/f9586/2)时，空格对两者都很重要`=`using `LIKE`，`VARCHAR`但不是`CHAR`（请参阅[文档](http://www.postgresql.org/docs/9.1/static/datatype-character.html)）。

    的行为`LIKE`也与 不同`CHAR`。

    使用与上面相同的数据，`CAST`在列名上使用显式[也会有所不同](http://sqlfiddle.com/#!1/4b92d/1)：

    ```
    SELECT 'CAST none', val FROM testtable WHERE char_name LIKE 'A'
    UNION ALL
    SELECT 'CAST both', val FROM testtable WHERE
        CAST(char_name AS CHAR) LIKE CAST('A' AS CHAR)
    UNION ALL
    SELECT 'CAST col', val FROM testtable WHERE CAST(char_name AS CHAR) LIKE 'A'
    UNION ALL
    SELECT 'CAST value', val FROM testtable WHERE char_name LIKE CAST('A' AS CHAR) 
    ```

    这仅返回“CAST both”和“CAST col”的行。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-12T22:03:09.983

实际上，它归结为您希望查询执行的操作。如果您的意思是完全匹配，请使用 =。如果您的意思是模糊匹配，请使用 LIKE。说出你的意思通常是一个很好的代码策略。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-12T22:23:46.457

LIKE 关键字无疑带有附加的“性能价格标签”。也就是说，如果您的输入字段可能包含要在查询中使用的通配符，我建议**仅**在输入包含通配符之一时使用 LIKE。否则，使用等于比较的标准。

最好的祝福...

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-09-02T20:19:44.007

在 Oracle 中，没有通配符的“like”将返回与“equals”相同的结果，但可能需要额外的处理。[根据 Tom Kyte](http://asktom.oracle.com/pls/apex/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:2668487300346354023)的说法，Oracle 将在使用文字时将不带通配符的“like”视为“等于”，但在使用绑定变量时不会。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-06-11T05:55:31.597

`=`比 快得多`LIKE`。

在 11GB 数据和超过 1000 万条记录的 MySQL 上测试，f_time 列被索引。

`SELECT * FROM XXXXX WHERE f_time = '1621442261'` - 花费 0.00 秒并返回 330 条记录

`SELECT * FROM XXXXX WHERE f_time like '1621442261'`- 耗时 44.71 秒，返回 330 条记录

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-02-12T22:00:05.530

`=`和`LIKE`不一样；

1.  `=`匹配确切的字符串
2.  `LIKE`匹配可能包含通配符 (%) 的字符串

# sql - 对这个查询的工作方式感到困惑

> ID：543584
> 
> 赞同：0
> 
> 时间：2009-02-12T21:58:24.177
> 
> 标签：sql, tsql

我正在尝试学习高级 sql 以及如何使用系统查询（sql server）。下面的查询有点令人困惑。

```
CREATE PROC dbo.ShowHierarchy
(
    @Root int
)
AS
BEGIN
    SET NOCOUNT ON
    DECLARE @EmpID int, @EmpName varchar(30)

    SET @EmpName = (SELECT EmpName FROM dbo.Emp WHERE EmpID = @Root)
    PRINT REPLICATE('-', @@NESTLEVEL * 4) + @EmpName

    SET @EmpID = (SELECT MIN(EmpID) FROM dbo.Emp WHERE MgrID = @Root)

    WHILE @EmpID IS NOT NULL
    BEGIN
        EXEC dbo.ShowHierarchy @EmpID
        SET @EmpID = (SELECT MIN(EmpID) FROM dbo.Emp WHERE MgrID = @Root AND EmpID > @EmpID)
    END
END
GO 
```

取自这里：

[http://vyaskn.tripod.com/hierarchies_in_sql_server_databases.htm](http://vyaskn.tripod.com/hierarchies_in_sql_server_databases.htm)

每次查询运行时，@EmpId 参数如何递增？它自己做吗？另外，@root 每次递归都会增加吗？例如，CEO 是 root，去直属下属，那个直属下属现在是 @root，等等。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T22:03:48.843

> 每次查询运行时，@EmpId 参数如何递增？它自己做吗？

这个：

```
SET @EmpID = (SELECT MIN(EmpID) FROM dbo.Emp WHERE MgrID = @Root AND EmpID > @EmpID) 
```

选择`EmpID`大于已选择的最小值，并将其分配给`@EmpID`.

当然，如果有的话，新`@EmpID`的会比旧的大，也就是说`@EmpID`是递增的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T22:05:11.413

在最后一个选择中，@EmpID 设置为大于@EmpID 的最低 EmpID。这样，@EmpID 将“递增”，直到没有更大的 EmpID。在这种情况下，select min(EmpID) 返回 null 并且 while 循环结束。

@Root 通过在 EXEC 语句中对 ShowHierarchy 的递归调用进行更改。基本上，当前的@EmpID 在被触发的执行中变成了新的@Root。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T22:05:38.230

正如 Quassnoi 所说，这是 @EmpId 增加的地方：

```
SET @EmpID = (SELECT MIN(EmpID) FROM dbo.Emp WHERE MgrID = @Root AND EmpID > @EmpID) 
```

是的，当递归调用该过程时，它将当前递归的@EmpID 作为新的@Root 传递：

```
EXEC dbo.ShowHierarchy @EmpID 
```

# entity-framework - 实体框架：如果数据在上下文中，为什么数据库会受到影响？

> ID：543587
> 
> 赞同：4
> 
> 时间：2009-02-12T21:58:55.517
> 
> 标签：entity-framework

为什么要访问数据库以查找已在 ObjectContext 中表示的记录？

因此，当您查询时，我认为会发生以下情况：

`SiteUser someUser = context.SiteUser.Where(role => role.UserID == 1).ToList()[0];`

垃圾示例，但想法是我想从 id 为 1 的表中获取用户。现在假设这是第一次通过，所以我猜它必须在上下文中创建 SiteUser 列表，查询数据库，然后填写它的列表。使用探查器我看到这​​个：

```
SELECT 
 [Extent1].[UserID] AS [UserID], 
 [Extent1].[MainEmail] AS [MainEmail], 
 [Extent1].[Password] AS [Password], 
 [Extent1].[UserName] AS [UserName]
FROM [TIDBA].[TI_USER] AS [Extent1]
WHERE 1 = [Extent1].[UserID] 
```

美丽的。它达到了我的预期，并且在 SiteUser 列表中（如果我使用 Watch 挖掘得足够远）我可以看到上下文 SiteUser 列表中有一个项目，它恰好是代表该数据行的水合对象。

接下来我想改变一些东西而不保存：

```
someUser.UserName = "HIHIHI"; 
```

现在说由于某种原因我想再次抓住它使用相同的上下文（这是一个奇怪的例子，但它实际上是一个测试，所以我可以证明这种情况发生）：

```
someUser = context.SiteUser.Where(role => role.UserID == 1).ToList()[0]; 
```

我认为会发生的是它会查看上下文中的 SiteUser 列表，因为这就是生成的属性所说的。（如果不为空，则返回列表）然后它会查看它是否存在并返回它。没有数据库命中。猜猜分析器怎么说...

```
SELECT 
 [Extent1].[UserID] AS [UserID], 
 [Extent1].[MainEmail] AS [MainEmail], 
 [Extent1].[Password] AS [Password], 
 [Extent1].[UserName] AS [UserName]
FROM [TIDBA].[TI_USER] AS [Extent1]
WHERE 1 = [Extent1].[UserID] 
```

人力资源管理系统。好的，所以我开始认为，也许这是一个直觉检查，看看该数据项是否发生了任何变化，并仅在客户端上未更改的值上更新 SiteUser 对象。（有点像 context.Refresh(RefreshMode.ClientWins, context.SiteUser) ）所以我让它停在：

```
someUser = context.SiteUser.Where(role => role.UserID == 1).ToList()[0]; 
```

我和 Line 更改了数据库中的一个值（密码列）并让它进入数据库。对象没有任何变化。

这里似乎有些不对劲。它会访问数据库以选择我已经在上下文中水合的对象，但它不会应用我在数据库中手动进行的更改。为什么它会影响数据库呢？

**更新** 感谢下面的一些链接，我能够挖掘一下并找到这个：

[合并选项](http://msdn.microsoft.com/en-us/library/system.data.objects.mergeoption.aspx)

看起来有一个枚举被设置来告诉如何处理负载。现在读完之后，我看到了 MergeOption.AppendOnly：

> 对象上下文中已存在的对象不会从数据源加载。这是查询或在 EntityCollection<(Of <(TEntity>)>) 上调用 Load 方法时的默认行为。

这表明如果我在上下文中使用它，那么数据库应该不会受到影响。然而，这似乎不是真的。如果 OverwriteChanges 或 PreserveChanges 是默认值，那将是有意义的，但它们不是。这似乎与应该发生的事情相矛盾。我唯一能想到的是“加载”只是意味着没有覆盖。但是，这并不意味着没有对数据库的查询。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-19T15:02:57.630

context.SiteUser 是 ObjectQuery 类型的属性。当您执行 ObjectQuery 时，它*总是*会命中后备存储。他们就是这样做的。如果您不想执行数据库查询，请不要使用 ObjectQuery。

听起来你真正想要的是一个函数，它说：“如果实体已经在上下文中具体化，则返回它。如果不是，则从数据库中获取它。” 碰巧，ObjectContext 包含这样一个函数，称为**[GetObjectByKey](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.getobjectbykey.aspx)**

> GetObjectByKey 尝试从 ObjectStateManager 检索具有指定 EntityKey 的对象。如果对象当前未加载到对象上下文中，则执行查询以尝试从数据源返回对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T15:46:36.380

IMO，EF第二次访问数据库的原因是确保数据库中没有任何额外的行满足查询。自发出第一个查询以来，可能已将其他相关行插入到表中，并且 EF 正在查看是否存在这些行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T15:28:02.167

如果我理解你的问题，这应该回答它：

> 实际上，实体框架默认执行此操作的方式是要求将实体对象的更改通知到称为状态管理器的框架类，然后状态管理器跟踪哪些属性已更改。原始值仅按需复制。当更新发生时，只有当更改的属性被标记为“并发令牌”时，这些原始值才会用于与服务器通信。也就是说，对于任何并发标记列，当框架创建更新语句时，它将包括一个检查以验证数据库中的行是否仍然具有原始值，如果不是，它将引发异常以通知程序有人else 已更改数据库中的行。

来自[这里](http://blogs.msdn.com/dsimmons/archive/2007/03/28/change-tracking-mechanisms.aspx)。更多信息可以在[这里](http://www.thedatafarm.com/blog/2007/10/01/MoreOnDisconnectedEntityFramework.aspx)和[这里](http://www.udidahan.com/2007/03/30/entity-framework-disconnected-problems-solutions/)阅读。

**编辑添加：**

似乎使用 EF，有一个*ObjectStateManager*可以跟踪从未真正允许断开数据的更改。为了断开数据，您必须调用 ObjectContext.Detach 方法来断开您的对象。更多可以在[这里](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.detach.aspx)和[这里](http://msdn.microsoft.com/en-us/library/bb738611.aspx)找到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T09:09:08.877

如果您避免使用 .ToList() 并使用 .FirstOrDefault() 怎么办？

# ruby - ruby Test::Unit 命令行选项？

> ID：543588
> 
> 赞同：8
> 
> 时间：2009-02-12T21:59:00.133
> 
> 标签：ruby, unit-testing, testunit

在 Ruby 的 unit::test 框架中运行测试时，是否有一种非常简单的方法可以从命令行指定只运行一个测试（即指定测试类和测试成员变量）？如果没有，是否有其他框架具有此功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T22:02:32.747

```
ruby /path/to/foo_test.rb --name test_should_do_something_really_spiffy 
```

这将调用该`test_should_do_something_really_spiffy`文件中的方法定义的测试。

编辑：这是用于`Test::Unit`编写大多数 ruby​​ 测试的框架。我假设你的意思是一样的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-04-29T23:32:08.677

如果你有完整的`Test::Unit`框架，你可以做

```
ruby /path/to/foo_test.rb --help 
```

获取命令行选项。不过，如果您只有最小版本，我认为它不起作用。

# silverlight - Silverlight helix 代码隐藏页面导航

> ID：543602
> 
> 赞同：1
> 
> 时间：2009-02-12T22:00:57.697
> 
> 标签：silverlight, navigation

我是 silverlight 的新手，从我收集的信息来看，没有任何关于分页的直接功能，所以我从[这里](http://blogs.msdn.com/dphill/archive/2008/10/07/silverlight-navigation-part-1.aspx)下载了 helix 项目。我发现它相当有用，但未能找到一种方法（使用 helix）通过 code-behind 导航页面。我需要这个的原因是，如果方法成功执行，我想导航到另一个页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T22:48:39.080

在 RootPage.xaml.cs 的 OnLoaded 事件中可以看到如下代码：

```
this.rootFrame.Navigate( new Uri( "Page1.xaml", UriKind.Relative ) ); 
```

当通过调用 RootPage.xaml 中定义的 Frame 控件实例的 Navigate 方法加载 RootPage 时，这会以编程方式导航到 Page1.xaml（实现 NavigationPage）：

```
<h:Frame x:Name="rootFrame" Grid.Row="0" Grid.Column="1"
         NavigationUIVisibility="Visible" Margin="4" /> 
```

该 Navigate 方法依次调用 Frame 的封装 StackJournal 实例的 Navigate 方法。

如果您处于无法直接访问父框架的页面（即除 RootPage 之外的任何页面）的代码隐藏中，例如 Page1.xaml，您需要引发一个 RequestNavigate 事件，该事件将冒泡到最近的父框架.

以下代码显示如何以编程方式从单击 Page1.xaml 的按钮直接导航到 Page3.xaml：

```
private void TestButton_Click(object sender, RoutedEventArgs e)
{
    this.RaiseEvent(NavigationLink.RequestNavigateEvent,
        new RequestNavigateEventArgs(new Uri("Page3.xaml", UriKind.Relative),
        "rootFrame"));
} 
```

请注意，targetName 是“rootFrame”，即最终执行导航的父 Frame 对象。

# .net - 如何将 2+ 表映射到 .NET Entity Framework 中的实体？

> ID：543604
> 
> 赞同：0
> 
> 时间：2009-02-12T22:01:17.447
> 
> 标签：.net, entity-framework

使用 Visual Studio 中的设计器，如何定义映射到 2 个或更多表的实体？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-13T18:58:30.217

尝试[实体框架将多个表映射到一个实体](https://stackoverflow.com/questions/1772064/entity-framework-map-multiple-tables-to-one-entity)

或者

[http://msdn.microsoft.com/en-us/library/cc716698.aspx](http://msdn.microsoft.com/en-us/library/cc716698.aspx)

# c# - 在插入新条目时使用 GridView 中的 DropDownList 的值

> ID：543612
> 
> 赞同：1
> 
> 时间：2009-02-12T22:02:26.867
> 
> 标签：c#, asp.net

我现在搜索了几天，但没有找到解决方案。所以这是我的场景：

我有一个带有 DataBindung 到数据库的 DetailView，并且 DefaultMode 设置为“ *Insert* ”作为新 db 条目的输入表单。此DetailsView 中的一个字段是一个TemplateField，其InsertItemTemplate 包含一个DropDownList。这个 DropDownList 也绑定到另一个 SqlDataSource，使用选择参数“UserID”来获取实际登录用户的数据库的所有行。这些行显示在我的 DropDownList 中，当在我的浏览器中查看源代码时，我看到了正确的“选项”属性，所有这些漂亮的 db-ID 都在其相应的值中。所以到目前为止一切都很好。

现在我按下插入按钮将数据发送回服务器。但是，当尝试使用以下代码从 DetailsView1_ItemInserting() 中的 DropDownList 中获取所选值时，我得到一个空值。

```
var list = (DropDownList)DetailsView1.Rows[0].FindControl( "DropDownList1" );
InsertEntryDataSource.InsertParameters["DropDownList1Value"].DefaultValue = list.Items[list.SelectedIndex].Value; 
```

相同的代码适用于我在这个项目中创建的另一个表单。唯一的区别是，另一个 DropDownList 绑定到 DataSource 没有我必须在运行时设置的选择参数（当前登录的用户 ID）。

我的恢复是回发后 DropDownList 是空的，因为数据绑定尚未完成。因此，我在 DetailsView1_ItemInserting() 中为我的 DropDownList 绑定到的 SqlDataSource 设置了选择参数——现在上面的行得到了我的值。

**但是**：我刚刚再次测试了表单并确定，无论我在 DropDownList 中选择哪个条目，我**总是得到****第一个**条目的值！整个过程似乎清除了 DropDownList 的 SelectedIndex - 所以现在我有一个要插入的值而不是 null，但它是错误的。:-(

所以我的问题是：如何访问 DetailsView1_ItemInserting() 中 DropDownList 的选定值以将其保存到数据库中？

提前致谢， Anheledir

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T21:50:50.110

您可以使用此语法访问 ddl，而无需编写代码：

```
<InsertParameters>
<asp:ControlParameter ControlID="DetailsView1$DropDownList1" Name="DropDownList1" PropertyName="SelectedValue" Type="String" />
</InsertParameters> 
```

或者从 DataSource_Inserting 事件而不是 DetailsView_ItemInserting 事件你可以这样做：

```
 e.InputParameters["InputParameterFieldName"] = ((DropDownList)DetailsView1.FindControl("DropDownList1")).SelectedValue; 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T22:13:15.810

您是否曾经一次插入不止一行数据？我想备份一个步骤并询问为什么您需要将插入作为 GridView 本身的一部分，而不是它自己的 UI 的一部分（带有一些输入控件和提交按钮）。空间上的分离强调功能的分离——一部分用于插入，一部分用于报告/显示。您正在使用的方法听起来像是为了获得很少的回报而付出了很多努力。

# powershell - PowerShell：如何运行文件夹大小总和？

> ID：543621
> 
> 赞同：2
> 
> 时间：2009-02-12T22:03:45.507
> 
> 标签：powershell

我的目标是编写一个复制脚本，将文件从一个目录“d:\aa1”移动到“d:\aa2”，直到另一个目录“d:\bbb”的指定大小。换句话说...我希望它将所有文件从“d:\aa1”复制到“d:\aa2”，直到“d:\aa1”的大小等于或小于“d:\ bb”。

到目前为止我有

```
$lmt = get-childitem d:\bbb  | measure-object -property length -sum 
do { get-childitem -path d:\aa1 | move-item -destination "d:\aa2" } while {measure-object {$_.sum -lt $lmt} 
```

但是语法似乎不起作用。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T22:18:37.653

```
Get-ChildItem -path d:\aa1 `
| % {if (((Get-ChildItem d:\aa2 `
| Measure-Object -Property Length -Sum).Sum + $_.Length) `
-lt (Get-ChildItem d:\bbb | Measure-Object -Property Length -Sum).Sum) `
{Move-Item $_.FullName d:\aa2}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:07:45.400

目录总和应该有一个属性或方法。您可以根据需要为以下脚本添加选项到“ls”：

```
rv total;
foreach ($i in ((ls -Force) | Select Length)) {[int64]$total+=$i[0].Length};
$total /1GB; 
```

# sql - Linq to SQL 中的动态表名

> ID：543639
> 
> 赞同：3
> 
> 时间：2009-02-12T22:06:30.413
> 
> 标签：sql, linq-to-sql, dynamic, ienumerable

大家好，我有一个可怕的数据库，我必须使用它，linq to sql 是我从中检索数据的选项。我试图通过根据用户选择输入不同的表名来重用函数的任何人，据我所知，没有办法在 DataContext 查询中修改 TEntity 或 Table<>。

这是我当前的代码。

```
public void GetRecordsByTableName(string table_name){

string sql = "Select * from " + table_name;
var records = dataContext.ExecuteQuery</*Suppossed Table Name*/>(sql);

ViewData["recordsByTableName"] = records.ToList();
} 
```

我想用 Enumerable 记录填充我的 ViewData。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T19:49:15.633

您可以在 DataContext 实例上调用 ExecuteQuery 方法。您将需要调用采用 Type 实例的重载，如下所示：

[http://msdn.microsoft.com/en-us/library/bb534292.aspx](http://msdn.microsoft.com/en-us/library/bb534292.aspx)

假设您有一个为表正确归因的类型，为该类型传递该类型实例，SQL 将为您提供所需的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T19:06:55.537

正如 casperOne 已经回答的那样，您可以使用`ExecuteQuery`方法第一个重载（要求 Type 参数的方法）。因为我有一个类似的问题，你问了一个例子，这里有一个：

```
public IEnumerable<YourType> RetrieveData(string tableName, string name)
        {
            string sql = string.Format("Select * FROM {0} where Name = '{1}'", tableName, name);

            var result = YourDataContext.ExecuteQuery(typeof(YourType), sql);

            return result;
        } 
```

请注意，`YourType`因为您必须定义一个具有构造函数的类型（它不能是抽象或接口）。我建议您创建一个与您的 SQL 表具有完全相同属性的自定义类型。如果您这样做，ExecuteQuery 方法将自动将表中的值“注入”到您的自定义类型。像那样：

```
//This is a hypothetical table mapped from LINQ DBML

[global::System.Data.Linq.Mapping.TableAttribute(Name="dbo.ClientData")]
    public partial class ClientData : INotifyPropertyChanging, INotifyPropertyChanged
    {
private int _ID;

        private string _NAME;

        private string _AGE;
}

//This would be your custom type that emulates your ClientData table

public class ClientDataCustomType 
    {

        private int _ID;

        private string _NAME;

        private string _AGE;
} 
```

因此，在前一个示例中，ExecuteQuery 方法将是：

```
var result = YourDataContext.ExecuteQuery(typeof(ClientDataCustomType), sql); 
```

# svn - TortoiseSVN：是什么导致灰色复选标记？

> ID：543641
> 
> 赞同：5
> 
> 时间：2009-02-12T22:07:02.050
> 
> 标签：svn, tortoisesvn

让我先解释一下我们的设置：

我正在与一些承包商合作。他们正在使用 Visual Source Safe 进行源代码控制，而我们公司正在使用 Subversion。每隔几天，他们就会通过以下步骤检查我们的存储库：

1.  从我们的存储库中签出（他们是唯一在处理它的人，所以这实际上并没有做任何事情）
2.  将所有应用程序文件复制到目录中
3.  回馈

这是一个可怕的过程，我们计划在下一次迭代中解决它，但它确实有效。除了有时它没有。有时在他们提交之后，一些文件有一个灰色的复选标记覆盖。

我不确定这意味着什么。谷歌搜索意味着它可能与锁定有关，但没有人明确锁定任何东西！这些文件似乎已提交，但是当我签出时它们丢失了。我确信我错过了一些东西。

谁能解释发生了什么以及如何解决它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-12T22:12:37.590

从[这里](http://tortoisesvn.net/node/138)：

如果你在一个文件上设置了 svn:needs-lock 属性，Subversion 会将该文件设为只读，直到你获得对该文件的锁定。只读文件具有此叠加层，表明您必须先获得锁定才能编辑该文件。

我们在这里不使用需求锁定的东西，所以我无法解释更多。虽然这是一个开始。

编辑：由于它们使用 VSS，因此在未签出文件时，它们将具有只读属性集。TortoiseSVN 可能将其解释为设置了需求锁定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T22:11:12.693

这些是设置了 svn:needs-lock 属性的文件。要编辑这些文件，您首先必须锁定它们。

以下是 TortoiseSVN 帮助文件中的解释：

> 如果你在一个文件上设置了 svn:needs-lock 属性，Subversion 会将该文件设为只读，直到你获得对该文件的锁定。此类文件具有此叠加层，表明您必须先获得锁定才能编辑该文件。

这通常用于在多人编辑时不易合并的二进制文件（图像、word 文档等）。锁定可防止文件一次可以由多个人编辑。

如果要删除 svn:needs-lock 属性，则右键单击该文件，选择 TortoiseSVN -> 属性并删除该属性。

**更新**：什么会导致文件具有 svn:needs-lock 属性：

*   要么是有人明确设置的
*   或者你在 subversion 配置文件中有一些规则（TortoiseSVN -> 设置 -> 编辑 subversion 配置文件）。检查该文件的 [auto-props] 部分。例如，我们通过将相应的文件扩展名添加到 subversion 配置文件的 [auto-props] 部分来自动设置所有 MS-Office 文件的需求锁定属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T22:14:47.630

这可能有帮助吗？

[http://www.nabble.com/Document-locked,-won%27t-release-td15162692.html](http://www.nabble.com/Document-locked,-won%27t-release-td15162692.html)

设置了只读属性。

他们可能需要纠正这一点。

并且绝对强迫他们使用你的版本控制系统

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T22:42:53.540

如果你要继续这个可怕的计划，我可以建议你调查[svn_load_dirs](http://svn.collab.net/repos/svn/trunk/contrib/client-side/svn_load_dirs/)脚本吗？它用于将非版本化目录层次结构的更改应用到 SVN 存储库。在这种情况下，您的非版本控制文件实际上来自 VSS，但这并不能算作为此目的的版本控制。基本上，它会注意到添加的内容和删除的内容，让您有机会告诉它其中一些添加/删除实际上是重命名/移动，然后它将更改应用于您的存储库。这比仅仅将文件粘贴到工作副本上要好得多，因为后一种方法无法正确处理添加/删除的文件或目录。

要回答您的原始问题，灰色复选标记表示该文件是只读的。这通常只在需要锁定文件才能写入文件时遇到，但我很确定它会用灰色复选标记标记任何只读文件，而不仅仅是那些设置了 svn:needs-lock 的文件. 至于为什么在您签出时文件不会显示，这几乎可以肯定是因为它们从未被签入......如果它们在服务器中，它们会在您更新/签出时显示在您的工作副本中（或者它会给你一个关于阻碍他们的东西的明确错误信息）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T22:13:05.763

我用谷歌搜索了一下，显然文件被锁定了。[http://tortoisesvn.net/node/138](http://tortoisesvn.net/node/138)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T22:13:06.857

那些是二进制文件吗？如果是这样，则意味着文件在服务器上是锁定独占的，因此没有人可以同时检出它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T12:01:48.920

为了向您显示文件和文件夹图标覆盖，TortoiseSVN 必须在您每次在资源管理器中打开此类文件夹时获取状态。这通常需要几分之一秒，但如果您的硬盘速度较慢或目录非常大，则可能需要更长的时间。以下是一些需要注意的事项： 网络驱动器的响应速度可能非常慢，因此您可能必须关闭此类驱动器的图标覆盖。但是，缓存方案通常使其可行。每当一个文件的最后修改时间改变时，TortoiseSVN 需要对该文件做一个完整的差异（！）来确定它是否已经改变。如果您经常更改文件，请撤消更改并再次保存文件，您会遇到浏览速度变慢的情况。您可以通过清理工作副本文件夹来解决该问题。周围有几个病毒扫描程序会干扰 TortoiseSVN。大多数情况下，他们将文件锁定在 .svn 状态目录中，这会导致 TortoiseSVN 挂起或变得非常慢。有时您甚至可能会收到拒绝访问错误。尝试配置您的病毒扫描程序，使其忽略 .svn 目录。如果您使用的是 Windows XP，那么您还可以禁用 zip 文件夹。这也将提高浏览速度。1.从开始菜单中选择运行 2.在提示符下键入 regsvr32 /u %windir%\system32\zipfldr.dll 并单击确定 3.更改将立即生效，但您可能需要重新启动 Windows 才能查看所有痕迹内置 ZIP 支持消失。如果您希望在任何时候重新启用 Windows XP 的内置 ZIP 支持，只需按照以下步骤操作： 4.从开始菜单中选择运行 5.在提示符处键入 regsvr32 %windir%\system32\zipfldr.dll 并点击确定 6。更改将立即生效，但您可能必须重新启动 Windows 才能使用内置 ZIP 支持的所有痕迹。检查您的系统是否存在间谍软件、策略执行软件或本地搜索引擎（如 Google 桌面）。这些都会非常有效地干扰正常使用。

# wcf - 如何防止 .NET 实体中的私有属性通过服务公开？

> ID：543644
> 
> 赞同：3
> 
> 时间：2009-02-12T22:07:05.480
> 
> 标签：wcf, entity-framework

我正在创建一个 WCF 服务，用于传输通过实体框架创建的实体对象。我有一个映射到用户数据库表的用户实体。我不想向客户端公开某些用户字段（密码、日期创建等），但由于它们在数据库中不可为空，因此 Visual Studio 需要映射。将这些属性设置为私有似乎是一个很好的解决方法，但这些属性在被客户端使用时会转换为公共。

有没有办法解决这个问题，或者采取更好的方法？我宁愿避免在数据库级别更改这些字段只是为了让 EF 满意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T23:31:32.190

这听起来像是隔离应用程序层的绝佳机会。您应该做的是创建特定于 WCF 层的对象，这些对象仅充当外部消费者的数据传输对象 (DTO)。

因此，在您的 WCF 服务层中，您将对检索用户对象的数据访问层（实体框架）进行调用，并且您应该返回仅使用您想要公开的内容构建的消费者对象。

如果您这样做，您可以明确控制您对外界可见的内容，还可以从数据存储的角度隐藏有关您正在执行的操作的任何实现细节。

作为一个非常粗略的示例，在您的实体框架层中，您可能有这个对象：

```
namespace ACME.DataAccessLayer.Entities
{
    public class User
    {
        public int Id { get; set; }

        public string UserName { get; set; }

        public string Password { get; set; }

        public string Hash { get; set; }

        public string FirstName { get; set; }

        public string LastName { get; set; }
    }
}

namespace ACME.DataAccessLayer.Services
{
    using ACME.DataAccessLayer.Entities;

    public class UserService
    {
        public User GetUser(int id)
        {
            using (ACMEDataContext dc = new ACMEDataContext())
            {
                // psuedo code to return your user with Entity Framework
                return dc.Users.FirstOrDefault(user => user.Id == id);
            }
        }
    }
} 
```

然后在你的 WCF 中，你可能会有一个像这样的实体：

```
namespace ACME.Services.DataTransferObjects
{
    [DataContract]
    public class User
    {
        [DataMember]
        public int Id { get; set; }

        [DataMember]
        public string FirstName { get; set; }

        [DataMember]
        public string LastName { get; set; }
    }
}

Then you would expose a service endpoint that would return back the DTO as such:

namespace ACME.Services
{
    using ACME.DataAccessLayer.Services;

    public class PublicWCFService : IUserService
    {
        public ACME.Services.DataTransferObjects.User GetUser(int userId)
        {
            ACME.DataAccessLayer.Entities.User entityFrameowrkUser = new UserService().GetUser(userId);

            return new ACME.Services.DataTransferObjects.User
                       {
                           Id = entityFrameowrkUser.Id,
                           FirstName = entityFrameowrkUser.FirstName,
                           LastName = entityFrameowrkUser.LastName
                       };
        }
    }
} 
```

现在您要做的只是返回 DTO 对象，该对象不具有您在系统中使用的真实实体中可能拥有的任何属性或方法。

使用这种方法，您可以安全地将应用程序的层分解为可以轻松共享和扩展的不同层 (DLL)。

这是一个简单的示例，如果有任何进一步的内容可以使这个示例更加清晰，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T22:30:34.410

您总是可以[`IXmlSerializable`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)在实体对象上实现。然后，您将能够规定发送给客户端的内容的结构（显然，客户端将获得不同的表示形式）。

或者，如果可以的话，将[`DataContract`属性](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractattribute.aspx)添加到类型中，并将[`DataMember`属性](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datamemberattribute.aspx)添加到您希望通过网络发送的属性。

# perl - 如何在 Perl 的嵌套列表运算符中区分 $_？

> ID：543645
> 
> 赞同：20
> 
> 时间：2009-02-12T22:07:15.950
> 
> 标签：perl, arrays, map

使用嵌套数组操作来实现算法通常很有用。例如，要查找列表中以每个给定字符开头的单词数，您可以在 Python 中执行以下操作：

```
>>> a = ["foo","bar","baz"]
>>> map(lambda c: len(filter(lambda w: w.startswith(c), a)), ('a','b','c','d','e','f'))
[0, 2, 0, 0, 0, 1] 
```

在表达式`w.startswith(c)`中，区分两个循环迭代变量很简单`w`，`c`因为它们具有不同的名称。

在 Perl 中，我想做这样的事情：

```
@a = ("foo", "bar", "baz");
map length(grep $_ =~ /^$_/, @a), ('a','b','c','d','e','f') 
```

但是，这样做的一个明显问题是，`$_`它只涉及*最内层* `grep`的迭代变量（适用于`$_`左侧），而不是最外层的迭代变量（适用`map`于`/^$_/`）。在 Perl 中避免这个问题的惯用方法是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-12T22:22:18.690

只需分配给局部变量：

```
@a = qw(foo bar baz);
map {my $ch = $_; scalar grep $_ =~ /^$ch/, @a} qw(a b c d e f) 
```

# java-me - 是否可以在 j2me 中将数据作为后台进程上传？

> ID：543652
> 
> 赞同：3
> 
> 时间：2009-02-12T22:08:49.800
> 
> 标签：java-me, network-programming, midp, cldc

即使网络连接不佳？

具体来说，我编写的代码会启动一个单独的线程（来自 UI），该线程尝试通过 HTTP POST 上传文件。但是，我发现，如果连接不好，处理器会卡在 outputstream.close() 或 httpconnection.getheaderfield() 或任何强制数据通过网络的读/写上。这不仅会导致线程卡住，还会窃取整个处理器，因此甚至用户界面也会变得无响应。

我试过降低线程的优先级，但无济于事。

我的理论是没有简单的方法可以避免这种行为，这就是为什么所有 j2me 教程都指示开发人员创建一个“通过网络发送数据……”屏幕，而不是仅仅在后台线程中发送所有内容。如果有人能证明我错了，那就太好了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T23:06:02.440

这在很大程度上取决于您如何编写代码以及在何处运行它。在 CLDC 上，线程的概念非常有限，如果任何线程正在执行一些持久的操作，其他线程也可能（并且通常是）被它阻塞。在设计应用程序时，您应该考虑到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T23:50:20.430

一个重要方面是你需要有一个通用的 UI 或屏幕，当后台网络调用失败时可以显示。这对于任何移动应用程序、J2ME 或其他应用程序来说几乎都是必须的。

正如 Honza 所说，这取决于设计，有很多事情可以做，比如在应用程序启动时预取数据，或者根据加载的屏幕（即导航路径）预取数据，或者有一个应用程序内置的默认数据集等。

您可以尝试的另一件事是内置计时器机制，可在一定时间后重试数据下载，并在 5 次尝试或 1-2 分钟后中止并显示通用屏幕或错误消息。

J2ME 中的某些手机允许检测飞行模式，如果可能的话，您可以检测到并迅速显示适当的屏幕。

还有一个对我有用的设计是同步 UI 和网络线程，这样它们就不会相互锁定（请用大量盐来接受这个建议，因为我在一些三星和三洋手机上遇到了很多有趣的错误，因为这个的）

总而言之，对你没有好的答案，但不同的策略。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T19:09:29.653

您可以将文件数据分成块，然后在失败时重试多次上传。这取决于您的应用策略。如果您的首要任务是上传批量数据而不会失败。您需要在服务器上组装块来构建您的数据。这可能会产生建立连接的开销，但您的数据被上传的可能性很高。如果您不同时上传文件，这将很容易。

# .net - 有什么简单的方法可以将 Criteria 转换为 HQL？

> ID：543656
> 
> 赞同：14
> 
> 时间：2009-02-12T22:09:40.123
> 
> 标签：.net, asp.net, nhibernate, hql, criteria

几天前，我发布了一个[关于使用 Criteria API 查询集合的问题，在所有答案之后，我发现我正在尝试的事情对于 Criteria 是不可能的，在 nhibernate 和 hibernate 中的情况都有一个错误](https://stackoverflow.com/questions/534572/querying-on-collection-with-nhibernate-criteria-api)

我正在使用 DetachedCriteria 将所有标准放在一起，并且列表真的很长。最后一圈链是错误的标准，所以我需要将我所有的 detachedcriteria 更改为 HQL。

所以我的问题是是否有任何工具或方法可以将 Criteria 转换为 HQL。

或者

有没有办法让 Criteria 和 Hql 一起工作？

[关于 nhibernate 中的 bug 的文章](http://derek-says.blogspot.com/2008/06/duplicate-association-path-bug-in.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T03:45:44.810

*从休眠论坛重新发布...不确定它是否与休眠相关或最新*

* * *

***来自：* max Hibernate Team**

*发布时间：2006 年 12 月 24 日星期日上午 7:12*

这是一个非常顽固的民间传说，标准转化为 HQL。Criteria 直接转到 SQL，但没有直接的公共 api 以编程方式获取它。

...

翻译两次效率不高；）

[http://forum.hibernate.org/viewtopic.php?t=968990&view=next&sid=50454aa6cec8d482198117fbd398ca70](http://forum.hibernate.org/viewtopic.php?t=968990&view=next&sid=50454aa6cec8d482198117fbd398ca70)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T11:39:48.650

**我已经就这个问题向Ayende Rahien**发送了一封电子邮件，并感谢他的回复。他说

*答案是没有这样的工具，但转换通常很容易。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-10T20:15:06.977

我已经修改了 Hibernate Criteria API 以通过尝试保留最相似的接口来生成 JPQL 查询。我的项目名称是 Criteria2JPQL，位于：

[https://sourceforge.net/projects/criteria2jpql/](https://sourceforge.net/projects/criteria2jpql/)

由于此转换是生成标准 JPQL 查询的简单内存操作，因此不存在相当大的性能问题。另一方面，这个项目的想法源于 Hibernate Critera 性能不佳的本地 sql 查询，包括许多不必要的连接。我们曾在我公司的项目中使用过 Criteria2JPQL，并观察到那些不必要的连接消失了。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-13T15:17:39.623

您使用的是哪个版本的 nHibernate？我认为使用最新版本可能会解决您的问题，因为 2.0 GA 有很多重大更改。

# entity-framework - 如何将 2 个以上的实体映射到 .NET Entity Framework 中的同一个表？

> ID：543660
> 
> 赞同：3
> 
> 时间：2009-02-12T22:10:51.633
> 
> 标签：entity-framework

我正在尝试创建 2 个实体，它们在同一个基础数据库表上作为不同视图运行。当我在 Visual Studio 的实体模型中创建这些并在它们之间放置关联时，我收到“关联未映射”错误。我读了一篇文章（[http://blogs.msdn.com/adonet/archive/2008/12/05/table-splitting-mapping-multiple-entity-types-to-the-same-table.aspx](http://blogs.msdn.com/adonet/archive/2008/12/05/table-splitting-mapping-multiple-entity-types-to-the-same-table.aspx)），它描述了如何在 edmx 中手动编码 XML 以添加引用约束，但这对我没有任何帮助。

有什么想法吗？设计师不支持吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-11T21:09:34.213

从错误中，我猜想没有为 edmx 中的存储模式创建关联（edmx XML 的 SSDL）。如果您可以在设计器中看到它，则已经创建了一个概念关联，但在幕后没有存储定义。我猜。=)

# web-applications - 需要媒体共享网络应用程序，按组控制访问

> ID：543672
> 
> 赞同：0
> 
> 时间：2009-02-12T22:12:57.357
> 
> 标签：web-applications, video, audio, media, flash

我正在尝试寻找一个好的媒体共享网络应用程序。可以让教师轻松上传音频或视频文件的东西。而且我需要让只有班上的学生才能访问这些文件。

我尝试过PHPMotion，它对于上传和共享部分非常有用，但它是一种与所有人共享文件的方式。我需要限制组访问。

这是我的愿望清单：

> 基于网络。
> 
> 开源或廉价
> 
> 灯
> 
> Flash播放器。
> 
> 自动转换为 FLV
> 
> 易于非技术人员上传文件（FTP 太复杂的人）
> 
> 容纳流媒体大文件，不是直播而是让用户跳到中间而无需下载整个文件。
> 
> 能够按组限制访问。
> 
> 允许将媒体下载到便携式设备上。
> 
> LDAP 身份验证
> 
> 播放器的简单 HTML 嵌入

我知道我想要一切。

PHPMotion 是迄今为止我发现的最接近的东西。它很容易上传并转换为 FLV。我想我可以通过一些访问控制来破解它，但我宁愿不这样做。

有人知道可以使用组处理媒体文件共享的 wiki 风格吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-25T19:50:13.163

PHPMotion 可能是我能找到的最接近的东西。

最后，我们使用了 Adob​​e Flash Media Server，我们将编写自己的访问控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T23:30:32.827

.

您确实忘记了“256 位加密” :) :) :)

如果您知道在 Youtube 上您可以拥有：

“私人”模式。
“不公开”模式。

或两者

还有一种方法可以让他们上传
到/通过您的网站（到 Youtube），而不需要他们去 Youtube 本身。
无法记住正确的术语...检查 Youtube 开发人员和 api 页面。

Youtube 将满足您的大部分其他要求。

我看到您选择 Flash...据您所知，iPhone、iPad 不支持 Flash
，因此您还需要至少一种格式。Youtube 同时使用 Flash 和 Html5，它将为您创建（在线/自动）多达 6 个版本的视频，并根据访问者的浏览器或设备提供正确的版本。

.

# upgrade - 何时升级库

> ID：543680
> 
> 赞同：1
> 
> 时间：2009-02-12T22:13:33.343
> 
> 标签：upgrade

我在日常任务中使用了很多开源库（java FYI）。当一个项目接近成熟时，许多库已经发布了更新的版本。人们通常升级只是为了升级，还是等到你看到一个特定的错误？发行说明通常会说诸如“改进的性能和内存管理”之类的东西，所以我不确定是否值得潜在地破坏某些东西。但另一方面，大多数库都努力并声称在发布新版本时不会破坏任何东西。

你对此持什么立场？我承认，我有点沉迷于升级库。通常，它确实有助于提高性能并使事情变得更容易。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T22:16:39.203

我们的规则是在集成测试之前保持最新，但一旦我们超过这一点，就不允许对任何库进行更改。当然，如果集成测试揭示了由于已修复库的问题而导致的缺陷，那么我们会返回并更新。幸运的是，我不记得发生这种情况的情况。

更新：我理解 Philuminati 关于在你有理由之前不要升级的观点。但是，我是这样想的：我不断地改进自己的代码，并使用由我认为有相同想法的人构建的库。我会不使用自己改进的代码吗？嗯，不。那么为什么我不能使用其他人改进的代码呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T22:15:12.967

我保留有效的方法，直到有升级的*理由。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T22:18:07.030

如果有关旧版本的信息出现在[secunia](http://secunia.com/)或[securityfocus](http://www.securityfocus.com/)上...

否则 - 如果需要新功能（更好的性能也是“功能”）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T22:20:50.160

我和懒惰的人群在一起——我不记得曾经制定过与“有理由升级”不同的策略——但现在我考虑了这个问题，关于主动升级有话要说。

升级确实使您更容易报告库中的错误，如果您找到了。如果您发现了一个错误并且*尚未*升级，那么在您获得任何帮助或支持之前，这是您必须要做的第一件事。你不妨主动去做。

尤其是如果你有一个好的测试套件，主动升级会及早解决问题，这总是一个聪明的举动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T22:18:28.543

这在很大程度上取决于您的部署。如果您支持多个平台，那么最新的库可能在任何给定时刻都不可用。尝试安装需要某些库的最新版本的东西时，我感到很沮丧，而且它还不能作为一个包提供。

如果您部署给客户，您希望针对稳定且广泛可用的库进行开发。

# c++ - #将所有 .cpp 文件包含在一个编译单元中？

> ID：543697
> 
> 赞同：77
> 
> 时间：2009-02-12T22:17:02.900
> 
> 标签：c++, visual-studio, build

我最近有理由使用一些具有通常调试和发布配置的 Visual Studio C++ 项目，以及我以前从未见过的“全部发布”和“全部调试”。

事实证明，项目的作者有一个 ALL.cpp，其中 #includes 所有其他 .cpp 文件。*All 配置只是构建这个 ALL.cpp 文件。它当然被排除在常规配置之外，并且常规配置不会构建 ALL.cpp

我只是想知道这是否是一种常见的做法？它带来什么好处？（我的第一反应是闻起来很臭。）

你可能会遇到什么样的陷阱？我能想到的一个是，如果您的 .cpp 中有匿名名称空间，它们不再是该 cpp 的“私有”，但现在在其他 cpp 中也可见？

所有项目都构建 DLL，因此在匿名命名空间中存储数据不是一个好主意，对吧？但是功能可以吗？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-02-12T22:28:25.633

它被一些人（和谷歌）称为“Unity Build”。它的链接速度非常快，编译速度也相当快。它非常适合您不需要迭代的构建，例如来自中央服务器的发布构建，但它不一定适用于增量构建。

这是一个需要维护的 PITA。

编辑：这是获取更多信息的第一个谷歌链接：http: [//buffered.io/posts/the-magic-of-unity-builds/](http://buffered.io/posts/the-magic-of-unity-builds/)

使它快速的事情是编译器只需要读取一次所有内容，编译出来，然后链接，而不是对每个 .cpp 文件都这样做。

Bruce Dawson 在他的博客上对此有更好的描述：[http ://randomascii.wordpress.com/2014/03/22/make-vc-compiles-fast-through-parallel-compilation/](http://randomascii.wordpress.com/2014/03/22/make-vc-compiles-fast-through-parallel-compilation/)

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2014-03-16T23:41:28.693

Unity 构建提高了构建速度主要有三个原因。第一个原因是所有的共享头文件只需要解析一次。许多 C++ 项目有很多头文件，大多数或所有 CPP 文件都包含这些头文件，而对这些文件的冗余解析是编译的主要成本，尤其是在您有很多短源文件的情况下。预编译的头文件可以帮助降低成本，但通常有很多头文件没有预编译。

统一构建提高构建速度的下一个主要原因是编译器被调用的次数更少。调用编译器需要一些启动成本。

最后，冗余头解析的减少意味着内联函数的冗余代码生成减少，因此目标文件的总大小更小，这使得链接更快。

Unity 构建还可以提供更好的代码生成。

由于减少了磁盘 I/O，Unity 构建速度*并不快。*我用 xperf 分析了许多构建，我知道我在说什么。如果您有足够的内存，那么 OS 磁盘缓存将避免冗余 I/O - 标头的后续读取将来自 OS 磁盘缓存。如果您没有足够的内存，那么统一构建甚至可能会导致编译器的内存占用超过可用内存并被分页，从而使构建时间变得更糟。

磁盘 I/O 很昂贵，这就是为什么所有操作系统都积极缓存数据以避免冗余磁盘 I/O。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-12T22:35:02.887

我想知道 ALL.cpp 是否试图将整个项目放在一个编译单元中，以提高编译器优化程序大小的能力？

通常一些优化只在不同的编译单元内执行，例如删除重复代码和内联。

也就是说，我似乎记得最近的编译器（微软的、英特尔的，但我认为这不包括 GCC）可以跨多个编译单元进行这种优化，所以我怀疑这个“技巧”是不必要的。

也就是说，很想知道是否确实有任何区别。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-09T15:13:46.017

我同意布鲁斯的观点；根据我的经验，我曾尝试为我的一个 .dll 项目实施 Unity Build，该项目包含大量标头和大量 .cpp；为了降低 VS2010 上的整体编译时间（已经用尽了增量构建选项），但我没有减少编译时间，而是内存不足，构建甚至无法完成编译。

但是要补充；我确实发现在 Visual Studio 中启用多处理器编译选项非常有助于减少编译时间；我不确定其他平台编译器是否可以使用这样的选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-05T21:30:55.050

除了 Bruce Dawson 的[出色回答](https://stackoverflow.com/a/22444654/3162383)之外，以下链接还为统一构建的优缺点带来了更多见解 - [https://github.com/onqtam/ucm#unity-builds](https://github.com/onqtam/ucm#unity-builds)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-28T17:24:19.970

我们有一个适用于 MacOS 和 Windows 的多平台项目。我们有很多大型模板和许多要包含的标题。我们使用预编译头文件将 Visual Studio 2017 msvc 的构建时间减半。对于 MacOS，我们尝试了几天来减少构建时间，但预编译头文件仅将构建时间减少到 85%。使用单个 .cpp 文件是一项突破。我们只需使用脚本创建此 ALL.cpp。我们的 ALL.cpp 包含一个包含我们项目的所有 .cpp 文件的列表。我们使用 XCode 9.0 将构建时间减少到 30%。唯一的缺点是我们必须为 .cpp-Files 中的所有私有未命名编译单元命名空间命名。否则本地名称会发生​​冲突。

# apache - 虚拟主机指向另一个虚拟主机

> ID：543699
> 
> 赞同：1
> 
> 时间：2009-02-12T22:17:09.107
> 
> 标签：apache, virtual, host, httpd.conf

**帮助！**我刚刚为两个流量很大的站点设置了一个虚拟主机，我想我只是搞砸了一些事情！这是我的**httpd.conf**的结尾：

```
NameVirtualHost *
<VirtualHost *>
ServerName www.mydomain.com
DocumentRoot /var/www/html
</VirtualHost>

<VirtualHost *>
ServerName www.mydomain2.com
DocumentRoot /var/www/downloadr
</VirtualHost>

<VirtualHost *>
ServerName mydomain2.com
DocumentRoot /var/www/downloadr
</VirtualHost> 
```

我添加了最后一个虚拟主机来解决mydomain2.com去www.mydomain.com的问题。然而，现在发生的事情是 www.mydomain2.com 转到 www.mydomain.com。

请帮忙！！！

谢谢大家

## 更新

无法言喻的愚蠢 - 设法将一个站点复制到两个目录，因此 2 个域指向同一个地方！天哪，这不会再发生了。仔细检查再检查再检查再检查再检查再检查再检查......

顺便说一句，为什么有人会为此否定我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T22:22:47.457

而不是添加第三个虚拟主机，添加

```
ServerAlias mydomain2.com 
```

到第二个。所以你的整个配置基本上是这样的：

```
NameVirtualHost *
<VirtualHost *>
    ServerName www.mydomain.com
    DocumentRoot /var/www/html
</VirtualHost>

<VirtualHost *>
    ServerName www.mydomain2.com
    ServerAlias mydomain2.com
    DocumentRoot /var/www/downloadr
</VirtualHost> 
```

如果您希望将请求`mydomain.com`实际重定向到`www.mydomain.com`，以便用户在他/她的浏览器中看到 URL 更改，可以这样做`mod_rewrite`（但这是另一个问题的主题，如果您愿意，请搜索它）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T09:17:13.977

我也遇到了这个问题，事实证明，对于`ServerName`Apache 来说，不喜欢 www 前缀。所以它应该是这样的：

```
<VirtualHost *>
 ServerName mydomain2.com
ServerAlias www.mydomain2.com *.mydomain.com
DocumentRoot "c:/wamp/www" #WAMP INSTALL
</VirtualHost> 
```

# javascript - 使整个选项卡可点击

> ID：543703
> 
> 赞同：4
> 
> 时间：2009-02-12T22:17:50.837
> 
> 标签：javascript, html, css

我正在制作一个很大程度上依赖于选项卡式界面的模板，为了使其更直观，我想确保用户可以单击选项卡中的任意位置以激活它，而不是让单击选项卡内的文本。为了实现这一点，我目前正在这样做：

```
<div class="tab" onclick="javascript:window.location='http://example.com';">
    tab text
</div> 
```

对于我创建的所有标签。有没有人想与我/社区分享更有效的方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-12T22:23:59.450

如果你这样做会更容易访问：

```
<div class="tab">
    <a href="..." style="display: block;">tab text</a>
</div> 
```

设置`<a>`为`block`让它填充宽度，你可以给它高度、填充等，就像`<div>`. 你甚至可以`<div>`完全取消。

```
<a href="..." class="tab" style="display: block;">tab text</a> 
```

当然，你会添加`display: block;`，`.tab {}`但你明白了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T22:23:31.463

在语义和兼容性方面，用 CSS 修改 <a> 标记会更好，你可以尝试这样的事情：

```
a.tab { display:block; } 
```

然后还为此设置其他相关属性，如宽度/高度、背景颜色等。

然后你的 HTML 看起来像这样：

```
<a class="tab" href="http://example.com">tab text</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T22:27:04.747

将您的`a`标签设置为块级元素，并将标签填充放在链接上。例如，如果您有……</p>

```
<style type="text/css">
    div.tab {
        float: left;
        padding: 10px;
    }
</style>

<div class="tab"><a href="http://example.com">tab text</a></div> 
```

……然后改成这个……</p>

```
<style type="text/css">
    div.tab {
        float: left;
        padding: 0;
    }

    div.tab a {
        display: block;
        padding: 10px;
    }
</style>

<div class="tab"><a href="http://example.com">tab text</a></div> 
```

这将导致链接占据选项卡的整个“正文”，因此您可以单击它的任何位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T22:48:00.470

PPS：简短的回答是，您可以打开 A 标签以显示“阻止”模式，并添加任何填充，该填充将捕获点击。浮动元素 (float:left, float:right) 是一个隐含的“display:block”。“内联”元素（例如 SPAN）也使用填充来确定获取背景图像的区域；但不影响布局。

最简单的方法是这样的：

```
ul.tabs, ul.tabs li { float:left; margin:0; padding:0; list-style:none; }
ul.tabs li a { float:left; padding:4px 10px 4px; border:1px solid blue; border-bottom:none; margin-right:4px; }
.clear { clear:both; /* add width:100%; overflow:hidden; for IE6 pos */ }

<ul class="tabs">
    <li><a href="#">Lorem</a></li>
    <li><a href="#">Ipsum</a></li>
    ...etc...
</ul>
<div class="clear"></div> 
```

如果您为每个选项卡使用相同的宽度（取决于其中最长的文本），那么您甚至可以使用单个 gif 背景图像：

```
ul.tabs li a { /* same above + */ background:url(tab-bg.gif) no-repeat 50% 0; text-align:center; width:120px; } 
```

更高级、更经典的制作选项卡的方法可以适应不同的字体大小并且可以使用自定义图像来填充角落和填充是“滑动门”：

[http://www.alistapart.com/articles/slidingdoors/](http://www.alistapart.com/articles/slidingdoors/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T22:20:18.257

由于您正在打开一个新窗口，因此这与您将获得的效率差不多，除非您想将其放入一个函数中以缩短它以用于打字目的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T22:23:54.863

与其使用 <div/> 标签，不如使用具有适当样式的 <a/> 来匹配当前应用于 <div/> 的内容？这样你就可以使用锚的 href 属性而不是诉诸 JavaScript 来引导用户。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T22:25:38.387

正如 John Rasch 所提到的，为打字目的制作一个 javascript 函数可以帮助你，但也......不要让我思考！如果它是可点击的，用光标显示它：提交 css ！！！

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-12T22:26:17.510

怎么样：

```
<script type="text/javascript" src="jquery.js">
$(document).ready(function(){
   $(".tab").click(function(event){
     window.location='http://example.com';
   });
 });
</script>

...

<div class="tab">
tab text
</div> 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-05T03:40:33.443

有两种技术可以实现这一点

**内联 li + a** 和 **浮动 li + 块 a**

总结在这里

[http://www.pagecolumn.com/webparts/making_tabs_with_CSS.htm](http://www.pagecolumn.com/webparts/making_tabs_with_CSS.htm)

# ruby - 从 XSD 生成 Ruby 类

> ID：543709
> 
> 赞同：11
> 
> 时间：2009-02-12T22:18:40.557
> 
> 标签：ruby, xsd, xml-serialization

有没有办法从 XSD 生成 Ruby 类（甚至可能是 ActiveResource 类），以便它们包含一种将类序列化为对初始 XSD 有效的 xml 的方法？

我知道soap4r 有xsd2ruby，但似乎生成的ruby 类不能轻易地序列化为xml。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-14T01:11:27.403

无耻的自我推销（希望这在stackoverflow上没问题）但我正在开发一个开源项目来做到这[一点](http://github.com/movitto/RXSD)

它仍在进行中（请随意发送补丁），但最终目标是将 XSD 转换为/从 Ruby 类（现在可以）并将符合该 XSD 的 XML 转换为/从这些类的实例。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-03-31T17:28:13.627

尽管前一段时间有人问过这个问题，但我遇到了一个解决方案，并认为它可能对未来的人们有所帮助。

我的需要是相似的。我有一个同事的 .xsd，想从中生成一个类文件。我希望我能够轻松地编组对象并将其传递到他的 RESTful 端点，在那里他的 Java 服务器将解组有效负载并在他身边动态构建对象，而无需额外的努力。

我找到的解决方案是`soap4r`从[https://github.com/rubyjedi/soap4r](https://github.com/rubyjedi/soap4r)获取。我将 bin 目录中的两个 *.rb 文件设为可执行文件，然后运行：

```
bin/xsd2ruby.rb --xsd <source>.xsd --classdef <filename_prefix> 
```

这会生成一个新文件，每个文件都`xsd:complexType`作为一个类实现。所有其他复杂类型也使用正确的继承关系生成，并且都`xsd:element`被定义为实例变量，并且还定义了类初始化器。

自行运行`xsd2ruby.rb`会产生以下选项：

```
~/src/test/soap4r:bin/xsd2ruby.rb 
Usage: bin/xsd2ruby.rb --xsd xsd_location [options]
  xsd_location: filename or URL

Example:
  bin/xsd2ruby.rb --xsd myapp.xsd --classdef foo

Options:
  --xsd xsd_location
  --classdef [filenameprefix]
  --mapping_registry
  --mapper
  --module_path [Module::Path::Name]
  --force
  --quiet 
```

为了完整起见，我用以下内容扩展了我的课程（这是一个“Prospect”课程）：

```
class Prospect
  include Enumerable
  def each(&block)
    self.instance_variables.collect{|v| (v.gsub /@/, '').to_sym }.each(&block)
  end
end 
```

这让我可以将它用作`Net::HTTP::Post`请求的主体。

关于免费的问题`to_xml`：我还没有找到。ruby 对象带有一个开箱即用的`to_yaml`，`to_json`但我没有找到任何简单的到 XML 的转换。所以它归结为我自己的“to_xml”。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-13T18:27:45.297

看来这可能会奏效。

需要'xsd/mapping' XSD::Mapping.obj2xml(xsdBasedObject)

# design-patterns - 其他领域的哪些想法对程序员有用

> ID：543715
> 
> 赞同：1
> 
> 时间：2009-02-12T22:20:25.543
> 
> 标签：design-patterns

模式的概念起源于 1977 年的[建筑](http://en.wikipedia.org/wiki/A_Pattern_Language)

早在 1980 年代，TDD 的等价物就作为及时和全面质量的一部分被用于制造业

保罗格雷厄姆将[黑客和画家联系在一起而闻名](http://www.paulgraham.com/hp.html)

我的问题是，你最喜欢的想法和技术是什么，我们可以从其他领域使用。例如，我认为工程师对项目管理了解很多。

顺便说一句，这是与编程相关的......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T22:25:55.327

[粗略计算](http://en.wikipedia.org/wiki/Back-of-the-envelope_calculation)来自物理学和工程学，是一种有价值的软件工具。使用小而粗糙的原型也来自工程学。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T22:28:45.087

当涉及到应用程序设计，尤其是 UI 设计时，任何心理学知识总是有很大的帮助。我们制造的产品不仅仅是神奇的功能黑盒，它们是真正的人们需要使用和关联的“有形”工具。至少，这是一些很好的敏感性训练 :) 在你让它发挥作用的同时尽量减少用户的挫败感。

作为应用程序开发人员，写作也是一项非常有用的技能，即使您自己不一定会编写副本。能够在电子邮件、文档和演示文稿中清晰、简洁地传达您的意思会使工作变得更加容易，并且将有助于与那些您首先为之做这一切的非程序员建立交流。当用户和管理者敞开心扉时，困惑就会消失。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T22:29:14.507

好吧，显然数学极大地影响了编程——想想[约翰·冯·诺伊曼](http://en.wikipedia.org/wiki/John_von_Neumann)或[艾伦·图灵](http://en.wikipedia.org/wiki/Alan_turing)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T22:25:50.210

具有讽刺意味的是，你问的是同一领域的人——编程。

# flash - 将嵌套的影片剪辑分配给 Flash as2 中的多维数组

> ID：543721
> 
> 赞同：0
> 
> 时间：2009-02-12T22:21:26.990
> 
> 标签：flash, arrays, dynamic, actionscript-2, movieclip

我有 5 个名为 row1、row2、...、row5 的影片剪辑。在每一行里面是动画剪辑let1、let2、...、let15。我想将所有字母剪辑分配给二维数组。这是对较早问题[Dynamically accessnested movie clips in flash actionscript 2](https://stackoverflow.com/questions/538133/dynamically-accessing-nested-movie-clips-in-flash-actionscript-2)的后续问题。

我正在尝试这个：

var letterClips:Array = [];

for(var i = 1; i <= 5; i++) {

```
letterClips[i] = new Array(16);

//var row:MovieClip = _root["row" + i];
//rowClips.push(row);

for ( var j = 1; j <= 15; j++) {

    var letter:MovieClip = _root["row" + i]["let" + j];

    letterClips[i].push(letter);

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T23:04:17.467

好吧，如果你使用

```
letterClips[i].push(letter); 
```

这将在数​​组末尾添加“字母”并增加其大小（增加 1）。因此它将开始在位置 16 添加“字母”电影，并继续添加 17、18、...

解决方案1：更换

```
letterClips[i] = new Array(16); 
```

和

```
letterClips[i] = new Array(); 
```

解决方案2：更换

```
letterClips[i].push(letter); 
```

和

```
letterClips[i][j] = letter; 
```

任何一个都应该工作。

PS 另请注意，由于您的索引*(i,j)*从 1 开始，因此您的*[0][j]*和*[i][0]*插槽将在您完成所有迭代时*未定义*。

# bash - 如何使用命令启动 Unix 屏幕命令？

> ID：543737
> 
> 赞同：25
> 
> 时间：2009-02-12T22:24:50.290
> 
> 标签：bash, unix, shell, command-line, gnu-screen

根据[Unix“屏幕”命令的文档](http://www.delorie.com/gnu/docs/screen/screen_12.html)，您可以在 .screenrc 中配置它以从一堆默认屏幕开始，每个屏幕都运行您指定的命令。

这是我的配置：

```
# Default screens
screen -t "shell_0"  1
screen -t "autotest" 2 cd ~/project/contactdb ; autotest 
```

它不会运行自动测试命令。当我开始时，我试图运行的那个窗口会`autotest`立即关闭`screen`。

我也试过了...

```
screen -t "autotest" 2 cd ~/project/contactdb 
```

结果相同。

我也试过...

```
screen -t "autotest" 2 ls 
```

那里也有同样的结果。

让它在启动时在给定屏幕中运行命令的秘诀是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-12T22:31:23.583

你的程序正在运行（好吧，除了 cd），只是它在没有父 shell 的情况下运行，所以一旦它完成，它就会退出，你就完成了。

你可以这样做：

```
screen -t "autotest" 2 bash -c 'cd ~/project/contactdb ; autotest' 
```

产生两个贝壳，但生活可能会继续。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-11-23T07:09:38.467

试试这个：

```
$ screen -S 'tailf messages' -d -m tailf /var/log/messages 
```

然后稍后您可以执行以下操作：

```
$ screen -ls
1234.tailf messages 
```

其次是：

```
$screen -r 1234 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-12T22:59:59.410

这可能会有所帮助，但可能并不完全是您想要的。

将“zombie az”或“defzombie az”作为 .screenrc 的第一行。“az”可以是您想要的任何 2 个键。现在，当一个屏幕应该关闭时（例如，命令执行完毕），它实际上并没有关闭；点击“a”将关闭它，点击“z”将重新执行附加到该屏幕的命令。

我在[屏幕上找到了用户手册](http://www.delorie.com/gnu/docs/screen/screen_134.html)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-15T23:10:45.623

您还可以将字符“填充”到屏幕中，就像您已键入它们一样。

以下是您可以使用示例执行此操作的方法：

```
 screen -t "shell_0"  1

# create the following screen in the desired dir, instead of cd-ing afterwards :)
chdir ~/project/contactdb
screen -t "autotest" 2

# (without this sometimes screens fail to start correctly for me)
sleep 5

# paste some text into screen number 2:
select 2
stuff "autotest\012" 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-12T23:21:55.350

这是我的样子。它似乎工作正常。我认为括号可能会导致问题，或者如果命令“autotest”不存在，屏幕将不会打开窗口。

> ```
> screen -t zsh 1
> screen -t emacs 2 emacs -nw
> screen -t mutt 3 mutt
> monitor on
> screen -t mc 4 mc -s
> screen -t elinks 4 elinks 
> ```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-20T18:18:44.180

这就是我的做法。

```
screen -t shell_0
chdir ~/project/contactdb
screen -t autotest autotest 
```

以上似乎是通过屏幕程序评估的。首先我们建立一个带有标题的新画面`shell_0`。由于我们没有提供其他选项，因此当前工作目录将是父 shell 或用户主目录的工作目录。然后我们将新屏幕的默认目录设置为`~/project/contactdb`. 接下来，我们建立一个运行`autotest`命令的新屏幕。

窗口编号（`n`）是可选的，我一般省略它。

# vim - 转到 vim 中的字符

> ID：543738
> 
> 赞同：283
> 
> 时间：2009-02-12T22:24:57.280
> 
> 标签：vim

我收到来自 python 脚本的错误消息`at position 21490`。

我怎样才能在 Vim 中担任这个职位？

* * *

## 回答 #1

> 赞同：445
> 
> 时间：2009-02-12T22:28:48.720

`:goto 21490`将带您到缓冲区中的第 21490 个字节。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2013-09-29T02:40:57.553

`vim +21490go script.py`

从命令行将打开文件并将您带到`21490`缓冲区中的位置。

像这样从命令行触发它允许您自动化脚本来解析异常消息并将文件打开到问题位置。

* * *

*摘自* `man vim`：

> ```
> +{command}
> 
> -c {command} 
> ```
> 
> `{command}`将在读取第一个文件后执行。 `{command}`被解释为 Ex 命令。如果 `{command}`包含空格，则必须用双引号括起来（这取决于所使用的外壳）。

# c# - 如何在 ToString() 中显示 1 而不是 01；

> ID：543750
> 
> 赞同：2
> 
> 时间：2009-02-12T22:26:19.477
> 
> 标签：c#, formatting, string

我正在使用格式 ToString("0,0") 来显示一个数字，例如

```
5000 为 5,000
```

但如果数字是 0 - 9，它会显示 01、02、03 等。有谁知道正确的语法，所以它不显示前导 0？

谢谢， XaiSoft

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-12T22:27:30.690

```
ToString("#,0") 
```

此外，[这](http://acodingfool.typepad.com/blog/dotnet-string-formatting-cheat-sheet.html)可能会进一步帮助您

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T22:33:10.303

您正在寻找的是字符串格式化程序“N0”。例子：

```
int x = 10000;
int y = 5;

Console.WriteLine(x.ToString("N0"));
Console.WriteLine(y.ToString("N0")); 
```

印刷：

```
10,000
5 
```

更多信息[在这里](http://msdn.microsoft.com/en-us/library/0c899ak8(vs.71).aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T22:30:50.947

```
ToString("N0") 
```

# asp.net - ASP.NET MVC UserControl 需要 css/javascript

> ID：543754
> 
> 赞同：1
> 
> 时间：2009-02-12T22:26:40.053
> 
> 标签：asp.net, javascript, asp.net-mvc, code-reuse

我有一个用户控件（用户详细信息表单），其中附加了很多 javascript 和 css。我正在努力使我的控件贴花它需要某个文件，因此它将包含在 html 的“head”部分中。

我也想知道如果我输入一个控件的多个实例会发生什么（不是 InamingContainer 或类似的东西）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T08:56:36.380

这可以使用[MvcScriptManager](http://www.codeplex.com/MvcScriptManager)轻松实现。希望这有帮助:)

# multicore - 你关心多核吗？

> ID：543755
> 
> 赞同：13
> 
> 时间：2009-02-12T22:26:52.190
> 
> 标签：multicore

这是不可否认的：多核计算机将继续存在。

这也是如此：高效的多核编程非常困难。这不仅仅是理解 pthread 的情况。

这是有争议的：“街上的开发商”需要关注这些发展。

您在多大程度上担心必须扩展您的多核技能组合？您正在编写的软件是否适合并行化，如果是，您是否正在做任何事情来教育自己（如果您还不知道这些技术）？或者您是否相信操作系统会处理大部分工作，语言运行时会尽其所能，您的应用程序会愉快地坐在一个内核上，让其他人做他们的事情？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-12T22:30:51.820

您*的*程序通常受 CPU 限制吗？

如果没有，那就忘记它。它与您无关，并为您的用户提供更流畅的体验，而不会对您提出任何要求。

酷，嗯？

如果您受 CPU 限制，并且您的问题是可并行化的，那么您也许可以利用多个内核。是时候开始担心它了。

* * *

从评论：

> 改进答案的建议：粗略解释如何判断您的程序是否受 CPU 限制。– 耳柳

*CPU 限制*意味着阻止程序运行得更快的原因是缺乏计算能力。与*IO 绑定*（或有时*网络绑定*）进行比较。主板和处理器的选择不当也可能导致机器受到*内存限制*（是的，我在看着*你*，alpha）。

因此，您需要随时了解您的程序在做什么（以及机器有多忙……）以了解在类似 unix 的系统上运行`top`. 在 Windows 上使用任务管理器（感谢 Roboprog）。

在每核负载少于 1 个的机器上（即您的台式机，当您不做任何事情时），受 CPU 限制的进程将始终拥有超过 50% 的处理器（通常超过 90%）。当平均负载高于此值时（即您有三个编译、SETI@home 和两个在后台运行的对等网络），CPU 绑定进程将有很大一部分`(# of cores)/(load average)`.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-13T00:03:23.563

附带说明：如果您的应用程序具有 GUI 并进行密集计算，则始终在单独的线程上进行密集计算。忘记这样做是 GUI 冻结的原因。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-21T05:06:20.187

我不同意当前接受的答案。

多核机器最重要的方面是**CPU 和主内存相距甚远**。这意味着除非应用程序是“令人尴尬的并行”或易于并行化，否则它很可能会受到内存限制，而不是 CPU 限制。**浮点乘法大约需要 4 个时钟周期，而从主存储器取内存需要数百个时钟周期**。因此，利用缓存局部性变得很重要。

对于难以并行化的应用，如果在单核上实现的性能足够（大部分应用属于此类），则不需要并行化。但如果不是（或者您的竞争对手的应用程序由于并行化而响应更快），那么您最好重构您的应用程序以更好地利用并行性和缓存局部性。模糊地说，重构的应用程序将由相对独立（或交流较少）的子模块组成，这些子模块并行运行（参见[这个例子](http://www.ddj.com/architect/199300100;jsessionid=DQMKUFTOWG4YQQSNDLPSKH0CJUNN2JVN?pgno=1)）。

请参阅[http://www.eecs.berkeley.edu/Pubs/TechRpts/2006/EECS-2006-183.html](http://www.eecs.berkeley.edu/Pubs/TechRpts/2006/EECS-2006-183.html)以获得有关多核和事物发展方式的良好概述。他们说的主要观点是：

*   **时钟速度不再像以前那样增加。**与少量快速处理器相比，制造更多数量更慢、更简单的内核更具成本效益。
*   **内存（越来越）远离 CPU**
*   几年后，Web 服务器中将有**1000 个内核**，台式机中将有 100 个内核。因此，计划将您的应用程序（可能是自动扩展）扩展到 100 或 1000 个内核。这意味着您应该创建几个独立的任务。
*   线程很难使用，因此**更好地使用“任务”**。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-12T22:31:44.563

这是开始学习函数式语言的一个很好的论据，函数式语言更容易针对并行执行进行优化。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-12T23:26:36.303

委婉地说，我认为这通常值得关注。

不用说，过去几十年 CPU 速度的大幅提升是非常有价值的，进一步的收益也同样有价值。

但从现在开始，这些收益将主要包括核心数量的定期翻倍。因此，为了从这些收益中受益，软件需要可并行化。

许多应用程序的许多计算密集型部分实际上是用 SQL 编写的，因此它们已经具备功能并且能够被 RDBMS 分解为并行任务。这样那些人就可以放心了。

但是我们这些主要用 C# 编写的人，即使我们正在编写 GUI，我们也需要密切关注这些东西。GUI 经常必须对它呈现给用户的任何模型执行一些有用的操作，当用户不得不坐下来等待它完成时，他们会感到恼火。几年后，当他们查看任务管理器并看到大约 3% 的新 32 核机器正在使用时，他们会更加恼火。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-21T00:11:47.600

是的，我也一直在用线程编程。但我还不够自虐，无法爱他们。不管你是多么的超人，再加上你从同事那里得到的任何帮助，线程之间的串扰仍然太容易了。线程很容易做，但很难正确地做，所以当然 Joe-Schmoe 很喜欢它，而且，它们很快！（当然，这才是最重要的）

在 *nix 上，旧的 fork() 仍然是处理许多事情的好方法。开销并不算太糟糕（是的，有一天我需要测量它来备份我的 BS），特别是如果你要分叉一个解释器，然后在子进程中生成一堆特定于任务的数据。

也就是说，我被告知，Windoze 上的子进程非常昂贵。因此，Erlang 方法看起来相当不错：强制 Joe Schmoe 编写纯函数并使用消息传递，而不是他看似无限状态的自动机全局（实例）变量 whack-fest 和额外的线程串扰盛会。

但我并不苦:-)

修订/评论：

其他地方关于记忆距离的优秀评论。我最近也一直在思考这个问题。标记和清除垃圾收集确实损害了正在运行的进程的“局部性”方面。旧 80286 上 0 等待状态 RAM 上的 M/S GC 可能看起来无害，但它确实对多级缓存架构造成伤害。也许在某些情况下引用计数 + fork/exit 并不是一个 GC 实现那么糟糕的主意？

* * *

编辑：我在这里努力支持我的演讲（结果各不相同）： [http ://roboprogs.com/devel/2009.04.html](http://roboprogs.com/devel/2009.04.html)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-13T00:13:58.187

我认为可能发生的情况是，一旦大量内核（比如 8 个以上）变得司空见惯，那么我们将看到开发利用并行性的应用程序，而这些应用程序在单线程世界中被认为是不可行的。

我想不出具体的例子，但想想当 3D 加速器变得普遍时发生了什么。当时的游戏（想想 Doom）受其软件渲染代码速度的限制。拥有高度详细的 3D 模型，甚至没有考虑模拟反射/折射和每像素照明。现在每个人都这样做。

因此，除非您当前的应用程序高度受 CPU 限制，否则我不会担心并行化它们。如果您发现通过多核拥有大量 CPU 能力，那么请寻找在新项目中利用它的方法。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-30T04:47:44.867

我认为这是一个很好的问题。所以，我在**[这里](http://blogs.msdn.com/pigscanfly/)开始了一系列关于它的博客文章。**

Dmckee 的回答在最狭义上是正确的。让我在这里用我自己的话改写一下，隐含地包括一些评论：

> 并行化不受 CPU 限制的操作没有任何价值。并行化仅在短时间内（例如，不到几百毫秒）受 CPU 限制的操作几乎没有价值。事实上，这样做很可能会导致程序更加复杂和错误。学习如何实现细粒度的并行是很复杂的，而把它做好也很困难。

就目前而言，这是正确的，但我相信对于更广泛的程序集来说答案会更丰富。事实上，在您的生产应用程序中使用多线程，然后隐含多核技术的原因有很多。例如，将磁盘和网络 I/O 操作移出用户界面线程对您的用户来说是一个巨大的好处。

这与增加计算绑定操作的吞吐量无关，与保持程序的用户界面响应有关。请注意，这里不需要图形用户界面 - 命令行程序、服务和基于服务器的应用程序也可以从中受益。

我完全同意进行 CPU 绑定操作并使其瘫痪通常是一项复杂的任务——需要细粒度同步、CPU 缓存、CPU 指令管道等知识。事实上，这在经典上可能是“困难的”。

但是，我认为很少需要这样做。需要这种细粒度并行性的问题并不多。是的！它们确实存在，*您*可能每天都在处理这个问题，但我认为在大多数开发人员的日常生活中，这非常罕见。

即便如此，仍有充分的理由学习多线程的基础知识，从而学习多核开发。

1.  通过将较长的操作移出消息循环线程，它可以使您的程序从用户角度更具响应性。
2.  即使对于不受 CPU 限制的事情，并行执行它们通常也很有意义。
3.  它可以将复杂的单线程状态机分解为更简单、更程序化的代码。

事实上，操作系统在这里已经为你做了很多，你可以使用支持多核的库（比如[Intel 的东西](http://software.intel.com/en-us/blogs/2008/11/07/speed-up-your-software-development-with-intel-performance-libraries/)）。但是，操作系统和库并不是魔法——我认为对于大多数开发人员来说，学习多线程编程的基础知识是很有价值的。这将让您编写更好的软件，让您的用户更满意。

当然，并不是每个程序都应该是多线程的或启用多核的。有些事情以简单的单线程方式实现就好了。所以，不要把这当作每个程序都应该是多线程的建议——在这里使用你自己的良好判断。但是，它通常是一种有价值的技术，并且在许多方面都非常有益。如上所述，我计划从[这里](http://blogs.msdn.com/pigscanfly/)开始写博客。如果您愿意，请随时关注并在那里发表评论

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-21T05:09:29.430

没门！我是 Clojure 程序员！:D

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-12T22:27:58.660

我已经用线程编程超过 15 年了。我一点也不担心

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-12T22:29:42.290

我不担心。这些概念并不太难，更多的开发人员编写多线程应用程序 = 更多关于该主题的材料 = 更容易弄清楚你需要什么。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-21T00:16:09.557

我认为对于大多数程序员和应用程序而言，显着多核并没有比标准多线程开发具有显着优势或潜力。大多数人都有线程来完成顺序作业，并且将这些线程拆分为更小的单元的可能性不大。

恕我直言，重要多核的大部分好处将来自对底层框架的改进（例如，数据库访问、IO、GUI 和 3D 工具包等），绝大多数开发人员将透明地受益。

此外，未来的静态分析工具可能会推荐可以进一步拆分为线程的片段。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-13T00:16:56.153

好吧，因为我在 ASP.Net 中进行 Web 开发，所以我可以看到多核在几个方面发挥作用：

1）客户端。如果有人想利用它来运行诸如对一长串数据进行排序之类的东西，那么如何为具有四核 CPU 的客户端优化诸如 Javascript 之类的东西。胖客户端会带着新版本的 IE、Firefox、Safari 和 Chrome 回来吗？

2) Web 服务器上的服务器端。在 IIS 和它使用的 .Net 框架中，PLINQ 之类的东西如何帮助使用并行或并发编程来帮助加快处理请求的速度？可以进行哪些 IIS 设置来增强性能并将其调整到硬件？

3) 中间件/数据库后端。最新的 MS-SQL Server 或 Oracle 或 MySQL 如何处理使用多核和多插槽的额外资源，例如，如果四插槽主板在每个插槽中都有四核 CPU，并且顶部有诸如超线程之类的东西，则有 32可以立即运行的线程，这与过去的单核 CPU 确实不同。

此外，对于 GPU 的多核方面还有一些话要说，其中 Crossfire 和 SLI 是开始，但现在有更多的混合图形解决方案，人们可​​能想知道将来如何利用它，例如 AMD 的 Fusion 是一个想法我不确定它会做得如何，但它是我最后一次听到的。

关于自我教育的主题，我不确定在某些情况下优化我的代码会有多大帮助。我更感兴趣的是 IIS 将如何尝试在它之前利用新的计算领域，因为这最终可能会限制一些可以完成的事情，即使我将我的代码隔离在它自己的小世界中运行。

这些只是我目前的想法，随时可能发生变化。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-21T01:45:28.233

不，我不担心。

我的工作有点不寻常，可能比平均水平更容易并行化，但无论如何我认为它更多的是机会而不是问题。

在某种程度上，我对事情发展到真正值得为多核进行优化的程度感到不耐烦。目前我不知道确切的数字是多少，但我们的客户似乎有一半拥有单核机器，49% 拥有双核，也许 1% 拥有四核。这意味着在大多数情况下，多线程并不能真正带来巨大的性能提升，因此不值得花太多时间在上面。

几年后，当平均水平可能是四核时，将有更多的理由花一些时间在聪明的多线程代码上——我认为这对我们开发人员来说将是一件好事。我们所需要的只是英特尔和 AMD 快点制造更多... :-)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-21T02:14:08.570

我的一位面向硬件的教授告诉我们（嗯，说教），这是计算机科学的一个非常重要的领域。更重要的是，它要么由操作系统解决（我注意到 Apple 的表现如此强劲，MS 可能也是如此），要么编码人员自己需要考虑并行执行（线程等）。

相当整洁的CS领域。:)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-21T03:54:10.797

作为一名独立游戏开发者，我实际上对此感到非常兴奋。有几款游戏在活动期间会受到 CPU 限制。而且几乎所有的现代 3D 游戏都对硬件要求很高。在过去的几年里，多核一直是视频领域的法律。现在有些 nvidia 卡有超过 200 个内核。

为这些卡编写着色器是一种乐趣，我迫不及待地想看看越来越多的机器是多进程的。

我认为随着时间的推移，这种需求将产生更好的线程支持。我们仍然有一些疯狂的方案，比如 apaches MPM-Worker 模型，您可以同时获得多个进程和线程的混合。我希望看到更好地采用诸如绿色线程之类的东西，它们似乎都在同一个进程中，但实际上分布在内核上。但当然，有人必须有一些关于共享内存的突破性想法才能实现这一目标。

近期：除非您破坏处理器，否则这没什么大不了的。长期：更好地使用锁:)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-21T04:11:01.130

[数据流编程](http://en.wikipedia.org/wiki/Dataflow_programming)显示出相对简单的多核问题解决方案的前景。

然而，正如维基百科所说，它需要一个相当大的范式转变，这似乎阻止了它被编程社区轻松采用。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-21T05:26:25.893

我一直在考虑的事情是，大多数分治算法不是可大规模并行化的吗？每个拆分都应该能够在两个单独的线程中运行......

无论如何，当我需要担心时，我会担心。当我的程序开始变慢时，我会寻找加快速度的方法。不幸的是，这*是*我工作中的一个问题。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-21T14:31:57.767

日常我对多核编程的思考不多，但它总是在我的雷达上。

我在并行处理中一直遇到的最大问题是确定应该并行化什么？分拆线程来后台处理文件很容易，但是文件处理本身可以并行化吗？

我认为什么可以并行化和应该并行化的问题可以通过复杂的架构决策来回答，这些决策通常位于应用程序已经复杂的架构决策之上。我相信这种复杂性将通过操作系统或编程语言来解决。在 C 及其后代中发现的传统并行化线程模型并不是最终的答案。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-06-15T05:46:12.460

不会。我觉得多核会在某些编程领域产生重大影响，但几乎不会影响其他领域。一段时间后，它所做的区域会吸收并封装它，而炒作几乎不会触及其他区域。

# html - 隐藏 DIV [Rails]

> ID：543760
> 
> 赞同：7
> 
> 时间：2009-02-12T22:28:08.457
> 
> 标签：html, ruby-on-rails, ajax

在 Javascript 中隐藏 DIV 很容易，但是有一些 Rails-y 方法可以做到吗？当然，我可以通过从部分 (.erb) 调用 Javascript 来考虑一些方法，但我宁愿根本不编写任何 Javascript。可能的？

**编辑：**页面已加载，我想在（好吧，在）Ajax 调用**之后**隐藏 DIV ，所以我在其中一个`render :update`块中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-13T13:23:21.817

或者，在您看来：

对于类指定的 div：

```
<%= link_to_function "Toggle", "$('.some_div').toggle()" %> 
```

对于 ID 指定的 div：

```
<%= link_to_function "Toggle", "$('#some_div').toggle()" %> 
```

（注意井号）

将句点添加到类特定的 div 和散列到 id 特定的 div

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T23:32:07.400

```
render :update do |page|
    page.hide 'div_id'
end 
```

您可以将其放入您的 respond_to 块或 RJS 模板中。

另一个有用的提示，使用相同的语法：

```
render :update do |page|
    page << 'arbitrary javascript code goes here.'
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T22:39:54.390

要从控制器呈现 RJS 更新：

```
respond_to do |format|
  format.html
  format.js { render(:update) { |page| page.hide('element_id') } }
end 
```

您可以查找其他 RJS 响应的[API](http://api.rubyonrails.org/classes/ActionView/Helpers/PrototypeHelper/JavaScriptGenerator/GeneratorMethods.html#M001638)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T22:31:40.837

不太了解rails，但你能输出类似style="display:none;"的东西吗？进入 div 标签？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-22T01:22:43.780

```
<%= link_to_function "Toggle", visual_effect(:toggle_blind, "some_div") %> 
```

# php - 如何处理不同类型的用户？

> ID：543769
> 
> 赞同：3
> 
> 时间：2009-02-12T22:29:15.507
> 
> 标签：php, mysql, database-design

我的网站现在将开始允许两种不同类型的用户注册...

1.  普通人
2.  公司

两人将能够在网站上做所有相同的事情，但他们的个人资料看起来会有所不同，我确信他们会想要存储不同类型的关于他们自己的信息。

我的问题是：我应该将它们存储在单独的 mysql 表中吗？或者...我应该将它们放在 1 上并将它们标记为“用户”还是“公司”？

我真的可以利用你的意见来帮助我避免任何一个陷阱......

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T22:31:27.967

[此链接](http://www.agiledata.org/essays/dataNormalization.html)解释了一些最佳数据库实践。

我会创建一个带有 UID 的“帐户”表，其中存储了两者之间的通用信息，以及它是哪种类型的帐户。

然后是一个包含公司特定信息的“公司”表，使用与帐户相同的 UID，我不知道，一个包含用户特定信息的“用户”表。

这可以防止您必须创建两个非常相似的表、具有未使用的列或重复数据。

像这样：

```
Accounts
UID|UserName|Password|Account Type

Companies
UID|Company Name|Address|Contact Person

Users
UID|First Name|Last Name|Display Name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T22:34:23.280

不要将它们放在完全独立的表格中，否则您必须在 2 个不同的地方查找用户名、帐户详细信息，从而在各处提供 if 语句。然后，您将有一段时间尝试执行参照完整性并尝试使“订单”表引用用户或客户表。要么把共享信息放在一张桌子上，把特定的东西放在额外的桌子上，要么把所有东西放在一张大桌子上。

# ruby-on-rails - undef - 为什么要取消定义 ruby 中的方法？

> ID：543774
> 
> 赞同：12
> 
> 时间：2009-02-12T22:29:43.273
> 
> 标签：ruby-on-rails, ruby, syntax

我从未在任何其他编程语言中见过 undef - 或任何其他允许您取消定义方法的东西。为什么在 Ruby 中需要它？

编辑：我并不是说这有什么问题。我只是不明白在运行时定义方法的目的？这样做的目的是什么？它是如何使用的？我从来没有在 C 或 Java 中这样做过。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-12T23:28:22.027

Ruby 中还有需要该`undef`功能的空白类模式。

这个想法是从你的新类中剥离每个方法，这样你对它的每个调用都以`#method_missing`. 这样你就可以实现一个真正的代理，它只是将所有东西都洗牌。用这个实现装饰器模式大约需要十行代码，无论你的目标类有多大。

如果您想看到这个习惯用法，请查看 Ruby 的模拟框架之一，他们经常使用它。像[flexmock 之](https://rubygems.org/gems/flexmock)类的东西。

另一个示例是当您根据某些条件将函数动态添加到类中时。在游戏中，您可能会`#attack`在玩家对象上添加一个方法，然后在他瘫痪时将其移除，而不是使用布尔标志执行此操作。这样调用类可以检查方法的可用性而不是标志。我并不是说这是一个好主意，只是说它成为可能，并且有比我更聪明的人想出有用的东西来解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T23:00:44.760

在运行时定义方法、类和对象是 Ruby 的一个非常好的特性。它允许您扩展类（记住它们是“开放的”）。如果您查看 Rails，它有一种`#find`在模型中查找对象的方法，但您也可以使用`find_by_user`; 该方法不存在（`#method_missing`所谓的），但在运行时创建。

如果您想创建[领域特定语言](http://en.wikipedia.org/wiki/Domain-specific_language)或 DSL，使用`#missing_method`可能会很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-12-01T20:03:10.557

I've seen this used in conjunction with Mixins; so you can include the whole thing and then undef the methods it shouldn't support.. e.g. the ruby graphics library [shoes](https://github.com/shoes/shoes4/blob/master/shoes-core/lib/shoes/button.rb).

The `button` class mixes in the `clickable` module, and then `undef`'s the `release` method because buttons don't support it.

Another quick example, so it's available here:

```
module Walkable
  attr_accessor :location

  def walk(steps)
    @location += steps
  end

  def walk_back(steps)
    @location -= steps
  end
end

class Zombie
  include Walkable

  undef walk_back #zombies can only walk forwards
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-27T01:05:01.587

Related to defining methods at runtime is the technique of including modules as needed. I work on a Rails application where we sometimes have to export data in various formats. 99% of the time, the Form object doesn't need export-related methods, but in our exporting Rake task, we do something like:

```
Form.send(:include, FormExportingMethods) 
```

So it only has those methods when it needs them.

This sort of dynamism is one of the things I love about Ruby. Whereas in some languages, you have to define your classes and objects up front, Ruby lets you say "oh, I need my pig to have wings right now? I'll just attach them."

Notice in my example that specific form objects aren't being modified; the Form class is. This works because, when you send a message to an object, it searches its method lookup chain for a response **at the moment you ask**. So you can create an object, then add a method anywhere in its inheritance chain, then call the method on the object, and it will have it. Obviously, having to look through the whole inheritance chain for each method call is expensive, but it's a trade-off for this kind of flexibility.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-28T16:11:54.727

I am consuming an external API, and one of the JSON responses contains a field named "methods". I'm creating an OpenStruct around the json, just to make the json more manageable. When calling openStruct.methods, it returns the result of Object instance method "methods".

So I did:

```
class MyOpenStruct < OpenStruct
   def methods
   end

   undef :methods
end 

openStruct = OpenStruct.new(my_json) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T23:22:24.927

您可以查看所有 Rails 中在运行时定义方法的示例（也称为元编程）。通过在类定义中调用一个方法，它可以为该类的所有实例定义一大堆方法......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-18T16:52:55.143

If your using Single Table Inheritance with an ORM, such as ActiveRecord, you may want to undefine the methods for fields which are not being used for a particular class/object.

```
# table: shapes, with columns: name, sides, radius, type
class Shape < ActiveRecord::Base
end

class Circle < Shape
end

class Square < Shape
  undefine_method :radius
end 
```

Note: This doesn't actually work in ActiveRecord as it internally expects a method for every field to always be defined.

Note: A square does have a radius its just not commonly used, but you get the gist? Think of some property your storing in the database which a Circle has, but a Square does not.

# version-control - 如何使用源代码管理工具让学生上交作业

> ID：543775
> 
> 赞同：8
> 
> 时间：2009-02-12T22:29:43.947
> 
> 标签：version-control

这个学期我在当地一所大学教一门课。到目前为止，我已经让学生通过电子邮件将他们的编程作业发送给我。但是从电子邮件中提取 20 个解决方案时有很多麻烦。

有没有人使用过源代码控制工具让学生上交项目？你使用了什么，它是如何设置的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T22:59:11.737

在我的大学，计算机和信息科学学院运行着一个学生 CVS 服务器。每个主题（选择使用它）都有一个存储库，每个注册该主题的学生都会在其中获得一个文件夹。管理员帐户显然可以访问全部内容，而每个学生只能签出自己的文件夹。

例如，以操作系统主题（我过去教过）为例：

```
/cis_os_2009
     |-studentID1
           |-assignment1
           |-assignment2
           |-prac1
     |-studentID2
     |-etc 
```

在作业规范中，我们提供了提交作业的说明。

我更喜欢 CVS 提交系统，而不是大学其他领域使用的电子邮件和网络提交系统。它教学生如何使用版本控制系统。对于不交作业的学生，​​您几乎可以完全清除“我的 USB 闪存驱动器丢失/损坏/被盗”的借口，因为学生应该定期提交到存储库（在某些科目中，分配分数以正确使用简历）。

缺点是你不能假设学生在学期开始就知道如何使用 CVS/SVN。这里的大多数主题都将第一周的实践专门用于 CVS 教程，因此人们可以确保 a) 系统管理员正确设置了他们的帐户，并且 b) 他们可以正确添加和提交文件。这也意味着您必须对提交第一份作业有点宽容。

标记所需要做的就是检查存储库，因为它在分配的到期日期/时间存在。如果您运行用于部分自动化标记存储库的脚本，这将非常容易。您确切地知道文件夹结构应该是什么以及所有文件的位置。在我教过的科目中，我们有一个分数文件，其中包含学生分数的概要和关于为什么扣分的评论。我们将此文件签入存储库，学生可以通过执行 cvs 更新立即获得他们的分数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T22:36:01.963

我认为一种常见的方法是为 ftp 上传创建目录。一些 cron 作业可以检查提交并自动运行 make 然后运行测试。

使用源代码管理听起来需要做很多工作，但可以做到。

当我为一门课程收听伯克利 CS 本科生播客时，他们正在使用一种称为“自动评分器”的东西 = 很可能是一种允许提交然后运行构建和测试的内部设备。

这里怎么样：

[http://www.users.muohio.edu/helmicmt/autograder/index.php](http://www.users.muohio.edu/helmicmt/autograder/index.php)

[http://prisms.cs.umass.edu/mcorner/autograder](http://prisms.cs.umass.edu/mcorner/autograder)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-20T23:33:39.037

[由于 google 代码现在支持 Mercurial，因此使用 google 代码或使用http://bitbucket.org](http://bitbucket.org)以开源方式托管代码应该是可行的。我认为这对于任何人来说都是一个很好的学习工具，分布式版本控制工具对于简化开发非常重要。

我会推荐 git，但它在学习曲线部门有点头重脚轻。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-11T17:29:33.543

没有在任何课程中尝试过（这些天我不教书），但我在监督学生在工作中完成他们一年的工作时使用了 SC 设置，以达到类似的效果。

颠覆是我的选择；CVS 存在严重缺陷，Git 对初学者来说有一条令人讨厌的学习曲线。我们是一家 Win 商店，因此学生可以使用 TortoiseSVN / AnkhSVN 进行 GUI 集成；显然，在您的情况下这可能不是真的。

我会为每门课程设置一个存储库，在基础级别为每个学生设置一个文件夹，并在其中设置通常的存储库。在 SVN 中很容易在 repo 配置中设置每个文件夹的访问权限，因此学生只能 r/w 到他们自己的目录，但您可以看到所有内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-11T17:21:07.170

我将在今年的 AP 计算机科学课程中尝试使用 Google Docs。看起来它会很好地工作。

我会让每个学生注册一个 Google 帐户，并让他们将源代码复制并粘贴到新的 Google 文档中，确保他们使用等宽字体。然后他们将与我为自己设置的 Google 帐户共享文档。

Google Docs 可以让我直接在他们的文档中写评论，他们下次登录时就可以看到这些评论。我将为每个作业创建一个不同的文件夹，以使事情井井有条。

不确定这是否是最好的解决方案，但它是免费的，而且比让学生像我去年那样打印所有内容要好得多。

# php - Windows 和 IIS 上的 PHP 5 和 Zend MVC

> ID：543777
> 
> 赞同：2
> 
> 时间：2009-02-12T22:30:11.837
> 
> 标签：php, windows, zend-framework, magento, iis

在 Windows 上运行 PHP 5 / Zend MVC 生产应用程序是否有任何重大问题需要注意？特定的应用程序是 Magento，一个电子商务系统，客户对在他们的数据中心安装 Linux 机器并不感兴趣。有没有人幸运地让 PHP 5 和 Zend MVC 在 IIS 上正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T20:02:09.480

好吧，我让 IIS、Zend 和 PHP 都运行良好。

安装了 ReWrite 模块，然后：[这篇文章](http://blogs.iis.net/bills/archive/2006/09/19/How-to-install-PHP-on-IIS7-_2800_RC1_2900_.aspx) Got the Zend re-write rule [from here](http://www.zendframework.com/manual/en/zend.controller.router.html) 并确保 short_opentag = on 在我的**php.ini**

到现在为止还挺好

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T22:34:07.553

是的，它有效。Microsoft 和 Zend 正在合作让 PHP 在 linux 上运行。Zend 甚至有针对 Windows 和 iis 的核心包（包括 php、mysql 和一些控制面板）的认证版本。Zend Framework 也应该是真正的平台独立的。

另一种选择是在 Windows 上使用 Apache，但 IIS 对于静态页面视图更快，并且还有一些其他有趣的选项。.htaccess 文件不受支持，因此要进行重写，您需要依赖其他 IIS 组件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T12:50:13.120

获取 IIS ReWrite 模块，这将使事情变得更容易一些。

[http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1691](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1691)

我在我的 Vista x64 机器上运行了 Zend、PHP、Apache 和 MySQL，但我会尝试在 IIS 而不是 Apache 上运行它。

我想应该不会太难

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T22:45:12.610

我们还在使用 IIS7（在 ISAPI 下）让 Magento 在 Windows Server 2008 机器上运行方面取得了一些进展。如果我们禁用 URL 重写，系统运行良好，但是我们无法使用 Magento 和任何重写系统（Helicon ISAPI Rewrite-Lite、Ape 和 Microsoft Rewrite Module）取得成功。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-30T09:02:44.873

[Windows 不支持 Magento](http://www.magentocommerce.com/system-requirements)。我确实安装了它，但它比 linux 更复杂，并且在与部署环境不同的环境中开发是没有意义的。您的客户应该重新考虑。

# svn - 我可以将 CruiseControl.Net 的 ccnet.config 保留在 svn 中，然后在签入更改时让 CruiseControl 更新自己的配置文件吗？

> ID：543778
> 
> 赞同：5
> 
> 时间：2009-02-12T22:30:30.510
> 
> 标签：svn, cruisecontrol.net, ccnet-config

我希望能够将 CruiseControl.Net 的 ccnet.config 文件保存在 svn 中，然后当我签入更改时，即我添加了一个新项目，它会自行更新。

这样我就可以将配置文件置于源代码控制之下，并且可以跟踪所做的更改。

我确实意识到我可以签入一个更改，这会将 CruiseControl 搞砸到我必须进行一些手动干预的程度，但在一般情况下，这听起来会非常好用。

然而，这个循环似乎有可能创造一个黑洞并毁灭世界。如果可能的话，我想保持良心。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T22:43:33.723

我们正在做几乎完全一样的事情，并且没有出现任何黑洞......或者它们可能只是蒸发了？:) CruiseControl.NET 处理得很好，它甚至会等到任何其他构建完成后再重新启动。

我们的流程听起来有点复杂，下面是工作流程的简要介绍：

*   在我们的“Omega”构建（RTM，GA，Gold，...）中，我们自动创建一个新的 ccnet 项目。项目基于一个分支（其名称也是从[程序集版本](https://stackoverflow.com/questions/438782/assembly-versioning-using-cruisecontrol-net)自动生成的），该分支也是同时创建的。
*   添加了新项目，更新了 ccnet.config 以引用它，更新、提交、然后更新工作副本。

所以我们需要（最多）2次点击来从ccnet创建一个发布版本——一次点击创建分支和ccnet项目，然后再一次点击强制第一个版本针对发布分支，或者你可以等待不可避免的修补 ;-）

如果您需要，很乐意提供更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-30T04:57:58.137

我也不喜欢手动更改 ccnet.config。这是我做的：

将 ccnet.config（和相关的）添加到 svn。制作了一个项目“配置”并添加了以下部分：

*   SourceControl 块将配置签出到“准备”目录。
*   将不在 svn（安全配置部分）中的配置文件复制到“prep”目录。
*   再次运行 CCNetValidator 'Prep' 目录
*   将配置签出到实际的配置位置。

我最喜欢的一点是，当我在配置中出错时，我的构建失败，但实际配置尚未更新。

# macos - 线端不可知差异？

> ID：543779
> 
> 赞同：22
> 
> 时间：2009-02-12T22:30:32.430
> 
> 标签：macos, unix, diff, utilities

我在 Mac 上工作，有一些相当旧的文件。不同的文件是由不同的程序创建的，所以其中一些以 \r (Mac) 结尾，而一些以 \n (Unix) 结尾。我希望能够在这些文件上运行 diff、grep 等命令，但是具有 \r 的那些被视为一条巨线。是否有适用于所有换行符的[diff](https://linux.die.net/man/1/diff)、[grep](https://linux.die.net/man/1/grep)等版本？

ETA：我还希望它们成为 Unix 实用程序，所以我可以在脚本、Emacs 等中使用它们……

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-12T22:33:17.120

如果您使用`**diff -w**`它将忽略文件中的空格，这可能足以满足您的需求。

**编辑**：刚刚意识到我第一次误读了这篇文章，而您实际上是在寻找一个适用于`\r`行尾的差异。我的建议是使用可以将文件转换为标准格式的[**翻转之类的东西来转换文件。**](http://ccrma-www.stanford.edu/~craig/utility/flip/)`\n`

**编辑 2**：刚刚找到了一些看起来像你想要的东西 - [**Diff'nPatch**](http://www.versiontracker.com/dyn/moreinfo/macosx/19069)：

> Diff'nPatch 是 GNU 'diff'、'patch' 和 'cmp' 实用程序的 Macintosh 端口。它可以让您比较和查找两个文件或文件夹之间的差异，整理两个文件，生成各种格式的差异（普通、上下文、unidiff 等）、应用补丁、逐字节比较文件。它可以处理任何类型的行尾（mac、unix 或 windows）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-12T23:44:38.133

正如杰伊所说，Diff'nPatch 似乎是您正在寻找的东西。或者，您可以在单个命令中将所有 '\r' 行结尾转换为 '\n'，如下所示：

```
sed -ie 's/\r/\n/' filename 
```

或者

```
find . | xargs -n1 sed -ie 's/\r/\n/' 
```

（在后一种情况下，您可能希望以某种方式过滤文件列表，否则它将应用于所有子目录中的所有文件。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-10-10T13:07:07.837

[与OS X v10.7](https://en.wikipedia.org/wiki/Mac_OS_X_Lion) (Lion)捆绑的 diff 实用程序有一个选项 'strip-trailing-cr' 可以满足您的需要。你像这样使用它：

```
diff -cpt a.c b.c --strip-trailing-cr 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-03T21:34:31.800

PhpStorm 的 diff 视图的“忽略空格”**可以正常工作**。它会自动忽略回车/EOL/换行/what-have-you 中的差异。你可以把时间浪费在摆弄神秘的 Unix 命令或其他东西上，或者你可以得到一些真正有效的东西并继续生活。

*   在 OS X v10.8 (Mountain Lion) 上使用上述任何解决方案均失败（包括标记为正确答案的解决方案）。“Diff-npatch”的所有下载链接都失败了。（我确实找到了[http://webperso.easyconnect.fr/bdesgraupes/tools.html](http://webperso.easyconnect.fr/bdesgraupes/tools.html)，但我真的不喜欢不得不求助于无法从命令行调用并因此与我可能使用的任何 IDE 或版本控制系统工具，例如[BBEdit](https://en.wikipedia.org/wiki/BBEdit)、[Sourcetree](https://en.wikipedia.org/wiki/Atlassian#Acquisitions_and_product_announcements)或 SmartSVN ——顺便说一句，所有这些工具都未能通过其内置的 diff 工具忽略换行符。

是的，我的换行符是 \r，但那又怎样？啊！如果软件太愚蠢而无法意识到 \r == \n 那么我将使用足够智能的不同*软件*。

PhpStorm 是唯一具有“刚刚工作”的差异工具的软件——这是我期望 Mac 软件做的事情。我希望 Mac 软件能够*正常工作*。我使用 Mac，所以我可以做我的工作，而不是每次都学习晦涩难懂的终端命令，这些命令几乎都没有很好的文档记录，希望您在没有任何明确示例的情况下了解命令应该如何格式化，所以您永远不会知道如果您做错了，或者该命令*根本无法*像所有其他不良软件一样工作。

以“man diff”为例：

> ```
>  -I RE  --ignore-matching-lines=RE
>           Ignore changes whose lines all match RE. 
> ```

好的，所以读了这个，我不知道它是什么意思。没有使用它的例子。什么是“RE”？它没有说任何地方。

然后是这颗宝石：

> ```
>  --GTYPE-group-format=GFMT
>           Similar, but format GTYPE input groups with GFMT.
> 
>    --line-format=LFMT
>           Similar, but format all input lines with LFMT.
> 
>    --LTYPE-line-format=LFMT
>           Similar, but format LTYPE input lines with LFMT.
> 
>    LTYPE is `old', `new', or `unchanged'.
>           GTYPE is LTYPE or `changed'.
> 
>           GFMT may contain:
> 
>    %<     lines from FILE1
> 
>    %>     lines from FILE2
> 
>    %=     lines common to FILE1 and FILE2
> 
>    %[-][WIDTH][.[PREC]]{doxX}LETTER
>           printf-style spec for LETTER
> 
>           LETTERs are as follows for new group, lower case for old group:
> 
>    F      first line number
> 
>    L      last line number
> 
>    N      number of lines = L-F+1
> 
>    E      F-1
> 
>    M      L+1
> 
>           LFMT may contain:
> 
>    %L     contents of line
> 
>    %l     contents of line, excluding any trailing newline
> 
>    %[-][WIDTH][.[PREC]]{doxX}n
>           printf-style spec for input line number
> 
>           Either GFMT or LFMT may contain:
> 
>    %%     %
> 
>    %c'C'  the single character C
> 
>    %c'\OOO'
>           the character with octal code OOO 
> ```

我无法理解这段话。什么是“输入”？它是两个文件还是只是“to”文件或只是“from”文件？“相似”指的是什么？句子中的“是”是什么意思，“GFMT 'is' LTYPE or 'changed'”？这是否意味着“可能被替换”？如果是这样，那么为什么引号、括号等中没有“GFMT”？由于没有给出例子，所以没有办法知道；文档的措辞完全模棱两可。"GFMT may contain" 是什么意思？“包含”是否意味着替换首字母缩写词 GFMT 的文本可能包含它？没有一个明确的例子，它是完全没用的。

如果你想让手册页变得如此神秘和模棱两可，以至于对于基本上不知道如何使用该软件的人来说毫无用处，为什么还要费心编写手册页呢？那时，它不是手册。这只是一个快速参考页面，供编写该软件的人使用，以便他们记住如何使用它。我猜他们认为如果你想知道它的实际作用，你只会阅读源代码本身。

我的时间很宝贵。我宁愿花钱买一个真正能正常工作并有适当文档的软件。

因为这些都失败了：

```
 diff -d --strip-trailing-cr --ignore-all-space --from-file=rest.phtml test.phtml 
```

...未能忽略 \r 字符。

```
 diff -wd --strip-trailing-cr --ignore-all-space --from-file=rest.phtml test.phtml 
```

...未能忽略 \r 字符。

```
 diff -wd --suppress-common-lines --strip-trailing-cr --ignore-all-space --from-file=rest.phtml test.phtml 
```

...未能忽略 \r 字符。

```
 diff -wd test.phtml rest.phtml --suppress-common-lines --strip-trailing-cr --ignore-all-space 
```

...未能忽略 \r 字符。

```
 diff -awd test.phtml rest.phtml --suppress-common-lines --strip-trailing-cr --ignore-all-space 
```

...未能忽略 \r 字符。

就此而言，如果它们是 \n 字符，则在添加 \n 字符时也会失败。

其中 test.phtml ==

> 富

> 酒吧

和rest.html ==

> 富吧

“diff”命令总是给你类似的东西：

> * * *

> *** 1,2 *** ！富！bar \ 文件末尾没有换行符

> --- 1 ---- ！foob​​ar \ 文件末尾没有换行符

... 失败！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T23:13:37.117

dos2unix 命令可能有助于首先将文件转换为一致的格式。我相信它几乎适用于您能想到的所有平台，并且可以同时在大量文件上运行。我相信有一个适用于 Mac 的软件包。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-22T11:19:09.523

我使用了以下快速修复，它有缺点（见下文）：

**1**：做一个差异并只列出文件名

```
diff -r -q dir1/ dir2/ 
```

**2**：使用使用的编辑器打开并保存每个列出的文件，这将改变行尾。

**3**：做一个常规的差异

缺点包括：

*   不太健壮，容易出错
*   如果你有很多文件，更多的工作

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-02-06T16:36:54.333

这对我有用：

```
diff -r --ignore-all-space dir1/ dir2/ 
```

我在 OS X 上，有来自 OS X 和 Windows 的混合文件。

信用： http: [//www.codealpha.net/514/diff-and-ignoring-spaces-and-end-of-lines-unix-dos-eol/](http://www.codealpha.net/514/diff-and-ignoring-spaces-and-end-of-lines-unix-dos-eol/)

# asp.net - 寻找隐藏可下载文件来源的方法

> ID：543785
> 
> 赞同：4
> 
> 时间：2009-02-12T22:31:10.137
> 
> 标签：asp.net

我正在建立一个内部站点，其主要功能是提供软件下载。不过，我要防止的一件事是人们找到源路径并绕过该站点（该站点记录下载以供审核。）

有没有办法隐藏二进制文件的来源？（我正在使用 ASP.NET）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-12T22:35:08.317

最好的方法是将文件放置在 Web 无法访问的目录中，然后动态加载文件。

[这篇文章](http://www.codeguru.com/cpp/i-n/internet/filetransfer/article.php/c12529)可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T22:34:59.860

如果你真的想这样做，那么你可以做类似的事情

1.  生成随机的类似 guid 的目录名称
2.  将任何文件复制到其中
3.  提供链接
4.  几分钟后删除它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T22:41:18.973

您可以创建一个 HttpHandler 来处理所有文件请求并根据某种唯一 ID 返回文件。因此，如果有人请求 /files.ashx?id=24，他们会得到文件，但不知道它在服务器上的实际位置。

此外，您可以使用 url 重写，这样用户看起来就像他们正在访问物理文件路径：/downloads/dog.img，但实际上它正在传递给处理程序：files.ashx?id=dog.img。这样用户甚至不会意识到后台正在使用处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T22:40:20.567

让您的 ASP 页面读取文件并将其写入页面，提供二进制数据。链接到该页面以进行下载。这样他们就永远不知道文件在磁盘上的位置。

像这样：[http](http://www.dotnetcurry.com/ShowArticle.aspx?ID=105&AspxAutoDetectCookieSupport=1) ://www.dotnetcurry.com/ShowArticle.aspx?ID=105&AspxAutoDetectCookieSupport= 1 但在您的 ASP 中通过 HTTP 流。

此示例显示通过 HTTP 流编写二进制文件，只需使用文件作为输入源而不是数据库。

[http://aspnet.4guysfromrolla.com/articles/120606-1.aspx](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx)

# javascript - Rails 内联 Javascript 和最佳实践

> ID：543790
> 
> 赞同：10
> 
> 时间：2009-02-12T22:32:12.643
> 
> 标签：javascript, ruby-on-rails, coding-style

我对使用 Rails*有点*陌生，我正在开发的应用程序进展顺利 - 但是我正在查看生成的 HTML 并注意到类似...

```
<script type="text/javascript">
//<![CDATA[
Droppables.add(...);
//]]>
</script> 
```

散布在 HTML 周围，这当然与我使用的地方相匹配：

```
<%= drop_receiving_element ... %> 
```

我想知道的是......有没有更好的方法来做到这一点，或者让它更清洁？其中一些脚本标签来自部分，因此将它们放在“页面底部”在这种情况下并没有真正的帮助。

另一种选择可能是将所有这些“标签块”推入一个数组，然后将它们写在**application.rhtml**文件中，但它仍然有点混乱......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-12T22:39:38.540

好吧，如果您真的想使用最佳实践...不要使用内联 javascript。保持您的 HTML、CSS 和 Javascript 干净且彼此分离。理想情况下，html 文件应该可以在没有 CSS 和 javascript 的情况下使用。

imo 最简洁的方法是使用纯 html/css 构建您的应用程序，并使用不显眼的 javascript 对其进行增强，以提供更好的用户体验。

一种模式是在页面底部包含所有 JS 文件，并使用 onDomReady 等功能开始运行代码。

根据评论，我想添加一些可能的选项来帮助您入门：

*   jQuery
*   小唯
*   原型

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-08-25T20:31:44.413

最佳做法是删除所有内联 javascript。但是，我遇到了 3 种情况，您绝对需要内联 javascript：

### 1.解决图像错误

如果图像标签引用了不存在的图像路径，那么防止出现图像错误的唯一方法（即使在 Web 检查器中也是如此）是这样做：

```
<img src="/i/dont/exist.png" onerror="$(this).attr("src", "/i/do/exist.png")" /> 
```

以下内容不起作用，因为`onerror`事件在您有时间使用 jQuery 抓取图像之前执行：

```
$("img").error(function() {
  $(this).attr("src", "/i/do/exist.png")
}); 
```

下面的代码也不起作用，因为`onerror`事件没有冒泡：

```
$("img").live("error", function() {
  $(this).attr("src", "/i/do/exist.png");
}); 
```

所以你必须为此使用内联javascript。

### 2\. 在页面加载时呈现 javascript 模板

如果您等到`$(document).ready`将内容提要绘制到 dom 中的一个空容器元素中，用户将在一瞬间看到空白点。这就是为什么当您的[Twitter](http://twitter.com/)页面首次加载时，Feed 会瞬间空白。即使您只是将外部脚本文件放在 dom 的底部，并在其中将动态生成的 html 元素附加到您的页面，甚至不使用`$(document).ready`，仍然为时已晚。您必须在添加容器元素后立即附加动态节点：

```
<script>App.bootstrap({some: "json"});</script>
<nav id='navigation'></nav>
<header id='header'></header>
<section id='content'>
  // dynamic content here
</section>
<script>App.renderContent();</script>
<aside id='sidebar'>
  // dynamically toggle which one is selected with javascript
  <nav>
    <h3>Search By Category</h3>
    <ol>
      <li>
        <a href="/category-a">Category A</a>
      </li>
      <li>
        <a href="/category-b">Category B</a>
      </li>
    </ol>
  </nav>
</aside>
<script>App.renderSidebar();</script>
<footer id='footer'></footer> 
```

### 3\. 您正在使用 JSON 引导您的应用程序

如果您使用的是 JSON + javascript 模板，最好将第一组数据引导到响应正文中，方法是将其内联在页面中（在上面的 dom 示例中也是如此）。这使得您不需要额外的 ajax 请求来呈现内容。

### 其他一切都应该使用 Unobtrusive Javascript 来完成

Rails 有很多 javascript 助手，幸运的是，在 Rails 3 中，大多数（全部？）它是不显眼的；他们现在正在使用`data-`属性和外部`rails.js`文件。但是，许多部分 ruby​​ 部分 javascript 的 gem 仍然倾向于编写辅助方法添加复杂的 javascript 内联：

*   [https://github.com/rubaidh/google_analytics](https://github.com/rubaidh/google_analytics/blob/master/lib/rubaidh/view_helpers.rb)
*   [https://github.com/scrubber/jquery_grid_for_rails](https://github.com/scrubber/jquery_grid_for_rails/blob/master/lib/hexagile/jquery_grid_for_rails.rb)
*   [https://github.com/sandipransing/rails_tiny_mce](https://github.com/sandipransing/rails_tiny_mce/blob/master/lib/tiny_mce_helper.rb)
*   [https://github.com/phronos/rails_datatables](https://github.com/phronos/rails_datatables/blob/master/lib/rails_datatables.rb)

这很有帮助，但我认为只有一个清晰的 README 来描述如何将 javascript 添加到您的文件`application.js`中会更有用。外部 javascript 使自定义/扩展功能变得更加容易，它使您可以更好地控制系统，并最大限度地减少 html 页面之间的重复（因此响应正文更小，浏览器可以缓存外部javascript 文件）。除非您需要处理丢失的图像、即时渲染或引导一些 json，否则您可以将其他所有内容放在外部 javascript 文件中，而不必使用 Rails javascript/ajax 助手。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T00:42:51.930

有时内联 JavaScript 对于关键的快速视图（例如，某些登录页面）或小片段（例如，Facebook SDK 初始化、Analytics/Kissmetrics 初始化脚本等）很有用，在这些情况下，不使用外部库可以加快页面加载速度。对于这些情况，我建议在布局中使用部分 _facebook.js.erb，并定义一个助手：

```
module ApplicationHelper
  def facebook_tag
    content_tag :script, render(partial: 'layouts/facebook.js')
  end
end 
```

然后，创建文件 _facebook.js.erb 并使用定义的帮助器在 application.html.erb 中包含内联 JavaScript：

```
<%= facebook_tag %> 
```

对于任何其他情况，例如您提到的内联 JavaScript 的部分，我建议使用其他答案所建议的不显眼的 JavaScript。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T09:14:31.133

这困扰了我一段时间，我最终想出了一个两管齐下的方法。

如果您正在为封闭域开发 Web 应用程序，其中搜索引擎性能和 javascript 不是问题，只要务实，让 Rails 的 javascript 助手来做他们的事情。

如果您正在为整个网络进行开发，那么请按照 Tomh 的建议并以纯 html/css 编写代码，然后增强 onDomReady。

如果您仍想使用像 button_to_remote 这样使用内联 javascript 的 Rails 帮助程序，则编写页面加载处理程序以向服务器发送 Ajax 请求。然后，您可以使用 page.replace / page.replace_html 将常规页面元素替换为从帮助程序返回的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-13T13:30:55.340

我还建议使用不显眼的 Javascript 方法并使用[jQuery](http://jquery.com/)。

有关如何使用 Rails 进行此操作的精彩介绍性教程，请查看[Ryan Bates 的这个 jQuery + Rails 截屏视频](http://railscasts.com/episodes/136-jquery)。

如果您想继续在 jQuery 中使用帮助程序，请查看[jRails](http://ennerchi.com/projects/jrails)，但如果您这样做，您仍然会违反不显眼的 Javascript 前提。

# php - PHP 变量变量

> ID：543792
> 
> 赞同：1
> 
> 时间：2009-02-12T22:32:26.013
> 
> 标签：php, variables

我想将 n 个课程作业的课程作业标记存储到 n 个变量中，例如 cw1 和 cw2 等。使用变量变量我如何使用 cw1、cw2 等。

如何动态创建变量？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-12T22:34:36.977

改用[数组](http://docs.php.net/manual/en/language.types.array.php)：

> PHP 中的[数组](http://docs.php.net/manual/en/language.types.array.php)实际上是一个有序映射。映射是将值与键相关联的类型。这种类型针对几种不同的用途进行了优化；它可以被视为数组、列表（向量）、哈希表（映射的实现）、字典、集合、堆栈、队列等等。由于[数组](http://docs.php.net/manual/en/language.types.array.php)值可以是其他[数组](http://docs.php.net/manual/en/language.types.array.php)，树和多维[数组](http://docs.php.net/manual/en/language.types.array.php)也是可能的......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-12T22:37:32.757

[正如Gumbo 所写](https://stackoverflow.com/questions/543792/php-variable-variables/543800#543800)，你真的应该使用一个数组：

```
$cw = array();

for($i = 0; $i < $n; ++$i) {
    $cw[] = $something;
} 
```

但是，您的问题的解决方案：

```
for($i = 0; $i < $n; ++$i) {
    $tmp = 'cw' . $i;
    $$tmp = $something;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T22:35:50.950

不完全确定我理解这个问题，但你可以这样做：

```
$VarName = 'cw1';

$$Varname = 'Mark Value'; 
```

如果你有很多这些，你最好为它们使用一个数组，索引基于课程作业。

IE：

```
$a = array();
$a['cw2'] = cw2value;
// etc. 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-19T11:06:26.327

```
<?php 
```

//您甚至可以添加更多美元符号

```
$Bar = "a";
$Foo = "Bar";
$World = "Foo";
$Hello = "World";
$a = "Hello";

$a; //Returns Hello
$$a; //Returns World
$$$a; //Returns Foo
$$$$a; //Returns Bar
$$$$$a; //Returns a

$$$$$$a; //Returns Hello
$$$$$$$a; //Returns World 
```

//... 等等 ...//

```
?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T22:36:07.207

```
php > for ($i=0; $i<5; $i++)
         { ${"thing{$i}"} = $i; }
php > echo $thing1;
1
php > echo $thing2;
2
php > echo $thing3;
3 
```

请注意，我们在字符串周围的花括号周围使用美元符号。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T22:35:30.513

可变变量以这种方式工作

```
$var = "foo";
$$var = "bar";

echo $foo; // bar 
```

但我不建议这样做，因为如果 $var 的值发生变化，那么您将无法再打印出这段代码中的第 3 行。

如果您可以详细说明您想做什么，我认为我们可以为您提供更多帮助。

# sql - Windows 中的 Vim SQLComplete OMNI 补全

> ID：543795
> 
> 赞同：3
> 
> 时间：2009-02-12T22:33:16.353
> 
> 标签：sql, vim, omnicomplete

我最近开始在 Windows 中使用 VIM (7.2)，并在编辑 SQL 时尝试使用 OMNI 完成功能。

在新行开始时，它似乎工作正常。例如，如果我处于插入模式并键入：

```
se <C-C>a 
```

然后出现“选择”一词。如果我然后尝试在同一行的任何其他单词上使用 OMNI 完成，那么我会收到“找不到模式”错误。

如果在换行时，我在输入“se”之前输入了一个空格，我会得到同样的错误。

这是预期的行为吗？还是我需要配置一些东西才能使它工作？

# .net - 是否可以杀死 BackgroundWorker 的线程？

> ID：543811
> 
> 赞同：6
> 
> 时间：2009-02-12T22:36:23.680
> 
> 标签：.net, multithreading, backgroundworker

是否有可能“杀死” a 的线程`BackgroundWorker`？

在我的`DoWork`事件中，我无法检查取消标志，因为我有对外部 COM 接口的阻塞调用或对数据库的查询。`CancelAsync`不会取消对 COM 的调用。

请问我该怎么做？任何建议将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T13:41:28.193

不，你不能杀死`BackgroundWorker`线程，你只能尝试取消它，但它需要后台线程本身的一些交互来停止工作：“*工作代码应该定期检查 CancellationPending 属性以查看它是否已设置为 true。* ” (c) MSDN

如果您需要完全控制线程，则必须使用`Thread`class 自己创建它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T13:44:55.253

我不知道中止线程的安全方法。

后台工作人员可以检查它是否应该取消并自行取消，但如果它关闭查询数据库，那么在它返回之前你无能为力。

您可以在 ThreadPool 线程上工作，然后放弃该线程并在不再需要它时启动另一个线程（确保当它从 db 查询返回时，它会在做任何讨厌的事情之前检查它是否应该取消）。当然，您需要平衡性能并管理线程同步。如果你沿着这条路走，你可以看看 Interlocked 静态类，以实现有效的临界区锁定。

# c++ - 计算 SLOC GCC C/C++ Linux

> ID：543812
> 
> 赞同：3
> 
> 时间：2009-02-12T22:36:26.160
> 
> 标签：c++, c, linux, gcc

我们在 Linux 下有一个相当大的（280 个二进制文件）软件项目，目前它具有非常分散的代码结构 - 这意味着无法[计算] 源代码树中的哪些代码是有效的（构建到可部署的二进制文件）以及什么是已弃用。但是Makefiles很好。我们需要为整个项目计算 C/C++ SLOC。

这是一个问题 - 我可以找出 SLOC GCC 已编译吗？或者也许我可以从二进制文件中获得这些信息（可能是调试信息）？或者也许我可以找出二进制文件是从哪些源文件编译而来并使用这些信息来计算 SLOC？

谢谢博格丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T04:10:04.407

这取决于 GCC 编译的 SLOC 的含义。如果您的意思是跟踪 GCC 使用的项目中的源文件，那么您可能会使用列出源文件和标头的依赖项跟踪选项。那是`-M`和各种相关的选项。谨防包括系统提供的标头。我有时使用的一种技术是用适当的变体替换标准 C 编译器 - 例如，为了确保 64 位编译，我使用 ' `CC="gcc -m64"`' 来保证在使用 C 编译器时，它将以 64 位模式编译. 显然，有了文件列表，就可以用它`wc`来计算行数。您使用 ' `sort -u`' 来消除重复的标题。

一个明显的问题是，如果您发现所有内容都包含在相对路径名中 - 那么您必须更仔细地确定每个文件的位置。

如果您对 SLOC 有其他定义，则需要指定您的想法。有时，人们正在寻找非空白、非注释的 SLOC，例如 - 但您仍然需要源文件列表，我认为这些`-M`选项将帮助您确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T08:28:29.030

您可以做的是使用 gcc 的**-E**标志进行仅预处理器编译：这将导致输出是正在编译的实际代码。做一个简单的行数（wc -l）或更高级的东西。

它可能包括来自宏等的额外代码，但特别是如果您将它与之前的代码实例进行比较，这是一个很好的比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T10:40:09.697

您想要的第一件事是您实际编译的准确列表。您可以通过使用包装脚本而不是 gcc 来实现这一点。

您想要的第二个列表是用于此的文件列表。为此，请查阅依赖项列表（正如您所说的那样）。（似乎你需要 make --print-data-base）

然后，对文件列表进行排序和重复数据删除，并丢弃系统标头。对于每个剩余的文件，使用您喜欢的工具确定 SLOC 计数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T10:19:43.800

在这里，您可以找到一个免费 (GPL) 工具，称为`sloccount`专用于在任何规模的项目中估算 SLOC：

[http://www.dwheeler.com/sloccount/](http://www.dwheeler.com/sloccount/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T20:51:12.240

我使用以下方法在 2 小时内获取脏指标值。尽管精确度远非理想，但足以做出决定。

我们使用了大约 40 kb 的代码并使用 gcov 计算了该代码的 SLOC。然后我们计算了“每字节源代码行数”指标，并使用它来获得使用整个项目的 C 源代码大小的近似 SLOC 数。

它满足我们的需求。

谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T14:40:18.710

您可能想尝试 Resource Standard Metrics，因为它计算有效的代码行数，不包括程序员风格的独立大括号等，并人为地将 SLOC 计数增加 10% 到 33%。向他们索取免费的定时许可证以试一试。

他们的网页是[http://msquaredtechnologies.com](http://msquaredtechnologies.com)

# active-directory - Active Directory 用户的主要标识符是“登录名”属性吗？

> ID：543821
> 
> 赞同：4
> 
> 时间：2009-02-12T22:39:28.023
> 
> 标签：active-directory

出于安全目的，Active Directory 用户的主要标识符是“登录名”属性吗？

例如，首先创建登录名为“bob”的用户，然后从 AD 中删除，然后再次创建另一个登录名为“bob”的用户 - 从安全角度来看，这个新用户是否等效？

我问这个问题的原因是由于最近打开 PST 邮件文件的一些特殊性 - 如上面的示例，用户已被删除然后使用相同的登录名重新创建，尽管共享，但不允许此新用户打开以前的用户 pst 文件相同的用户名。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T22:42:30.093

不，objectSid（一个[SID](http://en.wikipedia.org/wiki/Security_Identifier)）是分配权限时的主要 ID。具有相同名称的新用户将具有不同的 objectSid，因此将无法访问原始用户有权访问的文件。

# .net - 如何在 HttpRequest 中设置用户代理（单元测试）

> ID：543830
> 
> 赞同：1
> 
> 时间：2009-02-12T22:42:23.493
> 
> 标签：.net, user-agent

我有一个方法，它接受一个 HttpRequest 对象并根据用户代理的设置执行不同的操作。我正在尝试对其进行单元测试，并且有一段时间跟踪如何设置用户代理字符串。我已经尝试过原始的 HttpRequest 对象和各种其他对象，但最终都无济于事。

有谁知道如何为 HttpRequest 对象设置用户代理字符串？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T22:46:41.067

您可以在 HttpWebRequest 上设置 UserAgent 属性，是否可以改用该类型？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T22:49:52.307

您可能需要使用模拟 HttpRequest 对象。这将允许您设置各种属性，以便您可以测试您的 web 应用程序如何响应。

# .net - 我希望我的 2 Clickonce 部署 URL 使用不同的配置文件启动同一个应用程序，但它们都启动了完全相同的应用程序

> ID：543831
> 
> 赞同：1
> 
> 时间：2009-02-12T22:42:28.487
> 
> 标签：.net, clickonce

我有一个 clickonce 应用程序，我想用不同的配置文件部署同一个应用程序的 2 个版本。因此，该包是从相同的解决方案发布的，但将配置更改为不同的 url： 示例：App1 在[http://myserver/app1/myapp.application](http://myserver/app1/myapp.application)启动，app2 在[http://myserver/app2/myapp.application启动](http://myserver/app2/myapp.application)

但是，两个 url 都启动同一个应用程序（最新发布的应用程序）。它是否正确？我想做的事可以做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T01:49:45.370

与名称或 GUID 混淆的另一种方法是绕过实际的 app.config 并使用简单的 XML 文件作为配置。LINQ to XML 使这很容易做到，您可以关闭执行上下文以提取文件位置，以便配置文件保持独立。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T22:45:05.530

在 Visual Studio 中进入属性并更改应用程序的名称或其 GUID。然后各个客户端将应用程序视为完全独立。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T22:45:08.743

在从哪个 URL 启动的应用程序中有条件测试？

# javascript - 捕获多个“onkeydown”并等待“onkeyup”执行

> ID：543854
> 
> 赞同：2
> 
> 时间：2009-02-12T22:49:53.460
> 
> 标签：javascript, events, keyboard

在我的网络应用程序中，我使用**onkeydown**事件来捕获击键。

例如，我捕获了“j”键来动画向下滚动页面（同时做一些其他的事情）。

我的问题是用户可能会按住“j”键向下滚动页面（这相当于快速多次击键）。

在我的应用程序中，这会导致一系列看起来不太好的动画。

我如何知道密钥何时被释放，以及我应该捕获多少次按键？这样我就可以运行一个长动画而不是多个短动画。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T23:03:21.853

以[@JMD 为基础](https://stackoverflow.com/users/56793/jmd)：

```
var动画=假；

函数启动动画（）
{
  动画=真；
  运行动画（）；
}

函数停止动画（）
{
  动画=假；
}

函数运行动画（）
{
  如果（动画结束）
  {
    如果（！动画）
    {
      返回;
    }

    返回开始动画（）；
  }

  // 动画代码

  变量超时 = 25;
  setTimeout(function(){runanimation();},timeout);
}

document.onkeydown = 开始动画；
document.onkeyup = 停止动画；

```

但是，您需要为开始/结束动画添加一些检查。

**编辑：**`return`在 JS 中添加了一个；会无休止地递归。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T22:54:05.930

您可以在 keyDown 上启动动画，而不是尝试堆叠动画，如果在动画结束时您还没有收到 keyUp，则启动另一个动画。一旦你到达动画的结尾并且你*确实*有 keyUp 然后你就完成了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T22:59:05.980

您可以尝试使用我的 repsonsiveness 插件，请参阅： [http ://notetodogself.blogspot.com/2008/12/jquery-responsiveness-plugin-for-fast.html](http://notetodogself.blogspot.com/2008/12/jquery-responsiveness-plugin-for-fast.html)

在此处查看演示：http: [//doesthatevencompile.com/current-projects/jquery.responsiveness/](http://doesthatevencompile.com/current-projects/jquery.responsiveness/)

您可以快速输入内容的那个。您可以根据自己的需要进行调整。像这样：动画事件将与插件绑定，并在用户停止快速执行某项操作时执行。您可以通过事件的正常绑定来计算他做了多少次快速的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T23:02:50.370

`setTimeout`返回一个计时器 ID。所以我要做的是在你收到 keyDown 事件后，我会启动一个等待时间很短的计时器，如下所示：

```
var globalTimerId = -1;
var keyDownCount = 0;

function handleKeyDown(e) {
    if (globalTimerId != -1) {
        clearTimeout(globalTimerId);
        keyDownCount++;
    }

    /* 500 means 1/2 a second, adjust for your needs */
    globalTimerId = setTimeout(handleKeyDownAfterWait, 500);
    keyDownCount = 1;
}

function handleKeyDownAfterWait() {
    globalTimerId = -1;
    /* keyDownCount will have the number of times handleKeyDown was called */
} 
```

所以想法是每次接收到 keyDown 事件时，计时器都会被清除（假设它还没有过去）并重新启动。如果计时器到期，则用户已松开密钥，您可以在`handleKeyDownAfterWait`.

然而，jQuery 或其他 JS 库可能还有其他更优雅的解决方案。这只是一些快速而肮脏的东西（并且可能是错误的；））

# javascript - 使用 Javascript 获取元素

> ID：543857
> 
> 赞同：1
> 
> 时间：2009-02-12T22:50:43.753
> 
> 标签：javascript, jquery

我有一堆输入元素，它们的 ID 中有一个特定的子字符串。使用 javascript，有没有办法将这些元素作为数组获取？我不知道完整的 ID - 只有子字符串。

如果我使用 JQuery，这会更简单吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T23:23:26.327

非 jQuery 答案怎么样......嗯！？

```
function getAndFilter(elems, filter) {
    var length = elems.length,
        ret = [];
    while (length--) {
        if(filter(elems[length])) {
            ret[ret.length] = elems[length];
        }
    }
    return ret;
}

getAndFilter(document.getElementsByTagName('input'), function(input) {
    // Your custom logic/rule goes here:
    return input.id.substr(0,5) === 'HELLO';
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T22:52:51.003

使用 jQuery 很容易。例子：

```
$("li[id^='comment']") 
```

选择 id 以“comment”开头的所有“li”。

**编辑**

要将它们放入数组中：

```
var myArray = new Array;

$("li[id^='comment']").each(function() {
    var thisId = $(this).attr("id");
    myArray.push(thisId);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T22:53:49.473

如果您使用 jquery，它会更简单，否则您将不得不从文档正文开始，获取它的孩子，解析他们的 id，选择匹配的元素，然后继续向下树。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T22:59:28.383

jquery 绝对是一个好方法。

查看[jquery.com上的属性过滤器](http://docs.jquery.com/Selectors)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T23:15:03.663

[选择器 API](http://www.w3.org/TR/selectors-api/)运行。

```
document.querySelectorAll("input[id*='yoursubstring']") 
```

适用于 IE8+、WebKit（Google Chrome、Safari），似乎将适用于下一个 Opera 和 FF。

# asp.net - ASP.NET 聊天客户端

> ID：543864
> 
> 赞同：0
> 
> 时间：2009-02-12T22:53:18.867
> 
> 标签：asp.net, extjs, chat, .net-1.1

在 ASP.NET 1.1 应用程序中实现简单聊天客户端（2 人）的最佳选择是什么？我在前端使用 ExtJS，所以如果它与它很好地集成，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T22:56:00.870

可以使用 Web 服务和 AJAX，但如果您使用的是 1.1，则必须手动编写所有代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-10T08:05:31.000

如果您只是免费寻找，请参阅此 [http://steveorr.net/Articles/WebChat.aspx](http://steveorr.net/Articles/WebChat.aspx)

# ruby - 使用 %w 时包括空格

> ID：543868
> 
> 赞同：6
> 
> 时间：2009-02-12T22:53:26.073
> 
> 标签：ruby, string, formatting

以下代码产生输出“xyz”

```
a = %w{x y z} 
print a.to_s 
```

是否有可以添加到块中以允许添加空格的选项？

例如，我认为通过将代码更改为此，我可能能够对元素进行空间分隔以产生“xy z”的输出

```
a = %w{"x " "y " "z "}
print a.to_s 
```

相反，它产生了这个：

“x”“y”“z”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T22:58:09.820

您可以通过反斜杠转义它们来包含空格（然后添加一个额外的空格作为分隔符）。

```
a = %w{x\  y\  z\ } 
```

不过，这可能会变得难以阅读。如果要在其中放置显式引号，则不需要`%w{}`，只需使用带有 . 的普通逗号分隔数组即可`[]`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T22:57:05.987

不要`%w`用于这个——当你想从单词中分割一个数组时，它是一个快捷方式。否则，使用标准数组表示法：

```
a = ["x ", "y ", "z "] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T22:59:09.693

```
a = ["xyz"].split("").join(" ") 
```

或者

```
a = ["x","y","z"].join(" ") 
```

或者

```
a = %w(x y z).join(" ") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T13:09:30.693

```
def explain
  puts "double quote equivalents"
  p "a b c", %Q{a b c}, %Q(a b c), %(a b c), %<a b c>, %!a b c! # & etc
  puts

  puts "single quote equivalents"
  p 'a b c', %q{a b c}, %q(a b c), %q<a b c>, %q!a b c! # & etc.
  puts

  puts "single-quote whitespace split equivalents"
  p %w{a b c}, 'a b c'.split, 'a b c'.split(" ")
  puts

  puts "double-quote whitespace split equivalents"
  p %W{a b c}, "a b c".split, "a b c".split(" ")
  puts
end

explain

def extra_credit
  puts "Extra Credit"
  puts

  test_class = Class.new do
    def inspect() 'inspect was called' end
    def to_s() 'to_s was called' end
  end

  puts "print"
  print test_class.new
  puts "(print calls to_s and doesn't add a newline)"
  puts

  puts "puts"
  puts test_class.new
  puts "(puts calls to_s and adds a newline)"
  puts

  puts "p"
  p test_class.new
  puts "(p calls inspect and adds a newline)"
  puts
end

extra_credit 
```

# computer-science - 如果你现在可以上一门计算机科学课程，你会选什么？

> ID：543877
> 
> 赞同：19
> 
> 时间：2009-02-12T22:54:28.457
> 
> 标签：computer-science

如果您现在有机会参加一门计算机科学课程，并因此显着增加您在某个学科领域的知识，那会是什么？本科或研究生水平。

编译器？分布式算法？并发理论？高级操作系统？

让我知道为什么。

（请注意，我很欣赏这不是一个牵强的场景 - 但时间和惯性可能会阻止人们参加课程或阅读书籍或其他任何东西）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-12T22:57:05.113

编译器。

就像学习一门外语迫使你比以往任何时候都更仔细地考虑你的母语一样，我相信编写编译器会让你对你正常编写的所有代码有深刻的了解。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-12T22:55:56.160

数据结构和算法 - 本课程教您如何构建更高效的代码，还教您解决复杂问题的常用方法。我不是最好的，但我相信这种类型的课程教你如何思考复杂问题的方式可以帮助你在许多其他领域。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-12T23:08:50.450

我很想参加硬核（如[约翰卡马克](http://en.wikipedia.org/wiki/John_Carmack)硬核）图形编程课程。涵盖从硬件级别到光栅化和渲染算法以及完成 3 维数据操作和数据存储技术的所有内容。我在大学时提供的那一份相当平庸。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-02-12T23:23:21.413

用户界面设计，在心跳中。

我在大学里学到了很多关于如何做好编程的知识，但从来没有提到过用户体验。在工作了十多年之后，我认为这种疏忽是彻头彻尾的犯罪。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-02-12T23:07:23.653

操作系统。了解您在较低级别的刻度上如何开发该框有助于您以后掌握所有较高级别的概念，尤其是在出现问题时。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-02-13T08:01:18.267

算法课，放下手。

> “如果你想成为世界级的程序员，你可以每天编程十年，也可以每天编程两年，然后上一门算法课。” - Erik Demaine 教授（麻省理工学院）

学习算法复杂度、排序、合并和搜索算法非常重要。

这是引用来自麻省理工学院[OpenCourseware 算法课程视频的视频](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-046JFall-2005/VideoLectures/detail/embed01.htm)[链接](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-046JFall-2005/VideoLectures/detail/embed01.htm)。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-12T23:04:40.133

实践中的神经网络
AI
自然语言或语义处理简介。

这些中的任何一个......如果我有时间，我现在很乐意做任何这些。

但是，如果您将范围扩大到涵盖任何课程，我将不得不参加会计课程。这将在各种方面都很有用。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-12T23:17:30.663

我有兴趣参加机器学习课程。我从事统计工作，与机器学习有很多重叠之处。我很乐意看到解决一些相同问题的不同视角。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-12T22:55:49.873

联网。（不是社交网络……尽管无论如何这可能是一门有趣的课程。）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-12T22:58:01.320

我会选修一门涵盖我知道自己无法学习的材料的课程。例如，我对量子计算完全着迷，我很想知道更多关于它的信息，即使它可能对我没有专业帮助。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-12T23:01:22.403

隐私和匿名（实际上，我刚刚审核了这个，所以它真的不完全适合这个问题）。一旦您弄清楚使用最少的信息可以多么容易地在网络上唯一识别您，您将更加谨慎地处理您分发的信息（作为用户）和收集/显示的信息（作为开发人员） ）。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-12T23:27:33.680

我还没有完成我的硕士论文，所以我仍然可以参加任何我喜欢的CS课程。但我认为我可以通过阅读书籍和做一些练习来更轻松地学习相同的东西，而无需参加课程（并且从练习和考试中获得压力）。另一种选择是只听讲座，但不正式参加课程（至少在赫尔辛基大学，讲座是公开的，任何人都可以听）。

以下是我接下来想学习的东西：函数式编程、分布式系统。编译器也是一个有趣的话题，但我现在不需要这些知识。

我的大学会有关于所有这些的课程，但现在我更喜欢自学。我将从 lambda 演算和 Haskell 课程下载课程材料和练习，并阅读一两本关于分布式系统和算法的书。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-12T22:57:36.280

基因编程？

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-12T23:04:41.443

计算机网络或编译器构建 - 两者都是我学校的选修课，由于日程冲突，我从来没有机会参加。

（从技术上讲，我的一些课程教授了编译器构造的各种元素——解析、管理符号表、激活记录——但它们更多地是关于机器/语言理论，而不是关于如何实际构建编译器）。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-12T23:27:34.913

算法（再次）。可悲的是，我认为我没有像第一次那样获得那么多。我的第二个选择是编译器。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-02-12T23:30:59.600

还有编译器，因为它们需要在许多领域的效率，解析、模式匹配、语义分析、代码生成等。

干杯

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-13T00:22:19.400

《软件许可及相关版权法》将在未来几年火爆

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-13T01:48:00.223

并行编程。我真的不认为它需要只是函数式编程。我对用非功能性语言探索这个话题同样感兴趣。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-02-13T07:55:52.150

计算几何。我从书本上学到的东西过得去，但我希望有机会时能真正深入了解。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-02-13T07:56:08.793

我很惊讶我没有看到任何人追求计算理论。这是我在大学学到的最令人讨厌的科目。这里肯定有人和我有同样的胃口。:-)

CS -> 1\. 计算理论，2\. 计算建模，3\. 编程语言

1.  它让我对整体问题的解决有了更抽象的看法。我的经验告诉我，我越抽象，我就能为一个问题制定更好的解决方案。:-)

2.  建模是如此强大，以至于大多数问题的解决都依赖于它。有了它，我们通常以低层次的方式解决问题。它通常不是最好的解决方案。

3.  它是计算机与程序员的接口。我有兴趣让所有人的编程变得更容易。因此，如果界面可以改进，所有人都会受益。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-02-13T12:01:35.537

排版。其次是用户界面设计。

我认为，这些是我的技能最需要提高的领域。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-12T23:09:13.617

[这是我可以推荐的一门课程](http://www3.open.ac.uk/courses/bin/p12.dll?C01M263)（这是一门远程学习课程）。

您将了解逻辑、递归、二叉树/BST、真值表、效率、函数的正式定义。它不需要任何超出学校水平的数学背景。第 1 年的模块中涵盖了有关位操作、二进制计数等基本主题。

你不使用haskell，虽然我听说很多大学都在使用它——它是一种java解释的函数式语言。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-12T23:35:35.067

我的前两个（操作系统和编译器）已经被占用了。我的下一个选择是一门关于数据库设计的好课程。数据库是任何 Web 项目的重要组成部分。了解它们在内部的工作方式将使以后与它们一起工作变得容易得多。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-02-13T00:01:53.957

极限编程。编程比赛的问题。编码很多。快速编码。高效编码。包括使用版本控制:)

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-02-13T02:04:44.817

安全或密码学

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-02-13T07:48:16.240

并行/分布式编程，因为 CPU 不会很快变得更快；多核和互联网将会出现一段时间。本科课程，因为我没有先验知识。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-02-13T09:18:54.867

操作系统。在将软件系统中的组件/服务拼凑在一起、规划性能以及诊断/解决性能瓶颈方面，任何具有操作系统知识的人都具有巨大的优势。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-02-12T22:55:58.750

任何使用最新语言的现代算法课程不仅教您算法，还教您语言！

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-02-12T23:12:10.147

信息技术监管

诸如 SOX、PCI、HIPAA 和来自不同司法管辖区的其他法律要求，以及在 IT 领域可能适用的隐私法。黑客在这里也可能在某种程度上涵盖，因为它是法律课程和信息技术之间的一种交叉，对某些人来说不一定是计算机科学。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-02-12T23:19:09.443

由于我已经学习了编译器、算法和所有其他标准的 CS 东西，我可能会学习一些更有趣和“时尚”的东西，比如[iPhone 开发](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-02-12T23:26:16.773

我希望我能拿一篇教一点汇编的论文。我所做的所有论文都是用高级语言编写的。

我也希望我能早点进入数据库，我是在第二年才开始拿这些论文的。所以我一直没能拿到关于 Hibernate、JDBC 等的高级论文。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-02-13T09:10:48.413

[语义网](http://semanticweb.org/wiki/Main_Page)

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-03-06T23:54:05.890

当我想在大学学习神经网络时，我仍然很沮丧

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2010-06-03T16:13:16.460

编译器和操作系统

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2010-07-11T10:18:30.933

计算机架构。更好地了解您的软件最终是如何运行的。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2011-03-11T19:53:31.323

统计数据。能够查看日志、计算错误、计算成功并给出未来失败的概率对于确定“我们需要现在解决这个问题，还是可以等待一段时间？”很有用。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2011-03-11T20:07:19.167

计算机图形和/或图像处理。没有更好的方法来开始考虑算法中的并行化。

# windows - 如何让电脑从待机模式返回

> ID：543891
> 
> 赞同：2
> 
> 时间：2009-02-12T22:56:42.243
> 
> 标签：windows, scheduling, sleep

我希望我的计算机定期或在特定时间执行特定任务。

如：

*   每 15 分钟唤醒一次，连接到互联网，查看电子邮件，发出哔声（如果有未读邮件），然后再次进入待机状态

*   早上 8 点起床播放音乐

在最好的情况下，它应该处于睡眠状态，因此会保持安静并处于低功耗状态。

让它连接或者查邮件都没有问题，但是如何让它唤醒……？
您是否知道实现此功能的软件或 windows API 使用？
我觉得有一个，但我没有找到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T23:06:58.160

[待机唤醒](http://www.dennisbabkin.com/php/download.php?what=WOSB)(Windows)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T23:07:18.427

*   [创建等待定时器](http://msdn.microsoft.com/en-us/library/ms682492(VS.85).aspx)
*   [设置等待定时器](http://msdn.microsoft.com/en-us/library/ms686289(VS.85).aspx)
*   [SetSuspendState](http://msdn.microsoft.com/en-us/library/aa373201(VS.85).aspx)进入挂起状态。
*   [取消等待定时器](http://msdn.microsoft.com/en-us/library/ms681985(VS.85).aspx)

更多信息例如[在这里](http://www.dennisbabkin.com/php/faq.php?what=wosb)。

其他替代方案需要更多的硬件支持 - 例如 Wake-On-Lan 功能或 IPMI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T23:07:49.907

有些计算机具有您在 BIOS 中所需的选项。我不相信没有 BIOS 支持。一旦您的计算机睡着了，就没有任何程序可以唤醒它，因为任何这样的程序都在睡着......

# java - 您如何将 TLS/SSL Http 身份验证与 CXF 客户端一起用于 Web 服务？

> ID：543896
> 
> 赞同：9
> 
> 时间：2009-02-12T22:57:53.037
> 
> 标签：java, web-services, ssl, cxf, ws-security

我正在尝试访问受证书保护的 Web 服务。安全性是在 IIS 上设置的，Web 服务在其背后。

我认为 WS-SECURITY 不会进行这种类型的身份验证。调用Web服务时有什么方法可以通过客户端证书吗？

我刚刚收到一个 IIS 错误页面，上面写着“该页面需要客户端证书”。

我正在使用 CXF 2.1.4

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T13:29:04.003

是的，这可以使用 CXF。您将需要设置客户端管道。您可以指定包含允许您访问 IIS 中的 Web 服务的证书的密钥库。只要您在此处使用的证书是 IIS 中已知的允许客户端，就可以了。

```
<http:conduit name="{http://apache.org/hello_world}HelloWorld.http-conduit">

   <http:tlsClientParameters>
       <sec:keyManagers keyPassword="password">
            <sec:keyStore type="JKS" password="password"
                 file="src/test/java/org/apache/cxf/systest/http/resources/Morpit.jks"/>
       </sec:keyManagers>
       <sec:trustManagers>
           <sec:keyStore type="JKS" password="password"
                file="src/test/java/org/apache/cxf/systest/http/resources/Truststore.jks"/>
       </sec:trustManagers>

       ...

   </http:tlsClientParameters> 
```

样本来自：[CXF Wiki](http://cxf.apache.org/docs/client-http-transport-including-ssl-support.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T06:49:18.027

上面的答案是正确的，但增加了......

您的客户端 bean 应如下所示（此 SSL 工作正常）：

```
<jaxws:client id="helloClient" serviceClass="demo.spring.HelloWorld" address="http://localhost:9002/HelloWorld" /> 
```

如果您将客户端 bean 定义为以下 SSL 将不起作用：

```
<bean id="proxyFactory" 
class="org.apache.cxf.jaxws.JaxWsProxyFactoryBean">
<property name="serviceClass" value="demo.spring.HelloWorld"/>
<property name="address" value="http://localhost:9002/HelloWorld"/>
</bean> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-14T03:44:53.040

正如@geg 所提到的，您需要将拦截器添加到您的 JaxWsProxyFactoryBean 并使用 HttpConduit。

[这](http://svn.apache.org/repos/asf/cxf/tags/cxf-2.4.4/distribution/src/main/release/samples/wsdl_first_https/)是您可以参考的示例代码。
[此](http://svn.apache.org/repos/asf/cxf/tags/cxf-2.4.4/distribution/src/main/release/samples/wsdl_first_https/src/main/java/demo/hw_https/client/ClientNonSpring.java)代码将指导如何设置 TLSClientParameters

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-31T15:59:16.510

要以编程方式执行此操作，请创建一个拦截器并将其添加到您的`JaxWsProxyFactoryBean`with `factory.getOutInterceptors().add(new TLSInterceptor())`.

```
public class TLSInterceptor extends AbstractPhaseInterceptor<Message> {

    public TLSInterceptor() {
        super(Phase.SETUP);
    }

    @Override
    public void handleMessage(final Message message) throws Fault {
            final Conduit conduit = message.getExchange().getConduit(message);
            if (conduit instanceof HTTPConduit) {
                final HTTPConduit httpConduit = (HTTPConduit) conduit;
                final TLSClientParameters tlsClientParameters = ObjectUtils.firstNonNull(httpConduit.getTlsClientParameters(), new TLSClientParameters());

               // configure the params

                httpConduit.setTlsClientParameters(tlsClientParameters);
            }
        }
} 
```

# c# - 为什么我不能使用扩展方法隐式转换委托？

> ID：543897
> 
> 赞同：7
> 
> 时间：2009-02-12T22:58:00.523
> 
> 标签：c#, functional-programming, extension-methods, currying

我正在尝试找出一种自动将某些内容投射到 Action 或 Func 的方法，而我能想到的最好的方法是这样的：

```
[TestFixture]
public class ExecutionTest
{
    public void BadMethod()
    {
        throw new Exception("Something bad happened");
    }

    [Test]
    public void TestBadMethod()
    {
        // Want this, but it won't work!!
        // BadMethod.Execute().IgnoreExceptions();

        // Ick
        ((Action)BadMethod).Exec().IgnoreExceptions();

        // Still ick
        ((Action)BadMethod).IgnoreExceptions();

        // Do not want
        ExtensionMethods.Exec(BadMethod).IgnoreExceptions();

        // Better but still meh
        this.Exec(BadMethod).IgnoreExceptions();

    }
}

public static class ExtensionMethods
{
    public static Action Exec(this Action action)
    { return action; }

    public static Action Exec(this object obj, Action action)
    { return action; }

    public static void IgnoreExceptions(this Action action)
    {
        try { action(); }
        catch {}
    }
} 
```

必须有更好/更简单的方法来做到这一点，有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T23:19:46.977

在 C# 中，当您使用不带括号的方法名称时，它被称为方法组，除了在编译时它没有任何表示。一个方法组可以表示多个方法（因为重载和覆盖），因此要隐式识别需要哪个方法，必须提供目标委托类型。

在您的情况下，您想知道为什么扩展方法参数类型不会触发函数的解析。简单来说，extension是在类型已知后才计算的，也就是说this参数不能作为隐式转换目标。

为什么会中断的示例：

```
class Test
{
    void M (void) // Fits Action delegate
    {
    }

    int M (int) // Fits Func<int,int> delegate
    {
        return 5;
    }

    void Test()
    {
        M.Exec(); // UHOH!!! Which Exec to resolve to ???
    }
}

public static class Extensions
{
    public static void Exec(this Action action) { }
    public static void Exec(this Func<int, int> func) { }
} 
```

如您所见，存在冲突，但事实上，冲突从未发生过，因为 C# 甚至不会尝试找到与方法组匹配的扩展。

请注意这也不起作用：

```
class A
{
    public static implicit operator int (A a)
    {
        return 5;
    }

    void F()
    {
       A a = new A();
       a.Blah(); // Error! It won't implicitly try C.Blah()
    }
}

public static class C
{
    public static void Blah (int i)
    {
    }
} 
```

C# 将不匹配`A`，`C.Blah(int)`因为它需要隐式转换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T04:06:22.840

正如 Coincoin 所说，由于对方法重载的过分热爱，它在 C# 中不会很好地工作。我见过人们使用的唯一解决方法是创建 Action 和 Func 方法：

```
public Action Action(Action f) { return f; }
public Action<A> Action<A>(Action<A> f) { return f; }
...
public Func<A,B,C,D,E> Func(Func<A,B,C,D,E> f) { return f; } 
```

您甚至可以将它们都称为“F”以获得某种简短的语法：

```
F(BadMethod).NoExceptions(); 
```

您可能决定不在您的类中定义这些方法，并将它们放在 Funcs 实用程序或其他东西中。用 F 给它起别名，结果不会太糟糕：

```
F.F(BadMethod).NoException(); 
```

但总的来说它仍然很烂:(。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-08T18:19:05.603

F# 通过提供更好的类型推断系统，让您可以非常自然地做这种事情。

# java - Struts tile 可视化调试

> ID：543901
> 
> 赞同：0
> 
> 时间：2009-02-12T22:58:25.203
> 
> 标签：java, struts

在以前的工作中，他们有一个调试模式，可以在浏览器中突出显示 struts 磁贴，这样您就可以知道每个磁贴在做什么以及磁贴的文件名。当您迷失在嵌套瓷砖的森林中时，这非常有用。既然我在一个新的 struts 地方，我一直在试图弄清楚如何实现它，但我一无所获。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T00:29:26.463

以下代码适用于我（在 jsp 中）：

```
 Object nestedTilePath = request.getAttribute("javax.servlet.include.request_uri");
   String thePath;
   if (nestedTilePath != null){
     thePath = nestedTilePath.toString();
   } else {
     thePath = request.getRequestURI();
   }
   out.println(application.getRealPath(thePath)); 
```

因此，您可以将其合并到一个标签中，该标签将放入每个图块中，将代码包装在`if (debugMode)`支票中。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-27T19:24:47.203

它可能只会让你走到一半，但我下载了一个名为 WebDeveloper 的 Firefox 工具。它很好地勾勒出表格和单元格。

亚伦

# javascript - 是否可以使用 Ajax 进行文件上传？

> ID：543926
> 
> 赞同：26
> 
> 时间：2009-02-12T23:05:05.967
> 
> 标签：javascript, jquery, ajax, upload

我不想使用 jQuery，但我想使用 Ajax 进行文件上传。那可能吗？

如果是这样，我在哪里可以找到有关它的信息/教程？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-12T23:05:59.397

不，不可能用 javascript 做到这一点。

但是，为了给人一种“AJAX”的感觉，您可以将表单提交到隐藏的 iframe 并将脚本结果输出到它，然后从那里进行处理。谷歌[`ajax iframe upload`](http://www.google.com/search?q=ajax+iframe+upload)并从那里开始。

如果您使用的是 jQuery， [`Form plugin`](http://malsup.com/jquery/form/)如果您的表单中有任何文件字段，它也会自动为您创建这个 iframe。我没有用它来做这件事，但我听说过好东西。

正如评论中所指出的，您还可以使用非常流行的东西[`SWFUpload`](http://swfupload.org/)来实现 Flash 所需的效果。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2011-06-23T19:29:59.510

万一有人在很久以后才发现这个问题：是的，现在 JavaScript 可以做到这一点。

HTML5 定义了 2 个新的 API，您可以一起使用它们来完成此操作：拖放 API 和文件 API。您可以使用 jQuery 与 API 进行有效交互，让人们拖放文件以进行上传。

这是有关如何执行此操作[的教程。](http://www.thebuzzmedia.com/html5-drag-and-drop-and-file-api-tutorial/)

该代码目前适用于 Chrome 6+ 和 Firefox 3.6+、Safari 6 和 IE 10。如果您需要 Safari 5 支持，代码几乎完全相同，但您使用 FormData 对象代替上传的文件列表（更多信息在邮政）。

Opera 从 11 开始支持 File API，但不支持 DnD API，drop 操作不会启动上传，但它们支持您使用 API 访问文件。我想他们将在 12 年完成对 DnD API 的支持。

2014 年 1 月 20 日更新：所有主流浏览器现在都实现了所有标准 API，因此本教程适用于所有浏览器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T23:14:53.150

我使用[swfupload](http://swfupload.org/)进行多个类似 ajax 的上传（基于它的 javascript/flash）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T23:09:26.643

这里有一些关于 gmail 如何使用 iframe 的细节：

[http://www.sajithmr.com/upload-files-like-gmail/](http://www.sajithmr.com/upload-files-like-gmail/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T21:56:55.190

严格来说，有可能进行[真正的 AJAX 文件上传](http://igstan.ro/posts/2009-01-11-ajax-file-upload-with-pure-javascript.html)，但这仅适用于 Firefox 3+、Safari 4 和 Chrome 2。在所有其他浏览器中，您必须使用 iframe 技术或基于 Flash 的上传器之类的解决方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T17:57:59.643

假设您使用的是 Java，DWR 3.0 版（目前在 RC1 中）支持二进制文件上传/下载，这使问题变得非常简单。我还没有机会尝试这个，但我们广泛使用 DWR 并取得了完全的成功；它是一个很棒的 Ajax 工具包。

[http://directwebremoting.org/blog/joe/2008/12/16/dwr_version_3_0_release_candidate_1.html](http://directwebremoting.org/blog/joe/2008/12/16/dwr_version_3_0_release_candidate_1.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T23:08:16.037

没有亲自使用过，但[Ajax Uploader](http://ajaxuploader.com/)是我最近遇到的一个组件，它说它可以在 UpdatePanel 内进行文件上传（假设您使用的是 ASP.NET）。

# perl - 如何在 Perl 中使用代码引用作为回调？

> ID：543929
> 
> 赞同：8
> 
> 时间：2009-02-12T23:06:14.233
> 
> 标签：perl, reference, scripting, callback

我的课堂上有以下代码：

```
 sub new {
    my $class = shift;
    my %args  = @_;
    my $self  = {};
    bless( $self, $class );
    if ( exists $args{callback} ) {
        $self->{callback} = $args{callback};
    }
    if ( exists $args{dir} ) {
        $self->{dir} = $args{dir};
    }
    return $self;
}

sub test {
  my $self = shift;
  my $arg  = shift;
  &$self->{callback}($arg);
} 
```

和一个包含以下代码的脚本：

```
 use strict;
use warnings;
use MyPackage;

my $callback = sub {
   my $arg = shift;
   print $arg;
};

my $obj = MyPackage->new(callback => $callback); 
```

但我收到以下错误：

```
Not a CODE reference ... 
```

我错过了什么？印刷`ref($self->{callback})`展示`CODE`。如果我使用它可以工作`$self->{callback}->($arg)`，但我想使用另一种调用代码参考的方式。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-12T23:12:19.053

`$self`& 号仅对而不是整个事物具有约束力。您可以在返回参考的部分周围做卷曲：

```
&{$self->{callback}}($arg); 
```

但是

```
$self->{callback}->($arg); 
```

一般认为比较干净，为什么不想用呢？

# bash - 查找 -mtime 超过 1 小时的文件

> ID：543946
> 
> 赞同：90
> 
> 时间：2009-02-12T23:09:26.877
> 
> 标签：bash, shell, command-line, cron

我有这个命令，我目前每 24 小时运行一次。

```
find /var/www/html/audio -daystart -maxdepth 1 -mtime +1 -type f -name "*.mp3" -exec rm -f {} \; 
```

我想每 1 小时运行一次并删除超过 1 小时的文件。它是否正确：

```
find /var/www/html/audio -daystart -maxdepth 1 -mtime **+0.04** -type f -name "*.mp3" -exec rm -f {} \; 
```

我不确定我是否使用十进制数？？

感谢您的任何更正。

## 编辑

或者我可以只使用**-mmin 60**吗？它是否正确？

## 编辑2

我试过你的测试，你建议的好东西。我得到一个空的结果。我希望删除所有超过 60 分钟的文件**！**我怎样才能做到这一点？？我的命令真的这样做了吗？

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2009-02-12T23:11:43.407

怎么样`-mmin`？

```
find /var/www/html/audio -daystart -maxdepth 1 -mmin +59 -type f -name "*.mp3" \
    -exec rm -f {} \; 
```

从男人找到：

```
-min n
        文件的数据最后一次修改是在 n 分钟前。

```

另外，**请务必先进行测试！**

```
... -exec echo rm -f '{}' \;
          ^^^^ 添加“回声”，这样您就可以看到将要获取的命令
               运行而不是先实际尝试它们。

```

# .net - 是否有一个备受推崇的库可用于对 WPF 应用程序的密码和用户进行哈希处理和身份验证？

> ID：543947
> 
> 赞同：1
> 
> 时间：2009-02-12T23:09:52.553
> 
> 标签：.net, authentication, passwords, hash

这里有[很多关于密码散列的帖子](https://stackoverflow.com/search?q=password+hash)和很多关于如何去做的建议，但是在我开始根据这里的建议写一些东西之前，有没有一个标准库可以用来节省我一些时间（和可能会脸红，知道这东西有多复杂）。

我的标准是它必须在 .NET 中用于客户端（winforms 或 WPF）应用程序和 Web 应用程序（MVC 或 webforms）。

为了清楚起见，我不是在建议使用 guppy12 算法 16 次和通过 SHA256 运行 20 次的盐，而是一个不错的库（或框架类，如果我错过了它），最好是开源的，并编写通过比我更聪明/更有经验的人，这将使我免于陷入一些我不会知道的经典密码学 doh，直到我被黑客入侵。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T23:23:46.310

我不确定它的评价如何，但该框架具有[`System.Web.Security.HashPasswordForStoringInConfigFile()`](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.hashpasswordforstoringinconfigfile.aspx)API。

即使它在`System.Web`命名空间中，也没有什么可以阻止它在桌面应用程序中使用。

我建议的一件事似乎没有在该方法的文档中提到，并且使 API 的使用比应有的要容易一些，那就是您可能应该在密码前加上一个盐值 - 微软真的应该有一个允许您传入盐的特定参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T23:39:29.737

System.Security.Cryptography 命名空间有多个散列值选项。

[http://msdn.microsoft.com/en-us/library/system.security.cryptography.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T05:59:56.390

这个 API 受到我的高度重视，我知道我的 shiznit：[https ://sourceforge.net/projects/pwdtknet](https://sourceforge.net/projects/pwdtknet)

# iphone - OpenGL ES 1.x 着色器

> ID：543948
> 
> 赞同：5
> 
> 时间：2009-02-12T23:10:09.137
> 
> 标签：iphone, opengl-es, shader

我试图找到如何为 OpenGL ES 1.x（特别是 iPhone）实现简单着色器的示例。我以前从未使用过着色器，但我确实了解它们的用途。我认为一旦我能够在模拟器中加载一个简单的着色器，我就可以从那里获取它并做我需要做的事情。感谢您的帮助，〜埃里克

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-12T23:33:00.313

iPhone 当前使用不支持可编程管道的[OpenGL ES 1.1 。](http://en.wikipedia.org/wiki/OpenGL_ES)OpenGL ES 2.0 似乎确实有它们，但也与 1.1**不**兼容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-23T22:55:58.023

从[这篇文章](http://diaryofagraphicsprogrammer.blogspot.com/2008/12/ip-programming-tip-5.html)：

> iP* 平台的像素着色器通过纹理组合器进行编程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T23:15:41.713

我的理解是，iPhone 上的硬件着色器已经被操作系统用于 CoreAnimation 和 OpenGL ES 中的功能。这意味着您无法使用它们。

您在寻找软件着色器吗？试试[http://unity3d.com/unity/features/shaders](http://unity3d.com/unity/features/shaders)

# delphi - 在 Delphi 中，我应该将共享单元添加到我的项目、共享包中，还是都不添加？

> ID：543949
> 
> 赞同：7
> 
> 时间：2009-02-12T23:10:49.713
> 
> 标签：delphi, project-structure

*[这个问题与这个](https://stackoverflow.com/questions/259673/what-is-the-best-way-to-share-delphi-source-files-among-projects)问题相似，但不是重复的，因为我问的是该问题中未讨论的问题。*

我在 Delphi 7 中有一个客户端-服务器项目，其目录结构如下：

```
\MyApp
  \MyClientApp
  \MyServerApp
  \lib 
```

有 2 个实际的 Delphi 项目 (.dpr)，MyClientApp 和 MyServerApp 文件夹中各有一个。

lib 文件夹具有 .pas 单元，这些单元具有客户端和服务器应用程序的通用代码。我想知道是否应该在客户端和服务器项目中包含这些 .pas 文件？或者我应该在包含这些单元的 lib 文件夹中创建一个包？还是我应该将 .pas 文件留在 lib 文件夹中而不将它们添加到任何应用程序/包中？

每种方法的优缺点是什么？哪种方式是“最好的”？将 lib 文件夹中的这些单元包含在多个项目中是否有任何问题？

现在 lib 文件夹中的单元不是任何应用程序/包的一部分。这样做的一个缺点是，例如，当我在 Delphi 中打开我的客户端应用程序，并且我想在项目的所有文件中搜索某些内容时，它也不会在 lib 文件夹中的单元中搜索。我通过打开这些单元并在所有打开的文件中进行查找或使用 grep 搜索来解决此问题（但我更喜欢更好的解决方案）。

我也非常喜欢一个解决方案，当我对 lib 文件夹中的这些文件进行更改时，我不必去打开一些单独的包并重新编译它（这是我应该使用项目组的地方吗？）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-13T07:38:40.803

在应用程序之间共享单元总是存在在一个应用程序中完成的不兼容更改会破坏另一个应用程序的风险。另一方面，制作这些单元的副本更糟糕，因此您将它们移动到自己的子目录的方法至少增加了在不考虑其他程序的情况下更改它们的心理障碍。

至于将它们添加到项目文件中：我通常将一些我经常从 IDE 访问（用于扩展或供参考）的单元添加到项目中，而将其他单元留给编译器使用搜索路径进行选择。我在每个项目的基础上这样做，这意味着一些单位可能是几个项目的一部分，为什么不呢？

将它们放入一个包中才有意义，如果您真的想创建一个基于包的应用程序，否则，何必费心呢？

有关我如何组织项目和库的更多信息，请参阅[http://www.dummzeuch.de/delphi/subversion/english.html](http://www.dummzeuch.de/delphi/subversion/english.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-13T00:19:06.553

我不喜欢项目共享文件。很多时候，您会很想编辑其中一个共享文件，并且您会破坏另一个项目中的某些内容，或者您​​会忘记您必须重新构建另一个项目。

当共享文件被分离到它们自己的库（包）中时，编辑它们就会有一些额外的障碍。我认为这是一件好事。这将提醒您正在从项目特定代码切换到共享代码。您可以使用项目组让您将所有项目都放在一个 IDE 实例中。将库项目安排在可执行项目之前。“build all”命令将从第一个项目开始按顺序构建所有内容。

将 DCU 文件与 PAS 文件分开。您可以通过设置“DCU 输出目录”项目选项将包的单元发送到其他位置来轻松完成此操作。然后将该目标目录放在您其他项目的“搜索路径”上。他们会找到 DCU，但不会找到 PAS 文件，因此没有其他项目会意外地重新编译不是真正成员的单元。

拥有一个单独的包也会阻止使用项目特定的条件定义。当您在项目之间共享单元时，这些会导致各种麻烦。找到一种方法，将所有特定于项目的选项保留在各个项目中。共享库不应该需要特定于项目的修改。如果一个库需要根据使用它的人而采取不同的行动，那么使用库用户可以设置的回调函数等技术来修改库的行为。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-13T11:02:19.847

我需要有充分的理由将共享代码添加到包中。如果您只有几个共享文件，请将它们全部粘贴到名为 Shared 的目录中。这应该清楚地表明文件在项目之间共享。

还要使用一个好的构建工具来进行自动构建，这样如果你破坏了一些东西，你就会很快发现。

.bpl 文件适用于组件，但会严重增加此类事情的复杂性，除非您有大量共享文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-13T00:04:26.103

我通常创建一个包含所有共享单元的包，然后只使用这些单元。如果您没有明确标记“使用运行时包构建”，则包内容（所有使用的 dcu）将作为任何其他单元链接到您的项目。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-13T15:44:42.553

如果您实际上有两个应该在同一物理机器上运行并且共享一些代码的二进制文件，我只会使用运行时包。请记住，运行时包主要是一种全有或全无的方法。一旦您决定使用它们，您将不再能够将 RTL 和 VCL 单元直接链接到您的项目中，而是必须单独部署它们。

但是，当与我正在做的项目组结合使用时，包可能仍然是解决您问题的好方法。我讨厌在多个项目中包含共享单元。在包中包含共享单元（但不使用运行时包编译您的实际项目）允许您将该包添加到您的项目组中，这样您（和 IDE！）将始终让它们易于访问，但与特定于项目的项目很好地分开代码。严格来说，您甚至不必编译这些包。他们只能作为项目经理中的一个组织单位。

请注意，对于在文件中查找，您还可以指定“在项目组中的所有文件中”

# linq-to-sql - 用于排序和分页的 LINQ to SQL 扩展方法

> ID：543955
> 
> 赞同：7
> 
> 时间：2009-02-12T23:12:37.697
> 
> 标签：linq-to-sql, lambda

我找到了一种处理[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)的排序和分页的扩展方法。虽然这很好用，但我想看看是否有其他方法可以使用它。

目前[扩展方法](http://en.wikipedia.org/wiki/Extension_method)的代码如下：

```
public static IQueryable<T> Page<T, TResult>(
  this IQueryable<T> obj, 
  int page, 
  int pageSize, 
  System.Linq.Expressions.Expression<Func<T, TResult>> keySelector, 
  bool asc, 
  out int rowsCount)
{
    rowsCount = obj.Count();

    int innerRows = (page - 1) * pageSize;

    if (asc)
        return obj.OrderBy(keySelector).Skip(innerRows).Take(pageSize).AsQueryable();
    else
        return obj.OrderByDescending(keySelector).Skip(innerRows).Take(pageSize).AsQueryable();
} 
```

该方法接受一个表达式，该表达式基于类型。

在我的 Dealer 类中，我有一个 GetDealers 方法，它本质上调用它，即

```
db.User.Page(1, 2, p => p.User.UserProperty.Name, true, out rowCount) 
```

但是，从事物的呈现方面来看，我不知道或无法访问上述表达式，例如

```
ListView1.DataSource = users.GetDealers("SortColumn", pageNo, pageSize, out rowCount, bool asc);
ListView1.DataBind(); 
```

唯一的方法是在我的 GetDealers 方法中有一个 switch 语句，然后将其转换为表达式。有没有办法绕过这个，或者这个方法可以吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T06:04:59.890

我不确定你在问什么，但我相信这是我自己研究过的。如果您想知道如何根据字符串而不是正确的 LINQ 表达式对结果进行动态排序，那么您很幸运。

Scott Guthrie就该主题发表了一篇很棒的[文章。](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)它引用了一个 Microsoft 文件，该文件扩展了任何`IQueryable`对象以支持动态排序。 [C# 动态查询库（包含在 \LinqSamples\DynamicQuery 目录中）](http://msdn2.microsoft.com/en-us/vcsharp/bb894665.aspx)。只需将页面添加到您的`App_Code`文件夹并在您的项目中包含“Using System.Linq.Dynamic”，您就可以使用以下语法：

```
myUsers = myUsers.OrderBy("LastName"); 
```

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-15T23:25:22.363

如果您正在寻找适用于所有类型的扩展方法

```
public static class SortingAndPagingHelper
{
    /// <summary>
    /// Returns the list of items of type on which method called
    /// </summary>
    /// <typeparam name="TSource">This helper can be invoked on IEnumerable type.</typeparam>
    /// <param name="source">instance on which this helper is invoked.</param>
    /// <param name="sortingModal">Page no</param>
    /// <returns>List of items after query being executed on</returns>
    public static IEnumerable<TSource> SortingAndPaging<TSource>(this IEnumerable<TSource> source, SortingAndPagingInfo sortingModal)
    {
        // Gets the coloumn name that sorting to be done o`enter code here`n
        PropertyInfo propertyInfo = source.GetType().GetGenericArguments()[0].GetProperty(sortingModal.SortColumnName);

        // sorts by ascending if sort criteria is Ascending otherwise sorts descending
        return sortingModal.SortOrder == "Ascending" ? source.OrderByDescending(x => propertyInfo.GetValue(x, null)).Skip(sortingModal.PageSelected * sortingModal.PageSize).Take(sortingModal.PageSize)
                           : source.OrderBy(x => propertyInfo.GetValue(x, null)).Skip(sortingModal.PageSelected * sortingModal.PageSize).Take(sortingModal.PageSize);
    }
} 
```

`DbContext dbContext = new DbContext(); dbContext.rainingSessions.Where(x => x.RegistrationDeadline > DateTime.Now) .SortingAndPaging(sortAndPagingInfo).ToList()`

# ruby-on-rails - 部署时的“预热缓存”

> ID：543961
> 
> 赞同：19
> 
> 时间：2009-02-12T23:14:53.307
> 
> 标签：ruby-on-rails, ruby, deployment, caching, capistrano

我想知道是否有人有任何插件或 capistrano 配方可以通过在部署时或在部署发生之前在本地构建所有页面缓存的 html 来“预热”rails 应用程序的页面缓存。

我有一些几乎没有变化的静态站点，如果已经编写了 html，运行速度会更快，而不是要求一位访问者访问该站点。

而不是自己创建这个（看起来很容易，但它的优先级很低）它是否已经存在？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-12T23:22:48.000

您可以使用`wget`或其他程序来抓取该站点。事实上，这种场景在其手册页中被提及为一种用途：

> 此选项告诉 Wget 在完成后删除它下载的每个文件。它对于通过代理预取热门页面很有用，例如：
> 
> ```
>  wget -r -nd --delete-after http://whatever.com/~popular/page/ 
> ```
> 
> -r 选项是递归检索，-nd 选项是不创建目录。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T02:14:40.997

我每天晚上使用一个看起来像这样的 rake 任务来刷新我的页面缓存站点地图：

```
 require 'action_controller/integration'
 ActionController::Base::expire_page("/sitemap.xml")   
 app = ActionController::Integration::Session.new
 app.host = "notexample.com"
 app.get("/sitemap.xml") 
```

见[http://gist.github.com/122738](http://gist.github.com/122738)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T01:25:27.423

我设置了集成测试，确认网站的所有主要区域都可用（总共几百页）。他们不做任何改变数据的事情——只是拉回页面和表单。

当我部署我的生产实例时，我目前没有运行它们，但现在你提到它 - 这实际上可能是一个好主意。

另一种选择是提取站点地图中出现的每个页面（如果你有，你可能应该这样做）。编写一个可以做到这一点的 gem / rake 脚本应该很容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T18:55:36.983

以这种方式预加载——通常，cron 作业从太平洋时间晚上 10 点开始，到东部时间早上 6 点结束——是一种很好的网站负载平衡方式。

查看[spider_test rails 插件](http://github.com/courtenay/spider_test/tree/master)，了解在测试中执行此操作的简单方法。

如果您要使用上面的 wget，请添加 --level=、--no-parent、--wait=SECONDS 和 --waitretry=SECONDS 选项来限制您的负载，您不妨记录并捕获用于诊断或分析的标头响应（如果需要，从 /tmp 更改路径）：

```
wget -r --level=5 --no-parent --delete-after \
  --wait=2 --waitretry=10  \
  --server-response        \
  --append-output=/tmp/spidering-`date "+%Y%m%d"`.log
  'http://whatever.com/~popular/page/' 
```

# mysql - MySQL 中的 Max(distinct...)？

> ID：543964
> 
> 赞同：2
> 
> 时间：2009-02-12T23:15:29.903
> 
> 标签：mysql

[根据文档](http://dev.mysql.com/doc/refman/5.1/en/group-by-functions.html#function_max)，在 MySQL 中 Max() 和 Min() 聚合函数接受 DISTINCT 关键字：

> DISTINCT 关键字可用于查找 expr 的不同值的最大值，但是，这会产生与省略 DISTINCT 相同的结果。

也许我错过了一些东西，但这怎么可能有用呢？

更新：

与几个答案相反， MySQL*不*支持每个聚合函数都不同。

avg()、count()、min()、max()、group_concat() 和 sum() 支持 Distinct。std()、variance()、其他几个统计函数或按位聚合函数不支持它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T23:18:33.437

它们像所有聚合一样采用 DISTINCT，但是，当您追求最大值时，可能存在多个值的事实是无关紧要的，因此它总是相同的。

Count 是 distinct 会产生不同结果的关键示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T23:20:47.490

我认为通常允许/支持将 DISTINCT 放入聚合函数中，即使它不会对结果产生影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T23:31:37.243

无论如何，ANSI SQL 标准规定*所有*聚合函数都接受一个可选`DISTINCT`关键字。在的情况下`MIN()`，`MAX()`这似乎毫无意义，因为无论哪种方式结果都是相同的。

但对于其他聚合函数，例如`COUNT()`、`SUM()`和`AVG()`，该`DISTINCT`选项可能会影响结果。

我假设标准 SQL 调用每个聚合函数来支持`DISTINCT`简化语言的语法。在没有效果的地方支持它并没有什么坏处`DISTINCT`，并且任何实现都可以在内部自由地将其视为无操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T23:20:42.340

根据定义，不同集合的最大值将与具有重复的相同集合的最大值完全相同。

但要回答您的问题，它可能与 select 子句中对相同不同值进行操作的其他聚合函数结合使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T14:57:54.960

据我所知，SQL92 标准定义了五个聚合函数。这五个是 avg、count、max、min 和 sum。巧合*，这些都接受 DISTINCT 关键字。

*我的意思是“并非巧合”

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-12T23:20:54.370

我也在摸不着头脑；我唯一能想到的是 select max(foo) 可能会进行表扫描以找到最大值，但 select max(distinct foo) 可能会首先进入索引。也许对于某些表格大小来说它更快？

# multithreading - 使用 thread.join 确保集合中的所有线程在继续之前执行

> ID：543968
> 
> 赞同：0
> 
> 时间：2009-02-12T23:17:08.310
> 
> 标签：multithreading, concurrency

考虑到以下情况，这种类型的实现在继续之前等待一批线程完成是否存在问题？：

*   不能使用 CCR 或 PFX。
*   Customer.Prices 集合和 newCustomer 没有被改变。
*   CloneCustomerPrices 将 Customer.Prices 集合中的每个价格深拷贝到新的价格集合中。

```
public List[Customer] ProcessCustomersPrices(List [Customer] Customers)
{
[检查客户并将客户数据深度复制到新客户的代码]
列表[线程] 线程列表 = 新列表 [线程]();
foreach(Customers cust in 客户)
{
ThreadList.Add(new Thread(() => CloneCustomerPrices(cust.Prices, newCustomer)));
}

动作 runThreadBatch = () =>
            {
                 ThreadList.ForEach(t => t.Start());
                 ThreadList.All (t => t.Join([TimeOutNumber]));
            };

runThreadBatch(CopyPriceModelsCallback, null);

[更多处理]
返回新客户；
}

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T23:33:00.283

对我来说很有意义，只要线程在超时之前完成。不确定 newCustomer 是什么（与 cust 相同？）。如果是这样的话，我也不知道如何计划只退回其中一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-09T07:30:24.660

等待的实现似乎很好，只要确保 CloneCustomerPrices 是线程安全的。

# .net - ADO.NET Entity Framework：更新向导不会添加表

> ID：543971
> 
> 赞同：93
> 
> 时间：2009-02-12T23:18:20.177
> 
> 标签：.net, visual-studio-2008, entity-framework, ado.net, primary-key

我在我的项目中[添加了一个新的 ADO.Net 实体数据模型](https://i.stack.imgur.com/5CduL.png)，并使用[更新向导](https://i.stack.imgur.com/c4Pju.png)将表添加到模型中。五个选定的表格被添加到设计图面上。其他两个表不会添加。我在向导中选择它们并单击完成，但它们从未出现在设计图面上。

这是一个错误，还是在某些情况下无法将表添加到模型中（按设计）？

* * *

更新：XML (*.edmx) 揭示了问题。

```
<!--Errors Found During Generation:
warning 6013: The table/view 'FooBar.dbo.Roles' does not 
have a primary key defined and no valid primary key could be inferred. 
This table/view has been excluded. To use the entity you will need to 
review your schema, add the correct keys and uncomment it.-->
<!--<EntityType Name="Roles">
    <Property Name="role_id" Type="decimal" />
    <Property Name="role_desc" Type="nvarchar" MaxLength="30" />
</EntityType>--> 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-13T14:16:33.200

设计面与实体模型不同。您的 EDMX 中的映射中可能有一个表，它不会出现在设计图面上。以 XML 格式查看文件以查看是否是这种情况。在这种情况下，更新向导将不允许您重新添加表，因为它们已经是实体模型的一部分。因此，一般而言，更新向导对实体模型的了解比对设计表面*本身*的了解更多。

我不认为这正是您所处的情况，但它应该为您提供解决方案的总体思路：进入 XML 并查找对相关表的引用。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2010-07-21T11:37:07.537

将主键设置为所有表或仅将一个未选中的复选框“允许空”设置为每个表的任何列。这个对我有用 ：）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-04-29T18:09:08.770

1.  更改表结构并添加主列。更新模型。

2.  在 XML 编辑器中修改 .EDMX 文件并尝试在此特定表的标记下添加一个新列。（不管用）

3.  我将通过涉及所有现有列来创建一个复合键，而不是为退出表创建一个新的主列。（工作）

[实体框架：将没有主键的 DataTable 添加到实体模型。](http://pratapreddypilaka.blogspot.in/2012/04/entity-framework-adding-datatable-with.html)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-01-13T12:54:04.507

我也遇到了这个问题，以上所有方法都不适合我。对我有帮助的是以下内容。

当您尝试与数据库连接时，该数据库可以拥有具有不同凭据的不同用户，它可以接受。假设用户 A 到 D。

如果您尝试与用户连接，请确保该用户启用了正确的凭据，在这种情况下，启用读取和写入选项。

为此，请启动 MS SQL Server Managment Studio，与您的 SQL 服务器连接，然后在 Visual Studio 中选择您尝试与之建立连接的数据库。在 'your_dbname' --> Security --> Users 下，您可以找到用户列表。右键单击您尝试登录的用户名并选择属性。一个窗口打开。选择“常规”（默认选择）页面并在“数据库角色成员资格”选项卡下**确保选择“db_datareader”和“db_datawrite”。**

注意：当您登录 MS SQL Server Managment Studio 时，请确保您使用可以启用/禁用这些选项的用户登录...

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-03-01T20:58:26.860

在您的特定表中检查“空值”。如果所有列都设置为“允许 Null”，则实体框架将其视为“Null”表。我遇到了同样的问题，未选中“允许 Null”，它添加了所需的表。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-04-05T11:48:34.880

不会添加没有主键的表。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-21T21:37:37.140

我对此的解决方案是删除整个模型并读取它，包括我想要的新表。

有一次不小心把设计器里的一个表删了，读不下去了。因此删除整个模型并读取它。

我对此也有一些问题（[Ado.Net 实体数据模型未正确更新](https://stackoverflow.com/questions/774645/ado-net-entity-data-model-not-updating-correctly/774737#774737)）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-18T03:22:48.237

这已在最新版本中得到解决（环境：VS 2012，.net framework 4.5）。只需打开 .edmx 文件并添加所需的表/存储过程/视图。没有主键的表/视图将被创建为只读表/视图。

> 表/视图“TABLE_NAME”没有定义主键。已推断出密钥，并将定义创建为只读表/视图。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-26T17:20:02.090

您不需要删除整个模型（可能是数百个表！）。

该向导可以处理“添加新”项目，但是一些更改，例如更改复合键和重命名列 - 它不知道该做什么 - 所以它不会尝试 - 并且事情会不同步。

所以：从模型（概念模式）和 Model.Store 中删除有问题的表，然后使用向导更新模型，并仅重新添加有问题的表。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-17T14:10:54.003

只是为以前不必这样做的人提供更多细节。我正在使用安装了更新 4 的 Visual Studio 2013。我在表中添加了一些字段，从我的模型中删除了表，然后去更新，它不会让我检查任何表。

我确实有一个主键。

我创建了一个新的测试表，它出现了，它可以让我检查它，但不是我原来的。

我以前从未在 XML 中打开过它，也不知道该怎么做。您右键单击 .edmx 文件并“打开方式”——选择 xml 编辑器。

有问题的表在那里很好，它甚至有新的字段（奇怪）。

我删除了所有对它的引用（花了几次）——在你删除一个并保存之后，如果你尝试打开它并且它不会显示，那就继续并选择“查看 XML”——看看错误，基本上跟随弹跳球，直到你把它清理干净。

希望额外的细节对某人有所帮助。

乔

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-08-05T16:33:08.527

我发现的一种简单方法是（在 SQL Server Management Studio 中）添加一个 INT 类型的 ID 列，取消选择“允许 Nulls”，然后在 Column properties (of ID) >> Identity Specification >> check (Is Identity) 下，并使确定增量已设置。

完成上述操作后，返回 .edmx 窗口，右键单击并从数据库更新模型。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-05-26T15:34:45.640

您可以添加主键列交叉表。然后问题正在解决

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-08-31T18:37:29.120

另一种解决方案是确保您访问数据库的帐户对表具有某些权限，至少选择。如果帐户没有权限，则不会添加该表。

在安全性下的 SSMS 中，右键单击用户或角色，然后单击属性。然后点击 Securables。顶部表格显示当前可访问的表格。如果缺少的表不存在，请单击搜索并查找，然后在顶部表中突出显示它们，然后在下部表中分配权限

# nhibernate - 使用 nhibernate 基于计算进行排序 - 最佳实践

> ID：543976
> 
> 赞同：1
> 
> 时间：2009-02-12T23:19:19.067
> 
> 标签：nhibernate, calculated-columns

我需要根据计算使用排序顺序进行分页。该计算类似于 reddit 的热度算法，因为它依赖于时间 - 自发布以来的时间。

我想知道最好的做法是什么。是否将这种排序作为 SQL 函数进行，或者每小时运行一次更新以计算整个表。

该表有数十万行。而且我使用的是 nhibernate，所以这可能会导致预定的完整计算出现问题。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T00:12:02.310

它很可能在很大程度上取决于服务器上的负载。我的回答的一些假设：

1.  您的计算很可能并不简单，但会考虑多种因素，包括自发布以来经过的时间

2.  您期望您的网站至少有合理的增长，这意味着新数据将添加到您的表格中。

我建议您最好的选择是计算和存储您的排名值，并且正如 Nuno G 提到的那样，使用有序子句进行检索。正如您所注意到的，可能会产生一些影响，其中两个是：

1.  安排更新
2.  确保访问表

就日程安排而言，您可能能够查看一些智能地重新计算您的价值的方法。例如，您可能能够识别何时可能更改计算（例如，如果更新了相关记录，您可能会触发触发器，将表的 ID 添加到队列中以进行重新计算）。您也可以在范围内进行更新，而不是在整个表中。

您还希望在重新计算时尽量减少对表的任何锁定。有很多方法可以做到这一点，包括设置隔离级别（使用 MS SQL 术语）。如果您真的担心，您甚至可以在外部执行计算（例如在临时表中），然后只需将值更新到主表即可。

作为最后一点，我建议您查看可用的分页选项 - 如果您正在谈论数千条记录，请确保您的机制确定您在 SQL 服务器上需要的页面，这样您就不会将数千行返回到您的应用程序，因为这会减慢您的速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T23:30:08.463

如果您可以使用 SQL 执行计算，请尝试使用 Hibernate 通过执行 SQLQuery 来加载排序集合，其中您的查询包含“ORDER BY”表达式。

# c# - 适用于 Visual Studio 2008 外观的 ToolStripProfessionalRenderer

> ID：543987
> 
> 赞同：3
> 
> 时间：2009-02-12T23:22:32.540
> 
> 标签：c#, .net, winforms, user-interface, themes

我今天遇到了这个[链接](http://www.codeproject.com/KB/menus/Office2007Renderer.aspx)，它为 Office 2007 的外观提供了 ToolStripProfessionalRenderer 实现。

据我所知，自定义它以支持各种其他主题（例如 Office 2007 的银色和黑色主题）将相当简单（尽管很乏味）。

更具体地说，我想找到一个与 Visual Studio 2008 匹配的颜色表。有人知道我在哪里可以找到这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T13:14:42.163

我不久前发现了这个，甚至还有一个书签：http: [//blogs.msdn.com/jfoscoding/articles/489637.aspx](http://blogs.msdn.com/jfoscoding/articles/489637.aspx)

我想这就是你要找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T13:05:28.020

是的，乏味。您可以在 VS2008 SP1 中包含的 MFC Feature Pack 文件中找到颜色设置。有 4 个 Office 主题，每个主题在 vc/atlmfc/include 的子目录中都有一个 style.xml 文件。黑色、蓝色、银色和浅绿色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T09:14:17.163

我在做 WinForms 时发布了有关 Office 2007 风格的信息。

[http://www.lextm.com/index.php/2008/02/office-2007-style/](http://www.lextm.com/index.php/2008/02/office-2007-style/)

尽管 Krypton 没有提供 Visual Studio 2008 样式，但您应该能够自定义，因为它非常灵活。

# .net - Replicating Visual Studio COM registration with a WiX Installer

> ID：543995
> 
> 赞同：38
> 
> 时间：2009-02-12T23:25:32.580
> 
> 标签：.net, windows, com, wix, typelib

Once upon a time, a young, naive engineer thought it would be a good idea to separate out some of the functionality for his app into a COM component, written in C#. Visual studio had all the tools to do that, right? .NET was practically made for this, right? HA! He said, this will be easy. I'll have decent separation of components, keeping business logic away from the front end, and with COM, I'll be able to use it from anywhere! He merrily checked the `register for COM interop` checkbox in the project properties, exposed the classses he wanted, and went on his way.

Oh, the trials such a choice made. The young engineer now, more experienced, would not now wish this upon anyone. However, the burden had been placed upon his shoulders, and the burden remained heavy. He looked to lighten the load.

Along came WiX, a tool for generating Windows Installer files from XML. This intrigued him - it could replicate, quite simply, most of the code needed for a proper windows installer file simply from a handful of configuration files. His sights were looking up.

With WiX 2.0, he could generate quite easily the files needed to register a C# COM object. This involved using the tool tallow. He'd do something like the following:

```
tallow -c -nologo MyComExposedLibrary.dll > MyComExposedLibrary.wxs 
```

which would then be fixed up (at first this was done manually, but eventually I recorded the steps into a small tool set the final directory ref id, component ID, fileID, GUID and codebase).

Then, the ensuing installer would install, and there would be joyous celebration, if the app worked.

Which it did not.

For days the young engineer poured over the differences on his development PC and that of the test install PC. "All the registry keys are the same!" He would exclaim. "Everything for MyComExposedLibrary is registerd, I swear!"

Except, it wasn't.

On the dawn of third day, after many a mountain dew, he realized there was one more object that Visual Studio was registering that his installer was not: the MyComExposedLibrary.tlb file.

Visual Studio, apparently, had been registering this file all along, creating additional subkeys in the `HKLM\Software\Classes\Interface` registry key, and registering the typelib in `HKLM\SOFTWARE\Classes\TypeLib`.

Tallow gave no help, complaining that a .tlb wasn't a file it groked. Nor the WiX 3.0 beta - this seemed to have even more issues getting things working.

I also gave Heat a try. This generated registry elements and class elements. I cleaned up heat's output, and then went to compile it, but got a different error: `error LGHT0130 : The primary key <uuid here> is duplicated in table 'Registry'`. Problem is, as far as I can tell, that uuid doesn't actually exist in any of my wxs source files. If I change around the component ref order in my feature element, a different dll component gives that error. Since I have been unsuccessful at getting a WiX 3.0 version of the project to compile, I haven't been able to confirm whether or not heat gives the right output.

I removed everything from the installer except for one of the assembly that cause this error to appear and tried compiling again. I got the same same error. Arrugh!

So, my good fellows, Windows enthusiasts, and WiX users, there falls two questions:

*   Is a typelib something that WiX can register natively? If so, how?
*   If not, what's the proper way of registering a typelib with a windows installer?

Also, I guess as another part of this, how does Visual Studio determine how to register the typelib? (Edit: looks the [MSDN library article on typelib registration has the names of the keys needed](http://msdn.microsoft.com/en-us/library/ms221610%28vs.71%29.aspx), but I still need to figure out how to get the uuid's. (This is from [this blog post on typelib and COM registration by Larry Osterman](http://blogs.msdn.com/larryosterman/archive/2006/01/09/510856.aspx).) ) Reading a bit more, It may fall to me to register these bits manually, but I hope not...

I evaluated the output from `regasm /regfile:MyDll.dll MyDll.dll`. It looks like these are the same keys that wix generates for the dll. Regasm's other mode, `regasm /tlb:<filename>` generates and registers the typelib for the assembly, but,

> /regfile[:FileName] Generate a reg file with the specified name instead of registering the types. This option cannot be used with the /u or /tlb options

seems the /regfile switch is incompatible with the /tlb switch. Khaaaaaaaan!

**Further update:** It looks like you don't actually *need* to include the .tlb file. [According to this post on wix's typelib element](http://chenhaoyork.wordpress.com/2009/02/15/deploy-customized-arcmap-toolbar-via-wix-2/), an MSI can create/register this as part of the setup process. It all comes down to configuring the WiX document to actually install it by getting the right attributes.

I found out later that you can get the right attributes using heat on the .tlb directly! See [this SO question for more information](https://stackoverflow.com/questions/567925/typelib-generation-and-installation-with-wix).

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-13T15:30:42.447

You should use Heat (WIX 3.0) located in the bin directory of the version you are using. Have a look at this [blog](http://installing.blogspot.com/2006/04/heatexe-making-setup-easier.html "heat.exe - making setup easier") post, we use it here to register all our COM objects, by creating a wix fragment...

something like

```
heat file MyComExposedLibrary.dll -out MyComExposedLibrary.wxs 
```

After, reading your edit, I would create a basic msi with wix that installs the com object only, see if that works ... then you'll know which battlefield to attack ...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T19:19:07.773

I recently ran into this issue, and the simplest workaround I could find follows these steps on the development machine:

1.  Run: Regasm MyDLL.dll /tlb:MyDLL.tlb
2.  Run: Heat file MyDLL.dll -out MyDll-1.wxs
3.  Run: Heat file MyDll.tlb -out MyDll-2.wxs

MyDll-2.wxs contains a `<Typelib>` element that you will want to copy and nest inside the `<File>` element that was generated in MyDll-1.wxs. This will give you a complete `<Component>` element that you can use in the installer project.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T03:06:02.953

To extract the COM information, tallow will use the [regasm.exe tool](http://msdn.microsoft.com/en-us/library/tzat5yw6(VS.71).aspx) included with the .NET framework. It is likely that visual studio uses the same tool to register assemblies when you enable "register for COM interop".

The difference is that tallow will use the regasm /regfile switch to send the information to a .reg file instead of actually registering the assembly. Unfortunately the .reg file generated by regasm.exe is not complete. It skips the typelib entries which it does write to the registry during a real registration. This may be a bug in regasm.

To get your installer working you have three options:

1.  Add the missing registry keys to the tallow output manually. The tallow output is intended to be edited manually and saved along with your other wxs files anyway. You seem to be trying to fully automatically generate a working wxs file but I believe that was never a design goal of tallow.

2.  Use a [custom action](http://wix.sourceforge.net/manual-wix2/wix_xsd_customaction.htm) to invoke regasm from your installer. This is slightly evil because you may lose some of the strong transactional guarantees provided by the windows installer engine. I'm thinking of rollbacks triggered by a failure halfway during the install here.

3.  Avoid the registration altogether by making use of [registration-free COM.](http://msdn.microsoft.com/en-us/library/ms973915.aspx) This will require the creation of manifest files for both the application and the COM library.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-27T16:10:29.380

I know this is an older question, but others may find this useful...

After struggling with this myself, I found that you can capture the type library information by using [tlbexp.exe](https://msdn.microsoft.com/en-us/library/hfzzah2c(v=vs.110).aspx) then heat both the dll and the tlb file. Include the outputs of both of those in your wix project and you should be good to go.

```
tlbexp.exe dllFile.dll /out:dllFile.tlb
heat.exe dllFile.dll ...
heat.exe dllFile.tlb ... 
```***~~~~*****