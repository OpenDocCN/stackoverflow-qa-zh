# StackOverflow 问答 11816000-11816999

# android - 如何从片段适配器启动活动

> ID：11816000
> 
> 赞同：1
> 
> 时间：2012-08-05T11:24:36.117
> 
> 标签：android, adapter, fragment

我有一个带有自定义适配器的列表片段。这个适配器有一个图像的 onClick 事件，我想在其中启动一个新的意图（活动）。我无法做到这一点。

任何人都可以帮助我的代码。

```
viewholder.gMaps = (ImageView) convertView.findViewById(R.id.imgMaps);
viewholder.gMaps.setClickable(true);
viewholder.gMaps.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        Log.v(LOG_TAG, "Not sure how do I start an Activity");
        /*
        Intent intent = new Intent().setClass(((ListViewFragment) context), GMaps.class);
        intent.putExtra("Longitude", mList.get(holder.position).get("Longitude").toString());
        intent.putExtra("Latitude", mList.get(holder.position).get("Latitude").toString());
        startActivity(intent);
        */
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T07:51:19.567

对于仍在寻找答案的人，请参阅以下代码

```
holder.gMaps.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {

                Intent intent = new Intent().setClass(v.getContext(), GMaps.class);
                intent.putExtra("Longitude", mList.get(holder.position).get("Longitude").toString());
                intent.putExtra("Latitude", mList.get(holder.position).get("Latitude").toString());
                v.getContext().startActivity(intent);

            }
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T08:05:30.010

如果您在 Activity 类之外调用 startActivity()，则必须将标志设置为新的 Activity。

```
holder.gMaps.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {

            Intent intent = new Intent().setClass(v.getContext(), GMaps.class);
            intent.putExtra("Longitude", mList.get(holder.position).get("Longitude").toString());
            intent.putExtra("Latitude", mList.get(holder.position).get("Latitude").toString());
            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            v.getContext().startActivity(intent);

        }
    }); 
```

# objective-c - 存储和搜索/索引浮点流

> ID：11816002
> 
> 赞同：2
> 
> 时间：2012-08-05T11:24:58.370
> 
> 标签：objective-c, c, indexing

我正在构建一个应用程序，它接收一个恒定的浮点流（Float64 时间戳），它可以增长到理论上的无穷大。所以我需要把这些浮点数从内存中取出并放到磁盘上。

我希望能够调用一些函数，例如`numberOfFloatsInRange(Float64 min, Float64 max)`. 浮点数已经在流中排序。

我想我应该创建一些索引，也许在某个时间间隔存储一对浮点数/行号？但我真的不确定。例如，流是无限的，随着时间的推移，索引也会超出内存。

实现这种功能的最佳方法是什么，而不必将整个文件读回内存？

最好的问候，彼得

# elisp - 如何在新框架中访问文件

> ID：11816004
> 
> 赞同：2
> 
> 时间：2012-08-05T11:25:09.300
> 
> 标签：elisp

在 Elisp 中编程时，我如何在新框架中访问新文件并切换焦点？-- 我的意思是在一个函数中做了一些事情之后，我创建了一个文件“test.xml”，在我的函数结束时，我想在一个新框架中打开这个 xml 文件并将其显示给用户。我尝试过类似以下的操作，但执行时显示空白缓冲区：

```
(defun transform-file-on-save ()
...
 (new-file-name (concat  (buffer-file-name) ".xml"))
...
(write-region (point-min) (point-max) new-file-name nil 'quietly)
 (switch-to-buffer-other-window new-file-name) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T11:39:40.337

使用`(find-file-other-frame FILENAME &optional WILDCARDS)`代替`switch-to-buffer-other-window new-file-name)`

# c# - 如何从具有子网格视图的网格视图中获取复选框值

> ID：11816007
> 
> 赞同：0
> 
> 时间：2012-08-05T11:25:29.980
> 
> 标签：c#, asp.net, gridview

有人可以告诉我单击按钮时如何获取选中行的列表（嵌套网格中的复选框值（ID =“nestedGridView”）和每个选定行的 docnumber 值）？

```
<asp:GridView ID="gvMaster" runat="server" AllowPaging="True"
 AutoGenerateColumns="False" DataKeyNames="Accountkey"
 DataSourceID="SqlDataSource1" OnRowDataBound="gvMaster_RowDataBound"> 
   <Columns>  
     <asp:TemplateField> 
       <ItemTemplate>  
         <a href="javascript:cx('customerID-<%# Eval("Accountkey") %>');">
           <img id="imagecustomerID-<%# Eval("Accountkey") %>"
            alt="Click to show/hide orders" border="0" src="Border.png" />
         </a> 
         <asp:CheckBox ID="chkselect" Checked="false" runat="server" />
       </ItemTemplate> 
     </asp:TemplateField> 
     <asp:BoundField DataField="Accountkey" /> 
     <asp:BoundField DataField="fullname" /> 
     <asp:TemplateField> 
       <ItemTemplate>  
         <tr><td colspan="100%">  
           <div id="customerID-<%# Eval("Accountkey") %>" style="..."> 
             <asp:GridView ID="nestedGridView" runat="server"
              AutoGenerateColumns="False" DataKeyNames="Id"> 
               <Columns> 
                 <asp:TemplateField> 
                   <ItemTemplate>  
                     <asp:CheckBox ID="chkselect" Checked="false"
                      runat="server" />
                   </ItemTemplate> 
                 </asp:TemplateField>
                 <asp:BoundField DataField="Id" HeaderText="Id"/> 
                 <asp:BoundField DataField="Valuedate" HeaderText="Valuedate"/>
                 <asp:BoundField DataField="Docnumber" HeaderText="Docnumber"/>
               </Columns>
             </asp:GridView>
           </div>  
         </td></tr>  
       </ItemTemplate>  
     </asp:TemplateField> 
   </Columns>  
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:27:02.250

首先获取对子 GridView 的引用，然后使用 FindControl 获取其中的 CheckBox：

```
foreach (GridViewRow row in gvMaster.Rows) 
{
    if (row.RowType == DataControlRowType.DataRow) 
    {
        GridView gvChild = (GridView) row.FindControl("nestedGridView");
        // Then do the same method for check box column 
        if (gvChild != null)
        {
            foreach (GridViewRow row in gvChild .Rows) 
            {
                if (row.RowType == DataControlRowType.DataRow) 
                {
                    CheckBox chk = (CheckBox) row.FindControl("chkselect");
                    if (chk.Checked)
                    {
                        // do your work
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T11:43:26.470

您可以通过 DataRow GridView 和将控件转换为 CheckBox 来获取它：

```
foreach (GridViewRow row in gvMaster.Rows)
{
    if (row.RowType == DataControlRowType.DataRow)
    {
        CheckBox chk = row.FindControl("chkselect") as CheckBox;
        if (chk.Checked)
        {
            // do your work
        }
    }
} 
```

# r - 参考类字段消失

> ID：11816015
> 
> 赞同：3
> 
> 时间：2012-08-05T11:26:57.827
> 
> 标签：r, cran, reference-class

我决定再给参考类一个机会，但我的第一个 hello world 已经给我带来了问题。这里出了什么问题？

```
> memory <- setRefClass(
+   Class = "memory",
+   fields = list(state="vector"),
+   methods = list(
+     get = function() { return(state) },
+     set = function(x) { state <<- x }
+   )
+ )$new()

> memory$set(123)

> print(memory)
Reference class object of class "memory"
Field "state":
[1] 123

> memory$get()
[1] 123

> print(memory)
Reference class object of class "memory"
Field "state":
Error in methods::show(field(fi)) : 
  error in evaluating the argument 'object' in selecting a method for function 'show': Error in get(name, envir = .self) : 
  unused argument(s) (name, envir = .self) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T11:57:09.900

我对[引用类](http://stat.ethz.ch/R-manual/R-patched/library/methods/html/refClass.html)不是很有经验，但根据帮助页面（`?ReferenceClasses`），我认为您必须向`show`您的类添加一个方法才能自动打印您的对象。

```
memory <- setRefClass(
          Class = "memory",
          fields = list(state="vector"),
          methods = list(
          get = function() { return(state) },
          set = function(x) { state <<- x },
          show = function() {methods::show(state)}
          )
          )$new()

memory$set(123)
print(memory)
#[1] 123

memory$get()
#[1] 123

print(memory)
#[1] 123 
```

希望这有帮助

# android - 安卓布局字体

> ID：11816019
> 
> 赞同：0
> 
> 时间：2012-08-05T11:27:18.807
> 
> 标签：android, layout

我有一个列表视图（布局 1），其中的代码来自`android.R.layout.simple_list_item_1`

这是来自的布局代码`android.R.layout.simple_list_item_1`

```
<TextView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/text1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center_vertical"
    android:minHeight="?android:attr/listPreferredItemHeight"
    android:paddingLeft="6dip"
    android:textAppearance="?android:attr/textAppearanceLarge" /> 
```

现在，使用该布局，我创建了一个类似的布局，但有两个不同之处。添加了一个`TextView`，并添加到这两个 TextView`android:layout_weight`中。这是我的新布局中的代码：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <TextView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@android:id/text1"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:gravity="center_vertical"
        android:minHeight="?android:attr/listPreferredItemHeight"
        android:paddingLeft="6dip"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:layout_weight="3" />

    <TextView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@android:id/text2"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:gravity="center_vertical"
        android:minHeight="?android:attr/listPreferredItemHeight"
        android:paddingLeft="6dip"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:layout_weight="1" />

</LinearLayout> 
```

现在，当我创建列表时，两种布局上使用的字体大小是不同的。在布局 2（我创建的那个）中，字体更大。

这是一张图片：

![在此处输入图像描述](../Images/ffd23e2ddf51d369120def3ca1b189c5.png)

如何将我的第二个布局修改为与列表中的完全相同的字体大小`android.R.layout.simple_list_item_1`？

# javascript - 如何将大量文本从 webview 发送到 objc？

> ID：11816020
> 
> 赞同：0
> 
> 时间：2012-08-05T11:27:17.730
> 
> 标签：javascript, objective-c, ios, webview

我正在尝试为 iPhone 构建一个“类似 iBooks”的阅读器。我从我的网络服务接收大量文本（html），将其列列（在 webview 中，通过 javascript），然后尝试将一组“列”从 javascript（来自 webview）发送回目标 c 顺序要创建 viewControllers，我需要使用 UIPageViewController（每列一个，或者基本上每页一个）。

我正在使用 shouldStartLoadWithRequest 拦截 webview 中的每个位置更改，将 url 作为调用方法，并将“/”之后的第一个字符串作为该方法的参数：

```
- (BOOL)webView:(UIWebView*)webViewRef shouldStartLoadWithRequest:(NSURLRequest*)request navigationType:(UIWebViewNavigationType)navigationType
{

    //NSLog(@"REQUEST: %@", request);
    NSURL *URL = [request URL]; //Get the URL

    if ( [[URL scheme] isEqualToString:@"objc"] ) {

        NSMutableString *host = [[URL host] mutableCopy];

        [host appendString:@":"];

        SEL method =  NSSelectorFromString( host );

        NSArray *chunks = [URL pathComponents];

        NSString *stringToPass = [[chunks objectAtIndex:1] stringByReplacingPercentEscapesUsingEncoding:NSASCIIStringEncoding];
        NSLog(stringToPass);

        if ([self respondsToSelector:method])
        {
            [self performSelector:method withObject:stringToPass afterDelay:0.1f];
        }

        return NO;
    }

    return YES;
} 
```

我现在的主要问题是，文本可能太长，以至于 url 无法实际包含它（事实上，如果我 NSLog 它，它会被剪切）。有没有更好的方法来实现同样的目标？

我应该创建一个本地服务器还是打开一个套接字来将数据从 JS 发送到 objc 还是目前有更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T11:19:53.233

You could ask to the webview the code you need by calling a JS function like that:

NSString* htmlData = [_webView stringByEvaluatingJavaScriptFromString:@"jsFunction()"];

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:50:48.417

这有点工作，但您可以定义一个分块协议，用于在位置更改时将数据发送回。这样，每个“列”都可以分解成离散且可消化的数量，并在 iOS 端进行组装。

例如：

```
http://bridge.myapp.com/?segnum=2&segtotal=5 
```

# asp.net-mvc-3 - asp:asp.net mvc3 中的菜单功能

> ID：11816021
> 
> 赞同：0
> 
> 时间：2012-08-05T11:27:24.507
> 
> 标签：asp.net-mvc-3

如何在 ASP.NET MVC3 中使用 aspx 菜单功能。这样单击菜单项将填充gridview。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:06:06.153

ASP.NET MVC 没有像我们在 ASP.NET WebForms 中那样的任何服务器控件。这完全是关于手工编写纯 HTML 代码。（Webforms 中的所有服务器控件也会生成 HTML 并呈现给浏览器）

您可以做的是，为您的菜单项设置标签。然后在单击时，您可以调用另一个操作方法，该方法会加载要以表格格式显示的所有数据。如果这些菜单将出现在所有页面中，您可以将它们保留在 _layout.cshtml 中，这将起到母版页的作用。

如果您想在不重新加载页面的情况下将一些数据加载到 Table(UI)，您可以使用 jQuery ajax 来完成。

假设您的菜单有一些类似这样的标记，下面的代码使用 jQuery 加载函数从您的 Action 方法加载响应。

```
//Don't forget to include jQuery library 
<ul>
  <li>@Html.ActionLink("Users","List","Users",null,new {@class="ajaXMenu"})</li>
  <li>@Html.ActionLink("Jobs","List","Jobs",null,new {@class="ajaXMenu"})</li>
</ul>
<div id="contentDiv"></div>  
<script type="text/javascript>
   $(function(){
       $("a.ajaXMenu").click(function(e){
         e.preventDefault();
         $("#contentDiv").load($(this).attr("href"));

       });
   });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:06:51.357

首先，您可能想要研究 MVC 的站点地图之类的东西，其中有一个非常好的开源选项： [https ://github.com/maartenba/MvcSiteMapProvider](https://github.com/maartenba/MvcSiteMapProvider)

然后你会想要实际的菜单。没有 MVC 菜单控件，因此您必须自己创建一个，或者使用其他人的。Twitter bootstrap 有一个相当不错的导航菜单：http: [//twitter.github.com/bootstrap/components.html#navbar](http://twitter.github.com/bootstrap/components.html#navbar)

此外，telerik 有一个你也可以使用的菜单，但是这个你需要一个许可证： [http ://demos.kendoui.c​​om/web/menu/index.html](http://demos.kendoui.com/web/menu/index.html)

# c# - 带有构造函数参数的 Castle Windsor Auto 注册

> ID：11816025
> 
> 赞同：1
> 
> 时间：2012-08-05T11:28:25.407
> 
> 标签：c#, .net, dependency-injection, castle-windsor

```
public abstract class BattleVehicle : IVehicle {
  public BattleVehicle (IList<IGuns> someGuns, ISolider driver) { /*...*/ }
}
public class BigAssTank : BattleVehicle, ITank { /*...*/ }
public class AngryBirdsAPC : BattleVehicle, IAPC { /*...*/ }
//and a lot more of these battle vehicles .... 
```

现在，按照标准，我希望每辆战车注册 2 把手枪`List<Pistols> twoPistols`和 1把`Rookie : ISolider`作为默认驾驶员。我该怎么做呢？

我期待类似的东西：

```
container.Register(Classes
                  .FromAssemblyContaining<IVehicle>()
                  .BasedOn<IVehicle>()
                  .DependsOn(new {someGuns = twoPistols, driver = rookie}) //won't work here.... 
```

这当然行不通。从 09 年开始，我只在[这里](https://stackoverflow.com/questions/1686801/castle-windsor-auto-register-types-that-have-dependency-in-constructor)找到了一篇相当老的帖子。我不确定现在流利地注册所有具体车辆的正确方法是什么。请帮助和/或将我链接到任何高级自动注册教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T06:22:32.803

您应该使用`Configure`扩展方法。用法：

```
container.Register(
    Classes
        .FromAssemblyContaining<IVehicle>()
        .BasedOn<IVehicle>()
        .Configure(k => 
            k.DependsOn(new {someGuns = twoPistols, driver = rookie}))) 
```

# android - 解释 GoogleApi savedInstanceState

> ID：11816026
> 
> 赞同：1
> 
> 时间：2012-08-05T11:28:25.687
> 
> 标签：android, bundle

在 Google Api 示例代码中，他们有一个关于保存状态的非常简单的示例。我需要这个来处理屏幕旋转。

`getSavedText()`我的问题是我不明白方法`setSaveText()`从哪里调用。我把调试器放在他们身上，但它永远不会被触发。整个事情只是通过“魔术”起作用。我还能节省哪些其他东西？我在哪里可以找到解释魔法的文档

```
public class SaveState extends Activity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_save_state);
    ((TextView)findViewById(R.id.msg)).setText(R.string.hello_world);
}
CharSequence getSavedText() {
    return ((EditText)findViewById(R.id.saved)).getText();
}
void setSavedText(CharSequence text) {
    ((EditText)findViewById(R.id.saved)).setText(text);
} 
} 
```

链接 [http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/app/SaveRestoreState.html](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/app/SaveRestoreState.html)

备用链接 [http://goo.gl/6TJy5](http://goo.gl/6TJy5)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T01:45:06.300

这个 Api Demo 示例很糟糕，因为当您阅读文档时，您期望它会覆盖 onSaveInstanceState() 方法而不是在 onCreate() 或 onRestoreInstanceState() 中使用持久状态，这令人困惑，但事实并非如此。

首先 getSavedText() 和 setSavedText() 方法没有在这个*Save & Restore State*活动中使用。它们在*LocalSample Instrumentation*示例中使用/调用。

忘记这两种方法可以擦除它们。让我们来看看这个示例是如何工作的；在后台 Android 调用**onRestoreInstanceState()**并使所有 UI 视图将其状态保持到方法的 Bundle 参数。请调试代码并在旋转屏幕后检查此示例的 onCreate() 方法中的 savedInstanceState 参数。您将在该 Bundle 中看到 R.id.saved EditText 的*旋转文本之前。*主要技巧是，为什么 EditText 之一保存其状态而另一个不保存是因为 EditText 的**freezesText**属性。freezesText 属性使 EditText/TextView 将其状态保存在 onSaveInstanceState 方法中。请[在此处](http://developer.android.com/reference/android/widget/TextView.html#attr_android%3afreezesText)查看有关 freezesText 的更多信息。

删除 android:freezesText="true" 或从 save_restore_state.xml 将其设为 false 或覆盖 onRestoreInstanceState 方法，不要调用 super.onRestoreInstanceState() 并观察它在旋转后失去其状态（配置更改）。

注意：您不必为此示例重写 onRestoreInstanceState 方法，但对于保存 Activity 的内部状态的其他要求，您必须这样做。

# mysql - mysql 我应该在 mysql 查询中使用撇号吗？

> ID：11816028
> 
> 赞同：5
> 
> 时间：2012-08-05T11:28:33.097
> 
> 标签：mysql, coding-style, standards

在数字数据类型上向 MySQL 数据库写入查询的正确方法是什么：

```
 SELECT * FROM accounts WHERE id = 5; 
```

或者

```
 SELECT * FROM accounts WHERE id = '5'; 
```

主要是我更喜欢最后一个，`'`因为它更符合文本数据类型。

会影响性能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T11:33:32.530

引号用于字符串，MySQL 将读取这些引号，然后将其转换为整数，这比仅将 int 开始时要慢。

老实说，性能差异很小，但这就像编写一个程序，将数字存储在字符串中，然后在需要进行一些数学运算时转换为 int。这是不好的做法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T11:33:54.503

我怀疑您是否可以衡量两个查询速度之间的任何显着差异。如果您关心性能，则应确保在`id`列上有索引。如果这样做，两个查询都会非常快。

但是有安全方面的考虑。

**MySQL官方意见**

[MySQL 客户端安全指南](http://dev.mysql.com/doc/refman/5.6/en/secure-client-programming.html)建议您使用引号。

> 一个常见的错误是只保护字符串数据值。记住也要检查数字数据。如果应用程序在用户输入值 234 时生成诸如 SELECT * FROM table WHERE ID=234 之类的查询，则用户可以输入该值`234 OR 1=1`以使应用程序生成查询`SELECT * FROM table WHERE ID=234 OR 1=1`。结果，服务器检索表中的每一行。这会暴露每一行并导致过多的服务器负载。**防止此类攻击的最简单方法是在数字常量周围使用单引号：`SELECT * FROM table WHERE ID='234'`** .

强调我的。

**我的意见**

尽管文档建议使用引号，但它既没有*必要*也*不足以*防止它描述的攻击。例如，将攻击者的字符串更改为`234' OR '1'='1`会破坏他们的方法。

在我看来，使您的应用程序安全的更好方法是使用**参数化查询**，而不是将用户值直接放入字符串中。

如果由于某种原因您不能使用参数化查询，则不要使用引号，而是通过使用[`intval`](http://php.net/manual/en/function.intval.php)函数确保变量确实包含整数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T11:35:07.070

当数据库中的字段类型是字符串时，请使用引号。否则，如果它是数字，则不要使用引号。如果您对数字字段类型使用引号，它确实会减慢查询速度，因为 mysql 必须将字符串与数字匹配。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T11:34:10.887

根据 id 的类型，您可以使用“5”或 5。通常 id 是主键并且是 int 类型，因此您应该使用 5

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-05T11:46:31.823

对类型被定义为数字的列使用带引号的数字有一*点点*与使用不带引号的值相比，性能会受到影响，因为服务器必须在查询编译期间将字符串转换为正确的类型。除此之外，它没有任何效果，而且您​​可能根本难以测量命中率。（请注意，由于“0”和 0 都作为字符串发送到服务器，因此无论如何都必须在使用之前将它们转换为字段的内部类型，因此发送“0”只会强制执行一个额外的步骤。首先解析器解析出“0”然后优化器注意到列类型是数字并相应地转换它。OTOH，使用 0 解析器将其解析为数字 [存储为 long int iirc]，然后注意字段的类型，并转换如有必要，将数字转换为适当的字段类型。因此差异确实是微不足道的）。

但是，对类型定义为*文本的列使用不带**引号*的数字是一个非常非常糟糕的主意，因为这意味着服务器不能使用列上的任何索引来解析查询。

 *重要的是要理解，尽管任何给定的字符串都可以精确地数字化为一个数值，但有一组几乎无限的字符串可以数字化为给定的数字值。考虑“0”、“0E0”、“0.0”等。这解释了为什么在字段为数字时引用约束并不是很糟糕，只有要执行的操作，它解释了为什么在字段中不引用约束*是*不好的不是数字，因为这意味着服务器必须在进行比较之前将表中的每个字符串转换为一个数字，从而强制进行表扫描。*

# c# - 如何将枚举发送到 python tcp 服务器？

> ID：11816035
> 
> 赞同：1
> 
> 时间：2012-08-05T11:29:56.420
> 
> 标签：c#, python, sockets, serialization, tcp

我正在尝试让两个系统进行通信，我希望我的 C# 应用程序与用 Python 编写的 TCP 服务器进行垃圾通信。

首先我想到了序列化，并好好看看google的protobuf。但是，如果您有复杂的类型和数据结构，您是否只需要序列化。我不。我只想发送一个[枚举](http://msdn.microsoft.com/en-us/library/sbbt4032%28v=vs.80%29.aspx)（*枚举元素的默认基础类型是 int（有符号 32 位整数）。*）。

但是定义的枚举相当大（C#）：

```
[Flags]
public enum RobotCommands
{
    reset = 0x0,        // 0
    turncenter = 0x1,   // 1
    turnright = 0x2,    // 2
    turnleft = 0x4,     // 4
    standstill = 0x8,   // 8
    moveforward = 0x10, // 16
    movebackward = 0x20,// 32
    utility1on = 0x40,  // 64
    utility1off = 0x80, // 128
    utility2on = 0x100, // 256
    utility2off = 0x200 // 512
} 
```

所以真的，我需要序列化吗？Python能够读取我发送的枚举的最简单方法是什么？

我尝试将其作为字符串发送，希望将它们转换回来，但它们似乎是字符串：

```
#!/usr/bin/env python

import socket

TCP_IP = '192.168.1.66'
TCP_PORT = 30000
BUFFER_SIZE = 20  # Normally 1024, but we want fast response

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
s.bind((TCP_IP, TCP_PORT))
s.listen(1)

conn, addr = s.accept()

print 'Connection address:', addr

while True:
    data = conn.recv(BUFFER_SIZE).encode("hex")
    print "received data:", data    

    if( (data & 0x8) == 0x8 ):
        print("STANDSTILL");

    if not data: break

    conn.send(data)

conn.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T11:35:31.040

只需将枚举作为字符串传递就可以了。您可以使用`int`方法将它们恢复为整数。

```
cmd = int(data); 
```

如果你想要十六进制版本，使用：

```
cmd = hex(int(data))

int(x[, base]) -> integer                                                                           

Convert a string or number to an integer, if possible.  A floating point
argument will be truncated towards zero (this does not include a string
representation of a floating point number!)  When converting a string, use
the optional base.  It is an error to supply a base when converting a
non-string.  If base is zero, the proper base is guessed based on the
string content.  If the argument is outside the integer range a
long object will be returned instead.

hex(number) -> string                                                                               

Return the hexadecimal representation of an integer or long integer. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T11:37:30.390

在那种情况下，我只会发送一个 4 字节的网络字节顺序块的基础值，即

```
RobotCommands cmd = ...
int i = (int) cmd; 
```

您可以通过多种方式获取字节；可能是 NetworkStream 上的 BinaryWriter，可能是 BitConverter，或者可能只是移位运算符。然后用您的其他语言读取相同的 4 个字节，并将它们视为整数。您应该能够将整数转换为任何语言的 ipenum，或者：只需使用按位运算符。

# codeigniter - CodeIgniter 中的 PayPal Express Checkout 集成

> ID：11816040
> 
> 赞同：2
> 
> 时间：2012-08-05T11:31:15.520
> 
> 标签：codeigniter, paypal

几天来，我一直在寻找 PayPal Checkout Express 集成。

我找不到支持此过程的好文档。

大多数人推荐这个网站，但该文件不存在。 [https://github.com/EllisLab/CodeIgniter/wiki/PayPal-Lib](https://github.com/EllisLab/CodeIgniter/wiki/PayPal-Lib)

我已经尝试过 PayPal 提供的 PHP 版本代码，但是您知道将代码转换为 Codeigniter MVC 平台需要时间。

那么，你能告诉我在哪里可以得到一个好的教程吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T07:58:06.560

我用这个，也适用于非网站支付专业账户： [http ://www.angelleye.com/download-codeigniter-php-library-for-paypal-payments-pro/](http://www.angelleye.com/download-codeigniter-php-library-for-paypal-payments-pro/)

# android - Android ActionBar - 将自定义视图推送到屏幕底部

> ID：11816041
> 
> 赞同：16
> 
> 时间：2012-08-05T11:31:33.877
> 
> 标签：android, android-actionbar

我有一个拆分的 ActionBar，我正在尝试添加与 google play 的“正在播放”几乎相同的功能..

我可以使用 onCreateOptionsMenu 让菜单项出现在屏幕底部，但使用 actionBar.setCustomView 时似乎无法让自定义视图出现在屏幕底部。自定义视图位于顶部 ActionBar 的下方。

有谁知道如何将自定义视图强制到底部，或将自定义视图添加到 onCreateOptionsMenu？

以下是我的代码片段：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    ActionBar actionBar = getActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    actionBar.setDisplayShowTitleEnabled(true);
    actionBar.setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM);

    //Custom view to add
    actionBar.setCustomView(R.layout.albumitem);
            //This view shows up just under the top actionbar at the moment,
              despite menu items being at the bottom 
```

菜单选项代码：（这些显示在我希望自定义视图所在的底部）

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    new MenuInflater(this).inflate(R.menu.option_menu, menu);

    return (super.onCreateOptionsMenu(menu));
} 
```

我相信谷歌播放音乐应用程序底部的正在播放菜单是拆分操作栏中​​的自定义视图：

![谷歌播放音乐](../Images/2a9c89db44b06179bcff535eee97ae00.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-16T04:05:18.887

所以我设法找到了一个肮脏的解决方案..好吧，在我的业余意见中很肮脏..

在 oncreateOptionsMenu 中，我膨胀了一个名为 option_menu 的菜单，如下所示：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
        new MenuInflater(this).inflate(R.menu.option_menu, menu); 
```

在该 option_menu 项的 xml 中，我实现了一个 actionViewClass，在这种情况下，我使用了相对布局（我猜我可以只使用 View..？）：

```
<item
    android:id="@+id/layout_item"
    android:actionViewClass="android.widget.RelativeLayout"
    android:showAsAction="always|withText"
    android:title="Text 1"/>

</menu> 
```

然后我扩充了一个 xml 布局，并将其添加到我的菜单中定义的 layout_item 中：

```
 @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        new MenuInflater(this).inflate(R.menu.option_menu, menu);
        relativeLayout = (RelativeLayout) menu.findItem(R.id.layout_item)
                .getActionView();

        View inflatedView = getLayoutInflater().inflate(R.layout.now_playing,
                null);

        relativeLayout.addView(inflatedView);

        return (super.onCreateOptionsMenu(menu));
    } 
```

如果您认为合适，请随时编辑/增强此答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-26T09:55:45.827

我已经根据您的解决方案完成了一个解决方案，包括顶部的自定义布局+底部的自定义布局+标题/副标题+主页图标。这是代码：

```
public class SplitABActivity extends Activity{
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ActionBar ab = getActionBar();
    ab.setTitle("Action Bar Title");
    ab.setSubtitle("Action Bar Subtitle");
    ab.setDisplayShowHomeEnabled(true);

    LayoutInflater inflater = (LayoutInflater) getSystemService(Activity.LAYOUT_INFLATER_SERVICE);
    RelativeLayout layout = (RelativeLayout) inflater.inflate(R.layout.ab_custom_layout, null);
    ab.setCustomView(layout);
    ab.setSplitBackgroundDrawable(new ColorDrawable(Color.BLUE));
    ab.setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM  | ActionBar.DISPLAY_SHOW_HOME | ActionBar.DISPLAY_SHOW_TITLE);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu_including_layout, menu);
    RelativeLayout layout = (RelativeLayout) menu.findItem(R.id.layout_item).getActionView();
    View v = getLayoutInflater().inflate(R.layout.ab_bottom_layout, null);
    layout.addView(v); 

    return super.onCreateOptionsMenu(menu);
}
} 
```

ab_custom_layout.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:gravity="right"
    >
   <TextView android:id="@+id/element1" 
       android:layout_width="wrap_content" android:layout_height="wrap_content"
       android:textColor="#fff"
       android:background="#ff0000"
       android:text="Element 1"/>

   <TextView
       android:id="@+id/element2" 
        android:layout_width="wrap_content" android:layout_height="wrap_content"
        android:textColor="#000"
        android:background="#f0f0f0"
        android:layout_toRightOf="@+id/element1"
       android:text="Element 2"/>

</RelativeLayout> 
```

menu_included_layout.xml

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

<item android:id="@+id/action1"
    android:title="Action 1"
      android:icon="@android:drawable/ic_dialog_alert"
      android:showAsAction="ifRoom" />

<item android:id="@+id/action2"
    android:title="Action 2"
      android:icon="@android:drawable/ic_dialog_info"
      android:showAsAction="ifRoom" />

<item
android:id="@+id/layout_item"
android:actionViewClass="android.widget.RelativeLayout"
android:showAsAction="always|withText"
android:title="Layout Item"/>
 </menu> 
```

ab_bottom_layout.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
 >

<TextView 
    android:id="@+id/bottom_layout_txt_status"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Click this button"/>

<ImageButton android:id="@+id/bottom_layout_btn_chat"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@android:drawable/ic_menu_camera"
    android:layout_toRightOf="@+id/bottom_layout_txt_status"
    android:contentDescription="@string/app_name"/>
</RelativeLayout> 
```

代码对我来说很完美。当我的平板电脑处于纵向时，我可以看到拆分的 ActionBar。在横向上，它的宽度足以将所有物品存放在顶部。

希望能帮助到你

# php - 如何在 php 中使用 rsa 加密和解密小文本？

> ID：11816044
> 
> 赞同：0
> 
> 时间：2012-08-05T11:32:51.753
> 
> 标签：php, encryption, rsa

如何在不打开 ssl 的情况下在 php 中使用 rsa 加密和解密小文本？私钥和公钥都是静态的，并且在同一个程序中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T15:23:43.640

我建议你使用[phpseclib](http://phpseclib.sourceforge.net/)。它管理 RSA 并为您提供几个示例用法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T20:44:09.383

如果您必须自己实现它，我建议`bcmath`进行任意精度计算。

您应该[为模幂运算实现一个有效的算法](http://en.wikipedia.org/wiki/Modular_exponentiation)。

完成后，您可以使用该实现来实现 RSA 操作。

RSA 本身很简单……但它只能加密数字，所以你必须为你的文本找到一个数字表示。请记住，数字表示必须在数值上小于模数，否则将无法解密。

我的方法是找到一个足够小的块大小，将明文分割成那个大小的块，然后用 RSA 加密这些块。这对于学校作业来说非常好，但请注意，这不是现实世界应用程序中最聪明的想法。

# bash - 输入键、向上翻页和向下翻页的标志

> ID：11816046
> 
> 赞同：-2
> 
> 时间：2012-08-05T11:33:16.703
> 
> 标签：bash

任何人都建议如何添加字符以按 Enter，向上翻页和向下翻页

```
UP_ARROW=$'\x1b[A'
DOWN_ARROW=$'\x1b[B'
LEFT_ARROW=$'\x1b[D'
RIGH_TARROW=$'\x1b[C'

ENTER=???
PAGE_UP=???
PAGE_DOWN=??? 
```

非常感谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T14:55:34.850

尝试按`Ctrl`-`v`然后按您感兴趣的字符。您将得到它的表示作为响应。

请注意，其中许多击键取决于您使用的终端。

另请参阅`man 5 terminfo`。您可以获取向上翻页键的值，例如，通过执行

```
tput kpp | hexdump -C 
```

`kpp`是“上一页键”

# php - 包含的 PHP 页面中的 jQuery 代码

> ID：11816050
> 
> 赞同：0
> 
> 时间：2012-08-05T11:34:04.763
> 
> 标签：php, javascript, jquery, include, slidetoggle

我目前遇到 PHP 和 jQuery 的问题。

我已经建立了一个这样的网站：

header.php - 这是加载所有 css 和 js 文件的地方。index.php - 主页。sidemenu.php - 这是包含在 index.php 中的侧面菜单

在 sidemenu.php 我有这个 JS 代码：

```
 <script type="text/javascript">
    jQuery(document).ready(function($) {
        $(".more").live('click', function(){
        $(this).next(".submenu").slideToggle(500); });
    });
    </script> 
```

哪个应该让 .more 滑动切换：

```
<div class="twocol" id="side-menu">

    <ul class="menu">
        <li>Dashboard</li>     
        <li class="more"><a href="#">Security Settings</a> <img src="images/dropdown-menu.png" align="right"></li>
            <ul class="submenu">
                <li>Blacklistings</li>
                <li>New Membership Package</li>  
            </ul>                        
        <li class="more"><a href="memberships.php">Memberships</a> <img src="images/dropdown-menu.png" align="right"></li>
            <ul class="submenu">
                <li>New Membership</li>
                <li>New Membership Package</li>  
            </ul>         
        <li>Forums</li>  
        <li>Help Desk</li>
        <li class="help">Documentation</li>    
    </ul>   

</div><!-- END 2col --> 
```

然而，当我单击 .more 时，什么也没有发生。

很奇怪，如果我只是用上面三个页面的源代码制作一个页面，它就可以工作。

我究竟做错了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T11:37:52.083

~~你应该更换：~~

 ~~```
$(this).next(".submenu").slideToggle(500); 
```~~ 

经过

```
$(this).children(".submenu").slideToggle(500); 
```

~~（接下来在同级调用下面的标签）~~

**编辑 ：**

我有点盲目，我没有看到你在用你的子菜单`.more`打开标签之前关闭了标签`<ul>`。但是，这向我展示了另一个问题：您将元素放在与同一标签内的元素`<li>`相同的级别。`<ul>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T11:39:36.450

您使用的是哪个版本的 jQuery？我在 jQuery 网站上找到了这个：

> 从 jQuery 1.7 开始，不推荐使用 .live() 方法。使用 .on() 附加事件处理程序。旧版本 jQuery 的用户应该使用 .delegate() 而不是 .live()。

# facebook - 加载 Facebook javascript

> ID：11816052
> 
> 赞同：0
> 
> 时间：2012-08-05T11:34:27.913
> 
> 标签：facebook, asp.net-mvc-3

我正在制作facebook登录，如下所示。但事件不会触发**（ FB.Event.subscribe(..), GetFBLoginStatus())**。我在本地主机上运行它并在我的应用程序中指定它，但为此没有必要。看起来 javascript 未加载，但 facebookbutton 呈现。我必须更改什么？当我单击“登录”时弹出窗口询问权限但仅此而已。

```
 <html>
<head>
  <title>My Facebook Login Page</title>
</head>
<body>

  <div id="fb-root"></div>
  <script type ="text/javascript">
      window.fbAsyncInit = function () {
          FB.init({
              appId: 'some id', // App ID
              status: true, // check login status
              cookie: true, // enable cookies to allow the server to access the session
              xfbml: true  // parse XFBML
          });
          FB.Event.subscribe('auth.login', function (response) { alert('You logged in'); });
      };
      // Load the SDK Asynchronously
      (function (d) {
          var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
          if (d.getElementById(id)) { return; }
          js = d.createElement('script'); js.id = id; js.async = true;
          js.src = "//connect.facebook.net/en_US/all.js";
          ref.parentNode.insertBefore(js, ref);
      } (document));

      function GetFBLoginStatus() {
          FB.getLoginStatus(function (response) {
              console.log(response);
              if (response.status === 'connected') {
                  var accessToken = response.authResponse.accessToken;
                  alert(accessToken);
              } else if (response.status === 'not_authorized') {
                  //login function
                  alert('login first');
              } else {
                  //login function
                  alert('login first');
              }
          }, true);
      }
  </script>
    <div class="fb-login-button"  scope="email,user_checkins,read_mailbox">Login with Facebook</div>
      //this function is not work -> javascript not loaded?
    <button onclick = "GetFBLoginStatus();">GetStatus</button>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T02:11:52.717

也许问题是本地主机不接受 cookie。这种情况经常发生。必须启用 cookie，因为这是 FB JS SDK 将用户登录信息传递到您的页面的方式。我通常编辑我的系统/主机以通过 www.localhost.com 访问 localhost。这样，浏览器就不会检测到本地主机并写入所有必要的 cookie。

此外，最好在`GetFBLoginStatus()`内部定义您的函数`window.fbAsyncInit`，因为它可以在 FB.init 之前调用，并且会崩溃，因为`FB.getLoginStatus`尚未创建 FB 对象（在您的函数内部使用：）。

我听到有人说，`auth.login`当用户已经授权您的应用程序时，有时事件不会触发。那是因为此事件仅在状态更改为连接时触发。如果用户过去已授权，则没有任何变化。还有其他事件，例如`auth.authResponseChange`和`auth.statusChange`。也许它们可以更好地满足您的需求。

# c - Linux 上 C 中的 UDP 发送方和 Windows 上 Qt 中的接收方不起作用？

> ID：11816062
> 
> 赞同：0
> 
> 时间：2012-08-05T11:36:13.563
> 
> 标签：c, windows, linux, qt

Qt broadcastreceiver 在 Linux 上不能与 sender 一起使用。发件人是用c写的。

我已经在 Windows 上用 Qt 广播发送器测试了 Qt 广播接收器，这没问题，而且 Qt 广播发送器在 C 中的 linux 接收器上也能正常工作。

在 Windows 上从 linux 接收数据时可能出现什么问题。

这是相同的代码。

发件人（Qt/windows）：main.cpp

```
#include <QApplication>
#include "receiver.h"

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    Receiver receiver;
    receiver.show();
    return app.exec();
} 
```

接收器.h

```
#ifndef RECEIVER_H
#define RECEIVER_H

#include <QtGui>
#include <QtNetwork/QUdpSocket>
#include <QWidget>

class Receiver : public QWidget
{
    Q_OBJECT

public:
    Receiver(QWidget *parent = 0);

private slots:
    void processPendingDatagrams();

private:
    QLabel *statusLabel;
    QPushButton *quitButton;
    QUdpSocket *udpSocket;
};

#endif 
```

接收器.cpp

```
#include <QtGui>
#include <QtNetwork>

#include "receiver.h"

#define PORT 45454

Receiver::Receiver(QWidget *parent): QWidget(parent)
{
    statusLabel = new QLabel(tr("Listening for broadcasted messages"));
    statusLabel->setWordWrap(true);

    quitButton = new QPushButton(tr("&Quit"));

    udpSocket = new QUdpSocket(this);
    bool b = udpSocket->bind(QHostAddress::Any,PORT, QUdpSocket::ShareAddress);

    connect(udpSocket, SIGNAL(readyRead()), this, SLOT(processPendingDatagrams()));
    connect(quitButton, SIGNAL(clicked()), this, SLOT(close()));

    QHBoxLayout *buttonLayout = new QHBoxLayout;
    buttonLayout->addStretch(1);
    buttonLayout->addWidget(quitButton);
    buttonLayout->addStretch(1);

    QVBoxLayout *mainLayout = new QVBoxLayout;
    mainLayout->addWidget(statusLabel);
    mainLayout->addLayout(buttonLayout);
    setLayout(mainLayout);

    setWindowTitle(tr("Broadcast Receiver"));
}

void Receiver::processPendingDatagrams()
{
    while (udpSocket->hasPendingDatagrams())
    {
        QByteArray datagram;
        datagram.resize(udpSocket->pendingDatagramSize());
        udpSocket->readDatagram(datagram.data(), datagram.size());
        statusLabel->setText(statusLabel->text() + tr("Received datagram: \"%1\"").arg(datagram.data()));
    }
} 
```

广播接收器.pro

```
HEADERS       = receiver.h
SOURCES       = receiver.cpp \
                main.cpp
QT           += network

# install
target.path = $$[QT_INSTALL_EXAMPLES]/network/broadcastreceiver
sources.files = $$SOURCES $$HEADERS $$RESOURCES $$FORMS broadcastreceiver.pro
sources.path = $$[QT_INSTALL_EXAMPLES]/network/broadcastreceiver
INSTALLS += target sources

symbian: {
    TARGET.CAPABILITY = NetworkServices
    include($$PWD/../../symbianpkgrules.pri)
}
maemo5: include($$PWD/../../maemo5pkgrules.pri)
contains(MEEGO_EDITION,harmattan): include($$PWD/../../harmattanpkgrules.pri) 
```

发件人.c (C/Linux)

```
#include <stdio.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <netinet/in.h>

#define BUFLEN 512
#define NPACK 10
#define PORT 45454

#define SRV_IP "xxx.xxx.xxx.xxx"

void diep(char *s)
{
    perror(s);
    exit(1);
}

int main(void)
{
    struct sockaddr_in si_other;
    int s, i, slen=sizeof(si_other);
    char buf[BUFLEN];

    if ((s=socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP))==-1)
    {
        diep("socket");
        printf("\n\tSocket error\n");
    }

    memset((char *) &si_other, 0, sizeof(si_other));
    si_other.sin_family = AF_INET;
    si_other.sin_port = htons(PORT);
    if (inet_aton(SRV_IP, &si_other.sin_addr)==0)
    {
         fprintf(stderr, "inet_aton() failed\n");
        printf("\n\tInet_aton error\n");
        exit(1);
    }

    for (i=0;; i++)
    {
        printf("Sending packet %d\n", i);
        sprintf(buf, "This is packet %d\n", i);
        if (sendto(s, buf, BUFLEN, 0, &si_other, slen)==-1)
     {
            diep("sendto()");
         printf("\n\tSendto error\n");
     }

    printf("Data written on (IP = %s and port : %d\n\n",inet_ntoa(si_other.sin_addr),ntohs(si_other.sin_port));
    sleep(1);
    }

    close(s);
    return 0;
} 
```

问候， Gurmeet

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:42:18.990

我已经尝试了您的代码，几乎一切正常。唯一的问题是，到达的包裹没有在您的视图中正确显示。第一个包裹到达后，上面写着：

```
Listening for broadcasted messagesReceived datagram: "This is packet 
```

然后它停止，因为数据包的内容是终止 QString 的 0 字节。这也意味着不再显示所有后续消息。

我不知道这是否解决了您的问题，也许根本没有数据到达。我使用的是 Linux，我无法向您保证任何适用于 Windows 的内容（尽管 Qt 在 Windows 上的运行效果应该与在 Linux 上一样好），但我可以向您保证您的代码在 Linux 上运行。

# cocos2d-iphone - box2d cocos2d。计算 SetLinearVelocity 的方向

> ID：11816064
> 
> 赞同：1
> 
> 时间：2012-08-05T11:36:23.113
> 
> 标签：cocos2d-iphone, box2d-iphone, direction

我正在创造被屏幕[移动的角色。](https://skitch.com/roma86/ek34f/skitched-20120805-151751)

角色是 box2d 世界中的传感器运动体。运动学因为，我想要有碰撞但没有重力的实体。我正在尝试使用精灵，但碰撞边界框有很多问题，因为物理预兆精灵动画。

对于转换逻辑，我计划使用 SetLinearVelocity(b2Vec2)。

body->SetLinearVelocity(0, 0.5) 移动身体顶部，body->SetLinearVelocity(0.5, 0.5) 移动身体 45 角，它的工作正确。

但我很愚蠢——如何使用这种方法将身体移动到不同的点。

换句话说，我需要创建模拟 CCMoveTo。问题——如何为 SetLinearVelocity 计算真正的 b2Vec2。

另外，如果您知道通过屏幕转换身体的更好方法，请分享您的想法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T09:59:17.097

好的。在 cocos2d-iphone.org 论坛上，我得到了答案。谢谢，伙计们。

```
CGPoint direction = ccp( targetPos.x - startPos.x, targetPos.y - startPos.y );
direction = ccpNormalize(direction);
float speed = 0.25f;
b2Vec2 vel = b2Vec2( speed*direction.x/kPointsToMeterRatio, speed*direction.y/kPointsToMeterRatio );
body->SetLinearVelocity(vel); 
```

# parsing - 通过命令行在括号内插入文本

> ID：11816066
> 
> 赞同：1
> 
> 时间：2012-08-05T11:36:40.717
> 
> 标签：parsing, sed, command

我正在编辑一个文件并希望找到所有出现的

```
\smash{example}
\smash{$example2$} 
```

并将其替换为

```
\smash{\small{example}}
\smash{\small{$example2$}} 
```

分别在命令行中使用“sed”之类的东西。有关如何执行此操作的任何帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T11:54:30.983

这会做到：

```
sed -r 's/(\\smash\{)([^\}]+\})/\1\\small\{\2\}/g' <filename> 
```

它的工作原理如下：

*   用于使用`sed`正则表达式执行文本替换`sed 's/<regexp>/<replacement>/'`
    *   该选项`-r`允许扩展正则表达式（需要引用`\1`and`\2`组），`g`最后的 the 意味着替换应该应用于与`<regexp>`
    *   `<regexp>`图案：分为`(\\smash\{)([^\}]+\})`2组：
        1.  `(\\smash\{)`它只是捕获字符串的第一部分并将其放入组中`\1`
        2.  `([^\}]+\})`大致说“*阅读任何字符序列，直到你得到 a`}`并将其放入第 2 组`\2`*”
    *   现在您可以在零件中使用`\1`和`\2`组并在它们之间`<replacement>`插入`\\small{`。此外，在`}`插入第 2 组后添加精加工。

要了解更多信息`sed`，`regular expressions`您可能想从阅读前[几段](http://www.grymoire.com/Unix/Sed.html)开始。

# stack - 过度使用堆栈

> ID：11816067
> 
> 赞同：0
> 
> 时间：2012-08-05T11:36:52.580
> 
> 标签：stack, computer-science

这确实是一个理论问题。我的示例将使用 C，但语言并不那么重要。

假设我在堆栈上创建了很多很多变量

```
int x0 = 0;
int x1 = 1;
.
.
.
int x100 = 100; 
```

现在我想打电话给 x0。由于堆栈是 LIFO，x100,...,x1 临时存储在哪里，而 x0 正在被获取？我的意思是，它们不必被放在寄存器上吗？如果是这样，根本就没有足够的寄存器。使用自助餐厅托盘的标准类比，如果我试图到达底部托盘，我需要很多人在我拿到它的时候抓住其他托盘，除非有三个堆叠并且我可以做一些“河内塔” “ 解决方案...

显然，这个问题表明我对堆栈及其工作原理的无知。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T12:27:06.610

堆栈的顶部只是一个内存地址，因此您可以使用偏移量访问它。也就是说，这会使您的代码非常脆弱。

LIFO 的全部意义在于，您放的最后一个值就是您需要的下一个值，因此在您的示例中，您要么以相反的顺序推送它们，要么定义一个包含它们的结构并将其推送栈上的地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T11:39:03.220

它不是那种粒度级别的堆栈。

堆栈存储*堆栈帧*。每个堆栈帧存储一组局部变量，当然可以在恒定时间内访问（通过相对于堆栈指针的偏移量）。

# c - C 信号处理程序中的竞争条件

> ID：11816068
> 
> 赞同：4
> 
> 时间：2012-08-05T11:37:06.423
> 
> 标签：c, linux, signals

我正在做一些课程作业，我们看到了以下代码。有些问题问代码的不同行是做什么的，这很好，我理解，但曲线球是“这个程序包含一个竞争条件。它在哪里以及为什么出现？”

编码：

```
#include <stdio.h>
#include <signal.h>

static void handler(int signo) { 
    printf("This is the SIGUSR1 signal handler!\n");
}

int main(void) { 
    sigset_t set;
    sigemptyset(&set);
    sigset(SIGUSR1, handler);
    sigprocmask(SIG_SETMASK, &set, NULL);

    while(1) {
        printf("This is main()!\n");
    }
    return 0; 
```

}

我在想，竞争条件是没有办法知道信号到达时将打印什么顺序“这是主要的”或“这是 SIGUSR1”，但是如果有人可以确认或澄清这一点，我会很感激的。他还询问如何解决（比赛条件），而不是寻找完整的答案，但任何提示都将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T12:36:34.683

真的没有比赛条件；比那更糟。根据 POSIX 标准，*程序的行为是未定义的*（如果信号在正确的时刻传递）。

查看[man 7 signal](http://www.kernel.org/doc/man-pages/online/pages/man7/signal.7.html)手册页，特别是*Async-signal safe functions*下的部分：

> 信号处理函数必须非常小心，因为其他地方的处理可能会在程序执行的某个任意点被中断。POSIX 有“安全功能”的概念。如果信号中断了不安全函数的执行，并且处理程序调用了不安全函数，则程序的行为是未定义的。

请注意，这`printf()`绝对不是*异步信号安全功能*；因此行为未定义。

在一般情况下，解决方案很重要，因为没有异步信号安全锁定原语（除了`sem_post()`，这本身还不够，还有文件锁，必须在所有`printf()`调用中使用）。通用的、可移植的解决方案是使用`pipe()`from创建一个管道`unistd.h`，并使用 将输出写入管道`write()`，并让主程序从管道中读取并“转发”内容。POSIX quarantees 写的比`PIPE_BUF`原子更短`PIPE_BUF`，至少为 512（Linux 中为 4096）——详情请参阅[`man 7 pipe`](http://www.kernel.org/doc/man-pages/online/pages/man7/pipe.7.html)——因此在实践中，对于可移植代码，这也仅限于 512 字节或更短的消息。

通常，在这种特殊情况下，`printf()`将信号处理程序中的 替换为设置全局`volatile sigatomic_t`变量就足够了。然后主循环可以简单地检查（并清除）全局变量并输出消息本身。

虽然标志变量方法可能会丢失快速重复`SIGUSR1`的信号，但它是无关紧要的，因为您*总是* 会丢失快速重复`SIGUSR1`的信号：一次只能挂起一个信号，因此在第一个信号和处理它时发生的重复信号不会在全部！（如果您要使用`SIGRTMIN+0`排队的实时信号，您可以确保通过在主循环中和或在信号处理程序中使用原子内置函数（如或）来捕获每一个信号；两者前面`__sync_fetch_and_and(variable,0)`都有一个确保更改立即生效/对其他人可见。但在这种情况下您无需担心原子操作。）`__atomic_exchange_n(variable,0,__ATOMIC_SEQ_CST)``__sync_fetch_and_add(variable,1)``__atomic_fetch_add(variable,1,__ATOMIC_SEQ_CST)``__sync_synchronize()``__atomic_signal_fence(__ATOMIC_SEQ_CST)`

`sigset()`关于and也有一个有趣的极端情况——不是竞争条件`sigprocmask()`。进程从其父进程继承其信号掩码，`SIGUSR1`默认情况下不阻塞。除非处理，否则它会导致进程终止。因此，根据继承的信号掩码，`SIGUSR1`在调用之前传递的信号`sigset()`要么被阻塞，要么导致进程终止。（但是，如果`set`包含`SIGUSR1`;`SIGUSR1`即被阻塞，那么*将*存在竞争条件，除非`sigprocmask()`在之前调用过`sigset()`。但是，由于`set`是空的，`sigset()`最好在之前调用`sigprocmask()`。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T20:24:55.493

显然，课程的目的是将代码修改为

*   使用一个单独的线程，它接收调用`sigwait()`或`sigwaitinfo()`循环的信号。信号必须被阻塞（首先，并且一直，对于所有线程），或者操作是未指定的（或者信号被传递到另一个线程）。

    这样就没有信号处理函数本身，这将仅限于异步信号安全函数。调用`sigwait()`/的线程`sigwaitinfo()`是一个完全正常的线程，并且不受任何与信号或信号处理程序相关的限制。

    （还有其他接收信号的方法，例如使用设置全局标志的信号处理程序，并进行循环检查。其中大多数导致*忙等待*，运行无操作循环，无用地消耗 CPU 时间：a非常糟糕的解决方案。我在这里描述的方式不会浪费 CPU 时间：内核在调用`sigwait()`/时会将线程置于睡眠状态`sigwaitinfo()`，只有在信号到达时才会将其唤醒。如果你想限制睡眠的持续时间，你可以改为使用`sigtimedwait()`。）

*   由于`printf()`等人。不能保证是线程安全的，您可能应该使用 a`pthread_mutex_t`来保护输出到标准输出——换句话说，这样两个线程就不会尝试同时输出。

    在 Linux 中这不是必需的，因为 GNU C `printf()`（版本除外`_unlocked()`）是线程安全的；对这些函数的每次调用都已经使用了一个内部互斥体。

    请注意，C 库可能会缓存输出，因此要确保输出数据，您需要调用`fflush(stdout);`.

    如果您想以原子方式使用多个`printf()`、`fputs()`或类似调用，而其他线程无法在其间注入输出，则互斥锁特别有用。因此，建议使用互斥锁，即使在简单情况下在 Linux 上不需要它。（是的，您确实希望`fflush()`在持有互斥锁的同时也这样做，尽管如果输出阻塞可能会导致互斥锁被持有很长时间。）

我个人会以完全不同的方式解决整个问题——我会`write(STDERR_FILENO,)`在信号处理程序中使用输出到标准错误，并将主程序输出到标准输出；没有线程或任何特殊需要，只是信号处理程序中的一个简单的低级写循环。严格来说，我的程序的行为会有所不同，但对于最终用户来说，结果看起来非常相似。（除了可以将输出重定向到不同的终端窗口，并并排查看它们；或将它们重定向到辅助脚本/程序，这些脚本/程序将纳秒挂钟时间戳添加到每个输入行；以及在调查时有用的其他类似技巧事物。）

就个人而言，我发现了从原始问题到“正确解决方案”的跳跃——如果我所描述的确实是正确的解决方案；我确实认为这有点牵强。当 Saf 提到正确的解决方案应该使用 pthreads 时，我才意识到这种方法。

我希望您能从中找到信息，但不要剧透。

* * *

2013-03-13 编辑：

这是`writefd()`我用来安全地将数据从信号处理程序写入描述符的函数。我还包括了包装函数`wrout()`，`wrerr()`您可以使用它们分别将字符串写入标准输出或标准错误。

```
#include <unistd.h>
#include <string.h>
#include <errno.h>

/**
 * writefd() - A variant of write(2)
 *
 * This function returns 0 if the write was successful, and the nonzero
 * errno code otherwise, with errno itself kept unchanged.
 * This function is safe to use in a signal handler;
 * it is async-signal-safe, and keeps errno unchanged.
 *
 * Interrupts due to signal delivery are ignored.
 * This function does work with non-blocking sockets,
 * but it does a very inefficient busy-wait loop to do so.
*/
int writefd(const int descriptor, const void *const data, const size_t size)
{
    const char       *head = (const char *)data;
    const char *const tail = (const char *)data + size;
    ssize_t           bytes;
    int               saved_errno, retval;

    /* File descriptor -1 is always invalid. */
    if (descriptor == -1)
        return EINVAL;

    /* If there is nothing to write, return immediately. */
    if (size == 0)
        return 0;

    /* Save errno, so that it can be restored later on.
     * errno is a thread-local variable, meaning its value is
     * local to each thread, and is accessible only from the same thread.
     * If this function is called in an interrupt handler, this stores
     * the value of errno for the thread that was interrupted by the
     * signal delivery. If we restore the value before returning from
     * this function, all changes this function may do to errno
     * will be undetectable outside this function, due to thread-locality.
    */
    saved_errno = errno;

    while (head < tail) {

        bytes = write(descriptor, head, (size_t)(tail - head));

        if (bytes > (ssize_t)0) {
            head += bytes;

        } else
        if (bytes != (ssize_t)-1) {
            errno = saved_errno;
            return EIO;

        } else
        if (errno != EINTR && errno != EAGAIN && errno != EWOULDBLOCK) {
            /* EINTR, EAGAIN and EWOULDBLOCK cause the write to be
             * immediately retried. Everything else is an error. */
            retval = errno;
            errno = saved_errno;
            return retval;
        }
    }

    errno = saved_errno;
    return 0;
}

/**
 * wrout() - An async-signal-safe alternative to fputs(string, stdout)
 *
 * This function will write the specified string to standard output,
 * and return 0 if successful, or a nonzero errno error code otherwise.
 * errno itself is kept unchanged.
 *
 * You should not mix output to stdout and this function,
 * unless stdout is set to unbuffered.
 *
 * Unless standard output is a pipe and the string is at most PIPE_BUF
 * bytes long (PIPE_BUF >= 512), the write is not atomic.
 * This means that if you use this function in a signal handler,
 * or in multiple threads, the writes may be interspersed with each other.
*/
int wrout(const char *const string)
{
    if (string)
        return writefd(STDOUT_FILENO, string, strlen(string));
    else
        return 0;
}

/**
 * wrerr() - An async-signal-safe alternative to fputs(string, stderr)
 *
 * This function will write the specified string to standard error,
 * and return 0 if successful, or a nonzero errno error code otherwise.
 * errno itself is kept unchanged.
 *
 * You should not mix output to stderr and this function,
 * unless stderr is set to unbuffered.
 *
 * Unless standard error is a pipe and the string is at most PIPE_BUF
 * bytes long (PIPE_BUF >= 512), the write is not atomic.
 * This means that if you use this function in a signal handler,
 * or in multiple threads, the writes may be interspersed with each other.
*/
int wrerr(const char *const string)
{
    if (string)
        return writefd(STDERR_FILENO, string, strlen(string));
    else
        return 0;
} 
```

如果文件描述符引用管道，`writefd()`则可用于以`PIPE_BUF`原子方式写入（至少 512）字节。 `writefd()`也可以在 I/O 密集型应用程序中用于将信号（如果使用`sigqueue()`、相关值、整数或指针引发）转换为套接字或管道输出（数据），从而更容易多路复用多个 I/O流和信号处理。变体（带有标记为 close-on-exec 的额外文件描述符）通常用于轻松检测子进程是执行了另一个进程还是失败了；否则很难检测到哪个进程——原始子进程或执行的进程——退出了。

在对这个答案的评论中，有一些讨论，以及修改`errno`的事实是否使其不适合信号处理程序。`write(2)``errno`

首先，POSIX.1-2008（及更早版本）将[异步信号安全](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_27)函数定义为可以从信号处理程序安全调用的函数。[2.4.3 信号动作](http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_03)一章包括此类功能的列表，包括`write()`. 请注意，它还明确指出*“获得 errno 值的操作和为 errno 分配值的操作应是异步信号安全的。”*

这意味着 POSIX.1 打算`write()`在信号处理程序中安全使用，并且`errno`也可以对其进行操作以避免被中断的线程在`errno`.

因为`errno`是线程局部变量，所以每个线程都有自己的`errno`. 传递信号时，它总是会中断进程中现有的线程之一。信号可以定向到特定线程，但通常内核决定哪个线程获得进程范围的信号；它因系统而异。如果只有一个线程，即初始线程或主线程，那么显然是被中断的线程。所有这一切意味着，如果信号处理程序保存`errno`它最初看到的值，并在它返回之前将其恢复，则更改`errno`在信号处理程序之外是不可见的。

不过，有一种方法可以*检测到*它，在 POSIX.1-2008 中也通过谨慎的措辞暗示了这一点：

从技术上讲，`&errno`它几乎总是有效的（取决于应用的系统、编译器和标准），并产生`int`保存当前线程错误代码的变量的地址。因此，另一个线程可以监视另一个线程的错误代码，是的，这个线程会在信号处理程序中看到对它的更改。但是，不能保证其他线程能够原子地访问错误代码（尽管它在许多架构上是原子的）：这种“监视”无论如何都只会提供信息。

遗憾的是，几乎所有 C 中的信号处理程序示例都使用 stdio.h`printf()`等。不仅在很多层面上都是错误的——从非异步安全到缓存问题，可能是对`FILE`字段的非原子访问，如果被中断的代码同时也在执行 I/O——而且是*正确*的解决方案在此编辑中使用`unistd.h`与我的示例类似的方法同样简单。在信号处理程序中使用 stdio.h I/O 的基本原理似乎是“它通常有效”。我个人讨厌这一点，因为例如暴力也“通常有效”。我认为它愚蠢和/或懒惰。

我希望你发现这个信息。

# wpf - 如何从其单元格模板绑定到 gridviewcolumn 上的属性

> ID：11816074
> 
> 赞同：1
> 
> 时间：2012-08-05T11:38:08.797
> 
> 标签：wpf, templates, binding, gridviewcolumn

我要解决的一般问题是只有一个数据模板用于复选框，然后我可以将其用于列表视图中的许多不同列（使用网格视图）。在所有示例中，我都看到为每个绑定创建了一个单独的模板，这对我来说似乎有点矫枉过正。

我一直在尝试通过创建 gridviewcolumn 将设置的附加属性来做到这一点。然后我可以简单地为绑定到该附加属性的复选框提供一个数据模板。

我遇到的问题实际上是将复选框源设置为gridviewcolumn。

这是xaml：

```
<DataTemplate x:Key="CheckBoxTemplate">
    <CheckBox IsChecked="{Binding Path=(ap:AttachedProperties.IsChecked),
        RelativeSource={RelativeSource AncestorType={x:Type GridViewColumn}}}" />
</DataTemplate>

<GridView x:Key="MyGridView">
    <GridViewColumn Header="CheckBox" CellTemplate="{StaticResource CheckBoxTemplate}" ap:AttachedProperties.IsChecked="{Binding Path=SomeValue}" />
</GridView> 
```

*PS Attached 属性工作正常，我已将其直接附加到复选框并使用相对源自绑定并获得了通过的值，但是当我尝试将其绑定到 GridViewColumn 时，我没有得到任何快乐，事实上我没有也无法绑定到 GridViewColumn 上的标题...*

*PPS 我也尝试过其他绑定源表达式（只是看起来不正确）...*

编辑：发布此消息后，我立即意识到 GridViewColumn 存在于所有行中，所以这可能就是为什么这不起作用？！

我现在睡在上面，并意识到以这种方式做事是行不通的（因为 GridViewColumn 只能保存第一行的值，而不是我需要的每一行的值） - 但是我仍然认为有可能绑定到 GridViewColumn？

这是一个仅用于显示行为的 xaml 示例：

```
<Window x:Class="WpfApplication3.MainWindow"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       Title="MainWindow"
       Width="525"
       Height="350">
   <Grid>
       <ListView Name="listView1"
                 Width="479"
                 Height="287"
                 Margin="12,12,0,0"
                 HorizontalAlignment="Left"
                 VerticalAlignment="Top">
           <ListView.View>
               <GridView>
                   <GridViewColumn Header="A Header">
                       <GridViewColumn.CellTemplate>
                           <DataTemplate>
                               <StackPanel>
                                   <TextBlock Text="{Binding Path=Header, RelativeSource={RelativeSource AncestorType={x:Type GridViewColumn}}}" />
                                   <TextBlock Text="Visible row" />
                               </StackPanel>
                           </DataTemplate>
                       </GridViewColumn.CellTemplate>
                   </GridViewColumn>
               </GridView>
           </ListView.View>
           <ListViewItem />
           <ListViewItem />
       </ListView>
   </Grid>
</Window> 
```

在这样的场景下，我希望在每个“可见行”文本上方看到“标题”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T21:57:14.793

我检查了 snoop，原因是它不起作用，因为 GridColumnHeader 不在 GridRows 所在的 VisualTree 中。我的解决方案是使用 ElementName 并将其绑定到 Header 属性。相当简单，更清洁和可读。

```
 <ListView Name="listView1"
             Width="479"
             Height="287"
             Margin="12,12,0,0"
             HorizontalAlignment="Left"
             VerticalAlignment="Top">
        <ListView.View>
            <GridView>
                <GridViewColumn Header="A Header" x:Name="HeaderOne">
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding ElementName=HeaderOne,Path=Header}" />
                                <TextBlock Text="Visible row" />
                            </StackPanel>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
            </GridView>
        </ListView.View>
        <ListViewItem />
        <ListViewItem />
    </ListView> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T21:50:47.870

我尝试绑定到 GridViewColumn 的问题似乎有两个方面：

*   首先，GridViewColumn 只能提供一个结果值（可能是 itemssource 中的第一项），而不是每行的值。

*   其次， GridViewColumn 似乎不存在于可视化树中，因此不可用于绑定。

进一步的研究表明，要绑定到 GridViewColumn 的属性，可以使用以下语法：

```
<TextBlock Text="{Binding Path=View.Columns[0].Header, RelativeSource={RelativeSource AncestorType={x:Type ListView}}}" /> 
```

从[MSDN 获得：将参数传递到 GridViewColumn 中指定的 CellTemplate](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/9ea2853c-dd21-49d8-95e8-a145d706a7f8/)

# java - 如果没有更多异常，我如何停止获取输入？

> ID：11816075
> 
> 赞同：0
> 
> 时间：2012-08-05T11:38:11.313
> 
> 标签：java, exception, exception-handling, try-catch

再会。如果出现错误，我下面的程序应该给用户另一个机会继续，如果没有更多错误，即输入有效，则停止进程。

```
import java.util.*;
import javax.swing.*;

public class Format{

    public static boolean formatter(String phoneNumber){
        boolean thereIsAnError = true;
        try {
        String telephone = "";

        if (phoneNumber.length() != 10)
            throw new InputMismatchException();
        long number = Long.parseLong(phoneNumber);
        if (number < 0)
            throw new InputMismatchException();

        while (number > 0) {
            telephone = telephone + " " + number%10;
            number = number/10;
        }

        StringTokenizer numTokenizer = null;
        numTokenizer = new StringTokenizer(telephone);
        int numOfTokens = numTokenizer.countTokens();
        StringBuilder formatted = new StringBuilder();
        String[] numberArray = new String[10];

        for (int i=0; i<numOfTokens; i++) {
            numberArray[i] = numTokenizer.nextToken();
        }

        formatted.append("(");
        if (numberArray[9] == null)
            numberArray[9] = "0";
        formatted.append(numberArray[9]);
        if (numberArray[8] == null)
            numberArray[8] = "0";
        formatted.append(numberArray[8]);
        if (numberArray[7] == null)
            numberArray[7] = "0";
        formatted.append(numberArray[7]);
        if (numberArray[6] == null)
            numberArray[6] = "0";
        formatted.append(")");
        formatted.append(" ");
        formatted.append(numberArray[6]);
        if (numberArray[5] == null)
            numberArray[5] = "0";
        formatted.append(numberArray[5]);
        if (numberArray[4] == null)
            numberArray[4] = "0";
        formatted.append(numberArray[4]);
        if (numberArray[3] == null)
            numberArray[3] = "0";
        formatted.append("-");
        formatted.append(numberArray[3]);
        if (numberArray[2] == null)
            numberArray[2] = "0";
        formatted.append(numberArray[2]);
        if (numberArray[1] == null)
            numberArray[1] = "0";
        formatted.append(numberArray[1]);
        if (numberArray[0] == null)
            numberArray[0] = "0";
        formatted.append(numberArray[0]);

        formatted.toString();
        JOptionPane.showMessageDialog(null, formatted);
        }
        catch (IllegalArgumentException e) {
            JOptionPane.showMessageDialog(null, "Please enter only digits. No other characters.", "This is fun." , JOptionPane.ERROR_MESSAGE);
        }
        catch (InputMismatchException e) {
            JOptionPane.showMessageDialog(null, "Please enter 10 positive digits.", "This is fun." , JOptionPane.ERROR_MESSAGE);
        }
        return thereIsAnError;
    }

    public static void main(String[] args) {

        String inputNumber = "This program receives a 10-digit phone number as input\nand produces a phone number formatted as (xxx) xxx-xxxx.\n\nInput a 10-digit phone number (just numbers, nothing else):";
        boolean thereIsAnError = true;

        while (thereIsAnError) {
        try {
            String phoneNumber = JOptionPane.showInputDialog(inputNumber);
            phoneNumber = phoneNumber.trim();
            thereIsAnError = formatter(phoneNumber);

        }

        catch (NullPointerException e){
            JOptionPane.showMessageDialog(null, "Thank you. Goodbye.");
            System.exit(0);
        }

        catch (Exception e) { 
            JOptionPane.showMessageDialog(null, "There is something wrong. Shutting down.");
        }
        finally {
            JOptionPane.showMessageDialog(null, "All exceptions avoided or handled!");
        }
        }

    }

} 
```

我想我没有放置正确的 catch 块。请帮我找出问题所在。我是 Java 新手，我还在学习。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T11:43:34.583

当提供正确的输入时，您需要设置`thereIsAnError`为 false 以便循环停止。

大概之后...

```
 formatted.toString();
 JOptionPane.showMessageDialog(null, formatted);
 thereIsAnError = false;  // <--- No error should be reflected and returned.
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T11:46:38.190

`thereIsAnError`永远不会分配给不匹配的场景。另外，我建议您看看使用[正则表达式](http://www.regular-expressions.info/java.html)进行此类工作。

# ruby-on-rails - 默认情况下是否可以从我的 Rails 应用程序中删除 public/index.html ？

> ID：11816077
> 
> 赞同：1
> 
> 时间：2012-08-05T11:38:34.507
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我在主目录中创建了一个 .railsrc 文件，该文件当前使用 Postgres 作为默认创建新的 Rails 应用程序，并且在启动时不捆绑。该文件包含以下内容：

```
-d postgresql
--skip-bundle 
```

有什么方法可以向这个文件添加一个选项，以阻止 rails 在我创建的每个新 Rails 应用程序中添加默认的 html 页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T11:53:06.977

您可以使用应用程序模板，在您的 .railsrc 中添加与此类似的内容

```
--template ~/rails-template.rb 
```

在您的模板中，

```
run "rm public/index.html" 
```

[这](http://edgeguides.rubyonrails.org/rails_application_templates.html)是 Rails 应用程序模板指南。

您可以使用模板做更多事情。这里有更多的[例子](https://github.com/RailsApps/rails3-application-templates)。

我希望它有所帮助。

# asp.net-mvc - MVC 站点架构

> ID：11816083
> 
> 赞同：0
> 
> 时间：2012-08-05T11:39:32.183
> 
> 标签：asp.net-mvc, asp.net-mvc-4, architecture

我正在使用 MVC4 构建在线产品。

目前，我将项目结构化为明显的 xx.Web、xx.Data、xx.Services

以下是我想征求您意见的一组问题：

1- 对于数据层，我将使用存储库模式。我创建了一个 .dbml 来托管我的数据库表。我应该为每个表创建一个类还是应该使用 .dbml 生成的类？2- 对于存储库接口，我应该将它们放在哪里？在不同的项目 xx.Data.Common 中还是在 xx.Data 中的文件夹中？

3-错误记录和安全代码在哪里？我为此创建了一个 xx.Web.Common 项目？

MVC 应用程序的通用架构是否有任何指导方针？我的意思是我做了一些研究，但你被 Ninject 等扩展的音调淹没了......

我只想实施最佳实践。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T11:56:34.870

[http://sharparchitecture.net/](http://sharparchitecture.net/)是 开箱即用的最佳实践起始模板。但是，我认为我在网上看到的大多数解决方案都是过度设计的，并且针对的是企业级站点。

如果您只是制作 **在线产品**，那么一个简单的 2-3 层解决方案就足够了。从最简单的解决方案开始。当/如果需要时，您可以随时添加或创建新图层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T11:57:39.577

> 1- 对于数据层，我将使用存储库模式。我创建了一个 .dbml 来托管我的数据库表。我应该为每个表创建一个类还是应该使用 .dbml 生成的类？

如果您从头开始构建您的网站，我建议您将[Code First 与 Entity Framework 一起](http://weblogs.asp.net/scottgu/archive/2010/07/16/code-first-development-with-entity-framework-4.aspx)使用，因为 Linq2Sql 已经不再发展了。

您不需要将模型与数据库表进行 1 : 1 映射，专注于设计领域模型，数据库将自动生成。此外，无需从存储库与表映射 1 : 1。您需要了解具有聚合和聚合根的存储库模式

> 2- 对于存储库接口，我应该将它们放在哪里？在不同的项目 xx.Data.Common 中还是在 xx.Data 中的文件夹中？

应该有一个名为：xx.Domain 的 dll 来放置您的域模型和存储库接口。通过这种方式，xx.Domain 是不依赖于任何其他程序集的核心程序集。

> 3-错误记录和安全代码在哪里？我为此创建了一个 xx.Web.Common 项目？

应该有更多的 dll 调用：xxx.CrossCuttings 用于日志记录和安全性。

使用 IoC 容器在层和可测试性之间建立松散耦合。

不是 MVC 架构的通用指南，但尽量保持代码简单、可维护和灵活是关键。

# java - Maven jaxb 生成插件以从多个目录读取 xsd 文件

> ID：11816085
> 
> 赞同：4
> 
> 时间：2012-08-05T11:39:39.467
> 
> 标签：java, maven, xsd, jaxb

如果我在以下目录中有 xsd 文件

```
src/main/resources/xsd
src/main/resources/schema/common
src/main/resources/schema/soap 
```

我如何指示 maven jaxb 插件使用上述目录中的所有模式文件生成 jaxb 类？如果我指定其中一个文件夹，我可以让它生成类文件，但我不知道如何包含所有三个文件夹。

这是我为一个文件夹生成文件的方式：

```
<plugin>
            <groupId>org.jvnet.jaxb2.maven2</groupId>
            <artifactId>maven-jaxb2-plugin</artifactId>
            <executions>
                <execution>
                    <goals>
                        <goal>generate</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <schemaDirectory>src/main/resources/xsd</schemaDirectory>
            </configuration>
        </plugin> 
```

我尝试在元素中添加多个条目，但如果我这样做，它只会忽略所有条目。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T11:59:54.977

你可以试试这个配置：

```
<configuration>
        <schemaDirectory>src/main/resources</schemaDirectory>
    <schemaIncludes>
        <include>xsd/*.xsd</include>
            <include>schema/*/*.xsd</include>
    </schemaIncludes>
</configuration> 
```

来源：[http ://confluence.highsource.org/display/MJIIP/User+Guide](http://confluence.highsource.org/display/MJIIP/User+Guide)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T11:57:37.097

该插件描述将模式文件放入[src/main/resources](http://static.highsource.org/mjiip/maven-jaxb2-plugin/generate-mojo.html)而不是放入子文件夹。我建议在约定优于配置的意义上使用插件的默认值。此外，重要的是让架构包含正确的文件，包括正确的文件夹。

在这种情况下最好的办法是有一个单独的模块，它只包含模式和一些支持类。

# python - Python多线程 - 主线程块socket.connect

> ID：11816089
> 
> 赞同：3
> 
> 时间：2012-08-05T11:40:25.687
> 
> 标签：python, multithreading, sockets

我有以下问题。我的线程很少。有只等待终止调用的主线程和上传文件的线程子线程。不幸的是，子线程在想要与特定服务器连接时被阻止。我在 Linux 上使用 python2.7。

主线程包含以下代码：

```
 for i in xrange(n):
        upl = UploaderThread(self.user, self.password)
        upl.start()
    while threading.active_count() > 1:
        time.sleep(1000.) 
```

这是子线程挂起的片段

```
 sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.settimeout(glob_timeout)
    #this fragment of code is accessed
    sock.connect( ("95.211.193.147", 8084 ) ) <- here the child-thread is blocked
    #this fragment of code is not accessed anymore
    sock.send(header) 
```

我做错了什么？

* * *

当我运行同一程序的几个副本时（每个副本都是一个上传线程），一切都很好。这意味着服务器允许来自一个客户端的多个连接。

当没有主线程时一切正常，即当我以这种方式更改主线程时（删除等待循环）：

```
 for i in xrange(n):
        upl = UploaderThread(self.user, self.password)
        upl.start() 
```

然后在主线程死亡后，每个子线程都可以工作（不再被阻塞）。

当我尝试与其他服务器（不是 "95.211.193.147", 8084 ）连接时，子线程不会被主线程阻塞。

我真的不明白发生了什么。

* * *

UploaderThread的定义

```
class UploaderThread(threading.Thread):
    def __init__(self, user, password):
        threading.Thread.__init__(self)
        self.uploader   = Uploader(user, password)
        self.daemon     = False

    def run(self):
        self.uploader.upload_dir() 
```

self.uploader.upload_dir() 包含与服务器连接的代码片段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T02:11:23.230

您可能需要考虑使用多处理库而不是线程。它有一些限制，但它回避了 GIL 问题。

# if-statement - 如何使内部if语句转到外部if语句的`else`？

> ID：11816090
> 
> 赞同：0
> 
> 时间：2012-08-05T11:40:44.523
> 
> 标签：if-statement

我在这件作品上遇到了麻烦：

```
if (a)
{
    if (b)    // when this check fails, I need to go v
        doSomething(); //                            v
}                      //                            v
else                   //                           < here
    doSomethingElse(); 
```

我怎么做？

**UPD：** if 语句是嵌套的，因为`a`检查对象是否不为空，防止立即检查空对象的参数引起的异常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T11:42:47.200

唯一能做到这一点的方法是`goto`在可用的情况下使用单独的条件来保护`else`外部`if`语句的分支，而不是使其成为一个`else`分支。

假设在嵌套之前有计算`if`阻止您同时执行这两项检查，您可以这样做：

```
bool done = false;
if (a) {
    ...
    if (b) {
        doSomething();
        done = true;
    }
}
if (!a && !done) {
    doSomethingElse();
} 
```

但是，如果您的条件中的代码实际上由调用函数`doSomething`和组成，那么在嵌套分支`doSomethingElse`中复制函数的调用并没有什么坏处。`doSomethingElse``else`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T11:43:27.907

改为：

```
if (a)
{
    if (b) {  
        doSomething();                            
    }
    else{
       doSomethingElse();
    }
}                      
else                  
    doSomethingElse(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T11:42:43.020

```
if(a && b)
  doSomething();
else
  doSomethingElse(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T11:43:44.273

```
if (a)
{
    if (b)    
        doSomething();                       
    else
        doeSomethingElse();
}                                             
else                                  
    doSomethingElse(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T11:43:42.870

你不能这样做吗？

```
if (a && b) {
    doSomething();
}
else {
    doSomethingElse();
} 
```

# php - preg_replace 重复模式

> ID：11816093
> 
> 赞同：1
> 
> 时间：2012-08-05T11:41:14.120
> 
> 标签：php, regex, preg-replace

当使用带有重复模式的 preg_replace 时，引用只返回最后一个。有什么方法可以全部获取吗？

例如：

```
 $str = "hello, world, hello1, world1"
 echo(preg_replace('/([^,]*,?)+/', '$1', $str)); 
```

会返回**world1**，但是有没有办法访问其他匹配的部分？

这只是一个例子，我只想知道是否有任何方法可以访问参考中的所有匹配部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T04:02:47.407

顺便说一句，我去测试了我的示例，发现您的示例实际上并不起作用。它必须`[^,]+`不是`[^,]*`，否则它会吃掉输入：

```
$str = "hello, world, hello1, world1"
echo preg_replace('/([^,]*,?)+/', '$1', $str);
# -> ""
echo preg_replace('/([^,]+,?)+/', '$1', $str);
# -> " world1" 
```

您可以通过添加另一组括号来捕获**所有**事件：

```
$str = "hello, world, hello1, world1"
echo preg_replace('/(([^,]+,?)+)/', '$1', $str);
# -> "hello, world, hello1, world1" 
```

或者您可以替换每个单独的事件，而不是整个重复模式：

```
$str = "hello, world, hello1, world1"
echo preg_replace('/([^,]+,?)/', '$1 AND', $str);
# -> "hello, AND world, AND hello1, AND world1 AND" 
```

如果这些都不是您想要的，那么我怀疑`preg_replace`不是您想要的，并且`preg_match_all`可能更合适。

# iphone - TTTAttributedLabel：\r\n 行尾的文本呈现错误

> ID：11816094
> 
> 赞同：0
> 
> 时间：2012-08-05T11:41:25.983
> 
> 标签：iphone, objective-c, ios, core-text

在`TTTAttributedLabel`,`\r\n`中被算作 2 个行尾，而它应该只有一个。UILabel 正确处理这种情况。

示例：这是字符串`@"Line 1\r\nLine 2"`。上一个是`TTTAttributedLabel`，下一个是`UILabel`

![TTTAttributedLabel 与 UILabel](../Images/02236e1dd01199c35a969653568ba574.png)

Xcode 项目文件：[http ://tinywhale.net/TestProject.zip](http://tinywhale.net/TestProject.zip)

知道如何让 TTTAttributedLabel 在这种情况下表现得像 UILabel 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T14:09:12.090

我相信你确切地知道问题出在哪里。我也和你在一起，我遭受了同样的原因。将近两个星期，我试图解决这个问题。谷歌搜索并查看 Apple 的文档并查看 stackoverflow，我到处查看，无法得到明确的答案。在 UILabel 属性中 "text(NSString)" 是 \r\n 并且想出两个连续的 \n 才适用。但是CustomLabel属性“attributedText(NSAttributedString)”是\r\n的时候两个都相继应用。所以我的解决方案\r\n和出现的两个连续的\r已经被替换为空字符串。

```
NSString *string = [myString stringByReplacingOccurrencesOfString:@"\r" withString:@""];
NSAttributedString *attributedString = [NSAttributedString attributedStringWithString:string]; 
```

其实@"Line 1\r\n Line 2" 如果查看NSLog 就有有趣的事实。

```
NSLog(@"Line 1\r\nLine 2"); 
```

**在模拟器中**

```
2012-08-05 23:18:59.170 SimpleTest[30721:707] Line 1
Line 2 
```

**在设备中**

```
2012-08-05 23:18:59.170 SimpleTest[30721:707] Line 1

Line 2 
```

上面可以看到，模拟器和设备\r的处理是不同的。为此，我做了很多努力。我不知道具体是什么，armv7和i386处理的区别。但我认为如果一个错误或一种 NSString 和 NSAttributedString 也认为这些关系。

我的回答是为了解决您的问题，我真的希望它对您有所帮助。

# jquery - 滚动到下一个可见元素

> ID：11816095
> 
> 赞同：1
> 
> 时间：2012-08-05T11:41:41.903
> 
> 标签：jquery, scroll

我有一个带有滚动和外部潜水和内部潜水的主 div。我想当我单击一个按钮时，主 div 滚动到下一个内部 div 的开头，这种情况在这个 jsfidlle 中得到了更好的解释

[http://jsfiddle.net/alamin84/63FY7/2/](http://jsfiddle.net/alamin84/63FY7/2/)

第一次单击滚动到 div 11 然后 12 然后 13 然后到 21 这是在下一个子 div 等等

我试图利用这个问题的第二条评论

[通过 Rob W获取可滚动 div 中的第一个和最后一个可见元素，](https://stackoverflow.com/questions/8376230/get-the-first-and-last-visible-element-in-a-scrollable-div) 但是当 console.logged 时，应该保存对第一个可见元素的引用的变量 $first 给了我未定义。问题是它做错了什么？如何正确地做到这一点？

提前致谢

****编辑****

应用 devundef 的建议后，我仍然无法获得正确的滚动顺序

现在是 12 -22 -32

应该是 11 - 12 -13 -21-22…等

换句话说，如何获取第一个可见的内部 div (class="sub2")，然后我可以使用它来获取/滚动到下一个可见的内部 div

新的小提琴

[http://jsfiddle.net/alamin84/63FY7/15/](http://jsfiddle.net/alamin84/63FY7/15/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:05:36.963

此行永远不会计算为`true`：

```
if ($first && position.top >= positions.top) ... 
```

因为此时 $first 为空。你必须要求`!$first`

```
if (!$first && position.top >= positions.top) ... 
```

小提琴：http: [//jsfiddle.net/63FY7/3/](http://jsfiddle.net/63FY7/3/)

顺便说一句，我建议使用 jquery.scrollTo 插件，它工作得很好：

演示：[http ://demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/)

片段：http: [//jsfiddle.net/wuN65/1/](http://jsfiddle.net/wuN65/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T00:29:32.107

如何获得第一个可见的内部 div (class="sub2")？
我不需要外部 div 的外部选择器和内部 div 的内部选择器 只有一个内部 div 的选择器可以

代码：

```
 $("#btnScroll").click(function (event) {

                     var $firstinner, $lastinner, $containerinner = $("#dvmn"),
                         positions = $containerinner.offset(),
                         positionsinner = $containerinner.offset();

                     $('.sub2').each(function (i, obj) {
                         var $thisinner = $(this),
                             positioninner = $thisinner.offset();

                         if (!$firstinner && positioninner.top >= positions.top) {

                             $firstinner = $thisinner.next();
                             if ($firstinner.length == 0) {
                //When last inner div get to next outer div
                                 $firstinner = $thisinner.parent().next();

                             }

                             console.log($firstinner);
                         }

                     });

                     $containerinner.scrollTo($($firstinner), {
                         duration: 500
                     });

                 }); 
```

小提琴：http: [//jsfiddle.net/alamin84/63FY7/24/](http://jsfiddle.net/alamin84/63FY7/24/)

当然，感谢 devundef 使用 jquery.scrollTo 插件

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-05T20:12:08.753

一个非常粗糙和老派的方法是使用该`scrollIntoView()`方法。

所以如果你知道下一步`element`是什么，你可以做..

```
element.scrollIntoView() 
```

[在这里](https://developer.mozilla.org/en-US/docs/DOM/element.scrollIntoView)阅读更多。

# iphone - 当应用程序在Iphone的后台时如何在通知栏中收听通知

> ID：11816097
> 
> 赞同：0
> 
> 时间：2012-08-05T11:41:52.060
> 
> 标签：iphone, ios, push-notification

在我的应用程序中，我想在我的应用程序在后台运行时收听通知栏。当我收到该通知时，我想执行一些操作。谁能告诉我如何收听通知栏的变化。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T11:47:44.000

你不能。

阅读并[消化文档](http://developer.apple.com/library/ios/#DOCUMENTATION/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html)和注释；

> iOS 注意：在 iOS 中，您可以通过检查应用程序状态来确定应用程序是否由于用户点击操作按钮而启动，或者通知是否已发送到已运行的应用程序。在委托的 application:didReceiveRemoteNotification: 或 application:didReceiveLocalNotification: 方法的实现中，获取 applicationState 属性的值并对其进行评估。如果值为 UIApplicationStateInactive，则用户点击了操作按钮；如果值为 UIApplicationStateActive，则应用程序在收到通知时位于最前面。

或者换一种说法，如果您的应用程序在后台，您只有在用户点击操作按钮时才会发现通知。这是设计使然。

# python - 通过dict调用函数时不传递任何参数

> ID：11816099
> 
> 赞同：15
> 
> 时间：2012-08-05T11:42:00.170
> 
> 标签：python

我制作了一个 Python 脚本，它根据用户的输入调用函数。到目前为止，我只是通过 dict 调用无参数函数

```
options = { 0 : func0,
            1 : func1,
            2 : func2,
           }
options[choice]() 
```

现在我处于需要调用一些带参数的函数的情况。我是 Python 新手，我尝试过这样的事情

```
options = { 0 : (func0,None),
            1 : (func1,None),
            2 : (func2,foo1),
            3 : (func3,foo2),
          }
options[choice][0](options[choice][1]) 
```

我知道为什么`None`在这里不起作用，并且编写它只是为了象征该函数不接受任何参数。我应该对代码进行哪些更改以使其适用于各种功能？

我试过拆包`empty dict`，但它也不起作用。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-05T11:46:06.393

`None`仍然是一个值，并且将其传递给不期望参数的函数将不起作用。而是考虑[`partial`](http://docs.python.org/library/functools.html#functools.partial)在这里使用

```
from functools import partial

options = { 0: func0,
            1: func1,
            2: partial(func2, foo1),
            3: partial(func3, foo2),
          }

options[choice]() 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-05T11:45:08.290

使用参数列表：

```
options = { 0 : (func0, []),
            1 : (func1, []),
            2 : (func2, [foo1]),
            3 : (func3, [foo2]),
          }
options[choice][0](*options[choice][1])
# or
func, args = options[choice]
func(*args) 
```

如果您还希望能够指定命名参数，则可以像这样扩展它：

```
options = { 0 : (func0, [], {}),
            1 : (func1, [], {param_name: value}),
            2 : (print_name, [], {name: "nims"}),
            3 : (func3, [foo2], {}),
          }
func, args, kwargs = options[choice]
func(*args, **kwargs) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-05T11:49:04.170

您可以对带有参数的函数使用 lambda 表达式（并保留那些没有参数的函数）：

```
options = { 0 : func0,
            1 : func1,
            2 : lambda: func2(foo1),
            3 : lambda: func3(foo2),
          } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T11:51:15.853

尝试这样的事情：

在函数头中使用`*`，它将收集元组中的所有参数。

```
def func0(*a):
    print list(a)
def func1(*a):
    print list(a)
def func2(*a):
    print list(a)
def func3(*a):
    print list(a)
foo1=1
foo2=2
options = { 0 : (func0,None),
            1 : (func1,None),
            2 : (func2,foo1),
            3 : (func3,foo2),
          }
choice=2
options[choice][0](options[choice][1:])  #prints [(1,)]

choice=1
options[choice][0](options[choice][1:])  #prints [(None,)] 
```

# email - 使用 php mailer 发送带有附件的电子邮件

> ID：11816101
> 
> 赞同：3
> 
> 时间：2012-08-05T11:42:17.417
> 
> 标签：email, attachment, phpmailer

谁能告诉我使用 phpMailer 发送带有附件的电子邮件的步骤。我已经准备好所有代码来发送电子邮件本身，它工作正常，但我不明白如何发送附件。我有表单，如果我从 POST 上的文件输入中获取值，它只会给我文件名而不是完整路径。我认为为了添加附件，我需要获取文件的完整路径，对吗？我不必将文件存储在服务器上，只需要通过电子邮件发送即可。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:45:57.980

我找到了解决方案：首先，在我的表单中，我必须包含 enctype="multipart/form-data" 来发送文件，所以它必须是这样的：

```
<form method="POST"  action="send.php" enctype="multipart/form-data">
          inputs...
</form> 
```

之后我以这种方式获取文件：

```
if(is_uploaded_file($_FILES['myfile']['tmp_name'])) {
            $file = $_FILES['myfile'];
            } 
```

然后我准备该文件的路径，该文件现在位于临时目录中并识别新文件名：

```
$attachment_path = $this->file['tmp_name'];

 //If need to give new name for the file:
  //$newfilename = pathinfo(basename($this->file['name']));
  //$attachment_name = "attachment_new_name.".$newfilename['extension'];

$attachment_name = basename($this->file['name']);

$mail->AddAttachment($attachment_path, $attachment_name); 
```

完毕！现在附上文件。

# c# - 我该如何处理这个 windows phone webclient 异步问题？

> ID：11816102
> 
> 赞同：1
> 
> 时间：2012-08-05T11:42:24.317
> 
> 标签：c#, .net, windows-phone-7, asynchronous, webclient

我有一个方法如下：

```
 public decimal GetExchangeRate(string fromCurrency, string toCurrency)
      {
            GoogleCurrencyService googleCurrencyService = new GoogleCurrencyService();
            return googleCurrencyService.GetRateForCurrency(fromCurrency, toCurrency);

      } 
```

和另一个类如下

```
public class GoogleCurrencyService
{
    public decimal GetRateForCurrency(string fromCurrency, string toCurrency)
    {

        try
        {
            WebClient client = new WebClient();
            client.DownloadStringCompleted += new DownloadStringCompletedEventHandler(StringDownloadCompleted);
            client.DownloadStringAsync(new Uri(_requestUri + fromCurrency + "=?" + toCurrency));

        }
        catch (Exception)
        {
            ExchangeRate = 0;
        }

        return ExchangeRate;
    }

    private void StringDownloadCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        _response = e.Result;
        ExchangeRate = ParseResponseAndGetExchangeRate();
    }

}//class GoogleCurrencyService 
```

变量 ExchangeRate 总是为零，所以我相信函数调用“GetRateForCurrency”在异步回调被调用之前返回。我如何确保不会发生这种情况，因为我需要在返回之前设置变量 ExchangeRate。谢谢。另外，我注意到回调永远不会被调用，因为我在其中有一个断点，并且异常也没有被调用。所以我不知道问题出在哪里。感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T11:57:42.983

您可以使用事件等待句柄来阻塞当前线程并等待异步调用...

```
public class GoogleCurrencyService
{
    private const string RequestUri = "http://www.google.com/ig/calculator?hl=en&q=1{0}%3D%3F{1}";

    public decimal ExchangeRate { get; private set; }

    public decimal GetRateForCurrency(string fromCurrency, string toCurrency)
    {
        ExchangeRate = 0;
        // use a signaler to block this thread and wait for the async call.
        var signaler = new ManualResetEvent(false);
        try
        {
            var client = new WebClient();
            client.DownloadStringCompleted += StringDownloadCompleted;
            // pass the signaler as user token
            client.DownloadStringAsync(new Uri(String.Format(RequestUri, fromCurrency, toCurrency)), signaler);

            // wait for signal, it will be set by StringDownloadCompleted
            signaler.WaitOne();
        }
        finally
        {
            signaler.Dispose();
        }

        return ExchangeRate;
    }

    private void StringDownloadCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        try
        {
            ExchangeRate = ParseResponseAndGetExchangeRate(e.Result);
        }
        finally
        {
            // set signal
            ((ManualResetEvent)e.UserState).Set();
        }
    }

    private decimal ParseResponseAndGetExchangeRate(string result)
    {
        return 123;
    }
} 
```

**编辑：使用异步模式的同一类**

```
public class GoogleCurrencyService
{
    private const string RequestUri = "http://www.google.com/ig/calculator?hl=en&q=1{0}%3D%3F{1}";

    public void GetRateForCurrency(string fromCurrency, string toCurrency, Action<decimal> callback)
    {
        var client = new WebClient();
        client.DownloadStringCompleted += StringDownloadCompleted;
        // pass the callback as user token
        client.DownloadStringAsync(new Uri(String.Format(RequestUri, fromCurrency, toCurrency)), callback);
    }

    private void StringDownloadCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        // parse response to get the rate value
        var rate = ParseResponseAndGetExchangeRate(e.Result);

        // if a callback was specified, call it passing the rate.
        var callback = (Action<decimal>)e.UserState;
        if (callback != null)
            callback(rate);
    }

    private decimal ParseResponseAndGetExchangeRate(string result)
    {
        return 123;
    }
} 
```

**使用异步类：**

```
// this is your UI form/control/whatever
public class MyUI
{
    public void OnButtonToGetRateClick()
    {
        var from = "USD"; // or read from textbox...
        var to = "EUR";

        // call the rate service
        var service = new GoogleCurrencyService();
        service.GetRateForCurrency(from, to, (rate) =>
            {
                // do stuff here to update UI.
                // like update ui.
            });
    }
} 
```

也许您必须将 UI 更改分派到 ui 线程。我这里没有 WP 框架来确认是这种情况，但我认为是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T11:57:33.447

当您运行异步方法时，您将获得完成方法的结果，即

字符串下载完成

因此，在您的代码中，您调用异步方法并立即返回 ExchangeRate，它始终为 0。

您必须在完成的方法 StringDownloadCompleted 中获取 ExchangeRate

如果您想在 GetRateForCurrency 中获取 ExchangeRate，请进行同步调用

```
client.DownloadString(new Uri(_requestUri + fromCurrency + "=?" + toCurrency)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T12:14:38.167

这是你需要做的。

你在课堂上创建一个事件。在您的代码中，您触发异步 Web 客户端调用。调用完成后，您将包装数据并设置事件。我倾向于定义可以保存数据的事件参数。

设置事件后，调用者将收到通知。

如果您想要一个示例，请查看我的帖子中的源代码 [http://invokeit.wordpress.com/2012/06/30/bing-mapcontrol-offline-tiles-solution-wpdev-wp7dev/](http://invokeit.wordpress.com/2012/06/30/bing-mapcontrol-offline-tiles-solution-wpdev-wp7dev/)

它是 bing 地图示例的扩展，它包含地址查找器类。看看它是如何被解雇的以及如何通知客户的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T12:29:00.190

好的，在呼叫 uri 后等待

公共十进制 GetRateForCurrency（字符串 fromCurrency，字符串 toCurrency）{

```
 try
    {
        WebClient client = new WebClient();
        client.DownloadStringCompleted += new DownloadStringCompletedEventHandler(StringDownloadCompleted);
        client.DownloadStringAsync(new Uri(_requestUri + fromCurrency + "=?" + toCurrency));
        Thread.sleep(500000); //waiting
    }
    catch (Exception)
    {
        ExchangeRate = 0;
    }

    return ExchangeRate;
} 
```

所以设置一个类似标签的webcontrol并执行此操作

```
 private void StringDownloadCompleted(object sender, DownloadStringCompletedEventArgs e)
{
    _response = e.Result;
    yourlabel.Text = _response ;
    ExchangeRate = ParseResponseAndGetExchangeRate();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T12:32:29.883

您在这里唯一的选择`GetRateForCurrency`也是异步（这意味着引发自己的`Completed`事件）。

是否支持 TPL，您可以`Task<T>`用作将异步包装到链中的好方法，但不幸的是 WP7 不支持它。

作为一种替代方法，我所做的是使用响应式`Microsoft.Phone.Reactive`扩展`IObservable`（

# c - 指针分配与元素或结构分配有什么区别？

> ID：11816103
> 
> 赞同：0
> 
> 时间：2012-08-05T11:42:40.047
> 
> 标签：c, pointers, struct, copy, duplicates

我很难理解这两者之间的区别：

```
typedef struct someStruct{
   int x;
   char *name;
   struct someStruct *next
}TEST1,*pTEST1;

void *copyElement(void* s){
   pTEST1 cop = (pTEST1)calloc(1,sizeof(TEST1));
   cop = (pTEST1)s;
} 
```

如果我没记错的话，这个是指向同一个元素，所以如果我改变一个，所有指向的元素都会改变

我想在内存中的新“位置”中创建元素的新副本并指向它。

很想得到解释。

我不明白的另一件事是指针分配空间和对象本身之间的区别。

例如，如果我使用我的功能并这样做：

```
void *copyElement(void* s){
    pTEST1 cop = (pTEST1)calloc(1,sizeof(TEST1));
    cop = (pTEST1)s;
    /*or */
    TEST1 a;
    pTEST1 b;
    a.x  =(pTEST1)s->x;
    a.name = (pTEST1)s->name;
    a->next = (pTEST1)s->next;

    b= &a ;
    // it means the when the function ends,
    // I loose the pointer ? because I didn't
    // allocate space for it?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:20:17.087

pTEST1 标识符只是一个类型名称别名，它的意思是“指向 TEST1 结构的指针”。一些 C 程序员对它发誓，一些人认为它是邪恶的，因为它隐藏了指针，并且当你需要取消引用它们时并不清楚。这正是您的代码出了什么问题，您实际上并没有复制结构，您只是复制了指针。正确的版本应该类似于：

```
void *copyElement(void *s){
   // Copies element pointed-to by "s".  NOTE: free() required on the returned pointer
   TEST1 *copy = malloc(sizeof(TEST1));
   *copy = *(TEST1*)s;
   return copy;
} 
```

如果您真的想使用 pTEST1，那么只需将上述代码段中的 TEST1* 替换为它即可。请注意，当您无论如何要覆盖分配的内存时，使用 calloc() 是没有意义的。

# mysql - 在 MySQL 中，我可以编写一个查询来查找给定月份是否有两个日期之间的任何日期？

> ID：11816108
> 
> 赞同：0
> 
> 时间：2012-08-05T11:42:58.527
> 
> 标签：mysql

对问题标题道歉我很难表达这一点。通过示例更容易：

我有一个包含两个日期字段的表格；开始日期和结束日期。虚拟数据：

```
+----+------------+------------+
| id | start_date | end_date   |
+----+------------+------------+
| 1  | 2012-01-10 | 2012-04-13 |
| 2  | 2012-02-09 | 2012-05-12 |
| 3  | 2012-03-08 | 2012-06-11 |
| 4  | 2012-04-07 | 2012-07-10 |
| 5  | 2012-05-06 | 2012-08-09 |
+----+------------+------------+ 
```

所以现在我有一个给定的月份，比如说 2012 年 3 月。有没有办法查看 2012 年 3 月是否在 id 2 的 start_date 和 end_date 之内？3 怎么样（3 有点不同，因为 2012 年 3 月的部分时间介于 start_date 和 end_date 之间，这很好，我们不需要整个月，部分很好）？

我一直坐在这里试图思考如何编写查询并且完全被难住了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T11:49:09.180

据我了解您的问题，您想检查每个日期范围是否与 2012 年 3 月有一些重叠。

让

*   `A`是和的最大值`<beginning of march>`并且`start_date`让

*   `B`是和的`<end of march>`最小值`end_date`

现在检查是否`A`< `B`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T11:50:25.543

如果您可以使用确切的月份范围（即给出开始结束日的确切日期），那么这样的查询应该可以正常工作：

```
SELECT id FROM MyTable 
WHERE start_date <= '2012-03-31' 
AND end_date >= '2012-03-01' 
```

# ruby-on-rails - 类“ActionView::Base”的未定义方法“render”

> ID：11816118
> 
> 赞同：4
> 
> 时间：2012-08-05T11:44:49.150
> 
> 标签：ruby-on-rails, haml, render, actionview, alias-method

当我启动应用程序崩溃以下错误

```
/home/stereodenis/.rvm/gems/ruby-1.9.3-p194@nyanya/gems/haml-3.1.6/lib/haml/helpers/action_view_mods.rb:15:in `alias_method': undefined method `render' for class `ActionView::Base' (NameError) 
```

可能有什么问题？

完整跟踪[https://gist.github.com/5e3244d488068c9d0ba7](https://gist.github.com/5e3244d488068c9d0ba7)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T13:16:42.973

如果您在助手中使用渲染，则必须包含该功能！

```
include AbstractController::Rendering 
```

希望能帮助到你

# c - L 值所需误差

> ID：11816121
> 
> 赞同：-1
> 
> 时间：2012-08-05T11:45:25.970
> 
> 标签：c

以下是c中的代码行。

```
 i++=i++; 
```

输出：需要错误左值。
那么这个错误说明了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T11:48:41.970

的结果`i++`不是左值，标准要求赋值运算符的左操作数是左值。

即使允许，当您尝试在两个序列点之间修改同一个对象两次时，您的程序也会调用未定义的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T11:49:56.237

它表示`i++`不可分配。这就像尝试分配给`1`（在存储值`i++`时会产生）。`i``1`

当然，这没有任何意义。您可以将其与尝试更改颜色“红色”进行比较，当您实际上想先将纸张涂成红色然后涂成蓝色时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T11:53:03.510

这就是说需要左值。你正在做一个左=右的作业。i++ 不能是左，因为它是右。去掉简洁，你的代码行就变成了

i + 1 = i + 1，这是一个方程而不是一个赋值。

最重要的是，您实际上想做什么？

# bash - 回声“#！” 失败——“未找到事件”

> ID：11816122
> 
> 赞同：18
> 
> 时间：2012-08-05T11:45:44.610
> 
> 标签：bash, echo

以下失败，我不明白为什么：

```
$ echo "#!" 
```

以下也失败并显示相同的错误消息：

```
$ echo "\#!" 
```

错误信息：

```
-bash: !": event not found 
```

为什么会失败？应该怎么`echo`做呢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-05T11:48:23.040

该`!`字符用于`csh`-式历史扩展。

如果您不使用此功能，`set +o histexpand`（aka `set +H`）会关闭此行为。它对脚本关闭，但通常启用以进行交互使用。`set +o histexpand`在这种情况下，我个人的建议是通过添加到您的`.bash_profile`（或者`.bashrc`如果您没有`.bash_profile`; 这比我想尝试放入括号更复杂）来永久关闭它。

作为一种解决方法，如果由于某种原因您不能或不想关闭并忘记此遗留`csh`功能，您可以使用单引号而不是双引号 - 当然，请记住它们的不同语义。例如，如果您需要将引用与变量插值结合起来，您可以更改

```
echo "#!$SHELL"  # oops, history expansion breaks this 
```

进入

```
 echo '#!'"$SHELL" 
```

（注意相邻的单引号和双引号字符串；在 shell 完成此操作后，引号将被删除，字符串`#!`将在变量值旁边输出`SHELL`，它们之间没有空格）或其他一些常见的解决方法，例如

```
 printf '#!%s\n' "$SHELL" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-05T12:06:21.003

默认情况下，bash 支持`csh`兼容的历史扩展。

在 bash

```
echo #! 
```

只会打印一个换行符，作为`#`开始评论。

在

```
echo "#!" 
```

这`#`是以 开头的字符串的一部分`"`。bash 仍会检查此类字符串是否有特殊字符。 `!`是一个特殊字符，当且仅当它后跟任何其他文本。

```
-bash: !": event not found 
```

在这种情况下，bash 期望`!"`令牌引用 shell 历史中以 开头的上一个命令`"`，但找不到。本身`!`不会触发此行为：

```
$ echo \# !
# !

$ echo fee ! fie
fee ! fie 
```

最后，

```
$ echo !echo 
```

产生两行，第一行由 shell 打印以显示上面的模式如何扩展为：

```
echo echo '# !' 
```

而第二行只是执行扩展命令的结果： echo # !

* * *

另请参阅：[历史扩展的](http://www.gnu.org/software/bash/manual/bashref.html#History-Interaction)[Bash 手册](http://www.gnu.org/software/bash/manual/bashref.html)页

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-05T11:50:08.957

```
echo '#!' 
```

基本上，使用双引号 ( `"`) 又名“弱引用”，Bash 对字符串做了一些古怪的事情，比如变量替换。使用单 ( `'`) 又名“强引用”，字符串按字面意思表示。

有关引用的更深入解释，请参见[此处。](http://wiki.bash-hackers.org/syntax/quoting)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-06-10T06:27:08.443

另一种解决方法可能是在“！”之后放置一个额外的空格。：

```
# echo "#! "
#! 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-05T11:50:19.740

在我的情况下，所有命令都在工作。也许你可以指定你的环境。

```
$ echo "\#\!"
\#\!
$ echo "#!"
echo "#"
#
$ echo "#!"
echo "#"
#
$ echo $BASH_VERSION
3.2.48(1)-release 
```

# html - IE/Internet Explorer 中未显示下拉菜单（Z 索引堆叠问题？）

> ID：11816128
> 
> 赞同：1
> 
> 时间：2012-08-05T11:46:36.863
> 
> 标签：html, css, internet-explorer

我想我在 ie 中遇到了 z-index 堆叠问题。下拉菜单显示在 Firefox 中，但不显示在任何版本的 ie 中（请参阅以下 js fiddle [http://jsfiddle.net/MdUKd/15/](http://jsfiddle.net/MdUKd/15/)）。我试图通过向每个具有相对位置的父元素添加更高的 z-index 来解决这个问题，但它仍然无法正常工作。

任何帮助将非常感激。

编辑：为了清楚起见，此处包含的代码和从 js fiddle 中删除的 javascript（下拉菜单在没有 js 的情况下仍然可以工作）。

HTML：

```
<div id="nav" style="z-index: 5">
<div id="nav-inner">
    <ul class="main-menu dropdown" style="z-index: 4">
        <li class="menuItem2 parent" style="z-index: 3">
            <a href="#">VISIT</a>
            <ul class="nccUlMenuSub1" style="z-index: 2">
                <li class="menuItem1 first"><a href="#">Tours</a></li>
                <li class="menuItem2"><a href="#">Directions</a></li>         
            </ul>
        </li>
    </ul>
</div>
</div> 
```

CSS：

```
#nav
{
    background: #911201;
    background: linear-gradient(top,#911201 0,#780202 100%);
    background: -moz-linear-gradient(top,#911201 0,#780202 100%);
    background: -ms-linear-gradient(top,#911201 0,#780202 100%);
    background: -o-linear-gradient(top,#911201 0,#780202 100%);
    background: -webkit-gradient(linear,left top,left bottom,color-stop(0%,#911201),color-stop(100%,#780202));
    background: -webkit-linear-gradient(top,#911201 0,#780202 100%);
    filter:     progid:DXImageTransform.Microsoft.gradient(startColorstr='#911201',endColorstr='#780202',GradientType=0);
    height: 40px;
    position: relative;
    z-index: 4;
}
#nav ul
{
    list-style: none;
    list-style-image: none;
    list-style-type: none;
    margin: 0;
    padding: 0;
    position: relative;
}
#nav ul li
{
    border: 1px solid #17203D;
    border-right: 0;
    float: left;
    height: 38px;
    margin: 0;
    padding: 0;
    position: relative;
    width: 126px;
    zoom: 1;
}
#nav ul li.hover,#nav ul li:hover
{
    position: relative;
}
#nav ul a
{
    color: #FFF;
    display: block;
    font-size: 16px;
    line-height: 38px;
    text-align: center;
    text-decoration: none;
}
#nav ul li.last
{
    border-right: 1px solid #17203D;
    width: 129px;
}
#nav ul a:hover,#nav ul a.selected
{
    background: #17203D;
    color: #E3E1D5;
}
#nav ul ul
{
    left: -1px;
    position: absolute;
    top: 38px;
    visibility: hidden;
}
#nav ul .last.parent ul
{
    left: auto;
    right: -1px!important;
}
#nav ul ul li,#nav ul ul li.last
{
    border: 0;
    display: inline;
    float: none;
    font-weight: normal;
    width: 175px;
}
#nav ul ul li a
{
    background: #17203D;
    color: #FFF;
    display: block;
}
#nav ul ul li a:hover,#nav ul ul li a.selected
{
    background: #780202;
    color: #FFF;
}
#nav ul ul li a
{
    border-right: none;
    display: inline-block;
    width: 100%;
}
#nav ul ul ul
{
    left: 100%;
    top: 0;
}
#nav ul li:hover>ul
{
    visibility: visible;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:31:49.797

您仍然在问题中发布了很多代码。如果您在这种情况下开始剥离看似不相关的 CSS 规则以使问题尽可能“纯粹”，这会有所帮助。从边框颜色、-1px 的边距等开始，然后按照自己的方式制定更相关的规则。

当我对发布的代码执行此操作时，我几乎直接发现了问题：

```
filter:     progid:DXImageTransform.Microsoft.gradient(startColorstr='#911201',endColorstr='#780202',GradientType=0); 
```

**删除那行**，事情开始在 IE 中工作。

起初这让我有点惊讶，但它是有道理的：渐变是那里最“特定于 IE”的东西，解释了为什么只有 IE 有这个问题。

显然梯度过滤器在 z-index 上的表现不是很好，关于这个主题可能有很多单独的 SO 问题。

# asp.net - umbraco razor 宏在 html 输出中添加额外的返回

> ID：11816129
> 
> 赞同：0
> 
> 时间：2012-08-05T11:46:37.323
> 
> 标签：asp.net, razor, umbraco

我的母版页中有一个宏调用，它根据许多因素（深度、URL 路径等）设置正文类但是，我已经对其进行了精简以找出宏在最终 html 中添加额外空间的原因.

母版页宏行：

```
 <body class="<umbraco:Macro Alias="Bodyclass" runat="server"></umbraco:Macro>"> 
```

简化宏：

```
@{
  var bodyClass = "";
  if ((Model.NodeTypeAlias == "WLHomePage" ) ||
     (Model.NodeTypeAlias == "WLHomeSubPage" ))
  { bodyClass = "front"; } else {
     bodyClass = "not-front";  }
    @bodyClass;
} 
```

回报：

```
 <body class="
front"> 
```

注意 class=" 的第一个双引号和实际的类字符串之间的额外空格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T11:30:37.117

```
@{
    if (Model.NodeTypeAlias == "WLHomePage" || Model.NodeTypeAlias == "WLHomeSubPage")
    { 
        return "front";
    }
    else 
    {
        return "not-front";
    }
} 
```

在它只返回一个值的地方尝试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:40:50.530

我的 .NET 开发伙伴破解了这个：它是第一行中的空白。向上移动 var，如下所示：

```
 @{ var bodyClass = ""; 
```

和 >poof< 空白消失了。

那么这是一个umbraco错误吗？

谢谢大家！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:43:02.353

**删除额外的换行符**

确保在宏代码之前或之后没有额外的新行。您可能需要在文本编辑器中打开 cshtml 文件以进行检查。在对我进行了一些测试之后（使用 v4.8），这是我能找到的添加额外换行符的唯一条件。在代码前使用 razor comments ( `@* ... *@`) 也会添加换行符。

* * *

**选择**

将类添加到标签的另一种方法是用剃刀写出标签，如下所示：

```
<umbraco:Macro language="cshtml" runat="server">
@{
    string bodyClass = "not-front";

    if ((Model.NodeTypeAlias == "WLHomePage" ) ||
        (Model.NodeTypeAlias == "WLHomeSubPage" ))
    {
        bodyClass = "front";
    }

    @:<body class="@bodyClass">
}
</umbraco:Macro>

    ...

</body> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T15:23:00.573

尝试使用 Html.Raw 输出 html。所以像：

```
@{
  var bodyClass = "";
  if(...)
  { 
    bodyClass = "front"; 
  } 
  else 
  {
    bodyClass = "not-front";  
  }

  @(Html.Raw(@bodyClass));

} 
```

# objective-c - 如何加密或混淆 NSURL 中的字符串？

> ID：11816132
> 
> 赞同：0
> 
> 时间：2012-08-05T11:47:39.380
> 
> 标签：objective-c

我有一个 URL 的路径，在目标 C 代码中

我想混淆或加密这个值，这样用户就不会看到这个代码

他们正在将我的整个代码集成到他们的应用程序中，但我不希望他们看到网址。

我有什么方法可以混淆网址？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:08:15.577

假设您可以控制 Web 服务器，那么您的 URL 可以随心所欲地变得毫无意义或有意义。它们可以是任何东西，您可以随意映射它们。芒格位。使用加密。无论你想要什么。

要问的第一个问题是您要实现什么目标？防止随意黑客攻击或完全安全？

希望是前者。如果是后者，那么您需要聘请安全专家。

如果是前者，那么：

• 使用 https 并验证服务器证书 • 使用公钥加密并让您的应用获取公钥，然后加密 URL 内容 • 混淆您的参数和值等...

... ETC ...

以上的一些组合将使您远离不经意间窥探您的 URL 空间的眼睛。如果您的目标是让人们远离您的服务器，请考虑使用时间有限的 UUID 或标记到会话的东西，由服务器生成并且不能在客户端生成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T11:53:58.457

没有办法做到这一点，因为您需要由名称服务器将纯 url 转换为 ip 地址，不仅如此，一旦您对 url 进行了混淆，您将不会有任何可以被所有服务器翻译的内容。

混淆 url 中数据的最佳方法是仅混淆参数值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T11:54:16.047

我假设您需要 URL 才能将 HTTP 请求发送到服务器。因此，每个拥有 WLAN 且防火墙能够记录所有请求的用户都将能够记录并查看您的 URL。

无论您使用何种加密或混淆方法，都不会产生预期的效果。即使 URL 根本没有被混淆，登录防火墙可能比反汇编应用程序更容易。

# c++ - 在 avr g++ 中禁用函数声明错误

> ID：11816133
> 
> 赞同：2
> 
> 时间：2012-08-05T11:47:40.623
> 
> 标签：c++, makefile, compiler-errors, arduino, avr-gcc

我正在使用这个[Makefile](https://github.com/sudar/Arduino-Makefile/blob/master/arduino-mk/Arduino.mk)来编译我的 Arduino 草图，它具有以下 CPP 和 C 标志

```
CPPFLAGS      += -mmcu=$(MCU) -DF_CPU=$(F_CPU) -DARDUINO=$(ARDUINO_VERSION) \
            -I. -I$(ARDUINO_CORE_PATH) -I$(ARDUINO_VAR_PATH)/$(VARIANT) \
            $(SYS_INCLUDES) $(USER_INCLUDES) -g -Os -w -Wall \
            -ffunction-sections -fdata-sections
CFLAGS        = -std=gnu99
CXXFLAGS      = -fno-exceptions 
```

当我编译一个 cpp 文件时，如果在声明函数之前使用了这些函数，我会收到一个致命错误。我浏览了[avr g++ 选项](http://linux.die.net/man/1/avr-g++)，发现选项 -Wimplicit-function-declaration 启用了它。它也由 make 文件中使用的 -Wall 选项启用。

我想启用 -Wall 选项（因为它启用了许多其他警告）但仅禁用 -Wimplicit-function-declaration 选项。

我检查了文档，但无法弄清楚如何做到这一点。有人可以告诉我该怎么做吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T12:07:00.807

编译 C++ 代码时不能禁用该错误 - 这是一个致命错误，而不是警告。

对于 C 代码（使用 ），您可以（但不应该）摆脱它`-Wno-implicit-function-declaration`，但这不适用于 C++。

```
cc1plus: warning: command line option "-Wno-implicit-function-declaration" 
                  is valid for C/ObjC but not for C++ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-16T03:45:57.603

参考； [http://arduino.cc/en/Main/FAQ#.UyUa8vmSz99](http://arduino.cc/en/Main/FAQ#.UyUa8vmSz99)

引用

> 事实上，你已经是；Arduino 语言只是一组可以从您的代码中调用的 C/C++ 函数。**您的草图进行了微小的更改（例如自动生成函数原型）**，然后直接传递给 C/C++ 编译器 (avr-g++)

更多信息; [http://arduino.cc/en/Hacking/BuildProcess#.UyUa6vmSz98](http://arduino.cc/en/Hacking/BuildProcess#.UyUa6vmSz98)

windows arduino IDE将在将函数声明原型传递给编译器之前对其进行预处理。

如果您想复制 arduino IDE，则需要将此预处理构建到您的 arduino makefile 项目中。

# naming-conventions - 是否有一个矩阵“嵌入”在另一个矩阵之间的乘积的名称并且它被转置

> ID：11816136
> 
> 赞同：0
> 
> 时间：2012-08-05T11:48:11.723
> 
> 标签：naming-conventions, matrix-multiplication, quaternions

我正在为以下经常出现的产品寻找一个名称。或者更好地说：好奇这样的名字是否存在。

“A乘B乘（A转置）”

其中 A 和 B 可以是矩阵，但它也具有与向量和四元数类似的形式：

“Q 乘以 V 乘（Q 共轭）”

因为很难找到你不知道如何调用的东西（除非谷歌有我还没有发现的数学符号搜索功能......）我希望分享你的知识。

请注意，我的兴趣更多是出于好奇而不是追求一个真理，因为我很清楚命名约定，因为符号约定可能因字段而异，甚至因人而异。

问候，

鲁克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T12:11:40.890

[此处](http://en.wikipedia.org/wiki/Matrix_congruence)`ABA^T`涵盖了该案例（即[“全等变换”](http://en.wikipedia.org/wiki/Congruent_transformation)）。对于正交矩阵/单位四元数（其中等于和等于）的变换，这也等同于，您可以在[此处](http://en.wikipedia.org/wiki/Similar_matrix)阅读。`A^T``A^{-1}``conj(Q)``Q^{-1}``ABA^{-1}`

# php - 获得文件扩展名的良好，可靠的功能

> ID：11816137
> 
> 赞同：0
> 
> 时间：2012-08-05T11:48:11.747
> 
> 标签：php, filenames

无论文件名多么奇怪，我已经制作了一个到目前为止似乎非常擅长获取文件扩展名的函数。我在网上遇到的每一种方法似乎都喜欢在 . 获取扩展名，但是如果文件名中有多个 .s 怎么办？

这是我的功能：

```
$fileName = 'my.reallyAwk-ward..file--name.JPEG' ;
echo getExtension($fileName) ;

function getExtension($fileName)
{
    $ext = explode('.', strrev($fileName), 2) ;
    $ext = strtolower(strrev($ext[0])) ;
    return $ext ;
} 
```

我是在重新发明轮子还是可以提高效率？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T11:50:03.477

```
<?php
$path_parts = pathinfo('/www/htdocs/inc/lib.inc.php');

echo $path_parts['dirname'], "\n";
echo $path_parts['basename'], "\n";
echo $path_parts['extension'], "\n";
echo $path_parts['filename'], "\n"; // since PHP 5.2.0
?> 
```

来自[http://php.net/manual/en/function.pathinfo.php](http://php.net/manual/en/function.pathinfo.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T11:52:48.930

我认为这稍微干净一些：

```
$filename = 'myfile.jpg';
$extension = substr($filename, strrpos($filename,'.') +1 ) 
```

爆炸创建一个新数组，一般来说还有更多的“工作”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-14T06:11:45.603

你也可以这样做。

```
echo substr(strrchr('file.txt','.'),1); 
```

# php - 从 Javascript 调用 PHP 脚本以将数据插入 mysql 数据库

> ID：11816145
> 
> 赞同：0
> 
> 时间：2012-08-05T11:49:13.080
> 
> 标签：php, javascript, mysql

单击后，我的 html 文件中有一个按钮，我需要做两件事。（将数据插入数据库并重新加载页面）所以我在 onclick 事件中调用了一个 javascript 函数。

这是javascript文件中的函数：

```
function grandFinale()
{
     if (window.XMLHttpRequest)
     {// code for IE7+, Firefox, Chrome, Opera, Safari
         xmlhttp=new XMLHttpRequest();
  }
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.onreadystatechange=function()
{
if (xmlhttp.readyState==4 && xmlhttp.status==200)
 {
  //document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
 }
}
xmlhttp.open("GET","insert.php?q=",true);
xmlhttp.send();
document.location.reload();

} 
```

这是上面提到的insert.php文件

```
<?php
    $con = mysql_connect("localhost","uname","password");
if (!$con)
  {
   die('Could not connect: ' . mysql_error());
  }

mysql_select_db("SnakeDB", $con);

$sql="INSERT INTO masterTable (Name, Score) VALUES ('$_GET[name]','$_POST[txtScore1]')";

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
echo "1 record added";

mysql_close($con);
?> 
```

这是 HTML 文件的一部分，其中包含我要更新到数据库的位置

```
<div class="modal-body">
 <p>You scored :: </p><p id="txtScore1"></p>
<input type="text" placeholder="Your Name" id="name"> </div> 
```

问题是数据库没有更新！！只有重新加载发生。请建议我一个解决方案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T11:54:13.107

据我所知，您没有将参数发送到脚本吗？！

将名称字段也附加到

```
xmlhttp.open("GET","insert.php?q=&name=" + encodeURIComponent(document.getElementById('name').value),true); 
```

给定的代码未经测试，但应该以这种方式工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T11:59:34.997

您的 javascript 中的错误是，您没有通过 ajax 向脚本发送任何值。

```
xmlhttp.open("GET","insert.php?q=",true); 
```

`q`ist 只是空的，`name`并且`txtScore1`没有设置。

另外，在您的 SQL 语句中，您正在混淆 GET 和 POST 值。

$sql="INSERT INTO masterTable (Name, Score) VALUES ('$_GET[name]','$_POST[txtScore1]')";

应该写成：

```
 $sql="INSERT INTO masterTable (Name, Score) VALUES ('{$_GET['name']}','{$_GET['txtScore1']}')"; 
```

警告，在将数据插入数据库之前，您应该始终检查 GET 或 POST 数据！

您用 jQuery 标记了您的问题，但您没有使用它。你应该。它会将您的 javascript 压缩到几行 + 不需要重新加载页面！

请参阅[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

# python - pycharm自动将制表符转换为空格

> ID：11816147
> 
> 赞同：129
> 
> 时间：2012-08-05T11:49:35.793
> 
> 标签：python, pycharm

我正在使用pycharm IDE进行python开发，它对django代码非常有效，因此怀疑将制表符转换为空格是默认行为，但是在python IDE中到处都是错误，因为它无法自动将制表符转换为空格有没有办法实现这。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2012-08-05T11:58:41.350

更改代码样式以使用空格而不是制表符：

![空间](../Images/b49fa1ce9809edbaa5811659314fe433.png)

然后在项目视图中选择要转换的文件夹并使用`Code`| **重新格式化代码**。

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2016-06-15T12:32:47.413

这只会转换选项卡而不更改任何其他内容：

```
Edit -> Convert Indents -> To Spaces 
```

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2013-12-10T10:24:46.070

对于选择，您还可以使用“到空格”功能转换选择。我通常只是通过 ctrl-shift-A 使用它，然后从那里找到“To Spaces”。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2019-04-06T01:49:16.207

# PyCharm 2019.1

## 如果要更改常规设置：

在 macOS 中打开首选项`⌘</kbd>`;` or in Windows/Linux `Ctrl` + `Alt` + `S`.`

进入 Editor -> Code Style -> Python，如果你想遵循 PEP-8，选择*Tab size: 4* , *Indent: 4* , 和*Continuation indent: 8*如下图：

[![在此处输入图像描述](../Images/81e2325cb4be2c67bf0e22b96b7915f1.png)](https://i.stack.imgur.com/aASNu.png)

应用更改，然后单击确定。

## 如果您只想将更改应用到当前文件

**选项 1：**您可以在导航栏中选择：编辑 -> 转换缩进 -> 到空格。（见下图）

[![在此处输入图像描述](../Images/3df74b46c8b13a3bed7a4c612adb77a9.png)](https://i.stack.imgur.com/628Fs.jpg)

**选项 2：**您可以通过运行*Find Action*快捷方式来执行“To Spaces”操作：`⌘</kbd>`⇧</kbd>`A` on macOS or `ctrl``⇧</kbd>`A` on Windows/Linux. Then type "To Spaces", and run the action as shown in the image below.```

[![在此处输入图像描述](../Images/e8c8b16341683b12a7647dc8ed1b0b5c.png)](https://i.stack.imgur.com/O1l6y.png)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-05-08T07:06:14.063

**ctrl + shift + A** => 打开弹出窗口选择选项，选择**to空格**将所有制表符转换为空格，或**选择制表符**将所有空格转换为制表符。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-01-17T11:03:15.760

ctr+alt+shift+L -> 重新格式化整个文件:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-02-05T15:33:08.097

请注意：Pycharm 的***to 空格***功能仅适用于行首的缩进制表符*，而不适用**于*一行文本中的间隙制表符。例如，当您尝试格式化等宽文本中的列时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-16T05:46:19.757

对我来说，它有一个名为 ~/.editorconfig 的文件覆盖了我的选项卡设置。我删除了它（肯定有一天会再次咬我）但它解决了我的 pycharm 问题

# iphone - Iphone TouchJson jsonData 到字典

> ID：11816149
> 
> 赞同：1
> 
> 时间：2012-08-05T11:49:59.880
> 
> 标签：iphone, objective-c, json, touchjson

嗨，我正在制作从网页获取 json 的应用程序，但它没有使用 touchJson（框架、库、类）将 jsonData 转换为 Dict

杰森

```
{SFP:[{"Group":"Oil"},{"Group":"Sugar"}]} 
```

编码

```
NSStringEncoding *Encoding;
NSError *Error;
    NSURL *PriceURL = [NSURL URLWithString:@"http://xxx.co/SFP/?Q=P1"];
    NSString *JsonString = [[NSString alloc] initWithContentsOfURL:PriceURL usedEncoding:Encoding error:&Error];
    NSData *JsonData = [JsonString dataUsingEncoding:NSUTF32BigEndianStringEncoding];
    NSDictionary *Dict = [[[CJSONDeserializer deserializer] deserializeAsDictionary:JsonData error:&Error] retain];
    NSArray *Rows = [Dict objectForKey:@"SFP"];
    NSLog(@"%@", JsonString);
    NSLog(@"%@", JsonData);
    NSLog(@"%@", Dict); 
```

康索尔

```
2012-08-05 14:49:02.794 SFP[23791:f803] {SFP:[{"Group":"Oil"},{"Group":"Sugar"}]}
2012-08-05 14:49:02.795 SFP[23791:f803] <0000007b 00000053 00000046 00000050 0000003a 0000005b 0000007b 00000022 00000047 00000072 0000006f 00000075 00000070 00000022 0000003a 00000022 0000004f 00000069 0000006c 00000022 0000007d 0000002c 0000007b 00000022 00000047 00000072 0000006f 00000075 00000070 00000022 0000003a 00000022 00000053 00000075 00000067 00000061 00000072 00000022 0000007d 0000005d 0000007d>
2012-08-05 14:49:02.795 SFP[23791:f803] (null) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T11:53:15.227

```
{SFP:[{"Group":"Oil"},{"Group":"Sugar"}]} 
```

不是有效的 JSON，所有键都应该被引用。正确的、可解析的 JSON 是

```
{"SFP":[{"Group":"Oil"},{"Group":"Sugar"}]} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T20:55:58.057

可以使用[JSONLint在线检查 JSON](http://jsonlint.com)

# iphone - 应用程序已运行时静音本地通知声音

> ID：11816150
> 
> 赞同：0
> 
> 时间：2012-08-05T11:50:01.027
> 
> 标签：iphone, objective-c, ios, xcode, cocoa

我正在开发一个警报应用程序。当应用程序在后台时，本地通知会通知用户警报正在响起并播放声音。但是当应用程序已经在前台时，我不希望播放通知声音，而是播放自定义声音。我找不到如何使通知声音静音，因此两种声音同时播放。有任何想法吗？

**更新**：我重新启动了我的设备，问题解决了。这可能是一个iOS错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:14:01.350

当您的应用程序打开并在前台运行时，默认行为是不播放声音并且用户不会收到来自操作系统的任何警报/横幅。您可以通过以下方法接收通知（在您的 AppDelegate 类中）：

```
- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification
{
    NSLog(@"Do something");
} 
```

从那里你可以触发任何其他方法。

从[UILocalNotification 的文档中](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Reference/UILocalNotification_Class/Reference/Reference.html)：

> 如果在系统传递通知时应用程序处于最前面且可见，则不会显示警报，不会标记图标，也不会播放声音。但是，如果应用程序委托实现了 application:didReceiveLocalNotification: ，则会调用它。UILocalNotification 实例被传递到此方法中，并且委托可以检查其属性或访问 userInfo 字典中的任何自定义数据。

# ruby-on-rails - named_scope 和方法有什么区别？

> ID：11816155
> 
> 赞同：0
> 
> 时间：2012-08-05T11:50:25.043
> 
> 标签：ruby-on-rails, ruby, named-scope, ruby-on-rails-2

named_scope 或 scope 与类方法有何区别。

```
named_scope :active, :conditions => {:status => 'Active'}

def self.active
  self.find(:all, :conditions => {:status => 'Active'}
end 
```

两者有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T12:28:33.590

最后，“范围”将在您的模型上定义一个可链接的类方法。这就是为什么每个返回“范围”（ActiveRecord::Relation 类的对象）的类方法都可以以与定义的范围/命名范围相同的方式使用。

如果您想了解有关范围的更多信息，我建议您使用 rails 控制台来玩一些输出，或者 - 也许作为开始 - 阅读 rails 指南 - 他们几乎解释了它：[http://guides.rubyonrails。 org/active_record_querying.html#scopes](http://guides.rubyonrails.org/active_record_querying.html#scopes)

编辑：

哦，当然，阅读 Rails 代码通常可以更快地解决问题，然后是任何人或其他任何事情。如果您在此处查看“范围”方法的定义：[https](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/scoping/named.rb#L159) ://github.com/rails/rails/blob/master/activerecord/lib/active_record/scoping/named.rb#L159您将看到它是如何定义的一个方法（在类级别） - 这与您自己定义方法非常相似，如您的示例中所示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T14:29:04.953

最大的区别是可链接性。假设您有另一个命名范围，流行：

```
named_scope :popular, :conditions => { :popular => true } 
```

假设您想获得受欢迎的活跃用户。所以你说`User.popular.active`

```
named_scope :active, :conditions => {:status => 'Active'} 
```

在这种情况下，然后`User.popular.active`工作。

另一方面，

```
def self.active
  self.find(:all, :conditions => {:status => 'Active'}
end 
```

可能允许您说`User.active.popular`（取决于您的 Rails 版本，IIRC），但绝对*不是* `User.popular.active`.

非正式地，该`scope`方法安排它定义的方法在对象的其他范围内可用。定义一个类方法没有。

# parallel-processing - 一个 CUDA 块的网格 Vs。一个 MPI 进程网格，每个进程有一个块

> ID：11816156
> 
> 赞同：0
> 
> 时间：2012-08-05T11:51:08.383
> 
> 标签：parallel-processing, cuda, mpi

假设块之间没有通信，当我从 CUDA 网格中的一个进程启动 N 个 CUDA 块时，以及当我启动 N 个 MPI 进程且每个进程有一个 CUDA 块时，效率是否存在差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:26:50.910

一如既往：这取决于。

如果您不使用具有设备`Hyper Q`功能的 CUDA5，则在一个进程中启动网格 CUDA 网格应该更有效。否则，我可能无法确定唯一的方法来确保它正在测试。

你 可以 看[这个 视频](http://www.youtube.com/watch?v=TxtZwW2Lf-w), 特别 是 Jen Hsun Huang 讲 的 部分`Hyper Q`

# c# - C# 中的 Java 泛型

> ID：11816157
> 
> 赞同：1
> 
> 时间：2012-08-05T11:51:08.997
> 
> 标签：c#, java, generics

嗨，我是 C# 泛型的新手，用 C# 重写以下代码的正确方法是什么？

```
public class A <T extends Base>{

    Map<Class<T>,Object> m = newHashMap();

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T11:53:33.813

最后，我想我正确地理解了你的意图。

```
public class A<T> where T : Base
{
    Dictionary<Type, T> m = new Dictionary<Type, T>();
} 
```

C# 中没有类型擦除，因此您将不得不更改一些代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:06:01.327

正如在其他帖子中已经说过的，C# 等价于`class A<T extends Base>`is `class A<T> where T : Base`。但与 不同`java.lang.Class`的是，C# 类`System.Type`不是泛型的，因此`Class<? extends Base>`C# 中的概念没有等价物。您的选择减少到：

```
public class A<T> where T : Base
{
    Dictionary<Type, object> m = new Dictionary<Type, object>();
} 
```

现在你可能有：

```
public class Sub1 : Base {}
public class Sub2 : Base {}

....

m.Add(typeof(Sub1), new object());
m.Add(typeof(Sub2), new object()); 
```

但不幸的是：

```
m.Add(typeof(string), new object()); 
```

你最好的选择是确保它`m`被适当地封装，这样就不会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T11:53:12.207

您可以使用约束来实现这一点，如下所述：http: [//msdn.microsoft.com/en-us/library/d5x73970](http://msdn.microsoft.com/en-us/library/d5x73970)

```
public class A<T>
  where T : Base
{
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T11:53:51.867

使用类型约束，如下所示：

```
public class A<T> where T : Base {

} 
```

# c++ - 有没有办法将升压信号直接连接到另一个信号？

> ID：11816161
> 
> 赞同：7
> 
> 时间：2012-08-05T11:51:46.163
> 
> 标签：c++, boost, boost-signals

我想知道是否有更好的方法将一个类的 Boost 信号直接连接到另一个类的信号？

例如，想象一个[外观类](https://stackoverflow.com/questions/249581/explain-facade-pattern-with-c-example)，其中包含一组提供自己的信号的成员。现在假设门面想要暴露这些信号。我通常最终编写样板方法，然后将其连接为信号处理程序。

```
using namespace boost::signal;

class A
{
public:
  A(){};
  virtual ~A(){};

  signal<void()> signalA;
};

class B
{
public:
  B(){};
  virtual ~B(){};

  signal<void()> signalB;
};

class Facade
{
private:
  A& a;
  B& b;

public:
  Facade(A& refA, B& refB) 
  : a(refA), b(refB) 
  {
    // connect A's signal to facadeSignalA
    a.signalA.connect(boost::bind(&Facade::forwardedSignalA, this));
    // connect B's signal to facadeSignalB
    b.signalB.connect(boost::bind(&Facade::forwardedSignalB, this));
  }
  virtual ~Facade() {};

  // user visible signals
  signal<void()> facadeSignalA;
  signal<void()> facadeSignalB;

private:
  // ugly boilerplate code used to forward signals
  void forwardedSignalA()
  {
    facadeSignalA();
  }
  void forwardedSignalB()
  {
    facadeSignalB();
  }
}; 
```

现在这不是很优雅，一段时间后变得很乏味。有没有办法做到这一点而不必编写这些转发方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-05T12:20:56.920

是的，事实证明您可以直接“链接”信号。请看[这个线程](https://groups.google.com/forum/#!topic/boost-list/So4i8JXneJ0)。它没有记录，但它似乎是一个非常有用的功能。

# qt - 在 Qt 中用图标编译程序后，任务栏上的图标看起来最糟糕

> ID：11816162
> 
> 赞同：0
> 
> 时间：2012-08-05T11:51:49.340
> 
> 标签：qt, qt4, qt4.8

我已经用图标制作了我的一个程序的 GUI 版本，我的问题是当我的程序启动时，任务栏中的图标看起来最差并且像素化，而如果我用代码块和相同的图标编译同一程序的非 GUI 版本然后图标显示完全清晰。如果是 Qt，可能会出现什么问题？我什至还尝试了一个 120x120 的大图标，但它仍然非常像素化并且没有任何改进。有什么建议么？

# iphone - 导航到第一页，如 iOS 中的后退按钮

> ID：11816164
> 
> 赞同：2
> 
> 时间：2012-08-05T11:52:02.523
> 
> 标签：iphone, objective-c, ios, xcode

我是 iOS 开发的新手。我有这个故事板：

![在此处输入图像描述](../Images/e4f78f78d32f4af48b325d2312dcd34b.png)

当我单击第 1 页栏按钮项目时-> 使用后退按钮转到第 2 页（使用 push segue）

基本上点击后退按钮 --> 回到第 1 页

如您所见，我在第 2 页中有一个保存栏按钮，我的问题是当我单击此按钮时，我想将数据保存在数据库中并返回到第 1 页。

你能帮我怎样才能回到第一页吗？

```
- (void)save:(id)sender 
{
    NSLog(@"Save");
    // SaveDataToDb
    if(Data successfully saved in database)
         //Go Back to Page 1 ???
    else
         // Proper error message
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-05T11:55:59.493

> [self.navigationController popViewControllerAnimated:YES]

# android - CSS 中类似 Android ICS 的输入字段

> ID：11816166
> 
> 赞同：13
> 
> 时间：2012-08-05T11:52:49.113
> 
> 标签：android, html, css

我想创建一个像 Android Ice Cream Sandwich 一样的输入字段，仅在 HTML/CSS 中，而不使用图像。
我坚持制作这些小边框（下图），如果有人可以提供帮助，那就太好了。

![Android输入字段](../Images/0fe3ae4b4f655734ae09b04cd1d59591.png)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-20T19:18:22.233

**编辑**

我想包括 owencm 对偶然发现这个问题的人的评论，因为我觉得它很优雅：

**CSS**

```
input.holo[type='text'] {
    /* You can set width to whatever you like */
    width: 200px;
    font-family: "Roboto", "Droid Sans", sans-serif;
    font-size: 16px;
    margin: 0;
    padding: 8px 8px 6px 8px;
    position: relative;
    display: block;
    outline: none;
    border: none;
    background: bottom left linear-gradient(#a9a9a9, #a9a9a9) no-repeat, bottom center linear-gradient(#a9a9a9, #a9a9a9) repeat-x, bottom right linear-gradient(#a9a9a9, #a9a9a9) no-repeat;
    background-size: 1px 6px, 1px 1px, 1px 6px;
}
input.holo[type='text']:hover, input.holo[type='text']:focus {
    background: bottom left linear-gradient(#0099cc, #0099cc) no-repeat, bottom center linear-gradient(#0099cc, #0099cc) repeat-x, bottom right linear-gradient(#0099cc, #0099cc) no-repeat;
    background-size: 1px 6px, 1px 1px, 1px 6px; 
} 
```

**HTML**

```
<input type='text' class='holo'/> 
```

**JSFiddle** [http://jsfiddle.net/QKm37/](http://jsfiddle.net/QKm37/)

**原始解决方案**

```
<span style="
  border-bottom: solid 1px cyan;
  border-left: solid 1px cyan;
  margin: 20px;
  border-right: solid 1px cyan;
  overflow: visible;
  max-height: 0.2em;
  display: inline-block;
  padding: 2px;
">
<input type="text" style="
  outline: none;
  border: none;
  background: transparent;
  display: inline-block;
  position: relative;
  bottom: 0.8em;
">
</span> 
```

# php - php表单上复选框的动态更新

> ID：11816172
> 
> 赞同：1
> 
> 时间：2012-08-05T11:53:10.300
> 
> 标签：php

这是我的项目，我必须选择该部分，然后根据该部分，如果它的“A”则显示 1 50 的复选框，如果它的“B”则从 51 到 100

这是我的主要代码：

```
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="jsDatePick_ltr.min.css" />
<script type="text/javascript" src="jsDatePick.min.1.3.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
window.onload = function(){
    new JsDatePick({
        useMode:2,
        target:"inputField",
        dateFormat:"%d-%M-%Y"
    });
};
</script>
</head>
<?php
$dept =$_COOKIE[dept];
include_once("../Include/connectdb.php");
include_once("../Include/data_menu.php");
include_once '../Include/pagemaker.php';

?>
<script type="text/javascript">
$(document).ready(function()
{
$(".batch").change(function()
{
var id=$(this).val();
var dataString = 'year_join='+ id;

$.ajax
({
type: "POST",
url: "ajax_subject.php",
data: dataString,
cache: false,
success: function(html)
{
$(".subject").html(html);
} 
});

});
});
</script>

<script type="text/javascript">
$(document).ready(function()
{
    $(".section").change(function()
    {
        alert('asdfa');
        var id=$(this).val();
        var dataString = 'section='+ id;

        $.ajax
        ({
                type: "POST",
                url: "ajax_absent.php",
                data: dataString,
                cache: false,
                success: function(html)
                {
                    $(".absent").html(html);
                } 
        });

    });
});
</script>
</head>

<body>
<fieldset class="cbox"><legend>New Attendence System</legend>
<form name="frm" action=<?php print "edit_attendencePHP_NEW.php"; ?> method="GET"    
id="content">
<br><br>

<div style="margin:80px">
<label>Batch :</label> <select name="batch" class="batch">
<option selected="selected">--Select Batch--</option>
<?php
    $result = mysql_query("select distinct year_joining from student_profile  
order by year_joining ")or die(mysql_error());

while($year = mysql_fetch_assoc($result)){
if($year[year_joining]!="" && $year[year_joining]>"2008"){

  print "<OPTION value='$year[year_joining]'>$dept $year[year_joining]</OPTION>";
}  }
 ?>
</select>

<label>Section :</label> 
<select name="section" class="section">
        <OPTION value='A'> A</OPTION>
        <OPTION value='B'> B</OPTION>
</select>

  Date :<input type="text" size="12" id="inputField" name="date"/>

  <label>Hours :</label> <select name="hour" >
        <OPTION value='1'> 1</OPTION>
        <OPTION value='1'> 2</OPTION>
        <OPTION value='1'> 3</OPTION>

</select>
</br></br>
<label>Subject :</label> <select name="subject" class="subject">
<option selected="selected">------------Choose Subject------------</option>

  </select>
 </br>
    <label>Mark the Absenties : </label> 
    <input type="checkbox" class="section">
  <br/></br>
  <div class="absent"></div>

            <input class="bluebutton" type="submit" value="Go">    
</form><br>

<label class="comment">select a batch frm the list and press "Go"</label>
</fieldset>

</body>
</html> 
```

这是我的 ajax_absent.php 单独工作正常..

```
<?php
include_once("../Include/connectdb.php");

if($_POST['section'])
{
$sec=$_POST['section'];
if($sec=="A")
    $j=1;
else if($sec=="B")
    $j=51;

    for($i=0;$i<=49;$i++)
        { $k=$j+$i;
        if($i%5==0)
        {   echo "</br>";       }   
            echo '<input type ="Checkbox" value="'.$i . '">'.$k .   
 '</option>';

        }

?> 
```

我在同一个文件中为下拉菜单实现了相同的动态概念，但复选框仅带有一个复选框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T11:55:39.160

我发现了一些错误：-

您在 jquery 中有以下代码的用户

```
$(".section").change(function() 
```

但节课在

```
<select name="section" > 
```

代替

```
<select name="section" class="section"> 
```

您的代码中的另一个错误

您想将输出存储在缺席类中，并且您已在 jquery 中使用此代码

```
$(".absent").html(html); 
```

但您的 html 代码中不存在缺席类，请在您的代码中添加

```
<span class="absent"></span> 
```

或者

```
<span class="absent"></span> 
```

尝试这个

这是修改html代码

```
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="jsDatePick_ltr.min.css" />
<script type="text/javascript" src="jsDatePick.min.1.3.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
window.onload = function(){
    new JsDatePick({
        useMode:2,
        target:"inputField",
        dateFormat:"%d-%M-%Y"
    });
};
</script>
</head>
<?php
$dept =$_COOKIE[dept];
include_once("../Include/connectdb.php");
include_once("../Include/data_menu.php");
include_once '../Include/pagemaker.php';

?>
<script type="text/javascript">
$(document).ready(function()
{
$(".batch").change(function()
{
var id=$(this).val();
var dataString = 'year_join='+ id;

$.ajax
({
type: "POST",
url: "ajax_subject.php",
data: dataString,
cache: false,
success: function(html)
{
$(".subject").html(html);
} 
});

});
});
</script>

<script type="text/javascript">
$(document).ready(function()
{
    $(".section").change(function()
    {
        alert('asdfa');
        var id=$(this).val();
        var dataString = 'section='+ id;

        $.ajax
        ({
                type: "POST",
                url: "ajax_absent.php",
                data: dataString,
                cache: false,
                success: function(html)
                {
                    $(".absent").html(html);
                } 
        });

    });
});
</script>
</head>

<body>
<fieldset class="cbox"><legend>New Attendence System</legend>
<form name="frm" action=<?php print "edit_attendencePHP_NEW.php"; ?> method="GET"    
id="content">
<br><br>

<div style="margin:80px">

<label>Section :</label> 
<select name="section" class="section">
        <OPTION value='A'> A</OPTION>
        <OPTION value='B'> B</OPTION>
</select>

  Date :<input type="text" size="12" id="inputField" name="date"/>

  <label>Hours :</label> <select name="hour" >
        <OPTION value='1'> 1</OPTION>
        <OPTION value='1'> 2</OPTION>
        <OPTION value='1'> 3</OPTION>

</select>
</br></br>
<label>Subject :</label> <select name="subject" class="subject">
<option selected="selected">------------Choose Subject------------</option>

  </select>
 </br>
    <label>Mark the Absenties : </label> 
    <input type="checkbox" class="section">
  <br/></br>
  <div class="absent"></div>

            <input class="bluebutton" type="submit" value="Go">    
</form><br>

<label class="comment">select a batch frm the list and press "Go"</label>
</fieldset> 
```

输出![在此处输入图像描述](../Images/b1d872018c6feb3d0bf5313e021afe5e.png)

```
if($_POST['section'])
{
$sec=$_POST['section'];
if($sec=="A")
    $j=1;
else if($sec=="B")
    $j=51;

    for($i=0;$i<=49;$i++)
        { $k=$j+$i;
        if($i%5==0)
        {   echo "</br>";       }   
            echo '<input type ="Checkbox" value="'.$i . '">';   

        } 
```

# android - Android：权限拒绝：需要 android.permission.INTERNET

> ID：11816175
> 
> 赞同：3
> 
> 时间：2012-08-05T11:53:30.797
> 
> 标签：android, android-permissions

我知道有很多关于这个问题的帖子，但我还不能解决它。

所以我所拥有的基本上是一个非常小的应用程序，只包含一个 VideoView 小部件。当部署到模拟器时，一切都很好。当我尝试在设备上进行测试时，我收到一个异常，基本上

```
 Permission Denial: starting Intent { act=android.intent.action.MAIN
 cat=[android.intent.category.LAUNCHER] flg=0x10000000
 cmp=jfl.projects.fk/.StartupActivity } from null (pid=3903, uid=2000) requires
 android.permission.INTERNET 
```

好吧，在阅读了该错误消息后，我尽可能多地在清单中填充了许可标签（嗯，一次一个，每次最后一个都没有解决任何问题），但是，是的，你猜怎么着。所以，这些是我添加的权限：

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

在清单标签内

```
android:permission="android.permission.INTERNET" 
```

作为应用程序和活动标签的限定符

清单基本上就是这样。该活动嵌套了一个意图过滤器标记，用于定义

```
<action android:name="android.intent.action.MAIN" />
<category android:name="android.intent.category.LAUNCHER" /> 
```

但就是这样。

任何想法谁在这里感到被忽视并拼命渴望互联网许可？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T11:56:53.153

摆脱`android:permission="android.permission.INTERNET"`. 这表明主屏幕或任何其他尝试启动您的活动的东西都需要该权限。

AndroidManifest.xml 文件元素应包含：

```
 <uses-permission android:name="android.permission.INTERNET"/> 
```

如果您使用 Eclipse 并单击 AndroidManifest.xml，请选择权限选项卡并单击“添加”并选择“使用权限”并选择“android.permission.INTERNET”权限。

Eclipse AndroidManifest.xml 视图的“应用程序”选项卡有一个“权限”下拉菜单——不要使用它。（这是一个误导性的领域）

# c# - 字符串将 Linq 中的错误转换为实体连接语句 - 此函数只能从 LINQ 调用到实体

> ID：11816177
> 
> 赞同：0
> 
> 时间：2012-08-05T11:53:44.230
> 
> 标签：c#, asp.net, entity-framework-4, linq-to-entities

我正在尝试在 2 个表之间编写一个 ling 2 实体左连接查询，其中连接列在表中具有不同的数据类型。因此，我使用 new 关键字使用 SqlFunctions.StringConvert() 函数执行字符串转换。

但这会引发错误，提示“只能从 LINQ to Entities 调用此函数。”

sql查询看起来像这样......

```
select distinct j.jobid from jobs j
left join jobfilters jf
on j.jobid = jf.jobid 
left join vwbranchmaster bm
on bm.branchid = jf.jobfilterkey 
```

在这个查询中，bm.branchid 是 int，jobfilterkey 是 nvarchar。不幸的是，Branchmaster 位于外部数据库中，因此我们无法修改数据库列。

L2E 查询看起来是这样的，（请注意 dt 是 DataTable 转换为 Enumerable 类型）

```
from J in dt
join JFBRegion in JobFilter on J.Field<Guid>("JobId") equals JFBRegion.JobID into JFBRegion_join
from JFBRJ in JFBRegion_join.DefaultIfEmpty()
join BRMAS in BranchMaster on new { JobFilterKey = JFBRJ.JobFilterKey } equals new { JobFilterKey = SqlFunctions.StringConvert((decimal)BRMAS.BranchID) } into BMASJF_join
from BMASJF in BMASJF_join.DefaultIfEmpty() 
```

请让我知道我在这里做错了什么，或者这是否可能。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T11:59:43.047

如果您在 a 上执行此查询，`DataTable`那么这不是`Linq To Entities`因为您在 .NET 内存中执行。您需要使用`Entity Framework`上下文执行查询。

# c# - C# 包关系 ID

> ID：11816186
> 
> 赞同：0
> 
> 时间：2012-08-05T11:54:22.023
> 
> 标签：c#, .net, xml, package

我正在尝试使用 System.IO.Packaging 命名空间来存储一些自定义文件，然后稍后将它们读回代码中。

我很难找到关于如何使用/设置 PackagePartRelationship 的 ID 属性的明确示例。

例如，如果我有以下内容：

```
var relationship = packagePart.CreateRelationship(documentPart.Uri, TargetMode.Internal, relationshipType, relationshipId); 
```

参数“relationshipId”应该采用什么格式？MSDN 文档中声明的只是它应该遵守 XML 方案数据类型定义中有效 xsd:Id 值的规则。但是通过搜索，我也找不到一个固定的答案。

另外，如果有人问，我想指定 Id 而不是让它自动生成的原因是因为包中的一些关系链只有与它相关的“子”或“关系”。所以而不是循环

```
packagePart.GetRelationships() 
```

或者

```
packagePart.GetRelationshipByType(relationshipType) 
```

我希望能够做到

```
packagePart.GetRelationship(relationshipId) 
```

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:01:28.880

xsd:id 是具有唯一约束的 xsd:NCName。

所以没有冒号，没有逗号，也不能以数字开头。

# php - 不从shopp价格模块设置购买价格[Shopplugin]

> ID：11816188
> 
> 赞同：0
> 
> 时间：2012-08-05T11:54:27.527
> 
> 标签：php, e-commerce, shopp

我曾经将定价和产品设置为捐赠，并且来自非购物脚本的价格作为捐赠金额发送到下一步，因此用户无法更改数量，因为它与捐赠金额相结合。可能是同一个变量。下一个缺陷是我无法设置产品运费。我认为我选择了错误的方法，正确的方法是将定价和产品设置为正常选项“运费”。但如果我选择此选项，我不知道如何从非 shopp 模块设置价格。我不能在定价模块中使用 bulid 因为变体太多，配置器有 22 个选项..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-26T09:11:18.800

你可以使用[`shopp('product', 'input');`](https://shopplugin.net/api/product-input/). 这适用于不影响价格的变化的产品。例如，当一件 T 恤有 22 种颜色和 4 种尺寸并且都以相同的价格出售时。

变化可以快速增长。当您的产品具有每 4 个选项的 3 个变体时，您实际上是在添加 4x4x4 (=64) 个产品（价格）。有时最好重新考虑创建产品的方式。

# weka - Weka - 使用多行定义类属性的标称值

> ID：11816192
> 
> 赞同：2
> 
> 时间：2012-08-05T11:54:59.710
> 
> 标签：weka, arff

在我的 ARFF 文件中，而不是：

```
@ATTRIBUTE myclass {value1, value2, value3} 
```

我想写一些类似的东西：

```
@ATTRIBUTE myclass 
{
value1, 
value2, 
value3
} 
```

原因：myclass 最终将包含近 1000 个值，使用第二种格式更容易阅读和编辑 arff 文件。

我尝试使用上述格式，但收到一条错误消息，提示“无法将结构确定为 arff。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T12:40:19.110

据我所知，这在 Weka 是不可能的。您可以保留一个单独的文件，在其中以您喜欢的格式列出所有课程以供编辑/阅读，并在您进行任何更改后将其转换为 Weka 的格式。例如，如果您使用[类 Unix](https://en.wikipedia.org/wiki/Unix-like)操作系统，您可以`tr`在终端中使用以下命令：

```
tr '\n' ' ' < <filename> 
```

然后，您可以将输出复制到您的 ARFF 文件中。

# javascript - 在 LocalStorage 中存储用户定义的 JavaScript 对象并将它们作为用户定义的对象类型检索

> ID：11816194
> 
> 赞同：1
> 
> 时间：2012-08-05T11:55:09.643
> 
> 标签：javascript, json

我一直在研究一个涉及本地存储的应用程序。我有一个`deck`类型对象数组。甲板对象本身包含`card`类型对象。因此，在查看了如何使用 localstorage 存储对象之后，我发现了这个 SO 帖子：

[在 HTML5 localStorage 中存储对象](https://stackoverflow.com/questions/2010892/storing-objects-in-html5-localstorage)

据我了解，localstorage 仅将数据存储为字符串，因此我的卡片组对象需要使用`JSON.stringify`.

但是，当我从 localstorage 中检索对象时`JSON.parse`，我得到的对象不是我原来的用户定义类型，即`deck`类型。

我的问题是这样的：有没有办法从本地存储中检索我的对象作为其原始类型（甲板类型）的对象？预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:06:37.313

您可以使用可选的[reviver 参数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse)来转换它们：

```
var json = '{"decks": [{"cards":[{"id": 1},{"id": 2},{"id": 3}],"id":3},{"cards":[{"id": 4},{"id": 5},{"id": 6}],"id":4}]}';

function Deck( cards, id ) {
    this.cards = cards;
    this.id = id;
}

function Card(id) {
    this.id = id;
}

var decks = JSON.parse(json, function(key, value ) {

    if( key === "decks" ) {
        return value.map( function(deck) {
            return new Deck( deck.cards, deck.id );
        });
    }
    else if( key === "cards" ) {
        return value.map( function( card ) {
            return new Card( card.id );
        });
    }
    else {
        return value;
    }
}).decks; 
```

然后做：

```
console.log( decks ) 
```

给出以下内容：

![在此处输入图像描述](../Images/110d14154612dc17e8ef09419f11e230.png)

# python - 如何在谷歌应用引擎模板上获取 cookie 值

> ID：11816196
> 
> 赞同：3
> 
> 时间：2012-08-05T11:55:42.030
> 
> 标签：python, google-app-engine, cookies

我正在开发一个应用程序来了解 python 和 Google App Engine。我想从 cookie 中获取值并在模板上打印以隐藏或显示一些内容。

可能吗？

什么样的会话系统最适合与谷歌应用引擎一起使用？

在 gae 和模板上使用会话的最佳方式是什么？

如何使用模板验证 cookie 的值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T13:29:39.857

请记住，Google App Engine 是一个平台，而不是一个框架，所以您的问题是 webapp2（GAE 中使用的默认框架）是否有一个很好的接口来处理 cookie。即使框架没有这个接口，只要你可以访问请求的 Cookie 头，你就可以访问 cookie。

这里有两个示例，一个使用 webapp2 cookie 接口，另一个仅使用 Cookie 标头。

网络应用程序2：

```
class MyHandler(webapp2.RequestHandler):
    def get(self):
        show_alert = self.request.cookies.get("show_alert")
        ... 
```

Cookie 标头（使用 webapp2）：

```
# cookies version 1 is not covered
def get_cookies(request):
    cookies = {}
    raw_cookies = request.headers.get("Cookie")
    if raw_cookies:
        for cookie in raw_cookies.split(";"):
            name, value = cookie.split("=")
            for name, value in cookie.split("="):
                cookies[name] = value
    return cookies

class MyHandler(webapp2.RequestHandler):
    def get(self):
        cookies = get_cookies(self.request)
        show_alert = cookies.get("show_alert")
        ... 
```

会话也是如此，虽然制作自己的会话库比较困难，但无论如何，webapp2 已经涵盖了：

```
from webapp2_extras import sessions

class MyBaseHandler(webapp2.RequestHandler):
    def dispatch(self):
        # get a session store for this request
        self.session_store = sessions.get_store(request=self.request)
        try:
            # dispatch the request
            webapp2.RequestHandler.dispatch(self)
        finally:
            # save all sessions
            self.session_store.save_sessions(self.response)

    @webapp2.cached_property
    def session(self):
        # returns a session using the backend more suitable for your app
        backend = "securecookie" # default
        backend = "datastore" # use app engine's datastore
        backend = "memcache" # use app engine's memcache
        return self.session_store.get_session(backend=backend)

class MyHandler(MyBaseHandler):
    def get(self):
        self.session["foo"] = "bar"
        foo = self.session.get("foo")
        ... 
```

有关会话和 cookie 的更多信息，请参阅[webapp 文档](http://webapp-improved.appspot.com/api/webapp2_extras/sessions.html?highlight=session#webapp2_extras.sessions)。

关于您关于模板的问题，您应该再次查看您使用的模板引擎的文档并查找您需要了解的内容。

# python - 在 Python 中比较图像

> ID：11816203
> 
> 赞同：10
> 
> 时间：2012-08-05T11:56:40.070
> 
> 标签：python, image-processing, image-comparison

我需要比较两个作为软件屏幕截图的图像。我想检查两个图像是否相同，包括图像中显示的数字和字母。如何实现？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-05T17:04:46.173

有以下方法可以进行正确的比较。

*   首先是**均方根差 #**

要衡量两个图像的相似程度，您可以计算图像之间差异的均方根 (RMS) 值。如果图像完全相同，则该值为零。下面的函数使用差分函数，然后从结果图像的直方图中计算 RMS 值。

```
# Example: File: imagediff.py

import ImageChops
import math, operator

def rmsdiff(im1, im2):
    "Calculate the root-mean-square difference between two images"

    h = ImageChops.difference(im1, im2).histogram()

    # calculate rms
    return math.sqrt(reduce(operator.add,
        map(lambda h, i: h*(i**2), h, range(256))
    ) / (float(im1.size[0]) * im1.size[1])) 
```

*   另一个是**精确比较#**

判断两幅图像内容是否完全相同的最快方法是获取两幅图像之间的差异，然后计算出这幅图像中非零区域的边界框。如果图像相同，则差异图像中的所有像素都为零，并且边界框函数返回 None。

```
import ImageChops

def equal(im1, im2):
    return ImageChops.difference(im1, im2).getbbox() is None 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-05T17:19:10.947

我正在维护一个名为[pyssim](https://github.com/jterrace/pyssim)的 Python 库，它使用[结构化相似性 (SSIM)](http://en.wikipedia.org/wiki/Structural_similarity)方法来比较两个图像。

它没有 python 绑定，但是[perceptualdiff](https://github.com/myint/perceptualdiff)程序在比较两个图像方面也很棒——而且速度非常快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T15:06:45.593

我不能给出一个现成的答案，但我会指出（我认为）正确的方向。比较两个图像的一种简单方法是对它们的二进制表示进行散列，然后查看这些散列是否相同。这样做的一个问题是您要使用的散列函数，您必须寻找一个碰撞机会低的哈希函数，另一个是图像文件可能具有附加到原始二进制信息的元数据，因此您必须查看在如何切断该元数据以便仅使用它们的二进制信息比较图像。另外，我不确定，但可能以 jpg 编码的图像的二进制表示与以 png 编码的图像不同，因此您应该注意这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-11-26T19:31:25.603

对于任何偶然发现这一点并且接受的答案对他们不起作用的人，我将其发布在这里。

我有一个类似的场景，我需要将一张图像与其他数千张图像进行比较，然后找到最相似的一张。我最终开始使用 ImageChop 的差异函数并应用如下平均值：

```
import numpy as np

def calcdiff(im1, im2):
    dif = ImageChops.difference(im1, im2)
    return np.mean(np.array(dif)) 
```

通过将差异图像转换为数组，我可以计算平均差异。差异越小，图像与原始图像越接近。

* * *

**注意：**另一种接近完全相似的方法是将 转换`ImageChops.difference(im1, im2)`为 numpy 数组，然后从数组中减去完全匹配`[0, 0, 0]`的像素。然后通过计算`len()`数组的 ，我们获得一个分数，这使我们能够区分图像。最接近的是分数最低的那个

# php - 供应商文件中的命名空间（CakePHP2.x 和 PHP5.4.3）

> ID：11816211
> 
> 赞同：4
> 
> 时间：2012-08-05T11:57:25.907
> 
> 标签：php, cakephp, namespaces, cakephp-2.2

我想使用一个使用命名空间的 css 解析器。我将文件放在供应商中，然后应用程序将其导入。但脚本本身似乎没有找到它的类

在我班级的顶部，我导入了文件：

```
App::import('Vendor', 'Sabberworm', array('file' => 'Sabberworm/CSS/Parser.php')); 
```

在 /root/vendors/Sabberworm/CSS/ 中（所有文件都在这个命名空间中）

在我的类方法中，我创建了一个新实例：

```
public function parse($content) {
    $oParser = new Sabberworm\CSS\Parser($content);
    ...
} 
```

到目前为止，一切都很好。但如果我现在想称之为`$oCss = $oParser->parse();`致命错误：

```
"Fatal error: Class 'Sabberworm\CSS\CSSList\Document'" 
```

然后它失败了，因为它需要其他文件（应该使用命名空间加载）。根供应商文件夹位于包含路径中，并且外部脚本似乎将命名空间设置为“namespace Sabberworm\CSS;”。我错过了什么？我对命名空间有点陌生。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-05T20:15:08.373

将此添加到引导程序

```
spl_autoload_register(function($class) {
    foreach(App::path('Vendor') as $base) {
        $path = $base . str_replace('\\', DS, $class) . '.php';
        if (file_exists($path)) {
            return include $path;
        }
    }
}); 
```

或者只是函数内部的这个：

```
$path = APP . 'Vendor' . DS . str_replace('\\', DS, $class) . '.php';
if (file_exists($path)) {
    include $path;
} 
```

# java - 在 Spring 中检索缓存列表

> ID：11816215
> 
> 赞同：1
> 
> 时间：2012-08-05T11:57:38.020
> 
> 标签：java, spring, caching, ehcache, spring-3

我在独立环境中使用 Spring3.1。

我正在尝试缓存我的条目。所以在 3.1 中我可以这样使用@Cacheable：

```
@Cacheable("client")
@Override
public ClientDTO getClientByLogin(String login) throws FixException
{
    ClientDTO client = null;
    try
    {
        client = (ClientDTO) jdbcTemplate.queryForObject(GET_CLIENT_BY_LOGIN_STATEMENT, new Object[]
        { login }, new ClientDTO());
    }
    catch (EmptyResultDataAccessException e)
    {
        log.error("Client login not exist in database. login=" + login);
    }

    if (client == null)
    {
        throw new FixException("Return null from DB when executing getClientByLogin(), login=" + login);
    }
    return client;
} 
```

现在每次我调用 getClient 时，它都会首先查看它的缓存资源库。

如果我想检索缓存列表以便对其进行迭代。我怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-08-28T13:04:22.247

如果要检索缓存的对象，则以下代码应该可以工作

```
public ClientDTO  getCachedClient() {
        Cache cache = cacheManager.getCache("client");
        Object cachedObject = null;
        Object nativeCache = cache.getNativeCache();
        if (nativeCache instanceof net.sf.ehcache.Ehcache) {
            net.sf.ehcache.Ehcache ehCache = (net.sf.ehcache.Ehcache) nativeCache;
            List<Object> keys = ehCache.getKeys();

            if (keys.size() > 0) {
                for (Object key : keys) {
                    Element element = ehCache.get(key);
                    if (element != null) {

                        cachedObject = element.getObjectValue();

                    }
                }
            }
        }
        return (ClientDTO)cachedObject;

    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T05:22:20.030

Spring Cache 中没有这种方法可以迭代缓存列表。如果要遍历 ClientDTO 的集合，则需要将其放入缓存中：

```
@Cacheable(value="client", key="all")
@Override
public List<ClientDTO> getAll() throws FixException  {
  List<ClientDTO> clients = null;
  try {
    clients = ....; // fetch all objects
  } catch (EmptyResultDataAccessException e) {
    //
  }

  if (clients == null) {
    //
  }
  return clients;
} 
```

在这种情况下，每次修改客户端对象时，都应该使列表无效。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-08-06T06:34:19.350

我找到了一个解决方案：

```
private ClientDTO getClientDTOByClientId(Integer clientId)
{
    ClientDTO clientDTO = null;
    Cache clientCache = null;
    try
    {
        clientCache = ehCacheCacheManager.getCache("client");
        clientDTO = null;
        if (clientCache != null)
        {
            clientDTO = (ClientDTO) clientCache.get(clientId);
        }
        else
        {
            log.error("clientCache is null");
        }
    }
    catch (Exception e)
    {
        log.error("Couldnt retrieve client from cache. clientId=" + clientId);
    }
    return clientDTO;
} 
```

# powershell - 使用文件夹名称在powershell中重命名文件

> ID：11816218
> 
> 赞同：4
> 
> 时间：2012-08-05T11:57:52.193
> 
> 标签：powershell, file-io

使用 Powershell，我想通过使用文件所在文件夹的名称来重命名文件夹中的文件。所以在我的 C:\temp 目录中，有 3 个文件夹分别称为“aaa”、“bbb”和“ccc”。在每个文件夹中，有 3 个文件，分别称为 doc1.txt、doc2.txt 和 doc3.txt。我想将所有 9 个 .txt 文件重命名为 folderName+fileName，因此它们将重命名为以下内​​容：

```
aaadoc1.txt
aaadoc2.txt
aaadoc3.txt
bbbdoc1.txt
bbbdoc2.txt
bbbdoc3.txt
cccdoc1.txt
cccdoc2.txt
cccdoc3.txt 
```

请任何人指出我如何解决这个问题的正确方向？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-05T12:33:04.913

这将重命名文件并在文件夹名称和文件名之间添加下划线 ('_')：

```
Get-ChildItem C:\temp -Filter *.txt -Recurse | Rename-Item -NewName { $_.Directory.Name+'_'+$_.Name} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T12:05:45.277

`[IO.Directory]::GetCurrentDirectory().split('\\')[-1]`会给你你所在的目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T12:12:23.837

尝试这个

```
$dirname = resolve-path . | split-path -leaf
Get-ChildItem -Name | Foreach { Rename-Item $_  ( $dirname + $_ ) } 
```

小心不要破坏/删除您的任何文件。没有保证。

# facebook - 合并还是不合并？Facebook 帐户和常规站点帐户

> ID：11816219
> 
> 赞同：7
> 
> 时间：2012-08-05T11:58:34.323
> 
> 标签：facebook, login, user-accounts

我正在构建一个网络服务，允许用户通过创建“常规”帐户（用户名/密码）或使用他们的 facebook 登录（facebook connect）来注册

如果用户在 facebook 上注册，他们将在我的网站上创建一个帐户。

如果用户以正常方式（用户名/密码）注册，他们还将获得一个帐户。

如果它们具有相同的电子邮件地址，我想做的是以某种方式合并这些帐户。这是可行的还是我应该将它们作为单独的帐户保留？

合并的原因是我不希望用户每个电子邮件地址有多个帐户是否有其他人通过 facebook 和常规帐户在他们的网站上创建帐户？如果是这样，您应用什么逻辑来处理这两种不同类型的帐户？

更新

我想我的问题是，如果普通帐户与 facebook 帐户具有相同的电子邮件地址。我可以安全地合并帐户吗？或者我可以不信任用户与其 Facebook 帐户关联的电子邮件吗？——</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T13:41:35.780

不确定我是否明白你想说的，但我也已经有一堆帐户并将它们链接到 Facebook 个人资料。不同之处在于我也让他们使用原始站点登录。

所以我不需要检查电子邮件。就像这样：

1.  用户已经登录了本地站点，在这种情况下，当他们将自己的帐户与 google 链接时，我所做的就是将 FacebookId 字段添加到表中。
2.  用户在我的网站上还没有帐户，但通过有效的 facebook 帐户访问它，在这种情况下，用户被添加到我的帐户列表中，并获得内部 ID 和 FacebookId。

希望这对您有所帮助。当然，我也可以在这里完全相反的方向思考..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T13:57:38.740

我刚刚经历过类似的事情。我认为没有任何理由为各种成员提供超过 1 张桌子。每个成员都是一行，根据他们成为成员的方式，它具有不同的字段。

他们可以本地登录，也可以使用 Facebook 登录。在每种情况下，他们都将始终以本地方式登录，但在 Facebook 的情况下，他们将不必记住另一组凭据，当他们验证您的网站时，您可以从 Facebook 中提取这些凭据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-04T21:52:27.350

您应该考虑验证使用电子邮件地址注册的任何帐户。通常这是通过向用户发送电子邮件要求他们单击特殊链接或复制您在电子邮件中发送的代码并将其粘贴到您的网站来完成的。

然后，您可以确信 Facebook 提供的匹配电子邮件地址是同一用户。

# python - Mayavi/IPython shell 不是预期的行为

> ID：11816222
> 
> 赞同：0
> 
> 时间：2012-08-05T11:58:58.083
> 
> 标签：python, command-line, ipython, mayavi

我正在尝试在[这里](http://docs.enthought.com/mayavi/mayavi/tips.html)学习 MAYAVI 的提示和技巧。例如，我正在尝试在段落[纹理映射演员](http://docs.enthought.com/mayavi/mayavi/tips.html#texture-mapping-actors)中做纹理的事情。这是一些命令行代码，我想我可以直接在 IPython 中提示这个（我使用的是 Win 7）。

这不适用于 IPython，也不适用于 IPython (sh)。

![不使用 IPython，怎么了？](../Images/f7c91884700201ec4d2775afca854f4f.png)

顺便说一句，python（x，y）中不同的命令行选项有什么区别：IPython，IPython Qt，IPython pythonxy和Python解释器？

如何尝试此代码示例？是否可以使用 Windows 或者我应该将其转换为脚本？

另外，我正在尝试这样做[，](http://docs.enthought.com/mayavi/mayavi/advanced_scripting.html#advanced-scripting-with-mayavi)段落面向对象的可视化构造。教程提到

> 与所有 Mayavi 代码一样，您需要运行 GUI 主循环才能使可视化生效。在 ipython -wthread （或最新版本中的 ipython –gui=wx ）中键入此代码将为您完成此操作。

两种解决方案都不起作用。[一些网络事物提到](http://mindseye.no/)应该使用now `--pylab=qt`，这也不起作用。顺便说一句，“让可视化上线”意味着什么？输入一些命令后，您看到事情会立即移动吗？这是在 doc 的 scipting 页面中：我想我会像往常一样拥有一个脚本，编译它，然后在运行时查看结果。关于这个话题的一些启示？

谢谢并恭祝安康。

### 编辑：我用 doc 解决了部分问题

> 如果您使用的是 Enthought Python 发行版或最新的 Python(x,y) 发行版，Pylab 菜单项将使用正确的开关启动 ipython。在旧版本的 Python(x,y) 中，您需要启动“交互式控制台 (wxPython)”。

但我对所有其他部分的提示感兴趣！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:45:31.187

要从 IPython 运行命令行，请以`!`. 不要包含`$`，这是 Unix 上的标准 shell 提示符（就像`>`Windows 命令提示符中的 ）。

# c++ - 如何访问 RCDATA 资源的元素？

> ID：11816226
> 
> 赞同：0
> 
> 时间：2012-08-05T11:59:37.160
> 
> 标签：c++, winapi

我一直在尝试在 RCDATA 资源中存储一些值，但我不确定我应该如何单独访问它们。

```
HGLOBAL hMem = LoadResource(hInstance,FindResource(hInstance,MAKEINTRESOURCE(IDR_RCDATA),RT_RCDATA));
PVOID lpData = LockResource(hMem); 
```

我“认为”我已经成功获得了指向我的数据的指针，但我现在应该做什么，我不知道。

[http://msdn.microsoft.com/en-us/library/cc194809.aspx](http://msdn.microsoft.com/en-us/library/cc194809.aspx)是我能找到的唯一信息，除了 delphi 示例，它们都没有帮助我。我的 RCDATA 如下。

```
IDR_RCDATA RCDATA 
{
    10,
    30
} 
```

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:03:37.610

这样的资源没有结构，它只是一个字节块。编写强加结构的代码取决于您。在您的 .rc 片段中没有可见，所以唯一合乎逻辑的事情就是读取字节 lpData[index]。SizeOfResource() 可帮助您避免索引 blob 超出范围。

# java - 检测数十亿行中预定义关键字的最有效方法/库？

> ID：11816231
> 
> 赞同：5
> 
> 时间：2012-08-05T12:00:24.313
> 
> 标签：java, solr, lucene, string-matching, fuzzy-search

假设我有几十亿行文本和几百万个“关键字”。任务是遍历这些行并查看哪一行包含哪些关键字。换句话说，给定一个 和 的映射 `(K1 -> V1)`，`(K2 -> V2)`创建一个`(K2 -> K1)`where `K1=lineID`、`V1=text`和`K2=keywordID`的映射`V2=keyword`。另请注意：

*   所有文字/关键字均为英文
*   文本 (V1) 可能包含拼写错误。
*   大多数关键字（V2）是单个单词，但有些关键字可能包含多个英文单词（例如“clean towel”）

到目前为止，我解决这个问题的初步想法如下：

```
1) Chop up all my keywords into single words and 
   create a large set of single words (K3)
2) Construct a BK-Tree out of these chopped up keywords,
   using Levenshtein distance
3) For each line of data (V1), 
    3.1) Chop up the text (V1) into words
    3.2) For each said word,
        3.2.1) Retrieve words (K3) from the BK-Tree that
               are close enough to said word
    3.3) Since at this point we still have false positives,
        (e.g. we would have matched "clean" from "clean water" against
         keyword "clean towel"), we check all possible combination
          using a trie of keyword (V2) to filter such false 
          positives out. We construct this trie so that at the
          end of an successful match, the keywordID (K2) can be retrieved.
    3.4) Return the correct set of keywordID (K2) for this line (V1)!
4) Profit! 
```

**我的问题**

*   这是一个好方法吗？效率很重要——有没有更好的方法？有什么需要改进的吗？
*   有没有我可以使用的库？最好是可以与 Java 很好地配合使用的东西。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T18:11:33.243

不确定，但您在这里的期望（K2->K1）与倒排索引（[http://en.wikipedia.org/wiki/Inverted_index](http://en.wikipedia.org/wiki/Inverted_index)）非常相似。

我相信 Lucene/Solr 在索引数据时使用相同的算法（它也会进行数据前分析/标记），您可能需要找出一种可以读取 Lucene 构建索引的方法（从 Lucene 的“IndexReader”javadoc 开始）。

在索引您的数据时，将每一行视为 Lucene 索引中的一个文档，在索引中创建两个字段 1) 行 ID 和 2) 数据 - 一旦您索引所有文档（行），您已经为您创建了 K2->K1，您只需需要找到一种方法来解析它。

我不确定在创建 K2->K1 之后您的下一步是什么，如果它的查找速度比您不需要解析索引的速度更快，您可以触发 Lucene 查询。

在 SOLR 中，如果有帮助，您还可以在索引上生成分面搜索结果。

**编辑：** 您可以使用 LUKE 工具来分析 Lucene 索引（[https://code.google.com/p/luke/](https://code.google.com/p/luke/)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T14:28:26.223

有一些优化的多模式/二维搜索算法。不要再发明轮子了。您还应该考虑分配您的计算。也许hadoop和map/reduce？

# .net - 中继命令和无参数执行方法

> ID：11816234
> 
> 赞同：6
> 
> 时间：2012-08-05T12:01:02.037
> 
> 标签：.net, wpf, mvvm, lambda

我目前正在学习 WPF 和 MVVM，我想我掌握了大部分内容以及它是如何工作的，但是我在使用 RelayCommand（或 DelegateCommand）时遇到了一些我不理解的东西。我认为这与代表的工作方式有关。

请注意，下面的代码目前都只是在测试解决方案中，所以没有实时代码。此外，我正在考虑对不需要诸如 close 之类的参数的命令进行此操作，并了解其工作原理。

因此，如果我采用 Josh Smith 创建的 RelayCommand（[http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090030](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090030)），我可以设置如下命令：

```
RelayCommand updateTextContentCommand;

public ICommand UpdateTextContentCommand
{
    get
    {
        if (updateTextContentCommand == null)
        {
            updateTextContentCommand = new RelayCommand(
                param => this.UpdateTextContentCommand_Execute());
        }
        return updateTextContentCommand;
    }
} 
```

使用此执行方法：

```
public void UpdateTextContentCommand_Execute()
{
    this.TextContent = DateTime.Now.ToString();
} 
```

我使用一个简单的绑定到 TextBlock 来查看结果，并且命令绑定到一个按钮。这工作正常。我没有得到的是使用 lambda 表达式来创建命令。期望一个`Action<object>`参数不是吗？那么为什么这段代码有效呢？

如果我将上面的代码更改为

```
if (updateTextContentCommand == null)
{
    updateTextContentCommand = new RelayCommand(
        this.UpdateTextContentCommand_Execute());
} 
```

我收到这些错误：

*“MVVM.RelayCommandTesting.Framework.RelayCommand.RelayCommand(System.Action)”的最佳重载方法匹配有一些无效参数

参数 1：无法从 'void' 转换为 'System.Action'*

并删除`()`after Execute 给出此错误：

*参数 1：无法从“方法组”转换为“System.Action”*

但是，如果我像这样更改代码：

```
if (updateTextContentCommand == null)
{
    updateTextContentCommand = new RelayCommand(
        this.UpdateTextContentCommand_Execute);
}

public void UpdateTextContentCommand_Execute(object param)
{
    this.TextContent = DateTime.Now.ToString();
} 
```

它符合并运行良好。如果我将视图更改为使用 CommandParameter 我可以使用 param 使用此方法设置文本内容，但如果我使用 lambda 样式，我必须将参数传递给该行，因此它就像这样 param => `this.UpdateTextContentCommand_Execute(param)`。

在我的测试中，我对 CommandParameter 值进行了硬编码，但我猜它很可能是绑定到真实系统中 ViewModel 属性的数据，因此您可以以 lambda 样式传递参数。

谁能解释一下为什么无参数版本适用于 lambda 样式？

感谢您抽时间阅读。

下面的问题似乎也有一些关于 lambda 的问题，但我没有看到它回答了我的问题。

[使用 ViewModel 中定义的 RelayCommand 传递参数（来自 Josh Smith 示例）](https://stackoverflow.com/questions/810208/passing-a-parameter-using-relaycommand-defined-in-the-viewmodel-from-josh-smith)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-05T12:34:55.813

构造函数参数是一个具有以下签名的委托：

```
void MethodName(T parameter) 
```

其中参数是类型`T`（在 RelayCommand 的情况下，这将是`system.Object`.

这段代码：

```
param => this.UpdateTextContentCommand_Execute() 
```

是一个[lambda](http://msdn.microsoft.com/en-us/library/bb397687.aspx)表达式，它本质上扩展为：

```
void AnonymousMethod(object param)
{
    this.UpdateTextContentCommand_Execute();
} 
```

因此，在这种情况下，您**传递**的是一个参数 ( `param`)，您只是没有使用它。如果您理解了这一点，那么您现在应该明白为什么您的其他示例的行为方式会如此。

**示例 1**

```
if (updateTextContentCommand == null)
{
    updateTextContentCommand = new RelayCommand(
        this.UpdateTextContentCommand_Execute());
} 
```

在这里，您正在**调用**返回 void 的方法。构造函数期望与`Action<T>`委托匹配的东西，因此会出现错误。

**示例 2**

如果然后像这样删除括号：

```
if (updateTextContentCommand == null)
{
    updateTextContentCommand = new RelayCommand(
        this.UpdateTextContentCommand_Execute);
} 
```

把这想象成有点像订阅一个事件：

```
myObject.myevent += new Action<object>(this.UpdateTextContentCommand_Execute); 
```

可以缩短为：

```
myObject.myevent += this.UpdateTextContentCommand_Execute; 
```

因此，构造函数接受具有与委托签名匹配的**签名的任何方法，即**`Action<T>`

```
void UpdateTextContentCommand_Execute(object parameter) 
```

您的方法具有以下签名：

```
void UpdateTextContentCommand_Execute() 
```

如您所见，签名不匹配，因此编译器会抱怨。

当您更新`UpdateTextContentCommand_Execute`方法以接受对象参数时，它的签名现在匹配，这就是它现在起作用的原因。

# python - 如何从配置文件配置烧瓶 app.logger？

> ID：11816236
> 
> 赞同：7
> 
> 时间：2012-08-05T12:01:15.733
> 
> 标签：python, logging, flask

有没有办法从配置文件配置flask app.logger，例如：

```
logging.config.fileConfig('/path/to/logging.cfg') 
```

或者

```
logging.config.dictConfig(config_dict) 
```

所以我可以`app.logger.info('some message')`用来登录开发和产品模式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-25T15:51:56.780

你需要先打电话`app.logger`，然后再打电话`logging.config.dictConfig(config_dict)`。记录器名称应在 config_dict 和 app.logger_name 中相同

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:41:52.600

[`logging`](https://github.com/kingheaven/ScriptFan.com/blob/5f0ee791da9d77e67ab8326c964e7c5de5aa89e3/website/scriptfan/__init__.py#L22)将第 22 行更改为[`app.logger`](http://flask.pocoo.org/docs/api/#flask.Flask.logger)- 这将为您当前的 Flask 应用程序配置记录器。或者，您可以使用日志记录模块的[`getLogger`](http://docs.python.org/library/logging.html#logging.getLogger)功能并使用[`app.logger_name`](http://flask.pocoo.org/docs/api/#flask.Flask.logger_name)来拉取正确的记录器。

# php - 我的 ubuntu 服务器上的 php shell_exec 不运行该命令！为什么呢？

> ID：11816238
> 
> 赞同：-1
> 
> 时间：2012-08-05T12:01:27.920
> 
> 标签：php, linux, bash, shell-exec

这真让我抓狂。经过大量测试，我设法`.sh`在终端中成功运行了以下文件，并且它按我的预期完美运行。

```
adt -package -target apk -storetype pkcs12 -keystore $AND_CERT_FILE -storepass $AND_CERT_PASS "$OUTPUT" "$APP_XML" -C bin . -C icons/android . -extdir lib .

echo "DONE"; 
```

我想从 PHP 而不是终端运行它，所以我在 PHP 中编写了以下代码来调用该`.sh`文件，但是尽管 PHP 返回了“DONE”消息，但该命令不起作用。如果我输入错误命令，则不会显示任何错误。这是我用 PHP 写的：

```
$output = shell_exec("./test.sh");
echo $output; 
```

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T12:41:04.560

您不能将选项与非选项参数混合使用。

正确的格式是：

```
command [-options ...] [--] [non-option arguments] 
```

任何不以开头的单词`-`都将结束选项处理，bare `--`（可选）也将结束。之后的所有参数都不会作为选项处理。

参数`"$OUTPUT"`和`"$APP_XML"` 属于该行的末尾，或者缺少正确的选项前缀`adt`（我将其留作练习）。

```
adt -package -target apk -storetype pkcs12 \
    -keystore $AND_CERT_FILE \
    -storepass $AND_CERT_PASS \
    -C bin . \
    -C icons/android . \
    -extdir lib . \
    "$OUTPUT" "$APP_XML" 
```

请注意，我提交了对原始代码的编辑，并在此处分解了行。在编辑之前，我一点头绪都没有。在添加`\` `newline`对时，问题变得很明显。

看看这个[adt 打包故障排除](http://cartoonsmartblog.wordpress.com/2011/04/13/adt-command-air-2-6-troubleshooting-im-on-a-mac-sigh/)博客条目。这似乎证实了我的猜想。博主明确警告最后指定任何文件名。

# asp.net-mvc - 用作引用项目时，servicestack 会中断 MVC 路由

> ID：11816240
> 
> 赞同：1
> 
> 时间：2012-08-05T12:01:37.420
> 
> 标签：asp.net-mvc, asp.net-mvc-3, servicestack, ormlite-servicestack

我创建了一个 servicestack MVC 项目，我将其用作数据库的主要 API。因为我想在我的代码中访问模型，所以我还在我的 MVC Views Project 和 Controllers 项目中添加了对该项目的引用。

但是，当我运行我的项目 [网站项目] 时，我遇到了真正的问题，ServiceStack 认为它拥有我的解决方案，并接管了所有请求，然后无法解决我的路线。

我已经在 web 项目全局文件中添加了路由，我也尝试将这些路由添加到 servicestack 项目，但仍然无法解决。

这是错误：

```
[ResolutionException: Required dependency of type      uyr.print.controllers.Controllers.UsersController could not be resolved.]
    Funq.Container.ThrowMissing(String serviceName) in        C:\src\ServiceStack\src\ServiceStack\Funq\Container.cs:297
   Funq.Container.GetEntry(String serviceName, Boolean throwIfMissing) in C:\src\ServiceStack\src\ServiceStack\Funq\Container.cs:275
   Funq.Container.ResolveImpl(String name, Boolean throwIfMissing) in C:\src\ServiceStack\src\ServiceStack\Funq\Container.cs:112
  Funq.Container.ResolveNamed(String name) in C:\src\ServiceStack\src\ServiceStack\Funq\Container.Overloads.cs:283
  Funq.Container.Resolve() in C:\src\ServiceStack\src\ServiceStack\Funq\Container.Overloads.cs:230
   lambda_method(Closure , Container ) +41
    ServiceStack.ServiceHost.ContainerResolveCache.CreateInstance(Type type, Boolean tryResolve) in C:\src\ServiceStack\src\ServiceStack\ServiceHost\ContainerResolveCache.cs:62
   ServiceStack.ServiceHost.ContainerResolveCache.CreateInstance(Type type) in C:\src\ServiceStack\src\ServiceStack\ServiceHost\ContainerResolveCache.cs:37
   ServiceStack.Mvc.FunqControllerFactory.GetControllerInstance(RequestContext   requestContext, Type controllerType) in   C:\src\ServiceStack\src\ServiceStack.FluentValidation.Mvc3\Mvc\FunqControllerFactory.cs:38
    System.Web.Mvc.DefaultControllerFactory.CreateController(RequestContext requestContext, String controllerName) +74
   System.Web.Mvc.MvcHandler.ProcessRequestInit(HttpContextBase httpContext, IController& controller, IControllerFactory& factory) +232
   System.Web.Mvc.<>c__DisplayClass6.<BeginProcessRequest>b__2() +49
   System.Web.Mvc.<>c__DisplayClassb`1.<ProcessInApplicationTrust>b__a() +13
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
    System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Func`1 func) +124
   System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object state) +98
   System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback callback, Object state) +50
    System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData) +16
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8970356
    System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184 
```

如果有人能在这里指出我正确的方向，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T17:20:40.167

> 在那个 ServiceStack 认为它拥有我的解决方案，并接管所有请求，然后无法解析我的路线。

ServiceStack 不拥有任何你没有明确告诉它的东西。

> ServiceStack ControllerBuilder.Current.SetControllerFactory(new FunqControllerFactory(container));

这告诉 MVC 使用 ServiceStack 内置的 Funq IOC 来解析和自动连接**所有 MVC 控制器**。通常，如果您在同一个项目中同时运行 ServiceStack + MVC，您希望使用相同的 IOC 来解决 ServiceStack 服务和 MVC 控制器依赖关系。

如果您不希望 MVC 控制器使用 ServiceStack 的 IOC，请取消注释该行。

### 处理程序路径配置

在 Web.config 中，您还可以准确地告诉 ServiceStack[您希望 ServiceStack 处理什么路径](http://www.servicestack.net/ServiceStack.Hello/#rootpath)。

这是仅有的两个配置 ServiceStack 来处理请求的地方。如果您没有任何这些配置，那么 ServiceStack dll 是良性的，不会对您的项目产生任何影响。即没有注册的 HTTP 模块侵入性地尝试劫持请求。

这里唯一存在该问题的库是 MVC，它认为它拥有整个解决方案，即使在告诉 IIS 将所有`/api`请求委托给 ServiceStack（使用 Web.Config）之后，您还需要告诉 MVC 显式忽略这些路由：

```
routes.IgnoreRoute("api/{*pathInfo}"); 
```

否则它将尝试处理它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:06:48.677

看来您正在使用[Funq DI container](http://funq.codeplex.com/)。它试图找到你在 Funq 初始化期间没有创建的依赖项。在不知道 Funq 是如何工作的（以前从未听说过）或你的代码库是什么样子的情况下，这对我们目前来说是很有帮助的。

# matlab - 来自其他 .mat 文件的 matlab 函数输入？

> ID：11816241
> 
> 赞同：1
> 
> 时间：2012-08-05T12:01:55.517
> 
> 标签：matlab, functional-programming

我写了一个函数，它需要来自其他 .mat 文件的一些输入值，我真的不知道该怎么做，有人可以帮忙吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T14:24:19.987

该`load`函数记录在这里： http: [//www.mathworks.com/help/techdoc/ref/load.html](http://www.mathworks.com/help/techdoc/ref/load.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T14:10:56.013

只需在您的函数中加载这些 .mat 文件即可。

# java - 如何在我运行音乐应用程序时停止默认音乐播放器

> ID：11816242
> 
> 赞同：0
> 
> 时间：2012-08-05T12:02:01.460
> 
> 标签：java, android

我正在创建一个音乐播放器应用程序。

如果在后台运行默认音乐播放器，并且如果我使用我的应用程序播放音乐，则两者同时运行。

有没有办法停止背景音乐播放器。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T14:51:50.577

如果您的应用程序获得音频焦点，则应该会导致当前播放器停止。详细信息在[http://developer.android.com/training/managing-audio/audio-focus.html#RequestFocus](http://developer.android.com/training/managing-audio/audio-focus.html#RequestFocus)

还有很多其他的细节；您可能希望将自己注册为媒体按钮事件接收器，以便您的应用停止并开始播放。有关详细信息，请参阅[http://android-developers.blogspot.com.au/2010/06/allowing-applications-to-play-nicer.html](http://android-developers.blogspot.com.au/2010/06/allowing-applications-to-play-nicer.html)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-05T13:31:50.690

在您的应用程序（音乐播放器）
中您想访问另一个进程

通常
JVM 不会给你这个系统进程的权限

但是你可以通过使用那个技巧来做到这一点

1.  开发 (..exe) [by c OR c++ OR c#] 可以杀死任何正在运行的音乐播放器，因为这些语言可以处理系统进程
2.  在您的应用程序中调用此 exe 文件（运行它）

这就是诀窍

# facebook - 我朋友的实际位置

> ID：11816243
> 
> 赞同：0
> 
> 时间：2012-08-05T12:02:02.480
> 
> 标签：facebook, location, facebook-fql

我想创建一个包含我朋友最实际位置的列表。为此，我从签到中检索数据，`location_post`并且`photo_tag`。我意识到如果我的一个朋友上传一张带有位置信息的照片，我也需要查询照片表。

我还能从哪里获得位置信息？或者您能否建议一个`FQL`查询，将所有这些位置集中检索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:49:00.607

你可以使用 Graph API 来做到这一点。这是来自文档的描述以及工作示例

**来自文档：** 具有位置的对象。以下将返回有关附加了位置信息的对象的信息。根据您的应用程序获得的权限，结果中存在重要的行为差异。

> 要阅读带有位置信息的帖子，您需要： user_photos 或friends_photos 用于照片 user_status 或friends_status 用于帖子（不包括照片） user_checkins 或friends_checkins 仅用于签入（不包括所有其他类型的帖子）

**加载所有签到的工作 api 调用示例：**

```
https://graph.facebook.com/search?type=checkin&until=now&limit=50&access_token=valid_access_token 
```

# jquery - 多元素的移动 Safari 和 CSS 过渡滞后

> ID：11816244
> 
> 赞同：0
> 
> 时间：2012-08-05T12:02:15.340
> 
> 标签：jquery, css, mobile-safari, css-transitions

我有一个网站，我在其中执行多个`DIVs`图像背景的转换，从一个 CSS 类到另一个（使用 jQuery`addClass`和`removeClass`）。

```
.class1 {
  height: 30px;
  width: 50px;
  top: 30px;
  left: 10px;
}

.class2 {
  height: 50px;
  width: 70px;
  top: 50px;
  left: 80px;
}

.fade {
    -webkit-transition: opacity 0.6s linear, -webkit-transform 5s linear, width 5s linear, height 5s linear;
    -moz-transition: opacity 0.6s linear, background-size 5s linear;
    -ms-transition: opacity 0.6s linear, background-size 5s linear;
    -o-transition: opacity 0.6s linear, background-size 5s linear;
    transition: opacity 0.6s linear, background-size 5s linear;
    -webkit-backface-visibility: hidden;
} 
```

所有`DIVs`都用类初始化（当页面加载时）`fade`。

现在，在 Mobile Safari 上制作动画时`DIV`，一切正常。**但是，当同时**为多个元素设置动画时，Mobile Safari*会严重滞后*。显然，这在 Chrome 等常规浏览器上运行良好。

我尝试解决此问题的方法：

*   使用`translate3d`和`scale3d`CSS 属性
*   使用 jQuery 的`animate`
*   使用 jQueryUI 的`switchClass`
*   使用`IMG`标签而不是`DIV`背景图像

任何帮助都感激不尽，

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T12:03:47.983

好的，我已经设法找出导致此问题的原因：`fade`该类应用于主 DIV 中的许多内部 DIV，并且我只需要某些过渡效果，其中不包括此调整大小过渡（为此，我有另一个 CSS 类）。

所以，在应用过渡之前，我调用`removeClass('fade')`，当结束过渡时，我再次添加它。

# c - 使用 OpenCV 检测小圆圈（图像质量差）

> ID：11816245
> 
> 赞同：5
> 
> 时间：2012-08-05T12:02:37.660
> 
> 标签：c, opencv, computer-vision, feature-detection

我正在尝试检测您可以在这张图片的中心看到的四个点： ![在此处输入图像描述](../Images/41368bb41a5b5dba1c84144fbf416661.png) 这个被转换为 png，我实际上使用的是 ppm 格式（从相机的原始输出转换后）。实际处理的图像可[在此处获得](http://student.agh.edu.pl/~grajewsk/img-000012.ppm)

我是opencv的新手，因此在检测这些点时遇到了很大的问题。这是我迄今为止最好的结果： ![在此处输入图像描述](../Images/3b1cb75365237da33f9b3a04bd057a0e.png)

如您所见，我检测到了 3 个点，但除此之外，图片中的许多其他东西也被识别为圆圈。

这是代码：

```
 IplImage* img;
    if((img = cvLoadImage( "photos/img-000012.ppm", 1)) == 0 )
    {
        perror("cvLoadImage");
        return 1;
    }
    cvNamedWindow( "Image view", 1 );
    cvShowImage( "Image view", img );
//  cvWaitKey(0);

    IplImage* gray = cvCreateImage( cvGetSize(img), 8, 1 ); // allocate a 1 channel byte image
    CvMemStorage* storage = cvCreateMemStorage(0);
    cvCvtColor( img, gray, CV_BGR2GRAY );
    cvShowImage( "Image view", gray );
//  cvWaitKey(0);

    cvSmooth( gray, gray, CV_GAUSSIAN, 3, 3, 0, 0 );
    cvShowImage( "Image view", gray );
    cvWaitKey(0);

    CvSeq* circles = cvHoughCircles(gray, storage, CV_HOUGH_GRADIENT,
            4,      // inverse ratio of the accumulator resolution
            1,      // minimum distance between circle centres
            100,    // higher threshold value for Canny
            20,     // accumulator threshold for the circle centers; smaller->more false circles
            1,  // minimum radius
            10 );   // maximum radius

    printf("circles == %d\n", circles->total);
    int i;
    for (i = 0; i < circles->total; i++) {
        float *p = (float*)cvGetSeqElem(circles, i);
        CvPoint center = cvPoint(cvRound(p[0]),cvRound(p[1]));
        CvScalar val = cvGet2D(gray, center.y, center.x);
        if (val.val[0] < 1) continue;
        printf("%d %d %d\n", cvRound(p[0]),cvRound(p[1]), cvRound(p[2]));
        cvCircle(img,  center, cvRound(p[2]),             CV_RGB(0,255,0), 1, CV_AA, 0);
    }
    cvShowImage( "Image view", img );
    cvWaitKey(0); 
```

你知道如何帮助吗？我将不胜感激。我认为人眼很容易发现这些点，所以我希望我可以使用计算机检测它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:15:45.580

你应该看看[这篇文章](https://stackoverflow.com/questions/11631188/detect-clusters-of-circular-objects-by-iterative-adaptive-thresholding-and-shape)。

使用我基于它开发的应用程序，我得到：

![在此处输入图像描述](../Images/572dfa1b7770a50acb3437d270b6f6c9.png)

您基本上可以根据您的情况调整此方法并**使其更有效**：“5。” （“在授予其形状（大小，面积，凸度......”）时验证或使轮廓无效。**在您的情况下可能会更加严格，因为您没有圆圈簇**。您可以只映射几乎[完美的对象圈子](http://en.wikipedia.org/wiki/Isoperimetric_inequality#The_isoperimetric_inequality)。此外，您知道您的圈子具有相同的大小/相对强度...

有什么不清楚的请告诉我，

祝你好运，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:14:34.617

我认为霍夫变换不是最好的情况。可能您可以对它们进行分割，并使用它们的颜色和几何参数简单地识别。

# android - 安卓闹钟

> ID：11816248
> 
> 赞同：0
> 
> 时间：2012-08-05T12:03:26.697
> 
> 标签：android, clock, android-alarms

你好我有问题。

LogCat 给了我一些错误。

日志猫：

```
08-05 11:42:30.222: E/AndroidRuntime(623): FATAL EXCEPTION: main
08-05 11:42:30.222: E/AndroidRuntime(623): java.lang.NullPointerException
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.text.format.DateFormat.is24HourFormat(DateFormat.java:204)
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.alarmclock.Alarms.get24HourMode(Alarms.java:536)
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.alarmclock.DigitalClock.setDateFormat(DigitalClock.java:192)
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.alarmclock.DigitalClock.onFinishInflate(DigitalClock.java:121)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:631)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:626)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.alarmclock.AlarmClock$AlarmTimeAdapter.newView(AlarmClock.java:96)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.CursorAdapter.getView(CursorAdapter.java:182)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.AbsListView.obtainView(AbsListView.java:1430)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.ListView.measureHeightOfChildren(ListView.java:1216)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.ListView.onMeasure(ListView.java:1127)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.View.measure(View.java:8313)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1017)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.LinearLayout.measureVertical(LinearLayout.java:386)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.LinearLayout.onMeasure(LinearLayout.java:309)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.View.measure(View.java:8313)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.View.measure(View.java:8313)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.LinearLayout.measureVertical(LinearLayout.java:531)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.LinearLayout.onMeasure(LinearLayout.java:309)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.View.measure(View.java:8313)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.View.measure(View.java:8313)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.ViewRoot.performTraversals(ViewRoot.java:839)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1859)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.os.Looper.loop(Looper.java:123)
08-05 11:42:30.222: E/AndroidRuntime(623):  at android.app.ActivityThread.main(ActivityThread.java:3683)
08-05 11:42:30.222: E/AndroidRuntime(623):  at java.lang.reflect.Method.invokeNative(Native Method)
08-05 11:42:30.222: E/AndroidRuntime(623):  at java.lang.reflect.Method.invoke(Method.java:507)
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
08-05 11:42:30.222: E/AndroidRuntime(623):  at dalvik.system.NativeStart.main(Native Method) 
```

一点代码（有错误的地方）

日志猫：

```
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.alarmclock.Alarms.get24HourMode(Alarms.java:536)
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.alarmclock.DigitalClock.setDateFormat(DigitalClock.java:192)
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.alarmclock.DigitalClock.onFinishInflate(DigitalClock.java:121) 
```

代码：

```
static Calendar calculateAlarm(int hour, int minute, Alarm.DaysOfWeek daysOfWeek) {

    // start with now
Calendar c = Calendar.getInstance();
c.setTimeInMillis(System.currentTimeMillis());

int nowHour = c.get(Calendar.HOUR_OF_DAY);
int nowMinute = c.get(Calendar.MINUTE);

// if alarm is behind current time, advance one day
if (hour < nowHour  ||
    hour == nowHour && minute <= nowMinute) {
    c.add(Calendar.DAY_OF_YEAR, 1);
}
c.set(Calendar.HOUR_OF_DAY, hour);
c.set(Calendar.MINUTE, minute);
c.set(Calendar.SECOND, 0);
c.set(Calendar.MILLISECOND, 0);

int addDays = daysOfWeek.getNextAlarm(c);
/* Log.v("** TIMES * " + c.getTimeInMillis() + " hour " + hour +
   " minute " + minute + " dow " + c.get(Calendar.DAY_OF_WEEK) + " from now " +
   addDays); */
if (addDays > 0) c.add(Calendar.DAY_OF_WEEK, addDays);
    return c;
}

static String formatTime(final Context context, int hour, int minute,
                         Alarm.DaysOfWeek daysOfWeek) {
    Calendar c = calculateAlarm(hour, minute, daysOfWeek);
    return formatTime(context, c);
}

/* used by AlarmAlert */
static String formatTime(final Context context, Calendar c) {
    String format = get24HourMode(context) ? M24 : M12;
    return (c == null) ? "" : (String)DateFormat.format(format, c);
}

/**
 * Shows day and time -- used for lock screen
 */
private static String formatDayAndTime(final Context context, Calendar c) {
    String format = get24HourMode(context) ? DM24 : DM12;
    return (c == null) ? "" : (String)DateFormat.format(format, c);
}

/**
 * Save time of the next alarm, as a formatted string, into the system
 * settings so those who care can make use of it.
 */
static void saveNextAlarm(final Context context, String timeString) {
    Settings.System.putString(context.getContentResolver(),
                              Settings.System.NEXT_ALARM_FORMATTED,
                              timeString);
}

/**
 * @return true if clock is set to 24-hour mode
 */
static boolean get24HourMode(final Context context) {
    return android.text.format.DateFormat.is24HourFormat(context);
} 
```

下一个：

日志猫：

```
08-05 11:42:30.222: E/AndroidRuntime(623):  at com.android.alarmclock.AlarmClock$AlarmTimeAdapter.newView(AlarmClock.java:96) 
```

代码：

```
public View newView(Context context, Cursor cursor, ViewGroup parent) {
    View ret = mFactory.inflate(R.layout.alarm_time, parent, false);

    ((TextView) ret.findViewById(R.id.am)).setText(mAm);
    ((TextView) ret.findViewById(R.id.pm)).setText(mPm);

    DigitalClock digitalClock =
            (DigitalClock) ret.findViewById(R.id.digitalClock);
    digitalClock.setLive(false);
    return ret;
} 
```

项目：[https](https://github.com/android/platform_packages_apps_alarmclock) ://github.com/android/platform_packages_apps_alarmclock Apache 2.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T12:15:52.650

`mContext`在`DigitalClock.java`类中为空。您必须为其设置一个上下文。在你的课堂上添加这个：

```
mContext=context; 
```

关于第二个问题。您必须粘贴完整的日志。问题是什么？

# r - 使用 bca 非参数方法完成的最小引导次数是多少

> ID：11816251
> 
> 赞同：6
> 
> 时间：2012-08-05T12:04:09.943
> 
> 标签：r, statistics

我想将`boot()`and`boot.ci()`函数`library("boot")`用于非常大的数据集（~50 000）和`type="bca"`.

如果 R(number of bootstraps) 太小，会报错：

```
Error in bca.ci(boot.out, conf, index[1L], L = L, t = t.o, t0 = t0.o,  : 
  estimated adjustment 'a' is NA 
```

我也不希望它太大。

什么是 R 的好数字？我知道这取决于数据的大小。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-05T12:19:02.657

通常，置信区间比估计值需要更多的引导程序。自从过去十年计算能力增加以来，我听说过 1000 个引导估计和 10000 个置信区间的建议。

现在的`boot()`函数具有`parallel`可以在多个内核上运行引导程序的参数，如果您关心计算时间，您可能希望使用它来显着减少对您的大小数据集运行分析所需的时间。

# php - 升级版 smarty 模板引擎

> ID：11816255
> 
> 赞同：1
> 
> 时间：2012-08-05T12:04:31.053
> 
> 标签：php, smarty

我的旧版本`smarty`是 2.6.20 现在我需要将旧版本升级到新版本 3.1.1。`smarty`但在(3.1.1)的新版本中，我看到更改 libs 文件目录。我可以在不更改我的 php 代码的情况下切换到新版本吗？如何 ？

旧 smarty 目录：libs/

```
/internals/
/plugins/
Config_File.class.php
debug.tpl
Smarty.class.php
Smarty_Compiler.class.php 
```

新的 smarty 目录：libs/

```
/plugins/
/sysplugins/
Smarty.class.php
SmartyBC.class.php
debug.tpl 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T08:22:26.737

在不接触您的代码/模板的情况下进行升级是不太可能的。有关需要注意的事项列表，请阅读以下升级说明：

*   [Smarty 2 笔记](http://code.google.com/p/smarty-php/source/browse/trunk/distribution/SMARTY_2_BC_NOTES.txt)
*   [Smarty 3.0 笔记](http://code.google.com/p/smarty-php/source/browse/trunk/distribution/SMARTY_3.0_BC_NOTES.txt)
*   [Smarty 3.1 笔记](http://code.google.com/p/smarty-php/source/browse/trunk/distribution/SMARTY_3.1_NOTES.txt)

# orchardcms - Orchard cms 将当前小部件类型添加到自定义模块迁移

> ID：11816256
> 
> 赞同：0
> 
> 时间：2012-08-05T12:04:37.650
> 
> 标签：orchardcms

我敢肯定，这一定是以前问过的。但我一直找不到任何有用的东西。

我想创建一些小部件（现有的小部件类型、菜单、投影），作为自定义模块安装的一部分。还有一些查询和投影页面。

以及一个新菜单（orchard 1.5.1），我从设置模块中的代码中找出了菜单部分

...

```
 // create a project menu
    var projectMenu = _menuService.Create("new Menu");

    // assign the project items to all current menu items
    foreach (var menuItem in _menuService.Get().Where(x => x.ContentItem.ContentType == "Project"))
    {
        // if they don't have a position or a text, then they are not displayed
        if (string.IsNullOrWhiteSpace(menuItem.MenuPosition) || string.IsNullOrEmpty(menuItem.MenuText))
    {
       continue;
    }
    menuItem.Menu = projectMenu.ContentItem; 
```

我可以在迁移中包含一些东西来添加小部件和投影吗？

我一直在查看 Orchard Recipe 模块，并看到那里有用于执行命令以设置小部件的代码。但我不确定如何最好地利用这个......

创建配方实例管理和执行整个配方似乎有点复杂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T20:22:47.133

在您可以使用的所有地方都有一些非常有用的看似未记录的服务。

使用以下构造函数

```
public class MigrationProjectType : DataMigrationImpl 
    {
        private readonly IMenuService _menuService;
        private readonly IContentManager _contentManager;
        private readonly IQueryService _queryService;
        private readonly IWidgetsService _widgetsService;

        public MigrationProjectType(IMenuService menuService, IContentManager contentManager,  IQueryService queryService, IWidgetsService widgetsService)
        {
            _menuService = menuService;
            _contentManager = contentManager;
            _queryService = queryService;
            _widgetsService = widgetsService;
        }
...
} 
```

Auto fac 将负责实例化服务

然后

```
public int UpdateFrom2()
        {
            // create a project menu
            var projectMenu = _menuService.Create("Projects Menu");

            // assign the project items to all current menu items
            foreach (var menuItem in _menuService.Get().Where(x => x.ContentItem.ContentType == "Project"))
            {
                // if they don't have a position or a text, then they are not displayed
                if (string.IsNullOrWhiteSpace(menuItem.MenuPosition) || string.IsNullOrEmpty(menuItem.MenuText))
                {
                    continue;
                }
                menuItem.Menu = projectMenu.ContentItem;
            }

            // create layer part 
            _widgetsService.CreateLayer("SideBar", "desc", "url(\"~\")");

            var defaultLayer = _widgetsService.GetLayers().First(x => x.Name == "Default");

            var widget =  _widgetsService.CreateWidget(defaultLayer.Id, "MenuWidget", "Projects Menu", "2", "Navigation");

            var menuWidget = widget.As<MenuWidgetPart>();
            menuWidget.Record.Menu = projectMenu.ContentItem.Record;

            _contentManager.Publish(menuWidget.ContentItem);

            return 3;
        } 
```

查询有类似的服务，但我仍然不确定如何为查询添加过滤器，用于预测......

更新

继承人如何添加查询和过滤器

```
public int UpdateFrom7()
        {

            // create a project menu
            var projectMenu = _queryService.CreateQuery("My projects 3");

            var form = new Form { ContentTypes = "Project" };
            var xmlSerializer = new XmlSerializer(form.GetType());
            StringWriter sww = new StringWriter();
            XmlWriter writer = XmlWriter.Create(sww);
            xmlSerializer.Serialize(writer, form);
            var state = sww.ToString();

            projectMenu.FilterGroups[0].Filters.Add(new FilterRecord
            {
                Category = "Content",
                Description = "My filter",
                Position = 0,
                State = state,
                Type = "ContentTypes"
            });

            _contentManager.Publish(projectMenu.ContentItem);

            return 8;
        }

[Serializable]
    public class Form
    {
        public string Description { get; set; }
        public string ContentTypes { get; set; }

    } 
```

# wordpress - 使用 query_post() 时按类别归档不显示

> ID：11816259
> 
> 赞同：0
> 
> 时间：2012-08-05T12:04:55.933
> 
> 标签：wordpress

在我的 wordpress 主题中，我需要隐藏一个类别中的所有帖子，我正在使用此代码

```
<?php query_posts('cat=-307'); ?> 
<?php while ( have_posts() ) : the_post(); ?>
... 
```

它工作得很好，但是当我尝试查看特定类别的所有帖子时，例如类别/jquery，我不仅仅得到 jquery 帖子，但我又得到了所有帖子。

如果我删除上面代码的第一行，那么它会按预期工作。

我使用了样板主题，所以其余的代码不是问题。

如何通过保留`query_posts()`过滤器来解决此问题，但在需要时仅获取特定类别

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:25:31.870

我发现了问题。我只是使用 query_posts() 来在博客的主页上生效。所以我所做的只是，移除

```
<?php query_posts('cat=-307'); ?> 
```

从`loop.php`并将其添加到`index.php`

# java - GWT：在另一个小部件的 UI.xml 文件中使用“UIObject”

> ID：11816264
> 
> 赞同：3
> 
> 时间：2012-08-05T12:06:10.893
> 
> 标签：java, gwt

我已经定义了一个`UiBinder`名为*Header的小部件，仅在**Header.ui.xml*中带有 HTML 标记因此其相应的*Header.java*类扩展`UIObject`并包含`setElement(uiBinder.createAndBindUi(this))`在其构造函数中。这给出了一个`Element`对象。当附加到 时`RootPanel.geBodyElement()`，它运行良好。

**问题是：**

我想在另一个 UiBinder 小部件的声明性 ui.xml （类型`Composite`与 xml 中的 GWT Ui 元素）文件中使用它。当我在这里使用 xml 中的标题小部件时：

```
<g:HTMLPanel>
    <app:Header />
</g:HTMLPanel> 
```

GWT 给出错误： *[ERROR] Not allowed in an HTML context Element*

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T18:24:51.270

因为[HTMLPanel](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/HTMLPanel.html)只能包装原始 HTML 或 GWT 小部件。

# java - 为什么我们不能在 C++ 中的同一个类中声明一个类的对象，但在 Java 中是允许的？

> ID：11816266
> 
> 赞同：2
> 
> 时间：2012-08-05T12:06:21.100
> 
> 标签：java, c++

```
class A
{
    A a;//why can't we do this in C++ but it is allowed in Java?
}; 
```

使用这个[问题](https://stackoverflow.com/questions/4941629/why-cant-we-declare-object-of-a-class-inside-the-same-class)，我开始知道为什么它在 C++ 中是不允许的，但为什么在 java 中是允许的？根据编译时不知道内存大小的相同论点，Java 也不应该允许这样做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T12:09:31.353

在 Java 中，如果有`A a;`,`a`是对 class 对象的*引用*`A`。在 C++ 中，它不是一个引用，而是一个完整的对象。

因此，C++ 中生成的对象将是无限大的，这不是很实用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-05T12:16:49.147

在 C++ 中，您可以这样做：

```
class A {
    A *a;
} 
```

这就是您实现许多数据结构的方式，包括链表。

正如您所提到的，您不能在 C++ 中执行此操作：

```
class A {
    A a;
} 
```

你不能在 C++ 中这样做有几个原因：不仅因为它不知道`A`（正如你提到的）的内存大小，还因为这意味着每个`A`人都会有一个类型的成员，`A`该成员将永远递归.

因此，Java 允许与上面的第一个示例等效：

```
class A {
    A a;
} 
```

碰巧这个**语法** *看起来*和 C++ 语法的第二个例子一样，但实际上，它和第一个 C++ 例子的**意思是**一样的： 类`A`有一个类型为“指针”（C++）或“引用”的成员变量(Java) 到 class 的对象`A`。

第二种 C++ 语法没有等效的 Java 语法，因为在 Java 中，一个类的所有实例（即非基元）总是引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-05T12:10:08.303

在 Java 中，这

```
 A a; 
```

表示 A 是对`A`对象的引用。所以类`A`不包含`A`实例，就像在 C++ 中那样（这将是无限递归的，因此是不允许的）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T12:11:44.370

`A a;`在中创建引用，`Java`但不在 中创建引用`C++`。

在一个对象中拥有同一对象的实例是不可能的。

# c++ - 在 C++ 中读\写结构化二进制文件

> ID：11816268
> 
> 赞同：0
> 
> 时间：2012-08-05T12:06:29.990
> 
> 标签：c++, visual-studio-2010, io, binaryfiles

我想读\写一个具有以下结构的二进制文件：

![在此处输入图像描述](../Images/99916327842e4cbca1988ebec5085863.png)

该文件由“记录”组成。每个“记录”具有以下结构：我将以第一条记录为例

*   （红色）起始字节：0x5A（始终为 1 字节，固定值 0x5A）
*   （绿色）LENGTH 字节：0x00 0x16（总是 2 字节，值可以从“0x00 0x02”变为“0xFF 0xFF”）
*   （蓝色） CONTENT：由 LENGTH 字段的十进制值减去 2 表示的字节数。

在这种情况下，LENGHT 字段值为 22（0x00 0x16 转换为十进制），因此 CONTENT 将包含 20 (22 - 2) 个字节。我的目标是逐条读取每条记录，并将其写入输出文件。实际上我有一个读函数和写函数（一些伪代码）：

```
private void Read(BinaryReader binaryReader, BinaryWriter binaryWriter)
{
    byte START = 0x5A;
    int decimalLenght = 0;
    byte[] content = null;
    byte[] length = new byte[2];

    while (binaryReader.PeekChar() != -1)
    {
        //Check the first byte which should be equals to 0x5A
        if (binaryReader.ReadByte() != START)
        {
            throw new Exception("0x5A Expected");
        }

        //Extract the length field value
        length = binaryReader.ReadBytes(2);

        //Convert the length field to decimal
        int decimalLenght = GetLength(length);

        //Extract the content field value
        content = binaryReader.ReadBytes(decimalLenght - 2);

        //DO WORK
        //modifying the content

        //Writing the record
        Write(binaryWriter, content, length, START);
    }
}

private void Write(BinaryWriter binaryWriter, byte[] content, byte[] length, byte START)
{
    binaryWriter.Write(START);
    binaryWriter.Write(length);
    binaryWriter.Write(content);   
} 
```

如您所见，我已经为 C# 编写了它，但我真的不知道如何使用 C++ 编写它。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:12:36.557

您需要使用并以[二进制模式](http://en.cppreference.com/w/cpp/io/ios_base/openmode)( )[`std::ifstream`](http://en.cppreference.com/w/cpp/io/basic_ifstream)打开文件。`std::ios_base::binary`

[`peek`](http://en.cppreference.com/w/cpp/io/basic_istream/peek)非常相似，但如果无法提取字符则返回`eof`而不是返回。`-1`并且[`read`](http://en.cppreference.com/w/cpp/io/basic_istream/read)将使您能够将给定数量的字节读入一个值。请注意，您熟悉的某些类型 ( `byte`, `type[]`) 在 C++ 中不存在或工作方式不同。您可以使用`std::vector`后者，但您需要`byte`自己定义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T14:37:20.303

我想我会按这个顺序做点什么：

```
struct record { 
    static const int start = '\x5a';
    std::vector<char> data; // you might prefer unsigned char.
};

std::istream &operator>>(std::istream &is, record &r) { 
    char ch;
    short len;

    is.get(ch);
    verify(ch == record::start);
    is.read((char *)&len, sizeof(len));
    r.data.resize(len);
    is.read(&r.data[0], len);
    return is;
}

std::ostream &operator<<(std::ostream &os, record const &r) { 
    os << record::start;
    short len = (short)r.data.size();
    os.write((char *)&len, sizeof(len));
    os.write(&r.data[0], len);
    return os;
} 
```

要处理一个记录文件，就像你在你的`Read`（读取、处理和写入数据的东西的名字不好，顺便说一句）中显示的那样，让我们​​首先定义一个函子来处理文件中的单个记录：

```
class process_record { 
    record operator()(record r) { 
        // code to process a single record goes here
        // it will take one record as input, and return the processed record.
    }
} 
```

然后，要处理文件，我们将使用如下代码：

```
std::transform(std::istream_iterator<record>(infile),
               std::istream_iterator<record>(),
               std::ostream_iterator<record>(outfile, ""),
               process_record()); 
```

[注意：为了简洁起见，我在这里使用了 C 风格的强制转换，但在实际代码中我可能会使用`static_cast`s 代替。]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T07:50:32.177

谢谢你，这是我能够开发的解决方案：

```
// TestCPP003.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"

#include "boost\program_options.hpp"
namespace po = boost::program_options;

#include "Util.h"

using namespace std;

int main(int argc, char* argv[])
{
    po::options_description desc("Allowed options");

    desc.add_options()
        ("h", "produce help message")
        ("i", po::value<string>(), "input file")
        ("o", po::value<string>(), "output file");

    po::variables_map vm;
    po::store(po::parse_command_line(argc, argv, desc), vm);

    if (vm.count("h"))
    {
        cout << desc << endl;
        return 0;
    }

    po::notify(vm);

    if (vm.count("i"))
    {
        cout << vm["i"].as<string>() << "\n";
    }

    string sInputFile = vm["i"].as<string>();

    if (fileExists(sInputFile.c_str()))
    {
        cout << "file exists: <" <<  sInputFile << ">" << endl;
    }
    else
    {
        cout << "file not exists: <" <<  sInputFile << ">" << endl;
        cout << "RETURN CODE: 8" << endl;
        return 8;
    }

    string sOutputFile = vm["o"].as<string>();

    static const int START_BYTE = '\x5a';
    static const int AFP_RECORD_HEADER_SIZE = 1;
    static const int AFP_RECORD_LENGTH_SIZE = 2;    
    char * afpHeaderBlock = new char[1];
    char * afpLengthBlock;
    unsigned int afpRecordLength = 0;
    char * afpContentBlock;

    ifstream inputStream(sInputFile, ios::in|ios::binary);
    ofstream outputStream(sOutputFile, ios::out|ios::binary);

    if (inputStream.is_open() && outputStream.is_open())
    {
        while (inputStream.read(afpHeaderBlock, AFP_RECORD_HEADER_SIZE)) 
        {           
            //cout << ToHex(string(afpHeaderBlock, AFP_RECORD_HEADER_SIZE), true) << endl;

            if (START_BYTE == afpHeaderBlock[0])
            {
                cout << "0x5A Found!" << endl;
            }
            else
            {
                cout << "0x5A not Found! - AFP Error" << endl;
            }

            outputStream.write(afpHeaderBlock,  AFP_RECORD_HEADER_SIZE);

            afpLengthBlock = new char[AFP_RECORD_LENGTH_SIZE];
            afpRecordLength = 0;

            inputStream.read(afpLengthBlock, AFP_RECORD_LENGTH_SIZE);

            //cout << ToHex(string(afpLengthBlock, AFP_RECORD_LENGTH_SIZE), true) << endl;

            afpRecordLength = (afpRecordLength << 8) + static_cast<const unsigned char&>(afpLengthBlock[0]);
            afpRecordLength = (afpRecordLength << 8) + static_cast<const unsigned char&>(afpLengthBlock[1]);

            //cout << "AFP Record Length: " << afpRecordLength << endl;

            outputStream.write(afpLengthBlock,  AFP_RECORD_LENGTH_SIZE);

            afpContentBlock = new char[afpRecordLength - AFP_RECORD_LENGTH_SIZE];

            inputStream.read (afpContentBlock, afpRecordLength - AFP_RECORD_LENGTH_SIZE);

            outputStream.write(afpContentBlock,  afpRecordLength - AFP_RECORD_LENGTH_SIZE);
        }

        inputStream.close();
        outputStream.flush();
        outputStream.close();
    }

    cout << "RETURN CODE: 0" << endl;
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T20:38:55.200

好的，根据您的回答，我做了一些实验：

```
string sFile = "C:\Test.bin";
static const int START_BYTE = '\x5a';
char tempByte;

ifstream inputFile (sFile, ios::in);
inputFile.open( sFile, ios::binary );

while (!inputFile.eof()) 
{
    inputFile.get(temptByte);

    cout << "Value of Byte " << hex << static_cast<int>(tempByte) << " hexadecimal" << endl;
} 
```

但是，输出始终显示为：ffffffcc，或者如果未转换为 -52。

如果我做对了，我的代码应该一次读取一个字节的文件，并打印出字节十六进制值。我错了吗 ？

# qt4 - QTableWidget.cellActivated() 信号不起作用？

> ID：11816272
> 
> 赞同：1
> 
> 时间：2012-08-05T12:06:56.900
> 
> 标签：qt4, signals, pyqt4, qtablewidget

我尝试使用 PyQt4 重新实现 QTableWidget.cellActivated(row, number)，以捕获当前活动单元格的坐标。下面的示例未按预期工作，单击单元格时未激活该方法。我做错了什么吗？

```
class DictionaryTable(QtGui.QTableWidget):

    def __init__(self, parent=None):
        QtGui.QTableWidget.__init__(self, parent)

    def cellActivated(self, row, column):
        print row, column 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T14:15:05.973

查看[文档](http://doc.qt.nokia.com/4.7-snapshot/qtablewidget.html#cellActivated)，我看到：

> **void QTableWidget::cellActivated ( int row, int column ) [信号]**
> 
> 当由行和列指定的单元格被激活时会发出此信号 此功能是在 Qt 4.1 中引入的。

这是一个信号，而不是一个事件。所以你不需要[重新]实现`cellActivated`方法（它不是方法，它是信号类型的类属性）。您需要连接到信号：

```
class DictionaryTable(QtGui.QTableWidget):

    def __init__(self, language_code, parent=None):
        QtGui.QTableWidget.__init__(self, parent)
        self.cellActivated.connect(self.handleCellActivated)

    def handleCellActivated(self, row, column):
        print row, column 
```

# android - 填充不起作用Android

> ID：11816274
> 
> 赞同：8
> 
> 时间：2012-08-05T12:07:40.177
> 
> 标签：android, xml, layout

以下代码来自我为我的应用程序设计的布局。问题是，Button 与纯文本框重叠，因此我在按钮代码中添加了填充，如下所示，但预览仍显示 Button 与文本框重叠。什么是问题？我错过了什么吗？

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:weightSum="100"
android:padding="25dp" >

<ScrollView 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="30"
>

<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
>
<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<EditText
    android:id="@+id/editText1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" >

    <requestFocus />
</EditText>

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<EditText
    android:id="@+id/editText2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<EditText
    android:id="@+id/editText3"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<EditText
    android:id="@+id/editText4"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<EditText
    android:id="@+id/editText5"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView6"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<EditText
    android:id="@+id/editText6"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />
</LinearLayout>
</ScrollView>

<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:layout_weight="40">
<Button
    android:id="@+id/button1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:paddingTop="20dp"
    android:text="Button" />
</LinearLayout>

<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="30"
    android:orientation="vertical">
<AnalogClock
    android:id="@+id/analogClock1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />
</LinearLayout> 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-05T12:15:35.430

看来你想分开两个视图。您应该在您的视图中使用边距而不是填充。

```
android:layout_marginLeft="10dp" 
```

您可以根据需要在左、右、上、下设置边距。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:41:56.913

您也可以使用 Space，但它仅适用于 4.0 及更高版本。

```
 <Space
        android:layout_width="match_parent"
        android:layout_height="24dp" /> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-09T11:29:46.750

如果您为每个项目采用单独的线性布局并放置填充，那会更好。

```
<LinearLayout>
    <ScrollView>
    <LinearLayout>
        <LinearLayout>
            <TextView>
            <EditText>
        </LinearLayout>
        <LinearLayout>
            <TextView>
            <EditText>
        </LinearLayout>
        <LinearLayout>
            <TextView>
            <EditText>
        </LinearLayout>
    </LinearLayout>
     </ScrollView>
     <LinearLayout>
        <Button>
     </LinearLayout>
     <LinearLayout>
        <AnalogClock>
     </LinearLayout>
</LinearLayout> 
```

# javascript - 扩展 jQuery 以制作我创建的占位符

> ID：11816276
> 
> 赞同：0
> 
> 时间：2012-08-05T12:07:50.283
> 
> 标签：javascript, jquery, html, css

我在一个`<input>`字段周围创建了一个占位符：

HTML：

```
 <div style="position: relative;font-size: 20px;">
     <input type="text" name="username" id="lgip" style="width: 100%"  class="lgip"    value="<?php echo $username ?>" onkeyup="perform(this.value,'plcun')"/>
     <div class="placer" style="padding: 5px" onclick="$('#lgip').focus()" id="plcun">Enter UserName or Email Address</div>
 </div> 
```

JavaScript：

```
function perform(val,hid){
    if(val=="") {
        $("#"+hid).show();
    } else{
        $("#"+hid).hide();
    }
} 
```

CSS：

```
input.lgip{ padding: 5px;font-size: 20px;border: 1px solid #2B4EA2 }
div.placer{ position: absolute;z-index: 5;top: 0px;left: 0px;background: transparent;width: 100%;color: #cccccc;white-space: nowrap;padding: 2px;padding-left: 4px } 
```

目前，这需要我在其`<div>`周围添加一个外层，在其下方添加`<input>`另一个`<div>`。

我想扩展 jQuery，以便它可以为任何`input:text`and制作一个占位符`textarea`，这样当我使用类似的东西时，`$("#lgip").makePlacer("Enter Username Or Email");`它就会像我创建的那样制作一个占位符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T15:39:24.130

编写 jQuery 插件其实很简单。基本上，您只需将插件功能添加到`jQuery.fn`对象。在插件中，您可以创建所需的 HTML 元素并将它们添加到 DOM。

```
(function($){
    $.fn.makePlacer = function(text){
        this.each(function(){
            var e = $(this);
            if (e.is("input[type='text'], textarea")) {
                var wrapper = $("<div/>").css({position: "relative", fontSize: 20});
                var placer = $("<div/>").html(text != undefined ? text : "").css({padding: 5}).addClass("placer").click(function(){
                    e.focus();
                });
                e.wrap(wrapper);
                e.after(placer);
                e.keyup(function(){
                    e.val().length ? e.next().hide() : e.next().show();
                });
            }
        });
    };
})(jQuery);

$("#lgip").makePlacer("Enter Username Or Email"); 
```

JSFiddle：http: [//jsfiddle.net/QQdfQ/1/](http://jsfiddle.net/QQdfQ/1/)

# ios - 为什么 AnnotationView didChangeDragState 调用了很多次？

> ID：11816277
> 
> 赞同：0
> 
> 时间：2012-08-05T12:08:07.453
> 
> 标签：ios, xcode, android-mapview

我是 iOS 新手。我使用了这个答案中的代码：[https ://stackoverflow.com/a/3999583/1572234](https://stackoverflow.com/a/3999583/1572234)

```
- (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)annotationView 
didChangeDragState:(MKAnnotationViewDragState)newState 
fromOldState:(MKAnnotationViewDragState)oldState 
{
if (newState == MKAnnotationViewDragStateEnding)
   {
    NSLog(@"didChangeDragState");
   }
}

- (void) mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)annotationView
{
if ([[annotationView.annotation title] isEqualToString:@"2nd"]||[[annotationView.annotation title] isEqualToString:@"3rd"])
   {
    NSLog(@"didSelectAnnotationView");
   }
} 
```

但是在我尝试拖动 pin 三次之后，我在调试区域看到了这个：

```
 2012-08-05 14:47:06.962 TestApp[1692:11603] didSelectAnnotationView
 2012-08-05 14:47:11.825 TestApp[1692:11603] didChangeDragState
 2012-08-05 14:47:16.269 TestApp[1692:11603] didSelectAnnotationView
 2012-08-05 14:47:20.205 TestApp[1692:11603] didChangeDragState
 2012-08-05 14:47:20.207 TestApp[1692:11603] didChangeDragState
 2012-08-05 14:47:24.033 TestApp[1692:11603] didSelectAnnotationView
 2012-08-05 14:47:26.811 TestApp[1692:11603] didChangeDragState
 2012-08-05 14:47:26.814 TestApp[1692:11603] didChangeDragState
 2012-08-05 14:47:26.816 TestApp[1692:11603] didChangeDragState 
```

我只需要一次调用 NSLog(@"didChangeDragState")，每次我拖动 pin 时，我错过了什么？帮助请。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T09:17:09.317

这是ios中的一个老错误。一年多前我向苹果报告了这一点，但他们说他们无法重现它......我添加了自己的修复：

```
 if (newState == MKAnnotationViewDragStateEnding)
{
    CLLocationCoordinate2D droppedAt = annotationView.annotation.coordinate;
    //drmap1 and drmap2 initialized to 0 before

    double d1=drmap1-droppedAt.latitude;
    double d2=drmap2-droppedAt.longitude;
    if(d1<0.000001&&d1>=-0.000001&&d2<0.000001&&d2>=-0.000001) return; //V1.2a fix a bug in ios

    drmap1=droppedAt.latitude;
    drmap2=droppedAt.longitude; 
```

# javascript - codeigniter：最后一个文本字段中的值重复或没有从文本字段中获取值

> ID：11816278
> 
> 赞同：0
> 
> 时间：2012-08-05T12:08:25.790
> 
> 标签：javascript, codeigniter

我选择 2 个文本字段并在第一个文本字段上输入“alpha”，在“beta”上输入第二个。当我在下一页显示它时，它只显示第二个值，即“beta”。我的代码有什么问题？我已经 foreach 了保存数据的变量。

这是形式的视图。(脚本)

```
 <script type="text/javascript">

        $(document).ready(function() {  

        $('#bookinfo_adult').change(function(){

            var num = $('#bookinfo_adult').val();                  

            var i = 0; 
            var html = ''; 

            for (i=1;i<=num;i++) {

                html += 'Adult ' + i + ': <input type="text" name="passenger-' + i + '"/><br/>'; 
            }

            $('#List').html(html);
        });
    }); 
</script> 
```

这是表格

```
 Adult:      
    <select id="bookinfo_adult" name="bookinfo_adult">
    <option value="0">- SELECT -</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
    </select>
    <div id="List"></div> 
```

这是控制器

```
for ($i=1;$i<=$data['num'];$i++) {
                //concatinate number of fields to a variable
                $name=array();
                $name=$this->input->post('passenger-'.$i);
                $value=array();
                $value='val'.$i;
                $data['bookinfo_passengers']=array();
                $data['bookinfo_passengers']=array($value=>$name);
            } 
```

这是我的显示视图上的内容

```
 for($a=1;$a<=$num;$a++){
    foreach($bookinfo_passengers as $value=>$name)
    {
        echo $value.'='.$name;
    }     
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T15:04:46.243

您将在每个循环中重新启动阵列，并用新数据覆盖旧数据：

```
for ($i=1;$i<=$data['num'];$i++) {
            //concatinate number of fields to a variable
            $name=array();
            $name=$this->input->post('passenger-'.$i);
            $value=array();
            $value='val'.$i;
            $data['bookinfo_passengers']=array(); ---> **put this outside of the loop**
            $data['bookinfo_passengers']=array($value=>$name); ---> this will override the previous data.
        } 
```

试试这个：

```
 $data['bookinfo_passengers']=array();
 $tmp = array();
 for ($i=1;$i<=$data['num'];$i++) {
            //concatinate number of fields to a variable
            $name=array();
            $name=$this->input->post('passenger-'.$i);
            $value=array();
            $value='val'.$i;
            $tmp[$value] = $name;
        }

 $data['bookinfo_passengers']=$tmp; 
```

然后像这样使用它：

```
foreach($data['bookinfo_passengers'] as $value=>$name)
    {
        echo $value.'='.$name;
    } 
```

# c# - 检查两个文件名是否引用同一个文件

> ID：11816279
> 
> 赞同：2
> 
> 时间：2012-08-05T12:08:26.330
> 
> 标签：c#, file, c#-4.0, io

C# (4.0) 中有没有办法检查两个文件名是否引用同一个文件，最好不打开它们？

即 d:\x.txt 应该等于 x.txt 或 ../x.txt 如果相对路径指向 d。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T12:12:36.990

如果您同时使用[`Path.GetFullPath`](http://msdn.microsoft.com/en-us/library/system.io.path.getfullpath.aspx)这两个名称，它们应该解析为相同的字符串：

```
string fullPath1 = Path.GetFullPath(absolutePath);
string fullPath2 = Path.GetFullPath(relativePath); 
```

如果它们引用相同的文件，则`fullPath1`应该相等。`fullPath2`确保进行不区分大小写的比较，因为 Windows 文件名不区分大小写。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-05T12:12:36.133

也许这对你有用？

```
FileInfo file1 = new FileInfo(@"D:\x.txt");
FileInfo file2 = new FileInfo(@"..\x.txt");

if (file1.FullName == file2.FullName) {
    // yes, they match.. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-21T12:10:03.177

是的，使用`Path.GetFullPath`然后不区分大小写的比较：

```
var file1 = Path.GetFullPath(@"C:\TEMP\A.TXT");
var file2 = Path.GetFullPath(@"a.txt"); // Assuming current directory is C:\TEMP

// Test 1 (good)
if (file1.Equals(file2, StringComparison.OrdinalIgnoreCase))
{
   Console.WriteLine("Test 1: they match");
}

// Test 2 (fails when file paths differ by case)
if (file1 == file2)
{
    Console.WriteLine("Test 2: they match");
} 
```

大多数人在不区分大小写的文件系统上运行 .NET，因此使用`==`运算符比较仅按大小写不同的路径不会产生所需的结果。

# objective-c - 移动物体撞到框架时如何停止？

> ID：11816280
> 
> 赞同：0
> 
> 时间：2012-08-05T12:08:33.000
> 
> 标签：objective-c, ios, cocoa-touch, touchesmoved

我正在做一个简单的游戏，用户可以将其中一个瓶子扔到顶部的状态栏上并打破它。我正在使用 touchesMoved 来测试用户是否抓住了一个瓶子（UIView），它会响应用户的手指轻弹方向而被抛出。对于投掷部分，它可以工作，但如果它抛出框架，我希望它被打破并变成一个破碎的瓶子png，这部分让人头疼。以下是部分代码：

```
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{

UITouch *aTouch = [touches anyObject];
CGPoint location = [aTouch locationInView:self.view];

throwView = [self.view hitTest:location withEvent:nil];

//if the movement not on self.view, it's on the bottle.
if (bottleView != self.view) {
CGPoint loc = [aTouch locationInView:self.bottleView];
CGPoint prevloc = [aTouch previousLocationInView:self.bottleView];

//getting the finger moment
myFrame = self.bottleView.frame;
deltaX = loc.x - prevloc.x;
deltaY = loc.y - prevloc.y;

myLocation = bottleView.center;

//Here I try to multiply the finger movement to throw the bottles
[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:.5];
[UIView setAnimationCurve:UIViewAnimationCurveEaseOut];

myFrame.origin.x += deltaX*7.0;
myFrame.origin.y += deltaY*7.0; 
[self.bottleView setFrame:myFrame];
[bottleView setNeedsDisplay];
[UIView commitAnimations];

//if it hits the top of the frame..
    if (myFrame.origin.y <=20){
        [self hitTheTop];
    }
}}

   //this part gives me headache, I repeat the code again otherwise the bottle is broken before hitting the top.

-(void) hitTheTop{
[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:.5];
[UIView setAnimationCurve:UIViewAnimationCurveEaseOut];

myFrame.origin.x += deltaX*7.0;
myFrame.origin.y += deltaY*7.0; 
[self.bottleView setFrame:myFrame];
[bottleView setNeedsDisplay];
[UIView commitAnimations];

//I calculate the slope and find where x should be when y is 0, 40 is half width of the bottle
myFrame.origin.x = myLocation.x + (myLocation.y / (-deltaY / deltaX)) - 40;
myFrame.origin.y = 0;

UIImageView *bottleBroken=
[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"broken.png"]];
[bottleBroken setFrame:CGRectMake(-20, -30, 130, 180)];
[self.bottleView setFrame:myFrame];
[bottleView addSubview:bottleBroken];   
} 
```

现在，我得到的是首先瓶子飞出框架，很短的时间，它又出现在框架的边缘并且已经破碎，看起来真的很不自然。实际上，我正在考虑将其设置为显示投掷的计时器，它可能会管理得更好。但我只是想探索是否有更简单的方法可以在没有计时器的情况下做到这一点，谢谢任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:33:17.233

以下是我在游戏中进行碰撞检测的方法。

```
NSMutableArray *collidees = [NSMutableArray arrayWithArray:[[GRSceneController sharedSceneController] sceneObjects]]; 

[collidees removeObject:self];

NSMutableArray *collisions = [[NSMutableArray alloc] init];

position.y += speed.y;

for (GRBlock *obj in collidees) {
    if ([self.collider doesCollideWithCollider:obj.collider])
        [collisions addObject:obj];
}

if ([collisions count]) {
    [(GRSceneObject<GRColliderDelegate> *)self didCollideWith:collisions collisionType:kVerticalCollision];
}

[collisions removeAllObjects]; 
```

然后我只是重复同样的事情`position.x`

该`doesCollideWithCollider:`方法看起来像这样

```
-(BOOL)doesCollideWithCollider:(GRColliderObject *)aCollider {

    #if defined DEBUG_COLLIDER && defined LOG
    logRect(hitBox);
    logRect(aCollider.hitBox);
    #endif

    CGRect colliderBox = aCollider.hitBox;

    return CGRectIntersectsRect(hitBox, colliderBox);
} 
```

`hitBox`只是一个围绕对象并充当碰撞器并`didCollideWith:collisionType:`处理碰撞的盒子。

主要的一点是你应该有一个速度变量并`position.y += speed.y`创建某种速度。并检查更新后的垂直碰撞和更新后`position.y`的水平碰撞`position.x`

# android - Android从另一个活动打开AlertDialog

> ID：11816281
> 
> 赞同：0
> 
> 时间：2012-08-05T12:08:41.733
> 
> 标签：android, android-activity, android-alertdialog

我在此处和其他网站上阅读了相互冲突的报告，这些报告说它是/不可能显示来自另一个活动的警报对话框。我正在尝试这样做：

```
public class Options extends Activity {

    /** Include classes */
    SharedPreferences sharedPrefs;
    Preferences prefs;
    Location loc;
    LocationSQL locSQL;
    NetworkConnection netConnect;

    /** Declare buttons */
    Button bLocation;
    Button bRefresh;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.options);

        sharedPrefs = PreferenceManager.getDefaultSharedPreferences(Options.this);

        /** Set the location for the user */
        setLocationPref();

        /** Refresh selection */
        bRefresh = (Button) findViewById(R.id.bRefresh);
        bRefresh.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
        loc = new Location(getApplicationContext());
            try{

                loc.locationSelection();
            }catch (Exception e){
                Log.d("ERROR", "Catch " + e);
            }
            }
        });

        /** Location selection */
        bLocation = (Button) findViewById(R.id.bLocation);
        bLocation.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {

            }
        });
    }
} 
```

然后我想做一些处理，如果需要调用一个 AlertDialog 框。但我得到下面的错误。我知道如果我是正确的，我正在使用已被破坏的上下文？但我想不出如何解决这个问题？

```
public class Location {

    private static final String Context = null;
    NetworkConnection nc;
    SharedPreferences getSharedPrefs;
    SharedPreferences putSharedPrefs;
    NetworkConnection netConnect;
    Options opts;
    Context context;

    public Location (Context arg)
    {
        context = arg;
    }

    public void locationSelection(){

        message();

    }

    public void message(){

        AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(context);
        alertDialogBuilder.setTitle("Your Title");
        AlertDialog alertDialog = alertDialogBuilder.create();
        alertDialog.show();

    }

} 
```

捕获 android.view.WindowManager$BadTokenException: Unable to add window -- token null 不适用于应用程序。

非常感谢您的帮助 ：-）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T12:32:04.547

不要将 getApplicationContext() 传递给您的 Location 构造函数，而是尝试传递 YourClass.this（这里是 Options.this）。

另外，这行代码是什么？

```
private static final String Context = null; 
```

# facebook-like - 如何从 Facebook“我喜欢”插件中删除 DIV？

> ID：11816282
> 
> 赞同：-1
> 
> 时间：2012-08-05T12:09:17.510
> 
> 标签：facebook-like

是否可以从 Facebook“我喜欢”插件中删除头部 DIV（包含名称、ico 和我喜欢）？我只想在我们的网页上有干净的“facebook 故事流”。

非常感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T12:13:43.180

是的，像平常一样嵌入代码，然后把它放进去

```
<div class="fb-like-box" data-href="http://www.facebook.com/platform" data-width="292" data-show-faces="false" data-stream="true" data-header="false"></div> 
```

编辑***显然是宽度，将其更改为您需要的任何值

# c++ - pthread_cond_wait：随机分段错误

> ID：11816284
> 
> 赞同：1
> 
> 时间：2012-08-05T12:09:36.023
> 
> 标签：c++, c, pthreads

## 更新 3

最近，我注意到我的代码随机导致*分段错误*错误。但我认为到目前为止我的代码非常简单，我无法弄清楚该错误来自哪里。由于它是随机发生的，我假设存在某种竞争条件。我认为这是所有可能相关的代码，如果您需要更多，请告诉我：

```
namespace thread {
    pthread_t terminated_thread_id, /* and others */;
    pthread_mutex_t terminate_thread = PTHREAD_MUTEX_INITIALIZER;
    pthread_cond_t terminate_thread_signal = PTHREAD_COND_INITIALIZER;
    int total_thread_count = 0;
    int termination; // + sembufs

    inline void* Exit(void* value) {
    //  This must be unlocked after all join-related jobs are done
        semop(thread::termination, thread::termination_in_process, 2)
            pthread_mutex_lock(&thread::terminate_thread);
                thread::terminated_thread_id = pthread_self();
                pthread_cond_signal(&thread::terminate_thread_signal);
            pthread_mutex_unlock(&thread::terminate_thread);

        pthread_exit(value);
        return value;
    }
}
int main(int argc, const char** argv){
...
    pthread_mutex_lock(&thread::terminate_thread);
    if(0 != pthread_create(&thread::communication_handler_thread_id, NULL,    \
                           CommunicationHandler, NULL)){
        global::PrintDebug("pthread_create() failed", __FILE__, __LINE__);
    }
    /** 2 more pthread_create()-calls */       
    do{
        thread::terminated_thread_id = pthread_self();
        pthread_cond_wait(&thread::terminate_thread_signal,                   \
                          &thread::terminate_thread);
        if(!pthread_equal(thread::terminated_thread_id, pthread_self())){
            pthread_join(thread::terminated_thread_id, NULL);
    ...
            semop(thread::termination, thread::termination_done, 1)
        }
    }while(thread::total_thread_count > 0);

    pthread_mutex_unlock(&thread::terminate_thread);
    return 0;
} 
```

信号**terminate_thread_signal**仅在**thread::Exit()**函数中发出。该函数也仅在用于创建线程的函数结束时调用。

这是调试器为调用堆栈显示的内容：

```
#0 (    0xb7fe2424 in __kernel_vsyscall() (??:??)
#1 0xb7fbdfcf   __pthread_cond_wait(cond=0x80539c0, mutex=0x8053998) (pthread_cond_wait.c:153)
#2 0x804a094    main(argc=1, argv=0xbffff9c4) (/home/papergay/SeekYourCar/0.2/Server/main.cpp:121) 
```

我已经知道的是，如果发生错误，那么还没有线程调用 thread::Exit()。我还使用了一个未命名的命名空间和一些初始化（如果可能相关的话）。我使用 Code::Blocks 作为 IDE 和 GCC 作为编译器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:45:45.613

`pthread_cond_wait()`允许虚假唤醒，因此您必须在每次唤醒后重新测试条件本身。这可能会导致您的问题 - 如果主线程在设置之前被虚假唤醒`thread::terminated_thread_id`，它会将无效的线程 id 传递给`pthread_join()`.

您的代码中还有另一个问题 - 无法保证在互斥锁解锁后发出信号的线程将是下一个唤醒的线程，因此两个线程可以`thread::Exit()`快速连续调用，而主线程直到第二个之后才运行退出线程已解锁互斥锁。在这种情况下，您永远不会调用`pthread_join()`第一个线程。

这样的事情应该可以解决这些问题：

```
namespace thread {
    int terminate_thread_set = 0;
    pthread_mutex_t terminate_thread = PTHREAD_MUTEX_INITIALIZER;
    pthread_cond_t terminate_thread_set_cond = PTHREAD_COND_INITIALIZER;
    pthread_cond_t terminate_thread_unset_cond = PTHREAD_COND_INITIALIZER;

    /* ... */

    inline void Exit(void* value)
    {
        pthread_mutex_lock(&thread::terminate_thread);
        while (thread::terminate_thread_set)
            pthread_cond_wait(&thread::terminate_thread_unset_cond);
        thread::terminated_thread_id = pthread_self();
        thread::terminate_thread_set = 1;
        pthread_cond_signal(&thread::terminate_thread_set_cond);
        pthread_mutex_unlock(&thread::terminate_thread);

        pthread_exit(value);
    }
} 
```

并在`main`：

```
pthread_mutex_lock(&thread::terminate_thread);

/* ... */

while(thread::total_thread_count > 0) {
    while (!thread::terminate_thread_set)
        pthread_cond_wait(&thread::terminate_thread_set_cond, &thread::terminate_thread);
    thread::terminate_thread_set = 0;
    pthread_join(thread::terminated_thread_id, NULL);
    pthread_cond_signal(&thread::terminate_thread_unset_cond);
...
}
pthread_mutex_unlock(&thread::terminate_thread); 
```

当然，这并不是说您没有其他问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T20:36:26.490

看起来好像您正在`termination_in_process`从主进程中解锁互斥锁 - 即使它被另一个线程锁定 - 这是未定义的行为。它可能有效，也可能无效。

一种解决方案可能是使用 FIFO 缓冲区（例如[std::queue](http://www.cplusplus.com/reference/stl/queue/)，甚至只是一个[std::vector](http://www.cplusplus.com/reference/stl/vector/)）并将终止线程的线程 ID 推送到`Exit()`函数中，然后发送信号，然后让主线程通过缓冲区并加入其中的任何线程。

如果`Exit()`在您的段错误时没有调用，这不应该是您的问题的原因，但它仍然是您可能想要修复的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T06:46:11.137

这已经很晚了，但我忘了把它贴出来以备将来参考。这就是我修复它的方法：

我将我的 GCC 编译器从版本升级到 4.5.X 到版本 4.7.X 以及我的内核从 2.6.X 升级到 3.2.X 并通过提供显式构造函数修复了一些关于类的全局实例化和静态成员变量的错误为了允许在没有初始化的情况下进行全局声明。但我认为升级 GCC 编译器就是我们所需要的。

看起来功能的实现不正确。还是内核代码中有一些错误？

# mysql - MySql 在 IF 子句中使用 DATEDIFF

> ID：11816285
> 
> 赞同：1
> 
> 时间：2012-08-05T12:09:38.053
> 
> 标签：mysql, if-statement, datediff

我正在尝试在 IF 子句中使用 DATEDIFF 函数，如下所示：

```
select if('2006-04-01',DATEDIFF('2006-04-01','2007-04-01'),'y'); 
```

但我得到的结果是`BLOB`！！

如何`DATEDIFF`在`IF`语句中使用并获得有意义的结果。

谢谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:14:07.473

你可能误解了 if 函数

```
select if( datediff('2006-04-01','2012-01-01') > 0, 1, 0 ); 
```

效果很好

datediff 在我的例子 mysql 5.5.24 中的结果是一个整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:18:56.370

据我了解，该`if`声明的工作方式如下：

```
select if(expr, true, false) 
```

此外，`DATEDIFF`返回一个 int 而不是日期，因此您需要获取的返回值`DATADIFF`并将其与已知天数或 0 或另一个`DATEDIFF`操作的返回进行比较。

```
select if(datediff(date1, date2) >= 20, 'true statement', 'false statement') 
```

# java - 如何在 SWT 中禁用系统托盘图标的上下文菜单？

> ID：11816286
> 
> 赞同：0
> 
> 时间：2012-08-05T12:10:00.453
> 
> 标签：java, menu, swt, contextmenu, system-tray

我有托盘图标，并在其上附加了一个菜单，以便当用户右键单击它时，它会弹出。

在我的应用程序中，我想禁用显示内容菜单并稍后重新启用它。我该怎么做？我一直无法找到一个例子，并且做`mnuPopup.setEnabled(false)`似乎不起作用。

这是创建托盘图标并将菜单附加到它的代码片段。

```
Tray trySysTray = display.getSystemTray();
Menu mnuPopup = new Menu(shell, SWT.POP_UP);
TrayItem itmTrayItem = new TrayItem(trySysTray, SWT.NONE);

itmTrayItem.addListener(SWT.MenuDetect, new Listener() {
    public void handleEvent(Event event) {
        mnuPopup.setVisible(true);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:19:09.637

以下应该做的工作：

```
public class MiniExample {
    // the boolean to decide if menu is shown
    private static boolean showMenu = true;

    public static void main(String[] args) {
        Display display = Display.getDefault();
        final Shell shell = new Shell(display);
        shell.setLayout(new FillLayout());

        Tray tray = display.getSystemTray();
        final TrayItem item = new TrayItem(tray, SWT.NONE);

        // INPUT A REAL IMAGE HERE!
        item.setImage(SOME_IMAGE);

        item.addMenuDetectListener(new MenuDetectListener() {

            @Override
            public void menuDetected(MenuDetectEvent event) {
            // if menu shall not be shown, tell it to the event
                if(!showMenu)
                {
                    event.doit = false;
                    return;
                }

            // else create the menu
                Menu menu = new Menu(shell, SWT.POP_UP);
                MenuItem menuitem = new MenuItem(menu, SWT.PUSH);
                menuitem.setText("Do Something");
                menuitem.addListener(SWT.Selection, new Listener() {
                    public void handleEvent(Event e) {
                        System.out.println("Do something!");
                    }
                });

                menu.setVisible(true);
                while (!menu.isDisposed() && menu.isVisible()) {
                    if (!shell.getDisplay().readAndDispatch())
                        shell.getDisplay().sleep();
                }

            // remember to dispose it !!
                menu.dispose();
            }
        });

        Button button = new Button(shell, SWT.PUSH);
        button.setText("Button");
        button.addSelectionListener(new SelectionListener() {

            @Override
            public void widgetSelected(SelectionEvent arg0) {
                // button decides if menu is shown or not
                showMenu = !showMenu;
            }

            @Override
            public void widgetDefaultSelected(SelectionEvent arg0) {

            }
        });

        shell.pack();
        shell.open();
        while (!shell.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
    }
} 
```

# processing - 处理错误信息，我应该如何编写drawgrid函数？

> ID：11816288
> 
> 赞同：0
> 
> 时间：2012-08-05T12:10:07.250
> 
> 标签：processing

它总是告诉我我正在混合活动和静态模式。

```
final int GAP = 15;

void setup() {
  size(300,300);
  background(255);
}

void draw() {
}

void mousePressed() {
  background(255);
  drawGrid(mouseX,mouseY);
}

drawGrid(mouseX,mouseY)
{
  line(10,10,20,20);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:29:56.257

您有两个语法错误：

1.  您缺少 drawGrid 函数的返回类型（我认为是`void`并且处理假设您正在拨打电话，而不是定义函数）
2.  您尚未指定 drawGrid 参数的类型

尝试这个：

```
final int GAP = 15;

void setup() {
  size(300,300);
  background(255);
}

void draw() {
}

void mousePressed() {
  background(255);
  drawGrid(mouseX,mouseY);
}

void drawGrid(int mouseX,int mouseY)
{
  line(10,10,20,20);
} 
```

# java - Android 在长菜单点击时显示键盘

> ID：11816292
> 
> 赞同：0
> 
> 时间：2012-08-05T12:10:28.957
> 
> 标签：java, android, android-softkeyboard

我有一个启用了 textfilter 的列表视图。在某些设备上，当您长按菜单按钮时会显示键盘，但在某些设备上，通常无法显示键盘。

有谁知道如何在长按菜单按钮时显示键盘。我已经有一个代码，但它不工作。键盘不显示。

我的代码：

```
@Override
public boolean onKeyLongPress(int keycode, KeyEvent event){         
    if (keycode == KeyEvent.KEYCODE_MENU){              
        InputMethodManager inputMethodManager=(InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
        inputMethodManager.showSoftInput(lv, InputMethodManager.SHOW_IMPLICIT);             
    }
    return true;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T14:07:14.917

您需要将键盘聚焦在某个editText上

所以：

```
EditText etHello= (EditText) findViewById(R.id.yourEditText);
InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
imm.showSoftInput(etHello, InputMethodManager.SHOW_IMPLICIT); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T14:10:58.470

你用 -flat 调用`showSoftInput()`-method `SHOW_IMPLICIT`。它的文档说：

> **用于指示这是显示输入窗口的隐式请求的**标志，而不是用户直接请求的结果。`showSoftInput(View, int)` **在这种情况下，窗口可能不会显示。**

由于您希望在*用户*按住菜单按钮时显示键盘，因此它不再是隐式的。尝试传入`0`平面参数。

也可以切换键盘，这似乎也适用于其他人。为此，请参阅这个较旧的问题：[android - 按需显示软键盘](https://stackoverflow.com/questions/6475135)

* * *

问题出在您的- 方法中`onKeyLongPress()`。要使用菜单按钮，需要做一些额外的工作。请参阅我对这个较旧问题的回答：[如何在物理菜单按钮上创建长触摸事件？](https://stackoverflow.com/a/7273332/717341)

最后但并非最不重要的一点是，您应该知道菜单按钮已被弃用，并且在较新的设备上不存在。出于兼容性原因，您将获得它的模拟版本，但 ActionBar（和它的搜索字段）应该比传统支持更受青睐。因此，您可能需要检查替代方案。

# c# - 在 C# 中将一个 byte[] 拆分为多个 byte[] 数组

> ID：11816295
> 
> 赞同：10
> 
> 时间：2012-08-05T12:11:17.943
> 
> 标签：c#, bytearray

我正在尝试将图像的字节“分块”。这将允许我分部分上传大图像。我将图像当前存储为一个大字节 []。我想将字节数组拆分为`byte[]`最大长度为 512 个元素的 's。但是，我不确定如何以最有效的方式做到这一点。

有谁知道我怎样才能以最有效的方式做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-05T12:24:50.050

我为此编写了一个扩展，最初用于字符串，但决定使其通用。

```
 public static T[] CopySlice<T>(this T[] source, int index, int length, bool padToLength = false)
    {
        int n = length;
        T[] slice = null;

        if (source.Length < index + length)
        {
            n = source.Length - index;
            if (padToLength)
            {
                slice = new T[length];
            }
        }

        if(slice == null) slice = new T[n];
        Array.Copy(source, index, slice, 0, n);
        return slice;
    }

    public static IEnumerable<T[]> Slices<T>(this T[] source, int count, bool padToLength = false)
    {
        for (var i = 0; i < source.Length; i += count)
            yield return source.CopySlice(i, count, padToLength);
    } 
```

基本上，您可以像这样使用它：

```
byte[] myBytes; // original byte array

foreach(byte[] copySlice in myBytes.Slices(10))
{
    // do something with each slice
} 
```

***编辑***[：我还在此处](https://stackoverflow.com/questions/10539638/how-to-efficiently-get-subset-of-byte-array-first-n-elements-in-c)使用 Buffer.BlockCopy 提供了关于 SO 的答案，但 BlockCopy 仅适用于`byte[]`数组，因此无法使用字符串的通用版本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-05T12:21:28.493

最有效的方法是：不要。如果您已经将图像作为单个字节 []，那么对于本地代码，只需指定偏移量和长度（可能是 som ArraySegment-of-byte）通常就足够了。如果您的上传 API 只使用 byte[]，那么您仍然不应该将其完全分块；只需使用单个 512 缓冲区并使用 Buffer.BlockCopy 加载它将连续的数据片段。您可能需要调整 (Array.Resize)*最终*块的大小，但最多需要 2 个数组。

更好；首先避免需要 byte[]：考虑通过流 API 加载数据（如果数据来自文件，这将很好地工作）；只需使用读取（在循环中，处理返回值等）来填充最大 512 的块。例如（未经测试，仅用于说明）：

```
byte[] buffer = new byte[512];
while(true) {
    int space = 512, read, offset = 0;
    while(space > 0 && (read = stream.Read(buffer, offset, space)) > 0) {
        space -= read;
        offset += read;
    }
    // either a full buffer, or EOF
    if(space != 0) { // EOF - final
       if(offset != 0) { // something to send
         Array.Resize(red buffer, offset);
         Upload(buffer);
       }
       break;
    } else { // full buffer
       Upload(buffer);
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-28T11:39:54.543

```
public static IEnumerable<byte[]> Split(this byte[] value,int bufferLength){
   int countOfArray = value.Length / bufferLength;
   if(value.Length % bufferLength > 0)
      countOfArray ++;
   for(int i=0;i<countOfArray;i++)
   {
      yield return value.Skip(i * bufferLength).Take(bufferLength).ToArray();

   }
} 
```

这是我使用的扩展

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-04T12:35:05.590

> 我知道这很旧，但需要相同的解决方案，并且以下对我来说非常有效，希望这对某人有所帮助

```
private byte[][] ByteArrayToChunks(byte[] byteData, long BufferSize)
{
    byte[][] chunks = byteData.Select((value, index) => new { PairNum = Math.Floor(index / (double)BufferSize), value }).GroupBy(pair => pair.PairNum).Select(grp => grp.Select(g => g.value).ToArray()).ToArray();
    return chunks;
} 
```

# php - 使用 Javascript 编辑页面后保存页面？

> ID：11816297
> 
> 赞同：3
> 
> 时间：2012-08-05T12:11:32.717
> 
> 标签：php, javascript, mysql, wysiwyg

现在，每个人都知道将这段 Javascript 代码插入浏览器 URL 栏中的可爱小技巧：

```
document.body.contentEditable = 'true'; document.designMode = 'on'; void 0 
```

还有埃尔普雷斯托！您可以按照自己的意愿开始自由编辑网站。

唯一的问题是 - 你无法保存它！

在做了一些快速的研究之后，我发现最有可能保存它的最好方法是通过[这里建议](http://answers.yahoo.com/question/index?qid=20090909082655AAHP56T)的方法，它包括以某种方式将页面变成一个巨大的表单并将其发布到 MySQL 数据库。

当然，虽然这样做很好，但最终会保存我的整个页面——而不仅仅是我想要编辑的部分或容器——这是一个主要问题，因为我们的开发人员需要保留代码行，例如......

```
<?php include('header.php'); ?> 
```

...未在 HTML 中输出。换句话说：它将保存我的页面，因为它出现在输出的 HTML 中，覆盖了我原始 PHP 文件中的内容。

我要问的是如何保存这样编辑的网站，而只是保存或更新网站上的一两个可编辑容器（不是全部，所以我的 PHP 代码不会被覆盖)?

例如：

```
<p>This Won't get updated when the page is "saved"</p>
<div id="update-this-contianer">
   This area will be passed on to the MySql database, and then updated into the same section of the original file.
</div><!-- End Area To Update --> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T12:20:18.827

无需设置`contentEditable`在整个主体上，只需将其放在要编辑的元素上即可。然后，将该元素的内容发送到服务器。当您想再次取回数据时，只需将该部分包含在适当的位置即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T12:26:48.217

...不回答您的问题，但可能有助于解决...：

尽管我听起来很容易（将 contentEditable="yes" 放在一个元素上然后你就走了） - 它不是......

您将不得不使用 javascript 来捕获页面的已编辑元素并将现有/新/更改的内容保存到数据库中。

我决定不重新发明轮子，并在过去的一个项目中开始使用 Aloha：

[http://aloha-editor.org/](http://aloha-editor.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T12:17:32.213

我找到了以下描述。它可能会有所帮助。

[contenteditable 更改事件](https://stackoverflow.com/questions/1391278/contenteditable-change-events)

[http://css-tricks.com/snippets/javascript/saving-contenteditable-content-changes-as-json-with-ajax/](http://css-tricks.com/snippets/javascript/saving-contenteditable-content-changes-as-json-with-ajax/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T12:25:22.810

只需创建一个对象，在按下按钮时获取所有数据并使用 jQuery post 发送。

例如：

```
var val = $('#update-this-contianer').html()
$.post('/post-address', {value: val}, function(returnMsg){
console.log(returnMsg)
} 
```

但是，如何将其取回并将其放入原始文件中则更为复杂。在节点中，我将编辑 save to db 函数，以便它打开文件 X 并将其附加到某处，或者只是将其附加到 req 变量或其他东西并提​​供它。

*但是，如果这是一个面向公众的页面，出于安全原因，请不要这样做。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-02T15:53:11.837

一种肮脏或干净的方法是同时使用 PHP 和 HTML。

首先，正如一位用户所说，不要重新发明轮子。

1.  在项目的根目录下载并安装 Aloha-Editor。

2.  使用*OOP*方法来设计您的页面。免责声明，如果您更喜欢*过程 PHP* ，如果您不想使用，您实际上不必使用*OOP 。*可以在保持一定的*OOP*逻辑的同时编写程序风格的代码。

3.  通过 ajax 将整个 HTML 页面保存到数据库中，然后使用 ajax 获取页面的内容。

例子 ：

**索引.php**

```
<?php 
//include your db parameters
include_once 'config.php';

//include your html page
include_once 'view/index.html';?> 
```

**索引.html**

```
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Getting Started with Aloha Editor</title>
    <link rel="stylesheet" href="index.css" type="text/css">
    <!-- Load Aloha Editor css and js -->
    <link rel="stylesheet" href="/javascripts/aloha/css/aloha.css" type="text/css">
    <script src="/javascripts/aloha/lib/require.js"></script>
    <script src="/javascripts/aloha/lib/aloha.js"
      data-aloha-plugins="common/ui,common/format,common/highlighteditables,common/link"></script>
</head>
<body>
    <div id="main">
        <div id="content"><p>Getting started with Aloha Editor!</p></div>
    </div>
    <script type="text/javascript">
        Aloha.ready( function() {
            Aloha.jQuery('#content').aloha();
        });
    </script>
</body> 
```

或者您可以简单地将 PHP 与 PHP 一起使用。因此，插入 home.php 而不是 index.html，在 home.php 中，您可以通过请求保存内容的数据库来检索内容。

例子

**索引.php**

```
<?php 
//include your db parameters
include_once 'config.php';

//include your html page
include_once 'view/home.php';?> 
```

**主页.php**

```
select webpage_content from aloha where page_name='index'

echo $webpage_content 
```

当然有成千上万种方法可以解决这个问题。无论什么都震撼你俩:-)

# python - 如何编写过滤字段长度的 gql 查询？

> ID：11816301
> 
> 赞同：0
> 
> 时间：2012-08-05T12:12:20.227
> 
> 标签：python, google-app-engine

我想按数据存储中的一个字段的长度过滤查询，但似乎我不能在 WHERE 子句中包含 len 函数。

```
q = db.GqlQuery("SELECT CommentCode FROM Comments " + 
                "WHERE RefObjType = 'paper' AND RefObjID = :1 AND len(CommentCode) = :2" +
                "ORDER BY CommentCode DESC ", RefObjID, 1) 
```

这导致：`BadQueryError: Parse Error: Invalid WHERE Condition at symbol (`

谁能给我一个例子来说明我如何让它工作？

RefObjID 部分有效，因为如果我忽略 len() 过滤器，则整个查询都有效。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:54:07.710

由于 DataStore 的工作方式，您不能（至少据我所知）。字符串的长度需要是您的属性（静态或动态使用`db.Expando`）`Model`，然后您对其进行过滤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:01:17.323

一种可能的解决方案：
修改查询以按 DESC 顺序检索结果，然后在查询检索后通过访问所需的结果来处理结果。

变更查询：

```
 q = db.GqlQuery("SELECT CommentCode FROM Comments " + 
                    "WHERE RefObjType = 'paper' AND RefObjID = :1" +
                    "ORDER BY CommentCode DESC ", RefObjID, 1) 
```

在此之后选择具有`length(CommentCode)==2`循环和条件语句的行。

# css - 立体主义 - 选定时间和行的值

> ID：11816307
> 
> 赞同：1
> 
> 时间：2012-08-05T12:12:59.643
> 
> 标签：css, graph, d3.js, cubism.js

我爱[Cubism.js](http://square.github.com/cubism/)

但我想实现演示中缺少的功能。

这就是需要查看**选定时间和行的值**。当我将鼠标悬停在图表上时 - 我想显示鼠标光标所在行的值（参见垂直线旁边的图片）

![为时间和行显示的值](../Images/ad00b1cc8511d2ec6d75c54089f27a3a.png) 怎么可能做到这一点？

我有机会使用 CSS 还是需要深入[研究 d3.js](http://d3js.org/)？

**编辑**：我找到了[Stock-Demo](http://bost.ocks.org/mike/cubism/intro/demo-stocks.html) ......但现在仍然知道这是如何完成的 :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:15:46.243

查看视图源：[http](http://bost.ocks.org/mike/cubism/intro/demo-stocks.html) ://bost.ocks.org/mike/cubism/intro/demo-stocks.html 。您需要的是以下内容： `d3.select("body").append("div") .attr("class", "rule") .call(context.rule());`

这使用 context.rule() 来实现，一个 d3/cubism 函数。

上一个答案为您提供了一行的值，即鼠标所在的行。cubism.js 规则将给出所有行的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:53:34.057

我可以通过使用 CSS 轻松实现这一点。首先，隐藏所有值：

```
.horizon .value {display: none;} 
```

然后在悬停时显示值：

```
.horizon:hover .value {display: inherit;} 
```

# c# - Mono 中的多个 Windows 应用程序的错误

> ID：11816308
> 
> 赞同：0
> 
> 时间：2012-08-05T12:13:08.970
> 
> 标签：c#, winforms, multithreading, mono

我正在使用 LinuxMint 和 MonoDevelop 开发 C# 应用程序。
我写了下一个代码，

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;
using System.Threading;
using System.Diagnostics;

namespace TestProgram
{
    public static class Program
    {
        public static int count = 0;
        static object locker = new object();

        const int limit = 10;

        [STAThread]
        static void Main()
        {
            for(int i = 0; i < Program.limit; ++i)
            {   
                Action item = () => Program.RunForm();
                item.BeginInvoke((a) => item.EndInvoke(a), null);
                Thread.Sleep(1000);
            }

            while(true)
            {
                Thread.Sleep(1000);
                if(Program.count == 0)
                    break;
            }

            return;
        }

        static void RunForm()
        {   
            lock(Program.locker) {
                Program.count += 1;
            }

            Application.EnableVisualStyles();
            Application.Run(new Form());

            lock(Program.locker) {
                Program.count -= 1;
            }
        }
    }
} 
```

在 DotNET 中，该程序运行良好。10 个窗口正确显示。
在 Mono 中，程序在没有托管异常的情况下崩溃。
当第 2 个、第 3 个或以后的窗口出现时，它突然崩溃。

这是单声道的错误吗？还是代码错了？
为什么行为不一样？

（请原谅我糟糕的英语。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T22:36:36.270

该代码应该（并且将，对于操作系统和 .NET 的某些组合）在 Microsoft .NET 上的 Windows 上也会中断。您应该只在单个线程上创建表单，并且绝对不应该`Application.Run()`多次调用！

# python - 如何重命名所有文件夹？

> ID：11816315
> 
> 赞同：5
> 
> 时间：2012-08-05T12:14:08.380
> 
> 标签：python, rename, python-2.5

我有如下代码：

```
temp = os.walk(sys.argv[1])
for root, dirs, files in temp:
    for i in dirs:
        dir = os.path.join(root,i)
        os.rename(dir, dir+"!") 
```

它几乎可以正常工作。但是一旦父文件夹重命名，就不能重命名子文件夹。我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-05T12:16:24.357

`topdown`改为设置为 False 遍历树：

```
temp = os.walk(sys.argv[1], topdown=False)
for root, dirs, files in temp:
    for i in dirs:
        dir = os.path.join(root,i)
        os.rename(dir, dir+"!") 
```

从[文档](http://docs.python.org/library/os.html#os.walk)中：

> 如果可选参数*topdown*指定或未指定，则`True`目录的三元组在其任何子目录的三元组之前生成（目录是自上而下生成的）。如果*topdown*是`False`，则在其所有子目录的三元组之后生成目录的三元组（目录是自下而上生成的）。

因此，您可以先重命名子目录，最后才能看到顶级目录，重命名它们将不再影响如何找到子目录。

# sphinx - Sphinx Search binlog 格式不向后兼容？

> ID：11816317
> 
> 赞同：0
> 
> 时间：2012-08-05T12:14:17.823
> 
> 标签：sphinx

Sphinx 团队的问题：为什么在新的 2.0.5 版本中 binlog 格式与之前的 2.0.4 版本不兼容？

如何迁移到新版本？

看看我安装 2.0.5 后得到了什么：

```
WARNING: index 'index_9127': preload: /var/db/sphinxsearch/idx/index_9127.meta is v.6, binary is v.5; NOT SERVING 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T03:17:39.453

它*是*兼容的。

我调查了我们的来源，发现 2.0.4 和 2.0.5 之间没有版本更改（实际上必须如此）。

但是，在我们的主干中更改了 binlog 的版本（这是 2.1-dev 分支，而不是 2.0.X！）在主干中，我们可以自由地升级版本，因为我们添加了新功能并开发了 sphinx。由于svn rev。编号对于两个分支都是一个，在使用从 svn 构建的 sphinx 时，保留必要的分支很重要。例如，svn rev 3308 在 rel20 分支中并且是 2.0.5-release，但是 svn rev 3189 在主干分支中并且是当前的 2.1.X-dev。这里的数字越多（3308 对 3189）决不是说越高的数字指向更“新鲜”的版本。顺便说一下，它们不能混淆，因为它们被放置在 svn repo 的不同分支（=文件夹）中。

实际上，您似乎使用了“主干”版本（2.1.X-dev），然后升级到 2.0.5（实际上它是 donwgrade，而不是升级）。而且，结果是 - 旧版本的 sphinx 无法加载新版本的索引。

所以，问题根本*不在*狮身人面像上。

如果数据很重要，如果降级到 2.0.5 分支也很重要，可能需要正确关闭 sphinx（这样 binlog 将不包含数据，因为它的目的是保持崩溃），然后擦除输出所有二进制日志文件，包括“元”。重新启动后，sphinx 将使用当前版本重新创建文件。但是 - 它需要通过备份执行 - 因为除了元版本更改之外，它还可能是索引格式的另一个更改（如果是这样，旧版本无论如何都不会加载更新的索引）。

顺便说一句，留在 2.1-dev 中是可以的，因为 stable 2.0.X 分支的全部内容会定期合并到主干中，因此主干中的所有错误也会得到修复。

# javascript - jwplayer seek() 和 onTime() 播放视频片段

> ID：11816324
> 
> 赞同：5
> 
> 时间：2012-08-05T12:15:16.860
> 
> 标签：javascript, jquery, video, jwplayer

所以我一直在尝试操纵我的 jwplayer，它可以成功播放 youtube 视频，但仍然遇到一些问题。

我希望我的播放器从“开始时间”开始播放并在“结束时间”停止。这两个值将从两个表单输入中获取。所以我去写了这个运行良好的小函数：

```
function timeControl(start, end) {
jwplayer().seek(start).onTime(function (event) {
    if(event.position >= end ) {
        this.stop();
    }
});

} 
```

问题是，如果我运行这个函数两次，第二次它有时会忽略新参数（例如，如果我将开始时间设置为 3 秒，结束时间设置为 10，如果我再次运行它，结束时间为 6 秒，它会起作用，但如果我从 6 点结束时间开始，然后在 10 点开始，它不会......）

有人知道发生了什么吗？无论如何重置播放器的“onTime”属性而无需重新加载播放器？

提前致谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-16T00:45:32.343

我知道这个问题已经过时了，但我要冒昧地说，问题可能只是您一般引用 jwplayer，而不是专门引用 jwplayer 视频实例。

```
<div id="aVideoObject">Loading the player...</div>

<script type="text/javascript">

    jwplayer("aVideoObject").setup({
        flashplayer: "player.swf",
        width: 450,
        height: 320
    });

    function timeControl(start, end) {
        jwplayer("aVideoObject").seek(start).onTime(function (event) {
            if(event.position >= end ) {
                this.stop();
            }
        });
    }
</script> 
```

这个实现对我有用

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-01-22T13:47:17.047

您可以在此处找到开始时间和持续时间：

[JW_Player_Quick_Start_Guide.pdf](http://people.csail.mit.edu/jieyunfu/mediaplayer/JW%20Player%20Quick%20Start%20Guide.pdf) [ [Mirror2](https://github.com/mehulved/jwplayer-example/raw/master/jwplayer/JW%20Player%20Quick%20Start%20Guide.pdf) ]

# php - PHP,sql, UTF-8 编码

> ID：11816330
> 
> 赞同：2
> 
> 时间：2012-08-05T12:16:01.310
> 
> 标签：php, sql, encoding, utf-8

我试图在我正在构建的论坛上了解 UTF-8 编码的一些问题，首先，我正在使用：

```
 <?xml version="1.0" encoding="utf-8"?> 
```

和：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

所以xml编码是**utf-8**，**元字符集**也是如此，我正在使用的文件也是**UTF-8**，在Notepad ++中它是**没有BOM的UTF-8**，在sql server数据库和表是**utf8_general_ci** ,

**问题**是当我从 php 代码中插入数据时，我在浏览器上看到数据正常，但在 sql server 上却很奇怪，

**当我**从 sql server 插入数据时，我在 sql server 上看到数据正常，但在浏览器上很奇怪，如果有人知道的话，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:20:55.313

你用什么样的sql server？对于 postgres 或 mysql，您应该将表和/或字段定义为 utf-8 感知。

否则，当通过 csv 填充数据库并且里面的数据不是 utf-8 编码时，您页面上的结果也将不是 utf-8 编码。

在这种情况下，您可以手动转换字符集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-27T16:45:22.863

$db = mysql_connect(...);

/* 将字符集更改为 utf8 */ mysql_query('SET NAMES utf8');

简单！

# android - 如何在android中动态地使形状可拖动和重新调整大小

> ID：11816331
> 
> 赞同：2
> 
> 时间：2012-08-05T12:16:11.980
> 
> 标签：android, eclipse, canvas, draggable, resize-image

我是 android 的新手，我正在制作一个简单的应用程序，在其中我从图库中选择一个图像，在图像上绘制一个矩形，用户可以在图像上的任何位置拖动该矩形并动态调整矩形的大小。

到目前为止，我的代码可以从图库中加载图像并在图像上绘制一个矩形。但我不知道如何使矩形可动态拖动。

```
public class MainActivity extends Activity   {
private static int RESULT_LOAD_IMAGE = 1;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button buttonLoadImage = (Button) findViewById(R.id.buttonLoadPicture);
    buttonLoadImage.setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0) {

            Intent i = new Intent(
                    Intent.ACTION_PICK,
                    android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);

            startActivityForResult(i, RESULT_LOAD_IMAGE);
        }
    });
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    if (requestCode == RESULT_LOAD_IMAGE && resultCode == RESULT_OK && null != data) {
        Uri selectedImage = data.getData();
        String[] filePathColumn = { MediaStore.Images.Media.DATA };

        Cursor cursor = getContentResolver().query(selectedImage,
                filePathColumn, null, null, null);
        cursor.moveToFirst();

        int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
        String picturePath = cursor.getString(columnIndex);
        cursor.close();

        ImageView imageView = (ImageView) findViewById(R.id.imgView);
        Bitmap bMap = BitmapFactory.decodeFile(picturePath);

        bMap = bMap.copy(Bitmap.Config.ARGB_8888 , true);

        float width = imageView.getWidth();
        float height = imageView.getHeight();

        Canvas canvas = new Canvas(bMap);
        Paint paint = new Paint();
        paint.setAntiAlias(true);
        paint.setStyle(Paint.Style.STROKE);
        paint.setStrokeWidth(4);  
        paint.setColor(Color.RED);
        canvas.drawRect(width/2+60, height/2-20, width/2-60, height/2+20, paint);

        imageView.setImageBitmap(bMap);

    }

} 
```

}

![输出](../Images/51c524e902c6039b795aa71ea5706ff8.png)

我想要的输出类似于上图。用户可以调整红色矩形的大小并拖动，然后保存图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:38:57.010

您需要创建一个自定义视图来代表您绘制的矩形。`onDraw(...)`您可以在其中设置`Paint`矩形的初始大小。现在的概念是，当触摸它的角并拖动它时，当用户从屏幕上抬起手指时，矩形的 x 和 y 坐标将发生变化。我将[在](http://developer.android.com/guide/topics/ui/custom-components.html)Android 开发人员指南中向您介绍如何创建自定义视图。这是一个类似的[问题](https://stackoverflow.com/questions/10188478/how-to-make-view-resizable-on-touch-event)帖子，可能会给你一些想法。

# python - PyQt 打开文件对话框错误

> ID：11816332
> 
> 赞同：1
> 
> 时间：2012-08-05T12:16:14.927
> 
> 标签：python, pyqt, xlrd

所以，我有一个带有 QTableWidget 的应用程序，并且想要导入一个 .xls 文件：

```
def openfile(self):
        filename = QtGui.QFileDialog.getOpenFileName(self, 'Open File', '/home', ".xls(*.xls)")
        fname = open(filename)
        with fname:
            wb = xlrd.open_workbook(fname)
            wb.sheet_names()
            sh = wb.sheet_by_index(0)
            for col in sh.ncols:
                for i in col:
                    r = 0
                    c = 0
                    newItem = QtGui.QTableWidgetItem(i)
                    self.tableWidget.setItem(r, c, newItem)
                    r += 1
                r = 0
                c += 1 
```

但是，我得到这个错误：`TypeError: coercing to Unicode: need string or buffer, file found`

我做错了什么？

**更新：**

```
def openfile(self):
            filename = unicode(QtGui.QFileDialog.getOpenFileName(self, 'Open File', '', ".xls(*.xls)"))
            wb = xlrd.open_workbook(filename)
            wb.sheet_names()
            sh = wb.sheet_by_index(0)
            self.first = sh.col_values(0)
            self.r = 0
            self.add()

    def add(self):
        for i in self.first:
             str(i)
             newItem = QtGui.QTableWidgetItem(i)
             self.tableWidget.setItem(self.r, 0, newItem)
             self.r += 1 
```

它正在工作，但我无法加载数字......只有字符串......奇怪......

**更新2：**

```
def add(self):
        for i in self.first:
             newItem = QtGui.QTableWidgetItem(str(i))
             self.tableWidget.setItem(self.r, 0, newItem)
             self.r += 1 
```

但它将所有数字显示为浮点数....

**更新3：**

```
def add(self):
        for i in self.first:
             try:
                newItem = QtGui.QTableWidgetItem(str(int(i)))
             except ValueError:
                newItem = QtGui.QTableWidgetItem(str(i))    
             self.tableWidget.setItem(self.r, 0, newItem)
             self.r += 1 
```

问题解决了...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:22:55.780

[xlrd.open_wookbook](http://www.lexicon.net/sjmachin/xlrd.html#xlrd.open_workbook-function)需要文件名（字符串），而不是`fname`（文件对象）。

尝试：

```
 filename = QtGui.QFileDialog.getOpenFileName(self, 'Open File', '/home', ".xls(*.xls)")
        wb = xlrd.open_workbook(filename) 
```

# c - 对远程登录代码的响应

> ID：11816344
> 
> 赞同：0
> 
> 时间：2012-08-05T12:18:36.813
> 
> 标签：c, linux, sockets, hex, telnet

我正在使用 C 套接字进行 telnet 以获得乐趣。

在`connect()`连接到服务器之后，我是`recv()`这样的：

十六进制：

> ffffffff fffffffd 1
> ffffffff fffffffd 21
> ffffffff 0 ffffffa4
> ffffff81 0 0

十进制：

> 255 253 1
> 255 253 21
> 255 0 164
> 129 0 0

我找不到任何关于 0、164 和 129 的手册。有人可以解释一下吗？我把十六进制转换错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T17:32:58.947

这些是 TELNET 选项协商序列，其基本集合最初在各种 RFC 中定义，包括[RFC854](http://www.faqs.org/rfcs/rfc854.html)、[RFC855](http://www.faqs.org/rfcs/rfc855.html)和[RFC857](http://www.faqs.org/rfcs/rfc857.html)。

例如顺序：

```
255 253 1 
```

对应于

```
IAC DO ECHO 
```

[这个链接](http://www.thoughtproject.com/libraries/telnet/Reference/RFCs.htm)有一个很好的相关 RFC 列表。

# html - main（所有站点的 div）无法正常工作

> ID：11816346
> 
> 赞同：0
> 
> 时间：2012-08-05T12:18:59.903
> 
> 标签：html, css

我想做页脚。我有主 div 有所有页面和主，有称为页脚的 div。所以我的问题是主要只有 137px 但页面更大。所以页脚在顶部而不是底部。这是我正在使用的 html 和 css：

jsfiddle.net/gEgK9

怎么了？（查看`#footer`并`#main`查看 css）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:25:37.693

这就是玩的价格`position:absolute`（或任何其他`position`不是的价值`static`）。定位将从流程中删除您的元素。这意味着，相同上下文中的所有其他元素都`position:static`将被渲染，就好像该元素甚至不存在一样。

您必须使用`position:absolute;bottom:0;`才能将页脚移动到底部。不要忘记您必须计算边距和其他位置，以确保您的页脚不会与其他元素发生冲突。但是，我建议您考虑一下您目前的情况，并问问自己，您的主要内容的绝对定位是否真的有必要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-22T05:23:27.283

尝试使用相对单位（如 % 或 em）代替 px 来表示元素的高度。相对长度单位在不同的渲染介质之间可以更好地缩放。查看详情：[https ://www.w3schools.com/CSSref/css_units.asp](https://www.w3schools.com/CSSref/css_units.asp)

# java - 将文本文件写入数组，然后在 Java 中返回

> ID：11816350
> 
> 赞同：1
> 
> 时间：2012-08-05T12:19:25.567
> 
> 标签：java, arrays, text, return

我正在写小游戏，我需要读取文本文件，将其写入数组，然后打印数组。我的读取和返回数组的类如下所示：

```
import java.io.*;
import java.util.*;

public class WordsList {

    public String[] wordsList;

    public void readFile() throws Exception{

        FileInputStream in = new FileInputStream("test.txt");
        BufferedReader br = new BufferedReader(new InputStreamReader(in));
        NumberOfLines read = new NumberOfLines();
        int n = read.getLineCount();

        String strLine;
        wordsList = new String[n];   

        for (int j = 0; j < wordsList.length; j++){
        wordsList[j] = br.readLine();

        }
        in.close();
    }

    public String[] returnsWordList(){
        return wordsList;
    }
} 
```

在主要课程中，我有这个：

```
import java.util.ArrayList;

public class Main {
    public static void main(String[] args) throws Exception {
        WordsList words = new WordsList();
        System.out.println(words.returnsWordList());
    }

} 
```

它返回空值而不是单词......我做错了什么？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:21:28.600

> 我做错什么了？有任何想法吗？

您未能`readFile()`在代码中的任何地方调用。将您的方法更改`main`为：

```
WordsList words = new WordsList();
words.readFile();
System.out.println(words.returnsWordList()); 
```

它可能会打印出一个非空引用。它不会是一个有用的表示，因为数组不会覆盖`toString`. 如果您想查看实际内容，您需要：

```
System.out.println(Arrays.toString(words.returnsWordList())); 
```

还有很多其他方式可以让您的代码远非完美，但这至少应该可以帮助您入门。

# function - Fortran 函数返回意外的类型和值

> ID：11816351
> 
> 赞同：6
> 
> 时间：2012-08-05T12:19:36.457
> 
> 标签：function, recursion, fortran, fortran95

我正在做一个需要在 Fortran 中实现一些数值方法的项目。为此，我需要编写一些递归函数。这是我的代码。

```
!     
! File:   main.F95
!

RECURSIVE FUNCTION integrate(n) RESULT(rv)
    IMPLICIT NONE
    DOUBLE PRECISION :: rv
    INTEGER, INTENT(IN) :: n
    DOUBLE PRECISION, PARAMETER :: minusone = -1.0
    IF (n == 1) THEN
        rv = 10 !exp(minusone)
        RETURN
    ELSE
        rv = 1 - (n * integrate(n - 1))
        RETURN
    END IF
END FUNCTION integrate

RECURSIVE FUNCTION factorial(n) RESULT(res)
    INTEGER res, n
    IF (n .EQ. 0) THEN
        res = 1
    ELSE
        res = n * factorial(n - 1)
    END IF
END

PROGRAM main
    DOUBLE PRECISION :: rv1
    PRINT *, factorial(5)
    PRINT *, integrate(2)

    !READ *, rv1

END PROGRAM main 
```

对于这个程序，输出是：

```
 NaN
       1 
```

如果我更改打印语句的顺序（第 30 和 31 行），输出将是：

```
 1
-19.000000 
```

输出应该是（对于原始打印语句顺序）：

```
 120  
  -19 
```

我从 Wikipedia [Fortran 95 语言功能](http://en.wikipedia.org/wiki/Fortran_language_features#Recursion)页面中获取了阶乘函数。

*   编译器：带有 Cygwin 的 gfortran 4.5.3
*   IDE：Netbeans 7.0.1
*   平台：Windows 7

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-05T16:56:01.350

正如其中一条评论所提到的，更好的解决方案是将您的子例程和函数放入一个模块中，然后从您的主程序中使用该模块。这将使调用者知道这些过程的接口——在 Fortran 术语中是“显式”的。编译器不仅会正确处理函数的类型，它还将能够检查调用中的参数和被调用者中的参数（“虚拟参数”）之间的类型一致性以确保一致性。

如果您使用尽可能多的调试选项，编译器将帮助您发现错误。使用 gfortran，尝试： -O2 -fimplicit-none -Wall -Wline-truncation -Wcharacter-truncation -Wsurprising -Waliasing -Wimplicit-interface -Wunused-parameter -fwhole-file -fcheck=all -std=f2008 -pedantic -fbacktrace

```
module factorial_procs

   IMPLICIT NONE

contains

   RECURSIVE FUNCTION integrate(n) RESULT(rv)
       DOUBLE PRECISION :: rv
       INTEGER, INTENT(IN) :: n

       IF (n == 1) THEN
           rv = 10
           RETURN
       ELSE
           rv = 1 - (n * integrate(n - 1))
           RETURN
       END IF
   END FUNCTION integrate

   RECURSIVE FUNCTION factorial(n) RESULT(res)
       INTEGER res, n
       IF (n .EQ. 0) THEN
           res = 1
       ELSE
           res = n * factorial(n - 1)
       END IF
   END

end module factorial_procs

PROGRAM main

    use factorial_procs

    implicit none

    PRINT *, factorial(5)
    PRINT *, integrate(2)

END PROGRAM main 
```

您可能会发现您只能通过使用常规整数的直接乘法来计算非常小的整数的阶乘。一种解决方法是使用更大的整数类型，例如，

```
integer, parameter :: BigInt_K = selected_int_kind (18) 
```

就像您可以现代化并使用 selected_real_kind 而不是双精度一样。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-05T12:48:31.047

您的函数编写正确。问题出在主程序中，您没有显式声明`integrate`和`factorial`函数的类型，因此您有隐式类型，在这种情况下`factorial`是假定的`REAL`并且`integrate`是假定的`INTEGER`。出于某种原因，您的编译器没有警告您类型不匹配。我的做了：

```
$ gfortran recurs.f90 
recurs.f90:26.22:

    PRINT *, integrate(2)
                      1
Error: Return type mismatch of function 'integrate' at (1) (INTEGER(4)/REAL(8))
recurs.f90:27.22:

    PRINT *, factorial(5)
                      1
Error: Return type mismatch of function 'factorial' at (1) (REAL(4)/INTEGER(4)) 
```

您应该将主程序更改为：

```
PROGRAM main
    IMPLICIT NONE
    DOUBLE PRECISION, EXTERNAL :: integrate
    INTEGER, EXTERNAL :: factorial
    PRINT *, factorial(5)
    PRINT *, integrate(2)
END PROGRAM main 
```

注意`IMPLICIT NONE`线。此声明语句将禁用任何隐式类型，如果不是所有变量和函数都被显式声明，编译器将抛出错误。这是每个 Fortran 程序中非常重要的一行，如果你拥有它，你就会自己找出问题所在，因为它会迫使你在程序中显式声明所有内容。

现在的输出是：

```
 120
  -19.0000000000000 
```

正如预期的那样。

附带说明一下，`DOUBLE PRECISION`类型声明不如使用指定`REAL`的`KIND`参数灵活，例如`REAL(KIND=myRealKind)`. 请参阅有关如何`KIND`正确使用此问题的答案：[Fortran 90 kind parameter](https://stackoverflow.com/questions/838310/fortran-90-kind-parameter)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-15T11:48:11.077

```
I would like to highlight some points while using RECURSIVE functions or non recursive function. 
```

1\. 确保函数与调用程序有显式接口。这可以通过将函数放入模块和 USE 关联来实现。这在上述答案中进行了解释。2.您可以使用INTERFACE与主调用程序建立显式接口，这在您有很少数量的具有隐式接口的函数时很有用，例如您的情况。示例如下。

```
PROGRAM main
IMPLICIT NONE
  INTERFACE 
   FUNCTION factorial(n)
     INTEGER:: factorial 
     INTEGER, INTENT(IN):: n
   END FUNCTION factorial

  FUNCTION integrate(n)
    DOUBLE PRECISION:: integrate
    INTEGER, INTENT(IN):: n
  END FUNCTION integrate
END INTERFACE 

PRINT *, factorial(5) 
PRINT *, integrate(2)

END PROGRAM main 
```

请注意，定义 kind 参数然后使用 KIND 子句总是更好！[@milancurcic解释](https://stackoverflow.com/users/827297/milancurcic)

还有另一种非常简单的方法可以解决您的问题：只需在主程序中定义阶乘和迭代，如下所示，您就可以开始了

```
PROGRAM main
IMPLICIT NONE
    DOUBLE PRECISION :: integrate
    INTEGER:: factorial
    PRINT *, factorial(5)
    PRINT *, integrate(2)

END PROGRAM main 
```

# java - 爪哇玩！2 - 使用 cookie 进行用户管理

> ID：11816353
> 
> 赞同：6
> 
> 时间：2012-08-05T12:19:42.523
> 
> 标签：java, cookies, playframework, playframework-2.0

我正在尝试通过 cookie 管理我的用户。这并不容易，因为绝对没有关于这个主题的文档。

在示例“zentask”的帮助下，我做了这个：

```
session("username", filledForm.field("username").value());

public class Secured{

    public static Session getSession() {
        return Context.current().session();
    }

    public static String getUsername() {
        return getSession().get("username");
    }

    public static boolean isAuthorized() throws Exception {
        String username = getUsername();
        if (username == null)
            return false;
        long userCount = DatabaseConnect.getInstance().getDatastore()
                .createQuery(User.class).field("username").equal(username)
                .countAll();

        if (userCount == 1)
            return true;

        return false;

    } 
```

我这样使用它：

```
public static Result blank() throws Exception {

        if (Secured.isAuthorized())
            return ok(Secured.getUsername());
        else
            return ok(views.html.login.form.render(loginForm));

    } 
```

现在我有几个问题/问题：

*   1.) Cookie 没有被删除，并且看起来总是一样的。例如 bdb7f592f9d54837995f816498c0474031d44c1a-username%3Akantaki

*   2.) Security.Authenticator 类做什么？

*   3.) 我认为通过 cookie 进行用户管理是一个很常见的问题，play!2.0 是否为我提供了完整的解决方案？或者至少有一些文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-05T12:50:35.787

如[Zentask 示例](https://github.com/playframework/Play20/blob/master/samples/java/zentasks/app/controllers/Secured.java)所示，您的`Secured`类应该扩展`Security.Authenticator`。

有了这个，它将允许`@Security.Authenticated`在控制器或动作上放置注释。如果用户未正确授权（通过覆盖`Security.Authenticator.onUnauthorized()`方法），此注释允许将客户端重定向到另一个页面。

工作流程如下：

1.  [检查授权](https://github.com/playframework/Play20/blob/master/samples/java/zentasks/app/controllers/Application.java#L19)：
2.  [在客户端 cookie 中添加唯一标识符](https://github.com/playframework/Play20/blob/master/samples/java/zentasks/app/controllers/Application.java#L40)
3.  [检查是否经过身份验证](https://github.com/playframework/Play20/blob/master/samples/java/zentasks/app/controllers/Secured.java#L12)
4.  [保护控制器或操作](https://github.com/playframework/Play20/blob/master/samples/java/zentasks/app/controllers/Projects.java#L17)
5.  [如果未授权，将客户端重定向到另一个页面](https://github.com/playframework/Play20/blob/master/samples/java/zentasks/app/controllers/Secured.java#L17)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-05T13:32:28.607

还有完整的堆栈`authentication`和`authorization`- Joscha Feth 的[Play Authenticate](http://joscha.github.com/play-authenticate/)。（可在[GitHub 上](https://github.com/joscha/play-authenticate)获得）

它包含了适用于 Java 的即*用型*`securesocial`示例，该示例使用+ 完整的[Deadbolt 2](https://github.com/schaloner/deadbolt-2)（由 Steve Chaloner）支持的概念。它有：

*   内置电子邮件、Google、Facebook、Foursquare、Twitter、OpenId 和自定义提供商的用户`register`。`log in`
*   多语言支持（目前：英语、德语、波兰语）
*   可定制的模板（也适用于信息电子邮件）
*   支持`roles`和`permissions`（通过[Deadbolt 2](https://github.com/schaloner/deadbolt-2)）
*   密码恢复支持

其中有 Java 的示例应用程序。您可以将其合并到您的应用程序中。

# jquery - CSS按钮按下并保持向下

> ID：11816357
> 
> 赞同：1
> 
> 时间：2012-08-05T12:20:19.640
> 
> 标签：jquery, css, button

有没有办法保持按下按钮，也许使用 javascript 或 jquery？

我希望按钮在单击时保持红色，这就是我所拥有的：

```
<style>
#button {
border: 3px solid #52A7D3;
background-color: #52A7D3;
color: #000000;
}

#button:active {
border: 3px solid red;
background-color: red;
color: #FFF;
}
</style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:40:24.180

你可以尝试这样的事情：

```
<button id="someId">test</button>

<script type="text/javascript">
$("#someId").click(function() {$(this).toggleClass( "active")})
</script>

<style>
#someId{
border: 3px solid #52A7D3;
background-color: #52A7D3;
color: #000000;
}

#someId.active {
border: 3px solid red;
background-color: red;
color: #FFF;
</style> 
```

这是一个[例子](http://jsfiddle.net/zpEVN/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:39:33.217

您应该遵循以下流程：

在 CSS 文件中写一个类而不是 #button:active 即

```
.active {border:3px solid red; background-color: red;color: #FFF; } 
```

并在您的标记页面中将以下 jquery 代码放入脚本块中

```
$(function(){
   $("#button").mousedown(function(){
       $("#button").addClass("active");
   }).mouseup(function(){
       $("#button").removeClass("active");
   });
}); 
```

这将解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T13:36:59.190

如果我是你，我会使用隐藏的复选框和标签。

像这样：http: [//jsfiddle.net/22h3M/](http://jsfiddle.net/22h3M/)

# c# - MS Word 加载项：右键单击处理程序

> ID：11816358
> 
> 赞同：4
> 
> 时间：2012-08-05T12:20:26.030
> 
> 标签：c#, ms-word, add-in

我正在为MS Word 2010开发一个加载项，我想在右键单击菜单中添加几个菜单项（仅在选择某些文本时）。我已经看到了几个添加项目的示例，但找不到如何有条件地添加项目。简而言之，我想覆盖类似 OnRightClick 处理程序的东西。提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-29T10:11:27.107

这很简单，您需要处理`WindowBeforeRightClick`事件。在事件内部找到所需的命令栏和特定控件并处理`Visible`或`Enabled`属性。

在下面的示例中，我`Visible`根据选择切换在文本命令栏上创建的自定义按钮的属性（如果选择包含“C#”，则隐藏按钮，否则显示它）

```
 //using Word = Microsoft.Office.Interop.Word;
    //using Office = Microsoft.Office.Core;

    Word.Application application;

    private void ThisAddIn_Startup(object sender, System.EventArgs e)
    {
        application = this.Application;
        application.WindowBeforeRightClick +=
            new Word.ApplicationEvents4_WindowBeforeRightClickEventHandler(application_WindowBeforeRightClick);

        application.CustomizationContext = application.ActiveDocument;

        Office.CommandBar commandBar = application.CommandBars["Text"];
        Office.CommandBarButton button = (Office.CommandBarButton)commandBar.Controls.Add(
            Office.MsoControlType.msoControlButton);
        button.accName = "My Custom Button";
        button.Caption = "My Custom Button";
    }

    public void application_WindowBeforeRightClick(Word.Selection selection, ref bool Cancel)
    {
        if (selection != null && !String.IsNullOrEmpty(selection.Text))
        {
            string selectionText = selection.Text;

            if (selectionText.Contains("C#"))
                SetCommandVisibility("My Custom Button", false);
            else
                SetCommandVisibility("My Custom Button", true);
        }
    }

    private void SetCommandVisibility(string name, bool visible)
    {
        application.CustomizationContext = application.ActiveDocument;
        Office.CommandBar commandBar = application.CommandBars["Text"];
        commandBar.Controls[name].Visible = visible;
    } 
```

# linux - Live Linux Distro 纯文本模式

> ID：11816359
> 
> 赞同：3
> 
> 时间：2012-08-05T12:20:43.160
> 
> 标签：linux, text, live, mode, cd

我正在寻找一个 linux 发行版，我可以通过 USB 启动它，在启动和关闭时运行脚本。我需要最低限度，但我还需要网络驱动程序。还需要在重新启动时保存文件。

我已经通过网络研究了 DamnSmallLinux。还有其他选择吗？最快的启动是首选。我不需要鼠标、声音等。快速启动的最低要求。要在重新启动时保存文件，我应该创建一个带有两个分区的 USB 并保存到非操作系统分区吗？我必须在操作系统中安装这个分区吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T12:26:05.893

[http://www.slitaz.org/en/](http://www.slitaz.org/en/)

我所知道的小型发行版和可用且紧凑的系统之间的最佳折衷方案。

# wcf - 使用 netTcpBinding 服务

> ID：11816364
> 
> 赞同：3
> 
> 时间：2012-08-05T12:21:23.220
> 
> 标签：wcf, nettcpbinding, .net-micro-framework

我正在设计一项将执行计算的服务，这对我的设备来说太重了。为了获得最佳性能，我想使用 netTcpBinding。MFSvcUtil 工具成功地从提供的 WSDL 生成代码文件。但我看不到任何方法可以使用 netTcpBinding 实例化代理。

唯一可用的绑定是`WS2007HttpBinding`和`CustomBinding`。使用 WS2007HttpBinding 看起来像这样（根据[这个博客](http://msdn.microsoft.com/en-us/magazine/gg232761.aspx)）：

```
WS2007HttpBinding binding = new WS2007HttpBinding (new HttpTransportBindingConfig(new Uri("url to svc")));
m_proxy = new ProxyClass (binding, new ProtocolVersion11()); 
```

但我不想使用 HTTP。我应该使用哪种绑定？

# php - PHP fSockOpen 查询到服务器？

> ID：11816365
> 
> 赞同：2
> 
> 时间：2012-08-05T12:21:25.607
> 
> 标签：php, sockets, remote-server

我最近开始**从服务器获取数据**。例如，来自**CoD 4 服务器**。好的？

下面是一个脚本，我可以查询服务器的状态。意思是服务器的设置（地图、标题）和玩家的分数。现在的问题是，在 fwrite 函数中使用握手，这些是什么意思，如果有的话，我如何从中获取更多信息？

我正在使用**"\xFF\xFF\xFF\xFFgetstatus\x00"**与 CoD 4 服务器握手，但我只得到玩家的姓名、分数和 ping。我需要的是得分，杀戮，死亡和助攻。关键是，这些选项/数据是否可用并且可以获取？我尝试了很多东西，但我似乎无法让它以任何其他方式工作。

当前脚本，从另一个类重写：

```
set_time_limit(5);
$socket = fsockopen('udp://ip:port', 'port', $error, $errorStr, 3);
fwrite($socket, "\xFF\xFF\xFF\xFFgetstatus\x00");
$data = fread($socket, 4096);
fclose($socket); 
```

这让我得到了很多数据，但还不够。我的想法是查询 Left 4 Dead 服务器，但我什至无法获取任何数据。打印出 $socket 时，我确实得到了一个资源流。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:25:24.547

怎么回事

```
while( $data = fread( $socket, 4096 ) ) {
    var_dump( $data ); // or something to test output
    ...
} 
```

# php - CodeIgniter - 找不到方法

> ID：11816376
> 
> 赞同：2
> 
> 时间：2012-08-05T12:21:59.413
> 
> 标签：php, codeigniter

我在这里打开了另一个问题（[调用静态方法时出现致命错误](https://stackoverflow.com/questions/11815769/fatal-error-when-calling-static-method)-如果您需要查看确切的代码，请在此处查看），但是-经过大量测试-似乎原因很奇怪：

*   我有很多帮助类（其中包含静态方法）
*   间歇性地，尽管帮助程序加载良好，但并非所有功能都是可见的。( `print_r(get_class_methods('my_class_name'))`) 拒绝“看到”某些方法（甚至是我作为测试添加的愚蠢/空的方法。

可能出了什么问题？

（它可能与任何类型的“缓存”有关吗？（我没有做过类似的事情，所有开发都是在干净的 CI 安装上进行的）。如果是这样，我该如何解决？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T14:49:24.210

助手应该只是一个函数文件。根本没有类，我想帮助加载器根本不适合加载类。

[http://ellislab.com/codeigniter/user_guide/general/helpers.html](http://ellislab.com/codeigniter/user_guide/general/helpers.html)

如果你想要一个类结构，请创建一个库。

[http://ellislab.com/codeigniter/user_guide/general/creating_libraries.html](http://ellislab.com/codeigniter/user_guide/general/creating_libraries.html)

# javascript - window.open() 不适用于使用电话间隙的 iOS 应用程序

> ID：11816380
> 
> 赞同：8
> 
> 时间：2012-08-05T12:22:47.400
> 
> 标签：javascript, html, ios, cordova

我正在使用 Phonegap 编写一个 ios 应用程序，我在我的应用程序中需要的是，当 phonegap 调用 index.html 时，html 页面会将用户重定向到我的网站，事情是 html 不会将应用程序重定向到我的网站，我不在乎电话间隙是否打开了 safari 我只需要它将它重定向到我的网站我的代码是：

```
<html>
<head>
<script type="text/javascript">
    function loadlink()
    {
        window.open("www.cnn.com");
    }
</script>
</head>
<body onload="loadlink()">        
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T04:54:38.427

让你的函数看起来像这样：

```
function loadlink() {
  window.location.href = "www.cnn.com";
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-11T15:10:02.567

甚至更好

```
function loadlink() {
    if (typeof (window.open) == "function") {
        window.open("http://www.stackoverflow.com");
    }
    else {
        window.location.href = "http://www.stackoverflow.com";
    }
} 
```

由于 Internet Explorer 不太喜欢 window.location.href

# python - Python COM 服务器抛出“模块”对象没有属性“VARIANT”

> ID：11816383
> 
> 赞同：1
> 
> 时间：2012-08-05T12:22:56.160
> 
> 标签：python, com, com-server

这是一个用 Python 实现的 COM 服务器：

```
from win32com.server.exception import COMException
import pythoncom
import sys
import os
from string import Template
import logging
import logging.config

class Connector:
    _reg_clsctx_ = pythoncom.CLSCTX_LOCAL_SERVER
    _reg_clsid_ = "{0CE25AEB-1AFA-4DA7-97BD-F93CDBFB376C}"
    _reg_desc_ = "Python Test COM Server"
    _reg_progid_ = "Compy.Connect"
    _public_methods_ = ['Process', 'Status']
    _public_attrs_ = []
    _readonly_attrs_ = []

    def Process(self, what):
        pass

    def Status(self):
        return Template("""
        Current Directory: $dir
        Installed: $script
        PythonPATH: $pyPath
        """).substitute(dir = os.getcwd(),
                        script = os.path.abspath(__file__),
                        pyPath = sys.path)

if __name__ == '__main__':
    import win32com.server.register
    win32com.server.register.UseCommandLine(Connector) 
```

它注册正常。当它运行时，它会导致在生产机器上发生以下情况，但不会在开发机器上发生：

```
>>> cc = CreateObject("Compy.Connect")
>>> cc.Status()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python26\lib\site-packages\comtypes\client\dynamic.py", line 42, in _
_call__
    return self._obj._comobj.Invoke(self._id, *args)
  File "C:\Python26\lib\site-packages\comtypes\automation.py", line 717, in Invo
ke
raise COMError(hresult, text, details)
_ctypes.COMError: (-2147352567, 'Exception occurred.', (u"Unexpected Python Erro
r: AttributeError: 'module' object has no attribute 'VARIANT'\n", u'Python COM S
erver Internal Error', None, 0L, -2147467259))
>>> 
```

我已经安装了 comtypes 0.6.2。运行 Python 2.6.6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T20:34:23.163

VARIANT 类是在 Pywin32 build 217 中引入的。尝试在它失败的机器上安装最新版本。

# firefox - 如何防止 ESC 上的 FF 关闭 websocket 连接

> ID：11816384
> 
> 赞同：6
> 
> 时间：2012-08-05T12:23:02.650
> 
> 标签：firefox, websocket

当用户按下 ESC 按钮时，Firefox 会关闭打开的 websocket 连接。是否有解决方法或小的 jQuery 代码可以帮助我防止这种情况？每次关闭当前连接时，我都想启动一个新的 websocket 连接，但这似乎有点危险。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T12:41:11.263

看看[https://bugzilla.mozilla.org/show_bug.cgi?id=676881](https://bugzilla.mozilla.org/show_bug.cgi?id=676881)讨论了这个问题和部分修复。页面加载后执行的以下代码片段对我有用：

```
$(window).keydown(function(event) {
    // check for escape key
    if (event.which == 27) {
        // the following seems to fix the symptom but only in case the document has the focus
        event.preventDefault();
    }
}); 
```

# java - 停止执行java线程和join()的作用

> ID：11816389
> 
> 赞同：1
> 
> 时间：2012-08-05T12:24:39.560
> 
> 标签：java, multithreading

我的程序分析了大量文档，偶尔会得到一个导致无限或很长循环的页面。这是无法提前分析的。我想杀死特定页面并继续下一个（丢弃违规页面的任何结果）。[我已经阅读了诸如](https://stackoverflow.com/questions/4252187/how-to-stop-execution-after-a-certain-time-in-java) [如何在 Java 中一段时间​​后停止执行之](https://stackoverflow.com/questions/4252187/how-to-stop-execution-after-a-certain-time-in-java)类的答案？并编写了以下代码：

```
// main program 
    private void runThread() throws InterruptedException {
        long timeout = 15000L;
        RunPageAnalyzer runPageAnalyzer = new RunPageAnalyzer(this);
        Thread t = new Thread(runPageAnalyzer); 
        long startTime = System.currentTimeMillis();
        t.start();
        while (t.isAlive()) {
            t.join(1000);
            long delta = System.currentTimeMillis() - startTime;
            LOG.debug("delta: "+delta);
            if (delta > timeout && t.isAlive()) {
                t.interrupt();
                t.join;
                break;
            }           
        }
    } 
```

线程调用的同一类中的方法

```
 void runActions() {
        // variable length calculation which should be abandoned if too long
    } 
```

和可运行的：

```
 class RunPageAnalyzer implements Runnable {
    private PageAnalyzerAction pageAnalyzerAction;
        public RunPageAnalyzer(PageAnalyzerAction pageAnalyzerAction) {
            this.pageAnalyzerAction = pageAnalyzerAction;
        }

        public void run() {
        try {
            pageAnalyzerAction.runActions();
        } catch (Exception e) {
            LOG.debug("Exception running thread ", e);
        }
    } 
```

runActions() 正常终止的输出似乎没问题：

```
 =========== page 1 =============
13863 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - pageActions: 24 on page 0
14863 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - delta: 1000
15864 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - delta: 2001
16864 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - delta: 3001
16975 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - delta: 3112
16975 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - finished page 
```

但是当超过时间限制时，进程会挂起`t.join()`。

```
 =========== page 2 =============
16975 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - pageActions: 24 on page 0
17976 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - delta: 1001
18976 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - delta: 2001
// ...
30976 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - delta: 14001
31976 [main] DEBUG org.xmlcml.graphics.control.page.PageAnalyzerAction  - delta: 15001 
```

如果我省略了，`t.join()`那么该过程的行为与我预期的一样，但我担心这可能只是建立了大量的线程，以后会出现问题。

更新：到目前为止的答案表明这不是微不足道的（我没有发现标准的 Java 示例/教程很有帮助）。关键是`runActions()`必须明确知道它可能会被中断。`join()`不是主要问题，因为线程只是继续前进。

进一步的问题：我是否必须在我期望`Thread.currentThread().isInterrupted()`的所有地方都插入不可预测的长循环？`runActions()`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:36:26.410

我在这里假设`pageAnalyzerAction.runActions();`可以被中断（即它通过相当快地退出来处理中断）。

如果您对低级线程 API 不满意，您可以使用 java.concurrent 包中的 executor 和 futures 来处理线程管理和超时策略：

*   执行器将使用线程池处理线程管理，必要时重用它们
*   可以通过超时查询任务提交时返回的未来 - 如果任务未在超时内完成，未来将抛出 TimeOutException，然后您可以取消您的任务

一个人为的例子是：

```
//declare an executor  somewhere in your code, at a high level to recycle threads
ExecutorService executor = Executors.newFixedThreadPool(10); //number of threads: to be adjusted

private void runThread() throws InterruptedException {
    long timeout = 15000L;
    RunPageAnalyzer runPageAnalyzer = new RunPageAnalyzer(this);
    Future future = executor.submit(runPageAnalyzer);
    try {
        future.get(timeout, TimeUnit.MILLISECONDS);
    } catch (ExecutionException e) {
        //the runnable threw an exception: handle it
    } catch (TimeoutException e) {
        //the task could not complete before the timeout
        future.cancel(true); //interrrupt it
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T12:47:41.157

这里的答案没有提到其他一些东西。如果要取消从线程完成的 I/O，则不能“取消”它并期望实际的 I/O 被取消。您基本上必须处理“任务”中的中断异常并相应地处理它，甚至可能关闭套接字连接。我有一个[小片段](https://bitbucket.org/sanjayts/java-snippets/src/1dc970ebb770/src/main/net/sanjayts/snippets/threading/ThreadStopTest.java)专门用于“停止”使用线程运行的任务，您可能会发现它很有帮助（如果有错别字，请道歉，它是很久以前写的）。

```
public class ThreadStopTest {

    public static void main(String[] args) {
        testSqlThreadStop();
    }

    private static void testSocketReadStop() {
        ExecutorService executor = Executors.newFixedThreadPool(2);
        SocketTask task = new SocketTask("http://www.yahoo.com", 80);
        Future<Integer> future = executor.submit(task);
        try {
            Integer result = future.get(1, TimeUnit.SECONDS);
            System.out.println("Computation complete; result: " + result);
        } catch(TimeoutException te) {
            future.cancel(true);
            task.cleanupAfterCancel();
            System.out.println("Computation cancelled");
        } catch(Exception e) {
            e.printStackTrace();
        }
        executor.shutdown();
    }

}

class SocketTask implements CleanableTask<Integer> {

    private final String host;

    private final int port;

    private Socket socket;

    public SocketTask(final String host, final int port) {
        this.host = host;
        this.port = port;
    }

    @Override
    public Integer call() throws Exception {
        InputStream in = null;
        // TODO: Actually update the count and cleanly handle exceptions
        int bytesRead = 0;
        try {
            this.socket = new Socket(this.host, this.port);
            in = this.socket.getInputStream();
            byte[] bytes = new byte[1000000];
            System.out.println("Started reading bytes");

            // The below behavior of waiting for a forceful close can be avoided
            // if we modify the FutureTask class (the default Future impl)
            // by passing in a CleanupHandler whose cleanup() method would be
            // invoked after invoking the `cancel` method or by making all 
            // your tasks implement a CancelledTask interface which has a 
            // `cleanupAfterCancel` method to do the same. :)
            try {
                in.read(bytes);
            } catch(SocketException se) {
                if(Thread.currentThread().isInterrupted()) {
                    System.out.println("All OK; this socket was forcefully closed");
                } else {
                    se.printStackTrace();   // something was seriously wrong
                }
            }
        } catch(Exception e) {
            e.printStackTrace();
        } finally {
            if(in != null)  in.close();
        }
        return Integer.valueOf(bytesRead);
    }

    @Override
    public void cleanupAfterCancel() {
        try {
            this.socket.close();
        } catch (IOException e) {
            e.printStackTrace();
        }        
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-05T12:39:16.593

听起来您的`runActions`-method 对正在设置的线程的中断状态没有反应。后者`join`调用后的-call`interrupt`没有超时，会无限期地等待线程`t`死掉。您应该检查您的`runActions`-method 中的中断状态，如果设置了中断状态（`Thread.interrupted()`返回 true），则通过终止操作来做出反应。

# php - PHP - 将数据库连接传递给各种类

> ID：11816398
> 
> 赞同：1
> 
> 时间：2012-08-05T12:25:53.490
> 
> 标签：php, oop, class, pdo

我有一个包含许多类的 PHP 项目，以及一个我从网上下载的 PDO Wrapper 类，看起来还不错：

[http://code.google.com/p/php-pdo-wrapper-class/](http://code.google.com/p/php-pdo-wrapper-class/)

我的课程现在看起来像这样：

```
class product {
__constructor($id = 0) {
//mysql_query and store the product row in $this->row;
}

edit($array) {
//another obvious mysql_query...
} 
```

所以它们非常简单，我想将所有 mysql_query 移动到 PDO 以确保安全。我有变量：

```
$db = new pdo('localhost', 'user', 'pass'); 
```

在类之前，在我的包含文件的第一行中正确定义了工作。但是，我不想写：

```
global $db; 
```

在每个功能的开始。我考虑将 __construct() 函数更改为更像：

```
__construct($id = 0, $db = null) {
$this->db = $db;
} 
```

然后从那里引用，但问题是我必须更改整个网站中的每个构造函数。有没有办法解决这个问题，使我能够对现有代码进行最少的编辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:38:43.833

让您的所有模型类都继承自一个基模型类，然后`$db`在您的基类中定义一个静态变量，并在继承的类中使用它。

```
class BaseModel {
  public static $db = NULL;
}

class UserModel extends BaseModel {
  public function create() {
    echo "Use the static variable: " . static::$db . "\n";
  }
}

BaseModel::$db = "new PDO object";
UserModel::create(); 
```

输出

```
Use the static variable: new PDO object 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:36:00.547

正如您所说，有一个 PDO 类，因此您可以轻松地在每个其他类中创建 PDO 类的实例。首先在您需要的任何地方包含 PDO 类

```
require_once'/PDOclass.php'; 
```

然后制作实例

```
$a=new PDAclass; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T12:37:20.123

你说 $db 是在你的包含文件中定义的。所以只需包含该文件，您就可以访问该参数。

# c - 如何使用 char* 复制结构并指向它？

> ID：11816406
> 
> 赞同：0
> 
> 时间：2012-08-05T12:27:10.453
> 
> 标签：c, pointers, struct, duplicates

我是 C 编程的新手，很想得到一些帮助。

我有这个结构：

```
typedef struct house
{
   int numOfRooms;
   char* houseName;
}HOUSE,*pHOUSE; 
```

我想创建一个函数，它获取指向 HOUSE 的指针并返回指向位于内存中不同位置的同一个 HOUSE 的新指针 - 目的是能够更改一个指针而不更改两者：我会尽量清楚：

```
pHOUSE duplicate_house(pHOUSE house)
{
  pHOUSE newh = (pHOUSE)calloc(1,sizeof(HOUSE));
  newh = house 
 //I get here a pointer that points on the same house.. so If I change for exmample:
 //  newh->numOfRooms = 9 - > both will change and I don't want it to happen!

} 
```

我读到我们可以使用：memcpy_s 但在这里如果我在结构中只有整数可能很容易，这里我有 char * ，所以意味着我还需要`char * houseName`单独复制？我能做些什么？如何复制具有多种类型的对象，例如`char *`？如果我有一个数组？我能做什么 ？

```
typedef struct house
{
    int numOfRooms;
     char* houseName;
     struct house *houses[10];
}HOUSE,*pHOUSE; 
```

我怎样才能复制它？

十分感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:33:06.583

您需要复制结构以及结构管理*的*所有内存。像这样：

```
pHOUSE copy(pHOUSE house)
{
    pHOUSE newHouse = malloc(sizeof *newHouse);      // allocate

    if (pHOUSE)
    {
        memcpy(newHouse, house, sizeof *newHouse);   // or "*newHouse = *house;"
        size_t const len = strlen(house->houseName);
        newHouse->houseName = malloc(len + 1);

        if (!newHouse->houseName) { free newHouse; return NULL; }

        strncpy(newHouse->houseName, house->houseName, len + 1);
    }
    return pHOUSE;
} 
```

如您所见，*两次*分配的错误处理已经变得非常麻烦。如果您有多个内部分配，保持理智的唯一方法是`goto`系统地使用 s 来创建适当的清理点。

* * *

举例说明最后一点：

```
struct FooLish
{
    char * p1;
    char * p2;
    char * p3;
};

struct FooLish * copy(struct FooLish const * oldFoo)
{
    struct FooLish * newFoo = malloc(sizeof *newFoo);
    if (!newFoo) { goto end0; }

    {
        size_t const len = strlen(oldFoo->p1);
        newFoo->p1 = malloc(strlen(len + 1);
        if (!newFoo->p1) { goto end1; }
        strncpy(newFoo->p1, oldFoo->p1, len + 1);
    }
    {
        size_t const len = strlen(oldFoo->p2);
        newFoo->p2 = malloc(strlen(len + 1);
        if (!newFoo->p2) { goto end2; }
        strncpy(newFoo->p2, oldFoo->p2, len + 1);
    }
    {
        size_t const len = strlen(oldFoo->p3);
        newFoo->p3 = malloc(strlen(len + 1);
        if (!newFoo->p3) { goto end3; }
        strncpy(newFoo->p3, oldFoo->p3, len + 1);
    }

    return newFoo;

end3:
   free(newFoo->p2);
end2:
   free(newFoo->p1);
end1:
   free(newFoo);
end0:
    return NULL;
} 
```

# c# - 你如何创建静态工厂？

> ID：11816411
> 
> 赞同：1
> 
> 时间：2012-08-05T12:28:29.857
> 
> 标签：c#, design-patterns, factory-pattern

我有一系列希望通过“根”实用程序（对象）公开的工厂对象。这个根实用程序本身就是一个工厂。作为一个实用对象，我希望将它实现为一个静态类。但是，使用我当前的设计是不可能的……因为你不能在接口中实现静态成员。

所以...

我的问题是：我怎样才能改变下面的类来获得上面的静态工厂影响？

**代码如下：**

```
public interface IFactory
{
    I Create<I>();

    IFactoryTransform Transformer { get; }
    IFactoryDataAccess DataAccessor { get; }
    IFactoryValidator Validator { get; }
}

public static class Factory : IFactory
{
    static Factory()
    {

        Transformer = new FactoryTransform();
        DataAccessor = new FactoryDataAccess();
        Validator = new FactoryValidator();
    }

    public I Create<I>()
    {
        var model = typeof(I);

        // Activation code will go here...

        throw new NotSupportedException("Type " + model.FullName + " is not supported.");
    }

    public IFactoryDataAccess DataAccessor { get; private set; }
    public IFactoryTransform Transformer { get; private set; }
    public IFactoryValidator Validator { get; private set; }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T12:42:15.000

您可以将*静态*关键字从`Factory`类移动到上一级。例如，你可以有一个`static class Utils`, 你有一个单例属性`MyFactory`。

```
public static class Utils
{
    public static IFactory MyFactory {get; private set}
    static Utils()
    {  
        MyFactory = new Factory();
    }
}

//usage
var myInterface = Utils.MyFactory.Create<IMyInterfrace>() 
```

* * *

也就是说，我可能会使用 DI 而不是工厂和 IoC 容器来管理对象的生命周期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:32:08.470

静态类不可能从接口继承。我认为你真正想要的是一个单例生命周期工厂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T12:40:57.933

为什么不使用 Microsoft 统一和依赖注入，这比管理自己的静态工厂更好：http: [//msdn.microsoft.com/en-us/library/ff649614.aspx](http://msdn.microsoft.com/en-us/library/ff649614.aspx) 这将是统一框架，将实例化你们都反对

```
IUnityContainer myContainer = new UnityContainer();
FactoryDataAccess da= new FactoryDataAccess();
myContainer.RegisterInstance<IFactoryDataAccess >(da); 
```

当您调用它时，它将使用 FactoryDataAccess 实例：

```
IFactoryDataAccess myServiceInstance = myContainer.Resolve<IFactoryDataAccess >(); 
```

# php - 获取复选框文本值

> ID：11816417
> 
> 赞同：1
> 
> 时间：2012-08-05T12:29:49.003
> 
> 标签：php, mysql, checkbox

我在获取数据库填充复选框的文本值时遇到了一些问题。下面是根据我的查询填充复选框的查询。

```
if (isset($_POST['submitCourseCode'])) { 

    $aElective = $_POST['electiveModules'];
     foreach(array_keys($aElective) as $elec) {
     echo "$elec";
  }
}
echo "<form name=\"psform\" action=\"plotyourcourseGraphpSave.php\" method=\"post\">";
$moduleQuery = "SELECT module.*,group_elective_modules.moduleID 
                FROM module,group_elective_modules 
                WHERE group_elective_modules.courseName = '$courseTitle' 
                AND group_elective_modules.yr = '$year' 
                AND group_elective_modules.moduleID = module.ID ";

$moduleResult = mysql_query($moduleQuery );
while ($row = mysql_fetch_array($moduleResult)) {

   echo "<input type=\"checkbox\" name=\"electiveModules[]\" value=\"{$row['title']}\" /> {$row['title']}<br />";                                                       
}                                                                                                                                   
echo "<input type=\"submit\" name=\"submitCourseCode\" value=\"Submit\" />  
</form>"; 
```

这是屏幕截图 ![在此处输入图像描述](../Images/768173b241834e6acdd5d33a3604571a.png)

选中复选框的结果

![在此处输入图像描述](../Images/b77ad7521067b974a35dab94469de02c.png)

但这就是我想要的

```
Threshold French
French for Reading Purposes I
German Language (Beginner [00] Level)
German Language (Intermediate [05] Level) 
```

因此，当我选择几个复选框并按下提交时，它会传递我选择的复选框的数值，但我想要文本值。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:02:30.960

这是不正确的代码：

```
foreach(array_keys($aElective) as $elec) 
```

因为你使用array_keys，它会得到索引而不是值，它应该是：

`foreach($aElective as $elec)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:10:23.743

```
$aElective = $_POST['electiveModules'];
 foreach( $aElective as $key => $value ) {
    echo "$key: $value";
} 
```

这对你有用吗？

# matplotlib - 从多边形 ROI 获取图像的数组掩码

> ID：11816419
> 
> 赞同：1
> 
> 时间：2012-08-05T12:29:59.167
> 
> 标签：matplotlib, polygon, roi

我正在尝试为 matplotlib imshow（图像）制作多边形 ROI。使用 matplotlib 的事件处理，我可以在图像顶部手动设置多边形 ROI（通过 Line2D 段）。

结果是我的 ROI 的一组边缘坐标（以像素值表示）。有人知道我如何提取 ROI 内的像素值吗？我最终想要的是一个 numpy 掩码（将图像的大小排列为 1 在 ROI 外部的元素处，0 在 ROI 内部的元素处）。

有什么简单的方法可以做到这一点？也许已经有某种图像处理功能能够关闭和填充 ROI 点？

[图片示例： http](http://img707.imageshack.us/img707/186/roi.png) ://img707.imageshack.us/img707/186/roi.png

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:36:12.740

我只是偶然发现了解决方案。

“scikits-image”模块提供了所需的内容。我可以传递多边形坐标，它会给我一个工具来切出图像阵列的 ROI。

示例：[http ://scikits-image.org/docs/dev/auto_examples/plot_shapes.html](http://scikits-image.org/docs/dev/auto_examples/plot_shapes.html)

# sql-server - 删除功能不起作用？

> ID：11816422
> 
> 赞同：0
> 
> 时间：2012-08-05T12:30:25.727
> 
> 标签：sql-server, tsql, sql-server-2008-r2

我正在尝试创建一个函数，并且我已经在数据库中拥有该函数。为了绕过这一点，我使用了 drop 函数，但我仍然不断得到“数据库中已经存在名为 'getCost' 的对象”。可能是什么原因？

询问：

```
USE DWDB_PROPER;
GO
IF OBJECT_ID (N'dbo.getCost', N'TF') IS NOT NULL
DROP FUNCTION dbo.getCost;
GO
CREATE FUNCTION getCost(@person VARCHAR(10), @month TINYINT, @year SMALLINT, @Category    VARCHAR(20))
RETURNS INT 
AS
BEGIN
--function body here 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-05T12:49:18.830

你的是一个标量函数，因为它只返回一个值，所以在 if 子句中你应该提到 FN 而不是 TF.Read [this](http://msdn.microsoft.com/en-us/library/ms177499%28v=sql.90%29.aspx)

```
USE DWDB_PROPER;
GO
IF OBJECT_ID (N'dbo.getCost', N'FN') IS NOT NULL
DROP FUNCTION dbo.getCost;
GO
CREATE FUNCTION getCost(@person VARCHAR(10), @month TINYINT, @year SMALLINT, @Category       VARCHAR(20))
RETURNS INT 
AS
BEGIN
--function body here 
```

您正在返回单个值而不是表。所以 RETURNS int 是一个多选标量函数，其中 Returns Table 是一个表值函数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T12:38:50.510

尝试以下查询：

```
USE DWDB_PROPER;
GO
IF EXISTS (
    SELECT * FROM sysobjects WHERE id = object_id(N'dbo.getCost') 
    AND xtype IN (N'FN', N'IF', N'TF')
)
    DROP FUNCTION dbo.getCost
GO
CREATE FUNCTION getCost(@person VARCHAR(10), @month TINYINT, @year SMALLINT, @Category    VARCHAR(20))
RETURNS INT 
AS
BEGIN 
```

# javascript - 在命名空间中创建自定义事件

> ID：11816423
> 
> 赞同：0
> 
> 时间：2012-08-05T12:30:43.747
> 
> 标签：javascript, jquery

我需要在 javascript NameSpace 中创建自定义事件，但我不知道它是否可能。

我有一个这样的命名空间：

```
NAMESPACE = {

   var1 : 'value',
   var2 : 'value',

   initiate : function() {
      console.log('initiate');
   },

   clear : function(arg) {
      console.log('clear');
   }

   fail : function() {
       // Here i need to trigger the error event..
   }

} 
```

使用此方法创建事件：

```
var myEvent = new CustomEvent("errorX", {
  data: {
    param: "value"
  }
});

document.dispatchEvent(myEvent);

// In document.ready...
$(document).on('errorX', function(e) {
   console.log(e);
}); 
```

这可行，但我需要将其附加`addEventlistener`到，`document`并且我想将其附加到命名空间对象，例如：

```
$(NAMESPACE).on('errorX', function(e) {
    console.log(e);
}); 
```

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:36:09.997

您可以使用以下[`.triggerHandler`](http://api.jquery.com/triggerHandler/)方法：

```
$(NAMESPACE).on('errorX', function(e) {
    console.log(e);
});

$(NAMESPACE).triggerHandler("errorX"); 
```

演示：http: [//jsfiddle.net/Enq9h/](http://jsfiddle.net/Enq9h/)

# git - 了解 Git 和 GitHub 的基础知识

> ID：11816424
> 
> 赞同：204
> 
> 时间：2012-08-05T12:30:51.567
> 
> 标签：git, github

我不完全理解使用 Git 或 Github 的目的；我知道跟踪您的更改会有所帮助，并且对与其他人协作的人很有帮助，但我不与任何人协作，所以我不知道这是否对我有帮助。

我通常作为网页设计师/开发人员工作，但我从来不需要合作。我知道在 Git 中，您可以为每个存储库创建、推送、提交、创建分支等，但是......

1.  Git 和 GitHub 有什么区别？

2.  git 是否将每个存储库都保存在本地（在用户的机器中）和 GitHub 中？

3.  你可以在没有 GitHub 的情况下使用 Git 吗？如果是，使用 GitHub 有什么好处？

4.  Git 与 Time Machine 等备份系统相比如何？

5.  这是一个手动过程吗，换句话说，如果您不提交，您将不会获得所做更改的新版本？

6.  如果不合作并且您已经在使用备份系统，为什么还要使用 Git？

* * *

## 回答 #1

> 赞同：257
> 
> 时间：2012-08-05T21:26:01.887

1.  > Git 和 GitHub 有什么区别？

    Git 是一个版本控制系统；将其视为代码的一系列[快照](http://git-scm.com/figures/18333fig0105-tn.png)（提交）。您会看到这些快照的路径，以及它们的创建顺序。您可以创建分支进行实验并返回您拍摄的快照。

    GitHub 是一个网页，您可以在该网页上发布您的 Git 存储库并与其他人协作。

2.  > Git 是否将每个存储库都保存在本地（在用户的机器中）和 GitHub 中？

    不，它只是本地的。您可以决定在 GitHub 上推送（发布）一些分支。

3.  > 你可以在没有 GitHub 的情况下使用 Git 吗？如果是，使用 GitHub 有什么好处？

    是的，如果你不使用 GitHub，Git 在本地运行。使用 GitHub 的替代方法是在托管在 Dropbox 上的文件上运行 Git，但 GitHub 是一项更加精简的服务，因为它是专为 Git 制作的。

4.  > Git 与 Time Machine 等备份系统相比如何？

    这是另一回事，Git 可以让您跟踪更改和开发过程。如果您将 Git 与 GitHub 一起使用，它实际上会成为备份。但是通常你不会一直推送到 GitHub，如果出现问题，你没有完整的备份。我在与 Dropbox 同步的文件夹中使用 git。

5.  > 这是一个手动过程，换句话说，如果您不提交，您将不会获得所做更改的新版本？

    是的，提交和推送都是手动的。

6.  > 如果不合作并且您已经在使用备份系统，为什么还要使用 Git？

    *   如果您在提交之间遇到错误，您可以使用该命令`git diff`查看当前代码与上次工作提交之间的差异，帮助您定位错误。

    *   您也可以返回到最后一个工作提交。

    *   如果您想尝试更改，但不确定它是否会起作用。您创建一个分支来测试您的代码更改。如果它工作正常，你将它合并到主分支。如果不是，您只需将分支扔掉并返回主分支。

    *   你做了一些调试。在提交之前，您总是查看上次提交的更改。您会看到忘记删除的调试打印语句。

确保检查[gitimmersion.com](http://gitimmersion.com)。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-08-05T12:39:40.040

1.  > Git 和 GitHub 有什么区别？

    Linus Torvalds 会为此杀了你。Git 是他编写的版本管理程序的名称。GitHub 是一个网站，上面有 Git 可管理的源代码存储库。因此，GitHub 与原始的 Git 工具完全无关。

2.  > git 是否将每个存储库都保存在本地（在用户的机器中）和 GitHub 中？

    如果您提交更改，它将存储在本地。然后，如果您推送提交，它也会远程处理它们。

3.  > 你可以在没有 GitHub 的情况下使用 Git 吗？如果是，使用 GitHub 有什么好处？

    你可以，但我确定你不想为自己手动设置一个 git 服务器。GitHub 的好处？好吧，易于使用，很多人都知道它，因此其他人可能会找到您的代码并跟随/分叉它以进行改进。

4.  > Git 与 Time Machine 等备份系统相比如何？

    Git 是专门为源代码设计和优化的。

5.  > 这是一个手动过程吗，换句话说，如果您不提交，您将不会获得所做更改的新版本？

    确切地。

6.  > 如果不合作并且您已经在使用备份系统，为什么还要使用 Git？

    见#4。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2014-05-11T19:54:39.593

1.  > Git 和 GitHub 有什么区别？

    Git 是一个分布式版本控制系统。它通常在本地计算机的命令行上运行。它会在“存储库”（或“repo”）中跟踪您的文件和对这些文件的修改，但仅当您告诉它这样做时。（换句话说，您决定要跟踪哪些文件以及何时拍摄任何修改的“快照”。）

    相比之下，GitHub 是一个允许您在线发布 Git 存储库的网站，出于多种原因，这可能很有用（参见 #3）。

2.  > Git 是否将每个存储库都保存在本地（在用户的机器中）和 GitHub 中？

    Git 被称为[“分布式”（而不是“集中式”）版本控制系统](http://git-scm.com/book/en/Getting-Started-About-Version-Control)，因为您可以在本地运行它并断开与 Internet 的连接，然后随时将您的更改“推送”到远程系统（例如 GitHub）。**因此，仅当您手动**告诉 Git 推送这些更改时，repo 更改才会出现在 GitHub 上。

3.  > 你可以在没有 GitHub 的情况下使用 Git 吗？如果是，使用 GitHub 有什么好处？

    是的，你可以在没有 GitHub 的情况下使用 Git。Git 是实际跟踪您的更改的“主力”程序，而 GitHub 只是托管您的存储库（并提供 Git 中不可用的附加功能）。以下是使用 GitHub 的一些好处：

    *   它提供了文件的备份。
    *   它为您提供了一个可视化界面来导航您的存储库。
    *   它为其他人提供了一种浏览您的存储库的方法。
    *   它使 repo 协作变得容易（例如，多个人为同一个项目做出贡献）。
    *   它提供了一个轻量级的问题跟踪系统。
4.  > Git 与 Time Machine 等备份系统相比如何？

    Git 确实会备份您的文件，尽管它比传统的备份系统对备份的内容和时间提供了更**精细的控制。**具体来说，您每次想要对更改进行快照时都“提交”，并且该提交既包括对更改的描述，也包括这些更改的逐行详细信息。这是源代码的最佳选择，因为您可以轻松地逐行查看任何给定文件的更改历史记录。

5.  > 这是一个手动过程，换句话说，如果您不提交，您将不会获得所做更改的新版本？

    是的，这是一个手动过程。

6.  > 如果不合作并且您已经在使用备份系统，为什么还要使用 Git？

    *   Git 采用了一个强大的[分支系统](http://git-scm.com/book/en/Git-Branching)，允许您同时处理多个独立的开发线，然后根据需要将这些分支合并在一起。
    *   Git 允许您逐行查看文件不同版本之间的差异，这使故障排除更加容易。
    *   Git 强制你描述你的每一个提交，这使得追踪给定文件的特定先前版本（并可能恢复到先前版本）变得更加容易。
    *   如果您在代码方面需要帮助，让 Git 跟踪并托管在 GitHub 上可以让其他人更轻松地查看您的代码。

对于 Git 入门，我推荐在线书籍[Pro Git](http://git-scm.com/book)以及[GitRef](http://gitref.org/)作为方便的参考指南。对于 GitHub 入门，我喜欢[GitHub 的 Bootcamp](https://help.github.com/categories/54/articles)和他们的[GitHub Guides](https://guides.github.com/)。最后，我制作了一个短[视频系列](https://www.youtube.com/playlist?list=PL5-da3qGB5IBLMp7LtN8Nc3Efd4hJq0kD)，向初学者介绍 Git 和 GitHub。

# jquery - 添加单个查询字符串和查询数组以形成

> ID：11816425
> 
> 赞同：0
> 
> 时间：2012-08-05T12:31:05.643
> 
> 标签：jquery

我的网站[http://www.example.com上有一个非常简单的表格](http://www.example.com)

```
<form>
    <input type="text" value="" name="name">
</form> 
```

如何让我的表格看起来像这样

```
<form>
    <input type="text" value="tom" name="name">
</form> 
```

如果我输入（或用户从搜索页​​面转到此页面）[http://www.example.com?name=tom](http://www.example.com?name=tom)

请记住，在某些时候我的表格可能看起来像这样。

```
<form>
    <input type="text" value="" name="name[]">
    <input type="text" value="" name="name[]">
    <input type="text" value="" name="name[]">
    <input type="text" value="" name="name[]">
</form> 
```

所以我也想处理一组名称。我看过[jQuery.param()](http://api.jquery.com/jQuery.param/)但无法理解我将如何做到这一点。是否可以不提交服务器端语言（例如 php）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:53:34.867

没有内置的 jQuery 方法可以从查询字符串到 javascript 变量中获取名称/值对（但是，不应该有吗？？）

但是人们已经为您编写了纯 JavaScript 函数： [如何在 JavaScript 中获取查询字符串值？](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript).

如果您使用[Andy E](https://stackoverflow.com/users/94197/andy-e)对上述问题的第二个答案，您可以将所有查询字符串变量捕获为 javascript 对象的名称-值对。这是他写的：

```
var urlParams = {};
(function () {
    var match,
        pl     = /\+/g,  // Regex for replacing addition symbol with a space
        search = /([^&=]+)=?([^&]*)/g,
        decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
        query  = window.location.search.substring(1);

    while (match = search.exec(query))
       urlParams[decode(match[1])] = decode(match[2]);
})(); 
```

然后使用这些设置输入的表单值，其名称与使用 jQuery 的查询字符串名称相同，如下所示：

```
$.each(urlParams, function(key, value){
    $('form [name=' + key + ']').val(value);
}); 
```

**更新：**因为这很难在 jsFiddle 中测试，所以这里有一个完整的网页作为一个工作示例。它会将值“a”、“b”和“c”替换为 url 传入的值（“1”、“2”和“3”）——只需将其设置为 localhost 上的 test.html并转到：`[http://localhost/test.html?a=1&b=2&c=3](http://localhost/test.html?a=1&b=2&c=3)`

```
<!DOCTYPE html>
<html><head><title>Test URL params</title>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" >
    $(function(){
            var urlParams = {};
            (function () {
                var match,
                pl     = /\+/g,  // Regex for replacing addition symbol with a space
                search = /([^&=]+)=?([^&]*)/g,
                decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
                query  = window.location.search.substring(1);

                while (match = search.exec(query))
                   urlParams[decode(match[1])] = decode(match[2]);
            })();

            $.each(urlParams, function(key, value){
                $('form [name=' + key + ']').val(value);
            });
    });
</script>

</head>
<body>

<form>
    <input name="a" value ="a" /><input name="b" value ="a" /><input name="c" value ="a" />
</form>

</body></html> 
```

# python - python中的setuptools错误

> ID：11816428
> 
> 赞同：3
> 
> 时间：2012-08-05T12:31:44.760
> 
> 标签：python, python-3.x, setuptools

我是 python 新手，我正在安装 python 包，但我收到了这个错误

```
Error:
    Traceback (most recent call last):
      File "setup.py", line 3 in <module>
        from setuptools import setup, find_packages
    ImportError: No module named setuptools 
```

但是当我安装 setuptools 并运行它时，我得到了这个错误

```
Traceback (most recent call last):
  File "C:/Python32/yyy.py", line 7, in <module>
    execfile(convert_path('setuptools/command/__init__.py'), d)
NameError: name 'execfile' is not defined 
```

我是 Windows 7 用户。如果有任何人对此有经验，请弄清楚这是什么意思解压缩档案，进入 pyserial-xy 目录并运行？意味着我必须从命令提示符安装它

我想在 python 中使用 twitter api。当我运行它的安装文件时，它显示错误。我用记事本打开它并复制设置代码并将其粘贴到脚本中并用 yyy.py 保存并运行它现在它给了我这样的错误

```
File "C:\Python26\twittersetup.py",
line 13, in <module> 
long_description=open("./README", "r").read(), 
IOError: [Errno 2] No such file or directory: './README' 
```

python 3.2中的这个错误器

```
File "C:/Python32/t.py",
line 9, in <module> 
setup(name='twitter',
NameError: name 'setup' is not defined 
```

现在经过多次生存后我得到了这个错误

```
Traceback (most recent call last):
File "C:\Users\Sheikh\Desktop\twitter-1.9.0 (1).tar\twitter-1.9.0\setup.py",
line 47, 
in <module>""",File "C:\Python32\lib\distutils\core.py",
line 136, in setup
raise SystemExit(gen_usage(dist.script_name) + "\nerror: %s" % msg)
SystemExit: usage: setup.py [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]
or: setup.py --help [cmd1 cmd2 ...]
or: setup.py --help-commands
or: setup.py cmd --help
error: no commands supplied 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:38:58.733

`execfile()`只能在 Python 2 中使用`exec()`，在 Python 3 中使用

从[http://pypi.python.org/pypi/setuptools/](http://pypi.python.org/pypi/setuptools/)很明显，`setuptools`它只适用于 python `2.3, 2.4, 2.5, 2.6 and 2.7`，所以最好将它安装在其中一个而不是 3.x 上。

阅读[Python 3.2+ 中的](https://stackoverflow.com/questions/6357361/alternative-to-execfile-in-python-3-2)[替代方案？`execfile`](https://stackoverflow.com/questions/6357361/alternative-to-execfile-in-python-3-2)

* * *

**编辑：** Setuptools 现在支持 Python 3.3+。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T12:47:44.080

`setuptools`似乎不支持 python 3（至少根据 Python 包索引）。

尝试`distribute`提供`setuptools`api 并提供 python3 兼容性： http: [//pypi.python.org/pypi/distribute](http://pypi.python.org/pypi/distribute)

它看起来`python-twitter`不支持 python3，所以你必须使用 Python 2.6。

2.6 的错误信息非常清楚：

```
"C:\Python26\twittersetup.py", line 13, in <module> long_description=open("./README", "r").read(), IOError: [Errno 2] No such file or directory: './README') 
```

基本上，您试图从包含 README 文件的目录之外的另一个目录运行脚本。

我会重新开始，并确保您首先下载并解压缩完整的源代码：http `python-twitter`: [//pypi.python.org/packages/source/p/python-twitter/python-twitter-0.8.2.tar.gz](http://pypi.python.org/packages/source/p/python-twitter/python-twitter-0.8.2.tar.gz)

接下来，解压缩并解压源代码（[7-Zip 非常](http://www.7-zip.org/)适合此操作）。

然后打开`cmd`并`cd`进入解压后的目录（其中应包括 README 文件和 setup.py 文件）。然后运行类似：

```
C:\Python2.6\python2.6.exe setup.py 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T20:00:03.933

首先，您需要从 pypi 安装 setuptools，然后您需要使用 cmd 通过命令运行 setup.py 文件。在 Windows 中使用 setup.py --help-commands 会告诉您步骤和命令。

# javascript - 如何在 DIV 中添加 html5 画布

> ID：11816431
> 
> 赞同：7
> 
> 时间：2012-08-05T12:32:06.863
> 
> 标签：javascript, html, canvas

我正在使用下面的代码生成一个`canvas`. 目前它将画布元素添加到 中`body`，我怎样才能让它添加到一个`div`名为“divGameStage”，它不嵌套在任何其他元素中，除了`body`.

编辑：我尝试了第一个建议，但没有出现画布，完整代码如下：

```
<head>
<meta charset="utf-8">
<title>Game Stage</title>
<script type="text/javascript">
    function loadCanvas(id) {
        var canvas = document.createElement('canvas');
        div = document.getElementByID(id); 
        canvas.id     = "CursorLayer";
        canvas.width  = 1224;
        canvas.height = 768;
        canvas.style.zIndex   = 8;
        canvas.style.position = "absolute";
        canvas.style.border   = "1px solid";
        div.appendChild(canvas)
    }
        </script>
</head>
<body>
<header>
    <h1>The most important heading on this page</h1>
    <p>With some supplementary information</p>
</header>
<div id="divControls"></div>
<div id="divGameStage"></div>
<script type="text/javascript">
    loadCanvas(divGameStage);
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-06T07:52:26.930

试试这个代码，肯定会为你工作：

```
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>Game Stage</title>
<script type="text/javascript">
    function loadCanvas(id) {
        var canvas = document.createElement('canvas');
        div = document.getElementById(id); 
        canvas.id     = "CursorLayer";
        canvas.width  = 1224;
        canvas.height = 768;
        canvas.style.zIndex   = 8;
        canvas.style.position = "absolute";
        canvas.style.border   = "1px solid";
        div.appendChild(canvas)
    }
</script>
</head>
<body>
<header>
    <h1>The most important heading on this page</h1>
    <p>With some supplementary information</p>
</header>
<div id="divControls"></div>
<div id="divGameStage"></div>
<script type="text/javascript">
    loadCanvas("divGameStage");
</script>
</body>
</html> 
```

请记住以下几点：

*   错误 1 ​​是 loadCanvas("divGameStage"); 中缺少引号
*   错误 2 是语法错误 div = document.getElementById(id); “..ID(id)”在您的代码中。

如果那么它也不起作用，那么我确定您正在 Internet Explorer 上对其进行`(specially < IE9)`
测试

干杯！！！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-05T12:38:38.500

您只需将其附加到您的`<div>`而不是正文中：

```
<script type="text/javascript">
    function loadCanvas(id) {
        var canvas = document.createElement('canvas'),
            div = document.getElementById(id);
        canvas.id     = "canvGameStage";
        canvas.width  = 1000;
        canvas.height = 768;
        canvas.style.zIndex   = 8;
        canvas.style.position = "absolute";
        canvas.style.border   = "1px solid";
        div.appendChild(canvas);
    }
    /* ... */
    loadCanvas("divGameStage");
</script> 
```

很简单:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-05T12:42:58.147

```
<script type="text/javascript">
    function loadCanvas() {
        var canvas = document.createElement('canvas');
        canvas.id     = "canvGameStage";
        canvas.width  = 1000;
        canvas.height = 768;
        canvas.style.zIndex   = 8;
        canvas.style.position = "absolute";
        canvas.style.border   = "1px solid";
        var div = document.createElement("div");
        div.className = "divGameStage";
        div.appendChild(canvas);
        document.body.appendChild(div)
    }
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T19:11:27.563

这里唯一的问题是：

```
loadCanvas(divGameStage); 
```

用引号`divGameStage`括起来：

```
loadCanvas("divGameStage"); 
```

因为它需要是一个字符串才能运行`getElementById`。

# mysql - Mysql存储过程报错1064

> ID：11816434
> 
> 赞同：0
> 
> 时间：2012-08-05T12:32:25.490
> 
> 标签：mysql, stored-procedures

我正在处理一些代码，并陷入了这个存储过程问题......现在花了太长时间看它，所以请如果有人能告诉我我在哪里是一个菜鸟。

我收到以下错误：

> 错误代码：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 '@ownerid varchar(50); 附近使用的正确语法；声明@active tinyint；声明@subuser tinyint；设置 ' 在第 4 行

在这段代码上：

```
 DELIMITER //

USE `test`//

DROP PROCEDURE IF EXISTS `getAccount`//

CREATE DEFINER=`peter`@`%` PROCEDURE `getAccount`( IN cid VARCHAR(20))
BEGIN
    DECLARE cardid VARCHAR(50);
    DECLARE @ownerid VARCHAR(50);
    DECLARE @active TINYINT;
    DECLARE @subuser TINYINT;
    SET cardid = MD5( cid + SHA1(cid + 'a salt value'));

    SELECT @active = active, @ownerid = ownerid, @subuser = subuser FROM cards_tbl WHERE cardhash = cardid;

    IF @active = 1 THEN
        IF @subuser = 1 THEN
            SELECT subuser_m2s_tbl.name,subuser_m2s_tbl.image, user_saldo.saldo AS credits FROM subuser_m2s_tbl 
            JOIN user_saldo ON subuser_m2s_tbl.subhash = user_saldo.userhash 
            WHERE subuser_m2s_tbl.subhash = @ownerid;
        ELSE
            SELECT user_m2s_tbl.name,user_m2s_tbl.image, user_saldo.saldo AS credits FROM user_m2s_tbl 
            JOIN user_saldo ON user_m2s_tbl.userhash = user_saldo.userhash 
            WHERE user_m2s_tbl.userhash = @ownerid; 
        END IF;
    END IF; 
    END$$

DELIMITER ; 
```

我是存储过程的新手，所以它非常简单......提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T06:29:23.203

当您想在 SELECT 语句中将值传递给变量时，您应该使用 ':=' 而不是 '='，否则 MySQL 只会与操作数进行比较。

```
SELECT
  active_var := active, ownerid_var := ownerid, subuser_var := subuser
FROM
  cards_tbl
WHERE
  cardhash = cardid; 
```

您也可以使用 SELECT INTO 语句，例如 -

```
SELECT
  active, ownerid, subuser
INTO
  active_var, ownerid_var, subuser_var
FROM
  cards_tbl
WHERE
  cardhash = cardid; 
```

[选择语法](http://dev.mysql.com/doc/refman/5.1/en/select.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:38:06.547

是不是缺少了@

```
DECLARE cardid VARCHAR(50);

...

DECLARE @cardid VARCHAR(50); 
```

# javascript - 如何更改div中的文本

> ID：11816436
> 
> 赞同：0
> 
> 时间：2012-08-05T12:32:42.067
> 
> 标签：javascript

动态生成的网页中有如下所示的元素：

```
<div class="Lore Ipsum">foo bar</div>  
<div class="Lore Ipsum">ham spam</div> 
```

我想在文本之后看到一些注释，如下所示：

```
foo bar - Wrong  
ham spam - Right 
```

如何获取这些元素并添加评论？
提前致谢。

注意：我不是上述页面的作者，所以我不能编辑来源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:45:34.683

这是一种方法：

```
​var divs = document.getElementsByTagName('div');

for (var i=0, len=divs.length; i<len; i++){
    var current = divs[i];
    if (current.className == 'Lore Ipsum') {
        switch (current.firstChild.nodeValue) {
            case 'foo bar':
                current.firstChild.nodeValue += '- wrong';
                break;
            case 'ham spam':
                current.firstChild.nodeValue += '- right';
                break;
        }
    }
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/3r3bj/)。

然而，这种方法是基于我必须做出的一些假设，因为问题中缺乏细节以及所写的 HTML。这些假设是：

1.  您只想检查这些`div`元素的文本内容，并使用两者的类*（**并且* 这些类名将*始终*按该顺序排列），`Lore` *`Ipsum`*
***   并且您要检查的文本将始终是您要检查`firstChild`的`div`元素。**

 *** * *

修改了上面的代码以使类名的顺序不重要：

```
var divs = document.getElementsByTagName('div');

for (var i=0, len=divs.length; i<len; i++){
    var current = divs[i],
        cName = current.className;
    if (cName.indexOf('Lore') > -1 && cName.indexOf('Ipsum') > -1) {
        switch (current.firstChild.nodeValue) {
            case 'foo bar':
                current.firstChild.nodeValue += ' - wrong';
                break;
            case 'ham spam':
                current.firstChild.nodeValue += ' - right';
                break;
        }
    }
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/3r3bj/1/)。

再次修改，以回应Shadow Wizard的准确评论（答案下方）：

> 如果 div 内容中有空格，它将不起作用。[示例](http://jsfiddle.net/3r3bj/2/)- 也许添加一个函数来检索第一个非空子？

出于比较的目的，使用`trim()`从 中删除前面和后面的空格，所以现在应该等于：`nodeValue``foo bar``foo bar`

```
var divs = document.getElementsByTagName('div');

for (var i=0, len=divs.length; i<len; i++){
    var current = divs[i],
        cName = current.className;
    if (cName.indexOf('Lore') > -1 && cName.indexOf('Ipsum') > -1) {
        switch (current.firstChild.nodeValue.trim()) {
            case 'foo bar':
                current.firstChild.nodeValue += ' - wrong';
                break;
            case 'ham spam':
                current.firstChild.nodeValue += ' - right';
                break;
        }
    }
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/3r3bj/3/)。

参考：

*   [`getElementsByTagName()`](https://developer.mozilla.org/en/DOM/element.getElementsByTagName).
*   [`node.firstChild`](https://developer.mozilla.org/en-US/docs/DOM/Node.firstChild).
*   [`node.nodeValue`](https://developer.mozilla.org/en-US/docs/DOM/Node.nodeValue).
*   [`switch`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/switch).
*   [`trim()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/Trim).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T12:39:05.610

摆脱了ID概念。这太难以维护了。

```
​&lt;div class="lore">Foo Bar</div>
<div class="lore">Ham Spam</div>
<div class="lore">Pina Colada</div>​​​​​​​​​​​​​​​​​​​​​ 
```

Javascript

```
​​var elements = document.getElementsByClassName("lore");
for(i=0;i<=elements.length;i++) {
    content = elements[i].innerHTML;
    switch(content) {
        case "Foo Bar" :
            elements[i].innerHTML = content+ " - Wrong";
            break;
        case "Ham Spam" :
            elements[i].innerHTML = content + " - Right";
            break;
        default : 
            elements[i].innerHTML = content + " - What?";
    }            
} 
```

要在更过时的浏览器中使用 getElementsByClassName，例如旧版本的 IE……实际上只有 IE，您始终可以使用 Robert Nyman 方法

[http://robertnyman.com/2008/05/27/the-ultimate-getelementsbyclassname-anno-2008/](http://robertnyman.com/2008/05/27/the-ultimate-getelementsbyclassname-anno-2008/)

我还注意到有人提到这是动态内容，这意味着它可能在调用 onLoad 事件之后出现。

如果是这种情况，请将其全部变成一个函数，然后使用 HTML 组件（如按钮或锚标记）来调用该函数

HTML

```
<div class="lore">Foo Bar</div>
<div class="lore">Ham Spam</div>
<div class="lore">Pina Colada</div>

<button onclick="validate()">Validate</button> 
```

JavaScript

```
window.validate = function() {
    var elements = document.getElementsByClassName("lore");
    for (i = 0; i <= elements.length; i++) {
        content = elements[i].innerHTML;
        switch (content) {
        case "Foo Bar":
            elements[i].innerHTML = content + " - Wrong";
            break;
        case "Ham Spam":
            elements[i].innerHTML = content + " - Right";
            break;
        default:
            elements[i].innerHTML = content + " - What?";
        }
    }
} 
```

​</p>

[http://jsfiddle.net/S5VBh/1/](http://jsfiddle.net/S5VBh/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T12:44:42.683

如果您希望根据 HTML 内容添加不同的 HTML，那么您可以遍历元素并搜索每个元素的 innerHTML 并进行相应修改。

```
var els = document.getElementsByClassName("Lore Ipsum");
for(var i in els)
{
    switch(els[i].innerHTML){
        case "foo bar":
els[i].innerHTML = els[i].innerHTML + " - Wrong";
 break;
 case "ham spam":
els[i].innerHTML = els[i].innerHTML + " - Right";
 break;            
    };

}​ 
```

看这个活生生的例子。

[http://jsfiddle.net/MgUJK/](http://jsfiddle.net/MgUJK/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T12:49:07.987

您可以使用[document.getElementsByClassName](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByClassName)来获取相关元素并向它们附加一些文本。例如：

```
<div class="lorem_ipsum">foo bar</div>  
<div class="lorem_ipsum">ham spam</div> 
```

```
var divs = document.getElementsByClassName('lorem_ipsum');

for (var i=0; i<divs.length; i++) {
    var content = divs[i].innerHTML;
    if (content == "foo bar")
        content += " - Wrong";
    else if (content == "ham spam")
        content += " - Right";

    divs[i].innerHTML = content;
} 
```

浏览器对`getElementsByClassName`不同的支持。大多数现代浏览器都支持它并返回[NodeList](https://developer.mozilla.org/en-US/docs/DOM/NodeList)或[HTMLCollection](https://developer.mozilla.org/en-US/docs/DOM/HTMLCollection)。两者都有一个属性`length`并公开它们的元素以与括号表示法 ( `[]`) 一起使用。

要获得完全的跨浏览器兼容性，需要一些技巧。在需要支持旧浏览器的情况下，建议使用 JavaScript 框架（如[jQuery](http://jquery.com/)）。

使用 jQuery，上述内容变得微不足道：

```
$('.lorem_ipsum').each(function() {
    content = $(this).text();
    if (content == "foo bar")
        content += " - Wrong";
    else if (content == "ham spam")
        content += " - Right";

    $(this).text(content);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T12:34:55.177

用jQuery

```
$('#idname').html( 'some text' ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-05T12:37:44.397

您需要执行以下操作：

1.  您需要更改其内容的每个**div都应该有一个 ID。**所以你会这样写 div 标签：

2.  使用简单的 Javascript 并像这个例子一样修改内容。

    document.getElementById('MyDiv').innerHTML = 'foo bar - 错误或其他';

希望这可以帮助。**

# xml - 如何在 XQUERY 1.0 FLOWR 中解决这个自动增量 var 案例？

> ID：11816437
> 
> 赞同：1
> 
> 时间：2012-08-05T12:32:53.503
> 
> 标签：xml, xpath, for-loop, xquery

伪代码类似于：

```
 let $myNode as node() := $node 
 for $subpath in tokenize($path,'/')
 $myNode := $myNode/*[name()=$subpath] (: Here is the invalid line :) 
```

我知道在 xQuery 3.0 中有一个运算符，我要求 xQuery 1.0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T13:35:21.983

没有*XQuery 2.0 ，但是无论版本如何，仅使用**FLWOR*表达式都不可能实现您想要做的事情。当前节点集必须在迭代之间更新，这不是*FLWOR*表达式的工作方式。

**也就是说，使用XQuery 1.0**中的递归函数可以轻松实现您想要做的事情：

```
declare function local:path(
  $context as node()*,
  $steps as xs:string*
) as node()* {
  if(empty($steps)) then $context
  else local:path(
    $context/*[name() = $steps[1]],
    $steps[position() gt 1]
  )
}; 
```

你可以用 `local:path(document{ <x><y>foo</y><z/></x> }, tokenize("x/y", '/'))`.

在**XQuery 3.0**中，它甚至更容易做到，无需新的顶级函数：

```
fn:fold-left(
  function($context, $step) {
    $context/*[name() eq $step]
  },
  document{ <x><y>foo</y><z/></x> },
  tokenize('x/y', '/')
) 
```

The function [fn:fold-left(..)](http://www.w3.org/TR/xpath-functions-30/#func-fold-left) takes care of the recursion internally and you only have to specify how to modify the context set in each step.

# microformats - 使用微格式的多个办公室/地点

> ID：11816443
> 
> 赞同：2
> 
> 时间：2012-08-05T12:33:47.490
> 
> 标签：microformats

我目前正在开发一个网站，我想知道如何使用**Microformats****标记多个办公室**/位置。

 **目前，我们有**两个办事处**（一个在新南威尔士州悉尼和华盛顿珀斯），每个办事处都有各自的电话号码、姓名（即悉尼办事处）和位置。

我尝试关注 Microformats.org 上关于标记多个地址的文章，但看到我也有多个电话号码，我遇到了一些困境。

这是我目前拥有的（只需添加相应的电话号码和办公室名称）

```
<div class="vcard">
    <span class="fn org">
        <span class="value-title" title="Company Name"></span>
    </span>

    <div class="adr">
        <div class="street-address">20 Acme Road,</div>
        <span class="locality">Paddington</span>,
        <span class="region">NSW</span>
        <span class="postal-code">2021</span>
    </div>

    <div class="adr">
        <div class="street-address">220 Foo Road,</div>
        <span class="locality">Subiaco</span>,
        <span class="region">WA</span>
        <span class="postal-code">6008</span>
    </div>
</div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T20:17:07.043

对于 org，您想使用单独的组织单位，如下所示：

```
<div class="vcard">
    <span class="fn 组织名称">
        <span class="value-title" title="公司名称">公司名称</span>
    </span>

    <div class="adr 组织单位">
        <div class="street-address">Acme 路 20 号，</div>
        <span class="locality">帕丁顿</span>,
        <span class="region">新南威尔士州</span>
        <span class="postal-code">2021</span>
    </div>

    <div class="adr 组织单位">
        <div class="street-address">富路220号，</div>
        <span class="locality">Subiaco</span>,
        <span class="region">西澳</span>
        <span class="postal-code">6008</span>
    </div>
</div>

```

你可以在这里验证/确保正确的结果：http: [//hcard.geekhood.net/](http://hcard.geekhood.net/)

至于多个电话号码，我会应用相同的理论。我知道电话号码有不同的`type`属性。**

# java - Java中的感叹号是什么意思？

> ID：11816444
> 
> 赞同：7
> 
> 时间：2012-08-05T12:33:59.920
> 
> 标签：java

我想确认`!=`控制语句中布尔表达式之前的含义是相反的：

例如：

```
if (!networkConnected()) 
```

这是否意味着“如果网络未连接”？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-05T13:00:06.433

是的，这确实意味着逻辑上的相反。它甚至适用于***等于***运算符。

假设你的方法返回一个基本的 bool 类型

```
// means the Network is NOT connected
if (!NetworkConnected()) 
```

这相当于

```
if (NetworkConnected() != true) 
```

所以逻辑上意味着

```
if (NetworkConnected() == false) 
```

现在假设您的方法返回一个布尔值（实际上是一个真实的对象），这意味着

```
// means the Network is NOT connected
if (! Boolean.TRUE.equals(NetworkConnected()); 
```

或者

```
if (Boolean.FALSE.equals(NetworkConnected()); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-05T12:35:11.870

是的，这是布尔否定

所以

```
true == true
!true == false
!!true == true
!!!true == false 
```

同样与 false

```
!false == true 
```

这个一元运算符的实际名称是`Logical Complement Operator`反转布尔值的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T12:35:09.030

是的。感叹号否定出现在它旁边的布尔值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-04T10:41:42.130

准确回答您的问题：**不**。这个运算符`!=`不是否定的。它意味着`NOT IDENTICAL`并且与它的对立面`==`代表身份。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-04T11:31:28.090

`!`是切换表达式的布尔值的一元运算符。

考虑以下代码：

```
boolean b = true;

System.out.println(!b); // outputs: false
System.out.println(!!b); // outputs: true

b = !b; // first switch: b is false now
b = !b; // second switch: b is true now 
```

所以：

> 这是否意味着“如果网络未连接”？

是的！

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-08-19T09:15:07.163

在java中，感叹号（`!`）用于反转值，也称为布尔否定运算符（`!=`不[等于](http://www.tutorialspoint.com/java/java_basic_operators.htm)）。

> 例子：if(string variable!=null) 这里检查string variable是否为null。null表示block没有被执行，否则会被执行。

# clojure - 传递给的 args (0) 数量错误：PersistentHashMap

> ID：11816446
> 
> 赞同：5
> 
> 时间：2012-08-05T12:34:41.737
> 
> 标签：clojure

我对 Clojure 很陌生，并且正在尝试通过移植我的代码之一来学习它，但是我目前遇到了以下问题：

```
=> lineup
{:c b4|b4|b3|b3, :sg b6|b11|b6|b6, :sf b7|b5|b5|b5, :pf b3|b1|b1|b1, :pg b10|b10|b11|b10}
=> (validate-lineup lineup)
ArityException Wrong number of args (0) passed to: PersistentHashMap  clojure.lang.AFn.throwArity (AFn.java:437) 
```

这是功能：

```
(defn validate-lineup [lineup]
    (map (fn [position]
        ((hash-map (position 0)
            (map
                (fn [s] (.substring s 1))
                (str/split (position 1) #"\|"))
                ))
        ) lineup)) 
```

我正在尝试产生类似以下结果：

```
{:c {"4" "4" "3" "3"} :sg {"6" "11" "6" "6"} :sf {"7" "5" "5" "5"} ... } 
```

感谢您的帮助，如果我没有以正确的“Lisp”方式编写，请教我如何。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-05T13:12:10.010

你的主要问题在这里：

```
(fn [position]
  ((hash-map (position 0)
             (map
               (fn [s] (.substring s 1))
               (str/split (position 1) #"\|"))))) 
```

您创建哈希映射，然后将其作为函数调用（注意 之前的双括号`hash-map`）。你可以删除它并得到这个：

```
(fn [position]
  (hash-map (position 0)
             (map
               (fn [s] (.substring s 1))
               (str/split (position 1) #"\|")))) 
```

这种方式`validate-lineup`将返回

```
({:c ("4" "4" "3" "3")} 
 {:sg ("6" "11" "6" "6")} 
 {:sf ("7" "5" "5" "5")} 
 {:pf ("3" "1" "1"` "1")} 
 {:pg ("10" "10" "11" "10")}) 
```

但是您需要单个地图，而不是一系列地图。您可以合并它们：

```
(apply merge (validate-lineup lineup)) 
```

一些建议：

使用`subs`而不是`.substring`：迭代地图时`(fn [s] (subs s 1))`
使用[解构](http://blog.jayfields.com/2010/07/clojure-destructuring.html)

```
(fn [[key value]]
  (hash-map key
             (map
               (fn [s] (subs s 1))
               (str/split value #"\|")))) 
```

有一种巧妙的方法可以使用[into](http://clojuredocs.org/clojure_core/clojure.core/into)函数从对向量创建映射。因此，您可以转换`lineup`为对的向量，其中对的第一项是键，第二项是数字列表：

```
(defn validate-lineup [lineup]
  (into {} (map (fn [[key value]]
                    [key
                     (map #(subs s 1) (str/split value #"\|"))])
             lineup))) 
```

[您可以通过re-seq](http://clojuredocs.org/clojure_core/clojure.core/re-seq)解析`b4|b4|b3|b3`为数字序列：

```
user=> (re-seq #"\d+" "b1|b2|b3")
("1" "2" "3") 
```

最后，您可以将外部替换`map`为[for](http://clojuredocs.org/clojure_core/clojure.core/for)宏：

```
(defn validate-lineup [lineup]
  (into {} (for [[key value] lineup]
                [key (re-seq #"\d+" value)]))) 
```

# gwt - 在 GWT 应用程序中，如何保护我的地点和活动免受未经授权的用户的攻击？

> ID：11816450
> 
> 赞同：2
> 
> 时间：2012-08-05T12:34:55.097
> 
> 标签：gwt, security, gwt-rpc, gwt-2.4

我有一个 GWT 应用程序，它使用活动和地点模式来导航我的应用程序中的不同位置。在应用程序中有只有授权用户才能查看的地方。

授权机制如下：

1-用户输入用户名+密码

2-使用提供的密码检查服务器是否有此类用户。

3-在包含 SID、用户名和过期日期的数据存储中添加令牌（我使用的是 GAE bwt）

4-将令牌发送给客户端。

现在，在我允许用户去地方之前，我应该检查他/她是否被授权，通过检查他/她的令牌是否有效，即以前通过授权操作保存在商店中。我最终得到了一些像这样的 ActivityMapper。

```
public class ApplicationActivityMapper implements ActivityMapper {

  private ActionDispatcherServiceAsync service;

  private SecurityTokenProvider provider;
  private HashMap<Class<? extends Place>, ActivityPlaceMeta> placesActivitiesMap;

  @Inject
  public ApplicationActivityMapper(ActionDispatcherServiceAsync service, SecurityTokenProvider provider, HashMap<Class<? extends Place>, ActivityPlaceMeta> placesActivitiesMap) {

    this.service = service;

    this.provider = provider;

    this.placesActivitiesMap = placesActivitiesMap;

    this.placesActivitiesMap.put(PlaceNotFoundPlace.class, new ActivityPlaceMeta() {
      @Override
      public Activity getActivity(Place place) {
        return new PlaceNotFoundActivity();
      }
    });
  }

  @Override
  public Activity getActivity(Place place) {

    if (place instanceof SecuredPlace) {
      Token token = provider.getToken();
      service.dispatch(new CheckAuthorizationAction(token), new GotResponse<CheckAuthorizationResponse>() {
        @Override
        public void gotResponse(CheckAuthorizationResponse result) {
          if (result.isAuthorized()) {
            //here comes tht problem .... !!! 
            //how to return the place ???
          }
        }
      });
    }

    ActivityPlaceMeta returnedActivity = placesActivitiesMap.get(place.getClass());

    if (returnedActivity == null) {
      return placesActivitiesMap.get(PlaceNotFoundPlace.class).getActivity(new PlaceNotFoundPlace());
    }
    return returnedActivity.getActivity(place);
  }
} 
```

还有其他想法吗？预先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T17:46:12.433

对于 GWT 应用程序，它不是要保护 UI 的一部分，而是要保护提供特定位置所需数据的服务器端。

如果某个用户去一个需要登录的地方，只需让远程服务无法提供任何数据。然后您的演示者应该处理失败并可能重定向到登录位置。

当然，如果用户未登录，您可能希望限制客户端中的导航，您可以在活动映射器中这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T11:31:43.417

将您的 main 包装`ActivityMapper`在[FilteredActivityMapper](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/activity/shared/FilteredActivityMapper.html)中。然后在提供给其构造函数的[过滤器](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/activity/shared/FilteredActivityMapper.Filter.html)中执行您的身份验证/授权检查并返回，例如`LoginFormPlace`，如果没有用户登录。

# joomla - Joomla 2.5。阻止模块显示在文章页面上

> ID：11816453
> 
> 赞同：0
> 
> 时间：2012-08-05T12:35:26.053
> 
> 标签：joomla, joomla2.5, joomla-module

我用于显示类别内容的模块有问题。该模块设置为显示在此类别中，但是当我打开同样属于同一类别的文章时，它也会显示...

我想要的是只显示没有这个模块的文章和模块只在文章的类别上可见。

我知道如果我将每篇文章都添加到网站上任何地方都没有显示的新菜单中，这是可以实现的，但这是太多的工作并且使我的编辑变得复杂。我希望可以在不将每篇文章都添加到菜单的情况下实现这一点......

谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-06T03:29:54.193

没有名为“高级菜单管理器”的工具、应用程序、插件或组件但是有一个名为“高级**模块**管理器”的插件，这在 Joomla 2.5 上也有同样的问题。

我将其设置为不在文章或类别页面上显示某些模块，但模块仍然出现。

这是我的印象，因为该文章属于在 j 2.5 之前的 joomla 版本中创建的类别中

由于 J2.5 不再对类别使用相同的结构，它仍然以某种方式选择错误的菜单 ID。

此刻，我仍在解决这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:20:21.923

你应该编辑模块的代码（如果它是你的）或覆盖它的视图（如果它是核心）并开始它：

```
if (JRequest::getVar('view','')=='blog') { 
```

作为我在一个相当复杂的站点上使用的替代方案，在模板级别进行此检查并基于此输出两个不同的模块位置，即sidebar-blog 和sidebar-article。

然后，您将复制一些模块（如果您希望它们同时出现在博客和文章页面上），但这是一个非常简单的修复并且需要很少的编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T14:38:50.633

这是由于文章从类别继承了 itemID。Joomla 根据菜单项的 itemID 放置模块。为了防止模块显示在菜单项的子项上，您需要使用高级菜单管理器。它可以选择仅在父菜单项上显示模块。

# iphone - 带有 NSMutableArray 的分页和数据的动态 UIScrollView

> ID：11816456
> 
> 赞同：0
> 
> 时间：2012-08-05T12:35:27.830
> 
> 标签：iphone, objective-c, ios, xcode, uiscrollview

我看到很多人问这个问题，我阅读了所有内容，但仍然不知道该怎么做。我有一个启用分页的 UIScrollView，还有一个带有字符串的 NSMutableArray。

我想要做的是 UIScrollView 将使用字符串显示给 UITextView，当我切换到下一页时，它将显示 NSMutableArray 上的下一项。

由于某种原因，我无法让它工作。

```
- (void)setupPage
{
    pagingView.delegate = self;

    [self.pagingView setBackgroundColor:[UIColor blackColor]];
    [pagingView setCanCancelContentTouches:NO];

    pagingView.indicatorStyle = UIScrollViewIndicatorStyleWhite;
    pagingView.clipsToBounds = YES;
    pagingView.scrollEnabled = YES;
    pagingView.pagingEnabled = YES;
    pagingView.backgroundColor = [UIColor clearColor];
    [pagingView setShowsHorizontalScrollIndicator:NO];
    [pagingView setShowsVerticalScrollIndicator:NO];

    for (int i=0;i<[arrCat count];i++)
    {
        UITextView * txtJoke = [[UITextView alloc]initWithFrame:CGRectMake(10, 10, 100, 100)];
        [pagingView addSubview:txtJoke];

        txtJoke.text = [arrCat objectAtIndex:i];
        txtJoke.textAlignment = UITextAlignmentRight;
    }
    [pagingView setContentSize:CGSizeMake(960, [pagingView bounds].size.height)];
}

- (void)scrollViewDidScroll:(UIScrollView *)_scrollView
{
    if (pageControlIsChangingPage) {
        return;
    }

    /*
     *  We switch page at 50% across
     */
    CGFloat pageWidth = _scrollView.frame.size.width;
    int page = floor((_scrollView.contentOffset.x - pageWidth / 2) / pageWidth) + 1;
    //pageControl.currentPage = page;
}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)_scrollView
{
    pageControlIsChangingPage = NO;
}

- (IBAction)changePage:(id)sender :(int)current
{
    /*
     *  Change the scroll view
     */
    CGRect frame = pagingView.frame;
    frame.origin.x = frame.size.width * 1;
    frame.origin.y = 0;

    [pagingView scrollRectToVisible:frame animated:YES];

    /*
     *  When the animated scrolling finishings, scrollViewDidEndDecelerating will turn this off
     */
    pageControlIsChangingPage = YES;
} 
```

这段代码是我试图融入其中的另一个应用程序的组合，但没有任何成功。请帮忙。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:53:50.107

一方面，您所有的 UITextView 都具有相同的帧坐标，因此它们将相互重叠。假设您正在水平滚动，您需要将 UITextView 的 x 原点偏移页面宽度。

你在使用 UIPageControl 吗？如果没有，您可以删除 setupPage 以外的方法。这些其他方法仅用于更改 UIPageControl，以及使用 UIPageControl 更改页面。

这是一个与您类似的基本滚动视图实现：

```
static NSUInteger kNumberOfPages = 3;
static NSUInteger kPageWidth = 320;

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.scrollView.pagingEnabled = YES;
    self.scrollView.contentSize = CGSizeMake(kPageWidth * kNumberOfPages, self.scrollView.frame.size.height);
    self.scrollView.showsHorizontalScrollIndicator = NO;
    self.scrollView.showsVerticalScrollIndicator = NO;
    self.scrollView.delegate = self;

    self.pageOne.frame = CGRectMake(0, 0, kPageWidth, self.pageOne.frame.size.height);
    [self.scrollView addSubview:self.pageOne];

    self.pageTwo.frame = CGRectMake(kPageWidth, 0, kPageWidth, self.pageTwo.frame.size.height);
    [self.scrollView addSubview:self.pageTwo];

    self.pageThree.frame = CGRectMake(2*kPageWidth, 0, kPageWidth, self.pageThree.frame.size.height);
    [self.scrollView addSubview:self.pageThree];

    self.pageControl.numberOfPages = kNumberOfPages;
    self.pageControl.currentPage = 0;
}

# pragma mark - Scroll View Related Methods

- (void)scrollViewDidScroll:(UIScrollView *)sender
{
    // We don't want a "feedback loop" between the UIPageControl and the scroll delegate in
    // which a scroll event generated from the user hitting the page control triggers updates from
    // the delegate method. We use a boolean to disable the delegate logic when the page control is used.
    if (pageControlUsed_)
    {
        // do nothing - the scroll was initiated from the page control, not the user dragging
        return;
    }

    // Switch the indicator when more than 50% of the previous/next page is visible
    int page = floor((self.scrollView.contentOffset.x - kPageWidth / 2) / kPageWidth) + 1;
    self.pageControl.currentPage = page;
}

// At the begin of scroll dragging, reset the boolean used when scrolls originate from the UIPageControl
- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView
{
    pageControlUsed_ = NO;
} 

// At the end of scroll animation, reset the boolean used when scrolls originate from the UIPageControl
- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView
{
    pageControlUsed_ = NO; 
}

- (IBAction)changePage:(id)sender
{ 
    int page = self.pageControl.currentPage;

// update the scroll view to the appropriate page
    CGRect frame = self.scrollView.frame;
    frame.origin.x = frame.size.width * page;
    frame.origin.y = 0;
    [self.scrollView scrollRectToVisible:frame animated:YES];

// Set the boolean used when scrolls originate from the UIPageControl. See scrollViewDidScroll: above.
    pageControlUsed_ = YES;
} 
```

# php - htaccess url 重写许多链接并保护 css 和 js 文件

> ID：11816460
> 
> 赞同：0
> 
> 时间：2012-08-05T12:35:47.173
> 
> 标签：php, .htaccess, url-rewriting, friendly-url, seo

我想重写我的链接，但是这里有多种样式，我希望我看起来像

**信息**cms 是我的重写基础

**猫风格** [http://www.site.com/catname](http://www.site.com/catname)

**帖子样式** [http://www.site.com/anycatname/posttitle](http://www.site.com/anycatname/posttitle)

**页面样式** [http://www.site.com/page/page+title+here](http://www.site.com/page/page+title+here)

我的页面是

猫风格 => cats.php?name=catname

帖子样式 => posts.php?title=posttitle

页面样式 => page.php?name=catname

**笔记**

当我尝试像帖子样式那样重写 url 时，css 和 js 文件也有很多问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:44:07.047

见下面网址

[http://corz.org/serv/tricks/htaccess2.php](http://corz.org/serv/tricks/htaccess2.php)

或尝试以下

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^files/([^/]+)/([^/]+).zip /download.php?section=$1&file=$2 [NC] 
```

将允许您将此链接显示为..

```
mysite/files/games/hoopy.zip 
```

并在后台透明地翻译，服务器端，到..

```
mysite/download.php?section=games&file=hoopy 
```

# licensing - 如何将软件置于 GNU GPL 代码下，部分许可 X11 (MIT)

> ID：11816461
> 
> 赞同：0
> 
> 时间：2012-08-05T12:35:50.440
> 
> 标签：licensing, gpl

我创建了一个由 X11 许可源制作的软件，我想将我的软件置于 GNU GPL 之下。我知道这是可能的，因为 GNU GPL 与 X11 许可证兼容。但是，我想知道具体怎么做，因为 X11 许可证中的一段话让我很困扰：

“上述版权声明和本许可声明应包含在本软件的所有副本或主要部分中”

所以我该怎么做？我只需要引用作者的名字或者我必须放一个 X11 许可证（虽然我不使用它，因为我的软件在 GNU GPL 下）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:16:25.610

假设您没有修改 X11 源代码。您确实需要遵守要求您传递许可文本和版权声明的许可条款。

因此，请保留这些项目，否则您将违反使用条款并失去使用该代码的权利。

如果您随后对源代码的该部分进行修改，则取决于您的目标。你想让你的修改在上游项目中使用吗？如果是，请注意将您的修改也放在 X11 条款下。当然，您可以在顶部添加自己的版权，因为那时您也是该部分的作者。

顺便说一句，通常建议这样做。自由软件通过交换软件来工作，所以做一个好公民，不要阻止传回改进（例如，当 X11 代码是某个库时）。

但是，您可以在 GPL 下许可您的更改，这也可以使用 X11 代码。但是，这将防止您的改进回流到上游。所以你应该知道你在这里做什么以及为什么这样做。

您会发现本文对整个主题进行了很多详细的解释和一些示例：

*   [在 GPL 许可项目中维护许可许可文件：开发人员指南](http://www.softwarefreedom.org/resources/2007/gpl-non-gpl-collaboration.html)

# c# - 从文本文件中检索数据

> ID：11816463
> 
> 赞同：0
> 
> 时间：2012-08-05T12:36:00.153
> 
> 标签：c#

我有一个小项目。我正在做的是，从用户那里获取输入并将其保存在文本文件中。它的工作很好。

```
private void btbsave_Click(object sender, EventArgs e)
{
    //Create Directory
    DirectoryInfo dd = new DirectoryInfo("C://Program Files/UserInfo");
    dd.Create();
    //To save the inputs
    StreamWriter sw = new StreamWriter("C://Program Files/UserInfo/UserInfo.txt", true);
    sw.WriteLine(txtname.Text);
    sw.WriteLine(txtage.Text);
    sw.Flush();
    sw.Close();
    //Conformation
    MessageBox.Show("Credentials Saved");
    //To Clear the text box after data saved
    txtname.Text = string.Empty;
    txtage.Text = string.Empty;
    //Focus
    txturl.Focus();
} 
```

现在，我想根据输入检索数据。这部分对我来说很难，你们能帮帮我吗？

```
private void btnsearch_Click(object sender, EventArgs e)
{
     StreamReader sr = new StreamReader("C://Program Files/UserInfo/UserInfo.txt");
     String mystring = sr.ReadToEnd();
     //No idea how to retrive now plz help!
} 
```

我的项目的简要描述：从*UserName*和*Age*等用户那里获取一些值。将它们保存在文本文件中。

我需要根据用户*UserName*检索值。然后我应该得到*UserName*和他的*Age*并将这些值插入到 2 个不同的只读文本框中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T12:44:18.880

就个人而言，我建议您重新考虑您的方法，但这就是您要寻找的：

```
 string sUserToSearch = "username";
    string sAgeToSearch = "22";

    string[] readText = File.ReadAllLines("UserInfo.txt");
    for (int i = 0; i < readText.count-2; i++) {
         if(readText[i] == sUserToSearch && readText[i+1] == sAgeToSearch);
             // Found it!
    } 
```

我不知道你想做什么，但如果我让你正确，你应该阅读更多关于[序列化的内容](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/serialization/index)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:05:44.807

首先，您必须当时分离您的数据，然后将它们插入到您的文本文件中

```
private void WriteUserToFile(User user, string path)
{
    using(var sw = new StreamWriter(path, true))
    {
        sw.WriteLine(user.Name + ";" + user.Age);
    }
} 
```

现在你有一个像这样的文件：

```
User1;10
User2;20
User3;45 
```

现在您可以拆分数据：

```
private IEnumerable<User> ReadUsersFromTextFile(string path)
{
    var users = new List<User>();

    using(var sr = new StringReader(path)
    {
        do
        {
            var strings = sr.ReadLine().split(';');                 
            var user = new User();
            user.Name = strings[0];
            user.Age = strings[1];
            users.Add(user);
        }while(!sr.EndOfStream)
    }

    return users;
} 
```

# javascript - JavaScript 关联数组

> ID：11816466
> 
> 赞同：-1
> 
> 时间：2012-08-05T12:36:17.970
> 
> 标签：javascript, arrays, oop

我正在尝试传递一个键值数组。我正在使用对象文字来构造我的滑块对象，如下所示。

```
var test1 = new Slider({set: ['value': 10, 'min': 0, 'max': 20,]}); 
```

但我似乎无法通过这个关联数组，它说`:`是一个意外的令牌。我只能传递一个像下面这样的基本数组。

```
set: [10, 0, 20,] 
```

如何正确传递关联数组。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T12:38:08.040

您使用了错误的括号：

```
var test1 = new Slider({set: {'value': 10, 'min': 0, 'max': 20 }}); 
```

`[]`对于一个`Array`，`{}`对于一个`Object`。

# c# - 使用 Mono.CSharp.Evaluator 编译的调试代码

> ID：11816467
> 
> 赞同：5
> 
> 时间：2012-08-05T12:36:19.700
> 
> 标签：c#, debugging, mono, code-generation

我正在使用 Mono.CSharp Evaluator 为我的 Windows 应用程序提供基本的脚本功能。

理想情况下，我希望能够通过将 Debugger.Break 函数插入脚本代码来调试和逐步执行在应用程序中创建的脚本。

可以使用 CSharpCodeProvider 执行此操作，如下所述：[如何在 codedom 编译代码中调试/中断，](https://stackoverflow.com/questions/875723/how-to-debug-break-in-codedom-compiled-code)但我似乎找不到任何关于如何使用 Evaluator 执行此操作的信息。

我已经尝试在 CompilerSettings 中设置 GenerateDebugInfo 标志和 OutputFile，但让它工作起来并不顺利。

# asp.net-mvc-3 - MVC 3 不显眼的验证 - 有条件地禁用/启用验证

> ID：11816471
> 
> 赞同：5
> 
> 时间：2012-08-05T12:36:38.963
> 
> 标签：asp.net-mvc-3, unobtrusive-validation

我有一个表格，可以选择输入以下尺寸：

*   宽度和高度
*   宽度
*   高度

我有两个容器 div，我隐藏/显示取决于选择了三个选项中的哪一个：

```
<div class="editor-field" id="width-container">
     @Html.EditorFor(model => model.Width)
     @Html.ValidationMessageFor(model => model.Width)
</div>

<div class="editor-field" id="height-container">
     @Html.EditorFor(model => model.Height)
     @Html.ValidationMessageFor(model => model.Height)
</div> 
```

如果选择了高度，那么表单上不会显示宽度，我如何禁用宽度输入字段上的不显眼验证，如果用户改变主意，我可以轻松地重新启用它，即删除数据-*属性不是一个选项。我很高兴创建一个 CustomAttribute 类来处理这个问题，但我不想破解标准的 jquery 文件来完成这项工作，因为它使更新到新版本令人头疼。如果所有其他方法都失败了，我将使用我通常的技巧，即在字段不可见时向字段添加值 0，然后在显示时将其删除。

编辑：

请注意，当 Width 不可见时，它本身并不是一个“隐藏”字段，它只是一个对用户不可见的输入标签，因为父 div 的样式为 display:none

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-05T12:43:20.160

您可以设置 jQuery 验证器来处理您的不显眼的验证以忽略隐藏元素：

```
jQuery.validator.defaults.ignore = ":hidden";

// the line above is outside any $(document).ready(...) or similar
$(document).ready(function(){
    ...
});
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:10:12.227

所以这似乎是我的问题的答案（我再次在谷歌上寻找与“隐藏”字段无关的东西）：

[https://stackoverflow.com/a/7673985/491950](https://stackoverflow.com/a/7673985/491950)

例如

```
$("#height-container input[type='text']").attr("disabled", "disabled"); 
```

感谢您的回答。

# iphone - 如何在 NavigationController 上访问链接到 UIBarButton 的方法

> ID：11816476
> 
> 赞同：-1
> 
> 时间：2012-08-05T12:37:38.683
> 
> 标签：iphone, objective-c, ios, uinavigationcontroller, uikit

我想在我的 UINavigationController 中添加一个 UIBarButton。我在以下代码的帮助下做到了，

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    UIViewController *rootController = [[RootViewController alloc] initWithNibName:@"RootViewController" bundle:nil];

    self.navigationController = [[UINavigationController alloc] initWithRootViewController:rootController];

    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    [self.window addSubview:navigationController.view];
    [self.window makeKeyAndVisible];
    return YES;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    UIBarButtonItem *addInfoButton = [[UIBarButtonItem alloc] initWithTitle:@"Add Info" style:UIBarButtonItemStylePlain target:self action:@selector(addCustomerInfo)];
    self.navigationItem.rightBarButtonItem = addInfoButton;
}

-(void) addCustomerInfo
{
    AddInfoViewController *addVC = [[AddInfoViewController alloc] initWithNibName:@"AddInfoViewController" bundle:nil];

    [addVC setModalTransitionStyle:UIModalTransitionStyleCoverVertical];

    [self presentModalViewController:addVC animated:YES];
} 
```

我应该`-(void) addCustomerInfo`在 .h 文件中声明“”吗？我已经尝试过了，但没有运气。

代码仍然抛出异常，

2012-08-06 04:16:22.200 TableView[5698:f803]-[RootViewController addCustomerInfo]：无法识别的选择器发送到实例 0x6c662b0 2012-08-06 04:16:22.202 TableView[5698:f803] ***由于未捕获而终止应用程序异常“NSInvalidArgumentException”，原因：“-[RootViewController addCustomerInfo]：无法识别的选择器发送到实例 0x6c662b0”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:56:01.460

查看本教程： http: [//www.innovatelabs.in/2010/03/implementing-uibarbuttonitem/](http://www.innovatelabs.in/2010/03/implementing-uibarbuttonitem/)

我对 iOS 不太熟悉，但通常当你使用选择器时，你添加`:`到它`@selector(addCustomInfo:)`

然后函数看起来像这样：

```
-(void) addCustomInfo:(UIBarButtonItem *)myButton {
    NSLog(@"YOU CLICKED ME!");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T14:53:26.273

您班级的代码是正确的。您需要更改您的 App Delegate

我建议在您的 App Delegate 中创建一个属性来存储您的导航控制器 - `@property (strong, nonatomic) UINavigationController *navController;`- 不要忘记合成它。然后，当您创建导航控制器时，将其设置为您的属性 -`self.navController = [[UINavigationController alloc] init];`

这将保证您的 NavigationController 被正确保留，并且您的应用程序中的其他类可以正确访问它。

下面的一些示例代码可能会使它更清晰：

首先是 AppDelegate 头文件：

```
//AppDelegate.h
#import <UIKit/UIKit.h>

@interface AppDelegate : UIResponder <UIApplicationDelegate>
{
    UINavigationController *navController;
}
@property (strong, nonatomic) UIWindow *window;
@property (strong, nonatomic) UINavigationController *navController;    
@end 
```

以及实现文件：

```
//  AppDelegate.m
#import "AppDelegate.h"
@implementation AppDelegate
@synthesize window = _window;
@synthesize navController;
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.navController = [[UINavigationController alloc] init];    
    UIViewController *myVC= [[myVC alloc]     init];
    [self.navController pushViewController:myVC animated:NO];
    [self.window addSubview:navController.view];
    [self.window makeKeyAndVisible];
    return YES;
} 
```

# php - mysqli bind_param 失败但为什么？

> ID：11816481
> 
> 赞同：1
> 
> 时间：2012-08-05T12:38:35.830
> 
> 标签：php, binding, mysqli

以下错误触发mysql错误，这是由于查询未将参数绑定到语句。我不明白为什么会这样。

这是 else 子句返回的错误：

```
ERROR -> 1064 : You have an error in your SQL syntax; check the manual 
that corresponds to your MySQL server version for the right syntax to
use near '? ORDER BY dateCreated DESC' at line 4` 
```

这是有问题的代码：

```
$userId = 1;
if ($stmt = $link->query("
    SELECT o.id, dateCreated, firstValue
    FROM user_orders o 
    LEFT JOIN order_delivery d ON o.id = d.id 
    WHERE o.userId = ? 
    ORDER BY dateCreated DESC
"))
{
    $stmt->bind_param("i", $userId);
    $stmt->execute();
    $stmt->close();
}
else
{
    $pageContent = '
        <p>ERROR -> '.$link->errno.' : '.$link->error.'</p>
    ';

} 
```

有人可能会指出我在哪里出错以及为什么会发生这个mysql错误。

感谢您花时间阅读本文！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-05T12:47:40.087

使用[`mysqli::prepare`](http://php.net/manual/en/mysqli.prepare.php), 不是`query`准备你准备好的陈述。

`query`将尝试运行该查询，该查询在绑定参数之前无效。

# php - pdo 和 hash 防止 sql 注入

> ID：11816483
> 
> 赞同：-1
> 
> 时间：2012-08-05T12:38:41.313
> 
> 标签：php, sql-injection

> **可能重复：**
> [在 PHP 中防止 SQL 注入的最佳方法](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)

我正在尝试将用户的输入插入数据库。
这个 pdo 和哈希是否足够安全：

```
$dbh = new PDO("mysql:host=hostName; dbname=dbName", "user", "pass");
if(isset($_POST['Submit']))
{
$user = $_POST['user'];
$pass = $_POST['pass'];
$salt = substr(str_replace('+', '.', base64_encode(sha1(microtime(true), true))), 0, 22);
$hash = crypt($pass, '$2a$12$' . $salt);
$mail = $_POST['mail'];
$confirm_key=md5(uniqid(rand()));

$sth = $dbh->prepare("INSERT INTO members(user, pass, mail, confirm_key)
VALUES ('$user', '$hash', '$mail', '$confirm_key')");
$sth->execute(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T12:46:48.863

您似乎对什么是 SQL 注入以及我们为什么要散列密码感到有些困惑。

完成密码散列（和加盐），以便数据库包含足够的信息来验证密码，但不足以检索它。如果攻击者获得（离线）数据库访问权限，她仍然无法在不破解安全哈希的情况下读出任何密码。为此，您的代码看起来很合理。

SQL 注入是完全不同的野兽。该漏洞通过向您的 PHP 代码发送值来工作，当将其插入动态 SQL 查询时，将以有趣的方式破坏它，因此查询现在执行与预期不同的操作。例如，用户可以提供一个`$user`保持`INSERT`查询有效的值，但会中断引用的字符串并添加第二个查询，这可能会做一些有害的事情，例如用已知值覆盖每个其他用户的密码哈希，之后攻击者可以登录他们想要的任何帐户（包括管理帐户）。

防止 SQL 注入的最佳方法是通过PDO 开箱即用的**参数化查询；**但是，您没有使用它们，因此您的代码很容易受到攻击。阅读[有关 PDO 参数化查询的文档](http://php.net/manual/en/pdo.prepared-statements.php)；如果您不确定它们是如何工作的，请随时回来再次询问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T12:45:51.327

您正在滥用准备好的语句，请将您的代码更改为：

```
$stmt = $dbh->prepare("INSERT INTO members(user, pass, mail, confirm_key) VALUES (:user, :hash,:mail,:confirm)");
$stmt->bindParam(':user', $user);
$stmt->bindParam(':hash', $hash);
... 
```

有关更多详细信息，请参见[此处](http://php.net/manual/en/pdo.prepared-statements.php)。

# .htaccess - 检查 apache 是否使用 htaccess 安装了 ssl 证书

> ID：11816486
> 
> 赞同：2
> 
> 时间：2012-08-05T12:38:54.813
> 
> 标签：.htaccess, ssl, https

在为 https 运行任何 RewriteCond 或 RewriteRule 之前，是否有办法检查 apache 是否安装了带有 htaccess 的 ssl 证书？

例如：

Apache 安装了 ssl 证书，然后 RewriteCond {HTTPS} !on RewriteRule %{HTTP_HOST}%{REQUEST_URI}

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T15:28:41.080

而不是检查“如果 SSL 证书存在”，而是检查“如果 ssl 模块打开” - 后者本身需要证书

```
<IfModule mod_rewrite.c>
RewriteEngine on

  <IfModule mod_ssl.c>
  RewriteCond %{HTTPS} !=on
  RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]
  </IfModule>

</IfModule> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:30:36.750

如果 Apache 没有安装证书，则协议不可能是 HTTPS。

# c - 如何将 N 个单元格从数组 1 复制到数组 2 并接收错误的返回值？

> ID：11816493
> 
> 赞同：0
> 
> 时间：2012-08-05T12:39:45.550
> 
> 标签：c, arrays, string

我在 C 中有两个数组，我想将 array1 的 N 个单元复制到 array2 中。

此外，我想收到复制单元格的确切数量。

该函数`strncpy`还不够好，因为它没有返回值（或者它有，但不是我正在寻找的那个）。

任何建议都会受到欢迎

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:50:46.397

这个怎么样：

```
size_t copy_n(T * dst, T const * src, size_t n)
{
    // method 1
    while (n--) { *dst++ = *src++; }

    // === OR ===

    // method 2
    memcpy(dst, src, n * sizeof(T));

    return n;
} 
```

用法：

```
T a[10];
T b[25];

copy_n(b + 5, a + 2, 7);  // copies a[2]...a[8] into b[5]...b[11] 
```

这仅适用于固定的、可分配的类型`T`。如果您想要一个通用函数，请传递一个大小参数并`memcpy`在整个范围内使用：

```
size_t generic_copy_n(void * dst, void const * src, size_t size, size_t n)
{
    memcpy(dst, src, n * size);
    return n;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T12:43:05.683

您可以使用[memcpy](http://www.cplusplus.com/reference/clibrary/cstring/memcpy/)

```
memcpy(Array2,Array1,sizeof(*Array1)*N); 
```

这将毫无问题地复制，您不必关心有多少，因为一旦被告知它将无论如何都会完成它的任务，除非您自动弹出“访问冲突”的失败。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T12:58:15.477

我假设您想达到与相同的效果，`strncopy`但也想知道已复制了多少字节。这可以通过以下代码完成：

```
size_t special_strncopy(char * dest, const char * src, size_t count){
    const size_t original = count--;
    if(count != 0){
        while(*src && count--){
           *dest++ = *src++;
        }
    }
    *dest = '\0'; /* set null-termination symbol */
    return original - count;
} 
```

注意`count == 0`将导致未定义的行为，因为它包含 0 符号。

# javascript - JavaScript：获取文本选择在 Chrome 中不起作用？

> ID：11816495
> 
> 赞同：1
> 
> 时间：2012-08-05T12:40:04.150
> 
> 标签：javascript, jquery, google-chrome

我正在尝试从**Chrome 的浏览器窗口中**提取选定的文本，在以下浏览器上：IE6-9、FireFox 和 Safari 运行良好。但不是在铬！

这是我的代码：

```
$("div-content").bind("mouseup", function () {
       var t = '';
        if (window.getSelection) {          //FireFox, Safari and IE9(*) 
            t = window.getSelection();
        } else if (document.getSelection) {
            t = document.getSelection();
        } else if (document.selection) {    //IE6,7,8,9
            t = document.selection.createRange().text;
        }     

 }); 
```

有人知道 Chrome 的魔力是什么吗？

*请注意，IE9 有 2 种可能的方式来获取选择：window.getSelection() 和 document.selection

# c - `(void)struct_pointer` 的用途是什么？

> ID：11816504
> 
> 赞同：1
> 
> 时间：2012-08-05T12:41:05.630
> 
> 标签：c

我现在正在阅读一个项目，发现一些代码很难理解，如下所示：

```
struct mcachefs_metadata_t* mdata_root;
...
mcachefs_metadata_release(mdata_root); 
```

的定义`mcachefs_metadata_release`如下：

```
void
mcachefs_metadata_release(struct mcachefs_metadata_t* mdata)
{
    (void) mdata;
    mcachefs_metadata_unlock ();
} 
```

的定义`mcachefs_metadata_unlock`如下：

```
#define mcachefs_metadata_unlock() mcachefs_mutex_unlock ( &mcachefs_metadata_mutex, "metadata", __CONTEXT ); 
```

然后，`mcachefs_mutex_unlock`函数：

```
void
mcachefs_mutex_unlock(struct mcachefs_mutex_t* mutex, const char* name,
    const char* context)
{
  int res;
  ...

  mutex->owner = 0;
  mutex->context = NULL;
  res = pthread_mutex_unlock(&(mutex->mutex));
  if (res == 0)
    {
      return;
    }
  ...
} 
```

我无法理解函数中的 `(void) mdata;`含义 `mcachefs_metadata_release`。它的用途是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:43:34.623

它用于抑制`unused argument: mdata`编译器警告。顺便说一句，相当糟糕的做法。

# jquery - Jquery 在打开内联隐藏 html 的灯箱中不起作用

> ID：11816506
> 
> 赞同：0
> 
> 时间：2012-08-05T12:41:43.117
> 
> 标签：jquery, lightbox

我正在使用灯箱进化脚本。我的问题是，当我加载隐藏的内联 html 时，jQuery 脚本无法处理它。例如工具提示脚本或验证脚本。这是网站和代码：

[http://putuj.org/clickheat/index.php](http://putuj.org/clickheat/index.php)

如果您从中删除，`id="login-container"` `display:none`您将看到脚本应该如何在灯箱中工作，但它不是:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:22:33.360

好吧，不如试试这个。

在脚本标签中写下这个

```
$('.lightbox').lightbox({
  'onOpen'  : function() { 
     // put your related tipsy code here
   }
}); 
```

希望这能解决您的问题。

# c - 如何实施 ?

> ID：11816508
> 
> 赞同：1
> 
> 时间：2012-08-05T12:42:02.423
> 
> 标签：c, locale, ctype

我正在尝试`<ctype.h>`使用查找表和位掩码（[此方法](http://en.wikipedia.org/wiki/C_character_classification#Implementation)）构建一个实现。但是我在 C11 标准中看到我需要一些关于当前语言环境的信息：

> **7.4 字符处理`<ctype.h>`**
> 
> [...]
> 
> 2 这些函数的行为受当前语言环境的影响。

那么，我需要一个`<locale.h>`实现吗？如何`<ctype.h>`使用 C 标准库管理我的实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:19:21.320

对 8 位字符执行此操作的一种快速简单的方法是为每个定义的 LC_CTYPE 值设置一个位掩码。对于宽字符类型，您可以通过某种方法（例如 2 阶段查找）来减小表的大小。为了提高效率，这需要针对每个字符编码进行设计。对 LC_CTYPE 进行动态查找将允许更轻松地添加新的语言环境。

在我看来，您可以使用 16 个左右的 1 字节表来涵盖西方语言。做所有事情需要大约 50 张桌子，其中一些非常乏味。

# unit-testing - 作为专业开发人员，不写单元测试是否可以接受？

> ID：11816511
> 
> 赞同：0
> 
> 时间：2012-08-05T12:42:54.293
> 
> 标签：unit-testing, testing, tdd, automated-tests

只是想知道 TDD/自动化单元测试的利弊，并寻找社区对专业开发人员编写不支持单元测试的应用程序是否可以接受的看法？

再次询问程序员：[https ://softwareengineering.stackexchange.com/questions/159572/is-it-acceptable-as-a-professional-developer-not-to-write-unit-tests](https://softwareengineering.stackexchange.com/questions/159572/is-it-acceptable-as-a-professional-developer-not-to-write-unit-tests)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T12:56:12.937

我敢打赌我会为此得到-1 -ed，但我仍然说：*如果你有其他措施来确保质量，包括避免回归、程序验证、程序验证，那么* **没有。**

唯一的问题通常是人们除了单元测试之外没有任何其他工具来实现这一点。

如果您已经正式测试过模型（有一个工具，可以实际测试它，或者它以确保其有效的方式构建），并且您已经正式测试了确保实际运行的软件符合该模型的方法，那么没关系。

示例：如果您确定，您用 ruby​​ 编写的代码将按照您的预期运行（因为您或其他人测试了 ruby​​ 解释器并且它没有错误，或者您只使用了已知功能的子集）安全）然后就可以了。通常，我们以这种方式信任 C 编译器和 CPU。

此外，如果一个程序只使用一次，则不存在回归问题！如果我用 bash 编写一个单行代码，它会为我计算一些东西，我可能会先在假数据上手动测试它，然后在真实数据上运行它——无需编写自动化测试。

如果你承担责任，你也可以接受假设：我通常假设，eclipse 非常擅长创建 setter 和 getter，我不测试这些。另外，我假设，如果 Java 7 中的 Java 集合类有任何问题，现在它已经出现了。但万一有麻烦，那是你个人的麻烦。不要责怪任何人。

就个人而言，我很少对某些代码使用单元测试，因为我正式测试它们时它们仍然是一张纸上的流程图​​，并且我确保我只使用已知在这种情况下工作的语言/库的子集。此外，我从来没有在没有同行评审的情况下发布代码。不过，如果有人对它们进行验收测试，有时会更好......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T12:53:58.837

它是由你决定。这个问题本质上更具哲学性。

单元测试只是帮助你的工具。您可以选择忽略它们。但是，如果您要从事一个不简单的项目，我建议您使用单元测试。

是的，他们也需要时间来写作。但最终，如果进行任何重构或需要更改代码的某些部分，您将节省很多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T12:55:51.217

一如既往：这取决于。

一般来说，单元测试是一件好事：它们捕捉到一整类错误，验证代码的特定部分在给定情况下是否按预期工作，并且在出现问题时更容易追踪错误。因此，除非您有充分的理由不这样做，否则您应该编写单元测试。

不编写单元测试的充分理由包括：

*   对结构糟糕且因此难以测试的代码库进行相对较小的更改（通常，原因是关注点分离很少，如果不对代码库本身进行侵入性更改，就无法隔离可测试单元进行测试）。
*   问题域的性质使代码本质上是不可测试的。这种情况很少见，但确实会发生——例如，很难为绘制 GUI 的例程提出有意义的单元测试：您必须将其渲染到模拟表面，然后检查单个像素，但是您' 还必须模拟所有影响布局决策的参数等；虽然这在理论上是可能的，但通常不值得付出努力，在这种情况下应该选择手动或半自动测试。
*   该项目是一个很小的一次性程序，范围如此之小，生命周期如此之短，以至于从单元测试中获得的好处（增加可维护性，降低复杂性）是微不足道的。但是请记住，软件的寿命往往比它设计的要长，你一次性的一次性脚本很可能最终成为公司流程的关键任务部分。

# c# - 部署 C# 应用程序（混淆）

> ID：11816518
> 
> 赞同：0
> 
> 时间：2012-08-05T12:43:24.417
> 
> 标签：c#, deployment, obfuscation

> **可能重复：**
> [最好的 .NET 混淆工具/策略](https://stackoverflow.com/questions/2525/best-net-obfuscation-tools-strategy)
> [您是否应该混淆商业 .Net 应用程序？](https://stackoverflow.com/questions/71195/should-you-obfuscate-a-commercial-net-application)

今天是个好日子。

我准备发布一个小型 c# 游戏，但我听说如果它按原样“部署”，反汇编/反编译 c# 应用程序非常容易。所以我的问题——我能做些什么来防止，或者至少让人们更难反汇编/反编译我的应用程序？

还有不止一种方法吗？如果是这样，你认为什么是最好的？

UPD：正如下面所指出的，使用默认混淆器可能会对反射造成一些问题，因为我使用 lua 解释器来处理游戏脚本。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:48:44.337

Visual Studio 包含“Dotfuscator”（VS 2010 中的工具->Dotfuscator 软件服务），它会为您混淆您的代码。如果您在代码中实现反射，它可能会带来某些问题，但它确实为您提供了您希望它对代码执行什么操作的选项，因此那里也有一些灵活性。

# ios - iOS SQLite 中的行编号

> ID：11816520
> 
> 赞同：0
> 
> 时间：2012-08-05T12:43:40.080
> 
> 标签：ios, database, sqlite, numbers, row

在我的应用程序的 SQLite 表中，我需要有一列的行号为 1、2、3、4、5（或者能够获取每一行的行号）。现在我一直在删除行和添加行，所以我不能每次添加新行时都输入一个数字，因为删除行时，编号会变得混乱。那么有没有办法获取行号，或者创建一个特殊的列来作为行号？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:29:24.180

如果您希望每次添加和删除行时都将其重置，那么这真的应该是表中的一列吗？

例如，如果您只想能够从表中选择第 20 行，您可以使用 SQL 的`LIMIT`and`OFFSET`子句来选择特定行，例如，从我的`news`表中检索第 20 行，我可以这样做：

```
SELECT * FROM news LIMIT 1 OFFSET 19; 
```

或者，如果您真的想要具有此行号信息的列，您可以添加一个新的`INTEGER`列类型，然后编写一个 Objective C 方法来更新该列的值，并在您删除或插入行时调用该方法结果集。

有多种方法可以解决您的问题。您必须解释您要完成的工作，以便我们为您提供帮助。典型的`AUTOINCREMENT`答案是我们通常用于表键的内容，但听起来您不希望它成为表的键，而是其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:52:16.550

如果您使用[ROWID](http://www.sqlite.org/autoinc.html)，它是一个自动递增的数字，您可以通过选择所有数据来计算行号，按 ROWID 排序，然后使用它们在返回结果中的索引作为它们的行号。如果您正在创建一些数据模型类，则可以将其传递给它的初始化程序。

如果那不能满足您的要求，那么添加更多有关您正在尝试做的事情的详细信息怎么样。你确定你需要一个行号吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T12:54:40.247

当您删除在行编号方案中造成“漏洞”的行时，您不想更改数据库中的所有现有记录。

SQLite 已经通过 ROWID 支持你想要的。当您进行选择查询时，只需将其指定为按 ROWID 排序，所有返回的记录都将按正确顺序排序，您可以按顺序对其进行迭代。

请参阅此页面：[http ://www.sqlite.org/autoinc.html](http://www.sqlite.org/autoinc.html)

FWIW，在某些地方你应该更喜欢直接 SQLite 而不是 Core Data。然而，这些都是极少数情况。一般来说，首先使用 Core Data，只有当 CD 不能满足您的需求时才回退到 SQLite。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T12:55:03.803

只需为表使用自动增量主键。那么总会有一个唯一的标识符，您可以访问一条记录。

# java - arraylist/atomic double array (Google Guava) 中的 .get() 操作是线程安全的吗？

> ID：11816521
> 
> 赞同：0
> 
> 时间：2012-08-05T12:43:40.097
> 
> 标签：java, multithreading, thread-safety, guava

以下是我的 java 代码中的主要操作之一：

```
 AtomicDoubleArray array1 = new AtomicDoubleArray(25);

 for(int i =0 ; i< array1.size(); i++){
     double a = array1.get(i)*0.001;
     double b = a+ array1.get(i);
     array1.set(b);
 } 
```

上面的代码是线程安全的吗？如果不是，我可以使上面的代码线程安全吗？我不想在读取元素时保持锁定，但在设置每个组件的值期间锁定。这意味着多个线程可以设置 array1 的不同组件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:59:26.930

> 上面的代码是线程安全的吗？

这取决于您对线程安全的含义。每个单独的 get() 和 set() 操作都应该是线程安全的，但是多个线程可以同时调用此方法，因此可以在第一个线程完成迭代之前由第二个线程重新分配单个数组条目。除了在一个公共对象（可能是数组或其他一些专用的锁定对象）上同步之外，您无能为力

> 我不想在读取元素时保持锁定，而是在设置每个组件的值期间锁定。这意味着许多线程可以设置array1的不同组件。

如果我理解这一点，您可以按原样使用您的代码而无需额外锁定（见上文），除了这部分：

```
 array1.set(b); 
```

需要阅读：

```
 array1.set(i, b); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T14:41:11.043

在对 array1.get(i) 的两次连续调用中，您可能会得到不同的值。如果您想避免同步，请查看写入数据结构的副本（例如 CopyOnWriteArrayList - [http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)）

# sql-server - 连接到 SQL Server localdb JDBC

> ID：11816522
> 
> 赞同：6
> 
> 时间：2012-08-05T12:43:40.907
> 
> 标签：sql-server, jdbc, localdb

我在我的系统上安装了 Microsoft SQL Server 2012 Express **localdb**。

在我创建（并启动）带有数据库（db1）的实例（测试）后，我尝试连接我的 java-Applikation。

驱动程序是“com.microsoft.sqlserver.jdbc.SQLServerDriver”。

我的连接字符串是“jdbc:sqlserver://(localdb)\Test;databaseName=db1;schema=db1;”

错误（截断）：java.net.UnknownHostException：'(localdb)' 命名实例 'Test' 检查 UDP 端口 1434 检查 SQL Server 浏览器服务是否已启动

我的 .NET Framework 版本是 4.0.2

'SQLCMD.EXE -S(localdb)\Test' 工作正常。

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T13:37:28.697

Microsoft SQL Server JDBC 驱动程序不支持 localDB。请参阅评论[http://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx#10250447](http://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx#10250447)

> Krzysztof Kozielczyk - MSFT 2011 年 12 月 22 日上午 11:10 #
> 
> @查尔斯·斯坦顿
> 
> 不幸的是，JDBC 驱动程序目前不支持 LocalDB，并且没有简单的解决方法。团队知道这个缺失的功能，但提交连接项目总是有助于 DCR 跟踪和优先级排序。
> 
> 谢谢，
> 
> -克日什托夫

正如[使用 JDBC 连接到 SQL Server LocalDB 中](https://stackoverflow.com/questions/11345746/connecting-to-sql-server-localdb-using-jdbc)的回答所解释的，可以使用 jTDS 驱动程序来执行此操作。

# php - PHP cURL/Socket 和 HTTP 身份验证

> ID：11816523
> 
> 赞同：0
> 
> 时间：2012-08-05T12:43:49.650
> 
> 标签：php, http, sockets, authentication, curl

我有一个网页，其中包含受保护子文件夹中图像的 HTML 链接列表。此文件夹通过 .htaccess 和**HTTP 身份验证**进行保护。

有没有办法使用 cURL/Socket 或类似的东西来访问子文件夹？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:48:06.740

如果您正在谈论 HTTP 基本身份验证，那么您可以提供必要的凭据

```
curl_setopt($curl, CURLOPT_HTTPAUTH, CURLAUTH_BASIC); // enable HTTP Basic auth
curl_setopt($curl, CURLOPT_USERPWD, "username:password"); // credentials 
```

还有一些其他可能感兴趣的选项，例如`CURLOPT_PROXYUSERPWD`（如果您通过代理）和`CURLOPT_UNRESTRICTED_AUTH`（如果初始主机将您重定向到进行实际身份验证的另一个域）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T12:49:28.597

```
<?php
$ch = curl_init(); 
curl_setopt($ch, CURLOPT_URL, 'http://www.example.com'); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC); 
curl_setopt(CURLOPT_USERPWD, '[username]:[password]') 
$data = curl_exec(); 
curl_close($ch); 
?> 
```

[资源](http://www.higherpass.com/php/tutorials/Using-Curl-To-Query-Remote-Servers/5/)

# php - 获取查询中未说明的用户

> ID：11816528
> 
> 赞同：0
> 
> 时间：2012-08-05T12:44:20.657
> 
> 标签：php, sql, sql-server

好吧，我得到了这个查询：

```
$characterinfoquery = "
SELECT 
    c.Name, 
    c.Level, 
    c.Sex, 
    c.Playtime, 
    c.KillCount, 
    c.DeathCount,
    cl.Name AS clanName
FROM 
    Character AS c, 
    Account AS a,
    ClanMember AS cm,
    Clan AS cl
WHERE 
    c.AccountID = a.AccountID AND
    c.CharacterID = cm.CharacterID AND
    cm.ClanID = cl.ClanID AND
    a.UserID='".mssql_real_escape_string($_SESSION['username'])."'
"; 
```

但我希望也显示没有氏族的成员，但不是氏族名称，而是在氏族名称应该在的位置显示“-”。

这是我的 while 语句：

```
if(mssql_num_rows($characterinforesult) != 0){
    $content = str_replace("%content%", file_get_contents("tpl/contents/characterinfo.html"), $content);

    //Get character information
    $search = array("%Name%", "%Level%", "%Sex%", "%Playtime%", "%KillDeath%", "%Clan%");
    $rows = file_get_contents("tpl/contents/characterinfo_tr.html");
    while($row = mssql_fetch_assoc($characterinforesult)){

        if($row['KillCount'] != 0){
            $KillDeath = round($row['KillCount']/$row['DeathCount'], 2);
        }
        else{
            $KillDeath = "-";
        }
        $Playtime = $row['Playtime']/60;
        $replace = array($row['Name'], $row['Level'], gender($row['Sex']), round($Playtime), $KillDeath, $row['clanName']);
        $tr .= str_replace($search, $replace, $rows);
    }
} 
```

有人可以帮我解决这个问题吗？

带内连接的输出：

```
Name    Level   Sex     Playtime    K/D Ratio   Clan
DragonDex   97  Male    375 min     0.22            Test 
```

它显示 1 行，而该帐户中有 2 个字符，1 个有一个氏族，另一个没有。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T12:50:31.713

你需要一个左外连接：

```
SELECT 
    c.Name, 
    c.Level, 
    c.Sex, 
    c.Playtime, 
    c.KillCount, 
    c.DeathCount,
    coalesce( cl.Name, ' - ' ) AS clanName
FROM 
    Character AS c 
          inner join  
    Account AS a 
          on c.AccountID = a.AccountID
          left outer join 
    ClanMember AS cm 
          on c.CharacterID = cm.CharacterID
          left outer join 
    Clan AS cl
          on cm.ClanID = cl.ClanID
WHERE 
    a.UserID='".mssq ... 
```

# jquery - Blueimp 上传 - 丢弃原始文件

> ID：11816535
> 
> 赞同：1
> 
> 时间：2012-08-05T12:44:48.690
> 
> 标签：jquery, file-upload, blueimp

我成功创建了几个图像版本，但我不想编写原始文件。防止保存原始上传文件的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T17:14:23.330

有几种方法。我做了以下事情：

1.  在您可能在*server/php*文件夹中找到的 index.php 类中，您必须：*(i)*检查您的上传文件夹中是否有另一个文件与您正在上传的文件同名；*(ii)*最终重命名该文件或将其移动到另一个文件夹中（或做你想做的事）。
2.  让文件中提供的带有**class.php**扩展名的代码照常工作。

另一种策略是传递另一个文件名以用于通过输入表单提供的*文件名。*在这种情况下，您必须在带有**class.php**扩展名`trim_file_name()`的文件中编辑方法：

 **```
 protected function trim_file_name($name, $type, $index) {
      //BlueImp original code....

      $file_name ='name.xyz'//Your new name here;

      return $file_name;
    } 
```**

# php - 文件上传不适用于 $_FILES

> ID：11816536
> 
> 赞同：1
> 
> 时间：2012-08-05T12:45:27.163
> 
> 标签：php, forms, file, upload

在我的 PHP 网页中，我在表单中有一个文件类型输入，当我提交它时，我可以获得上传的文件名，`$_POST['upload']`但如果我使用`$_FILES['upload']['tmp_name']`它什么都没有——为什么？如何使用`$_FILES`获取文件以将其附加到我的电子邮件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-05T13:25:46.180

使用时一无所获，`$_FILE`因为您没有使用`enctype`表单上的属性。[在此处](http://www.w3schools.com/tags/att_form_enctype.asp)查看如何使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-05T12:50:16.740

```
<form method="POST"  action=#" enctype="multipart/form-data">
</form>

$path_of_uploaded_file = $upload_folder . $name_of_uploaded_file;
$tmp_path = $_FILES["uploaded_file"]["tmp_name"];
if(is_uploaded_file($tmp_path))
{
 if(!copy($tmp_path,$path_of_uploaded_file))
 {
    $errors .= '\n error while copying the uploaded file';
} 
```

或有关详细信息，请转到此处[转到此处](https://stackoverflow.com/questions/826265/simple-php-form-attachment-to-email-code-golf)

# django - 如何在我的 Heroku 环境中使用 Django 补丁？

> ID：11816540
> 
> 赞同：1
> 
> 时间：2012-08-05T12:45:57.707
> 
> 标签：django, heroku, patch

所以我学会了如何在我的本地环境中应用 Django 补丁：

```
sudo patch -p2 < ~/Downloads/html5-input-types-take3.patch 
```

不过，我正在努力寻找有关如何在我的 Heroku 环境中执行此操作的任何信息。有没有人有任何指示？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T17:29:08.807

您可以将修改后的 Django 版本发布到 Git 存储库（例如 GitHub 上的存储库），然后指定`requirements.txt`从该存储库而不是 PyPI 中提取 Django。

# android-spinner - 使用 Android 微调器

> ID：11816541
> 
> 赞同：0
> 
> 时间：2012-08-05T12:46:17.070
> 
> 标签：android-spinner

我是 Android 和 Java 的新手。我想用一个微调器创建一个应用程序。我希望它：从微调器中选择一个元素，例如 element1，并且我希望它在文本视图案例中显示一个明确的文本。

```
Spinner id: `Spinner_Elemente`
Spinner Items: String Array: `Elemente`
Text View id: edtElemente 
```

你能帮我一些简单的代码吗？我查看了[开发人员网站](http://developer.android.com/guide/topics/ui/controls/spinner.html)，但我不明白。因此，如果您能为我的示例提供一个简单的代码，我将不胜感激。

对不起我的英语。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:21:24.793

Spinner 工作需要遵循某些步骤

1.  在 res/values/array.xml 或 strings.xml 中创建一个数组，例如

    ```
    <resources>
        <string-array name="colors">
            <item>Red</item>
            <item>Green</item>
            <item>Blue</item>
            <item>White</item>
        </string-array>
    </resources> 
    ```

2.  在主布局文件中创建一个 Spinner 元素，例如

    ```
    <Spinner
    android:id="@+id/spin"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:entries="@array/colors"
    android:prompt="@string/SPrompt"/> 
    ```

3.  在 java Activity 中实现 OnItemSelectedListener 接口

4.  创建java对象：例如

    微调器 s=(微调器) findViewById(R.id.spin); s.setOnItemSelectedListener(this);

5.  当从微调器中选择某些内容时，覆盖两个方法并执行您想要的工作：

    ```
    public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3){}
    public void onNothingSelected(AdapterView<?> arg0){} 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T17:42:08.333

这是为您的示例建议的 java 文件。

```
public class SpinnerExActivity extends Activity implements OnItemSelectedListener
{
Spinner s;
TextView tv;

public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    s=(Spinner) findViewById(R.id.Spinner_Elemente);
    s.setOnItemSelectedListener(this);
    tv=(TextView) findViewById(R.id.edtElemente);
}

public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3)
{
    tv.setText(s.getItemAtPosition(arg2));
}

public void onNothingSelected(AdapterView<?> arg0)
{
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T21:40:37.443

已解决，@Rishi，代码中存在小问题....正确的代码

```
public class ChimExpressMainActivity extends Activity implements OnItemSelectedListener {
Spinner Spinner_Elemente_Java;
TextView Text_Despre_Element_Afisare;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_chim_express_main);
    Spinner_Elemente_Java=(Spinner) findViewById(R.id.Spinner_Elemente);
    Spinner_Elemente_Java.setOnItemSelectedListener(this);
    Text_Despre_Element_Afisare=(TextView) findViewById(R.id.edtElement);
    Text_Despre_Element_Afisare.setMovementMethod(new ScrollingMovementMethod());
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_chim_express_main, menu);
    return true;
}

public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2,
        long arg3) {
////////////////////////----TEST SPINNEER----////////////////////////////////////////////////////////////////////////////////////
        //Text_Despre_Element_Afisare.setText((CharSequence) Spinner_Elemente_Java.getItemAtPosition(arg2));
        //Text_Despre_Element_Afisare.setText("Hidrogenul este elementul chimic în tabelul periodic al elementelor cu simbolul H și numărul atomic 1\. Este un gaz ușor inflamabil, incolor, insipid, inodor, iar în natură se întâlnește mai ales sub formă de moleculă diatomică, H2\. Având masa atomică egală cu 1,00794 u.a.m. , hidrogenul este cel mai ușor element chimic. Etimologic, cuvântul hidrogen este o combinație a două cuvinte grecești, având semnificația de „a face apă”.Hidrogenul elementar este principala componentă a Universului, având o pondere de 75 % din masa acestuia.[1] În starea de plasmă, se găsește ca element majoritar în alcătuirea stelelor. Hidrogenul elementar este foarte puțin răspândit pe Pământ.Pentru necesități industriale există diferite procedee de fabricație, puse la punct din punct de vedere tehnologic sau aflate în fază de laborator. Hidrogenul poate fi obținut prin electroliza apei, procesul necesitând costuri mai mari decât cel de producere prin procesarea gazelor naturale.[2]Cel mai răspândit izotop al hidrogenului este protiul, care este alcătuit dintr-un singur proton în nucleu și un electron în învelișul electronic. În compușii ionici poate avea sarcină negativă (anion cunoscut sub numele de hidrură, H-) sau sarcină pozitivă H+ (cation). Hidrogenul formează compuși chimici cu majoritatea elementelor din sistemul periodic și este prezent în apă și în mulți dintre compușii organici. Are un rol important în reacțiile acido-bazice, acestea bazându-se pe schimbul de protoni între molecule. Fiind singurul atom pentru care soluția analitică a ecuației lui Schrödinger este pe deplin cunoscută, prezintă un rol major în fundamentarea teoriei mecanicii cuantice.Hidrogenul este un gaz puternic reactiv și își găsește aplicații datorită capacității sale chimice de reducător.[3] Hidrogenul se folosește în industria petrochimică la producerea benzinelor, în industria chimico-alimentară pentru hidrogenarea grăsimilor (de exemplu producerea margarinei), în prelucrările mecanice ale metalelor și în tratamentul termic al acestora.[4]Hidrogenul reprezintă o alternativă pentru înlocuirea benzinei drept combustibil pentru vehiculele echipate cu motoare cu ardere internă.[5] Avantajele sale principale constau în faptul că este ecologic, din arderea sa rezultând vapori de apă, iar randamentul termic al motoarelor cu hidrogen este ridicat. Dezavantajele constau în pericolul mare de explozie, dificultatea stocării în vehicul și lipsa unor rețele de stații de alimentare cu hidrogen. Una dintre cele mai promițătoare soluții tehnice o reprezintă conversia directă a energiei chimice din hidrogen în electricitate, prin intermediul pilelor de combustie.[6]");
        //Text_Despre_Element_Afisare.setText(Html.fromHtml("<h2>Title</h2><br><p>Description here</p>"));
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    

    if(arg0.getSelectedItem().toString().equals("Hidrogen")){
        Text_Despre_Element_Afisare.setText((CharSequence) Spinner_Elemente_Java.getItemAtPosition(arg2));
    }
    else{
        if(arg0.getSelectedItem().toString().equals("Heliu"))
        {
            Text_Despre_Element_Afisare.setText((CharSequence) Spinner_Elemente_Java.getItemAtPosition(arg2));
        }
        else{
            Text_Despre_Element_Afisare.setText("Close");
        }
    }
}

public void onNothingSelected(AdapterView<?> arg0) {
    // TODO Auto-generated method stub

}
} 
```

# jsf - JSF- HTML 输出？

> ID：11816542
> 
> 赞同：0
> 
> 时间：2012-08-05T12:46:24.743
> 
> 标签：jsf, jsf-2

JSF有没有办法输出这样的东西：

```
<button type="submit" ...></button> 
```

我知道您应该`<:hcommandButton />`正常使用，但它输出的是 a`<input type="submit">`而前端开发人员希望将 a`<i />`放在按钮内，以便使用 font awesome 的图标。

如果我们可以避免使用自定义组件，那就太好了……这很乏味。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:48:14.527

是的，它是[`<h:button>`](http://download.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/h/button.html).

```
<h:button value="Label" outcome="page.xhtml" /> 
```

PrimeFaces 有一个更可定制的[`<p:button>`](http://www.primefaces.org/showcase/ui/button.jsf).

请注意，您也可以只在 JSF 中写下纯 HTML，如有必要，只需将其包装在复合组件或标记文件中。

### 也可以看看：

*   [JSF 2.x 标签文档](http://download.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-01T20:41:06.777

<h:button> 输出是`<input type="button">`而不是`<button>`在 HTML 中输出

# javascript - RequireJS 设置父级路径

> ID：11816553
> 
> 赞同：0
> 
> 时间：2012-08-05T12:48:09.173
> 
> 标签：javascript, mobile, requirejs

为了将我的模型、集合等从我的移动应用程序定向到我的网络应用程序，我需要配置我的 RequireJS。

我有以下文件结构：

```
/
/js
  /models
/mobile
  /js
  /templates 
```

我希望我的`mobile`应用程序使用我的主应用程序的模型，所以我设置了以下内容：

```
require.config( {
    paths : {
        models : '/js/models',
        templates : 'mobile/templates'
    }
}); 
```

我在 Chrome 中收到这些错误：

```
Uncaught SyntaxError: Unexpected token < /mobile/js/models/User.js?bust=0.1.0:1
Uncaught SyntaxError: Unexpected token < /mobile/js/models/InviteRequest.js?bust=0.1.0:1
Uncaught SyntaxError: Unexpected token < /mobile/js/models/Log.js?bust=0.1.0:1 
```

这意味着它仍在寻找`/mobile`而不是`/`.

此路径配置适用于我的`templates`文件夹，但不适用于我的文件`models`夹。`models/`如何将所有以我的主模型文件夹开头的依赖项指向？

谢谢！

**尝试 2**

我尝试设置`baseUrl`：

```
require.config( {
    baseUrl : '/',
    paths : {
        views : 'mobile/views',
        templates : 'mobile/templates'
    }
});

require( [
    'app'
],
function(App) {
    App.initialize();
}); 
```

我得到错误：

```
GET http://local.m.mysite.co/app.js 404 (Not Found) require.js:2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T22:04:56.147

在您的第二次尝试中，您基本上告诉 Require JS 加载“app”模块，并且由于您将基本 url 设置为“/”，因此 Require JS 将在您的根路径中查找“app”模块。

所以你需要做的是告诉 Require JS 在哪里寻找你的“应用”模块。假设您的“应用”模块在 /js/module 中：

```
/
/js
  /models
  /module
    /app.js
/mobile
  /js
  /templates 
```

那么你加载“app”模块的代码是：

```
require.config( {
    baseUrl : '/',
    paths : {
        views : 'mobile/views',
        templates : 'mobile/templates'
    }
});

require( [
  'js/module/app'
],
function(app) {
    app.initialize();
}); 
```

或者，您可以在配置中设置“模块”路径。然后在你的依赖加载中引用这个路径：

```
require.config( {
    baseUrl : '/',
    paths : {
        views : 'mobile/views',
        templates : 'mobile/templates',
        module: 'js/module'
    }
});

require( [
  'module/app'
],
function(app) {
    app.initialize();
}); 
```

至于您在 ATTEMPT 2 之前在 Chrome 中遇到的错误，您需要查看在模块加载中如何引用您的模块。

# foreign-keys - 多对一关系不持久

> ID：11816562
> 
> 赞同：0
> 
> 时间：2012-08-05T12:49:18.847
> 
> 标签：foreign-keys, jpa-2.0

当我尝试保留父实体时，它会很好地保留，但是当我尝试子实体时，它会返回错误。

这是父实体

```
@Entity(name="Parent_Detail")
public class Parent implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @Column(name = "Parent_ID", nullable = false)
    private Integer parent_id;

    public Integer getParent_id() {
        return parent_id;
    }

    public void setParent_id(Integer parent_id) {
        this.parent_id = parent_id;
    }

} 
```

这是子实体

```
@Entity
public class Child implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @Column(name = "Child_ID", nullable = false)
    private Integer child_id;

    @ManyToOne
    private Parent parent;

    public Integer getChild_id() {
        return child_id;
    }

    public void setChild_id(Integer child_id) {
        this.child_id = child_id;
    }

    public Parent getParent() {
        return parent;
    }

    public void setParent(Parent parent) {
        this.parent = parent;
    }

} 
```

这是孩子的会话 bean

```
@Stateless
@LocalBean
public class ChildSessionBean {
    @PersistenceContext(unitName = "WebApplication4PU")
    private EntityManager em;

    public void persist(Object object) {
        em.persist(object);
    }

} 
```

这是父级的会话 Bean（它工作正常）

```
@Stateless
@LocalBean
public class ParentSessionBean {
    @PersistenceContext(unitName = "WebApplication4PU")
    private EntityManager em;

    public void persist(Object object) {
        em.persist(object);
    }

} 
```

这是孩子的托管 Bean

```
public class ChildManagedBean {
    @EJB
    private ChildSessionBean childSessionBean;
    private Child child = new Child(); 

    public ChildManagedBean() {
    }

    public Child getChild() {
        return child;
    }

    public void setChild(Child child) {
        this.child = child;
    }
    public void save(){
        child.setParent(new Parent());
        childSessionBean.persist(child);
    }
} 
```

这是父级的 managedBean

```
public class ParentManagedBean {
    @EJB
    private ParentSessionBean parentSessionBean;
    private Parent parent = new Parent();

    public ParentManagedBean() {
    }

    public Parent getParent() {
        return parent;
    }

    public void setParent(Parent parent) {
        this.parent = parent;
    }
    public void save(){
        parentSessionBean.persist(parent);
    }
} 
```

这是子 JSF 页面：我在没有下拉菜单的情况下保持简单。

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <h:form>
            Child ID :<h:inputText value="#{childManagedBean.child.child_id}" /><br/>
            Parent ID :<h:inputText value="#{childManagedBean.child.parent}" /><br/>
            <h:commandButton action="#{childManagedBean.save()}"  immediate="true"/>
        </h:form>
    </h:body>
</html> 
```

这是错误页面

```
javax.faces.el.EvaluationException: javax.ejb.EJBException: Transaction aborted
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processDecodes(UIViewRoot.java:935)
    at com.sun.faces.lifecycle.ApplyRequestValuesPhase.execute(ApplyRequestValuesPhase.java:78)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:636)
Caused by: javax.ejb.EJBException: Transaction aborted
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5142)
    at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4901)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:222)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
    at $Proxy402.persist(Unknown Source)
    at SessionBean.__EJB31_Generated__ChildSessionBean__Intf____Bean__.persist(Unknown Source)
    at managedBean.ChildManagedBean.save(ChildManagedBean.java:33)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at javax.el.BeanELResolver.invokeMethod(BeanELResolver.java:779)
    at javax.el.BeanELResolver.invoke(BeanELResolver.java:528)
    at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:257)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:248)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at org.jboss.weld.util.el.ForwardingMethodExpression.invoke(ForwardingMethodExpression.java:39)
    at org.jboss.weld.el.WeldMethodExpression.invoke(WeldMethodExpression.java:50)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    ... 32 more
Caused by: javax.transaction.RollbackException: Transaction marked for rollback.
    at com.sun.enterprise.transaction.JavaEETransactionImpl.commit(JavaEETransactionImpl.java:473)
    at com.sun.enterprise.transaction.JavaEETransactionManagerSimplified.commit(JavaEETransactionManagerSimplified.java:855)
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5136)
    ... 53 more
Caused by: java.lang.IllegalStateException: During synchronization a new object was found through a relationship that was not marked cascade PERSIST: bean.Parent@13d247e.
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.discoverUnregisteredNewObjects(RepeatableWriteUnitOfWork.java:304)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.calculateChanges(UnitOfWorkImpl.java:702)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitToDatabaseWithChangeSet(UnitOfWorkImpl.java:1490)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.issueSQLbeforeCompletion(UnitOfWorkImpl.java:3143)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.issueSQLbeforeCompletion(RepeatableWriteUnitOfWork.java:346)
    at org.eclipse.persistence.transaction.AbstractSynchronizationListener.beforeCompletion(AbstractSynchronizationListener.java:157)
    at org.eclipse.persistence.transaction.JTASynchronizationListener.beforeCompletion(JTASynchronizationListener.java:68)
    at com.sun.enterprise.transaction.JavaEETransactionImpl.commit(JavaEETransactionImpl.java:435)
    ... 55 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T14:56:46.510

异常消息说明了一切：

```
During synchronization a new object was found through a relationship that was not marked cascade PERSIST: bean.Parent@13d247e 
```

你试图坚持一个孩子。并且孩子的父母是新父母。父母不执着。所以你试图让一个孩子和一个不持久的父母在一起。它行不通。

您想要的是为现有父级保存一个新子级，然后您必须将此现有父级附加到子级：

```
Parent existingParent = em.getReference(Parent.class, existingParentId);
Child child = new Child();
child.setParent(existingParent);
em.persist(child); 
```

或者你想一次性保存一个新的孩子和一个新的父母，你必须坚持父母，然后是孩子：

```
Parent parent = new Parent();
Child child = new Child();
child.setParent(existingParent);
em.persist(parent);
em.persist(child); 
```

或者你想一次性保存一个新的孩子和一个新的父母，并让JPA在孩子被持久化时自动持久化父级，然后你必须使持久化级联

```
@ManyToOne(cascade = CascadeType.PERSIST)
private Parent parent;

...

Parent parent = new Parent();
Child child = new Child();
child.setParent(existingParent);
em.persist(child); 
```

# c - 可以重复调用 BZ2_bzBuffToBuffCompress() 吗？

> ID：11816563
> 
> 赞同：0
> 
> 时间：2012-08-05T12:49:27.613
> 
> 标签：c, compression, bzip2

我有大量“输入”数据要压缩到多个`bzip2`流中，而不是将数据写入多个中间文件。

我可以将一大块输入数据放入缓冲区，用于`BZ2_bzBuffToBuffCompress()`将该缓冲区压缩为 bzip2 风格的字节，然后在后续`BZ2_bzBuffToBuffCompress()`调用新数据时重复此操作，直到我没有更多输入数据？

[bzip2 文档](http://www.bzip.org/1.0.3/html/util-fns.html)说明如下：

> 以这种方式进行压缩是一次性事件，只需调用此函数即可完成。生成的压缩数据是完整的 bzip2 格式数据流。没有进行额外调用以提供额外输入数据的机制。如果您想要这种机制，请使用低级接口。

这是否意味着我不能`BZ2_bzBuffToBuffCompress()`在新填充的缓冲区大小的输入数据块上重新运行？我应该`BZ2_bzWrite()`改用吗？

**编辑**

我实际上的意思是输出到一个存档文件，其中可能包含一个或多个 bzip 流。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T14:13:08.757

您可以随心所欲地使用新数据继续调用`BZ2_bzBuffToBuffCompress()`，您将生成我认为您所说的想要的内容，即：

> 我要压缩到多个 bzip2 流的数据

这正是你会得到的。多个 bzip2 流。然后需要单独解码这些流中的每一个。

如果您想获取一系列缓冲区并从中生成*单个*bzip2 流，那么您将需要使用`BZ2_bzCompressInit`、`BZ2_bzCompress`和`BZ2_bzCompressEnd`.

# mysql - Sphinx + MySQL，选择查询没有得到任何结果

> ID：11816567
> 
> 赞同：0
> 
> 时间：2012-08-05T12:49:55.510
> 
> 标签：mysql, ubuntu, set, sphinx

我目前正在研究如何将 sphinx 集成到现有网站上。

我正在为一个出租度假屋的客户工作。他们有一个网站，客户可以在线预订。在他们的首页上，他们有一个搜索引擎，可以搜索他们所有的家（20k）并在各个领域对他们进行排序。过去，我们对每次搜索都进行 MySQL 查询。现在数据库已经增长了分配，这使得查询的允许速度比过去慢。出于这个原因，我们正在研究如何改进搜索引擎。我目前正在与 sphinx 合作，看看它是否适合我们。

我安装了 Sphinx 并具有以下源和索引：

```
source huisjesSource
{
  type = mysql
  sql_host = localhost
  sql_user = user
  sql_pass = password
  sql_db = database

   sql_query= SELECT a.huis_id as huis_id, a.huis_code as huis_code, a.land_code,    a.regi_code, a.huis_naam, a.huis_plaats,a.multimedia,a.foto_a, a.foto_w,a.foto_a_full, a.foto_w_full, a.huis_van, a.huis_tm, a.hd, a.a_hd, st,a.sl, a.beds, a.bathr, a.baths,a.airport, a.huis_enqe_vr13_aantal, a.huis_enqe_vr13_punten, a.huis_longitude, a.huis_latitude, a.huis_catering_verplicht, 1w_min, 1w_max, 2w_min, 2w_max, 3w_min, 3w_max, wk_min, wk_max, lw_min, lw_max, mw_min, mw_max, age,(CASE WHEN vz200p239 = '1' or vz238 = '1' or vz235 = '1' THEN 1 ELSE 0 END) as relax,ph.plaatsnaam as hplaats,ph.hplaatsid,ps.subplaatsid,ps.plaatsnaam as splaats,ty20,ty30,ty40,ty50,ty60,ty70,ty90,ty160,becdir,huis_hbes_small, a.regi_oms_nl as regi_oms \
   FROM as_search a \
   left join bv_myisam.huis_plaats hpl on a.huis_code = hpl.huis_code \
   left join bv_myisam.plaatsen_head ph on hpl.hplaatsid = ph.hplaatsid and ph.lang = 'nl' \
   left join bv_myisam.plaatsen_sub ps on hpl.subplaatsid = ps.subplaatsid and hpl.subplaatsid != 'null' and ps.lang = 'nl' \
   left join huis_oms o on a.huis_code = o.huis_code AND o.lang = 'nl' \
   inner join huis_sort so on a.huis_code = so.huis_code \
   inner join bbpr_n b on a.huis_code = b.huis_code \
   WHERE a.avail = '1' AND a.demo = '0' AND a.bvdir = '1' \
   GROUP BY a.huis_code 

   # (not needed) sql_attr_uint = huis_id # int(11)
   sql_attr_string = huis_code # varchar(14)
   sql_attr_string = land_code # char(2)
   sql_attr_string = regi_code # varchar(10)
   sql_attr_string = huis_naam # varchar(50)
   sql_attr_string = huis_plaats # varchar(40)
   sql_attr_bool = multimedia # enum('1','0')
   sql_attr_string = foto_a # varchar(90)
   sql_attr_string = foto_w # varchar(90)
   sql_attr_string = foto_a_full # varchar(90)
   sql_attr_string = foto_w_full # varchar(90)
   sql_attr_uint = huis_van # tinyint(4)
   sql_attr_uint = huis_tm # tinyint(4)
   sql_attr_string = hd # char(1)
   sql_attr_uint = a_hd # tinyint(4)
   sql_attr_string = st # char(1)
   sql_attr_uint = sl # tinyint(3) unsigned
   sql_attr_uint = beds # tinyint(3) unsigned
   sql_attr_uint = bathr # tinyint(3) unsigned
   sql_attr_uint = baths # tinyint(3) unsigned
   sql_attr_string = airport # char(3)
   sql_attr_uint = huis_enqe_vr13_aantal # smallint(6)
   sql_attr_uint = huis_enqe_vr13_punten # smallint(6)
   sql_attr_float = huis_longitude # double(8,5)
   sql_attr_float = huis_latitude # double(8,5)
   sql_attr_bool = huis_catering_verplicht # enum(0,1)
   sql_attr_float = 1w_min # decimal(8,2)
   sql_attr_float = 1w_max # decimal(8,2)
   sql_attr_float = 2w_min # decimal(8,2)
   sql_attr_float = 2w_max # decimal(8,2)
   sql_attr_float = 3w_min # decimal(8,2)
   sql_attr_float = 3w_max # decimal(8,2)
   sql_attr_float = wk_min # decimal(8,2)
   sql_attr_float = wk_max # decimal(8,2)
   sql_attr_float = lw_min # decimal(8,2)
   sql_attr_float = lw_max # decimal(8,2)
   sql_attr_float = mw_min # decimal(8,2)
   sql_attr_float = mw_max # decimal(8,2)
   sql_attr_uint = age # tinyint(3) unsigned
   sql_attr_uint = relax # boolean
   sql_attr_string = hplaats # varchar(100)
   sql_attr_uint = hplaatsid # int(11)
   sql_attr_uint = subplaatsid # int(11)
   sql_attr_string = splaats # varchar(100)
   sql_attr_bool = ty20 # enum(1,0)
   sql_attr_bool = ty30 # enum(1,0)
   sql_attr_bool = ty40 # enum(1,0)
   sql_attr_bool = ty50 # enum(1,0)
   sql_attr_bool = ty60 # enum(1,0)
   sql_attr_bool = ty70 # enum(1,0)
   sql_attr_bool = ty90 # enum(1,0)
   sql_attr_bool = ty160 # enum(1,0)
   sql_attr_bool = becdir # enum(0,1)
   sql_attr_string = huis_hbes_small # varchar(2000)
   sql_attr_string = regi_oms # varchar(50)

   }

   #############################################################################
   ## index definition
   #############################################################################

   index huisjesIndex
   {
     type = plain
     source = huisjesSource
     path = /var/lib/sphinxsearch/data/huisjes
     charset_type = utf-8
     preopen = 1
   } 
```

索引创建良好：

```
# indexer --all
Sphinx 2.0.4-release (r3135)
Copyright (c) 2001-2012, Andrew Aksyonoff
Copyright (c) 2008-2012, Sphinx Technologies Inc (http://sphinxsearch.com)

using config file '/etc/sphinxsearch/sphinx.conf'...
indexing index 'huisjesIndex'...
collected 17059 docs, 0.0 MB
total 17059 docs, 0 bytes
total 98.422 sec, 0 bytes/sec, 173.32 docs/sec
total 1 reads, 0.000 sec, 0.0 kb/call avg, 0.0 msec/call avg
total 27 writes, 0.008 sec, 312.9 kb/call avg, 0.3 msec/call avg

# indextool --check huisjesIndex
Sphinx 2.0.4-release (r3135)
Copyright (c) 2001-2012, Andrew Aksyonoff
Copyright (c) 2008-2012, Sphinx Technologies Inc (http://sphinxsearch.com)

using config file '/etc/sphinxsearch/sphinx.conf'...
checking index 'huisjesIndex'...
checking dictionary...
checking data...
checking kill-list...
check passed, 0.0 sec elapsed 
```

但是当我执行 SELECT * FROM huisjesIndex 时，我得到一个空集，但应该有超过 17k 条记录。难道我做错了什么？

```
# mysql -h localhost -P 9306 --protocol=tcp
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1
Server version: 2.0.4-release (r3135)

Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> SELECT * FROM huisjesIndex;
Empty set (0.00 sec) 
```

任何帮助表示赞赏！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:41:43.323

我没有仔细检查，但看起来你已经将 sql_query 中的所有列定义为**Attributes**。

斯芬克斯不喜欢那样。它是一个文本搜索引擎，因此它需要一些全文**Fields**。

一个简单的解决方案（如果您确实想要所有这些属性）是使用 sql_field_string 使您的至少一个列成为字段和属性。

* * *

另一个 odity，但很可能仍然有效，是您使用 a.huis_id 作为 document_id，但将 a.huis_code 分组。如果它们不是 1:1 映射（并且是唯一的），那么您将遇到问题。我认为按document_id分组更常见。

# c++ - 轻量级 C++ 图像库

> ID：11816571
> 
> 赞同：36
> 
> 时间：2012-08-05T12:50:39.657
> 
> 标签：c++, c, performance, image, open-source

我一直在寻找一个简单、小巧但健壮且快速（**不**全面！）的 C++ 图像库（如果没有可用的 C++ 版本，C 就足够了）。

我正在寻找的主要功能是：

*   免费（开源是加分项）
*   **为速度而生**
*   没有巨大的功能膨胀（例如`ImageMagik`，它确实很全面，但却是一个庞然大物）
*   很小的内存占用
*   仅支持加载/保存、调整大小、格式之间转换等功能的绝对最小值。没有什么花哨
*   “损坏”文件的错误恢复（不像`stb_image.c`，它的错误恢复很差）
*   MSVC 和 gcc 友好（我使用`CxImage`了很多年，但在最新版本中，我遇到了 MSVC 2010 的问题，似乎积极的开发和对它的支持现在已经消失了，所以我要放弃它了)
*   应该支持流行的现代格式，如 JPEG2000，直接或通过使用通用库，如`libpng`
*   不要在意它是 DirectX 还是 OpenGL，因为我不打算使用它来显示图像 - 只是为了对网站进行文件处理
*   同时支持静态和动态链接是一个加分项
*   线程支持是一个巨大的优势

我出于某种原因查看并解雇的图书馆：

*   CxImage（不再对其进行积极开发）
*   ImageMagik - 太大（太慢）
*   stb_image.c - 错误处理错误，不支持足够的图像格式
*   DevIL（还没有被解雇，但也没有看太多 - 几分钟前刚刚在 SO 上的类似帖子中了解到它） - 基于它的大小和功能集，它看起来非常有希望满足我的需求
*   FreeImage（与 DevIL 相同 - 稍后会看一下，但它的大小对我来说有点大）
*   土壤（与 stb_image.c 相同）
*   TimThumb - 这是一个 PHP，而不是 C/C++

简而言之，我只想要尽可能小和尽可能快的东西，而代价是只拥有绝对最低限度的功能，但到目前为止我还没有找到合适的候选人。

请问这个社区有什么建议吗？但请记住我上面列出的限制——我认为抛出“你试过 X 吗？”形式的答案是不行的。其中“X”不能满足我一半的需求:)

**编辑**：多看一下 DevIL 似乎它可能是我需要的。它轻巧、小巧、坚固。现在我只需要确保它执行。哦，还有 CImage（我忘了在列表中提到它）——不喜欢它的性能（尽管我不得不承认，仅模板实现的想法很可爱，至少可以这么说）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-05T14:59:14.587

我强烈建议您围绕[libpng](http://www.libpng.org/pub/png/libpng.html)和[jpeglib](http://www.ijg.org/)（以及您需要支持的格式的所有其他低级库）编写一个小库。这并不难，您可以编写所需的所有功能。

作为替代方案，您可以使用该库已经存在的一些好的 c++ 包装器。这里有些例子：

*   [png++](http://www.nongnu.org/pngpp/)
*   [JPEGReader/JPEGWriter](http://cs.nyu.edu/~ajsecord/downloads.html)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-05T12:55:54.637

看看[CImg](http://cimg.sourceforge.net/)库，它只是一个单独的头文件

# css - Internet Explorer 中的 CSS 浮点数

> ID：11816575
> 
> 赞同：0
> 
> 时间：2012-08-05T12:51:01.410
> 
> 标签：css

我目前正在设计一个[简单的博客主题](http://zulhilmizainudin.com/live/)。但是，我有一个问题。放置发布日期、作者姓名和类别名称的“post_meta”部分（包装在一个我让它浮动的类中）在 Internet Explorer 中不能像 Firefox 和 Google Chrome 浏览器那样很好地浮动。

这里的要点是，我只想将“post_meta”部分放在页面的中心。就这样。希望你们能帮助我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:05:18.027

您使用了错误的方法：

1.  删除类 col1 的空 div。
2.  不要将 col2 div 浮动到左侧，而是使用`margin:0 auto;`，这会将其在屏幕上居中：

    ```
    .col2{
       background:;
       height:30px;
       width:350px;
       margin: 0 auto;
      } 
    ```

# asp.net-mvc - 如何重新绑定 Telerik 网格

> ID：11816579
> 
> 赞同：0
> 
> 时间：2012-08-05T12:52:12.307
> 
> 标签：asp.net-mvc, razor, telerik-grid

考虑我在下面提到的 Telrik Grid 并且第一次由员工详细信息（姓名，描述）加载。当我单击网格外的添加按钮时，我想在 telrik 网格中添加一行。我的问题是如何使用现有记录添加新记录。我的意思是如何重新绑定网格。

```
@(Html.Telerik().Grid<Project.Models.Employee>()
    .Name("myName")
    .DataKeys(keys => keys.Add(c => c.EmpId))

    .Columns(columns => {            
        columns.Bound(o => o.Name).Width(200);            
        columns.Bound(o => o.Description).Width(400);
    })
) 
```

请给我更好的解决方案。记住我在网格外面的按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T05:57:05.327

**'这可能会有所帮助'**

```
var grid = $("#Grid").data("tGrid");
//send additional arguments by passing them as a literal JavaScript object
grid.rebind({customerID : "SAJJAD"}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T14:23:03.053

看看下面的例子。此演示说明如何使用 AJAX 对网格进行编辑。

[http://demos.telerik.com/aspnet-mvc/grid/editingajax](http://demos.telerik.com/aspnet-mvc/grid/editingajax)

通过演示 - 事情很清楚该做什么。

Lohith (Tech Evangelist, Telerik India)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T21:10:23.017

如果您在客户端，则可以使用 javascript 函数 rebind()：

```
var grid = $("#Grid").data("tGrid");
//send additional arguments by passing them as a literal JavaScript object
grid.rebind({customerID : "ALFKI"}); 
```

但是对于更多自定义答案，我需要有关您的方案的更多信息。是 ajax 绑定、服务器绑定还是其他。你如何添加行（是在单元格中编辑还是在其他地方编辑）等。

# java - 在 Java 中，您可以在另一个类的构造函数中为一个类调用 setter 吗？

> ID：11816581
> 
> 赞同：0
> 
> 时间：2012-08-05T12:52:18.487
> 
> 标签：java, constructor, setter, getter

如果您有两个类**Boo**和**Foo ，并且****Foo**的每个 Instance 都包含一个**Boo**的实例，那么您可以在**Foo的***构造函数*中包含**Boo**的私有属性的*Setter*吗？

 ****** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:54:50.670

是的，一点没错。为什么你不能？

```
class Boo {
    private String name;

    public void setName(String name) {
        this.name = name;
    }
}

class Foo {
    private final Boo boo;

    public Foo() {
        boo = new Boo();
        boo.setName("boo");
    }
} 
```

您提出这个问题的事实表明您*认为*可能会出错 - 您特别想到了什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T12:56:02.540

更好的答案是自己尝试一下。

在这种情况下，测试和查看结果并不难。

如果不这样做，您还能如何学习编程？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T13:23:26.923

我在您的新代码中看到的问题在这里：

```
 this.name = new Name();
    Name.setFirstName(firstName);
    Name.setLastName(lastName); 
```

`Name`是一个类名。为了`Name.setFirstName()`成为有效的调用，`setFirstName()`必须是`Name`. 大概它是一个实例方法。您需要为该类的特定实例调用它，在本例中是`this.name`. 所以正确的代码是：

```
 this.name = new Name();
    this.name.setFirstName(firstName);
    this.name.setLastName(lastName); 
```

回到你最初的问题——我的猜测是，你得到的不要从构造函数调用 setter 的建议是基于“构造函数不应该有副作用”的想法。在这种情况下，您正在构建一个全新的`Name`对象作为 new 的一部分`Student`，因此进行初始化对象所需的任何调用都是非常合适的。

但是，我不明白为什么你更喜欢这个而不是调用`Name`构造函数。更少的行，整个事情要么成功，要么不成功。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T12:55:29.157

是的你可以。我看不出有什么问题。

编辑：

取消注释您的代码。你的 getter/setter 很好。*****

# php - PHP preg_match 返回 false

> ID：11816582
> 
> 赞同：2
> 
> 时间：2012-08-05T12:52:21.887
> 
> 标签：php

在以下代码中，为什么 PHP preg_match 返回 false？注意：我已经阅读了一些与我的问题标题相同但上下文不同的旧问题

```
<html>
    <head>
    </head>
    <body>
        <?php
        $str = "This is a test for PCRE.";
        $ptrn = "This";
        $preg_match_result_arr;
        $preg_match_result = preg_match($ptrn, $str, $preg_match_result_arr);

        if (1 === $preg_match_result)
        {
            echo "The pattern has matched in the string:<br/>".
                "the match is $preg_match_result_arr[0]<br/>";
        }   
        elseif (0 === $preg_match_result) 
        {
            echo "The pattern has not matched in the string:<br/>";
        }
        elseif (false === $preg_match_result)
        {
            echo "An error has occured in matching<br/>";
        }

        ?>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T12:54:53.927

你的表达不正确，它应该被这样的分隔符包围。

```
$ptrn = '/This/'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T12:54:19.840

您缺少分隔符，您的模式应该看起来像（`#`使用但它可以是其他东西）：

```
$ptrn = "#This#"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-05T12:58:06.057

在'/pattern/'中给出你的模式

例如：

```
$ptrn='/^This/' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-06T12:55:44.883

您可以考虑使用 [T-Regx](https://t-regx.com)，它会为您抛出异常并**自动分隔**您的模式：

```
<?php
    try {
        pattern("This")
            ->match("This is a test for PCRE.")
            ->first(function (Match $match) {
                echo "The pattern has matched in the string:<br/>".
                     "the match is $match<br/>";
            });
    }
    catch (MatchPatternException $e)
    {
        echo "An error has occured in matching<br/>";
    } 
```

或者你可以做

```
if (pattern("This")->matches("This is a test for PCRE.")) {
    echo "The pattern has matched in the string:<br/>";
}
else {
    echo "The pattern has not matched in the string:<br/>";
} 
```

# php - Python 中 PHP 的“$my_array[]”等价于什么？

> ID：11816583
> 
> 赞同：2
> 
> 时间：2012-08-05T12:52:24.913
> 
> 标签：php, python

`$my_array[] = "abc";`我最近开始学习的 Python中 PHP 的“追加到数组”() 的等价物是什么？

假设我有一本这样的字典：

```
my_dict = {'fruits':['orange', 'pear']} 
```

现在我想添加另一种水果`my_dict['fruits']`：`apple`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T12:53:37.207

[`.append()`](http://docs.python.org/library/stdtypes.html#mutable-sequence-types)添加新元素：

```
my_dict = {'fruits':['orange', 'pear']}
my_dict['fruits'].append('apple') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T13:02:53.937

Python 非常适合实验和帮助您找到类似的东西，并且您已经大致知道您在寻找什么（只是命名/术语不同），那么这里有一个提示，应该会让您更容易......

```
>>> my_dict = {'fruits':['orange', 'pear']}
>>> type(my_dict['fruits'])
<type 'list'> 
```

所以我们知道它是列表（在这种情况下是内置列表类型）......我们知道我们想要“添加”一些东西......所以让我们看看它提供了什么......

```
>>> dir(list)
['__add__', '__class__', '__contains__', '__delattr__', '__delitem__', '__delslice__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getslice__', '__gt__', '__hash__', '__iadd__', '__imul__', '__init__', '__iter__', '__le__', '__len__', '__lt__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__reversed__', '__rmul__', '__setattr__', '__setitem__', '__setslice__', '__sizeof__', '__str__', '__subclasshook__', 'append', 'count', 'extend', 'index', 'insert', 'pop', 'remove', 'reverse', 'sort'] 
```

`insert`，`extend`并且`append`看起来很有用...让我们看看它说什么...

```
>>> help(list.extend)
Help on method_descriptor:

extend(...)
    L.extend(iterable) -- extend list by appending elements from the iterable 
```

听起来不太对...

```
>>> help(list.insert)
Help on method_descriptor:

insert(...)
    L.insert(index, object) -- insert object before index 
```

似乎有点具体的定位...

```
>>> help(list.append)
Help on method_descriptor:

append(...)
    L.append(object) -- append object to end 
```

嘿，看起来不错：）

碰巧在这种情况下，您可以这样做`help(my_dict['fruits'])`...

# java - 为什么 Java 的 JMF 在 Linux 中不起作用？

> ID：11816584
> 
> 赞同：0
> 
> 时间：2012-08-05T12:52:29.840
> 
> 标签：java, linux, jmf

我必须在 Linux 中进行一些图像处理。我选择将 JMF 用于我的相机（网络摄像头）。但是我的程序无法访问相机，我收到错误： `javax.media.NoPlayerException: Cannot find a Player for :/dev/video0`. 我在 Windows 中尝试了相同的程序，它运行良好。

JMF 可用于 Linux 和 Windows。它可以安装在操作系统本身中，也可以作为库添加到项目中。我尝试了两种选择。相机的驱动程序在操作系统中可用，因为操作系统中的其他软件可以访问相机。我在我的笔记本电脑和 PC 上尝试过，但我得到了同样的错误。

# xml - XSLT - 在分隔符上分解节点

> ID：11816585
> 
> 赞同：4
> 
> 时间：2012-08-05T12:52:35.007
> 
> 标签：xml, xslt

我需要一个 XSLT 1.0 来分解分隔符上的 XML 节点并创建单个节点。例如，如果分隔符是“_”并且 XML 是：

```
<root>
    <a_b_c>hello<a_b_c>
    <a_b_c1>world</a_b_c1>
</root> 
```

结果 XML 应该是：

```
<root>
    <a>
        <b>
            <c>hello</c>
            <c1>world</c1>
        </b>
    </a>
</root> 
```

不包含分隔符的节点应按原样输出。我在 XSLT1.0 中真的需要这个 谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T18:19:35.620

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

  <xsl:key name="kSameNameAdj" match="*"
  use="concat(generate-id(..),
              '+',
              generate-id(preceding-sibling::*[not(name()=name(current()))][1])
              )"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="/">
  <xsl:variable name="vrtfPass1">
   <xsl:apply-templates select="node()"/>
  </xsl:variable>

  <xsl:apply-templates select="ext:node-set($vrtfPass1)" mode="compress"/>
 </xsl:template>

 <xsl:template name="explode" match=
  "*[contains(name(),'_')
   and not(substring(name(),1,1)='_')
   and not(substring(name(), string-length(name()))='_')
    ]">
    <xsl:param name="pName" select="name()"/>
    <xsl:param name="pText" select="text()"/>

  <xsl:choose>
   <xsl:when test="not($pName)">
    <xsl:value-of select="$pText"/>
   </xsl:when>
   <xsl:otherwise>
      <xsl:element name="{substring-before(concat($pName, '_'), '_')}">
       <xsl:call-template name="explode">
         <xsl:with-param name="pName" select="substring-after($pName, '_')"/>
         <xsl:with-param name="pText" select="$pText"/>
       </xsl:call-template>
      </xsl:element>
   </xsl:otherwise>
  </xsl:choose>
 </xsl:template>

  <xsl:template match="/" name="fold" mode="compress">
  <xsl:param name="pDoc" select="/"/>

  <xsl:choose>
    <xsl:when test="not($pDoc//*[name()=name(following-sibling::*[1])])">
      <xsl:copy-of select="$pDoc"/>
    </xsl:when>
    <xsl:otherwise>
      <xsl:variable name="vrtfThisPass">
        <xsl:apply-templates select="$pDoc/*" mode="compress"/>
      </xsl:variable>

      <xsl:call-template name="fold">
        <xsl:with-param name="pDoc" select="ext:node-set($vrtfThisPass)"/>
      </xsl:call-template>
    </xsl:otherwise>
  </xsl:choose>
 </xsl:template>

 <xsl:template match="node()|@*" mode="compress">
   <xsl:copy>
     <xsl:apply-templates select="@*|node()[1]" mode="compress"/>
   </xsl:copy>
   <xsl:apply-templates select="following-sibling::node()[1]" mode="compress"/>
 </xsl:template>

 <xsl:template match="*[name()=name(following-sibling::*[1])]" mode="compress">
  <xsl:element name="{name()}">
    <xsl:apply-templates mode="compress" select=
    "key('kSameNameAdj',
          concat(generate-id(..),
                 '+',generate-id(preceding-sibling::*)
                 )
         )/node()"/>
  </xsl:element>
  <xsl:apply-templates mode="compress" select=
  "key('kSameNameAdj',
          concat(generate-id(..),
                 '+',generate-id(preceding-sibling::*)
                 )
         )
          [last()]/following-sibling::node()[1]
   "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于以下 XML 文档时**（提供的文档，扩展为更具挑战性）：

```
<root>
   <x>This is:</x>
     <a_b_c>hello</a_b_c>
     <a_b_c_d>my</a_b_c_d>
     <a_b_c1>wonderful</a_b_c1>
     <a_b_c>world</a_b_c>
     <a_b>!</a_b>
   <y>The End</y>
</root> 
```

**产生想要的正确结果**：

```
<root>
   <x>This is:</x>
   <a>
      <b>
         <c>hello<d>my</d>
         </c>
         <c1>wonderful</c1>
         <c>world</c>!</b>
   </a>
   <y>The End</y>
</root> 
```

**说明**：

.1。**这是一个多遍变换**。第一遍将 XML 文档转换为：

```
<root>
   <x>This is:</x>
   <a>
      <b>
         <c>hello</c>
      </b>
   </a>
   <a>
      <b>
         <c>
            <d>my</d>
         </c>
      </b>
   </a>
   <a>
      <b>
         <c1>wonderful</c1>
      </b>
   </a>
   <a>
      <b>
         <c>world</c>
      </b>
   </a>
   <a>
      <b>!</b>
   </a>
   <y>The End</y>
</root> 
```

.2\. **随后的传递，每个将具有相同名称的任何相邻元素组压缩为具有该名称的单个元素**- 然后递归处理结果，直到不再有任何一组超过一个具有相同名称的相邻兄弟元素。

.3\. **第一遍使用[恒等规则](http://dpawson.co.uk/xsl/sect2/identity.html)**。

.4\. **接下来的遍使用“压缩”模式下的[精细标识](https://stackoverflow.com/a/5694777/36305)模板**。

# c# - 如何在 ASP.NET 中添加 Microsoft 报表查看器

> ID：11816588
> 
> 赞同：0
> 
> 时间：2012-08-05T12:53:11.327
> 
> 标签：c#, asp.net, sql-server, microsoft-reporting

我创建了一个表，其中有一个字段`Company`（即公司名称）`Question`和`Answer`. 我还为此编写了一个存储过程，用于检索`Question`，`Answer`并`Company`根据公司名称。

现在我想添加 Microsoft Report Viewer，在顶部显示问题和答案以及公司名称。

存储过程的代码是：

```
ALTER Proc [dbo].[sp_GenerateReport]
(
    @CompanyName varchar(50)
)
AS
BEGIN

SELECT 
      Company,
      Question,
      avg(Answer)
FROM tbl_Answer 
where tbl_Answer.Company=@CompanyName
group by Question,Company

END 
```

表中的列：

```
Id            int               Unchecked
Company       varchar(50)       Checked
Dimension     int               Checked
Section       varchar(50)       Checked
Question      int               Checked
Answer        int               Checked 
```

我想要以图表格式报告，如下图示例所示。在顶部应该有公司名称，在轴上*Season*应该是*Question*并且*Points*应该是*Answer*：

![通缉图](../Images/a4c3cc3bf4c055dbb9bf7cafebd53d85.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:17:46.717

您可以使用 SSRS Sql server Reporting Service 来制作报告，但您必须获得 BI（商业智能）它可以让您轻松制作报告

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T12:58:09.320

请参阅如何在您的网页上添加报表查看器 Web 控件的演练

[http://msdn.microsoft.com/en-us/library/ms252123.aspx](http://msdn.microsoft.com/en-us/library/ms252123.aspx)

[http://msdn.microsoft.com/en-us/library/ms251692.aspx](http://msdn.microsoft.com/en-us/library/ms251692.aspx)

[http://msdn.microsoft.com/en-us/library/ms251682.aspx](http://msdn.microsoft.com/en-us/library/ms251682.aspx)

# automation - 自动化脚本：autoitscript vs ptfbpro

> ID：11816589
> 
> 赞同：-1
> 
> 时间：2012-08-05T12:53:13.187
> 
> 标签：automation, compare, autoit

我尝试将这 2 个项目用于原始 gui 测试自动化：

[http://www.ptfbpro.com/](http://www.ptfbpro.com/)

[http://www.autoitscript.com/](http://www.autoitscript.com/)

而我无法做出选择。有人可以解释一下：为什么（在 2 或 3 行中）他使用其中之一（或其他请指定）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T20:00:42.253

我用**自动**...

因为它是**免费**的，在 Scite 编辑器内部有**很好的文档**（不仅），您可以轻松地**将您的脚本编译**成一个小的**可执行文件**，甚至创建一个完整的**GUI** ，并且在论坛和附近有一个非常好的**社区**。而且它的**基本类语法**非常容易理解，有**函数**甚至是**foreach****语法**、**动态数组**和许多**来自**其他用户的**附加函数......********WinAPI 函数**你缺乏的可能性很小。它甚至可以在不显示浏览器窗口和发送**网络包的情况下****自动使用 IE**，您可以像坐在屏幕前的用户一样发送**击键，还有****AU3Record**工具，它允许您录制宏并重播或将其保存为脚本，然后您可以轻松地对其进行优化并根据需要对其进行编辑。或者使用**AutoIt Window Info**工具查看您的应用程序的所有可能处理，您可以根据您可能发明的不同算法与任何类型的程序输出/显示进行**交互。******

 ******足够的事实？;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T08:58:07.470

使用 Autoit3。它更可靠，并且您拥有完整的脚本语言。Ptfbpro 只是一个工具（不是免费的），仅此而已。AUtoit3 有很多贡献者可以在你的过程中帮助你，Ptfbpro 已经死了。

如果你想要一个真正做你想做的脚本，那就去 AutoIt。ptfbpro 不能用作专业工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T15:19:22.700

Autoit3 也是如此。您真的无法击败它，因为它免费且易于使用。******

# c++ - 编程测试

> ID：11816602
> 
> 赞同：-5
> 
> 时间：2012-08-05T12:54:52.473
> 
> 标签：c++

我正在寻找一个用于编程技能测试的网站。也许免费模拟代码或类似的东西，当你得到一个任务，需要上传一个正确的答案代码，解决任务。即我对c ++感兴趣。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:06:59.063

**你的答案是你应该多尝试自己！**
但有些货：
ACM网站： http: [//icpc.baylor.edu](http://icpc.baylor.edu)
[http://acm.uva.es/contest/](http://acm.uva.es/contest/)
[http://www.codeforces.com](http://www.codeforces.com)
[http://code.google.com/codejam/](http://code.google.com/codejam/)
还有
[http://www0.us.ioccc.org/index.html](http://www0.us.ioccc.org/index.html)
[http://www.mycplus.com/featured-articles/programming-contests-and-challenges/](http://www.mycplus.com/featured-articles/programming-contests-and-challenges/)

# java - 使用 XSL 进行 XML 转换

> ID：11816604
> 
> 赞同：0
> 
> 时间：2012-08-05T12:54:58.903
> 
> 标签：java, xml, xslt, saxon, xalan

我想使用 XSLT 将 XML 文件传输到其他 XML。我想做转换，因为 XML 文件不是纯树结构文档。

这是我之前的文件：

```
<uglyStartTag></uglyStartTag>
    <name>content</name>
<uglyEndTag></uglyEndTag> 
```

或者

```
<uglyStartTag/>
    <name>content</name>
<uglyEndTag/> 
```

这是我的文件之后：

```
<beautyTag>
    <name>content</name>
</beautyTag> 
```

我该怎么做？我不熟悉 XSLT，所以我会感谢任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T15:24:33.077

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
     <xsl:output omit-xml-declaration="yes" indent="yes"/>
     <xsl:strip-space elements="*"/>

     <xsl:template match=
      "node()[preceding-sibling::uglyStartTag
            and
              following-sibling::uglyEndTag
              ][1]">
      <beautyTag>
        <xsl:copy-of select=
         "../node()[preceding-sibling::uglyStartTag
                  and
                    following-sibling::uglyEndTag
                   ]
         "/>
      </beautyTag>
     </xsl:template>
</xsl:stylesheet> 
```

**当应用于此 XML 文档时**（由 OP 在评论中提供）：

```
<t>
    <uglyStartTag />
    <name>dgsdgsdgsdg</name>
    <uglyEndTag />
</t> 
```

**产生想要的正确结果：**

```
<beautyTag>
   <name>dgsdgsdgsdg</name>
</beautyTag> 
```

# hbase - HBase 基于列或基于行

> ID：11816609
> 
> 赞同：8
> 
> 时间：2012-08-05T12:55:33.187
> 
> 标签：hbase

我想知道 HBase 是使用基于列的存储还是基于行的存储？

*   我阅读了一些技术文档并提到 HBase 的优点是使用基于列的存储将相似的数据存储在一起以促进压缩。所以这意味着不同行的相同列存储在一起；
*   但我也了解到 HBase 是一个排序的键值映射。它使用键来处理该键（行）的所有相关列，所以它似乎是基于行的存储？

如果有人能澄清我的困惑，我们将不胜感激。

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-05T13:58:23.733

George，这是我在 HBaseCon 2012 上关于理解 HBase 模式的演示文稿：

[http://www.cloudera.com/content/cloudera/en/resources/library/hbasecon/video-hbasecon-2012-hbasecon-2012.html](http://www.cloudera.com/content/cloudera/en/resources/library/hbasecon/video-hbasecon-2012-hbasecon-2012.html)

简而言之，HBase 中的每一行实际上是一个键/值映射，其中可以有任意数量的列（键），每个列都有一个值。（而且，从技术上讲，每个都可以有多个具有不同时间戳的值）。

此外，“列族”允许您在同一行、不同的物理（磁盘上）文件中托管*多个键/值映射。*这有助于在您的值集通常与其他集不相交地访问的情况下进行优化（因此您可以从磁盘读取的内容更少）。当然，权衡是，如果将列分成两个列族，则读取一行中的所有值需要*更多的工作，因为所需的磁盘访问次数是 2 倍。*

与更标准的“面向列”的数据库不同，我从未听说过有人创建了一个 HBase 表，其中每个逻辑列都有一个列族。有与列族相关的开销，一般建议通常不超过 3 或 4 个。列族是“设计时”信息，这意味着您必须在创建（或更改）表时指定它们。

一般来说，我发现列族是一种高级设计选项，只有在您深入了解 HBase 的架构并且可以证明它会带来净收益时，您才会使用它。

总的来说，虽然 HBase 确实可以以“面向列”的方式运行，但它不是 HBase 中的默认设计模式，也不是最常见的设计模式。最好将其视为具有键/值映射的行存储。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T20:38:54.693

除了 Ian 的出色回答之外，我认为 HBase*既是*基于行的键值对，也是基于列的键值存储（如果您知道行键）。

如果您更喜欢从数据结构的角度来考虑它，那么简单的 HBase 表可能如下所示：

```
'rowkey1' => {
    'c:col1' => 'value1',
    'c:col2' => 'value2',
},
'rowkey2' => {
    'c:col1' => 'value10',
    'c:col3' => 'value3'
} 
```

当然，您也可以在其中存储更复杂的数据结构，正如您从 Ian 的演示文稿中看到的那样。

# php - PHP会话和Objective-c的问题

> ID：11816615
> 
> 赞同：1
> 
> 时间：2012-08-05T12:56:06.150
> 
> 标签：php, objective-c, xcode, session, nsurlconnection

我有两个不同类的两种方法。

“A”类具有使用 NSURLConnection 的登录功能我执行登录。“B”类有一个完全不同的功能，一旦登录，就可以通过另一个 nSURLConnection 调用检索一些数据。

只有当我已经登录时才能执行功能“B”，这就是问题所在。一旦我第一次登录，它说我已经成功登录，但是当我调用其他方法时，我被拒绝了，因为它说我没有登录。

所以我认为是会话问题，我搜索了很多，发现了这个：

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    [receivedData setLength:0];
    NSHTTPURLResponse *urlResponse = (NSHTTPURLResponse *)response;

    NSArray *allCookies = [NSHTTPCookie cookiesWithResponseHeaderFields:[urlResponse allHeaderFields] forURL:[response URL]];

    if ([allCookies count]) {
        [connection cancel];

        [[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookies:allCookies forURL:[response URL] mainDocumentURL:nil];
    NSLog(@"fatto cookie! %@", allCookies);
    }
} 
```

我在“A”类中调用，以便“理论上”在全球范围内保存我的会话，但事实并非如此。

有人可以帮我吗？我错过了什么？

谢谢。

# ios - Django：“禁止 (403) - CSRF 验证失败。请求中止”仅在 Mac 上登录时

> ID：11816616
> 
> 赞同：3
> 
> 时间：2012-08-05T12:56:11.023
> 
> 标签：ios, django, macos, csrf, verification

我对 Django 还很陌生，并且在这里提出了类似的问题以及谷歌结果的页面和页面，但还没有找到解决方法！

我的网站上有一个使用 CSRF 验证的登录表单。虽然我在 PC/Windows 和 Android 手机和平板电脑上没有*任何*问题，但在尝试登录**iPhone 和 Mac 电脑**时收到以下错误：

> **禁止 (403)**
> 
> CSRF 验证失败。请求中止。
> 
> 更多信息可通过 DEBUG=True 获得。

尽管似乎有一些常见问题可以提供快速修复，但我相信我已经涵盖了所有基础。再说一次，正如我之前提到的，我不是 Django 专家。我的设置如下：

## 设置.py

```
MIDDLEWARE_CLASSES = (
'django.middleware.common.CommonMiddleware',
'django.contrib.sessions.middleware.SessionMiddleware',
'django.middleware.csrf.CsrfViewMiddleware',
'django.contrib.auth.middleware.AuthenticationMiddleware',
'django.contrib.messages.middleware.MessageMiddleware', 
```

## 视图.py

```
def default(request):
    if request.user.is_anonymous():
        return HttpResponseRedirect(reverse('auth_login'))
    try:
        request.user.voter
    except Voter.DoesNotExist:
        return render_to_response('main/profile.html', {'form': form},
                   context_instance=RequestContext(request))
    return render_to_response('main/ballot.html', {'form': form},
                   context_instance=RequestContext(request)) 
```

## 登录.html

```
<form action="" method="post" id="authentication_form" class="uniForm">
    {% csrf_token %}
    {{ form|as_uni_form }}
    <div class="buttonHolder">
        <input type="submit" value="Log in" class="primaryAction" />
    </div>
</form> 
```

作为旁注，将 'django.middleware.csrf.CsrfResponseMiddleware' 添加到我的 setting.py 会破坏我的服务器并导致 500 错误。不知道这意味着什么，但我想我会提到它。

# java - Java/Clojure 中的 XML 解析 - 使用 XSD 进行类型强制？

> ID：11816620
> 
> 赞同：3
> 
> 时间：2012-08-05T12:56:28.200
> 
> 标签：java, clojure, xml-parsing

是否有任何 XML 解析器接受 XSD 进行解析，以便他们知道如何正确强制解析出的类型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:30:26.343

许多解析器可以验证 XML 输入文档是否符合 XSD，但大多数解析器不会进一步应用它。

如果您使用 JAXB，它的 xjc 实用程序可以生成带有字段和 JAXB 注释的 Java 类，用于捕获 XSD 中定义的类型，并且通过 JAXB 编组/解组将正确处理这些类型。

有关示例，请参阅[本教程](http://theopentutorials.com/examples/java/jaxb/generate-java-class-from-xml-schema-using-jaxb-xjc-command/)。

Apache 的[XMLBeans](http://xmlbeans.apache.org/)似乎具有类似的功能。

我不确定这些是否完全满足您的需求，但它们是我目前能想到的最接近的。

# linux - bash 中的脚本出错

> ID：11816622
> 
> 赞同：0
> 
> 时间：2012-08-05T12:56:43.677
> 
> 标签：linux, bash, sed

我在 bash 中编写的脚本有一点错误，我不知道我做错了什么

请注意，我使用这个脚本进行了数千次计算，这个错误只发生了几次（比如 20 次左右），但它仍然发生了

脚本的作用是：基本上，它输入一个网页，该网页是我从具有实用程序 w3m 的站点获得的，它计算其中出现的所有单词......在它从最常见的单词到最常见的单词排序之后只发生一次

这是代码：

```
#!/bin/bash
#   counts the numbers of words from specific sites                       #
#   writes in a file the occurrences ordered from the most common         #

touch check         # file used to analyze the occurrences
touch distribution      # final file ordered

page=$1             # the web page that needs to be analyzed
occurrences=$2          # temporary file for the occurrences
dictionary=$3                       # dictionary used for another purpose (ignore this)

# write the words one by column
cat $page | tr -c [:alnum:] "\n" | sed '/^$/d' > check

# lopp to analyze the words
cat check | while read words
do
    word=${words}
    strlen=${#word}
    # ignores blacklisted words or small ones
    if ! grep -Fxq $word .blacklist && [ $strlen -gt 2 ]
    then
        # if the word isn't in the file
        if [ `egrep -c -i "^$word: " $occurrences` -eq 0 ]
        then
            echo "$word: 1" | cat >> $occurrences
        # else if it is already in the file, it calculates the occurrences
        else
            old=`awk -v words=$word -F": " '$1==words { print $2 }' $occurrences`
                    ### HERE IS THE ERROR, EITHER THE LET OR THE SED ###
            let "new=old+1"
            sed -i "s/^$word: $old$/$word: $new/g" $occurrences
        fi
    fi
done

# orders the words
awk -F": " '{print $2" "$1}' $occurrences | sort -rn | awk -F" " '{print $2": "$1}' > distribution

# ignore this, not important
grep -w "1" distribution | awk -F ":" '{print $1}' > temp_dictionary

for line in `cat temp_dictionary`
do
    if ! grep -Fxq $line $dictionary
    then
        echo $line >> $dictionary
    fi
done

rm check
rm temp_dictionary 
```

这是错误：（我正在翻译它，所以英文可能会有所不同）

```
./wordOccurrences line:30 let:x // where x is a number, usually 9 or 10 (but also 11, 13, etc)
1: syntax error in the espression (the error token is 1)
sed: expression -e #1, character y: command 's' not terminated // where y is another number (this one is also usually 9 or 10) with y being different from x 
```

编辑：与 kev 交谈看起来像是换行问题

我在 let 和 sed 之间添加了一个 echo 来打印 sed，它完美地工作了 5 到 10 分钟，直到出现错误。通常没有错误的 sed 看起来像这样：

s/^CONSULENTI：6 美元/CONSULENTI：7/g

但是当我收到错误时，它是这样的：

s/^00145: 1 1$/00145: 4/g

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:35:50.693

如果你在 $old 中得到一个新行，这意味着 awk 打印了两行，所以在 $occurences 中有一个重复。

该脚本计算单词似乎很复杂，并且效率不高，因为它会循环启动许多进程和进程文件；也许你可以做类似的事情

```
sort | uniq -c 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T14:19:34.807

您还应该考虑到您的不区分大小写在整个程序中并不一致。我创建了一个仅包含“foooo”的页面并运行程序，然后创建了一个包含“Foooo”的页面并再次运行程序。'old=`awk...' 行将 'old' 设置为空字符串，因为 awk 区分大小写。这会导致事件文件不被更新。随后的 sed 和可能的一些 grep 也区分大小写。

这可能不是唯一的错误，因为它没有解释您看到的错误消息，但这表明您的脚本将错误地处理具有不同大小写的相同单词。

以下将分隔单词，将它们小写，然后删除小于三个字符的单词：

```
tr -cs '[:alnum:]' '\n' <foo | tr '[:upper:]' '[:lower:]' | egrep -v '^.{0,2}$' 
```

在脚本的前面使用它意味着脚本的其余部分不必区分大小写即可正确。

# canvas - 三.JS——如何设置旋转轴

> ID：11816623
> 
> 赞同：1
> 
> 时间：2012-08-05T12:56:47.263
> 
> 标签：canvas, rotation, webgl, three.js

所以我一直在玩 Three.JS（图形/动画不是我的强项）并想出了这个，改编自一个教程：

[**这是一个 JS 小提琴**](http://jsfiddle.net/DyrEE/1/)

如您所见，我几乎可以肯定是 3D 动画天才。我离题了...

**我的问题是：**如何让物体围绕它们的*中心*旋转——而不是像目前那样围绕四肢旋转？

我知道这个`particle.rotation.set`方法，但我不知道要传递什么值，而且我似乎在 Three.JS 文档中找不到这个方法。环顾四周，我看到人们将`0`值传递给 this，其他人传递 -`Math.PI`派生的值。简而言之，我不确定我在做什么。显然这应该在`makeParticles`函数中使用（如下所示）：

```
function makeParticles() {

     var particle, material;

     // add random particles from close up to far away
     for ( var zpos= -1000; zpos < 1000; zpos+=20 ) {

       // create particle, setting random colour and calling particle renderer
       material = new THREE.ParticleCanvasMaterial({
         color: '0x'+(function() {
             var ret = '';
             for (var i=0; i<6; i++)
               ret += hex_chars.charAt(Math.floor(Math.random() * hex_chars.length));
             return ret;
         })(),
         program: particleRender
       });

       // make the particle and set positional properties (random X / Y)
       particle = new THREE.Particle(material);
       particle.position.x = Math.random() * 1000 - 500;
       particle.position.y = Math.random() * 1000 - 500;
       particle.position.z = zpos;

       // scale and add to scene
       particle.scale.x = particle.scale.y = 50;
       scene.add( particle );

       // and to the array of particles.
       particles.push(particle);
     }

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T09:52:40.893

我对 three.js 不是很熟悉，但更改旋转点的一种方法是将您的particleRender 函数更改为：

```
function particleRender(ctx) {
    ctx.beginPath();
    ctx.save();
    ctx.translate(-1,-1);
    ctx.rect(0, 0, 2, 2);
    ctx.fill();
    ctx.restore();
}; 
```

我在这里猜测，但可能是粒子（由于它们的性质）在 three.js 库中没有实际大小，因此它们的坐标也是它们的旋转中心。要让它们正确旋转，您的绘制方法需要居中。

# z3 - 了解 Z3 中绑定变量的索引

> ID：11816626
> 
> 赞同：6
> 
> 时间：2012-08-05T12:56:59.387
> 
> 标签：z3

我试图了解绑定变量如何在`z3`. 这里有一个片段`z3py`和相应的输出。( [http://rise4fun.com/Z3Py/plVw1](http://rise4fun.com/Z3Py/plVw1) )

```
x, y = Ints('x y')
f1 = ForAll(x, And(x == 0, Exists(y, x == y)))
f2 = ForAll(x, Exists(y, And(x == 0, x == y)))
print f1.body()
print f2.body() 
```

输出：

```
ν0 = 0 ∧ (∃y : ν1 = y)
y : ν1 = 0 ∧ ν1 = y 
```

在`f1`中，为什么同一个绑定变量`x`有不同的索引。（`0`和`1`）。如果我修改`f1`并带出`Exists`，则`x`具有相同的索引（`0`）。

**我想了解索引机制的原因：**

我有一个 FOL 公式，用 scala 中的 DSL 表示，我想发送到`z3`. 现在`ScalaZ3`有一个`mkBound`用于创建将`index`和`sort`作为参数的绑定变量的 api。我不确定应该将什么值传递给`index`参数。所以，我想知道以下几点：

如果我有两个公式`phi1`并且`phi2`具有最大绑定变量索引`n1`和`n2`，那么 in 的索引是`x`多少`ForAll(x, And(phi1, phi2))`

另外，有没有办法以索引形式显示所有变量？`f1.body()`只是`x`以索引形式显示我，而不是`y`. （我认为原因是`y`仍然绑定在`f1.body()`）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T15:21:42.987

Z3 使用 de Bruijn 索引对绑定变量进行编码。以下维基百科文章详细描述了 de Bruijn 索引： [http](http://en.wikipedia.org/wiki/De_Bruijn_index) ://en.wikipedia.org/wiki/De_Bruijn_index 备注：在上面的文章中，索引从 1 开始，在 Z3 中，它们从 0 开始。

关于你的第二个问题，你可以更换 Z3 漂亮的打印机。Z3 发行版包含 Python API 的源代码。漂亮的打印机在文件中实现`python\z3printer.py`。您只需要替换方法：

```
def pp_var(self, a, d, xs):
    idx = z3.get_var_index(a)
    sz  = len(xs)
    if idx >= sz:
        return seq1('Var', (to_format(idx),))
    else:
        return to_format(xs[sz - idx - 1]) 
```

和

```
def pp_var(self, a, d, xs):
    idx = z3.get_var_index(a)
    return seq1('Var', (to_format(idx),)) 
```

如果你想重新定义 HTML 漂亮的打印机，你也应该替换。

```
def pp_var(self, a, d, xs):
    idx = z3.get_var_index(a)
    sz  = len(xs)
    if idx >= sz:
        # 957 is the greek letter nu
        return to_format('&#957;<sub>%s</sub>' % idx, 1)
    else:
        return to_format(xs[sz - idx - 1]) 
```

和

```
def pp_var(self, a, d, xs):
    idx = z3.get_var_index(a)
    return to_format('&#957;<sub>%s</sub>' % idx, 1) 
```

# ruby-on-rails - Rails 3 在 URL 中给出路由错误

> ID：11816627
> 
> 赞同：2
> 
> 时间：2012-08-05T12:57:03.407
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing

当我查询它时，我有一个用 Rails 3 编写的搜索表单，只要我不在查询中添加一个点，一切都可以正常工作。例如：

```
http://localhost:3000/en/job/search/q/test     - WORKS
http://localhost:3000/en/job/search/q/test.    - DOES NOT WORK 
```

末尾带有点的 URL 给出了一个

```
Routing Error: No route matches [GET] "/en/job/search/q/test. 
```

有谁知道我该如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T05:32:16.727

默认情况下，Rails 将小数点右边的所有内容都解释为格式。您需要设置 :constraints

这是一篇关于这个主题的好文章：http: [//coding-journal.com/rails-3-routing-parameters-with-dots/](http://coding-journal.com/rails-3-routing-parameters-with-dots/)

以下是 Rails API 中的参考，可以帮助您解决问题：

[http://guides.rubyonrails.org/routing.html#specifying-constraints](http://guides.rubyonrails.org/routing.html#specifying-constraints)

[http://guides.rubyonrails.org/routing.html#dynamic-segments](http://guides.rubyonrails.org/routing.html#dynamic-segments)

由于您在搜索中将字符串作为获取请求传递，因此您还可以考虑路由通配：http: [//guides.rubyonrails.org/routing.html#route-globbing](http://guides.rubyonrails.org/routing.html#route-globbing)

您的路线将是这样的：

```
match ":language/job/search/*query" 
```

在您的控制器中，您将使用 params[] 数组从路由中获取值：

```
q = params[:query] 
```

将其传递给 ActiveRecord 时一定要使用最佳实践，以避免 SQL 注入攻击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T14:29:27.237

@iltempo 说了什么。

此外，最好将搜索从使用 GET 请求切换为 POST 请求，以消除所有这些问题。

# c# - 带有详细说明的 WP7 按钮

> ID：11816628
> 
> 赞同：0
> 
> 时间：2012-08-05T12:57:16.613
> 
> 标签：c#, windows-phone-7, windows-phone-7.1

创建这样的按钮的最佳方法是什么？

![http://i.stack.imgur.com/4SLjJ.png](../Images/3b98b2568e8a69395c5f0fc13000f378.png)

按钮包含操作和描述...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T14:02:00.747

```
<Button>
    <StackPanel>
        <TextBlock Text="primary text" />
        <TextBlock Text="Lorem ipsum..." />
    </StackPanel>
</Button> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T14:03:34.130

这样的事情会非常接近

```
 <Button HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20" Background="Black">
            <Button.Content>
                <Border BorderThickness="3" BorderBrush="White" Margin="5">
                <StackPanel>
                    <TextBlock FontWeight="Bold" Foreground="White" Margin="3">primary text</TextBlock>
                        <TextBlock Foreground="LightGray"
                                   Margin="3">Lorem ipsum dolor sit amet</TextBlock>
                </StackPanel>
                </Border>
            </Button.Content>
        </Button> 
```

给

![在此处输入图像描述](../Images/084db73673abbebd2cd445986eaf0dfa.png)

# c# - 我可以在转换 int 类型时调用转换错误吗？

> ID：11816636
> 
> 赞同：0
> 
> 时间：2012-08-05T12:58:27.057
> 
> 标签：c#, casting

这是一个不寻常的问题，但在转换数字类型时我无法得到转换错误。我需要得到一些错误，比如“值太短”等，但似乎 C# 很好地保护了它。你能给我提供一个在转换失败的简单代码吗？（如stackoverflow ..）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:06:33.493

您可以使用[checked](http://msdn.microsoft.com/en-us/library/74b4xzyw.aspx)关键字显式检查整数类型转换的溢出：

```
int i = int.MaxValue;
short s = checked((short)i); 
```

还有一个[检查编译器标志](http://msdn.microsoft.com/en-us/library/h25wtyxf.aspx)，可以使检查转换成为默认值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:09:43.910

> 你能给我提供一个在转换失败的简单代码吗？

```
int i = 400;
object o = i; // here o will be System.Int32 automatically

string s = (string)o; //Runtime Exception thrown System.InvalidCastException: 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T13:10:34.053

听起来您正在尝试编写一些错误处理代码。编译器在监视不适当的强制转换方面做得很好，但是如果您正在寻找运行时异常：

```
short y = short.Parse("56789"); 
```

这将抛出一个`OverflowException`.

> OverflowException: 对于 Int16，值太大或太小。

# css - 在 CSS 中加载 @font-face 时如何删除浏览器中的默认字体？“FOUT”

> ID：11816637
> 
> 赞同：7
> 
> 时间：2012-08-05T12:58:30.190
> 
> 标签：css, font-face

我正在使用@font-face 将两种外部字体加载到我的网页中。它们在 Chrome 中加载完美，但是当我在 IE 中尝试时，浏览器在页面加载时显示一些默认字体，然后根据我的 css @font-face 将字体更改为正确的字体。

如何在页面加载时删除默认字体，使其不显示在 IE 和其他浏览器中？我想删除所谓的 FOUT（无样式文本的闪烁）。我有什么办法可以通过样式表来做到这一点？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T13:13:02.210

对于您不想要的默认浏览器字体，请将`font-size`CSS 属性设置为`0px`并确保您已`font-size`在`@font-face`类名中声明 CSS ***rules***。

如果您还想使用专用脚本解决此问题（Firefox 3.5/3.6 或 Internet Explorer 7-9），请查看[**FOUT-B-Gone**](http://www.webink.com/fout-b-gone/) JavaScript 解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:12:49.780

您可以使用 CSS 过渡在 N 毫秒后淡入您的文本，或者您认为足以加载字体资源的任何内容。 [加载时的css3过渡动画？](https://stackoverflow.com/questions/6805482/css3-transition-animation-on-load)

# javascript - chrome中的对象不支持错误

> ID：11816639
> 
> 赞同：0
> 
> 时间：2012-08-05T12:59:01.540
> 
> 标签：javascript, jquery, html

这是我的代码：

```
<html>
<head>
<script type="text/javascript" language="javascript" src="jquery-1.7.1.js"></script>
<script type="text/javascript" language="javascript">
    $(document).ready(function(){
        alert('hei');
    });
</script>
</head>
<body>
  <input type="button" id="btn" />
</body>
</html> 
```

我在`$(document).ready`. 我也收到此错误：`Uncaught SyntaxError: Unexpected token ILLEGAL`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:02:27.243

您的代码似乎是正确的，看起来 jQuery 文件没有加载，验证它是否具有正确的路径。

这有效：

```
<html>                                                                  
<head>                                                                  
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>  
<script type="text/javascript">                                         
    $(document).ready(function() { alert('hi'); });
</script>                                                               
</head>                                                                 
<body>                                                                  
</body>                                                                 
</html> 
```

# java - 传递将两个接口实现为两个不同子类型的类的实例

> ID：11816640
> 
> 赞同：3
> 
> 时间：2012-08-05T12:59:23.483
> 
> 标签：java, oop, interface, polymorphism

如果我有：

```
public interface One{
    public void method1();
}

public interface Two{
    public void method2();
}

public class AClass implements One, Two{

}

public static void aDiffMethod1(One o){
    o.method1();
}

public static void aDiffMethod2(Two t){
    t.method2();
}

public static void main(String[] args){
     AClass a = new AClass();
     aDiffMethod1(a);
     aDiffMethod2(b);
} 
```

有时在我的代码中，我会传递一个 AClass 的实例，因为它是接口 One 的子类型（换句话说，方法的参数类型将是 One，我将传递 AClass 类型），而在其他时候我可能传递 AClass 对象，知道它是接口 Two 的子类型（传递给的方法的参数类型是 Two，所以我将 AClass 作为 Two 的子类型传递）。

可以以不同接口的子类型为幌子将 AClass 的实例传递给不同的方法吗？

这就是他们对接口编程的意思吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:02:11.300

是的，这就是接口的全部意义所在。

只接受接口的方法`One`只会调用`method1`，所以这是安全的。只接受接口的方法`Two`只会调用`method2`，所以再一次，这是安全的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T13:02:31.847

是的，这很好。如果一个方法需要一个接口实现，那么你的 AClass 就满足了这个约定。

对接口而不是实现进行编程是一种设计方法，您可以将行为操作分组到接口中，而不是将其放在主类中。

# mysql - MySQL 一对多：选择仅存在一个关系的位置

> ID：11816643
> 
> 赞同：1
> 
> 时间：2012-08-05T12:59:42.840
> 
> 标签：mysql, select, one-to-many, where-clause, relation

我的表：

```
CREATE TABLE `binary` (
  `binaryid` int(15) unsigned NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`binaryid`)
);

CREATE TABLE `binarycollection` (
  `binaryid` int(10) unsigned NOT NULL,
  `collectionid` int(10) unsigned NOT NULL,
  UNIQUE KEY `collectionid` (`collectionid`,`binaryid`),
  KEY `binaryid` (`binaryid`)
); 
```

在二进制表中，一个 binaryid 只能存在一条记录。binarycollection 表将二进制文件与多个集合联系起来。

我需要做的是进行一个查询，该查询将选择二进制中所有在 binarycollection 中具有恰好 1 个关系的行。

所以举个例子：

```
binary:
1
2
3
4
5
6
7

binarycollection:
(binaryid    collectionid)
1   1
2   1
3   1
3   2
4   1
4   2
5   2
6   2 
```

它应该返回 binaryids 1、2、5 和 6。

任何帮助表示赞赏。:)

附言。这需要高效，表包含数百万行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:08:08.813

使用`GROUP BY`：

```
Select binaryid from binarycollection group by binaryid having count(*)=1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:17:57.370

它应该解决一个简单的查询，因为您的参照完整性不允许在 binarycollection 表中重复对：

```
SELECT binaryid 
FROM binarycollection
GROUP BY binaryid
HAVING ( COUNT(binaryid) = 1 ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T13:55:24.123

`join`它与原始`binary`表一起检查有效参考，`group`然后`binaryID`

```
SELECT  a.binaryid
FROM    `binary` a 
            INNER JOIN `binarycollection` b
                on a.binaryid = b.binaryid
GROUP BY a.binaryid
HAVING  COUNT(a.binaryid) = 1 
```

# java - 在构建 Android 项目时，我可以安全地忽略 Proguard 的“库类的重复定义”吗

> ID：11816645
> 
> 赞同：3
> 
> 时间：2012-08-05T12:59:46.943
> 
> 标签：java, android, eclipse, adt, proguard

我收到了很多`duplicate definition`类似的警告。

```
[proguard] Note: duplicate definition of library class [javax.crypto.KeyGeneratorSpi] 
```

我在 Android 项目中使用 proguard，除非我`-ignorewarnings`在配置中添加，否则我无法构建应用程序。

但是我可以安全地忽略这些警告吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T15:45:31.940

此消息只是一个注释，而不是警告。ProGuard 不会在有注释时停止处理，但默认情况下，它会在出现警告时停止处理。

参照。ProGuard 手册 >[故障排除](http://proguard.sourceforge.net/manual/troubleshooting.html)以查看注释或警告是否严重。对于使用 Android SDK 构建的应用程序：如果它已经在调试模式下工作，那么一切都可能没问题。

# android - 如何在不使用 google api 的情况下翻译文本？

> ID：11816646
> 
> 赞同：-2
> 
> 时间：2012-08-05T12:59:53.470
> 
> 标签：android

是否有任何替代方法可以将文本从一种语言翻译成另一种语言（如英语、西班牙语等），因为它们是付费的？我使用了 LOCALE，但它们不能完美地翻译为 ex。英语中的你好仍然是西班牙语中的你好，任何 hep 都会非常有帮助。先感谢您。

假设我想构建这样的东西。这不是我的应用程序.... [http://www.freeimagehosting.net/uploads/73620ad386.png](http://www.freeimagehosting.net/uploads/73620ad386.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:05:26.700

通常，当您将您的应用程序提交到 Google Play 时，您会获得一个翻译选项，我不确定是否可以正常工作，但另一种选择是自己翻译所有文本并为每个语言使用单独的 values.xml。

编辑：

[Mygengo 翻译 API](http://mygengo.com/api/)
[微软翻译 API](http://www.microsofttranslator.com/dev/)
[Speaklite 翻译 API](http://www.speaklike.com/access-professional-translation-via-api/)
[WebServiceX 翻译 API](http://www.webservicex.net/ws/wsdetails.aspx?wsid=63)

# javascript - 如何在具有滚动条和过滤器的数据表中删除表格标题后的多余空间？

> ID：11816649
> 
> 赞同：0
> 
> 时间：2012-08-05T13:00:11.133
> 
> 标签：javascript, scrollbar, datatables

![在此处输入图像描述](../Images/2f0d5207257836aa9a6279797e9ae925.png)

我正在使用 datatables.net 库。如果我添加滚动条，表头和表体之间会有间隙。有什么办法可以去掉吗？另外，有没有办法将搜索框向左移动，并删除文本“搜索：”，而是将其添加为文本框中的占位符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:19:16.993

我不熟悉该库，但我知道可以轻松修改 CSS 以实现所需的布局。请查看他们关于样式[http://datatables.net/styling/的文档](http://datatables.net/styling/)

# javascript - Valums File Uploader - 仅允许单个文件上传

> ID：11816650
> 
> 赞同：2
> 
> 时间：2012-08-05T13:00:36.090
> 
> 标签：javascript, jquery, file-upload, valums-file-uploader

有没有办法让[Valums File Uploader](https://github.com/valums/ajax-upload)只接受一个文件？

现在，`multiple: false`您不能限制要上传的文件数量，而是可以让用户一个接一个地上传文件，而不是允许多选。

我需要用户只上传一个文件。如果上传文件后正在选择另一个文件，则上传的文件应替换为当前文件。

谁能帮助我实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T06:59:32.537

为了限制上传到单个文件，我简单地使用`onComplete`了回调并删除了上传按钮，希望这会有所帮助：

```
onComplete: function(id, fileName, responseJSON){
                $('.qq-upload-button').remove();
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T07:58:04.903

我认为隐藏按钮不是一个很好的选择，这就是我所做的。

我基本上覆盖了 _storeFileForLater 方法

```
 qq.FileUploaderBasic.prototype._storeFileForLater = function(id){
                  if(!this._options.multiple){ 

                       this._storedFileIds = [];
                       this._storedFileIds.push(id);
                  }
                  else{
                        this._storedFileIds.push(id);
                      }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T04:24:32.757

我在评论这一行时强制选择一个文件

if (this._options.multiple){input.setAttribute("multiple", "multiple");} 和多个：qq.UploadHandlerXhr.isSupported(),

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-22T20:24:07.547

我知道您发布此内容已经有一段时间了，但我刚刚了解到， Valums File Uploader 2.0 beta 版支持**multiple: false**参数。

你可以[在这里](http://valums-file-uploader.github.io/file-uploader/)下载。

# javascript - 为什么这个 Javascript 会抛出错误？

> ID：11816652
> 
> 赞同：1
> 
> 时间：2012-08-05T13:00:59.877
> 
> 标签：javascript, html, microdata

我正在使用最新版本的 Opera。它支持 Microdata API，但是当我键入以下代码时，它不起作用。

```
<head>
<script type="text/javascript">
        var user = document.getItems('http://schema.org/Person')[0];
        alert('Hi there ' + user.properties['name'][0].textContent + '!');
        function supports_microdata_api() {
             return !!document.getItems;
        }
        alert(supports_microdata_api());
        </script>
    </head>
<body>
<div itemscope itemtype="http://schema.org/Person">
  <span itemprop="name">Fatima Zohra</span>
  <img src="" itemprop="image" />
</div> 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:13:20.993

您需要等到页面加载；你在呼唤一些东西：

```
document.getItems('http://schema.org/Person')[0] 
```

那还不是 DOM 的一部分；您的代码在 DOM 知道“尚未见过”的元素之前运行。

用于`window.onload`等待页面`onload`事件触发，该事件在元素被解析后发生。

```
window.onload = function(){
    var user = document.getItems('http://schema.org/Person')[0];
    console.log(user);
    console.log('user.properties Name: ' + user.properties['name'][0].textContent);
    function supports_microdata_api() {
        return !!document.getItems;
    }
    console.log(supports_microdata_api());
}; 
```

[http://jsfiddle.net/eY63s/2/](http://jsfiddle.net/eY63s/2/)

或者，也可以按页面顺序将代码放在 DOM 元素*之后。*

一种更现代的方法是使用事件委托：

```
window.addEventListener('load', function(){
    var user = document.getItems('http://schema.org/Person')[0];
    console.log(user);
    console.log('user.properties Name: ' + user.properties['name'][0].textContent);
    function supports_microdata_api() {
        return !!document.getItems;
    }
    console.log(supports_microdata_api());
}); 
```

[http://jsfiddle.net/eY63s/3/](http://jsfiddle.net/eY63s/3/)

尽管至少支持早期版本的 IE `element.attachEvent`，但[IE9 或更高版本](https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener#Compatibility)的浏览器确实/将支持`element.addEventListener`.

这是检查和调用方法的更安全的方法：

```
window.addEventListener('load', function(){
    var user;

    function supports_microdata_api() {
        return !!document.getItems;
    }

    console.log('Microdata support: ' + supports_microdata_api());

    if (supports_microdata_api()) {
        user = document.getItems('http://schema.org/Person')[0];
        console.log(user);
        console.log('user.properties Name: ' + user.properties['name'][0].textContent);
    }
}); 
```

[http://jsfiddle.net/eY63s/4/](http://jsfiddle.net/eY63s/4/)

注意`var user`匿名函数内部的使用，它创建一个闭包并防止`user`逃逸到全局范围。这是一种处理变量的“更好”方式，可以帮助防止它们由于全局共享而被意外覆盖。另一方面，您将无法`user`从该范围之外调用。但是，请抵制将其推向全球范围的冲动，这可能更容易，但却是一个坏习惯，并且有时容易出现难以发现的错误。

# java - Java 泛型说明

> ID：11816653
> 
> 赞同：4
> 
> 时间：2012-08-05T13:01:06.250
> 
> 标签：java, generics

在我尝试编写以下内容之前，我虽然了解 Java 泛型：

```
class A{}

class B{
    A a;

    <T extends A> T getA(){ 
       return a; // does not compile
    }
} 
```

我收到一个编译错误，说类型不兼容：需要 T，找到 A。

1.  为什么我会收到错误消息？
2.  我很乐意参考一篇描述这种 Java 泛型陷阱的文章。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-05T13:03:48.050

如果它编译，它将不是类型安全的：

```
B b = new B();
b.a = new A();

SubclassOfA foo = b.<SubclassOfA>getA(); 
```

编译器不能保证`a`它将是 的实例`T`，并且由于类型擦除，它甚至无法在执行时检查它 - 所以它不会编译。

一般来说，[Java 泛型常见问题解答](http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html)几乎涵盖了所有内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T13:05:33.790

这是一个应该可以工作的版本：

```
class B<T extends A>{
    T a;

    T getA(){ 
       return a;
    }
} 
```

客户端代码可以确定 getA() 返回 A 的子类型，就像上面一样，但编译器也可以确定它是正确的 A 子类型

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-08-05T13:06:20.490

`T extends A`手段`T`必须是子类`A`而不是`A`自身。在你的情况下，你想要类似的东西：

```
<T> T getA() {
    return a;
} 
```

这是[关于 java 泛型的教程](http://docs.oracle.com/javase/tutorial/extra/generics/index.html)。

# php - PHP RegEx - * 不够贪婪

> ID：11816658
> 
> 赞同：0
> 
> 时间：2012-08-05T13:02:20.377
> 
> 标签：php, regex

我执行这个：

```
$string = preg_replace('/^([^\|]*)(?!\|\|Read)/','$1||Read',"test||Read");
echo "$string<br>";
$string = preg_replace('/^([^\|]*)(?!.*Read)/','$1||Read',"test||Read");
echo "$string<br>"; 
```

我明白了：

```
tes||Readt||Read
test||Read 
```

这个想法是在字符串（不包含管道）之后添加“||Read”，如果它不存在。那么为什么第一个 RegEx 中的 * 只消耗“tes”？

第二个正则表达式有效，因为第一个 * 使用“tes”，而断言中的第二个 * 匹配“t||” .

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:22:21.520

您可以通过在量词后添加一个加号来使其更加贪婪或[“占有欲” ：](http://www.regular-expressions.info/possessive.html)`+``*`

```
 ([^\|]*+) 
```

所以你的代码变成：

```
 $string = preg_replace('/^([^\|]*+)(?!\|\|Read)/','$1||Read',"test||Read"); 
```

对于您的测试用例来说，这不会`t`结束。

在您的情况下，`||Read`应该始终出现在行尾？如果是这样，您也可以只使用`^(.*?)$`for 匹配，并改为断言 line end `(?<!Read)$`。

# exception - 在 grails 应用程序中自定义 ehcache.xml 后引发异常

> ID：11816664
> 
> 赞同：7
> 
> 时间：2012-08-05T13:03:33.423
> 
> 标签：exception, grails, configuration, ehcache

为了在我的 grails 应用程序中个性化 ehcache，我将以下 xml 添加到 config 目录：

```
<?xml version="1.0" encoding="UTF-8"?>
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="ehcache.xsd" >
<diskStore path="/path/to/store/data"/>
<cacheManagerEventListenerFactory class="" properties=""/>
<defaultCache
   maxEntriesLocalHeap="10000"
   eternal="false"
   timeToLiveSeconds="120">
   <persistence strategy="none"/>
</defaultCache>
<cache name="Book"
  maxEntriesLocalHeap="10000"
  timeToIdleSeconds="300"
   />
<cache name="org.hibernate.cache.UpdateTimestampsCache"
  maxEntriesLocalHeap="10000"
  timeToIdleSeconds="300"
   />
<cache name="org.hibernate.cache.StandardQueryCache"
  maxEntriesLocalHeap="10000"
  timeToIdleSeconds="300"
   />
</ehcache> 
```

令我惊讶的是，当启动时，grails 应用程序停止并出现以下异常：

```
Caused by: net.sf.ehcache.CacheException: Error configuring from input stream. Initial  cause was null:9: Element <defaultCache> does not allow attribute "maxEntriesLocalHeap".
at    net.sf.ehcache.config.ConfigurationFactory.parseConfiguration(ConfigurationFactory.java:152)
at net.sf.ehcache.config.ConfigurationFactory.parseConfiguration(ConfigurationFactory.java:99)
... 30 more 
```

有什么提示吗？我正在使用 grails 1.3.9；谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-03T13:30:51.110

Spring遇到了同样的问题，`maxEntriesLocalHeap`并`maxEntriesLocalDisk`抛出了同样的异常。似乎对我有用的是使用`maxElementsInMemory`and `maxElementsOnDisk`。[从javadoc](http://ehcache.org/apidocs/net/sf/ehcache/config/CacheConfiguration.html)找到它们。

现在，基于它们已被弃用，我假设我的 conf 和你的 conf 中都有旧版本的 EHCache。

根据[这张表](http://jsoftbiz.wordpress.com/2012/05/24/ehcache-size-configuration-8/)，maxEntriesLocalHeap 出现在 EHCache 2.5 上。在此之前它是 maxElementsInMemory。当我遇到麻烦时，我使用了[ehcache-spring-annotations](http://code.google.com/p/ehcache-spring-annotations/)，在撰写本文时，它的版本为 1.2.0，随 ehcache 2.4.5 一起提供 - 因此不支持这些属性。

在进行纯 Spring 配置和对 EHCache 2.5 的显式依赖之后，问题消失了，我能够使用我最初打算使用的属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T10:41:47.500

在最新版本的 Ehcache (2.6.x) 中添加了诸如“maxEntriesLocalHeapEhcache”之类的标签或诸如“持久性”之类的内部元素。

我会选择：A）使用'maxElementsInMemory'（而不是'maxEntriesLocalHeap'）；使用 'overflowToDisk' 和 'diskPersistent' 属性（而不是 'persistence' 元素），... B）尝试获取最新版本的插件或手动将最新的 jar 添加到您的项目中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-19T00:32:44.123

如果你使用休眠

4.3.5 或 4.3.7 版本依赖于 Ehcache 2.4.7，该版本没有属性 maxEntriesLocalHeap 和 maxEntriesLocalDisk 。

关于 Ehcache 2.4.x 的文档：[http://ehcache.org/files/documentation/EhcacheUserGuide.pdf](http://ehcache.org/files/documentation/EhcacheUserGuide.pdf)

我使用休眠 4.3.5 的示例：

```
<defaultCache maxElementsInMemory="10000"
              eternal="false"
              timeToIdleSeconds="300"
              timeToLiveSeconds="600"
              diskSpoolBufferSizeMB="30"
              maxElementsOnDisk="10000"
              diskExpiryThreadIntervalSeconds="120"
              memoryStoreEvictionPolicy="LRU" statistics="false">
</defaultCache>

<cache
        name="org.hibernate.cache.spi.UpdateTimestampsCache"
        maxElementsInMemory="10000"
        eternal="false">
</cache>

<cache
        name="org.hibernate.cache.internal.StandardQueryCache"
        maxElementsInMemory="10000"
        eternal="false"
        timeToLiveSeconds="300">
</cache>

<!--
If you are concerned about cpu utilisation and locking in the DiskStore, you can set the
diskExpiryThreadIntervalSeconds to a high number - say 1 day. Or you can effectively turn it off by
setting the diskExpiryThreadIntervalSeconds to a very large value
-->
<cache
        name="br.com.atlantico.toi.model.calc.Anomalia"
        maxElementsInMemory="10000"
        eternal="false"
        timeToIdleSeconds="300"
        timeToLiveSeconds="600"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-20T03:15:37.053

正如eis所说，Hibernate-ehcache内部使用ehcache 2.4.3，但该版本不支持属性。您需要使用更高版本的 ehcache。

这里只是尝试添加更详细的配置：

首先，将 hibernate-ehcache 和 ehcache-core 添加到 maven pom。

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-ehcache</artifactId>
    <version>${hibernate.version}</version>
</dependency>
<dependency>
    <groupId>net.sf.ehcache</groupId>
    <artifactId>ehcache-core</artifactId>
    <version>2.6.5</version>
</dependency> 
```

然后，在您的 spring 配置中设置会话工厂的属性。使用 org.hibernate 中的类。*，而不是来自 net.sf.ehcache。*

```
<prop key="hibernate.cache.region.factory_class">org.hibernate.cache.ehcache.EhCacheRegionFactory </prop> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-29T05:10:54.497

我遇到了类似的问题，我通过使用以下 jars 解决了。

1.  ehcache.2.9.jar
2.  logback-core-1.0.13.jar
3.  logback-classic-1.0.13.jar

您在项目路径中添加上面的 jars.. 它会正常工作。

# entity-framework - DropDown的ASP MVC模型绑定失败

> ID：11816665
> 
> 赞同：0
> 
> 时间：2012-08-05T13:03:37.197
> 
> 标签：entity-framework

我有 ASP MVC 4 项目。我有一个问题，当我尝试创建新的调查时，控制器中的代码也无法将发布的表单数据绑定到模型。

具体错误是：

> 从类型“System.String”到类型“DNASurvey.Models.Tenant”的参数转换失败，因为没有类型转换器可以在这些类型之间进行转换。{System.InvalidOperationException}

这些是我拥有的模型：

```
public class Tenant {
    [Key]
    public string TenantID { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Survey> Surveys { get; set; }
  }

  public class Survey {
    [Key]
    public string SurveyID { get; set; }

    [Required]
    public virtual Tenant Tenant { get; set; }

    [Required]
    [StringLength(100, MinimumLength=5)]
    public string Title { get; set; }

    [Required]
    public DateTime CreatedAt { get; set; }

    [Required]
    public uint CurrentRoundIndex { get; set; }
  } 
```

我也有带有此相关代码的 SurveyController：

```
public ActionResult Create() {
  AddPossibleTenants();
  return View();
}

//
// POST: /Survey/Create

[HttpPost]
public ActionResult Create(Survey survey) {
  if (ModelState.IsValid) {
    survey.SurveyID = EncodeNameToSingleString(survey.Title);
    db.Surveys.Add(survey);
    db.SaveChanges();
    return RedirectToAction("Index");
  }

  AddPossibleTenants();
  return View(survey);
}

private void AddPossibleTenants() {
  ViewBag.PossibleTenants = db.Tenants.ToList();
} 
```

这个视图用于创建：

```
@model DNASurvey.Models.Survey

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Survey</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Tenant)
        </div>
        <div class="editor-field">
            @Html.DropDownListFor(model => model.Tenant, new SelectList(ViewBag.PossibleTenants, "TenantID", "Name"))
            @Html.ValidationMessageFor(model => model.Tenant)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Title)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Title)
            @Html.ValidationMessageFor(model => model.Title)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.CreatedAt)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.CreatedAt)
            @Html.ValidationMessageFor(model => model.CreatedAt)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:12:04.257

您的表单正在为租户生成一个选择元素，它将传回一个简单的名称-值对。这不会绑定到模型的租户属性，因为租户在模型中定义为对象，而不是字符串。您需要定义自己的[自定义模型绑定器](https://stackoverflow.com/questions/1193453/asp-net-mvc-custom-model-binding-explanation)才能使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:39:53.643

我发现[了这一系列关于 EF 和 MVC 的帖子](http://blog.stevensanderson.com/2011/01/28/mvcscaffolding-one-to-many-relationships/)。 [这篇文章](http://blog.stevensanderson.com/2011/01/28/mvcscaffolding-one-to-many-relationships/)解释了如何使用脚手架命令创建控制器以及如何构建模型以便 EF 和 MVC 都能正常工作。

# android - 执行一个动作后，如何延迟新动作的开始？

> ID：11816668
> 
> 赞同：0
> 
> 时间：2012-08-05T13:04:14.447
> 
> 标签：android

我有一个变量，我已将其设置为 3。每次单击按钮时，它都会递减并执行所需的操作。当它达到 0 时，我希望动作应该在屏幕上显示一段时间，然后它会移动到新的活动。

但问题是当它达到 0 时，它不会持续一段时间让用户看到执行了什么操作，它只是跳转到下一页......有什么办法可以做到这一点？

我正在使用的代码是：

```
if(ch==0)
{
try {

        Thread.sleep(15*1000);
    startActivity(new Intent("com.example.quizproject.Menu"));
} catch (InterruptedException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}
} 
```

使用此代码后，变量达到 0 ，它没有完成上一个动作，而是暂停然后移动到下一个活动。

这个问题有什么可能的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:21:21.900

您可以创建一个扩展 Thread 的类，例如`MyThread`：

```
public class MyThread extends Thread {

    SampleActivity sampleActivity;

    public MyThread(SampleActivity sampleActivity){
        this.sampleActivity = sampleActivity;
    }

        public void run() {
            try {
                sleep(15*1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

            Intent i = new Intent(this.sampleActivity, Asleep.class);
            sampleActivity.startActivity(i);
        }

} 
```

**编辑**：
然后在您想启动 Activity 时使用它，这`sampleActivity`是第一个 Activity（第一个问题），`Asleep`是 15 秒后出现的 Activity（第二个问题）。例如，在按钮的单击侦听器中`sampleActivity`这样做：

```
MyThread mt = new MyThread(this);
mt.start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:13:04.313

为什么要让线程休眠？您将查找主线程并且用户不会转到 Intent，因为线程（睡眠）在 Intent 之前。

这就是为什么。

所以：

```
while (ch <=0) {
Intent i = new Intent (this, menu.class);
startActivity(i);
} 
```

# c# - C# 和 Python 中的 int 是一回事吗？

> ID：11816669
> 
> 赞同：1
> 
> 时间：2012-08-05T13:04:20.950
> 
> 标签：c#, python, sockets, tcp

我需要通过网络从 C# 向 Python 发送一个整数，我发现如果两种语言的“规则”相同，并且它们的字节大小相同，应该是缓冲区大小，我可以`int(val)`在 Python 中......我不能吗？

两者都有 32 位的大小，所以在 Python 和 C# 中我应该能够设置

C＃：

```
String str = ((int)(RobotCommands.standstill | RobotCommands.turncenter)).ToString();
Stream stream = client.GetStream();

ASCIIEncoding asen = new ASCIIEncoding();
byte[] ba = asen.GetBytes(str);

stream.Write(ba, 0, 32); 
```

Python：

```
while True:
    data = int( conn.recv(32) );

    print "received data:", data    

    if( (data & 0x8) == 0x8 ):
        print("STANDSTILL");

    if( (data & 0x20) == 0x20 ):
        print("MOVEBACKWARDS"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T14:20:46.260

```
data = int( conn.recv(32) ); 
```

1.  那是 32 字节而不是 32 位
2.  这是一个最大值，你得到的可能比你要求的少
3.  `int(string)`做类似`int('42') == 42`, 和`int('-56') == -56`. 也就是说，它将人类可读的数字转换为 int。但这不是你在这里处理的。

你想做这样的事情

```
# see python's struct documentation, this defines the format of data you want
data = struct.Struct('>i') 
# this produces an object from the socket that acts more like a file
socket_file = conn.makefile()
# read the data and unpack it
# NOTE: this will fail if the connection is lost midway through the bytes
# dealing with that is left as an exercise to the reader
value, = data.unpack(socket_file.read(data.size)) 
```

**编辑**

看起来您也在 C# 代码中错误地发送了数据。我不知道 C#，所以我不能告诉你如何正确地做到这一点。任何这样做的人，请随时在更正中进行编辑。

# ios - 在构建路径时绘制 CGPath

> ID：11816670
> 
> 赞同：4
> 
> 时间：2012-08-05T13:04:59.363
> 
> 标签：ios, core-graphics, cgpath

是否可以在创建时绘制 CGPath（添加每条线），而不是瞬间绘制点的整个路径？我想看到在添加线条时绘制的路径。

另外，是否可以一次绘制一条线作为较大路径的一部分，而不是每次都用一条额外的线在其自身上绘制路径？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:10:24.007

如果您使用 CAShapeLayer 并将路径设置为其路径属性，则可以为 strokeEnd 值设置动画。

我不知道动态添加它会有多简单，但我之前用它来为沿途的时间点制作动画（但这些线的整个路径都是事先知道的）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T20:25:32.950

@wattson12 绝对正确。这是我过去如何做的一个例子：

```
- (void)animateBezier
{
    CAShapeLayer *bezier = nil;
    UIBezierPath *bezierPath = [self bezierPath]; // clearly, generate your path anyway you want

    bezier = [[CAShapeLayer alloc] init];

    bezier.path = bezierPath.CGPath;
    bezier.strokeColor = [UIColor redColor].CGColor;
    bezier.fillColor   = [UIColor clearColor].CGColor;
    bezier.lineWidth   = 5.0;
    bezier.strokeStart = 0.0;
    bezier.strokeEnd   = 1.0;
    [self.view.layer addSublayer:bezier];

    CABasicAnimation *animateStrokeEnd = [CABasicAnimation animationWithKeyPath:@"strokeEnd"];
    animateStrokeEnd.duration  = 1.0;
    animateStrokeEnd.fromValue = [NSNumber numberWithFloat:0.0f];
    animateStrokeEnd.toValue   = [NSNumber numberWithFloat:1.0f];
    [bezier addAnimation:animateStrokeEnd forKey:@"strokeEndAnimation"];
} 
```

我不知道这是否是您想要的，或者您是否还想稍后动画添加路径中的附加点。如果这是您想要的，您可能会做一些相应的调整 fromValue 的操作，或者将另一个段的绘图动画化为单独的路径。

# c# - 如何将一周中的这一天转换为位掩码？

> ID：11816672
> 
> 赞同：3
> 
> 时间：2012-08-05T13:05:14.260
> 
> 标签：c#, .net, c#-4.0, bit-manipulation, bitmask

我有一个使用枚举将位掩码转换为天数列表的方法。我试图做相反的事情，但遇到了麻烦。我有`DaysOfWeekToEnum`工作，但没有`DaysOfWeekFromEnum`。以下是我正在尝试做的事情。任何人都可以帮忙吗？

```
public static short DaysOfWeekFromEnum(IEnumerable<DaysInWeekIds> daysOfWeek)
{
    short mask;

    foreach (var item in daysOfWeek)
    {
        mask &= item; // ????
    }

    return mask
}

public static IEnumerable<DaysInWeekIds> DaysOfWeekToEnum(short mask)
{
    var values = new List<DaysInWeekIds>();

    foreach (short enumValue in Enum.GetValues(typeof(DaysInWeekIds)))
    {
        if (mask & enumValue == enumValue)
        {
            values.Add((DaysInWeekIds) Enum.ToObject(typeof(DaysInWeekIds),
                enumValue));
        }
    }

    return values;
}

/// <summary> The days in week ids. </summary>
public enum DaysInWeekIds : short
{
    M = 1,
    Tu = 2,
    W = 4,
    Th = 8,
    F = 16,
    Sa = 32,
    Su = 64
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:08:52.337

设置附加位应该是`|=`，而不是。`&=`

您还可以将字符串表示形式连接在一起，并将结果传递给`Enum.Parse`方法。这效率不高，但代码看起来会更短。

```
var res = (DaysInWeekIds)Enum.Parse(
    typeof(DaysInWeekIds)
,   string.Join(",", daysOfWeek.Select(d => d.ToString()).ToArray())
); 
```

这将返回`25`（[链接到 ideone](http://ideone.com/SCBSW)`{M, Th, F}`）。

# android - 在旋转之前显示部分 ImageView 屏幕外？

> ID：11816683
> 
> 赞同：2
> 
> 时间：2012-08-05T13:06:28.970
> 
> 标签：android, android-layout

我只想在屏幕上显示我的图像视图的一部分..现在它是右下角的相对布局..下面第一个屏幕截图中的蓝色圆圈..

蓝色圆圈将成为“可扩展”菜单按钮/抽屉。我想要做的方式是只显示圆圈的左上象限，然后当有人触摸蓝色区域时旋转它，这将显示圆圈的另一半（我将在其顶部添加按钮）。

第一个屏幕截图是我现在拥有的，第二个屏幕截图显示了我想如何将大部分圆圈推到屏幕外。

这支持吗？

![我现在所拥有的，但我希望圆圈的中心位于布局的右下角像素，而不是圆圈的角落。我希望最初的大部分圆圈实际上不在屏幕上。](../Images/838d90fc69b9b18813aa37ee8f7a0ba3.png)

![在此处输入图像描述](../Images/2b1f98a560d97346612aaef29f03f333.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T13:54:57.837

> 这支持吗？

是的，您可以使用负边距：

```
<RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ImageView
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:layout_alignParentBottom="true"
        android:layout_alignParentRight="true"
        android:layout_marginBottom="-24dp"
        android:layout_marginRight="-24dp"
        android:src="@drawable/ic_launcher" />
</RelativeLayout> 
```

# python - Pythonic 列表转字符串方法

> ID：11816685
> 
> 赞同：3
> 
> 时间：2012-08-05T13:06:36.253
> 
> 标签：python

所以我想知道将列表转换为字符串的最“pythonic”方式是什么。

例如：

```
string_list = ['h', 'e', 'l', 'l', 'o']
# to the string
string = 'hello' 
```

我一直在使用这种`''.join(string_list)`方法，但感觉做这么简单的事情几乎是不可读和迂回的方法。

有没有更好的方法，还是我过于复杂了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T13:21:04.727

不，这是pythonic的方式。

也许你觉得它应该是：`string_list.join('')`. 你[并不孤单](https://stackoverflow.com/questions/493819/python-join-why-is-it-string-joinlist-instead-of-list-joinstring)。

可能最重要的优势是，这使得 `.join()`可以使用*任何*可迭代的东西。

如果反过来，每个集合都需要自己实现一个`join()`方法。如果你要创建自己的集合，你会添加一个`.join()`方法吗？可能不是。

它是`str`类的方法这一事实意味着它将*始终*有效。没有惊喜。阅读这里关于Python和作者 Armin Ronacher[的最小惊讶原则](http://lucumr.pocoo.org/2011/7/9/python-and-pola/#seemingly-inverse-logic)`join()`和其他内容。`Flask`

可以对`len()`函数/运算符进行类似的论证，可以在上述文章的开头找到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-05T13:11:54.160

使用`''.join(string_list)`. 请注意，`list`命名为内置类型，因此不应将其用于变量名称。由于 Python 字符串是不可变的，因此无论如何都需要构造一个新字符串。`''.join(s)`是在 Python 中执行此操作的规范且有效的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-05T13:09:35.543

我认为你过于复杂了。这是来自python本身：

```
>>> list = ['h', 'e', 'l', 'l', 'o']
>>> sum(list, '')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: sum() can't sum strings [use ''.join(seq) instead] 
```

因此，python 的建议是使用`''.join`.

# c++ - 如何使用 Xcode 附带的命令行工具使用外部库编译和构建程序？

> ID：11816688
> 
> 赞同：0
> 
> 时间：2012-08-05T13:07:08.843
> 
> 标签：c++, xcode, opencv, terminal, clang++

我正在通过 Xcode 4.4 编写一个使用 OpenCV 2.4 的计算机视觉程序。我想通过 g++ 或 make 命令在终端中编译并制作它。但是系统显示很多错误，编译器找不到“opencv2/opencv.hpp”文件和Vec3d等..！

我的问题是如何配置我可以在终端中制作和构建代码的系统？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:41:53.840

首先，你需要有命令行工具（我猜你已经有了）

1.  在 Xcode 中调出首选项
2.  选择“下载”选项卡
3.  选择“组件”选项卡
4.  单击命令行工具行上的“安装”。

然后，您需要安装 OpenCV。我建议使用[Homebrew](https://brew.sh/)

1.  设置自制软件，然后
2.  `brew install opencv`

它将在 /usr/local 中安装库，该库位于 g++ 的标准查找路径中，因此应该没问题。

如果您仍需要帮助，请发布日志文件。

# java - 如何从 json google places api 中检索“locality”

> ID：11816694
> 
> 赞同：0
> 
> 时间：2012-08-05T13:08:22.043
> 
> 标签：java, json, api, google-maps, google-maps-api-3

如何从 json google places api 中检索“locality”

在这个 json 响应中：

```
{
   "html_attributions" : [],
   "result" : {
      "address_components" : [
         {
            "long_name" : "1623",
            "short_name" : "1623",
            "types" : [ "street_number" ]
         },
     {
        "long_name" : "1/2 N Cahuenga Boulevard",
        "short_name" : "1/2 N Cahuenga Boulevard",
        "types" : [ "route" ]
         },
         {
            "long_name" : "Los Angeles",
            "short_name" : "Los Angeles",
            "types" : [ "locality", "political" ]
         },
         {
            "long_name" : "CA",
            "short_name" : "CA",
            "types" : [ "administrative_area_level_1", "political" ]
         },
         {
            "long_name" : "US",
            "short_name" : "US",
            "types" : [ "country", "political" ]
         },
     {
        "long_name" : "90028",
        "short_name" : "90028",
        "types" : [ "postal_code" ]
     } 
```

我正在使用此代码来获取“lat”和“lng”：

```
 JSONObject jsonLocation = c.getJSONObject("geometry").getJSONObject("location");

            places_latitude = jsonLocation.getString("lat");
            places_longitude = jsonLocation.getString("lng"); 
```

我如何获得“位置”值？我正在使用java。

谢谢，

卡洛斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T04:10:12.553

我按照你的方式。

```
JSONArray address_components = c.getJSONObject("result").getJSONArray("address_components");

JSONObject obj = address_components.getJSONObject(2)
/*
 obj is 
  {
            "long_name" : "Los Angeles",
            "short_name" : "Los Angeles",
            "types" : [ "locality", "political" ]
   }
 */
String your_result = obj.getJSONArray("types").get(0).toString(); 
```

原始的json应该是

```
{
   "html_attributions" : [],
   "result" : {
      "address_components" : [
         {
            "long_name" : "1623",
            "short_name" : "1623",
            "types" : [ "street_number" ]
         },
     {
        "long_name" : "1/2 N Cahuenga Boulevard",
        "short_name" : "1/2 N Cahuenga Boulevard",
        "types" : [ "route" ]
         },
         {
            "long_name" : "Los Angeles",
            "short_name" : "Los Angeles",
            "types" : [ "locality", "political" ]
         },
         {
            "long_name" : "CA",
            "short_name" : "CA",
            "types" : [ "administrative_area_level_1", "political" ]
         },
         {
            "long_name" : "US",
            "short_name" : "US",
            "types" : [ "country", "political" ]
         },
     {
        "long_name" : "90028",
        "short_name" : "90028",
        "types" : [ "postal_code" ]
     }
    ]
   }
} 
```

# java - GQL 仅适用于 Python 项目而不适用于 java？

> ID：11816695
> 
> 赞同：5
> 
> 时间：2012-08-05T13:08:34.627
> 
> 标签：java, python, database, google-app-engine, gql

在 Google App Engine 中，GQL（一种类似 SQL 的查询机制 foe 数据存储）仅适用于 Python 项目，不适用于 Java 项目。为什么会这样？

还有它无论如何要克服这个并**在java项目中使用GQL**吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T20:46:44.487

GQL 不在 Java 实现中，作为替代，您将使用该`Query`对象来构建数据存储查询。

如果您正在寻找 Java 的 GQL 实现，gql4j 就足够了。我在一个小数据集上对其进行了测试以确保它有效，但我没有在其他项目中使用它。

[http://code.google.com/p/gql4j/](http://code.google.com/p/gql4j/)

# facebook - 寻找一种在 wordpress 上使用自动调度插件的方法，使用 facebook 自动发布到页面

> ID：11816699
> 
> 赞同：2
> 
> 时间：2012-08-05T13:08:52.760
> 
> 标签：facebook, wordpress

我有一个托管的 wordpress 网站，我目前已使用 Facebook for wordpress 插件设置该网站以发布到我的 Facebook 页面（不是个人资料）。这对我来说很重要，因为我发了很多帖子，它为我节省了大量时间。

另一件可以为我节省大量时间的事情是一个不错的 wordpress 自动计划插件。我尝试了我喜欢的自动计划帖子，但是要将帖子添加到队列中，我必须“发布”它。然后它接收帖子并将其排队，直到满足设置的参数。

唯一的问题是，当我发布页面以进入队列时，它会将其发送到我的 Facebook 页面。有什么解决方法吗？另一个用于安排任何人都知道的插件可以避免这种情况？如果有可用的编码解决方案，我对编码相当了解，但我对 Facebook 应用程序的工作原理知之甚少。因此，如果我可以对 Auto Schedule Posts 插件进行任何类型的编辑，那会很酷。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-27T09:55:38.173

我刚刚发布了这个插件，有一个非常简单的自动排队帖子的方法：[http ://wordpress.org/plugins/queue-posts](http://wordpress.org/plugins/queue-posts)

希望对你们中的一些人有所帮助！:)

# javascript - 有没有办法在 JavaScript 中访问阴影变量？

> ID：11816700
> 
> 赞同：0
> 
> 时间：2012-08-05T13:09:04.397
> 
> 标签：javascript

```
 var a=1;   //first one
 function x() {
    var a=2;  // second
    function y() {
       var a=3;  // third one
    }
 } 
```

有什么方法`function y()`可以访问**第二个** `var a`吗？我知道它可以通过`window.a`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:17:25.157

写的？不。

如果您对每一个都没有死心`a`，那么您可以轻松引用它。另一种解决方案是在另一个变量中捕获外部变量，诀窍是在外部范围内不从内部范围引用相同的变量名。

```
window.a = 1;
function x() {
    var a = 2,
        inner_a = a,

        y = function () {
            var old_a = inner_a,
            // a is equal to the closest var assignment ie: inside x()
                a = 3;
        };
 } 
```

或通过闭包（立即调用函数）将其传递给新函数的构造

```
window.a = 1;
function x() {
    var a = 2;
    var y = (function (old_a) {
        return function () { var a = 3; }; 
        // this inner function has access to "old_a", through closure
    }(a));
} 
```

当将 JS 与浏览器功能混合使用时（即：DOM 和 DOM 事件、分配计时器或回调的循环、AJAX 响应等），这是一种在多个用例中首选的模式。

# ruby-on-rails-3 - rails g mongoid 配置错误

> ID：11816701
> 
> 赞同：1
> 
> 时间：2012-08-05T13:09:08.140
> 
> 标签：ruby-on-rails-3, rubygems, gem, mongoid

> ```
> Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.
>     Master:blog shaunstanislaus$ bundle update
>     Fetching gem metadata from https://rubygems.org/.........
>     Fetching gem metadata from https://rubygems.org/..
>     Enter your password to install the bundled RubyGems to your system: 
>     Using rake (0.9.2.2) 
>     Enter your password to install the bundled RubyGems to your system: 
>     Using i18n (0.6.0) 
>     Using multi_json (1.3.6) 
>     Using activesupport (3.2.6) 
>     Using builder (3.0.0) 
>     Using activemodel (3.2.6) 
>     Using erubis (2.7.0) 
>     Using journey (1.0.4) 
>     Using rack (1.4.1) 
>     Using rack-cache (1.2) 
>     Using rack-test (0.6.1) 
>     Using hike (1.2.1) 
>     Using tilt (1.3.3) 
>     Using sprockets (2.1.3) 
>     Using actionpack (3.2.6) 
>     Using mime-types (1.19) 
>     Using polyglot (0.3.3) 
>     Using treetop (1.4.10) 
>     Using mail (2.4.4) 
>     Using actionmailer (3.2.6) 
>     Using arel (3.0.2) 
>     Using tzinfo (0.3.33) 
>     Using activerecord (3.2.6) 
>     Using activeresource (3.2.6) 
>     Using bson (1.6.4) 
>     Using bson_ext (1.6.4) 
>     Using bundler (1.1.5) 
>     Using coffee-script-source (1.3.3) 
>     Using execjs (1.4.0) 
>     Using coffee-script (2.2.0) 
>     Using rack-ssl (1.3.2) 
>     Using json (1.7.4) 
>     Using rdoc (3.12) 
>     Using thor (0.15.4) 
>     Using railties (3.2.6) 
>     Using coffee-rails (3.2.2) 
>     Using jquery-rails (2.0.2) 
>     Using mongo (1.0.9) 
>     Using will_paginate (3.0.3) 
>     Using mongoid (2.0.0.beta.19) 
>     Using rails (3.2.6) 
>     Using sass (3.1.20) 
>     Using sass-rails (3.2.5) 
>     Using sqlite3 (1.3.6) 
>     Using uglifier (1.2.7) 
>     Your bundle is updated! Use `bundle show [gemname]` to see where a bundled gem is                         installed.
>     Master:blog shaunstanislaus$ rails g mongoid:config
>     /Library/Ruby/Gems/1.8/gems/railties-3.2.6/lib/rails/railtie/configuration.rb:85:in 
> ```
> 
> `method_missing': undefined method`#
> (NoMethodError) 的生成器来自 /Library/Ruby/Gems/1.8/gems/mongoid-2.0.0.beta.19/lib/mongoid/railtie.rb:13 来自 /Library/Ruby/Gems/1.8/gems/ mongoid-2.0.0.beta.19/lib/mongoid.rb:89:in `require' from /Library/Ruby/Gems/1.8/gems/mongoid-2.0.0.beta.19/lib/mongoid.rb:89 from /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:68:in` 需要'来自 /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:68:in `require' from /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:66:in` 来自 /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:66:in `require' from /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:55:in` each' 来自 /Library/Ruby/Gems/1.8/gems/bundler-1.1.5 /lib/bundler/runtime.rb:55:in `require' from /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler.rb:119:in` require' 来自 /Users/shaunstanislaus/Desktop/code/blog/config/application.rb:7 来自 /Library/Ruby/Gems/1.8/gems/railties-3.2.6 /lib/rails/commands.rb:24:in `require' from /Library/Ruby/Gems/1.8/gems/railties-3.2.6/lib/rails/commands.rb:24 from script/rails:6:in`需要'来自脚本/rails:6

**我该如何解决？**

我输入了这个命令，上面出现了错误。

> Master:blog shaunstanislaus$ rails g mongoid:config

我已经尝试删除 gemfile.loc bundle install rails g mongoid:config，再次出现此错误。还是一样。

```
Master:blog shaunstanislaus$ rails g mongoid:config 
```

/Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:68:in `require': /Library/Ruby/Gems/1.8/gems/mongoid-3.0.3/lib/mongoid.rb:148: odd number list for Hash (SyntaxError) { to: Config })) ^ /Library/Ruby/Gems/1.8/gems/mongoid-3.0.3/lib/mongoid.rb:148: syntax error, unexpected ':', expecting '}' { to: Config })) ^ from /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:68:in`require'来自/Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/ bundler/runtime.rb:66:in `each' from /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:66:in`require' 来自 /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:55:in `each' from /Library/Ruby/Gems/1.8/gems/bundler-1.1.5/lib/bundler/runtime.rb:55:in`require' 来自 /Library/Ruby/Gems/ 1.8/gems/bundler-1.1.5/lib/bundler.rb:119:in`require' from /Users/shaunstanislaus/Desktop/code/blog/config/application.rb:7 from /Library/Ruby/Gems/1.8/gems/railties-3.2.6/lib/rails/commands.rb:24:in`来自 /Library/Ruby/Gems/1.8/gems/railties-3.2.6/lib/rails/commands.rb:24 来自脚本/rails:6:in 'require' 来自脚本/rails:6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T22:05:07.027

我通过打字解决了这个问题`bundle exec rails g mongoid:config`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T08:44:30.257

我有这个设置

红宝石-v

ruby 1.9.3p194（2012-04-20 修订版 35410）[x86_64-darwin12.0.0]

捆绑-v

捆绑器版本 1.1.5

捆绑安装成功；rake 服务器仍然给出错误

/Users/avaranovich/.gem/gems/bundler-1.1.5/lib/bundler/runtime.rb:68:in `require': /Users/avaranovich/.gem/gems/mongoid-3.0.4/lib/mongoid .rb:148: 哈希奇数列表 (SyntaxError) { to: Config }))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T03:35:44.063

删除您的 GemFile.lock，运行捆绑安装。如果您在最新版本的 Rails (3.2?) 和 Ruby (1.9.3-p###) 上运行，它应该可以工作。

未显示 Mongoid 的“生成器”命令的原因很可能是 gem 没有为您拥有的 rails 和 ruby​​ 版本正确安装。

看看这个：[Rails g 对 mongoid 命令失败](https://stackoverflow.com/questions/10477182/)...... – Dominic Tancredi 2

# javascript - 使用 JavaScript 自定义规则进行静态分析？

> ID：11816713
> 
> 赞同：4
> 
> 时间：2012-08-05T13:11:59.790
> 
> 标签：javascript, code-analysis, jslint, jshint

JSLint、JSHint 或其他一些开源静态代码分析工具是否支持为代码合规性添加自定义规则，或者是否有一些符合 ECMAScript 的解析器，我可以使用这些解析器来获得尽可能接近下面代码片段中的结果?

例如，我想查看 JavaScript 代码并列出调用了哪些函数，如果它调用一个库（或智能手机为 HTML5 小部件提供的 API）来注册该 API 命名空间下的所有内容，以制作一棵树对象及其属性，以查看是否从可以追溯的对象中调用函数，可能使用 XML、JSON 或其他结构化格式的输出。

比如说我有这个 JavaScript 代码（它什么都不做，只是为了论证）：

```
jobs = mylibrary.getJobs();
found = jobs.find("Python");
list = found.convert("html"); 
```

我希望我的分析工具得到这个：

```
{
    "mylibrary": {
        "jobs": {"maker":"getJobs", "parent": "mylibrary"},
        "found": {"maker": "find", "parent": "jobs", "parameters": "Python"},
        "list": {"maker": "convert", "parent": "found"}
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T13:29:04.447

你应该能够使用 substack 的 burrito 构建类似的东西[，](https://github.com/substack/node-burrito)它使用来自[Uglify-JS](https://github.com/mishoo/UglifyJS)的解析器，我认为，你需要的一切。快速示例：

src.js：

```
var jobs, found, list;
jobs = mylibrary.getJobs();
found = jobs.find("Python");
list = found.convert("html"); 
```

ast.js：

```
var fs = require('fs'),
    burrito = require('burrito');

var src = fs.readFileSync('./src.js', 'utf8');

burrito(src, function (node) {
    console.log(node.name, node.value);
}); 
```

您将如何构建您请求的结构，我不太确定（我自己对 AST 解析不是很精通），但我相信这需要您付出一些努力。也许你不需要中间的结构，可以这么说，但可以只验证墨西哥卷饼中的每个节点，每个`call`节点都将根据它的值（函数名、对象名等）进行验证，如果没有，则会发出警告'不验证。

这是`burrito`上面调用的输出（注意：每个`[Object]`或这样都已被 node.js' 截断`console.log`。值实际上是 burrito 解析树中的节点，因此每个值都有它的关联状态等）。

```
var [ [ [ 'jobs' ], [ 'found' ], [ 'list' ] ] ]
stat [ [ { name: 'assign', start: [Object], end: [Object] },
    true,
    [ [Object], 'jobs' ],
    [ [Object], [Object], [] ] ] ]
assign [ true,
  [ { name: 'name', start: [Object], end: [Object] }, 'jobs' ],
  [ { name: 'call', start: [Object], end: [Object] },
    [ 'dot', [Object], 'getJobs' ],
    [] ] ]
name [ 'jobs' ]
call [ [ 'dot', [ 'name', 'mylibrary' ], 'getJobs' ], [] ]
stat [ [ { name: 'assign', start: [Object], end: [Object] },
    true,
    [ [Object], 'found' ],
    [ [Object], [Object], [Object] ] ] ]
assign [ true,
  [ { name: 'name', start: [Object], end: [Object] }, 'found' ],
  [ { name: 'call', start: [Object], end: [Object] },
    [ 'dot', [Object], 'find' ],
    [ [Object] ] ] ]
name [ 'found' ]
call [ [ 'dot', [ 'name', 'jobs' ], 'find' ],
  [ [ [Object], 'Python' ] ] ]
string [ 'Python' ]
stat [ [ { name: 'assign', start: [Object], end: [Object] },
    true,
    [ [Object], 'list' ],
    [ [Object], [Object], [Object] ] ] ]
assign [ true,
  [ { name: 'name', start: [Object], end: [Object] }, 'list' ],
  [ { name: 'call', start: [Object], end: [Object] },
    [ 'dot', [Object], 'convert' ],
    [ [Object] ] ] ]
name [ 'list' ]
call [ [ 'dot', [ 'name', 'found' ], 'convert' ],
  [ [ [Object], 'html' ] ] ]
string [ 'html' ] 
```

**更新：**

另一种选择是更新的(?) ES 解析器[Esprima](http://esprima.org/)，它似乎更积极地开发和更好地记录。据报道，它也比 Uglify 更快。[您可以在Parsing Demo 页面](http://esprima.org/demo/parse.html)上尝试例如解析。我认为，您应该能够使用它构建一个好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T12:43:55.793

我尝试了一个可以从代码访问的javascript解释器（在我的例子中是python）。所以口译员喜欢`pynoceros`，`pynarcissus`或者`pyv8`可能会帮助我。

这里有一个关于如何安装 py8 的答案：[https ://stackoverflow.com/a/11879224/1577343](https://stackoverflow.com/a/11879224/1577343)

由于使用上述方法并没有取得多大成功，我更喜欢使用符合 ECMAScript 的解析器的静态分析解决方案。

到目前为止，我可以通过静态分析使用 JSLINT 解析器（[在 .js 文件上运行 JSLint，从 chrome 或 firefox 的调试控制台](https://stackoverflow.com/questions/11884224/run-jslint-on-a-js-file-from-debugging-console-in-chrome-or-firefox)）：但我不知道如何进一步使用它。

```
{
    "string": "(begin)",
    "first": [
        {
            "string": "var",
            "arity": "statement",
            "first": [
                {
                    "string": "jobs"
                },
                {
                    "string": "found"
                },
                {
                    "string": "list"
                }
            ]
        },
        {
            "string": "=",
            "arity": "infix",
            "first": {
                "string": "jobs"
            },
            "second": {
                "string": "(",
                "arity": "infix",
                "first": {
                    "string": ".",
                    "arity": "infix",
                    "first": {
                        "string": "mylibrary"
                    },
                    "second": {
                        "string": "getJobs"
                    }
                },
                "second": []
            }
        },
        {
            "string": "=",
            "arity": "infix",
            "first": {
                "string": "found"
            },
            "second": {
                "string": "(",
                "arity": "infix",
                "first": {
                    "string": ".",
                    "arity": "infix",
                    "first": {
                        "string": "jobs"
                    },
                    "second": {
                        "string": "find"
                    }
                },
                "second": [
                    {
                        "string": "Python",
                        "arity": "string"
                    }
                ]
            }
        },
        {
            "string": "=",
            "arity": "infix",
            "first": {
                "string": "list"
            },
            "second": {
                "string": "(",
                "arity": "infix",
                "first": {
                    "string": ".",
                    "arity": "infix",
                    "first": {
                        "string": "found"
                    },
                    "second": {
                        "string": "convert"
                    }
                },
                "second": [
                    {
                        "string": "html",
                        "arity": "string"
                    }
                ]
            }
        }
    ]
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-14T16:06:08.197

PMD 支持带有自定义规则的 ECMAScript 静态分析：

> 以当前规则集之一为例。将其复制并粘贴到新文件中，从中删除所有旧规则，然后更改名称和描述。
> 
> 请注意，您可以自定义单个引用的规则。在您的自定义规则集中，除了规则的类之外的所有内容都可以被覆盖。
> 
> 您还可以使用排除模式将某些文件排除在规则集的处理范围之外，并使用可选的覆盖包含模式。当存在匹配的排除模式但没有匹配的包含模式时，文件将被排除在处理之外。
> 
> 源文件路径中的路径分隔符被规范化为“/”字符，因此可以在多个平台上透明地使用相同的规则集。
> 
> 此外，无论如何使用 PMD（例如命令行、IDE、Ant），这种排除/包含技术都可以工作，从而更容易在整个环境中保持 PMD 规则的应用一致。
> 
> 您可以在内置 PMD 规则集旁边指定自定义规则集名称的完整路径
> 
> 要在 IDE 中查看它，请将其添加到 rulesets/rulesets.properties

**参考**

*   [pmd/pmd-javascript/src/main/resources/rulesets/ecmascript at master · pmd/pmd](https://github.com/pmd/pmd/tree/master/pmd-javascript/src/main/resources/rulesets/ecmascript)

*   [使用 PMD Maven 分析 Javascript](https://stackoverflow.com/questions/42060771/analyzing-javascript-with-pmd-maven)

*   [PMD – PMD 属性](https://pmd.github.io/pmd-5.1.3/pmd-developer.html)

*   [PMD – 如何制定规则集](https://pmd.github.io/pmd-5.1.3/howtomakearuleset.html)

*   [结合两个 PMD 检查](https://stackoverflow.com/questions/31523973/combine-two-pmd-checks)

*   [在 PMD 规则中使用正则表达式](https://thomasleecopeland.com/2005/12/29/using-regular-expressions-in-pmd-rules.html)

*   [PMD – IDE 集成](https://pmd.github.io/pmd-5.4.1/usage/integrations.html)

# elisp - 如何识别段落并将其存储在数组中

> ID：11816716
> 
> 赞同：2
> 
> 时间：2012-08-05T13:12:11.767
> 
> 标签：elisp

我在缓冲区中有两个段落，其中只有简单的文本：

第 1 段

第 2 段

我需要从每个段落的第一个字符的第一个字符开始读取，直到它是最后一个单词并存储在一个数组中。每个段落都应该这样做。如果没有额外的标记标签，我如何识别段落？如果这是不可能的，如果我要求用户在每个段落之后按两次回车，我如何通过识别这些来再次拆分我的文本？我尝试了正则表达式，但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T15:12:59.490

如果 elisp 的其他一些新手有问题：我找到了一种使用 while 拆分文本的方法，如下所示：

```
 (while (re-search-forward "[ \n][ \n]$" nil t)
 ..... ..... .......
 ) 
```

但仍然不确定如何在循环时将其放入 Array 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T16:41:21.790

这是一种方法：

```
(let ((input-text "this is a sample paragraph.
this is another paragraph"))
  (apply #'vector (split-string input-text "\n"))) 
```

split-string 是一种基于正则表达式分割文本以进行分割的简单方法。

要将结果列表转换为数组，我使用函数“vector”，它使数组成为传递给它的参数。为了将列表的内容而不是列表本身传递给该函数，我使用“应用”。

# c# - 如何将两个文件合二为一以备后用

> ID：11816717
> 
> 赞同：0
> 
> 时间：2012-08-05T13:12:36.703
> 
> 标签：c#, encryption, xna, compression

我正在编写节奏游戏，我真正要记住的一件事是艺术家许可证和版权的完整性。我感谢艺术家授予我在我的游戏中使用的版权许可，但我不希望人们将我的游戏用作免费获取音乐的一种方式。

部分想法是用 1-2 首歌曲分发游戏，他们可以从我的网站下载任意数量的歌曲（以保持安装程序的大小，以便有带宽限制的人可以下载游戏而不必担心大小限制） .

我想要做的是有一个文件，例如一个.dbf，当双击它时，它会以.dbf的形式移动到我的游戏目录（例如C：/Program Files/Dashie's Sky Games/Rhythms/），每个.dbf都会基本上包含两个文件（.mp3 和 .drf），.drf 将包含诸如注释的位置、难度级别、UberDash 的位置等内容，这将是未加密的，但只能通过游戏进行编辑编辑器（还没有）。

我不希望人们能够将 .dbf 重命名为 .zip 并能够访问 .mp3

我有点想要它，这样游戏就可以打开 .dbf、解密它或其他任何东西并将 .mp3 和 .drf 存储到内存中（或一些非常模糊的临时目录中）。我正在为音乐库使用 bass.dll。有什么想法吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:21:12.653

一天结束时，如果歌曲以 MP3 或其他流行格式存储，那么无论您如何打包它，理论上都可以得到它。

在我看来，您最好的选择是压缩它们并更改扩展名（可能不是 zip zip，而是 7zip 或 rar 或不是那么“默认”的压缩机制），然后让您的程序解压缩歌曲。我认为您必须接受，如果您的程序可以解包文件，那么人类也可以这样做，但是假设如果有人想要一首歌曲，尝试解密您的歌曲存储机制将不是他们的首选方式所以（说实话，bittorrent 会是这样）。您还可以添加“获取这首歌！” 应用程序中的按钮，它将把用户带到 iTunes 或你有什么，允许用户合法地获取歌曲。如果华纳、EMI 和 RIAA 不能阻止人们盗版音乐，那么你肯定做不到。试着让用户更容易合法地获取歌曲。

# c# - 使用 gdi+ 绘制和删除一条线

> ID：11816728
> 
> 赞同：0
> 
> 时间：2012-08-05T13:13:24.517
> 
> 标签：c#, winforms, c#-4.0, gdi+

我拥有使用 GDI+ 的复杂绘图代码，它在用户控件上绘制类似于图表的东西。如果用户在按下控件的情况下单击，则应显示虚线样式的垂直标记线。

现在我寻找一种方法来扩展绘图代码，而无需触及复杂的绘图代码。

我创建了一个标记类，它附加到用户控件的鼠标向上事件。在事件处理`(ModifierKeys == Keys.Control)`程序中进行检查。

如果用户按住控制键并用鼠标左键单击，则以用户控件的`Graphics`对象作为参数调用标记类的绘制方法。

当前的行为是每次单击都会绘制一条新线，但应删除该线并绘制一条新线。

我怎样才能擦除绘制的线？

我是否必须重绘用户控件的完整内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T13:26:05.457

您无法删除绘制的线，因为无法恢复底层图形。

你可以做的是：

*   重绘整个图形（没有线）

或者

*   在顶部堆叠第二个透明用户控件并使用它来显示该行。需要时将其移除和绘制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T13:26:54.240

这里的答案显然是肯定的。使用 GDI+，您只需直接在位图缓冲区上绘图，因此如果您想撤消先前的绘图操作，您可以执行以下操作之一（取决于问题的复杂性和性能）：

*   恢复位图缓冲区上已更改的字节
*   重新加载绘图位图的先前状态

一个简单的解决方案是拥有 2 个位图（类似的东西通常称为双缓冲）。一个当前显示（并包含最终状态），一个仅用于预览。预览版始终是第一个的副本 - 只是带有当前修改。

所以这个简单实现的基本算法：

*   从两个位图开始（空白但大小相同）[命名为 A 和 B]
*   如果用户画一条线，总是在 B 中复制位图 A 并在 B 上绘制 - 显示 B
*   如果用户完成该行，则在 A 中复制 B 并再次 - 显示 B

所以总是显示预览位图，它只是原始位图的修改。

这是 C# 中的示例编程代码（假设所有事件都已连接，并且预览位图 B 是图片框本身（此处仅命名为 pictureBox1）：

```
Bitmap bmp;
bool isDrawing;
Point previous;

void pictureBox1_MouseDown(object sender, MouseEventArgs e)
{
    isDrawing = true;
    previous = e.Location;
}

void pictureBox1_MouseUp(object sender, MouseEventArgs e)
{
    isDrawing = false;
}

void pictureBox1_MouseMove(object sender, MouseEventArgs e)
{
    if (isDrawing)
    {
        using (Graphics g = Graphics.FromImage(bmp))
        {
            double wf = (double)bmp.Width / (double)pictureBox1.Width;
            double hf = (double)bmp.Height / (double)pictureBox1.Height;
            g.ScaleTransform((float)wf, (float)hf);
            g.DrawLine(Pens.Black, e.Location, previous);
        }

        pictureBox1.Refresh();
        previous = e.Location;
    }
} 
```

这段代码将做所有事情来显示从一个点到另一个点的直线，只需按下鼠标左键。

# asp.net - 如何将巨大的 ASP 经典站点与 .Net 结合起来

> ID：11816731
> 
> 赞同：2
> 
> 时间：2012-08-05T13:13:38.000
> 
> 标签：asp.net, .net, asp.net-mvc, oracle, asp-classic

我正在为一个公共图书馆（25k 用户）运行一个大型的 classic-asp 网站（自行开发），它实际上性能非常好（oracle 11g r2 数据库），但有时需要添加新服务或调整旧服务.

这就是我的困境。每次我在这个网站上工作时，我都觉得我不应该再更新这个过时的怪物，我应该把它移植到最新的技术上。但是如何开始呢？我在开发asp.net（vb.net）网站方面有很好的知识，我正在寻找一种在.net（Webforms，MVC，WebApi，...？）中重写代码并将其部分集成到经典中的方法asp站点，（我不能一次重写整个东西，因为我没有足够的时间！）所以从现在开始，网站将被完全重写。

我需要考虑的另一件事是 Oracle DB 和已经存在和优化的（通常是 oracle 特定的）SQL 语句，我肯定想在新构建的中使用它们（因此实体框架和 linq 似乎不是一个选项）。

我正在考虑使用新的 WebApi 并通过 jQuery 从经典的 asp 站点调用操作，但找不到与 ODP 交互的简单方法（返回和接受 Json）。

我真的希望有人能指出我正确的方向！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:52:28.080

如果可能的话，您需要将现有网站分解为可以单独分离和重写的模块。

因为您在过时的技术（经典 ASP）和前沿技术（WebAPI 等）之间进行了如此大规模的返工，所以可能无法将两者作为单个应用程序运行。相反，您将不得不并排运行两个单独的应用程序，这将作为用户的单个应用程序运行。您将逐步将分离的模块从旧应用程序移动到新应用程序。

如果您想继续使用 Oracle，仍然可以使用 Linq 和 Entity Framework，因为它们用于查询数据而不是实际存储数据。您可以使用 Oracle、MSSQL 甚至是较新的文档数据库之一，例如 Mongo 或 Raven DB。

# nhibernate - 在不触发延迟加载或急切加载的情况下将 NHibernate POCO 复制到 DTO

> ID：11816732
> 
> 赞同：3
> 
> 时间：2012-08-05T13:13:41.273
> 
> 标签：nhibernate, automapper, poco, dto, valueinjecter

我需要从**NHibernate POCO**对象创建**DTO 。**问题是 POCO 对象包含动态**代理**，不应将其复制到 DTO。**我渴望加载我需要提前传输的所有集合和引用，我不希望 NHibernate 开始加载我没有提前加载的引用集合。**

 ******关于 SO 的几个类似问题收到的答案是：

1.  建议 Session.GetSessionImplementation().PersistenceContext.Unproxy();
2.  建议关闭延迟加载。

在我的情况下，第一个建议是无关紧要的，因为根据我的理解，它会导致急切加载以替换代理。实际上，它甚至不起作用 - 它不会删除我的对象中的代理。（任何解释为什么？）

第二个建议，关闭延迟加载似乎会导致所有引用和集合急切加载，基本上是加载整个数据库。我的期望是，如果延迟加载关闭，并且我没有请求集合，它将不会被加载。（我对 NHibernate 没有提供这样的选项是正确的吗？）

我正在使用具有流畅配置的 NHibernate 3.3.1。

重申我的主要问题，我需要创建清除代理的 DTO，从包含代理的 POCO 复制，并且我不想加载这些代理后面的数据。

任何包含示例代码并使用 ValueInjecter / AutoMapper 自动化流程的有用建议都将非常有帮助。

**编辑＃1：**

遵循 Roger Alsing 的使用投影的建议，我意识到我真正在寻找的是一个类似于 ValueInjecter 的基于约定的映射。这就是为什么。最初，我的 DTO 将与模型的 POCO 定义相同。这是由于庞大的代码库依赖于在客户端项目上传输的现有 POCO。

使用投影，我必须指定必须复制哪个字段子集，并且该子集在每个上下文中可能不同（因为理想情况下，DTO 会有所不同）。当应该有第二个选项时，这将意味着将大量新代码引入服务器端。

使用 ValueInjecter，我将能够在一次调用中按照惯例填充 DTO，而无需编写特定的预测，也不必在未来维护这些预测。也就是说，如果我能够让 ValueInjecter 忽略代理对象。

鉴于在我的情况下使用投影是一个很好但不是理想的解决方案，**有没有办法配置像 ValueInjecter 这样的东西来复制 POCO 而无需复制代理或在复制时触发急切/延迟加载？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T15:07:44.333

我通过使用 Linq 或 O/R Mapper 可能具有的任何查询语言选择 DTO 作为投影来解决这个问题。

例如

```
return from c in customers 
       select new CustomerDTO 
       {
          Name = c.Name , 
          Orders = c.Orders.Select (o => new OrderDTO {...} ) 
       }; 
```

这样，您就不需要求助于反射魔法或任何其他花哨的东西。并且查询一次就可以准确地获取您需要的内容，因此，这通常比获取实体然后将它们转换为 mem 中的 DTO 更有效。（在某些情况下，如果生成的 SQL 查询由于某种原因包含额外的连接，它的效率可能会降低..）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-28T16:45:39.863

我将以下 ValueResolver 与 AutoMapper 一起使用：

```
/// <summary>
/// ValueResolver that will set NHibernate proxy objects to null, instead of triggering a lazy load of the object
/// </summary>
public class IgnoreNHibernateProxyValueResolver : IValueResolver
{
    public ResolutionResult Resolve(ResolutionResult source)
    {
        var prop = source.Type.GetProperty(source.Context.MemberName).GetValue(source.Value, null);
        var proxy = prop as INHibernateProxy;
        if (proxy != null && proxy.HibernateLazyInitializer.IsUninitialized)
        {
            return source.Ignore();
        }

        return source.New(prop);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T13:45:02.247

[查看NH 3.0 中 QueryOver 简介中](http://nhforge.org/blogs/nhibernate/archive/2009/12/17/queryover-in-nh-3-0.aspx)的投影

```
CatSummary summaryDto = null;
IList<CatSummary> catReport =
    session.QueryOver<Cat>()
        .SelectList(list => list
            .SelectGroup(c => c.Name).WithAlias(() => summaryDto.Name)
            .SelectAvg(c => c.Age).WithAlias(() => summaryDto.AverageAge))
        .TransformUsing(Transformers.AliasToBean<CatSummary>())
        .List<CatSummary>(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T15:19:21.363

对于 ValueInjecter 解决方案，我建议使用[SmartConventionInjection](http://valueinjecter.codeplex.com/wikipage?title=SmartConventionInjection&referringTitle=Home)（您需要将链接页面中的代码复制到您的解决方案中）

并在指定一个不会触及代理属性的约定之后

这是一个开始：

```
public class MapPoco: SmartConventionInjection
{
     protected override bool Match(SmartConventionInfo c)
     {
         return c.SourceProp.Name == c.TargetProp.Name;
     }
} 
```******

# c# - 抽象类和不可为空的值类型

> ID：11816734
> 
> 赞同：1
> 
> 时间：2012-08-05T13:13:47.390
> 
> 标签：c#, multithreading, class, producer-consumer, non-nullable

我正在尝试 为类生产者/消费者编译大师'Joe Duffy'提出的代码（[更多迭代器乐趣与生产者/消费者模式），但发生此错误：](http://www.bluebytesoftware.com/blog/2004/06/10/MoreIteratorFunWithTheProducerconsumerPattern.aspx)

（我使用的是visual studio 2010和net 4.0.3）

```
Program.cs(37,34)：错误 CS0453：类型“T”必须是不可为空的值类型才能在泛型类型或方法“System.Nullable”中用作参数“T”
Program.cs(11,40)：（相关位置）
Program.cs(37,61)：错误 CS0453：类型“T”必须是不可为空的值类型才能在泛型类型或方法“System.Nullable”中用作参数“T”
Program.cs(11,40)：（相关位置）
Program.cs(44,53)：错误 CS0453：类型“T”必须是不可为空的值类型才能在泛型类型或方法“System.Nullable”中用作参数“T”
Program.cs(11,40)：（相关位置）

```

对我微薄的知识来说太多了！有人可以提出解决方案吗？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace ProducerConsumerClass
{
    class Program
    {
        public abstract class Producer<T>
        {
            public Producer()
            {
                worker = new Thread(new ThreadStart(this.ProductionCycle));
            }
            private Queue<T> buffer = new Queue<T>();
            public Thread worker;
            private bool done;
            public bool Done
            {
                get
                {
                    return done;
                }
            }

            public IEnumerable<T> ConsumerChannel
            {
                get
                {
                    if (done)
                        throw new InvalidOperationException("Production is not currently active");

                    while (!done)
                    {
                        Nullable<T> consumed = new Nullable<T>();

                        //BUG: compiler crashes when using lock(...) construct within iterator
                        Monitor.Enter(buffer);
                        if (buffer.Count == 0)
                            Monitor.Wait(buffer);
                        if (buffer.Count > 0)
                            consumed = new Nullable<T>(buffer.Dequeue());
                        Monitor.Exit(buffer);

                        if (consumed.HasValue)
                            yield return consumed.Value;
                    }

                    yield break;
                }
            }

            public void BeginProduction()
            {
                done = false;
                worker.Start();
            }

            public void EndProduction()
            {
                done = true;
                lock (buffer)
                {
                    Monitor.PulseAll(buffer);
                }
            }

            private void ProductionCycle()
            {
                while (!done)
                {
                    T t = ProduceNext();
                    lock (buffer)
                    {
                        buffer.Enqueue(t);
                        Monitor.Pulse(buffer);
                    }
                }
            }

            protected abstract T ProduceNext();

        }

        public abstract class Consumer<T>
        {
            public Consumer(Producer<T> producer)
            {
                this.producer = producer;
                worker = new Thread(new ThreadStart(this.ConsumerCycle));
            }

            private Producer<T> producer;

            public Thread worker;

            private bool done = false;

            public bool Done
            {
                get
                {
                    return done;
                }
            }

            public void BeginConsumption()
            {
                done = false;
                worker.Start();
            }

            public void EndConsumption()
            {
                done = true;
            }

            private void ConsumerCycle()
            {
                foreach (T t in producer.ConsumerChannel)
                {
                    Consume(t);
                    if (done)
                        break;
                }
            }

            protected abstract void Consume(T t);
        }

        class RandomNumberProducer : Producer<int>
        {
            public RandomNumberProducer()
                : base()
            {
                rand = new Random();
            }

            private Random rand;

            protected override int ProduceNext()
            {
                return rand.Next();
            }
        }

        class RandomNumberConsumer : Consumer<int>
        {
            public RandomNumberConsumer(RandomNumberProducer p)
                : base(p)
            {
            }

            private static int counter = 0;

            private int id = ++counter;

            protected override void Consume(int t)
            {
                Console.Out.WriteLine("#{0}: consumed {1}", id, t);
            }
        }

        static void Main(string[] args)
        {
            RandomNumberProducer p = new RandomNumberProducer();

            RandomNumberConsumer c1 = new RandomNumberConsumer(p);
            RandomNumberConsumer c2 = new RandomNumberConsumer(p);
            RandomNumberConsumer c3 = new RandomNumberConsumer(p);

            p.BeginProduction();

            c1.BeginConsumption();
            c2.BeginConsumption();
            c3.BeginConsumption();

            Thread.Sleep(2500);

            c3.EndConsumption();
            c2.EndConsumption();
            c1.EndConsumption();

            p.EndProduction();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T13:20:29.840

你需要约束`T`：

```
public abstract class Producer<T> where T : struct
public abstract class Consumer<T> where T : struct 
```

# python - 测试子类行为？

> ID：11816741
> 
> 赞同：0
> 
> 时间：2012-08-05T13:14:58.020
> 
> 标签：python, unit-testing, testing

我创建了 4 个类（Python）的合作。

```
class A:
    ## A, B, C are nested classes of A
    class B:
        ...
    class C:
        ...
    class D:
        ...
    ## example methods
    def newB(self):
        return self.B()
    def newC(self):
        return self.C(self.newB()) 
```

我在 4 个测试用例中编写了 60 个测试方法，这是一项艰苦的工作。

因为 B、C、D 不提供太多行为，所以应将 A、B、C、D 类子类化以添加新行为。

问题：

我写了很多测试代码来保证A、B、C、D配合正确。如果我将 A、B、C、D 子类化为 A2、B2、C2、D2，我将需要以与测试 A、B、C、D 相同的方式测试 A2、B2、C2、D2 的行为。

我该怎么做呢？

1.  每次创建数据库的新子类时都将所有单元测试子类化？
2.  通过方法生成测试用例和套件？
3.  ...

您将如何确保子类数据库正常工作并且没有错误？

给定：单元测试，数据库的类和您的子类

现在存在的测试：

```
class TestA(unittest.TestCase):
    A = A
    def setUp(self):
        self.a = self.A()
    def test_something(self):
        ...

class MockB(A.B):
    ...
class AWithMock(A):
    B = MockB
class TestAWithMock(TestA):
    A = AWithMock
    def setUp(self):
        self.a = self.A()
    def test_something_new(self):
        ...

class MockB2(A.B):
    ...
class MockC2(A.C):
    ...
class MockD2(A.D):
    ...
class TestWithMock(unittest.TestCase):
    def test_b(self):
        b = MockB2()
        ...
    def test_c(self):
        ...
    def test_d(self):
        ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:55:08.680

```
import unittest
class TestCaseA(unittest.TestCase):
    def setUp(self):
        self.thing = A()

    def test_does_x():
        self.assertTrue(self.thing.does_x()) 
```

现在定义一个子类 A2：

```
class A2(A):
    ... 
```

我会将您的测试用例子类化，但仅覆盖`setUp`/`setup`方法，因为子类的其余 API`A2`应与`A`.

所以你的测试子类只是：

```
class TestA2(TestCaseA):
    def setUp(self):
        self.thing = A2() 
```

# java - Android XML 文件阻止 Activity 打开

> ID：11816743
> 
> 赞同：0
> 
> 时间：2012-08-05T13:15:05.547
> 
> 标签：java, android, xml, eclipse

我正在学习 android，所以我编写了以下代码来学习 ScrollView 并在一个线性布局中创建多个线性布局。我创建了一个菜单来启动不同的活动，但问题是当我单击与此 xml 文件关联的类时，新类（活动）不会显示在屏幕上。可能是什么问题，我该如何解决？这是代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:weightSum="100"
android:padding="25dp" >

<ScrollView 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="30"
>

<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
>
<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Name" />

<EditText
    android:id="@+id/editText1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" >

    <requestFocus />
</EditText>

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Age" />

<EditText
    android:id="@+id/editText2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Email Address" />

<EditText
    android:id="@+id/editText3"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Subject" />

<EditText
    android:id="@+id/editText4"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Phone No." />

<EditText
    android:id="@+id/editText5"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView6"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Your Message" />

<EditText
    android:id="@+id/editText6"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />
</LinearLayout>
</ScrollView>

<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:layout_weight="40">
<Button
    android:id="@+id/button1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:paddingTop="20dp"
    android:text="Email" />
</LinearLayout>

<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="30"
    android:orientation="vertical">
<AnalogClock
    android:id="@+id/analogClock1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />
</LinearLayout> 
```

班级邮箱代码：

```
package com.umer.practice2;

 import android.app.Activity;
import android.os.Bundle;
import android.widget.AnalogClock;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class Email extends Activity {

TextView t1,t2,t3,t4,t5,t6;
EditText e1,e2,e3,e4,e5,e6;
Button butn;
AnalogClock clock;
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.email);
    initializeviews();
}

private void initializeviews() {
    // TODO Auto-generated method stub
    t1= (TextView) findViewById(R.id.textView1);
    t2= (TextView) findViewById(R.id.textView2);
    t3= (TextView) findViewById(R.id.textView3);
    t4= (TextView) findViewById(R.id.textView4);
    t5= (TextView) findViewById(R.id.textView5);
    t6= (TextView) findViewById(R.id.textView6);
    e1= (EditText) findViewById(R.id.editText1);
    e2= (EditText) findViewById(R.id.editText2);
    e3= (EditText) findViewById(R.id.editText3);
    e4= (EditText) findViewById(R.id.editText4);
    e5= (EditText) findViewById(R.id.editText5);
    e6= (EditText) findViewById(R.id.editText6);
    butn=(Button) findViewById(R.id.button1);
    clock= (AnalogClock) findViewById(R.id.analogClock1);
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T15:32:12.707

您是否在 AndroidManifest.xml 中添加了活动？每个活动都需要添加到清单文件中。

例如：

```
 <activity android:name=".HelloGoogleMaps" android:label="@string/app_name"/> 
```

# android - 自定义 Listview 索引自动更改

> ID：11816744
> 
> 赞同：0
> 
> 时间：2012-08-05T13:15:33.497
> 
> 标签：android

我有一个列表视图，当用户单击一个项目时，我会显示用户单击该项目的图像。列表视图从通知中填充。

假设在列表视图中添加了一个项目。现在我单击该项目，图像显示在它的前面。现在当我在列表视图中输入新项目时，什么都不会发生（现在列表视图中有 2 个项目）。当我在列表视图中添加第三个项目时，位置 0 的项目的图像隐藏并显示在位置 1。为什么会发生这种情况？

现在在列表视图项中添加图像。我必须首先对下一个打开活动执行一些检查，如果这些检查成功，那么我将在活动中单击的项目前面放置一个图像。

所以要做到这一点，我所做的是我在下一个活动中发送单击的项目位置并执行这些检查，如果这些检查成功，我将`onActivityResult`使用我发送到此活动的位置放置并图像上一个活动的功能.意味着我将该位置值发送回`onActivityResult`放置图像的函数中的前一个活动。

图像的放置工作正常。但是当我收到通知时，我在列表视图中添加了项目，这导致`getView`再次为列表视图中的每个项目调用函数以填充列表视图。这里出现问题，即来自位置 0 项目的图像在列表中转到位置 1 项目。

请询问是否需要更多解释或不清楚的地方。

这是listview Item Click的代码：

```
 TextView tv=(TextView)view.findViewById(R.id.clientip);

                    Intent i=new Intent(getApplicationContext(),ChatPageActivity.class);
                    i.putExtra("AdminEmail",ClientListActivity.AdminEmail);
                    i.putExtra("ClientIp",tv.getText().toString());
                    i.putExtra("ChildAt", position);

                    startActivityForResult(i, 200); 
```

`ChildAt`是我发送的位置。在下一个活动中执行检查后。

```
@Override
protected void onActivityResult(int requestCode,int resultCode,Intent data)
{
    try {
    super.onActivityResult(requestCode, resultCode, data);
    if(resultCode!= 23)
    {   
        Integer integer=data.getExtras().getInt("ChildAt");
        ImageView imageView=(ImageView)lv.getChildAt(integer).findViewById(R.id.onlineImg);
        imageView.setImageResource(R.drawable.online);
    }

}catch(Exception e)
{
    Log.e("ClientList_onActivityResult",e.getMessage());
}

} 
```

如果`onActivityResult`代码不等于 23，则表示下一个活动中的所有检查都是正确的，您可以将图像放置在从下一个活动再次发送回该活动的位置。

这`getView`是我的 BaseAdapter 类的代码：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View view=convertView;

    if(convertView==null)
        view=inflater.inflate(R.layout.activeclientlist,null);

    TextView ip=(TextView)view.findViewById(R.id.clientip);

    String clientip=this.iplist.get(position);

    ip.setText(clientip);

    return view;
} 
```

在`baseADapter`我使用这段代码在现有列表视图中插入项目..

```
 this.iplist.add(ip);
    this.notifyDataSetChanged(); 
```

**重要提示：**
我还想提一下，这种行为发生在一种模式中，即正如我在上面所说的那样，当我插入第三个项目时，图像位置会发生变化。之后，当我添加第五个项目时，它会再次发生变化，依此类推。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:38:02.167

您应该将代码以更新适配器本身的图像视图。

适配器还应该知道绘制数据所需的所有信息。因此，与其存储字符串列表，不如存储对象列表，例如：

```
class Client {
  String ipAddress;
  boolean isConnected;
} 
```

然后你必须改变你的适配器：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View view=convertView;

    if (convertView==null) {
        view=inflater.inflate(R.layout.activeclientlist,null);
    }

    TextView ip=(TextView)view.findViewById(R.id.clientip);
    ImageView status = (ImageView )view.findViewById(R.id.status);

    Client c = getItem(position);

    ip.setText(c.getIpAddress());
    status.setImageDrawable(c.isConnected() ? R.drawable.ic_status_connected : 0);

    return view;
} 
```

然后只需更改代码以在连接状态更改时更新图像：

```
 if (resultCode!= 23) {   
     Integer i = data.getExtras().getInt("ChildAt");
     ((Client)adapter.getItem(i)).isConnected = true;
     adapter.notifyDataSetChanged();
  } 
```

这样，您就可以将与表示数据相关的所有代码保留在适配器中。副作用，它应该更正你的代码。

还可以查看 ViewHolder 模式，以避免在您有可用的 convertView 时在每一行上执行 findViewById。

# python - Python 脚本未在 crontab 中执行

> ID：11816746
> 
> 赞同：2
> 
> 时间：2012-08-05T13:15:36.703
> 
> 标签：python, linux, crontab

所以我试图让我的服务器每小时执行一个 Python 脚本。

当我进入目录并使用 python twitter.py 运行它时，它工作正常。

但是，我在 crontab 中有这个条目，但它不起作用：

```
0 * * * * /run/twitterparse/twitter.py > /run/twitterparse 
```

我试图让它每小时执行一次。

这是系统日志的输出：

```
Aug 5  13:00:01 localhost CRON[11474]: (root) CMD (/run/twitterparse/twitter.py >/run/twitterparse/)

Aug 5  13:00:01 localhost CRON[11473]: (CRON) info (No MTA installed, discarding output) 
```

现在它应该做的是访问数据库并将信息从网络保存到该数据库。该脚本在手动运行时可以正常运行，但不能自动运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T14:59:16.027

我通过这样做解决了我的问题

```
0 * * * * python /run/twitterparse/twitter.py > /run/twitterparse 
```

并且py文件应该是可执行的

```
chmod +x twitter.py 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:23:59.660

您可能需要添加

```
#!/usr/bin/python 
```

到主脚本的开头，带有您的 python 解释器的位置。

并将脚本的权限更改为可执行

```
chmod +x <main script name .py> 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T13:37:22.160

发送到终端（即 stdio 或 stderr）的 cron 脚本的任何输出都会发送到脚本注册的帐户的人。

您可以从错误消息中看到它正在尝试发送此邮件但“未安装 MTA”，因此它正在丢弃所有诊断消息。

您的第一步是解决 MTA 的问题，以便您可以接收邮件，或者确保将 stdio 和 stderr 写入日志文件。

我可以看到的明显问题是输出被定向到非文件。

```
/run/twitterparse/twitter.py > /run/twitterparse 
```

/run/twitterparse 不是文件夹吗？我猜：

```
/run/twitterparse/twitter.py > /run/twitterparse/ouput.txt 
```

能解决一半的问题。。

# php - 如何使用 PHP 检查文件是否在某个目录中？

> ID：11816749
> 
> 赞同：3
> 
> 时间：2012-08-05T13:15:53.380
> 
> 标签：php, directory, dir

在 PHP 中访问文件时，可以使用“..”从目录中转义，这可能会导致安全风险。有什么方法可以验证文件是否在指定目录中？它似乎没有内置功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:20:57.227

这不是检查文件是否存在于预期位置的安全方法。您应该执行以下操作。

```
$base     = '/expected/path/';
$filename = realpath($filename);
if ($filename === false || strncmp($filename, $base, strlen($base)) !== 0) {
    echo 'Missing file or not in the expected location';
}
else {
    echo 'The file exists and is in the expected location';
} 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-05T13:18:10.007

php.net上有一个很好的例子

[http://php.net/manual/en/function.file-exists.php](http://php.net/manual/en/function.file-exists.php)

```
<?php
$filename = '/path/to/foo.txt';

if (file_exists($filename)) {
    echo "The file $filename exists";
} else {
    echo "The file $filename does not exist";
}
?> 
```

# sql - randomblob(0) 和 zeroblob(0) 有什么区别？

> ID：11816753
> 
> 赞同：1
> 
> 时间：2012-08-05T13:16:40.393
> 
> 标签：sql, sqlite, blob

我正在[`length(x)`](http://www.sqlite.org/lang_corefunc.html#length)使用 SQLite 验证 BLOB 的工作原理，我惊讶地发现 的长度[`randomblob(0)`](http://www.sqlite.org/lang_corefunc.html#randomblob)为 1，甚至更多的长度[`zeroblob(0)`](http://www.sqlite.org/lang_corefunc.html#zeroblob)为 0，如下所示。不应该`randomblob(0)`和`zeroblob(0)`两者都有 0 长度？如果不是，为什么？

```
SQLite version 3.7.11 2012-03-20 11:35:50
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> select length(zeroblob(0));
0
sqlite> select length(zeroblob(1));
1
sqlite> select length(zeroblob(2));
2
sqlite> select length(randomblob(0));
1
sqlite> select length(randomblob(1));
1
sqlite> select length(randomblob(2));
2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T17:32:01.953

sqlite 文档说：

> randomblob(N) 函数返回一个包含伪随机字节的 N 字节 blob。如果 N 小于 1，则返回一个 1 字节的随机 blob。

在抨击答案之前，我应该阅读您的整个问题。无论如何，它仍然存在。

# orchardcms - Orchard cms hello world 模块

> ID：11816756
> 
> 赞同：0
> 
> 时间：2012-08-05T13:16:59.417
> 
> 标签：orchardcms

我按照教程创建了一个地狱世界模块。现在我希望 hello world 显示在我创建的每个页面上，而不是转到 site/helloworld。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T23:18:45.683

在默认图层上使用 HTML 小部件。

# javascript - 如何在 AngularJS 中手动触发表单的提交？

> ID：11816757
> 
> 赞同：19
> 
> 时间：2012-08-05T13:17:20.117
> 
> 标签：javascript, angularjs

我有一个想要嵌套的表单，但这是不可能的，因为 HTML 不能接受嵌套表单。有没有办法可以在 AngularJS 的第一个表单上手动调用提交（触发验证，例如需要）？

代码如下所示：

```
<div ng-conroller="ContactController">

    <form ng-submit="saveHeaderAndDetail()">
        <label for="Description">Description</label>
        <input type="text" ng-model="Description" required/> 

        <input type="text" style="visibility:hidden" />
    </form>

    <form ng-submit="addToDetail()">
    ... 
    </form>

    <input type="button" 
        ng-click="what code could trigger the first form's submit?"/>

</div> 
```

顺便说一句，如果有帮助，两种形式都在一个控制器下

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T23:01:49.713

尝试创建一个捕获事件的指令：

```
var app = angular.module('myApp', []);

function MyCtrl($scope) {
    $scope.triggerSubmit = function() {
        $scope.$broadcast('myEvent');
        console.log('broad');
    };

    $scope.onSubmitted = function() {
        alert('submitted!');
    };
}

app.directive('submitOn', function() {
    return {
        link: function(scope, elm, attrs) {
            scope.$on(attrs.submitOn, function() {
                //We can't trigger submit immediately, or we get $digest already in progress error :-[ (because ng-submit does an $apply of its own)
                setTimeout(function() {
                    elm.trigger('submit');
                });
            });
        }
    };
});
```

```
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet"/>
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script src="http://code.angularjs.org/1.0.0/angular-1.0.0.js"></script>
<div ng-controller="MyCtrl">
    <form submit-on="myEvent" ng-submit="onSubmitted()">
        Form...
    </form>
    <hr />
    <a class="btn" ng-click="triggerSubmit()">Submit</a>
</div>
```

原始来源：

```
http://jsfiddle.net/unWF3/ 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-13T08:56:31.783

我在这里回答了一个类似的问题[AngularJS - How to trigger submit in an nested form](https://stackoverflow.com/a/17082917/340290)

基本上，您可以通过触发`$validate`事件来触发验证

```
isFormValid = function($scope, ngForm) {
    $scope.$broadcast('$validate');
    if(! ngForm.$invalid) {
      return true;
} 
```

有关工作代码示例和有助于显示验证消息的小型实用程序方法，请参阅上述链接中的答案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-15T18:46:01.077

您可以使用[ng-form](http://docs.angularjs.org/api/ng.directive%3aform)指令嵌套表单。它会像：

```
<form name="accountForm">
  <div data-ng-form="detailsForm">
    <input required name="name" data-ng-model="name">
  </div>
  <div data-ng-form="contactsForm">
    <input required name="address" data-ng-model="address">
  </div>
  <button type="submit">Save</button>
</form> 
```

这样，何时`submit`触发`accountForm`它也会验证嵌套的 ng-forms。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-02T20:27:07.313

有一种更简单的方法可以做到这一点，您可以为应用程序中的每个表单命名，然后您就可以发送要触发的表单的整个 Angular 对象或使用它做任何您想做的事情. 例子：

```
<div ng-conroller="ContactController">

    <form name="myFirstForm" ng-submit="saveHeaderAndDetail()">
        <label for="Description">Description</label>
        <input type="text" ng-model="Description" required/> 

        <input type="text" style="visibility:hidden" />
    </form>

    <form name="mySecondForm" ng-submit="addToDetail()">
    ... 
    </form>

    <input type="button" 
        ng-click="saveHeaderAndDetail(myFirstForm)"/>

</div> 
```

然后在你的功能

```
saveHeaderAndDetail (myFirstForm) {
myFirstForm.$submitted = true
...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-22T13:48:23.043

我们总是可以直接使用 javascript 中的 submit() 函数提交表单。

```
document.getElementById("myform").submit() 
```

这样，我们可以先使用 angularjs 验证表单，如果表单有效，则使用 submit 方法提交。

# c# - 在旧项目之前将新项目插入 WPF 列表框

> ID：11816761
> 
> 赞同：0
> 
> 时间：2012-08-05T13:18:05.617
> 
> 标签：c#, wpf, listbox

我如何在旧项目之前将新项目插入 WPF 列表框中

然后我`old text`添加

```
new text 

old text 
```

反而

```
old text 

new text 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:44:14.327

```
ListBox.Items.Insert(0, "Message"); 
```

像这样的东西？

# javascript - 用 jQuery 重写日期/时间格式

> ID：11816764
> 
> 赞同：0
> 
> 时间：2012-08-05T13:18:14.967
> 
> 标签：javascript, jquery, html, date, time

我一直在寻找解决方案，但找不到任何东西。我正在尝试重新格式化输入表单的日期和时间，最好使用 jQuery。我没有使用日期选择器。我正在尝试重写日期，因此它们以“dd/mm/yyyy”的格式出现，所以如果用户输入“050812”、“05082012”、“05-08-2012”等，日期会重新变为“dd/mm” /yyyy”。我也在尝试使用时间字段来实现这一点，因此格式将为“hh:mm”。

实现这一目标的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T14:03:26.493

正如@eicto 所说，datepicker 是最好的选择。

但如果你真的想要另一种方式：

向用户展示输入数据的正确方法：http: [//jsfiddle.net/bmSPs/1/](http://jsfiddle.net/bmSPs/1/) 屏蔽输入：[http ://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

OBS：如果您想要一种更强大的方式来控制时间，您还可以使用[http://keith-wood.name/timeEntry.html](http://keith-wood.name/timeEntry.html)

# android - Android：在模拟器上安装 apk，同时运行 openGL ES2.0

> ID：11816765
> 
> 赞同：0
> 
> 时间：2012-08-05T13:18:22.457
> 
> 标签：android, opengl-es-2.0

我已经在我的模拟器上启用了 GPU 支持。

但我收到了错误

安装 Testing.apk... sdk/emulator/opengl/host/libs/Translator/GLES_V2/GLESv2Imp.cpp:glUseProgram:1911 错误 0x501 sdk/emulator/opengl/host/libs/Translator/GLES_V2/GLESv2Imp.cpp:glGetUniformLocation: 1380 错误 0x501 sdk/emulator/opengl/host/libs/Translator/GLES_V2/GLESv2Imp.cpp:glGetAttribLocation:825 错误 0x501 sdk/emulator/opengl/host/libs/Translator/GLES_V2/GLESv2Imp.cpp:glUseProgram:1911 错误 0x501

等等....

PLz帮帮我。。非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:22:25.987

根据这个问题：[带有 vbo 的 opengl 给出错误 0x501](https://stackoverflow.com/questions/9415111/opengl-with-vbo-gives-error-0x501)

错误是什么时候

> 根据文档：“如果偏移量或大小为负，或者如果它们一起定义了超出缓冲区对象分配的数据存储的内存区域，则会生成 GL_INVALID_VALUE。”

# javascript - 打开街道地图长线在高缩放级别消失

> ID：11816766
> 
> 赞同：0
> 
> 时间：2012-08-05T13:18:39.323
> 
> 标签：javascript, openlayers, openstreetmap

我正在使用 osm 开发路径创建器。添加线条效果很好，但是当制作一条很长的线条并放大它时，线条会以高缩放级别消失。如果视口远离线的起点和/或终点，似乎会出现这种情况。也许拆分线可能会有所帮助，但是最大尺寸是多少？

这是一个缩小的代码示例，如果您放大到 7 级，则该行消失了：

```
 $(document).ready(function() {    
            var map = new OpenLayers.Map('map');

            var mapnik = new OpenLayers.Layer.OSM.Mapnik("Mapnik");
            map.addLayer(mapnik);

            var path = new OpenLayers.Layer.Vector("path");
            map.addLayer(path);  

            var pathStyle = {
                    strokeColor: "#0033ff",
                    strokeOpacity: 0.7,
                    strokeWidth: 5
            };

            var points = new Array(
                    new OpenLayers.Geometry.Point(-7856503.5146562, 880554.5664875),
                    new OpenLayers.Geometry.Point(8502243.5278938, 724011.5325875)
            );

            var line = new OpenLayers.Geometry.LineString(points);

            var lineFeature = new OpenLayers.Feature.Vector(line, null, pathStyle);
            path.addFeatures([lineFeature]);

            map.zoomToExtent(path.getDataExtent());
    }); 
```

我对osm很陌生，所以也许我只是搞砸了一些东西..有什么想法吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T11:42:46.970

我正在玩萤火虫并浏览 svg 元素。原来 osm 使用 svg polyline 来制作线条。该行的值空间不足，值超过 15000，这对于那里的渲染器来说太多了。

我检查了关于这个问题的错误报告： [https ://github.com/openlayers/openlayers/issues/617](https://github.com/openlayers/openlayers/issues/617)

我目前的解决方法是将线路分成 100 公里的和平线。这可行，但需要更多计算。

如果有人感兴趣，这里是一个数学有用的网站： [http ://www.movable-type.co.uk/scripts/latlong.html](http://www.movable-type.co.uk/scripts/latlong.html)

# objective-c - 解析错误 = 错误域 = NSXMLParserErrorDomain 代码 = 5“操作无法完成。（NSXMLParserErrorDomain 错误 5。）”

> ID：11816775
> 
> 赞同：0
> 
> 时间：2012-08-05T13:20:48.247
> 
> 标签：objective-c, nsxmlparser

```
-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSLog(@"3 DONE. Received Bytes: %d", [getMagaListsWebData length]);
    NSString *recievedXML = [[NSString alloc]initWithData:getMagaListsWebData encoding:NSUTF8StringEncoding];

    [recievedXML release];
    //重新加載xmlParser
    if(getMagaListsXmlParser){
        [getMagaListsXmlParser release];
        getMagaListsXmlParser = nil;
    }
    getMagaListsXmlParser = [[NSXMLParser alloc]initWithData:getMagaListsWebData];
    [getMagaListsXmlParser setDelegate: self];
    [getMagaListsXmlParser setShouldResolveExternalEntities: YES];
    [getMagaListsXmlParser parse];
    if (![getMagaListsXmlParser parse]) {
        NSLog(@"parse error = %@", [getMagaListsXmlParser parserError]);
        //theConnection = [[NSURLConnection alloc] initWithRequest:getMagaListsRequest delegate:self startImmediately:YES];
    }
} 
```

我收到错误消息：

```
parse error = Error Domain=NSXMLParserErrorDomain
  Code=5 "The operation couldn’t be completed. (NSXMLParserErrorDomain error 5.)" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:39:13.660

一个非常有用的技巧是聚焦有问题的错误/域

`NSXMLParser.h, NSXMLParserPrematureDocumentEndError = 5,`

似乎您的入站文档有问题，可能是某个地方的不平衡块。

# algorithm - 无遮挡查询的深度剥离

> ID：11816777
> 
> 赞同：2
> 
> 时间：2012-08-05T13:21:03.027
> 
> 标签：algorithm, glsl, webgl

我想在 webgl 中实现“深度剥离”，但问题是没有遮挡查询，所以我不知道如何检查场景的“剥离”何时结束。

你看到另一种方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:25:11.077

通常的方法是将剥离限制在一定数量的步骤内。这有时甚至比使用遮挡查询更好，因为许多透明结构层变得几乎无法相互辨别。了解您正在渲染的内容通常有助于准确估计您需要剥离的图层数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T15:12:56.227

我最近在 webgl 中实现了深度剥离。有一些限制因素使得做尽可能多的剥皮有点困难。主要是纹理单元的数量非常有限，而且您一次只能渲染到一个目标，因此您必须分别渲染颜色和深度。使用 7 种纹理，我可以做 4 次果皮。每帧已经需要 11 次渲染通道。要进行更多剥离，您需要对中间结果进行更复杂的合并。我怀疑你从更多的果皮中获得了很多。

# android - 找不到与给定名称匹配的资源：attr 'android:tabLayout'

> ID：11816779
> 
> 赞同：5
> 
> 时间：2012-08-05T13:21:06.817
> 
> 标签：android, tabwidget

我想通过用我自己的样式替换样式来自定义选项卡小部件。我要更换的项目如下：

```
 <item name="android:tabLayout">@android:layout/tab_indicator_holo</item> 
```

但是我收到了这个错误：没有找到与给定名称匹配的资源：attr 'android:tabLayout'

我已经设置了这样的父样式：

```
<style name="customTabWidget" parent="@android:style/Widget.Holo.TabWidget"> 
```

项目构建目标：Android 4.0

我也清理了项目，但错误仍然存​​在。如何修复错误？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T17:36:35.430

我遇到了类似的问题。至少部分解决方案是将 tabLayout 属性添加到 res/values/attrs.xml。下面是从 android-16 平台复制的 TabWidget 样式的定义（注意末尾的 tabLayout 属性）：

```
<declare-styleable name="TabWidget">
    <!-- Drawable used to draw the divider between tabs. -->
    <attr name="divider" />
    <!-- Determines whether the strip under the tab indicators is drawn or not. -->
    <attr name="tabStripEnabled" format="boolean" />
    <!-- Drawable used to draw the left part of the strip underneath the tabs. -->
    <attr name="tabStripLeft" format="reference" />
    <!-- Drawable used to draw the right part of the strip underneath the tabs. -->
    <attr name="tabStripRight" format="reference" />
    <!-- Layout used to organize each tab's content. -->
    <attr name="tabLayout" format="reference" />
</declare-styleable> 
```

由于您是压倒一切的，因此您还需要更改：

```
 <item name="android:tabLayout">... 
```

至：

```
 <item name="tabLayout">... 
```

# cuda - 为什么要费心去了解 CUDA Warps？

> ID：11816786
> 
> 赞同：16
> 
> 时间：2012-08-05T13:22:20.280
> 
> 标签：cuda, gpu, gpu-warp

我有 GeForce GTX460 SE，所以它是：6 SM x 48 CUDA Cores = 288 CUDA Cores。众所周知，一个 Warp 中包含 32 个线程，并且在一个块中同时（一次）只能执行一个 Warp。也就是说，在单个多处理器（SM）中只能同时执行一个 Block、一个 Warp 和只有 32 个线程，即使有 48 个内核可用？

此外，可以使用threadIdx.x和blockIdx.x来分配具体的Thread和Block的示例。要分配它们，请使用内核 <<< Blocks, Threads >>> ()。但是如何分配特定数量的 Warp 并分配它们，如果不可能，那么为什么还要费心去了解 Warp 呢？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-05T16:26:16.053

![GTX460 SM 概述](../Images/6e7f89a940d26a0659d22ff226603ae9.png)

情况比你描述的要复杂得多。

ALU（核心）、加载/存储 (LD/ST) 单元和特殊功能单元 (SFU)（图中的绿色）是流水线单元。它们在完成的不同阶段同时保留许多计算或操作的结果。因此，在一个周期中，他们可以接受一项新操作并提供很久以前开始的另一项操作的结果（如果我没记错的话，ALU 大约需要 20 个周期）。因此，理论上单个 SM 具有同时处理 48 * 20 个周期 = 960 个 ALU 操作的资源，即每个 warp 有 960 / 32 个线程 = 30 个 warp。此外，它可以处理任何延迟和吞吐量的 LD/ST 操作和 SFU 操作。

warp 调度程序（图中的黄色）可以为每个 warp 调度 2 * 32 个线程 = 64 个线程到每个周期的管道。这就是每个时钟可以获得的结果数量。因此，考虑到计算资源的混合，48 个核心、16 个 LD/ST、8 个 SFU，每个都有不同的延迟，同时处理混合的 warp。在任何给定的周期，warp 调度器都会尝试“配对”两个 warp 来调度，以最大化 SM 的利用率。

如果指令是独立的，warp 调度程序可以从不同的块或同一块中的不同位置发出 warp。因此，可以同时处理来自多个块的扭曲。

更复杂的是，执行指令的资源少于 32 个的 warp 必须多次发出，以便为所有线程提供服务。例如，有 8 个 SFU，这意味着包含需要 SFU 的指令的 warp 必须被调度 4 次。

这个描述被简化了。还有其他一些限制也在起作用，它们决定了 GPU 如何安排工作。您可以通过在网上搜索“fermi architecture”找到更多信息。

所以，来到你的实际问题，

> 为什么要费心去了解 Warps？

当您尝试最大化算法的性能时，了解 warp 中的线程数并将其考虑在内变得很重要。如果您不遵守这些规则，您将失去性能：

*   在内核调用中`<<<Blocks, Threads>>>`，尝试选择与 warp 中的线程数均分的线程数。如果你不这样做，你最终会启动一个包含非活动线程的块。

*   在您的内核中，尝试让 warp 中的每个线程都遵循相同的代码路径。如果你不这样做，你就会得到所谓的经线发散。发生这种情况是因为 GPU 必须通过每个不同的代码路径运行整个 warp。

*   在您的内核中，尝试让每个线程都以特定模式加载和存储数据。例如，让 warp 中的线程访问全局内存中的连续 32 位字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T02:47:56.477

> 线程是否必须按顺序分组为 Warps，1 - 32、33 - 64 ...？

是的，编程模型保证线程按特定顺序分组到 warp 中。

> 作为优化发散代码路径的一个简单示例，可以使用将块中的所有线程分成 32 个线程组吗？例如：switch (threadIdx.s/32) { case 0: /* 1 warp*/ break; case 1: /* 2 warp*/ break; /* ETC */ }

确切地 ：）

> 单个 Warp 一次必须读取多少字节：4 字节 * 32 线程、8 字节 * 32 线程或 16 字节 * 32 线程？据我所知，一次对全局内存的一个事务接收 128 个字节。

是的，到全局内存的事务是 128 字节。因此，如果每个线程从连续地址读取一个 32 位字（它们可能也需要 128 字节对齐），那么 warp 中的所有线程都可以通过单个事务进行服务（4 字节 * 32 线程 = 128 字节）。如果每个线程读取更多字节，或者如果地址不连续，则需要发出更多事务（针对每个单独的 128 字节行触摸单独的事务）。

这在 CUDA 编程手册 4.2 的 F.4.2 节“全局内存”中有描述。那里还有一个宣传语，说情况与仅缓存在 L2 中的数据不同，因为 L2 缓存具有 32 字节的缓存行。我不知道如何安排仅在 L2 中缓存数据或最终处理多少事务。

# java - 使用静态初始化程序的枚举错误

> ID：11816794
> 
> 赞同：2
> 
> 时间：2012-08-05T13:23:06.797
> 
> 标签：java, enums

我目前正在开发一个项目（数据库实现），该项目涉及一个枚举类`ElementType`，其内部枚举名为`TypeType`. 里面`ElementType`有一个`HashMap<TypeType, ArrayList<ElementType>>`将所有的映射`ElementType`到它们对应的`TypeType`值。

`TypeType`的值为

```
[TEXT, NUMERIC_EXACT, NUMERIC_APPROX, OTHER] 
```

`ElementType`（及其对应的`TypeType`）的值是

`[CHARACTER(TEXT), CHAR(TEXT), DECIMAL(NUMBER_EXACT), DEC(NUMBER_EXACT), NUMERIC(NUMERIC_EXACT), INTEGER(NUMERIC_EXACT), INT(NUMERIC_EXACT), SMALLINT(NUMERIC_EXACT), FLAT(NUMERIC_APPROX), REAL(NUMERIC_EXACT), DOUBLE_PRECISION(NUMERIC_APPROX), DOUBLE(NUMERIC_APPROX), DATE(OTHER), TIME(OTHER), VARCHAR(OTHER), LONG_VARCHAR(OTHER)]`

在一个`static {}`区域，我有这个代码：

```
for(ElementType eType : values()) {
    TypeType t = eType.getTYPE();
    if(typeMapping.get(t) != null)
        typeMapping.get(t).add(eType);
    else
        typeMapping.put(t, new ArrayList<ElementType>() {add(eType);});
} 
```

`eType`在 for 循环中提到的所有内容在 Eclipse 中都带有红色下划线。

第一个给出了错误`eType cannot be resolved`。

第二个给出`eType cannot be resolved to a variable`。

第三个（在 内`ArrayList`）给出`Syntax error on token "eType", VariableDeclaratorId expected after this token`.

该`getTYPE()`方法是私有的，并返回每个 ElementType 的 TypeType。就是上面提到的`typeMapping`HashMap。

我不知道是什么导致了这个或如何解决它，有谁知道如何解决这个问题，或者我能做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T13:48:29.707

问题在这里：

```
typeMapping.put(t, new ArrayList<ElementType>() {add(eType);});
                                                ^^^^^^^^^^^^^ 
```

`ArrayList`您尝试创建从静态初始化程序块内部派生的内部非静态类。如果您将其替换为普通的`new ArrayList`plus `alist.add(eType)`，它将起作用。

**或者**你可以使用：

```
typeMapping.put(t, new ArrayList<ElementType>() {{add(eType);}}); 
```

注 1：必须有*两个*左大括号和右大括号。因此，终点是[“双括号初始化”](http://c2.com/cgi/wiki?DoubleBraceInitialization)。

注意 2：对于 DBI，您必须`eType` `final`在循环中进行。

虽然我不得不承认，错误消息*有点*不清楚。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-05T13:43:46.570

这是一个在我的机器“Java HotSpot 1.6.0_21”上编译和工作的例子：

```
import java.util.*;

public enum ElementType {

    CHARACTER(TypeType.TEXT), CHAR(TypeType.TEXT), DEC(TypeType.NUMERIC_EXACT);

    public static enum TypeType {
        TEXT, NUMERIC_EXACT;
    }

    private TypeType type;

    private ElementType(TypeType type) {
        this.type = type;
    }

    private static Map<TypeType, List<ElementType>> typeMapping;

    static {
        typeMapping = new HashMap<TypeType, List<ElementType>>();
        for (ElementType eType : values()) {
            TypeType t = eType.type;
            if (!typeMapping.containsKey(t)) {
                typeMapping.put(t, new ArrayList<ElementType>());
            }
            typeMapping.get(t).add(eType);
        }

    }

    public static void main(String[] args) {
        System.out.println(typeMapping);
    }
} 
```

对你起作用吗？

# serialization - 如何在 Windsor 容器中注册一个 IsolrFieldSerializer 以便 SolrNet 可以获取它

> ID：11816795
> 
> 赞同：0
> 
> 时间：2012-08-05T13:23:14.240
> 
> 标签：serialization, solr, castle-windsor, solrnet

当发布到 Solr 时，我试图让一个枚举序列化为它的 int 值。

所以我已经实现了一个[IsolrFieldSerializer](https://github.com/mausch/SolrNet/blob/master/SolrNet/Impl/ISolrFieldSerializer.cs)来做到这一点，正如[这里](https://stackoverflow.com/questions/8668275/index-the-value-of-an-enum-not-the-string)所建议的那样。但我似乎可以在[Windsor](http://docs.castleproject.org/Default.aspx?Page=MainPage&NS=Windsor&AspxAutoDetectCookieSupport=1)容器中注册它，然后它会被 SolrNet 使用

这是我所拥有的：

除了没有使用序列化程序之外，这工作正常，尽管它出现在容器组件列表中。有任何想法吗？

```
 container.Register(Component.For<ISolrFieldSerializer>().ImplementedBy<SolrEnumSerializer>());
    Startup.Init<SearchBox>("http://10.10.10.10:0000/solr/boxes");

    container.Register(Component.For<ISolrOperations<SearchBox>>()
                          .UsingFactoryMethod(k => ServiceLocator.Current.GetInstance<ISolrOperations<SearchBox>>())); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:12:57.107

我通过删除默认实现并将其替换为自定义实现对其进行了排序：

```
Startup.Container.Remove<ISolrFieldSerializer>();

var fieldSerializer = new CustomSerializer();
Startup.Container.Register<ISolrFieldSerializer>(c => fieldSerializer); 
```

自定义序列化器：

```
public class CustomSerializer : ISolrFieldSerializer 
    {
        private readonly AggregateFieldSerializer _serializer;

        public CustomSerializer()
        {
            _serializer = new AggregateFieldSerializer(new ISolrFieldSerializer[]
                                                          {
                                                              new MyCustom1Serializer(),
                                                              new MyCustom2Serializer(),
                                                              new CollectionFieldSerializer(this),
                                                              new GenericDictionaryFieldSerializer(this),
                                                              new NullableFieldSerializer(new BoolFieldSerializer()),
                                                              new NullableFieldSerializer(new DateTimeFieldSerializer()),
                                                              //new MoneyFieldSerializer(),
                                                              new FormattableFieldSerializer(),
                                                              new TypeConvertingFieldSerializer(),

                                                          });
        }

        public  bool CanHandleType(Type t)
        {
            return _serializer.CanHandleType(t);
        }

        public IEnumerable<PropertyNode> Serialize(object obj)
        {
            return _serializer.Serialize(obj);
        }
    } 
```

# c# - 3 级表的 NHibernate Linq where 子句

> ID：11816798
> 
> 赞同：1
> 
> 时间：2012-08-05T13:23:39.347
> 
> 标签：c#, linq, nhibernate

我有三个表，组-> 用户-> 帐户。组可以有多个用户，用户可以有多个帐户。

当我尝试使用查询获取组中的所有帐户时

```
var accounts = accountRepository.FindAll(x => x.User.Group.Id == groupId); 
```

其中 FindAll 是公共存储库中的方法

```
/// <summary>
/// Find all entities with filter
/// </summary>
/// <param name="expression">Linq expression</param>
/// <returns>IQueryOver of entity of type TEntity</returns>
public IQueryOver<TEntity> FindAll(Expression<Func<TEntity, bool>> expression)
{
    var query = _session.QueryOver<TEntity>();
    query.Cacheable().CacheMode(CacheMode.Normal);
    return query.Where(expression);
} 
```

我在组中查找所有帐户的查询不起作用，因为它会抛出消息错误

```
could not resolve property: User.Group.Id 
```

编写此查询的更好方法是什么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:45:45.110

改用 Linq 到 NHibernate：

```
public IQueryable<TEntity> FindAll(Expression<Func<TEntity, bool>> expression)
{
    var query = _session.Query<TEntity>();
    return query.Where(expression);
} 
```

与 不同`QueryOver`的是，Linq 提供程序支持此类查询（遍历实体层次结构），将其转换为 SQL 连接。

# objective-c - 在 Objective c 中声明或不声明

> ID：11816799
> 
> 赞同：2
> 
> 时间：2012-08-05T13:23:59.410
> 
> 标签：objective-c, variables, declaration

我从 obj-c 开始，有一些我没有得到的东西。

首先是我（哦，我来自 AS3 编码的角度）认为如果你想在你的类中有一个变量，你需要先在标题中使用 @property 运算符声明它，然后在 @synthesize .m 文件，并且您还必须在标头中声明该方法，但是我遇到过仅在 .m 文件的方法中定义变量的情况，而没有在任何地方声明，方法也是如此, 直接写入 .m 文件的方法，没有声明，它们工作正常。

那么@property/@synthesize 用于变量并在头文件中声明方法有什么意义呢？这与范围有关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T13:27:50.420

您所说的不是*变量的声明，*而是通过getter和setter*从类外部公开它。*

@property/@synthesize 只是自动创建两种方法的快捷方式，它们是

*   `- (void) [class setVariable:(type)var]`
*   `- (type) [class variable]`

可以从其他类中设置和获取变量。

并非每个变量都需要从类外部设置或获取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:30:34.793

头文件 (.h) 应该包含您希望**其他类**了解该类的内容。类扩展——.m 文件中的接口部分——是私有声明的好地方。（如果一个方法在使用之前就被定义了，那么这就是一个声明。它不是最优的，但它可以工作。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T13:31:08.553

Objective-C 中的变量主要分为三类：

*   实例变量
*   静态范围变量（静态、全局和函数静态）
*   自动范围变量（局部变量和函数/方法参数）

当您声明和合成一个属性时，会为您创建一个*实例变量。*另一方面，局部变量是在代码块的范围内声明的，不能通过属性声明。

# c# - Silverlight 中的异步套接字连接

> ID：11816802
> 
> 赞同：4
> 
> 时间：2012-08-05T13:24:39.997
> 
> 标签：c#, silverlight, sockets, asynchronous, tcp

我有 TCP Socket 服务器，想为它制作异步 Silverlight 客户端，但我找不到任何有用的信息。确切地说，我需要三个步骤：连接、发送和接收。

不需要很详细，至少是如何构建它以连接到服务器的想法。

顺便说一句，我使用 Silverlight 5。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T00:13:41.290

非常感谢 Karel Frajtak 提供有关 Silverlight 中套接字的视频链接！该视频教程中显示并解释了所有内容，因此我建议每个需要 Silverlight 中的套接字的人观看它！这是我需要的解决方案，并解释了做什么和我的评论：

我假设**所有连接操作都将由单独的类*SocketConnection***处理：

```
public class MessageEventArgs : EventArgs
{
    public string Message { get; set; }
}
public class SocketConnection
{
    /// <summary>
    /// Event handler shot when message is received
    /// </summary>
    public event EventHandler<MessageEventArgs> MessageReceived;

    /// <summary>
    /// Socket used for connection to the server, sending and receiving data
    /// </summary>
    Socket socket;

    /// <summary>
    /// Default buffer size that should be used with the same value in both server and client
    /// </summary>
    int bufferSize = 128;

    /// <summary>
    /// Buffer used to store bytes received
    /// </summary>
    byte[] buffer;

    /// <summary>
    /// Bytes received in current receiving operation
    /// </summary>
    int bytesReceived;

    public SocketConnection(string host = "localhost", int port = 4502)
    {
        // Initializing buffer for receiving data
        buffer = new byte[bufferSize];
        // Initializing socket to connect to the server with default parameters
        // *** If you need IPv6, set the AddressFamily.InterNetworkV6 ***
        // *** Silverlight supports only Stream or Unknown socket types (Silverlight 5) ***
        // *** The only defined protocol supported by Silverlight is TCP.
        //     Others can be only Unknown or Unspecified (Silverlight 5)***
        socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

        // Socket args that are needed for connection
        SocketAsyncEventArgs args = new SocketAsyncEventArgs()
        {
            // Server IP and port
            RemoteEndPoint = new DnsEndPoint(host, port),
            // If policy server is hosted as TCP socket, this has to be set to SocketClientAccessPolicyProtocol.Tcp
            // If policy is stored in HTTP server, this has to be set SocketClientAccessPolicyProtocol.Http
            SocketClientAccessPolicyProtocol = SocketClientAccessPolicyProtocol.Tcp
        };
        // Set the event handler for completed connection (nomatter if it is successful or not)
        args.Completed += OnConnected;
        // Start connecting to the server asynchronously
        socket.ConnectAsync(args);
    }

    /// <summary>
    /// Even handler shot when socket connection is completed
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    void OnConnected(object sender, SocketAsyncEventArgs e)
    {
        // If the connection is not successful, set socket object to null
        if (e.SocketError != SocketError.Success)
        {
            if (e.SocketError == SocketError.AccessDenied)
            {
                // Policy server is not running or cannot be reached
                throw new SocketException((int)SocketError.AccessDenied);
            }
            socket = null;
        }
        // Begin receiving data otherwise
        else
        {
            BeginRead();
        }
    }

    /// <summary>
    /// Method for receiving data from the server
    /// </summary>
    private void BeginRead()
    {
        // Receive data only if socket is connected
        if (socket != null && socket.Connected)
        {
            SocketAsyncEventArgs args = new SocketAsyncEventArgs();
            // Store the received buffer in a class variable
            args.SetBuffer(buffer, bytesReceived, buffer.Length - bytesReceived);
            // Set the event handler for received data
            args.Completed += OnReceived;

            // Start receiving data asynchronously
            socket.ReceiveAsync(args);
        }
    }

    /// <summary>
    /// Event handler shot when data is received from the server
    /// </summary>
    void OnReceived(object sender, SocketAsyncEventArgs e)
    {
        // Make sure that receiving was successful
        if (e.SocketError == SocketError.Success)
        {
            // Increase the count of received bytes in the current receiving operation
            bytesReceived += e.BytesTransferred;
        }
        // If the receiving was unsuccessful, throw an exception
        else
        {
            throw new SocketException();
        }
        // Check if the buffer is already full
        if (bytesReceived == buffer.Length)
        {
            // If the buffer is full, decode the string received from bytes
            // *** This should be your object deserialization, if you use anything but string ***
            string text = Encoding.UTF8.GetString(buffer, 0, buffer.Length);

            // If the event was set from somewhere, shoot it
            // *** In most cases event is set from UI thread to handle the
            //     received string or object and show the result to user ***
            if (MessageReceived != null)
            {
                // Shoot the event, if it's set
                MessageReceived(this, new MessageEventArgs()
                {
                    Message = text
                });
            }

            // Set the bytes received count to 0, for other data receiving event to fill the buffer from begining
            bytesReceived = 0;
        }
        // Begin the data receiving again
        BeginRead();
    }

    /// <summary>
    /// Sample method to send data to the server
    /// </summary>
    /// <param name="text">Text you would like the server to receive</param>
    public void SendText(string text)
    {
        // Check if the socket is connected to the server
        if (socket != null && socket.Connected)
        {
            // Encode the string to be sent to bytes
            // *** This is where your object serialization should be done ***
            byte[] buffer = Encoding.UTF8.GetBytes(text);
            // Check if the buffer is not empty
            if (buffer.Length != 0)
            {
                SocketAsyncEventArgs args = new SocketAsyncEventArgs();
                // Set the buffer to be sent
                args.SetBuffer(buffer, 0, buffer.Length);

                // Start sending buffer to the server asynchronously
                socket.SendAsync(args);
            }
        }
    }
} 
```

要使 Silverlight 中的套接字连接成功，**必须有**

*   *跨域策略**套接字服务器***，托管在**端口 943**

**或者**

*   **托管在**HTTP 服务器**（端口 80）上*的跨域策略****文件。*****

 **如果您选择使用*socket server*，这里有一个工作示例源代码：

样本取自[这里](http://blogs.silverlight.net/blogs/msnow/archive/2008/06/26/full-implementation-of-a-silverlight-policy-server.aspx)，上面写着

> 策略服务器 <...> 必须在端口 943 上运行

并没有说明在 HTTP 服务器上托管它的可能性，**只是因为文章太旧了**。

```
using System;
using System.IO;
using System.Net;
using System.Net.Sockets;

namespace PolicyServer
{
    // Encapsulate and manage state for a single connection from a client
    class PolicyConnection
    {
        private Socket _connection;
        private byte[] _buffer; // buffer to receive the request from the client       
        private int _received;
        private byte[] _policy; // the policy to return to the client

        // the request that we're expecting from the client
        private static string _policyRequestString = "<policy-file-request/>";

        public PolicyConnection(Socket client, byte[] policy)
        {
            _connection = client;
            _policy = policy;

            _buffer = new byte[_policyRequestString.Length];
            _received = 0;

            try
            {
                // receive the request from the client
                _connection.BeginReceive(_buffer, 0, _policyRequestString.Length, SocketFlags.None,
                    new AsyncCallback(OnReceive), null);
            }
            catch (SocketException)
            {
                _connection.Close();
            }
        }

        // Called when we receive data from the client
        private void OnReceive(IAsyncResult res)
        {
            try
            {
                _received += _connection.EndReceive(res);

                // if we haven't gotten enough for a full request yet, receive again
                if (_received < _policyRequestString.Length)
                {
                    _connection.BeginReceive(_buffer, _received, _policyRequestString.Length - _received,
                        SocketFlags.None, new AsyncCallback(OnReceive), null);
                    return;
                }

                // make sure the request is valid
                string request = System.Text.Encoding.UTF8.GetString(_buffer, 0, _received);
                if (StringComparer.InvariantCultureIgnoreCase.Compare(request, _policyRequestString) != 0)
                {
                    _connection.Close();
                    return;
                }

                // send the policy
                Console.Write("Sending policy...\n");
                _connection.BeginSend(_policy, 0, _policy.Length, SocketFlags.None,
                    new AsyncCallback(OnSend), null);
            }
            catch (SocketException)
            {
                _connection.Close();
            }
        }

        // called after sending the policy to the client; close the connection.
        public void OnSend(IAsyncResult res)
        {
            try
            {
                _connection.EndSend(res);
            }
            finally
            {
                _connection.Close();
            }
        }
    }

    // Listens for connections on port 943 and dispatches requests to a PolicyConnection
    class PolicyServer
    {
        private Socket _listener;
        private byte[] _policy;

        // pass in the path of an XML file containing the socket policy
        public PolicyServer(string policyFilePath)
        {

            // Load the policy file
            FileStream policyStream = new FileStream(policyFilePath, FileMode.Open);

            _policy = new byte[policyStream.Length];
            policyStream.Read(_policy, 0, _policy.Length);
            policyStream.Close();

            // Create the Listening Socket
            _listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream,
                ProtocolType.Tcp);

            _listener.SetSocketOption(SocketOptionLevel.Tcp, (SocketOptionName)
                SocketOptionName.NoDelay, 0);

            _listener.Bind(new IPEndPoint(IPAddress.Any, 943));
            _listener.Listen(10);

            _listener.BeginAccept(new AsyncCallback(OnConnection), null);
        }

        // Called when we receive a connection from a client
        public void OnConnection(IAsyncResult res)
        {
            Socket client = null;

            try
            {
                client = _listener.EndAccept(res);
            }
            catch (SocketException)
            {
                return;
            }

            // handle this policy request with a PolicyConnection
            PolicyConnection pc = new PolicyConnection(client, _policy);

            // look for more connections
            _listener.BeginAccept(new AsyncCallback(OnConnection), null);
        }

        public void Close()
        {
            _listener.Close();
        }
    }

    public class Program
    {
        static void Main()
        {
            Console.Write("Starting...\n");
            PolicyServer ps =
                new PolicyServer(@".\clientaccesspolicy.xml");
            System.Threading.Thread.Sleep(System.Threading.Timeout.Infinite);
        }
    }
} 
```

就是这样。**首先**运行*跨域策略服务器，* **然后再**运行您的客户端，以确保连接成功。

 ****如果您需要**异步 WPF 套接字服务器**示例，请询问并给我问题的链接！我用 async-await 关键字构建了一个，尽可能简单。

祝一切顺利！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T05:51:15.477

Mike Taulty 制作了一个介绍 Silverlight 4 网络的视频，[这里](http://channel9.msdn.com/Blogs/mtaulty/Silverlight-Beta-4-Networking-Part-8-TCP-Sockets)讨论了套接字。******

# junit - 可以在 JUnit 中的 float 和 double 值上使用 assertTrue 吗？

> ID：11816804
> 
> 赞同：2
> 
> 时间：2012-08-05T13:24:56.033
> 
> 标签：junit, decimal, assert

我尝试在浮点数上使用 assertEquals 方法，eclipse 说该方法已折旧。因此，以下替代方案是否可以接受？

```
Assert.assertTrue("Total does not match expected total :",
                                            receipt.getTotal() == 32.19f); 
```

是否有特定原因不能使用 assertEquals 来比较测试中的两个浮点数或双精度数？

一般来说，在 JUnit 中断言两个十进制值相等的最佳方法是什么。我正在使用 JUnit 的 4.10 版本

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:28:51.773

通常，您可以将原始类型与 == 进行比较，但对于浮点值，两个值可以看起来相同（当格式化为字符串时）但是是两个不同的值。您应该使用[assertEquals(expected, actual, delta)](http://junit.sourceforge.net/javadoc/org/junit/Assert.html#assertEquals%28double,%20double,%20double%29)。请参阅 JUnit 的答案[： assertEquals for double values](https://stackoverflow.com/questions/5686755/junit-assertequals-for-double-values)。

因为双精度（和浮点）计算不一定准确，所以您可以使用 delta 进行比较（实际上是误差范围）。

# javascript - javascript 函数中 this 的范围

> ID：11816812
> 
> 赞同：3
> 
> 时间：2012-08-05T13:25:47.367
> 
> 标签：javascript

如果您有以下代码：

```
var global = this;
function A () {
    function B () {
        return this;
    }
    return B();
}
var C = new A();
C === global // true 
```

为什么`this`in 函数 B 指的是全局空间而不是`this`对象 A 的空间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T13:26:56.253

的值`this`取决于每个函数调用。因为`B`是在没有任何上下文的情况下调用的，所以 的值`this`是全局对象。

可以通过简单地复制它来保存`this`在外部上下文中：

```
function A() {
  var x = this;
  function B() {
    return x;
  }
  return B();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T13:51:48.307

`this`与范围无关，它不是变量。它是一个评估当前执行函数的对象上下文的关键字。函数的对象上下文取决于你如何调用它。函数的定义位置或方式无关紧要。

当您调用这样的函数时，`fn()`它不在对象上下文中，并且语言错误地尝试解决它，而它应该只是在看到`this`. 这在严格模式下有些固定，它会评估为`undefined`.

当您将函数作为某个对象的属性调用时，IE`obj.fn()`将`obj`绑定到`this`该调用。

由于必须将函数附加到某个对象以获取调用的正确对象上下文会很笨重，因此所有函数都继承一个`.call`允许您显式指定对象上下文的方法：

```
return B.call(this); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T13:48:46.813

伴随Pointy的正确答案：

这样做的原因是因为你可以用函数做任何你想做的事情。您可以从函数 A 返回函数 B，并将其保存为全局变量。

或者，您可以将函数 B 作为方法附加到一个对象或十几个对象。或者您可以在 AJAX 回调中使用它，或者将其用作来自计时器的回调。

因为引擎不知道函数 B 会发生什么，所以语言说它`this`指的是函数被调用的任何时间，在它被调用的时候。

这为语言增加了很多活力，但也增加了很多麻烦，如果您不确定“this”在任何给定时间指向什么。

经验法则：

如果函数作为对象的方法***直接***附加，或者函数被使用`.call`or调用`.apply`并被提供上下文，例如`myFunc.call(myObj)`，则`this`指`window`.

# html - 之内

> ID：11816813
> 
> 赞同：4
> 
> 时间：2012-08-05T13:25:47.860
> 
> 标签：html, xhtml, hyperlink, xhtml-transitional

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-05T14:07:07.060

你可以使用`display:block`.

一个例子如下：

HTML：

```
<a href="#" class="btn"​​​​​​​​​​​​​​​​​​​​​&gt;Button</a>​​​​​​​​​​​​​ 
```

CSS：

```
​a.btn{
    display: block;
    background-color: Green;
    width: 50px;
    height: 25px;
    text-align: center;
    text-decoration: none;
    color: White;
}
a.btn:hover{
    background-color: lightGreen;
    color: Black;
} 
```

​ 你可以在这里现场测试：http: [//jsfiddle.net/YdCzY/](http://jsfiddle.net/YdCzY/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:39:24.993

尝试使用这个：

**HTML：**

```
<a id="block-a" href="#">Something here</a> 
```

**CSS：**

```
#block-a {
    display: block;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-29T02:02:30.923

您可以尝试在“a”元素中使用“span”元素而不是 div...

您可以将样式应用于跨度，使其表现得就像您想要的 div 一样（例如，丰富的内容也总体上是一个链接）。

AFAICS，span 和 div 之间的唯一区别是默认样式，以及它们被允许作为子元素的元素。但我愿意被更多有学问的贡献者纠正......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T13:29:46.660

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-09T09:02:21.650

至少更容易

```
`<div onclik="window.location.href='url'">
</div>` 
```

# php - PHP flush() 显然适用于我的 Linux 机器，但不适用于我的 Windows 机器？

> ID：11816815
> 
> 赞同：8
> 
> 时间：2012-08-05T13:25:49.687
> 
> 标签：php, http, browser, buffer

我正在尝试熟悉我正在做的一个项目的 PHP 的 flush() 函数，我自己编写了一些脚本，并将它们上传到我拥有的一些网络空间；但似乎它们都不起作用。我从 PHP.net 上的评论中选择了下面的一个并尝试了它：

```
<?php
header( 'Content-type: text/html; charset=utf-8' );

echo 'Begin ...<br />';
for( $i = 0 ; $i < 10 ; $i++ )
{
    echo $i . '<br />';
    flush();
    sleep(1);
}
echo 'End ...<br />'; 
```

显然脚本仍然不起作用。

然后我读了一条评论说：

> 如果您调用 ob_flush() 和 flush() 并且仍然没有刷新缓冲区，这可能是因为某些防病毒软件（在这种情况下为 Panda）会保留缓冲区，直到页面完成加载后再将其发送到浏览器。

所以我决定在我使用 Linux（Ubuntu 12.04）的机器上请求该网页，因为它没有安装任何防病毒软件；它工作得很好！

不知道是不是和杀毒软件有关？或者 Windows 中阻止 flush() 实现其预期目的的其他一些奇怪机制，我在两台机器上使用相同的浏览器（Firefox 14.0.1）所以我怀疑它可能是这样的。

所以我想我真正的问题是：有没有人知道防病毒软件阻止 flush() 实现其预期目的（因为我似乎无法在网上找到任何关于它的信息）？如果是这样，有什么办法可以绕过它？

编辑：澄清一下，我很肯定这不是服务器端，我有一个运行 Linux 的外部 Web 服务器，我没有在 Linux 或 Windows 机器上本地托管这些脚本。

EDIT2：我在 Linux 笔记本电脑上的一个朋友家中尝试了这个，我设法让它在我家工作，奇怪的是刷新代码在他们家也没有工作（相反，它只需要很长时间才能加载并且所有都出来了一次）这很奇怪，因为它可以在我家的这台笔记本电脑上运行，我不确定路由器是否与 flush() 函数的工作有关（我真的在网上找不到任何关于此的内容），因为那是我唯一能想到的可能会干扰它。

否则我试图自己解决这个问题没有任何进展，这绝对与服务器端无关，这很奇怪，因为我似乎找到的大多数信息都在谈论服务器是 flush() 时的问题功能不工作：/

巧合的是，我也在我家的一台运行 Norton（而不是 AVG）的 PC 上尝试了这个，它可以工作，但不是 100%。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:36:05.027

有几件事会阻止输出立即显示，包括：

*   从 PHP 中缓冲（这是`flush`阻止的）
*   缓冲以积累足够的数据进行压缩（启用压缩时）
*   在 Web 服务器上缓冲（它可能出于任何原因决定这样做）
*   浏览器内部的缓冲（浏览器使用各种技术，以便最终用户“感觉很快”页面加载；这些技术包括不总是在内容可用时立即显示）

由于`flush`无法控制此列表中的所有内容，因此无法保证您的程序会按照您的预期运行。

所有这些都在注释中提到`flush`：

> 刷新 PHP 的写入缓冲区以及 PHP 正在使用的任何后端（CGI、Web 服务器等）。这试图将当前输出一直推送到浏览器，但有一些警告。
> 
> flush() 可能无法覆盖 Web 服务器的缓冲方案，并且它对浏览器中的任何客户端缓冲都没有影响。它也不会影响 PHP 的用户空间输出缓冲机制。这意味着如果您正在使用 ob_flush() 和 flush() 来刷新 ob 输出缓冲区，则必须调用它们。
> 
> 一些服务器，特别是在 Win32 上，仍然会缓冲脚本的输出，直到它在将结果传输到浏览器之前终止。
> 
> Apache 的服务器模块（如 mod_gzip）可能会自己进行缓冲，这将导致 flush() 不会导致数据立即发送到客户端。
> 
> 甚至浏览器也可以在显示之前缓冲它的输入。例如，Netscape 会缓冲文本，直到它接收到行尾或标记的开头，并且在看到最外层表格的标记之前不会呈现表格。
> 
> 某些版本的 Microsoft Internet Explorer 仅在收到 256 字节的输出后才开始显示页面，因此您可能需要在刷新之前发送额外的空格以使这些浏览器显示页面。

# ruby-on-rails - Rails 3.2 中的 Rspec 错误（弃用警告）

> ID：11816817
> 
> 赞同：0
> 
> 时间：2012-08-05T13:26:26.573
> 
> 标签：ruby-on-rails, ckeditor, ruby-on-rails-3.2, autotest

我正在开始自动测试'rspec = true autotest'并且我有错误（rake db:test:prepare 已执行）：

弃用警告：不推荐调用 set_table_name。请`self.table_name = 'the_name'`改用。（从包含在 /my_project_name/app/models/ckeditor/asset.rb:2 调用）

弃用警告：Factory.define 已弃用；使用 FactoryGirl.define 块语法来声明您的工厂。（从 /my_project_name/spec/factories.rb:2 调用）

弃用警告：Factory.define 已弃用；使用 FactoryGirl.define 块语法来声明您的工厂。（从 /my_project_name/spec/factories.rb:9 调用）/usr/local/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in ` require': 无法加载此类文件 -- capybara/rspec (LoadError)

我的宝石文件：

```
source 'https://rubygems.org'

gem 'rails', '3.2.6'
gem 'pg', '0.14.0' # БД
gem 'therubyracer', '0.10.1' 
gem 'jquery-rails', '2.0.2'

gem 'paperclip', '3.1.2'
gem 'ckeditor', '3.6.3'

group :assets do
  gem 'sass-rails',   '3.2.5' 
  gem 'coffee-rails', '~> 3.2.2'
  gem 'uglifier', '>= 1.2.6' 
end

group :development do
  gem 'rspec-rails', '2.11.0' 
  gem 'annotate', '2.4.0' 
end

group :test do
  gem 'rspec-rails', '2.11.0'   
  gem 'factory_girl_rails', '3.5.0' 
end 
```

怎么了？它适用于rails 3.1！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:30:48.547

第一个是由 rails 发出的弃用消息。我记得它是在 3.2 中引入的。按照指示进行编辑。

后两个是 FactoryGirls 发出的消息，而不是 rails。我猜你也从旧版本更新了它。要消除错误，只需按照指示编辑您的项目文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T15:55:02.953

解决了！我刚刚升级到最新版本的 gem Ckeditor

# css - 在 twitter bootstrap navbar 上放置徽标而不调整导航栏的大小

> ID：11816819
> 
> 赞同：16
> 
> 时间：2012-08-05T13:26:29.257
> 
> 标签：css, twitter-bootstrap

有没有办法在引导程序的导航栏上放置图像（品牌标志），例如：

```
<div class="navbar navbar-fixed-top">
<div class="navbar-inner">
    <div class="container">
        <a class="brand" href="#"><img src="../Content/Images/logo.png" /></a>
    </div>
</div>
</div> 
```

并保持导航栏高度不变？我试过

```
.navbar .brand
{
display: block;
height: 125px;
width: 246px;
padding: 0;
background: url('../Content/Images/logo.png') no-repeat left center;
float:left;
position: absolute;
} 
```

而且我的定位效果很好，但是链接来自徽标。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-05T16:46:00.407

> 链接来自徽标

这是由绝对定位引起的。

**更新**而不调整图像大小：

```
.navbar .brand {
    max-height: 40px;
    overflow: visible;
    padding-top: 0;
    padding-bottom: 0;
} 
```

[无需调整图像大小的演示（jsfiddle）](http://jsfiddle.net/Sherbrow/MMdrJ/2/)

# pjax - popState 和动画 - pjax

> ID：11816822
> 
> 赞同：1
> 
> 时间：2012-08-05T13:27:04.030
> 
> 标签：pjax, popstate

我有一个 div 滑出屏幕，加载新内​​容并滑回。我使用 jquery pjax，那部分效果很好：

```
$('#menu a').on('click', function(event){

  event.preventDefault();

  var target = $(this).attr('href');

  $('li.current').removeClass("current");
  $(this).parent().addClass("current");

  $(content).transition({left:$(document).width()}, 900, 'out', function() {

    $.pjax({
      url: target,
      container: '#content',
      fragment: '#content',
      success: function(){
        $(content).transition({ left:'0px'}, 900, 'out');

        var contentHeight = $('#content').outerHeight(true)+258+$("#footer").outerHeight(true);

        if(contentHeight<parseInt($("body").css("min-height"))){
          contentHeight = "100%";
        }

        $(page).stop(true).animate({height:contentHeight}, 1000, "easeOutCubic");
      }
    });

  });

}); 
```

但是，如果使用浏览器的后退/前进按钮，我将无法正常工作。我尝试了不同的东西。在这里我找到了一篇不错的文章，但我不明白：[http ://artfindertech.wordpress.com/tag/historyapi/](http://artfindertech.wordpress.com/tag/historyapi/)

问题是 div 的内容会在您单击浏览器后退按钮的那一刻发生变化。然后它滑出但不回来。此外，网址会在一秒钟内更改为上一页，但会跳转到网站的主网址。这是我对 popState 的试用：

```
$(window).on('pjax:popstate', function() {

  $(content).transition({left:$(document).width()}, 900, 'out', function() {

    $.pjax({
      container: '#content',
      fragment: '#content',
      success: function(){
        $(content).transition({ left:'0px'}, 900, 'out');

        var contentHeight = $('#content').outerHeight(true)+258+$("#footer").outerHeight(true);

        if(contentHeight<parseInt($("body").css("min-height"))){
          contentHeight = "100%";
        }

        $(page).stop(true).animate({height:contentHeight}, 2000, "easeOutCubic");
      }
    });

  });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-20T18:01:04.477

我现在正在尝试做同样的事情，即在popstate 上获得动画功能。我现在看到的方式是：

1.  在菜单上单击调用一个函数，该函数将为内容设置动画并填充容器的新内容 -

    ```
    功能动画（PageTitle，PageLink，检查）{
        //检查是否是来自菜单的调用，如果不是
        //关于动画和ajax完成调用
        如果（检查）{
            setHistory(PageTitle,PageLink); // 单独的函数来独立调用它
        }
    }

    ```

2.  如上所述，动画完成后，如果是来自菜单链接的调用，则调用有关 window.history.pushState 的函数 -

    ```
    功能 setHistory(PageTitle,PageLink) {
        window.history.pushState({'ptitle':PageTitle,'plink':PageLink}, PageTitle, PageLink);
    }

    ```

3.  之后设置一个 onpopstatee 函数来调用该函数到反向动画和 ajax -

    ```
    window.onpopstate = 函数（事件）{
        动画(event.state.ptitle,event.state.plink,false);
    }

    ```

我还没有测试它，但我现在正在实施它。如果它会工作，我会更新这个......

**更新：**

只是为了更新它并告诉它它就像我认为的那样是一种魅力。还有一件事，它可能与谁有关...我发现您必须在原始页面加载时调用**history.replacestate**才能有可能返回到具有相关变量和动画的原始页面。

# ruby-on-rails - 使用 Ransack 搜索标签

> ID：11816826
> 
> 赞同：5
> 
> 时间：2012-08-05T13:27:32.760
> 
> 标签：ruby-on-rails, activerecord, ransack

我正在使用 Ransack 通过一些模型执行相当复杂的搜索。其中一个模型包含自由文本并使用acts_as_taggable gem 来标记单词。

我正在尝试创建这些单词的集合选择器，以便 ransack 可以从用户可以定义的标签子集中找到任何全文记录。

这让我几乎到了那里，但如果我尝试选择多个单词，它不会返回任何结果！

```
= f.select :note_in, @freetexts.tag_counts_on(:tags), {}, {:multiple => true} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-18T06:12:21.330

Ransack 并不真正面向复杂的搜索。很有可能，如果您对搜查的压力足够大，那么您最终会遇到一个比您在哪里进行复杂选择时更难的问题。

对于复杂搜索，我会推荐 Sequel，来自 ransack 的同一作者，并且更适合复杂搜索。

此外，根据他们的线程，您处于死胡同： [Ransack and act-as-taggable-on issues](https://stackoverflow.com/questions/19421508/ransack-and-acts-as-taggable-on-issues)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-28T17:23:31.980

我根本不是专家，但是这种非洗劫解决方案可以适用于那些需要通过带有acts-as-taggable-on gem 的标签进行过滤的人：

```
@search = MyModel.ransack(params[:q])
@result = @search.result(distinct: true).includes(:related_model)
@result = @result.tagged_with(params[:tags].split(/\s*,\s*/)) if params[:tags].present?
@result = @result.paginate(page: params[:page], per_page: 20) 
```

这需要一个超出 Ransack 范围的新 :tags 参数。您可以使用过滤掉 Ransack 给您的结果。

# java - Eclipse 警告：fmt:formatDate 和 html:hidden 必须为空

> ID：11816827
> 
> 赞同：0
> 
> 时间：2012-08-05T13:27:49.047
> 
> 标签：java, eclipse, jsp, jstl, struts-1

我正在对日期进行一些操作。它工作正常。但是 eclipse 会显示警告，例如`<fmt:formatDate> and <html:hidden> must be empty`. 我尝试重写这个结构，但没有任何改变。我使用这些库。

以下是我的代码：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>

<c:set var="date_str">    
    <fmt:formatDate value="${myForm.itemShop.date}">
        <jsp:attribute name="pattern">
            <bean:message key="date.pattern" />
        </jsp:attribute>
    </fmt:formatDate>
</c:set>

<html:hidden property="datePattern">
    <jsp:attribute name="value">
        <bean:message key="date.pattern" />
    </jsp:attribute>
</html:hidden> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T10:30:41.920

警告是由于为 tag`TLD`指定的。`<body-content>empty<body-content>``formatDate`

这意味着标签的`body-content`应该为空。`formatDate`这是此标签的[文档链接](http://docs.oracle.com/cd/E17802_01/products/products/jsp/jstl/1.1/docs/tlddocs/index.html)。

我认为您可以放心地忽略这些警告。

# c++ - 无法在 VC++ 中从 NASM 调用 c 函数，除了 main，出现链接错误

> ID：11816829
> 
> 赞同：0
> 
> 时间：2012-08-05T13:28:05.817
> 
> 标签：c++, visual-studio-2008, visual-c++, linker, nasm

谁能告诉我为什么我不能从 NASM 调用任何全局函数，**除了**main ？（在你问之前）是的，我已经在 stackoverflow 和互联网上阅读了所有关于此的问题大约 8 小时。

**C++ 代码。**

```
void main();

extern "C" void nasm_function(void);

void c_function()
{
}

void main()
{
    nasm_function();

    system("pause");
} 
```

**NASM 代码，**

```
extern _c_function
extern _main

segment .text

global _nasm_function
_nasm_function:
call _main  
call _c_function 
```

**输出，**

> 1>链接... 1>my_asm.obj : 错误 LNK2001: 无法解析的外部符号 _c_function 1>F:\Projects\OSDev\assmebly_test\Debug\project.exe : 致命错误 LNK1120: 1 无法解析的外部

如您所见，我们没有得到 main 的链接错误。我不知道为什么。:)

**设置，**

```
building nasm using custom-build-rules with nasm.exe -f win32 
Calling convention is __cdecl (/Gd)
Visual Studio 2008
NASM version 2.05
Didn't include my_asm.obj as a input to linker 
```

任何人请告诉我是什么问题？提前致谢。（请注意，这是一个示例程序，但仍然存在问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:32:58.347

问题是*名称修饰*。解决办法是`extern "C"`。

# reporting-services - 在 rdlc 2010 中从下到上垂直显示文本

> ID：11816830
> 
> 赞同：5
> 
> 时间：2012-08-05T13:28:22.010
> 
> 标签：reporting-services, rdlc

我想在 ssrs 2010 的列标题中显示文本，如下图所示。我能够垂直显示文本，但它会从上到下显示文本。

![在此处输入图像描述](../Images/23e39885eaab279744be79a506713a5e.png)

我正在使用 Visual Studio 2010 和本地报告（RDLC 文件）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-05T19:37:12.573

2008 及更早版本没有此功能，请参阅[此 Microsoft Connect 问题](https://connect.microsoft.com/SQLServer/feedback/details/473442)。

对于 SSRS 2008-R2，您应该能够做到这一点，来自[MSDN 教程](http://msdn.microsoft.com/en-us/library/ee633659%28v=sql.105%29.aspx)：

> 1.  创建新报告或打开现有报告。
> 2.  如果“属性”窗格未打开，请单击“查看”选项卡并选中“属性”复选框。
> 3.  单击要更改其文本方向的文本框。
> 4.  在“属性”窗格中找到 WritingMode 属性，然后在下拉列表中选择要应用于文本框的文本方向。
>     *注意*：当“属性”窗格中的属性按类别组织时，WritingMode 位于“本地化”类别中。
> 5.  在列表框中，选择水平、垂直或 Rotate270。

该`Rotate270`值是您正在寻找的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-13T14:10:54.877

尽管 Jeroen 在他的声明中是正确的，即如果不使用 是不可能的`Rotate 270`，但如果您只想显示一个静态单词（如“类别”？），您可以执行以下方法。不幸的是，对于那些想要以`<<Expr>>`这种格式显示的人来说，这种方法显然是行不通的。

对于我们这些没有此功能但仍想实现它的人，我所做的是：

1.  创建我想在 Microsoft Word 中使用的文本/文本框，并将其旋转到我想在报告中使用的方向
2.  截取屏幕截图，使用截图工具进行截图，无论您想要获取文本/文本框的图像

3.  使用工具箱，将片段插入到您的报告中

这在视觉上看起来像是成功了。

@Liquid Core 对您的评论，我不确定您是如何找到这些选项的。

# php - 使用 url manager yii php 调整自定义 url

> ID：11816832
> 
> 赞同：0
> 
> 时间：2012-08-05T13:28:34.430
> 
> 标签：php, yii

我有像这样的网址

```
localhost/abc.com/info/c/q/Best%20Men 
```

这里 info 是控制器，c 是 action，q 是查询 id。

我想通过删除 c/q/ 并使用非空格 url 来动态重写这些 url。比如像这样

```
localhost/abc.com/info/Best_Men 
```

可以使用urmanager吗？？？

我试过这段代码，但它没有用

```
'info/c/<q:\d+>'=>'info/<q:\d+>', 
```

[编辑后]

我的配置包含这个

```
'urlManager'=>array(

    'urlFormat'=>'path',
'showScriptName'=>false,
 'caseSensitive'=>false,
    'urlSuffix'=>'.html',    

        'urlFormat'=>'path',
        'rules'=>array(

            'info/<q:\w+>' => 'info/c'

                ),
    ), 
```

这里有更多解释是什么是我的网址

```
http://localhost/abc.com/mycontroller/myactionsearch?q=Best 
```

它返回我搜索项目的列表，并单击它打开的任何链接，例如单击最好的男人打开下面的链接

```
http://localhost/abc.com/mycontroller/myactionItem/q/Best%20Men 
```

所以实际上我在同一个控制器中有两个不同的动作，现在我想让它像

```
http://localhost/abc.com/mycontroller/Best%20Men 
```

或者

```
http://localhost/abc.com/mycontroller/myactionItem/Best%20Men 
```

但它使用上面的配置给出了找不到页面的错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:43:13.380

这条路线是错误的有几个原因：

*   它与特定查询不匹配（`\d`表示“数字”，因此不会匹配“Best_Men”）
*   它不会转发到有效的控制器操作
*   这对值应该切换

而不是这个，你想要更相似的东西

```
'info/<q:\w+>' => 'info/c' 
```

# php - 即使在测试表单中工作正常，也无法调用 Web 服务功能

> ID：11816833
> 
> 赞同：0
> 
> 时间：2012-08-05T13:28:49.637
> 
> 标签：php, soap

我正在制作一个 php/c# 控制台应用程序/c#soap 服务，并且我在 Web 服务中创建了许多函数，但我无法调用其中一个。

我正在调用的函数是一个从数据库中获取字符串值的函数。该调用在 Windows 上运行良好（使用 localhost），但是当将它放到在单声道下运行的 Linux 服务器上时，我得到一个异常，说明如下：

> 函数（“getLastResetTime”）不是此服务的有效方法

奇怪的是，从 Linux 服务器我可以通过转到 asmx 文件并运行 getLastResetTime 函数来访问测试表单，它返回了预期的内容，这似乎是 PHP 无法进行调用。

下面是我在 PHP 中用来调用脚本的代码

```
function getLastResetTime()
{
    include ("../../config.php");
    include ("../../includes/get-settings.php");
    include ("../../includes/general.php");
    try
    {
    $client = new SoapClient("http://192.168.1.74/EmailServer/EmailSoapService/EmailSoapService.asmx?WSDL", array("trace" => 1, "exception" => 0));
    $result = $client->__soapCall("getLastResetTime", array());

    echo "Last Reset: " . $result->getLastResetTimeResult;
    }
    catch (Exception $e)
    {
        echo $e->getMessage();
    }
} 
```

下面的截图证明了 web 方法在 Mono 下工作以及它返回的内容

![在此处输入图像描述](../Images/154e7dcc91e17608ea36b81ba8a8c657.png)

下面是网络服务功能的代码

```
[WebMethod(Description = "Gets the time the Email Server last reset")]
public string getLastResetTime()
{
    SoapHandler soapHandler = new SoapHandler();
    return soapHandler.getLastResetTime();
} 
```

以下是 Web 服务调用的代码

```
public string getLastResetTime()
{
    try
    {
        using (ConnectDb db = new ConnectDb(appSettings))
        {
            string query = "SELECT * FROM settings";
            using (MySqlCommand cmd = new MySqlCommand(query, db.conn))
            {
                using (MySqlDataReader reader = cmd.ExecuteReader())
                {
                    while (reader.Read())
                    {
                        if (reader.GetString("setting") == "app_lastRestart")
                        {
                            return reader.GetString("value");
                        }
                    }
                }
            }
        }
        return "N/A";
    }
    catch (MySqlException ex)
    {
        return ex.Message;
    }
} 
```

我不明白为什么这不起作用，我猜我可能错过了一些非常简单但找不到的东西。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:48:02.677

我刚刚找到原因，但我不明白为什么这不会影响方法。

基本上，我将 WSDL 设置为服务器的 IP 地址（即使它是服务器本地的），所以我输入了`http://192.168.1.74/MySoapService.asmx`但是如果我将其更改为`http://localhost/MySoapService.asmx`它可以正常工作。

为什么我需要将其设置为 localhost 而不是 IP 地址才能使这些服务正常工作。

是不是因为我一个接一个地运行了几个肥皂请求，所以浏览器正在停止它，我在尝试解决问题时确实注意到 Chrome 表示它正在节流，如果这是问题，那么我会本来以为连接会超时，不是说服务无效。

**更新** 我现在发现了为什么将 url 从 IP 更改为 localhost 解决了这个问题，我意识到另一个函数开始有同样的问题，后来意识到如果这个选项在 php.ini 中被禁用，php 默认缓存 wsdl。 ini 文件并重新启动 apache 服务器，然后它就可以正常工作了。在生产环境中可能非常有用，但在开发时有点痛苦。

# css - IE8中的圆角图像

> ID：11816835
> 
> 赞同：0
> 
> 时间：2012-08-05T13:28:54.067
> 
> 标签：css, image, internet-explorer-8, rounded-corners, css3pie

我有一些动态生成的图像：

```
<div class="image">
<?php echo "<img class='logo_client' src='img/clients/".$row['logo_name'].".jpg''>"; ?>
</div> 
```

而且我希望它们具有圆角，以便在我的 CSS 中放置：

```
.image {
padding: 0;
width: 100px;
height: 100px;
overflow: hidden;
-webkit-border-radius: 10px;
-moz-border-radius: 10px;
-o-border-radius: 10px; 
border-radius: 10px;    
behavior: url(css/PIE.php);
} 
```

我可以在 Firefox、Chrome 和 IE9 中看到圆角，但在 IE8 中不起作用。PIE 的东西已经与 IE8 中的其他元素一起使用。

有谁知道它可能是什么？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T09:32:29.313

最后，我使它与 CSS3 PIE 一起工作。圆角出现在 IE7、IE8 和所有其他浏览器中。这是一个编码错误，对不起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T14:39:12.850

我知道使圆角在 IE8 及以下版本中工作的唯一方法是使用如下代码：

```
<div class="image">
   <span class="tl"></span>
   <span class="tr"></span>
   <span class="br"></span>
   <span class="bl"></span>
</div> 
```

然后使用这样的 CSS：

```
.image { position: relative; }
.tl, .tr, .br, .bl { position: absolute; }
.tl { left: 0; top: 0; width: 20px; height: 20px; background: url(/images/tl.png) no-repeat top left; }
.tr { right: 0; top: 0; width: 20px; height: 20px; background: url(/images/tr.png) no-repeat top left; }
.br { right: 0; bottom: 0; width: 20px; height: 20px; background: url(/images/br.png) no-repeat top left; }
.bl { left: 0; bottom: 0; width: 20px; height: 20px; background: url(/images/bl.png) no-repeat top left; } 
```

其中背景图像是与该角对应的所有圆角图像，例如右下角背景图像可能如下所示：

![http://www.webcredible.co.uk/i/br2.gif](../Images/7d4557503dee8f3041864126ada97111.png)

所以一个（希望这是有道理的）

可能有更好的方法可以做到这一点，因为上述方法有点费力，而且不是特别干净。

话虽如此，我怀疑任何让圆角在 IE8 及更低版本中工作的方法都会特别“干净”。我通常只保留 IE8 及以下不带圆角的浏览器，与其他浏览器相比，甚至没有多少人使用 7 和 8。

编辑：

如果我是你，我会避开像这样的代码“行为：url（css/PIE.php）；” 其他浏览器不支持 IE 行为，我认为甚至微软都放弃了它们。

# java - 任何可以在 ANSI x12 和 UN/EDIFACT 标准中解析 EDI 文件的开源 Java 库？

> ID：11816836
> 
> 赞同：5
> 
> 时间：2012-08-05T13:29:17.940
> 
> 标签：java, jakarta-ee, java-ee-6, java-ee-5, edi

是否有任何开源 java 库可以解析**ANSI X12**和**UN/EDIFACT**标准中的 EDI 文件？我找到了支持 UN/EDIFACT 标准的**smooks** (http://www.smooks.org)，但不确定这是否支持 ANSI X12 标准中的 EDI 文件。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T19:41:47.060

Smooks 团队发布他们未来的版本将开始支持 X12 版本。我也在这里热切等待。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T13:25:48.020

根据文档[，EDIReader](http://edireader.sourceforge.net/)可以解析 ANSI X12 和 UN/EDIFACT。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T18:11:24.810

我已经成功使用了 X12 Java 解析器。这是链接[http://code.google.com/p/x12-parser/source/checkout](http://code.google.com/p/x12-parser/source/checkout)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-03T11:43:50.610

您可能希望查看[StAEDI](https://github.com/xlate/staedi)，这是一个支持 X12 和 EDIFACT 并带有模式验证的流解析器/生成器。免责声明：我是图书馆的作者。

# c# - SignalR 实时通知未在客户端上持续存在

> ID：11816838
> 
> 赞同：3
> 
> 时间：2012-08-05T13:29:31.497
> 
> 标签：c#, jquery, asp.net, signalr, signalr-hub

我正在尝试实现一个功能，其中用户上传文件，服务器处理文件并向客户端显示有关处理状态的实时通知，例如验证、导入等。有一些示例客户端将数据从文本框发送到 javascript 代理.

```
 $("#btnTest").click(function () {
                myHub.testMethodOnHub($("#txtEmail").val());
            }); 
```

我需要通过 signalR 将二进制数据发送到服务器，以便服务器可以处理该数据并使用 SignalR 通知客户端。

编辑：- 我能够从 aspx.cs 调用 JS 方法来设置客户端状态 - 实时。但是，页面加载完成后，该消息会消失。

我尝试过的：-

**ASPX：-**

```
<%@ Page Title="Home Page" Language="C#" AutoEventWireup="true"
    CodeBehind="Default.aspx.cs" Inherits="MultipleStepsUsingSignalR._Default" %>

<script src="Scripts/jquery-1.6.4.js" type="text/javascript"></script>
<script src="Scripts/json2.js" type="text/javascript"></script>
<script src="Scripts/jquery.signalR-0.5.2.js" type="text/javascript"></script>
<script src="signalr/hubs" type="text/javascript"></script>
<body>

    <form id="Form1" runat="server">
    <p>
        <asp:FileUpload ID="fileUpload" runat="server" />
        <asp:Button ID="btnProcessFile" runat="server" Text="Process File" 
            onclick="btnProcessFile_Click" />
        <asp:HiddenField ID="hdnConnectionId" runat="server"/>
        <%--<asp:Label Text="" ID="lblStatus" runat="server" />--%>
        <span id="lblStatus"></span>
    </p>

  </form>
    <script type="text/javascript">
        $(document).ready(function () {
            var multipleStepsHub = $.connection.multipleStepsHub;

            multipleStepsHub.MethodInJavascript = function (status) {
                $('#lblStatus').append(status);
            };

            $.connection.hub.start().done(function () {
                $('#<%= hdnConnectionId.ClientID %>').val($.connection.hub.id);
                alert($('#lblStatus').text());
            });
        });
    </script>
  </body> 
```

**中心**

```
[HubName("multipleStepsHub")]
    public class MultipleStepsHub : Hub
    {
        public void ExecuteMultipleSteps(string status)
        { 

        }
    } 
```

**aspx 的代码隐藏**

```
 protected void btnProcessFile_Click(object sender, EventArgs e)
        {
            string connectionId = hdnConnectionId.Value;
            var context = GlobalHost.ConnectionManager.GetHubContext<MultipleStepsHub>();

            byte[] dataFromPostedFile = GetDataFromUploadedFile(fileUpload.PostedFile.InputStream);
            context.Clients[connectionId].MethodInJavascript("<br>File updloaded.");
            Thread.Sleep(5000);
            context.Clients[connectionId].MethodInJavascript("<br>Processing step1");
            Thread.Sleep(5000);
            context.Clients[connectionId].MethodInJavascript("<br>Processing step2");
            Thread.Sleep(5000);
            context.Clients[connectionId].MethodInJavascript("<br>Processing step3");

        } 
```

**我期望什么：-** 状态文本更改为“处理步骤 1”，然后是“处理步骤 2”，然后是“处理步骤 3”

**结果是什么**：-

a) 状态会定期发生变化（在 Thread.Sleep 之后），但是，当页面完成时，状态会消失。正如您在下面注意到的那样，“处理步骤 1”和“处理步骤 2”确实出现了，但后来消失了。

![在此处输入图像描述](../Images/7639651c2e12159b7f2d74cb5ccc48e8.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T19:50:36.023

你的 JavaScript 方法有一个错误：

```
multipleStepsHub.MethodInJavascript = function (status) {
            ("#lblStatus").val(status);
}; 
```

应该

```
multipleStepsHub.MethodInJavascript = function (status) {
            $('#<%= lblStatus.ClientID %>').text(status);
}; 
```

请注意，[ASP.NET 会自动生成 HTML 元素标识符](http://msdn.microsoft.com/en-us/library/1d04y8ss.aspx)。

**编辑**：如果您不想在上传完成后重新加载页面，那么您需要异步上传文件。在 HTML5 中，[很容易实现](https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications). 有关如何执行此操作的另一个示例，请参阅[此问题](https://stackoverflow.com/questions/9589323/html5-asynchronous-file-upload-uploaded-stream-is-always-invalid)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T18:55:11.880

您不能将常规文件发送到集线器方法。您可以使用常规的 http 处理程序或 mvc 或任何其他框架来发布文件并使用信号器来显示更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-22T09:48:59.480

`protected void btnProcessFile_Click`是对服务器的完整回发，这意味着您正在重新加载页面，此时 SignalR 尚未（重新）加载。在页面加载完成后尝试使用 Ajax 请求。

# ruby-on-rails-3 - Model:Class with Formtastic 和 MongoMapper 的未定义方法“范围”

> ID：11816843
> 
> 赞同：0
> 
> 时间：2012-08-05T13:30:06.837
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2, formtastic, mongomapper

我很难让 MongoMapper 和 Formtastic 一起工作。

为了隔离问题，我用最少的代码创建了一个虚拟应用程序。

我有 2 个主要模型（机柜和设备），它们之间具有“many/belongs_to”关系以及机柜资源的脚手架控制器。

当我加载一个非常基本的formtastic表单（见下文）时，除了简单的“key”字段声明之外，我在控制器中得到一个“NoMethodError”异常，并出现以下错误“未定义的方法`scoped' for Device:Class”参考 _form.html.haml 部分的第 4 行。

对这个有任何想法吗？没有通过 Google 或 StackOverflow 找到任何有用的东西......

应用程序/模型/cabinet.rb

```
 class Cabinet
  include MongoMapper::Document
  safe

  key :label, String, :required => true
  many :devices
end 
```

应用程序/模型/设备.rb

```
class Device
  include MongoMapper::Document
  safe

  key :label, String, :required => true
  belongs_to :cabinet
end 
```

应用程序/视图/内阁/_form.html.haml

```
= semantic_form_for @cabinet do |f|
  = f.inputs do
    = f.input :label
    = f.input :devices
  = f.actions 
```

我没有包括脚手架控制器，因为我没有以任何方式接触脚手架代码。

使用的宝石版本：

```
Gems included by the bundle:
  * actionmailer (3.2.7)
  * actionpack (3.2.7)
  * activemodel (3.2.7)
  * activerecord (3.2.7)
  * activeresource (3.2.7)
  * activesupport (3.2.7)
  * arel (3.0.2)
  * bson (1.6.4)
  * bson_ext (1.6.4)
  * builder (3.0.0)
  * bundler (1.1.5)
  * coffee-rails (3.2.2)
  * coffee-script (2.2.0)
  * coffee-script-source (1.3.3)
  * erubis (2.7.0)
  * execjs (1.4.0)
  * formtastic (2.2.1)
  * haml (3.1.6)
  * haml-rails (0.3.4)
  * hike (1.2.1)
  * hpricot (0.8.6)
  * i18n (0.6.0)
  * journey (1.0.4)
  * jquery-rails (2.0.2)
  * json (1.7.4)
  * libv8 (3.3.10.4)
  * mail (2.4.4)
  * mime-types (1.19)
  * mongo (1.6.4)
  * mongo_mapper (0.11.2)
  * multi_json (1.3.6)
  * plucky (0.5.1)
  * polyglot (0.3.3)
  * rack (1.4.1)
  * rack-cache (1.2)
  * rack-ssl (1.3.2)
  * rack-test (0.6.1)
  * rails (3.2.7)
  * railties (3.2.7)
  * rake (0.9.2.2)
  * rdoc (3.12)
  * ruby_parser (2.3.1)
  * sass (3.1.20)
  * sass-rails (3.2.5)
  * sexp_processor (3.2.0)
  * sprockets (2.1.3)
  * therubyracer (0.10.1)
  * thor (0.15.4)
  * tilt (1.3.3)
  * treetop (1.4.10)
  * tzinfo (0.3.33)
  * uglifier (1.2.7) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T10:13:52.240

mongomapper 没有“作用域”类方法。这是 ActiveRecord 和 Mongoid 的一个特性。

# python - “'NoneType' 类型的对象没有 len()”错误

> ID：11816844
> 
> 赞同：19
> 
> 时间：2012-08-05T13:30:22.523
> 
> 标签：python, web2py

我在这段代码中看到了奇怪的行为：

```
images = dict(cover=[],second_row=[],additional_rows=[])

for pic in pictures:
    if len(images['cover']) == 0:
        images['cover'] = pic.path_thumb_l
    elif len(images['second_row']) < 3:
        images['second_row'].append(pic.path_thumb_m)
    else:
        images['additional_rows'].append(pic.path_thumb_s) 
```

我的 web2py 应用程序给了我这个错误：

> ```
> if len(images['cover']) == 0:
> TypeError: object of type 'NoneType' has no len() 
> ```

我无法弄清楚这有什么问题。也许一些范围问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-05T13:33:01.427

你分配一些新的东西给`images['cover']`：

```
images['cover'] = pic.path_thumb_l 
```

在您的代码`pic.path_thumb_l`中`None`的某个位置。

您可能打算改为附加：

```
images['cover'].append(pic.path_thumb_l) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-05T13:35:39.307

你的问题是

`if len(images['cover']) == 0:`

检查 images['cover'] 值的长度你的意思是检查它是否有一个值。

改为这样做：

`if not images['cover']:`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:00:41.917

第一次分配:`images['cover'] = pic.path_thumb_l`时，它会将最初存储的空列表的值替换为is`images['cover']`的值。`pic.path_thumb_l``None`

也许你在这一行的代码必须是`images['cover'].append(pic.path_thumb_l)`

# java - 清除 Swing 组件值

> ID：11816848
> 
> 赞同：2
> 
> 时间：2012-08-05T13:30:51.867
> 
> 标签：java, swing, jtextfield, jtextcomponent

是否有一种方法可以清除 Swing 组件的值。例如，如果我们每次想要清除 JTextField 时都使用它，我必须调用 - `txtField.setText("")`。我曾经为这些类型的案例制作了一个实用方法 -

```
public static void clearFields(JComponent[] components) {
        for (int i = 0; i < components.length; i++) {
            JTextComponent jComponent = (JTextComponent) components[i];
            jComponent.setText("");
        }
    } 
```

我想知道 Swing API 本身是否有更好的方法。或者是否有办法刷新 JPanel 中的所有值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T13:45:32.617

有两种方法

1.  您的方式没有问题，但我建议您进行测试`if (c instanceof JTextField) {`，然后您可以在一个循环中为不同`JComponents`（或它们的组）重新设置（也不同）值

2.  把期望放在`JComponents`某种类型的`array`or `map`,

3.  注意删除（如果存在）`Document`或`DocumentListener`从`JTextComponent`之前的所有内容中删除，然后在重新设置值之后，循环结束，然后将需要的侦听器添加回`JTextComponent`，以避免触发递归事件...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T13:33:24.423

不，这是正确的做法，我不认为以这种方式清除它们的不利之处。

我正在考虑的唯一替代方法是通过实例化新的 UI 组件并重新布局它们来重新创建 GUI，但这似乎有点矫枉过正，它也会让你失去对旧组件的所有引用。

# android - android ics褪色边缘不起作用

> ID：11816849
> 
> 赞同：12
> 
> 时间：2012-08-05T13:31:02.193
> 
> 标签：android, layout

以某种方式褪色的边缘似乎不适用于 android ics (android 4+) 对于自己的视图。如果我在较低的 android 版本上测试此布局，它会绘制褪色边缘，但不会在 android 4.1 上。

```
<FrameLayout
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"
    android:fadingEdge="vertical"
    android:focusableInTouchMode="true" <-- does not make any change
    android:focusable="true"           <--
/> 
```

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-27T15:57:28.923

“使用褪色边缘可能会导致明显的性能下降，并且应该仅在应用程序的视觉设计需要时使用。要请求 API 级别 14 及更高级别的褪色边缘，请改用该`android:requiresFadingEdge`属性”

[http://developer.android.com/reference/android/R.attr.html#fadingEdge](http://developer.android.com/reference/android/R.attr.html#fadingEdge)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-05T14:15:56.237

您可以从我的问题帖子中的答案中尝试一些想法：[在 Android 4.0.3 中设置 textview fading](https://stackoverflow.com/questions/9307644/set-textview-fading-in-android-4-0-3)

但是，似乎衰落的边缘在 4.x 上不起作用。之所以？我不知道。

# python - 使用 z3 python API 编码线性混合自动机

> ID：11816853
> 
> 赞同：0
> 
> 时间：2012-08-05T13:31:09.663
> 
> 标签：python, python-2.7, z3

我正在尝试将线性混合自动机编码为一阶公式的结合，如下所示：

```
s.add(Or(Or(And(off,Not(on),Not(S1),Not(S2),(10*x_next)>=(3*t1)-(3*t2)+(10*x),(10*x_next)<=(10*x)-(t2-t1),x_next>=18,(t2-t1)>0,Implies(),
And(Not(off),on,Not(S2),Not(S1),(10*x_next)>=(t2-t1)+(10*x),(5*x_next)<=(5*x)+(t2-t1),x_next<=22,(t2-t1)>0)),    
Or(And(x<19,(t2-t1)==0,S1,Not(off),Not(on),Not(S2),(x-x_next)==0),
And(x>21,(t2-t1)==0,Not(on),Not(off),S2,Not(S1),(x-x_next)==0)))) 
```

问题是需要采用跳转条件（例如，如果 x<19 则 ....），这似乎在这里不起作用。有人可以帮助我使用 z3 python API 将跳转条件编码为一阶公式的结合吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:00:51.613

寻找或构建一个可以从更高级别的描述中对 HA 公式进行编码的工具可能会很有用。他们可以帮助调试一些细节。比如你说有“开”和“关”两种模式。这些似乎被编码为命题变量。通常使用程序计数器来编码自动机的状态，因此例如会有一个程序计数器“状态”，其值可以是“开”或“关”。您可以使用 Z3 中的标量来编码状态变量的可能值，或者您可以使用整数或位向量，或者在这种情况下使用布尔标志。然后是编码转换关系的问题。您通常需要在不被转换改变的变量上编码帧条件。

# jquery - jQuery UI datepicker 在对话框中崩溃

> ID：11816854
> 
> 赞同：1
> 
> 时间：2012-08-05T13:31:11.587
> 
> 标签：jquery, ajax, jquery-ui

我正在使用 jQuery UI 和加载函数加载一个对话框页面：

```
$("#update_link").dialog({
  modal: false,
  height: 370,
  width: 900,
  title: 'עדכן קישור',
  open: function () {
    $(this).load("<?= site_url()?>/links/show_update?id="+rel+"&rand="+rand());
  }
}); 
```

在对话框内有一个 ID 为“add_time”的输入文本。在这个输入中有一个日期选择器：

```
$(".float_form[rel='<?=$id;?>'] #add_time").datepicker({
  showOn: "button",
  buttonImage: "<?=base_url()?>/images/icons/new.png",
  buttonImageOnly: true,
  onClose: function(dateText, inst) { alert("die"); }
}); 
```

当我运行它时，它第一次运行良好。然后我关闭对话框并更改打开对话框的链接（使用 Ajax）。如果我使用日期选择器再次单击输入文本，我会在控制台上收到此错误：

> 未捕获的类型错误：无法设置未定义的属性“currentDay”

由于此错误，我无法单击日期选择器中的任何日期。我究竟做错了什么？

对不起我的英语不好，谢谢你:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T09:53:31.227

我找到了一个解决方案：您所需要的只是`id="add_time"`更换`class="add_time"`

代码：

```
$(".add_time").datepicker(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T14:39:19.760

看来你搞砸了 datepicker，这里是例子：

```
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
<div id="dialog" style="display:none">

</div>
<button id="ds">dialog show</button>

<script>
$(function(){$('#ds').click(function() {
    var datep = $('<input type="text" id="datep">');
    datep.datepicker();
    var dlg = $('#dialog').dialog({
        modal: false,
        open: function() {
            var e = $(this);
            e.html('');
            e.append(datep);

            console.log(datep);
        },
        close: function() {
            datep.datepicker("destroy");
        }

    });
});
});
</script> 
```

[http://jsfiddle.net/K5ZWm/13/](http://jsfiddle.net/K5ZWm/13/)

道德：关闭对话框时使用desroy，而不是日期选择器。

# validation - 通过 ValidationAttribute 验证 WebApi 操作参数

> ID：11816855
> 
> 赞同：2
> 
> 时间：2012-08-05T13:31:46.097
> 
> 标签：validation, data-annotations, asp.net-web-api

WebAPI 可以处理动作参数上的 ValidationAttribute 吗？

例如：

```
public class SampleController : ApiController
{
   public string Get([RegularExpression("sampleExpression")]string id)
   {
      return "result";
   }
} 
```

在此示例中，WebAPI 不调用 RegularExpressionAttribute（或任何其他数据注释属性）的任何方法来验证输入参数。但是如果我们传递一个对象作为参数，例如一个类，那么 WebAPI 可以验证属性。

它是一个错误吗？还是我做错了什么？

UPD：这是一个未解决的问题： [http ://aspnetwebstack.codeplex.com/workitem/24?PendingVoteId=24](http://aspnetwebstack.codeplex.com/workitem/24?PendingVoteId=24)

有人可以提出解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T20:57:47.343

这是一个真正的问题，我很好奇为什么不这样做：

```
public class SampleController : ApiController
{
   public string Get(string id)
   {
      RegularExpressionHelper.ValidateWith("sampleExpression",id);

      return "result";
   }
} 
```

对我来说，这似乎同样简洁。验证发生时很明显。我可以放心地假设，如果验证失败，则会引发异常。我可以轻松地添加额外的验证，并对它们发生的顺序充满信心。

关于属性方法，我不知道验证是否被用作路由匹配的一部分，我不知道如果它失败了会发生什么。我不知道在验证之前或之后运行哪些过滤器。我敢肯定，如果我更了解 MVC，我会知道这些问题的答案，但我看不到使用使我的代码行为依赖于某些框架控制的基础设施的属性的优势。

我错过了一些重要的好处吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-27T23:10:28.863

我也有同样的疑问。我的解决方法是创建一个仅用于封装参数的类，因此我可以使用我想要的验证属性来装饰它。我可以使用 Darrel 在他的回答中提出的解决方法，但是我有一个过滤器可以在输入操作*之前检查 ModelState.IsValid 是否存在，因此我需要在执行操作之前进行验证。*

```
[ModelBinder]
public class Item
{
    [RegularExpression("sampleExpression")]
    public string Id { get; set; }
} 
```

类必须用 注释`[ModelBinder]`，否则参数绑定机制会尝试`id`从请求体中提取字段。阅读[这篇文章](http://www.asp.net/web-api/overview/formats-and-model-binding/parameter-binding-in-aspnet-web-api)了解更多信息。

另外，请注意`Id`现在是*PascalCase*而不是*camelCase*。阅读[本文](http://www.asp.net/web-api/overview/formats-and-model-binding/json-and-xml-serialization)以了解如何进行转换。

动作签名是：

```
public string Get(Item item) 
```

# jquery - 如何将文本放在按钮的底部？

> ID：11816857
> 
> 赞同：0
> 
> 时间：2012-08-05T13:32:15.033
> 
> 标签：jquery, mobile, button, jquery-mobile, alignment

我已经查看/搜索了对齐、位置（ing）等。

见图片：

![在此处输入图像描述](../Images/51fc2c65dd7978396c8307ee1e441d58.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:38:11.560

就像是：

```
input
{
display: block;
padding-top: 300px;
} 
```

它应该工作。

示例：http: [//jsfiddle.net/bkePe/1/](http://jsfiddle.net/bkePe/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:39:45.083

你研究过布局吗？创建一个容器并在其上堆叠一个按钮和一个标签。

[http://layout.jquery-dev.net/documentation.cfm#Properties_Methods](http://layout.jquery-dev.net/documentation.cfm#Properties_Methods)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T05:46:20.757

好的，让它工作：

```
<head>
<style type="text/css">
<!--
a{
    line-height: 500px; 
    text-align:buttom;

}
-->   
        </style>
   </head>
  <body>
<a data-corners="false" href="index.html" data-role="button" data-icon="delete"
          data-iconpos="top" data-theme="a">LIVINGROOM</a> 
     </body>
</html> 
```

注意：行高：500px；因为我的按钮比标准的大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T16:27:04.490

使用内置定位怎么样？

```
data-iconpos="top" 
```

来源：http: [//jquerymobile.com/test/docs/buttons/buttons-icons.html](http://jquerymobile.com/test/docs/buttons/buttons-icons.html)

# javascript - jQuery UI 未加载

> ID：11816865
> 
> 赞同：2
> 
> 时间：2012-08-05T13:33:12.490
> 
> 标签：javascript, jquery

我正在尝试使用 jquery draggable ui ，但似乎 ui 没有很好地导入

我会运行这个测试：

```
if(jQuery.ui){
    alert("loaded");
        }
    else
    {
        alert("not loaded");
    } 
```

并收到“未加载”警报....

这是我正在编写的文件的第一行代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
    <?php
    $searchQuery = $_POST['searchQuery'];
    ?>

    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script> 
```

知道可能出了什么问题吗？

*我已经在使用另一个工作正常的jQuery函数，所以jquery包肯定是导入的，我猜问题是ui导入没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:42:31.963

尝试

```
if (jQuery.ui || jQuery.ui != "undefined") {
    alert("loaded")
} 
```

你总是可以尝试加载一个随机的 UI 项（从 jQuery ui 网站中提取）HTML

```
<div id="accordion">
    <h3><a href="#">First header</a></h3>
    <div>First content</div>
    <h3><a href="#">Second header</a></h3>
    <div>Second content</div>
</div> 
```

JavaScript

```
$("#accordion").accordion(); 
```

如果 HTML 块没有显示为手风琴元素，则不会加载它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-14T15:15:18.733

尝试这个 ：

```
 $( function() { $("#accordion").accordion();} ); 
```

# ruby - 如何正确检查 Ruby 中的 HTTP 响应代码

> ID：11816871
> 
> 赞同：0
> 
> 时间：2012-08-05T13:33:43.317
> 
> 标签：ruby, class

我正在编写一个 gem，它将作为我公司提供的服务的 REST API 客户端。

为此，我有一个`Channel`类将用作与`/channels`API 路径交互的一种方式。它[`HTTParty`](https://github.com/jnunemaker/httparty)用于实际的 HTTP 调用。此类有一个名为 create 的方法，该方法发布具有所需属性的 Channel 实例。

这是该方法的样子：

```
def create
  body = { external_id: external_id,
           name:        name,
           description: description }
  action = post "/", body
  case action.response.class
  when Net::HTTPAccepted      then return action
  when Net::HTTPNotAcceptable then raise HTTPNotAcceptable
  else raise "Server responded with " + Net::HTTPResponse::CODE_TO_OBJ[action.response.code].to_s
  end
end 
```

该`post`方法是将主体哈希转换为 JSON 并将身份验证和其他属性附加到实际`HTTParty`调用的抽象。

这不起作用。即使响应是 a `202`，此`case`语句也始终符合`else`条件。我在通话`pry`后附加了一个会话`post`以验证响应是否正确：

```
 38: def create
    39:   body = { external_id: external_id,
    40:            name:        name,
    41:            description: description }
    42:   action = post "/", body
 => 43:   case action.response.class
    44:   when Net::HTTPAccepted      then return action
    45:   when Net::HTTPNotAcceptable then raise HTTPNotAcceptable
    46:   else raise "Server responded with " + Net::HTTPResponse::CODE_TO_OBJ[action.response.code].to_s
    47:   end
    48: end

[1] (pry) #<ZynkApi::Channel>: 0> action.response.class
=> Net::HTTPAccepted 
```

但它仍然落在`else`：

```
[1] (pry) #<ZynkApi::Channel>: 0> action.response.class
=> Net::HTTPAccepted
[2] (pry) #<ZynkApi::Channel>: 0> n

From: /Users/cassiano/projects/Zynk/src/zynk_api/lib/zynk_api/channel.rb @ line 38 ZynkApi::Channel#create:

    38: def create
    39:   body = { external_id: external_id,
    40:            name:        name,
    41:            description: description }
    42:   action = post "/", body
    43:   case action.response.class
    44:   when Net::HTTPAccepted      then return action
    45:   when Net::HTTPNotAcceptable then raise HTTPNotAcceptable
 => 46:   else raise "Server responded with " + Net::HTTPResponse::CODE_TO_OBJ[action.response.code].to_s
    47:   end
    48: end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T11:57:17.743

考虑 case 语句，就像它使用`===`方法一样：

```
if Net::HTTPAccepted === action.response.class
  puts 'accepted'
elsif Net::HTTPNotAcceptable === action.response.class
  puts 'not acceptable'
else
  puts 'unknown status'
end 
```

但是，正如你所知 - 大多数类的类是一个类，所以你应该像这样重写你的案例（不要在响应时调用类方法）：

```
case action.response
  when Net::HTTPAccepted
    return action
  when Net::HTTPNotAcceptable
    raise HTTPNotAcceptable
  else
    raise "Server responded with " + Net::HTTPResponse::CODE_TO_OBJ[action.response.code].to_s
end 
```

# magento-1.7 - 无法将自定义字段添加到注册表单以保存

> ID：11816872
> 
> 赞同：3
> 
> 时间：2012-08-05T13:34:03.333
> 
> 标签：magento-1.7

[我使用本手册](http://www.magentocommerce.com/wiki/5_-_modules_and_development/customers_and_accounts/registration_fields)在 magento 1.7.0.2 上的 magento 客户注册表单中添加了两个新字段。

字段似乎可以很好地添加到数据库中，并且在管理员下也可见，但只是没有被保存。在客户对象 ($this->getCustomer()) 上运行 var 转储不会显示我添加的新属性。

任何人都可以在这里给我一个领导，因为我在兜圈子

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T08:42:46.647

嗨，我找到了解决此问题的方法，请`db fields collection`在以下文件中添加您的

```
app\code\core\Mage\Review\Model\Resource\Review\collection.php on line 104 
```

**改变**

```
 array('detail_id', 'title', 'detail', 'nickname', 'customer_id')); 
```

**至**

```
 array('detail_id', 'title', 'detail', 'nickname','pros','cons','city','age', 'customer_id')); 
```

# java - 使用 IntelliJ Idea 进行远程调试

> ID：11816877
> 
> 赞同：4
> 
> 时间：2012-08-05T13:35:26.960
> 
> 标签：java, debugging, intellij-idea

我尝试使用 IntelliJ Idea 10.5 远程调试我的 Java 代码。我的代码使用 Tomcat 实现了在 Amazon 上运行的 Java 服务器。我在 Idea 中创建了远程调试配置，这个配置表现得很奇怪。

1.  配置只有“配置”和“日志”部分。缺少“服务器”和“部署”部分。
2.  当我选择它时，“运行”按钮变得不可用。“调试”按钮看起来可用，但是当我按下它时，调试不会开始。

有什么问题？如何检查调试配置是否正常？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T10:44:34.087

问题是服务器名称以 http:// 开头我删除了 'http://' 并且它有效

# xpath - Jsoup css 选择器代码（包括 xpath 代码）

> ID：11816878
> 
> 赞同：4
> 
> 时间：2012-08-05T13:35:28.943
> 
> 标签：xpath, css-selectors, jsoup, html-parsing

我正在尝试使用 jsoup 解析以下 HTML，但无法获得正确的语法。

```
<div class="info"><strong>Line 1:</strong> some text 1<br>
  <b>some text 2</b><br>
  <strong>Line 3:</strong> some text 3<br>
</div> 
```

我需要在三个不同的变量中捕获一些文本 1、一些文本 2 和一些文本 3。

我有第一行的 xpath（第 3 行应该类似），但无法计算出等效的 css 选择器。

```
//div[@class='info']/strong[1]/following::text() 
```

在另一个上，我有几百个 html 文件，需要解析并从中提取数据以存储在数据库中。Jsoup 是最好的选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T15:08:04.000

看起来 Jsoup 确实无法处理从具有混合内容的元素中获取文本。这是一个使用您制定的使用[XOM](http://www.xom.nu)和[TagSoup](http://home.ccil.org/~cowan/XML/tagsoup/)的 XPath 的解决方案：

```
import java.io.IOException;

import nu.xom.Builder;
import nu.xom.Document;
import nu.xom.Nodes;
import nu.xom.ParsingException;
import nu.xom.ValidityException;
import nu.xom.XPathContext;

import org.ccil.cowan.tagsoup.Parser;
import org.xml.sax.SAXException;

public class HtmlTest {
    public static void main(final String[] args) throws SAXException, ValidityException, ParsingException, IOException {
        final String html = "<div class=\"info\"><strong>Line 1:</strong> some text 1<br><b>some text 2</b><br><strong>Line 3:</strong> some text 3<br></div>";
        final Parser parser = new Parser();
        final Builder builder = new Builder(parser);
        final Document document = builder.build(html, null);
        final nu.xom.Element root = document.getRootElement();
        final Nodes textElements = root.query("//xhtml:div[@class='info']/xhtml:strong[1]/following::text()", new XPathContext("xhtml", root.getNamespaceURI()));
        for (int textNumber = 0; textNumber < textElements.size(); ++textNumber) {
            System.out.println(textElements.get(textNumber).toXML());
        }
    }
} 
```

这输出：

```
 some text 1
some text 2
Line 3:
 some text 3 
```

虽然不知道你想要做什么的更多细节，但我不确定这是否正是你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-02T00:59:14.577

可以获得对单个 TextNode 的对象引用。我想也许你看过 Jsoup 的[TextNode](http://jsoup.org/apidocs/org/jsoup/nodes/TextNode.html)对象。

[Element](http://jsoup.org/apidocs/org/jsoup/nodes/Element.html)顶层的文本是 TextNode 对象的一个​​实例。例如，“some text 1”和“some text 3”都是“<div class='info'>”下的TextNode对象，“Line 1:”是“<strong>”下的TextNode对象

元素对象有一个[textNodes()](http://jsoup.org/apidocs/org/jsoup/nodes/Element.html#textNodes%28%29)方法，可用于获取这些 TextNode 对象。

检查以下代码：

```
String html = "<html>" +
                  "<body>" +
                      "<div class="info">" +
                          "<strong>Line 1:</strong> some text 1<br>" +
                          "<b>some text 2</b><br>" +
                          "<strong>Line 3:</strong> some text 3<br>" +
                      "</div>" +
                  "</body>" +
              "</html>";

Document document = JSoup.parse(html);
Element infoDiv = document.select("div.info").first();
List<TextNode> infoDivTextNodes = infoDiv.textNodes(); 
```

此代码查找第一个 <div> 元素，该元素具有 key="class" 和 value="info" 的属性。然后直接在“<div class='info'>”下获取对所有 TextNode 对象的引用。该列表如下所示：

```
List<TextNode>[" some text 1", " some text 3"] 
```

TextNode 对象有一些与它们相关联的甜蜜数据和方法，您可以使用它们，并且扩展[Node](http://jsoup.org/apidocs/org/jsoup/nodes/Node.html)为您提供更多可以使用的功能。

以下是获取 div 中每个 TextNode 的对象引用的示例，其中 class="info"。

```
for(Iterator<Element> elementIt = document.select("div.info").iterator(); elementIt.hasNext();){
    Element element = elementIt.next();

    for (Iterator<TextNode> textIt = element.textNodes().iterator(); textIt.hasNext();) {
        TextNode textNode = textIt.next();
        //Do your magic with textNode now.
        //You can even reference it's parent via the inherited Node Object's 
        //method .parent();
    }
} 
```

使用这种嵌套迭代器技术，您可以访问对象的所有文本节点，并且通过一些巧妙的逻辑，您可以在 Jsoup 的结构中做任何您想做的事情。

我已经为我过去创建的拼写检查方法实现了这个逻辑，它确实对具有大量元素的非常大的 html 文档有一些性能影响，也许是很多列表或其他东西。但是，如果您的文件长度合理，您应该获得足够的性能。

以下是获取 Document 的每个 TextNode 的对象引用的示例。

```
Document document = Jsoup.parse(html);

for (Iterator<Element> elementIt = document.body().getAllElements().iterator(); elementIt.hasNext();) {
    Element element = elementIt.next();
    //Maybe some magic for each element..

    for (Iterator<TextNode> textIt = element.textNodes().iterator(); textIt.hasNext();) {
        TextNode textNode = textIt.next();
        //Lots of magic here for each textNode..
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:16:46.180

*我认为*你的问题是你感兴趣的文本，只有一个短语包含在任何定义标签中，“一些文本 2”被`<b>` `</b>`标签包围。所以这很容易通过以下方式获得：

```
String text2 = doc.select("div.info b").text(); 
```

返回

```
some text 2 
```

其他感兴趣的文本只能定义为`<div class="info">`标签内的文本，仅此而已。*因此，我所知道*的唯一方法是获取这个较大元素所包含的所有文本：

```
String text1 = doc.select("div.info").text(); 
```

但不幸的是，这会获取该元素所持有的*所有文本：*

```
Line 1: some text 1 some text 2 Line 3: some text 3 
```

这是我能做的最好的事情，我希望有人能找到更好的答案并继续关注这个问题。

# c# - 获取树的特定级别中的所有节点

> ID：11816879
> 
> 赞同：0
> 
> 时间：2012-08-05T13:35:34.150
> 
> 标签：c#

给定以下类，用于构建树层次结构：

```
public class simpletest
{
    public simpletest Parent { get; set; }
    public IList<simpletest> Children { get; set; }
    public string Name { get; set; }
} 
```

如何获取特定级别的所有对象的列表？

这是一些示例数据（希望其格式正确）：

```
var root = new simpletest() { Name = "Root" };
var level1childA = new simpletest() { Name = "level1childA", Parent = root };
var level1childB = new simpletest() { Name = "level1childB", Parent = root };

var level2childA = new simpletest() { Name = "level2childA", Parent = level1childA };
var level2childB = new simpletest() { Name = "level2childB", Parent = level1childA };
var level2childC = new simpletest() { Name = "level2childC", Parent = level1childB };
var level2childD = new simpletest() { Name = "level3childD", Parent = level1childB };

var level3childA = new simpletest() { Name = "level3childA", Parent = level2childA };
var level3childB = new simpletest() { Name = "level3childB", Parent = level2childA };
var level3childC = new simpletest() { Name = "level3childC", Parent = level2childB };
var level3childD = new simpletest() { Name = "level3childD", Parent = level2childB };
var level3childE = new simpletest() { Name = "level3childE", Parent = level2childC };
var level3childF = new simpletest() { Name = "level3childF", Parent = level2childC };
var level3childG = new simpletest() { Name = "level3childG", Parent = level3childD };
var level3childH = new simpletest() { Name = "level3childH", Parent = level3childD };

level2childA.Children = new List<simpletest> { level3childA, level3childB };
level2childB.Children = new List<simpletest> { level3childC, level3childD };
level2childC.Children = new List<simpletest> { level3childE, level3childF };
level2childD.Children = new List<simpletest> { level3childG, level3childH };

level1childA.Children = new List<simpletest> { level2childA, level2childB };
level1childB.Children = new List<simpletest> { level2childC, level2childD }; 
```

因此，例如，使用节点 level3childE，我将如何从同一级别获取所有节点？节点名称可以是任何名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:47:41.650

这是作为 simpletest 的成员函数实现的（未经测试的）递归方法：

```
IEnumerable<simpletest> ElementsAtDepth(int depth) {
    if(depth > 0) {
        foreach(simpletest child in this.Children)
            foreach(simpletest element in child.ElementsAtDepth(depth - 1))
                yield return element;
    }
    else {
        foreach(simpletest element in this.Children)
            yield return element;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-07T01:29:13.247

BlackBear 的解决方案返回下一级并且不能返回可能对绑定有用的根/初始节点。下面的代码将为您提供所请求级别的节点。另请注意，深度与初始节点相关，而不是实际树。

```
public IEnumerable<simpletest> NodesAtDepth(int depth)
{
    if (depth <= 0 )
        yield return this;
    else if (depth > 1)
    {
        if (this.Children != null)
            foreach (simpletest child in this.Children)
                foreach (simpletest element in child.NodesAtDepth(depth - 1))
                    yield return element;
    }
    else
    {
        if (this.Children != null)
            foreach (simpletest element in this.Children)
                yield return element;
    }
} 
```

# objective-c - 'Fraction' 没有可见的@interface 声明选择器'add:'

> ID：11816886
> 
> 赞同：1
> 
> 时间：2012-08-05T13:36:22.307
> 
> 标签：objective-c, interface, identifier

我正在学习 Objective-c 编程，有两个错误我无法解决。你能告诉我有什么问题吗？

```
#import "Fraction.h"
int main (int argc, char * argv[]) {
@autoreleasepool {
    Fraction *aFraction = [[Fraction alloc] init];
    Fraction *bFraction = [[Fraction alloc] init];
    [aFraction setTo: 1 over: 4];
    [bFraction setTo: 1 over: 2];
    [aFraction print];
    NSLog (@"+");
    [bFraction print];
    NSLog (@"=");
    [aFraction add: bFraction]; /*error 1: No visible @interface for 'Fraction' declares the    selector 'add:'*/
    [aFraction reduce];
    [aFraction print]; }
return 0; }

#import <Foundation/Foundation.h>
@interface Fraction : NSObject
@property int numerator, denominator;
-(void) print;
-(void) setTo: (int) n over: (int) d;
-(double) convertToNum;
￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼-(void) add: (Fraction *) f; 
-(void) reduce; /*error 2: Expected identifier or '(' */
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:51:32.027

行首似乎有一些奇怪的字符或字符`-(void) add: (Fraction *) f;`。如果我将你的界面部分粘贴到 Xcode 中，我会得到与 .h 文件中相同的错误。如果我删除该行并重新键入它，错误就会消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T13:56:33.047

1.  [从 App Store 获取](http://itunes.apple.com/us/app/textwrangler/id404010395?mt=12)TextWrangler

2.  打开有问题的 .h 文件

3.  选择`Text -> Zap Gremlins...`

4.  选中“替换为 •”

5.  [ZAP！]

...

```
 -(double) convertToNum;
 ••••••••••••••••••••••••••••••••••••••-(void) add: (Fraction *) f; 
 -(void) reduce; /*error 2: Expected identifier or '(' */ 
```

...

你的问题就在那里！

* * *

菲利普很可能是正确的。我敢打赌它是一个`ctrl`+ `return`。试试这个：

转到声明`reduce:`方法的行的末尾，然后点击`ctrl`+ `a`。

光标可能会跳回到声明`add:`. 如果您碰巧在一行的末尾点击`ctrl`+ ，就会发生这种情况。`return`

`reduce:`要解决此问题，请使用、 hit `backspace`、然后 hit转到行首`return`。

* * *

例子：

```
￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼-(void) add: (Fraction *) f; 
-(void) reduce; <*** cursor here, hit ctrl-a 
```

按 ctrl-a 后，光标将位于声明`add:`. 这意味着您在行尾有一个错误的返回字符`add:`。

也检查前后的线路。菲利普说他在该行的开头看到了时髦的字符`add:`。此外，Xcode 确实具有“显示隐藏字符”功能。这可能会有所帮助，但根据我的经验，坏的换行符是不可见的。

# java - 如何在java中获取字符的Unicode

> ID：11816887
> 
> 赞同：-1
> 
> 时间：2012-08-05T13:36:47.937
> 
> 标签：java, eclipse, unicode, character-encoding, ide

我正在使用`eclipse`as`IDE`和尝试打印我得到的阿拉伯字符 `???????`，所以我想打印`Unicode`if 阿拉伯字符

```
String displayChar(char c) {
    if (c < '\u0010') {
        return "0x0" + Integer.toHexString(c);
    } else if (c < '\u0020' || c >= '\u007f') {
        return "0x" + Integer.toHexString(c);
    } else {
        return c+"";
    }
} 
```

例如 ：

```
displayChar('م'); // output is ? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:58:16.800

有很多方法可以在 Java 中获取 Unicode 字符。例如，如果您有一个以 UTF-8 正确编码的文件，那么这将获得以下字符：

```
 try (Reader reader = new FileReader(file, "UTF-8")) {
        // read characters from the reader ...
    } 
```

* * *

您更新的问题似乎是说您真正的问题是显示字符，而不是“获取”它们。您尚未正确解释输出字符的**方式**或**位置**，但我猜您问题的原因是以下之一：

*   你没有安装阿拉伯字体（似乎不太可能......），
*   显示字符的控制台（或其他）不理解阿拉伯字符（似乎不太可能......），
*   字符已损坏；即它们不是您期望它们在 Java 程序中的样子，或者
*   您在输出流中使用了错误的字符编码。

后者是最可能的解释，但正确的诊断需要更多关于您创建输出流/写入器和写入它的方式的信息。（提示：您添加到问题中的代码不会输出任何内容。它只是将字符转换为 Java 字符串。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T17:53:24.170

确保您的 Java 应用程序的文件编码以及您的版本系统支持 Unicode。例如，尝试将您的文件保存为 UTF-8。否则，您在编辑器窗格中看到的编码可能会丢失。为了获得最大的兼容性，您应该使用`\u0645`源代码中的代码点对您的字符进行编码。

当您显示字符时，请确保您的控制台支持 Unicode，并且它使用的字体也支持该字符。

[编辑]

哦，我对你的方法也有一个小的更新：

```
public static String displayChar2(char c) {
    if (c < 0x20 || c >= 0x80) {
        return String.format("\\u%04X", (int) c);
    }
    return Character.toString(c);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T13:53:13.277

Java 中的字符只是数值——所以如果`ch`是一个字符，你可以做`int i = ch;`然后打印`i`. （这忽略了代码点与字符的复杂性——但我相信阿拉伯字母很好。）

# php - Zend Framework 中的表格形式

> ID：11816889
> 
> 赞同：-1
> 
> 时间：2012-08-05T13:37:21.350
> 
> 标签：php, zend-framework, zend-form

我阅读了许多关于如何在 zend 框架中的表格中制作表格的教程，但不幸的是，它们都没有为我工作，我已经花了很多时间在上面，所以我决定问你们。这是我的代码：

```
public $elementDecorators = array(
        'ViewHelper',
        'Errors',
        array(array('data' => 'HtmlTag'), array('tag' => 'td', 'class' => 'col2')),
        array('Label', array('tag' => 'td','class'=>'taR')),
        array(array('row' => 'HtmlTag'), array('tag' => 'tr','class' => 'rowA')),
);

public function init()
{

    $this->setName('message');

    $message_id = new Zend_Form_Element_Hidden('message_id');
    $message_id->addFilter('Int');

    $message_content = new Zend_Form_Element_Text('message_content');
    $message_content->setLabel('Message')
    ->setRequired(true)
    ->addFilter('StripTags')
    ->addFilter('StringTrim')
    ->addValidator('NotEmpty')
    ->setAttrib('class', 'frmtb');
    $username = new Zend_Form_Element_Text('username');
    $username->setLabel('Name')
    ->setRequired(true)
    ->addFilter('StripTags')
    ->addFilter('StringTrim')
    ->addValidator('NotEmpty')
    ->setAttrib('class', 'frmtb');

    $submit = new Zend_Form_Element_Submit('submit');
    $submit->setAttrib('id', 'submitbutton')
    ->setAttrib('class', 'frmbtn');

    //$this->addElements(array($message_id, $username,$message_content, $submit));
    $this->addElement($username,'username',array('decorators' => $this->elementDecorators));
    $this->addElement($message_content,'message_content',array('decorators' => $this->elementDecorators));
    $this->addElement($submit,'submit',array('decorators' => $this->elementDecorators));
} 
```

你能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:51:07.630

好的，所以我很幸运在发布此问题后立即找到了答案。[这个关于 Zend 表单装饰器](https://stackoverflow.com/questions/5276104/zend-framework-form-decorators)的问题真的很有帮助。

我的代码现在看起来像这样：

```
public function init()
{

    $this->setDecorators(array(
            'FormElements',
            array('HtmlTag',array('tag'=>'table')),
            'Form'
    ));

    $this->setName('message');

    $message_id = new Zend_Form_Element_Hidden('message_id');
    $message_id->addFilter('Int');

    $message_content = new Zend_Form_Element_Text('message_content');
    $message_content->setLabel('Message')
    ->setRequired(true)
    ->addFilter('StripTags')
    ->addFilter('StringTrim')
    ->addValidator('NotEmpty')
    ->setAttrib('class', 'frmtb');

    $message_content->setDecorators(array(
            'ViewHelper',
            'Errors',
            array(array('data'=>'HtmlTag'),
                    array('tag'=>'td','class'=>'element')),
            array('Label',array('tag'=>'td')),
            array(array('row'=>'HtmlTag'),array('tag'=>'tr')),

    ));

    $username = new Zend_Form_Element_Text('username');
    $username->setLabel('Name')
    ->setRequired(true)
    ->addFilter('StripTags')
    ->addFilter('StringTrim')
    ->addValidator('NotEmpty')
    ->setAttrib('class', 'frmtb');

    $username->setDecorators(array(
            'ViewHelper',
            'Errors',
            array(array('data'=>'HtmlTag'),
                    array('tag'=>'td','class'=>'element')),
            array('Label',array('tag'=>'td')),
            array(array('row'=>'HtmlTag'),array('tag'=>'tr')),

    ));

    $submit = new Zend_Form_Element_Submit('submit');
    $submit->setAttrib('id', 'submitbutton')
    ->setAttrib('class', 'frmbtn');

    $submit->setDecorators(array(
            'ViewHelper',
            'Errors',
            array(array('data'=>'HtmlTag'),
                    array('tag'=>'td','class'=>'element')),
            array('Label',array('tag'=>'td')),
            array(array('row'=>'HtmlTag'),array('tag'=>'tr')),

    ));

    $this->addElements(array($message_id, $username,$message_content, $submit));
} 
```

# joomla - 如何更改美德商城特色产品展示布局

> ID：11816893
> 
> 赞同：1
> 
> 时间：2012-08-05T13:37:56.733
> 
> 标签：joomla, virtuemart

我对 joomla 很陌生，现在正在 joomla 上做项目。我想更改特色产品显示格式/布局。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T15:13:05.080

它们出现在许多地方，包括组件和模块，但开始查找的最佳位置是 `components\com_virtuemart\views`. 从那里，我经常会找到出现在页面上的一段文本，然后在所有 VM 文件中进一步搜索它，看看它可能是从哪里“拖入”的。

# javascript - jQuery Mobile Ajax 导航超时

> ID：11816898
> 
> 赞同：1
> 
> 时间：2012-08-05T13:38:28.550
> 
> 标签：javascript, jquery, html, jquery-mobile

在 jQuery Mobile 中，如果用户单击一个按钮，则会出现一个加载图标，然后它会通过 Ajax 加载新网页。

但是，在我的情况下，服务器可能没有响应。没有办法为ajax 导航功能设置超时（例如10 秒）吗？（如果超过时间限制，停止尝试导航并显示错误消息）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T16:35:23.550

要设置超时，我认为您不应该以静态方式（使用“数据转换”）进行设置，您可以创建链接的侦听器（“onclick”）并在侦听器中进行 ajax 调用以加载您的页面。用来`$.mobile.changePage()`做那个。

该`$.mobile.changePage()`函数在 jQuery Mobile 中的许多地方使用。例如，当一个链接被点击时，它的`href`属性被规范化，然后`$.mobile.changePage()`处理其余的。

所以你的代码看起来像这样：

```
$('#link_id').click(function() {
    $.ajax({
    url: "page_served_from_server",
        error: function(jqXHR, strError){
        if(strError == 'timeout')
        {
          //do something. Try again perhaps?
        }
    },
    success: function(){
        //charge your page :
       // $.mobile.changePage('yourPageAdress',"turn",false,true);
    },
    // here you can specify your timeout in milliseconds 
    timeout:3000
    });
}); 
```

# .htaccess - htaccess URL重写问题

> ID：11816907
> 
> 赞同：1
> 
> 时间：2012-08-05T13:40:12.400
> 
> 标签：.htaccess, url-rewriting

我已经使用 .htaccess 规则成功地将几乎所有的 url 从旧​​形式重写为精细 url。但我对某些地址格式有疑问

例如 example.com/myusername 工作正常，而 example.com/my.username 则返回未找到的 404 页面

注意：my.username 是我数据库中的有效用户名。请问我该如何解决这个问题

更新：这是 .htaccess 文件的完整代码

```
# -FrontPage-

IndexIgnore .htaccess */.??* *~ *# */HEADER* */README* */_vti*

#ErrorDocument 404 example.com

RewriteEngine on

RewriteRule ^(.*)\.htm$ $1.php [nc]

RewriteRule ^([a-zA-z0-9_-]+)$ community/profile.php?_username=$1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T14:36:08.107

您的问题是您没有在此行的正则表达式中包含点 (.)（因为 my.username 包含一个点）：

```
RewriteRule ^([a-zA-z0-9_-]+)$ community/profile.php?_username=$1 
```

将其更改为：

```
RewriteRule ^([a-zA-z0-9_.-]+)$ community/profile.php?_username=$1 
```

请注意，用户名中的任何字符都必须添加到正则表达式中（目前它支持字母数字、下划线、破折号和点）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T15:12:16.807

1.  如果第一个规则匹配，则不需要同时**应用这两个规则。**添加 L 标志。没有它，“abc/def.htm”将变成“community/profile.php?_username=abc/def.php”。
2.  缺少第二条规则。作为一个允许的字符。
3.  （可能）您希望为这两个规则保留参数。添加 QSA 标志。

导致

```
RewriteRule ^(.*)\.htm$ $1.php [nc,L,QSA]

RewriteRule ^([a-zA-z0-9_.-]+)$ community/profile.php?_username=$1 [L,QSA] 
```

# sql - 列出从特定用户到另一个尚未审核的用户的所有行程

> ID：11816909
> 
> 赞同：2
> 
> 时间：2012-08-05T13:40:27.610
> 
> 标签：sql, postgresql

我正在使用 PostgreSQL。我有以下架构：

```
CREATE TABLE users (
  id int PRIMARY KEY
);

CREATE TABLE trips (
  id int PRIMARY KEY,
  driver_id int,
  FOREIGN KEY driver_id REFERENCES users(id)
);

CREATE TABLE trip_passengers (
  id int PRIMARY KEY,
  user_id int,
  trip_id int,
  FOREIGN KEY trip_id REFERENCES trips(id)
  FOREIGN KEY user_id REFERENCES users(id)
);

CREATE TABLE feedbacks (
  id int PRIMARY KEY,
  trip_id int,
  rater_id int,
  ratee_id int,
  review TEXT,
  FOREIGN KEY trip_id REFERENCE trips(id),
  FOREIGN KEY rater_id REFERENCES users(id),
  FOREIGN KEY ratee_id REFERENCES users(id),
  UNIQUE (trip_id, rater_id, ratee_id)
); 
```

以下是以下规则：

*   旅行可以包含多个乘客（通过 trip_passengers 表）。
*   如果他们一起旅行，用户只能进行评论。
*   司机可以对乘客进行评论。
*   乘客也可以对司机进行评论。
*   乘客可以对乘客进行评论。

案例：

表：**用户**

```
| id  | username   |
|-----+------------+
| 1   | driver     |
| 2   | passenger1 |
| 3   | passenger2 | 
```

表：**行程**

```
| id  | driver_id |
|-----+-----------+
| 1   | 1         | 
```

表：**trip_passengers**

```
| id  | trip_id | user_id |
|-----+---------+---------+
| 1   | 1       | 2       |
| 2   | 1       | 3       | 
```

假设我想从尚未审查的乘客 1 的司机那里获得所有旅行。那将返回行程#1。

如果司机对乘客 1 进行评论，然后再次运行查询，它将不会返回任何内容。

乘客的情况相同，如果我想获得乘客 1 和乘客 2 尚未审查的所有行程，我将获得行程 #1，因为他们都乘坐相同的行程。

如何将特定用户的所有行程返回给尚未审核的其他用户？

这是我最后一次尝试，但有些情况没有遇到。

```
SELECT trips.* FROM trips
  INNER JOIN trip_passengers AS t1 ON t1.trip_id = trips.id
  INNER JOIN trip_passengers AS t2 ON t1.passenger_id = :rater_id AND
    t2.passenger_id = :ratee_id AND t1.trip_id = t2.trip_id
  LEFT JOIN feedbacks ON feedbacks.trip_id = trips.id AND
    feedbacks.rater_id = t1.passenger_id
  WHERE feedbacks.review IS NULL 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T14:12:12.223

使用这种设计，您的要求不会被强制执行。任何用户都可以为任何其他用户提供反馈，无论评论者或被评论者是否参加了旅行！

这是一个建议：

**用户**

```
CREATE TABLE users
( user_id int PRIMARY KEY
) ; 
```

**旅行**

```
CREATE TABLE trips
( trip_id int PRIMARY KEY
) ; 
```

**Trip_participants**（乘客和司机）

```
CREATE TABLE trip_participants
( trip_id int,
  user_id int,
  PRIMARY KEY (trip_id, user_id),
  FOREIGN KEY trip_id REFERENCES trips (trip_id),
  FOREIGN KEY user_id REFERENCES users (user_id)
) ; 
```

**Trip_drivers**

```
CREATE TABLE trip_drivers
( trip_id int,
  driver_id int,
  PRIMARY KEY (trip_id, driver_id),
  UNIQUE KEY (trip_id)                -- optional, to enforce that a trip
                                      -- has only one driver.
  FOREIGN KEY (trip_id, driver_id) 
    REFERENCES trip_participants (trip_id, user_id)
) ; 
```

**反馈**

```
CREATE TABLE feedbacks
( feedback_id int PRIMARY KEY,
  trip_id int,
  rater_id int,
  ratee_id int,
  review TEXT,
  UNIQUE KEY (trip_id, rater_id, ratee_id) ,
  FOREIGN KEY (trip_id, rater_id) 
    REFERENCES trips(trip_id, user_id),
  FOREIGN KEY (trip_id, ratee_id) 
     REFERENCES trips(trip_id, user_id),
  CHECK (rater_id <> ratee_id)
) ; 
```

缺少的`trip_passengers`是一个视图：

**Trip_passengers**

```
CREATE VIEW trip_passengers AS
  SELECT trip_id, user_id
  FROM trip_participants
  WHERE (trip_id, user_id) NOT IN
        ( SELECT trip_id, driver_id
          FROM trip_drivers
        ) 
; 
```

* * *

最后，返回所有尚未审核的行程的查询：

```
SELECT t.*
FROM trips AS t
WHERE t.trip_id NOT IN
      ( SELECT trip_id 
        FROM feedbacks
      ) ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:57:49.757

如果任何数量的评论被接受为已评论的旅行，那么应该这样做。

```
从旅行中选择 *
t.id 不在的地方
    （选择不同的（t.id）
    FROM 行程 t，反馈 f
    其中 t.id = f.trip_id)

```

使用子查询选择所有已审核的行程，然后选择不在已审核行程中的行程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T14:07:47.907

尝试这个：

```
SELECT  a.*
FROM    trips a
            INNER JOIN  feedbacks f
                on a.ID = b.trip_id
            LEFT JOIN trips c
                on a.ID = c.ID
WHERE   c.ID IS NULL 
```

# python - 在 Tomcat 上安装 CGI 代理

> ID：11816910
> 
> 赞同：1
> 
> 时间：2012-08-05T13:40:34.367
> 
> 标签：python, module, environment

我想为 openlayers 设置一个代理来使用，所以我按照以下步骤操作：

1.  从 OpenLayers 网站下载 proxy.cgi 文件：http: [//trac.osgeo.org/openlayers/browser/trunk/openlayers/examples/proxy.cgi](http://trac.osgeo.org/openlayers/browser/trunk/openlayers/examples/proxy.cgi)

2.  修改 proxy.cgi 文件以将我的域包含在 allowedHosts 列表中：

    allowedHosts = ['localhost:6901']

3.  将 proxy.cgi 文件复制到以下文件夹：

    $TOMCAT_PATH$/webapps/yourApp/WEB-INF/cgi/

4.  通过添加以下部分来修改 Web 应用程序的文件 web.xml。您可以在以下位置找到文件

    $TOMCAT_PATH$/webapps/yourApp/WEB-INF/web.xml

**注释：**如果您的 webapp 不存在 web.xml 文件，只需自己创建或从另一个 webapp 复制并修改它。（创建！）

**注释：** “executable”参数的“param-value”必须包含 Python 安装的路径。（确实如此！）

```
<servlet> 
      <servlet-name>cgi</servlet-name> 
      <servlet-class>org.apache.catalina.servlets.CGIServlet</servlet-class> 
    <init-param> 
      <param-name>debug</param-name> 
      <param-value>0</param-value> 
    </init-param> 
    <init-param> 
      <param-name>cgiPathPrefix</param-name> 
      <param-value>WEB-INF/cgi</param-value> 
    </init-param> 
    <init-param> 
      <param-name>executable</param-name> 
      <param-value>c:\python25\python.exe</param-value> 
    </init-param> 
    <init-param> 
      <param-name>passShellEnvironment</param-name> 
      <param-value>true</param-value> 
    </init-param> 
    <load-on-startup>5</load-on-startup> 
  </servlet> 

  <servlet-mapping> 
    <servlet-name>cgi</servlet-name> 
    <url-pattern>/cgi-bin/*</url-pattern> 
  </servlet-mapping> 
```

1.  通过添加以下元素来修改 Web 应用程序的文件 context.xml。您可以在以下位置找到文件`$TOMCAT_PATH$/webapps/yourApp/META-INF/context.xml`

2.  重启Tomcat

3.  要将代理与 OpenLayers 一起使用，只需在代码中包含这一行：

    OpenLayers.ProxyHost = "/yourWebApp/cgi-bin/proxy.cgi?url=";

但是当我尝试像这样使用它时：

```
/webappname/cgi-bin/proxy.cgi?url=labs.metacarta.com 
```

我收到此错误：

```
Some unexpected error occurred. Error text was: list index out of range 
```

我认为它与 os.environ["REQUEST_METHOD"] 有关，但我不知道它是如何相关的..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T21:55:50.587

您正在提交：

```
/webappname/cgi-bin/proxy.cgi?url=labs.metacarta.com 
```

但是 proxy.cgi 脚本正在尝试这样做：

```
host = url.split("/")[2] 
```

尝试[http://labs.metacarta.com](http://labs.metacarta.com)作为您的 url，以便 proxy.cgi 有一些斜线可以拆分，或者修改它以更智能地解析 url。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:49:01.647

您要求的是未定义的环境变量。

您需要捕获并处理异常或使用`os.environ.get`：

```
try:
    methodq = os.environ["REQUEST_METHOD"]
except KeyError:
    methodq = "default value" 
```

或者：

```
methodq = os.environ.get("REQUEST_METHOD", "default value") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-26T23:15:33.740

答案是：您没有在 Tomcat 上安装或使用 cgi 代理。

cgi 适用于用作前端服务器的 apache 服务器或 IIS。Tomcat 可能坐在它后面。Apache的配置详解在：http: [//tomcat.apache.org/tomcat-6.0-doc/proxy-howto.html](http://tomcat.apache.org/tomcat-6.0-doc/proxy-howto.html)

请注意，OpenLayers 警告说它的 proxy.cgi 只是一个示例，可能没有足够好的检查来阻止它被利用，即它可能运行一些恶意脚本。

如果您仅在 Tomcat 上提供 OpenLayers 客户端页面，并且它包含来自其他 GeoServer 或 Mapserver 的图层，则可以使用代理 servlet 并将其指定为：

OpenLayers.ProxyHost = "服务于该页面的服务器上的 sevlet URL";

[http://wiki.apache.org/tomcat/ServletProxy](http://wiki.apache.org/tomcat/ServletProxy)

[https://svn.openxdata.org/Experimental/openXmapper/trunk/gwt-openlayers-server/src/main/java/org/gwtopenmaps/openlayers/server/GwtOpenLayersProxyServlet.java](https://svn.openxdata.org/Experimental/openXmapper/trunk/gwt-openlayers-server/src/main/java/org/gwtopenmaps/openlayers/server/GwtOpenLayersProxyServlet.java)

也有反向代理或重写 sevlet 解决方案。请在这些上谷歌。

# jquery - jQuery 回调函数只在最后一个循环触发

> ID：11816913
> 
> 赞同：2
> 
> 时间：2012-08-05T13:41:51.863
> 
> 标签：jquery, loops, for-loop, closures

我知道还有其他问题可以解决相同的问题，但我找不到我能正确理解的答案。

我试图通过遍历一组页面名称来读取一组页面，然后使用 jQuery 的 $.get 函数来获取页面的内容。我相信这是由于循环关闭，只有循环的最后一个回调才会触发。但是，我不明白解决这个问题的方法或如何解决它，有人可以解释一下吗？

这是代码：

```
function checkall2()
{
    i = 0;
    for(i in $servers) {
        $.get("servers/" + $servers[i], function(result) {
            alert(result + $servers[i]);
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T13:58:36.323

这是一个范围问题 -`i`正在被“覆盖”，当最终触发回调时，所有回调的值都将相同。

由于您使用的是 jQuery，因此您可以使用迭代器：

```
$.each($servers, function(i, server) {
  $.get("servers/" + server, function(result) {
    alert(result + server);
  });
}); 
```

恕我直言，这看起来更清晰。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T13:52:20.040

我认为这是一个范围问题 - 尝试分配给循环内的本地，如下所示：

```
function checkall2()
{
    i = 0;
    for(i in $servers) {
        var server = $servers[i];
        $.get("servers/" + server, function(result) {
            alert(result + server);
        });
    }
} 
```

编辑以显示工作`$.each`- > [http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)

```
function checkall2()
{
    $.each($servers, function(index, server) {
        $.get("servers/" + server, function(result) {
            alert(result + server);
        });
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T13:54:41.867

您不能在循环中调用异步方法，而是这样做：

```
function checkall2(i)
{
    if(i< $servers.length) {
        $.get("servers/" + $servers[i], function(result) {
            alert(result + $servers[i]);
           checkall2(++i);
        });
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T13:55:12.413

```
var $servers = [1,2,3];
function checkall2()
{
    i = 0;
    for(i in $servers) {
       $.get("servers/" + $servers[i], function(result) {
         alert(result + $servers[i]);
      });
    }
 }
 checkall2(); 
```

这工作正常，在我的机器上。你确定你的全局变量没问题？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T14:18:24.230

好的，我知道为什么它不起作用。谢谢佩德罗向我解释这个问题。所以每次的变量结果都不一样，这没有问题，只是因为三个文件的内容都相同，所以一旦我改变它们，我意识到结果是不同的。

$servers[i] 每次返回相同的原因是因为一旦循环完成回调然后调用，到那时 i 处于循环的末尾，所以它只返回 $servers[2]三次（因为 2 是循环的结尾）。

# c# - 修复：全局元素“配置”已被声明

> ID：11816916
> 
> 赞同：81
> 
> 时间：2012-08-05T13:41:59.263
> 
> 标签：c#, xsd, stylesheet, app-config

我使用了 [如何解决“找不到元素/属性 <xxx> 的架构信息”的第二种解决方案？](https://stackoverflow.com/questions/179927/how-to-resolve-could-not-find-schema-information-for-the-element-attribute-xxx)

即用按钮创建了一个 XSD 来创建一个方案。我将 app.config 中的样式表更改为 app.xsd 但现在我收到警告：

全局元素“配置”已在 app.xsd 中声明

即使更改名称，也会显示警告。有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2013-01-03T04:16:19.500

重新启动对我不起作用，所以我想分享一下有效的方法。

首先，我刚刚升级到Windows 8。在此之前没有出现这个问题。这个问题只发生在我的*一个*app.config 文件中。所以我决定将有问题的 app.config 与一个好的 app.config 进行比较。在 Visual Studio 中，打开 app.config，我转到`Xml -> Schemas`. 我注意到好的配置只检查了其中三个模式。坏的检查了相同的三个，加上一个 DotNetConfig.xsd。在我将`Use`列更改为自动后，对于 DotNetConfig.xsd，问题就消失了。

![在此处输入图像描述](../Images/8ebf4dcab05fd72ed22923b36aed6dfe.png)

![在此处输入图像描述](../Images/0dc9b8ca7511a31e2c839507a1ba3f90.png)

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-08-14T09:42:43.453

我遇到了与您所指的问题类似的问题，我按照这些说明进行操作，一切都很好。首先确保在`EnterpriseLibrary.Configuration.xsd`，`%ProgramFiles%\Microsoft Visual Studio [version]\Xml\Schemas\`然后执行以下操作：

> Enterprise Library 将架构安装到 Visual Studio 中，该架构提供 IntelliSense® 以在 Visual Studio XML 编辑器中编辑 Enterprise Library 配置文件。您必须先打开架构，然后才能使用它。

> 启用企业库配置架构

> 1.  通过在解决方案资源管理器中双击它来打开 Visual Studio 中的配置文件。

> 2.  在 XML 菜单上，单击 Schemas... 打开 XML Schemas 对话框。

> 3.  找到名为 EnterpriseLibrary.Configuration.xsd 的架构。这是自动安装的。但是，如果它未显示在列表中，请单击添加并导航到文件夹 %Program Files%\Microsoft Visual Studio [版本]\Xml\Schemas，然后选择 EnterpriseLibrary.Configuration.xsd 并单击打开。

> 4.  将 Use 列中的值更改为 Use this schema。然后单击确定。

文章链接在[这里](http://msdn.microsoft.com/en-us/library/ff664633%28v=pandp.50%29.aspx)，希望对你有帮助

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2015-02-18T17:36:12.943

我的问题是我从 .Net 4.5 转到 .Net 4.0。为了解决这个问题，我将所有勾选的模式切换为自动。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2015-11-20T09:37:59.337

我也为此挣扎了一段时间。原来，我的问题版本源于`{PROJECTNAME}.SUO`Visual Studio 创建的隐藏文件。

我的猜测是，VS 会在这个文件中缓存 XSD 模式关联。更改目标框架后弹出警告，删除SUO文件并重新启动VS后警告消失。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2015-01-23T16:50:20.223

使用问题中描述的症状并使用 Visual Studio 2013（更新 4），我可以在**XML Schemas** [sic] 对话框中看到两者都`DotNetConfig.xsd`被`DotNetConfig40.xsd`选中使用。

我正在使用 .NET Framework 4.0 项目。

这两个 XSD 文件相互冲突，每个文件都定义了相同的元素，从而导致发出警告。

这些模式文件包含在`%programfiles(x86)%\Microsoft Visual Studio 12.0\xml\Schemas\`文件夹中。

`DotNetConfig.xsd`位于`1033`子文件夹中，似乎是更新、更完整的版本。

无论我在 XML Schemas 中选择什么设置，我都无法取消选择或删除*DotNetConfig40*或*DotNetConfig*。我尝试了“**删除**”，并将 Use 参数从“**使用此架构**”更改为“**自动**”，然后更改为“**不使用此架构**”。

无论选择了什么，对于任何一个文件，当我返回对话框时，都将被选中使用。**我还尝试了在按“确定**”之前移动到另一行的技巧，但无济于事。

最后，我将`DotNetConfig40.xsd`文件重命名为`DotNetConfig40 DO NOT USE.xsd`以防止它被加载。这立即解决了问题。

我对不得不这样做感到不满意，并担心它是否会对其他项目产生不良的副作用。我会用我的结果更新这篇文章。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-05-28T22:20:10.753

一旦我在编辑器中关闭导致这些警告的文件并重新编译，这个问题就得到了解决。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-09-11T11:16:37.603

我注意到我的 VS2017 存在这个问题。

将 DotNetConfig.xsd 更改为使用“自动”解决了该问题。

[![在此处输入图像描述](../Images/8c4410ee5ee88c8c166b3f6a47f0f96a.png)](https://i.stack.imgur.com/cUTXr.png)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-08-14T23:21:23.820

重新启动系统后，问题得到解决，这意味着我不再收到与该方案相关的任何警告。

所以似乎重新启动（可能还有一些隐式恢复/重置删除了警告）。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-03-12T23:49:24.930

对我来说，我注意到我有一堆`XML Schemas`重复的，我只是简单地标记为`Don't Use`所有与 Visual Studio 2017 无关的。问题立即消失了

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-10-18T15:05:56.483

使用 Visual Studio 2015 社区版 - 在我的项目的根文件夹中生成 web.xsd 并将其添加到架构列表中清除了除一个警告之外的所有警告，

> 全局元素“配置”已被声明。

在文本编辑器中关闭 web.config 文件并重新构建项目会清除此警告。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-01-10T14:45:52.533

Necromancing：使用 Visual Studio 2017 更新 2019

我试着做其他人建议的事情：

*   我试图重新启动系统：没有工作。
*   打开 App.Config
*   菜单：XML - 模式...
*   看到有几个DotNetConfigXX.csd（XX要么是emoty，要么是一个数字）
*   我试图将它们设置为自动，或“不使用此模式”
*   我试图删除重复的架构

**这一切都没有奏效。**

**[但是，此处描述](https://stackoverflow.com/questions/4355278/visual-studio-always-selects-the-wrong-xsd-for-app-config)**的 OLEG 解决方案**有效。**

 **我所要做的就是用以下代码替换所有使用的 DotNetConfigXX.xsd 文件中的以下部分（XX 为空，或数字）

```
 <xs:element name="startup" vs:help="configuration/startup" 
 ...
 </xs:element> 
```

用。。。来代替：

```
<xs:element name="startup" vs:help="configuration/startup">
    <xs:complexType>
        <xs:choice minOccurs="1" maxOccurs="1">
            <xs:element name="requiredRuntime"     vs:help="configuration/startup/requiredRuntime">
                <xs:complexType>
                    <xs:attribute name="version" type="xs:string" use="optional" />
                    <xs:attribute name="safemode" type="xs:boolean" use="optional" />
                </xs:complexType>
            </xs:element>
            <xs:element name="supportedRuntime" minOccurs="1" maxOccurs="unbounded" vs:help="configuration/startup/supportedRuntime">
                <xs:complexType>
                    <xs:attribute name="version" type="xs:string" use="optional" />
                    <xs:attribute name="sku" type="xs:string" use="optional" />
                </xs:complexType>
            </xs:element>
        </xs:choice>
        <xs:attribute name="useLegacyV2RuntimeActivationPolicy" type="xs:boolean" use="optional" />
        <!-- see http://msdn.microsoft.com/en-us/library/bbx34a2h.aspx -->
    </xs:complexType>
</xs:element> 
```

**不要忘记备份您的原始 .XSD 文件！**

重新启动视觉工作室后，错误消失了。**

# templates - 如何纠正使用 Joomla 出现内部服务器错误

> ID：11816918
> 
> 赞同：0
> 
> 时间：2012-08-05T13:42:00.483
> 
> 标签：templates, joomla

帮助我在我的 joomla 上工作！2.5.6 站点并做了一些事情导致前端和后端出现问题。这些是我为创建问题所做的步骤。在 Artisteer 4 beta 中创建了一个模板用作辅助模板，而不是默认模板。我试图删除模板，但它告诉我无法删除最后一个模板样式。我使用 FileZilla FTP 删除了该模板模板管理器仍然在列表中显示该模板。我读到我必须使用分机管理器来删除模板。我将模板上传回一个与我之前删除的同名的新目录。然后我使用分机管理器正确删除了模板。我决定开始使用 rt-gantry v3.2.22 作为我的默认模板

现在，当我对此进行修改时，我经常遇到 500 内部服务器错误。大多数情况下，只需刷新页面就会将我带到我想要的页面，有时需要 2、3、4、5 次刷新才能完成。

在我保存更改并刷新页面后的前端，除非我刷新几次，否则我可能看不到更改。在某些情况下，页面显示时没有任何 CSS，有时会显示旧数据。最终它将正确显示保存的更改。

我怎样才能找到这个问题的根源并纠正它。在此先感谢，杰夫的网址是 www.lastingimpressionwebdesign.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T15:22:15.480

跟踪存在或不存在的内容有点令人困惑，但如果您能够进入管理员，那么显然这是一个模板问题。当然，所有文件都需要在那里，但 jos_extensions 表中必须有一个条目来匹配它们。另外，我怀疑您使用*rt-gantry v3.2.22*作为“模板”的评论 - 这是模板的*框架*，而不是模板本身。您可能需要更新或重新安装 Gantry 以确保您也完成了它的安装。

简而言之，我建议将所有内容恢复为标准的 Joomla 模板，例如 Beez，*让前端工作，*然后*开始逐步将您的选择添加回模板中，一次一步地覆盖/分配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T17:14:24.183

它可能是您文件的所有权或权限。它也可能是您的托管服务提供商的服务器环境以及 PHP 的配置方式。不看日志很难说。

# ruby-on-rails - Rails ActiveRecord - 搜索多个属性

> ID：11816919
> 
> 赞同：9
> 
> 时间：2012-08-05T13:42:17.923
> 
> 标签：ruby-on-rails, ruby-on-rails-3, search, activerecord, sql-injection

我正在实现一个简单的搜索功能，它应该检查用户名、姓氏和名字中的字符串。我在旧的 RailsCast 上看到过这个 ActiveRecord 方法：

[http://railscasts.com/episodes/37-simple-search-form](http://railscasts.com/episodes/37-simple-search-form)

```
find(:all, :conditions => ['name LIKE ?', "%#{search}%"]) 
```

但是我该如何让它在名称、姓氏和名字中搜索关键字，并在其中一个字段与该术语匹配时返回记录？

我还想知道 RailsCast 上的代码是否容易发生 SQL 注入？

非常感谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-05T13:48:26.967

我假设您的型号名称是 Model - 只需在您进行实际查询时将其替换为您的真实型号名称：

```
Model.where("name LIKE ? OR last_name LIKE ? OR first_name LIKE ?", "%#{search}%","%#{search}%","%#{search}%") 
```

关于您对 SQL 注入的担忧——这两个代码片段都不受 SQL 注入的影响。只要您不直接将字符串嵌入到 WHERE 子句中，就可以了。易注入代码的示例是：

```
Model.where("name LIKE '#{params[:name]}'") 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-04-10T00:10:13.790

虽然选择的答案会起作用，但我注意到如果您尝试输入搜索“Raul Riera”它会中断，因为它在两种情况下都会失败，因为 Raul Riera 既不是我的名字也不是我的姓氏.. 是我的名字和姓氏...我通过这样做解决了

```
Model.where("lower(first_name || ' ' || last_name) LIKE ?", "%#{search.downcase}%") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-09-14T17:32:09.847

使用 Arel，您可以避免手动编写 SQL，如下所示：

```
Model.where(
  %i(name first_name last_name)
    .map { |field| Model.arel_table[field].matches("%#{query}%")}
    .inject(:or)
) 
```

如果要匹配的字段列表是动态的，这将特别有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-17T13:47:51.577

最好的方法是：

```
Model.where("attr_a ILIKE :query OR attr_b ILIKE :query", query: "%#{query}%") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-09T12:53:50.483

在模型的所有领域进行搜索的更通用的解决方案是这样的

```
def search_in_all_fields model, text
  model.where(
    model.column_names
      .map {|field| "#{field} like '%#{text}%'" }
      .join(" or ")
  )
end 
```

或者更好地作为模型本身的范围

```
class Model < ActiveRecord::Base
  scope :search_in_all_fields, ->(text){
    where(
      column_names
        .map {|field| "#{field} like '%#{text}%'" }
        .join(" or ")
    )
  }
end 
```

你只需要这样称呼它

```
Model.search_in_all_fields "test" 
```

在你开始之前..，不，sql注入在这里可能不起作用，但仍然更好更短

```
class Model < ActiveRecord::Base
  scope :search_all_fields, ->(text){
    where("#{column_names.join(' || ')} like ?", "%#{text}%")
  }
end 
```

# visual-studio - 无法在 Visual Web Developer Express 中打开 CSS 文件

> ID：11816922
> 
> 赞同：-1
> 
> 时间：2012-08-05T13:43:01.037
> 
> 标签：visual-studio, vwdexpress

我检查了其他有相同问题的人，发现只有三个建议（重新安装、删除更新和恢复文件关联）。

我没有安装任何更新，我尝试重新安装整个 shabang（成功）并且我测试了恢复文件 ass'es。一切都无济于事。

当我单击 CSS 文件时，我仍然收到消息：

*“操作无法完成。未定义的错误。*

这适用于所有项目，只有 CSS 文件（据我所知）。这些站点像以前一样正常工作。只是IDE无法打开该死的文件！建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:43:27.430

这真的很奇怪。解决方案被证明是从 Scott Hanselman 安装 Web 标准，将其删除，然后重新安装。确实很奇怪。

# javascript - 如何将 CSS span 应用于没有换行符的连接字符串？

> ID：11816933
> 
> 赞同：0
> 
> 时间：2012-08-05T13:44:41.453
> 
> 标签：javascript, string

我有以下代码（在 Rocket Themed Joomla 站点中），当我添加最后一个标签时，我似乎无法让 Javascript 删除换行符。这是脚本：

```
<head>

<script type="text/javascript">
var d = new Date();
var date = d.getDate();
var day = d.getDay();

function schoolDay5(){
//weekNo = Math.ceil(date/7); //See bottom of the page to see how it works
if (date%2 == 0)
return 2;
else
return 1;
}
window.onload=function(){
var str= "<span class='promo1 ribbon'>" + "Welcome to Stephen Leacock it is day " + schoolDay5()+ "<span>";
document.getElementById('notice').innerHTML=str;
}
</script>
</head>

<body>
<div id="notice"></div>
</body> 
```

当我运行它时，我在最后一个标签上得到一个新行。我怎样才能让这个脚本吐出一行？

这是显示结果的页面：[现在的样子](http://j25.stephenleacock.ca/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T13:50:59.640

在您的 CSS 中，您将 span 元素设置为`display: block;`. 它包含一个跨度也设置为`display: block;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:54:00.693

你得到一个换行符，因为`<span></span>`显示图形（在标题右侧）（.ribbon span）的空白具有CSS样式`display:block`。这会导致它显示在自己的行上。

要解决此问题，请删除`display:block`并添加`float:right`.

```
.ribbon span {background-repeat:no-repeat; padding-right:100px; background-position:100% -205px; min-height:45px; float:right;} 
```

# php - 未显示 PHP 错误

> ID：11816937
> 
> 赞同：0
> 
> 时间：2012-08-05T13:45:30.123
> 
> 标签：php, error-reporting

我有一个包含错误的 PHP 文件，但我不知道它在哪里，也没有错误报告，但我在 php.ini 和脚本中启用了错误报告。

为什么我看不到错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T13:48:34.993

使页面的前四行如下所示：

```
<?php
error_reporting(E_ALL);
ini_set('display_errors', TRUE);
ini_set('display_startup_errors', TRUE); 
```

这将覆盖您在其他地方的错误回显设置，以便您可以追踪您的问题。`phpinfo();`当然，如果您怀疑依赖项丢失或配置错误，请不要忘记执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:51:23.173

尝试在 PHP 中启用错误：

```
<?php
error_reporting(E_ALL);
ini_set('display_errors', TRUE);
ini_set('display_startup_errors', TRUE); 
```

如果您仍然没有看到任何内容并且您使用的是 Linux 和 Apache，请尝试查看`/var/log/apache2/error.log`您可以看到实时日志`tail -f /var/log/apache2/error.log`

# php - 匹配不在一组 URL 类型中的 URL？

> ID：11816944
> 
> 赞同：0
> 
> 时间：2012-08-05T13:46:19.107
> 
> 标签：php, regex, regex-negation

我正在尝试用以下内容替换不是图像或 YouTube 视频的 URL：

```
preg_replace('#(http://([^\s]*)(?<!\.(?:jpg|gif|png))(?<!youtube\.com/watch\?v=\w{11}))#', '<a href = $1> $1 </a>', $output); 
```

**这仍然匹配http://foobar.com/baz.jp** g 和**http://www.youtube.com/watch?v=abcdefghij** k等 URL ，其中粗体部分显示匹配的内容。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T14:03:44.223

您正在使用`[\s]*`which 懒惰地匹配非空格字符。但是，如果以下断言不匹配，它将回溯。所以你必须让它占有欲。

用于`\S*+`这样做。where`\S`表示所有非空格字符（与`[^\s]`实际相同，但更简洁）。并且`+`在`*`量词之后避免了 PCRE 在断言失败的情况下按字符收回。

另见[http://www.regular-expressions.info/possessive.html](http://www.regular-expressions.info/possessive.html)

此外，您最好在该`http://`部分之后移动视频断言，`(?!youtube)`而不是从后面匹配它。Youtube 链接中可能还有其他 URL 参数，所以匹配直到`/watch`

# c# - 具有长搜索模式的正则表达式，其中包含制表符和换行符

> ID：11816945
> 
> 赞同：-2
> 
> 时间：2012-08-05T13:46:36.677
> 
> 标签：c#, regex

我有一个页面[http://www.codesend.com/view/ef460e9fc2346099e040843c6c4d8631/](http://www.codesend.com/view/ef460e9fc2346099e040843c6c4d8631/)。我在我的程序中加载页面的 html。我需要获取这些 (.*?) 模式值，但是当我在 C# 中使用正则表达式尝试它时它不起作用。我认为这是制表符或换行符的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T10:32:26.870

(.*?) 是一个正则表达式组/模式，基本上是说：以非贪婪的方式给出 0 个或多个字符（换行符除外）。非贪婪意味着它会给你最短的结果，那就是 - 什么都没有。

这是正则表达式语法的一个很好的备忘单：http: [//www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/](http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/)

这是一个测试正则表达式的好网站： [http ://regexpal.com/](http://regexpal.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T10:17:15.170

如果是换行符的问题，您是否尝试设置 Singleline Regex 选项？

```
Regex regex = new Regex(yourpattern, RegexOptions.Singleline); 
```

# javascript - 在网页上切换标签 ui、z-index 与显示的最佳方式

> ID：11816946
> 
> 赞同：0
> 
> 时间：2012-08-05T13:46:57.893
> 
> 标签：javascript, performance, tabs, z-index

在 html 中显示\隐藏块的常用方法是切换它的显示属性。但是在渲染性能的情况下，使用z-indexes不是更好吗？

[http://jsfiddle.net/WawVH/](http://jsfiddle.net/WawVH/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T13:56:04.677

真的是偏好问题。Display:none 完全删除元素，我认为它不再是 DOM 结构中的节点，从而节省内存。如果我错了，有人纠正我。

如果您的内容溢出，您的实施可能会遇到问题。

[http://jsfiddle.net/yeQfC/](http://jsfiddle.net/yeQfC/)

但是你总是可以用

```
overflow:hidden; 
```

在您的 .content CSS 定义中

[http://jsfiddle.net/gF3JC/](http://jsfiddle.net/gF3JC/)

# java - 如果我使用 JAX-RS 来实现 Web 应用程序（相对于 Web 服务），您怎么看？

> ID：11816947
> 
> 赞同：2
> 
> 时间：2012-08-05T13:47:23.483
> 
> 标签：java, servlets, jax-rs, restful-url, restful-architecture

我喜欢 JAX-RS 表示 URL 的方式......并且发现它非常易于使用。

我正在考虑让 JAX-RS 工作而不是我的 Servlet，所以我可以编写一些直接与这些 RESTful 资源交互的 JSP...

你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T14:22:52.493

我对 JAX-RS 的第一次体验非常积极。我使用该框架为桌面应用程序提供一些服务器端功能。但是，如果您正在创建一个传统的 Web 应用程序，其中每个客户端操作都会导致用户浏览器加载一个新的网页，那么我不会看到使用 REST 的价值。如果您正在构建 AJAX 应用程序，那么我可以看到 REST 可能比 Servlet 更易于编码。

项目的性质是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:56:33.343

这不是关于您的模型编程的决定，而是关于您的应用程序的架构和要求的决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T08:28:35.957

实际上，当您的 JAX-RS 使用 HTTP 请求时，servlet 甚至使用 PHP/HTML 前端都没有关系。我建议您使用 JAX-RS 参考实现来构建 RESTful Web 服务调用[jersey](http://jersey.java.net/)。它提供了更多的好东西..

# r - 方差不等的参数方差分析

> ID：11816948
> 
> 赞同：3
> 
> 时间：2012-08-05T13:47:29.127
> 
> 标签：r, anova

我想知道 R 中是否有办法进行方差不等的方差分析？

想象以下示例：

```
x <- c(10,11,15,8,16,12,20)
y <- c(10,14,18,25,28,30,35)

d <- c(x,y)
f <- as.factor(c(rep("a",7), rep("b",7)))

# Unequal variance:

t.test(x,y)$p.value
t.test(d~f)$p.value

# Equal variance:

t.test(x,y, var.equal=TRUE)$p.value
t.test(d~f, var.equal=TRUE)$p.value

anova(lm(d~f))[[5]]
summary(aov(lm(d~f)))[[1]][5]
summary(lm(d~f))[[4]][8] 
```

正如您从这个示例中看到的那样，在 R 中执行 ANOVA 的不同方法，仅在两组的情况下，总是会产生一个与 t.test 获得的相同的 p 值，具有相等的方差。同样，有没有办法执行方差不等的方差分析？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T13:53:43.363

对于这种情况，有`oneway.test()`

```
R> oneway.test(d~f)

    One-way analysis of means (not assuming equal variances)

data:  d and f 
F = 6.631, num df = 1.000, denom df = 8.339, p-value = 0.03179 
```

# jquery - 我在哪里可以下载旧版本的 AnythingSlider？

> ID：11816958
> 
> 赞同：1
> 
> 时间：2012-08-05T13:48:59.467
> 
> 标签：jquery, html, css, internet-explorer, anythingslider

在[AnythingSlider 文档](https://github.com/ProLoser/AnythingSlider/wiki/Setup#wiki-version)中，有一个关于让AnythingSlider 与旧的JQuery 库一起工作的参考资料，但我找不到任何地方可以下载旧版本的AnythingSlider。有谁知道在哪里可以找到 AnythingSlider 以前的版本？

我想要使​​用 JQuery 1.3.2 的早期版本之一。

*原因*

我被迫在当前项目中使用 JQuery 1.3.2，并且一直使用 noConflict 与现代 JQuery 一起运行它。但是，我遇到了一些现代脚本根本没有在 Internet Explorer 中运行的问题（并且仅在 Internet Explorer 中）。这包括 AnySlider。我想尝试在没有现代 JQuery 的情况下运行旧版本的滑块，看看这是否有助于解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T14:07:37.303

来自[https://github.com/CSS-Tricks/AnythingSlider/tree/v1.8.6](https://github.com/CSS-Tricks/AnythingSlider/tree/v1.8.6)

如果您单击按钮`tag: v1.8.6`并搜索，`tags`您可以浏览和下载来自 AnythingSlider 的所有版本

# html - HTML 演示工具包

> ID：11816962
> 
> 赞同：0
> 
> 时间：2012-08-05T13:49:38.927
> 
> 标签：html, presentation

我见过很多这样的 HTML 演示文稿：

1.  [http://estelle.github.com/mobileperf/](http://estelle.github.com/mobileperf/)
2.  [http://slides.html5rocks.com](http://slides.html5rocks.com)
3.  [http://html5apps-io2010.appspot.com](http://html5apps-io2010.appspot.com)
4.  [http://www.igvita.com/slides/2012/wordpress-performance/](http://www.igvita.com/slides/2012/wordpress-performance/)

我想知道用于创建此类演示文稿的特定工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T14:04:34.107

也许你应该试试[滑坡](https://github.com/adamzap/landslide)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-13T08:53:39.550

您必须尝试[使用​​ HTLM5 pageforest](http://html5slides.pageforest.com/)来创建带有即时幻灯片预览的精美演示文稿

# iphone - 如何水平重复精灵？

> ID：11816963
> 
> 赞同：5
> 
> 时间：2012-08-05T13:49:40.357
> 
> 标签：iphone, objective-c, ipad, cocos2d-iphone, textures

我有重复 X- 和 Y- 的代码，即：

```
 bg = [CCSprite spriteWithFile:@"ipadbgpattern.png" rect:CGRectMake(0, 0, 3000, 3000)];
        bg.position = ccp(500,500);
        ccTexParams params = {GL_LINEAR,GL_LINEAR,GL_REPEAT,GL_REPEAT};
        [bg.texture setTexParameters:&params];
        [self addChild:bg]; 
```

但是，我不知道如何更改参数以使背景沿水平轴重复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T23:22:28.163

没有参数。只需确保 CGRect 跨越您希望纹理重复的区域，并且纹理本身必须是 2 的幂（即 1024x1024）。

我猜也许您使用的是 1024x768 纹理，然后您会看到纹理重复之间的间隙。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-25T06:03:51.303

这在 GL 级别无法实现，因为 GL_REPEAT 需要具有二维幂的纹理。

看看我的 TiledSprite 类，了解一个相当未优化但功能性的任意重复任意大小的纹理或子纹理的方法：

[https://gist.github.com/Nolithius/6694990](https://gist.github.com/Nolithius/6694990)

下面简要介绍一下它的结果和用法：

[http://www.nolithius.com/game-development/cocos2d-iphone-repeating-sprite](http://www.nolithius.com/game-development/cocos2d-iphone-repeating-sprite)

# c++ - 什么是 Base*(*)()

> ID：11816964
> 
> 赞同：2
> 
> 时间：2012-08-05T13:49:40.900
> 
> 标签：c++, templates, stl

有人可以为我解释一下**Base*(*)()**吗：

`typedef std::map<std::string, Base*(*)()> map_type;`

以及如何从函数中返回它？

我假设它是一个函数指针，返回一个 Base*，但这是什么 (*)。

我在下面的 SO 帖子中发现了这一点。[有没有办法从保存类名的字符串中实例化对象？](https://stackoverflow.com/questions/582331/is-there-a-way-to-instantiate-objects-from-a-string-holding-their-class-name)

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T13:51:21.200

`Base* (*)()`是一种类型：指向函数返回的指针`Base*`。这`*`意味着它是一个指针，并且`()`用于覆盖优先级以确保指针适用于函数本身而不是返回类型。

您可以通过返回适当类型的函数的名称从函数中返回它。

例如

```
Base* f();

Base* (*g())()
{
    return f;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-05T13:52:29.587

它是签名函数的函数指针的类型`Base*()`：

```
Base * foo();

Base * (*fp)() = &foo; 
```

或者在你的情况下：

```
map_type callbacks;
callbacks["Foo"] = &foo; 
```

调用：

```
Base * p = callbacks["Foo"]();  // same as "p = foo();" 
```

# wordpress - 机器人如何在 WordPress 的类别列表中获取后续页面的内容？

> ID：11816965
> 
> 赞同：0
> 
> 时间：2012-08-05T13:49:44.057
> 
> 标签：wordpress, http, bots

我正在编写一个机器人来自动从我的 WordPress 博客下载页面。该机器人可以毫无问题地获取大部分页面。例如，它可以轻松获取给定标签的文章列表的第一页：[http](http://example.com/myblog/index.php/archives/tag/mytag) ://example.com/myblog/index.php/archives/tag/mytag 。但是，由于某种原因，它无法获取后续页面，例如[http://example.com/myblog/index.php/archives/tag/mytag/page/2](http://example.com/myblog/index.php/archives/tag/mytag/page/2)。

我试图弄清楚发生了什么事，这就是我发现的：虽然服务器正常响应大多数请求，但在此类请求时，它会以 301 永久重定向进行响应。特别是，Location 标头设置为与请求完全相同的 URL！[基本上，服务器告诉我将我对页面http://example.com/myblog/index.php/archives/tag/mytag/page/2](http://example.com/myblog/index.php/archives/tag/mytag/page/2)的请求重定向到...相同的页面：P

当尝试从浏览器访问该页面时，我可以毫无问题地获得该页面。我想也许浏览器会发送一些我的机器人没有发送的标头（包括 cookie），所以我从浏览器的 Web 控制台复制了标头（包括 cookie），但行为没有改变。

我将不胜感激有关可能导致这种奇怪行为的任何建议，我可以做些什么来更好地了解正在发生的事情，当然还有我可以做些什么来自动获取这些页面，就像我获取他们的兄弟一样。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T01:09:09.770

看来这篇文章并没有引起太大的公众兴趣。但是，如果有人遇到同样的问题并找到这篇文章，这是我使用的解决方案。重要提示：我仍然不理解我目睹的行为，如果有人能解释它，我将不胜感激。

所以我找到的解决方案基本上是使用 URL [http://example.com/myblog/archives/tag/mytag?paged=2](http://example.com/myblog/archives/tag/mytag?paged=2)而不是[http://example.com/myblog/index.php/archives/标签/mytag/page/2](http://example.com/myblog/index.php/archives/tag/mytag/page/2)。有趣的是，当从浏览器浏览该 URL 时，该 URL 会被重定向到原始 URL！但是当机器人请求它时，它得到的页面没有重定向或任何东西。（所以我设法做我想做的事，但我不知道那里发生了什么，为什么首先会出现问题，以及为什么这个解决方案有效：对于一个 URL，机器人获得无限重定向，浏览器只是获取页面，而对于另一个浏览器被重定向 [finitely] 并且机器人获取页面。我还没有弄清楚这个......）

# android - SurfaceView & 碰撞

> ID：11816966
> 
> 赞同：0
> 
> 时间：2012-08-05T13:49:45.430
> 
> 标签：android, surfaceview

在 BrickBreaker 游戏中，我有以下代码来检查球与杆的碰撞：

```
if(ball.x + ball.getWidth() > bar.x && ball.x < bar.x + (bar.getWidth()/5)) {
        ...
    }

    else if(ball.x + ball.getWidth() > bar.x + (bar.getWidth()/5) && ball.x < bar.x + (2*bar.getWidth()/5)) {
        ...
    }

    else if(ball.x + ball.getWidth() > bar.x + (2*bar.getWidth()/5) && ball.x < bar.x + (3*bar.getWidth()/5)) {
        ...
    }

    else if(ball.x + ball.getWidth() > bar.x + (3*bar.getWidth()/5) && ball.x < bar.x + (4*bar.getWidth()/5)) {
        ...
    }

    else if(ball.x + ball.getWidth() > bar.x + (4*bar.getWidth()/5) && ball.x < bar.x + bar.getWidth()) {
        ...
    } 
```

但如果球没有击中横杆，它会说，发生了碰撞。我的碰撞检查出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T14:18:02.187

> 我的碰撞检查出了什么问题？

奇怪的数学。检查此[圆矩形碰撞检测（交叉点）](https://stackoverflow.com/questions/401847/circle-rectangle-collision-detection-intersection)

# javascript - 对象文字中带引号和不带引号的键有什么区别

> ID：11816967
> 
> 赞同：-3
> 
> 时间：2012-08-05T13:49:50.860
> 
> 标签：javascript

> **可能重复：**
> [带引号和不带引号的对象键有什么区别？](https://stackoverflow.com/questions/4348478/what-is-the-difference-between-object-keys-with-quotes-and-without-quotes)

我主要通过使用 JavaScript 来了解它，但有些东西我还不明白。

这两个对象字面量有什么区别：

```
var obj1 = {
   myProp: '123'
};

var obj2 = {
   'myProp': '123'
}; 
```

它们只是“同义词”，还是有细微的差别？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T13:55:55.467

在对象初始值设定项语法中，键可以是数字文字、标识符或字符串。

```
var obj1 = {
    1e9: "123" //valid because it's a numeric literal
}

var obj2 = {
    $_ASd: "123" //Valid because it's a valid identifier I.E. you could make a variable called $_Asd
}

var obj3 = {
    $ hello world: "123" //invalid because it's not an identifier, I.E. you could not make a variable called $ hello world
}

var obj4 = {
    '$ hello world': "123" //valid because it's a valid string
} 
```

之后，无论它在语法中是什么，键都会变成一个字符串，所以在`1e9`键的情况下将是一个字符串`"1000000000"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:51:48.797

当里面没有操作员时什么都没有。

```
var obj1 = {
   my+Prop: '123' // illegal
};

var obj2 = {
   'my+Prop': '123' // legal
}; 
```

# java - Java 的最佳集成脚本语言？（堆栈跟踪和调试）

> ID：11816976
> 
> 赞同：2
> 
> 时间：2012-08-05T13:51:23.040
> 
> 标签：java, jvm, jsr223

我需要在运行时提供代码片段。

为了使其正常工作，我基本上需要调用脚本语言，然后再调用*Java*。为了使它在调试场景中可用，StackTraces 也必须可用（因此方法和行号直接进入脚本源，就像在现代 JSP 页面中一样）并且异常必须正确冒泡。

哪些脚本语言（在运行时读取源代码）可以提供此功能？JSR-223 支持是一个奖励。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T09:49:31.233

我认为 JRuby 是最佳选择，因为：

1.  它作为脚本语言的性能很好。
2.  它可以在两种模式下执行（编译，解释）。
3.  它支持 Ruby on Rails，您可以在生产环境中使用 JRuby for Rails 应用程序。
4.  您可以不受任何限制地轻松调用 Java 平台的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T09:52:01.557

我认为 Groovy 将非常适合您的情况，因为它具有超级相似性并且易于与 Java 集成，更不用说它几乎是最成熟的 JVM 语言，并得到了[SpringSource](http://www.springsource.org/)之类的出色支持。

作为 JSR 支持的一个例子，[Groovy 有它](http://groovy.codehaus.org/JSR+223+Scripting+with+Groovy)。

# javascript - 如何保持 JavaScript Web 应用程序的状态？

> ID：11816984
> 
> 赞同：0
> 
> 时间：2012-08-05T13:52:52.053
> 
> 标签：javascript, client-side

假设我正在用 JavaScript 编写一个简单的单页 Web 应用程序。该应用程序仅显示员工记录。用户输入搜索参数，应用程序使用 AJAX 从服务器获取员工记录并将其显示在网页中。

应用程序状态为`search params`和`employees`。如何将它们存储在应用程序中？我看到两个选项：

*   只需使用 DOM 隐式存储状态。
*   为 DOM 创建数据结构`search params`并将`employees`它们与 DOM 同步。

是否有意义？这两种选择的优缺点是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T02:37:17.007

*   在这种情况下，您可以在用户应用过滤器时触发哈希值的更改。例如： [http://www.mydomain.com/index.html#name=abc&department=def](http://www.mydomain.com/index.html#name=abc&department=def)。您的应用程序会侦听哈希中的更改以进行相应更新。像[crossroads.js](http://millermedeiros.github.com/crossroads.js/)，[sammy.js](http://sammyjs.org/)这样的库允许你这样做。客户端的这种方法借用了服务器端的路由概念。

*   使用这种方法，您可以将 url 发送给您的朋友以直接“跳转”到应用程序的特定状态，您还可以重复使用它，将其存储在任何地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T13:58:07.893

如果您的目标是现代浏览器，那么 Web Storage 将是您研究的一个不错的选择。

在这里写得很好：http: [//sixrevisions.com/html/introduction-web-storage/](http://sixrevisions.com/html/introduction-web-storage/)

这样，所有负载都将保留在客户端中，并且数据将在请求之间以及用户离开并返回应用程序时持续存在。

我猜您提到的选项意味着您将在隐藏的 DOM 元素中存储数据将很容易开发，但是您将失去所有持久性。如果您打算走这条路，为什么不直接将数据存储在 javascript 对象中呢？

另一个好读物：[http ://diveintohtml5.info/storage.html](http://diveintohtml5.info/storage.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T13:59:49.973

如果你想让它们持久化，你就不能使用 DOM，你也不应该使用。HTML 用于您的用户界面并将所有内容链接在一起，而不是用于应用程序的数据存储。你有几个选择。您可以在 JavaScript 中使用全局变量，但您必须记住，它们*不会*在访问您的页面之间持续存在。如果这是您想要的，请继续。

另一种选择是使用 HTML5 的本地存储，它是持久的，专为存储数据而设计。

您的最后一个选项（如果您不想在本地存储数据但确实想持久保存数据，这一点很重要）是使用 HTTP AJAX GET 和 POST 与 servlet 或客户端上分别获取和设置数据的东西.

如果你想走老路，你也可以使用 cookie 代替 Web 存储。我绝对建议后者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T14:00:19.383

如果您使用 HTML 5，您可能会考虑使用这种杠杆作用：

[http://www.jstorage.info/](http://www.jstorage.info/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-05T14:00:52.260

肯定是后者。DOM 从未被设计为数据结构。另一方面，创建一个架构以使 DOM 与您的自定义数据结构保持同步可能会很痛苦。

幸运的是，有一些框架可以帮助您解决这个问题。其中大多数遵循类似 MVC（或 MV*）的设计模式。示例包括[Backbone.js](http://documentcloud.github.com/backbone/)、[AngularJS](http://angularjs.org/)、[Spine](http://spinejs.com/)、[Agility.js](http://agilityjs.com/)、[JavaScriptMVC](http://javascriptmvc.com/)等等。周围看看。

还可以查看这个项目：[TodoMVC](http://addyosmani.github.com/todomvc/)。它可能会帮助您决定是否使用这样的框架，如果是的话，使用哪一个。

# python - 如何将 Django-dev 从 pip 添加到站点包？

> ID：11816988
> 
> 赞同：0
> 
> 时间：2012-08-05T13:53:40.180
> 
> 标签：python, django, configuration, pip, egg

我安装了 Django

> C:\Python27\Lib\site-packages> **pip install -e** git+https://github.com/django/django.git#egg=django

不幸的是，当您的包位于 site-packages 目录中时，某些程序（例如 PyDev）“更容易”工作。

**如何强制 pip 将其安装在站点包中，而不是只提供一个`Django.egg-link`文件？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T14:45:33.783

这里有两件事。

*   首先，您需要摆脱 -e ，除非您打算对 django 本身进行黑客攻击。见这里：[http ://www.pip-installer.org/en/latest/usage.html#edit-mode](http://www.pip-installer.org/en/latest/usage.html#edit-mode)
*   同样使用 pydev，您通常需要告诉它在安装新内容后重新索引您的站点包。为此，您需要进入解释器设置并为当前项目选择解释器。IIRC 你可以打开它，点击应用，它会重新索引你的站点包。

希望有帮助:)

# php - 我将如何对这个数组进行排序

> ID：11816990
> 
> 赞同：0
> 
> 时间：2012-08-05T13:53:42.867
> 
> 标签：php, arrays, sorting

> **可能重复：**
> [如何对这段代码的结果进行排序？](https://stackoverflow.com/questions/11809077/how-to-sort-the-results-of-this-code)

我制作了一个搜索功能，允许用户搜索一个问题，它将通过计算问题中匹配单词的数量来显示前 5 个最佳匹配结果。基本上我希望订单首先显示最佳匹配，这将是匹配单词数量最多的问题。
这是我的代码。

```
<?php
include("config.php");
$search_term = filter_var($_GET["s"], FILTER_SANITIZE_STRING); //User enetered data
$search_term = str_replace ("?", "", $search_term); //remove any question marks from string
$search_count = str_word_count($search_term);  //count words of string entered by user
$array = explode(" ", $search_term); //Seperate user enterd data

foreach ($array as $key=>$word) {
$array[$key] = " title LIKE '%".$word."%' "; //creates condition for MySQL query
}

$q = "SELECT * FROM posts WHERE  " . implode(' OR ', $array); //Query to select data with word matches
$r = mysql_query($q);
$count = 0; //counter to limit results shown
    while($row = mysql_fetch_assoc($r)){
        $thetitle = $row['title']; //result from query
        $thetitle = str_replace ("?", "", $thetitle);  //remove any question marks from string
        $title_array[] = $thetitle;  //creating array for query results
        $newarray = explode(" ", $search_term); //Seperate user enterd data again
            foreach($title_array as $key => $value) {
                $thenewarray = explode(" ", $value); //Seperate each result from query
                $wordmatch = array_diff_key($thenewarray, array_flip($newarray));
                $result = array_intersect($newarray, $wordmatch);
                $matchingwords = count($result); //Count the number of matching words from
                                                 //user entered data and the database query
            }

if(mysql_num_rows($r)==0)//no result found
    {
    echo "<div id='search-status'>No result found!</div>";
    }
else //result found
    {
    echo "<ul>";
        $title = $row['title'];
        $percentage = '.5'; //percentage to take of search word count
        $percent = $search_count - ($search_count * $percentage); //take percentage off word count
        if ($matchingwords >= $percent){
        $finalarray = array($title => $matchingwords);

        foreach( $finalarray as $thetitle=>$countmatch ){

?>
    <li><a href="#"><?php echo $thetitle ?><i> &nbsp; <br />No. of matching words: <?php echo $countmatch; ?></i></a></li>
<?php

                }
                $count++;
        if ($count == 5) {break;
        }
                }else{

            }
    }
echo "</ul>";
} 
```

?>
当您搜索某些内容时，它会显示类似这样的内容。
![在此处输入图像描述](../Images/dd2307fe47ca266979687e125f975cea.png)
Iv 将匹配单词的数量放在每个问题下，但它们不按顺序排列。它仅显示数据库中具有 50% 单词匹配的前 5 个问题。我希望它显示匹配词最多的前 5 个。
我需要添加什么代码，我应该把它放在哪里才能做到这一点？
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T14:50:31.723

这是我对你的问题的看法。很多东西都变了：

*   `mysql_`[用PDO](http://us.php.net/pdo)替换的功能
*   使用匿名函数意味着需要 PHP 5.3
*   主要逻辑已被重组（很难跟踪您的结果处理，所以我可能会遗漏您需要的东西，例如那个点`$percentage`）

我意识到这可能看起来很复杂，但我认为你越早学习现代实践（PDO、匿名函数），你就会越好。

```
<?php
/**
 * @param string $search_term word or space-separated list of words to search for
 * @param int $count
 * @return stdClass[] array of matching row objects
 */
function find_matches($search_term, $count = 5) {
    $search_term = str_replace("?", "", $search_term);
    $search_term = trim($search_term);
    if(!strlen($search_term)) {
        return array();
    }
    $search_terms = explode(" ", $search_term);

    // build query with bind variables to avoid sql injection
    $params = array();
    $clauses = array();

    foreach ($search_terms as $key => $word) {
        $ident = ":choice" . intval($key);
        $clause = "`title` LIKE {$ident}";
        $clauses []= $clause;
        $params [$ident] = '%' . $word . '%';
    }

    // execute query
    $pdo = new PDO('connection_string');
    $q = "SELECT * FROM `posts` WHERE  " . implode(' OR ', $clauses);
    $query = $pdo->prepare($q);
    $query->execute($params);
    $rows = $query->fetchAll(PDO::FETCH_OBJ);

    // for each row, count matches
    foreach($rows as $row) {
        $the_title = $row->title;
        $the_title = str_replace("?", "", $the_title);

        $title_terms = explode(" ", $the_title);
        $result = array_intersect($search_terms, $title_terms);
        $row->matchcount = count($result);
    }

    // sort all rows by match count descending, rows with more matches come first
    usort($rows, function($row1, $row2) {
        return - ($row1->matchcount - $row2->matchcount);
    });

    return array_slice($rows, 0, $count);
}
?>

<?php
    $search_term = filter_var($_GET["s"], FILTER_SANITIZE_STRING);
    $best_matches = find_matches($search_term, 5);
?>

<?php if(count($best_matches)): ?>
    <ul>
    <?php foreach($best_matches as $match): ?>
        <li><a href="#"><?php echo htmlspecialchars($match->title); ?><i> &nbsp; <br/>No. of matching words: <?php echo $match->matchcount; ?></i></a></li>
    <?php endforeach; ?>
    </ul>
<?php else: ?>
    <div id="search-status">No result found!</div>
<?php endif; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:58:01.707

尝试`asort($finalarray);`在`$finalarray = array($title => $matchingwords);`声明后添加：

```
...

if ($matchingwords >= $percent){
    $finalarray = array($title => $matchingwords);
    asort($finalarray);

.... 
```

它应该按值对数组进行升序排序

# c++ - void 类型如何处理递归回溯返回

> ID：11816994
> 
> 赞同：2
> 
> 时间：2012-08-05T13:54:15.833
> 
> 标签：c++, recursion, void, backtracking, recursive-backtracking

为了概括这个问题，我从 Zelenski CS 课程讲义中借用了材料。而且，这与我的具体问题有关，因为几年前我从不同的讲师那里上课并学习了这种 C++ 方法。讲义在[这里](http://see.stanford.edu/materials/icspacs106b/H19-RecBacktrackExamples.pdf)。由于我偶尔使用它，因此我对 C++ 的理解很低。基本上，有几次我需要编写一个程序，我回到课堂材料，找到类似的东西并从那里开始。

在此示例中（第 4 页），Julie 正在字符串函数中使用递归算法查找单词。为了减少递归调用的次数，她添加了一个决策点`bool containsWord()`。

```
string FindWord(string soFar, string rest, Lexicon &lex)
{
  if (rest.empty()) {
   return (lex.containsWord(soFar)? soFar : "");
  } else {
   for (int i = 0; i < rest.length(); i++) {
     string remain = rest.substr(0, i) + rest.substr(i+1);
     string found = FindWord(soFar + rest[i], remain, lex);
     if (!found.empty()) return found;
   }
  }
 return ""; // empty string indicates failure
} 
```

为了增加如何使用该算法的灵活性，可以将其实现为 void 类型吗？

```
void FindWord(string soFar, string rest, Lexicon &lex, Set::StructT &words)
{
  if (rest.empty()) {
    if (lex.containsWord(soFar)) //this is a bool
       updateSet(soFar, words); //add soFar to referenced Set struct tree
  } else {
   for (int i = 0; i < rest.length(); i++) {
     string remain = rest.substr(0, i) + rest.substr(i+1);
     return FindWord(soFar + rest[i], remain, lex, words); //<-this is where I am confused conceptually
   }
  }
 return; // indicates failure
} 
```

而且，没有回报怎么办

```
void FindWord(string soFar, string rest, Lexicon &lex, Set::StructT &words)
{
  if (rest.empty()) {
    if (lex.containsWord(soFar)) 
       updateSet(soFar, words); //add soFar to Set memory tree
  } else {
   for (int i = 0; i < rest.length(); i++) {
     string remain = rest.substr(0, i) + rest.substr(i+1);
     FindWord(soFar + rest[i], remain, lex, words); //<-this is where I am confused conceptually
   }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T15:13:36.770

第一个代码片段将尝试 的所有排列`rest`，附加到 的初始值`soFar`（可能是一个空字符串？）。它将在找到的第一个单词处停止`lex`。找到该单词后将立即返回，此时搜索将被缩短。如果没有 in ，当所有循环都运行到`lex`最后时，最终将返回空字符串。`for`

第二个片段只会尝试一个词：初始`soFar`和`rest`字符串的连接。如果那个连接的字符串是 in `lex`，它会`updateSet`用它调用。然后它会返回，表示失败。不会执行进一步的搜索，因为循环`return`内部的 from是无条件的。`for`

所以这两个功能是完全不同的。要使第二个代码的行为与第一个代码一样，您需要它返回其他内容以指示成功，并且仅在调用返回值指示成功`for`时从循环内返回。`FindWord`显然，`void`不能用于信号`failure`和`success`。至少，您需要为此返回`bool`值。

如果没有返回，您的第三个代码将执行详尽的搜索。`rest`将尝试在词典中查找初始字符串值的每个可能的排列。

您可以像这样想象正在发生的事情：

```
FindWord:   soFar=""     rest=...........
    for:    i=...    rest[i]=a
       call findWord

FindWord:   soFar=a       rest=..........
    for:    i=...    rest[i]=b
       call findWord

FindWord:   soFar=ab       rest=.........
    for:    i=...    rest[i]=c
       call findWord
       if return, the loop will be cut short
       if not, the loop continues and next i will be tried

 ......

FindWord:   soFar=abcdefgh...      rest=z
    for:    i=0      rest[0]=z
       call findWord

FindWord:   soFar=abcdefgh...z      rest=""      // base case
    // for:    i=N/A    rest[i]=N/A
    if soFar is_in lex                           // base case
      then do_some and return soFar  OR  success
      else             return ""     OR  failure 
```

每次达到基本情况（`rest`为空）时，我们都会`n+1` `FindWord`在堆栈上调用帧，用于初始字符串`n`中的字母。`rest`

每次我们触底时，我们都会从 中挑选出所有的字母`rest`。执行检查以查看它是否在 中`lex`，然后控制返回上一级。

因此，如果没有返回，则每个`for`循环都会运行到结束。如果返回是无条件的，则只会尝试一种排列 - 微不足道的排列。但是如果返回是有条件的，那么整个事情只会在第一次成功时停止。

# operating-system - 支持虚拟内存的硬件上的非 VM 操作系统

> ID：11816995
> 
> 赞同：0
> 
> 时间：2012-08-05T13:54:35.860
> 
> 标签：operating-system, cpu, cpu-architecture, virtual-memory

是否可以在支持虚拟内存的硬件上使用不支持虚拟内存的操作系统？

换句话说，如果硬件使用虚拟内存系统，操作系统是否一定需要支持虚拟内存？

例如，据我所知，MS-DOS 不支持虚拟内存，但是它运行在支持虚拟内存的 x86 处理器上

反之亦然，是否可以在不支持虚拟内存的硬件上使用支持虚拟内存的操作系统？

比如嵌入式linux使用虚拟内存，部署在ARM、MIPS、SuperH、AVR等多种架构上；他们都支持虚拟内存系统吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T13:59:17.320

硬件*支持*虚拟内存，这并不意味着你必须使用它。操作系统*支持*虚拟内存，这并不意味着它们必须使用它。

# iphone - 在 TTLauncherView 中加载更多页面

> ID：11816997
> 
> 赞同：0
> 
> 时间：2012-08-05T13:54:46.223
> 
> 标签：iphone, objective-c, ios, xcode, three20

在我的 TTLauncherView 实现中，只加载第一页。为什么？

我有 47 个项目，47 个项目 div 9 个项目，我应该有 6 页。

感谢您的帮助。

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection {      

NSMutableString *jsonString = [[NSMutableString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];
NSDictionary *results = [jsonString JSONValue];

NSArray *photos = [[results objectForKey:@"photosets"] objectForKey:@"photoset"];

launcherView = [[TTLauncherView alloc] initWithFrame:self.view.bounds];
launcherView.backgroundColor = [UIColor whiteColor];
launcherView.delegate = self;
launcherView.columnCount = 3;

launcherView.persistenceMode = TTLauncherPersistenceModeNone;
NSMutableArray *itemArray = [[NSMutableArray alloc] init];
for (NSDictionary *photo in photos)   
{

     NSString *iconURLString = [NSString stringWithFormat:@"http://farm%@.static.flickr.com/%@/%@_%@_s.jpg", 
     [photo objectForKey:@"farm"], [photo objectForKey:@"server"], [photo objectForKey:@"primary"], [photo objectForKey:@"secret"]];

     NSDictionary *title = [photo objectForKey:@"title"];
     NSString *itemTitle = [title objectForKey:@"_content"];
     TTLauncherItem *itemMenu = [[[TTLauncherItem alloc] initWithTitle:itemTitle
                                                                 image:iconURLString
                                                                   URL:nil 
                                                             canDelete:NO] autorelease];

     [itemArray addObject:itemMenu];     

}

launcherView.pages = [NSArray arrayWithObject: itemArray];
[self.view addSubview:launcherView];  

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T13:57:22.933

我修改后的代码带有@Darren 的提示

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection {      

NSMutableString *jsonString = [[NSMutableString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];    
NSDictionary *results = [jsonString JSONValue];    
NSArray *photos = [[results objectForKey:@"photosets"] objectForKey:@"photoset"];
NSMutableArray *itemArray = [[NSMutableArray alloc] init];
NSMutableArray *pageArray = [[NSMutableArray alloc] init];
NSNumber *countPage = [[NSNumber alloc] initWithInt:0];

for (NSDictionary *photo in photos)   
{

    NSString *iconURLString = [NSString stringWithFormat:@"http://farm%@.static.flickr.com/%@/%@_%@_s.jpg", 
                               [photo objectForKey:@"farm"], [photo objectForKey:@"server"], [photo objectForKey:@"primary"], [photo objectForKey:@"secret"]];

    NSString *photoCount = [photo objectForKey:@"photos"];
    NSDictionary *title = [photo objectForKey:@"title"];
    NSString *itemTitle = [title objectForKey:@"_content"];
    TTLauncherItem *itemMenu = [[[TTLauncherItem alloc] initWithTitle:itemTitle
                                                                image:iconURLString
                                                                  URL:nil 
                                                            canDelete:NO] autorelease];
    itemMenu.badgeValue = photoCount; 

    [itemArray addObject:itemMenu];
    int value = [countPage intValue];
    countPage = [NSNumber numberWithInt:value + 1];
    if (countPage == [NSNumber numberWithInt:9]){
       countPage = [NSNumber numberWithInt:0]; 
       [pageArray addObject:itemArray];
        itemArray = [[NSMutableArray alloc] init];

    }

}
[pageArray addObject:itemArray];

launcherView = [[TTLauncherView alloc] initWithFrame:self.view.bounds];
launcherView.backgroundColor = [UIColor blackColor];
launcherView.delegate = self;
launcherView.columnCount = 3;    
launcherView.persistenceMode = TTLauncherPersistenceModeNone;    
launcherView.pages = pageArray;    
[self.view addSubview:launcherView];      

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T14:27:46.640

我记得，TTLauncherView 不会自动将 TTLauncherItem 分解为页面。你需要一个数组数组。第一个数组中的所有启动器项目都将在第一页上，第二个数组中的所有启动器项目将在第二页上等等。我已经很长时间没有使用它了，但我认为就是这样有效。

# x86 - 内存重新排序：可以将加载与较早的存储重新排序到不同但包含的位置吗？

> ID：11816998
> 
> 赞同：3
> 
> 时间：2012-08-05T13:54:52.883
> 
> 标签：x86, intel, memory-model, memory-barriers

在英特尔的处理器手册：第 8.2.3.4 节中的[链接中，声明可以将负载重新排序，早期存储到不同位置，但不能将早期存储重新排序到相同位置。](http://download.intel.com/products/processor/manual/253668.pdf)

所以我明白以下两个操作可以重新排序：

```
x = 1;
y = z; 
```

并且以下两个操作不能重新排序：

```
x = 1;
y = x; 
```

但是当存储和负载位于不同的位置时会发生什么，但负载完全包含存储，例如：

```
typedef union {
  uint64_t shared_var;
  uint32_t individual_var[2];
} my_union_t;

my_union_t var;
var.shared_var = 0;

var.individual_var[1] = 1;
int y = var.shared_var; 
```

那么在这种情况下'y'可以为0吗？

**编辑**（@Hans Passant）为了进一步解释这种情况，我试图看看我是否可以使用这种技术在不使用锁定指令的情况下设计一种线程之间的准同步。

所以一个更具体的问题是，给定一个全局变量：

```
my_union_t var;
var.shared_var = 0; 
```

两个线程执行以下代码：

线程 1：

```
var.individual_var[0] = 1;
int y = __builtin_popcountl(var.shared_var); 
```

线程 2：

```
var.individual_var[1] = 1;
int y = __builtin_popcountl(var.shared_var); 
```

'y' 可以为两个线程都为 1 吗？

注意：__builtin_popcountl 是内置的 gcc 内在函数，用于计算变量中设置的位数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-06-01T01:46:19.730

你最后也是最重要的问题¹：

> 两个线程执行以下代码：
> 
> 线程 1：
> 
> ```
> var.individual_var[0] = 1;
> int y = __builtin_popcountl(var.shared_var); 
> ```
> 
> 线程 2：
> 
> ```
> var.individual_var[1] = 1;
> int y = __builtin_popcountl(var.shared_var); 
> ```
> 
> 'y' 可以为两个线程都为 1 吗？

是的，它可以，但如果不测试芯片是否会真正做到这一点，这并不明显，因为 SDM 中没有涵盖重叠读取。

这种情况基本上是 8.2.3.4（存储缓冲）和 8.2.3.5（存储转发）情况的组合。部分结果可能来自当前本地存储，而其余结果必须来自全局可见存储（即，来自“内存”）。

CPU 可以为您`1`提供两个线程的结果吗？*是*的 - 一些当前的英特尔 CPU 将满足来自存储缓冲区的部分负载，以及来自 L1 的其余负载，但由于*两个*存储都尚未成为全局可见的（仍然位于存储缓冲区中），您可以进入`var.iv[0] == 1 && var.iv[1] == 0`线程1和`var.iv[0] == 0 && var.iv[1] == 1`线程2。

用户 Alex 实际上为此编写了测试代码，并在这个[非常相关的答案](https://stackoverflow.com/a/39007998/149138)中进行了演示。所以不，这里没有魔术：你不能像这样在所有 CPU 上构建自己的无锁同步。

顺便说一句：这*可能*适用于某些 CPU！在存在部分存储转发的情况下，一些模型可能会采取简单的做法，只是等到存储提交到 L1，然后从 L1 中读取整个值。在这种情况下，你的伎俩会奏效......但它最终不会让你买太多。您必须等待整个存储缓冲区耗尽，这是内存栅栏的主要成本！所以你得到了内存栅栏效应，最多是一个内存栅栏大小的停顿。

* * *

¹前面单线程的答案*“那么'y'在这种情况下可以为0吗？”* case 显然是“不”——CPU 将保持按顺序执行的错觉，所以如果你写了一些东西并立即读回它，你总是会看到写的（没有其他线程写相同的位置），不管如何写入和读取重叠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T17:44:41.673

CPU 不知道也不关心您是否为内存位置设置了别名。因此，您的第一个问题的答案是“否”。

第二个示例中的写入未同步，因此，是的，线程可能拥有自己的数据副本。

您没有问的问题（“我应该实现和使用自定义同步原语吗？”）的答案是“不”。