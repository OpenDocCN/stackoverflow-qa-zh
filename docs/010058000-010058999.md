# StackOverflow 问答 10058000-10058999

# architecture - Umbraco - 将内容放在网站节点之外？

> ID：10058005
> 
> 赞同：1
> 
> 时间：2012-04-07T20:19:59.497
> 
> 标签：architecture, umbraco

我正在尝试使用 Umbraco 重新创建一个网站。对于这个网站，我将*新闻项目*存储在 webroot 之外的节点中：

*   内容
    *   网站首页
        *   消息
    *   新闻讯息
        *   消息 1（创建于 2011 年 10 月 10 日）
        *   消息 2（创建于 2012 年 15 月 1 日）

我想使用 URL 参数来过滤要显示的新闻站点列表*或*显示实际的新闻项目。

1.  显示**新闻部分**：

> www.website.com/news

1.  显示**2011 年**的**新闻列表**：

 **> www.website.com/news/ **2011**

1.  显示2011年**10 月的****新闻列表**：

 **> www.website.com/news/ **2011/10**

1.  显示**消息 1**的**新闻详细**信息：

 **> www.website.com/news/2011/10/10/message-1 **_**

**无需在 /Content/Website Home/News 下创建所有内容项就可以做到这一点**吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T11:27:41.037

您可以在 Umbraco 5 jupiter 中添加新区域并在 Arearegisteration.cs 中添加自定义路线，Sebastiaan Janssen Jupiter 有一个包作为 Visual Studio 插件

[http://our.umbraco.org/projects/developer-tools/jupiter-as-visual-studio-solution](http://our.umbraco.org/projects/developer-tools/jupiter-as-visual-studio-solution)

使用它来将您的 Web 应用程序转换为 MVC 应用程序并右键单击区域文件夹并添加一个新区域，VS 将负责其余的工作。然后在 AreaRegisteration.cs 中添加 Controller 和 Custom Routes 例如

```
context.MapRoute(
"ROUTE",
"/{action}/{year}",
new { controller = "ControllerName" }
); 
```

如果 Url 是 www.website.com/news/2011，则动作必须命名为 news 并且 yer 将在查询字符串中传递，您可以使用 URL 任意播放。

希望有帮助，

雪儿

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T22:56:48.513

这对于 Umbraco 来说是不可能的。然而，实现这一点的一种方法是使用 URL 重写。您可以将参数重写为可以由宏读取的查询字符串，然后依次显示所需的新闻项目。

所以，

```
www.website.com/news/2011 
```

...将被重写为：

```
www.website.com/news?year=2011 
```

...和

```
www.website.com/news/2011/10 
```

...将被重写为：

```
www.website.com/news?year=2011,month=10 
```

..等等。

“新闻”页面上的宏将从查询字符串中读取请求并写出过滤结果。******

# iphone - 如何通过数字将 1 添加到 NSMutableArray

> ID：10058007
> 
> 赞同：-1
> 
> 时间：2012-04-07T20:20:03.133
> 
> 标签：iphone, objective-c, ios, arrays, ipad

如何将 1 和变化的数字之间的每个数字添加到 NSMutableArray（以便它可以显示在 UITableView 中）？

例如，如果此刻变化的数字是 8，那么数组应该包含：`1, 2, 3, 4, 5, 6, 7, 8`。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T20:30:30.047

我推荐以下方法（不需要数组）。为你的数字

```
-numberOfSectionsInTableView..{
    return 1;
}

-numberOfRowsInSection..{
    return a;
}

-cellForRowAtIndexPath..{
    UITableViewCell* cell = ...
    UILabel *label = ...
    [label setText:[NSString stringWithFormat:@"%d",indexPath.row+1]];
    [cell addSubView:label];
    return cell;
} 
```

生成一个包含 1 个部分、一个行的表，并且每行将有一个标签，其上带有数字 1 到 a。

塞巴斯蒂安

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T20:25:40.360

就像是：

```
int number = 8;
NSMutableArray *mutableArray = [NSMutableArray arrayWithCapacity:number];
for (int i=1; i<=number; i++) {
    [mutableArray addObject:[NSString stringWithFormat:@"%i", i]]
}
NSLog(@"%@", [mutableArray description]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T20:25:55.350

```
 - (NSMutableArray*)arrayForNumber:(int)number {
    NSMutableArray* array = [NSMutableArray array];

    for (int i = 1; i <= number; i++) {
        [array addObject:[NSNumber numberWithInt:i]];
    }

    return array;
} 
```

# java - 为什么我的按钮在我的 JFrame 中不可见？

> ID：10058015
> 
> 赞同：1
> 
> 时间：2012-04-07T20:21:01.633
> 
> 标签：java, swing, eclipse-plugin, fullscreen

我正在使用以下代码从我的 Eclipse 插件创建全屏 JFrame。显示了 JFrame，但我看不到我的按钮。我不知道为什么不：

```
public class MainFrame extends JFrame {

    private static final long serialVersionUID = 1L;

    public MainFrame() {
        super();

        createComponents();
        setFullScreen();

        this.setVisible(true);
    }

    private void createComponents() {
        System.out.println("Create components");
        JButton exit = new JButton("Exit");

        exit.setVisible(true);
        exit.setBackground(Color.YELLOW);
        exit.setSize(new Dimension(500, 500));
        exit.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent arg0) {
                System.out.println("Exit by button");
                System.exit(0);
            }
        });

        this.setBackground(Color.RED);

        this.getContentPane().setLayout(new BorderLayout());
        this.getContentPane().add(exit, BorderLayout.CENTER);
    }

    private void setFullScreen() {

        this.setResizable(false);
        this.setUndecorated(true);
        this.setAlwaysOnTop(true);

        GraphicsEnvironment env = GraphicsEnvironment.getLocalGraphicsEnvironment();
        GraphicsDevice[] devices = env.getScreenDevices();

        devices[0].setFullScreenWindow(this);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T20:32:33.120

供参考，[`FullScreenTest`](https://stackoverflow.com/a/7457102/230513)是一个工作示例。

附录：因为 Eclipse 插件必须使用 SWT，所以您可以尝试[*Full Screen your RCP Applications*](http://eclipse.dzone.com/tips/full-screen-your-rcp-applicati)中显示的方法。还提到了最大化运行的替代方案。

# svg - SVG用透明度覆盖

> ID：10058018
> 
> 赞同：1
> 
> 时间：2012-04-07T20:21:17.477
> 
> 标签：svg, transparency

我有这个svg：

```
<circle cx="50" cy="100" r="50"  stroke-width="0" fill="orange"/>
<polygon points="0,100, 50,50 100,100" fill="white"/> 
```

背景是透明的。多边形用白色覆盖了圆圈，但我希望这个区域是透明的（而不是白色）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:09:37.733

您可以使用[`fill-rule: evenodd`](http://www.w3.org/TR/SVG/painting.html#FillRuleProperty)带有`path`:s 的属性来为您的形状“挖洞”：

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
<path fill="orange"
      fill-rule="evenodd"
      d="M50 50 L100 100 L0 100
         A50 50 0 0 1 100 100
         A50 50 0 0 1 0 100 z"/>
</svg> 
```

# actionscript-3 - 将 Facebook Credits 与 AS3-SDK 集成

> ID：10058019
> 
> 赞同：1
> 
> 时间：2012-04-07T20:21:20.013
> 
> 标签：actionscript-3, flash, facebook-graph-api, facebook-php-sdk, facebook-as3-api

我正在尝试使用 as3-sdk 将 Facebook Credits 集成为一种支付方式。我设法让“earn_credits”和“buy_credits”工作。然而，第三个也是最重要的选项“buy_item”并没有出现在支付对话框中。不知何故，与 callback.php 的连接似乎是问题的原因。注意：我已经在我的应用程序设置中输入了回调 URL，所以我没有忘记这一点。我使用 Facebook Developer 文档中的示例 php 文件。

这是我的 as3 代码。

```
public static function buyItem ():void
        {
            var theAction:String = "buy_item";
            var order_info:Object = { "item_id":"1a" };
            var jOrder:String = JSON.encode(order_info);
            var data:Object = {
                action:theAction,
                order_info:jOrder,
                dev_purchase_params: {"oscif":true}
            };

            Facebook.ui("pay", data, purchaseCallback);

        } 
```

我认为 json 编码可能是问题所在，但我不确定。

我使用 Facebook 开发者文档（摘录）中的示例 php 文件：

```
<?php

$app_secret = '***********************';

// Validate request is from Facebook and parse contents for use.
$request = parse_signed_request($_POST['signed_request'], $app_secret);

// Get request type.
// Two types:
//   1\. payments_get_items.
//   2\. payments_status_update.
$request_type = $_POST['method'];

// Setup response.
$response = '';

if ($request_type == 'payments_get_items') {
  // Get order info from Pay Dialog's order_info.
  // Assumes order_info is a JSON encoded string.
  $order_info = json_decode($request['credits']['order_info'], true);

  // Get item id.
  $item_id = $order_info['item_id'];

  // Simulutates item lookup based on Pay Dialog's order_info.
  if ($item_id == '1a') {
    $item = array(
      'title' => '100 some game cash',
      'description' => 'Spend cash in some game.',
      // Price must be denominated in credits.
      'price' => 1,
      'image_url' => '**********************/banner1.jpg',
    );

    // Construct response.
    $response = array(
                  'content' => array(
                                 0 => $item,
                               ),
                  'method' => $request_type,
                );
    // Response must be JSON encoded.
    $response = json_encode($response);
  } 
```

任何帮助，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T05:05:53.223

好的，所以我无法确认这是否有效，但[根据这个论坛](http://fbdevforum.com/facebook-developers/forum.developers.facebook.net/viewtopiccdd6bceb4f14bd93275a2988138f10bc.html)，它确实：

```
var title:String = "TITLE FOO";
var desc:String = "FOO";
var price:String = "200";
var img_url:String = [some image url];
var product_url:String = [some product url];

// create order info object
var order_info:Object = { 
   "title":title,
   "description":desc,
   "price":price,
   "image_url":img_url,
   "product_url":product_url
};

// calling the API ...
var obj:Object = {
   method: 'pay.prompt',
   order_info: order_info,
   purchase_type: 'item',
   credits_purchase: false
};

Facebook.ui('pay', obj, callbackFunction); 
```

我看到这个例子在 AS3 方面与你的略有不同，所以希望这个 nfo 能帮助你解决你的问题。我意识到这不是回答问题的最佳方式，但我可以在这里看到几天后，没有人回答你，所以我认为此时任何事情都可以提供帮助。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T02:03:31.987

谢谢@Ascension Systems！

这效果很好，比通过 html 创建弹出窗口和使用 navigateToURL 等要好得多......

但是有一个警告，这导致您的解决方案最初对我不起作用：

如果您依赖 Facebook 提供的 callback.php 示例（在本页末尾：http: [//developers.facebook.com/docs/credits/callback/](http://developers.facebook.com/docs/credits/callback/)），那么您需要将此标签添加到您的 order_info 对象：

```
var item_id:String = "1a";

var order_info:Object = {
   "title":title,
   "description":desc,
   "price":price,
   "image_url":img_url,
   "product_url":product_url,
   "item_id":item_id
}; 
```

如果没有定义 item_id，Facebook 的 callback.php 中的 if 语句 ( if ($item_id == '1a') ... ) 将失败，并且您会看到一个令人不快的窗口：“App Not Responding The app Not Responding The app you are not响应。请稍后再试。”

# java - 遍历所有序列化对象

> ID：10058021
> 
> 赞同：1
> 
> 时间：2012-04-07T20:21:44.333
> 
> 标签：java, serialization

`EOFException`除了在循环中捕获之外，序列化 API 中有什么方法可以循环遍历存储在媒体（文件/数据库）中的所有对象`while(true)`，在写入对象或将数组或集合存储在文件中而不是单个对象之前在文件开头添加对象计数? 如果不同类型的对象存储在文件中并且它们不是通过数组/集合存储的，如何迭代使用`ObjectInputStream`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T20:24:00.550

所有方法都有效：

1.  在开头存储文件的长度
2.  保存集合（基本上它（1）在里面）
3.  最后写一些 EndOfFile 对象。
4.  捕获 EOFException

没有其他选项可用（据我所知）。

# python - Python 类（基础）

> ID：10058023
> 
> 赞同：0
> 
> 时间：2012-04-07T20:22:18.530
> 
> 标签：python, oop, class

工作代码在这里：[http ://codepad.org/L0OkeHlk](http://codepad.org/L0OkeHlk)

```
from sys import exit

class Map(object):

    def __init__(self, start):
        self.start = start

    def play(self):
        next = self.start

        while True:
            print "\n---------"
            room = getattr(self,next)
            next = room()

    def death(self):
        exit(1)

    def redroom(self):
        prompt = raw_input("> ")
        if "white" in prompt:
            return "whiteroom"
        elif "blue" in prompt:
            return "blueroom"
        else:
            print "DOES NOT COMPUTE (RED ROOM)"
            return 'death'

    def whiteroom(self):
        prompt = raw_input("> ")
        if "red" in prompt:
            return "redroom"
        elif "blue" in prompt:
            return "blueroom"
        else:
            print "DOES NOT COMPUTE (WHITE ROOM)"
            return 'death'

    def blueroom(self):
        prompt = raw_input("> ")
        if "white" in prompt:
            return "whiteroom"
        elif "red" in prompt:
            return "redroom"
        else:
            print "DOES NOT COMPUTE (BLUE ROOM)"
            return 'death'

class Engine(object):
    pass

x = Map("redroom")
x.play() 
```

以上工作。但这只是因为我在一个班级里做所有事情。我想把游戏和死亡功能放在自己的一个类中。

我的问题来自两个地方。如何让 Engine 类调用地图类中的函数以使游戏正常运行？我怎么知道在 Map/Engine 类中初始化什么？我知道我应该初始化一些东西，但我不知道如何想出它。在决定初始化什么时，我应该首先想到什么？

无效代码（我的最佳尝试）：[http ://codepad.org/ELlaHQiB](http://codepad.org/ELlaHQiB)

```
from sys import exit

class Map(object):

    def redroom(self):
        prompt = raw_input("> ")
        if "white" in prompt:
            return "whiteroom"
        elif "blue" in prompt:
            return "blueroom"
        else:
            print "DOES NOT COMPUTE (RED ROOM)"
            return 'death'

    def whiteroom(self):
        prompt = raw_input("> ")
        if "red" in prompt:
            return "redroom"
        elif "blue" in prompt:
            return "blueroom"
        else:
            print "DOES NOT COMPUTE (WHITE ROOM)"
            return 'death'

    def blueroom(self):
        prompt = raw_input("> ")
        if "white" in prompt:
            return "whiteroom"
        elif "red" in prompt:
            return "redroom"
        else:
            print "DOES NOT COMPUTE (BLUE ROOM)"
            return 'death'

class Engine(object):
    def __init__(self, start):
        self.start = start

    def play(self):
        next = self.start

        while True:
            print "\n---------"
            room = getattr(self,next)
            next = room()

    def death(self):
        exit(1)

x = Engine("redroom")
x.play() 
```

另外，我不确定播放功能。它有效，但只是因为我从正在阅读的教程中得到它。下一个变量成为 self.start 然后在 while 循环中成为 room() 的目的是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T00:33:27.690

这就是我会做的。

```
class Engine(object):
    def __init__(self,rooms):
        self.rooms = rooms
        self.current = 0

    def next(self):
        self.rooms[self.current]()
        self.current += 1
        if len(self.rooms) == self.current:
            self.current = 0
            # or whatever logic you want.

m = Map()
rooms = [m.redroom, m.whiteroom, m.blueroom]
e = Engines(rooms)

e.next() # should call redroom of class Map
e.next() # should call whiteroon etc 
```

# ruby-on-rails - Rails：从多对多关系的“选定”对象构建对象

> ID：10058030
> 
> 赞同：0
> 
> 时间：2012-04-07T20:22:49.340
> 
> 标签：ruby-on-rails, many-to-many

我正在开发一个 Rails 应用程序（我的 Rails 技能生疏了）。其中我目前有四个模型，用户、帐户、协作者（从用户*-*帐户连接表）和项目。每个用户可以拥有多个帐户，而这些帐户又可以拥有多个项目。我目前在为正确的帐户创建项目时遇到了一些麻烦。我的目标是在同一页面上显示用户帐户（也可以称为公司）和帐户项目，并让项目在同一页面上创建操作。像这样的东西：

```
Logo 

(current_user) Account 1 (ie. Company account)
  Account Project 1
  Account Project 2
  text_field for creating new projects for Account 1 + submit button

(current_user) Account 2 (ie. My fun hobby projects)
  Account Project 1
  Account Project 2
  text_field for creating new projects for Account 2 + submit button 
```

我在创建用户和帐户方面没有任何问题，但我不确定如何在创建帐户项目时达到上述结果。

Account 和 Project 的模型和关系如下所示：

```
class Account < ActiveRecord::Base
  [...]
  has_many :projects, dependent: :destroy
  [...]

class Project < ActiveRecord::Base
  [...]
  belongs_to :account
end 
```

我做了一个绊脚石的尝试来创建这样的新项目：

```
class ProjectsController < ApplicationController
  [...]  
  def create
    # How do I find the selected/correct account?
    @project = "selected_account".projects.build(params[:projects])
    if @project.save
      flash[:success] = "Project created!"
      redirect_to root_path
    else
      render 'pages/home'
    end
  end 
```

我的问题可能会缩小到如何在 ProjectControllers 创建操作中找到选定/正确的帐户？

任何答案、指导或提示都会很棒。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T20:54:27.117

假设您有一个返回当前登录用户的“当前用户”方法，您可以尝试以下操作：

添加到路线

```
resources :accounts do
  resources :projects
end 
```

检查路线

..从命令行做'rake routes'

```
account_projects GET    /accounts/:account_id/projects(.:format)     projects#index
                 POST   /accounts/:account_id/projects(.:format)     projects#create 
```

发布 /accounts/1/projects

```
class ProjectsController < ApplicationController
  [...]  
  def create
    account = current_user.accounts.find params[:account_id]
    @project = account.projects.build(params[:projects])
    if @project.save
      flash[:success] = "Project created!"
      redirect_to root_path
    else
      render 'pages/home'
    end
  end 
end 
```

# ruby-on-rails - 删除用户时删除游戏

> ID：10058032
> 
> 赞同：0
> 
> 时间：2012-04-07T20:23:08.147
> 
> 标签：ruby-on-rails, foreign-key-relationship, destroy

在我的网络应用程序中，用户可以上传游戏，然后通过游戏表中的 user_id 列与每个用户相关联。

我现在想要做的是，每当用户删除他们的个人资料时，与他们相关的游戏也会被删除。

我想知道我将如何去做这件事？

在销毁方法中，我目前拥有的用户控制器：

```
def destroy
@user = User.find_by_username(params[:id])
@user.destroy

respond_to do |format|
  format.html { redirect_to users_url }
  format.json { head :ok }
end
end 
```

会不会是某种@user.id == @game.user_id.destroy？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T20:26:03.527

在模型中声明关联时添加 :dependent => :destroy ：

`has_many :games, :dependent => :destroy`

# android - 线性布局中的按钮放置

> ID：10058033
> 
> 赞同：0
> 
> 时间：2012-04-07T20:23:09.690
> 
> 标签：android, android-button, android-linearlayout

我有一个线性布局，里面有几个按钮。按钮图像大小相同，属性相同……除了一个按钮。这一个按钮的字体较小。除了这个之外的所有按钮都按照我想要的方式完美地排列在一起。出于某种原因，字体较小的按钮在屏幕上的显示位置比其他按钮稍低。我很难想到一个按钮需要更少的空间占用额外的空间。

有人可以给我提示一下要读什么吗？

*编辑*

这是 main.xml （似乎 SO 过滤了其中一些，所有重要的东西都在这里......）

```
<ScrollView android:id="@+id/scroll"
            android:layout_width="match_parent"
            android:layout_height="300px">

    <TextView
            android:id="@+id/the_text_view"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:typeface="monospace"
            android:textSize="9pt"
            android:background="@color/paper"
            android:paddingLeft="20dp"
            android:paddingBottom="20dp"
            android:textColor="@color/type"
            />
</ScrollView>

<LinearLayout
        android:orientation="horizontal"
        android:layout_width="match_parent"
        android:layout_height="wrap_content">

    <Button style="@style/ASR33_button"
            android:tag="Y"
            android:text="Y"
            />

    <Button style="@style/ASR33_button"
            android:tag="N"
            android:text="N"
            />

    <Button style="@style/ASR33_button"
            android:tag="E"
            android:text="E"
            />

    <Button style="@style/ASR33_button"
            android:tag="W"
            android:text="W"
            />

    <Button style="@style/ASR33_button"
            android:tag="S"
            android:text="S"
            />

    <Button style="@style/ASR33_button"
            android:tag="F"
            android:text="F"
            />

    <Button style="@style/ASR33_button"
            android:tag="R"
            android:text="R"
            />

    <Button style="@style/ASR33_button"
            android:tag="M"
            android:text="M"
            />

    <Button style="@style/ASR33_button"
            android:tag="T"
            android:text="T"
            />

    <Button style="@style/ASR33_button"
            android:onClick="onEnterButtonClicked"
            android:textSize="6pt"
            android:text="RE-\nTURN"
            />

    <Button style="@style/ASR33_button"
            android:tag="U"
            android:text="U"
            />
</LinearLayout>

<LinearLayout
        android:orientation="horizontal"
        android:layout_marginTop="10dp"
        android:layout_width="match_parent"
        android:layout_height="wrap_content">

    <TextView
            android:id="@+id/instructions"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:textSize="9pt"
            android:paddingLeft="10dp"
            android:typeface="normal"
            android:text="Commands: (Y)es, (N)o, (N)orth, (E)ast, (W)est, (S)outh, (M)ap, (ST)atus, (Fight), (R)un, (SU)icide.  All commands must be followed by RETURN."
            />

</LinearLayout> 
```

奇怪的是倒数第二个，具有不同的 onclick 事件。该样式的字符大小为 11pt。如果我使用它（和一个 1 个字母的按钮名称，就像其他人一样）它的行为。但这不是 ASR33 的“输入”键。因此，如果我将字体大小减小到 6 pt，就会发生奇怪的事情。

风格可以在[这里](https://stackoverflow.com/questions/10056843/can-i-make-an-android-button-template)看到。

再次，请阅读参考资料或想法，如果我有一两个词要搜索，我可以弄清楚。很难知道你不知道的...

**解析度**

Anurag 说得对，请参阅下面的答案。以下是更新后的 LinearLayout 的摘录：

```
<LinearLayout
    android:orientation="horizontal"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:baselineAligned="false"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T20:36:12.457

可能由于按钮的 wrap_content 属性而发生了调整大小。所以你应该做的是保持所有按钮的线性布局的固定高度，而它的 with 设置为填充父母。

在线性布局中，让单个按钮设置高度以包装内容，这将使所有按钮的高度与线性布局的高度相同，并`android:adjustViewBounds="true"`为小按钮设置属性。此属性将调整您的图像按钮的大小以保持纵横比。我希望这有帮助。

编辑：所以这是您的问题的解决方案，这是由于线性布局的基本对齐属性引起的。默认情况下，水平 LinearLayout 对齐其所有子控件的基线。因此，多行按钮中的第一行文本与其他按钮中的单行文本垂直对齐。在 LinearLayout 上设置 android:baselineAligned="false"。这在我的 HTC 上完美运行。

# android - 长按删除项目

> ID：10058034
> 
> 赞同：6
> 
> 时间：2012-04-07T20:23:20.113
> 
> 标签：android

我有 ListView 将所有数据保存到数据库。为了添加，我有简单的按钮和文本框，它们添加到数据库中，并显示到 listView。现在我希望长项目单击（按住项目）将从列表中删除所选项目。怎么可能做到这一点（实际上是什么方法来调用长按）。

这是当前代码：

```
import java.util.List;
import java.util.Random;

import android.app.ListActivity;
import android.os.Bundle;
import android.text.Editable;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.ListView;

public class Announce extends ListActivity{
    private CommentsDataSource datasource;
    EditText edit;
    ListView list;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.announce);

        datasource = new CommentsDataSource(this);
        datasource.open();

        List<Comment> values = datasource.getAllComments();

        ArrayAdapter<Comment> adapter = new ArrayAdapter<Comment>(this,
                android.R.layout.simple_list_item_1, values);
        setListAdapter(adapter);
    }

    public void onClick(View view) {
        @SuppressWarnings("unchecked")
        ArrayAdapter<Comment> adapter = (ArrayAdapter<Comment>) getListAdapter();
        Comment comment = null;
        switch (view.getId()) {
        case R.id.add:
            edit = (EditText)findViewById(R.id.editTxt);
            Editable txt=(Editable)edit.getText();
            String input = txt.toString();          
            comment = datasource.createComment(input);
            adapter.add(comment);
            break;  
        }
        adapter.notifyDataSetChanged();
    }

    @Override
    protected void onResume() {
        datasource.open();
        super.onResume();
    }

    @Override
    protected void onPause() {
        datasource.close();
        super.onPause();
    }

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-07T20:26:59.643

你想要一个上下文菜单基本上看这里：http: [//developer.android.com/guide/topics/ui/menus.html#context-menu](http://developer.android.com/guide/topics/ui/menus.html#context-menu)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T20:30:22.837

你可以使用这个结构：D

```
something.setOnLongClickListener(new OnLongClickListener() {
        @Override
        public boolean onLongClick(View v) { ... } }); 
```

# django - South + Django 1.4 数据库错误

> ID：10058035
> 
> 赞同：25
> 
> 时间：2012-04-07T20:23:30.457
> 
> 标签：django, django-south, django-staticfiles, django-1.4

我刚刚在一个新系统上安装了我的 Django 项目，并安装了 Django 1.4。但是，当我尝试运行`manage.py runserver`或`manage.py syncdb`从 South 收到此错误时：

```
Validating models...

Unhandled exception in thread started by <bound method Command.inner_run of <django.contrib.staticfiles.management.commands.runserver.Command object at 0x1a67810>>
Traceback (most recent call last):
  File "/home/saul/.virtualenvs/canada/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 91, in inner_run
    self.validate(display_num_errors=True)
  File "/home/saul/.virtualenvs/canada/lib/python2.7/site-packages/django/core/management/base.py", line 266, in validate
    num_errors = get_validation_errors(s, app)
  File "/home/saul/.virtualenvs/canada/lib/python2.7/site-packages/django/core/management/validation.py", line 30, in get_validation_errors
    for (app_name, error) in get_app_errors().items():
  File "/home/saul/.virtualenvs/canada/lib/python2.7/site-packages/django/db/models/loading.py", line 158, in get_app_errors
    self._populate()
  File "/home/saul/.virtualenvs/canada/lib/python2.7/site-packages/django/db/models/loading.py", line 64, in _populate
    self.load_app(app_name, True)
  File "/home/saul/.virtualenvs/canada/lib/python2.7/site-packages/django/db/models/loading.py", line 88, in load_app
    models = import_module('.models', app_name)
  File "/home/saul/.virtualenvs/canada/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/home/saul/.virtualenvs/canada/lib/python2.7/site-packages/south/models.py", line 2, in <module>
    from south.db import DEFAULT_DB_ALIAS
  File "/home/saul/.virtualenvs/canada/lib/python2.7/site-packages/south/db/__init__.py", line 78, in <module>
    db = dbs[DEFAULT_DB_ALIAS]
KeyError: 'default' 
```

我目前正在使用 SQlite。我认为这可能是因为 Django 1.4 的这种[变化](https://docs.djangoproject.com/en/dev/releases/1.4/#database-connection-s-thread-locality)，但是其他用户似乎没有遇到我的问题。我所有的包裹都是最新的。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-03-08T03:58:27.377

与接受的答案相比，我有相同的错误消息，但原因和解决方案不同。简短的回答是添加`SOUTH_DATABASE_ADAPTERS = {'default':'south.db.postgresql_psycopg2'}`到`settings.py`.

这是完整的解释：

跟踪`south/db/__init__.py`显示没有检测到数据库，原因是我的数据库引擎名称不在硬编码列表中`south/db/__init__.py`

```
engine_modules = {
    'django.db.backends.postgresql_psycopg2': 'postgresql_psycopg2',
    'django.db.backends.sqlite3': 'sqlite3',
    'django.db.backends.mysql': 'mysql',
    'django.db.backends.oracle': 'oracle',
    'sql_server.pyodbc': 'sql_server.pyodbc', #django-pyodbc
    'sqlserver_ado': 'sql_server.pyodbc', #django-mssql
    'firebird': 'firebird', #django-firebird
    'django.contrib.gis.db.backends.postgis': 'postgresql_psycopg2',
    'django.contrib.gis.db.backends.spatialite': 'sqlite3',
    'django.contrib.gis.db.backends.mysql': 'mysql',
    'django.contrib.gis.db.backends.oracle': 'oracle',
    'doj.backends.zxjdbc.postgresql': 'postgresql_psycopg2', #django-jython
    'doj.backends.zxjdbc.mysql': 'mysql', #django-jython
    'doj.backends.zxjdbc.oracle': 'oracle', #django-jython
} 
```

我在 Windows 上使用 postgis 2.0，不久前不得不对 django 的 postgis 后端应用一个小补丁。因为我没有从源代码安装 django，所以我制作了一个后端副本并将补丁手动应用于该副本。因此，新后端位于不同的位置，并且该位置不在`engine_modules`上面显示的 South 的键列表中。

幸运的是，South 提供了一个名为的设置变量`SOUTH_DATABASE_ADAPTERS`，它直接告诉 South 每个别名的实际数据库引擎。`syncdb`将此行插入后我能够运行`settings.py`

`SOUTH_DATABASE_ADAPTERS = {'default':'south.db.postgresql_psycopg2'}`

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-04-08T03:41:52.350

您的. [_](https://docs.djangoproject.com/en/1.4/ref/settings/#databases) `settings`应该有一个名为的数据库`'default'`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-19T12:43:36.703

对于那些使用 Heroku 的人，这是我的情况。我也发现了这个问题，我设置了默认数据库，正如他们在 heroku 指南中指出的那样：

```
DATABASES['default'] =  dj_database_url.config() 
```

但是，仍然会出现 ketError 'default' 错误。这是由于没有配置数据库，因此`dj_database_url`找不到它并引发了令人困惑的错误。

要解决它，只需配置数据库并按照[heroku postgresql中的说明进行推广](https://devcenter.heroku.com/articles/heroku-postgresql)

```
heroku addons:add heroku-postgresql:dev
heroku pg:promote HEROKU_POSTGRESQL_BLUE 
```

# ruby-on-rails - js.erb 仅在第一次调用

> ID：10058040
> 
> 赞同：0
> 
> 时间：2012-04-07T20:24:01.657
> 
> 标签：ruby-on-rails, ajax

在我的 rails 3 应用程序中，有一个带有**onchange事件的****select_tag**，它发送一个 ajax 请求：

 **```
f.select 'forma_id', @collection, {:include_blank => true}, {:onchange => "goAjax('/lancamentos/receber_forma', this.value)", :class => 'btn'} 
```

其中，**goAjax**是：

```
function goAjax(_url, _value) {
  $.ajax({url: _url, data: 'value=' + _value, dataType: 'script'})
} 
```

**lancamentos_controller#receber_forma**是（简化版）：

```
def receber_forma
  @lancamento = Lancamento.new(:forma_id => params[:value])
  logger.info 'forma_id = ' + @lancamento.forma_id
  respond_to do |format|
    format.html { render :new }
    format.js
  end
end 
```

和**receber_forma.js.erb**：

```
$('div#cartoes').replaceWith("<%= escape_javascript(label_tag(@lancamento.forma_id)) %>"); 
```

发生的事情是，当我在该选择上选择一个值时，标签上呈现的值始终是第一次调用时发送的值。以下值更改根本不会更改标签文本。receber_forma 方法中的记录器显示始终发送新选择的值。

有人知道我在这里做错了什么吗？

ps：如有英文错误请见谅

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:05:41.917

你完全用`div#cartoes`标签替换了你的，所以代码第二次运行时，它找不到`div`带有`cartoes`id 的 a。您可能想要使用`.html`而不是`.replaceWith`，以便标签成为的内容，`div`而不是完全替换它：

```
$('div#cartoes').html("<%= escape_javascript(label_tag(@lancamento.forma_id)) %>"); 
```**

# c# - 如何在 C# 脚本中编组宏？

> ID：10058041
> 
> 赞同：0
> 
> 时间：2012-04-07T20:24:09.160
> 
> 标签：c#, macros, interop, dllimport

如果你在 C 中有这样的宏：

```
 #define SLICE_VERSION 20110614 
```

如何在 C# 脚本中使用此宏？

我应该编组它吗？如何？

我应该在 C# 中重新定义它吗？我知道 C# 没有#define 宏，但也许我可以将它定义为静态变量。

或者我可以以某种方式引用它吗？

同样，如果你在 C 中有一个全局变量，你如何在 C# 脚本中使用它？

我已经看过关于编组类、结构、数组、联合和许多其他东西的教程，从 C/C++ 到 C#，但我找不到任何关于如何编组常量的提示......或者我必须编组它？可以直接引用吗？

顺便说一句，我发现这是一个关于 Mono 互操作的非常好的教程：[http ://www.mono-project.com/Interop_with_Native_Libraries#Introduction](http://www.mono-project.com/Interop_with_Native_Libraries#Introduction)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T20:40:39.667

> 我应该在 C# 中重新定义它吗？

是的。在 C# 中，您需要使用`const`：

```
const int SLICE_VERSION = 20110614; 
```

话虽如此，我也会经常重命名它以使其更符合 C# 标准：

```
const int SliceVersion = 20110614; 
```

根据它的使用方式，您也希望明确指定[访问修饰符](http://msdn.microsoft.com/en-us/library/ms173121.aspx)。此外，根据使用情况，您可能希望使用不同的类型（Int32 可能不正确 - 您可能需要 UInt32 等）。C/C++ 中宏的一个缺点是它们不是强类型的，因此如果没有看到用法，就无法知道此处预期的确切类型。

# c# - 网络阻塞到非阻塞，只有线程作为选项？

> ID：10058044
> 
> 赞同：0
> 
> 时间：2012-04-07T20:24:25.320
> 
> 标签：c#, networking, tcp, irc

所以我已经使用 C# 一天了。我正在编写的第一个应用程序是一个简单的基于控制台的 IRC-Client，但它比我想象的要难。由于我从两个流中读取：控制台和 irc-server 我需要某种非阻塞 I/O。

目前我有以下代码：

```
while (((sInput = sr.ReadLine()) != null) || ((uuInput = Console.ReadLine()) != null))
                {
                    // stuff
                } 
```

但是，这将始终执行 sInput，因为 .ReadLine() 是阻塞的，因此最终会在最后返回 True，因此 OR 的第二个块永远不会被执行。

解决方案是什么？用线程自己实现它？我似乎在标准 C# 库中找不到任何 NIO 库。我更喜欢有一个小而干净的解决方案，因为我不想让这个程序过于复杂。

任何帮助都会非常好。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T10:49:40.600

在学习 C# 时，您肯定已经深入了解了。根据您设置的问题标签，我假设您在网络方面的帮助比直接输入/输出问题更多。公平地说，无论您使用哪种语言，网络都绝对不是微不足道的。也许帮助您的最好方法是为您指明一个示例的方向，该示例演示您正在尝试实现的内容。[networkComms.net](https://bitbucket.org/MarcF/networkcomms.net/wiki/Home)是一个开源网络库，[这里](https://bitbucket.org/MarcF/networkcomms.net/src/20123ae7cf23/ExamplesConsole/BasicSend.cs)有一个聊天应用程序作为它的示例（只有 11 行长）。如果您在看过之后有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T11:10:32.713

您可以尝试使用异步操作，例如`BeginRead()`，但这意味着使用`Stream`而不是`StreamReader`.

所以，我认为在你的情况下，是的，如果你创建另一个线程并在那里执行另一个阻塞调用，那将是最简单的。但是如果你这样做，不要忘记同步对两个线程共享的任何资源的访问，可能通过使用`lock`.

# c# - 从字符串列表中删除子字符串

> ID：10058046
> 
> 赞同：0
> 
> 时间：2012-04-07T20:24:44.987
> 
> 标签：c#, regex, linq, list, replace

我有一个包含禁用词的字符串列表。检查字符串是否包含任何被禁止的单词并将其从字符串中删除的有效方法是什么？目前，我有这个：

```
cleaned = String.Join(" ", str.Split().Where(b => !bannedWords.Contains(b,
                            StringComparer.OrdinalIgnoreCase)).ToArray()); 
```

这适用于单个禁用词，但不适用于短语（例如`more than one word`）。的任何实例`more than one word`也应该被删除。我想尝试的另一种方法是使用 List 的 Contains 方法，但它只返回一个布尔值，而不是匹配词的索引。如果我可以获得匹配词的索引，我可以使用`String.Replace(bannedWords[i],"");`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T20:29:33.230

它不起作用，因为您有冲突的定义。

当您想查找`more than one word`无法再拆分空格的子句时。你将不得不依靠`String.IndexOf()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T20:46:16.840

一个简单的`String.Replace`将不起作用，因为它会删除单词部分。如果“sex”是一个被禁止的词，而你有“sextet”这个词，它没有被禁止，你应该保持原样。

使用`Regex`您可以在文本中找到整个单词和短语

```
string text = "A sextet is a musical composition for six instruments or voices.".
string word = "sex";
var matches = Regex.Matches(text, @"(?<=\b)" + word + @"(?=\b)"); 
```

在这种情况下，matches 集合将为空。

您可以使用该`Regex.Replace`方法

```
foreach (string word in bannedWords) {
    text = Regex.Replace(text, @"(?<=\b)" + word + @"(?=\b)", "")
} 
```

注意：我使用了以下`Regex`模式

```
(?<=prefix)find(?=suffix) 
```

其中 'prefix' 和 'suffix' 都是`\b`，表示单词的开头和结尾。

如果您的禁止字词或短语可以包含特殊字符，则使用 . 转义它们会更安全`Regex.Escape(word)`。

* * *

使用@zmbq 的想法，您可以创建一个`Regex`模式一次

```
string pattern =
    @"(?<=\b)(" +
    String.Join(
        "|",
        bannedWords
            .Select(w => Regex.Escape(w))
            .ToArray()) +
     @")(?=\b)";
var regex = new Regex(pattern); // Is compiled by default 
```

然后将其重复应用于不同的文本

```
string result = regex.Replace(text, ""); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T20:32:04.710

如果您追求的是性能，我假设您不担心一次性设置时间，而是担心持续性能。所以我会构建一个包含所有被禁止的表达式的巨大正则表达式，并确保它被编译——这是一个设置。

然后我会尝试将它与文本进行匹配，并将每个匹配项替换为空白或您想要替换的任何内容。

这样做的原因是，一个大的正则表达式应该编译成类似于你手动创建的有限状态自动机来处理这个问题的东西，所以它应该运行得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T20:49:21.740

你为什么不遍历禁用词列表并使用 方法在字符串中查找它们中的每一个`string.IndexOf`。例如，您可以使用以下代码删除被禁止的单词和短语：

```
myForbWords.ForEach(delegate(string item) {
    int occ = str.IndexOf(item);
    if(occ > -1) str = str.Remove(occ, item.Length);
}); 
```

myForbWords 的类型是`List<string>`.

# visual-c++ - 如何在控制台程序（C++）中上线

> ID：10058050
> 
> 赞同：8
> 
> 时间：2012-04-07T20:25:19.793
> 
> 标签：visual-c++, animation, console-application

在 C++ 中，我试图返回一行来添加一些字符。到目前为止，这是我的代码：

```
cout << "\n\n\n\n\n\n\n\n\n\n\xc9\xbb\n\xc8\xbc"<<flush;
Sleep(50); 
```

如您所见，我有 10 个换行符。在我的动画中，一个新的方块将从屏幕顶部落下。但我不知道如何备份这些行以添加我需要的字符。我尝试了 \r，但这并没有做任何事情，并且 \b 也没有上升到上一行。另外，flush到底是做什么的？我只用 C++ 编程了大约 2 天，所以我是新手 =P。

非常感谢！！！

基督教

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-07T20:28:32.967

如果您的控制台支持[VT100 转义序列](https://web.archive.org/web/20151004211730/http://www.termsys.demon.co.uk/vtansi.htm)（大多数都支持），那么您可以使用`ESC [ A`，如下所示：

```
cout << "\x1b[A"; 
```

将光标向上移动一行。根据需要重复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T10:05:24.427

在 Windows 中，您可以使用此[示例](http://www.dreamincode.net/forums/topic/228811-microsoft-using-console-functions-to-achieve-blinking-text/)

在那里你将创建 CreateConsoleScreenBuffer() 然后使用 SetConsoleCursorPosition(console_handle, dwPosition);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T20:29:44.657

`cout`将首先写入内部缓冲区并仅定期将其输出到屏幕，而不是针对插入的每个字符。这是出于性能原因。

`flush`告诉它现在清空缓冲区并将其显示在屏幕上。

您应该考虑像[ncurses](http://en.wikipedia.org/wiki/Ncurses)这样的库。

# machine-learning - 使用 Adaboost 在特征向量中选择最佳特征

> ID：10058052
> 
> 赞同：4
> 
> 时间：2012-04-07T20:25:32.763
> 
> 标签：machine-learning, adaboost

我已经阅读了一些关于 Adaboost 如何工作的文档，但对此有一些疑问。

我还读到 Adaboost 还**从数据中挑选出最好的特征，**除了**加权弱分类器**并在测试阶段使用它们来有效地执行分类。

**Adaboost 如何从数据中挑选最佳特征？**

如果我对**Adaboost**的理解有误，请纠正我！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T22:04:23.847

在某些情况下，Adaboost 中的弱分类器（几乎）等于特征。换句话说，使用单一特征进行分类可以产生比随机性能稍好的结果，因此可以用作弱分类器。Adaboost 将在给定训练数据的情况下找到一组最佳弱分类器，因此如果弱分类器等于特征，那么您将获得最有用特征的指示。

类似于特征的弱分类器的一个例子是[决策树桩](https://en.wikipedia.org/wiki/Decision_stump)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T14:15:04.440

好的，adaboost 根据其基本学习器树选择特征。对于单个树，有几种方法可以估计单个特征对树的贡献，在某处称为相对重要性。对于 adaboosting，一种包含几棵这样的树的集成方法，可以通过测量每个特征对每棵树的重要性然后对其进行平均来计算每个特征对最终模型的相对重要性。

希望这可以帮到你。

# networking - 为什么 UDP 服务器不需要使用线程？

> ID：10058056
> 
> 赞同：-1
> 
> 时间：2012-04-07T20:25:59.390
> 
> 标签：networking

有人可以解释一下为什么 UDP 服务器不需要使用线程，为什么 TCP 服务器需要在客户端/服务器通信期间使用线程？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:46:00.320

我想你误会了。UDP 服务器不需要使用*多个线程*，因为它只需要处理一个套接字。TCP 服务器必须为每个连接处理一个套接字，因此在阻塞模式下，除了处理侦听套接字的线程之外，它还需要每个连接一个线程。

# c# - 在 asp.net 中创建 Excel 工作簿

> ID：10058058
> 
> 赞同：3
> 
> 时间：2012-04-07T20:26:12.483
> 
> 标签：c#, asp.net, vsto, ms-office

我需要在单击按钮时为用户生成一个 excel 文件。我之前使用的是[Netoffice](http://netoffice.codeplex.com/)，它适用于桌面应用程序。但现在我想用一个 asp.net 应用程序做同样的事情。这样我的服务器代码就无法访问客户端的 excel 副本。我应该采取什么方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-07T20:31:43.993

使用[EPPlus](http://epplus.codeplex.com/)。它允许您在服务器上创建 Excel 电子表格。我用过它，效果很好。它支持高级功能。

```
using (ExcelPackage pck = new ExcelPackage())
{
    //Create the worksheet
    ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Demo");

    //Load the datatable into the sheet, starting from cell A1\. Print the column names on row 1
    ws.Cells["A1"].LoadFromDataTable(tbl, true);

    //Format the header for column 1-3
    using (ExcelRange rng = ws.Cells["A1:C1"])
    {
        rng.Style.Font.Bold = true;
        rng.Style.Fill.PatternType = ExcelFillStyle.Solid;

        //Set Pattern for the background to Solid
        rng.Style.Fill.BackgroundColor.SetColor(Color.FromArgb(79, 129, 189));

        //Set color to dark blue
        rng.Style.Font.Color.SetColor(Color.White);
    }

    //Example how to Format Column 1 as numeric 
    using (ExcelRange col = ws.Cells[2, 1, 2 + tbl.Rows.Count, 1])
    {
        col.Style.Numberformat.Format = "#,##0.00";
        col.Style.HorizontalAlignment = ExcelHorizontalAlignment.Right;
    }

    //Write it back to the client
    Response.Clear();
    Response.AddHeader("content-disposition", "attachment;  filename=file.xlsx");
    Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";                    
    Response.BinaryWrite(pck.GetAsByteArray());
    Response.End();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-07T20:30:58.237

最灵活且最有可能完全满足您需要的方法是做一些工作，但它是免费的——而且确实有效。使用该工具包查看现有文档以了解如何创建所需的功能。

[打开 XML 2.0 SDK](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=5124 "打开 XML 2.0 SDK")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T20:29:26.420

您可以尝试简单的 HTML 表格（包括 html、head 和 body 标签）。只需使用 XLS 扩展名保存即可。

* * *

![在此处输入图像描述](../Images/065cc727b745b1986c3b541d08097e8c.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T20:34:53.050

Netoffice 在执行机器上需要 MS Office。你的服务器有吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-08T05:02:32.463

您可以使用 DataGrid 动态创建 Excel 文件。它不需要 Excel。

```
public static void ExportDataSetToExcel(DataSet ds, string filename)
{
    HttpResponse response = HttpContext.Current.Response;

    // first let's clean up the response.object
    response.Clear();
    response.Charset = "";

    // set the response mime type for excel
    response.ContentType = "application/vnd.ms-excel";
    response.AddHeader(
        "Content-Disposition",
        "attachment;filename=\"" + filename + "\""
    );

   // create a string writer
   using (StringWriter sw = new StringWriter())
   {
       using (HtmlTextWriter htw = new HtmlTextWriter(sw))
       {
            // instantiate a datagrid
            DataGrid dg = new DataGrid();
            dg.DataSource = ds.Tables[0];
            dg.DataBind();
            dg.RenderControl(htw);
            response.Write(sw.ToString());
            dg.Dispose();
            ds.Dispose();
            response.End();
       }
    }
} 
```

# c# - 正则表达式提取多个句子，同时丢弃一个特定的句子

> ID：10058060
> 
> 赞同：2
> 
> 时间：2012-04-07T20:26:15.973
> 
> 标签：c#, regex

在：`preferences = 'Hello my name is paul. I hate puzzles.'`
我要提取`Hello my name is paul.`

在：`preferences = 'Salutations my name is richard. I love pizza. I hate rain.'`
我要提取`Salutations my name is richard. I love pizza.`

在：`preferences = 'Hi my name is bob. I enjoy ice cream.'`
我要提取`Hi my name is bob. I enjoy ice cream.`

换句话说，我想

*   **总是**丢弃`preferences = '`
*   丢弃任何包含单词in的**最后**一句话（由 分隔`.`） ，**如果存在**的话。`hate`
***   丢弃决赛`'`**

 **我的问题是我的正则表达式在第一个停止`.`并且不提取后续句子。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:23:21.183

您可以使用正则表达式实现您想要的：

```
^preferences\s*=\s*'(.*?\.)(?:[^.]*\bhate\b[^.]*\.)?'$ 
```

那不是太棘手：

*   `(.*?\.)`- 匹配您的预期输出，将在组中捕获`$1`。该模式匹配“句子”（如您所定义的），但懒惰地匹配（`*?`），尽可能少。
*   `(?:[^.]*\bhate\b[^.]*\.)?`- 可选择匹配最后一句，但前提是它包含“hate”。如果能匹配，并且是最后一句，匹配引擎不会回溯，最后一句不会被包含在抓包中。

这是 Rubular 中的一个工作示例：[http](http://www.rubular.com/r/qTuMmB3ySj)
://www.rubular.com/r/qTuMmB3ySj （我`\r\n`在几个地方添加了，以避免`[^.]`匹配新行）

不过老实说，如果可以避免的话，您可以比使用单个正则表达式做得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:16:12.357

虽然这不使用正则表达式，但它将实现您的目标

```
List<string> resultsList = new List<string);

for(int i = 0; i < preferences.Count; i++)
{
    List<string> tempList = new List<string);
    //creating the substring eliminates the "preferences = '" as well as the "'" at end of string
    //this line also splits each string from the preferences string list into the tempList array
    tempList = preferences[i].Substring(15, preferences[i].Length - 15 - 1).Split('.').ToList();

    string buildFinalString = "";

    //traverse tempList and only add string to buildFinalString if it does not contain "hate"
    foreach(string x in tempList)
    {
        if(!x.Contains("hate").ToUpper() || !x.Contains("hate").ToLower())
        {
             buildFinalString = buildFinalString + " " + x;
        }
    }
    resultsList.Add(buildFinalString);
} 
```

或者，如果您只想检查“tempList”数组中的最后一个字符串是否有单词 hat，这也是可能的......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T21:32:19.283

我用2个正则表达式做到了。第一个用于`preferences = '...'`去除 ，第二个用于消除任何带有“恨”字的句子。第二个正则表达式使用积极的后向查找来用空字符串的关键字替换 setntences。

```
String[] tests = {
    "preferences = 'Hello my name is Paul. I hate puzzles.'",
    "preferences = 'Salutations my name is Richard. I love pizza. I hate rain.'",
    "preferences = 'Hi my name is Bob. Regex turns me on.'"};
var re1 = new Regex("preferences = '(.*)'");
var re2 = new Regex("([^\\.]+(?<=.*\\bhate\\b.*)).\\s*");

for (int i=0; i < tests.Length; i++)
{
    Console.WriteLine("{0}: {1}", i, tests[i]);
    var m = re1.Match(tests[i]);
    if (m.Success)
    {
        var s = m.Groups[1].ToString();
        s = re2.Replace(s,"");
        Console.WriteLine("   {1}", i, s);
    }
    Console.WriteLine();
} 
```

这可能不是您想要的，因为您只要求删除包含标志词*的最后*一句。但是，如果您真的只想删除包含单词的最后一句，则很容易调整。在这种情况下，您只需要在 re2 的末尾附加一个 $。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T22:04:30.657

其中之一可能有效 -

结果匹配 [1] 缓冲区

```
preferences\s*=\s*'([^']*?)(?:(?<=[.'])[^.']*hate[^.']*\.\s*)?' 
```

或者

结果匹配 [1] 缓冲区

```
preferences\s*=\s*'([^']*?)(?=(?<=[.'])[^.']*hate[^.']*\.\s*'|') 
```

或者

（仅限 .Net）
匹配 [0] 缓冲区中的结果

```
(?<=preferences\s*=\s*')[^']*?(?=(?<=[.'])[^.']*hate[^.']*\.\s*'|') 
```

编辑：不要在“仇恨”周围使用 \b，也不要开始/结束构造 ^$，如果你需要的话，请随意添加它们。另一方面，令人费解的是，撇号和句点如何在分隔包含自由格式文本的字符串变量的上下文中使用。**

# c++ - 为什么打印这个字符值会产生一个数字？

> ID：10058064
> 
> 赞同：0
> 
> 时间：2012-04-07T20:26:18.590
> 
> 标签：c++, loops, random

```
#include <ctime>
#include <cstdlib>
#include <iostream>
using namespace std;

int main()
{
  // initialize the computer's random number generator
  srand(time(0)); rand();

  // declare variables
  char c1;
  char c2;
  char c3;

  c1 = 'R';
  c2 = 'P';
  c3 = 'S';

  // start loop
  while (true)
  {

    // determine computer's choice
    int result = rand() % 3; // 0 or 1 or 2

    if (result == 0) 
      result = c1;

    if (result == 1) 
      result = c2;

    if (result == 2) 
      result = c3;

    // prompt for, and read, the human's choice

    char humanChoice;
    cout << "Rock, Paper, or Scissors? [R/P/S or Q] ";
    cin >> humanChoice;
    cin.ignore(1000, 10);

    // if human wants to quit, break out of loop
    if (humanChoice == 'Q') break;

    // print results
    cout << result << endl;
    cout << humanChoice << endl;

  // end loop
  }

  // end program 

  return 0;
} 
```

伙计们怎么了？我正在进行我的中期项目的第一步，即创建一个石头剪刀布游戏。这只是开始，我还远未完成，但我已经遇到了错误。当我编译并运行它时，我得到计算选择了数字 83，它必须是 rp 或 s。有谁看到我哪里出错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T20:28:05.037

**result**是**int**类型（因此它被 cout 解释为十进制数），您的意思是它具有**char**类型（因此它被解释为文本字符）。

此外，您还有“重载”**结果**，首先保存`rand() % 3`字符值，然后保存字符值。通常，最好将变量分开以提高可读性 - 优化器可以计算出为它们重用相同的存储空间以节省堆栈空间。

尝试这个：

```
char result;

switch (rand() % 3)
{
case 0: result = c1; break;
case 1: result = c2; break;
case 2: result = c3; break;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T20:29:33.993

`result`is `int`，它将存储（并打印）您分配给它的字符的数字表示。

有多种方法可以解决这个问题，一种是简单地更改`result`为`char`. 您仍然可以在其中存储数字（限制为 0-255）并且将获得正确的输出。

恕我直言，更好的方法是稍微重构一下，首先获取人工输入，然后根据计算机的选择采取行动（最好使用 a `switch`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T20:31:24.710

83 指的是 's' 的 unicode 值。由于 result 是一个 int，因此当您将 char 's' 分配给 result 时，它会被强制转换为一个 int。因此，它输出 83。

尝试为输出使用不同的变量。例如：

```
char response;
if(result==0)
    response = c1;
...
cout << response << end1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T20:38:05.427

cout << 东西超载了。int 和 char 的行为不同。如果它是一个 int 变量的类型，那么输出将是一个数字，如果它是一个 char（字符）（我们不关心大小，但我们关心类型），那么输出将是一个人物。因此，为了解决这个问题，结果变量类型必须是前面提到的 char。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-07T20:32:17.503

您正在接受的输入是 char 类型。将其转换为整数将为您提供相关字符的 ASCII 值。P 的 ascii 值为 80，R 为 82，S 为 83。

最好使用带有 switch-case 语句的枚举：

```
enum Choices { ROCK, PAPER, SCISSORS }; 
```

# git - 在 Git 挑选或变基合并冲突中，BASE（又名“祖先”）、LOCAL 和 REMOTE 是如何确定的？

> ID：10058068
> 
> 赞同：36
> 
> 时间：2012-04-07T20:26:49.870
> 
> 标签：git, cherry-pick, git-cherry-pick

在正常的 Git 合并冲突中，三路合并的文件的三个版本大致如下：

*   本地：我的分支的版本
*   REMOTE：来自另一个分支的版本
*   BASE：来自两个分支的共同祖先的版本（特别是我分支的 HEAD 和另一个分支的 HEAD 的共同祖先）

当一个 Git cherry-pick 产生合并冲突时，没有共同的祖先，正确地说，那么这些东西是如何确定的呢？关于变基也可以问同样的问题。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-04-07T20:27:10.197

**樱桃采摘**

除非我误导了自己，否则如果你执行“git cherry-pick <commit C>”，那么你会得到：

*   本地：您要合并的提交（即您的分支的 HEAD）
*   REMOTE：你正在挑选的提交（即 <commit C>）
*   BASE：你正在挑选的提交的父级（即 C^，即 C 的父级）

如果不清楚为什么 BASE 应该是 C^，请参阅下面的“为什么”部分。

同时，让我们举个例子，看看 BASE*可以*但通常*不会是*樱桃采摘过程中的共同祖先。假设提交图看起来像这样

```
E <-- master
|
D 
| C <-- foo_feature(*)
|/
B
|
A 
```

你在分支 foo_feature （因此是星号）。如果您执行“git cherry-pick <commit D>”，那么该cherry-pick 的BASE 将是commit B，它是C 和D 的共同祖先。（C 将是LOCAL，D 将是REMOTE。）但是，如果您改为执行“git cherry-pick <commit E>，则 BASE 将是提交 D。（C 将是本地的，E 将是远程的。）

**变基**

对于背景上下文，rebase 近似地迭代樱桃采摘。特别是，在 master 之上重新设置主题（即“git checkout topic; git rebase master”）大约意味着：

```
git checkout master # switch to master's HEAD commit
git checkout -b topic_rebased # create new branch rooted there
for each commit C in master..topic # for each topic commit not already in master...
    git cherry-pick C # bring it over to the new branch
finally, forget what "topic" used to mean and now defined "topic" as the HEAD of topic_rebased. 
```

在此过程中应用的标签是正常樱桃挑选规则的扩展：

*   本地：您正在挑选的提交
    *   这是新 topic_rebased 分支的 HEAD
    *   仅对于第一次提交，这将与 master 的 HEAD 相同
*   REMOTE：你正在挑选的提交（即 <commit C>）
*   BASE：您正在挑选的提交的父级（C^，即 C 的父级）

如果您想避免混淆，这意味着要记住有关 LOCAL 与 REMOTE 的一些事情：

> *即使您在启动 rebase 时处于分支主题上，当**rebase 正在进行*时，***LOCAL 也不会引用主题分支上的提交。*** *相反，LOCAL 总是指正在创建的新*分支上的提交(topic_rebased)。

 **（如果一个人没有记住这一点，那么在一个讨厌的合并过程中，一个人可能会开始问自己，“等等，为什么说这些是*本地*更改？我发誓它们是在 master 上进行的更改，而不是在我的分支上。”）

更具体地说，这里有一个例子：

假设我们有提交图

```
D <-- foo_feature(*)
|
| C <-- master
B |
|/
|
A 
```

我们目前在分支 foo_feature（用“*”表示）。如果我们运行“git rebase master”，rebase 将分两步进行：

首先，来自 B 的更改将在 C 之上重放。在此期间，C 是 LOCAL，B 是 REMOTE，A 是 BASE。请注意，A 是 B 和 C 的真正共同祖先。在第一步之后，您将得到一个大致如下图：

```
 B' <-- foo_feature
D  |
|  |
|  C <-- master
B /
|/
|
A 
```

（在现实生活中，此时 B 和 D 可能已经从树上剪掉了，但我将它们留在这里，以便更容易发现任何潜在的共同祖先。）

其次，来自 D 的更改将在 B' 之上重放。在此期间，B' 是 LOCAL，D 是 REMOTE，B 是 BASE。请注意，B 不是任何事物的相关共同祖先。（例如，它不是当前 LOCAL 和 REMOTE、B' 和 D 的共同祖先。它不是原始分支头、C 和 D 的共同祖先）。在这一步之后，你有一个大致像这样的分支：

```
 D' <-- foo_feature
   |
   B'
D  |
|  |
|  C <-- master
B /
|/
|
A 
```

为了完整起见，请注意在变基的末尾 B 和 D 从图中删除，产生：

```
D' <-- foo_feature
|
B'
|
C <-- master
|
A 
```

**为什么 BASE 是这样定义的？**

如上所述，对于樱桃选择和变基，BASE 是被拉入的提交 C 的父 (C^)。在一般情况下，C^ 不是共同祖先，所以为什么称它为 BASE ? （在正常的合并中，BASE*是*一个共同的祖先。git 在合并方面的成功部分是由于它能够找到一个好的共同祖先。）

本质上，这是通过普通的[三向合并](http://en.wikipedia.org/wiki/3-way_merge#Three-way_merge)算法实现“补丁”功能的一种方式。特别是你会得到这些“不完整”的属性：

*   如果 <commit C> 不修改文件的给定区域，则以您分支中该区域的版本为准。（也就是说，“补丁”不需要更改的区域不会得到补丁。）
*   如果 <commit C> 修改了文件的给定区域，而您的分支不理会该区域，则 <commit x> 中该区域的版本将占上风。（也就是说，“补丁”要求更改的区域会被打补丁。）
*   如果 <commit C> 修改了文件的给定区域，但您的分支也修改了该区域，那么您会遇到合并冲突。**

# php - PHP限制访问，提交后才下载

> ID：10058074
> 
> 赞同：2
> 
> 时间：2012-04-07T20:27:52.853
> 
> 标签：php, security, download

我希望仅在有人使用注册表单（提交后）时才能够限制下载访问。无法通过复制/粘贴或发布的链接访问 HTML/PHP。

这是我到目前为止所拥有的： **服务器：服务器**上的“下载”文件夹有一个 .htaccess 文件

```
<Files download.pdf>
order deny,allow
deny from all
</Files> 
```

**网站：**在表单上，​​提交后有一个 PHP 联系人表单处理程序，它将注册信息发送到电子邮件地址并重定向到“谢谢您 - 这是您的下载 html 页面”。我已在此 html 页面上添加

```
<META http-equiv="refresh" content="1;URL=http://www.pathtofilehere/signupform.php">
<a rel="nofollow" href="http://www.pathtofilehere/signupform.php"> Get Your Download Now!</a> 
```

“Thank You - Here's Your Download”页面会提示自动下载 PHP。

```
<?php
$filename = "download.pdf";
if(ini_get('zlib.output_compression'))ini_set('zli b.output_compression', 'Off');
header("Pragma: public");
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: private",false);
header("Content-Type: application/octet-stream");
header("Content-Disposition: attachment; filename=\"".basename($filename)."\";" );
header("Content-Transfer-Encoding: binary");
header("Content-Length: ".filesize($filename));
readfile("$filename");
exit();
?> 
```

我在测试服务器上，因此无法将“下载”移出根目录。设置完成后，我会将其移出根目录。还有一个问题……网站的所有者没有设置数据库。因此，此时登录不起作用。同时...

我想要发生的事情：只有在表格“提交”后才能下载。现在，我可以通过 html 页面访问下载。或 PHP 页面。我在论坛上尝试了[Gateway PHP --> Protected File PHP](https://stackoverflow.com/a/254999/775781%20%22Gateway%20PHP--%3EProtected%20Page%20PHP)，但无法正常工作。我可以设置某种参数 session 来传递以使其仅对“已注册”人员可见/可访问吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T20:41:33.573

最简单的方法（无需任何类型的登录）是添加一个会话变量，当访问者按下提交并在下载页面中检查是否存在时设置该变量。

只需添加如下内容：

```
session_start();
$_SESSION['submitted'] = 'somevalue'; 
```

在处理提交的页面顶部，并且：

```
session_start();
if (!isset($_SESSION['submitted']))
{
  // do whatever you want to do
  die();    // stop further execution
}

$filename = "download.pdf";
if(ini_get('zlib.output_compression'))ini_set('zli b.output_compression', 'Off');
header("Pragma: public");
.... 
```

在您发布的下载脚本的顶部。

但是，当您谈论注册时，您还可以添加允许用户稍后登录以获取文件的功能（如果注册无论如何都与用户帐户相关）。然后，您将让您的用户登录并在下载页面顶部检查登录用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T20:41:47.333

全局`$_POST[]`包含仅通过 post 方法提交的特定表单值。

如果你用一些关于这个变量的检查来包装你的脚本，你可能会找到一个解决方案。

为了安全起见，您可以渲染某种散列，也将通过表单广告将它们与预期进行比较。

# python - Python中的广义特征值

> ID：10058083
> 
> 赞同：2
> 
> 时间：2012-04-07T20:28:50.293
> 
> 标签：python, eigenvalue

我正在尝试解决广义特征值问题 Ac = (lam).Bc 其中 A 和 B 是 nxn 矩阵，c 是 nx1 向量。(lam) 是特征值。

我正在使用python。我从 numpy.linalg 尝试了类似 eig(dot(inv(B),A)) 的东西，但结果证明它在我的问题中非常不稳定，因为它涉及反转。所以我一直在阅读可以在 MATLAB 中执行此操作，但我找不到任何函数或方法可以在 python 中执行此操作。任何想法将不胜感激。谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T21:31:40.170

Why don't you try using [scipy](http://www.scipy.org/)? It has a method in it's linear algebra module [scipy.linalg.eig](http://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.eig.html#scipy.linalg.eig) that can be used to "solve an ordinary or generalized eigenvalue problem."

```
scipy.linalg.eig(a, b=None, left=False, right=True, overwrite_a=False, overwrite_b=False)[source]

    Solve an ordinary or generalized eigenvalue problem of a square matrix.

    Find eigenvalues w and right or left eigenvectors of a general matrix:

    a   vr[:,i] = w[i]        b   vr[:,i]
    a.H vl[:,i] = w[i].conj() b.H vl[:,i]

    where .H is the Hermitean conjugation. 
```

# cakephp - cakephp 重定向到用户组

> ID：10058086
> 
> 赞同：0
> 
> 时间：2012-04-07T20:29:14.807
> 
> 标签：cakephp, cakephp-1.3, cakephp-2.0

我正在使用 acl，我想根据用户来自哪个组来重定向用户

在我的 appcaontroller 我有这个

```
public function beforeFilter() {
                                //Configure AuthComponent
                                //$this->Auth->allow('display');
                                $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login');
                                $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login');
                                $this->Auth->loginRedirect = array('controller' => 'posts', 'action' => 'add');
    } 
```

如果用户来自 group_id 1，我应该怎么做，他/她应该被重定向到不同于 group_id = 4 等的地方

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T20:44:26.930

好的，例如，您将每个用户重定向到一个动作 say `dashboard`。而不是重定向用户以添加`posts`控制器重定向到`dashboard`控制器的操作`users`。我假设您有另一个组表，并且您将它的外键保留在用户表中。

```
 $this->Auth->loginRedirect = array('controller' => 'users', 'action' => 'dashboard'); 
```

以上将在登录时将用户重定向到控制器中的`dashboard`操作。`users`现在要将每个用户带到特定组，获取用户的组名并重定向到特定页面。

```
 function dashboard() {
      //get user's group (role)
    $group_name = $this->User->Group->field('name', array('id' => $this->Auth->User('group_id')));
    //group selection logic here
    $action = 'dashboard_' . $group_name;
    $this->redirect('controller' => 'users' => 'action' => $action);
  } 
```

因此，上面的代码将使每个用户执行特定操作，例如，如果组名为“managers”，用户将被重定向到“managers_dashboard”。

# matlab - MATLAB 子图导出

> ID：10058088
> 
> 赞同：3
> 
> 时间：2012-04-07T20:29:20.383
> 
> 标签：matlab, plot, matlab-figure

我试图在 MATLAB 中绘制 3 个数字，它们在 MATLAB 中表现得很好。这是它在 MATLAB 中的外观截图。（即一旦我执行我的脚本） ![在此处输入图像描述](../Images/634490c35b8c136c3601097e71644659.png)

但是，当我使用 保存它时`print -djpeg -r300 Output.jpeg`，它看起来像这样： ![在此处输入图像描述](../Images/50ceb6edf5610570daea289ee2932311.png)

如何在**不从 FileExchange 下载任何文件的情况下修复它？** 我在 SE 上遇到过类似的问题，但他们都建议使用 FileExchange 上可用的文件。

这是我已经尝试过的：

```
set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [10 10]); 
set(gcf, 'PaperPosition', [0 0 10 10]);%No improvement 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T20:41:07.837

尝试`set(gcf, 'PaperPositionMode','auto')`

它将使打印尺寸适应图形的尺寸。它将解决您拥有的相对尺寸的所有问题:)

# entity-framework-4 - 如何让实体框架查找相关表中是否存在相关数据？

> ID：10058095
> 
> 赞同：1
> 
> 时间：2012-04-07T20:29:54.370
> 
> 标签：entity-framework-4, linq-to-entities, exists, lookupfield

我正在努力使实体框架项目更具可扩展性以满足我们的要求。该项目使用 EDMX 文件、实体框架和 .NET 4.0。该项目已全局设置延迟加载。

基本上，我有 2 张桌子：

```
Product
  ProductId

ProductVariant
  ProductVariantId
  ProductId 
```

我有一种情况，即给定产品的 ProductVariant 中将有数十万个相关行。所以我想删除 ProductVariant 的导航属性并进行查询以仅查找最相关的数据，而不是所有相关数据。

但是，大多数代码都执行以下操作：

```
if (Product.HasVariants) { [Loop Through Variants And Do Something] } 
```

我将更改为：

```
if (Product.HasVariants) { [Lookup Subset of Variants from DB And Do Something] } 
```

HasVariants 是一种目前看起来像这样的方法：

```
public bool HasVariants()
{
    return this.Variants.Count > 0;
} 
```

变体是一个导航属性。我想做的是创建一个查找查询，其中包含一个指示变量表中是否存在任何相关数据的字段，而不是每次代码执行此检查时都调用数据库。

这就是我在存储过程中完成此操作的方式：

```
CREATE Procedure GetProduct
  @ProductId
AS

Declare @HasVariants bit

Set @HasVariants = EXISTS(Select ProductVariantId 
                          From ProductVariant 
                          Where ProductId = @ProductId)

SELECT ProductId, <Other Fields>, @HasVariants AS HasVariants
FROM Product
WHERE ProductID = @ProductID

Return 
```

请注意 HasVariants 字段的存在，我将在 HasVariants 方法而不是集合中使用该字段。

我的问题是如何使用基于 EDMX 的模型完成相同的事情（相关表中的查找字段）？我想在代码中不使用 SQL 语句的情况下执行此操作，但如果解决方案涉及将 HasVariants 设置为导航属性（可能吗？），这是可以接受的。我已经了解如何编写查询以按需执行，我正在寻找一种使实体框架缓存 HasVariants 属性的方法，就像它对其余产品数据所做的那样。

如果我没有提供足够的信息，请原谅我。我是实体框架的新手，我真的不确定要回答这个问题需要什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T01:47:51.103

如果要复制存储过程，则需要创建一个新类并实现如下内容：

```
public IQueryable<ProductWithHasVariant> GetProduct(DBContext context, int productId)
{
  return from p in context.Products
         where p.ProductId == productId
         select new ProductWithHasVariant
         {
           p.ProductId,
           HasVariants = p.Variants.Any(),
           .
           .
           .
         };
} 
```

# java - 为什么这个 INSERT 添加一个额外的空行？

> ID：10058096
> 
> 赞同：2
> 
> 时间：2012-04-07T20:29:54.993
> 
> 标签：java, mysql

当我将数据插入表中时，它会在每个填充行之后添加一个空（空白）行。所以结果看起来像：

```
data1

data2

data3 
etc 
```

创建表代码为：

```
String title =
            "CREATE TABLE "+ db +".title ("+
                      "id int(11) NOT NULL AUTO_INCREMENT,"+
                      "name varchar(255) DEFAULT NULL,"+
                      "PRIMARY KEY (id))"; 
```

插入看起来像这样：

```
String data = null;
data = in.readLine();
if(data!=null)
st.execute("INSERT INTO "+db+" .title (name) VALUES ('" + data + "')"); 
```

谁能告诉我为什么这段代码添加了一个空行？

PS。对于大多数其他表，这不会发生。我只有 2 张桌子有问题。此外，当我通过 phpmyadmin 执行该查询时，它不会创建一个空行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T14:55:14.430

而不是“if(data!=null)”，你需要有一些东西来检查所有的空格和空值，看看使用正则表达式来找到它（我相信“/s”会起作用）。

# c - 知道指针指向的有效元素大小的方法是什么？

> ID：10058097
> 
> 赞同：2
> 
> 时间：2012-04-07T20:29:55.873
> 
> 标签：c

假设我想打印出存储在“数组”中的整数，这确实是内存中的一个指针。当我使用代码时：

```
int main(void)
{
  int *arr = malloc(3*sizeof(int));
  int *p = arr;
  *arr++=1;
  *arr++=2;
  *arr=3;

  while (??)           // what should be filled in the while?
    printf("%d",*p);   // so that we can get the validly stored elements?

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T20:31:58.440

C 没有提供内置方法来查找动态分配的内存块的大小。您必须存储大小，并“在侧面”传递它。

解决这个问题的一种方法是创建一个`struct`组合指针和一个`size_t`描述数组中分配的元素数量的值。

# c# - 最终用户应用程序应针对哪个版本的 .Net 框架

> ID：10058102
> 
> 赞同：2
> 
> 时间：2012-04-07T20:30:33.510
> 
> 标签：c#, .net

我正在用 android 编写一个小应用程序，它在 .Net (C#) 中有一个服务器部分。显然，我想针对最大数量的最终用户，而不必处理没有框架安装的问题。

我想知道我的应用程序应该针对哪个 .Net 框架？或者我最希望在用户的机器上出现哪个版本？

谢谢，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-07T20:34:44.553

> 或者我最希望在用户的机器上出现哪个版本？

这实际上取决于您的用户群。

如果你想针对所有平台，你不能*保证*会有任何合理的版本，所以你的部署应该包括框架的检查和安装。请注意，如果您知道您的用户群通常使用 Windows 7，例如，您可以[保证他们将拥有 .NET 3.5](http://en.wikipedia.org/wiki/.NET_Framework#History)，但如果有些人使用 XP，则无法保证，因为 XP 不包含任何版本。

就个人而言，我只会针对您想要的版本，并始终包含框架安装。包括检查以安装框架的“成本”非常小，尤其是如果您使用 Web 安装程序，则比针对较旧的框架版本并将自己限制在不太丰富的开发体验中的开发成本要小得多。

# scala - 如何比较scala中两种不同类型的对象？

> ID：10058103
> 
> 赞同：3
> 
> 时间：2012-04-07T20:30:46.490
> 
> 标签：scala, floating-point

当我在 scala 解释器中检查值时，例如：

```
scala> 1==1.0000000000000001

res1: Boolean = true

scala> 1==1.000000000000001

res2: Boolean = false 
```

在这里，我没有得到与“scala 编译器如何将这些解释为整数或浮点数或双精度数（以及比较）”相关的清晰视图。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-07T20:41:15.587

它不是真正的 Scala 相关，它更多的是[ieee-754](/questions/tagged/ieee-754 "显示标记为“ieee-754”的问题")浮点算术问题。首先，当与它进行比较时`Int`，`Double`它会`Int`转换为`Double`（总是安全的）。第二种情况很明显——价值观不同。

第一种情况发生的情况是该`Double`类型无法存储那么多有效数字（在您的情况下为 17，64 位浮点最多可以存储 16 个十进制数字），因此它将值四舍五入为`1`. 和`1 == 1`。

# iphone - iOS 应用在 appStore 上可用后改变了行为

> ID：10058105
> 
> 赞同：2
> 
> 时间：2012-04-07T20:31:05.520
> 
> 标签：iphone, ios, app-store, three20

我已经使用基本 SDK ios 5.0 创建了一个针对 ios 4.1 的应用程序，并使用 3G(ios 4.3.3) 3GS(5.1) 3GS(5.0) iPad(5.1) 对其进行了测试。我的应用在所有这些设备上都表现良好。但是，当苹果最终接受该应用程序并且我将其下载到相同的设备上时，行为发生了变化。问题是显示的页面过大，但如果我移动它们，它们会正确开始适合屏幕。当应用发布后改变其行为时，你们中是否有人遇到过类似的情况？

而最重要的。当在真实设备上从 mac 运行的同一个应用程序表现出色时，我该如何重现此错误？我可能会补充说，基本 SDK 设置为最新（5.0），但应用程序使用不支持 ios 5.1 的 XCode 4.2 存档。

对我好一点，这是我的第一个问题:)

编辑：在 hotpaw 的有用提示之后，我检查了问题是发布版本。在运行配置中更改目标后，我可以在设备上重现该错误。从调试到发布。

有趣的是，令人沮丧的是，我无法解决这个问题，但是，我已经在 xcode 4.3 上以发布模式测试了我的应用程序，它运行良好。我没有改变任何东西，但它有效。它无法打包构建（请参阅问题[Xcode 4.3.1 - 打包操作失败](https://stackoverflow.com/questions/9664661/xcode-4-3-1-packaging-operation-failed)），所以我坚持使用 xcode 4.2

有一段时间我怀疑该错误是由编译器在为 thumb 编译时引起的，解决方案是将 -mno-thumb 添加到其他 c 标志。但是我没有强制使用该标志。请参阅：[iOS5 Xcode4.2 浮点字节对齐错误？](https://stackoverflow.com/questions/7763337/ios5-xcode4-2-floating-point-byte-align-error)

当我比较编译日志时，我可以看到 xcode 4.3 使用 -arch armv6 编译，而 xcode 4.2 使用 -arch armv6 编译。但它与我连接到计算机的设备相同。我没有发现其他差异，但它们可能存在。如果有帮助，我可以粘贴示例文件的编译日志。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T20:49:03.303

如果您只测试 Debug Builds，然后将 Release Build 提交到 App Store，就会发生这种情况。对于最终测试，您需要强制 Xcode 使用 Release 构建进行测试（可能通过编辑默认方案），然后提交此构建，除了代码签名之外，绝对不更改构建设置。

您可能还希望通过 iTunes 在新重置的设备上通过 Ad Hoc 安装最终测试您的 Release 构建，该设备的所有先前构建都已从中删除。请参阅[Apple 的说明](https://developer.apple.com/library/ios/#qa/qa1764/_index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T09:12:42.573

问题出在错误的编译器上！

将 -mno-thumb 应用于我的项目后，我没有注意到差异，因为我使用的库（Three20）设置为仅针对导致问题的 armv6 而不是我的项目进行编译。将 -mno-thumb 添加到 Three20 的所有项目后，该错误消失了！

我将就这个问题通知 Three20 团队。

# javascript - 如何使 Javascript 更具体？

> ID：10058106
> 
> 赞同：0
> 
> 时间：2012-04-07T20:31:07.957
> 
> 标签：javascript

我是 JavaScript 新手，所以我认为我的问题可能很简单。这有效：

```
var convId = document.getElementById("wrapper");
convId.setAttribute("align","right"); 
```

但是当我试图让它更具体时：

```
var convId = document.getElementById("wrapper");
var convIdDl = convId.getElementsByTagName("dl");
convIdDl.setAttribute("align","right"); 
```

我的定义列表没有右对齐。我已经检查了 HTML 和 CSS，一切都是正确的，但这甚至不应该被 JavaScript 覆盖。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T20:32:36.503

该[`getElementsByTagName`](https://developer.mozilla.org/en/DOM/element.getElementsByTagName)方法返回一个集合（更具体地说， a `NodeList`）。您需要指定要使用该集合的哪个元素（就像访问数组中的元素时一样）。在这里，我假设您想要第一个：

```
convIdDl[0].setAttribute("align", "right"); 
```

如评论中所述，您绝对不应该使用该`align`属性。在所有情况下都应使用 CSS。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-07T20:33:57.403

该`getElementsByTagName()`函数返回一个 DOM 元素的集合，因此您可能需要遍历它并分别为每个元素设置属性。

```
for(var i = 0; i < convIdDl.length; i++) {
    convIdDl[i].setAttribute("align", "right");
} 
```

# c# - 对于下拉列表，SelectedIndex 始终返回值 0

> ID：10058107
> 
> 赞同：0
> 
> 时间：2012-04-07T20:31:09.873
> 
> 标签：c#, asp.net

我的网页中有一个下拉列表，无论用户选择哪个项目，它总是返回值 0 作为所选索引。我已经使用数据库查询填充了下拉列表。我正在填充页面中的 Page_Load 方法。下面显示的代码执行指定的工作： int danceid;

```
 protected void Page_Load(Object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            PopulateDanceDropDown();
        }

    }    

    private void PopulateDanceDropDown()
    {         
        DataTable dt = new DataTable();DataRow row = null;
        dt.Columns.Add("Did", Type.GetType("System.Int32"));
        dt.Columns.Add("DName", Type.GetType("System.String"));    
        var dancer_dance = (from dd in context.DANCER_AND_DANCE
                       where dd.UserId == dancerId
                       select new
                       {
                           Value = dd.DanceId,
                           Text = dd.DanceName

                       }).ToList();    

        foreach (var dndd in dancer_dance)
        {        
            row = dt.NewRow();
            row["Did"] = dndd.Value;
            row["DName"] = dndd.Text;
            dt.Rows.Add(row);    dances.DataSource = dt;    
            dances.DataTextField = dt.Columns[1].ToString();
        if (!IsPostBack)
        {
            dances.DataBind();
        }

    }    
    protected void changeIndex(object o, EventArgs e)
    {
        danceid = dances.SelectedIndex;
    }
    protected void dropthedance(object o, EventArgs e)
    {
        int danceIDFromDropDown = danceid;
        var dancer_dance = from dd in context.DANCER_AND_DANCE
                           where dd.DanceId == danceIDFromDropDown
                           select dd;
        foreach (var dndd in dancer_dance)
        {
             context.DANCER_AND_DANCE.DeleteOnSubmit(dndd);

        }
        try
        {
            context.SubmitChanges();
        }

        catch (Exception ex)
        {
            Console.WriteLine(ex);
        }
  } 
```

该行 int danceIDFromDropDown = danceid; 在 dropthedance 方法中的值始终为 0。请帮助某人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T20:37:39.787

代替

```
int danceIDFromDropDown = danceid; 
```

和

```
int danceIDFromDropDown = dances.SelectedIndex; 
```

它可能会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:14:42.833

您确定要将索引用作 ID 吗？通常，您需要将数据库中的实际 ID 设置为 DataValueField，然后您可以通过这种方式获取值。

但我也注意到你抓取索引并将其放入 indexchanged 事件的变量中，然后你尝试在不同的方法中使用该值。我假设 danceid 是此处未显示的某个属性。无论如何，该值不会通过回发持续存在。不要像在桌面应用程序上那样尝试将其存储在变量中，而是尝试将 EnableViewState="True" 添加到下拉控件中。然后直接在您的提交处理程序上获取该索引。或者，如果您真的想将它存储在一个变量中，然后尝试通过将其存储在会话中或缓存它来持久化该变量的值，然后在实际使用该值时从该缓存/会话变量中提取。

But again, it might be better practice to place the danceid in the listitem object itself. Just the though of basing IDs on item indexes makes me shudder, especially when you populating the list from a database, because what happens when you add a new item to that list in the library and then try to sort them by name... then your indices become useless.

# asp.net - 如何显示单选按钮列表中的选定值

> ID：10058109
> 
> 赞同：0
> 
> 时间：2012-04-07T20:31:26.427
> 
> 标签：asp.net, vb.net, radiobuttonlist

我试过

```
Dim theme = rblTheme.Items(rblTheme.SelectedIndex).Value 
```

选择第一个值

```
Dim theme = rblTheme.SelectedItem.Value 
```

选择第一个值

```
Dim theme = ""
        For i As Integer = 0 To rblTheme.Items.Count - 1

            If (rblTheme.Items(i).Selected) Then
                theme = rblTheme.Items(i).Value
            End If
        Next 
```

选择两个值。

需要帮忙 ！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T20:37:44.290

```
 Dim selectedItemVal as string
 selectedItemVal=rblTheme.SelectedValue; 
```

我猜您正在重新加载页面回发中的 RadioButton 列表（当您单击某个按钮时）。因此，如果 isPostBack 属性为 false，您可能应该移动该代码

```
 protected void Page_Load(object sender, EventArgs e)
 {
     if(!IsPostBack)
     {
        //Your code to load the Radio button list control
     }
 } 
```

现在您应该能够获得按钮单击事件的值。

# git - 是否可以在裸 git repo 中获得工作树？

> ID：10058112
> 
> 赞同：2
> 
> 时间：2012-04-07T20:31:41.320
> 
> 标签：git

我目前正在使用 gitolite，并且在我的 post-receive 钩子中，如果任何传入的提交在 master 上，我将推送到（本地）镜像。

问题是，*该*镜像仅存在，因为我想在推送到 master 时自动部署和测试：我无法获取 中的索引文件`work.git`，所以我推送到非裸`work`仓库以获取工作树，并运行完全独立的接收后挂钩。

这种方法有两个问题：

1.  感觉很笨
2.  如果测试失败，我会收到电子邮件通知我，而不是拒绝提交。（在频率方面实际上并不是那么大的问题，我只是不喜欢它。）

处理这个问题的标准方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:05:59.903

这并不愚蠢。裸存储库被称为裸存储是有原因的。（我认为这就是您所说的“原始”。）

要回答你真正的问题，我认为你需要退后一步，问问你真正想要做什么。你想拒绝*提交*吗？提交是本地的，与推送无关，因此您必须自己运行自动化测试，无论是在预提交钩子中还是手动。您要拒绝推送吗？**post** -receive (或 post-update) 为时已晚，但如果你真的想要，你可以在**pre**-receive（或更新）挂钩。我怀疑这是一个坏主意：测试需要时间，而且我不确定你是否真的想等到你的推送挂起直到测试完成。（关于拥有单独存储库的交易并不真正相关 - 挂钩运行一些命令，无论它们是否涉及另一个存储库，它们都必须在挂钩退出之前完成。）

但也许更可持续的工作流程是：推送到 pre-master 分支，让自动化测试开始，当它们*完成*时，自动推送到 master 分支。如果测试失败，主分支将不会更新，您可以获取您的电子邮件并查看它。

# javascript - 动态分配 Javascript 变量。[摆脱 eval()]

> ID：10058115
> 
> 赞同：1
> 
> 时间：2012-04-07T20:31:50.417
> 
> 标签：javascript, coffeescript

我想改进一个小框架，因此我想摆脱对`eval`.

让代码说话：

```
# irf.coffee (The Framework)
# Classes which are appended to the namespace 'IRF'
classes = [
  "Background"
  "BoundingBox"
  # ...
]

# Namespace where to attach classes
@IRF = {}

# TODO: Get rid of eval(c)
for c in classes
  @IRF[c] = eval(c) 
```

我只想`IRF`“污染”全局命名空间，这样我就可以访问类/对象，例如`new IRF.Background()`.

这个框架的目标是被包括这个框架在内的其他项目使用。所以我可能有一个这样的项目：

```
class TowerMap extends IRF.Game
  constructor: (width, height) ->
    @background = new IRF.Background(width, height) 
```

如您所见，我必须在`IRF`这里使用命名空间，但在这个特定项目中，我想在没有命名空间的情况下使用它，因为我这样做了：

```
# Require all Class of IRF, so we won't need namespace here
# TODO: get rid of eval
eval("var #{k} = v") for k,v of IRF

class TowerMap extends Game
  constructor: (width, height) ->
    @background = new Background(width, height) 
```

一切都按预期进行，但不知何故，这两个人`eval`打扰了我。可能有另一种解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T20:40:49.690

无法从当前上下文中按名称访问局部变量（至少在 ecmascript 中。也许咖啡脚本有一些非标准扩展名）。

只能访问某个对象的属性。全局变量也可以被访问，因为它们是全局对象的属性；它`window`在浏览器中，可以像`(function(){ return this })()`在 ecma-3 中一样获得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T20:37:11.743

为什么不只导入您需要的位？

```
Background = IRF.Background

class TowerMap extends Game
  constructor: (width, height) ->
    @background = new Background(width, height) 
```

您应该知道，`eval`在 EcmaScript 5 中，严格模式不能引入新的变量声明，因此`eval('var x = ...')`在严格模式下不会生成对周围的非 eval 代码可见的变量。

[EcmaScript 5 附录 C](http://es5.github.com/#C)说

> 严格模式`eval`代码无法将调用者的变量环境中的变量或函数实例化为`eval`. 相反，会创建一个新的变量环境，并将该环境用于`eval`代码 (10.4.2) 的声明绑定实例化。

# prototypejs - Prototype.js 1.6 新元素类和 IE >= 9

> ID：10058117
> 
> 赞同：3
> 
> 时间：2012-04-07T20:31:58.493
> 
> 标签：prototypejs, internet-explorer-9

然后我试图创建一个新元素，例如

```
new Element('div',{'class':'name'}); 
```

所有浏览器都会创建一个带有“name”类的新元素。但在 Internet Explorer 9 和 10 中，我有这个

```
<div className="name"></div> 
```

如您所见，它创建了 className 属性而不是 class。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T19:20:54.633

```
//This generates 'className':
var popoutControl = new Element('div', {'class':'mySuperCoolClassName'});

// Break the line up into two lines. 
// The following will generate a 'class' attribute instead:
var popoutControl = new Element('div');
popoutControl.className = 'mySuperCoolClassName'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:32:33.293

代替

```
new Element('div',{'class':'name'}); 
```

和

```
var mydiv = new Element('div');
mydiv.addClassName('name'); 
```

正如[http://prototypejs.org/api/element/classNames](http://prototypejs.org/api/element/classNames)元素所建议的那样。**类名**（'名称'）；已弃用，您应该使用 Element。**添加类名**（）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-18T21:01:22.110

请在此处查看我的答案：

[https://stackoverflow.com/a/20668126/1274995](https://stackoverflow.com/a/20668126/1274995)

基本上，Prototype 1.6 在那些版本的 IE 中是有缺陷的。您应该更新原型。问题是 Element._attributeTranslations.write 中包含的翻译列表

![原型 1.6.0.3 中的 Object Element._attributeTranslations.write](../Images/123b31c1abc25143b29fd2d62fd8784a.png)

这是 Prototype 1.7 中的列表（我想是以上）

![原型 1.7+ 中的 Element._attributeTranslations.write](../Images/61a36f56fa07f0f0ace9307a884be891.png)

我想这适用于旧版本的 IE（这可能是 IE9 之前的版本）。

# java - AsyncTask 冻结 UI

> ID：10058123
> 
> 赞同：0
> 
> 时间：2012-04-07T20:32:25.833
> 
> 标签：java, android, user-interface, rss, android-asynctask

我有一个 AsyncTask 那么多 rss 信息，然后将它应用到 UI。我有一个加载过程的指示器，当它在后台加载信息时，UI 运行顺利，但是当我调用 PublishProgress() 以便我可以编辑 UI 时，指示器冻结。这里有一些代码可以更好地解释它：

```
 class LoadRss extends AsyncTask<Void, Void, Void> {
                    protected Void doInBackground(Void...voids) {
                        changeRSS(checkedId);
                        publishProgress();
                        return null;
                     }
                    protected void onPostExecute(Void voids) {

                        frameAnimation.stop();
                        syncHomeSymbol.setImageResource(R.drawable.none);
                        syncHomeSymbol.setBackgroundColor(color.background_dark);
                     }
                    @Override
                    protected void onProgressUpdate(Void... values) {
                        super.onProgressUpdate(values);
                        InitHome();
                        }
                }
            new LoadRss().execute(); 
```

changeRSS 是提取 RSS 信息的方法。
InitHome 是改变 UI 的方法。

非常感谢你！

初始化主页

```
private void InitHome() {
if (isNetworkAvailable()) {
    homeLayout.removeAllViews();
    int enclosureCounter = 0;
        for (int i=0;i<rssRes.getLength();i++) {
            String title;
                final String link;
                String description, pubDate;
            EnclosureItem enclosure;
            title = rssRes.getTitle()[i];
            link = rssRes.getLink()[i];
            description = rssRes.getDescription()[i];
            pubDate = rssRes.getPubDate()[i];
            try {
                enclosure = rssRes.getEnclosure().get(enclosureCounter);
            if (enclosure.getPos() == i) {
                LinearLayout horizontal = new LinearLayout(this);
                horizontal.setOrientation(LinearLayout.HORIZONTAL);
                horizontal.setBackgroundResource(R.drawable.rounded_layout);
                LinearLayout.LayoutParams p = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT);
                p.setMargins(10, 10, 10, 10);
                horizontal.setLayoutParams(p);
                horizontal.setOnClickListener(new OnClickListener() {

                        public void onClick(View v) {
                        Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(link));
                        startActivity(browserIntent);
                        }
                    });
                ImageView img = new ImageView(this);
                Drawable drawable = LoadImageFromWebOperations(enclosure.getUrl());
                img.setImageDrawable(drawable);
                LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(120, LinearLayout.LayoutParams.FILL_PARENT);
                img.setLayoutParams(layoutParams);
                img.setScaleType(ScaleType.CENTER_CROP);
                horizontal.addView(img);
                LinearLayout vertical = new LinearLayout(this);
                vertical.setOrientation(LinearLayout.VERTICAL);

                TextView textTitle = new TextView(this);
                if (SPM.getFix()) {
                    textTitle.setGravity(Gravity.LEFT);
                }
                else {
                    textTitle.setGravity(Gravity.RIGHT);
                }
                textTitle.setTextSize(1, 18);
                textTitle.setText(Html.fromHtml("<font color='#92b64a'>"+title+"</font><br />"));
                vertical.addView(textTitle);

                TextView textDescription = new TextView(this);
                    if (SPM.getFix()) {
                        textDescription.setGravity(Gravity.LEFT);
                    }
                    else {
                        textDescription.setGravity(Gravity.RIGHT);
                    }
                    String str = Html.fromHtml(description).toString();
                    try{
                        str = str.substring(0,str.lastIndexOf("\n\n"));
                    }
                    catch (IndexOutOfBoundsException e) { }
                    textDescription.setText(Html.fromHtml(new RssOrganizer(str,false).getDescription()));
                vertical.addView(textDescription);

                TextView textpubDate = new TextView(this);
                if (SPM.getFix()) {
                    textpubDate.setGravity(Gravity.LEFT);
                }
                else {
                    textpubDate.setGravity(Gravity.RIGHT);
                }
                textpubDate.setText(new RssOrganizer(pubDate,true).getPubDate()+"\n\n");
                vertical.addView(textpubDate);
                enclosureCounter++;
                horizontal.addView(vertical);
                homeLayout.addView(horizontal);
            }
            else {
                setRegHome(i);
            }
        }
            catch (IndexOutOfBoundsException e) {
                setRegHome(i);
        }
        }
}

else
{
        tRSS.setText(R.string.noINNERinternetConnection);
}   
}

private void setRegHome(int i) {

    String title;
    final String link;
    String description, pubDate;
    title = rssRes.getTitle()[i];
    link = rssRes.getLink()[i];
    description = rssRes.getDescription()[i];
    pubDate = rssRes.getPubDate()[i];
    LinearLayout vertical = new LinearLayout(this);
    vertical.setOrientation(LinearLayout.VERTICAL);
    vertical.setBackgroundResource(R.drawable.rounded_layout);
    LinearLayout.LayoutParams p = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT);
    p.setMargins(10, 10, 10, 10);
    vertical.setLayoutParams(p);
    vertical.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(link));
            startActivity(browserIntent);   
        }
    });
    TextView textTitle = new TextView(this);
        if (SPM.getFix()) {
            textTitle.setGravity(Gravity.LEFT);
        }
        else {
            textTitle.setGravity(Gravity.RIGHT);
        }
        textTitle.setTextSize(1, 18);
        textTitle.setText(Html.fromHtml("<font color='#92b64a'>"+title+"</font><br />"));
        vertical.addView(textTitle);

        TextView textDescription = new TextView(this);
            if (SPM.getFix()) {
                textDescription.setGravity(Gravity.LEFT);
            }
            else {
                textDescription.setGravity(Gravity.RIGHT);
            }
            String str = Html.fromHtml(description).toString();
            try{
                str = str.substring(0,str.lastIndexOf("\n\n"));
            }
            catch (IndexOutOfBoundsException e) { }
        textDescription.setText(Html.fromHtml(new RssOrganizer(str,false).getDescription()));
        vertical.addView(textDescription);

        TextView textpubDate = new TextView(this);
        if (SPM.getFix()) {
            textpubDate.setGravity(Gravity.LEFT);
        }
        else {
            textpubDate.setGravity(Gravity.RIGHT);
        }
        textpubDate.setText(new RssOrganizer(pubDate,true).getPubDate()+"\n\n");
        vertical.addView(textpubDate);
        homeLayout.addView(vertical);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T23:10:32.900

`onProgressUpdate(...)`在 UI 线程上运行，因此它不应该做很多耗时的工作——这首先会破坏 AsyncTask 的使用。

理想情况下`onProgressUpdate(...)`，应该简单地提供基本的进度更新，例如完成百分比或指示进度的简单文本消息。

All views used to show progression should be created beforehand however, many people use `onPreExecute()` for this.

# java - 持久性单元无法建立多对多关系

> ID：10058127
> 
> 赞同：0
> 
> 时间：2012-04-07T20:32:43.790
> 
> 标签：java, database, jpa, persistence, relation

好的，这是一个奇怪的问题，因为我之前有它工作过。所以我有两个课程：游戏和开发人员。他们有一个多对多的关系。持久性单元自动生成表 game_developer。因此有 3 个表：game developer 和 game_developer。当我在数据库中输入信息时。桌面游戏和开发者将正常获取值，但桌面游戏_开发者将保持为空。所以这种关系是不被认可的。此外，当我运行 webapp 时，表内的所有内容都应该被删除。开发人员很好，但游戏仍然存在。

任何朝着正确方向的推动都值得赞赏。

先感谢您，

大卫

初始化：

```
try {
        gameOrganizer = (GameOrganizer) getServletContext().getAttribute("database");

        Game game = new Game("Counter Strike: source");
        Game game2 = new Game("Battlefield: bad company 3");
        Game game3 = new Game("Killing floor");

        Developer devel = new Developer("valve");
        Developer devel2 = new Developer("EA Games");
        Developer devel2b = new Developer("DICE");
        Developer devel3 = new Developer("Ubisoft");

        //The GameOrganizer is the controller between the model en the view. 
        //The view being the website.
        //So gameOrganizer.addGame(game) will persist the object to the database.

        gameOrganizer.addGame(game);
        gameOrganizer.addGame(game2);
        gameOrganizer.addGame(game3);

        gameOrganizer.addDeveloper(devel);
        gameOrganizer.addDeveloper(devel2);
        gameOrganizer.addDeveloper(devel2b);
        gameOrganizer.addDeveloper(devel3);

        game.addDeveloper(devel);
        devel.getGames().add(game);

        game2.addDeveloper(devel2);
        devel2.getGames().add(game2);

        game2.addDeveloper(devel2b);
        devel2b.getGames().add(game2);

        game3.addDeveloper(devel3);
        devel3.getGames().add(game3);

    } catch (DatabaseException ex) {
        Logger.getLogger(GameController.class.getName()).log(Level.SEVERE, null, ex);
    } catch (DomainException ex) {
        Logger.getLogger(GameController.class.getName()).log(Level.SEVERE, null, ex);
    } 
```

游戏类：

```
@Entity
public class Game implements Serializable{

    private String gameNaam;
    private double prijs;
    @ManyToMany(mappedBy = "games")
    private Collection<Developer> developers = new ArrayList<Developer>();

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    public Game(){};
    .
    .
    //methods
    .
    .
  } 
```

开发者类

```
@Entity
public class Developer implements Serializable  {

    private String naam;
    private String info;
    @ManyToMany
    private Collection<Game> games = new ArrayList<Game>();
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    public Developer() {
    }
    .
    .
    //methods
    .
    .
 } 
```

持久性单元：

```
 <?xml version="1.0" encoding="UTF-8"?>
 <persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
 <persistence-unit name="GameDatabaseSitePU" transaction-type="RESOURCE_LOCAL">
   <provider>oracle.toplink.essentials.PersistenceProvider</provider>
    <class>domainmodel.Developer</class>
    <class>domainmodel.Game</class>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <properties>
      <property name="toplink.jdbc.user" value="app"/>
      <property name="toplink.jdbc.password" value="app"/>
      <property name="toplink.jdbc.url" value="jdbc:derby://localhost:1527/GameDatabase;create=true"/>
      <property name="toplink.jdbc.driver" value="org.apache.derby.jdbc.ClientDriver"/>
      <property name="toplink.ddl-generation" value="drop-and-create-tables"/>
    </properties>
  </persistence-unit>
</persistence> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T20:57:29.813

我认为在双向多对多关系中，您需要设置双方...

即如果你这样做

devel.getGames().add(游戏);

你还需要做

game.getDeveloper().add(devel);

否则 JPA 不会真正看到另一面，映射表中的插入将类似于 (FK1, null)，这将失败，这就是为什么你不会看到任何条目......

我对toplink不太了解，但我认为类似

```
<property name="toplink.logging.level" value="FINE"/> 
```

应该在您的日志记录中为您提供 sql 语句，这有助于调试此类问题:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:00:01.870

无法识别该关系，因为您在建立关系之前保留了对象。`gameOrganizer.add..()`在将对象添加到彼此的集合后执行调用。还将级联持久性添加到您的开发人员的多对多关系中：

```
@ManyToMany(cascade = CascadeType.PERSIST, mappedBy = "games")
private Collection<Developer> developers = new ArrayList<Developer>(); 
```

然后你只需要坚持游戏。

# python - 通过索引访问 collections.OrderedDict 中的项目

> ID：10058140
> 
> 赞同：164
> 
> 时间：2012-04-07T20:34:19.150
> 
> 标签：python, collections, dictionary, python-3.x, ordereddictionary

可以说我有以下代码：

```
import collections
d = collections.OrderedDict()
d['foo'] = 'python'
d['bar'] = 'spam' 
```

有没有办法以编号方式访问项目，例如：

```
d(0) #foo's Output
d(1) #bar's Output 
```

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2012-04-07T20:46:29.133

如果是这样，`OrderedDict()`您可以通过获取（键，值）对的元组来轻松访问元素，如下所示

```
>>> import collections
>>> d = collections.OrderedDict()
>>> d['foo'] = 'python'
>>> d['bar'] = 'spam'
>>> d.items()
[('foo', 'python'), ('bar', 'spam')]
>>> d.items()[0]
('foo', 'python')
>>> d.items()[1]
('bar', 'spam') 
```

**Python 3.X 的注意事项**

`dict.items`将返回一个[可迭代的 dict 视图对象](http://docs.python.org/3.3/library/stdtypes.html#dict-views)而不是一个列表。我们需要将调用包装到一个列表中以使索引成为可能

```
>>> items = list(d.items())
>>> items
[('foo', 'python'), ('bar', 'spam')]
>>> items[0]
('foo', 'python')
>>> items[1]
('bar', 'spam') 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-04-08T04:29:40.913

您是否必须使用 OrderedDict 或者您是否特别想要一种类似地图的类型，该类型以某种方式排序并具有快速位置索引？如果是后者，那么请考虑 Python 的许多排序 dict 类型之一（它根据键排序顺序对键值对进行排序）。一些实现还支持快速索引。例如，[sortedcontainers](http://www.grantjenks.com/docs/sortedcontainers/)项目有一个[SortedDict](http://www.grantjenks.com/docs/sortedcontainers/sorteddict.html)类型用于此目的。

```
>>> from sortedcontainers import SortedDict
>>> sd = SortedDict()
>>> sd['foo'] = 'python'
>>> sd['bar'] = 'spam'
>>> print sd.iloc[0] # Note that 'bar' comes before 'foo' in sort order.
'bar'
>>> # If you want the value, then simple do a key lookup:
>>> print sd[sd.iloc[1]]
'python' 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2014-06-29T19:38:10.157

如果您想要 OrderedDict 中的*第一个*条目（或接近它）而不创建列表，这是一种特殊情况。（这已更新到 Python 3）：

```
>>> from collections import OrderedDict
>>> 
>>> d = OrderedDict()
>>> d["foo"] = "one"
>>> d["bar"] = "two"
>>> d["baz"] = "three"
>>> next(iter(d.items()))
('foo', 'one')
>>> next(iter(d.values()))
'one' 
```

（你第一次说“next()”时，它的真正意思是“第一个”。）

在我的非正式测试中，`next(iter(d.items()))`使用小的 OrderedDict 仅比`items()[0]`. 具有 10,000 个条目的 OrderedDict`next(iter(d.items()))`比`items()[0]`.

**但是**，如果您保存 items() 列表一次然后大量使用该列表，那可能会更快。或者，如果您反复{创建一个 items() 迭代器并逐步将其带到您想要的位置}，那可能会更慢。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-06-15T13:06:02.547

使用包中的**IndexedOrderedDict**会显着提高效率[`indexed`](https://pypi.python.org/pypi/indexed)。

根据 Niklas 的评论，我对**OrderedDict**和**IndexedOrderedDict**进行了 1000 个条目的基准测试。

```
In [1]: from numpy import *
In [2]: from indexed import IndexedOrderedDict
In [3]: id=IndexedOrderedDict(zip(arange(1000),random.random(1000)))
In [4]: timeit id.keys()[56]
1000000 loops, best of 3: 969 ns per loop

In [8]: from collections import OrderedDict
In [9]: od=OrderedDict(zip(arange(1000),random.random(1000)))
In [10]: timeit od.keys()[56]
10000 loops, best of 3: 104 µs per loop 
```

**在这种特定情况下， IndexedOrderedDict**在特定位置索引元素的速度要快约 100 倍。

列出的其他解决方案需要额外的步骤。 `IndexedOrderedDict`是 的替代品`OrderedDict`，除了它是可索引的。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-11-09T13:15:39.287

*这个社区 wiki 试图收集现有的答案。*

**蟒蛇 2.7**

在 python 2 中，返回列表的`keys()`、`values()`和`items()`函数。`OrderedDict`举个例子，最简单的方法`values`是

```
d.values()[0]  # "python"
d.values()[1]  # "spam" 
```

对于只关心单个索引的大型集合，您可以避免使用生成器版本创建完整列表`iterkeys`，`itervalues`和`iteritems`：

```
import itertools
next(itertools.islice(d.itervalues(), 0, 1))  # "python"
next(itertools.islice(d.itervalues(), 1, 2))  # "spam" 
```

indexed.py包提供了[专](https://pypi.python.org/pypi/indexed.py)`IndexedOrderedDict`为此用例设计的，将是最快的选择。

```
from indexed import IndexedOrderedDict
d = IndexedOrderedDict({'foo':'python','bar':'spam'})
d.values()[0]  # "python"
d.values()[1]  # "spam" 
```

对于具有随机访问的大型字典，使用 itervalues 会快得多：

```
$ python2 -m timeit -s 'from collections import OrderedDict; from random import randint; size = 1000;   d = OrderedDict({i:i for i in range(size)})'  'i = randint(0, size-1); d.values()[i:i+1]'
1000 loops, best of 3: 259 usec per loop
$ python2 -m timeit -s 'from collections import OrderedDict; from random import randint; size = 10000;  d = OrderedDict({i:i for i in range(size)})' 'i = randint(0, size-1); d.values()[i:i+1]'
100 loops, best of 3: 2.3 msec per loop
$ python2 -m timeit -s 'from collections import OrderedDict; from random import randint; size = 100000; d = OrderedDict({i:i for i in range(size)})' 'i = randint(0, size-1); d.values()[i:i+1]'
10 loops, best of 3: 24.5 msec per loop

$ python2 -m timeit -s 'from collections import OrderedDict; from random import randint; size = 1000;   d = OrderedDict({i:i for i in range(size)})' 'i = randint(0, size-1); next(itertools.islice(d.itervalues(), i, i+1))'
10000 loops, best of 3: 118 usec per loop
$ python2 -m timeit -s 'from collections import OrderedDict; from random import randint; size = 10000;  d = OrderedDict({i:i for i in range(size)})' 'i = randint(0, size-1); next(itertools.islice(d.itervalues(), i, i+1))'
1000 loops, best of 3: 1.26 msec per loop
$ python2 -m timeit -s 'from collections import OrderedDict; from random import randint; size = 100000; d = OrderedDict({i:i for i in range(size)})' 'i = randint(0, size-1); next(itertools.islice(d.itervalues(), i, i+1))'
100 loops, best of 3: 10.9 msec per loop

$ python2 -m timeit -s 'from indexed import IndexedOrderedDict; from random import randint; size = 1000;   d = IndexedOrderedDict({i:i for i in range(size)})' 'i = randint(0, size-1); d.values()[i]'
100000 loops, best of 3: 2.19 usec per loop
$ python2 -m timeit -s 'from indexed import IndexedOrderedDict; from random import randint; size = 10000;  d = IndexedOrderedDict({i:i for i in range(size)})' 'i = randint(0, size-1); d.values()[i]'
100000 loops, best of 3: 2.24 usec per loop
$ python2 -m timeit -s 'from indexed import IndexedOrderedDict; from random import randint; size = 100000; d = IndexedOrderedDict({i:i for i in range(size)})' 'i = randint(0, size-1); d.values()[i]'
100000 loops, best of 3: 2.61 usec per loop

+--------+-----------+----------------+---------+
|  size  | list (ms) | generator (ms) | indexed |
+--------+-----------+----------------+---------+
|   1000 | .259      | .118           | .00219  |
|  10000 | 2.3       | 1.26           | .00224  |
| 100000 | 24.5      | 10.9           | .00261  |
+--------+-----------+----------------+---------+ 
```

**蟒蛇 3.6**

Python 3 具有相同的两个基本选项（列表与生成器），但 dict 方法默认返回生成器。

列表方法：

```
list(d.values())[0]  # "python"
list(d.values())[1]  # "spam" 
```

生成器方法：

```
import itertools
next(itertools.islice(d.values(), 0, 1))  # "python"
next(itertools.islice(d.values(), 1, 2))  # "spam" 
```

Python 3 字典比 python 2 快一个数量级，并且在使用生成器时也有类似的加速。

```
+--------+-----------+----------------+---------+
|  size  | list (ms) | generator (ms) | indexed |
+--------+-----------+----------------+---------+
|   1000 | .0316     | .0165          | .00262  |
|  10000 | .288      | .166           | .00294  |
| 100000 | 3.53      | 1.48           | .00332  |
+--------+-----------+----------------+---------+ 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-05-25T06:39:17.677

这是一个新时代，Python 3.6.1 字典现在保留了它们的顺序。这些语义并不明确，因为这需要 BDFL 批准。但是 Raymond Hettinger 是第二好的（而且更有趣），他提出了一个[非常有力的案例](https://www.youtube.com/watch?v=p33CVV29OG8)，即字典将被订购很长时间。

所以现在很容易创建字典的切片：

```
test_dict = {
                'first':  1,
                'second': 2,
                'third':  3,
                'fourth': 4
            }

list(test_dict.items())[:2] 
```

**注意：**字典插入顺序保存现在[在 Python 3.7 中是官方的](https://docs.python.org/3/whatsnew/3.7.html)。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-09-14T11:33:15.230

如果您已`pandas`安装，您可以将有序的 dict 转换为 pandas `Series`。这将允许随机访问字典元素。

```
>>> import collections
>>> import pandas as pd
>>> d = collections.OrderedDict()
>>> d['foo'] = 'python'
>>> d['bar'] = 'spam'

>>> s = pd.Series(d)

>>> s['bar']
spam
>>> s.iloc[1]
spam
>>> s.index[1]
bar 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-01-29T07:07:18.877

对于 OrderedDict()，您可以通过如下方式获取 (key,value) 对的元组或使用 '.values()' 通过索引来访问元素

```
>>> import collections
>>> d = collections.OrderedDict()
>>> d['foo'] = 'python'
>>> d['bar'] = 'spam'
>>> d.items()
[('foo', 'python'), ('bar', 'spam')]
>>>d.values()
odict_values(['python','spam'])
>>>list(d.values())
['python','spam'] 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-08-13T15:16:45.170

如果您要处理预先知道的**固定数量的键**，请改用 Python 的内置[命名元](https://docs.python.org/3/library/collections.html#collections.namedtuple)组。一个可能的用例是当您想要存储一些常量数据并通过索引和指定键在整个程序中访问它时。

```
import collections
ordered_keys = ['foo', 'bar']
D = collections.namedtuple('D', ordered_keys)
d = D(foo='python', bar='spam') 
```

### 通过索引访问：

```
d[0] # result: python
d[1] # result: spam 
```

### 通过指定键访问：

```
d.foo # result: python
d.bar # result: spam 
```

或更好：

```
getattr(d, 'foo') # result: python
getattr(d, 'bar') # result: spam 
```

# php - 从单个脚本运行多个脚本

> ID：10058142
> 
> 赞同：0
> 
> 时间：2012-04-07T20:34:26.163
> 
> 标签：php, include, simple-html-dom

我有一个生成 RSS 提要的脚本，我从 cron 调用该脚本并生成一个 XML 文件。

我想做的是编写一个可以从 cron 调用的脚本，但该脚本又调用多个脚本，从而生成多个 RSS 提要。

我试着做：

```
<?php
  include('delicious-tags.php');
  include('delicious-user.php');    
?> 
```

但我得到了错误：

```
<b>Fatal error</b>:  Cannot redeclare file_get_html() (previously declared in /home/danvelox/public_html/simple_html_dom.php:65) in <b>/home/public_html/simple_html_dom.php</b> on line <b>80</b><br /> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T20:36:26.963

将包含/需要 simple_html_dom 的每个实例更改为[include_once](http://php.net/manual/en/function.include-once.php) / [require_once](http://www.php.net/manual/en/function.require-once.php)。

这将阻止 PHP 尝试重新包含整个库并尝试重新定义所有函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T20:37:25.653

两个文件中似乎定义了相同的功能。当这种情况发生时，PHP 不喜欢它。

如果该函数执行相同的操作，请将其移动到单独的文件中。

如果此函数在您包含的文件包含的其他文件中声明，则意味着您的包含结构存在缺陷。虽然您可以只使用`include_once`或者`require_once`这实际上意味着您可能应该将包含的库文件移动到更高级别的文件中，这样它们就不会首先发生冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T20:38:42.007

使用[exec](http://php.net/manual/en/function.exec.php)。

```
exec("php-cli delicious-tags.php");
exec("php-cli delicious-user.php"); 
```

# eclipse - 如何在提交后强制 Eclipse 的快速差异刷新？

> ID：10058143
> 
> 赞同：7
> 
> 时间：2012-04-07T20:34:39.890
> 
> 标签：eclipse, svn, subclipse

我正在使用 Subclipse 3.0.0 并将我的快速差异设置设置为反对“Prestine SVN 副本”。但是，当我使用菜单选项进行提交时，`Team -> Commit`我仍然会在左侧标尺中看到行号所在的旧更改。

在源代码树上做 a`Refresh`也无济于事。我必须手动关闭所有打开的源文件并重新打开它们以便快速更新差异。

从我看到的参考“Prestine SVN 副本”仅在您打开当前未​​打开的文件时才会更新。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-19T17:07:53.377

在 Eclipse 中，做 SVN 清理

右键单击项目 -> 团队 -> 刷新/清理选项

您也可以参考[this](https://stackoverflow.com/questions/9636409/subclipse-1-8-5-requires-cleanup-refresh-cycle-to-detect-changes-made-with-t)为该命令添加键盘快捷键

# android - 如何从 servlet 响应客户端？

> ID：10058148
> 
> 赞同：1
> 
> 时间：2012-04-07T20:34:56.643
> 
> 标签：android, google-app-engine

我正在尝试使用 google app engine 和 android app 进行简单的静态登录，如下所示：

服务器：

```
public class StreetMeetSignServlet extends HttpServlet
{
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)     throws  IOException 
    {
        PrintWriter out = response.getWriter();
        String userName,password;   
        userName = request.getParameter("username");
        password = request.getParameter("password");
        if(userName.equalsIgnoreCase("A") && password.equals("B"))
        {
            out.print("yes");
        }
        else
        {
            out.print("no");
        }       
    }
} 
```

客户代码：

```
 response = CustomHttpClient.executeHttpPost("http://myserver.appspot.com/", postParameters);

    String res=response.toString();
    System.out.println("res is: "  + res);
    res= res.replaceAll("\\s+","");

    if(res.equals("yes"))
        error.setText("Correct Username or Password");
    else
        error.setText("Sorry!! Incorrect Username or Password"); 
```

但是在 res 字符串中，我在我的 jsp 上生成了所有 html 代码。
这是为什么呢？
有一个从 A 到 Z 的教程，展示了如何将 android 应用程序连接到 google 应用程序引擎 servlet？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T20:40:39.323

在您的`executeHttpPost`方法中，您应该将完整路径传递给您的 servlet，例如

```
 response = CustomHttpClient.executeHttpPost("http://myserver.appspot.com/path/to/servlet", postParameters); 
```

你注册你的servlet了`web.xml`吗？路径是什么？

# git - 提交时“无法附加到 .git/logs/refs/heads/master”

> ID：10058155
> 
> 赞同：2
> 
> 时间：2012-04-07T20:36:34.407
> 
> 标签：git

我最近遇到了一些奇怪的错误。我有一个有效的 Git 安装，但这是我在提交更改时的 shell 输出：

```
$ git commit -m 'Removing crap'
error: unable to append to .git/logs/refs/heads/master
fatal: cannot update HEAD ref 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T20:40:08.973

检查用户和权限`.git/logs/refs/heads/master`

这应该可以解决它，至少在 unix 机器上：

```
sudo chown -Rc $UID .git/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-29T18:05:02.183

```
chmod 766 .git/logs/HEAD 
```

为我工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-04T23:30:59.407

如果您以另一个用户（例如 root）的身份进行更改，然后尝试推/拉等，所有权可能会变得一团糟。 sudo chown -Rc $UID .git/ 也为我修复了它。确保如果您有嵌套的 .git 文件夹，请在项目的相应 repo 中进行此更改。

# html - 如何在 TWebBrowser 中以 HTML 格式显示 rss 提要的输出？

> ID：10058156
> 
> 赞同：8
> 
> 时间：2012-04-07T20:37:02.400
> 
> 标签：html, css, delphi, delphi-xe2, twebbrowser

我想在 TWebBrowser 组件中以格式化 HTML 显示 rss 提要的输出，如果在 TWebbrowser 中加载此提要[http://code.google.com/feeds/p/v8/svnchanges/basic](http://code.google.com/feeds/p/v8/svnchanges/basic)，则显示内容为 XML 文件

![在此处输入图像描述](../Images/2cc124f456d890311c0062abbcdf4432.png)

但是如果我使用 IE 加载相同的页面

![在此处输入图像描述](../Images/083dd74cc377b17e7932d26f6e75eff3.png)

[我尝试按照这个问题CSS and TWebbrowser delphi](https://stackoverflow.com/questions/5107369/css-and-twebbrowser-delphi)中的建议将 css 注入到加载的IHTMLDocument2 中，但我仍然得到相同的结果。

问题是，我如何在 TWebbrowser 中加载 rss 提要，但像 IE 一样将输出显示为 HTML 文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T22:13:09.873

只是一个猜测，但您可以尝试应用以下 XSL 样式表（取自[http://snippets.dzone.com/posts/show/1162](http://snippets.dzone.com/posts/show/1162)并按照 cherdt 在下面评论中的建议进行修改）：

```
<xsl:stylesheet version="1.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:dc="http://purl.org/dc/elements/1.1/">
    <xsl:output method="html"/>
    <xsl:template match="/">
    <xsl:apply-templates select="/atom:feed/atom:head"/>
        <xsl:apply-templates select="/atom:feed"/>
    </xsl:template>
    <xsl:template match="atom:feed/atom:head">
        <h3><xsl:value-of select="atom:title"/></h3>
        <xsl:if test="atom:tagline"><p><xsl:value-of select="atom:tagline"/></p></xsl:if>
        <xsl:if test="atom:subtitle"><p><xsl:value-of select="atom:subtitle"/></p></xsl:if>
    </xsl:template>
    <xsl:template match="/atom:feed">
        <h3><xsl:value-of select="atom:title"/></h3>
        <xsl:if test="atom:tagline"><p><xsl:value-of select="atom:tagline"/></p></xsl:if>
        <xsl:if test="atom:subtitle"><p><xsl:value-of select="atom:subtitle"/></p></xsl:if>
        <ul>
            <xsl:apply-templates select="atom:entry"/>
        </ul>
    </xsl:template>
    <xsl:template match="atom:entry">
        <li>
            <a href="{atom:link[@rel='related']/@href}" title="{substring(atom:published, 0, 11)}"><xsl:value-of select="atom:title"/></a>
            <xsl:choose>
                <xsl:when test="atom:content != ''">
                    <p><xsl:value-of select="atom:content" disable-output-escaping="yes" /></p>
                </xsl:when>
                <xsl:otherwise>
                    <p><xsl:value-of select="atom:summary" disable-output-escaping="yes" /></p>
                </xsl:otherwise>
            </xsl:choose>
        </li>
    </xsl:template>
</xsl:stylesheet> 
```

到您收到的提要。要转换文档，请参阅[此问题的选定答案](https://stackoverflow.com/questions/982687/how-do-i-display-xml-using-an-xslt-document-in-a-delphi-app)，然后您可以尝试将生成的 XML 分配给 WebBrowser。

我猜您将 WebBrowser 控件指向提要，但使用这种方法，您需要使用例如 Indy（签出`TIdHTTP`及其`Get()`方法）下载提要，对其进行转换，然后在您的控件中显示。

请注意，以上只是一个猜测，但我相信这是一个很好的假设。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T21:05:26.997

IE 将默认样式表和 XSL 转换应用于 RSS 提要 XML。这是 IE 的东西，而不是标准或类似的东西。

您需要通过在显示页面之前修改页面来自己做类似的事情。

# matlab - 主 GUI 和子 GUI 之间的关系

> ID：10058163
> 
> 赞同：2
> 
> 时间：2012-04-07T20:37:46.127
> 
> 标签：matlab, user-interface

我有两个名为 masir 的 GUI 和 SetOut
SetOut GUI 是 masir 的子 GUI（按下 masir 上的按钮将打开 SetOut） 要访问 SetOut 中 masir 的数据，我有以下两行代码：

```
masirGUIhandle = masir;  
masirGUIdata = guidata(masirGUIhandle); 
```

但是当我在 SetOut 中工作时，运行这 2 行将运行 masir 的打开函数（在打开函数中，我为变量设置了一些初始值，现在我不想要这些初始值，我需要更改变量的值）所以我不想运行 masir GUI 的 OpeningFcn，我只需要访问 SetOut 中的 masir 数据 我能做些什么来解决这个问题？

任何人都可以帮助我解决这个问题并向我解释更多吗？

```
I use this easy way for data sharing between GUIs
%In the end of OpeningFcn of Main GUI
setappdata(0,'HandleMainGUI',hObject);
%When you want to edit shared data you must get the handle
HandleMainGUI=getappdata(0,'HandleMainGUI');
%write a local variable called MyData to SharedData, any type of data
setappdata(HandleMainGUI,'SharedData',MyData); 
%get SharedData and save it to a local variable called SomeDataShared
SomeDataShared=getappdata(HandleMainGUI,'SharedData'); 
Don't forget to clean up the data shared in the CloseReqFcn of you main GUI
HandleMainGUI=getappdata(0,'HandleMainGUI');
rmappdata(HandleMainGUI,'MySharedData') %do rmappdata for all data shared 
Remember that your GUIs might try to getappdata that doesn't exist, you should    first     test if it does exist
if (isappdata(0,'HandleMainGUI') & isappdata(HandleMainGUI,'MySharedData'))
%get, set or rm appdata
else
%do something else, maybe loading default values into those variables
end 
```

告诉我更多关于 MainGUI 应该写哪行代码，SubGUI 应该写哪一行代码？
并告诉我 CloseReqFcn 的响应者是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T12:11:02.970

好吧，让我总结一下我是如何看待这个问题的。

您想在不创建数据的情况下从中读取数据`SetOut`吗？这是不可能的，因为数据将在创建窗口时创建。

一个很好的系统化方法是面向对象（请参阅[模型视图控制器模式](https://en.wikipedia.org/wiki/Model_View_Controller)）您可以或多或少地从我的答案中复制一个示例[（](https://stackoverflow.com/questions/9153044/is-it-possible-to-do-stateless-programming-in-matlab-how-to-avoid-checking-d/9153153#9153153)事件示例 - 观察者）

* * *

但是，如果您想坚持使用您的代码，我也有一些想法：

*   如果您不希望窗口显示，您可以将其设置为不可见`set(theGUIhandle,'Visible','off')`

*   在窗口未关闭时，您可以使用以下方式获取数据`getappdata(theGUIhandle)`

*   如果您想要窗口关闭*后*的数据，您需要有一个将其存储在窗口外的函数。

# html - CSS中的wordpress 3.3相对路径

> ID：10058167
> 
> 赞同：5
> 
> 时间：2012-04-07T20:38:16.777
> 
> 标签：html, css, wordpress

我想添加一个图像作为标题的背景，问题是我不想添加绝对路径，因为我在我的电脑上执行此操作并且它们要上传到我的服务器。

应该`<?php bloginfo('template_directory'); ?>`在css中工作吗？它在这里不起作用。

代码：

```
#branding {
    background: url("<?php bloginfo('template_directory'); ?>/images/background2.jpg") repeat-x repeat-y;
    height: 150px;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-07T20:42:21.930

不，您不能在 CSS 文件中使用 PHP。

您仍然可以使用相对路径。如果您的 CSS 文件和图像目录位于同一目录中，则此示例将起作用。WordPress 知道这与主题有关。

```
#branding {
    background: url("images/background2.jpg") repeat-x repeat-y;
    height: 150px;
} 
```

如果图像目录位于 CSS 文件的父级中：

```
#branding {
    background: url("../images/background2.jpg") repeat-x repeat-y;
    height: 150px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-31T12:28:08.567

不知何故，@developdaly 解决方案对我不起作用，但这有帮助：

```
.img-div {
  background-image: url("wp-content/themes/your-theme/assets/images/your-img.jpg");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-31T23:15:04.410

```
.img-div {
    background-image: url("./assets/images/your-img.jpg");
} 
```

# perl - 用 perl-DBI 理解 Segfault

> ID：10058168
> 
> 赞同：0
> 
> 时间：2012-04-07T20:38:29.220
> 
> 标签：perl, segmentation-fault, dbi

我有一个正在执行段错误的脚本，我对解决它的方式不太满意，所以我想在这里发布这个问题，以了解更多关于它的原因，也许是一个更好的解决方案。

这是我的脚本的作用（删除了一些详细代码以保留它的“核心”）：

```
# Here's a query I need to do every X seconds to monitor progress of other tasks
# This is apparently the key to my segfault problem
my $stmt = $dbh->prepare($query);

my $all_done = 0;
while(!$all_done) {
    $self->debug("Waiting for $n blocker tasks to be finished");

    # Execute query to pull the status of the tasks from DB
    $stmt->execute();

    my $pending = [];
    while(my $hr = $stmt->fetchrow_hashref()) { 
        push @{$pending}, $hr->{'TASK_NAME'} if ($hr->{'STATUS'} ne 'COMPLETE'); 
    }

    if(scalar(@{$pending}) > 0) {
        $all_done = 0;
        sleep($sleep_gap);
    }
    else { $all_done = 1; }
} 
```

现在，脚本运行良好，大部分时间。但是，当**脚本的 3 个或更多实例并行运行时**（相同的脚本，单独的进程，而不是线程），它会出现段错误。

我是怎么解决的？我通过在 while(!$all_done) 循环期间每次调用 DBH::prepare 来解决它。

因此，即使多个进程并行运行，此代码也不会出现段错误。我重复了几次错误，始终如一，然后我对新代码做了同样的事情。我很肯定在循环内移动语句可以解决问题。

任何想法为什么会发生这种情况？

我正在使用 perl 5.8 和 perl-DBI 1.609 版。

这也是脚本段错误时 strace 的输出：

```
read(5, "\1\7\0\0\6\0\0\0\0\0\20\27\234\312\272\221eG2;\33S\364\230\313\220\221Bxp\4\7"..., 2064) = 263
write(4, "\1\31\0\0\6\0\0\0\0\0\21i \1\1\0\0\0\2\0\0\0\3^!)\4\4\0\0\0\0"..., 281) = 281
read(4, "\0\177\0\0\6\0\0\0\0\0\v\5\2\0\0\0\1\0\0\0\0\0\0\0\0\0\0\0  \10\6"..., 2064) = 127
write(2, "debug:Waiting for 1 blocker task"..., 49debug:Waiting for 1 blocker tasks to be finished
) = 49
write(5, "\0\252\0\0\6\0\0\0\0\0\3^\20p\200\0\0\2\0\0\0\0\0\0\0\0\1\r\0\0\0\0"..., 170) = 170
read(5, "\0\301\0\0\6\0\0\0\0\0\6\"\2\0\0\0@\0\0\0\0\0\0\0\0\0\0\0\7 ru"..., 2064) = 193
write(5, "\1]\0\0\6\0\0\0\0\0\3^\21)\200\0\0\0\0\0\0\1\234\0\0\0\1\r\0\0\0\0"..., 349) = 349
read(5, "\0y\0\0\6\0\0\0\0\0\10\6\0S\254b\f\0\t\0\0\1\0\0\0\1\0\0\0\0\0\0"..., 2064) = 121
write(5, "\0000\0\0\6\0\0\0\0\0\3h\22\1\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"..., 48) = 48
read(5, "\0\26\0\0\6\0\0\0\0\0\10\2\0\0\0\t\5\0\0\0\21\0", 2064) = 22
time(NULL)                              = 1333827285
rt_sigprocmask(SIG_BLOCK, [CHLD], [], 8) = 0
rt_sigaction(SIGCHLD, NULL, {SIG_DFL}, 8) = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
nanosleep({10, 0}, {10, 0})             = 0
time(NULL)                              = 1333827295
write(4, "\1\31\0\0\6\0\0\0\0\0\21i\"\1\1\0\0\0\3\0\0\0\3^#)\4\4\0\0\0\0"..., 281) = 281
read(4, "\0\177\0\0\6\0\0\0\0\0\v\5\2\0\0\0\1\0\0\0\0\0\0\0\0\0\0\0  \10\6"..., 2064) = 127
write(2, "debug:Waiting for 1 blocker task"..., 49debug:Waiting for 1 blocker tasks to be finished
) = 49
write(5, "\0)\0\0\6\0\0\0\0\0\21i\23\1\1\0\0\0\1\0\0\0\3N\24\2\0\0\0@\0\0"..., 41) = 41
read(5, "\1>\0\0\6\0\0\0\0\0\20\27\234\312\272\221eG2;\33S\364\230\313\220\221Bxp\4\7"..., 2064) = 318
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV +++
[ Process PID=22767 runs in 32 bit mode. ] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:44:46.627

我想说你不用担心太多，因为 SQLite 语句准备往往很快。我测量到通过 Perl DBI 准备一个简单的 SQL 只需要 20 微秒（见下面的结果和代码）。考虑到您的应用程序，您不应该注意到任何性能差异。

由于 SQLite 的经典锁定一次只允许一个作者和多个读者，您面临的问题可能与锁定或事务处理有关。然而 SIGSEGV 从来都不是预期的行为。

结果

```
Perl 5.014002
DBI 1.618
SQLite 3.7.9
time in s for 100000 prepares: 2.01810789108276
ys per prepare: 20.1810789108276 
```

代码

```
use DBI;
use Time::HiRes qw ( time );
use strict;
use warnings;

my $dbc = DBI->connect (
 'dbi:SQLite:dbname=/tmp/test.db',
  undef, undef, { AutoCommit => 0, RaiseError => 1, PrintError => 1 }
) || die $DBI::errstr;

print "Perl $]\n";
print "DBI $DBI::VERSION\n";
print "SQLite $dbc->{sqlite_version}\n";

my $start = time();

my $n = 100_000;

foreach ( 1 .. $n ) {

 my $stmt = $dbc->prepare( qq{
  select count(*) from sec where sid is not null
 } );

}

my $end = time();

print
 "time in s for $n prepares: " .
 ( $end - $start ) .
 "\n";

print
 "ys per prepare: " .
 ( ( ( $end - $start ) * 1_000_000 ) / $n ) .
 "\n"; 
```

# microdata - 出租空缺网站使用什么项目类型？

> ID：10058170
> 
> 赞同：2
> 
> 时间：2012-04-07T20:38:30.457
> 
> 标签：microdata, schema.org

我是法国人，我正在开发一个出租空缺网站。我想添加有关出租空缺报价（房屋、别墅、公寓......）的微数据，但我不知道要使用哪种项目类型。报价、产品或其他？

[http://schema.org/Offer](http://schema.org/Offer)

[http://schema.org/Product](http://schema.org/Product)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T21:13:08.350

有几种适用的相关模式，您最好使用它们的组合来表示您的报价。**报价**应该是您的根元素，因为它代表了可以以一定价格购买的东西。itemOffered属性具有**Product**类型，因此它是嵌入产品内容的逻辑扩展点**。**将优惠视为您的推销，将产品视为您实际销售的产品。[Residences](http://schema.org/Residence)有一个元数据模式，其中包括有关您的产品域的信息。您可以将其与 Product itemscope 组合或将其嵌套在 Product 中（可能通过**模型**​​属性）。

[GoodRelations 模式](http://www.heppnetz.de/ontologies/goodrelations/v1)中的元数据也可用于扩展 schema.org 有限的产品词汇表。

我还看到了利用 Review 模式的机会（对于相应 Product 属性中的任何评论），如果租赁靠近旅游景点是一个卖点，则可能[是 TouristAttraction 。](http://schema.org/TouristAttraction)我还注意到有一个从**Organization继承的****LodgingBusiness**模式。这应该用于封装有关您的实际客户（或将公寓/别墅出租给租户的人）的内容。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:34:40.570

**使用新版本的 schema.org (0.99) 并为http://schema.org/Offer**提供以下属性：

*   **业务功能**；使用[http://purl.org/goodrelations/v1#LeaseOut](http://purl.org/goodrelations/v1#LeaseOut)作为值。
*   **合格**持续时间：给定报价有效的持续时间。
*   **availabilityStarts**：出租对象的可用性开始。
*   **availabilityEnds** : 出租对象的可用性结束

如果您需要详细的图案，请通过[http://www.heppresearch.com/contact](http://www.heppresearch.com/contact)与我联系。我们为 schema.org 构建了新的电子商务模块。**

# java - 使用一维数组，要求用户输入并仅显示非重复值

> ID：10058174
> 
> 赞同：1
> 
> 时间：2012-04-07T20:39:10.020
> 
> 标签：java, arrays, search, duplicates

在我的 Java 课程中，我们正在学习数组，然后出现了这个问题。我试图解决它，但似乎无法满足要求。我可以读取用户输入并将其限制为仅 5 个元素（其他要求之一），而且值必须在 10 到 100 之间，我也这样做了。但我似乎不能“不打印”重复的值。该数组接受重复值。它们不必被取出，只是不打印。到目前为止，这是我的代码：

```
import java.util.Arrays;
import java.util.Scanner;

public class ArrayTest {

static Scanner in = new Scanner(System.in);

public static void main(String[] args) {

    int size = 5;
    int InpNum[] = new int[size];

    for (int i = 0; i < InpNum.length; i++){

    while (InpNum[i] <= i){

        System.out.println("Please type a number between 10 and 100: ");
        InpNum[i] = in.nextInt();

        while (InpNum[i] < 10 || InpNum[i] > 100){
            System.out.println("Error: Please type an integer between 10 and 100: ");
            InpNum[i] = in.nextInt();
        }

        Arrays.sort(InpNum);

        System.out.println(Arrays.toString(InpNum));

        }

        while (Search(InpNum, i) == true){
            System.out.println("ERROR: Please enter a number that is not a duplicate of the other numbers you have entered");
            InpNum[i] = in.nextInt();
        }

    }

}

// I can't seem to implement the method below in a useful manner.

    public static boolean Search(int InpNum[], int searchedNum) {

    for(int i : InpNum) {

        if (i == searchedNum) {

            return true;
        }
    }

    return false;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T20:45:27.287

一种懒惰的方法是只创建一个可以随时保存值的第二个数组。

遍历输入数组并将当前元素放入新数组中，如果该数组还没有该元素。然后用淘汰的阵列替换旧阵列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T20:49:00.020

我会考虑重组您的应用程序。

与其将用户输入的数字立即放入数组中，不如将其存储在局部变量中。然后运行您需要运行的所有检查，并且仅当它通过所有检查时才将其添加到数组中。

`while`您应该在整个程序中只有一个循环（外部循环）。所有其他人都极大地混淆了这个问题，并使问题变得比它必须的要困难得多。

所以，在伪代码中：

```
int index = 0;
while (true)
{
  int num = in.nextInt();

  // if not between 10 and 100, continue
  // if it would make the array larger than 5, continue
  //    (or perhaps break out of the loop, since we've filled the array)
  // if it is already in the array, continue

  // all the checks passed, so add it to the array!
  InpNum[index++] = num;
} 
```

* * *

作为旁注，您真正需要的是[Set](http://docs.oracle.com/javase/1.5.0/docs/api/index.html?java/util/Set.html)。这是一个保证没有重复的集合，并允许您回答*“我是否包含此值？”的问题。*以一种有效的方式使用该方法`Set.contains( Object )`。

所以我会创建一个`TreeSet`或`HashSet`并将用户输入的每个数字都放入其中。然后，您的`Search`函数将只是调用`contains( searchedNum )`您的集合的单线。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-07T21:01:04.360

最简单的方法
所以我要做的就是先问号码。然后将数字保存在变量中，然后再将其输入数组。然后我通过搜索检查该号码是否已经在其中。如果是，我要求一个新号码。如果不是，我检查它是否在 10 到 100 之间，如果不是，我要求一个新的。我适合是我在数组中输入它。我必须检查一个空的地方在哪里，因为排序每次都会混淆数组

```
import java.util.Arrays;
import java.util.Scanner;
public class ArrayTest
{

static Scanner in = new Scanner(System.in);

public static void main(String[] args) {

    int size = 5;
   int InpNum[] = new int[size];

   for (int i = 0; i < InpNum.length; i++){
       System.out.println("Please type a number between 10 and 100: ");
       int number = in.nextInt();
    //while (InpNum[i] <= i){
        while (Search(InpNum, number) == true){
            System.out.println("ERROR: Please enter a number that is not a duplicate of the other numbers you have entered");
            number = in.nextInt();
      }

       while (number < 10 || number > 100){
        System.out.println("Error: Please type an integer between 10 and 100: ");
        number = in.nextInt();
       }

       int counter = 0;
       for (int j = 0; j < InpNum.length && counter == 0; j++){
          if(InpNum[j] == 0){
             InpNum[j] = number;
             counter++;
          }

      }
       Arrays.sort(InpNum);

       System.out.println(Arrays.toString(InpNum));

       //}

   }

 }

 // I can't seem to implement the method below in a useful manner.

   public static boolean Search(int InpNum[], int searchedNum) {

     for (int i = 0; i < InpNum.length; i++){

       if (InpNum[i] == searchedNum) {

        return true;
       }
   } 

   return false;
  }
  } 
```

# php - HTML 内的 HTML 相互影响

> ID：10058178
> 
> 赞同：1
> 
> 时间：2012-04-07T20:39:35.323
> 
> 标签：php, css, html, styles

我已经查看了针对我的问题的其他一些建议，主要建议只是使用 iframe ...

然而！我不想使用 iframe。无论如何，关于这个问题：

从本质上讲，我正在为 PHP 的大学团队项目制作一个基于 Web 的电子邮件客户端，并且在 HTML 电子邮件方面遇到了一些问题......在最终正确处理电子邮件之后，我一直在查看几封电子邮件并遇到了一个和电子邮件的背景会影响网站正文标签的背景颜色...

我查看了原始邮件正文，它就像一个普通的 HTML 文件，电子邮件中的正文标签上有一些 CSS 样式（包括背景颜色），因此从某种意义上来说，电子邮件中的正文样式正在被应用到我页面的正文...

本质上，我需要知道的是，除了使用 iframe 来阻止代码影响包含消息正文的 div 之外的任何内容之外，是否还有其他方法......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T13:54:15.433

我实际上已经弄清楚了这一点，这可能对其他人有帮助，所以！

我更深入地研究了gmail是如何做到的......他们实际上将body标签转换为div标签......

```
$body = str_replace(array("<body ","</body>"),array("<div ","</div>"),$body); 
```

我还使用了一些正则表达式从电子邮件中删除了 head、html 和 doctype 部分，我仍在调查这样做的任何副作用，但到目前为止，通过我测试过的所有电子邮件，它没有受到任何影响！如果有人想要我正在使用的正则表达式，请在此处评论...

它可能不是最优雅的解决方案，但它似乎有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T20:43:16.913

我会说不——或者没有好办法。我刚刚检查了雅虎邮件，他们也在使用 iframe 来处理电子邮件。我想他们有更多的时间来考虑它:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T20:45:28.007

> 本质上，我需要知道的是，除了使用 iframe 来阻止代码影响包含消息正文的 div 之外的任何内容之外，是否还有其他方法......

当然，您可以使用 javascript 编写自己的 HTML 解析器，将输出呈现到画布上（例如[htmlcanvas](https://github.com/jamesu/htmlcanvas)）。好吧，如果你有太多时间；）

实际上 iframe 对我来说看起来更实用。否则将 HTML 电子邮件转换为纯文本电子邮件。这些很容易显示（您可以提供在新选项卡中显示 HTML 内容）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T17:08:35.817

这是一个非常有趣的问题，我真的考虑过，实际上我认为我们可以使用 javascript 解决它，如下所示：

```
<html>
  <head></head>
  <body>
    <div id='email'>
      <!--here we the HTML code of the new page should be placed-->
    </div>
  </body>
</html> 
```

如果我们要放置的代码是相同的代码

```
<html>
  <head></head>
  <body>
    Hi it's me
  </body>
</html> 
```

然后我们可以获取电子邮件中的代码并删除 HTML 标签和 head,body 标签：

```
var email = document.getElementById('email').innerHTML(); 
```

希望这会有所帮助......祝你好运

# wpf - 子用户控件上的 WPF 通知属性

> ID：10058181
> 
> 赞同：0
> 
> 时间：2012-04-07T20:40:33.783
> 
> 标签：wpf, binding, properties

我有一个包含用户控件 UC_B 的用户控件 UC_A。每个都有不同的视图模型作为其数据上下文，分别是 VM_A 和 VM_B，它们都派生自 INotifyPropertyChanged。

来自 VM_A 的命令会更改影响 VM_B 中属性的内容。UC_B 绑定到该属性。如何使绑定更新？我在 VM_A 中尝试了 OnPropertyChanged，但它没有完成这项工作。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:18:40.573

要补充@flq 已经说过的内容，
我看不出有什么问题，如果您正确实施了 OnPropertyChanged 它应该`just work`。
即，当您的 View-model-A 更改 view-model-B 中的某些内容时 - 那么 VM-B 中更改的任何属性都应该触发 OnPropertyChanged - 从 VM-B - 这将“登陆”到 UC -B 圈，因为它应该。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:27:45.470

如果 VM B 发生变化，则必须从那里发出通知以通知 UC B。

# html - 通过 CSS 设置第一列和第二列的对齐和填充 如何将第一列向右对齐，第二列向左对齐并用 CSS 填充 10px？

| Skype: | sent |
| Skype: | sent |
| Tel: | +343 343 4343 |
| e-mail: | info@example.com |
|  | example@gmail.com |

它不是真正的 Scala 相关，它更多的是ieee-754浮点算术问题。首先，当与它进行比较时Int，Double它会Int转换为Double（总是安全的）。第二种情况很明显——价值观不同。 第一种情况发生的情况是该Double类型无法存储那么多有效数字（在您的情况下为 17，64 位浮点最多可以存储 16 个十进制数字），因此它将值四舍五入为1\. 和1 == 1。 htmlcss 4 5 回答 5 This answer is useful 7 您可以使用:first-child选择器，如下所示： td { padding: 10px } td:first-child { text-align: right } 您的表格不再需要对齐。 于 2012-04-07T20:51:11.370 回答 This answer is useful 5 虽然这是最简单的，但它不适用于所有浏览器（特别是旧版本）： /* While :first-child or :first-of-type (equivalent to this) could have been * used, :nth-of-type(n) is easier to change if you ever decide you want * different columns to be aligned */ tr td:nth-of-type(1) { text-align:right; } tr td:nth-of-type(2) { text-align:left; padding-left:10px; } 但是，通过将和替换:nth-of-type(1)为，并将和分别添加到每行的第一个和第二个，您将获得更好的浏览器支持。.first:nth-of-type(2).secondclass="first"class="second" 如果您要为所有单元格添加填充，只需添加： td { padding:10px; } 于 2012-04-07T20:47:20.163 回答 This answer is useful 0 CSS table td { padding: 10px; } .alignright { text-align: right; } HTML

| Skype: | sent |
| Tel: | +343 343 4343 |
| e-mail: | info@example.com |
| example@gmail.com |

于 2012-04-07T20:47:30.303 回答 This answer is useful 0 你的意思是外部样式表？像这样： HTML

| Skype: | sent |
| Tel: | +343 343 4343 |
| e-mail: | info@example.com |
|  | example@gmail.com |

CSS td { padding: 10px; } td.right { align: right; } td.left { align: left; } 于 2012-04-07T20:48:12.923 回答 This answer is useful 0 我通常以这种方式设置此信息的样式：

| Skype: | sent |
| Tel: | +343 343 4343 |
| e-mail: | info@example.com |
|  | example@gmail.com |

.left {float:left; padding-right:10px; width:50px; text-align:right;} .right {float:left} .padding {padding-left:60px;} http://jsfiddle.net/R9YPF/ 于 2012-04-07T20:56:48.290 回答 Related 1 entity-framework - 如何在通过 MsDeploy 发布时迁移 Entity Framework DB 3 database - 在 Oracle 中查找修改后的表 2 java - SWT 中的表的简单示例 1 android - 如何将所选文本转换为超链接？ 3 sql - SQL 选择前 1 个唯一 1 ios - MKMapView 自己缩小 2 wxpython - wxPython：如何使 TextCtrl 不填满整个面板？ 3 c# - 从其他类更改控件属性 2 sql - SQL Server 存储过程中的条件语句 2 java - 如何使用 java 自签名 SAML 2.0 版本的 OpenSAML 断言？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10058189
> 
> 赞同：0
> 
> 时间：
> 
> 标签：ieee-754, html, css

如何将第一列向右对齐，第二列向左对齐并用 CSS 填充 10px？

```
<table>
    <tbody>
        <tr><td align="right">Skype:</td><td align="left"> sent</td></tr>
        <tr><td align="right">Tel:</td><td align="left"> +343 343 4343</td></tr>
        <tr><td align="right">e-mail:</td><td align="left"> info@example.com</td></tr>
        <tr><td></td><td align="left"> example@gmail.com</td></tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-07T20:51:11.370

您可以使用`:first-child`选择器，如下所示：

```
td { padding: 10px }
td:first-child { text-align: right } 
```

您的表格不再需要对齐。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-07T20:47:20.163

虽然这是最简单的，但它不适用于所有浏览器（特别是旧版本）：

```
/* While :first-child or :first-of-type (equivalent to this) could have been
 * used, :nth-of-type(n) is easier to change if you ever decide you want
 * different columns to be aligned */
tr td:nth-of-type(1) {
 text-align:right;
}
tr td:nth-of-type(2) {
 text-align:left;
 padding-left:10px;
} 
```

但是，通过将和替换`:nth-of-type(1)`为，并将和分别添加到每行的第一个和第二个，您将获得更好的浏览器支持。`.first``:nth-of-type(2)``.second``class="first"``class="second"``<td>`

如果您要为所有单元格添加填充，只需添加：

```
td {
 padding:10px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T20:47:30.303

CSS

```
table td {
     padding: 10px;
}
.alignright {
     text-align: right;
} 
```

HTML

```
<table>
     <tbody>
          <tr>
               <td>Skype:</td>
               <td>sent</td>
          </tr>
          <tr>
               <td>Tel:</td>
               <td class="alignright">+343 343 4343</td>
          </tr>
          <tr>
               <td>e-mail:</td>
               <td class="alignright">info@example.com</td>
          </tr>
          <tr>
               <td colspan="2">example@gmail.com</td>
          </tr>
     </tbody>
</table> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T20:48:12.923

你的意思是外部样式表？像这样：

### HTML

```
<table>
    <tbody>
        <tr><td class="right">Skype:</td><td class="left"> sent</td></tr>
        <tr><td class="right">Tel:</td><td class="left"> +343 343 4343</td></tr>
        <tr><td class="right">e-mail:</td><td class="left"> info@example.com</td></tr>
        <tr><td></td><td class="left"> example@gmail.com</td></tr>
    </tbody>
</table> 
```

### CSS

```
td {
    padding: 10px;
}
td.right {
    align: right;
}
td.left {
    align: left;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-07T20:56:48.290

我通常以这种方式设置此信息的样式：

```
<table>
    <tbody>
        <tr><td class="left">Skype:</td><td class="right"> sent</td></tr>
        <tr><td class="left">Tel:</td><td class="right"> +343 343 4343</td></tr>
        <tr><td class="left">e-mail:</td><td class="right"> info@example.com</td></tr>
        <tr><td class="left"> </td><td class="right padding"> example@gmail.com</td></tr>
    </tbody>
</table>

.left {float:left; padding-right:10px; width:50px; text-align:right;}

.right {float:left}

.padding {padding-left:60px;} 
```

[http://jsfiddle.net/R9YPF/](http://jsfiddle.net/R9YPF/)

# python - 我正在寻找从公共数据集中解析大量电子邮件，特别是使用 Python 的 90 年代末或 2000 年代初的电子邮件

> ID：10058195
> 
> 赞同：0
> 
> 时间：2012-04-07T20:41:38.650
> 
> 标签：python, regex, parsing, email, coding-style

所以基本上我想解析安然公共电子邮件数据集，但我不确定当时的电子邮件格式和类型。我不熟悉 MIME 类型和其他格式细节。所以我想知道所有电子邮件是否有相同的前几行和最后几行。

我基本上想摆脱除电子邮件正文之外的所有内容。所以我也想知道是否会更容易（不知道我知道什么），使用 C 方法按行解析，或者基本上尝试清理所有电子邮件，只留下我需要的东西。我不太关心空白，但我也不太擅长正则表达式或词法解析，所以如果有人对刷新正则表达式有很好的参考，或者可以分解可能我可能需要的唯一规则，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T20:54:54.453

哇，这是一大堆“......我不知道......”关于你的目标的信息为零。关于我能提供的最佳建议是您阅读 RFC-822。[http://www.faqs.org/rfcs/rfc822.html](http://www.faqs.org/rfcs/rfc822.html)

如果您要从电子邮件中提取任何有意义的信息，您将不得不进行正则表达式解析。我建议 Oreilly 关于正则表达式的书，或阅读[http://www.regular-expressions.info/](http://www.regular-expressions.info/)

如果您有更有针对性的问题，那么 SO 可能会为您提供帮助

祝你好运

# objective-c - 哪种类型的数据库最好

> ID：10058198
> 
> 赞同：0
> 
> 时间：2012-04-07T20:42:00.547
> 
> 标签：objective-c, xcode4.2

在我的应用程序中，我使用静态数据库来存储美国各州和领地的所有县和人口普查区。政府每 10 年更新一次。我用它在一个县内搜索，但有多个同名县，因此必须先选择一个州或领地，然后再选择其中的县。我的问题是我目前在 SQLite 数据库中拥有该数据，这是最有效的还是我应该使用核心数据？共有 3600 行，每行 4 个项目。我只是希望它成为存储和读取数据的最有效方式。不会有任何写信给它。所以我应该选择哪个，除了我提到的两个之外，我对其他人持开放态度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T20:49:55.723

对于你的情况：

核心数据：

更灵活

*   (+) 它是一个[ORM](http://en.wikipedia.org/wiki/Object-Relational_Mapping)（一大优点！因此您可以向数据模型添加方法或使用一个命令存储整个对象树）
*   (+) 更好地集成到 XCode
*   (+) 可以轻松处理数据方案的迁移
*   (-) 性能（在您的情况下，3600records 只有一张表）

sqlite：

*   (+)性能
*   (-) 只有 C 绑定（或者你需要一个框架）

别忘了，CoreData 是 sqlite 之上的另一层。所以，.. 比较这两件事并不容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T20:50:17.077

核心数据不是数据库，它是对象模型图，基于可能（或不是）SQLite 的数据库。

使用 CoreData 需要在您的应用程序中重建所有查询。您正在使用一个相当小的静态数据库，我猜它工作正常。你为什么要改变？您的应用程序是否遇到一些速度问题（在这种情况下，在您的列上设置索引）？无论您的选择是什么，我打赌您都不会注意到使用如此简单和小型的数据库从一个数据库到另一个数据库的任何改进。

您可以查看有关 CoreData的[这个答案。](https://stackoverflow.com/questions/9846152/large-database-best-way-to-display-data-on-device/9846325#9846325)

# css - 无法覆盖设置以在无序列表中的项目上显示项目符号

> ID：10058200
> 
> 赞同：0
> 
> 时间：2012-04-07T20:42:09.590
> 
> 标签：css, wordpress, pagelines

我正在 Wordpress 网站上使用 Pagelines 主题。

默认覆盖隐藏项目符号并调整边距和填充。

我一直在调试 Firebug。找到了 CSS。我要为其显示项目符号的 UL 元素和 LI 元素的重新定义样式。他们仍然不会工作。

网站网址是[http://royalaire.com/site/](http://royalaire.com/site/)

有问题的列表位于侧边栏中，导航链接中的嵌套列表。

我想要二级缩进项目项目符号。

默认定义为：

```
.widget ul li ul li {
    margin-left: .03em;
}
.widget ul li {
    display: block;
    font-size: 0.95em;
    list-style: none outside none;
    padding 0 2px;
} 
```

我尝试了以下方法：

```
.widget ul.children li.page_item {
    list-style-type: disc;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T20:50:48.820

我不是 CSS 专家，我很难确定您为该列表编写了哪些定义，但我知道`!important`在样式定义之后添加将确保它覆盖所有父定义。尝试：

```
.widget ul.children li.page_item {list-style-type: disc !important;} 
```

# vim - 从 vimrc 的最后一行提取

> ID：10058206
> 
> 赞同：0
> 
> 时间：2012-04-07T20:42:36.357
> 
> 标签：vim

在我的 .vimrc 文件中，我怎样才能做到这一点，以便当我按 X 次（比如说 3 次）按回车键时，它也会按 3 次按标签键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T20:46:09.350

```
:set ai 
```

`ai`是自动缩进

要禁用自动缩进：

```
:set ai! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T20:44:59.510

这应该够了……`set smartindent`

# r - 如何在 Rcpp 内联中包含本地头文件，而不对目录进行硬编码？

> ID：10058207
> 
> 赞同：1
> 
> 时间：2012-04-07T20:42:41.367
> 
> 标签：r, rcpp

我有一个带有一些内联 C++ 的 R 脚本，我想在同一目录中包含一个头文件。我可以使以下工作：

```
library(Rcpp)
library(inline)

code <- '
   // my C++ code here
   '

settings=getPlugin("Rcpp")
settings$env$PKG_CXXFLAGS='-I /hard/coded/path/to/header/'

myfunction <- cxxfunction(signature(x="numeric"),
                          plugin="Rcpp",  include='#include "myheader.hpp"',
                          settings=settings, body=code) 
```

但似乎应该有一种方便的方法在同一目录中包含头文件。我只是看不出它是什么。我真的很想要一种方法来包含位于同一目录中的 c++ 文件。

（也很抱歉：我不是 C++（或 R）忍者，所以我可能遗漏了一些非常明显的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:59:17.580

当您说“在同一目录中”时，您能澄清一下您指的是哪个目录吗？和什么一样？

如果它是当前目录，您仍然需要`-I.`，因为该目录可能不会添加为默认值。但如果这确实是您想要的目录，那么它的*相对*路径（即“当前目录”）比绝对路径更通用`-I/hard/coded/path/to/header`。

否则，您所做的是修改插件以向编译器提供额外标志的正确方法。

**编辑：**做了一两个测试，结果发现[内联](http://cran.r-project.org/package=inline)包总是使用 R 的 tempdir 来编译——所以`-I.`没有意义，因为我们通常不知道它在哪里。

这让你有两个选择：

1.  像您所做的那样使用绝对路径。

2.  使用 R 将头文件的内容读入传递给`include=`参数的变量中。

**编辑 2：** 事实证明，我们在 Rcpp 本身附带的示例之一中这样做了：

```
settings <- getPlugin("Rcpp")
settings$env$PKG_CXXFLAGS <- paste("-I", getwd(), sep="") 
```

然后在对 cxxfunction 的调用中使用 settings=settings。

# grails - Grails 2 应用程序在 tomcat7 上部署了两次

> ID：10058210
> 
> 赞同：0
> 
> 时间：2012-04-07T20:43:16.243
> 
> 标签：grails, deployment, tomcat7, grails-2.0

我的 grails 应用程序有问题。出于某种原因，当我将它部署在独立的 tomcat7 实例上时，它似乎部署了两次应用程序。例如，当我运行石英作业时，它会调用两次作业，当我运行控制器方法时，它会运行两次。

**这发生在以下情况：**
1\. 将战争添加到 webapps 文件夹
2\. 手动将战争解压缩到 webapps 文件夹
3\. 将上下文行添加`<Context path="/process" docBase="C:\apache-tomcat-7.0.27-windows-x64\apache-tomcat-7.0.27\process.war" reloadable="true" />`到 server.xml 文件中，并将实际的战争文件放在 webapps 之外文件夹。我还设置`unpackWARs="false" autoDeploy="false"`了添加上下文参数的 HOST 参数。

我已经没有什么要测试的想法了。
使用 run-app 命令行启动应用程序并使用 tomcat 插件时，不会出现此错误/功能。
有什么想法吗？

# c++ - 节点扩展问题

> ID：10058214
> 
> 赞同：0
> 
> 时间：2012-04-07T20:43:43.083
> 
> 标签：c++, node.js, node-modules

我正在尝试根据...进行节点扩展

[http://nodejs.org/api/addons.html#addons_hello_world](http://nodejs.org/api/addons.html#addons_hello_world)

进行了一些小的修改（我的称为 helloworld.cc 和 testnode.js），但是当我尝试编译以下行时......

```
require('./build/Release/helloworld'); 
```

我得到以下 ST

```
node.js:242
    throw e; // process.nextTick error, or 'error' event on first tick
          ^
Error: invalid argument
at Object..node (module.js:475:11)
at Module.load (module.js:351:32)
at Function._load (module.js:309:12)
at Module.require (module.js:357:17)
at require (module.js:373:17)
at Object.<anonymous> (/home/jackie/Desktop/hellonode/testnode.js:1:63)
at Module._compile (module.js:444:26)
at Object..js (module.js:462:10)
at Module.load (module.js:351:32)
at Function._load (module.js:309:12) 
```

发布目录的 ls 是...

总计 124 -rw-rw-r-- 1 杰基 jackie 70288 2012-04-07 16:16 helloworld_1.o -rwxrwxr-x 1 杰基 jackie 49431 2012-04-07 16:16 helloworld.node

谢谢

杰基

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:46:31.197

文件的名称`.node`需要与`NODE_MODULE`宏中的名称相匹配。

```
NODE_MODULE(hello, init); 
```

需要改为

```
NODE_MODULE(helloworld, init); 
```

# c++ - 存储字符串

> ID：10058216
> 
> 赞同：0
> 
> 时间：2012-04-07T20:43:55.330
> 
> 标签：c++, pointers

我正在尝试编写一个将字符串存储在数组中的代码。我正在尝试使用 char* 来实现，但我无法实现。我在网上搜索但找不到答案。我已经尝试了下面的代码，但它没有编译。我使用字符串流，因为在某些时候我需要将一个字符串与一个整数连接起来。

```
stringstream asd;
asd<<"my name is"<<5;
string s = asd.str();
char *s1 = s; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T20:50:04.067

> > 我正在尝试编写一个将字符串存储在数组中的代码。

好吧，首先你需要一个字符串数组。我不喜欢使用裸数组，所以我使用`std::vector`：

```
std::vector<std::string> myStrings; 
```

但是，我知道您必须使用数组，所以我们将使用数组：

```
// I hope 20 is enough, but not too many.
std::string myStrings[20];
int j = 0; 
```

> > 我使用字符串流，因为...

好的，我们将使用字符串流：

```
std::stringstream s;
s << "Hello, Agent " << 99;
//myStrings.push_back(s.str()); // How *I* would have done it.
myStrings[j++] = s.str(); // How *you* have to do it. 
```

这给了我们*一个*字符串，但你想要一个它们的数组：

```
for(int i = 3; i < 11; i+=2) {
  s.str(""); // clear out old value
  s << i << " is a" << (i==9?" very ":"n ") << "odd prime.";
  //myStrings.push_back(s.str());
  myStrings[j++] = s.str();
} 
```

现在你有一个字符串数组。

完整、经过测试的程序：

```
#include <sstream>
#include <iostream>

int main () {
  // I hope 20 is enough, but not too many.
  std::string myStrings[20];
  int j = 0;

  std::stringstream s;
  s << "Hello, Agent " << 99;
  //myStrings.push_back(s.str()); // How *I* would have done it.
  myStrings[j++] = s.str(); // How *you* have to do it.

  for(int i = 3; i < 11; i+=2) {
    s.str(""); // clear out old value
    s << i << " is a" << (i==9?" very ":"n ") << "odd prime.";
    //myStrings.push_back(s.str());
    myStrings[j++] = s.str();
  }

  // Now we have an array of strings, what to do with them?
  // Let's print them.
  for(j = 0; j < 5; j++) {
    std::cout << myStrings[j] << "\n";
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T20:47:29.993

这样的事情怎么样？

```
vector<string> string_array;
stringstream asd;
asd<<"my name is"<<5;
string_array.push_back(asd.str()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T20:46:38.640

```
char *s1 = s; 
```

是非法的。您要么需要：

```
const char *s1 = s.c_str(); 
```

如果您没有设置 on `char*`，或者您需要分配一个新的`char*`并用于`strcpy`从字符串中复制内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T20:46:58.850

只需将您的代码更改为

```
char const* s1 = s.c_str(); 
```

因为指向 char 的指针不能存储字符串对象，只能存储指向 char 的指针，这就是 c_str() 返回的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-07T21:19:10.040

我不会直接使用 char * 。我会将它包装在类似下面的模板中。您可以覆盖您需要执行更多操作的运算符（例如，我会将数据设为私有成员，并覆盖运算符以使数据打印出来干净）。我做了赋值运算符只是为了演示代码的简洁程度。

```
#include "MainWindow.h"

#include <stdio.h>

using namespace std;

template<size_t size>
class SaferChar
{
public:

  SaferChar & operator=(string const & other)
  {
    strncpy(data, other.c_str(), size);

    return *this;
  }

  char data[size];
};

int main(int argc, char *argv[])
{
  SaferChar<10> safeChar;
  std::string String("Testing");

  safeChar = String.c_str();

  printf("%s\n", safeChar.data);

  return 0;
} 
```

# wpf - 动态生成文本框以匹配总和

> ID：10058218
> 
> 赞同：0
> 
> 时间：2012-04-07T20:44:15.080
> 
> 标签：wpf, wpf-controls

我正在尝试生成以两个文本框开头的动态文本框。

> > **如果该值小于第一个文本框中的值，则动态生成另一个文本框并让用户输入更多值。
> > 必须这样做，直到从第二个到最后一个生成的所有文本框的值的总和等于第一个文本框的值。**

当然，需要使用文本框以及标签等生成其他内容并正确定位，因此我想到了使用网格并动态生成网格，但在此之上我迷路了。

有什么帮助吗？

谢谢

* * *

我使用带有以下代码的滚动查看器

```
<ScrollViewer Margin="8,8,8,14.417" Grid.Row="4" Grid.ColumnSpan="5" VerticalScrollBarVisibility="Hidden">
    <Grid Margin="8" Grid.Row="4" Grid.ColumnSpan="4" x:Name="amtGrid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="103"/>
            <ColumnDefinition Width="Auto" MinWidth="324"/>
            <ColumnDefinition Width="Auto" MinWidth="218"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <ComboBox x:Name="crdrnextrows" Margin="32.367,8,8,7.423" SelectedIndex="1" />
        <ComboBox Background="#FFC6C3C6" Margin="8" x:Name="comboboxCr" GotKeyboardFocus="comboboxCr_GotKeyboardFocus" Grid.Column="1"/>
        <TextBox Background="#FFC6C3C6" Foreground="White" IsEnabled="True" Margin="7.973,8,8,8" x:Name="txtBoxam1" Grid.Column="2" LostFocus="txtBoxam1_LostFocus"/>
        <TextBox Background="#FFC6C3C6" Foreground="White" IsEnabled="True" Margin="8,8,33.972,8" x:Name="txtBoxamt2" Grid.Column="3" LostFocus="textBox4_LostFocus"/>
    </Grid>
</ScrollViewer> 
```

上面还有另一个文本框，有类似的代码，但没有滚动查看器，现在我想的是动态创建滚动查看器中显示的网格的实例，只要需要使它们相等。

是否可以创建同一网格的新实例并使用代码动态地将它们添加到 scollviewer 中？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T01:57:04.207

查看您提供的附加信息并考虑到您要创建的对象的复杂性，[UserControl](http://msdn.microsoft.com/en-us/library/system.windows.controls.usercontrol.aspx)可能是最合适的。此代码是一个示例，使用`DoubleClick`来展示如何将 UserControl 添加到 ScrollViewer。您需要公开属性`UserControl`才能从您的 TextBoxes 中获取信息，否则代码应该与我之前的回答类似。

IE：

**用户控件 Xaml**

```
<UserControl x:Class="WpfApplication1.UserControl1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="70" d:DesignWidth="985">
    <Grid Margin="8" Grid.Row="4" Grid.ColumnSpan="4" x:Name="amtGrid" Height="40">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="103"/>
            <ColumnDefinition Width="Auto" MinWidth="324"/>
            <ColumnDefinition Width="Auto" MinWidth="218"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <ComboBox x:Name="crdrnextrows" Margin="32.367,8,8,7.423" SelectedIndex="1" />
        <ComboBox Background="#FFC6C3C6" Margin="8" x:Name="comboboxCr" GotKeyboardFocus="comboboxCr_GotKeyboardFocus" Grid.Column="1"/>
        <TextBox Background="#FFC6C3C6" Foreground="White" IsEnabled="True" Margin="7.973,8,8,8" x:Name="txtBoxam1" Grid.Column="2" LostFocus="txtBoxam1_LostFocus"/>
        <TextBox Background="#FFC6C3C6" Foreground="White" IsEnabled="True" Margin="8,8,33.972,8" x:Name="txtBoxamt2" Grid.Column="3" LostFocus="txtBoxamt2_LostFocus"/>
    </Grid>
</UserControl> 
```

**窗口 Xaml**

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="123" Width="1098" xmlns:my="clr-namespace:WpfApplication1" MouseDoubleClick="Window_MouseDoubleClick">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Name="stackPanel1" VerticalAlignment="top" HorizontalAlignment="Left" >
            <my:UserControl1 x:Name="userControl11" Width="1077" />
        </StackPanel>
    </ScrollViewer>

</Window> 
```

**主窗口代码**

```
public partial class MainWindow : Window
{

    public MainWindow()
    {
        InitializeComponent();
    }

    private void Window_MouseDoubleClick(object sender, MouseButtonEventArgs e)
    {
        UserControl1 newUserControl = new UserControl1();
        newUserControl.Width = userControl11.Width;
        newUserControl.Height = userControl11.Height;
        stackPanel1.Children.Add(newUserControl);
    }

} 
```

* * *

这是一个基本的想法，我正在使用 a`StackPanel`来保存`TextBox's`您可能想要使用 a`DockPanel`来保存您的标签等并将其添加到`StackPanel`.

**Xaml**

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <Grid>
        <StackPanel Name="myContainer">
            <TextBox Height="23" HorizontalAlignment="Left" Margin="10,10,0,0" Name="textBox1" VerticalAlignment="Top" Width="120" KeyDown="textBox1_KeyDown" />
            <TextBox Height="23" HorizontalAlignment="Left" Margin="10,10,0,0" Name="textBox2" VerticalAlignment="Top" Width="120" KeyDown="textBox2_KeyDown"/>
        </StackPanel>
    </Grid>
</Window> 
```

**代码**

```
public partial class MainWindow : Window
{
    Collection<Control> myControls = new Collection<Control>();

    public MainWindow()
    {
        InitializeComponent();
        myControls.Add(textBox2);
    }

    private void textBox2_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Key == Key.Enter)
        {
            int temp;
            int sum;
            sum = 0;
            foreach (TextBox tb in myControls)
            {
                if (int.TryParse(tb.Text, out temp))
                {
                    sum += temp;
                }
            }
            int test = 0;
            if (int.TryParse(textBox1.Text, out test))
            {
                if (sum < test)
                {
                    TextBox newtb = new TextBox();
                    newtb.Width = ((TextBox)sender).Width;
                    newtb.Height = ((TextBox)sender).Height;
                    newtb.Margin = new Thickness(((TextBox)sender).Margin.Left, ((TextBox)sender).Margin.Top , ((TextBox)sender).Margin.Right , ((TextBox)sender).Margin.Bottom);
                    newtb.HorizontalAlignment = ((TextBox)sender).HorizontalAlignment;
                    newtb.KeyDown += new KeyEventHandler(textBox2_KeyDown);
                    myContainer.Children.Add(newtb);
                    myControls.Add(newtb);
                    newtb.Focus();
                }
                else
                    this.Background = Brushes.LightBlue;
            }
        }
    }

    private void textBox1_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Key == Key.Enter)
        {
            textBox2.Focus();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:05:19.057

将集合传递给项目。然后根据需要在集合中添加到集合中。

```
 public class dynamicInts
 {
     private int dInt;
     private ObservableCollection<DynamicInt> dynamicInts

     public int DInt 
     {
         get { return dInt; }
         set 
         {
             value = dInt;
             int sumInt;
             foreach (DynamicInt di in dynamicInts) sumInt += di.Dint)
             if (sumInt < 2*dynamicInts) dynamicInts.add(newdynamicInts ... 
```

# qt - 如何使用 EmbeddedVisualC++ 4.0 编译 Qt？

> ID：10058219
> 
> 赞同：0
> 
> 时间：2012-04-07T20:44:22.583
> 
> 标签：qt, windows-ce, evc4

是否可以使用 EmbeddedVisualC++ 4.0 而不是 MSVC 2005 为 WindowsCE 5.0 编译 Qt？我尝试按照[官方教程](http://doc.qt.nokia.com/4.7-snapshot/install-wince.html)进行操作，但无法正常工作。

“配置”脚本运行时没有错误，但是在调用 nmake 来实际构建库时，出现以下错误：

```
E:\QT\SDK\QtSources\4.8.0.ce>nmake

Microsoft (R) Program Maintenance Utility   Version 6.00.8168.0
Copyright (C) Microsoft Corp 1988-1998\. All rights reserved.

        cd src\winmain\ && NMAKE -f Makefile

Microsoft (R) Program Maintenance Utility   Version 6.00.8168.0
Copyright (C) Microsoft Corp 1988-1998\. All rights reserved.

        NMAKE -f Makefile.Debug all

Microsoft (R) Program Maintenance Utility   Version 6.00.8168.0
Copyright (C) Microsoft Corp 1988-1998\. All rights reserved.

        cl -c -nologo -Zm200 -Zc:wchar_t- -DDEBUG -D_DEBUG -Zi -MDd -W3 -w34100 -w34189 -EHs-c- -DQT_THREAD_SUPPORT -DUNDER_CE -DWINCE -D_WINDOWS -D_UNICODE -DUNICODE -D_WIN32 -DQT_NO_PRINTER -DQT_NO_PRINTDIALOG -DSTANDARDSHELL_UI_MODEL -D_WIN32_WCE=0x500 -DARMV4I -D_ARMV4I_ -Darmv4i -D_ARM_ -DARM -D_M_ARM -DARM -D__arm__ -DQ_OS_WINCE_STD -DQT_NO_PRINTER -DQT_NO_PRINTDIALOG -DQT_NO_CAST_TO_ASCII -DQT_ASCII_CAST_WARNINGS -DQT_MOC_COMPAT -DQT_USE_QSTRINGBUILDER -D_USE_MATH_DEFINES -DQT_NO_DYNAMIC_CAST -I"..\..\include" -I"tmp" -I"..\..\include\QtCore" -I"e:\QT\SDK\QtSources\4.8.0.ce\include\qtmain" -I"tmp\rcc\debug_shared" -I"tmp" -I"..\..\include\ActiveQt" -I"tmp\moc\debug_shared" -I"e:\QT\SDK\QtSources\4.8.0\src\winmain" -I"." -I"e:\QT\SDK\QtSources\4.8.0\mkspecs\wince50standard-armv4i-msvc2005" -Fotmp\obj\debug_shared\ @C:\Users\XYZ\AppData\Local\Temp\nma02104.
Command line warning D4002 : ignoring unknown option '-Zc'
Command line warning D4002 : ignoring unknown option '-Z:'
Command line warning D4002 : ignoring unknown option '-Zw'
Command line warning D4002 : ignoring unknown option '-Zc'
Command line warning D4002 : ignoring unknown option '-Zh'
Command line warning D4002 : ignoring unknown option '-Zr'
Command line warning D4002 : ignoring unknown option '-Z_'
Command line warning D4002 : ignoring unknown option '-Zt'
Command line warning D4002 : ignoring unknown option '-Z-'
Command line warning D4002 : ignoring unknown option '-w34100'
Command line warning D4002 : ignoring unknown option '-w34189'
qtmain_win.cpp
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\winnt.h(383) : error C2467: illegal declaration of anonymous 'struct'
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\winnt.h(402) : error C2467: illegal declaration of anonymous 'struct'
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\winnt.h(6040) : error C2467: illegal declaration of anonymous 'struct'
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\winnt.h(6049) : error C2467: illegal declaration of anonymous 'struct'
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\winnt.h(6746) : error C2133: 'pEventLogRecords' : unknown size
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\winnt.h(6752) : error C2133: 'ulOffsets' : unknown size
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\winbase.h(1130) : error C2467: illegal declaration of anonymous 'struct'
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\kfuncs.h(109) : error C2144: syntax error : missing ';' before type 'void'
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\kfuncs.h(109) : error C2501: '_inline' : missing storage-class or type specifiers
E:\Microsoft SDKs\Windows CE Tools\wce500\STANDARDSDK_500\Include\ARMV4I\kfuncs.h(109) : fatal error C1004: unexpected end of file found
NMAKE : fatal error U1077: 'cl' : return code '0x2'
Stop.
NMAKE : fatal error U1077: '"E:\Microsoft SDKs\Microsoft eMbedded C++ 4.0\COMMON\EVC\bin\NMAKE.EXE"' : return code '0x2'
Stop.
NMAKE : fatal error U1077: 'cd' : return code '0x2'
Stop. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T20:10:55.417

您能否确认您已为 eVC 安装了[Service Pack 4 ？](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=16683)这增加了对 Windows CE 5.0 的支持。

接下来，尝试使用与面向 Windows CE 5.0 SDK 的 QT 项目相同类型的 eVC 向导创建一个项目。将编译器和链接器设置从该向导创建的项目复制到您的 QT 项目。

还要确保您没有禁用[语言扩展。](http://msdn.microsoft.com/en-us/library/0k0w269d%28v=vs.71%29.aspx)尝试将 -Ze 添加到您的编译器标志中

-保罗H

# ubuntu - 了解虚拟机

> ID：10058221
> 
> 赞同：0
> 
> 时间：2012-04-07T20:44:42.030
> 
> 标签：ubuntu, windows-7, virtual-machine, virtualbox

我最近在 Ubuntu 上安装了 Oracle 的 VirtualBox，因为我需要运行 Win7。我将虚拟机的 RAM 设置为 1.5 GB。我的笔记本电脑只有 3 GB 的内存，因此我应该有另外 1.5 GB 的内存供 Ubuntu 使用。

现在，我的问题是：VM 关闭时分配给 VM 的内存是否可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T20:53:57.120

是的。一旦关闭虚拟框，它就会释放内存。
MoreDetails看@： [https ://forums.virtualbox.org/viewtopic.php?f=8&t=45385](https://forums.virtualbox.org/viewtopic.php?f=8&t=45385)

# html - 如何消除无序列表中每个列表项之间的间隙？

> ID：10058222
> 
> 赞同：0
> 
> 时间：2012-04-07T20:44:45.970
> 
> 标签：html, css, html-lists

每当我创建一个无序列表时，每个列表项下方都会有一个间隙。

我该怎么做才能删除它？

已经 在**ul****`margin : 0`** 和**li**上尝试过。CSS 重置**`padding : 0`**

 ****> `*{ margin : 0; padding: 0 }`

似乎也不起作用。

如果是水平列表，通常可以删除间隙。但是当我想要一个垂直列表时，我不知道如何做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:10:31.213

> @j08691 @developdaly：我在每个`<li>`. 这可能是问题吗？– maxxon15 6 分钟前

是的。是的，它可以。

添加此 CSS 以消除差距：

```
img {
    vertical-align: top;
} 
```

差距不在 each 之下`li`，而是在 each 之下`img`。****

# javascript - 向除发件人以外的所有客户端发送响应

> ID：10058226
> 
> 赞同：252
> 
> 时间：2012-04-07T20:45:07.810
> 
> 标签：javascript, node.js, socket.io

要将某些内容发送给所有客户端，请使用：

```
io.sockets.emit('response', data); 
```

要从客户那里接收，您使用：

```
socket.on('cursor', function(data) {
  ...
}); 
```

如何将两者结合起来，以便在服务器上从客户端接收消息时，将该消息发送给除发送消息的用户之外的所有用户？

```
socket.on('cursor', function(data) {
  io.sockets.emit('response', data);
}); 
```

我是否必须通过发送带有消息的客户端 ID 然后检查客户端来破解它，还是有更简单的方法？

* * *

## 回答 #1

> 赞同：927
> 
> 时间：2012-04-11T03:15:25.450

这是我的清单*（针对 1.0 更新）*：

```
// sending to sender-client only
socket.emit('message', "this is a test");

// sending to all clients, include sender
io.emit('message', "this is a test");

// sending to all clients except sender
socket.broadcast.emit('message', "this is a test");

// sending to all clients in 'game' room(channel) except sender
socket.broadcast.to('game').emit('message', 'nice game');

// sending to all clients in 'game' room(channel), include sender
io.in('game').emit('message', 'cool game');

// sending to sender client, only if they are in 'game' room(channel)
socket.to('game').emit('message', 'enjoy the game');

// sending to all clients in namespace 'myNamespace', include sender
io.of('myNamespace').emit('message', 'gg');

// sending to individual socketid
socket.broadcast.to(socketid).emit('message', 'for your eyes only');

// list socketid
for (var socketid in io.sockets.sockets) {}
 OR
Object.keys(io.sockets.sockets).forEach((socketid) => {}); 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2015-01-17T18:23:32.543

来自@LearnRPG 的答案，但使用 1.0：

```
 // send to current request socket client
 socket.emit('message', "this is a test");

 // sending to all clients, include sender
 io.sockets.emit('message', "this is a test"); //still works
 //or
 io.emit('message', 'this is a test');

 // sending to all clients except sender
 socket.broadcast.emit('message', "this is a test");

 // sending to all clients in 'game' room(channel) except sender
 socket.broadcast.to('game').emit('message', 'nice game');

 // sending to all clients in 'game' room(channel), include sender
 // docs says "simply use to or in when broadcasting or emitting"
 io.in('game').emit('message', 'cool game');

 // sending to individual socketid, socketid is like a room
 socket.broadcast.to(socketid).emit('message', 'for your eyes only'); 
```

要回答@Crashalot 评论，`socketid`来自：

```
var io = require('socket.io')(server);
io.on('connection', function(socket) { console.log(socket.id); }) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-06-06T12:00:10.437

这是关于从 0.9.x 到 1.x 发生了什么变化的更完整的答案。

```
 // send to current request socket client
 socket.emit('message', "this is a test");// Hasn't changed

 // sending to all clients, include sender
 io.sockets.emit('message', "this is a test"); // Old way, still compatible
 io.emit('message', 'this is a test');// New way, works only in 1.x

 // sending to all clients except sender
 socket.broadcast.emit('message', "this is a test");// Hasn't changed

 // sending to all clients in 'game' room(channel) except sender
 socket.broadcast.to('game').emit('message', 'nice game');// Hasn't changed

 // sending to all clients in 'game' room(channel), include sender
 io.sockets.in('game').emit('message', 'cool game');// Old way, DOES NOT WORK ANYMORE
 io.in('game').emit('message', 'cool game');// New way
 io.to('game').emit('message', 'cool game');// New way, "in" or "to" are the exact same: "And then simply use to or in (they are the same) when broadcasting or emitting:" from http://socket.io/docs/rooms-and-namespaces/

 // sending to individual socketid, socketid is like a room
 io.sockets.socket(socketid).emit('message', 'for your eyes only');// Old way, DOES NOT WORK ANYMORE
 socket.broadcast.to(socketid).emit('message', 'for your eyes only');// New way 
```

*我想编辑@soyuka 的帖子，但我的编辑被同行评审拒绝了。*

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-01-31T05:57:40.670

# 发出备忘单

```
io.on('connect', onConnect);

function onConnect(socket){

  // sending to the client
  socket.emit('hello', 'can you hear me?', 1, 2, 'abc');

  // sending to all clients except sender
  socket.broadcast.emit('broadcast', 'hello friends!');

  // sending to all clients in 'game' room except sender
  socket.to('game').emit('nice game', "let's play a game");

  // sending to all clients in 'game1' and/or in 'game2' room, except sender
  socket.to('game1').to('game2').emit('nice game', "let's play a game (too)");

  // sending to all clients in 'game' room, including sender
  io.in('game').emit('big-announcement', 'the game will start soon');

  // sending to all clients in namespace 'myNamespace', including sender
  io.of('myNamespace').emit('bigger-announcement', 'the tournament will start soon');

  // sending to individual socketid (private message)
  socket.to(<socketid>).emit('hey', 'I just met you');

  // sending with acknowledgement
  socket.emit('question', 'do you think so?', function (answer) {});

  // sending without compression
  socket.compress(false).emit('uncompressed', "that's rough");

  // sending a message that might be dropped if the client is not ready to receive messages
  socket.volatile.emit('maybe', 'do you really need it?');

  // sending to all clients on this node (when using multiple nodes)
  io.local.emit('hi', 'my lovely babies');

}; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-04-08T01:05:08.190

broadcast.emit 将 msg 发送给所有其他客户端（发送者除外）

```
socket.on('cursor', function(data) {
  socket.broadcast.emit('msg', data);
}); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-05T17:33:30.303

For namespaces within rooms looping the list of clients in a room (similar to Nav's answer) is one of only two approaches I've found that will work. The other is to use exclude. E.G.

```
socket.on('message',function(data) {
    io.of( 'namespace' ).in( data.roomID ).except( socket.id ).emit('message',data);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-01-19T15:49:32.257

其他案例

```
io.of('/chat').on('connection', function (socket) {
    //sending to all clients in 'room' and you
    io.of('/chat').in('room').emit('message', "data");
}; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-10-11T13:24:52.133

# **为 Socket.io v4.0.0+ 更新**

## 要在 v4 中向除发件人之外的所有客户端发出，请使用：

```
socket.broadcast.emit(/* ... */); 
```

**示例用法**

```
io.on("connection", (socket) => {
   socket.on("message", (message) => {
      //sends "newMessage" to all sockets except sender
      socket.broadcast.emit("newMessage", message)
   })
}) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-11-27T14:13:43.367

更新了列表以获取更多文档。

```
socket.emit('message', "this is a test"); //sending to sender-client only
socket.broadcast.emit('message', "this is a test"); //sending to all clients except sender
socket.broadcast.to('game').emit('message', 'nice game'); //sending to all clients in 'game' room(channel) except sender
socket.to('game').emit('message', 'enjoy the game'); //sending to sender client, only if they are in 'game' room(channel)
socket.broadcast.to(socketid).emit('message', 'for your eyes only'); //sending to individual socketid
io.emit('message', "this is a test"); //sending to all clients, include sender
io.in('game').emit('message', 'cool game'); //sending to all clients in 'game' room(channel), include sender
io.of('myNamespace').emit('message', 'gg'); //sending to all clients in namespace 'myNamespace', include sender
socket.emit(); //send to all connected clients
socket.broadcast.emit(); //send to all connected clients except the one that sent the message
socket.on(); //event listener, can be called on client to execute on server
io.sockets.socket(); //for emiting to specific clients
io.sockets.emit(); //send to all connected clients (same as socket.emit)
io.sockets.on() ; //initial connection from a client. 
```

希望这可以帮助。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-06-22T02:42:35.823

# V4.x 中服务器端所有有效的发出事件列表

```
io.on("connection", (socket) => {

// basic emit
socket.emit(/* ... */);

// to all clients in the current namespace except the sender
socket.broadcast.emit(/* ... */);

// to all clients in room1 except the sender
socket.to("room1").emit(/* ... */);

// to all clients in room1 and/or room2 except the sender
socket.to(["room1", "room2"]).emit(/* ... */);

// to all clients in room1
io.in("room1").emit(/* ... */);

// to all clients in room1 and/or room2 except those in room3
io.to(["room1", "room2"]).except("room3").emit(/* ... */);

// to all clients in namespace "myNamespace"
io.of("myNamespace").emit(/* ... */);

// to all clients in room1 in namespace "myNamespace"
io.of("myNamespace").to("room1").emit(/* ... */);

// to individual socketid (private message)
io.to(socketId).emit(/* ... */);

// to all clients on this node (when using multiple nodes)
io.local.emit(/* ... */);

// to all connected clients
io.emit(/* ... */);

// WARNING: `socket.to(socket.id).emit()` will NOT work, as it will send to everyone in the room
// named `socket.id` but the sender. Please use the classic `socket.emit()` instead.

// with acknowledgement
socket.emit("question", (answer) => {
    // ...
});

// without compression
socket.compress(false).emit(/* ... */);

// a message that might be dropped if the low-level transport is not writable
socket.volatile.emit(/* ... */);

}); 
```

# 客户端

```
// basic emit
    socket.emit(/* ... */);

// with acknowledgement
    socket.emit("question", (answer) => {
        // ...
    });

// without compression
    socket.compress(false).emit(/* ... */);

// a message that might be dropped if the low-level transport is not writable
    socket.volatile.emit(/* ... */); 
```

存档链接到源 => [http://archive.today/2021.06.22-023900/https://socket.io/docs/v4/emit-cheatsheet/index.html](http://archive.today/2021.06.22-023900/https://socket.io/docs/v4/emit-cheatsheet/index.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-01-15T11:08:52.907

使用这个编码

```
io.sockets.on('connection', function (socket) {

    socket.on('mousemove', function (data) {

        socket.broadcast.emit('moving', data);
    }); 
```

这个 socket.broadcast.emit() 将在函数中发出任何东西，除了正在发出的服务器

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-06-16T11:17:07.700

我正在使用命名空间和房间 - 我发现

```
socket.broadcast.to('room1').emit('event', 'hi'); 
```

在哪里工作

```
namespace.broadcast.to('room1').emit('event', 'hi'); 
```

没有

（如果其他人面临这个问题）

# python - 计算具有不同长度的数组的平均值

> ID：10058227
> 
> 赞同：11
> 
> 时间：2012-04-07T20:45:12.940
> 
> 标签：python, arrays, numpy, mean

当它们可能具有不同的长度时，是否可以计算多个数组的平均值？我正在使用 numpy。所以假设我有：

```
numpy.array([[1, 2, 3, 4, 8],    [3, 4, 5, 6, 0]])
numpy.array([[5, 6, 7, 8, 7, 8], [7, 8, 9, 10, 11, 12]])
numpy.array([[1, 2, 3, 4],       [5, 6, 7, 8]]) 
```

现在我想计算平均值，但忽略“缺失”的元素（当然，我不能只附加零，因为这会弄乱平均值）

有没有办法在不遍历数组的情况下做到这一点？

PS。这些数组都是二维的，但该数组的坐标数量总是相同的。即第一个数组是 5 和 5，第二个是 6 和 6，第三个是 4 和 4。

一个例子：

```
np.array([[1, 2],    [3, 4]])
np.array([[1, 2, 3], [3, 4, 5]])
np.array([[7],       [8]]) 
```

这必须给

```
(1+1+7)/3  (2+2)/2   3/1
(3+3+8)/3  (4+4)/2   5/1 
```

并以图形方式：

```
[1, 2]    [1, 2, 3]    [7]
[3, 4]    [3, 4, 5]    [8] 
```

现在想象这些二维数组被放置在彼此的顶部，坐标重叠有助于该坐标的平均值。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-07T21:24:56.893

[numpy.ma.mean](http://docs.scipy.org/doc/numpy/reference/generated/numpy.ma.mean.html#numpy-ma-mean)允许您计算非掩码数组元素的平均值。但是，要使用`numpy.ma.mean`，您必须首先将三个 numpy 数组组合成一个掩码数组：

```
import numpy as np
x = np.array([[1, 2], [3, 4]])
y = np.array([[1, 2, 3], [3, 4, 5]])
z = np.array([[7], [8]])

arr = np.ma.empty((2,3,3))
arr.mask = True
arr[:x.shape[0],:x.shape[1],0] = x
arr[:y.shape[0],:y.shape[1],1] = y
arr[:z.shape[0],:z.shape[1],2] = z
print(arr.mean(axis = 2)) 
```

产量

```
[[3.0 2.0 3.0]
 [4.66666666667 4.0 5.0]] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-12-11T08:21:46.400

我经常需要它来绘制不同长度的性能曲线的平均值。

[![绘制不同长度的多条曲线](../Images/07d3db32793c490d894387de912eeac3.png)](https://i.stack.imgur.com/JTPfVm.png)

用简单的功能解决了它（基于@unutbu的回答）：

```
def tolerant_mean(arrs):
    lens = [len(i) for i in arrs]
    arr = np.ma.empty((np.max(lens),len(arrs)))
    arr.mask = True
    for idx, l in enumerate(arrs):
        arr[:len(l),idx] = l
    return arr.mean(axis = -1), arr.std(axis=-1)

y, error = tolerant_mean(list_of_ys_diff_len)
ax.plot(np.arange(len(y))+1, y, color='green') 
```

因此，将该函数应用于上面绘制的曲线列表会产生以下结果：

[![不同长度曲线的均值和标准差图](../Images/291aa630a97862e84ef5eed3265b13a8.png)](https://i.stack.imgur.com/j3LdLm.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-14T00:07:33.157

下面的函数也可以通过添加不同长度的数组列来工作：

```
def avgNestedLists(nested_vals):
    """
    Averages a 2-D array and returns a 1-D array of all of the columns
    averaged together, regardless of their dimensions.
    """
    output = []
    maximum = 0
    for lst in nested_vals:
        if len(lst) > maximum:
            maximum = len(lst)
    for index in range(maximum): # Go through each index of longest list
        temp = []
        for lst in nested_vals: # Go through each list
            if index < len(lst): # If not an index error
                temp.append(lst[index])
        output.append(np.nanmean(temp))
    return output 
```

离开你的第一个例子：

```
avgNestedLists([[1, 2, 3, 4, 8], [5, 6, 7, 8, 7, 8], [1, 2, 3, 4]]) 
```

输出：

```
[2.3333333333333335,
 3.3333333333333335,
 4.333333333333333,
 5.333333333333333,
 7.5,
 8.0] 
```

一开始没有使用 np.amax(nested_lst) 或 np.max(nested_lst) 来查找最大值的原因是因为如果嵌套列表的大小不同，它将返回一个数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-08T15:40:33.170

OP，我知道您正在寻找一个非迭代的内置解决方案，但以下内容实际上只需要 3 行（如果您结合使用，则为 2 行`transpose`，`means`但它会变得混乱）：

```
arrays = [
    np.array([1,2], [3,4]),
    np.array([1,2,3], [3,4,5]),
    np.array([7], [8])
    ]

mean = lambda x: sum(x)/float(len(x)) 

transpose = [[item[i] for item in arrays] for i in range(len(arrays[0]))]

means = [[mean(j[i] for j in t if i < len(j)) for i in range(len(max(t, key = len)))] for t in transpose] 
```

输出：

```
>>>means
[[3.0, 2.0, 3.0], [4.666666666666667, 4.0, 5.0]] 
```

# java - 解析包含 Struts2 xslt 结果类型中的集合的 Hibernate 对象时出现问题

> ID：10058228
> 
> 赞同：1
> 
> 时间：2012-04-07T20:45:13.457
> 
> 标签：java, hibernate, struts2, persistence

我正在编写一个应用程序，该应用程序利用具有几个多对一和一对多表关系的数据库。我使用 Eclipse 中的 JBOSS 工具对数据库进行逆向工程并创建 POJO，外键关系的 getter 和 setter 如下所示：

```
@OneToMany(fetch = FetchType.LAZY, mappedBy = "users")
@LazyCollection(LazyCollectionOption.EXTRA)
public Set<Layouts> getLayoutses() {
    return this.layoutses;
}

public void setLayoutses(Set<Layouts> layoutses) {
    this.layoutses = layoutses;
} 
```

在这些情况下，Set 要么是空的 HashSet，要么是用 POJO 填充的 HashSet，代表数据库中的另一个表。

问题是转换过程在 Set 属性上阻塞。如果我将 FetchType 保留在“LAZY”上，我会收到一条`javax.xml.transform.TransformerException: Error transforming result`消息，如果我将其更改为“EAGER”，我不会收到错误消息，但 Struts2 也没有响应（浏览器只会永远加载）。如果我将 Set getter 更改为“protected”或“private”而不是“public”，那么一切都会顺利进行，当然，除了结果集不包含这些属性这一事实。

我读过的所有内容似乎都表明 Struts2 应该能够处理集合，但是我能够找到的唯一 Struts2/Hibernate 集成示例处理非常简单的数据，其中不包含映射的外键关系。

为了让 Struts2 xslt 结果类型与我的 Hibernate 持久性对象很好地配合，我需要做什么？

# javascript - Primefaces DataTable 等待数据加载的时间

> ID：10058229
> 
> 赞同：1
> 
> 时间：2012-04-07T20:45:23.253
> 
> 标签：javascript, primefaces

嗨 Stack Overflow 我有一个网络应用程序，我添加到 Primefaces 库中，以便使用 dataTables 做一些很酷的事情。

我有一个显示我的字段和排序并有分页的数据表。所以如果我有 100 条记录它一次显示 25 条，可以单击一个页面转到它，但是我有这么多信息，实际加载新信息需要几秒钟（你想要的正确页面on) 所以我有一个隐藏的 div，当有一些等待更新表格和诸如此类的事情时，我可以使用它来显示。

js看起来像这样：

```
 function loading(){
                $( "#loadingPopUp" ).dialog( "open" );
                return false;
            } 
```

我的 div 看起来像这样：

```
<div id="loadingPopUp">                 
            <ul class="appnitro"  >
                        <div> <p><b> Please Wait</b></p> <p><img src="/miloWeb/images/loading.gif"  /></p>  </div>
            </ul>               
        </div> 
```

数据表非常基础：

```
<p:dataTable 
                                                                                 id="dataTable" 
                    value="#{auditBB.auditList}"
                                                                                 var="testVar" 
                    rows="25"  
                    paginator="true" 
                    paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                    rowsPerPageTemplate="5,10,15,25,50,100">
//
//columns go here
//
</p:dataTable 
```

如何在 javascrip loading() 中调用该方法，以便当我单击要转到的页面编号时，然后在数据实际再次加载时再次隐藏它？谢谢！

视觉支持：![在此处输入图像描述](../Images/ab39100d8800609f62965324d53dc24b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T05:52:56.400

如果您已经将 primefaces 集成到您的项目中，为什么不使用它的[AJAX - 状态](http://www.primefaces.org/showcase/ui/pprAjaxStatus.jsf)

它非常简单，完全符合您的要求，`Ajax Status is a global indicator to inform users about the ajax interactions.`

看看简单的[Ajax 状态](http://www.primefaces.org/showcase/ui/pprAjaxStatus.jsf)示例和更[高级](http://www.primefaces.org/showcase/ui/pprAjaxStatusScript.jsf)的示例，您所要做的就是`<p:ajaxStatus`将网络应用程序...）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T02:51:35.630

什么pf版本？你看过橱窗里的blockUi了吗？

# javascript - err 变量空间未定义为什么？

> ID：10058233
> 
> 赞同：0
> 
> 时间：2012-04-07T20:45:49.707
> 
> 标签：javascript, html, cookies

我运行下一个代码，但我想念一些东西，对我来说似乎还可以：

```
window.onload = TitleFieldInit;
function TitleFieldInit() {
    var str = document.cookie.split("=")[1];
    var space = str.split("=")[1];
    space = space.split(";")[0];
    alert(space);
    // while( space.indexOf('%20' )+1) space = space.replace(/%20/,' ');
    if (document.cookie != "") {
        document.getElementById("TitleField").innerHTML = "Your Title is : " + space;
    }
}​ 
```

我在 FireFox 中出错 rror"space is undefined" 为什么？在 chrome 中“Uncaught TypeError:Cannot call method'split' of Undefined”谢谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T20:50:37.577

此代码永远不会适用于任何输入。

`str`已经是 split by 的结果的一部分`=`，即它不包含`=`符号。

然后你再次将该结果拆分为`=`，这当然会返回一个元素数组，并且`str.split("=")[1]`永远是`undefined`。

看起来您正在尝试读取 cookie 值......但`.split("=")`根本不需要第二个。

啊，你在不同的浏览器中得到了不同的结果，因为它们的 cookie 中包含不同的数据。

PS：而不是`while( space.indexOf('%20' )+1) space = space.replace(/%20/,' ');`你可以写`space = space.replace(/%20/g,' ');`来一次替换所有这些。

# c - void* 与 char* 指针运算

> ID：10058234
> 
> 赞同：14
> 
> 时间：2012-04-07T20:45:51.157
> 
> 标签：c, pointers, pointer-arithmetic

我正在浏览我的教科书，我对其中的一些代码有点困惑。一方面，他们以下列方式执行指针运算：

```
void* bp;
...
bp = (void*)((char*)(bp)+16);
... 
```

但后来，他们执行以下操作：

```
void* bp;
...
bp = bp+16;
... 
```

我觉得他们应该是两个不同的东西，但他们把它当作同一个东西对待。我有这种感觉是因为，例如，如果您要进行数组访问（例如，对于整数数组），您将执行以下操作

```
int* a = malloc(n*sizeof(int));
...
q = *(a+1);
... 
```

在这种情况下，我不是访问整数数组中的下一个 4 个字节而不是下一个字节吗？同样，我觉得如果我有 void* a，那么 *(a+1) 应该是接下来的 4 个字节......或者不是这样吗？谢谢你。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-07T20:48:30.710

这是一个失误。算术 on`void *`不是由标准定义的，但一些编译器将其作为扩展提供，其行为与`char *`算术相同。第二个在形式上不是有效的 C，但可能是出于（坏）习惯。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-10-08T09:33:33.077

接受的答案是一个很好的总结，我想更清楚地说明为什么要使用一个或另一个。;)

尽管 (void *) 和 (char *) 都可以等效地转换为任何其他指针类型，**但如果您想遵守标准 C，则仅对 (char *) 执行指针运算而不是 (void *) 是合法的.**

为什么两者都用作指针？大多数与 (void *) 的指针转换都可以在没有强制转换的情况下完成，但 (char *) 的使用是对旧时代的回忆。

GCC 不会就 (void *) 上的指针运算发出警告，因为它不是一个旨在符合标准 C 而是适用于 GNU C 的编译器。要符合标准 C，您可以使用以下标志：

```
gcc -ansi -pedantic -Wall -Wextra -Werror <more args...> 
```

我的底线：

*   如果要**执行指针运算：使用 (char *)**
*   如果您想**获取指针地址以便稍后将其转换为另一种类型：使用 (void *)**

# objective-c - 圆的boundingMapRect

> ID：10058238
> 
> 赞同：2
> 
> 时间：2012-04-07T20:46:24.340
> 
> 标签：objective-c, mkmapview, mkoverlay, mkmaprect

对于 MKMapView 覆盖，我需要计算一个圆的 boundingMapRect。我有它的中心坐标和半径（以米为单位） - 但不知道如何获得相应的 boundingMapRect。作为解决方法，我创建了一个具有相同数据的 MKCircle 并从中使用 boundingMapRect。但是……至少，这并不优雅。

那么：如何为具有给定半径和中心的圆计算 boundingMapRect？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T23:40:33.200

```
MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(center_coord, radius, radius); 
```

然后使用此处的答案将 MKCoordinateRegion 转换为 MKMapRect [将 MKCoordinateRegion 转换为 MKMapRect](https://stackoverflow.com/questions/9270268/convert-mkcoordinateregion-to-mkmaprect)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T07:03:08.230

克雷格的回答对我有用：

```
- (MKMapRect)boundingMapRect
{
    MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(self.coordinate, self.radius, self.radius);
    MKMapRect boundingRect = MKMapRectForCoordinateRegion(region);
    return boundingRect;
}

MKMapRect MKMapRectForCoordinateRegion(MKCoordinateRegion region)
{
    MKMapPoint a = MKMapPointForCoordinate(CLLocationCoordinate2DMake(
                                                                      region.center.latitude + region.span.latitudeDelta / 2,
                                                                      region.center.longitude - region.span.longitudeDelta / 2));
    MKMapPoint b = MKMapPointForCoordinate(CLLocationCoordinate2DMake(
                                                                      region.center.latitude - region.span.latitudeDelta / 2,
                                                                      region.center.longitude + region.span.longitudeDelta / 2));
    return MKMapRectMake(MIN(a.x,b.x), MIN(a.y,b.y), ABS(a.x-b.x), ABS(a.y-b.y));
} 
```

# javascript - 有权限的 Chrome 扩展和 XHR

> ID：10058240
> 
> 赞同：1
> 
> 时间：2012-04-07T20:46:34.287
> 
> 标签：javascript, google-chrome, xmlhttprequest

我正在开发 Chrome 扩展程序，但 XHR 跨域存在一些问题。让我解释一下：我为域设置了正确的权限，`manifest.json`并（在我的 js 文件中）创建了一个简单的 XMLHttpRequest。请求工作正常，但`responseXML`字段是`null`. 为什么？这不是 SOP 的问题，并且`responseText`正确包含所请求页面的 HTML 文本。我该如何解析它？`DOMParser().parseFromString`即使使用[https://developer.mozilla.org/en/DOMParser](https://developer.mozilla.org/en/DOMParser)实现，我也无法做到这一点，我每次都会收到一个。

一些建议？我的（简单）代码如下：

```
var req = new XMLHttpRequest();
req.open("GET", "http://somedomain.com", true);

req.overrideMimeType("text/xml");
req.setRequestHeader("Content-Type", "text/xml");
req.onload = anonymousFunction;

req.send(null); 
```

感谢您的回复！

# java - 在 Java MongoDb 中，如何将特定字段的值保存在 ArrayList 中？

> ID：10058242
> 
> 赞同：2
> 
> 时间：2012-04-07T20:46:44.750
> 
> 标签：java, mongodb

假设我们有以下文件：

```
 {{i:1},{i:9},{i:10}}
  {i:3}
  {{i:4},{i:0}}
  {{i:5},{i:-3},{i:30}} 
```

每行代表一个文档

是否可以将 i 的值保存在 ArrayList 或某种一般的 List 中？

我试图在java中实现这一点

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T13:31:55.923

如果您按以下方式稍微更改您的文件：

```
{ivalues:[{i:1},{i:9},{i:10}]} 
```

然后你应该能够在 Java 中创建文档，如下所示：

```
ArrayList<DBObject> x = new ArrayList<DBObject>();
x.add(new BasicDBObject("i", 1));
x.add(new BasicDBObject("i", 9));
x.add(new BasicDBObject("i", 10));
BasicDBObject doc = new BasicDBObject("ivalues", x); 
```

并正常保存/检索它。

# multithreading - MESI 缓存协议

> ID：10058243
> 
> 赞同：9
> 
> 时间：2012-04-07T20:46:51.643
> 
> 标签：multithreading, caching, multiprocessing, x86-64, mesi

我正在阅读[MESI snooping cache coherence protocol](http://en.wikipedia.org/wiki/MESI_protocol)，我猜这是现代多核 x86 处理器中使用的协议（如果我错了，请纠正我）。现在那篇文章在一个地方说了这一点。

> 保持处于修改状态的行的高速缓存必须侦听（拦截）相应主内存位置的所有尝试读取（来自系统中的所有其他高速缓存）并插入它所拥有的数据。这通常通过强制读取后退（即稍后重试），然后将数据写入主存储器并将高速缓存行更改为共享状态来完成。

现在我不明白的是为什么需要将数据写入主存储器。缓存一致性不能在不进入内存的情况下保持缓存中的内容同步（除非缓存行确实被驱逐了）？我的意思是，如果一个内核不断读取，另一个内核不断写入，为什么不将数据保留在缓存中，并不断更新缓存中的数据。为什么会产生回写到主存的性能？

换句话说，读取数据的核心不能直接从写入核心的缓存中读取并相应地修改他们的缓存吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T21:28:07.773

> 现在我不明白的是为什么需要将数据写入主存储器。缓存一致性不能在不进入内存的情况下保持缓存中的内容同步（除非缓存行确实被驱逐了）？

这确实发生了。

我的笔记本电脑上有一个看起来像这样的 iCore 5；

```
 M
   N
   S
  L3U
L2U L2U
L1D L1D
L1I L1I
 P   P
L L L L

M = Main memory
N = NUMA node
S = Socket
L3U = Level 3 Unified
L2U = Level 2 Unified
L1D = Level 1 Data
L1I = Level 1 Instruction
P = Processor
L = Logical core 
```

当两个逻辑核对相同的数据进行操作时，它们不会移出到主存；它们通过 L1 和 L2 缓存进行交换。同样，当两个处理器中的内核工作时，它们通过 L3 缓存交换数据。除非发生驱逐，否则不使用主内存。

但是更简单的 CPU 确实可能不太聪明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-07T20:57:23.420

MESI 协议不允许多个缓存将同一缓存行保持在一个`modified`状态。因此，如果一个高速缓存行被修改并想从其他处理器的高速缓存中读取，则必须先将其写入主存储器然后再读取，以便两个处理器的高速缓存现在都`share`在该行（共享状态）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-07T21:03:27.440

因为缓存通常不能直接相互写入（因为这会占用更多带宽）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-07T20:56:36.477

> 我不明白的是为什么需要将数据写入主存

让我们的处理器 A 有那条`modified`线。现在处理器 B 正试图从主存储器读取相同的高速缓存（由 A 修改）行。由于主存储器中的内容现在无效（因为 A 修改了内容），A 正在窥探该行的任何其他读取尝试。因此，为了允许处理器 B（和其他处理器）读取该行，A 必须将其写回主存。

> ```
> I mean if one core is constantly reading and the other constantly writing, 
> ```
> 
> 为什么不将数据保存在缓存中，并不断更新缓存中的数据。

你是对的，这就是通常所做的。但在这里，情况并非如此。其他人（我们示例中的处理器 B）正在尝试读取。因此，A 必须将其写回并将缓存线状态设置为，`shared`因为 A 和 B 现在都共享缓存线。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-24T20:46:49.447

所以实际上我不认为读取缓存必须进入主内存。在 MESI 中，当一个处理器请求一个由它的对等体修改的块时，它会在总线（或任何互连介质）上发出读取未命中，该读取未命中将广播到每个处理器。

将块保持在“已修改”状态的处理器捕获调用，并在总线上发回一份副本 - 保存块 ID 和值 - 同时将其自己的副本状态更改为“共享”。请求处理器接收到这个复制回来，它将把块写入它的本地缓存并将其标记为“共享”。

由拥有的处理器发出的副本是否进入主存储器取决于实现。

编辑：请注意，MOESI 协议添加了一个与“共享”非常相似的“拥有”状态，并允许持有处于拥有状态的块副本的处理器在捕获广播时复制回总线上的值此块的写/读未命中。

# jquery - jquery动画顶部与marginTop

> ID：10058244
> 
> 赞同：0
> 
> 时间：2012-04-07T20:46:56.393
> 
> 标签：jquery, html

当我使用jQuery animate 时，我遇到了最奇怪的问题，`marginTop`但 我的小提琴`top`什么也没做：http: [//jsfiddle.net/nalagg/nnqt6/1/](http://jsfiddle.net/nalagg/nnqt6/1/) 有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T20:52:43.187

[http://jsfiddle.net/nnqt6/3/](http://jsfiddle.net/nnqt6/3/)

您需要一个`position: relative;`附加的每个 li 将动画下来。顶部 CSS 参数不能像这样更改，除非它的顶部位置是相对于另一个元素的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T20:55:48.333

尝试添加这个：

```
.otherBtns{position:relative;} 
```

# coldfusion - Coldfusion 循环行为

> ID：10058246
> 
> 赞同：1
> 
> 时间：2012-04-07T20:47:02.527
> 
> 标签：coldfusion

我对 Coldfusion 不是很熟悉，但我正在阅读一些代码并看到了这个：

```
 <CFLOOP INDEX="element" LIST="#FIELDNAMES#">
    <CFSET REP_LIMIT = 0>
    <CFSET E_VALUE = EVALUATE(#ELEMENT#)> 
```

我有两个问题：1）将 E_VALUE 设置为当前索引吗？如果是这样，评估是什么？和 2) 这是对 EVALUATE 的不良和/或危险使用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:13:00.130

Evaluate 主要用于评估动态命名的变量，例如表单变量。如果您不知道可以从表单提交哪些表单变量，您可以通过访问 FORM.fieldnames 来简单地遍历字段名。

（http://cfprimer.blogspot.com/2005/03/avoid-evaluate.html）。在 14 年的 CF 编码中，我只见过它使用过几次。在我看来，将自己设置为事先不知道将提交哪些表单元素是一种不好的做法。

在您的示例中，索引设置为“元素”。因此，在循环时，“字段名”列表中的任何内容都将是一个元素。

如果您想输出这些字段名，您可以执行以下操作：

```
<cfset fieldnames = "firstname,lastname,email">
<cfoutput>
<cfloop index="element" list="#fieldnames#">
     #element#<br>
</cfloop>
</cfoutput> 
```

这将输出如下：

```
firstname
lastname
email 
```

# php - 在 cakePHP 中从控制器传递两个数组

> ID：10058249
> 
> 赞同：1
> 
> 时间：2012-04-07T20:47:24.593
> 
> 标签：php, cakephp, variable-assignment

我正在尽我所能学习 MVC 和 cakePHP，我有一个关于将数组传递给视图的问题。目前，我在下面有一些基本代码。

类 AwarenesscampaignsController 扩展 AppController {

```
public function view($id = null) {
    $this->Awarenesscampaign->id = $id;
    $this->set('data', $this->Awarenesscampaign->read());
} 
```

这就是我“认为”目前正在发生的事情。

AwarenesscampaignsController 已设置。视图参数请求 id 并将其与模型 Awarenesscampaign 匹配。这与数据库匹配并返回一个设置为变量“$data”的数组，然后加载视图。

我的第一个问题：我的理解准确吗？

我想做的是能够从不同的模型传递另一个数组。例如，我想查询表 Posts (Controller: PostsController/ Model: Post)。

例如，我的第一次尝试是在函数内部执行以下操作：

$this->Post->find('all');

但这会产生错误：

间接修改重载属性 AwarenesscampaignsController::$Post 无效 [APP/Controller/AwarenesscampaignsController.php, line 20]

此外，我不确定如何将这两个变量发送到视图。

回顾一下：

1.  我的理解准确吗？
2.  如何从另一个控制器/模型查询变量？
3.  如何将此数组发送到该控制器的适当视图？

谢谢，-M

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:08:29.000

你在正确的路线上，并且本身并没有做错。我想说你的理解对于初学者来说非常好。

默认情况下，Cake 会自动加载它认为与控制器直接相关的模型。所以在 中`AwarenesscampaignController`，你可以自动访问`Awarenesscampaign`（模型）。

不过，它不知道任何其他型号。您可以解决此问题的一种方法是将以下属性添加到您的控制器：

```
// This has to contain ALL models you intend to use in the controller
public $uses = array('Awarenesscampaign', 'Post'); 
```

在开始声明函数之前，这位于类的顶部。它告诉 Cake 你想使用除“默认”模型之外的其他模型，但你也必须将那个模型添加到数组中，否则你将无法访问它。

`loadModel`如果是一次性的，您也可以在您的操作中使用。然后以与正常访问模型相同的方式访问它：

```
public function view($id = null) {
    $this->loadModel('Post');
    $posts = $this->Post->find('all');
    ...
} 
```

要将其发送到您的视图，您可以`set`再次调用，但您可能希望更改`data`为更具可读性的内容，并防止混淆：

```
public function view($id = null) {
    ...
    $this->set('campaign', $this->Awarenesscampaign->read());
    $this->set('posts', $this->Post->find('all'));
} 
```

它们将分别可以`$campaign`访问`$post`。

不过，我要做的一个调整是不要使用“读取”，除非您打算编辑某些内容。您可以使用`findByColumnName`来获取相同的数据。由于您只使用一个`id`，您可以调用`findById`：

```
$campaign = $this->Awarenesscampaign->findById($id); 
```

那里有很多魔法。这只是意味着您可以以更简写的格式搜索特定值。

[http://book.cakephp.org/2.0/en/models/retrieving-your-data.html](http://book.cakephp.org/2.0/en/models/retrieving-your-data.html)

最后，虽然您可以访问其他模型（如图所示），但您不能或通常*不应该*尝试从另一个控制器访问一个控制器。如果您有想要在多个控制器中使用的代码，但无法进入模型，您可以创建`Components`.

[http://book.cakephp.org/2.0/en/controllers/components.html#creating-a-component](http://book.cakephp.org/2.0/en/controllers/components.html#creating-a-component)

该手册相当全面。虽然有时难以导航，但它通常可以回答您的大多数问题。

[http://book.cakephp.org/2.0/en/](http://book.cakephp.org/2.0/en/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T21:13:56.063

1）你的理解足够好。这基本上是用对象映射一行数据库表。因此，在设置了 Model id 之后`$this->Awarenesscampaign->id = $id`，现在 Model 指向的数据库表的 id 等于传递给查看操作的内容。

2）您可以通过调用该特定模型的方法来查询另一个表。如果您的模型以某种方式与您所在的当前模型相关联，则可以使用链接来调用该模型的操作。例如，如果您的 in Posts 控制器和 Post Model 与 Comment Model 相关联，则可以获取您可以链接的数据。

```
 $comments = $this->Post->Comment->find(); 
```

但是，如果您感兴趣的模型与当前模型没有关联，则有几种方法可以执行其他模型的操作。一个不错的选择是使用类注册表。例如，假设您想使用与当前模型无关的客户模型。在你的控制器中，你会做

```
 $customer= ClassRegistry::init("Customer");
   $customers= $customer->find(); 
```

3）为视图设置多个变量，您可以通过`compact`函数或使用关联行设置它们。

```
 $posts = $this->Post->find();
   $comments = $this->Post->Comment->find();

   $this->set(compact('posts', 'comments'));
   // or
   $this->set('posts' => $posts, 'comments' => $comments); 
```

# entity-framework - TPH 简单配置/鉴别器问题

> ID：10058254
> 
> 赞同：1
> 
> 时间：2012-04-07T20:48:21.193
> 
> 标签：entity-framework, ef-code-first

我首先尝试使用代码进行一点 EF - 我无法弄清楚我哪里出了问题，这只是我自己的例子。我只是没有想法，想确定我哪里出错了......

首先是代表位置的简单 POCO 类 - 位置可以是 RadioStation 或 Merchant。我没有添加额外的字段（稍后会出现），所以现在它只是一个 TPH，我可以尽可能简单地进行配置。

```
namespace EFDataClasses.Entities
{

  public class RadioStation : Location
  {
    public RadioStation()
    {
    }

  }

  public class Merchant : Location
  {
    public Merchant()
     {
     } 
   }

  public class Location
  {
   public Location()
   {

   }

public int Loc_ID { get; set; }
public string Loc_Code { get; set; }
public string Loc_Name { get; set; }
public string  Loc_Type {get;set;}

 }
} 
```

然后是配置类：

```
namespace EFDataClasses.Mapping
{

  public class LocationMap : EntityTypeConfiguration<Location>
  {
    public LocationMap()
    {
      // Primary Key
      this.HasKey(t => t.Loc_ID);

      // Properties
      this.Property(t => t.Loc_ID)
          .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);

      // Properties
      this.Property(t => t.Loc_Code)
          .IsRequired()
          .HasMaxLength(50);

      this.Property(t => t.Loc_Name)
          .IsRequired()
          .HasMaxLength(50);

      this.Property(t => t.Loc_ID).HasColumnName("Loc_ID");
      this.Property(t => t.Loc_Code).HasColumnName("Loc_Code");
      this.Property(t => t.Loc_Name).HasColumnName("Loc_Name");

      //my discriminator property
      this.Property(t => t.Loc_Type).HasColumnName("Loc_Type").HasColumnType("varchar").HasMaxLength(50).IsRequired();

      // Table & Column Mappings
      this.Map(m =>
      {
        m.ToTable("Location");
        m.Requires("Loc_Type").HasValue("Location");
      }
        )
        .Map<RadioStation>(m =>
        {
          m.ToTable("Location");
          m.Requires("Loc_Type").HasValue("RadioStation");
        }
        )
        .Map<Merchant>(m =>
        {
          m.ToTable("Location");
          m.Requires("Loc_Type").HasValue("Merchant");
        }
        )
        ;

    }
  }
} 
```

这是上下文：

```
namespace EFDataClasses
{
  public class MyContext : DbContext
  {
    static MyContext()
    {
      Database.SetInitializer<MyContext>(new DropCreateDatabaseAlways<MyContext>());
    }

    public DbSet<EFDataClasses.Entities.Location> Locations {get; set;}

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
      modelBuilder.Configurations.Add(new LocationMap());
    }
  }
} 
```

最后是尝试添加广播电台的程序类..

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace EFConsole
{
  class Program
  {
    static void Main(string[] args)
    {

      var db = new EFDataClasses.MyContext();
      db.Locations.Add(new EFDataClasses.Entities.RadioStation() { Loc_Name = "Radio Station Name 1",  Loc_Code = "RD1" });
      int chngs = db.SaveChanges();
      System.Diagnostics.Debugger.Break();

    }
  }
} 
```

我得到的错误是 Loc_Type 上的验证错误，说它是必填字段。我在这里的印象是，当我选择适当的类型时，EF 会填写 - 我所有的阅读都支持这一点。

如果我确实添加了适当的位置类型 - EF 给我另一个错误....

啊！

最后，我想将 Location 抽象化，但这是否意味着我可以删除 hasvalue（“Location”）？

我想继续前进，但我很好奇我哪里做错了。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:12:37.517

我认为你有点过于复杂了，这在 CF 周围很危险。
在代码优先的情况下，您必须坚持“经过试验和测试”的有效模式，否则混合事物和构造会让您很快陷入困境。

首先，为什么你需要映射并拥有 Loc_Type，我的意思是在类模型中？那是多余的，你真的会用你的“类”类型得到它，你的类类型是鉴别器，反之亦然。

这就是我认为的错误所说的，无论是提供还是“从映射中删除列”或其他东西。

因此，只需将其从 中删除，`'Location'`它就可以正常工作。此外，除非您想让您的 Db 有意义并被其他方使用等，否则您大部分时间实际上并不需要指定鉴别器，但这没关系。

如果你愿意，你可以把它抽象化，位置——这通常是做的，我认为你可以从映射中删除它，只有“真正实现的”类应该被映射，因为只有那些可以被“实例化”。

最后，由于各种原因，TPH 不是最“幸运”的解决方案，也是我认为最容易出错的解决方案，TPT、TPC 都工作得更加“流畅”。你不能让你的“子类”“属性不为空，等等等等。有关于那个的帖子。

希望这可以帮助。

编辑：如果您想控制“隐藏”鉴别器`I think`，您可以尝试手动调整该`migration file`列的具体值，设置它的大小等。如果这很重要（我猜代码首先应该在那里选择正确的值）。如果你不改变任何对事物如何运作的意义重大的改变，那么它应该运作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T23:20:59.817

问题是，当您使用列作为 TPH 映射的鉴别器时，您不能同时将该列映射到类中的属性。这是因为 EF 现在根据 .NET 类的类型控制该列的值。因此，您应该删除将 Loc_Type 属性映射到 Location 列的这一行：

```
// Remove this line:
this.Property(t => t.Loc_Type).HasColumnName("Loc_Type").HasColumnType("varchar").HasMaxLength(50).IsRequired(); 
```

如果您需要（或想要）为鉴别器列指定明确的列类型、大小等，那么您可以在 Map 调用中执行此操作。例如：

```
Map(m =>
{
    m.ToTable("Location");
    m.Requires("Loc_Type")
        .HasValue("Location")
        .HasColumnType("varchar")
        .HasMaxLength(50)
        .IsRequired();
} 
```

您不需要在表示位置类型的类中有任何属性。如果您确实想获得一个等效于 Loc_Type 的字符串值，那么您可以在 Location 中使用类似这样的内容：

```
public virtual string Loc_Type
{
    get { return "Location"; }
} 
```

然后在其他类中覆盖它。例如：

```
public override string Loc_Type
{
    get { return "RadioStation"; }
} 
```

其余的代码看起来不错。

# php - 数组 数学 指数

> ID：10058256
> 
> 赞同：-1
> 
> 时间：2012-04-07T20:48:31.093
> 
> 标签：php, math, exponential

嗨，我需要像这样制作一个动态数组：

我的最大数量为 25000 和 62 作为指数（？）数。

```
Array
(
    [0] => 0  
    [1] => 3844     // 62 * 62
    [2] => 238328   // 62 * 62 * 62 <---
    [3] => 14776336 // 62 * 62 * 62 * 62
) 
```

这只是我需要的一个示例：计算数组值并找到适合最大数量的位置。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:01:39.430

```
$max =  floor(log(25000,62));
$array = array_map(function($value){return pow(62,$value);},range(0,$max); 
```

或者，在一个总函数中：

```
function getpowers($base, $maxvalue){
    $max = floor(log($maxvalue,$base));
    return array_map(function($value) use ( $base ) {return pow($base,$value);},range(0,$max));
}
var_dump(getpowers(62,25000)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:09:46.730

你的意思是这样的？

```
$max=25000;
$exp=62;
$result=0;
$i=1;
while ($result<$max)
  {
  $result=pow($exp,$i);
  $i++;
  }
echo $i;
echo '<br>';
echo $result; 
```

# objective-c - 将值插入表视图列

> ID：10058257
> 
> 赞同：0
> 
> 时间：2012-04-07T20:48:39.320
> 
> 标签：objective-c, xcode, macos, random, tableview

我有一个我正在编写的程序，它有一个包含两列的表格视图。其中一个用于客户名称，另一个用于在使用核心数据创建新客户时必须随机生成的 ID。

到目前为止，我已经能够生成一个随机数，但我不知道如何在创建新客户时插入 id 列。因为我正在使用来自 nsarraycontroller 的添加操作，所以我不能给按钮命令来执行它。这是我生成数字的代码：
int number = arc4random() %(100);
这是我的 .m 文件中的代码

导入 Foundation/Foundation.h
包括 stdlib.h

@interface tableViewData : NSObject{

```
IBOutlet NSTextField *randomeNumber;
IBOutlet NSTableColumn *customerId;
IBOutlet NSTableColumn *customerName; 
```

}
- (IBAction)numer:(id)sender;
- (IBAction)customerID:(id)sender;

任何帮助，将不胜感激

谢谢
G
ps 我正在使用 Xcode 4.2.1 并为 osx 编程

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:11:43.023

随机 ID 应该由代表客户的类生成，该类可能是`NSManagedObject`. 换句话说，客户应该自己初始化。你可以重写`-awakeFromInsert`来做到这一点。该方法的[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObject_Class/Reference/NSManagedObject.html#//apple_ref/doc/uid/TP30001171-BBCJFJFC)说“您通常使用此方法来初始化特殊的默认属性值。”

# ios - iOS 加载屏幕 - Default.png

> ID：10058259
> 
> 赞同：0
> 
> 时间：2012-04-07T20:48:49.543
> 
> 标签：ios

现在在 Xcode 中，我的资源和图像名为“Default.png”，它作为应用程序首次打开时的加载屏幕运行良好（awakeFromNib？）无论如何，这是一个有趣的加载屏幕，我想给用户至少需要 5 秒才能注视它，但是即使在我最慢的测试设备上，该应用程序也只需大约 2 秒即可加载，我怎样才能将其编码以持续更长时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T20:53:54.907

没有代码，你不能让这个加载屏幕更长。

您将需要开发一个视图控制器，您将在 5 秒内向用户显示，然后再显示您的应用程序的其余部分。

所以这应该是你在 AppDidFininshLaunching 方法中呈现给用户的第一个 UIViewController。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T01:49:05.403

睡眠（5）；在您的应用程序中代表应用程序didifinish

# version-control - 典型的最佳实践 ClearCase 项目结构

> ID：10058261
> 
> 赞同：3
> 
> 时间：2012-04-07T20:48:57.260
> 
> 标签：version-control, clearcase, clearcase-ucm, ibm-rational

在开发项目期间，交付的代码可以在到达生产之前在不同环境的不同阶段之间经过（例如，用于测试部署过程的开发环境、用于 QC 的内部测试、预生产和最终生产）。

这种开发工作产生了许多候选版本，其中可以指定某个版本在开发过程中向上移动，直到它到达生产环境，此外，在某些情况下，部署在生产环境中的代码可能需要与当前的内部开发线（即并行开发）。

对于 IBM Rational ClearCase (CC) 维护的某个 UCM 项目，建议在“项目资源管理器”上创建什么项目结构以适应以下内容：

1.  开发人员应主要在内部开发线（或 CC 术语中的开发流）上连接和交付他们的工作。
2.  一旦交付给此开发流的代码被认为是可接受的，技术团队负责人 (TTL) 就可以创建基线。该基线可以稍后由部署工程师检索以部署在本地开发环境中。
3.  如果发现此基线是可接受的，则可以将该基线作为一个整体交付给内部测试流，以部署用于进一步的质量控制 (QC) 测试。
4.  如果发现该基线是可接受的，则可以将该基线作为一个整体交付给预生产，以此类推，类似于上面描述的那样交付给生产。
5.  当然，如果这些基线中的任何一个没有被其接收方接受，它可以被拒绝，并且接收方将等待另一个基线被推荐用于他们的流。

**注意**：部署工程师将始终为每个环境使用专用流来获取执行构建/部署活动所需的文件。

我对这里的每个人表示歉意，因为我知道回答这个问题可能会很长，但我的问题更多地集中在需要在“项目资源管理器”中创建以满足上述目标的流和/或视图的确切类型。

我真的想提出使用 CC 进行发布管理的最佳实践方法，以及如何最好地使用它。

我将感谢您的帮助，并在此先感谢所有人...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:34:52.983

The rule of thumb is simple:
The less branch, the better.

I mean, if you ever done deliver and rebase before with ClearCase, you know:

*   how painful it is
*   how poorly it scales with the number of file (merging 1000 files is awfully long, merging 5000 files is murder)

So the real rule of thumb is:

**if you don't have to modify any file for a given development stage, don't create a branch**.

For instance, for promoting a code to QA, where you will only read it (and launch some tests, in order to accept that code if they pass, or to reject that code if they fail), **don't create a QA Stream where you would deliver the code**: it is too long for an non-existent added value.

Use **[baseline promotion level](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_proj.doc/t_chng_bl_prom_lvl.htm)** whenever you can, and [recommend your promoted baselines](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_proj.doc/c_ucm_ovvw_recommend_bl.htm).

![promoted baselines](../Images/82c6e63c318ddb34fcd78e3945d79c9a.png)

> The Deployment Engineer will always use a dedicated stream for each environment to get his/her files required to carry out the build/deployment activities.

Err... no, if you don't have any change to do.
The Deployment Engineer doesn't care at all where the baseline is coming from, only if the code deploys and runs successfully.

# php - 如何在没有庞大表格的情况下从电子商务数据创建统计数据？

> ID：10058269
> 
> 赞同：0
> 
> 时间：2012-04-07T20:49:56.303
> 
> 标签：php, mysql, database, database-design, statistics

假设我正在建立一个电子商务网站，我将如何记录每天销售的产品数量以供以后显示，我知道我可以将库存商品的数量存入数据库然后查看它是否有第二天减少，我认为这是不可避免的解决方案，但想象一下，一个店主想看看他去年卖了多少产品，记住他有 1000 种产品，这是否需要 1000 列和 365 行? 我是在想这个错误还是真的是这样？我知道您可以下载诸如 os-commerce 和 Magento 等具有此类功能的扩展程序，我想知道他们是否共享一种通用方法或提出其他方法？

所以基本上我正在寻找生成报告和统计数据，这通常是如何完成的，它是否需要巨大的表格来记录每个产品的每日变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T20:57:24.120

我的第一个倾向是将每笔交易视为一行，其中一列中出售的产品名称。为了满足您的其他要求，需要一个日期列来查询该项目是否在两个日期之间售出。

然后，您可以对该表进行任意数量的操作。

# visual-c++ - void'前面应该有';' 错误？

> ID：10058272
> 
> 赞同：0
> 
> 时间：2012-04-07T20:50:08.867
> 
> 标签：visual-c++

所以我正在使用 Visual Studio C++。我当前的程序是反向创建一个数组......但我得到“void”的错误应该以';'开头。帮助将不胜感激。

```
#include <iostream>

using namespace std;

int main()

//this function outputs the array in reverse
void reverse(double* a, int size)
{

for(int i = size-1; i >= 0; --i)//either i=size or i=size-1
{
cout << a[i] << ' ';
}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-07T20:50:52.253

您在 { 之后缺少一个开头`int main()`。

所以你的代码是

```
int main()
{
//this function outputs the array in reverse
void reverse(double* a, int size) 
```

但是，还有其他错误。一方面，您的 main 不返回值。你的程序应该有不同的结构。它应该是

```
#include <iostream>
using namespace std;

//this function outputs the array in reverse
void reverse(double* a, int size)
{
    for(int i = size-1; i >= 0; --i)//either i=size or i=size-1
    {
        cout << a[i] << ' ';
    }
}

int main()
{
    return 0;
} 
```

通过格式化代码很容易注意到其中一些错误。由于您使用的是 Visual Studio，因此执行此操作的默认设置是 Ctrl+K 和 Ctrl+D。

# c - 不能使用 MS Visual C++ 在 C 中包含 iostream？

> ID：10058273
> 
> 赞同：0
> 
> 时间：2012-04-07T20:50:09.613
> 
> 标签：c, struct, iostream, strcpy

我一直在尝试学习 C，但我一直坚持包含库。我需要使用 strcpy()，但该方法包含在 iostream 库中，但每当我尝试包含该库时，程序都会出错。我试过使用 "iostream", "iostream.h", , ，但它要么给我一个 "can't find iostream.h" 错误，要么程序超过 100 个错误并且只是崩溃。即使我的代码是空的，我仍然会得到同样的结果。这是代码：

```
#include "iostream"

int main(void)
{
} 
```

是的，就这么多已经让它崩溃了。这是我遇到的部分错误（永远无法将它们全部粘贴在这里）：

```
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(37): error C2061: syntax error : identifier 'abs'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(37): error C2059: syntax error : ';'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(39): error C2061: syntax error : identifier 'acos'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(39): error C2059: syntax error : ';'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(39): error C2061: syntax error : identifier 'asin'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(39): error C2059: syntax error : ';'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(40): error C2061: syntax error : identifier 'atan'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(40): error C2059: syntax error : ';'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(40): error C2061: syntax error : identifier 'atan2'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(40): error C2059: syntax error : ';'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(40): error C2061: syntax error : identifier 'ceil'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(40): error C2059: syntax error : ';'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(41): error C2061: syntax error : identifier 'cos'
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\cmath(41): fatal error C1003: error count exceeds 100; stopping compilation
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

所以是的，它甚至超过了 100 个错误，并且程序停止计数。我不明白为什么，我只是包括一个普通图书馆。有没有等价的 strcpy()？我主要想这样使用它（练习）：

```
#include "stdafx.h"
#include "stdlib.h"
#include "stdio.h"
#include "conio.h"
#include "iostream"

int main(void)
{
    struct person 
    { 
        int id; 
        char name[50];
        int age;
    }; 

    struct person p1;

    p1.id = 5595; 
    strcpy(p1.name, "Myname");
    p1.age = 18;

    printf("%d%s%d", p1.id, p1.name, p1.age);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T20:52:01.223

`<iostream>`是一个 C++ 标头（顾名思义，它处理输入/输出流）。如果你想`strcpy`，你需要`<string.h>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T20:54:08.897

如果您的源文件是“.c”，您所要做的就是将其重命名为“.cpp”。

然后它将编译为 C++，您将拥有 C++ 头文件，并且您将能够使用 C++ 流。

但是，我认为不需要 iostream。

strcpy 和朋友在“ `<string.h>`”中。只需包括它和“stdio.h”（就像你正在做的那样）；删除“iostreams”#include ...生活应该很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T20:51:56.523

`iostream`s 是仅限 C++ 的功能。s 头文件是用 C++ 编写的`iostream`，而不是 C。（是的，它们是不同的语言！）大概是在 C 模式下调用编译器，所以当编译器查看头文件时，它当然会抛出很多错误，因为中使用的许多结构`iostream`仅在 C++ 模式下才有意义。

如果您想使用`iostream`s，您必须在 C++ 模式下编译（并相应地以适当的现代 C++ 编写代码），使用仅 C 的不同库或通过根据需要实现自己的代码来解决它。

在这种情况下，您显然想要做的就是使用`strcpy()`. 那是在`string.h`, not中声明的`iostream`。（`string.h`是一个 C 头文件。）只要`#include <string.h>`它应该编译。

# python - 创建测试数据库时Django测试失败

> ID：10058277
> 
> 赞同：1
> 
> 时间：2012-04-07T20:50:50.940
> 
> 标签：python, django, postgresql, django-testing

它因许多与相关名称相关的问题而失败。当然，在运行实际的开发服务器（使用`./manage.py runserver`）时不会发生这种情况，我猜模型可能会生成两次？我正在运行 psycopg2 2.4.1，这是我的测试输出：

```
(venv)lacrymology@Roller:boilerplate$ ./manage.py test
Creating test database for alias 'default'...
Error: One or more models did not validate:
l10n.address: Accessor for field 'user_shipping' clashes with related field 'User.shipping_address'. Add a related_name argument to the definition for 'user_shipping'.
l10n.address: Reverse query name for field 'user_shipping' clashes with related field 'User.shipping_address'. Add a related_name argument to the definition for 'user_shipping'.
l10n.address: Accessor for field 'user_billing' clashes with related field 'User.billing_address'. Add a related_name argument to the definition for 'user_billing'.
l10n.address: Reverse query name for field 'user_billing' clashes with related field 'User.billing_address'. Add a related_name argument to the definition for 'user_billing'.
custom_registration.profile: Accessor for field 'user' clashes with related field 'User.profile'. Add a related_name argument to the definition for 'user'.
custom_registration.profile: Reverse query name for field 'user' clashes with related field 'User.profile'. Add a related_name argument to the definition for 'user'.
addressmodel.address: Accessor for field 'user_shipping' clashes with related field 'User.shipping_address'. Add a related_name argument to the definition for 'user_shipping'.
addressmodel.address: Reverse query name for field 'user_shipping' clashes with related field 'User.shipping_address'. Add a related_name argument to the definition for 'user_shipping'.
addressmodel.address: Accessor for field 'user_billing' clashes with related field 'User.billing_address'. Add a related_name argument to the definition for 'user_billing'.
addressmodel.address: Reverse query name for field 'user_billing' clashes with related field 'User.billing_address'. Add a related_name argument to the definition for 'user_billing'.
profiles.profile: Accessor for field 'user' clashes with related field 'User.profile'. Add a related_name argument to the definition for 'user'.
profiles.profile: Reverse query name for field 'user' clashes with related field 'User.profile'. Add a related_name argument to the definition for 'user'. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T10:26:04.010

您的 test.py 很可能会导入一个不在 INSTALLED_APP 内但有一些模型字段指向碰撞模型的应用程序。尝试在 test.py 中导入但不在 INSTALLED_APPS 中的应用程序中grep **user_shipping ，并替换它。**

`./manage.py validate`，将在内部调用`./manage.py runserver`，仅检查从 INSTALLED_APP 内的应用程序加载的模型，因此运行 devserver 时没有错误。但是，test.py 中的导入会导致加载额外模型的未安装应用程序（如果有），然后会发生冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T14:17:05.040

这是 django-shop 测试的问题，如评论中所述：[创建测试数据库时 Django 测试失败](https://stackoverflow.com/questions/10058277/django-test-fails-when-creating-test-database#comment12902711_10062087)

如果不更改应用程序的代码，我找不到解决办法，所以我最终只是测试了我自己的应用程序（运行`./manage.py test myapp`而不是`./manage.py test`

# c - 在函数中使用指针指针的正确方法是什么？

> ID：10058287
> 
> 赞同：1
> 
> 时间：2012-04-07T20:52:38.547
> 
> 标签：c

我使用一个函数来显示由指针指向的内存块内容。但是没有得到想要的输出，我是新手，如果我错了，请纠正我。当我输入 size =3, element = 1,2,3 时，我只得到 output = 1 。

这是代码：

```
#include <stdio.h>
#include <stdlib.h>

void merge(int **arr1);

int main(void) {
    int size1;
    printf("Give me the size of first array\n");
    scanf("%d", &size1);

    int *arr1 = malloc(size1*sizeof(int));
    int *p1=arr1;
    printf("Give me the elements of first array\n");
    int index1;
    for(index1 = 0 ; index1<size1; index1++)
    scanf("%d", p1++);

    merge(&arr1);
    return;
}

void merge(int **arr1) {
    while(**arr1)  //**arr1 is the content of the passed array, if there 
                  // is an int in it, print that out and increment to next one
    {
        printf("%d", **arr1); // ** is the content and * is the address i think, right?
        *arr1++;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:02:21.600

您的`merge()`代码期望数组以零结尾。调用代码没有这样做，所以行为是未指定的（我在尝试你的代码时遇到了段错误）。

另一个问题是你应该把括号括起来`*arr1`：

```
(*arr1)++; 
```

当我使用此修改运行您的代码并为最后一个元素输入零时，您的代码运行良好。

# linux - 如何更改 Linux 中的默认处理器关联？

> ID：10058290
> 
> 赞同：1
> 
> 时间：2012-04-07T20:52:48.600
> 
> 标签：linux, affinity

我想在运行 Linux 的多核系统上运行许多基准测试。我想为我的基准测试保留一个核心。我知道我可以`sched_setaffinity`用来将我的基准测试限制在该核心。我怎样才能让所有其他流程*远离*我的核心？换句话说，如何将所有进程的默认亲和性设置为不包括我的核心？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T23:22:17.453

即使您将所有其他进程从“保留用于基准测试”内核中移除，请记住，您无法阻止它们将有限内存带宽的可变且不可预测的比例消耗到多核芯片上，并且您可以不要阻止他们对共享的 L2 和 L3 缓存提出不同的要求。

恕我直言，可重复的、科学的基准测试需要一台机器本身。

# django - 在 django 中填充多表继承模型

> ID：10058291
> 
> 赞同：0
> 
> 时间：2012-04-07T20:53:10.553
> 
> 标签：django, django-models, django-users, django-profiles

我以以下方式使用模型：

```
class UserProfile:
# Some Stuff

class CompanyProfile(UserProfile):
# Some more stuff

class CandidateProfile(UserProfile):
# Even more stuff 
```

意味着 CompanyProfile 和 CandidateProfile 继承自 UserProfile 。我将如何从注册表和另一个配置文件中填充这些 CompanyProfile 和 CandidateProfile？我将如何告诉它我正在创建用户或输入数据的配置文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T12:11:45.487

我在stackoverflow.com上的另一个线程中按照以下方式进行了操作：[django user profile creation，set user profile while using multiple profile types](https://stackoverflow.com/questions/10374071/django-profile-creation-set-user-profile-while-using-multiple-profile-types)，代码如下：

```
def save(self, commit=True):
user = super(UserRegistrationForm, self).save(commit=False)
user.email = self.cleaned_data["email"]
if commit:
    user.save()
    person = Person(user=user)
    person.full_name = self.cleaned_data["fullname"]
    person.save()
return user 
```

# javascript - JQuery 模板不适用于数组

> ID：10058295
> 
> 赞同：0
> 
> 时间：2012-04-07T20:53:56.960
> 
> 标签：javascript, jquery, jquery-templates

我只是在学习 Jquery 模板并逐步尝试不同的事情。现在我用单条目数据元素尝试了它，它工作正常。据我了解，如果我用数据数组替换数据，那么它将显示所有元素而不使用 {each} 标记。但在这种情况下，它只是出错了。在jQuery中。说`k.nodes is undefined`。

这是一个小代码片段：

```
// my binding
$(document).ready(function () {
  $.tmpl("<div class = 'Test'>${Name}<div>", movies)
    .appendTo('#EmployeeContainer');
  $('#Template')
    .tmpl(movies)
    .appendTo('#EmployeeContainer');
});

// my data
var movies = [
  { Name: "The Red Violin", ReleaseYear: "1998" },
  { Name: "Eyes Wide Shut", ReleaseYear: "1999" },
  { Name: "The Inheritance", ReleaseYear: "1976" }
];

// part of my template from where Release year is coming
<script id = "Template" type ="text/templating">
  <div class = 'Test'>${ReleaseYear}<div>
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:06:05.437

看起来您可能忘记了编译模板。

看看[jquery.com](http://api.jquery.com/jquery.tmpl/)上的第一个示例。

具体来说，你需要调用：`$.template(...);`来编译模板。

您已经获得了`$.tmpl(...);`呈现模板的部分。但是，您需要在渲染之前对其进行编译。

**更新：**主要错误是您缺少模板中的结束 div。你有一个更新的[工作 jsfiddle](http://jsfiddle.net/7PcFC/4/)`<div>`而不是这里。另外，记住这是一个插件，所以你需要[下载](https://raw.github.com/jquery/jquery-tmpl/master/jquery.tmpl.js)[插件](https://github.com/jquery/jquery-tmpl)。`</div>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-30T15:19:57.347

我知道这是一个旧线程，但我最近遇到了同样的问题。如上所述，我尝试了 jsfiddle.net/7PcFC/8/，并在这些浏览器中得到以下结果：

火狐 29：工作

铬 34.0.1847.131 m：不工作

IE 9.0.8112.16421：不工作

对于 Chrome 和 IE，它只显示“Hello”

# java - JNLP：如何指定安装目录和要下载的数据？

> ID：10058298
> 
> 赞同：1
> 
> 时间：2012-04-07T20:54:23.330
> 
> 标签：java, jnlp, webdeploy

我想知道是否可以让用户为 JNLP 文件提供的应用程序指定安装目录？例如：安装目录：C:\Program Files\MyCompany\My Program\

是否也可以提到要与 INSTALLDIR/data 中的 jnlp 应用程序 jar 一起下载的数据文件夹？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:43:08.633

> 我想知道是否可以让用户为 JNLP 文件提供的应用程序指定安装目录？

用户或其系统管理员可以使用 Java 控制面板配置缓存的位置。

> 是否也可以提到要与 INSTALLDIR/data 中的 jnlp 应用程序 jar 一起下载的数据文件夹？

没有现有功能，但如果您可以编写 Java 代码来实现该功能，请将其添加到 JNLP 安装程序扩展中，该代码将在应用程序时调用。是第一次运行。这是一个演示。使用[扩展安装程序服务](http://pscode.org/jws/api.html#eis)。

> 关于安装目录，我担心更改缓存路径会更改所有其他 JNLP 应用程序，不是吗？

你的恐惧是有根据的，但你似乎忽略了一个微妙的暗示。不仅如此，即使可以在您的应用程序中找到该目录。（小程序或 JWS 应用程序无法发现该信息），用户（或其系统管理员）可能随时更改它。

到目前为止，我一直希望你能从我的信息中推断出这一点。 ***如果你的应用程序。依赖知道安装目录，严重坏了。先解决这个问题。***

# html - IE中的重叠选择选项

> ID：10058304
> 
> 赞同：0
> 
> 时间：2012-04-07T20:55:04.037
> 
> 标签：html, css

我有一个多项选择，我在 IE 中遇到以下问题。

这些选项似乎重叠并且在 IE 中显得混乱。当我单击一个选项时，它会正常呈现。FF、Safari 等显示它很好。有关如何解决此问题的任何想法？

![IE中的混乱选择选项](../Images/147cdb568a8d90eeff826b2a5a7e71f5.png)

这是 HTML 的示例：

```
<select multiple id="C" name="playArray[]" class="tabStyle" onChange='add_player(this, "1");' size="10">
<option value="593266">Anderson, Bryan</option>
<option value="1522585">Arencibia, J.P.</option>
</select> 
```

.tabStyle 只是设置选择的宽度。

提前致谢！

# jquery - PhoneGap Ajax 请求返回 null

> ID：10058305
> 
> 赞同：2
> 
> 时间：2012-04-07T20:55:31.877
> 
> 标签：jquery, android, ajax, cordova

我正在使用[PhoneGap](http://en.wikipedia.org/wiki/PhoneGap)和[API的](http://en.wikipedia.org/wiki/Application_programming_interface)[CodeIgniter](http://en.wikipedia.org/wiki/Codeigniter#CodeIgniter)构建Android 应用程序。我正在尝试向 API 发出 Ajax 请求以对用户进行身份验证。Ajax 请求成功，但没有返回 JSON 数据。如果我在浏览器中尝试相同的 API [URL](http://en.wikipedia.org/wiki/Uniform_Resource_Locator)，我会正确地得到响应。

```
$.ajax({
    url:auth_url,
    data:params,
    dataType:'jsonp',
    type:'get',
    success:function(data) {
        response = jQuery.parseJSON(data);
        alert(response);
    },
    error: function(jqXHR, textStatus,errorThrown) {
        alert("Error status: " + textStatus);
        alert("Error type: " + errorThrown);
        alert("Error message: " + jqXHR.responeJSON);
    }
}); 
```

成功函数将响应提示为空。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T00:09:54.007

确保 auth_url 是 IP 地址而不是 localhost。

# php - 通过 PDO 或 Zend_Db_Adapter_Abstract 设置隔离级别？

> ID：10058307
> 
> 赞同：1
> 
> 时间：2012-04-07T20:56:02.263
> 
> 标签：php, pdo, zend-db

有没有办法为php中的具体数据库驱动程序独立设置隔离级别？好像没有。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T05:02:13.290

不幸的是，我不确定是否有办法用 Zend_Db 做这样的事情。手册说`setTransactionIsolationLevel()`只能与[Microsoft SQL Server 适配器](http://framework.zend.com/manual/en/zend.db.adapter.html#zend.db.adapter.adapter-notes.sqlsrv)一起使用。

> 您可以使用 setTransactionIsolationLevel() 设置当前连接的隔离级别。该值可以是 SQLSRV_TXN_READ_UNCOMMITTED、SQLSRV_TXN_READ_COMMITTED、SQLSRV_TXN_REPEATABLE_READ、SQLSRV_TXN_SNAPSHOT 或 SQLSRV_TXN_SERIALIZABLE。

Zend_Db API 似乎没有实现管理事务隔离级别的方法，唯一的方法是编写您自己的 SQL 语句并根据您使用的 PDO 驱动程序执行它们。

我建议您改用更好的数据库抽象层，例如[Doctrine](http://docs.doctrine-project.org/)（非常强大）。然后你就可以这样做：

> `Doctrine\DBAL\Connection`还具有控制底层数据库支持的事务隔离级别的方法 。**`Connection#setTransactionIsolation($level)`**并且 **`Connection#getTransactionIsolation()`**可以用于该目的。可能的隔离级别由以下常量表示：

```
<?php
Connection::TRANSACTION_READ_UNCOMMITTED
Connection::TRANSACTION_READ_COMMITTED
Connection::TRANSACTION_REPEATABLE_READ
Connection::TRANSACTION_SERIALIZABLE 
```

请参阅[此问题](https://stackoverflow.com/questions/5001488/zend-framework-1-11-with-doctrine-2-integration)以了解如何将 Doctrine 与 ZF 集成，以及[此页面](http://docs.doctrine-project.org/projects/doctrine-dbal/en/latest/reference/transactions.html#transactions)以获取有关使用 Doctrine 进行事务管理的更多信息。

# javascript - 鼠标靠近时排斥物体

> ID：10058308
> 
> 赞同：3
> 
> 时间：2012-04-07T20:56:11.983
> 
> 标签：javascript, jquery

我有一堆随机位置的跨度元素包含在一个名为'.background'的父div中。这些是用 Javascript 生成的。像这样：

```
<span class="circle" style="width: 54px; height: 54px; background: #5061cf; top: 206px; left: 306px"></span> 
```

我希望它们在鼠标靠近时移开（或排斥），但我不知道该怎么做！我将如何在 jQuery 中实现这一点？

我想您必须搜索附近的跨度，然后如果它们在鼠标周围的某个半径内则更改它们的位置，但我真的不知道从哪里开始。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-07T21:04:18.253

一种简单的方法是将每个跨度包装在另一个更大的跨度中。通过您希望鼠标能够接近内部跨度的最小距离，使其在每一侧都变大。绑定一个函数（`evade`），将每个包装器移动到[`mouseover`](http://api.jquery.com/mouseover/)包装器上。这种方法为您提供了一个方形边框，因此如果内部跨度中的图形元素不是方形的，则从鼠标到图形元素边框的距离不会是恒定的，但很容易实现。

或者，使用保险杠进行粗略的接近测试。不是将 evade 函数绑定到，而是绑定一个在 mousemove 上`mouseover`绑定的函数 ( `beginEvade`) 。`evade`此外，将一个函数绑定到`mouseout`unbinds `evade`。然后，您`evade`可以执行更精确的接近测试。

首先，找到一个提供向量类型的好几何库。如果没有，这里是一个示例实现：

```
Math.Vector = function (x,y) {
    this.x = x;
    this.y = y;
}
Math.Vector.prototype = {
    clone: function () {
        return new Math.Vector(this.x, this.y);
    },
    negate: function () {
        this.x = -this.x;
        this.y = -this.y;
        return this;
    },
    neg: function () {
        return this.clone().negate();
    },
    addeq: function (v) {
        this.x += v.x;
        this.y += v.y;
        return this;
    },
    subeq: function (v) {
        return this.addeq(v.neg());
    },
    add: function (v) {
        return this.clone().addeq(v);
    },
    sub: function (v) {
        return this.clone().subeq(v);
    },
    multeq: function (c) {
        this.x *= c;
        this.y *= c;
        return this;
    },
    diveq: function (c) {
        this.x /= c;
        this.y /= c;
        return this;
    },
    mult: function (c) {
        return this.clone().multeq(c);
    },
    div: function (c) {
        return this.clone().diveq(c);
    },

    dot: function (v) {
        return this.x * v.x + this.y * v.y;
    },
    length: function () {
        return Math.sqrt(this.dot(this));
    },
    normal: function () {
        return this.clone().diveq(this.length());
    }
}; 
```

接下来，一个示例循环规避函数（这是最简单的实现）。大纲：

1.  计算保险杠的中心（保险杠的[角](http://api.jquery.com/offset/)加上[外部尺寸](http://api.jquery.com/outerWidth/)除以一半）
2.  计算鼠标偏移向量（从[鼠标光标](http://api.jquery.com/event.pageX/)到元素中心）
3.  接近测试：如果距离 >= 最小允许距离，则提前返回。
4.  计算增量：到鼠标光标的距离太小，所以我们需要从保险杠所在位置到它应该在的位置的向量（增量）。加长偏移矢量使其成为允许的最小距离，从而给出保险杠中心相对于鼠标位置的位置。从中减去偏移向量可以得到从接近边缘到鼠标的增量，这也恰好是增量。
5.  计算新位置：
    1.  将增量添加到当前位置。
    2.  边界检查：将圆的所有边界保留在文档内。
6.  移动保险杠

在代码中：

```
function evade(evt) {
    var $this = $(this),
        corner = $this.offset(),
        center = {x: corner.left + $this.outerWidth() / 2, y: corner.top + $this.outerHeight() / 2},
        dist = new Math.Vector(center.x - evt.pageX, center.y - evt.pageY),
        closest = $this.outerWidth() / 2;

    // proximity test
    if (dist.length() >= closest) {
        return;
    }

    // calculate new position
    var delta = dist.normal().multeq(closest).sub(dist),
        newCorner = {left: corner.left + delta.x, top: corner.top + delta.y};

    // bounds check
    var padding = parseInt($this.css('padding-left'));
    if (newCorner.left < -padding) {
        newCorner.left = -padding;
    } else if (newCorner.left + $this.outerWidth() - padding > $(document).width()) {
        newCorner.left = $(document).width() - $this.outerWidth() + padding;
    }
    if (newCorner.top < -padding) {
        newCorner.top = -padding;
    } else if (newCorner.top + $this.outerHeight() - padding > $(document).height()) {
        newCorner.top = $(document).height() - $this.outerHeight() + padding;
    }

    // move bumper
    $this.offset(newCorner);
} 
```

之后，剩下的就是绑定/取消绑定的函数`evade`，以及设置所有内容的调用。

```
function beginEvade() {
    $(this).bind('mousemove', evade);
}

function endEvade() {
   $(this).unbind('mousemove', evade);
}

$(function () {
    // you can also wrap the elements when creating them.
    $('.circle').wrap('<span class="bumper" />')

    $('.bumper').bind('mouseover', beginEvade);
    $('.bumper').bind('mouseout', endEvade);
}); 
```

您可以在[jsFiddle中预览它](http://jsfiddle.net/outis/bA8YE/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:07:08.470

您使用 jQuery 选择所有具有类 circle 的对象，将其放入一个变量中，然后通过循环检查 mousemove （也可以使用 jQuery 完成），如果一个对象在鼠标的某个半径范围内。

# php - PHPEclipse & XDebug 脚本调试

> ID：10058309
> 
> 赞同：1
> 
> 时间：2012-04-07T20:56:13.343
> 
> 标签：php, eclipse, debugging, xdebug, phpeclipse

我正在尝试在 PHPEclipse 中进行 XDebug 调试。

我在网上找到的所有资源都集中在使用带有远程调试的 Web 服务器。我正在尝试实现脚本级调试，因此不涉及 Web 服务器。

我有一个使用“PHP XDebug Script”类型的调试配置设置，当我在 Eclipse 中运行调试选项时，PHP 正在执行脚本并将输出发送到脚本生成的控制台。

然而，问题是调试器没有在我添加到 Eclipse 文件中的任何断点处停止。他们正在被跳过。如何使断点工作？

安装的 PHP 和 XDebug 版本：

PHP 5.3.10 (cli) (built: Feb 2 2012 22:12:16) Copyright (c) 1997-2012 The PHP Group Zend Engine v2.3.0, Copyright (c) 1998-2012 Zend Technologies with Xdebug v2.1.4,版权所有 (c) 2002-2012，作者 Derick Rethans

我没有在 PHP 中为 XDebug 添加任何额外的配置选项。虽然我尝试添加远程调试选项以查看是否可以解决问题，但我认为此时所有远程调试选项都与进行本地化脚本调试无关，因此再次将其删除（无论如何它并没有解决问题）。

我正在使用 Eclipse 版本 3.7.1 R3_7_1。在 Fedora 16、64 位上。

# .net - 从 DataTable 到另一个且仍然是目标 DataTable 的 ImportRow 是空的 VB.NET

> ID：10058314
> 
> 赞同：1
> 
> 时间：2012-04-07T20:56:55.183
> 
> 标签：.net, vb.net, datatable

嗨，我正在尝试将一行从 DataTable 复制到另一行，我几乎到处查看，但找不到发生这种情况的原因，我正在使用 ImportRow，但 New DataTable 仍然为空。

这是我找到的类似答案之一，但仍然无法正常工作！：

```
 Dim newTable As New DataTable
        Dim dsFrom As New DataTable

        For Each DBShoes In list
            Dim iShoeID As Integer
            iShoeID = DBShoes.sShoes_ID
            dsFrom = DBShoes.GetFullShoeDetails(iShoeID)
            For Each dr As DataRow In dsFrom.Rows
                newTable.Rows.Add(dr.ItemArray)
            Next
        Next
        GridView1.DataSource = newTable
        GridView1.DataBind() 
```

错误：输入数组长于此表中的列数。

这是不会崩溃但在 DataTable 中没有添加任何内容的导入： Dim newTable As New DataTable Dim dsFrom As New DataTable

```
 For Each DBShoes In list
            Dim iShoeID As Integer
            iShoeID = DBShoes.sShoes_ID
            dsFrom = DBShoes.GetFullShoeDetails(iShoeID)
            For Each dr As DataRow In dsFrom.Rows
                newTable.ImportRow(dr)
            Next
        Next
        GridView1.DataSource = newTable
        GridView1.DataBind()

    Else 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T21:11:22.610

我创建了一个带有两个 DataGridView 控件的表单。这是表单的代码：

```
Public Class Form1

Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    ' create table with single column
    Dim dt1 As New DataTable
    dt1.Columns.Add("Number", GetType(Integer))

    ' create another table with single column
    Dim dt2 As New DataTable
    dt2.Columns.Add("Number", GetType(Integer))

    ' fill first table with single row
    Dim r As DataRow = dt1.NewRow()
    r.Item(0) = 1
    dt1.Rows.Add(r)

    ' import all rows of first table into second table
    For Each row In dt1.Rows
        dt2.ImportRow(row)
    Next

    ' show tables
    DataGridView1.DataSource = dt1
    DataGridView2.DataSource = dt2
End Sub
End Class 
```

# ios - Mac OS X 代码签名是否像 iOS 上的代码签名一样工作？

> ID：10058316
> 
> 赞同：1
> 
> 时间：2012-04-07T20:57:19.330
> 
> 标签：ios, macos, code-signing

如果我使用我的自签名证书对我的 Mac OS X 应用程序进行签名，我仍然可以在签名后修改二进制文件，并且操作系统不会抱怨任何事情，并且该应用程序可以正常工作。如果我修改 iOS 二进制文件，那么该应用程序将不会加载到设备上。

如果它实际上打算在 OS X 上像这样工作，是否有任何方法可以像 iOS 风格的代码签名检查一样安全可靠地确保完整性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T00:10:21.647

在 Mac OS X 上，只有当应用程序被操作系统标记为隔离时，代码签名检查才会启动，即如果应用程序是使用 safari 从 Internet 下载的，或者可能是邮件应用程序。

最好的测试方法是使用 xattr 设置隔离属性，例如 xattr -w com.apple.quarantine "0001;4fce45e4;Safari;E17715E0-DB01-4EA3-A102-FBE7C2C8587A|com.apple.Safari"

希望这可以帮助。

# javascript - 我可以用纯 CSS2 做这个“动作”吗？

> ID：10058322
> 
> 赞同：1
> 
> 时间：2012-04-07T20:58:03.297
> 
> 标签：javascript, css

我有[这个](http://jsfiddle.net/AcHPu/)代码：

```
<ul class="main">
    <li>
        <a href="#">Link 1</a>                
    </li>                    

    <li>
        <a href="#">Link 2</a>
        <ul class="second">            
            <li>Hello</li>
        </ul>                        
    </li>                                
</ul>​

.second
{
    display:none;
}​ 
```

而且我想，当我将鼠标悬停在第一级 li 内设置为 ul的链接 ( `a:hover`)上时。比，当我用鼠标离开链接时，将其恢复为无。`display:block``second`

是否可以使用 CSS 或仅使用 javascript？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:01:45.977

当然，这是可能的

```
ul.second { display: none; }
a:hover + ul.second { display: block; } 
```

它甚至可以在大多数现代浏览器中使用。

不过，不确定`+`选择器是否属于`CSS2`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:02:40.437

从技术上讲是的，只需使用 a:link、a:visited、a:hover 和 a:active 伪类。

我在这里进行了疯狂的猜测，但我认为您可能指的是列表样式属性以显示枚举“图标”（或隐藏它们）。

# css - 有没有办法自定义谷歌浏览器的开发者控制台？

> ID：10058324
> 
> 赞同：1
> 
> 时间：2012-04-07T20:58:08.060
> 
> 标签：css, google-chrome

我一直需要清理 css 文件并去除未使用的 css 元素。我知道 google chrome 能够在页面上显示所有未使用的 css 元素，但有时（例如我现在正在处理的项目）原始设计师在此文件中留下了数百个未使用的元素。

所以，我的问题是——有谁知道自定义谷歌浏览器开发者控制台以导出所有使用的 CSS 元素列表的方法。或者，是否有人知道提供此功能的现有 google chrome 插件？

我意识到有一个提供这些功能的 Firefox 插件，但我很想为 google chrome 找到类似的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:46:45.160

您可以通过两种方式自定义 Google Chrome Web Inspector：

1.  Web 检查器选项 ![在此处输入图像描述](../Images/7e35172634641d3fb2fde126652b9778.png)
2.  Chrome 扩展程序
    *   [http://code.google.com/chrome/extensions/experimental.devtools.console.html](http://code.google.com/chrome/extensions/experimental.devtools.console.html)
    *   [http://code.google.com/chrome/extensions/experimental.devtools.audits.html](http://code.google.com/chrome/extensions/experimental.devtools.audits.html)

您可以创建一个扩展来满足您的需要。

# java - 使用 Xpath 检索 Soap 消息节点值

> ID：10058325
> 
> 赞同：0
> 
> 时间：2012-04-07T20:58:11.237
> 
> 标签：java, jakarta-ee

如何使用 xpath 从下面的肥皂消息中检索以下节点的值：Serverid & id。我希望根据节点名称进行搜索，然后获取节点值。

```
<soapenv:Envelope xmlns:dest="http://www.testsrv.com" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <soapenv:Header>
        <dest:Security>
            <dest:ticket secuid ="21020303"/>
        </dest:Security>
    </soapenv:Header>
    <soapenv:Body>
        <TransReq>
            <Sender>
                <ServerOne>testserver</ServerOne>
                **<Serverid>led189</Serverid>**
            </Sender>
            <Form>
                **<id>2EB</id>**
                <token>8EB9</token>
            </Form>
        </TransReq>
    </soapenv:Body>
</soapenv:Envelope> 
```

沿着这行代码......

```
SOAPBody requestBody = message.getSOAPBody();
XPath xpath = XPathFactory.newInstance().newXPath(); 
Node resultNode = (Node) xpath.evaluate("/Serverid", message.getSOAPBody(),XPathConstants.NODE); // doesnt look right but just an idea of what i am trying to do ... 
```

提前致谢

# objective-c - 当用户触摸第一个（动态）表视图（在 Objective-C 中）中的单元格时，如何生成第二个表视图？

> ID：10058327
> 
> 赞同：0
> 
> 时间：2012-04-07T20:58:37.703
> 
> 标签：objective-c, uitableview, tableview

我有一个表格视图，其中包含在 TableViewController 类中生成的动态单元格。我对另一个表视图（继承自 TableViewController2）进行了转义。当用户从第一个表视图中选择一个单元格时，我想触发新表视图的显示。我在 TableViewController 中实现了 prepareForSegue。segue 工作，我可以看到第一个表格视图弹出屏幕并且新表格视图弹出，但无论我做什么都是空的。如何触发 TableViewController2 中单元格的显示？

在 TableViewController 中：

```
-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    NSIndexPath *indexPath = [self.tableView indexPathForCell:sender];

    if ([(segue.identifier) isEqualToString:@"topSegue"]){

        TableViewController2 *navigationController = segue.destinationViewController;
        TableViewController2 *tvc = segue.destinationViewController;
    }
} 
```

在 TableViewController2 中：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Top 50 list";
    cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }
        cell.textLabel.text = @"test";

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T12:04:00.607

您是否在第二个 tvc 中定义了以下两种方法？

*   (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section

和

*   (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView

# objective-c - 搜索 NSDictionaries 的 NSArray 以验证信息

> ID：10058328
> 
> 赞同：0
> 
> 时间：2012-04-07T20:58:43.560
> 
> 标签：objective-c, nspredicate

我有一个`NSArray`完整的`NSDictionary`对象。该结构是从数据库构建的。我正在构建一个仅在调试时包含和执行的验证功能。这个想法是确保所有需要的文件实际上都包括在内，并且不包括任何额外的文件。

基于[这个](https://stackoverflow.com/questions/8340694/search-nsarray-of-nsdictionaries)问题，我尝试使用 a`NSPredicate`但它将 thr 目录中的每个文件标记为“文件不在数据库中”。

我究竟做错了什么？

`KEY_DFILE`#定义为`@"dFilename"`.

```
#ifdef DEBUG
- (void)checkItems
{
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSLog(@"-------- Database / File Check --------");
    for (NSDictionary* item in self.allItmes)
    {
        // ansi items
        if ([[item objectForKey:KEY_TYPE] isEqualToString:@"ansi"])
        {
            // Make sure the datafile exists
            NSString* path = [[NSBundle mainBundle] pathForResource:[item objectForKey: KEY_DFILE] ofType:nil inDirectory:@"ansi"];
            if (![fileManager fileExistsAtPath:path])
                NSLog(@"Can't find file: %@", path);
        }
    }

    NSString *dir = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"ansi"];
    NSDirectoryEnumerator* en = [fileManager enumeratorAtPath:dir];
    NSString* file;
    while (file = [en nextObject])
    {
        NSPredicate *p = [NSPredicate predicateWithFormat:@"%@ == %@", KEY_DFILE, file];
        NSArray *matchedDicts = [self.allItmes filteredArrayUsingPredicate:p];
        if ([matchedDicts count] == 0)
        {
            NSLog(@"File not in Database: %@", file);
        }
        else if ([matchedDicts count] > 1)
        {
            NSLog(@"File in Database more than once: %@", file);
        }
    }
    NSLog(@"---------------------------------------");
}
#endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:35:21.687

I think you want your predicate format to be "%K == %@".

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:37:26.570

更改此行：

```
NSPredicate *p = [NSPredicate predicateWithFormat:@"%@ == %@", KEY_DFILE, file]; 
```

对此：

```
NSPredicate *p = [NSPredicate predicateWithFormat:@"%K == %@", KEY_DFILE, file]; 
```

%K 表示参数是动态属性名称而不是字符串（因此它不引用它）。

# ruby - 在 ruby 中拆分文本文件

> ID：10058330
> 
> 赞同：2
> 
> 时间：2012-04-07T20:58:46.500
> 
> 标签：ruby

我有一个包含几个不同部分的文本文件。每个部分都有一个标题，后面是实际数据。例如：

```
Header1
x,y,z
x,y,z
x,y,z
Header2
a,b,c
a,b,c
a,b,c 
```

我想一次性通读文件，并对每个部分下的数据做不同的事情。我知道如何解析数据，但我无法弄清楚如何为“在点击 Header2 之前执行此操作，然后在 Header3 之前执行其他操作等”的逻辑进行编码。

我正在使用红宝石，我还没有真正遇到过这样做的任何例子。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:17:18.760

在最简单的情况下，您可以执行以下操作：

```
# Process lines for header1
def do_header1(line)
  puts line.split(/,/).join("|")
end

# Process lines for header2
def do_header2(line)
  puts line.split(/,/).map{ |e| e.upcase}.join(",")
end

header1 = false
header2 = false

# Main loop
File.open("file.txt").each_line do |line|
  if line.chomp == 'Header1' # or whatever match for header1
    header1 = true
    header2 = false
    next
  end
  if line.chomp == 'Header2' # or whatever match for header2
    header1 = false
    header2 = true
    next
  end

  do_header1(line) && next if header1
  do_header2(line) && next if header2

end 
```

如果标头数量过多，您可以使用整数开始跟踪标头：

```
header = -1

# Main loop
File.open("file.txt").each_line do |line|
  if line.chomp == 'Header1' # or whatever match for header1
    header = 1
    next
  end
  if line.chomp == 'Header2' # or whatever match for header2
    header = 2
    next
  end

  do_header1(line) && next if header == 1
  do_header2(line) && next if header == 2

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:35:05.917

使用对象的解决方案。对于每一行，您询问每个解析器是否已经开始了解析器可以解析的新部分。

```
class Section1Parser
  def section? potential_header
    potential_header.chomp == 'Header1'
  end
  def parse line
    puts "Section 1: #{line.split(/,/).join("|")}"
  end
end

class Section2Parser
  def section? potential_header
    potential_header.chomp == 'Header2'
  end
  def parse line
    puts "Section 2: #{line.split(/,/).join("|")}"
  end
end

parsers = [Section1Parser.new, Section2Parser.new]
selected_parser = nil

File.open("c:\\temp\\file.txt").each_line do |line|
  if new_parser_detected = parsers.detect {|p| p.section? line }
    selected_parser = new_parser_detected 
    next # skip header
  end
  selected_parser.parse line if selected_parser
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T21:11:06.190

像这样的东西会起作用吗？

```
File.open('datafile').each_line do |s|
  if s =~ /^headerpattern$/
    #Start a new parsing block
    ...
  else
    #Parse data
    ...
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T10:15:49.563

在我的情况下，“标题”采用以下字符串的形式`OBJECT ObjectType ObjectNumber ObjectName`

```
if File.exist?("all.txt") then  
    object_file = File

    File.open("all.txt").each_line do |line|
        file_name = case 
            when line.match('^OBJECT Table.*')
                "TAB" + line.split[2] + ".TXT"
            when line.match('^OBJECT Form.*')
                "FOR" + line.split[2] + ".TXT"
            when line.match('^OBJECT Report.*')
                "REP" + line.split[2] + ".TXT"
            when line.match('^OBJECT Dataport.*')
                "DAT" + line.split[2] + ".TXT"
            when line.match('^OBJECT XMLPort.*')
                "XML" + line.split[2] + ".TXT"
            when line.match('^OBJECT Codeunit.*')
                "COD" + line.split[2] + ".TXT"
            when line.match("^OBJECT MenuSuite.*")
                "MEN" + line.split[2] + ".TXT"
            when line.match('^OBJECT Page.*')
                "PAG" + line.split[2] + ".TXT"
            when line.match('^OBJECT Query.*')
                "QUE" + line.split[2] + ".TXT"
        end

        unless file_name.nil? 
            File.exist?(file_name) { File.delete(file_name) }
            object_file = File.open(file_name,"w")
        end

        object_file.write(line)
    end 
end 
```

但是有一些先决条件：我总是确定文件的第一行将包含一个标题。我也没有关闭文件（这肯定会有一天将我的业力归零）。

# android - 如何从与 XML 中的 onClick 属性链接的活动中获取布局？

> ID：10058332
> 
> 赞同：0
> 
> 时间：2012-04-07T20:59:15.787
> 
> 标签：android, android-layout

我是 Android 的初学者，我正在使用 Android`JUnit`测试来测试我的代码。

所以，我有一个扩展的测试活动`ActivityInstrumentationTestCase2<Activity>`。

Activity 在`onCreate()`方法中有它自己的布局。（主要布局）

在我的 XML 中，我有一个`onClick`用于调用`foo()`方法的按钮的属性。

回到 Activity，在 中`foo(View v)`，我将我的内容视图设置为不同的布局。

我想测试那个布局。

我如何获得布局？

我知道主要布局，我可以做到这一点。

```
Activity act = getActivity();
View mainLayout = (View) act.findViewById(bla.bla.bla.R.id.main_layout); 
```

如何获得我设置的布局`foo(View v)`？

我已经尝试过，

```
fooLayout = (View) act.findViewById(bla.bla.bla.R.id.foo_layout); 
```

和

```
act.setContentView(bla.bla.bla.R.layout.foo_layout);
fooLayout = (View) act.findViewById(bla.bla.bla.R.id.foo_layout); 
```

我想我得到`NullPointerException`了第一个和`android.view.ViewRootImpl$CalledFromWrongThreadException` 第二个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T23:04:39.473

在您的第一次尝试中，您会收到 NullPointerException，因为您正在 main_layout 中搜索您的 foo_layout。`findViewById`用于搜索布局中的**视图**，而不是查找/膨胀布局。在您的第二次尝试中，您会收到 CalledFromWrongThread 异常，因为您`setContentView()`从 UI 线程外部访问 UI ()。这是您在测试类中更改布局的方式：

```
getActivity().runOnUiThread(new Runnable() {
@Override
    public void run() {
        getActivity().setContentView(R.layout.foo_layout);
    }
});
getInstrumentation().waitForIdleSync();
// now you can access your views from your foo_layout via getActivity().findViewById(...) 
```

我不知道您所说的“我想测试我的布局”是什么意思。您想检查您的布局是否通过单击按钮成功加载，或者您想访问新（已加载）布局的视图。在这两种情况下，您都可以执行以下操作：

```
public void testLayout() {
    // get your button that changes the layout of your activity. 
    // that button is in your main_layout
    final Button btChangeLayout = (Button) getActivity().findViewById(R.id.yourButtonThatChangesTheLayout);

    // perform a click in order to change the layout
    getActivity().runOnUiThread(new Runnable() {
    @Override
        public void run() {
            btChangeLayout.performClick();
        }
    });
    getInstrumentation().waitForIdleSync();

    // get a reference of a view thats in your foo_layout e.g. a Button
    Button aButtonInYourFooLayout = (Button) getActivity().findViewById(R.id.aButtonInYourFooLayout);
    // now you can do what your want with your button/view. 

    //if you just want to know wheter your layout has successfully been loaded
    //or not you can test your view if it's null
    assertNotNull(aButtonInYourFooLayout);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:32:22.263

i'm not sure ... but i think the first problem is:

```
act.setContentView(bla.bla.bla.R.id.foo_layout); 
```

change to:

```
act.setContentView(bla.bla.bla.R.layout.foo_layout); 
```

because in res/layout/ you have your UI, isn't it?

# zend-framework - 将 CSS 文件添加到布局 Zend 框架

> ID：10058335
> 
> 赞同：2
> 
> 时间：2012-04-07T20:59:48.653
> 
> 标签：zend-framework

我正在尝试在我的zend应用程序中添加一个css文件`layout.php`问题是它驻留在

> /application/media/css/style.css

当我做

```
 <?php echo $this->headLink()->appendStylesheet('/media/css/style.css')  ?> 
```

它会生成类似的路径

> appname/public/media/css/style.css

我需要在哪里生成路径

> 应用程序名/应用程序/媒体/css/style.css

我如何告诉 zend 在 layout.php 的特定位置查找 css 文件

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T06:01:43.157

我已经解决了这个问题。总是很简单。:DI 添加

```
<link rel="stylesheet" href="css/site.css" type="text/css" media="screen, projection"> 
```

在头部标签中。并且 css 文件夹在公用文件夹中。

谢谢欧姆

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-07T21:42:13.040

应用程序目录中的所有内容都无法通过您的 Web 服务器访问，您必须将文件移动到公共目录或设置指向它的[符号链接](http://en.wikipedia.org/wiki/Symbolic_link)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-24T12:58:51.510

只是为了完成所有答案，将您的 CSS、JS、字体和所有其他媒体放在“应用程序”文件夹中是不“正确的”。“公共”文件夹就是为此而存在的。然后，要从所有 URL 中删除“/public”，只需在 **.htaccess中进行简单更改**

```
RewriteEngine On
RewriteBase / # you could put some subfolder, if you need
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

在你的**index.php中**

```
<?php

define('RUNNING_FROM_ROOT', true);
include 'public/index.php'; 
```

然后你可以用它来附加你的样式

```
<?php echo $this->headLink()->appendStylesheet('/public/media/css/style.css')  ?> 
```

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T12:06:38.680

您应该使用以下代码：

```
<link rel="stylesheet" type="text/css" media="screen" href="<?=$this->baseUrl();?>/yourpathtocss" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-23T14:48:21.563

我认为正确的方法是从 layout.phtml 执行此操作，如下所示

`<?php echo $this->headLink()->appendStylesheet('/css/site.css') ?>`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-23T11:04:31.397

这里 'TestZend' 是项目名称

```
<?php echo $this->headLink()->appendStylesheet('/TestZend/public/css/bootstrap.css'); ?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-04T15:47:44.537

只需在布局部分添加此代码片段，以确保在其中创建 MEDIA 文件夹`yourProjectFoder/public/media/css/style.css`

```
<head>
  // some code here...
  <?= $this->headLink() 
    //added from the new template   
    ->prependStylesheet($this->basePath('media/css/style.css'))

  ?>
  // some other code here
</head> 
```

# c# - 如何使用旧代码读取扩展名 .proto 文件（textformat.merge）？

> ID：10058337
> 
> 赞同：2
> 
> 时间：2012-04-07T20:59:56.063
> 
> 标签：c#, protocol-buffers, protobuf-net

我的问题与谷歌协议缓冲区的 C# 实现有关（protobuf-csharp-port，作者 jon skeet，干得好！）

我遇到了扩展问题：假设我写道：

*   “transport_file.proto”带有“传输消息”和一些
    处理它的代码“code_old”。
*   我在“Mytransport.proto”文件上写了一个传输消息的扩展，以及读取它的新代码“code_new”。

我正在尝试读取一条新消息（来自 MyTransport.proto），其中 code_old 期望忽略扩展名，但我在 TextFormat 的合并方法中遇到异常：“transport”没有名为“whatever_new_field”的字段

```
Transport.Builder myAppConfigB = new Transport.Builder();
System.IO.StreamReader fich = System.IO.File.OpenText("protocolBus.App.cfg");
TextFormat.Merge(fich.ReadToEnd(),myAppConfigB);
fich.Close(); 
```

新的扩展文件如下所示：

```
...
  Transport 
  { 
     TransportName: "K6Server_0"
     DllImport: "protocolBus.Transports.CentralServer"
     TransportClass: "K6Server"
     K6ServerParams
     {
        K6Server { host: "85.51.11.23" port: 40069 }
        Service: "TZinTalk"
        ...
     }
  }
... 
```

而旧的，没有扩展：

```
...
  Transport 
  { 
     TransportName: "K6Server_0"
     DllImport: "Default"
     TransportClass: "Multicast"
  }
... 
```

整个想法是使用基于文本的协议缓冲区作为配置文件，我在其中编写了一些参数，并基于其中一个加载和组装（它将使用新扩展名读取整个消息（初始化对象的参数） .

**任何的想法？**（这是一个绝望的问题：D）

我正在使用 MSVC# 2008Express 版本，protobuf-csharp-port 版本 0.9.1（总有一天我会升级一切）。

提前致谢。

* * *

我正在研究具有不同传输方式的非中心化发布-订阅消息框架（对于原型文件中的任何书面消息，我会自动创建一个发布和订阅者类）。默认情况下，我使用多播，但也包括广播和“ *UDP 星”。*我让扩展机制让人们使用它的 owm 配置参数添加新的传输，这些参数应该由我的主 code_old 读取（只是为了加载程序集）并让新的传输 (.dll) 再次读取它（完全）。好奇的？以前的，几乎可以使用的版本在[http://protocolbus.casessite.org](http://protocolbus.casessite.org)

**更新 1**

文本格式的扩展类型用括号括起来（很高兴知道，我不知道：D）所以我应该写：

```
 [K6ServerParams]
 {
    K6Server { host: "85.51.11.23" port: 40069 }
    Service: "TZinTalk"
    ...
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:06:16.203

*协议缓冲区在使用其二进制*格式时被设计为向后和向前兼容，但当前代码当然不希望解析具有未知字段的*文本格式。*它可能会被更改以执行此操作，但我想检查 Java 代码以尝试保持与它的奇偶性。

你有什么理由不使用二进制表示开始吗？这是正常的预期用途，也是绝大多数工作都投入其中的用途。（话虽如此，在远离代码之后，这一切似乎有点模糊......）

# sql - VB.Net SQL 问题

> ID：10058340
> 
> 赞同：0
> 
> 时间：2012-04-07T21:00:30.540
> 
> 标签：sql, database, vb.net

我收到以下代码的错误，指出索引不正确。我假设这是 SQL 语句的错误，但我不确定出了什么问题。

```
 Private Sub btnStock_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnStock.Click
    frmStock.Visible = True
    Dim SQLCmd As String
    SQLCmd = "SELECT PartID,PartName,PartStockLevel,MakeName,ModelName FROM tblParts WHERE PartStockLevel <= StockWarnLevel;"
    RunSQLCmd("dt", SQLCmd)
    Dim inc As Integer = 0
    Dim NoLowStock As Boolean
    If DataTable IsNot Nothing AndAlso DataTable.Rows.Count > 0 Then
        frmStock.txtPartID.Text = DataTable.Rows(inc).Item(0)
        frmStock.txtName.Text = DataTable.Rows(inc).Item(1)
        frmStock.NUDStockLvl.Value = DataTable.Rows(inc).Item(2)
        frmStock.txtMake.Text = DataTable.Rows(inc).Item(3)
        frmStock.txtModel.Text = DataTable.Rows(inc).Item(4)
    Else
        frmStock.lblLowStock.Visible = True
        frmStock.btnFirstRecord.Visible = False
        frmStock.btnIncDown.Visible = False
        frmStock.btnIncUp.Visible = False
        frmStock.btnLastRecord.Visible = False
        NoLowStock = True
    End If
    If NoLowStock = False Then
        frmStock.Panel1.Visible = False
    End If
End Sub

    Public Sub RunSQLCmd(ByVal DTorDS As String, ByRef SQLCmd As String)
    DataAdapter = New OleDb.OleDbDataAdapter(SQLCmd, con)
    ConnectDB()
    Try
        If DTorDS = "dt" Then
            DataTable = New DataTable
            DataAdapter.Fill(DataTable)
        Else
            DataSet = New DataSet
            DataAdapter.Fill(DataSet, "srcDataSet")
        End If
    Catch ex As Exception
        con.Close()
    End Try
    con.Close()
End Sub 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:06:33.477

该错误可能来自您查看结果中不存在的行索引。在尝试获取数据之前，您应该检查表是否有行。

像这样： If DataTable IsNot Nothing AndAlso DataTable.Rows.Count >0 Then ... 代码在这里... End If

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T23:37:28.787

试试这个简单的方法

```
dim dt as new datatable

using connection as new sqlconnection("server=SERVER;database=DATABASE;uid=USERID;pwd=PASSWORD")
connection.open()
     using cmd as new sqlcommand("SELECT PartID,PartName,PartStockLevel,MakeName,ModelName FROM tblParts WHERE PartStockLevel <= StockWarnLevel", connection)
     dt.load(cmd.executereader)
     end using
end using 
```

# php - 管理员中的 Magento 1.6 属性

> ID：10058349
> 
> 赞同：0
> 
> 时间：2012-04-07T21:01:46.703
> 
> 标签：php, attributes, magento

Magento 的行为有点奇怪，不太清楚为什么。

它以前可以工作，但现在当我将属性添加到属性集然后创建配置产品时，当我进入“选择可配置产品”阶段时，我检查的属性不会显示在实际的产品创建页面上。

但奇怪的是。就好像系统颠倒了选项一样。例如，如果我在那里有 3 个属性并且我选择了所有三个属性，那么在产品创建时我看不到我选择的任何属性。

如果我在单击继续时选择了第一个和第三个属性，则会显示第二个属性等，但不是我选择的实际属性。

所以本质上它似乎显示了我实际上没有选择的属性。与它应该做的相反。

希望有人可以阐明并帮助解决。不知道发生了什么。

谢谢阅读

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T13:43:40.360

必须在附加到*可配置产品的**简单产品*上设置属性。

 *对于我的可配置产品**Foo 清洁用品**，我选择*产品类型*作为我的可配置属性。当我查看*关联产品*选项卡以选择与我的可配置产品相​​关联的*简单产品*时，我只会看到具有*产品类型*属性集的产品，因为它们是唯一可以成为我的可配置产品一部分的产品。

![可配置 Magento 产品的屏幕截图](../Images/4b0f53a05b0be8c5a410b2a921e96c41.png)*

# android - Android 应用程序和代码许可

> ID：10058353
> 
> 赞同：1
> 
> 时间：2012-04-07T21:02:27.747
> 
> 标签：android, android-ndk

我不了解开源和安卓许可。

假设我在 android 中开发应用程序（这是开源 Apache 许可证），我是否也必须发布我的应用程序的源代码？或者我应该为我的应用程序编写包装器，到与 Android 链接的那部分，比如活动/意图和数千个其他 api？这是不是太乏味了。

我很困惑。如果我有一些专有的软件/引擎，我将它与 android 库链接，并将我的应用程序作为顶层实现为活动。我必须发布源代码吗？

任何对链接的指针/引用都会对我有所帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:07:07.457

不，这并不意味着您必须发布您的源代码，该许可证适用于 Android 而不是您的代码，即使您修改了 Android 源代码，您也没有义务将其发布给所有人。请参阅此处： http: [//source.android.com/source/licenses.html](http://source.android.com/source/licenses.html)和此处： http: [//www.apache.org/licenses/LICENSE-2.0](http://www.apache.org/licenses/LICENSE-2.0)。

如果您修改 GPLv2 下的 linux 内核则另当别论，请参见此处：[http ://www.kernel.org/pub/linux/kernel/COPYING](http://www.kernel.org/pub/linux/kernel/COPYING)

# c# - 这个代码线程安全吗？C＃

> ID：10058354
> 
> 赞同：0
> 
> 时间：2012-04-07T21:02:32.567
> 
> 标签：c#, multithreading

很多代码已经被删除，但我真的只需要展示这部分。主要思想：方法*Localize()*必须快速工作，因此不能被任何其他线程锁定。它使用标志*isLoaded*来检测要使用哪种类型的本地化 - 旧的或当前的。

```
static class Localization
{
    static readonly object locker = new object();

    static string LocalizationDir;

    static bool isLoaded;
    static Tuple<string, string> OldLanguage;
    static Dictionary<string, string> OldLocalization;
    static Dictionary<string, string> CurrentLocalization;

    public static Tuple<string, string> CurrentLanguage {
        get;
        private set;
    }

    static Localization() {
        lock ( locker ) {
            OldLanguage = null;
            CurrentLanguage = new Tuple<string, string>("en", "English");
            isLoaded = true;

            OldLocalization = null;
            CurrentLocalization = null;
        }
    }

    public static bool SetLanguage(string languageShortName) {
        lock ( locker ) {
            string languagePath = Path.Combine(LocalizationDir, languageShortName + ".loc");

            // save localization, be ready to return it back
            OldLocalization = CurrentLocalization;
            OldLanguage = CurrentLanguage;
            isLoaded = false;

            try {
                using ( TextReader i = new StreamReader(languagePath) ) {
                    /*
                        Parse file, 
                        Modify CurrentLocalization, CurrentLocalization
                    */
                }
            }
            catch ( Exception e ) {
                // Just return back our good localization data

                CurrentLocalization = OldLocalization;
                CurrentLanguage = OldLanguage;
                isLoaded = true;

                OldLocalization = null;
                OldLanguage = null;

                return false;
            }

            // everything is good
            {
                OldLocalization = null;
                OldLanguage = null;
                isLoaded = true;

                UpdateControls();
            }

            return true;
        }
    }

    // <summary>
    // We think that there are no bugs in this method
    // No locking
    // </summary>
    public static string Localize(this string Text) {
        if ( CurrentLanguage.Item2 == "English" )
            return Text;

        Dictionary<string, string> ChoosedLocalization = null;
        if ( !isLoaded && OldLocalization != null )
            ChoosedLocalization = OldLocalization;
        else if ( isLoaded && CurrentLocalization != null )
            ChoosedLocalization = CurrentLocalization;

        if ( ChoosedLocalization != null ) {
            string Translate;

            if ( !ChoosedLocalization.TryGetValue(Text, out Translate) )
                return Text;
            else
                return Translate;
        }
        else
            return Text;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:43:27.843

我怀疑不是。我也怀疑你想太多了。在 SetLanguage 中，您所要做的就是加载新字典，然后将其换成旧字典。该分配是原子的，因此只要您的 Translate 代码不连续两次使用 CurrentLanguage 并假设它是相同的并且 UpdateControls 调用会等到前一个调用完成（或其他一些竞争条件预防）然后它应该更简单、更干净、更可靠。

# python - 后台进程 subprocess.Popen 与管道

> ID：10058368
> 
> 赞同：7
> 
> 时间：2012-04-07T21:04:42.553
> 
> 标签：python, background, subprocess, audio-recording

我正在尝试使用 arecord 使用 python 记录和转换流。

在 shell 中，这是一个或多或少类似的命令：

```
arecord -B 5000 -f dat | lame -m j -q 5 -V 2 - test.mp3 & 
```

在 Python 中，我使用 subprocess.Popen 进行了尝试：

```
reccmd = ["arecord", "-B", "5000", "-f", "dat"]
mp3cmd = ["lame", "-m", "j", "-q", "5", "-V", "2", "-", "test.mp3"]
p = subprocess.Popen(reccmd, stdout=subprocess.PIPE)
p2 = subprocess.Popen(mp3cmd, stdin=p.stdout)
p2.communicate() 
```

但我不知道如何在代码中包含“&”或类似的东西，以便能够用

`killall arecord`命令

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-07T21:07:52.337

如果您不希望主 Python 进程在执行子进程时阻塞，只需不要调用`p2.communicate()`. 呼吁`subprocess.Popen()`不要阻止。

# c# - C# Parallel.Foreach、新类和静态 voids./strings

> ID：10058370
> 
> 赞同：0
> 
> 时间：2012-04-07T21:04:52.463
> 
> 标签：c#

我正在使用 a`Parallel.ForEach`来调用并创建一个新类。

```
Parallel.ForEach(urlTable.AsEnumerable(),drow =>
        {
            using (var WCC = new MasterCrawlerClass() )
            {
                WCC.MasterCrawlBegin(drow);
            }
        }); 
```

`MasterCrawlerClass`包含`private static voids`和`private static string`。我想我的问题是这个。既然我在 my`foreach`中调用一个新类，那么我`voids`/`strings`在那个新类实例中的所有 / 都是安全的吗？

```
class MasterCrawlerClass : IDisposable
{
    public void Dispose()
    {
        GC.Collect();
    }
    public static void SetNewProxy()
    {
        string mysql_Proxyserver_ProxyPort = "select ProxyServer,ProxyPort,ResponseTime FROM proxies.tblproxies where Active = 1 and DateTested >= Date_sub(CurDate(),INTERVAL 2 day) and ResponseTime <= 3 order by Rand() limit 1";
        DataTable proxyDT = new DataTable();
        proxyDT = DTTable(mysql_Proxyserver_ProxyPort, "mysql_Proxyserver_ProxyPort");
        ProxyServer = proxyDT.Rows[0].ItemArray[0].ToString();
        ProxyPort = Convert.ToInt32(proxyDT.Rows[0].ItemArray[1].ToString());
    }

    private static string HTMLModelProcess(string inputString)
    {
        string returnString = string.Empty;
        string ModelString = inputString.Replace("Certified", "").Replace("Used", "").Trim();
        string[] makeModelSplit = ModelString.Split(new char[] { ' ' }, 4);
        returnString = makeModelSplit[2];
        return returnString;

    }
    private static string ProxyServer { get; set; }
    private static int ProxyPort { get; set; }

}

private static DataTable DTTable(string mysqlQuery, string queryName)
    {
        DataTable DTTableTable = new DataTable();
        try
        {
            MySqlDataAdapter DataDTTables = new MySqlDataAdapter(mysqlQuery, MySQLProcessing.MySQLStatic.Connection);
            DataTable DataDTTablesDT = new DataTable();
            DataDTTables.SelectCommand.CommandTimeout = 240000;
            DataDTTables.Fill(DataDTTablesDT);
            DTTableTable = DataDTTablesDT;

        }
        catch (Exception ex)
        {

            GenericLogging("Failed MySQLquery: " + ex.Message.ToString(), "MySQLProcessor", "DTTable", "", "MysqlError", "", queryName, mysqlQuery);

        }
        return DTTableTable;
    } 
```

MysqlProcessing.Mysqlstatic.Connection 是在 Parallel 之前设置的，永远不要改变。

这是更多`voids`一些`strings`。我还不完全理解线程，所以我正在努力解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:31:56.500

Your HTMLModelProcess is thread safe. It does not affect any application State.

The SetNewProxy method is not thread safe. It changes the state of the ProxyServer and ProxyPort, which are shared. If this behavior is supposed to happen in an instance scope it (and the related state) should be moved to the instance.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:46:11.883

好吧，您的问题不是很清楚，但是您想知道，AFAIU 是您的 MasterCrawlerClass 类线程安全（即与 Parallel.ForEach() 或其他情况一起使用是否安全，如果它被多个线程访问）只要您在传递给 Parallel.ForEach() 的委托中创建一个新实例（即每个线程的新实例）。

答案 - 如果每个线程都有自己的类实例 - 所有实例（非静态）字段和属性都是安全的，但静态的则不一定。如果你只分配它们一次——当它们被声明或在静态构造函数中并且之后只从它们中读取——它应该没问题。但是，如果您有一个或多个写入静态成员的函数 - 应该同步此访问以避免同时写入或读写。[这是有关同步的 MSDN 信息信息 - 看看“锁定”是否适合您的需要。](http://msdn.microsoft.com/en-us/library/ms228964%28v=vs.100%29.aspx)

由于您提供的类只有静态函数和属性-尚不清楚，为什么要在 Parallel.ForEach 中创建一个新实例-所有这些属性都是类级别的，并且会导致内存中的相同对象，如果您尝试这样做会出现问题在不同的线程上启动您的静态函数（非同步并发访问）。

PS请注意，如果您有某个类（引用类型）的静态字段或属性并写入其字段\属性之一 - 它仍然不安全 - 多个线程正在尝试更改同一块内存，可能同时且结果不可预测.

# php - 如何使用 twitter json 结果将时间更改为日/月？

> ID：10058374
> 
> 赞同：-4
> 
> 时间：2012-04-07T21:05:30.013
> 
> 标签：php, json, twitter

尝试使用 PHP 访问我的 twitter 提要时，我得到了这个结果：

```
Sat Apr 07 07:29:11 +0000 2012 
```

我怎样才能改变它，所以它只是“ `Apr 07`”？

我正在使用的代码：

```
 $tweets = getTweets("http://twitter.com/status/user_timeline/justinbieber.json?count=3");
      foreach($tweets as $tweet) {

        $time = $tweet->created_at;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:18:10.400

用于[`strtotime()`](http://php.net/strtotime)将其转换为时间戳，然后使用[`strftime()`](http://php.net/strftime)or对其进行格式化`date()`。

```
echo strftime('%h %d', strtotime('Sat Apr 07 07:29:11 +0000 2012'));
# Apr 07 
```

所以在你的情况下：

```
$time = strftime('%h %d', strtotime($tweet->created_at)); 
```

但是，调用包含月份和日期的变量“时间”是一个非常糟糕的主意。毕竟是约会。

# python - 如何将字符串输入作为“无”处理为 Nonetype

> ID：10058378
> 
> 赞同：0
> 
> 时间：2012-04-07T21:05:48.047
> 
> 标签：python, string, optparse, nonetype

在 optparse 模块中，我有一个采用路径值的选项（例如构建）。

问题：我检查了此选项是否为无，但如果通过 --build=None 则失败。原因：原因是 optparse 的默认类型是字符串，因此它设置 build='None' 即为字符串类型，值为 None。

一种方法是使用 eval() 方法，但如果有人提供合法路径，它会失败或者如果 build 或 build.lower()=='none' 我可以这样做：

但是我也必须为所有其他选项执行此操作，默认情况下采用字符串输入。有没有更好的办法？好心劝告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T00:19:16.350

我有点困惑问题是什么......这是我放在一起的一些代码。

```
>>> import optparse
>>> import shlex
>>> parser = optparse.OptionParser()
>>> parser.add_option('--build',type=str,default=None)
<Option at 0x...: --build> 
```

`--build`在“命令行”上提供选项。

```
>>> options, args = parser.parse_args(shlex.split("--build=None"))
>>> print options
{'build': 'None'}
>>> options.build is None
False
>>> options, args = parser.parse_args(shlex.split("")) 
```

`--build`“命令行”上没有给出选项

```
>>> print options
{'build': None}
>>> options.build is None
True 
```

如您所见，如果`--build`命令行上未提供，则默认为`None`（即类型为 的对象`NoneType`）。如果提供了 build 并且字符串 == "None"，它返回一个字符串 "None"。

如果您坚持传递`--build=None`命令行，那么您希望 optparse 对该标志执行的操作有点模棱两可。例如，如果它是一个路径，您可以编写一个函数来检查路径 None 是否存在：例如

```
import os.path
def path_exists(p):
    if(os.path.exists(p)): return p
    else: return None
...
parser.add_option('--build',type=path_exists,default=None) 
```

当然，path_exists 可以根据您的应用程序所需的复杂程度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T01:07:55.200

如果由于某种原因，mgilson 的答案没有用，因为您需要默认值实际上是其他东西，`None`或者其他一些明显的非价值；例如，如果您希望默认值类似于`~/.foorc`，我倾向于使用的解决方案是添加一个不同的“关闭它”选项，通常在它前面加上一个否定。

```
>>> import optparse
>>> import shlex
>>> parser = optparse.OptionParser()
>>> parser.add_option('--build', type=str, default="~/.foorc")
<Option at 0x...: --build>
>>> parser.add_option('--no-build', 
...                   dest="build",
...                   action="store_const",
...                   const=None)
<Option at 0x...: --no-build> 
```

明智的默认值，毕竟选项是可选的

```
>>> options, args = parser.parse_args(shlex.split(""))
>>> print options 
{'build': '~/.foorc'}
>>> options.build
'~/.foorc' 
```

可以使用以下`--no-build`选项禁用：

```
>>> options, args = parser.parse_args(shlex.split("--no-build"))
>>> print options
{'build': None}
>>> options.build is None
True 
```

当然，您仍然可以覆盖默认值。

```
>>> options, args = parser.parse_args(shlex.split("--build=something"))
>>> print options
{'build': 'something'}
>>> options.build
'something' 
```

# java - 在大型可滚动+可缩放图像视图之上动态定位视图（类似于谷歌地图中的标记）

> ID：10058382
> 
> 赞同：1
> 
> 时间：2012-04-07T21:06:02.617
> 
> 标签：java, android

我有一个包含可以放大和滚动的位图的图像视图。我使用了 setImageBitmap() 方法而不是在画布上设置图像。imageview 充当用户可以浏览的地图。现在，我的应用程序应该允许用户使用图钉在用户在图像视图上选择的点上标记兴趣点，就像在谷歌地图中所做的那样。我已经能够使用 OnTouch() 方法的修改实现来选择原始位图上的哪个点来工作，所以我知道标记必须放置在哪里。我想在这个位置设置一个标记并将一个字符串传递到数据库中以存储有关该位置的信息，以便在点击标记时，此信息会显示在气泡/吐司通知中。

截至目前，我可以滚动图像，感知图像视图上的 longTouch 事件，保存点击点，移动到新活动以收集信息以添加到数据库中。我似乎找不到在原始图像视图上设置标记的方法。另外，我猜我必须在此处使用 ArrayList 实现来获取具有单个 ID 的标记，这些 ID 可能与数据库字段中的 ID 相关，但我不明白如何实现它。

我在互联网上寻找解决方案或想法，在发帖之前我已经尝试了很多东西，但似乎没有任何效果。使用画布的绘制函数不允许 onTap 函数显示信息通知。绘制的位图在缩放时也会失去比例和质量。我尝试制作一个扩展 RelativeLayout 的自定义类，以在我的 imageview 上充当一个不可见的图层，但我不知道如何将标记放置在确切的位置并使自定义 RelativeLayout 更容易。我尝试放置一个与我的位图相同尺寸的虚假透明画布，以使缩放工作并允许我将标记放置在绝对位置，但它不起作用。另外，在自定义 RelativeLayout 类上使用 onTouch 事件意味着我不能在较低的 imageview 类上使用 onTouch 事件。

我似乎无法想出任何可以帮助我实现我想要的机制的解决方案，所以我愿意接受任何可以抛给我的想法。我很感激一些帮助。

# javascript - 为什么我的迷你按钮在 jQuery Mobile 的列表视图中如此之大？

> ID：10058388
> 
> 赞同：1
> 
> 时间：2012-04-07T21:06:31.060
> 
> 标签：javascript, jquery, jquery-mobile

我在 jQuery Mobile 中有一个列表视图，其中包含删除按钮。

```
<ul data-role='listview' class='animalList'>
    <li data-animal-prey-id='50'>Elephant<a data-role='button' data-icon='delete' data-iconpos='notext'>Delete</a></li>
    <li data-animal-prey-id='50'>Rhino<a data-role='button' data-icon='delete' data-iconpos='notext'>Delete</a></li>
    <li data-animal-prey-id='50'>Ostrich<a data-role='button' data-icon='delete' data-iconpos='notext'>Delete</a></li>  
</ul>​ 
```

为什么删除按钮显示如此巨大？我希望它们是动物名称右侧的小按钮。

这就是我的意思。 [http://jsfiddle.net/z2nFK/](http://jsfiddle.net/z2nFK/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:38:25.023

您设置小提琴的方式存在许多问题。

1.  您将 JQM 1.1 版用于您的 css，但将 JQM 1.0.1 版用于您的 js。
2.  此外，JQM 1.0.1 与 JQuery 1.7.2 不兼容，并且存在一些已知问题。
3.  您的列表视图格式不正确。

这是所有这些固定的示例。[http://jsfiddle.net/codaniel/47SvT/1/](http://jsfiddle.net/codaniel/47SvT/1/)只需点击顶部的 fork 按钮即可制作您自己的小提琴版本。

请注意，我使用了拆分列表视图而不是默认列表视图。我相信这可能更适合您的情况。另请注意，animal 和 delete 都包含在`<a>`标签内。我希望这有帮助！

# android - 带有python-bluez客户端的android蓝牙服务器套接字

> ID：10058391
> 
> 赞同：2
> 
> 时间：2012-04-07T21:07:03.877
> 
> 标签：android, python, bluetooth

我正在尝试使用笔记本电脑上的 python-bluez 和手机上的 android-bluetooth API 将我的笔记本电脑（作为客户端）连接到我的 android 手机（作为监听器）。

我在手机上使用以下代码：

```
BluetoothServerSocket tmp = badapter.listenUsingRfcommWithServiceRecord(
    badapter.getName(), MY_UUID);
BluetoothServerSocket bserversocket = tmp;
if(bserversocket != null)
{
    BluetoothSocket acceptsocket = bserversocket.accept(timeout);   
}
//timeout is set to about 15 sec
if(acceptsocket != null)
{
    out.append("got the connection...\n");   
} 
```

以及用于我的笔记本电脑客户端的python中的以下内容：

```
from bluetooth import *

btooth_addr = "38:EC:E4:57:1F:1B"

sock = BluetoothSocket(RFCOMM)
sock.connect((btooth_addr, 2))

print "Connected"
sock.close() 
```

侦听器超时而未确认来自笔记本电脑的任何连接，而发送者继续在不同端口上的所有尝试上打印“已连接”。

问题是我不知道也不能设置安卓手机正在监听的端口/通道，而且我需要填写一个端口号作为“连接”的第二个参数（这个片段中的 2） .

请帮帮我 - 我此时的唯一目标是让电话确认连接尝试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T09:58:23.797

查看[用于建立客户端连接的 pybluez 文档（源代码）](http://code.google.com/p/pybluez/source/browse/trunk/examples/simple/rfcomm-client.py)。

**您可以使用find_service**为提供的蓝牙地址和 UUID 获取正确的端口。然后像在代码中一样连接您的套接字，将硬编码的端口值替换为正确的端口值。

不要忘记投票！

# haskell - 'do' 构造中的最后一条语句必须是表达式 Haskell

> ID：10058394
> 
> 赞同：6
> 
> 时间：2012-04-07T21:07:14.430
> 
> 标签：haskell

基于其他类似的问题，我发现我的问题与缩进有关，但我已经搞砸了很多，但仍然无法弄清楚。

```
addBook = do
    putStrLn "Enter the title of the Book"
    tit <- getLine
    putStrLn "Enter the author of "++tit
    aut <- getLine
    putStrLn "Enter the year "++tit++" was published"
    yr <- getLine 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-07T21:12:29.847

在您的情况下，这不是缩进；你真的已经用不是表达式的东西完成了你的功能。 `yr <- getLine`——在这之后，你预计会发生什么`yr`，或者`aut`就此而言？它们只是悬空，未使用。

显示它是如何翻译的可能更清楚：

```
addBook = putStrLn "Enter the title of the Book" >>
          getLine >>= \tit ->
          putStrLn "Enter the author of "++ tit >>
          getLine >>= \aut ->
          putStrLn "Enter the year "++tit++" was published" >>
          getLine >>= \yr -> 
```

那么，你想在最后一个箭头之后得到什么？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-07T21:08:55.700

想想`addBook`. 那里……什么都没有`IO a`。`a`那是行不通的。你的 monad 必须有一些结果。

您可能想在最后添加类似这样的内容：

```
return (tit, aut, yr) 
```

或者，如果您不想得到任何有用的结果，请返回一个空元组（一个单元）：

```
return () 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-11T17:17:13.180

如果你拿你的代码：

```
addBook = do
    putStrLn "Enter the title of the Book"
    tit <- getLine
    putStrLn "Enter the author of "++tit
    aut <- getLine
    putStrLn "Enter the year "++tit++" was published"
    yr <- getLine 
```

并将其“翻译”为“正常”（非`do`）符号（给定`p = putStrLn "..."`）：

```
addBook = 
    p >> getLine >>= (\tit ->
        p >> getLine >>= (\aut ->
            p >> getLine >>= (yr -> 
```

你最终`(yr ->`没有意义。如果您没有其他有用的事情要做，则可以返回一个空元组：

```
return () 
```

在末尾：

```
addBook = do
    putStrLn "Enter the title of the Book"
    tit <- getLine
    putStrLn "Enter the author of "++tit
    aut <- getLine
    putStrLn "Enter the year "++tit++" was published"
    yr <- getLine
    return () 
```

您可能应该问自己为什么需要获取`aut`以及`yr`尽管。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-19T22:44:37.730

删除最后一行，因为它不是表达式，然后对传递给 putStrLn 的字符串使用括号。

# javascript - 如何根据分隔符从字符串创建循环

> ID：10058397
> 
> 赞同：0
> 
> 时间：2012-04-07T21:07:47.080
> 
> 标签：javascript, jquery

我有一个这样的字符串：

```
var string = ' [United States] [Canada] [India] '; 
```

我想做一个 for 循环并将每个国家添加到 Javascript 或 Jquery 中的数组中，如下所示：

```
var countryArray = new Array();
for ( each country in string AS country) {
  countryArray.push(country);      
} 
```

我不确定如何从这样的字符串中创建一个 foreach 循环。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T21:17:52.973

这里：

```
var arr = str.match(/\[.+?\]/g).map(function (s) { return s.slice(1, -1); }); 
```

**现场演示：http:** [//jsfiddle.net/bWC9F/](http://jsfiddle.net/bWC9F/)

不过，可能有更好的方法来做到这一点......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T21:21:32.963

我会这样做

```
string.match(/\[(.*?)\]/g).map(function(inp){return inp.substring(1, inp.length - 1)}) 
```

哇。完全相同的东西

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-07T21:26:13.260

分裂（）？

```
var string = ' [United States] [Canada] [India] ';
var arr = string.split(/([[^[]*])/ );

alert(arr); 
```

# c - 比较文件中相邻行的更好算法

> ID：10058400
> 
> 赞同：0
> 
> 时间：2012-04-07T21:08:40.587
> 
> 标签：c

我已经完成了作业（是的，这是针对编程课的），但恐怕我没有以最有效的方式去做。它基本上是 uniq 程序，它将比较文件中的相邻行，并且只打印任何重复行的副本。一些注意事项：printUniq() 是我自己的函数，它考虑了各种标志，readline() 是另一个函数，它使用 malloc 和 realloc 将任意长度的行读取到 char * 缓冲区中。这是我担心的部分：

```
if(prevline != NULL)
{
  while(thisline != NULL)
  {
     while(thisline != NULL && strcmp(prevline, thisline) == 0)
     {
        count++;
        free(prevline);
        prevline = thisline;
        thisline = readline(stream);
     }
     printUniq(prevline, cflag, dflag, uflag, count);
     count = 1;
     free(prevline);
     if (thisline != NULL)
     {
        prevline = thisline;
        if((thisline = readline(stream)) == NULL)
        {
           printUniq(prevline, cflag, dflag, uflag, count);
        }
     }  
  } 
```

有没有更好的方法来构建这个程序？我讨厌必须在循环中检查此行的 NULL 三次。外部 while 循环中的第一次 NULL 检查是必要的，如果最后几行重复，则需要嵌套 while 中的下一次检查。调用 free 后的下一次检查主要检查“重复循环”是否因为 thisline 为空而退出，如果不是，它将允许程序获取另一行。然后下一个检查只针对文件中的最后一行，因为如果它不存在，当 readline 返回 null 时（文件中没有更多行），循环退出并且 prevline 永远不会打印。

无论如何，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:42:14.647

我建议只在一个地方读取文件，因为它会使代码更易于管理。也许这样的事情可能会奏效：

```
prevline = NULL;
count = 1;
while ((thisline = readline(stream)) != NULL) // will stay in the loop for as long as it reads from file
{
    if (prevline == NULL)
    { // this is the first read from file
         prevline = thisline;
         continue;

    }

    if (strcmp(thisline, prevline) == 0)
    {
         count++;
    } else // found a different line
         if (count > 1) // but after I already counted several identical
         {    // so I will print the line
                printUniq(prevline, cflag, dflag, uflag, count);
                count = 1;
         }
    free(prevline);
    prevline = thisline;
}
if (count > 1) and (prevline != NULL)
{
     printUniq(prevline, cflag, dflag, uflag, count);
}
free(prevline); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:15:49.537

使用`(thisLine = readline()) != NULL`作为循环的条件，一次只读取**一行**，意味着循环在文件末尾停止，只有在thisLine有效时才能进入循环体。

它可以在循环外读取 prevLine，也可以在循环内不处理前一行：

```
if ((thisLine = readline()) != NULL) {
    char* prevLine = thisLine;                // got one line
    while ((thisLine = readline()) != NULL) {
       if (strcmp(...) == 0) {
           ...
       } else {
           ...
       }
       ...
    }
    ... deal with prev_line, no need for if because it *must* have been read.
} 
```

对比

```
prevLine = NULL;
while ((thisLine = readline()) != NULL) {
    if (prevLine == NULL) { // first line?
       ...
    } else if (strcmp(...) == 0) {
       ...
    } else {
       ...
    }
       ...
    prev_line = this_line
}
if (prev_line != NULL) {
   ...
} else {          // only one line in the file?
   ...
} 
```

处理循环外的一行使第一种方法更简单。流程对我来说似乎很清楚。有一条线吗？有第二行吗？好吧，唯一性是有意义的……

在第二种方法中，处理循环内的一行意味着维护开发人员将查看每一行输入的第一行测试，恕我直言，他们更担心这一点。

循环之后的代码是必要的，因为文件的最后两行或更多行可能会重复，并且这种情况也需要调用 printUnique。

单行文件逻辑也在循环之后（不太清楚，恕我直言）并且需要mre逻辑。如果该程序旨在模拟其他`uniq`功能，例如打印*每*行计数，则需要此逻辑。

第二种方法的明显好处是在一个地方读取文件，这通常是一个很好的策略。恕我直言，如果 readline 写得正确，那并不重要。

总结：第一种方式需要的逻辑较少，而且事件的顺序更明确，因此更容易理解。第二个在一个地方读取文件，但需要在循环外处理最后一个重复组，因此它甚至更长。`uniq`如果通常正在编程，它也更符合逻辑。

注意：这两种流程都有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T11:48:06.607

Mihai 的建议可以通过使用 for() 循环而不是 while 循环来进一步简化，并且通过使用 continue 语句（大部分）可以避免嵌套条件和重复逻辑：

```
dupstate = 0; uniqcount = 0; totdup = 0; linenum = 0;
for (prevline=NULL; thisline=readline(stream); free(prevline),prevline=thisline) {
{
    linenum++;
    if (!prevline || strcmp(thisline, prevline))
    {
         uniqcount++; dupstate = 0;
         printUniq(thisline, cflag, dflag, uflag, uniqcount);
         continue;
    }
    totdup++;

    if (!dupstate++) /* only the first dup is reported */
    {    
         printDup(thisline, cflag, dflag, uflag, totdup); 
    }
 }

 free(prevline); 
```

# jquery - 点击时需要隐藏div

> ID：10058403
> 
> 赞同：1
> 
> 时间：2012-04-07T21:09:08.310
> 
> 标签：jquery, hide

我正在尝试在网页中实现存档功能，该功能将向网页提交内容，然后在提交后隐藏 div。基本上，我在一个 div 和一个标签上创建一个动态 ID。这是我的代码：

```
<div class="section" id="milestone_<?php echo $milestone['id']; ?>">
  Stuff goes here
    <a href="javascript:void(archiveMilestone(<?php echo $milestone['id']; ?>))" id="archive_milestone_<?php echo $milestone['id']; ?>">(Archive)</a>
</div>

<script>
function archiveMilestone(id)
{
  var dataString = 'remove_milestone='+ id;
    $.post("<?php echo $_SERVER['REQUEST_URI']; ?>",dataString);
    $(document).ready(function(){
      $('a#archive_milestone_' + id).click(function(){
      $('#milestone_' + id).hide('slow');
      })
    });
}
</script> 
```

看起来应该很简单，并且代码已成功发布，但该行不会消失。任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:14:08.623

**HTML**

```
<div class="section" id="milestone_<?php echo $milestone['id']; ?>">
  Stuff goes here
   <a href="#" class="btnArchive">Archive</a>
</div> 
```

**脚本**

```
$(function(){

 $(".btnArchive").click(function(){
   var item=$(this);
   var itemId=item.parent().attr("id").split('_')[1] 
   $.post("yourserverpage.php",{ remove_milestone : itemId } ,function(){
     item.parent().fadeOut("slow"); 
   });       
 });    
}); 
```

这是 jsFiddle [http://jsfiddle.net/hQkVZ/10/](http://jsfiddle.net/hQkVZ/10/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:11:49.810

首先，您不应该`$(document).ready(...`在函数内部。这应该存在于 Javascript 的最外层。其次，您使用的是 PHP，因此您想要选择的项目在 PHP 解析它们之前不存在。请尝试以下方法将事件处理程序主动绑定到元素：

```
$("#archive_milestone" + id).on("click", function() {
    $("#milestone_" + id).hide("slow");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T21:12:05.807

您也可以尝试`archiveMilestone(<?php echo json_encode($milestone['id']); ?>)`添加 json_encode() 因为它可能需要转义。

# ruby - 一次从文件中读取多行

> ID：10058404
> 
> 赞同：1
> 
> 时间：2012-04-07T21:09:25.160
> 
> 标签：ruby

如何从 Ruby 中的文件一次读取多行？

我尝试使用`each_slice(2)`并且也做了：`require 'enumerator'`，但它不起作用。我收到以下错误：

```
undefined method `each_slice' for #<String:0x877d12c> (NoMethodError) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-07T21:23:41.910

两者`IO`都有`String`一个`lines`枚举器，您可以调用`each_slice`它：

```
irb(main):004:0> STDIN.lines.each_slice(2).take(2)
a
a
b
c
=> [["a\n", "a\n"], ["b\n", "c\n"]] 
```

当然，您可以`STDIN`用任何其他`IO`实例（打开文件）替换。带字符串的演示：

```
irb(main):005:0> "a\na\nb\nc".lines.each_slice(2).to_a
=> [["a\n", "a\n"], ["b\n", "c"]] 
```

这两个都在 Ruby >= 1.8.7 中工作

# haskell - 如何为 Haskell 项目生成 TAGS？

> ID：10058411
> 
> 赞同：14
> 
> 时间：2012-04-07T21:10:13.147
> 
> 标签：haskell, ctags

我正在寻找与 Haskell 等效的 ctags。我试过[hasktags](http://hackage.haskell.org/package/hasktags)，但它有一些问题：

在[enumerator](http://hackage.haskell.org/package/enumerator)的源文件夹中，运行`hasktags .`给出：

```
hasktags: tags: openFile: resource busy (file is locked) 
```

当我运行时`vim -t enumFile`，会发生错误：

```
E431: Format error in tags file "tags"
Before byte 4085
E426: tag not found: enumFile 
```

我也试过[gasbag](http://kingfisher.nfshost.com/sw/gasbag/)，但它不能在 ghc-7.0.4 上编译。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-10T02:25:12.800

您使用的是 Mac OS X（或 Windows，见下文），不是吗？在这种情况下，`hasktags -c`（仅创建 Vi 格式标签）将解决您的问题。

这不是唯一的解释，以下是在 OS X 系统上发生的情况：

*   默认情况下，hasktags 假定您需要 vi 和 Emacs 的两个标签。
*   因此，它尝试同时创建`tags`(for Vi) 和`TAGS`(for Emacs)
*   但是，OS X 与 Unix 不同，默认情况下不区分大小写。因此，您不能同时拥有这两个文件。
*   而不是用另一个文件覆盖一个文件，由于某种原因，hasktags 会发生冲突，可能是因为它在关闭“其他”之前打开了一个文件。正如 Evan Laforge 所解释的那样，我希望这是由于惰性 I/O。

*更新*：正如评论所指出的，Windows 也不区分大小写，因此可能会出现类似的问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-08T01:33:51.573

hasktags 有一些错误，其中之一是它使用了惰性 IO，这往往会导致那些资源繁忙的错误。

碰巧，我刚刚写了一个标签程序，在[http://hackage.haskell.org/package/fast-tags](http://hackage.haskell.org/package/fast-tags)

其他选项是 hothasktags，它可以制作合格的 Module.function 标签，以及 lushtags，它旨在与一个花哨的 IDE 类 vim 标签栏集成。根据我的经验，hothasktags 会生成巨大的标签文件，并且一旦无法解析文件，lustags 就会崩溃。两者都使用 haskell-src-exts 这意味着它们是准确的，但是如果它们无法解析您的文件并且无法处理 .hsc 文件，则会崩溃。fast-tags 有自己的解析器，这意味着它没有这些问题，但也更容易解析丢失标签或提供虚假标签的错误。

正如您所注意到的，gasbag（和 htags）使用 haskell-src，这意味着它们仅适用于 Haskell 98。

免责声明：如果 TAGS 你的意思是 emacs 标签，fast-tags 还没有做这些，但如果有人关心它会很容易添加。

# sprite - 在指南针精灵中组合类选择器？

> ID：10058412
> 
> 赞同：0
> 
> 时间：2012-04-07T21:10:21.213
> 
> 标签：sprite, compass-sass

我的 icon.scss 中有这样的东西：

> $icn-sprite-base-class: ".icn";
> @import "icn/*.png";
> @include all-icn-sprites；
> 
> .blue-bullet li { @include icn-sprite(blue-dot); }

最后一条语句的灵感来自[http://compass-style.org/help/tutorials/spriting/](http://compass-style.org/help/tutorials/spriting/)中的“选择器控件” 。这将在我的 icons.css 中为我提供这种输出：

> .icn, .icn-delete, .icn-key, .icn-blue-dot .blue-bullet li { background: url('/images/icn-s55e477a40b.png') 不重复；}
> 
> .icn-blue-dot { 背景位置：0 -120px; }
> 
> .blue-bullet li { 背景位置：0 -120px; }
> ...

如您所见，*蓝点*得到了它的背景位置，*蓝*点也得到了它的背景位置。两者都具有相同的背景位置。如预期。但是有可能将这些职位结合起来吗？假设我有更多的“特殊选择器”，那么我的 CSS 就太大了。所以必须有一个组合相同背景位置的解决方案。我错过了什么？

所以我喜欢最终得到类似的东西：

> .icn-blue-dot,
> .blue-bullet li {
> 背景位置：0 -120px;
> }

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T12:57:28.813

代替

> .blue-bullet li { @include icn-sprite(blue-dot); }

您可以使用

```
.blue-bullet li
{
    @extend .icn-blue-dot;
} 
```

# c# - 通过 Sync Framework 同步本地 sdf 和 SQL Server 的数据

> ID：10058414
> 
> 赞同：0
> 
> 时间：2012-04-07T21:10:30.163
> 
> 标签：c#, sql-server-2008, windows-phone-7, sql-server-ce, microsoft-sync-framework

我有一个 Windows phone 7 应用程序，它使用本地存储文件 ( `.sdf`) 来保存数据。我需要将该数据与 SQL Server 数据库同步，以便也可以从网站上查看和编辑它们。

我已经检查了 Sync Framework 中的示例，但我的问题是没有示例使用`.sdf`文件来同步数据。

windows phone 上本地数据库的 ViewModel 也是这样的：

```
public class ADataContext : DataContext
{
            // Pass the connection string to the base class.
            public ADataContext (string connectionString)
                : base(connectionString)
            { }

            // Specify a table for the lists
            public Table<Lists> Lists;

        }

        [Index(Columns = "ListName", Name = "_listNameUnique", IsUnique = true)]
        [Table]
        public class Lists : INotifyPropertyChanged, INotifyPropertyChanging
        {

            // Define ID: private field, public property, and database column.
            private int _id;

            [Column(DbType = "INT NOT NULL IDENTITY", IsDbGenerated = true, IsPrimaryKey = true)]
            public int Id
            {
                get { return _id; }
                set
                {
                    NotifyPropertyChanging("Id");
                    _id = value;
                    NotifyPropertyChanged("Id");
                }
            }
} 
```

有没有办法`.sdf`使用 Sync Framework 将此本地数据库 ( ) 与 SQL Server 数据库中的匹配表同步，还是我必须手动进行同步？

如果我必须手动完成，那么优化的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T01:17:00.667

你看过[Sync Framework Toolkit](http://code.msdn.microsoft.com/Sync-Framework-Toolkit-4dc10f0e)吗？我认为在 WM6.5 下有 2 个 SDF 示例提供程序可与 SQL CE 一起使用，并且您可以对其进行改造以使用 WP7。

或者，如果您想自己编写代码，请查看此处的方法：[Synchronizing Data between the Phone and the Cloud](http://msdn.microsoft.com/en-us/library/hh821017.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T07:46:17.780

据我所知，MS Sync Framework 的当前版本不支持手机上的 SQL Server CE 4。

所以你现在可能只能靠自己了——查看[Erik EJ 的 Everything SQL Server Compact](http://erikej.blogspot.com/)站点——他有大量的好材料、代码示例、工具等等。

他还有一个[专门针对 Windows 手机上的 SQL Server CE 的页面](http://erikej.blogspot.com/2011/07/windows-phone-sql-server-compact.html)。

# php - PHP SoapClient 代码补全

> ID：10058417
> 
> 赞同：2
> 
> 时间：2012-04-07T21:10:48.467
> 
> 标签：php, soap

让我们想象一段在 PHP 中使用 SoapClient 的标准代码：

```
$client = new SoapClient(/* arguments here */);
$result1 = $client->invokeSomeApiMethod($arg1, $arg2);
$result2 = $client->invokeSomeOtherApiMethod($arg3); 
```

我想知道，有没有办法将特定服务的 API 指定给 IDE（我正在使用 PhpStorm）以获得代码完成、基本参数验证等，以便 IDE 知道 invokeSomeApiMethod 确实存在对于这个特定的 SoapClient 实例，它接受一些参数列表。

我目前看到的唯一方法是声明一个类，其接口将对应于 Web 服务的 API，并为 SoapClient 实例创建一个注释：

```
class SomeApi extends SoapClient
{
    public function invokeSomeApiMethod($arg1, $arg2)
    {
    }

    public function invokeSomeOtherApiMethod($arg3, $arg4 = null)
    {
    }
}

/** @var SomeApi $client */
$client = new SoapClient(/* arguments here */); 
```

但对我来说，这看起来很奇怪。也许你们中的一些人使用任何其他方法？

# ios - 单元测试运行期间的 XCode 请求焦点

> ID：10058418
> 
> 赞同：1
> 
> 时间：2012-04-07T21:10:50.147
> 
> 标签：ios, unit-testing, xcode4

有人知道在运行 iOS 单元测试时如何将窗口焦点转移回 Xcode 吗？（我想这对 Mac 开发人员来说不是什么大问题。）让 Simulator 窗口覆盖我的整个 Xcode 项目，我感到非常恼火！它甚至不应该首先出现，但那是另一回事。在我有一台 27 英寸显示器的情况下，这在工作中并不是什么大问题。

# python - 获取多维元组的最大长度

> ID：10058421
> 
> 赞同：11
> 
> 时间：2012-04-07T21:11:12.800
> 
> 标签：python, tuples, variable-length

我的元组看起来像这样（对于一组特定的生成值）

```
tTrains = [ (3, ), (1, 3), (6, 8), (4, 6, 8, 9), (2, 4) ] 
```

现在，我需要找到这个元组/列表中最长元组的长度。我总是可以使用 for 循环，遍历所有子元组并执行此操作。但我想问一下是否有相同的预定义功能。

## 当前使用情况

这是我现在要使用的

```
max = 0
for i in range( len(tTrains) ):
  if iMax < len( i ):
    iMax = len( i ) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-07T21:17:12.677

```
tup=[ (3, ), (1, 3), (6, 8), (4, 6, 8, 9), (2, 4) ]
max(map(len,tup)) 
```

结果：

```
4 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-07T21:14:18.497

您不应该将`max`其用作变量名，因为这会影响同名的内置函数。这个内置`max()`函数可用于计算可迭代的最大值。

您当前有一个元组列表，但您想要列表长度的最大值。要获取此列表，您可以使用列表推导：

```
[len(t) for t in tuples] 
```

（请注意，我将您的列表重命名`tuple`为`tuples`，因为`tuple`会隐藏同名的内置类型。）

现在您可以应用`max()`到这个列表，甚至更好地应用到以类似方式构造的生成器表达式。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-07T22:16:54.477

另一种解决方案：

```
>>> tup=[ (3, ), (1, 3), (6, 8), (4, 6, 8, 9), (2, 4) ]
>>> len(max(tup, key=len))
4 
```

这意味着“给我 的最大元素的长度`tup`，其中“最大”由元素的长度定义”。

# java - 为 php 网站使用 Javabackend？

> ID：10058422
> 
> 赞同：0
> 
> 时间：2012-04-07T21:11:22.663
> 
> 标签：java, php, html, jsp, webserver

我阅读了很多文章和 stackover flow 问题，讨论是否使用 JSP 作为网站的后端。但是我仍然对它的工作原理以及您需要什么样的服务器感到困惑。目前我正在使用 3owl.com，因为它有免费托管和无限空间（我强烈推荐它）！我现在用php来编码，但是php中的很多功能都比较有限。这是java中的程序：

我想在 javaback 端使用这段代码。所以这是我的问题：像这样的 java 代码可以直接转换为 JSP 或某种 java 后端吗？与普通的 java 应用程序相比，jsp 的限制是什么？3owl 能用吗，还是有什么我可以免费使用的东西可以让我使用 java 后端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:15:45.990

你需要的是一个`PHP/JAVA Bridge`有这么多的例子，但我只会给出 3

**使用默认值`PHP / Java Integration`**

有关完整文档，请参阅[http://php.net/manual/en/book.java.php](http://php.net/manual/en/book.java.php)

例子

```
$frame  = new Java('java.awt.Frame', 'PHP');
$button = new Java('java.awt.Button', 'Hello Java World!');

$frame->add('North', $button);
$frame->validate();
$frame->pack();
$frame->visible = True;

$thread = new Java('java.lang.Thread');
$thread->sleep(10000);

$frame->dispose(); 
```

**使用`3rd Party Lib`**

例子

[http://acet.rdg.ac.uk/projects/vre/jbridgeinst.php](http://acet.rdg.ac.uk/projects/vre/jbridgeinst.php)

[http://php-java-bridge.sourceforge.net/pjb/](http://php-java-bridge.sourceforge.net/pjb/)

**使用`FOP`**

有关更多信息，请参阅[http://wiki.apache.org/xmlgraphics-fop/HowTo/PHPJavaBridge](http://wiki.apache.org/xmlgraphics-fop/HowTo/PHPJavaBridge)

# java - 如何动态创建一个带有 n 行的摇摆列表，其中每行我放 2 个数据

> ID：10058426
> 
> 赞同：1
> 
> 时间：2012-04-07T21:11:48.420
> 
> 标签：java, swing

我对 Java Swing 的经验较少，我想创建一个动态列表，其中必须为每个元素指定 2 个参数。

我有 n 个元素，其中数字 n 未知并且取决于其他程序...

我希望对于 n 个元素，swing GUI 显示 n 行，其中左侧的每一行都有 2 个框用于设置参数 String id 和 int time。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T21:14:30.573

如何使用具有两列的[JTable](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTable.html)，每个数据值一列？

有一个很好的使用表格的教程： http: [//docs.oracle.com/javase/tutorial/uiswing/components/table.html](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)

![来自 docs.oracle.com 的 JTable 示例](../Images/61a04647820bf9b58bca71907f38e0ec.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:17:33.600

通过使用 ArrayList，您可以：

```
import java.util.ArrayList;

public class ArrayList2d<Type>
{
ArrayList<ArrayList<Type>>  array;

public ArrayList2d()
{
    array = new ArrayList<ArrayList<Type>>();
}

public void ensureCapacity(int num)
{
    array.ensureCapacity(num);
}

public void ensureCapacity(int row, int num)
{
    ensureCapacity(row);
    while (row < getNumRows())
    {
        array.add(new ArrayList<Type>());
    }
    array.get(row).ensureCapacity(num);
}

public void Add(Type data, int row)
{
    ensureCapacity(row);
    while(row >= getNumRows())
    {
        array.add(new ArrayList<Type>());
    }
    array.get(row).add(data);
}

public Type get(int row, int col)
{
    return array.get(row).get(col);
}

public void set(int row, int col, Type data)
{
    array.get(row).set(col,data);
}

public void remove(int row, int col)
{
    array.get(row).remove(col);
}

public boolean contains(Type data)
{
    for (int i = 0; i < array.size(); i++)
    {
        if (array.get(i).contains(data))
        {
            return true;
        }
    }
    return false;
}

public int getNumRows()
{
    return array.size();
}

public int getNumCols(int row)
{
    return array.get(row).size();
}
} 
```

# android - 将位置发送到设备崩溃应用程序（android）

> ID：10058431
> 
> 赞同：0
> 
> 时间：2012-04-07T21:12:14.093
> 
> 标签：android

我只是想在地图上显示用户位置，我对 android 开发非常陌生，但我有 java 基础。

基本上，我从 Eclipse（lang/long co-ords）发送模拟数据，一旦发送了这些数据，我的应用程序就会崩溃，并出现以下情况：

```
 04-07 21:07:52.252: E/AndroidRuntime(639): FATAL EXCEPTION: main
04-07 21:07:52.252: E/AndroidRuntime(639): java.lang.NullPointerException
04-07 21:07:52.252: E/AndroidRuntime(639):  at com.herghost.bmad.BMAD$1.onLocationChanged(BMAD.java:60)
04-07 21:07:52.252: E/AndroidRuntime(639):  at android.location.LocationManager$ListenerTransport._handleMessage(LocationManager.java:227)
04-07 21:07:52.252: E/AndroidRuntime(639):  at android.location.LocationManager$ListenerTransport.access$000(LocationManager.java:160)
04-07 21:07:52.252: E/AndroidRuntime(639):  at android.location.LocationManager$ListenerTransport$1.handleMessage(LocationManager.java:176)
04-07 21:07:52.252: E/AndroidRuntime(639):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-07 21:07:52.252: E/AndroidRuntime(639):  at android.os.Looper.loop(Looper.java:137)
04-07 21:07:52.252: E/AndroidRuntime(639):  at android.app.ActivityThread.main(ActivityThread.java:4424)
04-07 21:07:52.252: E/AndroidRuntime(639):  at java.lang.reflect.Method.invokeNative(Native Method)
04-07 21:07:52.252: E/AndroidRuntime(639):  at java.lang.reflect.Method.invoke(Method.java:511)
04-07 21:07:52.252: E/AndroidRuntime(639):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
04-07 21:07:52.252: E/AndroidRuntime(639):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
04-07 21:07:52.252: E/AndroidRuntime(639):  at dalvik.system.NativeStart.main(Native Method) 
```

我的应用程序的代码是：

```
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.net.Uri;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class BMAD extends Activity {

    private LocationManager locmgr = null;
    private TextView mytext;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        locmgr = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

        final Button button = (Button)
        findViewById(R.id.launchmap);
        button.setOnClickListener(new Button.OnClickListener() 
        {
            public void onClick(View view) 
                {
                    try 
                        {
                            LocationManager address = locmgr;
                            Intent geoIntent = new Intent
                            (android.content.Intent.ACTION_VIEW,
                            Uri.parse("geo:0,0?q=" + address));
                            startActivity(geoIntent);
                        } 
                    catch (Exception e) 
                        {

                        }
                }

        });}
//Start a location listener
LocationListener onLocationChange=new LocationListener() {
    public void onLocationChanged(Location loc) {
        //sets and displays the lat/long when a location is provided
        String latlong = "Lat: " + loc.getLatitude() + " Long: " + loc.getLongitude();   
        mytext.setText(latlong);
    }

    public void onProviderDisabled(String provider) {
    // required for interface, not used
    }

    public void onProviderEnabled(String provider) {
    // required for interface, not used
    }

    public void onStatusChanged(String provider, int status,
    Bundle extras) {
    // required for interface, not used
    }
};

//pauses listener while app is inactive
@Override
public void onPause() {
    super.onPause();
    locmgr.removeUpdates(onLocationChange);
}

//reactivates listener when app is resumed
@Override
public void onResume() {
    super.onResume();
    locmgr.requestLocationUpdates(LocationManager.GPS_PROVIDER,0,10000.0f,onLocationChange);
}
} 
```

谁能引导我找到造成这种情况的原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:26:19.317

您不初始化 mytext 变量。它会导致代码第 60 行出现 NPE `mytext.setText(latlong);`。

`mytext = findViewById(R.id.mytext);`你应该在你的`onCreate()`方法中做类似的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:26:24.637

嗯....您在 UI 中需要一个名为 MapView .... `mapView = (MapView) findViewById(R.id.mapview);` 但要使用您的 GeoPossition，这更容易，您也可以使用指南针 :)

```
/**************** onCreate *******************/

private MyLocationOverlay myLocationOverlay = null;

myLocationOverlay = new MyLocationOverlay(this, mapView);
try {
    myLocationOverlay.enableCompass();
    myLocationOverlay.enableMyLocation();
} catch (Exception e) {
    // TODO: handle exception
    Log.e("Activar brujula, localizacion LocationOverlay", e.getMessage());
}
mapView.getOverlays().add(myLocationOverlay);

/********************** onCreate end ***********************/

@Override
protected void onResume() {
    // TODO Auto-generated method stub
    super.onResume();
    // activamos la brujula y la localizacion
    myLocationOverlay.enableMyLocation();
    myLocationOverlay.enableCompass();
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    // desactivamos la brujula y la localizacion
    myLocationOverlay.disableMyLocation();
    myLocationOverlay.disableCompass();
}
/*//////////////////////////////////////////////////////////////////////////*/ 
```

干杯！，

例子;) || / [示例 MapView 项目](http://developer.android.com/guide/tutorials/views/hello-mapview.html)

# ruby-on-rails - Rails 3 / Heroku / Memcached - Miss / Miss,store / Fresh

> ID：10058433
> 
> 赞同：3
> 
> 时间：2012-04-07T21:12:42.413
> 
> 标签：ruby-on-rails, performance, caching, heroku, memcached

下午好，

我在 Heroku 应用程序中很好地设置了 Memcached。但是，有一些奇怪的行为让我怀疑我是否正确设置了它。

当我访问我的应用程序中的页面（使用 caches_page 设置）时，我会错过，然后错过/存储，然后是新鲜的。我觉得第一个打击应该是错过/商店......

这就是我的意思。第一次访问：

```
2012-04-07T21:07:11+00:00 app[web.1]: Started GET "/help" for xx.xx.xx.xx at 2012-04-07 21:07:11 +0000
2012-04-07T21:07:11+00:00 app[web.1]: cache: [GET /help] miss 
```

第二次访问：

```
2012-04-07T21:07:16+00:00 app[web.1]: cache: [GET /help] miss, store 
```

第三次访问：

```
2012-04-07T21:07:19+00:00 app[web.1]: cache: [GET /help] fresh 
```

我不确定这是否真的是一个问题，或者我是否应该走我的快乐之路。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-20T21:51:37.767

对于与缓存有关的任何事情，首先要做的始终是检查响应标头（您可以为此使用浏览器开发工具）。

我的猜测是第一个请求为 rails 会话返回了一个 set-cookie 标头，这导致机架缓存将响应视为不可缓存，这是有充分理由的。后续请求不会返回 set-cookie，因为已经存在会话，并且机架缓存会存储它。第三个请求命中先前缓存的内容。

# javascript - 我想在我的 window.open 中使用 CSS 从 javascript

> ID：10058436
> 
> 赞同：0
> 
> 时间：2012-04-07T21:12:55.847
> 
> 标签：javascript, css

我想将 css 放入我的 javascript 中。我有一个单独的 css 样式表和单独的 javascript 样式表，它们在 index.html 中引用

基本上在我的 jscript 中我有一个

```
myWin=window.open("","errors","width=550,height=400"); // Pop Up the window 
```

它在其中显示信息，例如

```
//Error to be displayed

 if ()
 {
errMessages += " <li>Cannot start with a hyphen (-) or apostrophe (').</li>\n";   
errMessages += " <li>ex: O'Brian or Sen-lu</li>\n"
 } 
```

我想为弹出窗口背景着色，并为错误应用一种颜色，为示例应用一种颜色。

我试过链接 `href='mycss.ss' rel='stylesheet' type='text/css'`

在外部 jscript.js 文件中

然后尝试使用

```
li class='b1' and li class='b2' 
```

（b1 和 b2 具有所需的 css 编码）

但没有结果。

有什么建议么？

# ruby-on-rails - 如何处理存储在数据库中的数据的翻译？

> ID：10058437
> 
> 赞同：0
> 
> 时间：2012-04-07T21:12:57.617
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, internationalization, translation

我正在使用 Ruby on Rails 3.2.2 和 I18n 0.6.0 gem。我想对存储在数据库中的一些数据进行国际化。也就是说，我有一个带有列（属性）的`articles`数据库表（与一个`Article`类相关） `title`，`description`我想通过关注整个系统的性能和搜索功能来处理翻译问题。

**我怎样才能做到这一点？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:15:32.677

这个最近的 railscast 可以帮助你：

[http://railscasts.com/episodes/338-globalize3](http://railscasts.com/episodes/338-globalize3)

# java - 从 Netbeans Web 服务登录到文件

> ID：10058439
> 
> 赞同：0
> 
> 时间：2012-04-07T21:13:01.367
> 
> 标签：java, web-services, netbeans, logging, filehandler

我想做一些简单的日志记录，我在这里缺少什么？

我只想尽可能简单地记录它（现在）。此代码似乎有效，但在 Web 服务上无效！

```
@WebMethod(operationName = "xyz")
public boolean xyz(@WebParam(name = "entityID") final int entityID throws IOException {

    FileHandler fh = new FileHandler("SISlog.txt", true);
    fh.setFormatter(new SimpleFormatter());
    fh.setLevel(Level.FINEST);

    Logger rootLogger = Logger.getLogger("");
    rootLogger.addHandler(fh);
    rootLogger.setLevel(Level.FINEST);

    rootLogger.log(Level.SEVERE, "auiuuuuuuuuuuuuuuuuu");

    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T08:57:30.247

You cannot rely on relative paths running inside a webcontainer. Try with an absolute path - like `/tmp/SISlog.txt`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:22:48.603

尝试将使用记录器的类的超类的名称放入 getLogger

# asp.net - 如何在 gridview 控件的项目模板中显示列表视图。

> ID：10058443
> 
> 赞同：5
> 
> 时间：2012-04-07T21:13:19.927
> 
> 标签：asp.net, listview, gridview

如何在 gridview 控件的项目模板中显示列表视图。
gridview 将列出 table_bill 中的所有 bill_id，列表视图将绑定 table_bill_details 中具有特定 item_bill_id 的所有 item_id 和数量。
table_bill 模式

*   bill_id（主键）*   账单日期*   bill_customer_id（该表的外键，Origin表为table_customer）

table_bill_details 架构

*   item_id（主键）*   数量*   item_bill_id（该表的外键，Origin表为table_bill）
我需要在用户界面中，如下图所示

![这是我在用户界面中需要的](../Images/63b11f253a7a0abb65f896eae25f1954.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-08T05:46:01.597

终于我得到了答案。只需按以下方式进行...

在 .aspx 文件中

* * *

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" OnRowDataBound="GridView1_RowDataBound">
        <Columns> 
            <asp:TemplateField>
                <ItemStyle BackColor="#C2D88B" Width="250px" />
                <ItemTemplate>
                    <div class="id">
                        <asp:Label ID="Label3" runat="server" Text='<%# Eval("bill_id") %>' ></asp:Label>
                    </div>
                    <div class="ex">
                        <p>
                            <asp:ListView ID="ListView1" runat="server">
                                <ItemTemplate>
                                    <asp:Label ID="Label1" runat="server" Text='<%# Eval("item_id") %>'></asp:Label>
                                    <asp:Label ID="Label2" runat="server" Text='<%# Eval("quantity") %>'></asp:Label>
                                </ItemTemplate>
                                <ItemSeparatorTemplate>
                                <br />                                        
                                </ItemSeparatorTemplate>
                            </asp:ListView>
                        </p>
                    </div>
                </ItemTemplate>
            </asp:TemplateField>                 
        </Columns>
    </asp:GridView> 
```

* * *

在 aspx.cs 文件上

* * *

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        DataSet ds = new DataSet();
        DataTable bill = new DataTable();
        bill.TableName = "cc";

        DataTable details = new DataTable();
        details.TableName = "ii";

        //Run necesserry commands to fill cc with values from table_bill & ii with values from table_bill_details

        ds.Tables.Add(catogory);
        ds.Tables.Add(item);
        DataRelation rel = new DataRelation("test", ds.Tables["cc"].Columns["bill_id"], ds.Tables["ii"].Columns["bill_id"]);
        ds.Relations.Add(rel);
        this.GridView1.DataSource = ds.Tables["cc"];
        GridView1.DataBind();
    }
}
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        ListView inner = e.Row.FindControl("ListView1") as ListView;
        DataRowView drv = e.Row.DataItem as DataRowView;
        DataRow[] rows = drv.Row.GetChildRows("test");
        ArrayList lst = new ArrayList();
        for (int i = 0; i < rows.Length; i++)
        {
            Item ii = new Item(rows[i][2].ToString(), rows[i][1].ToString(), rows[i][0].ToString());
            lst.Add(ii);
        }

        inner.DataSource = lst;
        inner.DataBind();

        //drv.Row.

    }
}

class Item
{
    string quantity;

    public string Quantity
    {
        get { return quantity;}
        set { quantity = value; }
    }
    string item_id;

    public string Bill_id
    {
        get { return item_id;}
        set { item_id = value; }
    }
    string bill_id;

    public string Bill_id
    {
        get { return bill_id;}
        set { bill_id = value; }
    }

    public Item(string quantity, string bill_id)
    {
        this.quantity = quantity;
        this.item_id = item_id;
        this.bill_id = bill_id;
    }

} 
```

* * *

这就是我想要的。感谢大家。

# ruby-on-rails - 当需要应用于整个应用程序时，如何不在每个控制器中重复“before_filter”代码？

> ID：10058444
> 
> 赞同：3
> 
> 时间：2012-04-07T21:13:36.877
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想在生产时将所有控制器的所有站点流量重定向到 https。可能使用如下内容：

```
before_filter :redirect_to_https 
```

在控制器中使用以下内容：

```
 def redirect_to_https
    redirect_to :protocol => "https://" unless (request.ssl? || local_request? || Rails.env.development? || Rails.env.staging? ) # probably don't need redundant development with `local_request` present
  end 
```

将其应用于所有控制器而不是必须在每个控制器中重复此操作的最有效方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T21:17:36.480

`config.force_ssl = true`在您的环境/production.rb 配置文件中使用。

如果你想让 before_filter 应用于所有控制器，它们都继承自 ApplicationController 所以把它放在那里。

# php - 具有多个值的 PHP PDO-MySQL 准备好的语句

> ID：10058453
> 
> 赞同：0
> 
> 时间：2012-04-07T21:14:49.823
> 
> 标签：php, mysql, pdo, prepared-statement

我知道您不能使用 " 字符，但尝试了 ` 却没有用，有什么想法吗？

```
$sql = $db->prepare('INSERT INTO testDB VALUES(`$title`,`$bodytext`,`$created`)'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:19:37.620

尝试这个：

```
$sql = $db->prepare('INSERT INTO testDB VALUES(?, ?, ?)');
$sql->execute(array($title, $bodytext, $created)); 
```

我所做的是从 SQl 查询中删除变量并将它们替换`?`为占位符。您仅在执行时将值绑定到语句。

您尝试执行此操作的方式与使用常规 SQL 查询没有什么不同。

# yii - 通过 htmlOptions 在 CGridView 中添加动态 css 值

> ID：10058455
> 
> 赞同：1
> 
> 时间：2012-04-07T21:15:07.310
> 
> 标签：yii

尝试将动态类值添加到我在 CGridView 中的列之一：

```
'htmlOptions'=>array('class'=>'button-column $data->team'), 
```

然而，无论如何，该类只是以“$data->team”的形式出现以实现这一目标？某种 eval 调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:40:02.273

你可以这样做：

```
'cssClassExpression'=>'$data->team',
'htmlOptions'=>array('class'=>'button-column'), 
```

**编辑：（**只是多一点解释）

根据以下特殊变量的文档[可用](http://www.yiiframework.com/doc/api/1.1/CGridColumn#cssClassExpression-detail "http://www.yiiframework.com/doc/api/1.1/CGridColumn#cssClassExpression-detail")`cssClassExpression`：（强调我的）

> 变量**$row**行号（从零开始）；**$data**该行的数据模型；和**$this**列对象。

我什至会说，只要文档中没有提到任何特殊变量，我们就可以假设我们很可能不能在那里使用它们（例如 的情况`htmlOptions`）。

# javascript - 试图创建一个简单的文本到 ascii 转换器

> ID：10058456
> 
> 赞同：0
> 
> 时间：2012-04-07T21:15:11.947
> 
> 标签：javascript, forms, events, button

我有一个 HTML 表单：

```
<html>
<body>
<form>
<textarea></textarea>
<input type="button" value="Submit" onclick="????"></input>
</form>
<script type="text/javascript">
var code, chr = 'here';
code = chr.charCodeAt(0);
document.write("The ASCII code of " + chr +" is "+code);
</script>
</body>
</html> 
```

我试图有一个文本区域，用户/我将在其中放置他的文本（单个字母）和一个他将单击以触发此事件的按钮。

现在的问题是如何使提交按钮将文本区域中的任何内容提交到：

```
var code, chr = '`here`'; 
```

如果需要其他数据，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T12:15:41.647

试试这个，在 osx Safari 上制作：

```
<html>
<body>

<form>
ASCII:<br>
<textarea id="text" rows="8" cols="50"></textarea><br>
<input type="button" value="Convert" onclick="asciify()">
<br>
<hr>
DEC:<br>
<textarea id="output" rows="8" cols="50"></textarea>
</form>

<script type="text/javascript">
function asciify(){
      var ih = document.getElementById("text").value;
      var out = "";
      for(var i = 0; i < ih.length; i++){
         out=out.concat("<",ih.charAt(i).charCodeAt(0),">");
      }
  document.getElementById('output').innerHTML = out;
}
</script>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T02:49:48.047

如果我了解您要查找的内容，您需要一个 ascii 转换输入的函数，并且您需要从按钮中调用它。

我建议使用类似下面的方法，因为来自按钮的调用都是相对的，你可以在一个页面上有 15 个这样的表单，它们都可以工作，而且你的实际翻译方法保持简单和离散。

尽管使用如此简单的东西，您可以直接将其放入内联。

```
<html>
<body>
<script type="text/javascript">
function asciify(txt) {
    return = txt.charCodeAt(0);
}
</script>
<form>
<textarea name="txt_input"></textarea>
<input type="button" value="Submit" onclick="this.form.txt_output.value = asciify(this.form.txt_input.value)"></input>
<textarea name="txt_output"></textarea>
</form>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T23:57:36.217

```
<html>
<body>
<form>
<textarea id="text"></textarea>
<input type="button" value="Submit" id="subm"/>
<div id="out"></div>
</form>
<script type="text/javascript">
document.getElementById("subm").addEventListener("click", asciify, false);
function asciify(){
    var ih = document.getElementById("text").innerHTML;
    var out = [];
    for(var i = 0; i < ih.length; i++){
        out.push(ih.charCodeAt(i));
    }
    document.getElementById("out").innerHTML = out.join(",")
}
</script>
</body>
</html> 
```

这使用 javascript 添加 onclick 处理程序，并支持多个字符

# c# - 在数据网格中标记行的最简单方法

> ID：10058457
> 
> 赞同：0
> 
> 时间：2012-04-07T21:15:23.753
> 
> 标签：c#, xml, datagrid, dataset, datagridrowheader

我有一个读取 xml WebResponse 的数据集，然后我从该数据集中提取和合并表我如何将 7 个硬编码标签添加到合并表中以显示在数据网格中，标签始终是相同的值，并且顺序将始终是相同的。

我想为了方便起见，我想在表格中添加 7 行标题？与数据网格一起显示。

我试过的

```
 WebRequest req = WebRequest.Create(m_uri);
        WebResponse rsp;
        req.Method = "POST";
        req.ContentType = "text/xml";
        StreamWriter writer = new StreamWriter(req.GetRequestStream());
        writer.WriteLine(buildXml().ToString());
        writer.Close();
        rsp = req.GetResponse();

        //Get the Posted Data
        StreamReader reader = new StreamReader(rsp.GetResponseStream());
        string rawXml = reader.ReadToEnd();
        XmlDocument xml = new XmlDocument();
        xml.LoadXml(rawXml);

        //Use XPath to Navigate the Document
        int status = Convert.ToInt32(xml.SelectSingleNode(@"/RatingServiceSelectionResponse/Response/ResponseStatusCode").InnerText);
        if (status == 1)
        {

            StringReader srxml = new StringReader(rawXml);

            DataSet dsAuthors = new DataSet("RatedShipment");
            dsAuthors.ReadXml(srxml);

            dsAuthors.EnforceConstraints = false;

            DataTable Shipment = dsAuthors.Tables[2];
            DataTable TotalCharges = dsAuthors.Tables[8];
            DataTable table = new DataTable("UPS Service");

            Shipment.Merge(TotalCharges);
            Shipment.Columns.Remove("RatedShipmentWarning");
            Shipment.Columns.Remove("CurrencyCode");
            Shipment.Rows.RemoveAt(7);
            DataColumn UPSService = new DataColumn();
            UPSService.DataType = typeof(string); 
            UPSService.ColumnName = "UPS Service";
            Shipment.Columns.Add(UPSService);
            Shipment.Rows[0].Cells[0].Value = "UPS Ground";
            Shipment.Rows[1].Cells[0].Value = "UPS Three Day";
            Shipment.Rows[2].Cells[0].Value = "UPS Second Day A.M.";
            Shipment.Rows[3].Cells[0].Value = "UPS Second Day";
            Shipment.Rows[6].Cells[0].Value = "UPS Next Day Air Saver";
            Shipment.Rows[4].Cells[0].Value = "UPS Next Day Air Early A.M.";
            Shipment.Rows[5].Cells[0].Value = "UPS Next Day Air";

        dataGridView1.DataSource = Shipment;

        }
        else
        {
            MessageBox.Show("Unable To Process: Please Check All Fields Are Entered");
        } 
```

但是行后的单元格不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:57:01.980

然后你必须这样做：

```
foreach (DataGridViewRow row in datagrid.Rows) {
    row.Cells(0).Value = "yourtext";
} 
```

# javascript - 如何绑定动态表单？

> ID：10058464
> 
> 赞同：0
> 
> 时间：2012-04-07T21:16:30.447
> 
> 标签：javascript, jquery, html, ajax, bind

我在使用 HTML 中动态创建的表单时遇到了一些问题。我一直在使用 JQuery 1.7 以 ajax 的形式显示复选框。稍后，我想在表单中使用这些复选框，但我似乎无法检索这些值。我读到它们没有绑定或类似的东西，并使用 .live() 或 .on() 函数。在阅读了 .on 和 /live 函数的 api 之后，我真的不知道下一步该做什么。

```
<!-- Tabbed Menu Options -->
<script type="text/javascript">
$(document).ready(function(){
    $('#cowList').load("../php/populateTabsCows.php");
    $('#ranchList').load("../php/populateTabsRanch.php");

      return false;
});
</script> 
```

然后我正在阅读表格并使用：

```
$(function() {  
  $("#submitForm").click(function() {  
    // validate and process form here  

       var data = $('#filterForm').serialize();
       alert(data.toString());
    $.post('../php/filter.php', data)
        .success(function(result){
            $('#cowinfo').html(result);
        })
        .error(function(){
            console.log('Error loading page');
        })
    return false;
  });
    return false;   

  }); 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T15:54:44.303

jQuery 的 .on() / .click() / .submit() / 等函数的工作方式与 .live() 不同。在将目标 HTML 元素添加到 DOM 之后，您必须调用 .on()。

这进一步解释了这两个函数之间的区别： [http ://www.jquery4u.com/jquery-functions/on-vs-live-review/#.T7UfLuvgjkp](http://www.jquery4u.com/jquery-functions/on-vs-live-review/#.T7UfLuvgjkp)

# jquery - 如何在 jquery 函数中访问 $(this)？

> ID：10058465
> 
> 赞同：0
> 
> 时间：2012-04-07T21:16:47.850
> 
> 标签：jquery, this

我有以下点击事件

```
$(".element").click(function() {
    var idNum = $(this).getID;
    $('#new-'+idNum).fadeIn();      
}); 
```

和以下功能：

```
function getID() {
    var elID = $(this).parent().attr('id');
    return elID;
} 
```

我想要的是能够单击`.element`，获取它的父 ID，然后将该 ID 存储在变量中`idNum`。但这似乎不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:20:35.170

与其在另一个函数中执行此代码，不如在同一个函数中执行此代码？

```
$(".element").click(function() {
    var idNum = $(this).parent().attr('id');
    $('#new-'+idNum).fadeIn();  

    getID(idNum);   
});

function getID(idNum) {
    var newObject = $(body).find(idNum);
    //Do stuff with newObject
} 
```

由于您不能原生传递 $(this) （它是 jQuery 内置的一个对象），您可以改为搜索 DOM 是否存在您传递的变量（就像上面的代码一样）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:19:28.517

为什么你需要一个额外的功能呢？做就是了：

```
$(".element").click(function() {
    var idNum = $(this).parent().attr('id');
    $('#new-'+idNum).fadeIn();      
}); 
```

# c# - C#/MS Access：数据库连接错误

> ID：10058467
> 
> 赞同：4
> 
> 时间：2012-04-07T21:16:54.533
> 
> 标签：c#, ms-access

我正在开发一个应用程序，该应用程序将由一小群工作人员（最多 15 人）使用，并将数据存储在 Access accdb 文件中。当我自己在一台机器上测试应用程序时，我没有任何问题，但是当至少有两个人不时连接到数据库时，应用程序会给用户带来奇怪的错误。数据库存储在网络上的共享文件夹中，每个用户的应用程序都访问该文件夹以打开 db 文件。每个用户在 db 的机器上都有自己的系统帐户，并且代码中的每个函数都会锁定其他线程对 db 的访问，因此一次总是只有一个连接打开尝试。每个连接都在同一个函数中关闭。所有 db 函数都写在一个单例类中。

我得到的错误：

```
System.Data.OleDb.OleDbException (0x80004005): Could not use 'D:\Shared\nscm\nscm_db.accdb'; file already in use.

System.Data.OleDb.OleDbException (0x80004005): Cannot open database ''.  It may not be a database that your application recognizes, or the file may be corrupt.

System.Data.OleDb.OleDbException (0x80004005): Too many active users. **(this error even when there's only two users!)** 
```

这真让我抓狂。JET4/ACE 引擎不能正确支持多用户访问是否存在问题？

我正在考虑将数据库更改为不同的数据库，例如 MS SQL Server Express 或 MySQL，但我不知道哪个最容易迁移，哪些是真正免费的。

提前感谢您的帮助和关注！

更新：数据转换对我来说不是问题。该应用程序仍在开发中，因此没有真实数据。我更担心代码和 SQL 查询的变化。而且我不确定切换到其他db技术后是否会遇到其他问题。

我真正的问题是：我是否应该继续努力纠正现有技术中的某些问题，我正在使用还是 Access db 引擎存在已知问题，浪费我的时间在这方面毫无价值，开始使用会更简单、更快捷某种数据库服务器（MySQL）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:50:34.563

你在这里如履薄冰。MSAccess 应该支持您的用户群，但在这种情况下您可以考虑迁移到不同类型的数据库。我的意思是，不是基于文件的数据库，而是客户端-服务器数据库。毕竟，如果您现在有 15 个用户，那么（希望）这个数字可能会增长，并且基于文件的数据库的问题将呈指数级增长。

如果您选择迁移，我可以说 SQLServer Express 和 MySql 都是免费的。
在你的情况下，我推荐 SQL Server Express。它的 T-SQL 语法与 JET-SQL 更兼容，但存在一些差异，尤其是在查询语法中使用 VBA 关键字时。
从代码的角度来看，我建议放弃 OleDbProvider 并开始使用 SqlServer 的本机提供程序。因此，您需要更改等效的 SqlConnection、SqlCommand 中的每个 OleDbConnection、OleDbCommand 等（如果您选择 MySql，这也是如此）。这些变化是相当机械和重复的，所以这里没有大问题。但是，您应该重新测试代码中的每个数据访问查询，以确保返回相同的结果

关于错误：

*   `Too many active users`- 这可能是由未正确关闭的连接引起的
*   `Cannot open database`- 数据库损坏或您已达到 2GB 限制？
*   `Could not use`- 检查所有用户退出应用程序后是否删除了 LDB 文件。同样，这可能是您的应用程序出现问题的症状

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:46:22.640

Mysql 是完全免费和开源的，我推荐它，因为它非常用户友好，转换部分使用这个：[http ://www.bullzip.com/products/a2m/info.php](http://www.bullzip.com/products/a2m/info.php)

# java - 使用 FFT 比较两个音频文件，然后实时比较

> ID：10058469
> 
> 赞同：2
> 
> 时间：2012-04-07T21:17:12.920
> 
> 标签：java, android, audio, fft, signals

我正在为Android制作一个应用程序，它将保存用户语音命令，然后在应用程序运行时；将来自麦克风输入的实时数据与保存的数据进行比较。到目前为止，我已经将声音保存在 wav 文件中，现在我想将其与输入流进行比较。我使用此 API 应用了 FFT，因为它与 Android 兼容：

[http://code.google.com/p/musicg/](http://code.google.com/p/musicg/)

我对这个 api 也不太了解，但我认为 FFT 数据存储在 FrequencyTimeDomainRepresentation 对象中。我在互联网上搜索，发现我必须使用一个窗口来比较数据，但是我不知道该怎么做。我不知道如何比较数据。

请告诉我如何比较 FFT 数据以及如何将保存的文件数据与输入流数据匹配，我的意思是代码。同时，我正在尝试比较两个使用 java 的音频文件，而不是现在在 android 上。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T12:46:04.997

正如评论中提到的，这是一个与 dsp 相关的问题。您应该在 dspexchange 询问详细信息。

但是给你一个快速'n'dirty的答案。准确定义您的算法应该做什么。它应该做语音识别吗？如果您只想对相似性有一个简单的度量，请使用互相关（询问谷歌）。你也不需要 FFT（FFT 似乎被过度使用了，最近。每个不知道他在做什么的人都想出了 FFT 的东西）。一旦你知道你想做什么并且你知道你真的需要它，FFT 可能会发挥作用；也许是为了应用一些心理声学模型。但即便如此，简单的 haar 变换也可能更充分、更简单、更快，尤其是在移动设备上。

# grails - Grails：创建您不想存储在数据库中的类

> ID：10058474
> 
> 赞同：4
> 
> 时间：2012-04-07T21:17:30.813
> 
> 标签：grails, groovy, web-applications, grails-domain-class

在 grails 中创建一个新的域类并且从不将任何对象持久化到数据库中，这是创建一个您不想存储在数据库中的类的最佳方式？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-07T22:56:21.867

Grails 提供了`src`开发一些实用程序类和其他工件的目录。它没有保留的`src`目录。

```
src - Supporting sources
    groovy - Other Groovy sources
    java - Other Java sources 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T16:37:40.930

`static mapWith="none"`在 grails-app/domain 文件夹中的类中定义

# java - 站点网格页面排除

> ID：10058477
> 
> 赞同：0
> 
> 时间：2012-04-07T21:17:40.620
> 
> 标签：java, sitemesh

我想从装饰中排除一组页面（使用 sitemesh 2 和 spring-mvc 3.1）。这是我的 decorators.xml：

```
<decorators defaultdir="/WEB-INF/decorators">
    <excludes>
        <pattern>/WEB-INF/view/data/tabs</pattern>
    </excludes>
    <decorator name="main" page="main.jspx">
        <pattern>/WEB-INF/view/*</pattern>
        <pattern>/*</pattern>
    </decorator>
</decorators> 
```

然后在我的页面中，我使用带有 ajax 加载页面的 jquery-ui 选项卡，如下所述：http: [//jqueryui.com/demos/tabs/#ajax](http://jqueryui.com/demos/tabs/#ajax)。所以显然我不想再次装饰标签中的内容！除了上面列出的内容之外，我已经尝试将模式放在`/WEB-INF/view/data/tabs/*`上面，但这也不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:21:47.363

我通过提供绝对路径使其工作，例如`/spring/data/tabs/*`，（web.xml 正在拦截`/spring/*`并发送到 DispatcherServlet）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:49:46.357

web.xml 是容器在​​启动 web 应用程序时读取的主要属性文件。
它将拦截点作为应用程序的起点，因此您对文件进行的每个定义都从该点开始作为相对路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-21T09:19:40.317

我有同样的问题，我通过这种方式解决了添加一个名为“no”的新装饰器：

```
<?xml version="1.0" encoding="UTF-8"?>
<decorators defaultdir="/WEB-INF/layouts/">
    <excludes>
        <pattern>/static/*</pattern>
        <pattern>/api/*</pattern>
        <pattern>/</pattern>
    </excludes>
    <decorator name="default" page="default.jsp">
        <pattern>/*</pattern>
    </decorator>
    <decorator name="no" page=""></decorator>
</decorators> 
```

并将元数据添加到您不想使用装饰器的页面中：

```
<meta name="decorator" content="no" /> 
```

# php - 获取与xml和php中某个值匹配的元素的属性

> ID：10058481
> 
> 赞同：0
> 
> 时间：2012-04-07T21:17:55.907
> 
> 标签：php, xml, api

您好我正在尝试访问包含属性 = 某个值的元素。我正在使用 Expedia API，但无法正常工作。这是我连接到 xml 文件的方式：

```
$ch = curl_init(); 
$fp = fopen('room.xml','w'); 
curl_setopt($ch, CURLOPT_URL, "http://api.ean.com/ean-services/rs/hotel/v3/info?cid=55505&minorRev=13&apiKey=4sr8d8bsn75tpcuja6ypx5g3&locale=en_US&currencyCode=USD&customerIpAddress=10.184.2.9&customerUserAgent=Mozilla/5.0+(Windows+NT+6.1)+AppleWebKit/535.11+(KHTML,+like+Gecko)+Chrome/17.0.963.79+Safari/535.11&customerSessionId=&xml=<HotelInformationRequest><hotelId>".$hid."</hotelId><options>0</options></HotelInformationRequest>");  
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Accept: application/xml'));  
curl_setopt($ch, CURLOPT_HEADER, 0); 
curl_setopt($ch, CURLOPT_FILE, $fp); 
$val = curl_exec($ch); 
curl_close($ch);//Close curl session 
fclose($fp); //Close file overwrite 
$data = simplexml_load_file('room.xml'); 
```

那么这里是一个xml响应的例子：

```
 <ns2:HotelInformationResponse xmlns:ns2="http://v3.hotel.wsapi.ean.com/" hotelId="121196">
    <customerSessionId>0ABAA871-3187-D691-3682-CC27421918AC</customerSessionId>
    <HotelSummary order="0">...</HotelSummary>
    <HotelDetails>...</HotelDetails>
    <Suppliers size="2">...</Suppliers>
    <RoomTypes size="9">
    <RoomType roomCode="17918" roomTypeId="136767">
    <description>Deluxe Sunset View</description>
    <descriptionLong>
    One king or two double beds. 38.5 meters (414 square feet). Floors 1–9\. Complimentary wireless Internet access. CD/DVD player. MP3 docking station. Complimentary newspapers. Minibar. Coffeemaker. Bathroom with shower only. Aveda toiletries. Bathrobes. Bathroom scale. Laptop-compatible safe. Turndown service.
    </descriptionLong>
    </RoomType>
    </RoomTypes> 
```

最后，这是我尝试访问它的方式：

```
<?php $dataroom = $data->RoomTypes->RoomType['@roomCode="17918"']->description; var_dump($dataroom);  ?> 
```

如您所见，我正在尝试访问 roomCode = 17918 的描述。但它不起作用！我试过使用回声和打印，但没有任何效果。var_dump 返回 NULL 的值。我不知道我做错了什么。我可以得到我想要的任何其他元素，但不是我需要它匹配的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T10:46:53.377

试试这个：

```
$dataroom = get_object_vars($data->RoomTypes->RoomType); 
if($dataroom['@attributes']['roomCode'] == 17918) echo $dataroom['description']; 
```

当然，您必须相应地添加额外的循环，但这应该可以正常工作，我只使用在线代码执行工具对其进行了测试，并且似乎可以正常工作。

您尝试的方法不是特别正确。您正在尝试将对象作为数组访问。我将对象转换为数组，然后将其作为数组访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T15:22:22.357

我想通了……谢谢大家的帮助……绝对帮助我朝着正确的方向前进！这是我解决它的方法：

```
foreach($data->RoomTypes->RoomType AS $match){
    if($match['roomCode']== "$roomCode"){
      echo $match->descriptionLong;
    }} 
```

# objective-c - xcode中项目/目标的单独设置是什么意思？

> ID：10058486
> 
> 赞同：1
> 
> 时间：2012-04-07T21:18:26.523
> 
> 标签：objective-c, ios, xcode, automatic-ref-counting

**[**曾经是 ARC 的旧问题标题**设置为 YES，但 xcode 显示 NO**，已编辑以使问题更清晰。**]**

我在 xcode 4.2.1 中有一个使用 iOS 5.0 SDK 的 iOS 项目。该项目处于版本控制之下（使用内置的 git 接口），早期提交之一是在我将项目转换为使用 ARC 之后。从那时起，所有的工作都很好，还有更多的提交等。

现在我突然注意到 xcode 中的构建设置显示相关选项（“Objective-C 自动引用计数”）设置为 NO。但是，当我直接检查项目设置文件`project.pbxproj`（通过版本控制或仅使用文本编辑器打开它）时，我看到它`CLANG_ENABLE_OBJC_ARC`设置为`YES`.

这是我应该担心的问题吗？该项目编译并运行正常。

**编辑**

正如 Dondragmer 指出的那样，项目和目标有一个单独的标志。事实上，对于该项目，它被设置为 NO，而目标是 YES。为项目/目标设置单独的标志是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T07:24:07.643

现在的问题显然是：“为项目/目标设置单独的标志意味着什么？”

除非您在一个项目中有多个目标，否则这并不重要。如果这样做，您可以在项目级别设置通用设置。（例如，基础 SDK，或者 ARC 是否打开，或者您正在使用哪个编译器。）

然后，在您的目标中，只设置少数需要不同的设置。

这样，当您确实想更改基础 SDK 或更改编译器时，您可以在一个地方完成，而不是更改每个目标。这可以使大型项目更容易处理。

# list - CSS 列中的文本溢出

> ID：10058487
> 
> 赞同：4
> 
> 时间：2012-04-07T21:18:31.233
> 
> 标签：list, css

假设我们有一个`<ol>`or`<ul>`列表，其中包含多个 CSS3 列（具有`-(vendor)-column`属性或其子属性的列）。如果`<li>`列中的最后一个太高，则其内容会溢出到下一列（[示例](http://jsfiddle.net/9MQba/2/)）。你如何阻止它溢出？我努力了

```
li {
    display: inline-block;
    vertical-align: top;
} 
```

和

```
li {
    overflow: auto;
} 
```

但他们隐藏了每个`<li>`（的`list-style-type`）左侧显示的数字。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T23:32:28.720

如果可能[的话，`column-fill`规范](http://www.w3.org/TR/css3-multicol/#cf)（顺便说一下，目前显然[没有浏览器支持](http://www.w3schools.com/cssref/css3_pr_column-fill.asp)的属性）状态似乎自动“平衡”（高度）。因此，没有简单的方法可以告诉它。

基本上，要得到你想要的，你必须“平衡”每列的行数，这[会因为额外的`<br/>`标签](http://jsfiddle.net/9MQba/16/)而变得丑陋，或者需要你[在第二个项目上设置一些底部边距](http://jsfiddle.net/9MQba/18/)以强制平衡。

# vim - 将一个选项的价值传递给另一个

> ID：10058490
> 
> 赞同：3
> 
> 时间：2012-04-07T21:19:10.983
> 
> 标签：vim

一个相当愚蠢的 Vim 问题，但我有事要做，我没有在帮助中找到解决方案。所以这里...

（这只是一个例子，我不一定只对*guifont*和*printfont*感兴趣）

```
set guifont? 
```

分发 ...

我怎么能说，

```
set printfont=guifont 
```

即将你得到的字符串传递`guifont?`给`printfont`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:22:38.210

```
let &printfont = &guifont 
```

似乎工作正常。

# c - 带有 KeyNameInformation 的 ZwQueryKey 替代 XP？

> ID：10058493
> 
> 赞同：0
> 
> 时间：2012-04-07T21:20:10.287
> 
> 标签：c, windows, callback, registry, kernel

我正在编写一个内核驱动程序，它通过 CmRegisterCallbackEx 注册注册表例程回调。我想获得关键的完整路径并通过 DbgPrint 打印出来。在回调中，我使用带有 KeyNameInformation 标志的 ZwQueryKey 成功查询了 Key 指针，但是在 KEY_NAME_INFORMATION 结构的文档中我读到：

> 在 Windows Vista 和更高版本的 Windows 操作系统中可用。

[http://msdn.microsoft.com/en-us/library/windows/hardware/ff553381(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff553381(v=vs.85).aspx)

那么有没有办法在windows xp的内核中获取完整的注册表路径？我知道这是可能的，因为 SysInternals 工具已经具有此功能，并且在 xp 中运行良好。

谢谢

更新

* * *

我刚刚尝试在 XP SP2 上使用 KeyNameInformation 标志获取密钥完整路径（如 MSDN 所述，XP 不支持此标志，请参见上面的链接），令我惊讶的是，它起作用了。任何人都知道为什么 MSDN 声明不支持此标志？这是一个简单的错误还是我误解了什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T23:35:33.700

完全有可能在补丁/内联中添加了对 KeyNameInformation 的支持。问题是，你打算在 XP SP0 上做什么？

您可能需要考虑使用 ObReferenceObjectByHandle() 从您的密钥句柄中获取 KEY 对象，然后使用 ObQueryObjectName()。

# css - 内容通过固定标题

> ID：10058498
> 
> 赞同：4
> 
> 时间：2012-04-07T21:20:47.037
> 
> 标签：css, html

在我的 html 页面中，我修复了我的标题：

```
position : fixed 
```

当我向下滚动时，我的页面内容会通过标题。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-07T21:28:34.223

假设您的 HTML 如下：

```
<div id="header">...</div>
<div id="content">...</div> 
```

试试下面的 CSS：

```
<style type="text/css">
  #header {
    position:fixed;
    z-index:1;
  }
  #content {
    position:relative;
    z-index:2;
  }
 </style> 
```

# jquery - jquery - 如何从对象对象获取属性？

> ID：10058499
> 
> 赞同：-1
> 
> 时间：2012-04-07T21:21:00.780
> 
> 标签：jquery

我的 php 类返回一个对象数组，我想调用或选择每个对象的属性。

我的 JS 看起来像这样：

```
$.get("getData.php", function(result){
            var data = jQuery.parseJSON(result);

            $.each(data, function(i, v){
                    console.log($(this).attr('myPlantCode')); 
```

...但控制台只为数组中的每个对象返回“未定义”。

我知道这一定很简单，而且我可能离我不远了……但是如何按名称调用特定属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:08:55.423

啊……我知道这是愚蠢的事情。console.log (v.Site.myPlantCode) 有效，因为 Parsed 结果给出了一个包含在对象中的对象数组。现在看看我是否可以在不不必要地解析 JSON 的情况下获取数据。

# php - 将表单输入更改为小写

> ID：10058503
> 
> 赞同：1
> 
> 时间：2012-04-07T21:21:25.047
> 
> 标签：php, forms, input, get, lowercase

我正在使用基于表单输入重定向用户的表单代码。我从这里得到它：

[php - 如何根据用户的表单输入重定向用户？](https://stackoverflow.com/questions/2641223/php-how-do-i-redirect-a-user-based-on-their-form-input)

表格：

```
<form action="index.php" method="get">
<input type="text" name="q" />
<input type="submit" />
</form> 
```

索引.php

```
header("Location: http://example.com/browse/".$_GET['q']); 
```

我遇到的问题是当用户使用 CAPS LOCK 键入时，它不会重定向它们。

一旦用户提交了输入，有什么方法可以将输入更改为小写，这将允许他们正确重定向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:39:38.843

您还可以对查询进行 url 编码，因为“#”或“:”等字符对网络浏览器具有特殊含义/功能。因此，如果用户使用了这些字符，这不会破坏您的导航。

参考：[Php Doc - urlencode()](http://php.net/manual/en/function.urlencode.php)

```
header("Location: http://example.com/browse/". urlencode($_GET['q'])); 
```

将其与上述 Marc B 的答案结合起来，将导致：

```
header("Location: http://example.com/browse/". urlencode(strtolower($_GET['q']))); 
```

要解析下一页上原始的小写用户输入，只需使用*urldecode()*：

参考：[Php Doc - urldecode()](http://php.net/manual/en/function.urldecode.php)

```
// original lower-cased query
$original_query = urldecode($path); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:22:53.023

[strtolower()](http://php.net/strtolower)：

```
header("Location: http://example.com/browse/". strtolower($_GET['q'])); 
```

# html - 仅适用于 Firefox 的不同字体大小

> ID：10058509
> 
> 赞同：4
> 
> 时间：2012-04-07T21:22:18.663
> 
> 标签：html, firefox, css, cross-browser

我只是为我的网站添加一个帐户标题，它只显示玩家用户名。

我正在使用自定义字体，它在 chrome 和 IE 上运行良好，但是对于 Firefox，它不显示自定义字体，只显示下一个可用字体，即 Verdana。我不介意，但是我的问题是 Verdana 字体比我的自定义字体小，所以如果我将它设置为 7.5pt 作为字体大小，自定义字体会出现两倍大小。无论如何我可以为Firefox设置更高的字体大小吗？

这是用户名所在的 div 的 css：

```
font-size: 7.5pt;
color: #9f1717;
text-align: center;
font-family: xirod, xirodeot, Verdana, Geneva, sans-serif; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-07T21:28:12.343

我建议要么使用 Firefox 支持的字体格式，要么使用[`font-size-adjust`](https://developer.mozilla.org/en/CSS/font-size-adjust)在不同字体系列中获得统一的大小。

您可以`font-size-adjust`通过添加以下 CSS 来使用：

```
font-size-adjust:0.5; 
```

这会将所有字体设置为具有大致相同高度的小写字符（通常，当使用不同的字体查看时，这会产生看起来更接近相同大小的文本）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-07T23:33:18.607

这有没有可能是由[跨域政策](http://dev.w3.org/csswg/css3-fonts/#same-origin-restriction)引起的？如果您将字体和/或其他静态资源存储在 CDN 或只是不同的子域上，就会出现这种情况。目前只有 FF 将其实现为规范，但我推测其他浏览器将开始采用这种行为。

将 http-header 添加到类似于 的字体文件`Access-Control-Allow-Origin: *`将解决问题 - 并且快速的谷歌搜索会产生比我在这里描述的更好的规则细节结果。

...

不是？您可以使用仅适用于某个 url 前缀的结构专门针对 Firefox - 如果您不传递前缀值，它将始终应用但只能被 FF 浏览器理解：

```
@-moz-document url-prefix() {
    .username {font-size:15pt;}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T21:29:38.397

您现在应该能够在所有浏览器中获得它。如果您的字体不受版权保护，您可以将其上传到[Font Squirrel](http://www.fontsquirrel.com/)并为您的网站创建自定义 CSS 字体嵌入解决方案。我建议你试试这个。如果这不起作用，总有[jQuery 浏览器检测解决方案](http://webhole.net/2010/07/07/browser-detection-with-jquery/)，您可以在其中加载单独的样式表。

将以下代码与该浏览器检测插件一起使用：

```
if($.browser.mozilla) {
  document.write("<style type='text/css'>body { font-size: 3.75pt; }</style>");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T13:39:35.380

使用 css 浏览器选择器，参考见[http://rafael.adm.br/css_browser_selector/](http://rafael.adm.br/css_browser_selector/)

# c++ - 模板模板参数 - 类型/值不匹配错误

> ID：10058511
> 
> 赞同：3
> 
> 时间：2012-04-07T21:22:44.657
> 
> 标签：c++, class, templates

这是一个示例代码：

```
#include <stack>
#include <cstddef>

template <std::size_t N,
         template <class> class Stack = std::stack
         >   
class Tower : protected Stack<int>
{   
    public:
        Tower() : Stack<int>(N)
        {   
        }   
};  

int main(int argc, char **argv)
{   
    Tower<5L> tower1();
} 
```

而且我看到编译器（gcc）不高兴：

```
file.cpp: In function 'int main(int, char**)':
file.cpp:18:11: error: type/value mismatch at argument 2 in template parameter 
list for 'template<long unsigned int N, template<class> class Stack> class Tower'
file.cpp:18:11: error: expected a template of type 'template<class> class Stack',
got 'template<class _Tp, class _Sequence> class std::stack'
file.cpp:18:21: error: invalid type in declaration before ';' token 
```

标准堆栈容器具有以下形式：

`template <class Type, class Container = deque<Type> > class stack`;

这意味着我应该在这里只传递一个模板参数！

关于如何解决这个问题的任何想法？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T21:31:45.580

`'template<class> class Stack', got 'template<class _Tp, class _Sequence> class std::stack'` shows the problem.

Here is what `std::stack` looks like

```
template<
    class T,
    class Container = std::deque<T>
> class stack; 
```

As you can see there is a second parameter.

Adding:

```
#include <deque>
template <std::size_t N,
         template <class T, class = std::deque<T>> class Stack = std::stack
         > 
```

should make it compile.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-07T21:34:02.607

`std::stack` has more than one template argument. Therefore, it can't be used in your case. You can work around this in C++11 with *template typedefs*.

```
template <typename T>
using stack_with_one_type_parameter = std::stack<T>;

template <std::size_t N,
     template <class> class Stack = stack_with_one_type_parameter
     >
class Tower; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-08T12:34:10.673

谢谢，效果很好。这是对我的代码的修改：

```
#include <stack>
#include <queue>
#include <cstddef>

template <std::size_t N,
         class T,
         template <class, class> class Stack = std::stack,
         class C = std::deque<T>
         >   
class Tower : protected Stack<T,C>
{   
    public:
        Tower() : Stack<T,C>(N)
        {   
        }   
};  

int main(int argc, char **argv)
{   
    Tower<5UL, int> tower1();
    Tower<5UL, int, std::queue> tower2();
    Tower<5UL, int, std::stack, std::deque<int> > tower3();
} 
```

# android - HttpURLConnection Post：输出流没有效果？

> ID：10058516
> 
> 赞同：3
> 
> 时间：2012-04-07T21:23:21.333
> 
> 标签：android, post, httpurlconnection

我正在开发一个 Android 应用程序，并且已经发现不同的 Android 版本在处理 Http(s)URLConnections (http://stackoverflow.com/q/9556316/151682) 上有不同的方式。

我遇到了 Android 4 很好地通过 HTTPS 执行 POST 请求的问题，在运行下面的代码时会自动添加诸如 Content-Type 之类的标头。

但是，在 Android 2.3.5（设备和模拟器）上，对输出流的任何写入似乎都被忽略了 - 我使用 Web 代理 Charles 对其进行了调试，并且在发送所有标头时，写入输出流的数据不会一起发送...

任何人都知道如何解决这个问题？

注意：由于我正在开发的 API 只有一个自签名证书，所以此时我需要禁用证书验证。

TIA，帕特里克

**更新** 与此同时，我也尝试过以下操作，但无济于事：

*   在 BufferedOutputStream 上调用`close()`之后调用`flush()`
*   同时调用`close()`OutputStream 和 BufferedOutputStream
*   改用 OutputStreamWriter
*   打电话`close()`前不打电话`getInputStream()`

    ```
    HttpURLConnection connection = (HttpURLConnection) url.openConnection();
    connection.setConnectTimeout(CONNECT_TIMEOUT);

    connection.setDoOutput(true); // Triggers POST.
    connection.setRequestMethod("POST");
    int contentLength = 0;
    if(body != null) {
        contentLength = body.getBytes().length;
    }

    // Workarounds for older Android versions who do not do that automatically (2.3.5 for example)
    connection.setRequestProperty(HTTP.TARGET_HOST, url.getHost());
    connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");

    // Set SSL Context -- Development only
    if(context != null && connection instanceof HttpsURLConnection){
        HttpsURLConnection conn = (HttpsURLConnection)connection;
        conn.setSSLSocketFactory(context.getSocketFactory());
        conn.setHostnameVerifier(new HostnameVerifier() {
            @Override
            public boolean verify(String hostname, SSLSession session) {
                return true;
            }
        });
    }

    try{
        // Add headers
        if(headers != null){
            for (NameValuePair nvp : headers) {
                if(nvp != null){
                    connection.setRequestProperty(nvp.getName(), nvp.getValue());
                }
            }
        }

        connection.setFixedLengthStreamingMode(contentLength);
        OutputStream outputStream = null;
        try {
            if(body != null){
                outputStream = connection.getOutputStream();
                BufferedOutputStream stream = new BufferedOutputStream(outputStream);
                stream.write(body.getBytes()); // <<<< No effect ?!
                stream.flush();

            }
        } finally {
            if (outputStream != null) 
                try { 
                    outputStream.close(); 
                }
            catch (IOException logOrIgnore) {
                // ...
            }
        }

        InputStream inputStream = connection.getInputStream();

        // .... Normal case ....

    }
    catch(IOException e){
        // ... Exception! Check Error stream and the response code ...

    }
    finally{
        connection.disconnect();
    } 
    ```

    }

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T06:58:50.240

对我来说，你打电话的顺序等似乎`DoSetOutput`是奇怪行为的原因......

Android上HTTP POST的一些链接/源代码：

*   [HttpURLConnection 在 Android 上失败](https://stackoverflow.com/questions/1118447/httpurlconnection-fail-on-android)（请参阅问题中的类作为参考）
*   [HttpURLConnection](http://developer.android.com/reference/java/net/HttpURLConnection.html)（包括示例代码的参考）
*   [不错的示例，包括异常处理](http://www.tbray.org/ongoing/When/201x/2012/01/17/HttpURLConnection)
*   [http://digitallibraryworld.com/?p=189](http://digitallibraryworld.com/?p=189)
*   [如何使用 DefaultHttpClient 写入 OutputStream？](https://stackoverflow.com/questions/10146692/how-do-i-write-to-an-outpustream-using-defaulthttpclient)
*   [DefaultHttpClient GET 和 POST 命令 Java Android](https://stackoverflow.com/questions/2511145/defaulthttpclient-get-and-post-commands-java-android)（请参阅有问题的代码）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-21T18:39:23.380

啊，终于找到了。找错地方了……问题出在标题上：

我上面的代码实际上工作正常 - 原因是我包含了一个 Base64 编码的标头。在我的 Android 2.3.5 上，指定的选项 ( `Base64.DEFAULT`) 似乎在末尾插入了一个额外的换行符，这会提前结束请求，让我没有时间发送实际的正文。在 Android 4 上，默认值似乎更改为 BASE64.NO_WRAP 之类的内容，如下面链接的帖子中所述...

这其实已经[在这里](https://stackoverflow.com/a/5095189/151682)回答了。

感谢您的努力。

# firefox - 如何将 Firefox OpenSearch 搜索引擎插件标记为移动兼容？

> ID：10058520
> 
> 赞同：2
> 
> 时间：2012-04-07T21:24:20.810
> 
> 标签：firefox, firefox-addon, compatibility, opensearch, fennec

我为 Firefox 开发了几个搜索提供程序（不是 XPI 插件，而只是一个 XML 文件），但无法在 Firefox Mobile 中安装任何搜索提供程序，出现不兼容错误：

> Firefox 不支持此搜索引擎，因此无法安装。

如何使它们兼容？我在 Dev Hub 上没有发现任何与兼容性相关的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T08:45:26.277

Firefox Mobile 的应用程序 ID 是：

*   `{a23983c0-fd0e-11dc-95ff-0800200c9a66}`（带有 XUL 用户界面的 Firefox Mobile）
*   `{aa3c5121-dab2-40e2-81ca-7ea25febc110}`（带有原生用户界面的 Firefox Mobile）

您应该将相应的`targetApplication`部分添加到`install.rdf`包的文件中。

# python - github api v3中的oauth流不起作用

> ID：10058522
> 
> 赞同：4
> 
> 时间：2012-04-07T21:24:51.300
> 
> 标签：python, api, oauth, github

所以这应该很简单，但我似乎找不到我的失败点。希望其他人可以向我指出。

首先我去`https://github.com/login/oauth/authorize?client_id=CLIENT_ID&scope=gist`，这会返回一个代码给我。然后我这样做：

```
import requests, json

client_id = XXXX
client_secret = XXXX
code = XXXX

r = requests.post(
    'https://github.com/login/oauth/access_token', 
    data=json.dumps({
        'client_id':client_id, 
        'client_secret':client_secret,
        'code':code
    })
r.content  # this gives me a 404 header 
```

当我转到我的测试用户时，它显示我已授权，我的应用程序显示为有一个用户，但我没有访问令牌。

我究竟做错了什么。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-07T21:58:50.660

好吧，我是对的，这是一个非常简单的问题，但我会把它留在这里，以防其他人遇到同样的错误。

如有疑问，请手动定义您的标题。所以你需要：

```
header = {'content-type':'application/json'} 
```

然后传入标题：

```
r = requests.post(
    'https://github.com/login/oauth/access_token', 
    data=json.dumps({
        'client_id':client_id, 
        'client_secret':client_secret,
        'code':code
    }),
    headers=header
) 
```

对我来说，这解决了问题。

# java - 如何使用 TextWatcher 检查特定的字符串而不是一个字符？

> ID：10058524
> 
> 赞同：0
> 
> 时间：2012-04-07T21:25:09.147
> 
> 标签：java, android, android-edittext, textwatcher

我是 Android 和 Java 的新手。我的应用程序需要能够在用户输入内容时检查他们输入的内容。如果用户键入已标记的预定词，则需要在用户按下按钮之前发生事件。似乎最好的选择是 TextWatcher 和 addChangedTextListener。我无法弄清楚如何让它检查一系列字符（一个单词）。例如，如果标记词是“非常”，那么当用户键入“非常温暖”时。在edittext中，程序应该能够识别出“very”被输入并以某种方式提醒用户。

我希望我能够在不使用任何代码的情况下说明这一点。任何可以提供的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:48:39.727

这是通过**TextWatcher**执行此操作的最简单形式：

```
String word = "very";

TextWatcher watcher = new TextWatcher() {
    public void onTextChanged(CharSequence s, int start, int before, int count) {
    }

    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {
    }

    public void afterTextChanged(Editable s) {
        String tmp = s.toString().trim().toLowerCase();
        if(tmp.contains(word.toLowerCase())){
            //inform the user here
        }
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:30:10.300

我将简单地展示一个例子：

```
String word = "very";
int wordProgress = 0;

charTyped(char c) {
    if (c == word.charAt(wordProgress)) {
        wordProgress++;
        if (wordProgress >= word.length()) {
            AlertUserThatFlagWordWasTypedAndUseObjectiveCTypeMethodNamingSyntaxJustForFunBecauseIAmUsingObjectiveCAndIFindItQuiteAnoying(word);
        }
    }
} 
```

这可能不是最好的方法，但它是最快和最有效的。如果您还在寻找插入符号位置更改和退格，那么您将不得不修改它。

一个更简单的版本也可以使用退格键和插入符号移动，但效率会低得多，它是在用户每次输入内容时检查整个文本区域是否包含单词。

# php - 另一个就地编辑器 - 一个 jQuery 就地编辑插件

> ID：10058527
> 
> 赞同：0
> 
> 时间：2012-04-07T21:25:20.667
> 
> 标签：php, javascript, jquery, mysql

我试图弄清楚如何将更改后的值提交到数据库，但到目前为止，我一点运气都没有。关于我做错了什么的任何想法？

JS文件：

```
$("#editme5").editInPlace({
    /*saving_animation_color: "#ECF2F8",
    callback: function(idOfEditor, enteredText, orinalHTMLContent, settingsParams, animationCallbacks) {
        animationCallbacks.didStartSaving();
        setTimeout(animationCallbacks.didEndSaving, 2000);
        return enteredText;
    },*/
    url: "server.php",
    params: "name=BUSINESS_NAME"
}); 
```

PHP文件：

```
include('database.php');
$_GET['name'];
$_NAME=$_GET['name'];

$update = $_POST['update_value'];
$insert = "UPDATE CLIENTS SET ".$_NAME."='".$update."'";
mysql_query($insert) or die (mysql_error()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:34:52.700

尝试改变：

```
include('database.php');
$_GET['name'];
$_NAME=$_GET['name']; 
```

到：

```
include('database.php');
$_NAME=$_POST['name']; 
```

文档说：

> 提交就地编辑器表单后，它会向编辑器参数中指定的 URL 发送一个 POST 请求以及三个表单字段

通过写作`$_NAME=$_GET['name'];`，您期望值来自`GET`请求，但插件使用`POST`请求发送值。我想这就是罪魁祸首。

另外，请记住 Marc B 在他的评论中所说的话。该代码很容易受到 SQL 注入攻击。为了使它不那么脆弱，**至少** `mysql_real_escape_string()`使用（更多： http: [//php.net/manual/pl/function.mysql-real-escape-string.php](http://php.net/manual/pl/function.mysql-real-escape-string.php)）或使用准备好的语句（一个很好的教程：[http://www .ultramegatech.com/2009/07/using-mysql-prepared-statements-in-php/](http://www.ultramegatech.com/2009/07/using-mysql-prepared-statements-in-php/)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:57:02.293

尝试使用`$_REQUEST`which 可以帮助您捕获两者`$_GET`并`$_POST`在采样时请求...

尝试修复 SQL 注入漏洞，`mysql_real_escape_string`请参阅[http://php.net/manual/en/function.mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php)了解更多信息

谢谢

# ios - ImageIO：CGImageRead_mapData 'open' 失败错误 = 2

> ID：10058528
> 
> 赞同：4
> 
> 时间：2012-04-07T21:25:30.870
> 
> 标签：ios, uibutton, uiimage

在我的应用程序中，我从磁盘加载图像以用作 UIBUtton 缩略图。

为了获取图像，我覆盖了我的 Drawing 对象的 thumbnailImage 属性的 getter，以从磁盘加载图像：

```
- (UIImage *)thumbnailImage {

    if (_thumbnailImage) {
        return _thumbnailImage;
    }

    NSString *thumbnailImagePath = [[self getFullPathWithDataFilename:NO] stringByAppendingPathComponent:kThumbImageFileName];

    if ([[NSFileManager defaultManager] fileExistsAtPath:thumbnailImagePath]) {
        _thumbnailImage = [[UIImage imageWithContentsOfFile:thumbnailImagePath] retain];

        return _thumbnailImage;
    }

    return nil;
} 
```

然后我将缩略图加载到我的每个按钮中，如下所示：

```
[button setImage:drawing.thumbnailImage forState:UIControlStateNormal]; 
```

在此之后，按钮被添加到视图中并且工作正常。但是，如果我移动创建缩略图图像的文件，单击按钮时会出现以下错误（两次）：

```
ImageIO: CGImageRead_mapData 'open' failed '/var/mobile/Applications/F07CB571-4AAA-47E2-B3EB-3D4523AE7B51/Library/root.stack/C1199105-062F-40A3-B56C-3BB1106AC003.drawing/thumbImage.png'
         error = 2 (No such file or directory) 
```

这不会使应用程序崩溃并且缩略图仍然显示，但是我想清除此问题，以免引发错误。

我在想 UIImage 挂在对创建它的文件的引用上。我也尝试过对此进行断点，但无法识别导致错误的任何特定代码行。

# database - 适当的模型名称和数据库表复数命名约定

> ID：10058529
> 
> 赞同：0
> 
> 时间：2012-04-07T21:25:31.383
> 
> 标签：database, model, naming-conventions

我正在使用 django 并制作一个类似于工作门户或linkedin 或专业社区的系统。因此，除了 auth_users 之外，还有 2 个表/模型，一个是公司，而我对其他模型名称感到困惑。我应该将其命名为 Professional 还是 Person？如果我选择名称专业而不是数据库表名可以是专业人士，而如果我将其命名为人员，那么表名将是“人”（人的复数）？我应该如何命名我的模型，如果我将它命名为“Person”并且它的复数是完全不同的词，我该怎么办？我应该如何命名模型和 dbtables，而专业和个人似乎都适合模型名称。我知道 django 或任何框架都会接受任何模型名称，但有什么更好的方法？我将使用“专业” 通过整个网站，但也会有学生创建个人/专业帐户，因此人在实际含义中似乎是更通用的术语。所以请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:40:41.183

我认为表名不应该是复数形式。也就是说，由于您的数据库也将包含学生，因此我认为 Person 是最好的选择。恕我直言，表/模式定义比表名更重要。最后，表名并不重要。

# amazon-s3 - 如何批量更新 Amazon S3 文件上数千个文件的元数据？

> ID：10058537
> 
> 赞同：1
> 
> 时间：2012-04-07T21:26:46.853
> 
> 标签：amazon-s3

我在 s3 上托管了数千张图像，现在意识到我需要在元数据中设置一个“过期”值。

DragonDisk 不允许我更新多个文件的属性。看起来在 S3 控制台中，我必须滚动到列表的末尾才能进行大规模更新。直接将 100,000 张图像合二为一并不实用。

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T18:33:48.103

DragonDisk v1.0 这样做：右键单击文件夹 -> 属性 -> 子对象。

# objective-c - 在 Core Data 中多次重命名 ID 的实体？（第三版）

> ID：10058539
> 
> 赞同：4
> 
> 时间：2012-04-07T21:27:38.503
> 
> 标签：objective-c, core-data, versioning

如何多次更改模型实体的名称：假设从版本 1 到 2，我的实体从“Entity”更改为“MyEntity”，然后从 2 更改为 3，它从“MyEntity”更改为“MyLastEntity” “？

为了将名称从版本 1 更改为 2，我在“重命名 ID”（在“版本控制”中）中输入了相同的名称，但我应该如何从版本 2 更改为 3？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T21:40:54.090

您通过添加第三个模型版本以完全相同的方式执行此操作，以便您保持向后兼容两个版本。

# java - com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException

> ID：10058545
> 
> 赞同：0
> 
> 时间：2012-04-07T21:28:49.017
> 
> 标签：java, mysql, database

错误是：

> com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl. java:39) 在 sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27) 在 java.lang.reflect.Constructor.newInstance(Constructor.java:513) 在 com.mysql.jdbc.Util.handleNewInstance(Util.java :411) 在 com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052) 在 com.mysql.jdbc 的 com.mysql.jdbc.Util.getInstance(Util.java:386)。

代码是：

```
private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    String bookid = jTextField2.getText();
    String doi = "";
    Calendar cal = new GregorianCalendar();
    doi = doi + cal.get(Calendar.YEAR) + "-" + cal.get(Calendar.MONTH) + "-" + cal.get(Calendar.DAY_OF_MONTH);
    String sql = "insert into library.issue values ('"+ bookid + "','librarian','"+ username + "','" + doi + "')";
    try
    {
        int i = st.executeUpdate(sql);
        if(i>0)
           JOptionPane.showMessageDialog(null,"BOOK IS ISSUED","SUCCESS",JOptionPane.PLAIN_MESSAGE);
        else
           JOptionPane.showMessageDialog(null,"problem in issuing book","FAILURE",JOptionPane.ERROR_MESSAGE);
        bookid = bookid.toUpperCase();
        String sql1 = "update library.books set status = " + 1 + "where book_id = '" + bookid + "'";
        PreparedStatement pstmt=c.prepareStatement(sql1);
        int j= pstmt.executeUpdate() ;
        //int j = st.executeUpdate(sql1);
    }
    catch(Exception ex)
    {
        ex.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:31:31.593

在 之前插入一个空格`where`：

```
String sql1 = "update library.books set status = " + 1 
      + " where book_id = '" + bookid + "'"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:37:49.297

检查一次应该是

```
String sql1 = "update library.books set status =  1 where book_id = '" + bookid + "'"; 
```

# jquery - wordpress slidedeck plugin - javascript not working

> ID：10058546
> 
> 赞同：2
> 
> 时间：2012-04-07T21:28:55.227
> 
> 标签：jquery, wordpress

I'm using a HTML 5 Reset Wordpress Theme as a framework for a project. The problem I'm having is with a plugin - slidedeck - that doesn't work, more precisely, the javascript doesn't load.

This is the link to the website: [http://melisayavas.com/web](http://melisayavas.com/web) (on the homepage the text should slide).

This is what I have in my functions.php:

```
// Load jQuery
  if ( !function_exists(core_mods) ) {
     function core_mods() {
        if ( !is_admin() ) {
          wp_deregister_script('jquery');
          wp_register_script('jquery', ("//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"), false);
          wp_enqueue_script('jquery');
           }
         }
           core_mods();
       } 
```

In header.php the only script I have is this:

```
<script src="<?php bloginfo('template_directory'); ?>/_/js/modernizr-1.7.min.js"> 
```

And then in footer.php I have this:

```
<script src="<?php bloginfo('template_directory'); ?>/_/js/functions.js"></script> 
```

Unfortunately, I don't know how to work with javascript / jQuery, I have no idea what I'm doing wrong or how should I fix it.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T00:11:27.923

在您使用的代码中

```
wp_deregister_script('jquery');
wp_register_script('jquery', ("//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"), false);
wp_enqueue_script('jquery'); 
```

结果你得到了这个错误

`Failed to load resource: the server responded with a status of 404 (Not Found)`

因为

`http://melisayavas.com/web//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js?` 是一个无效的 url，所以 jQuery 是未定义的

您可以通过将 url 更改为 (notice `http:`)来解决它

```
wp_register_script('jquery', ("http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"), false); 
```

**注意：**用于`http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js`始终获取最新版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-05T18:21:48.450

同样重要的是要注意 WordPress 3.6 破坏了一些 SlideDeck 功能，因此请务必将 SlideDeck 升级到 2.3.3

有关更多信息，请参阅[http://www.slidedeck.com/blog/news-updates/wordpress-3-6-making-your-slidedecks-cry-no-problem/](http://www.slidedeck.com/blog/news-updates/wordpress-3-6-making-your-slidedecks-cry-no-problem/)

# gcc - What is gcc -O2 doing to the recursive Fibonacci function?

> ID：10058547
> 
> 赞同：5
> 
> 时间：2012-04-07T21:29:04.807
> 
> 标签：gcc, assembly, recursion, x86

I am learning x86 assembler in order to write a compiler. In particular, I'm taking a variety of simple recursive functions and feeding them through different compilers (OCaml, GCC etc.) in order to get a better understanding of the kinds of assembler generated by different compilers.

I've got a trivial recursive integer Fibonacci function:

```
int fib(int x) { return (x < 2 ? x : fib(x-1)+fib(x-2)); } 
```

My hand-coded assembly looks like this:

```
fib:
    cmp eax, 2
    jl  fin
    push    eax
    dec eax
    call    fib
    push    eax
    mov eax, [esp+4]
    add eax, -2
    call    fib
    add eax, [esp]
    add esp, 8
fin:
    ret 
```

Compiling that function to Intel-syntax assembler using `gcc -O2` produces this enigmatic code:

```
_fib:
    push    edi
    push    esi
    push    ebx
    sub esp, 16
    mov edi, DWORD PTR [esp+32]
    cmp edi, 1
    jle L4
    mov ebx, edi
    xor esi, esi
L3:
    lea eax, [ebx-1]
    mov DWORD PTR [esp], eax
    call    _fib
    sub ebx, 2
    add esi, eax
    cmp ebx, 1
    jg  L3
    and edi, 1
L2:
    lea eax, [esi+edi]
    add esp, 16
    pop ebx
    pop esi
    pop edi
    ret
L4:
    xor esi, esi
    jmp L2 
```

So I guess the calling convention is argument at `[esp+4]` and return value in `eax`. It starts by pushing `edi`, `esi` and `ebx`. Then it claims another 16 bytes for a stack frame, enough for 4 temporary ints. Then `edi` is read from `[esp+32]`, which is the argument. If the argument is `<=1` then it jumps to `L4` which zeroes out (?) `esi` before jumping back to `L2` which sets `eax=esi+edi` which is just the argument `edi`. If the argument was `>1` then the argument is copied into `ebx` and zeroes `esi` before falling through into `L3`. In `L3`, it sets `eax=ebx-1` and stores the result (n-1) at `esp` in the stack frame before recursing to calculate `fib(n-1)`. The result is added to `esi`, `ebx` is set to `n-2` and it loops back to `L3` if `ebx>1` otherwise it extracts the lower bit of `edi` before falling through to `L2`.

Why is this code so convoluted (e.g. is there a name for an optimization that has been done that I'm not seeing?)?

The recursive calls `fib(n-2)` seem to have been replaced with a loop accumulating in `esi` but that call wasn't in tail position so how was this done?

What is the purpose of the `and edi, 1`?

What is the purpose of the `mov DWORD PTR [esp], eax`?

Why is the stack frame so large?

Can you disassemble this algorithm back into C to make it clearer what is going on?

My preliminary impression is that GCC generates pretty poor x86 assembler. In this case, over 2× more code for equal performance (3.25s for fib(40) on this 1.6GHz Atom for both programs). Is that fair?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-07T22:07:43.380

除了上面的注释之外，请注意，通过替换，递归*已*展开为尾调用：

```
return x < 2 ? x : fib(x - 2) + fib(x - 1); 
```

和：

```
if ((xprime = x) < 2) {
    acc = 0;
} else {
    /* at this point we know x >= 2 */
    acc = 0; /* start with 0 */
    while (x > 1) {
       acc += fib(x - 1); /* add fib(x-1) */
       x -= 2; /* now we'll add fib(x-2) */
    }
    /* so at this point we know either x==1 or x==0 */
    xprime = x == 1 ? 1 : 0; /* ie, x & 1 */
}
return xprime + acc; 
```

我怀疑这个相当棘手的循环是由多个优化步骤引起的，并不是说我从 gcc 2.3 开始就一直在摆弄 gcc 优化（现在内部完全不同了！）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T22:14:19.170

很简单，`fib(x-2)`is equal to `fib(x-3) + fib(x-4)`，`fib(x-4)`is equal to `fib(x-5) + fib(x-6)`etc. 所以`fib(x)`计算为`fib(x-1) + fib(x-3) + fib(x-5) + ... + fib(x&1)`( `fib(x&1)`equals `x&1`) 即 gcc 已经内联了对 的调用`fib(x-2)`，这对递归函数来说是一件非常聪明的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-07T22:15:29.357

第一部分是确保根据调用约定应保留的寄存器不会被丢弃。我猜这里使用的调用约定是`cdecl`.

```
_fib:
    push    edi
    push    esi
    push    ebx
    sub esp, 16 
```

`DWORD PTR[esp+32]`是你的`x`：

```
 mov edi, DWORD PTR [esp+32]
    cmp edi, 1
    jle L4 
```

如果`x`小于或等于 1（这对应于您的`x < 2`），则转到`L4`哪个是：

```
L4:
    xor esi, esi
    jmp L2 
```

这将归零`esi`并分支到`L2`：

```
L2:
    lea eax, [esi+edi]
    add esp, 16
    pop ebx
    pop esi
    pop edi
    ret 
```

这将`eax`（返回值）设置为`esi+edi`. 由于`esi`已经是 0，`edi`所以在 0 和 1 的情况下才加载。这对应于`x < 2 ? x`.

现在我们看看`x`is not的情况`< 2`：

```
 mov ebx, edi
    xor esi, esi
L3:
    lea eax, [ebx-1]
    mov DWORD PTR [esp], eax
    call    _fib 
```

首先，`x`复制到`ebx`，然后`esi`归零。

接下来，`eax`设置为`x - 1`。这个值被移到栈顶并被`_fib`调用。这对应于`fib(x-1)`。

```
 sub ebx, 2
    add esi, eax 
```

`ebx`这从( `x`) 中减去 2 。然后（来自call 的`eax`返回值被添加到之前设置为 0 的 ）。因此现在持有 的结果。`_fib``esi``esi``fib(x-1)`

```
 cmp ebx, 1
    jg  L3
    and edi, 1 
```

`ebx`与 1 进行比较。如果大于 1，则循环回`L3`. 否则（它是 0 或 1 的情况），我们执行`and edi, 1`并落入`L2`（我们之前已经分析过它的作用）。`and edi, 1`相当于执行`%2`on `x`。

从高层次来看，这就是代码的作用：

*   设置堆栈帧并保存寄存器
*   如果`x < 2`，则返回`x`。
*   继续调用和求和`fib(x-...)`，直到`x`小于 2。在这种情况下，通过`x < 2`案例。

优化之处在于 GCC`x >= 2`通过循环而不是递归来展开这些情况。

# google-app-engine - AppEngine python unittest 任务队列

> ID：10058553
> 
> 赞同：4
> 
> 时间：2012-04-07T21:30:50.833
> 
> 标签：google-app-engine

我有一个公开一些 API 的 AppEngine 应用程序。现在我正在为这些 API 编写测试，但其中一些将任务排入队列。我不确定如何编写一个测试用例来等待某些 API 调用排队完成的所有任务。

任何想法如何在测试本身中验证某些任务已经完成？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-08T12:20:16.137

我假设您正在使用[testbed](https://developers.google.com/appengine/docs/python/tools/localunittesting)。

在测试平台中，排队的任务会一直待在那里，直到您自己执行它们。由于测试环境是单线程的，您手动执行队列中的任务并且您确切地知道它们何时完成。

这个[答案](https://stackoverflow.com/a/6635947/136598)向您展示了如何手动执行任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T04:39:22.073

SDK 附带了[一些 API 的测试平台](https://developers.google.com/appengine/docs/python/tools/localunittesting)，taskqueue 就是其中之一。

# google-maps - 如何在 KML 数据点周围添加不 同半径的圆？

> ID：10058559
> 
> 赞同：2
> 
> 时间：2012-04-07T21:31:40.343
> 
> 标签：google-maps, google-maps-api-3, kml

我有一个地址列表，需要放置在地图上并在每个不同半径周围显示一个圆圈。

我有一个列出所有点的 KML 文件，我想在 KML 中添加一个“半径”自定义字段，并能够根据自定义字段在每个点周围画一个圆圈。

我在正确的轨道上还是有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T17:23:14.617

很有可能在 KML 地标周围画圈。我使用了[geoxml3 处理器。](http://code.google.com/p/geoxml3/) 第一的，

*   geoxml3 使用 Ajax，因此无法通过从浏览器打开地图 HTML 进行测试。
*   我建议下载以下版本的 geoxml3，这对我有用：http: [//geoxml3.googlecode.com/svn/branches/polys/geoxml3.js](http://geoxml3.googlecode.com/svn/branches/polys/geoxml3.js)

kmz 文件和“network_link”还有另一个版本。（我没有尝试过这些）。

有一个坏消息，我断定无法插入自定义标签并让 geoxml3 找到它们。因此，要使圆半径可变，您需要将该信息放在“描述”标签中并进行解析，如果您正在组合数据，请使用正则表达式。还有另外两个不太合适的选项：“Name”和“styleUrl”。

这是我放在一起的简单页面。 [https://files.nyu.edu/hc742/public/googlemaps/kmlcircle.html](https://files.nyu.edu/hc742/public/googlemaps/kmlcircle.html)

javascript 看起来像这样，重要的部分是在 geoXml 选项中定义“createMarker”回调函数。

```
 <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
  <script type="text/javascript" src="geoxml3.js"></script>
  <script type="text/javascript">
  var map;
  var geoXml = null;
  var mapOptions = { center: new google.maps.LatLng(39.370, -100.0), zoom: 5,
    mapTypeId: google.maps.MapTypeId.ROADMAP };

  function initialize() {
    map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
    geoXml = new geoXML3.parser({
      map: map, 
      createMarker: addCircle});

    geoXml.parse('https://files.nyu.edu/hc742/public/googlemaps/simple.kml')
  }

  function addCircle(placemark) {
    //rad = parseFloat(placemark.description);
    rad = parseFloat(placemark.styleUrl);
    marker = new google.maps.Marker({map:map, position:placemark.latlng});
    circle = new google.maps.Circle({map:map, center: placemark.latlng, radius: rad}); 
  }

  google.maps.event.addDomListener(window, 'load', initialize);
  </script> 
```

使用此 KML：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.0">
  <Document>
    <name>simple</name>
    <description>nothing</description>

    <Placemark>
      <name>simple</name>
      <description>2000</description>
      <styleUrl>8000</styleUrl>

      <Point>
        <coordinates>-122.0822035425683,37.42228990140251,1220</coordinates>
      </Point>
    </Placemark>

    <Placemark>
      <name>simple</name>
      <description>5001</description>
      <styleUrl>3000</styleUrl>
      <Point>
        <coordinates>-122.0822035425683,37.22228990140251,4330</coordinates>
      </Point>
    </Placemark>

    <Placemark>
      <name>C</name>
      <description>9001</description>
      <styleUrl>2000</styleUrl>

      <Point>
        <coordinates>-122.00000000001,37.000000000001,9001</coordinates>
      </Point>
    </Placemark>
  </Document>
</kml> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-08T07:39:57.530

取决于你有多少个地址。如果您的 KML 文件有几兆大，那么您可能走在正确的轨道上。但是，Google Maps API 中的 KmlLayer 无法让您直接访问点中的数据，因此您添加半径自定义字段的计划将行不通。似乎您最好将各个点呈现为地址。这些文章可能会有所帮助： [https://developers.google.com/maps/articles/toomanymarkers](https://developers.google.com/maps/articles/toomanymarkers) https://developers.google.com/maps/articles/phpsqlsearch_v3 [https://developers.google.com/maps /articles/phpsqlgeocode](https://developers.google.com/maps/articles/phpsqlgeocode)

然后围绕它创建一个圆形对象。

# javascript - Jquery (jfeed) - Access-Control-Allow-Origin 不允许来源 xxxxx

> ID：10058564
> 
> 赞同：0
> 
> 时间：2012-04-07T21:32:15.633
> 
> 标签：javascript, jquery, oauth, facebook-opengraph, atom-feed

我正在使用[jFeed](https://github.com/jfhovinne/jFeed)来尝试检索 Facebook 页面的 RSS 提要。我可以手动导航到 RSS 就好了（[https://www.facebook.com/feeds/page.php?format=atom10&id=12345](https://www.facebook.com/feeds/page.php?format=atom10&id=12345)）但是当我尝试使用以下代码时，我最终得到错误**“Origin Access-Control-Allow-Origin 不允许 xxxxx。”**

```
jQuery.getFeed({
    url: 'https://www.facebook.com/feeds/page.php?format=atom10&id=12345',
    success: function (feed) {
        alert(feed.title);
    }
}); 
```

我*假设*这是因为它需要 OAuth 2.0，但我确实需要一个“静默”解决方案，这样人们就不必拥有 Facebook 帐户或以任何方式与 Facebook 交互。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T18:49:37.577

你可以看看[https://github.com/dawanda/jquery-rss](https://github.com/dawanda/jquery-rss)。它使用谷歌的提要 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:50:13.427

刚刚开始工作！！！我正在使用应用程序 ID 和密码来获取 access_token，然后使用 jquery getJSON 方法来获取数据。像魅力一样工作，无需 facebook 身份验证！！！

```
appID = '' //myappid
secretCode = '' //app "secret code"
authURL = 'https://graph.facebook.com/oauth/access_token?client_id=' + appID + '&client_secret=' + secretCode + '&grant_type=client_credentials'
feedURL = 'https://graph.facebook.com/' + appID + '/feed?'

function getFeed() {
    $.get(authURL, function (accessToken) {
        $.getJSON(feedURL + accessToken, function (data) {
            $.map(data.data, function (item) {
                alert(item.message);
                //type: status, photo
                //likes.count
                //from.name
                //created_time
            });
        });
    });
}; 
```

显然，除了“警报”之外，您还想做一些事情，但它确实有效。与我发现的其他任何东西相比都非常简单。

# php - 从php执行程序时，opencv c ++，cvSaveImage不保存

> ID：10058569
> 
> 赞同：0
> 
> 时间：2012-04-07T21:33:08.220
> 
> 标签：php, c++, opencv

我正在使用 os X (lion) 上的 opencv c++(eclipse) 编写人脸检测应用程序。该程序加载图像文件，检测人脸，然后将每个人脸保存到单独的文件中。该程序可以 100% 运行，因为它来自命令行或 eclipse。然后，我编写了一个用于文件上传的 php 脚本，以便有人可以上传 jpg 或 png 文件，然后该脚本以唯一的文件名保存照片。然后在 php 脚本结束时，我让它执行人脸检测程序。

我不确定从命令行运行应用程序和让 php 调用应用程序运行有什么区别。下面是我的代码。

c++中的函数：

```
 cvNamedWindow ("ROI", CV_WINDOW_AUTOSIZE);
    cvCvtColor( clone, gray, CV_RGB2GRAY );

    cvSetImageROI ( gray, *r);

    //// * rectangle  = cvGetImageROI ( clone );
    *r = cvGetImageROI ( gray );
    cvShowImage ("ROI", gray);

    k++;
    char *name=0;

    name=(char*) calloc(512, 1);
    sprintf(name, "/Users/jason/Sites/jason.dev/images/proc_images/Image%d.png", k);
    cvSaveImage(name, gray); 
```

php脚本：

```
<?php
mysql_connect("127.0.0.1:3306","xxxx","xxxx");
mysql_select_db("opencv_development");

$uploaddir = "images/";
$file = basename($_FILES['uploadedfile']['name']);
$stamp = date("YmdHis");
$random = rand(0, 999);
$newName = $uploaddir . $stamp . $random . $file;

if ($_FILES['uploadedfile']['size']> 300000)     //Limiting image at 300K
{
exit("Your file is too large."); 
}

if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $newName)) {
echo "The file ".  basename( $_FILES['uploadedfile']['name']). 
" has been uploaded";
} else{
echo "There was an error uploading the file, please try again!";
}

mysql_query("INSERT INTO recv_img (photo_name) VALUES ('$newName')");

shell_exec("./opencv '$newName'");

?> 
```

正如我上面所说，如果我从终端运行应用程序，那么它会输出各个面部文件。当它从 php 脚本执行时，图像会加载到应用程序中，它会进行人脸检测，但不会保存单个人脸文件。

让我知道是否需要任何进一步的信息，或者我是否不清楚。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T13:05:50.713

返回的整数`cvSaveImage`可以帮助您查找是否有错误。
测试并查看 OpenCV 源代码后，似乎最近的版本不`cvSetErrStatus`用于文件错误，但`errno`似乎设置正确。

```
if(!cvSaveImage(name, gray)) {
    int error = cvGetErrStatus();
    const char * errorMessage = 0;
    if (error) {
        errorMessage = cvErrorStr(error);
    } else {
        error = errno;                   // needs #include <cerrno>
        errorMessage = strerror(error);  //       #include <cstring>        
    }
    std::cout << errorMessage << std::endl;  
    // with "echo shell_exec("./opencv '$newName'");" in php
} 
```

如果返回的错误是“权限被拒绝”，您可以检查用户是否真的是您认为的那个用户`echo shell_exec('whoami');`。

# javascript - 存储后获取 LawnChair JSON Obj

> ID：10058570
> 
> 赞同：1
> 
> 时间：2012-04-07T21:33:11.840
> 
> 标签：javascript, jquery, json, lawnchair

我对如何从不同的页面检索我的 JSON 对象有点困惑。

第 1 页片段 [存储]：

```
$.getJSON(serviceURL + 'getTaskDetails.php?id='+id, storeTasks); //[JSON Format of getTaskDetails][1]

function storeTasks(data) {

  var tasks = Lawnchair({name:'tasks'},function(e){});

  var taskList = data.tasks; //tasks is JSON array name

  tasks.save({key:"task",value:taskList});

  tasks.get("task",function(obj){
    console.info(obj);
  });
} 
```

`.get`返回我的对象​​（Firebug 的输出）：

```
key "task"

value   Object { name="Level fireplace mantle", start_date="2012-01-22 00:00:00", created_by="rachel.rinaldi@gmail.com"} 
```

我如何从另一个页面引用这个？

```
Lawnchair(function(){
        this.get('task', function(obj) {
        console.info(obj);
        })
}) 
```

以上返回对象，但不允许我引用单个元素（例如：我尝试过`obj.name`或`obj.tasks.name`全部`obj.Object.name`导致“未定义”）关于我做错了什么有什么建议吗？也许我一开始就存储不正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T00:29:58.343

你很亲近！这是您的简短回答： `console.log(obj['value']);`

对于那些在家观看的人：

第一页：

```
Lawnchair(function(){
    this.save({key:"task",value:taskList});
}); 
```

第二页：

```
Lawnchair(function(){
    this.get('task', function(obj) {
        if(obj) {
            console.log("found task");
            console.log(obj['value']);
        } else {
            console.log("task not found");
        }
    })
}); 
```

# deployment - 在 github 上搭建 octopress 博客

> ID：10058575
> 
> 赞同：7
> 
> 时间：2012-04-07T21:33:48.037
> 
> 标签：deployment, github, blogs, git-branch, github-pages

无法在 Github 上设置 Octopress 博客。我在[octopress](http://octopress.org/docs/deploying/github/)上遵循本指南，但是在 github 上创建了一个存储库并准备了我无法在 github 上部署的所有内容之后。

我有两个分支，master 和 gh-pages，在尝试之后我刚刚删除了所有内容，我想从头开始。

我应该将 octopress 文件夹放在本地存储库文件夹中吗？或者他们必须在两个不同的文件夹中？该指南有点混乱，我对 git 很陌生。**任何已经完成它**
的人都可以解释如何使用 github-pages 在 github 上部署吗？

 *** * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-20T19:03:36.527

我同意你的观点，教程有点复杂，但**严格按照它，你将能够正确设置**。

因此，为了做到这一点，在您的计算机中创建一个包含[octopress 内容](http://octopress.org/docs/setup/)的文件夹（不要忘记安装 bundler 和“rake install”），并[使用 YOU_USERNAME.github.com 在 github 中创建一个 repo](http://help.github.com/pages/)。

最后，[部署到 github](http://octopress.org/docs/deploying/github/)，运行“ *rake setup_github_pages* ”，*生成*并*部署*。您的页面已准备就绪。只需转到您的源文件夹并运行其他 3 个*git*命令，即可将其备份。

如果您有疑问，请参阅[我的 repo](https://github.com/LucasArruda)以供参考。我什至将我的域 (lucasarruda.com) 设置为它。

Obs.：在您刚刚创建存储库时等待几分钟。然后*提交*应该几乎是即时的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T19:50:20.483

我同意它有点复杂，但是一旦你设置好了，它就很容易使用。您不需要克隆您的 github 存储库，一切都应该在您的 Octopress 文件夹中完成（但您需要与您的存储库建立 SSH 密钥连接），这是我的设置方法：

从您的 github 帐户：

1.  `username.github.io`在我的例子中，创建一个新的 repo 并命名它`iamaziz.github.io`。

克隆 Octopress 博客项目：

1.  `git clone https://github.com/imathis/octopress.git`

从 Octopress 博客根文件夹：

1.  运行`rake setup_github_pages`，并使用您的回购凭证（您刚刚创建的凭证）进行回答。（注意：确保您的 github 帐户和计算机之间设置了 SSH 密钥。）
2.  运行`rake generate` （这将创建您的帖子和页面）
3.  运行`rake deploy` （这会将内容推`_deploy`送到您的`master`分支）。

它应该询问您的 ssh 密钥密码（如果它尚未保存在钥匙串中），那么您将看到类似的`identity added: ...`内容并开始部署。

### 笔记：

> 如果您`permission denied`在运行时收到一条消息`rake deploy`，这意味着 SSH 密钥（公钥）不存在或未正确建立。[请参阅：错误权限被拒绝。](https://help.github.com/articles/error-permission-denied-publickey)

如果一切正常，您的博客已准备就绪：`http://username.github.io/`

### 还有一件事：

但是，您还需要将 Octopress 项目的源代码推送到`source`repo 的分支，如下所示，将目录更改为源文件夹并运行：

1.  `git add .`
2.  `git commit -m "your msg"`
3.  `git push origin source`

# 完毕！

从现在开始你应该写博客，如下：

1.  创建和编辑帖子：`rake new_post["title"]`
2.  生成它们：`rake generate`
3.  将它们部署到您的 github 页面：`rake deploy`**

# ruby-on-rails - Ruby on Rails 两个同时为两个不同的控制器创建动作

> ID：10058584
> 
> 赞同：2
> 
> 时间：2012-04-07T21:35:14.730
> 
> 标签：ruby-on-rails, ruby-on-rails-3, controller

我有一个线程控制器和消息控制器。

线程 has_many 消息

一旦用户单击发送，我将数据发送到线程控制器以创建线程。我想做到这一点

线程控制器.rb

```
def create
    ...
    if @thread.save
         #send data into messages_controller 
         #to create the corresponding table for a message with this thread_id

end 
```

所以，本质上，如果第一个成功，我会尝试一个接一个地做两个 POSTS。

我认为 redirect_to 是我应该使用的。是否可以使用 redirect_to 传递参数并从不同的控制器调用创建操作？

编辑：我必须有一个线程（由于 Ryan 提到的原因，名字选择不好，但为了不让人们与底部的答案混淆，让我们保留它）模型和消息模型在这里。线程表只需要传入message_title即可。Message表包含from_id(发送消息的用户id)、to_id(接收消息的用户id)和message_content。我正在尝试以一种包含 message_title 和 message_content 的形式来完成所有这些工作。

我希望这有助于理解这个问题。

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:06:22.747

我认为你以错误的方式处理这个问题。

**第一：我真的希望您不要调用模型`Thread`，因为这会与 Ruby 类冲突`Thread`。如果是，请选择一个不同的词**。

现在有了“请把枪从你的脚上瞄准*”*的信息……

* * *

您不应该要求`MessagesController`为控制器创建新消息。相反，您应该在新线程表单中使用嵌套属性：

```
<%= form_for @thread do |f| %>
  <%= f.fields_for :messages do |message| %>
    <%= render "messages/form", :message => message %>
  <% end %>
<% end %> 
```

在您的`DiscussionThread`（我在这里假设它的名称）模型中，您将拥有以下几行：

```
has_many :messages
accepts_nested_attributes_for :messages 
```

您可能还必须添加到此模型`messages_attributes`中的`attr_accessible`属性。

这告诉`DiscussionThread`模型实例也可以接受`messages`关联的属性。在你`ThreadsController`的行动将保持不变。

有关嵌套属性的更多信息，我建议观看 Railscasts on [Nested Forms #1](http://railscasts.com/episodes/196-nested-model-form-part-1)和[Nested Forms #2](http://railscasts.com/episodes/197-nested-model-form-part-2)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:08:25.817

如果我理解您的问题，您需要做的就是调用 Message 模型上的 create 方法并传入相关信息。所以在你的 if @thread.save 中是这样的：

```
Message.create(:item_1 => params[:item_1]) 
```

如果您不想走这条路，您可以使用嵌套资源，然后让 Rails 在您传递正确信息时自动创建新消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T22:09:05.597

没有理由去另一个控制器。您可以在线程控制器中执行以下操作：

```
@thread.messages << Message.new(...) 
```

或者在消息控制器中执行它，这对我来说更有意义，因为您的用户正在创建带有线程创建作为副作用的消息。如果您发送`thread_id`正确，`params[:message][:thread_id]`则在您创建对象时将自动进行关联：

```
@message = Message.create(params[:message]) 
```

如果您需要一些其他逻辑来决定消息与哪个线程相关联，只需`thread_id`直接设置：

```
@message.thread_id = current_thread.id # Or Thread.create(...) or whatever
@message.save 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T22:35:48.003

我将您的基本用例视为：

*   创建新消息和线程
*   在现有线程中创建新消息
*   查看消息
*   查看线程和所有相关消息

我会建议多对多的关系： [http ://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_and_belongs_to_many](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_and_belongs_to_many)

```
# define has and belongs to many relationship

class Message
  has_and_belongs_to_many :threads
end

class Thread
  has_and_belongs_to_many :messages
end

class MessageThread
  belongs_to :message
  belongs_to :thread
end

# use case: creating a new message and a new thread, showing message

class MessagesController < ApplicationController
  def create
    @message = current_user.messages.create! :text => params[:text]
    @thread = @message.threads.create!
  end

  def show; @message = current_user.messages.find(params[:id); end;
end

# use case: creating a message in an existing thread

def MessagesThreadsController < ApplicationController
  def create
    @thread = current_user.threads.find params[:id]
    @thread.messages.create! :text => params[:text]
  end
end

# use case: viewing all messages in a thread

def ThreadsController < ApplicationController
  before_filter :set_thread

  def show
    @thread = current_user.threads.find params[:id]
    @messages = @thread.messages
  end
end 
```

# c# - Convert a windows phone microphone to wma or mp3

> ID：10058587
> 
> 赞同：3
> 
> 时间：2012-04-07T21:35:54.450
> 
> 标签：c#, windows-phone-7

I want to convert a windows phone microphone to wma or mp3.

It looks like the question is answered here: [Convert wav to wma](https://stackoverflow.com/questions/7642314/convert-wav-to-wma)

But I don't understand how [http://www.codeproject.com/KB/audio-video/MP3Compressor.aspx](http://www.codeproject.com/KB/audio-video/MP3Compressor.aspx) can be used since it uses a dll which doesn't run on the phone.

Any ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:40:33.060

听起来您想让它自动具有压缩文件格式。我不确定这是可能的。

通过这些链接显示的示例用于在计算机上将 .wav 转换为 .mp3。

# c# - Annoying DisconnectContext Detected Exception

> ID：10058588
> 
> 赞同：2
> 
> 时间：2012-04-07T21:35:55.620
> 
> 标签：c#, .net, winapi, wmi, screen

I'm getting a REALLY annoying DisconectContext exception. I know my computer supports the WMI function, because someone else's application that does the same thing works.

Basically, this is a program that sets the brightness of the screen when Fn+Up or Fn+Down is pressed.

All the code runs in the same thread, and the program is WinForms, but I compile it as a console application so I can see the debug messages. I have tried making it Windows Application, but it doesn't fix the issue, so I don't think it's the console.

The exception occurs in SetBrightness(int) at the comment...

HiddenForm.cs:

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace ComputerControl
{
public partial class HiddenForm : Form
{
    public HiddenForm()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        WindowState = FormWindowState.Minimized;

        Utils.SetHook();

        if (Utils._hook.ToInt32() <= 0)
        {
            MessageBox.Show("The application failed to hook the keyboard and will now exit.", "Application Initialization Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
            Application.Exit();
        }

        bool supports = Utils.LoadBrightnessLevels();

        if (!supports)
        {
            MessageBox.Show("The computer does not support WMI.  The application will now exit.", "Application Initialization Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
            Application.Exit();
        }
    }
}
} 
```

Utils.cs:

```
using System;
using System.Diagnostics;
using System.Management;
using System.Runtime.InteropServices;
using System.Threading;

namespace ComputerControl
{
public class Utils
{
    public static int index;

    static byte[] supportedBrightness;

    public static void IncrementBrightness()
    {
        if (index == supportedBrightness.Length - 1)
            return;

        SetBrightness(++index);
    }

    public static void DecrementBrightness()
    {
        if (index == 0)
            return;

        SetBrightness(--index);
    }

    public static void SetBrightness(int index)
    {
        ManagementScope ms = new ManagementScope("root\\WMI");
        SelectQuery sq = new SelectQuery("WmiMonitorBrightnessMethods");

        ManagementObjectSearcher mos = new ManagementObjectSearcher(ms, sq);

        ManagementObjectCollection moc = mos.Get(); // Context <id> is disconnected.  No proxy will be used to service the request on the COM component. This may cause corruption or data loss. To avoid this problem, please ensure that all contexts/apartments stay alive until the application is completely done with the RuntimeCallableWrappers that represent COM components that live inside them.

        foreach (ManagementObject mo in moc)
        {
            mo.InvokeMethod("WmiSetBrightness", new object[] { 60, supportedBrightness[index] });
            break;
        }

        moc.Dispose();
        mos.Dispose();
    }

    public static int GetCurrentBrightness()
    {
        ManagementScope ms = new ManagementScope("root\\WMI");
        SelectQuery sq = new SelectQuery("WmiMonitorBrightness");

        ManagementObjectSearcher mos = new ManagementObjectSearcher(ms, sq);

        ManagementObjectCollection moc = mos.Get();

        byte currentBrightness = 0;

        foreach(ManagementObject mo in moc)
        {
            currentBrightness = (byte)mo.GetPropertyValue("CurrentBrightness");
            break;
        }

        moc.Dispose();
        mos.Dispose();

        return (int)currentBrightness;
    }

    public static bool LoadBrightnessLevels()
    {
        supportedBrightness = GetBrightnessLevels();

        if (supportedBrightness.Length > 0)
        {
            int current = GetCurrentBrightness();
            index = Array.IndexOf(supportedBrightness, (byte)current);
        }

        return supportedBrightness.Length != 0;
    }

    public static byte[] GetBrightnessLevels()
    {
        ManagementScope ms = new ManagementScope("root\\WMI");
        SelectQuery sq = new SelectQuery("WmiMonitorBrightness");

        ManagementObjectSearcher mos = new ManagementObjectSearcher(ms, sq);

        byte[] levels = new byte[0];

        try
        {
            ManagementObjectCollection moc = mos.Get();

            foreach (ManagementObject o in moc)
            {
                levels = (byte[])o.GetPropertyValue("Level");
                break;
            }

            moc.Dispose();
        }
        catch { }

        mos.Dispose();

        return levels;
    }

    [StructLayout(LayoutKind.Sequential)]
    struct KeyboardHookStruct
    {
        public int VirtualKeyCode;
        public int ScanCode;
        public int Flags;
        public int Time;
        public IntPtr ExtraInfo;
    }

    public static IntPtr _hook = IntPtr.Zero;

    public static void SetHook()
    {
        _hook = SetWindowsHookEx(13, HookCallback, GetModuleHandle(Process.GetCurrentProcess().MainModule.ModuleName), 0);
    }

    public static void Unhook()
    {
        UnhookWindowsHookEx(_hook);
    }

    public delegate IntPtr LowLevelKeyBoardProc(int nCode, IntPtr wParam, IntPtr lParam);

    public static IntPtr HookCallback(int nCode, IntPtr wParam, IntPtr lParam)
    {
        Console.WriteLine(Thread.CurrentThread.ManagedThreadId);

        if (nCode >= 0 && wParam == (IntPtr)0x0100)
        {
            KeyboardHookStruct khs = (KeyboardHookStruct)Marshal.PtrToStructure(lParam, typeof(KeyboardHookStruct));

            // up is SC:8, VK:255, down is SC:9, VK:255
            if (khs.VirtualKeyCode == 255)
            {
                if (khs.ScanCode == 8)
                {
                    IncrementBrightness();
                    Console.WriteLine("Brightness up! {0}", supportedBrightness[index]);
                }
                else if (khs.ScanCode == 9)
                {
                    DecrementBrightness();
                    Console.WriteLine("Brightness down! {0}", supportedBrightness[index]);
                }
            }
        }

        return CallNextHookEx(_hook, nCode, wParam, lParam);
    }

    [DllImport("user32.dll")]
    public static extern IntPtr SetWindowsHookEx(int idHook, LowLevelKeyBoardProc lpfn, IntPtr hMod, uint dwThreadId);

    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool UnhookWindowsHookEx(IntPtr hhk);

    [DllImport("user32.dll")]
    private static extern IntPtr CallNextHookEx(IntPtr hhk, int nCode, IntPtr wParam, IntPtr lParam);

    [DllImport("user32.dll")]
    private static extern uint MapVirtualKeyEx(uint uCode, uint uMapType, IntPtr dwhkl);

    [DllImport("kernel32.dll")]
    private static extern IntPtr GetModuleHandle(string lpModuleName);
}
} 
```

Program.cs:

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;

namespace ComputerControl
{
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new HiddenForm());

        // Check if the hook is set, and if it is, unhook it.
        if (Utils._hook.ToInt32() > 0)
            Utils.Unhook();
    }
}
} 
```

All help is appreciated! Thanks!

# php - 使用 PHP 从数据库中检索后的值求和

> ID：10058589
> 
> 赞同：2
> 
> 时间：2012-04-07T21:35:55.773
> 
> 标签：php, codeigniter, codeigniter-2

我正在从 mysql 数据库中获取一些信息，并使用以下脚本显示它（我正在使用 Codeigniter）

```
 <?php if(count($records) > 0) { ?>

   <?php $i = $this->uri->segment(3) + 0; foreach ($records as $row){ $i++; ?>
<?php echo $row['amount']; ?>    <br>

<?php  } ?>

<?php } else { echo "No Record Found";} ?> 
```

我得到的输出如下

```
10,000
20,000.34
15,250.50 
```

现在我要做的是总结所有的值`$row['amount'];`并将总和的值放入，`$sum_value`这样当我回显 $sum_value 时，我得到以下值

```
45,250.84 
```

请你告诉我怎么做。

我知道我可以使用 mysql 完成求和的事情，但我想学习如何做到这一点。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T21:40:52.353

通过 foreach 的每个循环迭代地添加到您的总和：

```
$sum = 0;
foreach ( $records as $row ) {
  $sum += str_replace(",", "", $row['amount']);
}

echo number_format( $sum, 2 ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T21:41:17.837

也许是这样的：

```
<?
if(count($records) > 0) {
   $i = $this->uri->segment(3) + 0; 
   $sum_value = 0;
   foreach ($records as $row){ 

      $i++; // Don't know what you use $i for, get rid of it if unnecessary

      // Add value to the sum
      $sum_value += (float)str_replace(",", "", $row["amount"]); 

      // Print the current value
      echo $row['amount'] + "<br/>";

   }

   echo $sum_value;  // Print the total sum after the loop

} else { 
   echo "No Record Found";
} ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T21:47:05.293

首先，您需要将其转换为正确的数字：

```
$nums = array_map(function(&$row) {
   return (float) str_replace(',', '',$row['amount']);
}, $records); 
```

然后你可以使用`array_sum`：

```
echo number_format(array_sum($nums), 2); 
```

# windows - How to access the disks mapped through RDP from a service?

> ID：10058590
> 
> 赞同：3
> 
> 时间：2012-04-07T21:36:11.187
> 
> 标签：windows, rdp, unc

RDP has this fantastic ability to let export disks from remote user's workstation to the RDP server. As far as I can tell, it is not just a windows explorer trick, but all kinds of programs can use the shortcuts "X:", "Y:", "Z:" etc... This [stack overflow entry](https://stackoverflow.com/questions/9304953/copy-files-from-remote-rdp-to-local-machine) on RDP disk copying mentions the '\tsclient' alias which points to the machine of the RDP user. Now, it is obvious that if there are 2 or more users, they will each have their own, non-conflicting tsclient destinations.

So, my question is this: how do I get a list of and access all remote user shared resources (disks) from a service? Ideally, if, say 2 users have connected and have shared their C: drives, i'd get a list like:

*   \UserJohnDoe\VolumeXyzC - John's C drive
*   \UserJaneRoe\VolumeXyzC - Jane's C drive

Help appreciated! UPDATE:

Here's a working piece of code ([gist snippet](https://gist.github.com/3173572))

```
// rdpjoker by Konrads

#include "stdafx.h"
#define SERVER "XXX.compute-1.amazonaws.com"
#define CMD  "cmd.exe /C dir \\tsclient\\c >output.txt"

int main(int argc, char **argv){
    HANDLE server;
    PWTS_SESSION_INFOA ppSessionInfo=NULL;
    WTS_SESSION_INFOA pSessionInfo;
    DWORD pCount;
    DWORD pLevel=1;
    DWORD i=0;
    LPSTR ppBuffer;
    DWORD bytesReturned;    
    HANDLE userToken=NULL;
    HANDLE pUserToken=NULL;
    ULONG sessionid;
    DWORD dwCreationFlags=0;
    LPVOID environment=NULL;
    STARTUPINFOA si;
    PROCESS_INFORMATION pi;
    char *cmdline;
    char *username;
    char *homedir;//[MAX_PATH];
    char desktop[8192];

    server=WTSOpenServerA(WTS_CURRENT_SERVER_NAME);
    if(argc>2){
        sessionid=atol(argv[1]);
        printf("[*] Impersonating session: %i\n",sessionid);
        if(WTSQueryUserToken(sessionid,&userToken)){
            //if(DuplicateTokenEx(userToken,MAXIMUM_ALLOWED,NULL,SecurityIdentification,TokenPrimary,&pUserToken)){
                if(CreateEnvironmentBlock(&environment,pUserToken,FALSE)){
                    ZeroMemory( &si, sizeof( STARTUPINFO ) );
                    //WTSQuerySessionInformationA(server,sessionid,WTSWinStationName,&ppBuffer,&bytesReturned);
                    //sprintf_s(desktop,8192,"%s\\default",ppBuffer);
                    si.lpDesktop = "winsta0\\default";;
                    si.cb=sizeof(STARTUPINFO);
                    //WTSFreeMemory(ppBuffer);
                    ZeroMemory( &pi,sizeof(pi));
                    cmdline=(char *)malloc(MAX_PATH +1);
                    //GetUserProfileDirectoryA(userToken,homedir,&bytesReturned);
                    //WTSUserConfigTerminalServerProfilePath
                    //WTSQuerySessionInformationA(server,sessionid,WTSUserName,&ppBuffer,&bytesReturned);   
                    WTSQuerySessionInformationA(server,sessionid,WTSUserName,&ppBuffer,&bytesReturned);

                    username=_strdup(ppBuffer);
                    WTSFreeMemory(ppBuffer);
                    //WTSQueryUserConfigA(WTS_CURRENT_SERVER_NAME,username,WTSUserConfigTerminalServerProfilePath,&ppBuffer,&bytesReturned);
                    homedir=(char *)malloc(MAX_PATH);
                    sprintf_s(homedir,MAX_PATH,"C:\\Users\\%s\\",username);
                    //homedir=_strdup(ppBuffer);
                    //WTSFreeMemory(ppBuffer);
                    printf("[D] homedir: %s\n",homedir);
                    sprintf_s(cmdline,MAX_PATH,"cmd.exe /C dir %s >output.txt",argv[2]);
                    dwCreationFlags|= CREATE_UNICODE_ENVIRONMENT | NORMAL_PRIORITY_CLASS | CREATE_NEW_CONSOLE;

                    //WTSQuerySessionInformationA(server,sessionid,WTSWinStationName,&ppBuffer,&bytesReturned);
                    //printf("station: %s",ppBuffer);

                    if(CreateProcessAsUserA(userToken,
                        NULL,
                        cmdline,
                        NULL,
                        NULL,
                        FALSE,
                        dwCreationFlags,
                        environment,
                        homedir,
                        &si,
                        &pi)){
                            printf("[*]CreateProcessAsUserA succeeded! pid:%i, tid:%i\n",pi.dwProcessId,pi.dwProcessId);
                    }else{
                        printf("[E] CreateProcessAsUserA failed: %i\n", GetLastError());
                    }

                //}else{
                    //printf("[E] CreateEnvironmentBlock failed: %i\n", GetLastError());
        //      }
        }else{
                    printf("[E] DuplicateTokenEx failed: %i\n", GetLastError());
                }

        }
        else{
            printf("[E] WTSQueryUserToken failed: %i\n", GetLastError());
            exit(-1);
        }
    }

    else{ // no arguments specified
        if(WTSEnumerateSessionsA(server,0,1,&ppSessionInfo,&pCount)){

            //  printf("pCount: %i,",pCount);
            for (i=0;i<pCount;++i){
                //  printf("i = %i\n",i);
                pSessionInfo=ppSessionInfo[i];
                printf("Session ID: %i; name: %s, ",pSessionInfo.SessionId,pSessionInfo.pWinStationName);
                if(WTSQuerySessionInformationA(server,pSessionInfo.SessionId,WTSUserName,&ppBuffer,&bytesReturned)){
                    printf("user: %s, ",ppBuffer);
                    WTSFreeMemory(ppBuffer);
                }else{
                    printf("WTSQuerySessionInformation[WTSUserName] failed: %i\n", GetLastError());
                }
                if(WTSQuerySessionInformationA(server,pSessionInfo.SessionId,WTSWinStationName,&ppBuffer,&bytesReturned)){
                    printf("station: %s",ppBuffer);
                    WTSFreeMemory(ppBuffer);
                }else{
                    printf("WTSQuerySessionInformation[WTSWinStationName] failed: %i\n", GetLastError());
                }
                printf("\n");
            }
            WTSFreeMemory(ppSessionInfo);
        }else //0014fb3c
        {
            printf("EnumerateSessions failed: %i\n", GetLastError());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T22:00:44.043

我认为您可以使用 来实现此目的`CreateProcessAsUser`，但您需要检索用户会话的令牌，您可以通过[`WTSQueryUserToken`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383840.aspx).

# python - 如何在 Python 2.x 上打开 UTF-16 文件？

> ID：10058591
> 
> 赞同：14
> 
> 时间：2012-04-07T21:36:26.037
> 
> 标签：python, unicode

我正在开发一个必须能够打开 UTF-8 和 UTF-16 编码文件的 Python 工具。在 Python 3.2 中，我使用以下代码尝试使用 UTF-8 打开文件，然后在出现 unicode 错误时使用 UTF-16 尝试：

```
def readGridFromPath(self, filepath):
    try:
        self.readGridFromFile(open(filepath,'r',encoding='utf-8'))
    except UnicodeDecodeError:
            self.readGridFromFile(open(filepath,'r',encoding='utf-16')) 
```

（`readGridFromFile`要么运行到完成，要么引发一个`UnicodeDecodeError`. ）

但是，当我在 Python 2.x 中运行此代码时，我得到：

```
TypeError: 'encoding' is an invalid keyword argument for this function 
```

我在文档中看到 Python 2.x`open()`没有`encoding`关键字。有什么办法可以让我的代码与 Python 2.x 兼容？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-07T21:57:46.227

`io.open`是您需要的替代品，因此您提供的代码示例在 Python 2.x 中将如下所示：

```
import io

def readGridFromPath(self, filepath):
    try:
        self.readGridFromFile(io.open(filepath, 'r', encoding='utf-8'))
    except UnicodeDecodeError:
        self.readGridFromFile(io.open(filepath, 'r', encoding='utf-16')) 
```

`io.open`[这里](http://docs.python.org/library/io.html#io.open)有详细描述。它的原型是：

> io.open（*文件，模式='r'，缓冲=-1，**编码=无**，错误=无，换行=无，closefd=真*）

`io`模块本身被设计为 Python 2.x 和 Python 3.x 之间的兼容层，以简化向 Py3k 的过渡并简化现有 Python 2.x 代码的反向移植和维护。

另外，请注意使用 可能有一个警告`codecs.open`，因为它[**仅**](http://docs.python.org/library/codecs.html#codecs.open)[在二进制模式下工作](http://docs.python.org/library/codecs.html#codecs.open)**：**

 **> **注意：**文件总是以二进制模式打开，即使没有指定二进制模式。这样做是为了避免由于使用 8 位值进行编码而导致的数据丢失。这意味着在读写时不会自动转换 '\n'`。

此外，您可能会遇到手动检测和剥离 UTF8 BOM 的问题——`codecs.open`将 UTF8 BOM 内联保留为`u'\ufeff'`字符。**

# c - 访问模块内的 IRQ 描述数组并显示动作名称

> ID：10058594
> 
> 赞同：2
> 
> 时间：2012-04-07T21:36:51.510
> 
> 标签：c, linux-kernel, kernel, linux-device-driver, irq

我正在用 C 编写一个内核模块，该模块正在努力访问 IRQ 描述数组元素并显示这些元素的所有操作名称。

一开始，我认为这个 irq_desc 数组有点像宏，但编译后我明白它不是。然后我使用了 for_each_irq_desc(irq, desc) 函数。但这次它返回了一个警告：

警告：“irq_to_desc”[/home/samet/Masaüstü/Assignment3/Ass-1.ko] 未定义！

在此警告之后，我尝试将模块安装到内核中，这次弹出错误消息：

insmod：插入'./Ass-1.ko'时出错：模块中的-1未知符号

在此之后，我包含了我认为与此过程相关的所有头文件，但没有任何改变。

因为它很短，所以我附上代码：

```
#include <linux/module.h>   
#include <linux/kernel.h>   
#include <linux/init.h>     
#include <linux/sched.h>    
#include <linux/irq.h>
#include <linux/irqdesc.h>
#include <linux/irqnr.h>

struct task_struct* p;
struct irq_desc* irqElement;
int irq, desc;

static int __init ass_1_init(void)
{
    printk(KERN_INFO "Ass-1 module is starting...\n");

    for_each_process(p){printk("%d\t%s\n", p->pid, p->comm);}

    for_each_irq_desc(irq, irqElement){printk("%p\n", irqElement);}

    return 0;
}

static void __exit ass_1_exit(void)
{
    printk(KERN_INFO "Ass-1 module is finishing...\n");
}

module_init(ass_1_init);
module_exit(ass_1_exit); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-08T10:44:03.677

我觉得你真的高估了我的能力。这是我的第一个 hello world 内核模块。但如果有的话，经验告诉我程序员为王。如果你想要什么，定义它。

内核头文件不想将 irq 暴露给模块，这很清楚，所以我敢打赌这不会被支持，这通常是个坏主意。但我们不在乎这个。我们是黑客！

```
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>     
#include <linux/sched.h>    
#include <linux/irq.h>
#include <linux/irqnr.h>
#include <linux/irqdesc.h>

#define irq_to_desc(irq)        (&irq_desc[irq])
#define nr_irqs NR_IRQS
struct irq_desc irq_desc[NR_IRQS];

struct irq_desc *irqElement;
int irq;
int init_module(void)
{
    printk(KERN_INFO "I HAZ MODULE\n");
    for_each_irq_desc(irq, irqElement){printk("%p\n", irqElement);}
    return 0;
}

void cleanup_module(void)
{
    printk(KERN_INFO "BAI MODULE!!!1\n");
} 
```

# c++ - 创建 new obj() 时如何调用基类构造函数 new base(argT argV)？

> ID：10058596
> 
> 赞同：0
> 
> 时间：2012-04-07T21:37:05.563
> 
> 标签：c++, oop, c++03

所以我有一个`base`带有构造函数的类，它采用`(T V)`. 我继承`obj`了具有构造函数的类，`()`我想创建类似的东西

```
base * new_list_item = new obj() 
```

但是如何`T val;`在 C++ 中传递给 obj 基本构造函数值呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T21:39:19.483

使用初始化列表：

```
class obj : public base {
public:
    obj(T v) : base(v)
    {}
}; 
```

# android - Paypal 作为存款

> ID：10058599
> 
> 赞同：0
> 
> 时间：2012-04-07T21:37:47.207
> 
> 标签：android, paypal

我已经看到他们想要禁止在 Android 市场（Google Play）中进行其他支付的消息，所以也正因为如此，我的问题是我可以将 PayPal 集成到市场应用程序中，我可以使用 Paypal 作为信用卡吗处理器的存款。

所以阻止 100 欧元，-，我在几个小时后返回..

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:50:02.630

从技术上讲，你可以，是的。您是否会从 Google Play 中删除是另一个问题。根据[一些文章](http://www.mercurynews.com/top-stories/ci_20131998)，有些开发人员被明确告知不要使用 PayPal，而是使用 Google 钱包，否则将面临从市场上移除的风险。

# objective-c - 新 iPad 在 presentPopoverFromRect 上导致 EXC_BAD_ACCESS

> ID：10058601
> 
> 赞同：0
> 
> 时间：2012-04-07T21:38:16.333
> 
> 标签：objective-c, ios, ipad

我的应用程序在为图像选择器显示 Popover 时崩溃，但仅在新的 iPad 3 上。我认为它与新分辨率有关。

我展示 Popover 的代码：

```
[popoverController presentPopoverFromRect:[selectPhotoButton frame] inView:self.view permittedArrowDirections:UIPopoverArrowDirectionUp animated:YES]; 
```

在 iPad 1 和 iPad 2 上运行良好，但对于“新 iPad”，我收到以下崩溃/消息：

```
Thread 1: EXC_BAD_ACCESS (code=2, address=0x24) 
```

知道是什么原因造成的吗？我的 App Store 评分每分钟都在下降..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T02:13:52.437

任何一个：

*   `popover`已解除分配，但指针未设置为 nil
*   `selectPhotoButton`已解除分配，但指针未设置为 nil
*   `self.view`已解除分配，但指针未设置为 nil

# c# - While(true) 循环使我的程序无法启动

> ID：10058603
> 
> 赞同：0
> 
> 时间：2012-04-07T21:38:40.203
> 
> 标签：c#, xna

我正在尝试制作一个使用 XNA 的 SteamRE 机器人，现在，我刚刚创建了一个新的 XNA 项目，并在其上添加了 SteamRE 示例代码，如果我运行它，它工作正常，但事实是，它没有实际上启动了 XNA 窗口，所以它不能寻找键盘处理等。

如果我删除 while(true) 循环它可以工作，但它不会连接。

这是我的代码，如果你们可以看看这个并帮助我，那就太好了。

```
namespace Steam
{
  public class Game1 : Microsoft.Xna.Framework.Game
  {
    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;

    string userName = "username";
    string passWord = "password";

    SteamClient steamClient = new SteamClient(); // initialize our client
    SteamUser steamUser;
    SteamFriends steamFriends;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";
    }

    protected override void Initialize()
    {
        base.Initialize();
    }

    protected override void LoadContent()
    {
        spriteBatch = new SpriteBatch(GraphicsDevice);

        steamUser = steamClient.GetHandler<SteamUser>(); // we'll use this later to logon
        steamFriends = steamClient.GetHandler<SteamFriends>();

    }

    protected override void UnloadContent()
    {
    }

    KeyboardState oldState = Keyboard.GetState();

    protected override void Update(GameTime gameTime)
    {
        if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
            this.Exit();

        ConnectSteam();

        base.Update(gameTime);
    }

    public void ConnectSteam() 
    {
        steamClient.Connect(); // connect to the steam network

        while (true)
        {
            CallbackMsg msg = steamClient.WaitForCallback(true); // block and wait until a callback is posted

            msg.Handle<SteamClient.ConnectCallback>(callback =>
            {
                // the Handle function will call this lambda method for this callback

                if (callback.Result != EResult.OK)
                {
                    Console.WriteLine("Failed. 1");
                }
                //break; // the connect result wasn't OK, so something failed

                // we've successfully connected to steam3, so lets logon with our details
                Console.WriteLine("Connected to Steam3.");
                steamUser.LogOn(new SteamUser.LogOnDetails
                {
                    Username = userName,
                    Password = passWord,
                });
                Console.WriteLine("Logged on.");
            });
            msg.Handle<SteamUser.LogOnCallback>(callback =>
            {
                if (callback.Result != EResult.OK)
                {
                    Console.WriteLine("Failed. 2");
                }

                // we've now logged onto Steam3
            });
        }
    }

    public void ConnectToFPP() 
    {
        KeyboardState newState = Keyboard.GetState();  // get the newest state

        // handle the input
        if (oldState.IsKeyUp(Keys.Space) && newState.IsKeyDown(Keys.Space))
        {
            steamFriends.JoinChat(110338190871147670);
        }

        oldState = newState;  // set the new state as the old state for next time
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);

        base.Draw(gameTime);
    }
  }
  } 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:46:47.700

我不是 XNA 方面的专家，但我看到您正在使用必须处理非场景的窗口`while(true)`内部循环`Update()`方法，但窗口控制更新（实际上即使场景更新从这个角度来看也不会改变）。

您在尝试连接到某些服务时遇到了无限循环。您在创建窗口的同一线程上运行它，以便阻止窗口。我建议你使用多线程，所以在你试图连接另一个线程的地方运行代码。使用[`ThreadPool.QueueUserWorkItem`](http://msdn.microsoft.com/en-us/library/kbf0f1ct.aspx)或其他方式运行线程并向用户提供程序正在连接的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:01:20.453

据我所知，问题在于，除非您需要不断连接，否则您需要在实际连接时中断 ConnectSteam 代码。

```
Console.WriteLine("Logged on.");
break; 
```

或者，你可以有一个 isConnected 变量（非常伪代码）：

```
bool isConnected = false
while(!isConnected)
{
    isConnected = LogonCode;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T14:30:54.350

正如其他人指出的那样，问题出在`while(true)`片段中。即使你成功连接，你也永远不会跳出循环。即使`break;`连接后可以解决问题，您仍然会阻止整个过程运行，直到建立连接。

最好的解决方案是删除while，并且每帧一次（或第二次，或异步调用使用的等待时间的两倍），如果未建立连接，则**仅尝试一次**以再次连接。由于您的连接代码是异步的，您的游戏将继续循环，您可以继续在屏幕上绘制并通知用户事情进展如何。

```
protected override void Update (GameTime gameTime)
{
    // ...
    if (!connected && !tryingToConnect)
    {
        ConnectSteam();

        // Remember to set to false once connection is established
        showConnectingDialog = true;
    } else
    {

    }
    // ...
}

protected override void Draw (GameTime gameTime)
{
    // ...
    if (showConnectingDialog)
    {
        SpriteBatch.DrawString(SpriteFont, "Connecting to Steam servers...", Vector2.Zero, Color.White);
    } else
    {
        // ...
    }
} 
```

# c++ - 按字符拆分字符串

> ID：10058606
> 
> 赞同：63
> 
> 时间：2012-04-07T21:39:00.763
> 
> 标签：c++, string, algorithm

我知道这是一个非常简单的问题，但我只想一劳永逸地为自己解决它

我只想使用字符作为拆分分隔符将字符串拆分为数组。（很像 C# 著名的**.Split()**函数。我当然可以应用蛮力方法，但我想知道是否有比这更好的方法。

到目前为止，我已经搜索过并且可能**最接近**的解决方案方法是使用**strtok()**，但是由于它的不便（将您的字符串转换为 char 数组等），我不喜欢使用它。有没有更简单的方法来实现这个？

**注意：**我想强调这一点，因为人们可能会问“为什么蛮力不起作用”。我的蛮力解决方案是创建一个循环，并在里面使用**substr()**函数。但是，由于它需要**起点**和长度，所以当我想拆分日期时它会失败。因为用户可能将其输入为 2012 年 7 月 12 日或 2011 年 7 月 3 日，在计算“/”分隔符的下一个位置之前，我可以真正知道长度。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-04-07T21:59:19.270

使用向量、字符串和字符串流。有点麻烦，但可以解决问题。

```
#include <string>
#include <vector>
#include <sstream>

std::stringstream test("this_is_a_test_string");
std::string segment;
std::vector<std::string> seglist;

while(std::getline(test, segment, '_'))
{
   seglist.push_back(segment);
} 
```

这会产生一个与以下内容相同的向量

```
std::vector<std::string> seglist{ "this", "is", "a", "test", "string" }; 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-04-07T22:04:05.027

Boost 具有您正在寻找的**split()**`algorithm/string.hpp`：

```
std::string sample = "07/3/2011";
std::vector<std::string> strs;
boost::split(strs, sample, boost::is_any_of("/")); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-04-07T22:04:11.797

喜欢 RegEx 的人的另一种方式（C++11/boost）。就我个人而言，我是此类数据的 RegEx 的忠实粉丝。IMO 它比简单地使用分隔符拆分字符串要强大得多，因为如果您愿意，您可以选择更聪明地了解“有效”数据的构成。

```
#include <string>
#include <algorithm>    // copy
#include <iterator>     // back_inserter
#include <regex>        // regex, sregex_token_iterator
#include <vector>

int main()
{
    std::string str = "08/04/2012";
    std::vector<std::string> tokens;
    std::regex re("\\d+");

    //start/end points of tokens in str
    std::sregex_token_iterator
        begin(str.begin(), str.end(), re),
        end;

    std::copy(begin, end, std::back_inserter(tokens));
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-08T03:49:48.557

另一种可能性是为流注入使用特殊`ctype`方面的语言环境。流使用 ctype 方面来确定什么是“空白”，它将其视为分隔符。使用将分隔符分类为空格的 ctype 方面，读取可能非常简单。这是实现方面的一种方法：

```
struct field_reader: std::ctype<char> {

    field_reader(): std::ctype<char>(get_table()) {}

    static std::ctype_base::mask const* get_table() {
        static std::vector<std::ctype_base::mask> 
            rc(table_size, std::ctype_base::mask());

        // we'll assume dates are either a/b/c or a-b-c:
        rc['/'] = std::ctype_base::space;
        rc['-'] = std::ctype_base::space;
        return &rc[0];
    }
}; 
```

我们使用它`imbue`来告诉流使用包含它的语言环境，然后从该流中读取数据：

```
std::istringstream in("07/3/2011");
in.imbue(std::locale(std::locale(), new field_reader); 
```

有了它，拆分变得几乎是微不足道的——只需使用几个`istream_iterator`s 初始化一个向量来从字符串中读取片段（嵌入在 中`istringstream`）：

```
std::vector<std::string>((std::istream_iterator<std::string>(in),
                          std::istream_iterator<std::string>()); 
```

显然，如果您只在一个地方使用它，这往往会过度杀伤力。但是，如果您经常使用它，它可以在很大程度上保持其余代码的干净。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-04-12T03:24:48.173

我天生不喜欢`stringstream`，虽然我不知道为什么。今天，我编写了这个函数来允许将`std::string`任意字符或字符串拆分为向量。我知道这个问题很老，但我想分享另一种拆分方式`std::string`。

此代码完全省略了您从结果中拆分的字符串部分，尽管可以轻松修改它以包含它们。

```
#include <string>
#include <vector>

void split(std::string str, std::string splitBy, std::vector<std::string>& tokens)
{
    /* Store the original string in the array, so we can loop the rest
     * of the algorithm. */
    tokens.push_back(str);

    // Store the split index in a 'size_t' (unsigned integer) type.
    size_t splitAt;
    // Store the size of what we're splicing out.
    size_t splitLen = splitBy.size();
    // Create a string for temporarily storing the fragment we're processing.
    std::string frag;
    // Loop infinitely - break is internal.
    while(true)
    {
        /* Store the last string in the vector, which is the only logical
         * candidate for processing. */
        frag = tokens.back();
        /* The index where the split is. */
        splitAt = frag.find(splitBy);
        // If we didn't find a new split point...
        if(splitAt == std::string::npos)
        {
            // Break the loop and (implicitly) return.
            break;
        }
        /* Put everything from the left side of the split where the string
         * being processed used to be. */
        tokens.back() = frag.substr(0, splitAt);
        /* Push everything from the right side of the split to the next empty
         * index in the vector. */
        tokens.push_back(frag.substr(splitAt+splitLen, frag.size()-(splitAt+splitLen)));
    }
} 
```

要使用，只需像这样调用...

```
std::string foo = "This is some string I want to split by spaces.";
std::vector<std::string> results;
split(foo, " ", results); 
```

您现在可以随意访问向量中的所有结果。就这么简单——不`stringstream`，没有第三方库，没有回退到 C！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-04-13T20:24:20.930

由于尚未有人发布此内容：[c++20](/questions/tagged/c%2b%2b20 "显示标记为“c++20”的问题")解决方案非常简单，使用`ranges`. 您可以使用 a`std::ranges::views::split`来分解输入，然后将输入转换为`std::string`或`std::string_view`元素。

```
#include <ranges>

...

// The input to transform
const auto str = std::string{"Hello World"};

// Function to transform a range into a std::string
// Replace this with 'std::string_view' to make it a view instead.
auto to_string = [](auto&& r) -> std::string {
    const auto data = &*r.begin();
    const auto size = static_cast<std::size_t>(std::ranges::distance(r));

    return std::string{data, size};
};

const auto range = str | 
                   std::ranges::views::split(' ') | 
                   std::ranges::views::transform(to_string);

for (auto&& token : str | range) {
    // each 'token' is the split string
} 
```

这种方法实际上可以组合成任何东西，甚至是一个`split`返回 a 的简单函数`std::vector<std::string>`：

```
auto split(const std::string& str, char delimiter) -> std::vector<std::string>
{
    const auto range = str | 
                       std::ranges::views::split(delimiter) | 
                       std::ranges::views::transform(to_string);

    return {std::ranges::begin(range), std::ranges::end(range)};
} 
```

`[Live Example](https://gcc.godbolt.org/z/dodxK9WE7)`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-07T21:40:35.597

看看[boost::tokenizer](http://www.boost.org/doc/libs/1_48_0/libs/tokenizer/)

如果您想汇总自己的方法，可以使用[`std::string::find()`](http://en.cppreference.com/w/cpp/string/basic_string/find)确定拆分点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-07T22:02:33.537

您是否有不想将 a 转换`string`为字符数组 ( `char*`) 的原因？调用起来相当容易`.c_str()`。您还可以使用循环和`.find()`函数。

[字符串类](http://www.cplusplus.com/reference/string/string/)
[字符串 .find()](http://www.cplusplus.com/reference/string/string/find/)
[字符串 .c_str()](http://www.cplusplus.com/reference/string/string/c_str/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-07T10:57:48.427

对于那些没有（想要，需要）`C++20`这个`C++11`解决方案的人来说可能是一种选择。

它在输出迭代器上进行了模板化，因此您可以提供自己的目的地，拆分项目应附加到该目的地，并提供如何处理多个连续分隔字符的选择。

是的，它使用`std::regex`但很好，如果你已经在 C++11 快乐的土地上，为什么不使用它。

```
////////////////////////////////////////////////////////////////////////////
//
// Split string "s" into substrings delimited by the character "sep"
// skip_empty indicates what to do with multiple consecutive separation
// characters:
//
// Given s="aap,,noot,,,mies"
//       sep=','
//
// then output gets the following written into it:
//      skip_empty=true  => "aap" "noot" "mies"
//      skip_empty=false => "aap" "" "noot" "" "" "mies"
//
////////////////////////////////////////////////////////////////////////////
template <typename OutputIterator>
void string_split(std::string const& s, char sep, OutputIterator output, bool skip_empty=true) {
    std::regex  rxSplit( std::string("\\")+sep+(skip_empty ? "+" : "") );

    std::copy(std::sregex_token_iterator(std::begin(s), std::end(s), rxSplit, -1),
              std::sregex_token_iterator(), output);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-09T14:08:30.257

我知道这个解决方案不合理，但它是有效的。此处提供此方法是为了作为当前问题解决方案的一种变体。

```
#include <iostream>
#include <vector>
#include <string>
using namespace std;
const int maximumSize=40;
vector<int> visited(maximumSize, 0);
string word;
void showContentVectorString(vector<string>& input)
{
    for(int i=0; i<input.size(); ++i)
    {
        cout<<input[i]<<", ";
    }
    return;
}
void dfs(int current, int previous, string& input, vector<string>& output, char symbol)
{
    if(visited[current]==1)
    {
        return;
    }
    visited[current]=1;
    string stringSymbol;
    stringSymbol.push_back(symbol);
    if(input[current]!=stringSymbol[0])
    {
        word.push_back(input[current]);
    }
    else
    {
        output.push_back(word);
        word.clear();
    }
    if(current==(input.size()-1))
    {
        output.push_back(word);
        word.clear();
    }
    for(int next=(current+1); next<input.size(); ++next)
    {
        if(next==previous)
        {
            continue;
        }
        dfs(next, current, input, output, symbol);
    }
    return;
}
void solve()
{
    string testString="this_is_a_test_string";
    vector<string> vectorOfStrings;
    dfs(0, -1, testString, vectorOfStrings, '_');
    cout<<"vectorOfStrings <- ";
    showContentVectorString(vectorOfStrings);
    return;
}
int main()
{
    solve();
    return 0;
} 
```

结果如下：

```
vectorOfStrings <- this, is, a, test, string, 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-19T05:02:35.353

我已经使用了很长一段时间的一个解决方案是可以与向量和列表一起使用的拆分

```
#include <vector>
#include <string>
#include <list>

template< template<typename,typename> class Container, typename Separator >
Container<std::string,std::allocator<std::string> > split( const std::string& line, Separator sep ) {
    std::size_t pos = 0;
    std::size_t next = 0;
    Container<std::string,std::allocator<std::string> > fields;
    while ( next != std::string::npos ) {
        next = line.find_first_of( sep, pos );
        std::string field = next == std::string::npos ? line.substr(pos) : line.substr(pos,next-pos);
        fields.push_back(  field );
        pos = next + 1;
    }
    return fields;
}

int main() {
    auto res1 = split<std::vector>( "abc,def", ",:" );
    auto res2 = split<std::list>( "abc,def", ',' );
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2019-08-19T13:30:15.520

`erase()`功能呢？如果您知道字符串中要拆分的确切位置，那么您可以使用`erase()`.

```
std::string date("01/02/2019");
std::string day(date);
std::string month(date);
std::string year(date);

day.erase(2, string::npos); // "01"
month.erase(0, 3).erase(2); // "02"
year.erase(0,6); // "2019" 
```

# google-app-engine - 谷歌应用引擎 JDO 3

> ID：10058607
> 
> 赞同：8
> 
> 时间：2012-04-07T21:39:02.853
> 
> 标签：google-app-engine, google-cloud-datastore, datanucleus

Google 刚刚推出了用于 Google App Engine 的 JDO 3.0（它使用 DataNucleus 2.0），我想使用它，因为它可以方便地支持无主关系。我已经尝试了好几天，但我不知道如何将它与 Google Eclipse 插件一起使用。我找到了这个网页[https://developers.google.com/appengine/docs/java/datastore/jdo/overview-dn2](https://developers.google.com/appengine/docs/java/datastore/jdo/overview-dn2)，但我的项目文件夹没有 build.xml 文件。我尝试创建一个单独的项目并传输我的所有代码，但新项目没有 JDO 3.0，也没有 build.xml 文件。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-11T02:03:21.150

我刚刚安装了新的 Eclipse 和 GPE（因为升级我的 Eclipse 完全破坏了它，我别无选择）。

你更新你的 GPE 版本了吗？我的是：

Eclipse 4.2 3.1.0.v201208080121-rel-r42 的谷歌插件

之后，您应该可以通过在 Google / App Engine 下的项目属性中选择 Datanucleus JDO/JPA v2 来切换到 JDO 3.0。据我了解，通过查看复制到输出目录的 jar，GPE v2 实际上是 JDO v3.0。我的是 /war/WEB-INF/lib/datanucleus-api-jdo-3.0.7.jar

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T10:57:17.347

您可以按照此处的指南将项目构建切换到 ant： [https ://developers.google.com/appengine/docs/java/tools/ant#Creating_the_Build_File](https://developers.google.com/appengine/docs/java/tools/ant#Creating_the_Build_File)

要在 Eclipse 中实际运行它， 1\. 右键单击​​ build.xml 2\. 运行方式 -> Ant Build ... 3\. 选择目标“runserver”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T21:20:36.790

目前您不再需要使用 Apache Ant。使用最新的 GPE 1.7.3，您可以在 Google App Engine 项目属性中选择数据核 v2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:37:43.183

目前，您*必须*使用 Apache Ant 才能使用 JDO 3 或 JPA 2。[该文档](https://developers.google.com/appengine/docs/java/datastore/jdo/overview-dn2)写得不是很好，但它在 Migration 部分之后指出：

“目前，您必须使用 Apache Ant 才能使用 App Engine 的 DataNucleus 插件 2.x 版。”

此外，“App Engine Java SDK 包括 App Engine 的 DataNucleus 插件 2.x 版。该插件对应于 DataNucleus 访问平台的 3.0 版，使您能够通过 JDO 3.0 使用 App Engine 数据存储区。”

太糟糕了，我的朋友:(

# mysql - Mysql算术

> ID：10058608
> 
> 赞同：-1
> 
> 时间：2012-04-07T21:39:08.500
> 
> 标签：mysql

我有下面的代码，它通过一个表，每行都有一个表名和数字

例如

```
Barcelona | 3 | Milan   | 6
Inter     | 6 | Chelsea | 2
Barcelona | 8 | Madrid  | 2
Inter     | 2 | Parma   | 1 
```

使用以下代码，我希望我的结果是

```
Barcelona 11 8 3
Inter 8 3 5 
```

所以我得到了目标得分和差异但是我的查询适用于第一行但它不考虑第二行的差异

```
SELECT
    c.team1, 
    SUM(c.team1score) as GF,
    SUM(c.team2score) as GA,
    (c.team1score-c.team2score) as GD
FROM calendario AS c
GROUP BY c.team1 
```

为什么会这样？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:43:40.213

你的问题不是很清楚，但也许你只需要取两个 SUM 值之间的差异，就像这样：

```
 SELECT c.team1, sum(c.team1score) as GF, sum(c.team2score) as GA, (sum(c.team1score)-sum(c.team2score)) as GD
 FROM calendario c
 group by c.team1 
```

# xcode - 重新创建项目后，Interface Builder 连接工作但无法修改

> ID：10058610
> 
> 赞同：1
> 
> 时间：2012-04-07T21:39:34.473
> 
> 标签：xcode, interface, builder, iboutlet

我有一个旧项目（iOS 3 时代），我正在更新到 iOS 5。我在自动迁移项目时遇到了一些问题，最终创建了一个新项目并复制了所有文件。到目前为止一切正常，只有一个奇怪的问题。许多 nib 文件在界面生成器中的某些连接旁边都有一个警告感叹号；当我将鼠标悬停在它们上面时，它会显示“[view controller name] 没有名为 [outlet name] 的插座”。当我运行项目时，这些文件仍然可以正常工作，但是当我尝试创建新连接时，它不会显示与文件所有者相关的任何出口，并且当我输入父类名称以确保它正确时它不会'不自动完成类名。

当我复制它们时，我已经重命名了一些文件，所以这可能与它有关。在线搜索我看到人们通过使用 IB 中的文件 > 读取类文件解决了类似的问题，但是 IB 在新版本的 xcode 中不是独立的，并且此选项不会出现在 xcode 文件菜单上。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T00:02:05.453

我知道这是旧的，但以防万一有人遇到这个。我通过转到“Identity Inspector”并将“Class”下拉菜单更改为正确的文件来解决它。因此，在复制或重新创建项目后，不要重新关联 Identity Inspector 类。

# redirect - 将画布上的 facebook 应用程序重定向到移动用户的移动网络应用程序

> ID：10058612
> 
> 赞同：4
> 
> 时间：2012-04-07T21:39:46.940
> 
> 标签：redirect, facebook-apps, facebook-canvas, mobile-website

我如何将在 facebook（画布应用）上访问我的应用的用户重定向到相同的移动版本..

我知道可以使用这个来实现

```
<script type="text/javascript">
<!--
if (screen.width <= 699) {
document.location = "mobile.html";
}
//-->
</script> 
```

但是，如果不在发布的链接上放置重定向代码，我怎么能做到这一点......

facebook有什么方法可以自动将使用画布应用程序的移动用户重定向到其移动网络版本.....

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T20:23:44.460

不需要使用上面的代码...只需在 facebook 应用程序设置页面上填写移动 web url。facebook 会自动将移动用户（iphone、ipad 和其他智能手机用户）重定向到您的移动网站而不是画布...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T11:11:16.547

我也在尝试弄清楚如何做到这一点，但我在 Facebook 开发人员频道上找到了一个简洁的教程，它可能会为您指明正确的方向。

[http://developers.facebook.com/docs/mobile/web/build/](http://developers.facebook.com/docs/mobile/web/build/)

# ajax - 同一页面中的多个表单Jquery Ajax提交

> ID：10058613
> 
> 赞同：0
> 
> 时间：2012-04-07T21:40:00.550
> 
> 标签：ajax, zend-framework, jquery

我在**phtml**页面中迭代一个表单，当我单击按钮时如何提交或验证表单。
因为当我迭代表单时，所有表单的 id 都是相同的

我正在使用 Zend Framework，我像这样在我的视图中启动表单来为每个表单获取不同的 id

```
<?php
$commentForm = new Application_Form_Comment**($answerId)**;
 echo $commentForm?> 
```

我发送了 $answer['answer_id'] 以将其放入表单 id 中，如下所示
**`<form id="comment_form64623" method="post" action="">`**

这是最好的方法吗？或者在 Jquery 中有一种方法来处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T21:52:37.270

我会说，不，这不是好方法，像那样附加ID。配置zend的表单，将id作为隐藏参数，最后呈现为

```
<form id="comment_form" method="post" action="">
    <input type="hidden" name="answer_id" id="answer_id" value="64623" /> 
```

接下来配置jQuery将表单的位置更改为不同的位置并更新，例如

```
$("form").appendTo($("#newDiv")); //Place the for somewhere else
$("#answer_id").val(newval); //Set a new id for the form 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:48:48.997

也许您应该更改每个表单的 ID。ID 和 CSS 中的类之间的区别在于 ID 不能多次使用，类可以。如果你有这样的表格`id="form1"`，`id="form2"`那么你会很好地找到，但是让它们都存在`id="form1"`会导致一些问题。

要回答您的问题，jQuery 将非常适合解决这个问题，它会像这样工作......

假设您的所有表单都有一个相似的类 ( `class="formObject"`)，您可以使用以下命令同时在所有表单上运行代码：

```
$(".formObject").each(function() {
    //Do whatever
}); 
```

相反，如果您想处理单个表单，您应该通过 ID 调用它（记住，对于页面上的所有其他 ID 应该是唯一的）：

```
$("#form1 input[type=submit]").on("click", function() {
    //Do whatever
}); 
```

希望这可以解决您的问题，或者至少为您指明正确的方向。

# python - EasyGUI 输出？

> ID：10058621
> 
> 赞同：0
> 
> 时间：2012-04-07T21:41:18.547
> 
> 标签：python, list, textbox, easygui

对...所以，我有两个列表。一个有 16 个条目。另一个至少有几百个。使用 EasyGUI 输出它们很容易，使用 textbox() 函数或 msgbox() 函数。问题是我希望它每行显示一个列表项，而不是一个巨大的 blob。我将如何实现这一目标？

下面是代码示例：

```
def print_comb_GUI(combinations):
    eg.textbox(combinations) #eg = EasyGUI 
```

组合是一个包含大约 100-200 个条目的列表（取决于）每个条目都是一个字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:47:05.677

利用`'\n'.join`

```
>>> import easygui as ea
>>> big_list = ['this', 'is', 'no', 'so', 'big']
>>> text = '\n'.join(big_list)
>>> ea.textbox(text=text) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-27T10:44:51.610

这是我制作的一个示例代码。它将使用部分伪代码，部分python：

```
from easygui import *
list bigblobofitems = ["item1","item2","item3","item4","item5"]
list ForOutput = [empty]

x = 0
y = bigblobofitem.count()

while x != y and x < y:
    forOutput.append(bigblobofitems(x))
    forOutput.append("\n")
    x = x+1

msgbox(forOutput) 
```

# ruby-on-rails - Ruby/Rails 在 Windows 7 上运行缓慢

> ID：10058624
> 
> 赞同：1
> 
> 时间：2012-04-07T21:41:40.697
> 
> 标签：ruby-on-rails, ruby, windows-7, rspec, bundler

我知道这是一个常见的问题主题，但我找不到任何似乎可以回答我的问题的问题，这似乎与该主题的大多数问题有所不同。

我是 Ruby 和 Ruby on Rails 的新手，所以请记住这个问题。每当我通过我的 IDE (Aptana) 或在 Windows 命令屏幕中运行 bundle、rails 等命令时，它们实际上需要一分钟才能执行。捆绑安装可能需要 20 秒才能开始将任何内容打印到屏幕上，r​​spec 命令可能需要 40 秒才能开始，然后需要 6 秒才能运行测试（对于这种情况来说是适当的时间）。Rails 服务器可能需要 40 秒才能启动。

并非总是这样，而是在更新 gems、安装更新的东西、获取 Aptana IDE 的过程中，它受到了粉丝的欢迎。

任何想法如何将扳手从引擎中取出？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:47:48.657

我不是 Win7 专家，但我建议检查您的系统内存和 cpu 使用情况。看看有没有瓶颈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T04:28:40.380

此外，至少，请确保您运行的是最新版本的 Bundler。直到最近它的版本是 1.0.x。它最近升级到 1.1，现在是 1.1.3，主要变化是在 gem 之间遍历依赖关系树需要多长时间。

此外，在某些情况下，我也将 Windows 7 用于 Ruby。我还发现安装“瘦”作为 Rails Web 服务器（ C:\ gem install thin ）将比默认的 WEBrick 服务器执行得快得多。

如果你做到这两点，我想你会注意到性能的提升。

就您的测试而言，如果您使用的是 RSpec ..那只是野兽的本性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-17T03:55:28.920

我正在使用 Ruby 1.9.3p392、Rails 3.2.13。该项目连接到一个 mysql 数据库。

*   在 Window 7 上尝试过 - 服务器需要 10 秒才能启动，呈现登录页面需要 1 分钟以上。
*   在 virtualbox 上的 ubuntu 12.10 虚拟机上尝试过 - 是最差的两倍
*   在 VMWare 播放器上的 ubuntu 12.10 虚拟机上尝试过——好多了，几乎与 Windows 7 相当。

所以我硬着头皮设置了一个双引导 linux-mint 系统，问题就消失了。所以问题出在一些甚至虚拟机都依赖的低级系统api上。

使用 Windows 还存在其他问题，例如许多 gem 不是为 Windows 编译的（如 therubyracer 和 imagemagic），因此您需要跳过循环以使它们工作。

因此，总而言之，忘记用于 RoR 开发的 Windows。但说真的，如果 RoR 对 Windows 更友好，我敢肯定它会更受欢迎。在这个过程中我几乎放弃了，而且我不得不时不时地在 Windows 和 Linux 之间切换，这对我来说仍然是一个真正的痛苦。

# jquery - 为基于 jquery 的滑块添加触摸滑动支持

> ID：10058635
> 
> 赞同：1
> 
> 时间：2012-04-07T21:43:44.607
> 
> 标签：jquery, touch, swipe

使用这个很棒的拇指滑块 [http://manos.malihu.gr/jquery-thumbnail-scroller](http://manos.malihu.gr/jquery-thumbnail-scroller)

但是，它不为基于触摸的设备提供滑动支持。有没有一种简单的方法可以向这样的 jquery 插件添加触摸滑动支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:54:24.720

您可以尝试[`jQuery Mobile`](http://jquerymobile.com/)触摸事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T21:58:49.910

无需切换到 jQuery Mobile 即可。我在[这个学校的小项目](http://glab.belmont.edu/~patrickcason/Home%20Remote/)中这样做了。

它的完成方式是使用这个名为[jQuery UI Touch Punch](https://github.com/furf/jquery-ui-touch-punch)的库，它将模拟来自触摸设备的鼠标事件。您需要做的就是在您的 jQuery 下包含该库，包括：`<script src="jquery.ui.touch-punch.min.js"></script>`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-01T05:20:56.560

您可以使用 jQuery UI Touch Punch 添加触摸滑动。

使用 Touch Punch 就像 1、2 一样简单……只需按照以下简单步骤操作：

1.  在您的页面上包含 jQuery 和 jQuery UI。

    ```
    <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script src="http://code.jquery.com/ui/1.8.21/jquery-ui.min.js"></script> 
    ```

2.  在 jQuery UI 之后和首次使用之前包括 Touch Punch。

请注意，如果您使用 jQuery UI 的组件，则必须在 jquery.ui.mouse.js 之后包含 Touch Punch，因为 Touch Punch 会修改其行为。

```
 <script src="jquery.ui.touch-punch.min.js"></script> 
```

如需演示，请访问*[http://touchpunch.furf.com/](http://touchpunch.furf.com/)*

# c - 将指针分配给指针后，为什么左值变为零

> ID：10058636
> 
> 赞同：0
> 
> 时间：2012-04-07T21:44:05.903
> 
> 标签：c

我正在编写一个函数来显示调用者传递的指针值。因为我不想弄乱原来的**arr1，所以我给它分配了一个**P，然后我打印它并计算它。但随后左侧，即 arr1 变为零。

代码：

```
 void merge(int **arr1, int **arr2, int **arr3)
    {
    int **p1= arr1;
    int **p2= arr2;
    int **p3= arr3;

    int count;

    printf("%d\n", **arr1);  //this shows the correct value of first element of arr1

    while(**p1)
    {
    printf("%d\n", **p1);
    (*p1)++;
    count++;
    }

    while(**p2)
    {
    printf("%d\n", **p2);
    (*p2)++;
    count++;
    }

    printf("%d\n", **arr1);  // this become zero, why??i didn't touch it in my code didn't i?
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:46:18.777

因为`arr1`和`p1`指向同一个东西。因此，如果您修改`*p1`，那么您也会修改`*arr1`，因为它们是同一个对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T21:54:25.263

正如您所说，`**p1`并且与所指向的值`**arr1`相同。`int`

现在你有了循环`while(**p1)`，所以为了退出循环并进入`printf`语句，`**p1`必须等于 0。

在这个循环内部，`p1`永远不会被修改，`*p1`is，与 相同`*arr1`，因此一旦循环退出，`p1`仍然`arr1`指向相同的位置，并且`**p1`将等于 0。因此`**arr1`必须等于与 相同的值`**p1`，即 0。

# php - MySQL：按行 ID 在永久链接中显示内容

> ID：10058638
> 
> 赞同：3
> 
> 时间：2012-04-07T21:44:23.287
> 
> 标签：php, mysql, permalinks

我正在尝试制作自己的 CMS，我在 php 和 mysql 方面还很陌生。让我进入正题：

到目前为止，我已经在索引页面中创建了带有“阅读更多”永久链接的新闻（这意味着，当我按下阅读更多时，它会将我移动到其他页面，例如`/readmore.php?id=[news ID]`，在该页面中，唯一的内容是那些特定的新闻，即表格中的特定行。我坚持的是在该永久链接中获取特定的行 ID。

让我展示一下目前对我有用的代码。

带有新闻的索引文件：

```
while($row = mysql_fetch_array($result))  
   {
/*... title, news content... */
   echo "<a href='readmore.php?id=".$row['ID']."'>".$read_more_link."</a></div>";
} 
```

具有精确行的 readmore.php（例如 readmore.php?id=1201）：

```
$params = $_SERVER['QUERY_STRING'];
$str = $params;
$id1 = $str[strlen($str)-1];
$id2 = $str[strlen($str)-2];
$id3 = $str[strlen($str)-3];
$id4 = $str[strlen($str)-4];
$news_id = "$id4$id3$id2$id1";

$query = "SELECT * FROM naujiena WHERE ID='$news_id'"; 
```

基本上它的作用是从地址栏中恢复最后 4 位数字并使用该 4 位 ID 搜索那些新闻

这是一种非常原始的方法，但我坚持了几天，找不到出路。

我之前尝试过的是在`while($row = mysql_fetch_array($result))`循环中创建一个带有会话的变量，它应该在索引页面中显示 ID，但在 readmore 页面中只有最后一个或第一个（取决于 desc 或 asc）很明显可以期待

你能帮助我吗？我会很感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T21:48:41.193

要在 php 中提取查询字符串的参数，请使用`$_GET`超全局，如下所示：

```
$_GET["id"] 
```

另请注意，远程（用户、浏览器等）提供的任何数据都可能是伪造的。因此，攻击者也可能会发送您`?id=0; DROP TABLE users`或类似的东西。

阅读有关[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)的更多信息。

验证输入总是一个好主意。你期望*id*是一个整数，所以为了安全起见，你可以检查`if(ctype_digit($_GET["id"]))) ...`

最后，清理您在 SQL 语句中使用的任何输入也是一个好主意。使用[`mysql_real_escape_string()`](http://php.net/mysql_real_escape_string)，或考虑使用[`PDO`](http://il.php.net/PDO)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T21:50:12.780

`$_GET`您可以通过数组中的名称访问查询字符串中的值。

例如，`$_GET['id']`将是`id=<ID>`查询字符串部分的值。它适用于查询字符串的每个字段。

```
// url : readmore.php?id=1201
$news_id = intval($_GET['id']);
// now, $news_id contains the value 1201
$query = "SELECT * FROM naujiena WHERE ID='$news_id'"; 
```

您可以阅读官方帮助：[`$_GET`](http://php.net/manual/en/reserved.variables.get.php)或者您可以在网上找到的各种教程之一：http: [//www.w3schools.com/php/php_get.asp](http://www.w3schools.com/php/php_get.asp)

**更新**

既然你接受了我的回答，我觉得也有义务谈谈 SQL 注入。您应该始终清理您在 SQL 查询中使用的任何输入[`mysql_real_escape_string`](http://php.net/mysql_real_escape_string)。您可以在 Wikipedia：[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)或 PHP 文档：[SQL 注入](http://ch2.php.net/manual/en/security.database.sql-injection.php)中找到更多详细信息。

由于您的 ID 是数值，因此您也可以确保这一点。我更新了代码片段以使用[`intval`](http://php.net/manual/en/function.intval.php).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T21:49:57.853

要获取特定的 HTTP-GET 变量，您可以使用[`$_GET["variableName"]`](http://php.net/manual/en/reserved.variables.get.php). 在您的情况下，您可以获得这样的 ID：

`$news_id = $_GET["id"];`

# opengl - Opengl几何着色器整数纹理提取失败

> ID：10058641
> 
> 赞同：5
> 
> 时间：2012-04-07T21:45:02.473
> 
> 标签：opengl, integer, texture-mapping, opengl-3, geometry-shader

我正在尝试从在 GeForce 330m 上运行的几何着色器中采样整数纹理。它似乎返回了我加载到纹理中的其他值。我使用这段代码（基本上）来创建和加载纹理：

```
glGenTextures( 1, &textureId );
glBindTexture( GL_TEXTURE_2D, textureId );
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT );
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT );
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA32I, w, h, 0, GL_RGBA, GL_UNSIGNED_BYTE, 0);
glBindTexture( GL_TEXTURE_2D, 0);
glBindTexture( GL_TEXTURE_2D, textureId );
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA32I, w, h, 0, GL_RGBA, GL_INT, <some 0-initialized large enough buffer>);
glBindTexture( GL_TEXTURE_2D, 0);
glBindTexture( GL_TEXTURE_2D, textureId );
    int data[] = { 3, 0, 36, 400 };
glTexSubImage2D(GL_TEXTURE_2D, 0, 0, 3, 1, 1, GL_RGBA, GL_INT, data);
glBindTexture( GL_TEXTURE_2D, 0); 
```

这个想法是，一个特定的像素被设置为具有 400 的 w 值。然后我在我的几何着色器中使用它：

```
#version 330
#extension GL_EXT_gpu_shader4 : require
uniform isampler2D models;

void main()
{
   ivec4 modelstats4 = texelFetch2D(models, ivec2(0, 3), 0);
//   ivec4 modelstats4 = ivec4(3, 0, 36, 400);
   if (modelstats4.w > height) {
      // emit something
   }
} 
```

使用应该相等的已注释掉的固定值会导致发出某些东西（IE，一分）。如果我使用实际的 texel 提取，它不会返回任何内容。我知道的所有可能产生影响的值现在都被硬编码了，所以我不知道为什么这不起作用。这不是完整的代码（OO 设置，需要查看很多内容），但这些是具有适用数据的相关 OpenGL 调用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T10:48:44.997

通过大量使用 glGetErrors 找到了解决方案。错误出现在此代码示例中的每个 glTexImage 中 - 显然，对于整数纹理，您不能使用 GL_RGBA 而是使用 GL_RGBA_INTEGER。

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA32I, w, h, 0, GL_RGBA_INTEGER, GL_INT, data); 
```

这现在有效。纹理提取也可以。

# ruby-on-rails - 我可以使用类变量与线程通信吗？

> ID：10058643
> 
> 赞同：1
> 
> 时间：2012-04-07T21:45:47.390
> 
> 标签：ruby-on-rails, ruby, nginx, thread-safety, passenger

在 Rails 中使用类变量与线程通信是 0K 吗？

与使用队列相比有什么优点或缺点吗？

我不确定这是否适用于任何环境，它适用于我的：Ruby Enterprise + Passenger + nginx + Rails 3

这是一个例子：

```
# rails runner "ThreadJob.new.run"
class ThreadJob

  @@counter = 0

  def run
    producer = Thread.new do
      1.upto 10 do
        sleep 1
        @@counter+= 1
        puts "Producer: #{@@counter}"
      end
    end

    consumer = Thread.new do
      sleep 0.5
      1.upto 10 do
        sleep 1
        @@counter-= 1
        puts "Consumer: #{@@counter}"
      end
    end

    producer.join
    consumer.join

    puts @@counter # result should be 0
  end
end 
```

我想知道如果我从另一个进程中修改 @@counter 是否可以工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T22:51:37.233

不，不能像您的示例一样从多个线程更新类变量。

看看为什么，以及如何使用 Mutex 类来解决这个问题的解释：

[http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_threads.html](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_threads.html)

# java - 对作为参数传输的对象的引用

> ID：10058644
> 
> 赞同：0
> 
> 时间：2012-04-07T21:45:57.623
> 
> 标签：java, object, reference

> 第三个代码示例包含错误 - 如何解决？

在下面的代码中，我生成了一个名为“生成器”的方法。此方法接收一个 JTextField 和一个 JLabel 作为参数。

它生成单独的 JPanel 并将它们添加到另一个 JPanel（带有边框“Vermieter”的 JPanel）。结果应如下所示（标记为红色）：

[http://imageshack.us/photo/my-images/853/stammdateneraffsenguibe.png/](http://imageshack.us/photo/my-images/853/stammdateneraffsenguibe.png/)

在这里，我将 JTextFields 实例化为字段：

```
private JTextField txtplzvermieter;
private JTextField txtemailvermieter;
private JTextField txtgeburtsdatumvermieter;
private JTextField txthandyvermieter;
private JTextField txtidvermieter;
private JTextField txtnamevermieter;
private JTextField txtortvermieter;
private JTextField txtstrassevermieter;
private JTextField txttelefonvermieter;
private JTextField txtvornamevermieter; 
```

在这里，我正在调用我上面描述的方法

```
 public  void vermieterPanel(JPanel verPanel){
         verPanel.add(generator( "ID", txtidvermieter ));
       verPanel.add(generator("Name", txtnamevermieter ));
       verPanel.add(generator( "Vorname", txtvornamevermieter ));
       verPanel.add(generator( "Straße", txtstrassevermieter ));
       verPanel.add(generator("PLZ", txtplzvermieter ));
       verPanel.add(generator( "Ort", txtortvermieter ));
       verPanel.add(generator( "Geburtsdatum", txtgeburtsdatumvermieter ));
       verPanel.add(generator( "Telefon", txttelefonvermieter ));
       verPanel.add(generator("Handy", txthandyvermieter ));
       verPanel.add(generator( "E-Mail", txtemailvermieter )); 
```

这是包含错误的方法生成器：

```
 public JPanel generator(String lableText, JTextField s){   // generiert ein Panel mit einer Zeile aus lable + TextFeld

     JPanel gens = new JPanel();
     JLabel lable = new JLabel(lableText);
     lable.setPreferredSize(new Dimension(100,25));

     s = new JTextField();
     s.setPreferredSize(new Dimension(200, 25));

    gens.add(lable);
    gens.add(s);
    return gens;
  } 
```

后来我无法在我的 TeftFields 上获得引用，`.getText();`因为我在这里创建了对新 JTextField-Object 的引用`s = new JTextField();`

如果我删除该行以访问我的对象，我会得到一个空指针异常。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:51:27.933

原始值永远不会被创造出来。你需要这样做

```
private JTextField txtplzvermieter = new JTextField(); 
```

对于他们每个人。但它必须在方法之外，而不是在内部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T21:55:51.690

在*java*中你不能将对象作为引用传递，它永远不会发生
这是创建*java*语言的目的，最小的内存管理
如果你将对象作为参数传递，对象引用的副本将被传递
，所以每次更改`field`除了使用关键字为它分配一个新对象时，对象' s 将被反映`new`，在这里您将松开对象的抓取尝试将您的*JField* s 设为 global `class` `field`s，并且不要通过参数部分将它们传递给方法.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T22:02:31.640

当然你会得到一个异常，因为你在初始化之前传递了 JTextield ！
您只是在声明它，
在将其作为参数传递之前使用 new 关键字对其进行初始化。

# visual-studio - 如何在 Visual Studio 中设置纯前端 Web 项目？

> ID：10058652
> 
> 赞同：6
> 
> 时间：2012-04-07T21:46:50.913
> 
> 标签：visual-studio, visual-studio-2010

我做的很多项目都是纯前端 Web 应用程序：也就是说，纯 JS/HTML/CSS，没有 ASP.NET 或任何类型的后端服务器行为。

我喜欢使用 Visual Studio 编写和调试这些项目，但我不知道如何制作一个完全前端的项目。

到目前为止，我刚刚创建了一个空的 ASP.NET 解决方案，并且忽略了所有我不需要的部分，但我真的不喜欢这样做。

我也刚刚打开了我需要在 Visual Studio 中编辑的文件，但由于某种原因，当我这样做时，Visual Studio 调试器被禁用。

有没有在 Visual Studio 中创建纯前端 Web 项目的好方法？

# performance - if/else 条件和模板匹配条件的区别

> ID：10058655
> 
> 赞同：2
> 
> 时间：2012-04-07T21:47:10.860
> 
> 标签：performance, xslt, reliability

回到基础，我想详细了解以下代码对后者的重要性..反之亦然..

代码示例1：

```
<xsl:template match="Gender">
   <xsl:copy>
       <xsl:if test=".='M'">
           <xsl:text>Male</xsl:text>
       </xsl:if>
       <xsl:if test=".='F'">
           </xsl:text>Female</xsl:text>
       </xsl:if>
   </xsl:copy>
</xsl:template> 
```

代码示例2：

```
<xsl:template match="Gender[.='M']">
   <xsl:copy>
       <xsl:text>Male</xsl:text>       
   </xsl:copy>
</xsl:template>
<xsl:template match="Gender[.='F']">
   <xsl:copy>
       <xsl:text>Female</xsl:text>       
   </xsl:copy>
</xsl:template> 
```

我可以`<xsl:choose/>`在 code1 中使用，这不是重点.. 我想讨论一下使用具有匹配条件的不同模板而不是使用 if 和 else 条件.. 考虑性能、可读性和维护以及更多因素是多么明智？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T00:10:17.080

**我肯定更喜欢 Code2**：

1.  **更简单**——显式条件指令消失了。

2.  **更短**——由于上述原因。

3.  **更容易理解**——因为上面的 1\. 和 2.。

4.  **更易于维护**：如果在处理“F”时需要更改某些内容，则没有机会搞砸“M”的处理。

5.  **更容易扩展**。如果将 Code2 的样式表导入另一个，则可以只覆盖两个模板中的一个——使用 Code1，整个整体模板将需要被覆盖，并且某些代码可能会被复制而无需任何更改。

**记住 KISS 原则**：保持简单，愚蠢...... :)

# windows-phone-7 - 如何使用 Windows Phone 7 中的应用更改铃声状态？

> ID：10058658
> 
> 赞同：1
> 
> 时间：2012-04-07T21:47:48.537
> 
> 标签：windows-phone-7

我读到的所有内容都表明这不是解锁手机之外的当前可用 API 的选项。但后来我在市场上看到了这个应用程序[http://www.windowsphone.com/en-US/apps/6813ea1f-8d71-4ad5-a6d2-f80c193c6ac9](http://www.windowsphone.com/en-US/apps/6813ea1f-8d71-4ad5-a6d2-f80c193c6ac9)

不知何故，这个家伙/gal 想出了如何将手机更改为基于 wifi 的振动，所以有人知道如何去做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T07:35:19.440

根据我的简短调查，它似乎是一个虚假的应用程序，实际上并没有做任何事情。没有允许您直接切换电话铃声样式的开放 API。

# android - 向地图添加自定义标记 - Android

> ID：10058666
> 
> 赞同：1
> 
> 时间：2012-04-07T21:49:07.933
> 
> 标签：android, google-maps, touch, overlay

我目前有一个应用程序，它使用 MapView 向用户显示谷歌地图。

我一直在尝试使用此代码在地图上放置一个标记，

```
public boolean onTouchEvent(MotionEvent event, MapView mapView) {
        if (event.getAction() == 1) {
            GeoPoint p = mapView.getProjection().fromPixels((int) event.getX(),
                    (int) event.getY());
            DemoOverlay demoOverlay = new DemoOverlay(); 
            mapView.getOverlays().add(demoOverlay);

            mapView.invalidate();
        }
        return false;
    } 
```

我有一个演示叠加设置，它在地图上放置了一个标记，但是当我触摸屏幕时，标记永远不会出现。

任何帮助，将不胜感激 ！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T03:21:07.987

```
GeoPoint p = mapView.getProjection().fromPixels((int) event.getX(),(int) event.getY());
Drawable srcdrawable = getApplicationContext().getResources().getDrawable(R.drawable.pin_blue);
CustomItemizedOverlay srcitemizedOverlay = new CustomItemizedOverlay(srcdrawable, getApplicationContext());
OverlayItem srcoverlayitem = new OverlayItem(p, "Hello!", "This is your Location.");
srcitemizedOverlay.addOverlay(srcoverlayitem);
mapView.getOverlays().clear();
mapView.getOverlays().add(srcitemizedOverlay);
mapController.animateTo(srcpoint);
mapController.setZoom(16); 
```

在 ontouch 方法中使用上面的代码也使用下面的 CustomItemizedOverlay.java 类

```
public class CustomItemizedOverlay extends ItemizedOverlay<OverlayItem> {

    private final ArrayList<OverlayItem> mapOverlays = new ArrayList<OverlayItem>();

    private Context context;

    public CustomItemizedOverlay(Drawable defaultMarker) {
        super(boundCenterBottom(defaultMarker));
    }

    public CustomItemizedOverlay(Drawable defaultMarker, Context context) {
        this(defaultMarker);
        this.context = context;
    }

    @Override
    protected OverlayItem createItem(int i) {
        return mapOverlays.get(i);
    }

    @Override
    public int size() {
        return mapOverlays.size();
    }

    public void addOverlay(OverlayItem overlay) {
        mapOverlays.add(overlay);
        this.populate();
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-08T05:51:17.383

[android-mapviewballoons](https://github.com/jgilfelt/android-mapviewballoons)确实是 Android 上最好的地图库之一。你为什么不试一试？:)

![Adroid Mapview 气球](../Images/847d78e04511778151cd8508cd67d212.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-08T08:57:51.000

[**这**](http://android-example-code.blogspot.in/p/map-api-in-android.html)是在地图中放置多个标记的完整示例

还如何在两个引脚之间绘制路径...

这可能对你有帮助......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-10T09:09:27.400

像这样修改你的代码---

```
public boolean onTouchEvent(MotionEvent event, MapView mapView) 
   {   

    if (event.getAction() == 1) { 

          p = mapView.getProjection().fromPixels(
                (int) event.getX(),
                (int) event.getY());
          Toast.makeText(getBaseContext(),p.getLatitudeE6() / 1E6 + "," +p.getLongitudeE6() /1E6 ,Toast.LENGTH_SHORT).show();

              List<Overlay> mapOverlays = mapView.getOverlays();
              Drawable drawable = this.getResources().getDrawable(R.drawable.map_point);
              AddItemizedOverlay itemizedOverlay =
              new AddItemizedOverlay(drawable, this);

              OverlayItem overlayitem = new OverlayItem(p, "", "");
              itemizedOverlay.addOverlay(overlayitem);
              mapOverlays.add(itemizedOverlay);

          return true;
    }
     return false;
} 
```

做一个覆盖类——

AddItemizedOverlay.class--

```
 public class AddItemizedOverlay extends ItemizedOverlay<OverlayItem> {

       private ArrayList<OverlayItem> mapOverlays = new ArrayList<OverlayItem>();

       private Context context;

       public AddItemizedOverlay(Drawable defaultMarker) {
            super(boundCenterBottom(defaultMarker));
       }

       public AddItemizedOverlay(Drawable defaultMarker, Context context) {
            this(defaultMarker);
            this.context = context;
       }

       @Override
       protected OverlayItem createItem(int i) {
          return mapOverlays.get(i);
       }

       @Override
       public int size() {
          return mapOverlays.size();
       }

       @Override
       protected boolean onTap(int index) {
          Log.e("Tap", "Tap Performed");
          return true;
       }

       public void addOverlay(OverlayItem overlay) {
          mapOverlays.add(overlay);
           this.populate();
       }

    } 
```

当你触摸屏幕时它会显示点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-08T11:56:51.547

感谢您的建议，但我决定遵循这些教程，因为它们完全涵盖了我需要的内容， [http ://thenewboston.org/watch.php?cat=6&number=133](http://thenewboston.org/watch.php?cat=6&number=133)

这个视频特别是涵盖我的问题的视频，

[http://thenewboston.org/watch.php?cat=6&number=141](http://thenewboston.org/watch.php?cat=6&number=141)

# spring - Tomcat 7：为 org.springframework 库设置日志记录级别

> ID：10058668
> 
> 赞同：1
> 
> 时间：2012-04-07T21:49:48.473
> 
> 标签：spring, debugging, tomcat, logging, java.util.logging

在 Tomcat 7 上，我试图从我正在使用的 Spring 库中获取日志记录输出。

在Tomcat的`logging.properties`我有：

```
.handlers = 1catalina.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler

java.util.logging.ConsoleHandler.level = ALL
1catalina.org.apache.juli.FileHandler.level = ALL

#this does not change the logging level...
org.springframework.level = ALL

# this does change the logging level...
javax.faces.level = ALL
com.sun.faces.level = ALL 
```

如您所见，我现在确实从 JSF 获得了日志消息，但没有从 Spring 获得日志消息。

为什么会这样，我在这里错过了什么？

**更新：**

我注意到，当我从类路径中删除 log4j.jar 时，我确实从 Spring 获得了日志记录。但是当我将 log4j.jar 添加到类路径时，来自 Spring 的日志记录消失了。**你能解释一下为什么吗？**

顺便说一句，我的类路径中确实需要 log4j，因为我正在使用的其他 jar 之一在其代码中明确引用了 log4j。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T18:45:29.070

我会使用与 Tomcat 日志记录分开的 slf4j 日志记录。使用应用程序日志记录而不是容器日志记录。

参考：

[http://blog.springsource.org/2009/12/04/logging-dependencies-in-spring/](http://blog.springsource.org/2009/12/04/logging-dependencies-in-spring/) [如何配置 Spring 和 SLF4J 以便获得日志记录？](https://stackoverflow.com/questions/3387441/how-do-i-configure-spring-and-slf4j-so-that-i-can-get-logging)

示例应用程序： [https ://src.springframework.org/svn/spring-samples/mvc-basic/trunk/](https://src.springframework.org/svn/spring-samples/mvc-basic/trunk/)

# c - Getopt 转移 optarg

> ID：10058669
> 
> 赞同：5
> 
> 时间：2012-04-07T21:49:57.030
> 
> 标签：c, getopt

我需要这样调用我的程序：

```
./program hello -r foo bar 
```

我从 argv[1] 中打招呼，但我在使用值栏时遇到问题，我是否应该将“r:”更改为其他内容？

```
while((c = getopt(argc, argv, "r:")) != -1){
   switch(i){
   ...
   case 'r':
     var_foo = optarg;
     //shell like argument shift here?
     var_bar = optarg;
     break;
...} 
```

我知道我可以通过 argv 来做到这一点，但是有没有办法用 getopt 与 bash 类似的方式来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-07T21:54:47.273

`bar`在 . 的眼中不是一个选项参数`getopt`。相反，GNU`getopt` *重新排列*了位置参数，以便在处理结束时，您有`argv[3]`“hello”和`argv[4]`“bar”。基本上，当您完成 getopting 后，您仍然需要`[optind, argc)`处理位置参数：

```
int main(int argc, char * argv[])
{
     {
         int c;
         while ((c = getopt(argc, argv, ...)) != -1) { /* ... */ }
     }

     for (int i = optind; i != argc; ++i)
     {
         // have positional argument argv[i]
     }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-07T22:15:06.847

这取决于您是否使用[GNU`getopt()`](http://www.gnu.org/software/libc/manual/html_node/Getopt.html)，如果是，是否`POSIXLY_CORRECT`在环境中设置。

经典（意味着非 GNU [`getopt()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/getopt.html)），所有选项参数必须在任何非选项（文件名）参数之前。这意味着您有四个非选项参数。

如果您有 GNU`getopt()`并且没有`POSIXLY_CORRECT`设置，那么它将在命令行的任何位置处理选项参数。在这种情况下，您将有一个选项，`-r`带有参数 value`foo`和两个非选项参数（`hello`和`bar`）。

要让 Classic`getopt()`识别`-r`，您必须要求第一个（非选项）参数，然后才调用`getopt()`：

```
int main(int argc, char **argv)
{
    char *cmd = argv[1];
    int   opt;

    argv[1] = argv[0];
    argv++;
    argc--;

    while ((opt = getopt(argv, argc, "r:")) != EOF)
    {
        switch (opt)
        {
        case 'r':
            ...capture optarg...
            break;
        default:
            ...report error....
            break;
        }
    }

    for (int i = optind; i < argc; i++)
        process_non_option_argument(cmd, argv[i]);

    return(0);
} 
```

如果您启用它， GNU`getopt`也可以返回非选项参数。除此之外，该`bar`参数将始终被视为非选项参数。

# java - 为什么从命令行运行时不调用 Application.aboutHandler()？

> ID：10058672
> 
> 赞同：1
> 
> 时间：2012-04-07T21:50:09.197
> 
> 标签：java, macos, netbeans, about-box, jarbundler

在我的 Java 应用程序中，当初始化主框架以覆盖 MacOS 上的默认“关于”对话框行为时，我使用以下代码（有关 Apple 扩展，请参见[此处](https://developer.apple.com/library/mac/documentation/Java/Reference/1.5.0/appledoc/api/com/apple/eawt/Application.html)）。

```
Application a = Application.getApplication();
    a.setAboutHandler(new AboutHandler() {

        @Override
        public void handleAbout(AppEvent.AboutEvent arg0)
        {
            AboutDialog ad = new AboutDialog(EditorFrame.this, true);
            ad.setLocationRelativeTo(null);
            ad.setVisible(true);
        }

       }); 
```

从命令行运行应用程序时：

```
java -Xdock:name="MyApp" -Dapple.laf.useScreenMenuBar=true -jar myapp.jar 
```

从菜单中选择 MyApp->About 会给出默认的关于屏幕。或者，当从 NetBeans 内部运行时，会显示自定义 AboutDialog。我需要将特定的命令行参数传递给 Java 运行时以启用 Apple Java 扩展吗？

# ruby-on-rails - 是否可以仅将嵌套表单的某些部分保存到数据库中

> ID：10058673
> 
> 赞同：0
> 
> 时间：2012-04-07T21:50:09.963
> 
> 标签：ruby-on-rails

我有一个嵌套表单，它采用“品牌”“模型”“子模型”和“样式”......现在，任何给定的品牌+模型+子模型组合都有多种样式..但我不想重新保存我的数据库中有两次相同的品牌名称（或型号或子型号）..

因此，鉴于上述情况，我需要在我的控制器中的 CREATE 操作中执行什么操作以确保数据库中的品牌名称是唯一的……等等……但是仍然可以提交嵌套表单？

此外，如果子模型表中已经列出了一个（具有相同子模型名称）的子模型 ID，则保存的“样式”需要采用现有子模型对象的子模型 ID。

更新：

![在此处输入图像描述](../Images/91c7d3119e4d70dbc81fb791e6771b4d.png)

我想允许我的嵌套表单保存 xy 和 z，并具有以下内容：

Panasonic（未保存，但读取 ID 并与 model x 作为brand_id 保存） X（与 Panasonic 的brand_id 保存） Y（与 model X 的 model_id 保存） Z（与 Y 的 submodel_id 保存）

当然，如果 Model X 已经存在，那么我想要

Panasonic（未保存） X（未保存） Y（以 X 的 ID 作为 model_id 保存） Z（以 Y 的新 ID 作为 submodel_id 保存）

你明白我要去哪里了吗？=)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:02:56.383

如果我正确理解了您的问题，那么您的产品模型具有品牌、模型（应该命名为其他名称）、子模型、样式等属性。我会通过创建以下模型来做到这一点：

```
class Brand < ActiveRecord::Base
  has_many :products
end

class Primodel < ActiveRecord::Base
  has_many :products
  has_many :submodels
end

class Submodel < ActiveRecord::Base
  has_many :products
end

class Style < ActiveRecord::Base
  has_many :products
end

class ProductsStyles < ActiveRecord::Base
  belongs_to :product
  belongs_to :style
end

class Product < ActiveRecord::Base
  belongs_to :primodel
  belongs_to :submodel
  belongs_to :brand
  has_many :products_styles
  has_many :styles, :through => :products_styles
end 
```

这应该允许您创建和重复使用品牌、模型、子模型和样式。它会将每个产品限制为仅具有前三个中的一个，但允许您拥有多种样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T09:35:46.567

这是我需要做的：

```
@brand1 = params[:brand][:name]
@model = params[:brand][:models_attributes]["0"]["name"]
@submodel = params[:brand][:models_attributes]["0"]["submodels_attributes"]["0"]["name"]
@style = params[:brand][:models_attributes]["0"]["submodels_attributes"]["0"]["styles_attributes"]["0"]["name"]

a = Brand.find_or_create_by_name(@brand1)
b = Model.find_or_create_by_name(@model, :brand_id => a.id)
c = Submodel.find_or_create_by_name(@submodel, :model_id => b.id)
d = Style.new(:name => @style, :submodel_id => c.id)
d.save 
```

# jquery - 将数据表用于宽（足够宽以超出屏幕）表

> ID：10058686
> 
> 赞同：0
> 
> 时间：2012-04-07T21:51:41.310
> 
> 标签：jquery, datatables

我正在使用 DataTable 脚本将一个普通的 HTML 表格（超过 20 列）转换为一个很好的交互式表格。我还使用 ColVis 插件让用户能够仅将他们感兴趣的列设为可见并隐藏其余列。我稍后会将此选择保存在会话 Cookie 中，以便记住用户偏好。

我目前面临的默认配置问题是，由于表格很宽，当用户取消选择（即隐藏）列时，表格宽度开始减小（如预期的那样），但这并没有相应地移动 ColVis 弹出，它仍然存在页面评估者的页面比旁边的病房以及“显示/隐藏”按钮。选择列时也是如此（即显示它们）

我已经敲了一天的头来寻找解决方案。非常感谢任何帮助甚至指向我应该关注的领域的指示。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:56:45.827

我想您需要在用户隐藏列时减小表格宽度。

PS：插件功能很容易使用jQuery实现，如果你这样做，你将更好地控制正在显示的HTML表格

# android - 在 android 2.1 中自动接听电话

> ID：10058687
> 
> 赞同：0
> 
> 时间：2012-04-07T21:51:54.670
> 
> 标签：android, call, android-2.1-eclair

我正在寻找一些代码来自动接听 android 2.1 中的来电。我查看了 stack-overflow 上的一些可用线程，但它们似乎不适用于 Android 2.1。

任何人都可以提供一些和平的代码来帮助我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T03:17:47.753

// 设置与电话服务的通信（感谢 Tedd 的 Droid 工具！）

```
TelephonyManager tm = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);
Class c = Class.forName(tm.getClass().getName());
Method m = c.getDeclaredMethod("getITelephony");
m.setAccessible(true);
ITelephony telephonyService;
telephonyService = (ITelephony)m.invoke(tm);
// Silence the ringer and answer the call!
telephonyService.silenceRinger();
telephonyService.answerRingingCall(); 
```

参考这个[LINK1](http://code.google.com/p/auto-answer/source/browse/trunk/src/com/everysoft/autoanswer/AutoAnswerIntentService.java) [LINK2](http://androidbridge.blogspot.in/2011/05/how-to-answer-incoming-call-in-android.html)

# java - 签名者信息与同一包中其他类的签名者信息不匹配

> ID：10058692
> 
> 赞同：4
> 
> 时间：2012-04-07T21:53:13.657
> 
> 标签：java, gwt, maven

类“org.mortbay.util.DateCache”的签名者信息与同一包中其他类的签名者信息不匹配

我正在研究 GWT 和 Maven。我的 GWT 代码在 project2 中。当我单独运行它时它工作正常，但是当我尝试创建对另一个项目的依赖时，我得到了这个错误。我也在谷歌上搜索了解决方案。我得到的是属于同一个包的类是从不同的 JAR 文件加载的。但我不知道如何确保他们拥有相同的证书。有什么办法可以摆脱这个。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:14:14.723

使您的对象静态和单例，并在启动时加载它们，这样每当一个新的 jar 尝试启动它时，它总是会返回相同的对象。我知道应该在这里完成一些工作，但你需要它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-19T10:25:22.787

我遇到了类似的问题，我按照以下说明解决了它：

“确保 hamcrest.jar 在类路径中 Eclipse 包含的 JUnit 库之前。”

# git - 使用 Git 管理网站的两个版本

> ID：10058693
> 
> 赞同：2
> 
> 时间：2012-04-07T21:53:58.150
> 
> 标签：git

我确信这属于“*将 Git 用于非预期*目的”类别，但我想分享我正在做的事情，以便专家们对此发表评论。

我在我的实时服务器上使用虚拟主机，这样我就可以同时运行我的网站的 2 个版本。一个是 example.com，另一个是 staging.example.com。staging 站点用于测试新功能，我创建了一种将站点 git repo 的两个分支（例如*staging*和*master*）链接到它们各自站点根目录的方法。

首先，我在远程服务器上设置了 git，这样当我推送时，我可以自动将最新的 master 签出到 web 根目录（[使用这个伟大的技术](http://toroid.org/ams/git-website-howto)）。

然后，在我的接收后挂钩中，我放了这个：

```
#!/bin/sh
GIT_WORK_TREE=/var/www git checkout master -f
GIT_WORK_TREE=/path/to/staging/site/webroot git checkout staging -f 
```

使用这种方法，我可以使用 git 中的两个分支来保持站点的两个版本运行，并且当我推送时，暂存站点会使用暂存分支中的任何新更改进行更新，并且与主站点相同。

我发现这是在公开新功能之前管理演示新功能的好方法。

我不应该这样做吗？有没有更好的办法？其他想法或顾虑？

谢谢，杰森

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T22:01:40.517

在我看来，您使用 Git 的方式应该是 Git。您有相同文件的两个版本，并且您希望将每个“版本”分别维护为一个分支。

我假设当您准备好合并从 staging 到 master 的更改时，您只需在分支内执行`git merge staging`/之类的操作，然后从那里开始。`git rebase staging``master`

您根本没有错误地使用 Git。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T20:52:34.260

你想知道如何变得更漂亮。我将通过 post-receive 电子邮件挂钩脚本来展示它是如何工作的（部分）。这会变得很长！:-)

好的，所以，这是`post-receieve-email`（重新格式化了一下）的关键部分：

```
while read oldrev newrev refname; do
    prep_for_email $oldrev $newrev $refname || continue
    generate_email $maxlines | send_mail
done 
```

这会从输入流中读取 old-SHA、new-SHA 和 ref 名称（我认为这是 git 的失败之一：您只能读取此流一次，然后它就消失了；这使得连接一堆原本不相关的钩子过度困难）并调用两个 shell 函数来检查它们，然后忽略每个函数，或者对它们做一些事情。

现在这里是`prep_for_email`shell 函数的关键部分，带有注释：

```
prep_for_email()
{
    oldrev=$(git rev-parse $1)
    newrev=$(git rev-parse $2)
    refname="$3" 
```

此处的 rev-parse（加上我在上面放置的一些允许命令行参数的代码）允许您提供诸如“HEAD”和“HEAD^”之类的东西 rev 名称。实际的接收后挂钩始终获取原始 SHA1，因此 rev-parse 调用是无操作的。

```
 # --- Interpret
    # 0000->1234 (create)
    # 1234->2345 (update)
    # 2345->0000 (delete)
    if expr "$oldrev" : '0*$' >/dev/null
    then
        change_type="create"
    else
        if expr "$newrev" : '0*$' >/dev/null
        then
            change_type="delete"
        else
            change_type="update"
        fi
    fi 
```

在 post-receive 钩子中，如果“旧”SHA1 是`0000000000000000000000000000000000000000`（全零，即 40 个 0；`expr`上面只是检查全零），这意味着“ref”参数以前不存在，现在存在。这通常是一个分支创建操作，但也可以是一个标签创建。另一方面，如果“新”SHA1 全部为零，则“ref”参数之前*确实*存在，现在不存在：通常是分支删除操作。其他任何东西，*用于*解析旧版本的引用名称现在解析为新版本。这通常是分支更新，但也可以是例如标签移动。

接下来，电子邮件挂钩有一些很好的“偏执狂风格”编程，交叉检查 ref-name 与 git repo 中的实际底层对象类型：

```
 # --- Get the revision types
    newrev_type=$(git cat-file -t $newrev 2> /dev/null)
    oldrev_type=$(git cat-file -t "$oldrev" 2> /dev/null)
    case "$change_type" in
    create|update)
        rev="$newrev"
        rev_type="$newrev_type"
        ;;
    delete)
        rev="$oldrev"
        rev_type="$oldrev_type"
        ;;
    esac 
```

如果 ref-name 具有表单`refs/tags/*`并且更新是针对带注释的标记，则应该将`$oldrev_type`和都设置`$newrev_type`为`tag`。（如果它是一个轻量级标签，它们都将是`commit`。如果一个轻量级标签变成一个带注释的标签，旧类型将是提交，新类型将是标签，等等。）当然，如果你要删除一个分支或一个标签，“新” rev 将全为 0，并且`$newrev_type`将是空字符串，因为`git cat-file -t`它将简单地失败（这就是为什么`2> /dev/null`）。

（除此之外：没有充分的理由`git cat-file -t`引用它的论点，而一个没有。可能只是有人在遇到通常的空字符串参数问题后对引用过于满意，但错过了一个。幸运的是，在这种情况下，无论哪种方式都是无害的. :-) )

然后电子邮件脚本有一个很长的`case`语句：

```
case "$refname","$rev_type" in
    ...
esac 
```

这确保了一个操作`refs/heads/*`始终是一个`commit`. 如果没有，它将向 stderr 打印一条消息（在 a 上`git push`，该消息将发送给进行推送的任何人，前缀为`remote:`，以便*有人*可以看到它）：

```
 refs/heads/*,commit)
        # branch
        refname_type="branch"
        short_refname=${refname##refs/heads/}
        ;;
    ...
    *)
        # Anything else (is there anything else?)
        echo >&2 "*** Unknown type of update to $refname ($rev_type)"
        echo >&2 "***  - no email generated"
        return 1
        ;; 
```

现在从`generate_email`. 查看实际脚本以了解详细信息，但是，在这种情况下，我们只真正关心对 的调用`generate_email_header`，以及调用 的情况`generate_update_branch_email`。

这是标题：

```
generate_email_header()
{
    # --- Email (all stdout will be the email)
    # Generate header
    cat <<-EOF
    To: $recipients
    Subject: ${emailprefix}$projectdesc $refname_type $short_refname ${change_type}d. $describe
    X-Git-Refname: $refname
    X-Git-Reftype: $refname_type
    X-Git-Oldrev: $oldrev
    X-Git-Newrev: $newrev

    This is an automated email from the git hooks/post-receive script. It was
    generated because a ref change was pushed to the repository containing
    the project "$projectdesc".

    The $refname_type, $short_refname has been ${change_type}d
    EOF
} 
```

`$change_type`, 在我们关心的情况下, 是`update`这样说的: `branch zorg updated.` (`$describe`是 的输出`git describe $newrev`, 或者如果它是空的 - 即没有注释标签`git describe`可供使用 - 只是`$newrev`. `$recipients`, `$emailprefix`, 并且`$projectdesc`来自各种可配置项。)

在`generate_update_branch_email`中，有很多东西要计算和打印以发送电子邮件，确切地说是删除和添加了*哪些提交；*然后以：

```
 echo "Summary of changes:"
    git diff-tree --stat --summary --find-copies-harder $oldrev..$newrev 
```

基本上，`$refname`形式的分支引用`refs/heads/*`（比如，`refs/heads/zorg`），已经是`update`d（从不是全 0 的现有`$oldrev`到不是全 0 的新`$newrev`），意味着所说的（长格式）分支名称，人们通常称为`$short_refname`( `zorg`)，已移动该分支尖端。这比找出这个动作的确切含义的代码要简单*得多*！

在您的情况下，您无需担心分支创建；您可以将其视为定期更新。您可能（或可能不）想要在删除分支时做一些特别的事情。大多数时候，您只关心分支更新……而您要做的就是，如果`staging`已更新，则更新您的特殊暂存副本；如果`master`已更新，请更新您的特殊`master`副本。在每种情况下，更新都将是“到新的分支提示”，这真的很容易访问。

因此，如果我们将所有这些放在一起，我们会得到以下（未经测试，但非常简单）的钩子，我已经添加了从命令行调用它的能力。为了使它更有用，当从命令行调用时，您可以指定要在任何地方签出的修订版，例如，您可以说`./hookscript unused master~2 refs/heads/staging`将 rev 推`master~2`入暂存副本区域（假设您出于某种原因想要这样做）。

```
#! /bin/bash
#
# handle updates to our two interesting branches, staging and master.

# function to dump given commit state to target directory
# arguments: $1 - rev; $2 - target dir
copy_to_dir() {
    GIT_WORK_TREE="$2" git checkout -q -f "$1"
}

# function to handle an update to staging branch.
# arguments: $1 - rev to check out
update_staging() {
    copy_to_dir $1 /path/to/staging/site/webroot
}

# function to handle an update to master branch.
update_master() {
    copy_to_dir $1 /var/www
}

# function to handle one reference-change.
# arguments:
#    $1 - old revision, or all-0s on create
#    $2 - new revision, or all-0s on removal
#    $3 - reference (refs/heads/*, refs/tags/*, etc)
refchange() {
    local oldrev="$1" newrev="$2" ref="$3"
    local deleted=false
    local short_revname

    if expr "$newrev" : '0*$' >/dev/null; then
        deleted=true
    elif ! git rev-parse "$newrev"; then
        return # git rev-parse already printed an error
    fi

    case $ref in
    refs/heads/staging|refs/heads/master)
        shortref=${refname#refs/heads/};;
    *)
        return;;
    esac

    # someone pushed a change to staging branch or master branch
    if $deleted; then {
        echo "WARNING: you've deleted branch $shortref"
        echo "are you sure you wanted to do that?"
        echo "The operating copy is still operating, and"
        echo "will be updated when the branch is re-created."
        } 1>&2
        return
    fi

    # update either the staging copy or the master copy
    update_$shortref "$newrev"
}

# main driver: update from input stream (if no arguments) or use arguments
case $# in
3)  refchange "$1" "$2" "$3";;
0)  while read oldrev newrev refname; do
        refchange $oldrev $newrev $refname
    done;;
*)  echo "ERROR: update hook called with $# arguments, expected 0 or 3" 1>&2;;
esac 
```

请注意，因为我`git checkout -q -f`在已解析的 rev 上使用（而不是像`staging`or之类的名称`master`），所以每次都会将推送到的分支带到“分离的 HEAD”状态。更重要的是，如果您在 Web 服务器上使用“普通”存储库中的命令行技巧，它将解开您当前的分支。这不是致命的，但很容易令人讨厌。为避免这种情况，请将 的内容替换为`copy_to_dir`，例如`git archive $1 | (rm -rf "$2" && mkdir "$2" && cd "$2" && tar xf -)`.

（通常你会推送到一个`--bare`仓库，改变它“当前分支”的想法不是问题，因为没有人关心这个。）

# html - 是否有 html“位置”元素？

> ID：10058695
> 
> 赞同：3
> 
> 时间：2012-04-07T21:54:03.503
> 
> 标签：html, gps

[HTML5`time`元素](http://www.w3.org/TR/html5-author/the-time-element.html#the-time-element)看起来很酷，但我想知道是否有 a`location`或`place`元素之类的东西。它在 GPS 应用等中可能有用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:00:24.590

据我所知，HTML5 中没有 location 元素。不过看看这个：http: [//dev.w3.org/geo/api/spec-source.html](http://dev.w3.org/geo/api/spec-source.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T20:49:43.817

该`<location>`元素不存在。我会同意，从语义上讲，它对于涉及某种 GPS 的网络应用程序来说非常有用。

如果我理解正确，HTML5 允许您创建[自定义元素](http://dvcs.w3.org/hg/webcomponents/raw-file/tip/explainer/index.html#custom-element-section)，这可能是对新兴网络应用程序的临时修复。从语义上讲，我认为这不是最棒的事情（创建元素的所有额外标记），但有些人可能会使用它。[Eric Meyer 还有一篇讨论自定义元素的文章](http://meyerweb.com/eric/thoughts/2012/03/28/customizing-your-markup/)。

不过从技术上讲，我认为大多数浏览器都会在使用适当的 CSS 和/或 JavaScript 的情况下呈现未知标记......

* * *

### 2014 年 3 月更新

[自定义元素](http://www.w3.org/TR/custom-elements/)正在通过 W3C，它们实际上非常漂亮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T21:58:10.167

我没有听说过这样的元素。

这是HTML5 规范中可用的元素[列表](http://www.quackit.com/html_5/tags/)。*（更新：该列表基于 2009 年 2 月的规范，所以它有些旧，但仍然没有`location`我知道的元素。）*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T22:10:40.240

没有这样的元素称为“位置”。

[您可以使用Google Maps API](http://code.google.com/apis/maps/documentation/v3/)以 HTML 格式显示您的 GPS 数据

```
 <div id="map" style="width: 400px; height: 300px"></div> 

   <script type="text/javascript"> 
      var myOptions = {
         zoom: 8,
         center: new google.maps.LatLng(51.49, -0.12),
         mapTypeId: google.maps.MapTypeId.ROADMAP
      };

      var map = new google.maps.Map(document.getElementById("map"), myOptions);
   </script> 
```

# xcode - 将数组数据添加到表格单元格时应用程序崩溃

> ID：10058697
> 
> 赞同：0
> 
> 时间：2012-04-07T21:54:18.397
> 
> 标签：xcode

我正在尝试创建一个表格视图，将许多推文加载到表格中（每个单元格一个等）。

我正在使用 NSXMLParser 来获取信息，并且已经使用我想要的推文选择创建了一个数组。

但是，当我尝试将它们添加到表格单元格时，应用程序会在线崩溃：

```
cell.textLabel.text = cellValue; 
```

在此之前的 NSLog 在控制台中显示该应用程序正在获取正确的数据，所以我对为什么这不起作用感到有些困惑。

这是似乎有问题的代码块：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath { 

 static NSString *CellIdentifier = @"Cell";

 UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    } 

 // Set up the cell...
 NSString *cellValue = [statuses objectAtIndex:indexPath.row];
 NSLog(@"%@", cellValue);

 cell.textLabel.text = cellValue;

 return cell;} 
```

如果它有所作为，我使用的是 ARC 和最新版本的 XCode。

我对这一切还是很陌生，所以如果我需要提供一些额外的信息，请告诉我。

提前致谢。

编辑：

回溯给出以下内容：

```
* thread #1: tid = 0x2003, 0x918a19c6 libsystem_kernel.dylib`__pthread_kill + 10, stop reason = signal SIGABRT
frame #0: 0x918a19c6 libsystem_kernel.dylib`__pthread_kill + 10
frame #1: 0x9968ff78 libsystem_c.dylib`pthread_kill + 106
frame #2: 0x99680bdd libsystem_c.dylib`abort + 167
frame #3: 0x03c93e78 libc++abi.dylib`_Unwind_DeleteException
frame #4: 0x03c9189e libc++abi.dylib`_ZL17default_terminatev + 34
frame #5: 0x0154df4b libobjc.A.dylib`_objc_terminate + 94
frame #6: 0x03c918de libc++abi.dylib`_ZL19safe_handler_callerPFvvE + 13
frame #7: 0x03c91946 libc++abi.dylib`std::terminate() + 23
frame #8: 0x03c92ab2 libc++abi.dylib`__cxa_throw + 110
frame #9: 0x0154de15 libobjc.A.dylib`objc_exception_throw + 311
frame #10: 0x013bdced CoreFoundation`-[NSObject doesNotRecognizeSelector:] + 253
frame #11: 0x01322f00 CoreFoundation`___forwarding___ + 432
frame #12: 0x01322ce2 CoreFoundation`_CF_forwarding_prep_0 + 50
frame #13: 0x0015168f UIKit`-[UILabel setText:] + 56
frame #14: 0x00003088 Twitter`-[TwitterViewController tableView:cellForRowAtIndexPath:] + 376 at TwitterViewController.m:131
frame #15: 0x000ace0f UIKit`-[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:withIndexPath:] + 494
frame #16: 0x000ad589 UIKit`-[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:] + 69
frame #17: 0x00098dfd UIKit`-[UITableView(_UITableViewPrivate) _updateVisibleCellsNow:] + 1350
frame #18: 0x000a7851 UIKit`-[UITableView layoutSubviews] + 242
frame #19: 0x00052301 UIKit`-[UIView(CALayerDelegate) layoutSublayersOfLayer:] + 145
frame #20: 0x013bde72 CoreFoundation`-[NSObject performSelector:withObject:] + 66
frame #21: 0x01d6692d QuartzCore`-[CALayer layoutSublayers] + 266
frame #22: 0x01d70827 QuartzCore`CA::Layer::layout_if_needed(CA::Transaction*) + 231
frame #23: 0x01cf6fa7 QuartzCore`CA::Context::commit_transaction(CA::Transaction*) + 377
frame #24: 0x01cf8ea6 QuartzCore`CA::Transaction::commit() + 374
frame #25: 0x01d8430c QuartzCore`+[CATransaction flush] + 52
frame #26: 0x000124c6 UIKit`-[UIApplication _reportAppLaunchFinished] + 39
frame #27: 0x00012bd6 UIKit`-[UIApplication _runWithURL:payload:launchOrientation:statusBarStyle:statusBarHidden:] + 1324
frame #28: 0x00021743 UIKit`-[UIApplication handleEvent:withNewEvent:] + 1027
frame #29: 0x000221f8 UIKit`-[UIApplication sendEvent:] + 68
frame #30: 0x00015aa9 UIKit`_UIApplicationHandleEvent + 8196
frame #31: 0x012a6fa9 GraphicsServices`PurpleEventCallback + 1274
frame #32: 0x013901c5 CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 53
frame #33: 0x012f5022 CoreFoundation`__CFRunLoopDoSource1 + 146
frame #34: 0x012f390a CoreFoundation`__CFRunLoopRun + 2218
frame #35: 0x012f2db4 CoreFoundation`CFRunLoopRunSpecific + 212
frame #36: 0x012f2ccb CoreFoundation`CFRunLoopRunInMode + 123
frame #37: 0x000122a7 UIKit`-[UIApplication _run] + 576
frame #38: 0x00013a9b UIKit`UIApplicationMain + 1175
frame #39: 0x0000239d Twitter`main + 141 at main.m:16
frame #40: 0x00002305 Twitter`start + 53 
```

调试控制台显示：

```
2012-04-08 10:10:05.084 Twitter[25309:f803] (
    {
    text = "Have you shared the Shakedown yet? http://t.co/WHrIC9w7";
},
    {
    text = "For all you closet rocknrollas pencil in Sat 12th May The Rebirth of Rock n Roll Party. Haywire Saint @ The Good... http://t.co/OXHKlLIV";
},
    {
    text = "4 weeks today: Vocal tracks will be getting recorded at The Premises Studios";
},
    {
    text = "Rehearsal tonight in preparation to some big recording next month!";
},
    {
    text = "haywire saint 'great taste.'  Tune. \n\nhttp://t.co/GKmu5Lna http://t.co/0fii55Hw";
},
    {
    text = "Meeting up with an old roadie for The Cure today. oh the stories...... http://t.co/UeUYccme";
},
    {
    text = "Satisfying day of programming today.. Haywire Saint app coming along nicely with the custom music player ready to rock 'n' roll!";
},
    {
    text = "Happy Friday Everyone!";
},
    {
    text = "We had a great time at The Premises Studios yesterday. We'll be back there before long :D x";
},
    {
    text = "I posted a new photo to Facebook http://t.co/73qAnCvk";
}
)

2012-04-08 10:10:05.093 Twitter[25309:f803] {
text = "Have you shared the Shakedown yet? http://t.co/WHrIC9w7";
}

2012-04-08 10:10:05.094 Twitter[25309:f803] -[__NSCFDictionary isEqualToString:]:      unrecognized selector sent to instance 0x6877a50
2012-04-08 10:10:05.096 Twitter[25309:f803] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFDictionary isEqualToString:]: unrecognized selector sent to instance 0x6877a50'
*** First throw call stack:
(0x13bc052 0x154dd0a 0x13bdced 0x1322f00 0x1322ce2 0x15168f 0x3088 0xace0f 0xad589 0x98dfd 0xa7851 0x52301 0x13bde72 0x1d6692d 0x1d70827 0x1cf6fa7 0x1cf8ea6 0x1d8430c 0x124c6 0x12bd6 0x21743 0x221f8 0x15aa9 0x12a6fa9 0x13901c5 0x12f5022 0x12f390a 0x12f2db4 0x12f2ccb 0x122a7 0x13a9b 0x239d 0x2305)
terminate called throwing an exception2012-04-08 10:10:05.924 Twitter[25309:f803] -[__NSCFConstantString count]: unrecognized selector sent to instance 0x5b30 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T17:26:12.627

`cell.textLabel.text`需要一个`NSString *`，所以在这一行之前：

```
cell.textLabel.text = cellValue; 
```

尝试 ：

```
NSLog(@"%@", [cellValue class]); 
```

或者

```
NSLog(@"%i", [cellValue isKindOfClass:[NSString class]]); 
```

找出确切的对象类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T12:54:31.537

该`statuses`数组似乎包含字典，而不是字符串。每个字典都有一个键，“文本”。

因此，您可以通过更改以下行来修复崩溃：

```
NSString *cellValue = [statuses objectAtIndex:indexPath.row]; 
```

至

```
NSString *cellValue = [[statuses objectAtIndex:indexPath.row] objectForKey:@"text"]; 
```

或者，如果您要以`statuses`不同的方式构造数组，您可以使其直接包含字符串，而无需不必要地包含在字典中。如果不知道您是如何构建的，很难告诉您如何修复该部分。

# reflection - 获取地图的值对象的类名

> ID：10058698
> 
> 赞同：3
> 
> 时间：2012-04-07T21:54:20.303
> 
> 标签：reflection, groovy

我有一个参数映射，它可以包含字符串以及自定义对象类型作为值。如何获取 Maps 值条目的类名。

```
Right now if I do 
 paramMap.each {
    println(it.value.class.name) 
} 
```

它为我提供了所有条目，如`java.util.LinkedHashMap$Entry` 如何获取`type`存储在映射中的实际值，如字符串、配置、安全配置...等。

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T22:23:08.840

这应该有效：

```
paramMap.each { key, value ->
    println( value.getClass().name )
} 
```

# .net - 在 .NET 4.0 和 WPF 中使用 SerialPort 的多个条形码阅读器

> ID：10058702
> 
> 赞同：0
> 
> 时间：2012-04-07T21:54:51.653
> 
> 标签：.net, wpf, serial-port, barcode-scanner

我最近从 Datalogic 购买了 3 个条形码阅读器（2 个 Magellan 3300HSi 和 1 个 Gryphon 4400）。制造商提供了一个我已安装的 USB 到 COM 驱动程序，并允许我使用 SerialPort 类与扫描仪通信。一旦我插入扫描仪（通过 USB），就会在设备管理器中添加一个 COM 端口，允许我在其上调用 Open() 方法。

我正在构建的应用程序的一部分是测试与扫描仪的通信是否正常。这是通过执行测试扫描来完成的。此扫描中使用的方法是：

**1.打开扫描仪**

```
public static SerialPort OpenPort(string comPortName)
{
    bool error;
    this.comport = new SerialPort();
    this.comport.BaudRate = 9600;
    this.comport.DataBits = 8;
    this.comport.StopBits = (StopBits)Enum.Parse(typeof(StopBits), "One");
    this.comport.Parity = (Parity)Enum.Parse(typeof(Parity), "None");
    this.comport.PortName = comPortName;

    try{
        this.comport.Open();
    }
    catch (UnauthorizedAccessException) { error = true; }
    catch (IOException) { error = true; }
    catch (ArgumentException) { error = true; }

    if (error)
    {
            return null;
    }

    return comport; 
```

}

**2.数据处理监听器**

```
 public void PortDataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        SerialPort comport = sender as SerialPort;

        if (!comport.IsOpen) return;

        string data = comport.ReadExisting();

        MessageBox.Show("Data received " + data);
    } 
```

**3.附加数据处理程序**

```
 this.comPort.DataReceived += new SerialDataReceivedEventHandler(PortDataReceived); 
```

**4\. 编写关闭/分离方法**

```
 public void CloseScanner()
    {
        if (this.comport.IsOpen)
        {
            this.comport.Close();
            this.comPort.DataReceived -= new SerialDataReceivedEventHandler(PortDataReceived);
        } 
```

为了进行测试扫描，我单击一个按钮，调用 OpenPort，返回一个 SerialPort 对象。我附上数据处理程序。我执行扫描。显示扫描的数据。我关闭扫描仪。

**这是问题所在：**

如果我只做一次，这就像一种魅力。如果关闭串口后，我想用同一个端口进行另一次测试，端口成功打开，但没有接收到数据。扫描仪（设备）在第二次关闭时发出错误提示音。

奇怪的是，这只发生在我的 Magellan 扫描仪上。Gryphon 在随后的重新开放操作中就像一个魅力。

更奇怪的是，我使用 Putty 的串行模式连接到端口。当关闭 Putty 并再次打开它以进行新会话时，Magellan 扫描仪工作正常。

我的猜测是，这与串行端口在 .NET 中的关闭方式有关。也许资源没有被释放或其他东西。最初我认为这一定是扫描仪问题，需要我遵循某种协议来关闭连接。但是，Putty 似乎可以很好地使用它。（我猜 Putty 正在使用不同的类与扫描仪进行通信，甚至可能是 WIN32 API）。

如果有人知道这可能是什么原因，请告知。这可能是一些线程问题吗？我正在认真考虑查看 Putty 的源代码，看看他们如何解决这个问题或使用 WIN32 API（不过这对我来说会使事情变得过于复杂）。

**TLTR：** 关闭并重新打开 SerialPort，使我无法从条形码扫描仪接收数据。它仅在第一次打开端口时起作用。我正在使用制造商的 USB 到 COM 驱动程序。我究竟做错了什么？（上面的代码片段）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T05:19:42.050

如果您正在开发针对特定设备品牌的条形码阅读器应用程序，最好使用他们的 sdk/objects 而不是使用 .Net 通用 SerialPort 类。.Net 框架在那个领域并没有变得更好。它仍然有点缓慢和错误。

您可以查看 Jan Axelson 的网站，其中包含大量 .Net 和 Win32 中的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-01-06T23:56:53.870

这有点旧，但我认为其他人可以使用一些帮助。我目前正在处理 60 台计算机中的 1 台上的 Magellan 800i 问题并进行一些研究。您的代码有点模糊，使用“this”。在一个不会编译的静态函数中。我猜测您重新创建了额外的 SerialPort 对象并且从不释放原始对象并且您的 open 函数实际上并没有打开端口。您需要发布更多的项目。

```
using System.IO.Ports;
using System.IO;

namespace WpfApplication1
{
/// <summary>
/// Interaction logic for MainWindow.xaml
/// </summary>
public partial class MainWindow : Window
{
    SerialPort comport = new SerialPort();

    public MainWindow()
    {
        InitializeComponent();
    }

    /// <summary>
    /// Buttonn on form that opens the assigned serial port
    /// Each barcode scanned will display a messagebox until you close the port.  
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private void btnOpenScanner_Click(object sender, RoutedEventArgs e)
    {
        if (this.comport.IsOpen == false)
        {
            if (OpenPort("COM4"))
            {
                this.comport.DataReceived += new SerialDataReceivedEventHandler(PortDataReceived);
            }
        }
        else
        {
            MessageBox.Show("This comport is already assigned.  Quit clicking the open button you silly user.");
        }            
    }        

    /// <summary>
    /// Button on Form that closes the serial port
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private void btnCloseScanner_Click(object sender, RoutedEventArgs e)
    {
        CloseScanner();
    }

    /// <summary>
    /// Opens the serial port
    /// </summary>
    /// <param name="comPortName"></param>
    public bool OpenPort(string comPortName)
    {
            this.comport = new SerialPort();
            this.comport.BaudRate = 9600;
            this.comport.DataBits = 8;
            this.comport.StopBits = StopBits.One;
            this.comport.Parity = Parity.None;
            this.comport.PortName = comPortName;            

            try
            {
                this.comport.Open();
                return true;
            }
            catch (Exception ex) {
                MessageBox.Show(ex.Message);
                return false;
            }               
    }

    /// <summary>
    ///  Event Handler to receive scanned data
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    public void PortDataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        SerialPort sendingport = (SerialPort)sender;

        if (!sendingport.IsOpen) return;

        string data = sendingport.ReadExisting();

        MessageBox.Show("Data received " + data);

    }

    /// <summary>
    /// Closes the serial port.
    /// </summary>
    public void CloseScanner()
    {
        if (this.comport.IsOpen)
        {
            this.comport.Close();
            this.comport.DataReceived -= new SerialDataReceivedEventHandler(PortDataReceived);                                
        }
    }       
}

} 
```

# c# - C# 中的有序和无序并行集合应该有不同的类型吗？

> ID：10058703
> 
> 赞同：1
> 
> 时间：2012-04-07T21:55:01.053
> 
> 标签：c#, collections, plinq, parallel-processing

使用 PLINQ C# 并行查询是有序或无序的，具体取决于您如何构建它们。在 MSDN 上有一些[关于 PLINQ 中订单保存的](http://msdn.microsoft.com/en-us/library/dd460677.aspx)信息。

我发现这令人困惑且难以管理。在我看来，顺序重要的集合是*序列*，而顺序不重要的集合是*袋子*（或者如果没有重复，那么它们可能是*集合*）。

对包和序列的操作是不同的，并且具有不同的复杂性特征，尤其是在作为并行算法实现时。

换句话说，我认为有序和无序的集合应该是不同的类型，这会简化事情。是否有理由将 PLINQ 中的所有内容统一为简单的“ParallelQuery()”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T22:11:59.983

> 是否有理由将 PLINQ 中的所有内容统一为简单的“ParallelQuery()”

它更简单。我想有两种类型是可能的，但费用相当可观。它会更容易使用吗？

当您在 Parallel 中处理序列时，默认情况下您放弃 Order。您应该知道重新建立序列是昂贵的，并且它应该需要一些额外的步骤。

但是当您需要它时，添加一个`.AsOrdered()`似乎比先将您的数据复制（！）到另一个集合要少得多。

# jsf-2 - 从 ViewAccessScope 中移除一个 bean

> ID：10058705
> 
> 赞同：0
> 
> 时间：2012-04-07T21:55:23.200
> 
> 标签：jsf-2, codi

这是用于 JSF 2.0 的 MyFaces CODI JSF-Module v1.0.1

我有一个使用@ViewAccessScoped 后备bean 的JSF 页面，它几乎可以满足我的要求，只是在我完成后它不会消失。该页面是从另一个页面调用的，如下所示：

```
 <h:link outcome="/editLocation" target="_blank" 
       value="Edit Location: #{maintLocation.selected.id}"
       disabled="#{!maintLocation.rowSelected}">                               
          <f:param name="locationID" value="#{maintLocation.selected.id}" />
          <f:param name="closeOnUpdate" value="true" />
  </h:link> 
```

用户体验是**editLocation**页面在新窗口或新选项卡中弹出，用户对其进行编辑，如果**closeOnUpdate**参数设置为 true ，则在完成时调用**window.close() 。**

 **这一切都有效。但是，如果用户编辑*另一个*位置，**ViewAccessScoped** bean 仍然存在，因此它不会被重新实例化。因此，它永远不会看到参数，而只是根据先前的记录得出它所处的状态。

通过手动擦除浏览器 URL 窗口中的**windowid**参数，我可以获得一个新的支持 bean。有没有办法从**h:link**组件中删除它？

或者，有没有办法让bean在点击完成按钮后将自己从它所在的范围中移除？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T20:27:24.790

[我在 CODI Wiki 页面](https://cwiki.apache.org/confluence/display/EXTCDI/JSF+Usage#JSFUsage-TerminatingConversations)上找到了答案。尽管我没有隐式使用 CODI 对话，但 @ViewAccessScoped 实现似乎是在它之上分层的。所以我可以这样做：

```
import org.apache.myfaces.extensions.cdi.core.api.scope.conversation.Conversation;

...

@Inject private Conversation conversation;

...

conversation.close();  // when I have committed to close the window. 
```**

# iphone - 色度计rgb iphone ios代码

> ID：10058711
> 
> 赞同：0
> 
> 时间：2012-04-07T21:56:51.293
> 
> 标签：iphone, ios, xcode, cocoa-touch

我想从头开始为 iphone 构建一个色度计：一个应用程序，您可以在其中将相机对准某物并获取 rgb 值。简单的。应用商店有很多这样的应用，但我想将其用作未来探索的案例研究。

有谁知道我可以从哪里开始？任何框架已经可用，或者甚至更好的应用程序已经构建了一个可用的开源？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:06:18.987

前段时间我确实尝试过这个，这两个答案对我帮助很大......

[如何获取iphone上图像上像素的RGB值](https://stackoverflow.com/questions/144250/how-to-get-the-rgb-values-for-a-pixel-on-an-image-on-the-iphone)

[从 CGImage 获取 RGB 像素数据](https://stackoverflow.com/questions/6073259/getting-rgb-pixel-data-from-cgimage)

希望他们也能帮助你.. :)

# ios - 在 UIViewController 上添加按钮时出错：'NSUnknownKeyException'

> ID：10058712
> 
> 赞同：1
> 
> 时间：2012-04-07T21:56:53.047
> 
> 标签：ios, objective-c

我已经在我的项目中添加了一个 UIViewController 并且它工作正常，除非我添加了按钮。我收到一个错误：***由于未捕获的异常“NSUnknownKeyException”而终止应用程序，原因：“[setValue:forUndefinedKey:]：此类不符合键取消的键值编码。”

这是头文件和实现文件的代码。当我使用助手编辑器和 CTRL 从每个控件拖动到头文件时，所有这些代码都是自动生成的。

SignUpViewController.h：

```
#import <UIKit/UIKit.h>

@interface SignUpViewController : UIViewController {

    IBOutlet UITextField *leader;
    IBOutlet UITextField *emailAddress;
    IBOutlet UITextField *firstName;
    IBOutlet UIScrollView *scrollView;
    IBOutlet UITextField *lastName;
}
- (IBAction)cancel:(id)sender;
- (IBAction)signUp:(id)sender;

@end 
```

注册视图控制器.m

```
#import "SignUpViewController.h"

@interface SignUpViewController ()

@end

@implementation SignUpViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
   self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
   if (self) {
   }
   return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    [scrollView setScrollEnabled:YES];
    [scrollView setContentSize:CGSizeMake(320, 1000)];

}

- (void)viewDidUnload
{
    firstName = nil;
    lastName = nil;
    emailAddress = nil;
    leader = nil;
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (IBAction)cancel:(id)sender {
}

- (IBAction)signUp:(id)sender {
}
@end 
```

我不确定为什么会发生错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T02:26:31.260

当您在源代码中删除 IBOutlet 时会发生此错误，但不要在 Interface Builder 中取消连接它。检查您的 XIB 文件以确保没有剩余的旧属性。旧的有线属性将在其中显示一个感叹号 (!)。

# javascript - 根据窗口宽度更改javascript

> ID：10058713
> 
> 赞同：0
> 
> 时间：2012-04-07T21:56:55.593
> 
> 标签：javascript, jquery

我认为这很简单，但经过 2 天的尝试，我仍然一无所知。基本上，如果屏幕超过 767 像素宽，我需要运行一组命令，如果屏幕低于 767 像素，我需要运行另一组命令。

当屏幕宽于 767 像素时，我想：

```
<script type="text/javascript">

    var jsReady = false;//for flash/js communication

    // FLASH EMBED PART
    var flashvars = {};
    var params = {};

    params.quality = "high";
    params.scale = "noscale";
    params.salign = "tl";
    params.wmode = "transparent";
    params.bgcolor = "#111111";//change flash bg color here
    params.devicefont = "false";
    params.allowfullscreen = "true";
    params.allowscriptaccess = "always";
    var attributes = {};
    attributes.id = "flashPreview";

    swfobject.embedSWF("preview.swf", "flashPreview", "100%", "100%", "9.0.0", "expressInstall.swf", flashvars, params, attributes);

    <!-- and much more code... -->

</script> 
```

当屏幕小于 768 像素时，我想运行：

```
<script type="text/javascript">  

        jQuery(function($){
            $.supersized({
                //Background image
                slides  :  [ { image : 'img/some_image.jpg' } ]                 
            });
        });

</script> 
```

没错...对于台式机和平板电脑，我想显示全屏视频背景。对于较小的屏幕（小于 767 像素），我想显示单个静止图像背景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T22:19:10.347

您可以使用`$(window).width()`窗体的调整大小事件并附加处理程序来获取窗口的当前大小。对于一个简单的使用，它很简单

```
$(window).resize(funcion() {
    $width = $(window).width();
    if($width < 767) {
            $.supersized({
                //Background image
                slides  :  [ { image : 'img/some_image.jpg' } ]                 
            });
    } else {
        //if width is greater than 767
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T22:03:26.703

```
if(screen.width > 767) {
   code A...
} else {
   code B...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T22:06:04.507

由于您使用的是 JQuery，因此您可以使用它：

```
if ($(window).width > 767) { ... } 
```

这将返回窗口的当前大小，而不是最大值。

# iphone - 如何在保存时调试 CoreData 崩溃？

> ID：10058717
> 
> 赞同：0
> 
> 时间：2012-04-07T21:57:17.040
> 
> 标签：iphone, objective-c, cocoa-touch, ipad, core-data

我正在尝试在我的应用程序中使用 Coredata 保存我的对象，但我遇到了崩溃并且这个非常令人困惑的错误：

```
Unresolved error Error Domain=NSCocoaErrorDomain Code=1570 "The operation couldn‚Äôt be completed. (Cocoa error 1570.)" UserInfo=0x2f8820 {NSValidationErrorObject=<ContactInfo: 0xf081140> (entity: ContactInfo; id: 0x20c0f0 <x-coredata:///ContactInfo/tDCD050E6-3BA3-47D2-A5ED-A22D53749E4B7> ; data: {
    addressLine1 = nil;
    addressLine2 = nil;
    email = nil;
    mobileNo = nil;
    name = nil;
    phoneNo = nil;
    stateCounty = nil;
    townCity = nil;
    venue = nil;
    zipIp = nil;
}), NSValidationErrorKey=name, NSLocalizedDescription=The operation couldn‚Äôt be completed. (Cocoa error 1570.)}, {
    NSLocalizedDescription = "The operation couldn\U2019t be completed. (Cocoa error 1570.)";
    NSValidationErrorKey = name;
    NSValidationErrorObject = "<ContactInfo: 0xf081140> (entity: ContactInfo; id: 0x20c0f0 <x-coredata:///ContactInfo/tDCD050E6-3BA3-47D2-A5ED-A22D53749E4B7> ; data: {\n    addressLine1 = nil;\n    addressLine2 = nil;\n    email = nil;\n    mobileNo = nil;\n    name = nil;\n    phoneNo = nil;\n    stateCounty = nil;\n    townCity = nil;\n    venue = nil;\n    zipIp = nil;\n})";
} 
```

ContactInfo 是我的核心数据模型中的一个实体，我有另一个名为 VenueInfo 的实体，每个对象都有一个 ContactInfo 对象，因为每个场所都需要联系人详细信息。如果错误消息不够，我将添加一些代码和更多详细信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-07T22:28:02.003

原来这个关键的一点点信息：

`NSValidationErrorKey=name`

属性的手段，`name`有一个验证问题，这是因为直到现在我才知道，我的核心数据模型中的这个属性不是可选的，如图所示返回 nil 导致崩溃。

通过提供`name`a 值或使其可选来避免崩溃。

# ruby-on-rails - 如果在 Rails 中未授权，则重定向到登录页面

> ID：10058726
> 
> 赞同：0
> 
> 时间：2012-04-07T21:59:23.057
> 
> 标签：ruby-on-rails, redirect, devise

我的 Rails 应用程序中有 Devise 和 CanCan。我认为默认情况下，如果用户尝试登录到未经授权的页面，它应该将用户重定向到登录页面。但不知何故，它不适用于我的应用程序。

如果不是全局的（即，对于所有控制器/方法），我如何实施检查用户是否被授权并重定向到家？

**更新：**更新 jquery 后，我的 CanCan 似乎不再工作了。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:21:15.103

它应该工作，向我们展示您的`routes.rb`文件。要检查只需`before_filter :authenticate_member!`在控制器类的顶部添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T22:05:34.150

这就是我使用自己的自定义身份验证（可能与设计类似）的方式（在 routes.rb 中）：

```
root :to => '<controller#action_needing_authorization>', :constraints => lambda{|req| !req.session[:user_id].blank? }
root :to => 'sessions#new' 
```

这是有效的，因为路由按照它们指定的顺序匹配。

# android - 横向和纵向模式布局问题

> ID：10058728
> 
> 赞同：0
> 
> 时间：2012-04-07T22:00:15.330
> 
> 标签：android, android-layout

我正在开发一个 Android 应用程序并遇到布局问题。

我创建了**layout-large**和**layout-large-land**文件夹来更改横向布局和纵向布局；但我有一个奇怪的问题。

如果我以纵向模式启动应用程序并旋转到横向模式；应用程序没有更改布局，因此用户可以看到纵向模式布局。但是，如果我以横向布局模式启动应用程序并旋转到纵向模式；应用程序没有更改布局，因此用户可以看到横向模式布局。

如果重新打开该窗口，则两次都将当前方向模式应用于屏幕。

布局上没有`android:orientation`属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T07:22:19.123

确保您没有[`android:configChanges="orientation"`](http://developer.android.com/guide/topics/manifest/activity-element.html#config)在您的 AndroidManifest 中为该 Activity 设置（这样可以避免在方向更改时重新创建 Activity，因此不会重新读取您的配置特定布局）。

# xcode - MonoDevelop：安装到 SSD 驱动器以提高速度

> ID：10058732
> 
> 赞同：2
> 
> 时间：2012-04-07T22:01:13.687
> 
> 标签：xcode, xamarin.ios, monodevelop, solid-state-drive

我有一个新的 256 gig **SSD**驱动器，它取代了我的 MacBook Pro 的 CD 驱动器。

目标是使`MonoDevelop`+`MonoTouch`应用程序开发尽可能快。我怎样才能将`MonoDevelop`++ `MonoTouch`（不确定还有什么`xcode`可能？）移动到**SSD**驱动器以加快开发速度。这是计算机的唯一任务。

主操作系统位于标准驱动器上。我有 8 个 gigs ram 和一个 i5，所以**SSD**是我认为增强 IDE 体验所需的唯一硬件。

这是一个软件问题，因为它与专门配置 IDE 有关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T22:21:44.197

@sblom 涵盖了主要部分。您还需要注意：

*   编译器创建了很多临时文件（主要是在 中`\var\tmp`）；
*   还会加载很多系统库；

对于这两种情况，评论（来自 Sebastian Flückiger）都一针见血。如果您的主驱动器是 SSD 驱动器并在现有硬盘驱动器上保留不常用的数据，您将获得最佳性能。

这可能是您预期的更大变化。OTOH 它还消除了@sblom 提到的潜在问题，例如更新 Xcode（wrt 符号链接）并将 MonoTouch 和 MonoDevelop 保留在其默认目录中（这在创建/共享脚本时很有用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-08T18:13:49.303

**移动 MonoDevelop**

您可以将 MonoDevelop.app 放置在您喜欢的任何地方，它应该可以正常工作——这是最简单的部分。

**移动 MonoTouch SDK**

移动 MonoTouch 有点困难，但应该仍然可以。在 MonoDevelop 中打开 Preferences 面板，向下滚动到底部。在“其他”部分，您将看到一个名为“SDK 位置”的页面。将 MonoTouch 从`/Developer/MonoTouch`您想要的任何位置移动，然后将“MonoTouch SDK”设置为指向它的新家。

**移动 XCode**

至于移动 XCode，如果你在 Lion 上运行最新的 XCode（我认为是 4.3？），你会在`/Applications/XCode.app`. 您也可以将其移动到您想要的任何位置。除非您从 符号链接到它的新主页，否则很多事情都会不愉快`/Applications`，并且当您从 Mac App Store 升级 XCode 时，符号链接可能会被踩到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T12:29:11.960

MonoTouch 许可代码没有问题吗？或者只有当你更换你的高清而不是添加另一个。

# php - 注意：未定义索引：PHP

> ID：10058738
> 
> 赞同：-1
> 
> 时间：2012-04-07T22:01:43.463
> 
> 标签：php, html, css

我对一些未定义的索引有一些问题。我意识到可以通过使用`error_reporting(E_ALL);`, 或更改错误报告`ini_set('display_errors', '1');`来解决此问题，但希望无需更改即可解决此问题。这是我抛出错误的代码块。

```
// print out errors
              if (!empty($errors)){
                echo '<div class="form_errors">';
                foreach ($errors as $key => $value) {
                  var_dump($value);
                  if (isset($value) ==  null or empty($value)){
                    $value = ' A blank value ';
                  }
                  echo '<p>Please check '. $key . ' for errors.' . $value . 'is not a valid entry.</p>';
                }
                echo '</div>';
              } 
```

在提交时处理我的表单的部分是

```
if(isset($_POST['Submit'])){
    //create the fields you would want required and what fields on form to check.
    $fields = array(
      'required' => array(
            'name' => '^[a-zA-Z\`\-\s]{1,30}$', //only letters plus apostrophe and hyphens, and up to 30 characters
            'Address1' => '^[a-zA-Z0-9\s\.]{1,50}$' // only letters plus numbers, spaces, periods, and up to 30 characters
        ),
      'fields' => array( 
            'name' => $_POST['name'],
            'Address1' => $_POST['Address1'],
            'Address2' => $_POST['address2']
        ),
      'redirect' => 'thankyou.php'
    );
    $errors = TForm::validate($fields);
    // if no errors redirect
    if (empty($errors)){
      TForm::redirect($fields);
    }
  } 
```

我的 TForm 类看起来像这样

```
class TForm {
    //validation returns an error array when done. 
    public function validate($fields){
        $errors = array();
        foreach($fields['fields'] as $key=>$value) {
            foreach ($fields['required'] as $req_key => $req_value) {
                if ($key == $req_key){
                    $req_key = '\''.$req_value.'\'';
                    if (preg_match($req_key , $value) == false) {
                        $errors[$key] = $value;
                    }  
                }
            }
        }
        return $errors;
    }

    //redirect function
    public function redirect($fields){
        header('Location: '. $fields['redirect']);
    }

} 
```

这也是我写过的第一堂课，所以如果有人愿意指出我本可以表现更好或打破标准的地方。~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~更新~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

@jordan抱歉，我不清楚错误报告`E_ALL`是我目前正在使用的，并且在生产机器上不会报告此错误，因为您将使用`0`. 我的解决方案是使用`!empty($_POST['Name']) ? $_POST['Name']:''`如果我的想法正确，如果它不为空，则使用其中的任何内容`$_POST['Name']`，如果为空，则将值设置为`''`.

```
'fields' => array( 
            'Name' => !empty($_POST['Name']) ? $_POST['Name']:'',
            'Address1' => !empty($_POST['Address1']) ? $_POST['Address1']:'',
            'Address2' => !empty($_POST['Address2']) ? $_POST['Address2']:''
        ) 
```

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~更新2~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

@mike 使用 isset 导致该领域总是失败，即

```
'fields' => array( 
            'Name' => !isset($_POST['Name']) ? $_POST['Name']:'',
            'Address1' => !isset($_POST['Address1']) ? $_POST['Address1']:'',
            'Address2' => !isset($_POST['Address2']) ? $_POST['Address2']:''
        ) 
```

当 name 等于有效变量时导致结果，例如 Frank Wiebenga

```
Please check Name for errors. A blank value is not a valid entry.
Please check Address1 for errors. A blank value is not a valid entry. 
```

当 Name 等于有效变量时使用空方法，例如 Frank Wiebenga 正确返回

```
Please check Address1 for errors. A blank value is not a valid entry. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:10:30.423

您需要添加完整的错误消息以更好地帮助您，但在您的脚本中，我注意到唯一未声明的外部变量是`$_POST`值，请更新下面的代码并让您知道您仍然存在的确切错误。

```
if(isset($_POST['Submit'])){
    //create the fields you would want required and what fields on form to check.

    if(!isset($_POST['name']) || !isset($_POST['Address1']) || !isset($_POST['address2']))
    {
        die("Empty POST NOt allowed ");
    } 
```

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:10:32.773

`undefined index`对通知的一般答复：

`$myArray['myKey']`如果数组`myKey`中不存在，将产生未定义的索引通知。`$myArray`您可以通过在使用它之前检查它的存在来解决这个问题。

```
if (array_key_exists($myArray, 'myKey')) {
  echo $myArray['myKey'];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T23:36:33.240

根据您的更新，您应该使用`isset`而不是`empty`，因此您可以避免未定义的索引错误：

```
$name = (isset($_POST['Name'])) ? $_POST['Name'] : ''; 
```

[有关isset](http://us2.php.net/isset)的更多信息。

- 更新 -

尝试翻转三元赋值：

```
$name = (!isset($_POST['Name'])) ? '' : $_POST['Name']; 
```

# java - 在java中创建alpha图像

> ID：10058740
> 
> 赞同：3
> 
> 时间：2012-04-07T22:02:32.950
> 
> 标签：java, java-2d

我即将开始一个项目，该项目将生成一些带有 alpha（渐变）的 PNG，并希望在 java 中以编程方式绘制它们。

对于（一个简单的）示例，我想绘制一个框，添加一个阴影，然后将其保存到一个 PNG 文件中，然后可以覆盖在其他一些图形上。

1.  使用标准 JRE 系统库可以做到这一点吗？
2.  哪些库会使这种操作变得简单？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T09:05:29.867

> Is this possible with the standard JRE system libraries?

Yes, it is possible and is pretty simple aswell. The code below produces this image (transparent png):

![screenshot](../Images/48a78b90a6a1cbe2e4d9bab9cb9f186b.png)

```
public static void main(String[] args) throws IOException {

    int x = 50, y = 50, w = 300, h = 200;

    // draw the "shadow"
    BufferedImage img = new BufferedImage(400, 300, BufferedImage.TYPE_INT_ARGB);
    Graphics g = img.getGraphics();
    g.setColor(Color.BLACK);
    g.fillRect(x + 10, y + 10, w, h);

    // blur the shadow
    BufferedImageOp op = getBlurredOp();
    img = op.filter(img, null);

    // draw the box
    g = img.getGraphics();
    g.setColor(Color.RED);
    g.fillRect(x, y, w, h);

    // write it to disk
    ImageIO.write(img, "png", new File("test.png"));
}

private static BufferedImageOp getBlurredOp() {

    float[] matrix = new float[400];
    for (int i = 0; i < 400; i++)
        matrix[i] = 1.0f/400.0f;

    return new ConvolveOp(new Kernel(20, 20, matrix),
                          ConvolveOp.EDGE_NO_OP, null);
} 
```

> Which libraries would make this kind of operation simple?

I would say that it depends on your other use cases. For simple shapes like boxes and ovals I would go for the solution above, no library is needed.

# javascript - javascript解析csv excel文件

> ID：10058745
> 
> 赞同：0
> 
> 时间：2012-04-07T22:03:20.617
> 
> 标签：javascript, html, mobile, csv

我正在尝试解析我在 Excel 中制作的 CSV 文件。我想用它来更新我的谷歌地图。此 Google 地图位于我正在使用 Eclipse for Android 开发的移动应用程序中。

老实说，我不确定如何编写 JavaScript。任何帮助将不胜感激。我很乐意相信你的工作。

我只想在用户点击执行以下操作的按钮时运行一些 JavaScript：

1.  定位用户当前位置（我已经完成了这部分！）
2.  通过解析 .CSV 找到在 .CSV excel 文件中输入的附近位置
3.  在每个位置通知气泡内显示一个小链接，上面写着“导航”，当用户单击它时，打开谷歌地图应用程序并开始从用户当前位置（地理位置）将用户导航到该位置。

这是我完成此应用程序所需的唯一部分。所以再一次，任何帮助都将不胜感激。感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:27:27.073

老实说，我一直在解决这个问题。CSV 格式不是为了便于解析而制作的，即使使用复杂的 RegEx 也很难解析。

老实说，最好的做法是将其导入 FormSite 或 PHPMyAdmin，然后使用比“，”更易于解析的自定义分隔符重新导出文档。我经常使用“%%”作为字段分隔符，一切都像一个魅力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T01:58:32.027

不知道这是否有帮助，但如果有帮助，请参阅[http:](http://www.randomactsofsentience.com/2012/04/csv-handling-in-javascript.html) //www.randomactsofsentience.com/2012/04/csv-handling-in-javascript.html...

附加：除了上面链接的解决方案（我的偏好）之外，我还使用了大量堆叠的正则表达式来标记 CSV，但对于自定义错误状态进行修改并不容易......

看起来很重，但仍然只需要几毫秒：

```
function csvSplit(csv){
  csv = csv.replace(/\r\n/g,'\n')
  var rows = csv.split("\n");
  for (var i=0; i<rows.length; i++){
    var row = rows[i];
    rows[i] = new Array();
    row = row.replace(/&/g, "&amp;");
    row = row.replace(/\\\\/g, "&#92;");
    row = row.replace(/\\"/g, "&quot;");
    row = row.replace(/\\'/g, "&#39;");
    row = row.replace(/\\,/g, "&#44;");
    row = row.replace(/@/g, "&#64;");
    row = row.replace(/\?/g, "&#63;");
    row = row.replace(/"([^"]*)"/g, "@$1\?");
    while (row.match(/@([^\?]*),([^\?]*)\?/)){
      row = row.replace(/@([^\?]*),([^\?]*)\?/g, "@$1&#44;$2?");
    }
    row = row.replace(/[\?@]/g, "");
    row = row.replace(/\'([^\']*)\'/g, "@$1\?");
    while (row.match(/@([^\?]*),([^\?]*)\?/)){
      row = row.replace(/@([^\?]*),([^\?]*)\?/g, "@$1&#44;$2?");
    }
    row = row.replace(/[\?@]/g, "");
    row = row.split(",")
    for (var j=0; j<row.length; j++){
      col = row[j];
      col = col.replace(/&#63;/g, "\?");
      col = col.replace(/&#64;/g, "@");
      col = col.replace(/&#44;/g, ",");
      col = col.replace(/&#39;/g, '\'');
      col = col.replace(/&quot;/g, '\"');
      col = col.replace(/&#92;/g, '\\');
      col = col.replace(/&amp;/g, "&");
      row[j]=col;
    }
    rows[i] = row;
  }
  return rows;
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-06-15T23:22:20.877

这似乎有效。您可能想翻译日语，但使用起来非常简单： [http ://code.google.com/p/csvdatajs/](http://code.google.com/p/csvdatajs/)

# c++ - 实现锁

> ID：10058747
> 
> 赞同：4
> 
> 时间：2012-04-07T22:03:23.333
> 
> 标签：c++, multithreading, locking

我试图了解锁是如何工作的。

假设我想在 C++ 中实现一个非常简单的锁

```
class Resource{
    public:
    bool lock();
    void unlock();
    ... methods to change/read the Resource ...

    private:
    bool isLocked;
} 
```

资源的用户调用`lock()`，如果`isLocked`为真，则`lock()`返回假，资源的用户要么等待，要么做其他事情。如果`isLocked`为假，则`lock()`设置`isLocked`为真，并返回真。然后调用者可以对资源做任何他想做的事情。之后他调用`unlock()`资源设置`isLocked`为假。

但是，如果资源的两个用户`lock()`恰好同时调用呢？这种情况很少发生吗？我认为更正式地说，这涉及使`lock()`操作“原子”，尽管我不确定该词的含义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T22:15:07.453

使用旧的标准 C++，您无法实现自己的锁，因为锁变量本身处于数据竞争中。

C++11 和 C11 添加了*原子*变量，您可以将其用于此目的；例如在 C++ 中：

```
#include <atomic>

std::atomic<bool> isLocked;

bool lock() { return !isLocked.exchange(true); }

void unlock() { isLocked = false; } 
```

这里的关键是原子交换和（隐式）原子存储，它们生成特殊的硬件指令并且始终没有竞争，并且您不能用普通变量“伪造”它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-07T22:06:18.970

“原子”意味着操作不能被中断。也就是说，无论其他线程/进程的行为如何，您都可以确定该操作的语义是相同的。您是对的，您的`lock()`通话中的某些内容可能必须是原子的。大多数架构都提供了一些有用的指令，并保证了原子行为——您可能还会发现一些构建在这些操作上的库，以便在您正在编程的更高层为您提供更大的灵活性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T22:06:39.750

这并不罕见。它被称为竞争条件，是多线程代码中许多（如果不是大多数）错误的原因。

C++ 标准实际上并没有任何线程/原子性等概念，¹因此您需要依赖操作系统提供的同步原语（或者可能通过 Boost）。

* * *

[1\. 这不再适用于 C++11。]

# html - 单行滚动 HTML 列表

> ID：10058749
> 
> 赞同：0
> 
> 时间：2012-04-07T22:03:31.650
> 
> 标签：html, css

使用列表作为；

```
<ul id="scroller">
    <li><img src="../static/image/brand1.png" title="brand title"></li>
    .....
</ul> 
```

并具有css属性；

```
 ul#scroller li {
        list-style: none;
        display: inline;
    }

    ul#scroller li img{
        margin-left: 75px;
        float:left;
    }

    ul#scroller {
        overflow: scroll;
    } 
```

并且 YUI CSS 在此定义之前重置。

问题是; 我的列表项不是水平滚动，而是换行。

和平

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:24:35.603

您可以添加“空白：nowrap;” 到 ul#scroller 元素。

[http://jsfiddle.net/YMDCw/7/](http://jsfiddle.net/YMDCw/7/)

```
ul#scroller{
    white-space:nowrap;
}
ul#scroller li {
    list-style: none;
    display: inline;
}

ul#scroller li img{
    margin-left: 75px;
}

ul#scroller {
    overflow: scroll;
}
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:38:11.640

我想你想要这样的CSS？

```
ul {
    height: 150px;
    width: 300px;
    overflow: auto;
    overflow-y: hidden !important;
    overflow-x: scroll !important;
}

li {
    list-style: none;
    min-width: 800px;
}

img {
    list-style: none;
    display: inline-block;
    float: left !important;
} 
```

# css - CSS3 PIE、IE8 和边框半径

> ID：10058750
> 
> 赞同：0
> 
> 时间：2012-04-07T22:03:40.690
> 
> 标签：css

昨天我在寻找在 IE8 中获得框阴影和边框半径的方法时遇到了 www.css3pie.com。到目前为止，它帮助很大，但我绞尽脑汁想弄清楚为什么它不适用于开发的最后一部分......顶部的两个选项卡。渐变显示在非活动状态，但在应用“当前”类时保持不变。href 也在改变它应该如何。查看以下代码：

```
<div class="nav1">
        <ul>
        <li <?php if ($thisPage=="Contact Us") echo "class=\"current\""; ?>><a href="/contact.php">Contact Us</a></li>
        <li <?php if ($thisPage=="Visit Us") echo "class=\"current\""; ?>><a href="/visit-us.php">Visit Us</a></li>
        </ul>
        </div> 
```

它的风格是这样的......

```
.nav1 ul {
margin:0px; 
padding:0px;
list-style:none;
}
.nav1 ul li { 
position: relative;
font-size:12px;
float:left;
margin-right:5px;
border: 1px solid #999999;
background-color: #fafafa;
border-radius: 5px 5px 0px 0px;
background: #f7f7f7; /* Old browsers */
background: -moz-linear-gradient(top, #f7f7f7 0%, #ccc9c9 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f7f7f7), color-stop(100%,#ccc9c9)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top, #f7f7f7 0%,#ccc9c9 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top, #f7f7f7 0%,#ccc9c9 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top, #f7f7f7 0%,#ccc9c9 100%); /* IE10+ */
background: linear-gradient(top, #f7f7f7 0%,#ccc9c9 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f7f7f7', endColorstr='#ccc9c9',GradientType=0 ); /* IE6-9 */
color:#868686;
text-shadow: 1px 1px #fafafa;
padding: 6px 30px;
behavior: url(inc/PIE.htc);
}

li.current{ 
position: relative;
border-radius: 5px 5px 0px 0px;
background: #e0e0e0; /* Old browsers */
background: -moz-linear-gradient(top, #e0e0e0 0%, #bab8b8 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#e0e0e0), color-stop(100%,#bab8b8)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top, #e0e0e0 0%,#bab8b8 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top, #e0e0e0 0%,#bab8b8 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top, #e0e0e0 0%,#bab8b8 100%); /* IE10+ */
background: linear-gradient(top, #e0e0e0 0%,#bab8b8 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e0e0e0', endColorstr='#bab8b8',GradientType=0 ); /* IE6-9 */    text-shadow: 1px 1px #fafafa;
behavior: url(inc/PIE.htc); 
```

}

```
.nav1 ul li a{ 
font-size:14px;
float:left;
color:#868686;
text-decoration:none;
}
.nav1 ul li a:hover{ 
color:#666666;
font-size:14px;
float:left;
color:#000000;
text-decoration:none;
}

.nav1 ul li.current a {
    color: #000;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T17:26:45.703

由于 CSS PIE 将处理 IE 的渐变，因此您可以安全地删除`filter:`声明。这可能会有所帮助。

# jquery - JQUERY 用函数切换 X div

> ID：10058751
> 
> 赞同：-1
> 
> 时间：2012-04-07T22:03:43.823
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable

我有 X div 类排序（和 sortable(); 行为）

```
<div class="sort" id="a"></div>
<div class="sort" id="b"></div>
<div class="sort" id="c"></div>
<div class="sort" id="d"></div>
<div class="sort" id="e"></div> 
```

我想在按钮上切换他们的位置

前获得：

```
<div class="sort" id="b"></div>
<div class="sort" id="c"></div>
<div class="sort" id="e"></div>
<div class="sort" id="d"></div>
<div class="sort" id="a"></div> 
```

我必须这样做：

```
$("#sort").sortable().disableSelection();
$("#sort li:eq(3)").insertAfter($("#sort li:eq(4)"));
$("#sort li:eq(0)").insertAfter($("#sort li:eq(4)")); 
```

但是我想建立一个函数来使它与 X 元素一起工作，该函数将数组作为参数，如下所示：

```
{'a' : 4 , 'b' : 0, 'c' : 1, 'e' : 2, 'd' : 3} 
```

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:10:51.823

```
function sortElements(ELEMENTS) {
    $("#sort").sortable().disableSelection();
    $.each(ELEMENTS, function (eleID, elePOS) {
        if ($('#' + eleID).index() != elePOS) {
            $("#" + eleID).insertAfter("#sort li:eq(" + elePOS + ")");
        }
    });
    //I assume you need to re-initialize the `sortable` widget here
}

$('#my-button').on('click', function () {
    sortElements({'a' : 4 , 'b' : 0, 'c' : 1, 'e' : 2, 'd' : 3});
    return false;
}); 
```

这会传入您的元素 ID 对象和新位置以及每个元素的位置。

# 更新

我`if`在循环中添加了语句`$.each()`，检查插入元素的位置是否与当前的位置相同，如果您尝试使用它`insertAfter()`在其自身之后插入元素，则该元素只会从 DOM 中删除。

这是一个演示：http: [//jsfiddle.net/FMxZa/3/](http://jsfiddle.net/FMxZa/3/)

# ios - 复制CALayer

> ID：10058752
> 
> 赞同：1
> 
> 时间：2012-04-07T22:03:58.080
> 
> 标签：ios, pdf, uiview, calayer

我想从 UIView 创建 PDF。现在我想复制图层并将其调整为 DIN A4 页面大小。

```
CGRect A4PageRect = CGRectMake(0, 0, 595, 842);
CALayer *myLayer = [pdfView layer];
myLayer.bounds = pageRect; 
```

但是这个 cody 调整了我屏幕上可见层的大小。

如何复制图层内容以调整其大小以适合 A4 页面？

谢谢你的帮助，朱利安

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-03-06T02:27:09.597

FWIW，您可以制作一个`CALayer`通过的浅表副本：

（斯威夫特 3）

```
let tmp = NSKeyedArchiver.archivedData(withRootObject: myLayer)
let copiedCA = NSKeyedUnarchiver.unarchiveObject(with: tmp) as! CALayer 
```

（或您正在使用的任何子类。例如`CAShapeLayer`）

感谢：[https ://stackoverflow.com/a/35345819/1452758](https://stackoverflow.com/a/35345819/1452758)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-08T01:28:54.133

无法复制 CALayer。

（CoreAnimation 很难以合理的方式实现它。可能有一整棵子层树，并且它们都可能有影响其行为的委托，它们不会期望突然从层的副本中获取请求.)

我只能猜测一个更好的解决方案，因为我不了解您的确切情况。您是否有要调整大小的 PDF，或者您只是想获取任意现有图层并从中制作 PDF 文档？

如果是后者：

1.  使用[`UIGraphicsBeginPDFContextToData`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html#//apple_ref/c/func/UIGraphicsBeginPDFContextToData)或[`UIGraphicsBeginPDFContextToFile`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html#//apple_ref/c/func/UIGraphicsBeginPDFContextToFile)创建 PDF 绘图上下文
2.  调用[`UIGraphicsBeginPDFPage`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html#//apple_ref/c/func/UIGraphicsBeginPDFPage)或[`UIGraphicsBeginPDFPageWithInfo`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html#//apple_ref/c/func/UIGraphicsBeginPDFPageWithInfo)创建页面
3.  调用[`UIGraphicsGetCurrentContext`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html#//apple_ref/c/func/UIGraphicsGetCurrentContext)以获取 PDF 绘图上下文
4.  使用缩放，[`CGContextScaleCTM`](https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextScaleCTM)以便您的图层适合 PDF 页面
5.  调用[`-[CALayer renderInContext:]`](https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instm/CALayer/renderInContext%3a)以将图层绘制到 PDF 上下文中
6.  致电`UIGraphicsEndPDFContext`完成 PDF

请注意，这可能看起来很糟糕。图层是基于位图的，因此您将在 PDF 中获得位图。此外，`-[CALayer renderInContext:]`它的渲染与屏幕上的渲染并不完全相同——请参阅文档中的注释。

如果这是一个问题，您需要添加一个绕过 CALayer 的单独绘图路径。在第 5 步中，您将使用 CoreGraphics 进行自己的绘图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-26T19:47:50.580

在您的情况下，使用建议的解决方案确实更好，但为了记录，是的，您可以以某种方式复制 CALayer：使用 CAReplicatorLayer。

这是一个非常强大的 API，不需要为复制一层而构建，但它也适用。通过复制一系列图层，它可以更好地制作惊人的视觉效果。

有关更多信息，您可以查看[苹果官方文档](https://developer.apple.com/documentation/quartzcore/careplicatorlayer)，这里是摘录：

> 创建其子层（源层）的指定数量副本的层，每个副本都可能应用几何、时间和颜色转换。

这里是[John Sundell 的一个很棒的教程](https://www.swiftbysundell.com/posts/ca-gems-using-replicator-layers-in-swift)，另一个摘录：

> CAReplicatorLayer 擅长以高效的硬件加速方式绘制原始层的多个副本（因此它是“复制器”）。在绘制平铺背景、图案或其他应重复多次的东西时，它非常有用。我什至用它来实现我即将推出的开源 Swift 游戏引擎的纹理平铺功能。

最后，这[是一个很好的例子](https://vimeo.com/128046096)，说明了这个 api 可以做什么。

# javascript - 如何在 FOR 循环中创建暂停或延迟？

> ID：10058753
> 
> 赞同：20
> 
> 时间：2012-04-07T22:04:04.540
> 
> 标签：javascript, jquery, for-loop

我正在一个网站上工作，我需要在其中创建暂停或延迟。
所以请告诉我如何在`for`循环中创建暂停或延迟`javascript`或`jQuery`

这是一个测试示例

```
 var s = document.getElementById("div1");
 for (i = 0; i < 10; i++) {
     s.innerHTML = s.innerHTML + i.toString();
     //create a pause of 2 seconds.
  } 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-07T22:08:29.810

您不能在函数中使用延迟，因为在退出函数之前，您对元素所做的更改不会显示出来。

稍后使用`setTimeout`运行代码片段：

```
var s = document.getElementById("div1");
for (i = 0; i < 10; i++) {

  // create a closure to preserve the value of "i"
  (function(i){

    window.setTimeout(function(){
      s.innerHTML = s.innerHTML + i.toString();
    }, i * 2000);

  }(i));

} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-07T22:09:26.930

```
var wonderfulFunction = function(i) {
   var s = document.getElementById("div1"); //you could pass this element as a parameter as well
   i = i || 0;
   if(i < 10) {
      s.innerHTML = s.innerHTML + i.toString();

      i++;
      //create a pause of 2 seconds.
      setTimeout(function() { wonderfulFunction(i) }, 2000);          
   }
}

//first call
wonderfulFunction(); //or wonderfulFunction(0); 
```

您不能暂停 javascript 代码，整个语言都是为处理事件而设计的，我提供的解决方案让您可以延迟执行函数，但执行永远不会停止。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-07T23:10:09.397

我都试过了，但我认为这个代码更好，它是非常简单的代码。

```
var s = document.getElementById("div1");
var i = 0;
setInterval(function () {s.innerHTML = s.innerHTML + i.toString();  i++;}, 2000); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-08T01:34:35.303

如果你想在 FOR 循环中创建暂停或延迟，唯一真正的方法是

```
while (true) {
    if( new Date()-startTime >= 2000) {
        break;
    }
} 
```

startTime 是运行 while 之前的时间，但是这种方法会导致浏览器变得非常慢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-07T22:10:30.573

不可能在`for`循环中直接暂停 Javascript 函数，然后在该点恢复。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-07T22:25:08.190

你应该这样做

```
var i = 0;
setTimeout(function() {
   s.innerHTML = s.innerHTML + i.toString();
   i++;
},2000); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-07T22:28:38.943

以下代码是您可以在 JS 中执行的伪多线程示例，它大致是如何延迟循环的每次迭代的示例：

```
var counter = 0;

// A single iteration of your loop
// log the current value of counter as an example
// then wait before doing the next iteration
function printCounter() {
    console.log(counter);
    counter++;
    if (counter < 10)
        setTimeout(printCounter, 1000);
}

// Start the loop    
printCounter(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-07T22:41:46.047

虽然其他几个答案会起作用，但我发现代码不太优雅。[Frame.js](https://github.com/bishopZ/Frame.js)库正是为了解决这个问题而设计的。使用 Frame 你可以这样做：

```
var s = document.getElementById("div1");
for (i = 0; i < 10; i++) {
   Frame(2000, function(callback){ // each iteration would pause by 2 secs
      s.innerHTML = s.innerHTML + i.toString();
      callback();
   }); 
}
Frame.start(); 
```

在这种情况下，它与使用 setTimeout 的示例几乎相同，但 Frame 提供了很多优势，特别是如果您尝试执行多个或嵌套超时，或者有一个更大的 JS 应用程序需要超时工作.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-01T13:25:05.130

我正在执行一个需要访问外部对象属性的函数。所以，[Guffa](https://stackoverflow.com/users/69083/guffa)解决方案中的关闭对我不起作用。通过简单地将 setTimeout 包装在 if 语句中，我发现了一种[nicosantangelo](https://stackoverflow.com/users/437049/nicosantangelo)解决方案的变体，因此它不会永远运行。

```
 var i = 0;
    function test(){

        rootObj.arrayOfObj[i].someFunction();
        i++;
        if( i < rootObj.arrayOfObj.length ){
            setTimeout(test, 50 ); //50ms delay
        }

    }
    test(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-04-20T18:17:40.403

我发现的方法是简单地使用`setInterval()`循环来代替。这是我的代码示例：

```
var i = 0;
var inte = setInterval(() => {
    doSomething();

    if (i == 9) clearInterval(inte);
    i++;
}, 1000);

function doSomething() {
    console.log(i);
}; 
```

这从 0 循环到 9，在每次迭代之间等待 1 秒。

输出 ：

```
0 1 2 3 4 5 6 7 8 9 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-04-24T11:02:50.620

无法**暂停**循环。但是，您可以使用 setTimeout() 函数**延迟**代码片段的执行。无论如何暂停整个执行是没有多大意义的。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-05-08T12:49:08.923

我使用 do...while 循环在我的代码中延迟关闭太快的模态对话框。

```
your stuff....

var tNow = Date.now();
var dateDiff = 0;
do {
    dateDiff = Date.now() - tNow;
} while (dateDiff < 1000); //milliseconds - 2000 = 2 seconds

your stuff.... 
```

# ruby-on-rails - 路由自定义，删除动作有很多通过关联

> ID：10058758
> 
> 赞同：0
> 
> 时间：2012-04-07T22:04:33.987
> 
> 标签：ruby-on-rails, routes

我有很多通过关联。

公司通过关注有很多用户。我希望用户能够关注公司。- 我正在为用户使用设计。

我对关注公司和取消关注公司都有自定义操作。关注操作有效，但我在取消关注时遇到问题。

```
 def follow
  @firm = Firm.find(params[:id])
  @firm.users << current_user
  respond_to do |format|
    format.html { redirect_to @firm }
  end
 end

def unfollow
 @firm = Firm.find(params[:id])
 current_user.follows.find_by_firm_id(@firm.id).destroy
 respond_to do |format|
  format.html { redirect_to firms_url }
end 
```

以我的 routes.rb 结尾

```
resources :firms do
  member do
   post 'follow'
   delete 'unfollow'
  end
end 
```

在我的公司看来

```
 <%= link_to 'unfollow', unfollow_firm_path(firm), :method => 'delete' %> 
```

我收到以下错误

```
NoMethodError in FirmsController#unfollow

undefined method `follows' for nil:NilClass 
```

我的 rake routes 命令显示以下内容

```
 follow_firm POST   /firms/:id/follow(.:format)   firms#follow
  unfollow_firm DELETE /firms/:id/unfollow(.:format) firms#unfollow 
```

如果您有任何想法，我将不胜感激！

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:09:33.883

错误`undefined method 'follows' for nil:NilClass`来自：

`current_user.follows.find_by_firm_id(@firm.id).destroy`

您需要测试用户是否已登录，因此`current_user`不是`nil`.

也许？：

`current_user.follows.find_by_firm_id(@firm.id).destroy if current_user`

# haml - 索引问题，未终止的正则表达式遇到文件结尾

> ID：10058760
> 
> 赞同：0
> 
> 时间：2012-04-07T22:04:39.953
> 
> 标签：haml

我在尝试索引数据时写了这个

```
= form_tag blog_posts_path, method: :get do
%p
= text_field_tag :query, params[:query]
= submit_tag "Search", name: nil 
```

我得到了这个错误，我真的不知道如何解决它：

```
/home/marina/project/app/views/blog_posts/index.haml:15: syntax error, unexpected ')'
));}\n<p></p>\n#{
 ^
/home/marina/project/app/views/blog_posts/index.haml:15: syntax error, unexpected '<'
));}\n<p></p>\n#{
      ^
/home/marina/project/app/views/blog_posts/index.haml:15: unterminated regexp meets end of fail
/home/marina/project/app/views/blog_posts/index.haml:15: syntax error, unexpected $end, expecting keyword_end 
```

提取的源代码（大约第 15 行）：

```
12: %br
13: 
14: = form_tag blog_posts_path, method: :get do
15: %p
16: = text_field_tag :query, params[:query]
17: = submit_tag "Search", name: nil
18: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:19:19.760

是的，这似乎是一个缩进问题。您应该将 %p 缩进一次，最后两行缩进两次。

# .net - 我可以将 WcfFacility 与 WCF 测试客户端一起使用吗？

> ID：10058761
> 
> 赞同：1
> 
> 时间：2012-04-07T22:04:47.800
> 
> 标签：.net, wcf, castle-windsor, wcftestclient, wcffacility

我有一个 WCF 服务库，其中包含从 DefaultServiceHostFactory 派生的自定义 ServiceHostFactory。我无法让测试客户使用这个工厂。我只是得到“没有找到无参数构造函数”错误。

这是我的托管环境配置：

```
<serviceHostingEnvironment>
  <serviceActivations>
    <add service="TestService.WcfLibrary.TestService"
         relativeAddress="/TestService.svc"
         factory="TestService.WcfLibrary.TestServiceHostFactory, TestService.WcfLibrary, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"/>
  </serviceActivations>
</serviceHostingEnvironment> 
```

请注意，我实际上没有 .svc 文件。我正在尝试使用无文件激活。

这是我的自定义 ServiceHostFactory：

```
public class TestServiceHostFactory : DefaultServiceHostFactory
{
    public TestServiceHostFactory() : base(CreateKernel()) { }

    private static IKernel CreateKernel()
    {
        WindsorContainer container = new WindsorContainer();

        container.AddFacility<WcfFacility>();

        container.Register(Component.For<TestService>());
        container.Register(Component.For<IServiceManager>().ImplementedBy<ServiceManager>());

        return container.Kernel;
    }
} 
```

看起来这条路径永远不会执行。如何让 WCF 测试客户端使用我的自定义实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T07:02:35.333

好吧，这是可能的，但它并不漂亮......

首先，我们需要一种在程序集加载时挂接的方法，因为在这种情况下，它们不是“主”或“应用程序启动”或任何东西。AppDomain 上有一个名为[AssemblyLoaded](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyload.aspx)的有趣事件，看起来它可以解决问题，嗯，但是如何挂钩它，我认为这样做的一种方法是定义一个自定义应用程序域管理器，所以......

创建一个全新的程序集并在其中定义一个接口，该接口可以由某些客户端和[AppDomainManager](http://msdn.microsoft.com/en-us/library/system.appdomainmanager.aspx)实现，如下所示：

```
public interface IAssemblyLoaded
{
    void AssemblyLoaded();
}

public class CustomManager : AppDomainManager
{
    public override void InitializeNewDomain(AppDomainSetup appDomainInfo)
    {
        base.InitializeNewDomain(appDomainInfo);

        // Look for any classes that implement IAssemblyLoaded,
        // constuct them (will only work if they have a default constructor)
        // and call the AssemblyLoaded method
        var loaded = typeof (IAssemblyLoaded);
        AppDomain
            .CurrentDomain
            .AssemblyLoad += (s, a) =>
                                 {
                                     var handlers = a
                                         .LoadedAssembly
                                         .GetTypes()
                                         .Where(loaded.IsAssignableFrom);

                                     foreach (var h in handlers)
                                     {
                                         ((IAssemblyLoaded)
                                          Activator.CreateInstance(h))
                                             .AssemblyLoaded();
                                     }
                                 };
    }
} 
```

确保程序集已签名，然后将其添加到 GAC。假设我调用了程序集 AssemblyInitCustomDomainManager 我可以像这样添加它（我会立即返回有关它的详细信息，因为我需要它们）：

```
gacutil /i AssemblyInitCustomDomainManager.dll
gacutil /l AssemblyInitCustomDomainManager 
```

现在编辑**WcfServiceHost.exe.config**（通常位于：C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE 或 64 位系统上的 x86 版本）并在**运行时**元素中添加以下内容（有关信息，请参见[此处](http://msdn.microsoft.com/en-us/library/dd630886.aspx)此设置）：

```
<appDomainManagerType value="AssemblyInitCustomDomainManager.CustomManager" />
<appDomainManagerAssembly value="AssemblyInitCustomDomainManager, Version=1.0.0.0, Culture=neutral, PublicKeyToken=c841b3549556e52a, processorArchitecture=MSIL" /> 
```

*注意：您将需要更改至少一项（可能全部取决于您上面所说的内容）：类型名称、命名空间、程序集名称、公钥、版本号。我想你应该能够弄清楚他们在你的情况下需要什么。*

好的，这很容易，现在我们将在 Visual Studio 中创建一个新的“WCF 服务库”项目，它将为我们创建一个 app.config 和一个服务（这是你想要测试的项目类型，哦，我希望如此！）。

首先，从 app.config 中删除**system.servicemodel**部分，因为我们不希望服务主机应用程序读取它，然后删除 Service1.cs 和 IService1.cs（因为我将自己制作一点之后）。确保您引用了您之前创建的应用程序域管理器程序集，因为您需要实现该接口。

现在，创建一个新文件并粘贴以下代码（我们只是有一个简单的服务，它具有由 Castle WCF 设施托管的依赖项）：

```
using System;
using System.ServiceModel;

using AssemblyInitCustomDomainManager;

using Castle.Facilities.WcfIntegration;
using Castle.MicroKernel.Registration;
using Castle.MicroKernel.SubSystems.Configuration;
using Castle.Windsor;
using Castle.Windsor.Installer;

namespace TestWcfServiceLibrary
{
    public class AssemblyInitializedHandler : IAssemblyLoaded
    {
        // This method is called when the assembly loads so we will create the
        // windsor container and run all the installers we find
        public void AssemblyLoaded()
        {            
            new WindsorContainer().Install(FromAssembly.This());            
        }        
    }

    // This installer will set up the services
    public class ServicesInstaller : IWindsorInstaller
    {
        public void Install(IWindsorContainer container, 
                            IConfigurationStore store)
        {
            container
                .AddFacility<WcfFacility>(f => f.CloseTimeout = TimeSpan.Zero)
                .Register(Component
                              .For<ITestDependency>()
                              .ImplementedBy<TestDependency>(),
                          Component
                              .For<IService1>()
                              .ImplementedBy<Service1>()
                              .AsWcfService(new DefaultServiceModel(WcfEndpoint
                                                                        .BoundTo(new WSHttpBinding()))
                                                .AddBaseAddresses("http://localhost:9777/TestWcfServiceLibrary/Service1")
                                                .PublishMetadata(m => m.EnableHttpGet())));
        }
    }

    // This is the contract of something we want to make sure is loaded
    // by Windsor
    public interface ITestDependency
    {
        int DoSomething(int value);
    }

    public class TestDependency : ITestDependency
    {
        public int DoSomething(int value)
        {
            return value;
        }
    }

    // Regular WCF service contract
    [ServiceContract]
    public interface IService1
    {
        [OperationContract]
        string GetData(int value);
    }

    // Service implementation - notice it does not have a default 
    // constructor
    public class Service1 : IService1
    {
        private readonly ITestDependency _td;

        public Service1(ITestDependency td)
        {
            _td = td;
        }

        public string GetData(int value)
        {
            int v = _td.DoSomething(value);
            return string.Format(
                "According to our dependency you entered: {0}", v);
        }
    }
} 
```

单击运行，您将收到一条错误消息，内容为：

> WCF 服务主机找不到任何服务元数据。这可能会导致客户端应用程序运行不正常。请检查是否启用了元数据。你想离开吗？

不用担心，只需单击**no**。

测试客户端启动，但遗憾的是它没有您的服务。不用担心，只需右键单击 add service... 并输入服务的 URL（它位于代码的安装程序中 - [http://localhost:9777/TestWcfServiceLibrary/Service1](http://localhost:9777/TestWcfServiceLibrary/Service1)）。

你去 - WCF 服务托管在 WCF 测试客户端内。不信 - 测试一下，调用 GetData 操作，您应该会看到结果。

你去吧。现在，如果您问这是否是个好主意...我不知道，但它有效，我认为这是您所要求的...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T05:13:30.960

我记得在某处读过这个！[关联](http://msdn.microsoft.com/en-us/magazine/cc163289.aspx#S2)

“WcfSvcHost 的最大缺点是它仅适用于在打开主机实例之前不需要对主机实例进行编程访问或在打开后对其事件模型进行编程访问的简单场景。与使用 IIS 或 Windows 激活服务 (WAS ), 没有等效的服务主机工厂支持。因此，无法动态添加基址、配置端点、限制调用、在主机级别配置自定义行为等。我对 WCF 的经验是，除了在最简单的情况下，最终您将需要对主机实例进行编程访问，因此我不认为 WcfSvcHost 是一个成熟的、可用于生产的主机，就像我认为 WAS 或专用的自主机一样。”

# xcode - 如何在 Lion(10.7.3) 中安装 XCode 3.2.6

> ID：10058762
> 
> 赞同：2
> 
> 时间：2012-04-07T22:05:10.227
> 
> 标签：xcode, macos, osx-lion

在我的机器 Lion 10.7.3 上安装 XCode 3.2.6 时，我已经花了两天的时间，但到目前为止我还没有运气。我已经按照此处的安装说明进行操作：[在 Lion Redux 上](http://anatomicwax.tumblr.com/post/8064949186/installing-xcode-3-2-6-on-lion-redux)安装 Xcode 3.2.6 和[在 Mac OS X Lion (10.7) 中安装 Xcode 3.2.6，](http://catacombae.blogspot.co.uk/2011/07/installing-xcode-326-in-mac-os-x-lion.html)但两者都不起作用。我总是收到安装未知错误，请参阅附图。请帮忙..非常感谢。![在此处输入图像描述](../Images/49b80a44f68ea2e0a08224ce9cbcd880.png)

机器：Macbook 操作系统：Mac OS X Lion 10.7.3 安装了 XCode 4.3

```
Apr  8 17:14:27 mo-macbook Installer[326]: Set authorization level to root for session
Apr  8 17:14:28 mo-macbook Installer[326]: Will use PK session
Apr  8 17:14:28 mo-macbook Installer[326]: Starting installation:
Apr  8 17:14:28 mo-macbook Installer[326]: Configuring volume "Mac OS X"
Apr  8 17:14:28 mo-macbook Installer[326]: Preparing disk for local booted install.
Apr  8 17:14:28 mo-macbook Installer[326]: Free space on "Mac OS X": 108.39 GB (108385030144 bytes).
Apr  8 17:14:28 mo-macbook Installer[326]: Create temporary directory "/var/folders/g8/87n3y6s561x_62y3d9h7y5480000gn/T//Install.326LicomV"
Apr  8 17:14:28 mo-macbook Installer[326]: IFPKInstallElement (22 packages)
Apr  8 17:14:28 mo-macbook Installer[326]: Using authorization level of root for IFPKInstallElement
Apr  8 17:14:29 mo-macbook Installer[326]: Failed install preflight: Error Domain=PKInstallErrorDomain Code=102 "The package “iPhoneSDK4_3.pkg” is untrusted." UserInfo=0x7c375830 {PKInstallPackageIdentifier=com.apple.pkg.iPhoneSDK4_3, NSLocalizedDescription=The package “iPhoneSDK4_3.pkg” is untrusted., NSUnderlyingError=0x7c3e0d30 "The operation couldn’t be completed. CSSMERR_TP_CERT_EXPIRED", NSURL=../Packages/iPhoneSDK4_3.pkg -- file://localhost/Volumes/Xcode%20and%20iOS%20SDK/Xcode%20and%20iOS%20SDK.mpkg/}
Apr  8 17:14:29 mo-macbook Installer[326]: Install failed: The Installer encountered an error that caused the installation to fail. Contact the software manufacturer for assistance.
Apr  8 17:14:29 mo-macbook Installer[326]: IFDInstallController 7AE66E10 state = 7
Apr  8 17:14:29 mo-macbook Installer[326]: Displaying 'Install Failed' UI.
Apr  8 17:14:29 mo-macbook Installer[326]: 'Install Failed' UI displayed message:'An unknown installation error occurred.

The Installer encountered an error that caused the installation to fail. Contact the software manufacturer for assistance.'. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-06T13:14:23.577

我通过将时钟设置为 01-01-2012 解决了这个错误。

这很奇怪，但之后安装成功完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T20:11:26.727

将日期设置回 2011 年对我有用。我在日志中看到的确切错误是 IFDInstallController 7912F940 state = 7

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T08:20:59.137

最后，我得到了这个工作。此错误“**无法完成操作。CSSMERR_TP_CERT_EXPIRED** ”将我指向此站点[Fixing packages with expired signatures](http://managingosx.wordpress.com/2012/03/24/fixing-packages-with-expired-signatures/)。

脚步：

1.  使用此脚本[flatpkgfixer.py 展平光盘映像](http://dl.dropbox.com/u/8119814/flatpkgfixer.py)
2.  挂载我的光盘映像
3.  在终端执行此命令，**导出 COMMAND_LINE_INSTALL=1**
4.  并**打开“/Volumes/Xcode and iOS SDK/Xcode and iOS SDK.mpkg”**

XCode 3.2.6 在我的 Lion 10.7.3 上成功安装。干杯!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T16:31:00.653

运行软件更新。它应该提供“Apple 软件安装程序更新”。安装那个。我认为它应该解决这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-13T09:26:58.703

我通过将系统日期设置为 2011 年实现了安装它。它就像一个魅力！

# android - Android 布局 - 位置布局

> ID：10058763
> 
> 赞同：0
> 
> 时间：2012-04-07T22:05:19.887
> 
> 标签：android

我有一个具有三个子布局的 RelativeLayout。顶部布局中的客户信息（对齐父顶部），中心布局中的三个按钮和底部布局中的横幅（对齐父底部）。

我从下往上填充，以使底部横幅与底部正确对齐。

问题是让中心布局正确显示。我的顶部布局迫使中心布局向下，如果我禁用 1 或 2 个中心按钮（消失），我需要它们漂浮到布局的顶部。我可以得到我需要正确显示的变化，但不是所有的东西都放置正确。

任何帮助，将不胜感激。谢谢

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/adLayout"
    android:background="@drawable/ad_contact_background"
    android:layout_height="fill_parent"
    android:layout_width="match_parent"
    android:orientation="horizontal" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/linearLayoutAd"
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:layout_alignParentBottom="true" >

        <ImageView
            android:id="@+android:id/ad_contactAdImageView"
            android:layout_height="wrap_content" 
            android:layout_width="match_parent" />

    </LinearLayout>

    <RelativeLayout 
        xmlns:android="http://schemas.android.com/apk/res/android" 
        android:id="@+id/relativeLayoutContact"
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:layout_above="@+id/linearLayoutAd" >

        <Button
            android:id="@+id/ad_contactWebsiteButton"
            android:background="@drawable/button_black"
            android:layout_height="50dp"
            android:layout_width="match_parent"
            android:layout_marginTop="10dip"
            android:layout_marginLeft="20dip"
            android:layout_marginRight="20dip"
            android:textSize="18dip"
            android:textStyle="bold"
            android:textColor="@android:color/white" 
            android:typeface="sans" />

        <Button
            android:id="@+id/ad_contactEmailButton"
            android:background="@drawable/button_black"
            android:layout_height="50dp"
            android:layout_width="match_parent"
            android:layout_marginTop="10dip"
            android:layout_marginLeft="20dip"
            android:layout_marginRight="20dip"
            android:textSize="18dip"
            android:textStyle="bold"
            android:textColor="@android:color/white" 
            android:typeface="sans" />

        <Button
            android:id="@+id/ad_contactPhoneButton"
            android:background="@drawable/button_black"
            android:layout_height="50dp"
            android:layout_width="match_parent"
            android:layout_marginTop="10dip"
            android:layout_marginLeft="20dip"
            android:layout_marginRight="20dip"
            android:layout_marginBottom="20dip"
            android:textSize="18dip"
            android:textStyle="bold"
            android:textColor="@android:color/white" 
            android:typeface="sans" />

    </RelativeLayout>

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/linearLayoutTitle"
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:layout_above="@+id/relativeLayoutContact"
        android:layout_alignParentTop="true" >

        <TextView
            android:id="@+id/ad_contactTitleTextView"
            android:cacheColorHint="#00000000"
            android:gravity="center"
            android:layout_height="wrap_content" 
            android:layout_width="match_parent"
            android:layout_marginLeft="10dip"
            android:layout_marginRight="10dip"
            android:layout_marginTop="20dip"
            android:textColor="#000000"
            android:textSize="24dip"
            android:textStyle="bold"
            android:typeface="sans" />

        <TextView
            android:id="@+id/ad_contactAddressTextView"
            android:cacheColorHint="#00000000"
            android:gravity="center"
            android:layout_height="wrap_content" 
            android:layout_width="match_parent"
            android:layout_marginLeft="10dip"
            android:layout_marginRight="10dip"
            android:textColor="#000000"
            android:textSize="20dip"
            android:typeface="sans" />

    </LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T03:37:28.197

使用以下修改后的 xml 文件。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/adLayout"
    android:layout_width="match_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/linearLayoutTitle"
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
       android:layout_alignParentTop="true">

        <TextView
            android:id="@+id/ad_contactTitleTextView"
            android:cacheColorHint="#00000000"
            android:gravity="center"
            android:layout_height="wrap_content" 
            android:layout_width="wrap_content"
            android:layout_marginLeft="10dip"
            android:layout_marginRight="10dip"
            android:layout_marginTop="20dip"
            android:textColor="#000000"
            android:textSize="24dip"
            android:textStyle="bold"
            android:typeface="sans" />

        <TextView
            android:id="@+id/ad_contactAddressTextView"
            android:cacheColorHint="#00000000"
            android:gravity="center"
            android:layout_height="wrap_content" 
            android:layout_width="wrap_content"
            android:layout_marginLeft="10dip"
            android:layout_marginRight="10dip"
            android:textColor="#000000"
            android:textSize="20dip"
            android:typeface="sans" />

    </LinearLayout>

    <LinearLayout
        android:id="@+id/relativeLayoutContact"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/linearLayoutTitle"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/ad_contactWebsiteButton"
            android:background="@drawable/ic_launcher"
            android:layout_height="50dp"
            android:layout_width="wrap_content"
            android:layout_marginTop="10dip"
            android:layout_marginLeft="20dip"
            android:layout_marginRight="20dip"
            android:textSize="18dip"
            android:textStyle="bold"
            android:textColor="@android:color/white" 
            android:typeface="sans" />

        <Button
            android:id="@+id/ad_contactEmailButton"
            android:background="@drawable/ic_launcher"
            android:layout_height="50dp"
            android:layout_width="wrap_content"
            android:layout_marginTop="10dip"
            android:layout_marginLeft="20dip"
            android:layout_marginRight="20dip"
            android:textSize="18dip"
            android:textStyle="bold"
            android:textColor="@android:color/white" 
            android:typeface="sans" />

        <Button
            android:id="@+id/ad_contactPhoneButton"
            android:background="@drawable/ic_launcher"
            android:layout_height="50dp"
            android:layout_width="wrap_content"
            android:layout_marginTop="10dip"
            android:layout_marginLeft="20dip"
            android:layout_marginRight="20dip"
            android:layout_marginBottom="20dip"
            android:textSize="18dip"
            android:textStyle="bold"
            android:textColor="@android:color/white" 
            android:typeface="sans" />

    </LinearLayout>

    <ImageView
        android:id="@+android:id/ad_contactAdImageView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_launcher" 
        android:layout_alignParentBottom="true"/>
</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T21:12:21.867

知道了。我只需要最后渲染中心布局。

谢谢

# php - PHP Apple 增强推送通知读取错误响应

> ID：10058768
> 
> 赞同：16
> 
> 时间：2012-04-07T22:06:14.290
> 
> 标签：php, ios, push-notification, apple-push-notifications

在 PHP 中，如何使用 fread() 来检查发送增强推送通知时是否有错误响应？

我已经阅读了 Apple 文档，通过 Google 发布了一些模糊的帖子，以及关于 SO 的几个问题/答案，但这仍然非常令人困惑。

以下是我查看的内容：http: [//developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html) [从 Apple 使用 PHP iPhone 推送通知增强推送通知读取错误](https://stackoverflow.com/questions/6665921/reading-error-from-apple-enhanced-push-notification-with-php) [- 错误响应问题](https://stackoverflow.com/questions/4034926/iphone-push-notification-error-response-problem)

我将在下面回答我自己的问题，基于以下事实：（1）我发现这是一个非常令人困惑的话题，并且（2）我必须通过大量的试验和错误将信息拼凑在一起才能使其发挥作用， (3) 这篇博客文章说鼓励这样做：[https ://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/](https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/)

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-07T22:50:16.703

当您发送推送通知时，有几个问题：

*   如果出现问题，Apple 会断开您的连接，但您不知道。当您使用基本通知时，无法知道它们是否都已发送。*解决方案：*这是使用增强通知然后检查错误响应的全部要点。请注意，我们将在数据库查询中使用“ORDER BY id”，然后使用 id 作为我们在通知中发送的标识符。这样，如果出现问题，我们就可以确切地知道数据库中的哪一行导致了问题（因此我们知道 Apple 何时断开我们并停止发送通知）。然后，我们可以继续向导致问题的行之后的所有行发送推送通知，而无需重新发送到我们已经发送到的行。

*   如果一切正常，Apple 不会发回任何响应，因此这可能会导致您的脚本暂停并永远等待，而 fread() 正在等待未到来的数据。*解决方案：*需要将 stream_set_blocking 设置为 0，以便 fread 总是立即返回。请注意，这会导致 fread 在收到错误响应之前可能返回另一个小问题，但请参阅代码中的解决方法，即在所有发送完成后暂停 1/2 秒，然后再检查一次 fread .

*   您可以发送多个推送通知，其速度比返回错误响应要快得多。*解决方案：*这与上面提到的解决方法相同......在所有发送完成后暂停 1/2 秒，然后再检查一次 fread。

这是我使用 PHP 的解决方案，它解决了我遇到的所有问题。它非常基本，但可以完成工作。我已经通过一次发送几个通知以及一次发送 120,000 个通知对其进行了测试。

```
<?php
/*
 * Read Error Response when sending Apple Enhanced Push Notification
 *
 * This assumes your iOS devices have the proper code to add their device tokens
 * to the db and also the proper code to receive push notifications when sent.
 *
 */

//database
$host = "localhost";
$user = "my_db_username";
$pass = "my_db_password";
$dbname = "my_db_name";
$con = mysql_connect($host, $user, $pass);
if (!$con) {
    die('Could not connect to database: ' . mysql_error());
} else {
    mysql_select_db($dbname, $con);
}

// IMPORTANT: make sure you ORDER BY id column
$result = mysql_query("SELECT id,token FROM `device_tokens` ORDER BY id");

//Setup notification message
$body = array();
$body['aps'] = array('alert' => 'My push notification message!');
$body['aps']['notifurl'] = 'http://www.myexampledomain.com';
$body['aps']['badge'] = 1;

//Setup stream (connect to Apple Push Server)
$ctx = stream_context_create();
stream_context_set_option($ctx, 'ssl', 'passphrase', 'password_for_apns.pem_file');
stream_context_set_option($ctx, 'ssl', 'local_cert', 'apns.pem');
$fp = stream_socket_client('ssl://gateway.push.apple.com:2195', $err, $errstr, 60, STREAM_CLIENT_CONNECT, $ctx);
stream_set_blocking ($fp, 0); //This allows fread() to return right away when there are no errors. But it can also miss errors during last seconds of sending, as there is a delay before error is returned. Workaround is to pause briefly AFTER sending last notification, and then do one more fread() to see if anything else is there.

if (!$fp) {
    //ERROR
    echo "Failed to connect (stream_socket_client): $err $errstrn";
} else {
    $apple_expiry = time() + (90 * 24 * 60 * 60); //Keep push alive (waiting for delivery) for 90 days

    //Loop thru tokens from database
    while($row = mysql_fetch_array($result)) {
        $apple_identifier = $row["id"];
        $deviceToken = $row["token"];
        $payload = json_encode($body);
        //Enhanced Notification
        $msg = pack("C", 1) . pack("N", $apple_identifier) . pack("N", $apple_expiry) . pack("n", 32) . pack('H*', str_replace(' ', '', $deviceToken)) . pack("n", strlen($payload)) . $payload;
        //SEND PUSH
        fwrite($fp, $msg); 
        //We can check if an error has been returned while we are sending, but we also need to check once more after we are done sending in case there was a delay with error response.
        checkAppleErrorResponse($fp);
    }

    //Workaround to check if there were any errors during the last seconds of sending.
    usleep(500000); //Pause for half a second. Note I tested this with up to a 5 minute pause, and the error message was still available to be retrieved

    checkAppleErrorResponse($fp);

    echo 'DONE!';

    mysql_close($con);
    fclose($fp);
}

//FUNCTION to check if there is an error response from Apple
//         Returns TRUE if there was and FALSE if there was not
function checkAppleErrorResponse($fp) {

   //byte1=always 8, byte2=StatusCode, bytes3,4,5,6=identifier(rowID). Should return nothing if OK.
   $apple_error_response = fread($fp, 6);
   //NOTE: Make sure you set stream_set_blocking($fp, 0) or else fread will pause your script and wait forever when there is no response to be sent.

   if ($apple_error_response) {
        //unpack the error response (first byte 'command" should always be 8)
        $error_response = unpack('Ccommand/Cstatus_code/Nidentifier', $apple_error_response);

        if ($error_response['status_code'] == '0') {
            $error_response['status_code'] = '0-No errors encountered';
        } else if ($error_response['status_code'] == '1') {
            $error_response['status_code'] = '1-Processing error';
        } else if ($error_response['status_code'] == '2') {
            $error_response['status_code'] = '2-Missing device token';
        } else if ($error_response['status_code'] == '3') {
            $error_response['status_code'] = '3-Missing topic';
        } else if ($error_response['status_code'] == '4') {
            $error_response['status_code'] = '4-Missing payload';
        } else if ($error_response['status_code'] == '5') {
            $error_response['status_code'] = '5-Invalid token size';
        } else if ($error_response['status_code'] == '6') {
            $error_response['status_code'] = '6-Invalid topic size';
        } else if ($error_response['status_code'] == '7') {
            $error_response['status_code'] = '7-Invalid payload size';
        } else if ($error_response['status_code'] == '8') {
            $error_response['status_code'] = '8-Invalid token';
        } else if ($error_response['status_code'] == '255') {
            $error_response['status_code'] = '255-None (unknown)';
        } else {
            $error_response['status_code'] = $error_response['status_code'] . '-Not listed';
        }

        echo '<br><b>+ + + + + + ERROR</b> Response Command:<b>' . $error_response['command'] . '</b>&nbsp;&nbsp;&nbsp;Identifier:<b>' . $error_response['identifier'] . '</b>&nbsp;&nbsp;&nbsp;Status:<b>' . $error_response['status_code'] . '</b><br>';
        echo 'Identifier is the rowID (index) in the database that caused the problem, and Apple will disconnect you from server. To continue sending Push Notifications, just start at the next rowID after this Identifier.<br>';

        return true;
   }
   return false;
}
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T22:22:12.520

我不确定您的代码内容，但您应该尝试[ApnsPHP](http://code.google.com/p/apns-php/ "ApnsPHP")，它经过充分测试，工作得非常好，它能够为您处理所有可能的异常和错误。

其他选择

[https://github.com/sebastianborggrewe/PHP-Apple-Push-Notification-Server](https://github.com/sebastianborggrewe/PHP-Apple-Push-Notification-Server) https://github.com/bortuzar/PHP-Mysql---Apple-Push-Notification-Server

已经测试了 3 i 个示例中的 2 个，并且没有实施和错误管理问题。

谢谢

:)

# android - ubuntuStudio中的Android sdk17创建R.java的Buildingcache.java insread

> ID：10058771
> 
> 赞同：1
> 
> 时间：2012-04-07T22:06:19.893
> 
> 标签：android, ubuntu-11.10

嘿，我在 ubuntu 中使用带有兼容 adt 的 ubuntu Studio 和 sdk17，但是 android 项目缺少 R.java 文件我也创建了新项目，清理项目，构建它，但没有解决我的问题......

# vb.net - VB.NET - 具有多个点值的整数

> ID：10058774
> 
> 赞同：1
> 
> 时间：2012-04-07T22:06:36.173
> 
> 标签：vb.net, integer, decimal, points

我需要检查“4.1.1.1”（示例）是否大于“4.1.4”（在这种情况下为假），当“整数”中有多个小数点时，如何在 VB.Net 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:23:43.060

我不是vb专家。但也许是这样的：

**测试值**

```
dim str as string="4.1.1.1"
dim str2 as string="4.1.4" 
```

**str 大于 str2**

```
dim result as boolean=( _ 
from split in str.Split(".").Select(function(s,i) New With {s,i}) _ 
join split2 in str2.Split(".").Select(function(s,i) New With {s,i}) _ 
on split.i equals split2.i _ 
where cint(split.s)<cint(split2.s)
select 1).Any() 
```

**str2 比 str 大**

```
dim result as boolean=( _ 
from split in str.Split(".").Select(function(s,i) New With {s,i}) _ 
join split2 in str2.Split(".").Select(function(s,i) New With {s,i}) _ 
on split.i equals split2.i _ 
where cint(split.s)>cint(split2.s)
select 1).Any() 
```

# coldfusion - 使用 ColdFusion 创建 QR 码

> ID：10058780
> 
> 赞同：5
> 
> 时间：2012-04-07T22:07:12.650
> 
> 标签：coldfusion, qr-code

有什么方法可以使用纯 ColdFusion/cfscript 生成 QR 码，而不依赖外部 API 或 JavaScript？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-07T22:37:04.670

不可以。ColdFusion 无法自行生成条形码。您需要一个单独的工具或库。安装一个 java 库很容易，比如[ZXing](https://stackoverflow.com/a/4181297/104223)。然后从 CF 生成图像。或者，您可以`<cfhttp>`调用为您生成条形码图像的外部服务器，或者[使用 javascript 基本上做同样的事情](https://stackoverflow.com/a/7205459/104223)。您不需要为后两 (2) 个选项安装任何东西。但他们仍然依赖外部资源。

最重要的是，您需要的不仅仅是 ColdFusion。您不能使用外部 API 或 javascript 的原因是什么？因为没有其中任何一个，您可能都不走运。

**根据评论编辑：**

如果*唯一*的限制是必须在本地生成图像，那么您可以使用上面链接中描述的 ZXing - 或者 - 其他响应中提到的任何其他组件/库，例如[Joe 的](https://stackoverflow.com/a/10059033/104223)使用 iText 的建议（尽管也基于 ZXing ）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T08:19:50.107

其他一些外部 API

[http://cfbarbecue.riaforge.org/](http://cfbarbecue.riaforge.org/)

[http://zanstra.com/my/Barcode.html?barcode=3PTSP8827A231](http://zanstra.com/my/Barcode.html?barcode=3PTSP8827A231)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-07T22:56:28.590

Tim Cunningham 编写了一个托管在 Github 上的库，该库利用 iText 来做这件事。[https://github.com/boltz/QRToad](https://github.com/boltz/QRToad)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T15:56:22.003

如果你*真的*想，你可以查找（也许你需要购买？）二维码的编码标准，我认为这是一个 ISO 标准。然后，您可以编写一个程序，该程序将输出具有适当数量的行和列的表格，每个表格都有黑色或白色背景。不过，我不推荐这种“自己动手”的形式。基本上要做以前做过的事情需要做很多工作。

# c++ - 基数树 (Patricia Trie) 是手机通讯录的有效数据结构吗

> ID：10058783
> 
> 赞同：1
> 
> 时间：2012-04-07T22:07:28.110
> 
> 标签：c++, addressbook, trie

我一直在考虑用 C++ 实现一个通讯录。由于它是为移动应用程序开发的，地址簿应该使用尽可能少的内存，并且用户应该仍然能够快速搜索或按名称排序联系人（我知道悖论）。

经过一番研究后，我发现大多数人认为[Trie](http://en.wikipedia.org/wiki/Trie)将是满足我需求的最佳数据结构。更准确地说是[基数树](http://en.wikipedia.org/wiki/Radix_tree)（Patricia Trie）。使用这种数据结构也可以很好地实现自动完成。

是否有其他可行的解决方案，或者如果我开始使用这个想法编码可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:18:22.197

谨防小型收藏的尝试。尽管它们确实提供了良好的渐近行为，但它们在时间和空间上的隐藏常数可能太大了。

特别是，尝试往往具有较差的**缓存性能，这应该是小型集合的主要关注点**。

假设您的数据相对较小 [<10,000 个条目]，a`std::vector`可以提供良好的缓存性能，这可能比大小因素影响更大。因此，实际上，即使它的搜索时间也比 trie 或 std::set 渐进地高 - 它可能比两者都好，这要归功于良好的缓存行为。

如果您还可以使用[二进制搜索](http://en.wikipedia.org/wiki/Binary_search_algorithm)`vector`来维护排序- 您可以从对数搜索时间和良好的缓存行为中受益。

(*)此答案假设将部署应用程序的硬件具有[CPU-Cache](http://en.wikipedia.org/wiki/CPU_cache)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:11:55.593

尝试是最好的，因为它们提供快速搜索、插入和删除。

# haskell - 具有边缘信息的 Haskell 树

> ID：10058789
> 
> 赞同：1
> 
> 时间：2012-04-07T22:08:30.463
> 
> 标签：haskell, tree

Haskell 库中是否存在这种数据结构？我做了一些搜索，但找不到任何有用的东西。我想使用现有类型而不是定义我自己的类型——它似乎应该存在。

```
data MyTree e n = Node { rootLabel :: n
                       , subForest :: Map e (MyTree e n)
                       } 
```

这个想法是它与 Data.Tree 非常相似，但边可以像节点一样保存信息。

如果你有一条穿过树的路径（[e] 类型），你可以在 O(log(n)) 中找到 rootLabel（n 类型）。据我所知，您不能使用 Data.Tree 执行此操作，因为您必须扫描每个节点的子节点以查找它是否是路径前进到的节点。这是因为 Data.Tree 的 subForest 的类型是 [Tree a]。

特别是，我对公开具有类似于以下类型的函数的实现感兴趣：

```
getNextLevel :: e -> MyTree e n -> MyTree e n 
```

这将在树中更深一层，给定一个遍历的边缘。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T23:53:28.870

这种数据类型看起来很像一个 trie，在 Hackage 上有很多可用的包。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-07T23:09:39.627

您始终可以使用图形库，并确保自己将其保留为树。

# java - 以自定义类的对象作为标记的解析器

> ID：10058795
> 
> 赞同：0
> 
> 时间：2012-04-07T22:09:47.843
> 
> 标签：java, parsing

寻找 java 解析器生成器，它接受实现 Comparable 接口（或者可能是一些特定于解析器的接口）的自定义类的对象作为结果解析器中的输入标记。ANTLR 似乎过于面向字符流。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:57:34.393

通常我使用[JavaCC](http://javacc.java.net/)。它非常简单，你可以生产你想要的东西。

在这里你可以找到一个简单的[教程](http://www.engr.mun.ca/~theo/JavaCC-Tutorial/javacc-tutorial.pdf)。

# model-view-controller - 在 Rails 中的相关模型的视图中显示字段

> ID：10058798
> 
> 赞同：0
> 
> 时间：2012-04-07T22:09:58.847
> 
> 标签：model-view-controller, ruby-on-rails-3.1, views, models

我有三个模型，Employee、Assignment 和 Store。

员工通过分配有很多商店，商店通过分配有很多员工。（作业通过外键将 Employee 和 Store 链接在一起）

员工目前只能有一个商店分配。

我试图在员工的索引视图中做的是显示员工当前分配的商店名称（名称是商店模型中的一个字段）。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:33:01.347

假设您的关系是以通常的方式设置的，请使用[`includes`](http://guides.rubyonrails.org/active_record_querying.html#eager-loading-multiple-associations)预先加载相关记录：

```
@employees = Employee.includes( :stores => :employees ).all 
```

然后在您看来，您将可以访问`@employees.stores[n].name`（`.stores`是一个集合，因为您说 Employee `has_many :stores, ...`）。

# c++ - 使用 OpenGL 时的 Qt CPU 使用率

> ID：10058808
> 
> 赞同：0
> 
> 时间：2012-04-07T22:10:54.680
> 
> 标签：c++, qt, opengl, cpu-usage

我通过使用 GQLWidget 的两个使用 OpenGL 的应用程序验证了这一点。如果屏幕更新非常频繁，比如 30 fps，和/或分辨率很高，则其中一个内核的 CPU 使用率会飙升。我正在寻找有关如何解决此问题和/或验证它是否也发生在 Windows 上的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T22:54:37.590

根据我的经验，QGLWidget 本身是一个非常有效的 GL 和窗口系统的瘦包装器；如果您使用它的 CPU 使用率很高，那么您很可能使用任何其他实现 OpenGL 应用程序的方式也有很高的 CPU 使用率。

如果您使用 OpenGL 的 CPU 使用率很高，则可能是：

*   您正在依赖软件 OpenGL 实现（即 Mesa）；例如，如果您不安装任何图形设备驱动程序，Debian 会这样做。
*   您正在使用老式即时模式 OpenGL：glBegin,...vertices...,glEnd。改为进入 VBO。

您提到显示分辨率作为一个因素的事实表明了前一个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T03:12:20.163

您需要获取任何分析器，分析您的代码并查看瓶颈在哪里。由于您的程序会占用 CPU 资源（而不是 GPU），因此这应该相当容易。据我所知，“AQTime 7 Standard”（windows）目前是免费提供的。或者您可以使用 gprof - 取决于您的工具包/平台。

一种非常可能的情况（除了软件 OpenGL 回退）是您过于频繁地使用动态内存分配或运行调试构建。如果每帧有 100000+ 个多边形，立即模式可能会成为问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T14:17:39.840

我见过一些 GL 实现在最小化主机 CPU 使用率方面很糟糕。在很多情况下，CPU 会在 GPU 绘制时忙于等待。通常，只需在卡片设置中打开垂直同步，您的应用就会减少绘制频率，但仍会占用同样多的 CPU。不幸的是，您自己对此无能为力，除了限制您的应用程序绘制的频率。

# hadoop - HBase 中过滤查询的性能？

> ID：10058810
> 
> 赞同：0
> 
> 时间：2012-04-07T22:11:40.340
> 
> 标签：hadoop, hbase

我正在寻找满足以下需求的数据存储：-

1.  分布式，因为我们有大量数据要查询（以 TB 为单位）
2.  写入密集型数据存储。数据将从服务中生成，我们希望存储数据以对其进行分析。
3.  我们希望分析查询相当快（几分钟而不是几小时）
4.  我们的大多数查询将属于“选择、过滤、聚合、排序”类型。
5.  Schema 经常变化，因为我们存储的内容会根据系统不断变化的需求而变化
6.  我们存储的部分数据也可能用于其他目的的纯大规模 map/reduce 作业。

键值存储是可扩展的，但不支持我们的查询要求。

Map/Reduce 作业是可扩展的并且可以执行查询，但我认为它不会满足我们的查询延迟要求。

RDBMS（如 MySQL）将满足我们的查询需求，但它会迫使我们有一个固定的模式。我们可以对其进行扩展，但随后我们必须进行共享等。

像 Vertica 这样的商业解决方案似乎可以解决我们所有的问题，但如果可以的话，我会避免使用商业解决方案。

由于底层的 HDFS，HBase 似乎是一个与 Hadoop 一样可扩展的系统，并且似乎具有执行过滤器和聚合的设施，但我不确定 HBase 中过滤器查询的性能。

目前 HBase 不支持二级索引。这让我想知道 HBase 是否是对任意列进行过滤的正确选择。根据文档，对行 ID 和列族进行过滤比仅对列限定符进行过滤要快。但是，我还读到，在 RowId 和 Column 系列上使用 Bloom Filter 索引会显着增加 Bloom 过滤器的大小，并使此选项实际上不可行。

我无法在网上找到很多关于 HBase 中过滤器查询性能的数据。希望我能在这里找到更多信息。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:44:56.147

试试 apache cassandra，它很好地支持二级索引。来到 hbase 布隆过滤器，请通过这个链接，它根据模式描述了布隆的多个选项，[Hbase 布隆过滤器](http://www.quora.com/How-are-bloom-filters-used-in-HBase)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-31T14:03:52.317

您可能正在寻找类似[Postgres-XL](https://www.postgres-xl.org/) 或[相关](https://fr.slideshare.net/DavidPortnoy/comparison-of-mpp-data-warehouse-platforms)平台的 MPP 解决方案。

# xcode - 仅播放 youtube 链接声音而不在 Xcode 中显示视频

> ID：10058812
> 
> 赞同：3
> 
> 时间：2012-04-07T22:11:58.780
> 
> 标签：xcode, parsing, xcode4, youtube

我正在用 Xcode 编写一个应用程序。现在我想播放来自 youtube 链接的音乐而不显示视频！！我只想播放视频的声音。所以你能帮我写代码吗？现在我只在表格视图中显示我网站上的音乐列表并显示链接。但无法插入 youtube 功能！！

提前致谢。

# javascript - 从 fs.readFile 获取数据

> ID：10058814
> 
> 赞同：335
> 
> 时间：2012-04-07T22:12:09.567
> 
> 标签：javascript, node.js

```
var content;
fs.readFile('./Index.html', function read(err, data) {
    if (err) {
        throw err;
    }
    content = data;
});
console.log(content); 
```

日志`undefined`，为什么？

* * *

## 回答 #1

> 赞同：381
> 
> 时间：2012-04-07T22:25:00.973

详细说明@Raynos 所说的，您定义的函数是异步回调。它不会立即执行，而是在文件加载完成时执行。当您调用 readFile 时，立即返回控制并执行下一行代码。所以当你调用console.log的时候，你的回调还没有被调用，这个内容还没有被设置。欢迎来到异步编程。

示例方法

```
const fs = require('fs');
// First I want to read the file
fs.readFile('./Index.html', function read(err, data) {
    if (err) {
        throw err;
    }
    const content = data;

    // Invoke the next step here however you like
    console.log(content);   // Put all of the code here (not the best solution)
    processFile(content);   // Or put the next step in a function and invoke it
});

function processFile(content) {
    console.log(content);
} 
```

或者更好的是，正如 Raynos 示例所示，将您的调用包装在一个函数中并传入您自己的回调。（显然这是更好的做法）我认为养成将异步调用包装在接受回调的函数中的习惯将为您节省很多麻烦和混乱的代码。

```
function doSomething (callback) {
    // any async callback invokes callback with response
}

doSomething (function doSomethingAfter(err, result) {
    // process the async result
}); 
```

* * *

## 回答 #2

> 赞同：292
> 
> 时间：2012-12-29T04:15:49.920

实际上有一个同步功能：

[http://nodejs.org/api/fs.html#fs_fs_readfilesync_filename_encoding](http://nodejs.org/api/fs.html#fs_fs_readfilesync_filename_encoding)

# *异步*

`fs.readFile(filename, [encoding], [callback])`

*异步读取文件的全部内容。例子：*

```
fs.readFile('/etc/passwd', function (err, data) {
  if (err) throw err;
  console.log(data);
}); 
```

*回调传递了两个参数 (err, data)，其中 data 是文件的内容。*

*如果未指定编码，则返回原始缓冲区。*

* * *

# 同步

`fs.readFileSync(filename, [encoding])`

*fs.readFile 的同步版本。返回名为 filename 的文件的内容。*

*如果指定了编码，则此函数返回一个字符串。否则它返回一个缓冲区。*

```
var text = fs.readFileSync('test.md','utf8')
console.log (text) 
```

* * *

## 回答 #3

> 赞同：124
> 
> 时间：2012-04-07T22:36:25.630

```
function readContent(callback) {
    fs.readFile("./Index.html", function (err, content) {
        if (err) return callback(err)
        callback(null, content)
    })
}

readContent(function (err, content) {
    console.log(content)
}) 
```

* * *

## 回答 #4

> 赞同：72
> 
> 时间：2016-05-30T02:28:35.153

# 在 ES7 中使用 Promise

## 与 mz/fs 异步使用

该[`mz`](https://www.npmjs.com/package/mz)模块提供了核心节点库的承诺版本。使用它们很简单。首先安装库...

```
npm install mz 
```

然后...

```
const fs = require('mz/fs');
fs.readFile('./Index.html').then(contents => console.log(contents))
  .catch(err => console.error(err)); 
```

或者，您可以在异步函数中编写它们：

```
async function myReadfile () {
  try {
    const file = await fs.readFile('./Index.html');
  }
  catch (err) { console.error( err ) }
}; 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2019-01-08T12:52:33.693

这条线会工作，

```
const content = fs.readFileSync('./Index.html', 'utf8');
console.log(content); 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2015-06-01T07:31:41.730

```
var data = fs.readFileSync('tmp/reltioconfig.json','utf8'); 
```

使用它来同步调用文件，而不将其显示输出编码为缓冲区。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2018-08-23T21:25:42.953

```
const fs = require('fs')
function readDemo1(file1) {
    return new Promise(function (resolve, reject) {
        fs.readFile(file1, 'utf8', function (err, dataDemo1) {
            if (err)
                reject(err);
            else
                resolve(dataDemo1);
        });
    });
}
async function copyFile() {

    try {
        let dataDemo1 = await readDemo1('url')
        dataDemo1 += '\n' +  await readDemo1('url')

        await writeDemo2(dataDemo1)
        console.log(dataDemo1)
    } catch (error) {
        console.error(error);
    }
}
copyFile();

function writeDemo2(dataDemo1) {
    return new Promise(function(resolve, reject) {
      fs.writeFile('text.txt', dataDemo1, 'utf8', function(err) {
        if (err)
          reject(err);
        else
          resolve("Promise Success!");
      });
    });
  } 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2018-09-19T18:37:15.793

使用内置的 promisify 库（Node 8+）使这些旧的回调函数更加优雅。

```
const fs = require('fs');
const util = require('util');

const readFile = util.promisify(fs.readFile);

async function doStuff() {
  try {
    const content = await readFile(filePath, 'utf8');
    console.log(content);
  } catch (e) {
    console.error(e);
  }
} 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2014-04-11T21:23:49.490

如前所述，`fs.readFile`是一个异步动作。也就是说，当你告诉node读取一个文件的时候，需要考虑到它会花费一些时间，同时node会继续运行下面的代码。在您的情况下，它是：`console.log(content);`。

这就像发送您的部分代码进行长途旅行（例如读取大文件）。

看看我写的评论：

```
var content;

// node, go fetch this file. when you come back, please run this "read" callback function
fs.readFile('./Index.html', function read(err, data) {
    if (err) {
        throw err;
    }
    content = data;
});

// in the meantime, please continue and run this console.log
console.log(content); 
```

这就是为什么`content`当你记录它时它仍然是空的。节点尚未检索到文件的内容。

这可以通过`console.log(content)`在回调函数内部移动来解决，就在`content = data;`. 这样，当节点完成读取文件并`content`获取值后，您将看到日志。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2016-04-16T07:50:33.097

同步和异步文件读取方式：

```
//fs module to read file in sync and async way

var fs = require('fs'),
    filePath = './sample_files/sample_css.css';

// this for async way
/*fs.readFile(filePath, 'utf8', function (err, data) {
    if (err) throw err;
    console.log(data);
});*/

//this is sync way
var css = fs.readFileSync(filePath, 'utf8');
console.log(css); 
```

节点作弊可在[read_file 获得](https://github.com/zishon89us/node-cheat/blob/master/files/read_file.js)。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-10-23T07:28:03.070

```
var fs = require('fs');
var path = (process.cwd()+"\\text.txt");

fs.readFile(path , function(err,data)
{
    if(err)
        console.log(err)
    else
        console.log(data.toString());
}); 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2018-08-02T09:49:48.910

```
var content;
fs.readFile('./Index.html', function read(err, data) {
    if (err) {
        throw err;
    }
    content = data;
});
console.log(content); 
```

这只是因为节点是异步的，它不会等待读取函数，并且一旦程序启动它就会将值控制台为未定义，这实际上是正确的，因为没有为内容变量分配值。为了处理我们可以使用 Promise、生成器等。我们可以通过这种方式使用 Promise。

```
new Promise((resolve,reject)=>{
    fs.readFile('./index.html','utf-8',(err, data)=>{
        if (err) {
            reject(err); // in the case of error, control flow goes to the catch block with the error occured.
        }
        else{
            resolve(data);  // in the case of success, control flow goes to the then block with the content of the file.
        }
    });
})
.then((data)=>{
    console.log(data); // use your content of the file here (in this then).    
})
.catch((err)=>{
    throw err; //  handle error here.
}) 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2019-09-16T07:52:10.553

以下是适用于`async`包装或承诺`then`链的功能

```
const readFileAsync =  async (path) => fs.readFileSync(path, 'utf8'); 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2021-02-23T08:17:13.687

```
var path = "index.html"

const readFileAsync = fs.readFileSync(path, 'utf8');
// console.log(readFileAsync) 
```

为我使用简单`readFileSync`的作品。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-07-17T13:35:06.500

你可以通过阅读文件

```
var readMyFile = function(path, cb) {
      fs.readFile(path, 'utf8', function(err, content) {
        if (err) return cb(err, null);
        cb(null, content);
      });
    }; 
```

添加你可以写入文件，

```
var createMyFile = (path, data, cb) => {
  fs.writeFile(path, data, function(err) {
    if (err) return console.error(err);
    cb();
  });
}; 
```

甚至连在一起

```
var readFileAndConvertToSentence = function(path, callback) {
  readMyFile(path, function(err, content) {
    if (err) {
      callback(err, null);
    } else {
      var sentence = content.split('\n').join(' ');
      callback(null, sentence);
    }
  });
}; 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-08-17T07:51:22.893

粗略地说，您正在处理本质上是异步的 node.js。

当我们谈论异步时，我们谈论的是在处理其他事情的同时做或处理信息或数据。不是平行的同义词，请注意。

你的代码：

```
var content;
fs.readFile('./Index.html', function read(err, data) {
    if (err) {
        throw err;
    }
    content = data;
});
console.log(content); 
```

对于您的示例，它基本上首先执行 console.log 部分，因此变量“内容”未定义。

如果您真的想要输出，请执行以下操作：

```
var content;
fs.readFile('./Index.html', function read(err, data) {
    if (err) {
        throw err;
    }
    content = data;
    console.log(content);
}); 
```

这是异步的。这将很难习惯，但它就是这样。同样，这是对异步是什么的粗略但快速的解释。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-07-20T00:42:14.040

我喜欢使用[fs-extra](https://github.com/jprichardson/node-fs-extra)，因为所有功能都是承诺的，开箱即用，因此您可以使用`await`. 因此，您的代码可能如下所示：

```
(async () => {
   try {
      const content = await fs.readFile('./Index.html');
      console.log(content);
   } catch (err) {
      console.error(err);
   }
})(); 
```

# ruby-on-rails - 使用 link_to 在表单中传递对象以创建操作

> ID：10058821
> 
> 赞同：0
> 
> 时间：2012-04-07T22:14:01.480
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想换掉：

```
 <%= button_tag "Create" , :class => "round" %> 
```

为了

```
 <%= link_to trips_path(@trip),  :class => "round", :method => :post do %>
    <div id="createtrip_button_newtrip">
      Create
    </div>
  <% end %> 
```

在表格中

```
<%= form_for @trip, :html =>{ :multipart => true} do |f| %>

  <div class="field">
    <%= f.label :name %><br/>
    <%= f.text_field :name  %>
  </div>
  <div id="description_container_newtrip">
    <%= f.label :description %><br/>
    <%= f.text_area :description %>
  </div>
  <div class="field">
    <%= f.label :location %><br/>
    <%= f.text_field :location %>
  </div>

  <div class="field">
    <%= f.label :start_date, "Start Date:" %><br/>
    <%= f.date_select :start_date, :order => [:month, :day, :year]   %>
  </div>
  <div class="field">
    <%= f.label :end_date, "End Date:" %><br/>
    <%= f.date_select :end_date, :order => [:month, :day, :year] %>
  </div>
  <div class="field">
    <%= f.hidden_field :user_id %>
  </div>
  <div class="field">
    <%= f.hidden_field :traveldeal_id %>
  </div>

  <%= #button_tag "Create", :class => "round" %>

  <%= link_to trips_path(@trip),  :class => "round", :method => :post do %>
    <div id="createtrip_button_newtrip">
      Create
    </div>
  <% end %>

<% end %> 
```

link_to 在正确的控制器中调用正确的操作，但我的表单没有保存。这是方法：

```
 def create
    @trip = Trip.new(params[:trip])
    if @trip.save
      redirect_to root_path
    else
      redirect_to login_path
    end
  end 
```

我不断被重定向到 login_path。我认为我的问题是我没有将@trip 的参数发送到控制器。

有小费吗？

编辑：

这是我的开发日志中的参数哈希：

`Started POST "/trips" for 127.0.0.1 at 2012-04-07 15:23:37 -0700 Processing by TripsController#create as HTML Parameters: {"authenticity_token"=>"+D2icFw2pz6qwYVaeXoWg5MOJg+Sks5/ckN0lVn1r4o="} [1m[36m (0.1ms)[0m [1mbegin transaction[0m [1m[35m (0.0ms)[0m rollback transaction Redirected to http://localhost:3000/login Completed 302 Found in 2ms (ActiveRecord: 0.1ms)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T22:25:49.033

我认为问题在于您`link_to`不会影响表格。你可以用一些 javascript 来解决这个问题：

```
$(".submit_link").click(function(){
  var link = $(this);
  var form = link.closest("form");
  form.submit();
  return false;
}); 
```

然后将课程添加`submit_link`到您的链接中。

如果您不想要 javascript，请使用`submit_tag`，并使用 CSS 设置样式。有关走这条路线的一些提示，请参见此处：[http ://cssbutton.com/forms/](http://cssbutton.com/forms/)

# vim - Vim 中的菜单可以“动态”吗？

> ID：10058827
> 
> 赞同：0
> 
> 时间：2012-04-07T22:15:21.567
> 
> 标签：vim

即显示一个值（比方说，就本例而言，`set tabstop?`... `8`），但是当该值更改以显示更改后的值时？

我正在玩 Vim，看看我是否可以设置一个菜单来显示一些我更常用的设置以节省`set setting?`......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T15:05:35.743

我还发现将设置值放入菜单有点不寻常（菜单项通常与通过选择它触发的操作相关联），并且还建议使用`'statusline'`（对于您希望并行查看的设置）对于每个打开的缓冲区）或`'titlestring'`（对于您只需要当前缓冲区的设置）。

您可以使用`:menu`and`:unmenu`命令动态创建和更新菜单项。然而，与上述机制不同的是，Vim 不会自动触发更新；您必须自己`:autocmd`在适当的事件（例如`CursorHold`）上使用 s 来执行此操作。

# testing - 如何测试 Backbone 视图事件是否将项目添加到集合中？

> ID：10058830
> 
> 赞同：1
> 
> 时间：2012-04-07T22:15:38.390
> 
> 标签：testing, backbone.js, coffeescript, bdd, jasmine

我正在尝试在以下主干视图上指定单击事件处理程序：

```
class ItemView extends Backbone.View
  events:
    "click": "addToCurrentlyFocusedList"

  addToCurrentlyFocusedList: (e) =>
    window.currentlyFocusedList.add @model 
```

这就是我所拥有的：

```
describe "ItemView", ->
  beforeEach ->
    @item = new Backbone.Model
      id: 1
      name: "Item 1"
    @view = new ItemView model: @item

  describe "when clicked", ->
    it "adds the item to the currently focused list", ->
      window.currentlyFocusedList = sinon.stub()
      window.currentlyFocusedList.add = sinon.stub()
      @view.$el.trigger "click"
      expect(window.currentlyFocusedList.add).toHaveBeenCalledWith @item 
```

这行得通，但由于某种原因它困扰着我。也许感觉太像我在测试实现了。

我可以看到的一个可能的改进是将 click 事件处理程序、规范和 移动`currentlyFocusedList`到一个名为的新视图中`AppView`：

```
describe "AppView", ->
  beforeEach ->
    @view = new AppView

  it "adds a clicked item to the currently focused list", ->
    $clickedItem = @view.$(".item:first")
    $clickedItem.trigger "click"
    expect(@view.currentlyFocusedList.pluck('id')).toInclude $clickedItem.attr('data-id') 
```

很好，这也消除了`window`污染。它还测试该项目是否确实已添加到集合中。除此之外，移动事件处理程序和规范`AppView`是否比我的第一种方法更好？有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:40:00.247

我会用一个虚拟集合将 window.currentlyFocusedList 存根，并测试它是否被添加到那里。这些方面的东西：

```
beforeEach ->
  @collection = new Backbone.Collection()
  spyOn(window, 'currentlyFocusedList').andReturn @collection

it "adds the item to the collection", ->
  @view.$el.click()
  expect(@collection).toInclude @item 
```

这将测试您的代码*实际执行*的操作；将项目添加到集合中的代码如何影响视图存在于其他地方，应该在其他地方进行测试。

# php - 如何从字段名称和列中检索数据以生成图形

> ID：10058836
> 
> 赞同：0
> 
> 时间：2012-04-07T22:16:41.997
> 
> 标签：php, mysql

所以下面的代码是我用来尝试使用 pchart 生成图形的代码。我已经能够生成一些图表。目前的图表看起来像这样：[http://befoz.netau.net/charts.php](http://befoz.netau.net/charts.php)当它应该看起来像[http://befoz.netau.net/chart2.php](http://befoz.netau.net/chart2.php)第二个图表是基于我手动的值进入。我想要做的是从 mysql 数据库中检索数据而无需手动输入数据，以便动态生成图表。

这是我的代码。我不确定是查询还是不正确的数组导致图表不生成响应。

```
<?php    
/* CAT:Bar Chart */ 

/* pChart library inclusions */ 
include("pchart/class/pData.class.php"); 
include("pchart/class/pDraw.class.php");
include("pchart/class/pImage.class.php"); 

/* Create and populate the pData object */ 
$myData = new pData();   
$myData->addPoints(array($Yes,$Result)); 
$myData->addPoints(array($No,$Result));
$myData->addPoints(array($Undecided,$Result));
$myData->setAxisName(0,"Number of Responses"); 
$myData->addPoints(array("Yes","No","Undecided"),"Types of Responses"); 
$myData->setSerieDescription("Types of Responses","Types of Responses"); 
$myData->setAbscissa("Types of Responses"); 
$myData->setAbscissaName("Types of Responses"); 

/* Connect to the MySQL database */

$db = mysql_connect("host", "user", "pass");
mysql_select_db("thedatabase",$db);

/* Build the query that will returns the data to graph */

$Requete = "SELECT `Do you have an interest in Green IT` FROM `replies`";

$Result  = mysql_query($Requete,$db);
$Yes=""; $No=""; $Undecided="";
while($row = mysql_fetch_array($Result))
{

/* Push the results of the query in an array */
$Yes[]   = $row["Yes"];
$No[] = $row["No"];
$Undecided[] = $row["Undecided"];
}

/* Create the pChart object */ 
$myPicture = new pImage(500,500,$myData); 
$myPicture->drawGradientArea(0,0,500,500,DIRECTION_VERTICAL,array("StartR"=>240,"StartG"=>240,"StartB"=>240,"EndR"=>180,"EndG"=>180,"EndB"=>180,"Alpha"=>100)); 
$myPicture->drawGradientArea(0,0,500,500,DIRECTION_HORIZONTAL,array("StartR"=>240,"StartG"=>240,"StartB"=>240,"EndR"=>180,"EndG"=>180,"EndB"=>180,"Alpha"=>20)); 
$myPicture->setFontProperties(array("FontName"=>"pchart/fonts/pf_arma_five.ttf","FontSize"=>6)); 

/* Draw the chart scale */  
$myPicture->setGraphArea(100,30,480,480); 
$myPicture->drawScale(array("CycleBackground"=>TRUE,"DrawSubTicks"=>TRUE,"GridR"=>0,"GridG"=>0,"GridB"=>0,"GridAlpha"=>10,"Pos"=>SCALE_POS_TOPBOTTOM)); 

/* Turn on shadow computing */  
$myPicture->setShadow(TRUE,array("X"=>1,"Y"=>1,"R"=>0,"G"=>0,"B"=>0,"Alpha"=>10)); 

/* Create the per bar palette */ 
$Palette = array("0"=>array("R"=>188,"G"=>224,"B"=>46,"Alpha"=>100), 
              "1"=>array("R"=>224,"G"=>100,"B"=>46,"Alpha"=>100), 
              "2"=>array("R"=>224,"G"=>214,"B"=>46,"Alpha"=>100), 
              "3"=>array("R"=>46,"G"=>151,"B"=>224,"Alpha"=>100), 
              "4"=>array("R"=>176,"G"=>46,"B"=>224,"Alpha"=>100), 
              "5"=>array("R"=>224,"G"=>46,"B"=>117,"Alpha"=>100), 
              "6"=>array("R"=>92,"G"=>224,"B"=>46,"Alpha"=>100), 
              "7"=>array("R"=>224,"G"=>176,"B"=>46,"Alpha"=>100)); 

 /* Draw the chart */  
 $myPicture->drawBarChart(array("DisplayPos"=>LABEL_POS_INSIDE,"DisplayValues"=>TRUE,"Rounded"=>TRUE,"Surrounding"=>30,"OverrideColors"=>$Palette)); 

/* Write the legend */  
$myPicture->drawLegend(570,215,array("Style"=>LEGEND_NOBORDER,"Mode"=>LEGEND_HORIZONTAL)); 

/* Render the picture (choose the best way) */ 
$myPicture->autoOutput("pictures/example.drawBarChart.palette.png"); 
?> 
```

所以我的结构在 php my admin 中看起来像这样

```
ROWS Do you have an interest in Green IT
9    No
3    Undecided
16   Yes

CREATE TABLE `replies` (
`ID` INTEGER NOT NULL AUTO_INCREMENT, 
`Do you have an interest in Green IT` VARCHAR(50), 
`Do you think Green IT is a good a thing` VARCHAR(50), 
`Would you welcome Green IT if it helped the environment` VARCHAR(255),
`Would you welcome Green IT if you saved money` VARCHAR(255), 
`Incentive for welcoming Green IT` VARCHAR(50),
`Is UEL doing enough to implement Green IT` VARCHAR(255), 
`Do you like Green IT Modules` VARCHAR(50),
`Your rough monthly cost on travel to UEL` VARCHAR(255), 
`Additional comments` VARCHAR(50),
`Should there be more green modules at UEL` VARCHAR(255), 
`What Year of Study Are you In` VARCHAR(50),
`If you did not fill in the quesionnaire, why not` VARCHAR(255), 
PRIMARY KEY (`ID`)
) ENGINE=myisam DEFAULT CHARSET=utf8; 
```

我哪里错了？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T23:50:53.697

假设每个受访者有一条记录，查询应该是这样的 -

```
SELECT `Do you have an interest in Green IT`, COUNT(*) AS num
FROM replies
GROUP BY `Do you have an interest in Green IT` 
```

然后可以将此查询返回的每一行添加为数据集中的点。正如其他人指出的那样，您需要先运行查询才能将数据传递给图表类 -

```
<?php    
/* CAT:Bar Chart */ 

/* pChart library inclusions */ 
include("pchart/class/pData.class.php"); 
include("pchart/class/pDraw.class.php");
include("pchart/class/pImage.class.php"); 

/* Create and populate the pData object */ 
$myData = new pData();   
$myData->setAxisName(0,"Number of Responses"); 
$myData->setSerieDescription("Types of Responses","Types of Responses"); 
$myData->setAbscissa("Types of Responses"); 
$myData->setAbscissaName("Types of Responses"); 

/* Connect to the MySQL database */

$db = mysql_connect("host", "user", "pass");
mysql_select_db("thedatabase",$db);

/* Build the query that will returns the data to graph */

$Requete = "SELECT `Do you have an interest in Green IT` AS resp, COUNT(*) AS num FROM replies GROUP BY resp";

$Result  = mysql_query($Requete,$db);

while($row = mysql_fetch_array($Result))
{
    $myData->addPoints(array($row['resp'], $row['num'])); 
} 
```

我不知道这个特定的图表应用程序是如何工作的，但这应该会给你一些想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T23:59:19.193

您试图在从数据库中提取数据*之前*将数据传递给 addPoints 方法。看来您也有点奇怪地使用了这些数据。您正在使用该行中的潜在值作为列名。您需要使用类似@nnichols 的帖子。

你想传递什么作为`addPoints`方法中的第二个选项 - 你正在传递数据库资源，但我觉得奇怪的是，当它还要求特定数字时，图表应用程序需要它 - 它是你想要的总行数通过？

我还建议重命名表中的列，坚持使用名称`has_interest_in_green_it`而不是`Do you have an interest in Green IT`.

就在使用它之前获取数据而言，您需要以这种方式使用它：

```
<?php    
/* CAT:Bar Chart */ 

/* pChart library inclusions */ 
include("pchart/class/pData.class.php"); 
include("pchart/class/pDraw.class.php");
include("pchart/class/pImage.class.php");

/* Connect to the MySQL database */

$db = mysql_connect("host", "user", "pass");
mysql_select_db("thedatabase",$db);

/* Build the query that will returns the data to graph */

$Yes = "";
$No = "";
$Undecided = "";

$Requete = "SELECT `Do you have an interest in Green IT` FROM `replies`";

$Result  = mysql_query($Requete,$db);

while($row = mysql_fetch_array($Result))
{
    /* Push the results of the query in an array */
    $Yes[]   = $row["Yes"];
    $No[] = $row["No"];
    $Undecided[] = $row["Undecided"];
}

/* Create and populate the pData object */ 
$myData = new pData();   
$myData->addPoints(array($Yes,$Result)); 
$myData->addPoints(array($No,$Result));
$myData->addPoints(array($Undecided,$Result));
$myData->setAxisName(0,"Number of Responses"); 
$myData->addPoints(array("Yes","No","Undecided"),"Types of Responses"); 
$myData->setSerieDescription("Types of Responses","Types of Responses"); 
$myData->setAbscissa("Types of Responses"); 
$myData->setAbscissaName("Types of Responses"); 

/* Create the pChart object */ 
$myPicture = new pImage(500,500,$myData); 
$myPicture->drawGradientArea(0,0,500,500,DIRECTION_VERTICAL,array("StartR"=>240,"StartG"=>240,"StartB"=>240,"EndR"=>180,"EndG"=>180,"EndB"=>180,"Alpha"=>100)); 
$myPicture->drawGradientArea(0,0,500,500,DIRECTION_HORIZONTAL,array("StartR"=>240,"StartG"=>240,"StartB"=>240,"EndR"=>180,"EndG"=>180,"EndB"=>180,"Alpha"=>20)); 
$myPicture->setFontProperties(array("FontName"=>"pchart/fonts/pf_arma_five.ttf","FontSize"=>6)); 

/* Draw the chart scale */  
$myPicture->setGraphArea(100,30,480,480); 
$myPicture->drawScale(array("CycleBackground"=>TRUE,"DrawSubTicks"=>TRUE,"GridR"=>0,"GridG"=>0,"GridB"=>0,"GridAlpha"=>10,"Pos"=>SCALE_POS_TOPBOTTOM)); 

/* Turn on shadow computing */  
$myPicture->setShadow(TRUE,array("X"=>1,"Y"=>1,"R"=>0,"G"=>0,"B"=>0,"Alpha"=>10)); 

/* Create the per bar palette */ 
$Palette = array("0"=>array("R"=>188,"G"=>224,"B"=>46,"Alpha"=>100), 
              "1"=>array("R"=>224,"G"=>100,"B"=>46,"Alpha"=>100), 
              "2"=>array("R"=>224,"G"=>214,"B"=>46,"Alpha"=>100), 
              "3"=>array("R"=>46,"G"=>151,"B"=>224,"Alpha"=>100), 
              "4"=>array("R"=>176,"G"=>46,"B"=>224,"Alpha"=>100), 
              "5"=>array("R"=>224,"G"=>46,"B"=>117,"Alpha"=>100), 
              "6"=>array("R"=>92,"G"=>224,"B"=>46,"Alpha"=>100), 
              "7"=>array("R"=>224,"G"=>176,"B"=>46,"Alpha"=>100)); 

 /* Draw the chart */  
 $myPicture->drawBarChart(array("DisplayPos"=>LABEL_POS_INSIDE,"DisplayValues"=>TRUE,"Rounded"=>TRUE,"Surrounding"=>30,"OverrideColors"=>$Palette)); 

/* Write the legend */  
$myPicture->drawLegend(570,215,array("Style"=>LEGEND_NOBORDER,"Mode"=>LEGEND_HORIZONTAL)); 

/* Render the picture (choose the best way) */ 
$myPicture->autoOutput("pictures/example.drawBarChart.palette.png"); 
?> 
```

# r - 刻面时如何在图下方显示条形标签？

> ID：10058839
> 
> 赞同：11
> 
> 时间：2012-04-07T22:17:41.020
> 
> 标签：r, ggplot2

似乎这些条带总是在**ggplot2**创建的图上方。它们可以移动到情节下方吗？

例如：

```
library(ggplot2) 
qplot(hwy, cty, data = mpg) + facet_grid( . ~ manufacturer) 
```

在顶部显示汽车信息。它们可以显示在底部吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-03-29T23:53:57.070

**更新：**使用`ggplot2`2.1.0 版，考虑使用`switch = 'x'`. 详情请参阅`?facet_grid`。

使用`gtable`功能，很容易移动条带。（或者[在这里](https://stackoverflow.com/questions/18065319/flip-facet-label-and-x-axis-with-ggplot2?lq=1)查看另一个版本 - 交换 x 轴和条带）

```
library(ggplot2)
library(gtable)
library(grid)

p <- ggplot(mpg, aes(hwy, cty)) + geom_point() + facet_grid( . ~ manufacturer) +
     theme(strip.text.x = element_text(angle = 90, vjust = 1),
           strip.background = element_rect(fill = NA))

# Convert the plot to a grob
gt <- ggplotGrob(p)

# Get the positions of the panels in the layout: t = top, l = left, ...
panels <-c(subset(gt$layout, grepl("panel", gt$layout$name), select = t:r))

# Add a row below the x-axis tick mark labels,
# the same height as the strip
gt = gtable_add_rows(gt, gt$height[min(panels$t)-1], max(panels$b) + 2)

# Get the strip grob
stripGrob = gtable_filter(gt, "strip-t")

# Insert the strip grob into the new row
gt = gtable_add_grob(gt, stripGrob, t = max(panels$b) + 3, l = min(panels$l), r = max(panels$r))

# remove the old strip
gt = gt[-(min(panels$t)-1), ]

grid.newpage()
grid.draw(gt) 
```

![在此处输入图像描述](../Images/0731fa9d3780b9bf6bfd5c033dbba919.png)

# c# - Code First 一对一关系和 MVC 创建问题

> ID：10058840
> 
> 赞同：0
> 
> 时间：2012-04-07T22:17:49.760
> 
> 标签：c#, asp.net-mvc-3, ef-code-first

我有一个代码优先数据库。引起我问题的表格是

```
public class Deadline
{
    public Deadline() { }
    public Deadline(Year year)
    {
        this.Year = year;
    }

    public Guid Id { get; set; }

    [Required]
    public Year Year { get; set; }

    [Required]
    [DataType(DataType.Date)]
    [DataAnnotationsExtensions.Date]
    public DateTime From { get; set; }

    [Required]
    [DataType(DataType.Date)]
    [DataAnnotationsExtensions.Date]
    public DateTime To { get; set; }
}

public class Year
{
    public Year(Int32 value) { this.Value = value; }

    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public Guid Id { get; set; }

    [Required]
    [Display(Name="Year")]
    [DataAnnotationsExtensions.Year]        
    public Int32 Value { get; set; }

    public virtual Deadline Deadline { get; set; }
} 
```

我今年有一个控制器，它有 create get 方法

```
 public ActionResult Create()
    {
        ViewBag.Id = new SelectList(db.Deadline, "Id", "Id");
        var Year = new Year(db.Year.OrderByDescending(x => x.Value).FirstOrDefault().Value + 1);
        Year.Deadline = new Deadline(Year);
        return View(Year);
    } 
```

和 post 方法

```
 [HttpPost]
    public ActionResult Create(Year year)
    {
        if (ModelState.IsValid)
        {
            if (db.Year.Select(x => x.Value).Contains(year.Value))
            {
                ModelState.AddModelError("AlreadyExists", "That year has already been added to the database, please edit instead");
                return View(year);
            }
            db.Year.Add(year);
            db.SaveChanges();
            return RedirectToAction("Index");  
        }

        return View(year);
    } 
```

每当我尝试创建一个新的年份（已设置年份值和截止日期）时，它都会返回帖子并且模型状态无效并说

> 年份字段是必需的。

我已经检查并在 post 方法 year.Deadline.Year 确实为空，我想知道的是为什么（以及我如何解决这个问题）它一直让我发疯，甚至把

```
@{ Model.Deadline.Year = Model; } 
```

在视图中什么也没做。

**编辑**以下作品

```
 using (ProjectSelectionAndAllocation.Models.DatabaseContext Context = new Models.DatabaseContext())
    {
        var h = new Models.Year(1001);
        h.Deadline = new Models.Deadline(h);
        Context.Year.Add(h);
        Context.SaveChanges();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:49:02.710

好的，关于这个问题，我有两种基本理论，但无论如何你都应该实施一种解决方案。

所以我将从解决方案开始：使用 ViewModel。这是一个小型、扁平、轻量级的类，只包含视图想要显示的字段。它不应该与您的数据层相同。视图应该只是呈现内容，而 ViewModel 应该只包含要显示的数据。

您将数据从您的实际对象映射到 ViewModel（AutoMapper 在这方面非常受欢迎。）

现在，为什么这会有所帮助？好吧，我对您的问题的理论是：

1）模型绑定器可能不喜欢虚拟属性。每当您将表单返回到 MVC 中的函数时，都会有少量代码运行并尝试将表单中的所有值映射到它们的字段。此模型绑定器可能无法找出虚拟字段，或者可能有充分的理由不自动映射到虚拟字段。无论哪种方式，ViewModel 都会将其替换为常规的公共属性。

2）另一种可能性，但我不太确定，是有一个循环引用（Year -> Deadline -> Year ）并且模型活页夹不能很好地处理。不过，ViewModel 概念再次摆脱了这一点，您只需在 ViewModel 中有一个 Year 字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:46:38.873

当我的模型在视图中没有正确连接时，我就遇到过这种情况。这种事情会阻止模型绑定器在后期操作中实现模型。要检查的一件事是确保您在视图中使用良好的 asp.net mvc 命名约定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T23:04:01.457

这是我的想法，当您不知道发生了什么时，它通常会很有用...
参考包含更多详细信息的帖子：[https](https://stackoverflow.com/a/10037334/417747)
://stackoverflow.com/a/10037334/417747 ...

在类似的情况下，当绑定没有按预期工作时，通常有助于调试 - 并且通过制作自定义活页夹。

```
public class YearClassBinder : DefaultModelBinder
{
    //public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    //{
    //}
    protected override object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType)
    {
        var model = (Year)base.CreateModel(controllerContext, bindingContext, modelType);

        // ...you change, inspect set etc.

        return model;
    }
} 
```

...这是自定义绑定的方法，调整您的“传递”值 - 还检查它们是否存在问题等
（您需要测试，尝试一些选项，可能是更好的 BindModel，取决于）

（您在该链接中有更多详细信息）

这不是一个确切的答案，但大多数时候会让你走上正轨。

希望能帮助到你。

**编辑：只是添加**，如果需要，您可以使用相同的方法手动调整和创建 Year 实例，以防出现任何问题，如提到的一张海报（循环引用等）。

# testing - Xcode 4.2 和 iOS 5.1 管理器用黄点读取我的 iPhone？

> ID：10058845
> 
> 赞同：0
> 
> 时间：2012-04-07T22:18:48.967
> 
> 标签：testing, xcode4.2, ios5.1, organizer

所以我有 Xcode 4.2 而我的 iPhone 4S 正在运行 iOS 5.1 。我有一个想在我的 iPhone 中测试的应用程序，但是当我将我的 iPhone 连接到我的 Mac 时，它会使用配置文件和所有内容读取设备，但它会在设备 (iPhone) 列表旁边显示一个黄点。所有这些都在管理器窗口中。

我也有一个应用程序 ID。我只需要有关如何修复黄点的帮助，以便它可以变成绿点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T13:50:24.200

这件事对我有用 首先我在 xcode 3.2.5 中运行项目，并且项目在 iOS 5.1 上运行！！！！！！*后来我断开了设备并再次在*雪豹上的 xcode 4.2 上运行项目，它开始工作没有任何问题。不知道这是如何工作的，我有雪豹和旧的 xcode 3.2.5

# javascript - 使用正则表达式替代 HTML 解析

> ID：10058851
> 
> 赞同：3
> 
> 时间：2012-04-07T22:19:29.777
> 
> 标签：javascript, regex, parsing, node.js

我正在使用 node.js 中的正则表达式解析 HTML 以返回一个字符串。但是，我在这篇文章中被告知这不是一个好主意：[Pull a specific string from an HTTP request in node.js](https://stackoverflow.com/questions/10005274/pull-a-specific-string-from-an-http-request-in-node-js)

有哪些更稳定的替代方案？

我是编程新手，所以教程链接会很有帮助。我无法理解一些文档解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T23:09:18.193

[node-htmlparser](https://github.com/tautologistics/node-htmlparser)处理解析 HTML 的所有繁重工作。最重要的是，[node-soupselect](https://github.com/harryf/node-soupselect)允许您使用 CSS 样式的选择器来查找您正在寻找的特定元素。

**但是**，我查看了您的另一个问题，您真正应该问的问题不是“我如何从 HTML 页面中抓取这些数据”，而是“有没有更好的方法来检索我正在寻找的数据？” USGS 拥有[以机器可读形式提供数据的 API](http://waterdata.usgs.gov/nwis/news/?automated_retrieval_info)。

[这是您感兴趣的位置的 JSON 对象。](http://waterservices.usgs.gov/nwis/iv/?sites=02334400&period=P7D&format=json) 要获取水库表面高程的“最新瞬时值”，您将下载该文件，执行`var d = JSON.parse`，然后：

```
for (var i = 0; i < d.value.timeSeries.length; i++) {
    if (d.value.timeSeries[i].variable.variableName == 'Elevation of reservoir water surface above datum, ft') {
        var result = d.value.timeSeries[i].values[0].value[d.value.timeSeries[i].values[0].value.length-1];
    }
} 
```

`result`现在的样子`{ dateTime: "2012-04-07T17:15:00.000-05:00", value: "1065.91" }`。

# jsf - @Inject 通过 URL 将参数传递给 CDI @Named bean

> ID：10058852
> 
> 赞同：8
> 
> 时间：2012-04-07T22:19:31.493
> 
> 标签：jsf, facelets, cdi, managed-property

如果我不能将@ManagedProperty 注释与@Named 一起使用，因为@ManagedProperty 在CDI（？）中不起作用，那么如何将URL 中的参数传递给facelets 客户端？在我的代码中，我想通过“后退”和“前进”按钮将 javax.mail.getMessageNumber() 传递给 details.xhtml。

我知道应该使用@Inject，但是请注入什么以及如何注入？

从 glassfish 日志中，id 始终为 0，这很奇怪。即使单击“前进”，无论单击多少次按钮，id 都不会超过 1。当然，这只是问题的表象。当然，所需的输出是前进到下一条消息。

也许将 Message 或至少 int 放入会话中？

客户是这样的：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./template.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:f="http://java.sun.com/jsf/core">
    <ui:define name="top">
        <h:form>
            <h:form>
                <h:outputLink id="link1" value="detail.xhtml">
                    <f:param name="id" value="#{detail.back()}" />
                    <h:outputText value="back" />
                </h:outputLink>
            </h:form>
        </h:form>
        <h:form>
            <h:outputLink id="link1" value="detail.xhtml">
                <f:param name="id" value="#{detail.forward()}" />
                <h:outputText value="forward" />
            </h:outputLink>
        </h:form>
    </ui:define>
    <ui:define name="content">
        <h:outputText value="#{detail.content}"></h:outputText>
    </ui:define>
</ui:composition> 
```

和豆子一样：

```
package net.bounceme.dur.nntp;

import java.util.logging.Level;
import java.util.logging.Logger;
import javax.enterprise.context.RequestScoped;
import javax.faces.bean.ManagedProperty;
import javax.inject.Named;
import javax.mail.Message;

@Named
@RequestScoped
public class Detail {

    private static final Logger logger = Logger.getLogger(Detail.class.getName());
    private static final Level level = Level.INFO;
    @ManagedProperty(value = "#{param.id}")
    private Integer id = 0;
    private Message message = null;
    private SingletonNNTP nntp = SingletonNNTP.INSTANCE;

    public Detail() {
        message = nntp.getMessage(id);
    }

    public int forward() {
        logger.log(level, "Detail.forward.." + id);
        id = id + 1;
        logger.log(level, "..Detail.forward " + id);
        return id;
    }

    public int back() {
        logger.log(level, "Detail.back.." + id);
        id = id - 1;
        logger.log(level, "..Detail.back " + id);
        return id;
    }

    public Message getMessage() {
        return message;
    }

    public String getContent() throws Exception {
        return message.getContent().toString();
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-07T23:35:52.480

这仅适用于 JSF 2.3 中引入的[`javax.faces.annotation.ManagedProperty`](https://jakarta.ee/specifications/platform/8/apidocs/javax/faces/annotation/ManagedProperty.html).

```
@Inject @ManagedProperty("#{param.id}")
private String id; 
```

现在已弃用的[`javax.faces.bean.ManagedProperty`](https://jakarta.ee/specifications/platform/8/apidocs/javax/faces/bean/ManagedProperty.html)注解仅适用于 JSF`@ManagedBean`类。即在由 JSF 管理的实例中。它不适用于由 CDI 管理的实例`@Named`。此外，您还犯了另一个错误：您正在尝试`Message`基于构造函数中的托管属性来准备。如果它是真实的`@ManagedBean`，那也行不通。托管属性在构造期间不可用，仅仅是因为在调用构造函数之前无法调用 setter 方法。您应该`@PostConstruct`为此使用了一种方法。

如果无法升级到 JSF 2.3，则需要创建自定义 CDI 注释。[此博客](http://www.glxn.net/?p=141)中发布了一个具体示例。这是相关性的摘录：

自定义`@HttpParam`注释：

```
@Qualifier
@Retention(RUNTIME)
@Target({TYPE, METHOD, FIELD, PARAMETER})
public @interface HttpParam {
    @NonBinding
    public String value() default "";
} 
```

注释值生产者：

```
public class HttpParamProducer {

    @Inject
    FacesContext facesContext;

    @Produces
    @HttpParam
    String getHttpParameter(InjectionPoint ip) {
        String name = ip.getAnnotated().getAnnotation(HttpParam.class).value();
        if ("".equals(name)) name = ip.getMember().getName();
        return facesContext.getExternalContext()
                .getRequestParameterMap()
                .get(name);
    }
} 
```

一个使用示例：

```
@Inject @HttpParam
private String id; 
```

JSF 实用程序库[OmniFaces](http://omnifaces.org)[`@Param`](http://showcase.omnifaces.org/cdi/Param)正是为此目的，内置了对 JSF 转换和验证的支持。

* * *

或者，您也可以手动从`Detail`托管 bean 的外部上下文中获取请求参数。进行托管 bean 初始化的推荐方法是使用`@PostConstruct`方法，而不是构造函数，因为构造函数*可以*用于与托管 bean 创建完全不同的目的：

```
@PostConstruct
public void init() {
    String id = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("id");
    // ...
} 
```

* * *

另一种方式，IMO 也更适合这种特殊情况，是使用`<f:viewParam>`它还允许您`Message`直接通过自定义转换器将 ID 转换为。

```
<f:metadata>
    <f:viewParam name="id" value="#{detail.message}" converter="messageConverter" />
</f:metadata> 
```

只需

```
@Named
public class Detail {

    private Message message;

    // Getter+setter
} 
```

和一个

```
@FacesConverter("messageConverter")
public class MessageConverter implements Converter {

    // Convert string id to Message object in getAsObject().
    // Convert Message object to string id in getAsString().

} 
```

### 也可以看看

*   [ViewParam 与 @ManagedProperty(value = "#{param.id}")](https://stackoverflow.com/questions/4888942/viewparam-vs-managedpropertyvalue-param-id)
*   [JSF 2.0 中的通信 - 处理 GET 请求参数](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ProcessingGETRequestParameters)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T19:58:08.417

首先，解释一下外来部分——Glassfish 使用 JBoss Weld 作为其 CDI 实现，Oracle 并没有开发自己的实现。

关于错误消息的含义： FacesContext 根本无法通过`@Inject`. 有一个相当古老的[功能要求](https://issues.jboss.org/browse/CDI-25)，我认为 Seam 或 Solder 提供了一个生产者。但是没有必要为此集成任何一个库。通过`FacesContext.getCurrentInstance()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T11:14:28.120

我问的是一种复杂的方法来做一件简单的事情。在 CDI 中，传递参数不能使用 @ManagedProperty，正如 BalusC 上面解释的那样。相反，您只需像这样设置您的 xhtml 文件：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./template.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:f="http://java.sun.com/jsf/core">
    <ui:define name="top">
        <h:form>
            <h:commandButton action="#{messages.back()}" value="..back" />
        </h:form>
        <h:form>
            <h:commandButton action="#{messages.forward()}" value="forward.." />
        </h:form>
    </ui:define>
    <ui:define name="content">
        <h:dataTable value="#{messages.model}" var="m">
            <h:column>
                <f:facet name="id">
                    <h:outputText value="id" />
                </f:facet>
                <h:outputLink id="hmmm" value="detail.xhtml">
                    <f:param name="id" value="#{m.getMessageNumber()}" />
                    <h:outputText value="#{m.getMessageNumber()}" />
                </h:outputLink>
            </h:column>
            <h:column>
                <f:facet name="subject">
                    <h:outputText value="subject" />
                </f:facet>
                <h:outputText value="#{m.subject}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="content">
                    <h:outputText value="content" />
                </f:facet>
                <h:outputText value="#{m.sentDate}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="date">
                    <h:outputText value="date" />
                </f:facet>
                <h:outputLink value="#{messages.getUrl(m)}">#{messages.getUrl(m)}</h:outputLink>
            </h:column>
        </h:dataTable>
    </ui:define>
</ui:composition> 
```

到：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./template.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:f="http://java.sun.com/jsf/core">
    <ui:define name="top">
        <h:form>
            <h:outputLink id="back" value="detail.xhtml">
                <f:metadata>
                    <f:viewParam name="id" value="#{detail.id}"  />
                </f:metadata>
                <f:param name="id" value="#{detail.back()}" />
                <h:outputText value="back" />
            </h:outputLink>
        </h:form>
        <h:form>
            <h:outputLink id="forward" value="detail.xhtml">
                <f:metadata>
                    <f:viewParam name="id" value="#{detail.id}"  />
                </f:metadata>
                <f:param name="id" value="#{detail.forward()}" />
                <h:outputText value="forward" />
            </h:outputLink>
        </h:form>
    </ui:define>
    <ui:define name="content">
        <h:outputText value="#{detail.content}"></h:outputText>
    </ui:define>
</ui:composition> 
```

我只是为任何出现的人包括这个，以澄清，对于这个简单的例子，你不需要转换器，默认工作正常。

最初的问题也有点混乱。通过查看有关此的其他问题，我认为其他人可以从诸如此类的简单示例中受益。太多的例子过于复杂，或者涉及到 EJB 等。

# c# - 查看字符串中的每个字符

> ID：10058854
> 
> 赞同：40
> 
> 时间：2012-04-07T22:20:15.007
> 
> 标签：c#, string, search, character

我想知道是否有人知道如何查看每个字符的字符串，然后将每个字符添加到新字符串中？只是一个非常基本的示例，我可以添加`ToUpper`和`ToLower`验证等。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-04-07T22:22:32.357

```
string foo = "hello world", bar = string.Empty;

foreach(char c in foo){
    bar += c;
} 
```

* * *

使用`StringBuilder`：

```
string foo = "hello world";
StringBuilder bar = new StringBuilder();

foreach (char c in foo)
{
    bar.Append(c);
} 
```

* * *

以下是该人的签名`String` `class`：

```
[SerializableAttribute]
[ComVisibleAttribute(true)]
public sealed class String : IComparable, 
    ICloneable, IConvertible, IComparable<string>, IEnumerable<char>, 
    IEnumerable, IEquatable<string> 
```

[http://msdn.microsoft.com/en-us/library/system.string(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.string(v=vs.100).aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-07T22:23:36.530

```
var output = ""; // or use StringBuilder
foreach(char c in text)
{
     output += c; // if or do with c what you need
} 
```

……那是你需要的吗？
字符串是`IEnumerable<char>`

# android - Android Eclipse，ativity 之外的 AlertDialog

> ID：10058855
> 
> 赞同：0
> 
> 时间：2012-04-07T22:20:20.773
> 
> 标签：android, eclipse

通过使用以下代码，我的活动中有一个带有 OK 按钮的 AlertDialog：

```
 alertDialog = new AlertDialog.Builder(getApplicationContext()).create();

        //Setting Dialog Title
        alertDialog.setTitle("Alert Dialog");

        // Setting Dialog Message
        alertDialog.setMessage("Welcome to AndroidHive.info");

        // Setting Icon to Dialog
        alertDialog.setIcon(R.drawable.icon);

        // Setting OK Button
        alertDialog.setButton("OK", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
    // Write your code here to execute after dialog closed  
    }
    });

        alertDialog.show(); 
```

这在应用程序中运行良好，但我希望即使我们在应用程序之外也能运行并显示它。当然，应用程序仍在运行且未关闭。很像吐司。即使我可以使用带有 OK 按钮的 Toast，我也会很高兴。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:34:01.760

您不能独立运行对话框。您必须获得一个 Activity 才能显示您的对话框。在我看来，如果每个应用程序都可以随时启动模式对话框，那么您的解决方案将导致糟糕的用户体验。

但是您可以想象两种解决方案：

*   当某个意图发送到系统时，在此对话框打开的情况下启动一个活动（也许您可以使活动透明）。
*   使用通知，它看起来与您想要做的非常接近。

# vb.net - 从 vb.net 连接到 IBM / ISPF

> ID：10058862
> 
> 赞同：1
> 
> 时间：2012-04-07T22:22:02.310
> 
> 标签：vb.net, mainframe, ispf

我想通过 VB.net 连接到 IBM 大型机并直接通过 VB.net 运行大型机中存在的作业并查看输出回来....任何人都可以帮助如何连接到 IBM 大型机并直接通过 vb.net 运行作业……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T14:48:48.223

我想您不想复制[ISPF GUI 模式](https://www.ibm.com/docs/en/zos/2.4.0?topic=interface-running-in-gui-mode)的功能。

一种方法是直接使用 FTP 连接到 JES 内部阅读器，如[本线程](https://stackoverflow.com/questions/1323538/how-to-submit-jcl-on-ibm-zos-through-java-web-app)中所述。大型机安全人员可能会不允许这样做，我知道我的。

另一种方法是[筛选](https://stackoverflow.com/search?q=screen%20scrape%203270&submit=search)ISPF。

[您可以在 TSO 中使用提交](https://www.ibm.com/docs/en/zos/2.4.0?topic=subcommands-submit-command)命令并在[TSO](https://www.ibm.com/docs/en/zos/2.4.0?topic=zos-tsoe)中运行[SDSF](https://www.ibm.com/docs/en/zos/2.4.0?topic=sdsf)来检索您的输出，而不是屏幕抓取 ISPF 。您还可以编写[Rexx](https://www.ibm.com/docs/en/zos/2.4.0?topic=guide-using-sdsf-rexx-programming-language)或[Java](https://www.ibm.com/docs/en/zos/2.4.0?topic=guide-using-sdsf-java-programming-language)在大型机上运行，​​以您想要的形式为您提供输出，而不是让您的 VB 代码意识到 ISPF 和/或 SDSF 面板。

您可以使用通过[SPOOL](https://www.ibm.com/docs/en/cics-ts/5.6?topic=summary-spoolopen-output) API提交批处理作业的[CICS Web 服务](https://www.ibm.com/docs/en/cics-ts/5.6?topic=applications-developing-web)，检索结果可能更具挑战性。您可能必须将输出存储在 z/OS Unix 文件中并从那里检索它。

# regex - 特殊字符转 ASCII

> ID：10058864
> 
> 赞同：1
> 
> 时间：2012-04-07T22:22:24.517
> 
> 标签：regex, vba, ms-access, ascii, special-characters

在 MS Access 中使用 VBA，有没有办法将字符串中的所有特殊字符替换为 ASCII 等效字符？换句话说，我希望`&amp;`与其他特殊字符一起消失并替换为 。

PHP 等价物是`HTMLSpecialChars`. 我的插入中有分号，这可能会破坏我的查询。我需要转换分号来清理我的插入文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T13:16:13.690

从 Access 2000 开始，Access VBA 中提供了[替换功能。](http://office.microsoft.com/en-us/access-help/replace-function-HA001228898.aspx)

```
? Replace("a&v", "&", "&amp;")
a&amp;b 
```

您需要为要替换的任何其他字符重复该功能模式。

但是，如果这是为了防止破坏 INSERT 语句，则可能是转移注意力。只要您插入的文本被正确引用或作为参数提供给参数查询，您就应该能够将包含分号或与号的文本插入文本字段。这两个语句都为我成功执行。

```
CurrentDb.Execute "INSERT INTO MyTable (MyText) " & _
    "VALUES ('a&b')"
CurrentDb.Execute "INSERT INTO MyTable (MyText) " & _
    "VALUES ('a;b')" 
```

它可能有助于向我们展示您失败的 INSERT 语句的 SQL，并带有一个导致它爆炸的文本的简单示例。还要告诉我们错误信息（如果有）。请将 SQL 粘贴到您的问题中，而不是评论中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:26:52.533

[http://www.renownedmedia.com/blog/convert-ascii-to-utf-8-using-vba/](http://www.renownedmedia.com/blog/convert-ascii-to-utf-8-using-vba/)

# c - 在C字符串中存储十六进制值？

> ID：10058865
> 
> 赞同：2
> 
> 时间：2012-04-07T22:22:25.900
> 
> 标签：c, binary, gdb, hex

我有一个字符串`"SOMETHING /\xff"`，我想将 的十六进制表示保存`0xff`到`char`缓冲区中。因此，我`strncpy`将正斜杠 ( `/`) 之后的所有内容都放入我的缓冲区（我们称之为`buff`）。

但是，当我使用 gdb 命令`print \x buff`查看 的内容时`buff`，它不显示`0xff`. 关于什么可能是错的任何想法？我的正斜杠有可能把事情搞砸了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T22:54:56.687

我认为您的问题与您在 gdb 中打印变量的方式有关。拿这个简单的程序，编译为调试（如果使用 gcc），然后在第一条语句`-g`处运行和中断：`puts`

```
int main(void)
{
   char *ptr = "str \xff";
   char arr[] = "str \xff";
   puts(ptr);
   puts(arr);

   return 0;
} 
```

如果我尝试`ptr`按照您提到的方式打印`p /x ptr`，它将打印`ptr`（它指向的地址）的值：

```
(gdb) p /x ptr
$1 = 0x4005f8 
```

但是，如果我对 执行相同的命令`arr`，我会得到：

```
(gdb) p /x arr
$2 = {0x73, 0x74, 0x72, 0x20, 0xff, 0x0} 
```

那是因为 gdb 可以看到 that `arr`is of type`char[6]`而不是`char*`. 您可以使用命令获得相同的结果`p /x "str \xff"`，这对于测试事物很有用：

```
(gdb) p /x "str \xff"
$3 = {0x73, 0x74, 0x72, 0x20, 0xff, 0x0} 
```

现在，如果您希望能够从指针指向的地址打印一定数量的字节，请使用检查（`x`）内存命令而不是打印（`p`）：

```
(gdb) x/6bx ptr
0x4005f8 <__dso_handle+8>:  0x73    0x74    0x72    0x20    0xff    0x00 
```

这将从 . 指向的地址以十六进制打印 6 个字节`ptr`。用你的变量试试看，`buff`看看你是怎么做的。

或者，您可以尝试的另一件事是：

```
(gdb) p /x (char[6])*ptr
$4 = {0x73, 0x74, 0x72, 0x20, 0xff, 0x0} 
```

这会将`char`指向的 by`ptr`视为 6 s 数组中的第一个元素`char`，并允许您使用 print 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-05T00:13:11.080

0xFF 不是可打印的 ASCII 字符，所以 gdb 无法打印。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-07T22:32:58.363

请记住，C 中的字符串是一个`char`值数组。a`char`是一个无符号的 8 位量。（就像 an`int`是有符号的 16 位数量一样。）可以放置在无符号 8 位字段中的最大值是十进制的 255，即十六进制的 0xFF 或八进制的 0377 或二进制的 11111111。

在 C 中带引号的字符串中，表示法`\xNN`表示插入十六进制值为 NN 的字符。

# java - 让 3 个类互相调用

> ID：10058872
> 
> 赞同：2
> 
> 时间：2012-04-07T22:23:24.683
> 
> 标签：java

所以我想弄清楚如何让 3 个班级互相调用。

这是主要课程。

```
public class TestStudent {
    public static void main(String[] args) {
        myStudent mystudent_obj = new myStudent();
        mystudent_obj.show_grades();
        mystudent_obj.change_grades();
        mystudent_obj.show_grades();
    }
} 
```

这是在上面的类中调用的第二类；第二类调用另一个第三类并尝试使用两个函数对其进行操作。函数`show_grades`只是打印出第 3 类中的变量，然后函数`change_grade`尝试更改第 3 类中的变量。

```
public class myStudent {
    public void show_grades(){
        Student student_obj = new Student();
        System.out.println(student_obj.studGrade);
        System.out.println(student_obj.studID);
    }

    public void change_grades(){
        Student student_obj = new Student();
        student_obj.studGrade='V';
        student_obj.studID=10;
    }
} 
```

这是第三次调用，它只有两个变量。

```
public class Student {
    public int studID = 0;
    public char studGrade = 'F';
} 
```

当我运行程序时，它运行时没有错误，我得到以下输出：

```
F
0
F
0 
```

但是，我可以看到该功能`show_grades`有效并且确实显示了成绩，但该功能`change_grades`不会更改成绩：

最终结果，应该是这样的

```
F
0
V
10 
```

因为改变等级功能，应该改变了那些变量......那是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T22:27:26.057

In your myStudent class you are creating a new instance of Student in each method, meaning that each method has a local variable of class Student. When you call `show_grades` the second time, a *new* instance is created, with the default values of 0 and F.

If you create a variable and use that instead, your change grades will change the variables of the instance variable instead of a local variable in each method. This is due to scoping in programming, which you can read more about at [Wikipedia](http://en.wikipedia.org/wiki/Scope_%28computer_science%29).

```
public class myStudent {
    private Student student_obj = new Student();

    public void show_grades() {
       System.out.println(student_obj.studGrade);
       System.out.println(student_obj.studID);
    }

    public void change_grades(){
        student_obj.studGrade='V';
        student_obj.studID=10;
    }
} 
```

# c++ - C++中的覆盖函数

> ID：10058882
> 
> 赞同：-2
> 
> 时间：2012-04-07T22:25:19.470
> 
> 标签：c++, class, overloading

我试图阻止 B 类访问 DoSomething(Class Y) 函数并且只访问 DoSomething(Class X) 。我怎么能在 C++ 中做到这一点？

```
Class A {
    public:
        void DoSomething(Class Y);
}

Class B: public A { 
    public:
        void DoSomething(Class X);   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T22:31:38.097

你可以做`A::DoSomething(Class Y)` `private`，这是你可以做的唯一方法。

此外，您不是在这里覆盖，而是隐藏。尽管如此，在`class`（是的，它是小写字母，不是大写字母）B 中，您仍然可以调用`A::DoSomething()`. `private`是拒绝访问的唯一方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T22:31:25.307

> 我试图阻止 B 类访问`DoSomething(Class Y)`. 我怎样才能在 C++ 中做到这一点？

像这样：

```
class X {};
class Y {};

class A {
    public:
        void DoSomething(class Y);
};

class B: public A {
    public:
        void DoSomething(class X);
};

int main () {
  B b;
  Y y;
  b.DoSomething(y);

  // Note that b can still access DoSomething(y) if you want it to:
  b.A::DoSomething(y);
} 
```

请注意这在 g++ 中产生的错误消息：

```
g++ -ansi -pedantic -Wall -Werror    b.cc   -o b
b.cc: In function ‘int main()’:
b.cc:17:18: error: no matching function for call to ‘B::DoSomething(Y&)’
b.cc:17:18: note: candidate is:
b.cc:11:14: note: void B::DoSomething(X)
b.cc:11:14: note:   no known conversion for argument 1 from ‘Y’ to ‘X’ 
```

# c# - 为什么 C# 中没有 System.DateTime 的“日期”简写？

> ID：10058883
> 
> 赞同：10
> 
> 时间：2012-04-07T22:25:23.113
> 
> 标签：c#, .net

比如`int`, `long`, `ushort`, `uint`,`short`等。

为什么没有短手`System.DateTime`呢？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-08T15:22:05.300

> 许多类型与 C# 中的“速记”关键字相关联；例如，`System.Int32`也可以写`int`和`System.String`可以写`string`。为什么没有简写`System.DateTime`？

在我回答这个问题之前——或者更确切地说，不回答它——让我们首先注意在 C# 中具有速记的类型。他们是

```
object 
string 
sbyte byte short ushort int uint long ulong 
char 
bool 
decimal double float 
```

让我先谈谈其他一些答案。

Mystere Man 正确地指出，其中几个关键字来自 C；C 有`int`和相当罗嗦`unsigned int`的`double`, 和其他一些。然而，C 最值得注意的是没有`bool`, `long`, `decimal`,`object`或`string`。

`int`我认为我们可以合理地说，包含关键字等的一个理由`char`是，熟悉 C 和 C++ 的用户可以在 C# 中快速高效地工作。这里的目的是让 C 程序员熟悉这些关键字，但绝对不是让这些关键字具有与它们在 C 中相同的语义。C 没有指定其中任何一个的大小，例如，和强烈建议`int`成为机器的“自然尺寸”。C# 确实指定了每种类型的确切大小和范围。

所以我认为我们不能合理地说*没有*简写的理由`System.DateTime`是因为在 C 中没有。在 C 中也没有`string`或`decimal`。

Jason 指出这`DateTime`不是“C# 语言的一部分”，因此没有关键字。但这完全是在乞求问题！问题本质上是“好的，那么为什么 DateTime 不是 C# 语言的一部分？” 以同样困难的方式回答问题，称为“求题”，此题已被求得彻底。

考虑什么是“基本”类型是有益的。C# 中所有具有关键字的类型在某种程度上都“非常特殊”，*除了`decimal`*. 也就是说，底层运行时具有内置的特殊行为`object`，显然，因为它是通用基本类型。`string`可能只是一个 的数组`char`，但它不是；字符串是特殊的。（因为它们可以被实习，它们可以是常量，它们可以存在于元数据中，等等。）整型和二进制浮点类型都在其操作的框架中内置了特殊处理。

但这`System.Decimal`只是另一种结构类型；它是 128 位整数和大量用户定义的运算符。如果愿意，任何人都可以实现自己的十进制算术类型。但是通过使其成为 C# 语言的一部分来“祝福”`System.Decimal`它意味着即使它的转换被实现为方法，我们也将它们视为*内置转换*，而不是*用户定义的转换*。

所以`decimal`真的很奇怪。它不是运行时的“基本”类型，而是一个关键字。

不过，这带来了一个有趣的观点。*System.IntPtr*和*System.UIntPtr* *是*运行时的基本类型。它们是“指针大小的整数”类型；它们是 C 中的`int`and的意思`unsigned int`。尽管这些类型是 .NET 运行时类型系统的基础，但它们并*没有*得到关键字的祝福。

因此，我们可以拒绝只有“基本”类型才能获得关键字的论点。有获得关键字的非基本类型和没有获得关键字的基本类型，因此基本类型和获得关键字的类型之间没有一对一的关系。

Tigran 认为这些选择是“历史性的”，这是正确的，但实际上并没有回答这个问题。

Hans Passant 正确地指出，明确指定 int 的大小和范围有助于使语言行为保持一致，即使本机整数大小发生变化，并指出`DateTime`已经设计为“面向未来”。尽管这种分析是正确的，但它并不能解释为什么将小数设为关键字。不用担心机器的“本机十进制大小”将来会发生变化。此外，C# 语言已经指出，尽管 double 将始终占用 8 个字节的存储空间，但 C# 并不要求将 double 的处理限制为仅 64 位精度；事实上，C# 程序经常以 80 位或更多位的精度执行双精度运算。

我认为这些答案中的任何一个都不能成功解决这个问题。那么让我们回到这个问题：

> 许多类型与 C# 中的“速记”关键字相关联；例如，`System.Int32`也可以写`int`和`System.String`可以写`string`。为什么没有简写`System.DateTime`？

这个问题的答案与“为什么 C# 没有实现我喜欢的功能？”形式的每个问题的答案相同。答案是： **我们不需要提供不实现某个功能的理由。**功能很*昂贵*，而且，正如 Raymond Chen 经常指出的那样，*默认情况下是未实现的*。让一个未实现的特性不实现是不费吹灰之力的。

功能建议一点也*不无道理*；Visual Basic 在某种意义上被视为`DateTime`一种特殊类型，如果我们认为值得做这项工作，C# 也可以。但并不是每一个合理的特性都能得到实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:41:16.677

C# 语言中 Int32、Int64 等的别名的存在是为了使该语言面向未来。当每个人的台式机都有 256 位内核时，它仍然具有相关性。为了*真正*实现这一点，大量的 C# 代码隐含地*假设*int 是 32 位的。但实际上并没有那么难，我将我编写的代码块从 CP/M 转移到 MS-DOS 再到 Windows 3.x 到 Windows NT，而且出乎意料地毫不费力。

这不是 DateTime 的问题。它是面向未来的，直到 10,000 年。我相信并希望到那时机器会理解我的意思，而不是我输入的内容:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T22:43:00.380

除了 BCL/.NET 团队的其他人之外，没有人能给出真正的答案，但我认为这只是*历史原因*，比如类型`char`，`float`......以及它们的“扩展”（如`int`->`uint`在评论中提到的），因为其他没有。

我可以对其他`.NET Framework type`类型提出同样的问题，因为我们`string`在 .NET 中有简写，但`string`它是一个*引用*类型。所以...

希望我得到解释。

# c# - 打开文档并等待用户完成编辑

> ID：10058887
> 
> 赞同：0
> 
> 时间：2012-04-07T22:26:08.080
> 
> 标签：c#, windows, events, delegates, ms-word

我试图务实地打开一个指定的word文档，然后等待用户完成编辑打开的文档，然后再继续。用户通过关闭窗口来指示他完成了。

但是下面的代码不起作用！它一直有效，直到我对文档进行任何编辑：除了等待文档关闭的无限 for 循环之外，一切都冻结了。**我该如何解决这个问题？**

```
bool FormatWindowOpen;
    string FormattedText = "";
    MSWord.Application FormattingApp;
    MSWord.Document FormattingDocument;

    private List<string> ImportWords()
    {
        string FileAddress = FileDialogue.FileName;
        FormattingApp = new MSWord.Application();
        FormattingDocument = FormattingApp.Documents.Open(FileAddress);

        FormattingDocument.Content.Text = "Format this document so it contains only the words you want and no other formatting. \nEach word should be on its own line. \nClose the Window when you're done. \nSave the file if you plan to re-use it." + 
                                    "\n" + "----------------------------------------------------------" + "\n" + "\n" + "\n" +
                                    FormattingDocument.Content.Text; //gets rid of formatting as well
        FormattingApp.Visible = true;
        FormattingApp.WindowSelectionChange += delegate { FormattedText = FormattingDocument.Content.Text; };
        FormattingApp.DocumentBeforeClose += delegate { FormatWindowOpen = false; };
        FormatWindowOpen = true;

        for (; ; ){ //waits for the user to finish formating his words correctly
            if (FormatWindowOpen != true) return ExtractWords(FormattedText);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:42:41.013

您的 for 循环很可能会冻结您的 UI 线程。在另一个线程中启动你的 for 循环。

这是一个使用 Rx 框架将您的值作为异步数据流返回的示例。

```
 private IObservable<List<string>> ImportWords()
    {
        Subject<List<string>> contx = new Subject<List<string>>();
        new Thread(new ThreadStart(() =>
            {
                //waits for the user to finish formatting his words correctly
                for (; ; ) 
                { 
                    if (FormatWindowOpen != true) 
                    {
                        contx.OnNext(ExtractWords(FormattedText));
                        contx.OnCompleted();
                        break;
                    }
                }
            })).Start();
        return contx;
    } 
```

# iphone - 将多个属性应用于多个对象

> ID：10058888
> 
> 赞同：1
> 
> 时间：2012-04-07T22:26:22.707
> 
> 标签：iphone, ios5, sdk

我正在编写一个 iOS 应用程序，我有一个问题要让阅读更容易。

例如，我有很多东西要隐藏，所以我这样做：mytext1.hidden=YES; mytext2.hidden=YES；mytext3.hidden=YES；...

有什么办法可以写这个：(mytext1, mytext2, mytext3).hidden =YES;

?

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T04:52:35.523

您可以使用这样的选择器迭代数组：

```
[theArray makeObjectsPerformSelector:@selector(methodName)]; 
```

...并且有一个变体采用单个对象参数。但是，这不会处理标量类型，因此要设置 hidden=YES，您可以使用块进行枚举：

```
[theArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    (UITextField *)obj.hidden = YES;
}]; 
```

如果这对您的口味来说太冗长了，您可以向数组类添加方法，假设是一组控件。这些只会隐藏枚举，但调用者可以像这样简单：

```
[myArrayOfControls hidden:YES]; 
```

对眼睛很舒服，对吧？您可以通过创建自己的自定义 NSArray 方法类别来实现这一点：

```
// in Array+UIControlEnumeration.m

@implementation NSArray (UIControlEnumeration)

- (void)hidden:(BOOL)hidden {

    for (UIControl *control in self) {
        control.hidden = hidden;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T22:43:42.340

不，Objective-C 中不存在这样的语法。您最好将它们全部粘贴在您作为合成属性添加的数组中并像这样循环遍历它们：

```
for (UITextField *textField in self.myArrayOfTextFields) {
    [textField setHidden:YES];
} 
```

# c# - 将 mp4 转换为 mp3

> ID：10058890
> 
> 赞同：3
> 
> 时间：2012-04-07T22:26:30.943
> 
> 标签：c#, vb.net, ffmpeg

我正在寻找一些允许我将 mp4 视频转换为 mp3 的库或代码。我希望它是免费的并且与最新的 .NET 框架 (4) 兼容。

此外，如果可能的话，我正在寻找一个免费的 ffmpeg 包装器，而不是在我的 vb.net 应用程序中没有试用或消息框。

如果没有免费的 ffmpeg 包装器，有人可以告诉我如何使用命令行和 ffmpeg 执行从 mp4 到 mp3 的转换吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-07T22:37:01.343

如果需要，您可以只启动一个进程 (System.Diagnostics.Process) 并隐藏 ffmpeg 窗口。控制台输出可以重定向到 StringBuilder 或类似的。

对于转换，您可以使用类似

```
ffmpeg.exe -i input.mp4 -vn -f mp3 -ab 192k output.mp3 
```

如果您的 mp4 文件没有视频，则不需要 -vn。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T23:06:15.067

您可以使用以下代码在 vb.net 中处理/执行 ffmpeg 命令。

```
 Dim _out As String = ""
 Dim _process As New Process()
 _process.StartInfo.UseShellExecute = False
 _process.StartInfo.RedirectStandardInput = True
 _process.StartInfo.RedirectStandardOutput = True
 _process.StartInfo.RedirectStandardError = True
 _process.StartInfo.CreateNoWindow = True
 _process.StartInfo.WindowStyle = ProcessWindowStyle.Hidden
 _process.StartInfo.FileName = "ffmpeg";
 _process.StartInfo.Arguments = " -i input.mp4 -vn -f mp3 -ab 192k output.mp3";
 _process.Start()
 _process.StandardOutput.ReadToEnd()
 _out = _process.StandardError.ReadToEnd()
 _process.WaitForExit()
 If Not _process.HasExited Then
    _process.Kill()
 End If
 Return _out 
```

结果，您将收到 ffmpeg 输出和 mp3 音频文件。为了获得更好的编码性能和解析 ffmpeg 输出，我建议使用 ffmpeg 包装器[http://www.mediasoftpro.com/media-handler-pro.html](http://www.mediasoftpro.com/media-handler-pro.html)

# php - MySQL/PHP：来自两个表的 SELECT 中的多个 AND/OR 标记

> ID：10058897
> 
> 赞同：1
> 
> 时间：2012-04-07T22:27:33.760
> 
> 标签：php, mysql

我有两张桌子，`customer`和`reservations`。`customer`并且`reservations`都包含一个名为`customerID`. `reservations`包含两个名为 resStart 和 resEnd 的列，其中只有日期（YYYY-MM-DD，这是我将用于建立 $todaysdate 变量的确切格式。

我想加入这两者以生成一个包含单列`customerID`以及其他信息的表格，但前提是 $todaysdate 落在两个日期或两个日期之间。注意：$todaysdate 在我的文档中的其他地方建立为来自 url 的 _GET（即 day.php?date=2012-07-04），或者如果没有建立，则使用日期（'Ymd'）的今天日期。这部分代码不是我的问题所在，我敢肯定。**我认为这是在 mySql 查询中定义信息时的语法错误。**

这就是我正在使用的。一点解释：我将 PHP 代码包装在 Javascript 周围，这里的目标是为每个 resStart 生成一个单独的 DIV。Javascript 正在获取偏移变量以添加到每个 DIV 的 CSS 中，因此每个 DIV 会自动相对于它所代表的设备放置。

```
<?php
 $getreservations = mysql_query("
 SELECT * FROM customer LEFT JOIN reservations WHERE ( customer.customerID = reservations.customerID ) 
 AND ($todaysdate = resStart OR $todaysdate >= resStart AND $todaysdate <= resEnd )
") 

or die(mysql_error());

while( false !== ($row = mysql_fetch_assoc($getreservations)))
{
    $nameLast = $row["nameLast"];
    $nameFirst = $row["nameFirst"];
    $customerID = $row["customerID"];
    $equipID = $row["equipID"];
    $resStart = $row["resStart"];
    $resEnd = $row["resEnd"];
    $timeStart = $row["timeStart"];
    $timeEnd = $row["timeEnd"];
    $result =  strtotime($timeStart);
        $minute = date("i", $result );
        $second = date("s",$result );
        $hour = date("H", $result );

    if(true) {
 ?>
    <script language='javascript'>
    var left = $('#<?php echo("$hour$minute");?>').offset().left; 
    var top = $('#<?php echo $equipID;?>').offset().top; 

 $(document).ready(function() {
    $('#<?php echo ("$customerID$equipID");?>).css( { 'left': (pos.left + width) + 'px', 'top': (pos.top + top) + 'px' } );     
}
    </script>

<?php } 
echo ("<div class='resContainer $customerID$equipID' id=$customerID$equipID>$nameLast, $nameFirst</div> ");

    } ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:54:05.313

```
SELECT * FROM customer c INNER JOIN reservations r USING(customerID) WHERE '{$todaysdate}' BETWEEN r.resStart AND r.resEnd 
```

但是，您也可以在 SQL: 中获取“todaysdate”，`DATE(NOW())`语句将是：

```
SELECT * FROM customer c INNER JOIN reservations r USING(customerID) WHERE DATE(NOW()) BETWEEN r.resStart AND r.resEnd 
```

**编辑**：在变量周围添加引号`$todaysdate`以避免混淆

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T22:58:44.223

1.  首先直接在数据库中尝试您的查询。您将获得正确的错误代码和问题所在的信息。
2.  使用 JOIN 时，应指定连接条件，使用 USING 或 ON (table1.field=table2.field)。（参考文档：[http](http://dev.mysql.com/doc/refman/5.0/en/join.html) ://dev.mysql.com/doc/refman/5.0/en/join.html ）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T22:58:02.053

试试下面的查询：

```
SELECT * FROM customer 
LEFT JOIN reservations  on customer.customerID = reservations.customerID 
WHERE curdate() BETWEEN r.resStart AND r.resEnd 
```

# javascript - jquery中的li元素列表

> ID：10058900
> 
> 赞同：0
> 
> 时间：2012-04-07T22:28:28.677
> 
> 标签：javascript, jquery

我不知道为什么我的代码不起作用。

```
$("#example").find('LI A').hasClass("sth").each(function(){alert($(this))}); 
```

萤火虫 说：

> $("#example").find('LI A').hasClass("sth").each 不是函数

这段代码的问题是`each`，因为如果我删除它，它不会给我任何错误。

我需要将“a”元素的建立值传递给数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T22:30:50.207

`hasClass`函数返回布尔值而不是 jQuery 对象。因此它没有这个`each`功能。

你可能是这个意思：

```
$("#example").find('LI A.sth').each(function(){alert($(this))}); 
```

或者这个（哪个更好）：

```
$("#example li a.sth").each(function(){alert($(this))}); 
```

阅读[文档](http://api.jquery.com/hasClass/)：

> .hasClass( className )**返回：布尔值**
> 
> **描述：**确定任何匹配的元素是否被分配给给定的类

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T22:31:24.227

您的 hasClass 应用程序不正确。它不返回一个 jQuery 对象，而是一个布尔值，因此`.each()`不能应用于它。

您必须将类附加到选择器

```
$("#find").click(function (){
    $("#example").find('a.sth').each(function(){
        $("#test").append($(this));
    });
 }); 
```

### [演示](http://jsfiddle.net/gBwrG/5/)

# c - Linux Eclipse C 中的奇怪编译错误

> ID：10058907
> 
> 赞同：-1
> 
> 时间：2012-04-07T22:30:08.707
> 
> 标签：c, linux, eclipse

我希望有人可以帮助我解决这个问题。我是 Linux 和 Eclipse 菜鸟，但我对 C/C++ 非常熟悉，尽管我已经有一段时间没有使用它们了。当我尝试编译时，我得到了奇怪的错误。无论我做什么来修复它们，它们似乎都不会消失。

你可以看到有一个简单的`main`函数，只需要一点代码。只有 15 行代码，但如果您查看它们在外部库中的错误，`stdio.h`. 其中`main`说第 11 行有一个错误，但没有任何意义。我认为这是一个 Eclipse 设置问题，但我不知道如何解决它。任何帮助将不胜感激。顺便说一句，我正在使用 SciLinux 和 Eclipse Indigo Service Release 2。谢谢 [![在此处输入图像描述](../Images/e755b2736b8c643fb4d5e8b5edb72193.png)](https://i.stack.imgur.com/KdXYO.png)

代码：

```
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
   int *ptr;
   int a;
   a = 20;
   ptr = &a;
   int b;
   b = *ptr;
   printf(" ptr is %d\n",b);
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T09:52:21.450

以前的一些编译器有这个与 C 有关的奇怪问题，它们只接受在函数开头声明的变量。

所以很可能错误是因为您没有在块的开头声明变量 b ，我建议您尝试使用不同的编译器或准备在开头声明所有变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T10:47:22.523

正如其他答案所说，在老式的普通 C 中混合代码和声明是非法的。请参阅：

[C 中的变量声明位置](https://stackoverflow.com/questions/288441/variable-declaration-placement-in-c)

[如何在 gcc 中强制执行 C89 风格的变量声明？](https://stackoverflow.com/questions/3099813/how-to-enforce-c89-style-variable-declarations-in-gcc)

在 Eclipse 中，使用的标准版本将取决于传递给 C 编译器 gcc 的编译器标志：-std=c89 或 -std=c99。根据项目的设置方式，将位于 Eclipse 项目属性或 Makefile 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T22:43:00.110

```
int *ptr;
int a;
int b; //<- move to block top declaration 
a = 20;
ptr = &a; 
```

# php - 正则表达式匹配

> ID：10058908
> 
> 赞同：0
> 
> 时间：2012-04-07T22:30:21.060
> 
> 标签：php, regex

t= **vjVQa1PpcFMYuRsz10_H-1z41mWWe8d6ENEnBLE7gug**

其中粗体区域是 42 个字符的标记

到目前为止，我正在使用这个 [^(t=)]\S{42}，但它匹配所有字符串，我如何让它只匹配来自这里查看源的源页面：http://www .youtube.com/watch?v=opQ9GzRe5qs

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:41:38.033

您链接到的页面似乎不包含您正在搜索的字符串？但是要匹配页面中任何位置的字符串，那么您需要...

```
/t=\S{42}/ 
```

我认为不需要字符类`[...]`或带括号的子模式......？

**编辑#1**

但是，如果您尝试提取该 42 字符标记，那么您*将*需要一个带括号的子模式......

```
/t=(\S{42})/ 
```

**编辑#2**

提取令牌的示例。我已将其从 42 个字符更改为 43 个字符，因为您的所有示例似乎都包含 43 个字符的标记。

```
// This is just some example text from which we want to extract the token...
$text = <<<EOD
SomeText=jkasdhHASGjajAHSKAK?asdjladljasdllkasdjllasdasdl
asdjasiSTARTHERE;t=vjVQa1PpcFMYuRsz10_H-1z41mWWe8d6ENEnBLE7gug%3DENDHEREasdasd
SomeMoreText;t=ThisIsTooShort%3Dklaksj
EOD;

if (preg_match('/;t=([a-zA-Z0-9_-]{43})%3D/',$text,$matches)) {
    // Match... vjVQa1PpcFMYuRsz10_H-1z41mWWe8d6ENEnBLE7gug
    echo 'TOKEN: '.$matches[1];
} else {
    // No match
} 
```

我已将模式更改为更具限制性，而不是任何非空格字符。它现在可以是任何字母、数字、下划线或连字符。它现在必须以 结尾`%3D`，并且在“t=”之前有一个分号（“;”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T22:46:18.337

我没有使用 php 的正则表达式引擎，但除非它违反 posix 标准并且地球上所有其他正则表达式引擎， `[^(t=)]`否则将匹配除 a `t`、`=`、`(`或之外的任何字符`)`。因此，您的正则表达式将匹配后跟 42 个非空白字符。它与您的字符串匹配，因为您实际上在令牌中有 43 个字符。你可能的意思是`^t=\S{43}$`，或者类似的东西，它可能取决于你用它做什么。

# java - 使用 GWT MVP 时在何处放置 SignIn 逻辑

> ID：10058911
> 
> 赞同：0
> 
> 时间：2012-04-07T22:30:59.770
> 
> 标签：java, gwt, gwt-mvp

我正在开发另一个 GWT 应用程序，但这次我使用的是 GWT 的 MVP Activity、Place 等类。我的问题是关于“他们是否已登录”检查的位置。

当用户使用包含“仪表板”令牌/位置的链接进入站点时，它将带他们到仪表板活动。但是，在他们可以使用 DashboardActivity 之前，他们必须先登录。处理此问题的最佳方法是什么？

1.) 在 AppActivityMapper 中放置逻辑。因此，在将地点转换为活动时，您可以在那里执行检查以查看它们是否已登录。如果他们未登录，则返回 SignInActivity 对象以及对令牌/地点的引用，以便在成功登录时返回。

- 或者 -

2.）按要求创建仪表板活动，但在仪表板活动中进行检查，如果他们未登录，则使用位置控制器转到登录页面？然后在成功登录后，将他们返回到地点历史中的上一个地点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T23:01:27.620

第一个选择更好：
您将在内存中创建和加载新对象之前进行检查，并花时间
直接检查用户是否已注册，如果已注册，则继续加载新对象，如果没有，您只需将他/她转发到登录页面。

# twitter-bootstrap - 如何更新 Twitter 引导程序

> ID：10058916
> 
> 赞同：3
> 
> 时间：2012-04-07T22:31:32.187
> 
> 标签：twitter-bootstrap

我使用了早期版本的 Bootstrap。有什么方法可以一次更新所有 Twitter Bootstrap 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T13:16:09.230

我在与“bootstrap.less”相同的目录中创建了一个“project.less”文件。“project.less”在第一行包含“bootstrap.less”。然后我根据需要覆盖添加或覆盖样式。我还修改了 variables.less 文件，但对我修改的项目有明确的注释。当我准备好生成我的 CSS 时，我在我的 project.less 文件上运行 lessc。这样做使我更容易升级到 2.1.1。-- 我刚刚替换了所有的引导程序文件，添加了我在“variables.less”中修改的样式，然后重新运行了lessc。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T15:16:55.917

最好的办法是访问[Bootstrap 的升级页面](http://twitter.github.com/bootstrap/upgrading.html)，看看哪些更改会影响您的实施。

在用新文件替换您的实际 bootstrap.css 和 bootstrap.js 文件后，对代码的许多更改将是简单的查找和替换修复。升级页面分解了升级需要更改的内容，并按部分细分，因此您只能使用与您相关的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T19:17:41.727

我最好的建议是查看 Bootstrap 页面，看看发生了什么变化。下载新文件并为您的项目创建一个分支（如果您使用的是 Git）并用新的 Bootstrap 文件替换旧文件。看看什么中断并尝试从那里开始工作。我知道这听起来很乏味，但它可能并不可怕，这取决于你首先使用了多少 Bootstrap。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T13:33:23.693

不确定，但是您将面临的问题是类名发生了很大变化……因此仅更新文件不会是最大的痛苦。

# java - 如何使用 JCheckbox 创建 JTree 以显示系统所有驱动器及其文件夹/文件

> ID：10058918
> 
> 赞同：1
> 
> 时间：2012-04-07T22:31:40.143
> 
> 标签：java, swing, jtree, jcheckbox

我是java的初学者。我正在创建一个文件选择器，它可以一次选择多个驱动器、文件夹或文件以进行蠕虫扫描。我编写的代码可以在单个驱动器上正常工作（例如 c:\ 或 e:\ 等）。我正在尝试为系统中的所有驱动器创建一棵树。请告诉我如何做到这一点。

代码

```
 import javax.swing.*;
    import javax.swing.event.*;
    import javax.swing.tree.*;
    import java.io.File;
    import java.util.Collections;
    import java.util.Vector;

    public class FileTreeDemo {
    public static void main(String[] args) {
    try{                                              
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        }catch(Exception e){
    System.out.println("cant done"); 
    }
    // Create a JTree and tell it to display our model
    JTree tree = new JTree();

    // The JTree can get big, so allow it to scroll
    JScrollPane scrollpane = new JScrollPane(tree);
    // Figure out where in the filesystem to start displaying       
    File[] roots = File.listRoots();  
    FileTreeModel model = new FileTreeModel(null); 
    model = new FileTreeModel(roots[0]);
    tree.setModel(model);
    CheckTreeManager checkTreeManager = new CheckTreeManager(tree); 
    TreePath checkedPaths[]=checkTreeManager.getSelectionModel().getSelectionPaths();
    int j = checkedPaths.length;
    System.out.println("Tree Path :"+j);
    for(int i=0; i<checkedPaths.length;i++){
    System.out.println("Tree Path :"+checkedPaths[i]);
    }
    // Display it all in a window and make the window appear
    JFrame frame = new JFrame("FileTreeDemo");
    frame.getContentPane().add(scrollpane, "Center");
    frame.setSize(400,600);
    frame.setVisible(true);
    }  
    }

    import java.io.File;
    import javax.swing.event.TreeModelListener;
    import javax.swing.tree.DefaultTreeSelectionModel;
    import javax.swing.tree.TreeModel;
    import javax.swing.tree.TreePath;
    import javax.swing.tree.TreeSelectionModel;

    public class FileTreeModel  extends DefaultTreeSelectionModel implements TreeModel{
    // We specify the root directory when we create the model.

    protected File root;
    public FileTreeModel(File root) { this.root = root; 
    //setSelectionMode(TreeSelectionModel.DISCONTIGUOUS_TREE_SELECTION); 
    }

    // The model knows how to return the root object of the tree
    public Object getRoot() { return root; }

    // Tell JTree whether an object in the tree is a leaf
    public boolean isLeaf(Object node) {  return ((File)node).isFile(); }

    // Tell JTree how many children a node has
    public int getChildCount(Object parent) {
    String[] children = ((File)parent).list();
    if (children == null) return 0;
    return children.length;
    }

    // Fetch any numbered child of a node for the JTree.
    // Our model returns File objects for all nodes in the tree.  The
    // JTree displays these by calling the File.toString() method.
    public Object getChild(Object parent, int index) {
    String[] children = ((File)parent).list();
    if ((children == null) || (index >= children.length)) return null;
    return new File((File) parent, children[index]);
    }

    // Figure out a child's position in its parent node.
    public int getIndexOfChild(Object parent, Object child) {
    String[] children = ((File)parent).list();
    if (children == null) return -1;
    String childname = ((File)child).getName();
    for(int i = 0; i < children.length; i++) {
    if (childname.equals(children[i])) return i;
    }
     return -1;
    }

    // This method is invoked by the JTree only for editable trees.  
    // This TreeModel does not allow editing, so we do not implement 
    // this method.  The JTree editable property is false by default.
    public void valueForPathChanged(TreePath path, Object newvalue) {}

    // Since this is not an editable tree model, we never fire any events,
    // so we don't actually have to keep track of interested listeners*/
    public void addTreeModelListener(TreeModelListener l) {}
    public void removeTreeModelListener(TreeModelListener l) {}
    }

    import javax.swing.*;
    import javax.swing.event.ChangeListener;
    import javax.swing.plaf.ActionMapUIResource;
    import java.awt.event.*;
    import java.awt.*;

    /**
    * Maintenance tip - There were some tricks to getting this code
    * working:
    *
    * 1\. You have to overwite addMouseListener() to do nothing
    * 2\. You have to add a mouse event on mousePressed by calling
    * super.addMouseListener()
    * 3\. You have to replace the UIActionMap for the keyboard event
    * "pressed" with your own one.
    * 4\. You have to remove the UIActionMap for the keyboard event
    * "released".
    * 5\. You have to grab focus when the next state is entered,
    * otherwise clicking on the component won't get the focus.
    * 6\. You have to make a TristateDecorator as a button model that
    * wraps the original button model and does state management.
    */
    public class TristateCheckBox extends JCheckBox{
    private final TristateDecorator model;

    public TristateCheckBox(String text, Icon icon, Boolean initial){
    super(text, icon);
    // Add a listener for when the mouse is pressed
    super.addMouseListener(new MouseAdapter(){
    public void mousePressed(MouseEvent e){
    grabFocus();
    model.nextState();
    }
    });

    import java.awt.BorderLayout;
    import java.awt.Component;
    import javax.swing.JCheckBox;
    import javax.swing.JPanel;
    import javax.swing.JTree;
    import javax.swing.tree.TreeCellRenderer;
    import javax.swing.tree.TreePath;

    public class CheckTreeCellRenderer extends JPanel implements TreeCellRenderer{ 
    private CheckTreeSelectionModel selectionModel; 
    private TreeCellRenderer delegate; 
    private TristateCheckBox checkBox = new TristateCheckBox(); 
    public CheckTreeCellRenderer(TreeCellRenderer delegate, CheckTreeSelectionModel selectionModel){ 
    this.delegate = delegate; 
    this.selectionModel = selectionModel; 
    setLayout(new BorderLayout()); 
    setOpaque(false); 
    checkBox.setOpaque(false); 
    } 

    public Component getTreeCellRendererComponent(JTree tree, Object value, boolean  selected, boolean expanded, boolean leaf, int row, boolean hasFocus){ 
    Component renderer = delegate.getTreeCellRendererComponent(tree, value, selected, expanded, leaf, row, hasFocus);  
    TreePath path = tree.getPathForRow(row); 
    if(path!=null){ 
    if(selectionModel.isPathSelected(path, true)) 
    checkBox.setState(Boolean.TRUE); 
    else 
    checkBox.setState(selectionModel.isPartiallySelected(path) ? null : Boolean.FALSE); 
    } 
    removeAll(); 
    add(checkBox, BorderLayout.WEST); 
    add(renderer, BorderLayout.CENTER); 
    return this; 
    ![enter image description here][1]} 
    }
    // Reset the keyboard action map
    ActionMap map = new ActionMapUIResource();
    map.put("pressed", new AbstractAction(){      //NOI18N
    public void actionPerformed(ActionEvent e){
    grabFocus();
    model.nextState();
    }
    });
    map.put("released", null);                     //NOI18N
    SwingUtilities.replaceUIActionMap(this, map);
    // set the model to the adapted model
    model = new TristateDecorator(getModel());
    setModel(model);
    setState(initial);
    }

    public TristateCheckBox(String text, Boolean initial){
    this(text, null, initial);
    }

    public TristateCheckBox(String text){
    this(text, null);
    }

    public TristateCheckBox(){
    this(null);
    }

    /** No one may add mouse listeners, not even Swing! */
    public void addMouseListener(MouseListener l){}

    /**
    * Set the new state to either SELECTED, NOT_SELECTED or
    * DONT_CARE.  If state == null, it is treated as DONT_CARE.
    */
    public void setState(Boolean state){
    model.setState(state);
    }

    /** Return the current state, which is determined by the
    * selection status of the model. */
    public Boolean getState(){
    return model.getState();
    }

    /**
    * Exactly which Design Pattern is this?  Is it an Adapter,
    * a Proxy or a Decorator?  In this case, my vote lies with the
    * Decorator, because we are extending functionality and
    * "decorating" the original model with a more powerful model.
    */
    private class TristateDecorator implements ButtonModel{
    private final ButtonModel other;
    private TristateDecorator(ButtonModel other){
    this.other = other;
    }

    private void setState(Boolean state){
    if(state==Boolean.FALSE){
    other.setArmed(false);
    setPressed(false);
    setSelected(false);
    } else if(state==Boolean.TRUE){
    other.setArmed(false);
    setPressed(false);
    setSelected(true);
    }
    else{
    other.setArmed(true);
    setPressed(true);
    setSelected(true);
    }
    }

    /**
    * The current state is embedded in the selection / armed
    * state of the model.
    *
    * We return the SELECTED state when the checkbox is selected
    * but not armed, DONT_CARE state when the checkbox is
    * selected and armed (grey) and NOT_SELECTED when the
    * checkbox is deselected.
    */
    private Boolean getState(){
    if(isSelected() && !isArmed()){
    // normal black tick
    return Boolean.TRUE;
    } else if(isSelected() && isArmed()){
    // don't care grey tick
    return null;
    } else{
    // normal deselected
    return Boolean.FALSE;
    }
    }

    /** We rotate between NOT_SELECTED, SELECTED and DONT_CARE.*/
    private void nextState(){
    Boolean current = getState();
    if(current == Boolean.FALSE){
    setState(Boolean.TRUE);
    } else if(current == Boolean.TRUE){
    setState(null);
    } else if(current == null){
    setState(Boolean.FALSE);
    }
    }

    /** Filter: No one may change the armed status except us. */
    public void setArmed(boolean b){
    }
    public boolean isFocusTraversable() {
    return isEnabled();
    }

    /** We disable focusing on the component when it is not
    * enabled. */
    public void setEnabled(boolean b){
    //            setFocusable(b);
    other.setEnabled(b);
    }

    /** All these methods simply delegate to the "other" model
    * that is being decorated. */
    public boolean isArmed(){return other.isArmed();
    }
    public boolean isSelected(){return other.isSelected();
    }
    public boolean isEnabled(){return other.isEnabled();
    }
    public boolean isPressed(){return other.isPressed();
    }
    public boolean isRollover(){return other.isRollover();
    }
    public void setSelected(boolean b){other.setSelected(b);
    }
    public void setPressed(boolean b){other.setPressed(b);
    }
    public void setRollover(boolean b){other.setRollover(b);
    }
    public void setMnemonic(int key){other.setMnemonic(key);
    }
    public int getMnemonic(){return other.getMnemonic();
    }
    public void setActionCommand(String s){other.setActionCommand(s);
    }
    public String getActionCommand(){return other.getActionCommand();
    }
    public void setGroup(ButtonGroup group){other.setGroup(group);
    }
    public void addActionListener(ActionListener l){other.addActionListener(l);
    }
    public void removeActionListener(ActionListener l){other.removeActionListener(l);
    }
    public void addItemListener(ItemListener l){other.addItemListener(l);
    }
    public void removeItemListener(ItemListener l){other.removeItemListener(l);
    }
    public void addChangeListener(ChangeListener l){other.addChangeListener(l);
    }
    public void removeChangeListener(ChangeListener l){other.removeChangeListener(l);
    }
    public Object[] getSelectedObjects(){return other.getSelectedObjects();
    }
    }

    import java.awt.event.MouseAdapter;
    import java.awt.event.MouseEvent;
    import javax.swing.JCheckBox;
    import javax.swing.JTree;
    import javax.swing.event.TreeSelectionEvent;
    import javax.swing.event.TreeSelectionListener;
    import javax.swing.tree.TreePath;

    public class CheckTreeManager extends MouseAdapter implements TreeSelectionListener{ 
    private CheckTreeSelectionModel selectionModel; 
    private JTree tree = new JTree(); 
    int hotspot = new JCheckBox().getPreferredSize().width; 

    public CheckTreeManager(JTree tree){ 
    this.tree = tree; 
    selectionModel = new CheckTreeSelectionModel(tree.getModel()); 
    tree.setCellRenderer(new CheckTreeCellRenderer(tree.getCellRenderer(), selectionModel)); 
    tree.addMouseListener(this); 
    selectionModel.addTreeSelectionListener(this); 
    } 

    public void mouseClicked(MouseEvent me){ 
    TreePath path = tree.getPathForLocation(me.getX(), me.getY()); 
    if(path==null) 
    return; 
    if(me.getX()>tree.getPathBounds(path).x+hotspot) 
    return; 

    boolean selected = selectionModel.isPathSelected(path, true); 
    selectionModel.removeTreeSelectionListener(this); 

    try{ 
    if(selected) 
    selectionModel.removeSelectionPath(path); 
    else 
    selectionModel.addSelectionPath(path); 
    System.out.println("Tree Path :"+path);
    } finally{ 
        selectionModel.addTreeSelectionListener(this); 
        tree.treeDidChange(); 
    } 
    } 

    public CheckTreeSelectionModel getSelectionModel(){return selectionModel; 
    } 
    public void valueChanged(TreeSelectionEvent e){tree.treeDidChange(); 
    }
} 

    public static void main(String args[]) throws Exception{
    UIManager.setLookAndFeel(
            UIManager.getSystemLookAndFeelClassName());
    JFrame frame = new JFrame("TristateCheckBoxTest");     //NOI18N
    frame.getContentPane().setLayout(new GridLayout(0, 1, 5, 5));
    final TristateCheckBox swingBox = new TristateCheckBox(
            "Testing the tristate checkbox");  //NOI18N
    swingBox.setMnemonic('T');
    frame.getContentPane().add(swingBox);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.pack();
    frame.setVisible(true);
    }
    }

    import java.util.ArrayList;
    import java.util.Stack;
    import javax.swing.tree.*;

    public class CheckTreeSelectionModel extends DefaultTreeSelectionModel{ 
    private TreeModel model; 
//FileTreeModel model;

    public CheckTreeSelectionModel(TreeModel model){ 
    this.model = model; 
    setSelectionMode(TreeSelectionModel.DISCONTIGUOUS_TREE_SELECTION); 
    } 

    // tests whether there is any unselected node in the subtree of given path 
    public boolean isPartiallySelected(TreePath path){ 
    if(isPathSelected(path, true)) 
        return false; 
    TreePath[] selectionPaths = getSelectionPaths(); 
    if(selectionPaths==null) 
    return false; 
    for(int j = 0; j<selectionPaths.length; j++){ 
    if(isDescendant(selectionPaths[j], path)) 
    return true; 
    } 
    return false; 
    } 

    // tells whether given path is selected. 
    // if dig is true, then a path is assumed to be selected, if 
    // one of its ancestor is selected. 
    public boolean isPathSelected(TreePath path, boolean dig){ 
    if(!dig) 
       return super.isPathSelected(path); 
    while(path!=null && !super.isPathSelected(path)) 
    path = path.getParentPath(); 
    return path!=null; 
    } 

    // is path1 descendant of path2 
    private boolean isDescendant(TreePath path1, TreePath path2){ 
    Object obj1[] = path1.getPath(); 
    Object obj2[] = path2.getPath(); 
    for(int i = 0; i<obj2.length; i++){ 
    if(obj1[i]!=obj2[i]) 
    return false; 
    } 
    return true; 
    } 

    public void setSelectionPaths(TreePath[] pPaths){ 
    throw new UnsupportedOperationException("not implemented yet!!!"); 
    } 

    public void addSelectionPaths(TreePath[] paths){ 
    // unselect all descendants of paths[] 
    for(int i = 0; i<paths.length; i++){ 
        TreePath path = paths[i]; 
        TreePath[] selectionPaths = getSelectionPaths(); 
        if(selectionPaths==null) 
            break; 
        ArrayList toBeRemoved = new ArrayList(); 
        for(int j = 0; j<selectionPaths.length; j++){ 
            if(isDescendant(selectionPaths[j], path)) 
                toBeRemoved.add(selectionPaths[j]); 
        } 
        super.removeSelectionPaths((TreePath[])toBeRemoved.toArray(new TreePath[0])); 
    } 

    // if all siblings are selected then unselect them and select parent recursively 
    // otherwize just select that path. 
    for(int i = 0; i<paths.length; i++){ 
        TreePath path = paths[i]; 
        TreePath temp = null; 
        while(areSiblingsSelected(path)){ 
            temp = path; 
            if(path.getParentPath()==null) 
                break; 
            path = path.getParentPath(); 
        } 
        if(temp!=null){ 
            if(temp.getParentPath()!=null) 
                addSelectionPath(temp.getParentPath()); 
            else{ 
                if(!isSelectionEmpty()) 
                    removeSelectionPaths(getSelectionPaths()); 
                super.addSelectionPaths(new TreePath[]{temp}); 
            } 
        }else 
            super.addSelectionPaths(new TreePath[]{ path}); 
      } 
    } 

    // tells whether all siblings of given path are selected. 
     private boolean areSiblingsSelected(TreePath path){ 
    TreePath parent = path.getParentPath(); 
    if(parent==null) 
        return true; 
    Object node = path.getLastPathComponent(); 
    Object parentNode = parent.getLastPathComponent(); 

    int childCount = model.getChildCount(parentNode); 
    for(int i = 0; i<childCount; i++){ 
        Object childNode = model.getChild(parentNode, i); 
        if(childNode==node) 
            continue; 
        if(!isPathSelected(parent.pathByAddingChild(childNode))) 
            return false; 
    } 
    return true; 
    } 

    public void removeSelectionPaths(TreePath[] paths){ 
    for(int i = 0; i<paths.length; i++){ 
        TreePath path = paths[i]; 
        if(path.getPathCount()==1) 
            super.removeSelectionPaths(new TreePath[]{ path}); 
        else 
            toggleRemoveSelection(path); 
    } 
   } 

   // if any ancestor node of given path is selected then unselect it 
     //  and selection all its descendants except given path and descendants. 
    // otherwise just unselect the given path 
     private void toggleRemoveSelection(TreePath path){ 
    Stack stack = new Stack(); 
    TreePath parent = path.getParentPath(); 
    while(parent!=null && !isPathSelected(parent)){ 
        stack.push(parent); 
        parent = parent.getParentPath(); 
    } 
    if(parent!=null) 
        stack.push(parent); 
    else{ 
        super.removeSelectionPaths(new TreePath[]{path}); 
        return; 
    } 

    while(!stack.isEmpty()){ 
        TreePath temp = (TreePath)stack.pop(); 
        TreePath peekPath = stack.isEmpty() ? path : (TreePath)stack.peek(); 
        Object node = temp.getLastPathComponent(); 
        Object peekNode = peekPath.getLastPathComponent(); 
        int childCount = model.getChildCount(node); 
        for(int i = 0; i<childCount; i++){ 
            Object childNode = model.getChild(node, i); 
            if(childNode!=peekNode) 
                super.addSelectionPaths(new TreePath[]  {temp.pathByAddingChild(childNode)}); 
       } 
       } 
    super.removeSelectionPaths(new TreePath[]{parent}); 
    } 
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:18:54.070

**put following code in the main in comment and run it again then you will see where is problem and start to debug it.**

```
 CheckTreeManager checkTreeManager = new CheckTreeManager(tree);
    TreePath checkedPaths[]=checkTreeManager.getSelectionModel().getSelectionPaths();
    int j = checkedPaths.length;
    System.out.println("Tree Path :"+j);

    for(int i=0; i<checkedPaths.length;i++){
        System.out.println("Tree Path :"+checkedPaths[i]);
    } 
```

# jquery - 为什么我的动态添加（和按钮 A 替换）按钮 B 被 jQuery 点击？

> ID：10058919
> 
> 赞同：-4
> 
> 时间：2012-04-07T22:31:41.987
> 
> 标签：jquery, button, dynamic, replace

这是我的问题：

1.  用户点击*按钮 A*。
2.  这会触发一个 jQuery 动画隐藏*按钮 A*。
3.  完成此动画后，*按钮 B*将通过 jQuery 动画显示在完全相同的位置。
4.  jQuery 就像*按钮 B*被点击一样。

这对我来说似乎很奇怪，并导致糟糕的用户体验。谁能帮我解决这个问题？这是 javascript 代码，虽然我认为这是 jQuery 的一般问题：

```
function showbuttonB(element){
   $(element).animate({ opacity: '0', marginRight: '-50px'}, 230, function(){
      $(element).append("<span class='buttonB'><a href='mailto:XXXXXXXX'><div class='icon'>ButtonB</div></a></span>");
      $(element).find('.buttonB').animate({
         display: 'toggle',
         marginRight: '0px'
      }, 230);
   });
}

$(".buttonA").live('touchend mouseup', function() {
  showbuttonB(this);
}); 
```

和 HTML：

```
<div class="buttonA">ButtonA</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T00:05:26.480

它不像 bButton 被单击，问题是新按钮位于隐藏元素内。

检查[**这个工作小提琴**](http://jsfiddle.net/gBwrG/3/)

### 代码：

```
function showbuttonB(element) {
    $(element).animate({
        opacity: '0',
        marginRight: '-50px'
    }, 230, function() {
        $('#foo').append("<span class='buttonB'><a href='mailto:XXXXXXXX'><div class='icon'>ButtonB</div></a></span>");
        $('#foo').find('.buttonB').animate({
            display: 'toggle',
            marginRight: '0px'
        }, 230);
    });
}

$(".buttonA").live('touchend mouseup', function() {
    showbuttonB(this);
});​ 
```

**HTML：**

```
<div class="buttonA">ButtonA</div>
<span id="foo"> </span> 
```

​</p>

# javascript - 用连字符验证 Javascript 中的电话号码

> ID：10058922
> 
> 赞同：0
> 
> 时间：2012-04-07T22:33:22.767
> 
> 标签：javascript

好的，所以我在过去 2 小时内尝试验证电话号码脚本，但我似乎无法弄清楚为什么这不起作用。最大长度是 12，我已经有一个 if 语句，它有效。

格式必须是：nnn-nnn-nnnn

```
 var tele = document.pizza.field03;  //store phone number
         var fone = tele.value               //store values of variable tele in fone
         var acode = "";                    
         var midnum = "";                    
         var lasnum = "";                    
         var hyphen = "";                  
         var hyphen2 ="";                        

   acode=fone.substr(0,3);
   hyphen=fone.substr(3,4);
   midnum=fone.substr(4,7);
   hyphen2=fone.substr(7,8);
   lasnum=fone.substr(8);

       else if (isNaN(acode) )
         {
           errMessages += "<li>Please use integer numbers only</li>\n";
           errMessages += "<li>ex: 1 2 3 4 5 </li>\n";
         }

       else if (isNaN(midnum) )
         {
           errMessages += "<li>Please use integer numbers only</li>\n";
           errMessages += "<li>ex: 1 2 3 4 5 </li>\n";
         }

       else if (isNaN(lasnum) )
         {
           errMessages += "<li>Please use integer numbers only</li>\n";
           errMessages += "<li>ex: 1 2 3 4 5 </li>\n";
         } 
```

***编辑********

```
else if (hyphen.indexOf('-') ==-1)                  //checking for hyphen
     {
       errMessages += "<li>You need a hyphen after the area code</li>\n"
       errMessages += "<li>ex: areacode-nnn-nnn</li>\n"
     }

   else if (hyphen2.indexOf('-') ==-1)
     {
       errMessages += "<li>You need a hyphen after the middle 3 digits</li>\n";
       errMessages += "<li>ex: 416-mid-1234</li>\n";
     } 
```

发生的事情是无论我使用数字还是字母，它都会不断弹出错误窗口。

如果可能的话，我想学习如何在不使用 RegEx 的情况下做到这一点。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T22:38:06.990

```
acode=fone.substr(0,3);
hyphen=fone.substr(3,4);
midnum=fone.substr(4,7);
hyphen2=fone.substr(7,8);
lasnum=fone.substr(8); 
```

第二个参数指定所取字符串的*长度*，而不是“结束位置”。（[见参考](http://www.w3schools.com/jsref/jsref_substr.asp "W3Schools JS：substr")）

您的变量会出现值“nnn”、“-nnn”、“nnn-nnnn”、“-nnnn”和“nnnn”。

```
acode=fone.substr(0,3);
hyphen=fone.substr(3,1);
midnum=fone.substr(4,3);
hyphen2=fone.substr(7,1);
lasnum=fone.substr(8); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T22:42:00.040

的语法`substr`是`string.substr(start,length)`.

但是，您似乎是用`string.substr(start,end)`.

请参阅[此处](http://www.w3schools.com/jsref/jsref_substr.asp)了解更多详细信息

# visual-studio-2010 - 如何使数据访问相关功能在我的 Visual Studio 2010 安装上工作？

> ID：10058930
> 
> 赞同：0
> 
> 时间：2012-04-07T22:36:20.517
> 
> 标签：visual-studio-2010, compact-framework, sql-server-ce, sql-server-2008-r2

（对不起，如果这应该在其他地方问）

每次我想从我的 VS 安装中访问一些与数据相关的功能时，我都会收到以下错误消息：

![](../Images/7af5600c0d752d8d833cdbd7230cb4d1.png)

要么重新连接我选择的 ORM，要么通过*Server Explorer*直观地测试数据库连接等。

我到底应该在这里重新安装什么？

我确实安装了*Compact Framework*，以防万一这里列出了在此环境中安装的相关程序和功能。

![在此处输入图像描述](../Images/a1aff87db6fb6d67fbc32d13eeb3ff20.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T13:05:34.683

您需要“适用于 SQL Server Compact 4.0 的 Visual Studio 2010 SP1 工具”和 3.5 相同（假设它们已经安装） - 请参阅[http://erikej.blogspot.com/2011/01/sql-server-compact-40-发布.html](http://erikej.blogspot.com/2011/01/sql-server-compact-40-released.html)

# python - 在 s 字符串中查找浮点数 - Python

> ID：10058933
> 
> 赞同：1
> 
> 时间：2012-04-07T22:36:56.370
> 
> 标签：python, string, floating-point

这个希望很简单，我有一个字符串*"voltage is E=200V and the current is I=4.5A"*。我需要提取两个浮点值。我尝试使用 float() 函数（参数中的子字符串为 11 到 16），但出现错误。我意识到这可能不是好的编码，我正处于尝试学习 Python 的开始阶段。任何帮助深表感谢。

编辑：这是代码

```
I = 0.0     
if((currentString.find('I=')) != -1):
            I = float(currentString[(currentString.find('I=')):(currentString.find('A'))]) 
```

再说一次，我不熟悉这种语言，我知道这看起来很难看。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T22:50:25.483

我不愿提及正则表达式，因为它对于新手来说通常是一个令人困惑的工具，但为了您的使用和参考，这里有一个片段可以帮助您获得这些值。IIRC 电压不太可能是浮动的（而不是 int？），因此此匹配操作稍后会返回 int，但如果确实需要，则可以是浮动的。

```
>>> import re
>>> regex = re.compile(r'.*?E=([\d.]+).*?I=([\d.]+)')
>>> re.match('voltage is E=200V and the current is I=4.5A')
>>> matches = regex.match('voltage is E=200V and the current is I=4.5A')
>>> int(matches.group(1))
200
>>> float(matches.group(2))
4.5 
```

使用更简单的工具提取此类数字的方法是：

```
>>> s.find('E=')
11
>>> s.find('V', 11)
16
>>> s[11:16]
'E=200'
>>> s[11+2:16]
'200'
>>> int(s[11+2:16])
200 
```

# python - Python pprint()：我可以格式化数组中的项目吗？

> ID：10058934
> 
> 赞同：0
> 
> 时间：2012-04-07T22:36:56.553
> 
> 标签：python, pprint

我有一个二维数字数组，比如

```
[[1, 123, 2], [22, 4567, 33], [0, 0, 0]] 
```

我想在调试会话中打印。列对齐会很有用。

有没有办法告诉`pprint`对数字使用特定的打印格式（例如`'%4d'`）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T23:15:50.947

如果你没有设置 pprint 那么，

```
>>> masterList = [[1, 123, 2], [22, 4567, 33], [0, 0, 0]]
>>> print "\n".join("\t".join(["{0:04d}".format(num) for num in subList]) for subList in masterList)
0001    0123    0002
0022    4567    0033
0000    0000    0000
>>> 
```

否则请参阅 Acorn 的评论。

# android - 如何在完成线程之前确认任务是否完成？

> ID：10058937
> 
> 赞同：1
> 
> 时间：2012-04-07T22:37:29.877
> 
> 标签：android, multithreading, splash-screen

我正在为我的应用程序从服务器获取数据。“getData”函数包含在应用程序的主 Activity 中，位于启动线程中。我遇到的问题是这样的：

如果我在加载应用程序后快速输入新闻或描述，我注意到并非所有信息都已加载（需要保存的最后 2 或 3 个字符串为空）。但是，如果我在显示主菜单后（完成启动线程后）再允许应用程序几秒钟，则不会发生问题，所有信息都正确存储在手机上。我尝试将启动画面延迟几秒钟，但这并不是一个真正优雅的解决方案，也并不总是有效。

我的问题是如何确保功能在跳转到“最终”之前已经完成

我没有将数据存储在任何数据库中，只是存储在另一个类的公共静态字符串数组中。

您在下面有我的代码：

```
if(networkAvailable()){
        Thread splashTread = new Thread() {
            @Override
            public void run() {
                try {

                    getData.execute(description_Hyperlinks);
                    getNews.execute(new String[]{newsJSON_Hyperlink});
                    getOffers.execute(new String[]{offersJSON_Hyperlink});

                    for(int i = 0; i<3; i++)
                        Thread.sleep(1000);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } finally {
                    finish();
                    startActivity(new Intent(FlexFormActivity.this, MainMenu.class));
                    stop();
                }
            }
        };
        splashTread.start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T23:52:46.687

*为了使最初问题的评论中的讨论更具可读性和物理可见性*

* * *

[`AsyncTask`以-class](http://developer.android.com/reference/android/os/AsyncTask.html)的形式使用 Android 对异步任务处理的内置支持会是一个更好的主意。这使您可以“参与”任务，让您有机会对进度的不同阶段做出反应。

这个想法不是 make`getData`和每个 extend `getNews`，而是有一个单独的任务（例如，称为“LoadContents”），它一个接一个地加载数据、新闻和报价。`getOffers``AsyncTask`

然后可以确定整个初始工作何时完成，这使得以您可以想象的任何形式对这个“任务完成”做出反应变得容易。

* * *

作为一个小的代码审查，通常永远不需要使用`Thread`-class 本身，因为 Java 和 Android 提供了许多围绕它的包装器（特别是[Java Executor Framework](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Executor.html)），为了产生更干净和可靠的效果，应该受到青睐代码。

* * *

此外，作为关于“禁用后退按钮”（@Eugen 使用它来确保启动画面保持存在）的一般建议：*不*要这样做。这不是用户在使用应用程序时所期望的那种行为。

想象一下有人打开了一个应用程序，初始加载内容需要大约 10 秒，并且这个过程无法取消。用户将不得不等待整个时间，然后才离开应用程序而不使用它。

因此，您不应“停用”后退按钮，而应使您的任务（以及因此应用程序的初始加载）“可取消”。使用时`AsyncTask`，这已经为您实现了。

# c++ - 使用 clang/LLVM 通过 LDFLAGS 链接 .dylib

> ID：10058939
> 
> 赞同：0
> 
> 时间：2012-04-07T22:38:02.793
> 
> 标签：c++, ios

我收到一个错误。

源文件参考之一：

```
#include <libxml/parser.h> 
```

我正在使用下面的 Makefile，试图链接：

```
LDFLAGS =-l../../usr/local/sys/usr/lib/libxml2.dylib 
```

路径似乎是正确的，并且文件在那里。

来自 IDE 的错误详细信息：http: [//clip2net.com/clip/m0/1333837472-clip-29kb.png](http://clip2net.com/clip/m0/1333837472-clip-29kb.png) [http://clip2net.com/clip/m0/1333837744-clip-32kb.png](http://clip2net.com/clip/m0/1333837744-clip-32kb.png)

我究竟做错了什么？

```
#############################################################################
# Makefile for iPhone application (X)
#############################################################################

# Define here the name of your project's main executable, and the name of the
# build directory where the generated binaries and resources will go.
NAME    = X
OUTDIR  = X.app

# Define here the minimal iOS version's MAJOR number (iOS3, iOS4 or iOS5)
IOSMINVER = 5

# List here your project's resource files. They can be files or directories.
RES = Info.plist icon.png

# Define here the compile options and the linker options for your project.
CFLAGS  = -W -Wall -O2 -Icocos2dx/include -Icocos2dx/platform -Icocos2dx/platform/ios -Icocos2dx/effects -Icocos2dx/cocoa -Icocos2dx/support -Icocos2dx/support/image_support -Icocos2dx/support/data_support -Icocos2dx/support/zip_support -Icocos2dx/extensions -Icocos2dx
LDFLAGS =-l../../usr/local/sys/usr/lib/libxml2.2.dylib

#############################################################################
# Except for specific projects, you shouldn't need to change anything below
#############################################################################

# Define which compiler to use and what are the mandatory compiler and linker
# options to build stuff for iOS. Here, use the ARM cross-compiler for iOS,
# define IPHONE globally and link against all available frameworks.
CC  = clang
LD  = link
CFLAGS  += -ccc-host-triple arm-apple-darwin -march=armv6 --sysroot ../../usr/local/sys -integrated-as -fdiagnostics-format=msvc -fconstant-cfstrings -DIPHONE -D__IPHONE_OS_VERSION_MIN_REQUIRED=$(IOSMINVER)0000
LDFLAGS += -lstdc++ $(addprefix -framework , $(notdir $(basename $(wildcard /Frameworks/iOS$(IOSMINVER)/*))))

# List here your source files. The current rule means: ask the shell to build
# a one-liner list of all files in the current directory and its subdirectories
# ending with either .c, .cc, .cpp, .cxx, .m, .mm, .mx or .mxx.
SRC = $(shell find . \( -name "*.c" -o -name "*.cc" -o -name "*.cpp" -o -name "*.cxx" -o -name "*.m" -o -name "*.mm" -o -name "*.mx" -o -name "*.mxx" \) -printf '%p ')

# Define where the object files should go - currently, just aside the source
# files themselves. We take the source file's basename and just append .o.
OBJ = $(addsuffix .o, $(basename $(SRC)))

###################
# Rules definitions

# This rule is the default rule that is called when you type "make". It runs
# the specified other rules in that order: removing generated output from
# previous builds, compiling all source files into object files, linking them
# all together, codesigning the generated file, copying resources in place
# and then displaying a success message.
all:    prune $(OBJ) link codesign resources checksum ipa deb end

# The following rule removes the generated output from any previous builds
prune:
    @echo " + Pruning compilation results..."
    @rm -f $(OUTDIR)/$(NAME)

# The following rules compile any .c/.cc/.cpp/.cxx/.m/.mm/.mx/.mxx file it
# finds in object files (.o). This is to handle source files in different
# languages: C/C++ (with .c* extension), and Objective-C (.m*).
%.o:    %.c
    @echo " + Compiling $<..."; $(CC) $(CFLAGS) -o $@ -c $<
%.o:    %.cc
    @echo " + Compiling $<..."; $(CC) $(CFLAGS) -o $@ -c $<
%.o:    %.cpp
    @echo " + Compiling $<..."; $(CC) $(CFLAGS) -o $@ -c $<
%.o:    %.cxx
    @echo " + Compiling $<..."; $(CC) $(CFLAGS) -o $@ -c $<
%.o:    %.m
    @echo " + Compiling $<..."; $(CC) $(CFLAGS) -o $@ -c $<
%.o:    %.mm
    @echo " + Compiling $<..."; $(CC) $(CFLAGS) -o $@ -c $<
%.o:    %.mx
    @echo " + Compiling $<..."; $(CC) $(CFLAGS) -o $@ -c $<
%.o:    %.mxx
    @echo " + Compiling $<..."; $(CC) $(CFLAGS) -o $@ -c $<

# The following rule first ensures the output directory exists, creates it if
# necessary, then links the compiled .o files together in that directory
link:
    @echo " + Linking project files..."
    @test -d $(OUTDIR) || mkdir -p $(OUTDIR)
    @$(LD) $(LDFLAGS) -o $(OUTDIR)/$(NAME) $(OBJ)

# The following rule calls Saurik's ldid code pseudo-signing tool to generate
# the SHA checksums needed for the generated binary to run on jailbroken iOS.
codesign:
    @echo " + Pseudo-signing code..."
    @ldid -S $(OUTDIR)/$(NAME)
    @rm -f $(OUTDIR)/.$(NAME).cs

# The following rule takes all the specified resource items one after the
# other (whether they are files or directories) ; files are copied in place
# and directories are recursively copied only if they don't exist already.
resources:
    @echo " + Copying resources..."
    @for item in $(RES); do \
        if [ -d $$item ]; then test -d $(OUTDIR)/$$item || cp -r $$item $(OUTDIR)/; chmod +r $(OUTDIR)/$$item; \
        else cp $$item $(OUTDIR)/; chmod +r $(OUTDIR)/$$item; \
        fi; \
    done
    @chmod +x $(OUTDIR)
    @chmod -R +r $(OUTDIR)
    @chmod +x $(OUTDIR)/$(NAME)

# The following rule takes all files in the target directory and builds the
# _CodeSignature/CodeResource XML file with their SHA1 hashes.
checksum:
    @echo " + Generating _CodeSignature directory..."
    @echo -n APPL???? > $(OUTDIR)/PkgInfo
    @codesigner $(OUTDIR) > .CodeResources.$(NAME)
    @test -d $(OUTDIR)/_CodeSignature || mkdir -p $(OUTDIR)/_CodeSignature
    @mv .CodeResources.$(NAME) $(OUTDIR)/_CodeSignature/CodeResources
    @test -L $(OUTDIR)/CodeResources || ln -s _CodeSignature/CodeResources $(OUTDIR)/CodeResources

# The following rule builds an IPA file out of the compiled app directory.
ipa:
    @echo " + Building iTunes package..."
    @test -d Packages || mkdir Packages
    @rm -f Packages/$(NAME).ipa
    @test -d Payload || mkdir Payload
    @mv -f $(OUTDIR) Payload
    @cp -f iTunesArtwork.jpg iTunesArtwork
    @chmod +r iTunesArtwork
    @zip -y -r Packages/$(NAME).ipa Payload iTunesArtwork -x \*.log \*.lastbuildstate \*successfulbuild > /dev/null
    @rm -f iTunesArtwork
    @mv -f Payload/$(OUTDIR) .
    @rmdir Payload

# The following rule builds a Cydia package out of the compiled app directory.
deb:
    @echo " + Building Cydia package..."
    @test -d Packages || mkdir Packages
    @rm -f Packages/$(NAME).deb
    @test -d $(NAME) || mkdir $(NAME)
    @test -d $(NAME)/Applications || mkdir $(NAME)/Applications
    @mv -f $(OUTDIR) $(NAME)/Applications
    @test -d $(NAME)/DEBIAN || mkdir $(NAME)/DEBIAN
    @cp -f cydia-package.cfg $(NAME)/DEBIAN/control
    @chmod +r $(NAME)/DEBIAN/control
    @echo "#!/bin/bash" > $(NAME)/DEBIAN/postinst
    @echo "rm -f /Applications/$(OUTDIR)/*.log /Applications/$(OUTDIR)/*.lastbuildstate /Applications/$(OUTDIR)/*.successfulbuild" >> $(NAME)/DEBIAN/postinst
    @echo "chown -R root:admin \"/Applications/$(OUTDIR)\"" >> $(NAME)/DEBIAN/postinst
    @echo "find \"/Applications/$(OUTDIR)\"|while read ITEM; do if [ -d \"\$$ITEM\" ]; then chmod 755 \"\$$ITEM\"; else chmod 644 \"\$$ITEM\"; fi; done" >> $(NAME)/DEBIAN/postinst
    @echo "chmod +x \"/Applications/$(OUTDIR)/$(NAME)\"" >> $(NAME)/DEBIAN/postinst
    @echo "su -c /usr/bin/uicache mobile 2> /dev/null" >> $(NAME)/DEBIAN/postinst
    @echo "exit 0" >> $(NAME)/DEBIAN/postinst
    @chmod +r+x $(NAME)/DEBIAN/postinst
    @dpkg-deb -b $(NAME) > /dev/null 2>&1
    @mv -f $(NAME).deb Packages
    @mv -f $(NAME)/Applications/$(OUTDIR) .
    @rm -rf $(NAME)

# This simple rule displays the success message after a successful build
end:
    @echo " + Done. Output directory is \"$(OUTDIR)\", iTunes package is \"Packages\$(NAME).ipa\", Cydia package is \"Packages\$(NAME).deb\"."

# This rule removes generated object files from the project and also temporary
# files ending with ~ or #.
clean:
    @echo " + Cleaning project intermediate files..."
    @rm -f $(OBJ) *~ *\#
    @echo " + Done."

# This rule removes all generated output from any previous builds so as to
# leave an intact source tree (useful for generating source tree releases).
distclean: clean
    @echo " + Cleaning project output files..."
    @rm -rf $(OUTDIR)
    @echo " + Done." 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T23:43:34.907

你实际上可能有两个问题。我建议你试试：

添加`-I../../usr/local/sys/usr/include`到您的 CFLAGS 以使其找到标题。

将链接器调用更改`LDFLAGS`为`-L../../usr/local/sys/usr/lib`、添加`LIBS=-lxml2`并将链接器调用更改为`$(LD) $(LDFLAGS) -o $(OUTDIR)/$(NAME) $(OBJ) $(LIBS)`（即在链接器命令行`-l`的末尾添加 ，`-L`在链接器命令行的开头添加）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-07T22:59:54.330

-l 仅用于指定库名称。使用 -L 添加要查找库的目录：

```
LDFLAGS += -L../../usr/local/sys/usr/lib -lxml2 
```

希望这可以帮助。

# javascript - 从导入脚本的标签中检索属性

> ID：10058942
> 
> 赞同：0
> 
> 时间：2012-04-07T22:38:37.257
> 
> 标签：javascript, attributes, custom-data-attribute

```
<script data-src="scripts/" src="scripts/myscript.js"></script> 
```

`myscript.js`我如何从内部检索`data-src`？假设还有很多脚本以与此相同的格式加载，`myscript.js`除了它将获取属性这一事实之外，它什么都不知道`data-src`

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T22:54:32.397

您可以这样做，因为您的脚本将是`script`找到的最后一个元素`getElementsByTagName()`，直到`script`加载下一个元素时，该元素将成为最后一个元素，依此类推。

```
var scriptList = document.getElementsByTagName('script');

var me = scriptList[scriptList.length-1];

var mySrc = me.getAttribute('data-src'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T22:53:45.953

如果它是特定脚本标记的 data-src 属性，我会在标记上放置一个 Id，并通过 Id 获取它。

```
<script id='DataSrcScript' data-src="scripts/" src="scripts/myscript.js"></script>

var dataSrc = document.getElementById('DataSrcScript').getAttribute('data-src'); 
```

# php - 如何有效执行更复杂的 Doctrine 2 延迟加载？

> ID：10058945
> 
> 赞同：0
> 
> 时间：2012-04-07T22:39:32.473
> 
> 标签：php, doctrine-orm, lazy-loading

假设我有一个用户实体和一个评论实体，具有一对多的关系。

假设我正在使用 Doctrine 2 从数据库中提取我的用户实体，并且我选择延迟加载用户的评论，而不是一次提取所有内容。

我现在有一个特定的页面，我想在其中显示用户的最后一条评论，并且在向用户询问它的评论时，延迟加载代理会启动并从数据库中提取评论。

这就是我的问题开始的地方：对于大多数有 1-5 条评论的人来说，这很好......但是，如果这个人有数百或数千条评论，当我不想加载时如何使用延迟加载一次所有的评论？

这是否超出了教义 2？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T00:59:51.410

延迟加载机制只能加载完整集。为了只加载最后一个，您需要使用 DQL 查询。

# java - 不使用临时队列遍历循环队列

> ID：10058949
> 
> 赞同：3
> 
> 时间：2012-04-07T22:39:48.500
> 
> 标签：java, queue, adt

基本上，我已经获得了 CircularQueue 的实现，我需要实现一个名为“public boolean contains (E other)”的方法，如果参数“other”存在于我的队列中，该方法应该返回 true。

我对它没意见，因为它是一个数组，但后来我看到了另一种情况，这让我很烦。

**请记住，您不能在队列中的所有元素之间自由导航。任何时候都只能通过 peek 方法访问最前面的元素。您对 contains 和 intersectWith 方法的实现不得使用任何额外的队列来临时保存该队列的某些元素。**

迭代器是否适用于解决这个问题？

非常感谢任何帮助。

米亚尔

解决方案：

答案我想出了，方法旋转描述：方法rotate( int n ) 从队列的前面删除n 个元素并将它们添加到队列的后面。将元素添加到队列后部的顺序与从队列前部移除的顺序相同。例如，给定一个队列 q，其中包含元素 \A、B、C、D、E"，其中元素 A 在队列的前面，在方法调用 q.rotate(2) 之后，队列的内容将是 \C, D, E, A, B";

```
 public boolean contains(E elem) { 

    while( this.isEmpty() != true){

      if(this.peek() == elem){return true;}
      else{rotate(1);}

   } 
   return false;

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T22:42:12.347

对于这种情况，迭代器不实用。

由于它是一个循环队列，您可以记住您看到的第一件事（不一定将其完全从循环队列中删除），以及出队/入队元素，直到找到您要查找的内容，或者到达第一个出队节点.

# iphone - 在另一个视图控制器中显示一个视图控制器

> ID：10058950
> 
> 赞同：0
> 
> 时间：2012-04-07T22:39:54.140
> 
> 标签：iphone, uinavigationcontroller, viewcontroller

我需要在我的根目录中显示一个`UINavigationController`, 。如果那不可能，我想知道如何拆分窗口并在其中显示 2 s。我需要像 Facebook 应用程序这样的东西，但在垂直方向上，像这样：`TableView``UIViewController``ViewController`

```
| NavigationController|
|                     |
|                     |
|                     |
|                     |
|---------------------|
|                     |
| root ViewController | 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T22:52:03.340

是的先生，您可以这样做...假设您有一个视图控制器，其中有一个 tableView 即 tableViewController
比您可以像创建它一样...

```
TableViewController *tableViewController = [[[TableViewController alloc] initWithNibName:nil bundle:nil] autorelease];
UINavigationController *navigationController =
[[UINavigationController alloc] initWithRootViewController:tableViewController];
[self.view addSubview:navigationController.view];
[navigationController release]; 
```

您只需要指定 subViewController 的大小和位置，使其适合正确的位置。希望这会有所帮助。

# iphone - Segue 崩溃 - 调试器不显示任何有用的错误

> ID：10058951
> 
> 赞同：4
> 
> 时间：2012-04-07T22:40:00.710
> 
> 标签：iphone, objective-c, ios, xcode

更新：

好的，我设法记录了异常：

```
[<TweetDetailViewController 0x685f9f0> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key toolbar. 
```

我在目标控制器视图中有一个工具栏。这会导致问题吗？

* * *

我不知道到底发生了什么。我根本没有改变segues，它们在几分钟前工作得很好。我在细节视图控制器中更改了一些不相关的东西，现在应用程序在从根到视图控制器的过程中崩溃了。

我正在尝试调试这个。这是代码崩溃的地方：

![在此处输入图像描述](../Images/41b30abe21f5a0131f9d1aad172ba74a.png)

跨步：

![在此处输入图像描述](../Images/0c9fcf04669060890d1d072c8e64c11f.png)

跨步：

![在此处输入图像描述](../Images/3ffb7ac26ef74c4b7dd4abb71665d164.png)

跨步：

![在此处输入图像描述](../Images/50d737f28be97c83358afc0c6adc31ed.png)

好的，这是在 prepareForSegue 中调用的 setter 方法：

```
- (void)setTweet:(Tweet *)newTweet
{
    if (_tweet != newTweet) {
        _tweet = newTweet;
    }
} 
```

我在进入细节控制器的时候调用了一个配置方法：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    [self configureView];
}

- (void)configureView
{
    // Update the user interface for the tweet detail page
    if (_tweet) {

        self.tweetUserName.text = _tweet.userName;
        self.tweetCreatedAt.text = _tweet.createdAt;
        self.tweetText.contentInset = UIEdgeInsetsMake(-4,-8,0,0);
        self.tweetText.text = _tweet.text;

        if (_tweet.retweeted == YES) {
            [self.retweetButton setTintColor:[UIColor grayColor]];
            [self.retweetButton setEnabled:NO];
        }

        if (!_tweet.userProfileImage) {
            dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
                NSString *imageUrl = _tweet.userProfileImageUrl;
                NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:imageUrl]];

                dispatch_async(dispatch_get_main_queue(), ^{
                    self.tweetUserProfileImage.image = [UIImage imageWithData:data];
                });
            });
        }
        else {
            self.tweetUserProfileImage.image = _tweet.userProfileImage;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-08T01:15:06.957

从评论中复制，作为一旦发现实际异常的答案：

故事板中的 TweetDetailViewController 很可能有一些连接到一个名为“工具栏”的插座，但该类的代码没有具有该名称的属性。当涉及到视图控制器时，这至少是这种错误的常见原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T00:14:44.960

尝试启用对 Zombie 的控制，以查看调试是否为您提供有关问题的更多详细信息。

在标题“环境变量”下的编辑方案中添加 NSZombieEnabled = YES

请尝试看看您是否有更多详细信息

# iphone - 使用按钮更改页面控件

> ID：10058952
> 
> 赞同：2
> 
> 时间：2012-04-07T22:40:09.277
> 
> 标签：iphone, objective-c, ios

我有一个简单的页面控件设置有两个不同的页面。我有一个名为 nextButton 的按钮，如果用户点击该按钮，我想更改页面并滚动到下一页。

我的页面控件有效，我可以滚动更改页面，但按钮根本不起作用。它正在被调用。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.scrollView.contentSize = CGSizeMake(self.scrollView.frame.size.width * TUTORIALNUMBEROFPAGES, self.scrollView.frame.size.height);
    self.scrollView.pagingEnabled = YES;
    self.scrollView.showsHorizontalScrollIndicator = NO;
    self.scrollView.showsVerticalScrollIndicator = NO;
    self.scrollView.scrollsToTop = NO;
    self.scrollView.delegate = self;

    self.pageControl.numberOfPages = TUTORIALNUMBEROFPAGES;
    self.pageControl.currentPage = 0;

    CGRect pageFrame = self.scrollView.frame;
    pageFrame.origin.x = pageFrame.size.width * 0;
    pageFrame.origin.y = 0;

    self.pageOne.frame = pageFrame;
    [self.scrollView addSubview:self.pageOne];

    pageFrame.origin.x = pageFrame.size.width * 1;
    self.pageTwo.frame = pageFrame;
    [self.scrollView addSubview:self.pageTwo];
}

- (void)scrollViewDidScroll:(UIScrollView *)sender 
{    
    if (pageControlUsed) {
        return;
    }

    CGFloat pageWidth = self.scrollView.frame.size.width;
    int page = floor((self.scrollView.contentOffset.x - pageWidth / 2) / pageWidth) + 1;
    self.pageControl.currentPage = page;
}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView 
{    
    pageControlUsed = NO;
}

- (IBAction)changePage:(id)sender 
{        
    NSInteger currentPage = self.pageControl.currentPage;
    CGPoint offset = CGPointMake(currentPage * self.scrollView.frame.size.width, 0);
    [self.scrollView setContentOffset:offset animated:YES];
    pageControlUsed = YES;
}

- (IBAction)nextButton:(id)sender
{
    [self changePage:self];
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-07T22:51:59.737

尝试这样的事情：

```
 - (IBAction)nextPage:(id)sender 
  {        
     NSInteger currentPage = self.pageControl.currentPage + 1;
     CGPoint offset = CGPointMake(currentPage * self.scrollView.frame.size.width, 0);
    [self.scrollView setContentOffset:offset animated:YES];
    pageControlUsed = YES;
 }

  - (IBAction)nextButton:(id)sender
  {
      [self nextPage:self];

  } 
```

请注意该代码中的 +1。之前，您实际上是在将内容偏移量精确设置为等于原始偏移量，因为您只是获取页面控件的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T23:01:24.443

你可以试试这个：

```
- (IBAction)changePage:(id)sender 
{        
    NSInteger currentPage = self.pageControl.currentPage;
    if([sender isKindOfClass:[UIButton class]){
       currentPage+=1;
    }
    CGPoint offset = CGPointMake(currentPage * self.scrollView.frame.size.width, 0);
    [self.scrollView setContentOffset:offset animated:YES];
    pageControlUsed = YES;
}

- (IBAction)nextButton:(id)sender
{
    [self changePage:sender];//if this action is attached just to your button
} 
```

# c# - C# XNA 运动不工作，不知道为什么

> ID：10058955
> 
> 赞同：1
> 
> 时间：2012-04-07T22:40:26.623
> 
> 标签：c#, xna

我正在尝试创建一个简单的应用程序，非常简单。

我不知道为什么，但是当我单击左箭头或右箭头时，纹理不会改变它的位置。

我确定我错过了一些东西，不知道是什么，看起来很愚蠢。

主文件： http: [//paste.ubuntu.com/919662/](http://paste.ubuntu.com/919662/)

Character.cs： http: [//paste.ubuntu.com/919664/](http://paste.ubuntu.com/919664/)

Position.cs： http: [//paste.ubuntu.com/919665/](http://paste.ubuntu.com/919665/)

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T23:04:19.363

更新答案：

真正的罪魁祸首是：

键盘状态键盘 = 新键盘状态（）；

您不能使用“键盘”作为变量名。这是XNA的一堂课！你正在重新声明它。因此，您的按键不再被检测到！改用这个：

```
KeyboardState keyb = Keyboard.GetState(); 
```

并更新您的参考资料

这个答案有点有效：

您正在初始化 Character

```
 C = new Character(100, 100, new Position(200, 200)); 
```

但是然后在您的 Update() 方法中，您可以：

```
 spriteBatch.Draw(myTexture, myVector, Color.White); 
```

您正在正确修改 Character 类中 Pos 的值，但这与 myTexture 无关。事实上，您甚至根本没有在屏幕上绘制“字符”。

TL；DR：您正在修改“Character”类，但您正在绘制 myTexture。您正在修改包含 myTexture 的对象的坐标，而不是 Character。

此外，如果您想在屏幕上绘制“字符”，最好的方法是使用 Vector2D 而不是您自己的 Pos 类。

还有一件事：

在 LoadContent 你正在做

```
 myVector = new Vector2(C.Pos.Col, C.Pos.Row); 
```

但是文档清楚地指出： /// 每个游戏都会调用**一次**LoadContent ，它是加载 /// 所有内容的地方。

这应该让你开始如何修复它。如果您仍有疑问，请在我的回答下发表评论。

# php - 将数组组合在一起

> ID：10058962
> 
> 赞同：1
> 
> 时间：2012-04-07T22:41:40.670
> 
> 标签：php, arrays, grouping

我对数据库获取的结果有点挣扎

假设我有一些行

```
 array('id'=>1, 'surname'=>'rossi', 'name'=>'mario', 'group'=>'admin'), 
   array('id'=>2, 'surname'=>'rossi', 'name'=>'giovanni', 'group'=>'user'), 
   array('id'=>3, 'surname'=>'verdi', 'name'=>'luigi', 'group'=>'user'), 
   array('id'=>4, 'surname'=>'verdi', 'name'=>'franco', 'group'=>'guest'), 
   array('id'=>5, 'surname'=>'bianchi', 'name'=>'mario', 'group'=>'guest') 
```

现在我该怎么做才能将这 5 行放入一个分组数组中？

例子：

```
user = array(
   array('id'=>2, 'surname'=>'rossi', 'name'=>'giovanni', 'group'=>'user'), 
   array('id'=>3, 'surname'=>'verdi', 'name'=>'luigi', 'group'=>'user'))
guest = array(
   array('id'=>4, 'surname'=>'verdi', 'name'=>'franco', 'group'=>'guest'), 
   array('id'=>5, 'surname'=>'bianchi', 'name'=>'mario', 'group'=>'guest')) 
admin = array(
   array('id'=>1, 'surname'=>'rossi', 'name'=>'mario', 'group'=>'admin')) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T22:49:35.547

```
// get query result
$result = mysql_query(...);

// prepare the target array
// it will hold user groups having group name as key
// eg. "user" => Array(), "guest" => Array()
$users = Array();

// whlile fetching rows from the result, add each row into $row["group"] key of target
while($row = mysql_fetch_assoc($result))
   $users[$row["group"]][] = $row;

// free the mysql result
mysql_free_result($result); 
```

**更新**：没有真正需要在目标`$user`变量中定义键。为了使代码具有可读性和可管理性，对一般结构进行评论就足够了。

# apache - 使用 uwsgi 和 apache 部署金字塔应用程序

> ID：10058964
> 
> 赞同：0
> 
> 时间：2012-04-07T22:41:51.793
> 
> 标签：apache, uwsgi

我在 virtualenv 中有一个金字塔应用程序，我想使用 apache+uwsgi 部署它，但我不知道如何连接 apache、uwsgi 和金字塔。谁能提供一个 apache.conf 和 production.ini 的例子？

在许多示例中，您应该创建一个初始化脚本来管理 uWSGI 进程，但是 apache 可以启动 uwsgi 进程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T19:01:55.727

我对 Apache 方面的事情无能为力，但这是我的 uwsgi config.ini，它适用于您的情况。Apache 不支持本机 uwsgi 协议，因此您需要配置 uwsgi 以使用 http，如下所示。然后，需要将 Apache 配置为将请求代理到后端 http 服务器。

> http = 127.0.0.1:33932 ;也可以使用unix文件socket
> 
> 大师 = 1
> 
> worker = 5 ; cpu 数量 + 1
> 
> harakiri = 30 ;秒 = 请求超时长度
> 
> 缓冲区大小 = 32768 ; 实验发现。您的应用程序可能会在更少或更多的情况下运行良好。
> 
> chdir = /path/to/your/uwsgi_webapp
> 
> 模块 = 你的模块
> 
> 可调用 = your_wsgi_app
> 
> virtualenv = /path/to/your/uwsgi_webapp/env
> 
> 守护进程 = /path/to/your/uwsgi_webapp/log/uwsgi.log
> 
> pidfile = /path/to/your/uwsgi_webapp/uwsgi_fuzzy.pid

请注意，不推荐使用 Apache 作为前端 Web 服务器。启动一个完整的 Apache 进程只是为了代理到另一个 http 服务器将导致性能相当差。因此，首选像 nginx 这样的轻量级服务器或像 Varnish 这样的 http 代理。

# java - Android：日期/时间验证

> ID：10058966
> 
> 赞同：-2
> 
> 时间：2012-04-07T22:42:04.360
> 
> 标签：java, android, date, datepicker, timepicker

我创建了一个日期选择器和一个时间选择器，它们在 EditText 字段中应用日期和时间。

现在我需要检查一下，插入的日期和时间是否比当前日期提前。只需要接受未来的日期和时间......

怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T01:31:24.437

您需要使用`Calendar`对象来获取当前日期...

```
Calendar currentDate = Calendar.getInstance(); 
```

然后`Calendar`为用户输入的日期制作一个，可能使用类似这样的东西......

```
Calendar enteredDate = Calendar.getInstance();
enteredDate.set(Calendar.DATE, dateValue);
enteredDate.set(Calendar.MONTH, monthValue);
enteredDate.set(Calendar.YEAR, yearValue); 
```

然后比较2...

```
boolean isAfterToday = enteredDate.after(currentDate); 
```

如果是`true`，则输入的日期在今天之后。

如果您需要使用时间值，请在 enterDate.set() 方法中指定它们 - 请参阅位于[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar的 Java 文档.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html)

# c++ - 基于瓷砖的外壳检查算法

> ID：10058969
> 
> 赞同：-2
> 
> 时间：2012-04-07T22:42:31.420
> 
> 标签：c++, algorithm

对于我的 c++ 游戏，每次放置一堵墙时，我都会尝试检测任意数量的瓷砖何时完全被墙包围。我很想知道是否有人曾经这样做过，或者是否有人知道任何可以做到这一点的算法。

不幸的是，谷歌对我的关键字没有太大帮助。

编辑：似乎洪水填充是我正在寻找的，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T22:49:29.550

我认为您正在寻找[填充](http://en.wikipedia.org/wiki/Flood_fill)以检查添加墙壁后哪些方格仍然可以访问。

# python - Python Newbie MIT 6.00 raw_input 语法错误

> ID：10058975
> 
> 赞同：0
> 
> 时间：2012-04-07T22:43:22.713
> 
> 标签：python, raw-input

我终于有足够的动力去阅读 MIT 的 Opencourse Intro to Computer Science & Programming，2008 年秋季。我正在在线观看视频讲座。第 3 课包含问题集 #0：打印您的姓名。

我不敢相信，但我真的被困在第一个问题的第一行。

我需要创建一个程序来询问我的姓氏。所以我查看了一些在线参考。并来到这个代码：

```
print raw_input('What is your lastname?') 
```

但是，那是给`SyntaxError: invalid syntax`. 所以我阅读了更多内容，发现这可能是因为我使用的是 Python 3.2.2。而且我要将**raw_input()**替换为**input()**。但是，`SyntaxError: invalid syntax`仍然存在。

有没有人有足够的耐心来帮忙？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T22:45:25.093

在 python 3.x 中，您使用函数 print() 而不是关键字 print。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-13T12:07:33.930

我希望你能从列夫那里得到答案。

但是，我想补充一点，如果您打算为此特定课程使用 python 3 或高级；在这种情况下，你“可能”会遇到一些困难。因为 MIT 提供的一些骨架代码是针对 python 2.5 + 版本的。我自己不得不更改一些代码，因为我使用的是 2.7.6（这不是微不足道的）。

但是，请注意，这是我根据我对编程入门的两个 OCW 版本（6.00 和 6.00SC）的经验得出的观点。据我所知，edX 版本的课程基本上非常相似。

最后，请不要失去希望。完成这门课程需要时间，但是一旦你解决了一个问题，麻省理工学院会确保你的自信心确实得到了极大的提升。祝你好运。

我希望这能帮到您。

# gedit - gedit：读取 C 代码

> ID：10058976
> 
> 赞同：0
> 
> 时间：2012-04-07T22:43:39.023
> 
> 标签：gedit

如何使用 gedit 从给定文件中列出的包含项中跟踪复杂项目中的函数调用、定义和声明？

在其他 IDE 中，您通常右键单击一个函数或变量，它可以将您带到其原始声明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-21T07:13:26.507

Gedit 是一个非常轻量级的文本编辑器，而不是 IDE。所以来回答你，

在 Gedit 中无法按照您的要求进行操作。它从不“读取”您的代码本身（IDE/编译器执行此操作），因此无法找到函数定义等。

# java - 在 Andengine 中创建物理体时出现奇怪的错误

> ID：10058980
> 
> 赞同：2
> 
> 时间：2012-04-07T22:45:07.590
> 
> 标签：java, android, andengine, jbox2d

我正在尝试通过这样的代码创建一个多边形物理体：

```
 final float halfWidth = pAreaShape.getWidthScaled() * 0.5f / PIXEL_TO_METER_RATIO_DEFAULT;
        final float halfHeight = pAreaShape.getHeightScaled() * 0.5f / PIXEL_TO_METER_RATIO_DEFAULT;            
        final float centerX = 0;
        final float left = -halfWidth;
        final float right = halfWidth;
        final float top = -halfHeight + 9f / PIXEL_TO_METER_RATIO_DEFAULT;
        final float bottom = halfHeight;

        final PolygonShape shape1 = new PolygonShape();

        final Vector2[] vertices = {
                new Vector2(centerX, bottom),
                new Vector2(left+8f/PIXEL_TO_METER_RATIO_DEFAULT, bottom-19f/PIXEL_TO_METER_RATIO_DEFAULT),
                new Vector2(left+7f/PIXEL_TO_METER_RATIO_DEFAULT, bottom-23f/PIXEL_TO_METER_RATIO_DEFAULT),
                new Vector2(left+10f/PIXEL_TO_METER_RATIO_DEFAULT, top+14f/PIXEL_TO_METER_RATIO_DEFAULT),
                new Vector2(left+13f/PIXEL_TO_METER_RATIO_DEFAULT, top+8f/PIXEL_TO_METER_RATIO_DEFAULT),

                new Vector2(right-14f/PIXEL_TO_METER_RATIO_DEFAULT, top+8f/PIXEL_TO_METER_RATIO_DEFAULT),
                new Vector2(right-11f/PIXEL_TO_METER_RATIO_DEFAULT, top+14f/PIXEL_TO_METER_RATIO_DEFAULT),
                new Vector2(right-9f/PIXEL_TO_METER_RATIO_DEFAULT, bottom-23f/PIXEL_TO_METER_RATIO_DEFAULT),
                new Vector2(right-10f/PIXEL_TO_METER_RATIO_DEFAULT, bottom-19f/PIXEL_TO_METER_RATIO_DEFAULT)
        };

        Body body = PhysicsFactory.createPolygonBody(pPhysicsWorld, pAreaShape, vertices, pBodyType, pFixtureDef); 
```

可变顶点包含此形状的顶点。

而且它不起作用 - 应用程序启动（显示黑屏和应用程序标题栏），然后退出而没有任何错误（LogCat 中没有崩溃对话框和错误）。

但是当我删除顶点数组的元素之一时，它工作正常。

我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T16:15:49.147

Box2D 在一个多边形中最多有 8 个顶点，如果您指定更多，则会因断言而失败。我不确定 Box2D ANDEngine 使用哪个版本，但请尝试制作循环或边缘形状

# java - 光线追踪 - 通过像素构造光线

> ID：10058982
> 
> 赞同：0
> 
> 时间：2012-04-07T22:45:28.013
> 
> 标签：java, pixel, raytracing

我有一个任务是在 Java 中实现光线追踪。我并没有要求太多，只是想了解一些关于如何通过给定 x 和 y 的像素构造来自相机的光线的信息。我在互联网上找到了很多解释这一点的资源，但都是 2D 的，我需要如何在 3D 中做到这一点。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T00:49:50.547

基本思想是这样的：您在给定位置（x，y，z）有一个具有给定分辨率的相机。你有一组光源。您有相机的方向（一个角度，想想您如何倾斜/旋转头部以向上/向下看等......）。现在您要做的基本上是针对每个相机像素，“延伸”垂直线（射线）直到它们接触几何体。然后你知道“要渲染什么”（即你刚刚找到的几何图形）。接下来是确定对象是否被阴影，您可以通过将光线“延伸”到光源直到它们接触几何体（对于给定的光源，您的点被几何体的另一位阴影）或直到它们到达光源（您的位置被给定的光源照亮）。

这是基础知识，当你考虑反射、光的漫射等问题时，它会变得更加困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T23:20:43.367

问题是如何找到屏幕上某个点的空间坐标，该点的位置由屏幕坐标中的 (x,y) 给出。

我不知道您在屏幕上使用的是什么坐标系，所以我会做出一些有根据的猜测，您可以进行相应的调整。

屏幕中心在空间中具有已知位置 [X,Y,Z][中心]。我假设屏幕坐标系的原点在那里。我们有一个垂直于屏幕的“方向”向量**d和一个“向上”向量****u**。我假设屏幕上的 +y 方向是**u**。我们可以取这些向量的叉积**r** = **d** x **u**，我将其作为屏幕上的 +x 方向。所以屏幕坐标为 (x, y) 的点的位置将是 [X, Y, Z] [center] + x **r** + y **u**，我们就完成了。

# java - 带有盐和静态密码的 AES

> ID：10058995
> 
> 赞同：0
> 
> 时间：2012-04-07T22:49:44.220
> 
> 标签：java, encryption, cryptography, aes

我有以下几乎可以工作的代码：

**AES.java**

```
import java.io.UnsupportedEncodingException;
import java.security.AlgorithmParameters;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.spec.AlgorithmParameterSpec;
import java.security.spec.InvalidKeySpecException;
import java.security.spec.InvalidParameterSpecException;
import java.security.spec.KeySpec;

import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.KeyGenerator;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.PBEKeySpec;
import javax.crypto.spec.SecretKeySpec;

public class AES {

    private static final int    KEY_LENGTH              = 128;
    private static final int    ITERATIONS              = 100;

    private static final String ALGORITHM               = "AES";
    private static final String SECRET_KEY_ALGORITHM    = "PBKDF2WithHmacSHA1";
    private static final String TRANSFORMATION          = "AES/CBC/PKCS5Padding";

    private final Cipher        m_enc_cipher;
    private final Cipher        m_dec_cipher;

    private final byte[]        m_iv;

    public AES(final char[] password, final byte[] salt)
            throws NoSuchAlgorithmException, InvalidKeySpecException,
            NoSuchPaddingException, InvalidKeyException,
            InvalidParameterSpecException, IllegalBlockSizeException,
            BadPaddingException, UnsupportedEncodingException,
            InvalidAlgorithmParameterException {

        // Derive the key, given password and salt
        final SecretKeyFactory factory = SecretKeyFactory
                .getInstance(SECRET_KEY_ALGORITHM);
        final KeySpec spec = new PBEKeySpec(password, salt, ITERATIONS,
                KEY_LENGTH);
        final SecretKey tmp = factory.generateSecret(spec);
        final SecretKey secret = new SecretKeySpec(tmp.getEncoded(), ALGORITHM);

        // Build encryptor and get IV
        final Cipher enc_cipher = Cipher.getInstance(TRANSFORMATION);
        enc_cipher.init(Cipher.ENCRYPT_MODE, secret);
        final AlgorithmParameters params = enc_cipher.getParameters();
        final byte[] iv = params.getParameterSpec(IvParameterSpec.class)
                .getIV();

        // Build decryptor
        final Cipher dec_cipher = Cipher.getInstance(TRANSFORMATION);
        dec_cipher.init(Cipher.DECRYPT_MODE, secret, new IvParameterSpec(iv));

        this.m_enc_cipher = enc_cipher;
        this.m_dec_cipher = dec_cipher;

        this.m_iv = iv;
    }

    public AES(final byte[] iv) throws NoSuchAlgorithmException,
            InvalidKeySpecException, NoSuchPaddingException,
            InvalidKeyException, InvalidParameterSpecException,
            IllegalBlockSizeException, BadPaddingException,
            UnsupportedEncodingException, InvalidAlgorithmParameterException {

        final AlgorithmParameterSpec aps = new IvParameterSpec(iv);

        final KeyGenerator keygen = KeyGenerator.getInstance(ALGORITHM);
        keygen.init(KEY_LENGTH);
        final SecretKey secret = keygen.generateKey();

        // Build encryptor
        final Cipher enc_cipher = Cipher.getInstance(TRANSFORMATION);
        enc_cipher.init(Cipher.ENCRYPT_MODE, secret, aps);

        // Build decryptor
        final Cipher dec_cipher = Cipher.getInstance(TRANSFORMATION);
        dec_cipher.init(Cipher.DECRYPT_MODE, secret, aps);

        this.m_enc_cipher = enc_cipher;
        this.m_dec_cipher = dec_cipher;

        this.m_iv = iv;
    }

    public byte[] get_iv() {
        return this.m_iv;
    }

    public byte[] encrypt(final byte[] data) throws NoSuchAlgorithmException,
            InvalidKeySpecException, NoSuchPaddingException,
            InvalidKeyException, InvalidParameterSpecException,
            IllegalBlockSizeException, BadPaddingException,
            UnsupportedEncodingException {
        return this.m_enc_cipher.doFinal(data);
    }

    public byte[] decrypt(final byte[] data) throws IllegalBlockSizeException,
            BadPaddingException {
        return this.m_dec_cipher.doFinal(data);
    }
} 
```

**AESTest.java**

```
import java.io.UnsupportedEncodingException;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;
import java.security.spec.InvalidParameterSpecException;
import java.util.Arrays;

import javax.crypto.BadPaddingException;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;

import org.junit.Test;
import static org.junit.Assert.*;

public class AESTest {
    @Test
    public void test() throws InvalidKeyException, NoSuchAlgorithmException,
            InvalidKeySpecException, NoSuchPaddingException,
            InvalidParameterSpecException, IllegalBlockSizeException,
            BadPaddingException, UnsupportedEncodingException,
            InvalidAlgorithmParameterException {

        final char[] password = "my_password".toCharArray();
        final byte[] salt = new byte[] { 22, 11 };

        final byte[] original_data = "Hello, World!".getBytes("UTF-8");
        final AES aesA = new AES(password, salt);
        final byte[] encrypted_data = aesA.encrypt(original_data);
        System.out.println("Encrypted:");
        System.out.println(javax.xml.bind.DatatypeConverter
                .printBase64Binary(encrypted_data));

        final AES aesB = new AES(aesA.get_iv());
        final byte[] decrypted_data_B = aesB.decrypt(encrypted_data);
        System.out.println("Decrypted B:");
        System.out.println(javax.xml.bind.DatatypeConverter
                .printBase64Binary(decrypted_data_B));
        assertTrue(Arrays.equals(original_data, decrypted_data_B));
    }
} 
```

在测试（AESTest.java）中，它给了我这个错误：

```
javax.crypto.BadPaddingException: Given final block not properly padded 
```

我的最终目的是能够发送加密的数据块，然后再将其取回。
术语“稍后”可以指一天/一周/一年。
然后，使用相同的密码我想解密它。

**因为“稍后”可能是一个月，所以我需要创建一个新`AES`对象。**

现在，这个新`AES`对象必须能够使用相同的固定密码/盐来解密数据。
就这样。

我尝试使用相同的 IV，但它不起作用。

我在这里做错了什么？

**编辑＃1：**也 请注意`ITERATIONS`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T23:21:01.533

当您通过`iv`创建不同的`secret`. 是不是错了？

您没有使用相同的密码和盐。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-08T17:23:41.637

如前所述，第二个构造函数创建一个新的 AES 密钥，因此它与第一个构造函数中创建的密钥不匹配。我真的不明白你有两个不同的构造函数的意图，你在每个构造函数中创建一个适合加密的 AES 实例以及另一个用于解密的实例？重新考虑该设计并仅使用一个实例可能是有意义的，具体取决于您是要加密还是解密。

虽然您在第一个构造函数中生成的密钥是保密的，但生成的 IV 是公共信息，可以安全地公开发布，这不会损害安全性。但是，您应该为每条加密消息创建唯一的 IV，否则可能会针对您使用的 CBC 模式进行攻击。

所以我建议你这样做：

**加密：**

基本上是第一个构造函数，省略了第二个实例进行解密。检索已创建的 IV。

**解密：**

同样基本上是第一个构造函数，带有一个额外的 IV 参数。使用完全相同的参数（盐、密码、迭代）从头开始再次创建密钥，这次启动`Cipher`解密模式，另外传递 IV 参数。

应该这样做！

# ruby - 在 Ruby 中更改 Proc 的绑定

> ID：10058996
> 
> 赞同：21
> 
> 时间：2012-04-07T22:49:45.783
> 
> 标签：ruby

我有这个代码：

```
 l = lambda { a }
 def some_function
     a = 1
 end 
```

我只想`a`通过 lambda 和一个特殊范围访问，该范围`a`已经在示例内部的某个地方定义`some_function`，或者稍后在与以下相同的范围内定义：

```
 l = lambda { a }
 a = 1
 l.call 
```

然后我发现在调用时`l`，它仍然使用自己的绑定，而不是调用它的新绑定。

然后我尝试将其用作：

```
 l.instance_eval do
     a = 1
     call
 end 
```

但这也失败了，奇怪的是我无法解释为什么。

我知道解决方案之一是 using `eval`，我可以在其中特殊绑定并在文本中执行一些代码，但我真的不想这样使用。

而且，我知道它能够使用全局变量或实例变量。但是，实际上我的代码处于更深层次的嵌入式环境中，所以如果不是很有必要，我不想破坏已完成的部分。

我`Proc`在文档中引用了该类，并且找到了一个`binding`引用`Proc`' 上下文的函数名称。虽然该函数仅提供了一种访问其绑定但不能更改它的方法，但使用`Binding#eval`. 它也评估文本，这正是我不喜欢做的。

现在的问题是，我有更好（或更优雅）的方式来实现它吗？还是使用`eval`已经是*常规*方式？

编辑回复@Andrew：
好的，这是我在编写词法解析器时遇到的一个问题，我在其中定义了一个具有固定数量项目的数组，其中至少包括一个`Proc`和一个正则表达式。我的目的是匹配正则表达式并在我的特殊范围内执行 Procs，其中 Proce 将涉及一些稍后应该定义的局部变量。然后我遇到了上面的问题。[实际上，我认为这个问题](https://stackoverflow.com/questions/9245947/is-it-possible-to-access-blocks-scope-in-method/9246066#9246066)
并不完全一样，因为我的问题*是*如何将绑定传递给 Proc 而不是如何将其传递*出去*。

 **@Niklas：得到你的答案，我想这正是我想要的。它完美地解决了我的问题。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-07T23:29:24.673

您可以尝试以下技巧：

```
class Proc
  def call_with_vars(vars, *args)
    Struct.new(*vars.keys).new(*vars.values).instance_exec(*args, &self)
  end
end 
```

像这样使用：

```
irb(main):001:0* lambda { foo }.call_with_vars(:foo => 3)
=> 3
irb(main):002:0> lambda { |a| foo + a }.call_with_vars({:foo => 3}, 1)
=> 4 
```

不过，这不是一个非常通用的解决方案。如果我们可以给它`Binding`实例而不是哈希并执行以下操作会更好：

```
l = lambda { |a| foo + a }
foo = 3
l.call_with_binding(binding, 1)  # => 4 
```

使用以下更复杂的 hack，可以实现这种精确的行为：

```
class LookupStack
  def initialize(bindings = [])
    @bindings = bindings
  end

  def method_missing(m, *args)
    @bindings.reverse_each do |bind|
      begin
        method = eval("method(%s)" % m.inspect, bind)
      rescue NameError
      else
        return method.call(*args)
      end
      begin
        value = eval(m.to_s, bind)
        return value
      rescue NameError
      end
    end
    raise NoMethodError
  end

  def push_binding(bind)
    @bindings.push bind
  end

  def push_instance(obj)
    @bindings.push obj.instance_eval { binding }
  end

  def push_hash(vars)
    push_instance Struct.new(*vars.keys).new(*vars.values)
  end

  def run_proc(p, *args)
    instance_exec(*args, &p)
  end
end

class Proc
  def call_with_binding(bind, *args)
    LookupStack.new([bind]).run_proc(self, *args)
  end
end 
```

基本上，我们为自己定义了一个手动名称查找堆栈和`instance_exec`针对它的 proc。这是一个非常灵活的机制。它不仅可以实现`call_with_binding`，还可以用于构建更复杂的查找链：

```
l = lambda { |a| local + func(2) + some_method(1) + var + a }

local = 1
def func(x) x end

class Foo < Struct.new(:add)
  def some_method(x) x + add end
end

stack = LookupStack.new
stack.push_binding(binding)
stack.push_instance(Foo.new(2))
stack.push_hash(:var => 4)

p stack.run_proc(l, 5) 
```

正如预期的那样，这将打印 15 :)

**更新：**代码现在也可以[在 Github](https://github.com/niklasb/ruby-dynamic-binding)上找到。我现在也将它用于我的一个项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-19T23:42:28.143

```
class Proc
    def call_with_obj(obj, *args)
        m = nil
        p = self
        Object.class_eval do
            define_method :a_temp_method_name, &p
            m = instance_method :a_temp_method_name; remove_method :a_temp_method_name
        end
        m.bind(obj).call(*args)
    end
end 
```

然后将其用作：

```
class Foo
    def bar
        "bar"
    end
end

p = Proc.new { bar }

bar = "baz"

p.call_with_obj(self) # => baz
p.call_with_obj(Foo.new) # => bar 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-25T16:35:37.990

也许您实际上不需要`a`稍后定义，而只需要稍后*设置*它。

或者（如下所示），也许您实际上并不需要`a`成为一个局部变量（它本身引用一个数组）。相反，也许您可​​以有效地使用类变量，例如`@@a`. 这对我有用，通过打印“1”：

```
class SomeClass
  def l
    @l ||= lambda { puts @@a }
  end

  def some_function
    @@a = 1
    l.call
  end
end
SomeClass.new.some_function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-16T12:44:16.363

类似的方式：

```
class Context
  attr_reader :_previous, :_arguments

  def initialize(_previous, _arguments)
    @_previous = _previous
    @_arguments = _arguments
  end
end

def _code_def(_previous, _arguments = [], &_block)
  define_method("_code_#{_previous}") do |_method_previous, _method_arguments = []|
    Context.new(_method_previous, _method_arguments).instance_eval(&_block)
  end
end

_code_def('something') do
  puts _previous
  puts _arguments
end 
```**

# bash - Bash Script - 从命令行获取歌曲艺术家

> ID：10058997
> 
> 赞同：0
> 
> 时间：2012-04-07T22:49:53.083
> 
> 标签：bash, shell

是否有 bash 命令/程序可以从命令行获取有关歌曲的信息？我想获得专辑、艺术家、长度等信息。

格式为.mp3

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-08T01:14:29.250

你可以试试`exiftool`，非常好用：

```
$ exiftool -Title -Artist -Album -Duration  ScarboroughFair.mp3
Title                           : Scarborough Fair
Artist                          : 莎拉 布莱曼
Album                           : 月光女神
Duration                        : 0:04:11 (approx) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T00:18:45.750

例如，尝试 id3v2，或者 id3tool，或者干脆 id3

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T21:43:26.533

也许试试 -f 命令。它将允许您搜索文件名（因此歌曲名称）。

# java - Tomcat/Java 调试信息

> ID：10058998
> 
> 赞同：0
> 
> 时间：2012-04-07T22:50:04.873
> 
> 标签：java, tomcat, nullpointerexception

我正在尝试追踪现有系统中的错误。所以问题是Tomcat没有给我发生错误的行，而只是一个一般的NULL指针异常。当前系统使用 servlet 获取对 bean 的引用。这个 bean 类完成了所有的数据处理，每当在这样的 bean 中发生错误时，除非我手动调试代码，否则我将无法找到错误，这对于偶尔发生的某些错误是不可能的。是否有任何标志可以启用以获取更多信息？还是我必须重新设计系统才能获得调试信息？我正在使用 Tomcat 7.0.12 版。谢谢！

```
java.lang.NullPointerException
    at org.apache.jsp.search_jsp._jspService(search_jsp.java:151)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:419)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:391)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at ... 
```

编辑：刚刚发现servlet中的异常处理试图访问空对象的属性，这导致原始错误被该空指针异常伪装。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T22:54:52.927

你可以去 $TOMCAT_HOME/work/catalina/localhost/${YOUR_APP_NAME}/org/apache/jsp/..

并找到文件 search_jsp.java。因此，您将能够找到发生错误的行。