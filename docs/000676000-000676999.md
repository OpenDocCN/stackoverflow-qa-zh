# StackOverflow 问答 000676000-000676999

# .net - SQLCommand.ExecuteScalar() - 为什么会抛出 System.NullReferenceException？

> ID：676003
> 
> 赞同：3
> 
> 时间：2009-03-24T02:50:54.010
> 
> 标签：.net, exception, sqlcommand

谁能注意到以下功能可能有什么问题：

```
public string Login(string username, string password)
    {
        string result = "";
        string select = "SELECT user_id FROM [user] WHERE username = @username AND password = @password";
        SqlConnection conn = new SqlConnection(connectionString);
        SqlCommand cmd = new SqlCommand(select, conn);
        cmd.Parameters.AddWithValue("username", username);
        cmd.Parameters.AddWithValue("password", password);
        int userID = 0;
        try
        {
            conn.Open();
            userID = (int)cmd.ExecuteScalar();
            if(userID > 0)
            {
                result = addSession(userID);
            }
        }
        catch(Exception ex)
        {
            string sDummy = ex.ToString();
        }
        return result;
    } 
```

不知道为什么行`userID = (int)cmd.ExecuteScalar(); 抛出异常。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T03:02:52.127

表中很可能没有包含该用户/密码的行。[ExecuteScalar](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)的文档说，如果结果集为空，它会返回 null，并且您不能将 null 转换为 int。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T02:52:57.127

您应该考虑修改这段代码：

```
try
{
    conn.Open();
    userID = (int)cmd.ExecuteScalar();
    if(userID > 0)
    {
        result = addSession(userID);
    }
 }
 catch(Exception ex)
 {
    string sDummy = ex.ToString();

 }
 finally // add this to ensure the connection is closed!
 {
     if (conn != null)
       conn.Close();
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T03:00:16.797

如果在数据库中找不到提供的凭据，标量是否可能为空？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T02:53:28.873

不确定，但您可能需要“@”作为参数名称：

```
...AddWithValue("@username", username); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-26T07:48:13.370

我在使用 SqlCE 时遇到了同样的问题。我找到的解决方案（在我开始正确输入密码之后... >.> ）是首先将 ExecuteScalar 结果作为对象收集，然后再进行转换。从字面上看，使用

```
Object o = cmd.ExecuteScalar(); 
int id = Convert.ToInt32(o); 
```

代替

```
int id = (int) cmd.ExecuteScalar(); 
```

是工作和崩溃之间的区别。我不知道为什么会这样……

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-29T11:12:38.103

我没有看到任何 hashbytes 函数，但它是这样的：

如果您`hashbytes`在后端 SQL 服务器上使用函数，则将密码输入转换为二进制数组。Hashbytes 返回 varbinary。因此，如果您传递空终止符，则哈希将不一样。就像在 SQL`hashbytes('SHA2_512,'stuff')`中一样，就像散列's'，'t'，直到'f'。最后没有'\0'。但是，如果您在 sqlcommand 对象中参数化为字符串，它将在末尾添加 '\0' 并且 SQL 将计算该零。因此，如果您将使用`Encoding`类转换为二进制数组，则参数将只是没有空终止符的字符串。我遇到了类似的问题，我以这种方式解决了使用问题，`addwithvalue`并将其值作为二进制文件。

但是，您知道 executescalar 返回一个对象。如果查询返回零行，则该对象将为 NULL，并且您不能将 NULL 对象强制转换或转换为任何对象。所以在 if 语句中说“如果返回对象 == null 那么你没有经过身份验证。否则......”

# xml - 如何使用 XQuery 匹配列表项 1 2 3

> ID：676012
> 
> 赞同：1
> 
> 时间：2009-03-24T02:54:07.250
> 
> 标签：xml, xquery

我正在尝试使用 XQuery 匹配存储为[列表](http://www.w3schools.com/schema/el_list.asp)元素的 id。

例如，

```
<data>
    <item>
        <name>foo</name>
        <intValues>1 2 3 4 5</intValues>
    </item>
    <item>
        <name>bar</name>
        <intValues>6 7 8 9 10</intValues>
    </item>
</data> 
```

是否可以退回包含 3 的项目`intValues`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T13:48:58.190

> 是否可以返回 intValues 中包含 3 的项目？

**此 XPath 表达式** *恰好选择所有`item`具有 '3' 的元素作为其* `intValues` *child*中包含的值列表之一：

   **`/*/item['3' = tokenize(intValues, ' ')]`**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T16:38:18.733

如果您的 xml 文件具有架构并且您使用的是架构感知处理器，则查询只是

```
/data/item[intValues = 3] 
```

否则，正如 Dimitre 建议的那样，您将不得不手动对其进行标记。

# objective-c - Objective-C 类方法的对象保留行为

> ID：676014
> 
> 赞同：4
> 
> 时间：2009-03-24T02:54:32.567
> 
> 标签：objective-c, static-members, retain, class-method

保留和释放传递给类方法的对象的最佳实践是什么？

例如，如果您有一个像这样声明的“类变量”：

```
static NSString *_myString = nil 
```

...这样做是正确的：

```
+ (void)myClassMethod:(NSString *)param {
    _myString = param;
} 
```

...它的缺点是调用者需要在参数上保持非零保留计数，以免它被过早释放。或者，可以这样做：

```
+ (void)myClassMethod:(NSString *)param {
    [_myString autorelease];
    _myString = [param retain];
} 
```

...它的缺点是如果没有相应的类级`dealloc`调用，它会泄漏内存。或者是否应该完全避免这种类变量欺骗，也许使用一个以更传统的方式管理这些对象的生命周期的单例类？

这是[Apple 关于创建单例实例的文档](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaObjects/CocoaObjects.html#//apple_ref/doc/uid/TP40002974-CH4-SW32)。

我正在使用的代码是非常漂亮（但仍然是新的）Objective Resource 项目（[http://www.iphoneonrails.com/](http://www.iphoneonrails.com/)）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T03:20:13.643

保留和释放，绝对。这不是泄漏，因为调用类的唯一时间`dealloc`是程序结束时——此时内存无论如何都会被释放。第一种方式会更麻烦，并且违反 Cocoa 内存管理准则。

至于是类方法还是单例：类本身一般不应该有很多独立的功能。它们只是在 Objective-C 中不是这样设计的，正如您从缺少类变量中看到的那样。类方法通常应该处理创建和管理实例，并且有时存储所有实例的共享属性或默认值。类的实际功能应该放在实例中。这是 Objective-C 中的约定。

（当然，没有 Objective-C 上帝，你可以自由地忽略约定，但这是普遍的智慧。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T04:54:15.087

此外，对于具有可变变体（如or ）的`NSString`类或任何类，我强烈建议复制参数而不是保留它。如果调用者传递给你的字符串是一个，它的值可能会在以后改变，它也会在你的类中改变。这可能不是你想要的，所以我建议这样做：`NSArray``NSDictionary``NSMutableString`

```
+ (void)myClassMethod:(NSString *)param {
    [_myString release];
    _myString = [param copy];
} 
```

该`copy`方法制作一个副本并将保留计数设置为 1，因此就保留变量而言，您都已设置好。而且，作为额外的奖励，如果调用者确实传递给你一个`NSString`，那么该类足够聪明，知道它的值不能改变，所以它只是保留自己以避免制作对象的副本。这有多聪明？

# sql-server - 撇号和 SQL Server FT 搜索

> ID：676019
> 
> 赞同：3
> 
> 时间：2009-03-24T02:55:53.407
> 
> 标签：sql-server, full-text-search, apostrophe

我已经在 SQL Server 2005 中设置了 FT 搜索，但我似乎找不到将“Lias”关键字与带有“Lia's”的记录相匹配的方法。我基本上想要的是允许人们在没有撇号的情况下进行搜索。

我已经断断续续地解决这个问题很长一段时间了，所以任何帮助都将是一种祝福。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T10:29:29.713

编辑2：刚刚意识到这实际上并不能解决您的问题，请忽略并查看其他答案！下面的代码将返回用户插入不应该存在的撇号的情况的结果，例如“abandoned it's cargo”。

我没有在本地安装 FT，也没有对此进行测试 - 您可以使用 CONTAINS 的语法来测试原始事件和撇去撇号的事件，即：

```
SELECT *
FROM table
WHERE CONTAINS ('value' OR Replace('value', '''','')) 
```

编辑：您可以使用双引号搜索短语，例如

```
SELECT *
FROM table
WHERE CONTAINS ("this phrase" OR Replace("this phrase", '''','')) 
```

[有关CONTAINS 的](http://msdn.microsoft.com/en-us/library/ms187787.aspx)信息，请参阅MSDN 文档。这实际上表明标点符号无论如何都被忽略了，但我还没有测试过；它可能值得`CONTAINS('value')`自己尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T21:03:27.847

我没有使用过 FT，但在对 varchar 列进行查询以及查找 O'Reilly 等姓氏时，我使用过：

```
surname like Replace( @search, '''', '') + '%' or
Replace( surname,'''','') like @search + '%' 
```

这允许撇号在数据库值或搜索词中。它显然也会像一条大桌子的狗一样表现。

另一种选择（也可能不是一个好方法）是保存数据的第二个副本，去除非字母字符，然后针对该副本进行搜索（也是？）。因此，原版将包含 Lia 的和第二版 Lias。存储量翻倍等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T14:33:16.333

另一种尝试：

```
SELECT surname
FROM table
WHERE surname LIKE '%value%'
OR REPLACE(surname,'''','') LIKE '%value%' 
```

这对我有用（没有启用 FT），即我在搜索 O'Connor 或 OConnor 时得到相同的结果。

# sql - 链接服务器关闭时，执行存储过程会出错

> ID：676034
> 
> 赞同：1
> 
> 时间：2009-03-24T03:02:19.257
> 
> 标签：sql, sql-server, sql-server-2005

我有一个用于在许多不同的 sql server 之间选择数据的存储过程，并且所有的 sql server 都在内置存储过程的 sql server 上设置了链接服务器。

这是我的程序：

```
Create Proc dbo.spGetData
@code as char(4)
AS
if (@code='aaaa')
  Select date From [ServerA].Stock.dbo.Syspara
else if (@code='bbbb')
  Select date From [ServerB].Stock.dbo.Syspara
else if (@code='cccc')
  Select date From [ServerC].Stock.dbo.Syspara
else if (@code='dddd')
  Select date From [ServerD].Stock.dbo.Syspara
GO 
```

如果 [ServerB] 不存在或已关闭，当我调用时：

```
exec dbo.spGetData 'dddd' 
```

会有一个错误，但如果所有 4 个服务器都处于活动状态，则查询将返回而没有错误。

我该怎么做才能避免这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T03:07:42.363

添加[`TRY..CATCH`](http://msdn.microsoft.com/en-us/library/ms175976(SQL.90).aspx)错误处理：

以下示例显示了由 SELECT 语句生成的对象名称解析错误如何未被 TRY...CATCH 构造捕获，但在存储过程中执行相同的 SELECT 语句时被 CATCH 块捕获。

```
BEGIN TRY
    -- Table does not exist; object name resolution
    -- error not caught.
    SELECT * FROM NonexistentTable;
END TRY
BEGIN CATCH
    SELECT 
        ERROR_NUMBER() as ErrorNumber,
        ERROR_MESSAGE() as ErrorMessage;
END CATCH 
```

错误没有被捕获，并且控制从 TRY…CATCH 构造传递到下一个更高级别。

在存储过程中运行 SELECT 语句将导致错误发生在低于 TRY 块的级别。错误将由 TRY...CATCH 构造处理。

```
-- Verify that the stored procedure does not exist.
IF OBJECT_ID ( N'usp_ExampleProc', N'P' ) IS NOT NULL 
    DROP PROCEDURE usp_ExampleProc;
GO

-- Create a stored procedure that will cause an 
-- object resolution error.
CREATE PROCEDURE usp_ExampleProc
AS
    SELECT * FROM NonexistentTable;
GO

BEGIN TRY
    EXECUTE usp_ExampleProc
END TRY
BEGIN CATCH
    SELECT 
        ERROR_NUMBER() as ErrorNumber,
        ERROR_MESSAGE() as ErrorMessage;
END CATCH; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T04:07:43.563

如果像我一样，您仍然必须使用 SQL Server 2000，那么您不能使用 try catch 块。

我认为这对超时没有帮助，但是如果您将 if 语句分解为单独的语句并在每个语句之后检查 @@ERROR，这将使您更好地控制。

# internet-explorer - 使用 IE8 兼容模式测试 IE6 的网页渲染？

> ID：676037
> 
> 赞同：3
> 
> 时间：2009-03-24T03:04:22.917
> 
> 标签：internet-explorer, internet-explorer-8, cross-browser

我仍在我的开发 PC 上运行 IE6，因为我用它来测试我正在开发的网站。

我通常只在 IE6 上进行测试，假设 IE6 是 IE 浏览器系列的最低公分母。如果它在 IE6 上呈现良好，则在 IE7 和 IE8 上都可以。我用于测试的另一个浏览器是 Firefox 3.x。我认为这两个系列的浏览器基本上覆盖了大部分网络冲浪者。

这正是我没有升级到IE7的原因。既然 IE8 可以在兼容模式下渲染网页，是否建议使用 IE8 来测试网站与 IE6 的兼容性？

我知道大多数人会建议使用虚拟机。但它只是用于查看网页有点重。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T03:12:50.543

如果可以的话，试试[SuperPreview](http://www.webdesignerdepot.com/2009/03/microsoft-announces-superpreview-for-ie-browser-testing/)或[整个包（Expression Web 在 Mix 上宣布）。](http://www.istartedsomething.com/20090318/expression-web-superpreview-cross-browser-testing/)

SuperPreview 是来自 Microsoft 的新免费独立应用程序（仍处于测试阶段），它使您能够查看您的网站在不同版本的 Internet Explorer 中的外观，从而比以前更容易从 IE6 迁移到 7 和 8，而无需启动虚拟机器运行IE6，或者有一台单独的计算机专门运行IE6。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-18T06:38:40.650

我使用 SuperPreview 的问题是缺乏交互性。您不能单击链接、输入登录信息进行选择等。它只会呈现静态 HTML 页面。很难测试需要在其屏幕上跟踪授权或用户偏好信息的页面！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T03:18:17.237

IE7 的呈现方式与 IE6 不同，IE8 甚至更是如此，如果您的站点设置了 doctype，因此以标准模式呈现。

我建议安装 IE8，它可以让您在 IE8 /~IE7~ 中看到您的网站，并在虚拟机上获取 IE6。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T08:57:11.233

完全同意 Scunliffe 的观点，仅在 IE6 中进行测试并不能保证在 IE7 和 IE8 中的兼容性。事实上，如果您构建的网站迎合了 IE6 的所有怪癖，那么它很可能无法在所有其他（较新的）浏览器中呈现，因为它依赖于那些特定的怪癖。

所以获得 IE8 可能是明智的，因为它具有内置的兼容模式，几乎完全模仿 IE7。然后让 IE6 在虚拟 PC 上运行（您可以免费安装和设置）或在另一台 PC 上进行一些 IE6 测试。

一般而言，实现浏览器兼容性的最佳方法是从完全基于标准的、干净的语义标记开始，例如 Firefox 3 和 Safari，使用 XHTML 和 XHTML DOCtype。然后在 IE6 和 IE7 等较旧的、功能较弱的浏览器中进行测试，同时尝试维护相同的代码并尽量不引入特定于浏览器的 hack，除非某些浏览器问题足够顽固且足够明显以保证它的存在。您在该领域工作的时间越长，这种情况就越少见，因为您将知道如何防止错误行为，而不必解决它。此外，当您需要处理特定版本的 IE 时，请使用条件注释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-13T16:03:19.270

专用虚拟机是测试所有 IE 版本的最佳方式。

IE9 对 IE7 和 8 的兼容模式和 IE8 对 7 的兼容模式一样有用，只是为了大致了解您的页面；但是，专用虚拟机将公开的 JavaScript 引擎和 css 渲染存在细微差别。IE6 本身就是一个世界。如果您使用的是 Windows 7，则可以免费使用 Microsoft 的虚拟电脑：http: [//www.microsoft.com/windows/virtual-pc/](http://www.microsoft.com/windows/virtual-pc/)

# asp.net - Creating a Facade over Membership Provider

> ID：676038
> 
> 赞同：1
> 
> 时间：2009-03-24T03:04:29.657
> 
> 标签：asp.net, membership-provider, facade

I am using the Membership Provider in ASP.NET MVC and for most data access I use nHibernate and a repository pattern. Do you recommend using a Facade over the Membership Provider so I can create a repository and make it operate a bit more inline with the rest of my entity model? I also have added additional functionality like the ability to add functions to a role and creating the facade would make the classes all a bit nicer.

What have other people done with Membership Provider?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T19:19:43.210

I have solved this exact problem. In the following manner:

`web.config`:

```
<authentication mode="Forms">
  <forms name="APPAUTH"
         defaultUrl="/webapp/Home.mvc"
         loginUrl="/webapp/Session.mvc/Login"
         protection="All"
         timeout="30"
         path="/"/>
</authentication>
<authorization>
  <deny users="?"/>
</authorization>

<location path="Session">
  <system.web>
    <authorization>
      <allow users="*"/>
    </authorization>
  </system.web>
</location> 
```

Then I hook `Application_AuthenticateRequest` something along the lines of:

```
protected void Application_AuthenticateRequest(Object sender, EventArgs e)
{
    string cookieName = FormsAuthentication.FormsCookieName;
    HttpCookie authCookie = Context.Request.Cookies[cookieName];

    if (null == authCookie)
    {
        //no authentication cokie present
        return;
    }

    FormsAuthenticationTicket authTicket = null;
    try
    {
        authTicket = FormsAuthentication.Decrypt(authCookie.Value);
    }
    catch (Exception)
    {
        // Can't do anything if we can't decrypt the ticket so treat it as not there
        FormsAuthentication.SignOut(); // Remove bad ticket
    }

    if (authTicket == null)
    {
        //could not decrypt cookie
        return;
    }

    // get the role
    string[] roles = authTicket.UserData.Split(new char[] { '|' }, StringSplitOptions.RemoveEmptyEntries);

    // Set the security context
    ISecurityService security = ContainerProvider.RequestContainer.Resolve<ISecurityService>();
    Models.User user = security.GetUser(authTicket.Name);

    if (user == null)
    {
        FormsAuthentication.SignOut();
        throw new HttpException((int)System.Net.HttpStatusCode.Unauthorized, "Session expired!");
    }

    AppIdentity id = new AppIdentity(user, !authTicket.Expired);
    AppPrincipal principal = new AppPrincipal(id, roles);

    Context.User = principal;
} 
```

The `ContainerProvider.RequestContainer.Resolve<ISecurityService>();` call is to a [Autofac](http://code.google.com/p/autofac/) container, but you can do anything you need to / want to here.

The `AppIdentity` and `AppPrincipal` classes are custom so I can access my roles, but they are not that complicated.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-11T20:28:52.973

您可以通过继承 MembershipProvider 基类来为站点实现自己的 MembershipProvider。然后只需覆盖通过 nHibernate 执行数据访问所需的方法。

您真正必须实现的唯一功能是 ValidateUser。其余的取决于您在站点中使用的与 MembershipProvider 相关的功能。

# objective-c - 使用 UIImagePickerController 选择图像后，照片库视图保持在屏幕上

> ID：676039
> 
> 赞同：4
> 
> 时间：2009-03-24T03:04:57.627
> 
> 标签：objective-c, iphone, uiimagepickercontroller

在我通过 UIImagePickerController 接口从照片库中选择一张图片后，照片库视图仍然显示，即使我在**imagePickerController:didFinishPickingImage:editingInfo****中**调用了 dismissModelViewControllerAnimated 。

 **有人见过这个吗？这些是我正在使用的三种相关方法：

```
- (IBAction)choosePictureFromLibrary:(id)sender {
    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary]) {
        UIImagePickerController* picker = [[UIImagePickerController alloc] init];
        picker.delegate = self;
        picker.allowsImageEditing = YES;
        picker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
        [self presentModalViewController:picker animated:YES];
        [picker release];
    }
    else {
        UIAlertView* alert = [[UIAlertView alloc] initWithTitle:@"Error accessing Photo Library" message:@"This device does not support a Photo Library." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];
        [alert release];
    }
}

- (void)imagePickerController:(UIImagePickerController*)picker didFinishPickingImage:(UIImage*)image editingInfo:(NSDictionary*)editingInfo {   
    UIAlertView* alert = [[UIAlertView alloc] initWithTitle:@"Picture picked!" message:@"You picked a picture!" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];
    [alert release];

    [picker dismissModalViewControllerAnimated:YES];
}

- (void)imagePickerControllerDidCancel:(UIImagePickerController*)picker {   
    [picker dismissModalViewControllerAnimated:YES];
} 
```

我原以为调用 imagePickerController:didFinishPickingImage:editingInfo 会完全关闭照片库视图，但似乎没有。我还需要做什么才能让它消失吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T19:34:30.673

您需要访问选择器的 viewController 而不是选择器本身。试试这条线。

```
[[picker parentViewController] dismissModalViewControllerAnimated:YES]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T21:38:22.097

你可以打电话

```
[self dismissModalViewControllerAnimated:YES]; 
```

关闭当前视图顶部的任何模态视图控制器。

这是有道理的，因为您通过调用呈现视图控制器：

```
[self presentModalViewController:picker animated:YES]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T12:35:23.603

只是对此答案的更新

```
 [self dismissModalViewControllerAnimated:YES]; 
```

已被弃用，`iOS 6.0`因此您现在需要使用。

```
 [self dismissViewControllerAnimated:YES completion:nil]; 
```

变化不大，但对于任何看到这个问题并且他们正在使用 iOS 6.0 的人来说，他们需要一个更新的答案。

```
 [self presentModalViewController:filePicker animated:YES]; 
```

也已被弃用，取而代之的是

```
 [self presentViewController:filePicker animated:YES completion:nil]; 
```

# wpf - WPF DataGrid - 以编程方式设置 RowDetails

> ID：676042
> 
> 赞同：0
> 
> 时间：2009-03-24T03:05:24.383
> 
> 标签：wpf, datagrid, wpftoolkit

我正在使用 WPF DataGrid，我想知道是否有任何方法可以以编程方式访问 DataGridRow 的 RowDetails。

例如，当用户选择行时，我会从某个地方（例如数据库）获取一些数据，并将其显示在 RowDetails 中。

我见过的所有示例都倾向于只显示一些未包含在行的列中的额外绑定数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T03:11:04.603

您可以显示一些额外的数据，但在 SelectionChanged 上延迟加载。

直接使用 WPF 控件通常并不容易，它们并不是真的要在没有支持数据绑定模型的情况下使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T04:38:38.637

如果您拥有对象列表中的所有数据（或类似的东西），那么您可以做各种有趣的事情。我以这种方式使用 WPF Datagrid，当用户选择一行时，我认为在网格上方填充一个编辑器控件，其中包含行项和其他详细信息。

也就是说，没有什么能阻止您在网格中添加通常隐藏的附加信息，并触发行选择以显示附加数据

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-12T10:05:36.160

您可以使用以下代码

DataRowView 行 = (DataRowView)MyDataGrid.SelectedItem; 字符串 strName = row.Row["Name"].ToString(); //其中“名称”是列名

# c - 如何在 C 中的二叉搜索树中正确插入/删除？

> ID：676048
> 
> 赞同：2
> 
> 时间：2009-03-24T03:09:20.630
> 
> 标签：c, search, insert, binary-tree

我有点不得不搁置我以前的 C 问题，因为这个问题现在更重要......

我已经在我的二叉搜索树上编写了插入和删除函数，但删除函数不完整。有几件事我需要帮助...

**1）**我的插入功能好还是可以以某种方式改进？

**2）**我的删除功能缺少删除左右子节点的节点。在过去的几个小时里，我进行了很多搜索，但找不到合适的方法。

**2.a)**我应该如何删除一个有 2 个子节点的节点？

**2.b）**和第一个问题一样，删除功能好还是可以改进？这个我知道它可以，因为我在那些 if 中重复了很多代码，但我不知道如何改进它，我也需要帮助。

```
typedef struct sClientProfile *ClientProfile;
typedef struct sClientTree *ClientTree;

typedef struct sClientProfile {
    char *clientName;
    int clientAge;
    int clientNIF;
} nClientProfile;

typedef struct sClientTree {
    ClientProfile clientProfile;
    char *clientName;

    ClientTree leftTree;
    ClientTree rightTree;
} nClientTree;

void addClientToTree(ClientTree *cTree, ClientProfile cProfile) {
    if(!*cTree) {
        ClientTree new = (ClientTree)malloc(sizeof(nClientTree));

        if(!new) {
            perror("malloc");
        }

        new->clientName = strdup(cProfile->clientName);
        new->clientProfile = cProfile;

        new->leftTree = NULL;
        new->rightTree = NULL;

        *cTree = new;
    } else {
        if(strcmp((*cTree)->clientName, cProfile->clientName) > 0) {
            addClientToTree(&(*cTree)->leftTree, cProfile);
        } else {
            addClientToTree(&(*cTree)->rightTree, cProfile);
        }
    }
}

void deleteClientFromTree(ClientTree *cTree, char *cName) {
    if(!cTree) return;

    int nCompare = strcmp((*cTree)->clientName, cName);

    if(nCompare > 0) {
        deleteClientFromTree(&(*cTree)->leftTree, cName);
    } else if(nCompare < 0) {
        deleteClientFromTree(&(*cTree)->rightTree, cName);
    } else {
        if(!(*cTree)->leftTree && !(*cTree)->rightTree) {
            ClientTree cliPtr = *cTree;

            free(cliPtr->clientProfile);
            free(cliPtr);

            cliPtr->clientProfile = NULL;
            cliPtr = NULL;

            *cTree = NULL;
        } else if(!(*cTree)->leftTree) {
            ClientTree cliPtr = *cTree;

            free(cliPtr->clientProfile);
            free(cliPtr);

            cliPtr->clientProfile = NULL;

            *cTree = (*cTree)->rightTree;
        } else if(!(*cTree)->rightTree) {
            ClientTree cliPtr = *cTree;

            free(cliPtr->clientProfile);
            free(cliPtr);

            cliPtr->clientProfile = NULL;

            *cTree = (*cTree)->leftTree;
        } else {

            // MISSING DELETE CASE

        }
    }
} 
```

你可能会注意到，但让我说两句：

*   该树使用字符串而不是普通的 int 表示。这就是我一直使用 strcmp() 的原因，我认为我使用它是正确的。
*   我没有使用递归，我宁愿传递指针（在这种情况下是结构指针）并使用它。不知何故，它看起来更干净，将来如果节点被删除，我想返回一个成功值。

**更新如下：**
我已经完成了删除功能的迭代版本，但我不喜欢它的一些东西，也许它们可以改进（或不改进），但我看不出如何。我还尝试对丢失的情况进行编码，删除一个有 2 个孩子的节点，但它没有按应有的方式工作......

我已经评论了整个代码，我认为代码可以改进以及问题出在哪里。我还将这些问题命名为 A、B（不再有 B）、C 和 D，因此我们可以轻松地引用它们。

```
bool deleteClientFromTree(ClientTree *cTree, char *cName) {
    if(!cTree) return FALSE;

    ClientTree currPtr = *cTree;
    ClientTree prevPtr = NULL;
    int nCompare;

    while(currPtr) {
        nCompare = strcmp(currPtr->clientName, cName);

        if(nCompare > 0) {
            prevPtr = currPtr;
            currPtr = currPtr->leftTree;
        } else if(nCompare < 0) {
            prevPtr = currPtr;
            currPtr = currPtr->rightTree;
        } else {
            /*
             * A)
             * 
             * The following cases have 3 lines in common, the free()
             * calls and return statement. Is there anyway to improve
             * this code and make it more compact?
             * 
             * Of course, the printf's are to be removed...
             */
            if(!prevPtr && !currPtr->leftTree && !currPtr->rightTree) {
                printf("CASE #1\n");

                *cTree = NULL;

                free(currPtr->clientProfile);
                free(currPtr);

                return TRUE;
            } else if(!currPtr->leftTree || !currPtr->rightTree) {
                printf("CASE #2\n");

                if(prevPtr->leftTree == currPtr) {
                    prevPtr->leftTree = currPtr->rightTree;
                } else {
                    prevPtr->rightTree = currPtr->leftTree;
                }

                free(currPtr->clientProfile);
                free(currPtr);

                return TRUE;
            } else {
                printf("CASE #3\n");

                ClientTree tempPtr = currPtr->rightTree;

                while(tempPtr->leftTree) {
                    tempPtr = tempPtr->leftTree;
                }

                /*
                 * C)
                 * 
                 * This has a big problem...
                 * 
                 * If you take a look at the ClientProfile structure,
                 * in the first post, you'll see two ints
                 * (clientNIF/clientAge) and one char* (clientName).
                 * 
                 * The problem is that the following code line is only
                 * copying the integer data, not the string. For some
                 * reason, the string remains the old one.
                 * 
                 * I tried to use strdup() directly on clientName like:
                 * currPtr->clientProfile->clientName = strdup(tempPtr->clientProfile->clientName);
                 * but it still doesn't work.
                 * 
                 * Why everything is being copied but the strings?
                 */
                currPtr->clientProfile = tempPtr->clientProfile;

                /*
                 * D)
                 * 
                 * Is there anyway to not call the function itself
                 * and make the while loop once again and delete the
                 * corresponding leaf?
                 */
                return deleteClientFromTree(&currPtr->rightTree, tempPtr->clientProfile->clientName);
            }
        }
    }

    return FALSE;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T20:42:52.890

当你删除一个节点时，你必须对它的子节点做一些事情。

如果没有孩子 - 没问题。您只需删除节点。

如果有一个左孩子，也没有问题；您删除节点并将其左子节点移动到它的位置。

对的孩子也一样；只需将孩子移动到已删除节点的位置即可。

当您要删除同时具有左右子节点的节点时，问题就来了。您可以将左或右子节点移动到已删除节点的位置，但是您如何处理另一个子节点及其子树？

解决方案是这样的；您找到要删除的节点的逻辑继任者。我所说的逻辑继任者是指这个；假设你有一棵由整数组成的树，你删除了值为 35 的节点，逻辑后继*是下一个最大的数字*。是吗？如果您正在执行有序遍历，那么它将是您在删除元素之后到达的元素。

现在，有一个简单的规则可以找到逻辑继任者；你向右走（你总是有一个权利，因为这是你有两个孩子的情况），然后你尽可能向左走。

你最终得到的那个元素是合乎逻辑的继任者。它比被删除的元素大（你一开始就走对了，记得吗？）但它是*最小的下一个最大的元素*。

现在，那个元素总是只有一个或没有孩子——因为你尽可能地向左走，记得吗？所以你不能再向左走 - 因为没有左边 - 所以该元素没有孩子或只有一个右孩子，这意味着它属于易于取消链接的类别之一（没有孩子或只有一个孩子） . 所以取消链接*这个*元素很容易。

现在来了很酷的一点-考虑一下；如果下一个最大的元素与您要删除的元素在树中的相同位置，*则树仍然有效且正确*- 因为每个元素左侧的所有内容都较小，右侧的所有内容都较大。

所以你要做的是这个；您将下一个最大节点中的用户数据复制到要删除的节点中，然后删除*下一个最大节点*（它没有子节点或只有右子节点，因此很容易取消链接和删除）。

就是这样！

所以，基本上 - 找到您的逻辑继任者，将他与树断开链接并将他的用户数据放入您实际删除的元素中（当然，您不会删除它，因为它仍然是树的物理部分）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T03:17:54.757

首先，您提到您没有使用递归，但每个函数都有一个调用自身的逻辑路径。

关于问题：

1）删除递归。如果你的树大到足以炸掉你的筹码，这会给你带来很多麻烦。Gcc 对尾递归的支持有限，但我不会指望它。

2）通常，当您删除具有两个节点的子节点时，您会将左侧或右侧节点提升到已删除节点所在的位置。（这是一个非常简单的情况，我假设您的树不平衡）

2.b）您的删除代码有一些问题。我建议通过一些假设的情况来遍历它。对我来说立即显而易见的是释放一个指针，然后将其推迟：

```
free(cliPtr);

cliPtr->clientProfile = NULL; 
```

当然，一旦确定了正确性，您总是可以担心风格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T08:01:01.317

理想情况下，删除 BST 中的节点有以下三种情况：

情况1：

```
X has no children: remove X 
```

案例二：

```
X has one children : Splice out X 
```

案例3：

```
X has two children : swap X with its successor and follow case #1 or #2 
```

所以对于丢失的删除案例：

当 X（要删除的节点）有两个子节点时，将 X 替换为 X 的后继节点，并遵循 case #1 或 case #2。您也可以用它的前身替换，可能是一个不错的选择。

`if ( X->left && X->right)` `{`

```
NODE *Successor = FindSuccessor(X);
X->data = Successor->data;
free(Successor); 
```

`}`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-11T00:59:30.410

这个二进制代码是插入、删除、搜索和退出。例子：

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.*;

public class Binary Tree {

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        LinkedList ll = new LinkedList();

        ll.add("\n"+"mai    0020");
        ll.add("\n"+"king   0019");
        ll.add("\n"+"maan   0002");
        ll.add("\n"+"dimple 0024");
        ll.add("\n"+"eman   0004");
        ll.add("\n"+"lara   0005");
        ll.add("\n"+"cute   0008");
        ll.add("\n"+"irene  0011");
        ll.add("\n"+"sheena 0030");
        ll.add("\n"+"aisy   0003");

        System.out.println("display: " + ll);
        System.out.println("\n\n");

        for(int c=0; c<=10; c++) {
            System.out.println("select from: 1-insert, 2-delete," + 
                               " 3-display, 4-search, 5-quit");

            String x = br.readLine();
            int y = Integer.parseInt(x);
            switch (y) {
                case 1: //inserting
                    System.out.println("input name");
                    String n= br.readLine();
                    System.out.println("input a list number");
                    String o = br.readLine();
                    int z = Integer.parseInt(o);
                    ll.add("\n"+n+" "+z);
                    break;
                case 2: // delete   
                    ll.removeFirst();
                    break;
                case 3: //Display
                    System.out.println("\n\n"+"List of employee: " + ll);       
                    System.out.println("\n\n");
                    break;
                case 4: //search
                    System.out.println("\n");
                    System.out.println("Search");

                    System.out.println("first element of the Linkedlist is: "
                                       + ll.getFirst());
                    System.out.println("\n\n");
                    System.out.println("last element of linkedlist:"
                                       + ll.getLast());     
                    break;
                case 5: //quit
                    System.out.println("\n\n\n\n\n" 
                                       + " Thank You Very Much!!!!!!!\n\n\n");
                    System.exit(0);
                    break;
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-17T07:07:57.097

```
int delete_value(Tree*&root,Tree*&find,Tree*&ptr,int numb){
    if(find->value==number){
//the number exist in the root,so we should find the highest value inside the right brache and replace it with the root.
    Tree*ptr2=NULL;
    Tree*ptr3=NULL;//pointer pointing to the parent of the last element of ptr2.
    ptr2=root->right;
    while(ptr2!=NULL){
        ptr3=ptr2;
        ptr2=ptr2->left;
    }
    if(ptr2->right!=NULL){
        ptr3->left=ptr2->right;
    }
    swap(ptr2->value,root->value);
    delete ptr2;
    ptr2=ptr3=NULL;
    }

    else{
        while(find->value!=numb){
            if(find->value!=numb){
                ptr=find;
            }
            if(find->value < numb){
                find=find->right;
                return delete_value(root,find,ptr,numb);
            }
            else{
                find=find->left;
                return delete_value(root,find,ptr,numb);
            }
        }//end of while
    }//end of else
//the pointer find is pointing at the element we want to delete.
//the pointer ptr  is pointing at the element before the one's we want to delete.
//case 1:the element to delete don't have any children
    if(find->right==NULL && find->left==NULL){
        if(ptr->left=find){
            ptr->left=NULl;
            delete find;
        }
        else{
            ptr->right=NULL;
            delete find;
        }
    }//end of the first case.
//case 2:the element has one child it could be to the left or to the right.
    //a-child to the right.
    if( find->right!=NULL && find->left==NULL ){
        Tree*ptr2=find->right;
        while(ptr2!=NULL){
            ptr2=ptr2->left;//find the highest value in the right branche and replace it with the delete element
        }
        swap(find->value,ptr2->value);
        delete ptr2;
        ptr2=NULL;
    }
    //b-child to the left.
    if(find->right==NULL && find->left!=NULL){
        Tree*ptr2=find->left;
        //check wether the find element is to the right or to the left of ptr.
        if(ptr->left==find){
            ptr->left=ptr2;
            delete find;
        }
        else{
            ptr->right=ptr2;
            delete find;
        }
    }//end of the second case.

//case3: the element has to children.
    if(find->right!=NULL&&find->left!=NULL){
        Tree*ptr2=find->left;
        while(ptr2->right!=NULL){
            ptr2=ptr2->right;
        }
        swap(ptr2->value,find->value);
        delete ptr2;
        ptr2=NULL;
    }//end of case 3.
}//end of the function. 
```

# php - 如何在 PHP 应用程序中实现多语言？

> ID：676050
> 
> 赞同：0
> 
> 时间：2009-03-24T03:10:07.273
> 
> 标签：php, internationalization, translation

我自己发布了这个问题，因为我发现帖子缺少完整的解释或最好的方法。

我应该使用语言文件来命名项目，例如：

$first_name='名字'; $last_name = '姓氏';

然后根据选择包含此文件？

我有一个需要两种语言的应用程序。

会喜欢以下几行：

[http://www.myapp.com/?lang=en](http://www.myapp.com/?lang=en) [http://www.myapp.com/?lang=es](http://www.myapp.com/?lang=es)

我应该为此使用常量文件吗？

常量.php

define('OPERATION_NOT_ALLOWED_EN', '这个操作是不允许的！');

define('OPERATION_NOT_ALLOWED_ES', '这个操作是不允许的！');

完成此操作的推荐方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T03:24:10.420

你可以跟随 phpBB 的脚步——他们使用一个`$lang[]`数组，代码如下：

```
$lang['Next'] = 'Next';
$lang['Previous'] = 'Previous';
$lang['Goto_page'] = 'Goto page';
$lang['Joined'] = 'Joined';
$lang['IP_Address'] = 'IP Address';

$lang['Select_forum'] = 'Select a forum';
$lang['View_latest_post'] = 'View latest post';
$lang['View_newest_post'] = 'View newest post';
$lang['Page_of'] = 'Page <b>%d</b> of <b>%d</b>'; // Replaces with: Page 1 of 2 for example

$lang['ICQ'] = 'ICQ Number';
$lang['AIM'] = 'AIM Address';
$lang['MSNM'] = 'MSN Messenger';
$lang['YIM'] = 'Yahoo Messenger'; 
```

它当然包含在用户设置中指定的文件中，但是您可以`?lang=en`在查询字符串中访问类似于`constants.php`文件的内容的建议。

为清楚起见，您可能需要命名文件`lang_en.php`或类似名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T03:25:55.550

这将适用于您在示例中给出的字符串。但还有其他并发症。例如，您是否想以适合区域设置的格式（es 与 en？）来格式化日期。数字和货币的格式如何？此外，您可能有“动态”消息：“您的收件箱中有 $x 条消息”。你想传递变量的地方。查看一些 php 本地化库。这是一个在线教程： http: [//www.devx.com/webdev/Article/38732](http://www.devx.com/webdev/Article/38732)。

还要查看您正在使用的框架。其中许多具有本地化支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T09:20:55.773

你应该如何实施它？喜欢[`Zend_Translate`](http://framework.zend.com/manual/en/zend.translate.html#zend.translate.introduction)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T03:23:16.197

我会使用带有常量的特定于语言环境的文件，例如：

```
locale_en.php:

define('GREETING', "Welcome to Widgets Inc'); 
```

和

```
locale_de.php:

define('GREETING', 'Wir begruessen Sie zu Widgets Inc'); 
```

在您的设置中，您检测语言环境并执行以下操作：

```
if ($locale == 'en') {
  require 'locale_en.php';
} else if ($locale == 'de') {
  require 'locale_de.php';
} 
```

这为您提供了常量的好处，并使本地化对您的应用程序相当透明，因为您不必到处做`if ($locale ...`。如果有任何特定于语言环境的内容，只需将其放在语言环境文件中即可。

如果你想添加一个语言环境文件，只需复制一个现有的文件并更改所有引用，而不是为它们搜索你的代码库。

您还可以将代码放入这些文件中，例如为这些语言环境正确格式化数字和日期（包括每种语言中的正确名称，以及逗号、引号、句点等的使用）、货币转换和显示等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T03:31:13.463

有免费的第 3 方控件可以使用 ISO 标准 XML 文件执行此操作（我编写了一个数据库实用程序来创建、编辑和导出这种格式）。

其他答案是非常手动的，并且比使用此控件涉及更多的工作。

您需要的控件位于： [http ://ezcomponents.org/docs/api/trunk/introduction_Translation.html](http://ezcomponents.org/docs/api/trunk/introduction_Translation.html)

在服务器上安装 eZ 组件后，您需要检索所有 eZ 组件所需的基本控件

```
require_once "ezc/Base/base.php";
/**
 * __autoload()
 *
 * @param mixed $className
 * @return
 */
function __autoload( $className )
{
    ezcBase::autoload( $className );
} 
```

然后您必须定义 XML 语言文件的位置（参见：ISO639-2、ISO3166 和 Qt Linguist）

```
$config["language_code"] = "en_us"; // as defined by ISO639-2 and ISO3166

// grab our translation XML file
$backend = new ezcTranslationTsBackend( dirname( __FILE__ ). '/translations' );
$backend -> setOptions( array( 'format' => $config["language_code"].'.xml' ) );

// create a manager object
$manager = new ezcTranslationManager( $backend );

$language = $manager->getContext( $config["language_code"], 'strings' ); 
```

现在您可以通过简单地调用以下函数来获取字符串

```
getTranslation( "SOME_KEY" ); 
```

要检索具有参数的短语，请使用以下语法，请注意 [KEYWORD] 和“关键字”之间的关系是有意的，建议使用

```
getTranslation( "FIND_[KEYWORD]_BY_[TYPE]", array("keyword" => $keyword, "type" => $type ) ); 
```

TS XML 文件的一个示例是（应称为 en_US.xml）

```
<!DOCTYPE TS>
<TS>
<context>
    <name>strings</name>
    <message>
        <source>ZONE_TYPE</source>
        <translation>Zone Type</translation>
    </message>
    <message>
        <source>ZONE_TOOL</source>
        <translation>Zone Tool</translation>
    </message>
    <message>
        <source>HELLO_[NAME]_WELCOME_TO</source>
        <translation>Hello, %name, welcome to Webfood Admin</translation>
    </message>
    <message>
        <source>YOUR_ADMINISTRATIVE_SESSION_HAS</source>
        <translation>Your administrative session has timed out. Please login again.</translation>
    </message>
</context>
</TS> 
```

我只需要在您的 PHP 会话中设置一个存储使用的语言的设置，可能会在用户登录他们想要的语言之前或之后询问用户，如果您有帐户，则将其存储到他们的用户表中。没有理由一遍又一遍地发送 URL 值，这是个坏主意。

# tfs - 更改 TFS 构建的位置

> ID：676059
> 
> 赞同：5
> 
> 时间：2009-03-24T03:16:28.817
> 
> 标签：tfs, build-automation

我有一个 TFS 构建服务器，其中发生 CI 和发布构建。构建过程在某个域帐户下运行，所有构建活动都发生在该用户的临时目录下。不幸的是，\Users 目录位于 C: 驱动器上，结果证明它没有太多空间。尽管构建保留策略非常严格，但配置了足够的构建，这个空间变得非常稀缺。

机器上还有其他具有足够空间的卷。

任何人都可以建议一种简单的方法来更改根构建目录吗？到目前为止，我一直在寻找 TFS 财产，但没有取得多大成功。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T08:55:55.100

对于 TFS 2008，右键单击 Builds 节点并选择“Manage Build Agents”。选择选择的代理，然后按“编辑...”并更改工作目录。我个人的偏好是将其更改为：

c:\bw\$(BuildDefinitionId)

因为这将为您的构建提供一个简短的工作文件夹（.NET API 对文件路径有 260 个字符的限制，因此在您的工作文件夹中使用尽可能少的这些字符可以让您在构建期间更多地使用）。

对于 TFS 2005，编辑相关构建的 TFSBuild.proj 文件并将工作属性更改为指向每个构建所需的位置。

希望有帮助，

马丁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T04:53:43.390

在团队资源管理器视图中，

右键单击 Builds -> Manage Build Agents，

选择构建代理并点击“编辑...”

将“工作目录”设置为

<新建构建根目录>\$(BuildDefinitionPath)

这适用于使用该构建代理的所有项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T04:06:25.280

我的 TFS proj 文件有一个名为 BuildDirectoryPath 的属性

```
<BuildDirectoryPath>c:\build</BuildDirectoryPath> 
```

这是放置我所有源代码的地方以及构建二进制文件的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-13T00:18:55.253

为 VS2012 / TFS2012 Server 提供答案。

这将逐个代理更新工作目录 - 团队资源管理器窗口 - 单击构建 - 单击操作并选择管理构建控制器 - 对于每个代理，单击属性并在工作目录字段内单击并更改它，单击确定时你完成了

注意：OP 谈到了域帐户和临时文件夹。因此，此解决方案可能不适用于 OP，但在我的情况下，它确实可以从系统 (C) 驱动器移动到备用卷（在我们的情况下为 D）。

# linux - makefile 可以更新调用环境吗？

> ID：676060
> 
> 赞同：6
> 
> 时间：2009-03-24T03:17:08.333
> 
> 标签：linux, makefile, fedora

是否可以从 makefile 更新环境？我希望能够创建一个目标来为它们设置客户端环境变量。像这样的东西：

```
AXIS2_HOME ?= /usr/local/axis2-1.4.1
JAVA_HOME  ?= /usr/java/latest
CLASSPATH  := foo foo

setenv:
    export AXIS2_HOME
    export JAVA_HOME
    export CLASSPATH 
```

这样客户就可以简单地做：

```
make setenv all
java MainClass 
```

并且无需他们自己为 java 执行设置类路径就可以工作。

还是我想以错误的方式做到这一点并且有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T03:29:33.247

不，您不能以这种方式更新调用过程中的环境。一般来说，子进程不能修改父进程的环境。一个值得注意的例外是 Windows 上的批处理文件，当从 cmd shell 运行时。根据您展示的示例，我猜您并没有在 Windows 上运行。

通常，您要完成的工作是通过设置环境然后调用您想要的进程的 shell 脚本来完成的。例如，您可能会编写如下 go.sh 脚本：

```
!#/bin/sh
AXIS2_HOME=/usr/local/axix2-1.4.1
JAVA_HOME=/usr/java/latest
CLASSPATH=foo foo
export AXIS2_HOME
export JAVA_HOME
export CLASSPATH
java MainClass 
```

使 go.sh 可执行，现在您可以将应用程序作为`./go.sh`. 如果您愿意，您也可以使您的脚本更加精细——例如，您可能希望将“MainClass”作为脚本的参数，而不是对其进行硬编码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T03:51:57.173

根据您的问题，我假设您正在使用 bash shell。

您可以将变量定义放在 shell 脚本中，如下所示：

```
AXIS2_HOME=/usr/local/axis2-1.4.1
export AXIS2_HOME
#etc 
```

然后`source`把脚本放到当前环境中，用

```
source <filename> 
```

要不就

```
. <filename> 
```

*这会在当前 shell 中*执行脚本（即没有子进程），因此脚本所做的任何环境更改都将持续存在。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2009-03-24T03:31:26.973

快速回答是肯定的，但是在您的代码中，您需要在 setenv: 指令中定义变量。在 Makefile 的开头执行此操作使其成为 Makefile 的局部变量。我会在文件顶部使用 LOCAL_... 然后在 setenv: 指令中使用 VAR=LOCAL_VAR 等设置它...另外请记住，您只需要使用 make setenv 调用 makefile。我真的会考虑在 bash 脚本中执行此操作，因为需要在 Makefile 之外创建变量。在环境中生成变量后，您应该能够从 Makefile 进行分配和导出。

# php - 使用两台服务器设置的最佳或最佳 Web 服务器，开发实践

> ID：676064
> 
> 赞同：0
> 
> 时间：2009-03-24T03:21:37.557
> 
> 标签：php

我将我们公司的网站（x8 每月总计 500,000 个）在 1/3 共享的虚拟服务器上升级到 1 台实时服务器和 1 台热备份服务器。这两个都是我们自己的，运行 Debian、A2、M5、P5.2。活的比备用的多肉。

设置和使用这些服务器的最佳方式是什么？

我们办公室里没有本地开发机器，所以我希望第一个可以运行，如果第一个出现故障或者我们想要升级它，第二个也可以失败。

MySQL 将在第二次作为从属服务器运行。

它的设置方式（它们还没有上线，系统管理员已经给我了）是实时 rsync 每小时备份一次，我们应该实时更新。

但这似乎是一种浪费，没有备份的价值。

如果我在备份上运行 svn。然后是从 svn 导出的站点的 staging/dev 副本，并在需要时使用 rsync 进行备份。数据库必须在备份时只读，因为很难在一台服务器上运行两个版本的 db。然后 live 也会每隔一小时重新同步一次以备份到第二个位置（这样就有一个准备好失败的实时副本）。

这有意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T03:44:43.117

您应该像这样运行您的主要和备份。将 MySQL 从您的主服务器复制到您的辅助服务器。使用 ApacheX.X 虚拟主机将您的（开发、舞台、直播）分开并将它们同步到一起。在这种情况下，这将允许最好的“物有所值”。在两者上都执行 SVN，因为主要/次要在服务和硬盘设置中应该几乎相同。我想你会做得很好;)

# html - 你能设计一个 noscript 元素吗？

> ID：676069
> 
> 赞同：14
> 
> 时间：2009-03-24T03:26:17.670
> 
> 标签：html, css, noscript

`noscript`是否可以在 CSS 选择器中使用该元素？

```
noscript p {
    font-weight: bold;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-24T03:29:12.093

是的！你绝对可以做到这一点。

事实上，许多（~~所有？~~）浏览器都支持使用 CSS 定位任意标签。HTML 规范中的“官方”标签只定义了浏览器应该如何处理它们。但是 CSS 是一种针对任何 XML 风格的语言，因此您可以说`foo {font-weight:bold;}`，并且在大多数浏览器中，它`<foo> hello world </foo>`会显得粗体。

正如[Darko Z](https://stackoverflow.com/questions/676069/can-you-style-a-noscript-element/676111#676111)所阐明的，IE6/7 不会从源代码自动向 DOM 添加任意（非标准）元素；它们必须以编程方式添加。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-09-24T10:39:54.767

我有一个 IE 错误要记住。如果像 OP 一样，您只想在 noscript 标记中设置文本样式而不是 noscript 标记本身，请忽略这一点。

假设你想让 noscript 标签的背景变成红色。在 IE8 中，它将显示启用 JS。只是盒子本身，而不是里面的文字。

所以这个组合不好：

**CSS**

```
noscript {
    background-color: red;
} 
```

**HTML**

```
<noscript>Turn on your damned JavaScript! What is this, 1999?</noscript> 
```

但是这种解决方法效果很好：

**CSS**

```
noscript div {
    background-color: red;
} 
```

**HTML**

```
<noscript><div>Turn on your damned JavaScript! What is this, 1999?</div></noscript> 
```

奇怪的是，我只在 IE8 中看到这种行为，而不是 IE7。谁知道6..

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T03:53:55.607

除了[Rex M 的回答](https://stackoverflow.com/a/676076/32943)- IE 6/7 (6 def, 7 也许？) 不会为您设置任意标签的样式。但幸运的是，对于~~所有~~许多 IE 问题，有一个解决方法。

假设您想为一个名为`foo`. 要让 IE 将其识别为可样式化元素，您需要在 JS 中的某处包含此行：

```
document.createElement('foo'); 
```

您不需要附加它，只需创建它。

这将让 IE 使用 CSS 规则为您设置该元素的样式：

```
foo { font-weight:bold; } 
```

# asp.net-mvc - asp.net MVC 验证框架的选项

> ID：676070
> 
> 赞同：2
> 
> 时间：2009-03-24T03:26:35.563
> 
> 标签：asp.net-mvc, validation, xval

我现在正在考虑两个选项，用于我开始的 ASP.net 项目的基于模型的验证：

[xVal](http://xval.codeplex.com/)（Steve Sanderson 的项目）和 Stephen Walther 在[此页面上使用的 Enterprise 模块](http://www.aspworkshops.com/blog/archive/2008/09/10/asp-net-mvc-tip-43-use-data-annotation-validators.aspx)

我真的不太了解这些偏好，因为我还没有使用过它们中的任何一个。有任何想法吗？

**立即更新**使用 LinqToSql 进行 ORM，但对更改持开放态度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T12:16:30.877

我在回顾这两者时看到的一个区别是 Stephen Walther 的博客文章描述了一个仅在 Web 服务器中进行验证的库，而 xVal 也与 jQuery 验证器一起进行浏览器内验证。顺便说一句，这个功能几乎是完全自动的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T04:18:38.170

[FluentValidation](http://www.codeplex.com/FluentValidation)很好。NHibernate 还内置了模型验证。然后你需要像[Scott Guthrie 的技术](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)来将错误绑定到 UI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T04:55:04.040

我一直在使用 xVal 并将其集成到 MVC RC1 中引入的 IDataErrorInfo 接口中。我喜欢。

这是我写的一篇文章，它解释了一些事情。

[http://schotime.net/blog/index.php/2009/03/05/validation-with-aspnet-mvc-xval-idataerrorinfo/](http://schotime.net/blog/index.php/2009/03/05/validation-with-aspnet-mvc-xval-idataerrorinfo/)

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T05:06:51.890

无耻地推广我的[验证库](http://www.codeplex.com/aspmvcvalidation)。专为 jQuery 验证和企业库而构建，开箱即用。也就是说，功能和代码足够简单，可以根据需要进行修改/扩展。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-12T12:02:36.520

[您还可以在 LosTechies http://www.lostechies.com/blogs/hex/archive/2009/06/10/opinionated-input-builders-for-asp-net-mvc-part-5-](http://www.lostechies.com/blogs/hex/archive/2009/06/10/opinionated-input-builders-for-asp-net-mvc-part-5-the-required-input.aspx)上查看这项新技术[the-required-input.aspx](http://www.lostechies.com/blogs/hex/archive/2009/06/10/opinionated-input-builders-for-asp-net-mvc-part-5-the-required-input.aspx)我喜欢你的输入是全局设置的，这真的很干。你也可以跳过客户端验证，向服务器提交一个 jquery ajax 提交表单，它在一个地方执行验证模型和业务逻辑，这也是 DRY :) 这也意味着你可以更快地把产品拿出来您可以稍后添加客户端验证作为奖励或逐步增强表单。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-12T12:21:01.920

再次投票给 xVal。真的很甜 我喜欢使用[Buddy Classes](http://goneale.com/2009/03/04/using-metadatatype-attribute-with-aspnet-mvc-xval-validation-framework/)并`DataAnnotations`进行验证提升。除了使事情与 Linq2Sql 一起工作之外，因为您无法向字段添加属性，伙伴类提供了一些灵活性，可以让多个模型共享相同的验证信息。对于那些似乎总是变得必要的 ModelEditData 类来说真的很方便。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T03:54:28.647

你在使用 ORM 吗？如果是这样，您使用的是哪一个？[在使用Castle ActiveRecord](http://castleproject.org/)时，我很幸运，只需坚持使用默认的模型级验证即可。但是，如果您不使用它，这可能并没有太大帮助。:-)

# c# - Image.FromStream() method returns Invalid Argument exception

> ID：676072
> 
> 赞同：13
> 
> 时间：2009-03-24T03:28:06.357
> 
> 标签：c#, .net, image, exception, memorystream

I am capturing images from a smart camera imager and receiving the byte array from the camera through socket programming (.NET application is the client, camera is the server).

The problem is that i get System.InvalidArgument exception at runtime.

```
private Image byteArrayToImage(byte[] byteArray) 
{
    if(byteArray != null) 
    {
        MemoryStream ms = new MemoryStream(byteArray);
        return Image.FromStream(ms, false, false); 
        /*last argument is supposed to turn Image data validation off*/
    }
    return null;
} 
```

I have searched this problem in many forums and tried the suggestions given by many experts but nothing helped.

I dont think there is any problem with the byte array as such because When i feed the same byte array into my VC++ MFC client application, i get the image. But this doesn't somehow work in C#.NET.

Can anyone help me ?

P.S :

Other methods i've tried to accomplish the same task are:

1.

```
private Image byteArrayToImage(byte[] byteArray)
{
    if(byteArray != null) 
    {
        MemoryStream ms = new MemoryStream();
        ms.Write(byteArray, 0, byteArray.Length);
        ms.Position = 0; 
        return Image.FromStream(ms, false, false);
    }
    return null;
} 
```

2.

```
private Image byteArrayToImage(byte[] byteArray) 
{
    if(byteArray != null) 
    {
        TypeConverter tc = TypeDescriptor.GetConverter(typeof(Bitmap));
        Bitmap b = (Bitmap)tc.ConvertFrom(byteArray);
        return b;
    }
    return null;
} 
```

None of the above methods worked. Kindly help.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-10-09T10:02:08.133

`Image.FromStream()`需要一个只包含一个图像的流！

它将 stream.Position 重置为 0。我有一个包含多个图像或其他内容的流，您必须将图像数据读入字节数组并用它初始化**MemoryStream**：

```
Image.FromStream(new MemoryStream(myImageByteArray)); 
```

只要图像在使用中，MemoryStream 就必须保持打开状态**。**

我也以艰难的方式学会了这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-02T15:47:44.180

也许图像嵌入在 OLE 字段中，您必须考虑 88 字节 OLE 标头加上有效负载：

```
byteBlobData = (Byte[]) reader.GetValue(0);
stream = new MemoryStream(byteBlobData, 88, byteBlobData.Length - 88);
img = Image.FromStream(stream); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T03:55:02.343

我猜从服务器接收文件时出了点问题。在尝试将其转换为`Image`? 您*确定*它与您提供给 C++ 应用程序的字节数组完全相同吗？

尝试将流保存到文件中，看看你得到了什么。你也许可以在那里发现一些线索。

您还可以添加断点并手动将字节数组中的某些字节与它们应该是的（如果您知道的话）进行比较。

* * *

编辑：看起来接收数据没有问题。问题在于它是原始格式（不是可以`Image.FromStream`理解的格式）。[`Bitmap(Int32, Int32, Int32, PixelFormat, IntPtr)`构造函数](http://msdn.microsoft.com/en-us/library/zy1a2d14.aspx)在这里可能有用。或者，您可以创建空白位图并从原始数据手动对其进行 blt。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-27T21:59:29.837

这样做时我遇到了这个问题：

```
MemoryStream stream = new MemoryStream();
screenshot.Save(stream, ImageFormat.Png);
byte[] bytes = new byte[stream.Length];
stream.Save(bytes, 0, steam.Length); 
```

最后两行是问题所在。我通过这样做来修复它：

```
MemoryStream stream = new MemoryStream();
screenshot.Save(stream, ImageFormat.Png);
byte[] bytes = stream.ToArray(); 
```

然后这奏效了：

```
MemoryStream stream = new MemoryStream(bytes);
var newImage = System.Drawing.Image.FromStream(stream);
stream.Dispose(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T03:47:05.267

`System.InvalidArgument`表示流没有有效的图像格式，即不支持的图像类型。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-05T06:21:23.220

Try this:

```
public Image byteArrayToImage(byte[] item)
{          
   Image img=Image.FromStream(new MemoryStream(item)); 
   img.Save(Response.OutputStream, ImageFormat.Gif);
   return img;
} 
```

Hope it helps!

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T03:53:54.937

我过去也遇到过同样的问题，它是由 Windows GDI 库中的泄漏引起的，这就是“位图”所使用的。但是，如果这种情况一直发生在您身上，那么它可能无关紧要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-07T17:37:05.830

**此代码正在运行**

```
 string query="SELECT * from gym_member where Registration_No ='" + textBox9.Text + "'";

        command = new SqlCommand(query,con);
        ad = new SqlDataAdapter(command);
        DataTable dt = new DataTable();
        ad.Fill(dt);
        textBox1.Text = dt.Rows[0][1].ToString();
        textBox2.Text = dt.Rows[0][2].ToString();
        byte[] img = (byte[])dt.Rows[0][18];
        MemoryStream ms = new MemoryStream(img);

        pictureBox1.Image = Image.FromStream(ms);
        ms.Dispose(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-01-05T17:56:48.310

尝试使用类似于此处描述的内容[https://social.msdn.microsoft.com/Forums/vstudio/en-US/de9ee1c9-16d3-4422-a99f-e863041e4c1d/reading-raw-rgba-data-into-位图](https://social.msdn.microsoft.com/Forums/vstudio/en-US/de9ee1c9-16d3-4422-a99f-e863041e4c1d/reading-raw-rgba-data-into-a-bitmap)

```
Image ImageFromRawBgraArray(
    byte[] arr, 
    int charWidth, int charHeight,
    int widthInChars, 
    PixelFormat pixelFormat)
{
    var output = new Bitmap(width, height, pixelFormat);
    var rect = new Rectangle(0, 0, width, height);
    var bmpData = output.LockBits(rect, ImageLockMode.ReadWrite, output.PixelFormat);

    // Row-by-row copy
    var arrRowLength = width * Image.GetPixelFormatSize(output.PixelFormat) / 8;
    var ptr = bmpData.Scan0;
    for (var i = 0; i < height; i++)
    {
        Marshal.Copy(arr, i * arrRowLength, ptr, arrRowLength);
        ptr += bmpData.Stride;
    }

    output.UnlockBits(bmpData);
    return output;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-05-20T20:20:33.250

**从数据库 byteArray 加载后，字节数多于一张图像。**就我而言，它是82。

```
MemoryStream ms = new MemoryStream();
ms.Write(byteArray, 82, byteArray.Length - 82);
Image image = Image.FromStream(ms); 
```

为了保存在数据库中，我插入 82 个字节开始流。`Properties.Resources.ImgForDB`- 它是包含那些 82 字节的二进制文件。（我得到它的下一条路径 - 将图像从 DB 加载到 MemoryStream 并保存到二进制文件的前 82 个字节。你可以在这里拿它 - [https://yadi.sk/d/bFVQk_tdEXUd-A](https://yadi.sk/d/bFVQk_tdEXUd-A)）

```
 MemoryStream temp = new MemoryStream();
        MemoryStream ms = new MemoryStream();
        OleDbCommand cmd;
        if (path != "")
        {
            Image.FromFile(path).Save(temp, System.Drawing.Imaging.ImageFormat.Bmp);
            ms.Write(Properties.Resources.ImgForDB, 0, Properties.Resources.ImgForDB.Length);
            ms.Write(temp.ToArray(), 0, temp.ToArray().Length);

        cmd = new OleDbCommand("insert into Someone (first, Second, Third) values (@a,@b,@c)", connP);
        cmd.Parameters.AddWithValue("@a", fio);
        cmd.Parameters.AddWithValue("@b", post);
        cmd.Parameters.AddWithValue("@c", ms.ToArray());
        cmd.ExecuteNonQuery(); 
```

# c# - Nullable 和 Nullable 有什么区别 .HasValue 或 Nullable ！= 空？

> ID：676078
> 
> 赞同：483
> 
> 时间：2009-03-24T03:30:01.610
> 
> 标签：c#, .net, null, nullable

我总是使用`Nullable<>.HasValue`，因为我喜欢语义。然而，最近我正在研究其他人的现有代码库，他们`Nullable<> != null`只使用了这些代码库。

是否有理由使用其中一个，还是纯粹是偏好？

1.  ```
    int? a;
    if (a.HasValue)
        // ... 
    ```

对比

2.  ```
    int? b;
    if (b != null)
        // ... 
    ```

* * *

## 回答 #1

> 赞同：526
> 
> 时间：2009-03-24T03:34:09.070

编译器将`null`比较替换为对 的调用`HasValue`，因此没有真正的区别。只做对您和您的同事更具可读性/更有意义的那个。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-08-14T04:42:42.743

我更喜欢`(a != null)`语法匹配引用类型。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2014-04-11T18:23:04.810

我通过使用不同的方法将值分配给可为空的 int 对此进行了一些研究。这是我做各种事情时发生的事情。应该澄清发生了什么。请记住：`Nullable<something>`或者速记`something?`是一个结构，编译器似乎为此做了很多工作，让我们可以将它与 null 一起使用，就好像它是一个类一样。
正如您将在下面看到的，`SomeNullable == null`并且`SomeNullable.HasValue`总是会返回预期的真或假。虽然下面没有演示，但`SomeNullable == 3`也是有效的（假设 SomeNullable 是一个`int?`）。
如果`SomeNullable.Value`我们分配`null`给`SomeNullable`. 事实上，由于重载运算符、重载`object.Equals(obj)`方法，以及编译器优化和猴子业务。

这是我运行的一些代码的描述，以及它在标签中产生的输出：

```
int? val = null;
lbl_Val.Text = val.ToString(); //Produced an empty string.
lbl_ValVal.Text = val.Value.ToString(); //Produced a runtime error. ("Nullable object must have a value.")
lbl_ValEqNull.Text = (val == null).ToString(); //Produced "True" (without the quotes)
lbl_ValNEqNull.Text = (val != null).ToString(); //Produced "False"
lbl_ValHasVal.Text = val.HasValue.ToString(); //Produced "False"
lbl_NValHasVal.Text = (!(val.HasValue)).ToString(); //Produced "True"
lbl_ValValEqNull.Text = (val.Value == null).ToString(); //Produced a runtime error. ("Nullable object must have a value.")
lbl_ValValNEqNull.Text = (val.Value != null).ToString(); //Produced a runtime error. ("Nullable object must have a value.") 
```

好的，让我们尝试下一个初始化方法：

```
int? val = new int?();
lbl_Val.Text = val.ToString(); //Produced an empty string.
lbl_ValVal.Text = val.Value.ToString(); //Produced a runtime error. ("Nullable object must have a value.")
lbl_ValEqNull.Text = (val == null).ToString(); //Produced "True" (without the quotes)
lbl_ValNEqNull.Text = (val != null).ToString(); //Produced "False"
lbl_ValHasVal.Text = val.HasValue.ToString(); //Produced "False"
lbl_NValHasVal.Text = (!(val.HasValue)).ToString(); //Produced "True"
lbl_ValValEqNull.Text = (val.Value == null).ToString(); //Produced a runtime error. ("Nullable object must have a value.")
lbl_ValValNEqNull.Text = (val.Value != null).ToString(); //Produced a runtime error. ("Nullable object must have a value.") 
```

一切都和以前一样。请记住，使用 初始化并将`int? val = new int?(null);`null 传递给构造函数会产生编译时错误，因为可为空对象的 VALUE 不可为空。只有包装对象本身可以等于 null。

同样，我们会从以下位置得到一个编译时错误：

```
int? val = new int?();
val.Value = null; 
```

更不用说这`val.Value`是一个只读属性，这意味着我们甚至不能使用类似的东西：

```
val.Value = 3; 
```

但同样，多态重载隐式转换运算符让我们这样做：

```
val = 3; 
```

无需担心 polysomthing whatchamacallits 不过，只要它工作正常？:)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-04-23T18:13:55.857

在 VB.Net 中。当你可以使用“.HasValue”时，不要使用“IsNot Nothing”。我刚刚通过将“IsNot Nothing”替换为“.HasValue”解决了“操作可能破坏运行时的稳定性”中等信任错误。我真的不明白为什么，但是编译器中发生的事情有所不同。我会假设 C# 中的“！= null”可能有同样的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-28T14:38:27.220

如果您使用 linq 并希望保持代码简短，我建议您始终使用`!=null`

这就是为什么：

假设我们有`Foo`一个可以为**空的双**变量的类`SomeDouble`

```
public class Foo
{
    public double? SomeDouble;
    //some other properties
} 
```

如果在我们的代码中的某个地方，我们想从 Foo 集合中获取所有具有非 null SomeDouble 值的 Foo（假设集合中的某些 foos 也可以为 null），我们最终至少有三种方法来编写我们的函数（如果我们使用 C# 6) ：

```
public IEnumerable<Foo> GetNonNullFoosWithSomeDoubleValues(IEnumerable<Foo> foos)
{
     return foos.Where(foo => foo?.SomeDouble != null);
     return foos.Where(foo=>foo?.SomeDouble.HasValue); // compile time error
     return foos.Where(foo=>foo?.SomeDouble.HasValue == true); 
     return foos.Where(foo=>foo != null && foo.SomeDouble.HasValue); //if we don't use C#6
} 
```

在这种情况下，我建议总是选择较短的

* * *

## 回答 #6

> 赞同：-8
> 
> 时间：2017-05-16T09:52:18.273

第二种方法会有效很多倍（主要是因为编译器内联和装箱，但数字仍然很有表现力）：

```
public static bool CheckObjectImpl(object o)
{
    return o != null;
}

public static bool CheckNullableImpl<T>(T? o) where T: struct
{
    return o.HasValue;
} 
```

基准测试：

```
BenchmarkDotNet=v0.10.5, OS=Windows 10.0.14393
Processor=Intel Core i5-2500K CPU 3.30GHz (Sandy Bridge), ProcessorCount=4
Frequency=3233539 Hz, Resolution=309.2587 ns, Timer=TSC
  [Host] : Clr 4.0.30319.42000, 64bit RyuJIT-v4.6.1648.0
  Clr    : Clr 4.0.30319.42000, 64bit RyuJIT-v4.6.1648.0
  Core   : .NET Core 4.6.25009.03, 64bit RyuJIT

        Method |  Job | Runtime |       Mean |     Error |    StdDev |        Min |        Max |     Median | Rank |  Gen 0 | Allocated |
-------------- |----- |-------- |-----------:|----------:|----------:|-----------:|-----------:|-----------:|-----:|-------:|----------:|
   CheckObject |  Clr |     Clr | 80.6416 ns | 1.1983 ns | 1.0622 ns | 79.5528 ns | 83.0417 ns | 80.1797 ns |    3 | 0.0060 |      24 B |
 CheckNullable |  Clr |     Clr |  0.0029 ns | 0.0088 ns | 0.0082 ns |  0.0000 ns |  0.0315 ns |  0.0000 ns |    1 |      - |       0 B |
   CheckObject | Core |    Core | 77.2614 ns | 0.5703 ns | 0.4763 ns | 76.4205 ns | 77.9400 ns | 77.3586 ns |    2 | 0.0060 |      24 B |
 CheckNullable | Core |    Core |  0.0007 ns | 0.0021 ns | 0.0016 ns |  0.0000 ns |  0.0054 ns |  0.0000 ns |    1 |      - |       0 B | 
```

基准代码：

```
public class BenchmarkNullableCheck
{
    static int? x = (new Random()).Next();

    public static bool CheckObjectImpl(object o)
    {
        return o != null;
    }

    public static bool CheckNullableImpl<T>(T? o) where T: struct
    {
        return o.HasValue;
    }

    [Benchmark]
    public bool CheckObject()
    {
        return CheckObjectImpl(x);
    }

    [Benchmark]
    public bool CheckNullable()
    {
        return CheckNullableImpl(x);
    }
} 
```

使用了[https://github.com/dotnet/BenchmarkDotNet](https://github.com/dotnet/BenchmarkDotNet)

因此，如果您有一个选项（例如编写自定义序列化程序）在不同的管道中处理 Nullable，而不是 `object`- 并使用它们的特定属性 - 这样做并使用 Nullable 特定属性。所以从一致的思路来看`HasValue`应该是首选。一致的思维可以帮助您编写更好的代码，而无需花费太多时间在细节上。

**附言**。人们说建议“因为一致的想法而更喜欢 HasValue”是不相关且无用的。**你能预测它的表现吗？**

```
public static bool CheckNullableGenericImpl<T>(T? t) where T: struct
{
    return t != null; // or t.HasValue?
} 
```

**PPS**人们继续减，似乎没有人试图预测`CheckNullableGenericImpl`. 我会告诉你：那里的编译器不会帮你`!=null`替换`HasValue`. `HasValue`如果您对性能感兴趣，应该直接使用。

# c# - 我们如何在 C# 中执行多线程应用程序？

> ID：676080
> 
> 赞同：1
> 
> 时间：2009-03-24T03:30:23.450
> 
> 标签：c#, multithreading

**重复**

*   [时间：2019-05-10 标签：c#threading](https://stackoverflow.com/questions/177488/c-threading)
*   [C#中的初学者线程](https://stackoverflow.com/questions/533042/beginners-threading-in-c)
*   [多线程参考？](https://stackoverflow.com/questions/601558/multithreading-reference)

* * *

任何机构都可以提供一些很好的例子，c#中的多线程代码。我在谷歌上试过，但我需要一些例子来很好地解释什么时候发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T03:32:11.493

Joseph Albahari 提供了一个很好的资源。

[C#中的线程](http://www.albahari.com/threading/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T03:32:20.527

这个问题已经[在这里](https://stackoverflow.com/questions/177488/c-threading)，[这里](https://stackoverflow.com/questions/601558/multithreading-reference)和[这里](https://stackoverflow.com/questions/533042/beginners-threading-in-c)的地方得到了回答，我相信仅在这个网站上还有更多。这些来自使用右上角的搜索功能的结果的第一页。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T03:33:04.440

[Joe Albahari 的免费在线资源Threading in C#](http://www.albahari.com/threading/)不会出错

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T03:33:15.830

你到底想到了什么样的应用程序？多线程内置于 .NET 中，并以多种形式存在。在最简单的情况下，请在[http://msdn.microsoft.com](http://msdn.microsoft.com)上查找 System.Threading.Thread 类。还有内置的异步 I/O。

# java - Java 资源作为文件

> ID：676097
> 
> 赞同：131
> 
> 时间：2009-03-24T03:43:18.300
> 
> 标签：java, resources, classloader

Java中有没有办法在`File`通过类加载器从jar中检索到的资源上构造一个实例？

我的应用程序使用 jar 中的一些文件（默认）或运行时指定的文件系统目录（用户输入）。我正在寻找一种一致的方式来
a）将这些文件作为流加载
b）分别列出用户定义的目录或jar中的目录中的文件

编辑：显然，理想的方法是完全远离`java.io.File`。有没有办法从类路径加载目录并列出其内容（其中包含的文件/实体）？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-07-06T22:02:46.187

我遇到了同样的问题，并且能够使用以下内容：

```
// Load the directory as a resource
URL dir_url = ClassLoader.getSystemResource(dir_path);
// Turn the resource into a File object
File dir = new File(dir_url.toURI());
// List the directory
String files = dir.list() 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-03-24T07:18:57.830

`ClassLoader.getResourceAsStream`并且`Class.getResourceAsStream`绝对是加载资源数据的方法。但是，我不相信有任何方法可以“列出”类路径元素的内容。

在某些情况下，这可能根本不可能——例如，a`ClassLoader` *可以*根据请求的资源名称动态生成数据。如果您查看`ClassLoader`API（基本上是类路径机制的工作原理），您会发现没有任何事情可以做您想做的事情。

如果你知道你实际上有一个 jar 文件，你可以加载它`ZipInputStream`以找出可用的内容。这将意味着您将拥有不同的目录和 jar 文件代码。

如果首先单独创建文件，另一种选择是包含一种清单文件，其中包含可用资源的列表。将其捆绑在 jar 文件中或将其作为文件包含在文件系统中，并在为用户提供资源选择之前加载它。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2011-04-13T02:33:55.407

这是我的一个应用程序中的一些代码......让我知道它是否适合您的需求。如果您知道要使用的文件，则可以使用它。

```
URL defaultImage = ClassA.class.getResource("/packageA/subPackage/image-name.png");
File imageFile = new File(defaultImage.toURI()); 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2016-02-17T19:15:20.980

在从 jar 检索到的资源上构造 File 实例的可靠方法是将资源作为流复制到临时文件中（当 JVM 退出时临时文件将被删除）：

```
public static File getResourceAsFile(String resourcePath) {
    try {
        InputStream in = ClassLoader.getSystemClassLoader().getResourceAsStream(resourcePath);
        if (in == null) {
            return null;
        }

        File tempFile = File.createTempFile(String.valueOf(in.hashCode()), ".tmp");
        tempFile.deleteOnExit();

        try (FileOutputStream out = new FileOutputStream(tempFile)) {
            //copy stream
            byte[] buffer = new byte[1024];
            int bytesRead;
            while ((bytesRead = in.read(buffer)) != -1) {
                out.write(buffer, 0, bytesRead);
            }
        }
        return tempFile;
    } catch (IOException e) {
        e.printStackTrace();
        return null;
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-24T03:47:36.620

试试这个：

```
ClassLoader.getResourceAsStream ("some/pkg/resource.properties"); 
```

还有更多可用的方法，例如，请参见此处： [http ://www.javaworld.com/javaworld/javaqa/2003-08/01-qa-0808-property.html](http://www.javaworld.com/javaworld/javaqa/2003-08/01-qa-0808-property.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-05-03T16:06:10.037

这是一种选择：[http ://www.uofr.net/~greg/java/get-resource-listing.html](http://www.uofr.net/~greg/java/get-resource-listing.html)

# javascript - javascript 聊天客户端的服务器轮询间隔

> ID：676098
> 
> 赞同：12
> 
> 时间：2009-03-24T03:44:11.543
> 
> 标签：javascript, ajax

我正在为我的网站构建一个基本的小 AJAX 喊话框/聊天，但我不确定如何实现服务器轮询。

这是我正在考虑的基本程序流程：

1.  用户来到页面并显示最后 10 条消息
2.  要获取其他人发送的消息，客户端 javascript 将请求带有时间戳参数的 URL（设置为客户端收到的最后一条消息的值）
3.  服务器返回自该时间戳以来的所有消息（最多 10 条）。

唯一的问题是轮询服务器的频率。显然，每次添加新消息时它都应该轮询，但是当您只是阅读其他人的消息时，它需要自动更新。

是否应该设定时间限制？例如：每 10 秒。或者，它应该根据使用情况而有所不同吗？例如：5 秒后检查。如果没有消息，请不要再检查 10 秒。如果仍然没有新消息，请检查 15 秒，然后检查 20 秒，最多每 30 秒检查一次。每次检测到新消息时，将您的计时器重置为 5 秒并重新开始。

考虑到我们可能有数百名用户同时在线，我只是担心会给服务器带来不必要的压力。

...还是我把整个事情搞错了？有没有更好的方法来实现基本的 JavaScript 聊天？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T03:52:10.120

您可能希望研究所谓的[Comet](http://en.wikipedia.org/wiki/Comet_(programming))编程技术，将信息流式传输给您的用户，而不是让客户端轮询服务器。这实际上是一系列技术，根据具体情况，其中一些可能比其他技术更好，例如您正在使用哪种服务器以及您需要哪种客户端兼容性。

如果您的服务器可以一次处理大量打开的连接（例如，它不使用每个连接的整个线程或进程，例如[nginx](http://wiki.nginx.org/Main)或基于[erlang](http://www.erlang.org/)的服务器），您可能希望使用长轮询技术，一旦收到一条消息，客户端立即请求另一条消息。如果没有可用的消息，服务器只是保持连接打开，可能偶尔发送虚拟数据作为保活，直到有消息可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T05:18:03.580

Brian 描述的 Comet 是一种很好的技术，但需要服务器上的会话支持，这可能比您为简单的聊天框实现的要高级。

实现轮询间隔的最佳方法是想象您有一个聊天窗口，您可以将其最小化以执行其他操作，或者打开以查看是否有新消息。当你在谈话中时，你会经常切换到它（轮询）。如果你有一段时间没有收到任何消息，你会开始变得越来越稀有，直到你只是偶尔检查一下。

假设您不需要进行实时打字，您可以在活动高峰时每 3 秒左右轮询一次，如果 5-10 次轮询没有显示任何内容，则开始增加间隔（也许每次都加倍） ) 直到达到 30-60 秒。取回消息应该将轮询间隔重置为几秒钟，而发送消息应该立即轮询，但可能不需要影响轮询频率。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T05:43:46.560

老实说，如果你正在实现一个“<em>基本的小 AJAX 喊话框/聊天”，那么[Jabber](http://en.wikipedia.org/wiki/Jabber)、[Comet](http://en.wikipedia.org/wiki/Comet_(programming))等对你来说太过分了。这些事情将需要您运行额外的服务器/代理来承担应用服务器和数据库的负载。
当您考虑诸如[状态管理](http://en.wikipedia.org/wiki/SIMPLE)（“Joe 正在打字……”）之类的东西时，您的应用程序就会变得过于复杂（考虑到“聊天”并不是您的主要关注点）。
考虑添加来自[Meebo](http://en.wikipedia.org/wiki/Meebo)和[Userplane](http://en.wikipedia.org/wiki/Userplane)等提供商的小部件。一旦你扩大规模，想想 Jabber 之类的......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T03:49:28.567

您应该每隔 5 秒左右检查一下其他用户是否正在输入，如果其他用户正在输入，那么您可以每隔 1 秒检查一次用户是否发送了新消息。但实际上，您应该能够每 1 秒检查一次以查看其他用户是否正在输入，如果他们正在输入，则每 0.25-0.5 秒检查一次是否已发送新消息。随着宽带在互联网上被广泛接受，应该不是问题。使用更长的轮询超时进行拨号访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T03:52:19.073

这是一个非常难的问题，请记住滥用。恶意用户会尽可能频繁地攻击您，并伪造最早的时间戳，从而对您的数据库服务器造成压力。一定要验证那个时间戳，或者忽略它，因为不应该每个人都在同一时间吗？

您可以将轮询间隔作为其他用户响应时间的函数发送给用户。这是我认为最好的动态。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-18T01:56:08.910

[http://jabbify.com/home/comet_service](http://jabbify.com/home/comet_service) 这是一个免费的基于彗星的聊天服务，由做 jmvc 框架的人提供。还没有尝试过，但看起来很有希望。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-14T08:52:13.543

这样做的专业方法是使用 WebSocket javascript 连接。例如，您可以使用[https://socketsbay.com/ 之](https://socketsbay.com/)类的免费服务，并使用

```
 // Create WebSocket connection.
    const socket = new WebSocket('wss://socketsbay.com/wss/v2/[ChannelId]/[ApiKey]/');

    // Connection opened
    socket.addEventListener('open', function (event) {
        socket.send('Hello Server!');
    });

    // Listen for messages
    socket.addEventListener('message', function (event) {
        console.log('Message from server ', event.data);
    });
```

您可以忘记服务器池时间，因为它将是实时的。

# performance - 为什么 HTTP/SOAP 被认为是“厚”的

> ID：676123
> 
> 赞同：31
> 
> 时间：2009-03-24T04:05:35.220
> 
> 标签：performance, http, soap

我听说过一些意见认为 SOAP/HTTP Web 服务调用堆栈是“厚”或“重量级”，但我无法确定原因。由于 SOAP 信封和消息的序列化/反序列化，它会被认为是厚的吗？这真的是重量级手术吗？

或者与固定连接上的原始/二进制数据传输相比，它只是被认为是“厚”的吗？

或者是其他什么原因？任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-24T04:21:46.243

SOAP 被设计为足够抽象以使用除 HTTP 之外的其他传输。这意味着，除其他外，它*没有*利用 HTTP 的某些方面（主要是 RESTful 使用 URL 和方法，例如`PUT /customers/1234`or `GET /customers/1234`）。

SOAP 也出于同样的原因绕过现有的 TCP/IP 机制——独立于传输。同样，这意味着它不能利用传输，例如序列管理、流控制、服务发现（例如`accept()`，在众所周知的端口上建立连接意味着服务存在）等。

SOAP 使用 XML 进行所有的序列化 - 虽然这意味着只需一个 XML 解析器就可以“普遍读取”数据，但它引入了如此多的样板文件，以至于您确实需要一个 SOAP 解析器才能有效地运行。到那时，您（作为软件消费者）无论如何都失去了 XML 的好处；`libSOAP`如果您无论如何都需要处理它，谁在乎有效载荷在电线上的样子。

SOAP 需要 WSDL 来描述接口。WSDL 本身不是问题，但它往往被宣传为比实际情况更“动态”。在许多情况下，会创建一个单一的 WSDL，并从中自动生成生产者/消费者代码，并且它永远不会改变。总体而言，这需要大量工具，而实际上并不能更好地解决原始问题（如何在不同服务器之间进行通信）。而且由于大多数 SOAP 服务都是通过 HTTP 运行的，所以最初的问题*已经*基本解决了。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-24T04:29:35.973

SOAP 和 WSDL 是极其复杂的标准，它们有许多支持不同标准子集的实现。[SOAP 不像XML-RPC](http://www.xmlrpc.com/)那样很好地映射到简单的外部函数接口。相反，您必须了解 XML 名称空间、信封、标头、WSDL、XML 模式等，才能生成正确的 SOAP 消息。调用 XML-RPC 服务所需要做的就是定义端点并在其上调用方法。例如，在 Ruby 中：

```
require 'xmlrpc/client'

server = XMLRPC::Client.new2("http://example.com/api")
result = server.call("add", 1, 2) 
```

除了 XML-RPC，还有其他更简单和轻量级的技术，例如基于 HTTP 的普通 XML 或[JSON](http://www.json.org/)（通常称为[REST](http://en.wikipedia.org/wiki/Representational_State_Transfer)，尽管这暗示了某些其他设计考虑）。XML 或 JSON 之类的东西优于 HTTP 的优势在于，它很容易从 JavaScript 使用，甚至只是一个带有表单提交的愚蠢网页。[也可以使用curl](http://curl.haxx.se/)等工具从命令行轻松编写脚本。它几乎适用于任何语言，因为 HTTP 库、XML 库和 JSON 库几乎随处可用，即使 JSON 解析器不可用，也很容易编写自己的。

*编辑：*我应该澄清一下，我指的是*概念上*重量级的 SOAP，而不是重量级，它是在原始数据量方面。我认为原始数据量不太重要（尽管如果您需要处理大量小请求，它会很快加起来），而在概念上它的重量级是非常重要的，因为这意味着有更多的地方可以处理某些事情可能会出错，可能存在不兼容等。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-24T04:30:03.960

我同意第一张海报，但想补充一下。粗细的定义是相对的。随着 JSON 或 REST 等传输的出现，SOAP 表面上看起来很重，因为“hello world”示例。现在您可能已经知道是什么让 SOAP 很重，而 WS 2.0 通常是企业/健壮特性。JSON 不像 WS 2.0 那样安全。我没有听说过 SOAP 被称为厚实，但许多非 XML 狂热者将这些规范视为厚重或厚实。需要明确的是，我既不赞成也不反对，因为两者都有自己的位置。XML 更冗长且易于阅读，因此“更厚”。最后一点是，鉴于 AJAX 等较新的 Web 趋势，有些人认为 HTTP 是一种持久连接协议，而不是在大页面上提供服务。

总而言之，除了有人想称 SOAP/HTTP 厚，**没有其他真正的原因**，这都是相对的。更少的标准是完美的并且适用于所有场景。如果我不得不猜测一些聪明的 Web 开发人员认为他通过谈论如何思考 XML 技术和超级 JSON 是多么聪明，那么他是多么聪明。每个人都有一个地方。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-24T04:20:52.610

SOAP 的信噪比太低。对于简单的对话，没有数据价值的结构开销太多；并且需要太多显式配置（与隐式配置相比，如 JSON）。

它一开始并不是这样，但它最终成为了标准委员会参与时，一个好主意会发生什么的典型代表。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-24T04:14:24.387

首先，这在很大程度上取决于您的服务是如何实现的（即，您可以通过注意方法签名的完成方式来做很多事情来减少有效负载）。

也就是说，不仅是肥皂信封，而且消息本身在 xml 中比简化的二进制格式要大得多。只需选择正确的类和成员名称就可以减少很多...

考虑以下从返回东西集合的方法返回的序列化方法示例。如果您要返回重复数据（例如列表/集合/数组），只需为类/包装器和成员选择正确的 [序列化] 名称就可以对序列化的 soap 请求/响应的详细程度产生很大影响。

**简短/短名称：**

```
<?xml version="1.0" encoding="utf-8"?>
<ArrayOfShortIDName xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://tempuri.org/">
  <ShortIDName>
    <id>0</id>
    <name>foo 0</name>
  </ShortIDName>
  <ShortIDName>
    <id>1</id>
    <name>foo 1</name>
  </ShortIDName>
  <ShortIDName>
    <id>2</id>
    <name>foo 2</name>
  </ShortIDName>
  ...
</ArrayOfShortIDName> 
```

**长名称：**

```
<?xml version="1.0" encoding="utf-8"?>
<ArrayOfThisClassHasALongClassNameIDName xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://tempuri.org/">
  <ThisClassHasALongClassNameIDName>
    <MyLongMemberNameObjectID>0</MyLongMemberNameObjectID>
    <MyLongMemberNameObjectName>foo 0</MyLongMemberNameObjectName>
  </ThisClassHasALongClassNameIDName>
  <ThisClassHasALongClassNameIDName>
    <MyLongMemberNameObjectID>1</MyLongMemberNameObjectID>
    <MyLongMemberNameObjectName>foo 1</MyLongMemberNameObjectName>
  </ThisClassHasALongClassNameIDName>
  <ThisClassHasALongClassNameIDName>
    <MyLongMemberNameObjectID>2</MyLongMemberNameObjectID>
    <MyLongMemberNameObjectName>foo 2</MyLongMemberNameObjectName>
  </ThisClassHasALongClassNameIDName>
  ...
</ArrayOfThisClassHasALongClassNameIDName> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-24T04:23:18.237

1 - XML 模式是 WSDL 规范的关键部分，非常非常庞大和复杂。实际上，将 XML 模式映射到编程语言结构之类的工具最终只支持部分 XML 模式特性。

2 - WS-* 规范，例如，WS-Security 和 WS-SecureConversation，又是大而复杂的。它们几乎被设计成没有人比微软或 IBM 能够完全实现它们的资源更少。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-24T04:18:17.063

我认为它“厚”是因为打包和解包消息（序列化和反序列化）涉及的开销相对较大。

考虑一个 Web 服务，该 Web 服务调用`Add`了一个需要两个 32 位整数的 Web 方法。调用者打包两个整数并收到一个整数作为回复。如果实际上只有 96 位信息正在传输，那么添加 SOAP 数据包可能会在每个方向上增加大约 3,000 或更多的额外位。增加了 30 倍。

除此之外，与将消息序列化和反序列化为 UTF-8（或其他）XML 相关的性能相对较慢。诚然，这些天它相当快，但它肯定不是微不足道的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-24T04:17:35.893

我认为主要是 SOAP 信封为构造消息增加了大量开销，特别是对于只有几个非深度结构化参数的简单请求的常见情况。将其与参数仅包含在 URL 查询中的 REST 样式 Web 服务进行比较。

然后再加上 WSDL 的复杂性和典型的“企业”库实现......

# java - 如何将数组文件发送到其他类

> ID：676125
> 
> 赞同：0
> 
> 时间：2009-03-24T04:06:57.743
> 
> 标签：java, arrays

如何将存储在数组中的文件发送到其他类？我已经尝试过这段代码，但没有工作。

```
public class abc {
    ....
    String [] indexFiles = new String[100];

    public abc (){
       indexFiles [0]=image1.txt;
       indexFiles [1]=image1.txt;
       .... 
       draw = new drawing (indexFiles(0)); // I got error in this code
       draw = new drawing (indexFiles.get(0)); // I also tried this code but it give me error as well.       
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T04:11:21.260

您的绘图类是采用字符串数组还是仅采用单个字符串？

如果它需要一个数组，请使用：

```
draw = new drawing(indexFiles); 
```

如果它需要一个字符串，请使用：

```
draw = new drawing(indexFiles[0]); 
```

要访问数组中的单个值，请使用 [] 方括号，而不是圆括号。

附带说明：“get(0)”方法用于像 ArrayList 这样的集合：

```
List<String> stringList = new ArrayList<String>();
stringList.add("MyString");
System.out.println(stringList.get(0)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T04:08:41.127

采用

```
indexFiles[0] 
```

# build-process - 您可以配置 TeamCity“工件”以重新检入源代码管理吗？

> ID：676132
> 
> 赞同：3
> 
> 时间：2009-03-24T04:10:02.387
> 
> 标签：build-process, build-automation, teamcity

我想让 TeamCity Artifacts 重新检查到源代码管理中。

我以前使用过 TFS Integrator。所以我习惯了它的方法，通过配置，它可以将输出构建签入源代码控制。然后，当人们获得时，他们将收到这些工件。

或者是否有完全不同的方法可以通过 TeamCity 实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T10:37:39.777

我能想到的两种方法是

*   VCS 标签

在工作目录中指定要标记的路径以及相对于主干的位置以将其签入[。jetbrains 在此处进行解释](http://www.jetbrains.net/confluence/display/TCD4/VCS+Labeling)

```
/project/trunk/dist=>/project/tags/%system.build.number% 
```

*   从构建脚本

从构建脚本中手动签入工件，并将忽略添加到您签入的位置，这样它就不会再次触发构建。

```
e.g. use -:user=devA:project/sources/** to prevent build triggering after a change of VCS user devA  made in subfolder project/sources/** 
```

# function - 使用 Arduino 淡入多个 LED

> ID：676133
> 
> 赞同：5
> 
> 时间：2009-03-24T04:10:47.703
> 
> 标签：function, delay, arduino

我需要弄清楚如何在使用 Arduino 的函数中淡入和淡出多个 LED。不能使用 delay() ，因为其他东西需要在光线变暗时运行。到目前为止，这是它所拥有的，但不起作用。

```
int value = 0;                            // variable to keep the actual value 
int ledpin = 9;                           // light connected to digital pin 9
int p1 = 0;

void setup() 
{ 
  // nothing for setup 
  Serial.begin(9600);
} 

void loop() 
{ 
  inout(50, 30, 9, 0, 0);
  //inout(20, 20, 10);
} 

void inout(int inDelay, int outDelay, int ledpin, long previousmil, int done)
{

  if(millis() - previousmil>inDelay){
    if (value <=255){
      analogWrite(ledpin, value);          // sets the value (range from 0 to 255)         
      value+=5;
    }
    previousmil=millis();
  }

  if(value = 260)
    done = 1;

  if(millis() - previousmil>outDelay && done == 1){

    if (value >0){
      analogWrite(ledpin, value);          // sets the value (range from 0 to 255)                       

      value-=5;
    }
    previousmil=millis();
  }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T11:11:05.487

唯一明显的事情是你有一个状态标志，用于增加价值的方式，但你没有在你的第一个 if 中测试它。更好地构造你的代码。如果您有多个引脚，您可能还需要跟踪多个值，除非它们都应该同时淡入和淡出。在这种情况下，最好使用`struct`带有每个松树参数的 s 数组。

对多个任务使用延迟的一种方法是让每个任务在自上次循环以来经过的时间上工作，并在循环结束时根据任务所花费的时间调整延迟。如果您的循环类似于：

```
static unsigned long last_time = 0; // set to millis() in setup
static unsigned long refresh_period = 20; // 50Hz

void loop() 
{
    unsigned long time = millis();
    unsigned long delta = time - last_time;

    doTask1( delta );
    doTask2( delta );
    doTask3( delta );
    doTask4( delta );

    // as tasks may have taken some millis, adjust delay 
    unsigned long post_time = millis();

    if ( post_time - last_time < refresh_period )
        delay( refresh_period - ( post_time - last_time ) );

    last_time = time;
} 
```

然后每个任务大约每 20 毫秒运行一次，并且将通过大约 20 毫秒来更新它们的状态。所以你得到了一些延迟，但一切都有机会更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-13T00:44:04.273

推测，但这似乎是错误的：

```
if(value=260) 
```

（[让我想起了世界上最后一个 C 错误](http://peterlangston.com/Fun_People/1997/1997ABJ.html)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T22:06:55.780

如果您想用硬件解决问题，您可以将 LED 连接到外部控制器芯片，例如 TI TLC5940。这些使您可以对每个 LED 的亮度级别进行编程，并与 Arduino 中的 ATMega CPU 分开处理 LED 的 PWM 输出。当您想要改变亮度级别时，您只需要重新编程 TLC 芯片。有一个不错的[TLC 库可用于处理与](http://code.google.com/p/tlc5940arduino/)Google Code 上的芯片的通信。

# text-to-speech - 如何检测 SAPI TTS 引擎何时忙碌

> ID：676143
> 
> 赞同：2
> 
> 时间：2009-03-24T04:17:06.863
> 
> 标签：text-to-speech, sapi

SAPI 引擎一次只能从一个应用程序呈现 TTS（我已使用 Windows SDK TTSApplication 示例的两个实例运行测试以验证这一点）。我正在编写一个应用程序，我需要在其中检测 TTS 引擎当前是否在说话（即在一个单独的应用程序的控制下，而不是我的）。

有谁知道请我如何以编程方式（在 C++ 中）检测 SAPI TTS 引擎繁忙/就绪状态？我曾尝试使用 ISpVoice::GetStatus() 但这似乎只适用于我自己的应用程序中的任何 TTS 活动。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-18T22:45:00.660

这是了解语音合成系统是否在说话的解决方案。

`ISpVoice *pVoice;`

`hr = pVoice->GetStatus(& status, NULL);`

`if(status.dwRunningState == SPRS_IS_SPEAKING)`

`std::cout<< "The Speech Synthesis System is speaking."`

`else`

`std::cout<< "The Speech Synthesis System is not speaking."`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-23T15:41:39.343

例如在 SAPI4 中，IVTxtAttributes::IsSpeaking 检索此类状态（如果引擎当前正在向某些音频设备播放样本）。

无论如何，IMO 通用 SAPI 引擎并不局限于一个应用程序。我相信这种行为是“你的引擎”特定的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:43:17.233

来自[http://msdn.microsoft.com/en-us/library/ee431864%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ee431864%28v=vs.85%29.aspx)

SPRUNSTATE 列出语音运行状态。

```
typedef enum SPRUNSTATE
{
    SPRS_DONE,
    SPRS_IS_SPEAKING
} SPRUNSTATE; 
```

**元素：**

**SPRS_DONE** 语音已完成处理所有排队的流。 **SPRS_IS_SPEAKING** 语音实例当前拥有音频声明。

# sharepoint - 如何访问 Sharepoint SPNavigationNode.QuickLaunch 属性？

> ID：676155
> 
> 赞同：3
> 
> 时间：2009-03-24T04:22:35.057
> 
> 标签：sharepoint

我有一个网站如下：

--站点A
----子站点1
----子站点2

现在，每当我尝试访问 QuickLaunch 属性时，它总是为空，例如

```
SPNavigation nav = spWeb.Navigation;
if (nav.QuickLaunch.Count == 0)
{
      // ALWAYS TRUE
} 
```

但是，如果我进入 SiteA 的导航设置（通过 UI）并重新排序列表中的任何站点，只有这样 QuickLanuch 才可用。（其他设置保持默认）

谁能解释这种行为？我真的需要访问 QuickLaunch 项目。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-01T08:45:20.173

如果您在创建网站时访问快速启动，则会出现此错误。下面的代码会导致功能激活代码等到网站集创建完成后再执行。

```
using System.Threading;

public override void FeatureActivated(SPFeatureReceiverProperties properties)
    {
        //Queues changes until after site exists.  For use in provisioning.
        SPWeb web = properties.Feature.Parent as SPWeb;
        ThreadPool.QueueUserWorkItem(ApplyYourChanges, web.Url);
    }

private void ApplyYourChanges(object state)
    {
        string webUrl = state as string;
        Uri uri = new Uri(webUrl);

        // additional conditions here -- perhaps check if a feature was activated
        while (!SPSite.Exists(uri))
        {
            Thread.Sleep(5000);
        }
        using (SPSite site = new SPSite(webUrl))
        {
            using (SPWeb web = site.OpenWeb())
            {
                //configure the quicklaunch menu
                configureQuickLaunch(web);
            }
        }
    }

public static void configureQuickLaunch(SPWeb spWeb)
    {            
        SPNavigationNodeCollection nodeCollection = spWeb.Navigation.QuickLaunch;
        SPNavigationNode heading = nodeCollection.Cast<SPNavigationNode>().FirstOrDefault(n => n.Title == headingNode);
        SPNavigationNode item = heading.Children.Cast<SPNavigationNode>().FirstOrDefault(n => n.Url == url);
            if(item == null)
            {
                item = new SPNavigationNode(nodeName, url);
                item = heading.Children.AddAsLast(item);
            }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:27:29.933

我认为，默认情况下，QuickLaunch 使用共享导航。换句话说，子站点的 QuickLaunch 没有自己的节点集合，除非您对其进行操作。如果您对站点进行重新排序，则会为其提供一组独特的节点。

如果您想以编程方式将 QuickLaunch 设置为以编程方式拥有自己的一组节点，您应该可以这样做：

```
SPNavigation nav = spWeb.Navigation;  
nav.UseShared = false;  
spWeb.Update(); 
```

我认为此时您的计数应该不是零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:26:57.240

我似乎记得在某处读到 QuickLaunch 集合仅将自定义存储到默认排序。环顾四周，我找不到向您展示的文档，但它可以解释您看到的行为是否属实。

因此，您`QuickLaunch.Count == 0`只是在确认物品的默认订购已到位。如果有帮助的话，您仍然可以添加节点；

```
SPNavigationNodeCollection nodes = web.Navigation.QuickLaunch;
SPNavigationNode node = new SPNavigationNode("Node Name", "Node URL", true);
nodes.AddAsFirst(node); 
```

# python - 使用 Ruby 或 Python 创建静态图形文件（png、gif、jpg）

> ID：676159
> 
> 赞同：10
> 
> 时间：2009-03-24T04:25:21.617
> 
> 标签：python, ruby, graphics, png

我想根据用户输入动态创建图形图像，然后将该图像呈现为 PNG 文件（或 jpg 或 gif，如有必要，但首选 PNG）。

这实际上是针对占星术应用的；我想做的是在PNG中生成图表以供显示。

Python 或 Ruby 都可以；事实上，可用的库可能决定了我使用的语言。

### 更新

这是一个示例图像：
![星座运势图表示例](https://upload.wikimedia.org/wikipedia/commons/thumb/4/42/Astrological_Chart_-_New_Millennium.JPG/400px-Astrological_Chart_-_New_Millennium.JPG)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T04:47:53.823

也许矢量格式更适合您的需求，但如果没有具体示例来说明您想要获得什么，就很难说清楚。

例如，如果图像都相似，您可以使用 Inkscape 创建一个 SVG 基础图像，然后从 Python 或 Ruby 以编程方式对其进行编辑（通过编辑文本或使用 XML 库），最后将其导出为 PNG。

* * *

**更新：** 看到示例图像后，我认为 SVG 将是最方便的选择。SVG 图像是一个 XML 文件，基本上说“从这里到这里画一个圆圈，在那里写字符串 '13º52'”等。您可以在 Inkscape 中绘制一个独特的基本图表，并让您的程序只需添加线条和符号每个案例。最后导出为 PNG。

优点是：更容易绘制，图像完全可缩放，只需编辑属性即可更改样式（“使所有线条变宽”，“将所有文本更改为 Arial”，“将背景涂成蓝色”），您可以导出为任何格式而不会损失质量，我认为它更易于维护。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-24T04:36:54.880

在 Python 中，您通常会使用 PIL，即 Python 图像库。除了最简单的任务之外，我从来没有将 PIL 用于任何事情，所以我不能说它在实践中的表现如何。

我将通过查看[其文档](http://www.pythonware.com/library/pil/)开始深入研究 PIL ，尤其是[绘图模块的文档](http://www.pythonware.com/library/pil/handbook/imagedraw.htm)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T05:02:35.457

当我在你的鞋子里时，我发现[Gruff](http://nubyonrails.com/pages/gruff)很容易使用。 [无耻的博客插件](http://madcoderspeak.blogspot.com/2008/12/graphs-in-ruby-on-rails.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T04:34:02.813

查看[Ruby-GD2](https://github.com/jojje/gd2-ruby)或 ImageMagick 或 GraphicsMagick 绑定。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T05:23:20.930

对于 Python I，图像格式最常见的选择是 PIL，然后是[Pycairo](http://cairographics.org/pycairo/)用于矢量格式。两者可以一起工作，例如在这个食谱条目中[使用 Pycairo 表面的 PIL 图像](http://cairographics.org/pythoncairopil/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T05:15:03.040

当我在做 python chalange ( [http://www.pythonchallenge.com/](http://www.pythonchallenge.com/) ) 时，我使用了 Python Image Library ( [http://www.pythonware.com/library/pil/](http://www.pythonware.com/library/pil/) )

# gridview - 使用 ASP.NET 2.0 GridView 的自定义分页问题

> ID：676169
> 
> 赞同：0
> 
> 时间：2009-03-24T04:37:03.880
> 
> 标签：gridview, custompaging

我有一个包含以下产品信息的数据库表：ProductID、KeywordID、ProductDescription

并且有一些关键字存储在关键字表中作为关键字ID，关键字描述

我必须在包含 gridview 和组合框的页面上显示产品的分页报告 - 在组合框中选择了关键字，并且 Gridview 显示了关键字的分页信息。显然我这里不能使用rowid的方式来实现分页，因为不同关键字相关的所有产品都在同一张表中。

有人可以提出一个好的解决方案。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-10T07:25:19.423

好吧，我在谷歌搜索后自己做了这个：我使用以下 SQL 部分创建了一个合成 RowID，它是一个连续数字：

“ROW_NUMBER() OVER (ORDER BY) AS ResultSetRowNumber”

老实说，我忘记了帮助我实现这一目标的帖子。找到链接后，我会尽快发布。

# java - 您在包装中是否遵循任何准则（java）？

> ID：676170
> 
> 赞同：2
> 
> 时间：2009-03-24T04:38:35.610
> 
> 标签：java, packages

您是否遵循 java 包装中的任何设计准则？

适当的包装是设计技巧的一部分吗？有没有关于它的文件？

编辑：包必须如何相互依赖？循环包是不可避免的吗？与 jar 或 war 文件无关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T17:41:41.943

我尝试遵循的方法通常如下所示：

1.  有合理大小的包裹。少于 3 节课很奇怪。小于 10 是好的。超过 30 是不可接受的。我通常对此不是很严格。
2.  包之间没有依赖循环。这很困难，因为许多开发人员很难找出任何方法来保持依赖循环自由。但是这样做会梳理出代码中的许多隐藏结构。考虑代码的结构变得更容易，也更容易改进它。
3.  定义层和模块以及它们在代码中的表示方式。通常我最终会得到类似`<domain>.<application>.<module>.<layer>.<arbitrary substructure as needed>`包名称的模板
4.  层与层之间没有循环；模块之间没有循环。

为了避免循环，必须进行检查。许多工具都可以做到这一点（JDepend、Sonar ...）。不幸的是，他们在寻找修复周期的方法方面没有多大帮助。这就是我开始研究[Degraph](https://github.com/schauder/degraph)的原因，它应该通过可视化类、包、模块和层之间的依赖关系来帮助解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T05:01:43.573

Packaging is normally about **release management**, and the general guidelines are:

*   **consistency**: when you are releasing into integration, pre-production or production environment several deliveries, you want them organized (or "packaged") exactly the same way

*   **small number of files**: when you have to copy a set of files from one environment to another, you want to copy as many as possible, if their number is reasonable (10-20 max per component to deliver), you can just copy them (even if those files are important in size)

So you want to define a common structure for each delivery like:

```
aDelivery/
    lib // all jar, ear, war, ...
    bin // all scripts used to launch your application: sh, bat, ant files, ...
    config // all properties files, config files
    src // all sources zipped into jars
    docs // javadoc zipped 
    ... 
```

Plus, all those common directory structures should be stored into one common repository (a VCS, or a maven repo, or...), in order to be queried, *without having to rebuilt them every time you need them* (you do not need that if you have only one or two delivery components, but when you have 40 to 60 of them... a full rebuilt is out of the question).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T08:18:35.317

你可以在这里找到很多信息：

[您在 Java 项目中使用什么策略来命名包，为什么？](https://stackoverflow.com/questions/533102/what-strategy-do-you-use-for-package-naming-in-java-projects-and-why)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T03:35:57.850

Java 中打包的问题在于它与您想做的事情几乎没有关系。例如，我喜欢遵循将包标记为内部的 Eclipse 约定，但是我不能用“包”保护级别定义它们的类。

# python - 使用 pySerial 包的完整示例

> ID：676172
> 
> 赞同：102
> 
> 时间：2009-03-24T04:38:58.167
> 
> 标签：python, modem, pyserial

有人可以给我看一个使用**pyserial**的完整 python 示例代码吗，我有这个包，我想知道如何发送 AT 命令并读回它们！

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2011-10-04T21:57:12.113

博客文章[Python 中的串行 RS232 连接](https://www.varesano.net/serial-rs232-connections-in-python/)

```
import time
import serial

# configure the serial connections (the parameters differs on the device you are connecting to)
ser = serial.Serial(
    port='/dev/ttyUSB1',
    baudrate=9600,
    parity=serial.PARITY_ODD,
    stopbits=serial.STOPBITS_TWO,
    bytesize=serial.SEVENBITS
)

ser.isOpen()

print 'Enter your commands below.\r\nInsert "exit" to leave the application.'

input=1
while 1 :
    # get keyboard input
    input = raw_input(">> ")
        # Python 3 users
        # input = input(">> ")
    if input == 'exit':
        ser.close()
        exit()
    else:
        # send the character to the device
        # (note that I happend a \r\n carriage return and line feed to the characters - this is requested by my device)
        ser.write(input + '\r\n')
        out = ''
        # let's wait one second before reading output (let's give device time to answer)
        time.sleep(1)
        while ser.inWaiting() > 0:
            out += ser.read(1)

        if out != '':
            print ">>" + out 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-03-24T05:26:04.480

```
import serial
ser = serial.Serial(0)  # open first serial port
print ser.portstr       # check which port was really used
ser.write("hello")      # write a string
ser.close()             # close port 
```

use [https://pythonhosted.org/pyserial/](https://pythonhosted.org/pyserial/) for more examples

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-03-23T17:29:18.513

[http://web.archive.org/web/20131107050923/http://www.roman10.net/serial-port-communication-in-python/comment-page-1/](http://web.archive.org/web/20131107050923/http://www.roman10.net/serial-port-communication-in-python/comment-page-1/)

```
#!/usr/bin/python

import serial, time
#initialization and open the port

#possible timeout values:
#    1\. None: wait forever, block call
#    2\. 0: non-blocking mode, return immediately
#    3\. x, x is bigger than 0, float allowed, timeout block call

ser = serial.Serial()
#ser.port = "/dev/ttyUSB0"
ser.port = "/dev/ttyUSB7"
#ser.port = "/dev/ttyS2"
ser.baudrate = 9600
ser.bytesize = serial.EIGHTBITS #number of bits per bytes
ser.parity = serial.PARITY_NONE #set parity check: no parity
ser.stopbits = serial.STOPBITS_ONE #number of stop bits
#ser.timeout = None          #block read
ser.timeout = 1            #non-block read
#ser.timeout = 2              #timeout block read
ser.xonxoff = False     #disable software flow control
ser.rtscts = False     #disable hardware (RTS/CTS) flow control
ser.dsrdtr = False       #disable hardware (DSR/DTR) flow control
ser.writeTimeout = 2     #timeout for write

try: 
    ser.open()
except Exception, e:
    print "error open serial port: " + str(e)
    exit()

if ser.isOpen():

    try:
        ser.flushInput() #flush input buffer, discarding all its contents
        ser.flushOutput()#flush output buffer, aborting current output 
                 #and discard all that is in buffer

        #write data
        ser.write("AT+CSQ")
        print("write data: AT+CSQ")

       time.sleep(0.5)  #give the serial port sometime to receive the data

       numOfLines = 0

       while True:
          response = ser.readline()
          print("read data: " + response)

        numOfLines = numOfLines + 1

        if (numOfLines >= 5):
            break

        ser.close()
    except Exception, e1:
        print "error communicating...: " + str(e1)

else:
    print "cannot open serial port " 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T05:40:55.537

I have not used pyserial but based on the API documentation at [https://pyserial.readthedocs.io/en/latest/shortintro.html](https://pyserial.readthedocs.io/en/latest/shortintro.html) it seems like a very nice interface. It might be worth double-checking the specification for AT commands of the device/radio/whatever you are dealing with.

Specifically, some require some period of silence before and/or after the AT command for it to enter into command mode. I have encountered some which do not like reads of the response without some delay first.

# javascript - 将文件从窗口拖放到 Javascript

> ID：676174
> 
> 赞同：0
> 
> 时间：2009-03-24T04:43:01.263
> 
> 标签：javascript, uploading

我确信可以将文件拖到浏览器中的 Flash 电影上，但是是否可以使用 Javascript 实现相同的功能？

我见过一个网站（不记得）这样做了，但我从未检查过它是否是纯 Javascript 解决方案与 Flash 解决方案相比。

我倾向于反对，**我**相信这打破了 Javascript 的限制，尽管如果有任何解决方案我很想听听。我唯一担心的是它不会在不同的浏览器中得到很好的支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T05:09:28.437

我认为不可能将文件拖到页面中。

尽管某些浏览器可能允许您将文件拖到文件上传输入框中。如果这是停止，也许您可​​以通过 CSS 拉伸这样的输入并使其透明/覆盖在背景上以提供“漂亮”的放置目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T05:27:14.090

您可以使用 ActiveX 执行此操作，尽管它只能在 IE 中使用。这里有一篇文章描述了如何在 Firefox 中进行拖放上传[http://straxus.javadevelopersjournal.com/creating_a_mozillafirefox_drag_and_drop_file_upload_script_p.htm](http://straxus.javadevelopersjournal.com/creating_a_mozillafirefox_drag_and_drop_file_upload_script_p.htm)

没有一种通用的方法可以适用于所有使用 javascript 的浏览器 - 但您可以使用这样的 java 小程序：[http ://www.zackgrossbart.com/hackito/2007/11/28/drag-and -drop-file-uploading-made-easy/](http://www.zackgrossbart.com/hackito/2007/11/28/drag-and-drop-file-uploading-made-easy/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-18T23:53:16.103

展示如何使用小程序支持拖放的文章位于：

```
http://www.zackgrossbart.com/hackito/dnd-file-uploading 
```

还有一篇文章展示了如何仅使用 JavaScript 来做到这一点。这需要 HTML5，但效果很好。

```
http://www.thecssnin]ja.com/javascript/drag-and-drop-upload 
```

# c# - C# 中的 LINQ 分组

> ID：676184
> 
> 赞同：2
> 
> 时间：2009-03-24T04:48:54.930
> 
> 标签：c#, linq

我很困惑。[我从 Microsoft LINQ 示例站点](http://msdn.microsoft.com/en-us/vcsharp/aa336747.aspx)复制了这段代码，但无法编译。

我想做类似的事情，但它说它无法解决符号 minPrice 和一堆其他错误。是什么赋予了？

```
public void Linq84() { 
   List products = GetProductList();

   var categories = 
      from p in products 
      group p by p.Category into g 
      from minPrice = g.Group.Min(p => p.UnitPrice) 
      select new {Category = g.Key, CheapestProducts = g.Group.Where(p => p.UnitPrice == minPrice)};

   ObjectDumper.Write(categories, 1); 
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T05:17:57.433

我认为该查询有一些拼写错误，或者是在 Linq 的早期阶段进行的。

我将其重写为：

```
var categories = from p in products
                 group p by p.Category into g
                   let  minPrice = g.Min(p => p.UnitPrice)
                 select new {
                              Category = g.Key,
                              CheapestProducts = g.Where(p => p.UnitPrice == minPrice)
                            }; 
```

顺便说一句，作为很好的学习资源，我强烈推荐你[**LinqPad**](http://www.linqpad.net/)这是一个很棒的工具和[HookedToLinq](http://www.hookedonlinq.com/)。

# javascript - 带js的临时文件名

> ID：676185
> 
> 赞同：0
> 
> 时间：2009-03-24T04:49:29.453
> 
> 标签：javascript

是否可以使用 javascript 获取临时文件名？

我想使用 ajax 上传文件...所以，我想用 js 获取 tmp 文件名。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T05:07:03.247

AJAX itself won't let you upload a file via a web form - you need to perform a traditional form post to a window (or a frame/iframe) in order to send binary content. Such a post must be handled by your server code (in Java, PHP, python, etc), which can process the stream into a temporary file (some languages/frameworks such as PHP can do this automatically).

You can then make the temporary file available via a URL scheme, and return this URL back as the result page of the post. If this is all on the same domain as your main page, you can then use Javascript to look "inside" the result iframe to find the temporary URL.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T05:02:36.427

If your using AJAX in combination with your server side language just return the temporary name and pull it in with the AJAX, if can all be done in 1 call.

# jquery - jQuery css 修饰符，使用 javascript 变量

> ID：676186
> 
> 赞同：1
> 
> 时间：2009-03-24T04:50:09.763
> 
> 标签：jquery

我有这行 jQuery：

```
$("#colorimage").css('background','url(images/bw.jpg)'); 
```

第一个问题：这是如何工作的，当通过 jQuery 使用 CSS 设置背景图像时，它从哪里寻找图像文件夹？

第二个问题：有没有办法可以将 Javascript 变量插入到第二个参数中？我有一个存储在 js 变量中的基本 url，但是做这样的事情：

```
$("#colorimage").css('background','url(' +  baseurl + 'images/bw.jpg)'); 
```

不起作用。

**编辑：** baseurl 是一个 Javascript 变量，现在它是[http://localhost/test/](http://localhost/test/)但它会发生变化，这就是我想使用变量的原因。

**编辑2：**这是一个路径问题，谢谢你们的答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T04:54:04.277

它将从应用它的文件的位置获取 url，因此如果您的页面是`http://mysite.com/index.html`，它将查看`http://mysite.com/images/bw.jpg`

尝试通过在开头放置一个斜杠来使您的 baseurl 绝对，或使用完整的 URL

```
baseurl = "/mySubFolder";
baseurl = "http://mysite.com/mySubFolder"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T04:56:31.870

**问题 1：** jQuery 会将背景图片的 css 设置为 'url(images/bw.jpg)'，就像您直接更改 css 一样。换句话说，如果它在一个 css 文件中，它将与该 css 文件相关。如果它是内联的，它将与页面相关。

**问题 2：** 看看 nickf 的回答 - 唯一不起作用的原因是它不是正确的路径。

编辑：尝试检查 baseurl 变量的内容（萤火虫甚至`alert()`）。除非路径指向错误的位置，否则我不明白为什么这不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T05:01:24.820

你也可以试试：

```
$("#colorimage").css('background-image','url(' +  baseurl + 'images/bw.jpg)'); 
```

# oracle - 将两个 dmp 文件导入单个模式

> ID：676187
> 
> 赞同：0
> 
> 时间：2009-03-24T04:51:10.820
> 
> 标签：oracle, dump

我有两个 dmp 文件要导入到我的数据库中的同一架构中。它们每个都是 20GB（大小可能是它们被导出为两个转储文件的原因）。我怎样才能连续导入到架构中。impdp 命令是否有允许我导入多个文件的选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:57:54.717

你不能只运行两次导入吗？我假设这些文件有不相交的数据集。如果它试图创建的对象已经存在，您可能需要一个命令行开关“ignore=y”来允许导入继续。

或者，也许我没有完全理解你的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T17:13:21.753

我没有使用过 DataPump，但看起来你可以只给出多个用逗号分隔的文件名。看这里的 DUMPFILE 参数：

[http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/dp_import.htm#i1010670](http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/dp_import.htm#i1010670)

# .net - 在托管（嵌入式）环境中调试 IronPython 脚本

> ID：676188
> 
> 赞同：28
> 
> 时间：2009-03-24T04:52:53.283
> 
> 标签：.net, debugging, ironpython

我正在编写一个嵌入了 IronPython (2.0.1) 的 C# 应用程序。这个想法是将应用程序的一部分暴露给用户编写的 IronPython 脚本。

我想为用户提供能够使用 Visual Studio 调试器调试他们编写的脚本的能力。请注意，脚本在托管环境中运行，而不是通过 IronPython 可执行文件 (ipy.exe)。

在 IronPython 程序集上使用了一点 Reflector 魔法之后，我想出了一些可以让我做到这一点的东西，但我不确定这是否是规定的方式。基本上我所做的是创建一个“DebugMode”属性设置为true的“ScriptRuntime”对象，然后从“ScriptRuntime”创建一个基于python的“ScriptEngine”，用于托管。代码如下。

```
 ScriptRuntimeSetup setup = new ScriptRuntimeSetup();
        setup.DebugMode = true;
        setup.LanguageSetups.Add(Python.CreateLanguageSetup(null));

        ScriptRuntime runtime = new ScriptRuntime(setup);
        ScriptEngine engine = runtime.GetEngineByTypeName(typeof(PythonContext).AssemblyQualifiedName); 
```

现在，当我在托管环境中执行脚本时，使用：

```
 ScriptSource script = engine.CreateScriptSourceFromFile(path);
            CompiledCode code = script.Compile();
            ScriptScope scope = engine.CreateScope();
            script.Execute(scope); 
```

我可以在脚本文件中放置断点，当脚本执行时它们会被命中。

那么，有没有更好/更简单的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-24T08:52:59.290

好的，我知道了。有一个“Python.CreateEngine”可以作为参数的选项字典。可以在其中指定调试模式。

```
 Dictionary<string, object> options = new Dictionary<string, object>();
        options["Debug"] = true;
        engine = Python.CreateEngine(options); 
```

我认为这很简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-01T14:11:43.667

Harry Pierson (DevHawk) 有一篇关于这个主题的博客文章可以帮助您入门：

[Microsoft.Scripting.Debugging](http://devhawk.net/2009/07/08/MicrosoftScriptingDebugging.aspx)

# java - 根据软件许可证标志更改 JAAS 角色

> ID：676189
> 
> 赞同：1
> 
> 时间：2009-03-24T04:53:14.607
> 
> 标签：java, hibernate, licensing, jakarta-ee, jaas

我有一个在 JBOSS 上运行的非常普通的 Java EE 应用程序。它使用 JBoss DatabaseLoginModule JAAS 身份验证。它在 Hibernate 中也有完全相同的应用层用户/角色。

我有一个想法（无论如何我认为这对我来说非常有用）有一个我可以在软件许可证对象中设置的功能位（不使用休眠），它使所有用户都成为只读用户。这让我可以通过重新授权来制作产品的只读版本。

我想做的是根据程序内部可访问的布尔标志重新映射用户关联。

所以通常我们得到（多对多加入）

用户 -*UserRole*-Role -*RoleActions

在哪里

user.roleid =>角色.id

设置布尔值时（软件许可证中设置的功能位）

当许可证这样说时，我希望 JAAS 表现得像所有用户都是 roleid =1。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T06:03:27.323

通过继承 DatabaseServerLoginModule 我可以执行额外的检查。（在软件许可证上）

微不足道我可以

1.  如果许可证过期，给一个只读用户（凭证是固定的）

2.  如果许可证设置了只读能力位，则给只读用户（凭据是固定的）

由于登录已被拦截，Hibernate User 查找将针对正确的用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:43:52.187

也许我在这里错过了这条船，但为什么不以编程方式这样做呢？

在`User`对象中，提供一个像`getAuthenticatedRoles()`这样的瞬态吸气剂会额外过滤`Hibernate`加载的内容。另外，制作原始映射集合 getter `protected`，并仅从`getAuthenticatedRoles()`其他 Java 代码中使用。

# python - 如何为我的 Python 脚本生成测试数据？

> ID：676198
> 
> 赞同：3
> 
> 时间：2009-03-24T04:57:57.793
> 
> 标签：python

等式采用以下形式的值：

```
 x = [0x02,0x00]  # which is later internally converted to in the called function to  0x300
   y = [0x01, 0xFF]
   z = [0x01, 0x0F] 
```

如何为此函数生成一系列测试值？例如，我想从 for 循环中发送 100 个奇数值

```
for i in range(0,300):
   # where a,b are derived for a range
   x = [a,b] 
```

我的问题有点不清楚，所以请让我澄清一下。我想问的是如何`x =[a,b]`为`a,b`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T05:05:29.523

use generators:

```
def gen_xyz( max_iteration ):
    for i in xrange( 0, max_iteration ):
       # code which will generate next ( x, y, z )
       yield ( x, y, z ) 

for x, y, z in gen_xyz( 1000 ):
  f( x, y, z ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T06:48:50.413

十六进制（）函数？

```
import random
for i in range(10):
    a1, a2 = random.randint(1,100), random.randint(1,100)
    x = [hex(a1), hex(a2)]
    print x 
```

..输出类似于..的东西

```
['0x21', '0x4f']
['0x59', '0x5c']
['0x61', '0x40']
['0x57', '0x45']
['0x1a', '0x11']
['0x4c', '0x49']
['0x40', '0x1b']
['0x1f', '0x7']
['0x8', '0x2b']
['0x1e', '0x13'] 
```

# networking - 如何利用全带宽？

> ID：676200
> 
> 赞同：-1
> 
> 时间：2009-03-24T04:59:10.817
> 
> 标签：networking, network-programming, packet

使用 WinPcap，我制作了一系列自定义 UDP 数据包并将它们注入以太网层。

我发送了 1000 个数据包，每个数据包 1440 字节。100 Mbps 带宽需要 2.1 秒。

如何利用全带宽？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T05:09:09.687

Your throughput seems to be exactly the max you'd get for a *10 mbit* connection. Sure there's no 10mbit involved anywhere ?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T22:12:10.320

最初我误读了这个问题，并认为它是这个的[副本](https://stackoverflow.com/questions/99054/having-trouble-achieving-1gbit-udp-throughput/107994)。但是 100Mbps 使它完全不同。

即使是非常普通的硬件也应该能够毫无问题地使 100Mbps 连接饱和 - 特别是如果您使用 1440 字节的 udp 数据包。

正如 krosenvold 所建议的那样，这些数字看起来确实像 10Mbps 连接，而不是 100Mbps。我会从头到尾检查所有链接，以确保它们达到您认为的 100Mbps。该链中的任何 10Mbps 链路都将成为问题。

根据您使用的设备，您可能会发现链路自动协商存在问题。有些设备是出了名的糟糕，因此您可以通过关闭自动协商并将链接速度强制为 100Mbps 来获得更好的结果。

由于您有一个正在使用的 pcap 文件，我建议您尝试[tcpreplay](http://tcpreplay.synfin.net/)进行一些速度测试。tcpreplay 提供了几个选项来以尽可能高的速度重播文件。（特别是，看看[这个](http://tcpreplay.synfin.net/trac/wiki/tcpreplay#Replayingatdifferentspeeds)wiki 条目）

如果这给您的结果与您目前看到的不同，则可能表明 pcap 文件存在问题。例如，pcap 文件确实包含可在重放文件时使用的计时信息。如果您的 pcap 文件中的时间是从 10Mbps 网络中获取的（例如），那么实时重放它会给您提供您所看到的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T22:22:27.627

确保数据交换路径上的所有设备和媒体都以 100 mbps 的速度运行，连接的速度仅与最薄弱的链路一样快。还要确保所有设备（包括您的网卡）都在[全双工](http://en.wikipedia.org/wiki/Full-duplex)模式下运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T22:42:03.157

传输期间的 CPU 使用率如何？

我们需要找到瓶颈。它可以是 NIC/网络或 CPU。确保您没有为每个数据包“打开”NIC。

错误的：

```
loop{
   OpenDevice
   SendPacket
} 
```

好的：

```
OpenDevice
loop{
 SendPacket
} 
```

# wcf - 如何在 WCF 中启用 webHttp 连接？

> ID：676201
> 
> 赞同：3
> 
> 时间：2009-03-24T04:59:35.090
> 
> 标签：wcf, rest, webhttpbinding

我正在开发一种将数据从 android 手机传输到服务器的解决方案（用 C#/.NET 编写）。

我创建了一个 WCF 服务并使用模拟器进行测试，一切正常。然后，当我尝试从手机登录（连接到家庭 wifi 网络）时，我收到以下异常消息：

> org.apache.http.conn.HttpHostConnectException：连接到[http://192.168.1.5:8000](http://192.168.1.5:8000)被拒绝

如果有人可以查看配置文件和界面并就如何启用连接提供任何建议，我将不胜感激。

网络配置：

```
<configuration>
  <system.web>
    <compilation debug="true"/>
  </system.web>
  <system.serviceModel>
    <bindings>
      <webHttpBinding>
        <binding name="DefaultBinding"
                 allowCookies="true"
                 bypassProxyOnLocal="true" />
      </webHttpBinding>
    </bindings>
    <behaviors>
      <endpointBehaviors>
        <behavior name="RESTFriendly">
          <webHttp/>
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <services>
      <service name="RESTServer.LoginService">
        <endpoint address=""
                  behaviorConfiguration="RESTFriendly"
                  binding="webHttpBinding"
                  bindingConfiguration="DefaultBinding"
                  contract="RESTServer.ILoginService" />
      </service>
    </services>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
  </system.serviceModel>
</configuration> 
```

界面：

```
[ServiceContract()]
public interface ILoginService
{
    [WebGet(ResponseFormat = WebMessageFormat.Xml, UriTemplate = "/username={username}&password={password}")]
    [OperationContract]
    Message Login(string username, string password);
} 
```

服务实现：

```
public class LoginService : ILoginService
{
    public Message Login(string username, string password)
    {
        Message message = new Message();
        SQLWorks sqlWorks = new SQLWorks();
        string strSession = sqlWorks.Login(username, password);
        string strMessage;
        message.Session = strSession;
        if(strSession == "")
        {
            strMessage = "Login failed! Please check your username/password!";
        }
        else
        {
            strMessage = "Login Successful";
        }
        message.ErrorMessage = strMessage;
        return message;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T05:04:15.923

为了连接到您的服务，它需要托管在公共 Web 服务器上。看起来您使用的地址 192.168.1.5:8000 是家庭网络地址，无法从外部世界（电话）访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T05:59:11.127

如果您使用的是 vista 操作系统，则必须将地址添加到防火墙中

netsh http 添加 urlacl url= [http://+:8000/](http://+:8000/) user=DOMAIN\user

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-09T16:11:28.880

使用您的 LAN ip 将您的模拟器与 Web 服务连接起来，例如：http: [//192.168.1.78 :8080/webservice](http://192.168.1.78:8080/webservice)

但是您的本地连接必须启用转到：控制面板\网络和 Internet\网络连接

# freebase - Freebase MQL 查询主题摘要和图像？

> ID：676204
> 
> 赞同：7
> 
> 时间：2009-03-24T05:01:16.257
> 
> 标签：freebase, mql

我正在尝试编写要使用[Freebase](http://www.freebase.com/) API执行的[MQL 查询。](http://www.freebase.com/view/en/documentation)我想检索主题摘要和主题的图像。

我已经能够计算出以下查询，它将为我提供与[比尔盖茨](http://www.freebase.com/view/en/bill_gates)主题相关的图像。

MQL：

```
[
  {
    "/common/topic/image" : [
      {
        "id" : null
      }
    ],
    "name" : "bill gates",
    "type" : "/people/person"
  }
] 
```

结果：

```
[
  {
    "/common/topic/image" : [
      {
        "id" : "/guid/9202a8c04000641f8000000004fb4c01"
      },
      {
        "id" : "/wikipedia/images/commons_id/4486276"
      }
    ],
    "name" : "Bill Gates",
    "type" : "/people/person"
  }
] 
```

对于那些过去可能没有接触过 MQL 但有兴趣尝试它的人。查看[Freebase MQL 查询编辑器](http://www.freebase.com/tools/queryeditor)。

[账单个人资料页面 http://i.friendfeed.com/c31a22d9e439eb67b0feeb4ffd64c3b5ed9a8e16](http://i.friendfeed.com/c31a22d9e439eb67b0feeb4ffd64c3b5ed9a8e16)

**更新**

我最终使用的查询：

```
[
  {
    "/common/topic/image" : [
      {
        "id" : null
      }
    ],
    "article" : [
      {
        "content" : null
      }
    ],
    "name" : "bill gates",
    "type" : "/common/topic"
  }
] 
```

这些结果可以与 narphorium 的答案结合起来检索实际数据：

```
[
  {
    "/common/topic/image" : [
      {
        "id" : "/guid/9202a8c04000641f8000000004fb4c01"
      },
      {
        "id" : "/wikipedia/images/commons_id/4486276"
      }
    ],
    "article" : [
      {
        "content" : null
      },
      {
        "content" : "/guid/9202a8c04000641f800000000903535d"
      }
    ],
    "name" : "Bill Gates",
    "type" : "/common/topic"
  }
] 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T05:53:33.107

图像和主题摘要分别存储在内容存储中，并可通过[另一个 Web 服务 API](http://www.freebase.com/view/en/api_trans_raw)访问。

例如，比尔盖茨的图片可以这样访问：

[http://www.freebase.com/api/trans/raw/guid/9202a8c04000641f8000000004fb4c01](http://www.freebase.com/api/trans/raw/guid/9202a8c04000641f8000000004fb4c01)

同样，可以通过在查询中将 /common/topic/image 替换为 /common/topic/article 来找到主题摘要的 GUID。可以像这样再次访问结果：

[http://www.freebase.com/api/trans/raw/guid/9202a8c04000641f8000000008bfed35](http://www.freebase.com/api/trans/raw/guid/9202a8c04000641f8000000008bfed35)

[您可以在此处](http://mql.freebaseapps.com/ch04.html#transservice)阅读有关内容存​​储的更多信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-24T07:46:17.433

freebase 提供的新图像服务现在可用于使用 freebase id 获取图像，例如，对于比尔盖茨，以下是图像 URL：

[https://usercontent.googleapis.com/freebase/v1/image/en/bill_gates](https://usercontent.googleapis.com/freebase/v1/image/en/bill_gates)

有关此服务的更多信息，请访问：[http ://wiki.freebase.com/wiki/Image_Service](http://wiki.freebase.com/wiki/Image_Service)

# c# - 使用指针访问结构成员

> ID：676207
> 
> 赞同：2
> 
> 时间：2009-03-24T05:02:28.907
> 
> 标签：c#, pointers, structure

我正在尝试将以下代码从 C++ 转换为 C#

`

```
struct tPacket
{
WORD size;
WORD opcode;
BYTE securityCount;
BYTE securityCRC;
} 
```

...

```
static char data[8192] = {0};
tPacket * packet = (tPacket *)data;` 
```

到目前为止，我想出了：

C＃

```
public struct tPacket
{
public ushort size;
public ushort opcode;
public byte securityCount;
public byte securityCRC;
}     

public static byte[] data = new byte[1024];
tPacket packet = new tPacket();
packet = (tPacket *)data; 
```

但是，我收到错误“无法将类型 'byte[]' 转换为 'MyNameSpace.tPacket*”

整个代码用于将接收到的数据包缓冲区（数据）放入结构中，然后直接访问结构成员。任何帮助将不胜感激！提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T05:15:41.433

这是一个可能有帮助的链接：

[http://varjabedian.net/archive/2008/07/29/casting-a-byte-array-into-structures-in-c.aspx](http://varjabedian.net/archive/2008/07/29/casting-a-byte-array-into-structures-in-c.aspx)

# javascript - creating something like pageflakes

> ID：676220
> 
> 赞同：2
> 
> 时间：2009-03-24T05:10:20.573
> 
> 标签：javascript, jquery

Does anyone know about a tutorial that lets you to create something like pageflakes.com for your website? In jquery perhaps?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T23:26:12.747

PageFlakes 的创建者[Omar al Zabir创建了一个名为](http://msmvps.com/blogs/omar/)[DropThings](http://www.codeplex.com/dropthings/)的开源 Web 门户。没有比这更类似于 PageFlakes 的了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T23:16:11.523

[CodeProject 上的这篇文章](http://www.codeproject.com/KB/ajax/MakingGoogleIG.aspx)有一个关于如何构建几乎完全符合您需求的优秀教程，除了它使用 ASP.Net Ajax。不过，您可以轻松地将其替换为 jQuery。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T01:52:17.637

.nettuts 有一个例子，都是在 jquery 和 jquery ui 中完成的。这是链接：

[http://net.tutsplus.com/tutorials/javascript-ajax/inettuts/](http://net.tutsplus.com/tutorials/javascript-ajax/inettuts/)

也非常详细地经历了这一切。它不会是 pageflakes 的直接副本，这是留给读者的练习，但它确实显示了如何开始。

！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:58:05.583

Check out ExtJS's Panels. They're what's used to build this pageflakes look-alike: [http://extjs.com/deploy/dev/examples/portal/portal.html](http://extjs.com/deploy/dev/examples/portal/portal.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T11:46:02.867

您可以使用 jQuery 的 UI 库，您可以在其中找到[带有 grid 的可拖动元素](http://jqueryui.com/demos/draggable/#snap-to)。除此之外，您只需要设置和读取一些确定每个框位置的 cookie。假设您的布局有 4 个 <div>。只需将每个 id 和位置保存在 cookie 中（来自 javascript 或通过对 php/asp 页面执行 AJAX 请求）。

显示页面也很容易，您必须有两种可能性：当用户定义了 cookie 时，或者（这将是默认设置）。如果用户定义了一个 cookie，读取它并像 cookie 所说的那样定位 <div>，这样做应该不会太难。

# php - iPhone将独特的图像上传到运行PHP / MYSQL的服务器

> ID：676221
> 
> 赞同：1
> 
> 时间：2009-03-24T05:11:16.640
> 
> 标签：php, iphone, mysql

我正在开发一个将图像上传到网络服务器的 iPhone 应用程序。我想知道是否有人对如何为每个上传的图像文件生成唯一名称有任何提示。我确信有一百万种方法可以做到这一点，但如果有人有任何建议，我将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T05:29:41.790

您可以创建一个 GUID 并将图像保存为该名称..

谢谢

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T05:24:19.820

最简单的解决方案（假设您将这些存储在数据库中）是在数据库中有一个自动增量字段，并在文件上传时使用它来重命名文件。这样你最终会得到 image00000001.jpg、image00000002.jpg 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T15:09:45.797

最简单的方法是将当前时间转换为字符串并将其用作名称。永远是独一无二的:)

或者，如果您的数据库中有私钥，请将其与通用字符串一起使用，为每个图像生成唯一名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T05:31:35.933

您可以使用 unix 时间戳。这将允许您使用新文件更新记录，同时仍保持相同的 id，而不必在每次更改文件时都创建新记录。一些喜欢：

```
 $uploadData = pathinfo($_FILES['file']['tmp_name']);
 move_uploaded_file($_FILES['file']['tmp_name'], time() . '.' . $uploadData['extension']); 
```

我建议进行更多检查以确保文件是您要查找的文件，例如 mime 类型/扩展名检查、最大大小，并确保文件是使用`is_uploaded_file()`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T20:26:07.057

您可能需要考虑使用生成手机的设备 ID 来确保整个 iPhone 的唯一性。

# c# - How to implement a modal window in an XBAP application

> ID：676234
> 
> 赞同：1
> 
> 时间：2009-03-24T05:21:53.523
> 
> 标签：c#, wpf, modal-dialog, xbap

I have a XBAP application which has the following code in a Page:

```
Person newPerson = new Person();
PersonWindow personWindow = new PersonWindow(newPerson);            
personWindow.ShowDialog(); 
```

When this code is invoked from a XBAP page, the resultant window does not behave like a modal window.

How can it be changed to behave like one without a significant amount of changes?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-02T14:29:11.003

看来，您必须通过禁用所有其他窗口控件来自行实现“模态”。[这里是关于那个的讨论](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/ef66f6a7-eb9d-42f6-86ba-7fbefb72fa95/)

# apache-flex - 如何在 flex sharedlocalobject 中存储多个对象？

> ID：676235
> 
> 赞同：1
> 
> 时间：2009-03-24T05:21:55.863
> 
> 标签：apache-flex, actionscript-3, flex3

我有一个项目，客户端可以将数据从 flex 应用程序保存到 xml 中的客户端，例如

`<xml>`
`<project id='1111'>`
`<data ... />`
`<data ... />`
`</project>`
`</xml>`

这存储在 flex sharedlocalobject 上，但如果客户端创建一个新项目，它会覆盖现有项目。如何在 sharedlocalobject 中存储多个项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T06:56:27.540

共享对象的`data`属性可以存储任意数量的值，如下所示：

```
var so:SharedObject = SharedObject.getLocal("sharedObject");
so.data.one = 1;
so.data.two = 2;
... 
```

因此，在您的情况下，您可以简单地将每个项目 XML 存储在数据对象的单独“属性”中。

# silverlight - Silverlight：如何获取 ProcessorCount？

> ID：676243
> 
> 赞同：3
> 
> 时间：2009-03-24T05:28:19.407
> 
> 标签：silverlight, multithreading

我有一个用户可以使用 Silverlight 应用程序执行的计算密集型任务。并行化是一项非常容易的任务。

我的问题是 System.Environment.ProcessorCount 是安全关键，所以我不能轻易检查。

我不想只使用 QueueUserWorkItem，因为我不想拥有超过执行的处理器数量——这无济于事。

此处描述了一种解决方法：http: [//www.codeproject.com/KB/silverlight/multicore.aspx](http://www.codeproject.com/KB/silverlight/multicore.aspx)

但这有点骇人听闻，要使它对 4 或 8 线程系统相当可靠，还需要做一些工作。

解决这个问题的“正确”方法是什么？或者，Silverlight 是否会让您在这里不走运？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T05:18:54.303

此方法是 SecurityCritical 而不是 SecuritySafeCritical 的事实很可能是由于桌面版本 .NET Framework 版本要求 EnvironmentPermission 获取此数据这一事实造成的。

我们已经放宽了对桌面端的需求，因此在 Silverlight 上成为 SafeCritical 确实很有意义。我已将此作为我们应该在未来版本的 Siverlight 中解决的问题提出，看起来我们将能够做到这一点。

如果您发现在 Silverlight 中有更多公共方法感觉应该是 SafeCritical 而不是 Critical 的情况，请在[Microsoft Connect](https://connect.microsoft.com/VisualStudio)提交一些反馈。真实的人确实会关注这些问题，这是让我们了解您的痛点的最佳选择。

For now it looks like you'll have to go with the workaround provided but at some point we'll fix the security annotation here.

This has been fixed in Silverlight 4.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T12:52:56.560

我不知道codeproject检测机制有那么糟糕。如果没有别的，您可以将该代码包装成一个方法以对其进行初步测试。当出现更好的检测方法时，您将实现更改为该方法，但我理解问题在于您只能保证知道至少有 2 个内核。当然，这取决于您想要执行的线程在出色硬件上的性能较低。

另一件令人讨厌的事情是允许用户像 7zip 一样调整他们希望在您的应用程序中运行的线程数。如果您检测到 2 个以上的内核，则可以公开一个自旋控件，让用户决定他们想要多少线程。比自动检测更笨重，但至少在 4 个以上内核的情况下，您希望代码运行得更优化。

# javascript - 深度克隆与设置 innerHTML：什么更快？

> ID：676249
> 
> 赞同：34
> 
> 时间：2009-03-24T05:32:27.820
> 
> 标签：javascript, dom, dhtml

我试图找出在浏览器中深度克隆 DOM 树的最高效方法。

如果我开始

```
var div = document.getElementById("source");
var markup = div.innerHTML; 
```

什么会更快，

```
var target = div.cloneNode(true); 
```

或者

```
var target = document.cloneNode(false);
target.innerHTML = markup; 
```

我知道浏览器平台在这里可能会产生很大的不同，因此任何有关这些在现实世界中如何比较的信息都将不胜感激。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-24T17:59:59.990

让我们测试一下！

我将以下代码添加到 StackOverflow 问题页面的副本中（首先删除现有脚本，然后从头开始运行，`timeit()`每次都未注释其中一个 s，三个运行 100 个操作：

```
function timeit(f) {
    var start= new Date();
    for (var i=100; i-->0;) {
        f();
    }
    return new Date()-start;
}

var c= document.getElementById('content');
var clones= [];

//alert('cloneNode: '+timeit(function() {
//    clones.push(c.cloneNode(true));
//}))

//alert('innerHTML: '+timeit(function() {
//    var d= document.createElement('div');
//    d.innerHTML= c.innerHTML;
//    clones.push(d);
//})) 
```

以下是在 Core 2 Q9300 上的 VirtualBox 上运行的结果：

```
IE7
cloneNode: 3238, 3235, 3187
innerHTML: 8442, 8468, 8552

Firefox3
cloneNode: 1294, 1315, 1289
innerHTML: 3593, 3636, 3580

Safari3
cloneNode: 207, 273, 237
innerHTML: 805, 818, 786

Chrome1
cloneNode: 329, 377, 426
innerHTML: 2327, 2536, 2865

Opera10
cloneNode: 801, 791, 771
innerHTML: 1852, 1732, 1672 
```

所以`cloneNode(true)`比复制要快得多`innerHTML`。当然，它总是如此；将 DOM 序列化为文本，然后从 HTML 重新解析它是一项艰巨的工作。DOM 子操作通常很慢的原因是您要一个接一个地插入/移动它们；像这样的一次性 DOM 操作`cloneNode`不必这样做。

Safari 设法以`innerHTML`惊人的速度完成操作，但仍然没有它那么快`cloneNode`。正如预期的那样，IE 是一只狗。

因此，对于所有说 innerHTML 显然会更快而不考虑问题实际在做什么的人来说，自动 -1 都是如此。

是的，jQuery 使用 innerHTML 进行克隆。不是因为它更快——阅读源代码：

```
// IE copies events bound via attachEvent when
// using cloneNode. Calling detachEvent on the
// clone will also remove the events from the orignal
// In order to get around this, we use innerHTML. 
```

jQuery 用于`Element.attachEvent()`实现自己的事件系统，因此自然需要避免该错误。如果不需要，可以避免开销。

**题外话：**再说一次，我认为将 jQuery 列为最佳实践的顶峰可能有点错误，尤其是考虑到下一行：

```
html.replace(/ jQuery\d+="(?:\d+|null)"/g, "") 
```

没错——jQuery 将它自己的任意属性添加到 HTML 元素，然后在克隆它们时需要删除它们（或者以其他方式访问它们的标记，例如通过`$().html()`方法）。这已经够难看的了，但它认为最好的方法是使用正则表达式处理 HTML，这是一种基本错误，你会认为天真的 1-reputation SO 提问者比 Second Coming Best 的作者更多JS 框架 Evar。

`jQuery1="2"`希望您的文本内容中没有任何字符串，因为如果是这样，您只是神秘地丢失了它。谢谢，jQuery！这样就结束了题外话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:46:53.997

嗯...有趣的是，我刚刚在 Firefox 3 中进行了测试，深度克隆似乎比使用 innerHTML 路线快 3 倍。

我确信 innerHTML 仍然比单个 DOM 操作更快，但至少对于深度克隆，cloneNode(true) 似乎得到了更好的优化。

# java - 将文件加载为 InputStream 的不同方式

> ID：676250
> 
> 赞同：232
> 
> 时间：2009-03-24T05:32:43.560
> 
> 标签：java, inputstream

有什么区别：

```
InputStream is = this.getClass().getClassLoader().getResourceAsStream(fileName) 
```

和

```
InputStream is = Thread.currentThread().getContextClassLoader().getResourceAsStream(fileName) 
```

和

```
InputStream is = this.getClass().getResourceAsStream(fileName) 
```

什么时候每一个都比其他的更适合使用？

我要读取的文件作为读取文件的类位于类路径中。我的类和文件在同一个 jar 中并打包在一个 EAR 文件中，并部署在 WebSphere 6.1 中。

* * *

## 回答 #1

> 赞同：303
> 
> 时间：2009-03-24T05:52:21.640

`fileName`关于您传递的内容的解释方式存在细微差别。基本上，您有 2 种不同的方法：`ClassLoader.getResourceAsStream()`和`Class.getResourceAsStream()`. 这两种方法将以不同的方式定位资源。

在`Class.getResourceAsStream(path)`中，路径被解释为您从中调用它的类的包的本地路径。例如调用，`String.class.getResourceAsStream("myfile.txt")`将在您的类路径中的以下位置查找文件：`"java/lang/myfile.txt"`. 如果您的路径以 a 开头`/`，那么它将被视为绝对路径，并将从类路径的根目录开始搜索。因此，调用`String.class.getResourceAsStream("/myfile.txt")`将查看您的类路径中的以下位置`./myfile.txt`。

`ClassLoader.getResourceAsStream(path)`将所有路径视为绝对路径。因此，调用`String.class.getClassLoader().getResourceAsStream("myfile.txt")`and`String.class.getClassLoader().getResourceAsStream("/myfile.txt")`都会在您的类路径中的以下位置查找文件：`./myfile.txt`.

每次我在这篇文章中提到一个位置时，它可能是您的文件系统本身中的一个位置，也可能是相应的 jar 文件中的一个位置，具体取决于您从中加载资源的类和/或类加载器。

在您的情况下，您正在从应用程序服务器加载类，因此您应该使用`Thread.currentThread().getContextClassLoader().getResourceAsStream(fileName)`而不是`this.getClass().getClassLoader().getResourceAsStream(fileName)`. `this.getClass().getResourceAsStream()`也将工作。

阅读[本文](http://www.javaworld.com/javaworld/javaqa/2003-08/01-qa-0808-property.html)以获取有关该特定问题的更多详细信息。

* * *

## Tomcat 7 及以下用户的警告

这个问题的答案之一表明我的解释对于 Tomcat 7 似乎是不正确的。我试图环顾四周，看看为什么会这样。

所以我查看了 Tomcat 的`WebAppClassLoader`几个版本的 Tomcat 的源代码。Tomcat 6 和 Tomcat 7的实现`findResource(String name)`（最终负责生成请求资源的 URL）实际上是相同的，但在 Tomcat 8 中是不同的。

在版本 6 和 7 中，实现不会尝试规范化资源名称。这意味着在这些版本中，`classLoader.getResourceAsStream("/resource.txt")`可能不会产生与事件相同的结果，`classLoader.getResourceAsStream("resource.txt")`尽管它应该（因为 Javadoc 指定）。[[源代码]](https://github.com/apache/tomcat/blob/7.0.96/java/org/apache/catalina/loader/WebappClassLoaderBase.java)

但是在版本 8 中，资源名称被规范化以保证资源名称的绝对版本是使用的那个。因此，在 Tomcat 8 中，上述两个调用应该总是返回相同的结果。[[源代码]](https://github.com/apache/tomcat/blob/8.5.45/java/org/apache/catalina/loader/WebappClassLoaderBase.java)

因此，在使用 Tomcat 8 之前的版本时，您必须格外小心`ClassLoader.getResourceAsStream()`。`Class.getResourceAsStream()`并且您还必须记住`class.getResourceAsStream("/resource.txt")`实际调用`classLoader.getResourceAsStream("resource.txt")`（前导`/`被剥离）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-24T11:57:39.330

用于`MyClass.class.getClassLoader().getResourceAsStream(path)`加载与您的代码关联的资源。`MyClass.class.getResourceAsStream(path)`用作快捷方式，并用于打包在您的类包中的资源。

用于`Thread.currentThread().getContextClassLoader().getResourceAsStream(path)`获取属于客户端代码一部分的资源，而不是与调用代码紧密绑定。你应该小心这一点，因为线程上下文类加载器可能指向任何东西。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-07-09T17:13:36.563

普通旧 Java 和普通旧 Java 7 上的普通旧 Java 没有其他依赖关系证明了差异......

我放入`file.txt`并`c:\temp\`放入`c:\temp\`类路径。

只有一种情况是两个调用之间存在差异。

```
class J {

 public static void main(String[] a) {
    // as "absolute"

    // ok   
    System.err.println(J.class.getResourceAsStream("/file.txt") != null); 

    // pop            
    System.err.println(J.class.getClassLoader().getResourceAsStream("/file.txt") != null); 

    // as relative

    // ok
    System.err.println(J.class.getResourceAsStream("./file.txt") != null); 

    // ok
    System.err.println(J.class.getClassLoader().getResourceAsStream("./file.txt") != null); 

    // no path

    // ok
    System.err.println(J.class.getResourceAsStream("file.txt") != null); 

   // ok
   System.err.println(J.class.getClassLoader().getResourceAsStream("file.txt") != null); 
  }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-11-19T11:02:54.773

这里的所有这些答案，以及[这个问题](https://stackoverflow.com/questions/6608795)中的答案，都表明加载绝对 URL，如“/foo/bar.properties”，由`class.getResourceAsStream(String)`和处理相同`class.getClassLoader().getResourceAsStream(String)`。情况并非如此，至少在我的 Tomcat 配置/版本（当前为 7.0.40）中不是。

```
MyClass.class.getResourceAsStream("/foo/bar.properties"); // works!  
MyClass.class.getClassLoader().getResourceAsStream("/foo/bar.properties"); // does NOT work! 
```

抱歉，我绝对没有令人满意的解释，但我猜想 tomcat 用类加载器做了肮脏的把戏和他的黑魔法并导致了差异。我以前一直用过`class.getResourceAsStream(String)`，没有任何问题。

PS：我也发过[这里](https://stackoverflow.com/questions/6608795/what-is-the-difference-between-class-getresource-and-classloader-getresource/20069798#20069798)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-03-20T15:03:51.520

在尝试了一些没有成功加载文件的方法后，我记得我可以使用`FileInputStream`，它工作得很好。

```
InputStream is = new FileInputStream("file.txt"); 
```

这是将文件读入的另一种方法`InputStream`，它从当前运行的文件夹中读取文件。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2014-07-02T08:21:19.133

它有效，试试这个：

```
InputStream in_s1 =   TopBrandData.class.getResourceAsStream("/assets/TopBrands.xml"); 
```

# .net - Can I find out if a particular attribute was present on the calling function?

> ID：676252
> 
> 赞同：1
> 
> 时间：2009-03-24T05:36:46.953
> 
> 标签：.net, reflection, attributes

Is there a way to find out if the calling function had attributes set on it?

```
[RunOnPlatformB]
int blah()
{
    return boo();
}

int boo()
{
    // can i find out if RunOnPlatformB was set on my caller?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T05:56:50.680

您可以从堆栈跟踪中获取调用者函数，并查询其属性：

```
System.Diagnostics.StackTrace st = new System.Diagnostics.StackTrace();
Object[] attr =
   st.GetFrame(1).GetMethod().GetCustomAttributes(typeof(RunOnPlatformBAttribute), false);
if (attr.Length > 0) {
   // Yes, it does have the attribute RunOnPlatformB
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T06:10:45.577

首先，您必须上 StackFrame 才能找到调用您的内容，根据我的经验，这是一个非常昂贵的操作，并且可能还会有安全问题，具体取决于您运行的上下文。代码将是这样的 -

```
using System.Diagnostics;
using System.Reflection;

....
    StackTrace stackTrace = new StackTrace();           
    StackFrame[] stackFrames = stackTrace.GetFrames(); 

    StackFrame caller = stackFrames[1]; 

    MethodInfo methodInfo = caller.GetMethod() as MethodInfo;
    foreach (Attribute attr in methodInfo.GetCustomAttributes())
    ..... 
```

# python - Python 和文本操作

> ID：676253
> 
> 赞同：8
> 
> 时间：2009-03-24T05:36:54.707
> 
> 标签：python, text

我想学习一种文本操作语言，我已经把 Python 归零了。除了文本操作，Python 还用于数值应用、机器学习、人工智能等。

我的问题是如何学习 Python 语言，以便能够快速编写复杂的文本操作实用程序。除了“文本操作”上下文中的正则表达式之外，哪些语言特征比其他语言更重要，哪些模块有用等等。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-24T05:51:36.340

除了正则表达式之外，还有一些重要的特性：

*   生成器，请参阅David Beazley 的[《系统程序员](http://www.dabeaz.com/generators-uk/)的生成器技巧》，其中有很多很好的示例，可以通过生成器传输无限量的文本。

对于工具，我建议查看以下内容：

*   [Whoosh ，一个纯 Python 搜索引擎，它将为您提供一些在 Python 中使用](http://whoosh.ca/)[pyparsing](http://pyparsing.wikispaces.com/)和文本处理来解析文本的不错的真实示例。

*   Ned Batcheldor[对各种 Python 解析工具](http://nedbatchelder.com/text/python-parsers.html)的好评。

*   [mxText工具](http://www.egenix.com/products/python/mxBase/mxTextTools/)

*   [Docutils](http://docutils.sourceforge.net/)源代码，用于在 Python 中进行更高级的文本处理，包括复杂的状态机。

**编辑：**特定于 Python 中的文本处理的一个很好的链接：

*   David Mertz[的 Python 文本处理。](http://gnosis.cx/TPiP/)我认为这本书仍然可用，尽管它现在可能有点过时了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T05:59:43.450

有一本书[Text Processing in Python](http://gnosis.cx/TPiP/)。我自己还没有读过，但我读过这个作者的其他文章，总的来说他们是一个很好的员工。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T05:50:40.227

我发现 object.__doc__ 和 dir(obj) 命令在学习语言方面非常有用。

例如

```
a = "test,test,test" 
```

我可以用 a 做什么？目录（一）。看来我可以拆分一个。

```
vec = a.split (",") 
```

什么是vec？vec.__doc__:

“从序列的项目初始化的新列表”

我可以用 vec 做什么？目录（vec）。

```
vec.sort () 
```

ETC ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-01T19:52:11.433

虽然我没有阅读，但[Wes McKinney 的 Python for Data Analysis - 1 版（2012 年 10 月 8 日）](https://rads.stackoverflow.com/amzn/click/com/B009NLMB8Q)看起来很有希望。

# erlang - How to explain Erlang's supervision trees?

> ID：676266
> 
> 赞同：4
> 
> 时间：2009-03-24T05:50:23.567
> 
> 标签：erlang, erlang-otp, erlang-supervisor

I tried to explain supervision trees.

My best try is:

ok, You get a chocolate box from the factory, with warranty, "Every bit will taste good." Then if you find that one bit taste funny. You can throw the whole box away. Because you get a new from the factory. That is like supervision trees in Erlang. If one thread misbehave. There is a risk that all threads have bad state. If that is the case, the supervisor throw all threads away and start over. Like the chocolate box, you are the supervisor when you throw the box.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T13:01:07.633

你有做事的进程——**工作进程**。一种**类型的****工人**可能有很多——都是一样的——但也可能有*许多类型的工人*。

 ***您通过编写工作进程类型并部署它们来构建应用程序。

监督**工作进程**是**监督处理器**——监督**监督进程**是**监督进程**（乌龟一直向上，除了最上面的那个是爸爸！）

所有的上司都是一样的。他们只有两个工作：

1.  留意他们的工人（如果他们开始崩溃，以需要重新启动该类型工人的方式重新启动他们）
2.  如果太多的工人经常崩溃，向他们的主管报告（通过崩溃并让他们的主管以他们需要重新启动的方式重新启动他们）

而已。您从您设计的特殊类型的工作进程构建小型子系统，并将它们组合成大型的多服务器集群，使用与其他所有人*相同的几乎没有错误、经过全面测试的主管*和一些在其上运行的标准工作人员监督树做一些事情，比如将子系统从一台机器移动到另一台机器（这些标准工作人员被编入 OTP 应用程序和 OTP gen_servers 等行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T08:09:03.903

在[我的文章中](https://web.archive.org/web/20100507101922/http://mue.tideland.biz/software-architecture-with-erlangotp-part-7-s)，我是这样描述的：

> 在某些方面，Erlang 就像现实生活：有许多进程在做真正的工作，有些则在监督它们。而且有等级制度。正如我所说，现实生活。****微笑****

本文的其余部分试图深入了解 Erlang 监督树的概念。

缪

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-02T00:40:27.883

针对上面的 Mue，链接已更改。现在正确的地址是：http: [//mue.tideland.biz/software-architecture-with-erlangotp-part-7-s](http://mue.tideland.biz/software-architecture-with-erlangotp-part-7-s)

# django - 如何编写Django视图获取多个只能通过关系访问的Django模型的CharFields

> ID：676267
> 
> 赞同：0
> 
> 时间：2009-03-24T05:50:30.880
> 
> 标签：django, django-models, django-views

请参阅以下 Django 模型：-

```
class Student(models.Model):
    reference_num = models.CharField(max_length=50, unique=True)
    name = models.CharField(max_length=50)
    birthdate = models.DateField(null=True, blank=True)
    is_active = models.BooleanField(db_index=True)

class Examination(models.Model):
    short_name = models.CharField(max_length=20, unique=True)
    name = models.CharField(max_length=50, unique=True)
    is_active = models.BooleanField(db_index=True)

class Subject(models.Model):
    short_name = models.CharField(max_length=20, unique=True)
    name = models.CharField(max_length=50, unique=True)
    is_active = models.BooleanField(db_index=True)

class EducationalQualification(models.Model):
    student = models.ForeignKey(Student)
    examination = models.ForeignKey(Examination)
    subject = models.ForeignKey(Subject, null=True, blank=True)
    institution = models.CharField(max_length=50)
    from_date = models.DateField(null=True, blank=True)
    to_date = models.DateField()
    marks = models.DecimalField(max_digits=5, decimal_places=2) 
```

我需要在网格中显示给定学生的最后一个模型“EducationalQualification”（一个学生可以有多个 EducationalQualifications）。

网格包含“学生姓名”、“考试简称”、“学科简称”、“EducationalQualification.institution”、“EducationalQualification.from_date”、“EducationalQualification.to_date”和“EducationalQualification.marks”列。

我一直无法想出一个 Django 视图来获取这些数据（给定一个 Student.pk）

有人可以帮我一些想法吗？

问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T07:58:23.397

您只需要获取`EducationalQualification`某个学生的所有对象及其所有关系对象：

```
def view_qualifications(request, student_id):
    qs = EducationalQualification.objects.filter(student__pk=student_id).\
                           select_related("student", "examination", "subject")
    # ... 
```

然后在模板中遍历它：

```
{% for q in qs %}
<tr>
   <td>{{q.student.name}}</td>
   <td>{{q.examination.short_name}}</td>
   <td>{{q.subject.short_name}}</td>
   <td>{{q.institution}}</td>
   <td>{{q.from_date}}</td>
   <td>{{q.to_date}}</td>
   <td>{{q.marks}}</td>
</tr>
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T16:16:09.617

`managed = False`创建一个数据库视图和一个在其 Meta 类中指定的模型。

# html - html中的框架集问题

> ID：676269
> 
> 赞同：0
> 
> 时间：2009-03-24T05:50:51.490
> 
> 标签：html, xhtml, dhtml

我创建了一个网站，在同一个文件夹中没有多个页面（我的意思是所有这些页面都在一个文件夹中）。我在框架下开发了这个设计。我使用 3 帧顶部作为横幅，左侧用于菜单，右侧用于主页。单击左侧菜单框架时，我只是将主页导航到不同的页面。

我的问题是在单击菜单时，我只是更改了右侧主框架的目标。导航到正确框架中的不同页面时是否可以更改 URL。

请指导我，如何进行。

谢谢普拉
文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T06:15:12.757

如果不导航到该 URL，您将无法更改该 URL。

你真的不想首先使用框架。搜索引擎（即谷歌）不会正确索引您的网站，用户不能为页面添加书签，而且人们只是不喜欢框架，首先。

如果您想在多个页面中保留诸如标题和侧边栏之类的内容，而不必在每个 HTML 文件中包含代码，您应该考虑使用[服务器端包含](http://httpd.apache.org/docs/1.3/howto/ssi.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T06:10:24.767

这个问题仍然很模糊。如前所述，您可以使用 target 属性来指定在哪个框架中打开链接：

```
<a href="content.html" target="_content_frame">link</a> 
```

您可以使用 HTML 基本目标为所有链接指定默认目标 ( [http://www.w3schools.com/TAGS/tag_base.asp](http://www.w3schools.com/TAGS/tag_base.asp) )：

```
<head>
<base href="http://www.w3schools.com/images/" />
<base target="_blank" />
</head> 
```

我不相信您可以在更改单个框架时更改主页 URL。您最好使用无框布局来完成此操作。一个好处是它更适合搜索索引和用户书签。

# c# - 在 C# 代码中解析（大）XML 的最佳方法是什么？

> ID：676274
> 
> 赞同：62
> 
> 时间：2009-03-24T05:52:42.513
> 
> 标签：c#, xml, xml-serialization, xmlreader

我正在用 C# 编写一个 GIS 客户端工具，以从服务器检索基于 GML 的 XML 模式（下面的示例）中的“特征”。提取限制为 100,000 个特征。

我猜测最大的[extract.xml](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx "XmlSerializer")[可能](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.aspx "XmlReader 类")会*达到*150兆字节左右，所以很明显 DOM 解析器已经[出局](http://msdn.microsoft.com/en-us/library/x6c1kb0s.aspx "XSD.EXE - Visual Studio XML-schema-binder 生成器工具")了

或者也许有更好的方法我还没有考虑过？像 XLINQ，或者 ????

请问有人可以指导我吗？特别是关于任何给定方法的内存效率。如果不是，我将不得不对这两个解决方案进行“原型设计”并并排分析它们。

我在 .NET 中有点像生虾。任何指导将不胜感激。

感谢您。基思。

* * *

**示例 XML** - 最多 100,000 个，每个特征最多 234,600 个坐标。

```
<feature featId="27168306" fType="vegetation" fTypeId="1129" fClass="vegetation" gType="Polygon" ID="0" cLockNr="51598" metadataId="51599" mdFileId="NRM/TIS/VEGETATION/9543_22_v3" dataScale="25000">
  <MultiGeometry>
    <geometryMember>
      <Polygon>
        <outerBoundaryIs>
          <LinearRing>
            <coordinates>153.505004,-27.42196 153.505044,-27.422015 153.503992 .... 172 coordinates omitted to save space ... 153.505004,-27.42196</coordinates>
          </LinearRing>
        </outerBoundaryIs>
      </Polygon>
    </geometryMember>
  </MultiGeometry>
</feature> 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-03-24T05:57:16.123

用于`XmlReader`解析大型 XML 文档。`XmlReader`提供对 XML 数据的快速、只进、非缓存访问。（Forward-only 意味着您可以从头到尾读取 XML 文件，但不能在文件中向后移动。）`XmlReader`使用少量内存，相当于使用简单的 SAX 阅读器。

```
 using (XmlReader myReader = XmlReader.Create(@"c:\data\coords.xml"))
    {
        while (myReader.Read())
        {
           // Process each node (myReader.Value) here
           // ...
        }
    } 
```

您可以使用 XmlReader 处理最大为 2 GB 的文件。

参考：[如何使用 Visual C# 从文件中读取 XML](http://support.microsoft.com/kb/307548)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-14T02:39:04.960

Asat 2009 年 5 月 14 日：我已改用混合方法……请参阅下面的代码。

这个版本具有两者的大部分优点：
  * XmlReader/XmlTextReader（内存效率 --> 速度）；和
  * XmlSerializer（代码生成 --> 开发权宜性和灵活性）。

它使用 XmlTextReader 来遍历文档，并创建“doclet”，它使用 XmlSerializer 和用 XSD.EXE 生成的“XML 绑定”类对其进行反序列化。

我想这个秘诀是普遍适用的，而且速度很快……我在大约 7 秒内解析了一个包含 56,000 个 GML 特征的 201 MB XML 文档……这个应用程序的旧 VB6 实现需要几分钟（甚至几小时）来解析大提取物...所以我看起来很高兴。

再一次，非常**感谢**论坛成员贡献了您宝贵的时间。对此，我真的非常感激。

祝大家欢呼。基思。

```
using System;
using System.Reflection;
using System.Xml;
using System.Xml.Serialization;
using System.IO;
using System.Collections.Generic;

using nrw_rime_extract.utils;
using nrw_rime_extract.xml.generated_bindings;

namespace nrw_rime_extract.xml
{
    internal interface ExtractXmlReader
    {
        rimeType read(string xmlFilename);
    }

    /// <summary>
    /// RimeExtractXml provides bindings to the RIME Extract XML as defined by
    /// $/Release 2.7/Documentation/Technical/SCHEMA and DTDs/nrw-rime-extract.xsd
    /// </summary>
    internal class ExtractXmlReader_XmlSerializerImpl : ExtractXmlReader
    {
        private Log log = Log.getInstance();

        public rimeType read(string xmlFilename)
        {
            log.write(
                string.Format(
                    "DEBUG: ExtractXmlReader_XmlSerializerImpl.read({0})",
                    xmlFilename));
            using (Stream stream = new FileStream(xmlFilename, FileMode.Open))
            {
                return read(stream);
            }
        }

        internal rimeType read(Stream xmlInputStream)
        {
            // create an instance of the XmlSerializer class, 
            // specifying the type of object to be deserialized.
            XmlSerializer serializer = new XmlSerializer(typeof(rimeType));
            serializer.UnknownNode += new XmlNodeEventHandler(handleUnknownNode);
            serializer.UnknownAttribute += 
                new XmlAttributeEventHandler(handleUnknownAttribute);
            // use the Deserialize method to restore the object's state
            // with data from the XML document.
            return (rimeType)serializer.Deserialize(xmlInputStream);
        }

        protected void handleUnknownNode(object sender, XmlNodeEventArgs e)
        {
            log.write(
                string.Format(
                    "XML_ERROR: Unknown Node at line {0} position {1} : {2}\t{3}",
                    e.LineNumber, e.LinePosition, e.Name, e.Text));
        }

        protected void handleUnknownAttribute(object sender, XmlAttributeEventArgs e)
        {
            log.write(
                string.Format(
                    "XML_ERROR: Unknown Attribute at line {0} position {1} : {2}='{3}'",
                    e.LineNumber, e.LinePosition, e.Attr.Name, e.Attr.Value));
        }

    }

    /// <summary>
    /// xtractXmlReader provides bindings to the extract.xml 
    /// returned by the RIME server; as defined by:
    ///   $/Release X/Documentation/Technical/SCHEMA and 
    /// DTDs/nrw-rime-extract.xsd
    /// </summary>
    internal class ExtractXmlReader_XmlTextReaderXmlSerializerHybridImpl :
        ExtractXmlReader
    {
        private Log log = Log.getInstance();

        public rimeType read(string xmlFilename)
        {
            log.write(
                string.Format(
                    "DEBUG: ExtractXmlReader_XmlTextReaderXmlSerializerHybridImpl." +
                    "read({0})",
                    xmlFilename));

            using (XmlReader reader = XmlReader.Create(xmlFilename))
            {
                return read(reader);
            }

        }

        public rimeType read(XmlReader reader)
        {
            rimeType result = new rimeType();
            // a deserializer for featureClass, feature, etc, "doclets"
            Dictionary<Type, XmlSerializer> serializers = 
                new Dictionary<Type, XmlSerializer>();
            serializers.Add(typeof(featureClassType), 
                newSerializer(typeof(featureClassType)));
            serializers.Add(typeof(featureType), 
                newSerializer(typeof(featureType)));

            List<featureClassType> featureClasses = new List<featureClassType>();
            List<featureType> features = new List<featureType>();
            while (!reader.EOF)
            {
                if (reader.MoveToContent() != XmlNodeType.Element)
                {
                    reader.Read(); // skip non-element-nodes and unknown-elements.
                    continue;
                }

                // skip junk nodes.
                if (reader.Name.Equals("featureClass"))
                {
                    using (
                        StringReader elementReader =
                            new StringReader(reader.ReadOuterXml()))
                    {
                        XmlSerializer deserializer =
                            serializers[typeof (featureClassType)];
                        featureClasses.Add(
                            (featureClassType)
                            deserializer.Deserialize(elementReader));
                    }
                    continue;
                    // ReadOuterXml advances the reader, so don't read again.
                }

                if (reader.Name.Equals("feature"))
                {
                    using (
                        StringReader elementReader =
                            new StringReader(reader.ReadOuterXml()))
                    {
                        XmlSerializer deserializer =
                            serializers[typeof (featureType)];
                        features.Add(
                            (featureType)
                            deserializer.Deserialize(elementReader));
                    }
                    continue;
                    // ReadOuterXml advances the reader, so don't read again.
                }

                log.write(
                    "WARNING: unknown element '" + reader.Name +
                    "' was skipped during parsing.");
                reader.Read(); // skip non-element-nodes and unknown-elements.
            }
            result.featureClasses = featureClasses.ToArray();
            result.features = features.ToArray();
            return result;
        }

        private XmlSerializer newSerializer(Type elementType)
        {
            XmlSerializer serializer = new XmlSerializer(elementType);
            serializer.UnknownNode += new XmlNodeEventHandler(handleUnknownNode);
            serializer.UnknownAttribute += 
                new XmlAttributeEventHandler(handleUnknownAttribute);
            return serializer;
        }

        protected void handleUnknownNode(object sender, XmlNodeEventArgs e)
        {
            log.write(
                string.Format(
                    "XML_ERROR: Unknown Node at line {0} position {1} : {2}\t{3}",
                    e.LineNumber, e.LinePosition, e.Name, e.Text));
        }

        protected void handleUnknownAttribute(object sender, XmlAttributeEventArgs e)
        {
            log.write(
                string.Format(
                    "XML_ERROR: Unknown Attribute at line {0} position {1} : {2}='{3}'",
                    e.LineNumber, e.LinePosition, e.Attr.Name, e.Attr.Value));
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-24T07:23:48.550

总结一下，让在谷歌找到这个帖子的人更清楚答案。

在 .NET 2 之前，XmlTextReader 是标准 API 中可用的内存效率最高的 XML 解析器（thanx Mitch;-)

.NET 2 引入了 XmlReader 类，它再次变得更好。它是一个只进的元素迭代器（有点像 StAX 解析器）。（感谢 Cerebrus；-）

记住小子，任何 XML 实例都有可能大于 500k，不要使用 DOM！

祝大家欢呼。基思。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-24T06:00:17.877

[SAX](http://en.wikipedia.org/wiki/Simple_API_for_XML)解析器可能是您正在寻找的。SAX 不需要您将整个文档读入内存——它会逐步解析它并允许您随时处理元素。我不知道 .NET 中是否提供了 SAX 解析器，但您可以查看一些开源选项：

*   [http://saxdotnet.sourceforge.net/](http://saxdotnet.sourceforge.net/)
*   [http://www.codeguru.com/csharp/csharp/cs_data/xml/article.php/c4221](http://www.codeguru.com/csharp/csharp/cs_data/xml/article.php/c4221)

这是一个相关的帖子：

*   [SAX 与 XmlTextReader - C# 中的 SAX](https://stackoverflow.com/questions/127869/sax-vs-xmltextreader-sax-in-c)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-27T10:59:40.387

只是想添加这个简单的扩展方法作为使用 XmlReader 的示例（正如 Mitch 回答的那样）：

```
public static bool SkipToElement (this XmlReader xmlReader, string elementName)
{
    if (!xmlReader.Read ())
        return false;

    while (!xmlReader.EOF)
    {
        if (xmlReader.NodeType == XmlNodeType.Element && xmlReader.Name == elementName)
            return true;

        xmlReader.Skip ();
    }

    return false;
} 
```

和用法：

```
using (var xml_reader = XmlReader.Create (this.source.Url))
{
    if (!SkipToElement (xml_reader, "Root"))
        throw new InvalidOperationException ("XML element \"Root\" was not found.");

    if (!SkipToElement (xml_reader, "Users"))
        throw new InvalidOperationException ("XML element \"Root/Users\" was not found.");

    ...
} 
```

# asp.net - 处理 javascript 和 css 文件的最佳实践是什么

> ID：676278
> 
> 赞同：5
> 
> 时间：2009-03-24T05:56:40.600
> 
> 标签：asp.net, javascript, css

您如何管理ASP.NET 项目中的所有 Your`.js`和文件？`.css`尤其是当他们彼此之间有很多依赖关系时？

我将所有脚本合二为一。但它变得很重要，其中 90% 没有在特定页面上使用。我想要的是管理所有这些脚本的工具或指南，简单的依赖管理，有助于在页面上仅包含该页面所需的那些 JS 和 CSS。

当您使用大量控件时，还使用了 ScriptManager 螺母，它非常方便......也许我以错误的方式使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T06:18:42.577

在我们的项目中，我们将脚本和 CSS 标记为类的资源，然后在页面生命周期中注册它们，通常在 PreRender() 中。

例如：

```
// Css
[assembly: WebResource("Assembly.Class.MyClass.css", "text/css")]
// Javascript
[assembly: WebResource("Assembly.Class.MyClass.js", "text/javascript")]
namespace OurNamespace
{
   public class MyClass... 
```

然后，我们将每个脚本和 css 文件的属性设置为嵌入式资源。

这种方法使您可以将脚本分开并针对各个 UI 组件。您可以将相同的资源注册到多个类，然后 ScriptManager 将负责确保正确的资源显示在页面上。

然后，我们在 HTTP 处理程序级别编写了一个类，用于处理将所有 CSS 资源在流式传输之前压缩到一个文件中，以确保我们没有达到 IE6 的 32 个 CSS 文件限制。它还从我们的脚本中去除空格、注释等，以优化 javascript 输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T07:26:04.350

这就是我通常的做法：

CSS：最初是 5 个文件。reset.css（来自 YUI）、structure.css、general.css（边框、背景、z-index 等）、typography.css 和 base.css 用于导入其他 4 个 css 文件。

Javascript：我所做的是将 ASP.NET 思想背后的代码应用到我的 JS 文件中命名。示例：home.aspx 的页面特定 JS 文件称为 home.aspx.js。然后，我将拥有基于插件或功能的单独 JS 文件，可能还有一个包含所有全局变量的 common.js。

这可能不是每个人的一杯茶，但我希望能给你一些想法！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T06:34:48.077

我更喜欢根据功能划分我的 JS 文件 - 例如，我可以为所有基于 AJAX 的交互创建一个 JS 文件，一个用于所有验证，一个用于整个 Web 应用程序通用的所有函数的通用 JS 库。拥有一个将整个 JS 脚本组合成一个文件的文件肯定会减慢应用程序的速度，因为每个页面都会加载整个文件，即使只有一小部分可能是相关的。

对于 CSS 文件，我更喜欢有一个通用样式表，其中包含整个应用程序可用的通用样式。我还可以为具有非常特定布局结构的页面创建单独的 CSS 文件。

我不知道有什么工具可以自动处理这种依赖关系，但是当你根据功能划分文件时，在大多数情况下这变得不必要了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T07:53:38.357

我按功能划分 JS 文件。

几乎无处不在的最常用功能都放在一个文件中，

其他类和方法转到它们自己的文件。

对于 CSS，我有一个用于整个站点的通用文件。

如果我的部分在视觉上与其他部分不同，我会将 CSS 文件分隔到每个部分。另外，我有一个选项卡式`div`控件，它有一个单独的 CSS 文件。我不混合文件。

对于组件来说，嵌入资源看起来不错，但有时只部署 JS 文件来修复 bug 也不错。

# c# - 为单元测试生成随机值 Hast 表数据类型

> ID：676282
> 
> 赞同：2
> 
> 时间：2009-03-24T05:57:54.483
> 
> 标签：c#, unit-testing, nunit, hashtable, random

我的项目通过获取最小值和最大值为每种数据类型生成几个值（相等的分区方法）。我正在为功能测试生成值，我实际上是将这些值传递给 nunit 合作伙伴，max amd min 适用于 int、float、double 等，这些值是测试数据。

最初我为 int、float、double、string 等基本数据类型生成。

现在我需要支持 DataSet、HashTable 和其他 Collections 等数据类型。

```
public DataSet MySampleMethod(int param1, string param2, Hashtable ht) 
```

为了测试这个函数，我可以传递 int 和 string 的值，但是我将如何传递 ht 的测试数据或如何为哈希表生成测试数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T07:57:10.873

首先 - 我总是为单元测试播种我的随机值，以便它们是可重复的 - 但是，类似（使用`Dictionary<,>`而不是`HashTable`，但等效）：

```
 Random rand = new Random(123456); // note seed
        Dictionary<int, double> lookup = new Dictionary<int, double>();
        for (int i = 0; i < 5000; i++)
        {
            lookup[rand.Next(100000)] = rand.NextDouble();
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T07:51:47.157

您根本不应该使用随机数据进行单元测试。测试可能会随机通过或失败，具体取决于所选数据，当您尝试找出失败的原因时，您可能很难调试代码，因为您无法以可预测的方式重复失败。

# c# - 接口中的通用列表

> ID：676288
> 
> 赞同：3
> 
> 时间：2009-03-24T06:00:50.247
> 
> 标签：c#, linq, generics, generic-list

我正在尝试实现一个包含对象列表的接口类。如何使列表通用，以便实现类定义列表的类型：

```
public interface IEntity
{
    Guid EntityID { get; set; }
    Guid ParentEntityID{ get; set; }
    Guid RoleId { get; set; }

    void SetFromEntity();
    void Save();
    bool Validate();
    IQueryable<T> GetAll(); // That is what I would like to do
    List<Guid> Search(string searchQuery);
}
public class Dealer : IEntity
{
   public IQueryable<Dealer> GetAll() { }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-24T06:05:18.490

你可以这样做：

```
public interface IEntity<T>
{
    IQueryable<T> GetAll();
}

public class Dealer : IEntity<Dealer>
{
   public IQueryable<Dealer> GetAll() { }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T06:05:01.657

您只需要使 IEntity 本身成为通用的。然后，使用 GetAll() 定义中的类型参数。

以下是您更改代码的方法：

```
public interface IEntity<TListItemType>
{
     // stuff snipped

     IQueryable<TListItemType> GetAll();
}

public class Dealer : IEntity<Dealer>
{
   public IQueryable<Dealer> GetAll() { // some impl here }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T06:52:06.100

将`Save()`,`Validate()`等逻辑添加到您的域对象（我猜这就是 a `Dealer`）并不是世界上最好的主意，因为它违反了[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

# linq - 我如何在这个 Linq 查询中得到 Sum？

> ID：676290
> 
> 赞同：2
> 
> 时间：2009-03-24T06:02:01.290
> 
> 标签：linq, sum

我有一张有零到多个孩子的桌子。就像这个网站有一个`QUESTION`可以有零到多个`VOTES`（向上 == 1 或向下 == 0）的方式。

我需要得到*所有投票最多的问题*。例如。所有问题，按 Sum(Vote) 降序排列。

我不确定如何在 linq 中执行此操作。

所以我会有一个名为 Questions 的 EntitySet 和另一个名为 Votes 的 EntitySet。

我试图做 group by 和 let 和 order by 并且没有编译:(

请问有人有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T14:50:57.947

```
myDataContext.Questions
  .OrderByDescending(q => q.Votes.Select(v => v.VoteValue).Sum()) 
```

在查询理解中（未选中）：

```
from q in myDataContext.Questions
order q by 
(
  from v in q.Votes
  select v.VoteValue
).Sum() descending
select q; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T07:22:53.157

这主要取决于您的数据，但这里有一个小样本：

```
XElement xdoc=XElement.Parse(@"
  <root>
    <question name=""A"">
      <vote type=""up"" />
      <vote type=""down"" />
    </question>
    <question name=""B"">
      <vote type=""up"" />
      <vote type=""up"" />
    </question>
    <question name=""C"" />
  </root>
  ");

var result=
  from q in xdoc.Elements("question")
  let votes=q.Elements("vote").Count(v=>v.Attribute("type").Value=="up")
  orderby votes descending
  select new
  {
    Name=q.Attribute("name").Value,
    Votes=votes
  };

foreach (var r in result)
{
  Console.WriteLine(r.Name+" "+r.Votes);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T14:47:04.820

由于您使用的是EntitySet，我认为它是Linq2SQL？假设您已正确设置参考并具有 Vote.Question 属性：

```
(from v in dc.Votes
where v.IsUpVote // v.Vote == 1 (??)
group v by v.Question into q
select new { Question = q.Key, UpVotes = q.Count() }).OrderByDescending(e => e.UpVotes); 
```

我在这里收集 Count() 实际上是您想要的吗？Sum() 会产生相同的结果，但可能没有意义l(?)

# c# - 我可以在 Vista 上使用 C#.NET 开发 iPhone 应用程序吗？

> ID：676291
> 
> 赞同：21
> 
> 时间：2009-03-24T06:03:40.850
> 
> 标签：c#, iphone, mobile

我有兴趣在 Windows Vista 上使用 Visual Studio 和 C#.NET 开发 iPhone 应用程序。

我尝试从[http://developer.apple.com/iphone/index.action](http://developer.apple.com/iphone/index.action)下载 SDK ，但该文件有`.dmg`扩展名，我不知道如何打开该文件。

那么，作为 .NET 开发人员，我可以针对 iPhone API 工作和开发吗？有没有使用 .NET 开发的现有应用程序？是否有任何资源或网站可以在这方面提供帮助？

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-24T06:33:33.883

一句话，没有。iPhone 支持 Mono，但目前受到限制。他们过去曾讨论过编写 Silverlight 应用程序的可能性，该应用程序具有一系列“iPhone 风格”控件，可以静态链接为 iPhone 应用程序，但这还有一段路要走。

如果您对游戏感兴趣，并且财力雄厚，那么[UNITY](http://unity3d.com/unity/features/iphone-publishing)是一个基于 Mono 的游戏开发平台，支持 iPhone（并在 Windows 上运行）

做不到这一点，咬紧牙关，从 eBay 购买便宜的 Mac。SDK 官方只支持英特尔 Mac，但您可以将其安装在 PPC 上，我还没有遇到问题（我目前在 G5 PowerMac 上运行它）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-09-15T22:06:29.047

**2013 年 7 月 18 日更新：**

由于这个答案已有 3 年历史，我想用当前信息对其进行更新。MonoTouch 已不复存在，因为它现在是[Xamarin](http://www.xamarin.com)的一部分。有了它，您可以使用 C# 和部分 .NET Framework（使用 Mono）开发移动应用程序。[您可以使用 Windows 和 Visual Studio 开发 iOS 应用程序](https://store.xamarin.com/)，但您仍然需要 Mac 来编译和构建。[这](http://blog.xamarin.com/introduction-to-building-xamarin.ios-applications-in-visual-studio/?mkt_tok=3RkMMJWWfF9wsRonv6TNZKXonjHpfsXw6OgkT/rn28M3109ad%2brmPBy%2b3oUJWp8na%2bqWCgseOrQ8mVsNV8q6RM0XrKw=)是一篇关于如何使用 VS 进行 iOS 开发的博客文章。

**原始答案**

[单触](http://monotouch.net/)。你仍然需要一台 mac 和至少 400 美元（在撰写本文时）

您可以尝试无需付费并允许您使用模拟器进行编程的 eval 版本。如果你想在硬件上测试你的应用程序，那么你需要把钱放在口袋里。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T06:05:55.773

你不能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-02-04T02:38:30.803

是的。单触效果很好

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-27T13:02:28.577

目前对这个问题的回答是肯定的，Novell 的 MonoTouch 在 Mac 计算机上使用 MonoDevelop，但请记住，Novell 解雇了 Mono/MonoTouch 人员，他们现在正在建立一家初创公司，用名为 Xamarin 的新产品将于今年夏天发布。

**2013 年 1 月**

Xamarin 不久前推出了 MonoTouch 和 Mono for Android，这两款产品都是很棒的产品，虽然对发烧友来说有点贵。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-24T06:21:44.847

这个[类似的问题询问是否可以在 Windows 上进行 iPhone 开发](https://stackoverflow.com/questions/113547/iphone-development-on-windows)。

答案似乎是：仅适用于[越狱](http://en.wikipedia.org/wiki/Jailbreak_(iPhone))的iPhone。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-24T06:34:35.627

可以使用 [Unity](http://unity3d.com/unity/features/iphone-publishing)在 C# 中为 iPhone 开发。[如此处所述，](http://tirania.org/blog/archive/2008/Nov-05.html)它执行提前编译。然而，Unity 似乎更倾向于开发游戏，而 iPhone SDK 目前需要 Mac OSX。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-24T06:44:26.523

你不能。

.dmg 扩展名代表“磁盘映像”，用于 Mac OS X 中的安装文件。Windows Vista 无法识别该格式，因此您无法打开它。

此外，您不会获得在 .NET 框架中开发 iPhone 应用程序所需的库/SDK。您必须下载最新版本的 iPhone SDK，它带有一个 iPhone 模拟器，以便在开发机器上进行测试。用于 iPhone 开发的主要框架是 UIKit。

开始学习 iPhone 开发的最佳地点在[这里](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/ApplicationEnvironment.html#//apple_ref/doc/uid/TP40007072-CH7-SW1)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-24T06:06:27.177

遗憾的是，不，您不能使用 C#/.NET 开发标准 iPhone 应用程序。

但是，我已经看到了在 iPhone 上运行的单声道屏幕截图，所以，也许有一天……虽然，它可能不会处于合法设置中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-24T06:07:08.080

iPhone 不支持 .NET。我不相信在 iPhone 上运行 .NET 应用程序有任何兼容性黑客或类似的东西，所以你可能不得不硬着头皮学习 Objective-C。

我会在谷歌上搜索“iPhone 开发教程”。可能会有一点学习曲线。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-11-02T13:00:56.977

或者你可以在你的电脑上运行 mac os [http://oreilly.com/windows/archive/PearPC.html](http://oreilly.com/windows/archive/PearPC.html) 看看

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-10-08T20:18:12.083

MonoTouch 在 Mac 上运行。对于 windows，您可以查看 DragonFireSDK。目前用于游戏开发，它允许使用 C++ .Net 在 Visual Studio 2010 中开发 iPhone 应用程序。

[http://www.dragonfiresdk.com](http://www.dragonfiresdk.com)

# asp.net - asp.net web.config 加密

> ID：676292
> 
> 赞同：2
> 
> 时间：2009-03-24T06:03:48.243
> 
> 标签：asp.net

为什么在部署之前加密 web.config 中的敏感数据被认为是正确的做法？如果网站托管在现场，不加密这些数据怎么会有风险？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T06:14:37.343

当然，在大多数情况下，黑客很难访问您的 web.config 文件，因为 asp.net 对它的处理方式不同，并且不允许直接读取它。

***但是***，有很多原因需要您为面向公众的 Web 服务器加密 web.config。

我能想到的两个原因：

**1)**黑客总是有可能以某种方式设法读取您的 web.config。如果黑客设法破坏了您的 Web 服务器，那么加密您的 web.config 至少会减慢速度，如果不能阻止黑客访问您的数据库的话。

在许多托管环境中，数据库将驻留在完全不同的物理机器上。此外，黑客往往会发现数据库比网站更有用，因为它可能包含敏感信息，如信用卡号、地址、出生日期、密码……等。

**2）**另一个原因，如果您有多个人对您的 Web 服务器/服务器场进行维护，并且您不希望某些人能够访问您的数据库，但您仍然希望他们能够访问您的 Web 服务器以便他们可以进行维护任务。这样他们就不会在 web.config 中以纯文本形式看到数据库的登录凭据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T07:02:41.147

our web.config contains information like connection strings and server user id and passwords.

We encrypt the config file to prevent such data.

You can get the details for enrypting here :

[http://msdn2.microsoft.com/en-us/library/ms998283.aspx](http://msdn2.microsoft.com/en-us/library/ms998283.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T06:12:26.587

我相信如果有人不小心禁用了 ASP.Net 用户可以访问 .config 文件。

我已经看到它发生在 PHP 包含中。有人弄乱了 apache 设置，突然所有 php 源代码都可见，包括连接字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T06:15:20.197

风险取决于您保存在数据库中的数据的价值，以及如果该数据可能被泄露或删除会发生什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T06:29:57.683

在“古老”的 ASP 时代，发现了一个漏洞，当您将 ::$DATA 附加到 URL 时，您可以查看 ASP 页面的源代码。

在 ASP.NET 1.0 中，可以使用特制 URL 绕过表单身份验证。

加密 web.config 的敏感部分是*纵深防御*策略的一部分。您不知道 ASP.NET 中未发现的问题是否会绕过它对配置文件的保护并突然将文件公开给全世界。通过不加密，您仅依靠 ASP.NET 不提供配置文件，单层防御可能在某些时候被破坏。

作为额外的奖励，您可以保护自己免于做一些愚蠢的事情，例如将您的 web.config 备份到 web.config.bak - 这将不再受到下载保护，并且是一些安全工具在扫描网站时检查的文件名。

# c# - 如何从 javascript 源代码中标记/解析字符串文字

> ID：676296
> 
> 赞同：2
> 
> 时间：2009-03-24T06:05:27.430
> 
> 标签：c#, javascript, parsing

我正在使用 C# 编写一个程序，该程序需要加载一些 JavaScript 代码，对其进行解析并对代码中的*字符串文字*进行一些处理（例如用其他内容覆盖它们）。

我的问题是，我很难首先设计一种优雅的方式来实际在 JavaScript 代码中找到字符串文字。

例如，看看下面的示例 JavaScript 代码。您是否看到甚至 Stack Overflow 的代码荧光笔也能够在代码中挑选出字符串文字并将它们变成红色？

我想基本上做同样的事情，除了我不会把它们变成不同的颜色，但我会对它们做一些处理，并可能用完全不同的字符串文字替换它。

```
var dp = {
    sh :                    // dp.sh
    {
        Utils   : {},       // dp.sh.Utils
        Brushes : {},       // dp.sh.Brushes
        Strings : {},
        Version : '1.3.0'
    }
};

dp.sh.Strings = {
    AboutDialog : '<html><head><title>About...</title></head><body class="dp-about"><table cellspacing="0"><tr><td class="copy"><p class="title">dp.SyntaxHighlighter</div><div class="para">Version: {V}</p><p><a href="http://www.dreamprojections.com/syntaxhighlighter/?ref=about" target="_blank">http://www.dreamprojections.com/SyntaxHighlighter</a></p>&copy;2004-2005 Alex Gorbatchev. All right reserved.</td></tr><tr><td class="footer"><input type="button" class="close" value="OK" onClick="window.close()"/></td></tr></table></body></html>',

    // tools
    ExpandCode : '+ expand code',
    ViewPlain : 'view plain',
    Print : 'print',
    CopyToClipboard : 'copy to clipboard',
    About : '?',

    CopiedToClipboard : 'The code is in your clipboard now.'
};

dp.test1 = 'some test blah blah blah' +  someFunction()  + 'asdfasdfsdf';
dp.test2 = 'some test blah blah blah' +  'xxxxx'  + 'asdfasdfsdf';
dp.test3 = 'some test blah blah blah' +  "XXXXsdf "" \" \' ' sdfdff "" \" \' ' asdfASDaSD FASDF SDF'  + 'asdfasdfsdf";

dp.SyntaxHighlighter = dp.sh; 
```

我尝试通过查找引号进行解析，但是当字符串文字中有转义字符时它会变得复杂。我正在考虑的另一个解决方案是使用正则表达式，但我对正则表达式不够强大，我什至不确定这是否是我应该细读的途径。

我想看看 Stack Overflow 是怎么想的。非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T06:26:56.160

[**Regexs in Depth: Advanced Quoted String Matching**](http://blog.stevenlevithan.com/archives/match-quoted-string)有一些很好的例子来说明如何使用正则表达式来做到这一点。

其中一种方法是：

```
(["'])(?:(?!\1)[^\\]|\\.)*\1

```

您可以按如下方式使用它：

```
string modifiedJavascriptText =
   Regex.Replace
   (
      javascriptText, 
      @"([""'])(?:(?!\1)[^\\]|\\.)*\1", // Note the escaped quote
      new MatchEvaluator
      (
         delegate(Match m) 
         { 
            return m.Value.ToUpper(); 
         }
      )
   ); 
```

在这种情况下，所有的字符串文字都是大写的。

# console - 如何将控制台与 Java 应用程序关联？

> ID：676301
> 
> 赞同：0
> 
> 时间：2009-03-24T06:08:18.217
> 
> 标签：console, java

自从我学习 Java 以来，我已经能够创建 GUI 程序。然而，即使是简单的“Hello World！” 如果需要控制台，程序将无法运行。我对该主题的研究使我得出结论，即我的 Java 运行时环境没有与之关联的控制台。

是否可以像在 C# 中那样以某种方式调用 Win32“AllocConsole”方法？

编辑：

我的意思是您所描述的控制台，就像 C# 程序可以拥有的控制台。我忘了提到我正在使用 Eclipse IDE。根据我的发现，Eclipse 使用“javaw.exe”而不是“java.exe”运行程序，这导致程序没有控制台。此外，Windows“命令提示符”是一个使用我指的控制台类型的程序。

感谢您的任何回答。

Euphoria83 在我想要做的事情上走在了正确的轨道上。顺便说一句，他的方法有效，但我希望控制台在我单击我创建的程序的“.jar”文件时自动出现。基本上，我需要控制台在运行时像在 C# 中那样运行。此外，Eclipse 确实有一个控制台窗口（我认为他们将其称为控制台透视图，但我习惯使用 Visual Studio，所以我不太确定），它将**仅在 Eclipse**中显示程序输出。我希望控制台在运行时工作，而不仅仅是在集成开发环境中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T09:17:40.337

将“java.exe”与 .jar 扩展名关联（默认情况下它将是“javaw.exe”，它没有控制台），在这种情况下，您将获得每个 jar 的控制台，或者创建一个快捷方式/.exe以您选择的语言/批处理脚本在您单击它时运行“java -jar myjar.jar”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T06:20:00.843

控制台到底是什么意思？

键入常规

```
System.out.println("Hello world!"); 
```

在一个简单的 Java 程序上并从命令行运行它应该会给你想要的结果。除非您对控制台的定义不同，否则您需要更好地解释自己。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T06:44:06.867

正如 Yuval 所说， System.out.println("...") 将您的文本打印到控制台窗口。

稍微解释一下，System.out 是由 System 类自动提供的“标准”输出流（您可能从 C 或 C++ 中知道类似的东西）。

您可以创建自己的输出流（有几种不同类型的输出流类，例如写入文件或字符串）并使用它们的 print() 和 println() 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T06:58:06.850

您在执行代码时是否收到错误消息，或者即使您的代码成功执行，您也只是无法看到结果？

看来您正在使用 IDE。输出可能被定向到尚不可见的控制台窗口。您必须通过从菜单中选择使其可见。

试试这个：

将以下内容保存在名为“Test.java”的文本文件中

```
public class Test {
     public static void main(String[] args) {
          System.out.println("This is a print from my code") ;
     }
} 
```

然后通过在运行提示符下键入“cmd”打开控制台（您可以在“开始”菜单中选择）。转到存储 Test.java 的文件夹并键入它。

```
> javac Test.java 
```

其次是

```
> java Test 
```

如果您看到*正在打印“This is a print from my code”*，那么您的代码正在向控制台输出输出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T10:52:28.160

您可以在*C:\Documents and Settings\User\SendTo*目录中创建一个批处理文件*jarconsole.bat* ，而不是使用文件关联（这是更改默认值的一种方法） ：

 *```
@ECHO OFF
java -jar %1
PAUSE 
```

然后，您可以通过右键单击并选择*Send To > jarconsole.bat*来启动 jar 。

另请参阅有关使用 Eclipse 中的某些控制台功能的[问题。](https://stackoverflow.com/questions/104254/java-io-console-support-in-eclipse-ide)

# html - 显示框架网址

> ID：676306
> 
> 赞同：0
> 
> 时间：2009-03-24T06:10:49.553
> 
> 标签：html

我正在开发一个项目，设置如下，

它包含一个包含两列的框架：
--> 第一列 ( `Col1`) 具有主菜单（例如`CEO`、`HR`、`Staff`、`Clerk`...）
--> 下一列 ( `Col2`) 具有相应的内容。

现在，当我单击 时`"CEO"`，相应`Col2`的页面按原样加载，但页面的 URL 保持不变。

可以更改网址吗？
即从说 ( `C:\\web\Masterpage.html`) 到 ( `C:\\web\CEO.html`)

请帮我找到解决方案..提前谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-02-15T09:37:28.227

我认为您不能仅仅因为“iframe”正在更改而更改加载页面的 URL。

但是您可以添加页内跳转链接或永久链接，这会将主 URL
从 say更改`C:\\web\Masterpage.html`为`C:\\web\Masterpage.html#CEO`or`C:\\web\Masterpage.html#HR`

`<div id="CEO" class="heading">CEO</div>`您可以通过在标签之前添加跳转链接`<iframe>`，然后将`href`菜单的位置更改为`href="#CEO"`，`href="#HR"`依此类推...

运行下面的代码片段，当您将鼠标悬停在链接上时，您会看到锚点以 等结尾`#CEO`。`#HR`浏览器地址栏中显示的地址将是相同的。

```
var winLoc = window.location.href;

function writeFrame(y, p) {
  var Loc = winLoc + "#" + p;
  var y = document.getElementById(y).contentWindow.document;
  y.open();
  y.write("Content for " + p + " Goes here<br><br>The full URL of this page is:<br>" + Loc);
  y.close();
}

writeFrame("CEOframe", "CEO");
writeFrame("HRframe", "HR");
writeFrame("Staffframe", "Staff");
writeFrame("Clerkframe", "Clerk");
```

```
body {
  display: grid;
  grid-template-columns: 20% 80%;
  grid-template-rows: 100%;
  height: 100vh;
  margin: 0;
  padding: 0;
  justify-content: center;
  font-family: monospace;
}

ul {
  padding: 0 10%;
}

li {
  font-size: 1.5em;
  padding: 0.3em 0;
  list-style-type: none;
}

.mainContent {
  height: 100vh;
  overflow-y: hidden;
  padding: 0;
  margin: 0;
  background: royalblue;
}

.heading {
  font-size: 2em;
  padding-left: 0.5em;
  color: white;
}

iframe {
  width: 98%;
  height: calc(100vh - 3em);
  margin: 0;
  padding: 0;
  background: white;
}
```

```
<div class="mainMenu">
  <ul>
    <li><a href="#CEO">CEO</a></li>
    <li><a href="#HR">HR</a></li>
    <li><a href="#Staff">Staff</a></li>
    <li><a href="#Clerk">Clerk</a></li>
  </ul>
</div>
<div class="mainContent">
  <div id="CEO" class="heading">CEO</div>
  <iframe id="CEOframe"></iframe>
  <div id="HR" class="heading">HR</div>
  <iframe id="HRframe"></iframe>
  <div id="Staff" class="heading">Staff</div>
  <iframe id="Staffframe"></iframe>
  <div id="Clerk" class="heading">Clerk</div>
  <iframe id="Clerkframe"></iframe>
</div>
```

我希望这有帮助。

和平

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T07:43:37.647

显示的 URL 是 URL 或页面，对此您无能为力。更改 URL 的唯一方法是显示不同的页面。

我的建议是制作没有框架集的页面。框架集通常比它的价值更麻烦。

# c# - 在 C# 中修改 .resx 文件

> ID：676312
> 
> 赞同：25
> 
> 时间：2009-03-24T06:15:40.947
> 
> 标签：c#, resx

我有一个`.resx`包含名称-值对（两个字符串）的文件。现在我想使用 C# 以编程方式修改某些名称-值对中的值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-24T06:22:53.957

资源管理有一个完整的命名空间：System.Resources。查看 ResourceManager 类以及 ResXResourceReader 和 ResXResourceWriter。

[http://msdn.microsoft.com/en-us/library/system.resources.aspx](http://msdn.microsoft.com/en-us/library/system.resources.aspx)

* * *

我设法掌握了一种非常古老的调试方法，我曾经在测试一些与资源相关的东西时使用过这种方法。这应该为您解决问题。

```
public static void UpdateResourceFile(Hashtable data, String path)
    {
        Hashtable resourceEntries = new Hashtable();

        //Get existing resources
        ResXResourceReader reader = new ResXResourceReader(path);
        if (reader != null)
        {
            IDictionaryEnumerator id = reader.GetEnumerator();
            foreach (DictionaryEntry d in reader)
            {
                if (d.Value == null)
                    resourceEntries.Add(d.Key.ToString(), "");
                else
                    resourceEntries.Add(d.Key.ToString(), d.Value.ToString());
            }
            reader.Close();
        }

        //Modify resources here...
        foreach (String key in data.Keys)
        {
            if (!resourceEntries.ContainsKey(key))
            {

                String value = data[key].ToString();
                if (value == null) value = "";

                resourceEntries.Add(key, value);
            }
        }

        //Write the combined resource file
            ResXResourceWriter resourceWriter = new ResXResourceWriter(path);

            foreach (String key in resourceEntries.Keys)
            {
                resourceWriter.AddResource(key, resourceEntries[key]);
            }
            resourceWriter.Generate();
            resourceWriter.Close();

    } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-08-15T09:58:19.277

```
 public static void AddOrUpdateResource(string key, string value)
    {
        var resx = new List<DictionaryEntry>();
        using (var reader = new ResXResourceReader(resourceFilepath))
        {
            resx = reader.Cast<DictionaryEntry>().ToList();
            var existingResource = resx.Where(r => r.Key.ToString() == key).FirstOrDefault();
            if (existingResource.Key == null && existingResource.Value == null) // NEW!
            {
                resx.Add(new DictionaryEntry() { Key = key, Value = value });
            }
            else // MODIFIED RESOURCE!
            {
                var modifiedResx = new DictionaryEntry() 
                    { Key = existingResource.Key, Value = value };
                resx.Remove(existingResource);  // REMOVING RESOURCE!
                resx.Add(modifiedResx);  // AND THEN ADDING RESOURCE!
            }
        }
        using (var writer = new ResXResourceWriter(ResxPathEn))
        {
            resx.ForEach(r =>
                        {
                            // Again Adding all resource to generate with final items
                            writer.AddResource(r.Key.ToString(), r.Value.ToString());
                        });
            writer.Generate();
        }
    } 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-03-29T05:07:15.530

如果您想保留资源文件中的现有注释，请使用此（基于 SirMoreno 修改的代码）

```
 public static void UpdateResourceFile(Hashtable data, String path)
    {
        Hashtable resourceEntries = new Hashtable();

        //Get existing resources
        ResXResourceReader reader = new ResXResourceReader(path);
        reader.UseResXDataNodes = true;
        ResXResourceWriter resourceWriter = new ResXResourceWriter(path);
        System.ComponentModel.Design.ITypeResolutionService typeres = null;
        if (reader != null)
        {
            IDictionaryEnumerator id = reader.GetEnumerator();
            foreach (DictionaryEntry d in reader)
            {
                //Read from file:
                string val = "";
                if (d.Value == null)
                    resourceEntries.Add(d.Key.ToString(), "");
                else
                {
                    val = ((ResXDataNode)d.Value).GetValue(typeres).ToString();
                    resourceEntries.Add(d.Key.ToString(), val);

                }

                //Write (with read to keep xml file order)
                ResXDataNode dataNode = (ResXDataNode)d.Value;

                //resourceWriter.AddResource(d.Key.ToString(), val);
                resourceWriter.AddResource(dataNode);

            }
            reader.Close();
        }

        //Add new data (at the end of the file):
        Hashtable newRes = new Hashtable();
        foreach (String key in data.Keys)
        {
            if (!resourceEntries.ContainsKey(key))
            {

                String value = data[key].ToString();
                if (value == null) value = "";

                resourceWriter.AddResource(key, value);
            }
        }

        //Write to file
        resourceWriter.Generate();
        resourceWriter.Close();

    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-25T14:09:04.070

Womp 做对了 (10x)。

但这里有一个保持 XML 文件顺序的代码，在文件末尾添加新的。（用于源代码控制）

```
 //Need dll System.Windows.Forms
    public static void UpdateResourceFile(Hashtable data, String path)
    {
        Hashtable resourceEntries = new Hashtable();

        //Get existing resources
        ResXResourceReader reader = new ResXResourceReader(path);
        ResXResourceWriter resourceWriter = new ResXResourceWriter(path);

        if (reader != null)
        {
            IDictionaryEnumerator id = reader.GetEnumerator();
            foreach (DictionaryEntry d in reader)
            {
                //Read from file:
                string val = "";
                if (d.Value == null)
                    resourceEntries.Add(d.Key.ToString(), "");
                else
                {
                    resourceEntries.Add(d.Key.ToString(), d.Value.ToString());
                    val = d.Value.ToString();
                }

                //Write (with read to keep xml file order)
                resourceWriter.AddResource(d.Key.ToString(), val);

            }
            reader.Close();
        }

        //Add new data (at the end of the file):
        Hashtable newRes = new Hashtable();
        foreach (String key in data.Keys)
        {
            if (!resourceEntries.ContainsKey(key))
            {

                String value = data[key].ToString();
                if (value == null) value = "";

                resourceWriter.AddResource(key, value);
            }
        }

        //Write to file
        resourceWriter.Generate();
        resourceWriter.Close();

    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-09T14:45:59.107

这是改进 Womp 的答案 - 没有过时的 Hashtable，检查文件是否存在并使用 LINQ：

```
 public static void UpdateResourceFile(Dictionary<string, string> data, string path)
    {
        Dictionary<string, string> resourceEntries = new Dictionary<string, string>();
        if (File.Exists(path))
        {
            //Get existing resources
            ResXResourceReader reader = new ResXResourceReader(path);
            resourceEntries = reader.Cast<DictionaryEntry>().ToDictionary(d => d.Key.ToString(), d => d.Value?.ToString() ?? "");
            reader.Close();
        }

        //Modify resources here...
        foreach (KeyValuePair<string, string> entry in data)
        {
            if (!resourceEntries.ContainsKey(entry.Key))
            {
                if (!resourceEntries.ContainsValue(entry.Value))
                {
                    resourceEntries.Add(entry.Key, entry.Value);
                }
            }
        }

        string directoryPath = Path.GetDirectoryName(path);
        if (!string.IsNullOrEmpty(directoryPath))
        {
            Directory.CreateDirectory(directoryPath);
        }

        //Write the combined resource file
        ResXResourceWriter resourceWriter = new ResXResourceWriter(path);
        foreach (KeyValuePair<string, string> entry in resourceEntries)
        {
            resourceWriter.AddResource(entry.Key, resourceEntries[entry.Key]);
        }
        resourceWriter.Generate();
        resourceWriter.Close();
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-15T21:31:58.433

所有其他答案都使用 ResXResourceWriter，但对于某些特殊情况，将 Resources.resx 文件作为 XML 文档简单地使用可能是可行且更好的。

我有一个特定的情况，我想为一组图标文件操作 Resources.resx 条目。可能有数百个条目，我可以指望它们看起来都像这样：

```
 <data name="Incors_workplace2_16x16" type="System.Resources.ResXFileRef, System.Windows.Forms">
    <value>..\..\..\..\..\..\Icons\Incors-workplace2-16x16.png;System.Drawing.Bitmap, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a</value>
  </data> 
```

我尝试在该程序中使用 ResXResourceWriter 和 ResXResourceReader，但我最终将各种 Resources.resx 文件作为 XML 文档打开并以这种方式进行操作。整个程序太大（而且太特定于应用程序）无法在此处发布，但我将发布一些代码片段来展示一些可以使用的技术。

```
 /// <summary>
      /// Method to load a Resources.resx file (if it exists) as an XML Document object.
      /// </summary>
      private static XmlDocument LoadResourcesResx(string projectPath)
      {
         string fileName = projectPath + @"Properties\Resources.resx";
         if (!File.Exists(fileName))
            return null;

         XmlDocument xdResx = new XmlDocument();
         xdResx.Load(fileName);
         return xdResx;
      }

   // ---------------------------------------------------------------------------

      /// <summary>
      /// Method to fix the names of any resources that contain '-' instead of '_'.
      /// </summary>
      private static void FixResourceNames(XmlDocument xdResx, ref bool resxModified)
      {
         // Loop for all of the <data> elements that have name= attributes (node = "name" attr.)
         XmlNodeList xnlDataElements = xdResx.SelectNodes("/root/data/@name");
         if (xnlDataElements != null)
         {
            foreach (XmlNode xmlNode in xnlDataElements)
            {
               // Modify the name= attribute if necessary
               string oldDataName = xmlNode.Value;
               string newDataName = oldDataName.Replace('-', '_');
               if (oldDataName != newDataName)
               {
                  xmlNode.Value = newDataName;
                  resxModified = true;
               }
            }
         }
      }

   // ---------------------------------------------------------------------------

            // Prepare to add resource nodes to client-basic's Resources.resx file
            XmlNode rootNodeBasic = xdResx.SelectSingleNode("/root");
   // ---------------------------------------------------------------------------

      /// <summary>
      /// Sub-method of above method (not included here) to copy a new icon usage from one of the client-maxi projects 
      /// to the client-basic project.
      /// </summary>
      private static bool CopyIconToClientBasic(string projectPath, XmlDocument xdResxBasic, 
                                                XmlNode rootNodeBasic, XmlNode xmlNodeMaxi)
      {
         // Check if this is an icon-based resource, and get the resource name if so
         string oldDataName = GetAndCheckResourceName(xmlNodeMaxi);
         if (oldDataName == null)
            return false;

         // Determine if there is a 16x16, 20x20, 24x24, 32x32 or 48x48 version of this icon 
         //  available, picking the lowest size to reduce client-basic assembly increase for a 
         //  resource which will probably never be used
         string oldFileName = xmlNodeMaxi.FirstChild.InnerText.Split(';')[0];
         string minSize = FindMinimumIconSize(projectPath, oldFileName);  // Not included here
         if (minSize == null)
            return false;  // Something wrong, can't find icon file

         // Test if client-basic's resources includes a version of this icon for smallest size
         string newDataName = oldDataName.Remove(oldDataName.Length - 5) + minSize;
         if (xdResxBasic.SelectSingleNode("/root/data[@name='" + newDataName + "']") != null)
            return false;  // Already in client-basic

         // Add the smallest available size version of this icon to the client-basic project
         string oldSize = oldDataName.Substring(oldDataName.Length - 5);  // "16x16", "20x20"
         XmlNode newNodeBasic = xdResxBasic.ImportNode(xmlNodeMaxi, true);
         if (newNodeBasic.Attributes != null)
            newNodeBasic.Attributes["name"].Value = newDataName;  // Maybe force smaller size
         newNodeBasic.FirstChild.InnerText =
                                  newNodeBasic.FirstChild.InnerText.Replace(oldSize, minSize);
         rootNodeBasic.AppendChild(newNodeBasic);
         return true;
      }

   // ---------------------------------------------------------------------------

      /// <summary>
      /// Method to filter out non-icon resources and return the resource name for the icon-based 
      /// resource in the Resources.resx object.
      /// </summary>
      /// <returns>name of resource, i.e., name= value, or null if not icon resource</returns>
      private static string GetAndCheckResourceName(XmlNode xmlNode)
      {
         // Ignore resources that aren't PNG-based icon files with a standard size. This 
         //  includes ignoring ICO-based resources.
         if (!xmlNode.FirstChild.InnerText.Contains(";System.Drawing.Bitmap,"))
            return null;
         if (xmlNode.Attributes == null)
            return null;

         string dataName = xmlNode.Attributes["name"].Value;

         if (dataName.EndsWith("_16x16", StringComparison.Ordinal) ||
             dataName.EndsWith("_20x20", StringComparison.Ordinal) ||
             dataName.EndsWith("_24x24", StringComparison.Ordinal) ||
             dataName.EndsWith("_32x32", StringComparison.Ordinal) ||
             dataName.EndsWith("_48x48", StringComparison.Ordinal))
            return dataName;

         return null;
      }

   // ---------------------------------------------------------------------------

         // It's too messy to create a new node from scratch when not using the ResXResourceWriter 
         //  facility, so we cheat and clone an existing icon entry, the one for Cancel buttons

         // Get the Cancel icon name and filename
         BuiltInIcon cancelIcon = BuiltInIconNames.FindIconByName(BuiltInIconNames.CCancel);
         string cancelIconResourceName = cancelIcon.ResourceName + "_16x16";

         // Find it in the Resources.resx file - it should be there
         XmlNode cancelIconNode = 
                 xdResxBasic.SelectSingleNode("/root/data[@name='" + cancelIconResourceName + "']");
         if (cancelIconNode == null)
         {
            PreprocessorMain.DisplayError(0x27b699fu, "Icon " + cancelIconResourceName + 
                                                      " not found in Resources.resx file.");
            return false;
         }

         // Make a clone of this node in the Resources.resx file
         XmlNode newNode = cancelIconNode.Clone();
         if (newNode.Attributes == null) // Not possible?
         {
            PreprocessorMain.DisplayError(0x27b8038u, "Node for icon " + cancelIconResourceName + 
                                                      " not as expected in Resources.resx file.");
            return false;
         }

         // Modify the cloned XML node to represent the desired icon file/resource and add it to the 
         //  Resources.resx file
         newNode.Attributes["name"].Value = iconResourceName;
         newNode.InnerText = 
                  newNode.InnerText.Replace(cancelIcon.FileNameNoSize + "-16x16.png", iconFileName);
         rootNodeBasic.AppendChild(newNode);
         resxModified = true; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-26T08:59:02.307

在 Visual Studio 中，转到资源管理器窗口，然后您将看到其顶部的菜单“访问修改器”将其更改为公共并保存。会更新的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-21T14:01:29.003

这是我基于 Ers 和 SirMoreno 代码的版本。只是短了一点。这仍然不是处理元数据，这对我来说是可能的，但不是必需的。

```
 public static bool AddToResourceFile(string key, string value, string comment, string path)
    {
        using (ResXResourceWriter resourceWriter = new ResXResourceWriter(path))
        {
            //Get existing resources
            using (ResXResourceReader reader = new ResXResourceReader(path) { UseResXDataNodes = true })
            {
                foreach (DictionaryEntry resEntry in reader)
                {
                    ResXDataNode node = resEntry.Value as ResXDataNode;
                    if (node == null) continue;

                    if (string.CompareOrdinal(key, node.Name) == 0)
                    {
                        // Keep resources untouched. Alternativly modify this resource.
                        return false;
                    }

                    resourceWriter.AddResource(node);
                }
            }

            //Add new data (at the end of the file):
            resourceWriter.AddResource(new ResXDataNode(key, value) { Comment = comment });

            //Write to file
            resourceWriter.Generate();
        }
        return true;
    } 
```

# c# - 显示选中的记录

> ID：676314
> 
> 赞同：0
> 
> 时间：2009-03-24T06:16:23.503
> 
> 标签：c#, .net, data-binding

我有一个显示数据库中所有新闻的页面，我通过函数获得

```
IList<News> GetAll(); 
```

然后我将列表绑定到转发器以显示所有新闻。如果用户点击新闻N，他会被重定向到page.aspx?id=N

如果设置了 QueryString["id"]，那么我会得到这样的新闻之一：

```
News news = sNewsService.Get(int.Parse(id)); 
```

现在，我想显示这条新闻，但我无法将它绑定到中继器，因为它没有实现 IListSource 或 IEnumerable。

有没有其他方法可以显示一个新闻的属性，而不是将每个属性值写入不同的标签，如 lText = news.Text; lTitle = news.Title;... 还是将新闻包装在一个列表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T06:21:36.533

[DetailsView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.aspx)控件旨在显示单个记录。不确定这是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T07:17:59.533

这似乎是一个典型的 Master-Details 场景，您的中继器显示`News`对象列表，然后允许您重定向到详细信息页面，该页面将显示有关所选`News`对象的其他详细信息。

在这种情况下，我建议使用[FormView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.formview.aspx)而不是 DetailsView，这将允许您更好地控制详细信息显示，因为它需要用户定义的模板而不是预配置的基于 Row 的显示。

由于您的 News 类没有实现`IEnumerable`，因此您必须使用[ObjectDataSource](http://msdn.microsoft.com/en-us/library/9a4kyhcx.aspx)来启用数据绑定。此数据源将能够包装您的类并允许 FormView 使用基于[Eval](http://msdn.microsoft.com/en-us/library/4hx47hfe.aspx)的查找语法绑定到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-10T21:16:32.853

我将产品转换为 MVC 并创建了自定义 DTO/视图

# google-maps - Google 的 GeoCode XML 响应 - 了解响应

> ID：676315
> 
> 赞同：0
> 
> 时间：2009-03-24T06:17:44.247
> 
> 标签：google-maps, geocoding

嘿伙计们，在整个谷歌的 GoogleMap API 中，标准坐标格式首先是纬度，然后是经度，即：

-33.4487470,151.3425040

为什么在 GeoCode 的 XML 响应中，数据在坐标节点中是向后的？IE：

```
<coordinates> 151.3425040,-33.4487470,0</coordinates> 
```

此外，任何人都可以对 ExtendedData 节点和其中的信息有所了解吗？IE：

```
<ExtendedData> 
  <LatLonBox north="-9.2106000" south="-44.7779000" east="159.2029000" west="110.8740000" /> 
</ExtendedData> 
```

我知道一个随机的问题，但为什么谷歌会在坐标节点中交换这些值？

干杯

安迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T06:25:24.637

LatLonBox 是边界框的定义——即包含给定点集的矩形。矩形由两个纬度（北、南）和两个经度（东、西）定义。

请参阅：[kml 参考中的 latlonbox](http://code.google.com/apis/kml/documentation/kmlreference.html#latlonbox)

# css - div背景颜色，改变悬停

> ID：676324
> 
> 赞同：95
> 
> 时间：2009-03-24T06:22:38.620
> 
> 标签：css, colors, background, hover

我正在尝试**在鼠标悬停时更改 div 的背景颜色**。

> div {background:white;}
> div a:hover{background:grey; 宽度：100%；
> 显示：块；文字装饰：无；}

**只有**div 内的**链接****获得背景颜色**。

我该怎么做才能使**整个 div 获得该背景颜色？**

谢谢你

**编辑：**
如何使整个 div 充当链接 - 当您单击该 div 上的任意位置时，将您带到一个地址。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-03-24T06:30:50.800

当鼠标悬停在 -tag 上时，“ `a:hover`”字面意思是告诉浏览器更改 -tag 的属性。`<a>`您的意思可能是“ `the div:hover`”，而是在选择 div 时触发。

只是为了确保，如果您只想更改一个特定的 div，请给它一个 id (" `<div id='something'>`") 并使用 CSS " `#something:hover {...}`" 代替。如果你想编辑一组 div，将它们变成一个类（“ `<div class='else'>`”）并在这种情况下使用 CSS“ `.else {...}`”（注意类名前的句点！）

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-03-24T06:33:12.090

使用 Javascript

```
<div id="mydiv" style="width:200px;background:white" onmouseover="this.style.background='gray';" onmouseout="this.style.background='white';">
  Jack and Jill went up the hill To fetch a pail of water. Jack fell down and broke his crown, And Jill came tumbling after.
</div>
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2012-01-12T02:56:08.520

没有必要放锚。要在悬停时更改 div 的样式，然后在悬停时更改 div 的背景颜色。

```
.div_hover {
  background-color: #FFFFFF;
}

.div_hover:hover {
  background-color: #000000;
}
```

```
<div class="div_hover"> Change div background color on hover</div>
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-24T07:13:56.610

要使整个 div 充当链接，请将锚标记设置为：

```
display: block 
```

并将锚标签的高度设置为 100%。然后为您的 div 标签设置一个固定的高度。然后像往常一样设计你的锚标签。

例如：

```
<html>
<head>
    <title>DIV Link</title>

    <style type="text/css">
    .link-container {
        border: 1px solid;
        width: 50%;
        height: 20px;
    }

    .link-container a {
        display: block;
        background: #c8c8c8;
        height: 100%;
        text-align: center;
    }

    .link-container a:hover {
        background: #f8f8f8;
    }

    </style>

</head>
<body>

    <div class="link-container">
        <a href="http://www.stackoverflow.com">Stack Overflow</a>
    </div>

    <div class="link-container">
        <a href="http://www.stackoverflow.com">Stack Overflow</a>
    </div>

</body> </html> 
```

祝你好运！

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-05-30T23:38:37.997

html代码：

```
 <!DOCTYPE html>
    <html>
    <head><title>this is your web page</title></head>
    <body>
    <div class = "nicecolor"></div>
    </body>
    </html> 
```

CSS代码：

```
 .nicecolor {
      color:red;
      width:200px;
      height:200px;
     }

    .nicecolor:hover {
      color:blue;
     } 
```

这就是你如何通过将鼠标悬停在它上来将你的 div 从红色变为蓝色。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-24T06:58:57.113

放

```
display: block; 
```

在**a**上并给出一些高度

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-10-31T10:36:32.417

只需尝试 CSS 的“悬停”属性。例如：

```
<html>
<head>
    <style>
        div
        {
            height:100px;
            width:100px;
            border:2px solid red;
        }
        div:hover
        {
            background-color:yellow;
        }
    </style>
</head>
<body>
            <a href="#">
                      <div id="ab">
                                <p> hello there </p>
                      </div>
            </a>
</body> 
```

我希望这个能帮上忙

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-01-28T11:14:16.973

您可以将锚放在 div 周围。

```
<a class="big-link"><div>this is a div</div></a> 
```

进而

```
a.big-link {
background-color: 888;
}
a.big-link:hover {
 background-color: f88;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-01-06T05:37:17.270

你可以像这样在锚标签中包含 div：

```
a{
  text-decoration:none;
  color:#ffffff;
}
a div{
  width:100px;
  height:100px;
  background:#ff4500;
}
a div:hover{
  background:#0078d7;
}
```

```
<body>
<a href="http://example.com">
<div>
Hover me
</div>
</a>
</body>
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-28T08:23:18.630

只需`!important`在您的 css 文件中创建属性，以便鼠标悬停时背景颜色不会改变。这对我有用。

例子：

```
.fbColor {
    background-color: #3b5998 !important;
    color: white;
} 
```

# c# - StackOverflow 如何优化问题显示的性能？

> ID：676326
> 
> 赞同：6
> 
> 时间：2009-03-24T06:24:15.950
> 
> 标签：c#, asp.net, database-design, paging

我正在尝试学习 C#.net 来编写 Web 应用程序。

在得知 stackoverflow 使用 C#.net 后，我​​很高兴发现它。

每当我刷新页面时，我都会在主页或问题部分注意到这一点。该页面始终以可接受的速度向我返回最新信息。

我不确定你是怎么做到的。对不起，一连串的问题。我正在尝试了解数据检索、分页、性能等方面的最佳实践

我知道主页只返回有限数量的问题及其统计信息，但问题部分实际上返回了所有内容。

你如何优化它？

1.  对于主页，您是否总是获取最近问题的所有统计信息？所以您的查询类似于“select * from questions order by datetime_created limit 20”？

    所以 * 包含所有信息，包括问题标题、ID、视图等？

    您是否使用 HttpContext.Current.Server.cache 来帮助解决这个问题？

2.  对于这些问题，这更耐人寻味。

    你如何进行分页？

    您是否总是只从数据库中获取特定页面的结果？

    或者您是否获取所有结果并将其存储到数据集中？然后你使用某种数据网格控件来帮助分页？

如果是后者，如何维护要更新的数据？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-09-23T09:04:54.763

在 Stack Overflow 上，我们尝试在多个级别上使用主动缓存：

*   页面完全由 IIS 的输出缓存缓存，无论用户身份验证如何
*   仅为匿名用户缓存的页面；注册用户看到最新的内容
*   为所有人缓存的部分页面 html；`HttpRuntime.Cache`用于此

**主页**由三个缓存的 html 片段组成——最近的问题、最近的标签、最近的徽章——每个都有不同的持续时间。

问题列表**页面**将缓存`Int32[]`特定排序/标签过滤器的所有问题的 id ( )，从而使分页变得微不足道。对统计数据（例如问题计数、相关标签计数）的进一步缓存也已完成。

一个**问题详情页面**将完全缓存匿名用户，而注册用户看到最新的商品。此外，侧面的相关问题被缓存到磁盘的时间更长。

虽然我们尝试尽可能缓存整个页面，但我们确实在页面顶部显示用户信息 - 某些部分无法缓存。

因此，像拼图一样看待缓存——我的所有请求之间可以安全地共享哪些部分？根据费用，我的所有请求必须共享哪些部分？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T07:15:11.397

SO uses MVC and LINQ2SQL. I'd listen to some of the [podcasts](http://itc.conversationsnetwork.org/series/stackoverflow.html) to get more of an idea of the specifics. I do know they use a lot of caching but not sure if that includes the question list on the home page.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T08:38:39.447

[*我不知道他们是怎么做到的——我没有这么写。*]

对于这样的事情，我会为整个 Question 类及其所有 Answers 使用某种缓存机制。缓存将是短暂的，但由于经常查看新/热门问题，它们将保持活跃。较早的问题必须向 DB 提出。当一个人回答问题而另一个线程查看问题时，这也可以防止线程问题。

您可以在这里注意到的另一件事是他们大量使用 AJAX。但是由于 AJAX.Net*非常*浪费带宽，他们实现了 AJAX 调用，因此他们将返回简单的 JSON 对象，例如，当只对具有新票数的成功对象进行投票或返回错误消息时，例如：（[这是一个虚构的例子，并不代表发生的事情，因为我现在懒得检查）]

```
{"status": "ok", "votes": 3} 
```

AJAX.Net 将返回整个`UpdatePanel`的内容，无论其大小如何，无论多么小，仍然会很大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-23T10:03:19.060

您可能还想看看这个[Stack Overflow Inspired Knowledge Exchange](http://dotnetslackers.com/projects/StackOverflowInspiredKnowledgeExchange/)。

这是一组试图模仿 Stack Overflow 的文章。您应该可以在 CodePlex 找到代码[库](http://knowledgeexchange.codeplex.com/)。

# java - 使用eclipse API读取eclipse安装路径

> ID：676330
> 
> 赞同：3
> 
> 时间：2009-03-24T06:29:05.890
> 
> 标签：java, eclipse-pde

我打开了eclipse 3.3.2。现在我需要获取当前的 eclispe 安装路径。是

是否有任何 Eclipse API 来获取 Eclipse 安装路径？请在这方面提供帮助。

提前致谢..

斯内哈尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T07:36:54.417

由于eclipse3.4和[p2机制](http://dev.eclipse.org/mhonarc/lists/eclipse-pmc/msg00341.html)，你可以使用[`org.eclipse.osgi.service.datalocation.Location`](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/osgi/service/datalocation/Location.html)，它代表一个URL。

该接口包括 ** `ECLIPSE_HOME_FILTER**`，一个常量，它定义用于获取指定 Eclipse 主位置的服务的过滤器字符串（即“ `eclipse.home.location`”。）

但是在eclipse3.3中，只需要查询属性值“ `eclipse.home.location`”，如下：

```
System.getProperty("eclipse.home.location"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-06T00:19:54.137

关于为什么需要安装路径有点疑问。您的代码（插件）不应依赖于安装目录中的任何内容。如果您正在考虑写入安装目录。不！您将无法在共享安装中执行此操作，无论如何这是一个非常糟糕的主意。

例如，如果您需要访问插件中的文件，您只需使用如下代码：

```
Activator.getDefault().getBundle().getEntry(fileName); 
```

获取用户工作区的位置

```
Platform.getInstanceLocation().getURL().getPath(); 
```

# visual-studio-2010 - 是否有适用于 Visual Studio 2010 CTP2 的 T4 编辑器？

> ID：676333
> 
> 赞同：0
> 
> 时间：2009-03-24T06:31:28.473
> 
> 标签：visual-studio-2010, editor, t4, clarius-visual-t4

我正在寻找 VS 2010 CTP2 的 T4 编辑器。Clarius 在他们的博客上说他们正在等待 Beta1。

任何想法其他想法在哪里看？

谢谢

蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T06:34:56.577

是的，有形工程开发了另一个 T4 编辑器。它在 VS 2008 上运行。他们还刚刚发布了 VS 2010 CTP2 的版本。

你可以在这里获得 VS2008：t4editor.tangible-engineering.com

和这里的 VS 2010 CTP2 版本：有形工程.blogspot.com

玩得开心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T11:28:20.373

VS2010 Beta 1也有[更新版本](http://tangibleengineering.blogspot.com/2009/05/tangible-t4-editor-for-visual-studio.html)

# c# - W3wp 对 asp.net 开发服务器

> ID：676336
> 
> 赞同：0
> 
> 时间：2009-03-24T06:33:43.383
> 
> 标签：c#, asp.net, debugging, w3wp

你能解释一下 w3wp 吗，在调试 asp.net 内部层时附加到 w3wp 很好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T08:25:35.360

要附加调试器，请在您知道将要运行的代码中设置断点（确保 Debug="True" 以便创建调试符号）并在 Visual Studio 中转到 Debug -> Attach to Process -> 找到您网站的应用程序池w3wp 进程。如果您有多个处于活动状态的应用程序池，那么 w3wp 将被多次列出。

要进入您的 DAL，您还需要使用调试符号编译它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T06:37:36.213

嗯，什么？:-) w3wp 只是 IIS 中应用程序池的工作进程。每个应用程序池都有一个或多个工作进程，因此单个应用程序池中的故障不会杀死整个服务器（假设您为每个应用程序使用了不同的应用程序池:-)）

还有什么要知道的？:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T06:42:50.663

W3wp.exe 是“万维网工作进程”。我看不出附加它的任何理由或好处，因为它不能让您调试 ASP.NET 应用程序。

如果您打算调试 ASP.NET 应用程序，您应该附加到该`aspnet_wp.exe`进程（这是 Visual Studio 在您按下 Debug 时所做的）。

# c# - 列表视图选择

> ID：676340
> 
> 赞同：1
> 
> 时间：2009-03-24T06:36:08.603
> 
> 标签：c#

你好，

我需要在列表视图中选择一个项目（单元格）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T07:48:17.870

您不能在 ListView 中选择“子项”。如果您希望能够选择“单元格”，则必须使用网格视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-05T13:14:24.257

[我开发了一个名为Better ListView](http://www.componentowl.com/better-listview)的第三方组件，它允许使用箭头键选择子项。

也可以标记编辑子项，在其中使用图标等。

如果您需要将子项广泛用作单元格，则类似网格的控件是您的最佳选择，因为这些控件更适合*矩阵*，而不是*列表*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T11:08:59.197

如果无法选择单个单元格，但可以参考单个单元格的值。下面的链接有一个答案（获取单元格的值）。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.selecteditems.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.selecteditems.aspx)

```
 // Uses the SelectedItems property to retrieve and tally the price 
     // of the selected menu items.

private void ListView1_SelectedIndexChanged_UsingItems(
    object sender, System.EventArgs e)
{

    ListView.SelectedListViewItemCollection breakfast = 
        this.ListView1.SelectedItems;

    double price = 0.0;
    foreach ( ListViewItem item in breakfast )
    {
        price += Double.Parse(item.SubItems[1].Text);
    }

    // Output the price to TextBox1.
    TextBox1.Text = price.ToString();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T07:35:04.280

下面的代码导致列表视图中的所有项目不被选中，然后它导致项目#2 被选中。我相信您可以轻松地使此代码适应您的问题。顺便说一句，列表视图项使用从零开始的索引；因此，项目#2 实际上是列表视图中的第三个项目。

```
 for (int i = 0; i < listView1.Items.Count; i++)
        {
            listView1.Items[i].Selected = false;
        }

        // select item #2
        listView1.Items[2].Selected = true; 
```

# c# - 使用 RegisterHotKey api 调用时，为什么它接受 1、2、4 和 8 作为修饰符？

> ID：676341
> 
> 赞同：2
> 
> 时间：2009-03-24T06:36:19.383
> 
> 标签：c#, enums, pinvoke, flags

我参考这篇文章；

[http://www.pinvoke.net/default.aspx/user32/RegisterHotKey.html](http://www.pinvoke.net/default.aspx/user32/RegisterHotKey.html)

```
 #region fields
    public static int MOD_ALT = 0x1;
    public static int MOD_CONTROL = 0x2;
    public static int MOD_SHIFT = 0x4;
    public static int MOD_WIN = 0x8;
    public static int WM_HOTKEY = 0x312;
    #endregion

    [DllImport("user32.dll")]
    private static extern bool RegisterHotKey(IntPtr hWnd, int id, int fsModifiers, int vlc);

    [DllImport("user32.dll")]
    private static extern bool UnregisterHotKey(IntPtr hWnd, int id);

    private static int keyId;
    public static void RegisterHotKey(Form f, Keys key)
    {
        int modifiers = 0;

        if ((key & Keys.Alt) == Keys.Alt)
            modifiers = modifiers | WindowsShell.MOD_ALT;

        if ((key & Keys.Control) == Keys.Control)
            modifiers = modifiers | WindowsShell.MOD_CONTROL;

        if ((key & Keys.Shift) == Keys.Shift)
            modifiers = modifiers | WindowsShell.MOD_SHIFT;

        Keys k = key & ~Keys.Control & ~Keys.Shift & ~Keys.Alt;

        Func ff = delegate()
            {
                keyId = f.GetHashCode(); // this should be a key unique ID, modify this if you want more than one hotkey
                RegisterHotKey((IntPtr)f.Handle, keyId, modifiers, (int)k);
            };

        f.Invoke(ff); // this should be checked if we really need it (InvokeRequired), but it's faster this way
    } 
```

我的问题是，api如何`RegisterHotKey`知道 , `1`, `2`,`4`是`8`Windows 键？因为 ctrl、shift 和 menu (alt) 的键码会返回完全不同的键值？`RegisterHotKey`以及它正在检查的函数中到底发生了什么：

```
if ((key & Keys.Control) == Keys.Control)
                modifiers = modifiers | WindowsShell.MOD_CONTROL; 
```

它在这里做什么？

```
Keys k = key & ~Keys.Control & ~Keys.Shift & ~Keys.Alt; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T06:38:07.337

`MOD_ALT`,`MOD_CONTROL`等与关联键的键码没有任何关系。

您会看到一种`enum`用于表示一组[标志](http://msdn.microsoft.com/en-us/library/system.enum.aspx)的类型。这是一种特别紧凑的方式来表示表示事物组合的状态（如同时按下修饰键、文件访问权限等）

当`enum`以这种方式使用 s 时，枚举类型变量的每个位都可以用来指示设置了特定的“标志”。

```
// Note that powers of 2 are used; each value has only a single bit set
public static int MOD_ALT = 0x1;     // If bit 0 is set, Alt is pressed
public static int MOD_CONTROL = 0x2; // If bit 1 is set, Ctrl is pressed
public static int MOD_SHIFT = 0x4;   // If bit 2 is set, Shift is pressed 
public static int MOD_WIN = 0x8;     // If bit 3 is set, Win is pressed

// If we wanted to represent a combination of keys:
int altAndControl = MOD_ALT | MOD_CONTROL; // == 3
int controlAndShift = MOD_CONTROL | MOD_SHIFT; // == 6 
```

这有两个优点：

*   API 不必为每个修饰键采用单独的布尔参数
*   可以扩展 API 以包含额外的修饰键，而无需更改界面

按位`&`s 和`|`s 可用于确定在值中设置了哪些标志，以及在值中设置或取消设置标志。

您询问的代码正是这样做的：

```
if ((key & Keys.Control) == Keys.Control) 
   modifiers = modifiers | WindowsShell.MOD_CONTROL 
```

正在说“如果密钥设置了`Control`位，则将控制位设置为`modifiers`”

```
Keys k = key & ~Keys.Control & ~Keys.Shift & ~Keys.Alt; 
```

是说“`k`分配`key`了`Control`,`Shift`并`Alt`清除了标志”

我不确定为什么 pinvoke 的贡献者选择使用常量；您可以轻松地使用适当的枚举：

```
[Flags]
public enum Modifiers
{
   None = 0,
   Alt = 1,
   Control = 2,
   // ...
} 
```

[我对类似问题的回答](https://stackoverflow.com/questions/612072/question-on-operators/612116#612116)有更多关于标志如何工作的详细信息，以及更多示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T06:42:01.210

1、2、4、8 用于表示单个位。1 是最低有效位将打开。添加 2 将打开第二个最低有效位等。因此，您可以独立设置多个标志。

```
1 = 0001
2 = 0010
4 = 0100
8 = 1000 
```

因此，如果您想将 2 和 4 表示的变量设置为 true，您将使用 0110 = 6。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T06:41:25.907

如果您想了解有关 RegisterHotKey API 的更多信息，请查看此处：

[API 帮助](http://msdn.microsoft.com/en-us/library/ms646309.aspx)

此外，下载 Platform SDK 以查看 WinUser.h 以获得 MOD_ALT、MOD_CONTROL 等的定义值。

# syntax - Powershell 昂贵的解析

> ID：676342
> 
> 赞同：1
> 
> 时间：2009-03-24T06:37:16.883
> 
> 标签：syntax, powershell

这是我正在编写的脚本中的一小段；

```
Get-Content $tempDir\$todaysLog | Where-Object { $_ -match "" } |
    ForEach-Object -Process {
    $fields = [regex]::split($_,'@|\s+')
    Add-Content -Path $importSource2\$todaysLog -value ($($fields[0]) + "`t"  + $($fields[1]) + "`t" + $($fields[2]) + " " + $($fields[3])+ "`t" + "<*sender*@"+($($fields[5])) + "`t" + "<*recipient*@"+($($fields[7])))
    } 
```

对包装感到抱歉，本质上它将文件的元素标记为一个数组，然后写出某些元素以及周围的一些其他文本。目的是用无意义的东西替换敏感的发件人/收件人信息。

这是我正在解析的日志文件的示例；

10.197.71.28 SG 02012009 00:00:00 <['recip@kpmg.com.sg']>

显然，我已经替换了示例中的地址信息。上面的部分工作得很好，虽然我意识到它非常昂贵。有什么能想出更便宜的东西，也许是一个选择字符串来替换文本而不是标记/重写它？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T08:19:22.927

```
cat $tempDir\$todaysLog |
  %{ [regex]::Replace($_, "[A-Z0-9._%+-]+(@[A-Z0-9.-]+\.[A-Z]{2,4}\s<\[')[A-Z0-9._%+-]+(@[A-Z0-9.-]+\.[A-Z]{2,4}'\]>)", '*sender*$1*recipients*$2', "IgnoreCase") } > $importSource2\$todaysLog 
```

日志条目必须类似于示例行（尤其是 sender@kpmg.com <['recip@kpmg.com.sg']> 部分）。

* * *

**编辑**：我做了一些基准测试（1 mo 文件（~15000 行示例））：

## Andy Walker 的解决方案（使用*split*）-> **18,44s**

```
Measure-Command {

Get-Content $tempDir\$todaysLog | Where-Object { $_ -match "" } |
    ForEach-Object -Process {
    $fields = [regex]::split($_,'@|\s+')
    Add-Content -Path $importSource2\$todaysLog -value ($($fields[0]) + "`t"  + $($fields[1]) + "`t" + $($fields[2]) + " " + $($fields[3])+ "`t" + "<*sender*@"+($($fields[5])) + "`t" + "<*recipient*@"+($($fields[7])))
    }

} 
```

## Dangph 的解决方案（使用*replace*）-> **18,16s**

```
Measure-Command {

Get-Content $tempDir\$todaysLog | Where-Object { $_ -match "" } |
    ForEach-Object -Process {
    $s2 = $_ -replace "\t[^@\t']+@", "`t*sender*@"
    $s3 = $s2 -replace "\<\['.+@", "<['*recipient*@"
    Add-Content -Path $importSource2\$todaysLog -value $s3
    }

} 
```

## Madgnome 的解决方案（使用*正则表达式*）-> **6,16s**

```
Measure-Command {

cat $tempDir\$todaysLog |
  %{ [regex]::Replace($_, "[A-Z0-9._%+-]+(@[A-Z0-9.-]+\.[A-Z]{2,4}\s<\[')[A-Z0-9._%+-]+(@[A-Z0-9.-]+\.[A-Z]{2,4}'\]>)", '*sender*$1*recipients*$2', "IgnoreCase") } > $importSource2\$todaysLog

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T16:14:31.210

您应该避免使用 Powershell 作为大文件大小日志解析的引擎。我会使用 logparser.exe（你有一个可以转换为 csv 的空格分隔条目），然后在 Powershell 中使用 import-csv 来重新创建一个 Powershell 对象。从那里您可以删除和替换字段（基于每个对象）。Powershell 是胶水而不是燃料。使用它来解析任何大小的大型日志并不是完全愚蠢的，但对你和 CPU 来说都是昂贵的。尽管 Lee Holmes 在[http://examples.oreilly.com/9780596528492/](http://examples.oreilly.com/9780596528492/)的书籍示例中有一个出色的 Convert-TextObject.ps1 ，但您需要某种类型的日志解析引擎来处理繁重的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T08:05:56.593

```
$s1 = "10.197.71.28 SG  02012009 00:00:00   sender@kpmg.com <['recip@kpmg.com.sg']>"
$s2 = $s1 -replace "\t[^@\t']+@", "`t*sender*@"
$s3 = $s2 -replace "\<\['.+@", "<['*recipient*@"
write-host $s3 
```

我假设所有日志条目看起来都像示例行。如果他们不这样做，那么我们可能必须更复杂一些。

**请注意**，如果您复制并粘贴上述代码，您可能需要在第一行的“sender”之前手动重新插入制表符。

# c# - 允许用户使用 Ajax 下载文件

> ID：676348
> 
> 赞同：5
> 
> 时间：2009-03-24T06:41:39.277
> 
> 标签：c#, asp.net, ajax

我正在寻找一种允许用户使用 ajax 从我的站点下载文件的方法。我需要这样做的原因是因为文件很大（通常为 50 兆）。因此，当用户单击下载按钮时，它实际上看起来好像页面没有响应，因为它必须将文件从我的 Amazon S3 流式传输给用户。

所以我需要通知用户下载正在进行中，甚至可能给他们一个进度条。我找到了以下[文章](http://encosia.com/2007/02/23/ajax-file-downloads-and-iframes/)，但我并不热衷于将 iFrames 注入我的网页。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T07:29:34.887

我真的不明白如何允许用户使用 ajax 下载文件。没有任何方法可以将文件从 javascript 获取到他们的文件系统。将文件定位到 iframe 或新窗口并让用户像习惯使用浏览器一样管理下载有什么问题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T05:18:54.630

我决定使用 IFrame 方法，因为没有其他方法可以无缝地工作，值得花时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T06:50:42.500

在您的页面上添加一个进度条并为您的更新面板**使用回发触发器**。它将解决您面临的问题。

# html - 如何将 HTML 表格固定为特定大小

> ID：676351
> 
> 赞同：0
> 
> 时间：2009-03-24T06:44:02.110
> 
> 标签：html

我有一个 HTML 表格，在 1280 x 1024 分辨率下工作正常。如果我更改分辨率，表格会根据分辨率增加。

表格高度为 955px，宽度为 701px。

有没有办法将表格固定为所有分辨率的相同大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T06:47:33.227

使用百分比而不是 px 的高度和宽度。使用百分比将适用于所有更高和更低的分辨率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T07:13:04.240

When you change your resolution, the table is not changing size, the size of your pixels are relative to your screen.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-07T17:55:47.710

使用**百分比**和你的`width`会很整洁。`height``<table>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T07:37:41.997

您可能无法修复桌子。

但是你可以在显示器上修复它。许多好的显示器可以记住用户为每个特定分辨率设置的 X 和 Y 比例。因此，您检查您使用的所有分辨率并调整比例因子，以使表格保持其恒定的绝对大小。您可以使用学校中使用的一些测量单位来确保精度。

最好的解决方案是最简单的，对吧？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T08:34:37.790

“相同尺寸” - 该尺寸应以什么单位测量？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-29T18:50:15.203

你也许可以通过CSS 属性得到你想要的东西`min-height`。`max-height`

# internet-explorer - 打开新弹出窗口时需要从 Safari 浏览器强制打开 IE

> ID：676355
> 
> 赞同：0
> 
> 时间：2009-03-24T06:45:52.947
> 
> 标签：internet-explorer, browser, safari, popup

是否可以从 Safari 浏览器上的 Java 页面打开一个弹出窗口以在 IE 浏览器中打开一个弹出窗口。我认为这是不可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T07:02:41.207

You shouldn't assume that the user has IE available.

Some applications can be launched from the browser (if the user has them installed). For example, itunes://, ftp://, etc.

To answer your original question, no, you cannot. It would be a security risk if you could arbitrarily launch applications on the users machine.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T06:49:43.533

Good question! ;-) I too think this is not possible as the file will be opened with the default program associated to it.

Edit: Some investigations did not give me much information. Is it not possible with javascript too. More over if the user is using IE or FF then it was his decision. Why should you open another application without his permission. And I don think Browsers will allow this due to security issue even if this is possible.

# database - rowid 会被重用吗？

> ID：676356
> 
> 赞同：5
> 
> 时间：2009-03-24T06:46:12.463
> 
> 标签：database, rowid

在数据库中，例如 Informix、DB2、Oracle 等，rowid 会被重用吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T06:52:54.553

RowID 是存储在磁盘上的数据的物理位置。它们对于一张桌子来说是独一无二的。因此，他们可以重复。如果新记录存储在同一个地方（删除旧记录），那么 rowid 将是相同的（重用）。

有关 oracle 中 rowid 的详细信息，请参阅本文 [http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/pseudocolumns008.htm](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/pseudocolumns008.htm)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T06:54:15.610

它*可以*重复使用：

> 如果您删除一行，Oracle 可能会将其 rowid 重新分配给稍后插入的新行。

（[见此](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/pseudocolumns008.htm)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-24T17:26:04.350

另外 - 请注意，如果您导出然后导入数据库，它可能会发生变化。您永远不应将此值存储为键，因为它不可靠。

# ios - 在 iPhone 中连续播放 1 个声音片段而不会中断

> ID：676360
> 
> 赞同：5
> 
> 时间：2009-03-24T06:49:39.833
> 
> 标签：ios, objective-c, iphone, xcode

我正在开发一个简单的 iPhone 声音应用程序。我怎样才能不间断地播放一个又一个声音片段？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T15:28:39.667

您使用的是 SystemSounds 还是 AudioQueues？如果是 SystemSounds（用于短声音），您需要有一个线程以特定时间间隔播放它们，因为无法知道声音何时结束。

对于 AudioQueues，当声音的每个部分完成时您都会收到回调，因此在第一个声音结束时开始另一个声音（例如背景音乐）是一件相当容易的事情。

您并没有真正说明您要完成的工作，因此很难给出具体的答案。您是否希望将声音文件拼接在一起？播放背景音乐？用户射击 3 次时发出 3 次激光束声音？等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T12:44:44.007

您可以拥有一个包含所有必须播放的文件名的数组。目标是在当前歌曲几乎在文件末尾时开始播放下一首歌曲（可能距离结尾 0.5 秒）。

您需要一个线程控制器来管理应该播放的内容。他知道它正在播放什么以及接下来应该播放什么。

播放线程可能会在快结束时发送消息，然后您的控制器分配一个新的播放器线程并开始播放，依此类推...

希望这有帮助。

蒂埃里

# java - （字符串）还是 .toString()？

> ID：676363
> 
> 赞同：95
> 
> 时间：2009-03-24T06:51:53.013
> 
> 标签：java, casting

我有一个带`Object o`参数的方法。

在这种方法中，我完全知道`String`“o”中有一个不为空的。无需检查或执行其他操作。我必须像对待一个`String`物体一样对待它。

只是好奇 - 什么更便宜 - 投它`String`，或使用`Object.toString()`？还是 time-/cpu-/mem- 价格相同？

更新：该方法接受`Object`，因为它是接口的实现。无法更改参数类型。

而且根本不可能`null`。我只是想说我不需要检查它是否为空或为空。就我而言，总是有一个非空字符串。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-03-24T07:04:18.660

**转换为 String 更便宜**，因为它不需要外部函数调用，只需要内部类型检查。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-03-24T06:59:18.563

我会使用演员表。这验证了你的“知识”它是一个字符串。如果由于某种原因您最终遇到了错误并且有人传入了字符串以外的内容，我认为抛出异常（强制转换会这样做）比继续使用有缺陷的数据执行要好。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-03-24T10:54:02.320

根据[愚蠢的性能思考：x.toString() vs (String)x](http://www.cowtowncoder.com/blog/archives/2008/12/entry_119.html)

> 最后，结果出奇地清晰：**将 Object 转换为 String 至少比调用 Object.toString() 快两倍**

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-24T06:56:29.927

如果您知道 Object o 是一个字符串，我会说只是将它转换为一个字符串并以这种方式执行它。在您确定是 String 的对象上调用 toString() 可能只会增加混乱。

如果 Object o 可能不是字符串，则需要调用 toString()。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-24T06:56:34.000

我不会太在意性能，如果这个操作每秒只完成几千次 - 没有明显的区别。

但是，我会担心“知道”输入。你有一个接受 an 的方法，`Object`你应该这样对待它，即你不应该 *知道*关于参数的任何事情，除了它遵循`Object`接口，它恰好有一个`toString()`方法。在这种情况下，我强烈建议使用该方法，而不是仅仅假设任何事情。

OTOH，如果输入*始终*是 `String`or `null`，只需将方法更改为接受`String`s，并明确检查`null`s （无论何时处理非基元，您都应该这样做......）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-24T09:21:34.960

鉴于引用类型是一个对象，并且所有对象都有一个 toString()，只需调用 object.toString()。String.toString() 只是返回这个。

*   toString() 输入的代码更少。
*   toString() 是更少的字节码。
*   与多态调用相比，强制转换是一项昂贵的操作。
*   演员可能会失败。
*   使用 String.valueOf( object ) 如果它不为空，它只会调用 object.toString() 。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T06:55:47.107

不能有“o 中的空字符串”。如果 o 为 null，则它不包含 null 字符串，它只是 null。只需先检查 o 是否为空。如果您在 null 上强制~~转换~~或调用 ToString()，您将崩溃。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-24T07:08:20.477

如果您在“o”中拥有的是一个字符串，那么差别不大（可能演员表更快，但这是一个 VM/Library 实现的东西）。

如果“o”可能不是字符串，但它应该是字符串，那么强制转换就是您想要的（但您应该让方法采用字符串而不是对象）。

如果“o”可以是任何类型，那么您必须使用 toString - 但请务必先检查 null。

```
void foo(final Object o)
{
    final String str;

    // without this you would get a class cast exception
    // be wary of using instanceof though - it is usually the wrong thing to do
    if(o instanceof String)
    {
        str = (String)o;
    }    
} 
```

或者

```
void foo(final Object o)
{
    final String str;

    // if you are 100% sure that o is not null then you can get rid of the else
    if(o != null)
    {
        str = o.toString();
    }
} 
```

我宁愿将最后一个编码为：

```
void foo(final Object o)
{
    final String str;

    if(o == null)
    {
        throw new IllegalArgumentException("o cannot be null");
    }

    str = o.toString();
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-24T07:14:14.517

我奇怪地发现强制转换比 tostring 调用所隐含的 vtable 查找要慢。

# unit-testing - 您将如何对包含哈希表数据类型的函数进行单元测试？

> ID：676384
> 
> 赞同：4
> 
> 时间：2009-03-24T07:03:52.467
> 
> 标签：unit-testing

我的项目通过获取最小值和最大值为每种数据类型生成了一些值（相等的分区方法）。我正在为功能测试生成这些值，我实际上是将这些值传递给 nunit 伙伴，max 和 min 适用于 int、float、double 等。这些值是测试数据。

最初，我为 int、float、double、string 等基本数据类型生成它们。

现在我需要支持 DataSet、HashTable 和其他 Collections 等数据类型。

```
public DataSet MySampleMethod(int param1, string param2, Hashtable ht) 
```

为了测试这个函数，我可以传递 int 和 string 的值，但是我将如何传递测试数据`ht`或如何为哈希表生成测试数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T07:20:37.310

您需要从代码中抽象出哈希表实现，以便在单元测试时可以对其进行模拟、注入或存根。

只需创建一个名为 IHashTable 的接口，然后通过实现该接口来创建您的具体实现。然后让所有使用哈希表的类现在都使用 IHashTable。然后向其接受 IHashTable 的构造函数添加一个参数。

然后，当您进行单元测试时，传入 IHashTable 接口的模拟或存根。

模拟：[http ://en.wikipedia.org/wiki/Mock_object](http://en.wikipedia.org/wiki/Mock_object)

# c++ - stdafx.h：我什么时候需要它？

> ID：676385
> 
> 赞同：33
> 
> 时间：2009-03-24T07:04:01.127
> 
> 标签：c++, visual-c++, header, precompiled-headers, stdafx.h

我看到了很多代码，包括 stdafx.h。说，我**不**想要预编译的头文件。我**将**自己手动包含所有必需的系统标头。在那种情况下，我应该知道我需要在哪里有其他充分的理由`stdafx.h`吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-24T07:13:43.630

如果您不想使用预编译的头文件，那么使用标准的包含文件是没有意义的——这将减慢包含它的每个文件的构建速度，并导致它们包含他们不需要的额外内容。摆脱它，只包含他们需要的标题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T07:09:18.650

`stdafx.h`只是另一个头文件。如果您觉得不需要它，请随意不包含它并将其从项目中删除。

然而，有一个像 stdafx.h 这样的文件是非常典型的，它完全可以让预编译的头文件正常工作，而不是在每个源文件中手动包含所有的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T09:49:39.980

您可以使用预编译的头文件（这是一件好事）而不使用 stdafx.h（我也讨厌它）。我只能访问 VC++ 6.0，但在其中转到项目设置|C/C++|预编译头文件并选择“自动使用预编译头文件”，但将“编译通过”框留空。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T07:08:39.087

即使没有预编译的头文件，stdafx.h 也很方便，因为它将头文件包含和所有文件通用的定义分组。

您当然可以选择在每个文件中重复所有这些定义。stdafx.h 不是绝对必要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T07:43:13.700

正如其他人所提到的：如果您不需要预编译的标头，那么您实际上并不需要 stdafx.h 。实际上，仅使用它来对常见的包含进行分组是非常糟糕的做法。

事实上，即使在使用预编译头文件时，最好在 stdafx.h（或 precompiled.h 或您想调用的任何名称）之后包含您的进程实际需要的头文件 - 以及在您的预编译头文件中关闭 #ifdef 魔法PCH的使用。

为什么？为了检查您的模块依赖关系。能够禁用 PCH 可以让您了解是否包含必要的模块，然后您可以编写一个工具来通过解析 .cpp 和 .h 文件（当然不包括 PCH 标头）来检查模块的相互依赖性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-08T23:29:13.600

我知道这是一个老话题，但我想我会把我的意见传递给读者。我在 2017 年发现了这个，所以我确定我不是唯一一个会在这里的人。

使用预编译的头文件有一个优势，其他人可能会忽略这一点，因为他们多年来一直在使用他们的做法。C++ 标准已经有了很大的发展。不是在您可能需要的 20 个文件中包含向量和或其他文件，而是使用 PCH 文件，编译器必须做更少的工作，这让每个人都开心。您也可以将常用的宏放在那里，例如 VERIFY、ASSERT 和智能类对象。不要把你的类头放在那里，这没有意义，而是标准库或者你需要在很多地方全局使用的东西，比如我提到的宏。

basically realize this, by including the headers you need in every file you need, such as iostream, string, and vector, you are effectively compiling that every single time as an inline to the file. Include a "Pre Compiled" header, well just the name should ring a bell there.

# css - How to get firefox to show an auto horizontal scollbar for a div?

> ID：676388
> 
> 赞同：2
> 
> 时间：2009-03-24T07:05:39.780
> 
> 标签：css, firefox, scrollbar

See [this pastie](http://pastie.org/425172) in firefox. When resizing the browser window horizontally, then when the yellow area gets hidden a bit I want a horizontal scrollbar to appear. In Safari this code works fine. How would you style this for firefox?

*I am using overflow:auto; I only want the scrollbar to appear when it makes sense, I don't want to see it all the time*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T07:17:43.340

Firefox doesn't recognize `overflow-x` and `overflow-y`.

Instead use `overflow:-moz-scrollbars-horizontal;` or `overflow:-moz-scrollbars-vertical`;

This is a Mozilla Firefox specific hack so none of the other browsers should be affected.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T07:15:10.677

The best to use would be overflow: auto; this will add a scroll bar only when needed.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T07:35:26.387

指定一些宽度，然后“溢出：滚动；”

# html - 如何在没有框架/iframe 的情况下将 HTML 页面包含到另一个 HTML 页面中？

> ID：676394
> 
> 赞同：59
> 
> 时间：2009-03-24T07:08:35.170
> 
> 标签：html

我想在 HTML 页面中包含一个 HTML 页面。是否可以？

我不想在 PHP 中做，我知道在 PHP 中，我们可以使用`include`这种情况，我怎样才能在不使用`iframe`and`frame`概念的情况下纯粹在 HTML 中实现相同的功能？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-27T18:56:08.833

您可以使用对象元素

```
<object type="text/html" data="urltofile.html"></object> 
```

或者，在您的本地服务器上，AJAX 可以返回一个 HTML 字符串（responseText），您可以用它来记录。编写一个新窗口，或者编辑出 head 和 body 标签并将其余部分添加到 div 或其他块元素中当前页面。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-03-24T07:14:06.233

如果您只是想从另一个文件中插入您自己的 HTML，并且您认为**[服务器端包含](http://httpd.apache.org/docs/1.3/howto/ssi.html)**是“纯 HTML”（因为它看起来像 HTML 注释并且没有使用像 PHP 这样的“脏”的东西） ):

```
<!--#include virtual="/footer.html" --> 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-03-24T07:14:56.247

如果您的意思是客户端，那么您将不得不使用 JavaScript 或框架。
简单的开始方式，试试[jQuery](http://jquery.com/)

```
$("#links").load("/Main_Page #jq-p-Getting-Started li"); 
```

更多[jQuery 文档](http://docs.jquery.com/Ajax/load)

如果您想使用 IFrame，请从[IFrame上的 Wikipedia 开始](http://en.wikipedia.org/wiki/Iframes)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
        <title>Example</title>
  </head>
  <body>
        The material below comes from the website http://example.com/
        <iframe src="http://example.com/" height="200">
            Alternative text for browsers that do not understand IFrames.
        </iframe>
   </body>
</html> 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2015-03-01T18:14:23.520

您可以为此使用 HTML5：

```
<link rel="import" href="/path/to/file.html"> 
```

* * *

**更新 – 2020 年 7 月：**大多数主流浏览器不再支持此功能，并且通常被认为已过时。有关仍然支持它的浏览器列表，请参阅[caniuse 。](https://www.caniuse.com/#search=import)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-24T07:12:36.003

```
<iframe src="page.html"></iframe> 
```

您需要为此 iframe 添加一些样式。您可以指定宽度、高度，如果您希望它看起来像原始页面的一部分，请包含`frameborder="0"`.

在纯 HTML 中没有其他方法可以做到这一点。这就是它们的目的，就像说我想在没有鸡蛋的情况下煎鸡蛋。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-08-12T04:12:00.337

如果你愿意使用 jquery，有一个方便的 jquery 插件，叫做“inc”。

我经常将它用于网站原型设计，我只想向客户端呈现静态 HTML，没有可以快速创建/编辑/改进/重新呈现的后端层

[http://johannburkard.de/blog/programming/javascript/inc-a-super-tiny-client-side-include-javascript-jquery-plugin.html](http://johannburkard.de/blog/programming/javascript/inc-a-super-tiny-client-side-include-javascript-jquery-plugin.html)

例如，菜单和页脚之类的内容需要在每一页上显示，但您不希望以复制和粘贴的方式结束

您可以包含一个页面片段，如下所示

```
<p class="inc:footer.htm"></p> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-05-25T05:15:11.817

```
<html>
<head>
<title>example</title>
    <script> 
   $(function(){
       $('#filename').load("htmlfile.html");
   });
    </script>
</head>
<body>
    <div id="filename">
    </div>
</body> 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-11-06T15:04:29.493

```
$.get("file.html", function(data){
    $("#div").html(data);
}); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-05-06T11:15:51.377

我得到的最好的：包含在您的 js 文件中，并包含您可以通过这种方式添加的视图

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Bootstrap</title>
    <!-- Your custom styles (optional) -->
    <link href="css/style_different.css" rel="stylesheet">
</head>

<body>
    <script src="https://www.w3schools.com/lib/w3data.js"></script>
    <div class="">
      <div w3-include-html="templates/header.html"></div>
      <div w3-include-html="templates/dashboard.html"></div>
      <div w3-include-html="templates/footer.html"></div>
    </div>
</body>
<script type="text/javascript">
    w3IncludeHTML();
</script>
</html>
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-08-21T13:17:21.293

你可以说它是 PHP 的，但实际上它只有一个 PHP 命令，所有其他文件都只是 *.html。

1.  您应该在 Web 服务器的 /public_html 目录或另一个目录中拥有一个名为 .htaccess 的文件，您的 html 文件将在该目录中，您将在其中处理一个命令。
2.  如果你没有它，（或者它可能是隐藏的（你应该通过检查隐藏文件的目录来检查这个目录列表）），你可以用记事本创建它，然后在里面输入一行：
    `AddType application/x-httpd-php .html`
3.  将此文件保存为 .htaccess 名称并将其上传到服务器的主目录。
4.  在您希望出现外部“meniu.html 文件的任何位置的 html 文件中，添加 te 命令： `<?php include("meniu.html"); ?>`.

就这样！

备注：所有类似的命令`<? ...>`都将被视为 php 可执行文件，因此如果您的 html 有问号，那么您可能会遇到一些问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-01-21T13:59:49.680

还要确保查看如何使用[Angular 包含](http://www.w3schools.com/angular/angular_includes.asp)（使用[AngularJS](https://angularjs.org)）。这很简单……</p>

```
<body ng-app="">
  <div ng-include="'myFile.htm'"></div>
</body> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-05-31T15:13:49.060

如果你在 linux 上使用 NGINX 并且想要一个纯 bash/html，你可以在你的模板上添加一个掩码并通过管道请求使用 sed 命令通过使用正则表达式进行替换。

无论如何，我宁愿有一个从模板文件夹中获取并生成最终 HTML 的 bash 脚本。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2011-09-15T04:41:44.983

来自 nginx 的最佳解决方案：http: [//sysoev.ru/nginx/docs/http/ngx_http_ssi_module.html](http://sysoev.ru/nginx/docs/http/ngx_http_ssi_module.html)

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2013-01-26T09:32:41.953

确认 roadkill，在 web 根目录中创建一个 .htaccess 文件，其中包含一行，允许您将 php 代码添加到 .html 文件中。

AddType application/x-httpd-php .html

# c# - Manuplate Excel file with OLEDB, with file streams instead of physical file

> ID：676403
> 
> 赞同：2
> 
> 时间：2009-03-24T07:13:40.777
> 
> 标签：c#, excel-2003

Earlier I was reading excel file located on file system through Microsoft.Jet.OLEDB.4.0, and that was working fine, But now my client has told me that place excel file into a database table as BLOB column and read that file from that column and hide one workbook by manipulating that memory string directly.

Please help me out from this problem?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-13T12:31:00.973

使用 BLOB 内容创建一个临时文件，并在完成后替换 BLOB。

```
string fileName = Path.GetTempFileName();
using (var stream = File.OpenWrite(fileName))
  stream.Write(blobContents);

// open excel with oledb
// and do your processing

using (var stream = File.OpenRead(fileName))
{
   var buffer = new byte[stream.Length];
   stream.Read(buffer, 0, stream.Length);

   //save blob
} 
```

# javascript - Jquery 帮助：可拖动到可排序，然后再次回到可拖动

> ID：676415
> 
> 赞同：4
> 
> 时间：2009-03-24T07:17:40.017
> 
> 标签：javascript, jquery, jquery-ui-sortable, draggable

我在拖动列表中有一个项目池，它使用 connectToSortable 选项连接到可排序的项目。现在我想从这个排序列表中删除一些项目并将它们移回拖动列表。有点像撤消。假设用户将一些 5 个项目移动到排序列表并决定他/她只想要 4 个项目，并决定只将不需要的项目从排序列表拖到拖动列表中。如何在排序列表中不添加“删除”链接的情况下完成此操作。非常感谢。有关更多信息，请参阅[http://the-stickman.com/web-development/javascript/jquery-dropping-items-from-a-draggable-list-to-a-sortable-list/](http://the-stickman.com/web-development/javascript/jquery-dropping-items-from-a-draggable-list-to-a-sortable-list/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T04:31:14.380

这个[jQuery UI 示例](http://jqueryui.com/demos/sortable/#connect-lists)看起来就像您所追求的。它具有两个连接列表，用户可以在它们之间拖动元素。

但我怀疑您的情况与示例不符。假设您有一个拖动列表，每个 LI 的 UL 都可拖动并链接到另一个 UL 可排序（有关示例，请参见此[链接）。](http://jqueryui.com/demos/draggable/#sortable)每次从拖动列表中拖动某些东西时，都会对拖动的元素使用克隆。使用“out”事件，您可以在将项目拖到可排序列表之外时进行注册，如果在触发“停止”事件时该项目仍在外部，则将其从可排序列表中删除。使用可排序小部件的 ui.position 和 ui.offset 属性，您可以确定项目是否在实际从可排序中删除项目之前被拖动到拖动列表上。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-06T11:19:49.783

我认为最简单的解决方案是使您的可拖动列表也可放置，并处理该放置事件。我有一个`#priority_articles_list`可排序和`li.article`可抓取的，它们在里面`#articles`。在最简单的情况下，您可以调用`ui.draggable.remove();`，这应该可以解决问题。

```
$("#articles").droppable({
  accept: '#priority_articles_list > li',

  drop: function(ev, ui) {
    draggable_id = "#" + ui.draggable.attr("id").replace("priority_", "");
    $(draggable_id).removeClass("shouldnt_drag");
    ui.draggable.remove();
    if ($("#priority_articles_list").children("li").length == 1) {
      $("#priority_articles p").show();
    }
  }
}); 
```

# delphi - 将 TServerSocket 应用程序从 D5 转移到 D2007 的任何陷阱？

> ID：676425
> 
> 赞同：3
> 
> 时间：2009-03-24T07:23:21.017
> 
> 标签：delphi, delphi-2007, delphi-5, winsockets

我在谷歌上做了一个简短的搜索，什么也没找到，但我觉得我应该问一下。我并不真的期望会有什么，但宁愿现在问一个没有答案的问题，也不愿在一切都出错时问这个问题，发现每个人都知道一个“陷阱”......！

为了使整体支持/开发生活更轻松（并引入 madExcept 等），我将采用 D5 编写的半 GUI 应用程序（使用 NativeDB 连接到 ASA6）并将其移植到 D2007，最终将其转进入控制台应用程序和/或服务。（目前的 GUI 只不过是一个美化的开始/停止按钮和一个活动日志）。

它是一个经典的 TServerSocket 应用程序，监听指定的端口并在客户端连接时执行各种操作。我预计 NativeDB 方面不会出现任何大问题，但我想知道就 TServerSocket 而言，D5 和 D2007 之间是否有任何变化（错误修复、改进）？

我们不使用阻塞套接字、Indy 等——它只是来自 scktcomp 单元的 TServerSocket，直接来自 D5 Enterprise 框。除非 D2007 下的 TServerSocket 有问题，否则我不打算显着更改代码。:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T10:41:44.537

我认为 TServerSocket 仍然发货，但[默认情况下不再安装](http://support.codegear.com/article/36470)。没有其他我知道的陷阱。

由于这些组件已被弃用，您可能希望从长远来看迁移到[Indy](http://www.projectindy.org/index.en.aspx)、[ICS](http://www.overbyte.be/frame_index.html?redirTo=/products/ics.html)或[Synapse 。](http://www.ararat.cz/synapse/doku.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T19:14:38.147

使用 ICS 和 TServerSocket / TClientSocket 实现命令行应用程序可能需要创建一个不可见的窗口，因为这些组件使用窗口消息进行异步操作。我自己还没有尝试过，但它可能记录在 ICS 或 sckcomp 示例或来源中。

# .net - LINQ to Objects - Philosophy of use?

> ID：676428
> 
> 赞同：3
> 
> 时间：2009-03-24T07:23:49.207
> 
> 标签：.net, linq, object

I am starting to explore LINQ to Objects but want to know how application design can best accommodate LINQ to Objects.

As an example .... an application displays female employees only and the employee table in the database contains data for both male and female employees.

By default, the application builds a SQL statement to retrieve only the female employees from the database and places them into an object (List) which is then passed around the application for display etc.

To get the greatest leverage from LINQ to objects, I assume you would first have to obtain all the data for employees and then apply LINQ to filter the object to only display the female employees. The benefit is that you can continue to query the employees without touching the database again.

This is a basic example but the point I am trying to make is where does the line between benefit and efficient execution time cross.

What if the employee table has 100,000 records?

I can see the benefit of LINQ .... but in my head, I am convinced that you first need to put ALL the data into an object from which you can then use LINQ to query.

Getting ALL the data may be too costly to make it worthwhile when I can just query the database again each time I need a different subset of data.

Thoughts?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T07:30:15.713

If you only need a subset of the data to start with, only fetch that subset. I don't think it makes sense to fetch all the employee data in your example.

However, that doesn't mean that LINQ to Objects is rarely useful - often when you've already got some data (which may very well not be from a database - I find it incredibly useful with reflection, for example) you want to slice and dice it several ways. LINQ to Objects is a very powerful tool for that.

Personally, I find LINQ to Objects the most compelling LINQ provider. It's easy to predict what it will do (because there's no translation involved) and it's useful in every layer of the application. I miss it dreadfully when I'm writing Java - pretty much any time I do anything interesting with a collection, LINQ to Objects makes it easier.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T15:03:44.797

LinqToObjects 并不是要有效地处理非索引集合中的 100,000 个元素。foreach 循环也不是。

从哲学上讲，LinqToObjects 和 foreach 在同一个空间中工作。检查代码中的 foreach 循环，看看它们是否更富有表现力地编写为 LinqToObjects 查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T07:30:27.910

LINQ is not only about having to do with databases.

In short, it gives you querying capabilities (with DB or without DB) to a structure (which could be rows, XML, in memory list of Objects etc). So that, you don't have to write code to do things manually & it is more readable

Imagine, having to compare two lists & trying to find common elements among it using C# code. Doing this using SQL will be easy to understand but doing the same thing in c# will require little more code (and it will not be readable unless you try making it so)

LINQ gives syntactic sugar which makes it look like you are writing SQL to query/sort/aggregate things. SQL is readable to most developers.

EDIT: Assume you have the subset of data that you wish to show to the users. Now, you want some kind of filter/aggregation/sorting operation so that you don't have to use the DB to do all that, how will you do it?

What if there was something which treats my collection as some kind of queryable,sortable, aggregated structure (similar to that of a table in SQL)?

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T07:30:56.070

When you're dealing with data from a database, it starts to get fuzzy whether you should rely on LINQ-to-Objects or doing queries in the database. I think in general, if you have a database, it's always best to do as much filtering and sorting in the DB as possible, and use LINQ to Objects sparingly, especially on large collections of data.

However, since DAL code can get kind of clunky, I find that sometimes it's just easier to run a FindAll query in the DAL, and then just use LINQ to objects to sort and filter. (But only if your collection is small).

LINQ-to-Objects is useful for doing database-like sorting and filtering on in-memory collections. This might be a collection that you pulled from the database that you need to filter down a little more, but it could also be just any collection in code.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T07:43:31.390

您可以使用 LINQ 进行的不仅仅是查询数据库。类似于 LINQ to database entity/XML/etc 从延迟处理中受益的方式；对数组、集合、对象图和几乎任何其他你能想到的内存结构的查询也是如此。我的意思是延迟处理；您可以定义查询（分配给变量），并且在您开始枚举结果之前它实际上不会执行。此外，LINQ 的谓词逻辑到任何可链接的对象；想想过滤[管道](http://en.wikipedia.org/wiki/Pipelining)。

例如，假设您想要创建一个去除标点符号和空格的字符串扩展方法。您可以像这样针对字符串创建查询：

```
public static string RemovePunctuation(this string @string)
{
    if (string.IsNullOrEmpty(@string))
        return @string;

    var bytes = (
        from ch in @string
        where !Char.IsPunctuation(ch) && !Char.IsWhiteSpace(ch)
        select Convert.ToByte(ch)
        ).ToArray(); // <- calling to array enumerates the results

    return UnicodeEncoding.ASCII.GetString(bytes);
} 
```

当然还有其他方法可以做同样的事情，但这是一个有趣的 LINQ 对字符串的使用，它执行得非常好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T08:01:55.153

使用理念？这是您可以在其他地方应用的一般答案。

阅读一些工具有用的例子。如果您发现自己缺乏使用该工具的理由，因为您永远不会出现类似的示例，那么请忘记它。它可能不适用于您的域。

如果您操作的所有数据都在 RDBMS 中，那么您可能根本不需要 Linq to Objects。

另一方面......您可能将其视为对数据库中的数据进行一些额外操作的一种方式，因此错过了加强与代码无关的代码表现力的机会数据库。

示例：您正在阅读一个由纯文本行组成的文件。

```
var lines = File.ReadAllLines(fileName); 
```

碰巧，`lines`现在包含一个字符串数组，但是数组支持 IEnumerable，所以我们可以对它们使用 Linq 方法。假设您要删除其中没有任何内容的行：

```
var nonBlankLines = lines.Where(line => line.Trim() == string.Empty); 
```

并假设您想要引号中的那些字符串（天真的实现 - 需要转义现有的引号！）：

```
var quoted = lines.Where(line => line.Trim() == string.Empty)
                  .Select(line => "\"" + line + "\""); 
```

（我喜欢将连续的操作排列在一起，点法相互对齐。）

除非我要对这些线条做其他事情，否则我会这样做：

```
var quoted = File.ReadAllLines(fileName)
                 .Where(line => line.Trim() == string.Empty)
                 .Select(line => "\"" + line + "\""); 
```

然后假设我希望这一切都变成一个用逗号分隔的字符串`Join`，如果我先把它全部变成一个数组，那么字符串中有一个方法可以做到这一点：

```
var quoted = string.Join(", ", 
                         File.ReadAllLines(fileName)
                             .Where(line => line.Trim() == string.Empty)
                             .Select(line => "\"" + line + "\"")
                             .ToArray()); 
```

或者我们可以使用 Linqy 方法：

```
var quoted = File.ReadAllLines(fileName)
                 .Where(line => line.Trim() == string.Empty)
                 .Select(line => "\"" + line + "\"")
                 .Aggregate((a, b) => a + ", " + b); 
```

此外，填补一些空白也没什么大不了的，因为您发现没有现有的运算符可以满足您的需要（尽管有时事实证明已经有一个）。缺少的一个大的与`Aggregate`我所称的相反`Util.Generate`：

```
IEnumerable<T> Generate<T>(T item, Func<T, T> generator)
{
    for (; item != null; item = generator(item))
        yield return item;
} 
```

当您有一个链接列表时，这会非常方便，这种链接列表偶尔会出现在对象模型中。一个例子是`Exception.InnerException`，它允许异常形成一个链表，最里面的一个在最后。假设我们只想显示来自最里面的异常的消息`x`：

```
MessageBox.Show(Util.Generate(x, i => i.InnerException).Last().Message); 
```

helper 方法将`Generate`链表转换为 IEnumerable，允许其他 Linq 方法对其进行处理。只需要给它一个 lambda 来告诉它如何从当前项目到达下一个项目。

也许这会让您开始，或者您可能需要更多示例，或者您可能从不操作任何不是来自 RDBMS 的数据。

# api - 我可以使用他们的 API 搜索所有 Twitter 消息吗？

> ID：676432
> 
> 赞同：0
> 
> 时间：2009-03-24T07:28:53.813
> 
> 标签：api, twitter

是否可以使用 Twitter 的 API 来获取搜索结果？例如，如果我希望我的页面显示所有带有“猫”字样的推文[*（我讨厌这个词） ？*]是否也可以仅获得某个日期之后的匹配结果？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T07:34:42.690

啊我找到了！文档在这里：

[http://apiwiki.twitter.com/Search+API+Documentation](http://apiwiki.twitter.com/Search+API+Documentation)

```
http://search.twitter.com/search.json?q=<query> 
```

> 返回与指定查询匹配的推文。您可以在查询中使用各种搜索运算符。这里有一些例子：
> 
> *   查找包含单词的推文：[http ://search.twitter.com/search.atom?q=twitter](http://search.twitter.com/search.atom?q=twitter)
> *   查找用户的推文：[http ://search.twitter.com/search.atom?q=from%3Aalexiskold](http://search.twitter.com/search.atom?q=from%3Aalexiskold)
> *   查找给用户的推文：[http ://search.twitter.com/search.atom?q=to%3Atechcrunch](http://search.twitter.com/search.atom?q=to%3Atechcrunch)
> *   查找引用用户的推文：[http ://search.twitter.com/search.atom?q=%40mashable](http://search.twitter.com/search.atom?q=%40mashable)
> *   查找包含主题标签（最多 16 个字符）的推文：[http ://search.twitter.com/search.atom?q=%23haiku](http://search.twitter.com/search.atom?q=%23haiku)
> *   将任何运算符组合在一起：[http ://search.twitter.com/search.atom?q=movie+%3A%29](http://search.twitter.com/search.atom?q=movie+%3A%29)

您还可以添加此参数：

> since_id：返回状态 id 大于给定 id 的推文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T07:33:06.970

是的，有可能只得到匹配的结果。我不确定日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T08:16:24.743

我认为 Twitter 不会保留超过 1 年的推文历史。所以不可能搜索**所有**推文:)

# crystal-reports - Displaying Sub Report Data from First page only

> ID：676434
> 
> 赞同：1
> 
> 时间：2009-03-24T07:30:01.470
> 
> 标签：crystal-reports

Hi I have designed a crystal report which has only two sub reports to be displayed and no fields on the main report.

I have created those two subreports and placed them on the main report's Report Header Section A and Section B respectively.

But the problem is when I execute the report, data is getting displayed properly from Second page but not from the first page. First page shows only blank data with header section printing. If I place some sample text fields on the same report header sections where my first sub report is placed, it is getting displayed on the first page only. But sub reports are not getting displayed from the first page.

Need a solution for the same

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T06:02:07.357

正如 DotJoe 所说，建议是尽可能将子报告放入页脚部分。由于报告引擎的两遍性质，并非所有值都是在“打印”页眉时计算的，而所有值都是在“打印”页脚时完成的。我已经看到一些东西，例如运行总计在页眉中为零，但在页脚中是有效值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:53:14.310

尝试将子报表放在报表页脚中。

我遇到了报告标题中比页面长的子报告的问题。我认为这是由于报告标题出现在页面标题之前，并且可能是一些错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-25T07:01:44.620

进入部分专家（或早期版本中的格式部分），添加页面标题部分，它将生成两个标题并选择要在第 1+ 页上隐藏的部分，然后找到勾选右侧的“抑制”选项框，您将看到公式编辑器按钮，单击该按钮并在公式编辑器中添加以下内容

页码 > 1

这将禁止该部分在报告的第 1 页以外的任何内容上打印。

希望这可以帮助，

# c# - 上传文件到服务器

> ID：676447
> 
> 赞同：0
> 
> 时间：2009-03-24T07:36:23.577
> 
> 标签：c#, exception, webclient, file-upload

我正在尝试使用 C# 将文件从我的 Windows 应用程序上传到服务器到特定文件夹中。但是，我遇到了一个例外：

> “在 WebClient 请求期间发生异常”。

这是我的代码：

```
for (int i = 0; i < dtResponseAttach.Rows.Count; i++)
{
  string filePath = dtResponseAttach.Rows[i]["Response"];

  WebClient client = new WebClient();
  NetworkCredential nc = new NetworkCredential();

  Uri addy = new Uri("http://192.168.1.4/people/Attachments/");
  client.Credentials = nc;
  byte[] arrReturn = client.UploadFile(addy, filePath);
  Console.WriteLine(arrReturn.ToString());
} 
```

此异常的原因可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T07:49:36.680

如果你没有填写`NetworkCredential`，那么我很确定你不应该附上一个。

另一种可能性是您正在通过代理，并且需要添加代理详细信息：

```
WebProxy p = new WebProxy ("192.168.10.01", true);
p.Credentials = new NetworkCredential ("username", "password", "domain");
using (WebClient wc = new WebClient())
{
  wc.Proxy = p;
  ...
} 
```

# ajax - prototype.js 1.6.0.3 Ajax.Updater 在 IE7 或 IE8 中不起作用。请帮忙！

> ID：676448
> 
> 赞同：0
> 
> 时间：2009-03-24T07:36:51.110
> 
> 标签：ajax, internet-explorer, prototypejs

这适用于所有其他浏览器......但在 IE7 和 IE8 上失败。请帮忙！

```
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<script src="/javascripts/prototype.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
<input type="button" value="Ajax Test" onclick="var myAjax = new Ajax.Updater('TestContent', '/store/home', {method: 'post', parameters: 'foo=bar'});" />
<div id="TestContent" style="margin: 100px; border: 1px solid #F00; height: 500px;">
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T07:57:37.830

删除了所有 utf-8 引用，突然 IE 决定打球。IE，即使是全新的 8 版，也落后于其他 3 版（Firefox、Safari、Opera）……哦，好吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T07:53:52.910

语法看起来不错。可能不允许变量赋值或导致变量在完成之前被删除。您是否尝试过在外部函数中创建更新程序？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-08T03:59:54.990

我有一个类似的问题。

事实证明，在我的例子中，ajax 响应中有一个 FORM 元素，并且更新程序的目标已经在一个 FORM 元素中。

它在 Firefox 中运行良好，但在 IE 中运行良好。

[链接文本](https://prototype.lighthouseapp.com/projects/8886/tickets/842-ajaxupdater-fails-silently-in-ie-when-the-response-contains-form)

# eclipse - Eclipse + Git - “分阶段”是什么意思？

> ID：676450
> 
> 赞同：24
> 
> 时间：2009-03-24T07:37:34.167
> 
> 标签：eclipse, git

在使用 SVN 工作了一段时间后，我决定在我的新 django 项目中尝试 git，并将它的插件安装到 eclipse 中。我创建了一个新的 pydev 项目，并将 django 初始项目文件添加到 src 目录。然后我将项目“共享”到 Git，添加并提交了所有文件。现在我遇到了奇怪的问题——除了“manage.py”之外的所有文件都是“最新的”，并且 manage.py 有一个奇怪的图标，表示它是“暂存的”。这是什么意思？我试图用谷歌搜索它，但没有成功。:(

预先感谢。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-24T07:43:30.830

这意味着您的文件已被添加到[索引](http://gitready.com/beginner/2009/01/18/the-staging-area.html)中。

![指数](https://i.stack.imgur.com/W7tgI.png)

如[The Thing About Git中所述](http://tomayko.com/writings/the-thing-about-git)

该索引有时也称为暂存区。

> 我倾向于将其视为下一个补丁：
> 您可以使用工作副本中的更改以交互方式构建它，并且以后可以查看和修改它。
> 当你对你在暂存区的排列感到满意时，这基本上相当于一个差异，你提交它。 **而且由于您的提交不再直接绑定到您的工作副本中的内容，您可以自由地逐个文件、逐块地暂存各个部分**。

* * *

如果您查看[egit 的最新更改日志](http://repo.or.cz/w/egit.git?a=log)（eclipse Git 插件），您会发现他们仍在摆弄如何管理“暂存”文件，因为您的 egit 插件越新越好；）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-24T15:38:06.927

我建议您在开始在 Eclipse 中使用 Git 之前先熟悉 git 命令行。命令行是 git 的主要界面，如果您对索引、推送、拉取、rebase 等不同的概念不满意，那么在 Eclipse 中使用 Git 可能会让您更加困惑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T07:44:32.463

这不是一个“+”图标吗？git 中的暂存区域是文件添加到索引但未提交时。

来自[git-commit 手册](http://www.kernel.org/pub/software/scm/git/docs/git-commit.html)：“*记录自己的工作时，工作树中修改文件的内容会临时存储到一个名为“索引”的暂存区域，使用 git-add。* “

git-stage 也是 git-add 的别名。

# mysql - 是否允许在 MySQL 中使用数字作为表名？

> ID：676451
> 
> 赞同：15
> 
> 时间：2009-03-24T07:38:56.830
> 
> 标签：mysql

我正在考虑有一个程序可以根据需要动态创建新表。我可以在 MySQL 中用数字命名表吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-24T07:43:03.403

命名对象的规则，包括MySql中的表：

[http://dev.mysql.com/doc/refman/5.1/en/identifiers.html](http://dev.mysql.com/doc/refman/5.1/en/identifiers.html)

> 标识符可以以数字开头，但 **除非引用**，否则标识符可能不仅仅由数字组成。

所以这将是无效的：

```
 SELECT * FROM 12345; 
```

但以下内容将是有效的：

```
 SELECT * FROM `12345`; 
```

或者，如果在 ANSI 模式下运行，以下将起作用：

```
SET @@session.sql_mode=ANSI_QUOTES;
SELECT * FROM "12345"; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-24T09:19:56.043

正如 Karim 和 Steve Weet 指出的那样，**是的，你可以**，但你必须像这样引用它们：

```
SELECT * FROM `3516` 
```

我可以建议重新考虑你的剧本吗？添加前缀：名为“t3516”的表不会像“3516”那样令人困惑。

此外，您可以将数字转换为仅使用字母而不是任何数字：

```
table 0 - t_a
table 1 - t_b
table 2 - t_c
table 25 - t_z
table 26 - t_aa
table 27 - t_ab
... etc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T09:31:43.517

答案是肯定的，正如 karim79 所给出的，只要您注意引用表名。您当然可以使用带数字的前缀，例如。mytable1, mytable2, ... ; 这将在不引用的情况下工作。

也就是说，您应该真正考虑一下为什么要创建这么多表。公认的做事方式是将所有属于一起的东西放在一张表中。因此，与其使用 table1、table2...，不如使用一个表，并将数字存储在一列中。

这只是自然的方式。您的做事方式很容易导致许多问题（更改数据库模式对于备份来说是有问题的，由于表很多，其他工具很难使用数据库，必须对所有表进行模式更改）。在运行时动态更改架构通常不是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T13:26:23.173

我认为这根本不应该是可取的，因为它会更加混乱和难以记住。表名应该与它存储的数据相关。这是一个更好的习惯。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-26T15:19:16.197

如果表名是纯数字，则使用反引号（`）引用表名。它位于键盘上的 esc 按钮下方

# django - 如何在 Django 中根据域名或 TLD 设置 urlpatterns？

> ID：676457
> 
> 赞同：7
> 
> 时间：2009-03-24T07:43:54.477
> 
> 标签：django, session, request, django-urls

如何在 Django 中根据域名或 TLD 设置 urlpatterns？

对于某些链接，亚马逊会根据其网站 tld 以母语显示 url。

[http://www.amazon.de/bücher-buch-literatur/（de](http://www.amazon.de/b%C3%BCcher-buch-literatur/) ：书籍=> bücher）

[http://www.amazon.fr/Nouveautés-paraître-Livres/（fr](http://www.amazon.fr/Nouveaut%C3%A9s-para%C3%AEtre-Livres/) ：书籍=> Livres）

[http://www.amazon.co.jp/和书-ユーズドブッ-英语学习/](http://www.amazon.co.jp/%E5%92%8C%E6%9B%B8-%E3%83%A6%E3%83%BC%E3%82%BA%E3%83%89%E3%83%96%E3%83%83-%E8%8B%B1%E8%AA%9E%E5%AD%A6%E7%BF%92/) ( jp : books => 和书 )

（链接不完整，仅显示为示例。）

是否可以在 urls.py 中获取主机名？（请求对象在 urls.py 中不可用）或者可能在中间件的 process_request 中并在 urls.py 中使用它（如何？？？）

任何替代建议如何实现这一目标？

```
#---------- pseudocode ---------- 

website_tld = get_host(request).split(".")[-1]

#.fr French  : Books : Livres
#.de German : Books : Bücher

if website_tld == "fr":
    lang_word = "Livres"
elif website_tld == "de":
    lang_word = "Bücher"
else:
    lang_word = "books"

urlpatterns = patterns('',
                       url(r'^%s/$' % lang_word,books_view, name="books"),
                       ) 
```

url 模式需要在模板中基于 tld 和更高版本构建，`<a href="{% url books %}" >{% trans "books" %}</a>`以将 html 呈现为`<a href="Bücher">Bücher</a>`或`<a href="Livres">Livres</a>`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-24T07:55:07.570

~~您必须在网络服务器级别执行此操作（例如在 Apache 中使用 mod_rewrite）或使用中间件（例如[此代码段](http://www.djangosnippets.org/snippets/1119/)）~~

~~另请参阅[此 SO 问题](https://stackoverflow.com/questions/624827/in-a-django-web-application-how-do-you-give-users-their-own-subdomain)~~

* * *

更新：在您发表评论后，我想了更多。我喜欢 Carl Meyer 的回答，但后来意识到它无法正确处理 {% url %} 倒车。所以这就是我要做的：

**多个站点：**您需要使用[Django 站点框架](http://docs.djangoproject.com/en/dev/ref/contrib/sites/)。这意味着使用 Django 管理员为每种语言创建站点实例。

**多个设置：**每个语言站点也将有自己的 settings.py。每个站点之间的唯一区别是`SITE_ID`和`ROOT_URLCONF`设置，因此，为了遵循[DRY](http://en.wikipedia.org/wiki/DRY)原则，您应该将通用设置保存在不同的文件中，并将它们导入到主文件中，如下所示：

```
# settings_fr.py
SITE_ID = 1
ROOT_URLCONF = 'app.urls_fr'
from settings_common import *

# settings_de.py
SITE_ID = 2
ROOT_URLCONF = 'app.urls_de'
from settings_common import * 
```

... 等等。

**多个 URL conf：**如上所述，每个站点的 url conf：

```
# urls_fr.py
urlpatterns = patterns('',
    url(r'^Livres/$', books_view, name="books"),
)

# urls_de.py
urlpatterns = patterns('',
    url(r'^Bücher/$', books_view, name="books"),
) 
```

... 等等。

这样，所有语言的 url 名称（在本例中为“books”）都是相同的，因此`{% url books %}`将正确反转，并且域名将是 Site 对象的 domain_name 字段，带有`SITE_ID`.

**多个 Web 服务器实例：**为了让每个站点正常工作，它们都需要自己的服务器实例。对于 apache + mod_wsgi，这意味着每个站点都有一个不同的 wsgi 应用程序，如下所示：

```
# site_fr.wsgi
import os, sys, django.core.handlers.wsgi
os.environ['DJANGO_SETTINGS_MODULE'] = 'app.settings_fr'
application = django.core.handlers.wsgi.WSGIHandler() 
```

...等等，以及每个站点的匹配 apache 虚拟主机：

```
<VirtualHost *:80>
    ServerName mybooks.fr
    WSGIScriptAlias / /path/to/site_fr.wsgi
    ...
</VirtualHost> 
```

希望这很清楚:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-24T14:37:48.680

您可能可以使用通过 request.META['HTTP_HOST'] 检索 TLD 并将其添加到 request.path 的中间件来执行此操作；然后您的根 URLconf 可以切换到基于 TLD 作为第一个 URL 路径段的特定语言 URLconfs。像这样的东西（未经测试！）：

```
class PrependTLDMiddleware:
""" Prepend the top level domain to the URL path so it can be switched on in 
a URLconf. """

def process_request(self, request):
    tld = request.META['HTTP_HOST'].split('.')[-1]
    request.path = "/%s%s" % (tld, request.path) 
```

在您的 URLconf 中：

```
urlpatterns = patterns('',
    url(r'^de/' include('de_urls')),
    url(r'^fr/', include('fr_urls')),
    url(r'^[^/]+/', include('en_urls'))
) 
```

然后 de_urls.py、fr_urls.py 和 en_urls.py 可以分别拥有您需要的所有 URL，并采用适当的语言。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-24T10:24:24.217

在 django 中有一个名为“站点”的表。也许你可以用它做点什么？

# python - 网络爬虫和 Google App Engine 托管的应用程序

> ID：676460
> 
> 赞同：4
> 
> 时间：2009-03-24T07:44:38.017
> 
> 标签：python, google-app-engine, web-crawler

考虑到我正在运行免费的启动版本，是否不可能在 GAE 上与我的应用程序一起运行网络爬虫？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T12:26:35.553

虽然 Google 没有公开调度、队列和后台任务 API，但您只能将任何处理作为对外部 HTTP 请求的响应。您需要一些心跳服务来一次处理爬虫队列中的一项（不达到 GAE 限制）。

要从 GAE 进行爬网，您必须将应用程序拆分为队列（将队列数据存储在 Datastore 中）、将对外部 HTTP 心跳做出反应的队列处理器和您的实际爬网逻辑。

您必须手动查看您的配额使用情况并在有空闲配额时启动心跳，如果用完则停止。

当 Google 引入我一开始就告诉过的 API 时，您必须重写通过 Google API 更有效地实现的部分。

更新：谷歌前段时间引入了任务队列 API。请参阅python和[java](http://code.google.com/appengine/docs/java/taskqueue/)[的任务队列文档](http://code.google.com/appengine/docs/python/taskqueue/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T12:17:12.090

App Engine 代码仅在响应 HTTP 请求时运行，因此您无法在后台运行持久爬虫。随着计划任务的即将发布，您可以编写一个使用该功能的爬虫，但这并不理想。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T10:14:42.603

我想您可以（即，*并非不可能*）运行它，但它会很慢，而且您很快就会遇到[限制](http://code.google.com/appengine/docs/quotas.html)。由于 CPU 配额将在 5 月底进一步降低，我建议不要这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T13:11:35.643

这是可能的。但这并不是 Arachnid 所写的真正的 appengine 应用程序。如果您设法使其正常工作，我怀疑您是否会留在免费帐户的配额中。

# c - setjmp/信号崩溃异常处理

> ID：676461
> 
> 赞同：1
> 
> 时间：2009-03-24T07:47:42.707
> 
> 标签：c, multithreading, macos, exception-handling, crash

我正在尝试为 C OSX Carbon**多线程**应用程序安装“崩溃处理程序”。在 Windows 上，我可以轻松使用 Windows 的简单高效的[__try{} __except{} SEH](http://www.gamedev.net/reference/programming/features/sehbasics/)，效果很好。（请注意，这些与 C++ 异常**无关**，它们是较低级别的 C 构造！）

[这与我之前在 SO 上提出](https://stackoverflow.com/questions/614710/exception-wrapper-for-carbon-c-app-in-osx)的问题非常相关：也与[较旧的 SO 问题有关](https://stackoverflow.com/questions/39222/portably-handle-exceptional-errors-in-c)。

答案似乎是在每个代码区域之前使用 setjmp()，然后在发生崩溃时使用信号处理程序 longjmp() 返回。

但是这个实现是不平凡的..因为多线程！Windows 中的 __try{} __except{} 习惯用法是线程安全的，并且可以正常工作。但显然 setjmp 不是线程安全的。

那么实现会是什么样子呢？我一直在想我将不得不实现一些线程本地存储。在开始时，我初始化 setjmp，将环境状态存储到线程本地缓冲区中，然后信号处理程序必须通过查看线程本地区域再次找到环境数据。但是，Google 和 SO 都没有显示任何证据表明这是正确的策略，特别是因为 setjmp() 被记录为线程不安全。线程本地存储不是需要每个线程都注册自己并分配内存（以保存该环境数据），并在线程销毁时释放它吗？

我希望我可以制作一个宏，将所有这些都包装在 OSX 上，我的 __try __except 代码可以正常工作。

那么，如何使用信号和 setjmp 制作 OSX 多线程安全的崩溃恢复处理程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T16:41:00.710

[ReactOS](http://www.reactos.org/)有一个名为[PSEH](http://www.reactos.org/wiki/index.php/PSEH)的 SEH 克隆。 [ROS Newsletter #49有一个简短的提及，你可以在](http://www.reactos.org/en/newsletter_49.html#sec3)[/include/crt/excpt.h](http://www.reactos.org/generated/doxygen/d2/da1/crt_2excpt_8h-source.html)，[/include/reactos/lib/pseh/pseh2.h](http://www.reactos.org/generated/doxygen/d8/d61/pseh2_8h-source.html)等中看到它是如何实现的。看起来有点乱破解宏和（目前仅限 x86）程序集，但它可以工作。

话虽这么说，信号+线程交互在 UNIX 上是出了名的丑陋，所以如果你想要 SEH 的目的是处理信号......我建议你找到一个替代解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T07:59:48.917

我使用`setjmp`/使用类似的异常处理`longjmp`，并且我有线程本地存储。对于每个新线程，我调用 malloc 的本地 jmpbuf 的初始化函数。

**注意！**我从未在多线程环境中正确测试过它！

# c# - 带有 C# WPF 的项目符号 MarkerStyle

> ID：676464
> 
> 赞同：1
> 
> 时间：2009-03-24T07:49:43.793
> 
> 标签：c#, wpf

我目前正在尝试找出一种在执行 EditingCommands.ToggleBullets 时更改 Bullet MarkerStyle 的方法。据我了解，CommandManager.Execute 在切换项目完成之前执行。所以我无法简单地进入并使用 ExecutedRoutedEvent 更改 List.MarkerStyle。谁能指出我正确的方向来做到这一点？另一件事我试图看看我是否可以更改默认的 MarkerStyle 但没有看到任何方法来做到这一点。任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T10:12:17.693

您可以在 xaml 中更改列表的默认 MarkerStyle：

```
<List MarkerStyle=Square>
    <ListItem>Item with a square</ListItem>
</List> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T10:18:04.000

或者在您的资源中包含一个样式，它将为您更改所有 MarkerStyle 属性：

```
<Style TargetType="List">
    <Setter Property="MarkerStyle" Value="Square" />
</Style> 
```

# regex - 如何使用正则表达式匹配 X 和 Y 之间的数字？

> ID：676467
> 
> 赞同：28
> 
> 时间：2009-03-24T07:52:20.730
> 
> 标签：regex

我想用 RegExp 匹配 X 和 Y 之间的数字。这可能吗？

([0-9]+) 将匹配任何数字，我该如何匹配例如 110 和 2234 之间的数字？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-24T08:11:06.393

根据[Generate a Regular Expression to Match an Arbitrary Numeric Range](http://code.activestate.com/recipes/534137/)，并在[Regex_For_Range](https://web.archive.org/web/20151029043426/http://utilitymill.com/utility/Regex_For_Range)为您的示例生成这样的正则表达式后：

```
\b0*(1[1-9][0-9]|[2-9][0-9]{2}|1[0-9]{3}|2[01][0-9]{2}|22[0-2][0-9]|223[0-4])\b 
```

会成功的。

该过程将是（仍然遵循该正则表达式生成器）：

> 首先，分成相等的长度范围：

```
110 - 999
1000 - 2234 
```

> 其次，分解产生简单正则表达式的范围：

```
110 - 199
200 - 999
1000 - 1999
2000 - 2199
2200 - 2229
2230 - 2234 
```

> 将每个范围转换为正则表达式：

```
1[1-9][0-9]
[2-9][0-9]{2}
1[0-9]{3}
2[01][0-9]{2}
22[0-2][0-9]
223[0-4] 
```

> 折叠 10 的相邻幂：1[1-9][0-9] [2-9][0-9]{2} 1[0-9]{3} 2[01][0-9]{2 } 22[0-2][0-9] 223[0-4]
> 
> 结合上面的正则表达式产生：

```
0*(1[1-9][0-9]|[2-9][0-9]{2}|1[0-9]{3}|2[01][0-9]{2}|22[0-2][0-9]|223[0-4]) 
```

> 接下来我们将尝试使用树来分解常见的前缀：
> Parse into tree based on regex prefixes：

```
. 1 [1-9] [0-9]
+ [0-9]{3}
+ [2-9] [0-9]{2}
+ 2 [01] [0-9]{2}
+ 2 [0-2] [0-9]
+ 3 [0-4] 
```

> 将解析树转换为正则表达式会产生：

```
0*(1([1-9][0-9]|[0-9]{3})|[2-9][0-9]{2}|2([01][0-9]{2}|2([0-2][0-9]|3[0-4]))) 
```

> 我们选择较短的一个作为我们的结果。

```
\b0*(1[1-9][0-9]|[2-9][0-9]{2}|1[0-9]{3}|2[01][0-9]{2}|22[0-2][0-9]|223[0-4])\b 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-24T08:05:14.520

这不是正则表达式擅长的事情。您可能会发现更容易确保您拥有正确的位数`/^([0-9]{3,4})$/`，然后对捕获进行进一步检查。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-26T02:06:35.833

虽然你*可以*用一些看起来很荒谬的正则表达式来做到这一点（正如 VonC 所回答的那样），但正则表达式真的不应该这样做。为什么不将号码检查推迟到重定向到脚本？

如果数字 110-2234 转到 script1，而 1-109 转到 script2，则将所有数字指向脚本会简单得多*，*`router`并将其重定向到正确的位置（通过 HTTP 重定向）。

在`.htaccess`：

```
RewriteRule ^view/([0-9]+)/?$ router.php?page=$1 [L] 
```

..然后在`router.php`，类似：

```
<?PHP
if(
   int($_GET['page']) > 110 &&
   int($_GET['page']) < 2234
){
    header("Status: 301 Moved Permanently\nLocation: /script1");
}else{
    header("Status: 404 Not Found");
}
?> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-15T10:05:21.550

您可以将以下范围的正则表达式放在一起：

```
1[1-9]\d  = 110-199
[2-9]\d\d = 200-999
1\d\d\d   = 1000-1999
2[0-1]\d\d= 2000-2199
22[0-2]\d = 2200-2229
223[0-4]  = 2230-2234 
```

来形成：

```
(1[1-9]\d|[2-9]\d\d|1\d\d\d|2[0-1]\d\d|22[0-2]\d|223[0-4]) 
```

*\d 表示 [0-9]，但少了三个字符*

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-05-12T11:06:05.047

由于在线数字范围正则表达式生成器服务通常会在一段时间后变得不可用（在撰写本文时[这个](https://www.richie-bendall.ml/ros-regex-numeric-range-generator/)服务仍然存在），我认为在这里拥有它会很好。

请确保您在文本输入字段中输入最小和最大阈值，在下面标记您需要的所有选项并点击*生成*：

```
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).toRegexRange=e()}}(function(){return function(){return function e(t,n,r){function i(u,a){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[u]={exports:{}};t[u][0].call(f.exports,function(e){return i(t[u][1][e]||e)},f,f.exports,e,t,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}}()({1:[function(e,t,n){"use strict";const r=e("is-number"),i=(e,t,n)=>{if(!1===r(e))throw new TypeError("toRegexRange: expected the first argument to be a number");if(void 0===t||e===t)return String(e);if(!1===r(t))throw new TypeError("toRegexRange: expected the second argument to be a number.");let o={relaxZeros:!0,...n};"boolean"==typeof o.strictZeros&&(o.relaxZeros=!1===o.strictZeros);let s=e+":"+t+"="+String(o.relaxZeros)+String(o.shorthand)+String(o.capture)+String(o.wrap);if(i.cache.hasOwnProperty(s))return i.cache[s].result;let c=Math.min(e,t),f=Math.max(e,t);if(1===Math.abs(c-f)){let n=e+"|"+t;return o.capture?`(${n})`:!1===o.wrap?n:`(?:${n})`}let l=h(e)||h(t),d={min:e,max:t,a:c,b:f},p=[],g=[];if(l&&(d.isPadded=l,d.maxLen=String(d.max).length),c<0){g=u(f<0?Math.abs(f):1,Math.abs(c),d,o),c=d.a=0}return f>=0&&(p=u(c,f,d,o)),d.negatives=g,d.positives=p,d.result=function(e,t,n){let r=a(e,t,"-",!1,n)||[],i=a(t,e,"",!1,n)||[],o=a(e,t,"-?",!0,n)||[];return r.concat(o).concat(i).join("|")}(g,p,o),!0===o.capture?d.result=`(${d.result})`:!1!==o.wrap&&p.length+g.length>1&&(d.result=`(?:${d.result})`),i.cache[s]=d,d.result};function o(e,t,n){if(e===t)return{pattern:e,count:[],digits:0};let r=function(e,t){let n=[];for(let r=0;r<e.length;r++)n.push([e[r],t[r]]);return n}(e,t),i=r.length,o="",u=0;for(let e=0;e<i;e++){let[t,i]=r[e];t===i?o+=t:"0"!==t||"9"!==i?o+=p(t,i,n):u++}return u&&(o+=!0===n.shorthand?"\\d":"[0-9]"),{pattern:o,count:[u],digits:i}}function u(e,t,n,r){let i,u=function(e,t){let n=1,r=1,i=f(e,n),o=new Set([t]);for(;e<=i&&i<=t;)o.add(i),i=f(e,n+=1);for(i=l(t+1,r)-1;e<i&&i<=t;)o.add(i),i=l(t+1,r+=1)-1;return(o=[...o]).sort(s),o}(e,t),a=[],c=e;for(let e=0;e<u.length;e++){let t=u[e],s=o(String(c),String(t),r),f="";n.isPadded||!i||i.pattern!==s.pattern?(n.isPadded&&(f=g(t,n,r)),s.string=f+s.pattern+d(s.count),a.push(s),c=t+1,i=s):(i.count.length>1&&i.count.pop(),i.count.push(s.count[0]),i.string=i.pattern+d(i.count),c=t+1)}return a}function a(e,t,n,r,i){let o=[];for(let i of e){let{string:e}=i;r||c(t,"string",e)||o.push(n+e),r&&c(t,"string",e)&&o.push(n+e)}return o}function s(e,t){return e>t?1:t>e?-1:0}function c(e,t,n){return e.some(e=>e[t]===n)}function f(e,t){return Number(String(e).slice(0,-t)+"9".repeat(t))}function l(e,t){return e-e%Math.pow(10,t)}function d(e){let[t=0,n=""]=e;return n||t>1?`{${t+(n?","+n:"")}}`:""}function p(e,t,n){return`[${e}${t-e==1?"":"-"}${t}]`}function h(e){return/^-?(0+)\d/.test(e)}function g(e,t,n){if(!t.isPadded)return e;let r=Math.abs(t.maxLen-String(e).length),i=!1!==n.relaxZeros;switch(r){case 0:return"";case 1:return i?"0?":"0";case 2:return i?"0{0,2}":"00";default:return i?`0{0,${r}}`:`0{${r}}`}}i.cache={},i.clearCache=(()=>i.cache={}),t.exports=i},{"is-number":2}],2:[function(e,t,n){"use strict";t.exports=function(e){return"number"==typeof e?e-e==0:"string"==typeof e&&""!==e.trim()&&(Number.isFinite?Number.isFinite(+e):isFinite(+e))}},{}]},{},[1])(1)});

$( document ).ready( function() {
  $( "#rangeLeft, #rangeRight" ).keydown( function() {
    clearDisplay();
  } );
  $('#wholestring').click(function() {
        $('#wholestring').attr('checked', 'checked');
        $('#wb').attr('checked', false);
        $('#dgtb').attr('checked', false);
        $('#whtb').attr('checked', false);
    })
  $('#wb').click(function() {
        $('#wb').attr('checked', 'checked');
        $('#wholestring').attr('checked', false);
        $('#dgtb').attr('checked', false);
        $('#whtb').attr('checked', false);
    })
  $('#dgtb').click(function() {
        $('#dgtb').attr('checked', 'checked');
        $('#wb').attr('checked', false);
        $('#wholestring').attr('checked', false);
        $('#whtb').attr('checked', false);
    })
  $('#whtb').click(function() {
        $('#whtb').attr('checked', 'checked');
        $('#wb').attr('checked', false);
        $('#dgtb').attr('checked', false);
        $('#wholestring').attr('checked', false);
    })
  $( "#run" ).click( function() {
    clearDisplay();
    var rangeLeft = $( "#rangeLeft" ).val();
    var rangeRight = $( "#rangeRight" ).val();
    if ( ! checkRanges( rangeLeft,  rangeRight ) ) return;
    let source = toRegexRange(rangeLeft, rangeRight);

    if ($('#frac').is(':checked')) {
        source = source + '(?:\\.\\d+)?';
    }
    if ($('#allowzero').is(':checked')) {
        source = "0*" + source;
    }
    if ($('#neg').is(':checked')) {
        source = "-?" + source;
    }
    if ( $('#wholestring').is(':checked')) {
        source = '^' + source + '$';
    } else if ( $('#wb').is(':checked')) {
        source = '\\b' + source + '\\b';
    } else if ( $('#whtb').is(':checked')) {
        source = '(?<!\\S)' + source + '(?!\\S)';
    } else if ( $('#dgtb').is(':checked')) {
        source = '(?<!\\d)' + source + '(?!\\d)';
    }
    $( "#result" ).append( "<B>" + source.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;') + "</B><BR/>" );
  } );
} );

function checkRanges( rangeLeft, rangeRight ) {
  if ( /\D/.test( rangeLeft ) || /\D/.test( rangeRight ) ) {
    $( "#result" ).append( "Type two numbers<BR/>" );
    return false;
  }
  rangeLeft = parseInt( rangeLeft );
  rangeRight = parseInt( rangeRight );
  if ( isNaN( rangeLeft ) || isNaN( rangeRight ) ) $( "#result" ).append( "Range boundaries are not specified<BR/>" );
  if ( rangeLeft < 0 ) $( "#result" ).append( "Left boundary is less than 0<BR/>" );
  if ( rangeRight < 0 ) $( "#result" ).append( "Right boundary is less than 0<BR/>" );
  if ( rangeLeft > rangeRight ) $( "#result" ).append( "Left boundary is greater than the right boundary<BR/>" );
  return( !(
    rangeLeft < 0 ||
    rangeRight < 0 ||
    rangeLeft > rangeRight ||
    isNaN( rangeLeft ) ||
    isNaN( rangeRight )
  ) );
}

function clearDisplay() {
  $( "#result" ).html( "" );
  $( "#test" ).hide();
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <p>Type in minimum and maximum values and click <i>Generate</i>.</p>
    <INPUT id="rangeLeft" value=1 /> - <INPUT id="rangeRight" value=365 />
    <BR/>
    <BUTTON id="run">Generate</BUTTON>
    <pre><code id="result" /></pre>
    <div>
       <label><input type="checkbox" id="wholestring"/>Match whole string</label> <br/>
       <label><input type="checkbox" id="wb"/>Match within word boundaries</label><br/>
       <label><input type="checkbox" id="dgtb"/>Match when not enclosed with digits</label><br/>
       <label><input type="checkbox" id="whtb"/>Match when enclosed with whitespaces or start/end of string</label><br/>
       <label><input type="checkbox" id="allowzero"/>Allow leading zeros</label><br/>
       <label><input type="checkbox" id="neg"/>Optionally match negative numbers</label><br/>
       <label><input type="checkbox" id="frac"/>Optionally match fractional digits (floats)</label><br/>
    </div>
```

这里的大部分 JavaScript 代码都是从[Алгоритм для преобразования диапазона номеров в регулярное выражение](https://ru.stackoverflow.com/questions/245209)和[to-regex-range](https://www.npmjs.com/package/to-regex-range) npm 库借来的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-24T08:10:43.523

有可能虽然不漂亮。

```
\b(?:[1][1][0-9]|1\d{3}|223[0-4]|2[0-1]\d\d|2[0-2][0-3][0-4])\b 
```

我在 2006 年给 PCRE 的作者 Phillip Hazel 发了电子邮件，他对正则表达式中的数学的看法：

> 在您看来，这可能超出了项目的范围：将数字视为数字而不是文本的能力，这绝对是一个值得的功能。允许您对匹配的数字进行一些基本的数学检查，例如：第二个匹配的数字是更高还是更低，第三个数字是第一个数字的倍数，以及许多更复杂的情况，我不会详细说明只是为了让我的观点跨越. 你觉得这超出了文本匹配的范围吗？

我得到以下答复：

> 是的，我想我知道，而且，它不是 Perl 正则表达式中可用的东西。我知道 PCRE 确实有一些来自 Perl 的扩展，但没有比这更重要的了（你也许可以使用标注来破解一些东西，但这有点临时，而且无疑非常混乱！）。
> 
> 菲利普

我现在在 09 年完全同意。只需匹配所有数字并以您正在匹配的任何语言进行数字验证。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-31T10:42:16.863

此外，如果您想定位或查找您的路径名称是否包含年份，并将其作为字符串取出，您可以尝试以下操作：

```
path1 = r'X:\S\Something_2019\y2019\AB19778_description\subfolder1\subfolder2'
find = re.findall(r'.*(y[1-2][0,9][0-9]{2})', path1)
mystring = find[0]
print(mystring) 
```

如果存在格式为“yYYYY”的年份字符串，则检查“path1”。所以用字母'y'作为前缀（与我的研究案例相关）。这将返回字符串“y2019”。

# visual-c++ - VC90 调试 CRT 错误

> ID：676473
> 
> 赞同：0
> 
> 时间：2009-03-24T07:55:40.690
> 
> 标签：visual-c++, dll, debugging, crt

我在 VC++ 2008 中创建了一个 Dll。但它正在与其他一些软件 (VB) 一起使用。无法在 Labview 中加载该 dll 函数。VC90 Debug CRT 错误来了。为什么这个软件不支持我的dll？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T21:23:18.313

您是否使用调试目标编译了您的 DLL？如果是这样，它将无法在未安装 Visual Studio 的系统上运行。您必须发布以发布模式编译的 dll。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T08:15:59.877

您是否链接到动态 crt 并且无法确保它存在于目标计算机上？尝试静态版本（使用[/MT 而不是 /MD](http://msdn.microsoft.com/en-us/library/2kzt1wy3.aspx)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T21:02:59.843

你可以使用depends.exe (dependency walker) 找出一些原因。在您的情况下，您将在依赖walker 中选择labview.exe 并在依赖walker 中选择profile。

加载 dll 后，您可能会看到一些未加载的原因。

这个实际的链接将引导你到包括 profile 方法的依赖walker。 [http://www.dependencywalker.com/](http://www.dependencywalker.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-27T06:54:44.450

分发调试 CRT 并不是一个好主意，尤其是使用 VC++ 2008 编译的二进制文件/DLL。您的 DLL 需要同一目录中的 Debug-CRT-Dlls 的清单文件。

对于 VC 2008 SP1，情况更糟：您需要将清单文件修补到旧版本或在 stdafx.h 中使用 _BIND_TO_CURRENT_VCLIBS=1 以使 DLL 运行。

更多信息在：[应用程序不与 VS 2008 SP1 DLL 一起运行，以前的版本适用于 RTM 版本](https://stackoverflow.com/questions/59635/app-does-not-run-with-vs-2008-sp1-dlls-previous-version-works-with-rtm-versions)

# standards - 编写测试场景（或功能测试）的标准文档或软件

> ID：676484
> 
> 赞同：1
> 
> 时间：2009-03-24T08:02:26.557
> 
> 标签：standards, testing, scenarios

是否有编写测试场景（或功能测试/验收测试）的标准文档？也许软件可以输入场景并检查它们是否通过......

现在我们使用 Word 或 Excel 来执行此操作，但有一个系统来跟踪以前测试场景的结果会很有用。

谢谢，列文卡登

ps：测试是纯功能测试。我的意思是我们描述的场景稍后应该由不知道代码甚至项目的人执行。因此无法执行测试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T08:32:37.700

编写测试场景的标准方法可能是用例或用户故事形式。如果您想了解更多相关信息，Google 应该为您提供大量链接供您选择。

我只会提供更多线索供您调查-您的问题有点宽泛。

对于 Java 和 .net，有[FitNesse](http://fitnesse.org/)它允许您在某种 wiki 中编写测试场景，并且可以执行测试。

您可以研究[行为驱动开发](http://dannorth.net/introducing-bdd)，这导致开发一些框架来编写可执行的用户故事。例如Ruby 的[rspec](http://rspec.info/)似乎很受欢迎。[以下](http://behaviour-driven.org/Implementations)是许多其他平台的此类框架的列表。

# python - python中是否有任何内置的跨线程事件？

> ID：676485
> 
> 赞同：10
> 
> 时间：2009-03-24T08:04:41.200
> 
> 标签：python, events, delegates

python中是否有任何内置语法允许我将消息发布到我的问题中的特定python线程？就像 pyQt 中的“排队连接信号”或 Windows 中的 ::PostMessage()。我需要它用于程序部分之间的异步通信：有许多处理网络事件的线程，它们需要将这些事件发布到单个“逻辑”线程，该线程以安全的单线程方式转换事件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T12:11:51.353

[Queue](http://docs.python.org/library/queue.html)模块是 python 非常适合您所描述的内容。

您可以设置一个在所有线程之间共享的队列。处理网络事件的线程可以使用 queue.put 将事件发布到队列中。逻辑线程将使用 queue.get 从队列中检索事件。

```
import Queue
# maxsize of 0 means that we can put an unlimited number of events
# on the queue
q = Queue.Queue(maxsize=0)

def network_thread():
    while True:
        e = get_network_event()
        q.put(e)

def logic_thread():
    while True:
        # This will wait until there are events to process
        e = q.get()
        process_event(e) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T08:36:10.467

我不确定你在找什么。但肯定没有内置的语法。查看[队列](http://docs.python.org/library/queue.html) 和[线程](http://docs.python.org/library/threading.html)模块。有很多有用的东西，如队列、条件、事件、锁和信号量，可用于实现所有类型的同步和异步通信。

# asp.net - 继承自 asp:validationsummary

> ID：676489
> 
> 赞同：2
> 
> 时间：2009-03-24T08:05:15.237
> 
> 标签：asp.net, custom-server-controls, validationsummary

我需要在页面（或控件）顶部显示格式良好的错误消息。

因此我实现了一个新创建的服务器控件的渲染方法。新创建的控件继承自 ValidationSummary。

```
public class AgValidationSummary : ValidationSummary
{
    protected override void Render(System.Web.UI.HtmlTextWriter writer)
    {
        if(this.Enabled)
        {
            if (Page.IsPostBack && !Page.IsValid)
            { 
```

我现在的问题是，如果一个按钮被触发并且他的属性 CausesValidation 设置为 false 我的验证摘要将抛出一个异常，因为我询问 Page.IsValid 属性（并且只有在调用 Page.validate( ）。

有人解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-12T05:24:03.747

解决方案很简单：
只是不要解析`Page.IsValid`标志:)而是在你的`void Render(HtmlTextWriter writer)`：

```
if (!this.Enabled)
{
    return;
}

if (this.Page != null)
{
    this.Page.VerifyRenderingInServerForm(this);
}
else
{
    return;
}

var failedValidators = this.Page.Validators.OfType<BaseValidator>().Where(bv => string.Equals(bv.ValidationGroup, this.ValidationGroup) && !bv.IsValid).ToList();

if (failedValidators.Any())
{
    writer.Write(this.HeaderText);
    foreach (var failedValidator in failedValidators)
    {
        writer.Write(failedValidator.ErrorMessage);
    }
} 
```

这样做的原因：
导致回发的控件已经获得了关于

1.  原因验证
2.  验证组
3.  和其他东西

因此 ASP.net 引擎本身将执行相关的验证器并将它们设置为`IsValid`或不设置。

**编辑**
摆脱原始的 HeaderText （仍然呈现）：

```
protected override void AddAttributesToRender(HtmlTextWriter writer)
{
    // overwrite to hide the original HeaderText
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T08:19:40.117

也许您可以将 IsValid 属性保存在 ViewState 中，并将其初始化为 true。

在 Load 中，检查 IsValid 是否为 null，如果不为 null，请将 ViewState 中的 IsValid 设置为 Page.IsValid 中的值。

在 Render 中，从 ViewState 中读取 IsValid。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T11:50:05.587

我可能在这里偏离了轨道，但你不能在控件的构造函数中连接到页面的 Validate 事件吗？

如果需要，您可以有一个内部标志，渲染器会检查该标志是否要执行渲染代码中接下来发生的任何事情。

```
private bool _thePageIsBeingValidated = false;

public bool ShouldIDoMyThing
{
     get{ return (_thePageIsBeingValidated && this.Enabled && this.Page.IsPostback && this.Page.IsValid != null && this.Page.IsValid == false); }
} 
```

# wpf - WPF 媒体元素视频源

> ID：676497
> 
> 赞同：4
> 
> 时间：2009-03-24T08:09:52.497
> 
> 标签：wpf, wpf-controls, wmv

我尝试在 XAML 代码中设置视频源，视频无法播放：

```
<MediaElement x:Name="bgvideo" Width="800" Height="600"Source="/Videos/BG_LOOP_BIG.wmv" /> 
```

所以我尝试在代码隐藏中设置视频源，也不能播放。：

```
bgvideo.Source = new Uri(@"pack://application:,,,/Videos/BG_LOOP_BIG.wmv", UriKind.Absolute); 
```

或者

```
bgvideo.Source = new Uri(@"/Videos/BG_LOOP_BIG.wmv"); 
```

它只是在视频源绝对无限制时播放：

```
bgvideo.Source = new Uri(@"C:\SomeFolder\Videos\BG_LOOP_BIG.wmv"); 
```

**如何使用相对源设置视频源？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T08:45:56.450

这对我有用。添加 LoadedBehavior="手动"

```
<MediaElement LoadedBehavior="Manual" x:Name="bgvideo" Width="800" Height="600" Source="Videos/BG_LOOP_BIG.wmv" /> 
```

然后在后面的代码中你需要播放媒体

```
bgvideo.Play() 
```

您还需要丢失 uri 中的第一个“/”。

hth

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-10T10:22:24.267

```
<MediaElement x:Name="bgvideo" Width="800" Height="600"Source="Videos/BG_LOOP_BIG.wmv" /> 
```

这也有效，您只需将属性复制设置为复制时视频文件的输出目录（如果更新或始终复制）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T08:48:02.547

删除第一个斜杠：

:)

另外，据我所知，视频不能嵌入到程序集中。

# ruby - Haskell 通过 FFI 与 Ruby 绑定？

> ID：676498
> 
> 赞同：7
> 
> 时间：2009-03-24T08:10:02.200
> 
> 标签：ruby, haskell, ffi, libffi

由于 ruby​​ 和 Haskell 都支持 FFI，

*   是否可以通过 FFI 从 ruby​​ 调用 Haskell 代码？
*   Ruby 中是否有任何 Haskell 绑定？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-09-14T05:45:57.310

我对这个讨论有点晚了，但我目前正在编写 Ruby 和 Haskell 之间的桥梁。它位于[http://github.com/mwotton/Hubris](http://github.com/mwotton/Hubris) - 它是一个在 C 级别工作的绑定。不过，仍处于非常早期的发展阶段。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-03-12T02:56:45.717

GHC 6.12.1 支持在 Linux 上构建动态库。尝试类似：

### 例子.hs

```
{-# LANGUAGE ForeignFunctionInterface #-}

module Example where

import Foreign.C.Types

fibonacci :: Int -> Int
fibonacci n = fibs !! n
    where fibs = 0 : 1 : zipWith (+) fibs (tail fibs)

fibonacci_hs :: CInt -> CInt
fibonacci_hs = fromIntegral . fibonacci . fromIntegral

foreign export ccall fibonacci_hs :: CInt -> CInt 
```

### 包装器.c

```
#include <stdlib.h>

#include "HsFFI.h"

void
example_init (void)
{
  hs_init (NULL, NULL);
}

void
example_exit (void)
{
  hs_exit ();
} 
```

### 脚本.rb

```
require 'dl'
require 'dl/import'

module Example
    extend DL::Importable
    dlload "./libffi-example.so"
    extern "void example_init()"
    extern "void example_exit()"
    extern "int fibonacci_hs(int)"
end

Example.example_init

1.upto( 40 ) do | x |
    puts "#{ x } -> #{ Example.fibonacci_hs x }\n"
end

Example.example_exit 
```

### 生成文件

```
GHC=ghc-6.12.1

libffi-example.so: Example.o wrapper.o Example_stub.o
    $(GHC) -o $@ -shared -dynamic -fPIC $^ -lHSrts-ghc6.12.1

Example_stub.c Example_stub.h Example.o: Example.hs
    $(GHC) -c -dynamic -fPIC Example.hs

Example_stub.o: Example_stub.c
    $(GHC) -c -dynamic -fPIC Example_stub.c

wrapper.o: wrapper.c Example_stub.h
    $(GHC) -c -dynamic -fPIC wrapper.c

clean:
    rm -f *.hi *.o *_stub.[ch] *.so 
```

### 要运行的命令

```
make
ruby script.rb 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-24T16:20:48.760

我以前没见过，但这是可能的。

*   使用 Haskell 的 FFI 来包装[`libruby`](http://metaeditor.sourceforge.net/embed/). 您的主要可执行文件将用 Haskell 编写，它将调用`ruby_init()`和相关函数，以便在进程内运行 Ruby 解释器。不过，这确实允许您运行任意 Ruby 代码。
*   使用 Ruby 的 FFI 将 GHC 模块包装[为库](http://www.haskell.org/ghc/docs/latest/html/users_guide/ffi-ghc.html#ffi-library)。您的 Ruby 脚本必须调用`hs_init()`，并且只能访问`foreign export`ed 函数。

您需要编写胶水代码，其中一些是用 C 语言编写的，以使这两个选项中的任何一个都能正常工作。

*   在不同的进程中运行 Ruby 和 Haskell，使用一些 IPC 在它们之间进行通信。也许 XML-RPC ( [Haskell](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/haxr) / [Ruby](http://www.ruby-doc.org/stdlib/libdoc/xmlrpc/rdoc/index.html) ) 或 JSON ( [Haskell](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/json) / [Ruby](http://json.rubyforge.org/) ) 通过套接字，或者甚至可能只是使用您自己的自定义协议的管道。

我不知道你的要求是什么，但这就是我想要的——它更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T07:21:11.927

我不确定 Haskell 方面，但这里有一段来自 Mountain West Ruby Conf 09 的关于使用 Ruby 的 FFI 的很酷的视频。它看起来像一个非常漂亮的界面。

[http://mwrc2009.confreaks.com/13-mar-2009-16-10-ffi-jeremy-hinegardner.html](http://mwrc2009.confreaks.com/13-mar-2009-16-10-ffi-jeremy-hinegardner.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T06:22:38.400

@ephemient，我实际上正在寻找使用Ruby（高级+动态）作为主要控制器逻辑并调用haskell进行大量数据处理（功能+速度）的方法

我认为本机绑定几乎不存在，除了这条推文[http://twitter.com/BlurredWeasel/status/1321484127](http://twitter.com/BlurredWeasel/status/1321484127)

使用 JSON RPC 可能是最简单的实现方法，其中 ruby​​ 中有一个瘦包装器 (method_missing) 以通过 JSON/Socket 调用 haskell。

JSON 的优点是能够轻松地将原语映射到各种语言之间的本机类型。

```
class SciHs
  def method_missing(method, *args) 
     // json encode
     // request Haskell over tcp socket or unix pipes
     // json decode
  end
end 
```

ruby 中快速数字运算的其他替代方案（+ 功能风格）

*   ruby 中的 NArray 或其他科学库
*   GNU 科学库的 Ruby 绑定
*   或者转到 ruby​​ 1.9 并使用[YARV2LLVM](http://github.com/miura1729/yarv2llvm/tree/master)将计算逻辑 JIT 到 LLVM 中以更快地执行。

有人想吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T12:31:06.737

我完全尝试过这个（我是提到的推文中的那个）。

我没有想到 libruby 方法，但我花了相当多的时间尝试使用 ruby​​ 的 FFI 来包装从 haskell 导出的函数，并且永远无法将其完全连接到所有链接并运行。

如果您查看 haskell 的 FFI 示例，您会发现它们都包含一个 C main() 函数。由于 ruby​​ 的 FFI 没有（也不能有）main()，所以这行不通。如果你不这样做，你最终会出现奇怪的链接错误。

我可以与你分享我拥有的东西，在 freenode (cschneid) 或 twitter (BlurredWeasel) 上联系我。

# .net - 如何更改列表 数据到 IQueryable 数据

> ID：676500
> 
> 赞同：205
> 
> 时间：2009-03-24T08:10:25.757
> 
> 标签：.net, linq

> **可能重复：**
> [IList<T> 到 IQueryable<T>](https://stackoverflow.com/questions/73542/ilistt-to-iqueryablet)

我有一个 List 数据，但我想要一个 IQueryable 数据，是否可以从 List 数据到 IQueryable 数据？给我看代码

* * *

## 回答 #1

> 赞同：460
> 
> 时间：2009-03-24T08:12:37.013

```
var list = new List<string>();
var queryable = list.AsQueryable(); 
```

添加对以下内容的引用：`System.Linq`

# java - 强制转换在编译器/机器级别有什么作用？

> ID：676503
> 
> 赞同：8
> 
> 时间：2009-03-24T08:12:15.860
> 
> 标签：java, compiler-construction, casting

我经常想知道强制转换在编译器或机器级别到底做了什么。它对内存中的 0 和 1 有什么作用？

谁能指点我一些好的文学作品。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T08:18:08.203

在引用类型之间进行转换时，转换不会修改各个位，它只是指示编译器/运行时在可能的情况下以特定方式解释位。

如果由于类型不兼容而在编译时无法进行强制转换，则会发出错误。如果在运行时无法进行强制转换，则会引发异常。

关于类型转换的[wiki 页面](http://en.wikipedia.org/wiki/Type_conversion)有更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T08:59:16.683

在 C 中，对于非数字类型，强制转换对内存中的 0 和 1 没有任何作用。

对于数值类型，C 编译器会进行转换，以使数值尽可能保持不变。

如果您确实想在不更改位值的情况下转换数字类型，则必须使用联合或转换指针（以下代码说明了后者）：

```
float a;
int b = 3;

a = *((float*)&b); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T09:04:37.357

关于 Casting，一个有用的文献是[**JavaTM Virtual Machine Specification**](http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html)。

在[Conversions and Promotions](http://java.sun.com/docs/books/jvms/second_edition/html/Concepts.doc.html#25611)部分，您会看到有六种广泛的转换：

*   身份转换
*   扩大基元转换
*   缩小原始转换
*   扩大参考转换
*   缩小参考转换
*   字符串转换

有五种转换上下文可以发生转换表达式，包括[Casting Conversion](http://java.sun.com/docs/books/jvms/second_edition/html/Concepts.doc.html#18168)：

> 铸造上下文允许使用：
> 
> *   身份转换，
> *   扩大的原始转换，
> *   缩小的原始转换，
> *   扩大参考转换，或
> *   缩小参考转换。
> 
> 因此，强制转换比赋值或方法调用转换更具包容性：强制转换可以进行除字符串转换之外的任何允许的转换。
> 
> 强制转换可以将任何数值类型的值转换为任何其他数值类型。boolean 类型的值不能转换为另一种类型。引用类型的值不能转换为原始类型的值。
> 
> 一些强制转换可以在编译时被证明是不正确的，并导致编译时错误。否则，可以在编译时证明强制转换是正确的，或者需要运行时有效性检查。（有关详细信息，请参阅[JavaTM 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/conversions.html)。）
> **如果运行时的值是空引用，则允许强制转换。如果运行时检查失败，则抛出 ClassCastException。**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T13:26:50.410

其他人已经涵盖了基础知识，但我想就如何实现编译器说几句话，这可能对他的情况有所启​​发。

编译器维护程序中任何特定点使用的变量*名*列表（称为*符号表*）以及有关变量的一些信息。信息列表包括：

 **   他们分配的存储空间（在这个寄存器中，在那个内存位置，等等......）
*   它们是什么类型（即整数或字符串或`SubWhatsitObj`），包括任何限制（例如恒定性）
*   编译器需要的任何链接信息

编译器使用此信息来决定如何处理涉及变量的表达式。存储在符号表中的元信息类型也可以从其组件中为任何表达式派生。

除了数字类型转换的特殊情况外，强制转换只是告诉编译器对变量或表达式使用与通常情况*不同的元信息。*内存中的任何位都不会受到影响，但计算的结果可能会受到影响。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T08:17:51.637

假设这只是一个引用类型转换而不是转换（例如 int 到 byte），我相信它会执行以下操作：

1）检查引用是否为空 - 如果是，则退出。2）按照引用找到内存中的对象。在对象头中，有说明类型是什么的信息。3) 从类型信息中，检查目标类型是否在层次结构中。如果不是，`ClassCastException`请使用适当的信息抛出一个。

结果的“位”始终与输入的“位”相同（假设有*输出*而不是异常），但是 JVM 知道引用的类型，因此可以保证其他操作成功。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T08:34:24.340

这取决于你投什么。对于数字转换，（从浮点数到整数并返回），CPU 将尝试找到适合目标的最接近的数字。

对于类型案例，它对记忆没有任何作用。这只是软件开发人员告诉愚蠢的编译器某个变量一次应该被视为不同类型的一种方式。

我试图用谷歌搜索一些关于数字转换规则的信息，但周围没有太多信息。您可以尝试[C99 标准](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)，但我不确定它是否会让您不知所措。IIRC，规则是：

*   向下转换（大类型 -> 较小的类型，如 double -> float -> int -> byte）将切断无法表示的信息（因此 double->float 将失去精度，-> int 将失去所有小数位 +没有四舍五入）。

*   向上转换（较小的类型 -> 较大的类型）意味着用“0”填充额外的位。

当然，有些数字是您[无法真正表示](http://en.wikipedia.org/wiki/Numeric_(Data_Type)#Representable_numbers.2C_conversion_and_rounding)的（例如 0.1）。即使没有强制转换，对这些的任何操作都会丢失信息（这就是为什么 0.1*10 可以是！= 1.0）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T09:15:42.790

还需要了解引用在编译和运行时是如何工作的。

每种类型都为每种方法保存一个查找表，该查找表将每种方法解析为该类型最解析的方法。

因此，如果您的引用是一个调用 toString() 的对象，那么它会做正确的事情并找到最派生的 toString() 方法。强制转换对于允许运行时保证任何给定的引用确实具有引用上公开的每个方法的目标方法是必要的。在将类型转换从 X 传递到 Y 之后，可以确保任何类型 Y 的引用都可以在 casted(sp) 引用上使用。

# groovy - 无法让 Groovy AST 示例工作

> ID：676509
> 
> 赞同：5
> 
> 时间：2009-03-24T08:16:36.320
> 
> 标签：groovy, abstract-syntax-tree

我正在尝试学习如何使用（和扩展）groovy，并且我正在按照[此页面](http://groovy.codehaus.org/Local+AST+Transformations)中的示例进行操作。基本上，它展示了如何为 groovy 代码定义一个注释，让您可以连接到编译器进程。该示例围绕将导致在方法调用之前和之后打印行的编写和注释。

我的代码如下；首先是必要的进口：

```
package foo

import org.codehaus.groovy.transform.*
import java.lang.annotation.*
import org.codehaus.groovy.ast.*
import org.codehaus.groovy.control.*
import org.codehaus.groovy.ast.stmt.*
import org.codehaus.groovy.ast.expr.* 
```

然后，我们定义要使用的注解：

```
@Retention(RetentionPolicy.SOURCE)
@Target([ElementType.METHOD])
@GroovyASTTransformationClass(["foo.LoggingASTTransformation"])
public @interface WithLogging {
} 
```

然后是转换本身：

```
@GroovyASTTransformation(phase=CompilePhase.SEMANTIC_ANALYSIS)
public class LoggingASTTransformation implements ASTTransformation {

  public void visit(ASTNode[] nodes, SourceUnit sourceUnit) {
      println("visiting astnodes")
      List methods = sourceUnit.getAST()?.getMethods()
      // find all methods annotated with @WithLogging
      methods.findAll { MethodNode method ->
          method.getAnnotations(new ClassNode(WithLogging))
      }.each { MethodNode method ->
          Statement startMessage = createPrintlnAst("Starting $method.name")
          Statement endMessage = createPrintlnAst("Ending $method.name")

          List existingStatements = method.getCode().getStatements()
          existingStatements.add(0, startMessage)
          existingStatements.add(endMessage)
      }
  }

  private Statement createPrintlnAst(String message) {
      return new ExpressionStatement(
          new MethodCallExpression(
              new VariableExpression("this"),
              new ConstantExpression("println"),
              new ArgumentListExpression(
                  new ConstantExpression(message)
              )
          )
      )
  }
} 
```

最后，我应该使用这种转换的代码：

```
public class Foo {
   @WithLogging
   def f() { println "hello from f" }
}

f = new Foo()
f.f() 
```

现在，这应该打印*Starting f\n hello from f \n Ending f*，但它打印的只是*hello from f*（这就是我的问题）。正如您从代码中看到的那样，我还在转换本身中放置了一条*访问 astnodes*消息，希望看看它是否会到达那里，但可惜它没有（或者看起来如此）。

`groovy -version`印刷`Groovy Version: 1.6.0 JVM: 1.6.0_11`

任何人都可以尝试这段代码，看看它是否适用于他们的系统，或者给我一些关于可能出错的指示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T21:34:54.967

尝试更改假设使用转换的代码

```
public class Foo
{
   @foo.WithLogging
   def f() { println "hello from f"}
.... 
```

我尝试了相同的示例并在这里分享了我的经验[http://kartik-shah.blogspot.com/2009/03/groovy-16-ast-transformation-example_5323.html](http://kartik-shah.blogspot.com/2009/03/groovy-16-ast-transformation-example_5323.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-10T15:18:53.287

我在[这里](https://github.com/kurtharriger/groovy-ast-example)找到了github 上的工作示例

# c# - C#：在文本框的 keydown 事件中，如何检测当前按下的修饰符 + 键？

> ID：676518
> 
> 赞同：3
> 
> 时间：2009-03-24T08:19:44.563
> 
> 标签：c#

C#：在文本框的 keydown 事件中，如何检测当前按下的修饰符 + 键？

我做了以下操作，但我对这些运算符不太熟悉，所以我不确定我是否以及我做错了什么。

```
 private void txtShortcut_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Modifiers == (Keys.Alt || Keys.Control || Keys.Shift))
        {
            lbLogger.Items.Add(e.Modifiers.ToString() + " + " +
                "show non-modifier key being pressed here");
        }
    } 
```

1）如何检查 e 是否包含任何修饰键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T08:25:25.470

根据msdn[链接](http://support.microsoft.com/kb/839201)

```
private void txtShortcut_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Alt || e.Control || e.Shift))
        {
            lbLogger.Items.Add(e.ToString() + " + " +
                "show non-modifier key being pressed here");
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T08:22:49.987

[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.modifierkeys.aspx)说它是按位组合，但你正在做一个逻辑或 。

尝试：

```
if (e.Modifiers & (Keys.Alt | Keys.Control | Keys.Shift))
{
    lbLogger.Items.Add(e.Modifiers.ToString() + " + " +
        "show non-modifier key being pressed here");
} 
```

而且我认为您可以使用 e.KeyCode.ToString() 获取实际密钥。

# asp.net - 是否可以在同一个 Web 应用程序（相同的 url）上集成 Windows 并形成身份验证？

> ID：676520
> 
> 赞同：0
> 
> 时间：2009-03-24T08:22:27.910
> 
> 标签：asp.net, authentication

基本上我想构建一个将尝试 Windows 身份验证的 Web 应用程序，如果身份验证失败，那么将为用户提供登录表单？

我不想为不同的身份验证模式使用不同的 Web 应用程序。

这可能吗 ？我错过了一些关于这个的观点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T08:36:55.193

您可以进入 IIS 错误页面设置并将 401 错误的各种目标页面更改为指向 Windows 窗体登录页面。这样一来，用户就会为重定向到另一个页面的三个请求的身份验证尝试退出/失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-31T17:12:48.447

您可以设置多个指向同一文件夹的虚拟目录。一个 vdir 使用表单 auth，另一个使用集成。

# c# - 我的触发器在更新面板中不起作用？

> ID：676522
> 
> 赞同：2
> 
> 时间：2009-03-24T08:22:52.373
> 
> 标签：c#, .net, ajax, asp.net-ajax

我需要刷新 UpdatePanel3'content ，但如果我先点击 btnTranslate ，它不起作用，但第二次点击它有效吗？

```
 <asp:Button ID="btnTranslate" runat="server" OnClick="btnTranslate_Click" Text=">>"
                        class="buttons" ValidationGroup="ValidForm" />
                </td>
                <td>
                    <asp:UpdatePanel ID="UpdatePanel3" runat="server">
                        <ContentTemplate>
                            <asp:TextBox ID="txtResults" classs="txtBoxesMultyLine" runat="server" Height="266px"
                                TextMode="MultiLine" Width="363px"></asp:TextBox>
                        </ContentTemplate>
                        <Triggers>
                            <asp:AsyncPostBackTrigger ControlID="drpDatabases" EventName="SelectedIndexChanged" />
                            <asp:AsyncPostBackTrigger ControlID="drpProcess" EventName="SelectedIndexChanged" />
                            <asp:AsyncPostBackTrigger ControlID="btnTranslate" EventName="Click" />
                        </Triggers>
                    </asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-02T10:16:34.070

删除验证组。没有使用验证。

# sqlite - 如何在 SQLite 中分段更新 blob？

> ID：676524
> 
> 赞同：7
> 
> 时间：2009-03-24T08:24:50.183
> 
> 标签：sqlite, blob

我在 SQLite 应用程序中有大 blob，需要以分段方式更新这些 blob 的小段。就像说“用数据 D 更新 Blob B 的 X 到 Y 字节”，这可以在其他具有 Blob 操作函数的数据库中完成，但我找不到类似的 SQLite 东西，我被卡住了吗？或者 SQLite 有处理 Blob 的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T11:16:40.550

这不是您问题的直接答案，但我有一些在 SQLite 中使用随机访问（大）blob 的经验，如果可以的话，我建议您不要使用它。原因如下：

Blob 完全打破了 SQL 查询格式。如果您的 blob 数据需要任何类型的处理，它肯定会在某些时候需要过滤。无论您采用何种机制来处理 SQL 中的过滤，在这方面都是无用的。

处理与原始文件中的二进制数据相反的数据库中包含的二进制 blob 会限制您的选择。您将无法同时从多个进程随机读取和写入数据，这对于文件是可能的。您不能使用任何处理这些数据并且只提供文件 I/O 接口的工具。您不能截断或调整 blob 的大小。文件的用途更加广泛。

将所有内容包含在一个文件中似乎很方便，因为它简化了备份和传输，但使用 blob 的痛苦根本不值得。

因此，作为您的律师，我建议您将 blob 作为原始文件写入文件系统，并仅在数据库中存储对文件名的引用。如果您的 blob 很小并且保证不会增长，请忘记我的建议。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T09:38:08.243

SQLite 3.x 通过[sqlite3_blob_write](http://www.sqlite.org/c3ref/blob_write.html)函数支持这一点。

```
int sqlite3_blob_write(sqlite3_blob *, const void *z, int n, int iOffset) 
```

请注意，此函数是作为 SQLite 3 C/C++ API 的一部分提供的。您需要直接对此进行编程才能使用它。

如果您使用的是其他更高级别的包装器，例如 System.Data.SQLite，上次我查看时，您将无法访问此函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-29T14:01:10.567

我非常同意 paniq 所说的一切。使用 BLOB 会大大限制您的选择。

如果您使用的是 System.Data.SQLite，您将无法真正支持 BLOB。这就是我编写自己的类来处理它们的原因。您可以在此处找到代码：[示例 BLOB 代码](http://sqlite.phxsoftware.com/forums/storage/4/7372/Program.cs.txt)

请注意，对于那些敢于使用 BLOB 的人来说，SQLite 有几个潜在的陷阱。主要问题之一是 SQLite 在允许您检查它们的长度之前将整个 BLOB 字段加载到内存中。因此，如果您有大型 BLOB 字段，预计会有很多内存抖动...

# eclipse - Eclipse 代码中的本地化在哪里？

> ID：676529
> 
> 赞同：3
> 
> 时间：2009-03-24T08:27:27.243
> 
> 标签：eclipse, localization, rcp

我在 Eclipse RCP 应用程序中有一个贡献视图。此视图具有本地化名称 %view.name，并在 plugin.properties 文件中翻译为“我的视图部件”。

我正在研究 Eclipse 的源代码以了解国际化的工作原理。到目前为止，我还没有找到属性文件中的值在什么时候被读取并分配为视图的名称。

如果我从资源读取部分开始，我看到类 ManifestLocalization 读取了属性文件，但是我找不到它的使用位置。

如果我从名称分配开始，我会看到 TableReader 类获取了视图部分的名称，但它已经本地化了。我还看到 Eclipse 在某个时候将此 plugin.xml 转换为一些序列化对象。也许它是出于性能原因而完成的？

所以我的问题是，这个“%view.name”字符串是什么时候转换成“My View Part”的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T09:51:51.237

eclipse 中至少有两种支持本地化的机制：NLS 和`org.eclipse.core.runtime.registry.IConfigurationElement`. 您感兴趣的部分出现在 `IConfigurationElement`.

`IConfigurationElement.getAttribute(String key)`调用 时，该方法`ResourceTranslator.getResourceString()`使用 OSGi 清单中的 Bundle-Localization 标头来查找正确的属性文件（通常是`plugin${locale}.properties`）和属性文件中的条目。

您可以通过调用该`getAttributeAsIs(String key)`方法来获取 plugin.xml 文件中的实际内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T21:06:53.127

这可能因 Eclipse 的特定版本而异，但看起来翻译正在 ResourceTranslator.getResourceString(Bundle, String, ResourceBundle) 中发生

对于视图部分贡献，当插件清单作为 ExtensionRegistry.addContribution() 的一部分加载时会发生这种情况。

翻译的版本被缓存是正确的。如果您在我提到的方法中设置断点，您会注意到它们仅在首次初始化工作区时触发。为了使它们再次触发，您必须清除工作区的配置区域。

# java - java发送邮件的问题

> ID：676541
> 
> 赞同：0
> 
> 时间：2009-03-24T08:37:01.747
> 
> 标签：java, email

我的代码在我机器上的 Windows 服务器上运行，但是当我将相同的类文件上传到 Linux 服务器机器时，它不起作用。

由于没有错误生成，我无法得到确切的问题..

如果您可以帮助我，请参阅下面的代码。

```
public static String myemail = "xyz@abc.com", //username
mypassword = "*************", //password
myhost = "smtp.abc.com", // smtp address
myport = "234", // port address
mysubject = "Hello",
mytext = "this is just a test mail";

public String mail(String recp)
{

    Properties pro = new Properties();
    pro.put("mail.smtp.user", myemail);
    pro.put("mail.smtp.host", myhost);
    pro.put("mail.smtp.port", myport);
    pro.put("mail.smtp.starttls.enable","true");
    pro.put("mail.smtp.auth", "true");
    pro.put("mail.smtp.debug", "true");
    pro.put("mail.smtp.socketFactory.port",myport);

    SecurityManager security = System.getSecurityManager();

    try
    {
        Authenticator authen = new SMTPConfig();
        Session session = Session.getInstance(pro, authen);
        session.setDebug(true);

        MimeMessage msg = new MimeMessage(session);
        msg.setText(mytext);
        msg.setSubject(mysubject);
        msg.setFrom(new InternetAddress(myemail));
        msg.addRecipient(Message.RecipientType.TO, new
        InternetAddress(recp));
        Transport.send(msg);
    }

    catch (Exception ex)
    {
        ex.printStackTrace();
    }

    return null;

}

private class SMTPConfig extends javax.mail.Authenticator
{

    public PasswordAuthentication getPasswordAuthentication()
    {
        return new PasswordAuthentication(myemail, mypassword);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T09:08:04.540

尝试

pro.put("mail.debug", "true"); 而不是 pro.put("mail.smtp.debug", "true");

这可能会捕获所有邮件错误，然后您可以分析..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T08:58:11.257

您是否尝试以超级用户身份运行您的代码？也许它只是一些非特权用户问题。

# c# - 如何本地化 web.sitemap

> ID：676543
> 
> 赞同：1
> 
> 时间：2009-03-24T08:37:35.253
> 
> 标签：c#, asp.net, localization

> **可能重复：**
> [如何在 web.sitemap 中实现本地化](https://stackoverflow.com/questions/614484/how-to-implement-localization-in-web-sitemap)

我有一个站点地图文件，这是站点地图文件的一部分

我的资源文件名是 globalres.resx

任何人都告诉我如何做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T08:54:08.007

将在全局资源文件中找到的 resourceKey 添加到 siteMapNodes。

# c# - C#：如何在这个 keydown 事件中显示修饰键名称 + 非修饰键名称？

> ID：676544
> 
> 赞同：2
> 
> 时间：2009-03-24T08:37:42.353
> 
> 标签：c#

我正在使用此代码来检测修改键是否在文本框的 KeyDown 事件中被按住。

```
 private void txtShortcut_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Shift || e.Control || e.Alt)
        {
            txtShortcut.Text = (e.Shift.ToString() + e.Control.ToString() + e.Alt.ToString() + e.KeyCode.ToString());

        }
    } 
```

如果同时按下像字母 A 这样的非修饰键，我将如何显示实际的修饰键名称而不是 bool 结果，并且还显示在修饰键末尾按下的非修饰键？有没有办法在同一个 txtShortcut.Text = (); 线？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T08:45:09.730

您可以检查`Control.ModifierKeys`- 因为这是一个枚举，它应该更人性化。或者，只是

```
string s = (e.Shift ? "[Shift]+" : "") + (e.Control ? "[Ctrl]+" : "")
           + (e.Alt ? "[Alt]+" : "") + e.KeyCode; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T08:46:15.123

使用 ?: 运算符

```
txtShortcut.Text = (e.Shift? "Shift ": "") + (e.Control? "Control ": "") + (e.Alt? "Alt ": "")  + e.KeyCode.ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T08:46:27.650

您需要根据布尔值显示正确的字符串。要在单个语句中执行此类操作，请使用 ? ： 操作员：

```
txtShortcut.Text = (e.Shift ? "[Shift]" : string.Empty) + 
                   (e.Control ? "[Ctrl]" : string.Empty) + ...; 
```

一般来说，它是：

```
<someBool> ? <ifTrue> : <ifFalse> 
```

它适用于任何类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T08:56:07.580

如果您使用的是 .NET 3，您将需要使用[`KeysConverter`](http://msdn.microsoft.com/en-us/library/system.windows.forms.keysconverter.aspx)支持修饰键的本地化名称的类：

```
var kc = new KeysConverter();
var result = kc.ConvertToString(e.KeyCode); 
```

否则，您可以使用三元运算符自己完成：

```
var keys = (e.Shift ? "[Shift]+" : string.Empty)
             + (e.Control ? "[Ctrl]+" : string.Empty)
             + (e.Alt ? "[Alt]+" : string.Empty)
             + e.KeyCode; 
```

# apache - 对于 Apache，我如何分叉一个 Web 服务请求，以便两个应用服务器可以接收相同的请求？

> ID：676545
> 
> 赞同：1
> 
> 时间：2009-03-24T08:38:15.860
> 
> 标签：apache

我正在使用 Apache。如何分叉 Web 服务请求，以便两个应用服务器可以接收相同的请求？不用担心有太多的返回响应，因为两个 App Server 之一不会回复任何东西。我无法控制谁调用了 Web 服务，这意味着 SSI 页面已经失效。可以通过 Apache 配置而不是编写自定义处理程序来完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T09:09:45.257

您可以创建 SSI 页面，它会处理它。

索引.shtml

```
<!--#include virtual="/path/to/app1/index.php?$QUERY_STRING -->  
<!--#include virtual="/path/to/app2/index.py?$QUERY_STRING --> 
```

[http://httpd.apache.org/docs/2.2/mod/mod_include.html#includevirtual](http://httpd.apache.org/docs/2.2/mod/mod_include.html#includevirtual)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T08:42:33.980

一种方法是编写第三个代理应用程序，为请求提供服务，并对其他两个应用程序执行两个内部请求，返回所需的任何结果。

或者，使用[mod_perl](http://perl.apache.org/)（或用 C 编写的常规模块），您还可以安装一个[PerlAccessHandler](http://perl.apache.org/docs/2.0/user/handlers/http.html#PerlAccessHandler)，它可以拦截请求，向第一个应用程序发出子请求，然后让执行继续到第二个应用程序。

这是一个粗略的示例，说明您如何将它们组合在一起

```
 package MyApache2::MyProxy;

  use strict;
  use warnings;
  use Apache2::RequestRec ();
  use Apache2::Connection ();
  use Apache2::Const -compile => qw(FORBIDDEN OK);

  sub handler {
      my $r = shift;

      #prepare a user agent to make the request
      my $ua = LWP::UserAgent->new;
      $ua->agent("MyUserAgent/0.1");

      #make a request on the app1 domain with the same uri
      $app1url="http://app1.domain".$r->unparsed_uri();
      my $request = HTTP::Request->new(GET => $app1url);
      my $response = $ua->request($request);

      #check the outcome of the response
      if ($response->is_success) 
      {
          #check $response->content if you like
      }

      #tell apache it's ok to continue, falling through to app 2
      return Apache2::Const::OK;
  }

  1; 
```

现在您的 app2 vhost 可以通过在其配置中执行类似的操作来使用处理程序

```
<Location />
   PerlAccessHandler MyApache2::MyProxy
</Location> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T08:58:42.287

另一个（有点“肮脏”）的技巧是自动将 php 脚本添加到您启动第二个应用程序的第一个 web 应用程序。这种方法的缺点是在第一个应用程序启动之前，您必须等待 2° 应用程序终止。因此，这取决于应用程序的复杂性和速度。

```
.Htaccess code
php_value auto_prepend_file "learn.php" 
```

# msbuild - 为什么 Sandcastle 帮助文件生成器没有将 Msdn 缓存存储在指定文件夹中？

> ID：676546
> 
> 赞同：1
> 
> 时间：2009-03-24T08:38:23.990
> 
> 标签：msbuild, sandcastle

我正在尝试使用 Sandcastle Help File Builder 为我的应用程序构建文档。我将 Msdn 缓存组件添加到 .shfbproj 文件中，如下所示：

```
<ComponentConfigurations>
  <ComponentConfig id="Cached MSDN URL References" enabled="True" xmlns="">
    <component id="Cached MSDN URL References" type="SandcastleBuilder.Components.CachedResolveReferenceLinksComponent" assembly="{@SHFBFolder}SandcastleBuilder.Components.dll" locale="{@Locale}" linkTarget="{@SdkLinkTarget}">
      <cache filename="$(MsdnCachePath)" />
      <targets base="{@SandcastlePath}Data\Reflection" recurse="true" files="*.xml" type="{@SDKLinks}" />
      <targets files="reflection.xml" type="{@ProjectLinks}" />
    </component>
  </ComponentConfig>
</ComponentConfigurations> 
```

$(MsdnCachePath) 属性的值为：

```
<MsdnCachePath>$(MSBuildProjectDirectory)\Cache\MsdnUrl.cache</MsdnCachePath> 
```

问题是生成帮助文件后，此缓存文件未在此位置创建。有什么想法为什么不会发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T09:01:54.477

这是因为 ComponentConfigurations 部分不包含由 MSBuild 执行的 MSBuild 代码。ComponentConfigurations 是一个包含 XML 数据的属性，该数据将被传递给相关组件并由组件框架解析。这通过使用“SHFB”属性来表示，例如

{@SandcastlePath}

这不是 MSBuild 属性。因此，常规 $(..) 属性在此 xml 中不起作用。

# iphone - iPhone UIDatePicker 样式

> ID：676549
> 
> 赞同：2
> 
> 时间：2009-03-24T08:40:56.463
> 
> 标签：iphone, objective-c

有什么方法/技巧可以更改 uiDatePicker 的大小、字体、背景颜色等？甚至 backgroundcolor 属性也不起作用，并且选择器的默认样式与我的应用程序的设计无关 :(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:43:21.410

也许您可以改用 UIPickerView ？我见过人们使用图像作为背景使用它。不过，您必须编写所有日期逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:45:26.657

我不相信有办法。即使有，您的应用也可能会因此而被拒绝。

# asp.net - 将资源文件编译到库时出现问题

> ID：676552
> 
> 赞同：2
> 
> 时间：2009-03-24T08:41:57.647
> 
> 标签：asp.net, globalization, resgen, al.exe

我有一个内置在 asp.net 中的 Web 应用程序，它使用资源文件来支持多种语言。我遇到的问题是我只能在 Visual Studio 中添加一个新的语言文件，并且我必须重新构建整个应用程序才能包含一种新的语言。在网上搜索后发现资源文件的编译可以在.net编译器中完成。我使用了以下命令：

resgen.exe /编译 langfile.en.resx

al.exe /out:en\App_GlobalResources.resources.dll /culture:en /embedresource:langfile .en.resources

该文件被复制到网站的文件夹中，但它不起作用。我的意思是，当我从网页中选择新语言时，字符串会从默认资源文件中加载。如果我在 VS 中创建资源文件，它可以正常工作。我检查了两个dll文件的大小，一个是VS生成的，一个是我自己编译的，大小一样，但是编译出来的不行。我只能认为也许我必须在上面的命令中使用一些其他参数，但我真的不知道。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T10:26:39.430

您可以通过编写自己的表达式构建器而不是使用内置资源版本来实现您想要的，并从数据库或 XML 文件中提取信息。基本上，您编写自己的类继承自 System.Web.Compilation.ExpressionBuilder，然后在 Web.config 中注册它，如下所示：

```
<compilation>
  <expressionBuilders>
    <add expressionPrefix="CustomResources" type="CustomResourcesExpressionBuilder"/>
  </expressionBuilders>
</compilation> 
```

然后你可以像普通资源一样引用它：

```
<%$ CustomResources:Section, Key %> 
```

[您可以在此处](http://msdn.microsoft.com/en-us/magazine/cc163849.aspx)和[此处](http://jason.diamond.name/weblog/2006/01/10/a-configurable-resources-expression-builder)找到一些关于此的文章。

# c# - 如何快速学习 C#？

> ID：676556
> 
> 赞同：-1
> 
> 时间：2009-03-24T08:44:49.760
> 
> 标签：c#, asp.net

我希望成为一名优秀的 C# 开发人员（尤其是 .NET 环境（即 Windows 应用程序和 Web 应用程序））。

建议我实现相同的方法.....可能是书籍，杂志，期刊，代码示例等。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-24T08:50:12.120

除非您已经在另一种语言/平台方面拥有丰富的经验，否则您所说的“快速学习”和“优秀的开发人员”这两个要求在某种程度上是正交的。最终使您成为一名优秀开发人员的因素是使用语言和 .NET 框架的经验，以及与其他优秀且可以帮助您改进的人一起工作的经验。[这需要数年时间](http://norvig.com/21-days.html)；没有捷径。

也就是说，书籍是熟悉语言的好方法，它们从[相当基本的](http://oreilly.com/catalog/9780596514822/)书籍到[相当高级](http://www.manning.com/skeet/)的书籍，因此有一个阅读过程。此外，阅读博客将帮助您快速了解该语言的各个方面（我特别推荐[Eric Lippert 的](http://blogs.msdn.com/ericlippert/)文章，尽管其中一些主题非常高级）。并且在这样的论坛上阅读甚至开始回答问题也会增加和测试你的知识。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-24T08:50:21.947

我建议从 C# 的绝对核心部分开始 - 了解类型系统、字符串、数字、IO、集合等。我会亲自使用控制台应用程序来做这件事，在这些应用程序中你几乎不需要那么多代码来获得结果与 GUI 一样，您可以专注于您正在尝试学习的主题。

在书籍方面，[C# 3.0 in a Nutshell](https://rads.stackoverflow.com/amzn/click/com/0596527578)非常好。如果你真的不是一个控制台类型的人，[Head First C#](https://rads.stackoverflow.com/amzn/click/com/0596514824)可能会在你的街道上 - 这不是我喜欢的风格，但许多其他人喜欢它。但是，请确保您获得最新的打印，因为许多错误已得到纠正。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T08:48:07.210

我建议：**书籍、杂志、期刊、代码示例等**

说真的，我建议书和练习。有很多书可以帮助您入门，可能都差不多。然后，当您掌握了基础知识并想要一个快速指南以了解其真正的工作原理时，[这个就相当不错了](http://www.amazon.co.uk/C-Depth-What-need-master/dp/1933988363/ref=sr_1_1?ie=UTF8&s=books&qid=1237884560&sr=1-1)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T08:51:30.493

开始开发可以使用 C# 的应用程序

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T08:54:38.520

加入一家使用它的公司，并加入一个由优秀开发人员组成的团队。让其中一位成为你的导师。一周内你会学到比书籍、指南等更多的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T09:33:54.900

Charles Petzold 制作了他的优秀著作“.Net Book Zero”，可从以下网址下载：

[http://www.charlespetzold.com/dotnet/](http://www.charlespetzold.com/dotnet/)

我推荐这本书作为你的起点，这是一本不错的读物，而且他的写作风格很容易解析。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T08:49:32.777

取决于，您是否已经是一名优秀的开发人员，如果是，您只需要学习语法，否则从底部开始。使用 MSDN 阅读代码片段并使用 codeproject

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T08:51:24.223

我发现非常有帮助的两本书是[Programming C#](https://rads.stackoverflow.com/amzn/click/com/0596527438)和[C# in Depth](https://rads.stackoverflow.com/amzn/click/com/1933988363)。这些书面向具有其他语言经验的开发人员，如果您经验不足，它们可能不会有帮助。其他一些答案可能对刚开始学习编程的人有更好的建议。

您可能想要获得[Visual C# 2008 Express](http://www.microsoft.com/express/vcsharp/)。它是免费的且功能非常齐全，您可以快速轻松地开始试验代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-24T08:54:03.997

取决于你的背景（例如，你是从另一种 OO 语言转换过来的，比如 Java 或 C++），但是通过大量的练习你不会出错——也许给自己设置一个项目（你会从中受益） ) 实施并为此努力。

如果您以前没有太多面向对象编程的经验，那么阅读（以与语言无关的方式）主要原则可能会很有用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-24T09:07:09.410

好吧，我认为最大的障碍不是学习 C#，而是获得编写商业 Windows 软件和 Web 软件的经验。

您可能会争辩说，良好的开发实践与语言无关，只有通过实际端到端开发项目的经验才能真正获得。

然而，话虽如此，我最好的建议是开始学习和实践面向对象的设计模式和实践，然后将它们应用于特定目的，例如设计和维护一个 ASP.net 网站。

这将帮助您体验使用 C# 进行开发的复杂性，并让您深入了解如何调试以及与 IIS 等关键操作系统进行交互。

您可能很快会发现，单独掌握 C# 是不够的。例如，要构建一个像样的 ASP.net 网站，您可能还必须了解一些数据库（或数据存储的替代方法）。

最后，阅读博客和 MSDN 文章可能非常有益，但它通常适用于当月的当前风格。我会建立一个具体的目标来实现，并着手研究实现它的设计和策略。

此外，请查看一些[Microsoft 模式和实践材料](http://msdn.microsoft.com/en-us/practices/default.aspx)- 它涵盖了广泛的主题，其中许多包括设计模式和策略，它们可能对您学习绳索有所帮助。[在Code Plex](http://www.codeplex.com)和[Code Project](http://www.codeproject.com)上还可以找到很多“示例”项目（尽管对代码项目持保留态度）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-24T09:21:17.287

我已经在回答类似问题时推荐了这个网站。尝试[C# 站](https://csharp-station.com/Tutorial/CSharp/SmartConsoleSetup.aspx)。它让我开始了，也可能对你有所帮助。然而，成为一名优秀的开发人员是一项多年的任务。最重要的是经验，你不会从书籍、杂志或在线资源中获得经验……

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-24T09:41:43.680

[从MSDN](http://msdn.microsoft.com/en-us/vcsharp/aa336766.aspx)学习 C# 。我收集了很多教程和视频。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-24T09:49:05.487

我还想推荐 madman1969 的帖子 ( [http://www.charlespetzold.com/dotnet/](http://www.charlespetzold.com/dotnet/) ) 中提到的 Charles Petzolds “.NET Book Zero”。它是免费的，而且非常好。

我的一个朋友将 Petzold 写的另一本书描述为“老派的深度知识”——在下载了他的 .NET Book Zero 之后，我完全明白他的意思。它从基础开始 - 一个控制台“hello World”应用程序，并描述了非常详细但总是易于理解（有时真的很有趣），它是关于什么的。

你真的应该检查一下，我在工作时打印了我的（嘘！），然后在当地的复印店把它剪下来装订了。总成本：3 欧元。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-24T09:53:13.730

尝试[http://www.learnvisualstudio.net/](http://www.learnvisualstudio.net/)并提供出色的视频列表以快速学习 c#

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-24T10:23:58.370

简单的一步一步：

首先想到的首先你必须拥有的是MSDN库；从 MSDN 库离线或 MSDN 库在线。由于我在印度尼西亚的带宽有限，我选择离线版本。有关于 C# 的文档和许多示例。我必须从互联网上下载一些示例。

你必须知道其中的逻辑。我认为它是所有软件开发语言的基础。学习面向对象编程，尤其是当今的编程语言。在 C++ 中，你会看到像多重继承；在 C# 中你没有；没有。

学习泛型，特别是如果你想玩至少 .NET 2.0

从基本的 C# 语法开始，使其成为控制台、桌面和 Web 中的一些 hello world 程序。基本输入/输出就像一个输入和输出。

学习高级，如集合、实现接口、委托、属性、反射、语句、运算符、事件驱动等。修改了你的 hello world 程序，以便你可以使用它。

从简单的应用程序开始，例如控制台、Web 和 Windows 中的待办事项列表。这个简单的待办事项列表只需从输入中输入数据并列出要做什么。使用数据库来存储和检索数据的高级应用程序。在这里您将学习 ADO>NET

学习设计模式。您将看到 .NET 中使用设计模式的基类库。这对于使用 C# 进行设计非常有用。

学习异步原理，如多线程、多处理或其他概念，如锁定和解锁。

学习IO和网络原理。这很好，因为大多数开发将使用句柄文件、复制文件或连接到其他服务器。

学习使用注册表、配置文件或其他技术进行配置。

研究 Windows 和 .NET 中的安全概念。你可以在technet、微软知识库和MSDN中看到

尝试从您所在城市的测试提供商那里获得测试 070-536 的认证并获得 MCP 头衔。这对你有好处:)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-07-04T20:05:09.697

我认为一次了解两个不同的世界是非常困难的。只需专注于一件事，无论是网络还是桌面。我认为您应该阅读这本书：来自 Apress 的 Illustrated C# 2008。它会打开你的心扉。您将学习 C# 以及 OOP。这将使您的基础更牢固。在此之后，您可以去任何地方，无论是 Web 还是桌面应用程序开发。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-08-02T20:50:43.820

Nr 1 选择： [Head First C#](http://www.amazon.de/Head-First-Guides/dp/1449380344/ref=sr_1_1?ie=UTF8&qid=1343940453&sr=8-1)

如果您想学习并且是 c# 新手，最好的书。

# vb.net - 无法使用 Visual Basic Power Pack 部署应用程序

> ID：676566
> 
> 赞同：1
> 
> 时间：2009-03-24T08:48:51.170
> 
> 标签：vb.net, visual-studio-2008

我在我的应用程序中包含电源包，现在当我尝试将其部署到其他一些没有 Visual Studio (2008) 的 Win-XP 机器时遇到问题，尽管我在安装包中包含了它的 DLL。

DLL 是“C:\Program Files\Common Files\Microsoft Shared\Visual Basic Power Packs\1.1\Microsoft.VisualBasic.PowerPacks.Vs.dll”，我只是将它复制到安装路径中。

我错过了什么？

请查看我得到的错误：http: [//gomidjets.com/cc.JPG](http://gomidjets.com/cc.JPG) [http://gomidjets.com/ccerror.JPG](http://gomidjets.com/ccerror.JPG)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:38:02.547

您不能只复制 power pak dll，因为它有一些依赖项。您需要确保使用设置或部署项目来分发您的应用程序。

如果您使用的是 Power Pak 2.0，那么您想在[此处查看自述文件](http://download.microsoft.com/download/1/f/b/1fbba5cb-53d2-4bcd-862c-b91d4122cd63/Visual_Basic_2005_PowerPacks_2_Readme.htm#Deployment_Issues)

从安装文件内部看，Power Paks 使用 GAC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T21:12:44.790

所以回顾一下，你想发布一个应用程序。因此，您单击工具栏中的构建并发布。遵循向导后，错误意味着您无法在没有 Visual Studio 的任何其他机器上运行该程序？

您使用的是免费（快速）版吗？如果是这样，我认为您拥有的版本不允许您发布到除具有 Visual Studio 的计算机之外的任何其他计算机。我试图在非视觉工作室计算机上安装我的一个程序，但它没有工作......

如果您有试用版，我真的无法帮助您...

# iphone - 如何在 iPhone SDK 中使用标签栏控制器设置视图出口

> ID：676567
> 
> 赞同：5
> 
> 时间：2009-03-24T08:48:54.197
> 
> 标签：iphone

我在 Xcode 中创建了一个简单的选项卡栏应用程序。

默认选项卡栏有 2 个选项卡栏项目。我添加了第三个选项卡栏项并将其视图控制器属性设置为我创建并随后保存的名为 ThirdView.xib 的视图。

当我尝试运行时，前两个默认选项卡工作正常。我添加的第三个引发了这个错误：

```
 *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', 
reason: '-[UIViewController _loadViewFromNibNamed:bundle:] loaded the "ThirdView" nib but 
the view outlet was not set.' 
```

我很抱歉，因为我是一个巨大的 iPhone-SDK n00b，但是没有任何点击和拖动以及控制点击拖动的方式允许我在我创建的第三个视图上设置视图出口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:19:12.497

10分钟前我遇到了类似的问题，它是未保存的xib文件:)。由于某些原因，XCode 在一次运行时不会要求保存 xib 文件。

但如果不是这种情况，我会仔细检查视图是否确实连接在 xib 文件中。

为此，将 ThirdView.xib 作为纯文本文件打开（右键单击 > 打开为 > 纯文本文件）并搜索文本：">view<"。如果视图已连接，您应该会找到类似于以下代码的内容：

```
<object class="IBConnectionRecord">
    <object class="IBCocoaTouchOutletConnection" key="connection">
        <string key="label">view</string>
        <reference key="source" ref="372490531"/>
        <reference key="destination" ref="191373211"/>
    </object>
    <int key="connectionID">15</int>
</object> 
```

如果您找不到它，这可能意味着问题是由 Interface Builder 中的错误引起的。然后您可以尝试手动添加连接。让我知道是否是这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T09:19:27.603

检查您传递给 initFromNib 的文件名（或者您正在加载控制器）。拼写错误或包含扩展名可能会导致此消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-16T11:05:16.913

使用 XCode 4，我收到此错误，因为我没有为选项卡栏控制器上的“第三”按钮设置 NIB 名称。我通过选择“第三”按钮而不是按钮内的选项卡栏项目来修复它，并使用属性检查器设置了 NIB 名称。

# ruby-on-rails - Rails RESTful 应用程序中的分页和排序

> ID：676571
> 
> 赞同：1
> 
> 时间：2009-03-24T08:50:02.557
> 
> 标签：ruby-on-rails, rest, sorting, pagination

关于如何在 Rails 应用程序中对资源实现排序和分页并仍然保持 RESTful 的任何提示？

如何以干净的方式映射页码和排序字段的参数？（我目前正在为我的应用程序中的每个资源使用*map.resources :x ）*

我应该知道的任何其他性能问题？（例如缓存）

提前致谢。

**编辑**我将问题重新表述为更[通用](https://stackoverflow.com/questions/776448/pagination-in-a-rest-web-application)的问题，希望我能得到更多答案。我将投票关闭这个，因为它不再相关。感谢 insane-dreamer 和 vrish88 的回答。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-18T15:04:53.350

Have you tried will_paginate? Is there some reason it doesn't meet your specific needs? ([http://github.com/mislav/will_paginate/tree/master](http://github.com/mislav/will_paginate/tree/master))

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T10:08:18.033

我建议你看看这篇文章：

[http://dev.nozav.org/rails_ajax_table.html](http://dev.nozav.org/rails_ajax_table.html)

[http://dev.nozav.org/ajaxtable/](http://dev.nozav.org/ajaxtable/) *（这是演示应用程序）*

我在我的一个应用程序中使用了相同的基本代码。我没有使用他们描述的 AJAX 实现，但我使用了他们提到的排序助手，然后我构建了我的视图以启用排序。在排序助手中，您只想取出与 ajax 相关的东西。我的最终看起来像这样：

```
def sort_link_helper(text, param)
  key = param
  key += "_reverse" if params[:sort] == param
  parameters = params.merge({:sort => key, :page => params[:page], :action => controller.action_name })
  link_to(text, url_for(parameters))
end

def sort_td_class_helper(param)
  result = 'class="sortup"' if params[:sort] == param
  result = 'class="sortdown"' if params[:sort] == param + "_reverse"
  return result
end 
```

这个实现最好的部分是 RESTful、DRY 和易于使用！

# c++ - 将项目推送到 STL 容器后的段错误

> ID：676575
> 
> 赞同：4
> 
> 时间：2009-03-24T08:51:01.667
> 
> 标签：c++, memory, memory-management, stl, pointers

```
typedef struct temp  
{  
        int a,b;  
        char  *c;  
        temp(){ c = (char*)malloc(10);};  
        ~temp(){free(c);};  
}temp;  

int main()  
{  
   temp a;  
   list<temp>   l1;  
   l1.push_back(a);  
   l1.clear();  
   return 0;  

} 
```

给出分段错误。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-24T08:58:04.550

您没有复制构造函数。

当您将“a”推入列表时，它会被复制。因为您没有复制构造函数（为 c 分配内存并从旧 c 复制到新 c） c 是 a 中的相同指针和列表中 a 的副本。

两个 a 的析构函数都被调用，第一个将成功，第二个将失败，因为 c 指向的内存已被释放。

您需要一个复制构造函数。

要查看发生了什么，请在构造函数和析构函数中添加一些 cout，然后逐步执行代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T08:59:20.757

你需要一个深拷贝构造函数来避免双重释放（）。您有一个*临时类*（*a*）的变量，然后将其添加到列表中。变量被复制。然后你清除列表，里面的元素被销毁并调用 free()。然后*一个*变量被销毁并且 free() 被再次调用相同的地址导致分段错误。

您需要一个复制构造函数来深度复制类临时变量，这将 malloc() 另一个缓冲区并复制数据。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T08:59:40.147

在您调用`l1.push_back(a)`“a”的第二个副本时，是复制构造的。结果，现在有两个类认为它们拥有原始 malloc 调用的内存，当第二个被删除时，它会尝试释放第一个删除的内存。

解决方案是添加一个复制构造函数来处理类的实例实际上并不拥有数据这一事实。通常，您可以通过某种形式的引用计数来做到这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T09:02:54.477

除了给出的修复之外，您应该避免在 C++ 中使用 malloc/free。在您的特定情况下，我会使用向量：

```
#include <vector>

 typedef struct temp  
{  
        int a,b;  
        std::vector<char> c;  
        temp(){ c.reserve(10);};  
}temp;  

int main()  
{  
   temp a;  
   list<temp>   l1;  
   l1.push_back(a);  
   l1.clear();  
   return 0;  

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T09:02:11.187

如果您不想添加复制构造函数，则可以考虑指向值的指针列表而不是值列表。

```
list<temp*>   l1;
l1.push_back( new temp() ); 
```

但是您必须手动删除列表中的每个对象以防止内存泄漏。

结构中的 a,b 成员也未初始化。当心。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T09:32:58.337

除了复制构造函数之外，在这种情况下也提供一个 = 运算符是明智的。

```
struct temp {   // typedef is implicit in C++
  int a,b;
  char * c;

  // Constructor
  temp() { c = malloc(10); }
  // Destructor
  ~temp() { free(c); }
  // Copy constructor
  temp(const temp & x) { c = malloc(10); setTo(x); }
  // Operator =
  temp & operator = (const temp & x) { setTo(x); return *this; }

  // Initialize THIS to X
  void setTo(const temp & x) { a = x.a; b = x.b; memcpy(c,x.c,10); }
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T08:59:01.257

您需要一个复制构造函数和一个赋值运算符 - 存储在 STL 集合中的内容存储为副本，并且可以在向量更改大小时重新分配。

从您的代码中很难确切地看出复制构造函数的语义应该是什么，但至少分配一些内存是很容易的，这样（如果没有别的）析构函数有一些东西可以释放。如果没有更多类的详细信息，赋值运算符同样难以指定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T09:01:50.873

您需要为`temp`. 现在，当您推`a`入列表时会发生什么是副本`a`。副本（调用它`a2`）通过说初始化`a2.c = a.c`。这意味着两者都`a`指向`a2`同一个内存块。当调用它们的析构函数时，该内存块被释放两次，导致分段错误。

鉴于您发布的内容，复制构造函数可能应该是这样的：

```
temp::temp (temp const &rhs)
{
    this->a = rhs.a;
    this->b = rhs.b;
    this->c = (char *) malloc (10);
    memcpy (this->c, rhs.c, 10);
} 
```

这假设`c`指向的内容始终是 10 个字符长...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-24T10:32:47.270

这段代码的另一个问题是额外的分号

```
temp(){ c = (char*)malloc(10);};
~temp(){free(c);}; 
```

最好删除它们：

```
temp(){ c = (char*)malloc(10);}
~temp(){free(c);} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-24T10:58:32.530

具有“STL”标签但缺乏 STL 是导致问题的原因，这真是太讽刺了。

# vim - Vim 搜索和替换选中的文本

> ID：676600
> 
> 赞同：128
> 
> 时间：2009-03-24T09:02:20.640
> 
> 标签：vim

假设我们有一个文本，我进入可视模式并选择一些文本。如何快速搜索突出显示的文本并将其替换为其他内容？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-03-24T09:12:16.777

尝试执行以下或放入您的`.vimrc`

```
vnoremap <C-r> "hy:%s/<C-r>h//gc<left><left><left> 
```

通过在可视模式下按`ctrl`+ `r`，系统将提示您输入要替换的文本。按`enter`，然后确认您同意`y`或拒绝的每项更改`n`。

此命令将覆盖您的寄存器`h`，因此您可以选择其他`h`不使用的（通过将上面的命令更改为另一个小写字母）。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-04-10T19:39:18.147

这种快速简单的映射搜索视觉突出显示的文本（不覆盖 h 寄存器）并且不使用终端相关 + 寄存器：

```
" search for visually hightlighted text
vnoremap <c-f> y<ESC>/<c-r>"<CR> 
```

如果您不喜欢 ctrl-f 将其更改为您的偏好

突出显示文本后，您`s`只需键入以下内容即可随时进行替换：

```
%s//<your-replacement-string> 
```

...因为对`s`命令的空白搜索使用最后搜索的字符串。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2013-07-12T09:50:20.960

这也有效（至少对于单行中的选择/不包含任何特殊字符的选择）

*   在可视模式下选择文本
*   拉出文本`y`
*   `:s/<C-r>0/`

`0`是 yank 寄存器。

正如其他人提到的，有更快的方法可以做到这一点，但如果你刚刚开始学习 Vim（像我一样），这是“通用”方法之一。

//编辑：我刚刚意识到，如果`/`选择中有制表符或换行符或字符之类的字符，则“注册”方法将失败（我必须以某种方式手动处理这些字符才能使`:s`命令起作用）：

![在此处输入图像描述](https://i.stack.imgur.com/4xQ4t.png)

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2011-05-29T23:51:08.063

除非您的视觉选择中有特殊字符，否则接受的答案效果很好。我将两个脚本（[Jeremy Cantrell](https://stackoverflow.com/questions/676600/vim-replace-selected-text/677918#677918)发布在此处和[Peter Odding](http://peterodding.com/code/vim/profile/autoload/xolox/escape.vim)的）一起编写了一个命令，该命令使您可以直观地选择要查找的字符串，即使其中包含特殊的正则表达式字符。

```
" Escape special characters in a string for exact matching.
" This is useful to copying strings from the file to the search tool
" Based on this - http://peterodding.com/code/vim/profile/autoload/xolox/escape.vim
function! EscapeString (string)
  let string=a:string
  " Escape regex characters
  let string = escape(string, '^$.*\/~[]')
  " Escape the line endings
  let string = substitute(string, '\n', '\\n', 'g')
  return string
endfunction

" Get the current visual block for search and replaces
" This function passed the visual block through a string escape function
" Based on this - https://stackoverflow.com/questions/676600/vim-replace-selected-text/677918#677918
function! GetVisual() range
  " Save the current register and clipboard
  let reg_save = getreg('"')
  let regtype_save = getregtype('"')
  let cb_save = &clipboard
  set clipboard&

  " Put the current visual selection in the " register
  normal! ""gvy
  let selection = getreg('"')

  " Put the saved registers and clipboards back
  call setreg('"', reg_save, regtype_save)
  let &clipboard = cb_save

  "Escape any special characters in the selection
  let escaped_selection = EscapeString(selection)

  return escaped_selection
endfunction

" Start the find and replace command across the entire file
vmap <leader>z <Esc>:%s/<c-r>=GetVisual()<cr>/ 
```

如果这对任何人都更有用，我已将其包含在我的[vimrc中。](https://github.com/bryankennedy/vimrc)

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2017-03-25T22:04:24.617

从 Vim 7.4 开始，您可以使用`gn`选择与当前搜索模式匹配的文本区域的动作。

使用`cgn`改变当前选中匹配中的文本（或`dgn`删除）后，在普通模式下，您可以使用`.`重复该命令并对下一个匹配进行操作。

Vimcast有[一集](http://vimcasts.org/episodes/operating-on-search-matches-using-gn/)展示了这个功能。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-05-08T04:20:59.003

Mykola Golubyev，感谢您的提示！以下使用“+”寄存器（取决于您的终端）已经包含突出显示的文本，而不是使用“h”寄存器。

```
vnoremap <C-r> <Esc>:%s/<C-r>+//gc<left><left><left> 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-11-30T21:21:11.520

来自[http://vim.wikia.com/wiki/Search_and_replace_in_a_visual_selection](http://vim.wikia.com/wiki/Search_and_replace_in_a_visual_selection)：

当文本被视觉选择时，按 : 输入命令。命令行会自动输入范围：

```
:'<,'> 
```

您可以输入诸如 s/red/green/g 之类的命令，以将最后一个视觉选择的所有行中的每个红色替换为绿色。该命令将显示为：

```
:'<,'>s/red/green/g 
```

要对先前选择的块重复 Ex 命令，请使用：历史记录。也就是说，按 : 然后 ，然后编辑上一个命令。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-24T15:27:53.130

我的 vimrc 中有这个：

```
function! GetVisual() range
    let reg_save = getreg('"')
    let regtype_save = getregtype('"')
    let cb_save = &clipboard
    set clipboard&
    normal! ""gvy
    let selection = getreg('"')
    call setreg('"', reg_save, regtype_save)
    let &clipboard = cb_save
    return selection
endfunction

vmap <leader>z :%s/<c-r>=GetVisual()<cr>/ 
```

这将抓取视觉选择并使用它启动替换命令。

编辑：我应该指出，这不适用于多行视觉选择。虽然 GetVisual() 返回它没有问题，但我不确定如何正确地将它放入命令行。如果有人对我如何做到这一点有任何提示，请发表评论。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2020-07-08T02:21:09.940

我希望 Vim 中有一个内置的方法来替换一个单词，而不必首先重新输入这个单词。有，尽管它只适用于不超过单词边界字符的文本。

将鼠标悬停在单词上后，按`*`或`#`突出显示该单词并跳转到它的下一个/上一个位置（如果您不想更改文件中的位置，请按相反的键返回到该位置你刚刚在）。

然后只需键入：

`%s//<your-replacement-string>`

正如另一个人的回答中提到的，如果`%s`在斜杠之间收到一个空白条目，那么它使用之前搜索过的单词。通过按`*`或`#`，您正在搜索光标下的单词，使其成为最近搜索的单词。

最后，执行此操作只需 6 或 7 次击键 + 替换词的长度，并且不需要宏或编辑您的`.vimrc`.

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-01-10T14:08:18.107

其他答案很好，但它们不会转义特殊字符。@brian kennedy的[答案](https://stackoverflow.com/a/6171215/5152114)显示了一种逃避的方法，但它需要很多代码。例如，对于 URL，转义是强制性的，否则搜索将在“：”处停止。

如[vim.fandom.com/wiki/Search_for_visually_selected_text](https://vim.fandom.com/wiki/Search_for_visually_selected_text)中所写，您可以使用 oneliner 来搜索和转义某些字符。你可以转义你想要的字符，我选择了转义`/\:` ：

```
vnoremap // y/\V<C-R>=escape(@",'/\:')<CR><CR> 
```

使用此地图，我必须`//`在可视模式下按以在整个缓冲区中搜索当前选定的文本。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-24T09:06:56.103

我认为你不能开箱即用地做到这一点。但是很多人喜欢这个功能，所以有很多宏之类的（我自己添加的）。[**例如，这**](http://vim.wikia.com/wiki/Search_for_visually_selected_text)是您可以添加的一个；只需按下`*`即可在视觉选择的文本上搜索下一个匹配项。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-10-02T14:57:16.080

我最喜欢的短版是

vnoremap s/ y:s/"/

然后你可以突出显示一个选择，然后点击 s/ 来启动它的替换命令。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-07-01T22:01:10.660

我没有代表发表评论，所以我要添加另一个答案...

`vnoremap <C-r> "0y<Esc>:%s/<C-r>0//g<left><left>`

@dmd 和 @dotancohen：这对我有用而没有用完`"h`（明确使用 0，无论如何这是最后一个 yank 位置）并且适用于 putty ssh -> mint (lmde)；不知道分。还使用@Niloct 和@Nathan Friend 评论来删除确认。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-07-26T06:35:25.947

示例 1\. 用星号引用选择，将光标保持在选择的开头。

```
:%s,\%#\%V\_.*\%V/,**&**,c 
```

示例 2\. 使用 base64 管道选定的文本：

```
:%s!\%#\%V\_.*\%V!\=system("base64 -w 0",@")!c 
```

解释 LHS：

```
\%# matches cursor 
\%V matches inside the selection only
\_. matches any character.
\_.* matches beginning to end of selection. 
```

解释 RHS：

```
\=expr()  Replace match with result of expr() for each substitution. 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-03-10T15:37:02.183

这是 Mykola 答案的一个变体。我喜欢从当前行到文本结尾，然后从开头到当前行（本质上循环从当前行而不是开头开始）进行替换。

```
vnoremap <C-r> "hy:.,$s/<C-r>h//gc \|1,.&& <left><left><left><left><left><left><left><left><left><left><left> 
```

首先，从当前行到文本末尾进行替换`.,$`，然后从开头到当前行重复`\|1,.&&`。11`<left>`将光标放在正确的位置。

# windows - Qt GUI 内部 - 小部件绘画？

> ID：676601
> 
> 赞同：4
> 
> 时间：2009-03-24T09:02:53.900
> 
> 标签：windows, macos, qt, user-interface, widget

我使用 QT 已经有一段时间了，我一直想知道有关在 Windows 中绘制 GUI 的方式。
它真的是使用 QPainter 自己绘制所有按钮、编辑框、组合框、复选框、选项卡等，还是以某种方式使用本机小部件？

它可以进行自定义样式和蒙皮的事实表明它确实使用 QPainter 绘制了所有内容，但是如何维护这种代码呢？Qt 开发人员真的对窗口系统的全部功能进行了逆向工程吗？是不是有点浪费？
另一个证据是，如果我在 Qt gui 上使用 Spy++，那么所有窗口都显示为类名等于“QWidget”。如果它使用的是本机小部件，这些不应该是“按钮”、“静态”等吗？

在其他平台上呢？它在 Max OSX 中也做同样的事情吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T15:43:21.737

在 Windows XP 和 Vista 上（显示设置设置为 Classic 时除外），通过[QWindowsXPStyle](http://doc.trolltech.com/4.5/qwindowsxpstyle.html)和[QWindowsVistaStyle](http://doc.trolltech.com/4.5/qwindowsvistastyle.html)绘制的小部件实际上使用低级主题特定绘图 (uxtheme.dll)，因此例如按钮看起来像原生按钮。在旧版本的 Windows 上，Qt 通过[QWindowsStyle](http://doc.trolltech.com/4.5/qwindowsstyle.html)模拟小部件绘画。

Mac OS X 上的情况类似，其中[QMacStyle](http://doc.trolltech.com/4.5/qmacstyle.html)依赖外观管理器来委派小部件的低级绘制。

对于 X11，通常 Qt 使用自己的风格绘制，并具有某些模拟某些窗口系统的风格，例如[QMotifStyle](http://doc.trolltech.com/4.5/qmotifstyle.html)与 Motif 具有相似的外观，但没有实际加载，并且依赖于 Motif 环境。然而，当在 GNOME 下运行时，Qt 可以选择通过[QGtkStyle](http://doc.trolltech.com/4.5/qgtkstyle.html)使用本机 Gtk+ 主题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T10:16:13.287

QWindowsXPStyle[文档](http://doc.trolltech.com/4.5/qwindowsxpstyle.html#details)有这样的说法：

“警告：此样式仅在 Windows XP 平台上可用，因为它使用了 Windows XP 的样式引擎。”

[Qt Wikipedia 页面](http://en.wikipedia.org/wiki/Qt_%28toolkit%29#Use_of_native_UI-rendering_APIs)有这样的说法：

“使用原生 UI 渲染 API

Qt 过去常常模拟其预期平台的本机外观，这偶尔会导致该模拟不完善的地方出现轻微差异。Qt 的最新版本使用不同平台的本地 API 来绘制 Qt 控件，因此不会遇到此类问题。 [24] （另请参阅 wxWidgets，它使用原生 API 来实现大多数小部件功能。）"

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-21T17:16:58.647

Qt 确实绘制了所有小部件本身（无论是使用平台主题 API 还是“原始”GDI/X/等都无关紧要）。如果它使用本机小部件（如 wxWindows 那样），几乎不可能连接到样式以更改最细微的细节，更不用说使用现成的小部件在顶部添加自定义功能了。

# c# - 如何在 C# 中使用变量调用对象的属性，例如 customer.&fieldName

> ID：676608
> 
> 赞同：3
> 
> 时间：2009-03-24T09:07:38.163
> 
> 标签：c#

在 C# 中有一种方法可以使用变量调用对象的属性，如下所示：

```
string fieldName = "FirstName";
Console.WriteLine(customer.&fieldName); 
```

## 回答：

太好了，感谢您的快速回答，这就是我想要做的：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;

namespace TestLinqFieldIndex
{
    class Program
    {
        static void Main(string[] args)
        {
            List<Customer> customers = new List<Customer>();
            customers.Add(new Customer { ID = 1, FirstName = "Jim", LastName = "Smith" });
            customers.Add(new Customer { ID = 2, FirstName = "Joe", LastName = "Douglas" });
            customers.Add(new Customer { ID = 3, FirstName = "Jane", LastName = "Anders" });

            var customer = (from c in customers
                            where c.ID == 2
                            select c).SingleOrDefault();

            string[] fieldNames = { "FirstName", "LastName" };
            foreach (string fieldName in fieldNames)
            {
                Console.WriteLine("The value of {0} is {1}.", fieldName, customer.GetPropertyValue(fieldName));
            }

            Console.ReadLine();
        }
    }

    public class Customer
    {
        public int ID { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }

        public string GetPropertyValue(string fieldName)
        {
            PropertyInfo prop = typeof(Customer).GetProperty(fieldName);
            return prop.GetValue(this, null).ToString();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T09:11:37.480

您可以使用反射来做到这一点。

```
PropertyInfo prop = typeof(Customer).GetProperty ("FirstName");
Console.WriteLine (prop.GetValue (customer, null)); 
```

甚至还可以检索私有财产的价值。为此，您必须查看`GetProperty`接受绑定标志的重载方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T09:13:36.213

你不能开箱即用。你必须使用`PropertyInfo`对象和反射：

```
Apple myApple = new Apple("Golden Delicious", Ripeness.Fresh);

// ...

var p = typeof(Apple).GetProperty("Variety");
Console.WriteLine(p.GetValue(myApple, null)); // "Golden Delicious" 
```

请注意，C# 4 将提供对动态属性访问和其他优点的支持。但我想你不想等那么久。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T09:11:36.733

您可以将所述对象的属性值存储在字典中，并提供从类外部对该字典的访问，或使用反射。除此之外，我想不出办法来做到这一点。

但是，几乎无论解决方案如何，您都会失去类型安全性。你实际上想要完成什么？

您可能会发现解决此问题的正确方法是使用类似策略模式的方法。这样，您将使用属性的逻辑封装到知道它们需要哪些属性的类中，然后在运行时决定要实例化哪些策略类并将其传递给您的对象。

正如 Frederik 在下面所说，您可以使用反射，但再次出现类型安全参数，您可能会发现在设计时遇到无法立法的运行时错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T09:16:52.243

只需使用反射 API。

下面的示例说明了如何检索返回字符串的属性的值：

```
public string GetValue(string propertyName, object MyInstance)
{
  Type instanceType = typeof(MyInstance);
  // Set the BindingFlags depending on your property type or simply skip them.
  PropertyInfo pi = instanceType.GetProperty(propertyName, BindingFlags.Instance | BindingFlags.Public | BindingFlags.DeclaredOnly);

  // If this is an indexer property, provide the index as the second parameter,
  // else just supply null.
  return (pi.GetValue(MyInstance, null).ToString());
} 
```

# thickbox - 关闭厚盒并再次打开它

> ID：676609
> 
> 赞同：4
> 
> 时间：2009-03-24T09:07:39.677
> 
> 标签：thickbox

我正在尝试使用厚盒做一个向导，第一次打开它时效果很好。当我单击下一步时，我想关闭我打开的 div 并在thickbox 中打开一个新的，但它是如何完成的？我已经尝试了以下代码，但它只是关闭了厚盒并且不会再次打开它：

```
tb_show("", "#TB_inline?height=280&width=620&inlineId=divStart", "");
tb_remove();
tb_show("", "#TB_inline?height=280&width=620&inlineId=divContinue", ""); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-11T05:22:29.683

您可以使用以下代码：

//不要使用 tb_remove() 函数

```
$("#TB_window").remove();
$("body").append("<div id='TB_window'></div>");
tb_show("", "#TB_inline?height=280&width=620&inlineId=divContinue", ""); 
```

如果您使用 iframe 加载内容：

```
var p = parent;
p.$("#TB_window").remove();
p.$("body").append("<div id='TB_window'></div>");
p.tb_show("", "#TB_inline?height=280&width=620&inlineId=divContinue", ""); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:21:12.443

我来到这个答案页面，并尝试了这里提出的解决方案。它不起作用。我使用了我的一个老把戏，几乎每次都奏效了。尽管这篇文章已有 3 年多的历史，但我还是想分享其中的窍门。诀窍是使用 window.setTimeout 来延迟对下一个 tb_show() 的调用。

```
window.setTimeout(function(){
    tb_show("", "#TB_inline?height=300&width=300&inlineId=confirmDiv&modal=true");
    $("#TB_window").css({'border':'0px', 'background':'none'});
    },300); 
```

另请注意我使用的另外两个技巧：

1.  我想显示一个模态弹出窗口。HTML 位于 ID 为“confirmDiv”的 div 中。但它显示了带有标题和填充的通常的厚框。所以第二行从 TB_Window 中移除了边框和背景颜色，它只显示了弹出的 HTML。

2.  我还使用了 300 像素的一般高度宽度，尽管我的弹出窗口只有 250 像素。即使内容稍大一点，这也会阻止滚动条。TB_Window 无论如何都没有显示，所以没关系。

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T09:52:38.943

我自己找到了答案。我打开了一个包含所有步骤的 div，然后通过 javascript 决定要显示什么 div。

# licensing - 在出售软件许可证之前，我需要了解什么？

> ID：676610
> 
> 赞同：6
> 
> 时间：2009-03-24T09:07:47.287
> 
> 标签：licensing, contract, data-protection

我开发了一个基于 Web 的应用程序，一家公司对许可感兴趣。我怀疑他们打算挪用他们想要的功能，并添加到他们现有的代码库中，所以许可证可能是一次性的。由于它是在运行时解释的，所以我必须交出源代码，而且我不能立即以任何方式保护它。

为了增加一层复杂性，我有许多用户表示有兴趣将其用作服务，因此我一直在努力开发基于订阅的版本。这是一个利基市场，因此增长潜力有限，但我不想卖空它。

我通常每小时出售我的服务，所以我不知道关于许可代码的第一件事。

我正在努力解决的问题是：

1.  我应该收取什么费用？
2.  商业软件许可证是什么样的？
3.  我如何保护我的工作？

我敢肯定还有几十个我应该问的。我应该考虑什么？

提前致谢。

——谢谢大家的回复——

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T19:44:55.843

1.  我应该收取什么费用？最终，你必须达到一个你们都可以接受的数字。首先询问买家将从使用您的产品作为指导中获得什么价值。这可能比你想象的要多。

2.  商业软件许可证是什么样的？它可以说您想说的任何内容，以及一堆标准的合法样板。正如其他人所说，找一位专门从事软件知识产权的律师。问问题，如果他们一直说他们必须研究它，这可能是寻找另一位律师的迹象。

    在您去找律师之前，请对您的目标有一个清晰的认识。这里有几点需要考虑：

    *   你想给对方什么。他们可以什么/如何使用您的产品。
    *   责任限制
    *   保修单。你想提供什么保证
    *   支持。您将提供什么支持。费用。
    *   终止。许可证将如何终止以及终止时会发生什么
    *   知识产权。谁拥有什么
    *   争议将如何解决
    *   任务。他们能否将协议转让给其他人。如果是在什么条件下
3.  我如何保护我的工作？如果你不能信任对方，你可能不应该这样做。正如 Aaron 所说：“*如果您可以信任某人，则不需要合同。如果您不能信任他们，则合同无法拯救您*。” 您可以编写您想要的所有合同和许可证，但如果出现问题，提起诉讼将是一件痛苦的事情。最好不要一开始就处于那个位置，或者至少要确保潜在的收益抵消了风险。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-24T09:29:22.760

回答这个问题：你害怕什么？他们“偷”你？正如我们德国人所说：如果您可以信任某人，则不需要合同。如果你不能信任他们，合同也救不了你。

所以坐下来想想这会给你带来什么额外的好处。如果公司喜欢你的软件，他们是否有兴趣付钱给你以适应他们的需求？你能从他们那里得到其他有偿工作吗？还是永久雇佣你？是否有一家公司已经解决了这个问题并且愿意让你参与其中？

但正如 shooner 所说，如果你想把它作为一个人的节目来运行，请咨询律师。版权法一团糟，永远不要忘记一件事：世界由律师和法院统治。如果你不对这些力量做出正确的牺牲，它们会毁了你的生活。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T09:16:17.657

见律师。如果您将许可证和/或来源出售给另一家公司，您需要小心在交易结束时您可能欠或可能不欠的款项。

从这个角度来看，你可以打赌公司有律师。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T09:33:29.753

真的见到了非常称职的律师。除了合同明确规定的内容外，还有许多规定——法律和行为可能暗示一些您可能不知道的非常有趣的事情。如果你不好好照顾它们，这暗示着事情会给你带来真正的痛苦。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T19:13:30.937

*请咨询专门从事该领域*的律师。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-04T10:42:34.500

个人能够出售他的软件的机会很小。考虑使用其中一种开源许可证免费赠送它。这可能会大大增加您的软件用户的数量，并可能将其中一些变成购买客户（即产品支持或定制）。

# javascript - 组织数据的最佳方式

> ID：676614
> 
> 赞同：0
> 
> 时间：2009-03-24T09:10:51.133
> 
> 标签：javascript, sql, ajax

JavaScript 采用由 4 个连字符分隔的 id 和由 4 个连字符分隔的标题的字符串，并向我的 C# Web 服务请求 JSON 数据。然后，C# Web 服务创建一个状态为“待定”的跟踪器，并等待用户确认跟踪器，然后才能在下一个请求中提供 json。

当用户确认跟踪器时，将出现 4 个标题的下拉列表，以选择最合适的匹配项。确认从表单中选择的标题后，下拉菜单将传递给 Web 服务中的 ActionResult，该操作会将跟踪器的状态设置为“实时”，并将与标题关联的 id 添加到跟踪器的 ID 列。

我这样做的方式是让 JavaScript 在 REST 请求中将 4 个 ID 和标题作为两个单独的字符串发送，然后以相同的格式将它们添加到行中的一列，然后在将它们添加到下拉列表。

这是一个示例： --数据-- **ID，TITLE**
**SDJFJKLS83** 
，Photoshop Digital Photographers Voices Matter
SDJFKS94k4，Adobe Photoshop CS4 课堂手册
DJFB443B34，Adobe 65014838 Photoshop CS4 升级
SDFHSKBF22，Adobe 65015634 Photoshop CS4

**javascript 发送到服务为：**
ids="SDJFJKLS83-SDJFKS94k4-DJFB443B34-SDFHSKBF22";
title="Photoshop 数码摄影师的声音问题-Photoshop CS4 课堂书-obe 65014838 Photoshop CS4 升级-Adobe 65015634 Photoshop CS4";

url = [http://myurl/service/ids/title](http://myurl/service/ids/title)

**服务在 SQL 表中创建新的 Tracker 行**
TrackerID：4
**Ids：** SDJFJKLS83-SDJFKS94k4-DJFB443B34-SDFHSKBF22
**标题：** Photoshop 数字摄影师 Voices Matter-Photoshop CS4 Classroom Book-obe 65014838 Photoshop CS4 Upgrade-Adobe 65015634 Photoshop
**用户：** randomperson13
**总请求：**最后1
**个请求：** 2009-03-24 20:12:45.310
**状态：** 0

The service then shows a drop down list with all the titles for the user to select one. Tracker is updated to "live" status and the Id's column is cleared and filled with only one ID and same with the titles column.

The service can use the single ID and title the user select to get data from another SQL table.

--

Basically what I want to know is if there is a better way to store the ID's and associated titles instead of delimited in one datarow.

Sorry if this was a really long post :)

Thank You.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T09:41:26.397

Create a trackeritems table like:

```
ItemID TrackerID   Code          Title
1        1       SDJFJKLS83  Photoshop Digital Photographers Voices Matter
2        1       SDJFKS94k4  Adobe Photoshop CS4 Classroom Book
3        1       DJFB443B34  Adobe 65014838 Photoshop CS4 Upgrade
4        1       SDFHSKBF22  Adobe 65015634 Photoshop CS4

```

And keep a separate trackers table like:

```
TrackerID     User         Requests    LastRequest             Status
   4       randomperson13     1      2009-03-24 20:12:45.310     0

```

Then use SQL to select all the items with the right trackerID, and use a join if you want details from both tables.

# scala - 为什么 Scala 的不可变 Set 在其类型上不是协变的？

> ID：676615
> 
> 赞同：98
> 
> 时间：2009-03-24T09:11:01.210
> 
> 标签：scala, set, covariance, scala-collections

**编辑**：根据原始答案重新编写了这个问题

该类`scala.collection.immutable.Set`的类型参数不是协变的。为什么是这样？

```
import scala.collection.immutable._

def foo(s: Set[CharSequence]): Unit = {
    println(s)
}

def bar(): Unit = {
   val s: Set[String] = Set("Hello", "World");
   foo(s); //DOES NOT COMPILE, regardless of whether type is declared 
           //explicitly in the val s declaration
} 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-24T18:34:16.317

`Set`由于集合作为函数背后的概念，它的类型参数是不变的。以下签名应该稍微澄清一下：

```
trait Set[A] extends (A=>Boolean) {
  def apply(e: A): Boolean
} 
```

如果`Set`在 中是协变的，则由于函数的逆变性 `A`，该`apply`方法将无法采用类型参数。可能是*逆变*的，但是当你想做这样的事情时，这也会导致问题：`A``Set`*`A`*

 *```
def elements: Iterable[A] 
```

In short, the best solution is to keep things invariant, even for the immutable data structure. You'll notice that `immutable.Map` is also invariant in one of its type parameters.

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2011-05-31T04:49:17.753

at [http://www.scala-lang.org/node/9764](http://www.scala-lang.org/node/9764) Martin Odersky writes:

> "On the issue of sets, I believe the non-variance stems also from the implementations. Common sets are implemented as hashtables, which are non-variant arrays of the key type. I agree it's a slightly annoying irregularity."

So, it seems that all of our efforts to construct a principled reason for this were misguided :-)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-24T10:45:02.577

**编辑**：对于任何想知道为什么这个答案似乎有点偏离主题的人，这是因为我（提问者）已经修改了这个问题。

Scala 的类型推断足以确定在某些情况下您需要 CharSequences 而不是 Strings。特别是，以下在 2.7.3 中对我有用：

```
import scala.collections.immutable._
def findCharSequences(): Set[CharSequence] = Set("Hello", "World") 
```

至于如何直接创建 immutable.HashSets：不要。作为实现优化，少于5个元素的immutable.HashSets实际上并不是immutable.HashSet的实例。它们是 EmptySet、Set1、Set2、Set3 或 Set4。这些类是 immutable.Set 的子类，但不是 immutable.HashSet。

# session - 枚举特定终端服务器会话的打印机

> ID：676616
> 
> 赞同：2
> 
> 时间：2009-03-24T09:11:04.283
> 
> 标签：session, terminal-services, enumerate, printers

我正在寻找一种方法来查看特定用户已将哪些打印机映射到他或她的 TS 会话中。

如何使用 WMI（通过 PowerShell）或 VB-Script 实现这一点？有没有我不知道的内置方式？

**编辑**：在我们的 RDP 客户端对本地打印机的构造映射中被禁用。用户通过 VBS 脚本在登录期间创建他们的打印机，并在注销期间删除。

因此，我们的 TS 服务器上没有直接安装打印机，查询 Win32_Printers WMI 类不会返回任何内容。打印机安装在专用的打印服务器上。查询该服务器上的打印机会返回所有打印机，而不是为单个用户映射的打印机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-20T15:12:51.627

感谢 Remko 的评论，我被引导到了正确的方向，并最终制作了一个满足我需要的脚本。

基本上，该脚本确定用户的 SID 并在用户的注册表配置单元 ( **HKEY_USERS\$sid\Printers\Connections** ) 中查找已创建的打印机。

这是快速而肮脏的powershell脚本：

```
$server = 'servername'
$userName = 'username'

$regHKLM = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey("LocalMachine", $server)
$regProfileList = $regHKLM.OpenSubKey("SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList")

foreach ($sid in $regProfileList.GetSubKeyNames())
{
    $profileImagePath = $regProfileList.OpenSubKey($sid).GetValue("ProfileImagePath")
    if ($profileImagePath.EndsWith("\$userName"))
    {
        $regHKU = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey("Users", $server)
        $regUser = $regHKU.OpenSubKey("$sid\Printers\Connections")
        foreach ($printer in $regUser.GetSubKeyNames())
        {
            $printer.Replace(",", "\")  # backslashes are replaced with commas, revert that
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T14:41:54.037

我现在无法签入 TS 会话，但这通常在 powershell 中执行：

获取 WMIObject Win32_Printer

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-15T08:43:55.777

从这里：[http ://www.microsoft.com/technet/scriptcenter/guide/sas_prn_tart.mspx?mfr=true](http://www.microsoft.com/technet/scriptcenter/guide/sas_prn_tart.mspx?mfr=true)

```
strComputer = "."
Set objWMIService = GetObject("winmgmts:" _
 & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
Set colInstalledPrinters = objWMIService.ExecQuery _
 ("SELECT * FROM Win32_Printer")
For Each objPrinter in colInstalledPrinters
 Wscript.Echo "Name: " & objPrinter.Name
 Wscript.Echo "Location: " & objPrinter.Location
Next 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-05T13:00:21.493

您可能需要基于 CUPS 的技术吗？对于任何 unix 上的杯子来说，这都是简单的任务，但我不确定 Windows。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-05T11:36:02.830

这对我起到了作用

[http://www.geekshangout.com/vbs-script-to-list-the-network-printers-a-user-is-connected-to/](http://www.geekshangout.com/vbs-script-to-list-the-network-printers-a-user-is-connected-to/)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-24T10:07:46.630

据我了解，您可以阅读注册表中的某些字段。

PS：我更喜欢用Linux做终端服务；）

# java - Java注解可以进行单元测试吗？

> ID：676620
> 
> 赞同：15
> 
> 时间：2009-03-24T09:12:33.953
> 
> 标签：java, tdd, annotations, bdd

我最近开始创建自己的注释并运动 TDD/BDD，我想对我的注释进行单元测试以为它们创建一个清晰的规范。然而，由于注释基本上只是花哨的接口，据我所知不能真正直接实例化，有没有什么办法可以通过反射来对注释进行单元测试？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-24T09:22:35.397

注释有一些影响（否则，使用它们将毫无意义）。所以不要测试注释的存在，但它应该具有的效果。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-24T09:28:33.573

我通常不会为此编写测试，但您可以简单地创建一组使用和滥用注释的测试类，以测试它是否存储其成员值、它是否具有正确的默认值等。

当然，这仅适用于在正确目标上指定的运行时注释。

以我的经验，注释本身很少有足够的兴趣来保证单元测试——通常是使用它们的代码需要测试。但是我不是来自 100% 代码覆盖率的思想流派:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T09:19:02.907

如果您的注释定义正常，您可以进行单元测试：它是否可以应用于有效的元素集，如果需要，它是否在运行时可用，默认值是否正确初始化？然后，稍后，对将处理您的注释的类进行单元测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T09:18:19.243

您不能直接测试它们，因为正如您所指出的，没有什么可以测试的。不过，您可以证明一些事情：

*   代码中带有注释的对象在运行时具有任何预期的注释
*   默认值已初始化
*   注释绑定到您期望的内容

**当您进行单元测试时，您可以证明的一件事是您的实现符合接口。**因此，如果注释暗示了某些行为或属性（例如`Serializable`，事物确实应该是可序列化的），那么您也希望在测试中表示这一点。

# apache-flex - Flash 网站的浏览器滚动条

> ID：676623
> 
> 赞同：1
> 
> 时间：2009-03-24T09:14:18.427
> 
> 标签：apache-flex, flash

我已经完全在 Flash 中制作了一个页面（flex actionscript 项目），并且由于奇怪的原因，在使用小窗口浏览器（低分辨率或未最大化）打开时不应该缩放；在这种情况下，我需要激活浏览器滚动条才能显示完整的 Flash 应用程序。

怎么可能呢？

注意：我不想在 flash 中实现滚动方法（如 flash 滚动条，或与鼠标位置相关的滚动条），我只想召唤浏览器滚动条。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T09:21:16.820

只需嵌入具有固定（不成比例）尺寸的闪光灯。如果它大于浏览器窗口，则会出现滚动条。

还要确保包含 swf 的 html 元素足够大以显示整个 flash，或者没有将其`overflow`css 属性设置为`hidden`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T09:17:35.050

要显示滚动条，您可以试试这个。

```
html {
     overflow: -moz-scrollbars-vertical;
     overflow: scroll;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T09:32:04.610

StageScaleMode.NO_SCALE

StageAlign.TOP_LEFT

? 也许它应该发生在 SWF 内部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T13:13:46.150

我想这就是你要找的：[http ://swffit.millermedeiros.com/](http://swffit.millermedeiros.com/)

> 当您的浏览器窗口大于所需的最小尺寸时，swffit 会自动将您的 Flash 调整为 100% 的宽度和 100% 的高度（全出血），并在浏览器窗口较小时将 Flash 调整为所需的最小尺寸......它还可以调整如果浏览器窗口大小大于最大大小，则将 flash 电影设置为最大大小...

# asp.net-mvc - 使用 LINQ 的 ASP.NET MVC 服务层更新

> ID：676628
> 
> 赞同：0
> 
> 时间：2009-03-24T09:15:56.083
> 
> 标签：asp.net-mvc, linq, inversion-of-control

我一直在查看在 MVC 架构中更新模型的示例。控制器中有很多更新 linq（SQL 或 EF）的模型。还有其他一些服务层用于获取值。唯一[一个](http://www.asp.net/learn/mvc/tutorial-38-cs.aspx)我发现它与 IoC 容器一起使用会很尴尬的例子。

我希望能够做的是获取模型对象在控制器中更新它，然后将其传回并实际保存在下面的服务类或日期层中。

目前我被服务类中的数据上下文所困扰，获取对象

```
 public User GetUser(string username)
    {
        return dc.UserSet.WithUsername(username);
    } 
```

在控制器中进行更新`UpdateModel`

然后`SaveChanges`通过服务接口调用并依赖模型对象仍然连接的事实。

```
 public void Save()
    {
        dc.SaveChanges();
    } 
```

我想要的是能够调用类似的东西：`public void Update(User User)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T10:04:50.647

你在找这样的东西吗？

[http://www.davidhayden.com/blog/dave/archive/2007/10/12/LINQToSQLAttachMethodAttachingDetachedBusinessEntitiesDataContextAttach.aspx](http://www.davidhayden.com/blog/dave/archive/2007/10/12/LINQToSQLAttachMethodAttachingDetachedBusinessEntitiesDataContextAttach.aspx)

您可能关心也可能不关心并发性。简单的应用程序可能会采用最后一次获胜的方法，但对于较大的应用程序，您可能需要研究 linq to sql 的并发性。

# sql - DB2 的在线 SQL 参考

> ID：676629
> 
> 赞同：4
> 
> 时间：2009-03-24T09:16:11.213
> 
> 标签：sql, reference, db2

您知道任何好的 DB2 在线 SQL 参考吗？对于将从 Oracle 迁移到 DB2 的人，我需要它

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-24T09:22:41.980

也许是手册？ [http://www.ibm.com/support/docview.wss?rs=71&uid=swg27009554](http://www.ibm.com/support/docview.wss?rs=71&uid=swg27009554)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T15:40:27.173

DB2 信息中心是一个很好的起点：DB2 V9.5： [https://publib.boulder.ibm.com/infocenter/db2luw/v9r5/index.jsp?topic=/com.ibm.db2.luw.sql。 ref.doc/doc/c0004100.html](https://publib.boulder.ibm.com/infocenter/db2luw/v9r5/index.jsp?topic=/com.ibm.db2.luw.sql.ref.doc/doc/c0004100.html)

DB2 V9.1 [http://publib.boulder.ibm.com/infocenter/db2luw/v9/topic/com.ibm.db2.udb.admin.doc/doc/r0011049.htm](http://publib.boulder.ibm.com/infocenter/db2luw/v9/topic/com.ibm.db2.udb.admin.doc/doc/r0011049.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T13:17:37.140

以为我会添加更多从搜索中发现的链接

[http://mysite.verizon.net/Graeme_Birchall/id1.html](http://mysite.verizon.net/Graeme_Birchall/id1.html)

[http://delicious.com/search?p=db2%2Bsql%2Breference&u=&chk=&context=main&fr=del_icio_us&lc=0](http://delicious.com/search?p=db2%2Bsql%2Breference&u=&chk=&context=main&fr=del_icio_us&lc=0)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T00:29:53.973

是大型机还是其他系统上的 DB2？手册和红皮书非常适合大型机上的 db2。idug 中的 listserv 也非常活跃。

Philip K. Gunning 的 DB2 9 for Developers 和 roger E sanders 的 DB2 认证指南是其他系统上 DB2 的优秀书籍。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-25T02:23:38.640

[免费书籍 - DB2 Express-C 入门](http://www.ibm.com/developerworks/wikis/display/db2/free+book-+getting+started+with+db2+express-c)

> *   了解 DB2 Express-C 的全部内容
> *   了解 DB2 架构、工具、安全性
> *   了解如何管理 DB2 数据库
> *   编写 SQL、XQuery、存储过程
> *   为 DB2 开发数据库应用程序
> *   练习使用动手练习

# asp.net-mvc - 如何避免必须将 <%@ Import Namespace="MyProject.Helpers" %> 放在每个视图的顶部？

> ID：676641
> 
> 赞同：3
> 
> 时间：2009-03-24T09:20:36.960
> 
> 标签：asp.net-mvc

我正在开发我的第一个 asp.net mvc 应用程序，并且正在使用官方网站上示例中的 Html.Label() 等自定义帮助程序。

为了访问 Html.Label，我必须放置

```
<%@ Import Namespace="BRG.Helpers" %> 
```

在每个视图的顶部。

有没有办法避免这样做？我在某处读过有人提到有关 web.config 的内容，但我在任何地方都找不到它。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T09:29:46.143

您可以将命名空间添加到您的`web.config`in 中，`configuration\system.web\pages\namespaces`例如：

```
<configuration>
    <system.web>
        <pages ...>
            <controls ... />
            <namespaces>
                <add namespace="BRG.Helpers" />
            </namespaces>
        </pages>
    </system.web>
</configuration> 
```

您可以在根目录`web.config`或`Views`目录中执行此操作。

# c# - SharpSVN.DLL - C#.NET- 在 Windows 应用程序中获取 SVN 存储库

> ID：676642
> 
> 赞同：3
> 
> 时间：2009-03-24T09:20:44.667
> 
> 标签：c#, svn

如何使用 SharpSVN 访问 SVN 存储库并允许用户从 Windows 窗体中选择项目。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T09:58:01.880

SharpSVN 由[SVNMonitor](http://www.svnmonitor.com/)工具使用。
既然[SVNMonitor](http://www.svnmonitor.com/)是开源的，那么看看它的主干以了解它是如何实现的是有意义的。
它位于 [http://sharpregion.googlecode.com/svn/trunk/svnmonitor/trunk/](http://sharpregion.googlecode.com/svn/trunk/svnmonitor/trunk/)

SVNMonitor 中使用 SharpSVN 的一些代码

```
using System;
using System.Collections.Generic;
using System.Text;
using SharpSvn;
using System.Net;
using SVNMonitor.Entities;
using System.Collections.ObjectModel;
using System.Windows.Forms;
using SVNMonitor.View.Dialogs;
using SVNMonitor.Helpers;

namespace SVNMonitor.SVN
{
    internal class SharpSVNClient
    {
        #region Fields

        private const string RecommendProperty = "svnmonitor:recommend";

        #endregion Fields

        #region Methods

        private static SvnClient GetSvnClient()
        {
            SvnClient client = new SvnClient();

            return client;
        }

        private static SvnClient GetSvnClient(Source source)
        {
            SvnClient client = GetSvnClient();

            SetAuthentication(client, source);

            return client;
        }

        private static void SetAuthentication(SvnClient client, Source source)
        {
            if (source.Authenticate)
            {
                SetAuthentication(client, source.UserName, source.Password);
            }
            else
            {
                SharpSvn.UI.SvnUI.Bind(client, (IWin32Window)null);
            }
        } 
```

更多信息请访问[http://sharpregion.googlecode.com/svn/trunk/svnmonitor/trunk/SVNMonitor/SVN/SharpSVNClient.cs](http://sharpregion.googlecode.com/svn/trunk/svnmonitor/trunk/SVNMonitor/SVN/SharpSVNClient.cs)

# delphi - 在应用程序和数据库之间的通信中使用数据压缩？

> ID：676647
> 
> 赞同：0
> 
> 时间：2009-03-24T09:21:50.763
> 
> 标签：delphi, compression, ado, indy

我有即将到来的项目，我们需要应用程序将压缩数据发送到数据库和其他应用程序。压缩可以使用 GZIP 或 ZLIB 等算法。

有人可以给我一些帮助，特别是对于可以压缩通信应用程序和数据库之间的数据流量的 VCL 组件（或 ActiveX）吗？

只是考虑聊天或 IM 应用程序，但在每个数据流量之间使用压缩。

我的环境：
- Delphi 7 或 BDS 2006
- 将使用 Indy 在应用程序之间进行通信
- 将使用 ADO 将应用程序与数据库进行通信
- TCP/IP 或 HTTP 将用作协议

谢谢，
德尔斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T09:35:23.010

如果您使用 Indy，您可以使用任何压缩算法来压缩字节或流。就像 ZLib 压缩中的构建一样。那是因为你控制着沟通的双方。连接到数据库时是不同的。只有当数据库服务器理解压缩时，您才能进行压缩。通常你不压缩，而是让它由你正在使用的数据库驱动程序处理。所以这取决于他们提供的选项。

[http://www.swissdelphicenter.ch/torry/showcode.php?id=1617](http://www.swissdelphicenter.ch/torry/showcode.php?id=1617)是一个关于如何使用 Delphi 的 ZLib 压缩文件流的示例。使用 Indy 压缩要发送的流大致相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T11:42:20.833

我不知道有什么方法可以在传输过程中压缩数据，并让数据库在另一端自动理解和解压缩它，只是为了节省带宽，如果这就是你所说的。如果它是一个大的 BLOB 或文本块，我只建议压缩数据以发送到您的数据库。如果是这样，只需像 Lars 提到的那样压缩它并将压缩结果存储为 BLOB 字段。但是对于普通的数据，最好还是解压后的正常SQL格式。这样，您的数据库可以优化其存储速度并正确索引它。

# javascript - 将 HTML 布局缩放到屏幕大小

> ID：676650
> 
> 赞同：2
> 
> 时间：2009-03-24T09:22:46.270
> 
> 标签：javascript, html

您能告诉我如何使用屏幕分辨率自动修复 HTML 布局吗？例如，我正在以 1024 x 768 像素的屏幕分辨率编写 HTML。如果我切换到 800 x 600 像素，我希望我的 HTML 窗口自动更改以修复屏幕。

我怎么能那样做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T09:48:56.440

通过*HTML window*，我假设您在谈论 HTML 内容而不是浏览器窗口。

如果是这种情况，您要执行的操作的关键字是`liquid/fluid/elastic design`.

您可能想在[A List Apart](http://www.alistapart.com/)网站上阅读[Patrick Griffiths 的 Elastic Design ，或在](http://www.alistapart.com/articles/elastic/)[Google 上搜索液体设计](http://www.google.com/search?q=liquid+design)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T09:36:02.617

您不必使用 javascript。只需在 CSS 文件中将元素（div、表格等）的宽度设置为 100%。然后它将根据视口的宽度进行相应调整。（同样的事情适用于高度）

```
<!-- in yourHtml.html file -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
    <link rel="stylesheet" type="text/css" href="yourStyleSheet.css" />
  </head>

  <body>
    <div class="fullWidth">
      Your content
    </div>
  </body>

</html>

<!-- in yourStyleSheet.css file -->
div.fullWidth {
    width:100%; 
    height:100%; 
    background-color:#CCC;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T09:48:53.273

您的问题含糊不清，因此我尝试提供一些可能与您的问题相关的示例。

如果您需要使用 JavaScript 获取浏览器窗口的大小，这里有一个示例：

```
function getClientSize() {
  var width = 0, height = 0;

  if(typeof(window.innerWidth) == 'number') {
        width = window.innerWidth;
        height = window.innerHeight;
  } else if (document.documentElement && (document.documentElement.clientWidth || document.documentElement.clientHeight)) {
        width = document.documentElement.clientWidth;
        height = document.documentElement.clientHeight;
  } else if (document.body && (document.body.clientWidth || document.body.clientHeight)) {
        width = document.body.clientWidth;
        height = document.body.clientHeight;
  }

  return {width: width, height: height};
} 
```

要以编程方式检测浏览器窗口的大小调整，请将侦听器附加到 window.onresize 事件。请注意，以下简化示例不关心是否已经附加了一个侦听器（适当地使用 addEventListener/attachEvent）：

```
window.onresize = function() {
    var size = getClientSize();
    alert("Width: " + size.width + ", Height: " + size.height);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T09:41:57.067

如果你指的是实际的浏览器窗口，Javascript 有 screen.width 和 screen.height 返回当前分辨率；见[使用示例](http://www.javascriptkit.com/javatutors/advwin4.shtml)。在特定网页上，您可以设置脚本以在计时器上运行以检查这些值是否已更改，并调整窗口大小（如果有）。不过，这似乎是一项特殊的成就——屏幕分辨率很少更改，并且您必须在包含此 JS 脚本的特定页面上才能使其工作。另请注意，宽度和高度属性不会记录工具栏所在的位置，因此窗口可能会消失在那里。这也是不好的行为，因为自动最大化会覆盖用户可能喜欢的内容。

# c# - ASP.NET：在父页面的 Page_Load 之前运行

> ID：676653
> 
> 赞同：1
> 
> 时间：2009-03-24T09:26:08.507
> 
> 标签：c#, asp.net

我在用户控件中有一段代码，通常应该放在 Page_Load 中（初始化其他组件，如 DropDowns 等），但我需要在承载此控件的页面的 Page_Load 之前发生。

我试图把它放在 Page_Init 中：

```
protected void Page_Init(object sender, EventArgs e)
{
  if (!IsPostBack)
  {
    Methods.PopulateWhatList(cboWhatList0, cboWhatList1, fldWhat, Request["WhatId"], true);
    Methods.PopulateWhereList(cboWhereList0, cboWhereList1, fldWhere, Request["WhereId"], true);
    Methods.PopulateWhoList(cboWho, true, Request["WhoId"]);
    Methods.PopulateWhenList(cboWhen, true, Request["WhenId"]);
    Methods.PopulatePriceRangeList(cboPriceRange, true, Request["PriceRangeId"]);      
  }
} 
```

...但遇到了一些问题。那么除了这种类型的代码，最好的地方在哪里呢？

我遇到的问题（并且可能无关）是我的：

```
 protected override void Render(HtmlTextWriter writer)
 {
   Methods.EnableValidationWhereList(cboWhereList1, this.Page);
   Methods.EnableValidationWhatList(cboWhatList1, this.Page);
   base.Render(writer);
 } 
```

不是在某些回发时调用吗？（按下链接按钮时？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T20:24:01.343

我将尝试对您要执行的操作进行疯狂的猜测并提出解决方案：

在您`Page_Init`的页面中，您正在填充各种控件的内容。您依赖于 URL 参数，因此该`if(!IsPostBack)`子句。

在 Page_Init 之后，您的某些控件处于禁用状态，因此需要在您的 Render 方法中启用它们。

在对 LinkBut​​ton 进行回发时，您看不到在下一页呈现时填充下拉列表。

您遇到的是禁用的控件不会持久保存到 ViewState。由于在渲染之前调用了 SaveViewState，因此您在页面生命周期中启用控件为时已晚。

如果您改为将`Methods.EnableValidation...`调用移至页面上的 Pre_Render 方法，则控件状态将持久保存到 ViewState。

修复后，您应该将 Page_Init 方法中的代码移动到它所属的 Page_Load 方法中。这样，如果您处于回发状态，您的控件数据将从 ViewState 加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T14:13:26.600

页面生命周期使得页面的 page_load 在控件的 page_load 之前运行。

如果您需要在页面加载之前初始化数据源，那么您可以将该初始化放在 OnInit 中，前提是您确保首先调用 base.OnInit()。理想情况下，您应该保留对 page_load 机制的数据绑定调用，以确保您不会遇到视图状态问题。

关于你的渲染方法。“启用”方法在整个页面生命周期中的用途是什么？

# apache-flex - flex应用程序中的框架集？

> ID：676655
> 
> 赞同：-1
> 
> 时间：2009-03-24T09:29:04.273
> 
> 标签：apache-flex, flex3, flexbuilder

HTML中有一个我们都知道的框架集概念。

但我需要在 flex 应用程序中完成。

怎么做 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T16:56:26.693

如果您所追求的只是一个与使用 HTML 框架相似的 GUI 组件容器布局，请检查该[`DividedBox`](http://livedocs.adobe.com/flex/3/langref/mx/containers/DividedBox.html)组件（以及它的水平和垂直子类，`HDividedBox`以及`VDividedBox`。）您可以使用[Flex 3 样式资源管理](http://examples.adobe.com/flex3/consulting/styleexplorer/Flex3StyleExplorer.html#)器看看他们的外观和感觉。您可以将它们嵌套在彼此内部，就像使用框架集一样。

# html - 找出某个计算出来的 CSS 样式的原因是什么

> ID：676659
> 
> 赞同：8
> 
> 时间：2009-03-24T09:30:16.640
> 
> 标签：html, css, computed-style

我`<div>`在一个网页上有一个最终计算出的高度属性为 633px。这不是在任何级联样式表中设置的，无论是否内联，也不是在 javascript 中设置。我在我的代码中到处搜索，但数字 633 没有出现在任何地方。我可以通过设置`style="height: 420px;"`我想要的高度来解决这个问题，但 IE 似乎将其覆盖为默认情况下我也会在其他浏览器中获得的 633px。我已经在 Google Chrome 和 Firefox/Firebug 中验证了 div 的实际内容远不接近 633 像素高。有什么办法可以找出这个计算高度的原因是什么？为了完整起见，以下是 Google Chrome 报告的`<div>`.

```
Computed Style
background-color: white;
display: block;
float: left;
height: 633px;
margin-left: 30px;
margin-top: 20px;
padding-bottom: 0px;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
width: 830px;

Inline Style Attribute
margin-left: 30px;
margin-top: 20px;

#overview
background-color: white;
float: left;
padding: 0px;
width: 830px;

#overview, #overviewempty
margin-top: 9px; (is crossed out)

div
display: block; 
```

提前致谢。

**编辑**：

问题中的 div 包含两个 div，一个在 中包含一行文本`font-size: 16px;`，另一个是高度为 367px 的 div。

**另一个编辑**：

好的，所以我弄清楚是什么原因造成的。主 div 包含的第二个 div 包含一个图像和一个浮动在该图像右侧的 div，使用`position: relative; top: -335px;`. Internet Explorer 保留此元素为空白的空间。有什么办法吗？

**最终编辑**：

解决了！我将浮动 div 的内容用 包裹`position: relative`在第二个 div 中`position: absolute`，这消除了主图像下的空白 :) 最终的 HTML 看起来像这样：

```
<div id="overview">
  <div>Some text>
  <div>
    <img src="someImage.jpg">
    <div style="float: right; position: relative; top: -335px;">
      <div style="position: absolute; top: 0px; left: 0px; background-color: white; width: 365px;">
        Some floating contents
      </div>
    </div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T09:40:17.133

与 IE 开发者工具栏一样，看看[Firebug for Firefox](http://getfirebug.com/)。

这将告诉您适用于元素的所有样式，并显示哪些样式已被覆盖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T09:33:24.027

元素的高度通常由其内容决定。你那里有 633px 的文字或其他东西吗？

计算的样式不一定来自任何样式表或 javascript。这就是渲染引擎计算完所有内容后样式的最终结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T09:37:38.403

为 Internet Explorer安装[IE Developer Toolbar](http://www.microsoft.com/en-us/download/details.aspx?id=18359)。它有时会让生活变得更轻松。编辑： IE 的新版本默认包含开发人员工具，可通过按 F12 访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-21T14:53:12.867

![在此处输入图像描述](https://i.stack.imgur.com/0D1v6.png)

[来自https://developer.chrome.com/devtools/docs/elements-styles](https://developer.chrome.com/devtools/docs/elements-styles)的漂亮图表

单击“计算样式”以找出为什么/什么属性会相互覆盖。

# java - 如果方法的返回类型是 Void，我应该返回什么？（不是无效的！）

> ID：676663
> 
> 赞同：118
> 
> 时间：2009-03-24T09:31:54.593
> 
> 标签：java, generics, void

由于在 Java 中使用泛型，我最终不得不实现一个具有`Void`返回类型的函数：

```
public Void doSomething() {
    //...
} 
```

并且编译器要求我返回*一些东西*。现在我刚回来`null`，但我想知道这是否是好的编码习惯......

我问的是**V** ‌oid，而不是**v** ‌oid。类`Void`，**而不是**保留关键字`void`。

我也试过`Void.class`, `void`, `Void.TYPE`, `new Void()`, 根本没有回报，但所有这些都不起作用。（出于或多或少明显的原因）（有关详细信息，请参阅[此答案](https://stackoverflow.com/questions/676663/what-do-i-return-if-the-return-type-of-a-method-is-void-not-void/881358#881358)）

*   那么如果函数的返回类型是，我应该返回`Void`什么？
*   类的一般用途是`Void`什么？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-03-24T09:38:59.100

> 那么如果函数的返回类型必须是，我应该返回`Void`什么？

使用`return null`. `Void`不能被实例化，只是.`Class<T>`类型的占位符`void`。

> 有什么意义`Void`？

如上所述，它是一个占位符。`Void`例如，如果您使用反射查看返回类型为`void`. （从技术上讲，你会回来`Class<Void>`的。）它在这些方面还有其他各种用途，比如如果你想参数化一个`Callable<T>`.

> 由于在 Java 中使用泛型，我最终不得不实现这个功能

如果您需要实现具有此签名的方法，我会说您的 API 可能有些古怪。仔细考虑是否有更好的方法来做你想做的事（也许你可以在不同的后续问题中提供更多细节？）。我有点怀疑，因为这只是“由于使用泛型”而出现的。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-24T09:39:35.557

没有办法实例化一个 Void，所以你唯一*可以*返回的是 null。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-24T09:36:44.770

`return null`是要走的路。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-05-19T07:10:02.983

要明确为什么您提供的其他建议不起作用：

`Void.class`并且`Void.TYPE`指向同一个对象并且是类型`Class<Void>`，而不是`Void`。

这就是为什么你不能返回这些值。`new Void()`将是类型`Void`，但该构造函数不存在。事实上，`Void`没有公共构造函数，因此无法实例化：`Void`除了多态之外，您永远不能拥有任何类型的对象`null`。

希望这可以帮助！:-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T09:38:19.867

如果出于晦涩的原因，您必须使用这种类型，那么确实返回 null 似乎是一个明智的选择，因为我认为无论如何都不会使用返回值。
无论如何，编译器都会强制你返回一些东西。
而且这个类似乎没有公共构造函数，所以 new Void() 是不可能的。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2019-03-07T04:20:40.400

像这样。

```
public Class TestClass {
    public void testMethod () {
        return;
    }
} 
```

# oslo - 转移减少和减少减少冲突

> ID：676664
> 
> 赞同：6
> 
> 时间：2009-03-24T09:32:00.850
> 
> 标签：oslo, shift-reduce-conflict, mgrammar, reduce-reduce-conflict

我很难解决这个问题，需要一些帮助来理解减少和减少冲突。我有一个语法，我似乎无法理解它为什么会出现问题。我可以附上语法，但我想了解它是如何工作的。

第一个问题，Mgrammer 创建什么类型的解析器？据我了解， shift reduce 和 reduce reduce 冲突取决于解析器的类型。

第二个问题，什么表示减少减少冲突，什么表示转移减少冲突？

我知道词法分析和形式语法的基础知识，但是自从我从事语言设计工作以来已经有一段时间了，所以这里的任何帮助都非常合适。

### 更新：

我正在使用一种重要的空白语言，我想知道在 MGrammar 中这样做的可能性，我需要先看一下才能解决歧义吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T09:51:57.760

简单的例子：

```
if cond
    if cond2
        cmd
    else
        cmd2 
```

问题：`else`属于哪里？对于人眼，缩进表示“第二个`if`”，但这对计算机没有任何意义（使用[Python](http://www.python.org/)时除外；））。这是一个[移位/减少冲突](http://www.devincook.com/goldparser/doc/meta-language/shift-reduce-conflict.htm)。

一个优雅的解决方案是将`else`视为最高优先级的左绑定运算符（这使其“挂”到最接近的`if`）。

[减少/减少冲突](http://www.devincook.com/goldparser/doc/meta-language/reduce-reduce-conflict.htm)是模棱两可的。我没有很好的例子，但这意味着语法中存在一个标记可能导致两个规则同时减少的路径，并且没有额外的信息来决定哪个规则应该优先。

[编辑]野牛文档有一个[reduce/reduce 的例子](http://www.delorie.com/gnu/docs/bison/bison_88.html)。

# netbeans - netbeans jvi vimrc 文件位置

> ID：676675
> 
> 赞同：5
> 
> 时间：2009-03-24T09:34:52.137
> 
> 标签：netbeans, vim, jvi

我已经开始使用 netbeans vim 插件 Jvi，但我似乎找不到 vimrc 文件位置我找到了一个选项，似乎说它将 vimrc 保存在主文件夹中，但那里没有。

我正在使用 Ubuntu。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-09T22:50:54.010

jVi 不支持 vimscript，因此它不处理 vimrc 文件。如前所述，您可以在 NetBeans 中使用
Tools > Options > jViConfig 配置 jVi

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T10:40:06.800

For most vi-like systems the .vimrc file is optional - if it is there, the program will use it, if it isn't it'll just use the defaults.

From a brief look at the [jVi sourceforge page](http://jvi.sourceforge.net/ReadmeNetBeans.html) it seems as if the settings in the GUI are equivalent to creating a .vimrc file - so you can either set the details there, or create your own .vimrc.

# php - 如何在 PHP 中向空数组添加元素？

> ID：676677
> 
> 赞同：601
> 
> 时间：2009-03-24T09:35:00.250
> 
> 标签：php, arrays, variables

如果我在 PHP 中定义一个数组，例如（我没有定义它的大小）：

```
$cart = array(); 
```

我是否只需使用以下内容向其中添加元素？

```
$cart[] = 13;
$cart[] = "foo";
$cart[] = obj; 
```

PHP中的数组没有添加方法，例如，`cart.add(13)`？

* * *

## 回答 #1

> 赞同：954
> 
> 时间：2009-03-24T09:42:53.897

两者[`array_push`](http://php.net/manual/en/function.array-push.php)和您描述的方法都将起作用。

```
$cart = array();
$cart[] = 13;
$cart[] = 14;
// etc

//Above is correct. but below one is for further understanding
$cart = array();
for($i=0;$i<=5;$i++){
    $cart[] = $i;  
}
echo "<pre>";
print_r($cart);
echo "</pre>"; 
```

是相同的：

```
<?php
$cart = array();
array_push($cart, 13);
array_push($cart, 14);

// Or 
$cart = array();
array_push($cart, 13, 14);
?> 
```

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2009-03-24T09:47:36.350

最好不要使用[`array_push`](http://php.net/manual/en/function.array-push.php)，只使用你建议的。这些功能只是增加了开销。

```
//We don't need to define the array, but in many cases it's the best solution.
$cart = array();

//Automatic new integer key higher than the highest 
//existing integer key in the array, starts at 0.
$cart[] = 13;
$cart[] = 'text';

//Numeric key
$cart[4] = $object;

//Text key (assoc)
$cart['key'] = 'test'; 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-10-14T13:15:14.790

根据我的经验，当键不重要时，解决方案很好（最好）：

```
$cart = [];
$cart[] = 13;
$cart[] = "foo";
$cart[] = obj; 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-24T09:37:51.163

您可以使用[array_push](http://www.php.net/function.array-push)。它将元素添加到数组的末尾，就像在堆栈中一样。

你也可以这样做：

```
$cart = array(13, "foo", $obj); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-10-23T01:59:32.397

```
$cart = array();
$cart[] = 11;
$cart[] = 15;

// etc

//Above is correct. but below one is for further understanding

$cart = array();
for($i = 0; $i <= 5; $i++){
          $cart[] = $i;  

//if you write $cart = [$i]; you will only take last $i value as first element in array.

}
echo "<pre>";
print_r($cart);
echo "</pre>"; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-05-03T17:05:14.850

请记住，此方法会覆盖第一个数组，因此请仅在确定时使用！

```
$arr1 = $arr1 + $arr2; 
```

（[见来源](https://stackoverflow.com/a/2140094/2165415)）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-11-22T06:37:33.940

```
$products_arr["passenger_details"]=array();
array_push($products_arr["passenger_details"],array("Name"=>"Isuru Eshan","E-Mail"=>"isuru.eshan@gmail.com"));
echo "<pre>";
echo json_encode($products_arr,JSON_PRETTY_PRINT);
echo "</pre>";

//OR

$countries = array();
$countries["DK"] = array("code"=>"DK","name"=>"Denmark","d_code"=>"+45");
$countries["DJ"] = array("code"=>"DJ","name"=>"Djibouti","d_code"=>"+253");
$countries["DM"] = array("code"=>"DM","name"=>"Dominica","d_code"=>"+1");
foreach ($countries as $country){
echo "<pre>";
echo print_r($country);
echo "</pre>";
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-06-23T09:19:34.583

当一个人想要使用从零开始的元素索引添加元素时，我想这也会起作用：

```
// adding elements to an array with zero-based index
$matrix= array();
$matrix[count($matrix)]= 'element 1';
$matrix[count($matrix)]= 'element 2';
...
$matrix[count($matrix)]= 'element N'; 
```

# ironpython - 铁蟒扭曲

> ID：676681
> 
> 赞同：2
> 
> 时间：2009-03-24T09:37:11.057
> 
> 标签：ironpython, twisted

是否有扭曲库的 Iron Python .net 端口，或者 Iron Python 可以使用标准库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-07T18:11:18.820

Twisted 目前不会在 IronPython 中运行，但它正在[开发中](http://twistedmatrix.com/trac/ticket/3882)。

敬请关注。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T12:24:07.457

我自己没有使用过它，但你可能会从[Ironclad](http://www.resolversystems.com/documentation/index.php/Ironclad.html)中获得一些好处——据说它可以让你使用 IronPython 中的 CPython ......

# msbuild - 如何从 msbuild 调用静态类方法？

> ID：676688
> 
> 赞同：4
> 
> 时间：2009-03-24T09:38:25.437
> 
> 标签：msbuild

如何从 msbuild 调用类静态方法并将其结果存储在列表中？

编辑：好的，让我进一步解释一下。我正在使用沙堡帮助文件生成器为我的应用程序生成文档。其中一项要求是您必须按如下方式指定文档来源：

```
<DocumentationSources>
    <DocumentationSource sourceFile="$(MSBuildProjectDirectory)\..\src\myApp\bin\Debug\myApp.exe" xmlns="" />
    <DocumentationSource sourceFile="$(MSBuildProjectDirectory)\..\src\myApp\bin\Debug\myApp.xml" xmlns="" />
</DocumentationSources> 
```

Sandcastle Help File Builder 带有一个 utils 程序集，它可以从指定目录中检索所有 dll 和 xml 文件。我想从此程序集中调用该方法并将其结果存储为`<DocumentationSource>`. 这是一个返回的静态方法`Collection<string>`

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-15T06:59:05.820

自定义任务很棒，但如果您想做一些简单的事情，则可能会矫枉过正。我相信 Draco 是在询问[MSBuild 4 中的 Property Functions 功能](http://msdn.microsoft.com/en-us/library/dd633440.aspx)。

使用静态函数设置属性的示例（直接从上面的页面中提取）：

```
<Today>$([System.DateTime]::Now)</Today> 
```

并在参数上调用静态函数：

```
$([Class]:: Property.Method(Parameters)) 
```

或者，也许你想要更疯狂的东西，比如[inline tasks](http://msdn.microsoft.com/en-us/library/dd722601.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T09:40:25.930

创建一个调用该静态方法并返回 ITaskItem 数组的自定义任务。

或者

您可以尝试使用[MSBuild 扩展包](http://msbuildextensionpack.codeplex.com/) **Assembly.Invoke**：

```
<PropertyGroup>
  <StaticMethodAssemblyPath>path</StaticMethodAssemblyPath>
</PropertyGroup>

<MSBuild.ExtensionPack.Framework.Assembly TaskAction="Invoke" 
                                          NetArguments="@(ArgsM)" 
                                          NetClass="StaticMethodClassName" 
                                          NetMethod="StaticMethodName" 
                                          NetAssembly="${StaticMethodAssemblyPath}">
        <Output TaskParameter="Result" PropertyName="R"/>
</MSBuild.ExtensionPack.Framework.Assembly> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T10:51:22.827

通常，最灵活的选项是创建[自定义 MSBuild 任务](http://msdn.microsoft.com/en-us/library/t9883dzc.aspx)。这是所有未经测试的代码，只是为了给你一个想法：

在您的 msbuild 文件中：

```
<UsingTask TaskName="FindFiles" AssemblyFile="FindFiles.dll" />

<!-- 
As you'll see below, SearchDirectory and SearchPatterns are input parameters,
MatchingFiles is an output parameter, SourceFiles is an ItemGroup assigned to
the output.
-->
<FindFiles SearchDirectory="$(MyDirectory)" SearchPatterns="*.dll;*.xml">
    <Output ItemName="SourceFiles" TaskParameter="MatchingFiles" />
</FindFiles>

<!-- You can then use the generated ItemGroup output elsewhere. -->
<DocumentationSources>
    <DocumentationSource sourceFile="@(SourceFiles)" xmlns="" />
</DocumentationSources> 
```

查找文件.cs：

```
using System;
using System.IO;
using System.Collections.Generic;

using Microsoft.Build.Framework;
using Microsoft.Build.Utilities;

namespace FindFiles
{
    public class FindFiles : Task
    {
        // input parameter
        [Required]
        public string SearchDirectory { get; set; }

        // output parameter
        [Required]
        public string[] SearchPatterns { get; set; }

        [Output]
        public string[] MatchingFiles { get; private set; }

        private bool ValidateParameters()
        {
            if (String.IsNullOrEmpty(SearchDirectory))
            {
                return false;
            }
            if (!Directory.Exists(SearchDirectory))
            {
                return false;
            }
            if (SearchPatterns == null || SearchPatterns.Length == 0)
            {
                return false;
            }
            return true;
        }

        // MSBuild tasks use the command pattern, this is where the magic happens,
        // refactor as needed
        public override bool Execute()
        {
            if (!ValidateParameters())
            {
                return false;
            }
            List<string> matchingFiles = new List<string>();
            try
            {

                foreach (string searchPattern in SearchPatterns)
                {
                    matchingFiles.AddRange(
                        Directory.GetFiles(SearchDirectory, searchPattern)
                        );
                }
            }
            catch (IOException)
            {
                // it might be smarter to just let this exception fly, depending on
                // how you want the task to behave
                return false;
            }
            MatchingFiles = matchingFiles.ToArray();
            return true;
        }
    }
} 
```

# sql - 这些函数存储在 Oracle 数据库的什么位置？

> ID：676693
> 
> 赞同：0
> 
> 时间：2009-03-24T09:40:06.273
> 
> 标签：sql, oracle, plsql

函数 sysdate 存储在哪里，在什么包中，例如：

```
select sysdate from dual;
select systimestamp from dual; 
```

另外，请接受以下查询：

```
select sys.login_user,sys.database_name ,sys.sysevent from dual; 
```

*   这里的 sys 是什么？
*   是包裹吗？
*   这个包裹存放在哪里？
*   我可以查看此包中的源（文本）吗？**请提供查询**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T10:44:08.787

SYSDATE and SYSTIMESTAMP are functions in the STANDARD package owned by SYS. However, this is a special package and so you don't need to specify standard.sysdate (in fact, you can't!)

You can view this package like this:

```
select text
from   all_source
where owner='SYS'
and name='STANDARD'
and type = 'PACKAGE BODY'
order by line; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T09:44:08.293

sys 是一个模式。sysdate 是一个全局可用的变量，包含当前日期/时间。

# xml - RSS 浏览器检测

> ID：676698
> 
> 赞同：3
> 
> 时间：2009-03-24T09:41:27.037
> 
> 标签：xml, rss, internet-explorer-6

好吧，我完全不明白这一点。

这是 BBC 的 RSS 提要（[http://newsrss.bbc.co.uk/rss/newsonline_uk_edition/front_page/rss.xml](http://newsrss.bbc.co.uk/rss/newsonline_uk_edition/front_page/rss.xml)）

如果您在 ie6 中查看它，它似乎使用自定义样式表 (nosol.xsl)

如果您在 firefox 或 ie7 中查看它，则使用浏览器的默认 rss feed 样式。

我试图用这个 rss 提要自己做类似的事情：[http ://www.bbusl.com/worksregion/4/rss.xml](http://www.bbusl.com/worksregion/4/rss.xml)

它在开发服务器上按计划工作。但是，一旦我将它放到我们的生产服务器上，当您在 Firefox 中查看 rss 提要时，就会出现 ie6 样式表！？！

如何使自定义样式表仅出现在 ie6 中？让它在开发服务器而不是实时生产服务器上工作的区别是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T10:33:51.340

我[通过 W3C 的提要验证器](http://validator.w3.org/feed/check.cgi?url=http%3A%2F%2Fwww.bbusl.com%2Fworksregion%2F4%2Frss.xml)运行了您的提要。我将 Firefox 配置为使用[Fiddler](http://www.fiddler2.com/fiddler2/)作为代理，以允许我在浏览器显示之前拦截和修改服务器发送的响应。

事实证明，由于第一个验证错误，样式表正在被应用：

> 第 6 行，第 28 列：链接必须是完整且有效的 URL：/worksregion/4/rss.xml [帮助]
> 
> ```
> <link>/worksregion/4/rss.xml</link>
>                             ^ 
> ```

当我将其更改为您的提要的完整 URL 时，默认的 Firefox RSS 提要样式已应用，正如您所期望的那样。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-24T10:40:36.940

您需要一个服务器端脚本来显示一个或另一个，具体取决于用户代理。

# javascript - 在 HTML 中更改对象标记上的数据内容

> ID：676705
> 
> 赞同：21
> 
> 时间：2009-03-24T09:43:34.503
> 
> 标签：javascript, html, object

我有一个 HTML 页面，其中包含一个 Object 标记来托管嵌入式 HTML 页面。

```
<object style="border: none;" standby="loading" id="contentarea" 
 width="100%" height="53%" type="text/html" data="test1.html"></object> 
```

但是，我需要更改 HTML 页面内的 object 标记。当前代码似乎创建了对象的克隆并用它替换现有对象，如下所示：

```
function changeObjectUrl(newUrl)
{
    var oContentArea = document.getElementById("contentarea");
    var oClone = oContentArea.cloneNode(true); 
    oClone.data = newUrl; 

    var oPlaceHolder = document.getElementById("contentholder"); 
    oPlaceHolder.removeChild(oContentArea); 
    oPlaceHolder.appendChild(oClone); 
} 
```

这似乎是一种相当糟糕的方法。有谁知道更改嵌入页面的“正确”方式？

谢谢！

**编辑**：响应下面的答案，这是我现在使用的页面的完整来源。使用 setAttribute 似乎不会更改 Object 标记的内容。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Test</title>
<script language="JavaScript">
function doPage()
{
    var objTag = document.getElementById("contentarea");
    if (objTag != null)
    {
        objTag.setAttribute('data', 'Test2.html');
        alert('Page should have been changed');
    }
}
</script>
</head>
<body>
<form name="Form1" method="POST">
<p><input type="button" value="Click to change page" onclick="doPage();" /></p>
<object style="visibility: visible; border: none;" standby="loading data" id="contentarea" title="loading" width="100%" height="53%" type="text/html" data="test1.html"></object>
</form>
</body>
</html> 
```

Test1.html 和 Test2.html 页面只是分别显示文本“Test1”和“Test2”的简单 HTML 页面。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-24T09:45:58.867

你可以用[setAttribute](https://developer.mozilla.org/en/DOM/element.setAttribute)

```
document.getElementById("contentarea").setAttribute('data', 'newPage.html'); 
```

编辑：还建议您使用 window.onload 以确保 DOM 已加载，否则您将无法访问其中的对象。

它可能是这样的：

```
function changeData(newURL) {
    if(!document.getElementById("contentarea")) 
        return false;
    document.getElementById("contentarea").setAttribute('data', newURL);
}

window.onload = changeData; 
```

[您可以在此处](https://developer.mozilla.org/En/DOM/Window.onload)阅读有关 window.onload的更多信息

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-18T00:08:03.917

这似乎是一个浏览器错误，`setAttribute()`应该可以工作。我找到了这个解决方法，它似乎适用于所有浏览器：

```
var newUrl = 'http://example.com';
var objectEl = document.getElementById('contentarea');
objectEl.outerHTML = objectEl.outerHTML.replace(/data="(.+?)"/, 'data="' + newUrl + '"'); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-04-28T09:17:45.063

上述解决方案在 Firefox 中无法正常工作，Object 标签由于某种原因没有刷新。我的对象标签显示 SVG 图像。

我的工作解决方案是用克隆替换完整的对象节点：

```
var object = document.getElementById(objectID);
object.setAttribute('data', newData);

var clone = object.cloneNode(true);
var parent = object.parentNode;

parent.removeChild(object );
parent.appendChild(clone ); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T15:28:46.440

这就是我最终实现它的方式。你可以做

```
document.getElementById("contentarea").object.location.href = url; 
```

或许

```
document.getElementById("contentarea").object.parentWindow.navigate(url); 
```

Object 元素还有一个“readyState”属性，可用于检查包含的页面是“加载中”还是“完成”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-21T14:47:21.547

我找到了一个非常简单的解决方案，它也适用于 Chrome。诀窍是使对象（或父元素）不可见，更改数据属性，然后使对象再次可见。

在下面的代码中，假设object_element是对象元素，parent_element是父元素，url是数据的url。

```
parent_element.style.display = 'none'; // workaround for Chrome
object_element.setAttribute('data', url);
parent_element.style.display = ''; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-13T19:04:06.963

在 user2802253 之后，我在 Safari 和 Firefox 上使用了这个，它也强制重绘。（抱歉，没有足够的声誉作为简单的评论发布）。

```
theObject.style.visibility = null;
theObject.setAttribute("data", url);
theObject.style.visibility = "visible"; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-12-13T05:22:56.463

```
 var obj = document.getElementById("pdfDoc");
 obj.setAttribute('data', newPdf); 
```

适用于 Chrome 版本 54 和 Safari，但不适用于 IE 11

什么对他们都有效

```
 var obj = document.getElementById("pdfDoc");
 obj.setAttribute('data', newPdf);
 var cl = obj.cloneNode(true);
 var parent = obj.parentNode;
 parent.removeChild(obj);
 parent.appendChild(cl); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-09-06T08:38:45.503

这个片段在我的情况下完成了工作

```
 var object = document.getElementById(objectID);
  object.setAttribute('data', newData);

  var clone = object.cloneNode(true);
  var parent = object.parentNode;

  parent.removeChild(object );
  parent.appendChild(clone ); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-02-27T19:38:02.590

```
<div id='myob'>
<object style="border: none;" standby="loading" id="contentarea" 
 width="100%" height="53%" type="text/html" data="test1.html"></object>
</div> 
```

$('#myob').html($('#myob').html());

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-24T10:07:14.180

更改数据属性应该很容易。但是，它可能无法在所有浏览器上完美运行。

如果内容始终是 HTML，为什么不使用 iframe？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-02T11:23:00.393

另一种方法是，您可以将对象嵌入 DIV

```
var newUrl = 'http://example.com';
var divEl = document.getElementById('divID');
var objEl = document.getElementById('objID');
objEl.data = newUrl;
// Refresh the content
divEl.innerHTML = divEl.innerHTML; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-19T19:12:43.673

我认为这是实现目标的更好方法。

html:

```
<div id="mytemplate"><div> 
```

JS：

```
function changeTemplate(t){
var mytemplate = document.getElementById("mytemplate");
mytemplate.innerHTML = '<object type="text/html" data=' + t + '></object>';
}
changeTemplate('template.html');
changeTemplate('whatever.html'); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-04-21T12:56:37.550

```
var content_area = document.getElementById("contentarea");
    content_area.data = newUrl;
```

刷新 Chrome 版本 42.0.2311.90 m 中的对象

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-06-25T19:43:33.957

此问题的主要原因是在本地文件中使用“/”。

> 错误的代码：

```
 var obj = document.getElementById("hostedhtml");
 obj.setAttribute('data', "pages\page2.html"); 
```

> 正确的代码：

```
 var obj = document.getElementById("hostedhtml");
 obj.setAttribute('data', "pages\\page2.html"); 
```

# mapping - 在 Prolog 中输入

> ID：676707
> 
> 赞同：8
> 
> 时间：2009-03-24T09:45:26.013
> 
> 标签：mapping, prolog, dcg

我目前正在开发一个递归 Prolog 程序，将路线链接在一起，以创建伯明翰地区的*基本*GPS。目前我可以得到这样的输出：

**输入**

```
routeplan(selly_oak, aston, P). 
```

**输出**

```
P = [selly_oak, edgbaston, ... , aston] 
```

我想做的是让我的程序提供某种接口，所以如果我要输入以下内容：

```
Route from selly_oak to aston 
```

它会为我提供：

```
Go from selly_oak to edgbaston
Go from edgbaston to ...
Finally, Go from ... to aston. 
```

Prolog 是一种强大的语言，所以我认为这很容易实现，但是我取出的许多书似乎都跳过了这一部分。据我所知，我必须使用类似于 write() 和 read() 的东西，尽管我不知道细节。

这里有人可以提供一些基本示例或更多信息链接的 Prolog 新手吗？

**编辑：**很多这些答案似乎非常复杂，解决方案应该只有大约 5-10 行代码。读入一个值不是问题，因为我可以按照以下方式做一些事情：

```
find:- 
    write('Where are you? '), 
    read(X), 
    nl, write('Where do you want to go? '),
    read(Y), 
    loopForRoute(X,Y). 
```

如果可以使用 write() 写出输出，我会更喜欢它，以便可以使用新行 (nl)，以便它像上面的输出一样显示。

如果这是我的输入，那么我将如何安排顶级 routeplan() 来处理这些输入？另外，如果我要为这些车站添加线路作为额外参数，那么这将如何实现？所有链接都在文件开头定义，如下所示：

```
rlinks(selly_oak, edgbaston, uob_line).
rlinks(edgbaston, bham_new_street, main_line). 
```

因此，有了这些信息，能够像这样读取该行会很好。

```
Go from selly_oak to edgbaston using the uob_line
Go from edgbaston to ... using the ...
Finally, go from ... to aston using the astuni_line 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T11:45:15.427

详细讨论此类事情的一本书是 Michael A. Covington*的《Prolog 程序员的自然语言处理》 。*

一般来说，你需要做的是

1.  标记输入
2.  解析令牌（例如使用 DCG）以获取`routeplan/3`
3.  称呼`routeplan/3`
4.  在输出的基础上生成一些英文`routeplan/3`

像这样的东西（在 SWI-Prolog 中工作）：

```
% Usage example:
%
% ?- query_to_response('Route from selly_oak to aston', Response).
%
% Response = 'go from selly_oak to edgbaston then go from edgbaston
%         to aston then stop .'
%
query_to_response(Query, Response) :-
    concat_atom(QueryTokens, ' ', Query), % simple tokenizer
    query(path(From, To), QueryTokens, []),
    routeplan(From, To, Plan),
    response(Plan, EnglishTokens, []),
    concat_atom(EnglishTokens, ' ', Response).

% Query parser
query(path(From, To)) --> ['Route'], from(From), to(To).
from(From) --> [from], [From], { placename(From) }.
to(To) --> [to], [To], { placename(To) }.

% Response generator
response([_]) --> [stop], [.].
response([From, To | Tail]) -->
    goto(path(From, To)), [then], response([To | Tail]).
goto(path(From, To)) --> [go], from(From), to(To).

% Placenames
placename(selly_oak).
placename(aston).
placename(edgbaston).

% Mock routeplan/3
routeplan(selly_oak, aston, [selly_oak, edgbaston, aston]). 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T10:47:46.207

嗯，如果我理解正确，您只是想很好地格式化列表以便打印出来，不是吗？

在 SWI-Prolog 这工作：

```
output_string([A,B],StrIn,StrOut) :-
 concat_atom([StrIn, 'Finally, Go from ', A, ' to ', B, '.'],StrOut),
 write(StrOut).

output_string([A,B|Rest],StrIn,StrOut) :-
 concat_atom([StrIn,'Go from ', A, ' to ', B, '.\n'],StrAB),
 output_string([B|Rest],StrAB,StrOut). 
```

然后打电话给

```
output_string(P,'',_). 
```

它可能不是很有效，但它可以完成工作。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T18:14:07.943

对于这类事情，我通常会创建 shell 谓词。所以在你的情况下......

```
guided:-
    print('Enter your start point'),nl,
    read(Start),
    print('Enter your destination'),nl,
    read(Dest),
    routeplan(Start, Dest, Route),
    print_route(Route). 
```

而 print_route/1 可能是这样的递归：

```
print_route([]).

print_route([[A,B,Method]|Tail]):-
    print_route(Tail),
    print('Go from '), print(A),
    print(' to '), print(B),
    print(' by '), print(Method), nl. 
```

我假设 routeplan/3 谓词的第三个变量是列表列表。此外，它是通过添加到尾部来构建的。如果不是，它应该很容易适应。在评论中询问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T10:28:11.587

以下是一些将文件/流中的行读入 Prolog 字符串的谓词：

```
%%% get_line(S, CL): CL is the string read up to the end of the line from S.
%%% If reading past end of file, returns 'end_of_file' in CL first, raises
%%% an exception second time.
%%% :- pred get_string(+stream, -list(int)).
get_line(S, CL) :-
    peek_code(S, C),
    (   C = -1
    ->  get_code(S, _),
        CL = end_of_file
    ;   get_line(S, C, CL)).

get_line(_, -1, CL) :- !, CL = [].  % leave end of file mark on stream
get_line(S, 0'\n, CL) :- !,
    get_code(S, _),
    CL = [].
get_line(S, C, [C|CL]) :-
    get_code(S, _),
    peek_code(S, NC),
    get_line(S, NC, CL).

%% read_lines(L): reads lines from current input to L.  L is a list of list
%% of character codes, newline characters are not included.
%% :- pred read_lines(-list(list(char))).
read_lines(L) :-
    current_input(In),
    get_line(In, L0),
    read_lines(In, L0, L).

%% read_lines(F, L): reads lines from F to L.  L is a list of list of character
%% codes, newline characters are not included.
%% :- pred read_lines(+atom, -list(list(char))).
read_lines(F, L) :-
    fail_on_error(open(F, read, S)),
    call_cleanup((get_line(S, L0),
              read_lines(S, L0, L)),
             close(S)).

read_lines(_, end_of_file, L) :- !, L = [].
read_lines(S, H, [H|T]) :-
    get_line(S, NH),
    read_lines(S, NH, T). 
```

然后，查看[DCG](http://www.amzi.com/manuals/amzi6/pro/ref_dcg.htm)以获取有关如何解析字符串的信息。

# c - 在 C 中实现 2D 卷积的快速方法

> ID：676709
> 
> 赞同：5
> 
> 时间：2009-03-24T09:46:22.327
> 
> 标签：c, image, filter, 2d

我正在尝试实现一种视觉算法，其中包括一个带有 9x9 拉普拉斯高斯滤波器的预滤波阶段。你能指出一个简要解释快速过滤器实现的文档吗？我认为我应该使用 FFT 进行最有效的过滤。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T09:55:20.980

您确定要使用 FFT 吗？那将是一个全数组变换，这将是昂贵的。如果您已经决定使用 9x9 卷积滤波器，则不需要任何 FFT。

通常，在 C 中进行卷积的最便宜的方法是设置一个循环，将指针移动到数组上，将每个点的卷积值求和并将数据写入新数组。然后可以使用您最喜欢的方法（编译器矢量化、MPI 库、OpenMP 等）并行化此循环。

关于边界：

*   如果您假设边界外的值为 0，则将 0 的 4 元素边界添加到您的二维点数组中。这将避免需要 `if` 语句来处理昂贵的边界。
*   如果您的数据在边界处环绕（即它是周期性的），则使用模数或添加一个 4 元素边界，该边界复制网格的另一侧（abcdefg -> fgabcdefgab 为 2 点）。**注意：这是您对任何类型的傅立叶变换隐含的假设，包括 FFT**。如果不是这种情况，您需要在完成任何 FFT 之前对其进行考虑。

4 个点是因为 9x9 内核的最大边界重叠是主网格之外的 4 个点。因此，2n+1 x 2n+1 内核需要 n 个边界点。

如果您需要这种卷积非常快，并且/或者您的网格很大，请考虑将其划分为可以保存在处理器缓存中的较小部分，从而更快地计算。这也适用于您可能想要做的任何 GPU 卸载（它们非常适合这种类型的浮点计算）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T09:52:32.203

这是一个理论链接 [http://hebb.mit.edu/courses/9.29/2002/readings/c13-1.pdf](http://hebb.mit.edu/courses/9.29/2002/readings/c13-1.pdf)

这是 fftw 的链接，这是我过去使用过的一个非常好的 FFT 库（检查许可证以确保它合适）[http://www.fftw.org/](http://www.fftw.org/)

您所做的就是对图像和内核（9x9 矩阵）进行 FFT。相乘，然后反向变换。

但是，对于 9x9 矩阵，在实际坐标中可能会更好（只需在图像像素和矩阵上进行双循环）。尝试两种方式！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-13T00:36:15.520

实际上，您不需要使用足够大的 FFT 大小来容纳整个图像。您可以做很多较小的重叠 2d ffts。您可以搜索“快速卷积”“重叠保存”“重叠添加”。

但是，对于 9x9 内核。在速度方面，您可能看不到太多优势。

# python - 是否有跨平台的 python 低级 API 来捕获或生成键盘事件？

> ID：676713
> 
> 赞同：11
> 
> 时间：2009-03-24T09:48:25.817
> 
> 标签：python, cross-platform, keyboard-events, low-level-api

我正在尝试编写一个跨平台的 python 程序，该程序将在后台运行，监视所有键盘事件，当它看到一些特定的快捷键时，它会生成一个或多个自己的键盘事件。例如，将 Ctrl-@ 映射到“my.email@address”可能会很方便，因此每次某些程序要求我提供电子邮件地址时，我只需键入 Ctrl-@。

我知道这样的程序已经存在，我正在重新发明轮子……但我的目标只是更多地了解低级键盘 API。此外，这个问题的答案可能对其他程序员有用，例如，如果他们想要启动需要密码的 SSH 连接，而不使用 pexpect。

谢谢你的帮助。

注意：有[一个类似的问题](https://stackoverflow.com/questions/310576/low-level-keyboard-input-on-windows)，但仅限于 Windows 平台，不需要 python。我正在寻找一个跨平台的python api。还有其他与键盘事件相关的问题，但显然他们对系统范围的键盘事件不感兴趣，只对应用程序特定的键盘快捷键感兴趣。

编辑：我可能应该在这里添加一个免责声明：我*不想*写键盘记录器。如果我需要一个键盘记录器，无论如何我都可以从网上下载一个。;-)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T10:15:09.387

没有这样的 API。我的解决方案是编写一个辅助模块，它会根据`os.name`.

在 Windows 上，使用[Win32 扩展](http://python.net/crew/mhammond/win32/Downloads.html)。

在 Linux 上，事情要复杂一些，因为真正的操作系统会保护他们的用户免受键盘记录器的攻击[*]。因此，在这里，您将需要一个根进程来监视`/dev/input/`. 您最好的选择可能是在下面寻找一个`/dev/input/by-path/`包含字符串`"kbd"`或`"keyboard"`. 这在大多数情况下应该有效。

[*]：天哪，当我启动一个与键盘事件挂钩的 Python 程序时，甚至我的病毒/木马扫描程序都不会抱怨...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-07-27T17:44:51.913

作为编写原始 pykeylogger linux 端口的人，我可以说没有真正的跨平台。本质上，我使用记录扩展重写了用于从 xserver 本身捕获键盘事件的 pyhook API。当然，这假设记录扩展存在，已加载到 x 服务器中。

从那里开始，它基本上只是检测您是在 Windows 还是 linux 上，然后为操作系统加载正确的模块。其他一切都应该相同。

看看 pykeylogger 源代码，在 pyxhook.py 中用于类和实现。否则，只需加载该模块或 pyhook，具体取决于操作系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-03T08:44:38.160

我在 Ubuntu 9.10 上做了一些测试。pykeylogger 似乎没有工作。我尝试更改 /etc/X11/xorg.conf 以允许加载模块，但在特定版本的 ubuntu 中没有 xorg.conf。所以，在我看来，pykelogger 不能在 ubuntu 9.10 上运行！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T10:23:58.027

[Tkinter](http://wiki.python.org/moin/TkInter)或[wxPython](http://www.wxpython.org/)等跨平台 UI 库具有用于键盘事件的 API。使用这些您可以将 «CTRL» + «@» 映射到一个动作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T13:23:18.727

在 linux 上，您可能想看看[pykeylogger](http://pykeylogger.wiki.sourceforge.net/)。出于某种奇怪的原因，从 /dev/input/.... 读取数据在 X 运行时并不总是有效。例如，它不适用于 ubuntu 8.10。Pykeylogger 使用 xlib，当其他方式不使用时，它完全可以工作。我还在研究这个，所以如果你找到更简单的方法，请告诉我。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-26T09:59:02.060

在 Linux 下，使用 Xlib 很容易做到这一点。有关详细信息，请参阅此页面：

[http://www.larsen-b.com/Article/184.html](http://www.larsen-b.com/Article/184.html)

# jsp - jetty 显示jsp文件的代码

> ID：676720
> 
> 赞同：0
> 
> 时间：2009-03-24T09:51:12.487
> 
> 标签：jsp

我正在尝试使用码头部署我的 Web 应用程序，但码头显示 jsp 文件的代码在地址：[http://localhost:8080/index.jsp](http://localhost:8080/index.jsp) 这与我的浏览器有关系吗？还是码头的问题？有人可以帮帮我吗！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T10:12:19.737

确保包含 jsp 和 jsp-api jar。否则 jetty 无法渲染 jsp 页面。

# javascript - 使用动态参数数调用动态函数

> ID：676721
> 
> 赞同：154
> 
> 时间：2009-03-24T09:51:35.013
> 
> 标签：javascript, function

我正在寻找一个技巧。我知道如何在 JavaScript 中调用动态的任意函数，传递特定的参数，如下所示：

```
function mainfunc(func, par1, par2){
    window[func](par1, par2);
}

function calledfunc(par1, par2){
    // Do stuff here
}

mainfunc('calledfunc', 'hello', 'bye'); 
```

我知道如何使用`arguments`里面的集合传递可选的、无限的参数`mainfunc`，但是，我不知道如何发送任意数量的参数`mainfunc`以动态发送`calledfunc`；我怎样才能完成这样的事情，但是使用任意数量的可选参数（不使用那个丑陋的`if`-<code>else）？

```
function mainfunc(func){
    if(arguments.length == 3)
        window[func](arguments[1], arguments[2]);
    else if(arguments.length == 4)
        window[func](arguments[1], arguments[2], arguments[3]);
    else if(arguments.length == 5)
        window[func](arguments[1], arguments[2], arguments[3], arguments[4]);
}

function calledfunc1(par1, par2){
    // Do stuff here
}

function calledfunc2(par1, par2, par3){
    // Do stuff here
}

mainfunc('calledfunc1', 'hello', 'bye');
mainfunc('calledfunc2', 'hello', 'bye', 'goodbye'); 
```

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2009-03-24T09:55:12.290

使用函数的 apply 方法：-

```
function mainfunc (func){
    window[func].apply(null, Array.prototype.slice.call(arguments, 1));
} 
```

**编辑**：在我看来，稍微调整一下会更有用：-

```
function mainfunc (func){
    this[func].apply(this, Array.prototype.slice.call(arguments, 1));
} 
```

这将在浏览器之外工作（`this`默认为全局空间）。在 mainfunc 上使用 call 也可以：-

```
function target(a) {
    alert(a)
}

var o = {
    suffix: " World",
    target: function(s) { alert(s + this.suffix); }
};

mainfunc("target", "Hello");

mainfunc.call(o, "target", "Hello"); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-24T10:05:37.820

您的代码仅适用于全局函数，即。对象的成员`window`。要将其与任意函数一起使用，请将函数本身而不是其名称作为字符串传递：

```
function dispatch(fn, args) {
    fn = (typeof fn == "function") ? fn : window[fn];  // Allow fn to be a function object or the name of a global function
    return fn.apply(this, args || []);  // args is optional, use an empty array by default
}

function f1() {}

function f2() {
    var f = function() {};
    dispatch(f, [1, 2, 3]);
}

dispatch(f1, ["foobar"]);
dispatch("f1", ["foobar"]);

f2();  // calls inner-function "f" in "f2"
dispatch("f", [1, 2, 3]);  // doesn't work since "f" is local in "f2" 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-24T09:56:33.130

你可以使用[`.apply()`](http://www.webreference.com/js/column26/apply.html)

你需要指定一个`this`......我想你可以使用`this`within `mainfunc`。

```
function mainfunc (func)
{
    var args = new Array();
    for (var i = 1; i < arguments.length; i++)
        args.push(arguments[i]);

    window[func].apply(this, args);
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-24T12:09:09.223

这是您需要的：

```
function mainfunc (){
    window[Array.prototype.shift.call(arguments)].apply(null, arguments);
} 
```

第一个参数用作函数名，其余的所有参数都用作被调用函数的参数...

我们可以使用该`shift`方法返回然后从参数数组中删除第一个值。请注意，我们从 Array 原型中调用它，因为严格来说，“arguments”不是真正的数组，因此不会`shift`像常规数组那样继承方法。

* * *

你也可以像这样调用 shift 方法：

```
[].shift.call(arguments); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-06-08T11:03:45.653

最简单的方法可能是：

```
var func='myDynamicFunction_'+myHandler;
var arg1 = 100, arg2 = 'abc';

window[func].apply(null,[arg1, arg2]); 
```

假设，该目标函数已附加到“窗口”对象。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-02-23T11:48:55.703

如果你想传递一些其他的“参数”，你必须一起创建所有参数的数组，即像这样：

```
var Log = {
    log: function() {
        var args = ['myarg here'];
        for(i=0; i<arguments.length; i++) args = args.concat(arguments[i]);
        console.log.apply(this, args);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-08T13:26:12.523

现在我正在使用这个：

```
Dialoglar.Confirm = function (_title, _question, callback_OK) {
    var confirmArguments = arguments;
    bootbox.dialog({
        title: "<b>" + _title + "</b>",
        message: _question,
        buttons: {
            success: {
                label: "OK",
                className: "btn-success",
                callback: function () {
                    if (typeof(callback_OK) == "function") {                            callback_OK.apply(this,Array.prototype.slice.call(confirmArguments, 3));
                    }
                }
            },
            danger: {
                label: "Cancel",
                className: "btn-danger",
                callback: function () {
                    $(this).hide();
                }
            }
        }
    });
}; 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2016-05-20T11:13:34.193

```
function a(a, b) {
    return a + b
};

function call_a() {
    return a.apply(a, Array.prototype.slice.call(arguments, 0));
}

console.log(call_a(1, 2)) 
```

> 控制台：3

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-03-24T09:55:54.397

你不能直接传递`arguments`数组吗？

```
function mainfunc (func){
    // remove the first argument containing the function name
    arguments.shift();
    window[func].apply(null, arguments);
}

function calledfunc1(args){
    // Do stuff here
}

function calledfunc2(args){
    // Do stuff here
}

mainfunc('calledfunc1','hello','bye');
mainfunc('calledfunc2','hello','bye','goodbye'); 
```

* * *

## 回答 #10

> 赞同：-7
> 
> 时间：2013-11-08T08:17:41.003

如果有人仍在寻找具有动态参数的动态函数调用 -

```
callFunction("aaa('hello', 'world')");

    function callFunction(func) {
                try
                {
                    eval(func);
                }
                catch (e)
                { }
            }
    function aaa(a, b) {
                alert(a + ' ' + b);
            } 
```

# image - 使用 extjs 在网格中显示图像

> ID：676727
> 
> 赞同：11
> 
> 时间：2009-03-24T09:54:26.363
> 
> 标签：image, extjs, grid, icons

我是 extjs 的新手。我想为每个网格元素显示图标图像。你能帮帮我吗？

我正在从 xml 文件中获取图像路径。

我的代码如下。在这里，我正在显示图像路径。

我必须通过显示图像来替换它。

```
Ext.onReady(function(){

      var store = new Ext.data.Store({
        url: 'new_frm.xml',

               reader: new Ext.data.XmlReader({
               record: 'message',
               fields: [{name: 'first'},{name: 'last'},{name: 'company'},{name: 'email'},{name: 'gender'},{name: 'form-file'},{name: 'state'},{name: 'Live'},{name: 'content'}]
           })
    });

      var grid = new Ext.grid.GridPanel({
        store: store,
        columns: [
            {header: "First Name", width: 120, dataIndex: 'first', sortable: true},
            {header: "Last Name", width: 180, dataIndex: 'last', sortable: true},
            {header: "Company", width: 115, dataIndex: 'company', sortable: true},          
            {header: "Email", width: 100, dataIndex: 'email', sortable: true},
            {header: "Gender", width: 100, dataIndex: 'gender', sortable: true},
            {header: "Photo", width: 100, dataIndex: 'form-file', sortable: true},
            {header: "State", width: 100, dataIndex: 'state', sortable: true},
            {header: "Living with", width: 100, dataIndex: 'Live', sortable: true},
            {header: "Commands", width: 100, dataIndex: 'content', sortable: true}

        ],
        renderTo:'example-grid',
        height:200
    });

    store.load();
}); 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-13T16:04:51.583

您需要将渲染器添加到要显示图像的列中。渲染器值是调用以渲染图像标签的函数。

您的列元素之一已修改：

```
{header: "Photo", width: 100, renderer:renderIcon, dataIndex: 'form-file', sortable: true}, 
```

示例渲染器函数：

```
function renderIcon(val) {
    return '<img src="' + val + '">';
} 
```

在此示例中，dataIndex 的值必须是图像的完整路径。如果没有，那么您必须添加一些额外的逻辑。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T19:21:20.027

可以针对您的特定问题采用的另一种替代方法是在 CSS 文件中设置图像，例如：

```
.icon-red {
    background-image:  url('red.png');
    background-repeat: no-repeat;
}

.icon-green {
    background-image:  url('green.png');
    background-repeat: no-repeat;
} 
```

然后创建一个渲染以在渲染时添加到单元元数据：

```
renderIcon: function(value, metadata, record, rowIndex, colIndex, store) {

    // set the icon for the cells metadata tags
    if (value > 0) {
        metadata.css = metadata.css + ' icon-green ';
    } else {
        metadata.css = metadata.css + ' icon-red ';
    }

    // add an individual qtip/tooltip over the icon with the real value
    metadata.attr = 'ext:qtip="' + (value) + '"';

    return '&nbsp;';
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T21:13:02.903

尝试在要在其中显示图像的列声明上使用“render”属性。使用 Render 属性，您可以输出您选择的 HTML。在 ExtJs 论坛上查看 :) 希望为您指明正确的方向

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-27T06:00:48.537

这是更好的模式，应用一个小部件列和小部件图像类型，如下所示：

```
columns:[
      {text:'Image', xtype:'widgetcolumn', widget:{xtype:'image', src: 'http://www.sencha.com/img/20110215-feat-html5.png'}, dataIndex:'image'}] 
```

在 extjs 6

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T04:57:08.870

您可以将 xml 文件编写为 htmlspecialchars("") 然后您可以简单地查看它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-10T05:22:21.403

为了显示您的名字列的图标，请执行以下更改

```
{header: "First Name", width: 120, renderer:first, dataIndex: 'first', sortable: true}, 
```

使功能为

```
function first(val)
{
return '<img src="' + val + '">';
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-06-23T23:24:54.673

简单的

在他的 Json 中传递字符串`< img src = " " />`

在 dataIndex 之后：

```
fields:[

{name: 'images', type: 'string'}

]

{

text: 'images',

dataIndex: 'images'

} 
```

# c# - 用于文件操作的 C# 线程

> ID：676731
> 
> 赞同：3
> 
> 时间：2009-03-24T09:55:47.080
> 
> 标签：c#, multithreading, io

我必须能够保存一个文件，不幸的是它可能非常大，所以保存它可能需要几分钟。由于我需要从 GUI 线程执行此操作，因此我不想阻止 GUI 执行。我正在考虑在单独的线程上尝试保存操作以允许主 GUI 线程继续执行。

有没有一种很好（简单）的方法来生成一个新线程、保存文件并销毁线程而没有任何讨厌的副作用？！

必须说我以前从未使用过线程，所以我是一个完全的新手！任何和所有的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T09:56:56.420

您也许可以使用 BackGroundWorker 组件，因为它会为您抽象一点 Threading 部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T09:59:38.350

[`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)（正如 Frederik 建议的那样）是一个不错的选择，特别是如果您想在保存时向 UI 报告进度。[搜索 BackgroundWorker 教程](http://www.google.com/search?q=backgroundworker+tutorial)获得了很多点击，因此您应该能够按照其中一个来帮助您入门。

需要注意的一件事是：是否有任何方法可以更改您将尝试从 UI 线程中保存的数据结构？如果是这样，您应该在保存时禁用 UI 的这些方面 - 保存数据的一半（可能！）会很糟糕，然后允许用户更改其中的一些。如果您能够有效地将数据传递给后台线程，而不是从 UI 线程中接触它，那将使您的生活变得更轻松。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T10:04:50.910

您的问题可能是有几种很好且简单的方法可以做到这一点。如果您只想启动文件保存而不担心知道它何时完成，那么有一个方法

```
void SaveMyFile(object state)
{
    // SaveTheFile
} 
```

并用

```
ThreadPool.QueueUserWorkItem( SaveMyFile ); 
```

会做你想做的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T11:16:40.083

我建议做异步 I/O。设置起来更容易一些，并且不需要您自己创建新线程。

例如，异步编程是您想要写入但不想等待它完成的文件流。您可能希望在完成时收到通知，但您不想等待。

您所做的是使用Stream 类上可用的[BeginWrite](http://msdn.microsoft.com/en-us/library/system.io.stream.beginwrite(VS.80).aspx) / [BeginRead](http://msdn.microsoft.com/en-us/library/system.io.stream.beginread(VS.80).aspx)和[EndWrite](http://msdn.microsoft.com/en-us/library/system.io.stream.endwrite(VS.80).aspx) / [EndRead函数。](http://msdn.microsoft.com/en-us/library/system.io.stream.endread(VS.80).aspx)

在您的方法中，您首先使用您要写入的所有数据调用 BeginWrite，并传入一个回调函数。BeginWrite 完成后将调用此函数。

在回调函数中，您调用 EndWrite 并清理流并检查错误。

BeginWrite 不会阻塞，这意味着如果从事件处理程序中调用它，线程可以完成该处理程序并继续处理更多事件（例如其他 GUI 事件）。

```
using System;
using System.IO;
using System.Text;

class Program
    {
        private static FileStream stream;
        static void Main(string[] args)
        {
            stream = new FileStream("foo.txt", 
                                    FileMode.Create, 
                                    FileAccess.Write);

            const string mystring = "Foobarlalala";
            ASCIIEncoding encoding = new ASCIIEncoding();
            byte[] data = encoding.GetBytes(mystring);
            Console.WriteLine("Started writing");
            stream.BeginWrite(data, 0, data.Length, callback, null);
            Console.WriteLine("Writing dispatched, sleeping 5 secs");
            System.Threading.Thread.Sleep(5000);
        }

        public static void callback(IAsyncResult ia)
        {
            stream.EndWrite(ia);
            Console.WriteLine("Finished writing");
        }
    }
} 
```

睡眠非常重要，因为如果主线程被杀死，正在写东西的线程将被杀死。这在 GUI 应用程序中不是问题，仅在这个小示例中。

MSDN对如何编写这些东西有[很好的概述，以及一些关于异步编程的](http://msdn.microsoft.com/en-us/library/kztecsys(VS.80).aspx)[好文章](http://msdn.microsoft.com/en-us/library/ms228969(VS.80).aspx)，以防你选择[backgroundworker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker(VS.80).aspx)或[ThreadPool](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T10:09:23.333

或者你可以使用老朋友代表。

# .net - .Net DriveInfo() 与 UNC 路径？

> ID：676734
> 
> 赞同：3
> 
> 时间：2009-03-24T09:56:34.627
> 
> 标签：.net, unc, driveinfo

早上好，

有没有办法为 UNC 路径获取 DriveInfo 实例（例如“\fors343a.ww123.somedomain.net\folder\1\”），因为例如......

```
var driveInfo = new System.IO.DriveInfo(drive); 
```

... 当使用上面的 UNC 路径时，会引发 ArgumentException（“对象必须是根目录 (\"C:\\") 或驱动器号 (\"C\")。"）。

我将使用什么来检索有关该信息的信息，或者例如，我将如何检查给定文件夹是否驻留在本地驱动器或 unc 路径上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T22:37:16.250

构造函数的备注部分`DriveInfo`说：

> 驱动器名称必须是从“a”到“z”的大写或小写字母。您不能使用此方法获取有关为 nullNothingnullptra 空引用（Visual Basic 中为 Nothing）或使用 UNC (\server\share) 路径的驱动器名称的信息。

我可以通过在 Windows 资源管理器中映射网络驱动器来使其工作。也就是说，我将“\server\share”映射到驱动器 Z，然后`DriveInfo("Z:\\");`给了我我所期望的。

不幸的是，没有简单的方法可以从 C# 映射网络驱动器。您要么必须执行外部命令（即“net use z:\server\share”），要么调用 Windows [WNetAddConnection2](http://msdn.microsoft.com/en-us/library/aa385413(VS.85).aspx) API 函数来执行此操作。无论哪种方式，完成后都需要删除驱动器映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-01T00:54:06.610

在 Windows 上，以下在 C# 中效果很好（至少要获得最常用的尺寸）：

```
 [return: MarshalAs(UnmanagedType.Bool)]
    [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
    private static extern bool GetDiskFreeSpaceEx(string lpDirectoryName, out ulong lpFreeBytesAvailable, out ulong lpTotalNumberOfBytes, out ulong lpTotalNumberOfFreeBytes); 
```

这是一些示例代码（实际上并没有以这种形式编译，而是分散在多个文件中的工作代码的点点滴滴）：

```
/// <summary>
/// A compilation of the properties of folders and files in a file system.
/// </summary>
public struct FileSystemProperties
{
    private FileSystemProperties(long? totalBytes, long? freeBytes, long? availableBytes)
        : this()
    {
        TotalBytes = totalBytes;
        FreeBytes = freeBytes;
        AvailableBytes = availableBytes;
    }
    /// <summary>
    /// Gets the total number of bytes on the drive.
    /// </summary>
    public long? TotalBytes { get; private set; }
    /// <summary>
    /// Gets the number of bytes free on the drive.
    /// </summary>
    public long? FreeBytes { get; private set; }
    /// <summary>
    /// Gets the number of bytes available on the drive (counts disk quotas).
    /// </summary>
    public long? AvailableBytes { get; private set; }

    /// <summary>
    /// Gets the properties for this file system.
    /// </summary>
    /// <param name="volumeIdentifier">The path whose volume properties are to be queried.</param>
    /// <param name="cancel">An optional <see cref="CancellationToken"/> that can be used to cancel the operation.</param>
    /// <returns>A <see cref="FileSystemProperties"/> containing the properties for the specified file system.</returns>
    public static FileSystemProperties GetProperties(string volumeIdentifier)
    {
        ulong available;
        ulong total;
        ulong free;
        if (GetDiskFreeSpaceEx(volumeIdentifier, out available, out total, out free))
        {
            return new FileSystemProperties((long)total, (long)free, (long)available);
        }
        return new FileSystemProperties(null, null, null);
    }
    /// <summary>
    /// Asynchronously gets the properties for this file system.
    /// </summary>
    /// <param name="volumeIdentifier">The path whose volume properties are to be queried.</param>
    /// <param name="cancel">An optional <see cref="CancellationToken"/> that can be used to cancel the operation.</param>
    /// <returns>A <see cref="Task"/> containing the <see cref="FileSystemProperties"/> for this entry.</returns>
    public static async Task<FileSystemProperties> GetPropertiesAsync(string volumeIdentifier, CancellationToken cancel = default(CancellationToken))
    {
        return await Task.Run(() =>
        {
            ulong available;
            ulong total;
            ulong free;
            if (GetDiskFreeSpaceEx(volumeIdentifier, out available, out total, out free))
            {
                return new FileSystemProperties((long)total, (long)free, (long)available);
            }
            return new FileSystemProperties(null, null, null);
        }, cancel);
    }
} 
```

不要试图在 Linux 或 Mac 上使用它——它必须为那些重写（我很想看看）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-25T10:56:22.533

这是一篇旧帖子，但两个答案都不是最简单的答案：阅读注册表并获取映射的驱动器 + UNC 路径。

注册表路径是 HKCU\Network。每个键都是映射的驱动器号，RemotePath 值是驱动器映射的 UNC 路径。

简单的注册表读取。

# apache-flex - 在 flex 的预加载器中访问 flashvars？

> ID：676737
> 
> 赞同：3
> 
> 时间：2009-03-24T09:58:05.233
> 
> 标签：apache-flex, preloader, flashvars

我想在我的预加载器中访问 Flex 应用程序中的一些 flashvar。这怎么可能？

问候阿德勒茨

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T10:15:56.720

试试`loaderInfo.parameters`预加载器的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T20:23:11.643

从预加载器中，您应该能够通过 SystemManager 间接访问 flashvar，如下所示：

```
var systemManager:SystemManager = parent.parent as SystemManager;
var params:Object = LoaderInfo(systemManager.loaderInfo).parameters; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T10:17:26.503

我已经使用 loaderinfo 从我的预加载器精灵的根目录访问了 flashvars。

var flashvars:Object = root.loaderInfo.parameters;

棘手的部分是要知道根何时不为空。但是我找到了一篇博文：

[http://dndigital.net/blog/2008/08/accessing-flashvars-in-a-custom-flex-preloader/](http://dndigital.net/blog/2008/08/accessing-flashvars-in-a-custom-flex-preloader/)

# c# - 如何在 ASP.NET 项目中设置全局 DateTime 格式？

> ID：676740
> 
> 赞同：0
> 
> 时间：2009-03-24T09:59:37.303
> 
> 标签：c#, asp.net, localization

我有一台带有德文窗口的服务器，但 DateTime 值以英文格式存储在 mysql 服务器上。我如何强制每个 DateTime.ToString() 方法（如 DateTime.Now.ToString()）默认输出一个“英语”日期时间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T10:23:04.783

我会在 web.config 中设置文化，因此任何文化特定的转换或解析，即日期，将使用相同的文化，而不管底层操作系统区域如何。

IE

```
<globalization culture="en-GB" uiCulture="en-GB"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T10:14:40.623

我建议您尝试使您的 mysql 环境和 .net 环境都使用通用日期时间格式而不是本地化版本。然后，您可以随时使用 DateTime.ToString("U") 使用可靠的格式。

除此之外，您应该能够将日期作为日期类型参数而不是字符串传递给数据库，因此它将为您处理基础转换。我使用 SqlServer 虽然不是 MySql 所以我不知道你是否得到相同的结果。

# jsf - JSF f:selectItem in h:selectManyCheckbox 在支持 bean 中不起作用，但在 h:dataTable 中正确显示

> ID：676743
> 
> 赞同：0
> 
> 时间：2009-03-24T10:01:40.933
> 
> 标签：jsf, lifecycle, valuechangelistener, selectmanycheckbox

此代码出现问题：

```
<h:form>
    <rich:panel>
        <f:facet name="header">
            <h:selectManyCheckbox title="Select which types of requests you want to see"
                                  onchange="submit();" value="#{filterListener.chosenFilters}"
                                  id="selectBoxContainer" >
                <f:selectItem id="approvedByITS" itemLabel="Approved by ITS" itemValue="approvedByITS"  />
                <f:selectItem id="approvedByPO" itemLabel="Approved by Process Owner" itemValue="approvedByPO"   />
                <f:selectItem id="dob" itemLabel="Date" itemValue="dob"   />
                <f:selectItem id="externalAssignedTo" itemLabel="External assigned" itemValue="externalAssignedTo"  />
                <f:selectItem id="internalAssignedTo" itemLabel="Internal assigned" itemValue="internalAssignedTo"   />
                <f:selectItem id="ITSapprovedBy" itemLabel="ITS approved by" itemValue="ITSapprovedBy"  />
                <f:selectItem id="severity" itemLabel="Severity" itemValue="severity"  />
                <f:selectItem id="status" itemLabel="status" itemValue="status" />
                <f:valueChangeListener type="no.ngt.tech.rt2.listeners.requestFilterListener" />
            </h:selectManyCheckbox>
        </f:facet>

        <h:dataTable value="#{filterListener.chosenFilters}" var="selects" >
            <h:column>
                <h:outputText value="#{selects}" />
            </h:column>
        </h:dataTable>
        <br />
        <h:messages />

    </rich:panel>
</h:form> 
```

正如我们所看到的，我的值=“#{filterListener.chosenFilters}”。dataTable 的值也是相同的，所以每当我单击其中一个 selectItem 时，dataTable 都会添加或删除一个元素（这是有效的）。在我的支持 bean 中，我有以下代码：

```
public class requestFilterListener implements ValueChangeListener {

    private List<String> chosenFilters;

    public requestFilterListener() {
    }

    public void processValueChange(ValueChangeEvent event) {
        System.out.println("processValueChange called");
        if (chosenFilters != null) {
            System.out.println(chosenFilters.size());
        }
    }

    public List<String> getChosenFilters() {
        return chosenFilters;
    }

    public void setChosenFilters(List<String> chosenFilters) {
        this.chosenFilters = chosenFilters;
    } 
```

每次单击其中一个复选框时，都会使用正确的数据添加/删除一列，在我的控制台中，当我在 processValueChange 方法中输出时，我会收到消息“processValueChange called”，但在此期间， selectedFilters 始终为空，并且 if表达式永远不会运行。怎么会？这是一个会话 bean，我真的不明白为什么我的列表不能在支持 bean 中使用，但我的 dataTable 可以毫无问题地使用它。

感谢您花时间调查此事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T12:10:25.460

问题可能出在这个标签上：

```
<f:valueChangeListener type="no.ngt.tech.rt2.listeners.requestFilterListener" /> 
```

您正在指示[f:valueChangeListener](http://java.sun.com/javaee/javaserverfaces/1.2_MR1/docs/tlddocs/f/valueChangeListener.html)标记创建*requestFilterListener*的新实例，而不是绑定到托管 bean 配置指定的实例。使用*binding*属性绑定到*#{filterListener}*。

# .net - 自定义 html 助手：使用“使用”语句支持创建助手

> ID：676746
> 
> 赞同：39
> 
> 时间：2009-03-24T10:04:21.363
> 
> 标签：.net, asp.net-mvc, html-helper

我正在编写我的第一个 asp.net mvc 应用程序，我有一个关于自定义 Html 助手的问题：

要制作表格，您可以使用：

```
<% using (Html.BeginForm()) {%>
   *stuff here*
<% } %> 
```

我想用自定义 HTML 助手做类似的事情。换句话说，我想改变：

```
Html.BeginTr();
Html.Td(day.Description);
Html.EndTr(); 
```

进入：

```
using Html.BeginTr(){
    Html.Td(day.Description);
} 
```

这可能吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-24T10:39:54.993

这是 c# 中可能的可重用实现：

```
class DisposableHelper : IDisposable
{
    private Action end;

    // When the object is created, write "begin" function
    public DisposableHelper(Action begin, Action end)
    {
        this.end = end;
        begin();
    }

    // When the object is disposed (end of using block), write "end" function
    public void Dispose()
    {
        end();
    }
}

public static class DisposableExtensions
{
    public static IDisposable DisposableTr(this HtmlHelper htmlHelper)
    {
        return new DisposableHelper(
            () => htmlHelper.BeginTr(),
            () => htmlHelper.EndTr()
        );
    }
} 
```

在这种情况下，`BeginTr`直接`EndTr`写入响应流。如果您使用返回字符串的扩展方法，则必须使用以下命令输出它们：

```
htmlHelper.ViewContext.HttpContext.Response.Write(s) 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2011-05-19T21:47:29.177

我尝试按照 MVC3 中给出的建议进行操作，但在使用时遇到了麻烦：

```
htmlHelper.ViewContext.HttpContext.Response.Write(...); 
```

当我使用这段代码时，我的助手在我的布局被渲染之前写入响应流。这效果不好。

相反，我使用了这个：

```
htmlHelper.ViewContext.Writer.Write(...); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-24T10:38:24.887

如果您查看 ASP.NET MVC 的源代码（可在[Codeplex](http://www.codeplex.com/aspnet)上获得），您将看到 BeginForm 的实现最终会调用以下代码：

```
static MvcForm FormHelper(this HtmlHelper htmlHelper, string formAction, FormMethod method, IDictionary<string, object> htmlAttributes)
{
    TagBuilder builder = new TagBuilder("form");
    builder.MergeAttributes<string, object>(htmlAttributes);
    builder.MergeAttribute("action", formAction);
    builder.MergeAttribute("method", HtmlHelper.GetFormMethodString(method), true);
    htmlHelper.ViewContext.HttpContext.Response.Write(builder.ToString(TagRenderMode.StartTag));

    return new MvcForm(htmlHelper.ViewContext.HttpContext.Response);
} 
```

MvcForm 类实现了 IDisposable，在它的 dispose 方法中将 </form> 写入响应。

因此，您需要做的是在辅助方法中编写您想要的标签并返回一个实现 IDisposable 的对象......在它的 dispose 方法中关闭标签。

# iphone - 如何在 iPhone 上录制除线性 PCM 以外的内容

> ID：676750
> 
> 赞同：5
> 
> 时间：2009-03-24T10:05:28.867
> 
> 标签：iphone, core-audio

我很难在 iPhone 上录制除线性 PCM 以外的东西 :-( 我找到的样本（SDK 的 SpeakHere、Zdziarski 和 Sadun 的书，以及 trailsinthesand.com 的书）都使用线性 PCM，但我我喜欢一种常用的压缩格式（没有 ima4 或任何名称......）。

我只是不知道如何调整要使用的示例代码，例如 AAC、MP3 或 AMR。任何关于如何做到这一点的建议和提示都非常感谢！

（顺便说一句，由于许可问题，我不认为 MP3 编码器或 AMR 编码器可用，但 AAC 确实存在，或者？？？）

**编辑/更新：**我在 Apple 的“iPhone 应用程序编程指南”，2009 年 1 月 6 日，第 137 页，部分：录制音频中偶然发现了以下文字：
“您可以以“首选音频格式”中列出的任何格式录制音频iPhone OS”（第 140 页）”，以及第 140 页上的首选音频格式是：“对于一次播放一种声音时的压缩音频，并且当您不需要与 iPod 应用程序同时播放音频时，请使用 AAC格式打包在 CAF 或 m4a 文件中。”
因此，我将其解释为一个明确的迹象，即以 AAC 格式录制并包含在 m4a 文件中的音频确实不仅是可能的，而且是更可取的，这正是我想要的。但是，我仍然无法做到这一点？！

谢谢，/约翰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T16:43:28.817

继续查看那些文档。在“Core Audio Essentials”中，“Core Audio Plug-ins: Audio Units and Codecs”部分指出：

> iPhone OS 包含表 2-5 中列出的录制编解码器。如您所见，MP3 和 AAC 录制均不可用。这是由于这些格式的高 CPU 开销和随之而来的电池消耗。

表 2-5 列出了几种格式，但由于文本注释不包括您要查找的格式。如果你想要这些格式，你必须带上你自己的编码器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-02T10:30:39.923

在 iPhone 3GS 和 iPod 第 2 代及更高版本中是可能的。他们有一个用于 AAC 的硬件编码器。有一个 Apple 示例项目可以满足您的要求：

iPhoneExtAudioFileConvertTest

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-05T02:01:47.423

使用 faac 将 iPhone 输出的线性 pcm 文件转换为 aac 格式的提示：

我通过实验发现您必须在`-X`faac 的命令行版本（在 Mac OS X 上运行）上使用该标志，它“交换输入字节”。（我猜它改变了字节序。）

因此，例如，如果您`linear.pcm`在 iPhone 上录制文件，则可以运行：

```
faac -XP linear.pcm 
```

在您的 Mac 上将其转换为 aac 文件`linear.aac`。

我猜这意味着你可以在你的应用程序中使用 faac 来进行转换，如果你愿意的话，因为它是一个 C 库。

另请注意，从技术上讲，iPhone 的音频服务输出的文件通常是 CAF 文件，即核心音频格式，它是一种围绕一系列可能编码的包装格式：[Apple 的 CAF 文档](https://developer.apple.com/library/archive/documentation/MusicAudio/Reference/CAFSpec/CAF_overview/CAF_overview.html)。上面的命令行对我来说很好，即使`linear.pcm`从`caff`标题开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T10:45:10.970

您是否尝试过[Lame](http://lame.sourceforge.net/) mp3 编码器？还是[faac/faad](http://www.audiocoding.com/) AAC 编解码器？您可以将它们嵌入[ffmpeg](http://www.ffmpeg.org/)以获得更多音频编解码器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-05T19:35:25.137

为什么不试试*传奇人物*Michael Tyson写的[TPAACAudioConverter呢？](https://github.com/michaeltyson/TPAACAudioConverter)

 *> TPAACAudioConverter 是一个简单的 Objective-C 类，它执行将任何音频文件转换为 AAC 编码的 m4a，与委托异步，或转换由数据源类提供的任何音频（提供直接录制到 AAC）。

# sql - 如何找出（运行时）t-sql 中的类型是否是固定长度的？

> ID：676752
> 
> 赞同：1
> 
> 时间：2009-03-24T10:06:13.857
> 
> 标签：sql, sql-server, tsql, dynamic-sql

如果类型（例如 nvarchar 或 int）是固定长度的，是否可以通过查询某些系统表来使用 t-sql 找出运行时？

我需要这样做的原因是我需要生成 sql-code 运行时并且需要根据某些列的类型（在设计时未知）生成一些声明（`DECLARE @foo SOMETYPE(LENGTH)`或`DECLARE @foo SOMETYPE`）。

我目前的赌注是，我可以检查是否`sys.all_columns.max_length = sys.types.max_length`以及是否假设它是固定长度的（因为`max_length`似乎有一个特殊的代码 (-1)，至少对于 nvarchar 而言）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T10:12:23.623

您可以查看 information_schema.columns。如果字符类型的列具有最大长度，它将在 character_maximum_length 中指定，数字字段的精度在 numeric_precision 中定义。几个注意事项，据我所知，int 类型始终为 4 个字节，此外，任何 var 类型根据定义都不是固定长度，并且仅存储到它们的最大长度，如果 nvarchar(10) 持有 2字符串，它只存储2个字符。因此，要检测固定长度的字符串，您需要寻找 char 或 nchar 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T10:15:37.280

是的，这是可能的。查看内置存储过程 sp_columns 的代码以了解如何执行此操作。

# sql - 使用 CFQUERYPARAM 在 SQL 中指定表/列名

> ID：676761
> 
> 赞同：2
> 
> 时间：2009-03-24T10:09:44.177
> 
> 标签：sql, coldfusion, cfqueryparam

我需要动态构造一组 JOIN 语句，其中表名和列名是从另一个 ColdFusion 查询传入的。当将字符串值传递到语句中时，CFQUERYPARAM 在其周围添加单引号 - 这是 CFQUERYPARAM 要点的一部分。鉴于这破坏了 SQL 语句，在这种情况下不使用 CFQUERYPARAM 而是确保清理传入的查询是否可以接受，或者是否有办法允许使用 CFQUERYPARAM？（我可以使用 Fusebox 中的电路/保险丝权限锁定这些代码。）

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T14:08:00.500

`cfqueryparam`不添加单引号 - 它使用绑定变量。

我立即怀疑“动态构造一组 JOIN 语句”的说法——如果你动态地加入，听起来你不一定能正确地做事。

但是，对于表/列名称，**一旦您确定完全清理**- 如果`cfqueryparam`不起作用并且您需要 cf 变量 - 那么**是**的，您可以直接使用 CF 变量。

注意：为了安全清理，您可以使用`rereplacenocase(table_name,'[^a-z_]','','all')`删除除 az 和下划线以外的所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T18:43:20.727

您可以使用其中的两个来转义单引号。您还可以使用 preserveSingleQuotes 函数。

# c - C 将十六进制转换为十进制格式

> ID：676763
> 
> 赞同：4
> 
> 时间：2009-03-24T10:11:19.087
> 
> 标签：c, decimal, hex

使用 gcc 在 linux 上编译。

我想将其转换为十六进制。10 这将是一个。我已经设法通过下面的代码做到这一点。

```
unsigned int index = 10;
char index_buff[5] = {0};
sprintf(index_buff, "0x%x", index);
data_t.un32Index = port_buff; 
```

但是，问题是我需要将它分配给一个结构，而我需要分配给的元素是一个 unsigned int 类型。

但是，这有效：

```
data_t.un32index = 0xa; 
```

但是，我的示例代码不起作用，因为它认为我正在尝试从字符串转换为无符号整数。

我试过这个，但这也失败了

```
data_t.un32index = (unsigned int) *index_buff; 
```

非常感谢您的任何建议，

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-24T10:12:45.510

嗯？如果变量中有值，十进制/十六进制无关紧要。做就是了

```
data_t.un32index = index; 
```

十进制和十六进制只是打印数字时的符号，因此人类可以阅读它们。

对于 C（或 C++、Java 或许多语言中的任何一种，其中这些类型是“原语”，其语义与机器寄存器的语义非常匹配）整数变量，它所持有的值永远不能说是“十六进制” .

该值以二进制形式保存在内存或支持变量的寄存器中（在所有典型的现代电子计算机中，它们本质上都是数字和二进制的），然后您可以生成各种字符串表示形式，这是您需要选择一个基数的时候采用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-24T10:20:25.337

我同意前面的答案，但我想我会分享实际上将十六进制字符串转换为无符号整数的代码，只是为了展示它是如何完成的：

```
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    char *hex_value_string = "deadbeef";
    unsigned int out;

    sscanf(hex_value_string, "%x", &out);

    printf("%o %o\n", out, 0xdeadbeef);
    printf("%x %x\n", out, 0xdeadbeef);

    return 0;
} 
```

执行时给出：

```
emil@lanfear /home/emil/dev $ ./hex
33653337357 33653337357
deadbeef deadbeef 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T10:16:46.327

> 但是，我的示例代码不起作用，因为它认为我正在尝试从字符串转换为无符号整数。

这是因为当您编写以下内容时：

```
data_t.un32index = index_buff; 
```

你*确实*有类型不匹配。您正在尝试将字符数组分配`index_buff`给`unsigned int`ie `data_t.un32index`。

您应该能够`index`按照建议直接将 分配给`data_t.un32index`.

# linq - 如何使用 LINQ-to-SQL 回滚对 WPF DataGrid 控件的更改？

> ID：676783
> 
> 赞同：5
> 
> 时间：2009-03-24T10:17:32.567
> 
> 标签：linq, wpfdatagrid

我能够设置 WPF Datagrid，通过 linq-to-sql 显示 Northwind 数据库表，并处理 TheDataGrid_RowEditEnding 事件，以便它保存数据库。

但是，当 CustomerID 更改时，它会从我处理的数据库中收到错误，但是**我现在如何（1）回滚 Datagrid 控件或（2）从数据库视图 LINQ-to-SQL 重新获取原始数据**（我在下面通过 LINQ 进行的重新获取似乎有某种缓存，它不会刷新）：

```
<Grid DockPanel.Dock="Bottom">
    <toolkit:DataGrid x:Name="TheDataGrid" 
                      AutoGenerateColumns="True"
                      RowEditEnding="TheDataGrid_RowEditEnding"/>
</Grid>

private void TheDataGrid_RowEditEnding(object sender, Microsoft.Windows.Controls.DataGridRowEditEndingEventArgs e)
{
    try
    {
        _db.SubmitChanges();
    }
    catch (Exception ex)
    {
        RefreshData();
        Message.Text = ex.Message;
    }
}

public void RefreshData()
{
    var customers = from c in _db.Customers
                    select c;
    TheDataGrid.ItemsSource = customers;
} 
```

# 回答：

谢谢丹尼斯，我用你的建议来得到我所追求的：

```
private void TheDataGrid_RowEditEnding(object sender, Microsoft.Windows.Controls.DataGridRowEditEndingEventArgs e)
{
    try
    {
        _db.SubmitChanges();
    }
    catch (Exception ex)
    {
        Customer customer = e.Row.Item as Customer;
        _db.Refresh(System.Data.Linq.RefreshMode.OverwriteCurrentValues, customer);
        Message.Text = ex.Message;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T11:54:00.307

首先，是否需要能够更改 CustomerID？如果这会产生错误，我想情况并非如此，因此您应该将该列标记为 ReadOnly（我相信 IsReadonly="True"）。

其次，如果您需要从数据库中刷新一个对象，您需要在数据上下文上调用 Refresh()，将您的对象作为参数传递。这将从数据库中拉回当前值。

第三，为了处理整个对象的编辑和回滚，DataGrid 支持 IEditableObject 接口，该接口允许对象公开本地类似事务的方法（基本上它在调用 BeginEdit 时制作数据的内部副本，并且可以在需要时恢复更改）。这都是一个手动过程，但如果我没记错的话，它是一个在 Windows 窗体中已经存在很长时间的界面，你应该能够找到关于它的大量信息（或者这里比我更精通的人可以提供你举几个例子）。

您可以在您的对象上实现该接口（通过部分类，因为您的对象是 LinqToSQL 类，可能由设计器生成）。

[这](http://www.codeproject.com/KB/WPF/WPFDataGridExamples.aspx)是一篇关于 DataGrid 的文章以及您可以使用的一些选项。它有点旧，但它可能会给你更多的指示。[这](http://blogs.msdn.com/vinsibal/archive/2008/10/01/overview-of-the-editing-features-in-the-wpf-datagrid.aspx)是另一个较短的。

顺便说一下，再次查看[WPF 工具包](http://www.codeplex.com/wpf)，他们刚刚发布了一个新版本（2009 年 3 月版本），它可能对版本/验证的支持比它使用的更多。

# c++ - 如何在 ofstream 上进行 fsync？

> ID：676787
> 
> 赞同：21
> 
> 时间：2009-03-24T10:19:25.773
> 
> 标签：c++, ofstream, fsync

我想确保已将 ofstream 写入磁盘设备。这样做的可移植方式（在 POSIX 系统上可移植）是什么？

`open`如果我在~~只读~~附加模式下单独文件以获取文件描述符并使用它调用，这是否解决了问题`fsync`？像这样：

```
ofstream out(filename);
/* ...
   write content into out
   ...
*/
out.close();

int fd = open(filename, O_APPEND);
fsync(fd);
close(fd); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-05-23T10:11:04.387

如果您能够使用 Boost，请尝试使用基于 file_descriptor_sink 的流，例如：

```
boost::filesystem::path filePath("some-file");
boost::iostreams::stream<boost::iostreams::file_descriptor_sink> file(filePath);

//  Write some stuff to file.

//  Ensure the buffer's written to the OS ...
file.flush();

//  Tell the OS to sync it with the real device.
//
::fdatasync(file->handle()); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T13:02:11.343

不幸的是，通过标准查看，没有提供任何类模板`basic_filebuf`或任何`basic_[io]?fstream`类模板来允许您提取底层 OS 文件描述符（以`fileno()`C stdio I/O 的方式）。

也没有`open()`将这样的文件描述符作为参数的方法或构造函数（这将允许您使用不同的机制打开文件并记录文件句柄）。

有`basic_ostream::flush()`，但是我怀疑这实际上并没有调用`fsync()`- 我希望，就像`fflush()`在 stdio 中一样，它只确保用户空间运行时库缓冲区被刷新，这意味着操作系统仍然可以缓冲数据。

所以简而言之，似乎没有办法做到这一点。:(

该怎么办？我的建议是子类化`basic_filebuf<C, T>`：

```
template <typename charT, typename traits = std::char_traits<charT> >
class my_basic_filebuf : public basic_filebuf<charT, traits> {
    ....

public:
    int fileno() { ... }
    ....
};

typedef my_basic_filebuf<char> my_filebuf; 
```

要使用它，您可以`ofstream`使用默认构造函数构造一个，然后分配新缓冲区`rdbuf()`：

```
my_filebuf buf;
buf.open("somefile.txt");

ofstream ofs;
ofs.rdbuf(&buf);

ofs << "Writing to somefile.txt..." << endl;
int fd = static_cast<my_filebuf*>(ofs.rdbuf())->fileno(); 
```

当然，您也可以派生一个新类 from`basic_ostream`以使打开文件和检索其文件描述符的过程更加方便。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-10T18:25:36.050

`std::filebuf`可能在其中的某处有一个文件描述符，但要获得它需要可怕的特定于实现的黑客攻击。

这是针对 libstdc++ 的一个如此可怕的 hack。

```
#include <fstream>
#include <unistd.h>

int GetFileDescriptor(std::filebuf& filebuf)
{
  class my_filebuf : public std::filebuf
  {
  public:
    int handle() { return _M_file.fd(); }
  };

  return static_cast<my_filebuf&>(filebuf).handle();
}

int main()
{
  std::ofstream out("test");

  out << "Hello, world!";
  out.flush();

  fsync(GetFileDescriptor(*out.rdbuf()));
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T10:22:41.243

您根本无法`fsync()`对打开以供读取的文件描述符进行可移植的操作。在 Linux 中，如果描述符未处于写入模式，`fsync()`则[记录](http://linux.die.net/man/2/fsync)为生成 EBADF。

# silverlight - Silverlight generic.xaml

> ID：676788
> 
> 赞同：2
> 
> 时间：2009-03-24T10:19:30.453
> 
> 标签：silverlight, coding-style

我可以在 Silverlight 中使用 generic.xaml 来设置应用程序中所有 TextBlock 的样式吗？

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/client/2007"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Style TargetType="TextBlock">
        <Setter Property="Foreground"
                Value="White" />
        <Setter Property="FontSize"
                Value="24" />
    </Style>   
</ResourceDictionary> 
```

我期待这能奏效，但它没有:-(

在整个应用程序中应用样式的最简单方法是什么？

谢谢，马克

**编辑**

感谢您的答复。我没有收到错误，只是没有应用样式。我在 Internet 上找到的所有示例（包括您列出的示例）都是用于自定义控件的样式。我可以这样做，但我只想设置默认控件的样式：

```
<TextBlock Text="Style me!!" Grid.Row="2"  /> 
```

我需要从 page.xaml 添加对 generic.xaml 的引用吗？我是否需要将 generic.xaml 样式命名并引用为资源？

再次感谢，马克

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-01-29T08:49:25.347

在 Silverlight 4 中，您可以使用[隐式样式](http://weblogs.asp.net/lduveau/archive/2009/11/18/silverlight-4-implicit-styling.aspx)！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T11:33:11.993

通过设置 TargetType 并省略 ResourceKey 来通用/自动设置样式仅适用于 WPF，而不适用于 Silverlight。

如果您想在整个应用程序中使用 Style，您可以将其添加到 App.xaml 中的 Resources 集合中，但要使用它，它需要 ax:Key 并且您必须将其作为 StaticResource 绑定单独应用到每个实例您想要使用它的目标类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T17:19:32.380

我确实相信这在 Silverlight 3 中。但其他人是对的，您需要在 Silverlight 2 中手动设置每个样式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-18T15:08:58.170

请注意，您还可以使用 Silverlight 工具包中的 ImplicitStyleManager 来执行此操作：

[http://www.codeplex.com/Silverlight/Wiki/View.aspx?title=Silverlight%20Toolkit%20Overview%20Part%203&referringTitle=Home](http://www.codeplex.com/Silverlight/Wiki/View.aspx?title=Silverlight%20Toolkit%20Overview%20Part%203&referringTitle=Home)

将样式应用于层次结构中的顶级控件，它将向下传播到所有子控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T10:26:02.497

究竟有什么不好呢？您是否收到错误消息，或者您的文本框没有获得主题？

您的方法是主题控件的正确方法，因此只需努力解决您遇到的问题。

[这](http://blogs.msdn.com/sburke/archive/2008/03/22/tutorial-writing-a-templated-silverlight-2-control.aspx)是一个很好的教程，就像[this](http://silverlight.net/blogs/jesseliberty/archive/2008/09/12/digging-into-custom-controls.aspx)一样，但请注意，在 Silverlight 2 中，您需要将通用文件放入

```
themes\generic.xaml 
```

这与您可能会找到的许多教程不同（包括上面给出的教程）

**编辑：**[这里的](http://blogs.msdn.com/jaimer/archive/2008/04/08/built-in-styling-and-generic-xaml.aspx)另一个教程

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T11:32:17.207

尝试类似的东西。

```
<UserControl.Resources>
    <Style TargetType="TextBlock" x:Name="tbStyle">        
        <Setter Property="Foreground" Value="White" />        
        <Setter Property="FontSize"  Value="24" />    
    </Style> 
</UserControl.Resources> 
```

然后在使用您的 TextBlock 时。

```
<TextBlock Style="{StaticResource tbStyle}" /> 
```

# asp.net-mvc - ASP.Net MVC - 视图中的空对象

> ID：676789
> 
> 赞同：4
> 
> 时间：2009-03-24T10:20:09.843
> 
> 标签：asp.net-mvc, linq-to-sql

当将 LINQ to SQL 模型类中的空对象引用传递给视图时，我正在寻找一种干净的方法来处理它们。

简单的例子。

TableA 有一个 FK 到 TableB。对于 TableA 中的任何行，FK 关系可能存在也可能不存在。

我的 LINQ to SQL 类将这种关系表示为 ClassA.ClassB.Property，但在某些情况下，由于外键为空，ClassA.ClassB 是空对象

我想在视图中的表中列出 ClassA.Property 和 ClassA.ClassB.Property

到目前为止，我的视图代码看起来像

```
<td>
    <% if ((classA.classB) != null) { %>
        <%= Html.Encode(classA.classB.Property)%>
    <% } %>
</td> 
```

在视图中是否有更清洁的方法来执行此操作？

我试过了

```
<td>
    <%= Html.Encode(classA.classB.Property ?? "")%>
</td> 
```

但这不起作用，因为空值不是“Property”而是“classB”。

我是整个 MVC 方面的新手，但视图似乎是选择如何处理空值显示的正确位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T10:25:12.110

<%= Html.Encode(classA.classB != null ? classA.classB.Property : "")%>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-17T20:33:32.440

获取特殊格式代码并将其封装到项目中的显示帮助器类中，以实现重用并提高可读性。

# c# - 页面、Web 服务和 Web 控件的通用继承

> ID：676796
> 
> 赞同：1
> 
> 时间：2009-03-24T10:22:50.400
> 
> 标签：c#, .net, asp.net

我有一组功能，希望在我的 c# .net 3.5 Web 项目中可用于我的网页和用户控件。我的页面标准方法是创建一个扩展 System.Web.UI.Page 类的“基本页面”，然后让我的页面继承自此，而不是直接继承自 Page 类。

我现在想将其中一些功能公开给我的 Web 控件 (ascx) 和 Web 服务。我可以想到很多方法来做到这一点，但它们似乎有点笨拙，我想我错过了一个技巧。

有没有一种简单的方法可以使用继承为我的页面、Web 服务和控件提供一些通用功能，或者我是否需要将这些功能包装在一个所有人都可以访问的类中？

一个例子来澄清：

*   我有一个单例来处理我的 Web 应用程序的大部分功能。
*   在每个请求开始时，我想检查该类是否存在于网络缓存中，如果不存在则初始化它。

最初，这是在所有页面都使用的页面库中处理的。现在我需要能够通过相同的检查从服务和控件安全地访问我的单例。因此，我将检查和初始化逻辑提取到另一个类中，然后我的每个基本页面、控件和 Web 服务都将实例化。即使使用这个模型，我在 3 个地方重复了相同的代码（控件、ws 和页面的每个基类），虽然代码不多，但这似乎也是错误的！

它有效，但看起来很笨拙......我期待你们用你们的智慧让我谦卑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T10:28:19.403

听起来像是面向方面编程的一个案例。.NET 对此毫无准备。恐怕您的解决方案是最好的解决方案之一。

或者，也许您可​​以将所有或部分这些功能移动到静态类/单例中，然后从您的 aspx/ascx/asmx 中使用该类？继承的方式不多，但至少代码重复更少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T10:37:33.327

我对此的解决方案是将我想要共享的所有方法和功能放在我的基本母版页类中。然后，我在用户控件基类中为每个方法和函数设置了一个等效项，如下所示：

```
 //Property in masterpage base
    public string QsSearchTerm
    {
        get
        {
            if (!String.IsNullOrEmpty(Request.QueryString["q"]))
            {
                return Helpers.SanitiseString(Server.UrlDecode(Request.QueryString["q"]));
            }
            return String.Empty;
        }
    }

    //Property in usercontrol base
    public string QsSearchTerm
    {
        get
        {
            if (Page.Master is BaseMasterPage)
            {
                return ((BaseMasterPage)Page.Master).QsSearchTerm;
            }
            return string.Empty;
        }
    } 
```

这无济于事的是您的代码重复与 Web 服务基类。我认为将上述内容重构为具有接受 HttpContext 实例的构造函数的类将是前进的方向。然后，您可以在基本 Web 服务、母版页、用户控件、页面等中公开此类的单例实例。

希望这会有所帮助，但如果有更好的方法，我也很想听听。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T19:16:36.463

在您的 Singleton 中，您可以提供一个 Strategy 接口，以允许根据配置的环境更改代码。这将允许您在 web/windows/wcf...等等之间切换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T14:34:43.557

我认为使用 BasePage 是正确的方法。

我有多个基本页面和自定义用户控件，根据当前页面使用的基本页面，它们的加载方式不同。

在您的自定义用户控件中，您可以使用以下内容：

```
if (this.Page is BasePageName)
{
    BasePageName bp = (BasePageName)this.Page;
    bp.BasePageFunction();
} 
```

不，您可以摆脱自定义用户控件中的重复代码，只需从基本页面调用它。

根据页面功能和需求，您还可以拥有继承的基本页面的层次结构。即） BasePageName2 ： BasePageName

# c++ - 加载大型 XML 文件时的内存管理

> ID：676797
> 
> 赞同：1
> 
> 时间：2009-03-24T10:22:53.830
> 
> 标签：c++, xml, memory, memory-management

我们有一个从 XML 导入对象的应用程序。XML 大约为 15 GB。应用程序总是开始耗尽内存。我们试图在操作之间释放内存，但这会导致性能下降。即完成导入操作需要更多时间。CPU利用率达到100%

该应用程序是用 C++ 编写的。

频繁调用`free()`会导致性能问题吗？

* * *

从 OP 的评论中提拔：在 expat 中使用的解析器，这是一个 SAX 解析器，占用空间非常小，并且可以自定义内存管理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T10:28:50.027

使用[SAX](http://en.wikipedia.org/wiki/Simple_API_for_XML)解析器而不是[DOM](http://en.wikipedia.org/wiki/Document_Object_Model)解析器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T10:29:23.583

您是否尝试过恢复内存和您的课程，而不是释放和重新分配它？恒定的分配/解除分配周期，特别是如果它们与小（小于 4096 字节）数据碎片相结合，可能会导致严重的性能问题和内存地址空间碎片。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T10:29:55.967

在这些烦人的负载之一期间分析应用程序，以查看其大部分时间都花在了哪里。

我相信这`free()`有时会很昂贵，但这当然很大程度上取决于平台的实施。

另外，您对加载的对象的寿命没有说太多。如果 XML 为 15 GB，那么一旦标记被解析并丢弃，每个“对象”会保留多少？

以流方式处理这种大小的输入文档听起来很明智，即不尝试一次加载和构建整个 XML 解析树的 DOM 方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T10:37:25.653

如果您想尽量减少内存使用量，请查看[如何使用 Visual C++ 从文件中读取 XML 数据](http://support.microsoft.com/kb/815658)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T17:10:15.507

通常有帮助的一件事是使用轻量级的低开销内存池。如果将其与“帧”分配方法结合使用（在完成所有数据处理之前忽略任何删除/释放），您可以获得快得离谱的东西。

我们最近为嵌入式系统这样做，主要是出于性能原因，但它也节省了大量内存。

诀窍基本上是分配一个大块——比我们需要的稍微大一点（如果你愿意，你可以分配一个块链）——然后继续返回一个“当前”指针（通过 allocSize 向上增加，向上取整在我们的例子中，每次最大对齐要求为 4）。这将我们每个分配的开销从大约 52-60 字节减少到 <= 3 字节。我们也忽略了“free”调用，直到我们都完成了解析然后释放了整个块。

如果您对帧分配足够聪明，则可以节省大量空间和时间。它可能无法让您一直达到 15GiB，但值得看看您真正拥有多少空间开销......我对基于 DOM 的系统的经验是，它们使用大量小型分配，每个分配都具有相对较高的高架。

（如果你有虚拟内存，一个大的“块”甚至可能不会造成太大的伤害，如果你在任何给定时间的访问都是本地的一页或三页......）

显然，从长远来看，您必须保留实际需要的内存，但是解析器的“临时内存”通过这种方式变得更加高效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T10:30:03.987

> 我们试图在操作之间释放内存，但这会导致性能下降。
> 
> 频繁调用 free() 会导致性能问题吗？

根据提供的证据，是的。

既然您已经在使用 expat，一个 SAX 解析器，那么您到底在做什么`free`？如果可以释放它，为什么`malloc`首先要循环使用它？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T10:30:20.133

也许，它应该说探查器。

也不要忘记使用堆是单线程的。我的意思是，如果您的线程的展位将按时分配/释放内存，那么其中一个线程将在第一次完成时等待。

如果您为相同的对象分配和释放内存，则可以创建该对象的池并执行一次分配/释放。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T10:36:59.257

尝试找到一种方法来分析您的代码。

如果您没有分析器，请尝试组织您的工作，以便您只有几个 free() 命令（而不是您建议的许多命令）。

必须在内存消耗和时间效率之间找到适当的平衡点是很常见的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-24T12:13:42.147

我自己没有尝试过，但是你听说过[XMLLite 吗](http://msdn.microsoft.com/en-us/library/ms752838(VS.85).aspx)，有一篇[MSDN](http://msdn.microsoft.com/msdnmag/issues/07/04/Xml/default.aspx)文章介绍它。它由 MS Office 内部使用。

# asp.net-mvc - 在控制器中读取 htmlAttribute

> ID：676808
> 
> 赞同：0
> 
> 时间：2009-03-24T10:28:15.380
> 
> 标签：asp.net-mvc

我有带有 htmlAttribute 参数的 Ajax.ActionLink

```
<%= Ajax.ActionLink("cool", "ViewCategory", new { id = elem.ID }, new AjaxOptions { UpdateTargetId = "score_" + elem.ID.ToString() }, new { myAttr = 123 } )%> 
```

如何在控制器方法中读取此属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T10:51:45.167

你不能。

htmlAttribute 参数所做的只是指示生成要添加到锚 html 的附加属性，并将其发送到客户端。单击锚点时，这些属性不包含在请求中。

将属性放在 id new {id = elem.ID, UpdateTargetID = ...} 旁边，这应该包含在 URL 中。

# asp.net - WCF 服务引用间歇性中断

> ID：676810
> 
> 赞同：0
> 
> 时间：2009-03-24T10:28:36.953
> 
> 标签：asp.net, wcf

我在本地开发环境中有一个服务引用，指向我们 LAN 上其他地方托管的 WCF 服务，它有时会停止工作，并出现错误，类似于“URL 处的文档未被识别为已知文档类型。 "

系统重新启动并不能修复它，而是几分钟后它会自行重新开始工作。

还有其他人经历过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T08:05:27.023

是网络问题。当我遇到问题时，我只是修复我的 LAN 连接，清除我的 DNS 缓存，然后一切都恢复正常了。

# java - 我如何保证发送“活着”的心跳？

> ID：676812
> 
> 赞同：3
> 
> 时间：2009-03-24T10:29:10.930
> 
> 标签：java, concurrency, rmi, heartbeat

我们有一个用 Java 编写的 RMI 客户端应用程序，它需要定期向服务器应用程序发送“保持活动”消息。我们将其实现为一个单独的心跳线程，它将保持活动状态消息发送到服务器，然后使用 Thread.sleep() 休眠 15 秒。

线程设置为高优先级：

```
Thread heartbeatThread = new Thread(new HeartbeatRunnable(server));
heartbeatThread.setPriority(Thread.MAX_PRIORITY);
heartbeatThread.start(); 
```

但是，当客户端运行的机器占用大量 CPU 时，我们会发现心跳丢失，这导致服务器认为我们的客户端应用程序已经死亡。

我们在我的主线程中添加了 Thread.yield() 调用，尽管这并没有解决问题。

有什么方法可以保证在我的应用程序仍在运行时按时发送心跳？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T10:38:17.883

你不能真正保证它。您可以在不同的线程中发送心跳，以防止发送心跳所花费的时间被添加到您的延迟中。还建议将两次心跳之间的延迟设置为服务器用来确定客户端死亡的时间的一半，即如果您的服务器在 15 秒后超时您的客户端，（尝试）每 7.5 秒发送一次心跳。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T10:48:11.837

这取决于哪个进程正在使用 CPU。

如果这不是您的进程，并且客户端进程确实没有响应，那么它对于所有意图和目的都没有生命，因此不发送心跳是合适的。当盒子加载过多而无法执行此操作时，有一条心跳消息显示“我已起床并且可以处理消息”会产生误导。

如果心跳消息的意图是说“此进程正在运行，但可能需要半小时才能回复您”，那么让正在处理的任何事情将该消息发送到服务器。或者将超时设置为适合客户端响应能力的超时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T13:49:38.967

您应该配置服务器在确定客户端不可用之前等待的“丢失的心跳”数量。

因此，例如，如果您的心跳间隔为 15 秒并且错过的心跳数为 4，那么服务器将最多等待 60 秒（1 分钟），然后再确定客户端无法访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T14:20:50.560

您可以通过在代码中自由地散布一个自写的“yield”函数来在非线程环境中实现用户模式线程。

同样，您可以在代码中自由地分散心跳检查函数调用。放弃线程，只需定期调用一个心跳函数来检查是否需要发送心跳。

这是一个粗略的解决方案，但鉴于您已经尝试了正确的解决方案并且它不起作用，也许这是您必须回退的东西。

事实上，你可以做的是在每个函数调用的开头放置一个宏，它可以快速检查时间并在必要时调用心跳函数。

（啊，你有 Java 中的宏吗？我认为没有 - 但你明白了）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T10:49:36.997

也许最好的解决方案是使用 Timer 的[scheduleAtFixedRate](http://java.sun.com/javase/6/docs/api/java/util/Timer.html#scheduleAtFixedRate(java.util.TimerTask,%20long,%20long))。这样，如果一个执行延迟（这在 Java 中无法避免），后续调用将不会受到影响。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T11:39:51.213

如果您希望服务器宣布它是活动的，您最好提供一个打开的套接字。在您的客户端上，只需从该套接字读取。它会阻塞（因为您的服务器没有写入任何内容），如果服务器消失/关闭，您的客户端将收到一个 IOException 指示服务器套接字/端口已消失。

这将不依赖于提供及时心跳的服务器。它使用很少的资源（服务器端的 TCP 端口，几乎没有带宽），并且在服务器（或服务器机器）变得不可用时及时显示。

# c# - Marshal.Copy 方法在 C#.NET 中引发 AccessViolationException

> ID：676814
> 
> 赞同：6
> 
> 时间：2009-03-24T10:29:27.607
> 
> 标签：c#, bitmap, access-violation

我正在开发一个可以显示来自相机的实时图像的 C# 应用程序。以下代码片段面临的问题是，当在线程中连续执行此函数时，我在 Marshal.Copy 中得到 AccessViolationException。但是，这在运行一次时会成功运行（我得到一个静态图像）。我想这与一些内存损坏问题有关。关于如何处理这个问题的任何想法/建议？

```
 private Image ByteArrayToImage(byte[] myByteArray) 
    {
        if (myByteArray != null)
        {
            MemoryStream ms = new MemoryStream(myByteArray);
            int Height = 504;
            int Width = 664;
            Bitmap bmp = new Bitmap(Width, Height, PixelFormat.Format24bppRgb);
            BitmapData bmpData = bmp.LockBits(new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.WriteOnly, bmp.PixelFormat);
            Marshal.Copy(myByteArray, 0, bmpData.Scan0, myByteArray.Length);
            bmp.UnlockBits(bmpData);

            return bmp;
        }
        return null;
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T10:59:02.043

It looks to me like you are always trying to copy the number of bytes *myByteArray.Length* to the bitmap buffer.

You are not checking that the bitmap buffer is in fact as big as that - so are probably writing off the end of the bitmap buffer.

Try checking if *myByteArray.Length* is ever greater than *bmpData.Stride x bmp.Height*

If this is the case you'll need to relook at the assumptions you've made with your hard coded values for width, height and pixel format.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-24T11:02:13.720

You shouldn't copy the entire image at once. The memory allocation of the bitmap object might not be what you expect. For example the first scan line may be stored last in memory, which would mean that the data for the second scan line would end up outside the allocated memory area for the bitmap object. Also there may be padding between the scan lines to place them on an even address.

Copy one line at a time, using bmpData.Stride to find the next scan line:

```
int offset = 0;
long ptr = bmpData.Scan0.ToInt64();
for (int i = 0; i < Height; i++) {
   Marshal.Copy(myByteArray, offset, new IntPtr(ptr), Width * 3);
   offset += Width * 3;
   ptr += bmpData.Stride;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-26T13:54:04.570

我个人见过一些堆损坏（调试故障转储），因为使用了 .Length。

如：

```
IntPtr ptr = bitmapdata.Scan0;
Marshal.Copy(pixeldata, 0, ptr, pixeldata.Length); 
```

堆损坏的解决方案是以不同的方式计算 .Length ：

```
IntPtr ptr = bitmapdata.Scan0;
int bytes = Math.Abs(bitmapdata.Stride) * bmp.Height;
Marshal.Copy(pixeldata, 0, ptr, bytes); 
```

bytes 和 .Length 有 1 个字节的差异，导致堆损坏。

**Math.Abs**​​ 直接取自 Microsoft 的示例。因为对于自下而上的位图，Stride 可能是负数。

微软示例：[https ://msdn.microsoft.com/en-us/library/system.drawing.imaging.bitmapdata.scan0%28v=vs.110%29.aspx?f=255&MSPPError=-2147217396#Examples](https://msdn.microsoft.com/en-us/library/system.drawing.imaging.bitmapdata.scan0%28v=vs.110%29.aspx?f=255&MSPPError=-2147217396#Examples)

（+ 不要忘记 .Unlock 并将其添加到 try-finally 语句中。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-14T10:07:55.393

让我们尝试将 ThreadApartmentState 更改为 Single Threaded。

此外，检查导致此错误的跨线程操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-02T07:25:30.237

也许

`BitmapData bmpData = bmp.LockBits(new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.WriteOnly, bmp.PixelFormat);`

只写的参数无效 - 在 ImageLockMode 中尝试 ReadWrite 或 ReadOnly？也许这有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-25T22:56:58.523

回答我：忘了->

```
 // Unlock the bits right after Marshal.Copy
        bmp.UnlockBits(bmpData); 
```

有没有人弄清楚这一点？这是没有答案的第四页。使用来自 msdn 的确切代码：http: [//msdn.microsoft.com/en-us/library/system.drawing.imaging.bitmapdata.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.bitmapdata.aspx) 这是：

```
 Bitmap bmp = new Bitmap("c:\\picture.jpg");

                        // Lock the bitmap's bits.  
                        Rectangle rect = new Rectangle(0, 0, bmp.Width, bmp.Height);
                        System.Drawing.Imaging.BitmapData bmpData =
                            bmp.LockBits(rect, System.Drawing.Imaging.ImageLockMode.ReadWrite,
                            bmp.PixelFormat);

                        // Get the address of the first line.
                        IntPtr ptr = bmpData.Scan0;

                        // Declare an array to hold the bytes of the bitmap.
                        int bytes = bmpData.Stride * bmp.Height;
                        byte[] rgbValues = new byte[bytes];

                        // Copy the RGB values into the array.
                        //This causes read or write protected memory
                        System.Runtime.InteropServices.Marshal.Copy(ptr, rgbValues, 0, bytes); 
```

这在优化模式下不起作用，并且在 IDE 中不作为 exe 运行。我试图提出的任何想法都是一个新项目，如果我在按下按钮时附加到进程，并多次按下此按钮会发生错误，但在我的代码中我只调用一次，无论哪种方式都不确定为什么错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-13T12:30:42.253

我搜索了一下，如果我们跳过数组大小不合适的可能性，我们[以 BitmapData.Stride 属性的备注](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.bitmapdata.stride.aspx)结尾：

> 步幅是单行像素（扫描线）的宽度，四舍五入到四字节边界。如果步幅为正，则位图是自上而下的。**如果步幅为负，则位图是自下而上的。**

所以，也许我们应该这样做：

```
BitmapData bmpData = bmp.LockBits(new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.WriteOnly, bmp.PixelFormat);
Marshal.Copy(myByteArray, 0, bmpData.Scan0 + 
( bmpData.Stride >= 0 ? 0 : bmpData.Stride*(bmp.Height-1) ),
myByteArray.Length); 
```

但我想知道：我们已经创建了位图：`new Bitmap(Width, Height, PixelFormat.Format24bppRgb);`......那么，**它怎么可能是负面的？**[ILSpy](http://ilspy.net/)
的时间：

```
public Bitmap(int width, int height, PixelFormat format)
{
    IntPtr zero = IntPtr.Zero;
    int num = SafeNativeMethods.Gdip.GdipCreateBitmapFromScan0(width, height, 0, (int)format, NativeMethods.NullHandleRef, out zero);
    if (num != 0)
    {
            throw SafeNativeMethods.Gdip.StatusException(num);
    }
    base.SetNativeImage(zero);
}

// System.Drawing.SafeNativeMethods.Gdip
[DllImport("gdiplus.dll", CharSet = CharSet.Unicode, ExactSpelling = true, SetLastError = true)]
internal static extern int GdipCreateBitmapFromScan0(int width, int height, int stride, int format, HandleRef scan0, out IntPtr bitmap); 
```

它指向我[这里](http://msdn.microsoft.com/en-us/library/ms533971%28v=vs.85%29.aspx)和[这里](http://msdn.microsoft.com/en-us/library/ms536315%28v=vs.85%29.aspx)：

```
Bitmap(
  [in]  INT width,
  [in]  INT height,
  [in]  INT stride,
  [in]  PixelFormat format,
  [in]  BYTE *scan0
); 
```

> stride [in]
> 类型：INT
> 整数，指定一个扫描行的开头和下一个扫描行的开头之间的字节偏移量。这通常（但不一定）是像素格式中的字节数（例如，2 表示每像素 16 位）乘以位图的宽度。传递给此参数的值必须是四的倍数。

*通过0是什么意思？*不知道，没找到。有人可以吗？可以用负步幅创建位图吗？（通过 .NET `new Bitmap(Width, Height, PixelFormat.Format24bppRgb)`）。无论如何，**我们至少需要检查[BitmapData.Stride](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.bitmapdata.stride.aspx)。**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-14T05:14:28.283

[我在BitmapSource Class](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapsource(v=vs.110).aspx)的代码示例中找到了 rawStride 公式。似乎值得尝试使用下面的代码创建一个数组并尝试多次执行您的复制方法而不会被轰炸。如果可以的话，这很有可能是一个数组大小问题。如果来自相机的数据与内存中位图的大小不匹配，您可能必须逐行复制数据。

```
private byte[] CreateImageByteArray(int width, int height, PixelFormat pixelFormat)
{
    int rawStride = (width * pixelFormat.BitsPerPixel + 7) / 8;
    byte[] rawImage = new byte[rawStride * height];

    return rawImage;
} 
```

您应该做的另一件事是确保在完成 Bitmap 对象后正确处理它。我偶尔会看到使用非托管代码操作且事后未清理的对象的奇怪结果。

此外，有时跨线程传输对象可能很棘手。请参阅[如何：对 Windows 窗体控件](http://msdn.microsoft.com/en-us/library/vstudio/ms171728(v=vs.110).aspx)进行[线程安全调用和在 C# 中使用 Windows 窗体控件进行线程安全调用一](http://www.c-sharpcorner.com/UploadFile/1d42da/thread-safe-calls-using-windows-form-controls-in-C-Sharp/)文。

# .net - WPF TreeView 清除选择

> ID：676819
> 
> 赞同：10
> 
> 时间：2009-03-24T10:30:50.553
> 
> 标签：.net, wpf, treeview

如何清除 WPF TreeView 中的 TreeView 选择？我试过循环`TreeNodes`并清除该`IsSelected`属性，但这是一个`ReadOnly`属性。有任何想法吗？

这`TreeView`是通过`XMLDataProvider`对象使用 XML 绑定。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-09-10T15:51:19.980

我遇到了完全相同的问题，并编写了以下代码，该代码适用于任何树视图，只需一行调用第一个函数。

```
class TomWrightsUtils
{
    public static void ClearTreeViewSelection(TreeView tv)
    {
        if (tv != null)
            ClearTreeViewItemsControlSelection(tv.Items, tv.ItemContainerGenerator);
    }
    private static void ClearTreeViewItemsControlSelection(ItemCollection ic, ItemContainerGenerator icg)
    {
        if ((ic != null) && (icg != null))
            for (int i = 0; i < ic.Count; i++)
            {
                TreeViewItem tvi = icg.ContainerFromIndex(i) as TreeViewItem;
                if (tvi != null)
                {
                    ClearTreeViewItemsControlSelection(tvi.Items, tvi.ItemContainerGenerator);
                    tvi.IsSelected = false;
                }
            }
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-24T10:43:19.743

Not sure what you mean by TreeNodes.

Typically you would have a corresponding `IsSelected` property on your view model that your view binds to:

```
<TreeView>
    <TreeView.ItemContainerStyle>
        <Style TargetType="TreeViewItem">
            <Setter Property="IsSelected" Value="{Binding IsSelected}"/>
        </Style>
    </TreeView.ItemContainerStyle>
</TreeView> 
```

Therefore, you would just loop through the data items in your view model and set `IsSelected = false` there.

However, it sounds like you don't have such a property. That being the case, you need to get the corresponding `TreeViewItem` for each data item. See the `TreeView.ItemContainerGenerator` property for info on how to do this. Something like:

```
var treeViewItem = _treeView.ItemContainerGenerator.ContainerFromIndex(0) as TreeViewItem;
treeViewItem.IsSelected = false; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-07-24T20:56:44.663

```
TreeViewItem tvi = tvMain.ItemContainerGenerator.ContainerFromIndex(0) as TreeViewItem;

if (tvi != null) { tvi.IsSelected = true; tvi.IsSelected = false; } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T10:56:46.013

Find the selected item and set the value:

```
private void Button_Click(object sender, RoutedEventArgs e)
{
  TreeViewItem tvi = treeviewExample.SelectedItem as TreeViewItem;
  if (tvi != null)
  {
    tvi.IsSelected = false;
  }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-05T19:11:36.410

这非常适合作为扩展方法，因此您可以调用

```
youTreeview.ClearSelection();

using System.Windows.Forms;
using System.Windows.Controls;

namespace YourAppNamespace
{
    public static void ClearSelection(this TreeView input)
    {
    // this should be some container that you put in
    // possibly the actual treeviewitem, not sure on that though
    var selected = input.SelectedItem;
    if (selected == null)
        return;

    // in my case this works perfectly
    var tvi = input.ItemContainerGenerator.ContainerFromItem(selected) as TreeViewItem;
    var tvi = input.ItemContainerGenerator.ContainerFromItem(selected) as TreeViewItem;
    if (tvi == null)
    {
        // it must be a child, heres a hack fix
        // my nodes are inherited from TreeViewItemViewModel by Josh Smith
        var child = selected as WPF.Controls.TreeViewItemViewModel;
        if (child == null)
            return;
        child.IsSelected = false;

    }
    else
        tvi.IsSelected = false;
     }

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-28T13:09:25.947

我的经验是远离标准的 ItemContainerGenerator 调用，因为它们会在深度大于 n+1 的节点上失败。我使用以下扩展方法的组合。ContainerFromItem 扩展方法来自 MSDN 博客，它在处理 TreeView 时为我创造了奇迹。

```
 public static void ClearSelection(this TreeView input)
  {
     var selected = input.SelectedItem;

     if (selected == null) return;

     var tvi = input.ContainerFromItem(selected) as TreeViewItem;

     if (tvi == null) return;

     tvi.IsSelected = false;

  }

  public static TreeViewItem ContainerFromItem(this TreeView treeView, object item)
  {
     TreeViewItem containerThatMightContainItem = (TreeViewItem)treeView.ItemContainerGenerator.ContainerFromItem(item);
     if (containerThatMightContainItem != null)
        return containerThatMightContainItem;
     else
        return ContainerFromItem(treeView.ItemContainerGenerator, treeView.Items, item);
  }

  private static TreeViewItem ContainerFromItem(ItemContainerGenerator parentItemContainerGenerator, ItemCollection itemCollection, object item)
  {
     foreach (object curChildItem in itemCollection)
     {
        TreeViewItem parentContainer = (TreeViewItem)parentItemContainerGenerator.ContainerFromItem(curChildItem);
        if (parentContainer == null)
           return null;
        TreeViewItem containerThatMightContainItem = (TreeViewItem)parentContainer.ItemContainerGenerator.ContainerFromItem(item);
        if (containerThatMightContainItem != null)
           return containerThatMightContainItem;
        TreeViewItem recursionResult = ContainerFromItem(parentContainer.ItemContainerGenerator, parentContainer.Items, item);
        if (recursionResult != null)
           return recursionResult;
     }
     return null;
  } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-03T17:37:19.760

到目前为止，这似乎有效，但我只是在 5 分钟前将其放入，因此使用风险自负。我基本上想在用户单击树控件而不是树项时清除选择。

```
 void DestinationTree_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
 {
     TreeView tree = sender as TreeView;
     DestinationClientViewModel selectedItem = tree.SelectedItem as DestinationClientViewModel;

     if (selectedItem != null)
     {
        int selectedItemIndex = this.DestinationTree.Items.IndexOf(selectedItem);

        if (selectedItemIndex > -1)
        {
            TreeViewItem tvi = this.DestinationTree.ItemContainerGenerator.ContainerFromIndex(selectedItemIndex) as TreeViewItem;
            if (tvi != null)
                tvi.IsSelected = false;
        }
     }
 } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-12T19:23:32.057

在寻找了很长时间后，我自己使用自定义树列表视图实现遇到了这种情况，我终于找到了适合我的解决方案。

完整的解释可以在[http://social.msdn.microsoft.com/Forums/vstudio/en-US/36aca7f7-0b47-488b-8e16-840b86addfa3/getting-treeviewitem-for-the-selected-item-in找到-a-treeview](http://social.msdn.microsoft.com/Forums/vstudio/en-US/36aca7f7-0b47-488b-8e16-840b86addfa3/getting-treeviewitem-for-the-selected-item-in-a-treeview)

基本思想是捕获`TreeViewItem.Selected`事件并将事件源保存到`Tag`TreeView 的属性中。然后，当您需要清除它时，您可以访问`Tag`控件上的属性并将`IsSelected`值设置为 False。这适用于我有 2 级嵌套子级。希望它对你有用。

为了坚持：

树视图声明

```
 <TreeView Name="myTreeView" TreeViewItem.Selected="OnItemSelected"
    ItemsSource="{Binding Source={StaticResource myHierarchicalData}}"/> 
```

事件处理程序

```
private void OnItemSelected(object sender, RoutedEventArgs e)
{
    myTreeView.Tag = e.OriginalSource;
} 
```

清除选择逻辑

```
if (myTreeView.SelectedItem != null)
{
    TreeViewItem selectedTVI = myTreeView.Tag as TreeViewItem;
    // add your code here mine was selectedTVI.IsSelected = false;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-26T22:11:51.503

我刚刚遇到了同样的问题。

一个快速而肮脏的解决方案

```
tree.ItemsSource = null;

tree.ItemsSource = yourSource; 
```

# architecture - 应用程序中应在何处处理辅助数据（例如授权/身份）

> ID：676821
> 
> 赞同：0
> 
> 时间：2009-03-24T10:32:24.917
> 
> 标签：architecture

创建网站时，我的模式通常如下：

1.  控制器（应用服务）
2.  服务（领域服务、基础设施服务）
3.  存储库

控制器与域服务或基础设施服务对话，域服务可能与存储库对话，基础设施服务将包装诸如 smtp 之类的东西。

目前我将身份作为基础服务处理，如果基础服务或域服务需要找出“调用者是谁”，它将在构造时请求身份服务，身份服务将具有识别调用者的方法/属性，这个例如，我有一个 HttpIdentityService，它通过会话/cookie 数据确定身份。

但是，例如，我对如何处理服务调用的结果有点困惑。我可能有一个服务'ArticleService'，它有一个方法'CreateComment'，它只接受一个字符串注释文本和一个目标标识符文章。

我的应用程序服务（控制器）调用此服务可能是这样的：

```
public ActionResult AddComment(int articleId)
{
  string commentText = ...;
  articleService.CreateComment(articleId, commentText);
  ...
} 
```

但是，如果当前身份未经授权，或者没有通过 ArticleService 检查的策略（例如可能每 30 秒评论一次），则此方法可能会失败，这样从服务调用中抛出和捕获异常似乎是非常错误的，因为我的调用代码无法检查它是否真的可以成功调用此操作（禁止致命的应用程序异常）..

所以最初我开始让服务返回一个“结果”，结果将是唯一可识别的，所以调用者会知道评论是否确实做出了（另外我会在结果中返回评论实体），结果也会识别诸如“由于用户未通过身份验证而无法发布”或“由于未遵守指定的冷却期而无法发布”之类的内容（我实际上并没有返回字符串，但您明白了）。

我背后的理由是应用程序服务不应该控制是否应该调用一个动作，假设我将所有用户身份检查和所有内容从域服务移到应用程序服务中，我会有很多复制代码，以及让应用程序服务完全控制可能发生的事情。

我想我的问题基本上是，鉴于域，基础设施服务将执行额外的策略，通知调用代码操作成功或失败的最佳方式是什么，以及为什么。

提前谢谢，史蒂夫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T10:39:25.553

在类似的情况下，我使用方面来检查方法调用是否被授权，如果不是，则抛出 AuthorizationException。切面拦截方法调用，从会话中检索用户信息，检查角色/权限集并最终抛出异常。这样，callig 代码可以处理异常以向用户提供有意义的反馈、记录事件等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T10:58:37.927

使用面向方面的编程来检查权限。如果这些失败抛出异常。

在实际调用 Action 之前，请检查必要的权限是否可用。如果没有取消操作。

如果操作有一些需要特殊权限的可选任务，请在执行可选任务之前检查必要的权限，并按照业务规则的要求做出反应。如果您忘记进行检查，您的 aop 代码将进行检查并抛出异常，这没关系，因为它真的不应该出现这种情况。

编辑：关于评论中提出的关于如何传达不允许执行某项操作的原因的问题：我会使用对象。如果一组可能的原因在编译时是固定的，请使用枚举。如果不只是创建一个小类，它可以包含所有相关值。

# php - 如何使用 PHP 计算两个日期之间的差异？

> ID：676824
> 
> 赞同：773
> 
> 时间：2009-03-24T10:33:07.443
> 
> 标签：php, datetime, datediff

我有两个日期的表格：

```
Start Date: 2007-03-24 
End Date: 2009-06-26 
```

现在我需要以以下形式找到这两者之间的区别：

```
2 years, 3 months and 2 days 
```

我怎样才能在 PHP 中做到这一点？

* * *

## 回答 #1

> 赞同：980
> 
> 时间：2010-10-13T11:43:23.897

我建议使用 DateTime 和 DateInterval 对象。

```
$date1 = new DateTime("2007-03-24");
$date2 = new DateTime("2009-06-26");
$interval = $date1->diff($date2);
echo "difference " . $interval->y . " years, " . $interval->m." months, ".$interval->d." days "; 

// shows the total amount of days (not divided into years, months and days like above)
echo "difference " . $interval->days . " days "; 
```

阅读更多[php DateTime::diff 手册](http://www.php.net/manual/en/datetime.diff.php)

从手册：

> 从 PHP 5.2.2 开始，可以使用比较运算符比较 DateTime 对象。

```
$date1 = new DateTime("now");
$date2 = new DateTime("tomorrow");

var_dump($date1 == $date2); // bool(false)
var_dump($date1 < $date2);  // bool(true)
var_dump($date1 > $date2);  // bool(false) 
```

* * *

## 回答 #2

> 赞同：575
> 
> 时间：2009-03-24T10:35:11.307

> 将此用于遗留代码（PHP < 5.3）。有关最新的解决方案，请参阅下面的 jurka 的答案

您可以使用 strtotime() 将两个日期转换为 unix 时间，然后计算它们之间的秒数。由此很容易计算不同的时间段。

```
$date1 = "2007-03-24";
$date2 = "2009-06-26";

$diff = abs(strtotime($date2) - strtotime($date1));

$years = floor($diff / (365*60*60*24));
$months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));

printf("%d years, %d months, %d days\n", $years, $months, $days); 
```

**编辑：**显然，这样做的首选方式就像下面的 jurka 所描述的那样。我的代码通常仅在您没有 PHP 5.3 或更高版本时才推荐使用。

评论中的几个人指出，上面的代码只是一个近似值。我仍然相信对于大多数目的来说这很好，因为范围的使用更多地是为了提供已经过去或剩余多少时间的感觉，而不是提供精确度 - 如果你想这样做，只需输出日期。

尽管如此，我还是决定解决这些投诉。如果您确实需要一个准确的范围但无法访问 PHP 5.3，请使用下面的代码（它也应该在 PHP 4 中工作）。这是 PHP 在内部用于计算范围的代码的直接端口，但它不考虑夏令时。这意味着它最多关闭一个小时，但除此之外它应该是正确的。

```
<?php

/**
 * Calculate differences between two dates with precise semantics. Based on PHPs DateTime::diff()
 * implementation by Derick Rethans. Ported to PHP by Emil H, 2011-05-02\. No rights reserved.
 * 
 * See here for original code:
 * http://svn.php.net/viewvc/php/php-src/trunk/ext/date/lib/tm2unixtime.c?revision=302890&view=markup
 * http://svn.php.net/viewvc/php/php-src/trunk/ext/date/lib/interval.c?revision=298973&view=markup
 */

function _date_range_limit($start, $end, $adj, $a, $b, $result)
{
    if ($result[$a] < $start) {
        $result[$b] -= intval(($start - $result[$a] - 1) / $adj) + 1;
        $result[$a] += $adj * intval(($start - $result[$a] - 1) / $adj + 1);
    }

    if ($result[$a] >= $end) {
        $result[$b] += intval($result[$a] / $adj);
        $result[$a] -= $adj * intval($result[$a] / $adj);
    }

    return $result;
}

function _date_range_limit_days($base, $result)
{
    $days_in_month_leap = array(31, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
    $days_in_month = array(31, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);

    _date_range_limit(1, 13, 12, "m", "y", &$base);

    $year = $base["y"];
    $month = $base["m"];

    if (!$result["invert"]) {
        while ($result["d"] < 0) {
            $month--;
            if ($month < 1) {
                $month += 12;
                $year--;
            }

            $leapyear = $year % 400 == 0 || ($year % 100 != 0 && $year % 4 == 0);
            $days = $leapyear ? $days_in_month_leap[$month] : $days_in_month[$month];

            $result["d"] += $days;
            $result["m"]--;
        }
    } else {
        while ($result["d"] < 0) {
            $leapyear = $year % 400 == 0 || ($year % 100 != 0 && $year % 4 == 0);
            $days = $leapyear ? $days_in_month_leap[$month] : $days_in_month[$month];

            $result["d"] += $days;
            $result["m"]--;

            $month++;
            if ($month > 12) {
                $month -= 12;
                $year++;
            }
        }
    }

    return $result;
}

function _date_normalize($base, $result)
{
    $result = _date_range_limit(0, 60, 60, "s", "i", $result);
    $result = _date_range_limit(0, 60, 60, "i", "h", $result);
    $result = _date_range_limit(0, 24, 24, "h", "d", $result);
    $result = _date_range_limit(0, 12, 12, "m", "y", $result);

    $result = _date_range_limit_days(&$base, &$result);

    $result = _date_range_limit(0, 12, 12, "m", "y", $result);

    return $result;
}

/**
 * Accepts two unix timestamps.
 */
function _date_diff($one, $two)
{
    $invert = false;
    if ($one > $two) {
        list($one, $two) = array($two, $one);
        $invert = true;
    }

    $key = array("y", "m", "d", "h", "i", "s");
    $a = array_combine($key, array_map("intval", explode(" ", date("Y m d H i s", $one))));
    $b = array_combine($key, array_map("intval", explode(" ", date("Y m d H i s", $two))));

    $result = array();
    $result["y"] = $b["y"] - $a["y"];
    $result["m"] = $b["m"] - $a["m"];
    $result["d"] = $b["d"] - $a["d"];
    $result["h"] = $b["h"] - $a["h"];
    $result["i"] = $b["i"] - $a["i"];
    $result["s"] = $b["s"] - $a["s"];
    $result["invert"] = $invert ? 1 : 0;
    $result["days"] = intval(abs(($one - $two)/86400));

    if ($invert) {
        _date_normalize(&$a, &$result);
    } else {
        _date_normalize(&$b, &$result);
    }

    return $result;
}

$date = "1986-11-10 19:37:22";

print_r(_date_diff(strtotime($date), time()));
print_r(_date_diff(time(), strtotime($date))); 
```

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2012-11-30T15:25:14.797

最好的做法是使用 PHP 的**[`DateTime`](http://il.php.net/manual/en/class.datetime.php)**（和**[`DateInterval`](http://il.php.net/manual/en/class.dateinterval.php)**）对象。每个日期都封装在一个`DateTime`对象中，然后可以对两者进行区分：

```
$first_date = new DateTime("2012-11-30 17:03:30");
$second_date = new DateTime("2012-12-21 00:00:00"); 
```

该`DateTime`对象将接受任何格式`strtotime()`。如果需要更具体的日期格式，**[`DateTime::createFromFormat()`](http://il.php.net/manual/en/datetime.createfromformat.php)**可用于创建`DateTime`对象。

两个对象都实例化后，你用 . 从另一个中减去一个**[`DateTime::diff()`](http://il.php.net/manual/en/datetime.diff.php)**。

```
$difference = $first_date->diff($second_date); 
```

`$difference`现在保存[`DateInterval`](http://il.php.net/manual/en/class.dateinterval.php)具有差异信息的对象。A`var_dump()`看起来像这样：

```
object(DateInterval)
  public 'y' => int 0
  public 'm' => int 0
  public 'd' => int 20
  public 'h' => int 6
  public 'i' => int 56
  public 's' => int 30
  public 'invert' => int 0
  public 'days' => int 20 
```

要格式化`DateInterval`对象，我们需要检查每个值并在它为 0 时将其排除：

```
/**
 * Format an interval to show all existing components.
 * If the interval doesn't have a time component (years, months, etc)
 * That component won't be displayed.
 *
 * @param DateInterval $interval The interval
 *
 * @return string Formatted interval string.
 */
function format_interval(DateInterval $interval) {
    $result = "";
    if ($interval->y) { $result .= $interval->format("%y years "); }
    if ($interval->m) { $result .= $interval->format("%m months "); }
    if ($interval->d) { $result .= $interval->format("%d days "); }
    if ($interval->h) { $result .= $interval->format("%h hours "); }
    if ($interval->i) { $result .= $interval->format("%i minutes "); }
    if ($interval->s) { $result .= $interval->format("%s seconds "); }

    return $result;
} 
```

现在剩下的就是在`$difference` `DateInterval`对象上调用我们的函数：

```
echo format_interval($difference); 
```

我们得到了正确的结果：

> 20天6小时56分30秒

用于实现目标的完整代码：

```
/**
 * Format an interval to show all existing components.
 * If the interval doesn't have a time component (years, months, etc)
 * That component won't be displayed.
 *
 * @param DateInterval $interval The interval
 *
 * @return string Formatted interval string.
 */
function format_interval(DateInterval $interval) {
    $result = "";
    if ($interval->y) { $result .= $interval->format("%y years "); }
    if ($interval->m) { $result .= $interval->format("%m months "); }
    if ($interval->d) { $result .= $interval->format("%d days "); }
    if ($interval->h) { $result .= $interval->format("%h hours "); }
    if ($interval->i) { $result .= $interval->format("%i minutes "); }
    if ($interval->s) { $result .= $interval->format("%s seconds "); }

    return $result;
}

$first_date = new DateTime("2012-11-30 17:03:30");
$second_date = new DateTime("2012-12-21 00:00:00");

$difference = $first_date->diff($second_date);

echo format_interval($difference); 
```

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2010-03-18T19:07:43.370

查看小时、分钟和秒..

```
$date1 = "2008-11-01 22:45:00"; 

$date2 = "2009-12-04 13:44:01"; 

$diff = abs(strtotime($date2) - strtotime($date1)); 

$years   = floor($diff / (365*60*60*24)); 
$months  = floor(($diff - $years * 365*60*60*24) / (30*60*60*24)); 
$days    = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));

$hours   = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24 - $days*60*60*24)/ (60*60)); 

$minuts  = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24 - $days*60*60*24 - $hours*60*60)/ 60); 

$seconds = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24 - $days*60*60*24 - $hours*60*60 - $minuts*60)); 

printf("%d years, %d months, %d days, %d hours, %d minuts\n, %d seconds\n", $years, $months, $days, $hours, $minuts, $seconds); 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2011-07-25T14:37:05.570

看看下面的链接。这是迄今为止我找到的最佳答案.. :)

```
function dateDiff ($d1, $d2) {

    // Return the number of days between the two dates:    
    return round(abs(strtotime($d1) - strtotime($d2))/86400);

} // end function dateDiff 
```

> 传入日期参数​​时，哪个日期更早或更晚都没有关系。该函数使用 PHP ABS() 绝对值始终返回一个正数作为两个日期之间的天数。
> 
> 请记住，两个日期之间的天数不包括两个日期。因此，如果您要查找输入日期之间（包括输入日期）之间的所有日期所代表的天数，则需要在此函数的结果中添加一 (1)。
> 
> 例如，2013-02-09 和 2013-02-14 之间的差值（由上述函数返回）为 5。但日期范围 2013-02-09 - 2013-02- 表示的天数或日期14 是 6。

[http://www.bizinfosys.com/php/date-difference.html](http://www.bizinfosys.com/php/date-difference.html)

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2011-02-17T18:29:55.237

```
<?php
    $today = strtotime("2011-02-03 00:00:00");
    $myBirthDate = strtotime("1964-10-30 00:00:00");
    printf("Days since my birthday: ", ($today - $myBirthDate)/60/60/24);
?> 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-10-18T13:52:21.997

我投票支持[jurka](https://stackoverflow.com/users/474405/jurka)的[答案](https://stackoverflow.com/questions/676824/how-to-calculate-the-date-difference-between-2-dates-using-php/3923228#3923228)，因为这是我最喜欢的，但我有一个 pre-php.5.3 版本......

我发现自己正在处理一个类似的问题——这就是我首先解决这个问题的方式——但只需要在小时数上有所不同。但是我的函数也很好地解决了这个问题，我自己的库中没有任何地方可以将它保存在不会丢失和遗忘的地方，所以......希望这对某人有用。

```
/**
 *
 * @param DateTime $oDate1
 * @param DateTime $oDate2
 * @return array 
 */
function date_diff_array(DateTime $oDate1, DateTime $oDate2) {
    $aIntervals = array(
        'year'   => 0,
        'month'  => 0,
        'week'   => 0,
        'day'    => 0,
        'hour'   => 0,
        'minute' => 0,
        'second' => 0,
    );

    foreach($aIntervals as $sInterval => &$iInterval) {
        while($oDate1 <= $oDate2){ 
            $oDate1->modify('+1 ' . $sInterval);
            if ($oDate1 > $oDate2) {
                $oDate1->modify('-1 ' . $sInterval);
                break;
            } else {
                $iInterval++;
            }
        }
    }

    return $aIntervals;
} 
```

和测试：

```
$oDate = new DateTime();
$oDate->modify('+111402189 seconds');
var_dump($oDate);
var_dump(date_diff_array(new DateTime(), $oDate)); 
```

结果：

```
object(DateTime)[2]
  public 'date' => string '2014-04-29 18:52:51' (length=19)
  public 'timezone_type' => int 3
  public 'timezone' => string 'America/New_York' (length=16)

array
  'year'   => int 3
  'month'  => int 6
  'week'   => int 1
  'day'    => int 4
  'hour'   => int 9
  'minute' => int 3
  'second' => int 8 
```

[我从这里](http://www.php.net/manual/en/datetime.diff.php#97810)得到了最初的想法，我修改了它以供我使用（我希望我的修改也能显示在那个页面上）。

`$aIntervals`您可以通过从数组中删除它们，或者添加一个`$aExclude`参数，或者在输出字符串时将它们过滤掉，非常容易地删除您不想要的间隔（比如“周”） 。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2010-09-23T22:52:00.720

我不知道你是否在使用 PHP 框架，但是很多 PHP 框架都有日期/时间库和帮助程序来帮助你避免重新发明轮子。

例如 CodeIgniter 有这个`timespan()`功能。只需输入两个 Unix 时间戳，它就会自动生成如下结果：

```
1 Year, 10 Months, 2 Weeks, 5 Days, 10 Hours, 16 Minutes 
```

[http://codeigniter.com/user_guide/helpers/date_helper.html](http://codeigniter.com/user_guide/helpers/date_helper.html)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-09-18T02:41:06.353

### 使用示例：

```
echo time_diff_string('2013-05-01 00:22:35', 'now');
echo time_diff_string('2013-05-01 00:22:35', 'now', true); 
```

### 输出 ：

```
4 months ago
4 months, 2 weeks, 3 days, 1 hour, 49 minutes, 15 seconds ago 
```

### 功能 ：

```
function time_diff_string($from, $to, $full = false) {
    $from = new DateTime($from);
    $to = new DateTime($to);
    $diff = $to->diff($from);

    $diff->w = floor($diff->d / 7);
    $diff->d -= $diff->w * 7;

    $string = array(
        'y' => 'year',
        'm' => 'month',
        'w' => 'week',
        'd' => 'day',
        'h' => 'hour',
        'i' => 'minute',
        's' => 'second',
    );
    foreach ($string as $k => &$v) {
        if ($diff->$k) {
            $v = $diff->$k . ' ' . $v . ($diff->$k > 1 ? 's' : '');
        } else {
            unset($string[$k]);
        }
    }

    if (!$full) $string = array_slice($string, 0, 1);
    return $string ? implode(', ', $string) . ' ago' : 'just now';
} 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2017-10-16T11:02:03.243

我更喜欢使用`date_create`和`date_diff`对象。

代码：

```
$date1 = date_create("2007-03-24");
$date2 = date_create("2009-06-26");

$dateDifference = date_diff($date1, $date2)->format('%y years, %m months and %d days');

echo $dateDifference; 
```

输出：

```
2 years, 3 months and 2 days 
```

有关更多信息，请阅读[PHP`date_diff`手册](http://php.net/manual/en/function.date-diff.php)

> 根据手册`date_diff`是 [DateTime::diff()的别名](http://php.net/manual/en/datetime.diff.php)

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2017-12-15T11:54:08.430

这是可运行的代码

```
$date1 = date_create('2007-03-24');
$date2 = date_create('2009-06-26');
$diff1 = date_diff($date1,$date2);
$daysdiff = $diff1->format("%R%a");
$daysdiff = abs($daysdiff); 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2011-12-13T06:58:55.710

我对此有一些简单的逻辑：

```
<?php
    per_days_diff('2011-12-12','2011-12-29')
    function per_days_diff($start_date, $end_date) {
        $per_days = 0;
        $noOfWeek = 0;
        $noOfWeekEnd = 0;
        $highSeason=array("7", "8");

        $current_date = strtotime($start_date);
        $current_date += (24 * 3600);
        $end_date = strtotime($end_date);

        $seassion = (in_array(date('m', $current_date), $highSeason))?"2":"1";

        $noOfdays = array('');

        while ($current_date <= $end_date) {
            if ($current_date <= $end_date) {
                $date = date('N', $current_date);
                array_push($noOfdays,$date);
                $current_date = strtotime('+1 day', $current_date);
            }
        }

        $finalDays = array_shift($noOfdays);
        //print_r($noOfdays);
        $weekFirst = array("week"=>array(),"weekEnd"=>array());
        for($i = 0; $i < count($noOfdays); $i++)
        {
            if ($noOfdays[$i] == 1)
            {
                //echo "This is week";
                //echo "<br/>";
                if($noOfdays[$i+6]==7)
                {
                    $noOfWeek++;
                    $i=$i+6;
                }
                else
                {
                    $per_days++;
                }
                //array_push($weekFirst["week"],$day);
            }
            else if($noOfdays[$i]==5)
            {
                //echo "This is weekend";
                //echo "<br/>";
                if($noOfdays[$i+2] ==7)
                {
                    $noOfWeekEnd++;
                    $i = $i+2;
                }
                else
                {
                    $per_days++;
                }
                //echo "After weekend value:- ".$i;
                //echo "<br/>";
            }
            else
            {
                $per_days++;
            }
        }

        /*echo $noOfWeek;
          echo "<br/>";
          echo $noOfWeekEnd;
          echo "<br/>";
          print_r($per_days);
          echo "<br/>";
          print_r($weekFirst);
        */

        $duration = array("weeks"=>$noOfWeek, "weekends"=>$noOfWeekEnd, "perDay"=>$per_days, "seassion"=>$seassion);
        return $duration;
      ?> 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2018-12-27T09:41:12.247

[**使用date_diff()**](https://www.php.net/manual/en/function.date-diff.php)尝试这个非常简单的答案，这是经过测试的。

```
$date1 = date_create("2017-11-27");
$date2 = date_create("2018-12-29");
$diff=date_diff($date1,$date2);
$months = $diff->format("%m months");
$years = $diff->format("%y years");
$days = $diff->format("%d days");

echo $years .' '.$months.' '.$days; 
```

输出是：

```
1 years 1 months 2 days 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2009-03-24T10:41:21.010

您可以使用

```
getdate() 
```

函数返回一个数组，其中包含提供的日期/时间的所有元素：

```
$diff = abs($endDate - $startDate);
$my_t=getdate($diff);
print("$my_t[year] years, $my_t[month] months and $my_t[mday] days"); 
```

如果您的开始日期和结束日期是字符串格式，则使用

```
$startDate = strtotime($startDateStr);
$endDate = strtotime($endDateStr); 
```

在上述代码之前

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2010-10-14T03:17:49.377

```
// If you just want to see the year difference then use this function.
// Using the logic I've created you may also create month and day difference
// which I did not provide here so you may have the efforts to use your brain.
// :)
$date1='2009-01-01';
$date2='2010-01-01';
echo getYearDifference ($date1,$date2);
function getYearDifference($date1=strtotime($date1),$date2=strtotime($date2)){
    $year = 0;
    while($date2 > $date1 = strtotime('+1 year', $date1)){
        ++$year;
    }
    return $year;
} 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2013-08-08T19:10:17.163

这是我的功能。需要 PHP >= 5.3.4。它使用 DateTime 类。非常快，快速，并且可以区分两个日期甚至所谓的“时间”。

```
if(function_exists('grk_Datetime_Since') === FALSE){
    function grk_Datetime_Since($From, $To='', $Prefix='', $Suffix=' ago', $Words=array()){
        #   Est-ce qu'on calcul jusqu'à un moment précis ? Probablement pas, on utilise maintenant
        if(empty($To) === TRUE){
            $To = time();
        }

        #   On va s'assurer que $From est numérique
        if(is_int($From) === FALSE){
            $From = strtotime($From);
        };

        #   On va s'assurer que $To est numérique
        if(is_int($To) === FALSE){
            $To = strtotime($To);
        }

        #   On a une erreur ?
        if($From === FALSE OR $From === -1 OR $To === FALSE OR $To === -1){
            return FALSE;
        }

        #   On va créer deux objets de date
        $From = new DateTime(@date('Y-m-d H:i:s', $From), new DateTimeZone('GMT'));
        $To   = new DateTime(@date('Y-m-d H:i:s', $To), new DateTimeZone('GMT'));

        #   On va calculer la différence entre $From et $To
        if(($Diff = $From->diff($To)) === FALSE){
            return FALSE;
        }

        #   On va merger le tableau des noms (par défaut, anglais)
        $Words = array_merge(array(
            'year'      => 'year',
            'years'     => 'years',
            'month'     => 'month',
            'months'    => 'months',
            'week'      => 'week',
            'weeks'     => 'weeks',
            'day'       => 'day',
            'days'      => 'days',
            'hour'      => 'hour',
            'hours'     => 'hours',
            'minute'    => 'minute',
            'minutes'   => 'minutes',
            'second'    => 'second',
            'seconds'   => 'seconds'
        ), $Words);

        #   On va créer la chaîne maintenant
        if($Diff->y > 1){
            $Text = $Diff->y.' '.$Words['years'];
        } elseif($Diff->y == 1){
            $Text = '1 '.$Words['year'];
        } elseif($Diff->m > 1){
            $Text = $Diff->m.' '.$Words['months'];
        } elseif($Diff->m == 1){
            $Text = '1 '.$Words['month'];
        } elseif($Diff->d > 7){
            $Text = ceil($Diff->d/7).' '.$Words['weeks'];
        } elseif($Diff->d == 7){
            $Text = '1 '.$Words['week'];
        } elseif($Diff->d > 1){
            $Text = $Diff->d.' '.$Words['days'];
        } elseif($Diff->d == 1){
            $Text = '1 '.$Words['day'];
        } elseif($Diff->h > 1){
            $Text = $Diff->h.' '.$Words['hours'];
        } elseif($Diff->h == 1){
            $Text = '1 '.$Words['hour'];
        } elseif($Diff->i > 1){
            $Text = $Diff->i.' '.$Words['minutes'];
        } elseif($Diff->i == 1){
            $Text = '1 '.$Words['minute'];
        } elseif($Diff->s > 1){
            $Text = $Diff->s.' '.$Words['seconds'];
        } else {
            $Text = '1 '.$Words['second'];
        }

        return $Prefix.$Text.$Suffix;
    }
} 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2016-05-24T09:38:03.637

您始终可以使用以下函数，该函数可以以年和月为单位返回年龄（即 1 年 4 个月）

```
function getAge($dob, $age_at_date)
{  
    $d1 = new DateTime($dob);
    $d2 = new DateTime($age_at_date);
    $age = $d2->diff($d1);
    $years = $age->y;
    $months = $age->m;

    return $years.'.'.months;
} 
```

或者如果您希望在当前日期计算年龄，您可以使用

```
function getAge($dob)
{  
    $d1 = new DateTime($dob);
    $d2 = new DateTime(date());
    $age = $d2->diff($d1);
    $years = $age->y;
    $months = $age->m;

    return $years.'.'.months;
} 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2010-01-07T02:22:34.117

我在下一页找到了您的文章，其中包含许多[PHP](http://en.wikipedia.org/wiki/PHP)日期时间计算的参考资料。

使用 PHP 计算两个日期（和时间）之间的差异。以下页面提供了一系列不同的方法（总共 7 种）用于使用 PHP 执行日期/时间计算，以确定两个日期之间的时间（小时、分钟）、天、月或年的差异。

请参阅[PHP 日期时间 - 计算 2 个日期之间差异的 7 种方法](http://forums.webmasterhub.net/viewtopic.php?f=23&t=1831)。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2013-11-02T23:48:57.140

这将尝试检测是否给出了时间戳，并且还将返回未来的日期/时间作为负值：

```
<?php

function time_diff($start, $end = NULL, $convert_to_timestamp = FALSE) {
  // If $convert_to_timestamp is not explicitly set to TRUE,
  // check to see if it was accidental:
  if ($convert_to_timestamp || !is_numeric($start)) {
    // If $convert_to_timestamp is TRUE, convert to timestamp:
    $timestamp_start = strtotime($start);
  }
  else {
    // Otherwise, leave it as a timestamp:
    $timestamp_start = $start;
  }
  // Same as above, but make sure $end has actually been overridden with a non-null,
  // non-empty, non-numeric value:
  if (!is_null($end) && (!empty($end) && !is_numeric($end))) {
    $timestamp_end = strtotime($end);
  }
  else {
    // If $end is NULL or empty and non-numeric value, assume the end time desired
    // is the current time (useful for age, etc):
    $timestamp_end = time();
  }
  // Regardless, set the start and end times to an integer:
  $start_time = (int) $timestamp_start;
  $end_time = (int) $timestamp_end;

  // Assign these values as the params for $then and $now:
  $start_time_var = 'start_time';
  $end_time_var = 'end_time';
  // Use this to determine if the output is positive (time passed) or negative (future):
  $pos_neg = 1;

  // If the end time is at a later time than the start time, do the opposite:
  if ($end_time <= $start_time) {
    $start_time_var = 'end_time';
    $end_time_var = 'start_time';
    $pos_neg = -1;
  }

  // Convert everything to the proper format, and do some math:
  $then = new DateTime(date('Y-m-d H:i:s', $$start_time_var));
  $now = new DateTime(date('Y-m-d H:i:s', $$end_time_var));

  $years_then = $then->format('Y');
  $years_now = $now->format('Y');
  $years = $years_now - $years_then;

  $months_then = $then->format('m');
  $months_now = $now->format('m');
  $months = $months_now - $months_then;

  $days_then = $then->format('d');
  $days_now = $now->format('d');
  $days = $days_now - $days_then;

  $hours_then = $then->format('H');
  $hours_now = $now->format('H');
  $hours = $hours_now - $hours_then;

  $minutes_then = $then->format('i');
  $minutes_now = $now->format('i');
  $minutes = $minutes_now - $minutes_then;

  $seconds_then = $then->format('s');
  $seconds_now = $now->format('s');
  $seconds = $seconds_now - $seconds_then;

  if ($seconds < 0) {
    $minutes -= 1;
    $seconds += 60;
  }
  if ($minutes < 0) {
    $hours -= 1;
    $minutes += 60;
  }
  if ($hours < 0) {
    $days -= 1;
    $hours += 24;
  }
  $months_last = $months_now - 1;
  if ($months_now == 1) {
    $years_now -= 1;
    $months_last = 12;
  }

  // "Thirty days hath September, April, June, and November" ;)
  if ($months_last == 9 || $months_last == 4 || $months_last == 6 || $months_last == 11) {
    $days_last_month = 30;
  }
  else if ($months_last == 2) {
    // Factor in leap years:
    if (($years_now % 4) == 0) {
      $days_last_month = 29;
    }
    else {
      $days_last_month = 28;
    }
  }
  else {
    $days_last_month = 31;
  }
  if ($days < 0) {
    $months -= 1;
    $days += $days_last_month;
  }
  if ($months < 0) {
    $years -= 1;
    $months += 12;
  }

  // Finally, multiply each value by either 1 (in which case it will stay the same),
  // or by -1 (in which case it will become negative, for future dates).
  // Note: 0 * 1 == 0 * -1 == 0
  $out = new stdClass;
  $out->years = (int) $years * $pos_neg;
  $out->months = (int) $months * $pos_neg;
  $out->days = (int) $days * $pos_neg;
  $out->hours = (int) $hours * $pos_neg;
  $out->minutes = (int) $minutes * $pos_neg;
  $out->seconds = (int) $seconds * $pos_neg;
  return $out;
} 
```

示例用法：

```
<?php
  $birthday = 'June 2, 1971';
  $check_age_for_this_date = 'June 3, 1999 8:53pm';
  $age = time_diff($birthday, $check_age_for_this_date)->years;
  print $age;// 28 
```

或者：

```
<?php
  $christmas_2020 = 'December 25, 2020';
  $countdown = time_diff($christmas_2020);
  print_r($countdown); 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2014-03-31T03:02:40.807

“如果”日期存储在MySQL中，我发现在数据库级别进行差异计算更容易......然后根据Day，Hour，Min，Sec输出，适当地解析和显示结果......

```
mysql> select firstName, convert_tz(loginDate, '+00:00', '-04:00') as loginDate, TIMESTAMPDIFF(DAY, loginDate, now()) as 'Day', TIMESTAMPDIFF(HOUR, loginDate, now())+4 as 'Hour', TIMESTAMPDIFF(MINUTE, loginDate, now())+(60*4) as 'Min', TIMESTAMPDIFF(SECOND, loginDate, now())+(60*60*4) as 'Sec' from User_ where userId != '10158' AND userId != '10198' group by emailAddress order by loginDate desc;
 +-----------+---------------------+------+------+------+--------+
 | firstName | loginDate           | Day  | Hour | Min  | Sec    |
 +-----------+---------------------+------+------+------+--------+
 | Peter     | 2014-03-30 18:54:40 |    0 |    4 |  244 |  14644 |
 | Keith     | 2014-03-30 18:54:11 |    0 |    4 |  244 |  14673 |
 | Andres    | 2014-03-28 09:20:10 |    2 |   61 | 3698 | 221914 |
 | Nadeem    | 2014-03-26 09:33:43 |    4 |  109 | 6565 | 393901 |
 +-----------+---------------------+------+------+------+--------+
 4 rows in set (0.00 sec) 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2017-06-07T04:58:31.440

对于 php 版本 >=5.3 ：创建两个日期对象，然后使用`date_diff()`函数。它将返回 php [DateInterval](http://php.net/manual/en/class.dateinterval.php)对象。[见文档](http://php.net/manual/en/function.date-diff.php)

```
$date1=date_create("2007-03-24");
$date2=date_create("2009-06-26");
$diff=date_diff($date1,$date2);
echo $diff->format("%R%a days"); 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2012-12-09T11:14:23.907

一个简单的功能

```
function time_difference($time_1, $time_2, $limit = null)
{

    $val_1 = new DateTime($time_1);
    $val_2 = new DateTime($time_2);

    $interval = $val_1->diff($val_2);

    $output = array(
        "year" => $interval->y,
        "month" => $interval->m,
        "day" => $interval->d,
        "hour" => $interval->h,
        "minute" => $interval->i,
        "second" => $interval->s
    );

    $return = "";
    foreach ($output AS $key => $value) {

        if ($value == 1)
            $return .= $value . " " . $key . " ";
        elseif ($value >= 1)
            $return .= $value . " " . $key . "s ";

        if ($key == $limit)
            return trim($return);
    }
    return trim($return);
} 
```

使用喜欢

`echo time_difference ($time_1, $time_2, "day");`

会像一样回来`2 years 8 months 2 days`

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2013-03-07T13:00:58.330

您还可以使用以下代码通过向上取整返回日期差异 $date1 = $duedate; // 分配截止日期 echo $date2 = date("Ymd"); // 当前日期 $ts1 = strtotime($date1); $ts2 = strtotime($date2); $seconds_diff = $ts1 - $ts2; 回声 $datediff = ceil(($seconds_diff/3600)/24); // 返回天数

如果您使用 php 的 floor 方法而不是 ceil ，它将返回您向下的整数部分。请在此处检查差异，有时如果您的登台服务器时区与实时站点时区不同，在这种情况下您可能会得到不同的结果，因此请相应地更改条件。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2013-06-17T15:44:25.533

```
$date1 = date_create('2007-03-24');
$date2 = date_create('2009-06-26');
$interval = date_diff($date1, $date2);
echo "difference : " . $interval->y . " years, " . $interval->m." months, ".$interval->d." days "; 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2012-09-20T14:09:28.510

前段时间我写了一个`format_date`函数，因为它提供了**很多关于你想要你的日期的选项**：

```
function format_date($date, $type, $seperator="-")
{
    if($date)
    {
        $day = date("j", strtotime($date));
        $month = date("n", strtotime($date));
        $year = date("Y", strtotime($date));
        $hour = date("H", strtotime($date));
        $min = date("i", strtotime($date));
        $sec = date("s", strtotime($date));

        switch($type)
        {
            case 0:  $date = date("Y".$seperator."m".$seperator."d",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 1:  $date = date("D, F j, Y",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 2:  $date = date("d".$seperator."m".$seperator."Y",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 3:  $date = date("d".$seperator."M".$seperator."Y",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 4:  $date = date("d".$seperator."M".$seperator."Y h:i A",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 5:  $date = date("m".$seperator."d".$seperator."Y",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 6:  $date = date("M",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 7:  $date = date("Y",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 8:  $date = date("j",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 9:  $date = date("n",mktime($hour, $min, $sec, $month, $day, $year)); break;
            case 10: 
                     $diff = abs(strtotime($date) - strtotime(date("Y-m-d h:i:s"))); 
                     $years = floor($diff / (365*60*60*24));
                     $months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
                     $days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
                     $date = $years . " years, " . $months . " months, " . $days . "days";
        }
    }
    return($date);
} 
```

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2013-11-14T12:55:26.633

我在 PHP 5.2 上遇到了同样的问题，并用 MySQL 解决了它。可能不完全是您正在寻找的东西，但这可以解决问题并返回天数：

```
$datediff_q = $dbh->prepare("SELECT DATEDIFF(:date2, :date1)");
$datediff_q->bindValue(':date1', '2007-03-24', PDO::PARAM_STR);
$datediff_q->bindValue(':date2', '2009-06-26', PDO::PARAM_STR);
$datediff = ($datediff_q->execute()) ? $datediff_q->fetchColumn(0) : false; 
```

更多信息在这里[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_datediff](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_datediff)

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2014-01-19T17:25:58.527

由于每个人都在发布代码示例，这里是另一个版本。

我想要一个功能来显示从秒到年的差异（只有一个单位）。对于超过 1 天的时间段，我希望它在午夜翻转（从周三上午 9 点看到的周一上午 10 点是 2 天前，而不是 1 天）。对于超过一个月的时间段，我希望翻转在当月的同一天（包括 30/31 天的月份和闰年）。

这就是我想出的：

```
/**
 * Returns how long ago something happened in the past, showing it
 * as n seconds / minutes / hours / days / weeks / months / years ago.
 *
 * For periods over a day, it rolls over at midnight (so doesn't depend
 * on current time of day), and it correctly accounts for month-lengths
 * and leap-years (months and years rollover on current day of month).
 *
 * $param string $timestamp in DateTime format
 * $return string description of interval
 */
function ago($timestamp)
{
    $then = date_create($timestamp);

    // for anything over 1 day, make it rollover on midnight
    $today = date_create('tomorrow'); // ie end of today
    $diff = date_diff($then, $today);

    if ($diff->y > 0) return $diff->y.' year'.($diff->y>1?'s':'').' ago';
    if ($diff->m > 0) return $diff->m.' month'.($diff->m>1?'s':'').' ago';
    $diffW = floor($diff->d / 7);
    if ($diffW > 0) return $diffW.' week'.($diffW>1?'s':'').' ago';
    if ($diff->d > 1) return $diff->d.' day'.($diff->d>1?'s':'').' ago';

    // for anything less than 1 day, base it off 'now'
    $now = date_create();
    $diff = date_diff($then, $now);

    if ($diff->d > 0) return 'yesterday';
    if ($diff->h > 0) return $diff->h.' hour'.($diff->h>1?'s':'').' ago';
    if ($diff->i > 0) return $diff->i.' minute'.($diff->i>1?'s':'').' ago';
    return $diff->s.' second'.($diff->s==1?'':'s').' ago';
} 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2014-09-30T05:28:18.353

非常简单：

```
 <?php
        $date1 = date_create("2007-03-24");
        echo "Start date: ".$date1->format("Y-m-d")."<br>";
        $date2 = date_create("2009-06-26");
        echo "End date: ".$date2->format("Y-m-d")."<br>";
        $diff = date_diff($date1,$date2);
        echo "Difference between start date and end date: ".$diff->format("%y years, %m months and %d days")."<br>";
    ?> 
```

详情请查看以下链接：

[PHP: date_diff - 手动](http://php.net/manual/en/function.date-diff.php)

请注意，它适用于 PHP 5.3.0 或更高版本。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2021-02-11T21:38:59.827

使用这个功能

```
//function Diff between Dates
//////////////////////////////////////////////////////////////////////
//PARA: Date Should In YYYY-MM-DD Format
//RESULT FORMAT:
// '%y Year %m Month %d Day %h Hours %i Minute %s Seconds' =>  1 Year 3 Month 14 Day 11 Hours 49 Minute 36 Seconds
// '%y Year %m Month %d Day'                       =>  1 Year 3 Month 14 Days
// '%m Month %d Day'                                     =>  3 Month 14 Day
// '%d Day %h Hours'                                   =>  14 Day 11 Hours
// '%d Day'                                                 =>  14 Days
// '%h Hours %i Minute %s Seconds'         =>  11 Hours 49 Minute 36 Seconds
// '%i Minute %s Seconds'                           =>  49 Minute 36 Seconds
// '%h Hours                                          =>  11 Hours
// '%a Days                                                =>  468 Days
//////////////////////////////////////////////////////////////////////
function dateDifference($date_1 , $date_2 , $differenceFormat = '%a' )
{
    $datetime1 = date_create($date_1);
    $datetime2 = date_create($date_2);

    $interval = date_diff($datetime1, $datetime2);

    return $interval->format($differenceFormat);

} 
```

仅设置参数**$differenceFormat** 作为您需要的示例，我希望您的年龄与月份和天数之间的差异

日期差异（**日期（'Ymd'）**，**$date**，' **%y** **%m** **%d** '）

或其他格式

dateDifference（**日期（'Ymd'）**，**$date**，' **%y** - **%m** - **%d** '）

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2011-01-10T17:21:00.710

当 PHP 5.3（分别为 date_diff()）不可用时，我正在使用我编写的以下函数：

```
 function dateDifference($startDate, $endDate)
        {
            $startDate = strtotime($startDate);
            $endDate = strtotime($endDate);
            if ($startDate === false || $startDate < 0 || $endDate === false || $endDate < 0 || $startDate > $endDate)
                return false;

            $years = date('Y', $endDate) - date('Y', $startDate);

            $endMonth = date('m', $endDate);
            $startMonth = date('m', $startDate);

            // Calculate months
            $months = $endMonth - $startMonth;
            if ($months <= 0)  {
                $months += 12;
                $years--;
            }
            if ($years < 0)
                return false;

            // Calculate the days
            $measure = ($months == 1) ? 'month' : 'months';
            $days = $endDate - strtotime('+' . $months . ' ' . $measure, $startDate);
            $days = date('z', $days);   

            return array($years, $months, $days);
        } 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2012-11-04T00:15:39.783

`DateInterval`很棒，但有几点需要注意：

1.  仅适用于 PHP 5.3+（*但这真的不是一个好借口了*）
2.  仅支持年、月、日、小时、分钟和秒（无周）
3.  它计算上述所有+天的差异（您不能仅在几个月内获得差异）

为了克服这个问题，我编写了以下代码（从[*@enobrev* answer](https://stackoverflow.com/a/3959860/89771)改进）：

```
function date_dif($since, $until, $keys = 'year|month|week|day|hour|minute|second')
{
    $date = array_map('strtotime', array($since, $until));

    if ((count($date = array_filter($date, 'is_int')) == 2) && (sort($date) === true))
    {
        $result = array_fill_keys(explode('|', $keys), 0);

        foreach (preg_grep('~^(?:year|month)~i', $result) as $key => $value)
        {
            while ($date[1] >= strtotime(sprintf('+%u %s', $value + 1, $key), $date[0]))
            {
                ++$value;
            }

            $date[0] = strtotime(sprintf('+%u %s', $result[$key] = $value, $key), $date[0]);
        }

        foreach (preg_grep('~^(?:year|month)~i', $result, PREG_GREP_INVERT) as $key => $value)
        {
            if (($value = intval(abs($date[0] - $date[1]) / strtotime(sprintf('%u %s', 1, $key), 0))) > 0)
            {
                $date[0] = strtotime(sprintf('+%u %s', $result[$key] = $value, $key), $date[0]);
            }
        }

        return $result;
    }

    return false;
} 
```

它运行两个循环；第一个通过暴力破解处理相对间隔（年和月），第二个通过简单的算术计算额外的绝对间隔（所以它更快）：

```
echo humanize(date_dif('2007-03-24', '2009-07-31', 'second')); // 74300400 seconds
echo humanize(date_dif('2007-03-24', '2009-07-31', 'minute|second')); // 1238400 minutes, 0 seconds
echo humanize(date_dif('2007-03-24', '2009-07-31', 'hour|minute|second')); // 20640 hours, 0 minutes, 0 seconds
echo humanize(date_dif('2007-03-24', '2009-07-31', 'year|day')); // 2 years, 129 days
echo humanize(date_dif('2007-03-24', '2009-07-31', 'year|week')); // 2 years, 18 weeks
echo humanize(date_dif('2007-03-24', '2009-07-31', 'year|week|day')); // 2 years, 18 weeks, 3 days
echo humanize(date_dif('2007-03-24', '2009-07-31')); // 2 years, 4 months, 1 week, 0 days, 0 hours, 0 minutes, 0 seconds

function humanize($array)
{
    $result = array();

    foreach ($array as $key => $value)
    {
        $result[$key] = $value . ' ' . $key;

        if ($value != 1)
        {
            $result[$key] .= 's';
        }
    }

    return implode(', ', $result);
} 
```

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2013-06-12T12:56:27.770

一分钱，一磅：我刚刚回顾了几个解决方案，所有解决方案都使用 floor() 提供了一个复杂的解决方案，然后四舍五入到 26 年 12 个月和 2 天的解决方案，应该是 25 年，11月零二十天！！！！

这是我的这个问题的版本：可能不优雅，可能没有很好的编码，但如果你不计算闰年，可以更接近答案，显然闰年可以编码成这个，但在这种情况下 -正如其他人所说，也许你可以提供这个答案:: 我已经包含了所有 TEST 条件和 print_r 以便你可以更清楚地看到结果的构造:: 到这里，

// 设置你的输入日期/变量::

```
$ISOstartDate   = "1987-06-22";
$ISOtodaysDate = "2013-06-22"; 
```

// 我们需要将ISO yyyy-mm-dd 格式EXPLODE 为yyyy mm dd，如下：

$yDate[ ] = explode('-', $ISOstartDate); print_r ($yDate);

$zDate[ ] = explode('-', $ISOtodaysDate); print_r ($zDate);

```
// Lets Sort of the Years!
// Lets Sort out the difference in YEARS between startDate and todaysDate ::
$years = $zDate[0][0] - $yDate[0][0];

// We need to collaborate if the month = month = 0, is before or after the Years Anniversary ie 11 months 22 days or 0 months 10 days...
if ($months == 0 and $zDate[0][1] > $ydate[0][1]) {
    $years = $years -1;
}
// TEST result
echo "\nCurrent years => ".$years;

// Lets Sort out the difference in MONTHS between startDate and todaysDate ::
$months = $zDate[0][1] - $yDate[0][1];

// TEST result
echo "\nCurrent months => ".$months;

// Now how many DAYS has there been - this assumes that there is NO LEAP years, so the calculation is APPROXIMATE not 100%
// Lets cross reference the startDates Month = how many days are there in each month IF m-m = 0 which is a years anniversary
// We will use a switch to check the number of days between each month so we can calculate days before and after the years anniversary

switch ($yDate[0][1]){
    case 01:    $monthDays = '31';  break;  // Jan
    case 02:    $monthDays = '28';  break;  // Feb
    case 03:    $monthDays = '31';  break;  // Mar
    case 04:    $monthDays = '30';  break;  // Apr
    case 05:    $monthDays = '31';  break;  // May
    case 06:    $monthDays = '30';  break;  // Jun
    case 07:    $monthDays = '31';  break;  // Jul
    case 08:    $monthDays = '31';  break;  // Aug
    case 09:    $monthDays = '30';  break;  // Sept
    case 10:    $monthDays = '31';  break;  // Oct
    case 11:    $monthDays = '30';  break;  // Nov
    case 12:    $monthDays = '31';  break;  // Dec
};
// TEST return
echo "\nDays in start month ".$yDate[0][1]." => ".$monthDays;

// Lets correct the problem with 0 Months - is it 11 months + days, or 0 months +days???

$days = $zDate[0][2] - $yDate[0][2] +$monthDays;
echo "\nCurrent days => ".$days."\n";

// Lets now Correct the months to being either 11 or 0 Months, depending upon being + or - the years Anniversary date 
// At the same time build in error correction for Anniversary dates not being 1yr 0m 31d... see if ($days == $monthDays )
if($days < $monthDays && $months == 0)
    {
    $months = 11;       // If Before the years anniversary date
    }
else    {
    $months = 0;        // If After the years anniversary date
    $years = $years+1;  // Add +1 to year
    $days = $days-$monthDays;   // Need to correct days to how many days after anniversary date
    };
// Day correction for Anniversary dates
if ($days == $monthDays )   // if todays date = the Anniversary DATE! set days to ZERO
    {
    $days = 0;          // days set toZERO so 1 years 0 months 0 days
    };

    echo "\nTherefore, the number of years/ months/ days/ \nbetween start and todays date::\n\n";

    printf("%d years, %d months, %d days\n", $years, $months, $days); 
```

最终结果是:: 26 年 0 个月 0 天

这就是我在 2013 年 6 月 22 日做生意的时间——**哎呀！**

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2017-10-04T06:55:48.093

```
$date = '2012.11.13';
$dateOfReturn = '2017.10.31';

$substract = str_replace('.', '-', $date);

$substract2 = str_replace('.', '-', $dateOfReturn);

$date1 = $substract;
$date2 = $substract2;

$ts1 = strtotime($date1);
$ts2 = strtotime($date2);

$year1 = date('Y', $ts1);
$year2 = date('Y', $ts2);

$month1 = date('m', $ts1);
$month2 = date('m', $ts2);

echo $diff = (($year2 - $year1) * 12) + ($month2 - $month1); 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2020-05-08T09:14:34.220

我想提出一个稍微不同的观点，这似乎没有被提及。

你可以以声明的方式解决这个问题（就像任何其他问题一样）。关键是问你需要*什么*，而不是*如何*到达那里。

在这里，您需要有所不同。但那有什么区别呢？正如最受欢迎的答案中已经提到的那样，这是一个间隔。问题是如何得到它。而不是显式调用`diff()`方法，您可以只按开始日期和结束日期创建一个间隔，即按日期范围：

```
$startDate = '2007-03-24';
$endDate = '2009-06-26';
$range = new FromRange(new ISO8601DateTime($startDate), new ISO8601DateTime($endDate)); 
```

闰年之类的所有复杂问题都已经处理好了。现在，当您有一个固定开始日期时间的间隔时，您可以获得一个人类可读的版本：

```
var_dump((new HumanReadable($range))->value()); 
```

它准确地输出您需要的内容。

如果您需要一些自定义格式，这也不是问题。您可以使用一个`ISO8601Formatted`接受带有六个参数的可调用对象的类：年、月、日、小时、分钟和秒：

```
(new ISO8601Formatted(
    new FromRange(
        new ISO8601DateTime('2017-07-03T14:27:39+00:00'),
        new ISO8601DateTime('2018-07-05T14:27:39.235487+00:00')
    ),
    function (int $years, int $months, int $days, int $hours, int $minutes, int $seconds) {
        return $years >= 1 ? 'More than a year' : 'Less than a year';
    }
))
    ->value(); 
```

它输出`More than a year`.

有关此方法的更多信息，请查看[快速入门条目](https://meringue.readthedocs.io/en/latest/quick_start.html)。

# python - 拦截类中类中属性的变化 - Python

> ID：676826
> 
> 赞同：3
> 
> 时间：2009-03-24T10:34:25.397
> 
> 标签：python, class, attributes, subclass, pygame

我一直在搞乱 pygame 和 python，我希望能够在我的类的属性发生变化时调用一个函数。我目前的解决方案是：

```
class ExampleClass(parentClass):
   def __init__(self):
      self.rect = pygame.rect.Rect(0,0,100,100)
   def __setattr__(self, name, value):
      parentClass.__setattr__(self,name,value)
      dofancystuff()
Firstclass = ExampleClass() 
```

这很好用，当我用 更改 rect 值时会调用 dofancystuff `Firsclass.rect = pygame.rect.Rect(0,0,100,100)`。但是，如果我说`Firstclass.rect.bottom = 3`. `__setattr__`并没有调用 dofancystuff。

所以我想我的问题是如何拦截对子类属性的任何更改？

编辑：另外，如果我以错误的方式解决这个问题，请告诉我在 python 方面我不是很了解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T10:46:29.483

嗯，简单的答案是你不能。在`Firstclass.rect = <...>`你的情况下`__setattr__`被称为。但是在调用 Rect 实例`Firstclass.rect.bottom = 3`的`__setattr__`方法的情况下。我看到的唯一解决方案是创建一个派生类 pygame.rect.Rect 在其中覆盖该`__setattr__`方法。您也可以对 Rect 类进行猴子修补，但有充分的理由不鼓励这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T10:39:20.390

你可以试试`__getattr__`，应该叫上`Firstclass.rect`。

但改为这样做：`pygame.rect`为`ExampleClass.rect`. `__setattr__`在那个类中实现。现在，您将被告知在您的`rect`成员中设置的任何内容`ExampleClass`。您仍然可以`__setattr__`在`ExampleClass`（并且*应该*）中实现，只是现在确保您实例化您自己的`rect`类的版本......

顺便说一句：不要调用你的 objects `Firstclass`，因为它看起来像一个类而不是一个对象......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-07T16:56:26.487

这没有回答问题，但它是相关的：

```
self.__dict__[name] = value 
```

可能比

```
parentClass.__setattr__(self, name, value) 
```

这是 Python 文档 (setattr">http://docs.python.org/2/reference/datamodel.html?highlight=setattr#object. **setattr** ) 推荐的，并且在一般情况下更有意义，因为它没有假设任何关于 parentClass **setattr**的行为。

是的，不请自来的建议已经晚了四年！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-11T01:07:07.823

我认为您遇到这种困难的原因值得比其他答案提供的更多信息。

问题是，当你这样做时：

```
myObject.attribute.thing = value 
```

您没有为属性分配值。代码等价于：

```
anAttribute = myObject.attribute
anAttribute.thing = value 
```

正如 myObject 所见，您所做的一切都是为了获取属性；你没有设置属性。

制作您控制的属性的子类，并且可以为其定义 __setattr__ 是一种解决方案。

如果您有许多不同类型的属性并且不想为所有这些属性创建许多单独的子类，则另一种解决方案可能是有意义的，即覆盖 __getattribute__ 或 __getattr__ 以将外观返回到执行相关的属性__setattr__ 方法中的操作。我自己没有尝试过这样做，但我想您应该能够创建一个简单的外观类，它将充当任何对象的外观。

[在选择__getattribute__](http://docs.python.org/reference/datamodel.html#object.__getattribute__)和[__getattr__](http://docs.python.org/reference/datamodel.html#object.__getattr__)时需要小心。有关信息，请参阅上一句中链接的文档，但基本上如果使用 __getattr__ ，实际属性将以某种方式封装/混淆，以便 __getattr__ 处理对它们的请求，如果使用 __getattribute__ ，则必须检索属性通过调用基类。

如果您要做的只是确定某些矩形是否已更新，那么这是矫枉过正的。

# xml - 什么是 Oracle 原生 Web 服务？

> ID：676830
> 
> 赞同：2
> 
> 时间：2009-03-24T10:36:27.403
> 
> 标签：xml, oracle, web-services, oracle-xml-db

本机 Web 服务是 XML DB 技术的一个新特性。在 google 中我发现它非常接近 SOA。

谁能简单解释一下：1）Native Web 服务的主要用途是什么 2）XML DB 11g 和以前的 XML DB 版本的主要区别是什么。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T14:49:56.670

我找到了文档。那个挺难 ）

[Oracle XML DB 中有哪些新功能？](http://download.oracle.com/docs/cd/B28359_01/appdev.111/b28369/whatsnew.htm#sthref14)

新功能：

*   二进制 XML
*   XML索引
*   XMLType OCT 现在使用堆存储而不是 IOT
*   XML Schema Annotation storeVarrayAsTable 的默认值现在为 true
*   存储库事件
*   支持 Java 的内容存储库 API (JCR: JSR-170)
*   新的存储库资源链接类型
*   支持 WebDAV 权限和新的 Oracle XML DB 权限
*   网页服务
*   就地 XML 模式演变
*   支持递归 XML 模式
*   支持 XLink 和 XInclude
*   支持 XML 翻译
*   支持大型 XML 节点
*   统一的 Java API
*   对 XMLType 的 Oracle 数据泵支持
*   Oracle Streams 和 Logical Standby 对 XMLType 的支持
*   Oracle XDK 拉解析器 API（XML 事件，JSR-173）
*   XQuery 标准合规性
*   使用 PL/SQL 对网络服务进行细粒度访问
*   SQL/XML 标准合规性和性能增强
*   XML 更新性能增强
*   XQuery 和 SQL/XML 性能增强
*   XSLT 性能增强

关于网络服务。

Web 服务为应用程序通过 Internet 交换信息和访问实现业务逻辑的服务提供了一种标准方式。您的应用程序可以使用本机 Oracle XML DB Web 服务访问 Oracle 数据库。一项可用的服务允许您发出 SQL 和 XQuery 查询并以 XML 数据的形式接收结果。另一项服务提供对所有 PL/SQL 存储函数和过程的访问。使用后一种服务时可以自定义输入输出文件格式；WSDL 由本地数据库 Web 服务引擎自动生成。

SOAP 1.1 是 Oracle XML DB 支持的版本。应用程序使用 HTTP POST 方法将 SOAP 请求提交到本机 Oracle XML DB Web 服务。您可以使用 Oracle XML DB 配置文件 xdbconfig.xml 配置所有本机 Oracle XML DB Web 服务和 WSDL 文档的位置。您还可以使用相同的配置文件为 Web 服务配置安全设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T16:02:32.283

有优点也有缺点。如果您有 PL/SQL 方面经验丰富的开发人员，这可以让他们更轻松地提供和使用 Web 服务，而无需通过单独的应用服务器。

当然，您的安全人员可能会参与其中，特别是如果您希望在 Intranet 之外提供这些服务。但它在工具箱中提供了另一种工具。

我为去年的 ODTUG 会议写了一篇介绍 PL/SQL Web 服务的论文。它位于 www.odtug.com 的技术资源部分。看一看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T11:05:55.833

[通过谷歌找到：](http://www.inside-oracle-apex.com/oracle-11g-native-web-services/)

> 它允许您将 PL/SQL 包/过程/函数作为 Web 服务发布，零编码和零部署工作！

# php - AJAX 请求是否保留 PHP 会话信息？

> ID：676846
> 
> 赞同：160
> 
> 时间：2009-03-24T10:39:58.940
> 
> 标签：php, ajax, session

如果我有一个用户登录到我的网站，将他的 id 存储在 中`$_SESSION`，然后从他的浏览器中单击“保存”按钮，该按钮将向服务器发出 AJAX 请求。他`$_SESSION`和 cookie 是否会保留在此请求中，我可以安全地依赖 id 中存在的 id`$_SESSION`吗？

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2009-03-24T11:10:26.573

答案是肯定的：

会话在服务器端维护。就服务器而言，AJAX 请求和常规页面请求没有区别。它们都是 HTTP 请求，并且它们都以相同的方式在标头中包含 cookie 信息。

从客户端，无论是常规请求还是 AJAX 请求，始终将相同的 cookie 发送到服务器。Javascript 代码不需要做任何特别的事情，甚至不需要意识到这种情况的发生，它的工作方式与处理常规请求的方式相同。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-24T10:44:26.150

如果 AJAX 请求的 PHP 文件具有`session_start()`会话信息，将被保留。（禁止请求在同一个域内）

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-03-24T10:44:45.107

你真正得到的是：cookies 是否与 AJAX 请求一起发送？假设 AJAX 请求是针对同一个域（或在 cookie 的域约束内），答案是肯定的。因此，返回到同一服务器的 AJAX 请求确实保留了相同的会话信息（假设被调用的脚本发出 session_start() 就像任何其他想要访问会话信息的 PHP 脚本一样）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-06-01T23:37:54.837

**好吧，并非总是如此。**使用cookies，你很好。但是*“我可以安全地依赖存在的 id”*敦促我用一个重要的观点来扩展讨论（主要是为了参考，因为这个页面的访问者数量似乎很高）。

PHP 可以配置为通过 URL 重写而不是 cookie 来维护会话。*（[它的好坏如何](http://php.net/manual/en/session.security.php)（<--参见例如那里的最上面的评论）是一个[单独的问题](https://stackoverflow.com/questions/5944757/url-rewriting-does-that-cause-a-security-issue)，现在让我们坚持当前的问题，只有一个旁注：基于 URL 的会话最突出的问题——公然裸会话 ID 的可见性——对于内部 Ajax 调用来说不是问题；但是，如果它为 Ajax 开启，它也会为站点的其余部分开启，所以……）*

**在 URL 重写（无 cookie）会话的情况下，Ajax 调用必须自己处理好**它们的请求 URL 的正确构造。（或者您可以推出自己的自定义解决方案。在要求不高的情况下，您甚至可以求助于[在客户端](http://www.sitepoint.com/javascript-session-variable-library/)维护会话。）关键是会话连续性所需的*明确注意，如果不使用 cookie：*

1.  如果 Ajax 调用只是从 HTML 中逐字*提取*URL（从 PHP 接收），那应该没问题，因为它们已经被煮熟了（嗯，煮熟了）。

2.  如果他们需要自己*组装*请求 URI，则需要手动将会话 ID 添加到 URL。（查看[此处](http://php.net/manual/en/session.idpassing.php)，或 PHP 生成的页面源代码（[打开 URL 重写](http://www.php.net/manual/en/session.configuration.php#ini.session.use-trans-sid)）了解如何操作。）

* * *

来自[OWASP.org](https://www.owasp.org/index.php/Session_Management_Cheat_Sheet#Used_vs._Accepted_Session_ID_Exchange_Mechanisms)：

> *实际上，Web 应用程序可以使用两种机制，cookie 或 URL 参数，甚至在满足某些条件（例如，存在不支持 cookie 的 Web 客户端或不支持 cookie 时）从一种切换到另一种（自动 URL 重写）由于用户隐私问题而接受）。*

来自[Ruby 论坛](http://www.ruby-forum.com/topic/129971#580044)帖子：

> *当使用带有 cookie 的 php 时，会话 ID 将自动在请求标头中发送，即使对于 Ajax XMLHttpRequests。 **如果您使用或允许基于 URL 的 php 会话，则必须将会话 ID 添加到每个 Ajax 请求 url。***

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-24T11:08:30.570

AJAX 请求保留会话非常重要。最简单的示例是当您尝试对管理面板执行 AJAX 请求时，比如说。当然，您将保护您提出请求的页面，而不是其他没有管理员登录后获得会话的人访问的页面。说得通？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T11:20:46.267

但是要注意的一件事，特别是如果您使用的是框架，是检查应用程序是否在请求之间重新生成会话 id - 任何显式依赖于会话 id 的东西都会遇到问题，尽管显然其余数据在会话将不受影响。

如果应用程序正在像这样重新生成会话 ID，那么您最终可能会遇到这样的情况，即 ajax 请求实际上会使请求页面中的会话 ID 无效/替换。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-06T10:12:32.987

这就是框架所做的，例如，如果您在 Front Controller 或 boostrap 脚本中初始化会话，您将不必关心页面控制器或 ajax 控制器的初始化。PHP 框架不是灵丹妙药，但它们做了很多这样有用的事情！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-27T03:28:46.523

将您的 session() 身份验证放在所有接受 ajax 请求的服务器端页面中：

```
if(require_once("auth.php")) {

//run json code

}

// do nothing otherwise 
```

那是我做过的唯一方法。

# .net - How can I databind a gridview to an arraylist in .NET?

> ID：676860
> 
> 赞同：1
> 
> 时间：2009-03-24T10:44:38.490
> 
> 标签：.net, visual-studio-2008, data-binding

How can I databind a gridview to an arraylist in .NET?

I am using .NET 3.5 and Visual Studio 2008.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:16:13.647

使用泛型类 BindingList 代替 arraylist。它将允许您在两个方向上将此列表绑定到 DataGridView。因此，您在 BindingList 中的更改将反映在 DGV 中，反之亦然。

在这里，您可以获得有关 BindingList 类的更多信息：http: [//msdn.microsoft.com/en-us/library/ms132679.aspx](http://msdn.microsoft.com/en-us/library/ms132679.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T18:23:02.337

最简单的事情是建立一个替代集合；尝试使用 List<> 或 BindingList<>。

# c# - 在 C# 中确定打印机的 IP 地址

> ID：676863
> 
> 赞同：5
> 
> 时间：2009-03-24T10:45:09.380
> 
> 标签：c#, .net, network-programming, printing

我想使用 C# (.NET 2.0) 确定打印机的 IP 地址。我只有在 Windows 操作系统上设置的打印机共享名称，格式为`\\PC Name\Printer Name`. 打印机是网络打印机，与 PC 的 IP 地址不同。有没有人有任何指示？

在此先感谢您的帮助。

问候，安迪。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-04T04:16:50.000

只需在此处使用 .Net Framework 4.0 或更高版本添加另一个解决方案

```
Using System.Printing

 var server = new PrintServer();
            var queues = server.GetPrintQueues(new[] { EnumeratedPrintQueueTypes.Local, EnumeratedPrintQueueTypes.Connections });
            foreach (var queue in queues)
            {
                string printerName = queue.Name;
                string printerPort = queue.QueuePort.Name;
             } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-02-04T09:32:16.953

我知道这是一篇旧帖子，但我遇到了同样的问题，我能够获取打印机端口名称，但不能获取 IP。在我的情况下，我不能依赖端口名称是 IP_[IP 地址]，而是找到了如何从端口名称中获取实际 IP 的方法。

Windows 将有关端口的信息存储在注册表中

HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors\Standard TCP/IP Port\Ports\[端口名称]

此键包含在端口配置页面中设置的值，包括 IP 地址和端口号。

获取 IP 地址的快速 C# 示例

```
using Microsoft.Win32;

RegistryKey key = Registry.LocalMachine.OpenSubKey(@"System\CurrentControlSet\Control\Print\Monitors\Standard TCP/IP Port\Ports\" + printerPortName, RegistryKeyPermissionCheck.Default, System.Security.AccessControl.RegistryRights.QueryValues);
if (key != null)
{
    String IP = (String)key.GetValue("IPAddress", String.Empty, RegistryValueOptions.DoNotExpandEnvironmentNames);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-24T11:44:19.360

检查这个问题：[如何在 C#.NET 中获取打印机信息？](https://stackoverflow.com/questions/296182/how-to-get-printer-info-in-c-net/). 我认为您必须`PortName`从 WMI 属性中获取该属性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-11T15:06:37.657

在这里使用`WIN32_Printer`类是不够的。它应该与`Win32_TCPIPPrinterPort`类相结合。

下面是应该有帮助的代码：

```
static void Main(string[] args)
{
var scope = new ManagementScope(@"\root\cimv2");
scope.Connect();

var searcher = new ManagementObjectSearcher("SELECT * FROM Win32_Printer");
var results = searcher.Get();
Console.WriteLine("Network printers list:");
foreach (var printer in results)
{
  var portName = printer.Properties["PortName"].Value;

  var searcher2 = new ManagementObjectSearcher("SELECT * FROM Win32_TCPIPPrinterPort where Name LIKE '" + portName + "'");
  var results2 = searcher2.Get();
  foreach (var printer2 in results2)
  {
    Console.WriteLine("Name:" + printer.Properties["Name"].Value);
    //Console.WriteLine("PortName:" + portName);
    Console.WriteLine("PortNumber:" + printer2.Properties["PortNumber"].Value);
    Console.WriteLine("HostAddress:" + printer2.Properties["HostAddress"].Value);
                }
    Console.WriteLine();
  }
  Console.ReadLine();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T12:14:17.573

基于链接[如何在 .NET 中获取打印机信息？](https://stackoverflow.com/questions/296182/how-to-get-printer-info-in-c-net)（谢谢，帕诺斯，我已经在查看链接了！），我从[帕诺斯的](https://stackoverflow.com/users/8049/panos)回答中得到了以下解决方案：

```
using System.Management;

...

string printerName = "YourPrinterName";
string query = string.Format("SELECT * from Win32_Printer WHERE Name LIKE '%{0}'", printerName);
ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);
ManagementObjectCollection coll = searcher.Get();

foreach (ManagementObject printer in coll)
{
    string portName = printer["PortName"].ToString();
    if(portName.StartsWith("IP_"))
    {
        Console.WriteLine(string.Format("Printer IP Address: {0}", portName.Substring(3)));
    }
} 
```

显然，这仅在打印机的端口名称以“IP_IPAddress”格式给出时才有效，我相信这是默认设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T11:53:08.107

此打印机是否设置在具有 Active Directory 的网络中？或者这是在您自己的本地网络上，只有一个交换机和您的打印机插入其中？

如果是前者，那么您应该可以根据“打印机名称”进行查询。[本文展示了如何让 c# .net 连接到 AD](http://www.c-sharpcorner.com/UploadFile/kb_sathya/DotNETActiveDirectory04172007013054AM/DotNETActiveDirectory.aspx)。但这确实需要您网络中的 AD 服务器的一些知识。

这个解决方案对我来说似乎有点长，但可能是一个好的起点？

# c# - how to display items in listbox

> ID：676868
> 
> 赞同：0
> 
> 时间：2009-03-24T10:46:08.457
> 
> 标签：c#, .net, listbox, drop-down-menu

How to display list of items in list box while choose a particular item in dropdown list.

example: thiru is a developer he done some modules. in dropdown list has a list of developers while choose thiru in this list i want to display a what are all the modules completed by thiru that can be listed in listbox

I am using Visual Studio 2008,C# with ASP.Net

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T10:57:42.140

On the listbox databind your items to a datasource and add a parameter with the value from you drop down list.

This is roughly what you need to do.

```
 <form id="form1" runat="server">
    <div>

    <asp:ListBox ID="ListBox1" runat="server" DataSourceID="listDataSource" 
        DataTextField="Field" DataValueField="Field"></asp:ListBox>
        <asp:SqlDataSource ID="listDataSource" runat="server" 
            ConnectionString="<%$ ConnectionStrings:XXXX %>" 
            SelectCommand=
                "SELECT [Field] FROM [LisotOfModules] WHERE ([DevID] = @DevID)">
            <SelectParameters>
                <asp:ControlParameter ControlID="DropDownList1" Name="DevID" 
                    PropertyName="SelectedValue" Type="Int32" />
            </SelectParameters>
        </asp:SqlDataSource>

   </div>
   <asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True" 
        DataSourceID="ddlDatasource" DataTextField="DevID" 
        DataValueField="DevID">
   </asp:DropDownList>
   <asp:SqlDataSource ID="ddlDatasource" runat="server" 
        ConnectionString="<%$ ConnectionStrings:XXX %>" 
        SelectCommand="SELECT [DevID] FROM [Developers]">
   </asp:SqlDataSource>
   </form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T11:32:28.657

如果您的数据源只是一个列表或类似的，您可以简单地执行以下操作：

```
myListBox.DataSource = myDataSource;
myListBox.DataBind(); 
```

如果您的数据源是一个类或类列表，您需要指定要显示的属性以及要设置的值。

如上：

```
myListBox.DataSource = myDataSource;
myListBox.DataTextField = "MyPropertyNameOnMyClass"; //This will be displayed
myListBox.DataValueField = "MyValuePropertyOnMyClass";
myListBox.DataBind(); 
```

# c# - 将图像添加到列表框

> ID：676869
> 
> 赞同：4
> 
> 时间：2009-03-24T10:46:09.953
> 
> 标签：c#, wpf, image, listbox, return-value

我有一些带有一些文本的图像，我需要在列表框中显示带有相关文本的图像。

浏览谷歌我遇到了这个示例类，

```
public class Customer
{

    public string Fname;

    public string Lname;

public Customer(string firstName, string lastName)
{
    Fname = firstName;
    Lname = lastName;
}

public override string ToString()
{
    return Fname + " " + Lname;
}
}

lstCustomers.Items.Add(new Customer("Foo","Bar")); 
```

上面的代码工作正常，因为它只返回字符串，如何将图像和字符串一起返回，以便将其添加到列表框中？

最好的祝福

@nand

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T17:54:59.643

只需使用 a`DataTemplate`在 中显示您的对象`ListBox`。

创建一个包含字符串属性和图像属性的数据对象：

```
public class Img
{
    public Img(string value, Image img) { Str = value; Image = img; }
    public string Str { get; set; }
    public Image Image { get; set; }
} 
```

创建一个`DataTemplate`来显示这个：

```
<ListBox x:Name="lstBox">
    <ListBox.ItemTemplate>
        <DataTemplate DataType="{x:Type local:Img}">
            <StackPanel>
                <TextBlock Margin="3" Text="{Binding Str}"/>
                <ContentControl Margin="3" Content="{Binding Image}"/>
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

现在将`Img`项目（或您的数据对象）添加到`ListBox`类似这样：

```
lstBox.Items.Add(new Img("Value", myImage)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T10:49:21.990

你不能（不乱搞）把图像放在 ListBoxes 中。

您可以将它们放在 ListViews 中。

您需要将图像放入 ImageList 组件中，然后将 ImageList 附加到您的列表视图。当然，您可以通过添加 Image 属性并将其添加到 ImageList.Items 集合来将图像封装在您的类中。

然后对于 List 中的每个 ListViewItem，将 ImageIndex 属性设置为列表视图中图像的索引。

所有这些都可以使用设计器完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-24T20:04:03.173

首先将 ValueMemeber Image 属性（这里也是 String 属性）和 DrawMode 放入 OwnerDrawVariable 并重新定义 DrawItem

```
listbox1.DrawItem += new DrawItemEventHandler(listbox1_DrawItem);
listbox1.ItemHeight = 16;

private void listbox1_DrawItem(object sender, DrawItemEventArgs e)
       { 
e.DrawBackground();
        e.DrawFocusRectangle();
        Rectangle bounds = e.Bounds;
        Size imageSize = new Size(16, 16);
        Bitmap b;
        StringFormat sf = new StringFormat();
        sf.Alignment = StringAlignment.Far;
        Rectangle rc = new Rectangle(e.Bounds.X + 1, e.Bounds.Y + 1, e.Bounds.Width - 5, e.Bounds.Height - 3);
         UseObject s ;
         if (e.Index >= 0)
         {
             s = (UseObject)listbox1.Items[e.Index];

             b = new Bitmap(s.Img, imageSize);
             e.Graphics.DrawImage(b, e.Bounds.X, e.Bounds.Y);
             e.Graphics.DrawString(s.Str, new Font("Verdana", 10, FontStyle.Bold), new SolidBrush(Color.Black), rc, sf);
         }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T10:53:41.013

您可以将位图源对象添加到列表框项并将其添加到列表框。检查这个线程。 [http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f6b7f985-f11b-4d7f-845a-44851360ee1f/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f6b7f985-f11b-4d7f-845a-44851360ee1f/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-10T05:12:52.397

回答 Abbassi 的问题 -*但我收到错误“本地”是未声明的命名空间*

请参考以下内容：

在 Window 标签中添加“本地”命名空间。

```
<Window x:Class="MyApp.MyWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MyWindow" Height="400" Width="600"
    xmlns:local="clr-namespace:MyApp"> 
```

# c# - Dictionary enumeration in C#

> ID：676880
> 
> 赞同：31
> 
> 时间：2009-03-24T10:48:27.733
> 
> 标签：c#, .net, dictionary, enumeration

How do I enumerate a dictionary?

Suppose I use `foreach()` for dictionay enumeration. I can't update a key/value pair inside `foreach()`. So I want some other method.

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-03-24T10:51:20.223

To enumerate a dictionary you either enumerate the values within it:

```
Dictionary<int, string> dic;

foreach(string s in dic.Values)
{
   Console.WriteLine(s);
} 
```

or the KeyValuePairs

```
foreach(KeyValuePair<int, string> kvp in dic)
{
   Console.WriteLine("Key : " + kvp.Key.ToString() + ", Value : " + kvp.Value);
} 
```

or the keys

```
foreach(int key in dic.Keys)
{
    Console.WriteLine(key.ToString());
} 
```

If you wish to update the items within the dictionary you need to do so slightly differently, because you can't update the instance while enumerating. What you'll need to do is enumerate a different collection that isn't being updated, like so:

```
Dictionary<int, string> newValues = new Dictionary<int, string>() { 1, "Test" };
foreach(KeyValuePair<int, string> kvp in newValues)
{
   dic[kvp.Key] = kvp.Value; // will automatically add the item if it's not there
} 
```

To remove items, do so in a similar way, enumerating the collection of items we want to remove rather than the dictionary itself.

```
List<int> keys = new List<int>() { 1, 3 };
foreach(int key in keys)
{
   dic.Remove(key);
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-24T11:28:27.840

在回答“我无法在 foreach() 中更新值/键”问题时，您无法在枚举集合时修改它。我会通过制作 Keys 集合的副本来解决这个问题：

```
Dictionary<int,int> dic=new Dictionary<int, int>();

//...fill the dictionary

int[] keys = dic.Keys.ToArray();
foreach (int i in keys)
{
    dic.Remove(i);
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-24T10:51:28.257

Foreach. There are three ways: You can enumerate over the `Keys` property, over the `Values` property or over the dictionary itself which is an enumerator of `KeyValuePair<TKey, TValue>`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T11:42:07.197

我刚刚回答了列表的相同（更新）问题，所以字典也是一样的。

```
public static void MutateEach(this IDictionary<TKey, TValue> dict, Func<TKey, TValue, KeyValuePair<TKey, TValue>> mutator)
{
    var removals = new List<TKey>();
    var additions = new List<KeyValuePair<TKey, TValue>>();

    foreach (var pair in dict)
    {
        var newPair = mutator(pair.Key, pair.Value);
        if ((newPair.Key != pair.Key) || (newPair.Value != pair.Value))
        {
            removals.Add(pair.Key);
            additions.Add(newPair);
        }
    }

    foreach (var removal in removals)
        dict.Remove(removal);

    foreach (var addition in additions)
        dict.Add(addition.Key, addition.Value);
} 
```

请注意，我们必须在循环之外进行更新，因此我们在枚举字典时不会修改它。这也检测到由于使两个键相同而引起的冲突 - 它会抛出（由于使用`Add`）。

示例 - 使所有键小写并修剪所有值，使用`Dictionary<string, string>`：

```
myDict.MutateEach(key => key.ToLower(), value => value.Trim()); 
```

如果键在小写时不是唯一的，则会抛出。

# php - PHP - Alfresco integration

> ID：676884
> 
> 赞同：0
> 
> 时间：2009-03-24T10:50:38.897
> 
> 标签：php, web-services, alfresco

I am currently receiving a Strict Standards error when trying to make an alfresco web service call. I am using the Zend Framework. The tutorial works fine when not using the Zend Framework.

If i use the Zend_Soap_Client i get a segmentation error, when i use the PHP Soap_Client i get the following error message:

> Strict Standards: Declaration of AlfrescoWebService::__call() should be compatible with that of SoapClient::__call() in /opt/work/intranet/shamraiza/src/intranet/library/spectrum/Alfresco/AlfrescoWebService.php on line 130
> 
> Strict Standards: Declaration of AlfrescoWebService::__soapCall() should be compatible with that of SoapClient::__soapCall() in /opt/work/intranet/shamraiza/src/intranet/library/spectrum/Alfresco/AlfrescoWebService.php on line 130

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T09:10:49.193

对于第一个 Strict 标准，您只需像这样修改 AlfrescoWebService.php 中的函数 __call

`public function __call($function_name, $arguments)`

$arguments 不是可选的

对于第二个，

`public function __soapCall($function_name, $arguments=array(), $options=array(), $input_headers= array(), $output_headers=array())`

这必须像这样修改

`public function __soapCall($function_name, $arguments, $options=array(), $input_headers= array(), &$output_headers=array())`

$arguments 仍然不是可选的

$output_headers 通过引用传递。

# asp.net - How to add data in two records in a Gridview control in Asp.net

> ID：676887
> 
> 赞同：0
> 
> 时间：2009-03-24T10:51:27.680
> 
> 标签：asp.net

I have a Gridview control in asp.net in which there is column called Amount.i need to add 2 particular amounts.how can i do this?

I need to edit the Gridview control according to my needs.After editing,i need to add these amounts. I have another column called Ratecode in which the values are R1,R2,R3.

Again, i have four records in which the Ratecode is R1 for the first 2 records and R3 for the next two records.i need to add the amount for the records having R1 only and those having R3 only.

How can i do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T10:57:02.253

Assuming your GridView is data bound you can add one calculated column in your DataTable that is the sum of your amounts.

# excel - 基于数据透视表样式数据源的 xls 级联查找？

> ID：676893
> 
> 赞同：0
> 
> 时间：2009-03-24T10:53:29.997
> 
> 标签：excel, xls, cascadingdropdown

假设数据集看起来像

```
Country Region  Product
UK  North   fdhlw46
UK  North   fdhlw47
UK  North   fdhlw48
UK  North   fdhlw49
UK  North   fdhlw50
UK  South   fdhlw51
UK  South   fdhlw52
UK  South   fdhlw53
UK  South   fdhlw54
UK  South   fdhlw55
UK  South   fdhlw56
UK  South   fdhlw57
UK  West    fdhlw58
UK  West    fdhlw59
UK  West    fdhlw60
UK  London  fdhlw61
UK  London  fdhlw62
USA New York    fdhlw63
USA New York    fdhlw64
USA New York    fdhlw65
USA New York    fdhlw66
USA Chicago fdhlw67
USA Chicago fdhlw68
USA Chicago fdhlw69
USA Chicago fdhlw70
USA LA  fdhlw71
USA LA  fdhlw72
USA LA  fdhlw73
USA LA  fdhlw74
USA LA  fdhlw75 
```

如何在用户选择的国家/地区，然后缩小到区域和最终产品的 excel 中获得级联下拉列表/选择列表？

到目前为止，我所拥有的只是一个名为“国家”的范围，然后我可以“数据 - 验证 - 来源：= 国家”，但这只会给我第一个值，并且它不会删除重复项

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:42:39.857

[http://www.contextures.com/xlDataVal13.html](http://www.contextures.com/xlDataVal13.html)

这种方法确实意味着为每个分组定义一组唯一的值，但这很简单。

感谢其他想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T11:04:20.440

选择范围，然后选择数据 -> 过滤器 -> 自动过滤器。这是否实现了您正在寻找的东西？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T11:07:35.707

我认为您想使用 INDIRECT 函数来查找单元格的值，而不是直接在数据验证中定义查找范围。看看[这个页面](http://www.dicks-blog.com/archives/2004/05/11/conditional-data-validation/)，它解释得很好。

请注意，尽管像这样的多个级联验证有其自身的特殊问题。主要是，如果您进行第二次（或第三次等）选择，然后返回并编辑第一个选择，则不会自动标记该选择现在可能无效。例如，如果您有以下情况：

```
类型详细信息
水果 苹果
```

...然后更改第一列：

```
类型详细信息
蔬菜苹果
```

...那么你现在可能有问题了。找到这种不一致可能非常困难，或者需要一些代码来突出显示/修复。DDoE 博客展示了一种使用条件格式突出显示此类错误的方法，但这种方法计算量很大，并且不能很好地扩展。

请注意，如果随意使用这种性质的多次查找，即使不使用条件格式，也会使工作簿瘫痪。

总而言之，对于一个数据输入受到严格控制的小型项目，这是一种级联下拉列表的灵活方法，但是如果您对用户几乎没有控制，或者如果收集的数据将增长到数百行，那么您我可能想看看使用 VBA 验证验证（！），或者只是全力以赴并通过用户窗体强制输入，这是迄今为止最好的选择。

编辑：[示例工作簿](http://www.2shared.com/file/5163775/151deda6/SO_-_adolf_garlic.html)

再次编辑：如果数据必须保持原样，则需要一个高级过滤器来创建验证中使用的命名范围。在这种复杂程度下，您肯定最好只使用表单进行数据输入。

# c# - 在列表上使用带有 foreach 操作的条件 lambda 语句

> ID：676904
> 
> 赞同：5
> 
> 时间：2009-03-24T10:57:27.743
> 
> 标签：c#, lambda

为什么我不能做这样的事情？

如果我有一个`List<String> myList`填充项目，我希望能够以有条件的方式对每个成员进行操作，如下所示：

```
myList.ForEach(a => { if (a.Trim().Length == 0) a = "0.0"; }) 
```

但这不会编译。我猜它与缺少返回值有关吗？

我试图准备一个要转换为双精度的字符串列表，并且我希望空项目显示“0.0”，这样我就可以一次性转换整个列表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T10:59:23.667

ForEach 不是可变的，它不会以任何方式改变数据结构。

您可以：

1.  自己处理循环，带有索引
2.  使用 .Select 和 .ToList 生成一个新列表（前提是您使用的是 .NET 3.5）

#1 的示例：

```
for (Int32 index = 0; index < myList.Count; index++)
    if (myList[index].Trim().Length == 0)
        myList[index] = "0.0"; 
```

使用 .NET 3.5 和 Linq：

```
myList = (from a in myList
          select (a.Trim().Length == 0) ? "0.0" : a).ToList(); 
```

使用 .NET 3.5，不使用 Linq 语法，而是使用 Linq 代码：

```
myList = myList.Select(a => (a.Trim().Length == 0) ? "0.0" : a).ToList(); 
```

* * *

**编辑**：如果你想生成一个新的双打列表，你也可以使用 Linq 一次性完成：

```
List<Double> myDoubleList =
    (from a in myList
     select (a.Trim().Length == 0 ? "0" : a) into d
     select Double.Parse(d)).ToList(); 
```

请注意，使用“0.0”而不是“0”依赖于小数点是句号。在我的系统上不是这样，所以我只用“0”替换了它，但更合适的方法是更改​​对 Double.Parse 的调用以采用显式数字格式，如下所示：

```
List<Double> myDoubleList =
    (from a in myList
     select (a.Trim().Length == 0 ? "0.0" : a) into d
     select Double.Parse(d, CultureInfo.InvariantCulture)).ToList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T11:16:37.027

你可能想要的是：

```
public static void MutateEach(this IList<T> list, Func<T, T> mutator)
{
    int count = list.Count;
    for (int n = 0; n < count; n++)
        list[n] = mutator(list[n]);
} 
```

这将允许：

```
myList.MutateEach(a => (a.Trim().Length == 0) ? "0.0" : a); 
```

只需将该`MutateEach`方法放在您自己的公共静态类中，并确保您有一个可以找到它的 using 指令。

是否值得定义这样的东西取决于你使用它的频率。请注意，它必须是 on`IList`而不是的扩展`IEnumerable`，因此我们可以执行更新，这使得它不太适用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:33:22.613

@daniel-earwicker 的`MutateEach`扩展解决方案是一个很好的解决方案。

* * *

但是，对于返回一个新的`List`，您可以选择使用`List.ConvertAll<TTo>(Converter<TFrom,TTo>(Func<TFrom, TTo>))`，它自 .NET 2.0 以来就一直存在。

它不是**Linq**或**Lambda**。

```
List<String> nodeStringList = new List<String>(new String[] { "", "0.5 ", " 1.1"}); 

nodeStringList = nodeStringList.ConvertAll<String>((c) => (c.Value.Trim().Length != 0) ? c.Value.Trim() : "0.0"); 
```

* * *

[MSDN 参考 - List.ConvertAll](http://msdn.microsoft.com/en-US/library/73fe8cwf(v=vs.85).aspx#Y100)

# lotus-notes - 动态 LotusScript 多维数组

> ID：676906
> 
> 赞同：0
> 
> 时间：2009-03-24T10:58:04.137
> 
> 标签：lotus-notes, lotus-domino, lotusscript

我只是在做一些令人讨厌的代码，我想，而不是使用三个动态数组，如下所示：

暗淡 x() 作为字符串，y() 作为字符串，z() 作为字符串

拥有一个 3 维动态数组会更好。但; 帮助和我笨拙的实验并没有揭示定义它们的方法。

这不起作用：

暗淡 x()() 或暗淡(,2) 或暗淡(,)

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T15:06:47.050

动态数组的声明方式与维数无关（LotusScript 中的数组最多可以有 8 个维）。根据您的示例，我认为这是您想要的二维数组，其中第一个维度限制为三个条目。

如果您首先将数组声明为：

```
Dim x() As String 
```

然后，您可以根据以下示例指定边界：

```
Redim x( 0 To 2, 0 To 9 ) ' A two dimensional array 
```

如果您以后需要扩大数组（并保留所有值），您可以这样做：

```
Redim Preserve x( 0 To 2, 0 To 99 ) 
```

请记住，一旦设置了数组的维数，就只能更改最后一维的边界。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-30T13:47:44.853

您可以使用列表而不是数组。

```
Dim x list as String 
```

这是完全动态的，并以字符串作为索引。列表不能包含列表，但列表可以包含对象，因此您可能想要这样做

```
Public Class ListContainer
   Public level2 List as String
End Class 
```

这样你就永远不需要 REDIM 保存。一个 forall 循环你通过一个列表保存

# c# - C# 与 C++ 中的虚拟调用速度

> ID：676915
> 
> 赞同：8
> 
> 时间：2009-03-24T10:59:50.217
> 
> 标签：c#, c++, polymorphism, virtual

我似乎记得在某处读到过，相对而言，C# 中的虚拟调用的成本不如 C++ 中的高。这是真的？如果是这样 - 为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T12:11:51.107

AC# 虚拟调用必须检查“this”是否为空，而 C++ 虚拟调用则不需要。所以我一般看不出为什么 C# 虚拟调用会更快。在特殊情况下，C# 编译器（或 JIT 编译器）*可能*能够比 C++ 编译器更好地内联虚拟调用，因为 C# 编译器可以访问更好的类型信息。C++ 中的调用方法指令*有时*可能较慢，因为 C# JIT 可能能够使用更快的指令，该指令仅处理较小的偏移量，因为它比 C++ 编译器更了解运行时内存布局和处理器模型。

但是，我们在这里最多谈论一些处理器指令。在调制解调器超标量处理器上，“空值检查”指令很可能与“调用方法”同时运行，因此不需要时间。

如果调用是在循环中进行的，那么所有处理器指令也很可能已经在 1 级缓存中。但是数据不太可能是缓存，这些天从主内存读取数据值的成本与从一级缓存中运行 100 条指令的成本相同。因此，不幸的是，在实际应用中，虚拟通话的成本甚至在少数几个地方都可以衡量。

C# 代码使用更多指令这一事实当然会减少可以放入缓存的代码量，其效果无法预测。

（如果 C++ 类使用多重继承，则成本会更高，因为必须修补“this”指针。同样，C# 中的接口会增加另一层重定向。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T11:41:47.183

对于 JIT 编译语言（我不知道 CLR 是否这样做，Sun 的 JVM 是否这样做），将只有两个或三个实现的虚拟调用转换为对类型和直接或内联的一系列测试是一种常见的优化来电。

这样做的好处是现代流水线 CPU 可以使用分支预测和直接调用的预取，但是间接调用（由高级语言中的函数指针表示）通常会导致流水线停顿。

在限制情况下，只有一个虚拟调用的实现并且调用的主体足够小，虚拟调用被简化为纯粹的[内联代码](http://en.wikipedia.org/wiki/Inline_caching)。该技术用于[Self 语言](http://en.wikipedia.org/wiki/Self_(programming_language))运行时，JVM 是从该运行时演变而来的。

大多数 C++ 编译器不会执行执行此优化所需的整个程序分析，但 LLVM 等项目正在研究诸如此类的整个程序优化。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-24T13:58:18.197

原来的问题说：

> 我似乎记得在某处读到过，**相对而言**，C# 中的虚拟调用成本不如 C++ 中的高。

注意重点。换句话说，这个问题可以改写为：

> 我似乎记得在某处读过，在 C# 中，虚拟和非虚拟调用同样慢，而在 C++ 中，虚拟调用比非虚拟调用慢......

所以提问者并没有声称 C# 在任何情况下都比 C++ 快。

可能是无用的转移，但这激发了我对带有 /clr:pure 的 C++ 的好奇心，不使用 C++/CLI 扩展。编译器生成的 IL 会被 JIT 转换为本机代码，尽管它是纯 C++。因此，在这里我们可以看到标准 C++ 实现在与 C# 相同的平台上运行时的作用。

使用非虚拟方法：

```
struct Plain
{
    void Bar() { System::Console::WriteLine("hi"); }
}; 
```

这段代码：

```
Plain *p = new Plain();
p->Bar(); 
```

... 导致`call`使用特定方法名称发出操作码，向 Bar 传递一个隐式`this`参数。

```
call void <Module>::Plain.Bar(valuetype Plain*) 
```

与继承层次结构比较：

```
struct Base
{
    virtual void Bar() = 0;
};

struct Derived : Base
{
    void Bar() { System::Console::WriteLine("hi"); }
}; 
```

现在如果我们这样做：

```
Base *b = new Derived();
b->Bar(); 
```

而是发出`calli`操作码，它跳转到计算的地址 - 所以在调用之前有很多 IL。通过将其转回 C#，我们可以看到发生了什么：

```
**(*((int*) b))(b); 
```

换句话说，将地址`b`转换为指向 int 的指针（恰好与指针大小相同）并取该位置的值，即 vtable 的地址，然后取 vtable 中的第一项，这是要跳转到的地址，取消引用并调用它，并将隐式`this`参数传递给它。

我们可以调整虚拟示例以使用 C++/CLI 扩展：

```
ref struct Base
{
    virtual void Bar() = 0;
};

ref struct Derived : Base
{
    virtual void Bar() override { System::Console::WriteLine("hi"); }
};

Base ^b = gcnew Derived();
b->Bar(); 
```

This generates the `callvirt` opcode, exactly as it would in C#:

```
callvirt instance void Base::Bar() 
```

So when compiling to target the CLR, Microsoft's current C++ compiler doesn't have the same possibilities for optimization as C# does when using the standard features of each language; for a standard C++ class hierarchy, the C++ compiler generates code that contains hard-coded logic for traversing the vtable, whereas for a ref class it leaves it to the JIT to figure out the optimal implementation.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T11:07:21.867

我猜这个假设是基于 JIT 编译器的，这意味着 C# 可能会在实际使用之前将虚拟调用转换为简单的方法调用。

但这本质上是理论上的，我不会打赌！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T11:06:14.850

C++ 中虚拟调用的成本是通过指针 (vtbl) 调用函数的成本。我怀疑 C# 能否更快地做到这一点，并且仍然能够在运行时确定对象类型......

**编辑：**正如 Pete Kirkham 所指出的，一个好的 JIT 可能能够内联 C# 调用，避免管道停顿；大多数 C++ 编译器（还）不能做的事情。另一方面，Ian Ringrose 提到了对缓存使用的影响。再加上 JIT 本身正在运行，并且（严格个人而言）我不会真正打扰，除非在实际工作负载下在目标机器上进行分析*证明*一个比另一个更快。充其量只是微优化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T11:16:20.317

不确定完整的框架，但在 Compact Framework 中它会变慢，因为 CF 没有虚拟调用表，尽管它确实缓存了结果。这意味着 CF 中的虚拟调用在第一次调用时会变慢，因为它必须进行手动查找。如果应用程序内存不足，则每次调用它可能会很慢，因为缓存的查找可能会被投放。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T13:04:06.737

在 C# 中，可以通过分析代码将虚函数转换为非虚函数。在实践中，它不会经常发生，足以产生很大的不同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T13:19:15.110

C# 扁平化了 vtable 和内联祖先调用，因此您不必链接继承层次结构来解决任何问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-24T13:56:51.023

这可能不完全是您问题的答案，但是尽管 .NET JIT 优化了虚拟调用，正如大家之前所说的那样，Visual Studio 2005 和 2008 中的[配置文件引导优化](http://msdn.microsoft.com/en-us/library/e7k32f4k(VS.80).aspx)通过插入对最可能的目标函数的直接调用来进行虚拟调用推测，内联调用，因此权重可能相同。

# visual-studio - Is there any other advantage to using '_svn' directories instead of '.svn' in a Subversion controlled Visual Studio working copy

> ID：676916
> 
> 赞同：2
> 
> 时间：2009-03-24T11:01:15.330
> 
> 标签：visual-studio, svn

I've heard that Visual Studio doesn't like the .svn directories in a working copy from a subversion repository, and that using '_svn' is a better choice. Apart from not being hidden by the explorer, what is this mysterious advantage, or is this all a dirty rumour?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T11:37:41.360

Visual Studio 2002 和 2003 在以点开头的目录存在问题。尤其是在将它们与 webprojects 和 FrontPage 服务器扩展结合使用时。

如果您只使用 Visual Studio 2005 及更高版本，我建议您只使用 Subversion 默认的 .svn。

当您定义环境变量 SVN_ASP_DOT_NET_HACK 时，大多数 Subversion 客户端会自动切换到使用**_svn**。定义此变量的最简单方法是在 TortoiseSVN 中选择 _svn 设置。然后其他客户端将自动使用此设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T21:56:08.563

VS 2003 要求您使用 _svn。

这是一些 SVN 的精彩之处。我仍在维护一个 ASP.Net 1.1 应用程序并使用 VS 2003，因此我的 SVN 客户端设置为使用“_svn”。我团队中的其他开发人员没有这个问题，因此他们的 SVN 客户端使用“.svn”目录。这对 SVN 存储库没有影响，我们仍然可以共享代码。

# text - 如何将 Fortran77 代码的结果保存到文本文件中？

> ID：676920
> 
> 赞同：-2
> 
> 时间：2009-03-24T11:03:21.863
> 
> 标签：text, fortran77

我想将结果保存在文本文件中。我怎样才能做到这一点？写命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:29:41.633

是的，写命令。详细信息应该在某本书或网上，但这里有一个简单的例子：

```
OPEN(UNIT=20, FILE='FILENAME.TXT', STATUS='NEW')
C STATUS='NEW' WILL CREATE A NEW FILE IF ONE DOESN'T EXITST, 'REPLACE' WILL
C OVERWRITE OLD ONE
WRITE(UNIT=20, *)(A(I),I=1,10)
CLOSE(UNIT=20) 
```

在 fortran77 中，避免低（低于 10）的单元号总是很好的做法，因为其中一些是保留的 - 取决于平台、编译器......通常，从 10 以上的那些开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T11:19:20.343

是的，写命令。以及打开文件的 open 命令。像这样的东西，如果我生锈的 FORTRAN 记忆服务：

```
OPEN(UNIT=1, FILE=FNAME, STATUS='NEW')
WRITE(UNIT=1,FMT=*) "your data" 
```

您的另一个选择是简单地写入标准输出 (unit=*) 并从命令行重定向输出（例如：$ myfortranprogram > output.txt）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T11:20:12.507

如果您使用的是 unix/linux（很可能），那么只需将输出重定向到一个文件：

```
a.out > myoutputfile 
```

其中 a.out 是编译后的可执行文件的名称。或者，更改您的代码以写入文件而不是仅写入控制台：

```
io=22 !or some other integer number
open(io,file="myoutputfile")
write(io,*)myint,myreal
close(io) 
```

或继续将值附加到现有文件：

```
open(io,file="myoutputfile",position="APPEND") 
```

但这仅在 fortran 90 中可行，在 fortran 77 中不可行。在这种情况下，请尝试将 .f 重命名为 .f90。

# actionscript-3 - 在 AS3 中执行动态算法

> ID：676923
> 
> 赞同：0
> 
> 时间：2009-03-24T11:04:21.593
> 
> 标签：actionscript-3

我在 AS3 中有一个 Flash。我想动态加载执行某种计算的代码。使用 AS3 是否可行（我读过没有 eval）？我应该在 AS3 中使用解释器来获取数据并进行计算吗？

我的第一个想法是加载一个执行所有计算的外部 swf，但我认为拥有一个从套接字获取输入的引擎作为一种解决方案更为优雅。

那么，如何在 swf 文件中执行来自服务器的算法呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T11:34:04.847

好吧，[metalbot](http://metal.hurlant.com/)有一个[AS3 Eval 库](http://eval.hurlant.com/)。你应该看看。

您也可以使用浏览器 JS 引擎对从服务器下载的代码执行 JavaScript eval。看看[`ExternalInterface`](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html)AS3 类。

如果您的代码片段数量有限，您可以使用从服务器下载的特殊 swfs（预先准备好的）与这些代码片段。加载 swf 后，您可以使用它的代码库而无需任何 eval。

# windows - 任何 Windows 媒体服务专家

> ID：676924
> 
> 赞同：0
> 
> 时间：2009-03-24T11:04:50.017
> 
> 标签：windows, flash, service, streaming, media

有谁知道 Windows Media Service 是否支持 Windows Server 2003 上的流式 flv？我试过但没有找到任何索赔文件。

[http://www.microsoft.com/windows/windowsmedia/forpros/server/server.aspx](http://www.microsoft.com/windows/windowsmedia/forpros/server/server.aspx)

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:11:09.933

不幸的是，Windows Media Services 似乎没有流式传输 FLV：

> 运行 Windows Media Services 9 系列的服务器可以流式传输以下文件类型：
> 
> *   Windows 媒体音频 (WMA)
> *   Windows 媒体视频 (WMV)
> *   高级系统格式 (ASF)
> *   MP3
> *   Windows 媒体播放列表 (WSX)
> 
> 来源：[微软](http://www.microsoft.com/windows/windowsmedia/forpros/server/faq.aspx#2_4)

最常见的解决方案是：

> *   Flash Media Server（以前称为 Flash Communication Server）
> *   Red5 服务器（开源）
> *   Wowza Pro
> *   风险控制系统
> *   电子服务器
> *   .NET 的 WebORB
> 
> 来源：[维基百科](http://en.wikipedia.org/wiki/Flash_Video)

# glassfish - 给 EJB 一个 JNDI

> ID：676926
> 
> 赞同：1
> 
> 时间：2009-03-24T11:05:53.587
> 
> 标签：glassfish, ejb, jndi

我已经使用远程接口创建了 EJB：

```
@Stateless
public class TestSessionBean implements TestSessionRemote 
{

    public void businessMethod() 
    {
            System.out.println ("***businessMethod");
    }
} 
```

我通过以下方式从服务器上运行的另一个组件（例如 servlet）访问它：

```
ic = new InitialContext();
ic.lookup("myEJB"); 
```

我正在使用 netBeans 6.5.1 和 glassfish v2。

我怎样才能做到这一点？

谢谢，伊多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T11:28:13.940

实际上 ejb3 使用默认命名约定，我还没有找到解决方法。

您的 bean 的名称类似于：TestSessionBean#package.TestSessionBean

要访问您的远程服务，您可以执行以下操作

```
InitialContext ctx = new InitialContext();
ctx.lookup(interfaceClass.getSimpleName()+"#"+interfaceClass.getName()); 
```

其中 interfaceClass 是您的远程接口的类。

请注意，您还没有为该网络服务器定义远程接口（或本地接口）。您可能无法从另一个上下文访问 theejb。

至于更改实际上是我认为不可能通过注释的名称。不过不确定

# java - 私人会员访问 Java

> ID：676930
> 
> 赞同：7
> 
> 时间：2009-03-24T11:06:26.783
> 
> 标签：java, accessibility, private-members

是在类级别还是在对象级别的私有成员访问。如果是在对象级别，那么下面的代码不应该编译

```
 class PrivateMember {
   private int i;
   public PrivateMember() {
      i = 2;
   }
   public void printI() {
      System.out.println("i is: "+i);
   }
   public void messWithI(PrivateMember t) {
      t.i *= 2;
   }
   public static void main (String args[]) {
      PrivateMember sub = new PrivateMember();
      PrivateMember obj = new PrivateMember();
      obj.printI();
      sub.messWithI(obj);
      obj.printI();
   }
} 
```

请说明在 sub 的 messWithI() 方法中访问 obj 的成员 i 是否有效

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T11:13:45.940

正如 DevSolar 所说，它处于（顶级）级别。

从[Java 语言规范的第 6.6 节](http://java.sun.com/docs/books/jls/third_edition/html/names.html#6.6)：

> 否则，如果成员或构造函数被声明为私有，则当且仅当它出现在包含成员或构造函数声明的顶级类（第 7.6 节）的主体内时，才允许访问。

请注意，没有迹象表明它仅限于特定对象的成员。

从 Java 7 开始，[编译器不再允许访问类型变量的私有成员](http://www.oracle.com/technetwork/java/javase/compatibility-417013.html#source)。因此，如果该方法具有这样的签名，`public <T extends PrivateMember> void messWithI(T t)`那么访问将是编译器错误`t.i`。但是，这不会改变您的特定情况。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T11:16:01.007

请注意，您甚至不需要源级别的访问权限来处理私有字段。通过使用`java.lang.reflect.AccessibleObject.setAccessibe()`，所有代码都可以访问所有其他代码的所有私有成员，除非您指定了不允许的安全策略。

**`private`本身并不是一个安全功能！**这只是对其他开发人员的强烈暗示，即代码中其他部分不应依赖的内部实现细节。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T11:19:03.900

两者都不。私有访问的范围仅限于封闭的顶级类，因此您可以访问同一顶级类中不同类的私有成员：

```
class PrivateAccess {
    static class InnerOne {
        private int value;
    }

    static class InnerTwo {
        int getOne ( InnerOne other ) {
            return other.value;
        }
    }
} 
```

类访问的通常含义意味着您可以访问相同类型的其他实例的私有。在 Java 中，私有访问是由词法决定的，而不是由类型决定的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T11:09:07.700

班级水平。这个想法是一个类的代码（但没有别的）知道如何处理该类的对象。

如果您无论如何都可以访问类源代码，那么对您“隐藏”任何东西就没有什么意义了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T11:39:55.330

*正如其他人所说，私有、默认访问（“包私有”）、受保护以及可能在 JDK 7 模块中是基于类的（嵌套类继承*有非常奇怪的规则，我不记得了）。但为什么？

主要取决于充当二元（或更多）运算符的方法。为了有效地实现，它们通常需要或者更容易编写，而无需使用或修改公共 API。看看实现`equals`- 在好的代码中，您会发现直接访问字段的方法调用很少`this`。（这种性能方面现在与现代 JVM 内联常见调用几乎无关，但代码质量问题仍然存在。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T11:16:13.703

只是为了添加 DevSolar 的答案，我希望 messWithI 被声明为静态的：

```
public static void messWithI(PrivateMember t) {
  t.i *= 2; 
```

我什至很难在没有“静态”提示的情况下阅读你试图做什么......而且它也让你更容易回答你原来的问题——即私人成员的范围不限于只是有问题的实例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T11:51:32.697

同一页说，在 6.6.8 小节中，您还可以找到以下语句：

> 私有类成员或构造函数只能在包含成员或构造函数声明的顶级类的主体内访问。它不被子类继承。

我们在这里评估其访问权限的私有类成员是*i*。

*public void messWithI()*是一种存在于已声明*i*的顶级类的主体中的方法，确切地说，就是*PrivateMember*。

您的构造符合上述陈述，这就是它运行没有问题的原因。

这是与 Jon 和 Devsolar 相同的另一种说法。

类成员的访问修饰符与代码的编写位置（在哪个包中以及在哪个类中）相关，而不管授予访问权限的成员类型是：类成员或实例成员。

从逻辑上讲，如果您没有类的实例，则不能使用该类的实例成员，但这是一个不同的问题，与成员的生命周期有关。

# django - 使用 django admin 创建整个 Web 应用程序

> ID：676931
> 
> 赞同：15
> 
> 时间：2009-03-24T11:07:04.287
> 
> 标签：django, web-applications, django-admin

我在想 django admin 是一个实用程序，可以为站点的受信任管理员提供对站点数据模型的完全访问权限。

然而，在详细浏览了 django admin 之后，我了解到它是一组非常强大的视图和模板，可以用来创建整个应用程序。

您多久单独使用 admin 创建一个完整的应用程序？使用视图本身创建比自定义管理更容易吗？

如何使用管理员构建原型。我们甚至需要构建原型吗？管理员自定义不能在实际应用程序中重复使用。

如果我想在实际应用程序中使用部分管理代码（使用不同的模板），是否有某种可用的脚手架选项？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-24T13:54:49.360

“管理员不是你的应用程序。”

如果自定义超出了微不足道的范围，请编写您自己的视图。

以我的经验，我让内部管理页面相对保持不变。相反，我覆盖了管理索引模板，当用户需要进行重要的报告或表单处理时，我会在其中放置指向自定义编写视图的链接。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-24T13:04:44.847

我以前做过类似的事情。这是一个完全通过扩展 Django admin 实现的大学 CMS。事实证明，这是一个糟糕的设计决定。我不得不跳过篮球做一些事情。

这实际上取决于您的应用程序的要求。如果需要大量 ajax 或某些特定的工作流程扩展管理员将不是正确的做法。但我认为扩展管理员可以覆盖 60% 的案例。

它也非常适合构建原型。

**编辑**

好的，那是在 0.96 天内。

到目前为止，我已经构建了 2 个完全在新管理员之上的生产中的“大”站点。这些主要是案例管理、数据输入和报告，因此它们可以被压缩到管理员的工作流程中。但是，在扩展基础站点、ModelAdmin、InlineModelAdmin 等方面并非没有付出很大的努力。我们之所以要这样做，是因为我们被迫快速完成。但在第一种情况下，它也非常适合要求。两者都在政府部门的 Intranet 上运行。两者都做得很好。一个有 200 个表，处理数以万计的条目。另一个管理付款。

所以，是的，这是真的。管理员不是您的应用程序。但是，尽管其中大部分没有记录在案，但它具有足够的可扩展性。它适用于大多数基本的企业工作流程。因此，在有限数量的场景中值得考虑。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-01-03T06:21:59.713

我不同意大多数其他答案。

简而言之，使用管理应用程序免费获得的东西是无与伦比的。

你的第一次定制管理员会很困难，因为你将面临陡峭的学习曲线（你需要处理覆盖模板、管理器、模型管理员，可能使用数据库视图、CSS 和 JS、一些额外的表单和验证规则， ETC...）。但是一旦完成，您就会开始觉得将管理系统弯曲到您的需要是王道。我已经构建了一个复杂的库存和会计 Web 应用程序，其中包含数据输入、报告和权限系统，所有这些都完全基于管理界面和后端。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T18:26:45.463

Django Admin 非常灵活，可以通过多种方式覆盖。不幸的是，有不止一种方法可以进行覆盖，并且一些技术没有很好的记录。

好消息是以下策略似乎效果很好：覆盖、自定义和子类化管理应用程序，直到一切都开始感到有点痛苦，然后在需要的地方进入你自己的视图。

[我对这个问题](https://stackoverflow.com/questions/495879/django-admin-app-or-roll-my-own/499342#499342)的回答中有一些有用的链接

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T12:47:47.367

简而言之：

根据您的需要尝试管理部分。修改标准视图。如果缺少某些东西，您总是可以开发自己的观点。

对我来说，我无法想象仅基于 django-admin 的整个（比 rolodex 大）应用程序。

一种。

# c - asm/timex.h 和 get_cycles() 去哪儿了？

> ID：676939
> 
> 赞同：2
> 
> 时间：2009-03-24T11:09:09.603
> 
> 标签：c, linux, ubuntu, include, timer

在较旧的 linux 发行版中，我可以在包含 asm/timex.h 之后调用 get_cycle()。现在我换到了 Kubuntu 9.04，没有 asm/timex.h，而且在 sys/timex.h 中也没有 get_cycle()。有谁知道为什么会发生这种变化，如何访问此功能/宏或替换它？或者，更好的是，在哪里可以阅读有关它的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T11:14:53.537

```
/usr/src/linux-headers-2.6.24-23-generic/include/asm$ grep get_cycle *.h
system_32.h：*（或可能访问 TSC 的 get_cycles 或 vread）在定义的
system_64.h：*（或可能访问 TSC 的 get_cycles 或 vread）在定义的
tsc.h:静态内联cycles_t get_cycles(void)
tsc.h:静态内联cycles_t vget_cycles(void)
vmi_time.h: u64 (*get_cycle_frequency)(void);
vmi_time.h: u64 (*get_cycle_counter)(int);

```

因此，请尝试包含 <tsc.h>。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T11:17:09.020

应该在`asm-i386/timex.h`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T02:01:02.110

/usr/src/linux-headers-2.6.28-11/arch/x86/include/asm/tsc.h

# .net - XmlDocument、XmlResolver 和 www.w3.org

> ID：676940
> 
> 赞同：1
> 
> 时间：2009-03-24T11:09:23.063
> 
> 标签：.net, xml-serialization

我的一个用户在打开文件时遇到了一个错误（我使用的是标准 xml 1.0）：

```
The remote name could not be resolved: 'www.w3.org' 
```

我在[StackOverflow](https://stackoverflow.com/questions/217841/net-autogenerated-web-service-client-how-do-i-avoid-requesting-schemas-from-w3o)中找到了一篇处理此问题的帖子，它建议将 XmlResolver 属性设置为 null。我已经尝试过了，我所有的文档似乎仍然可以正常加载。但是，我想要的最后一件事是打破我的应用程序的文件读取机制，那么禁用解析器实际上是否安全？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T16:45:00.130

避免连接到 W3C 站点的另一种方法是使用[`XmlPreloadedResolver`](http://msdn.microsoft.com/en-us/library/system.xml.resolvers.xmlpreloadedresolver.aspx). 它`XmlPreloadedResolver`包含许多“众所周知的”DTD 和嵌入的（AFAIR）模式，只要您的 xml 包含对其中一个的引用，解析器就会为其提供服务，而无需尝试连接任何地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T11:15:02.943

这实际上取决于您是否使用外部参考。您始终可以编写自己的`XmlResolver`，允许它与您拥有的文件一起使用*（*例如，我有一个从 resx 读取已知文件的文件）。

但是最简单的选择就是禁用它……当然，您的单元测试会很快发现任何问题；-p

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-05T15:35:46.270

如果正在解析的 XML 使用了在被引用的 DTD 中定义的实体，那么在禁用外部引用时会遇到问题：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE sample SYSTEM "./sample.dtd">
<root>&text;</root> 
```

其中在`&text;`中定义`sample.dtd`。如果您禁用外部引用，此 XML 将无法加载并出现错误`Reference to undeclared entity 'text'`

另一种情况是，如果您的 XML 包含具有外部定义的实体的内联 DTD：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE dtd_sample[
  <!ENTITY text SYSTEM ".\text.txt">
]>
<root>&text;</root> 
```

在这种情况下，XML 可以正确解析，但`&text;`它是空的，而不是`text.txt`文件的内容。

这两种情况都非常罕见——尤其是第二种情况，所以你应该没问题。

验证通常不是问题：默认情况下`XmlReader`不进行任何验证，因此即使它无法加载相关的 DTD/XSD，这也没有任何区别。

这一切都适用于 .NET 4.0，我没有使用其他版本的框架进行测试。

# jquery - 奇怪的 JQuery 错误

> ID：676942
> 
> 赞同：0
> 
> 时间：2009-03-24T11:12:04.290
> 
> 标签：jquery

尝试将 JQuery 与 JqSOAPClient 插件一起使用时出现以下错误：http: [//plugins.jquery.com/project/jqSOAPClient](http://plugins.jquery.com/project/jqSOAPClient)

> 错误：未捕获的异常：[异常...“组件返回失败代码：0x80070057 (NS_ERROR_ILLEGAL_VALUE) [nsIXMLHttpRequest.open]”nsresult:“0x80070057 (NS_ERROR_ILLEGAL_VALUE)”位置：“JS 框架 :: [http://localhost:1320/jquery -1.3.2.min.js](http://localhost:1320/jquery-1.3.2.min.js) :: 匿名 :: 第 19 行“数据：无]

请指教。

我正在使用 Javascript 调用本地 .net 网络服务：

```
var soapBody = new SOAPObject("FindCountryAsString");
soapBody.ns = "http://localhost:1320";
soapBody.appendChild(new SOAPObject("V4IPAddress")).val(a); 
var sr = new SOAPRequest("http://localhost:1320/Service1.asmx/FindCountryAsString", soapBody);
SOAPClient.SOAPServer = "http://localhost:1320/Service1.asmx/"; 
SOAPClient.SendRequest(sr, processResponse); 
```

此页面和 .net 网络服务都在同一个域（本例中为 localhost）上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:58:00.377

> 组件返回失败代码：0x80070057 (NS_ERROR_ILLEGAL_VALUE) [nsIXMLHttpRequest.open]

这就是当您尝试 XMLHttpRequest.open() 一个由空字符串组成的 URL 时得到的结果。

jqSOAPClient 似乎希望您将 SOAPClient.Proxy 设置为要访问的本地 URL，而不是 .SOAPServer。如果您不设置 SOAPClient.Proxy，它最终会尝试向空字符串发送请求。

(In the code, it's checking for Proxy==null, but if not set Proxy actually defaults to an empty string, not null, so that fails. And anyway even if that worked, it would simply silently fail to do anything if no Proxy is set, which isn't really any more helpful either.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T11:53:20.853

错误代码似乎表明存在阻止请求完成的无效参数。我的怀疑是您传递的参数格式不正确，无法在服务器上反序列化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-29T19:09:07.013

Just throwing an answer in here in case others experiencing a similar 'unknown' XMLHttpRequest.open error on firefox: (this stackoverflow result came up on google). AdBlockPlus may be causing the problem, disabling per domain fixes the issue.

# windows-server-2003 - 智能卡客户端证书未在 Win 2003 x64 服务器上的个人存储中注册

> ID：676943
> 
> 赞同：3
> 
> 时间：2009-03-24T11:12:39.577
> 
> 标签：windows-server-2003, certificate, smartcard

我正在通过 Windows 证书存储从 c# 访问智能卡。这适用于许多系统。然而，在一个系统上，它没有。智能卡证书不会添加到个人证书中。

我们需要它在证书存储中才能从 C# 访问它，如下所示：

```
X509Store store = new X509Store(StoreName.My,
    StoreLocation.CurrentUser);
store.Open(OpenFlags.ReadOnly);
X509Certificate2Collection certs =
    store.Certificates.Find(X509FindType.FindByIssuerName,
    issuerName, false); 
```

系统详情：

*   操作系统：Windows Server 2003 R2 x64 SP2
*   使用的 CSP 是[SafeSign Identity Client v3.0.11](http://www.aeteurope.nl/aet/aet-europe/_www/en/pub/products/safesign.cfm)。
*   该系统通过 Citrix ICA 连接、Citrix Presentation Server 4.5 访问。

什么有效：

*   [通过智能卡读卡器（ OMNIKEY 3121](http://omnikey.aaitg.com/index.php?id=69)）提供的诊断工具访问卡
*   在 Internet Explorer 7 中查看个人证书（工具 > Internet 选项 > 内容 > 证书
*   基本上我们用这张卡尝试过的所有其他事情，除了......

什么不起作用：

*   个人证书不会复制到个人证书存储区（可以使用 certmgr.msc 检查）

我的猜测是通过 Citrix 转发智能卡可以正常工作，因为我们几乎可以通过所有方式访问它，但 CSP 无法正常工作。然而，获得对 CSP 的支持并不容易，因此提出了这个问题。我觉得奇怪的是证书可以通过 IE7 访问，这表明它们在某种 Windows 商店中可用。

欢迎任何关于在哪里进一步研究的想法。是否有像 IE 一样访问智能卡证书的不同方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T09:29:39.920

导致此问题的原因是 SafeSign 身份客户端与 64 位 Windows 不兼容。官方支持将在以后的版本中添加，有人告诉我 2009 年秋季。

# php - 确定 URL 是否是 PHP 中的图像的最佳方法

> ID：676949
> 
> 赞同：59
> 
> 时间：2009-03-24T11:14:30.743
> 
> 标签：php, image, url

使用 PHP，给定一个 URL，我如何确定它是否是图像？

URL 没有上下文 - 它只是在纯文本文件的中间，或者可能只是一个字符串。

我不想要高开销（例如读取 URL 的内容），因为这可能会为页面上的许多 URL 调用。鉴于此限制，识别所有图像并不是必需的，但我希望有一个相当好的猜测。

目前我只是在看文件扩展名，但感觉应该有比这更好的方法。

这是我目前拥有的：

```
 function isImage( $url )
  {
    $pos = strrpos( $url, ".");
    if ($pos === false)
      return false;
    $ext = strtolower(trim(substr( $url, $pos)));
    $imgExts = array(".gif", ".jpg", ".jpeg", ".png", ".tiff", ".tif"); // this is far from complete but that's always going to be the case...
    if ( in_array($ext, $imgExts) )
      return true;
    return false;
  } 
```

**编辑：**如果对其他人有用，这里是使用 Emil H 回答中的技术的最终功能：

```
 function isImage($url)
  {
     $params = array('http' => array(
                  'method' => 'HEAD'
               ));
     $ctx = stream_context_create($params);
     $fp = @fopen($url, 'rb', false, $ctx);
     if (!$fp) 
        return false;  // Problem with url

    $meta = stream_get_meta_data($fp);
    if ($meta === false)
    {
        fclose($fp);
        return false;  // Problem reading data from url
    }

    $wrapper_data = $meta["wrapper_data"];
    if(is_array($wrapper_data)){
      foreach(array_keys($wrapper_data) as $hh){
          if (substr($wrapper_data[$hh], 0, 19) == "Content-Type: image") // strlen("Content-Type: image") == 19 
          {
            fclose($fp);
            return true;
          }
      }
    }

    fclose($fp);
    return false;
  } 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-24T11:15:58.760

您可以使用[HTTP HEAD](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4)请求并检查内容类型。这可能是一个很好的妥协。可以使用[PHP Streams](http://se2.php.net/streams)来完成。Wez Furlong 有一篇[文章](http://netevil.org/blog/2006/nov/http-post-from-php-without-curl)展示了如何使用这种方法发送 post 请求，但它可以很容易地改为发送 HEAD 请求。[您可以使用stream_get_meta_data()](http://se2.php.net/manual/en/function.stream-get-meta-data.php)从 http 响应中检索标头。

当然，这并不是真正的 100%。一些服务器发送不正确的标头。但是，它将处理通过脚本传递图像并且正确的文件扩展名不可用的情况。真正确定的唯一方法是实际检索图像 - 全部或前几个字节，正如 thomasrutter 所建议的那样。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-09-17T10:53:53.460

```
if(is_array(getimagesize($urlImg)))
    echo 'Yes it is an image!'; 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-24T11:19:58.657

有几种不同的方法。

*   通过在文件开头查找一个幻数来嗅探内容。例如，GIF 使用 GIF87 或 GIF89 作为文件的前五个字节（在 ascii 中）。不幸的是，这无法告诉您图像中是否存在错误或图像是否包含恶意内容。以下是各种类型图像文件的一些神奇数字（请随意使用）：

    ```
    "\xff\xd8\xff" => '图像/jpeg',
    "\x89PNG\x0d\x0a\x1a\x0a" => '图像/png',
    "II*\x00" => '图像/tiff',
    "MM\x00*" => '图像/tiff',
    "\x00\x00\x01\x00" => '图像/ico',
    "\x00\x00\x02\x00" => '图像/ico',
    "GIF89a" => '图像/gif',
    "GIF87a" => '图片/gif',
    "BM" => '图像/bmp',

    ```

    像这样嗅探内容可能最适合您的要求；您只需要阅读并下载文件的前几个字节（经过标题）。

*   使用 GD 库加载图像，看看它是否加载没有错误。这可以告诉您图像是否有效，没有错误。不幸的是，这可能不符合您的要求，因为它需要下载完整的图像。

*   如果您真的不想对图像发出 HTTP 请求，那么这将排除嗅探和获取 HTTP 标头。但是，您可以尝试通过链接的上下文来确定某物是否是图像。在 <img 元素中使用 src 属性链接的东西几乎可以肯定是图像（或 XSS 的尝试，但这是另一回事）。这将告诉您某些内容是否旨在作为图像。它不会告诉您图像是否实际可用或有效；您必须至少获取图像 URL 的第一个小部分（标题或幻数）才能找到它。

不幸的是，一个文件可能既是有效图像，又是包含有害内容的 ZIP 文件，这些有害内容可能被有害站点以 Java 形式执行 - 请参阅[GIFAR 漏洞利用](http://hackaday.com/2008/08/04/the-gifar-image-vulnerability/)。您几乎可以肯定地通过将图像加载到像 GD 这样的库中并对其执行一些重要的过滤器来防止此漏洞，例如将其软化或锐化少量（即使用卷积过滤器）并将其保存到新文件*而不*传输任何元数据。

试图仅通过其内容类型来确定某事物是否是图像是非常不可靠的，几乎与检查文件扩展名一样不可靠。当使用 <img 元素加载图像时，浏览器会嗅探魔术字符串。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-07-24T14:48:03.410

除了 Emil H 的回答：

`get_headers()`用于在不下载整个文件的情况下检查 url 的内容类型`getimagesize()`

```
 $url_headers=get_headers($url, 1);

    if(isset($url_headers['Content-Type'])){

        $type=strtolower($url_headers['Content-Type']);

        $valid_image_type=array();
        $valid_image_type['image/png']='';
        $valid_image_type['image/jpg']='';
        $valid_image_type['image/jpeg']='';
        $valid_image_type['image/jpe']='';
        $valid_image_type['image/gif']='';
        $valid_image_type['image/tif']='';
        $valid_image_type['image/tiff']='';
        $valid_image_type['image/svg']='';
        $valid_image_type['image/ico']='';
        $valid_image_type['image/icon']='';
        $valid_image_type['image/x-icon']='';

        if(isset($valid_image_type[$type])){

            //do something

        }
    } 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-05-23T12:51:09.233

编辑：对于具有流行图像扩展名的静态图像。

```
<?php
$imgExts = array("gif", "jpg", "jpeg", "png", "tiff", "tif");
$url ='path/to/image.png';
$urlExt = pathinfo($url, PATHINFO_EXTENSION);
if (in_array($urlExt, $imgExts)) {
    echo 'Yes, '.$url.' is an Image';
}

?> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-07-14T00:28:24.397

类似于某些给定的答案，但逻辑略有不同。

```
$headers = @get_headers($url, 1); // @ to suppress errors. Remove when debugging.
if (isset($headers['Content-Type'])) {
  if (strpos($headers['Content-Type'], 'image/') === FALSE) {
    // Not a regular image (including a 404).
  }
  else {
    // It's an image!
  }
}
else {
  // No 'Content-Type' returned.
} 
```

@ 是一个[错误控制运算符](http://php.net/manual/en/language.operators.errorcontrol.php)。

请注意，我们在条件中使用了“严格”​​运算符`=== FALSE`，因为如果在大海捞针中找到针，则在我们的用例`strpos($headers['Content-Type'], 'image/')`中返回。`0`使用类型转换`==`将错误地解释为`FALSE`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-28T12:06:44.300

我们可以使用 exif_imagetype 来检查图像类型，所以它不允许任何其他内容类型。它只允许图像，我们可以将它们限制为几种图像类型，下面的示例代码显示了如何允许 GIF 图像类型。

```
if (exif_imagetype('image.gif') != IMAGETYPE_GIF) {
    echo 'The picture is not a gif';
} 
```

您可以使用以下图像类型，

```
 IMAGETYPE_GIF
 IMAGETYPE_JPEG
 IMAGETYPE_PNG
 IMAGETYPE_SWF
 IMAGETYPE_PSD
 IMAGETYPE_BMP
 IMAGETYPE_TIFF_II (intel byte order)
 IMAGETYPE_TIFF_MM (motorola byte order)
 IMAGETYPE_JPC
 IMAGETYPE_JP2
 IMAGETYPE_JPX
 IMAGETYPE_JB2
 IMAGETYPE_SWC
 IMAGETYPE_IFF
 IMAGETYPE_WBMP
 IMAGETYPE_XBM
 IMAGETYPE_ICO 
```

更多细节：[链接](http://us3.php.net/manual/en/function.exif-imagetype.php)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2017-01-23T16:59:03.937

**损坏或找不到图像链接的快速解决方案**
我建议您不要使用 getimagesize() 因为它会第一次下载图像然后它会检查图像大小+如果这不会图像那么它会抛出异常所以使用下面的代码

```
if(checkRemoteFile($imgurl))
{
//found url, its mean
echo "this is image";
}

function checkRemoteFile($url)
{
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,$url);
    // don't download content
    curl_setopt($ch, CURLOPT_NOBODY, 1);
    curl_setopt($ch, CURLOPT_FAILONERROR, 1);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    if(curl_exec($ch)!==FALSE)
    {
        return true;
    }
    else
    {
        return false;
    }
} 
```

**注意：** 此当前代码可帮助您识别损坏或未找到的 url 图像这不会帮助您识别图像类型或标题

# php - 在 PHP 中上传图像时删除元数据

> ID：676951
> 
> 赞同：3
> 
> 时间：2009-03-24T11:14:53.987
> 
> 标签：php, file-upload, metadata, vbulletin

我知道的某个站点最近将他们的带宽从每月 2.5 TB 升级到了 3.5 TB。

原因是他们最近超过了 2,5 限制。他们抱怨他们不知道如何降低带宽使用率。

我没有看到他们考虑的一件事是 JPEG 和网站上显示的其他图像（它是一个图像密集的网站）可以包含元数据。照片是在哪里拍的等等。

事实是，这些信息在那个网站上根本不重要。它永远不会被使用。然而，它仍在增加带宽，因为它将每个图像的文件大小从几个字节增加到几千字节。

在一个每月使用超过 2,5 TB 的网站上，剥离其元数据的数千张图像将有助于将带宽使用量减少至少几个 GB，我认为如果不是更多的话。

那么有没有办法在 PHP 中做到这一点？而且，对于已经存在的文件，有人知道一个**好的**自动元数据删除器吗？我知道[JPEG & PNG Stripper](http://www.steelbytes.com/?mid=30)，但这不是很好......虽然可能对初始清洁很有用......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T11:17:28.427

这对 GD 来说是微不足道的：

```
$img = imagecreatefromjpeg("myimg.jpg");
imagejpeg($img, "newimg.jpg", $quality);
imagedestroy($img); 
```

这不会传输 EXIF 数据。虽然不知道它实际上会节省多少带宽，但您可以使用上面的代码来增加图像的压缩率。这将节省*大量*带宽，尽管它可能不会很受欢迎。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T11:22:05.077

我严重怀疑图像元数据是万恶之源。

需要考虑的一些问题：

*   网络服务器是如何配置的？
*   它是否正确发出 http 304 响应？
*   是不是有某种通过 php 脚本手工制作的数据缓存/流式传输来防止所述数据被浏览器缓存？（在这种情况下，应该考虑 url 重写和 http 重定向）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T11:23:47.430

我认为您需要对此进行分析。节省几 GB 可能是对的，但在 2.5TB 的带宽上相对较少。您需要有关服务最多的真实数据并为此努力。如果您确实发现是图像使您的带宽使用率如此之高，您首先应该检查您的缓存标头和 304 响应，您可能还想使用类似 amazon S3 之类的东西来为您的图像提供服务。通过这样做，我已经设法降低了很多带宽成本。

也就是说，如果 EXIF 数据真的有那么大的不同，那么您可以使用 GD 库使用[imagejpeg](http://uk.php.net/imagejpeg)函数复制 jpeg 图像。这不会复制 EXIF 数据。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T12:57:27.097

看看**[Smush.it！](http://smush.it/)**它将从图像中删除所有 un-necs 信息。他们有一个**[API](http://smush.it/faq.php#results-table)**，你可以用它来处理图像。

**注意：** *根据设计*，它***可能会***更改您的文件类型。这是故意的。如果另一种文件类型可以以相同的质量显示相同的图像，并且字节数更少，它将为您提供一个新文件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T11:46:18.827

Emil H 可能是最好的解决这个问题。

但我想补充一点，这几乎肯定不会像你想象的那样为你节省很多。这种类型的元数据占用的空间很小；我会认为

1.  将图像重新压缩为更小的文件大小，以及
2.  裁剪或调整大小以降低图像的分辨率

两者都会产生更大的影响。仅使用第一点，您可能会降低 50% 的带宽，而使用这两种方法，您可能会降低 80% 的带宽 - 也就是说，如果您愿意牺牲一些图像大小。

如果没有，您可以始终使用较小尺寸的默认视图，并带有“放大”链接。大多数人只是浏览会看到较小的图像，只有那些想要最大尺寸的人才会点击放大它，因此您仍然可以获得几乎所有的带宽节省。例如，这就是 Flickr 所做的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-23T00:11:26.700

也许某种十六进制数据操作会在这里有所帮助。我面临同样的问题并正在研究某种自动化解决方案。

只是想知道这是否可以做到，如果可能的话，我会为此编写一个 php 类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-23T00:16:10.340

在客户端进行所有图像处理可能很聪明（使用诸如facebook之类的java小程序），然后当图像被压缩，调整大小并完全去除不必要的像素和内容时，它可以以最佳大小上传，节省带宽和服务器端性能！（以初始开发为代价）

# assembly - 是否有任何语言直接与硬件对话并且不是汇编语言？

> ID：676953
> 
> 赞同：2
> 
> 时间：2009-03-24T11:15:30.617
> 
> 标签：assembly, programming-languages, cpu-architecture, machine-code, machine-language

只是想知道汇编世界是如何工作的，我正在阅读[wiki](http://en.wikipedia.org/wiki/Assembly_language)上的汇编语言，这句话让我印象深刻：

> 它实现了对特定 CPU 架构进行编程所需的数字机器代码和其他常量的符号表示。

我一直认为汇编是基于您的 CPU 的固定语言（基于所述 CPU 具有不同的编译器和语言），因此对于您的 CPU，您只能使用这种类型的汇编与您的硬件对话。

但是基于该引用，可能有其他语言使用其他符号来表示相同的数字机器代码。

那么，是否有任何其他语言可以直接与非汇编硬件对话？还是我弄错了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T11:43:31.437

您*可以*使用一组不同的符号来表示机器代码。但是没有人打扰，因为你不会得到太多。

ARM 有一条指令叫做 ADD。在 ARM 汇编器中，“ADD r0, r0, #1”表示 4 字节的机器码，它们构成了增加寄存器 0 的指令。

无论您如何称呼该指令，您都无法更改可用的指令集并仍将其称为 ARM 汇编程序。无论您将 ADD 操作称为“ADD”、“SUM”、“PLUS”还是“ADDITION”，它本质上仍然是相同的编程语言。如果每个人对所有内容都使用相同的名称，那么使用现有的引用会更容易，所以会发生这种情况。

一个有用的更改可能是将指令表示为“INC r0”，因为 ARM 没有 INC 指令，它是一种常见操作。这导致了汇编语言中的宏。这些确实确实改变了语言，但是一旦您拥有发出多个 ARM 指令的宏，您就会开始失去汇编的所见即所得性质。最终你开始认为也许你还不如只写 C。我是根据经验说话的（它不是 ARM，但它是一个宏化的汇编程序）。

一个常见的区别是大小写——如果你觉得自己很迂腐，你可以争辩说有两种不同版本的 ARM 汇编语言，一种是大写的，一种是小写的（或者争辩说存在一种语言，同一事物有多个符号） . 同一机器代码的不同反汇编程序有时会输出不同的格式。有时这些差异很大，以至于特定的汇编器无法处理所有这些，或者汇编器会提供自己的便利，而这些便利与同一平台上的另一个汇编器不兼容。但实际上，这都是一回事，如果你费心去区分，那通常是因为你被咬了屁股，而不是因为有好事发生……

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T11:20:48.483

您弄错了（或者可能是正确的-很难从您的问题中分辨出来）。汇编语言是用于特定 CP 架构的二进制指令模式的符号（易于人类阅读）表示。偶尔会遇到对“portabe assembler”（Scott Nudds，有人知道吗？）的引用，但这些实际上是更高级别的语言。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T12:25:05.737

[这是来自Clozure Common Lisp](http://www.clozure.com/clozurecl.html)的示例。它允许在 Lisp 中编写内联汇编代码。下面定义了一个用 x86 汇编符号编写的函数 %safe-get-ptr：

```
(defx86lapfunction %safe-get-ptr ((src arg_y) (dest arg_z))
  (check-nargs 2)
  (save-simple-frame)
  (macptr-ptr src imm0)
  (leaq (@ (:^ done) (% fn)) (% ra0))
  (movq (% imm0) (@ (% :rcontext) x8664::tcr.safe-ref-address))
  (movq (@ (% imm0)) (% imm0))
  (jmp done)
  (:tra done)
  (recover-fn-from-rip)
  (movq ($ 0) (@ (% :rcontext) x8664::tcr.safe-ref-address))
  (movq (% imm0) (@ x8664::macptr.address (% dest)))
  (restore-simple-frame)
  (single-value-return)) 
```

它仍然是组装。除此之外，还有许多语言具有从内存或寄存器等设置/读取值的低级结构。

CPU 不执行汇编语言。汇编语言只是特定 CPU 机器代码的一些（或多或少直接的）文本表示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T11:25:40.780

汇编语言与目标系统的硬件架构密切相关。

在很大程度上，从 asm 代码到机器指令存在一对一的映射——这才是真正的重点——因此您可以在单个指令的级别上操作硬件。

它们还允许您以与机器内存架构（单体、分段、虚拟等）相匹配的方式访问和操作内存。

汇编程序差异很大，有些只是将三个字母代码翻译成 4 字节指令，而另一些，如古老的 OS/390 汇编语言本身就是复杂的编程环境。

话虽如此，所有这些最现代的芯片都在模拟古老的指令集，所以无论如何你实际上并没有那么接近线路，而且，更好的 C 编译器知道底层的微架构（比如管道，执行了多少整数指令每个周期等），所以一个好的 C 编译器几乎总是会执行平庸的汇编代码！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-06-10T13:29:16.240

澄清有关 Burroughs B5000 和 B6000 系列机器的一些答案，没有汇编程序，因此没有汇编语言编程。也完全没有链接加载器。单程 Algol 编译器（由 Donald Knuth 编写）直接生成机器代码。硬件参考手册描述了使用汇编程序员可以识别的助记符的指令，但这是我们最接近它的。

您可以要求 Algol 编译器在编译期间将生成的代码与源代码内联打印。

[主控制程序](http://bitsavers.org/pdf/burroughs/B5000_5500_5700/1023579_Narrative_Description_Of_B5500_MCP_Oct66.pdf)的叙述性描述很好地描述了堆栈架构和主要指令。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T11:21:31.630

大量使用与 C 混合的程序集。一些 CPU（如 8052 芯片）带有在 ROM 中刻录的高级语言。这些语言具有允许在低级别与硬件交互的特殊语句。

CPU 系列通常设计为使用相同的机器代码，这意味着相同的汇编语言。一个特定的 CPU 可能有更多的缓存、管道等，但除此之外可以运行与同一系列中的其他 CPU 相同的机器代码。

因此编译到一个 CPU 上的软件将在所有这些 CPU 上运行。最受欢迎的指令集之一是 i386 指令集，它几乎为所有 Windows 机器提供动力。有一个 16 位的前任和一个 64 位的后继。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T12:20:23.627

> ...因此，对于您的 CPU，您只能使用这种类型的程序集与您的硬件通信。

所有语言最终都会转换为在真实硬件上执行的指令，无论是像汇编程序一样直接完成，还是像 C 那样通过高级抽象完成。棘手的一点实际上是让机器指令以如下方式操作硬件：您想要，因为高级语言的一点是使您免受硬件细节的影响。

某些语言（例如 C）旨在直接操作硬件，因此它们包含诸如 volatile 之类的关键字，以防止编译器以其他方式优化对设备寄存器的引用。这些可以被写入而不是读回，以便编译器认为保存的值永远不会再次使用。或者可能需要读取设备寄存器，尽管该值从未使用过。对于诸如启用和禁用普通程序不会产生的中断之类的操作，还有杂项指令。

这可能还需要链接器支持，以便内存位置（用于内存映射 I/O）可以位于设备寄存器的正确地址。然而，一些处理器对 I/O 使用不同的指令，并且必须有一些工具可以将它们插入到代码流中，因此在许多情况下，除非有明确的语言支持，否则可能无法访问 H/W。

最后，对于大多数现代操作系统，如 Windows 和 Linux，应用程序在虚拟内存中运行，其中程序地址与物理地址不匹配，并且程序通常被拒绝访问硬件。当操作系统未授予其特定权限时尝试访问硬件的代码将生成中断，返回操作系统并不再执行。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-24T21:35:56.163

当然，有很多语言直接与非汇编硬件对话。例如，在 Burroughs B5000 上，CPU 使用 ALGOL 的变体进行编程，在 Lisp 机器上，CPU 直接执行 Lisp 代码，在早期的 Smalltalk 工作站上，CPU 直接执行 Smalltalk 字节码。研究人员已经基于直接执行 Lambda 演算的图形缩减引擎构建了 CPU。构建 Java 处理器的公司不止一家，它们当然是用 JVM 字节码编程的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-08-25T02:48:48.040

是的，它叫 FORTH，只要你把硬件看成是虚拟的！FORTH 堆栈机器的原始寄存器操作的机器代码是 FORTH。但如果你模拟这个硬件，也许它很重要？看看[http://www.greenarraychips.com/](http://www.greenarraychips.com/)了解 Leo Brodie 1984 年“Thinking Forth”中的前沿和经典，它可能对您有所帮助……即使您从未使用过 Forth。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-24T17:29:54.693

你的问题是：

***那么，是否有任何其他语言可以直接与非汇编硬件对话？还是我弄错了？***

我很惊讶没有人提到[Register Transfer Language](http://en.wikipedia.org/wiki/Register_transfer_language "注册转移语言")或任何硬件描述语言，例如[Verilog](http://en.wikipedia.org/wiki/Verilog "Verilog")或[VHDL](http://en.wikipedia.org/wiki/VHDL "高密度脂蛋白")。

*RTL本身*不是一种编程语言，通常是硬件中立的（汇编绝对不是中立的，它针对特定的架构）。

VHDL 和 Verilog 最常用于可编程逻辑，我认为这可以称为“直接与硬件对话”。软核通常以可编程逻辑实现，因此您可以使用其中之一来实现（例如）ARM 处理器，该处理器本身可以在汇编中进行编程......

有趣的东西……让我希望我能回去重新做我所有的 EE/CE 工作……

# geometry - 如何确定多边形旋转角度

> ID：676959
> 
> 赞同：2
> 
> 时间：2009-03-24T11:16:24.577
> 
> 标签：geometry, rotation, polygon, angle

我正在编写一个程序（.net）来创建体育场风格的布局，并且需要确定每个多边形相对于水平面的旋转角度。

这样我就可以构建多边形的内容并正确旋转它以适应内部。

以下图为例来模拟面对方向的每个变体（由红线表示），我如何确定使形状在顶部有红线所需的旋转角度，如形状 5 所示。

[http://i40.tinypic.com/16ifhoo.gif](http://i40.tinypic.com/16ifhoo.gif "多边形") [![替代文字](https://i.stack.imgur.com/glV3I.gif)](https://i.stack.imgur.com/glV3I.gif)

我找到了确定构成红线的点的角度的逻辑，但我还需要知道旋转以使其恢复水平。

我不确定我是否需要所有多边形的中心参考点来提供帮助。

我怎样才能最好地解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T11:30:39.910

我会尝试计算每条红线上的法线向量（例如，多边形 5 为 0 度，多边形 4 为 45 度，3 为 90 度等），然后计算您需要旋转该法线的角度 - 从而匹配多边形- 这样正常的“点数”应该很简单。

不幸的是，我没有为你提供所需的公式，但我认为谷歌搜索“法线向量”和/或在维基百科上搜索它应该让你开始就好了。可能朝着所谓的“交叉产品”的方向发展。

为此，不需要所有多边形的中心参考点（法线方向与绝对坐标无关）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T11:33:08.327

*如果您知道某个多边形（例如 a* ）的红线角度，则该多边形位于该线的一侧或另一侧。所以：

*   使用两侧线附近的一些像素的平均颜色来确定是哪种情况。
    *   如果多边形在线上方，则旋转角度为 180+ *a*。
    *   如果多边形低于该线，则旋转*为*.

根据您测量*a 的*方式，上方和下方对应于线的较小角度侧和较大角度侧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T11:37:57.363

sin、cos、tan 函数允许您将三角形边比转换为度数。

想象一下，红线的一端在 (x1,y1)，另一端在 (x2,y2)。您可以将红线视为矩形三角形的 hipotenuse 并使用 arctan 来获得度数。

导管之间的比率为 (x2-x1) / (y2 - y1)。然后红线的旋转是 arctan((x2-x1) / (y2 - y1))。注意 y1-y1 为 0 的情况！

让我们从您的图片中尝试一个示例，多边形 6，坐标为 (55, 65) 和 (65, 55)。输入谷歌：“arctan((65-55)/(55-65)) 度数”

# java - 当今最先进的图像压缩（不在浏览器上）？

> ID：676960
> 
> 赞同：2
> 
> 时间：2009-03-24T11:16:35.183
> 
> 标签：java, image, image-processing, compression

我正在用 Java 编写一个应用程序来查看包含大量文本和图形的图像，例如网页的屏幕截图，实际上它是杂志文章的图像。有些部分是文本，有些部分是图形。

我的客户端程序是用 Java 编写的，我可以使用任何图像格式，我可以在 Java 中使用的最佳图像压缩格式是什么？所以我可以压缩和解压缩？

如果图像在加载时变得清晰会很好，但这不是必需的，它不再是 1997 年（记住 gif 加载）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T11:23:59.020

您还没有提供一条关键信息：压缩需要是无损的还是有损的？如果有损在什么容忍范围内很好？

如果您准备好使用高度有损的压缩格式，则可以将整个图像缩减为单个信息。:-)

说真的，两种主要的无损格式是 GIF 和 PNG（在浏览器中和浏览器之外），而最大的（迄今为止）有损格式是 JPG。BMP 和 TIF 等其他格式远没有那么高效。

所有这三种格式都在 Java 中得到了很好的支持（直接或通过现成的第三方库）。PNG 往往比 GIF 具有更好的压缩率。

看：

*   [PNG 与 GIF 压缩](http://warp.povusers.org/grrr/PNGvsGIF/)
*   [GIF vs. PNG](http://www.puidokas.com/gif-vs-png/)：这个参考（并测量了[PNGpong 格式](http://www.apple.com/downloads/dashboard/developer/pngpong.html)；

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T12:23:20.920

DjVu ( [http://djvu.org/](http://djvu.org/) ) 可能是压缩/存储面向文本的图像的最智能格式之一。它实际上将文本存储为文本并为背景添加图像。这意味着您可以部分地将文档视为文本（全文搜索、文本的复制/粘贴……）。查看部分可能在 Java 中得到了很好的支持。

最大的问题是缺乏对文档编码的良好免费支持。有一些可用的开源工具，但上次我检查它们都不是非常用户友好，也不是对开发人员非常友好。有非常好的商业工具，但相当昂贵。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T12:36:48.190

对于有损压缩，您可能还需要考虑[Jpeg 2000](http://www.jpeg.org/jpeg2000/)。它比标准 JPEG 压缩效率高得多，尤其是在质量非常低的设置下，它被相对广泛地采用，并且已经有大量的编码/解码库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T12:09:49.377

除了 cletus 的积分

有诸如 pngout、pngcrush 和 optipng 之类的工具仍然可以压缩图像

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T13:41:26.037

对于我正在做的任何互联网图像工作，我更喜欢 PNG，因为 GIF 的调色板有限，而 JPG 不处理透明度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-02T11:45:22.030

DLI 图像压缩是目前最好的。这不是一个标准。但是玩起来还是很开心的。

[https://sites.google.com/site/dlimagecomp/](https://sites.google.com/site/dlimagecomp/)

看看 'http://www.jpegmini.com/main/home' 。使用这些“http://www.maximumcompression.com/data/jpg.php”之一重新压缩 jpg 文件 可以使用噪声过滤器来进一步提高信噪比。'http://compression.ru/video/deblocking/index_en.html'

这只是为了研究目的，我想不出如何在java中实现它。

# windows - Windows XP 引导加载程序 (NTLDR) 是否注意内核导入声明？

> ID：676969
> 
> 赞同：2
> 
> 时间：2009-03-24T11:18:23.620
> 
> 标签：windows, kernel, windows-xp, bootloader, portable-executable

我想知道 Windows XP 引导加载程序 ( `ntldr`) 是否真的使用了 Windows 内核 ( `ntoskrnl.exe`) 导入声明？

`ntoskrnl.exe`具有以下导入模块`BOOTVID.dll`：`HAL.dll`和`KDCOM.dll`. 所以这三个模块是最先被加载的。想象一下内核有另一个模块被声明为导入的。这会导致`ntldr`也加载它吗？还是`ntldr`只知道它应该加载这四个模块而没有办法改变它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:49:32.830

我建议在[ntdev](http://www.osronline.com/cf.cfm?PageURL=showlists.CFM?list=NTDEV)邮件列表中问这个问题。要得到回答，您最好解释为什么需要此信息以及您要做什么。我可以保证，在此列表中，您会找到能够回答此问题的人，但不能保证您会得到回答。他们对“黑客气味”有点敏感。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T10:16:40.983

发生了，我自己找到了答案。并在[ntdev](http://www.osronline.com/cf.cfm?PageURL=showlists.CFM?list=NTDEV)邮件列表中确认。

`ntldr`确实只加载了问题中提到的四个文件，并且不使用任何导入声明。

您实际上可以通过创建一个存根内核（从实际内核中导入一些内容）并使用以下`boot.ini`选项（您将获得文件中已加载模块的列表）来检查这一点`%SystemRoot%\ntbtlog.txt`：

```
/bootlog /kernel=stubkrnl.exe 
```

# php - MYSQL 错误

> ID：676976
> 
> 赞同：0
> 
> 时间：2009-03-24T11:19:59.577
> 
> 标签：php, mysql

忍受我，我对这一切有点陌生，

我在我的 PHP 脚本中运行了这个查询：

```
$insertQuery = "INSERT INTO blog_articles 
     VALUES '$title', $tags', '$category', '$blog', '$author', '$date'"; 
```

然后我运行这个脚本：

```
 if ($result = $connector->query($insertQuery)){
    // It worked, give confirmation
    echo '<center><b>Article added to the database</b></center><br>';
}else{
    // It hasn't worked so stop. Better error handling code would be good here!
    die (mysql_error());
}
} 
```

我收到此错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在第 2 行的“Title Number 1, General, Blogging, Kayaking, General, Tgis is blog number spelli”附近使用

但我不知道错误是什么，它看起来很好，所以如果有人可以帮助我，那将是非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T11:21:22.803

您在 $tags 之前缺少一个单引号。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T11:21:50.257

您的查询应该更像这样

```
INSERT INTO blog_articles (`title`, `tags`, `category`, `blog`, `author`, `date`)
VALUES ('$title', '$tags', '$category', '$blog', '$author', '$date') 
```

您还应该考虑清理您的查询。也许这样（但我不知道你的确切设置，所以结果可能会有所不同）

```
$sql = sprintf("INSERT INTO blog_articles (`title`, `tags`, `category`, 
    `blog`, `author`, `date`) VALUES ('%s', '%s', '%s', '%s', '%s', '%s')",
mysql_real_escape_string($title), mysql_real_escape_string($tags), 
mysql_real_escape_string($category),  mysql_real_escape_string($blog), 
mysql_real_escape_string($author),  mysql_real_escape_string($date)); 
```

这使用了[`sprintf()`](http://is.php.net/manual/en/function.sprintf.php)函数，php 文档中有一些很好的例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T11:24:29.847

您需要添加要插入的字段的名称

```
INSERT INTO blog_articles ('title', 'tags', 'category', 'blog', 'author', 'date') VALUES ('$title', '$tags', '$category', '$blog', '$author', '$date') 
```

此外，您应该添加一些代码来转义文本中可能破坏 SQL 查询的双引号或单引号。

使用 PHP 函数 mysql_real_escape_string()

mysql_real_escape_string() 调用 MySQL 的库函数 mysql_real_escape_string，该函数在以下字符前添加反斜杠：\x00、\n、\r、\、'、" 和 \x1a。

更多详情： [http ://uk.php.net/mysql_real_escape_string](http://uk.php.net/mysql_real_escape_string)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T12:26:48.590

正如 aknock 所说，您在 $tags 之前缺少一个 '。

但是，您确实需要使用它`mysql_escape_string`来防止[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)攻击。使用`mysql_escape_string`SQL 查询参数是一个好习惯。

使用像[PEAR](http://pear.php.net/package/DB)这样的 DB 包装器可以使转义参数变得不那么痛苦。你上面的代码可以这样写：

```
$insertQuery = "INSERT INTO blog_articles \
                  (`title`, `tags`, `category`, `blog`, `author`, `date`) \
                  VALUES (?, ?, ?, ?, ?, ?)";

$data = array($title, $tags, $category, $blog, $author, $date);

if ($result = $connector->query($insertQuery, $data)) {
    // It worked, give confirmation
    echo '<center><b>Article added to the database</b></center><br>';
}else{
    // It hasn't worked so stop. Better error handling code would be good here!
    die (mysql_error());
} 
```

（假设`$connector`是一个 PEAR DB 对象）

显式地给出您要插入的列的名称和顺序可以使您的代码更易于维护和阅读。如果您稍后更改数据库架构，您将不会将值插入错误的列或不再存在的列中。

# xml - 向 XML 根节点添加前缀 - Scott Hanselman 建议的实现？

> ID：676982
> 
> 赞同：2
> 
> 时间：2009-03-24T11:21:05.547
> 
> 标签：xml, web-services, xml-serialization, soap-extension

我想为 XML 根节点添加一个命名空间前缀，我找到了 Scott Hanselman 的一个条目，其中详细说明了我想要实现的目标。唯一的问题是缺少实施！

[修改 SOAP Web 服务响应主体的根节点的命名空间 PREFIX....哇！](http://www.hanselman.com/blog/XmlRootForcePrefixPrefixfoo.aspx)

如果我能得到一些关于如何解决这个问题的线索，那将是非常有帮助的。

1.  是否有某个地方已经存在的实现？

2.  Scott 的条目发布于 2003 年。从那以后情况发生了变化吗？随着 .NET 3.5 的出现，Soap Extensions 仍然是正确的方法吗？

编辑：当前的 Web 服务响应类似于...

```
<response>
   <my-ns:name/>
</response> 
```

所需的响应应该看起来像......

```
<my-ns:response>
   <my-ns:name/>
</my-ns:response> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T07:19:49.230

似乎根节点缺少命名空间前缀的问题仅存在于 .NET Framework 1.1 上！

我将代码迁移到 .NET 3.5，并将**“my-ns:”**命名空间前缀添加到根节点，而无需修改任何代码！所以我毕竟不必写一个肥皂扩展！

# c# - 将多个配置文件添加到应用程序

> ID：676994
> 
> 赞同：1
> 
> 时间：2009-03-24T11:24:23.840
> 
> 标签：c#, c#-2.0

嗨，我需要在我的应用程序中添加多个配置文件。从这些文件中读取键值的最简单方法是什么？目前我正在使用 xmldocument 类并使用 xpath 表达式选择节点。在 C# 2.0 中有没有其他简单的方法可以做到这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T13:43:34.053

我有类似的需求，发现这非常有用且简单。 [http://www.codeproject.com/KB/cs/cs_ini.aspx](http://www.codeproject.com/KB/cs/cs_ini.aspx) 它是一个 INI 文件读写器，您只需指定标题标签和项目名称，它就会从文件中读取或写入。它为您提供字符串，您可以使用一些 try 块来转换它们。

如果您的配置选项少于 50 个并且它们没有嵌套，那么 INI 确实是一种比 XML 简单得多的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T13:27:54.183

一个 hacky 解决方案是将所有配置文件读入内存文档中的一个，然后使用 xpath 选择正确的节点。

您已将此标记为 c# 2.0，您可以访问 LINQ to XML 吗？这可以使您的查询更加整洁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T13:35:17.583

执行此操作的一个好方法是编写一个类，为您提供所需的信息并通过 XmlSerializer 类序列化对象。要加载配置信息，您可以通过 XmlSerializer 类将生成的 Xml 反序列化回实例。

# .net - Object Relational Mappers in .NET and stored procedure usage

> ID：676997
> 
> 赞同：3
> 
> 时间：2009-03-24T11:25:14.663
> 
> 标签：.net, linq, stored-procedures, orm

Given that they generate the `Create`, `Read`, `Update`, and `Delete` (CRUD) functionality for you in most cases, does this imply that stored procedures won’t be used as often? If these methods use `LINQ` then that means no stored procedures are used, correct?

Any clarification is greatly appreciated.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T11:34:19.900

Most ORMs (including LINQ-to-SQL and EF) will offer you the choice of either automated CRUD or stored procedures.

For example, while I'm happy to let the ORM deal with simple homogeneous CRUD issues (inserting simple records, etc), if I have a critical search method that spans complex data in non-trivial ways, I might choose to use a UDF (or SP) to ensure I can profile it, tune it, etc properly.

In some scenarios, there are security/audit issues that prevent direct CRUD, but in most cases involving an app-server, it is an artificial concern: if a hacker already breached your app-server, you already have major problems - and if they know the schema they can often use the SPs to do just as much damage.

If you are using the same backend from multiple applications on different technologies, then SPs are also useful.

Many of the original performance debates around SP vs text commands are now largely moot; a correctly parameterized text query can use the query-cache, and is injection safe, etc.

# database - 如何在需要密码的网络驱动器上连接 MS 访问链接服务器

> ID：676999
> 
> 赞同：0
> 
> 时间：2009-03-24T11:25:37.177
> 
> 标签：database, sql-server-2005, ms-access

我正在尝试将 MS 访问 mdb 链接到我的 sql server 2005，问题是 MDB 位于需要登录名/密码的共享网络驱动器上。

如何将用户名和密码传递到“链接服务器访问 MDB”模板中？我假设我必须@datsrc 参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T12:10:24.527

与嵌入凭据相比，使用现有的 NT 身份验证并在有权访问网络驱动器的帐户下运行 SQL Server 服务似乎更明智。有关服务帐户设置的一些有用提示，请参阅[问题 63749](https://stackoverflow.com/questions/63749/)。因此，要么授予当前 SQL Server 帐户访问网络驱动器的权限，要么在具有访问权限的不同（可能是新的）帐户下运行服务。*********