# StackOverflow 问答 11959000-11959999

# ruby-on-rails-3 - Rails 脚本未更新所有 mongoid 文档

> ID：11959000
> 
> 赞同：1
> 
> 时间：2012-08-14T19:00:30.533
> 
> 标签：ruby-on-rails-3, migration, mongoid

目前，我有一个 User 对象，它有一个 field `realname`。我正在尝试拆分空间并将其转换为两个字段，`first_name`并且`last_name`. 下面是我为此编写的脚本：

```
User.all.each do |user| 
  puts "Updating #{user.realname}"
  name = user.realname.split(' ')

  user.first_name = name[0]
  user.last_name = name[1]

  user.save
  puts "Saved #{user.first_name} #{user.last_name}"
  sleep(1)
end 
```

当我在我的开发环境中使用 rails runner 运行它时，许多前半部分用户没有得到更新。虽然脚本的输出很完美，但当我查看 mongo 中保存的内容时，有些用户没有这些新字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T02:26:15.353

你确定这些用户是有效的吗？

尝试使用`user.save!`而不是`user.save`.

如果你想保存它，那么你可以通过调用绕过验证：

```
user.save(validate: false) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:05:47.050

尝试在您的 User 类上查找更改的 default_scope。

如果默认范围已更改，则 User#All 将不意味着“数据库上可用的所有对象”。

# wif - WIF 1.0 到 WIF 4.5 的迁移

> ID：11959003
> 
> 赞同：4
> 
> 时间：2012-08-14T19:00:35.967
> 
> 标签：wif

据我所知，在 WIF 1.0 中，Windows Identity 直接派生自 IIdentity。在 WIF 4.5 中，Windows 标识派生自实现 IIdentity 的 ClaimsIdentity。

这对迁移我的 WIF 1.0 应用程序有何影响？

一切都向后兼容还是有任何问题？

我可以在我的开发机器上同时拥有这两个库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-09T22:15:06.553

存在重大更改，有关详细信息，请参阅将[使用 WIF 3.5 构建的应用程序迁移到 WIF 4.5](http://msdn.microsoft.com/en-us/library/jj157089.aspx)的指南。

# java - HSQLDB 可以处理几百万行吗？

> ID：11959008
> 
> 赞同：3
> 
> 时间：2012-08-14T19:00:58.333
> 
> 标签：java, database, hsqldb

我正在开发一个需要数据库的单一用户应用程序。大多数表都会有合理数量的数据，但也有一些可能会增长到几百万行。我的查询都不会返回大型结果集。

任何人都知道 HSQLDB 是否可以处理如此大量的行？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-21T20:03:53.783

从[官方 HSQLDB 页面](http://www.hsqldb.org/)：

> 8 月发布的最新版本 2.2.9，在单个数据库中支持多达 2700 亿行数据。

也就是说，这完全取决于您如何配置服务器，因为默认情况下它使用不适合标准堆内存的内存表，因此您必须使用缓存表。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T16:00:35.843

HSQLDB 可以处理数百万行。您可以尝试一些可以创建大型数据库的测试类。例如：

[http://hsqldb.org/web/hsqlPerformanceTests.html](http://hsqldb.org/web/hsqlPerformanceTests.html)

或在这里： [https ://sourceforge.net/p/hsqldb/svn/HEAD/tree/base/trunk/src/org/hsqldb/test/](https://sourceforge.net/p/hsqldb/svn/HEAD/tree/base/trunk/src/org/hsqldb/test/)

检查 TestCacheSize 和 TestStressInsert 类。

您应该使用内置的备份功能并定期备份数据库。

# plugins - 无法让 Google Analytics 插件与 PhoneGap 2.0 一起使用

> ID：11959009
> 
> 赞同：1
> 
> 时间：2012-08-14T19:00:58.687
> 
> 标签：plugins, cordova, google-analytics, cordova-2.0.0

我使用 PhoneGap 1.9 已经有一段时间了，并且成功地使用了[Google Analytics Plugin](https://github.com/phonegap/phonegap-plugins/tree/master/iOS/GoogleAnalytics)。

我最近升级到 PG 2.0（以便我可以使用新的 Urban Airship 插件），现在我的 Google Analytics 似乎已经停止运行。

不幸的是，我认为这与通过 JavaScript 初始化插件有关。经过一番挫折后，我终于可以编译我的应用程序了。但是，在我的 JavaScript 中初始化 Google Analytics 插件*后*，我的应用程序几乎停止响应。

我希望我能给你们一些错误消息或其他东西，但我没有收到编译器错误，也没有收到 JavaScript 错误。当我使用以下两行时，该应用程序没有响应：

```
g_objGoogleAnalytics = window.plugins.googleAnalyticsPlugin;
g_objGoogleAnalytics.startTrackerWithAccountID("UA-XXXXXXXX-X"); 
```

如果我将这两行注释掉，应用程序中的其他所有内容都会像魅力一样发挥作用。

有没有人让谷歌分析插件在 PG 2.0 下工作？如果是这样，任何建议或步骤将不胜感激。

**更新：**我使用 try/catch 添加了一些错误检查，当我执行上述两行代码时，控制台日志现在显示“未定义不是对象”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T20:41:27.657

我自己找到了答案。github 上的 kieranshaw 将 JS 文件中的关键字“PhoneGap”更改为“codova”，这似乎混合了问题。您可以在此处查看更改：[https ://github.com/kieranshaw/phonegap-plugins/commit/cc4424410869912ff278de0228a6c328b1296fbe](https://github.com/kieranshaw/phonegap-plugins/commit/cc4424410869912ff278de0228a6c328b1296fbe)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T04:58:33.807

这是一种在没有插件的情况下在 PG 上实现 GA 的方法，尽管解决方案中指出了一些限制：[How to use Google Analytics with Phonegap without a plugin?](https://stackoverflow.com/questions/11026916/how-to-use-google-analytics-with-phonegap-without-a-plugin)

# javascript - 如何将对象引用传递给 mootools 中另一个对象的构造函数？

> ID：11959012
> 
> 赞同：1
> 
> 时间：2012-08-14T19:01:04.927
> 
> 标签：javascript, mootools

我已经环顾了这里，几乎所有我能想到的其他地方，但我找不到解决我的问题的方法，所以这里是：

在我当前的项目中，我有一个类实例化一个对象作为其构造函数的一部分，将自身传递进来，因此子对象将具有对其父对象的引用。无论如何，理想情况下。然而，最终发生的是子对象获得了父对象的静态视图。这是我的意思的一个例子：

```
var myParentClass = new Class({
    name: '',
    child: null,

    initialize: function(){
        this.name = 'fred';
        this.child = new myChildClass({ parent: this });
        this.name = 'george';
        this.setFeedback('feedback1');
        this.child.setFeedback('feedback2');
    },

    setFeedback: function(id){
        $(id).set('html',this.name);    
    }

    });

var myChildClass = new Class({

    Implements: [Options],

    options: {
        parent: null,
    },

    initialize: function(options){
      this.setOptions(options);   
    },

    setFeedback: function(id){
        this.options.parent.setFeedback(id);       
    }
});

var a = new myParentClass(); 
```

​在这个例子中，feedback1 的内容是 'george'，我们希望 feedback2 的内容是一样的。然而，事实并非如此。它是“fred”，因为它具有父对象的静态视图，其名称属性在对象作为参数传入之后发生更改。为了您的进一步享受，我制作了一个[jsfiddle](http://jsfiddle.net/the_zenith/YGHPQ/5/%20%27jsfiddle%27)来说明这一点。

所以问题是这样的：有什么方法可以让子对象对其父对象有真正的实际引用，还是我注定只能拥有静态视图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:26:04.100

这是因为该`setOptions`方法通过 Object.merge 将属性取消引用到一个新对象中，将它们克隆到子实例的本地原型中。

[https://github.com/mootools/mootools-core/blob/master/Source/Class/Class.Extras.js#L110](https://github.com/mootools/mootools-core/blob/master/Source/Class/Class.Extras.js#L110)

更改构造函数以接受另一个参数 parent 和 statically store `this.parent = parent`，然后从中调用。

顺便说一句，不要使用`.parent`，因为这是在 mootools 中扩展类时保留的 :)

# php - 使用 PHP 屏蔽 URL

> ID：11959013
> 
> 赞同：0
> 
> 时间：2012-08-14T19:01:06.570
> 
> 标签：php, url, masking, url-masking

有什么方法可以用 PHP 或其他方式屏蔽 URL？我想使用带有 goo.gl 的自定义域，基本上我希望能够将某人发送到[http://l.bearce.me/iS7tz](http://l.bearce.me/iS7tz)并让他们自动重定向到[http://goo.gl/iS7tz](http://goo.gl/iS7tz)。

我发誓我以前见过这样的东西，但我不记得它的名字了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:03:33.500

你是这个意思？（URL 隐藏，带有 onclick 事件的纯 HTML）

```
<a href="http://google.com" onclick="window.location='http://yahoo.com';return false;">Google</a> 
```

或这个？（HTTP 重定向）

```
<?php
// get $path form the url (I suppose you're using mod_rewrite or similar)
$path =  $_GET['some_url_var'];

header("location: http://goo.gl/$path"); // redirect
?> 
```

# jquery - 单击jQuery时向左水平滚动+ 50px

> ID：11959019
> 
> 赞同：3
> 
> 时间：2012-08-14T19:01:18.013
> 
> 标签：jquery, scroll

我正在尝试使用jQuery使左箭头和右箭头在单击时左右滚动+ 50px，但它似乎只是将页面重置为向左滚动0。

这是我的 HTML：

```
<div id="parallax">
    <a href="#" id="test"></a>
</div> 
```

这是我的脚本：

```
$(document).ready(function(){
    $("#test").click(function(){
        $("#parallax").scrollLeft(5000);
    });
}); 
```

任何帮助或见解将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:09:51.223

您需要阻止`<a>`元素的默认操作，因为 a`href="#"`将始终滚动到顶部：

```
$(document).ready(function(){
    $("#test").click(function(e){
        e.preventDefault();
        $('body').scrollLeft(5000);
    });
});​ 
```

[**小提琴**](http://jsfiddle.net/r577s/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:16:32.283

正如所承诺的，这是我编写的演示。这是一个粗略的草案，可以使用一些清洁。我还删除了一些与公司相关的东西，可能会有一两种风格引用它们，但除此之外它应该做你想做的事。

注意：这个演示是为 Chrome 设计的（样式包括只有 chrome 属性的 CSS3 效果 - 我写得很快，并不是为了兼容性而写的 - 随意更改和删除/添加任何必要的样式以使其在其他浏览器中兼容）

Text Slider Demo body { background-color: rgb(252,252,252); }

```
 .demo {
        font-size: 16px;
        border: 2px solid rgb(200,200,200);
        display: inline-block;
        padding: 15px;
        border-radius: 10px;
        margin: 0px 0px 20px 30px;
    }

    .demo-inner-wrapper {
        width: 200px;
        overflow: hidden;
        border-radius: 5px;
    }

    .demo-outer-wrapper {
        border: 2px solid rgb(200,200,200);
        border-radius: 5px;
        padding: 4px;
        width: 200px;
        overflow: hidden;
        margin: 4px;
    }

    .demo-entry-title {
        white-space: nowrap;
    }

    .arrow {
        display: inline-block;
        margin: 4px;
        border-radius: 5px;
        border: 2px solid rgb(55,190,235);
        background-color: rgb(240,240,240);
        padding: 4px;
        width: 40px;
        text-align: center;
        color: rgb(30,180,230);
        font-weight: bold;
        cursor: pointer;
    }

    .demo-hover {
        background-color: rgb(0,35,100);
        color: rgb(252,252,252);
    }

    .content {
        padding: 8px;
        width: 640px;
        border: 2px solid rgb(200,200,200);
        border-radius: 10px;
    }

    .demo-information {
        font: 16px arial, helvetica, sans-serif;
    }

    .header {
        font-size: 24px;
        font-weight: bold;
        color: rgb(0,35,100);
    }

    .section-header {
        color: rgb(25,100,190);
        font-size: 18px;
        font-weight: bold;
        margin-left: 4px;
    }

    .demo-information p {
        margin-left: 4px;
    }

    .demo-header {
        font: 18px arial, helvetica, sans-serif;
        font-weight: bold;
        color: rgb(0,35,100);
    }  

    .demo-content {
        margin-left: 8px;
        margin-top: 8px;   
    }      
</style>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        var $left = $(".left-arrow");
        var $right = $(".right-arrow");
        var $et = $(".demo-entry-title");
        var $demoWrap = $(".demo-inner-wrapper");

        $left.mouseenter(function () {
            $(this).addClass("demo-hover");
            var width = $et.width();
            var marginStr = $et.css("margin-left");
            var margin = parseInt(marginStr.substring(0, marginStr.length - 2));
            console.log(margin, marginStr);
            var scrollTo = $demoWrap.width() - width;
            if (scrollTo < 0) {
                $et.animate({ "margin-left": scrollTo }, (margin - scrollTo) * 10);
                console.log(width, margin, scrollTo, (margin - scrollTo) * 10);
            }
        }).mouseleave(function () {
            $et.stop();
            $(this).removeClass("demo-hover");
        });

        $right.mouseenter(function () {
            $(this).addClass("demo-hover");
            var width = $et.width();
            var marginStr = $et.css("margin-left");
            var margin = parseInt(marginStr.substring(0, marginStr.length - 2));
            console.log(margin, marginStr);
            var scrollTo = $demoWrap.width() - width;
            if (scrollTo < 0) {
                $et.animate({ "margin-left": 0 }, -margin * 10);
                console.log(width, margin, scrollTo, -margin * 10);
            }
        }).mouseleave(function () {
            $et.stop();
            $(this).removeClass("demo-hover");
        });
    });
</script>
</head>
<body>
    <div class="content">
        <div class="demo-information">
            <div class="header">
                Text Slide Demo</div>
            <br />
            <div class="section-header">
                Overview</div>
            <p>
                The demo below is intended to illustrate the use of jQuery and CSS to create a slide
                effect text that is too long for its specified width, rather than wrapping the text
                onto multiple lines. The scripting involved is very light weight, and can easily
                be wrapped up into a jQuery plugin.
            </p>
        </div>
        <br />
        <div class="demo">
            <div class="demo-header">
                Demo:</div>
            <div class="demo-content">
                <div class="demo-outer-wrapper">
                    <div class="demo-inner-wrapper">
                        <span class="demo-entry-title">This is an entry title that is too long for the section,
                            and here is me giving it even more length.</span>
                    </div>
                </div>
                <div class="demo-buttons">
                    <span class="arrow left-arrow">Left</span><span class="arrow right-arrow">Right</span>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 
```

很抱歉格式问题。我刚刚修好了:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-31T08:29:04.577

请找到以下链接。我希望它有助于解决这个问题。

```
$('.left').click(function(){

  $('#container').scrollLeft(0);
}); 
var bb=0;
$('.right').click(function(){
bb++;
    $('#container').scrollLeft(bb*50);

}); 
```

**解决方案：** [Jsfiddle 链接](https://jsfiddle.net/balasamik/79fub1f3/34/)

# r - 使用 R 提取多条推文中的主题标签

> ID：11959023
> 
> 赞同：4
> 
> 时间：2012-08-14T19:01:25.740
> 
> 标签：r

我非常想要一个从 R 中的集体推文中提取主题标签的解决方案。例如：

```
[[1]]
[1] "RddzAlejandra: RT @NiallOfficial: What a day for @johnJoeNevin ! Sooo proud t have been there to see him at #London2012 and here in mgar #MullingarShuffle"

[[2]]
[1] "BPOInsight: RT @atos: Atos completes delivery of key IT systems for London 2012 Olympic Games http://t.co/Modkyo2R #london2012"

[[3]]
[1] "BloombergWest: The #Olympics sets a ratings record for #NBC, with 219M viewers tuning in. http://t.co/scGzIXBp #london2012 #tech" 
```

如何解析它以提取所有推文中的主题标签词列表。以前的解决方案仅在第一条推文中显示主题标签，并在代码中显示以下错误消息：

```
> string <-"MonicaSarkar: RT @saultracey: Sun kissed #olmpicrings at #towerbridge #london2012   @ Tower Bridge http://t.co/wgIutHUl"
> 
> [[2]]
Error: unexpected '[[' in "[["
> [1] "ccrews467: RT @BBCNews: England manager Roy Hodgson calls #London2012 a \"wake-up call\": footballers and fans should emulate spirit of #Olympics http://t.co/wLD2VA1K" 
Error: unexpected '[' in "["
> hashtag.regex <- perl("(?<=^|\\s)#\\S+")
> hashtags <- str_extract_all(string, hashtag.regex)
> print(hashtags)
[[1]]
[1] "#olmpicrings" "#towerbridge" "#london2012" 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-14T20:45:15.810

使用`regmatches`and`gregexpr`这会为您提供每条推文的主题标签列表，假设 hastag 的格式为 # 后跟任意数量的字母或数字（我对 twitter 不太熟悉）：

```
foo <- c("RddzAlejandra: RT @NiallOfficial: What a day for @johnJoeNevin ! Sooo proud t have been there to see him at #London2012 and here in mgar #MullingarShuffle","BPOInsight: RT @atos: Atos completes delivery of key IT systems for London 2012 Olympic Games http://t.co/Modkyo2R #london2012","BloombergWest: The #Olympics sets a ratings record for #NBC, with 219M viewers tuning in. http://t.co/scGzIXBp #london2012 #tech")

regmatches(foo,gregexpr("#(\\d|\\w)+",foo)) 
```

回报：

```
[[1]]
[1] "#London2012"       "#MullingarShuffle"

[[2]]
[1] "#london2012"

[[3]]
[1] "#Olympics"   "#NBC"        "#london2012" "#tech" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T19:11:40.480

`strsplit`和`grep`版本怎么样：

```
> lapply(strsplit(x, ' '), function(w) grep('#', w, value=TRUE))
[[1]]
[1] "#London2012"       "#MullingarShuffle"

[[2]]
[1] "#london2012"

[[3]]
[1] "#Olympics"   "#NBC,"       "#london2012" "#tech" 
```

我不知道如何在不先拆分的情况下从每个字符串返回多个结果，但我敢打赌有一种方法！

# php - move_upload_file 不创建文件

> ID：11959024
> 
> 赞同：0
> 
> 时间：2012-08-14T19:01:25.517
> 
> 标签：php

我正在编写一个简单的脚本，允许我将文件上传到目录。为此，我使用以下代码：

```
if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) 
{
    echo "uploading successful";    
}    
else    
{
    echo "There was an error uploading the file, please try again!";
} 
```

奇怪的是，如果一个文件`$target_path`已经存在，那么上传成功并且原始文件被覆盖。但是，如果该文件不存在，那么我会收到 else 子句中的错误消息。任何想法可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:04:09.953

检查文件夹权限是否可写。

chmod 目录到 777

# ruby-on-rails - whitelist_attributes 设置为 false 的质量分配错误

> ID：11959025
> 
> 赞同：2
> 
> 时间：2012-08-14T19:01:29.773
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, mass-assignment

我目前正在将应用程序从 Rails 2.3.8 升级到 Rails 3.2.7，并且在批量分配方面遇到了一些问题。
当我尝试保存任何模型时，我收到以下错误：

```
Can't mass-assign protected attributes: a,b,c,d 
```

我注意到 Rails 已将白名单属性的默认设置为：

```
config.active_record.whitelist_attributes = false 
```

所以我将其更改为 true，但错误不断出现。我们将 attr_protected 用于一些事情，但它似乎忽略了这些并保护了一切。我猜这是由于模型使用了“accepts_nested_attributes_for”，但这些都是必要的。

有没有其他方法可以在不使用“attr_accessible”的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T22:32:56.533

每当您使用 attr_accessible 或 attr_protected 时，您就为该模型启用了批量分配保护。如果您在评论中提到该网站纯粹供内部使用，那么在不使用 attr_accessible 的情况下解决此问题的唯一方法是从模型或使用 accept_nested_attributes_for 触及的任何模型中删除 attr_protected。

# javascript - 使用 grunt 对单个 javascript 文件进行 linting 时如何解决依赖关系？

> ID：11959028
> 
> 赞同：8
> 
> 时间：2012-08-14T19:01:33.237
> 
> 标签：javascript, backbone.js, jshint, gruntjs

我想将我的应用程序逻辑分成多个 Javascript 文件，以保持理智和开发人员的友好性，存储在 /src 文件夹中。在构建过程中，这些文件应该被检查并连接到 /dist/app.js 中。我在构建过程中使用 grunt，因为它已经带有方便的 lint 和 concat 任务。

```
    +
    |- grunt.js
    |- 自述文件
    |-供应商
       |-backbone.js
    |- 源
       |- 核心.js
       |- 用户.js
    |- 分布
       |-app.js

```

我遇到了一个烦人的问题。我使用backbone.js 作为应用程序结构，我的大部分源文件都是从通过扩展**Backbone.Model**来定义模型开始的。在检查这些文件时，JSHint 抱怨没有定义 Backbone，这是正确的 - 主干位于其自己的目录之外。我认为以正确的顺序包含所有必要的脚本是在 html 中完成的。每个单独的源文件应该只知道自己。

我知道我可以通过将grunt.js 中的 lint 的**undef标志设置为****false来抑制这些****未定义**的警告，但我想将其设置为**true**以便在我的应用程序中收到有关其他未定义变量的警告，因为它是指向错别字的常见指针. 有没有一种干净的方法来告诉 grunt（或 lint）在 lint 之前要包含哪些文件？我的构建过程或应用程序架构有问题吗？或者这只是我必须忍受的东西？

 ******* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-15T01:09:51.517

这些`jshint`选项允许您在 grunt.js 文件中指定来自您正在使用的其他库的全局变量列表：

```
 jshint: {
      options: {
        curly: true,
        eqeqeq: true,
        immed: false,
        latedef: true,
        newcap: true,
        noarg: true,
        sub: true,
        undef: true,
        boss: true,
        eqnull: true,
        browser: true
      },

      globals: {
        jQuery: true,
        Backbone: true,
        _: true
      }
    }, 
```

注意`globals`底部的设置。这允许 JSHint 忽略这些变量，但仍然运行您的`undef: true`设置（如上所示）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T18:55:37.807

另一种方法（不依赖于 grunt）是将 jshint 注释添加到您的 js 文件中：

```
/* global Backbone, jQuery, _ */ 
```******

# java - 如何在生产者-消费者模型中正确使用 SynchronousQueue？

> ID：11959030
> 
> 赞同：0
> 
> 时间：2012-08-14T19:01:47.067
> 
> 标签：java, multithreading, producer-consumer, java.util.concurrent

我写了一个在生产者-消费者模型中使用 SynchronousQueue 的测试示例。但效果不好。以下是我的代码：

```
public class QueueTest {

    String input;
    int pos;
    BlockingQueue<String> queue;
    volatile boolean exitFlag;

    QueueTest()
    {
        for(int i=0; i<10000; i++)
            input += "abcde";
        input += "X";
        pos = 0;
        queue = new SynchronousQueue<String>();
        exitFlag = false;
    }

    public static void main(String[] args) {
        QueueTest qtest = new QueueTest();
        qtest.runTest();
    }

    void runTest()
    {
        Thread producer = new Thread( new Producer());
        Thread consumer = new Thread( new Consumer());
        producer.start();
        consumer.start();
        try {
            producer.join();
            consumer.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    class Producer implements Runnable
    {
        public void run()
        {
            while(true)
            {
                String s = read();
                if(s.equals("X"))
                    break;
                try {
                    queue.put(s);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
            exitFlag = true;
        }
    }

    class Consumer implements Runnable
    {
        public void run()
        {
            while(exitFlag == false)
            {
                String s = null;
                try {
                    s = queue.take();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                process(s);  
            }
        }
    }

    String read()
    {
        String str = input.substring(pos, pos+1);
        pos++;
        return str;
    }

    void process(String s)
    {
        long sum = 0;
        for(long i=0; i<1000; i++)
            sum = sum * i + i;
    }
} 
```

问题是运行像死锁一样卡住了。这些简单的代码中是否有任何错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:22:17.557

您更有可能看到比赛条件。想象一下场景

```
Thread 1 put into queue
Thread 2 takes out of queue quickly processes and awaits another put from thread 1
Thread 1 finishes and sets exitFlag to true 
```

在这种情况下，线程 2 将永久保留，因为在线程 2 从中读取之前，exitFlag 未设置为 false。

您可能要考虑*服用毒丸*。这是给我们已完成的另一个线程的消息。例如：

```
 final String POISON_PILL = " POISON";

class Producer implements Runnable {
    public void run() {
        while (true) {
            String s = read();
            if (s.equals("X"))
                break;
            try {
                queue.put(s);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        try {
            queue.put(POISON_PILL);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
}

class Consumer implements Runnable {
    public void run() {
        String s = null;
        try {
            while ((s = queue.take()) != POISON_PILL) {
                process(s);
            }
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

因此，当通知另一个线程时，另一个线程已经完成，两个线程都应该优雅地结束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:06:23.527

由于您的 exitFlag 在多个线程之间共享，因此您必须做一些事情来使生产者的更新对消费者可见（就 java 内存模型而言）。对于此示例，使值 volatile 就足够了。

更新：

您应该生成挂起代码的堆栈转储。这将为您提供有关正在发生的事情的线索。这段代码是一个很好的例子，说明了为什么不应该将标志与 BlockingQueue 一起用于控制。

更新 2：

太糟糕了，@JohnVint 把猫从袋子里拿出来了。是的，毒丸是解决这种种族状况的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T19:33:22.513

你的程序会卡在以下场景：

*Producer在 Consumer 检查**existsFlag*是否为*true*之后设置*exitFlag*（不添加新元素）。如果队列中没有更多元素（消费者之前设法处理了所有元素），消费者将在*queue.take()*上被阻塞。

 ***您可以使用*queue.poll()*，它不是阻塞方法。这需要稍微改变你的程序。***

# java - 如何使用 HttpAsyncClient 进行多线程操作？

> ID：11959034
> 
> 赞同：5
> 
> 时间：2012-08-14T19:02:08.283
> 
> 标签：java, multithreading, apache-httpclient-4.x

与这个问题密切相关：[How to use HttpClient with multithreaded operation？](https://stackoverflow.com/questions/5455635/how-to-use-httpclient-with-multithreaded-operation)，我想知道 apache HttpAsyncClient 是否是线程安全的，或者它是否也需要使用 MultiThreadedHttpConnectionManager 或 ThreadSafeClientConnManager。

如果确实需要这样的连接管理器，异步库中是否存在？

我能够在异步库中找到 PoolingClientAsyncConnectionManager，但我不确定这是否是我需要的。

或者，我正在考虑使用 ThreadLocal 为每个线程创建一个 HttpAsyncClient 对象。

请注意，与我之前提到的问题不同，我需要状态在会话之间是*独立*的，即使多个会话访问同一个域也是如此。如果在会话 1 中设置了 cookie，则 cookie对会话 2**不**可见。出于这个原因，我还考虑为每个请求创建一个全新的 HttpAsyncClient 对象，尽管我觉得应该有更好的方法.

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:29:28.697

您提到“跨会话独立”。如果这只是意味着cookie，那么我会认为创建自己的cookie `CookieStore`，当您的每个线程使用时清除`HttpClient`它就足够了。

我会使用`ThreadLocal`创建一个每线程客户端，不使用共享连接管理器，然后积极清除 cookie。这个答案对清除 cookie 很有用：

> [Android HttpClient 持久性 cookie](https://stackoverflow.com/questions/4146861/android-httpclient-persistant-cookies)

类似以下代码的东西会起作用。如果每个请求都是独立的，我已经覆盖了`ThreadLocal.get()`要调用的方法。`clear()`您也可以在`execute(...)`方法中调用 clear 。

```
private static final ThreadLocal<ClientContext> localHttpContext = 
    new ThreadLocal<ClientContext> () {
        @Override
        protected ClientContext initialValue() {
           return new ClientContext();
        }
        @Override
        public ClientContext get() {
           ClientContext clientContext = super.get();
           // could do this to clear the context before usage by the thread
           clientContext.clear();
           return clientContext;
        }
    };
...

ClientContext clientContext = localHttpContext.get();
// if this wasn't in the get method above
// clientContext.clear();
HttpGet httpGet = new HttpGet("http://www.google.com/");
HttpResponse response = clientContext.execute(httpGet);
...

private static class ClientContext {
    final HttpClient httpClient = new DefaultHttpClient();
    final CookieStore cookieStore = new BasicCookieStore();
    final HttpContext localContext = new BasicHttpContext();
    public ClientContext() {
         // bind cookie store to the local context
         localContext.setAttribute(ClientContext.COOKIE_STORE, cookieStore);
    }
    public HttpResponse execute(HttpUriRequest request) {
         // in case you want each execute to be indepedent
         // clientContext.clear();
         return httpClient.execute(request, httpContext);
    }
    public void clear() {
         cookieStore.clear();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T05:58:59.553

在使用和不使用 PoolingClientAsyncConnectionManager 进行负载测试后，我们发现在不使用 PoolingClientAsyncConnectionManager 时得到的结果不一致。

除其他外，我们跟踪了我们进行的 Http 调用的数量，以及已完成的 Http 调用的数量（通过 cancelled(...)、completed(...) 或 failed(...) 函数）相关的 FutureCallback）。如果没有 PoolingClientAsyncConnectionManager，并且在重负载下，这两个数字有时不匹配，这使我们相信在某个地方，某些连接正在踩踏来自其他线程的连接信息（只是猜测）。

无论哪种方式，使用 PoolingClientAsyncConnectionManager，数字总是匹配的，并且负载测试都成功了，所以我们肯定会使用它。

我们使用的最终代码如下所示：

```
public class RequestProcessor {
  private RequestProcessor instance = new RequestProcessor();
  private PoolingClientAsyncConnectionManager pcm = null;
  private HttpAsyncClient httpAsyncClient = null;
  private RequestProcessor() {
    // Initialize the PoolingClientAsyncConnectionManager, and the HttpAsyncClient 
  }
  public void process(...) {
    this.httpAsyncClient.execute(httpMethod, 
         new BasicHttpContext(), // Use a separate HttpContext for each request so information is not shared between requests
         new FutureCallback<HttpResponse>() {
      @Override
      public void cancelled() {
        // Do stuff
      }
      @Override
      public void completed(HttpResponse httpResponse) {
        // Do stuff
      }
      @Override
      public void failed(Exception e) {
        // Do stuff
      }
    });
  }
} 
```

# c++ - 提升 iterator_facade 和前向声明

> ID：11959041
> 
> 赞同：0
> 
> 时间：2012-08-14T19:02:46.090
> 
> 标签：c++, crtp, boost-iterators

我想创建一个支持迭代器的自定义容器。它看起来像这样：

```
class SomeContainer {
    ...
public:
    typedef SomeIterator iterator;
    iterator begin() { ... }
    iterator end() { ... }
}; 
```

然后我为此创建了一个迭代器：

```
class SomeIterator: public boost::iterator_facade<
         SomeIterator, 
         SomeType,
         boost::bidirectional_traversal_tag> {
    ...
} 
```

问题如下。如果我`SomeContainer`在之前声明`SomeiIterator`并转发声明`SomeIterator`，那么编译器会抱怨 st`begin()`和`end()`方法`SomeIterator`是不完整的类型。但是，如果我以另一种方式来做，那么问题就反过来了：`SomeContainer`不完整。

1.  是否有可能解决这个问题，同时让两个类完全只包含标题并且所有方法都隐式内联（它们大多只包含几行）？
2.  如果没有，是否可以通过将一些方法分解到 cpp 文件中来解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:09:57.443

可以部分满足您的第一个要求，因为您可以在标头中定义所有内容，除了需要在定义之外声明和定义的`begin`以及在定义之后（完成类型）。这假设您保留当前的定义顺序（之前），我建议您保留。`end``inline``SomeContainer``SomeIterator``SomeContainer``SomeIterator`

否则，您当然可以放弃`inline`（隐式或其他方式）并在类定义之外进行定义。通过这样做，这两种类型都将从这些定义中完成。

# python - 从组合中，获取包含相同第一个元素的成员的子集，python

> ID：11959043
> 
> 赞同：0
> 
> 时间：2012-08-14T19:02:53.823
> 
> 标签：python, combinations

假设我有以下列表：

```
 ls = ['a', 'b', 'c', 'd'] 
```

我得到一个组合使用

```
 list(itertools.combinations(iterable, 2))  

 >>> [('a', 'b'), ('a', 'c'), ('a', 'd'), ('b', 'c'), ('b', 'd'), ('c', 'd')] 
```

我想做的是把这个组合分解成子集，这样子集中每个元组的第一个成员是相同的：

```
 subset1: [('a', 'b'), ('a', 'c'), ('a', 'd')]
 subset2: [('b', 'c'), ('b', 'd'), 
 subset3: [('c', 'd')] 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:08:13.860

```
>>> import itertools as it
>>> ls = ['a', 'b', 'c', 'd']
>>> ii=it.groupby( it.combinations(ls, 2), lambda x: x[0] )
>>> for key, iterator in ii:
...     print key, list(iterator)
... 
a [('a', 'b'), ('a', 'c'), ('a', 'd')]
b [('b', 'c'), ('b', 'd')]
c [('c', 'd')] 
```

如果你不喜欢`lambda`，你可以使用`operator.itemgetter(0)`代替`lambda x: x[0]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:07:01.697

```
subset = [('a', 'b'), ('a', 'c'), ('a', 'd'), ('b', 'c'), ('b', 'd'), ('c', 'd')]
subsets = [[x for x in subset where x[0] == y] for y in ['a','b','c']] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T19:15:14.020

试试这个：

```
[filter(lambda k:k[0]==p,comb) for p in ls] 
```

在哪里：

```
ls = ['a', 'b', 'c', 'd']

comb = [('a', 'b'), ('a', 'c'), ('a', 'd'), ('b', 'c'), ('b', 'd'), ('c', 'd')] 
```

输出是：

```
[[('a', 'b'), ('a', 'c'), ('a', 'd')], [('b', 'c'), ('b', 'd')], [('c', 'd')], []] 
```

# ruby-on-rails - 使用路线进行 Rails 字符串操作

> ID：11959046
> 
> 赞同：0
> 
> 时间：2012-08-14T19:03:05.663
> 
> 标签：ruby-on-rails, ruby-on-rails-3, string, rake

我有一个应用程序，用户可以像这样注册自己的个人网址

*   myapp.com/users-personal-url

我想运行我的 rails 配置文件并自动获取已经在使用的 url，并在验证方法中遍历这些以防止用户保留这些 url。例如...

如果在我的路线文件中我有类似的东西

```
match 'test' => 'courses#test'
resource :users 
```

那么用户应该无法注册“用户”网址或“测试”网址。到目前为止，我发现我可以通过使用来获取 ruby​​ 类中的所有路由`rake routes`

但是我的弦乐操作技巧让我失望了，因为我是个铁轨菜鸟。基本上我需要对路线进行子串化，将它们放在一个集合中并进行验证检查。指向正确方向或工作代码的指针表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:20:01.963

我认为在 routes.rb 中没有任何快速的 Rails 方式可以做你想做的事情。

您需要在模型中创建[自定义验证器](http://guides.rubyonrails.org/active_record_validations_callbacks.html#performing-custom-validations)。

在处理用户生成的 URL 提交的模型中，添加此验证器。

```
class Whatevermodel < ActiveRecord::Base
  validate :protect_reserved_url, :on => create

  def protect_reserved_url
    reserved_url = ['test', 'users', 'whatever_other_url_you_want_to_protect']
    if reserved_url.include?(url_submission.downcase)
      errors.add(:url_submission, "is an invalid URL")
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T03:18:45.573

好吧，简单地获取路线以便您可以匹配它们，这个人有一个很酷的方法，[如何在我的 rails 应用程序中获取所有路线？](https://stackoverflow.com/questions/3672554/how-get-all-routes-in-my-rails-application)

```
https://stackoverflow.com/questions/3672554/how-get-all-routes-in-my-rails-application 
```

或者你可以用

```
Rails.application.routes 
```

# ruby-on-rails - 从 Ruby 字符串中提取信息

> ID：11959047
> 
> 赞同：0
> 
> 时间：2012-08-14T19:03:09.740
> 
> 标签：ruby-on-rails, ruby

我在远程设备上有一个与此类似的文本文件：

```
 D0-23-DB-31-04-3E%20192.168.4.42%20dnat
 68-A8-6D-0C-38-B2%20192.168.4.40%20dnat 
```

我创建了一个小的 Ruby 脚本来将其转换为字符串并将其发布到我的 Rails 应用程序：

```
 def chilli_list
  hash = File.open("/tmp/client_list", "rb").read
  return hash
 end 
```

然后输出如下所示：

```
"D0-23-DB-31-04-3E%20192.168.4.42%20dnat\n68-A8-6D-0C-38-B2%20192.168.4.40%20dnat\n" 
```

我需要一点一点地提取信息并显示在视图中。到目前为止，我还没有走多远。我尝试了以下是可以的：

```
str = "D0-23-DB-31-04-3E%20192.168.4.42%20dnat\n68-A8-6D-0C-38-B2%20192.168.4.40%20dpass\n" 

str.each_line do |line|
  puts line.split(" ").first
  puts line.split(" ").second
end 
```

这是最好的方法还是有更好的方法？

最后也是最重要的一点，我还需要对字符串进行一些计算。我可以用 来计算行数`str.lines.count`，但我需要的是计算上`== nat`例中第三个值所在的行数。

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:19:38.430

首先，这里是如何从 HTML 编码转换回普通字符串：

```
require 'uri'
URI.decode('D0-23-DB-31-04-3E%20192.168.4.42%20dnat') # => "D0-23-DB-31-04-3E 192.168.4.42 dnat" 
```

以下是将整个字符串分解为单独的解码行的方法：

```
"D0-23-DB-31-04-3E%20192.168.4.42%20dnat\n68-A8-6D-0C-38-B2%20192.168.4.40%20dnat\n".split("\n")
  .map{ |l| URI.decode(l) } 
```

这导致 IRB 中的这个数组：

```
[
    [0] "D0-23-DB-31-04-3E 192.168.4.42 dnat",
    [1] "68-A8-6D-0C-38-B2 192.168.4.40 dnat"
] 
```

添加`.count{ |l| l[/ dnat$/] }`到上一个命令的末尾，您将获得计数：

```
"D0-23-DB-31-04-3E%20192.168.4.42%20dnat\n68-A8-6D-0C-38-B2%20192.168.4.40%20dnat\n".split("\n")
  .map{ |l| URI.decode(l) }
  .count{ |l| l[/ dnat$/] } 
```

哪个返回`2`。

您也可以通过直接计算出现次数来简化整个过程`'nat'`：

```
"D0-23-DB-31-04-3E%20192.168.4.42%20dnat\n68-A8-6D-0C-38-B2%20192.168.4.40%20dnat\n".scan('nat').count 
```

这也返回`2`。

# php - PHP如何输出数组内容

> ID：11959065
> 
> 赞同：0
> 
> 时间：2012-08-14T19:04:37.830
> 
> 标签：php, arrays, stdclass

函数返回以下类型的数组：

```
Array ( [0] => stdClass Object ( [post_id] => 48 
```

我想回显数组内容，所以我尝试使用以下 foreach 循环：

```
foreach ($posts as $post){
    echo $post['post_id'];
} 
```

但我收到以下错误：

> 致命错误：不能使用 stdClass 类型的对象作为数组

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:05:34.450

你有一个对象数组。所以，你需要改变：

```
echo $post['post_id']; 
```

到：

```
echo $post->post_id; 
```

现在，您正在打印对象属性`post_id`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T19:09:45.133

如果您希望输出数组或对象信息以进行调试等操作，您可以执行以下操作：

```
echo '<pre>';
print_r($object);
echo '</pre>'; 
```

这应该适用于数组或对象。

另外，我相信 PHP 5 中的对象有一个“to_array”魔术方法，可以将对象转换为数据数组。

我希望这有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T19:40:33.600

如果要出于调试目的输出，可以使用[print_r](http://www.php.net/manual/en/function.print-r.php)或[var_dump](http://www.php.net/manual/en/function.var-dump.php)，它们对您的对象更详细。

# ruby - 如何在 ruby 中交错数组中的元素？

> ID：11959066
> 
> 赞同：3
> 
> 时间：2012-08-14T19:04:47.727
> 
> 标签：ruby, arrays

因此，目标是将两个包含句子的数组组合成一个必须交换句子的新数组。

类似于以下内容：

```
array_1 = ['1','2','3']

array_2 = ['a','b','c']

new_array = ['1','a','2','b','3','c'] 
```

将不胜感激任何指导。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T19:07:38.990

拉上拉链并压平

```
array_1.zip(array_2).flatten(1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T19:16:24.163

只是为了与众不同...

```
[array_1, array_2].transpose.flatten 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T19:08:08.773

使用[`Array.zip`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-zip)：

```
 array_1.zip(array_2)

irb(main):163:0> array_1.zip(array_2)
[
    [0] [
        [0] "1",
        [1] "a"
    ],
    [1] [
        [0] "2",
        [1] "b"
    ],
    [2] [
        [0] "3",
        [1] "c"
    ]
] 
```

如果您想摆脱嵌入式阵列，请展平。

# codeigniter - 在 CodeIgniter 中修改管理面板的路由

> ID：11959072
> 
> 赞同：2
> 
> 时间：2012-08-14T19:05:07.150
> 
> 标签：codeigniter, admin

这是我第一次尝试使用 CodeIgniter 构建管理面板，但遇到了路由问题。在我的控制器文件夹中，我有一个 admin 文件夹，并且有一个带有 Admin 类的 admin.php 文件。这个类有两个方法，index() 和dashboard()。我在 routes.php 中添加了一条新路由，例如 $route['admin'] = 'admin/admin'。

到目前为止，一切都很好。为什么我运行[http://mysite.com/admin/](http://mysite.com/admin/)它会显示登录页面，这没关系。但是，我无法使用[http://mysite.com/admin/dashboard](http://mysite.com/admin/dashboard)显示仪表板。相反，我必须使用很糟糕的[http://mysite.com/admin/admin/dashboard 。](http://mysite.com/admin/admin/dashboard)

有什么办法可以摆脱网址中的第二个“管理员”？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:57:31.880

当然 - 为仪表板创建一个特定的路线，即：

```
$route['admin/dashboard'] = 'admin/admin/dashboard'; 
```

请记住，路由器会选择它找到的第一个匹配的路由，所以要小心`$route['admin/(:any)']`出现在仪表板路由之前之类的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T14:32:51.277

我不会这样做。如果你想要一个 URL，比如[http://domain.com/admin](http://domain.com/admin)然后在你的 routes.php 文件中添加以下内容

```
$route['admin'] = 'admin/dashboard'; 
```

然后在您的控制器文件夹中，创建一个名为 admin 的文件夹，在其中创建一个名为 dashboard.php 的文件并正常扩展 codeigniter 类

# javascript - 函数中的 scrollTo 插件

> ID：11959077
> 
> 赞同：0
> 
> 时间：2012-08-14T19:05:18.440
> 
> 标签：javascript, jquery, scroll, scrollto

这很简单，所以我希望有人能帮助我。

我在调用函数时使用 scrollTo 插件滚动到 div。

例如：

```
 <script type="text/javascript" src="../../js/jquery-1.7.2.min.js"></script>
 <script type='text/javascript' src='scripts/jquery.scrollTo.js'></script>

 <div id='div1' style="margin-bottom:400px;"></div>
 <button onclick="scroll()"> scroll </button>

 <script>
  function scroll()
   {
  $.scrollTo( $('#div1'));
  alert('scroll');
    }
 </script> 
```

这里的重点是我似乎不知道如何指定函数scrollTo。

上面的例子，顾名思义，就是一个例子。我需要它在一个函数中，而不是在按钮的 onclick 上。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:56:17.083

尝试类似：

```
<button class="scroller" data-id="div1"> scroll </button>
<div id='div1' style="margin-bottom:400px;"></div>

<script>
$('.scroller').on('click', function () {
    var id = $(this).data('id');
    $.scrollTo($('#' + id));
    alert('scroll');
});
</script> 
```

对于`<button>`您使用的每个，只需添加`scroller`类（例如），`data-id="THE DIV's ID"`这样函数就知道`<div>`要滚动到哪个。

看到这个小提琴：http: [//jsfiddle.net/matthewbj/LaC7v/](http://jsfiddle.net/matthewbj/LaC7v/)

# c++ - C++ 命名空间和多重定义变量

> ID：11959082
> 
> 赞同：2
> 
> 时间：2012-08-14T19:05:31.410
> 
> 标签：c++, namespaces, definition

我有两个 C++ 命名空间，如下所示：

```
#ifndef TRANS_H
#define TRANS_H
namespace Trans
{
   double Delta[3];
   double calcDeltaPositions();
   //and more that I will leave out for simplicity
};
#endif

#ifndef SPACE_H
#define SPACE_H
namespace Space
{
   double vels[3];
   void calcAccel(double DeltaVal[3]);
};
#endif 
```

现在我有一个 main.cpp 文件：

```
#include "Trans.h"
#include "Space.h"
int main()
{
    double pos = Trans::calcDeltaPositions();
    Space::calcAccel(Trans::Delta);
    return 0;
} 
```

我一直收到一个错误，声称 Delta 是在 main.o 和 Trans.o 中定义的乘数，这怎么可能，因为我只声明 Delta 存在于 Trans 中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-14T19:07:30.920

如果文件`Trans.h`和`Space.h`包含在多个翻译单元中（cpp 文件 - 在您的情况下，两者都是`main.cpp`和`trans.cpp`），您**将**多次定义变量，从而打破**一个定义规则**。

如果您想要一个全局变量，则需要将变量声明为`extern`并将其定义在单个实现文件中。

如果您想要每个翻译单元的变量副本（可能不是），您可以声明它`static`。

> 既然我只宣布 Delta 存在于 Trans 中，这怎么可能？

事实上，你没有。那是**定义**，而不是**声明**。

```
//Trans.h
namespace Trans
{
    extern double Delta[3];
};

//Trans.cpp
double Trans::Delta[3]; 
```

# c# - C#、RichTextBox 处理线

> ID：11959087
> 
> 赞同：-1
> 
> 时间：2012-08-14T19:05:56.993
> 
> 标签：c#

我创建了一个 RichTextBox，它为输入文本中的某些语法着色。在输入文本框、粘贴大量文本或滚动大量文本时，我没有问题。

当我在有人粘贴到文本框后调用函数 ProcessAllLines 时出现了我的问题，该函数会遍历并处理每一行并按照我的定义为正确的字母着色。有没有一种方法可以在后台使用线程执行此操作，并且能够滚动浏览到目前为止已着色的文本？

还有其他方法可以加快我粘贴文本的着色速度吗？

代码：

```
protected override void WndProc(ref System.Windows.Forms.Message m)
    {
        if (m.Msg == 0x0f)
        {
            if (m_bPaint)
                base.WndProc(ref m);
            else
                m.Result = IntPtr.Zero;
        }
        else
            base.WndProc(ref m);
    }

    protected override bool ProcessCmdKey(ref Message msg, Keys keyData) 
    {
        if((keyData == (Keys.Control | Keys.V)))
        {
            Console.WriteLine("Pasted!");
            ProcessAllLines();
            return base.ProcessCmdKey(ref msg, keyData);
        } 
        else 
        {
            return base.ProcessCmdKey(ref msg, keyData);
        }
    }

    protected override void OnTextChanged(EventArgs e)
    {
        if (m_bTxtChgOk)
        {
            // Calculate stuff here.
            m_nContentLength = this.TextLength;

            int nCurrentSelectionStart = SelectionStart;
            int nCurrentSelectionLength = SelectionLength;

            m_bPaint = false;

            // Find the start of the current line.
            m_nLineStart = nCurrentSelectionStart;
            while ((m_nLineStart > 0) && (Text[m_nLineStart - 1] != '\n'))
                m_nLineStart--;

            // Find the end of the current line.
            m_nLineEnd = nCurrentSelectionStart;
            while ((m_nLineEnd < Text.Length) && (Text[m_nLineEnd] != '\n'))
                m_nLineEnd++;

            // Calculate the length of the line.
            m_nLineLength = m_nLineEnd - m_nLineStart;

            // Get the current line.
            m_strLine = Text.Substring(m_nLineStart, m_nLineLength);

            // Process this line.
            ProcessLine();

            m_bPaint = true;
        }
    }

    public void ProcessAllLines()
    {
        m_bPaint = false;
        m_bTxtChgOk = false;

        int nStartPos = 0;
        int i = 0;
        int nOriginalPos = SelectionStart;
        while (i < Lines.Length)
        {
            m_strLine = Lines[i];
            m_nLineStart = nStartPos;
            m_nLineEnd = m_nLineStart + m_strLine.Length;
            m_nLineLength = m_nLineEnd - m_nLineStart;

            ProcessLine();
            i++;

            nStartPos += m_strLine.Length + 1;
        }
        SelectionStart = nOriginalPos;

        m_bPaint = true;
        m_bTxtChgOk = true;
    }

    private void ProcessLine()
    {
        // Save the position
        int nPosition = SelectionStart;
        // Next three code lines turn the whole current line to black text to begin with
        SelectionStart = m_nLineStart;
        SelectionLength = m_nLineLength;
        SelectionColor = Color.Black;

        // Get us a copy of the current line to play around with
        String lcpy_strLine = new String(m_strLine.ToCharArray());
        // Make it uppercase so we dont have to look for "upper" and "LOWER" cases
        lcpy_strLine = lcpy_strLine.ToUpper();

        // Make each letter green first, then we can change its color later.
        int x = 0;
        while (x < m_nLineLength)
        {
            if (Char.IsLetter(lcpy_strLine[x]) || lcpy_strLine[x].Equals('\\'))
            {
                SelectionStart = m_nLineStart + x;
                SelectionLength = 1;
                SelectionColor = Color.Green;
            }
            x++;
        }

        // These color from the specified char until a non-num is encountered
        lcpy_strLine = ColorTilNoNumFromChar(":", "~", Color.DarkBlue, lcpy_strLine);
        lcpy_strLine = ColorTilNoNumFromChar("M", "m", Color.Red, lcpy_strLine);
        lcpy_strLine = ColorTilNoNumFromChar("N", "n", Color.Maroon, lcpy_strLine);
        lcpy_strLine = ColorTilNoNumFromChar("G", "g", Color.Blue, lcpy_strLine);

        //These color this char is not followed by a letter && !(a num || a symbol)
        lcpy_strLine = ColorCharIfNotFollowedByLetter("X", Color.Green, lcpy_strLine);
        lcpy_strLine = ColorCharIfNotFollowedByLetter("Y", Color.Green, lcpy_strLine);
        lcpy_strLine = ColorCharIfNotFollowedByLetter("Z", Color.Green, lcpy_strLine);

        // Make sure #11.11=11.11 is blue where 1 is a number and . are optional
        while (m_nLineLength >= 3 &&
            lcpy_strLine.Contains("#") && lcpy_strLine.Contains("=") &&
            lcpy_strLine.IndexOf('#') < lcpy_strLine.IndexOf('='))
        {
            int j = 0;
            int indx1 = lcpy_strLine.IndexOf("#");
            int indx2 = lcpy_strLine.IndexOf('=');
            for (j = indx1 + 1; j < m_nLineLength; j++)
                if (!Char.IsDigit(lcpy_strLine[j]) && !lcpy_strLine[j].Equals('.'))
                    break;
            if (lcpy_strLine[j].Equals('=') && !lcpy_strLine[j - 1].Equals('#'))
            {
                for (j = j + 1; j < m_nLineLength; j++)
                    if (!Char.IsDigit(lcpy_strLine[j]) && !lcpy_strLine[j].Equals('.'))
                        break;
                SelectionStart = m_nLineStart + indx1;
                SelectionLength = j - indx1;
                SelectionColor = Color.Blue;
            }
            lcpy_strLine = CopyOverAtIndex("~", indx1, lcpy_strLine);
            lcpy_strLine = CopyOverAtIndex("~", indx2, lcpy_strLine);
        } // endwhile

        if (lcpy_strLine.Contains("P"))
        {
            SelectionStart = m_nLineStart + lcpy_strLine.IndexOf('P') + 1;
            SelectionLength = m_nLineLength - lcpy_strLine.IndexOf('P');
            SelectionColor = Color.Black;
        }

        // These two are for [XXXXX] and Comments
        lcpy_strLine = ColorInsideTwoChars("[", "]", Color.Black, lcpy_strLine);
        lcpy_strLine = ColorInsideTwoChars("(", ")", Color.Purple, lcpy_strLine);

        //This is for single quote comments
        if (lcpy_strLine.Contains("'"))
        {
            SelectionStart = m_nLineStart + lcpy_strLine.IndexOf('\'');
            SelectionLength = m_nLineLength - lcpy_strLine.IndexOf('\'');
            SelectionColor = Color.Purple;
        }

        // Set the postion to the saved position
        SelectionStart = nPosition;
        SelectionLength = 0;
        SelectionColor = Color.Black;
    }

    private String ColorInsideTwoChars(String car1, String car2, Color clr, String lineRef)
    {
        while ((lineRef.Contains(car1) && lineRef.Contains(car2)) &&
            lineRef.IndexOf(car1) < lineRef.IndexOf(car2))
        {
            int indx1 = lineRef.IndexOf(car1);
            int indx2 = lineRef.IndexOf(car2);
            SelectionStart = m_nLineStart + indx1;
            SelectionLength = (indx2 - indx1) + 1;
            SelectionColor = clr;
            lineRef = CopyOverAtIndex("~", indx1, lineRef);
            lineRef = CopyOverAtIndex("~", indx2, lineRef);
        }
        return lineRef;
    }
    private String ColorTilNoNumFromChar(String car, String rplcar, Color clr, String lineRef)
    {
        while (lineRef.Contains(car))
        {
            int j = 0;
            int indx1 = lineRef.IndexOf(car);
            for (j = indx1 + 1; j < m_nLineLength; j++)
            {
                if (!Char.IsDigit(lineRef[j]))
                    break;
            }
            SelectionStart = m_nLineStart + indx1;
            SelectionLength = j - indx1;
            SelectionColor = clr;
            lineRef = CopyOverAtIndex(rplcar, indx1, lineRef);
        }
        return lineRef;
    }
    private String ColorCharIfNotFollowedByLetter(String car, Color clr, String lineRef)
    {
        while (lineRef.Contains(car) &&
            (lineRef.IndexOf(car) + 1 < m_nLineLength))
        {
            int indx1 = lineRef.IndexOf(car);
            SelectionStart = m_nLineStart + indx1;
            SelectionLength = 1;
            if (!Char.IsLetter(lineRef[lineRef.IndexOf(car) + 1]))
                SelectionColor = clr;
            else
                SelectionColor = Color.Black;
            lineRef = CopyOverAtIndex("~", indx1, lineRef);
        }
        return lineRef;
    }
    private String CopyOverAtIndex(String car, int index, String refStr)
    {
        return refStr.Remove(index, 1).Insert(index, car);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:43:43.517

试试这个：

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
    {
        if ((keyData == (Keys.Control | Keys.V)))
        {
            Debug.WriteLine("Pasted!");
            this.SuspendLayout();
            ProcessAllLines();
            this.ResumeLayout();
            return base.ProcessCmdKey(ref msg, keyData);
        }
        else
        {
            return base.ProcessCmdKey(ref msg, keyData);
        }
    } 
```

我还建议通过更改此行来重构您在 ProcessLine 中的代码

```
String lcpy_strLine = new String(m_strLine.ToCharArray()); 
```

至

```
 char[] lcpy_strLine = m_strLine.ToUpper().ToCharArray(); 
```

并从那里开始。您几乎在每次调用令牌时都会获得行字符串的新副本，从长远来看，这将是一个内存负担。

# c++ - 试图从另一个类中传递一个枚举

> ID：11959090
> 
> 赞同：0
> 
> 时间：2012-08-14T19:06:30.467
> 
> 标签：c++, class, enums

我有两个类，一个是 Driver，另一个是 FilterOut。在Driver中，我有一个名为lights的枚举，我将它作为int正确传递给FilterOut。我无法弄清楚如何将其作为枚举来执行。

我的 Driver 类中的枚举

```
enum lights{yellow, green, red, blue}; 
```

这对我有用。

```
void FilterOut::LightIn(int light)
  {
       switch(light);
  } 
```

我想做的事。

```
void FilterOut::LightIn(lights light)
  {
       switch(light);
  } 
```

我尝试了这个和几个变体，但没有运气，有什么想法吗？我还尝试在 FilterOut 中包含一个枚举，它与 Driver 中的枚举相同，并且现在可以使用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:09:18.960

如果枚举在`Driver`类中，那么您必须限定其名称：

```
class FilterOut {
 public:
  void LightIn(Driver::lights light);
};

void FilterOut::LightIn(Driver::lights light)
{
   switch(light);
} 
```

您还必须在调用函数时限定查找范围：

```
FilterOut f;
f.LightIn(Driver::red); 
```

# android - 使用 zxing 时找不到类

> ID：11959091
> 
> 赞同：2
> 
> 时间：2012-08-14T19:06:41.027
> 
> 标签：android, build, zxing, classnotfoundexception

所以我正在开发一个可以扫描二维码的应用程序。我下载了 ZXing 库，使用 apache ant 构建它以获取 core.jar，将其放在我的项目文件夹中，并将其作为 jar 添加到构建路径中。不，当我尝试执行以下操作时：

```
Intent intent = new Intent("com.google.zxing.client.android.SCAN");
intent.putExtra("SCAN_MODE", "QR_CODE_MODE"); 
startActivityForResult(intent, 0); 
```

我收到以下错误：

```
08-14 18:52:01.191: E/AndroidRuntime(617): FATAL EXCEPTION: main
08-14 18:52:01.191: E/AndroidRuntime(617): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.android.Wowser/com.google.zxing.client.android.CaptureActivity}: java.lang.ClassNotFoundException: com.google.zxing.client.android.CaptureActivity in loader dalvik.system.PathClassLoader[/data/app/com.android.Wowser-1.apk]
08-14 18:52:01.191: E/AndroidRuntime(617):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
08-14 18:52:01.191: E/AndroidRuntime(617):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
08-14 18:52:01.191: E/AndroidRuntime(617):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
08-14 18:52:01.191: E/AndroidRuntime(617):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
08-14 18:52:01.191: E/AndroidRuntime(617):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-14 18:52:01.191: E/AndroidRuntime(617):  at android.os.Looper.loop(Looper.java:123)
08-14 18:52:01.191: E/AndroidRuntime(617):  at android.app.ActivityThread.main(ActivityThread.java:3683)
08-14 18:52:01.191: E/AndroidRuntime(617):  at java.lang.reflect.Method.invokeNative(Native Method)
08-14 18:52:01.191: E/AndroidRuntime(617):  at java.lang.reflect.Method.invoke(Method.java:507)
08-14 18:52:01.191: E/AndroidRuntime(617):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
08-14 18:52:01.191: E/AndroidRuntime(617):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
08-14 18:52:01.191: E/AndroidRuntime(617):  at dalvik.system.NativeStart.main(Native Method)
08-14 18:52:01.191: E/AndroidRuntime(617): Caused by: java.lang.ClassNotFoundException: com.google.zxing.client.android.CaptureActivity in loader dalvik.system.PathClassLoader[/data/app/com.android.Wowser-1.apk]
08-14 18:52:01.191: E/AndroidRuntime(617):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
08-14 18:52:01.191: E/AndroidRuntime(617):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
08-14 18:52:01.191: E/AndroidRuntime(617):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
08-14 18:52:01.191: E/AndroidRuntime(617):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
08-14 18:52:01.191: E/AndroidRuntime(617):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561)
08-14 18:52:01.191: E/AndroidRuntime(617):  ... 11 more

<?xml version="1.0" encoding="utf-8"?> 
```

```
<uses-sdk android:minSdkVersion="10" />

<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.CAMERA"/>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name="com.android.Wowser.DealsActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.google.zxing.client.android.CaptureActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="landscape"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
        android:windowSoftInputMode="stateAlwaysHidden" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
        <intent-filter>
            <action android:name="com.google.zxing.client.android.SCAN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity android:name=".Register" />
    <activity android:name=".SignIn" />
    <activity android:name=".Options" />
    <activity android:name=".Scan" />
</application> 
```

谁能告诉我如何设置 Zxing 以正确使用它或我可能出错的地方？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:18:28.553

您是否安装了 Zxing Barcode Scanner 应用程序？您必须安装应用程序才能使用意图进行扫描。

CaptureActivity 不在 core.jar 库中。如果您不想安装并集成到您自己的应用程序中，则必须将他们的 Android 项目作为库包含在内。这是很多混乱。更好地安装他们的应用程序。

另一种方法是使用[Zbar](http://sourceforge.net/projects/zbar)库。我发现这个库易于使用，不需要安装他们的应用程序。唯一的问题是它是否支持您想要的条形码。我会建议检查一下。

**编辑：**

一旦我尝试使用此链接本地包含 zxing。

[在你的 Android 项目中原生添加 ZXing 条码扫描](http://www.possumstew.com/add-zxing-barcode-scanning-natively-in-your-android-project-in-eclipse/)

[ZXing 二维码阅读器直接集成](http://www.androidaz.com/development/zxing-qr-reader-direct-integration)。

你可以看看这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:10:08.110

您会收到此错误的原因只有三个：

1.  这个类真的不存在。如果您使用官方示例中的代码并获取此代码，请确保您拥有该库的最新版本
2.  您尚未将 jar 添加到构建路径中。要解决此问题，请右键单击 Eclipse 中的 jar，然后执行 Build Path ► Add to Build Path。
3.  您的 jar 不在 /libs 文件夹中。当您将 jar 添加到构建路径时会发生这种情况，但较新版本的 ADT 需要它位于 /libs 中。将其放在那里并将其重新添加到构建路径中。

# ios - iOS 使用 GCD 在通知上解锁对象

> ID：11959092
> 
> 赞同：1
> 
> 时间：2012-08-14T19:06:45.917
> 
> 标签：ios, notifications, grand-central-dispatch

假设我创建了一个对象`myObject`，并且在某个时候我希望它被锁定，直到我收到通知。收到通知后，我想解锁它。这可以使用 GCD 完成还是我必须使用锁或其他东西？谢谢！

编辑：所以这是我要解决的确切问题。我有一个线程正在将照片写入`ALAssetsLibrary`. UI 正在使用`ALAssets`以显示库中的照片。我的问题是：`writeImageDataToSavedPhotosAlbum`更改库导致所有`ALAssets`内容无效，因此如果我的第二个线程正在从库中加载照片，它可能会失败（并且经常会失败）。我读到解决这个问题的唯一方法是在 之后加载`ALAssetsLibraryChangedNotification`，所以我试图让库从我写到它的那一刻到我收到通知的那一刻都无法访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:16:58.917

当您应该从队列的角度考虑问题时，您正在从锁的角度考虑问题。给定一些共享的“资源”，您想要做的是这样的事情（未经测试）。这只是方法的草图，但它应该让你走上正确的轨道。您应该尽可能避免使用锁。

```
@implementation Resource

- (id)init {
...
  // Assuming you are the only one who can possibly change the library
  // See suspendQueue for related code
  [[NSNotificationCenter defaultCenter] addObserver:self 
                                          selector:@(resumeQueue:) ...
                                              name:...thenoteification...];

// Always request things synchronously on the queue
- (Something *)somethingForStuff:(Stuff *)stuff {
  __block Something *result;
  dispatch_sync(self.queue, ^{
    result = GetSomethingForStuffFromMe(stuff);
  });
  return result;
}

// Always change things asynchronously on the queue with a barrier
// And in your case, suspend the queue to lock it until done
- (void)setSomething:(Something *)something forStuff:(Stuff *)stuff {
  dispatch_barrier_async(self.queue, ^{
    SetSomethingForStuff(something, stuff);
    [self suspendQueue];
  });
}

// You'll need to think this through a little bit. It depends on your exact model.
// I'm using isSuspended really just as an error-check to make sure something
// hasn't gone wrong.
- (void)suspendQueue {
  NSAssert(! self.isSuspended, @"In this example, I don't allow recursive suspension.");
  [self.queue suspend];
  self.suspended = YES;
}

// This code assumes you're the only one who can cause this notification.
// You may need to change things a little if that's not true
- (void)resumeQueue {
  NSAssert(self.isSuspended, @"We should only ever see this notification if we caused it");
  self.suspended = NO;
  [self.queue resume];
} 
```

# performance - 迭代且有效地将元素添加到 R igraph 中顶点的列表属性

> ID：11959093
> 
> 赞同：5
> 
> 时间：2012-08-14T19:06:51.373
> 
> 标签：performance, r, list, igraph

我正在研究**R**中的信号传播算法，使用**igraph**（随机图库），其中涉及使用 2 级嵌套列表。

Igraph 允许将属性附加到顶点（图的节点），这些可以是向量或列表，但在我的应用程序中，我需要嵌套列表。

要查看，请尝试：

```
library("igraph")
g <- graph.full(10) # create a fully connected graph with 10 vertices
V(g)$letters <- list(NULL) # adds a list called "letters" to every vertex
V(g)$letters # results in a nested list 
```

*我想在不同的阶段将存储在向量中的一些预先确定的元素添加到 2 级列表的给定子集中，其中子集列表与向量的大小相同。*

问题是找到一种将元素添加到二级列表的有效方法。

更简单（也是迄今为止唯一）的方法是编写一个循环：

```
set.seed(1234)

# every iteration represents a "round" of element addition ,
# followed by other operations. 
# So the attribute "letters" should not be populated in one sitting.
for (i in 1:10){

  # select randomly five 2nd-level lists (vertices) from the 1st-level list
  # the selected vertices are generated randomly for exposition, 
  # but I need to be able to select them from a well-defined vector (sel.ver)

  sel.vert <- sample(1:10, 5)

  # generate elements to add to the lists in the 2nd-level list (vertices)
  # again, i generate them randomly just to fill the vector, 
  #but the vector could be pre-determined

  add.elem <- sample(letters, 5)

  # now add add each element to its own list
  # notice that the first ELEMENT of add.elem (add.elem[1]) is added
  # to the attribute of the first SELECTED vertex (V(g)[sel.vert[1]]$letters,
  # the second element of add.elem with the second SELECTED vertex, and so on..

  for (l in 1:5){
    V(g)[sel.vert[l]]$letters <- list(c(V(g)[sel.vert[l]]$letters, add.elem[l]))    
  }
} 
```

（如果这是糟糕的编程实践的恐怖表演，我向有经验的读者道歉）

随着初始网络的规模越来越大，并且在每次迭代中选择更多的顶点（一个随机数，而不是 5 个），循环变得慢得多。这应该是一个“主力”功能，所以我想加快速度。

我阅读了“[有效地在 R 中的向量或列表中添加或删除元素？](https://stackoverflow.com/questions/2778510/efficiently-adding-or-removing-elements-to-a-vector-or-list-in-r) ”的答案，即尽可能使用向量并预先分配它们的大小，但我认为它不适用于我的情况，因为：

1.  我认为使用**igraph**我别无选择，只能使用列表（至少在第一级）
2.  在第二级，列表将具有不同的最终长度，具体取决于随机选择的顶点。因此，很难预先分配正确大小的向量。即使我将非常大的向量放在第二层，最初用 NA 填充（导致向量列表），我也不知道在哪个位置添加元素（因为任何迭代时列表的长度都是随机的），更不用说我以后需要删除 NA。

这应该是添加元素（使用）嵌套列表的特殊情况。因此，我认为也许可以通过用`ddply`in *plyr* or替换内部循环来实现更快的实现`do.call`，但我无法编写要应用的函数：`get the elements of the (inner) list and add this new element (itself a subset of a vector)`

任何意见或建议表示赞赏。希望帖子清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:24:01.820

```
# number of vertices to add elements to at a time
nv <- 5

# selected vertices and elements
sel.ver <- sample(V(g), nv)
add.elem <- sample(letters, nv)

V(g)$letters[sel.ver] <- lapply(1:nv, function(x) {
  c(add.elem[x], unlist(V(g)$letters[sel.ver[x]]))
}) 
```

# c - 传递 C char 数组并分配导致程序崩溃

> ID：11959094
> 
> 赞同：1
> 
> 时间：2012-08-14T19:06:57.207
> 
> 标签：c, windows, memory

我不知道错误是什么，因为这是在 Windows 上，我不知道如何在 Windows 上逐步执行程序。关于程序为什么在这里崩溃的任何想法（请参阅注释行）？我认为这可能与内存滥用有关。

```
#define TABLE_MAX_ROW       500
#define TABLE_MAX_COL       20
#define TABLE_MAX_ELT_LEN   60 
```

从这里开始：

```
foo()
{
    char table[TABLE_MAX_ROW][TABLE_MAX_COL][TABLE_MAX_ELT_LEN];

    bar(table);
} 
```

传递给这个函数：

```
bar(char table[TABLE_MAX_ROW][TABLE_MAX_COL][TABLE_MAX_ELT_LEN])
{
    unsigned int col, row;

    if (table == NULL) { // crashes here
        printf("error: table == NULL!\n");
        return -1;
    }

    for (row = 0; row < TABLE_MAX_ROW; row++)
    for (col = 0; col < TABLE_MAX_COL; col++)
        table[row][col][0] = '\0'; // if above if block commented out, crashes here

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:30:42.987

正如所写，NULL 签入`bar`是不必要的，因为`table`不是在`foo`.

话虽如此，您*可能*使用该数组定义（60 Kb）超出了堆栈帧大小，这会导致运行时问题`bar`，从而导致崩溃。

尝试如下动态分配数组：

```
void foo (void) // explicitly type all functions
{
  /**
   * Declare a *pointer* to a 2D array of col x len and
   * allocate rows elements of it:
   */
  char (*table)[TABLE_MAX_COL][TABLE_ELT_LEN] =
    malloc(sizeof *table * TABLE_MAX_ROW);

  if (table)
  {
    bar(table);
  }

  free(table);
}

int bar(char (*table)[TABLE_MAX_COL][TABLE_ELT_LEN])
{
  unsigned int row, col;

  /**
   * Some duplication of effort here, since we made the null check
   * in foo, but what the heck.
   */
  if (!table)
  {
    // handle error as above
    return -1;
  }

  // process table as above
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:21:33.453

尝试为您正在创建的 3D 数组分配空间

char*** table = malloc(sizeof( sizeof( sizeof(char) * TABLE_MAX_ELT_LEN ) * TABLE_MAX_COL ) * TABLE_MAX_ROW)

这至少会为您的所有元素提供足够的空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T19:25:10.410

程序存储器取决于操作系统。我强烈怀疑崩溃的原因是您的系统无法满足堆栈上如此大的数组分配（几乎 0.6MB！）。最好去`malloc`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T19:26:59.363

问题可能是您的堆栈上没有足够的空间来分配这么大的缓冲区。我建议你[动态分配](http://www.eskimo.com/~scs/cclass/int/sx9b.html)数组。

您还可以使用本文所述的便利宏分配一个平面缓冲区，您可以将其索引到该缓冲区[中](https://stackoverflow.com/questions/11908164/how-to-create-an-array-of-char-pointer-in-c/11908363#11908363)。唯一的区别是你的数组是“3d”而不是“2d”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-14T19:29:38.317

您正在使用堆栈上的 500x20x60=600000 字节为“表”变量分配。

如果你的外壳是`bash`

`ulimit -s` （`limit stacksize`对于 [t]csh）

将显示您可以在程序堆栈上使用的最大内存量。如果你使用超过这个限制，这就是你的程序段错误的原因。

# c# - 我可以覆盖来自成员对象的必需错误消息吗？

> ID：11959100
> 
> 赞同：1
> 
> 时间：2012-08-14T19:07:06.167
> 
> 标签：c#, required

基础对象具有 name 的必需属性，如下所示：

```
public class member
{
    [Required]
    public string Name { get; set; }
    [Required]
    public string ID { get; set; }
} 
```

现在父成员看起来像：

```
public class parent
{
    [Required(ErrorMessage = "The member is required")]
    public member mem{ get; set; }
} 
```

父对象的值在下拉列表中设置，该下拉列表设置成员对象的名称和 ID。成员对象用于错误消息有意义的其他位置，但在这种情况下，用户从没有“名称”字段的下拉列表中进行选择，因此错误消息非常混乱。

我的问题是，有没有办法让我显示父级的错误消息而不是成员对象的？

# drupal - 添加新的 cck 类型后，Drupal 权限页面为空白

> ID：11959103
> 
> 赞同：0
> 
> 时间：2012-08-14T19:07:14.723
> 
> 标签：drupal

在 Drupal 添加新的 CCK 类型后。我去管理员/用户/权限页面和它的空白？如果我恢复到早期快照，没有新添加的 cck 类型的权限页面将再次工作。我试图在性能部分禁用页面缓存，但没有帮助。我安装了大约 100 个模块和 4 个用户角色。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T02:45:11.140

Drupal Devel 模块导致权限页面加载问题 WSOD。一旦我禁用它，页面就会工作。从现在开始，我只会在我们的开发网站上使用它来开发主题。感谢您的所有建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:33:39.270

什么样的CCK领域？它是同类中唯一的吗？您是否尝试过禁用提供它的模块？如果这能解决问题，我会查看该模块的问题队列，看看其他人是否遇到了这个问题。

# clojure - Clojure 中 ~' 或 '~ 的目的是什么？

> ID：11959107
> 
> 赞同：26
> 
> 时间：2012-08-14T19:07:34.647
> 
> 标签：clojure, macros

我正在学习 Clojure 宏，代码示例有时会有结构`'~symbol`或交替`~'symbol`。我知道`(quote`并`'`防止对表单进行评估，并且反引号还添加了命名空间限定，并且 ~ 导致对带引号的表单进行评估。我的问题是：为什么停止然后开始评估有用？我也假设`~'symbol`和`'~symbol`是不同的，但怎么会呢？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-14T19:53:32.577

`~'symbol`用于产生*不合格*的符号。Clojure 的宏默认捕获命名空间，因此宏中的符号通常会解析为`(your-namespace/symbol)`. unquote-quote 成语直接导致简单的、不合格的符号名称`(symbol)`——通过对带引号的符号求值。来自 Clojure 的喜悦：

```
(defmacro awhen [expr & body]
  `(let [~'it ~expr] ; refer to the expression as "it" inside the body
    (when ~'it
      (do ~@body))))

(awhen [:a :b :c] (second it)) ; :b 
```

`'~symbol`可能用于在宏中插入名称或类似的东西。在这里，`symbol`将被绑定到一个值 - `let [symbol 'my-symbol]`。然后将该值插入到宏通过评估生成的代码中`symbol`。

```
(defmacro def-symbol-print [sym]
  `(defn ~(symbol (str "print-" sym)) []
    (println '~sym))) ; print the symbol name passed to the macro

(def-symbol-print foo)
(print-foo) ; foo 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-14T19:12:07.240

`~`是`unquote`函数的读取器宏。在带引号的列表中，它会导致评估符号而不是用作文字符号

```
user> (def unquoted 4)
user>`(this is an ~unquoted list)
(user/this user/is user/an 4 clojure.core/list)
user> 
```

除了 unquoted 符号之外的所有东西都被用作 unquoted 被解析为其值 4 的符号。这**最常用于编写宏。**repl 在打印结果列表时还会打印名称前面的名称空间（用户）。

许多宏基本上只是模板，旨在对函数中无法完成的事情进行一些细微的变化。在这个人为的例子中，模板宏通过调用 def 来定义一个函数。带取消引用的语法引用使这更容易阅读：

```
user> (defmacro def-map-reducer [name mapper reducer] 
         `(defn ~name [& args#] 
              (reduce ~reducer (map ~mapper args#))))

#'user/def-map-reducer
user> (def-map-reducer add-incs inc +)
#'user/add-incs
user> (add-incs 1 2 3 4 5)
20 
```

相比：

```
user> (defmacro def-map-reducer [name mapper reducer] 
          (let [args-name (gensym)] 
              (list `defn name [`& args-name] 
                   (list `reduce reducer (list `map mapper args-name)))))

#'user/def-map-reducer
user> (def-map-reducer add-decs dec +)
#'user/add-decs
user> (add-decs 1 2 3 4 5)
10
user> 
```

在第二个示例中，我也没有使用 auto-gensyms 功能，因为我不在语法引用中

# ruby - 如何在 Ruby 中分隔数组？

> ID：11959110
> 
> 赞同：1
> 
> 时间：2012-08-14T19:07:41.877
> 
> 标签：ruby

好的，所以我有一个数组：

```
numbers = ["2", "3", "4", "5"] 
```

我需要将数组分成两个有条件的数组

```
numbers.reject!{|x| x > 4 } 
```

我需要的是一个`numbers`包含`numbers = ["5"]`的数组和另一个包含拒绝的数组`rejects = ["2", "3", "4"]`

我该怎么做呢？...使用循环似乎很容易，但是有没有办法在一个内衬中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T19:10:28.530

查看[`Enumerable#partition`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-partition)

```
arr = ["2", "3", "4", "5"]
numbers, rejects = arr.partition{ |x| x.to_i > 4 }
 # numbers = ["5"]
 # rejects = ["2", "3", "4"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:15:02.950

```
numbers = [2, 3, 4, 5]

n_gt_four = numbers.select{|n| n > 4}
n_all_else = numbers - n_gt_four

puts "Original array: " + numbers.join(", ")
puts "Numbers > 4: " + n_gt_four.join(", ")
puts "All else: " + n_all_else.join(", ") 
```

输出：

```
   原始数组：2、3、4、5
   数字 > 4: 5
   其他所有：2、3、4

```

# c# - 数据行抛出 NullReferenceException

> ID：11959112
> 
> 赞同：0
> 
> 时间：2012-08-14T19:08:00.263
> 
> 标签：c#, dataset

这是我的代码：

```
 private string[] quizList;

 public string[] getQuizList() 
 {    
     Databases.MoodleOCDataSetTableAdapters.QuizTableAdapter ta = new Databases.MoodleOCDataSetTableAdapters.QuizTableAdapter();
     Databases.MoodleOCDataSet.QuizDataTable table = new Databases.MoodleOCDataSet.QuizDataTable();
     ta.Fill(table);

     System.Data.DataRow[] row = table.Select("id > 0");

     for(int i = 0; i < row.Length; i++)    
         quizList[i] = row[i].ItemArray[2].ToString();

     return quizList;
 } 
```

当我调试时，我可以看到表格中充满了数据，而行也充满了数据。但是当涉及到 for 循环时，它总是抛出空引用异常。我的代码有什么问题？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:11:22.497

内部方法初始化`quizList`

```
quizList = new string[row.Length]; 
```

然后运行循环。

内部循环 quizList 为空，您正在尝试访问它的索引。

所以你的功能应该像

```
 private string[] quizList;

 public string[] getQuizList() 
 {    
     Databases.MoodleOCDataSetTableAdapters.QuizTableAdapter ta = new Databases.MoodleOCDataSetTableAdapters.QuizTableAdapter();
     Databases.MoodleOCDataSet.QuizDataTable table = new Databases.MoodleOCDataSet.QuizDataTable();
     ta.Fill(table);

     System.Data.DataRow[] row = table.Select("id > 0");

     quizList = new string[row.Length];

     for(int i = 0; i < row.Length; i++)    
         quizList[i] = row[i].ItemArray[2].ToString();

     return quizList;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:10:11.110

那意味着那`quizList`是空的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T19:12:49.153

您正在尝试在初始化之前访问 quizList 的索引。尝试做这样的事情：

```
quizList = new String[row.length]; 
```

在你使用它之前。

# c# - 如何释放事件处理程序

> ID：11959122
> 
> 赞同：0
> 
> 时间：2012-08-14T19:08:42.663
> 
> 标签：c#, asynchronous

通常情况下，匿名事件处理程序可以按如下方式释放：

```
 EventHandler hdl = null;
    hdl += (ss,ee) =>
    {
       //....
       MyObj.Completed -= hdl;            
       hdl = null;
    };

    MyObj.Completed += hdl;            
    MyObj.AsyncCall(); 
```

我的问题是：`hdl = null;`最新版本的 C# 是否需要？此版本还有更简单的解决方案或更简单的语法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:14:00.570

一些东西：

1.  简单的设置`hdl = null`不会释放您的处理程序以进行垃圾收集，因为 MyObj.Completed 仍将保存对处理程序的引用。（但`MyObj.Completed -= hdl`在这种情况下会照顾它，所以你应该没问题。）
2.  您不必`+=`在分配给 hdl 时使用。你应该只使用简单的 assignment `=`。
3.  相反，如果您的 lambda 是命名方法，则可以使用`MyObj.Completed += MyCallbackName`and `MyObj.Completed -= MyCallbackName`。如果您需要在关闭时捕获的东西，这不起作用，但我从您的示例中看不到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:14:11.630

不，这不是必需的。这基本上都与捕获上下文（编译器生成的类）相关联；一旦事件被取消订阅，任何东西都不会将捕获上下文保持在范围内，因此它将有资格进行垃圾收集。`hdl`擦除变量（实际上是捕获上下文中的一个字段）没有任何好处（但没有真正的危害）。

# php - 去掉 mysql_real_escape_string() 解析字符串上的 \ 字符

> ID：11959123
> 
> 赞同：0
> 
> 时间：2012-08-14T19:08:54.810
> 
> 标签：php, mysql, database

我的问题似乎微不足道，但我没有找到任何“好的”解决方案。

首先是一个我听过很多答案的问题，我们什么时候需要用 ? 解析字符串`mysql_real_escape_string()`？我的想法是只有在将用户给定的数据存储在数据库中时才需要，这是一个很好的规则吗？

我的第二个问题，这是真正的问题。当我用 解析字符串时，它会在字符串中的任何有害字符之前`mysql_real_escape_string()`放置一个特殊字符，例如。`\`如果函数找到 a`'`那么它将附加 a`\`所以结果是`\'`.

好吧，没关系，问题是当我从数据库中读取相同的字符串时，我也得到了`\`字符。有没有什么好办法摆脱`\`性格？我的一个想法是使用`str_replace("\\","",$string)`，但这是一种很好且安全的方法吗？

谢谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:13:55.853

你可以使用[stripslashes()](http://ie2.php.net/manual/en/function.stripslashes.php)

例如：

```
<?php
    $text = "Test\'ing my app";
    echo stripslashes($text);
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T19:14:03.937

[`mysql_real_escape_string()`](http://php.net/mysql_real_escape_string)不会`\`在您的字符串中放置永久。它只使用它们 - 直到它完成插入。

字符串中反斜杠的最可能原因是使用[`addslashes()`](http://php.net/addslashes), 或者如果[`Magic Quotes`](http://php.net/manual/en/security.magicquotes.php)在您的环境中默认启用。

[`stripslashes()`](http://php.net/stripslashes)在任何情况下，您都可以使用 PHP 删除它们：

```
$string = stripslashes($string); 
```

另一个参考`mysql_real_escape_string()`是[here](http://dev.mysql.com/doc/refman/5.5/en/mysql-real-escape-string.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T19:15:49.540

添加的`\`字符[`m_r_e_s`](http://php.net/mysql_real_escape_string)实际上并没有插入到数据库中。如果您在检索时得到这些，是因为启用了诸如[magic_quotes_gpc 之](http://php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc)类的东西，并且您会自动添加斜杠。

## 也就是说，您应该真正切换到[PDO](http://php.net/PDO)或[Mysqli](http://php.net/mysqli)，因为这些`mysql_`功能已被弃用。

您的第一个问题是正确的，任何用户输入都应该在插入之前正确转义。PDO 和 Mysqli 允许您使用准备好的语句，并且还提供了它们自己的转义函数。

关于您的第二个问题，请尝试以下代码：

```
if (get_magic_quotes_gpc()) {
    $value = stripslashes($_POST['value']);
} 
```

这将删除 PHP 自动添加的任何斜线。[有关魔术行情](http://www.php.net/manual/en/security.magicquotes.php)的更多信息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-14T19:16:43.133

首先，不鼓励使用 mysql_real_escape_string。检查magic_quotes是否开启：

```
echo "Magic quotes is " . (get_magic_quotes_gpc() ? "ON" : "OFF"); 
```

或者你可以使用`stripslashes`

# asp.net - 包含未执行的 ASP.net 代码

> ID：11959125
> 
> 赞同：3
> 
> 时间：2012-08-14T19:08:59.310
> 
> 标签：asp.net, parsing, server-side-includes

自从我涉足服务器端以来已经有很长时间了，但在我看来，嵌入在包含的代码文件中的脚本应该可以正常执行。由于某种原因，情况似乎并非如此。

*（注意——下面显然是基于我调试尝试的简化实现。实际上，在实际项目中，我还有其他包含平面 HTML 和 JavaScript 的内容，渲染得很好。只是没有正确解析的 ASP 代码， <% %> 标签和所有。）*

**索引代码**

```
 <%@LANGUAGE="VBSCRIPT" CODEPAGE="65001"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>My Site</title>
</head>

<body>

    <% Response.WriteFile ("includes/test.aspx") %>

</body>
</html> 
```

**包含代码**

```
<% response.write("boo"); %> 
```

生成的页面，当从服务器运行时，包含文件就好了......但脚本呈现为文本。

我这里哪里出错了？？

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:14:45.903

我认为您可能仍在以 asp-classic 的思维方式思考。

Asp.net WebForms 尝试使用更加面向对象的方法，该方法使用类、将关注点与背后的代码分离并使用母版页和占位符继承外观，而不是使用包含。此外，WebForms 在很大程度上被 ASP.NET MVC 所取代，这再次改变了范式。

However asp-classic style Server Side includes still work just fine in .aspx, with a few restrictions such as the inability to include up through a parent path, and you will also lose your intellisense in the included files.

To use SSI, use the [`<!--#include file="xxx.ext" -->` directive.](http://msdn.microsoft.com/en-us/library/3207d0e3%28v=vs.80%29.aspx)

So in your example:

```
<body>
    <!--#include file="includes/test.aspx" -->
</body> 
```

Where test.aspx is simply:

```
<% int someInt = 123;
Response.Write(someInt);
%> 
```

But IMO is a bit like using a chainsaw to hammer nails. I would skip WebForms entirely and head straight into Asp.Net MVC.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:13:32.340

什么都不会出错。

当 you 时`WriteFile`，文件的内容将被渲染。

ASP.NET 没有像经典 ASP 那样的服务器端功能。

您需要使用控件来动态构建页面，尽管您可能希望查看[ASP.NET/MVC](http://www.asp.net/MVC)而不是 WebForms，因为它更接近于您使用经典 ASP 所做的事情。

# css - 有没有办法在元素上使用 translateZ 而不会自动对所有嵌套文本进行抗锯齿处理？

> ID：11959129
> 
> 赞同：1
> 
> 时间：2012-08-14T19:09:08.763
> 
> 标签：css, webkit, css-transitions

我在我的页面中进行了一些简单的转换（基本的东西，比如不透明度的淡入淡出、背景颜色变化和边框半径更新）并且在我正在制作动画的元素和页面上其他不相关的元素中都经历了一些闪烁。通常，快速解决此类问题的方法是添加`translateZ(0)`到您正在制作动画的元素中，但在 Webkit 中，当您这样做时，它似乎会自动将所有嵌套文本设置为`-webkit-font-smoothing: antialiased`.

这对我来说是一种不受欢迎的效果，因为我经常使用它`-webkit-font-smoothing: antialiased`并`-webkit-font-smoothing: subpixel-antialiased`在整个页面中确保我的文本尽可能地看起来最好。

有什么办法可以避免这种使用的副作用`translateZ(0)`吗？仅供参考：申请时也会发生同样的事情`-webkit-backface-visibility: hidden`。

# java - Java 中服务器端 SSL 的概念概述

> ID：11959135
> 
> 赞同：5
> 
> 时间：2012-08-14T19:09:35.960
> 
> 标签：java, ssl, ssl-certificate

我的任务是使用 HTTPS 保护（以前是 HTTP）Web 服务。`SSLEngine`我从一位现已离职的同事那里继承了在我们现有服务器的 TCP 和 HTTP 层之间插入对象的代码。据我所知，这段代码可以正常工作。我得到了`SSLEngine`from `SSLContext.createSSLEngine()`，但是如何产生适当的`SSLContext`让我感到困惑。

`SSLEngine`它本身在其 javadoc 中有一个漂亮的概念介绍，但不幸的是，我*不需要*与自己进行交互。另一方面，[SSLContext.init()](http://docs.oracle.com/javase/1.5.0/docs/api/javax/net/ssl/SSLContext.html#init%28javax.net.ssl.KeyManager[],%20javax.net.ssl.TrustManager[],%20java.security.SecureRandom%29)的文档很少，只是说我必须通过“身份验证密钥的来源”和“对等身份验证信任决策的来源”，我不知道那是什么。这些参数类型的文档（通常我下次尝试理解它）是通用的，以至于什么都不说，而且类文档`SSLContext`也很简短。

我得到了一堆 ascii-armored `.crt`、`.pem`和`.key`文件，它们一起使 Apache 能够在 Java 服务器最终将直接处理的域中提供 HTTPS。我想我需要以某种方式将它们加载到 the`SSLContext`或 the 中`SSLEngine`，但不确定是否`SSLContext.init()`是正确的地方（尽管似乎没有很多其他地方可以）。

> *我应该首先*阅读哪些文档以了解如何执行此操作？

我的 Google 尝试生成了许多质量和安全性未知的半未记录示例代码，以及一些高级演练，例如“如何编写自己的密钥提供程序”，但没有对 JRE的*最基本*用法进行全面的概念介绍类。

特别是因为这是与安全相关的，所以我没有用复制粘贴示例代码，我只会漫无目的地敲打，直到它似乎或多或少地做我想要的。我需要对各个部分实际上应该如何组合在一起的高级概念理解。

*（如果文档足够详细，可以让我弄清楚如何在实践中进行 SSL 客户端授权，则可以加分——但这并不是立即紧迫的）。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:39:22.483

如果您想要详细的文档，请查看[JSSE 参考指南](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html)，更具体地说是其[SSLContext 部分](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html#SSLContext)。

默认值（如果您传递`null`给`SSLContext.init(...)`）默认情况下是合理的，但您可能想了解这些默认值是什么（请参阅[*自定义*](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html#Customization)部分）。

密钥库没有默认值（只有信任库，如果您想要客户端证书身份验证，您几乎肯定会想要自定义它）。

`SSLContext`通常，您可以按如下方式初始化 a ：

```
KeyStore ks = KeyStore.getInstance(...); // Load the keystore
ks.load(...); // Load as required from the inputstream of your choice, for example.

KeyStore ts = KeyStore.getInstance(...); // Load the truststore
ts.load(...);

KeyManagerFactory kmf = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
kmf.init(ks, <the key password>);

TrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
tmf.init(ts);

SSLContext sslContext = SSLContext.getInstance("TLS");
sslContext.init(kmf.getKeyManagers(), tmf.getTrustManagers(), null); 
```

对于密钥库和信任库之间的区别，您可能也对[这个答案感兴趣。](https://stackoverflow.com/a/6341566/372643)简而言之，两者都是存储意义上的“密钥库”，但密钥库是您存储*证书*（+链）和相关私钥（即服务器上的服务器证书和私钥以及客户端证书和私钥）的地方在客户端上），并且信任库是您在远程方提供其证书时存储您愿意信任的 CA 证书或远程证书（没有私钥，因为它们不是您的证书）的地方。

关于如何处理您的密钥/证书文件，最简单的方法当然是使用 type 的密钥库，您可以按照[此答案](https://stackoverflow.com/a/11954816/372643)`PCKS12`中的描述构建它。

**编辑：（**以下评论）

> 那么，如果我是服务器并且尚未进行 SSL 客户端身份验证，是否可以正确理解我可以使用 null TrustManager 侥幸？

是的。

> 但是，如果我要进行客户身份验证，我需要提供一个 TrustManager，其中包含应该能够连接的每个客户端的公钥？

通常不会。您将为颁发这些客户端证书的 CA 提供 CA 证书。如果您没有此基础架构（或者如果您正在构建它并且还没有任何客户端证书），您应该考虑创建自己的 PKI，或者可能从知名 CA 购买客户端证书。

您还可以构建一个 TrustManager 接受自签名证书（独立于任何 CA）并使用预定义列表中的指纹验证它们，但这会带来许多问题（特别是服务器如何要求正确的证书)，您最终可能会复制 PKI 的部分用途。除非您对自己的工作有更多了解，否则我不建议这样做。

> 这有点令人沮丧。我曾希望我可以等到获得请求 URL，然后才需要为授权客户端检索指纹，然后才能与实际客户端进行身份验证的指纹进行比较。

在这里，您谈论的是完全不同的方面。如果您想先获取请求的 URL，在请求证书之前，您需要使用重新协商。HTTP 层必须与`SSLEngine`for 对话，请求它触发新的握手（现在设置为请求客户端证书）。

`SSLEngine`一般来说，在 Java 中通向 SSL/TLS 并不容易，但异步重新协商可能会变得非常棘手。事实上，它的语义在应用层还不是很清楚。您很可能在收到 HTTP 请求后触发重新协商，但同时正在发送响应（因为您可能有异步请求/响应，可能是流水线的）。从技术上讲，新的握手会影响两个管道。

总体而言，无论是否重新协商，这与检查您如何信任客户端证书完全无关。如果你真的想让你的应用程序层（而不是 SSL/TLS 层）进行证书验证，你必须编写一个`X509TrustManager`信任任何东西（绕过 SSL/TLS 层的验证）和让您的应用程序从`SSLSession`（对等证书）获取证书并在那里进行验证。总的来说，这与接受自签名证书并更手动地验证它们非常相似。可以这样做，但是您将退出 PKI 模型，并且您需要一些自定义代码来执行此操作（而不是仅使用默认使用的 API）。

如果你对这一切都不熟悉，我会避免这种方法。尝试设置一个测试 CA 并首先了解它是如何工作的。关于使用 CA 或进行手动指纹验证的整个问题最终更多的是一个管理问题：它由您将如何在相关各方之间分发证书来定义。

> 另外，`<the key password>`这里在做什么？这应该在某处托管设施的无人值守服务器上运行；我们不能等待有人在启动过程中输入密码（例如，停电后）。

您需要设置密码。如果需要，大多数服务器会从配置文件中读取它（或者更糟糕的是，您可以对其进行硬编码）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:23:46.277

回答第 1 部分：

您需要为 SSLContext 提供一个 KeyManager，以便服务器端的 SSLContext 能够将自己作为 KeyManager 存储为公钥和私钥的任何内容呈现给客户端。

您需要为 SSLContext 提供一个 TrustManager 以允许它对客户端进行身份验证。

编辑：回答第 2 部分：

所有这些类和接口都可以将不同的服务提供者用于任何类型的事情（管理私钥、管理客户端身份验证、使用的 SSL 引擎等）。

但是 sun 提供了它自己的默认实现，这些实现相当安全。

所以：如果你想使用自定义的东西或者不是默认的东西，你通常只会深入到 api 中。

编辑：回答第 3 部分：

通常你会使用 SSLSocket 并放置一个普通的 Socket（或创建 SSLSocket，所以它也会创建普通的 Socket）。

如果您想干预 ssl 通信本身，您将使用 SSLContext 和 SSLSession。在你甚至不会使用 Socket 的地方。

# jquery - 将屏幕截图裁剪为 PhantomJS 中的元素

> ID：11959139
> 
> 赞同：2
> 
> 时间：2012-08-14T19:09:49.313
> 
> 标签：jquery, phantomjs

我知道可以在 PhantomJS 中任意裁剪屏幕截图，使用`page.clipRect()`：

```
 page.clipRect = { 
                top: element_top, 
                left: element_left, 
                width: element_width, 
                height: element_height 
            }; 
```

因此，我正在尝试使用 jQuery 获取特定元素的位置和宽度/高度。但是，我下面的代码（基于 PhantomJS [rasterize.js 示例](http://code.google.com/p/phantomjs/wiki/QuickStart)的最后一部分）不起作用；它只保留默认值。

我在想我一定在变量范围方面做错了什么。我怎样才能让它工作？

```
page.open(address, function (status) {
    if (status !== 'success') {
        console.log('Unable to load the address!');
    } else {

        var element_top = 0;
        var element_left = 0;           
        var element_width = 200;
        var element_height = 200;

        page.evaluate(function() { 
                var $element = $('h1');
                var offset = $element.offset();
                element_top = offset.top;
                element_left = offset.left;
                element_width = $element.width();
                element_height = $element.height();     
        });

        window.setTimeout(function () {
            page.clipRect = { 
                top: element_top, 
                left: element_left, 
                width: element_width, 
                height: element_height 
            };

            page.render(output);
            phantom.exit();
        }, 200);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T02:42:10.230

你在里面运行`page.evaluate`的任何东西都不能从外部世界获得，执行是沙盒的，并且受限于页面上下文。为了使其可用，请将其作为返回值，然后您就可以访问它。

看看 PhantomJS 包含`pizza.js`的比萨店列表返回给调用者的位置。

# javascript - KineticJS stage.toDataURL() 适用于 mimeType png 但不适用于 jpeg

> ID：11959146
> 
> 赞同：2
> 
> 时间：2012-08-14T19:10:20.610
> 
> 标签：javascript, html, canvas, svg, kineticjs

我有一个非常简单的应用程序，我正在编写它来自定义曲棍球手套上的颜色并将其导出为 JPEG。但是 jpeg 文件格式似乎不起作用，它只显示左下角的图像，原因很奇怪。这是网址：

[http://jtdsdev.com/glove_customizer/canvas-test2.html](http://jtdsdev.com/glove_customizer/canvas-test2.html)

这是一些示例代码：

JS

```
function draw(){
.... 
code to draw paths 
....
document.getElementById("preview").addEventListener("click", function() {
      stage.toDataURL({
        mimeType: "image/jpeg",
        quality: 1,
        callback: function(dataUrl) {
              document.getElementById("img_preview").src = dataUrl;
        }
      });
    }, false);
} 
```

HTML

```
<body style="background-color:white">
    <div id="container">
    <button id="preview" name="preview" >Preview</button>
    <br>
    <img id="img_preview">
    </div>
....
</body> 
```

完整的代码可以在上面的链接中看到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-19T22:32:10.613

它应该以这种方式工作：

```
 stage.toDataURL({
        mimeType: "image/jpeg",
        quality: 1.0,
        callback: function(dataUrl) {
             ...
        }
      }); 
```

# jquery - 使用jquery的html5点击事件

> ID：11959147
> 
> 赞同：0
> 
> 时间：2012-08-14T19:10:20.050
> 
> 标签：jquery, html

我正在尝试使用 jquery 和 html5 向形状添加点击事件......但整个画布不仅仅是可点击的形状。需要一些帮助。这是项目

[http://soumghosh.com/otherProjects/click.html](http://soumghosh.com/otherProjects/click.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:19:47.107

您将不得不编写一些自定义代码来处理画布内的鼠标事件。[查看本教程](http://simonsarris.com/blog/140-canvas-moving-selectable-shapes)的“鼠标事件”部分，它处理您正在寻找的类似解决方案。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:19:49.437

请遵循以下程序：

1.  在具有透明背景的屏幕外图层（另一个画布）中绘制形状（填充 rgba(0,0,0,0)。
2.  从 canvas.onclick 事件中读取画布单击 X、Y 位置。
3.  检查离屏层 x, y 坐标：
    *   如果 layer(x,y) = rgba(0,0,0,0) 那么点击在形状之外。
    *   其他形状被点击。

# jquery - jQuery：选中所有选项后选择全局复选框

> ID：11959149
> 
> 赞同：1
> 
> 时间：2012-08-14T19:10:24.607
> 
> 标签：jquery

我在这里看到了几个“检查所有”的解决方案，但没有一个可以反过来：当所有选项都被选中时，选择全局复选框。

我有一个组列表。每个组有 4 个项目，底部有一个“全部取消订阅”选项。

到目前为止，我已经能够处理“检查所有”选项，但我正在努力检查组的“取消订阅所有”选项，当已经选择了所有取消订阅选项。

这是迄今为止我所拥有的***[DEMO （现在很旧）。](http://jsfiddle.net/rzea/pYcQY/4/)***底部是我为此编写的一段代码，但当然，它不起作用。

其他功能都很好，除了这个是我需要帮助的。

任何帮助是极大的赞赏。

谢谢。

**编辑 -** *添加指向小提琴的链接，因为解决方案隐藏在下面的评论中。感谢**j08691**的脚本。*

***[演示](http://jsfiddle.net/rzea/pYcQY/19/)***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:15:44.040

您需要一个[*`change()`*](http://api.jquery.com/change)事件`radio`按钮，如下所示：

```
$('.opt-out input[type=radio]').on('change', function() {
    var table = $(this).closest('table'),
        checkedBoxes = table.find('.opt-out input[type=radio]:checked').length,
        total = table.find('.opt-out input[type=radio]').length;
        table
           .find('input[type=checkbox].unsubs-chkbx-group')
           .attr('checked', checkedBoxes === total);
}); 
```

**[演示](http://jsfiddle.net/pYcQY/11/)**

## 笔记

`:radio`不推荐使用选择器***[是 jQuery 1.8](http://api.jquery.com/category/deprecated/)***。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:24:45.980

添加这段代码：

```
$(".opt-out input:radio").click(function() {
    if($(this).parents('table').find(".opt-out input:checked").length==4)$(this).parents('table').find(".unsubs-chkbx-group").attr('checked','checked');
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/pYcQY/6/)**

# bash - 使用 gedit 在 bash_profile 中意外结束文件

> ID：11959153
> 
> 赞同：0
> 
> 时间：2012-08-14T19:10:42.563
> 
> 标签：bash

```
if [ -f ~/.bashrc ]; then
   source ~/.bashrc 
fi
export PATH=$PATH:/usr/local/cuda/bin
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda/lib:/usr/local/cuda/lib64
export ANDROID_API_LEVEL=android-14
export ANDROID_NDK=$HOME/android-ndk 
```

插入 if 语句后，我得到了意外的行尾。但是，当我使用 dos2unix 转换器时，它运行良好。我不知道为什么会这样，因为我正在使用 gedit 或 nano 进行编辑，但仍然遇到这个问题。我使用的是本机 Ubuntu 12.04 系统。关于这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:17:56.227

检查`~/.bashrc`；这可能是错误的根源。

# perl - Pod 对 search.cpan 或 metacpan 不可见，为什么？

> ID：11959159
> 
> 赞同：3
> 
> 时间：2012-08-14T19:11:20.470
> 
> 标签：perl, document, cpan, perl-pod

我注意到我的[WITH 部分](https://metacpan.org/module/XENO/Business-CyberSource-0.006001/lib/Business/CyberSource/Request/Authorization.pm)中的 pod 链接不起作用。我查看了链接只是[拼写错误](https://metacpan.org/module/XENO/Business-CyberSource-0.006001/lib/Business/CyberSource/Request/Role/BillingInfo.pm)，但单击[源](https://metacpan.org/source/XENO/Business-CyberSource-0.006001/lib/Business/CyberSource/Request/Role/BillingInfo.pm)显示它不是，并且 Pod 在那里。为什么我的 pod 不能在 metacpan.org 或 search.cpan.org 上工作（似乎是 perldoc）？

*更新：修复后问题拒绝显示*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:34:33.067

如果我正确理解了这个问题，我认为就是这样：您的`META.yml`.

```
no_index:
  file:
    - perlcritic.rc
  namespace:
    - Business::CyberSource::Request::Role
    - Business::CyberSource::Response::Role
    - Business::CyberSource::Role 
```

这告诉 CPAN 不要索引您的 POD。MetaCPAN 和 search.cpan 也将它们从列表中隐藏起来。

# python - py2exe 给出 EOFError

> ID：11959169
> 
> 赞同：2
> 
> 时间：2012-08-14T19:12:07.140
> 
> 标签：python, pygame, py2exe, eoferror

我有一个简单的程序，我使用 pygame 导入声音，但它仍然是一个 CLI 程序。每当我将它编译成 exe 时，它​​会在我尝试运行它时给我一个 EOFError，它看起来像这样

```
Traceback (most recent call last):
  File "PlanetaryDistanceFromSun.pyw", line 57, in <module>
  File "PlanetaryDistanceFromSun.pyw", line 31, in main
  File "PlanetaryDistanceFromSun.pyw", line 44, in Planet
EOFError: EOF when reading a line 
```

这是有问题的代码： raw_input("%s 离太阳有多远？" % planet)

我在互联网上进行了大量搜索，发现一些东西说我需要一个控制台参数，但我不明白那是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T06:34:56.367

看看 pygame 网站上的这个[py2exe 示例](http://www.pygame.org/wiki/Pygame2exe)：

它还包含您的问题的解决方案：

> 这仅适用于 GUI 应用程序，在 setup 命令中将“windows =”更改为“console =”即可。

相关部分是这个（IIRC）：

```
...
windows = [{
            'script': self.script,
            'icon_resources': [(0, self.icon_file)],
            'copyright': self.copyright
        }],
... 
```

您必须更改`windows`为`console`.

此外，pygame-user 邮件列表上的[这个线程描述了同样的问题：](http://www.mail-archive.com/pygame-users@seul.org/msg04832.html)

> 我的猜测是您使用带有“windows”参数的 py2exe，这意味着没有打开控制台 - 没有控制台，就没有标准输入供 raw_input 使用。您可以改为在 setup.py 中使用“console”参数，您的 exe 将打开一个控制台窗口，允许 raw_input 工作。

# c# - WebBrowser.DrawToBitmap 留下白色像素

> ID：11959170
> 
> 赞同：2
> 
> 时间：2012-08-14T19:12:10.603
> 
> 标签：c#, .net, webbrowser-control, gecko

我使用 Gecko .NET WebBrowser 控件来获取 HTML 页面。

然后我使用这段代码来截取这个 HTML 页面：

```
void LoadingFinished(object sender, EventArgs args)
{
    try
    {
        myBrowser.Document.Body.SetAttribute("style", "overflow:hidden");
        if (screenshotkey != "")
        {
            Bitmap bitmap = new Bitmap(myBrowser.Width, myBrowser.Height);
            myBrowser.DrawToBitmap(bitmap, new Rectangle(0, 0, myBrowser.Width, myBrowser.Height));
            bitmap.Save("Screenshots/" + screenshotkey + ".png", ImageFormat.Png);
        }
    }
    catch (Exception dfkvsn)
    {
        errorloadingpage();
    }
} 
```

我从上面的代码中删除了一些不是很重要的东西——比如设置浏览器宽度等。最初的代码是 100% 功能的。

问题是，当它保存 png 屏幕截图（DrawToBitmap 线）时 - 在某些地方，创建的图片有不应该存在的白色像素（WebBrowser 最初没有它们），请参阅[链接](http://denver.craigslist.org/ctd/3204849224.html)。

当我使用标准的 .NET WebBrowser 控件时也发生了同样的事情，所以这不是 Gecko 问题。

我不知道如何解决这个问题。有没有更好的方法将它保存到位图？或者这是 .NET 能做的最好的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T11:08:21.497

修复。
事实证明，看起来是白色的像素只是透明的。
而且它们只出现在图片具有最深黑色（RGB 0、0、0）的地方，
由于某种原因，.NET 无法将此颜色保存到文件中。
所以我简单地添加了使整个图片变黑的代码行，并在此基础上记录了我的屏幕截图。
因为它现在是 2 层 - 透明像素现在看起来是黑色的 - 正是我想要的 - 没有白色像素。
这是最终的代码：

```
void LoadingFinished(object sender, EventArgs args)
        {
            try
            {
                myBrowser.Document.Body.SetAttribute("style", "overflow:hidden");
                if (screenshotkey != "")
                {
                    panel1.Height = myBrowser.Document.Body.ScrollHeight;
                    panel1.Width = myBrowser.Document.Body.ScrollWidth;
                    this.Size = new System.Drawing.Size(panel1.Width+20, panel1.Height+20);

                    if (!Directory.Exists("Screenshots"))
                    {
                        Directory.CreateDirectory("Screenshots");
                    }

                    Bitmap bitmap = new Bitmap(myBrowser.Width, myBrowser.Height);
                    for (int Xcount = 0; Xcount < bitmap.Width; Xcount++)
                    {
                        for (int Ycount = 0; Ycount < bitmap.Height; Ycount++)
                        {

                            bitmap.SetPixel(Xcount, Ycount, Color.Black);
                        }
                    }
                    myBrowser.DrawToBitmap(bitmap, new Rectangle(0, 0, myBrowser.Width, myBrowser.Height));
                    bitmap.Save("Screenshots/" + screenshotkey + ".png", ImageFormat.Png);
                }
            }
            catch (Exception dfkvsn)
            {
                errorloadingpage();
            }
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T20:03:10.150

这正是发生在我身上的事情。我想我的现在也修好了。我从没想过初始图像（在编写控件之前）需要任何东西。请注意我附上的简化代码，用于将初始图像清除为全黑。

```
 try
    {
        string fn = Path.Combine(Path.GetTempPath(), "Error_screen.png");
        Bitmap bmp = new Bitmap(internalBrowser.Width, internalBrowser.Height);

        // In order to use DrawToBitmap, the image must have an INITIAL image. 
        // Not sure why. Perhaps it uses this initial image as a mask??? Dunno.
        using (Graphics G = Graphics.FromImage(bmp))
        {
            G.Clear(Color.Black);
        }

        internalBrowser.DrawToBitmap(bmp, new Rectangle(0, 0, 
                    internalBrowser.Width, internalBrowser.Height));

        bmp.Save(fn, ImageFormat.Png);
    }
    catch
    {
        // handle exceptions here.

        return "";
    } 
```

一个非常有趣的旁注：这适用于我的控件，它位于我从未展示过的表单上！我的表单作为无头网络浏览器存在，但这种实际表单从未出现过。

# c# - EF中棘手的左外连接，用于连接表的标准

> ID：11959173
> 
> 赞同：0
> 
> 时间：2012-08-14T19:12:21.213
> 
> 标签：c#, .net, linq, entity-framework, entity

我正在尝试获取客户记录列表以及每个实体的最新 ClientNote 记录。如果客户端没有关联的注释，我希望该客户端的 ClientNote 为空（类似于 TSQL 中的 LEFT JOIN）。

我有 2 个相关的表格，如下所示：

```
CREATE TABLE [dbo].[Client](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [ClientNumber] [varchar](10) NOT NULL,
    [Name] [varchar](100) NOT NULL,
    [AssociateName] [varchar](30) NOT NULL,
    [AssignedToID] [int] NULL,
    [District] [varchar](6) NOT NULL,
    [RegionID] [int] NOT NULL,
    [CreateDate] [datetime] NOT NULL,
)

CREATE TABLE [dbo].[ClientNote](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [ClientID] [int] NOT NULL,
    [Note] [varchar](4000) NOT NULL,
    [NoteDate] [datetime] NULL,
    [TicklerDate] [datetime] NULL,
    [EnteredByAgentID] [int] NOT NULL,
    [CreateDate] [datetime] NOT NULL,
) 
```

当 Client.Name 像 '%ike%' 并且（不存在 ClientNote 或 ClientNote CreateDate 超过 60 天）时，我需要一个 EF 左外连接来返回 Client 和最新的 ClientNote。所以，我想为每个匹配返回两个对象：一个客户端和一个可选（空）客户端注我已经尝试了很多东西，但我没有得到我想要的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:25:13.907

尝试以下操作，您还可以将最后一个从 SingleOrDefault() 更改为 FirstOrDefault() 或可能更改为数组：

```
var clientInfo = (from a in yourdatacontext.Client
    join b in yourdatacontext.ClientNote on a.ID equals b.ID into temp
    from t in temp.DefaultIfEmpty() //this is what does the left outer join
    where a.Name.Contains("ike") && b.CreateDate > DateTime.Now.AddDays(60) 
    select new {
        a,
        t
     }).SingleOrDefault(); //or change to .ToArray();
foreach (var client in clientInfo)
{
    var client.a.t.yourfieldname;
    //or
    var client.a.yourfieldname;
} 
```

# ruby-on-rails - ElasticSearch getopt：找不到命令解析参数时出错

> ID：11959174
> 
> 赞同：1
> 
> 时间：2012-08-14T19:12:22.523
> 
> 标签：ruby-on-rails, elasticsearch

所以我从网站上下载[了 ElasticSearch](http://www.elasticsearch.org/)并将它放在我的应用程序目录中并运行命令：

```
$ bin/elasticsearch 
```

正如[指示所说](http://www.elasticsearch.org/guide/reference/setup/installation.html)，但遇到错误：

```
$ bin/elasticsearch
bin/elasticsearch: line 137: getopt: command not found
Error parsing arguments! 
```

它在文件中谈论这一行：

```
args=`getopt vfhp:D:X: "$@"` 
```

这里有什么问题？其他人有这个问题吗？

我在 Windows 7、Ruby on Rails 3.1.0 上运行。

**回答**

好的所以一开始我只是点击了文件：

```
C:\elasticsearch-0.19.8\bin\elasticsearch.bat 
```

它说我需要**JAVA_HOME 环境变量**。你可以在这里学习如何做到这一点：

```
http://stackoverflow.com/questions/2619584/how-to-set-java-home-on-windows-7 
```

执行以下操作后，现在一切正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:45:15.207

如果您正在运行 Windows，您应该运行`elasticsearch.bat`批处理文件而不是`elasticsearch`您尝试运行的 shell 脚本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T19:23:30.880

虽然 javanna 的答案是正确的，但我只想补充一点，可以像您尝试的那样使用 cygwin 运行 elasticsearch bash 脚本。您只需要安装名为 的软件包`util-linux`，默认情况下不安装该软件包。

# linux - 使用 grep 解析数据

> ID：11959175
> 
> 赞同：2
> 
> 时间：2012-08-14T19:12:27.343
> 
> 标签：linux, awk, grep

我正在尝试从 smartctl 命令获取特定数据。我想获得总的 power_on_hours，但我不想要所有的填充物。我只想要直接的时间。这是我现在想出的命令：

```
smartctl -A /dev/sda | grep Power_On_Hours 
```

我的输出类似于：

```
9 Power_On_Hours          0x0032   100   100   000    Old_age   Always       -       27 
```

我想要最后一个号码。我认为我可能会以某种方式读取到文件末尾并倒数到第一个空格或搜索到连字符并读取到文件末尾。我只是不知道我会怎么做。我对 grep 的经验太低了，不知道如何解决这个问题。我的目标是让输出类似于：

```
27 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:15:38.830

如果您可以/想要使用`awk`它很容易使用`awk '{print $NF}'`. 例如，建立在您已有的基础上：

```
smartctl -A /dev/sda | grep Power_On_Hours | awk '{print $NF}' 
```

`NF`是字段数的 awk 内置变量。使用`$NF`方法来使用该字段的内容。

*但是*`grep`，您可以通过`awk`搜索字符串来缩短（并消除）：

```
 smartctl -A /dev/sda | awk '/Power_On_Hours/ {print $NF}' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:17:56.777

您可以使用

## 两个`grep`管道

```
smartctl -A /dev/sda | grep Power_On_Hours | grep -o '[0-9]+$' 
```

第二个`grep`将仅打印匹配的部分。有时，需要三个或更多`grep`s 来隔离您要查找的内容。我将其用于快速而肮脏的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-25T21:13:01.857

FWIW，这是一个 zsh 函数，它使用 sed(1) 从 smartctl 输出中检索命名属性：

```
function get_smart_attrib() {
    local attrib="$1"
    local disk="$2"
    smartctl --attributes -f brief "$disk" \
        | sed -rn "/ $attrib /"'s/.{61}//p'
} 
```

只有声明本身是 zsh 特定的，函数体应该在大多数类似 bourne 的 shell 中工作。

也可以在纯 shell 中使用 while 读取循环来执行此操作，大致如下（未经测试）（$myattr 设置为我们要查找的属性的名称）：

```
smartctl -A -f brief /dev/sda | while read foo attrname foo foo foo foo foo value; do
    [[ "$attrname" = "$myattr" ]] && echo $value && break
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T21:39:08.093

`awk`显然是正确的工具，但您也可以这样做：

```
smartctl -A /dev/sda | grep Power_On_Hours | tr -s \  \\t | cut -f 10 
```

（注意反斜杠之间的 2 个空格，或者您可能更喜欢`tr -s ' ' '\t'`）从文本中选择特定列的两个最常用的工具是`cut`和`awk`，您应该熟悉这两个工具。 `cut`对空白比 更挑剔`awk`，并且`tr`上述管道中的目的是清理空白`cut`。 `awk`很好，因为您可以将最后一列引用为`$NF`，但`cut`您需要计算。

# visual-studio-debugging - Visual Studio 2012 - 单步执行多个项目？

> ID：11959180
> 
> 赞同：0
> 
> 时间：2012-08-14T19:12:53.487
> 
> 标签：visual-studio-debugging, projects

我在 Visual Studio 2012 的同一解决方案下有 2 个项目。

第一个是WPF项目，第二个是ASP项目。

WPF 通过 webbrowser 控件调用一个 asp 页面。无论如何我可以进入 ASP 页面背后的代码，即使它不是我的启动项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T02:54:32.280

您可以设置调试时加载的 WPF 项目*和ASP 项目。*在解决方案资源管理器中，右键单击解决方案节点并选择*Properties*。确保在左侧树中选择*Common Properties\Startup 项目。*单击*Multiple startup projects*单选按钮，然后在列表中将调试 (F5) 时要启动的项目设置为*Start*。

现在，当您按 F5 进行调试时，两个项目都将启动，您可以在两者中设置断点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T02:04:59.027

You need to attach the debbuger to corresponding ISS process. In Visual Studio:

Click "Debug" from the menu bar Click "Attach to Process" Check the "Show processes from all users" checkbox in the bottom left corner Select aspnet_wp.exe (or w3wp.exe depending on your ISS version) from the process list Click "Attach"

# c# - 检查数组成员是否存在

> ID：11959185
> 
> 赞同：3
> 
> 时间：2012-08-14T19:13:30.547
> 
> 标签：c#, arrays

全部，

考虑以下代码：

```
string message = "abc;def;ghi";
string[] msgs = message.Split(';');
string temp = msg[2] ? msg[2] : "Failed"; 
```

消息变量来自服务器并且具有不同的长度。我需要对其进行解析，以便如果该值不存在，则结果应为“失败”。

有没有简单的方法可以做到这一点？

现在这个构造给出了编译器错误：“无法将字符串转换为布尔值”。

谢谢你。

[编辑]

我猜有些人会逐字阅读这封信。;-) 我需要检查“msg”数组的任意元素是否存在，而不仅仅是 msg[2]。我可以有类似的东西：

```
string message = "abc;def";
str[] msg = message.Split( ';' );
string temp = msg[3] ? msg[3] : "Failed"; 
```

在接下来的消息处理中。

[/编辑]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T19:14:33.760

也许你想要：

```
string temp = msgs.Length > 2 ? msgs[2] : "Failed"; 
```

* * *

编辑：

对于检查任何元素，同样的工作：

```
int index = 42;
string temp = msgs.Length > index ? msgs[index] : "Failed"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:14:34.883

与 Javascript 不同，C# 不允许您将任意表达式用作布尔值。

你正在尝试写

```
msg.Length >= 3 ? msg[2] : "Failed" 
```

# javascript - javascript/jquery 生成输入元素

> ID：11959186
> 
> 赞同：3
> 
> 时间：2012-08-14T19:13:31.467
> 
> 标签：javascript, jquery, input, field, add

所以我有这个代码。我想为 javascript 人完成一些可能很简单的事情。如果选择了某个选项，则在 div 上添加一个输入字段。

```
<select name="amount" >
    <option value="50">50$</option>
    <option value="100">100$</option>
    <option value="Other">Other</option>
</select>

<div id="custom_price">

</div> 
```

所以我想在选择**“其他”**选项后添加输入字段。我知道有一个简单的方法可以解决这个问题，但我无法让它发挥作用：

```
document.getElementById('custom_price').innerHTML += "<input type="text" name="amount"/>" 
```

所以 custom_div 看起来像：

```
<div id="custom_price">
Custom price:<br>
<input type="text" name="amount"/>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T19:16:37.517

最好的方法是实际制作 dom 元素。

```
var newInput = document.createElement("input");
newInput.type="text";
newInput.name="amount";
document.getElementById('custom_price').appendChild(newInput); 
```

也许有这样的处理程序：

为您的选择分配一个 ID：`<select name="amount" id="amount">`

```
$("#amount").change( function() {
 if( $(this).val() == "Other" ){
  document.getElementById('custom_price').innerHTML = "";
  var newInput = document.createElement("input");
  newInput.type="text";
  newInput.name="amount";
  document.getElementById('custom_price').appendChild(newInput);
 }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T19:18:22.083

根据您使用 jQuery 的问题的标签来判断。所以添加一个输入是相当容易的。

```
$("select[name=amount]").change(function() {
    if ($(this).val() == 'Other') {
        $("#custom_price").append('<input type="text" name="amount"/>');
    }
}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T19:20:00.893

它是

```
document.getElementById('custom_price').innerHTML += '<input type="text" name="amount" />'; 
```

如果使用`"`_ `"`_`\"``'`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T19:17:03.087

使用 jQuery

```
$("#custom_price").empty().append('Custom price:<br><input type="text" name="amount"/>') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-14T19:17:53.727

只需将输入放在 div 内并最初隐藏 div。然后在必要时使用 jQuery/JS 显示这个 div。

```
$('select[name="amount"]').change(function() {
    if($(this).val() == 'Other') {
        $('#custom_price').show();
    } else {
        $('#custom_price').hide();
    }
});

<div id="custom_price" style="display: none;">
    <p>Custom price:</p>
    <input type="text" name="amount"/>
</div> 
```

# ruby-on-rails - Rails 3，显示来自 RAILS_ROOT 上方本地文件系统的 jpg 图像

> ID：11959203
> 
> 赞同：5
> 
> 时间：2012-08-14T19:15:04.197
> 
> 标签：ruby-on-rails, ruby, render, jpeg

我试图找出一种方法来显示来自不在 RAILS_ROOT 下的已安装文件系统（在 RedHat 或 Ubuntu 环境中）的图像。我不想使用符号链接，因为这个应用程序实际上是通过 Tomcat 部署的，而当我关闭 Tomcat 时，Tomcat 会尝试遵循符号链接并删除挂载中的所有图像。由于这些文件的数量和大小，将图像放在 public/images 下也不是一种选择。

我查看了 send_file，但这只会显示一个图像。我需要在格式良好的页面中显示 6 个请求的图像。由于膨胀，我宁愿不使用 Base64 编码，但我不知道如何将图像数据与渲染页面一起传递。

同样，问题是无法通过生成的 HTML 中的 url 访问图像，图像数据必须与页面的其余部分一起传递。我知道创建某种类型的服务来提供图像将是处理这个问题的最佳方式，但现在我只需要让它工作。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-14T21:07:37.490

出于显而易见的原因，Rails 不允许用户访问`RAILS_ROOT/public`. 当您提到 sendfile（或首选 x-sendfile）时，您实际上是其中的一部分。解决方案是让 Rails 正常提供一个 html 页面，其中包含指向提供单个文件的 Rails 操作的链接。

例如，假设我想显示来自文件系统深处某处的一些图像。首先，我必须创建一个一次提供一个图像的动作。因此，`config/routes.rb`您可以添加以下内容：

```
match '/serve_image/:filename' => 'images#serve' 
```

然后我必须创建一个控制器来匹配该路由。例如：

```
class ImagesController < ApplicationController
  def serve
    path = "/my/servers/image/path/#{params[:filename]}"

    send_file( path,
      :disposition => 'inline',
      :type => 'image/jpeg',
      :x_sendfile => true )
  end
end 
```

现在，您的图片可在以下 url 下获得：/serve_image/my_image.jpg。所以最后要做的是创建一个漂亮的 html 页面，显示所有必要的图像。它很简单：

```
<img src="/serve_image/image1.jpg">
<img src="/serve_image/image2.jpg">
<img src="/serve_image/image3.jpg">
<img src="/serve_image/image4.jpg"> 
```

# javascript - 使用 jquery 的高级重置表单

> ID：11959204
> 
> 赞同：0
> 
> 时间：2012-08-14T19:15:09.643
> 
> 标签：javascript, jquery, forms, field, reset

当您尝试注册并且将某些内容保留为空白/未填写时，您会收到错误消息。（来自 PHP）。已填写内容的输入字段会被记住（Smarty `{if isset($smarty.post.registratie.naam)} value="{$smarty.post.registratie.naam}"{else}value="Naam:"{/if}`：）

问题：在注册尝试失败后，我输入字段的默认值最初是“Naam：”，“Voornaam：”，“Email：”已更改为用户输入的值。（例如“Frederik ")

示例：[http ://www.pixsters.be/index.php?page=registratie](http://www.pixsters.be/index.php?page=registratie)

使用我的 Jquery 代码，我清除了有默认值的字段，尽管我不想清除用户填写的字段。

jQuery代码：

```
function clearField(e)
{
    if($(this).val() == this.defaultValue)
    {
        $(this).val('');
    }

}

function resetField(e)
{
    if($(this).val() == '')
    {
        this.value = this.defaultValue;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:33:24.907

我认为隐藏字段标题是一个糟糕的界面设计理念。在某些时候，用户将无法分辨某些字段的用途。考虑改变设计。

如果您仍然想坚持使用它，只需在输入字段中添加默认值，例如：

```
<form id="my-form">
    <input type="text" data-default-value="Enter your name:" name="name" value="{$form.name}">
</form>

$(document).ready(function() {
    // Iterating through all form elements.
    $.each('#my-form input[type="text"]', function() {
        // Adding event listener and calling it afterwards to fill the inputs initially.
        $(this).change(function() {
            var $Input = $(this);
            // If element value is not set (empty), then using default value.
            if ($Input.val() == '') {
                $Input.val($Input.attr('data-default-value'));
            }
        }).change();

    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:36:51.107

问题是当新页面加载时，输入的值已经变成了`defaultValue`s。相反，您可以使用该`placeholder`属性（还有一些适用于旧浏览器的插件）：

```
<input placeholder="Naam:" ...> 
```

这将在没有任何 JavaScript 的情况下键入内容时自动处理消失，并且它不会受到您的问题的影响。

不过，您可能希望保持黑色：

```
/* add other prefixes if necessary */
input::-webkit-input-placeholder { color: black; } 
```

# javascript - 在 Javascript 中获得 Date.UTC() 的结果后，我可以将其转换回可读的日期格式吗？

> ID：11959209
> 
> 赞同：2
> 
> 时间：2012-08-14T19:15:19.903
> 
> 标签：javascript, date, datetime, highcharts, date-format

我正在使用 Highcharts JS 库，尤其是 Highstock 图表之一：http://www.highcharts.com/stock/demo/compare[我](http://www.highcharts.com/stock/demo/compare)正在可视化 [Date.UTC(year,月、日、小时、分钟）、值）。

当有人单击特定点时，我想获取与该点对应的日期。但是，Date.UTC() 格式返回指定日期和 1970 年 1 月 1 日午夜之间的毫秒数。

**我的问题是**：有没有办法将这个数字转换为我可以阅读和理解的日期字符串？例如 convert(1340628120000) 返回 -> 2012, 6 (month), 25(day), 15(hour), 42(minutes) ?

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:19:13.460

是的，使用[dateFormat](http://www.highcharts.com/ref/#highcharts-object)。HighCharts 文档非常好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:24:03.203

如果您使用这些毫秒创建 Date 变量，则可以使用 .toLocaleString() 将其转换回可读格式。函数列表[在这里](http://www.w3schools.com/jsref/jsref_tolocalestring.asp)。

像这样使用它：

```
var a = new Date(YOUR_UCT_VALUE);
a = a.toLocaleString(); 
```

一个示例输出可能是：

> 2012 年 8 月 14 日星期二 15:24:24 GMT-0400（东部夏令时间）

不知道这是否是你想要的，但内置的 JavaScript Date 有很多好的函数，比如 getHours()、getMinutes() 等。你所要做的就是用你得到的毫秒数创建一个日期对象. 之后，JavaScript 会为您完成所有工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T19:28:30.127

```
var utcSeconds = 1234567890;
var dateFormat = new Date(0); // The 0 sets the date to the epoch
dateFormat.setUTCSeconds(utcSeconds); 
```

输出：2009 年 2 月 13 日星期五 18:31:30 GMT-0500（东部标准时间）

[日期（）; 参考](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)

# java - maven-surefire-plugin 包含/排除优先级

> ID：11959211
> 
> 赞同：21
> 
> 时间：2012-08-14T19:15:30.180
> 
> 标签：java, maven, maven-3, pom.xml, maven-surefire-plugin

当使用 maven-surefire-plugin 并且包含和排除时，它们按什么顺序处理？此外，如果您有 3 组测试，第一组是基本组，第二组和第三组是特殊情况，您可以使用配置文件进一步包含/排除吗？配置文件包含/排除设置将如何合并？例如，我想做这样的事情：

```
 <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>2.12.2</version>
        <configuration>
          <excludes>
            <exclude>/org/mycompany/dataset/test/ExtractProd*.java</exclude> <!-- requires special network connectivity -->
            <exclude>/org/mycompany/dataset/test/LargeDataset*.java</exclude> <!-- requires lengthy processing -->
          </excludes>
        </configuration>
      </plugin>
    </plugins>
  </build>

  <profiles>
    <profile>
      <id>connectedToProdNetwork</id>
      <build>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <configuration>
              <includes>
                <include>/org/mycompany/dataset/test/ExtractProd*.java</include>
              </includes>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>runForAsLongAsYouNeed</id>
      <build>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <configuration>
              <includes>
                <include>/org/mycompany/dataset/test/LargeDataset*.java</include>
              </includes>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
  </profiles> 
```

然后能够像这样运行：

```
mvn package -P connectedToProdNetwork 
```

或者

```
mvn package -P runForAsLongAsYouNeed 
```

或者

```
mvn package -P connectedToProdNetwork,runForAsLongAsYouNeed 
```

**- - 更新 - - -**

使用`mvn help:effective-pom -P [profileA]`我能够确定，如果我指定单个配置文件，则生成的有效 pom 将是：

```
 <configuration>
          <includes>
            <include>[includeFromProfileA]</include>
          </includes>
          <excludes>
            <exclude>/org/mycompany/dataset/test/ExtractProd*.java</exclude> <!-- requires special network connectivity -->
            <exclude>/org/mycompany/dataset/test/LargeDataset*.java</exclude> <!-- requires lengthy processing -->
          </excludes>
        </configuration> 
```

如果我提供多个配置文件，则`mvn help:effective-pom -P [profileA],[profileB]`：

```
 <configuration>
          <includes>
            <include>[includeFromProfileAOrBSeeminglyArbitraryChoice]</include>
          </includes>
          <excludes>
            <exclude>/org/mycompany/dataset/test/ExtractProd*.java</exclude> <!-- requires special network connectivity -->
            <exclude>/org/mycompany/dataset/test/LargeDataset*.java</exclude> <!-- requires lengthy processing -->
          </excludes>
        </configuration> 
```

最后，如果我将属性添加[`combine.children="append"`](http://www.sonatype.com/people/2011/01/maven-how-to-merging-plugin-configuration-in-complex-projects/)到配置文件配置的`<includes>`元素中，并提供两个配置文件，则`mvn help:effective-pom -P [profileA],[profileB]`：

```
 <configuration>
          <includes combine.children="append">
            <include>[includeFromProfileA]</include>
            <include>[includeFromProfileB]</include>
          </includes>
          <excludes>
            <exclude>/org/mycompany/dataset/test/ExtractProd*.java</exclude> <!-- requires special network connectivity -->
            <exclude>/org/mycompany/dataset/test/LargeDataset*.java</exclude> <!-- requires lengthy processing -->
          </excludes>
        </configuration> 
```

但是，既然每个文件都被指定为 an`<include>`和 an `<exclude>`，会发生什么？

**---- 更新 2 ----**

实际上使用此配置运行构建：

```
<configuration>
  <includes>
    <include>**/TestA.java</include>
  </includes>
  <excludes>
    <exclude>**/TestA.java</exclude>
  </excludes>
</configuration> 
```

不运行***TestA***，所以它看起来`<exclude>`会压倒`<include>`. *请注意，为了完整起见，我确实颠倒了顺序并放在`<excludes>`前面，`<includes>`但行为没有改变。* 如果有人可以找到概述此行为的源代码之外的某个地方，我很乐意为他们提供答案...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-11-27T23:01:02.670

我找不到关于 surefire 插件的官方文档，但确实 exclude-override-include 是一种常见的方法，Maven 也将其应用于其他类似的上下文中，例如资源。

唯一官方的相关信息（我发现）来自官方的 Maven POM 参考文档，[这里](https://maven.apache.org/pom.html)：

> **include**：一组文件模式，指定要作为资源包含在该指定目录下的文件，使用 * 作为通配符。
> 
> **excludes**：与包含相同的结构，但指定要忽略的文件。**在 include 和 exclude 之间的冲突中， exclude wins**。

注意：我在有趣的语句上添加了最后的粗体格式。

因此，在官方 maven 插件中很可能使用相同的方法（通常，所有具有 org.apache.maven.plugins groupId 和 maven- 前缀作为 artifactId 的插件）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-09T10:16:22.377

您是否尝试过使用[JUnit 类别](https://web.archive.org/web/20160306090644/http://www.agile-engineering.net/2012/04/unit-and-integration-tests-with-maven.html)？

使用这种方法，您可以为测试提供许多不同的类别，并使用它而不是类名来排除/包含它们。这将是一种更可扩展的方法。

# c# - 带有自己元组的字典

> ID：11959212
> 
> 赞同：0
> 
> 时间：2012-08-14T19:15:31.950
> 
> 标签：c#, .net-3.5, dictionary, namespaces

我正在使用`.Net Framework 3.5`.

我需要类似 a 的东西`Tuple`，但是我没有它，我使用它创建了自己的元[组](https://stackoverflow.com/questions/7120845/equivalent-of-tuple-net-4-for-net-framework-3-5)

所以我有

```
public class Tupla<T1, T2>
        {
            public T1 First { get; private set; }
            public T2 Second { get; private set; }
            internal Tupla(T1 first, T2 second)
            {
                First = first;
                Second = second;
            }
        }

        public static class Tupla
        {
            public static Tupla<T1, T2> New<T1, T2>(T1 first, T2 second)
            {
                var tuple = new Tupla<T1, T2>(first, second);
                return tuple;
            }
        } 
```

然后，我需要将 a 之类的东西`Dictionary`与我的其他代码一起使用。对于每个`Key`，我需要返回一个`Tupla`，填充值。

所以，我创建了我的`class`

```
public class ParametrosMultiples : Dictionary<String, Tupla>
    {

    } 
```

但它不认识我的`Tupla class`. 据我所见，我可以使用自定义`clases`（不仅是`types`，喜欢`String`，`Int32`等）

我得到的错误是

> 找不到类型或命名空间名称“Tupla”（您是否缺少 using 指令或程序集引用？）

但是它们在同一个命名空间中，甚至在同一个命名空间中`.cs`（我只提到它是为了确保它们在同一个命名空间中`namespace`，因为我们只使用一个`namespace`来`.cs`进行约定）

如果我不能使用它`Tupla`，我如何从 a 中检索两个值`Key`？

**编辑：**

为了展示我是如何上课的：

```
namespace ReportesWeb.WebApp.App_Shared
{
 public class ParametrosMultiples : Dictionary<String, Tupla<Int32, Int32>>
 {
 }

// here goes the Tupla code showed above, the two classes

} 
```

**编辑2：**

我已经删除了`Static Tupla`（只留下 One `Tupla Class`）并且仍然得到相同的错误，所以不是与名称冲突的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:18:00.777

您需要指定`Tupla`类的通用参数。

```
public class ParametrosMultiples : Dictionary<String, Tupla<type1,type2>>
{

} 
```

尽管您收到的错误似乎表明该类位于未引用的单独程序集中，或者（如果已引用或位于同一程序集中），您尚未将其所在的命名空间导入需要将其与[`using`指令](http://msdn.microsoft.com/en-us/library/sf0df423.aspx)一起使用的类。

您似乎还有两个具有相同名称的独立类（一个静态类和一个“普通”类） - `Tupla`。这肯定会导致命名冲突。考虑更改其中一个的名称，或将功能合并到单个类中。

# javascript - AngularJS数据绑定值直接进入href

> ID：11959213
> 
> 赞同：0
> 
> 时间：2012-08-14T19:15:34.577
> 
> 标签：javascript, data-binding, angularjs

我不确定这是否是 AngularJS、Firefox、Chrome 的错误，或者它是否只是一个怪癖......但是，

当我做这样的事情

```
<a href="#/{{list.UUID}}/{{routeParams.status}}"> ... 
```

在**Chrome**中，我通过正确的方式获取值绑定，例如

```
...#/fa778108-5a0c-4675-974e-4cae0d9d6a86/active` 
```

但是在**Firefox**中我得到了这个

```
... #/{{list.UUID}}/{{routeParams.status}} 
```

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:15:34.577

我发现的“解决方案”是使用`<a ng-href=" ...`，但我仍然想知道*为什么*它不能始终如一地工作......

# php - 通过访问另一个页面来销毁会话 - php

> ID：11959217
> 
> 赞同：0
> 
> 时间：2012-08-14T19:15:41.543
> 
> 标签：php, session

我想销毁不同页面上的一个会话。所以基本上当我将访问者重定向到（例如“success.php”）时，无论何时离开，会话都会被销毁。

```
if(isset($_SESSION["log"])) {
  $from_date = $_SESSION["log"];
  $minute = 30 - round(abs($date - $from_date) / 60,2);
  $ips = explode("/", $ip_sessions);
  if(in_array($ip, $ips) && $minute > 0 && $minute < 30) {
    $valid = true;
  } else {
    session_destroy();
  } 
```

所以我只想拥有另一个包含其他内容的页面“success.php”，但是访问此页面会破坏上面“index.php”上的会话。

谁能帮我编写代码以在新页面上销毁此会话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:18:02.003

```
session_destroy(); 
```

[http://php.net/manual/en/function.session-destroy.php](http://php.net/manual/en/function.session-destroy.php)

这就是您所需要的，还是我完全误解了您的问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:20:19.780

我相信你也许还可以使用`unset($mySession)`来破坏一个特定的变量。

# ruby - Ruby Gem 电子表格 - 格式问题

> ID：11959228
> 
> 赞同：1
> 
> 时间：2012-08-14T19:16:21.490
> 
> 标签：ruby, gem, spreadsheet

我正在将数据从另一个 Excel 工作表写入 Excel 工作表。但是，列的数据可能如下所示：

*   `$0.00`
*   `The amount owed at time of service is $33`
*   `20%`
*   或空字符串。

我的问题是，当我将其写入文件时，Excel 将该列标记为“常规”以进行格式化，并且剥离了`$`and`%`并使其成为`0.2`. 有没有办法将格式设置为纯字符串，以便在我写入电子表格时保持数据完整？

我是 Ruby 新手，所以如果您在代码中看到任何应该以其他方式完成的内容，请告诉我。

代码示例：

```
def self.add_data(new_book_sheet, old_book_sheet)
  row_index = 9
  header_row = 0
  old_book_sheet.each do |row|
    if header_row > 0
      column_index = 0
      row.each do |column|
        new_book_sheet.row(row_index).insert(column_index, column)
        column_index += 1
      end
      row_index += 1
    end
    header_row = 1
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T21:07:14.773

所以问题是，当它从原始 excel 文件中读取数据时，如果它只是一个“数字”类型，它会以这种方式读取它，所以 0.00 美元将其读取为 0。我认为问题出在写作数据，但实际上是在读取数据时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T22:31:12.937

在输出前添加撇号，Excel 会将其解释为文本。我在 Excel 中测试了以下内容（直接在电子表格中，不使用 gem），所有内容都被解释为字符串：

*   `'$0.00`
*   `'The amount owed at time of service is $33`
*   `'20%`
*   `'`

# ruby-on-rails - 建立 Rails 应用程序的备忘单

> ID：11959232
> 
> 赞同：0
> 
> 时间：2012-08-14T19:16:41.683
> 
> 标签：ruby-on-rails

是否有用于建立 Rails 应用程序的备忘单（脚手架可以）我需要的是 1 个名为 users 的数据库，其中包含 2 个字段名称和电子邮件作为字符串字段。我需要以下命令：

```
rails new app_name 
```

至：

```
localhost:3000/users 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T20:19:44.693

快速谷歌搜索`rails cheat sheet`给了我这个，看起来相当不错：[http ://blog.envylabs.com/post/29044764623/rails-3-cheat-sheets](http://blog.envylabs.com/post/29044764623/rails-3-cheat-sheets)

从`rails new app_name`到`localhost:3000`我认为命令将是这样的（当脚手架时）：

```
rails new app_name
cd app_name
rails generate scaffold user name:string email:string
rake db:migrate
rails server 
```

顺便说一句，尝试只运行一个不带参数的命令来阅读文档和使用示例，例如，或者`rails`在app_name**目录**中`rails generate``rails generate scaffold`

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T05:36:37.150

熟悉 Rails 框架后发现的一个资源是[Ruby on Rails Tutorial](http://ruby.railstutorial.org/)。在线书籍是免费的，从我所阅读的内容来看，似乎涵盖了所有基础。因为这是一本您可以按照自己的节奏阅读的书，但如果您愿意，他确实会提供截屏视频。

另一个有教程的网站是[PeepCode](https://peepcode.com/)。他们有两个关于学习 Rails 3 的截屏视频。

1.  [认识 Rails 3（第 1 部分）](https://peepcode.com/products/meet-rails-3-i)
2.  [认识 Rails 3（第 2 部分）](https://peepcode.com/products/meet-rails-3-ii)

我从来没有特别关注过这两个教程，但我确实在 2007 年左右购买了他们的两个教程，名为[Rails from Scratch](https://peepcode.com/products/rails-from-scratch-part-i)。但是，不要购买这些，因为 Rails 框架从那时起发生了很大的变化。

* * *

我知道我没有给你一个命令列表，但是学习 Rails 命令的一部分就是学习框架本身。这是[Rails 命令行](http://guides.rubyonrails.org/command_line.html)指南。**

# windows-7 - Windows批处理文件中的“系统错误53”陷阱？

> ID：11959233
> 
> 赞同：0
> 
> 时间：2012-08-14T19:16:41.940
> 
> 标签：windows-7, batch-file

我正在编写一个批处理文件，它将发送到多个用户的计算机并将一些日志文件拉回我自己的计算机；但是，我试图弄清楚当他们的计算机离线并且我收到“系统错误 53”消息时如何“捕获”案例。这是我正在迭代的命令的示例：

```
:Lea
robocopy "\\jcjcjq1\c$\Program Files\PigCHAMP\logs" "C:\Users\mikec\Documents\@Department\Financial Services\Service Requests\PigChamp_Logs" /XO
ECHO "Lea's Logs - Copy Complete"
PAUSE 
```

我曾尝试使用 IF ERRORLEVEL ... 类型的陷阱，但我认为系统会在达到 SEL 53 时继续重试，并且不会爆发返回 ERRORLEVEL。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T00:05:39.137

如果您在他们的计算机处于离线状态时根本不想尝试 robocopy，请尝试以下操作：

```
ping -n 1 jcjcjq1 >nul && robocopy "\\jcjcjq1\c$\Program Files\PigCHAMP\logs" "C:\Users\mikec\Documents\@Department\Financial Services\Service Requests\PigChamp_Logs" /XO 
```

# java - 如何在另一个类中使用数组纹理？

> ID：11959239
> 
> 赞同：2
> 
> 时间：2012-08-14T19:17:05.007
> 
> 标签：java, swing

我需要能够在类中使用数组`texture[]`（位于`Textures`类中）中的变量`Board`。但我不知道我将如何去做。

这只是我试图弄清楚如何`Textures`在 Java 中添加东西，我正在尝试学习如何制作游戏。所以我很菜哈哈。

这是我想在其中使用`texture[]`数组的类。

```
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Image;
import javax.swing.ImageIcon;
import javax.swing.JPanel;

public class Board extends JPanel{

    public Board(){

    }

    public void paint(Graphics g){
        g.drawImage(texture[1], 0, 0, null);
        g.setFont(new Font("Verdana", 0, 50));
        g.setColor(Color.YELLOW);
        g.drawString(": FPS", 20, 50);
    }

    public void update(){
        repaint();
    }
} 
```

这是创建`texture[]`数组的类。

```
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;

public class Textures {

    BufferedImage img;
    private int w, h;
    public int id[];
    public Image texture[];

    public Textures() throws IOException {
        URL url = this.getClass().getResource("Resources/Textures.png");
        img = ImageIO.read(url);
        w = 0;
        h = 0;
        for(int i1 = 0; i1 < 16; i1++){
            texture[i1] = img.getSubimage(w, h, 16, 16);
            id[i1] = i1;
            w += 16;
            h += 16;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:24:40.923

由于您的`texture`变量是公开的，因此只需执行以下操作：

```
texturesClassInstance.texture; 
```

用另一种方式：

```
public class Board extends JPanel{

    public void someMethod(){

        Textures texturesClassInstance = new Textures();

        Image image1 = texturesClassInstance.texture[0];
        Image image2 = texturesClassInstance.texture[1];

        //do something with image1 and image2
    }
} 
```

在`Board`类中，但最好将其声明为`private`并创建一个方法，如：

```
public class Textures {

    // more variables
    private Image texture[];

    // more code

    public Image[] getTextures(){
        return this.texture;
    }

} 
```

# java - 使用 JPA 检查表属性（即大小）

> ID：11959240
> 
> 赞同：1
> 
> 时间：2012-08-14T19:17:06.807
> 
> 标签：java, mysql, jpa, orm

我正在使用 JPA 做 ORM。但是，我特别想做的一件事是还能够检查正在管理的表的大小。是否有任何简化的方法，或者我是否需要保留一组单独的 JDBC 脚本来执行更传统的数据库管理工作？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:18:56.277

什么尺寸？你的意思是行数？您显然可以通过“SELECT COUNT(p) FROM Person p”获得。JPA 不做数据存储的物理大小，因此您必须有一些本机查询才能获得它（也特定于数据存储）。

# performance - 有没有更快的方法来使用 AS3 检查 BitmapData.getPixel32()？

> ID：11959243
> 
> 赞同：1
> 
> 时间：2012-08-14T19:17:22.690
> 
> 标签：performance, actionscript-3, actionscript, bitmap, bitmapdata

我正在使用常规方法来检查透明位图上的随机/单个像素是否非零，使用`bitmapData.getPixel32(x,y)!=0`

但是有没有更快的方法来做到这一点，因为这有点重性能。我认为必须有办法做到这一点，也许使用 byteArray？

我怎样才能以最好的方式做到这一点？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T07:48:41.533

您可以找到一篇非常有趣的文章，介绍使用矢量和 getVector 方法处理像素。

Mike Chambers 在 Grant Skinner 的性能工具的帮助下对此进行了案例研究，并正在寻找提高 AS3 性能的方法。在这里阅读所有相关信息：

[http://www.mikechambers.com/blog/2009/10/13/case-study-actionscript-3-performance-optimization/](http://www.mikechambers.com/blog/2009/10/13/case-study-actionscript-3-performance-optimization/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:31:53.310

您也许可以通过使用 bitmapData.getColorBoundsRect() 并检查非透明像素来加快速度。

然后您只需要检查边界矩形*内*的像素，因为您知道矩形外的所有像素都必须是透明的。

```
// returns bounds rectangle for all non transparent pixels
bitmapData.getColorBoundsRect(0xFFFFFFFF, 0x000000, false); 
```

# ruby-on-rails - 当 post 失败时，防止 rails 更改 url 的控制器部分

> ID：11959244
> 
> 赞同：1
> 
> 时间：2012-08-14T19:17:27.537
> 
> 标签：ruby-on-rails

我有一个会话控制器，具有 :new、:create 和 :delete 操作。我还有一个检查当前页面控制器的方法：

```
def controller_for(path)
  Rails.application.routes.recognize_path(path)[:controller]
end 
```

通常，此方法可以正常工作，但是如果用户访问`/login`并使用不正确的登录详细信息登录，则 rails 会将 url 更改为`/sessions`并呈现`:new`操作，此时我上面的方法会引发错误

```
No route matches "/sessions" 
```

似乎`recognize_path`正在尝试这样做：

```
>> r = Rails.application.routes
>> r.recognize_path "/sessions"
=> {:controller=>"sessions", :action=>"index"} 
```

由于我没有索引操作，因此会导致错误。我真正想要的是：

```
>> r.recognize_path "/login"
=> {:controller=>"sessions", :action=>"new"} 
```

那么如何强制 rails 将 url 保留为`/login`登录失败时的 URL，而不是将其更改为`/sessions`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:41:12.960

问题是您使用的是宁静的路线。当您发布登录表单时，您正在“创建”一个会话，这是通过 POST 到 /sessions 来实现的。这是针对`SessionsController#create`. /login 是一个单独的、自定义的、非静态路径，它被发送到`SessionsController#new`，基本上是 /sessions/new 的别名。

`recognize_path`当环境没有另外说明时，默认将路径解释为 GET 请求。并且 GET 请求假定`/sessions`意味着索引视图。

```
# The recognize_path method in the Rails source:
def recognize_path(path, environment = {})
  method = (environment[:method] || "GET").to_s.upcase
  ...
end 
```

解决此问题的一种方法是更改​​路由。例如，您可以将其添加到您的路线中：

```
match "/process_login" => "sessions#create", :as => 'process_login' 
```

然后更改您的登录表单以匹配：

```
<% form_tag process_login_path do %>
  [your login form here]
<% end -%> 
```

现在您将表单发布到 /process_login 而不是 /sessions，并且识别器应该正确解释路径。

# javascript - 如何让对象原型中的自执行函数为 JavaScript 中的所有子对象自动运行？

> ID：11959245
> 
> 赞同：1
> 
> 时间：2012-08-14T19:17:30.300
> 
> 标签：javascript, backbone.js

父对象的每个“子”都需要订阅事件聚合器中的固定事件：例如：

```
var dispatcher = EventAggregator.create(); 
```

应用程序中有多个“视图”，所有视图都必须订阅关闭事件。使用主干：

```
Backbone.View.prototype.close = function(){
  //close logic
}; 
```

现在每个视图都需要订阅事件聚合器上的“关闭”事件，即`var dispatcher`不需要显式调用方法来完成它。那不是经常说：

`dispatcher.on('close', this.close)`或者`ParentView.prototype.someMethod.apply()`

在作为 Backbone.View 实例的每个视图中，有没有办法让所有视图自动订阅`close`调度程序上的事件？

像这样的东西可以工作吗：（在我的情况下似乎没有，因为`this`绑定到窗口:)

```
Backbone.View.prototype.subscribeClose: (function(){
 dispatcher.on('close',this.close);
})(); 
```

由于`this`绑定到窗口，因此失败。有什么更好的方法来解决这个问题，还是我必须手动调用父/原型方法以确保订阅总是发生？JS中是否有我可能不知道的“另一种”方式？

**更新**：添加[小提琴](http://jsfiddle.net/nupul/jF2Va/4/)这两个视图都应该在“olay”上触发，但只有一个`subscribeOnClose`添加到原型的视图似乎工作正常（根据 Dan 的回答进行实验）。但是，这两个视图**都不**响应触发器。现在只是用模型模拟触发器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T22:01:35.417

# 更新

I didn't want to bring this out unless really necessary, but if you really want this to apply to *all* view instances, without the need to have them descend from your own custom base view class, you can try something like this (overriding `Backbone.View`, the built-in base view class constructor):

[http://jsfiddle.net/D9gR7/5/](http://jsfiddle.net/D9gR7/5/)

```
$( document ).ready( function () {

  // Create your actual object here

  var dispatcher = _.clone( Backbone.Events );

  ( function () {

    var ctor = Backbone.View;

    Backbone.View = Backbone.View.extend( {

      constructor : function ( options ) {

        ctor.apply( this, arguments );

        dispatcher.on( 'close', this.close, this );

      },
      // constructor

      close : function () {

          console.log( this.cid );

      }
      // close

    } );

    Backbone.View.prototype.constructor = Backbone.View;

  } )();

  var View = Backbone.View.extend( {} );

  var views = [];

  var i;

  for ( i = 0 ; i < 10 ; ++i ) {

    views.push( new Backbone.View );

  }

  for ( i = 0 ; i < 10 ; ++i ) {

    views.push( new View );

  }

  dispatcher.trigger( 'close' );

} ); 
```

# Original Answer

There are a bunch of issues with your code. What about something like this (see the console for output, obviously)? I think this is pretty much what you're going for. You'd just need to make sure you call the parent `initialize()` when you override the method in sub classes. Also, if you want to completely blow away the view instances at some point, make sure you call `dispatcher.off( null, null, view_instance )`.

[http://jsfiddle.net/D9gR7/](http://jsfiddle.net/D9gR7/)

```
$( document ).ready( function () {

  // Create your actual object here

  var dispatcher = _.clone( Backbone.Events );

  var View = Backbone.View.extend( {

    initialize : function ( options ) {

      dispatcher.on( 'close', this.close, this );

    },

    close : function () {

      console.log( this.el.id );

    }

  } );

  var Some_Kind_Of_View = View.extend( {

    initialize : function ( options ) {

      View.prototype.initialize.apply( this, arguments );

      // ...

    }

  } );

  var view1 = new View( {

    el : $( "#MyDiv" )[0],

  } );

  var view2 = new Some_Kind_Of_View( {

    el : $( "#MyDiv2" )[0]

  } );

  dispatcher.trigger( 'close' );

} ); 
```

Some issues with your example code:

```
var V1 = Backbone.View.extend({

    // JMM: If you pass `el` to `extend()`, any instances you create
    // from the class will be tied to the same DOM element, unless
    // you pass a different `el` to the view constructors. Maybe
    // that's what you want.

    el: '#MyDiv',

    initialize: function() {
        var self = this;

        // JMM: You're assigning `undefined` to this prototype
        // property. And you're trying to register the
        // return value of self.alert() (`undefined`) as
        // the handler for the `olay` event.

        Backbone.View.prototype.subOnClose = (function(){
            model.on('olay',self.alert('olay'));
        })();
    },

    alert: function(s) {
        alert('V1 -->' + s);
    }
}); 
```

# javascript - 链接询问的对象

> ID：11959256
> 
> 赞同：1
> 
> 时间：2012-08-14T19:18:00.213
> 
> 标签：javascript, coffeescript

我花了一些时间在我认为是错误的事情上，直到找到解决方法。

我仍然不明白为什么以前的代码失败了。

请问有什么见解吗？

失败代码：

```
getModule: ->
  Gmaps4Rails.Google

createMap : ->
  new @getModule().Map() 
```

工作代码：

```
constructor:
  @module = @getModule()

getModule: ->
  Gmaps4Rails.Google

createMap : ->
  new @module.Map() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:25:08.117

原因是这`new anonymous function`与`new Gmaps4Rails.Google()`JavaScript 中的不同。

```
// Translated JavaScript code (simplified):

var your_module = {
    getModule: function() {
        return Gmaps4Rails.Google;
    },
    createMap: function() {
        // This is where things go wrong
        return new this.getModule().Map();
    }
}; 
```

问题是`return new this.getModule().Map();`转换为`return new function() { return Gmaps4Rails.Google; }`-*忽略*返回值并使用`this`（这是从匿名函数继承的新对象）。因此，该行本质上转换为`return {}.Map();`由于对象没有`Map`方法，因此您会收到错误。

当您设置`@module`为`Gmaps4Rails.Google`then 的引用时，当您调用时，`new @module.Map()`您实际上是在调用`new Gmaps4Rails.Google`- 它返回一个具有`Map`方法的对象 - 因此一切正常。

# java - STS IDE、Maven、谷歌番石榴

> ID：11959260
> 
> 赞同：1
> 
> 时间：2012-08-14T19:18:22.797
> 
> 标签：java, spring, guava

我正在尝试通过 Spring 的 STS IDE 和 Maven 下载最新版本的 Google Guava。当我单击添加并搜索工件 ID：“番石榴”时，我只得到版本 11 的结果（见下文）。版本 13 是最新版本。有什么想法吗？

![在此处输入图像描述](../Images/fca706afeaabe9c62b7e3974f8fb6958.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T07:30:07.097

右键单击 Maven 存储库视图中的全局存储库，然后单击启用完整索引（警告：慢）。

或者，只需手动输入新版本号。作为下一个构建的一部分，它将搜索并下载 jar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:29:41.080

可能 Eclipse 需要更新 Maven 索引。

# c# - 在 C# 和 C++ 之间共享 Visual Studio 资源

> ID：11959266
> 
> 赞同：2
> 
> 时间：2012-08-14T19:18:52.010
> 
> 标签：c#, c++, visual-studio-2008

我有一个 Visual Studio 2008 解决方案，主要是 C# 和一些遗留 C++ 项目。

我在 C# 项目中使用的 Resource.resx 文件中有一个资源，并且也想在 C++ 项目中使用。

有人有什么建议吗？

# android - for循环内部for循环错误

> ID：11959270
> 
> 赞同：1
> 
> 时间：2012-08-14T19:19:06.790
> 
> 标签：android, for-loop

在 Android 应用程序中，我想为第一个和第二个按钮分配不同的标签（在你按下任何一个按钮之后）。我的代码如下。LogCat 向我展示了它执行一次内部 for 循环，然后关闭 VM 并给出消息***"threadid=1: thread exists with uncaught exception (group=0x409961f8)"***。谢谢你的帮助。

```
int marked = 0;
    int i = 0;
    int a = i + 1;

    for ( i = 0; i < priorities.size(); i++ ) 
    {
            Log.d(TAG, "Setting button one tag: " + i );
            Log.d(TAG, "blablabla rank2 " + priorities.get(i).rank);
            button_one.setTag(i);
            button_one.setText(priorities.get(i).name);

            for (a = i + 1; a <= priorities.size(); a++)
            {
            Log.d(TAG, "Setting whilee: " + i );
            Log.d(TAG, "blablabla while " + priorities.get(i).rank);
            button_two.setTag(a);
            button_two.setText(priorities.get(a).name);

            }       
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:26:55.327

我不能确定，但​​我不认为你真的想在这种情况下使用嵌套的 for 循环。您可能想要这个：

```
int marked = 0;
int i = 0;
int a = i + 1;

for ( i = 0; i < priorities.size(); i++ ) 
{
        Log.d(TAG, "Setting button one tag: " + i );
        Log.d(TAG, "blablabla rank2 " + priorities.get(i).rank);
        button_one.setTag(i);
        button_one.setText(priorities.get(i).name);

        Log.d(TAG, "Setting whilee: " + i );
        Log.d(TAG, "blablabla while " + priorities.get(i).rank);
        button_two.setTag(i);
        button_two.setText(priorities.get(i).name);
} 
```

如果您确实需要嵌套循环，那么您与循环计数器不一致（外循环索引为零，但内循环索引为一，并且您正在对相同类型的对象进行操作。在这种情况下你想要这个：

```
int marked = 0;
int i = 0;
int a = i + 1;

for ( i = 0; i < priorities.size(); i++ ) 
{
        Log.d(TAG, "Setting button one tag: " + i );
        Log.d(TAG, "blablabla rank2 " + priorities.get(i).rank);
        button_one.setTag(i);
        button_one.setText(priorities.get(i).name);

        for (a = i; a < priorities.size(); a++)
        {
            Log.d(TAG, "Setting whilee: " + i );
            Log.d(TAG, "blablabla while " + priorities.get(i).rank);
            button_two.setTag(a);
            button_two.setText(priorities.get(a).name);
        }       
} 
```

虽然我不是 100% 确定。如果没有对所有变量的定义（什么是 button_one 和 button_two？什么是优先级？），就很难分辨。

# zend-framework - Zend Framework InArray 验证器数组语法

> ID：11959272
> 
> 赞同：3
> 
> 时间：2012-08-14T19:19:19.143
> 
> 标签：zend-framework, zend-validate

我的目标是验证 URL 中传递的参数，因此我创建了一个 validate 方法，其中包含要运行的验证器列表，如下所示：

```
$validators = array(
        'number' => array(
            'digits',
            'presence' => 'required',
            'messages' => array(
                "%value%' is not a valid number.",
            ),
        ),
        'country' => array(
            'presence' => 'required',
            'InArray' => array('haystack' => array('USA', 'CAN', 'AUS', 'JPN')),
            'messages' => array(
                "'%value%' is not a valid country code.",
            ),
        ),
        // etc. 
);

$valid = new Zend_Filter_Input(array(), $validators, $data);
return $valid->isValid() 
```

问题是“InArray”验证器什么都不做。它不会引发任何错误，它只是不起作用。我假设我的语法错误。

'InArray' 验证器的正确语法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T20:31:15.397

要将其他规则和属性传递给要与 一起使用的验证器`Zend_Filter_Input`，请创建对象的具体实例并将其设置为您的验证器，如下所示：

```
 $validators = array(
            'number' => array(
                    'digits',
                    'presence' => 'required',
                    'messages' => array(
                            "%value%' is not a valid number.",
                    ),
            ),
            'country' => array(
                    new Zend_Validate_InArray(
                        array('haystack' => array('USA', 'CAN', 'AUS', 'JPN'))
                    ),
                    'presence' => 'required',
                    'messages' => array(
                            "'%value%' is not a valid country code.",
                    ),
            ),
            // etc.
    ); 
```

您必须这样做的原因是因为在使用验证器时没有用于设置 haystack 的[过滤器元命令。](http://framework.zend.com/manual/en/zend.filter.input.html#zend.filter.input.metacommands)`InArray`有一些基本的元命令适用于许多验证器，但 haystack 不是其中之一。

要指定干草堆，`Zend_Validate_InArray`请使用 require 选项直接创建一个新对象，并将该验证器传递给给定的验证器数组`Zend_Filter_Input`。

# html - MP4 视频无法在网站上加载

> ID：11959279
> 
> 赞同：0
> 
> 时间：2012-08-14T19:19:52.203
> 
> 标签：html, video, embed, mp4

我一直在尝试各种不同的方法将 .mp4 视频嵌入到我正在开发的网站上。这是它的链接...

[http://mcmach.com/MCMachine/](http://mcmach.com/MCMachine/)

我已经在本地进行了测试，并且视频确实可以正常加载，但是当我在服务器上调出实时版本时却没有。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:22:20.370

您的视频不存在。您正在尝试链接到此 URL：

[http://mcmach.com/MCMachine/videos/MC_Machine_HP.mp4](http://mcmach.com/MCMachine/videos/MC_Machine_HP.mp4)

你的服务器给你一个 404。要么修正名字，要么上传丢失的视频。请注意，您可以通过查看浏览器工具的网络选项卡自己轻松找到此类问题。

# mongodb - 如何在 MongoDB 中编写存在的 sql 子句？

> ID：11959283
> 
> 赞同：1
> 
> 时间：2012-08-14T19:20:03.143
> 
> 标签：mongodb, mapreduce

我将下面的 sql 查询翻译成 mongodb 的 map reduce 查询。

```
select
    o_orderpriority, 
    count(*) as order_count
from 
    orders
where 
    o_orderdate >= date '1993-07-01'
    and o_orderdate < date '1993-07-01' + interval '3' month
    and exists (
        select 
        *
        from 
        lineitem
        where 
        l_orderkey = o_orderkey
        and l_commitdate < l_receiptdate
    )
group by 
    o_orderpriority
order by 
    o_orderpriority; 
```

以及以下 map reduce 查询：

```
db.runCommand({
    mapreduce: "orders",
    query: {
        o_orderdate: {'$gte': new Date("July 01, 1993")},
        o_orderdate: {'$lt': new Date("Oct 01, 1993")}
    },
    map: function Map() {

                for(var i in this.o_lineitem) {
                    if( this.o_lineitem[i].l_commitdate < this.o_lineitem[i].l_receiptdate) {
                        emit( this.o_orderpriority, 1 );
                    }
                }

        },
    reduce: function(key, values) {
                var count = 0;
                for (var i = 0; i < values.length; i++) {
                    count += values[i];
                }
                return count;
            },
    out: 'query004'
}); 
```

看看 o_linetem 是订单集合中的嵌入式数组。

结果是：

在 SQL 中：

```
1-URGENT            10594
2-HIGH          10476
3-MEDIUM            10410
4-NOT SPECIFIED 10556
5-LOW           10487 
```

在另一边的 MongoDB 结果中：

```
{ "_id" : "1-URGENT", "value" : 29215 }
{ "_id" : "2-HIGH", "value" : 29020 }
{ "_id" : "3-MEDIUM", "value" : 28616 }
{ "_id" : "4-NOT SPECIFIED", "value" : 29253 }
{ "_id" : "5-LOW", "value" : 28765 } 
```

发生什么事？我在地图减少中做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:30:52.930

如果订单中有多个订单项不符合预期的提交日期，则您将多次发出每个订单优先级。

您没有在 SQL 语句中这样做 - exists 子句仅检查至少有一个行项目不符合提交日期。

如果你想在 map/reduce 中做同样的事情，那么你应该`return;`在为每个订单文档成功发出之后添加一个语句。

# scala - Scala Map 的迭代和过滤

> ID：11959284
> 
> 赞同：1
> 
> 时间：2012-08-14T19:20:14.827
> 
> 标签：scala

我有以下类型的结果 Map `Map[Long,Map[String,String]]`。我想将 Map 转换为`List[Seq[Long,String]]`.

以下代码可以很好地做到这一点：

```
val test = for((time, m) <- ret) yield for((k, v) <- m) yield Seq(time, v) 
```

问题是我实际上只想包括唯一的`Seq(time, v)`地方`v`。例如，目前我得到以下值：

```
 [[
        1344969305196000,
        "Ry7H5_client"
    ],
    [
        1344969777610000,
        "Ry7H5_client"
    ],
    [
        1344965964890000,
        "SOCKET/f6KGcMSVi7"
    ],
    [
        1344969919131000,
        "Ry7H5_client"
    ]] 
```

我只想在我的结果集中包含一次“Ry7H5_client”。解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:34:09.550

您可以确定要删除的键，例如

```
val res = Map(1 -> 2, 3 -> 2, 4 -> 1)

val keysToDelete = res.groupBy(_._2).collect { case (_, m) if m.size > 1 => m.keys }.flatten
// keysToDelete: scala.collection.immutable.Iterable[Int] = List(1, 3)

val resultMap = res -- keysToDelete
// resultMap: scala.collection.immutable.Map[Int,Int] = Map(4 -> 1) 
```

编辑：

收集所有值的键，其中包含您可以执行的短语

```
Map(1 -> "FOO_SOCKET_BAR", 2 -> "FOO_BAR").collect { case (key,value) if value.contains("SOCKET") => key } 
```

为了提高效率，您还可以在此处使用已编译的正则表达式：

```
val regex = ".*SOCKET.*".r
Map(1 -> "FOO_SOCKET_BAR", 2 -> "FOO_BAR").collect { case (key,regex()) => key } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T20:01:17.707

您可以在您的理解中使用多个生成器（如果也可以使用）：

```
val test = (for {
  (time, m) <- ret
  (k,v) <- m
  if v == "Ry7H5_client"
} yield Seq(time, v)).toList 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T19:58:01.893

只需 groupBy 字符串，然后映射到每个组的头部：

```
scala> val list = List((1344969305196000L, "Ry7H5_client"), (1344969777610000L,  
"Ry7H5_client"), (1344965964890000L,"SOCKET/f6KGcMSVi7"), (1344969919131000L, "R 
y7H5_client"))
list: List[(Long, java.lang.String)] = List((1344969305196000,Ry7H5_client), 
(1344969777610000,Ry7H5_client), (1344965964890000,SOCKET/f6KGcMSVi7), 
(1344969919131000,Ry7H5_client))

scala> list.groupBy(x => x._2).map((e) =>  e._2.head).toList
res0: List[(Long, java.lang.String)] = List((1344965964890000,SOCKET/f6KGcMSVi7),
(1344969305196000,Ry7H5_client)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T20:10:47.413

这个怎么样

```
object SO extends App {

  val ret = Map(
    1344969305196000L -> Map("a" -> "Ry7H5_client"),
    1344969777610000L -> Map("a" -> "Ry7H5_client"),
    1344965964890000L -> Map("a" -> "SOCKET/f6KGcMSVi7"),
    1344969919131000L -> Map("a" -> "Ry7H5_client"))

  val test2 = for {
    (m, time) <- ret.map(_.swap)
    (k, v) <- m
  } yield Seq(time, v)

  println(test2)
} 
```

给出列表（列表（1344969919131000，Ry7H5_client），列表（1344965964890000，SOCKET/f6KGcMSVi7））

附言。地图中的“a”只是为了使类型与您原来的问题相匹配，看起来它并不重要。

# ruby-on-rails - 使用 FormBuilder 上的 select 方法进行多选

> ID：11959288
> 
> 赞同：0
> 
> 时间：2012-08-14T19:20:23.170
> 
> 标签：ruby-on-rails

这是我到目前为止所得到的：

```
<td><div id="candys-<%=@type.id.to_s%>"> 
    <%= f.select(:candy_ids, 
             options_for_select(...), 
         {}, 
         {:multiple=>true, :name => "type[#{@type.id.to_s}][candy_ids[]]"}) %>
</div></td> 
```

我最终得到了一系列 nil。

如果我不添加 :name 来强制名称为数组，我将不会得到值数组

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:54:26.037

你快到了，但最后一组方括号在外面，所以：

```
<%= f.select(:candy_ids, 
         options_for_select(...), 
     {}, 
     {:multiple=>true, :name => "type[#{@type.id.to_s}][candy_ids][]"}) %> 
```

虽然我不得不说没有专门指定一个 :name 也对我有用。不过，不确定您的模型/表格的其余部分是什么样的。

# macos - Diffuse 不适用于 MacOS 10.7 上的 glib

> ID：11959289
> 
> 赞同：1
> 
> 时间：2012-08-14T19:20:27.400
> 
> 标签：macos, installation, diff

我正在尝试使用 MacPort 安装漫反射比较软件。它已安装，但无法运行。

```
[15:16:18]~$ export LANG=C; export LC_ALL=C
[15:38:48]~$ diffuse 
Traceback (most recent call last):
  File "/opt/local/bin/diffuse", line 159, in <module>
    gtk.window_set_default_icon(gtk.gdk.pixbuf_new_from_file(iconpath))
glib.GError: Couldn't recognize the image file format for file '/opt/local/bin/../share/pixmaps/diffuse.png' 
```

我使用源文件得到了相同的结果。

我的系统参数：

```
OSX 10.7.4
gcc 4.6.3 
```

请帮我找出原因。

# device - 如何访问设备并向其发送数据？

> ID：11959291
> 
> 赞同：1
> 
> 时间：2012-08-14T14:38:54.790
> 
> 标签：device, serial-port, c#

我已经设法在视觉 C# express 中识别驱动器和串行端口，但我仍然无法访问特定设备（RepRap 打印机）。我想向它发送一个字符串数组，但首先我需要找到它，我该怎么做？我正在使用 Windows 7。

要获取驱动器：

```
using System.Linq;
using System.IO;
using System;

    class Program
    {
            static void Main(string[] args)
            {
                var drives = DriveInfo.GetDrives();
               DriveInfo[] allDrives = DriveInfo.GetDrives();
                     foreach(DriveInfo dv in drives)          
                     {              
                            Console.WriteLine("drive Name:{0}", dv.Name);      
                     }    
                    Console.ReadLine();
            }
        } 
```

获取串口：

```
using System;
using System.IO.Ports;

namespace SerialPortExample
{
    class SerialPortExample
    {
        public static void Main()
        {
            string[] ports = SerialPort.GetPortNames();
            Console.WriteLine("The following serial ports were found:");
            foreach (string port in ports)
            {
                Console.WriteLine(port);
            }
            Console.ReadLine();
        }
    }
} 
```

提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:32:35.550

我鼓励您首先检查这两个问题和答案：

[获取连接到串行端口的设备名称](https://stackoverflow.com/questions/4500027/get-the-device-name-connected-to-the-serial-port)
这个简短地解释了为什么它很难，但提供了一些关于如何询问 Windows 它对设备了解多少的线索

[获取串行端口信息](https://stackoverflow.com/questions/2837985/getting-serial-port-information)
这里有一堆进一步的代码示例。

Generally, you will probably want to find the device by it's NAME that the system assigned to it - you probalby know the name and its something like "reprap#1" etc. I just guess. It may be a good idea to ask to scan all COM-device names and display it to the user so he may choose the proper one..

if you want to automaticaly detect, you can try to detect them by some lower-level details like drivername etc, but usually it is better to just leave that to the user.

# oracle - oracle 11g r2 - 在 ODAC 安装后将 dbmsclr.plb 部署为 sysdba

> ID：11959294
> 
> 赞同：0
> 
> 时间：2012-08-14T19:20:41.940
> 
> 标签：oracle, oracle11g, odac

我刚刚在我的系统上安装了 ODTwithODAC112012。现在我正在尝试部署 dbmsclr.plb

但我收到错误 SP2-024 没什么可改变的。

这是命令窗口：-

```
C:\>sqlplus /nolog  

SQL*Plus: Release 11.2.0.1.0 Production on Tue Aug 14 22:59:39 2012  

Copyright (c) 1982, 2010, Oracle.  All rights reserved.  

SQL> connect sys/Bel29072012 as SYSDBA  
Connected.  
SQL> C:\app\thoshiba\product\11.2.0\dbhome_1\RDBMS\ADMIN\dbmsclr.plb  
SP2-0024: Nothing to change.  
SQL> select count(*) from all_objects where object_name='DBMS_CLR';  

  COUNT(*)
----------
         0

SQL> select count(*) from all_objects where object_name='DBMS_CLR' AND owner='SYS';  

  COUNT(*)
----------
         0

SQL> 
```

请让我知道如何克服这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-05-06T06:56:49.223

对于“SP2-024 nothing to change”错误的gedrid需要在运行脚本之前添加**@**

```
SQL> @C:\app\thoshiba\product\11.2.0\dbhome_1\RDBMS\ADMIN\dbmsclr.plb 
```

# php - 输出带有媒体组属性的 xml 文件

> ID：11959296
> 
> 赞同：0
> 
> 时间：2012-08-14T19:20:55.010
> 
> 标签：php, xml, xml-parsing

我在我的 php 应用程序中使用 simpleXML。

我需要用“媒体组”包装我的媒体元素。这是到目前为止的xml输出：

```
...
<item>
<title>02:15</title>
<link>http://www.realcardio.com</link>
<description>Workout with Hugo to get bigger biceps</description>
<pubDate>08/14/2012</pubDate>
<media:credit role="author">workout title goes here</media:credit>
<media:content url="http://youtu.be/21EpHRJTT34"/>
<media:thumbnail url="http://img.youtube.com/vi/21EpHRJTT34/1.jpg"/>
<jwplayer:start>150</jwplayer:start>
<jwplayer:duration>285</jwplayer:duration>
<jwplayer:backcolor>#FFCC00</jwplayer:backcolor>
<jwplayer:message>This is a test message to display to the user</jwplayer:message>
<jwplayer:routineID>26</jwplayer:routineID>
</item>
... 
```

我只需要像这样对媒体元素进行分组：

```
<media:group>
   <media:credit role="author">workout title goes here</media:credit>
   <media:content url="http://youtu.be/21EpHRJTT34"/>
   <media:thumbnail url="http://img.youtube.com/vi/21EpHRJTT34/1.jpg"/>
</media:group> 
```

到目前为止，这是我用来创建 xml 文件的代码：

```
...
$item = $channel->addChild( 'item' );
$item->addChild( 'title', $minsandsecs );
$item->addChild( 'link', 'http://www.realcardio.com' );
$item->addChild( 'description', $viddesc );
$item->addChild( 'pubDate', '08/14/2012' );

$mediaCredit = $item->addChild( 'credit', 'workout title goes here','http://search.yahoo.com/mrss/' );
$mediaCredit->addAttribute( 'role', 'author' );

$mediaContent = $item->addChild( 'content', '', 'http://search.yahoo.com/mrss/' );
$mediaContent->addAttribute( 'url', $vidsource );

$mediaThumbnail = $item->addChild( 'thumbnail', '', 'http://search.yahoo.com/mrss/' );
$mediaThumbnail->addAttribute( 'url', $imgloc );

$item->addChild( 'start',$vidstart, 'http://developer.longtailvideo.com/trac/wiki/FlashFormats' );
$item->addChild( 'duration',$viddur, 'http://developer.longtailvideo.com/trac/wiki/FlashFormats' );
$item->addChild( 'backcolor',$vidbackcolor, 'http://developer.longtailvideo.com/trac/wiki/FlashFormats' );
$item->addChild( 'message', $vidmessage, 'http://developer.longtailvideo.com/trac/wiki/FlashFormats' );
$item->addChild( 'routineID', $routineID, 'http://developer.longtailvideo.com/trac/wiki/FlashFormats' );
... 
```

我敢肯定，我忽略了一些简单的事情。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T21:44:40.520

您没有在`<media:group>`任何地方创建元素，这是主要问题。否则，您所缺少的只是`media:`在`addChild()`.

```
$mediaGroup = $item->addChild('media:group', '', 'http://search.yahoo.com/mrss/');

$mediaCredit = $mediaGroup->addChild('media:credit', 'workout title goes here', 'http://search.yahoo.com/mrss/');
$mediaCredit->addAttribute('role', 'author');

$mediaContent = $mediaGroup->addChild('media:content', '', 'http://search.yahoo.com/mrss/');
$mediaContent->addAttribute('url', $vidsource);

$mediaThumbnail = $mediaGroup->addChild('media:thumbnail', '', 'http://search.yahoo.com/mrss/');
$mediaThumbnail->addAttribute('url', $imgloc); 
```

# jquery - 输入按钮上的jQuery动画背景颜色不起作用

> ID：11959297
> 
> 赞同：1
> 
> 时间：2012-08-14T19:20:57.557
> 
> 标签：jquery, html, animation, css, jquery-animate

我完全不知道为什么背景颜色没有改变，我已经花了太多时间在它上面：

```
<input type="button" class="front-consultation-btn" value="Get A Free Consultation">

<script>
    $('.front-consultation-btn').animate({ backgroundColor: '#FF0000', width: 400 }, 500);
</script> 
```

为什么这只改变宽度属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:25:10.050

这是因为jQuery默认不支持动画颜色，jQueryUI添加了这个功能：http: [//jqueryui.com/demos/animate/](http://jqueryui.com/demos/animate/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:24:06.953

为什么不使用 CSS3？

```
.yourelement {
    background: #fff;
}

.yourelement:focus, .yourelement:hover {  
    -webkit-transition: background-color 0.5s linear;   
    background: #ccc;   
} 
```

# actionscript-3 - 指定变量类型和函数返回类型有什么好处吗？

> ID：11959300
> 
> 赞同：4
> 
> 时间：2012-08-14T19:21:06.977
> 
> 标签：actionscript-3, flash, oop, types

我总是设置变量和函数的类型，这是我从 Java 学习中养成的习惯，似乎是正确的做法。
但是我总是在其他人的代码中看到“弱类型”，但我不能不同意这一点，因为我不知道让所有东西都保持强类型的真正优势是什么。

我想我的问题很清楚，但我会举一些例子：

```
var id = "Z226";

function changeId(newId){
    id = newId;
    return newId;
} 
```

我的代码是这样的：

```
var id:String = "Z226";

function changeId(newId:String):String{
    id = newId;
    return newId;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T19:25:38.677

是的，最大的优势是：

1.  更快的代码执行，因为运行时知道类型，它不必评估调用
2.  更好的工具支持：自动完成和代码提示将适用于类型化参数和返回类型
3.  更好的可读性

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-14T19:27:00.590

您可以从强类型中获得性能优势。见[http://gskinner.com/talks/quick/#45](http://gskinner.com/talks/quick/#45)

我还发现强类型代码更具可读性，但我想这取决于他们可能不关心的人。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T21:47:20.150

正如 florian 所指出的，强类型的两个优点是开发工具可以使用这些信息来提供更好的代码提示和代码补全，以及类型作为变量或方法打算如何使用的明确指示，可以使代码更容易理解。

性能问题似乎有待商榷。但是， stackoverflow 上的[这个答案](https://stackoverflow.com/questions/2269628/what-is-faster-plain-objects-or-strongly-typed-objects-in-actionscript)表明，在某些基准测试中，有类型的肯定比无类型的要快，但正如作者所说，在正常情况下你不会注意到它。

但是，我认为强类型的最大优点是，如果您尝试分配或返回错误类型的值，则会出现编译器错误。这有助于防止那种只能通过实际运行程序才能追踪的有害错误。

考虑以下人为设计的示例，其中在返回之前`ActionScript`自动将结果转换为 a `string`。强类型方法的参数和返回将确保程序不会编译并发出警告。这可能会为您节省数小时的调试时间。

```
function increment(value) {
    return value + 1;
}

trace(increment("1"));
// 11 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T00:03:40.567

虽然其他答案中关于代码提示和错误检查的观点是准确的，但我想解决关于性能的说法。这真的不是那么真实。理论上，强类型允许编译器生成更接近原生的代码。但是，对于当前的 VM，不会发生这种优化。AS3 编译器在这里和那里将使用整数指令而不是浮点指令。否则，类型指示符在运行时不会产生太大影响。

例如，考虑以下代码：

```
function hello():String {
    return "Hello";
}

var s:String = hello() + ' world';
trace(s); 
```

这是由此产生的 AVM2 操作码：

```
getlocal_0 
pushscope
getlocal_0 
getlocal_0 
callproperty 4 0 ; call hello()
pushstring 12    ; push ' world' onto stack
add              ; concatenate the two
initproperty 5   ; save it to var s
findpropstrict 7 ; look up trace
getlocal_0       ; push this onto stack
getproperty 5    ; look up var s 
callpropvoid 7 1 ; call trace
returnvoid 
```

现在，如果我删除类型指示符，我会得到以下信息：

```
getlocal_0 
pushscope 
getlocal_0 
getlocal_0 
callproperty 3 0 
pushstring 11 
add 
initproperty 4 
findpropstrict 6 
getlocal_0 
getproperty 4 
callpropvoid 6 1 
returnvoid 
```

它完全一样，除了所有名称索引都减少了一个，因为“字符串”不再出现在常量表中。

我并不是要劝阻人们不要使用强类型。人们不应该期待性能方面的奇迹。

**编辑：**如果有人感兴趣，我已经把我的 AS3 字节码反汇编器放到网上：

[http://flaczki.net46.net/codedump/](http://flaczki.net46.net/codedump/)

我已经对其进行了改进，现在它可以取消引用操作数。

# java - 使用 glBufferSubData() 更新 VBO 数据

> ID：11959302
> 
> 赞同：5
> 
> 时间：2012-08-14T19:21:25.320
> 
> 标签：java, opengl, vbo

我目前正在使用 LWJGL 用 Ja​​va 1.6 编写一个 2d 自上而下的 RPG。我在我的游戏中实现了 VBO 的使用，现在我维护其中的两个：一个用于顶点数据，一个用于纹理坐标。

除了我仍然没有真正合乎逻辑的方式来更新对象之外，一切都很好。例如，如果我希望某个图块更改其纹理（更改 VBO 内的纹理坐标以显示纹理表的另一个区域），我看不到仅更改对应于的纹理坐标的方法这个单一的瓷砖。我现在能想到的可能就是用每个循环所需的所有数据填充缓冲区，然后每帧用 glBufferData 上传它们。它有效，但似乎不是最好的方法（或者确实如此？）。

现在，有 glBufferSubData 命令不会分配新内存，而只会更改我告诉它更改的部分。问题是我不知道如何跟踪必须更改的区域（偏移量）。LWJGL 提供了一个 glBufferSubData(target, offset, data); 命令，它只需要缓冲区的开始即可工作。偏移量是否类似于索引？

因此，如果我首先将这些缓冲区上传到 VBO，然后想要更改第二个 float[] 的第二个值：

```
FloatBuffer vertexData = BufferUtils.createFloatBuffer(amountOfVertices * vertexSize);
vertexData.put(new float[]{100, 100, 300, 100, 300, 300, 100, 300});
vertexData.put(new float[]{400, 100, 600, 100, 600, 300, 400, 300});
vertexData.flip(); 
```

我会生成新数据，将其放入一个小的 FloatBuffer 并使用 glBufferSubData(GL_VERTEX_ARRAY, 10, newFloatBuffer); 上传它？10 是因为我想从第十个旧值开始更改值。

那正确吗？有更好的方法吗？再说一遍：如果我每帧重新上传整个数据可以吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T20:43:26.063

[LWJGL's](http://javadoc.lwjgl.org/) `glBufferSubData()` expects the offset as byte count, since one should be able to write arbitrary data to arbitrary buffer locations. If you want to update the float at index `i`, the offset would be `i * 4`, since java floats take, the very common, 4 bytes. All remaining buffer contents will be written, therefore, the target buffer is required to have a capacity of at least
`(i + floatBuffer.remaining()) * 4` bytes. For correct preparation, see the Buffers [flip()](http://docs.oracle.com/javase/7/docs/api/java/nio/Buffer.html#flip%28%29) method or use [position(int)](http://docs.oracle.com/javase/7/docs/api/java/nio/Buffer.html#position%28int%29) together with [limit(int)](http://docs.oracle.com/javase/7/docs/api/java/nio/Buffer.html#limit%28int%29) to specify the remaining contents to be written.

This updating strategy is OK as long as you don't call glBufferSubData() too many times with temporary FloatBuffers. You could also have a second target buffer with equal size for swapping (ping pong), which one could map using `MapBuffer()` for an overall update, while the other one is in use.

I'd rather hold a complete FloatBuffer at the client side and upload it at once using `glBufferData()` instead of calling `glBufferSubData()` many times. But without knowing some numbers, it's hard to tell.

# c# - 错误：XML 声明必须是文档中的第一个节点

> ID：11959304
> 
> 赞同：10
> 
> 时间：2012-08-14T19:21:46.010
> 
> 标签：c#, .net, xml

我在尝试加载 xml 时收到“意外的 XML 声明。XML 声明必须是文档中的第一个节点，并且在它之前不允许出现空白字符”错误。下面给出了我的 C# 代码和 XML 文件的内容。XML 定义存在于 xml 文件的第 6 行，因此存在错误。

我无法控制 xml 文件中的内容，所以我如何使用 C# 编辑/重写它，以便首先出现 xml 声明，然后是注释以加载它而不会出现任何错误！

```
//xmlFilepath is the path/name of the xml file passed to this function
static function(string xmlFilepath)
{
XmlReaderSettings readerSettings = new XmlReaderSettings();
readerSettings.IgnoreComments = true;
readerSettings.IgnoreWhitespace = true;
XmlReader reader = XmlReader.Create(XmlFilePath, readerSettings);
XmlDocument xml = new XmlDocument();
xml.Load(reader);
} 
```

xmlDoc.xml

```
<!-- Customer ID: 1 -->
<!-- Import file: XmlDoc.xml -->
<!-- Start time: 8/14/12 3:15 AM -->
<!-- End time: 8/14/12 3:18 AM -->

<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>
----- 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-14T19:26:16.323

正如错误所述，XML 文档的前五个字符应该是`<?xml`. 没有如果，ands 或 buts。您在开始 XML 标记上方的注释是非法的；它们必须放在 XML 标记内部（因为注释结构本身是由 XML 标准定义的，因此在主要 XML 标记之外没有意义）。

**编辑：**考虑到 OP 的文件格式，这样的东西应该能够重新排列行：

```
var lines = new List<string>();

using (var fileStream = File.Open(xmlFilePath, FileMode.Open, FileAccess.Read))
   using(var reader = new TextReader(fileStream))
   {
      string line;
      while((line = reader.ReadLine()) != null)
         lines.Add(line);
   }   

var i = lines.FindIndex(s=>s.StartsWith("<?xml"));
var xmlLine = lines[i];
lines.RemoveAt(i);
lines.Insert(0,xmlLine);

using (var fileStream = File.Open(xmlFilePath, FileMode.Truncate, FileAccess.Write)
   using(var writer = new TextWriter(fileStream))
   {
      foreach(var line in lines)
         writer.Write(line);

      writer.Flush();
   } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-14T19:23:55.377

那不是有效的 XML。

正如错误明确指出的那样，XML 声明 ( `<?xml ... ?>`) 必须*放在首位*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-12T11:58:43.703

我正在使用以下函数从 xml 中删除空格：

```
public static void DoRemovespace(string strFile)
    {
        string str = System.IO.File.ReadAllText(strFile);
        str = str.Replace("\n", "");
        str = str.Replace("\r", "");
        Regex regex = new Regex(@">\s*<");
        string cleanedXml = regex.Replace(str, "><");
        System.IO.File.WriteAllText(strFile, cleanedXml);

    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-14T02:33:56.613

不要在文件开头添加任何注释！

# .net - asmx 不会使用 https 调用

> ID：11959305
> 
> 赞同：2
> 
> 时间：2012-08-14T19:21:50.413
> 
> 标签：.net, web-services, asmx

我正在运行一个 Web 服务，当在我的本地机器上运行时工作正常。但是，当部署到生产中时，我遇到了一些问题。当我访问该站点时：https://[mydomain]/[mywebservice.asmx] 我得到了预期的 Web 方法列表（注意：所有列出的 Web 方法都正确地在其各自的链接中包含 https）。我单击其中一个，我得到了我的 SOAP 信息以及测试我的 web 方法的能力——这也是预期的。当我输入一个值并单击 Invoke 时，我收到一个找不到页面的错误 - 原因是 Invoke 将我发送到我网站的 http 版本。asmx 上的快速查看源代码讲述了这个故事：

```
<form target="_blank" action='http://[mydomain]/[mywebservice.asmx]/[mywebmethod]' method="POST"> 
```

我需要此操作为 https，但我无法弄清楚如何更改此操作。我到处找，找不到这个设置，已经用尽了我所有的资源。任何帮助表示赞赏。

服务器：Windows 2003 SP2

# android - 检索另一个应用程序的 sharedPreferences

> ID：11959308
> 
> 赞同：1
> 
> 时间：2012-08-14T19:22:03.277
> 
> 标签：android

我有一个应用程序（ com.example.MyApplication ），它像这样保存当前位置

```
SharedPreferences settings = getSharedPreferences(PREFERENCES, 0);
                SharedPreferences.Editor editor = settings.edit();
                editor.putString("City", city);
                editor.commit(); 
```

现在我想创建另一个应用程序（com.example.SecondApplication）并从另一个应用程序中检索城市字符串，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:53:41.263

最后我找到了一种方法：D 我正在保存我的偏好

```
SharedPreferences settings = getSharedPreferences(PREFERENCES, MODE_PRIVATE);
                SharedPreferences.Editor editor = settings.edit();
                editor.putString("City", city);
                editor.commit(); 
```

我正在像这样检索它们

```
Context otherAppsContext = null;
            try {
                otherAppsContext = createPackageContext("com.example.FirstApp", 0);
            } catch (NameNotFoundException e) {
            }

            SharedPreferences settings = otherAppsContext.getSharedPreferences(PREFERENCES, Context.CONTEXT_INCLUDE_CODE);
            text.setText(settings.getString("City", "nope")); 
```

重要的是，在清单中我已经放入了两个应用程序

```
android:sharedUserId="example.shared" 
```

我把它放在 android:versionName 下

# python - 正在寻找具有类似 Stylus 语法的 Python CSS 预处理器？

> ID：11959309
> 
> 赞同：4
> 
> 时间：2012-08-14T19:22:09.340
> 
> 标签：python, css, node.js, stylus

[Stylus](http://learnboost.github.com/stylus/docs/js.html)是一种编译成普通 CSS 的语言。由于许多原因，该语言可以节省大量时间和空间。例如，我可以将选择器放在一起：

```
div.foo
    color: red

    div.bar
        color: blue
        font-weight: bold

    div.baz
        color: green
        background-color: pink 
```

我还可以做一些事情，比如让特定于供应商的属性在没有前缀的情况下工作，这样可以节省大量空间。

**我的问题是**：Stylus 有什么替代品吗？我真的想不出关于 Stylus 是什么的描述，所以我发现使用 Google 很难找到任何替代品。

*注意：我所说的替代方案是指编译成 CSS 并提供节省时间的好东西的语言。*

* * *

我正在寻找替代品的原因是我在所有项目中都使用 Stylus，我想看看是否有更好的解决方案。我对 Stylus 不是 100% 满意的原因是它的 TextMate 包很糟糕，而且 Stylus 需要 Node.js 来编译，这也是我想避免的一步。我主要使用 Python。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:24:29.613

Stylus 的兄弟姐妹是[LESS](http://lesscss.org/)和[Sass](http://sass-lang.com/)。由于功能和速度，我更喜欢 Stylus，但它们几乎可以互换，AFAIK。

LESS 也是用 javascript 编写的，因此不会将您从 node.js 依赖项中释放出来。Sass 是用 Ruby 编写的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-10-03T14:52:35.517

Python中有一个Stylus实现。它被称为 Stilus，即将完成。你在这里找到它：[https ://github.com/jw/stilus](https://github.com/jw/stilus)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-17T18:03:28.460

[CSS-On-Diet](http://cofoh.com/css-on-diet)是用 Python 编写的。您可以通过以下方式轻松安装它

```
pip install CSSOnDiet 
```

节省了大量的时间和空间，但语法不同

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-15T21:33:49.967

> 我真的想不出什么是 Stylus 的描述

您正在寻找的术语是*CSS preprocessor*。

检查这些：

*   [Less](https://www.google.com.ar/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&uact=8&ved=0CCQQFjABahUKEwjZ_r___6vHAhVCkJAKHZE8Bz8&url=http%3A%2F%2Flesscss.org%2F&ei=zKrPVdnoIsKgwgSR-Zz4Aw&usg=AFQjCNF-GHR66GftFm9aMGmUFpVKsYvD7A&sig2=gN0gXxrIYPhYQrjADW6ffQ&bvm=bv.99804247,d.Y2I) : 不像 Stylus 是一个 css 超集。换句话说，每个有效的 CSS 文档也是有效的 Less 文档。这种方式更容易从现有的 CSS 迁移。

*   [Sass](https://www.google.com.ar/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&uact=8&sqi=2&ved=0CCMQFjABahUKEwjhyJzIgKzHAhXBDZAKHSPSAYU&url=http%3A%2F%2Fsass-lang.com%2F&ei=ZavPVaGCBcGbwASjpIeoCA&usg=AFQjCNGj26Uvw2Xaq_ZQbByTuIQsbFtzjA&sig2=bSz2QAQxB8XNrjl-KuiKug&bvm=bv.99804247,d.Y2I)：与 Less 非常相似。它有一个变体 (SCSS)，它的符号也是 SCC 超集。有些人更喜欢 Sass 而不是 Less，因为他的控制结构语法（选择、迭代）对大多数程序员来说更自然，因为它与大多数命令式编程语言（C++、Java 等）中使用的语法非常相似，而 Less 使用递归方法，更类似于函数式编程语言。

*   [荒谬](http://absurdjs.com/)的 JS：样式是通过编写纯 JavaScript 代码来描述的，因为他对对象文字的表示法与 CSS 表示法非常相似。这种有趣的方法允许您以您可以想象的任何形式操作和预处理样式，因为您不再受上述两种控制结构的限制，但您可以使用编程提供的整个功能工具集语言。如果您是程序员，或者如果您作为设计师有兴趣学习如何编码，或者如果您想以一种您无法实现的非平凡或疯狂的方式描述和重用您的样式定义，我强烈建议您使用此选项只是一个预处理器。

在阅读这个问题之前，我不知道 Stylus。这似乎很不错。我喜欢他使用换行符和列表来定义代码结构的类似 Python 的方法。我会试一试。如果你已经使用了这个预处理器并且你没有发现任何重要的缺点，我会坚持使用它。

# python - 使用 Python 发送背靠背 POST 请求

> ID：11959312
> 
> 赞同：0
> 
> 时间：2012-08-14T19:22:15.213
> 
> 标签：python

我正在编写一个 Python 脚本来从此链接中抓取数据：http: [//emma.msrb.org/MarketActivity/RecentOS.aspx](http://emma.msrb.org/MarketActivity/RecentOS.aspx)。我已经将我的脚本配置为绕过确认页面（使用 cookie），并且我已经弄清楚如何使用 POST 请求来访问“所有新问题”而不是默认的“今天”，但现在我需要循环浏览所有 19 页。

POST 请求看起来像这样：`ctl00$gridViewPagingUserControl$page2LinkButton`，但使用它并不能得到我需要的东西。

我正在使用 Python Requests 模块，但我也尝试过使用 urllib/urllib2 ，但这似乎也不起作用。

基本上，我如何发送多个/背靠背 POST 请求以访问我需要的页面？

我的示例代码如下。使用`post_requests_1`工作正常，但`post_requests_2`没有。

```
# Cookies
cp = urllib2.HTTPCookieProcessor()
cj = cp.cookiejar
cj.set_cookie(cookielib.Cookie(0, 'Disclaimer', '247245968.1342815275.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)', '80', False, '.emma.msrb.org', True, False, '/', True, False, None, False, None, None, None))

post_requests_1 = { r'__EVENTTARGET' : r'ctl00$mainContentArea$allNewIssuesLinkButton', r'__EVENTARGUMENT' : r'' }
post_requests_2 = { r'__EVENTTARGET' : r'ctl00$mainContentArea$gridViewPagingUserControl$page2LinkButton', r'__EVENTARGUMENT' : r'' }
html = requests.post('http://emma.msrb.org/MarketActivity/RecentOS.aspx', data = post_requests_1, cookies = cj)
print html.text.encode('utf-8') 
```

# html - 四舍五入wordpress角落的麻烦

> ID：11959315
> 
> 赞同：1
> 
> 时间：2012-08-14T19:22:20.410
> 
> 标签：html, css, wordpress

我当前的网站是用 WordPress 制作的，我的主题是基于 211（默认主题），我只是修改它以满足我的要求。但我有一个大问题。**容器**的角落只是不会变圆。这是[style.css](http://pastebin.com/JF7hCLtL)和[现场演示](http://abc.com)。

我怎么能绕过角落？我只是设法绕过横幅角落......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:33:31.610

当我请朋友帮忙时，有人告诉我在页面周围使用不可见的边框，所以我这样做了：

```
#page {
    margin: 2em auto;
    max-width: 1000px;
border:1px rgba(0,0,0,0.0);
-webkit-border-radius:6px;-o-border-radius:6px;-moz-border-radius:6px;
} 
```

问题解决了。

# java - PDFBox 更改页面大小并再次保存

> ID：11959317
> 
> 赞同：1
> 
> 时间：2012-08-14T19:22:22.800
> 
> 标签：java, pdf-generation, pdfbox

首先，对不起我的英语不好。

我正在尝试删除 PDF 页面的页眉和页脚，有必要在分页符处搜索一些单词，但页眉和页脚不可能，所以有必要裁剪它然后转换为文本而不是“可能”搜索单词。

我正在这样做：

```
PDDocument pdDoc = PDDocument.load("document.pdf");

PDPage page = (PDPage) pdDoc.getDocumentCatalog().getAllPages().get(0);

PDRectangle rectangle = new PDRectangle();
rectangle.setUpperRightY(page.findCropBox().getUpperRightY() - 100);
rectangle.setLowerLeftY(page.findCropBox().getLowerLeftY());
rectangle.setUpperRightX(page.findCropBox().getUpperRightY());
rectangle.setLowerLeftX(page.findCropBox().getLowerLeftX());

page.setMediaBox(rectangle);

PDDocument document = new PDDocument();
document.addPage(page);
document.save("newDocument.pdf");
document.close(); 
```

但是当我将其更改为 HTML 时，它会窃取隐藏的文本。有没有办法在没有裁剪区域的情况下保存它并正确转换为 html？

谢谢。此致。

# xml - 使用 XSL 转换数据

> ID：11959318
> 
> 赞同：1
> 
> 时间：2012-08-14T19:22:28.430
> 
> 标签：xml, xslt

我正在使用 XSL 文件来转换另一个使用 Y 和 N 值而不是 true 和 false 的 XML。如何定义一次所有 Y 或 N 都应该变为真或假，而不必在我访问原始数据的每一行中都这样做？

原始 XML：

```
<whatever>
 <water>N</water>
 <electricity>Y</electricity>
 <internet>Y</internet>
</whatever> 
```

XSL，现在我必须每次将 Y 转换为 true：

```
<whatever>
 <water><!-- xsl translation here --></water>
 <electricity><!-- xsl translation here --></electricity>
 <internet><!-- xsl translation here --></internet>
</whatever> 
```

理想的 XSL：

```
<whatever>
 <!-- Something magic that will automatically change all value-of output-->
 <water><xsl:value-of select="//water"/></water>
 <electricity><xsl:value-of select="//electricity"/></electricity>
 <internet><xsl:value-of select="//internet"/></internet>
</whatever> 
```

输出：

```
<whatever>
 <water>false</water>
 <electricity>true</electricity>
 <internet>true</internet>
</whatever> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T01:15:40.813

一个更简单、更高效的 XSLT 1.0 样式表将是...

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="@*|node()">
 <xsl:copy>
   <xsl:apply-templates select="@*|node()"/>
 </xsl:copy>
</xsl:template>

<xsl:template match="text()[.='Y']">
 <xsl:value-of select="'true'" />
</xsl:template>

<xsl:template match="text()[.='N']">
 <xsl:value-of select="'false'" />
</xsl:template>

</xsl:stylesheet> 
```

* * *

...或等效地...

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="@*|node()">
 <xsl:copy>
   <xsl:apply-templates select="@*|node()"/>
 </xsl:copy>
</xsl:template>

<xsl:template match="text()[.='Y']">true</xsl:template>
<xsl:template match="text()[.='N']">false</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:55:08.827

使用标识模板来处理 XML 并保持相同的结构。

添加一个将文本节点“Y”和“N”转换为真假的模板。

```
<?xml version="1.0" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method="xml" omit-xml-declaration="yes"/>

    <!-- put your templates here -->
<xsl:template match="text()">
  <xsl:choose>
    <xsl:when test=".='Y'">true</xsl:when>
    <xsl:when test=".='N'">false</xsl:when>
    <xsl:otherwise><xsl:copy/></xsl:otherwise>
  </xsl:choose>  
</xsl:template>

    <!-- identity templates -->
    <xsl:template match="*">
        <xsl:copy>
            <xsl:apply-templates select="@*"/>
            <xsl:apply-templates select="node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="@*|comment()|processing-instruction()">
        <xsl:copy/>
    </xsl:template>

</xsl:stylesheet> 
```

有关身份模板的更多信息，请参阅[http://www.ibm.com/developerworks/web/library/x-tipxsltidentitytpl/index.html](http://www.ibm.com/developerworks/web/library/x-tipxsltidentitytpl/index.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T04:18:57.207

**只需使用**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>
 <xsl:template match="text()[. = 'Y' or . = 'N']">
  <xsl:value-of select=". = 'Y'"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**：

```
<whatever>
    <water>N</water>
    <electricity>Y</electricity>
    <internet>Y</internet>
</whatever> 
```

**产生了想要的正确结果**：

```
<whatever>
   <water>false</water>
   <electricity>true</electricity>
   <internet>true</internet>
</whatever> 
```

**说明**：

1.  使用和覆盖**[身份规则](http://dpawson.co.uk/xsl/sect2/identity.html)**。

2.  在覆盖模板中您想要的只是输出简单 XPath 表达式的结果`. = 'Y'`

# f# - 为什么 None 表示为 null？

> ID：11959321
> 
> 赞同：14
> 
> 时间：2012-08-14T19:22:36.840
> 
> 标签：f#, discriminated-union

[`CompilationRepresentationFlags.UseNullAsTrueValue`](http://msdn.microsoft.com/en-us/library/ee370528.aspx)可以用来

> 允许使用 null 作为可区分联合中的 null 鉴别器的表示形式

`Option.None`是这方面最突出的例子。

为什么这很有用？与检查联合案例（生成的`Tag`属性）的传统机制相比，空检查如何更好？

它可能会导致意想不到的行为：

```
Some(1).ToString() //"Some(1)"
None.ToString()    //NullReferenceException 
```

### 编辑

我测试了 Jack 的断言，即与 null 而不是静态只读字段相比更快。

```
[<CompilationRepresentation(CompilationRepresentationFlags.UseNullAsTrueValue)>]
type T<'T> =
  | Z
  | X of 'T

let t = Z 
```

使用 ILSpy，我可以看到`t`编译为 null（如预期的那样）：

```
public static Test.T<a> t<a>()
{
    return null;
} 
```

考试：

```
let mutable i = 0
for _ in 1 .. 10000000 do
  match t with
  | Z -> i <- i + 1
  | _ -> () 
```

结果：

> 真实：00：00：00.036，CPU：00：00：00.046，GC gen0：0，gen1：0，gen2：0

如果该`CompilationRepresentation`属性被删除，`t`则成为静态只读字段：

```
public static Test.T<a> t<a>()
{
    return Test.T<a>.Z;
}

public static Test.T<T> Z
{
    [CompilationMapping(SourceConstructFlags.UnionCase, 0)]
    get
    {
        return Test.T<T>._unique_Z;
    }
}

internal static readonly Test.T<T> _unique_Z = new Test.T<T>._Z(); 
```

结果是一样的：

> 真实：00：00：00.036，CPU：00：00：00.031，GC gen0：0，gen1：0，gen2：0

模式匹配`t == null`按照前一种情况和`t is Z`后一种情况进行编译。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-14T19:39:55.953

F# 编译器有时`null`用作 None 的表示，因为它比实际创建 FSharpOption<'T> 的实例并检查`Tag`属性更有效。

想一想——如果你有一个不允许为 null 的普通 F# 类型（如记录），那么任何指向该类型实例的指针（CLR 内部使用的指针）都永远不会是`NULL`. 同时，如果`T`是一个可以表示状态的类型`n`，那么`T option`就可以表示`n+1`状态。因此，`null`用作 None 的表示只是利用了一个额外的状态值，这是由于 F# 类型不允许为空而可用。

如果您想尝试关闭此行为（对于普通 F# 类型），您可以应用`[<AllowNullLiteral(true)>]`它们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-14T20:50:19.473

Jack 的回答似乎不错，但稍微扩展一下，在 IL 级别，CLR 提供了一个特定的操作码来加载空值（`ldnull`）和有效的测试方法（`ldnull`后面是`beq`/ `bne.un`/ `ceq`/ `cgt.un`）。当 JITted 时，这些应该比取消引用`Tag`属性并相应地分支更有效。虽然每次调用的节省可能很小，但期权类型的使用频率足够高，累积的节省可能非常可观。

当然，正如您注意到的那样，有一个权衡：继承自的方法`obj`可能会抛出空引用异常。这是在处理 F# 值时使用`string x`/ `hash x`/`x=y`而不是`x.ToString()`/ `x.GetHashCode()`/的一个很好的理由。`x.Equals(y)`可悲的是，没有（可能的）等价`x.GetType()`于 代表的值`null`。

# wpf - 触发属性更改时故事板动画未完成

> ID：11959331
> 
> 赞同：1
> 
> 时间：2012-08-14T19:23:40.037
> 
> 标签：wpf, animation, storyboard

我正在使用 WPF 和 MVVM。我有一个情节提要，其中包含在 ViewModel 中的某些状态上触发的彩色动画。如果处于“增加”状态，情节提要将导致项目闪烁绿色一次。如果处于“减少”状态，情节提要将闪烁一次红色。如果处于“未更改”状态，则不会发生任何事情。

我遇到的问题是，如果在动画运行时由于某种原因状态发生变化，动画将停止。例如，我进入了“增加”状态，动画开始闪烁绿色。然后相同的属性更改为 Unchanged 并且动画立即停止而没有结束。

**即使触发的值发生了变化，有没有办法让动画运行它？**

```
<Storyboard x:Key="ValueIncreasedStoryboard" AutoReverse="True">
    <ColorAnimation
        Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
        To="{StaticResource ResourceKey=IncreasedColor}"
        Duration="0:0:0.4" />
    <ColorAnimation
        Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
        To="{StaticResource ResourceKey=IncreasedColor}"
        Duration="0:0:1" />
</Storyboard>

<DataTrigger Binding="{Binding Path=Status}" Value="{x:Static ViewModel:Status.Increased}">
    <DataTrigger.EnterActions>
        <BeginStoryboard Storyboard="{StaticResource ValueIncreasedStoryboard}" x:Name="ValueIncreased_Storyboard"/>
    </DataTrigger.EnterActions>
    <DataTrigger.ExitActions>
        <RemoveStoryboard BeginStoryboardName="ValueIncreased_Storyboard"/>
    </DataTrigger.ExitActions>
</DataTrigger> 
```

**解决方案：删除退出操作和将填充行为设置为停止的组合。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:54:00.750

删除此行：

```
<DataTrigger.ExitActions>
    <RemoveStoryboard BeginStoryboardName="ValueIncreased_Storyboard"/>
</DataTrigger.ExitActions> 
```

然后订阅 Storyboard.Completed 事件。您可以使用 EventSetter 从 XAML 执行此操作。在 Completed 事件处理程序中删除情节提要。

# django - 如何在 Django 中安装 Solr 以与 Haystack 一起使用

> ID：11959333
> 
> 赞同：0
> 
> 时间：2012-08-14T19:23:46.057
> 
> 标签：django, tomcat, solr, tomcat7, django-haystack

我正在安装 Solr 以与 Haystack / Django 一起使用。

我该如何安装 Solr？我是否需要完全按照在线说明安装 Tomcat 等服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:50:36.757

如果您打算自己安装/设置，我刚刚评论的上述问题会产生重大影响。或者您可以使用**托管服务**（阅读：简单）。

试试[http://websolr.com](http://websolr.com)我很喜欢它。

如果您在**OSX**上并且想要一个本地 Solr 实例只是为了尝试一些开发，这是一个很棒的教程：[http ://realityloop.com/blog/2011/07/19/setting-multicore-apache-solr-os -x-using-homebrew](http://realityloop.com/blog/2011/07/19/setting-multicore-apache-solr-os-x-using-homebrew) 本质上`brew install solr`，然后是一些配置。

如果您尝试在**linux操作系统上创建****生产**级 solr 服务器，我建议您使用特定于该发行版和您正在使用的版本的指令集。或者更好的是，咬紧牙关付钱给知道他们在做什么来设置它的人（确保您的索引不会失败或下降）。

# java - NoClassDefFoundError org/eclipse/swt/SWTError

> ID：11959334
> 
> 赞同：1
> 
> 时间：2012-08-14T19:23:51.993
> 
> 标签：java, jar, compilation

我正在尝试编译一个开源[软件](http://code.google.com/p/five/)。构建工作正常并生成一个 jar 文件“five-server.jar”。当我尝试从 cmd 运行此文件时，出现这些错误。

```
C:\Users\vickey\code\five-server\dist\main>java -jar five-server.jar
Exception in thread "main" java.lang.NoClassDefFoundError: org/eclipse/swt/SWTError
Caused by: java.lang.ClassNotFoundException: org.eclipse.swt.SWTError
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
Could not find the main class: org.devtcg.five.Main. Program will exit. 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T15:02:54.620

SWT Jar 文件依赖于平台。见[http://www.jarfinder.com/index.php/java/info/org.eclipse.swt.SWTError](http://www.jarfinder.com/index.php/java/info/org.eclipse.swt.SWTError)

例如在 Windows 上，一个合适的 jar 是：org.eclipse.swt.win32.win32.x86_3.1.0.jar

或在 Mac OS X 上：swt-macosx-3.0m7.jar

等等。如果您添加此依赖项，例如您使用的是 32 位还是 64 位库，您可能会遇到调用类型的后续问题。

这些天来，这种依赖问题经常出现，这太糟糕了:-(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:28:49.863

您必须设置类路径，使其至少包含 org.eclipse.swt.SWTError 类或包含它的 jar：

```
java -classpath path/to/jar/containing/org.eclipse.swt.SWTError -jar five-server.jar 
```

您还应该在清单文件中设置 Main-class 属性`five-server.jar`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-19T14:38:11.420

按照@Wolfgang Fahl 的回答，您可以在此处下载参考资料：

**标准小部件工具包 » 4.3 x86**

Maven参考： [https ://mvnrepository.com/artifact/org.eclipse.swt.org.eclipse.swt.win32.win32.x86.4.3.swt/org.eclipse.swt.win32.win32.x86/4.3](https://mvnrepository.com/artifact/org.eclipse.swt.org.eclipse.swt.win32.win32.x86.4.3.swt/org.eclipse.swt.win32.win32.x86/4.3)

jar文件： [http ://central.maven.org/maven2/org/eclipse/swt/org/eclipse/swt/win32/win32/x86_64/4/3/swt/org.eclipse.swt.win32.win32.x86_64 /4.3/org.eclipse.swt.win32.win32.x86_64-4.3.jar](http://central.maven.org/maven2/org/eclipse/swt/org/eclipse/swt/win32/win32/x86_64/4/3/swt/org.eclipse.swt.win32.win32.x86_64/4.3/org.eclipse.swt.win32.win32.x86_64-4.3.jar)

**标准小部件工具包 » 4.3 x64**

Maven reference: [https://mvnrepository.com/artifact/org.eclipse.swt.org.eclipse.swt.win32.win32.x86_64.4.3.swt/org.eclipse.swt.win32.win32.x86_64/4.3](https://mvnrepository.com/artifact/org.eclipse.swt.org.eclipse.swt.win32.win32.x86_64.4.3.swt/org.eclipse.swt.win32.win32.x86_64/4.3)

Jar file: [http://central.maven.org/maven2/org/eclipse/swt/org/eclipse/swt/win32/win32/x86_64/4/3/swt/org.eclipse.swt.win32.win32.x86_64/4.3/org.eclipse.swt.win32.win32.x86_64-4.3.jar](http://central.maven.org/maven2/org/eclipse/swt/org/eclipse/swt/win32/win32/x86_64/4/3/swt/org.eclipse.swt.win32.win32.x86_64/4.3/org.eclipse.swt.win32.win32.x86_64-4.3.jar)

# css - mvc3格式电话号码

> ID：11959336
> 
> 赞同：0
> 
> 时间：2012-08-14T19:23:58.803
> 
> 标签：css, asp.net-mvc-3

我想显示这样的电话号码 (999) 999-9999 我以为 css 类会这样做，但它没有

```
<td>@Html.Encode(Model.PhoneModel.PhoneNumber)</td>. 
```

我试过这个，但它不起作用

```
@String.Format("{0:(###) ###-####}",Model.PhoneModel.PhoneNumber.ToString()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:01:47.693

我得到了这个工作，但我不喜欢它是正则表达式的事实。

```
@Regex.Replace(Model.PhoneModel.PhoneNumber, @"(\d{3})(\d{3})(\d{4})", "($1) $2-$3") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:29:01.547

您可能想看看更改输出值的方式。考虑一下 Phil Haack 的这篇文章。

[http://haacked.com/archive/2010/04/28/replacing-html-encode.aspx](http://haacked.com/archive/2010/04/28/replacing-html-encode.aspx)

编辑：要解决您将格式设置为电话号码的编辑，请参考此线程： [如何在 C# 中将字符串格式化为电话号码](https://stackoverflow.com/questions/188510/how-to-format-a-string-as-a-telephone-number-in-c-sharp)

```
String.Format("{0:(###) ###-####}", 8005551212); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T19:56:59.977

当其他人为您完成所有工作时，花费太多精力来格式化电话号码没有多大意义。查看[http://code.google.com/p/libphonenumber/](http://code.google.com/p/libphonenumber/)库，该库将为您格式化数字（并将它们转换回标准格式）。它也可以在 nuget 上作为 libphonenumber-csharp 使用。

# javascript - $.mobile.changePage 通过 AJAX 加载后的回调函数？

> ID：11959340
> 
> 赞同：2
> 
> 时间：2012-08-14T19:24:05.100
> 
> 标签：javascript, jquery, jquery-mobile

我想绑定一些新事件并在动态加载的页面上调用一些函数，但是那里的示例似乎已经过时和/或不完整（甚至是 jqm 文档）。我正在使用 jQuery 1.7.2 和 jQuery Mobile 1.2。做这样的事情的正确方法是什么？

```
$('#someButton').click(function(e) {
        e.preventDefault();

        $.mobile.changePage("mypage2.html", {
            type: 'GET',
            changeHash: true
        });  

        //BELOW SHOULD BE CALLED WHEN THE PAGE LOADS THOUGH
        doSomething();
        $('#menu_page .request-items', contentScopeOfPage2).click(function (e) {
             doSomethingElse();
        });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:39:43.627

通常，您为有问题的伪页面设置委托事件处理程序，如下所示：

```
$(document).on('pageinit', '#menu_page', function () {
    $(this).find('.request-items').on('click', doSomethingElse);
}); 
```

将此代码放在全局范围内，每当`#menu_page`初始化伪页面（无论是远程文档还是同一文档中的伪页面）时，`click`都会正确设置事件处理程序。

这是一个演示：http: [//jsfiddle.net/mSAzF/](http://jsfiddle.net/mSAzF/)

# c++ - Qt QVBoxLayout：如何在固定高度的盒子中划分布局？

> ID：11959342
> 
> 赞同：3
> 
> 时间：2012-08-14T19:24:13.733
> 
> 标签：c++, qt

我想按以下方式划分我的窗口

```
 Build a vertical layout
    -------------------------
    |                       |
    -------------------------
    |                       |
    |                       |
    |                       |
    |                       |
    |                       |
    |                       |
    ------------------------- 
```

使用 QVBoxLayout。我想一直保持这个比例。我将禁用重新调整窗口大小。现在我有以下代码。

```
QVBoxLayout baseLayout = new QVBoxLayout(this);
QLabel *widget = new QLabel(NULL);
widget->setStyleSheet("background-color: rgb(0, 39, 118)");
widget->setGeometry(0,0,400, 30);
widget->setPixmap(QPixmap("Logo-Large.gif"));
baseLayout->addWidget(widget); 
```

...

这将窗口分成相等的部分。我无法使用表单设计器，因为我正在动态构建此 UI。

QVBoxLayout 上是否有任何属性可用于实现此目的？或者使用这个 QVBoxLayout 是完全错误的，如果是这样，请提出一个替代方案。

谢谢和问候，阿图尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:33:37.343

要使 QVBoxLayout 保持两个元素之间的固定比例，请在 addWidget 中为它们提供拉伸参数。N 的拉伸参数是另一个拉伸参数 Y 的 x 倍，将使相应的小部件具有比另一个小部件高 x 倍的高度。

# mysql - 存储 socket.io 数据

> ID：11959345
> 
> 赞同：0
> 
> 时间：2012-08-14T19:24:17.113
> 
> 标签：mysql, node.js, socket.io

我正在使用 socket.io 开发一个应用程序，用户可以在其中向存在于通道/房间中的用户发送和接收数据。在这里，我需要您对存储从用户传递到通道的数据的建议。因此，当有人进入该频道时，他应该能够从他输入的特定频道获取数据。

那么如何将数据保存到特定通道？

我曾计划将数据存储在 MySQL 数据库中，该数据库将具有通道 ID、通道名称和通道消息列。

但是我认为如果用户数量增加并将每条消息作为新行插入数据库中，这将是一个问题？

请帮助我找到这些查询的最佳方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:37:13.597

除非您同时拥有数千名用户，否则这并不重要。只需使用您最喜欢的任何东西。当您拥有成千上万的用户时，您可以根据需要更改架构。

# unix - 如何在 RHEL 5 中修改非交互式 SSH 调用的 PATH？

> ID：11959347
> 
> 赞同：3
> 
> 时间：2012-08-14T19:24:26.380
> 
> 标签：unix, ssh, redhat, rhel5

我正在尝试修改我的 SSH 服务器的 PATH 变量，例如非交互式 shell 命令`ssh myserver.com 'echo $PATH'`返回所需的路径。我尝试修改 ~/.bashrc 和 ~/.profile 文件，但它们仅在我以交互方式登录服务器时修改 PATH ，即`ssh myserver.com`.

我可以在 RHEL5 中更改此行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T17:27:07.553

**~/.bash_profile**是您要放置这些变量的位置。我不相信 bash 使用 ~/.profile （我相信它被 csh 和 tcsh 使用）

# c# - 使用代理页面更改请求的 Servlet 参数

> ID：11959353
> 
> 赞同：0
> 
> 时间：2012-08-14T19:24:42.313
> 
> 标签：c#, silverlight, proxy, wms

我有这样的要求：

`http://Server/wms/servlet/WMSServer?userid=hidden&passwd=hidden&VERSION=1.1.1&REQUEST=GetMap&SRS=EPSG:4326&BBOX=-93.0562371212999,44.2252121686514,-92.7059804612417,44.3405684382141&WIDTH=1840&HEIGHT=606&LAYERS=VIEWS&STYLES=&EXCEPTIONS=application/vnd.ogc.se_xml&FORMAT=image/png&BGCOLOR=0xFEFFFF&TRANSPARENT=TRUE`

请求通过代理页面传递，是否可以更改代理页面中的请求，以便我可以向“样式”参数添加一个值，如下所示：

`http://Server/wms/servlet/WMSServer?userid=hidden&passwd=hidden&VERSION=1.1.1&REQUEST=GetMap&SRS=EPSG:4326&BBOX=-93.0562371212999,44.2252121686514,-92.7059804612417,44.3405684382141&WIDTH=1840&HEIGHT=606&LAYERS=VIEWS&STYLES=**TIMESTAMP**&EXCEPTIONS=application/vnd.ogc.se_xml&FORMAT=image/png&BGCOLOR=0xFEFFFF&TRANSPARENT=TRUE`

基本上改变 - &STYLES=&EXCEPTIONS=.... 到 &STYLES=TIMESTAMP&EXCEPTIONS=....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:48:15.643

想通了，一点都不难。

只需设置代理来处理请求并在 URI 字符串上执行一些简单的逻辑。

```
 public void ProcessRequest(HttpContext context)
{   
    HttpResponse response = context.Response;

    // Get the URL requested by the client (take the entire querystring at once
    //  to handle the case of the URL itself containing querystring parameters)
    string uri = Uri.UnescapeDataString(context.Request.QueryString.ToString());

    // Get token, if applicable, and append to the request
    string token = getTokenFromConfigFile(uri);

    // Add the 'TIMESTAMP' Value  to the Valtus Service
    string styleparam = "&STYLES=";
    if (uri.Contains(styleparam))
    {
        int position = uri.IndexOf(styleparam) + styleparam.Length;
        uri = uri.Insert(position, "TIMESTAMP");
    }

    System.Net.WebRequest req = System.Net.WebRequest.Create(new Uri(uri)); 
```

}

# iis - IISExpress 添加网站路径

> ID：11959354
> 
> 赞同：8
> 
> 时间：2012-08-14T19:24:42.537
> 
> 标签：iis

我有一个网站在 IIS express 上运行良好，直到我想添加第二个网站并让它们都运行相同的端口号。现在我不知道如何走正确的路。当我在运行 iis express 后浏览到该站点时，它会抱怨一个错误：

无法识别的配置路径“MACHINE/WEBROOT/APPHOST/RISWEB”

并且 IIS Express 返回错误 500.19

这是我的配置。当我将路径设置为“/”时，它可以工作，但是当它是其他东西时它不会。我想浏览 http://c65273/risweb 并显示我的网站。

```
 <site name="RISWEB" id="1834812154">
            <application path="/risweb" applicationPool="ConnectPool">
                <virtualDirectory path="/risweb" physicalPath="C:\c2010\risweb\RISWEB" />
            </application>
            <bindings>
                <binding protocol="http" bindingInformation="*:80:c65273" />
            </bindings>
        </site> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-30T17:36:01.247

我遇到了类似的问题，并且能够通过执行以下操作来解决它：

1.  从我的站点中删除该站点的配置部分`applicationhost.config`
2.  在 Visual Studio 中，转到`Project Properties`>`Web`选项卡，然后单击`Create Virtual Directory`让 VS 重新创建配置部分。

然后它工作正常，生成的配置部分将如下所示：

```
<site name="WebDemos-Site" id="5">
  <application path="/" applicationPool="Clr4IntegratedAppPool">
    <virtualDirectory path="/" physicalPath="C:\Users\rvesse\Documents\My Web Sites\WebDemos-Site" />
  </application>
  <application path="/demos">
    <virtualDirectory path="/" physicalPath="C:\Users\rvesse\Documents\mercurial\dotnetrdf\Samples\WebDemos" />
  </application>
  <bindings>
    <binding protocol="http" bindingInformation="*:64132:localhost" />
  </bindings>
</site> 
```

注意VS会为网站根目录生成一个空网站

# django - 使用带有自定义查询的 Django ListView

> ID：11959358
> 
> 赞同：0
> 
> 时间：2012-08-14T19:24:49.183
> 
> 标签：django

我有一组 django 模型，如下所示：

```
class Foo(models.Model):
    ...

class FooVersion(models.Model):
    name = models.CharField(max_length=100)
    parent = models.ForeignKey(Foo)
    version = models.FloatField()
    ... 
```

我正在尝试创建一个显示所有 Foos 的 Django ListView，按其最高版本名称的字母顺序排列。例如，如果我有一个如下所示的数据集：

```
version_id | id |           version_name            | version 
-----------+----+-----------------------------------+---------
         1 | 1  | Test 1                            |      1.0
         2 | 1  | Test 2                            |      2.0
         3 | 1  | Test 2                            |      3.0
         4 | 2  | Test 1                            |      1.0
         5 | 1  | Test 3                            |      2.5
         6 | 3  | Test 3                            |      1.0 
```

我希望查询返回：

```
version_id | id |           version_name            | version 
-----------+----+-----------------------------------+---------
         4 | 2  | Test 1                            |      1.0
         3 | 1  | Test 2                            |      3.0
         6 | 3  | Test 3                            |      1.0 
```

我将用来生成它的原始 sql 是：

```
SELECT version_class.id as version_id, someapp_foo.id, version_class.name as version_name, version_class.version
FROM someapp_foo
INNER JOIN(
    SELECT someapp_fooversion.name, someapp_fooversion.version, someapp_fooversion.parent_id, someapp_fooversion.id
    FROM someapp_fooversion
    INNER JOIN(
        SELECT parent_id, max(version) AS version
    FROM courses_courseversion GROUP BY parent_id)
AS current_version ON current_version.parent_id = someapp_fooversion.parent_id
AND current_version.version = someapp_fooversion.version)
AS version_class ON version_class.parent_id = someapp_foo.id
ORDER BY version_name; 
```

但是我在使用原始查询时遇到了问题，因为 RawQuerySet 对象没有“count”方法，ListView 调用该方法进行分页。我已经研究了 Django 查询集的“额外”功能，但是我在制定一个可以使用它的查询时遇到了麻烦。

我将如何制定一个“额外”的查询来获得我正在寻找的东西？或者有没有办法将 RawQuerySet 转换为常规 QuerySet？任何其他可能的解决方案来获得我正在寻找的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:46:49.173

可能有更好的方法来做到这一点，但现在我正在尝试一个似乎有效的自定义解决方案：

```
from django.db import models
from django.db.models.query import RawQuerySet

class CountableRawQuerySet(RawQuerySet):
   def count(self):
       return sum([1 for obj in self])

class FooManager(models.Manager):
    def raw(self, raw_query, params=None, *args, **kwargs):
        return CountableRawQuerySet(raw_query=raw_query, model=self.model, params=params, using=self._db, *args, **kwargs)

class Foo(models.Model):
    objects = FooManager() 
```

然后我的查询集是：

```
Foo.objects.raw(sql) 
```

关于如何改进的建议？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T22:37:47.553

首先-您的解决方案是错误的，并且对大量数据非常无效。我相信你只需要这样的东西：

```
from django.db.models import Max
Foo.objects.annotate(max_version=Max(fooversion__version)) 
```

您现在可以`max_version`将每个结果中的属性称为普通属性。有关详细信息，请参阅[https://docs.djangoproject.com/en/dev/topics/db/aggregation/](https://docs.djangoproject.com/en/dev/topics/db/aggregation/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-09T09:22:34.713

要补充的另一点是，只要您不使用分页，RawQuerySet 就可以与 ListView 一起正常工作，即您可以`paginate_by = NN`从 ListView 子类中省略该属性。

# php - 正则表达式语法问题

> ID：11959363
> 
> 赞同：-2
> 
> 时间：2012-08-14T19:25:07.687
> 
> 标签：php, regex, function, url, preg-replace

> **可能重复：**
> [微调正则表达式以跳过标签](https://stackoverflow.com/questions/11958903/finetune-regex-to-skip-tags)

目前我的功能看起来像这样。它将纯文本 URL 转换为 HTML 链接。

```
function UrlsToLinks($text){
    return preg_replace('@(https?://([-\w\.]+)+(:\d+)?(/([\w/_\.-]*(\?\S+)?)?)?)@', '<a href="$1" target="_blank">$1</a>', $text);
} 
```

但也有一些问题。我想要做的是跳过现有的链接、标签中的`src`属性`<img>`等。无法弄清楚我需要在这个函数中修改什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:04:28.860

假设我们要替换的 URL 尚未在标签内，这将起作用。

```
function UrlsToLinks($text){
    $matches = array();
    $strippedText = strip_tags($text);

    preg_match_all('@(https?://([-\w\.]+)+(:\d+)?(/([\w/_\.-]*(\?\S+)?)?)?)@', $strippedText, $matches);

    foreach ($matches[0] as $match) {       
        if (filter_var($match, FILTER_VALIDATE_URL)) {
            $text = str_replace($match, '<a href="'.$match.'" target="_blank">'.$match.'</a>', $text);
        }
    }
    return $text;
} 
```

# jquery - JQuery 从 Ajax 更改复选框状态

> ID：11959369
> 
> 赞同：1
> 
> 时间：2012-08-14T19:25:31.970
> 
> 标签：jquery, ajax, checkbox

我的代码中有一个小问题。我有一个函数，它需要 loadData AJAX 页面。这个结果在我的页面上放置了复选框。（还行吧）

现在我想当我单击一个复选框时，执行一个 AJAX 请求是更改数据库中的一个值（这也可以）。

问题是：当我单击一个复选框（未选中）时，它会打勾并执行 ajax，一旦执行了 ajax，该框就会单独取消选中。

我进行了几次测试，我意识到只有当 Ajax 请求中的复选框被选中时才会出现问题。

注意：我尝试添加 $(selector).attr('checked', true) 和 false，但没有任何效果。

Jquery（问题出在执行Ajax时的loadData函数中，仅取消选中复选框）：

```
 $(document).ready(function()  {
    $('#TableContainer .RCkbox').live('click',function(){

        var idOperation = 550;
        if($(this).is(":checked")){

            $.ajax({
                type: "POST",
                url: "includes/ajax/OperationRapprochement.php",
                data: "sessionId=" + <?php echo $User->getId(); ?> + "&AccountNumber=" + <?php echo $compte->getId(); ?> + "&idOperation=" + idOperation + "&action=rapproche",
                success: function(msg)
                {
                    //TODO  

                }
            });
        }
        else{

                $.ajax({
                type: "POST",
                url: "includes/ajax/OperationRapprochement.php",
                data: "sessionId=" + <?php echo $User->getId(); ?> + "&AccountNumber=" + <?php echo $compte->getId(); ?> + "&idOperation=" + idOperation + "&action=derapproche",
                success: function(msg)
                {
                      //TODO

                }
            });
       }
    });

    function loadData(){
    $.ajax({
            type: "POST",
            url: "includes/ajax/test.php",
            data: "sessionId=" + <?php echo $User->getId(); ?> + "&AccountNumber=" + <?php echo $compte->getId(); ?>,
            success: function(msg){
                    $("#TableContainer").ajaxComplete(function(event, request, settings){
                           $("#TableContainer").html(msg);
                    });
            }
        });
    }

    loadData();
}); 
```

我制作了视频来向您展示实际存在的问题：http: [//youtu.be/nG9XF2f4M18](http://youtu.be/nG9XF2f4M18)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:38:27.890

**答案是根据我在评论中获得的信息更新的**

我在你的文件中发现了问题。

问题是您使用事件“.ajaxComplete”。如果您正确阅读了[文档](http://api.jquery.com/ajaxComplete/)，它会说每次进行 ajax 调用时都会调用该事件。

因此，由于您在单击复选框时进行了 ajax 调用，因此当您收到结果时，会再次调用 loadData 函数中的回调，这意味着它会再次执行`$("#TableContainer").html(msg);`......换句话说，它会再次替换内容。这就是您丢失选中复选框的原因。

您需要在代码中更改的所有内容就是删除事件`.ajaxComplete`，因为您不需要它们。

这是你的代码：

```
function loadData(){
    $.ajax
    ({
        type: "POST",
        url: "includes/ajax/test.php",
        data: "number=" + number,
        success: function(msg)
        {
            $("#TableContainer").ajaxComplete(function(event, request, settings) {
                $("#TableContainer").html(msg);
            });
        }
    });
} 
```

它应该是：

```
function loadData(){
    $.ajax
    ({
        type: "POST",
        url: "includes/ajax/test.php",
        data: "number=" + number,
        success: function(msg)
        {
                $("#TableContainer").html(msg);
        }
    });
} 
```

您的其他 2 个 ajax 请求也是如此。成功的代码在收到结果时被执行。

# c++ - 最快的内联组装自旋锁

> ID：11959374
> 
> 赞同：26
> 
> 时间：2012-08-14T19:26:00.613
> 
> 标签：c++, assembly, x86, memory-barriers, spinlock

我正在用 c++ 编写一个多线程应用程序，其中性能至关重要。在线程之间复制小型结构时，我需要使用大量锁定，为此我选择使用自旋锁。

我对此进行了一些研究和速度测试，我发现大多数实现大致同样快：

*   Microsoft 的 CRITICAL_SECTION，SpinCount 设置为 1000，得分约 140 个时间单位
*   使用 Microsoft 的 InterlockedCompareExchange实现[此算法](http://www.modula2.org/sb/env/index34.htm)的得分约为 95 个时间单位
*   我还尝试使用一些内联汇编来`__asm {}`使用类似[此代码](https://stackoverflow.com/questions/11923151/is-there-any-simple-way-to-improve-performance-of-this-spinlock-function)的内容，它的得分约为 70 个时间单位，**但我不确定是否已创建适当的内存屏障。**

编辑：这里给出的时间是 2 个线程锁定和解锁自旋锁 1,000,000 次所需的时间。

我知道这并没有太大的区别，但是由于自旋锁是一个被大量使用的对象，人们会认为程序员会同意最快的方法来制作自旋锁。然而，谷歌搜索它会导致许多不同的方法。如果使用内联汇编并使用指令而不是比较 32 位寄存器来实现，我认为[上述方法](http://www.modula2.org/sb/env/index34.htm)将是最快的。**此外，必须考虑内存屏障，这可以通过 LOCK CMPXHG8B （我认为？）来完成**，它保证了内核之间共享内存的“独占权”。最后[有人建议]对于**繁忙的等待应该伴随着 NOP:REP**`CMPXCHG8B`****这将使超线程处理器能够切换到另一个线程，但我不确定这是否属实？****

 ****从我对不同自旋锁的性能测试来看，没有太大区别，但出于纯粹的学术目的，我想知道哪一个最快。但是，由于我在汇编语言和内存屏障方面的经验非常有限，如果有人可以为我提供的最后一个示例编写汇编代码，我会很高兴，并在以下模板中提供了 LOCK CMPXCHG8B 和**适当的内存屏障：**

```
__asm
{
     spin_lock:
         ;locking code.
     spin_unlock:
         ;unlocking code.
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-16T04:22:56.773

尽管已经有一个公认的答案，但仍有一些遗漏的东西可以用来改进所有答案，取自[这篇英特尔文章，所有这些都高于快速锁实现](http://software.intel.com/en-us/articles/implementing-scalable-atomic-locks-for-multi-core-intel-em64t-and-ia32-architectures/)：

1.  旋转易失性读取，而不是原子指令，这避免了不必要的总线锁定，尤其是在高度竞争的锁上。
2.  对竞争激烈的锁使用回退
3.  内联锁，最好使用内联 asm 有害的编译器的内在函数（基本上是 MSVC）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-19T17:57:10.987

我通常不会抱怨有人努力实现快速代码：这通常是一个很好的练习，可以更好地理解编程和更快的代码。

我也不会在这里抱怨，但我可以明确指出，快速自旋锁 3 条指令或更多指令的问题 - 至少在 x86 架构上 - 是徒劳的。

原因如下：

使用典型的代码序列调用自旋锁

```
lock_variable DW 0    ; 0 <=> free

mov ebx,offset lock_variable
mov eax,1
xchg eax,[ebx]

; if eax contains 0 (no one owned it) you own the lock,
; if eax contains 1 (someone already does) you don't 
```

释放自旋锁是微不足道的

```
mov ebx,offset lock_variable
mov dword ptr [ebx],0 
```

xchg 指令提高了处理器上的锁定引脚，这实际上意味着我想要在接下来的几个时钟周期内使用总线。该信号通过高速缓存传递到最慢的总线主控设备，通常是 PCI 总线。当每个总线主控设备完成后，locka（锁定确认）信号就会被发回。然后进行实际的交换。问题是 lock/locka 序列需要很长时间。PCI 总线可能以 33MHz 运行，有几个延迟周期。在 3.3 GHz CPU 上，这意味着每个 PCI 总线周期需要一百个 CPU 周期。

根据经验，我假设一个锁需要 300 到 3000 个 CPU 周期才能完成，最后我什至不知道我是否会拥有这个锁。因此，您可以通过“快速”自旋锁节省的几个周期将是海市蜃楼，因为没有像下一个锁那样，这将取决于您在那段时间内的总线情况。

________________编辑________________

我刚刚读到自旋锁是一个“大量使用的对象”。好吧，您显然不明白自旋锁在每次调用时都会消耗大量的 CPU 周期。或者，换一种说法，每次调用它都会失去大量的处理能力。

使用自旋锁（或它们更大的兄弟，临界区）时的技巧是尽可能少地使用它们，同时仍能实现预期的程序功能。在所有地方使用它们很容易，因此您最终会表现不佳。

不仅仅是编写快速代码，还包括组织数据。当您编写“在线程之间复制小型结构”时，您应该意识到完成锁定可能需要比实际复制长数百倍的时间。

________________编辑________________

当您计算平均锁定时间时，它可能会说得很少，因为它是在您的机器上测量的，这可能不是预期的目标（可能具有完全不同的总线使用特性）。对于您的机器，平均值将由各个非常快的时间（当总线主控活动没有干扰时）一直到非常慢的时间（当总线主控干扰很大时）组成。

您可以引入确定最快和最慢情况的代码并计算商以查看自旋锁时间的变化有多大。

________________编辑________________

2016 年 5 月更新。

Peter Cordes 提倡“在非竞争情况下调整锁是有意义的”，并且现代 CPU 上不会出现数百个时钟周期的锁时间，除非在锁变量未对齐的情况下。我开始怀疑我[之前的测试程序](https://stackoverflow.com/questions/4912467/c-c-unsynchronized-threads-returning-a-strange-result/4921880#4921880)（用 32 位 Watcom C 编写）是否会受到 WOW64 的阻碍，因为它运行在 64 位操作系统：Windows 7 上。

于是我写了一个64位的程序，用TDM的gcc 5.3编译。该程序使用隐式总线锁定指令变体“XCHG r,m”进行锁定，使用简单的赋值“MOV m,r”进行解锁。在某些锁变体中，锁变量经过预先测试以确定尝试锁是否可行（使用简单的比较“CMP r,m”，可能不会冒险到 L3 之外）。这里是：

```
// compiler flags used:

// -O1 -m64 -mthreads -mtune=k8 -march=k8 -fwhole-program -freorder-blocks -fschedule-insns -falign-functions=32 -g3 -Wall -c -fmessage-length=0

#define CLASSIC_BUS_LOCK
#define WHILE_PRETEST
//#define SINGLE_THREAD

typedef unsigned char      u1;
typedef unsigned short     u2;
typedef unsigned long      u4;
typedef unsigned int       ud;
typedef unsigned long long u8;
typedef   signed char      i1;
typedef          short     i2;
typedef          long      i4;
typedef          int       id;
typedef          long long i8;
typedef          float     f4;
typedef          double    f8;

#define usizeof(a) ((ud)sizeof(a))

#define LOOPS 25000000

#include <stdio.h>
#include <windows.h>

#ifndef bool
typedef signed char bool;
#endif

u8 CPU_rdtsc (void)
{
  ud tickl, tickh;
  __asm__ __volatile__("rdtsc":"=a"(tickl),"=d"(tickh));
  return ((u8)tickh << 32)|tickl;
}

volatile u8 bus_lock (volatile u8 * block, u8 value)
{
  __asm__ __volatile__( "xchgq %1,%0" : "=r" (value) : "m" (*block), "0" (value) : "memory");

  return value;
}

void bus_unlock (volatile u8 * block, u8 value)
{
  __asm__ __volatile__( "movq %0,%1" : "=r" (value) : "m" (*block), "0" (value) : "memory");
}

void rfence (void)
{
  __asm__ __volatile__( "lfence" : : : "memory");
}

void rwfence (void)
{
  __asm__ __volatile__( "mfence" : : : "memory");
}

void wfence (void)
{
  __asm__ __volatile__( "sfence" : : : "memory");
}

volatile bool LOCK_spinlockPreTestIfFree (const volatile u8 *lockVariablePointer)
{
  return (bool)(*lockVariablePointer == 0ull);
}

volatile bool LOCK_spinlockFailed (volatile u8 *lockVariablePointer)
{
  return (bool)(bus_lock (lockVariablePointer, 1ull) != 0ull);
}

void LOCK_spinlockLeave (volatile u8 *lockVariablePointer)
{
  *lockVariablePointer = 0ull;
}

static volatile u8 lockVariable = 0ull,
                   lockCounter =  0ull;

static volatile i8 threadHold = 1;

static u8 tstr[4][32];    /* 32*8=256 bytes for each thread's parameters should result in them residing in different cache lines */

struct LOCKING_THREAD_STRUCTURE
{
  u8 numberOfFailures, numberOfPreTests;
  f8 clocksPerLock, failuresPerLock, preTestsPerLock;
  u8 threadId;
  HANDLE threadHandle;
  ud idx;
} *lts[4] = {(void *)tstr[0], (void *)tstr[1], (void *)tstr[2], (void *)tstr[3]};

DWORD WINAPI locking_thread (struct LOCKING_THREAD_STRUCTURE *ltsp)
{
  ud n = LOOPS;
  u8 clockCycles;

  SetThreadAffinityMask (ltsp->threadHandle, 1ull<<ltsp->idx);

  while (threadHold) {}

  clockCycles = CPU_rdtsc ();
  while (n)
  {
    Sleep (0);

#ifdef CLASSIC_BUS_LOCK
    while (LOCK_spinlockFailed (&lockVariable)) {++ltsp->numberOfFailures;}
#else
#ifdef WHILE_PRETEST
    while (1)
    {
      do
      {
        ++ltsp->numberOfPreTests;
      } while (!LOCK_spinlockPreTestIfFree (&lockVariable));

      if (!LOCK_spinlockFailed (&lockVariable)) break;
      ++ltsp->numberOfFailures;
    }
#else
    while (1)
    {
      ++ltsp->numberOfPreTests;
      if (LOCK_spinlockPreTestIfFree (&lockVariable))
      {
        if (!LOCK_spinlockFailed (&lockVariable)) break;
        ++ltsp->numberOfFailures;
      }
    }
#endif
#endif
    ++lockCounter;
    LOCK_spinlockLeave (&lockVariable);

#ifdef CLASSIC_BUS_LOCK
    while (LOCK_spinlockFailed (&lockVariable)) {++ltsp->numberOfFailures;}
#else
#ifdef WHILE_PRETEST
    while (1)
    {
      do
      {
        ++ltsp->numberOfPreTests;
      } while (!LOCK_spinlockPreTestIfFree (&lockVariable));

      if (!LOCK_spinlockFailed (&lockVariable)) break;
      ++ltsp->numberOfFailures;
    }
#else
    while (1)
    {
      ++ltsp->numberOfPreTests;
      if (LOCK_spinlockPreTestIfFree (&lockVariable))
      {
        if (!LOCK_spinlockFailed (&lockVariable)) break;
        ++ltsp->numberOfFailures;
      }
    }
#endif
#endif
    --lockCounter;
    LOCK_spinlockLeave (&lockVariable);

    n-=2;
  }
  clockCycles = CPU_rdtsc ()-clockCycles;

  ltsp->clocksPerLock =   (f8)clockCycles/           (f8)LOOPS;
  ltsp->failuresPerLock = (f8)ltsp->numberOfFailures/(f8)LOOPS;
  ltsp->preTestsPerLock = (f8)ltsp->numberOfPreTests/(f8)LOOPS;

//rwfence ();

  ltsp->idx = 4u;

  ExitThread (0);
  return 0;
}

int main (int argc, char *argv[])
{
  u8 processAffinityMask, systemAffinityMask;

  memset (tstr, 0u, usizeof(tstr));

  lts[0]->idx = 3;
  lts[1]->idx = 2;
  lts[2]->idx = 1;
  lts[3]->idx = 0;

  GetProcessAffinityMask (GetCurrentProcess(), &processAffinityMask, &systemAffinityMask);

  SetPriorityClass (GetCurrentProcess(), HIGH_PRIORITY_CLASS);
  SetThreadAffinityMask (GetCurrentThread (), 1ull);

  lts[0]->threadHandle = CreateThread (NULL, 65536u, (void *)locking_thread, (void *)lts[0], 0, (void *)&lts[0]->threadId);
#ifndef SINGLE_THREAD
  lts[1]->threadHandle = CreateThread (NULL, 65536u, (void *)locking_thread, (void *)lts[1], 0, (void *)&lts[1]->threadId);
  lts[2]->threadHandle = CreateThread (NULL, 65536u, (void *)locking_thread, (void *)lts[2], 0, (void *)&lts[2]->threadId);
  lts[3]->threadHandle = CreateThread (NULL, 65536u, (void *)locking_thread, (void *)lts[3], 0, (void *)&lts[3]->threadId);
#endif

  SetThreadAffinityMask (GetCurrentThread (), processAffinityMask);

  threadHold = 0;

#ifdef SINGLE_THREAD
  while (lts[0]->idx<4u) {Sleep (1);}
#else
  while (lts[0]->idx+lts[1]->idx+lts[2]->idx+lts[3]->idx<16u) {Sleep (1);}
#endif

  printf ("T0:%1.1f,%1.1f,%1.1f\n", lts[0]->clocksPerLock, lts[0]->failuresPerLock, lts[0]->preTestsPerLock);
  printf ("T1:%1.1f,%1.1f,%1.1f\n", lts[1]->clocksPerLock, lts[1]->failuresPerLock, lts[1]->preTestsPerLock);
  printf ("T2:%1.1f,%1.1f,%1.1f\n", lts[2]->clocksPerLock, lts[2]->failuresPerLock, lts[2]->preTestsPerLock);
  printf ("T3:%1.1f,%1.1f,%1.1f\n", lts[3]->clocksPerLock, lts[3]->failuresPerLock, lts[3]->preTestsPerLock);

  printf ("T*:%1.1f,%1.1f,%1.1f\n", (lts[0]->clocksPerLock+  lts[1]->clocksPerLock+  lts[2]->clocksPerLock+  lts[3]->clocksPerLock)/  4.,
                                    (lts[0]->failuresPerLock+lts[1]->failuresPerLock+lts[2]->failuresPerLock+lts[3]->failuresPerLock)/4.,
                                    (lts[0]->preTestsPerLock+lts[1]->preTestsPerLock+lts[2]->preTestsPerLock+lts[3]->preTestsPerLock)/4.);

  printf ("LC:%u\n", (ud)lockCounter);

  return 0;
} 
```

该程序在基于 DELL i5-4310U 的计算机上运行，​​该计算机具有 DDR3-800、2 个内核/2 个 2.7GHz 的 HT 和一个通用的 L3 缓存。

首先，WOW64 的影响似乎可以忽略不计。

执行非竞争锁定/解锁的单个线程能够每 110 个周期执行一次。调整无争用锁是没有用的：为增强单个 XCHG 指令而添加的任何代码只会使其变慢。

随着四个 HT 用锁定尝试轰炸锁定变量，情况发生了根本性的变化。实现成功锁定所需的时间跃升至 994 个周期，其中很大一部分可归因于 2.2 次失败的锁定尝试。换句话说，在高争用情况下，平均必须尝试 3.2 次锁才能获得成功的锁。显然110个周期并没有变成110*3.2而是更接近110*9。因此，其他机制在这里发挥作用，就像在旧机器上的测试一样。此外，平均 994 个周期包含 716 和 1157 之间的范围

The lock variants implementing pre-testing required about 95% of the cycles reuired by the simplest variant (XCHG). On average they would perform 17 CMPs to find it feasible to attempt 1.75 locks of which 1 was successful. I recommend using pre-testing not only because it is faster: it imposes less strain on the bus-locking mechanism (3.2-1.75=1.45 fewer lock attempts) even though it increases the complexity slightly.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-14T19:57:46.193

维基百科有一篇关于自旋锁的好文章，这里是 x86 实现

[http://en.wikipedia.org/wiki/Spinlock#Example_implementation](http://en.wikipedia.org/wiki/Spinlock#Example_implementation)

请注意，它们的实现不使用“lock”前缀，因为它在 x86 上对于“xchg”指令是多余的——它隐含地具有锁定语义，正如 Stackoverflow 讨论中所讨论的：

[在多核 x86 上，是否需要 LOCK 作为 XCHG 的前缀？](https://stackoverflow.com/questions/3144335/on-a-multicore-x86-is-a-lock-necessary-as-a-prefix-to-xchg)

REP:NOP 是 PAUSE 指令的别名，您可以在此处了解更多信息

[x86 暂停指令如何在自旋锁中工作*并且*它可以在其他场景中使用吗？](https://stackoverflow.com/questions/4725676/how-does-x86-pause-instruction-work-in-spinlock-and-can-it-be-used-in-other-sc)

关于内存屏障的问题，这里有你可能想知道的一切

内存屏障：软件黑客的硬件视图 Paul E. McKenney

[http://irl.cs.ucla.edu/~yingdi/paperreading/whymb.2010.06.07c.pdf](http://irl.cs.ucla.edu/~yingdi/paperreading/whymb.2010.06.07c.pdf)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-14T19:36:12.093

看看这里： [x86 spinlock using cmpxchg](https://stackoverflow.com/questions/6935442/x86-spinlock-using-cmpxchg)

感谢科里·尼尔森

```
__asm{
spin_lock:
xorl %ecx, %ecx
incl %ecx
spin_lock_retry:
xorl %eax, %eax
lock; cmpxchgl %ecx, (lock_addr)
jnz spin_lock_retry
ret

spin_unlock:
movl $0 (lock_addr)
ret
} 
```

另一个消息来源说： [http ://www.geoffchappell.com/studies/windows/km/cpu/cx8.htm](http://www.geoffchappell.com/studies/windows/km/cpu/cx8.htm)

```
 lock    cmpxchg8b qword ptr [esi]
is replaceable with the following sequence

try:
        lock    bts dword ptr [edi],0
        jnb     acquired
wait:
        test    dword ptr [edi],1
        je      try
        pause                   ; if available
        jmp     wait

acquired:
        cmp     eax,[esi]
        jne     fail
        cmp     edx,[esi+4]
        je      exchange

fail:
        mov     eax,[esi]
        mov     edx,[esi+4]
        jmp     done

exchange:
        mov     [esi],ebx
        mov     [esi+4],ecx

done:
        mov     byte ptr [edi],0 
```

这里是关于无锁与锁实现的讨论：http: [//newsgroups.derkeiler.com/Archive/Comp/comp.programming.threads/2011-10/msg00009.html](http://newsgroups.derkeiler.com/Archive/Comp/comp.programming.threads/2011-10/msg00009.html)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-14T20:19:55.857

只是问问：

在深入研究自旋锁和几乎无锁的数据结构之前：

您是否 - 在您的基准测试和您的应用程序中 - 确保竞争线程保证在不同的内核上运行？

如果不是这样，您最终可能会得到一个在您的开发机器上运行良好但在该领域很糟糕/失败的程序，因为一个线程必须同时是您的自旋锁的锁定器和解锁器。

给你一个数字：在 Windows 上，你有 10 毫秒的标准时间片。如果您不确定两个物理线程参与锁定/解锁，您最终将每秒锁定/解锁大约 500 次，结果将非常*糟糕*****

# php - php 只允许字符串中有一个句点

> ID：11959376
> 
> 赞同：1
> 
> 时间：2012-08-14T19:26:12.093
> 
> 标签：php, post, preg-replace

我已经在这个代码上工作了几个小时，但我似乎无法让它工作。我有一个输入字段，允许用户提交某个项目的价格。这是所需的过程：

```
//Get the post it price and only allow numbers and one period|dot
$price = $_POST['price'];
$price = preg_replace('#[^0-9.]#i', '', $_POST['price']); 
```

所以我只想允许每个字符串有一个句点，所以如果用户输入 100.00.00，它将更正并删除第一个句点并将其转换为 10000.00 在此之后，我想为每个第三个字符添加一个逗号，如下所示：
如果发布的价格是 10000.00，它将转换为 10,000.00。
有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:34:12.793

```
$string = "100.00.00";

$array = explode(".", $string);

$last = array_pop($array);

echo number_format(implode("", $array)) . "." . $last; 
```

[http://codepad.viper-7.com/t1WuGK](http://codepad.viper-7.com/t1WuGK)

# datetime - Solrnet 日期时间格式

> ID：11959379
> 
> 赞同：0
> 
> 时间：2012-08-14T19:26:19.217
> 
> 标签：datetime, solrnet

我有一个使用 SolrNet 更新 Solr 中的文档的过程，这些文档最初填充了从数据库导入的数据。

我在使用 DateTime 格式时遇到问题，因为从数据库索引的文档具有这样的日期时间

```
<str name="Date">2012-08-07 16:00:27.32</str> 
```

并且用 solrnet 索引的文档具有这样的日期时间

```
<str name="Date">2012-08-14T15:57:30Z</str> 
```

我需要它们像第一个一样，因为当我用 c# 阅读文档时，日期 2012-08-14T15:57:30Z 被解释为 2012-08-14 12:57:30 我不知道为什么.

坦克！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:29:33.280

我做了一件非常丑陋的事情，但它完成了工作。我将其保存为字符串并应用

```
.ToString("yyyy-MM-dd HH:mm:ss.ff") 
```

给它。

不管怎么说，还是要谢谢你！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-05T11:01:42.013

2012-08-14T15:57:30Z 转换为 2012-08-14 12:57:30 的原因是因为之前的格式是 UTC，即 +0。我假设您在 UTC-3 的语言环境中运行，因此当您将时间戳转换为本地 DateTime 时，它​​会适当地扣除您所在时区的 3 小时。尽管 15:57 UTC+0 是 12:57 UTC-3，但它本质上是同一时间。

# c# - 如何从枚举成员中获取 DescriptionAttribute 值

> ID：11959380
> 
> 赞同：3
> 
> 时间：2012-08-14T19:26:20.730
> 
> 标签：c#, attributes

我有一个枚举类型

```
public enum DataType:int
    {   
        None = 0,
        [Description("A")]
        Alpha = 1,
        [Description("N")]
        Numeric,
        [Description("AN")]
        AlphaNumeric,
        [Description("D")]
        Date
    } 
```

如何检索 Alpha 的描述属性值。

例如（理想）：`DataType.Alpha.Attribute`应该给出**“A”**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-14T19:35:16.870

用这个

```
private string GetEnumDescription(Enum value)
{
    // Get the Description attribute value for the enum value
    FieldInfo fi = value.GetType().GetField(value.ToString());
    DescriptionAttribute[] attributes = (DescriptionAttribute[])fi.GetCustomAttributes(typeof(DescriptionAttribute), false);

    if (attributes.Length > 0)
        return attributes[0].Description;
    else
        return value.ToString();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T19:29:08.150

我有一个扩展方法可以做到这一点：

```
public static string GetDescription(this Enum enumValue)
    {
        //Look for DescriptionAttributes on the enum field
        object[] attr = enumValue.GetType().GetField(enumValue.ToString())
            .GetCustomAttributes(typeof (DescriptionAttribute), false);

        if (attr.Length > 0) // a DescriptionAttribute exists; use it
            return ((DescriptionAttribute) attr[0]).Description;

        //The above code is all you need if you always use DescriptionAttributes;
        //If you don't, the below code will semi-intelligently 
        //"humanize" an UpperCamelCased Enum identifier
        string result = enumValue.ToString();

        //"FooBar" -> "Foo Bar"
        result = Regex.Replace(result, @"([a-z])([A-Z])", "$1 $2");

        //"Foo123" -> "Foo 123"
        result = Regex.Replace(result, @"([A-Za-z])([0-9])", "$1 $2");

        //"123Foo" -> "123 Foo"
        result = Regex.Replace(result, @"([0-9])([A-Za-z])", "$1 $2");

        //"FOOBar" -> "FOO Bar"
        result = Regex.Replace(result, @"(?<!^)(?<! )([A-Z][a-z])", " $1");

        return result;
    } 
```

用法：

```
var description = DataType.Alpha.GetDescription(); //"A"

public enum TestEnums
{
   IAmAComplexABCEnumValue,
}

//"I Am A Complex ABC Enum Value"
var complexCamelCasedDescription = TestEnums.IAmAComplexABCEnumValue.GetDescription(); 
```

# regex - 使用 perl 替换文本字符串中的单位时间戳

> ID：11959381
> 
> 赞同：-2
> 
> 时间：2012-08-14T19:26:25.987
> 
> 标签：regex, perl, unix-timestamp

好的，我有一个包含两列数据的数据文件。它们是 RecordNumber 和 Notes。它们被管道隔开，看起来像这样。

```
Record1|1234567890 username notes notes notes notes 1254184921 username notes notes notes notes| 
```

... 这持续了数千条记录。

使用 perl 脚本（可能还有一些正则表达式）我需要获取 notes 列并将其解析出来，以使 3 个新列用管道分隔以加载到表中。列必须是`Note_Date|Note_Username|Note_Text`.

注释列中的 10 位数字字符串是一个 unix 时间戳。我的第二个任务是将其转换为常规时间戳。请，任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:03:58.717

您可能需要根据需要进行修改：

```
use strict;
use warnings;

while (<>) {
        my @a = split(/\|/);
        while ($a[1]=~/\s*(\d+)\s+(\w+)\s+([^0-9]*)/g) {
                my ($t, $u, $n) = ($1, $2, $3);
                $t = localtime($t);
                print $a[0], "|$t $u $n|\n";
        }
} 
```

# javascript - 如何使用搜索查询表单？

> ID：11959382
> 
> 赞同：1
> 
> 时间：2012-08-14T19:26:28.333
> 
> 标签：javascript, jquery, forms, twitter-bootstrap

我有以下表格：

```
<form class="navbar-search pull-left" action="http://www.example.com/movie/<id>" id="get-movie-form">
    <input type="text" class="search-query" placeholder="Input user id" id="get-movie">
</form> 
```

提交表单/用户按下 Enter 后，它应该发送 GET 请求到`http://www.example.com/movie/<id>`，其中`<id>`应该替换为用户输入值。

看起来我首先应该做的是防止默认表单提交。我试过以下代码：

```
$("#get-movie-form").click(function(e) {
  e.preventDefault();
  return false;
}); 
```

但它不起作用 - 无论如何都会提交表单。

如何做我上面描述的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:28:18.770

尝试

```
$("#get-movie-form").on("submit", function(e) {
    e.preventDefault();
    return false;
}); 
```

# ruby-on-rails - 设计路线错误

> ID：11959385
> 
> 赞同：0
> 
> 时间：2012-08-14T19:26:36.897
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, devise

我今天才开始使用设计，我修改了 session#new.html.erb 文件以满足我的需要。我创建了一个名为 Register 的链接如下

```
<%= link_to "REGISTER", "new_customer_registration_path" %> 
```

但是，当我单击链接时，它会将我引导至无路由错误

```
Routing Error
No route matches [GET] "/customers/new_customer_registration_path" 
```

这是我的耙子路线

```
 new_customer_session GET    /customers/sign_in(.:format)         devise/sessions#new
            customer_session POST   /customers/sign_in(.:format)         devise/sessions#create
    destroy_customer_session DELETE /customers/sign_out(.:format)        devise/sessions#destroy
           customer_password POST   /customers/password(.:format)        devise/passwords#create
       new_customer_password GET    /customers/password/new(.:format)    devise/passwords#new
      edit_customer_password GET    /customers/password/edit(.:format)   devise/passwords#edit
                             PUT    /customers/password(.:format)        devise/passwords#update
cancel_customer_registration GET    /customers/cancel(.:format)          devise/registrations#cancel
       customer_registration POST   /customers(.:format)                 devise/registrations#create
   new_customer_registration GET    /customers/sign_up(.:format)         devise/registrations#new
  edit_customer_registration GET    /customers/edit(.:format)            devise/registrations#edit
                             PUT    /customers(.:format)                 devise/registrations#update
                             DELETE /customers(.:format)                 devise/registrations#destroy
                      events GET    /events(.:format)                    events#index
                             POST   /events(.:format)                    events#create
                   new_event GET    /events/new(.:format)                events#new
                  edit_event GET    /events/:id/edit(.:format)           events#edit
                       event GET    /events/:id(.:format)                events#show
                             PUT    /events/:id(.:format)                events#update
                             DELETE /events/:id(.:format)                events#destroy
                        root        /                                    events#index 
```

我的路线文件他已经跟随

```
 devise_for :customers
  resources :events
  root :to => 'events#index'
  match '/new_customer_registration' => "devise/registrations#new" 
```

我被重定向到发生错误的这个页面。

```
http://localhost:3000/customers/new_customer_registration_path 
```

我该如何使用它？预先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:28:54.987

它不应该是字符串，而是方法

```
<%= link_to "REGISTER", new_customer_registration_path %> 
```

# android - 可以处理 Android SQL 数据库中的字符串本地化吗？

> ID：11959387
> 
> 赞同：2
> 
> 时间：2012-08-14T19:26:41.837
> 
> 标签：android, localization

我正在开发一个应用程序，我想将它与数据库中的一些自定义数据一起发送。在一些数字 id 和代码中，我还想在应用程序中附带字符串。但是，将字符串存储在数据库中似乎不是一个好主意，因为我想将应用程序本地化为其他语言，因此我应该将所有字符串存储在 strings.xml 文件中以进行本地化。然而，这些字符串与数据库中的 id 和代码密切相关，所以我需要它们之间的某种类型的关系。

是否可以在数据库中存储对字符串资源的引用？或者将所有翻译的字符串存储在数据库中并添加一个语言代码列，其中代码可以存储在 strings.xml 文件中并且每种语言都不同，这是一个更好的主意吗？

语言列方法当然会起作用，但本地化会分散在应用程序的不同部分，我不确定这是否是好的设计。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T19:37:56.763

您应该能够只在数据库中指定字符串的 name 属性，然后，当从数据库加载时，您可以使用：

```
getResources().getString(getResources().getIdentifier("string_name", "string", "com.package.myapp")); 
```

这应该检索一个本地化的字符串。

# css - CSS下拉可见性问题

> ID：11959394
> 
> 赞同：0
> 
> 时间：2012-08-14T19:27:04.753
> 
> 标签：css, drop-down-menu, overlapping

我正在制作一个使用 JavaScript 显示和隐藏的简单下拉菜单。菜单显示，链接仍然有效，但是当我将鼠标悬停在第一个下拉链接上时，即使我为它设置了特定的高度，整个下拉菜单也会消失。我还有一个单独的 div，其下方有内容，并且该 div 中的文本被推开，尽管我认为 z-index 会解决这个问题。

```
function showDrop() {
  document.getElementById("dropdown").style.visibility = "visible";
}

function hideDrop() {
  document.getElementById("dropdown").style.visibility = "hidden";
}
```

```
#nav {
  /* margin-left: 550px;
  padding-top: 110px; */
  font-family: 'Averia Serif Libre', cursive;
  font-size: 24px;
  position: relative;
}

#nav ul li {
  display: block;
  float: left;
  margin-right: 10px;
}

#nav ul li a:link,
#nav ul li a:visited {
  text-decoration: none;
  float: left;
}

#nav ul li a:hover,
#nav ul li a:active {
  color: #00B2EE;
}

#nav ul li ul {
  visibility: hidden;
  top: 0;
  left: 0;
  display: block;
  width: 100px;
  height: 100px;
  clear: both;
  z-index: 2;
  padding-top: 2px;
}

#nav ul li ul li {
  width: 100px;
  z-index: inherit;
  background-color: #AAA;
  font-size: 16px;
  line-height: 22px;
}
```

```
<div id="nav">
  <ul>
    <li><a href="#" id="nAbout">About</a></li>
    <li><a href="#" id="nPortfolio" onMouseOver="showDrop();">Portfolio</a>
      <ul id="dropdown" onMouseOut="hideDrop();">
        <li><a href="#">Print Design</a></li>
        <li><a href="#">Web Design</a></li>
        <li><a href="#">Illustration</a></li>
      </ul>
    </li>
    <li><a href="#" id="nContact">Contact</a></li>
    <li><a href="#" id="nBlog">Blog</a></li>
  </ul>
</div>
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:41:22.353

请改用该`onmouseleave`事件，因为`onmouseout`即使您悬停在元素的子元素上，鼠标也会“退出”。示例代码：

```
$("#dropdown").mouseleave(function() { //jQuery required; onmouseleave is IE-specific
    hideDrop();
}); 
```

希望有帮助。

# c# - 向 C# 公开 C++ COM 数据结构

> ID：11959396
> 
> 赞同：0
> 
> 时间：2012-08-14T19:27:13.473
> 
> 标签：c#, visual-c++, com

**背景**

这可能非常基本，也可能完全不可能。作为 COM 新手，我不知道，鉴于我有限的 COM 词汇量，Google 让我失望了。

我有一个内部定义了许多数据结构的 ATL/MFC C++ COM 对象。我还有一个引用此 COM 对象的 C# 项目。在 C# 中，我可以调用通过 C++ 端 .IDL 文件公开的方法并获得有效结果（*终于！*）。

**问题**

我想使用 .IDL 文件以某种方式将 100 个左右的 C++ 数据结构暴露给 C#（最好不要单独包装每个数据结构）。然后在 C# 中，我将简单地填充适当的结构并调用 COM 方法将数据结构传递到 C++。

基本上，我想重用 C# 中已经定义的 C++ 结构。这可能吗？如果是这样，怎么做？

如果重要的话，我正在使用 Visual Studio 2010 和 .NET 4 Framework。

谢谢一堆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T12:10:50.877

所以事实证明我试图将结构放在 IDL 文件中的错误位置。我试图将它添加到`library`定义中，但无论出于何种原因，它都不起作用。

将它放在接口定义中最终效果很好：

```
...
interface Icontrol : IDispatch{
[ 
uuid(...), 
version(1.0) ] 
typedef struct fake
{ 
    int x;
    int y;
    int z;
} fake; 
[id(1)] HRESULT open_connection([out,retval] VARIANT_BOOL* result);
... 
```

这并不能回答如果您的类型没有将 1:1 映射到 C# 类型该怎么办的问题，但至少我可以在 C# 中使用 C++ 定义的结构。

# sql-server-2008 - TSQL 查询优化

> ID：11959397
> 
> 赞同：1
> 
> 时间：2012-08-14T19:27:17.507
> 
> 标签：sql-server-2008, tsql

我有一个查询，谓词是在运行时确定的。根据我当前的设计，查询的返回时间不是最佳的。查询并不复杂，我已经验证了所需的索引（使用 Tuning Adviser）已经到位。我已经向自己证明，如果谓词是硬编码的，查询会更快。

以下是我遇到问题的查询。

以下查询需要几分钟才能完成

```
declare
   @matchFN                   bit         = 1     -- match on first name
  ,@matchLN                   bit         = 1     -- match on last name

;with cteContact1 as (
  select distinct
     c.ContactID 
    ,ltrim(rtrim(FirstName)) FN
    ,ltrim(rtrim(LastName)) LN
  from 
    dbo.contact c 
  left outer join
    dbo.ContactCertification cc on c.ContactID = cc.ContactID   
)
,cteContact2 as (
  select 
     c.ContactID 
    ,ltrim(rtrim(FirstName)) FN
    ,ltrim(rtrim(LastName)) LN
  from 
    dbo.contact c  
  left outer join
    dbo.ContactCertification cc on c.ContactID = cc.ContactID   
)
select distinct
   *
from
  cteContact1 c1
join
  cteContact2 c2 on 
    c1.FN = case when @matchFN = 1 then c2.FN else c1.FN end
    and
    c1.LN = case when @matchLN = 1 then c2.LN else c1.LN end 
```

但是，如果我将最终查询更改为以下查询，则查询将在 5 秒内完成。

```
select distinct
   *
from
  cteContact1 c1
join      
  cteContact2 c2 on c1.FN = c2.FN  and c1.LN = c2.LN 
```

最终，这两个查询都应该归结为同一件事，那么为什么性能会有如此大的差异呢？

# python - 当 QThread 有一个事件队列时，使用 exit() 终止线程是否安全？

> ID：11959401
> 
> 赞同：2
> 
> 时间：2012-08-14T19:27:43.800
> 
> 标签：python, multithreading, qt, pyside

我正在使用 QThread 做一些周期性的后台工作，源代码看起来像这样

```
class Worker(QObject):
    """ Separate QObject that does the work with affinity of 
        'DoStuffOnceASecond'"""
    def __init__(self):
        super(QWorker, self).__init__()

    def doWork(self):
        #... do work, post signal to consumer

class DoStuffOnceASecond(QThread):
    def __init__(self):
        super(DoStuffOnceASecond, self).__init__()   

    def run(self):
        """ Setup "pullFiles" to be called once a second"""
        self.timer= QTimer()
        self.worker = Worker()
        self.timer.setSingleShot(False)
        self.timer.timeout.connect(self.worker.doWork)
        self.timer.start(1000)
        self.exec_() 
```

我正在寻找终止此类线程的最佳方法。一种选择是将信号从主线程发布到该线程，在该线程中创建一个插槽。由于这些插槽作为事件循环的一部分执行，因此它们会被安全地拾取。但后来我会自我终止......而且我不确定这是否会很好地工作。

或者我想知道，因为线程应该意识到它正在运行一个事件循环，如果只是调用`exit()`这个线程是安全的？该[文档](http://qt-project.org/doc/qt-5.0/qthread.html#exit) *似乎*表明这是可以的：

> 调用此函数后，线程离开事件循环并从对 QEventLoop::exec() 的调用返回。QEventLoop::exec() 函数返回returnCode。

我*认为*“离开事件循环”意味着它将允许当前事件完成处理。还是 QThread 会立即终止？

这里的代码是 python（pyside 1.10，python 2.7），但这可以很容易地应用于任何使用 QThread 的 QT 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T21:03:20.627

如果您不介意返回码为 0，则无需声明任何额外的插槽。然后您可以使用[已定义](http://doc.qt.io/qt-5/qthread.html#quit) `quit()`的插槽，它只调用`exit(0)`您的线程。关于你对“自我终止”的恐惧——你并没有终止线程，只是退出了它的事件循环。您可以随时通过再次调用 exec() 来启动它。你对你的线程仍然很好，所以一切都应该“工作得很好”。[QThread::terminate](http://doc.qt.io/qt-5/qthread.html#terminate)可以立即终止，但是当上述方法失败时，它意味着最后一个绝望的手段来杀死线程。

# javascript - Javascript 行为不端的 SharePoint 2010 拍卖页面

> ID：11959405
> 
> 赞同：0
> 
> 时间：2012-08-14T19:28:12.127
> 
> 标签：javascript, jquery, sharepoint, web-parts

我需要在工作中在 SharePoint 2010 上构建一个拍卖网站。我们的团队偶然发现了这个网页，关于将这个 javascript 发布到 Web 部件中：

[http://weblogs.asp.net/bsimser/archive/2009/10/09/calculated-time-left-columns-in-sharepoint-with-jquery.aspx](http://weblogs.asp.net/bsimser/archive/2009/10/09/calculated-time-left-columns-in-sharepoint-with-jquery.aspx)

它正是我们所需要的，但 javascript 仅适用于 SharePoint 2007。脚本需要字段 Title 来保存项目，End Date 只是为了有 Time Left 字段的引用，并且 Time Left 字段应该倒计时从当前时间到拍卖的结束日期。

导致javascript无法正常工作的两个版本之间有什么区别，我该如何修改它以适合我们？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:47:35.030

定义 var dArray 时最有可能出现该错误。jQuery 代码正在寻找非常具体的列，并且 2007 和 2010 构建它们的表略有不同。它还取决于您查看列出的列。如果您使用 Firebug，您应该能够深入到具有您的结束日期的正确列，以便其余代码可以工作。

# asp.net - 验证何时为自定义控件设置属性

> ID：11959406
> 
> 赞同：1
> 
> 时间：2012-08-14T19:28:14.033
> 
> 标签：asp.net, page-lifecycle

我希望有一种模式可以验证何时为 asp.net 中的自定义控件设置了属性。

考虑到存在页面生命周期，我们不断遇到控件可能进入无效状态的问题。我们能做的最好的事情是引发异常，并提供一条说明性消息，例如在添加数据之前设置选择的值。

请注意，理想情况下，组件不会依赖于设置属性时的排序等内容。不幸的是，我只能一步一步地推动公司采取更好的做法。有太多的组件要从头开始重写，这是一个不切实际的期望。

也就是说，这里有一个例子。

我们有两个属性。SelectedValues 将设置与逗号分隔列表匹配的值，而 InsertAll 将在列表顶部插入“All”。

潜在问题：开发人员在 Page 的 PreInit 事件中设置 SelectedValues，但 InsertAll 属性如果为 true，将添加“All”值并在控件的 Init 事件期间选择它。诀窍是，SelectedValues 将在设置时直接设置值，而不是在生命周期的后期。这意味着，当他们看到页面时，他们认为组件中存在错误，因为他们没有将 All 设置为选中，但确实如此。

页：

```
protected override void OnPreInit(EventArgs e)
{
    base.OnPreInit(e);
    listBoxSelection.SelectedValues = "value1,value2";
    listBoxSelection.InsertAll = true;
} 
```

控制：

```
 protected override void OnInit(EventArgs e)
    {
        base.OnInit(e);

        if (this.InsertAll)
        {
            ListBoxItem allItem = new ListBoxItem()
                                  {
                                      Text = "All",
                                      Value = "0"
                                      Selected = true
                                  };

            this.Items.Insert(0, allItem);
        }
    } 
```

我如何确保开发人员知道他们在使用此控件时犯了错误？这是一个简单的例子，但我经常以多种形式看到它。

# c# - 如何从 Form1 访问位于 Form2 中的类值？C＃

> ID：11959409
> 
> 赞同：-1
> 
> 时间：2012-08-14T19:28:19.147
> 
> 标签：c#, forms, class

我有一个快速的问题。我在 Form2 中创建了一个名为“MyObject”的类，其中包含两个变量。按下一个按钮，Form2 中的变量就会改变。现在我的问题是如何在 Form1 中检索 MyObject？这是我的示例代码：

表格1

```
 public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Form2 f = new Form2(this);

        f.ShowDialog();
        ??????? (how can I retrieve Myobject here?????) 
    } 
```

表格2

```
public class MyObject
    {
        public int Value1 { get; set; }
        public int Value2 { get; set; }

    }
    public Form2(Form1 frm1)
    {
        InitializeComponent();

    }
    private void button1_Click(object sender, EventArgs e)
    {
        MyObject obj = new MyObject();
        obj.Value1 = 102;
        obj.Value2 = 50;
    } 
```

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:32:52.097

做这个

表格1

```
 public Form1()
 {
    InitializeComponent();
 }

 private void button1_Click(object sender, EventArgs e)
 {
    Form2 f = new Form2(this);

    f.ShowDialog();
    MyObject mo = f.GetMyObject;
 } 
```

表格2

```
public Form2(Form1 frm1)
{
    InitializeComponent();
}

public MyObject GetMyObject 
{ 
    get
    {
        return obj;
    } 
}

MyObject obj;

private void button1_Click(object sender, EventArgs e)
{
    obj = new MyObject();
    obj.Value1 = 102;
    obj.Value2 = 50;
} 
```

我的对象

```
public class MyObject
{
    public int Value1 { get; set; }
    public int Value2 { get; set; }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:33:20.163

您不应该`MyObject`在内部定义`Form2`. 你应该把它放在它自己的文件中。您几乎总是希望每个类都有自己的文件。

你也应该给`MyObject`一个更好的名字；更能描述它实际做/持有的东西。

最后，要真正传递数据，一种简单有效的方法是在 上创建一个属性`Form2`：

```
public MyObject PropertyName {get; private set;} 
```

（不要忘记将属性重命名为更好的名称。）

然后你可以`Form2`通过说从内部设置它`ProperyName = new MyObject();`

`Form1`然后，您可以使用（在您调用 之后`ShowDialog`）访问该属性`f.PropertyName`。

# c# - 我刚刚从一个网站下载了一些内容并得到了奇怪的符号而不是文本，这可能是什么？

> ID：11959410
> 
> 赞同：0
> 
> 时间：2012-08-14T19:28:19.700
> 
> 标签：c#

```
private string downloadContent()
        {
            try
            {
                WebRequest request = WebRequest.Create(url);
                request.Method = "GET";
                response = request.GetResponse();
                Stream stream = response.GetResponseStream();
                reader = new StreamReader(stream);
                string content = reader.ReadToEnd();
                return content;
            }
            catch
            {
                return error;
            }

        } 
```

结果是：

```
14/08/2012 22:22:11===> ��'���� ����  ���� ������ ���� ������ ������
14/08/2012 22:22:11===> ������ ������ 14/08/2012
14/08/2012 22:22:11===> ������� ���� �������� ����� ��� ������ ���� �� 2 ������
14/08/2012 22:22:11===> ��'��� ��'��� ��� ������ �''�
14/08/2012 22:22:11===> ''�� ������ ����� �� ��� ������� �����''
14/08/2012 22:22:11===> ��� ������ ������: ������ �� ����� ��� ��� �� ��������
14/08/2012 22:22:11===> ���: ����� ��� ��� ���� �� ����-����� ���� ����� �� ����
14/08/2012 22:22:11===> ��''�: ��'���� ������ ����� ����� ����� ������� ������� ��-������
14/08/2012 22:22:11===> ����� ���� ��� ����� �� ���� ���� ���� ���� ������
14/08/2012 22:22:11===> ����� ���� ������ �������: ''����� ������ �� ���� 2013''
14/08/2012 22:22:11===> ���� ������ �����: ���� ���� ������� ������
14/08/2012 22:22:11===> ��� ���: ���� ������ ����� �� ������ ���������� ���� ����� ������- ������ ����.. 
```

虽然网站页面的来源是这样的：

```
<TD ALIGN="RIGHT" VALIGN="TOP">&nbsp;<font size=-1 color=#ff9933><b>3077</b></font>&nbsp;</TD></TR><TR BGCOLOR="#FDFDFD">
<TD ALIGN="RIGHT" VALIGN="TOP">
<body onmousemove="overhere()">
<a  onmouseover="EnterContent('ToolTip','פיקוד העורף יערוך ביומיים הקרובים 5 תרגילים בצפון','<u><span style=color:#000099;>כתב: Bloops   בתאריך: 14.08.12  שעה: 21:39</span></u><br>פיקוד העורף יקיים מחר (רביעי) ומחרתיים מספר תרגילים באזור טבריה, עפולה, מגדל העמק ונצרת. מחר בבוקר יתקיים תרגיל המדמה נפילת טילים באזור כלא גלבוע במוע...'); Activate();" onmouseout="deActivate()" href="javascript:void(0)"> 
<img src="http://rotter.net/forum/Images/new_icon_general.gif" border="0"></a></TD><TD ALIGN="right" VALIGN="TOP" WIDTH="55%">
<FONT CLASS='text15bn'><FONT FACE="Arial">
<a href="http://rotter.net/cgi-bin/forum/dcboard.cgi?az=read_count&om=18520&forum=scoops1"><b>פיקוד העורף יערוך ביומיים הקרובים 5 תרגילים בצפון</b>   
</a></font></TD>
      <TD ALIGN="CENTER" VALIGN="TOP">
      <FONT SIZE="2" COLOR="#000099" 
      FACE="Arial"><font size=1 color=000099>14.08.12&nbsp;&nbsp;<font size=1 color=red>21:39</font><br>
       <a href="http://rotter.net/cgi-bin/forum/dcboard.cgi?az=user_profiles&user=Bloops"><font CLASS='text13'><b>Bloops</b></font></a></FONT></TD>      
      <TD ALIGN="CENTER" VALIGN="TOP"><FONT SIZE="1" 
      COLOR="#000099" FACE="Arial">14.08.12<font color="#FDFDFD" size="1">&nbsp;&nbsp;</font><font color=red>21:39</font> <br>מאת Bloops</FONT></TD>
      <TD ALIGN="CENTER" VALIGN="TOP"><FONT 
      SIZE="2" COLOR="#000099" FACE="Arial"><b>0
</b></FONT></TD>

         <TD ALIGN="RIGHT" VALIGN="TOP">&nbsp;<font size=-1 color=#ff9933><b>בעדכון</b></font>&nbsp;</TD></TR><TR BGCOLOR="#eeeeee">
<TD ALIGN="RIGHT" VALIGN="TOP">
<body onmousemove="overhere()">
<a  onmouseover="EnterContent('ToolTip','תשואה&rsquo;&rsquo; מדהימה למדינה: כל מצלמת מהירות עולה 180 א&rsquo; ש&rsquo;ח','<u><span style=color:#000099;>כתב: elbaz   בתאריך: 14.08.12  שעה: 19:35</span></u><br>עמוד &quot;דחליל&quot; עולה 140 א&rsquo; ש&rsquo; ותפעול - 22 מיליון שקל; הרווח מהדוחות? מאות מיליונים בשנה<br>עמוד ריק עולה כמו ניידת משטרה חדשה &#96...'); Activate();" onmouseout="deActivate()" href="javascript:void(0)"> 
<img src="http://rotter.net/forum/Images/new_icon_general.gif" border="0"></a></TD><TD ALIGN="right" VALIGN="TOP" WIDTH="55%">
<FONT CLASS='text15bn'><FONT FACE="Arial">
<a href="http://rotter.net/cgi-bin/forum/dcboard.cgi?az=read_count&om=18489&forum=scoops1"><b>תשואה'' מדהימה למדינה: כל מצלמת מהירות עולה 180 א' ש'ח</b>      
</a></font></TD>
      <TD ALIGN="CENTER" VALIGN="TOP">
      <FONT SIZE="2" COLOR="#000099" 
      FACE="Arial"><font size=1 color=000099>14.08.12&nbsp;&nbsp;<font size=1 color=red>19:35</font><br>
       <a href="http://rotter.net/cgi-bin/forum/dcboard.cgi?az=user_profiles&user=elbaz"><font CLASS='text13'><b>elbaz</b></font></a></FONT></TD>      
      <TD ALIGN="CENTER" VALIGN="TOP"><FONT SIZE="1" 
      COLOR="#000099" FACE="Arial">14.08.12<font color="#eeeeee" size="1">&nbsp;&nbsp;</font><font color=red>21:38</font> <br>מאת גדליה הפיל</FONT></TD>
      <TD ALIGN="CENTER" VALIGN="TOP"><FONT 
      SIZE="2" COLOR="#000099" FACE="Arial"><b>4
</b></FONT></TD> 
```

我正在下载标签之间的文本：

```
private void GetText(string text)
        {
            names = new List<string>();
            string startTag = "forum=scoops1\"><b>";
            string endTag = "</b>";
            int startTagWidth = startTag.Length;
            int endTagWidth = endTag.Length;
            index = 0;
            while (true)
            {
                index = text.IndexOf(startTag, index);
                if (index == -1)
                {
                    break;
                }
                // else more to do - index now is positioned at first character of startTag 
                int start = index + startTagWidth;
                index = text.IndexOf(endTag, start + 1);
                if (index == -1)
                {
                    break;
                }
                // found the endTag 
                profileName = text.Substring(start, index - start);
                names.Add(profileName);
            }
        } 
```

而文本是网站页面的内容来源。

问题是为什么我得到这个符号而不是文本，如果有修复它？

我在另一个没有这个问题的网站上使用相同的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:35:57.993

您需要使用正确的[编码](http://msdn.microsoft.com/en-us/library/system.text.encoding.aspx)才能读取返回的流值。

确保您使用与页面相同的编码（将在 HTTP 标头中或`meta`页面上的元素中 -`content-type`页面的）。

使用该编码来获得正确的字节字符串表示。

# visual-studio-2010 - wcf 服务 - 使用 url 进行测试以调用方法不起作用且远程

> ID：11959411
> 
> 赞同：1
> 
> 时间：2012-08-14T19:28:21.103
> 
> 标签：visual-studio-2010, wcf, wcf-client

我创建了一个返回一行文本的 WCF 服务，并使用客户端应用程序对其进行了测试，并且能够检索该行文本。我认为如果我将整个 url 放在包含返回文本行的方法的浏览器中，它会起作用，但我得到一个 400 not found 错误。例如主网址是：

```
http://localhost/DataAdmin/GService.svc?wsdl 
```

因此，当我尝试在浏览器中通过以下内容时，它不起作用：

```
http://localhost/DataAdmin/GService.svc/RetrieveData?inputText=test 
```

哦，这样做的原因是我正在尝试远程测试它。我希望一个应用程序能够从另一个服务器/域调用该服务。我认为它可能与配置文件有关。这是我的服务项目的配置文件。

```
<?xml version="1.0"?>
<configuration>

<system.web>
<compilation debug="true" strict="false" explicit="true" targetFramework="4.0" />
</system.web>
<system.serviceModel>
 <behaviors>
  <serviceBehaviors>
    <behavior>
      <serviceMetadata httpGetEnabled="true"/>
      <serviceDebug includeExceptionDetailInFaults="false"/>
    </behavior>
  </serviceBehaviors>
</behaviors>
<serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
</system.serviceModel>
<system.webServer>
<modules runAllManagedModulesForAllRequests="true"/>
</system.webServer>

</configuration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:38:27.787

它不是那么简单。WCF 与 SOAP 协议一起使用，您不能“仅”在 Url 中传递方法名称和值。

你可以使用 Restfull-API，我指的是这篇很棒的[文章](https://stackoverflow.com/questions/186631/rest-soap-endpoints-for-a-wcf-service)，它以简单明了的方式讲述了它的所有内容。

# ruby - 无法在 Windows 7 中安装 Ruby Gems

> ID：11959414
> 
> 赞同：0
> 
> 时间：2012-08-14T19:28:23.287
> 
> 标签：ruby, gem, sass, compass-sass

我已经在我的 Mac 上成功安装了 Ruby Gems 很多次。我需要使用 Compass、Sass 和 Suzy 配置 Windows 7 Enterprise 虚拟机。

我使用安装程序 1.9.3 在 Windows 机器上下载了已安装的 Ruby。我跑了`gem update --system`将 Rubygems 更新到 1.8.4。

我能够通过运行安装 Sass 3.2`gem install sass`

但是，如果我运行`gem install compass`或`gem install susy`出现错误：

```
Error while excecuting gem .. (ArgumentError) marshall data too short 
```

有任何想法吗？此时，我无法安装这些 gem。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T12:11:57.770

替代解决方案..：从[此处](http://rubygems.org/)**下载 gem compass**到您的 ruby​​ 根文件夹。然后再试一次 它应该安装这次..祝你好运`gem install compass`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-14T17:09:04.703

有同样的问题，更新rubygems系统解决了。只需使用以下命令

```
gem update --system 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T15:02:05.307

对于那些发现这个问题的人，这里有很多很棒的提示。使用它们，我发现这个解决方案有效：

在“使用 ruby​​ 环境启动命令行”中的 N: 提示符处，我使用了`rmdir /S .gem`删除所有 gem 的命令。`gem install`然后我按照各自主机网页上的指示再次安装它们。希望这可以帮助某人。

# vb.net - Visual Basic 服务器

> ID：11959415
> 
> 赞同：0
> 
> 时间：2012-08-14T19:28:23.287
> 
> 标签：vb.net

我想在 VB 中创建一个控制台应用程序，它向局域网上的所有 IP 广播他自己的 IP。

所以一个每秒广播服务器IP的定时器。每个连接的客户端都会收到服务器的 IP。

然后，客户端登录到应用程序并向服务器 IP 发送 2 个字符串：

*   用户名
*   密码

服务器检查 2 个字符串的有效性，并允许或限制对服务器的访问。

我应该如何进行？

*我找到了 TcpClient 和 TcpListener，但是我无法将 IP 广播到 255.255.255.255...*

**主要是，我想要实现的是广播（255.255.255.255）我的本地IP（192.168.1.1），所以我会广播字符串“192.168.1.1”**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:35:00.340

您应该查看 UDP 类而不是 TCP 类。UDP 将允许您在 LAN 上广播小消息。一收到IP地址，就可以使用TCP连接到服务器了。

# php - 如何在 PHP 中通过 http 使用 GET 上传视频？

> ID：11959422
> 
> 赞同：-1
> 
> 时间：2012-08-14T19:29:08.900
> 
> 标签：php

您好，我想知道将视频上传到网站的最佳方式是什么？我应该通过带有 GET 的页面来完成吗？如果可以，如何通过 http 上传文件？我对这将如何工作感到有些困惑？我正在尝试从 iphone 和 android 设备上传文件，所以我不能使用表单来执行此操作，至少我不认为有办法通过 http 上传我的文件吗？或者最方便的方法是什么？谢谢你

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T19:31:29.727

GET 不允许为视频提供足够的带宽。请改用 POST 或 PUT。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T06:19:01.480

这里最紧迫的问题是 HTTP 规范要求`GET`请求是**安全**的和**幂等**的。上传视频可能都不是这些。

[RFC 2616 中的第*9.1.1 节安全方法*](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.1)：

> 特别是，已经建立了约定，即 GET 和 HEAD 方法不应该具有采取除检索之外的操作的意义。这些方法应该被认为是“安全的”。这允许用户代理以特殊的方式表示其他方法，例如 POST、PUT 和 DELETE，以便用户意识到正在请求可能不安全的操作。

所以不，带宽与它无关。HTTP 本身说您不应该通过该`GET`方法上传任何类型的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T06:33:35.147

[官方标准](https://www.rfc-editor.org/rfc/rfc2616#section-9.3)(RFC 2616) 规定

> GET 方法意味着检索由 Request-URI 标识的任何信息（以实体的形式）。

因此，上传视频不属于“检索信息”。

`POST`应该使用，像这样：

```
<form action="process.php" method="post"> 
```

# jquery - ASP.Net MVC 与 HTML + KnockoutJS + WebAPI

> ID：11959423
> 
> 赞同：14
> 
> 时间：2012-08-14T19:29:17.380
> 
> 标签：jquery, architecture, knockout.js, asp.net-mvc-4

我想知道为什么不只是在使用 jQuery+jQuery 模板+KnockoutJS 组合的 ASP.Net MVC 4 Web 项目中使用基于 REST 的静态 HTML 文件（托管在 Azure 上并使用 ACS 保护的 ASP.Net MVC 4 WEB API）。Web API 可以使用实体框架并返回可以使用 $.ajax() 检索并使用 KnockoutJS 绑定的 JSON 序列化对象。

ASP.Net MVC（用于 Web 页面）提供了什么来为这种架构增加价值？
在我的头上，我能想到：

1.  多设备支持（设备检测和模板替换）
2.  提交数据的服务器端验证（不确定我是否也可以将验证放在 WEB API 上？）
3.  即使我使用的是静态 html 文件，我仍然可以重写我的 URL（因为无论如何我都在使用 ASP.Net MVC）。

有人可以帮助我更好地理解这一点吗？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T23:11:09.670

好问题。我当然发现随着我的 Knockout 项目的进展，我的 MVC / Razor 代码变得越来越少，但我认为我将始终拥有我想要在服务器端确定的视图的某些方面。

基本的上下文内容，例如是否在布局页面中呈现登录/注销面板，与角色相关的决定应该访问什么等。我想如果您对安全性足够小心并在服务器上实施足够的保护代码有人实际上尝试做某事，然后您可以在 Knockout 中实现大部分内容，但您最终可能会出现大量臃肿，以适应视图的每一个可能部分。

这可能取决于您的应用程序，但我认为对于大多数 Web 应用程序而言，在服务器渲染时应确定的内容与应在客户端完成的内容之间存在相当普遍的区别。

如果不出意外，您可能希望您的视图中的链接等被搜索引擎索引。例如，如果您以 JSON 格式传递您的“最新 10 种产品”，并在 Knockout 模板中使用超链接呈现它们，那么您将失去这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T02:44:06.883

这确实是一个使用正确工具来完成工作的问题。

从我在使用淘汰赛进行开发后可以看出，它的真正力量来自可观察对象和实时 DOM 更新。这使得客户端应用程序中的丰富界面可以更快地创建，并且更易于管理。但是，与直接使用 Razor 页面相比，它仍然更耗时且难以实现。因此，Knockout JS 对于某些应用程序来说是一个优势，在这些应用程序中，大量数据驱动的 UI 更新需要“ajaxically”发生，但对于其他应用程序来说就太过分了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T19:40:11.540

如果客户在这种情况下没有启用 Javascript，您的网站将毫无用处，您将无法为他们提供合适的替代方案。

使用 MVC 框架和 Razor 语法，您仍然可以构建动态生成的、数据驱动的内容，而无需使用 jQuery 或 AJAX。无论您是否启用了 Javascript，MVC 都会为您提供模型和视图之间的关注点的清晰分离。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T20:00:03.760

安全性可能是我看到的第一大优势。您仍然拥有其背后的结构 ASP.NET。是的，确实如此，在您的视图中，您当然可以使用 razor 语法并使用 Knockout 呈现您的视图模型，而 JSON.NET 使数据绑定比以往任何时候都更容易。最终在未来，也许 MVC 不会成为未来等式的一部分？（也可以查看 Meteor js，它非常酷，而且除了 javascript atm 之外*，*这种类型的动态模型绑定是不可能的。）

另外，如果您想看到它的实际效果，我发现了一个带有 MVC 和淘汰赛的优秀 Codeproject。[http://www.codeproject.com/Articles/424642/Customer-KnockoutJS-and-MVC-demo-using-JSON](http://www.codeproject.com/Articles/424642/Customer-KnockoutJS-and-MVC-demo-using-JSON)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-15T13:09:48.607

在这里，[阅读这个](http://blog.stevensanderson.com/2012/08/01/rich-javascript-applications-the-seven-frameworks-throne-of-js-2012)。引用它：

> 围绕整个页面加载构建 Web 应用程序然后“逐步增强”它们以使其行为更加动态已经不够好。构建快速、响应迅速和现代的应用程序需要您完全重新考虑您的方法。

至于您的问题，MVC 提供了什么可以为 MVVM 架构增加价值？为不同的设备提供自定义内容可能是一个优势，但您也可以通过 CSS 媒体查询在一定程度上做到这一点。决定取决于您希望从服务器发送多少字节到设备。

您也可以在不使用 MVC 或 WebAPI 的情况下进行服务器端验证，并且不需要使用 ModelBinder 或 ModelState.IsValid 来执行此操作。研究一下 FluentValidation.NET 之类的东西，它允许您在服务器上进行高度复杂的输入验证，甚至是 Web/HTTP 层的下一层。当然，您还想使用 jQuery validate 之类的东西来验证客户端。

我同意这里的其他答案，即在服务器（控制器操作或剃刀）级别做一些安全级别的事情会更容易一些，而且更“值得信赖”。但是这里没有其他人提到 MVVM 的可测试性。围绕控制器操作或其他服务器端代码编写单元测试非常容易。这并不是说你不能单元/集成/UAT 测试 MVVM 应用程序，只是它需要更多的努力 IMO。

# c# - 为许多方法编写进度条的最佳方法

> ID：11959426
> 
> 赞同：1
> 
> 时间：2012-08-14T19:29:32.903
> 
> 标签：c#, progress-bar

假设我有一个按钮：btnExecute

此按钮执行所有这些方法：

```
doAction1();
doAction2();
doAction3();
doAction4(); 
```

这些操作中的每一个都需要几秒钟。

在运行这些方法中的每一个时，我将如何更新进度条？

我知道我可以进入它们中的每一个并添加 pbExecuteProgress.value = 10 例如，但我觉得必须有更好的方法来做到这一点。

我也不想做这样的事情：

```
doAction1();
pbExecuteProgress.value = 30
doAction2();
pbExecuteProgress.value = 60
doAction3();
pbExecuteProgress.value = 80
doAction4();
pbExecuteProgress.value = 100 
```

有什么方法可以创建一个价值高达 100 的进度条并且 = 方法的进度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:38:45.777

当您“嵌套”进度时，外部方法必须估计每个子例程执行所需的时间，并将其 100% 分配给子例程。

您可以任意执行此操作，即方法一为 40%，方法二为 25%，依此类推，或者您可以进行“试运行”来决定每种方法的工作量。例如，如果每个方法处理多个文件，试运行将计算文件而不实际处理它们，然后您可以使用每个方法的文件计数来分配适用于每个方法的进度条范围。

空运行方法给出了更准确的结果，但所需的预处理可能需要相当长的时间，从而使整个任务变慢。

一旦你有了每个子程序的范围，你就可以传递它们的开始和结束百分比，它们可以适当地推进进度。

处理此问题的一种巧妙方法是创建一个处理所有子任务缩放的进度管理器类，这使得嵌套调用的整个子树很容易，并且只在它们周围传递一个对象来处理进度显示。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T19:51:33.133

```
var actions = new List<Action> {doAction1, doAction2, doAction3, doAction4};

foreach(var action in actions)
{
   action();
   progressBar.Value += (progressBar.Maximum - progressBar.Minimum) / actions.Count;
} 
```

如果您想自定义进度值：

```
var actions = new Dictionary<Action, int> 
{
     {doAction1, 30}, 
     {doAction2, 30}, 
     {doAction3, 20}, 
     {doAction4, 20},
};

progressBar.Minimum = 0;
progressBar.Maximum = actions.Select(kvp=>kvp.Value).Sum();
progressBar.Value = 0;
foreach(var action in actions)
{
   action.Key();
   progressBar.Value += action.Value;
} 
```

动作集合的声明和创建不必在循环之前发生。事实上，这种模式（策略模式的一种形式）的优势在于新的动作可以来自任何地方，包括当前类的内部和外部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T19:39:59.723

如果您真的想自己做，我建议对每个方法以及整个方法中的每个语句进行计时，将所有时间放入数组中，将它们转换为百分比，然后将 em 写入文本文件什么的。冲洗并重复，平均它们，然后你必须添加一堆`pbExecuteProgress.value = X`语句。我知道你说过你不想那样做，但至少这样可以非常准确地反映进展情况。

只是一个想法。

另外，我相当肯定有第三方工具可以为你做这种事情。但是，它们本质上不可能像上述方法一样准确。

# c# - 在gridview Asp.Net 中使用下拉列表？

> ID：11959430
> 
> 赞同：1
> 
> 时间：2012-08-14T19:29:45.440
> 
> 标签：c#, asp.net, gridview, html-select

我想在 gridview 上使用下拉列表...我有来自 asp.net 的以下代码

```
<asp:GridView ID="grdvEventosVendedor" runat="server" AllowPaging="True" 
                AutoGenerateColumns="False" CellPadding="4" DatakeyNames="idCita"
                EmptyDataText="No Hay Eventos Para Este Vendedor" ForeColor="#333333" 
                GridLines="None" AllowSorting="True"
                onpageindexchanging="grdvEventosVendedor_PageIndexChanging" 
                onrowcommand="grdvEventosVendedor_RowCommand" 
                onsorting="grdvEventosVendedor_Sorting" CellSpacing="1" HorizontalAlign="Center">
                <AlternatingRowStyle BackColor="White" ForeColor="#284775"/>

                <Columns>
                    <asp:TemplateField HeaderText="" ItemStyle-Width="35px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnEdicEvento" runat="server" 
                                CommandArgument='<%# Eval("idCita")%>' CommandName="Edicion" 
                                Height="32px" ImageUrl="~/img/pencil_32.png" Width="32px" />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="" ItemStyle-Width="35px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnDelete" runat="server"
                                CommandName="Borrar" 
                                ImageUrl="~/img/1385_Disable_16x16_72.png" 
                                onclientclick="return confirm('¿Desea eliminar el registro?');" 
                                CommandArgument='<%# Eval("idCita")%>' />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:BoundField DataField="Cliente" HeaderText="Cliente" InsertVisible="False" ReadOnly="True" SortExpression="Cliente" ItemStyle-Width="50px" />
                    <asp:BoundField DataField="Empresa" HeaderText="Empresa" InsertVisible="False" ReadOnly="True" SortExpression="Empresa" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Telefono" HeaderText="Telefono" InsertVisible="False" ReadOnly="True" SortExpression="Telefono" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Nextel" HeaderText="Nextel" InsertVisible="False" ReadOnly="True" SortExpression="Nextel" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Tipo" HeaderText="Tipo" InsertVisible="False" ReadOnly="True" SortExpression="Tipo" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Descripcion" HeaderText="Descripcion" InsertVisible="False" ReadOnly="True" SortExpression="Descripcion" ItemStyle-Width="100px"/>

                    <asp:TemplateField HeaderText="Fecha" SortExpression="Fecha" ItemStyle-Width="50px">
                        <ItemTemplate>                                            
                            <%# DataBinder.Eval(Container.DataItem, "Fecha", "{0:dd/MM/yyyy}")%>
                        </ItemTemplate>

                        <EditItemTemplate>                                        
                            <asp:TextBox ID="tbxFecha"  runat="server" Text='<%#Bind("Fecha","{0:dd/MM/yyyy}") %>' ValidationGroup="gpEdicionAgenda">
                            </asp:TextBox>
                        </EditItemTemplate>
                    </asp:TemplateField>

                    <asp:BoundField DataField="HoraInicio" HeaderText="Hora" InsertVisible="False" ReadOnly="True" SortExpression="HoraInicio" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Lugar" HeaderText="Lugar" InsertVisible="False" ReadOnly="True" SortExpression="Lugar" ItemStyle-Width="50px"/>

                    <asp:TemplateField HeaderText="Estado" ItemStyle-Width="50px">
                        <ItemTemplate>
                            <asp:DropDownList ID="dpdListEstatus" runat="server">
                                <asp:ListItem>Pendiente</asp:ListItem>
                                <asp:ListItem>Atendido</asp:ListItem>
                            </asp:DropDownList>
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="CRM" ItemStyle-Width="25px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnCRM" runat="server"
                                CommandArgument='<%# Eval("IdCliente")%>' CommandName="CRM" 
                                ImageUrl="~/img/activar.png" Width="16px" Height="16px" />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="VM" ItemStyle-Width="25px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnVerMas" runat="server"
                                CommandArgument='<%# Eval("IdCliente")%>' CommandName="VerMas" 
                                ImageUrl="~/img/search.png" Width="16px" Height="16px" />
                        </ItemTemplate>
                    </asp:TemplateField>
                </Columns>

                <EditRowStyle BackColor="#999999" Font-Size="Small" />
                <FooterStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
                <HeaderStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" Font-Size="Larger" />
                <PagerStyle BackColor="#284775" ForeColor="White" HorizontalAlign="Center" />
                <RowStyle BackColor="#F7F6F3" ForeColor="#333333" HorizontalAlign="Center" Font-Size="Small" />
                <SelectedRowStyle BackColor="#E2DED6" Font-Bold="True" ForeColor="#333333" />
                <SortedAscendingCellStyle BackColor="#E9E7E2" />
                <SortedAscendingHeaderStyle BackColor="#506C8C" />
                <SortedDescendingCellStyle BackColor="#FFFDF8" />
                <SortedDescendingHeaderStyle BackColor="#6F8DAE" />
            </asp:GridView> 
```

它所说的部分是我希望ddl成为的部分......

您可能还注意到我总共使用了 4 个按钮来进行编辑、删除等……但我想那是另一个故事了……

我希望它做几件事...首先，您会注意到我有带有 2 个值的下拉列表...这是因为我从查询中获取了一个数据源，而这些是该列的 2 个可能值可以得到...

所以＃1应该是......我怎样才能让Ddl的选定值是我从查询中得到的......

和＃2我可以手动更改ddl的值，所以我希望它进行回发并使用新值更新该特定行（我需要回发的原因是我可以触发例如ddl ONSELECTEDINDEX CHANGED和因此使用cs文件创建一个新查询，更新行，然后再次刷新gridview）

我想所有这些都可能与 rowcommand 有关，就像其他 4 个按钮的工作方式一样。

我正在使用 C#，所以如果你的方法涉及 cs 文件，如果你能帮助我使用 C#，那将会很有帮助......

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:10:18.990

您应该在 GridView 上使用 OnRowDatabound 事件。喜欢：

```
<asp:GridView ID="grdvEventosVendedor" OnRowDatabound="grdvEventosVendedor_RowDataBound">
        <asp:TemplateField HeaderText="Estado" ItemStyle-Width="50px">
            <ItemTemplate>
                <asp:DropDownList ID="dpdListEstatus" runat="server" OnSelectedIndexChanged="dpdListEstatus_SelectedIndexChanged" AutoPostBack="True">
                    <asp:ListItem>Pendiente</asp:ListItem>
                    <asp:ListItem>Atendido</asp:ListItem>
                </asp:DropDownList>
            </ItemTemplate>
        </asp:TemplateField>
</asp:GridView> 
```

然后在 .cs 后端代码中，您应该找到控件并根据数据项值设置它的选定值。

```
protected void grdvEventosVendedor_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        DropDownList dpdListEstatus = e.Row.FindControl("dpdListEstatus") as DropDownList;
        dpdListEstatus.SelectedValue = DataBinder.Eval(e.Row.DataItem, "FieldName").ToString();
    }
}

protected void dpdListEstatus_SelectedIndexChanged(object sender, EventArgs e)
{
    //your logic goes here
} 
```

您可以在 ASPX 代码的下拉列表中设置 SelectedIndexChanged，并且在该后端代码中您可以继续您的逻辑。哦，别忘了在你的下拉菜单中设置 autopostback = true 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:18:21.400

您可以使用 GridView RowDataBound 事件来访问下拉列表，同样为下拉列表设置 selectedindexchanged 事件。

请参阅下面的此链接，其中显示了您将需要的解决方案的基础知识

[http://www.codeproject.com/Articles/53559/Accessing-a-DropDownList-inside-a-GridView](http://www.codeproject.com/Articles/53559/Accessing-a-DropDownList-inside-a-GridView)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T20:16:21.477

```
This is what I did that worked for me:

**Snippet from aspx:**

  <asp:TemplateField HeaderText="RECORD_STATUS" SortExpression="RECORD_STATUS">
     <EditItemTemplate>
        <asp:DropDownList  runat="server" ID="ddlRecStatus"                                                SelectedIndex='<%# GetselectedRecStatus(Eval("RECORD_STATUS")) %>'
                                    DataSource = '<%# Recs_Status %>' />
                            </EditItemTemplate>
  </asp:TemplateField>

**Snippet from code-behind:**

 protected void grdSAEdit_RowUpdating(object sender, GridViewUpdateEventArgs e)
        {
            //Get the refernce to the list control
            DropDownList ddlRecStatus = (DropDownList)(grdSAEdit.Rows[e.RowIndex].FindControl("ddlRecStatus"));

            // Add it to the parameters
            e.NewValues.Add("RECORD_STATUS", ddlRecStatus.Text);

        }

        protected string[] Recs_Status
        {
            get { return new string[] {  "A", "E", "V", "Z" }; }
        }

        protected int GetselectedRecStatus(object status)
        {
            return Array.IndexOf(Recs_Status, status.ToString());
        } 
```

# c# - 将我的属性值与模型类中另一个属性的值进行比较的自定义验证属性

> ID：11959431
> 
> 赞同：60
> 
> 时间：2012-08-14T19:29:55.540
> 
> 标签：c#, asp.net-mvc, razor, validationattribute

我想创建一个自定义验证属性，我想在其中将我的属性值与模型类中另一个属性的值进行比较。例如，我在我的模型类中有：

```
...    
public string SourceCity { get; set; }
public string DestinationCity { get; set; } 
```

我想创建一个自定义属性来像这样使用它：

```
[Custom("SourceCity", ErrorMessage = "the source and destination should not be equal")]
public string DestinationCity { get; set; }
//this wil lcompare SourceCity with DestinationCity 
```

我如何到那里？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-08-14T20:06:28.813

以下是获取其他属性值的方法：

```
public class CustomAttribute : ValidationAttribute
{
    private readonly string _other;
    public CustomAttribute(string other)
    {
        _other = other;
    }

    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        var property = validationContext.ObjectType.GetProperty(_other);
        if (property == null)
        {
            return new ValidationResult(
                string.Format("Unknown property: {0}", _other)
            );
        }
        var otherValue = property.GetValue(validationContext.ObjectInstance, null);

        // at this stage you have "value" and "otherValue" pointing
        // to the value of the property on which this attribute
        // is applied and the value of the other property respectively
        // => you could do some checks
        if (!object.Equals(value, otherValue))
        {
            // here we are verifying whether the 2 values are equal
            // but you could do any custom validation you like
            return new ValidationResult(this.FormatErrorMessage(validationContext.DisplayName));
        }
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-14T20:17:06.473

请在下面查看我的示例：

**模型类**实现`INotifyPropertyChanged`

```
public class ModelClass : INotifyPropertyChanged
{
    private string destinationCity;

    public string SourceCity { get; set; }

    public ModelClass()
    {
        PropertyChanged += CustomAttribute.ThrowIfNotEquals;
    }

    [Custom("SourceCity", ErrorMessage = "the source and destination should not be equal")]
    public string DestinationCity
    {
        get
        {
            return this.destinationCity;
        }
        set
        {
            if (value != this.destinationCity)
            {
                this.destinationCity = value;
                NotifyPropertyChanged("DestinationCity");
            }
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void NotifyPropertyChanged(string info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }
} 
```

**属性类**还包含事件处理程序。

```
internal sealed class CustomAttribute : Attribute
{
    public CustomAttribute(string propertyName)
    {
        PropertyName = propertyName;
    }

    public string PropertyName { get; set; }

    public string ErrorMessage { get; set; }

    public static void ThrowIfNotEquals(object obj, PropertyChangedEventArgs eventArgs)
    {
        Type type = obj.GetType();

        var changedProperty = type.GetProperty(eventArgs.PropertyName);

        var attribute = (CustomAttribute)changedProperty
            .GetCustomAttributes(typeof(CustomAttribute), false)
            .FirstOrDefault();

        var valueToCompare = type.GetProperty(attribute.PropertyName).GetValue(obj, null);

        if (!valueToCompare.Equals(changedProperty.GetValue(obj, null)))
            throw new Exception("the source and destination should not be equal");
    }
} 
```

**用法**

```
 var test = new ModelClass();
    test.SourceCity = "1";
    // Everything is ok
    test.DestinationCity = "1";
    // throws exception
    test.DestinationCity ="2"; 
```

为了简化代码，我决定省略验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-09T02:45:04.907

最好的方法是通过 IValidatableObject。请参阅[http://msdn.microsoft.com/en-us/data/gg193959.aspx](http://msdn.microsoft.com/en-us/data/gg193959.aspx)

# java - 如何将请求中的特殊字符发送到 servlet

> ID：11959432
> 
> 赞同：2
> 
> 时间：2012-08-14T19:30:01.100
> 
> 标签：java, javascript, jakarta-ee, servlets, http-request-parameters

我正在使用一个 jQuery ajax 命令，它具有以下数据：

```
$.ajax({
type:"POST",
 ...
 data:"e=f_s&es="+JSON.stringify(email)+"&fr="+str
 ...
}) 
```

其中 (email) 可以包含特殊字符，例如可以是字符串：

```
!#$%'&+-/=?^`*{|}~ch!#$%'/=?*^`{|}@mail.com 
```

我允许这些字符的原因是基于以下 [问题。](https://stackoverflow.com/questions/2049502/what-characters-are-allowed-in-email-address)

问题是，在服务器（Java EE 应用程序）的某个时刻，它搞砸了。特殊字符不显示不同请求参数的边界。例如，它正在考虑：

# '/

作为参数。
我想我需要转义字符？（如果是的话如何？）

我应该怎么做才能将这样的字符串从**javascript**发送到**java**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:33:25.413

Use [`encodeURIComponent`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent):

```
encodeURIComponent("!#$%'&+-/=?^`*{|}~ch!#$%'/=?*^`{|}@mail.com") 
```

returning:

```
"!%23%24%25'%26%2B-%2F%3D%3F%5E%60*%7B%7C%7D~ch!%23%24%25'%2F%3D%3F*%5E%60%7B%7C%7D%40mail.com" 
```

# python - 如何关闭这个用于运行方法的线程？

> ID：11959434
> 
> 赞同：1
> 
> 时间：2012-08-14T19:30:03.627
> 
> 标签：python

我设置了多个需要同时运行的方法。我决定为上述方法创建单独的线程。还有一种方法是我创建的唯一目的是创建另一个线程。这是我所做的一个例子。我的问题是，我怎样才能安全地关闭这些线程？

```
from threading import Thread

....

def startOtherThread():
    Thread(target = myMethod).start()

Thread(target = anotherMethod).start()

.... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T23:15:58.300

您不关闭线程。它们将一直运行，直到您的 target= 方法完成。目前尚不清楚您为什么要尝试引入单独的方法来启动线程：`Thread(target=...).start()`看起来很简单。

当您使用线程时，您有三个基本选项：
- 在主线程中等待，直到子线程使用`join()`函数完成
- 让子线程无所事事地运行
- 在主线程结束时使用 setDeamon(True) 退出子线程线程对象。

您还需要了解 cPython 中的 GIL（全局解释器锁）

这是线程的一些基本测试代码：

```
import threading
import time
import sys

def f():
    sys.stderr.write("Enter\n")
    time.sleep(2)
    sys.stderr.write("Leave\n")

if __name__ == '__main__':
    t0 = threading.Thread(target=f)
    t1 = threading.Thread(target=f)
    t0.start()
    time.sleep(1)
    t1.setDaemon(True)
    t1.start()
    #t1.join() 
```

# javascript - 仅将 CSS 规则应用于不分配类/ID 的第一个？

> ID：11959436
> 
> 赞同：5
> 
> 时间：2012-08-14T19:30:13.073
> 
> 标签：javascript, jquery, html, css

我已经看过[了](https://stackoverflow.com/questions/613284/css-apply-style-to-first-level-of-td-only)，这不是我需要的..

我需要类似的东西

```
table.mytable tr first-td's { border: 1px solid black; } 
```

为了

```
<table class="mytable">
<tr>
<td>This has the border</td>
<td>no border</td>
<td>no border</td>
</tr>
<tr>
<td>This has the border</td>
<td>no border</td>
<td>no border</td>
</tr>
<tr>
<td>This has the border</td>
<td>no border</td>
<td>no border</td>
</tr>
</table> 
```

如果这是不可能的，请告诉我，我会很难过。

如果需要完成工作，Javascript/jQuery 是可以接受的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T19:31:50.600

```
table.mytable tr td:first-child { border: 1px solid black; } 
```

[https://developer.mozilla.org/en-US/docs/CSS/:first-child](https://developer.mozilla.org/en-US/docs/CSS/:first-child)

也适用于 jQuery ( [http://api.jquery.com/first-child-selector/](http://api.jquery.com/first-child-selector/) )：

```
$('table.mytable tr td:first-child') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T19:33:47.973

是的。这是可能的：

在你的 CSS 中使用

```
.mytable tr td:first-child  { border: 1px solid black; }​ 
```

[在这里试试](http://jsfiddle.net/Vpnka/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T19:32:02.750

不是 100% 跨浏览器，但支持就足够了。见[http://caniuse.com/#search=:first-child](http://caniuse.com/#search=:first-child)

```
table.mytable tr td:first-child 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-14T19:32:13.213

您可以使用`:first-of-type`，但在旧版浏览器上不可用：http: [//jsfiddle.net/R9qE3/](http://jsfiddle.net/R9qE3/)。

您还可以通过 jQuery 选择正确的元素（用于跨浏览器支持），但您需要在添加`td`s 或移动它们时更新状态。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-14T19:32:56.377

```
table.mytable tr:first-child {
    border: 1px solid black;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-14T19:33:34.930

你可以使用 jQuery “nth child” [http://api.jquery.com/nth-child-selector/](http://api.jquery.com/nth-child-selector/)

它会是这样的：

```
$("table.mytable tr::nth-child(1)")  //do w/e you need to do here. 
```

# java - 无法从 J2ME 执行 HTTP POST（诺基亚 S40 6thEdition）

> ID：11959440
> 
> 赞同：1
> 
> 时间：2012-08-14T19:30:30.143
> 
> 标签：java, java-me

我无法使用 J2ME 进行 HTTP POST 下面是我使用的代码，当我尝试写入 OutputStrem 时会引发异常。

在 SYSO 下面的代码中打印“here5”。请需要一些指导。基本上，我将 http 连接部分放在单独的线程运行方法中，以使其远离 UI 线程。

```
public void run(){
    HttpConnection http = null;
    OutputStream out = null;
    String msg = "lat=10&long=20&mac=923873";
    try{
    String url = "http://xxxx.php"; 
    byte[] data = null;
    InputStream istrm = null;

    http = (HttpConnection)Connector.open(url);
    }
    catch(Exception e)
    {
        System.out.println("here1");
    }
    try
    {
        http.setRequestMethod(HttpConnection.POST);
    }
    catch(Exception e)
    {
        System.out.println("here2");
    }

    try{
        http.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
        http.setRequestProperty("User-Agent", "HttpMidlet/0.2");
        http.setRequestProperty("Custom-Property", "MyCustomProperty/1.0; AnotherProperty/debug_0.1");

        http.setRequestProperty("Content-Length", ""+msg.getBytes().length);
    }
    catch(Exception e)
    {
        System.out.println("here3");
    }

    try{

        out = http.openOutputStream();
    }
    catch(Exception e)
    {
        System.out.println("here4");
    }
    try{
    out.write(msg.getBytes());
    out.flush();
    }
    catch(Exception e)
    {
        System.out.println("here5");
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:13:01.513

```
/**
     * Send the data to the URL of Server Site using the POST connection.
     * 
     * @return the response of server.
     * @throws Exception
     */
    public byte[] send() throws Exception {
        HttpConnection hc = null;
        InputStream is = null;
        ByteArrayOutputStream bos = new ByteArrayOutputStream();

        byte[] res = null;

        try {
            hc = (HttpConnection) Connector.open(url);

            hc.setRequestProperty("Content-Type",
                    "multipart/form-data; boundary=" + getBoundaryString());

            hc.setRequestMethod(HttpConnection.POST);

            OutputStream dout = hc.openOutputStream();

            dout.write(postBytes);
            if (dout!=null) {
                dout.close();
                dout = null;
            }

            int ch;
            is = hc.openInputStream();

            while ((ch = is.read()) != -1) {
                bos.write(ch);
            }
            res = bos.toByteArray();
        } catch (Exception e) {
            // if an error occurred connecting to the server.
            throw new Exception(e.getMessage());

        } finally {
            try {
                if (bos != null)
                    bos.close();

                if (is != null)
                    is.close();

                if (hc != null)
                    hc.close();
            } catch (Exception e2) {
                e2.printStackTrace();
            }
        }
        return res;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:03:34.540

根据这个[诺基亚示例](http://www.developer.nokia.com/Community/Wiki/How_to_use_Http_POST_request_in_Java_ME)，您不需要调用`setRequestProperty`方法。

另一个有趣的地方是.`Connector.open(urlstring, **Connector.READ_WRITE**)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-26T11:54:40.260

我通过重新安装模拟器解决了这个问题。

# ios - 如何对 Core Data 迁移进行单元测试？

> ID：11959447
> 
> 赞同：18
> 
> 时间：2012-08-14T19:30:53.533
> 
> 标签：ios, unit-testing, core-data, ocunit, core-data-migration

我正在使用自定义实体迁移策略为我的迁移构建映射模型，我真的很想为此迁移构建一些单元测试。当我运行应用程序时，迁移似乎可以正常工作，但是当我通过单元测试运行迁移时，根本不会调用我的 NSEntityMigrationPolicy 子类方法。

我正在使用 Xcode 的内置 OCUnit 框架。

我的测试代码：

```
- (void)test1to2Migration_appIdentifierMoved {
  [self createVersion1Store];

  // TODO Perform migration
  NSManagedObjectModel *version1Model = [self version1Model];
  NSManagedObjectModel *version2Model = [self version2Model];

  NSError *error = nil;
  NSMappingModel *mappingModel = [NSMappingModel
      inferredMappingModelForSourceModel:version1Model
      destinationModel:version2Model error:&error];
  STAssertNotNil(mappingModel, @"Error finding mapping model: %@", error);

  NSMigrationManager *migrationManager =
      [[[NSMigrationManager alloc]
        initWithSourceModel:version1Model
        destinationModel:version2Model]
       autorelease];

  BOOL migrationSucceeded =
      [migrationManager migrateStoreFromURL:self.version1StoreURL
           type:NSSQLiteStoreType
           options:nil
           withMappingModel:mappingModel
           toDestinationURL:self.version2StoreURL
           destinationType:NSSQLiteStoreType
           destinationOptions:nil
           error:&error];
  STAssertTrue(migrationSucceeded, @"Error migrating store: %@", error);

  // TODO Verify appIdentifier is moved from Project to its Tests

  [self deleteTempStores];
} 
```

我的映射模型指定了一个自定义的 NSEntityMigrationPolicy 来定义该`-createRelationshipsForDestinationInstance:entityMapping:manager:error:`方法，但我的策略从不从单元测试中调用。当我运行迁移时，模型被修改为新版本——预期的属性显示在正确的位置。

有什么想法可以让我的迁移策略在单元测试中起作用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-03-04T03:43:01.220

**斯威夫特 3**

替换模型文件名的变量**modelName**和**modelNameVersionFormatString**

```
import XCTest
import CoreData

class RCCoreDataMigrationTests: XCTestCase {

    private let storeType = NSSQLiteStoreType
    private let modelName = "Model"
    private let modelNameVersionFormatString = "Model-%@"

    private func storeURL(_ version: String) -> URL? {
        let storeURL = URL(fileURLWithPath: "\(NSTemporaryDirectory())\(version).sqlite" )
        return storeURL
    }

    private func createObjectModel(_ version: String) -> NSManagedObjectModel? {
        let bundle = Bundle.main
        let managedObjectModelURL = bundle.url(forResource: modelName, withExtension: "momd")
        let managedObjectModelURLBundle = Bundle(url: managedObjectModelURL!)
        let modelVersionName = String(format: modelNameVersionFormatString, version)
        let managedObjectModelVersionURL = managedObjectModelURLBundle!.url(forResource: modelVersionName, withExtension: "mom")
        return NSManagedObjectModel(contentsOf: managedObjectModelVersionURL!)
    }

    private func createStore(_ version: String) -> NSPersistentStoreCoordinator {
        let model = createObjectModel(version)
        let storeCoordinator = NSPersistentStoreCoordinator(managedObjectModel: model!)
        try! storeCoordinator.addPersistentStore(ofType: storeType,
                                                 configurationName: nil,
                                                 at: storeURL(version),
                                                 options: nil)
        return storeCoordinator
    }

    private func migrateStore(fromVersionMOM: String, toVersionMOM: String) {
        let store = createStore(fromVersionMOM)
        let nextVersionObjectModel = createObjectModel(toVersionMOM)!
        let mappingModel = NSMappingModel(from: [Bundle.main], forSourceModel: store.managedObjectModel, destinationModel: nextVersionObjectModel)!
        let migrationManager = NSMigrationManager(sourceModel: store.managedObjectModel, destinationModel: nextVersionObjectModel)
        do {
            try migrationManager.migrateStore(from: store.persistentStores.first!.url!,
                                              sourceType: storeType,
                                              options: nil,
                                              with: mappingModel,
                                              toDestinationURL: storeURL(toVersionMOM)!,
                                              destinationType: NSSQLiteStoreType,
                                              destinationOptions: nil)
        } catch {
            print("Error: \(error)")
            XCTAssertNil(error)
        }
        try! FileManager.default.removeItem(at: storeURL(toVersionMOM)!)
        try! FileManager.default.removeItem(at: storeURL(fromVersionMOM)!)
    }

    func testMigratingStores() {
        migrateStore(fromVersionMOM: "1486", toVersionMOM: "1487")
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T18:57:42.043

问题竟然出在一线

```
NSMappingModel *mappingModel = [NSMappingModel
  inferredMappingModelForSourceModel:version1Model
  destinationModel:version2Model error:&error]; 
```

如果我将其更改为

```
NSMappingModel *mappingModel = [NSMappingModel
  mappingModelFromBundles:@[[NSBundle bundleForClass:[MyTestClass class]]]
  forSourceModel:version1Model destinationModel:version2Model]; 
```

然后测试正常运行。

# perl - 运行 Build.pl 非交互式

> ID：11959451
> 
> 赞同：3
> 
> 时间：2012-08-14T19:31:13.307
> 
> 标签：perl, build

当`Build.pl`一些 Perl 项目在以前不用于 Perl 开发的系统上运行时，如果用户想在安装前添加某些包，它会一次又一次地中断。

有什么方法可以让非交互式默认运行，`Build.PL`而无需观看数小时并一次又一次地按“输入”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:40:54.097

[`PERL_MM_USE_DEFAULT=1`](http://p3rl.org/ExtUtils%3a%3aMakeMaker#ENVIRONMENT)

> 如果设置为真值，那么 MakeMaker 的提示功能将始终返回默认值，而无需等待用户输入。

[在 Module::Build 中工作相同。](http://p3rl.org/Module%3a%3aBuild%3a%3aAPI#prompt-message-default-)

* * *

[`PERL_EXTUTILS_AUTOINSTALL=--default-deps`](http://p3rl.org/Module%3a%3aAutoInstall#ENVIRONMENT)

> --alldeps 将安装所有功能，而 --defaultdeps 将仅安装默认答案为“y”的功能。

* * *

如果您使用 CPAN，还需要配置[`prerequisites_policy=follow`](http://p3rl.org/CPAN#Config-Variables).

这可以处理*大多数*提示。有几个坏苹果仍然需要某种形式的人工干预。[Distroprefs](http://p3rl.org/CPAN#Configuration-for-individual-distributions-Distroprefs-)会处理它们，请参阅[`distroprefs`目录](https://metacpan.org/source/ANDK/CPAN-1.9800/distroprefs)。

# php - Savings settings in a custom PHP plugin for WordPress

> ID：11959452
> 
> 赞同：1
> 
> 时间：2012-08-14T19:31:14.423
> 
> 标签：php, post, wordpress

First, I'd like to pre-emptively apologize for doing anything naive or foolish. I'm a novice programmer, but I'm trying to learn. Right now, I'm trying to develop a plugin for wordpress as part of my internship. The plugin does what it needs to do for the most part, but I just can't seem to make the settings page work the way I want. I know the initialization part of the plugin is working properly, but I'm having trouble with using the settings page. Specifically, I don't where or how to use **_POST** in order to save the information. I also don't where to place the **update_option** function call after I've received the information from the settings page. Here's my code right now:

```
add_action( 'admin_menu', 'menu' );
add_action( 'admin_init', 'plugin_admin_init' );

function plugin_admin_init() { // whitelist options
  register_setting( 'plugin_options', 'plugin_options', 'plugin_options_validate' );
  add_settings_section('plugin_main', 'Main Settings', 'plugin_section_text',           'plugin');
  add_settings_field('plugin_text_string', 'REE View Count Settings',           'plugin_setting_string', 'plugin', 'plugin_main');
}

function menu() {
    add_options_page( 'REE View Count Options', 'REE View Count', 'manage_options',     'plugin', 'plugin_options_page' );
}

// generates the settings web page
function plugin_options_page() {
    echo '<div class="wrap">';
    echo '<h2>Options</h2>';
    echo '<form action="' . $_SERVER['PHP_SELF'] . '" method="post">'; 
    // In the line above, I don't know what to put. The file name of the plugin?
    // The URL of the settings page on the admin page? Or what I have currently? 
    // Both the first and last options bring up a 404 page.
    settings_fields('plugin_options');
    do_settings_sections('plugin');
    echo '<input name="Submit" type="submit" value="' . esc_attr_e('Save Changes') . '"         />';
    echo '</form>';
    //update_option('plugin_options', $_POST['plugin_options']);
    // Where should I try to update the option? And how?
    echo '</div>';
}

//from add_settings_section parameter 3, in plugin_admin_init
function plugin_section_text() {
    echo '<p>Main description of this section here.</p>';
}

//Function from 3 paramter of add_settings_field in plugin_admin_init that outputs     input HTML
function plugin_setting_string() {
    $options = get_option('plugin_options');
    echo 'value of options is: ' . $options;
    echo "<input id='plugin_text_string' name='plugin_options' size='40' type='text' 
    value='{$options}' />";
}

//Validation function from register_setting in plugin_admin_init
function plugin_options_validate($input) {
    echo "this is input: " . $input;
    $newinput = trim($input);
    if(!preg_match('/^[0-9]+$/', $newinput)) {
        $newinput = 10;
    }
    update_option('plugin_options', $newinput);
    return $newinput;
} 
```

**Note:** I don't actually use these exact function/variable names - I have them prefixed with the actual plugin name.

Can you help me? I want to take the information the admin inputs into the settings page and update the database with the that information (which in this case is just a single number). I understand that I need to use PHP _POST, but I don't know how. Furthermore, I don't where to post to, because when I use action="the_file_name.php," I get a 404 error upon submission. What should the action of the form be so that I can use the information that I got from the admin submission and use it for later? And after I do that, how do update the setting? And by how, I mean where do I place update_option? I apologize if this seems rambly or vague - I feel like I'm somewhat over my head.

If it helps, I've been building this settings page in the same file as the plugin itself, with the help of this guide: [http://ottopress.com/2009/wordpress-settings-api-tutorial/](http://ottopress.com/2009/wordpress-settings-api-tutorial/)

Unfortunately, I don't see anything in that guide that speaks of updating information, just creating the page itself.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T20:30:00.553

你想指向action="options.php"。它处理更新值。查看以下链接以获取更多详细信息。

[http://planetozh.com/blog/2009/05/handling-plugins-options-in-wordpress-28-with-register_setting/](http://planetozh.com/blog/2009/05/handling-plugins-options-in-wordpress-28-with-register_setting/)

[http://www.sitepoint.com/wordpress-options-panel/](http://www.sitepoint.com/wordpress-options-panel/)

# php - PHP日期显示来自时间戳的奇怪年份/日期

> ID：11959453
> 
> 赞同：1
> 
> 时间：2012-08-14T19:31:16.290
> 
> 标签：php, date, timestamp

我有以下时间戳：

```
1341111034380 
```

这相当于：

```
Sun, 01 Jul 2012 02:50:34 GMT 
```

但是，当我尝试使用以下格式对其进行格式化时：

```
date("F j, Y, g:i a", 1341111034380) 
```

我得到：

```
February 12, 44468, 5:53 am 
```

任何想法为什么会这样做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T19:33:30.843

你有错误的单位。

1341111034380 以毫秒为单位，而正确的时间戳以秒为单位，这是 PHP 所期望的。

如果你想在 PHP 中使用它，你应该将它转换为秒。

```
echo date("F j, Y, g:i a", floor(1341111034380/1000)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:36:38.823

采用：

```
echo date("F j, Y, g:i a", substr(1341111034380, 0, 10)); 
```

# html - How to get an a tag hover to also work on wrapped span

> ID：11959456
> 
> 赞同：0
> 
> 时间：2012-08-14T19:31:26.263
> 
> 标签：html, css

I have a span tag that has a background image on it then inside it I have an a tag with text link. The span has the background image set to the right of the text link. I want when you rollover the a tag for it to also cover the span background image in its hover state also. I tried something like this but still not working.

```
 span a:first-child + span a:hover{
            cursor: pointer;
        } 
```

Markup html

```
 <div class="wrapper">
            <span>Study Bill</span>
            <span><a href="#">Download PDF</a></span>
        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:35:58.503

换一种方式；用一个大标签包裹你的跨度`<a>`，并将链接文本写在`<span>`. 例如：

```
<a href = "#">
    <span style = "background-image: url(your_image.png);">
        Download PDF
    </span>
</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:36:52.397

在与孩子交互时，您不能在 CSS 中更改父母的属性——它只能以一种方式工作。但是你可以做这样的事情 - [http://jsfiddle.net/uH2XP/](http://jsfiddle.net/uH2XP/)

```
<a href="#">some link text</a>

<style>
a:after {
    content: '';
    display: inline-block;
    height: 20px;
    width: 20px;
    background: green;
}

a:hover:after {
    background: orange;
}
</style> 
```

只需替换`content: ''`为`content: url(path/to/your/image.png)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T19:56:08.600

我可能会尝试将背景分配给链接和跨度。然后你可以让悬停状态处理背景转换。

```
<style>
     div.wrapper a, div.wrapper span{background:#f00;}
     div.wrapper a:hover{background:#0f0;}
</style>

<div class="wrapper">
     <span>Study Bill</span>
     <a href="#">Download PDF</a>
</div> 
```

[http://jsfiddle.net/sdowswell/sz6fq/](http://jsfiddle.net/sdowswell/sz6fq/)

# javascript - jQuery Transit: Object none has no method 'setFromString'

> ID：11959459
> 
> 赞同：14
> 
> 时间：2012-08-14T19:31:33.793
> 
> 标签：javascript, jquery, css-transitions, jquery-transit

I have loaded in jQuery transit, and I made sure I did it after loading jQuery, but I still get this error:

I have looked at the resources panel in Chrome, and jQuery transit is being loaded after jQuery. It has also loaded correctly, and shows up with no problems.

I have also tested in the console, testing the examples on the website. They all return this same error.

here is my code:

```
 $("#current-employers a.industry-company-link").click(function (e)
    {
        e.preventDefault();
        var url = $(this).attr("href");
        var company_container = $("#current-company-profile");
        company_container.load(url);
        company_container.transition({
            y: ($(this).offset().top - company_container.offset().top)
        });
        console.log("container offset: " + company_container.offset().top + "\nURL offset: " + $(this).offset().top);
    }); 
```

And the scripts I bring in:

```
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.8.0/jquery-1.8.0.min.js"></script>

        <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery.transit/0.1.3/jquery.transit.min.js"></script> 
```

Thanks for any help.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-14T19:34:43.243

好吧，在这种情况下，事实证明这是 jQuery 的错。jQuery 1.8 是这里的罪魁祸首。加载 1.7.2 解决了这个问题。我会将这个错误报告给运输和 jQuery 团队。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-14T20:36:30.943

更新（2013 年 4 月 13 日）：我正在阅读 Transit 的源代码，克鲁兹先生似乎已经更新了代码以有效地使用 jQuery 1.8+。如果有人测试过它，请他们确认它有效。谢谢。

* * *

这与 jQuery 和 Transit 使用的 css 挂钩有关。在 1.7 版中，jQuery 没有用于转换的 css 钩子。所以 Transit 为我们实现了一个钩子。然而，jQuery 更新了自己，现在提供了用于转换的 css 钩子。这些现在相互冲突。然而，这不是一个错误，因为 jQuery 工作正常，因此不需要向 jQuery 报告。

您的选择是使用 1.7 版本的 jQuery 并等到 Transit 更新或编辑 Transit 代码，这只需大约一分钟。

要进行编辑，请从官方网站获取 Transit 的开发版本。然后转到第 603 行，它显示 $.cssHooks[prop]。删除该方法并将此方法放在那里：

```
$.cssHooks[prop] = {
  get: function(elem) {
    var t = $(elem).css('transform');

    if (!t || t === "none") {
      t = new Transform();
    }
    return t.get(prop);
  },

  set: function(elem, value) {
    var t = $(elem).css('transform');

    if (!t || t === "none") {
      t = new Transform();
    }

    t.setFromString(prop, value);

    $(elem).css({ transform: t });
  }
}; 
```

您可以在数百个可用的压缩器之一上缩小代码，例如[http://jscompress.com/](http://jscompress.com/)

# amazon-web-services - Is there way to specify a cloud un-init (decomission script) script like the cloud-init one?

> ID：11959466
> 
> 赞同：0
> 
> 时间：2012-08-14T19:31:59.603
> 
> 标签：amazon-web-services

I am using cloud init to configure nodes as they come up now also need a decommissioning script to clear up some entries from remote servers. Is there an easy way to specify the decommission script like we specify the init script on node launch?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T03:46:05.237

这实际上`cloud-init`不像一般的linux函数那样是一个函数。[这个问题](https://superuser.com/questions/174350/execute-script-before-shutting-down-in-ubuntu)应该可以帮助您在关机时运行脚本，这正是您所寻求的。

# c# - 使用 func<> 委托时，我可以以任何方式更改签名吗？

> ID：11959468
> 
> 赞同：1
> 
> 时间：2012-08-14T19:32:04.813
> 
> 标签：c#, .net, c#-4.0

我有一个数据访问层命名空间，其中包含大量重复代码（主要是设置命令对象并执行存储过程以返回添加到列表中的数据集）。我正在尝试编写一个返回`List<T>`. 我对泛型和委托都比较陌生。我的想法是有一个 Func 参数来创建添加到`List<T>`. 它将在通常的`while dataReader.Read()`块中调用。我的问题是，我将使用的数据集具有不同数量的列。

这是我到目前为止所拥有的：

```
private static List<T> ListFromDatabase<T,U>(String CommandName, SqlConnection SqlConn, Func<T,U> CreateListObj, 
    List<SqlParameter> ParamList = null)
{
    List<T> returnList = new List<T>();

    using (SqlCommand cmd = new SqlCommand(CommandName,SqlConn))
    {
        cmd.CommandType = CommandType.StoredProcedure;
        foreach (SqlParameter sp in ParamList)
        {
            if (sp.Value == null)
                sp.Value = DBNull.Value;
            cmd.Parameters.Add(sp);
        }

        SqlDataReader sdr = cmd.ExecuteReader();
        while (sdr.Read())
        {
            returnList.Add(CreateListObj);
        }
    }

    return returnList;
} 
```

以我目前的理解水平，这可能是不可能的，因为我可能不得不针对不同数量的参数改变 Func 签名。这是可行的还是接近的？如果不是，我愿意采用不同的方法，如果有人可以提供帮助。提前谢谢了..

**更新：这正是我想要的：**

[将数据读取器中的行转换为类型化结果](https://stackoverflow.com/questions/1202935/convert-rows-from-a-data-reader-into-typed-results)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:39:00.803

做你想做的最优雅的方法是`Tuple<T1,T2,T3...>`通过传递一个接受具有特定数量和类型项目的元组的函数将 T 指定为 a，然后使用 Tuple.Create 使用来自 sdr 的行的内容生成该元组. 问题是，当从 DataReader 中获取字段时，它们会作为未确定类型的对象出现，而当您不知道它们的真实类型时传递它们的最安全方法是作为字符串，这意味着 CreateListObj 函数必须期望字符串和能够正确解析它们（因此期望元组中的特定列顺序）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:42:39.247

为什么不将您的代表传递`SqlDataReader`给您的代表`IDataRecord`？委托可以从数据记录中得到它所需要的；您可以控制对阅读器的迭代。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T19:47:30.767

我过去所做的是定义“构建器”方法，这些方法接受`IDataReader`并返回它们定义的类型的对象（我将它们作为泛型类的方法而不是委托，但`Func<IDataReader, T>` 会做一样。

一般来说，我`CommandBehavior.CloseConnection`在`ExecuteReader`调用中使用过，然后返回一个保存在阅读器上的类，实现`IEnumerable<T>` 然后在处理阅读器时关闭阅读器（以及底层连接），而不是先创建整个列表（你必须如果枚举器实际上根本没有枚举，请小心它会被清理）。

优点是我不必在定义时担心列号和类型的差异，只需在实现时（我不禁担心）。

# javascript - Knockout binding checkbox group with json

> ID：11959469
> 
> 赞同：-1
> 
> 时间：2012-08-14T19:32:07.840
> 
> 标签：javascript, jquery, knockout.js

I have the following knockoutjs code with 3 checkboxes.

[http://jsfiddle.net/gzfff/2/](http://jsfiddle.net/gzfff/2/)

The issue here is that the checkboxes are not being binded correctly with the json data.

Any clue?

HTML

```
<form>
    <div>
        <div>
            <label><input type="checkbox" data-bind="checked: properties" value="1" />Property ABC</label><br/>
            <label><input type="checkbox" data-bind="checked: properties" value="2" />Property CON</label><br/>
            <label><input type="checkbox" data-bind="checked: properties" value="3" />Property ZZZ</label>
        </div>
    </div>
</form>

<hr/>

<div data-bind="text: ko.toJSON(properties)"></div>​ 
```

JS

```
var jsonData= [1,2];

var App = function (jsondata) {
    var self = this;

    self.properties = ko.observableArray(jsondata);
};
var appViewModel = new App(jsonData);
ko.applyBindings(appViewModel);​ 
```

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:37:04.467

换行

```
var jsonData= [1,2]; 
```

至

```
var jsonData= ["1","2"]; 
```

[http://jsfiddle.net/hE92D/](http://jsfiddle.net/hE92D/)

# javascript - arguments.callee 仍然可以安全使用还是有更好的选择

> ID：11959482
> 
> 赞同：1
> 
> 时间：2012-08-14T19:33:17.667
> 
> 标签：javascript

我正在分析我正在阅读的书中的一些代码，其中有一小部分让我有点困惑：

```
//... some code

setTimeout(function(){
   //...some code
   if(some condition)
      setTimeout(arguments.callee, 0);
}, 0); 
```

让我有点困惑的是，同一本书提到“被调用者”属性已被弃用，除非绝对必要，否则不应使用它（我在解释）。所以我想知道这是否是其中一种情况，或者是否有更好的方法来完成递归调用。我在互联网上的某个地方读到以下内容可能会完成同样的事情：

```
//... some code

setTimeout(function myRecursiveFunction(){
   //...some code
   if(some condition)
      setTimeout(myRecursiveFunction, 0);
}, 0); 
```

它是否正确？还有更好的方法来解决这个问题吗？继续使用arguments.callee是否安全且可以？

谢谢你的澄清。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:36:06.277

`arguments.callee`已弃用，可能会被删除。
它还使浏览器更难优化代码。

你的第二种方法是正确的。
当您使用名称创建匿名函数（*函数表达式*）时，函数表达式中的代码可以访问该名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:38:26.230

第二种方法是最好的。它实际上所做的是将函数声明“提升”到最近的封闭范围（定义 this 的函数）的顶部，并将函数命名为“myRecursiveFunction”。

另一种方法是创建一个匿名范围，如下所示：

```
setTimeout(
    (function(){
        var myRecursiveFunction = function() {
            console.log(myRecursiveFunction);
        };
        return myRecursiveFunction
    }),
    1000
) 
```

或者也许使用函数式编程中的定点组合器。

# php - Parse error: syntax error, unexpected T_STRING, expecting ',' or ';' in C:\AppServ\www\text.php on line 11

> ID：11959493
> 
> 赞同：2
> 
> 时间：2012-08-14T19:33:46.997
> 
> 标签：php, syntax-error, echo

I am new to PHP and have a question about it.

```
<?php

    echo "Do you like it?";
    echo "<br>";
    echo "My name is:<b><i><div style="text-align:center;">Karthic</div></i></b> ";

?> 
```

When I try to load this script in my browser, I am getting this error:

> Parse error: syntax error, unexpected T_STRING, expecting ',' or ';' in C:\AppServ\www\text.php on line 11

Lline 11 is

```
echo "My name is:<b><i><div style="text-align:center;">Karthic</div></i></b> "; 
```

How can I fix this?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T19:36:53.857

`"`问题是样式数据周围的内引号 ( ) 结束了字符串。要么使用单引号`'`（这样 PHP 将寻找另一个单引号来表示字符串的结尾）：

```
echo 'My name is:<b><i><div style="text-align:center;">Karthic</div></i></b> '; 
```

或者转义字符串中的双引号：

```
echo "My name is:<b><i><div style=\"text-align:center;\">Karthic</div></i></b>"; 
```

这告诉 PHP 在解析代码时忽略它们（而是将它们放在字符串本身内部）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T19:35:03.640

打印 HTML 时使用单引号

```
echo 'My name is:<b><i><div style="text-align:center;">Karthic</div></i></b> '; 
```

代替

```
echo "My name is:<b><i><div style="text-align:center;">Karthic</div></i></b> "; 
```

您正在切断 HTML 字符串，所以它出错了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-14T19:36:18.840

你不能做

```
echo "My name is:<b><i><div style="text-align:center;">Karthic</div></i></b> "; 
```

因为有 2 个双引号，一个在 echo 一个在 style 之后

你应该这样做

```
echo "My name is:<b><i><div style=\"text-align:center;\">Karthic</div></i></b> "; 
```

但最重要的是；你不需要为这样的 HTML 代码做回显。

问候

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-14T19:36:23.197

您必须转义双引号中包含的任何双引号。您使用反斜杠字符转义双引号。

```
<?php
echo "Do you like it?";
echo "<br>";
echo "My name is:<b><i><div style=\"text-align:center;\">Karthic</div></i></b> ";
?> 
```

您还应该将粗体和斜体标签放在 div 内，而不是放在 div 之外。

# jquery - 如何阻止 chrome 滚动以聚焦选择

> ID：11959496
> 
> 赞同：6
> 
> 时间：2012-08-14T19:34:02.143
> 
> 标签：jquery, select, webkit, scroll

我正在开发一种控件，您可以在其中拥有两个多选列表，其中包含可以在彼此之间移动的项目集合。

一个或两个列表的内容有可能比我希望的项目本身更宽，因此我将它们分别由两个 div 和一个 select 表示，如下所示：

```
<div class="container">
    <div class="concealer">
        <select size="4">
            ...
        </select>
    </div>
</div> 
```

将 select 放在 div 中允许水平滚动（因为 select 不允许）。当添加或删除项目时，将调整选择的大小（设置 size 属性）以适应其内容。“遮瑕膏”DIV避免双滚动条在选择上隐藏垂直滚动条，并且在选择变化时垂直尺寸。

我正在使用html5。标准模式下的 IE9 和 Firefox 都可以。我遇到的问题是Chrome（实际上也是Safari，所以...... webkit）。如果控件位于具有垂直滚动的窗口或容器（例如 div）中，并且您将其滚动到看不到选择顶部的点，如果选择的底部可见（或将在外部容器中可见，如果可以看到溢出），当您单击选择中的一个项目，导致选择聚焦时，Chrome 将外部容器滚动到其顶部或足够远，以便选择的顶部是如果您可以通过包含它的 div 看到它，则可见。

如前所述，如果选择中最底部的选项在（包含）窗口中可见，但选择的顶部不可见，则 chrome 将滚动。

我已经编写了脚本来将滚动窗口的 scrollTop 调整回其当前位置，这*会*起作用，除了我发现在我的登台和生产环境中，chrome 所做的调整也会导致实际的选项选择发生在 chrome 进行了自己的调整之后，这意味着点击注册了错误的选项（无论浏览器向上滚动多少都会关闭），选择是否有 onfocus 事件是个问题。

在这样的准系统测试中，我无法让选项选择问题发生，但滚动本身就是一个问题。

我发现防止这种情况发生的唯一方法是将选择的大小调整为足够大的数字，以便将选择井的底部放在外部容器的底部之外，但这根本不理想，因为它离开了大量的空白，是一种糟糕的用户体验，并且解决了一个（虽然相当深刻）只影响 webkit 的问题。

有谁知道我还能如何防止或抵消这种行为？

我确实有与此相关的图像，但可以理解的是，新用户无法发布图像。这是一个 js fiddle，应该可以让您轻松重现该问题：http: [//jsfiddle.net/4N9Kg/22/](http://jsfiddle.net/4N9Kg/22/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T11:41:27.060

我有一个解决方法..（**免责声明**：这是一种解决方法而不是解决方案）

```
$('#sel').mousedown(function(e){
    $(e.target).attr('selected', 'selected'); //select the clicked <option> item
    e.preventDefault();
}); 
```

**[演示](http://jsfiddle.net/mrobin/4N9Kg/25/)**

# javascript - Bootstrap nav-collapse toggles once

> ID：11959501
> 
> 赞同：2
> 
> 时间：2012-08-14T19:34:17.147
> 
> 标签：javascript, jquery-plugins, twitter-bootstrap, css-transitions, collapse

I have a collapsable menu on a website I'm developing, but the collapse is only toggling through once. I click "MENU" the menu expands, click it again, the menu closes, but won't continue toggling.

Here is a link to my development server. Just resize the browser window until the "MENU" button shows up and click it.

[http://www.corporateprdev.com/ymcakpt](http://www.corporateprdev.com/ymcakpt)

Here is my menu structure:

```
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        MENU
      </a>
      <a class="brand" href="/ymcakpt/"><img src="/ymcakpt/themes/responsive/images/y-nav-collapse.png" alt="YMCA::Home" longdesc="images/y-nav-collapse.png" align="left" style="margin-right: 15px;"></a>
      <div class="nav-collapse">
        <ul class="nav">
          <li class="active">
            <a  href="/ymcakpt/">Home</a>
          </li>
          <li>
            <a href="/ymcakpt/index.php/about/"  >About</a>
          </li>
          <li>
            <a href="/ymcakpt/index.php/membership/"  >Membership</a>
          </li>
          <li>
            <a href="/ymcakpt/index.php/schedules/"  >Schedules</a>
          </li>
          <li>
            <a href="/ymcakpt/index.php/contact-us/"  >Contact Us</a>
          </li>
        </ul>
        <form class="navbar-search pull-right" action="/ymcakpt/index.php/search/">
          <input name="query" type="text" class="search-query" placeholder="Search" style="padding: 2px 8px; margin: 0; width: 210px;">
          <input name="Submit" class="submit" type="image" src="/ymcakpt/themes/responsive/images/go-btn.png" value="Go" style="width: 35px; height: 25px;">
    </form>
          </div><!--/.nav-collapse -->
        </div>
      </div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:30:56.050

您的问题是两个 JavaScript 文件之间的冲突，即**bootstrap-transition.js**和**ccm.app.js**。他们都在写入 jQuery 变量`$.support.transition`。Bootstrap 要求它是一个包含属性的对象，该属性`end`包含在 CSS3 转换结束时触发的浏览器特定事件。另一个文件正在覆盖`support.transition`仅是布尔值。

当`hide`调用该方法时，`transitioning`将其设置为，`true`并且由于未定义表示转换结束的事件名称，因此该`transitioning`属性永远不会重置为 false。这会导致将来对 Collapse 插件的任何调用`show`或`hide`对 Collapse 插件的调用都会短路。

您可以尝试修改**ccm.app.js**以与 Twitter Bootstrap 的 Transitions 插件兼容。只需添加一个检查以不覆盖现有值就足够了。

另一种选择是尝试确保在**ccm.app.js**之后加载**bootstrap-transition.js**。只要**ccm.app.js**只寻找*真实*的值，你应该是好的。

 ****** * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-23T11:42:47.207

我遇到了同样的问题，它是由双重包含 javascript 文件引起的。

我确实**包含了我的库 javascript 文件两次**，当我删除重复的文件时，它运行良好。*****

# file - 分配多个文件来设置变量名的方法？

> ID：11959502
> 
> 赞同：0
> 
> 时间：2012-08-14T19:34:26.423
> 
> 标签：file, matlab, user-interface, variables

有没有办法使用 GUI 分配文件名来设置变量？假设我有 6 个文件集，每个文件集包含 4 种颜色（蓝色、绿色、nir、红色）。总共有 24 个文件，所以我需要 24 个变量。我希望 set varialbes 类似于

```
blue1
green1
nir1
red1

blue2
green2
nir2
red2

etc... 
```

目前我正在尝试使用 GUIDE 创建一个自定义 GUI，允许用户选择他们想要的文件并将它们分配给某些变量。我正在考虑将 24 个弹出菜单附加到文件目录并允许用户选择他们想要的文件，然后它将分配该文件及其变量的路径（例如 blue1）我也想要与 if 语句关联的 24 个复选框

假设 popupmenu1 与变量 blue1 和 checkbox1 相关联

`if checkbox1 == checked`

`do import`

`elseif checkbox1 == unchecked`

`fill with zeros`

我已经创建了 GUI 的基本框架，我只是不清楚如何应用文件选择然后关联 if 语句等......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:48:41.467

```
for k = 1:6
blue(k) = sprintf('blue%d', k);
green(k) = sprintf('green%d', k);
nir(k) = sprintf('nir%d', k);
red(k) = sprintf('red%d', k);
end 
```

这将为您创建变量名称。然后您可以使用 assignin （我相信）或 eval 将值设置为变量名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:40:45.633

如果您事先知道变量文件，那么使用字符串定义的变量名称是[不好的做法](http://blogs.mathworks.com/videos/2010/03/08/top-10-matlab-code-practices-that-make-me-cry/1/)（也请[查看此处](http://matlab.wikia.com/wiki/FAQ#Why_is_it_advised_to_avoid_using_the_.22eval.22_function.3F)和[此处），如下所示：](http://www.mathworks.nl/help/matlab/matlab_prog/string-evaluation.html)

```
var1name = 'blue';
var2name = 'red';
% etc.

% load data
datablue=rand(4,1);
datared =rand(4,1);

% assign
eval([var1name '1 = datablue(1);']);
eval([var2name '1 = datared (1);']);
% etc.
eval([var1name '2 = datablue(2);']);
eval([var2name '1 = datared (2);']);
% etc 
```

考虑到变量名没有改变或应用程序依赖，只使用普通数组会更容易更好，在我的示例中我已经有了 as`datablue`和`datared`.

如果您想要用户定义的变量名称，另一种选择是使用`array of structs`：

```
var1name = 'blue';
var2name = 'red';
sample(1).(var1name) = datablue(1);
sample(1).(var2name) = datared (1);
% ...
sample(2).(var1name) = datablue(2);
sample(2).(var2name) = datared (2); 
```

尝试其中一些，只有当你有充分的理由时，才使用`eval`！

# xaml - 样式取自哪里？

> ID：11959503
> 
> 赞同：1
> 
> 时间：2012-08-14T19:34:27.633
> 
> 标签：xaml, windows-8, microsoft-metro, winrt-xaml

我有个问题

我已经创建了新的 win8 metro 应用程序，但我没有从它的风格中得到。我更改了样式文件的 App.xaml 名称。我的 Style.xaml 看起来像这样

```
<!-- Page layout roots typically use entrance animations and a theme-appropriate background color -->
<Style x:Key="LayoutRootStyle" TargetType="Panel">
    <Setter Property="Background" Value="White"/>
    <Setter Property="ChildrenTransitions">
        <Setter.Value>
            <TransitionCollection>
                <EntranceThemeTransition/>
            </TransitionCollection>
        </Setter.Value>
    </Setter>
</Style> 
```

但是我仍然有金色字母，当我悬停它时，我的按钮变成白色。与默认的 StandardStyles.xaml 相同

我究竟做错了什么 ？或者它工作得很好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:24:19.797

您显示的样式只会影响使用该样式的面板。如果您将按钮放在面板内，则面板的样式不会级联到按钮。正如您从standardstyles.xaml 中正确推断的那样，该按钮具有自己的样式，用于控制其外观。如果要更改按钮的样式，则需要创建新样式或更新当前样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T02:28:28.307

**问题是您使用x:Key**属性为您的样式设置了一个键。一旦样式具有键，它将仅应用于隐式使用该命名样式的控件。如果删除键，则样式应应用于与**TargetType**匹配的所有控件（在本例中为 Panel）。

# java - How to enter text into tinymce text area using Selenium RC for Eclipse Java

> ID：11959505
> 
> 赞同：6
> 
> 时间：2012-08-14T19:34:40.390
> 
> 标签：java, selenium, tinymce, selenium-rc

I'm currently trying to automate test cases where I need to enter values for a required Text Area field.

The text area uses TinyMCE 3.4.9

I found a blog online that suggested selectFrame (iFrame containing tinymce) focus (tinymce) type (tinymce, text)

that didn't help since Selenium RC can't locate the iframe. However, I tried this with the Firefox plugin and at the very least I can select the iframe and focus the editor, but I can't enter any text. With RC, nothing I do seems to work

I also tried entering text using the html editor. So selenium can emulate clicking the button to open the html editor, then RC would either fail to find the text area or I'll get an error such that the element is no longer attached to the DOM (something along that line)

Sorry if this sounds confusing.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T00:10:58.010

这对我有用：

命令：runScript 目标：tinyMCE.activeEditor.setContent('替换为您的文本')

从[http://www.tinymce.com/forum/viewtopic.php?id=27960获得](http://www.tinymce.com/forum/viewtopic.php?id=27960)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-02T15:38:35.883

如果您在一页上有多个 tinyMCE 表单，我建议您使用
Command: runScript
Target: tinyMCE.get('textarea_id').setContent('Your Text')

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T16:41:20.467

首先你切换到框架

```
// driver is type of IWebDriver
driver.switchTo().frame(frameName or frameIndex); 
```

然后你通过 id 获取元素并用你的文本填充它

```
 var el = driver.findElement(By.id("tinymce"));
 el.sendKeys("YOUR TEXT"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-30T09:37:46.183

> WebElement bodyIframe = driver.findElement(By.tagName("iframe")); driver.switchTo().frame(bodyIframe); WebElement mce = driver.findElement(By.id("tinymce")); mce.sendKeys("这是为了测试！！！");

这对我来说非常有用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T10:16:15.617

我一直在尝试使用这个解决方案：

```
<tr>
  <td>type</td>
  <td>dom=document.getElementById('NAME_ifr').contentDocument.body</td>
  <td>Editor content</td>
</tr> 
```

替换了“name_ifr”。首先在进入tinymce框架之前输入框架名称并插入，然后将名称替换为'tinymce'并在输入框架后插入，根据所有规则键入必须发生的地方。但我得到的只是错误。不知何故，我从来没有让 DOM 或 js 命令在我的脚本中工作。有什么我想念的吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T20:44:47.350

对于 Firefox 中的 TinyMCE 3.4.x 和 Selenium IDE，这对我有用。将您的 TinyMCE 实例的 id 替换为`NAME`以下内容：

```
<tr>
    <td>type</td>
    <td>dom=document.getElementById('NAME_ifr').contentDocument.body</td>
    <td>Editor content</td>
</tr> 
```

这是基于[https://gist.github.com/809728](https://gist.github.com/809728)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-15T09:35:55.730

在 Selenium webdriver PHPUnit_Extensions_Selenium2TestCase 中，这在您使用时有效：

```
$this-> execute(array('script' => "tinymce.get('cms_cpg_content').setContent('Lorem ipsum dolor sit amet,...')", 'args' => array())); 
```

当您要添加文本时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-28T15:27:04.057

我们使用[techiebyday.blogspot.com](http://techiebyday.blogspot.com/2011/07/tinymce-and-selenium.html)中描述的过程，它在当前版本的 Selenium RC（至少到 2.20）和 TinyMCE（3.4 后）中运行良好。在 C# 中，它看起来像这样：

```
string editorFrameId = editorId + "_ifr";
selenium.Focus(String.Format("dom=document.getElementById('{0}').contentWindow.document.body", editorFrameId));
selenium.GetEval(String.Format("selenium.browserbot.getCurrentWindow().document.getElementById('{0}').contentWindow.document.body.innerHTML = '{1}';", editorFrameId, fillString)); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-12T17:02:43.687

如果页面中有一个 TinyMCE 元素：

```
var obj = ((IJavaScriptExecutor)webDriver).ExecuteScript("tinyMCE.activeEditor.setContent('" + text + "');"); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-16T14:54:35.423

我能够让 Selenium 测试与 TinyMCE 一起工作的唯一方法是不使用 TinyMCE 进行测试。

使用一些服务器端向导在测试条件下选择性地禁用 TinyMCE 插件。

这不会帮助您测试 TinyMCE 本身的使用，但您至少能够填写表格以完成并推进您的测试...... :)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-05-02T07:34:35.747

我在 tinyMCE 编辑器中输入文本时也遇到了问题：

*   火狐 20.01
*   tinyMCE 3.4.9
*   硒 IDE 1.10.0

我的表单中有多个 tinyMCE 编辑器。

解决方案（使用 Selenium IDE，可以轻松移植到 Selenium RC）：

*   使用 firebug，找出替换 textarea 的 tinymce iframe 的 id，例如 form_editor1_ifr
*   从这个id中去掉“_ifr”得到原始textarea的id
*   在 Selenium IDE 中的 runScript 命令的目标中使用此 id：tinyMCE.get('form_editor1_ifr').setContent('the content');

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-09-09T11:21:22.333

我能够使用 Selenium RC 解决此问题，已完成以下步骤（附上截图供您推荐）

1.  在 tinyMCE 编辑器上，单击高级选项图标
2.  点击“<>”源代码图标
3.  出现源代码弹窗，输入文字点击确定
4.  文本出现在 TinyMCE 编辑器中 [![在此处输入图像描述](../Images/badd33dee720be4a20d0d0ed4fdc1d43.png)](https://i.stack.imgur.com/DW0RH.jpg)

仅供参考，我已经给出了 CSS 定位器的步骤

*   单击高级选项按钮： css= tr[id*='tinymce'] td * div[aria-label='Advanced Options'] 按钮

*   点击源代码： css= tr[id*='tinymce'] td * div[aria-label='Source code'] 按钮

*   点击弹出 textarea css= div[class*='mce-floatpanel'][aria-label='Source code'] * textarea

*   单击弹出窗口上的确定按钮 css= div[class*='mce-floatpanel'][aria-label='Source code'] * div>button:contains('Ok')

*   验证 tinymce css=body p:contains 中存在的文本（这是测试）

希望这能解决你的问题:)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-08-14T22:56:26.463

[http://odino.org/typing-into-tinymce-with-selenium/](http://odino.org/typing-into-tinymce-with-selenium/) ...看起来 TinyMCE 和 selenium IDE 连接在 3.4.5 上不起作用，所以我的假设是这个问题已经延续到3.4.9。

# cross-platform - 我应该在 Win 或 Lin 中使用 CodeTyphon 进行跨平台开发吗？

> ID：11959507
> 
> 赞同：3
> 
> 时间：2012-08-14T19:34:46.870
> 
> 标签：cross-platform, cross-compiling, freepascal, lazarus

Lazarus CodeTyphon 版对我作为 Delphi 开发人员来说很有前途。我尝试在我的 Windows 7 64 位机器上安装它，我可以编译 Win32（似乎），但不能编译其他任何东西。看来“ppcrossx64.exe 未构建” - 哦，好吧。

我的问题是，如果我想交叉编译，在 Linux 机器上开发我的应用程序会更好吗？我在 FPC wiki 上读到它会更好，但不确定这是否也适用于 CodeTyphon。

# java - multipart/form 参数即将为空

> ID：11959510
> 
> 赞同：1
> 
> 时间：2012-08-14T19:35:08.417
> 
> 标签：java, jsp, servlets, apache-commons

我正在尝试获取由表单 enctype“multipart/form-data”发送的请求参数。我正在使用 apache commons 文件上传。

我的代码如下。

```
FileItemFactory factory = new DiskFileItemFactory();
ServletFileUpload upload = new ServletFileUpload(factory);
List items = upload.parseRequest(req);
Iterator uploadIterator = items.iterator();

while(uploadIterator.hasNext()){
FileItem uploadedItem = (FileItem) uploadIterator.next();

if (uploadedItem.isFormField()){

  if (uploadedItem.getFieldName().equals("name")){
    name = uploadedItem.getString();
  }
}else{
  //Uploaded files comes here
} 
```

表单的 HTML 代码为：

```
<form name="form" id="form" method="post" action="ServletIncluirEvento"
    enctype="multipart/form-data">
... //Here comes a lot of inputs (I changed the name of the attribute because I am from Brazil and the names are in portuguese)

<select size="9" id="idOpcoesSelecionadas" name="opcoesSelecionadas" multiple style="width: 100%;">
                                            <%  
 it =  colecaoUsuarioSelecionado.iterator();                             String name= "";
 while (it.hasNext()) {
 usuario = (Usuario) it.next();
 name += usuario.getName() + "/"; %>
 <option value="<%=usuario.getLogin()%>">
    <%=usuario.getName()%>
 </option>
<%
  }
%></select>

<input type="hidden" value="<%=name%>" name="name" /> 
```

即便如此，参数也将变为空。

有人知道怎么解决吗？

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T20:39:25.833

修改调用方法`equals`：

```
"name".equals(uploadedItem.getFieldName()); 
```

一般来说，我会更清楚地重写你的代码：

```
FileItemFactory factory = new DiskFileItemFactory();
FileUpload upload = new ServletFileUpload(factory);
List<FileItem> items = upload.parseRequest(req);
for (FileItem uploadedItem : items) {
    if (uploadedItem.isFormField()) {
        String fieldName = uploadedItem.getFieldName();

        if ("name".equals(fieldName)){
           name = uploadedItem.getString();
        }
    } else {
        // process file field
    }    
} 
```

这使得代码变得更易于理解。调用两次方法是没有意义的`getFieldName()`。并使用[Generic](http://docs.oracle.com/javase/tutorial/java/generics/why.html)。它通过在编译时进行检查类型来增加代码的稳定性。在获取当前对象时无需进行强制转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T19:06:13.307

为了解决这个问题，我用标签表单 enctype "multipart/form-data" 重新编写了 jsp 页面，用于我必须上传的图像，对于其他数据，使用普通表单，我可以正常获取请求参数。

我还进行了重构以改进逻辑。

感谢大家的提示。

# python - Python：自动对象生成和命名

> ID：11959513
> 
> 赞同：0
> 
> 时间：2012-08-14T19:35:16.810
> 
> 标签：python, class, object, automation, increment

我们有一个类，里面有一些数学函数

```
class MyObjects(object):
    q=1      #could be any number
    def f(x,y):
        return q*y+x    #could be any mathematical function 
```

假设我们要创建 100 个名为 like `object_1`, `object_2`...`object_100` 的新对象，并且所有这些对象都必须`q`定义一个变量，但为每个对象定义为`q_1`, `q_2`...`q_100`但我们希望每次创建对象时都增加q 的值`if q=1: q_1=q+1 q_2=q_1+1`等。如前所述，所有对象都必须使用为每个对象命名的类的 f(x,y) 函数，例如`f_1`, `f_2`... `f_100`。生成的对象数量将由用户设置`input()`这就是我想自动化这个过程的原因，通过在代码中添加类似于一百个对象的东西来“手工”完成非常麻烦。那么我可以自动化这个过程吗？Python 初学者，巨蟒老手，哈哈。如果您可以以更准确的方式重新表述问题，请随时编辑问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T19:42:59.717

定义一个类属性`q`和一个实例属性`q`。并且每次创建一个新实例时`MyObjects.q`都会增加，并且增加的值将被分配给`self.q`

```
class MyObjects(object):
    q=0
    def __init__(self):
       MyObjects.q+=1
       self.q=MyObjects.q

    def f(self,x,y):
        return self.q*y+x
inp=input("Enter number of objects: ")
dic={}
for x in range(1,inp+1):
    dic[x]=MyObjects() 
```

**输出：**

```
>>> dic[1].q
1
>>> dic[2].q
2
>>> dic[3].q
3
>>> dic[1].f(2,5)
7
>>> dic[2].f(2,5)
12
>>> dic[3].f(2,5)
17 
```

# visual-studio-2005 - Visual Studio 2005 ctrl+f 不工作

> ID：11959514
> 
> 赞同：0
> 
> 时间：2012-08-14T19:35:21.793
> 
> 标签：visual-studio-2005, replace

我最近重新安装了 Visual Studio 2005 而不是 ctrl+f 不起作用。在重新安装之前它工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:43:03.760

要做的第一件事应该是查看 ctrl+f 是否可以在记事本甚至浏览器中进行。

如果仍然无法正常工作，请尝试此链接[http://forums.asp.net/t/1103223.aspx/1](http://forums.asp.net/t/1103223.aspx/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T22:27:57.310

这对我有用...在命令提示符下运行 devenv /resetsettings

# javascript - 获取文本节点的宽度

> ID：11959517
> 
> 赞同：5
> 
> 时间：2012-08-14T19:35:39.577
> 
> 标签：javascript, width

一些（JS 修改的）HTML 可能如下所示：

```
<div style="width: 50px;">1,234,567</div> 
```

如何检测文本节点是否比容器宽？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:22:14.383

受[如何检测 div 元素中的溢出的启发？](https://stackoverflow.com/questions/7138772/how-to-detect-overflow-in-div-element)：

```
<!-- Overflowing -->
<div style="width: 50px;">1,234,567</div>

<!-- Not overflowing -->
<div>1,234,567</div> 
```

要检测的 JavaScript（无 jQuery）：

```
var divs = document.getElementsByTagName('div');
var i, div, overflowing;

for (i=0; i<divs.length; i++) {
    div = divs[i];
    overflowing = div.offsetWidth < div.scrollWidth;
    console.log(overflowing);
}​ 
```

[http://jsfiddle.net/mattball/pYj5P/](http://jsfiddle.net/mattball/pYj5P/)

# java - 如何从我的自定义 Eclipse 插件中调用现有的 Eclipse 对话框？

> ID：11959521
> 
> 赞同：1
> 
> 时间：2012-08-14T19:35:44.687
> 
> 标签：java, eclipse, eclipse-plugin

我正在创建一个需要调用 Eclipse`Refactor - Move`对话框并动态传递*源文件*和*目标位置*值的 Eclipse 插件。由于我已经有了源文件和目标位置，我可以跳过“选择目标”页面，直接进入“预览”页面，用户将在其中查看移动导致的压缩代码。

我的问题是，如何从我的插件中调用现有的 Eclipse 对话框？我应该使用哪些扩展点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:40:05.430

通常你只是追逐调用对话框的结尾（例如在调试器中运行 Eclipse，在`org.eclipse.swt.widgets.Shell`ctor 中设置断点并从弹出菜单中调用操作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T05:08:53.653

点击`Shift`- `Alt`-`F2`激活 Eclipse 中的**插件菜单间谍**。然后打开其中一个类的上下文菜单并选择您感兴趣的重构菜单（如 Refactor->Move）。

插件菜单间谍将向您显示相关操作`org.eclipse.jdt.ui.actions.MoveAction`，您可以单击以打开并检查它如何调用重构。

# ios - 集中中央标签栏按钮

> ID：11959525
> 
> 赞同：1
> 
> 时间：2012-08-14T19:36:05.367
> 
> 标签：ios, user-interface, uitabbar

这是怎么做的？中央标签栏按钮的圆顶效果？它是圆顶图像在规则中心形状的标签按钮顶部的简单投影吗？或者还有什么？

![](../Images/e26a1f3aba3db1fb04788974d9b6948c.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:49:06.457

您可以通过以下方式实现这一目标，

```
 UIButton* button = [UIButton buttonWithType:UIButtonTypeCustom];
    button.frame = CGRectMake(0.0, 0.0, buttonImage.size.width, buttonImage.size.height);
    [button setBackgroundImage:buttonImage forState:UIControlStateNormal];
    [button setBackgroundImage:highlightImage forState:UIControlStateHighlighted];

    CGFloat heightDifference = buttonImage.size.height - self.tabBar.frame.size.height;
    if (heightDifference < 0)
      button.center = self.tabBar.center;
    else
    {
      CGPoint center = self.tabBar.center;
      center.y = center.y - heightDifference/2.0;
      button.center = center;
    }

    [self.view addSubview:button]; 
```

请检查这些链接：http: [//idevrecipes.com/2010/12/16/raised-center-tab-bar-button/](http://idevrecipes.com/2010/12/16/raised-center-tab-bar-button/)

[您将在https://github.com/boctor/idev-recipes/tree/master/RaisedCenterTabBar](https://github.com/boctor/idev-recipes/tree/master/RaisedCenterTabBar)获得完整的源代码

# jquery - 将 div 转换为页面锚以循环所有幻灯片

> ID：11959528
> 
> 赞同：0
> 
> 时间：2012-08-14T19:36:14.923
> 
> 标签：jquery, cycle, jquery-cycle

我正在使用循环所有插件构建幻灯片，并且我希望页面锚点成为页面上其他地方的 div。

如何使 .pager div 对应于 .section-testimonials 幻灯片？

这是标记和jquery：

```
<div id="slide-nav">
<div class="pager">
    <div>
        stuff in here
    </div>
</div>
<div class="pager">
    <div>
        stuff in here
    </div>
</div>
<div class="pager">
    <div>
        stuff in here
    </div>
</div>
</div>

$('.section-testimonials').cycle({
    fx: 'fade',
    speed: 1000,
    containerResize: 0,
    timeout: 9000,
    pager:      '#slide-nav',
    pagerEvent: 'mouseover',
    pauseOnPagerHover: true,
    pagerAnchorBuilder: function(idx, slide) {
    // return sel string for existing anchor
    return '#slide-nav .pager:eq(' + (idx) + ') a';
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:13:33.610

知道了！请参阅此示例：http: [//jquery.malsup.com/cycle/goto.html](http://jquery.malsup.com/cycle/goto.html)

# java - 如何从 SQL 脚本、JDBC 或 Spring JdbcTemplate 在 MySQL 中创建函数？

> ID：11959531
> 
> 赞同：0
> 
> 时间：2012-08-14T19:36:20.233
> 
> 标签：java, mysql, sql, jdbc, jdbctemplate

我正在寻找一种在 MySQL 中创建函数的方法，最好是从脚本（**从 Java 执行**），但标准 JDBC 或 Spring 的 JdbcTemplate 也可以。

我已经成功地使用以下命令从 mysql 命令行控制台创建了该函数：

```
DELIMITER $$
CREATE FUNCTION test() RETURNS double DETERMINISTIC
BEGIN
  RETURN 63;
END$$ 
```

但是由于`DELIMITER`不是有效的 SQL 语法，所以从脚本运行它时会出现异常：

`[42000][1064] You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER $$`

当我尝试使用 Spring JDBC 模板创建它时

```
jdbcTemplate.execute("CREATE FUNCTION some() RETURNS double DETERMINISTIC\n" +
            "BEGIN\n" +
            "RETURN 63;\n" +
            "END;"); 
```

我得到以下异常：

```
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: 
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 
'CREATE FUNCTION some() RETURNS double DETERMINISTIC
BEGIN
RETURN 63;
END' at line 1` 
```

有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T15:45:45.010

您可以使用 jdbc 来执行此操作，但在您的脚本上不要声明任何分隔符，然后将您自己的分隔符放在单独的函数或过程声明中，您的脚本将如下所示：

```
CREATE FUNCTION do_something() RETURNS double DETERMINISTIC
BEGIN
  RETURN 63;
END;;
CREATE FUNCTION do_other_thing() RETURNS double DETERMINISTIC
BEGIN
  RETURN 63;
END;; 
```

将您的 sql 脚本放入 StringBuilder 后，使用的代码将如下所示

```
 String[] sql = stringBuilder.toString().split(";;");
    for (int i = 0; i < sql.length; i++) {
                     statment.executeUpdate(sql[i]);
                } 
```

我希望这对您有帮助！

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-15T06:24:35.937

使用 Spring Framework 时，请使用 Hibernate Framework 连接数据。

# joomla - Joomla 组件 .inc 文件

> ID：11959537
> 
> 赞同：0
> 
> 时间：2012-08-14T19:36:47.650
> 
> 标签：joomla

我正在构建一个在某些情况下发送电子邮件的组件。我宁愿不在我的 php 代码中直接包含电子邮件 HTML，因此我想将 html 放入 .inc 文件中。我不确定最佳实践是否规定了此类文件的放置位置……也许是媒体文件夹？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T03:37:21.437

[该`/media/`目录](http://docs.joomla.org/Manifest_files#Media_files)的目的是它包含您需要对您的组件“网络可见”的所有资产。因此，如果您的组件显示图像、使用自定义 CSS、JS 文件等，那么它们就会去那里。

媒体目录的重点是在将来更新 Joomla！核心代码文件可以移动到非网络可见的位置，以提高整体安全性。

话虽如此，如果您的`.inc`文件中有可执行或敏感内容，那么我将`asset`在`/administrator/components/com_yourcomponenet/`.

# angularjs - AngularJS：在 e2e 测试中访问 $scope 对象

> ID：11959548
> 
> 赞同：1
> 
> 时间：2012-08-14T19:37:39.760
> 
> 标签：angularjs, angularjs-e2e

我正在构建一个数学辅导应用程序，并想使用 Angular 的 e2e 测试套件来测试我的 UI。

目前我正在制作一个分数页面，该页面生成一个随机分数，显示一系列阴影和非阴影框，并要求用户输入由阴影形成的分数。

使用*e2e 测试*，我想测试 UI 如何响应正确和不正确的输入；但是，由于分数在页面加载时是随机的，所以我不知道测试内部的“正确”输入是什么。

对我来说，获得正确输入答案的最简单方法是访问位于`$scope.problemObject`控制器的 Fraction 对象，并调用其 API 函数`.getNumerator()`和`.getDenominator()`. 但是，我还没有找到从我的测试中获取这个对象的方法。

我的控制器的相关行是：

```
$scope.problemObject = Fraction.random();
// This produces an object with two relevant 
// functions (getNumerator() & getDenominator()) 
```

**我试过的**

*   `binding()`

最初我认为`binding()`会做我需要的事情，但是所有对`binding('problemObject')`or`binding('problemObject.getNumerator()'`的调用都会发出一个错误，指出无法找到绑定。我怀疑这是因为`$scope.problemObject`它的返回值`$scope.problemObject.getNumerator()`没有直接绑定到 UI。

*   `angular.element().scope()`

`angular.element('#problem').scope().problemObject`从我正在测试的页面上的控制台执行完美；但是，在我的测试中尝试同一行会出现以下错误：“选择器未实现”。

我也尝试了一些变化：

`element('#problem').scope().problemObject`：错误：'对象＃没有方法'范围''

`angular.element(element('#problem')).scope().problemObject`：错误：'无法读取未定义的属性'problemObject''

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T03:13:09.690

我猜 e2e 测试中的 'element' 和 'angular.element' 是不同的对象。您可能想尝试从视图中读取值。

如果是输入字段。

```
var value = element('#problem').val(); 
```

否则，类似：

```
var value = element('#problem').text(); 
```

（在我看来，从 e2e 查看范围对象有点作弊。）

## 编辑

我完全误解了网页的问题和结构。对困惑感到抱歉。它必须验证的是输入字段与阴影和非阴影框的数量（在本例中为“td”元素）。

```
var total = element('td').count()
  , fraction = element('td.shaded').count(); 
```

想法是一样的，它试图从视图中获取数字，而不是从 $scope。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T05:43:37.457

原来问题在于存储在 jQuery 的`data`. 由于 jQuery 将数据作为`$.cache`全局存储在哈希表中，一旦我们在测试网页运行的框架之外，我们就无法再访问它们。我解决它的方法是通过访问 iframe 窗口内的 jQuery（方便地在`$window`参数中给出）。

以下是我想出的访问范围。你可以做`scope('#myElement', 'foo.bar')`查询`$scope.foo.bar`。

```
angular.scenario.dsl('scope', function() {
return function(selector, entry) {
    return this.addFutureAction('find scope variable for \'' + selector + '\'', 
        function($window, $document, done) {
            var $ = $window.$; // jQuery inside the iframe
            var elem = $(selector);
            if (!elem.length) {
                return done('No element matched \'' + selector + '\'.');
            }
            var entries = entry.split('.');
            var prop = elem.scope();
            for (var i in entries) {
                prop = prop[entries[i]];
            }
            done(null, prop);
        });
    };
}); 
```

# python - 从 contextmenu linedit-pyqt 更新 Qtablewidget

> ID：11959555
> 
> 赞同：0
> 
> 时间：2012-08-14T19:38:18.200
> 
> 标签：python, pyqt, qtablewidget

我有一个`QTableWidget`我想从`QLinEdit`嵌入到上下文菜单中更新的内容。现在，在`QLinEdit`输入服务器名称时，当按下键时，程序会扫描 MySQL 数据库以查看服务器名称是否在其中，如果是，则`QTableWidget`使用服务器名称表中的数据进行更新，如果不是找到了，报错`messageBox`。

我不能做的是连接上下文菜单`QLinEdit`来更新`QTableWidget`.

连接`QTableWidget`到上下文菜单：

```
self.table1.setContextMenuPolicy(QtCore.Qt.CustomContextMenu)
self.table1.customContextMenuRequested.connect(self.handleHeaderMenu) 
```

上下文菜单：

```
 def handleHeaderMenu(self, pos):
        self.custom_choice = QtGui.QLineEdit()
        self.menu = QtGui.QMenu()
        self.custom_choice.setPlaceholderText("Server")
        self.wac = QtGui.QWidgetAction(self.menu)
        self.wac.setDefaultWidget(self.custom_choice)
        self.menu.setStyleSheet("QMenu::item {background-color: #264F7D;color: white; font-weight:bold;}")
        self.menu.addAction("Choose Server to Monitor:")
        self.menu.addSeparator()
        self.actionJuliet = self.menu.addAction('Juliet')
        self.actionJulietleft = self.menu.addAction('JulietLeft')
        self.actionPong = self.menu.addAction('Pong')
        self.actionHulk = self.menu.addAction('Hulk')
        self.actionCustom = self.menu.addAction(self.wac)
        action = self.menu.exec_(QtGui.QCursor.pos())
        self.connect(self.custom_choice, QtCore.SIGNAL("returnPressed()"),self.refreshdata) 
```

数据获取器/扫描器：

```
def get_data(self):
    self.tx = self.custom_choice.text()
    self.model.execute("show TABLES;")
    table_array = []
    table_names = self.model.fetchall()
    for lines in table_names:
        lines = str(lines)
        lines = lines.strip("()""''"",")
        table_array.append(lines)
    if any("%s" % self.tx in s for s in table_array):
        table_name = self.tx
        self.model.execute("""SELECT computer_name 
                              FROM %s""" % (table_name))
        new_user_name = self.model.fetchall()
        print new_user_name,table_name
        self.model.execute("""SELECT idle_time 
                              FROM %s""" % (table_name))
        new_idle = self.model.fetchall()
        self.model.execute("""SELECT files_opened 
                              FROM %s""" % (table_name))
        new_files = self.model.fetchall()
        self.model.execute("""SELECT active_time 
                              FROM %s""" % (table_name))
        new_active = self.model.fetchall()
        self.model.execute("""SELECT session_type 
                           FROM %s""" % (table_name))
        new_session = self.model.fetchall()
        self.model.execute("""SELECT cpu 
                           FROM %s""" % (table_name))
        new_cpu_load = self.model.fetchall()
        self.model.execute("""SELECT avg_disk_queue 
                           FROM %s""" % (table_name))
        new_disk_queue_load = self.model.fetchall()
        new_data_user = [item0[0] for item0 in new_user_name]
        new_data_idle = [item1[0] for item1 in new_idle]
        new_data_files = [item2[0] for item2 in new_files]
        new_data_active = [item3[0] for item3 in new_active]
        new_data_session = [item4[0] for item4 in new_session]
        new_data_cpu_load = [item5[0] for item5 in new_cpu_load]
        new_data_disk_queue_load = [item6[0] for item6 in new_disk_queue_load]
        self.lista = new_data_user
        self.listb = new_data_disk_queue_load
        self.listc = new_data_cpu_load
        self.listd = new_data_active
        self.liste = new_data_files
        self.listf = new_data_session
        self.listg = new_data_idle  
        self.mystruct2 = {'A':self.lista, 'B':self.listb, 'C':self.listc,'E':self.liste,'D':self.listd,'F':self.listf,'G':self.listg} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:59:26.487

你的设计`handleHeaderMenu`有点不对劲。当前结构方式的主要问题之一是您在弹出菜单完成`QLineEdit` **后将信号连接到。**所以你会错过那个信号。

```
action = self.menu.exec_(QtGui.QCursor.pos())
self.connect(self.custom_choice, 
                QtCore.SIGNAL("returnPressed()"),
                self.refreshdata) 
```

`QMenu.exec_()`是阻塞调用。它启动菜单的事件循环并等待它完成。一旦它关闭并返回所选的 QAction，您就可以建立连接。在我的下一点之后，我将对此进行更正......

您每次从头开始构建的菜单不必保存到成员属性并在外部使用。有两种方法可以进行自定义弹出菜单。如果它主要是静态的，那么您可以在您的类 init 中构建它一次，或者使其成为自己的类，然后重用该实例。或者在你的情况下，你可以每次都建立它，这很好。但是，与其依赖对菜单组件的持久引用并使用信号，为什么不只是临时构建它并显式处理结果呢？

```
def handleHeaderMenu(self, pos):
    menu = QtGui.QMenu()
    menu.setStyleSheet("""
        QMenu::item {
            background-color: #264F7D;
            color: white; 
            font-weight:bold;}
    """)
    text = menu.addAction("Choose Server to Monitor:")
    text.setEnabled(False)
    menu.addSeparator()

    actionJuliet = menu.addAction('Juliet')
    actionJulietleft = menu.addAction('JulietLeft')
    actionPong = menu.addAction('Pong')
    actionHulk = menu.addAction('Hulk')

    wac = QtGui.QWidgetAction(menu)
    custom_choice = QtGui.QLineEdit()
    custom_choice.setPlaceholderText("Server")
    wac.setDefaultWidget(custom_choice)
    menu.addAction(wac)

    menu.setActiveAction(wac)
    custom_choice.returnPressed.connect(wac.trigger)

    action = menu.exec_(QtGui.QCursor.pos())
    if action:
        if action == wac:
            self.tx = str(custom_choice.text()).strip()
        else:
            self.tx = str(action.text())

        self.refreshdata()

def refreshdata(self):
    print self.tx 
```

在这里，我们只是为将收集垃圾的菜单创建了一堆临时小部件。显示菜单后，我们检查返回的操作，然后手动设置我们的表格属性，并调用刷新。此外，我们需要设置来自自定义的信号以在`QLineEdit`内部触发其小部件操作。

最后，每次你想加载这些数据时，真的有必要进行 8 次 sql 查询和一大堆数据重组吗？这可以高度简化：

```
def get_data(self):

    table_check = """
        SELECT table_name FROM information_schema.tables 
        WHERE table_schema = %s AND table_name = %s 
        """

    table_name = self.tx
    count = self.model.execute(table_check, (self.theDatabaseName, table_name))
    if not count:
        # warn the user that the table name does not exist
        warn_user_of_bad_table()
        return

    sql = """
        SELECT 
            computer_name, idle_time, files_opened, 
            active_time, session_type, cpu, avg_disk_queue
        FROM %s 
        """ % table_name

    count = self.model.execute(sql)
    if not count:
        warn_database_error()
        return

    results = self.model.fetchall()
    user, idle , files, active, session, cpu, disk = zip(*results)
    self.lista = user
    self.listb = disk
    self.listc = cpu
    self.listd = active
    self.liste = files
    self.listf = session
    self.listg = idle  
    self.mystruct2 = {
        'A' : self.lista, 
        'B' : self.listb, 
        'C' : self.listc,
        'E' : self.liste,
        'D' : self.listd,
        'F' : self.listf,
        'G' : self.listg
    } 
```

您在这里只需要两个查询。第一个非常简单的检查表是否存在，通过使用方案，而不是通过大的 SHOW TABLES 输出进行解析。第二个是在一个查询中获取所有数据（作为一堆行，然后用于`zip`将它们重新组合成列。

# java - 将动态原始类型 (int) 传递给方法

> ID：11959558
> 
> 赞同：-1
> 
> 时间：2012-08-14T19:38:28.037
> 
> 标签：java, primitive

在 Java 中， 的输出`s`为 0。我不明白为什么，是否有可能以某种方式获得 s 的正确值（此处为 1000）？

```
public static void main(String args) {
    int s = 0;
    List<Integer> list = getList(s);
    System.out.println("s = " + s);
}

public static List<Integer> getList(int s) {

    List<Integer> list = new ArrayList<Integer>();
    for (int i = 0; i < 1000; i++) {
        list.add(i); s++;
    }
} 
```

在 C# 中，如果我没记错的话，有一些描述符表明变量将会改变。

我不会得到`list.size()`一般的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:44:15.083

在Java 中，所有方法参数都是按值传递的，即复制。因此，调用者看不到副本的更改。

要解决您的第二个问题，您可以在调用方使用 list.size() 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T19:40:58.223

我看到了两种方式

1）将's'作为静态变量并将其移动到类级别

2) 使用 getter/setter 为 list 和 int 创建类，并返回对象以进行 getList 调用

```
public static MyWrapperObj getList(int s) {

   ......
return wrapperObj
}

class MyWrapperObj 
{
private List<Integer>;
private countS;
....
//getter/setters.
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-14T19:53:51.810

Java 不允许通过引用传递参数 - 但您可以将其包装在这样的对象中：

```
class IntHolder {
        private int s;
        IntHolder(int s){
            this.s = s;
        }

        public void setS(int s){
            this.s = s;
        }

        public int getS(){
            return s;
        }

        public void increment(){
            s++;
        }
}

class Test{

  public static void main(String[] args) {
    IntHolder s = new IntHolder(0);
    List<Integer> list = getList(s);
    System.out.println("s = " + s.getS());
  }

  public static List<Integer> getList(IntHolder s) {

    List<Integer> list = new ArrayList<Integer>();
    for (int i = 0; i < 1000; i++) {
        list.add(i); s.increment();
    }
    return list;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T19:43:26.283

在java中，传递给方法的参数是按值传递的。您需要创建一个全局变量或实例变量才能在其他方法中修改它。这就是java的工作方式。例如

```
public class Test{
     private int s;

     public Test(){
          s=0;
          increment();
          //print now will be 1000.
     }

     private void increment(){
          s = 1000;
     }
} 
```

# css - 如何使自定义 CSS 光标与视网膜兼容？

> ID：11959559
> 
> 赞同：7
> 
> 时间：2012-08-14T19:38:32.177
> 
> 标签：css, retina-display, mouse-cursor

我想知道如何在视网膜显示器上的 web 应用程序中使用自定义光标。我知道通常情况下，由于比例因子，图像将以正常大小的两倍显示，并且在使您的网站与视网膜显示器兼容时，您必须拍摄 2 倍比例的图像，并设置其浏览器内渲染宽度和高度为实际尺寸的一半。由于游标没有大小属性​​（据我所知），我如何确保以尽可能高的保真度呈现游标？

谢谢。

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2012-08-14T21:49:01.057

[我非常喜欢这里](http://www.webmonkey.com/2012/06/make-sure-your-site-looks-good-on-the-new-retina-macbook-pro/)提出的通用解决方案，尤其是作者记得针对所有可以在配备 Retina Display 的 Macbook Pro 上运行的浏览器这一事实。

```
@media only screen and (min--moz-device-pixel-ratio: 2),
only screen and (-o-min-device-pixel-ratio: 2/1),
only screen and (-webkit-min-device-pixel-ratio: 2),
only screen and (min-device-pixel-ratio: 2) {
    /*your hi-res cursor styling*/
} 
```

我很好奇在相同的硬件（使用 Bootcamp 或 Parallels 等）上运行时这是否能在 Windows 中正常工作

# php - 在 PHP 中读取带有希伯来语文本的 csv 文件

> ID：11959565
> 
> 赞同：1
> 
> 时间：2012-08-14T19:38:46.327
> 
> 标签：php, csv

我想导入我在 PHP 中创建并包含希伯来语文本的 CSV 文件。

这就是我创建文件的方式：

```
header("Content-Type: application/comma-separated-values; charset=UTF-16LE");
header("Content-Disposition: attachment; filename=\"$fileName\"");

res = "";
foreach($data as $row) {
     foreach($row as $coll) {
          $res .= $coll . "\t";
     }

     $res .= "\r\n";
}

// Convert $res from UTF8 to UTF-16LE and add special chars at the beginning
echo chr(255) . chr(254) . mb_convert_encoding($res, 'UTF-16LE', 'UTF-8'); 
```

该代码有效，我得到了一个正确显示希伯来字符的 CSV 文件。

当我尝试读取同一个文件时，希伯来语字符显示不佳（例如ÔÒàÔ âÜ ÔÒÕã 0）。这是我尝试过的代码：

```
$fp = fopen($file_full_path,'r') or die("can't open file");
print "<table>\n";
while($csv_line = fgetcsv($fp)) {
     print '<tr>';
     for ($i = 0, $j = count($csv_line); $i < $j; $i++) 
     {
         $val = $csv_line[$i];
         print '<td>'.$val.'</td>';
     }
     print "</tr>\n";
}

print '</table>\n';
fclose($fp) or die("can't close file"); 
```

这个解决方案应该适用于英语、希伯来语、法语、德语等字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T13:04:34.927

基本上你需要使用以下将字符串转换为 utf-8

```
iconv(mb_detect_encoding($data[$c], mb_detect_order(), true), "UTF-8", $data[$c]) 
```

这是读取 utf-8 csv 文件的完整功能

```
<?php
$row = 1;
if (($handle = fopen("mycsv.csv", "r")) !== FALSE) {
while (($data =  fgetcsv($handle, 1000, ",")) !== FALSE) {
    $num = count($data);
    $row++;
    for ($c=0; $c < $num; $c++) {
        echo iconv(mb_detect_encoding($data[$c], mb_detect_order(), true), "UTF-8", $data[$c]) . "<br />\n";
    }
}
fclose($handle);
}?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:47:10.900

您需要告诉浏览器期望什么字符集。将此行添加到显示数据的 PHP 脚本的顶部：

```
header("Content-Type: text/html; charset=UTF-16LE"); 
```

如果您希望文档通过 W3C 验证，您还需要在文档的`<meta>`标签中声明这一点`<head>`。

`fseek($fp, 2);`您可能还需要处理放置在第一行文件中的 BOM，如果您知道它会一直存在，我建议您在循环之前调用。

此外，您应该首先使用该[`fputcsv()`](http://php.net/manual/en/function.fputcsv.php)函数生成 CSV 文件。

# sql-server - 如何将所有 HTML 实体和 unicode 字符转换为英文等效项以在 SQL 中进行排序？

> ID：11959566
> 
> 赞同：1
> 
> 时间：2012-08-14T19:38:46.430
> 
> 标签：sql-server, sql-server-2005, replace, html-entities

我的数据库数据在数据中具有 unicode 和 html 实体格式的特殊字符。我需要按字母顺序对结果列表进行排序，但是，一些 unicode 数据和 html 实体会弄乱字母顺序（即： 出现在 A 之前，而代码可能是 A 之后的重音 E）。

目前，我只是使用嵌套的替换语句来生成一个“排序”列，因为我的印象是数据库中使用了一组有限的特殊字符。

客户希望安全起见，在排序之前将此页面[http://webdesign.about.com/library/bl_htmlcodes.htm](http://webdesign.about.com/library/bl_htmlcodes.htm)上的所有字符转换为英文等价物......

当前代码：

```
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(
Replace(@Word, 'À', 'A') 
             , 'Â', 'A')
             , 'Ä', 'A')
             , 'Ç', 'C')
             , 'É', 'E')
             , 'È', 'E')
             , 'È', 'E')
             , 'Ê', 'E')
             , 'Î', 'I')
             , 'ï', 'i')
             , '&#216;', 'O')
             , '&#336;', 'o')
             , '&#193;', 'A')
             , '&#209;', 'N')
             , '&#237;', 'I')
             , '&#211;', 'O')
             , '&#323;', 'N')
             , '&#268;', 'C')
             , '&#225;', 'A')
             , '&#337;', 'O')
             , 'ő', 'o')
             , 'ö', 'o') 
```

我意识到这段代码效率非常低 - 它开始时只有几个字符，然后随着时间的推移被添加。

在上面链接的页面上循环浏览所有组合的最佳方式是什么？

更好的是，有人可以确认 unicode 值是否按字母顺序正确排序，如果是，是否有预构建的 SQL Server 2005 函数仅将 HTML 实体（友好、数字和十六进制版本）转换为该列的 Unicode？

谢谢，

托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:36:12.857

您可以使用`CONVERT`and`COLLATE`来获得带有重音符号的结果：

```
SELECT
 CONVERT(varchar(50), N'æøåáäĺćçčéđńőöřůýţž')
 COLLATE Cyrillic_General_CI_AI

returns aoaaalcccednooruytz 
```

就 HTML 代码而言，我会考虑拆分为 CLR 存储过程（或“适当的”编程语言中的东西），以便您可以使用 .NET 库或类似的库。更好的是，我会在插入数据的程序中计算排序键，并完全避免在 sql-server 中进行这种字符串处理。

# iphone - 为什么这个方法不需要在 .h 文件中声明？

> ID：11959570
> 
> 赞同：2
> 
> 时间：2012-08-14T19:39:02.073
> 
> 标签：iphone, objective-c

为什么我允许访问`orientationChanged:`而不在`.h`文件中声明它？我在 Apple 的文档中找不到该方法，所以我认为它不是继承的方法。

```
#import <UIKit/UIKit.h>

@interface RotationAppDelegate : UIResponder <UIApplicationDelegate>

@property (strong, nonatomic) UIWindow *window;

@end 
```

* * *

```
#import "RotationAppDelegate.h"

@implementation RotationAppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    UIDevice *device = [UIDevice currentDevice];
    [device beginGeneratingDeviceOrientationNotifications];
    NSNotificationCenter *nc = [NSNotificationCenter defaultCenter];
    [nc addObserver:self selector:@selector(orientationChanged:) name:UIDeviceOrientationDidChangeNotification object:device];

    // Override point for customization after application launch.
    self.window.backgroundColor = [UIColor whiteColor];
    [self.window makeKeyAndVisible];
    return YES;
}

-(void)orientationChanged:(NSNotification *)note {
    NSLog(@"oriendtationChanged: %i", [[note object] orientation]);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:45:11.953

您传递给的方法`@selector(...)`不需要在头文件中声明。事实上，它们甚至不需要存在，只要没有人试图在运行时执行它们。一个字符串`orientationChanged:`就足以为`@selector(...)`您生成一个有效的选择器；只要相应的方法在运行时可用（即对象为它`respondsToSelector:`返回`YES`），系统就会正确地找到并执行它。

# php - JSONLint 和 PHP JSON_DECODE 的区别

> ID：11959571
> 
> 赞同：2
> 
> 时间：2012-08-14T19:39:14.430
> 
> 标签：php, json

在下面的代码中，$datastring 变量中的 JSON 作为 JSONLint 上的有效 JSON 传递。

但是，使用 PHP 的 json_encode 时出现语法错误。

我能做些什么来解决这个问题？我试过剥离斜线但得到同样的错误。

```
$datastring = '[{"Program": 3034370,"Column": "CLI_RID","Value": "1006278"},{"Program": 3034370,"Column": "Filename","Value": "\\\\henery\\1006278\\CONFIRMATION LETTER AVAILABLE.html"},{"Program": 3034370,"Column": "EVENT_CODE","Value": "20120725ZZAQ"},{"Program": 3034370,"Column": "DOC_NAME","Value": "Confirmation Email"},{"Program": 3034370,"Column": "PrintDate","Value": "20120410"},{"Program": 2959623,"Column": "ISSUE","Value": "Res Spring"},{"Program": 2959623,"Column": "FILENAME","Value": "~/Res/Mag.aspx?I=res_spring&P=1006278"}]';
$data = json_decode($datastring, true);

// Define the errors.
$json_errors = array(
    JSON_ERROR_NONE => 'No error has occurred',
    JSON_ERROR_DEPTH => 'The maximum stack depth has been exceeded',
    JSON_ERROR_CTRL_CHAR => 'Control character error, possibly incorrectly encoded',
    JSON_ERROR_SYNTAX => 'Syntax error',
);

if(!$data) {
echo 'Last error : '. $json_errors[json_last_error()]. PHP_EOL. PHP_EOL;
} else {
echo print_r($data, true);
} 
```

我将从 ASP.Net 页面获取此 JSON 字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:42:57.037

如果您在 php 文字常量中写出一个字符串，则必须将所有斜杠加倍。因此，当原始 JSON 类似于：

```
{"foo": "backslash: \\"} 
```

对应的 php 字符串文字为：

```
$json = '{"foo": "backslash: \\\\"}'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:42:13.230

你需要*更多*的反斜杠，而不是更少；由于您在字符串文字中使用它，因此 PHP 会自行剥离一层。

# javascript - 两个独立工作但不能一起工作的javascript函数？

> ID：11959574
> 
> 赞同：2
> 
> 时间：2012-08-14T19:39:21.927
> 
> 标签：javascript, html

背景

我正在尝试为可汗学院写一个练习。他们的代码都可以在这里找到：[https](https://github.com/Khan/khan-exercises) ://github.com/Khan/khan-exercises 。这是我第一次真正编程任何东西，我基本上只是通过查看示例代码来学习 html 和 js。

作为本练习的一部分，我需要绘制一个“随机函数”，并找到它的零点。我写了一个找零算法（将间隔重复减半以放大零。）。我知道牛顿方法的某些变体可能更快，但我想确保收敛。我的“随机函数”采用一组点值并用多项式样条插值这些点。这些中的每一个都独立工作：我可以绘制我的“随机函数”，并且可以使用我的寻零算法来逼近 2 的平方根（x^2 - 2 在区间 (1,2) 上的零）。当我试图找到我的“随机函数”的零点时，我遇到了麻烦：我的浏览器进入了无限循环或其他东西。我什至看不到开发人员工具中的错误。

所以我的问题基本上是：

1.  我犯了什么错误，在这里消耗了如此多的计算能力？
2.  这些功能如何独立工作而不是一起工作？
3.  如何修复我的代码？

由于我在整个 knhan academy 框架内工作，我的程序中有太多内容无法发布所有相关代码（它使用 Raphael 来处理图像，预先编写代码以使练习都具有相同的风格等）。我可以给你我写的 html 代码和我写的函数的 .js 文件。

```
<!DOCTYPE html>
<html data-require="math graphie graphie-helpers steveMath8">
  <head>
      <title>Piecewise-defined function</title>
      <script src="../khan-exercise.js"></script>
  </head>
  <body>
      <div class="exercise">
          <div class="vars">

  <var id = "n">randRange(2,4)</var>
  <var id = "abscissas">makeXList()</var>
  <var id = "ordinates">makeYList(-8,8,abscissas.length)</var>
  <var id = "points">makeCoordinates(abscissas,ordinates)</var>
 <var id = "f">(function(x){return niceFunction(x,points)})</var>
 <!-- <var id = "f">(function(x){return x*x-n})</var>-->
 <var id = zeros>locateZeros(f,abscissas)</var>

          </div>

          <div class="problems">
              <div id="problem-type-or-description">
                  <p class="problem">You are going to have to answer 5</p>
                  <p class="question">Answer 5</p>
                  <div class="graphie" id="grid">
                graphInit({
                    range: 10,
                    scale: 20,
                    tickStep: 1,
                    axisArrows: "<->"
                });

            a =style({
                        stroke: "red",
                         strokeWidth: 2
                    }, function() {
                        plot( function( x ) { return niceFunction(x,points);
                        }, [ -10, 10 ] );
                    });;
            a.plot();
            </div>

                  <p class="solution">5</p>
              </div>

          </div>

          <div class="hints">
              <!-- Any hints to show to the student. -->
          </div>
      </div>
  </body> 
```

```
$.extend(KhanUtil, {

//takes num and returns +1 if num>0 or -1 if num<0
steveSign: function(num){
    return num && num/Math.abs(num)
},

// Approximates a root of f on the interval (xmin,xmax) by successively halving the   interval.
steveRoot: function(f,xmin,xmax){
    var l = xmin
    var r = xmax
    var z = 0
    for (i=0;i<10;i++){
        z = (l + r)/2
        if (KhanUtil.steveSign(f(l)) == KhanUtil.steveSign(f(z))){ l = z}
        else{r = z}   

    }
    return z
},

//takes a function and a list of abscissas, and returns an array of zeros - one zero between each pair of abscissas that are of
//opposite sign
locateZeros: function(f,abscissas){
    var len = abscissas.length
    var list = []
    var z = 0

    for(i=0;i<len-1;i++){
       var x0 = abscissas[i]
       var x1 = abscissas[i+1]
       var y0 = f(x0)
       var y1 = f(y0)

       if (KhanUtil.steveSign(y0) !== KhanUtil.steveSign(y1)){
           z = KhanUtil.steveRoot(f,x0,x1)
           list.push(KhanUtil.steveSign(f(x0)))
       }

    }
    return list
},

    steveCubic: function(x){return -Math.pow(x,3)/2+3*x/2},

//niceFunction is a C^1 function which connects the points in "points".  It is designed to be used 
//in my "curveSketchingIntuition" exercise.  Every point in the "points" will have 0 slope, except the first and last point.
niceFunction: function(x,points){

    len = points.length

    var x1 = points[0][0]
    var x2 = points[1][0]
    var y1 = points[0][1]
    var y2 = points[1][1]
    var k = (y1 - y2)/Math.pow(x1-x2,2)

    if (x<x2){return k*Math.pow(x-x2,2)+y2}

    for (i=1;i<len-2;i++){
        var x1 = points[i][0]
        var x2 = points[i+1][0]
        var y1 = points[i][1]
        var y2 = points[i+1][1]

        xNew = (x-x1)*2/(x2-x1)-1
        yNew = (KhanUtil.steveCubic(xNew)+1)*(y2-y1)/2+y1
        if (x>=x1 && x<x2){return yNew}

        }

    var x1 = points[len-2][0]
    var x2 = points[len-1][0]
    var y1 = points[len-2][1]
    var y2 = points[len-1][1]
    var k = (y2 - y1)/Math.pow(x1-x2,2)
    if (x>=x1){return k*Math.pow(x-x1,2)+y1}

},

makeXList: function(){
array = [-10]
i=0
while(array[i]<10){
    x = array[i]+3*KhanUtil.randRange(1,3)
    if (x<10){array.push(x)}
    i=i+1
    }
array.push(10)
return array

},

makeYList:function(min,max,n){
    excluded = [0]
    array = [KhanUtil.randRangeExclude(min,max,excluded)]
    excluded.push(array[0])
    array.push[KhanUtil.randRangeExclude(min,max,excluded)]
    excluded = [0]
    for (i=1;i<n;i++){
        if (array[i-2]<array[i-1]){
            array.push(KhanUtil.randRangeExclude(min,array[i-1]-1,excluded))
            }
        else{array.push(KhanUtil.randRangeExclude(array[i-1]+1,max,excluded))}
        }

    return array

},

    makeCoordinates:  function(array1,array2){
    array = []
    for (i=0;i<array1.length;i++){
        array.push([array1[i],array2[i]])
    }
    return array
},
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:58:38.967

我认为这与您的 while 循环有关：

```
makeXList: function(){
array = [-10]
i=0
while(array[i]<10){
    x = array[i]+3*KhanUtil.randRange(1,3)
    if (x<10){array.push(x)}
    i=i+1
    }
array.push(10)
return array

}, 
```

请注意，您总是在递增`i`，但并不总是将新值推送到数组中。如果`x`大于 10，你会增加`i`，但那里不会有元素，这可能是导致你无限循环的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:39:48.473

我修复了我的代码。问题似乎是在这两个函数中我都有一个看起来像这样的 for 循环

```
for(i=0;i=10;i++) 
```

我把它改成了

```
for(var i=0;i=10;i++) 
```

显然我的程序将 i 视为全局变量，因此我的两个交互函数都在递增相同的 i。这有意义吗？在编程语言中似乎是一个非常糟糕的功能。我在这里错过了什么吗？

# java - java.security.cert.CertificateParsingException

> ID：11959576
> 
> 赞同：2
> 
> 时间：2012-08-14T19:39:24.287
> 
> 标签：java, security, certificate, x509certificate, x509certificate2

尝试创建新证书时出现以下异常：

java.security.cert.CertificateParsingException：签名溢出，字节 = 224

```
 try
    {
        InputStream certificateStream = new ByteArrayInputStream(certificate);
        CertificateFactory cf = CertificateFactory.getInstance("X.509");
        Collection certificateCollection = cf.generateCertificates(certificateStream);
    }
    catch (CertificateException ex)
    {

    } 
```

抛出异常： Collection certificateCollection = cf.generateCertificates(certificateStream);

有人可以帮我理解和解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:55:32.080

这是一个[基于您的代码的运行良好的示例](https://bitbucket.org/jrx/jrxpublic/downloads/11959576.zip)。它使用一个`FileInputStream`. 如果您使用 ByteArray，请注意其中的数据：

```
import java.io.FileInputStream;
import java.io.InputStream;
import java.util.Collection;
import java.security.cert.CertificateFactory;
import java.security.cert.X509Certificate;
import java.security.cert.CertificateException;
import java.io.FileNotFoundException;

public class StackOverflow {

    public static void main(String[] args) throws FileNotFoundException, CertificateException {
        InputStream certificateStream = new FileInputStream("stackoverflow.cert");
        CertificateFactory cf = CertificateFactory.getInstance("X.509");
        Collection certificateCollection = cf.generateCertificates(certificateStream);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T22:50:55.940

好吧，我的错。

我从文件中读取证书，并没有将其读取为二进制文件......

读取为二进制解决了这个问题。

非常感谢您的所有回答/评论！

# coldfusion - Coldfusion 10：在组件中找不到方法

> ID：11959579
> 
> 赞同：3
> 
> 时间：2012-08-14T19:39:40.217
> 
> 标签：coldfusion, components, coldfusion-10

自从我们安装 ColdFusion 10 以来，我们收到了几条错误消息，例如

> “`ifspDueDt`在组件中找不到方法`[fullpath]\incTabCnt.cfc`。”

我们正在尝试调用一个名为`ifspDueDt`. 它在我们整个应用程序的一个地方被调用，当它被调用时，它是从`ifsp.cfc`. 我们使用`engine.js`我们的 AJAX，所以调用看起来像这样：

`http('POST','../Components/ifsp.cfc?method=ifspDueDt', IFSPDueDtResp, param);`

出于某种原因并且仅在某些情况下（当然不是一直），ColdFusion 正在寻找`ifspDueDt`in`incTabCnt.cfc`而不是`ifsp.cfc`. 没有其他地方调用此方法。这可能是什么原因造成的？

我们每周可能会遇到 1-2 个此类错误，而我们有数百名用户访问系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:42:26.137

看起来 ColdFusion 10 update 3 解决了这个问题，至少对于我正在处理的代码。话虽如此，我**还不**建议升级，因为更新 3 存在一系列其他问题。请参阅[宣布更新 3 的 CF 博客文章](http://blogs.coldfusion.com/post.cfm/coldfusion-10-update-3-released)中的评论。请注意，至少有另外两个人在该评论线程中发布他们仍然遇到“显示错误的页面”问题，这似乎与我们在此问题中讨论的“错误组件”问题密切相关。

幸运的是，我们没有使用 CF 计划任务，并且在我们的测试环境中没有遇到任何启动错误或其他问题，尽管我的一位队友确实遇到了一些破坏了他的开发环境的问题。

我真的希望 Adob​​e 在更新 4（或更新 3 的替代品）中迅速行动。

# asp.net - Jquery ajax回发没有命中服务器方法？

> ID：11959582
> 
> 赞同：2
> 
> 时间：2012-08-14T19:39:49.827
> 
> 标签：asp.net, jquery

这是带有 ajax 帖子的 aspx 页面上的一些代码：

```
<div>
    Make Comment: <br />
    <textarea rows="7" cols="20" id="comment_content"></textarea><br />
    <input type="button" id="Make_Comment" value="Make Comment" />
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $("#Make_Comment").click(function () {
            $.ajax({
                type: "POST",
                url: "Conversation.aspx/AddComment",
                data: '{ comment: This is a test comment via ajax postback }',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function () {
                    alert("Got Back to code");
                }
            });
        });
    });
</script> 
```

这是我试图在服务器端使用的方法：

```
 [WebMethod]
    public static void AddComment(string data)
    {

    } 
```

我已经通过服务器端方法放置了一个断点，但它没有击中它，可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:58:12.027

几件事：

你的 `data` 电话`ajax`

```
 data: '{ comment: This is a test comment via ajax postback }' 
```

应该

```
 data: "{'comment':'This is a test comment via ajax postback'}", 
```

你的`WebMethod`：

```
 AddComment(string data) 
```

应该

```
 AddComment(string comment) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:58:05.043

尝试这个：

```
<script type="text/javascript">
$(document).ready(function () {
    $("#Make_Comment").click(function () {
        var comment = $("#comment_content").val();
        var Params = { comment : comment };
        $.ajax({
            type: "POST",
            url: "Conversation.aspx/AddComment",
            data: Params,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function () {
                alert("Got Back to code");
            }
        });
    });
});
</script> 
```

在您的控制器中设置 httppost。

```
[WebMethod]
[HttpPost]
public static void AddComment(string comment)
{

} 
```

# google-api - 如何在 Google Docs 中获取文档的文件扩展名和大小？

> ID：11959584
> 
> 赞同：0
> 
> 时间：2012-08-14T19:39:57.367
> 
> 标签：google-api, google-docs, google-docs-api, google-drive-api

目前，我正在实现 .NET Google API 以在我的 ASP.NET Web 应用程序中显示 Google Docs，并且我想获取 Google Document 的扩展名和大小，我有一种方法可以通过从“。”的最后一个索引 但在电子表格的情况下，它是可能的，因为它只包含电子表格文档的名称。

请在这里提出您的建议！！

另外，最好能提供C#的源码！！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:59:49.017

您可以使用 Google Drive API 检索存储在 Google Drive 上的文档并检查其元数据，包括`fileExtension`和`fileSize`许多其他：

[https://developers.google.com/drive/v2/reference/files](https://developers.google.com/drive/v2/reference/files)

所有方法都有 .NET 示例，还有一个完整的 ASP.NET MVC 应用程序可供您开始使用：

[https://developers.google.com/drive/examples/dotnet](https://developers.google.com/drive/examples/dotnet)

# android - 在 Android calendarView 小部件上显示谷歌日历？

> ID：11959592
> 
> 赞同：5
> 
> 时间：2012-08-14T19:40:13.020
> 
> 标签：android, google-calendar-api, calendarview

我的问题很简单，有没有办法在应用程序中使用 Android calendarView 显示 Google 日历？我找不到这样做的方法

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-05T07:31:00.020

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android=http://schemas.android.com/apk/res/android
 android:layout_width="fill_parent"
 android:layout_height="fill_parent"
 android:orientation="vertical" >
<TextView
android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:text="Introducing ICS Calendar"
android:gravity="center"
 android:padding="10dip"/>
<TextView
android:id="@+id/data"
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:gravity="center"
 android:padding="10dip"/>
<LinearLayout
android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:orientation="horizontal"
 android:gravity="center" >
<Button
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:id="@+id/previous"
 android:text="Prev"
 android:padding="10dip"/>
<Button
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:id="@+id/next"
 android:text="Next"
 android:padding="10dip"/>
</LinearLayout>
</LinearLayout> 
```

主.java

```
import java.text.Format;
import android.app.Activity;
import android.database.Cursor;
import android.os.Bundle;
import android.provider.CalendarContract;
import android.text.format.DateFormat;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class Main extends Activity implements OnClickListener{

private Cursor mCursor = null;
private static final String[] COLS = new String[]
{ CalendarContract.Events.TITLE, CalendarContract.Events.DTSTART};
} 
```

现在我们需要重写 on create 方法。特别注意我们如何填充数据库游标。这就是我们需要之前定义的 COLS 常量的地方。您还会注意到，在初始化数据库光标并设置单击处理程序回调之后，我们继续手动调用单击处理程序。这个快捷方式允许我们在不重复代码的情况下初步填写我们的 UI。

主.java

```
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.main);
mCursor = getContentResolver().query(
CalendarContract.Events.CONTENT_URI, COLS, null, null, null);
mCursor.moveToFirst();
Button b = (Button)findViewById(R.id.next);
b.setOnClickListener(this);
b = (Button)findViewById(R.id.previous);
b.setOnClickListener(this);
onClick(findViewById(R.id.previous));
} 
```

在我们的回调中，我们将光标操作到数据库中的正确条目并更新 UI。

```
@Override
public void onClick(View v) {
TextView tv = (TextView)findViewById(R.id.data);
String title = "N/A";
Long start = 0L;
switch(v.getId()) {
case R.id.next:
if(!mCursor.isLast()) mCursor.moveToNext();
break;
case R.id.previous:
if(!mCursor.isFirst()) mCursor.moveToPrevious();
break;
}
Format df = DateFormat.getDateFormat(this);
Format tf = DateFormat.getTimeFormat(this);
try {
title = mCursor.getString(0);
start = mCursor.getLong(1);
} catch (Exception e) {
//ignore
}
tv.setText(title+" on "+df.format(start)+" at "+tf.format(start));
} 
```

允许 ：

```
<uses-permission android:name="android.permission.READ_CALENDAR"/> 
```

# jquery - Jsfiddle 错误，jsfiddle 代码在其他地方不起作用

> ID：11959595
> 
> 赞同：0
> 
> 时间：2012-08-14T19:40:41.813
> 
> 标签：jquery, jsfiddle

大家好，我在 jsfiddle 上有这个完全工作的代码：http: [//jsfiddle.net/Scanu/DhpXN/](http://jsfiddle.net/Scanu/DhpXN/) 但它在其他地方不起作用，我认为由于当我单击 Jslist 时它列出的错误，我该如何修复它们？！在此先感谢，对不起我的英语我是意大利人:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:32:00.170

这个脚本只是在页面加载后在 JSFiddle 中执行。
它不会在其他地方工作，除非你把它放在你的`</body>`-**结束**标签之前或者你使用这个脚本：http: [//jsfiddle.net/DhpXN/3/](http://jsfiddle.net/DhpXN/3/)

# php - 如何创建一个可以将最后一个单词转换为大写的函数？

> ID：11959596
> 
> 赞同：2
> 
> 时间：2012-08-14T19:40:43.070
> 
> 标签：php, string, function, uppercase

我如何在 php 中创建一个函数 replaceMe()，它会变成：

```
$str = 'This is a very long string'; 
```

进入：

```
'This is a very long STRING?' 
```

有人能帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:43:45.173

您显然想要进行正则表达式替换，锚定在行尾。使用[`preg_replace`](http://www.php.net/manual/en/function.preg-replace.php)：

```
$str = 'This is a very long string';

# This is a very long LINE
echo preg_replace("/string$/", "LINE", $str); 
```

对于一般情况，您可以提供回调而不是替换字符串，并简单地将匹配的子字符串大写[`preg_replace_callback`](http://www.php.net/manual/en/function.preg-replace-callback.php)：

```
$str = 'This is a very long blah';

function word_to_upper($match) {
  return strtoupper($match[1]);
}

# This is a very long BLAH
echo preg_replace_callback("/(\w+)$/", "word_to_upper", $str); 
```

如果您使用的是 PHP 5.4 或更高版本，则可以将回调作为匿名函数提供：

```
echo preg_replace_callback("/(\w+)$/", function ($match) {
  return strtoupper($match[1])
}, $str); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T19:46:35.203

这有效：

```
$str = 'This is a very long string';

echo $str."<br/>";

function replaceMe($str = "")
{
    $words = explode(" ",$str);
    $totalwords = count($words)-1;
    $lastword = $words[$totalwords];
    $words[$totalwords] = strtoupper($lastword);
    $str = implode(" ",$words);
    return $str;
}

echo replaceMe($str);
?> 
```

输出：

这是一个很长的字符串
这是一个很长的字符串

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-14T20:45:30.700

```
$str = 'This is a very long string.';

function lastWordUpper($str){
$temp = strrev($str);
$last = explode(" ", $temp, 2);
return strrev(strtoupper($last[0]). ' ' .$last[1]) ;
}

echo lastWordUpper($str); 
```

# javascript - 我的 javascript 适用于除 IE8 以外的所有浏览器

> ID：11959599
> 
> 赞同：1
> 
> 时间：2012-08-14T19:40:49.193
> 
> 标签：javascript, html, json, internet-explorer-8

对于每个浏览器，我指的是 Safari、Firefox、Chrome 和 IE9。

这是我在 IE8 控制台中遇到的错误：

`'data.cities[...].country' is null or not an object`

第 374 行，位于 ( `var country = k.data.cities[i].country;`) 下方：

```
downloadUrl(url, function(data) {
    var k = eval("(" + data.responseText + ")"); 
    var klength = k.data.cities.length;
    var countries = [];

    for(i=0; i < klength; i++) {
        var country = k.data.cities[i].country;
        countries.push(country);
    }

    countries = $.unique(countries);

    var countryLength = countries.length;

    for(i=0; i < countryLength; i++) {
        $('.ribbon').append('<a href="#" class="country '+ countries[i] +'">' + countries[i] + '</a>');
    }
}); 
```

为什么 IE8 是唯一有此行问题的浏览器？我知道输入的数据不是空的，因为相同的数据用于在地图上放置对象并且它们显示得很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:44:44.633

我怀疑 eval() 函数没有返回您所期望的。

您可能想尝试改用 JSON.parse。

[您可以在那里](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)为不支持 JSON 的浏览器找到解析器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:49:45.660

问题很可能是`data.responseText`某处可能有一个尾随逗号。

```
[
    "A", "B", "C",
] 
```

这不适用于 Internet Explorer，也不是有效的 JSON。所有其他浏览器都处理尾随逗号。

修复：更改您的 AJAX 端点以省略所有尾随逗号。

更好的解决方法：使用`JSON.parse`which 将轰炸无效的 JSON，以便所有浏览器在失败时表现相同。

# jquery - 隐藏时将单词附加到 ID 属性，并在切换显示时将其删除

> ID：11959610
> 
> 赞同：1
> 
> 时间：2012-08-14T19:41:24.963
> 
> 标签：jquery

1.  我有两个第一次访问时需要隐藏的输入字段。
2.  将有一个按钮来切换它以显示字段，以便可以对其进行编辑。
3.  带有 id 的附加词（即 _temp）只是为了更改 id 名称，以便在不需要时不会再次保存。当字段显示附加词 (_temp) 时，需要删除。（即（**原始 ID 名称**：payment_gateway_login）（**附加 ID 名称**：payment_gateway_login_temp），当字段显示删除附加 ID 名称时，应返回原始名称：payment_gateway_login，同样应遵循 id="payment_gateway_password"。
4.  以下是我所能得到的。任何帮助将不胜感激。

HTML：

```
<ul>
  <li class="show-hide-container hide" style="display: list-item; ">
    <ol>
      <li class="password input required stringish" id="payment_gateway_login_input">
        <input id="payment_gateway_login" name="payment_gateway[login]" type="password">
     </li>
     <li class="password input required stringish" id="payment_gateway_password_input">
       <input id="payment_gateway_password" name="payment_gateway[password]" type="password">
     </li>
   </ol>
 </li>

 <li class="clearfix edit-login-pass"> <a href="#" class="btn" id="show_hide">Edit Login &amp; Password</a>
 </li>
</ul> 
```

​</p>

查询：

```
$("input#payment_gateway_login").attr("id", "payment_gateway_login" + "_temp");
$("input#payment_gateway_password").attr("id", "payment_gateway_password" + "_temp");

$("#show_hide").live("click", function(event) {
  return $("li.show-hide-container").toggle("show");
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:20:13.197

你在寻找这样的东西吗？

```
$('#show_hide').on('click', function(event) {
   if ($('#show-hide-container').is(':visible')) {
      // container is currently visible so hide it and set id to temp
      $('#show-hide-container').hide();
      $('#payment_gateway_login').attr('id', 'payment_gateway_login_temp');
      $('#payment_gateway_password').attr('id', 'payment_gateway_password_temp');
   } else {
      // container is currently hidden so show it and remove temp id
      $('#show-hide-container').show();
      $('#payment_gateway_login_temp').attr('id', 'payment_gateway_login');
      $('#payment_gateway_password_temp').attr('id', 'payment_gateway_password');
   }
}); 
```

需要注意的几点： .live() 已被弃用，因此您可能想要使用 .on() 代替。除非您将 html 中的原始 id 更改为包含 _temp，否则这也不起作用。

我不建议一开始就使用这种方法，更改 html id 很容易导致问题。一个更简单的解决方案是在您要保存信息时运行可见检查：

```
if ($('#show-hide-container').is(':visible')) {
    // Save!
} 
```

希望有帮助！

# android - ListView 中的图库小部件

> ID：11959614
> 
> 赞同：1
> 
> 时间：2012-08-14T19:41:43.200
> 
> 标签：android, listview, android-gallery, google-tv

我想实现一个列表视图，其中每行包含一系列缩略图。我尝试了一个带有嵌入式画廊小部件的列表视图。它不起作用，没有显示任何内容。只是想知道我是否走在正确的道路上，还是应该为此布局使用不同的小部件。

第 1 行：图像 1 图像 2 图像 3 行 2：图像 1 图像 2 图像 3 等。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:43:53.670

我能够通过创建一个包含线性布局的滚动视图来解决这个问题。在我的代码中，我以编程方式添加了 Horizo​​ntalScrollView 对象，可在此处找到：[https](https://github.com/vieux/Android-Horizontal-ListView) ://github.com/vieux/Android-Horizo​​ntal-ListView 。谢谢

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/my_layout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:focusable="true"
    android:descendantFocusability="afterDescendants"
    android:layout_marginTop="?android:attr/actionBarSize"
    android:fillViewport="true"> 

    <LinearLayout 
        android:id="@+id/listLayout"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">    
    </LinearLayout>

</ScrollView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T21:14:23.213

您可以尝试将水平滚动视图放在列表视图中。

# c++ - 在 TIFF 中创建带有缩略图的子 IFD (libtiff)

> ID：11959617
> 
> 赞同：9
> 
> 时间：2012-08-14T19:41:58.693
> 
> 标签：c++, thumbnails, tiff, libtiff

我知道 thumbnail.c 包含一些创建缩略图并将其放置在子 IDF 中的代码，但是该代码中发生了很多事情（生成缩略图、应用对比度曲线等），而且我很难复制写缩略图。谷歌也没有任何帮助。

我的问题是，在我打开一个输出文件并拥有一个 TIFF* 之后，我的缩略图数据已经准备就绪（以及我的主图像数据），我如何以缩略图的方式添加它们主图像 IFD 的子 IFD？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-17T00:44:31.900

因此，在浏览了 libtiff 源代码一段时间后，我在 tif_dirwrite.c 中偶然发现了这个：

```
 /*
 * Copyright (c) 1988-1997 Sam Leffler
 * Copyright (c) 1991-1997 Silicon Graphics, Inc.
 *
 * Permission to use, copy, modify, distribute, and sell this software and
 * its documentation for any purpose is hereby granted without fee, provided
 * that (i) the above copyright notices and this permission notice appear in
 * all copies of the software and related documentation, and (ii) the names of
 * Sam Leffler and Silicon Graphics may not be used in any advertising or
 * publicity relating to the software without the specific, prior written
 * permission of Sam Leffler and Silicon Graphics.
 */

...
if (!n)
    return(0);
/*
 * Total hack: if this directory includes a SubIFD
 * tag then force the next <n> directories to be
 * written as ``sub directories'' of this one.  This
 * is used to write things like thumbnails and
 * image masks that one wants to keep out of the
 * normal directory linkage access mechanism.
 */
tif->tif_flags|=TIFF_INSUBIFD;
tif->tif_nsubifd=tif->tif_dir.td_nsubifd;
if (tif->tif_dir.td_nsubifd==1)
    tif->tif_subifdoff=0;
else
    tif->tif_subifdoff=m;
return(1);
... 
```

（我包括了版权信息，因为我不确定在此处从库中发布代码时是否必须这样做）

所以，回答我自己的问题（如何在主图像 IFD 的子 IFD 中编写缩略图）：

```
//...
//For the sake of this demo we will assume that I have opened a 
//TIFF (TIFF* created_TIFF) in write mode and have included the correct header
//files

//set all of your TIFF fields for the main image
//...

//Define the number of sub-IFDs you are going to write
//(assuming here that we are only writing one thumbnail for the image):
int number_of_sub_IFDs = 1;
toff_t sub_IFDs_offsets[1] = { 0UL };

//set the TIFFTAG_SUBIFD field:
if(!TIFFSetField(created_TIFF, TIFFTAG_SUBIFD, number_of_sub_IFDs, 
    sub_IFDs_offsets))
{
    //there was an error setting the field
}

//Write your main image raster data to the TIFF (using whatever means you need,
//such as TIFFWriteRawStrip, TIFFWriteEncodedStrip, TIFFWriteEncodedTile, etc.)
//...

//Write your main IFD like so:
TIFFWriteDirectory(created_TIFF);

//Now here is the trick: like the comment in the libtiff source states, the 
//next n directories written will be sub-IFDs of the main IFD (where n is 
//number_of_sub_IFDs specified when you set the TIFFTAG_SUBIFD field)

//Set up your sub-IFD
if(!TIFFSetField(created_TIFF, TIFFTAG_SUBFILETYPE, FILETYPE_REDUCEDIMAGE))
{
    //there was an error setting the field
}

//set the rest of the required tags here, as well as any extras you would like
//(remember, these refer to the thumbnail, not the main image)
//...

//Write this sub-IFD:
TIFFWriteDirectory(created_TIFF);

//Assuming you are only writing one sub-IFD and are done with the file, you 
//can close it now. If you specified more than one sub-IFD, you need repeat 
//the above code (starting where we set TIFFTAG_SUBFILETYPE) for each of your
//sub-IFDs
TIFFClose(created_TIFF); 
```

我希望这对某人有所帮助，并且他们不必像我那样花费太多精力来弄清楚如何做到这一点。令人遗憾的是，libtiff 的文档记录如此之少，尤其是考虑到它的使用范围如此之广。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-04T11:15:48.360

我认为@KSletmoe 指出了一个关键点，即在编写任何 subIFD 之前应在 IFD0 中添加 SubIFD 标签（330），但仍然存在问题。

SubIFD 标签的定义是“偏移到子 IFD”。因此，如果您没有正确设置偏移量，tiff 解析器将无法正确解析整个 tiff。

有两种方法可以处理这种情况。

首先，预先计算每个 IFD/SubIFD 的大小，然后在设置时填写 SubIFD 标签，而不是设置 0x0。

或者您可以正常编写每个 IFD，然后返回 IFD0 并添加带有由 libtiff 计算的最终偏移量的 SubIFD 标记。如下：

```
//Write down every thing you need in a tiff
// ... IFD0
TIFFWriteDirectory(tif);
// ... IFD1
TIFFWriteDirectory(tif);
// ... IFD2
TIFFWriteDirectory(tif);

//set current Dir as IFD0 in the end
TIFFSetDirectory(tif, 0);  

//get next dir offset
sub_offset[1] = TIFFGetNextDirOff(tif, 2);
sub_offset[0] = TIFFGetNextDirOff(tif, 1);
//only for clean next dir offset in IFD0
no_use_offset = TIFFGetNextDirOff(tif, 0);                                                    

TIFFSetField(tif, TIFFTAG_SUBIFD, 2, sub_offset); 
```

您可能需要在 tif_dir.c 中添加流动功能

```
uint64 TIFFGetNextDirOff(TIFF* tif, uint16 dirn)                                                 
{                                                                                                
    uint64 nextdir;                                                                              
    uint16 n;                                                                                    
    if (!(tif->tif_flags&TIFF_BIGTIFF))                                                          
        nextdir = tif->tif_header.classic.tiff_diroff;                                           
    else                                                                                         
        nextdir = tif->tif_header.big.tiff_diroff;                                               
    for (n = dirn; n > 0 && nextdir != 0; n--)                                                   
        if (!TIFFAdvanceDirectory(tif, &nextdir, NULL))                                          
            return (0);

    /*!!Watchout!! Here will reset the next dir offset to 0*/
    tif->tif_nextdiroff = 0;                                                                                                                                     
    return nextdir;                                                                              
} 
```

感谢@KSletmoe。希望这可以帮助某人，并期待一些更优雅的方式来做到这一点。

# php - 从子查询结果中获取 MAX(value)

> ID：11959618
> 
> 赞同：0
> 
> 时间：2012-08-14T19:42:02.500
> 
> 标签：php, mysql

我有一个查询，它连接 3 个表并返回按页码排序的结果，因此我一次只能查看一页，并通过数组查看其输出。

这是我的查询

```
select wo.*,
   (select count(distinct order)
    from (SELECT *
          FROM `movements` LEFT JOIN
               `classes`
               ON `movements`.`class_id` = `classes`.`class_id` LEFT JOIN
               `clients`
               ON `movements`.`class_id` = `clients`.`class_id`
          WHERE `classes`.`class_id` = '$class_id' 
         ) wo2
    where wo2.order <= wo.order
   ) as pagenum
from (SELECT *
  FROM `movements` LEFT JOIN
       `classes`
        ON `movements`.`class_id` = `classes`.`class_id` LEFT JOIN
        `clients`
       ON `movements`.`class_id` = `clients`.`class_id`
   WHERE `classes`.`class_id` = '$class_id' 
  ) wo
order by pagenum 
```

现在我希望能够获得 MAX(pagenum)，这样我就可以在查询结束时告诉 PHP。有没有办法做这样的事情（我试过但不断收到 sql 语法错误）

```
SELECT MAX(`pagenum`) as `lastpage` 
```

还是有更好的方法来实现这一点？

以下是此查询结果的屏幕截图。我目前有“下一个”和“上一个”链接，当我到达查询末尾（这些结果中的第 5 页）时，它们会将用户从一个页面带到另一个页面。我希望 PHP 不再提供转到下一页的选项。所以我必须以某种方式获取每个查询的 MAX(pagenum) 的值。

[http://custommovement.com/help/woquery.png](http://custommovement.com/help/woquery.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:20:54.800

您可以通过包含另一个相关子查询来获取 maxpage num：

```
select wo.*,
       (select count(distinct order)
        from (SELECT *
              FROM `movements` LEFT JOIN
                   `classes`
                   ON `movements`.`class_id` = `classes`.`class_id` LEFT JOIN
                   `clients`
                   ON `movements`.`class_id` = `clients`.`class_id`
                   WHERE `classes`.`class_id` = '$class_id'
             ) wo2
        where wo2.order <= wo.order
       ) as pagenum,
       (select count(distinct order)
        from (SELECT *
              FROM `movements` LEFT JOIN
                   `classes`
                   ON `movements`.`class_id` = `classes`.`class_id` LEFT JOIN
                   `clients`
                   ON `movements`.`class_id` = `clients`.`class_id`
                   WHERE `classes`.`class_id` = '$class_id'
             ) wo2
       ) as maxpages          
 from (SELECT *
       FROM `movements` LEFT JOIN
            `classes`
            ON `movements`.`class_id` = `classes`.`class_id` LEFT JOIN
            `clients`
            ON `movements`.`class_id` = `clients`.`class_id`
       WHERE `classes`.`class_id` = '$class_id'
      ) wo
order by pagenum 
```

# java - 如何在 TYPE_3BYTE_BGR 中获取 jpeg 图像的 rgb 值？

> ID：11959626
> 
> 赞同：5
> 
> 时间：2012-08-14T19:42:24.777
> 
> 标签：java, image, image-processing, jpeg, rgb

我有这张图片：

![谷歌图片](../Images/551b208c2ba85e93051624f6950bcf55.png)

我想在`int[]`. 到目前为止，这是我为 PNG 图像所做的：

```
File f = new File("t.jpg");
BufferedImage img = ImageIO.read(f);
int[] ib = img.getRGB(0, 0, img.getWidth(), img.getHeight(), null, 0, img.getWidth());
Color c = new Color(ib[0]);
System.out.println(c.getRed() + " " + c.getGreen() + " " + c.getBlue()); 
```

但是在这里我得到了这个输出：`255 128 128`这是出乎意料的，因为我清楚地看到（并且已经在几个图像编辑器中验证了）（0,0）处的像素具有这些值`255 255 255`。

我注意到返回的类型`img.getType()`等于[TYPE_3BYTE_BGR](http://docs.oracle.com/javase/6/docs/api/java/awt/image/BufferedImage.html#TYPE_3BYTE_BGR)所以我猜这是幕后发生的解码问题，但我不知道如何解决它（或者更清楚地了解正在发生的事情）。

有人会对如何正确解码这种类型有建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T15:18:50.373

在对不同的解决方案进行广泛测试后，我发现了该类的一个错误`com.sun.imageio.plugins.jpeg.JPEGImageReader`（该类用于解码 JPEG 的`ImageIO`类）。

如果我这样做（Oracle 推荐，因为这应该适用于所有 JVM 和 SO 中的许多其他线程）：

```
BufferedImage bi = ImageIO.read(new FileInputStream("t.jpg")); 
```

然后我得到微红的图像。

另一方面，如果我这样做：

```
JPEGImageDecoder jpegDec = JPEGCodec.createJPEGDecoder(new FileInputStream("t.jpg"));
BufferedImage bi = jpegDec.decodeAsBufferedImage(); 
```

然后我得到正确解码的图像。（请注意，这`com.sun.image.codec.jpeg.JPEGCodec`是 Sun/Oracle JVM 的一个特定类，因此该解决方案不可移植）。

最后，我尝试过的另一种可行的方法是使用`Toolkit.getDefaultToolkit().createImage()`. 图像是异步加载的（我认为这是一个小缺点），但至少它可以正确加载我的图像。不过，我不能 100% 确定最后一个解决方案在所有平台/JVM 上都是可移植的。

# couchdb - 列表有多“快”？

> ID：11959627
> 
> 赞同：0
> 
> 时间：2012-08-14T19:42:26.210
> 
> 标签：couchdb

在开发我的应用程序时，我注意到，我在列表中添加了越来越多的复杂性。就像[“加入”](https://stackoverflow.com/questions/3033443/best-way-to-do-one-to-many-join-in-couchdb)相关文档一样。或者根据查询参数操作输出。众所周知，有很多东西可以放在列表中。也可以由中间件处理的东西（如果你不开发 couchapp）。

只是为了确定**一个问题**：列表可以/应该走多远？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T01:08:49.000

你应该只去 Jason Scale 上的 12 左右；）

很难量化答案。Couch 内的 JS 和 Couch 外的 JS 一样快，比原生代码慢，比其他一些解释器快，比其他一些解释器慢。简短的回答是，如果您喜欢在列表中编写代码，并且它适用于您的开发环境，那么请放松，不要停止，直到/除非它成为问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T13:30:20.803

列表的问题在于它们是在每个请求上执行的。这对您来说可能不是问题，但我更愿意避免使用列表，并将文档和应用程序设计为不需要列表。也就是说，没有什么能阻止您在沙发前放置一些缓存机制以减少服务器负载。

# objective-c - 推送新视图时 UINavigationItem TitleView 崩溃

> ID：11959629
> 
> 赞同：2
> 
> 时间：2012-08-14T19:42:36.943
> 
> 标签：objective-c, uinavigationbar, uinavigationitem

在视图控制器的加载视图中，我使用图像自定义标题视图：

```
self.navigationItem.titleView = [[UIImageView alloc] initWithImage: [UIImage imageNamed: @"navigationBarCentralImage.png"]]; 
```

到目前为止一切顺利，它在导航栏的中心显示图像。但是，当我弹出当前视图并推送一个在没有自定义标题视图的情况下运行良好的新视图时，它会崩溃。这是我用来弹出/推送的代码

```
-(void)popLastViewAndPush:(id)viewController
{
    NSMutableArray *controllers = [SharedAppDelegate.navigationController.viewControllers mutableCopy];
    if([controllers objectAtIndex:[controllers count] -1] == viewController)
        return;

    [controllers removeLastObject];
    SharedAppDelegate.navigationController.viewControllers = controllers;

    [SharedAppDelegate.navigationController pushViewController:viewController animated:YES];
} 
```

我有点卡住了，不明白为什么它实际上会因标题视图自定义而崩溃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:59:28.193

如果您不使用 ARC，请将代码行更改为：

```
self.navigationItem.titleView = [[[UIImageView alloc] initWithImage: [UIImage imageNamed: @"navigationBarCentralImage.png"]] autorelease]; 
```

`autorelease`必须向分配的对象添加一个。

# php - 来自 mysql_fetch_array 的空间正在破坏我的链接

> ID：11959630
> 
> 赞同：0
> 
> 时间：2012-08-14T19:42:36.760
> 
> 标签：php, mysql

```
$oku = mysql_fetch_array($yaz);
echo $oku[0]; 
```

例如，这会打印我的`$oku[0]`值`hello world`

但如果我像这样使用它：

```
echo "<a href=index.php?member=" . $oku[0] . ">" . $oku[0] . "</a>"; 
```

它以文本形式正确显示 hello world，但链接指向 index.php?member=hello

它不包含空格后面的文本。如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:47:06.220

使用 php [rawurlencode -function](http://php.net/manual/de/function.rawurlencode.php)对字符串进行编码（其中包含一个空格）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T19:47:07.087

做就是了：

```
printf(
    '<a href="%s">%s</a>',
    'index.php?member=' . rawurlencode($oku[0]),
    $oku[0]
); 
```

# python - `pip help install` 引发 UnicodeDecodeError

> ID：11959632
> 
> 赞同：13
> 
> 时间：2012-08-14T19:42:45.237
> 
> 标签：python, pip

当我尝试使用 pip 安装 Cython 时，发现编译时出错。一些基本的 pip 命令也给出了相同的结果`UnicodeDecodeError`：

错误信息都是这样的：

```
─➤  pip help install
Exception:
Traceback (most recent call last):
  File "/usr/local/lib/python2.6/dist-packages/pip/basecommand.py", line 126, in main
    self.run(options, args)
  File "/usr/local/lib/python2.6/dist-packages/pip/commands/help.py", line 19, in run
    command.parser.print_help()
  File "/usr/lib/python2.6/optparse.py", line 1664, in print_help 
    file.write(self.format_help().encode(encoding, "replace"))
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe4 in position 2964: ordinal not in range(128) 
```

我已经通过pip成功安装了其他包，不知道为什么会突然出现这种情况。谁能告诉我如何修复这个错误？

谢谢！

一些信息：Ubuntu 10.04 上的 pip 1.0.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-18T03:38:06.963

这不是一个精确的解决方案，但请尝试检查：

```
[user@host]$ locale 
```

对我来说，它看起来像这样：

```
[w495@w-495-ynb ~]$ locale
LANG=ru_RU.UTF-8
LC_CTYPE="ru_RU.UTF-8"
LC_NUMERIC=C
LC_TIME=ru_RU.UTF-8
LC_COLLATE=C
LC_MONETARY=C
LC_MESSAGES="ru_RU.UTF-8"
LC_PAPER=ru_RU.UTF-8
LC_NAME="ru_RU.UTF-8"
LC_ADDRESS="ru_RU.UTF-8"
LC_TELEPHONE="ru_RU.UTF-8"
LC_MEASUREMENT=C
LC_IDENTIFICATION="ru_RU.UTF-8"
LC_ALL= 
```

我想问题就在其中。

您可以尝试自己手动在命令行中设置语言环境变量。例如：

```
[user@host]$ LANG=en_US.utf8
[user@host]$ pip help install 
```

我不确定这`LANG`对你有帮助。`locale`如果没有 - 从输出中尝试所有内容。如果它有效，请根据需要永久设置它。把这个

```
export LANG=en_US.utf8
export <ANY OTHER VAR THAT HELPS>=en_US.utf8 
```

在你的`~/.bashrc`or`~/.profile`和使用

```
[user@host]$ source ~/.bashrc 
```

应用您的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T05:14:43.177

如果您有权访问服务器，请尝试：

```
nano /usr/lib/python2.6/sitecustomize.py, and write on file:
import sys
sys.setdefaultencoding('utf-8') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-14T23:31:18.837

在终端试试这个：

```
$ which python 
```

和

```
$ which pip 
```

Pip 应该来自与您正在使用的解释器相同的 Python 安装。如果它们不同，请修改您的 .bashrc 或 .bash_profile 以确保它们相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-12T10:33:43.300

你可以试试

```
sudo apt-get install python-pip 
```

它将安装 pip 相应的 python 版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-12T10:58:45.097

首先使用sudo apt-get update更新所有包/存储库

最新的 Cython 版本始终可以从[http://cython.org](http://cython.org)下载。解压tarball或zip文件，进入目录，然后运行：

python setup.py install
or
pip install cython

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-17T11:54:05.583

`pip`使用以下命令删除：

```
sudo apt-get purge python-pip 
```

然后安装一个新的副本`pip`：

```
curl  https://bootstrap.pypa.io/get-pip.py | sudo python 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-03T02:28:13.467

当我将模块安装到我的计算机上使用时，我被教导只需在命令提示符中输入以下内容（例如，这将是安装 numpy）：

```
>install pip numpy 
```

我不知道您是否将其输入到解释器中，但这可能是个问题。希望这可以帮助！

# regex - 使用下划线将 CamelCase 字符串转换为大写

> ID：11959637
> 
> 赞同：2
> 
> 时间：2012-08-14T19:43:02.507
> 
> 标签：regex

我有一个字符串“CamelCase”，我使用这个 RegEx：

```
string pattern = "(?<!(^|[A-Z]))(?=[A-Z])|(?<!^)(?=[A-Z][a-z])";          
string[] substrings = Regex.Split("CamelCase", pattern); 
```

在`substring`中，我有 Camel 和 Case，这就是 find，但我想全部都`uppercase`喜欢这个 CAMEL 和 CASE。更好的是，我想得到一个像这样的 CAMEL_CASE 字符串，但是**用**正则表达式来解决所有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-30T14:59:30.973

这是一个 JavaScript 实现。

```
function camelCaseToUpperCase(str) {
  return str.replace(/([a-z])([A-Z])/, '$1_$2').toUpperCase();
} 
```

## 演示

```
printList([ 'CamelCase', 'camelCase' ],
  function(value, idx, values) {
    return value + ' -> '
      + camelCaseToUpperCase(value) + ' -> '
      + camelToTitle(value, '_');
  }
);

// Case Conversion Functions
function camelCaseToUpperCase(str) {
  return str.replace(/([a-z])([A-Z])/, '$1_$2').toUpperCase();
}
function camelToTitle(str, delimiter) {
  return str.replace(/([A-Z][a-z]+)/g, ' $1') // Words beginning with UC
    .replace(/([A-Z][A-Z]+)/g, ' $1')         // "Words" of only UC
    .replace(/([^A-Za-z ]+)/g, ' $1')         // "Words" of non-letters
    .trim()                                   // Remove any leading/trailing spaces
    .replace(/[ ]/g, delimiter || ' ');       // Replace all spaces with the delim
}

// Utility Functions
function printList(items, conversionFn) {
  var str = '<ul>';
  [].forEach.call(items, function(item, index) {
    str += '<li>' + conversionFn(item, index, items) + '</li>';
  });
  print(str + '</ul>');
}
function print() {
  write.apply(undefined, arguments);
}
function println() {
  write.apply(undefined, [].splice.call(arguments,0).concat('<br />'));
}
function write() {
  document.getElementById('output').innerHTML += arguments.length > 1 ?
    [].join.call(arguments, ' ') : arguments[0]
}
```

```
#output {
  font-family: monospace;
}
```

```
<h1>Case Conversion Demo</h1>
<div id="output"></div>
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T18:25:22.640

在 Perl 中，您可以这样做：

```
$string = "CamelCase";
$string =~ s/((?<=[a-z])[A-Z][a-z]+)/_\U$1/g;
$string =~ s/(\b[A-Z][a-z]+)/\U$1/g;
print "$string\n"; 
```

替换用于`\U`将找到的组转换为大写。

可以使用 Perl 的选项将其压缩为单个正则表达式`e`来评估替换：

```
$string = "CamelCase";
$string =~ s/(?:\b|(?<=([a-z])))([A-Z][a-z]+)/(defined($1) ? "_" : "") . uc($2)/eg;
print "$string\n"; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-21T21:55:09.110

使用 sed 和 tr unix 实用程序（从您的终端）...

```
echo "CamelCase" | sed -e 's/\([A-Z]\)/-\1/g' -e 's/^-//' | tr '-' '_' | tr '[:lower:]' '[:upper:]' 
```

如果您的驼峰式字符串末尾带有“ID”并且您希望保持这种状态，请使用这个...

```
echo "CamelCaseID" | sed -e 's/\([A-Z]\)/-\1/g' -e 's/^-//' | tr '-' '_' | tr '[:lower:]' '[:upper:]' | sed -e 's/I_D$/ID/g' 
```

通过在 ruby​​ 中扩展 String 类...

```
class String
    def camelcase_to_underscore
       self.gsub(/::/, '/').
          gsub(/([A-Z]+)([A-Z][a-z])/,'\1_\2').
          gsub(/([a-z\d])([A-Z])/,'\1_\2').
          tr("-", "_").
          upcase
    end
end 
```

现在，您可以对任何字符串执行 camelcase_to_underscore 方法。例子：

```
>> "CamelCase".camelcase_to_underscore
=> "CAMEL_CASE" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T20:23:10.023

```
using System;
using System.Text.RegularExpressions;

public class Example
{
  public static void Main()
  {
    string input = "CamelCase";
    string output = Regex.Replace(input, 
      @"(?:\b|(?<=([A-Za-z])))([A-Z][a-z]*)", 
      m => string.Format(@"{0}{1}", 
        (m.Groups[1].Value.Length > 0)? "_" : "", m.Groups[2].Value.ToUpper()));
    Console.WriteLine(output);
  }
} 
```

[在此处](http://ideone.com/qu2bj)测试此代码。

# eclipse - Eclipse m2e多模块项目签出并转换为maven

> ID：11959640
> 
> 赞同：5
> 
> 时间：2012-08-14T19:43:16.643
> 
> 标签：eclipse, maven, version-control, multi-module, vcs-checkout

我最近需要检查一个 apache 项目来进行一些事实调查/调试（特别是 maven-surefire-plugin，请参阅[这个问题](https://stackoverflow.com/questions/11959211/maven-surefire-plugin-include-exclude-precedence)）。与大多数其他 apache 项目一样，这是一个 Maven 多模块项目。因此，在 Eclipse 中，我打开了*SVN Repositories*浏览器，添加了一个新的存储库，找到了项目和`right-click->Checkout...`. 在向导中，我单击`Checkout as a project in the workspace`并输入项目名称。

我有这个项目，现在我需要让 eclipse 知道它是一个 maven 项目，所以`right-click->Configure->Convert to Maven Project`. 现在父项目是一个maven项目。我可以`right-click->Run As->Maven Build`并且有效。但是，所有模块都只是文件夹。Eclipse 不知道源代码在哪里，或者即使它有任何源代码。在单个模块项目中，它会自动设置源文件夹、构建文件夹和其他配置。此外，如果您从头开始创建一个多模块项目，则首先创建父项目，然后，当您向其中添加模块时，它们每个都显示为 eclipse 中的单个项目，物理目录位于父项目下默认 maven 构建过程需要的文件夹。

所以现在，知道创建新项目时它是如何完成的，我可以`File->New->Project...`选择`General->Project`，为项目命名（我将其与模块名称匹配），取消选中`Use default location`并设置`Location:`为父项目文件夹内模块的路径。单击`Finish`并为每个其他模块重复该过程后，我得到的东西看起来与我期望的相似。我现在需要以与父项目相同的方式将每个单独的模块转换为 maven 模块。太好了，它们都是 maven 项目，对吧？

然后我打开它们，源文件夹没有设置。

啊...然后我转到每个项目，将其打开，然后在`src`文件夹 I上`right-click->Build Path->Use as Source Folder`。起泡、冲洗、重复……完成所有项目后，看起来和感觉就像我从头开始这个项目。事物功能。

我的问题是，真的这么难吗？我错过了捷径吗？如果`Configure->Convert to Maven Project`在父 pom 上意识到这是一个多模块项目并且为我完成了所有工作，这不是很有意义吗？对于 apache 项目来说，这是一个非常痛苦的过程，因为它们似乎都有很多很多模块......有人知道更好的过程吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T19:54:01.360

您可以尝试将所有代码拉到 Eclipse 之外，将父项目作为现有的 Maven 项目 ( `right-click -> Import... -> Existing Maven Projects`) 导入，然后看看是否一切都如您所愿。然后`right-click -> Team -> Share Project...`在父项目上。

# c# - 为什么关闭使用 AllocConsole 启动的控制台会导致我的整个应用程序退出？我可以改变这种行为吗？

> ID：11959643
> 
> 赞同：31
> 
> 时间：2012-08-14T19:43:25.693
> 
> 标签：c#, .net, winapi, console, console-application

我想要发生的是控制台窗口消失了，或者更好的是它被隐藏了，但我希望我的应用程序继续运行。那可能吗？我希望能够使用 Console.WriteLine 并将控制台用作输出窗口。我希望能够隐藏和显示它，我不希望整个应用程序仅仅因为控制台关闭而死掉。

**编辑**

代码：

```
internal class SomeClass {

    [DllImport("kernel32")]
    private static extern bool AllocConsole();

    private static void Main() {
        AllocConsole();
        while(true) continue;
    }
} 
```

**编辑 2**

根据对此问题的评论中的建议，我在这里尝试了接受的解决方案 [ [Capture console exit C# ]。](https://stackoverflow.com/questions/474679/capture-console-exit-c-sharp)示例代码存在错误，因为 DLLImport 需要是“kernel32.dll”或“kernel32”，而不是“Kernel32”。进行该更改后，当我单击控制台窗口上的 X 时，我会收到一条消息给我的 CTRL_CLOSE_EVENT 处理程序。但是，调用 FreeConsole 和/或返回 true 不会阻止应用程序终止。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-14T20:33:40.717

啊，是的，这是使用 Windows 控制台子系统的注意事项之一。当用户关闭控制台窗口时（不管控制台是如何分配的），*所有连接到控制台的进程都会终止*。这种行为对于控制台应用程序（即那些专门针对控制台子系统的应用程序，而不是标准的 Windows 应用程序）来说是很有意义的，但在像您这样的情况下它可能是一个主要的痛苦。

我知道的唯一解决方法是使用[`SetConsoleCtrlHandler`function](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686016.aspx)，它允许您为`Ctrl`+`C`和`Ctrl`+`Break`信号以及系统事件（如用户关闭控制台窗口、用户注销或系统关闭）注册处理函数. 文档说，如果您只想忽略这些事件，则可以传递`null`第一个参数。例如：

```
[DllImport("kernel32")]
static extern bool SetConsoleCtrlHandler(HandlerRoutine HandlerRoutine, bool Add);

delegate bool HandlerRoutine(uint dwControlType);

static void Main()
{
    AllocConsole();
    SetConsoleCtrlHandler(null, true);
    while (true) continue;
} 
```

这对于`Ctrl`+`C`和`Ctrl`+`Break`信号非常有效（否则也会导致您的应用程序终止），但它不适用于您要询问的那个`CTRL_CLOSE_EVENT`，即用户关闭时系统生成的控制台窗口。

老实说，我不知道如何防止这种情况。即使[SDK 中的示例](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685049.aspx)实际上也不允许您忽略`CTRL_CLOSE_EVENT`. 我在一个小测试应用程序中尝试了它，当您关闭窗口并打印消息时它会*发出哔哔声，但该过程仍然会终止。*

也许更令人担忧的是，文档让我认为不可能阻止这种情况：

> 当用户关闭控制台、注销或关闭系统时，系统会生成`CTRL_CLOSE_EVENT`、`CTRL_LOGOFF_EVENT`和信号，以便进程在终止之前有机会进行清理。`CTRL_SHUTDOWN_EVENT`控制台函数，或调用控制台函数的任何 C 运行时函数，在处理前面提到的三个信号中的任何一个时，可能无法可靠地工作。原因是在执行进程信号处理程序之前，可能已经调用了部分或全部内部控制台清理例程。

吸引我眼球的是最后一句话。*如果控制台子系统在响应用户尝试关闭窗口后立即*开始清理，则可能无法在事后停止它。

（至少现在你明白了这个问题。也许其他人可以提出解决方案！）

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-08-18T01:41:38.900

不幸的是，您无法真正改变这种行为。

控制台窗口是“特殊的”，因为它们由另一个进程托管并且不允许子类化。这限制了你修改他们行为的能力。

据我所知，您的两个选择是：

## 1.完全禁用关闭按钮。您可以使用以下代码片段执行此操作：

```
HWND hwnd = ::GetConsoleWindow();
如果 (hwnd != NULL)
{
   HMENU hMenu = ::GetSystemMenu(hwnd, FALSE);
   if (hMenu != NULL) DeleteMenu(hMenu, SC_CLOSE, MF_BYCOMMAND);
}

```

## 2\. 完全停止使用控制台，实现自己的文本输出解决方案。

选项 #2 是更复杂的选项，但会为您提供最大的控制。我在[CodeProject](http://www.codeproject.com/Articles/335909/Embedding-a-Console-in-a-C-Application)上找到了一篇文章，它使用富编辑控件来实现类似控制台的应用程序来显示文本（富编辑控件能够像控制台一样流式传输文本，因此它们非常适合此类应用程序）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-08-22T07:43:02.220

关闭使用`AllocConsole`或获得的控制台窗口`AttachConsole`时，相关进程将退出。没有办法逃脱。

在 Windows Vista 之前，关闭控制台窗口会向用户显示一个确认对话框，询问他是否应该终止进程，但 Windows Vista 和更高版本不提供任何此类对话并且进程被终止。

解决此问题的一种可能解决方案是完全避免 AttachConsole 并通过其他方式实现所需的功能。

例如，在 OP 描述的情况下，需要控制台窗口才能使用`Console`静态类在控制台上输出一些文本。

这可以很容易地使用进程间通信来实现。例如，可以开发控制台应用程序来充当回显服务器

```
namespace EchoServer
{
    public class PipeServer
    {
        public static void Main()
        {
            var pipeServer = new NamedPipeServerStream(@"Com.MyDomain.EchoServer.PipeServer", PipeDirection.In);
            pipeServer.WaitForConnection();

            StreamReader reader = new StreamReader(pipeServer);

            try
            {
                int i = 0;
                while (i >= 0)
                {
                    i = reader.Read();
                    if (i >= 0)
                    {
                        Console.Write(Convert.ToChar(i));
                    }
                }
            }
            catch (IOException)
            {
                //error handling code here
            }
            finally
            {
                pipeServer.Close();
            }
        }
    }
} 
```

然后不是将控制台分配/附加到当前应用程序，而是可以从应用程序内部启动回显服务器，并且`Console's`可以重定向输出流以写入管道服务器。

```
class Program
{
    private static NamedPipeClientStream _pipeClient;

    static void Main(string[] args)
    {
        //Current application is a Win32 application without any console window
        var processStartInfo = new ProcessStartInfo("echoserver.exe");

        Process serverProcess = new Process {StartInfo = processStartInfo};
        serverProcess.Start();

        _pipeClient = new NamedPipeClientStream(".", @"Com.MyDomain.EchoServer.PipeServer", PipeDirection.Out, PipeOptions.None);
        _pipeClient.Connect();
        StreamWriter writer = new StreamWriter(_pipeClient) {AutoFlush = true};
        Console.SetOut(writer);

        Console.WriteLine("Testing");

        //Do rest of the work. 
        //Also detect that the server has terminated (serverProcess.HasExited) and then close the _pipeClient
        //Also remember to terminate the server process when current process exits, serverProcess.Kill();
        while (true)
            continue;
    }
} 
```

这只是可能的解决方案之一。本质上，解决方法是将控制台窗口分配给它自己的进程，以便它可以在不影响父进程的情况下终止。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2022-02-18T19:48:20.523

您可以通过名为 Keyfreez 的外部程序禁用键盘鼠标输入来做到这一点。

您可以在不需要用户输入的程序中多次使用它。如果任何用户输入需要你可以添加一个进程 Takskkill /f /IM 。

[https://www.sordum.org/7921/bluelife-keyfreeze-v1-4-block-keyboard-and-mouse/](https://www.sordum.org/7921/bluelife-keyfreeze-v1-4-block-keyboard-and-mouse/)

希望这对大家有帮助

# windows - Windows 上的安全命名共享内存，因此只有特定进程才能打开

> ID：11959647
> 
> 赞同：2
> 
> 时间：2012-08-14T19:43:30.660
> 
> 标签：windows, winapi, ipc

有没有办法在 Windows 中使用命名共享内存设置权限，以便访问控制由进程而不是用户完成？我想让一个程序创建内存，传递句柄或传回 PID，以便客户端进程可以访问内存。应拒绝所有其他进程访问。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:45:16.873

访问控制仅由安全主体进行，可以是用户、组、计算机等。

如果您有一个想要与另一个进程共享的对象，您可以使用[DuplicateHandle](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724251(v=vs.85).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:52:06.413

不，因为流程不是安全原则。

相反，使用未命名的文件映射并使用[DuplicateHandle](http://msdn.microsoft.com/en-us/library/ms724251%28v=vs.85%29)为客户端进程提供句柄的副本。

# batch-file - 仅当有输出时才重定向 DOS 输出

> ID：11959650
> 
> 赞同：5
> 
> 时间：2012-08-14T19:43:48.520
> 
> 标签：batch-file, dos

我在 Windows 机器上运行的批处理文件 (.bat) 中有一系列行，例如：

```
start /b prog.exe cmdparam1 cmdparam2 > test1.txt
start /b prog.exe cmdparam1 cmdparam2 > test2.txt 
```

有时 proj.exe 不返回任何内容（空）而不是有用的数据。在那些情况下，我不想生成文本文件，这在批处理文件方面很容易做到吗？当前的行为是始终创建一个文本文件，在空输出的情况下它只是一个空白文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:48:50.700

jpe 解决方案需要您的父批次知道启动的进程何时完成，然后才能检查输出文件的大小。您可以使用 START /WAIT 选项，但您会失去并行运行的优势。

如果另一个进程已经将输出重定向到同一个文件，您可以使用重定向到文件将失败的事实。当您的父批次可以成功重定向到它们时，您就知道已启动的进程已全部完成。

您可能应该将 stderr 重定向到您的输出文件以及 stdout

```
@echo off

::start the processes and redirect the output to the ouptut files
start /b "" cmd /c prog.exe cmdparam1 cmdparam2 >test1.txt 2>&1
start /b "" cmd /c prog.exe cmdparam1 cmdparam2 >test2.txt 2>&1

::define the output files (must match the redirections above)
set files="test1.txt" "test2.txt"

:waitUntilFinished 
:: Verify that this parent script can redirect an unused file handle to the
:: output file (append mode). Loop back if the test fails for any output file.
:: Use ping to introduce a delay so that the CPU is not inundated.
>nul 2>nul ping -n 2 ::1
for %%F in (%files%) do (
  9>>%%F (
    rem
  )
) 2>nul || goto :waitUntilFinished

::Delete 0 length output files
for %%F in (%files%) do if %%~zF==0 del %%F 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T19:56:05.173

只需[删除所有长度为零的文件](https://stackoverflow.com/questions/4176962/recursively-delete-0kb-files-using-windows-cmd)。`start`编辑：为了适应在等待终止之前没有 /WAIT 标志返回的事实，您可以为您`prog.exe`创建以下包装脚本：`progwrapper.bat``prog.exe`

```
prog.exe "%1" "%2" > "%3"
if %~z3==0 del "%3" 
```

然后从您的主脚本中调用包装器：

```
start /b progwrapper.bat cmdparam1 cmdparam2 > test1.txt
start /b progwrapper.bat cmdparam1 cmdparam2 > test2.txt 
```

等等

如果 prog.exe 是一个 GUI 应用程序，那么您应该`start /B /WAIT prog.exe`在 progwrapper.bat 中有一个。

# package - sbt 多项目战争打包

> ID：11959651
> 
> 赞同：3
> 
> 时间：2012-08-14T19:43:56.070
> 
> 标签：package, war, sbt, multi-project

我一直在尝试找到将由多个项目组成的 Web 应用程序打包到单个战争中的方法。我为 sbt 找到的唯一有用的插件是 xsbt-web-plugin。我正在尝试在该 github 托管项目中使用 War 插件，但 WEB-INF/lib 中仅包含 Web 项目的 de 依赖项（不是构建中定义的其他项目，也不是它们的依赖项）。我的构建文件是：

```
import sbt._
import Keys._
import com.github.siasia._
import WarPlugin.warSettings

object BuildSettings {

  import Dependencies._

  val buildOrganization = "ar.edu.itba.it"
  val buildVersion = "1.27"

  val hibernateVersion = "3.6.7.Final"
  val guiceVersion = "3.0"
  val wicketVersion = "1.5.4"
  val jerseyVersion = "1.12"

  val buildSettings = Defaults.defaultSettings ++ Seq(
    organization := buildOrganization,
    version := buildVersion,
    crossPaths := false,
    publishArtifact in (Compile, packageDoc) := false,
    publishArtifact in (Compile, packageSrc) := false,
    parallelExecution in ThisBuild := false,
    libraryDependencies ++= Seq(slf4j_api, slf4j_log4j12, junit, hamcrest_all,         mockito_all, h2, joda_time, guava, junit_interface),
    javacOptions ++= Seq("-source", "1.6", "-target", "1.6"),
    testOptions += Tests.Argument(TestFrameworks.JUnit))
}

object SgaBuild extends Build {
  import BuildSettings._
  import Dependencies._
  import com.github.siasia.WebPlugin._

  val compileAndTest = "test->test;compile->compile"

  lazy val root = Project(id = "sga", base = file(".")) aggregate (itba_common,     itba_common_wicket, itba_common_jpa, jasperreports_fonts_extensions, sga_backend, sga_rest,     sga_wicket) // settings (rootSettings: _*)

  lazy val itba_common = Project(id = "itba-common", base = file("itba-common"))     settings (buildSettings: _*)
  lazy val itba_common_jpa = Project(id = "itba-common-jpa", base = file("itba-common-    jpa")) dependsOn (itba_common % compileAndTest) settings (buildSettings: _*)
  lazy val itba_common_wicket = Project(id = "itba-common-wicket", base = file("itba-    common-wicket")) dependsOn (itba_common % compileAndTest, itba_common_jpa % compileAndTest)     settings (buildSettings: _*)
  lazy val jasperreports_fonts_extensions = Project(id = "jasperreports-fonts-    extensions", base = file("jasperreports-fonts-extensions")) settings (buildSettings: _*)
  lazy val sga_backend = Project(id = "sga-backend", base = file("sga-                backend")) dependsOn (itba_common % compileAndTest, itba_common_jpa % compileAndTest)     settings (buildSettings: _*)
  lazy val sga_rest = Project(id = "sga-rest", base = file("sga-rest")) dependsOn     (sga_backend % compileAndTest) settings (buildSettings: _*)

  lazy val sga_wicket = Project(id = "sga-wicket", base = file("sga-wicket")) dependsOn     (sga_backend % compileAndTest, sga_rest % compileAndTest, itba_common_wicket %     compileAndTest) settings ((buildSettings ++ warSettings(Compile)):_*)

}

object Resolvers {
  val wicketStuff = "Wicket Stuff Repository" at     "http://wicketstuff.org/maven/repository"
}

object Dependencies {

  import BuildSettings._

  ... // (plenty of ModuleIDs that are refered from 7 XXX.sbt)
} 
```

查看插件代码，它似乎将所有文件从完整类路径配置复制到 lib 目录中，但是在检查完整配置时，它不包括所有必需的 jars（来自其他 7 个项目的那些及其依赖项）。

这是使用正确的插件还是有另一个插件？

提前致谢！

# javascript - 设置 HTML 自定义属性与在 ID 属性中存储信息

> ID：11959654
> 
> 赞同：0
> 
> 时间：2012-08-14T19:44:13.257
> 
> 标签：javascript, html

通常，当我在 JavaScript 中需要一些随机对象的 ID（存储在服务器上）时，我使用以下方法：

```
<div id="chat-wrap-29" class="chat-wrap">...</div>
<div id="chat-wrap-28" class="chat-wrap">...</div> 
```

这就是我知道我可以在 JS 脚本中检索聊天包装 ID 并通过服务器上的 AJAX 发送它的方式。为了获得 id，我必须检索 id 属性 ( `this.getAttribute("id")`)，并在脚本中进行一些字符串操作。

一种更清洁的方法是使用这样的东西：

```
<div class="chat-wrap" chatId = "29">...</div>
<div class="chat-wrap" chatId = "29">...</div> 
```

这样，在 DOM 中声明的 ID 就会减少，我会避免这种字符串操作。这个解决方案有什么缺点吗？在我所描述的情况下，最佳做法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:47:10.897

如果要将数据存储在属性中，则应使用[HTML5`data-*`属性](http://ejohn.org/blog/html-5-data-attributes/)- 这就是它们的用途，如[规范中所述](http://dev.w3.org/html5/spec/global-attributes.html#embedding-custom-non-visible-data-with-the-data-attributes)。

一些 JavaScript 库，例如[jQuery](http://api.jquery.com/data/)，对它们有原生支持。

# vbscript - 收到“Windows 无法连接到域”错误消息时无法访问 WMI

> ID：11959656
> 
> 赞同：1
> 
> 时间：2012-08-14T19:44:23.310
> 
> 标签：vbscript, dns, wmi, trust, workgroup

所以我有一个 XP Pro 工作站报告*“Windows 无法连接到域，因为域控制器已关闭或不可用，或者因为找不到您的计算机帐户。请稍后再试。如果此消息继续出现，请联系您的系统管理员寻求帮助。”* 使用域凭据登录时。要手动修复此问题，我只需使用本地管理员帐户登录，将其放入工作组，然后将其重新添加到域中。然而，考虑到这个问题在我的工作中经常出现，这个过程可能需要相当长的时间。我正在尝试做的是以编程方式自动化删除/重新加入过程。以下代码有效，但前提是计算机正确位于域或工作组中，而不是像现在这样处于不确定状态。

```
Const JOIN_DOMAIN             = 1
Const ACCT_CREATE             = 2
Const ACCT_DELETE             = 4
Const WIN9X_UPGRADE           = 16
Const DOMAIN_JOIN_IF_JOINED   = 32
Const JOIN_UNSECURE           = 64
Const MACHINE_PASSWORD_PASSED = 128
Const DEFERRED_SPN_SET        = 256
Const INSTALL_INVOCATION      = 262144

Const WbemAuthenticationLevelPktPrivacy = 6

'On Error Resume Next 

SystemName = "SystemName"
strNamespace = "root\cimv2"
ComputerBLogin = "LoginB"
ComputerBPass = "PassB"
ComputerALogin = "LoginA"
ComputerAPass = "PassA"
DomainName = "domain.com"
OU = "OU=desiredou,DC=domain,DC=com"

Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate,authenticationLevel=pktPrivacy}!\\" & SystemName & "\root\cimv2")

If Err.Number <> 0 Then

    Set objWbemLocator = CreateObject("WbemScripting.SWbemLocator")
    Set objWMIService = objwbemLocator.ConnectServer(SystemName, strNamespace, ComputerBLogin, ComputerBPass)

    objWMIService.Security_.authenticationLevel = WbemAuthenticationLevelPktPrivacy

    Err.Clear
End IF

Set colComputers = objWMIService.ExecQuery("Select * from Win32_ComputerSystem")

For Each objComputer in colComputers
    Return = objComputer.UnJoinDomainOrWorkGroup(NULL, NULL)
    Return = objComputer.JoinDomainOrWorkGroup("WORKGROUP", NULL, NULL)
    If Err.Number <> 0 Then
        Set WshShell = CreateObject("WScript.Shell")
        message = WshShell.Popup (SystemName & " could not be dropped to the workgroup!" & vbCr &_
                "Error: " & Err.Description,, "Title", 0 + 16)
    Else
        Set WshShell = CreateObject("WScript.Shell")
        message = WshShell.Popup (SystemName & " was successfully dropped to the WORKGROUP!",, "Title", 0 + 64)
    End If
Next

For Each objComputer in colComputers
    ReturnValue = objComputer.JoinDomainOrWorkGroup(DomainName, ComputerAPass, ComputerALogin, OU, JOIN_DOMAIN + ACCT_CREATE)

    If Err.Number <> 0 Then
        Set WshShell = CreateObject("WScript.Shell")
        message = WshShell.Popup ("Unable to join " & SystemName & " to the domain! Please join manually.",, "Title", 0 + 16)
    Else
        Set WshShell = CreateObject("WScript.Shell")
        message = WshShell.Popup ("Domain joining was successful!",, "Title", 0 + 64)
    End If
Next 
```

当脚本到达第 24 行时：

```
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate,authenticationLevel=pktPrivacy}!\\" & SystemName & "\root\cimv2") 
```

它错误*“远程服务器机器不存在或不可用：'GetObject'”*。如果机器在域中正确，该行将正常工作。AD 对象确实存在。如果出现此错误，我将其编码为在第 29 行使用本地管理员凭据登录机器：

```
Set objWMIService = objwbemLocator.ConnectServer(SystemName, strNamespace, ComputerBLogin, ComputerBPass) 
```

这将与*“SWbemLocator：访问被拒绝”出错。*

因此，当机器处于这种状态时，使用我熟悉的两种方法都无法访问 WMI。在我的研究中，似乎“工作站和域之间的信任关系已经失败”，但对我来说，这并不能解释为什么我无法使用本地管理员凭据登录。

我不想求助于 NETDOM，但我还是尝试了。它也错误地谈论失败的信任关系。

**所以我的问题是：**
**A)**当出现此错误消息时，有没有办法以编程方式将工作站放到工作组中并将其重新添加到域中？
**B）**以编程方式修复工作站和域之间的信任关系（如果这实际上是什么问题）？
**C)**当出现此错误消息时，使用管理员凭据登录工作站？

提前感谢大家的任何潜在帮助，如果需要更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:24:01.047

好吧，我觉得有点愚蠢，不早点想到这一点，但[Lizz](https://stackoverflow.com/users/1569434/lizz)提到映射驱动器让我思考。我试图映射驱动器，但它一直想使用我当前的凭据或我的域和备用域用户名。所以我尝试了“.\LoginB”，但它只使用了我的计算机名称，后跟“LoginB”。我最终不得不使用“SystemName\LoginB”并成功映射驱动器。使用它，我可以通过将 ComputerBLogin 变量更改为以下内容来更正上面的代码，这实际上是有效的：

```
Const JOIN_DOMAIN             = 1
Const ACCT_CREATE             = 2
Const ACCT_DELETE             = 4
Const WIN9X_UPGRADE           = 16
Const DOMAIN_JOIN_IF_JOINED   = 32
Const JOIN_UNSECURE           = 64
Const MACHINE_PASSWORD_PASSED = 128
Const DEFERRED_SPN_SET        = 256
Const INSTALL_INVOCATION      = 262144

Const WbemAuthenticationLevelPktPrivacy = 6

On Error Resume Next 

SystemName = "SystemName"
strNamespace = "root\cimv2"
ComputerBLogin = SystemName & "\LoginB"
ComputerBPass = "PassB"
ComputerALogin = "LoginA"
ComputerAPass = "PassA"
DomainName = "domain.com"
OU = "OU=desiredou,DC=domain,DC=com"

Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate,authenticationLevel=pktPrivacy}!\\" & SystemName & "\root\cimv2")

If Err.Number <> 0 Then

    Set objWbemLocator = CreateObject("WbemScripting.SWbemLocator")
    Set objWMIService = objwbemLocator.ConnectServer(SystemName, strNamespace, ComputerBLogin, ComputerBPass)

    objWMIService.Security_.authenticationLevel = WbemAuthenticationLevelPktPrivacy

    Err.Clear
End IF

Set colComputers = objWMIService.ExecQuery("Select * from Win32_ComputerSystem")

For Each objComputer in colComputers
    Return = objComputer.UnJoinDomainOrWorkGroup(NULL, NULL)
    Return = objComputer.JoinDomainOrWorkGroup("WORKGROUP", NULL, NULL)
    If Err.Number <> 0 Then
        Set WshShell = CreateObject("WScript.Shell")
        message = WshShell.Popup (SystemName & " could not be dropped to the workgroup!" & vbCr &_
                "Error: " & Err.Description,, "Title", 0 + 16)
    Else
        Set WshShell = CreateObject("WScript.Shell")
        message = WshShell.Popup (SystemName & " was successfully dropped to the WORKGROUP!",, "Title", 0 + 64)
    End If
Next

For Each objComputer in colComputers
    ReturnValue = objComputer.JoinDomainOrWorkGroup(DomainName, ComputerAPass, ComputerALogin, OU, JOIN_DOMAIN + ACCT_CREATE)

    If Err.Number <> 0 Then
        Set WshShell = CreateObject("WScript.Shell")
        message = WshShell.Popup ("Unable to join " & SystemName & " to the domain! Please join manually.",, "Title", 0 + 16)
    Else
        Set WshShell = CreateObject("WScript.Shell")
        message = WshShell.Popup ("Domain joining was successful!",, "Title", 0 + 64)
    End If
Next 
```

感谢灯泡时刻 Lizz！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T02:53:14.003

据我所知，当它处于这种状态时，它与主机及其域的关系是无法修复的；我们从来没有能够以务实的方式做到这一点。为此，还需要在脚本中硬编码您的本地管理员和 Active Directory 帐户凭据，这是一个非常危险的过程。

相反，您必须[使用您的域凭据从 AD 中删除主机](http://community.spiceworks.com/scripts/show/531-remove-from-domain)，然后重新启动主机。也许在从 AD 中删除它之后，您将能够使用本地管理员凭据登录它。为测试目的复制此条件的一种方法是删除测试 PC 的域对象，然后重新启动并查看您是否可以进行身份​​验证。

最后，这可能是只能以交互方式完成的事情。而且我不会使用 WMI，因为 WMI 比其他方法具有更多的安全检查和限制，例如使用 RPC 启动 psexec 会话以在损坏的主机上复制和运行脚本。

上面链接中的脚本会提示您输入 AD 凭据。[此链接](http://www.activexperts.com/activmonitor/windowsmanagement/scripts/activedirectory/computer/#DeleteComputer.htm)假定您正在使用这些凭据运行脚本，如下所示。

```
strComputer = "atl-pro-040"

set objComputer = GetObject("LDAP://CN=" & strComputer & _
    ",CN=Computers,DC=fabrikam,DC=com")
objComputer.DeleteObject (0) 
```

# javascript - setInterval 在 webkit 浏览器中表现奇怪

> ID：11959659
> 
> 赞同：0
> 
> 时间：2012-08-14T19:44:49.767
> 
> 标签：javascript, jquery, webkit, setinterval

我正在开发一个网站的仪表板，我要添加的最后一个功能是时钟。我有一个获取日期/时间、格式化并将其输出到时钟的基本功能，但我的`setInterval`功能在 Webkit 浏览器中不起作用。我试过用几种不同的方式重新安排它，但没有成功。

在 Webkit 中，如果我通过突出显示时钟文本或滚动等来强制它重新渲染，时钟将重新加载。

我的代码如下所示：

```
$(document).ready(function() {

    setInterval(function() {

        var time = new Date();

        var hour = time.getHours();
        var min = time.getMinutes();
        var sec = time.getSeconds();
        var amPm = (hour < 12 ? "AM" : "PM");

        hour = (hour <= 12 ? hour : hour - 12);
        min = (min < 10 ? "0" + min : min);
        sec = (sec < 10 ? "0" + sec : sec);

        var currentTime = (hour + " : " + min + " : " + sec + " " + amPm);

        $('#time').html(currentTime);

        var date = time.getDate();

        var month = time.getMonth();

        var year = time.getYear();

        year = year - 100;

        var todaysDate = (month + "/" + date + "/" + year);

        $('#date').html(todaysDate);

        var dayNum = time.getDay();

        var day = new Array("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday");

        $('#day').html(day[dayNum]);

    }, 1000);

});​ 
```

它适用于 Firefox，但不适用于 Chrome 或 Safari。有谁知道为什么`setInterval`在 Webkit 中行为异常，修复方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:33:34.990

事实证明，我的代码中有一些错误。一个是时间对象需要全局声明。此外，最好的语法是将整个内容包装到一个调用的函数中`updateClock()`，然后在该函数`setInterval`上使用，而不是`()`在函数之后

```
setInterval(updateClock, 1000); 
```

祝你好运

# javascript - 正则表达式：使用量词捕获多个组

> ID：11959662
> 
> 赞同：6
> 
> 时间：2012-08-14T19:45:07.800
> 
> 标签：javascript, regex

考虑以下代码：

```
<!DOCTYPE html>
<html>
<body>
<script type="text/javascript">

var str = '<12> rnbqkb-r Rnbq-b-r ';

var pat1 = new RegExp('^\\<12\\> ([rnbqkpRNBQKP-]{8}) ([rnbqkpRNBQKP-]{8})');
var pat2 = new RegExp('^\\<12\\> ([rnbqkp RNBQKP-]{8}){2}');
var pat3 = new RegExp('^\\<12\\> ([rnbqkp RNBQKP-]{8}){2}?');

document.write(str.match(pat1));
document.write('<br />');
document.write(str.match(pat2));
document.write('<br />');
document.write(str.match(pat3));

</script>
</body>
</html> 
```

产生

```
<12> rnbqkb-r Rnbq-b-r,rnbqkb-r,Rnbq-b-r
<12> rnbqkb-r Rnbq-b-, Rnbq-b-
<12> rnbqkb-r Rnbq-b-, Rnbq-b- 
```

作为输出。

为什么既没有模式`pat2`也没有`pat3`捕获第一组`rnbqkb-r`？我想捕获所有组，而不必像在 pattern 中那样明确地重复它们`pat1`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T20:02:17.463

> 为什么模式 pat2 和 pat3 都没有捕获第一组 rnbqkb-r？

`pat2`因为您的正则表达式和`pat3`不允许的每个 8 字符序列的末尾都有空格。

> 我想捕获所有组，而不必像模式 pat1 中那样明确地重复它们。

你不能。

当您的正则表达式仅包含一个组时，（在 JavaScript 中）不可能捕获两个组。

组通过括号定义。您的匹配结果将包含与您的正则表达式中的括号对一样多的组（除了`(?:...)`不计入匹配组的修改括号）。想要在您的比赛结果中进行两场单独的小组赛？在您的正则表达式中定义两个单独的组。

如果一个组可以匹配多次，则该组的值将是*最后一次*匹配的值。该组的所有先前匹配项将被其最后一次匹配项覆盖。

尝试

```
var pat1 = /^<12> ((?:[rnbqkp-]{8} ?)*)/i,
    match = str.match(pat1);

if (match) {
  match[1].split(/\s+/);  // ["rnbqkb-r", "Rnbq-b-r", ""]
} 
```

笔记：

*   `str`如果您不想要最后一个空数组值，请提前修剪。
*   一般来说，更喜欢正则表达式文字表示法 ( `/expression/`)。仅用于`new RegExp()`从动态值生成的表达式。
*   `<`并且`>`并不特别，您无需逃避它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T19:51:31.213

再数一遍（8 对 9）。`pat2`并且`pat3`缺少两个部分之间的空间。

更新：此外，我不认为您试图通过使用`match`. 请参阅[如何使用 JavaScript 中的正则表达式匹配多个匹配项，类似于 PHP 的 preg_match_all()？](https://stackoverflow.com/questions/520611/how-can-i-match-multiple-occurrences-with-a-regex-in-javascript-similar-to-phps)并使用`exec`.

# android - Android：使用 BitmapFactory.decodeFile 打开的文件的方向错误

> ID：11959667
> 
> 赞同：1
> 
> 时间：2012-08-14T19:45:26.890
> 
> 标签：android, resize, exif, bitmapfactory

就像标题一样简单，使用 BitmapFactory.decodeFile 打开的文件在 ImageView 上显示时方向错误。从相机捕获的图像并保存在 tmp 文件中，因此如果设备存在返回 data.getData() null 的错误，我至少有对该文件的引用。

这只是启动相机活动并捕获图像文件

```
private void startCamera() {
    Intent intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
    if (hasImageCaptureBug()) {
        intent.putExtra(android.provider.MediaStore.EXTRA_OUTPUT, Uri.fromFile(new File(Constants.TMPFILE_PATH)));
    } else {
        intent.putExtra(android.provider.MediaStore.EXTRA_OUTPUT, android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
    }
    startActivityForResult(intent, CAMERA_PIC_REQUEST);
}

protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == CAMERA_PIC_REQUEST) {
        if (resultCode == RESULT_OK) {
            Uri uri = null;

            if (hasImageCaptureBug()) {
                File f = new File(Constants.TMPFILE_PATH);
                try {
                    uri = Uri.parse(android.provider.MediaStore.Images.Media.insertImage(getContentResolver(), f.getAbsolutePath(), null, null));
                } catch (FileNotFoundException e) {

                }
            } else {
                uri = data.getData();
            }

            imageFilePath = Image.getPath(this, uri);

            if (Image.exists(imageFilePath)) {
                ImageView image = (ImageView) findViewById(R.id.thumbnail);
                int targetW     = (int) getResources().getDimension(R.dimen.thumbnail_screen_width);
                int degrees     = (int) Image.getRotation(this, uri);

                Bitmap bmp = Image.resize(imageFilePath, targetW);
                bmp = Image.rotate(bmp, degrees);

                image.setAdjustViewBounds(true);
                image.setImageBitmap(bmp);
            }
        }
    }
} 
```

这个文件调整图像大小

```
public class Image {
    public static Bitmap resize(String pathName, int targetW) {
        BitmapFactory.Options opts = new BitmapFactory.Options();
        opts.inJustDecodeBounds = true;

        Bitmap bmp = BitmapFactory.decodeFile(pathName, opts);

        int photoW = opts.outWidth;
        int photoH = opts.outHeight;
        int targetH = Math.round((photoH * targetW) / photoW);
        int scaleFactor = Math.min(photoW/targetW, photoH/targetH);

        opts.inJustDecodeBounds = false;
        opts.inSampleSize = scaleFactor;
        opts.inPurgeable = true;

        bmp = BitmapFactory.decodeFile(pathName, opts);

        return bmp;
    }
} 
```

尝试获取 ExifOrientation 但始终为 0，因为文件本身的方向正确，就在我加载文件时，文件显示的方向错误。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T22:01:50.640

似乎我预览图像的问题是Constants.TMPFILE_PATH，图像没有保存在那里，我只是使用这个修复[显示在android中的图像视图布局中拍摄的最新图片](https://stackoverflow.com/questions/6107168/display-the-latest-picture-taken-in-the-image-view-layout-in-android)，但如果我将它发布到问题仍然存在服务器......我会检查这个答案并为此打开一个新问题......

* * *

已编辑

要解决这个问题只需重构新图像然后将其上传到服务器，因为文件本身的原始数据有他的exif方向错误。

# wcf - WCF 客户端无法连接到非 WCF 命名管道服务器

> ID：11959678
> 
> 赞同：1
> 
> 时间：2012-08-14T19:46:30.203
> 
> 标签：wcf

我有一个 WCF 命名管道服务器、一个非 WCF 命名管道服务器、一个 WCF 命名管道客户端和一个非 wcf 命名管道客户端。

非 wcf 客户端可以连接到两台服务器。wcf 客户端只能连接到 wcf 服务器。当我尝试将它连接到非 wcf 客户端时，我得到了这个异常。

```
Unhandled Exception: System.ServiceModel.EndpointNotFoundException: There was no endpoint
listening at net.pipe://localhost/PipePlusFive that could accept the message. This is 
often caused by an incorrect address or SOAP action. See InnerException,
if present, for more details. ---> System.IO.PipeException: The pipe endpoint 
'net.pipe://localhost/PipePlusFive' could not be found on your local machine. 
```

--- 内部异常堆栈跟踪结束 ---

据此，管道[的](http://blogs.msdn.com/b/rodneyviana/archive/2011/03/22/named-pipes-in-wcf-are-named-but-not-by-you-and-how-to-find-the-actual-windows-object-name.aspx)实际名称是存储在内存映射文件中的 guid。我假设这是为 wcf 客户端和服务器自动处理的。对于非 wcf 服务器，我创建内存映射文件，向其写入 guid，然后使用该 guid 作为名称创建管道。在非 wcf 客户端中，我打开内存映射文件，从中读取管道名称，然后使用该名称连接到管道。然后，事实上我可以使用非 wcf 客户端连接到两台服务器而不进行任何更改，这让我相信我在服务器和客户端上都正确地实现了这部分。

此外，当我启动非 wcf 服务器然后启动 wcf 服务器时，第二个崩溃表明它无法侦听该管道名称，因为另一个端点已经在侦听。

我想知道为什么当非 wcf 客户端可以找到两者时 wcf 客户端找不到非 wcf 服务器？除了我链接到的博客中描述的内容之外，wcf 还有其他东西可以用来找到终点吗？

更新：

这是我用于 WCF 客户端的代码：

```
 class Program
{
    static void Main(string[] args)
    {
        ChannelFactory<IPlusFive> pipeFactory =
            new ChannelFactory<IPlusFive>(new NetNamedPipeBinding(NetNamedPipeSecurityMode.None), new EndpointAddress("net.pipe://localhost/PipePlusFive"));

        IPlusFive pipeProxy = pipeFactory.CreateChannel();

        while (true)
        {
            string str = Console.ReadLine();
            if (str.Equals("q"))
            { return; }
            Console.WriteLine(pipeProxy.PlusFive(Int32.Parse(str)));
        }
    }
} 
```

这是我用于 WCF 服务器的代码：

```
class Program
{
    static void Main(string[] args)
    {
        var inst = new PlusFiver();
        using (ServiceHost host = new ServiceHost(inst,
            new Uri[] { new Uri("net.pipe://localhost") }))
        {
            host.AddServiceEndpoint(typeof(IPlusFive), new NetNamedPipeBinding(NetNamedPipeSecurityMode.None), "PipePlusFive");
            host.Open();
            Console.WriteLine("Service is Available. Press enter to exit.");
            Console.ReadLine();
            host.Close();
        }
    }
} 
```

这是我用于非 WCF 服务器的代码：

```
 class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine("Creating Memory Mapped file...");
        string fileName = GenerateFileMapName(String.Empty);
        Guid pipeName = Guid.NewGuid();
        Console.WriteLine(" writing pipe name: " + pipeName.ToString("D"));
        MemoryMappedFile mmf = null;
        var messageList = new List<byte>();
        try
        {
            mmf = WritePipeName(fileName, pipeName);
            Console.WriteLine("Creating Named Pipe");
            Console.WriteLine("Pipe Name: " + GetPipeNameFromMappedFile(fileName, mmf));
            using (var pipe = new NamedPipeServerStream(pipeName.ToString("D"), PipeDirection.InOut))
            {
                Console.WriteLine("pipe created");
                Console.WriteLine("Waiting for connection");
                pipe.WaitForConnection();
                Console.WriteLine("Received Connection");
                Console.WriteLine("Waiting to receive data");
                var bytes = new byte[7];
                pipe.Read(bytes, 0, 7);
                messageList.AddRange(bytes);
                bytes = new byte[messageList[6]];
                pipe.Read(bytes, 0, messageList[6]);
                messageList.AddRange(bytes);
                bytes = new byte[2];
                pipe.Read(bytes, 0, 2);
                messageList.AddRange(bytes);
                messageList.Add((byte)pipe.ReadByte());
                pipe.WriteByte(0x0b);
                WriteList(messageList);
                Console.WriteLine("Finished reading from pipe");
                PrintBytes(bytes);
                Console.WriteLine("Closing Connection");
                pipe.Disconnect();
                Console.WriteLine("Pipe disconnected");
                //Console.Read();
            }
        }
        finally
        {
            mmf.Dispose();
        }

    }

    private static void WriteList(List<byte> messageList)
    {
        foreach (var b in messageList)
        {
            Console.Write(b.ToString("x2") + " ");
        }
        Console.WriteLine();
    }

    private static void PrintBytes(byte[] bytes)
    {
        foreach (var b in bytes)
        {
            Console.Write(b.ToString("x2") + " ");
        }
        Console.WriteLine();
    }

    private static string GenerateFileMapName(string uri)
    {
        return "net.pipe:EbmV0LnBpcGU6Ly8rLw==";
    }

    private static MemoryMappedFile WritePipeName(string fileName, Guid pipeName)
    {
        var mmf = MemoryMappedFile.CreateNew(fileName, pipeName.ToByteArray().Count());

            Console.WriteLine("Memory Mapped File Created.");
            using (var accessor = mmf.CreateViewAccessor(4, 45))
            {
                Console.WriteLine("Writing pipe name to file");
                accessor.Write(0, ref pipeName);
                Console.WriteLine("Finished writing pipe name to file");
            }
        return mmf;
    }

    private static string GetPipeNameFromMappedFile(string filename, MemoryMappedFile mmf)
    {
        Guid pipeName;
        using (var accessor = mmf.CreateViewAccessor(4, 45))
        {

            accessor.Read<Guid>(0, out pipeName);
        }
        return pipeName.ToString("D");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:40:34.937

WCF 端点 netNamedPipeBinding 旨在连接到 WCF 命名管道服务器。当 WCF 客户端使用这种类型的绑定建立连接时，它会进行与您提到[的文章](http://blogs.msdn.com/b/rodneyviana/archive/2011/03/22/named-pipes-in-wcf-are-named-but-not-by-you-and-how-to-find-the-actual-windows-object-name.aspx)中指定的相同的准备工作。该[帖子](http://blogs.charteris.com/blogs/chrisdi/archive/2008/05/19/exploring-the-wcf-named-pipe-binding-part-1.aspx)将澄清其余细节。

# windows-phone-7 - 如何在不使用 EmailComposeTask 的情况下从 Windows Phone 发送电子邮件？

> ID：11959679
> 
> 赞同：0
> 
> 时间：2012-08-14T19:46:29.737
> 
> 标签：windows-phone-7

我需要我的应用程序在不使用 EmailComposeTask 的情况下直接向我发送电子邮件。我也不想为此使用网络服务。有没有我可以使用的开源框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T21:28:44.820

目前没有办法在没有用户输入的情况下发送电子邮件，除非您想向服务发送一些信息并让服务发送电子邮件

# api - 通过 API 识别点击广告的用户

> ID：11959685
> 
> 赞同：0
> 
> 时间：2012-08-14T19:47:04.137
> 
> 标签：api, facebook-graph-api, ads

是否有任何方法可以访问用户的 Facebook UID，该用户点击使用 Ad API 创建的市场广告，而无需通过 Open Graph 进行应用身份验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T21:35:32.180

不可以。他们必须先对您的应用进行身份验证，然后您才有机会看到他们的 UID。如果你能得到他们的 UID，你就可以向他们发送垃圾邮件，而 Facebook 不希望这样。

# javascript - HTML Javascript 幻灯片优化

> ID：11959692
> 
> 赞同：1
> 
> 时间：2012-08-14T19:47:23.190
> 
> 标签：javascript, jquery, html

我必须编写自己的几行代码，以便在我的网站启动页面上显示幻灯片。我无法使用任何插件，因为我在 HTML5 和 css3 上设计了网站，并且图像已同步以与浏览器一起调整大小。现在，进入实际问题，最后一张图像花费的时间是列表中每张图像的两倍。下面是粘贴的 HTML 和 javascript。

**HTML**

```
 <div id="backgrounds">
    <div class="bgs" style="z-index:1000;">
        <!--<p style="z-index:999; margin:0; margin-top:300px; color:red; position:absolute;">Let the Feeling Wrap Around</p>--> 
        <img src="images/main_nop.jpg" alt="" class="background" />
    </div>

    <div class="bgs" style="z-index:999; display: none">
        <!--<p style="z-index:999; margin:0; margin-top:300px; color:red; position:absolute;">Let the Feeling Wrap Around</p>--> 
        <img src="images/main_jkl.jpg" alt="" class="background" />
    </div>

    <div class="bgs" style="z-index:998; display: none">
        <!--<p style="z-index:999; margin:0; margin-top:300px; color:red; position:absolute;">Let the Feeling Wrap Around</p>--> 
        <img src="images/main_ghi.jpg" alt="" class="background" />
    </div>

    <div class="bgs" style="z-index:997; display: none">
        <!--<p style="z-index:999; margin:0; margin-top:300px; color:red; position:absolute;">Let the Feeling Wrap Around</p>--> 
        <img src="images/main_def.jpg" alt="" class="background" />
    </div>

    <div class="bgs" style="z-index:996; display: none">
        <!--<p style="z-index:999; margin:0; margin-top:300px; color:red; position:absolute;">Let the Feeling Wrap Around</p>--> 
        <img src="images/main_abc.jpg" alt="" class="background" /> 
    </div>
  </div> 
```

**JAVASCRIPT**

```
 var count = 0;
    var repeatCount = 0;
    var backgrounds = $('.bgs').length;
    function startSlideShow() {
        myRecFunc = setInterval(function () {
            if (count == backgrounds) {
                $('.bgs').eq(0).stop(true, true).hide(1000, 'easeOutExpo');
                $('.bgs').eq(backgrounds - 1).show(1000, 'easeOutExpo');
            }
            if (count < backgrounds) {
                $('.bgs').eq(count).stop(true, true).show(1000, 'easeOutExpo');
                $('.bgs').eq(count - 1).stop(true, true).hide(1000, 'easeOutExpo');
                count++;
            }
            else {
                count = 0;
                repeatCount++;
            }
        }, 1000);
    }
    startSlideShow(); 
```

上面代码中的第一个 if() 是我添加的用于处理我在上面所说的情况的那个，在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:07:08.080

你有一个条件，你在整个间隔内什么都不做，这是你的“其他”情况。尝试将检查移到内部，以便立即发生。

```
var count = 0;
var repeatCount = 0;
var backgrounds = $('.bgs').length;
function startSlideShow() {
    myRecFunc = setInterval(function () {
        $('.bgs').eq(count).stop(true, true).show(1000, 'easeOutExpo');
        $('.bgs').eq(count - 1).stop(true, true).hide(1000, 'easeOutExpo');
        count++;
        if (count === backgrounds) {
            count = 0;
            repeatCount++;
        }
    }, 1000);
}
startSlideShow();​ 
```

# eclipse - 安装 Aptana 后无法启动 Eclipse

> ID：11959699
> 
> 赞同：1
> 
> 时间：2012-08-14T19:47:44.837
> 
> 标签：eclipse, eclipse-plugin, aptana

我最近将 Aptana 插件安装到我的 eclipse IDE 中并重新启动它。现在它根本没有开始。

我尝试删除元数据文件夹，它让它启动但很快就崩溃了。

但是在崩溃之前有一条消息说我的 Aptana 版本与 firefox 不兼容（有趣的是，firefox 与它有什么关系？）。

无论如何，在崩溃之后，我的 eclipse 文件夹中有三个 .txt 文件说

> Java 运行时环境检测到致命错误

请帮我启动eclipse。

**可能重复：** [Aptana 插件使 Eclipse 崩溃](https://stackoverflow.com/questions/7103069/aptana-plugin-crashes-eclipse)

但是这个问题没有得到正确的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:53:46.537

如果您想使用 aptana，我建议从 aptana 开始。但是，如果这不是一个选项，而您只是想从 eclipse 中删除它，您可以试试这个：

**注意：这只是我尝试的方式。我没试过这个。**

首先，关闭 eclipse 并备份你的 eclipse 文件夹。接下来，浏览 features 和 plugins 文件夹并删除所有引用“aptana”的文件和文件夹。

# scrapy - 无法爬行深度超过1的scrapy

> ID：11959701
> 
> 赞同：5
> 
> 时间：2012-08-14T19:48:08.013
> 
> 标签：scrapy

我无法将scrapy配置为以深度> 1运行，我尝试了以下3个选项，但没有一个有效，摘要日志中的request_depth_max始终为1：

1）添加：

```
from scrapy.conf import settings
settings.overrides['DEPTH_LIMIT'] = 2 
```

到蜘蛛文件（站点上的示例，只是使用不同的站点）

2）使用选项运行命令行`-s`：

```
/usr/bin/scrapy crawl -s DEPTH_LIMIT=2 mininova.org 
```

3）添加到`settings.py`和`scrapy.cfg`：

```
DEPTH_LIMIT=2 
```

应该如何配置为1以上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-10T12:19:42.513

我有一个类似的问题，它有助于`follow=True`在定义时设置[`Rule`](http://doc.scrapy.org/en/latest/topics/spiders.html#crawling-rules)：

> `follow`是一个布尔值，它指定是否应从使用此规则提取的每个响应中遵循链接。如果`callback`默认`None` `follow` 为`True`，否则默认为`False`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T18:13:08.620

warwaruk 是对的，DEPTH_LIMIT 设置的默认值为 0 - 即“不施加限制”。

所以让我们刮一下 miniova 看看会发生什么。从`today`页面开始，我们看到有两个 tor 链接：

```
stav@maia:~$ scrapy shell http://www.mininova.org/today
2012-08-15 12:27:57-0500 [scrapy] INFO: Scrapy 0.15.1 started (bot: scrapybot)
>>> from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
>>> SgmlLinkExtractor(allow=['/tor/\d+']).extract_links(response)
[Link(url='http://www.mininova.org/tor/13204738', text=u'[APSKAFT-018] Apskaft presents: Musique Concrte', fragment='', nofollow=False), Link(url='http://www.mininova.org/tor/13204737', text=u'e4g020-graphite412', fragment='', nofollow=False)] 
```

让我们抓取第一个链接，我们看到该页面上没有新的 tor 链接，只有指向自身的链接，默认情况下不会重新抓取 (scrapy.http.Request(url[, ... dont_filter=False, . ..]））：

```
>>> fetch('http://www.mininova.org/tor/13204738')
2012-08-15 12:30:11-0500 [default] DEBUG: Crawled (200) <GET http://www.mininova.org/tor/13204738> (referer: None)
>>> SgmlLinkExtractor(allow=['/tor/\d+']).extract_links(response)
[Link(url='http://www.mininova.org/tor/13204738', text=u'General information', fragment='', nofollow=False)] 
```

没有运气，我们仍然处于深度 1。让我们试试另一个链接：

```
>>> fetch('http://www.mininova.org/tor/13204737')
2012-08-15 12:31:20-0500 [default] DEBUG: Crawled (200) <GET http://www.mininova.org/tor/13204737> (referer: None)
[Link(url='http://www.mininova.org/tor/13204737', text=u'General information', fragment='', nofollow=False)] 
```

不，这个页面也只包含一个链接，一个指向自身的链接，它也会被过滤。所以实际上没有要抓取的链接，所以 Scrapy 关闭了蜘蛛（深度==1）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T04:56:44.470

[`DEPTH_LIMIT`](http://doc.scrapy.org/en/latest/topics/settings.html#depth-limit)设置的默认值为`0`- 即“不施加限制”。

你写了：

> `request_depth_max`在摘要日志中总是`1`

您在日志中看到的是统计信息，而不是设置。当它这么说时，`request_depth_max`这`1`意味着从第一个回调开始，没有产生其他请求。

您必须显示您的蜘蛛代码以了解发生了什么。

但是为它创造另一个问题。

更新：

啊，我看到你正在为[scrapy 介绍运行 mininova s​​pider](http://doc.scrapy.org/en/latest/intro/overview.html/#write-a-spider-to-extract-the-data)：

```
class MininovaSpider(CrawlSpider):

    name = 'mininova.org'
    allowed_domains = ['mininova.org']
    start_urls = ['http://www.mininova.org/today']
    rules = [Rule(SgmlLinkExtractor(allow=['/tor/\d+']), 'parse_torrent')]

    def parse_torrent(self, response):
        x = HtmlXPathSelector(response)

        torrent = TorrentItem()
        torrent['url'] = response.url
        torrent['name'] = x.select("//h1/text()").extract()
        torrent['description'] = x.select("//div[@id='description']").extract()
        torrent['size'] = x.select("//div[@id='info-left']/p[2]/text()[2]").extract()
        return torrent 
```

正如您从代码中看到的，蜘蛛从不向其他页面发出任何请求，它直接从顶层页面抓取所有数据。这就是最大深度为 1 的原因。

如果你让自己的蜘蛛跟随其他页面的链接，最大深度将大于 1。

# javascript - 第二个下拉菜单元素上的重复下拉Javascript效果

> ID：11959706
> 
> 赞同：0
> 
> 时间：2012-08-14T19:48:35.353
> 
> 标签：javascript, css, wordpress, jquery-events

我想在“Bio”菜单元素上复制单击“Contact”菜单元素下拉效果

[http://www.dawaf.co.uk/jj/](http://www.dawaf.co.uk/jj/)

我在 header.php 中复制了 html 代码：

```
<!-- contact -->
<section id="contact">
    <!-- container -->
    <div class="container">
                <p>Creative Consultant / Stylist<br /><br /><a href="mailto:info@janinejauvel.co.uk">info@janinejauvel.co.uk</a><br />
                +44(0) 7983 572330</p>

    </div>
    <!-- .container -->

</section>
<!-- .contact -->

<!-- bio -->
<section id="bio">
    <!-- container -->
    <div class="container">
                <p>Testing this shows up</p>

    </div>
    <!-- .container -->

</section>
<!-- .bio --> 
```

我已经复制了 CSS。

我不确定我需要编辑什么 Javascript 才能在 script.js 上获得相同的效果：

```
 /* Show the portfolio
     ------------------------------------------------- */

    $('#portfolio-catcher').click(function() {

        $('h1 a').trigger('click');

        return false;

    });

    $('a[href="#portfolio"]').click( function () {

        // hide contact 
        $('#contact').stop().slideUp({
            duration: 250, 
            easing: 'easeInOutCubic'
        });

        // remove the iframe content (for vimeo videos)

        $('iframe').remove();

        hattie.showPortfolio();

        return false;

    });

    /* Contact section click
         ------------------------------------------------- */
        $('a[href="#contact"]').click(function() {

            // hide slideshow whatever
            $('#slideshow').stop().slideUp({
                duration: 300, 
                easing: 'easeInOutCubic'
            });     

            // show contact
            $('#contact').stop().slideDown({
                duration: 300, 
                easing: 'easeInOutCubic'
            });

            hattie.showPortfolio();

            return false;

    });

    /* Launching a project
     ------------------------------------------------- */

    $('hgroup').click(function() {

        // scroll to top
        $.scrollTo(0, 250);

        $hgroup     = $(this);
        // hide contact 

        if ($('#contact').is(':visible')) {

            $('#contact').stop().slideUp({
                duration: 250, 
                easing: 'easeInOutCubic'
            });
        }

        // show the loading gif in the container
        $('#slideshow-container').html('<div class="loading"><img src="/assets/img/loading.gif" alt="loading"/></div>');

        $('section#work').stop().animate({
            'margin-top' : '+=' +($(window).height() - 55) + 'px'
        }, 700, 'easeInOutCubic', function () {

            // load the project into the slideshow container div
            $('#slideshow-container').load('' + $hgroup.attr('data-project'), function() {
                // bind slideshow
                    slideshow.render();
                    $('section#work').css('margin-top', '0px');
            });

        });

        return false;

    });

}, 

this.folioLinkShow  = function() {

    if ($('.slide').length > 1) {

        $('#portfolio-catcher').hover(function() {

            $('nav#show-projects div').slideDown(200);

        }, function () {

            $('nav#show-projects div').slideUp(200);

        });

    } else {

        $('nav#show-projects').unbind();

    }
}, 

this.loadImages     = function() { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:54:55.993

使您的“生物”href 像这样：*#bio*

然后，将其添加到您的 Javascript 中（它的作用与点击联系人的作用完全相同：

```
/* Contact section click ------------------------------------------------- */
$('a[href="#contact"]').click(function() {
    // hide bio
    if ($('#bio').is(':visible')) {
        $('#bio').stop().slideUp({
            duration: 250, 
            easing: 'easeInOutCubic'
        });
    }
    // hide slideshow whatever

        $('#slideshow').stop().slideUp({
            duration: 300, 
            easing: 'easeInOutCubic'
        });     

        // show contact
        $('#contact').stop().slideDown({
            duration: 300, 
            easing: 'easeInOutCubic'
        });

        hattie.showPortfolio();

        return false;

});

/* Bio section click ------------------------------------------------- */
$('a[href="#bio"]').click(function() {
    // hide contact 
    if ($('#contact').is(':visible')) {
        $('#contact').stop().slideUp({
            duration: 250, 
            easing: 'easeInOutCubic'
        });
    }

    // hide slideshow whatever
    $('#slideshow').stop().slideUp({
        duration: 300, 
        easing: 'easeInOutCubic'
    });     

    // show contact
    $('#bio').stop().slideDown({
        duration: 300, 
        easing: 'easeInOutCubic'
    });

    hattie.showPortfolio();

    return false;

}); 
```

# php - 如何在 SF2 中将动作定义为单独的类？

> ID：11959709
> 
> 赞同：0
> 
> 时间：2012-08-14T19:48:48.593
> 
> 标签：php, model-view-controller, symfony, yii, action

我与 YF 合作过一段时间，我知道在 YF 中是一件美妙的事情——一种将动作定义为分离类的能力。有关详细信息，请查看[此页面](http://www.yiiframework.com/doc/guide/1.1/en/basics.controller)（第 3 段。行动）。

我想知道，是否有可能在 SF2 中做到这一点？

对于 SF，我找到了以下解决方案：扩展类 sfAction。SF2呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T00:47:04.773

Symfony 2.x 不是 MVC 框架。没有定义如何创建控制器、视图或模型层的方法。该框架仅提供支撑结构。

也就是说，创建一个单独的动作对象的想法是愚蠢的（当 Symfony 1.x 这样做时它是愚蠢的，而当 Yii 被砍掉时它仍然是愚蠢的）。

控制器是应该只改变模型层和当前视图状态的结构。它不创建对象，也不渲染输出。它只是有关用户输入的详细信息，并将其定向到模型层或视图。为动作设置单独的类是没有意义的。

# c# - 单击删除按钮时传递一个值

> ID：11959713
> 
> 赞同：0
> 
> 时间：2012-08-14T19:49:04.727
> 
> 标签：c#, asp.net, .net, commandfield

`gridview`我在单击时调用的每一行都有一个删除按钮`gvSiteInfo_RowDeleting(object sender, EventArgs e)`。如何找出单击的删除按钮的行号值？我需要在我指定的删除方法中有行号`<< NEED ROW NUMBER HERE!! >>`

到目前为止，我无法在网上搜索到任何东西，当我打印出的值时`sender`，`e`它们并没有告诉我任何有用的信息。

```
 protected void gvSiteInfo_RowDeleting(object sender, EventArgs e)
    {

        SiteDB site = new SiteDB();
        site.SelectedConnectionString = "SQLDEV08";
        site.deleteSite(<<<NEED ROW NUMBER HERE!!>>>);
    }

<asp:GridView ID="gvSiteInfo" runat="server" AutoGenerateColumns="False" OnSorting="gvSiteInfo_Sorting" width="100%"
    AllowSorting="True" OnRowDeleting="gvSiteInfo_RowDeleting" >
    <Columns>
        <asp:CommandField ButtonType="Button" ShowDeleteButton="True" ShowCancelButton="True" />
        <asp:BoundField DataField="prodServer" HeaderText="Production Server" 
            SortExpression="prodServer" />
        <asp:BoundField DataField="prodIP" HeaderText="Production IP Address" 
            SortExpression="prodIP" />
        <asp:BoundField DataField="Priority" HeaderText="Priority" 
            SortExpression="Priority" />
        <asp:BoundField DataField="Platform" HeaderText="Platform" 
            SortExpression="Platform" />
    </Columns>
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:51:54.710

RowDeleting 事件实际上采用[GridViewDeleteEventArgs](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewdeleteeventargs.aspx)，而不是您的标准 EventArgs。前者有一个`RowIndex`属性可以为您提供被删除行的索引。

# php - 内容如何适应表格大小

> ID：11959716
> 
> 赞同：0
> 
> 时间：2012-08-14T19:49:22.560
> 
> 标签：php, css, html-table

我正在寻找一种使表格内容适合表格大小的方法。例如，我有宽度和高度 = 100 的表格，以及 5 列和 5 行，如果行或列更改为 20，则只有内容重新调整大小以适应旧表格大小。我写了一些代码，但是如果行或列发生变化，它会调整表格的大小！

```
<style>
.tbl {
    max-width: 100px;
    max-height: 100px;
    height: 100px;
    width: 100px;
    border: 1px solid #333;
}
.blck {
    border: 1px solid #0F3;
    background:#F00;    
}
.wht {
    border: 1px solid #0F3;
    background:#069;
}
</style>
<?php
$w = 15;
$h = 15;
$max = 100;

if ($w>=$h) {
    $cell = ($max/$w);
} else {
    $cell = ($max/$h);
}
$clr = 0;
$tbl .= '<table width="'.$max.'px" align="center" border="0" height="'.$max.'px" class="tbl">';
for ($r=1;$r<=$h;$r++){

$tbl .= '<tr>';
    for($c=1;$c<=$w;$c++){
        if($clr == '0'){
            $tbl .= '<td width="'.$cell.'%" height="'.$cell.'%" class="blck"></td>';
            $clr = 1;
        } else {
            $tbl .= '<td width="'.$cell.'%" height="'.$cell.'%" class="wht"></td>';
            $clr = 0;
        }
    }
$tbl .= '</tr>';
}

$tbl .= '</table>';

echo $tbl;

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T21:32:48.687

为表格单元格添加边框时要小心，因为它会将 2px 添加到当前宽度/高度。当您将表格宽度除以列/行数时使用 floor()，因为宽度和高度属性不接受分数。

而且似乎高度属性不准确（不知道为什么）。

您还必须考虑文本大小。例如我把：

```
font-size: 1px;
line-height: 1px; 
```

看一下这个：

```
<?php
$w = 30;
$h = 30;
$max = 100;

if ($w>=$h) {
    $cell = floor($max/$w);
} else {
    $cell = floor($max/$h);
}
?>
<style type="text/css">
.tbl {
    display: table;
    height: <?php echo ($cell*$h); ?>px;
    width: <?php echo ($cell*$w); ?>px;
    font-size: 1px;
    line-height: 1px;
}
.blck {
    background-color: #F00;
}
.wht {
    background-color: #069;
}

.tbl .tr {
    display: table-row;
}

.tbl .td {
    width: <?php echo $cell;?>px;
    height: <?php echo $cell;?>px;
    display: table-cell;
}
</style>
<?php 

$fcell = $clr = 0;
$tbl .= '<div class="tbl">';
for ($r=1;$r<=$h;$r++){
    $tbl .= '<div class="tr">';
        for($c=1;$c<=$w;$c++){
            if($clr == '0'){
                $tbl .= '<div class="td blck">&nbsp;</div>';
                $clr = 1;
            } else {
                $tbl .= '<div class="td wht">&nbsp;</div>';
                $clr = 0;
            }
        }
    $tbl .= '</div>';

    if ($fcell == 0){
        $fcell = $clr = 1;
    } else {
        $fcell = $clr = 0;
    }
}

$tbl .= '</div>';

echo $tbl;

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:01:42.090

如果我理解正确，您想以自己的逻辑管理表格的大小。如果表格单元格中的任何内容由于某种原因溢出，您不希望它增长。您希望它在这种情况下保持静态尝试添加此属性

```
table
{
   table-layout:fixed;
} 
```

# java - 移动 Java (J2ME) 程序的最佳数据库

> ID：11959717
> 
> 赞同：-1
> 
> 时间：2012-08-14T19:49:40.537
> 
> 标签：java, database, mobile, java-me

什么是`DataBase`移动 Java 程序的最佳选择？`J2ME`

*   `DB`程序文件外使用的`.jar`文件
*   运行查询的最佳速度
*   拥有更多的`SQL`属性 Like`Curser, trigger and ...`
*   所需空间小（低于 1 Mb）
*   在每个具有少量空间和低速的移动设备上运行高速 java 程序所需的其他东西`prossesor`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:55:03.270

我担心这个问题没有真正的答案。您可以使用大量数据库，但我们中没有一个人对这个问题的了解几乎足以在这个问题上给您一个可靠的答案。用于存储数据的 SQL 和 NoSQL 选项数不胜数。在我的脑海中，我建议看一下 mobile-nosql 或者[这个线程](https://stackoverflow.com/questions/788397/is-there-any-option-for-local-database-like-sqlite-for-j2me-cldc-devices)。

# python - web2py 数据库未定义

> ID：11959719
> 
> 赞同：2
> 
> 时间：2012-08-14T19:49:47.303
> 
> 标签：python, web2py

我正在尝试在命令行上运行一个脚本，该脚本使用以下命令使用模型：

```
c:\web2py>python web2py.py -M -N -S automate -R applications/automate/modules/eventserver.py 
```

但我不断收到错误：

```
web2py Web Framework
Created by Massimo Di Pierro, Copyright 2007-2011
Version 1.99.7 (2012-03-04 22:12:08) stable
Database drivers available: SQLite3, pymysql, pg8000, IMAP
Traceback (most recent call last):
  File "c:\web2py\gluon\shell.py", line 206, in run
    execfile(startfile, _env)
  File "applications/automate/modules/eventserver.py", line 6, in <module>
    deviceHandler = devicehandler.DeviceHandler()
  File "applications\automate\modules\devicehandler.py", line 10, in __init__
    self.devices = self.getActiveDevices()
 File "applications\automate\modules\devicehandler.py", line 18, in getActiveDe
vices
    print db
NameError: global name 'db' is not defined 
```

我究竟做错了什么？

编辑：根据我的研究，我只找到了“将 -M 添加到您的命令”的解决方案，但我已经这样做了，但它仍然不起作用。

edit2：我的 db.py 中有 db = DAL('sqlite://storage.sqlite') 所以它应该被加载

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T02:38:17.823

> edit2：我的 db.py 中有 db = DAL('sqlite://storage.sqlite') 所以它应该被加载

假设 db.py 在 /models 文件夹中，`db`在那里创建的对象将在以后执行的模型文件以及控制器和视图中可用，但在您导入的模块中不可用。相反，您必须将`db`对象传递给模块中的函数或类。另一种选择是将`db`对象添加到`current`线程本地对象，然后可以在模块中导入和访问：

在 /models/db.py 中：

```
from gluon import current
db = DAL('sqlite://storage.sqlite')
current.db = db 
```

在 /modules/eventserver.py 中：

```
from gluon import current
def somefunction():
    db = current.db
    [do something with db] 
```

请注意，如果您确实`db`在模块中定义了对象，请不要在顶层定义它——在函数或类中定义它。

有关更多详细信息，请参阅有关[模块和`current`](http://web2py.com/books/default/chapter/29/4#Accessing-the-API-from-Python-modules).

# uinavigationbar - UIPopoverController 框架与其 contentView 的 UINavigationBar 重叠

> ID：11959723
> 
> 赞同：0
> 
> 时间：2012-08-14T19:50:17.593
> 
> 标签：uinavigationbar, uisplitviewcontroller, uipopovercontroller

知道如何移动导航栏视图，以便获得预期的填充吗？看起来弹出框重叠在导航栏的顶部、左侧和右侧。

这是我在从应用程序的根 splitViewController 派生的弹出控制器中的导航控制器。这是 < iOS 5.1 上的问题

![UIPopoverController 的框架覆盖其内容的导航栏](../Images/9b97b8bdfba71bc40ec0c110b8f2440f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T22:11:07.457

解决方案是`UINavigationBar`在`UIPopoverController`. 准备好后我会发布实现。

更新

所以这是一个有趣的问题。iOS 4.x 和 iOS 5.0 使用了一个真正的、真正的弹出框，即浮动弹出框。自定义导航栏在此弹出窗口中不起作用（`navBar setBackgroundImage`在 iOS 5.0 和 iOS 4.x 中的类别`drawRect`覆盖）。

然而，5.1 使用了更多的“幻灯片”，自定义导航栏可以很好地工作。它实际上是一个更清洁的设计。

无论如何，我的观点是，现在我只需要在纵向且操作系统小于 5.1 时删除自定义导航栏格式。通常，您希望使用`respondsToSelector`它来代替手动确定操作系统版本。在这种情况下这不起作用。

仍在处理 iOS 4.x 修复，但这里是 iOS 5.0：

在`appDelete`我设置自定义导航栏的地方：

```
//iOS 5.x:
if ([self.navigationController.navigationBar respondsToSelector:@selector(setBackgroundImage:forBarMetrics:)])
{
    UIImage *image = [UIImage imageNamed:@"header.png"];
    [self.navigationController.navigationBar setBackgroundImage:image forBarMetrics:UIBarMetricsDefault];
}

//iOS 4.x:
@implementation UINavigationBar (CustomBackground)
- (void)drawRect:(CGRect)rect
{   
    UIImage *image = [UIImage imageNamed:@"header.png"];
    [image drawInRect:CGRectMake(0, 0, 320, 44)];
}
@end 
```

我在以下位置设置了一个观察者`didFinishLaunching`：

```
//start orientation notifications
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(didRotate:)
                                             name:@"UIDeviceOrientationDidChangeNotification"
                                           object:nil];
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications]; 
```

```
- (void) didRotate:(NSNotification *)notification
{
    float version = [[[UIDevice currentDevice] systemVersion] floatValue];

    if (version < 5.1)
    {
        UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation];

        if (UIDeviceOrientationIsPortrait(orientation))
        {
            if ([self.navigationController.navigationBar respondsToSelector:@selector(setBackgroundImage:forBarMetrics:)])
            {
                [self.navigationController.navigationBar setBackgroundImage:nil forBarMetrics:UIBarMetricsDefault];
            }
        }
        else
        {
            if ([self.navigationController.navigationBar respondsToSelector:@selector(setBackgroundImage:forBarMetrics:)])
            {
                UIImage *image = [UIImage imageNamed:@"header.png"];
                [self.navigationController.navigationBar setBackgroundImage:image forBarMetrics:UIBarMetricsDefault];
            }
        }
    }
} 
```

# ruby - 在 ruby 中编写一个 DSL 方法，该方法将创建一个带参数的方法

> ID：11959726
> 
> 赞同：2
> 
> 时间：2012-08-14T19:50:30.443
> 
> 标签：ruby, metaprogramming, jruby, dsl

我正在尝试为后台工人类编写 DSL，但我在尝试完成某些事情时有点卡住了。

理想情况下，我应该能够写一个像下面这样的工作人员......

```
job :job_name do |param1, param2|
  puts param1
end 
```

现在，在我的工人超类中，我正在做这样的事情......

```
class Worker
  def self.job(job_name, &block)
    define_method job_name do
      # stuck
    end
    # do some additional stuff here
  end
end 
```

我**想要**做的是定义一个可以访问在原始作业调用中使用的块参数的方法，所以我可以通过以下方式启动这个作业：

```
Worker.new.job_name(param1, param2) 
```

创建的方法在功能上应该等同于：

```
def job_name(param1, param2)
  puts param1
end 
```

这有任何意义吗？希望这里有人能指出我正确的方向。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T20:02:15.413

你是否在寻找这样的东西：

```
class Worker
  def self.job(job_name, &block)
    define_method job_name, &block
    # do some additional stuff here
  end
end

Worker.job(:my_job) do |a,b| 
  puts "Called #{__method__} with param <#{a}> and <#{b}>"
end

#~ What I want to do is define a method that has access to the block arguments that were used in the original job call, so I could fire this job off with:
Worker.new.my_job(:param1,:param2) #-> Called my_job with param <param1> and <param2> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:05:06.430

像这样的东西？

```
class Worker
  def self.job(job_name, &block)
    define_method job_name, block
  end
end

Worker.job("foo"){ |x,y| puts "#{x} + #{y}" }
Worker.new.foo(1,2) # => 1 + 2 
```

# c++ - 我可以在类声明中使用前面的值吗？

> ID：11959730
> 
> 赞同：1
> 
> 时间：2012-08-14T19:50:55.617
> 
> 标签：c++, class, declaration

这可以出现在类声明中，还是我不使用`#define`常量会冒问题的风险`sNumInts`？

```
 static const int sNumInts = 15;
    std::array<int,sNumInts> myInts; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:52:42.963

这是完全合法的。`sNumInts`是一个积分常数表达式 (ICE)，可以在编译时使用机器（包括模板元编程）进行操作和创建。但是，一个的简单创建就像您定义的那样。

# excel-2010 - 在 VB.NET 中读取大型 excel 文件很慢。

> ID：11959731
> 
> 赞同：1
> 
> 时间：2012-08-14T13:09:08.080
> 
> 标签：excel-2010, vb.net

我不知道标题是否正确 - 因此允许编辑使其正确。

问题 - 使用 Vb.net 代码，当我使用连接字符串和 sql 查询读取 100,000 条记录的 excel 文件时，需要 3 分钟（对我来说太长 - 我想要一个解决方案，请）完成。

但是，当我提交另一个包含 300,000 条记录的 excel 文件时（我的要求是读取 5000 万条记录） - 花费的时间超过 30 分钟（我无法容忍并杀死了该程序）

请帮助我理解这种差异以及为什么需要这么长时间才能阅读。

（我没有提供任何代码示例，因为网上有成千上万的此类示例代码可用于说明如何建立与 Excel 文件（Office 2010）的连接以及如何运行查询以读取记录）

提前感谢您的帮助和时间。作为一种解决方案，我想将 300,000 条记录文件切割成每个 10,000 条记录的文件 - 但是，如何在不浪费打开和阅读时间的情况下做到这一点？

萨比亚

PS - 在 Windows Server 2008 和 Windows 7 中使用 core 2 duo 和 8 GB RAM

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T13:53:37.313

[![在此处输入图像描述](../Images/9dcc4af0fda0a08a174f9598ddd4f796.png)](http://poi.apache.org/)

* * *

所以，我不使用 vb.net，但如果您熟悉 java，我可以建议您使用[Apache POI](http://poi.apache.org/)库。POI 将所有数据加载到内存中，对于我的情况，它运行良好，之后您可以将其存储到 mysql 或其他任何东西，我用 poi 读取了一百个文件，这对我很有帮助。 [在这里](https://stackoverflow.com/q/4085517/1063509)，我找到了一个与您的问题相似的问题。[在这里](https://stackoverflow.com/questions/2498536/poi-performance)
您可以找到 POI 性能讨论。

另一种解决方案是将 excel 文件导出到 csv 并在此之后读取它，我认为它也会很快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T14:28:55.903

*   加载 Excel 后，您可以暂时禁用宏运行。
*   内存限制是另一个原因，因为 excel 可能会使用大量内存。如果我正在运行这个大型电子表格（100K）单元格，我会将内存库耗尽到 16GB）。
*   确保对 excel 文件和硬盘进行碎片整理（您可以看到真正的影响）。
*   如果从不关闭 PC，请尝试关闭并重新启动。这可以解放进程以卸载未使用的 dll。
*   将 pagefile.sys 的大小至少增加到 RAM 的 2.5 倍，以便顺利进行数据事务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T16:52:19.330

我在更新大型 excel 文件时遇到了类似的问题。我的解决方案 - 更新它的一部分，关闭，终止 excel 进程，重新打开，再次更新

```
 oexcel.DisplayAlerts = False
        obook.SaveAs(fnExcNew, 1)
        obook.Close()
        obook = Nothing
        KillExcel()
        oexcel = CreateObject("Excel.Application")
        oexcel.Workbooks.Open(fnExcNew)
        obook = oexcel.ActiveWorkbook
        osheet = oexcel.Worksheets(1)

Private Sub KillExcel()
    ' Kill all excel processes 
    Dim pList() As Process
    Dim pExcelProcess As System.Diagnostics.Process
    pList = pExcelProcess.GetProcesses
    For Each pExcelProcess In pList
        If pExcelProcess.ProcessName.ToUpper = "EXCEL" Then
            pExcelProcess.Kill()
        End If
    Next
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-16T06:33:06.350

1.  石川问，如果 vb.net 是必不可少的——我的回答是肯定的，因为它是用 VB.Net Framework 4.0 编写的应用程序的一部分。他还谈到了将 excel 导出到 csv 并尝试 - 但是，我担心，如果打开和阅读需要这么多小时，（花了 9 小时！！） - 转换将无济于事。用户将终止该进程 - 我敢肯定。

2.  Soandos 要求查询 - 它是 - “从 excel 文件中选择前 1*” - 我正在一一阅读。我认为，问题不在于这个查询，因为这个查询可以很好地读取 100,000 条记录。

3.  KronoS 支持 Soandos，我已经在上面回答了。对于他/她的第二点，答案是 - 我必须拥有 excel 作为 - 这是用户提供的。我无法改变它。

4.  我看不出谁回答了这个问题——但禁用宏的想法——是一个很好的观点。我不应该禁用所有宏，所有过滤器并取消隐藏所有 - 以简单的方式读取所有数据吗？我会试试的。

300,000 条记录的 Excel 文件的总大小为 61 MB - 它不是很大！制造内存问题？

我发现在excel中简单读取记录的速度并不是线性的。它在 4 秒内读取 10,000 条记录，但在 27 秒内读取 50,000 条，在 60 秒内读取 100,000 条等。我希望 - 如果有人能告诉我如何索引 Excel 文件以读取大文件。当我得到一个 5000 万行的 excel 文件时，我不知道问题的大小是多少？

# powershell-ise - Powershell 调试事件 -Action 代码块

> ID：11959738
> 
> 赞同：3
> 
> 时间：2012-08-14T19:51:43.830
> 
> 标签：powershell-ise

我有脚本在特定目录中监视文件创建。我在创建 System.IO.FileSystemWatcher 后使用 Register-ObjectEvent，

它工作得很好，但是如果我在 -Action 代码块中设置断点，IDE 会生成：

警告：'D:\My Stuff\Desktop\scripts\fileWatcher.ps1:15' 上的断点行断点不会被命中

此消息在我将文件放入我正在观看的目录后立即发生，并且我可以看到我的 Write-Host 在上述“警告”之后立即打印出我的消息。

这是正常的吗？
我需要添加更多代码并且可以真正使用调试器。我应该怎么做，这样我才能调试这个代码块？

```
$fsw = [System.IO.FileSystemWatcher] $path

Register-ObjectEvent -InputObject $fsw –EventName Created -SourceIdentifier DDFileCreated -Action { 
    $name = $Event.SourceEventArgs.Name 
    $changeType = $Event.SourceEventArgs.ChangeType 
    $timeStamp = $Event.TimeGenerated 
    Write-Host "The file '$name' was $changeType at $timeStamp" -fore green 
    Out-File -FilePath $logFile -Append -InputObject "The file '$name' was $changeType at $timeStamp"
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T19:42:23.963

如果您从同一 ISE 或控制台会话中的直接 powershell 命令触发事件，它实际上可以工作：

```
$path = (Resolve-Path '~\').Path
if(Test-Path "$path\newfile.txt"){ del "$path\newfile.txt" }

$fsw = [System.IO.FileSystemWatcher] $path

Register-ObjectEvent -InputObject $fsw –EventName Created -SourceIdentifier DDFileCreated -Action { 
    $name = $Event.SourceEventArgs.Name  # put breakpoint here, via ISE or script
    $changeType = $Event.SourceEventArgs.ChangeType 
    $timeStamp = $Event.TimeGenerated 
    Write-Host "The file '$name' was $changeType at $timeStamp" -fore green 
}

'foo' | out-file "$path\newfile.txt"   # breakpoint hit 
```

但是，如果您只是连接事件并等待某个外部进程创建文件，我会看到您遇到的问题。

因此，如果您可以添加一些测试代码来直接触发您的事件，那就去吧。

如果没有，请继续阅读...

**当 shell 或 ISE等待新命令**时，您似乎无法进入调试器，您只能**在另一个命令正在执行时**进入。

按照这个理论，这是解决方法（对我有用）：

1.  设置断点
2.  运行您的事件订阅代码
3.  在 ISE 控制台窗口中运行命令“Read-Host”，或从 shell 提示符中运行
4.  等到你知道你的事件应该由于外部进程而被触发
5.  点击“enter”以允许 Read-Host 完成

中提琴，断点命中！

# c# - 如何从加载的程序集 C# 中获取抽象类型？

> ID：11959743
> 
> 赞同：0
> 
> 时间：2012-08-14T19:52:11.580
> 
> 标签：c#, reflection, runtime, abstract, .net-assembly

是否可以在运行时从给定的程序集中获取抽象类型？

我目前正在加载我的程序集：

```
Assembly assem = Assembly.LoadFrom("MyAssemblyName.dll"); 
```

但后来我想这样做：

```
Type t = assem.GetType("Enterprise.Shared_Party_PersonType"); 
```

我的班级定义为：

```
public abstract class Shared_Party_PersonType 
```

但是类型 t 返回 null。

我的最终目标是使用反射导航一个抽象类并获取该抽象类的属性列表，类似于他们在这里所做的：[access-to-properties-of-abstract-class-with-reflection](https://stackoverflow.com/questions/7191402/access-to-properties-of-abstract-class-with-reflection)

任何帮助将不胜感激。

**解决方案：**原来我加载了错误版本的 DLL，它不包含我试图加载的抽象类型。但是，现在我知道您可以像任何其他具体类型一样使用反射来导航和操作抽象类型。`Assembly.RefelectionOnlyLoadFrom`由于@Fuex，我还了解了在仅反射上下文中加载程序集的方法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:52:59.630

是的，您可以获得任何类型，甚至是接口。只需确保指定它的全名，包括命名空间：

```
Type t = assem.GetType("SomeNamespace.AnAbstractClassName", true); 
```

完整示例：

```
using System;
using System.Reflection;

namespace SomeNs
{
    public abstract class Foo
    {

    }
}

public class Program
{
    static void Main()
    {
        var asm = Assembly.GetExecutingAssembly();
        var type = asm.GetType("SomeNs.Foo", true);
        Console.WriteLine(type);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:51:00.840

也许您的类是在其他类中定义的。在这种情况下，您必须使用`+`（加号）而不是`.`（点）。像这样：

```
assem.GetType("OutermostNamespace.InnerNamespace.Enterprise+Shared_Party_PersonType") 
```

where`Enterprise`是内部定义的“外部”类或结构`Shared_Party_PersonType`。

否则，您可以访问 MyAssemblyName.dll 的源代码吗？然后您可能会尝试查看`string n = typeof(Shared_Party_PersonType).FullName`那里返回的内容，以检查类型名称是否真的是您所假设的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T20:34:22.930

> 我只需要递归地检查抽象类型属性以提取满足某些条件的绑定路径。

如果`Assembly.LoadFrom()`您只需要检查类型信息，最好的解决方案是使用`Assembly.ReflectionOnlyLoadFrom()`.

所以试试：

```
Assembly asm = Assembly.ReflectionOnlyLoadFrom("mypath");
Type t = asm.GetType("FullName"); 
```

# asp.net - 如何从我的 GridView 将参数传递给 Crystal Report？

> ID：11959744
> 
> 赞同：1
> 
> 时间：2012-08-14T19:52:25.457
> 
> 标签：asp.net, .net, crystal-reports, webforms

我有一个现有的 SQL 数据库和一个 ASP.NET 应用程序。我的应用程序有两个现有`GridViews`和登录功能。我还有一个现有的 Crystal Report，旨在自动从我的 SQL 数据库创建收据。这是通过用户填写 3 个特定参数来完成的，其余数据（与这些参数并行）将自动填写水晶报表。

我想在我的创建一个打印按钮`GridView`来自动填写水晶报表中的3个参数。这是使我的应用程序更加用户友好的尝试。简而言之，用户只需在 中的新列中按下打印按钮`GridView`，这 3 个参数就会被自动拾取并填充到 Crystal Report 中。

我的参数是：“EmpID”、“KeyControl”和“ControlNumber”。我的水晶报表标签是“x.rpt”

这是我的`GridView`标记：

```
<asp:GridView ID="gridKeyAndBuildingInformation" runat="server"  CssClass="style3" 
              AllowSorting ="True" 
              AutoGenerateColumns ="False" 
              AllowPaging="True"
              DataKeyNames="KeyRefId"
              OnRowCancelingEdit="gridKeyAndBuildingInformation_RowCancelingEdit" 
              onPageIndexChanging="gridKeyAndBuildingInformation_PageIndexChanging"
              OnRowDataBound="gridKeyAndBuildingInformation_RowDataBound"
              OnRowEditing="gridKeyAndBuildingInformation_RowEditing" 
              OnRowUpdating="gridKeyAndBuildingInformation_RowUpdating" 
              OnRowCommand="gridKeyAndBuildingInformation_RowCommand" 
              ShowFooter="True"
              OnRowDeleting="gridKeyAndBuildingInformation_RowDeleting"                                    
              AlternatingRowStyle-BackColor="#EFEFEF" 
              EditRowStyle-VerticalAlign="Top" 
              HeaderStyle-BackColor="#77b218"
              OnSorting="gridKeyAndBuildingInformation_Sorting" 
              BackColor="#CCCCCC" 
              BorderColor="#999999" 
              BorderStyle="Solid" 
              BorderWidth="3px" 
              CellPadding="4" 
              EnableModelValidation="True" 
              ForeColor="Black" 
              CellSpacing="2">
<Columns>

<asp:TemplateField HeaderText ="EmpID" HeaderStyle-CssClass="HeaderText" sortexpression="EmpID">
    <ItemTemplate>                     
    <asp:Label ID="lblEmpID" runat="server" Text='<%# Eval("EmpID") %>'></asp:Label>
</ItemTemplate>
<EditItemTemplate> 
    <asp:TextBox ID="txtEmpID" runat="server" Text='<%# Eval("EmpID") %>' Width="50px"></asp:TextBox> 
</EditItemTemplate> 
<FooterTemplate> 
    <asp:TextBox ID="txtNewEmpID" runat="server"  Width="50px"></asp:TextBox> 
</FooterTemplate> 
<HeaderStyle CssClass="HeaderText" />
</asp:TemplateField>

<asp:TemplateField HeaderText ="ControlNumber" HeaderStyle-CssClass="HeaderText" sortexpression="ControlNumber">
<ItemTemplate>                     
    <asp:Label ID="lblControlNumber" runat="server" Text='<%# Eval("ControlNumber") %>'></asp:Label>
</ItemTemplate>
<EditItemTemplate> 
    <asp:TextBox ID="txtControlNumber" runat="server" Text='<%# Eval("ControlNumber") %>' Width="50px"></asp:TextBox> 
</EditItemTemplate> 
<FooterTemplate> 
    <asp:TextBox ID="txtNewControlNumber" runat="server"  Width="50px"></asp:TextBox> 
</FooterTemplate> 
<HeaderStyle CssClass="HeaderText" />
</asp:TemplateField> 

<asp:TemplateField HeaderText ="KeyNumber" HeaderStyle-CssClass="HeaderText" sortexpression="KeyNumber">
<ItemTemplate>                     
    <asp:Label ID="lblKeyNumber" runat="server" Text='<%# Eval("KeyNumber") %>'></asp:Label>
</ItemTemplate>
<EditItemTemplate> 
    <asp:TextBox ID="txtKeyNumber" runat="server" Text='<%# Eval("KeyNumber") %>' Width="50px"></asp:TextBox> 
</EditItemTemplate> 
<FooterTemplate> 
    <asp:TextBox ID="txtNewKeyNumber" runat="server"  Width="50px"></asp:TextBox> 
</FooterTemplate> 
<HeaderStyle CssClass="HeaderText" />
</asp:TemplateField> 

<asp:TemplateField HeaderText="Edit" ShowHeader="False">
<EditItemTemplate>
    <asp:LinkButton ID="LinkButton1" runat="server" CausesValidation="True" CommandName="Update" Text="Update"></asp:LinkButton> 
    <asp:LinkButton ID="LinkButton2" runat="server" CausesValidation="False" CommandName="Cancel" Text="Cancel"></asp:LinkButton> 
</EditItemTemplate> 
<FooterTemplate>
    <asp:LinkButton ID="LinkButton2" runat="server" CausesValidation="False" CommandName="AddNew" Text="Add New"></asp:LinkButton> 
</FooterTemplate> 
<ItemTemplate> 
    <asp:LinkButton ID="LinkButton1" runat="server" CausesValidation="False" CommandName="Edit" Text="Edit"></asp:LinkButton> 
</ItemTemplate> 
</asp:TemplateField> 

<asp:CommandField HeaderText="Delete" ShowDeleteButton="True" ShowHeader="True" /> 
<asp:ButtonField HeaderText="Print" ShowHeader="True" Text="Print" />

</Columns>

<EditRowStyle VerticalAlign="Top"></EditRowStyle>
<FooterStyle BackColor="#CCCCCC" />
<HeaderStyle BackColor="Black" Font-Bold="True" ForeColor="White"></HeaderStyle>
<PagerStyle BackColor="#CCCCCC" ForeColor="Black" HorizontalAlign="Left" />
<RowStyle BackColor="White" />
<SelectedRowStyle BackColor="#000099" Font-Bold="True" ForeColor="White" />
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:09:45.857

您可以处理该`RowCommand`事件，该事件会在您单击`ButtonField`列中的删除按钮时触发。将此添加到`GridView`声明标记的末尾（在“ `CellSpacing="2"`”之后但在“”之前`>`）：

```
OnRowCommand="gridKeyAndBuildingInformation_RowCommand" 
```

然后，在你后面的代码中，你需要这样的东西（这是 C#，如果你需要 VB.NET，请告诉我——这个问题没有用服务器端语言标记）：

```
protected void gridKeyAndBuildingInformation_RowCommand(Object sender, GridViewCommandEventArgs e)
{
    // Get your ID for the row you're on
    int ID = Convert.ToInt32(e.CommandArgument);

    // Get the row the button was clicked in
    GridViewRow row = gridKeyAndBuildingInformation.Rows[ID];

    // Get the values you need from that row
    int EmpID = row.Cells[0];
    int ControlNumber = row.Cells[1];
    int KeyNumber = row.Cells[2]; 

    // Use those numbers to make your call to the Crystal Report
    // I don't know what this part would look like.
} 
```

您可以在 MSDN 上阅读有关 RowCommand 事件的更多信息：[GridView.RowCommand 事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcommand.aspx)

# c++ - STL 是否包含适用于数组的迭代器？

> ID：11959745
> 
> 赞同：1
> 
> 时间：2012-08-14T19:52:31.600
> 
> 标签：c++, arrays, pointers, stl, iterator

我想在指针和静态分配的数组上使用 STL 算法，但它们都需要迭代器。是否有任何迭代器可以采用数组和长度并让我使用它？

PS 我知道`array`C++0x 中的类，但我不想使用它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-14T19:53:59.183

指针*是*随机访问迭代器！您可以简单地传递一个指向数组开头的指针，以及一个指向末尾的指针。像这样的函数（包含在 C+11 中）可能会派上用场：

```
template <typename T, std::size_t N>
T* begin(T(&array)[N]) { return array; }

template <typename T, std::size_t N>
T* end(T(&array)[N]) { return begin(array) + N; } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T19:54:35.413

您可以直接使用数组。例如，

```
int a[5] = .....;
std::for_each( a, ar + 5, someFunctor() ); 
```

# coffeescript - 用于 window.location.search 的 Sinon.JS 存根

> ID：11959746
> 
> 赞同：5
> 
> 时间：2012-08-14T19:52:37.333
> 
> 标签：coffeescript, stubbing, sinon, buster.js

我正在尝试测试一个调用 window.location.search 的简单函数。我试图了解如何存根此调用，以便我可以返回我选择的 url。

功能：

```
getParameterByName: (name) =>    
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]")
  regexS = "[\\?&]" + name + "=([^&#]*)"
  regex = new RegExp(regexS)    
  results = regex.exec(window.location.search) //Stub call to window.location.search
  if(results == null)
    return ""
  else
    return decodeURIComponent(results[1].replace(/\+/g, " ")) 
```

测试用例：

```
describe "Data tests", () ->
  it "Should parse parameter from url", () ->        
    data = new Data()

    console.log("search string: " + window.location.search) //prints "search string:"
    window.location.search = "myUrl"
    console.log("search string: " + window.location.search) //prints "search string:"
    console.log(data.getParameterByName('varName'))

    expect(true).toBe(true) 
```

我最初的尝试是直接返回一个值，如下所示：

```
sinon.stub(window.location.search).returns("myUrl") 
```

这当然行不通。我认为我没有正确指定存根，但它显示了我的意图。

任何有关如何解决此问题的想法将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T15:20:07.233

因此，如前所述，您不能直接模拟 window.location 。mylib.search 包装器的想法也不适用于我的情况。所以，我所做的就是将我的调用`window.location.search`分解为它自己的函数。我的新课程如下所示：

```
getParameterByName: (name) =>
  console.log("name: #{name}")
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]")
  regexS = "[\\?&]" + name + "=([^&#]*)"
  regex = new RegExp(regexS)
  results = regex.exec(@getWindowLocationSearch())
  if(results == null)
    return ""
  else
    return decodeURIComponent(results[1].replace(/\+/g, " "))

getWindowLocationSearch:() =>
  window.location.search 
```

然后在我的测试用例中，我用我的测试代码替换函数，如下所示：

```
describe "Data tests", () ->
  it "Should parse parameter from localhost url", () ->
    goodUrl = "http://localhost:3333/?token=val1"

    Data::getWindowLocationSearch = () -> return goodUrl
    unit = new Data()
    result = unit.getParameterByName("token")

    expect(result).toBe("val1") 
```

对于那些不阅读 Coffeescript 的人，下面列出了等效的 javascript 代码：

```
it("Should parse parameter from localhost url", function() {
  var goodUrl, result, unit;
  goodUrl = "http://localhost:3333/?token=val1";
  Data.prototype.getWindowLocationSearch = function() {
    return goodUrl;
  };
  unit = new Data();
  result = unit.getParameterByName("token");
  expect(result).toBe("val1");
  return expect(true).toBe(true);
}); 
```

就像我平常使用 Javascript 的经验一样。可行的解决方案并不像到达那里的旅程那么痛苦。非常感谢您的评论和贡献。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T20:50:29.660

更新：`window.location`似乎有点特殊，请参阅此讨论：[https ://groups.google.com/forum/?fromgroups#!topic/sinonjs/MMYrwKIZNUU%5B1-25%5D](https://groups.google.com/forum/?fromgroups#!topic/sinonjs/MMYrwKIZNUU%5B1-25%5D)

解决此问题的最简单方法是编写一个包装函数`window.location`，并存根：

```
mylib.search = function (url) {
  window.location.search = url;
}; 
```

在你的测试中：

```
sinon.stub(mylib, 'search').returns("myUrl") 
```

原始答案：

尝试这个：

```
sinon.stub(window.location, 'search').returns("myUrl") 
```

# php - 通过 PHP 连接到 Windows 2008 服务器上的 MySql 数据库

> ID：11959748
> 
> 赞同：0
> 
> 时间：2012-08-14T19:52:49.803
> 
> 标签：php, mysql, windows-server-2008, database-connection

我正在尝试通过我的 php 代码连接到 Windows 2008 服务器上的 MySql 数据库，但是我收到以下错误：

```
Warning: mysql_connect() [function.mysql-connect]: Lost connection to MySQL server at 'reading initial communication packet', system error: 110 in /home/---/---/--/collector.php on line 19
Lost connection to MySQL server at 'reading initial communication packet', system error: 110 
```

这是我的代码：

```
mysql_connect("the.server.net", "mysqluser", "password") or die(mysql_error()); 
```

我在互联网上寻找解决方案，看到了很多关于启用外部连接的建议，但这不是问题，因为我可以通过 MySql Workbench 从另一台计算机进行连接。

我希望有人有任何建议/提示/想法等

# macos - OSX Mountain Lion 上的 Help Indexer.app 在哪里？

> ID：11959749
> 
> 赞同：5
> 
> 时间：2012-08-14T19:52:51.677
> 
> 标签：macos, osx-mountain-lion

OSX Mountain Lion 上的 Help Indexer.app 在哪里，我需要它来创建帮助手册。我安装了 Xcode 但在任何地方都找不到它，在线帮助说它应该在 /Developer/Utilities 但我没有 Developer 文件夹并且找不到要安装的 Developer 应用程序。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-14T23:55:48.767

在 Xcode 4 的应用程序菜单中的“Open Developer Tool”子菜单下，选择“More Developer Tools...”。这会转到一个网站，您可以在其中下载各种软件包。

您想要的包名为“Xcode 辅助工具 - 2012 年 7 月下旬”。

该`/Developer`路径已过时，现在是错误的文档。Xcode 安装此工具后，它将位于 Xcode 的 bundle ( `/Applications/Xcode.app/...`) 下的某个位置，并且可以从 Xcode 应用程序菜单启动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-08-14T09:14:30.837

目前在 Xcode 7.3.1 中，More Developer Tools 链接已损坏。对于那些找不到 Help Indeexer 的人，请转到[https://developer.apple.com/download/more/](https://developer.apple.com/download/more/)并搜索“Xcode 7 的辅助工具”。打开 .dmg 文件后，您可以将 Help Indexer 应用程序复制到您的目录中。

# java - Java 泛型 - 类型擦除？

> ID：11959755
> 
> 赞同：0
> 
> 时间：2012-08-14T19:53:12.783
> 
> 标签：java, generics, type-erasure

如果我有一个扩展 MySuperClass 的子类，并且我有以下泛型类：

```
public class GenericClass<M extends MySuperClass>{

    public void aMethod(M m);

}

public class SubClass1 extends MySuperClass{} 
```

然后我做：

```
SubClass1 sc1 = new SubClass1();

GenericClass<MySuperClass> msc = new GenericClass<MySuperClass>();

msc.aMethod(sc1); 
```

是确定参数化类型是否合法的类型擦除？我认为编译器可以查看`M extends MySuperClass`、查看并确定其合法性——但我不确定类型擦除是否处理了这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:57:24.827

类型擦除是指在编译后删除泛型类型参数和实例化的事实。编译器在编译时检查类型，然后删除所有类型参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T19:55:05.750

编译器是基于代码中的泛型定义确保类型安全的编译器。

[类型擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)会在编译和

> 如果类型参数是无界的，则将泛型类型中的所有类型参数替换为其边界或 Object

.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T20:00:45.213

类型安全是由编译器确保的。类型擦除的唯一工作是擦除泛型部分，以使代码向后兼容在泛型出现在 Java 中之前编写的遗留代码。因此，在擦除生效之前，是编译器确保您的代码在语法上是正确的，无论它是否与泛型相关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T20:03:40.890

当所有类实际上都是“原始”（无类型）时，[类型擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)是一种*运行时人工制品。*

泛型仅在编译期间存在。编译器检查泛型参数是否在界限内，但编译后的字节码没有类型信息。

# java - Java：保持JPanel背景图像的纵横比

> ID：11959758
> 
> 赞同：25
> 
> 时间：2012-08-14T19:53:30.037
> 
> 标签：java, swing, jpanel, background-image, aspect-ratio

我有一个`JPanel`带有绘制背景图像的布局管理器和一个包含其他较小图像的布局管理器，所有这些都在`JFrame`. 背景图像非常大，我希望无论在大显示器还是小显示器上都能保持其纵横比。

最终，我希望能够将`LayoutManager`其单元格中的我和较小的图像“粘合”到背景图片上。

我四处寻找资源，似乎很多示例都使用 a`BufferedImage`但我不是；这会造成问题吗？我将在下面发布我的代码以绘制图像，如果我缺少任何信息，请告诉我。

```
public class MonitorPanel extends JPanel {
    Image img;
    public MonitorPanel() throws MalformedURLException {
        //add components

        try {
            img = ImageIO.read(new File("src/customer_vlans.jpg"));
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }
protected void paintComponent(Graphics g)
{
    //paint background image
    super.paintComponent(g);
    //g.drawImage(img, 0, 0, getWidth(), getHeight(), this);
    g.drawImage(img, 0, 0, this);

}

} 
```

* * *

**编辑：**我应该提到我知道纵横比公式： *原始高度/原始宽度x新宽度=新高度* 但是，我不知道如何正确使用它来发挥我的优势。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-08-14T20:06:17.140

那么，最快和最简单的解决方案是使用`Image.getScaledInstance`

```
g.drawImage(img.getScaledInstance(newWidth, -1, Image. SCALE_SMOOTH), x, y, this); 
```

如果您想知道负数，java 文档会说：

> 如果宽度或高度为负数，则替换一个值以保持原始图像尺寸的纵横比。如果宽度和高度都是负数，则使用原始图像尺寸。

**更新**

就像旁注一样（我的谷歌正在播放）。

`getScaledInstance`不是最快或最高质量的方法，但它是最简单的。

阅读[The Perils of Image.getScaledInstance](https://community.oracle.com/docs/DOC-983611)以获得更多想法

**更新**

缩放图像以适应区域比简单地缩放纵横比稍微复杂一些。您必须选择是否希望图像“适合”该区域（可能在其周围留下空白区域）或“填充”该区域（使其最小尺寸适合该区域的最大尺寸）。

![合身](../Images/7605bc54a67566d718eaee9a41d05671.png)![填](../Images/0df02e748cef9b4c27f52072160a0f51.png)

适合和填充

基本上，我使用比例因子

这将返回特定大小的比例因子。我用它来根据我需要的算法来决定我想使用哪个因素

```
public static double getScaleFactor(int iMasterSize, int iTargetSize) {

    double dScale = 1;
    if (iMasterSize > iTargetSize) {

        dScale = (double) iTargetSize / (double) iMasterSize;

    } else {

        dScale = (double) iTargetSize / (double) iMasterSize;

    }

    return dScale;

} 
```

这两种方法都使用它。他们只需要两个`Dimension`s。原件和目标。

```
public static double getScaleFactorToFit(Dimension original, Dimension toFit) {

    double dScale = 1d;

    if (original != null && toFit != null) {

        double dScaleWidth = getScaleFactor(original.width, toFit.width);
        double dScaleHeight = getScaleFactor(original.height, toFit.height);

        dScale = Math.min(dScaleHeight, dScaleWidth);

    }

    return dScale;

}

public static double getScaleFactorToFill(Dimension masterSize, Dimension targetSize) {

    double dScaleWidth = getScaleFactor(masterSize.width, targetSize.width);
    double dScaleHeight = getScaleFactor(masterSize.height, targetSize.height);

    double dScale = Math.max(dScaleHeight, dScaleWidth);

    return dScale;

} 
```

将图像传入（直接或通过支持方法）相对简单。因此，例如，您可以从您的`paint`方法中调用它

```
double factor getScaledFactorToFit(new Dimension(image.getWidth(), image.getHeight()), getSize());

int scaledWidth = image.getWidth() * scale;
int scaledHeight *= image.getWidth() * scale; 
```

这将自动为您处理纵横比；）

**更新了扩展示例**

```
public double getScaleFactor(int iMasterSize, int iTargetSize) {

    double dScale = 1;
    if (iMasterSize > iTargetSize) {

        dScale = (double) iTargetSize / (double) iMasterSize;

    } else {

        dScale = (double) iTargetSize / (double) iMasterSize;

    }

    return dScale;

}

public double getScaleFactorToFit(Dimension original, Dimension toFit) {

    double dScale = 1d;

    if (original != null && toFit != null) {

        double dScaleWidth = getScaleFactor(original.width, toFit.width);
        double dScaleHeight = getScaleFactor(original.height, toFit.height);

        dScale = Math.min(dScaleHeight, dScaleWidth);

    }

    return dScale;

}

@Override
protected void paintComponent(Graphics g) {

    super.paintComponent(g);

    double scaleFactor = Math.min(1d, getScaleFactorToFit(new Dimension(image.getWidth(), image.getHeight()), getSize()));

    int scaleWidth = (int) Math.round(image.getWidth() * scaleFactor);
    int scaleHeight = (int) Math.round(image.getHeight() * scaleFactor);

    Image scaled = image.getScaledInstance(scaleWidth, scaleHeight, Image.SCALE_SMOOTH);

    int width = getWidth() - 1;
    int height = getHeight() - 1;

    int x = (width - scaled.getWidth(this)) / 2;
    int y = (height - scaled.getHeight(this)) / 2;

    g.drawImage(scaled, x, y, this);

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T20:05:12.887

尝试这样的事情：

```
import java.awt.*;
import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class SG2B2 {

    JFrame frame;

    public static void main(String[] args) {
        SG2B2 gui = new SG2B2();
        gui.createUI();
    }

    public void createUI() {
        frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        MyDrawPanel drawPanel = new MyDrawPanel();
        frame.getContentPane().add(BorderLayout.CENTER, drawPanel);
        frame.setSize(300, 400);
        frame.setVisible(true);
    }

    class MyDrawPanel extends JPanel {

        Image image;
        private final String pic = "Logo.jpg";

        public MyDrawPanel() {
            image = new ImageIcon(pic).getImage();
            image = scaleImage(image);
        }

        @Override
        public void paintComponent(Graphics g) {
            Graphics2D g2 = (Graphics2D) g;
            g2.drawImage(image, 0, 0, this);
        }

        private Image scaleImage(Image rawImage) {
            Image scaledImage = null;
            System.out.println("Scaling");
            try {
                int rawImageWidth = rawImage.getWidth(this);
                int rawImageHeight = rawImage.getHeight(this);
                int paneWidth = (int) getWidth();
                int paneHeight = (int) getHeight();
                System.out.println("Image W = " + rawImageWidth
                        + ", H = " + rawImageHeight
                        + "; Pane W = " + paneWidth
                        + ", H = " + paneHeight);
                // preserve the original ratio  
                float widthRatio = (float) rawImageWidth / (float) paneWidth;
                float heightRatio = (float) rawImageHeight / (float) paneHeight;
                int widthFactor = -1;
                int heightFactor = -1;
                if ((widthRatio > heightRatio) && (widthRatio > 1.0)) {
                    widthFactor = paneWidth;
                } else if ((heightRatio > widthRatio) && (heightRatio > 1.0)) {
                    heightFactor = paneHeight;
                }
                System.out.println("widthRatio = "
                        + String.format("%.3f", widthRatio)
                        + ", heightRatio = "
                        + String.format("%.3f", heightRatio));
                System.out.println("widthFactor = " + widthFactor
                        + ", heightFactor = " + heightFactor);
                if ((widthFactor < 0) && (heightFactor < 0)) {
                    scaledImage = rawImage;
                } else {
                    scaledImage = rawImage.getScaledInstance(widthFactor, heightFactor,
                            Image.SCALE_SMOOTH);
                    // load the new image, 'getScaledInstance' loads asynchronously  
                    MediaTracker tracker = new MediaTracker(this);
                    tracker.addImage(scaledImage, 0);
                    tracker.waitForID(0);
                }
            } catch (InterruptedException ie) {
                System.err.println("load interrupt: " + ie.getMessage());
            } catch (Exception e) {
                e.printStackTrace();
            }
            return (scaledImage);
        }
    }
} 
```

最终将`JPanel`通过使用将图像缩放到 的大小`getScaledInstance(int width, int height, ImageObserver io)`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-14T11:56:21.133

对于任何有兴趣通过 MadProgrammer 修改 PaintComponent 方法的人，如下所示可以更快地更新显示

```
 @Override
        protected void paintComponent(Graphics g) {
            Graphics2D g2d = (Graphics2D) g;
            super.paintComponent(g);

            double scaleFactor = Math.min(1d, getScaleFactorToFit(new Dimension(image.getWidth(), image.getHeight()), getSize()));

            int scaleWidth = (int) Math.round(image.getWidth() * scaleFactor);
            int scaleHeight = (int) Math.round(image.getHeight() * scaleFactor);

            //Image scaled = image.getScaledInstance(scaleWidth, scaleHeight, Image.SCALE_SMOOTH);

            int width = getWidth() - 1;
            int height = getHeight() - 1;

            int x = (width - scaleWidth) / 2;
            int y = (height - scaleHeight) / 2;

            g2d.drawImage(image, x, y, scaleWidth, scaleHeight, this);

        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-02T20:33:09.393

我想出了这个解决方案：

```
public class ImageLabel extends JPanel {

    private Image image = null;

    public void setImage(Image img) {
        image = img;
        repaint();
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);

        if (image != null) {

            int imgWidth, imgHeight;
            double contRatio = (double) getWidth() / (double) getHeight();
            double imgRatio =  (double) image.getWidth(this) / (double) image.getHeight(this);

            //width limited
            if(contRatio < imgRatio){
                imgWidth = getWidth();
                imgHeight = (int) (getWidth() / imgRatio);

            //height limited
            }else{
                imgWidth = (int) (getHeight() * imgRatio);
                imgHeight = getHeight();
            }

            //to center
            int x = (int) (((double) getWidth() / 2) - ((double) imgWidth / 2));
            int y = (int) (((double) getHeight()/ 2) - ((double) imgHeight / 2));

            g.drawImage(image, x, y, imgWidth, imgHeight, this);
        }
    }
} 
```

# c++ - Dynamic_cast：在这种情况下应该被替换

> ID：11959761
> 
> 赞同：2
> 
> 时间：2012-08-14T19:53:34.730
> 
> 标签：c++, state, virtual-functions, dynamic-cast

有一个基类A，它是虚拟的

```
class A
{
  ~virtual A() = 0;
}; 
```

以及更多派生类 B、C、D、E...

```
class B : public A
{
};

class C: public A
{
}; 
```

类似地，对于其他 D、E 类......我们有一个 A 指针列表

```
std::list <A*> a_list; 
```

我们删除任何类型未知的元素，例如

```
A *a = a_list.front(); 
```

基于我们决定的指向对象的类型，要做什么......还有更多的可能性如何做到这一点：

**A) dynamic_cast 案例**

将 a 重铸为派生类型。

```
if (dynamic_cast <B*> (a))
{
   //do something (but nothing with a)
}

else if (dynamic_cast <C*> (a))
{
    //do other (but nothing with a)
} 
```

但是 dynamic_cast 的使用表明设计不好。

**B) 附加属性**

一些额外的属性，例如对象 ID 是 impelemented；

```
class A
{
  virtual ~A() = 0;
  virtual short getID() = 0;
};

class B : public A
{
  virtual short getID() {return 1;}
};

class C: public A
{
  virtual short getID() {return 2;}
}; 
```

所以修改后的条件

```
switch ( a->getID())
{
   case 1: // do something (but nothing with a)
   case 2: // do other (but nothing with a)
} 
```

**一张纸条：**

我们不直接对对象执行任何操作，而是根据其类型进行一些不同的计算。

**问题：**

1）是这样吗，我们什么时候应该避免dynamic_cast？

2）是否有任何优选的解决方案（可能与提出的不同）？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:57:47.167

根据 C++ 编码标准 ( [Amazon](https://rads.stackoverflow.com/amzn/click/com/0321113586) ) 中的第 90 条：避免**类型切换**（无论您是使用`if-else`梯子和`dynamic_cast`，还是`switch`使用函数的语句`getID()`）。**更喜欢通过虚函数**依赖多态性

 **```
class A
{
public:
  ~virtual A() = 0;

  void fun()  // non-virtual
  { 
     // main algorithm here

     // post-processing step
     post_fun();
  }

  virtual void post_fun() = 0;
};

class B : public A
{
public:
   virtual void post_fun() { /* bla */ }
};

class C: public A
{
public:
   virtual void post_fun() { /* meow */ }
};

A* a = a_list.front();
a->fun(); // will be resolved at run-time to whatever type a points to 
```

原因是具有显式类型切换很难维护和更新。如果从 中获得新的派生类`A`，则需要更新循环类型的每个位置。相反，如果您依赖虚函数，编译器会自动为您执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:20:21.487

通常，动态转换是为了让特定类型的对象与它们一起工作。

```
struct base
{
    virtual void a() = 0;
};

struct foo : base
{
    virtual void a() { ... }
    void specificFooMethod();
};

struct bar : base
{
    virtual void a() { ... }
    void specificBarMethod();
};

base * pBase = ...;
pBase->a(); // no casting required here
if ( foo * p = dynamic_cast<foo*>(pBase) )
{
    p->specificFooMethod();
}
else if ( bar * p = dynamic_cast<bar*>(pBase) )
{
    p->specificBarMethod();
} 
```

specific* 方法不是虚拟的，并且不能通过基本接口访问而不进行强制转换。因此，当您确实需要具有无法移动到基类中的抽象层的附加功能/属性的特定类型的对象时，应该使用**dynamic_cast 。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T20:15:31.090

在大多数情况下，当你需要使用任何特定的东西`B`（保持你的命名）时，你应该存储`B *`（或者`shared_ptr<B>`，更确切地说），而不是`A *`. 在所有其他情况下，将所有内容隐藏在多态性后面。

考虑以下层次结构：

```
class Animal 
{
public:
    Animal() {}
    virtual ~Animal() = 0;
    virtual void Breathe();
};

class Bird : public Animal
{
public:
    Bird() {}
    virtual ~Bird() {}
    virtual void Breathe() {...}
    virtual void Fly() {...}
}; 
```

并想象你正在存储`Animal *`s - 你现在不应该打电话`Fly()`。如果您需要调用它，则`Bird *`从头开始存储。但是所有的动物都必须呼吸——这就是为什么函数是从基类继承的。

* * *

总结一下：如果您需要做一些特定的事情`Child`，请将指针存储到`Child`，而不是`Base`。**

# r - R：将正确的日期分配给一天中的时间数据

> ID：11959763
> 
> 赞同：2
> 
> 时间：2012-08-14T19:53:38.273
> 
> 标签：r, date, time

我有日志数据文件，它们只存储一天中的时间以及连续几天的一些数据。

```
 V1       V2
1   11:40:34    1
2   11:52:28    2
3   23:37:19    37
4   23:57:27    38
5   00:17:35    39
6   00:37:43    40
7   00:57:52    41
8   01:18:00    42
9   04:17:03    52
10  17:47:29    18
11  21:29:00    29
12  23:49:58    36
13  00:10:06    37
14  00:30:14    38
15  11:14:39    70
16  18:20:09    1
17  23:28:15    17
18  23:48:24    18
19  00:08:32    19
20  00:28:40    20
21  02:49:38    27
22  08:11:51    43
23  15:14:45    64
24  17:15:34    70 
```

我知道文件创建时的“开始日期”，需要为每一行分配正确的日期。我想出了一种使用循环的方法：

```
data <- structure(list(V1 = structure(
          c(13L, 14L, 21L, 24L, 3L, 6L, 7L, 
           8L, 10L, 17L, 19L, 23L, 2L, 5L, 
           12L, 18L, 20L, 22L, 1L, 4L, 9L, 
           11L, 15L, 16L), .Label = 
           c("00:08:32", "00:10:06", "00:17:35", 
           "00:28:40", "00:30:14", "00:37:43", "00:57:52", "01:18:00", "02:49:38", 
           "04:17:03", "08:11:51", "11:14:39", "11:40:34", "11:52:28", "15:14:45", 
           "17:15:34", "17:47:29", "18:20:09", "21:29:00", "23:28:15", "23:37:19", 
           "23:48:24", "23:49:58", "23:57:27"), class = "factor"), 
            V2 = c(1L, 2L, 37L, 38L, 39L, 40L, 41L, 42L, 52L, 18L, 29L, 36L, 37L, 38L, 
           70L, 1L, 17L, 18L, 19L, 20L, 27L, 43L, 64L, 70L)), .Names = 
           c("V1", "V2"), class = "data.frame", row.names = c(NA, -24L))

startdate <- as.Date("2010-10-14")
data$day <- startdate
k <- 0

for (i in 1:length(data$V1)-1){
  if (as.POSIXlt(paste(startdate,data$V1[i],sep=" ")) > 
      as.POSIXlt(paste(startdate,data$V1[i+1],sep=" "))) 
      k <- k+1
  data$day[i+1] <- startdate + k
} 
```

这给出了所需的结果，然后我可以使用它来创建正确的 POSIXlt 日期列（包括日期和时间）。

```
 V1        V2        day
1   11:40:34    1   2010-10-14
2   11:52:28    2   2010-10-14
3   23:37:19    37  2010-10-14
4   23:57:27    38  2010-10-14
5   00:17:35    39  2010-10-15
6   00:37:43    40  2010-10-15
7   00:57:52    41  2010-10-15
8   01:18:00    42  2010-10-15
9   04:17:03    52  2010-10-15
10  17:47:29    18  2010-10-15
11  21:29:00    29  2010-10-15
12  23:49:58    36  2010-10-15
13  00:10:06    37  2010-10-16
14  00:30:14    38  2010-10-16
15  11:14:39    70  2010-10-16
16  18:20:09    1   2010-10-16
17  23:28:15    17  2010-10-16
18  23:48:24    18  2010-10-16
19  00:08:32    19  2010-10-17
20  00:28:40    20  2010-10-17
21  02:49:38    27  2010-10-17
22  08:11:51    43  2010-10-17
23  15:14:45    64  2010-10-17
24  17:15:34    70  2010-10-17 
```

不过，我想摆脱循环，并感谢任何关于如何做到这一点的“R 风格”的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T21:08:46.267

有点草率，但我认为这可以完成工作。

```
startdate <- as.Date("2010-10-14")
f=as.POSIXlt(data$V1,format='%H:%M:%S')
x=diff(c(0,which(c(f[-length(f)] > f[-1],T))))
y=rep(seq(x),x)-1
as.POSIXlt(paste(startdate+y,data$V1)) 
```

# haskell - 什么是“覆盖条件”？

> ID：11959764
> 
> 赞同：8
> 
> 时间：2012-08-14T19:53:46.153
> 
> 标签：haskell, functional-dependencies

[`State`mtl中的变压器来源](http://hackage.haskell.org/packages/archive/mtl/2.1.2/doc/html/src/Control-Monad-State-Class.html)：

```
-- ---------------------------------------------------------------------------
-- Instances for other mtl transformers
--
-- All of these instances need UndecidableInstances,
-- because they do not satisfy the coverage condition. 
```

什么是“覆盖条件”？我只能说它与 MTPC 和基金组织有关。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-14T20:02:50.407

[GHC 手册的](http://www.haskell.org/ghc/docs/7.0.1/html/users_guide/type-class-extensions.html)第 7.6.3.2 节告诉我们覆盖条件是什么：

> 覆盖条件。对于类的每个函数依赖 ,`tvsleft -> tvsright`中的每个类型变量都`S(tvsright)`必须出现在 中`S(tvsleft)`, 其中`S`是将类声明中的每个类型变量映射到实例声明中的相应类型的替换。

用简单的英语来说，这意味着如果你有一个带有fundeps的类型类，例如：

```
class Convert a b | a -> b where
  convert :: a -> b 
```

您可以定义以下实例：

```
instance Convert String String   -- no type variables
instance Convert [a]    [a]      -- type var a present on both sides
instance Convert (a,b)  a        -- a on the right => a on the left 
```

但*不*包括以下情况：

```
instance Convert String a        -- a only present on the right
instance Convert a      (a,b)    -- b only present on the right 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T20:01:24.427

它是由 Simon Peyton-Jones在[这篇论文中定义的。](http://research.microsoft.com/en-us/um/people/simonpj/papers/fd-chr/jfp06.pdf)定义 7 定义`Coverage Condition`。我会引用确切的定义，但唉，我不知道如何在这里重现数学符号。

# javascript - 转换列表 到客户端 ASP.NET MVC 上的 Json 数组

> ID：11959770
> 
> 赞同：1
> 
> 时间：2012-08-14T19:54:02.577
> 
> 标签：javascript, jquery, asp.net-mvc

我在服务器上有一个字符串列表，我将其发送到部分视图。

```
List<string> list = new List<string>();
list.Add("1");
list.Add("2"); 
```

在客户端，我将列表转换为 json，如下所示：

```
var stringList = @(Html.Raw(Json.Encode(this.Model.StringList)));
alert(stringList ); 
```

警报回复是：`1,2`我应该得到`["1","2"]`.

关于如何处理这个问题的任何线索？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T19:57:50.903

您要求的是一个简单明了的数组，而不是 json。

除此之外，只需在其周围附加括号：

```
var stringList = [@(Html.Raw(Json.Encode(this.Model.StringList)))];
alert(stringList ); 
```

这适用于数字，但如果您打算将它与真正的字符串值（如单词等）一起使用，您将需要一种不同的方法。目前尚不清楚您是否打算将其与视为字符串的数字一起用作示例。

# shell - 在其他环境中从 shell 脚本运行命令

> ID：11959772
> 
> 赞同：1
> 
> 时间：2012-08-14T19:54:06.453
> 
> 标签：shell

我有一个程序，它的界面非常有限（以前工作过的人没有正确开发），因为它是一些正在建设的研究原型，我不知道我是否可以公开命名它，所以让我们称之为程序**x**。

在我编写执行命令时导出正确的环境变量后`x`，终端提示变为`x`（例如，类似于键入 mysql 时发生的情况）。

现在我必须在运行程序之前做一些初步的活动`x`，在这个程序完成它应该做的事情之后，我必须做一些清理和重新安排东西。另外我需要运行的环境下需要运行几条命令`x`。

我已经编写了代码，如果我将它粘贴到终端中，那么它就可以了，但是如果我运行与 shell 脚本相同的代码，那么它会执行 x，然后不执行以下命令。是否有任何解决方法。

我完全困惑如何做到这一点。任何帮助表示赞赏。如果我说得不够清楚，请告诉我，您需要更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T01:37:08.937

你应该看看[Expect](http://en.wikipedia.org/wiki/Expect "预计")。它可以为您自动执行重复性任务。

如果您确实调查过它，这可能与您需要的类似：

```
#!/usr/bin/expect
spawn bash
set fp [open cmdlist r]
while {[gets $fp line] != -1} {
  expect "\\$"
  send "$line\r"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:56:45.180

否。如果`x`允许您指定要执行的命令，或者如果`x`在通过标准输入输入命令后有某种方式进入交互模式，那么您可以使用其中任何一个。尝试任何其他方式都可能不可靠。

# coldfusion - Coldfusion 从查询中添加变量

> ID：11959773
> 
> 赞同：2
> 
> 时间：2012-08-14T19:54:11.607
> 
> 标签：coldfusion, coldfusion-9

我有一个查询，我正在尝试添加最后输出的各个值。

这是查询

```
<cfloop query="score">
  <cfset scorefinal = score * answerweight>
  <cfif getCategories.surveyidfk eq score.surveyidfk and getCategories.categoryidfk eq score.categoryidfk>
    <cfset result = getcategories.cweight * scorefinal>
    <cfdump var="#result#">
  </cfif>
</cfloop> 
```

此代码输出 1.5 2.5 1.3

我需要一种将这些值添加到另一个变量中的方法，这将允许我最后只显示一个值。

我正在考虑将这些值存储在一个数组中，然后添加数组的元素，但我很确定有一种更快、更简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T19:59:12.500

我很长时间没有使用 ColdFusion，但应该这样做：

```
<cfset finalScore = 0>
<cfloop query="score">
    <cfset scorefinal = score * answerweight>
    <cfif getCategories.surveyidfk eq score.surveyidfk and getCategories.categoryidfk eq score.categoryidfk>
        <cfset result = getcategories.cweight * scorefinal>
        <cfset finalScore = finalScore + result>
        <cfdump var="#result#">
    </cfif>
</cfloop>
<cfdump var="#finalScore#"> 
```

# php - 在 PHP 中使用 AJAX 的最佳方式是什么？

> ID：11959776
> 
> 赞同：0
> 
> 时间：2012-08-14T19:54:42.220
> 
> 标签：php, ajax, twitter, get, lightbox

我正在尝试构建一个类似 Twitter 的 AJAX 功能。我将尝试解释我想要构建的内容。

> 当您访问 Twitter（并且您已登录）并单击 Twitter 名称时，您将获得一个包含有关 Twitter 帐户信息的灯箱。

这是我认为它的工作方式：

当您在链接上进行点击事件时，灯箱会被激活。在同一过程中，将使用连接到该链接的所有数据调用文件。

现在这听起来太容易了，我需要为每个来源制作多个文件吗？什么是最好的文件？XML，PHP 文件与数组只是一个文本文件？

希望有人可以向我解释这个过程是如何工作的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:57:03.217

您可能希望为此使用一个数据库，其中包含有关您的用户的信息。这对您来说可能更容易维护，并且很可能具有更好的性能。

然后，您调用一个文件（无论是 PHP、ASP.Net、Node 还是您喜欢的任何服务器端语言），向该文件提供您感兴趣的用户的 ID（将其作为 HTTP POST 或 GET 变量发送）。

然后，您调用的文件将进入数据库，获取有关您请求的用户的信息，并以合适的格式（例如 JSON 或 XML）返回它。无论您想要了解哪个用户，都将调用相同的文件。

IBM 有[一篇](http://www.ibm.com/developerworks/opensource/library/os-php-jquery-ajax/index.html)关于如何使用 PHP 和 jQuery 构建 Ajax 驱动的 Web 应用程序的文章。不幸的是，他们与数据库交互的方式有些陈旧，现在它更喜欢使用[PDO](http://php.net/manual/en/book.pdo.php)，但除此之外，我相信这对你来说可能是一个很好的起点。

# php - 有没有办法从完整路径中获取文件名？

> ID：11959786
> 
> 赞同：-4
> 
> 时间：2012-08-14T19:55:07.540
> 
> 标签：php, file

> **可能重复：**
> [如何使用 PHP 从完整路径中获取文件名？](https://stackoverflow.com/questions/1418193/how-to-get-file-name-from-full-path-with-php)

文件路径 ：

```
users_gallery/2012/August/14-August-2012/8/Sasasas/b_80.27016000 134489509114 08 2012kites-4v.jpg 
```

我有什么办法可以取出文件名：

```
b_80.27016000 134489509114 08 2012kites-4v.jpg 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:57:42.833

使用 php basename 函数[http://php.net/manual/en/function.basename.php](http://php.net/manual/en/function.basename.php)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-14T19:59:35.290

```
$arr = explode('/', 'users_gallery/2012/August/14-August-2012/8/Sasasas/b_80.27016000 134489509114 08 2012kites-4v.jpg');
$file = $arr[count($arr) - 1];
echo $file; 
```

这应该呼应`b_80.27016000 134489509114 08 2012kites-4v.jpg`

# git - Git自动跟踪目录

> ID：11959787
> 
> 赞同：1
> 
> 时间：2012-08-14T19:55:13.357
> 
> 标签：git, backup

我有一个（别人的）软件，如果在运行时硬关机，它会时不时地通过破坏重要文件来破坏其工作空间。

它已经通过包装脚本调用，所以我对此的回应是（因为工作空间不是*那么*大——小于 100M）`tar -czf backups/workspace_$(date +%f_%R).tar.gz workspace/`在程序运行之前坚持 a。我可以使用这个解决方案（只需要放置一些东西来清理旧的备份），但它似乎不优雅，因为大多数时候这些工作空间几乎没有改变。大多数有问题的文件都是二进制文件。

是的，我知道正确的备份系统是一个“更好”的选择，但我不想为此使用它。

显而易见的解决方案是使用修订控制：git。我只手动使用过 git，所以我对使用这个自动化系统有点不确定

问题1：设置repo后，是

```
git add workspace
git commit -m "backup on `date`" 
```

去做我想做的事？

问题2：有没有更好的方法我没有看到？（不使用大规模备份——我想要一个增量修订控制方案）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:06:27.287

`git add`不会跟踪已删除的文件，如果您还想跟踪已删除的文件，您可以使用`git add -A`. 否则，`git add workspace`+`git commit`将跟踪`workspace`.

您*可以*使用 cron 定期备份更改，这样可以更好地防止数据丢失。您不会丢失应用程序启动时发生的更改，而只会丢失最后 15 分钟/小时/天，具体取决于您用于 cron 的时间间隔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:32:03.340

```
git add -A -- some/dir 
```

将阶段所有修改仅限于某些/目录

# c# - XAML 绑定到静态类

> ID：11959788
> 
> 赞同：0
> 
> 时间：2012-08-14T19:55:18.343
> 
> 标签：c#, wpf, silverlight, xaml

> **可能重复：**
> [访问 XAML 中的静态字段](https://stackoverflow.com/questions/32395/accessing-static-fields-in-xaml)

我有一个静态类，里面有两个静态属性。例如：

```
public static class myStaticClass
{
  public static A a;
  public static B b;
}

public class A
{
  public ObservableCollection<Person> persons;

  public struct Person
  {
    private string mame;

    public string Name
    {
      get; set;
    }
  }
}

public class B
{
  public ObservableCollection<Coord> coords;

  public struct Coord
  {
    private string address;

    public string Address
    {
      get; set;
    }

} 
```

我初始化并填充 myStaticClass.a 和 myStaticClass.b 并且我想要使用列表框绑定属性（a，b），其中包含两个文本框（一个文本框绑定到人名，第二个文本框绑定到地址）。

你能帮我吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:59:22.470

[请参阅此](https://stackoverflow.com/questions/32395/accessing-static-fields-in-xaml)问题中已接受的答案。本质上，您需要`x:Static`在您的 XAML 中使用。

# javascript - 如何在 Django 模板中使用时间选择器小部件？

> ID：11959789
> 
> 赞同：3
> 
> 时间：2012-08-14T19:55:22.433
> 
> 标签：javascript, django, datetime, django-templates, django-widget

我正在开发一个基于 Django 的应用程序，我卡在某个地方，我想在我的数据库中保存用户给出的时间和天数（周一至周日）。

用户将选择一个时间`Time picker widget`或任何其他方式，但它会返回到`07 : 30`格式。

用户还将从任何选择器或任何其他方式（用户可以选择多天）中选择日期，并将其保存到数据库中。

我尝试使用 Django-Model 字段，方法是：

```
timestamp = Models.DatetimeField() 
```

并使用 Django 模型表单传入 Django-template，但它显示了一个文本字段（这没有任何意义）。

如果无论如何都可以获取`13:45`格式和`mon,tue,wed`格式的时间，那么我也可以将其保存到`CharField()`数据库中。

我无法弄清楚上述两种情况的解决方案。最好的选择是什么？

Java脚本应该可以吗？（但我不擅长java脚本）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:09:37.293

要使用小部件，您应该在模型的表单类中指明小部件是什么：

```
from django import forms

class MyModelForm(forms.ModelForm):
    timestamp = forms.DateField(widget=forms.DateInput(attrs={'class':'timepicker'})) 
```

如果您在模型中使用时间戳属性，它的运行方式就像一个基本的 Python 日期时间类，具有许多您可以在其中找到的相同属性。如果时间戳的格式让您感到困扰，您可能会查看 django 用于显示时间和日期时间字段的过滤器：[https ://docs.djangoproject.com/en/dev/ref/templates/builtins/#date](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#date)

我不确定为什么您需要以特定格式保存时间戳；django 的 datetime 字段非常健壮且易于使用。

# iphone - mp3 更改的 AudioStreamer 持续时间

> ID：11959794
> 
> 赞同：0
> 
> 时间：2012-08-14T19:56:03.660
> 
> 标签：iphone, objective-c, ios, xcode, audiostreamer

我正在使用 Matt Gallagher 的 AudioStreamer 从我的服务器流式传输 MP3。我提供的 URL 是指向 MP3 的直接链接，但我也尝试使用 PHP 来提供 MP3 并提供准确的标题信息。

我遇到的问题是 AudioStreamer 对象提供的持续时间发生了变化，它从低开始，在流的进行过程中，它增加了。如何使持续时间与音频文件的整个持续时间完全相同？

有时它会起作用，但更多时候它会改变。谢谢你的帮助。

# javascript - 遍历 DOM 查找哪个元素有焦点

> ID：11959806
> 
> 赞同：0
> 
> 时间：2012-08-14T19:57:03.280
> 
> 标签：javascript, traversal

我知道如何在 jQuery 中做到这一点，但是如何在 Javascript 中做到这一点？

```
 if ((evt.which == arrLeftKey || evt.keyCode == arrLeftKey) && document.getElementById(TopMenuID).getElementsByTagName('a') === document.activeElement) {
                alert("LEFT");
} 
```

上面的 if 语句不起作用，我不确定为什么。没有任何警报。我有一个名为 TopMenuID 的导航栏，如果其中一个标签有焦点，我想在按下左键时提醒 LEFT。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:59:14.103

将其更改为

```
document.getElementById(TopMenuID).getElementsByTagName('a')[0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:09:57.180

`getElementsByTagName('a')`返回一个数组，但您将它与它进行比较，`activeElement`因此两者永远不会相等。

如果你想知道 activeElement 是否在你的菜单中，那么你可以查找 activeElement 的父链，看看你是否遇到了 TopMenuID 元素。

```
function doesContain(item, parent) {
    var obj = item.parentNode;
    while (obj && obj !== document.documentElement && obj.nodeType !== 11) {
        if (obj === parent) {
            return(true);
        }
        obj = obj.parentNode;
    }
    return(false);
}

if ((evt.which == arrLeftKey || evt.keyCode == arrLeftKey) && doesContain(document.activeElement, document.getElementById(TopMenuID) {
    alert("LEFT");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T19:59:55.837

尝试

```
document.getElementById(TopMenuID).getElementsByTagName('a')[0] 
```

# php - 如何使用 php 和 html 在缩略图上创建圆角？

> ID：11959808
> 
> 赞同：1
> 
> 时间：2012-08-14T19:57:10.997
> 
> 标签：php, html

func.php 文件，当图像上传到网站时，它会在其中生成缩略图。我了解如何使圆角以 5 为半径进行圆化，但由于某种原因，我现在很难将圆角合并到我的代码中，请帮助：

```
<?php
function create_thumb($directory, $image, $destination) {
  $image_file = $image;
  $image = $directory.$image;

if (file_exists($image)) {

$source_size = getimagesize($image);

if ($source_size !== false) {

  $thumb_width = 100;
  $thumb_height = 100;

  switch($source_size['mime']) {
    case 'image/jpeg':
         $source = imagecreatefromjpeg($image);
    break;
    case 'image/png':
         $source = imagecreatefrompng($image);
    break;
    case 'image/gif':
         $source = imagecreatefromgif($image);
    break;
  }

  $source_aspect = round(($source_size[0] / $source_size[1]), 1);
  $thumb_aspect = round(($thumb_width / $thumb_height), 1);

  if ($source_aspect < $thumb_aspect) {
    $new_size = array($thumb_width, ($thumb_width / $source_size[0]) * $source_size[1]);
    $source_pos = array(0, ($new_size[1] - $thumb_height) / 2);
  } else if ($source_aspect > $thumb_aspect) {
    $new_size = array(($thumb_width / $source_size[1]) * $source_size[0], $thumb_height);
    $source_pos = array(($new_size[0] - $thumb_width) / 2, 0);
  } else {
    $new_size = array($thumb_width, $thumb_height);
    $source_pos = array(0, 0);
  }

  if ($new_size[0] < 1) $new_size[0] = 1;
  if ($new_size[1] < 1) $new_size[1] = 1;

  $thumb = imagecreatetruecolor($thumb_width, $thumb_height);
  imagecopyresampled($thumb, $source, 0, 0, $source_pos[0], $source_pos[1], $new_size[0], $new_size[1], $source_size[0], $source_size[1]);

  switch($source_size['mime']) {
    case 'image/jpeg':
         imagejpeg($thumb, $destination.$image_file);
    break;
    case 'image/png':
          imagepng($thumb, $destination.$image_file);
    break;
    case 'image/gif':
         imagegif($thumb, $destination.$image_file);
    break;
  }

}

  }
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:02:06.083

此代码看起来像是图像制作过程的一部分
要设置图像样式，您需要处理该文件的输出您是否有为客户端

生成的代码？ 如果是这样，那么给每个人一个班级并使用给它角落`HTML`
`img``CSS`

```
.ui-corner-all { -moz-border-radius: 4px; -webkit-border-radius: 4px; border-radius: 4px; } 
```

# r - 用于分类数据的带有箱线图的散点图矩阵

> ID：11959809
> 
> 赞同：6
> 
> 时间：2012-08-14T19:57:18.427
> 
> 标签：r, statistics

我是[SPLOM的忠实粉丝](http://schamberlain.github.com/2011/03/for-all-your-pairwise-comparison-needs/)

有谁知道可以支持分类数据箱线图的 SPLOM 包？当你有像“性别”这样的列的散点图时，它看起来真的很奇怪

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-14T20:44:22.040

您可以使用该`GGally`软件包，它支持很多功能。

```
require(GGally)
data(tips)
tips.sample <- tips[ ,c("total_bill", "tip", "day")]

ggpairs(tips.sample, upper = list(continuous = "points", combo = "box"), 
                     lower = list(continuous = "points", combo = "box")) 
```

![在此处输入图像描述](../Images/357e9e6fd374b7db0019786ea3cc4a3a.png)

# r - 以文本/表格格式显示 TraMineR (R) 树状图

> ID：11959811
> 
> 赞同：7
> 
> 时间：2012-08-13T17:50:43.490
> 
> 标签：r, cluster-analysis, dendrogram, traminer

我使用以下 R 代码生成带有基于 TraMineR 序列的标签的树状图（见附图）：

```
library(TraMineR)
library(cluster)
clusterward <- agnes(twitter.om, diss = TRUE, method = "ward")
plot(clusterward, which.plots = 2, labels=colnames(twitter_sequences)) 
```

完整的代码（包括数据集）可以在[这里](https://github.com/aronlindberg/VOSS-Sequencing-Toolkit/blob/master/twitter_exploratory_analysis/analyzing_several_twitter_repos.R)找到。

与树状图以图形方式提供的信息一样，以文本和/或表格格式获取相同的信息会很方便。如果我调用对象 clusterward（由 agnes 创建）的任何方面，例如“order”或“merge”，我会使用数字而不是我从中获得的名称来标记所有内容`colnames(twitter_sequences)`。另外，我看不到如何输出在树状图中以图形方式表示的分组。

总结一下：**如何获得文本/表格格式的集群输出，并使用 R 正确显示标签，理想情况下是使用 Traminer/集群库？**

![在此处输入图像描述](../Images/951fdc45a4e3d5c761bebea5863a6bdd.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T13:10:59.850

问题与`cluster`包裹有关。`agnes.object`返回的帮助页面`agnes` （参见[http://stat.ethz.ch/R-manual/R-devel/library/cluster/html/agnes.object.html](http://stat.ethz.ch/R-manual/R-devel/library/cluster/html/agnes.object.html)）指出该对象包含一个`order.lab`组件“类似于`order`，但包含观察标签而不是观察编号。此组件仅在原始观察被标记时可用。

TraMineR 生成的相异矩阵（`twitter.om`在您的情况下）当前不将序列标签保留为行和列名称。要获得`order.lab`组件，您必须手动将序列标签分配为矩阵的`rownames`和。我在这里用TraMineR 包提供的数据进行说明。`colnames``twitter.om``mvad`

```
library(TraMineR)
data(mvad)
## attaching row labels 
rownames(mvad) <- paste("seq",rownames(mvad),sep="")
mvad.seq <- seqdef(mvad[17:86]) 
## computing the dissimilarity matrix
dist.om <- seqdist(mvad.seq, method = "OM", indel = 1, sm = "TRATE")
## assigning row and column labels 
rownames(dist.om) <- rownames(mvad) 
colnames(dist.om) <- rownames(mvad) 
dist.om[1:6,1:6]

## Hierarchical cluster with agnes library(cluster) 
cward <- agnes(dist.om, diss = TRUE, method = "ward")

## here we can see that cward has an order.lab component 
attributes(cward) 
```

那是为了获得`order`序列标签而不是数字。但是现在我不清楚您想要文本/表格形式的哪个集群结果。从树状图中，您决定要在哪里剪切它，即您想要的组数并用 剪切树状图`cutree`，例如`cl.4 <- cutree(clusterward1, k = 4)`。结果`cl.4`是一个向量，其中包含每个序列的集群成员资格，并且您将获得组 1 的成员列表，例如`rownames(mvad.seq)[cl.4==1]`.

或者，您可以使用`identify`方法（请参阅`?identify.hclust`）从图中以交互方式选择组，但需要将参数作为 传递 `as.hclust(cward)`。这是示例的代码

```
## plot the dendrogram
plot(cward, which.plot = 2, labels=FALSE)

## and select the groups manually from the plot
x <- identify(as.hclust(cward)) ## Terminate with second mouse button

## number of groups selected
length(x)
## list of members of the first group
x[[1]] 
```

希望这可以帮助。

# vb.net - 连接字符串和排序 vb.net

> ID：11959825
> 
> 赞同：0
> 
> 时间：2012-08-14T19:58:08.130
> 
> 标签：vb.net, string, sorting, arraylist

我依次有 4 个文本框供用户输入字符串。如果字符串包含逗号，它将被拆分。对于每个字符串，它将用 Dash 与下一个字符串连接。可视化这个问题：

```
Dim str1 = "A1,A2"
Dim str2 = "2,3"
Dim str3 = "4A,4B"
Dim str4 = "7,8" 
```

格式：str1 & "-" & str2 & "-" & str3 & "-" & str4

输出将是（按升序）：

```
{"A1-2-4A-7", "A1-2-4A-8", "A1-2-4B-7", "A1-2-4B-8",
"A1-3-4A-7", "A1-3-4A-8", "A1-3-4B-7", "A1-3-4B-8",
"A2-2-4A-7", "A2-2-4A-8", "A2-2-4B-7", "A2-2-4B-8",
"A2-3-4A-7", "A2-3-4A-8", "A2-3-4B-7", "A2-3-4B-8"} 
```

如果没有逗号，它将被视为单个字符串。

我设法通过以下方式实现了上述结果：

```
Private Sub GenerateString(ByVal str1 As String, ByVal str2 As String, ByVal str3 As String, ByVal str4 As String)
    Dim arr1 As New List(Of String)
    Dim arr2 As New List(Of String)
    Dim arr3 As New List(Of String)
    Dim arr4 As New List(Of String)

    SpliString(str1, arr1)
    SpliString(str2, arr2)
    SpliString(str3, arr3)
    SpliString(str4, arr4)

    Dim arrMain As New ArrayList

    arrMain.Add(arr1)
    arrMain.Add(arr2)
    arrMain.Add(arr3)
    arrMain.Add(arr4)

    Dim listCom As New List(Of String)
    For Each tempList As List(Of String) In arrMain
        If tempList.Count > 0 Then
            If listCom.Count = 0 Then
                listCom.AddRange(tempList)
            Else
                Dim listTemp As New List(Of String)
                listTemp.AddRange(listCom)
                listCom.Clear()
                For Each tempStrMain As String In listTemp
                    For Each tempStr As String In tempList
                        listCom.Add(tempStrMain & "-" & tempStr)
                    Next
                Next
            End If
        End If
    Next

    Return listCom
End Function

Private Sub SpliString(ByVal strToSplit As String, ByRef arrString As List(Of String))
    If Not strToSplit = "" Then
        If strToSplit.Contains(",") Then
            Dim splitArr() As String = strToSplit.Split(",")

            For Each str As String In splitArr
                arrString.Add(str)
            Next
        Else
            arrString.Add(strToSplit)
        End If
    End If
End Sub 
```

现在我的问题是，如何按字符串组对字符串进行排序？例如，如果 str3 是顶部选定的字符串组，它将是：

输出将是（由第三个字符串组）：

```
"A1-2-4A-7", "A1-2-4A-8", "A1-3-4A-7", "A1-3-4A-8", 
"A2-2-4A-7", "A2-2-4A-8", "A2-3-4A-7", "A2-3-4A-8",
"A1-2-4B-7", "A1-2-4B-8", "A1-3-4B-7", "A1-3-4B-8",
"A2-2-4B-7", "A2-2-4B-8", "A2-3-4B-7", "A2-3-4B-8" 
```

如果 str4 是要排序的选定组，则输出：

```
"A1-2-4A-7", "A1-2-4B-7", "A1-3-4A-7", "A1-3-4B-7", 
"A2-2-4A-7", "A2-2-4B-7", "A2-3-4A-7", "A2-3-4B-7",
"A1-2-4A-8", "A1-2-4B-8", "A1-3-4A-8", "A1-3-4B-8",
"A2-2-4A-8", "A2-2-4B-8", "A2-3-4A-8", "A2-3-4B-8" 
```

使用 DataTable、ArrayList、IComparer 之类的任何方法？而且，有没有更好的方法来重写 GenerateString 代码？如果代码足够动态以支持 n 个输入（目前我将其硬编码为 4），那就更好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:36:26.820

这是我第一次尝试回答您的问题。不幸的是，它还不是动态的。它使用 LINQ 及其交叉连接功能来获得您的答案。

```
 Private Sub btnMiscTest_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnMiscTest.Click
    Dim str1 As String = "A1,A2"
    Dim str2 As String = "2,3"
    Dim str3 As String = "4A,4B"
    Dim str4 As String = "7,8"

    'Add the strings into a list
    Dim multiString As New List(Of String)
    multiString.Add(str1)
    multiString.Add(str2)
    multiString.Add(str3)
    multiString.Add(str4)

    Dim resultStrings As List(Of String) = GenerateString(multiString, 3)
  End Sub

  Private Function GenerateString(ByVal multiString As List(Of String), ByVal sortIndex As Integer) As List(Of String)
    'Split each string into a list of strings and add it to a "StringOfStrings" list
    Dim tmpStringOfStrings As New List(Of List(Of String))
    For Each tmpString As String In multiString
      Dim tmpSubString As List(Of String) = tmpString.Split(",").ToList
      tmpStringOfStrings.Add(tmpSubString)
    Next
    'Use LINQ to do a Cross Apply and sort by index
    Dim resultList As List(Of String) = (From s0 As String In tmpStringOfStrings(0) _
                                         From s1 As String In tmpStringOfStrings(1) _
                                         From s2 As String In tmpStringOfStrings(2) _
                                         From s3 As String In tmpStringOfStrings(3) _
                                         Order By If(sortIndex = 0, s0, _
                                                  If(sortIndex = 1, s1, _
                                                  If(sortIndex = 2, s2, s3))) _
                                         Select s0 & "-" & s1 & "-" & s2 & "-" & s3).ToList
    Return resultList
  End Function 
```

# jquery - jQuery jqGrid 中的日期格式

> ID：11959828
> 
> 赞同：0
> 
> 时间：2012-08-14T19:58:18.703
> 
> 标签：jquery, date, jqgrid, date-format

我有一个日期字段在 JSON 中显示为“2012 年 8 月 13 日 12:58:29” 我正在使用 jqGrid 3.7.2 并且无法升级。我需要在 colModel 中调整什么以启用日期格式这种格式的客户端“08/14/2012”？

我尝试使用： formatter: 'date', formatoptions: { srcformat: '', newformat: ''}

但我无法为 srcformat 和 newformat 找到正确的组合。它总是很奇怪。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:08:38.667

您使用非常糟糕的日期格式`"August, 13 2012 12:58:29"`作为 jqGrid 的输入。建议在服务器和客户端之间发送的良好日期格式是某种语言独立格式和区域独立格式，例如`2012-08-13T15:58:29Z`（参见[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)）。

另一个问题是 jqGrid 3.7.2 不支持`'F'`格式（或实现中的错误）。可以将[DateFormat](https://github.com/tonytomov/jqGrid/blob/master/js/jquery.fmatter.js#L124-255)的代码和[parseDate](https://github.com/tonytomov/jqGrid/blob/master/js/grid.base.js#L82-142)的代码与 jqGrid 3.7.2 的对应代码进行对比。如果您要更新 jqGrid 3.7.2 副本中的函数代码，则应该解决您的问题（例如，请参阅我的一些错误报告：例如[此处](http://www.trirand.com/blog/?page_id=393/bugs/formatter-g-is-not-supported-in-local-searching/#p27070)和[此处](http://www.trirand.com/blog/?page_id=393/bugs/dateformat-works-wrong-if-the-source-format-contains-j-n-f-m-a-or-a/#p26323)）。

PS：如果您以后想收到有关您的问题的答案，您应该开始[“接受”](https://meta.stackexchange.com/a/5235/147495)答案。只需单击一下即可完成您需要做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-28T09:48:23.670

我通过手动更改 jquery.jqgrid.src.js (4.5.2) 解决了日期字段的 NaN/NaN/NaN 问题。就我而言，json 响应将返回“ISO1860Long”中的日期。它曾经工作到 4.1.2 jqgrid 版本

搜索“parseDate”函数；转到以下行：

```
if( opts.masks.hasOwnProperty(format) ) { format = opts.masks[format]; }
if(date && date != null) { 
```

如果检查并添加以下内容：

```
if(date.constructor === Number) {
  if(String(format).toLowerCase() == "u") {
    date = date*1000;
  }
  timestamp = new Date(date);
} else 
```

在现有的之前：

```
if( !isNaN( date - 0 ) && String(format).toLowerCase() === "u") { 
```

如果需要，您可以自己将更改转换为 jquery.jqgrid.min.js

# internet-explorer - IE 的模式和 JQuery $.tmpl() 渲染有什么问题

> ID：11959829
> 
> 赞同：0
> 
> 时间：2012-08-14T19:58:31.453
> 
> 标签：internet-explorer, jquery, quirks-mode, ie8-compatibility-mode

我发现 JQuery 的 $.tmpl() 渲染在不同的浏览器中差别很大。主要是 IE 版本。当下面的代码放置在更新面板中时，它会引发该`.appendTo("#divList");`方法的错误。

对此有什么解决方法 - 下面的代码示例

Mozilla：成功

IE浏览器模式（IE9 Compat View），文档模式（IE9标准）：SUCCESS

IE浏览器模式（IE9），文档模式（IE9标准）：SUCCESS

IE浏览器模式（IE8），文档模式（IE9标准）：SUCCESS

IE浏览器模式（IE7），文档模式（IE9标准）：SUCCESS

IE浏览器模式（*），文档模式（IE8标准）：FAIL（无渲染）

IE浏览器模式（*），文档模式（IE7标准）：FAIL

IE浏览器模式（*），文档模式（Quirks模式）：FAIL

```
<head runat="server"> 
 <meta http-equiv="X-UA-Compatible" content="IE=8;FF=3;OtherUA=4" /> 
 <script src="http://code.jquery.com/jquery-latest.min.js"></script>
 <script src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script> 

<script type="text/javascript"> 

    $(function () {

        var a = [
            { actor: 'hanks', film: 'yo mama' },
            { actor: 'banks', film: 'men can swim' },
            { actor: 'will', film: 'men can swim' },
            { actor: 'jlo', film: 'ooogh aah' },
            { actor: 'jlo', film: 'bright yellow shadows' }
        ];

        $('#txDibaba').live("keyup", function () {
            $("#divList").empty();
            $('#PM_tmpl').tmpl(blep(a, 'actor', $(this).val())).appendTo("#divList"); 
        });

    });

    function blep(arr, prop, value) {
        return $.grep(arr, function (item) { return item[prop] == value }); 
    }
</script>
    <script id="PM_tmpl" type="text/x-jquery-tmpl">
    <tr>
        <td style="width:60%;text-decoration:underline;cursor:pointer;">${name}&nbsp; ${strength}&nbsp; ${film}</td>
        <td style="width:200px;"> ${actor} </td> 
    </tr>   
</script> 

<form id="form1" runat="server">

            <input type="text" id="txDibaba" /> 
            <br />

            <div id="divList" style="border:1px solid black; width:400px; padding:2px;"> 

            </div> 

</form> 
```

强制IE9模式有意义吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:30:15.967

我仍然不确定你在问什么，但在这种情况下你的代码被破坏了，而不是 IE。

```
var a = [
    { actor: 'hanks', film: 'yo mama' },
    { actor: 'banks', film: 'men can swim' },
    { actor: 'will', film: 'men can swim' },
    { actor: 'jlo', film: 'ooogh aah' },
    { actor: 'jlo', film: 'bright yellow shadows' }, //<-- get rid of that ,
]; 
```

# android - 如何在android中的另一个imageview之上放置一个imageview

> ID：11959841
> 
> 赞同：23
> 
> 时间：2012-08-14T19:59:45.867
> 
> 标签：android, android-layout, imageview

这是我的布局，到目前为止我尝试过但没有成功

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@color/white">

 <LinearLayout 
    android:id="@+id/lltest" 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:layout_centerHorizontal="true">

        <ImageView 
        android:id="@+id/inside_imageview" 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_marginTop="5dip"
        android:layout_marginBottom="5dip"
        android:src="@drawable/frame"/>

</LinearLayout>

 <ImageView 
        android:id="@+id/outside_imageview" 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_alignTop="@id/inside_imageview"
        android:scaleType="fitXY"/>
</RelativeLayout> 
```

我真正想要的是让我的outside_imageview 位于inside_imageview 之上，并具有精确的高度和宽度......如何通过布局来做到这一点？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-08-14T20:05:20.790

```
 <RelativeLayout
      xmlns:android="http://schemas.android.com/apk/res/android"
      android:layout_width="fill_parent"
      android:layout_height="fill_parent"
      android:background="@color/white" >

    <ImageView
        android:id="@+id/inside_imageview"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginBottom="5dip"
        android:layout_marginTop="5dip"
        android:src="@drawable/frame" />

      <ImageView
         android:id="@+id/outside_imageview"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:layout_alignTop="@id/inside_imageview"
         android:layout_alignBottom="@id/inside_imageview"
         android:layout_alignLeft="@id/inside_imageview"
         android:layout_alignRight="@id/inside_imageview"            
         android:scaleType="fitXY" />
  </RelativeLayout> 
```

`layout_align[Top|Bottom|Left|Right]`in 属性用于根据`RelativeLayout`页边距内各自的 x 和 y 值对齐视图。第二个现在将根据边距`ImageView`与第一个的顶部、底部、左侧和右侧对齐。`ImageView`对齐中忽略填充。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-14T20:13:59.300

[`FrameLayout`](http://developer.android.com/reference/android/widget/FrameLayout.html)是你需要的。您可以简单地合并也是 a 的父布局`FrameLayout`。看看**Android 开发者博客**：[http ://android-developers.blogspot.it/2009/03/android-layout-tricks-3-optimize-by.html](http://android-developers.blogspot.it/2009/03/android-layout-tricks-3-optimize-by.html)

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_gravity="center">

    <ImageView
        android:id="@+id/outside_imageview" 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:scaleType="fitXY"/>

    <ImageView
        android:id="@+id/inside_imageview" 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_marginTop="5dip"
        android:layout_marginBottom="5dip"
        android:src="@drawable/frame" />
</merge> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-14T20:04:41.390

你应该尝试一个`FrameLayout`. 在 FrameLayout 中，每个 Child 都在彼此之上。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-01T09:05:27.477

我试过这种方式，它对我有用，希望它有帮助

```
 <FrameLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:padding="5dip">
<ImageView
    android:id="@+id/image_first"
    android:orientation="vertical"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/imga"/>
<ImageView
    android:id="@+id/imageview"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:src="@drawable/image"/>
</FrameLayout> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-10-25T14:26:37.817

我只使用高程... 0=地板或地下室...大声笑 1=地板 2 10=地板 10 顶部

```
 <ImageView
          android:id="@+id/blog_user_image_gp"
          android:layout_width="match_parent"
          android:layout_height="200dp"
          android:layout_marginTop="70dp"
          android:src="@drawable/avatar"
          android:scaleType="fitXY"
          android:foregroundGravity="center"
          android:elevation="10dp"
          />
  <android.support.v7.widget.RecyclerView
        android:id="@+id/users_list"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="80dp"
        android:elevation="1dp"
        android:scrollbars="vertical" /> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-15T06:57:20.397

```
 <RelativeLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:padding="@dimen/_15dp">
                <ImageView
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:padding="@dimen/_10dp"
                    android:layout_marginTop="@dimen/_50dp"
                    android:background="@drawable/white_background"
                   />
                <ImageView
                    android:layout_width="@dimen/_100dp"
                    android:layout_height="@dimen/_100dp"
                    android:background="@drawable/my_credit"
                    android:layout_marginTop="@dimen/_5dp"
                    android:layout_centerHorizontal="true"
                    />
            </RelativeLayout> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-04-15T13:55:19.367

只需添加翻译 z ，它就会在顶部，确保翻译 z 大于您想要位于顶部的视图。回复晚了非常抱歉。

# c# - powerpoint c#插件形状分组问题

> ID：11959849
> 
> 赞同：3
> 
> 时间：2012-08-14T20:00:38.517
> 
> 标签：c#, visual-studio-2010, add-in, powerpoint

我使用 Visual Studio 2010 开发 PowerPoint 2010 加载项，但在将幻灯片上的两个对象分组时遇到了重大问题。我正在尝试创建这两个对象，将它们放在幻灯片上并将它们全部分组在同一个函数中。添加对象并将它们放置在幻灯片上不是问题。但是，当涉及到分组部分时....

我试过了：

```
PowerPoint._Application myPPT = Globals.ThisAddIn.Application;
PowerPoint.Slide curSlide = myPPT.ActiveWindow.View.Slide;
string[] myRangeArray = new string[2];
myRangeArray[0] =  "nameOfShape0";
myRangeArray[1] = "nameOfShape1";
curSlide.Shapes.Range(myRangeArray).Group(); 
```

和

```
PowerPoint._Application myPPT = Globals.ThisAddIn.Application;
PowerPoint.Slide curSlide = myPPT.ActiveWindow.View.Slide;
curSlide.Shapes.Range(Array("nameOfShape0", "nameOfShape1")).Group(); 
```

两者都惨败。我对此感到非常沮丧，并且真的希望某个善良的灵魂为我提供解决方案。谢谢。

更新：这是我正在使用的完整代码：

```
PowerPoint._Application myPPT = Globals.ThisAddIn.Application;
PowerPoint.Slide curSlide = myPPT.ActiveWindow.View.Slide;

PowerPoint.Shape browser = curSlide.Shapes.AddOLEObject(110, 70, 500, 400, "Shell.Explorer.2");
var slideName = "webBrowser_0";
browser.Name = slideName;

PowerPoint.Shape rectangle = curSlide.Shapes.AddShape(Microsoft.Office.Core.MsoAutoShapeType.msoShapeRectangle, 110, 70, 500, 400);
rectangle.Name = "shape2";
string[] myRangeArray = new string[2];
myRangeArray[0] = "webBrowser_0";
myRangeArray[1] = "shape2";
curSlide.Shapes.Range(myRangeArray).Group(); 
```

我收到的错误是“ShapeRange 对象必须包含至少两个项目”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T20:20:17.993

你的代码对我来说很好。试试这个：

```
private void ThisAddIn_Startup(object sender, System.EventArgs e) {
    this.Application.PresentationNewSlide += Application_PresentationNewSlide;
}

void Application_PresentationNewSlide(PowerPoint.Slide Sld) {
    PowerPoint.Shape textBox = Sld.Shapes.AddTextbox(Office.MsoTextOrientation.msoTextOrientationHorizontal, 0, 0, 500, 50);
    textBox.Name = "shape1";
    textBox.TextFrame.TextRange.InsertAfter("This text was added by using code.");

    textBox = Sld.Shapes.AddTextbox(Office.MsoTextOrientation.msoTextOrientationHorizontal, 0, 100, 500, 50);
    textBox.TextFrame.TextRange.InsertAfter("This text was also added by using code.");
    textBox.Name = "shape2";

    PowerPoint._Application myPPT = Globals.ThisAddIn.Application;
    PowerPoint.Slide curSlide = myPPT.ActiveWindow.View.Slide;
    string[] myRangeArray = new string[2];
    myRangeArray[0] = "shape1";
    myRangeArray[1] = "shape2";
    curSlide.Shapes.Range(myRangeArray).Group();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:15:51.773

如果您开始使用的幻灯片布局包含内容占位符或其他可以包含 ole 对象的占位符，则 PPT 可能会将新创建的 OLE 对象弹出到该占位符中。占位符不能与其他形状组合在一起。如果这是问题所在，要么从布局不包含可包含 OLE 对象的占位符的幻灯片开始，要么在创建 OLE 对象之前删除占位符，或者创建 OLE 对象，复制它（给你一个不包含在占位符中的 OLE 对象），然后删除原始对象。

# actionscript-3 - Adobe Flash AS2 到 AS3？

> ID：11959850
> 
> 赞同：-2
> 
> 时间：2012-08-14T20:00:41.280
> 
> 标签：actionscript-3, flash, actionscript-2

我在 Flash 中制作了一个 AS2 文件（它是一个 NavBar），我正在尝试将其转换为 AS3。我必须对这些脚本进行哪些更改才能转换为 AS3？（有3层脚本）：

**第 1 层：**

```
stop();

home.onRelease = function()
{
getURL("http://www.google.ca", _parent);        
}

maps.onRelease = function()
{
getURL("http://www.google.ca", _parent);    
}

forum.onRelease = function()
{
getURL("http://www.google.ca", _parent);
}

help.onRollOver = function()
{
gotoAndStop(2);     
}

more.onRollOver = function()
{
gotoAndStop(3);     
} 
```

**第 2 层：**

```
stop();

faq.onRelease = function()
{
getURL("http://www.google.ca", _parent);        
}

howtos.onRelease = function()
{
getURL("http://www.google.ca", _parent);
}

edge.onRollOver = function()
{
gotoAndStop(1);     
}

background_1.onRollOver = function()
{
gotoAndStop(1);     
}

forum.onRollOver = function()
{
gotoAndStop(1);     
}

more.onRollOver = function()
{
gotoAndStop(3);     
} 
```

**第 3 层：**

```
stop();

submit.onRelease = function()
{
getURL("http://www.google.ca", _parent);        
}

uwdclan.onRelease = function()
{
getURL("http://www.google.ca", _parent);        
}

edge_2.onRollOver = function()
{
gotoAndStop(1);     
}

background_2.onRollOver = function()
{
gotoAndStop(1);     
}

help.onRollOver = function()
{
gotoAndStop(2);     
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:15:58.603

相当少量的工作：

```
home.onRelease = function()
{
getURL("http://www.google.ca", _parent);        
} 
```

变成：

```
home.addEventListener(MouseEvent.CLICK,function(e:MouseEvent){
    flash.net.navigateToURL(new URLRequest("http://www.google.ca"), "_parent"); 
},false,0,true); 
```

对于翻转，只需替换`MouseEvent.CLICK`为`MouseEvent.MOUSE_OVER`. gotoAndStop 命令可以保持不变

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:12:51.220

您需要使用事件侦听器，（根据发生的情况，删除事件侦听器也可能是个好主意）

你可以用谷歌搜索 as3 甚至听众，但这里是第一页的链接，可以为你节省一些时间[http://www.republicofcode.com/tutorials/flash/as3events/](http://www.republicofcode.com/tutorials/flash/as3events/)

就为您转换代码而言，其他人可能对此感兴趣:)

# python - 文件组织程序

> ID：11959852
> 
> 赞同：1
> 
> 时间：2012-08-14T20:00:46.790
> 
> 标签：python

所以我正在尝试使用 shutil 模块创建一个文件排序程序

```
import glob, shutil, os, time, argparse

src='' 
dest=''
ext=''
extention = ''

def parser():
    parser = argparse.ArgumentParser(description='Grab shell flags')
    parser.add_argument('--src', action="store", dest="src", type=str, default=None)
    parser.add_argument('--dest', action="store", dest="dest", type=str, default=None)
    parser.add_argument('--ext', action="store", dest="ext", type=str, default=None)
    global src 
    global dest
    global ext

def if_parser_fails(source_directory, dest_directory, file_extentions):
    while source_directory is None:
            global src
            src = raw_input('What is the directory you wish to monitor?: ')
    while dest_directory is None: 
            global dest
            dest = raw_input('Where do you wish to move the files?: ')
    while file_extentions is None:
            global extention
            extention = raw_input('Please input the extension(s), seperated by commas, that you wish to use as criteria for sorting: ')

def sorter(source_directory, dest_directory, file_extentions): 
    found = glob.glob('%(src)s./*' % {"src": source_directory})
    ext_list = file_extentions.split(',')
    global moving_files
    moving_files = []
    for i in found:
            (filepath, filename) = os.path.split('%(file)s' % {"file": i})
    for h in filename:
            for j in ext_list:
                    if  j in h:
                            moving_files.append(h)
    else:
            pass

def copy_files(to_move, source_directory, dest_directory):
    for item in to_move:
            full_path = os.path.join(source_directory, item)
            full_path_dest = os.path.join(dest_directory, item)
            shutil.move(full_path, full_path_dest)
            print("%(file)s has been copied to %(dest)s" % {"file": i, "dest": dest_directory})

def log_writer():
    log_path = os.path.join(dest, 'log.txt')
    write_time = time.asctime()

    with open(log_path, 'ab') as logfile:
            logfile.write('%(filename)s has been moved \n %(time)s \n \n' % {"filename": filename, "time": write_time})
    print file(log_path).read()

def main():
    parser()
    if_parser_fails(src, dest, ext)
    sorter(src, dest, extention)
    copy_files(moving_files, src, dest)
    log_writer()
if __name__ == "__main__":
    main() 
```

但是shutil不断提出错误：

```
 shutil.Error: `S` and `S` are the same file 
```

我相信这与输入和输出目录以某种方式没有被赋值有关。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:09:10.813

没有完整的回溯很难说，但它看起来像这个段：

```
for i in found:
        (filepath, filename) = os.path.split('%(file)s' % {"file": i})
for h in filename:
        for j in ext_list:
                if  j in h:
                        moving_files.append(h) 
```

您只使用最后一个文件名，并将该文件名的单个字符附加到移动文件中。

而是尝试：

```
for i in found:
        (filepath, filename) = os.path.split('%(file)s' % {"file": i})
        for h in filename:
                for j in ext_list:
                        if  j in h:
                                moving_files.append(h) 
```

# security - 使用 htaccess 重定向子域并保留 URL

> ID：11959853
> 
> 赞同：1
> 
> 时间：2012-08-14T20:00:47.940
> 
> 标签：security, .htaccess, redirect, ssl, subdomain

我已经搜索过，虽然我发现很多线程都关闭了，但没有一个是我正在寻找的......

在我的网站上，比如说 example.com，我创建了子域 secure.example.com

该子域将具有 SSL。

我想要做的是将请求重定向到[https://secure.example.com/path/](https://secure.example.com/path/)到 www.example.com/path/，同时保持 url 显示为[https://secure.example.com/path/](https://secure.example.com/path/)

请注意 subdomain.example.com 的目的是用于 SSL，因此上面的重定向需要与 SSL 一起使用

我想在 htaccess 中使用其他一些重定向：1）将非 www 重定向到 www 忽略子域（因此 secure.example.com 不会变成 www.secure.example.com） 2）将 /index.php 重定向到/ 3) 最后但同样重要的是，在secure.example.com 上强制使用SSL

此外，购物车软件还有额外的 htaccess 功能和 SEO 语句，如下所示。

## 我当前的根 htaccess：

```
# Prevent Directoy listing 
Options -Indexes

# Prevent Direct Access to files
<FilesMatch "\.(tpl|ini|log)">
 Order deny,allow
 Deny from all
</FilesMatch>

# Turn Rewrite Engine On
RewriteEngine On

## index.php to root
Options +FollowSymlinks
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /index\.php\ HTTP/
RewriteRule ^index\.php$ http://www.example.com/ [R=301,L] 

## non-www to www ignore subdomains
RewriteCond %{HTTP_HOST} ^example.com [NC] 
RewriteRule ^(.*)$ http://www.example.com/$1 [R=301,L]

RewriteRule ^sitemap.xml$ index.php?route=feed/google_sitemap [L]
RewriteRule ^googlebase.xml$ index.php?route=feed/google_base [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !.*\.(ico|gif|jpg|jpeg|png|js|css)
RewriteRule ^([^?]*) index.php?_route_=$1 [L,QSA] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T04:02:58.393

好吧，特别是`https://secure.example.com/path/`对于显示在 找到的内容的 url `http://www.example.com/path/`，您可以做 2 件事。最好的情况是，如果这 2 个域是从同一个文档根目录提供的：

> 它们位于同一主机和同一文档根目录上。子域实际上是根设置下带有子域的子文件夹。在我的主机的帮助下，我们现在可以正确解析并安装 SSL。

子目录可能有问题，因为它可能无法*从*自己的文档根目录中重写。例如：

*   **域**-> 文档根目录
*   **www.example.com** -> /path/to/htdocs
*   **secure.example.com** -> /path/to/htdocs/secure

如果您有一个 .htaccess 文件`/path/to/htdocs/secure`来重写对`https://secure.example.com/`. 这里的问题是您需要重写到父目录，而 apache 不会让您这样做。如果是相反的方式，您可以重写对`http://www.example.com/`to 的请求`/secure`。此外，如果两个域具有相同的文档根，您也可以重写。但如果安全是 www 的文档根目录的子目录，则不是。

> 我的主机说安装了 mod_proxy。我的 Apache 配置显示这些已安装： proxy_module (static) proxy_connect_module (static) proxy_ftp_module (static) proxy_http_module (static) proxy_ajp_module (static) proxy_balancer_module (static)

这意味着您至少可以使用`P`rewrite 标志将请求发送到 mod_proxy，因此您可以执行以下操作：

```
RewriteEngine On
RewriteRule ^path/$ http://www.example.com/path/ [L,P] 
```

在secure.example.com 的文档根目录中的htaccess 文件中。那只会专门代理 URI `/path/`，而不是类似`/path/foo/bar.html`. 如果您想要以 开头的所有内容`/path/`，那么您可以匹配它：

```
RewriteRule ^path/(.*)$ http://www.example.com/path/$1 [L,P] 
```

* * *

如果存在重定向问题，您可能需要`ProxyPass`改用：

```
ProxyPass / http://www.example.com/
ProxyPassReverse / http://www.example.com/ 
```

除了重写位置标头之外，它做同样的事情，因此重定向也被代理。

# image - 为什么基于图像的 itemRenderer 总是可见的？

> ID：11959854
> 
> 赞同：1
> 
> 时间：2012-08-14T20:01:03.513
> 
> 标签：image, actionscript-3, apache-flex, itemrenderer

给定以下代码：

```
<mx:DataGridColumn dataField="ongoing" id="ongoing" headerText="" width="20">
    <mx:itemRenderer>
    <mx:Component>
            <mx:Image source="logo.jpg" visible="false" />
        </mx:Component>
    </mx:itemRenderer>
</mx:DataGridColumn> 
```

为什么图像总是可见？我知道 data.ongoing 总是被设置为“False”，而且我知道图像正在获取此信息。据我所知，这甚至不应该与它有任何关系，但我以前对 Flex 的框架感到惊讶。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:09:16.193

这很可能是因为 Flex 回收其 itemrenderer 以节省内存。这[是之前提出的类似问题](https://stackoverflow.com/questions/4971455/weird-behaviour-checkboxes-as-itemrenderer-within-flex-datagrid-flex-3/4971867#4971867)。

我要做的是覆盖 set data 方法以将图像的可见值设置为应有的值。

# php - php脚本超过垃圾收集？

> ID：11959856
> 
> 赞同：1
> 
> 时间：2012-08-14T20:01:17.173
> 
> 标签：php, memory-management, sitemap

我正在编写一个脚本来为具有约 700k 产品的电子商务网站创建站点地图。电子商务包已经有一个内置的站点地图生成器，但它的格式不适合大型产品数据库（带有 gzip 压缩 50k url 文件的链接的主数据库）。

我在运行脚本时遇到了内存管理问题，似乎脚本超过了 php 的垃圾收集能力。这是我所拥有的：

```
function buildSitemapFile()
{
    // prep sitemap string
    $content = "sitemap header info";

    $max_entries_per_sitemap = 50000;
    $current_batch = 0;

    while (buildSitemapZip($current_batch, $content, $max_entries_per_sitemap))
    {
        $current_batch++;
    }

    // finish sitemap string, open/create file, write to it, close file

}

function buildSitemapZip($batch, &$main_content, $max_urls = 50000)
{
    $file_name = *create file path string*

    // add this file to the index file's content string
    $main_content .= *this sitemap info*

    // open and prep this batch's site map file
    $handle = fopen($file_name, "w");

    $content = *sitemap header info*

    require_once('path_to_Product.class.php');
    $product = new Product();

    $group_size = 1000;

    // on first time called, $group_start = 0 (0 * 50000), group_start loops till >= 50000 ((0+1) * 50000), and group_start increments by $group_size on each pass 
    for ($group_start = $batch * $max_urls; $group_start < ($batch + 1) * $max_urls; $group_start += $group_size)
    {
        // request the next group of products. the query ends with "order by id limit $group_start, $group_size"
        $prods = $product->query_db_for_products($group_start, $group_size);

        // loop product set adding urls to the content string
        foreach($prods as $key => $prod)
        {
            $content .= *get info from product object to fill out the sitemap content string*
        }       

        if (count($prods) != $group_size)
        {
            // end of list
            $return_val = *stop looping*
            break;
        }
    }

    // complete sitemap string, write it to file, close file
    // create and open gzip file, write to it, close it, erase temp sitemap file

    return $return_val;
} 
```

当我使用较小的 $group_size 值运行脚本时，它似乎不是这样的问题，但它非常慢并且开始减慢对数据库的访问（通过重复查询）。

eccomerce 包的对象上没有 __destruct 方法的 __construct。

我上次运行测试时 $group_size 为 10k（应该是 1k...），并且内存使用失控。我停止了脚本，但内存使用量（根据 top shell 命令）不断增加，几个小时后还没有发布。

关于脚本可能会导致问题的任何想法？

# c# - 尝试对 WebSphere MQ Queue 进行原子更新

> ID：11959857
> 
> 赞同：1
> 
> 时间：2012-08-14T20:01:22.510
> 
> 标签：c#, queue, websphere, atomic

我正在尝试更新 WebSphere Queue atomic 并遇到以下问题：一旦调用 _outPutQueue.Put() 方法，就会引发 MQ 异常，简​​单地说“MQRC_FUNCTION_NOT_SUPPORTED”。发生这种情况是因为我将方法调用包装在 using (CommittableTransaction) 块中。如果我在块之外进行方法调用，它工作正常。这仅仅是在 C# 中写入队列的限制吗？

```
 using (CommittableTransaction transScope = new CommittableTransaction())
 {
      CommittableTransaction.Current = transScope;

      try
      {                        

          foreach (string agentItem in qSqlContents.Values)
          {
                // Define a WebSphere MQ message, writing some text in UTF format
                MQMessage mqMessage = new MQMessage();
                mqMessage.Write(StrToByteArray(agentItem));

                // Specify the message options
                MQPutMessageOptions pmo = new MQPutMessageOptions();

                // MQC.MQPMO_SYNCPOINT = provide transaction support for the Put.
                pmo.Options = MQC.MQPMO_SYNCPOINT;

                // Put the message on the queue
                _outputQueue.Put(mqMessage, pmo);
          }                       
       }
       catch (Exception)
       {
          transScope.Rollback();                        
       }
       finally
       {
          transScope.Commit();                        
       }
 } 
```

此处要求提供完整的异常信息：

```
MQRC_FUNCTION_NOT_SUPPORTED
Exception | System.Exception
     base {object} | object 
Non-Public members | 
     _COMPlusExceptionCode = -532459699 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:36:37.707

试试这个，有一些调整通常会加快速度，不是 100% 肯定这会解决你的问题，但它可以帮助我诊断它......

```
// Specify the message options
MQPutMessageOptions pmo = new MQPutMessageOptions();

// MQC.MQPMO_SYNCPOINT = provide transaction support for the Put.
pmo.Options = MQC.MQPMO_SYNCPOINT;
CommittableTransaction transScope = new CommittableTransaction();
CommittableTransaction.Current = transScope;    

try
{                            
    foreach (string agentItem in qSqlContents.Values)
    {
        // Define a WebSphere MQ message, writing some text in UTF format
        MQMessage mqMessage = new MQMessage();
        mqMessage.Write(StrToByteArray(agentItem));

        // Put the message on the queue
        _outputQueue.Put(mqMessage, pmo);
    }                       
}
catch (Exception)
{
    transScope.Rollback();                        
}
finally
{
    _outputQueue.close();
    transScope.Commit(); 
    transScope.Dispose();                       
} 
```

# c# - 在 Tumblr 上创建博客文章时 OAuth 失败（不断收到 401/未授权）

> ID：11959863
> 
> 赞同：3
> 
> 时间：2012-08-14T20:01:56.507
> 
> 标签：c#, .net, oauth, tumblr

在尝试创建[新博客帖子](http://www.tumblr.com/docs/en/api/v2#posting)时，我不断收到来自 Tumblr 的 401/未授权。

这是我从网卡捕获的 HTTP 流量序列：

从客户到 Tumblr：

> POST /v2/blog/topictastic.tumblr.com/post HTTP/1.1
> Authorization: OAuth oauth_consumer_key="s83rTQBomoPtl66AT0hEScmYM0QYdhlbW0sa5sRIojgeGOcAUr", oauth_nonce="9313743", oauth_signature_method="HMAC-SHA1", oauth_timestamp="1344973847", oauth_token="kw5NdFnuJ8CLC4cMOMJ4YsKXtOApdw6IcSoPJlF5GZgHaWo9zy" , oauth_version="1.0", oauth_signature="FLStmGNNdfhQysKDtcKSWFBY%2F%2F4%3D"
> 内容类型：application/x-www-form-urlencoded
> 主机：api.tumblr.com
> 内容长度：130
> 预期：100-继续
> 连接：活着

来自 Tumblr 的回复：

> HTTP/1.1 100 继续

从客户到 Tumblr：

> type=quote"e=Taking+Input+in+C%2b%2b+without+Library+Functions&source=http%3a%2f%2fstackoverflow.com%2fquestions%2f11959696%2f

来自 Tumblr 的回复：

> HTTP/1.1 401 未授权
> 日期：2012 年 8 月 14 日星期二 19:50:56 GMT
> 服务器：Apache
> P3P：CP="ALL ADM DEV PSAi COM OUR OTRo STP IND ONL"
> 变化：接受编码
> X-Tumblr-Usec：D =293868
> 内容长度：60
> 连接：关闭
> 内容类型：应用程序/json
> {"meta":{"status":401,"msg":"Not Authorized"},"response":[]}

这是我用来生成和发布请求的 C# 源代码：

```
var baseHostName = request.Endpoint.Properties["base-hostname"];
var postUrl = string.Format("http://api.tumblr.com/v2/blog/{0}/post", baseHostName);
using (var wc = new WebClient())
{
    var oauth = new OAuthBase();
    var consumerKey = request.ApplicationProperties["ConsumerKey"];
    var consumerSecret = request.ApplicationProperties["ConsumerSecret"];
    var oauthToken = request.Enrollment.Properties["oauth_token"];
    var oauthTokenSecret = request.Enrollment.Properties["oauth_token_secret"];
    var timestamp = oauth.GenerateTimeStamp();
    var nonce = oauth.GenerateNonce();
    string url, url2;
    var values = new NameValueCollection();
    var type = request.Notification.Properties["type"];
    foreach (var property in request.Notification.Properties)
    {
        if (property.Key.StartsWith(type + "."))
        {
            var tumblrPropertyName = property.Key.Replace(type + ".", string.Empty);
            values.Add(tumblrPropertyName, property.Value);
        }
        else if (!property.Key.Contains("."))
        {
            values.Add(property.Key, property.Value);
        }
    }
    var postUri = new Uri(postUrl);
    var signature = oauth.GenerateSignature(
        postUri,
        consumerKey,
        consumerSecret,
        oauthToken,
        oauthTokenSecret,
        "POST",
        timestamp,
        nonce,
        null,
        out url,
        out url2);
    var urlEncodedSignature = oauth.UrlEncode(signature);
    var authHeader = "OAuth " + url2 + "&oauth_signature=" + urlEncodedSignature + "\"";
    authHeader = authHeader.Replace("&", "\", ").Replace("=", "=\"");
    wc.Headers.Add("Authorization", authHeader);
    try
    {
        wc.UploadValues(postUri, values);
    }
    catch (WebException webException)
    {
        var message = (new StreamReader(webException.Response.GetResponseStream())).ReadToEnd();
        throw new Exception(message, webException);
    }
} 
```

该类`OAuthBase`位于[此处](http://oauth.googlecode.com/svn/code/csharp/OAuthBase.cs)。

在运行此代码时，我确实有一个有效的 oauth_token 和 oauth_token_secret。任何想法这有什么问题？为什么我不断收到 401/未授权？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T17:51:48.400

有同样的问题（但使用 iOS）：我使用的 OAuth 库似乎没有使用 POST Data 字段进行签名。在我另外添加字段**类型**和**标题**作为查询字符串后，OAuth 库使用它们，我能够上传照片/帖子/任何内容。

似乎每个帖子正文字段（二进制数据除外）都需要成为 OAuth 签名的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-04T22:59:10.810

看来您需要更改编码。例如空格应该是“%20”而不是“+”符号！

# bash - 如何在 bash 脚本中使用 uniq -cd 并仅提取计数而不提取行？

> ID：11959867
> 
> 赞同：3
> 
> 时间：2012-08-14T20:02:09.637
> 
> 标签：bash, uniq

我有一个`.sh`文件，它需要一个日志文件并提取数据并制作报告。我想计算弹出错误的总行数的百分比（热门话题）。

到目前为止，我有这个：

```
awk '// {print $4, substr($0, index($0,$9))}' | sort \
                        | uniq -cd | sort -nr | head -n20 > $filename-sr1.tmp 
```

这会输出两列，计数后跟行。

我怎样才能只用计数来进行计算。例如。`count / total_lines = 0.000000`...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T22:23:20.380

这里只使用 awk，尽管输出顺序是任意的，所以您可能希望将其通过管道传递给 sort -n

```
$ cat file
foo
foo
bar
foo
quux
quux
$ awk '{a[$0]++} END{for (i in a) if (a[i]>1) printf "%5.2f%%\t%s\n", 100*a[i]/NR, i}' file
 33.3%  quux
 50.0%  foo 
```

并调整您当前的 awk：

```
awk '{a[$4" "substr($0, index($0,$9))]++} END{for (i in a) if (a[i]>1) printf "%5.2f%%\t%s\n", 100*a[i]/NR, i}'
# or possibly
awk '{s=$4; for(i=9;i<=NF;++i) s=s" "$i; a[s]++} END{for (i in a) if (a[i]>1) printf "%5.2f%%\t%s\n", 100*a[i]/NR, i}' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T21:44:00.637

首先，我希望得到一些类似的输出给你

```
cat text.txt | sort | uniq -cd | sort -nr | head -n20 > output.txt 
```

output.txt 现在看起来像这样：

```
 5 red
      3 orange
      3 blue
      2 green 
```

希望这与您的输出相似？

要获得百分比，请计算原始文件中的行数，然后遍历输出文件中的每一行，并使用 cut 剪掉每个单词/短语计数，并使用 bc 进行总和：

```
total_lines=$(wc -l < text.txt)
while read -r line; do 
    count=$(echo $line | cut -f1 -d " "); 
    percent=$(echo "scale=4; ($count/$total_lines)*100" | bc); 
    echo "$percent% -- $line"; 
done < output.txt; 
```

结果如下：

```
38.4600% -- 5 red
23.0700% -- 3 orange
23.0700% -- 3 blue
15.3800% -- 2 green 
```

# emacs - 在 Auctex 的 LaTeX 模式下为 grep 使用 next-error 和 previous-error 键绑定

> ID：11959870
> 
> 赞同：2
> 
> 时间：2012-08-14T20:02:15.193
> 
> 标签：emacs, latex, grep, auctex

如何浏览`M-x grep`使用`C-x` ```and找到的文本`M-g p`？这些通常绑定到`next-error`and`previous-error`但在 Auctex 的 LaTeX 模式中，它们重新绑定到`TeX-next-error`and `TeX-previous-error`。我曾尝试同时使用`local-set-key`并`global-set-key`重新绑定这些击键，但是这两种方法都不起作用。

MWE：安装 Auctex，制作一个 tex 文件，用 grep 查找某些内容，然后在 tex 缓冲区中尝试上述击键。使用`M-x next-error`将起作用，因此使用`*grep*`缓冲区内的击键也将起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:42:40.817

```
(defun jpk/LaTeX-mode-hook ()
  (local-set-key [remap next-error] nil)
  (local-set-key [remap previous-error] nil))

(add-hook 'LaTeX-mode-hook 'jpk/LaTeX-mode-hook) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-09T08:06:23.587

您可以通过别名`next-error`为您自己的命令名称，`fset`然后在重新绑定中使用它。例如，可以在 emacs 初始化文件 (`init.el`或`.emacs`) 中使用以下内容，以保留`M-g n`绑定 for`next-error`而不删除`TeX-next-error`from `C-x ``：

```
(fset #'afs-next-error #'next-error)
(fset #'afs-previous-error #'previous-error)
(with-eval-after-load "tex"
  (progn
    (define-key TeX-mode-map (kbd "M-g n") #'afs-next-error)
    (define-key TeX-mode-map (kbd "M-g p") #'afs-previous-error))) 
```

# asp.net-mvc-3 - 将更改保存到数据库时出现日期时间错误

> ID：11959873
> 
> 赞同：0
> 
> 时间：2012-08-14T20:02:17.710
> 
> 标签：asp.net-mvc-3, linq, entity-framework-4

我有以下课程

```
public class News
{
    [Key]
    public int NewsId { get; set; }

    [Required(ErrorMessage = "The article title is required.")]
    [MaxLength(50)]
    public string Title { get; set; }

    [Required(ErrorMessage = "The article text is required.")]
    [UIHint("MultilineText")]
    [MaxLength(500)]
    public string Article { get; set; }

    [Display(Name = "Days to Expire")]
    public int DaysToExpire { get; set; }

    public DateTime ArticleDate { get; set; }
} 
```

以及生成的 CRUD 视图页面。这是控制器中用于编辑的代码：

```
 [HttpPost]
    public ActionResult Edit(News news)
    {
        if (ModelState.IsValid)
        {
            db.Entry(news).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(news);
    } 
```

当我尝试编辑记录时，我收到以下错误：

> 将 datetime2 数据类型转换为 datetime 数据类型导致值超出范围。

我将方法更改为

```
[HttpPost]
    public ActionResult Edit(News news)
    {
        if (ModelState.IsValid)
        {
            var prevDate = db.NewsArticles.First(a => a.NewsId == news.NewsId).ArticleDate;

            news.ArticleDate = prevDate;

            db.Entry(news).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(news);
    } 
```

尝试将 ArticleDate 属性设置为它已经存在的值，但收到以下错误

> 该语句已终止。
> 
> ObjectStateManager 中已存在具有相同键的对象。ObjectStateManager 无法跟踪具有相同键的多个对象。

我发现这个[问题](https://stackoverflow.com/questions/4608734/the-conversion-of-a-datetime2-data-type-to-a-datetime-data-type-resulted-in-an-o)是相同的错误（有趣的是，他们也在处理文章）并且它提到该错误是由于使用了 ApplyPropertyChanges。

要添加，在 Edit.cshtml 中，ArticleDate 不作为可编辑字段存在。

帮助表示赞赏。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:20:04.110

通过从数据库中加载，您可以将具有前一个日期的文章附加到上下文中。通过将`news`对象的状态设置为`Modified`您将具有相同键的第二个对象附加到被禁止并导致异常的上下文。

您可以使用：

```
var prevDate = db.NewsArticles
    .Where(a => a.NewsId == news.NewsId)
    .Select(a => a.ArticleDate)
    .First(); 
```

这仅从数据库加载日期，而不是整个对象，因此数据库中的任何实体都没有附加到上下文。

或者您可以使用：

```
[HttpPost]
public ActionResult Edit(News news)
{
    if (ModelState.IsValid)
    {
        var prevNews = db.NewsArticles.First(a => a.NewsId == news.NewsId);

        news.ArticleDate = prevNews.ArticleDate;

        db.Entry(prevNews).CurrentValues.SetValues(news);
        db.SaveChanges();
        return RedirectToAction("Index");
    }
    return View(news);
} 
```

**编辑**

有关您的第一个异常的解释，请查看此问题及其答案：[Using DateTime properties in Code-First Entity Framework and SQL Server](https://stackoverflow.com/q/8043816/270591)

# workflow-foundation-4 - WF 4.0：当 WorkflowApplication 停止空闲时跟踪通知？

> ID：11959874
> 
> 赞同：0
> 
> 时间：2012-08-14T20:02:20.153
> 
> 标签：workflow-foundation-4, workflow-foundation

我有兴趣为任意 WorkflowApplication 实例计时，以查看它们“忙”了多长时间以及空闲了多长时间。

但是，似乎跟踪通知仅在实例变为空闲时生成，而不是在重新激活时生成。

有没有一种简单的方法来获得这样的通知？

更新：

```
 WorkflowApplication wa = new WorkflowApplication(activity);

        var tracker = new ConsoleTrackingParticipant()
        {
            TrackingProfile = new TrackingProfile
            {
                Name = "SampleTrackingProfile",
                ImplementationVisibility = ImplementationVisibility.All                    
            }
        };

        var query = new WorkflowInstanceQuery();
        query.States.Add("*");
        tracker.TrackingProfile.Queries.Add(query);

        var brq = new BookmarkResumptionQuery()
        {
            Name = "*"
        };

        tracker.TrackingProfile.Queries.Add(brq);

        wa.Extensions.Add(tracker);

        wa.Run(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T06:54:13.667

在几乎所有情况下，工作流都会因为创建书签而闲置。为了使工作流程继续进行，必须恢复书签。使用[TrackingParticipant](http://msdn.microsoft.com/en-us/library/system.activities.tracking.trackingparticipant.aspx)，您可以在发生这种情况时收到[BookmarkResumptionRecord](http://msdn.microsoft.com/en-us/library/system.activities.tracking.bookmarkresumptionrecord)。为了接收这些，您需要配置一个[TrackingProfile](http://msdn.microsoft.com/en-us/library/ee513989)并添加一个[BookmarkResumptionQuery](http://msdn.microsoft.com/en-us/library/system.activities.tracking.bookmarkresumptionquery)。

# ruby-on-rails-3 - Rails 3 - 使用 Heroku 时在 Rails 目录中存储和打开 pdf 文件

> ID：11959878
> 
> 赞同：1
> 
> 时间：2012-08-14T20:02:41.907
> 
> 标签：ruby-on-rails-3, heroku

我需要为我的 Rails 应用程序使用一些 pdf 文件。由于它们很少而且不是很重，我将它们保存在我的 Rails 应用程序目录中。例如，如果 1.pdf 文件在 Rails 根目录下，我用`open("#{Rails.root}/1.pdf")`它来打开它。这在本地有效，但是当我推送到 Heroku 时，所有 pdf 文件都会被忽略。我应该把它们放在一个特定的目录中，这样 Heroku 就不会摆脱它们吗？我尝试过使用 Rails root、public 和 app。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T21:43:12.913

原来我已经指定`.slugignore`文件忽略所有 pdf 文件。

# c# - 是否有 C# 静态分析工具用于捕获无法满足功能要求的 API？

> ID：11959880
> 
> 赞同：3
> 
> 时间：2012-08-14T20:02:44.387
> 
> 标签：c#, static-analysis

我最大的烦恼之一是 API 没有做普通用户直觉 API 会做的事情。

典型案例：.NET 的[DateTime.ToUniversalTime](http://msdn.microsoft.com/en-us/library/system.datetime.touniversaltime.aspx)。文档很吓人：

> 在 Windows XP 系统上，从本地时间转换为 UTC 时，ToUniversalTime 方法仅识别当前的调整规则。因此，当前调整规则生效之前的时段转换可能无法准确反映当地时间与 UTC 之间的差异。

后来继续说：

> 在 Windows XP 系统上，ToUniversalTime 方法仅识别本地时区的当前调整规则，它适用于所有日期，包括下级日期（即早于当前调整规则开始日期的日期） . **在 Windows XP 上运行且需要历史准确的本地日期和时间计算的应用程序必须**通过使用 FindSystemTimeZoneById 方法检索与本地时区对应的 TimeZoneInfo 对象并调用其 TimeZoneInfo.ConvertTimeToUtc(DateTime, TimeZoneInfo) 方法来解决此问题。

这必须是有史以来最搞笑的文档句子。谁在使用 ToUniversalTime() 时不需要准确的本地日期和时间计算？为什么不直接用 ObsoleteAttribute 标记这个方法呢？

无论如何，我正在寻找一种工具，我可以用程序集级元数据标记程序集，例如 [RequiresHistoricallyAccurateLocalDateAndTimeCalculationsAttribute]。然后，如果它找到 ToUniversalTime() 的任何实例，将它们标记为编译器错误，就像 C# 不允许我在没有不安全注释的情况下直接访问非托管代码一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T20:15:43.790

这个要求似乎更适合代码分析而不是属性修饰或编译错误。

见： http: [//www.binarycoder.net/fxcop/html/index.html](http://www.binarycoder.net/fxcop/html/index.html)

> 这必须是有史以来最搞笑的文档句子。谁在使用 ToUniversalTime() 时不需要准确的本地日期和时间计算？为什么不直接用 ObsoleteAttribute 标记这个方法呢？

鉴于日期/时间计算的性质/复杂性，这并不是一个特别可怕/令人震惊的启示。

如果我在 Windows XP 或任何其他操作系统上进行 UTC 处理，我会首先熟悉平台的特性，就像我对任何其他复杂操作一样。给定的替代方案 ( `TimeZoneInfo`) 也不是防弹的，因为它高度依赖于平台。

关于`TimeZoneInfo`......我指的是操作系统的平台依赖性。

当您开始使用时区转换（许多与日期相关的问题源于此）时，您可以使用[FindSystemTimeZoneById 之](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.findsystemtimezonebyid)类的方法。从好的方面来说，方法名称清楚地表明您正在使用本地系统（所以它可能比 更不模棱两可`ToUniversalTime()`）。但是，操作系统会查询时区列表，因此操作系统可能会返回一个错误列表（我相信在 Windows 中值存在于注册表中），该列表已过时（可能是修补错误的机器）， ETC。

我注意到 Windows XP 似乎也存在[歧义](http://msdn.microsoft.com/en-us/library/bb382991)问题`TimeZoneInfo`（请参阅“来电者须知”）：

> 在 Windows XP 系统上 (...) 因此，该方法可能无法准确报告当前调整规则生效之前的时间偏移量。有关详细信息，请参阅本地属性中的呼叫者备注部分。

而且（正如您所指出的），底层平台实现可能存在缺陷。

此外，时区由字符串 ID 引用。虽然这些似乎没有太大变化，但仍有可能在应用程序中存储不再匹配时区的“魔术字符串”。

至少这是我发现的，尽管我对这个主题的了解远非详尽无遗。我在 Windows Server 上使用 .Net 和通用时间的经验是积极的。

**My point is that there is usually a good reason why the BCL (base class library) authors implemented things a certain way, even if it *does* lead to unexpected behavior. The alternative would be to omit the functionality altogether.**

If you have identified this as a pitfall, then I think it's commendable that you are taking the time to mitigate it.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:15:09.007

使用 FxCop 工具让自己成为朋友。据我了解，这就是您要寻找的。它是一个静态分析工具，可以使用依赖于 FxCop API 的 C# 代码表示的自定义规则进行扩展。

# android - 在 Manifest 中声明活动时遇到问题

> ID：11959884
> 
> 赞同：0
> 
> 时间：2012-08-14T20:02:58.950
> 
> 标签：android

我有两个项目。test1 是一个库。每当我尝试在 test1 中打开活动时，我都会收到一条错误消息，提示您无法找到显式活动类，您是否在 AndroidManifest.xml 中声明了此活动。这是我正在使用的文件。

test2.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.test2"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activty
        android:name="com.example.test1.OtherActivity"/>
</application>

</manifest> 
```

test2 的 MainActivity.java

```
package com.example.test2;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;

public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    menu.add(Menu.NONE, 1, Menu.NONE, "Go to Library Project");
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    final Intent intent = new Intent(this, com.example.test1.OtherActivity.class);
    startActivity(intent);

    return true;        
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T21:10:40.097

有一个拼写错误

```
<activty
    android:name="com.example.test1.OtherActivity"/> 
```

它应该是

```
<activity
    android:name="com.example.test1.OtherActivity"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:07:39.680

检查此链接，它将向您描述如何添加库项目。我认为您没有将活动添加到其清单中。

[使用 ADT 从 Eclipse 管理项目](http://developer.android.com/tools/projects/projects-eclipse.html#SettingUpLibraryProject)

# c++ - 如何在没有全局变量的情况下访问 A::member()？

> ID：11959885
> 
> 赞同：1
> 
> 时间：2012-08-14T20:02:58.957
> 
> 标签：c++, oop, architecture

在 AI 类中，有一个成员需要每 n 毫秒访问数百或数千次，例如，需要访问 LPDIRECT3DDEVICE3D 才能绘制任何内容。

曾经有一个全球性的，但这似乎不对。在我的研究中，我找到了 OP 问题的答案：

> [jalf](https://stackoverflow.com/users/33213/jalf)：*“这很痛苦，所以这是一个警钟：我做错了。很多对象不需要知道屏幕缓冲区。我该如何解决这个问题？`）”* @[这个答案alinea 8](https://stackoverflow.com/a/4102991/1555816)

基本上我想知道如何对待这样一个全局变量，还有哪些其他选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:26:16.503

一种好的方法是让您都想使用 A::member 的对象在构造时使用数据结构（弱指针或原始指针的向量、指针映射等）注册自己，然后在您想要应用 A 时： :member 到每个对象，您可以遍历所有已注册的对象并处理每个对象的请求。请注意，在这里使用全局变量很容易陷入陷阱——尽量避免它。

如果您有不同类型的对象（没有继承层次结构），您可以使用类型擦除来存储每个对象的函数指针（或函数对象，如 boost::function），该对象将采用 A::member 并将其应用于该对象。这将允许任何抽象对象使用 A::member 而无需知道您的 x 个对象的类型。让函数匹配可能就像向每个对象添加类似格式化的成员函数或执行 boost::bind 以将执行工作的调用包装成匹配的格式一样简单。

这种方法消除了许多样板代码，并为您提供了各种新对象类型的轻松可扩展性，以便在某个指定的通知时间全部使用 A::member。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T23:35:42.443

您的选择归结为：如果函数需要数据，则该数据必须：

1.  作为参数传递给函数，或者
2.  在函数可以有效查询它的地方。

（我将忽略 3\. 或由函数本身生成。）

如果你想通过`A::member`，你有几个选择。您可以将数据放在上下文对象中并传递它（如果您有一些想要传递的这些成员，并且恰好在存在单元测试的情况下运行良好，这可能会很有效）。您可以将数据直接传递到函数中。您可以将数据传递给某些东西，然后再将其传递给函数。您可以使用消息传递。您可以使用更间接的机制，例如发布/订阅队列。您可以选择这些中介对他们传递的数据类型了解多少。当您将数据从一个地方传递到另一个地方时，所有这些都意味着源、传输和目的地之间的各种耦合。充其量这种耦合可能会在规模上令人恼火。在最坏的情况下，这可能是一个严重的设计或安全缺陷。

如果你想把`A::member`它放在可以查询的地方，你也有几个选择。全局变量是 1。可以访问的数据存储（例如文件、数据库、服务、缓存、HTTP 资源）是另一个。其中每一个都有含义：您需要考虑谁可以访问数据以及如何访问。如果访问很容易（例如在全局变量中），那么您将面临如何在不破坏数据客户端的情况下发展系统的问题。在测试代​​码时，您也可能会遇到问题。充其量这种耦合可能会在规模上令人恼火。在最坏的情况下，它可能是一个严重的设计缺陷并导致几乎无法测试的代码。

如果您想传递数据，但您不喜欢需要传递数据的位置数量，那么您的另一个攻击角度是限制需要您的数据的函数的数量。即整合您的代码，以便真正需要了解的代码片段更少`A::member`。Facade、Bridge、Observer 和 Abstract Base Class 等各种模式可能会在语言级别为您提供帮助。发布-订阅和回调等架构模式也可能会有所帮助。研究*解耦*、*重构*和*依赖消除*的主题以获得灵感。

那么这些方法中哪一个是正确的呢？没有一种正确的方法。您需要查看您的特定案例，权衡该案例的选项和权衡，然后选择您最喜欢的一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T08:30:08.853

> 我能想到的一件事是将 A::member 传递给所有需要访问它的函数，但这将是一个荒谬的数量。

有很多方法——它们遍布您每天使用的程序。

*   你可以参考
*   通过参考（如您所述）
*   在某些情况下使用多个实例
*   使用方法抽象出调用方法实际上需要 3 次调用的事实（最少知识原则）
*   使用更小、更专业的对象
*   考虑其他形式的抽象和/或包装
*   在某些地方考虑其他设计模式

刚开始编写程序——不要盲目，因为你最终可能会得到高耦合——观察使用模式并相应地重构和重组。这是全局变量不好的原因之一——它们很难根除，但这几乎是删除具有大量引用的变量时必须经历的过程。

# javascript - 根据选择的选项显示/隐藏不同的表单

> ID：11959889
> 
> 赞同：5
> 
> 时间：2012-08-14T20:03:16.833
> 
> 标签：javascript, forms, show-hide

我想知道如何根据一个表单的选择来显示/隐藏不同的表单。

在下面的示例代码中，所有三个表单都自动设置为 display:none。如果从“淋浴”表单中选择相应的值，我只想显示其中一种“隐藏”表单。因此，如果从“淋浴”表格中选择了选项“表格1”，则在下面显示表格1；如果从“淋浴”表格中选择了选项“表格2”，则显示表格2；等等。

最好带有淡入/淡出动画或其他灯光动画。

这是一个示例...

```
<form id="form-shower">
<select>
<option value="" selected="selected"></option>
<option value="form_name1">Form 1</option>
<option value="form_name2">Form 2</option>
<option value="form_name3">Form 3</option>
</select>
</form>

<form name="form_name1" id="form_1" style="display:none">
<!---- THIS IS FORM 1---->
</form>

<form name="form_name2" id="form_2" style="display:none">
<!---- THIS IS FORM 2---->
</form>

<form name="form_name3" id="form_3" style="display:none">
<!---- THIS IS FORM 3---->
</form> 
```

感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-14T20:10:17.397

您可以使用 jQuery 来帮助您：

```
<form id="form-shower">
<select id="myselect">
<option value="" selected="selected"></option>
<option value="form_name1">Form 1</option>
<option value="form_name2">Form 2</option>
<option value="form_name3">Form 3</option>
</select>
</form>

<form name="form_name1" id="form_name1" style="display:none">
<!---- THIS IS FORM 1---->
</form>

<form name="form_name2" id="form_name2" style="display:none">
<!---- THIS IS FORM 2---->
</form>

<form name="form_name3" id="form_name3" style="display:none">
<!---- THIS IS FORM 3---->
</form>
<script>
$("#myselect").on("change", function() {
    $("#" + $(this).val()).show().siblings().hide();
})
</script> 
```

我在您的选择中添加了一个 id 并更改了您的三个表单的 id 名称:)

希望能帮助到你 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:20:24.003

```
<select>
    <option value="" selected="selected"></option>
    <option value="form_1">Form 1</option>
    <option value="form_2">Form 2</option>
    <option value="form_3">Form 3</option>
</select>

<form name="form_1" id="form_1" style="display:none">
<input type="text" value="1">
</form>

<form name="form_2" id="form_2" style="display:none">
<input type="text" value="2">
</form>

<form name="form_3" id="form_3" style="display:none">
<input type="text" value="3">
</form>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

JS：

```
$("select").on("change", function() {
    $("#" + $(this).val()).show().siblings().hide();
});​ 
```

示例在 [http://jsfiddle.net/dfYAs/](http://jsfiddle.net/dfYAs/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T20:20:33.563

如果您不想使用 jQuery，可以将其添加到 HTML 的顶部：

```
<script>
function changeForm(form) {
  for (var i=0; i<form.length; i++){
    var form_op = form.options[i].value;
    if (form_op == form.value) {
      document.getElementsByName(form_op)[0].style.display = "block";
    }
    else {
      document.getElementsByName(form_op)[0].style.display = "none";
    }
   }
  }
</script> 
```

然后添加`onChange="changeForm(this)"`到您的主窗体。// onChange 不区分大小写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T20:15:51.563

只需将其添加到 HTML 的末尾

```
 <script type="text/javascript">
    $('select').change(function(e){
            $this = $(e.target);
            var selected_form = $this.text().replace(' ','_name');
            $('form').hide(2000, 'easeOutExpo');
            $(selected_form).show(2000, 'easeOutExpo');
        });
    </script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-14T20:13:38.377

做这个

1.  创建函数 javascript 来帮助你完成这项工作，就像这样

```
 function FFF(){
        var opc = document.getElementById("form-shower").value;
        switch(opc)
        {
            'form_name1':
                document.getElementById('form_1').style.display = "block"; // or inline or none whatever
                break;

        }
    } 
```

2.  创建活动

```
<select id='id_selec' onChange='javascript:FFF();'> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-26T00:56:37.713

对于未来的读者，此设置将在没有外部库的情况下动态显示/隐藏这些表单：

```
function changeOptions(selectEl) {
  let selectedValue = selectEl.options[selectEl.selectedIndex].value;
  let subForms = document.getElementsByClassName('className')
  for (let i = 0; i < subForms.length; i += 1) {
    if (selectedValue === subForms[i].name) {
      subForms[i].setAttribute('style', 'display:block')
    } else {
      subForms[i].setAttribute('style', 'display:none') 
    }
  }
} 
```

然后是html：

```
<select onchange="changeOptions(this)">
  <option value="" selected="selected"></option>
  <option value="form_1">Form 1</option>
  <option value="form_2">Form 2</option>
  <option value="form_3">Form 3</option>
</select>

<form class="className" name="form_1" id="form_1" style="display:none">
  <!---- THIS IS FORM 1---->
</form>

<form class="className" name="form_2" id="form_2" style="display:none">
  <!---- THIS IS FORM 2---->
</form>

<form class="className" name="form_3" id="form_3" style="display:none">
  <!---- THIS IS FORM 3---->
</form>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-14T19:23:11.167

```
$(document).ready(function() {
  $("select").change(function() {
    $(this).find("option:selected").each(function() {
      var optionValue = $(this).attr("value");
      if (optionValue) {
        $(".box").not("." + optionValue).hide();
        $("." + optionValue).show();
      } else {
        $(".box").hide();
      }
    });
  }).change();
});
```

```
.box {
  color: #fff;
  padding: 20px;
  display: none;
  margin-top: 20px;
}

.red {
  background: #ff0000;
}

.green {
  background: #228B22;
}

.blue {
  background: #0000ff;
}
```

```
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>jQuery Show Hide Elements Using Select Box</title>

  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
</head>

<body>
  <div>
    <select>
      <option>Choose Color</option>
      <option value="red">Red</option>
      <option value="green">Green</option>
      <option value="blue">Blue</option>
    </select>
  </div>
  <div id="check" class="red box">You have selected <strong>red option</strong> so i am here</div>
  <div id="check" class=" box">You have selected <strong>green option</strong> so i am here</div>
  <div id="check" class="box">You have selected <strong>blue option</strong> so i am here</div>
</body>

</html>
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-08T13:41:28.057

```
$(document).ready(function() {
  $("select").change(function() {
    $(this).find("option:selected").each(function() {
      var optionValue = $(this).attr("value");
      if (optionValue) {
        $(".box").not("." + optionValue).hide();
        $("." + optionValue).show();
      } else {
        $(".box").hide();
      }
    });
  }).change();
});
```

```
.box {
  color: #fff;
  padding: 20px;
  display: none;
  margin-top: 20px;
}

.red {
  background: #ff0000;
}

.green {
  background: #228B22;
}

.blue {
  background: #0000FF;
}
```

```
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>jQuery Show Hide Elements Using Select Box</title>

  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
</head>

<body>
  <div>
    <select>
      <option>Choose Color</option>
      <option value="red">Red</option>
      <option value="green">Green</option>
      <option value="blue">Blue</option>
    </select>
  </div>
  <div id="check" class="red box">You have selected <strong>red option</strong> so i am here</div>
  <div id="check" class="green box">You have selected <strong>green option</strong> so i am here</div>
  <div id="check" class="blue box">You have selected <strong>blue option</strong> so i am here</div>
</body>

</html>
```

# android - 在 Fragment 中加载 RetainFragment

> ID：11959890
> 
> 赞同：1
> 
> 时间：2012-08-14T20:03:33.543
> 
> 标签：android, android-fragments

[您好 Android 开发人员，我遵循Android](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)开发人员的显示图像指南，`RetainFragment`如果我旋转我的设备，我想从 a 加载我的初始化缓存。在我的`ListFragments` `onActivityCreated()`方法中执行此操作，但片段每次都是新创建的而不是重用。

我做这样的事情： **RetainFragment**

```
class RetainFragment extends Fragment {
private static final String TAG = "RetainFragment";
public LruCache mRetainedCache;

public RetainFragment() {}

public static RetainFragment findOrCreateRetainFragment(FragmentManager fm) {
    RetainFragment fragment = (RetainFragment) fm.findFragmentByTag(TAG);
    if (fragment == null) {
        fragment = new RetainFragment();
    }
    return fragment;
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setRetainInstance(true);
} 
```

}

和这个：`ListFragment`

```
@Override
public void onActivityCreated( Bundle savedInstanceState )
{
    super.onActivityCreated( savedInstanceState );

    RetainFragment mRetainFragment = RetainFragment.findOrCreateRetainFragment(getFragmentManager());
    LruCache mMemoryCache = RetainFragment.mRetainedCache;
    if (mMemoryCache == null) 
    {
        mMemoryCache = new LruCache(cacheSize);
        mRetainFragment.mRetainedCache = mMemoryCache;
    }
    else
    {
        mMemoryCache = mRetainFragment.mRetainedCache;
    }
    ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:21:17.583

在我看来，他们忘记了以`RetainFragment`某种方式将其实际附加到`Activity`因此`FragmentManager`有机会找到它。未附加的片段不会在配置更改后继续存在。

不确定是否但它应该与下面的添加一起使用

```
public static RetainFragment findOrCreateRetainFragment(FragmentManager fm) {
    RetainFragment fragment = (RetainFragment) fm.findFragmentByTag(TAG);
    if (fragment == null) {
        fragment = new RetainFragment();
        // add this line
        fm.beginTransaction().add(fragment, TAG).commit();
    }
    return fragment;
} 
```

# javascript - 将数据从 Python 发送到 Javascript (JSON)

> ID：11959895
> 
> 赞同：9
> 
> 时间：2012-08-14T20:03:52.187
> 
> 标签：javascript, python, json

我知道 JSON 可以解决这个问题，但是我在实现它时遇到了问题。这是我的方法的详细信息：

1.  数据是用 Python 计算的
2.  由于数据的大小是动态的，所以我需要使用 JavaScript 为我的输出创建额外的 HTML 表格行。因此，我需要将数据从 Python 传递到 JavaScript 以让 Javascript 来“查看”数据。

HTML 代码（下面是我创建输出页面的 HTML 代码的一部分）：

```
class OutputPage(webapp.RequestHandler):
    def func (a,b):
        return a+b #just an example

    def get(self):
        form = cgi.FieldStorage() 
        chem_name = form.getvalue('chemical_name')
        Para1 = form.getvalue('Para1')  #get values from input page--user inputs
        Para1 = float(Para1)
        Para2 = form.getvalue('Para2')  #get values from input page--user inputs
        Para2 = float(Para2)
        out = func (Para1,Para1)
        out_json=simplejson.dumps(out)  # I need to send out to JavaScript
        #writ output page
        templatepath = os.path.dirname(__file__) + '/../templates/'
        html = html + template.render (templatepath + 'outputpage_start.html', {})
        html = html + template.render (templatepath + 'outputpage_js.html', {})               
        html = html + """<table width="500" class='out', border="1">
                          <tr>  
                            <td>parameter 1</td>
                            <td>&nbsp</td>                            
                            <td>%s</td>
                          </tr>
                          <tr>  
                            <td>parameter 2</td>
                            <td>&nbsp</td>                            
                            <td>%s</td>
                          </tr>                                                      
                          </table><br>"""%(Para1, Para2)
        html = html + template.render(templatepath + 'outputpage_end.html', {})
        #attempt to 'send' Python data (out_json) to JavaScript, but I failed.
        html = html + template.render({"my_data": out_json})  
        self.response.out.write(html)

app = webapp.WSGIApplication([('/.*', OutputPage)], debug=True) 
```

JavaScript 代码（我使用 JavaScript 即时创建附加输入表文件名：'outputpage_js.html'）：

```
<script>
<script type='text/javascript'> 

$(document).ready(function(){
    //I assume if my Json statement works, I should be able to use the following argument to create a HTML row
    $('<tr><td>Parameter 2</td><td>&nbsp</td><td>out_json</td>').appendTo('.app')   

</script> 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-14T20:08:19.643

您不必“实现” JSON，python 带有一个内置库，称为`simplejson`，您可以使用普通的 dicts 来提供它：

```
try: 
  import simplejson as json
except:
  import json
out = {'key': 'value', 'key2': 4}
print json.dumps(out) 
```

**编辑：** 正如 tadeck 所指出的，simplejson*应该*是最新的并且不等于 json，但是有机会，simplejson 不可用，因为它是由外部维护的

**编辑2：** 基于this answer中的讨论和页面上的讨论，我认为最好的方法是这样的：

*Python*

```
# [...] generate dynamic data [...]
html = html + template.render (templatepath + 'outputpage_start.html', {})
html = html + template.render (templatepath + 'outputpage_js.html', {})               
html = html + """<table width="500" class='out' border="1" data-dynamic="%s">""" % json.dumps(your_generated_data_dict)
#tr/td elements and templating as needet
self.response.out.write(html) 
```

*javascript*

```
$(function(){
    var your_generated_table = $('table'),
        dynamic_data = JSON.parse(your_generated_table.attr('data-dynamic'));
}); 
```

然后，您的 python dict 具有与 javascript 对象完全相同的结构。

# android - 虚拟开发环境。可行吗？

> ID：11959899
> 
> 赞同：0
> 
> 时间：2012-08-14T20:04:18.767
> 
> 标签：android, .net, virtual

发现许多类似的问题，他们大多是 2-3yo 和软件/硬件向前推进。

我使用 Microsoft 技术进行开发。环境包括 IIS、SQL Server、Visual Studio 2010 等。我也为 Android 开发，所以我有 JAVA、Android SDK、慢启动模拟器、USB 调试等。

现在是 Wind7，但我可能很快就会迁移到 Windows 8。

我将所有文件保存在服务器上，源代码签入等。但是，为了恢复我的环境，我需要几天时间。

目前我有带有 i7-820 CPU、10G RAM、SSD 的联想 W510，这个系统可以进行开发。现在它坏了，我有 3 天没有工作，直到我让他们修理它。在不同的硬件上重建我的设置也需要很长时间..

我的问题是：我可以在运行虚拟的更强大的桌面硬件上获得相同水平的性能吗？理想情况下，我想要更快的系统。我经常使用 XAML，但我不确定这些图形内容在虚拟环境中如何工作。

有人在虚拟设置上做过类似的开发吗？有什么建议么？明白了吗？

现在我正在考虑这样的事情：

1.  强大的桌面 - 像 Xeon、四核、16Gb 和 RAID0 中的 2 个 SSD（因为我可以备份图像）
2.  如果我需要移动，请保留我的笔记本电脑 - 只需将图像复制过来（我需要很少旅行，因此有必要在我的设置中移动）

这样我会得到*更好*的系统吗？

编辑：

我做了很多 XAML 开发，这行得通吗？从我刚刚发现的情况来看，这似乎是一个问题…… [WPF 开发在 VM 下可行吗？](https://stackoverflow.com/questions/525664/is-wpf-development-feasible-under-vm)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:16:50.783

如果您的最终目标是通过在已备份且易于恢复的虚拟机中完成所有开发工作来减少停机时间，那就去吧。无论如何，您都会遇到一些性能损失，但是对于今天的硬件，我并没有真正遇到任何问题。

我们的优势在于拥有一个几乎所有服务器都被虚拟化的环境，所以接下来我要说的是我们的基础架构支持，但您的基础架构可能不支持：

我们的 IT 人员在我们的 VM 主机上设置了虚拟开发机器，并通过 RDP（远程桌面协议）从我们的工作站（我们在工作时）我们的笔记本电脑（在路上）和我们的家用计算机简单地连接到它们（在家时，有一个深夜支持电话打进来）。如果您有一个可以安全地执行此操作的环境（包括多因素身份验证、有线加密以及所有其他安全问题），这可能是一种选择。

另一种选择可能是使用托管 PC。许多供应商现在都提供虚拟桌面托管，它可以让您在我的环境中享受我所享受的好处，而无需处理开销。但它不是免费的。

我通过在 Google 上搜索“托管 Windows 桌面”找到了其中的一些。

就我个人而言，我使用我的开发 PC 的次数已经数不胜数了，但在过去两年中完全没有。随着时间的推移，我已经了解了哪些类型的东西可以解决问题。（第三方安装等）并采用了设置和使用虚拟 PC 来测试任何风险的策略。

大多数事情我都使用我的普通开发PC，避免冒险行为，并在我即将做有风险的事情时保留虚拟机。

# c++ - 为什么内联函数看不到内部范围？

> ID：11959901
> 
> 赞同：3
> 
> 时间：2012-08-14T20:04:23.310
> 
> 标签：c++

我知道内联函数是其主体插入到调用它们的位置的函数。那么为什么内联函数在被调用时不受范围变化的影响：

```
#include <iostream>

inline void alert(const std::string &str) { cout << str; }

int main() {
    using namespace std;

    alert("Hello World"); // cout << "Hello World";
} 
```

这不起作用，因为我得到了错误`cout was not declared in this scope`，但如果我这样做`std::cout`了。如果内联函数的函数体插入作用域，为什么 C++ 不知道它`cout`是成员？`std`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T20:08:52.637

您描述的行为是一个宏。内联函数是一个常规函数，编译器是否内联它取决于编译器。在范围规则方面，它的行为与任何其他函数完全相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T20:07:58.927

因为它是一个函数，所以它有自己的作用域。使其内联或不内联不会影响这一点。实际上，除了链接之外，对于外部可见的函数， inline 关键字并没有太大变化。编译器可以自由选择是否实际内联代码，内联仅作为建议。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T20:07:58.353

因为 C++ 使用静态范围，而不是动态范围。编译器在定义函数的范围内查找名称，而不是在调用函数的范围内查找名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T20:14:18.880

函数的内联是在链接时完成的。在编译时，C++ 根本不知道函数是否属于某个范围。因此引发了错误。为了不收到此错误 - 好吧，您必须将内联函数改为宏。

# html - 在 ul 标签中垂直对齐按钮

> ID：11959903
> 
> 赞同：0
> 
> 时间：2012-08-14T20:04:30.047
> 
> 标签：html, css

我想垂直对齐按钮。放置在 ul 标记内的是我的代码[http://jsfiddle.net/degHp/](http://jsfiddle.net/degHp/) ...我希望中间按钮垂直居中，并且按钮内的文本垂直居中 ..任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:39:57.143

这就是我所做的。

*   在每个 li 元素上添加`display:block`和`vertical-align:middle`
*   加到`line-height`每一里。这会垂直对齐链接内的文本。
*   将您从小李中删除`margin-top:10px`，因为它不再需要它。

[http://jsfiddle.net/degHp/8/](http://jsfiddle.net/degHp/8/)

# html - 在 SSRS 和报表管理器中将外部样式表附加到 HTML 页面

> ID：11959904
> 
> 赞同：4
> 
> 时间：2012-08-14T20:04:35.533
> 
> 标签：html, css, ssrs-2008, reporting-services, reportmanager

由于某些限制，我编写了一个 HTML 页面，需要在 SSRS 报告管理器中托管。HTML 只是连接到 Style.css 样式表的静态网页的集合。

当我在 SSRS 之外运行页面时，它们工作正常，但是当我在报告管理器中运行它们时，我失去了 HTML 中的样式。我不确定我需要更改什么才能在 SSRS 和报告管理器中工作。

我尝试了逻辑上的东西，它是 SSRS 中 CSS 文件的绝对路径，过程在这里找到：http: [//msdn.microsoft.com/en-us/library/ms345247.aspx](http://msdn.microsoft.com/en-us/library/ms345247.aspx)但我无法工作. 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T13:49:08.680

诀窍是您必须将其指向 ReportServer URL 而不是 Reports URL。请参阅以下示例，该示例演示了 URL 如何更改。前

```
http://<reportserver>/Reports/Pages/Resource.aspx?ItemPath=%2f<folderPath>%2fStyle.css 
```

后

```
https://<reportserver>/ReportServer/Pages/Resource.aspx?%2f<folderPath>%2fStyle.css 
```

作为测试，您可以将其输入浏览器地址栏中，它会向您显示代码，然后您就知道它是正确的。如果没有，那么它将让您下载文件。然后从那里你只需将它放在 HTML 的链接标签中，如下所示。

```
<link href="https://<reportserver>/ReportServer/Pages/Resource.aspx?%2f<folderPath>%2fStyle.css" type="text/css" rel="stylesheet"> 
```

> 请注意，如果您从`(https://<reportserver>/ReportServer/Pages)`页面所在的同一根目录访问它，则可以使用以下简写。

```
<link href="~/Resource.aspx?%2f<folderPath>%2fStyle.css" type="text/css" rel="stylesheet"> 
```

# c++ - OpenMP 和 NUMA 的关系？

> ID：11959906
> 
> 赞同：8
> 
> 时间：2012-08-14T20:04:49.967
> 
> 标签：c++, parallel-processing, openmp, numa, smp

我有一台双插槽 Xeon E5522 2.26GHZ 机器（禁用超线程）在支持 NUMA 的 linux 内核 3.0 上运行 ubuntu 服务器。架构布局是每个插槽 4 个物理内核。OpenMP 应用程序在这台机器上运行，我有以下问题：

1.  在 NUMA 机器 + 感知内核上运行时，OpenMP 程序是否会自动利用（即线程及其私有数据在执行过程中保存在 numa 节点上）？如果没有，可以做什么？

2.  NUMA 和每线程私有 C++ STL 数据结构怎么样？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-15T19:09:12.480

当前的 OpenMP 标准定义了一个布尔环境变量`OMP_PROC_BIND`，用于控制 OpenMP 线程的绑定。如果设置为`true`，例如

```
shell$ OMP_PROC_BIND=true OMP_NUM_THREADS=12 ./app.x 
```

那么 OpenMP 执行环境不应该在处理器之间移动线程。不幸的是，关于这些线程应该如何绑定没有更多的说明，而这正是 OpenMP 语言委员会的一个特殊工作组目前正在解决的问题。OpenMP 4.0 将附带新的环境变量和子句，允许人们指定如何分配线程。当然，许多 OpenMP 实现都提供了自己[的非标准方法来控制绑定](https://stackoverflow.com/a/8325730/1374437)。

大多数 OpenMP 运行时仍然不支持 NUMA。他们很乐意将线程分派给任何可用的 CPU，您必须确保每个线程只访问属于它的数据。在这个方向上有一些一般性的提示：

*   不要`dynamic`对并行`for`(C/C++) / `DO`(Fortran) 循环使用调度。
*   尝试在稍后将使用它的同一线程中初始化数据。`for`如果您运行两个具有相同团队大小和相同迭代块数的单独并行循环，则`static`两个循环的调度块 0 将由线程 0 执行，块 1 - 由线程 1 执行，依此类推。
*   如果使用 OpenMP 任务，请尝试初始化任务主体中的数据，因为大多数 OpenMP 运行时都实现了任务窃取 - 空闲线程可以从其他线程的任务队列中窃取任务。
*   使用支持 NUMA 的内存分配器。

我的一些同事已经彻底评估了不同 OpenMP 运行时的 NUMA 行为，并专门研究了英特尔实施的 NUMA 意识，但文章尚未发布，因此我无法为您提供链接。

有一个名为[ForestGOMP](http://runtime.bordeaux.inria.fr/forestgomp/)的研究项目，旨在为`libgomp`. 也许你应该看看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-07T11:34:27.710

您还可以使用新工具来检查您的内存放置和访问是否正确，该工具用于分析 NUMA 应用程序，现在是 Linux 的开源工具：NUMAPROF：[https](https://memtt.github.io/numaprof/) ://memtt.github.io/numaprof/ 。

# eclipse - Flash Builder 停用断点（有时）

> ID：11959910
> 
> 赞同：5
> 
> 时间：2012-08-14T20:05:01.790
> 
> 标签：eclipse, flash-builder

对于我的许多 Flash Builder（4.0、4.5 或 4.6）项目，一段时间后，Flash Builder 调试器开始忽略我放置的断点。发生这种情况时，断点仅显示为一个蓝点，而不是带有复选标记的蓝点。

我在 swf 启动后放置的所有新断点都可以工作。

我怀疑这与我将调试器附加到服务器上运行的 swf 的事实有关。在运行/调试设置中，url 是“http://localhost/xxxxx”，而不是直接链接到 swf。

正如我所提到的，这并不总是发生。有时，我几个小时前放置的断点开始工作。

当我想在初始化期间停在断点处时，这尤其令人讨厌。

任何人都知道是什么原因造成的以及如何解决它？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T20:59:11.530

我们也遇到过这个问题，发现以下似乎可行：

1.  从应用程序中删除所有断点。
2.  做一个干净的构建
3.  启动应用
4.  设置断点。它应该工作。

大多数情况下，您可以跳过第 2 步，如果它仍然不起作用，请再次尝试包含它。

* * *

我们已经设法将问题跟踪到 Flash 调试器中的错误。在已设置断点的情况下开始运行时会引发以下异常：

```
flash.tools.debugger.InProgressException
    at flash.tools.debugger.concrete.DSwfInfo.swdLoaded(DSwfInfo.java:153)
    at flash.tools.debugger.concrete.DSwfInfo.getSourceList(DSwfInfo.java:129)
    at flash.tools.debugger.threadsafe.ThreadSafeSwfInfo.getSourceList(ThreadSafeSwfInfo.java:78)
    at com.adobe.flexbuilder.debug.breakpoints.FlexLineBreakpoint.findSourceFiles(FlexLineBreakpoint.java:414)
    at com.adobe.flexbuilder.debug.breakpoints.FlexLineBreakpoint.instantiate(FlexLineBreakpoint.java:467)
    at com.adobe.flexbuilder.debug.model.FlexDebugTarget.instantiateBreakpoint(FlexDebugTarget.java:1172)
    at com.adobe.flexbuilder.debug.model.FlexDebugTarget.access$4(FlexDebugTarget.java:1166)
    at com.adobe.flexbuilder.debug.model.FlexDebugTarget$FdbThread.installDeferredBreakpoints(FlexDebugTarget.java:653)
    at com.adobe.flexbuilder.debug.model.FlexDebugTarget$FdbThread.advanceStateMachine(FlexDebugTarget.java:684)
    at com.adobe.flexbuilder.debug.model.FlexDebugTarget$FdbThread.access$7(FlexDebugTarget.java:658)
    at com.adobe.flexbuilder.debug.model.FlexDebugTarget$FdbThread$1.run(FlexDebugTarget.java:771)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at com.adobe.flexbuilder.debug.model.FlexDebugTarget$FdbThread.eventLoop(FlexDebugTarget.java:748)
    at com.adobe.flexbuilder.debug.model.FlexDebugTarget$FdbThread.run(FlexDebugTarget.java:812)
    at java.lang.Thread.run(Thread.java:680) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-04T22:11:56.870

我使用无可比拟的和一些尽职调查解决了这个问题。此修复适用于 FB 4.7，也可能适用于所有 4.x：

在 Flashbuilder 工作区的 .metadata 中打开此文件：.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.ui.editors.prefs

确保该文件中有以下行：breakpointVerticalRuler=true

FB 有时将此条目写为：breakpointVerticalRuler=true

这就是导致问题的原因。当我在远程调试时将更改保存在文件中时，FB 对我这样做了。

# objective-c - 使用 keyValueCoding (setValue:forKeyPath:) 调用方法

> ID：11959916
> 
> 赞同：0
> 
> 时间：2012-08-14T20:05:20.437
> 
> 标签：objective-c, ios

我遇到了一个小问题：

```
Player *player1;
Player *player2;
Player *player3;
Player *player4; 
```

在`Player`课堂内，我有一个名为`score`. 如果我需要更改所有玩家的分数，我使用这个功能：

```
for (int i = 1; i <= 4; i++)
{
    [self setValue:@"10,000" forKeyPath: [NSString stringWithFormat: @"player%i.score.text", i]];
} 
```

同样在`Player`课堂上，我有一个名为`changeScorePosition`. 我想为游戏中的所有“玩家”调用此方法。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:23:03.767

player1 是全局变量吗？

相反，请尝试创建一个对象来管理所有玩家。然后，该对象可以轻松地遍历所有玩家并更新他们的分数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:24:31.757

您可以将播放器放在一个数组中，然后使用 i 根据索引调用正确的播放器（尽管它需要从 0 开始）。

```
NSArray *players = [NSArray arrayWithObjects: player1, player2, player3, player4, nil];

for (int i = 0; i < 4; i++)
{
  Player *currentPlayer = (Player *)[players objectAtIndex:i];
  // do whatever with your player here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T20:30:08.840

最好创建这样的玩家数量，

```
NSMutableArray *playerArray = [[NSMutableArray alloc] init];

for (int i = 1; i <= 4; i++)
{
    Player *player = [{Player alloc] init];
    [playerArray addObject:player];
    [player release];
} 
```

并调用类似的方法，

```
for (int i = 1; i <= 4; i++)
{
    [self setValue:@"10,000" forKeyPath: [NSString stringWithFormat: @"player%i.score.text", i]];
    [[playerArray  objectAtIndex:i-1] changeScorePosition];
} 
```

参考这个链接：[通过字符串名称或变量访问objective-c对象](https://stackoverflow.com/questions/10261380/access-objective-c-object-by-string-name-or-variable)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T20:33:13.727

谢谢您的帮助。我更改了一些代码，发现我可以这样做：

```
[[self valueForKeyPath:[NSString stringWithFormat:@"player%i", i]] performSelector:@selector(playerDeclined)]; 
```

# c++ - 使用 libc++ 正则表达式库 (C++11) 匹配“行首”

> ID：11959918
> 
> 赞同：12
> 
> 时间：2012-08-14T20:05:29.547
> 
> 标签：c++, regex, c++11, clang, libc++

我想匹配以给定单词开头的所有行，比如 iheap。如果我没记错的话，正则表达式（在 ECMAScript 语法中）`"^iheap.*"`应该可以解决问题。但是，当我使用 libc++ 的正则表达式库在 C++11 中对此进行测试时，只有第一行匹配。所以`"^..."`似乎只匹配输入的开头而不是行的开头。

这是一个例子：

```
#include <string>
#include <regex>
#include <iostream>

using namespace std;

int main() {
        regex rx("^iheap.*");
        string s = "iheap says hello.\niheap says hello again.\n";
        cout << s << regex_replace(s, rx, "IHEAP");
        return 0;
} 
```

输出：

```
iheap says hello.
iheap says hello again.
IHEAP
iheap says hello again. 
```

这是 libc++ 的错误还是我做错了什么？谢谢！

*注意*：我使用的是 Mac OS X Mountain Lion 和 Apple LLVM Compiler 4.0（基本上是 clang 3.1 SVN 的快照）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T23:44:30.293

我查看了所有相关标准，据我所知， ^ 仅匹配字符串的开头，而不匹配换行符，除非引擎处于*多行*模式。默认引擎是[ECMA-262](http://www.ecma-international.org/publications/standards/Ecma-262.htm) 该引擎默认情况下不处于多行模式，我认为无法使用标准 C++ 接口将其置于多行模式。

话虽如此，如果有人能指出我所说的不同的规范文本，我会认为这是一个错误报告并尽我所能修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-12T08:38:37.910

此问题已在[http://cplusplus.github.io/LWG/lwg-toc.html](http://cplusplus.github.io/LWG/lwg-toc.html)的 2343 列出。

# git - 如何从 perforce 回购中间进行 git-p4 克隆？

> ID：11959920
> 
> 赞同：4
> 
> 时间：2012-08-14T20:05:36.280
> 
> 标签：git, clone, perforce, git-p4

我想克隆我的回购的后半部分。它使用以下命令正常工作：

```
git-p4 clone --detect-branches //depot@all 
```

所以我想运行类似下面的东西，但它不会以相同的方式导入文件并最终失败：

```
git-p4 clone --detect-branches //depot@2000,3000 
```

我怎样才能让第二种方法正常工作？

**更新**：我现在得到的输出是 p4 陷入无限循环：

```
current change 32688
trying: earliest  latest 6135ce72f69ce262a6237c98da9ffee652be8b03
Reading pipe: git rev-list --bisect 6135ce72f69ce262a6237c98da9ffee652be8b03
Reading pipe: git cat-file commit 6135ce72f69ce262a6237c98da9ffee652be8b03 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T23:24:46.243

好的，我的主要问题是我错误地转置了起始版本号。

我的客户规格：

```
 View:
    //depot/main... //HOST/main...
    //depot/dev... //HOST/dev/...         
    //depot/patch... //HOST/patch... 
```

和命令：

```
git p4 clone --verbose --use-client-spec --detect-branches //depot@32668,#head repo 
```

现在，我唯一遇到的问题是 repo 中的分支的分支名称以直接树为前缀：

```
main/file1.txt
dev/file1.txt
patch/file1.txt 
```

**现在可以了。我更新了我的 git-p4 脚本版本（v1.7.12-rc3-4-g91e4bfe）来解决这个问题。如果可以的话，我会尝试为其他尝试做同样事情的人[推进主线](http://thread.gmane.org/gmane.comp.version-control.git/203910)**

# java - 将分隔符插入列表的最优雅方式

> ID：11959922
> 
> 赞同：2
> 
> 时间：2012-08-14T20:05:45.943
> 
> 标签：java, loops

> **可能重复：**
> [用逗号分隔列表的最清晰方法（Java）？](https://stackoverflow.com/questions/668952/clearest-way-to-comma-delimit-a-list-java)

我有一个`List<String>`，我需要将此列表转换为单行并在`String`this 的元素之间插入分隔符`List`，但第一个元素之前和最后一个元素之后的位置除外；

我做了一个这样的循环：

```
StringBuffer sb = new StringBuffer();
for (String str : list) {
    sb.append(str).append(';');
}
if(sb.length() > 0)
    sb.deleteCharAt(sb.length() - 1); 
```

我不喜欢删除最后一个标记句。

那么，哪种方式更优雅呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-14T20:07:34.150

不要重新发明轮子...... [apache commons-lang 库](http://commons.apache.org/lang/)有该[`StringUtils.join()`](http://commons.apache.org/lang/api-release/org/apache/commons/lang3/StringUtils.html#join%28java.lang.Iterable,%20java.lang.String%29)方法，它完全符合您的要求：

```
String s = StringUtils.join(list, ";"); // for example 
```

## Java 8 更新：

在 java 8 中，`String`该类具有执行所需操作的[`join()`](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#join-java.lang.CharSequence-java.lang.Iterable-)方法：

```
String s = String.join(";", list); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-14T20:08:35.377

看看在 Google 的 Guava 库中使用[Joiner 。](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Joiner.html)

```
String delimitedString = Joiner.on(";").join(list); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T20:44:09.743

你有很多推荐和第三方库。
我的建议是，如果您使用`for`循环，如果您的代码此时不需要是线程安全的，那么请使用 a`StringBuilder`代替。`StringBuffer`它比现在快得多`unsynchronized`

一个示例（仅针对不同的循环）：

```
int len = list.size() - 1;
ListIterator<String> it = list.listIterator();  
StringBuilder sb = new StringBuilder();  
while(it.hasNext() && len-- > 0){  
   sb.append(it.next()).append(";");  
}  
if(it.hasNext()){  
   sb.append(it.next());  
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T20:08:26.490

这是我使用的，用 C# 编写的，但您应该能够弄清楚...

```
public static string DelimitList<T>(List<T> list, string delimiter)
{
    if (list == null || list.Count == 0 || delimiter == null)
    {
        return string.Empty;
    }

    StringBuilder delimitedList = new StringBuilder();
    for (int index = 0; index < list.Count - 1; index++)
    {
        delimitedList.Append(list[index]);
        delimitedList.Append(delimiter);
    }

    delimitedList.Append(list[list.Count - 1]);
    return delimitedList.ToString();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-14T20:09:29.517

Apache Commons Lang 有一个[`StringUtils`](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html)类，其`join`方法允许您执行此操作：

```
StringUtils.join(list, ";"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-14T21:19:18.463

看看 ArrayList.toString() 是如何编写的，这可能会有所帮助：

```
public String toString() {
    Iterator<E> i = iterator();
if (! i.hasNext())
    return "[]";

StringBuilder sb = new StringBuilder();
sb.append('[');
for (;;) {
    E e = i.next();
    sb.append(e == this ? "(this Collection)" : e);
    if (! i.hasNext())
    return sb.append(']').toString();
    sb.append(", ");
}
} 
```

这对你有启发吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-14T20:07:30.453

好吧，它并不是真的更优雅，但是您可以检查它是否是第一个条目，否则会预先添加分隔符。

```
boolean isFirst = true;

StringBuffer sb = new StringBuffer();
for (String str : list) {
   if (!isFirst){
       sb.append(';');
   } 
   sb.append(str);
   isFirst = false;
} 
```

# join - 如何自我加入两组标记化数据以指示匹配频率

> ID：11959923
> 
> 赞同：2
> 
> 时间：2012-08-14T20:05:53.040
> 
> 标签：join, sql-server-2008-r2

这是场景。

我在 SQL Server 2008 R2 表中有两条记录，如下所示：

```
ID                    Name
1                     Joe Stephen Brown     
2                     Joe Henry Wallace Brown     
3                     Jerry Joe Carr     
4                     Jerry Lewis 
```

我已经对 name 列进行了标记并将其与标记关联的 id 一起放入标记表中，这样我们现在就有了：

```
ID                    Token
1                     Joe
1                     Stephen
1                     Brown
2                     Joe
2                     Henry
2                     Wallace
2                     Brown
3                     Jerry
3                     Joe
3                     Carr
4                     Jerry
4                     Lewis 
```

我希望能够在此表上进行自联接，以便我可以计算自联接中一个表中的令牌与自联接中另一表中的令牌匹配的次数。所以比赛应该是这样的：

```
Table1.ID             Table1.Token          Table2.ID             Table2.Token
1                     Joe                   2                     Joe
1                     Brown                 2                     Brown
1                     Joe                   3                     Joe
3                     Jerry                 4                     Jerry 
```

*（记录 1 和 2 有两个标记匹配项（'Joe' 和 'Brown'），记录 1 和 3 有一个（'Joe'），记录 3 和 4 有一个（'Jerry'）。）*

所以我希望比赛的最终报告是这样的：

```
Table1.ID             Table2.ID             Number of matches
1                     2                     2
1                     3                     1
3                     4                     1 
```

但是，我很难做到这一点。我想单独对令牌进行自连接，但如果令牌表中还有其他带有“Joe”和“Brown”的记录，就会变得复杂。

**编辑**

如果有这样的场景：

```
ID                    Name
1                     Joe Stephen Brown     
2                     Joe Henry Brown Brown 
```

如果可能的话，我希望匹配计数为 2；换句话说，“Joe Stephen Brown”中的“Brown”应该匹配“Joe Henry Brown Brown”中的第一个“Brown”，而“Joe Henry Brown Brown”中的第二个“Brown”应该保持不匹配。然后应该计算 'Joe' > 'Joe' 和 'Brown' > 第一个 'Brown' 匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T21:54:43.093

因此，如果我了解要求，我相信这个查询应该给出预期的结果：

```
;WITH DistinctTokens AS (
    SELECT DISTINCT ID, Name
    FROM Tokens
)
SELECT
    t1.ID AS [Table1.ID],
    t1.Token AS [Table1.Token],
    t2.ID AS [Table2.ID],
    t2.Token AS [Table2.Token]
FROM
    DistinctTokens t1 FULL OUTER JOIN
    DistinctTokens t2 ON t1.Token = t2.Token AND t1.ID < t2.ID 
```

编辑：

好的，感谢您的澄清；这更近了吗？

```
SELECT
    t1.ID AS [Table1.ID],
    t2.ID AS [Table2.ID],
    COUNT(*) AS [Number of matches]
FROM
    Tokens t1 JOIN
    Tokens t2 ON t1.Token = t2.Token AND t1.ID < t2.ID
GROUP BY
    t1.ID,
    t2.ID 
```

# javascript - javascript（用于节点）中是否有任何用于忽略文件的小型库

> ID：11959926
> 
> 赞同：1
> 
> 时间：2012-08-14T20:06:05.710
> 
> 标签：javascript, node.js

我想在我的节点脚本中实现一个 ingnore 文件，例如 .ignore

示例 .projectignore：

```
file*
dir/*
dir/**/dir
*.swp 
```

并带有 javascript 函数

```
fs.readdir("/", function(err, files){
  if(!FileLib.isIgnored(files){
    ...
  }
}); 
```

是否有任何图书馆可以做到这一点，或者我如何轻松实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T05:06:35.100

查看[`glob`](https://npmjs.org/package/glob)和[`minimatch`](https://npmjs.org/package/minimatch)包。

# python - 文件更改后重新启动 WingIDE 调试器

> ID：11959932
> 
> 赞同：2
> 
> 时间：2012-08-14T20:06:31.937
> 
> 标签：python, django, wing-ide

我将 django python 与wingIDE 一起使用，每次进行更改时，我都必须重新启动调试器并刷新页面。大多数时候我忘记重新启动调试器，需要一秒钟才能弄清楚为什么我的网页没有改变。我想知道是否有任何新的方法可以让调试器在每次保存或更改文件时重新启动。我相信我已经在其他地方看到了这个功能，但我似乎无法为机翼找到它。我希望只有一个我缺少的偏好或类似的简单的东西。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:22:56.297

调试器的默认配置从 Wing IDE 启动 Django 并禁用自动重新加载，因此必须按下 Wing 中的重新启动按钮，然后更改才会在调试过程中生效。要从 IDE 外部启动并自动处理自动重新加载，请参阅[http://wingware.com/doc/howtos/django末尾的 Debugging with Auto-Reload](http://wingware.com/doc/howtos/django)

# php - 从硬编码的 URL 中检索 query_string

> ID：11959933
> 
> 赞同：0
> 
> 时间：2012-08-14T20:06:37.300
> 
> 标签：php

如何检索 query_string 或“？”之后的参数 在 URL 中，如果它是硬编码的，而不是从表单发送的？

我通常会使用 $_GET['name'] 来检索这些数据，但是由于我正在寻找一种方法来检索查询，当有人通过直接在 URL 中输入 query_string 进行硬编码时，我不确定“名称”会是什么是使用 $_GET。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:10:36.733

您的问题似乎是您不知道用户将为`$_GET`参数输入什么键。因此，您可以像这样直接循环`$_GET`：

```
foreach( $_GET as $key => $value) {
    echo $key . ' => ' . $value . "\n";
} 
```

这将打印所有参数。

现在，如果你只想要第一个 GET 参数，你可以使用[`array_shift()`](http://php.net/array_shift)，像这样：

```
$first = array_shift( $_GET); 
```

这两种方法都不需要您事先知道参数的键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:10:47.160

```
<?php
foreach($_GET as $key => $value)
    echo $key . " : " . $value;
?> 
```

# c++ - 是否必须重置 std::array 元素？

> ID：11959935
> 
> 赞同：6
> 
> 时间：2012-08-14T20:07:00.360
> 
> 标签：c++, arrays, initialization

```
std::array<int,4> myInts;
std::array<bool,2> myBools; 
```

`myInts`和的元素`myBools`可以假定为假和 0，还是应该`fill`手动设置数组？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-14T20:08:20.687

元素将被设置为随机值，但您可以确保像这样初始化它们：

```
std::array<int,4> myInts{}; // all zeroes
std::array<bool,2> myBools{}; // all false 
```

所以元素不必被重置，它们可以被初始化为某些值。您还可以将元素初始化为不同的值：

```
std::array<int,4> myInts{1,2,33,44};
std::array<bool,2> myBools{true, false}; 
```

如果初始化列表中的元素少于数组的大小，则缺失的元素将被初始化为零：

```
std::array<int,4> myInts{1,2}; // array contains 1,2,0,0 
```

**注意**该标准指定它`std::array`是一个聚合，并且有一些示例代码显示它实现为具有数组数据成员。它声称这只是为了强调该类型是一个聚合，但如果使用此实现（并且 GCC 使用它），那么您将需要一组额外的大括号，因为您正在初始化数组`std::array`：

```
std::array<int,4> myInts{ {1,2,33,44} }; 
```

另一方面，这种情况符合大括号省略的条件，因此额外的大括号集不是强制性的。

# jquery - jqGrid 警告对话框

> ID：11959939
> 
> 赞同：5
> 
> 时间：2012-08-14T20:07:11.907
> 
> 标签：jquery, jqgrid

我在 jqGrid 上有一些自定义工具栏按钮。其中一个取决于选择的行，就像内置的编辑和删除按钮一样。当用户在未选择任何行的情况下单击它时，我希望向用户显示来自内置编辑或删除按钮的相同警告对话框。也就是说，我想重用网格使用的对话框：

警告 请选择行

知道网格从哪里显示警报吗？

谢谢，斯科特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T21:02:05.970

我认为代码可能如下所示

```
var alertIDs = {themodal: 'alertmod', modalhead: 'alerthd', modalcontent: 'alertcnt'};

$.jgrid.viewModal("#" + alertIDs.themodal,
    {gbox: "#gbox_" + $.jgrid.jqID(this.p.id), jqm: true});
$("#jqg_alrt").focus(); 
```

其中`this.p.id`（或`$.jgrid.jqID(this.p.id)`）可以替换为网格的 id。为了更确定警报工作，我建议您使用更长的代码

```
var alertIDs = {themodal:'alertmod',modalhead:'alerthd',modalcontent:'alertcnt'};
if ($("#"+alertIDs.themodal).html() === null) {
    $.jgrid.createModal(alertIDs,"<div>"+$.jgrid.nav.alerttext+
        "</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",
        {gbox:"#gbox_"+$.jgrid.jqID(this.p.id),jqModal:true,drag:true,resize:true,
        caption:$.jgrid.nav.alertcap,
        top:100,left:100,width:200,height: 'auto',closeOnEscape:true,
        zIndex: null},"","",true);
}
$.jgrid.viewModal("#"+alertIDs.themodal,
    {gbox:"#gbox_"+$.jgrid.jqID(this.p.id),jqm:true});
$("#jqg_alrt").focus(); 
```

[该演示](http://www.ok-soft-gmbh.com/jqGrid/Warning.htm)演示了代码。它显示消息

![在此处输入图像描述](../Images/dfcab41874d0831ce8e12312167f2a71.png)

每次单击`"Click me!"`按钮时。

**更新：** [答案](https://stackoverflow.com/a/32551247/315935)包含如何在[免费 jqGrid](https://github.com/free-jqgrid/jqGrid)中使用上述对话框的信息。它描述了许多选项。最简单的版本只包含一个简单的调用`this.modalAlert();`。它显示相同的警报对话框，免费的 jqGrid 在内部显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-26T12:00:15.277

我刚刚尝试了 Oleg 的以下解决方案，但它对我不起作用。
进行一些调试后，我意识到这`$("#"+alertIDs.themodal).html()`对我来说是“未定义的”，因此 Oleg 提出的 if 案例无法正常工作。

我改变了这个：

```
if ($("#"+alertIDs.themodal).html() === null) { 
```

进入这个：

```
if ($("#"+alertIDs.themodal).html() === null || $("#"+alertIDs.themodal).html() === undefined) { 
```

现在工作正常。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-06-28T11:58:41.390

```
$.jgrid.info_dialog.call(this,
    "Warning",              // dialog title
    "Please, select row!"  // text inside of dialog
); 
```

对我来说效果很好！

# objective-c - QTCaptureSession:startRunning 正在阻塞线程

> ID：11959940
> 
> 赞同：0
> 
> 时间：2012-08-14T20:07:15.287
> 
> 标签：objective-c, macos, cocoa, qtkit

首先让我说我是一个完全的 Objective-c 新手，我正在使用现有的代码库，所以我正试图疯狂地阅读 NSRunLoop 等，但我希望得到一些额外的帮助。

基本上，我继承了如下代码：

```
[[NSRunLoop mainRunLoop] runUntilDate:[NSDate distantFuture]];
[_captureSession startRunning];
return [NSNumber numberWithInt:0]; 
```

在一个应该返回的函数中，而是在 startRunning 上永远阻塞。我需要这个来返回，我不确定它为什么会阻塞。一些分散的代码可能会有所帮助：

```
_captureDecompressedVideoOutput = [[QTCaptureDecompressedVideoOutput alloc]
                                    init];
[_captureDecompressedVideoOutput setDelegate:self];
[_captureDecompressedVideoOutput performSelectorOnMainThread:@selector(setPixelBufferAttributes:) withObject:captureDictionary waitUntilDone:NO]; 
```

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T23:22:50.950

好吧，我将 [_captureSession startRunning] 卡在一个单独的函数中，然后将调用替换为

```
self performSelectorInBackground:@selector(backgroundCapture) withObject:nil]; 
```

所以它在一个线程中运行。阻塞不仅不会干扰方法返回（因为它在单独的线程上），而且调用甚至不会阻塞，因为它正在自己的线程上运行。奇怪。

# jquery - 脚本多次工作，动态添加字段

> ID：11959941
> 
> 赞同：0
> 
> 时间：2012-08-14T20:07:19.877
> 
> 标签：jquery, repeat

大家好，我在网上找到了一个代码，我做了一些编辑，但我无法让它在同一页面上多次工作在这里你可以找到我的 jsfiddle：http: [//jsfiddle.net/Scanu/DhpXN/](http://jsfiddle.net/Scanu/DhpXN/)

如果我重复 html 代码两次（corse）它不起作用我能做些什么来改进代码！？：/提前谢谢我的英语对不起我是意大利人

HTML

```
<div>
        <input type="button" id="btnAdd" value="add another name" />
        <input type="button" id="btnDel" value="remove name" />
    </div> 
<div class="clonedInput">
        Link: <input type="text" name="link1" />

    </div>
<br><br><br><br>​ 
```

脚本

```
$('#btnAdd').click(function() {
    var num = $(".clonedInput").length; // how many "duplicatable" input fields we currently have
    var newNum = new Number(num + 1); // the numeric ID of the new input field being added
    var newElem = $('.clonedInput:last').clone();

    newElem.children(':first').attr('name', 'link' + newNum);
    $('.clonedInput:last').after(newElem);
    $('#btnDel').attr('disabled', false);
    if (newNum == 5) $('#btnAdd').attr('disabled', 'disabled');
});

$('#btnDel').click(function() {
    var num = $('.clonedInput').after().length;
    $('.clonedInput:last').remove(); // remove the last element
    $('#btnAdd').attr('disabled', false); // enable the "add" button
    // if only one element remains, disable the "remove" button
    if (num - 1 == 1) $('#btnDel').attr('disabled', 'disabled');
});

$('#btnDel').attr('disabled', 'disabled'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T21:42:15.503

希望这是你想看到的 [http://jsfiddle.net/tonybo/DhpXN/19/](http://jsfiddle.net/tonybo/DhpXN/19/)

HTML

```
<table cellpadding="5" border="0">
    <tr>
        <td>
            <div class="clonedInput">
                Link: <input type="text" name="link_1" class="input"/>
            </div>
        </td>
        <td valign="bottom">
            <button id="Add"> + </button>
            <button id="Del"> - </button>
        </td>
    </tr>
    <tr>
        <td>
            <div class="clonedInput">
                Name: <input type="text" name="name_1" class="input"/>
            </div>
        </td>
        <td valign="bottom">
            <button id="Add"> + </button>
            <button id="Del"> - </button>
        </td>
    </tr>
</table>​ 
```

和 JavaScript（这包含在 onLoad 函数中）

```
var MAX_ELEMENTS = 5;
$('.clonedInput').each(function (index, element) {
    var $this = $(this);
    var $thisParent = $this.parent();
    var $input = $this.find("input");
    var groupName = $input.attr('name').split('_')[0];

    var $addButton = $thisParent.parent().find("#Add");
    var $delButton = $thisParent.parent().find("#Del");

    $addButton.click(function (e) {
        var newElementIndex = $thisParent.find(".clonedInput").length;
        var $newElement = $thisParent.find(".clonedInput:last").clone();
        $newElement.find('input').attr( 'name', groupName + "_" + newElementIndex);
        $newElement.hide();
        $thisParent.find(".clonedInput:last").after($newElement);
        $newElement.animate({ height: 'toggle', opacity: 'toggle' }, "medium");
        $delButton.fadeIn();
        if ( newElementIndex >= (MAX_ELEMENTS - 1)  )
            $addButton.fadeOut();
    });

    $delButton.click(function (e) {
        var newElementIndex = $thisParent.find(".clonedInput").length;
        $thisParent.find(".clonedInput:last").animate({
            height: 'toggle',
            opacity: 'toggle'
        }, {
            duration : "medium",
            complete : function() {
                $(this).remove();
            }
        });

        if (newElementIndex <= MAX_ELEMENTS )
            $addButton.fadeIn();

        if ( newElementIndex == 1 )
            $delButton.fadeOut();
    });
});​ 
```

# xcode - xcode timePicker 返回错误的时间

> ID：11959944
> 
> 赞同：2
> 
> 时间：2012-08-14T20:07:26.810
> 
> 标签：xcode, datepicker, datetimepicker

我在使用时间选择器时遇到问题，无法弄清楚我的问题是什么。这是我的代码；

```
timePicker.timeZone = [NSTimeZone localTimeZone];
NSDate *selected = [timePicker date];

NSString *message = [[NSString alloc] initWithFormat:
                     @"The date and time you selected is: %@", selected];
UIAlertView *alert = [[UIAlertView alloc]
                      initWithTitle:@"Date and Time Selected"
                      message:message
                      delegate:nil
                      cancelButtonTitle:@"Yes, I did."
                      otherButtonTitles:nil];
[alert show]; 
```

例如，如果我选择时间下午 2:55，警报将返回“2012-08-14 19:55:37 +0000”

它必须是超级简单的东西，只是看不到它

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:18:21.090

NSDate 没有时区的概念。它只存储中性时间信息。所以你必须纠正你的输出来补偿。

你可以创建一个 NSDateFormatter 的实例，然后 setTimeZone：

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"..."];

//Timezone!
[dateFormatter setTimeZone:[NSTimeZone timeZoneWithName:@"..."]];

NSString *dateSting = [dateFormatter stringFromDate:myDate]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-07T10:37:09.737

您需要添加 UTC 和您所在国家/地区时区之间的时间间隔差异，您可以通过以下方式实现：

```
(sender.date as NSDate).addingTimeInterval(TimeInterval(NSTimeZone.local.secondsFromGMT())) 
```

# javascript - 使用带有列表的 .append() 将文本放在换行符上

> ID：11959948
> 
> 赞同：0
> 
> 时间：2012-08-14T20:07:32.450
> 
> 标签：javascript, jquery, html

我正在尝试在 javascript 中创建一个无序列表。我的代码如下：

```
$(div).append("<ul>")
for (i in usersLst){
    $(div).append("<li>")
    $(div).append(usersLst[i][1])
    $(div).append("</li>")
}
$(div).append("</ul>") 
```

那么结果是：

```
•
bob
•
alice
•
fred 
```

但是，如果代码显示：

```
$(div).append("<ul>")
for (i in usersLst){
    $(div).append("<li>"+usersLst[i][1]+"</li>")
}
$(div).append("</ul>") 
```

那么结果是：

```
 - bob
 - alice
 - fred 
```

因此，通过三个单独的附加，似乎神秘地插入了换行符。这是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:16:56.850

假设这段代码：

```
$('div')
    .append("<ul>")
    .append("<li>");
    .append('foo');
    .append("</li>")
    .append("</ul>")​​​ 
```

让我们看一下生成的结构（Chrome 21）：

```
<div>
    <ul></ul>
    <li></li>
    foo
</div> 
```

发生了什么事？`.append`接受每个参数并将字符串转换为适当的 DOM 元素。因此，代码与执行以下操作相同：

```
$('div')
   .append(document.createElement('ul'))
   .append(document.createElement('li'));
   .append(document.createTextNode('foo')); 
```

包含结束标记的两个调用将被忽略，因为它们无法转换为有效的 HTML / DOM 元素。

`.append`（以及所有其他 DOM 操作方法）正在处理**DOM 元素**。这只是 jQuery 调用[`.appendChild` *^([MDN])*](https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild)的方式。

HTML 只是*表示*结构的一种特定格式。在那里，每个元素都由一个*开始标签*和一个（可选的）*结束标签*表示。浏览器正在解析 HTML 并在内存中创建 DOM。DOM（文档对象模型）是一个定义良好的接口，用于与分层的结构化数据进行交互。使用 DOM 后，开始和结束标签不再存在（即 HTML），只有[Nodes](https://developer.mozilla.org/en-US/docs/DOM/Node)。我建议阅读[MDN 上的 DOM](https://developer.mozilla.org/en-US/docs/DOM)。

jQuery 允许您将 HTML 字符串传递给，`.append`因为它很方便，但每个字符串都会立即转换为相应的 DOM 节点并附加到其他节点。您不能通过多次调用来构建 HTML 字符串`.append`。

这是您的代码的更正版本：

```
// jQuery parses the HTML string and creates a UL element
var $ul = $('<ul />');
// equivalent to
// var $ul = document.createElement('ul'); <- NOTE: not HTML, it's a node name

for (var i in usersLst) {
    // jQuery parses the HTML, creates a LI element and appends it to the list
    $ul.append('<li>' + usersLst[i][1] + '</li>');
    // equivalent to
    // var li = document.createElement('li');
    // li.appendChild(document.createTextNode(usersLst[i][1]));
    // $ul.appendChild(li);
}

// append the populated UL element to an existing node:
$(div).append($ul);
// equivalent to
// existingElement.appendChild($ul); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:14:49.363

他们都是不正确的。您应该首先创建整个字符串，然后将其附加到 DIV：

```
var ul = '<ul>';
for (i in usersLst){
    ul+='<li>' + usersLst[i][1] + '</li>';
}
ul+='</ul>';

$(div).append(ul) 
```

# jquery - 使用 jquery ui 拖放获取特定图片 id 的值

> ID：11959950
> 
> 赞同：0
> 
> 时间：2012-08-14T20:07:33.450
> 
> 标签：jquery, jquery-ui

你好，就像我正在制作一个拖放系统，我希望当我拖放一张图片时，它应该被删除，但问题是当有很多图片时，即使我拖放任何随机图片，第一张图片总是会得到删除而不是应该删除的那个。我制作了一个 jquery 代码，在其中我得到了 picid、id 和登录 id 认为 jquery .attr() 然后我在拆分的帮助下打破这些值，然后得到我想要的所有值。对于每张图片，图片 ID 都不同，但每次我使用警报拖放任何图片时，我发现它从第一张图片中获取值。

我的代码通过`var a = $('.plzx').attr('mihref');`它获得了价值，但它从第一张照片中获得了价值。谁能帮忙

```
$(function() {
    // there's the gallery and the trash
    $trash = $("#trash");

    // let the gallery items be draggable
    $("a", ".polaroids").draggable({
        zIndex: 999,
        revert: "invalid",
        helper: function() {
            $copy = $(this).clone();
            return $copy;
        },
        appendTo: 'body',
        scroll: false
    });
    $("a", ".polaroids").selectable();    

    $trash.droppable({
        accept: ".polaroids a",
        activeClass: "custom-state-active",
        drop: function(event, ui) {
            var a = $('.plzx').attr('mihref');
            alert(a);
            var parts = a.split("?")[1].split("&");

            var table = {};

            for (var i = 0; i < parts.length; i++) {
                var pair = parts[i].split('=');
                table[pair[0]] = pair[1];
            }    

            var gid = table.id;
         }
    });    
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:57:50.637

当然它会得到它遇到的第一个元素。
相反，使用：

```
$(ui.helper).attr('mihref');
//or
$(event.target).attr('mihref'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:55:40.483

好吧，我找到了答案，我知道很多人会坚持这一点，所以分享给所有人而不是

```
var a = $('.anyclass').attr('anyattribute'); 
```

利用

```
var dumember=ui.draggable.attr("anyattribute"); 
```

希望能帮助到你

# c# - 如何在 2500+ 个套接字上实现 TCP/IP 心跳？

> ID：11959951
> 
> 赞同：4
> 
> 时间：2012-08-14T20:07:35.913
> 
> 标签：c#, sockets

我目前有一个异步 TCP/IP 套接字 C# WinForms 应用程序，它是“服务器”应用程序。应用程序持有到客户端的持久套接字。我想实现一个心跳包来检测半开连接。

最初我考虑只创建一个循环并每隔 xx 秒将心跳发送到我的整个套接字集合。但是，我认为这对性能不利。

我想我应该以某种方式错开心跳并一次发送到几百个套接字。有没有人有任何经验/技术/实施来有效地实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T20:25:00.400

我这样做（对于一个数量级的更多套接字）只需跟踪我上次与特定套接字交谈（或听到）的时间。在间隔内，我对给定年龄的那些人进行 ping 操作。假设套接字连接/断开/通信统一，这给了我一个相当统一的分布。此外，您始终可以将每次迭代的 ping 限制为有限数量的套接字：因为您正在跟踪最后一次通话的信息​​，所以下次您无法访问的那些仍然有资格。

# python - Python 持久 TCP 客户端

> ID：11959953
> 
> 赞同：0
> 
> 时间：2012-08-14T20:07:46.907
> 
> 标签：python, tcp, connection, telnet, persistent

我需要通过持久连接连接到我的服务器（不是 http），以加快某些事情的速度。我可以举一个如何做到这一点的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:11:19.983

您可以使用[套接字](http://docs.python.org/library/socket.html)库，文档中有很多示例。

```
>>> from socket import socket
>>> sock = socket()
>>> sock.connect(("173.194.32.41", 80))
>>> sock.send("Some stuff\r\n\r\n")
14
>>> sock.recv(12)
'HTTP/1.0 400' 
```

python标准库中还有[telnetlib](http://docs.python.org/library/telnetlib.html)。

# python - ZBAR Python 没有输出

> ID：11959957
> 
> 赞同：0
> 
> 时间：2012-08-14T20:08:16.823
> 
> 标签：python, barcode

我在读取一些条码时遇到问题。我所有的条形码都用 Code 39 编码。

这是我从 zbar 站点获得的代码，无休止的谷歌搜索返回了 Null。

```
from sys import argv
import zbar
import Image

if len(argv) < 2: exit(1)

# create a reader
scanner = zbar.ImageScanner()

# configure the reader
scanner.parse_config('enable')

# obtain image data
pil = Image.open(argv[1]).convert('L')
width, height = pil.size
raw = pil.tostring()

# wrap image data
image = zbar.Image(width, height, 'Y800', raw)

# scan the image for barcodes
scanner.scan(image)
# extract results
for symbol in image:
# do something useful with results
print 'decoded', symbol.type, 'symbol', '"%s"' % symbol.data

# clean up
del(image) 
```

任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:31:14.620

看来我的条形码很糟糕。另请注意，如果条形码位于带有其他数据的文档上，除非我启用网络摄像头扫描条形码，否则它也不会被拾取。似乎是一个限制或只是坏条形码。

# c# - 在 C# 中运行命令之前设置主机名/IP

> ID：11959967
> 
> 赞同：1
> 
> 时间：2012-08-14T20:09:13.273
> 
> 标签：c#

我有一个按钮，单击该按钮时正在运行 CMD 提示：

```
 private void PingCommand_Click(object sender, EventArgs e)
    {
        string strCmdText;
        strCmdText = "";
        System.Diagnostics.Process.Start("CMD.exe", strCmdText); 
    } 
```

我希望在打开命令提示符之前出现一个框，我可以在其中指定要 ping 的主机名/IP - 这可能吗？如果可以，我该怎么做？

或者，如果可能的话，为多个按钮设置主机名/IP 地址；IE。ping，映射家庭驱动器等！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:20:08.993

虽然可以启动命令行工具，但我建议使用`Ping class`.Net Framework 4.0（[Ping 类](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)）中的可用工具

这是对 MSDN 示例的修改

```
 using System.Net.NetworkInformation;
    using System.Diagnostics; // for demo purposes only

    private void PingCommand_Click(object sender, EventArgs e)
    {
        Ping pingSender = new Ping ();
        PingOptions options = new PingOptions ();

        // Use the default Ttl value which is 128,
        // but change the fragmentation behavior.
        options.DontFragment = true;

        // Create a buffer of 32 bytes of data to be transmitted.
        string data = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";
        byte[] buffer = Encoding.ASCII.GetBytes (data);
        int timeout = 120;
        string ipOrHost = "80.108.20.100"; // or access your textbox
        //string ipOrHost = txtIP.Text;
        PingReply reply = pingSender.Send (ipOrHost, timeout, buffer, options);
        if (reply.Status == IPStatus.Success)
        {
            Debug.WriteLine ("Address: " + reply.Address.ToString ());
            Debug.WriteLine ("RoundTrip time: " + reply.RoundtripTime);
            Debug.WriteLine ("Time to live: " + reply.Options.Ttl);
            Debug.WriteLine ("Don't fragment: " + reply.Options.DontFragment);
            Debug.WriteLine ("Buffer size: " + reply.Buffer.Length);
        }
    } 
```

如果您确实需要启动任何命令行工具，您可以查看`Process`和`ProcessInfo`类（[MSDN](http://msdn.microsoft.com/de-de/library/system.diagnostics.process%28v=vs.80%29.aspx)上的示例代码）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:13:57.427

是的，当然有可能。您应该使用一个对话框窗口提示用户，他们可以在其中输入 IP 地址，然后`Process.Start()`使用[ProcessStartInfo](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.aspx)类实例将此 IP 地址传递给方法，该类实例指定要传递给进程的[命令行参数。](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.arguments.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T20:16:09.633

您基本上只需要从文本框中获取 IP 然后执行`strCmdText = "ping " + MyTextBox.Text;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T20:20:23.580

您的**视图**(*.aspx) 类似于

```
...
<form id="form1" runat="server">
    <div>
        Hostname/IP to ping: <asp:TextBox ID="destination" runat="server" />
        <asp:Button ID="ping" runat="server" Text="Ping it!" onclick="ping_Click" />
    </div>
</form>
... 
```

和您的**代码隐藏**(*.aspx.cs)

```
 ...
    protected void ping_Click(object sender, EventArgs e)
    {
        if (!string.IsNullOrEmpty(this.destination.Text))
        {
            string strCmdText = string.Concat("ping ", this.destination.Text.Trim());
            System.Diagnostics.Process.Start("CMD.exe", strCmdText);
            //and so on...
        }
    }
    ... 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-14T20:16:51.347

您可以使用以下代码，它将运行 ping 命令并将结果返回给结果变量。您需要更改 ping.exe 的路径。

```
var fileName = "C:\\path-to\\ping.exe";
var arguments = txtHostname.Text;

var processStartInfo = new ProcessStartInfo(fileName ,  arguments);
processStartInfo.CreateNoWindow = true;
processStartInfo.RedirectStandardOutput = true;
processStartInfo.UseShellExecute = false;
using (var process = Process.Start(processStartInfo)) {
    using (var streamReader = new StreamReader(process.StandardOutput.BaseStream, Encoding.UTF8)){
        while (!streamReader.EndOfStream) 
        {
            listBox1.Items.Add(streamReader.ReadLine());
        }
    }
} 
```

# xcode - 在 Xcode (iOS) 中从 Google-App-Engine 读取安全 XML

> ID：11959970
> 
> 赞同：0
> 
> 时间：2012-08-14T20:09:24.650
> 
> 标签：xcode, security, google-app-engine

我有一个用 Java 编写的 Google-App-Engine 网站，我在该网站上存储了一个 XML 文件，以及一个需要读取该文件的 iOS 应用程序。但是，其他任何人都无法查看此 XML 非常重要。我一直在寻找一些可能性，但遇到了一些问题。

我主要是尝试在我的 Java 项目的 web.xml 中添加一个安全约束，例如：

```
<security-constraint>
    <web-resource-collection>
        <url-pattern>/file.xml</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>admin</role-name>
    </auth-constraint>
</security-constraint> 
```

当我尝试从网络浏览器访问文件时，这对我来说很好。我被重定向到可以输入用户名和密码的登录页面。但是在应用程序内部，我不知道在哪里输入这些信息。尝试获取该文件会返回 Google 登录页面的源代码。那么如何访问这些文件呢？

我还尝试使用 ASIHTTPRequest 类，并设置：

```
[request setUsername:@"username"];
[request setPassword:@"password"]; 
```

但是，我最终还是得到了登录页面的源代码。我应该考虑使用 CFCredentials 吗？还是我缺少一个更简单的解决方案？

我知道我也可以手动加密文件，然后在应用程序中解密它，但它是一个非常大的 XML，所以我不想这样做。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:22:12.330

您可以尝试使用[Google Cloud Storage](https://developers.google.com/storage/)。它可以从 Google App Engine 访问，也可以通过[实验性的 JSON API](https://developers.google.com/storage/docs/json_api/)访问，也可以从 iOS 访问。

您可以为已上传到 Google Cloud Storage 的文件指定 ACL，以便只有有限的一组用户可以访问它们。通过 OAuth 2 处理访问这些文件的授权。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:14:14.727

该页面由 Google 帐户日志记录保护（除此之外，用户需要是应用程序的管理员），您需要设置登录 cookie 才能被允许进入。

我知道从[移动应用程序设置登录 cookie 的唯一示例是 Nick 的博客](http://blog.notdot.net/2010/05/Authenticating-against-App-Engine-from-an-Android-app)，它使用 Java 实现登录。

# c# - 新的 await 关键字在高度并行的环境中有用吗？

> ID：11959971
> 
> 赞同：2
> 
> 时间：2012-08-14T20:09:27.677
> 
> 标签：c#, async-await, async-ctp, c#-5.0

我可以看到新的 async 和 await 关键字在 GUI 应用程序中的用处，在这些应用程序中添加一个线程来进行一些计算是必要的，而且新的关键字真的很容易。但是其他类型的应用程序呢？

例如，执行某些工作的服务器或不断处理数据的进程？可能我仍然误解了新关键字，但是这些类型的应用程序是否会从新关键字中受益，或者我们是否应该继续使用 Tasks 来实现更明确的多线程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T22:30:49.283

在非 GUI 应用程序中，使用的主要优点`await`是在执行 I/O 时。

如果您使用“旧方式”进行操作，您将使用同步方法进行 I/O，这会在线程工作时阻塞线程。使用`await`，您不会阻塞线程，这意味着您的应用程序将使用更少的线程，这可能会导致内存使用量大大降低（每个线程需要 1 MB 内存）和整体更好的性能。

您可以使用旧的异步编程模型实现类似的改进，但它要麻烦得多。

如果您不在乎您的非 GUI 应用程序使用的线程多于必要的线程，那么`await`对您来说没有太多用处。但是，如果您确实关心这一点，`await`则可以为您提供很多帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:13:48.100

`await`并且`async`是任务的*补充*。

您仍然应该使用任务，但使用`await`并`async`与它们一起使用只会使[异步方法](http://msdn.microsoft.com/en-us/library/hh191443.aspx)的编写更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T20:17:10.673

> 例如，执行某些工作的服务器或不断处理数据的进程？

这在这里非常合适。例如，在 WCF 服务中，您可以使用 async 和 await 在单个异步请求中组合多个异步服务请求而不会阻塞。

> 可能我仍然误解了新关键字，但是这些类型的应用程序是否会从新关键字中受益，或者我们是否应该继续使用 Tasks 来实现更明确的多线程？

两人合作，非常好。Async 和 await 通常使使用和组合多个操作`Task`变得`Task<T>`更简单。

但是，在“最低级别”，创建实际值的代码`Task`可能会使用相同的基于 TPL 的技术来实现。一旦你有了创建 a `Task`、 async 和 await的方法，*使用*该方法（包括使用它来创建更多异步方法，或者使用它来创建同时运行多个任务的方法）就简单多了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T20:17:19.533

任何时候你计划调用一个最终会异步运行的方法，没有阻塞，并且你将有一个回调方法，你可以使用新的关键字来简化语法。如果您没有任何回调代码并且没有遵循延续传递的编程风格，那么新的关键字可能对您没有帮助。（这并不是说如果你真的......真的想使用它们，你*就不能使用它们。）*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T15:54:00.867

> 例如，执行某些工作的服务器或不断处理数据的进程？可能我仍然对新关键字有误解，但是这些类型的应用程序是否会从新关键字中受益，或者我们是否应该继续使用 Tasks 来实现更明确的多线程？

几个月前，当我第一次开始使用 TAP 时，我也遇到了同样的问题，并得出结论认为 TAP 可以在并发的“类似服务器”的场景中很好地工作，而不必“陷入”一些更具体的问题TPL 的领域等。

例如，我目前正在处理的应用程序（它是一个 GUI 应用程序，顺便说一句，它也使用 TAP 来释放 GUI 线程）需要使用 SSH 与相当多的外部机器重复通信。想象一个大循环，其中应用程序需要 a) 向每个外部机器发送一个“命令”文件，b) 不久之后，轮询所有外部机器以获取“进度”文件（即使用 SSH 尝试下载文件） , c) 不久之后，轮询所有这些机器以获取“完成”文件等；这些步骤一遍又一遍地重复，直到我们“完成”。

在这个应用程序的第一次编写中，所有这些 SSH i/o 都是同步完成的，完成每个步骤的累积时间太长了。更不用说它不能很好地扩展，因为我们要求该应用程序支持更多的外部机器。

我已经重写了这个应用程序以同时执行每个步骤（a、b、c，如上所述）。因此，例如，向所有外部机器发送命令文件或多或少是同时发生的，而不是一个接一个地进行，从而允许应用程序在这些步骤（a、b、c）之间移动得更快、更流畅随着我们添加更多的外部机器，退化更少。

我通过 Task.Run() 开始每个 ssh 操作，因为我正在使用的 SSH 库本身不提供“异步”功能（但该库是线程安全的），然后我用 'await Task. WhenAll（任务列表）'。完成后，我会检查每项任务以查看结果，并据此进行。

除了使用 TAP 使这一切在代码中变得非常容易理解和令人愉悦之外，我还使用它对取消和进度对象的支持来处理取消并向用户报告这些活动的进度。

到目前为止，这工作得很好，我不必在 TPL 中进行任何比这更“深入”的操作，等等。有些人提到，当您获得“高度并发”时，您可能必须深入到 TPL 中，但我还没有亲眼看到“为什么”呢..

所以我想说，不要根据应用程序的“类型”（gui、服务器等）来确定 TAP 的有用性，而是根据您需要在应用程序中执行的活动的性质来确定；如果您需要同时进行多个计算，TAP 会很棒。如果您有很多需要同时完成的 i/o，TAP 会很棒。我们都知道使用 TAP 释放 GUI 线程的典型示例。

# jquery - jquery复选框问题 - 重新加载页面修复它

> ID：11959973
> 
> 赞同：0
> 
> 时间：2012-08-14T20:09:35.217
> 
> 标签：jquery

我在使用这个 jquery 时遇到了问题。当页面加载时，id_2 被隐藏。如果我选中复选框 id_1，则不会发生任何事情。但是，如果我重新加载页面，则会显示 id_2。

```
<head>
    <script src="http://code.jquery.com/jquery-latest.js" type="text/javascript">  /script>
</head>

<input id="id_1" type="checkbox" name="ck1">
<input type="text" id="id_2" name="tx1">

<script type="text/javascript">
         $(document).ready(function() {
             if ($('#id_1').is(':checked'))  {
                 ($('#id_2').show());
             } else {
                 ($('#id_2').hide());
             }
}); 
```

如果我使用按钮并且

```
$("#show_button").click(function() 
```

它有效 - id_2 正确显示/隐藏。我可以在萤火虫中看到，当我选中复选框时，选中的值会从真/假切换。

我究竟做错了什么？

奥利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:13:16.347

您需要将逻辑放在一个`click`或`change`事件中，否则您只是根据来自服务器的值隐藏/显示。

也改变

```
if ($('#id_1').is('checked')) 
```

经过

```
if ($('#id_1').is(':checked')) 
```

正如其他用户所说（在此处粘贴代码时不确定是否是拼写错误），您的 jquery 参考存在语法错误。改成这样

```
<script src="http://code.jquery.com/jquery-latest.js" type="text/javascript"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T20:15:02.840

尝试以下操作：

```
$(document).ready(function() {
    $('#id_2').css('display', $('#id_1').is(':checked') ? 'block' : 'none');

    $('#id_1').change(function(){
        $('#id_2').css('display', this.checked ? 'block' : 'none')
    })
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T20:15:18.927

这是因为您没有事件处理程序。您正在检查是否在页面加载时选中了该复选框，因此如果您选中它并刷新页面，您的浏览器会记住该复选框已选中，因此该事件在页面重新加载时被触发（显示`#id_2`）

如果您希望它是动态的，不需要重新加载页面，请添加一个事件处理程序（例如，单击）：

```
$('#id_1').click(function(){
    if ($('#id_1').is(':checked')){
         $('#id_2').show();
    } else {
         $('#id_2').hide();
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T20:19:07.597

```
<input id="id_1" type="checkbox" name="ck1">
<input type="text" id="id_2" name="tx1" style="display:none;">

<script>
$('#id_1').change(function(){
    if ($('#id_1').is(':checked'))  {
        $('#id_2').show();
    } else {
        $('#id_2').hide();
    }
});
</script> 
```

​</p>

# java - 如何使用 Maven 插件 tomcat7:run with multiple contexts (WARs)？

> ID：11959975
> 
> 赞同：20
> 
> 时间：2012-08-14T20:09:40.353
> 
> 标签：java, maven, tomcat, deployment, tomcat7

我一直在`mvn tomcat7-maven-plugin:run -am -pl :foo`成功地使用 Tomcat 一次只运行一个项目，[如下所示](http://tomcat.apache.org/maven-plugin-2/run-mojo-features.html)。现在我想让多个模块在同一个端口但不同的上下文下运行。例如，我想要：

```
/    => foo.war
/bar => bar.war 
```

这是我一直在使用的示例 pom.xml 片段：

```
<project><!-- ... -->
    <build><!-- ... -->
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.tomcat.maven</groupId>
                    <artifactId>tomcat7-maven-plugin</artifactId>
                    <version>2.0-SNAPSHOT</version>
                    <configuration>
                        <path>/</path>
                        <port>8080</port>
                        <addContextWarDependencies>true</addContextWarDependencies>
                        <addWarDependenciesInClassloader>true</addWarDependenciesInClassloader>
                        <warSourceDirectory>${project.build.directory}/${project.build.finalName}/</warSourceDirectory>
                    </configuration>
                    <dependencies>
                        <dependency>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>bar</artifactId>
                            <version>${project.version}</version>
                            <type>war</type>
                            <scope>tomcat</scope>
                        </dependency>
                    </dependencies>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
    <pluginRepositories>
        <pluginRepository>
            <id>apache.snapshots</id>
            <name>Apache Snapshots</name>
            <url>http://repository.apache.org/content/groups/snapshots-group/</url>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </pluginRepository>
     </pluginRepositories>
</project> 
```

这可以通过`tomcat7-maven-plugin:run`插件实现吗？我正在努力寻找正确的语法以使其正常运行。当我运行`maven`命令来运行它时，它只运行它在项目层次结构中找到的第一个。如果我使用`<fork>true</fork>`或显然从不同的终端运行它们，那么我会得到“java.net.BindException：地址已经在使用：8080”。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-02T11:02:46.113

正如已经建议的那样，使用`<webapps>`插件配置部分，但`<asWebapp>true</asWebapp>`为每个 webapp 添加附加参数，即：

```
<webapps> 
  <webapp> 
    <groupId>com.company</groupId> 
    <artifactId>mywebapp</artifactId> 
    <version>1.0</version> 
    <type>war</type>    
    <asWebapp>true</asWebapp> 
  </webapp> 
  <webapp> 
    <groupId>com.company</groupId> 
    <artifactId>mywebapp2</artifactId> 
    <version>2.0</version> 
    <type>war</type>    
    <asWebapp>true</asWebapp> 
  </webapp>
</webapps> 
```

默认情况下，这些额外的 web 应用程序使用`${artifactId}`上下文路径进行部署。

看起来如果没有这个参数，当你运行类似的东西`mvn tomcat7:run`（在稳定版本 2.0 上尝试过）时，额外的 webapps 会被默默地丢弃。[相关的 Jira 问题](https://issues.apache.org/jira/browse/MTOMCAT-169)告诉它是为了“向后兼容性”而完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T21:20:11.927

使用类似的东西

```
 <configuration>
    <webapps> 
      <webapp> 
        <groupId>com.company</groupId> 
        <artifactId>mywebapp</artifactId> 
        <version>1.0</version> 
        <type>war</type>    
      </webapp> 
    </webapps> 
  </configuration> 
```

# java - Android - 按计划运行提示

> ID：11959977
> 
> 赞同：0
> 
> 时间：2012-08-14T20:09:46.850
> 
> 标签：java, android, android-alertdialog

我有一个应用程序提示用户更新的请求（如果策略管理器站点说有更新可用），如果他们拒绝，则在 N 分钟内再次提示他们。我看到过类似的问题，但是当我尝试使用处理程序或计时器来实现代码时，活动超出范围或发生了我无法弄清楚的崩溃，我正在使用的类需要应用程序上下文和活动取出各种字符串变量并执行任务。

所以我想概括一下这个问题，因为也许我正在以错误的方式思考它：

安排更新提示的最佳方式是什么，可以取消并让用户返回他们正在进行的活动（然后在 N 分钟内再次安排运行），或者将用户引导到网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:15:23.910

您应该使用具有 PendingIntent 和 BroadcastReceiver 的 AlarmManager。您使用警报管理器设置时间并为其提供通过使用该`PendingIntent.getBroadcast`方法获得的 PendingIntent。你给这个方法的参数之一是 BroadcastReceiver 类，当时间到了你可以做任何你想做的事情时，它会收到一个调用，在你的情况下这可能会开始一个新的活动。

# silverlight - 来自后台线程的 RIA 服务调用

> ID：11959985
> 
> 赞同：1
> 
> 时间：2012-08-14T20:10:32.763
> 
> 标签：silverlight, backgroundworker, wcf-ria-services, asynchronous-wcf-call

我正在开发使用 RIA 服务的 Silverlight 应用程序。应用程序运行时我有很多数据要加载，并且所有数据都必须显示在 UI 上。
我正在使用不同的查询加载数据，并且加载片段之间没有顺序依赖关系。
随着数据的到来，开始绘制，主要是基于数据的矩形和线条。
处理数据花费了太多时间。我正在使用 fiddler 查看 http 请求，并得到以下结果。从 DB 获取数据并接收大约需要 1.5 秒。但在收到响应后，触发完成事件大约需要 6 秒。那时 UI 线程正忙于计算和渲染。
我尝试使用后台工作人员进行服务调用，但所有已完成的事件都在 UI 线程上触发。
有什么方法可以进行服务调用并处理从非 UI 线程接收到的数据？

**编辑：**
我评论了一些代码，它在 UI 上绘制了一些元素，处理数据需要 0.4 秒，而不是之前的 6 秒，所以原因是在繁忙的 UI 线程上，它在触发完成事件之前处理接收到的数据。

谢谢。

# c# - MVC 3 复选框到数据库

> ID：11959991
> 
> 赞同：0
> 
> 时间：2012-08-14T20:10:50.347
> 
> 标签：c#, asp.net-mvc, checkbox, data-persistence

我正在寻找一个带有下拉框的视图，其中列出了数据库中表中的编程语言。这我没有问题，但我还想要 10 个复选框，称为 1 级到 10 级。现在这 10 个级别已经在数据库中的一个单独的表中，每个都有自己的 id 等。

我的问题是，如何创建一个页面，让您选择一种语言，然后选择 2 级和 3 级，然后将它们添加到另一个带有外键的数据库表中语言和级别表？一开始我知道这听起来很简单，但我需要创建一个控制器来检查检查了哪些级别并添加它们。复杂的部分是每种语言都有不同的技能范围，并不是所有的从 1 开始到 10 结束。

以下是表格示例：

语言 ID 语言名称

级别 ID 级别名称

映射 ID LanguageID LevelID。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:28:39.560

您需要为每个实体创建模型。然后，在您的控制器中，将模型发送到视图，如下所示：

```
'
' GET: /MyController/MyAction

Public Function MyAction() As ActionResult
    Dim db = New LanguageDbContext
    ViewBag.Language = New SelectList(db.Languages, "LanguageId", "Name")

    Dim db1 = New LevelsDbContext
    ViewBag.level = New SelectList(db1.Levels, "LevelId", "Name")
    Return View()
End Function 
```

然后，您需要从 POST 的视图中获取模型，如下所示：

```
'
' POST: /MyController/MyAction

<HttpPost()> _
Public Function MyAction(ByVal model As MyModel) As ActionResult
    If ModelState.IsValid Then
         ' update your database by accessing model like this
            Dim db As Languages = New LanguageDbContext
            Dim language As New Language
            language.Name = model.Name

            db.Languages.Add(language)
            db.SaveChanges()
     End if
 End Function 
```

当然，在[http://asp.net/mvc上阅读 mvc](http://asp.net/mvc)

# c# - 正则表达式由 = 和 != 分割

> ID：11959992
> 
> 赞同：1
> 
> 时间：2012-08-14T20:11:06.400
> 
> 标签：c#, .net, regex

我正在努力弄清楚拆分此字符串的正确正则表达式是什么：

```
[ABC]!=[BCD]= 
```

进入这个拆分结果：

*   [ABC]
*   !=
*   [BCD]
*   =

我实际的正则表达式模式是：

```
(?<=!=|=)|(?=!=|=) 
```

但我得到的结果是：

*   [ABC]
*   ！
*   =
*   [BCD]
*   =

请帮忙！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:15:47.837

这要简单得多：

```
splitArray = Regex.Split(subjectString, "(!?=)"); 
```

给你`["[ABC]", "!=", "[BCD]", "="]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:15:02.200

使用这个正则表达式`(!=)|(=)|(\[.*?\])`

# ms-access - 在不相关的子表单访问 2010 中显示记录

> ID：11959994
> 
> 赞同：0
> 
> 时间：2012-08-14T20:11:17.570
> 
> 标签：ms-access, records, subform

我在泡菜里。这可能很容易，但我就是想不通。

2 列表格：

```
tbl_indicators | tbl_targets
ind_id         | id
ind_name       | ind_id
               | year
               | comment1
               | comment2 
```

我在表单上有一个不相关的子表单。在子表单上，我有 3 个文本框；tbl_indicators.ind_name、tbl_targets.comment1、tbl_targets.comment2。用户需要能够编辑评论。子表单应包含来自 tbl_indicators 的所有名称，并链接到注释文本框中的每个名称。例如，如果 tbl_indicators 有 10 个名称，则子表单应查看 10 条记录。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T23:39:12.947

讨论的结果是沿着这些思路形成的。主表单有一个用于名称的子表单，以及一个用于打开与每个名称相关联的注释的小表单的按钮。一个名称可以没有评论，也可以有多个评论。该按钮可以是宏或 VBA：

```
DoCmd.OpenForm "FormName",,,"[ind_id]=" & [ind_id] 
```

![表单/子表单行按钮](../Images/1f0700a2de479823e5e3f17f3e329004.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T22:37:38.393

所以这个子表不是父表的经典“子”表。但是，这个子表单是基于上面需要显示ing_name的。

简单的解决方案是构建一个查询，在 in_name 的 tbl_indiciator 列中留下连接。

所以只需构建一个这样的查询：

![在此处输入图像描述](../Images/a24bfb922661f8ecd96da47a930097f0.png) 以上是左连接查询，因为可能没有对应的 tbl_indicators 记录。

您继续子表单将如下所示：

![在此处输入图像描述](../Images/a9bb20f6a0dc94e1aa2307c896f61d97.png)

# matlab - 我可以在 GUIDE、Matlab 中的图形中重复使用面板\图形吗？

> ID：11959996
> 
> 赞同：2
> 
> 时间：2012-08-14T20:11:20.253
> 
> 标签：matlab, matlab-guide

我正在编写一个 matlab GUI，我想在两个不同的位置显示一个包含一些列表和文本字段的面板，其中包含不同的内容。

我可以以某种方式单独创建面板，然后将其多次合并到主图中吗？或者也许创造一个“儿童”形象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T13:22:18.243

是的，您可以以编程方式执行此操作。编写一个脚本（或更好的类）来创建一个 uipanel 并添加您希望在 uipanel 中显示的组件。您可以设置 uipanel 的 Parent 属性以将其放入图形/GUI中。有关以编程方式构建 GUI 的 Matlab 文档将很有帮助。

您可能希望将 uipanel 和其他组件的引用存储在某处，或者使用 Tag 属性标记它们以便以后找到它们。

然后，无论是在使 uipanel “可见”的回调中，还是在图形构造函数代码中，您都可以执行脚本来构建 uipanel 的实例，并使用引用或标签来更改部件/组件上的特定内容。

# php - 运行“命令”以安装开源软件

> ID：11959999
> 
> 赞同：1
> 
> 时间：2012-08-14T20:11:45.963
> 
> 标签：php, command-line, phpunit, pear

不知道如何表述这个问题的标题，因为不知道我要描述的是我的问题的一部分。这就是我的意思：我经常遇到教程或开源软件会这样说：

```
// Install PHPDocumentor
$ pear channel-discover pear.phpdoc.org
$ pear install phpdoc/phpDocumentor-alpha

// Install phpunit
pear install pear.phpunit.de/PHPUnit

// Install Magento Ecommerce
svn checkout http://svn.magentocommerce.com/source/branches/1.7 
```

这似乎是一个基本问题，但我究竟在哪里输入这些命令？

我使用的是 Windows 7。如果我尝试将这些输入到 Windows 命令提示符中，我只会收到一个错误，例如“xxx 未被识别为内部或外部命令。”

令人沮丧的是，许多网站都使用这些命令作为安装或升级软件的说明。

我假设这些网站都没有解释在哪里运行代码的原因是因为这是常识，如果这是一个基本问题，再次抱歉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:16:01.407

此类教程通常假设您使用的是 Linux 风格，因为已经安装了相关软件，所以这些命令可能通常（但肯定不是普遍）可用。

您从 Windows 命令提示符键入命令。启动它的一种方法是单击开始图标，然后在出现的文本框中键入*cmd*，然后按 Enter。

![在此处输入图像描述](../Images/8121d0430f40278727660b8c7b9cc650.png)

![在此处输入图像描述](../Images/e6805b6a28b6adc22b37f5f06594fc2b.png)

您可以从提供二进制文件的众多公司之一下载适用于 Windows 7 的 Subversion 安装程序。我个人使用[http://www.sliksvn.com/en/download/](http://www.sliksvn.com/en/download/)虽然有几个不错的选择。

要下载适用于 Windows 7 的 pear，请查看以下教程：

[http://www.geeksengine.com/article/install-pear-on-windows.html](http://www.geeksengine.com/article/install-pear-on-windows.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:18:43.327

这些命令适用于 *nix shell，而不是 windows。

但是你可以在 Windows 上使用[Cygwin](http://www.cygwin.com/)，其他有 Visual Application .. 比如[TortoiseSVN](http://TortoiseSVN.net/) for SVN