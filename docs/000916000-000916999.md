# StackOverflow 问答 000916000-000916999

# sql - MySQL - 仅在每个分组值的第一个实例中显示字段值？

> ID：916000
> 
> 赞同：2
> 
> 时间：2009-05-27T14:25:19.370
> 
> 标签：sql, mysql, dataset, group-by, grouping

我认为这是不可能的，但我希望得到证明。

我写了一个简单的报表查看类来输出各种数据库查询的结果。为了改进显示，当我有一个包含分组数据的报告时，我想仅在每个唯一值的第一行显示字段值 - 我想在查询级别执行此操作，或者它会在我的课堂上需要额外的逻辑来确定这些特殊值。

用一个简单的例子来说明我的要求可能会有所帮助。想象一下这个数据集：

```
Year    Quarter    Total
2008    Q1         20
2008    Q2         25
2008    Q3         35
2008    Q4         40
2009    Q1         15
2009    Q2         20
2009    Q3         30
2009    Q4         35 
```

如果可能，我希望数据集返回为：

```
Year    Quarter    Total
2008    Q1         20
        Q2         25
        Q3         35
        Q4         40
2009    Q1         15
        Q2         20
        Q3         30
        Q4         35 
```

有没有办法在 MySQL 中以编程方式执行此操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T14:30:59.937

```
SELECT  CASE WHEN @r = year THEN NULL ELSE year END AS year,
        quarter,
        total,
        @r := year
FROM    (
        SELECT  @r := 0
        ) vars,
        mytable
ORDER BY
        year 
```

`@r`这是一个会话变量。您可以`MySQL`在任何程序语言中像任何变量一样使用它们。

首先，它在子查询中被初始化为零。

其次，它在`SELECT`子句中被检查。如果 的当前值`@r`不等于`year`，则`year`输出 ，否则`NULL`输出。

第三，它用当前值更新`year`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T14:38:12.900

你为什么想做这个？Year 列为空或 null 的现有记录怎么办？

美化输出属于报表逻辑。在伪代码中它会是某事。像：

```
var lastYear = 0
foreach (record in records)
{
   if (record.Year == lastYear)
   {
     print "   "
   }
   else
   {
     print record.Year
     lastYear = record.Year
   }

   // print the other columns
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:38:43.023

不是你要求的答案，但是...

一开始在 MySQL 中做这件事听起来很可疑。仅查看原始数据行，2008 年和 2009 年第二季度的数据行似乎没有多大意义。这个问题是表象的，而不是获取数据的问题。听起来更像是要写入查看类的内容 - 例如，当传递某个参数时，它会知道不要重复“2008”之类的内容。

这还可以提高代码的可重用性：当您想要以不同的方式呈现数据时（例如按季度而不是按年份）而不是重写查询，您只需更改查看类的一个参数，以便相同的查询使用不同的 order 子句可以输出：

```
Quarter   Year   Total
Q1        2008   20
          2009   15
Q2        2008   25
          2009   20
... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-19T16:05:48.480

它不完全符合您的要求，但我宁愿转动我的桌子。它允许直观地比较 2 年的数据，因为每列有四分之一：

```
SELECT Year, 
       SUM(IF(Quarter="Q1", Rev, 0)) AS Q1,
       SUM(IF(Quarter="Q2", Rev, 0)) AS Q2, 
       SUM(IF(Quarter="Q3", Rev, 0)) AS Q3, 
       SUM(IF(Quarter="Q4", Rev, 0)) AS Q4 
FROM t1 GROUP BY 1
ORDER BY 1 
```

然后你有：

```
YEAR Q1   Q2   Q3   Q4
2008
2009 
```

# c# - 如何从 WPF 中的 DataTemplateSelector 类中查找 UserControl 中的资源？

> ID：916012
> 
> 赞同：5
> 
> 时间：2009-05-27T14:27:15.887
> 
> 标签：c#, .net, wpf, resources, wpf-controls

我正在创建自己的 UserControl，并且在 XAML的**UserControl.Resources部分下有两个不同的 DataTemplates。**我想根据列表视图中显示的对象的属性值在这两个数据模板之间进行选择。我通过创建一个自定义**DataTemplateSelector**类并覆盖应该返回我希望使用的 DataTemplate的**SelectTemplate方法来做到这一点。**但是，我不知道如何“找到”位于 UserControls 资源部分的数据模板，我看到的所有示例都只从**Window.Resources**获取数据模板。在此示例中，他们获取当前**MainWindow**，然后使用**FindResource**查找**DataTemplate**，我如何以类似的方式获取我的**UserControl ？：**

```
 public override DataTemplate 
            SelectTemplate(object item, DependencyObject container)
        {
            if (item != null && item is AuctionItem)
            {
                AuctionItem auctionItem = item as AuctionItem;
                Window window = Application.Current.MainWindow;

                switch (auctionItem.SpecialFeatures)
                {
                    case SpecialFeatures.None:
                        return 
                            window.FindResource("AuctionItem_None") 
                            as DataTemplate;
                    case SpecialFeatures.Color:
                        return 
                            window.FindResource("AuctionItem_Color") 
                            as DataTemplate;
                }
            }

            return null;
        } 
```

上面的例子来自这里：[ItemsControl.ItemTemplateSelector Property](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplateselector.aspx)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T14:31:45.270

我通常在 DataTemplateSelector 的构造函数中使用 UserControl 作为参数从后面的代码中实例化我的 DataTemplateSelector，如下所示：

```
public class MyUserControl : UserControl
{
    public MyUserControl()
    {
        Resources["MyDataTemplateSelector"] = new MyDataTemplateSelector(this);
        InitializeComponent();
    }
}

public class MyDataTemplateSelector : DataTemplateSelector
{
    private MyUserControl parent;
    public MyDataTemplateSelector(MyUserControl parent)
    {
        this.parent = parent;
    }

    public override DataTemplate SelectTemplate(object item, DependencyObject container)
    {
        parent.DoStuff();
    }
} 
```

不是镇上最漂亮的女孩，但它完成了工作；）

希望这可以帮助！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-08-17T13:20:56.283

试试这个：

```
 public override DataTemplate SelectTemplate(object item, DependencyObject container)
    {
        if (item != null && item is AuctionItem)
        {
            AuctionItem auctionItem = item as AuctionItem;

            switch (auctionItem.SpecialFeatures)
            {
                case SpecialFeatures.None:
                    return 
                        ((FrameworkElement)container).FindResource("AuctionItem_None") 
                        as DataTemplate;
                case SpecialFeatures.Color:
                    return 
                        ((FrameworkElement)container).FindResource("AuctionItem_Color") 
                        as DataTemplate;
            }
        }

        return null;
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-25T22:16:47.763

```
 <DataTemplate x:Key="addTemplate">
        <Button Command="{Binding Path=AddCommand}">Add</Button>
    </DataTemplate>

    <DataTemplate x:Key="editTemplate">
        <Button Command="{Binding Path=UpdateCommand}">Update</Button>
    </DataTemplate>

    <TemplateSelectors:AddEditTemplateSelector
        AddTemplate="{StaticResource addTemplate}"
        EditTemplate="{StaticResource editTemplate}"
        x:Key="addEditTemplateSelector" /> 
```

仅限 XAML！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-20T13:52:38.740

WinRT 和 Windows Phone 解决方案涉及向上移动可视化树，直到找到父控件：

```
 protected override Windows.UI.Xaml.DataTemplate SelectTemplateCore(object item, Windows.UI.Xaml.DependencyObject container)
    {
        var parent = FindParent<MyParentControlType>(container as FrameworkElement);

        if(parent != null)
        {
            if (item is Something)
                return parent.Resources["TemplateForSomething"] as DataTemplate;
            else if(item is SomethingElse)
                return parent.Resources["TemplateForSomethingElse"] as DataTemplate;
            else 
                // etc
        }
        else
        {
            return App.Current.Resources["SomeFallbackResource"] as DataTemplate;
        }
    }

    public static T FindParent<T>(FrameworkElement element) where T : FrameworkElement
    {
        FrameworkElement parent = Windows.UI.Xaml.Media.VisualTreeHelper.GetParent(element) as FrameworkElement;

        while (parent != null)
        {
            T correctlyTyped = parent as T;

            if (correctlyTyped != null)
                return correctlyTyped;
            else
                return FindParent<T>(parent);
        }

        return null;
    } 
```

FindParent 方法基于此处接受的答案：[如何从 ListViewItem 获取 ListView？](https://stackoverflow.com/questions/4769916/how-to-get-a-listview-from-a-listviewitem)

# clickonce - ClickOnce、SQLExpress 和预测名称

> ID：916018
> 
> 赞同：0
> 
> 时间：2009-05-27T14:28:16.463
> 
> 标签：clickonce, connection-string, sql-server-express

我有一个需要安装 SQLExpress 的 winform 应用程序。如何预测将调用什么 SQL 实例，以便我的连接字符串仍然有效。./SQLEXPRESS? 用户名/SQLEXPRESS？还是完全不同的东西？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T21:53:19.123

首先，将数据库部署为数据文件。然后它将被放置到 ApplicationDeployment.DataDirectory （部署时）或 Application.StartupPath （测试时）定义的文件夹中。

然后您需要检查程序运行的上下文：

```
string databaseLocation;
if (ApplicationDeployment.IsNetworkDeployed)
{
    databaseLocation = ApplicationDeployment.CurrentDeployment.DataDirectory;
}
else
{  
    databaseLocation = System.Windows.Forms.Application.StartupPath;
}
databaseLocation = System.IO.Path.Combine(databaseLocation, "databasename.mdf"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T14:36:15.633

为什么要硬编码连接字符串？您确实应该让最终用户可以选择更改数据库的位置。

# mysql - django的数据库锁定问题

> ID：916026
> 
> 赞同：0
> 
> 时间：2009-05-27T14:29:26.037
> 
> 标签：mysql, django, multithreading, locking

我有一个与几个外部 API 交互的网页，为了加快速度（速度增加几乎是线性的，因为大部分时间都花在等待 http 响应等），代码是线程化的，因此它可以提取内容一次来自多个 API。

问题是，我遇到数据库锁定可能是因为来自 apis 的数据同时被多个线程写入数据库。

**我能做些什么来消除这个问题？**

PS - 请不要建议按顺序进行api调用......当多个用户同时导入数据时会出现同样的问题，除了没有线程，每个人都会变慢。我们谈论的是 15 秒和几分钟之间的差异。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T16:18:06.333

绝对不要用 SQLite 尝试这个：它的主要弱点是并发性。

如果 MySQL 显示同样的问题，那么您应该将所有数据收集在一起，然后从单个线程中写入。

# .net - 在 Visual Studio 中抑制 tlbimp 警告

> ID：916027
> 
> 赞同：4
> 
> 时间：2009-05-27T14:29:29.970
> 
> 标签：.net, visual-studio, visual-studio-2008, msbuild, tlbimp

在 Visual Studio C# 项目中，可以添加对 COM 库的引用。然后， Visual Studio 将在构建项目时使用[tlbimp.exe](http://msdn.microsoft.com/en-us/library/tt0cf3sx(VS.80).aspx)生成互操作程序集。.csproj 文件中的引用如下所示：

```
 <ItemGroup>
    <COMReference Include="TDAPIOLELib">
      <Guid>{F645BD06-E1B4-4E6A-82FB-E97D027FD456}</Guid>
      <VersionMajor>1</VersionMajor>
      <VersionMinor>0</VersionMinor>
      <Lcid>0</Lcid>
      <WrapperTool>tlbimp</WrapperTool>
      <Isolated>False</Isolated>
    </COMReference>
  </ItemGroup> 
```

但是，我在此处导入的 3rdparty 类型库会导致 tlbimp 发出一些警告。如何在 Visual Studio 中抑制这些警告？我试图将包装工具更改为

```
 <WrapperTool>tlbimp /silent</WrapperTool> 
```

但这导致视觉工作室抱怨

> 遇到一个错误，阻止加载引用“TDAPIOLELib”。包装工具“tlbimp /silent”不是有效的包装工具。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-22T03:17:22.980

除非 COM 库不断更改它的 COM 接口，否则您可以运行 typelib 导入器一次，然后从那时起在您的项目中引用互操作程序集。如果您有 reg free COM，则只需将 COM 库复制到您的构建输出文件夹中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T15:06:24.560

我最终使用 BeforeBuild 目标显式调用 tlbimp.exe：

```
 <Target Name="BeforeBuild">
     <Exec Command="tlbimp /silent ..\3rdparty\comlibrary.dll /out:..\bin\interop.comlibrary.dll" />
  </Target> 
```

这确实需要引用 interop.comlibrary.dll 二进制文件，在第一次构建之前打开项目时，Visual Studio 中的引用上会出现一个黄色的小警告标志。

# stored-procedures - 如何使用 IBM.Data.DB2.iSeries 为存储过程启用事务

> ID：916034
> 
> 赞同：1
> 
> 时间：2009-05-27T14:30:01.340
> 
> 标签：stored-procedures, transactions, db2, ibm-midrange

我正在尝试编写一个在 DB2 中执行一系列 DB2 iSeries 存储过程的客户端。我正在使用 IBM.Data.DB2.iSeries 提供程序，并且需要我的所有调用都在 .NET 事务中。似乎一切都被忽略并且数据被提交。任何指针......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T13:19:35.183

iSeries 上的数据库是否记录了日志？这是承诺控制所必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-31T16:04:14.630

我刚遇到同样的问题，发现问题不在.Net代码中，而在存储过程中。检查您的存储过程定义以获取 COMMIT 选项。如果它设置为“*NONE”，它将自动提交，无论您的 .Net 代码中的事务如何。将其更改为 *RR（可重复读取），您的事务应该可以正常工作。

更多信息[在这里](http://www.itjungle.com/fhg/fhg012407-story01.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T17:24:19.577

您在使用[DB2Connection.BeginTransaction 方法吗？](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.dndp.doc/htm/frlrfIBMDataDB2DB2ConnectionClassBeginTransactionTopic.htm)

# controls - ajax模式弹出扩展器的问题

> ID：916036
> 
> 赞同：0
> 
> 时间：2009-05-27T14:30:29.903
> 
> 标签：controls, ajaxcontroltoolkit

我在显示两个模式弹出窗口时遇到问题。场景是这样的：

我在按钮单击时显示一个模式弹出窗口。我在此模式弹出窗口中有另一个按钮。当我单击此按钮时，我会显示另一个模式弹出窗口。现在的问题是，当我显示第二个弹出窗口时，第一个弹出窗口仍然可以点击。我应该怎么做才能使用户无法单击第一个弹出窗口。

任何帮助将不胜感激

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T14:38:06.737

我之前遇到过这个问题……关于您将扩展器放置在与其面板相关的位置方面存在一些问题。我不记得具体哪个版本最终起作用了，但是您可以尝试以下组合。

例如

```
<!-- 2 Seperate Panels & Extenders -->
<ajt:ModalPopupExtender ID="mpe1" TargetControlID="pnl1" />
<asp:Panel ID="pnl1">
   <asp:Button ID="btn1" /> <!-- launches pnl2 popup -->
</asp:Panel>

<ajt:ModalPopupExtender ID="mpe2" TargetControlID="pnl2" />
<asp:Panel ID="pnl2">
   Content
</asp:Panel> 
```

比。

```
<!-- 2 Nested Panels & But separate Extenders -->
<ajt:ModalPopupExtender ID="mpe1" TargetControlID="pnl1" />
<asp:Panel ID="pnl1">
   <asp:Button ID="btn1" /> <!-- launches pnl2 popup -->
   <asp:Panel ID="pnl2">
       Content
   </asp:Panel>
</asp:Panel> 
<ajt:ModalPopupExtender ID="mpe2" TargetControlID="pnl2" /> 
```

比。

```
<!-- 2 Fully Nested Panels & Extenders -->
<ajt:ModalPopupExtender ID="mpe1" TargetControlID="pnl1" />
<asp:Panel ID="pnl1">
   <asp:Button ID="btn1" /> <!-- launches pnl2 popup -->
   <ajt:ModalPopupExtender ID="mpe2" TargetControlID="pnl2" />
   <asp:Panel ID="pnl2">
       Content
   </asp:Panel>
</asp:Panel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-12T18:28:09.453

您可以设置一个使页面变灰的背景 CssClass，也可以在后面的代码中捕获单击，并通过调用 externer.hide() 方法告诉它隐藏上一个弹出窗口，这将为您提供所需的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-09T01:18:28.227

我遇到了类似的问题。与其有 2 个模态弹出窗口，不如放置一个面板，其中有两个面板。父面板获取模态弹出扩展器，而里面的两个根据单击的按钮隐藏/显示。根据应用于模态的样式，在 CSS 中应用 z-index 将起作用，但是，我遇到了另一个模态。

有两个孩子的面板的快速代码示例是：

```
<asp:Panel id="pnlParent" runat="server">
<asp:panel id="pnlChild1" runat="server" visible="false">
... controls ...
</asp:Panel>
<asp:Panel id="pnlChild2" runat="server" visible="false">
</asp:panel>
<asp:ModalPopupExtender id="mpePnlParent" runat="server" ...other attributes .../> 
```

现在，在第一次单击按钮时，将 pnlchild1 的可见性设置为 true。pnlChild1 的按钮的 onclick 事件会将 pnlChild1 的可见性设置为 false，将 pnlChild2 的可见性设置为 true。

最后，在完成第二个子面板的任何操作中，隐藏两个子面板并使用面板的 .Hide() 方法隐藏 modalpopup。

这里有一些 CSS 可以在模态弹出窗口上尝试使主屏幕背景变灰，并“突出显示”模态内容

```
.modalBackground
{
    background-color: #000011;
    -moz-opacity: .60;
    filter: alpha(opacity=60);
    opacity: .60;
}
.modalPopup
{
    padding: 5px;
    border: 5px outset #00F;
    background-color: #FFF;
    width: 640px;
} 
```

上面的 CSS 是跨浏览器安全的。

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T14:35:09.803

假设这与html有关：

将第二个弹出窗口的 zindex 设置为高于第一个

第一个弹出窗口：

```
position:relative;
z-index:1; 
```

第二弹窗：

```
position:relative;
z-index:2; 
```

# c# - 从不属于 ASP.NET 内容页的类访问母版页的属性

> ID：916044
> 
> 赞同：1
> 
> 时间：2009-05-27T14:32:30.900
> 
> 标签：c#, asp.net, master-pages

所以我正在连接我的第一个 MasterPage，除了一件事之外，一切都很好。这是一个遗留应用程序，我有一个旧的 BasePage 类，我的所有内容页面都继承了它。它继承自 System.Web.UI.Page，但本身没有内容（没有 .aspx 文件）。它运行一堆用户身份验证/角色授予菜单构建。我想保留此功能，但使用它在我的 MasterPage 上设置控件以构建菜单。我一生都无法弄清楚如何在内容页面中没有 MasterType 声明的情况下引用 MasterPage 属性。

我的 MasterPage 类称为 NIMS_Master，其中包含以下内容（只是尝试开始）：

`public partial class NIMS_Master : System.Web.UI.MasterPage { public string MenuList { get; set; }`

 ````
 protected void Page_Load(object sender, EventArgs e)
    {}
  } 
````  `在我的一个内容页面中使用 MasterType 声明： `<%@ MasterType VirtualPath="~/NIMS_Master.master" %>`

我可以在 Login.aspx.cs 中访问我的属性，如下所示：

`this.Master.MenuList = "this is the menu list";`

但是在我的 BasePage.cs 中，我无处放置 MasterType 声明。所有的谷歌搜索都表明我必须将我的 NIMS_Master 课程设置为大师，但我无法让它发挥作用来挽救我的生命。我尝试了几种不同的方法，但我的 NIMS_Master 类没有出现在 BasePage 中。

`((this.Master)NIMS_Master).MenuList = "This is a menu list";`

BasePage.cs 位于我的 App_Code 目录中，而我的 MasterPage 文件位于应用程序根目录中，如果这很重要的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:38:25.163

在我看来，你的演员应该是： ((NIMS_Master)this.Master).MenuList

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:15:31.967

所以我在 App_Code 中有我的 BasePage 并试图设置我的 NIMS_Master 类的属性，该类位于应用程序根目录中。我必须在 App_Code 中创建一个从 System.Web.UI.MasterPage 继承的 MasterBase 类，并将我的属性放在那里。哎呀，我什至不确定为什么我认为我可以从 app_code 中访问这些类属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-23T22:57:25.360

MasterBase 也为我工作，感谢 fr0man。

在我的例子中，我的 master.aspx.cs 文件中有一个公共属性，我将它移到了一个新的 MasterBase 类中，以便它可以暴露给其他类。

第 1 步：在 App_Code 目录中创建一个新的 MasterBase.cs 文件。（以下是我的完整课程。）

```
public partial class MasterBase : System.Web.UI.MasterPage
{
    public string MyProperty = "Default";
} 
```

第 2 步：更新 Master.aspx.cs 文件以从您的基类而不是 System.Web.UI.MasterPage 继承，并删除您已移至 MasterBase 类的所有属性声明。（以下是该类的前几行。）

```
public partial class Master : MasterBase
{
    //The following is now defined in MasterBase.
    //public string MyProperty = "Default";
... 
```

第 3 步：将 page.Master 转换为 MasterBase 以访问其属性。

```
...
    IHttpHandler page = HttpContext.Current.Handler;
    if (page is System.Web.UI.Page)
    {
        MasterBase masterPage = (MasterBase)((System.Web.UI.Page)page).Master;
        if (masterPage != null)
            masterPage.MyProperty = "New Value";
    }
... 
```

# actionscript-3 - ActionScript 3.0：函数的序列化？

> ID：916045
> 
> 赞同：2
> 
> 时间：2009-05-27T14:32:39.417
> 
> 标签：actionscript-3

由于 Function 只是我想知道的另一种类型。是否可以在 actionscript 3.0 中序列化函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T23:01:16.100

借助 AS3，Adobe 为我们提供了足够的能力来在运行时创建、修改和运行 ByteCode。*您可以使用此运行时字节码*概念实现“函数序列化” 。

这可能会变得非常技术性，但我建议您阅读一些可以帮助您的库：

[Libspark 的 swfassist](http://www.libspark.org/wiki/yossy/swfassist)

[Hurlant的AS3Eval](http://eval.hurlant.com/)

我还应该指出，*AS3Eval*应该更容易理解——据我所知， *swfassist*没有英文文档。使用*AS3Eval*，您可以将代码修改为字符串并实时执行，就像旧的*eval*方法一样。

当然，您可以采用硬核风格并在字节码读取/序列化方面实现复杂的系统，但使用此类库会使它变得非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T14:38:11.513

您的意思是不仅要序列化指向函数的指针，还要序列化实际的函数内容，然后将它们发送到远程机器？我不相信你能做到这一点，你必须使用某种类型的远程处理来做这样的事情。

# multithreading - 什么是 CPU 线程，它与代码中的逻辑线程有什么关系？

> ID：916048
> 
> 赞同：7
> 
> 时间：2009-05-27T14:33:40.867
> 
> 标签：multithreading, cpu-architecture, hyperthreading

我在文献中看到了一些较新的 CPU，例如[Intel Xeon “Nehalem-EX”](http://www.intel.com/pressroom/archive/releases/20090526comp.htm)，它们具有 8 个内核和 16 个线程。他们在这里谈论什么？我在参考文献中也看到了这一点，所以 SPARCS 也肯定这不是由代码产生的那种逻辑线程吗？这种超线程是否被重新命名？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T14:46:20.217

是的，[基于 Nehalem 的](http://en.wikipedia.org/wiki/Intel_Nehalem_(microarchitecture))处理器实现[了超线程](http://en.wikipedia.org/wiki/Hyperthreading)。

您所指的新 Nehalem-EX 有 8 个物理内核，每个内核可以看作 2 个逻辑内核，总共 16 个逻辑内核，允许在单个处理器上执行 16 个应用程序线程。

这与支持超线程的 Pentium 4 处理器以及最近的 Atom 处理器中使用的技术相同。我的 Eee PC 有一个单核 Atom 处理器，它有两个逻辑核心——Windows 任务管理器将显示两个 CPU 图表；每个逻辑核心一个。

Sun 的[UltraSPARC T2](http://www.sun.com/processors/UltraSPARC-T2/)（和 T1）还允许[同时多线程](http://en.wikipedia.org/wiki/Hyperthreading)（英特尔的实现称为超线程——英特尔的商标），它允许单个内核显示为多个逻辑内核，以在单个内核上执行多个线程。

并发多线程背后的粗略思想是有多个寄存器来存储处理器状态，所以看起来一个内核实际上有多个内核，因为它有多个全套硬件寄存器。

虽然 ALU 和 FPU 等物理设施可能不会增加，但拥有更多寄存器集以在物理内核上运行更多线程可以更好地利用可用处理器资源。执行单个线程时内核可能尚未饱和，但执行多个线程可以使所有单元充分发挥其潜力。

那么这对程序员意味着什么呢？

这意味着我们仍然需要编写多线程软件——只有一个线程的程序将只能使用一个逻辑核心。只有拥有编写良好的多线程代码，我们才能利用这些处理器提供的大量逻辑内核。

即使使用同时多线程，代码也是在每个逻辑核心一个线程上执行的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T15:17:18.860

多线程处理器的一个极端是桶形处理器。这是一种 SMT 形式，其中处理器以循环方式平均分配多个线程之间的插槽。为此，它只需要在使用同一组执行单元时复制各种寄存器。因此，在 4 个时钟周期内，它会将线程 0-3 中的代码放入流水线中。

您可以认为这些处理器的其余部分或多或少地以类似的方式工作。由于处理器中的控制或数据危害，它可能只是用完空的插槽，而不是平均分配插槽。

例如，当采用分支时，可能需要刷新流水线中的指令。一些插槽可以用于其他线程，而不是完全刷新所有内容。整个想法是通过不浪费 CPU 周期来提高性能。

这就是多线程在硬件中的工作方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T14:40:07.763

超线程（顺便说一下，INTEL 的商标）允许每个线程实际同时运行。因此，在这种情况下，您可以同时运行 8X2 应用程序线程。

从宣传册...

基于英特尔独特的 45nm 高 k 金属栅极技术工艺的英特尔 Nehalem 架构

```
 Up to **8 cores** per processor
 Up to **16 threads per processor** with Intel® Hyper-threading
 2.3 billion transistors 
```

将此与单 CPU、单核系统进行比较，在单核系统中，每个线程都必须被调度，并且最多只有一个线程处于活动状态——一个正在运行的 CPU 绑定任务，而其他的则等待 I/O 传输。

最初，线程要么用于建模一组并发活动（不是模型实际上不是并行运行），要么用于产生即使在执行 I/O 时也能响应的系统外观。例如，如果没有线程，您的文字处理器会在保存文档时停止。

多年来，我一直反对在我的桌面应用程序中使用多个线程的想法——这会使代码复杂化并可能降低性能——想想所有需要操作系统内核参与的互斥操作。随着线程实际上并行执行的出现，我的反对意见减少了，但我仍然相信多个进程而不是单个进程中的多个线程是更好的方法。

克里斯

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T14:46:43.350

它不是重命名的超线程 - 它是超线程（它写在您提供链接的此网页上）。

简单地说，处理器告诉操作系统它有 16 个内核，因此它可以在双倍内核上平衡任务。超线程技术带来了一些好处，因为在某些情况下，来自两个不同程序/线程的两条不同指令可以同时在一个内核上执行。但可以肯定的是，它不会提供 200% 的加速。我没有在这样的处理器上工作，但我认为你可以获得大约 10%-20% 的额外 CPU 时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T15:12:47.167

将操作系统级线程映射到问题中描述的硬件级线程取决于每个操作系统的线程模型。

由应用程序程序员使用的高级编程语言产生的逻辑线程仍然是从硬件中删除的操作系统级别，除非您当然在谈论执行映射的操作系统代码。

# design-patterns - 缓存管理

> ID：916049
> 
> 赞同：0
> 
> 时间：2009-05-27T14:34:35.310
> 
> 标签：design-patterns, architecture

我正在构建一个 Web 应用程序，我想管理多个对象的缓存，所以我不必每次都去数据库。我的问题是这个对象的数据可以被数据库上的其他应用程序修改。有谁知道让我的缓存对象与 BD 同步的好模式？我读了这篇文章（www.developer.com/java/other/article.php/630481），但它没有解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:48:42.147

一个好的模式是“观察者模式”。这个想法是，任何更改对象的应用程序都会将对象的 ID 发送到任何使用对象的人都可以注册自己的中心位置。当接收到事件时，所有侦听器都会收到带有对象 ID 的消息，以便他们可以更新缓存（或刷新缓存）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T14:38:11.573

您是使用 Java 还是其他语言工作？在 .Net 中有 SqlCacheDependency ( [http://msdn.microsoft.com/en-us/library/ms178604.aspx](http://msdn.microsoft.com/en-us/library/ms178604.aspx) )。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T22:02:28.060

一个好的起点可能是 ehcache 的文档，特别是[分布式缓存与 ehcache](http://ehcache.sourceforge.net/documentation/distributed_caching.html)一章。ehcache 是 Java 中流行的缓存框架。

# c# - 是否可以将对象“转换”为更专业的对象？

> ID：916050
> 
> 赞同：0
> 
> 时间：2009-05-27T14:34:38.447
> 
> 标签：c#, .net, inheritance

问题是我需要一个我无法更改的类对象的一些额外功能（我正在尝试添加数据绑定支持）。我能想到的最好的解决方案就是编写一个具有此功能的派生类。所以我可以使用这个类的对象。那么现在的问题是，如何初始化新类的对象？我可以用原始对象作为参数创建一个构造函数，并用这个对象的值初始化派生对象，但对我来说这似乎不是最聪明的解决方案。如果我能做这样的事情会很好：

```
// MyDerivedClass is derived from ObjectOfAnUnchangeableClass.
MyDerivedClass Obj = ObjectOfAnUnchangeableClass as MyDerivedClass; 
```

这当然行不通，因为 ObjectOfAnUnchangeableClass 不知道 MyDerivedClass。另一个想法是有一个可以用对象“初始化”的构造函数。就像是：

```
public MyDerivedClass(UnchangeableClass obj): base(obj){} 
```

这里的想法是，不是让基本构造函数构建一个新对象；它可以只取现有的对象。

所以我有两个问题：

1.  .net 中是否有一些概念支持上面提到的东西？
2.  在无法更改的类中具有一些额外功能的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T14:38:30.623

您自己刚刚回答了这个问题 - 执行此操作的“标准”方法是在派生类的构造函数中获取基类的实例。[这是装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)的一个例子

从维基百科页面

> 在面向对象的编程中，装饰器模式是一种设计模式，它允许将新的/附加的行为动态地添加到现有的类中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T14:45:30.077

一些可能的替代方案：

*   创建一个包装类，而不派生自`ObjectOfAnUnchangeableClass`，这可能不意味着派生自
*   [扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

PS：关于数据绑定和扩展方法，你看过这个帖子吗？
[如何在数据绑定控件中使用 Eval 调用扩展方法](https://stackoverflow.com/questions/372382/how-to-call-extension-methods-using-eval-in-a-databound-control)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T14:37:13.947

我认为[Duck Typing](http://haacked.com/archive/2007/08/19/why-duck-typing-matters-to-c-developers.aspx)可能会对您有所帮助。这基本上允许您在与继承无关但在其字段外观上相关的类之间“转换”。看起来他们现在使用动态代理类来进行类型之间的转换。我不确定这在幕后是如何工作的，但我会找出答案的。

语法是这样的

```
MyDerivedClass Obj = 
     DuckTyping.Cast<MyDerivedClass>(ObjectOfAnUnchangeableClass); 
```

本质上，它会将**ObjectOfAnUnchangeableClass**中的所有字段复制到具有相同名称的**MyDerivedClass中。**您可以使用您描述的方法归档相同的行为，但如果您不喜欢这样，请尝试使用[此库](http://www.deftflux.net/blog/page/Duck-Typing-Project.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T14:42:46.637

这是第三种选择 - 创建一个不扩展`UnchangeableClass`但包含您可以使用的实例的新类型，然后从该新类型公开任何新方法：

```
class MyDerivedClass
{
    UnchangeableClass unchangeableClass;

    public MyDerivedClass(UnchangeableClass obj)
    {
        this.unchangeableClass = obj;
    }

    // other methods to support whatever you need
} 
```

我相信这比创建派生类型更简单、更清晰。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T14:42:42.190

1.  也许是类型转换器？
2.  你可以做一个扩展方法 - UnchangeableClass.ToMyDerivedClass();

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T14:40:56.063

调用派生类的构造函数并将原始类作为参数传递非常简单。如果原类已经有了拷贝构造函数，就不需要自己拷贝属性了。

第二个问题，如何添加功能：这取决于您需要添加什么样的功能。除了继承之外，还有扩展方法，还有不少针对特殊情况的设计模式。

# c - 是否有任何平台指向不同类型的指针具有不同的大小？

> ID：916051
> 
> 赞同：63
> 
> 时间：2009-05-27T14:35:02.627
> 
> 标签：c, pointers, sizeof

C 标准允许指向不同类型的指针具有不同的大小，例如`sizeof(char*) != sizeof(int*)`是允许的。但是，它确实要求如果指针转换为 a`void*`然后又转换回其原始类型，则它必须与原始值进行比较。因此，从逻辑上讲，`sizeof(void*) >= sizeof(T*)`对于所有类型`T`，正确吗？

在当今使用的大多数常见平台（x86、PPC、ARM 和 64 位变体等）上，所有指针的大小都等于本机寄存器大小（4 或 8 字节），无论指向的类型如何。是否有任何深奥或嵌入式平台，其中指向不同类型的指针可能具有不同的大小？我特别询问*数据*指针，尽管我也想知道是否存在*函数*指针具有异常大小的平台。

我绝对*不是*在问 C++ 的指向成员的指针和指向成员函数的指针。它们在通用平台上具有不同寻常的大小，甚至可以在一个平台内变化，具体取决于指向类的属性（非多态、单继承、多继承、虚拟继承或不完整类型）。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-10-08T17:07:51.567

[C常见问题解答](http://c-faq.com/null/machexamp.html)：

> Prime 50 系列使用段 07777，空指针偏移量 0，至少对于 PL/I。后来的模型使用段 0，偏移量 0 表示 C 中的空指针，需要新的指令，例如 TCNP（测试 C 空指针），显然是对所有现有的编写不佳的 C 代码做出错误假设的一种做法。较旧的字寻址 Prime 机器也因需要比字指针 (int *) 更大的字节指针 (char *) 而臭名昭著。
> 
> Data General 的 Eclipse MV 系列具有三种体系结构支持的指针格式（字、字节和位指针），其中两种由 C 编译器使用：用于 char * 和 void * 的字节指针，以及用于其他所有内容的字指针。由于历史原因，在 32 位 MV 线从 16 位 Nova 线演变而来的过程中，字指针和字节指针在字的不同位置具有偏移、间接和环保护位。将不匹配的指针格式传递给函数会导致保护错误。最终，MV C 编译器添加了许多兼容性选项来尝试处理存在指针类型不匹配错误的代码。
> 
> 一些 Honeywell-Bull 大型机将位模式 06000 用于（内部）空指针。
> 
> CDC Cyber​​ 180 系列具有 48 位指针，由环、段和偏移量组成。大多数用户（在环 11 中）的空指针为 0xB00000000000。在旧的 CDC 补码机器上，使用全一位字作为各种数据（包括无效地址）的特殊标志是很常见的。
> 
> 旧的 HP 3000 系列对字节地址使用与字地址不同的寻址方案；像上面的几台机器一样，它因此对 char * 和 void * 指针使用与其他指针不同的表示。
> 
> Symbolics Lisp Machine，一种标记架构，甚至没有传统的数字指针；它使用该对（基本上是一个不存在的句柄）作为 C 空指针。
> 
> 根据使用的“内存模型”，8086 系列处理器（PC 兼容）可以使用 16 位数据指针和 32 位函数指针，反之亦然。
> 
> 一些 64 位的 Cray 机器在一个字的低 48 位中表示 int *；char * 还使用高 16 位中的一些位来指示字中的字节地址。
> 
> 附加链接：[来自 Chris Torek 的消息，](http://c-faq.com/null/wierdptrs.ct.html)其中包含有关其中一些机器的更多详细信息。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-27T14:41:37.793

不是您要问的，但是在 16 位 DOS/Windows 时代，您确实有指针和远指针之间的区别，后者是 32 位的。

我可能语法错误...

```
int *pInt = malloc(sizeof(int));
int far *fpInt = _fmalloc(sizeof(int));

printf("pInt: %d, fpInt: %d\n", sizeof(pInt), sizeof(fpInt)); 
```

输出：

pInt：2，fpInt 4

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-27T15:08:46.333

*因此，从逻辑上讲，`sizeof(void*) >= sizeof(T*)`对于所有类型 T，正确吗？*

这不一定遵循，因为 sizeof 是关于存储表示的，并非所有位模式都必须是有效值。我认为您可以编写一个符合要求的实现，其中`sizeof(int*) == 8`, `sizeof(void*) == 4`，但 int* 的可能值不超过 2^32 个。不知道你为什么想要。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-27T14:39:17.203

回到 DOS、8088 和分段内存的黄金年代，通常会指定一种“内存模型”，其中所有代码都适合 64k（一个段），但数据可以跨越多个段。这意味着函数指针是 2 个字节，一个数据指针是 4 个字节。不确定是否有人仍在为这种机器编程，也许有些人仍然在嵌入式使用中幸存下来。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-27T14:49:50.710

可以很容易地想象一台哈佛架构机器具有不同大小的函数指针和所有其他指针。不知道有什么例子...

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-27T15:51:09.790

在一些带有分页闪存或 RAM 的嵌入式微控制器上仍然使用近指针和远指针，以允许您指向同一页（近指针）或另一个页（远指针，因为它包含页信息而更大）中的数据。

例如，飞思卡尔的 HCS12 微控制器采用 16 位冯诺依曼架构，这意味着任何地址都不能超过 16 位。由于这会对可用代码空间量造成限制，因此有一个 8 位页面寄存器。

因此，要指向同一代码页中的数据，只需指定 16 位地址即可；这是一个近指针。

要指向另一个代码页中的数据，您必须在该页中同时包含 8 位页号和 16 位地址，从而生成 24 位远指针。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-03-10T12:59:57.157

例如，指向数据的指针的大小可能不同于指向函数的指针。这在嵌入式系统的微处理器中很常见。像 dmckee 提到的哈佛架构机器使这很容易发生。

事实证明，它让 gcc 后端开发起来很痛苦！:)

编辑：我无法详细介绍我正在谈论的特定机器，但让我补充一下为什么哈佛机器让这很容易发生。哈佛架构有不同的存储和指令和数据的路径，因此如果指令总线比数据总线“大”，那么你一定会有一个函数指针，其大小比指向数据的指针大！

# c - 主/工作线程和信号处理

> ID：916056
> 
> 赞同：6
> 
> 时间：2009-05-27T14:35:32.780
> 
> 标签：c, linux, multithreading, pthreads, posix

我正在编写一个程序，有一个主线程和一些工作线程，我想正确处理信号。我的问题如下：

主线程启动并进行所有分配

主线程设置一个 SIGINT 信号处理程序

主线程启动工作线程。工作线程不需要特殊的清理，但是它们可以在系统调用或信号量上休眠。

当收到 SIGINT 时，我的理解是只有一个线程收到它。因此，如果线程在系统调用或信号量上处于休眠状态，它们将不会被唤醒，并且我将无法 pthread_join 我的工作线程并在我的主线程中进行所有必要的清理。

以下信号处理程序可以解决我的问题吗？

```
void term(int sig)
{
    g_do_cleanup = 1;
    pthread_kill(worker_1_id, some_other_signal);
    ...
    pthread_kill(worker_2_id, some_other_signal);
} 
```

我期望的是，在收到 SIGINT 后，所有线程都会收到另一个信号，退出阻塞调用，看到`g_do_cleanup`标志并优雅地退出。

欢迎任何关于如何正确执行此操作的评论或链接。

编辑：我不是在寻找一种方法来唤醒等待特定条件的多个线程，所以我不认为 pthread_cond_signal 方法是我正在寻找的。我想要的是：

*   找到一种方法，使在阻塞调用中被阻塞的所有线程都从这些调用中返回。
*   或者杀死除主线程之外的所有线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T02:31:38.403

这是我通常在主应用程序线程中所做的：

```
 /* before starting other threads */
sigset_t sigs;
sigemptyset( &sigs );
sigaddset( &sigs, SIGTERM );
sigaddset( &sigs, SIGINT );
/* add other signals to handle */
if ( pthread_sigmask( SIG_BLOCK, &sigs, 0 )) { /* handle error */ }
/* can start threads now */
...
/* in the main event loop */
siginfo_t info;
if ( sigwaitinfo( &sigs, &info ) == -1 ) { /* handle error */ }
switch( info.si_signo )
{
  case SIGTERM:
  case SIGINT: /* raise shutdown event */ break;
  default: /* other actions - log rotation, etc. */
}
... 
```

这种方式信号成为常规应用程序事件 - 没有特殊的信号上下文限制等。等待也可以通过超时来完成`sigtimedwait`，尽管 BSD 衍生产品不支持它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T15:09:17.907

在我看来，您想要的是一个 pthread 条件变量，这样您就可以通过从主线程中选择一个“事件”来唤醒任意数量的多个线程。

有关详细信息，请参阅[PTHREAD_COND_DESTROY](https://computing.llnl.gov/tutorials/pthreads/man/pthread_cond_init.txt)和[PTHREAD_COND_BROADCAST](https://computing.llnl.gov/tutorials/pthreads/man/pthread_cond_signal.txt)的手册页。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T20:06:40.053

你的计划似乎很好。您正在强制一个线程处理系统信号。您需要使用 pthread-sigmask() 屏蔽工作线程中除其他信号之外的信号。

我想我会用一个单独的线程来处理进程信号而不是主线程。在等待运行信号处理程序时，让它永远等待信号量或 sigwait() 或其他任何东西。将 pthread-kill 代码移出信号处理程序。只需设置开关并让信号等待线程将 other_signal 发送到工作线程并自行退出。

# c# - 需要的建议：在 C# 中解析 HTML 的最佳方法

> ID：916057
> 
> 赞同：0
> 
> 时间：2009-05-27T14:35:41.767
> 
> 标签：c#, html

这是我的问题。这是从 HTML 页面中提取某些信息的最佳方式。我目前做的是以下几点：

1.  使用 WebClient 下载页面

2.  使用 UTF8Encoding 将接收到的数据转换为字符串

3.  将字符串转换为 XML

4.  使用 .NET Framework 中的 Xml 相关类提取所需数据

这就是我目前所做的总结形式。有人知道另一种方法吗？可以更快或更容易的东西吗？

最好的问候，基里尔

PS：听说有一个测试框架叫[Watin](http://watin.sourceforge.net/gettingstarted.html)

允许你做类似的事情，但没有研究太多

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T14:40:36.670

听起来您已经知道如何获取页面数据（这是最简单的部分）。

剩下的，我用于此类任务的最佳托管库是[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)。它是开源的并且非常成熟，完全用 .NET 编写。它处理格式错误的 HTML，并且可以通过两种不同的方式完成您需要的操作：

*   原生支持针对 HTML DOM 的 XPATH 和类似 XML 的查询。它旨在模仿 .NET 的 XML 库，因此您可以使用 .NET 对 XML 执行任何操作，也可以使用此对 HTML 执行任何操作。

*   支持从 HTML 生成有效的 XML，因此您可以使用任何 XML 工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T14:45:55.663

对于您的解析需求，我推荐[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)。

要实际检索 HTML，请使用 [WebRequest](http://msdn.microsoft.com/en-us/library/debx8sh9.aspx)类

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:40:07.110

除非您使用格式完美的 XHTML 正则表达式会更适合解析 html？

Watin 允许您通过 IE 在网页上编写按钮单击、脚本调用等脚本（不确定是否可以使用其他浏览器？）。我不认为这会完成你正在寻找的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T14:49:30.723

通过使用我相信的 WebClient.DownloadString 方法，这可以稍微简化。

有关解析的详细信息，请参阅其他答案，因为我没有尝试过 HTML Agility Pack。

# java - 如何使用 RSA 公钥加密 java.util.Properties 对象（可以是任意大小）？

> ID：916061
> 
> 赞同：2
> 
> 时间：2009-05-27T14:36:40.563
> 
> 标签：java, security, encryption, rsa

这是我目前正在使用的代码。它使用 BouncyCastle 提供程序。

```
static
{
   Security.addProvider(new BouncyCastleProvider());
}

protected String encrypt(byte[] keyData, byte[] data) throws Exception {
   X509EncodedKeySpec keyspec = new X509EncodedKeySpec(keyData);
   KeyFactory kf = KeyFactory.getInstance("RSA", "BC");
   PublicKey pk = kf.generatePublic(keyspec);
   Cipher rsa =  Cipher.getInstance("RSA/None/OAEPWithSHA1AndMGF1Padding", "BC");
   rsa.init(Cipher.ENCRYPT_MODE, pk);
   byte[] output = rsa.doFinal(data);
   String result = base64EncodeBytes(output);
   return result;
} 
```

我目前正在获得一个

```
 java.lang.ArrayIndexOutOfBoundsException: too much data for RSA block
    at org.bouncycastle.jce.provider.JCERSACipher.engineDoFinal(Unknown Source)
    at javax.crypto.Cipher.doFinal(DashoA13*..)
    at Encryption.encrypt(RSAToken.java:60) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T14:45:46.863

使用 RSA 加密大量数据并不是一个好习惯。

加密协议采用的方法是生成一个对称密钥，用它来加密数据，然后使用 RSA 加密该对称密钥。

这就是 PGP 和 S/MIME 的工作方式。它还可以轻松地允许多个读取器解密数据——通过为每个预期接收者加密对称密钥，而不是为每个接收者加密整个数据。

# php - 正则表达式从字符串中获取信息

> ID：916062
> 
> 赞同：1
> 
> 时间：2009-05-27T14:36:51.360
> 
> 标签：php, regex

如何填充这样的数组：

```
array('0' => 'blabla','1' => 'blabla2') 
```

从这样的字符串：

```
'#blabla foobar #blabla2' 
```

使用`preg_match()`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T14:41:18.947

您应该[`preg_match_all()`](http://www.php.net/preg_match_all)为此使用：

```
preg_match_all('/#(\S+)/', $str, $matches, PREG_PATTERN_ORDER);
$matches = $matches[1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T14:42:29.600

```
$string = "#wefwe dcdfg qwe #wef";
preg_match_all('/#(\w+)/', $string, $matches);
var_dump($matches);
array(2) {
  [0]=>
  array(2) {
    [0]=>
    string(6) "#wefwe"
    [1]=>
    string(4) "#wef"
  }
  [1]=>
  array(2) {
    [0]=>
    string(5) "wefwe"
    [1]=>
    string(3) "wef"
  }
} 
```

这是一种方法:-)

# ruby-on-rails - 如何在 Rails 测试中轻松解析带有参数的 URL？

> ID：916067
> 
> 赞同：19
> 
> 时间：2009-05-27T14:37:57.800
> 
> 标签：ruby-on-rails, ruby, testing, url, parsing

我有一些代码将`return_to`URL 嵌入到我想要测试的重定向（如 OpenID）中：

```
def test_uses_referrer_for_return_to
  expected_return_to = 'http://test.com/foo'
  @request.env['HTTP_REFERER'] = expected_return_to
  get :fazbot
  # @response.redirected_to looks like http://service.com?...&return_to=[URI-encoded version of URL above]&...
  encoded_return_to = (something_here)[:return_to]
  assert_equal expected_return_to, URI.unencode(encoded_return_to)
end 
```

这是一个 Rails `ActionController::TestCase`，所以我可以使用各种辅助方法；我只是找不到合适的。

当然，我可以`URI.parse`用来获取 URL 的 params 部分，然后将其拆分`/&|?/`，然后再次拆分`'='`，但我希望这已经为我完成了。另外，如果我在 URL 转义或参数解析中遗漏了一些晦涩的规则怎么办？*必须*有一些东西`ActionPack`或`ActiveSupport`做这件事，但我找不到。

谢谢 ：）

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-27T15:25:40.450

`CGI::parse(querystring)`将查询字符串解析为哈希。然后，`CGI::unescape(string)`将撤消值中的任何 URL 编码。

或者，`Rack::Utils.parse_query`如果`Rack::Utils.unescape`您使用的是最新的基于 Rack 的 Rails 版本，并且想要超级现代，则可以使用。

我不知道包装这些实用程序函数的任何 Rails 特定的帮助方法，但它们使用起来非常简单，而且 CGI 或 Rack 已经加载到 Rails 环境中。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-06-03T15:12:18.523

为此，您需要[Addressable](https://rubygems.org/gems/addressable/)。

```
uri = Addressable::URI.parse("http://example.com/?var=value")
uri.query_values # => {"var"=>"value"}
uri.query_values = {"one" => "1", "two" => "2"}
uri.to_s # => "http://example.com/?two=2&one=1" 
```

它会自动为您处理所有转义规则，并且它还有一些其他有用的功能，例如不会为完全有效但晦涩的 URI （如内置 URI 解析器）抛出异常。

# sql-server-2005 - SQL Server 2005 计算列被持久化

> ID：916068
> 
> 赞同：28
> 
> 时间：2009-05-27T14:37:59.173
> 
> 标签：sql-server-2005, calculated-columns

我在表中有一些计算列，需要知道是否应该将 Is Persisted 设置为 true。有什么优势？有什么缺点吗？“持续存在”是什么意思？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-27T14:43:01.020

在这种情况下，“持久化”意味着“物理存储”。

这意味着计算值在插入（和更新）时计算一次并存储在磁盘上，因此不必在每次选择时再次计算。

持久化还会导致插入和更新的性能损失，因为必须计算列，但会提高后续选择查询的性能。

所以，这取决于你的使用模式，遵循哪种方法：如果你不经常更新，但查询很多，你应该设置persisted = true。

如果你更新频繁，或者你不关心检索性能，你应该考虑设置persisted = false

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-08T19:33:34.303

其他答案中没有提到的另一件事：计算列必须是 PERSISTED 才能从 FOREIGN KEYs 中使用。

# visual-studio - VS2008和VS2010在同一台机器上

> ID：916076
> 
> 赞同：1
> 
> 时间：2009-05-27T14:38:37.953
> 
> 标签：visual-studio

> **可能重复：**
> [将 Visual Studio 2010 Beta 与 VS2008 并排安装会导致问题吗？](https://stackoverflow.com/questions/879913/will-installing-visual-studio-2010-beta-side-by-side-with-vs2008-cause-problems)

两者可以在同一台机器上共存吗？

谢谢

# .net - 当 Directory.GetFiles() 找到它不“喜欢”的文件名时抛出异常时如何处理异常？

> ID：916080
> 
> 赞同：3
> 
> 时间：2009-05-27T14:39:04.677
> 
> 标签：.net, exception, windows-vista, macfuse

在具有有效路径 C:\Users\David 的 Vista 机器上，调用 Directory.GetFiles(@"C:\Users\David") 以 David 用户身份运行时会引发以下 ArgumentException，后者可以查看目录的内容在 Windows 资源管理器中很好：

```
System.ArgumentException message: Illegal characters in path.
Argument: ""
Stack trace:
   at System.IO.Path.CheckInvalidPathChars(String path)
   at System.IO.Path.InternalCombine(String path1, String path2)
   at System.IO.Directory.InternalGetFileDirectoryNames(String path, String userPathOriginal, String searchPattern, Boolean includeFiles, Boolean includeDirs, SearchOption searchOption)
   at System.IO.Directory.GetFiles(String path, String searchPattern, SearchOption searchOption)
   at System.IO.Directory.GetFiles(String path)
   at Microsoft.Samples.XFileExplorer.ContentView.CreateContentDataTable(String CurrentFolder) in C:\Users\david\Downloads\MEF Preview 5\MEF Preview 5\Samples\XFileExplorer\XFileExplorer\ContentView.xaml.cs:line 108 
```

Vista 机器恰好被运行 MacFuse 的 Mac 访问过，因此该目录包含一个看似名为“._Icon”的文件，但实际上必须包含一些非法字符。我相信这是错误的根源。当 Directory.GetFiles() 遇到它不喜欢的文件名时抛出异常时，我留下了一个问题？是否有任何替代方法可以列出不通过此类异常的文件内容？

至于这个特定文件，我怀疑文件名必须包含一些 Windows 资源管理器或命令提示符未显示的字符：

```
 C:\Users\david>dir ._Icon
   Volume in drive C is Bootcamp
   Volume Serial Number is XXXX-XXX

   Directory of C:\Users\david

   File Not Found 
```

最后：

```
 C:\Users\david>dir ._Icon*
   Volume in drive C is Bootcamp
   Volume Serial Number is XXXX-XXX
   Directory of C:\Users\david

   05/25/2008  07:40 AM            43,296 ._Icon
           1 File(s)         43,296 bytes
           0 Dir(s)  58,950,623,232 bytes free 
```

查看 SMB 中的文件，看起来该文件实际上名为“._Icon？”。每次我尝试从 Mac 中删除该文件时，该文件似乎都会立即重新出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T11:28:48.573

*您可以尝试使用 PInvoke FindFirstFile*列出文件吗？请[参见此处](http://www.pinvoke.net/default.aspx/kernel32.FindFirstFile)。是否会导致类似的问题？

文件信息将在[WIN32 FIND DATA](http://www.pinvoke.net/default.aspx/Structures/WIN32_FIND_DATA.html) 结构中返回。然后为每个文件调用[FindNextFile](http://www.pinvoke.net/search.aspx?search=FindNextFile&namespace=[All])，直到它不返回 0。在结构中，您可以使用 cFileName 成员获取文件名。检查那里有什么无效的。

我的观点是，这可能会返回 Directory.GetFiles 喷出的文件信息。

这是它的使用示例：

```
public const int MAX_PATH = 260;
 public const int MAX_ALTERNATE = 14;

[StructLayout(LayoutKind.Sequential)]
    public struct FILETIME {
    public uint dwLowDateTime;
    public uint dwHighDateTime;
 }; 

[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Unicode)] 
public struct WIN32_FIND_DATA {
    public FileAttributes dwFileAttributes;
    public FILETIME ftCreationTime; 
    public FILETIME ftLastAccessTime; 
    public FILETIME ftLastWriteTime; 
    public int nFileSizeHigh;
    public int nFileSizeLow;
    public int dwReserved0;
    public int dwReserved1;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst=MAX_PATH)] 
    public string cFileName; 
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst=MAX_ALTERNATE)] 
    public string cAlternate; 
}

[DllImport("kernel32", CharSet=CharSet.Unicode)] 
public static extern IntPtr FindFirstFile(string lpFileName, out WIN32_FIND_DATA lpFindFileData);

[DllImport("kernel32", CharSet=CharSet.Unicode)] 
public static extern bool FindNextFile(IntPtr hFindFile, out WIN32_FIND_DATA lpFindFileData);

private long RecurseDirectory(string directory, int level, out int files, out int folders) {
    IntPtr INVALID_HANDLE_VALUE = new IntPtr(-1);
    long size = 0;
    files = 0;
    folders = 0;
    Kernel32.WIN32_FIND_DATA findData;

    IntPtr findHandle;

    // please note that the following line won't work if you try this on a network folder, like \\Machine\C$
    // simply remove the \\?\ part in this case or use \\?\UNC\ prefix
    findHandle = Kernel32.FindFirstFile(@"\\?\" + directory + @"\*", out findData);
    if (findHandle != INVALID_HANDLE_VALUE) {

        do {
            if ((findData.dwFileAttributes & FileAttributes.Directory) != 0) {

                if (findData.cFileName != "." && findData.cFileName != "..") {
                    folders++;

                    int subfiles, subfolders;
                    string subdirectory = directory + (directory.EndsWith(@"\") ? "" : @"\") + 
                        findData.cFileName;
                    if (level != 0)  // allows -1 to do complete search.
                        {
                    size += RecurseDirectory(subdirectory, level - 1, out subfiles, out subfolders);

                    folders += subfolders;
                    files += subfiles;
                    }
                }
            }
            else {
                // File
                files++;

                size += (long)findData.nFileSizeLow + (long)findData.nFileSizeHigh * 4294967296;
            }
        } 
        while (Kernel32.FindNextFile(findHandle, out findData));
        Kernel32.FindClose(findHandle);

    }

    return size;
}

// [Sample by Kåre Smith] // [Minor edits by Mike Liddell] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-02T18:51:08.850

仅供参考……您所看到的是资源叉。这些与 Windows 资源有很大不同，大致类似于 NTFS 备用数据流。

[http://en.wikipedia.org/wiki/Resource_fork](http://en.wikipedia.org/wiki/Resource_fork)

> 资源分支在所有用于 Macintosh 系统驱动器的文件系统（MFS、HFS 和 HFS Plus）中实现。资源分叉的存在使得存储各种附加信息变得容易，例如允许系统显示文件的正确图标并打开它，而无需文件名中的文件扩展名。虽然对数据分支的访问就像在任何其他操作系统上的文件访问一样——选择一个文件，选择一个字节偏移量，读取一些数据——对资源分支的访问更像是从数据库中提取结构化记录。

从 Microsoft sysinternals 站点：

> NTFS 文件系统为应用程序提供了创建替代信息数据流的能力。默认情况下，所有数据都存储在文件的主要未命名数据流中，但是通过使用语法“file:stream”，您可以读取和写入备用数据。并非所有应用程序都是为访问备用流而编写的，但您可以非常简单地演示流。首先，从命令提示符切换到 NTFS 驱动器上的目录。接下来，输入“echo hello > test:stream”。您刚刚创建了一个与文件“test”相关联的名为“stream”的流。请注意，当您查看测试的大小时，它会报告为 0，并且在任何文本编辑器中打开该文件时看起来都是空的。要查看您的流，请输入 'more < test:stream'（type 命令没有'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:41:54.953

删除文件或重命名文件怎么样？

说真的，这种情况是否经常发生以至于值得你编写特殊情况的代码来“修复”？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-01T02:24:40.287

我知道这有点过时了，但我刚刚在从 Windows 访问 OSX 文件系统时遇到了完全相同的问题。DotNet 给了我“非法文件名”错误，原因是一个名为 icon 的零字节 Mac 文件，但文件名末尾有一个正方形。

我的解决方案是使用一些 VB6 代码和 interop.scripting filesystemobject 以这种方式列出文件。

FSO 不会使用这些非法字符。

希望对某人有所帮助。

# java - 将 float 转换为 double 而不会丢失精度

> ID：916081
> 
> 赞同：114
> 
> 时间：2009-05-27T14:39:16.377
> 
> 标签：java, floating-point, double

我有一个原始浮点数，我需要一个原始双精度数。简单地将浮点数转换为 double 会给我带来奇怪的额外精度。例如：

```
float temp = 14009.35F;
System.out.println(Float.toString(temp)); // Prints 14009.35
System.out.println(Double.toString((double)temp)); // Prints 14009.349609375 
```

但是，如果不是强制转换，而是将浮点数输出为字符串，并将字符串解析为双精度字符串，我会得到我想要的：

```
System.out.println(Double.toString(Double.parseDouble(Float.toString(temp))));
// Prints 14009.35 
```

有没有比去字符串和返回更好的方法？

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-05-27T14:42:39.413

这并不是说您*实际上*获得了额外的精度 - 而是浮点数没有准确地表示您最初瞄准的数字。双精度*表示*原始浮点数；`toString`正在显示已经存在的“额外”数据。

例如（这些数字不正确，我只是在编造）假设你有：

```
float f = 0.1F;
double d = f; 
```

那么 的值`f`可能正好是 0.100000234523。`d`将具有完全相同的值，但是当您将其转换为字符串时，它将“相信”它的精度更高，因此不会尽早四舍五入，并且您会看到已经存在的“额外数字”在那里，但对你隐藏。

当您转换为字符串并返回时，您最终会得到一个双精度值，它比原始浮点数更接近字符串值 - 但只有*当*您真的相信字符串值是您真正想要的值时，这才是好的。

您确定 float/double 是在此处使用的合适类型，而不是`BigDecimal`？如果您尝试使用具有精确十进制值的数字（例如货币），那么`BigDecimal`IMO 是更合适的类型。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-02-07T08:45:44.683

我发现转换为二进制表示更容易掌握这个问题。

```
float f = 0.27f;
double d2 = (double) f;
double d3 = 0.27d;

System.out.println(Integer.toBinaryString(Float.floatToRawIntBits(f)));
System.out.println(Long.toBinaryString(Double.doubleToRawLongBits(d2)));
System.out.println(Long.toBinaryString(Double.doubleToRawLongBits(d3))); 
```

您可以看到通过在末尾添加 0 将浮点数扩展为双精度，但 0.27 的双精度表示“更准确”，因此存在问题。

```
 111110100010100011110101110001
11111111010001010001111010111000100000000000000000000000000000
11111111010001010001111010111000010100011110101110000101001000 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-05-27T14:56:04.347

这是由于 的合同[`Float.toString(float)`，](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Float.html#toString(float))其中部分内容是：

> 小数部分 […] 必须打印多少位？必须至少有一个数字来表示小数部分，除此之外，必须有尽可能多**的数字，但仅能** *将参数值与浮点类型的相邻值区分开来。*也就是说，假设 x 是由该方法为有限非零参数 f 生成的十进制表示所表示的精确数学值。那么 f 必须是最接近 x 的浮点值；或者，如果两个浮点值同样接近 x，则 f 必须是其中之一，并且 f 的有效位的最低有效位必须为 0。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-01-02T12:24:55.653

我今天遇到了这个问题，无法使用重构到 BigDecimal，因为该项目非常庞大。但是我找到了解决方案

```
Float result = new Float(5623.23)
Double doubleResult = new FloatingDecimal(result.floatValue()).doubleValue() 
```

这有效。

注意调用 result.doubleValue() 返回 5623.22998046875

但调用 doubleResult.doubleValue() 正确返回 5623.23

但我不完全确定它是否是正确的解决方案。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-01-25T16:20:59.060

我找到了以下解决方案：

```
public static Double getFloatAsDouble(Float fValue) {
    return Double.valueOf(fValue.toString());
} 
```

如果您使用*float*和*double*而不是*Float*和*Double* ，请使用以下内容：

```
public static double getFloatAsDouble(float value) {
    return Double.valueOf(Float.valueOf(value).toString()).doubleValue();
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-27T14:45:28.750

使用 a`BigDecimal`代替`float`/ `double`。有很多数字不能表示为二进制浮点数（例如，`0.1`）。因此，您要么必须始终将结果四舍五入到已知精度，要么使用`BigDecimal`.

有关详细信息，请参阅[http://en.wikipedia.org/wiki/Floating_point](http://en.wikipedia.org/wiki/Floating_point)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T14:55:36.220

浮点数本质上是不精确的，并且总是有整齐的四舍五入“问题”。如果精度很重要，那么您可以考虑重构您的应用程序以使用 Decimal 或 BigDecimal。

是的，由于处理器支持，浮点数的计算速度比小数更快。但是，您想要快速还是准确？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T15:05:43.033

有关信息，请参阅 Joshua Bloch 的 Effective Java 2nd edition 的第 48 条 - 当需要精确值时避免使用浮点数和双精度数。这本书塞满了好东西，绝对值得一看。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-04T12:18:15.543

这行得通吗？

```
float flt = 145.664454;

Double dbl = 0.0;
dbl += flt; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-05-21T14:55:04.453

一个行之有效的简单解决方案是从浮点数的字符串表示中解析双精度：

```
double val = Double.valueOf(String.valueOf(yourFloat)); 
```

效率不高，但很有效！

# perl - 如何让 WWW::Mechanize 工作？

> ID：916083
> 
> 赞同：1
> 
> 时间：2009-05-27T14:39:18.873
> 
> 标签：perl, www-mechanize

这个脚本：

```
use strict;
use warnings;
use WWW::Mechanize;

my $mech = WWW::Mechanize->new( autocheck => 1 );

$mech->get( "http://www.google.com" );
print $mech->content; 
```

产生此错误消息：

> [获取http://www.google.com](http://www.google.com)时出错：无法在 D:\PERL\try.pl 第 5 行连接到 www.google.com:80（连接：未知错误）

怎么了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T15:03:01.773

从您的错误消息中，我看到您在 Windows 机器上 (D:\PERL\try.pl)。也许 Windows 防火墙不信任 Perl 访问互联网并阻止其流量？

在 Windows 防火墙中添加允许 perl.exe 访问 Internet 的规则可能会很幸运。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T14:55:18.497

以前有效吗？此代码适用于我的 Linux 机器。

1.  可能是您没有互联网连接。
2.  也许谷歌阻止了你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T15:05:00.037

可能像 Olfan 所说的那样是您的防火墙，或者您可能需要在您的环境中使用代理。

# .net - 我仍然可以在 Visual Studio 2010 中以 .NET Framework 2.0 为目标吗？

> ID：916084
> 
> 赞同：13
> 
> 时间：2009-05-27T14:39:27.360
> 
> 标签：.net, visual-studio-2010

在升级到 Visual Studio 2010 之前，我想确保我仍然可以针对 2.0 版框架。我无法从 Microsoft 那里找到关于此的声明。是否可以？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T14:43:26.743

根据[这个页面](http://msdn.microsoft.com/en-us/library/bb398197(VS.100).aspx)，你可以。只需确保您已安装 .NET 3.5 SP1。

> Visual Studio 2010 仅包含 .NET Framework 4。**若要针对早期版本的 .NET Framework，您必须安装 .NET Framework 3.5 Service Pack 1 (SP1)。**.NET Framework 3.5 SP1 包括 .NET Framework 2.0、.NET Framework 3.0 和 .NET Framework 3.5 SP1。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T14:43:08.320

是的，这是可能的。它被称为*多目标*，是 Visual Studio 2010 中最明确支持的功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T14:42:13.797

有人在[The Code Project](https://en.wikipedia.org/wiki/Code_Project)上问过这个问题。答案是肯定的。它支持 2.0 -> 4.0。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T14:43:14.043

是的

有一篇 geekswithblogs 帖子显示了多目标功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T14:45:08.923

此功能包含在 Visual Studio 2008 中，作为处理 2.0 到 3.5 项目的一种方式，因此对于 Microsoft 而言，在其下一个版本中不包含相同的功能将是一个巨大的失败。使用 2010，您应该能够支持 2.0 到 4.0 框架范围内的项目（以及可能超出框架升级）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T14:50:01.630

是的。根据[Jason Zander 的博客](http://blogs.msdn.com/jasonz/archive/2009/05/18/announcing-vs2010-net-framework-4-0-beta-1.aspx)和更多信息，请查看[Scott Hanselman 的 ASP 4 - Whirlwind Tour around .NET 4 (and Visual Studio 2010) Beta 1](http://www.hanselman.com/blog/ASP4WhirlwindTourAroundNET4AndVisualStudio2010Beta1.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-04T16:12:48.593

以下是在 Visual Studio 2010 中更改目标框架的方法。

1.  右键单击**项目**。

2.  单击“**编译**”选项卡

3.  在底部单击“**高级编译选项...** ”

4.  从“**目标框架（所有配置）中选择框架：** ”

# .net - 运行时可编辑的资源文件

> ID：916094
> 
> 赞同：0
> 
> 时间：2009-05-27T14:40:49.540
> 
> 标签：.net, asp.net

我为 .NET 创建了一个基于 XML 的自定义错误消息框架。XML 是基于键值的，并且会被缓存。当用户编辑 XML 文件时缓存失效。发生错误时，会发生类似“GetError(Password.Toolong,"Default value")' 的调用，该调用会读取缓存。

我想知道的是，在我花时间将这个东西做成一个可移植模块之前，是否存在类似的框架（可能是 PnP 的一部分）。

我想将我的字符串外部化，以便我可以即时编辑它们。我已经阅读了在运行时似乎不容易编辑的 resx 和设置文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T14:44:34.010

XML 可能会很好地处理一种语言，对于更多语言，我建议转移到数据库。

# eclipse - Eclipse中的“哑”文本完成？

> ID：916095
> 
> 赞同：8
> 
> 时间：2009-05-27T14:40:52.647
> 
> 标签：eclipse

有什么方法可以在 Eclipse 中获得“哑”字完成，类似于 Vim 中的 ctrl+p？

比如我经常写一个函数调用：

```
x = getMeAnXPlease(); 
```

然后进去写定义：

```
function getMe... 
```

此时，在 Vim 中，我按 ctrl+p，这将完成 'getMe' 到 'getMeAnXPlease'。

Eclipse有类似的东西吗？

**编辑**：我知道 ctrl+space 执行上下文相关的完成，而 ctrl-1 是神奇的“修复这条线”键......但在某些情况下我只想要上下文不敏感的完成......这似乎是提供的通过“单词完成”命令。

**编辑**：下一个问题：是否可以进行上下文不敏感的行补全（类似于 Vim 中的 cx cl）？也就是说，用类似的行完成当前行：

```
doSomeThing(1, 2, 3, 4);
doSome <c-x c-l> -- inserts the rest of the 'doSomeThing(1, 2, 3, 4);' line 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T16:36:47.653

啊哈！找到了。

有一个“单词完成”功能，默认为“ctrl-.”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T14:45:44.383

写 x = getMeAnXPlease();

等一下，直到编译器明白没有这样的方法。

点击 Ctrl-1 并 Enter - 它会自动创建完整的方法主体。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T14:44:01.873

实际上，它被称为模板，其中有很多，比简单的单词完成高级得多。看着：

窗口 --> 首选项 --> Java --> 编辑器 --> 模板

获取当前模板的列表以及添加更多模板的可能性。然后，您将使用 Ctrl + Space 来完成弹出。例如，如果您编写“sysout”并按 Ctrl + Space，则会得到“System.out.Println([cursor here]);”。

我自己编写了一个示例，用于将 Before 函数添加到 JUnit 测试用例：

`@${testType:newType(org.junit.Before)} public final void setUp() throws Exception { ${cursor} }`

这将通过键入“之前”和 Ctrl + Space 来触发。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T14:44:04.153

Ctrl+空格完成

Ctrl+1（或 Cmd+1）用于提示您正在处理的代码片段（例如自动创建缺少的方法等）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T14:47:42.710

关于快速修复（Ctrl+1 或 Cmd+1）的更多细节。您可以简单地从调用不存在方法的地方调用 Quick Fix，而不是去某个地方开始定义新方法。它将创建一个具有正确名称的新空函数，并将光标留在原位以填充它。

# c# - 模板引擎实现

> ID：916099
> 
> 赞同：3
> 
> 时间：2009-05-27T14:41:33.720
> 
> 标签：c#, .net, template-engine

我目前正在构建这个小型模板引擎。它需要一个包含参数中模板的字符串，以及一个“标签，值”的字典来填充模板。

在引擎中，我不知道模板中的标签和不会出现的标签。

我目前正在对字典进行迭代（foreach），解析我放入字符串构建器的字符串，并将模板中的标签替换为相应的值。

有没有更有效/更方便的方法来做到这一点？我知道这里的主要缺点是字符串生成器每次都完全针对每个标签进行解析，这非常糟糕......

（在我的模板不再包含任何标签的过程之后，我也在检查，虽然不包含在示例中。它们都以相同的方式格式化：@@tag@@）

```
//Dictionary<string, string> tagsValueCorrespondence;
//string template;

StringBuilder outputBuilder = new StringBuilder(template);
foreach (string tag in tagsValueCorrespondence.Keys)
{
    outputBuilder.Replace(tag, tagsValueCorrespondence[tag]);
}

template = outputBuilder.ToString(); 
```

**回应：**

@马克：

```
string template = "Some @@foobar@@ text in a @@bar@@ template";
StringDictionary data = new StringDictionary();
data.Add("foo", "value1");
data.Add("bar", "value2");
data.Add("foo2bar", "value3"); 
```

*输出：* “value2 模板中的一些文本”

*而不是：* “value2 模板中的一些 @@foobar@@ 文本”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:44:42.560

Regex 和 MatchEvaluator 怎么样？像这样：

```
string template = "Some @@Foo@@ text in a @@Bar@@ template";
StringDictionary data = new StringDictionary();
data.Add("foo", "random");
data.Add("bar", "regex");
string result = Regex.Replace(template, @"@@([^@]+)@@", delegate(Match match)
{
    string key = match.Groups[1].Value;
    return data[key];
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T15:04:01.973

这是您可以用作起点的示例代码：

```
using System;
using System.Collections.Generic;
using System.Text.RegularExpressions;

class Program {
    static void Main() {
        var template = " @@3@@  @@2@@ @@__@@ @@Test ZZ@@";
        var replacement = new Dictionary<string, string> {
                {"1", "Value 1"},
                {"2", "Value 2"},
                {"Test ZZ", "Value 3"},
            };
        var r = new Regex("@@(?<name>.+?)@@");
        var result = r.Replace(template, m => {
            var key = m.Groups["name"].Value;
            string val;
            if (replacement.TryGetValue(key, out val))
                return val;
            else
                return m.Value;
        });
        Console.WriteLine(result);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-07T07:54:58.137

您可以将单声道字符串格式实现修改为接受您的字符串字典。例如 [http://github.com/wallymathieu/cscommon/blob/master/library/StringUtils.cs](http://github.com/wallymathieu/cscommon/blob/master/library/StringUtils.cs)

# ms-access - Visual Basic 6 数据结构

> ID：916109
> 
> 赞同：4
> 
> 时间：2009-05-27T14:42:38.883
> 
> 标签：ms-access, vba, data-structures, vb6

VB6（Microsoft Access）的所有内置数据结构是什么？我知道有数组，但是还有其他更现代的数据结构吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T16:10:08.300

断开连接的记录集也很有用：[使用 VBA 同步两个列表](https://stackoverflow.com/questions/226978/syncing-two-lists-with-vba)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T14:45:38.890

它有一个`Dictionary`：[VBA 有字典结构吗？](https://stackoverflow.com/questions/915317/does-vba-have-dictionary-structure/915323)

还有`Collection`：[VBA：Python 程序员资源](https://stackoverflow.com/questions/76882/vba-resource-for-python-programmer)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T18:33:00.963

Bruce McKinney 的优秀书籍 Hardcore Visual Basic 包括一些用于创建链表、堆栈等的代码，作为其对使用 VB6 进行基于对象编程的介绍的一部分。这本书现在可以[在线免费](http://vb.mvps.org/hardcore/)获得。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T04:12:41.733

我不认为我理解这个问题。当我读到它时，我想到了：

*   数组
*   收藏品
*   类型
*   枚举

等等。不确定我是否会考虑将独立类模块作为答案的一部分，因为它们可以具有您想要的任何结构，而不是特定的数据结构。而且，当然，VBA 是基于 COM 的，它可以使用来自兼容 COM 对象的任何数据结构。这可能需要也可能不需要类型库（取决于 COM 对象的实现）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T11:55:21.530

您还可以通过以下方式创建自己的（更好的可访问性/性能 XML 集合）：

[MS XML 集合](http://msdn.microsoft.com/en-us/library/aa239702(VS.60).aspx)

还可以考虑使用哈希表：

[哈希表](http://www.kellyethridge.com/vbcorlib/hashtabletutorial1.shtml)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T11:07:19.693

我在 VB6 中编写了很多代码，并且肯定我经常使用 Dictionary 和 Collection 类。但是我仍然认为在很多情况下它们是不够的，这就是为什么我建议你看看这个库：

[http://sourceforge.net/projects/vbcorlib/](http://sourceforge.net/projects/vbcorlib/)

它是 .NET 库到 VB6 的一个端口。

# java - 将文件上传到 apache 服务器

> ID：916116
> 
> 赞同：0
> 
> 时间：2009-05-27T14:43:14.793
> 
> 标签：java, apache

我有一个为 xml 文件生成数字签名的 java 函数。这是给我一些麻烦的摘录：

```
String boundary = MultiPartFormOutputStream.createBoundary();
HttpURLConnection urlConn = (HttpURLConnection)MultiPartFormOutputStream.createConnection(new URL(url + "/sign"));
urlConn.setRequestProperty("Accept", "*/*");
urlConn.setRequestProperty("Content-Type", MultiPartFormOutputStream.getContentType(boundary));
urlConn.setRequestProperty("Cache-Control", "no-cache");
urlConn.setDOInput(true);
urlConn.setDoOutput(true);

MultiPartFOrmOutputStream up = new MultiPartFormOutputStream(urlCOnn.getOutputStream(), boundary);
up.writeField(SignServletParams.detachedParam, "1");
up.writeFile(SignServletParams.xmlParam, "text/xml", "xml_file.xml", XMLUtil.toEncodedStream(doc);
up.close();

Document ret = null;
String connRead = "";
BufferedReader down = new BufferedReader(new InputStreamReader(urlCOnn.getINputStream())); 
```

如果我尝试上传小的 xml 文件，它工作正常，但是，如果 xml 文件较大（有几千个节点），我会得到一个 IOException，其中正在创建 BufferedReader。异常消息只是指出服务器返回了 500 状态。我检查了 Apache 服务器日志，它报告了以下内容：

输入过滤器：无法创建临时文件：“文件名”

我从编写它的其他人那里继承了这段代码，所以我仍在尝试将所有内容拼凑在一起，但是任何关于为什么该函数适用于小文件而对大文件失败的任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T16:03:41.713

如果这是一个愚蠢的答案，我很抱歉，但是如果有必要，您可以在“上传者端”将文件分成几部分，然后在“服务器端”再次合并它们吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T16:38:17.280

感谢约翰内斯的建议，但我弄清楚了问题所在，我很傻。事实证明，mod_security 配置文件指定的临时文件创建目录不存在。将其更改为真实的目录路径可以解决所有问题。

# utf-8 - 经典 ASP - 如何将 UTF-8 字符串转换为 UCS-2？

> ID：916118
> 
> 赞同：10
> 
> 时间：2009-05-27T14:43:33.187
> 
> 标签：utf-8, asp-classic

我在 SQL Server 中将 UTF-8 字符串存储为 UCS-2 时遇到问题。当我将它拉出来显示在内容类型设置为 UTF-8 的页面上时，它工作正常。但是我有一个第三方 Javascript 组件，当我将数据库的字符串传递给它时，它会将其呈现为 USC2。或者不是UTF8。

ASP 中有没有办法在从数据库中读取此字符串以将其传递给第三方组件（混淆）后将其转换为 UTF-8？

希望这是有道理的。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-28T11:33:10.343

我的怀疑是您遇到了经典的表单后字符编码不匹配问题。

它是这样的： -

*   您有一个使用 UTF-8 编码呈现给客户端的表单。
*   结果，浏览器发布使用 UTF-8 编码输入表单的文本值。
*   接收帖子的操作页面将其 Response.Codepage 设置为典型的 OEM 代码页，例如 1252。
*   服务器将发布的 UTF-8 字符串的每个字节视为单个字符，而不是将 UTF-8 编码字节集解码为正确的 unicode 字符。
*   该字符串与现在损坏的字符一起存储在数据库中。
*   页面希望向客户端显示包含损坏字符的 DB 字段的内容。
*   该页面将其 CharSet 设置为 UTF-8，但其 Response.CodePage 仍保留在 OEM 代码页中，例如 1252。
*   Response.Write 用于将字段内容发送到客户端，unicode 字符被转换回之前收到的字节集的字节。
*   客户端认为它正在获取 UTF-8，因此它将从服务器接收到的字符解码为 UTF-8，就像它们最初一样，因此它们正确显示在屏幕上。
*   一切进展顺利，好像一切正​​常，而这些字符只是通过 ASP 来回反弹。一个页面中的错误在另一个（可能是同一页面）中具有匹配的错误，这使得一切看起来都很好。

如果您直接使用 SQL 服务器工具检查字段内容，您可能会在那里看到损坏的字符串。现在您想将此字符串与另一个期望直接 unicode 字符串的组件一起使用，这就是您发现此错误的地方。

解决方案是始终确保您的所有页面不仅在响应中发送 CharSet = "UTF-8" ，而且在使用 Response.Write 和尝试读取任何 Request.Form 值之前使用 Response.CodePage = 65001 。在 <%@ 页眉中使用 Codepage 指令。

现在您需要修复数据库中已损坏的字符串。

使用 ADODB.Stream：-

```
Function ConvertFromUTF8(sIn)

    Dim oIn: Set oIn = CreateObject("ADODB.Stream")

    oIn.Open
    oIn.CharSet = "WIndows-1252"
    oIn.WriteText sIn
    oIn.Position = 0
    oIn.CharSet = "UTF-8"
    ConvertFromUTF8 = oIn.ReadText
    oIn.Close

End Function 
```

此函数（顺便说一句，它是您实际问题的答案）采用损坏的字符串（具有字节表示的字符串）并转换为它应该是的字符串。您需要将此转换应用于数据库中已成为该错误受害者的每个字段。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2009-05-27T14:47:38.373

Encoding.UTF8 和 Encoding.Unicode 将提供足够的功能。有关更多信息，请参阅[维基百科](http://en.wikipedia.org/wiki/UTF-16)

# asp.net - 使用 DataTable 数据源搜索 Gridview

> ID：916121
> 
> 赞同：3
> 
> 时间：2009-05-27T14:43:51.593
> 
> 标签：asp.net, search, gridview, datatable

我有一个从 web 服务获取数据的 gridview。

这进入数据集中的应用程序。

```
 Me.GvStreets.DataSource = TheWebServiceSearch.AddressDataTable
   Me.GvStreets.DataBind() 
```

进入网格视图后，如何搜索此数据集的内容。

我是否必须将其添加到某种数据源控件中，例如 XML 数据源？

谢谢

我最终做的是这个......

```
 Dim StreetDataTable As DataTable = Session("StreetData")
   Dim Name As String = StreetDataTable.Columns(0).ColumnName

   Dim FilteredResults As New DataTable
   FilteredResults = StreetDataTable.Clone()

   Dim DataRows() As DataRow
   DataRows = StreetDataTable.Select("street LIKE '%" & Me.txtStreet.Text & _

                         "%'", "Street ASC")
    Dim i As Integer

    For i = 0 To DataRows.GetUpperBound(0)

        FilteredResults.ImportRow(DataRows(i))

    Next i

    Me.GvStreets.DataSource = FilteredResults
    Me.GvStreets.DataBind() 
```

我必须获取结果并克隆数据表才能获取架构。然后我从原始数据表中进行了选择。我遍历了结果并将它们添加到克隆的数据表中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T14:57:39.617

通常您会直接搜索您的数据源，因此在您的情况下，由于 TheWebServiceSearch.AddressDataTable 是一个数据表，您可以执行以下操作：

```
DataTable data = TheWebServiceSearch.AddressDataTable;
DataRow[] foundRows = data.Select("city = 'NY'", "zip ASC"); 
```

[您可以在此处查看](http://msdn.microsoft.com/en-us/library/system.data.datatable.select.aspx)DataTable.Select 重载的完整列表

* * *

哦，好吧，现在我知道你需要什么了。我以为你想要别的东西。无论如何，为了您的目的，您应该使用 DataView 对象（它也是可绑定的）。这是一个例子：

```
Dim StreetDataTable As DataTable = Session("StreetData")
Dim Name As String = StreetDataTable.Columns(0).ColumnName
StreetDataTable.DefaultView.RowFilter = "street LIKE '%" & Me.txtStreet.Text & "%'"
StreetDataTable.DefaultView.Sort = "Street ASC"

Me.GvStreets.DataSource = StreetDataTable.DefaultView
Me.GvStreets.DataBind() 
```

看看[DataView 的完整规范](http://msdn.microsoft.com/en-us/library/system.data.dataview.aspx)。

# ruby-on-rails - 为什么 Rails 拒绝使用我的模型（基于 SQL 视图）？

> ID：916124
> 
> 赞同：2
> 
> 时间：2009-05-27T14:44:07.537
> 
> 标签：ruby-on-rails, activerecord

我在 MySQL 中创建了一个视图，它对应于我正在生成的一些报告（按月、年分组的总和并汇总）。该视图有 3 列（年、月、总计）。视图/表名称为“report_monthly”。我知道我可以通过 connection().select_all(...) 使用原始 sql，但我想为此表创建一个 ActiveRecord。

这是我在名为“report_monthly.rb”的文件中的模型：

```
class MonthlyReport < ActiveRecord::Base
    # I assume that setting the table name circumvents the pluralized file name convention
    set_table_name "report_monthly"
end 
```

该文件放置在标准 rails 结构中：

```
app
    controllers
    helpers
    models
        report_monthly.rb
    views 
```

现在，当我使用 RoR 控制台（脚本/控制台）时，我什至看不到该类，更不用说列出所有行了

```
>> MonthlyReport
    NameError: uninitialized constant MonthlyReport 
```

我的所有其他模型都可以正常工作，但它们遵循“singular.rb”-> class Singluar -> table Plural 的约定

更新：这是否与视图不可变这一事实有关？无法插入/更新？

版本：

Ruby 1.8.7、Rails 2.3.2、MySQL 5.0.75

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T15:08:34.603

文件名和类名必须相同，所以需要调用你的文件`monthly_report.rb`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T14:52:25.850

除非我弄错了，否则我认为 Rails 不允许您将 ActiveRecord 模型基于 SQL 视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:53:06.803

也许它只是字体或错字，但看起来你的 DB 表名称中的下划线比你用于 ruby​​ 类的名称中的要多。-> 好的，打错字了！！

致 John Topley：PostgreSQL 将视图定义为表，其选择规则被定义为从基础表中提取数据。Ruby/Rails 不会知道视图不是真正的表。所以你的信念一般来说是不正确的（但也许对于 MySQL）。

编辑（=第 2 次尝试）：rails 的类自动加载机制有问题吗？您的 ruby​​ 文件是否在正确的位置包含该类？（我没有我的“The Rails Way”副本，但也许其他人可以在这里提供帮助。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-10T20:30:42.730

确保视图中有一个 id 列，当然它必须是唯一的。

为什么不将视图称为“monthly_reports”（对应模型名称）并使生活更简单？

# php - curl_exec 函数导致服务器断开连接

> ID：916125
> 
> 赞同：0
> 
> 时间：2009-05-27T14:44:10.360
> 
> 标签：php, curl

我编写的以下函数有一个奇怪的问题。简而言之，此函数连接到 URL 并使用 curl 函数获取输出。但是，当我执行此函数时，我收到“服务器意外断开连接”消息：

```
/**
 * Connects to remote URL and posts parameters, returns the result
 *
 * @param string $URL 
 * @param string $ArrayPostParameters 
 * @param string $HTTPRequestType 
 * @param string $HTTPAuth 
 * @param string $HTTPAuthUsername 
 * @param string $HTTPAuthPassword 
 * @param string $ConnectTimeOutSeconds 
 * @param string $ReturnHeaders 
 * @return array
 * @author xxxxxxxxxx
 */
function DataPostToRemoteURL($URL, $ArrayPostParameters, $HTTPRequestType = 'POST', $HTTPAuth = false, $HTTPAuthUsername = '', $HTTPAuthPassword = '', $ConnectTimeOutSeconds = 1, $ReturnHeaders = false)
    {
    $PostParameters = implode('&', $ArrayPostParameters);

    $CurlHandler = curl_init();
        curl_setopt($CurlHandler, CURLOPT_URL, $URL);

        if ($HTTPRequestType == 'GET')
            {
            curl_setopt($CurlHandler, CURLOPT_HTTPGET, true);
            }
        elseif ($HTTPRequestType == 'PUT')
            {
            curl_setopt($CurlHandler, CURLOPT_PUT, true);
            }
        elseif ($HTTPRequestType == 'DELETE')
            {
            curl_setopt($CurlHandler, CURLOPT_CUSTOMREQUEST, 'DELETE');
            }
        else
            {
            curl_setopt($CurlHandler, CURLOPT_POST, true);
            curl_setopt($CurlHandler, CURLOPT_POSTFIELDS, $PostParameters);
            }

        curl_setopt($CurlHandler, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($CurlHandler, CURLOPT_FOLLOWLOCATION, 1);
        curl_setopt($CurlHandler, CURLOPT_FOLLOWLOCATION, 5);
        curl_setopt($CurlHandler, CURLOPT_CONNECTTIMEOUT, $ConnectTimeOutSeconds);
        curl_setopt($CurlHandler, CURLOPT_TIMEOUT, $ConnectTimeOutSeconds);
        curl_setopt($CurlHandler, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.3) Gecko/2008092417 Firefox/3.0.3');

        // The option doesn't work with safe mode or when open_basedir is set.
        if ((ini_get('safe_mode') != false) && (ini_get('open_basedir') != false))
            {
            curl_setopt($CurlHandler, CURLOPT_FOLLOWLOCATION, true);
            }

        if ($ReturnHeaders == true)
            {
            curl_setopt($CurlHandler, CURLOPT_HEADER, true);
            }
        else
            {
            curl_setopt($CurlHandler, CURLOPT_HEADER, false);
            }

        if ($HTTPAuth == true)
            {
            curl_setopt($CurlHandler, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
            curl_setopt($CurlHandler, CURLOPT_USERPWD, $HTTPAuthUsername.':'.$HTTPAuthPassword);
            }

        $RemoteContent = curl_exec($CurlHandler);

    if (curl_error($CurlHandler) != '')
        {
        return array(false, curl_error($CurlHandler));
        }

    curl_close($CurlHandler);   

    return array(true, $RemoteContent);
    } 
```

当我调试该函数时，我注意到 curl_exec() 函数会导致此问题。没有 curl_error 消息，也没有生成 PHP 错误。

您对原因有任何想法吗？为了您的信息，在 PHP.INI 中禁用了 safe_mode。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T15:59:28.993

你怎么调用这个函数？如果您将 $ConnectTimeOutSeconds 选项保留为默认值 1，您的 CURLOPT_TIMEOUT 设置可能会导致问题，因为连接和返回页面可能需要超过 1 秒的时间。

# ruby-on-rails - 为什么我在测试控制器时无法访问 RSpec 中的控制器对象？

> ID：916135
> 
> 赞同：2
> 
> 时间：2009-05-27T14:45:18.330
> 
> 标签：ruby-on-rails, ruby, rspec, ruby-on-rails-plugins

我正在使用 rspec-rails，版本 1.2.6。在控制器测试中

```
describe WebsController do ... 
```

为了存根方法，我似乎无权访问控制器对象。例如，以下内容将不起作用：

```
 before :all do
    @feed = mock_model(Feed)
    controller.should_receive(:feed_from_params).and_return @feed    
  end 
```

我收到类似的警告

```
An expectation of :feed_from_params was set on nil. 
```

并在方法模拟之前从规范中启动调试会话，我得到以下信息：

```
(rdb:1) self.respond_to? :controller
true
(rdb:1) controller
nil 
```

从所有示例中，访问控制器变量应该可以工作，但事实并非如此。是什么赋予了？如何在被测控制器中模拟或存根方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T16:53:34.047

尝试使用@controller 而不是控制器

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-12T02:19:16.390

删除之前块中的 :all 可以解决问题。不过不知道为什么。

```
before do
...
end 
```

是你需要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-02T04:34:04.497

如果您需要`controller`在一个`before(:all)`块中，请调用`setup_controller_request_and_response`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-17T05:50:25.323

PS：这个行为应该在最新版本的 RSpec 中得到修复。

请参阅 RSpec v.2.14 中的[运行示例](https://www.relishapp.com/rspec/rspec-rails/v/2-14/docs/controller-specs/controller-spec#controller-is-exposed-to-global-before-hooks)：

```
require "spec_helper"

RSpec.configure {|c| c.before { expect(controller).not_to be_nil }}

describe WidgetsController do
  describe "GET index" do
    it "doesn't matter" do
    end
  end
end 
```

# apache-flex - 使用 Flex navigatetoUrl 函数的 url 编码

> ID：916142
> 
> 赞同：4
> 
> 时间：2009-05-27T14:45:57.080
> 
> 标签：apache-flex, url, encode

我想从 Flex 应用程序将数据发布到我服务器上的 URL。我使用以下

```
UrlParam = UrlParam + '&name='+ name.text + '&business=' + buisness.text;
navigateToURL(new URLRequest(UrlParams),'_self'); 
```

然而，我遇到的问题是，如果我使用 & 符号（“A&b.com”）进入一家企业，那么该名称不会发送。

Flex 是否有任何开箱即用的东西可以从`&`to进行编码`%26`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T17:00:15.343

使用[encodeURIComponent()](http://livedocs.adobe.com/flex/201/langref/package.html#encodeURIComponent())对每个参数进行编码。

```
UrlParam = UrlParam + '&name=' + encodeURIComponent(name.text) + 
  '&business=' + encodeURIComponent(buisness.text);    
navigateToURL(new URLRequest(UrlParams),'_self'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-25T18:38:54.553

使用[URLVariables](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLVariables.html)：

```
var urlRequest : URLRequest = new URLRequest("http://....");
var urlVar: URLVariables = new URLVariables();
urlVar.name = name.text;
urlVar.business = buisness.text;
urlRequest.data = urlVar;
navigateToURL(urlRequest); 
```

# php - 在 Zend Framework 中向路由器添加路由

> ID：916143
> 
> 赞同：0
> 
> 时间：2009-05-27T14:46:01.043
> 
> 标签：php, zend-framework, routing

我正在使用 mod-rewrite 路由器。

我正在尝试将路由添加到将转换以下 url 的路由器：
baseurl/category/aaa/mycontroller/myaction/param/value

成为：
控制器=mycontroller
action=myaction

- 参数 -

类别=aaa
参数=值

我在我的引导程序中使用以下（不工作），_front 是 frontController

```
$Router=$this->_front->getRouter();
$CategoryRoute = new Zend_Controller_Router_Route('category/:category/:controller/:action/*');
$Router->addRoute('category', $CategoryRoute); 
```

我得到的错误是当我使用 Zend_View::url() 帮助器时抛出的路由器异常（无论是否给它新路由的名称）。
仅当我有 baseurl/category/.... 时才会引发异常

我错过了什么？

我错过了什么：
由于 url 中有 [category]，因此使用的路由器是上面定义的路由器。
当我使用 url() 助手时，我没有给 [category] ​​中的任何值，因此在 url 部分->失败中没有此键的值。提供默认值，使其工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T15:36:14.093

您应该按照 solomongaby 的建议包含 /*。

如果没有提供所有必需的参数（即类别、控制器和操作），您将需要指定默认值。

你可以这样做：

```
$Router=$this->_front->getRouter();

$CategoryRoute = new Zend_Controller_Router_Route('category/:category/:controller/:action/*',
    array(
        'controller' => 'index',
        'action'     => 'index',
        'category'   => null
    )
);
$Router->addRoute('category', $CategoryRoute); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T14:50:25.387

```
$Router=$this->_front->getRouter();
$CategoryRoute = new Zend_Controller_Router_Route('category/:category/:controller/:action/*');
$Router->addRoute('category', $CategoryRoute); 
```

尝试添加一个 start 来指定额外参数的存在

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-26T09:00:51.083

请检查[http://webhkp.wordpress.com/2012/01/01/zend-framework-custom-router/](http://webhkp.wordpress.com/2012/01/01/zend-framework-custom-router/) 这将解决您的问题。

它用一个ini文件完成。我喜欢这样做

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:51:44.967

您必须在创建路由时指定默认值（参见 dcaunt 的帖子）或在 url 视图助手中指定*所有参数（类别、控制器和操作）*

# entity-framework - 在实体框架中存储多个更改

> ID：916144
> 
> 赞同：0
> 
> 时间：2009-05-27T14:46:06.440
> 
> 标签：entity-framework, entity

我正在尝试使用 Entity Framework 1.0 实现一种两阶段提交的形式。

我想在高水平上实现的是：

1.  从数据库中获取所有数据并将其存储在缓存中。
2.  修改单个实体
3.  将所有更改提交到数据库

到目前为止我遇到的问题是缓存 IQueryable 有点毫无意义，因为无论如何它都会返回数据库。因此，另一种选择是使用 IEnumberable 来存储查询的结果，但这会阻止我继承一个查询并将其细化为另一个查询（但是我可以接受）。另一个问题是，只要 EntityContext 过期（我已经设法在当前的 httprequest 中保留）就是这样，就无法跟踪任何更改。

过去有没有人试图做类似的事情或得到任何指示？

非常感谢，马特

jumpingmattflash.co.uk

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-05T17:44:50.383

IQueryable 只是一个可查询对象而不是实际数据。

您需要运行 ToList 以获取数据。

如果您可以保持上下文打开并使用事务范围，您就可以做您想做的事情。然而，在大多数情况下，这是不可能的。这也会锁定导致其他问题的数据库。

更好的方法是：

*   从数据库中读取数据
*   处理上下文
*   客户进行所需的任何更改
*   打开新的上下文
*   再次读取数据。
*   通过将数据从更改的数据复制到第二组来进行更改
*   提交更改
*   处理上下文

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-24T03:23:12.620

从数据库中调用`.ToList()`您的结果。`IQueryable`然后开始细化到其他查询中使用`.AsQueryable()`. 这应该可以解决您的第一个问题。

至于你的第二个问题，我也在寻找解决方案。据我了解，实体框架的关系部分的底层实现围绕程序集`ObjectStateManager`的`System.Data.Objects`命名空间中的`System.Data.Entity`。这又使用命名空间中的`MetadataWorkspace`类`System.Data.Metadata.Edm`来查找关系映射。这些可能可以在没有底层数据库连接的情况下使用，如果是这样，将提供一些非常通用的工具来更新复杂的对象图。

如果上下文以与单个实体类似的方式具有分离和附加功能，那就太好了。看起来实体框架的下一个版本将专注于这些特定类型的问题；处理实体和上下文时更自由。

# java - 排序坐标问题

> ID：916145
> 
> 赞同：3
> 
> 时间：2009-05-27T14:46:11.497
> 
> 标签：java, arrays, algorithm, coordinates

一直在想这件事——我认为这很简单，但我的几何/代数很垃圾，我不记得在学生时代怎么做这些事情了！

已编辑：我有一个与他们站在一起的人的坐标列表-我需要一种算法来在列表（数组）中从左上角到右下角对人进行排序，第二个标准要求靠近左上角原点的坐标采用凌驾于所有其他人之上——你将如何做到这一点？

代码应显示顺序为：

1.  汤姆
2.  哈利
3.  鲍勃
4.  戴夫

见下图：

![替代文字](https://rantincsharp.files.wordpress.com/2009/05/diagram.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T14:51:36.913

从您的订单来看，您似乎将 y 位置置于比 x 位置更高的优先级，因此在比较两个人时，这样的事情会起作用：

```
if (a.y > b.y)
// a is before b
else if (a.x < b.x)
// a is before b
else
// b is before a 
```

*编辑更新* 此比较仍然适用于您的新标准。Y 位置仍然优先于 X 位置。如果 Y 值相等，则最靠近左上角的点将是 X 值较小的点。如果您想让您的对象成为比较器，将其作为比较器函数实现将允许您执行 ArrayList.sort() ，其中负数表示第一个人在第二个人之前：

```
public int compareTo(person a, person b) {
    if (a.y == b.y)
       return a.x-b.x
    else
       return b.y-a.y
}

//compareTo(Tom, Harry) == -50 (tom is before harry)
//compareTo(Tom, Bob) == -25 (tom is before bob)
//compareTo(Dave, Bob) == 30 (dave is after bob) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T14:52:07.850

根据它们与 2D 空间左上角的距离对它们进行排序，在本例中为 (0, 100)。

编辑：

显然，这意味着您将遇到两个人与左上角等距的情况，但他们彼此相距不远。

在这种情况下，您需要指定您希望如何订购这些人。如果你想挑更高的人，你可以先按y坐标排序。同样，您可以选择其他一些标准。

所有其他排序算法都会有相同的问题，即当 2 个项目具有相同的排序键时该怎么办。根据定义，在您提出次要排序标准之前，它们*被认为是相同的。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:52:00.953

如果您知道 X 的最大数量级，请按（对于您给定的示例）100 * (100 - Y) + X 排序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T15:04:20.617

我会说：

```
orderValue = x+(100-y) 
```

然后根据“最接近”（根据投影到线 y=100-x 上的距离）到左上角的最小 orderValue 进行排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T14:52:42.870

比较器如下所示：

```
int d = o2.y - o1.y;
if (d == 0)
    d = o1.x - o2.x;
return d; 
```

这将首先按 Y 排序，然后按 X 排序（对于所有具有相同 Y 的对象）。

[编辑] 固定 Y 排序顺序。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-27T14:53:54.290

也许您可以查看在导航中使用的Haversine 公式来计算两点的接近度。但是，这主要适用于球体上的点。 [http://en.wikipedia.org/wiki/Haversine_formula](http://en.wikipedia.org/wiki/Haversine_formula)

# php - 如何通过 PHP 识别 google/yahoo/msn 的网络爬虫？

> ID：916147
> 
> 赞同：1
> 
> 时间：2009-05-27T14:46:26.893
> 
> 标签：php, web-crawler

AFAIK，

$_SERVER['REMOTE_HOST'] 应该以“google.com”或“yahoo.com”结尾。

但这是最有保障的方法吗？

还有其他出路吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T14:48:44.517

[您通过用户代理和 IP 地址](http://www.jafsoft.com/searchengines/webbots.html)来识别搜索引擎。更多信息可以在[如何识别搜索引擎蜘蛛和网络机器人](http://www.jafsoft.com/searchengines/spider_hunting.html)中找到。[这份清单](http://www.user-agents.org/)也值得注意。但是，您不应该将用户代理（甚至远程主机）视为必然的。用户代理实际上只不过是另一端告诉你的东西，当然它可以自由地告诉你任何事情。编写代码伪装成 Googlebot 很简单。

在 PHP 中，这意味着查看`$_SERVER['HTTP_USER_AGENT']`和`$_SERVER['REMOTE_HOST']`。

有很多搜索引擎，但老实说，一般来说，它只是您真正关心的少数几个。谷歌和雅虎一起拥有了几乎所有的市场。但这当然取决于您要实现的目标。

**注意：****当涉及到内容时，**要非常小心地将搜索引擎与普通用户区别对待（如乔尔所说的“邪恶的连字符网站”）。在特别恶劣的情况下，这可能会使您的网站从该搜索引擎中删除。即使这种情况没有发生，您也可能会让一些访问网站的用户望而却步。如果他们随后看到“请注册以查看本文”框，那么，请感谢您的高跳出率。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T14:55:36.220

首先，我希望您不要尝试这样做，以便为搜索引擎机器人提供与您的网站为普通用户提供的不同内容。如果他们发现您这样做，您的网站将从他们的列表中完全删除。只要您了解它的风险，您通常可以找到有关他们将使用什么唯一用户代理的信息：

*   [验证 Googlebot](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=80553)（如果您想确定，请使用用户代理、反向 DNS）
*   雅虎的用户代理将包含“Slurp”

然而，一些编写（通常行为不佳的）网络爬虫的人会将他们的用户代理字符串设置为与“合法”爬虫（如谷歌）相同。您可以通过查找机器人的 IP 地址/主机名来捕获这些信息，以确保它们实际上来自 Google/Yahoo/etc。有关在主机名查找中查找内容的更多信息（[来自本文](http://www.spanishseo.org/how-to-identify-user-agents-and-ip-addresses-for-bot-blocking)）：

> *   Google 抓取工具将以 googlebot.com 结尾，例如 crawl-66-249-70-244.googlebot.com。
> *   雅虎爬虫将以 crawl.yahoo.net 结尾，就像在 llf520064.crawl.yahoo.net 中一样。
> *   实时搜索爬虫将以 search.msn.com 结尾，如 msnbot-65-55-104-161.search.msn.com。
> *   Ask 爬虫将以 ask.com 结尾，如 crawler4037.ask.com。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T14:49:23.893

您最好使用 $_SERVER['HTTP_USER_AGENT'] 并​​查找 Googlebot 或 Yahoo! 啜饮。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T14:53:06.803

我不认为爬虫来自 google.com，而且我知道您不想将其他一些人视为来自那里的机器人。所有搜索您的网站的人。

您需要做的是查看不同机器人的 IP。 [http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=80553](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=80553)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T14:59:41.843

```
$_SERVER['HTTP_USER_AGENT'] 
```

*   Google Bot =“Mozilla/5.0（兼容；Googlebot/2.​​1；+ [http://www.google.com/bot.html](http://www.google.com/bot.html)）”
*   MSN 机器人 = msnbot-products/1.0 (+ [http://search.msn.com/msnbot.htm](http://search.msn.com/msnbot.htm) )

在此处检查各种用户代理字符串：[http ://www.user-agents.org/](http://www.user-agents.org/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-26T14:49:30.273

Google/Bing/Yahoo Crawlers IP 地址 -

[http://myip.ms/info/bots/Google_Bing_Yahoo_Facebook_etc_Bot_IP_Addresses.html](http://myip.ms/info/bots/Google_Bing_Yahoo_Facebook_etc_Bot_IP_Addresses.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T14:51:34.543

使用众所周知且行为良好的机器人（如您提到的那些机器人）的最佳方法是通过[用户代理](http://www.jafsoft.com/searchengines/webbots.html)，您可以在 $_SERVER['HTTP_USER_AGENT'] 上找到它。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-27T14:57:25.140

我一起破解了一些东西，但是您必须查看 $_SERVER['HTTP_USER_AGENT'] 以查看它们是否来自搜索引擎域。

```
function is_crawlers() {

   $sites = 'Google|Yahoo|msnbot|'; // Add the rest of the search-engines 

   return (preg_match("/$sites/", $_SERVER['HTTP_USER_AGENT']) > 0) ? true : false;  

   } 
```

# c - 使用 EOF 提供输入流

> ID：916148
> 
> 赞同：0
> 
> 时间：2009-05-27T14:46:27.843
> 
> 标签：c, io

我正在构建一个执行各种命令的小型 shell 解释器，我通过分叉我的进程来实现这一点。

但是，我希望子进程停止等待标准输入流中的输入，并且它通过期待 EOF 来实现。如何故意将 EOF 推送到该流中？

更具体地说，如果我在这种情况下循环：

```
while (fgets(&input, 1024, stdin) != NULL) { // ..... 
```

我怎样才能让它变成假的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:49:13.580

正常的方法是在发送（父）端关闭流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:51:10.113

不确定您的外壳在做什么 - 但我认为这样做的方法是关闭子端的“标准输入流”，`fork()`然后不再费心读取它。如果您已经分叉了一个孩子做某事，为什么它会退回到主输入处理循环中。

在伪代码中

```
if (pid = fork())
{
    // parent - wait for child to do it's thing and then process another command
}
else
{
    // child
    close(0);
    // do some sort of command processing and then exit 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:49:40.023

你不只是关闭管道的另一端吗？

# apache-flex - 是否可以使用 Flex 旋转动态添加的线？

> ID：916152
> 
> 赞同：2
> 
> 时间：2009-05-27T14:47:14.723
> 
> 标签：apache-flex

我正在使用 向画布添加一条线`canvas.moveTo(0, 0); canvas.lineTo(100, 100);`，但我希望用户移动鼠标来设置线的旋转。Google 建议使用该`rotation`属性，但我没有对 line 对象的引用。我可以参考这条线还是应该旋转整个画布？这有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T15:02:29.153

通常，您操纵绘制图形的表面——通常是 Sprite 实例，因为它非常轻量级并且非常适合该任务。相反，如果您创建了一个新的 Sprite，使用它的 Graphics 对象来绘制线条、形状等，将 Sprite 添加到 UIComponent - 如果不先将 Sprite 包装在 UIComponent 实例中，则无法直接将 Sprite 添加到 Canvas - - 然后将该 UIComponent 添加到您的 Canvas，您可以通过旋转、移动等直接操作 Sprite。

这通常是如何完成的，或者通过覆盖 createChildren() （如果对象打算在组件实例的持续时间内存在）或使用其他方法，具体取决于您的需要。例如：

```
override protected function createChildren():void
{
    super.createChildren();

    // Create a new Sprite and draw onto it
    var s:Sprite = new Sprite();
    s.graphics.beginFill(0, 1);
    s.graphics.drawRect(0, 0, 20, 20);
    s.graphics.endFill();

    // Wrap the Sprite in a UIComponent
    var c:UIComponent = new UIComponent();
    c.addChild(s);

    // Rotate the Sprite (or UIComponent, whichever your preference)
    s.rotation = 45;

    // Add the containing component to the display list
    this.addChild(c);
} 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:25:44.630

什么是画布（实际的画布没有 lineTo() 或 moveTo() 方法）？

似乎您可能正在操纵 Canvas 的图形对象。在这种情况下，您最好执行以下操作

```
private var sp : Sprite;
//canvas is whatever Canvas you wish to add the sprite to
private function addLine(canvas : Canvas) : void {
sp = new Sprite();
/* Do the drawing of the sprite here,
   such as sp.graphics.moveTo or sp.graphics.lineTo */
sp.rotation = 45;
canvas.rawChildren.addChild(sp);
} 
```

然后，每当您希望更改旋转时，只需更新 sp.rotation （现在在您的画布中）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:53:49.453

嗯...在画布上添加一个 Sprite，然后在 Sprite 的图形对象上绘制线条。然后您可以旋转 Sprite 等。您*可以根据需要*旋转画布，但如果您只是将其视为 Sprite，则创建画布会产生额外的开销（请注意，Canvas 将 Sprite 延伸到链的某个位置）。

看看 ASDocs 中的这个例子：[Rotating things](http://livedocs.adobe.com/flex/2/docs/wwhelp/wwhimpl/js/html/wwhelp.htm?href=00001943.html)

# .net - .NET + TeamCity：未编译私有访问器

> ID：916154
> 
> 赞同：0
> 
> 时间：2009-05-27T14:47:36.500
> 
> 标签：.net, unit-testing, mstest, teamcity

我正在为 VS2008 sln 文件运行 Team City Pro (v4.0.2 build 8222)。

现在我面临一个问题，即没有为测试项目中的私有访问器生成自动生成的代码，并且由于无法找到那些（自动生成的）类而导致编译错误。

构建运行器是默认的 sln2008。

有什么配置需要改吗？我检查了 VS 构建日志，它没有显示自动生成的类的任何 msbuild 条目。自动生成类的 DLL 就在那里。

注意：我知道测试私有方法是进行单元测试的最佳方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-14T17:14:53.210

AFAIK，TeamCity 不使用 msbuild 实用程序来构建解决方案。你不想[问 TeamCity 开发人员](http://www.jetbrains.com/support/teamcity/index.html)吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T08:55:57.607

确保 MSBuild 版本为 3.5，MSBuild ToolsVersion 为 3.0 或 3.5。 [替代文字 http://www.deploylx.com/so/tcbuildrunner.jpg](http://www.deploylx.com/so/tcbuildrunner.jpg)

**使用 MSBuild 运行 NUnit 测试**

```
 <PropertyGroup>
        <NUnitCommandArgs Condition="'$(NUnitCommandArgs)' == ''">$(NUnitCommandArgs) /noshadow /timeout=30000</NUnitCommandArgs>
        <NUnitCommandArgs Condition="'$(TestGroupInclude)' != ''">$(NUnitCommandArgs) /include=@(IncludeTestGroups, ',')</NUnitCommandArgs>
        <NUnitCommandArgs Condition="'$(TestGroupExclude)' != ''">$(NUnitCommandArgs) /exclude=@(ExcludeTestGroups, ',')</NUnitCommandArgs>
    </PropertyGroup>

    <ItemGroup>
        <NUnitAddinFiles Include="$(teamcity_dotnet_nunitaddin)-2.5.0.*" />
    </ItemGroup>

    <ItemGroup>
        <NUnitRuntimeFiles Include="$(ToolsPath)\nUnit\nunit.core.dll" />
        <NUnitRuntimeFiles Include="$(ToolsPath)\nUnit\nunit.core.interfaces.dll" />
        <NUnitRuntimeFiles Include="$(ToolsPath)\nUnit\log4net.dll" />
    </ItemGroup>

    <Target Name="RunUnitTests" >   

        <Message Text="Include=@(IncludeTestGroups), Exclude=@(ExcludeTestGroups)" Importance="High" />

        <MakeDir Directories="$(ToolsPath)\addins" />

        <Copy SourceFiles="@(NUnitAddinFiles)"
              DestinationFolder="$(ToolsPath)\addins"
              />

        <Copy SourceFiles="@(NUnitRuntimeFiles)"
              DestinationFolder="$(TestFolder)" />

        <Exec
            WorkingDirectory="$(ToolsPath)\nUnit\"
            Command="&quot;$(ToolsPath)\nUnit\nunit-console-x86.exe&quot; &quot;%(TestAssemblies.FullPath)&quot; $(NUnitCommandArgs)"
            />

    </Target> 
```

# c# - C# 属性 - 设置问题

> ID：916159
> 
> 赞同：8
> 
> 时间：2009-05-27T14:47:58.247
> 
> 标签：c#

我正在使用 C# 并开始使用属性。我不知道的一件事是什么是最好的方式/在哪里放置类属性的集合访问器的逻辑以及如何处理错误。

例如，假设我有这个（基本）类：

```
class Person
{
    private int _Age = 18;

    public Person()
    {

    }

    public int Age
    {
        get
        {
            return _Age;
        }
        set
        {
            _Age = value;
        }
    }
} 
```

现在假设我对 Age 属性有一个要求，0 < Age < 100。我在哪里放置这个逻辑？

我应该把它放在财产中吗？

```
public int Age
    {
        get
        {
            return _Age;
        }
        set
        {
           if (value < 0 || value > 99)
               // handle error
           else
               _Age = Convert.ToInt32(value);
        }
    } 
```

或通过创建 Person 对象的类？

```
static void Main(string[] args)
{
   Person him = new Person();
   int NewAge = -10;

   if (NewAge < 0 || NewAge > 100)
      // handle error 
   else
      him.Age = NewAge;
} 
```

现在，如果 NewAge 出现问题（它不符合我的限制）怎么办？我应该创建一个自定义异常并抛出它吗？我应该只打印一条消息说提供有效年龄吗？

我做了一些谷歌搜索，但我找不到任何可以完全回答我问题的东西。我需要一本书：-/

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-27T14:49:54.967

使用属性设置器，出于这个原因（向字段添加功能）。

如果传入超出范围的值，您可以抛出[ArgumentOutOfRangeException](http://msdn.microsoft.com/en-us/library/system.argumentoutofrangeexception.aspx)或将其设置为最小值（或最大值），但这取决于您的流程要求。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-27T15:02:55.457

我会这样实现它：

```
public int Age
{
    get
    {
        return _Age;
    }
    set
    {
       if (IsValidAge(value))
           _Age = value;
       else
           throw new ArgumentOutOfRangeException("value", string.Format("value should be between {0} and {1} inclusive.", MinAge, MaxAge));
    }
}

private bool IsValidAge(int age)
{
    return (age >= MinAge && age <= MaxAge);
} 
```

需要注意的几点：

*   不要更改它们的值而不是抛出异常，这是意外行为。
*   .NET 框架在设置器中抛出 Argument* 异常，所以我认为遵循这种做法是个好主意。在这种情况下 ArgumentOutOfRangeException 是完美的，IMO。
*   当引用异常消息和 xml 文档中的参数时，标准是调用参数“值”，而不是您的属性的名称。
*   我会推荐 MinAge 和 MaxAge 作为您班级中的私有常量，不要陷入带有范围边界的硬编码错误消息的陷阱，没有什么比被告知“5 无效，请输入 1 到 10 之间的数字”更糟糕的了" 当有人稍后更改规范但忘记更新字符串时。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-27T14:50:49.723

您需要将逻辑放入 setter 中，如果不满足要求则抛出异常。但是，您还需要创建一个 IsValidAge 静态方法或其他东西，以便创建 Person 的类可以检查年龄值，而不仅仅是查看它是否引发异常。或者，您可以拥有 MinAge 和 MaxAge 属性，因此调用代码可以检查他们要设置的年龄是否介于两者之间。

但是不要创建自定义异常类型，使用 ArgumentOutOfRangeException 或类似的东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T14:50:30.397

把它放在财产中。这是属性的主要目的之一！

考虑到您将把责任放在尽可能低的级别。*您给出的示例除了value*参数之外不需要任何其他东西来做出决定。它甚至不依赖于同一类的其他成员。类的其他人没有理由知道 Age 属性的有效性是如何工作的，当然也没有任何其他代码知道它的理由。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-27T14:55:42.880

您可能需要查看 IDataErrorInfo 接口。

通过在您的类中实现此接口，您将向可以从附加错误信息中受益的其他机制打开该类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T15:01:47.813

我将扮演魔鬼的拥护者并给出一个答案，为什么你不想把它放在二传手中。在很多情况下，您希望能够设置 Age 属性的值，然后再询问该对象在整体意义上是否有效。

例如，保持你的属性简单：

```
public int Age { get; set; } 
```

然后，当传入无效值时，您可以使用一些 IsValid 函数来指示相关对象是否正常。这可能非常有用，因为除了简单的年龄限制之外，您还可以进行更复杂的验证。

```
bool IsValid()
{
   if (Age < 0 || Age > 99)
     return false;
} 
```

对于像这样简单的事情并没有太多好处，但也要考虑到您可以在持久层中使用它，这样您就可以确保任何无效的对象都不会被持久化。在这些情况下，您不一定要抛出异常。

还要考虑这个：

```
DateTime StartDate { get; set; }
DateTime EndDate { get; set;}

bool IsValid()
{
   return StartDate > EndDate      
} 
```

这只是伪代码，但你明白我的意思。这是你不能在 setter 中做的事情，或者至少不能以可维护的方式做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T14:58:35.637

正如其他人已经说过的那样，使用 setter 并使用 ArgumentOutOfRangeException。

有时你会调用另一个方法，通常是 OnAgeChanged(int age)，你可以在其中执行验证（这可能是对另一个方法的调用，因此你可以在任何地方使用它）并调用一个事件处理程序，如果连接起来，根据您使用对象的方式，可能需要应用其他逻辑。在您的场景中这可能不是必需的，但对属性执行此操作很常见。特别是如果您要更新表单 - 表单会挂接到 AgeChanged 事件以更新自身。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T15:05:42.003

如果您正在进行分解设计（即，对象的状态在对象生命周期的所有时间点都有效是很重要的），那么您可能需要在构造函数中设置并检查它。在组件设计中，您希望在使用该属性的方法中检查这一点，例如

```
class Person
{
  public int calculateTimeToExpiration()
  {
  if (Age < 0 || Age > 100)
     //throw
  }
} 
```

静态 void main 是客户端代码，不是业务逻辑的好地方。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T15:18:26.080

感谢您的回答！如果您对此感到好奇，我将我的小示例（尽管现在更详细）更改为（基于评论）。

```
class Person
{
    private string _FirstName = "Joe";
    private string _LastName = "Smith";
    private int _Age = 18;

    private const int MinAge = 1;
    private const int MaxAge = 99;

    public Person()
    {

    }

    public Person(string FirstName, string LastName, int Age)
    {
        this.FirstName = FirstName;
        this.LastName = LastName;
        this.Age = Age;
    }

    public string FirstName
    {
        get
        {
            return _FirstName;
        }
        set
        {
            _FirstName = value;
        }
    }

    public string LastName
    {
        get
        {
            return _LastName;
        }
        set
        {
            _LastName = value;
        }
    }

    public int Age
    {
        get
        {
            return _Age;
        }
        set
        {
            if (IsValidAge(value))
                throw new ArgumentOutOfRangeException("value","Please enter a positive age less than 100.");
            else
                _Age = value;
        }
    }

    private bool IsValidAge(int age)
    {
        return (age < MinAge || age > MaxAge);
    }

    public override string ToString()
    {
        if (Age == 1) 
            return "My name is " + FirstName + " " + LastName + " and I am " + Age + " year old.";
        else
            return "My name is " + FirstName + " " + LastName + " and I am " + Age + " years old.";
    }  
}

static void Main(string[] args)
    {
        Person him, her;

        try
        {
            him = new Person("Joe Bob", "McGruff", 1);
            Console.WriteLine(him);
        }
        catch (ArgumentOutOfRangeException range)
        {
            Console.WriteLine(range.Message);
        }

        try
        {
            her = new Person();
            her.Age = -5;
            Console.WriteLine(her);
        }
        catch (ArgumentOutOfRangeException range)
        {
            Console.Write(range.Message);
        }

        Console.ReadKey();
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T17:43:32.433

您更新的答案很好，但您应该清理您的设置器/验证中的一小部分

```
 public int Age
    {
        get
        {
            return _Age;
        }
        set
        {
            if (!IsValidAge(value))
                throw new ArgumentOutOfRangeException("Age","Please enter a positive age less than 100.");

             _Age = value;
        }
    }

    private bool IsValidAge(int age)
    {
        return (age > MinAge && age < MaxAge);
    } 
```

# wpf - 等价于 WPF 中的 SuspendLayout 和 ResumeLayout

> ID：916162
> 
> 赞同：3
> 
> 时间：2009-05-27T14:48:07.607
> 
> 标签：wpf, layout

具体场景。ControlA 更改导致 ControlB（scrollviewer 的子类）重新配置其视口、偏移量和范围的值，然后触发 ScrollableChanged 事件。ControlB 还捕获“ScrollableChanged”事件并以编程方式滚动到确定的偏移量。如果我可以在更改值之前调用suspendlayout并在执行计算的滚动之后调用resumelayout，这将创建这种可怕的双重重绘，这将完全避免。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-20T12:50:55.180

从[这里](http://social.msdn.microsoft.com/Forums/en/wpf/thread/af607ee9-d8b2-418c-9de3-1eb3f9435eca)：

> 由于布局是在单独的通道中完成的，因此当 UI 线程忙于做其他事情时，它会被隐式阻止更新。因此，您可以添加所需的所有控件并更改所需的所有属性，并且更改在 UI 线程返回之前不会生效。

# hibernate - 无法使用标识列密钥生成 ( TABLE_PER_CLASS )

> ID：916169
> 
> 赞同：104
> 
> 时间：2009-05-27T14:49:01.083
> 
> 标签：hibernate, inheritance, jpa, class-table-inheritance

**com.something.SuperClass：**

```
@Entity
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
public abstract class SuperClass implements Serializable {
    private static final long serialVersionUID = -695503064509648117L;

    long confirmationCode;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO) // Causes exception!!!
    public long getConfirmationCode() {
        return confirmationCode;
    }

    public void setConfirmationCode(long confirmationCode) {
        this.confirmationCode = confirmationCode;
    }
} 
```

**com.something.SubClass：**

```
@Entity
public abstract class Subclass extends SuperClass {
    private static final long serialVersionUID = 8623159397061057722L;

    String name;

    @Column(nullable = false)
    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
} 
```

**给了我这个例外：**

```
Caused by: org.hibernate.MappingException: Cannot use identity column key
generation with <union-subclass> mapping for: com.something.SuperClass 
```

我生成 ID 的最佳和最方便的方法是什么？*我不想改变我的继承策略。*

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2009-05-28T22:29:58.830

这里的问题是你混合了“每类表”继承和`GenerationType.Auto`. 考虑 MsSQL 中的标识列。它是基于列的。在“每类表”策略中，每个类使用一个表，每个表都有一个 ID。

尝试：

`@GeneratedValue(strategy = GenerationType.TABLE)`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-10T15:52:03.337

我想知道这是否是特定于数据库方言的问题，因为观看了以 PostgreSQL 作为基础数据库的 youtube 教程，我看到视频的创建者成功地运行了具有默认 @GeneratedValue 的应用程序。在我的情况下（底层数据库是 MySQL），我必须完全按照 zoidbeck 的建议将 @GeneratedValue 策略修改为 GenerationType.TABLE。

这是视频：[https ://www.youtube.com/watch?v=qIdM4KQOtH8](https://www.youtube.com/watch?v=qIdM4KQOtH8)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-06-21T13:32:36.810

同意zoidbeck的回答。您需要将策略更改为：

```
@GeneratedValue(strategy = GenerationType.TABLE) 
```

但这还不是全部，您需要创建一个新表，它将保存您的摘要表的主键序列。将您的映射修改为

```
@Id
@GeneratedValue(strategy = GenerationType.TABLE, generator = "ConfirmationCodeGenerator")
@TableGenerator(table = "SEQUENCES", name = "ConfirmationCodeGenerator")
public long getConfirmationCode() {
   return confirmationCode;
} 
```

数据库中的新表应如下所示： ![在此处输入图像描述](https://i.stack.imgur.com/HDvEL.png)

当您运行您的应用程序时，Hibernate 将插入一行`sequence_name`作为实体名称（`SuperClass`在本例中）并且`sequence_next_hi_value`值将自动递增并用于所有实现子类表的新记录。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-06T21:01:58.807

在我们的例子中，我们使用 PostreSQL 数据库进行开发和生产，使用内存中的 hsqldb 数据库进行测试。在这两种情况下，我们都使用序列来生成 id。显然`GenerationType.AUTO`默认`SEQUENCE`为 postgres，但在我们的本地测试中失败（对于 hsqldb，必须默认为其他东西）。

所以对我们有用的解决方案，明确地使用`GenerationType.SEQUENCE`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-07T02:08:16.820

您可以使用@MappedSuperclass 进行继承

# c# - 如何使用 c# 将电子邮件发送到 Exchange 分发列表

> ID：916170
> 
> 赞同：8
> 
> 时间：2009-05-27T14:49:07.543
> 
> 标签：c#, email, exchange-server

我需要使用 c# 向名为“DL-IT”的 Exchange 分发列表发送电子邮件。

有谁知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T14:53:17.083

最简单的方法是找到 DL 的实际电子邮件地址，并在“收件人：”字段中使用它。Exchange 分发列表实际上有自己的电子邮件地址，因此应该可以正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T15:03:44.033

Exchange 服务器运行 SMTP，因此可以使用[SmtpClient](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx)发送电子邮件。

可以（手动）查找分发列表的 SMTP 地址，并将其用作[MailMessage](http://msdn.microsoft.com/en-us/library/system.net.mail.mailmessage.aspx)构造函数上的“收件人”地址。如果您只传入分发列表的名称，构造函数调用将失败，因为它*看起来*不像一个*真实的*电子邮件地址。

```
public void Send(string server, string from, string to)
{
    // Client to Exchange server
    SmtpClient client = new SmtpClient(server);

    // Message
    MailMessage message = new MailMessage(from, to);
    message.Body = "This is a test e-mail message sent by an application. ";
    message.Subject = "test message 1";

    // Credentials are necessary if the server requires the client 
    // to authenticate before it will send e-mail on the client's behalf.
    client.Credentials = CredentialCache.DefaultNetworkCredentials;

    // Send
    client.Send(message);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-08T17:14:24.093

基本上你需要结合上面的两个解决方案。

使用 Scott 解决方案中的代码片段 - 您应该发送到`DL-IT@mycompany.com`.

但是交换名称别名并不总是与群组电子邮件相同，因此

*   `DL-IT`您可以在 Outlook 中使用in`To`字段打开一封空电子邮件
*   双击`DL-IT`输入`To`字段
*   从字段中复制值`Alias Name`并添加`@mycompany.com`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-17T05:12:13.280

上面的答案很好，请注意，如果分发列表的成员之一不是有效地址，则 SMTP 服务器可能会拒绝整个电子邮件，因为无法投递。

这可能是因为在我们的例子中，我们使用的 SMTP 服务器不是 Exchange 的一部分，但无论如何都需要注意这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-13T17:00:23.790

就我而言，它不起作用，因为我将电子邮件发送到为此列表定义的多个别名之一。在我看来，用于显示的地址可能与真实地址不同。

我让它工作的方式是在 Outlook (2016) 中单击“收件人...”按钮，然后在全球通讯簿中搜索 ML。有两个条目，一个带有地球符号，一个带有人物符号。

[![在此处输入图像描述](https://i.stack.imgur.com/tC9PG.png)](https://i.stack.imgur.com/tC9PG.png)

右键单击带有地球的那个，选择属性。在这里您可以找到电子邮件地址。

# visual-studio - 如何为 visualstudio c++ 项目指定 /clr 和 /mtd 选项

> ID：916172
> 
> 赞同：1
> 
> 时间：2009-05-27T14:49:19.070
> 
> 标签：visual-studio, visual-c++, visual-studio-2005

在我的项目中，我在代码生成部分启用了[/clr](http://msdn.microsoft.com/en-us/library/k8d11d4s(VS.80).aspx)（公共语言运行时）支持以及 / [MTd](http://msdn.microsoft.com/en-us/library/2kzt1wy3(VS.80).aspx)（多线程调试）选项。

但是编译器显示 /clr 和 /MTd 是不兼容的类型。我需要同时使用两者。
如何解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T18:25:35.047

改用[/MDd](http://msdn.microsoft.com/en-us/library/2kzt1wy3(VS.80).aspx)选项，它与 /clr 兼容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T11:33:36.100

你不能在一个项目中同时使用这两个选项，因为 c/clr 需要它必须使用的开关

动态库而不是静态库。如果你使用 /mtd 它使用静态库。所以你不能'

使用 /clr 和 /mtd

# c - 如何正确识别我的构建平台？

> ID：916186
> 
> 赞同：3
> 
> 时间：2009-05-27T14:50:42.673
> 
> 标签：c, operating-system, makefile

我想知道一个参数，它是当前操作系统的指标。如果支持 Windows 和 Linux，我如何获得区分操作系统类型的系统参数。这适用于通过检查“if”中的参数在 Windows 和 Linux 中运行的独立于操作系统的 makefile。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T15:03:05.160

过去我检查过环境变量 OS 的值。这是在 Windows 上设置的。对于其他平台，我已在环境中明确设置它。然后，这使您可以将特定于平台的设置推送到名为 ...

```
makefile.Windows_NT
makefile.Linux
makefile.HPUX 
```

然后在我的主makefile中

```
SUPPORTED_PLATFORMS=Windows_NT AIX AIX32 Solaris8 Linux HPUX Solaris_64

ifeq (,$(findstring $(OS),$(SUPPORTED_PLATFORMS)))

all %:
        @echo The OS environment variable is set to [$(OS)].
        @echo Please set the OS environment variable to one of the following:
        @echo $(SUPPORTED_PLATFORMS)

else

include makefile.$(OS)

all:
        @$(TCLSH) makefile.tcl
        @$(MAKE) -f makefile.gen

clean:
        @$(TCLSH) makefile.tcl
        @$(MAKE) -f makefile.gen clean
        @$(RM) makefile.gen

etags:
        @$(RM) TAGS
        @etags *.cpp *.h TAGS
        @$(MAKE) -C Core etags
        @$(MAKE) -C Components etags
        @$(MAKE) -C Repository etags

tags: ctags

ctags:
        @ctags *.h
        @$(MAKE) -C Core ctags
        @$(MAKE) -C Components ctags
        @$(MAKE) -C Repository ctags

lint:
        @$(TCLSH) makefile.tcl
        @$(MAKE) -f makefile.gen lint

depends:
        @$(TCLSH) makefile.tcl
        @$(MAKE) -f makefile.gen depends

endif 
```

这一切都有效，因为我可以通过 makefile.$(OS) 提取平台特定的设置

这是我的主 makefile 的总和，它可以为七个不同的平台编译。您可以使检测更聪明，但这会降低可理解性。

在每个 makefile.WHATEVER 中，我提供了诸如

```
#*******************************************************************************
#
#   Platform specific tools
#
CC              = CL
RM              = rm
LINK            = LINK
ETAGS           = c:\emacs\bin\etags
TCLSH           = tclsh83

#*******************************************************************************
#
#   Platform specific CC definitions
#
INCLUDE := $(SYS_INCDIR);$(INCLUDE);$(SOURCE_ROOT_DIR)/SivTech/cpp;$(ORACLE_INCDIR);$(DB2_INCDIR);$(ODBC_INCDIR);$(MYSQL_INCDIR);$(TCL_INCDIR);$(XML_INCDIR);$(XSLT_INCDIR);$(JNI_INCLUDE);$(ACE_INCDIR);$(TAO_INCDIR);$(TAO_SERVICES_INC);$(CPPUNIT_INCDIR);$(ICU_INCDIR);$(SAP_INCDIR);$(QAS_INCDIR);$(INFA_INCDIR);$(MELISSADATA_INCDIR);$(ADDRESSDOCTOR_INCDIR)

CC_DEFS := $(CC_DEFS) -DOS_WIN_95 -D_WIN32_WINNT=0x400 -D_MBCS -DWIN32_LEAN_AND_MEAN -DWIN32 -DWIN32_EXTRA_LEAN $(CC_DEFINES)

CC_FLAGS_CMN    := /c /nologo /G7  /EHsc /W3  $(CC_FLAGS$) $(CC_DEFS) $(MYFLAGS)
CC_FLAGS_DBG    := $(CC_FLAGS_CMN) /Gi /MDd /Od /Zi /RTCu /RTCs /GZ 
```

显然，这是一个 C/C++ 焦点生成文件，但它证明您可以抽象出所有平台细节。

克里斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T06:22:12.540

您可能有兴趣查看：[预定义的 C/C++ 编译器宏](http://predef.sourceforge.net/ "预定义的 C/C++ 编译器宏")。这是一座金矿。

# visual-studio-2008 - VS2010 和 VS2008 项目兼容性

> ID：916190
> 
> 赞同：21
> 
> 时间：2009-05-27T14:51:07.587
> 
> 标签：visual-studio-2008, visual-studio-2010

有谁知道 VS2010 是否将使用与 2008 相同的项目和解决方案文件格式，或者 2008 项目文件是否需要升级到 2010 格式才能在该版本中打开？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T14:56:48.447

“Visual Studio 2010 将允许您轻松地将项目从以前版本的 Visual Studios 迁移到 VS 2010，我将此过程称为“将项目从 VS 200X 转换为 VS 2010”......

VS 2010 还允许您将项目的目标框架版本从 .NET 2.0、3.0 或 3.5 更改为 .NET 4.0……我将这个过程称为“升级”……”

摘自[http://vishaljoshi.blogspot.com/2009/05/vs-2010-project-conversion-upgrade.html](http://vishaljoshi.blogspot.com/2009/05/vs-2010-project-conversion-upgrade.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-03-16T23:03:39.347

我刚刚创建了一个小[批处理文件，可以随意在 VS2008 和 VS2010 之间进行转换](http://cultiv.nl/blog/2010/3/16/convert-between-vs2008-and-2010-projects,-automatically)（反之亦然）。

它以自动方式在两个版本之间重写位于[http://blogs.msdn.com/rextang/archive/2009/07/06/9819189.aspx的字符串。](http://blogs.msdn.com/rextang/archive/2009/07/06/9819189.aspx)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-10-22T00:14:42.880

有个窍门。

1.  创建一个新的解决方案文件。
2.  添加所有现有项目，并在此过程中对其进行升级。
3.  在 VS 2008 中使用旧的解决方案文件，在 VS 2010 中使用新的解决方案文件。

我对 VS 2005/2008 做了同样的事情，没有遇到任何问题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-01-08T08:37:10.137

好吧，如果您尝试在仅运行 VS2008 的计算机上打开 VS2010 项目，实际上会遇到一个问题。

VS2010 对项目文件中的 MSBuild 引用（.target-file）进行了更改，如果您不将该引用更改回 VS2008 默认值，则它无法在 VS2008 中编译。但是，如果您将两个版本都安装在同一台机器上，它就可以正常工作。

因此，您可以让一半的团队安装 VS2010 版本而不使用它，并且他们可以出于任何原因使用 VS2008。

*但是我不确定发布框架 4.0 的语言特定功能将如何与 VS2008 一起使用，我的理论是 IDE 不会把这一切都做好。因此，如果您使用 C# 但同时针对 VS2008 和 VS2010，请避免使用新的语言功能。*

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-10-29T09:42:06.757

您可能只有两个不同的解决方案文件。通常在开源中，他们制作 fx。项目 2008.sln 和项目 2005.sln。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-10T12:55:31.833

要将 Visual Studio 2010 解决方案文件 (.sln) 转换为 Visual Studio 2008 解决方案文件 (.sln)，只需按照以下步骤操作：

1.  在 .sln 文件中，将“Format Version 11.00”替换为“Format Version 10.00”
2.  在 .sln 文件中，将“#Visual Studio 2010”替换为“#Visual Studio 2008”
3.  在 .csproj 中将“ToolsVersion=''4.0''”替换为“ToolsVersion=''3.5''”
4.  在 .csproj 中将“v10.0”替换为“v9.0”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T14:54:48.733

VS2010 将能够处理 2.0 到 4.0 框架项目，因此如果您在其中一个框架中有一个项目，那么您不太可能不得不担心任何类型的更新或导入或任何类似的事情。并与当前项目一起运行。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-28T13:53:22.900

在记事本中打开解决方案文件 (.sln) 并更改 Microsoft Visual Studio 解决方案文件，格式版本 11.00

# 视觉工作室 2010

到 Microsoft Visual Studio 解决方案文件，格式版本 10.00

# 视觉工作室 2008

然后从 Visual Studio 2008 打开解决方案文件

# tfs - 我可以从触发 TFS 中的 CI 构建中排除文件吗？

> ID：916192
> 
> 赞同：3
> 
> 时间：2009-05-27T14:51:23.717
> 
> 标签：tfs, continuous-integration, tfsbuild

我有一个程序集版本文件 (SolutionAssemblyVersion.cs)，我将它保存在 TFS 中我的树干的根目录中。我更新了这个文件并在构建过程中将其签入。当我在 TFS 中使用 CI 构建时，它基本上会因签入而触发另一个构建。有没有办法将某些用户排除在触发构建之外？

我看过 Martin Woodward 的 TFS Top Tip #16 - Limit What you Build 帖子，但我希望不必仅为它创建文件夹。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T15:27:25.937

我想通了 - 添加：

> ***NO_CI***（3 星）

到您的签到评论的前面。巴克霍奇斯[在博客](https://devblogs.microsoft.com/buckh/tfs-2008-how-to-check-in-without-triggering-a-build-when-using-continuous-integration/)上写过它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T09:48:41.940

如果您不想对字符串进行硬编码，则有一个名为 $(NoCICheckInComment) 的 MSBuild 变量。

# asp.net - 将 AJAX 与 DataGrid 结合使用的最佳实践是什么？

> ID：916193
> 
> 赞同：1
> 
> 时间：2009-05-27T14:51:25.277
> 
> 标签：asp.net, ajax, datagrid

我有一个数据网格和一个更新面板。现在，我只是浏览了一些博客，发现您应该尽可能少地使用更新面板。在我的情况下，我有一个 Datagrid 和一个更新面板，这将是最好的情况？

1) 将 Datagrid 保留在更新面板内。

2) 在 ItemTemplates 中使用更新面板。这样只有当我只更新所选行而不是整个网格时才更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T17:05:09.063

不幸的是，除非您的 DataGrid 非常大，否则它不会有太大的不同。

您的大部分开销通常用于重新实例化页面。即使您的 UpdatePanel 只发送回一个呈现的行，也必须重新创建和呈现整个页面，包括整个 DataGrid，然后才能提取 HTML 的相关部分并将其发送回浏览器。

如果您所拥有的一切正常，我将不理会它，并将所有持续的努力集中在更加以客户为中心的方法上，这将获得巨大的性能提升。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:57:39.633

如果性能是您的目标，请从 DataGrid 开始。它在视图状态中存储的垃圾量是惊人的。

UpdatePanel 本身并不像DataGrid 那样糟糕。

# wpf-controls - 在 WPF 中选择 Treeviewitem

> ID：916197
> 
> 赞同：0
> 
> 时间：2009-05-27T14:51:45.713
> 
> 标签：wpf-controls

我有一个搜索文本框来搜索 treeviewitem 并选择它。树视图中的子项是延迟加载的。

我想选择在搜索文本框中传递的树视图的子时间。

我怎样才能做到这一点？

谢谢沙拉特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T14:58:52.187

这里有一些关于在 TreeView 中选择项目的好信息：

[http://askernest.com/archive/2008/01/23/how-to-programmatically-change-the-selecteditem-in-a-wpf-treeview.aspx](http://askernest.com/archive/2008/01/23/how-to-programmatically-change-the-selecteditem-in-a-wpf-treeview.aspx)

和这里：

[http://www.codeproject.com/KB/WPF/TreeView_SelectionWPF.aspx](http://www.codeproject.com/KB/WPF/TreeView_SelectionWPF.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-18T13:42:50.157

这是我的助手，提取您需要的内容：PS。我从未测试过 ExpandAll 方法。

```
Imports System.Runtime.CompilerServices
Imports System.Windows.Controls.Primitives

<HideModuleName()>
Module TreeViewHelper

  <Extension()>
  Public Sub SetSelectedItem(ByVal treeView As TreeView, ByVal item As Object)
    SetSelectedItemInternal(treeView, item)
  End Sub
  <Extension()>
  Public Sub SetSelectedItem(ByVal treeViewItem As TreeViewItem,
                             ByVal item As Object)
    SetSelectedItemInternal(treeViewItem, item)
  End Sub
  Private Sub SetSelectedItemInternal(ByVal control As ItemsControl,
                                      ByVal item As Object)
    ValidateItemsControl(control)
    If item Is Nothing Then Throw New ArgumentNullException("item")
    If Not control.Items.Contains(item) Then _
      Throw New ArgumentOutOfRangeException("item",
        "Specified item was not found in the control.")

    If control.ItemContainerGenerator.Status =
      GeneratorStatus.ContainersGenerated Then

      DirectCast(control.ItemContainerGenerator.ContainerFromItem(item), 
        TreeViewItem).IsSelected = True
    Else
      Dim selectWhenReadyMethod As EventHandler

      selectWhenReadyMethod =
        Sub(sender, e)
          If control.ItemContainerGenerator.Status =
            GeneratorStatus.ContainersGenerated Then
            RemoveHandler control.ItemContainerGenerator.StatusChanged,
              selectWhenReadyMethod

            SetSelectedItemInternal(control, item)
          End If
        End Sub
      AddHandler control.ItemContainerGenerator.StatusChanged,
        selectWhenReadyMethod
    End If
  End Sub

  <Extension()>
  Public Sub SetSelectedIndex(ByVal treeView As TreeView, ByVal index As Object)
    SetSelectedIndexInternal(treeView, index)
  End Sub
  <Extension()>
  Public Sub SetSelectedIndex(ByVal treeViewItem As TreeViewItem,
                              ByVal index As Object)

    SetSelectedIndexInternal(treeViewItem, index)
  End Sub
  Private Sub SetSelectedIndexInternal(ByVal control As ItemsControl,
                                       ByVal index As Object)

    ValidateItemsControl(control)

    If index < 0 OrElse index > control.Items.Count - 1 Then _
      Throw New ArgumentOutOfRangeException("index")

    If control.ItemContainerGenerator.Status =
      GeneratorStatus.ContainersGenerated Then

      DirectCast(control.ItemContainerGenerator.ContainerFromIndex(index), 
        TreeViewItem).IsSelected = True

    Else
      Dim selectWhenReadyMethod As EventHandler

      selectWhenReadyMethod =
        Sub(sender, e)
          If control.ItemContainerGenerator.Status =
            GeneratorStatus.ContainersGenerated Then
            RemoveHandler control.ItemContainerGenerator.StatusChanged,
              selectWhenReadyMethod

            SetSelectedIndexInternal(control, index)
          End If
        End Sub
      AddHandler control.ItemContainerGenerator.StatusChanged,
        selectWhenReadyMethod
    End If
  End Sub

  <Extension()>
  Public Sub ExpandAll(ByVal treeView As TreeView)
    ExpandAllInternal(treeView)
  End Sub
  <Extension()>
  Public Sub ExpandAll(ByVal treeViewItem As TreeViewItem)
    ExpandAllInternal(treeViewItem)
  End Sub
  Private Sub ExpandAllInternal(ByVal control As ItemsControl)
    ValidateItemsControl(control)

    If control.Items.IsEmpty Then Exit Sub

    If control.ItemContainerGenerator.Status =
      GeneratorStatus.ContainersGenerated Then

      For i = 0 To control.Items.Count - 1
        Dim item =
          DirectCast(control.ItemContainerGenerator.ContainerFromIndex(i), 
            TreeViewItem)

        item.IsExpanded = True
        ExpandAllInternal(control)
      Next
    Else
      Dim expandWhenReadyMethod As EventHandler

      expandWhenReadyMethod =
        Sub(sender, e)
          If control.ItemContainerGenerator.Status =
            GeneratorStatus.ContainersGenerated Then
            RemoveHandler control.ItemContainerGenerator.StatusChanged,
              expandWhenReadyMethod

            ExpandAllInternal(control)
          End If
        End Sub
      AddHandler control.ItemContainerGenerator.StatusChanged,
        expandWhenReadyMethod
    End If
  End Sub

  Private Sub ValidateItemsControl(ByVal control As ItemsControl)
    If control Is Nothing Then Throw New ArgumentNullException("control")
    If Not TypeOf control Is TreeView AndAlso
      Not TypeOf control Is TreeViewItem Then _
      Throw New  _
        NotSupportedException(control.GetType.FullName & " is not supported.")
  End Sub

End Module 
```

# silverlight - Silverlight Combobox 数据绑定：基本又快捷的方法？

> ID：916211
> 
> 赞同：1
> 
> 时间：2009-05-27T14:53:29.080
> 
> 标签：silverlight, combobox

请告诉我将集合（列表等）绑定到组合框并处理选择更改事件并获取所选项目的基本和快速方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T16:49:24.307

这很容易。您可以使用 XAML+Code 或仅使用代码来执行此操作。我不会输入一个完整的解决方案，因为我觉得你会从自己完成这部分中受益更多。我在这里假设您已经有一些 XAML 声明了一个组合框，所以我刚刚展示了一些代码（在 C# 中，因为您没有说明您使用的是什么语言），只知道可以轻松分配事件处理程序而是通过 XAML。

```
this.combo.SelectionChanged +=
    new SelectionChangedEventHandler(comboProjects_SelectionChanged);

this.combo.ItemsSource = myCollectionOfItems; 
```

这为选择更改设置了一个事件处理程序，并将组合绑定到一个集合，该集合用于获取其项目（因此名称为[`ItemsSource`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemssource(VS.95).aspx)）。

然后，在[`SelectionChanged`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectionchanged(VS.95).aspx)事件处理程序中，您可以获取[`SelectedItem`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selecteditem(VS.95).aspx)属性以找出选择的内容。

请注意， 中的绑定有一些注意事项[`ComboBox`](http://msdn.microsoft.com/en-us/library/system.windows.controls.combobox(VS.95).aspx)，因此您可能会发现这些链接很有用：

*   [http://silverlight.net/forums/t/63616.aspx](http://silverlight.net/forums/t/63616.aspx)
*   [http://silverlight.net/forums/p/87111/202335.aspx#202335](http://silverlight.net/forums/p/87111/202335.aspx#202335)

# hibernate - 没有复合键的休眠中的多对多

> ID：916212
> 
> 赞同：1
> 
> 时间：2009-05-27T14:53:35.770
> 
> 标签：hibernate, hsqldb, many-to-many, composite-key

我正在处理遗留数据库。我正在使用 pojos & hibernate & **HSQLDB**编写单元测试。我收到以下错误：

```
17：09：03,946 错误 SchemaExport：349 - 尝试在语句中定义第二个主键
```

假设我有`Post`和`Tag`实体（当然还有他们的表`posts`和`tags`）。`Post`还有另一个表来定义和`Tag`调用之间的多对多`post_tags`。

因为`post_tags`包含一些关于关系的额外信息，比如`active`和`deleted`列。我创建了另一个实体`PostTag`来处理这个问题。

在这里描述我的问题是伪类：

```
@Entity
@Table(name="post_tags")
public class PostTag {
    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    private int id;

    @ManyToOne
    private Post post;

    @ManyToOne
    private Tag tag;

    // setters and getters
}

@Entity
@Table(name = "tags")
public class Tag {
    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    private int id;

    @ManyToMany(mappedBy = "tags",cascade = {CascadeType.PERSIST, CascadeType.MERGE})
    private Set<Post> posts;

    // setters and getters
}

@Entity
@Table(name = "posts")
public class Post {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private int id;

    @ManyToMany
    @Cascade({org.hibernate.annotations.CascadeType.SAVE_UPDATE})
    @JoinTable(name = "post_tags", joinColumns = { @JoinColumn(name = "post_id") }, inverseJoinColumns = { @JoinColumn(name = "tag_id") })
    private Set<Tag> tags;

    // setters and getters
} 
```

当我查看生成错误的语句时，似乎 Hibernate 正在尝试使用 来制作复合键`PRIMARY KEY (post_id, tag_id)`，并且它也尝试使用`post_id` `identity`.

谁能帮我解决我的问题？

更新：

因为我正在处理一个遗留数据库，所以这只是一个演示问题的示例。但是我会尽量按照例子翻译实际的语句（PS：不是`ALTER TABLE`它是a `CREATE TABLE`）：

```
create table post_tags (id integer not null, post integer, tag integer, post_id integer generated by default as identity (start with 1), tag_id integer not null, primary key (post_id, tag_id) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T14:58:07.150

问题是类中的 @Id `PostTag`：它告诉 hibernate 你想要一个生成的标识列。同时，您说“我想要一个复合键”与`tags`class 中的字段映射`Posts`。

你想要哪一个？Hibernate 无法判断。

在“Java Persistence with Hibernate”一书的第 304 页上有一个很好的例子。[它在 Google 图书上](http://www.google.com/url?sa=t&source=web&ct=res&cd=2&url=http%3A%2F%2Fbooks.google.ch%2Fbooks%3Fid%3DbTwfHzMxtQcC%26pg%3DPA304%26lpg%3DPA304%26dq%3Dhibernate%2B%2522link%2Btable%2Bwith%2Badditional%2Bcolumns%2522%26source%3Dbl%26ots%3DDqfXPhWKJE%26sig%3DVIk4tGPOwDmKkNnMNs2V6ry5v9M%26hl%3Dde%26ei%3D9FUdStPTBaasjAek3Jm6DQ%26sa%3DX%26oi%3Dbook_result%26ct%3Dresult%26resnum%3D2&ei=9FUdStPTBaasjAek3Jm6DQ&usg=AFQjCNHDdokxpdzlvwHZCJxwp1TAOVmKfQ&sig2=pBGr_cPfU4KNB9ehBbR2eg)。

如果您不想要复合键，那么您必须将链接表视为真实对象并`PostTag`在类中使用`Posts`（即`Set<PostTag> postTags`代替`Set<Tag> tags`）

# java - 在包含远程数据库的 Oracle 上测试 SQL 查询

> ID：916216
> 
> 赞同：0
> 
> 时间：2009-05-27T14:54:23.227
> 
> 标签：java, sql, oracle, unit-testing, mocking

我们的开发数据库 (Oracle 9i) 使用远程数据库链接到远程共享数据库。

这个决定是几年前做出的，当时将一些数据库模式放在开发机器上是不切实际的——它们太大了。

我们在开发机器上有某些模式，我们通过使用 Oracle 的数据库链接以及开发机器上的一些同义词使远程模式看起来是本地的。

我遇到的问题是我想测试一段 SQL，它将数据库链接两侧的模式中的表连接起来。

例如（简化案例）：

```
 select a.col, b.col
   from a, b
   where a.b_id = b.id 
```

*   a 在本地数据库上
*   b 在删除数据库上
*   我在语言环境数据库上有一个同义词，因此“b”实际上指向 b@remotedb。

由于链接，在开发环境中运行查询需要很长时间。查询在生产中运行良好（我认为基于 Oracle 成本的优化器不能很好地处理数据库链接）。

过去我们并不擅长为这些类型的查询编写单元测试——可能是由于性能不佳——所以我想开始为它们创建一些测试。

有没有人为这样的查询编写单元测试的策略，以避免使用数据库链接的性能问题？

我通常会寻找尝试模拟远程服务的方法，但由于所有这些都在 SQL 查询中，我无论如何都看不到轻松模拟删除数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T17:09:55.387

您应该从开发中的生产中创建您需要的所有模式的精确副本，但没有所有数据。您应该使用足够的数据填充架构，以便进行适当的测试。您还可以通过从生产服务器导出统计数据并将它们导入到您正在复制的模式的开发数据库中来操纵优化器，使其在测试系统上的行为类似于生产。这样，查询将使用您创建的数据集运行，但查询将使用与生产类似的计划进行优化。然后，您可以从理论上估计它将如何在生产中扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T15:07:37.863

将相关数据复制到您的开发数据库中并在本地创建表。

理想情况下，只需构建一个测试用例，它会告诉您：

1.  SQL 是正确的（它解析）
2.  它使用几行测试数据正确运行

不要相信“让我们复制所有内容”，因为这意味着您将不知道您正在测试什么（以及您缺少什么）。

如果有疑问，请创建一个`b`只有一条记录的表。如果您在此区域遇到错误，请在了解可能失败的位置时添加更多行。

如果您想将其发挥到极致，请在单元测试中创建测试表（包含所有数据）。这样，您可以记录您正在使用的测试数据。

[编辑] 你需要的是一个测试数据库。不要针对可以更改的数据库运行测试。理想情况下，测试应该拆除整个数据库并从头开始重新创建它（表、索引、数据、所有内容）作为第一步。

在这个测试数据库中，只保留定义明确的测试数据，这些数据只会通过定义新测试（而不是由某人“只是做某事”）而改变。如果可以，请尝试针对内存数据库运行测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:08:17.333

我会建议物化视图。这些是在本地存储远程数据的视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:28:23.433

理论上，要进行单元测试，您可以使用根据您的测试用例创建和设计的任何受控数据集。它不必是您的实时或开发系统。这是假设您的设备足够便携。当您进行集成测试时，您将使用您当前的数据库/应用程序对其进行测试，无论如何这也可能在实时系统上（因此不需要数据库链接 - 我知道您的实时数据库在一个地方）。

我想说的是，您可以/应该在一组模拟不同“用例”的受控数据上测试您的单元（即您的组件、查询或您定义为一个单元的任何内容），并且一旦完成您的测试到满意的结果，然后您可以继续进行集成+运行集成测试。

集成测试——你可以在实时环境中运行它，但只有在你通过单元测试证明你的组件是“防弹”之后（如果这对你公司的方法/理念来说没问题：）——系统管理员的反应：“你疯了吗？！”）

如果你想回到过去并测试已经实现的单元，那何必呢？如果它们已经在生产中使用了一段时间而没有发生任何事件，那么我会争辩说它们没问题。但是，您的单元/查询总是有可能在侧面产生一些“缓慢滴答的定时炸弹”效应（随着时间的推移累积效应）。好吧，分析影响就是答案。

# vb.net - 在 For Each 循环中获取 XML 元素的位置

> ID：916219
> 
> 赞同：0
> 
> 时间：2009-05-27T14:54:52.790
> 
> 标签：vb.net, foreach, selectnodes

如何在此循环中获取 XML 元素的位置？

```
For Each objNode In objDoc.SelectNodes("//books/book")

 ???

Next 
```

我想要的输出是这样的

1 2 3 4 ....

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T15:01:21.683

你可能想要这样的东西：

```
objBooks = objDoc.SelectSingleNode("//books")

Dim pos As Integer = 1
For Each book As XmlNode In objBooks.ChildNodes

   Console.Write(pos & " ")

   pos = pos + 1
Next 
```

# c# - 十进制值检查是否为零

> ID：916224
> 
> 赞同：4
> 
> 时间：2009-05-27T14:55:50.807
> 
> 标签：c#, math, puzzle

我正在尝试编写一个接受 2 个参数的除法方法。

```
public static decimal Divide(decimal divisor, decimal dividend)
{
    return dividend / divisor;
} 
```

现在，如果除数为 0，我们得到不能除以零的错误，这没关系。

我想做的是检查除数是否为0，如果是，将其转换为1。有没有办法在我的方法中没有很多if语句的情况下做到这一点？我认为很多 if() 会造成混乱。我知道数学上不应该这样做，但我有其他功能。

例如：

```
if(divisor == 0)
{
    divisor = 1;
}
return dividend / divisor; 
```

可以不做`if()`声明吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T14:57:23.220

您可以像这样执行条件 if 语句。这与 VB.net 中的 IIF 相同

```
return dividend / ((divisor == 0) ? 1 : divisor); 
```

确保你用 () 包裹你的后半部分，否则你会得到一个除法错误。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-27T14:59:25.760

通过使用`?:`运算符

```
return (divisor == 0) ? dividend : dividend / divisor 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:57:05.890

这与 if 语句几乎相同，但更简洁。

```
return dividend / divisor == 0 ? 1 : divisor; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:02:03.290

如果您真的想要，您可以创建自己的类型并重载 / 运算符以获得所需的行为。实现隐式转换运算符以避免强制转换或类型转换。

但是，我认为这不是一个好主意，因为它会增加一些运行时开销；唯一的好处是你得到一些（可以说）看起来更干净的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-29T10:12:45.837

你可以比较`decimal.Zero`喜欢`somDecimalVar == decimal.Zero`

# flash - Java、C++ 和 ActionScript3.0 在 OOP 方面有什么区别？

> ID：916227
> 
> 赞同：0
> 
> 时间：2009-05-27T14:56:16.313
> 
> 标签：flash, oop, actionscript, scripting

在纯编程上下文（例如结构和 OOP）中，您发现（或必须注意不要混淆）Java/C++ 和 ActionScript 之间的主要区别是什么？也欢迎任何其他显着或重要的差异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T15:06:26.963

就功能而言，ActionScript 3.0 绝对比 C++ 更接近 Java：它支持接口、单一继承和元数据。但是，它在语法上与两者不同。对我来说，从 C/C++/Java 风格转向 ActionScript 最大的不同是变量的定义。在 C 中，要声明一个 int，您将执行以下操作：

```
int x = 0; 
```

而在 ActionScript 3 中，它会这样完成：

```
var x : int = 0; 
```

var 是必需的，类型在冒号后指定。

功能也需要类似的改变。在 C 中：

```
void foo(int x) { //yeah } 
```

在 ActionScript 3 中：

```
function foo(x: int) : void { //yeah } 
```

ActionScript 3 还通过使用括号运算符 [] 来支持元数据。您可能会使用的最常见的元数据是 Bindable，它允许 Bindable 声明之后的变量绑定到一个组件，该组件会在变量更改时自动更新。

```
[Bindable]
var x : int = 0; 
```

这些可能是我能想到的 C 风格和 AS 风格之间最令人震惊的区别。如果您使用的是 Flex，MXML 也将提供一套全新的语法和学习能力。

编辑：只记得几件事：ActionScript 3 中没有构造函数重载。您被默认构造函数卡住了。如果要添加可选参数，则必须这样做：

```
class Foo
{
  public function Foo( x : number, y : int = 3, z : string = "default") : void 
  { //stuff here }
} 
```

在上面的示例中，x 是必需的，但 y 和 z 都是可选的，将分别默认为 3 和“default”。

至于您关于对象类的问题，[这里](http://flexblog.faratasystems.com/?p=153)有一篇很好的文章，详细介绍了 Java 和 AS3 之间的区别。

[这](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/Class.html)将解释什么是类对象 - 基本上每个类声明都是 Class 类的一个实例。这有点令人困惑，但是当您真正了解它时，它不会真正改变您的编程方式或 AS3 执行 OO 的方式。AS3 OO 非常接近 Java OO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T10:53:31.857

你真的应该看看这些帖子。它详细讨论了如何从 Java 到 Actionscript。

[http://www.javaworld.com/javaworld/jw-02-2009/jw-02-actionscript1.html?page=1](http://www.javaworld.com/javaworld/jw-02-2009/jw-02-actionscript1.html?page=1)

[http://www.javaworld.com/javaworld/jw-03-2009/jw-03-actionscript2.html?page=1](http://www.javaworld.com/javaworld/jw-03-2009/jw-03-actionscript2.html?page=1)

它没有提到 C++，但绝对值得一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:05:13.220

无类型数组。Actionscript（ECMAScript/Javascript 的方言，所以如果你知道它会更容易），有一个 Array 类。它是无类型的，只是习惯的东西。

任何动态对象都可以是哈希表。这有时真的很好。

语法很容易上手，因为它们非常相似。存在一些范围差异，变量和函数的声明方式不同。

ECMAScript 比 Java/C++ 更具动态性，您可能会发现这非常有用。

如果您正在使用 Flex，请尝试充分利用 MXML，它会使某些事情变得更容易。

我会在想到事情时尝试添加。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T16:26:32.403

ActionScript 3 中的类实际上是类“对象”，也就是说它们是派生自 Object 的 Class 类的实例。看这里：

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/Class.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/Class.html)

和这里：

[http://www.adobe.com/devnet/actionscript/articles/actionscript3_overview.html](http://www.adobe.com/devnet/actionscript/articles/actionscript3_overview.html)

还有一些非常有趣的细节：

[http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000069.html](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000069.html)

CookieOfFortune 是正确的，因为从 Object 派生的类的实际影响（就您的日常编码而言）是最小的——您创建类的实例几乎与在 Java 中相同：

```
// Java
MyClass myClass = new MyClass();

// AS3
var myClass:MyClass = new MyClass();

// Or if you prefer a more loosely typed approach
var myClass = new MyClass(); 
```

但在幕后，ActionScript 基于 ECMAScript 3 标准，因此它实际上更像是 JavaScript 的超集——它是松散类型的（尽管可以严格编译），它是面向原型的（即使这是从开发人员那里抽象出来的： “类本身声明原型”），它支持函数式和面向对象的范式（耶，闭包！）等等。它在很多方面*都*像 Java，但实际上更像是 JavaScript。因此，如果 C++ 位于右侧，Java 位于中间，JavaScript 位于左侧，则三者之间的概念相似性可能如下所示：

```
-----------------------------------------------------------------------------
 ^       ^                       ^                                         ^
 JS     AS3                     Java                                      C++ 
```

... 不一定，那是一个非常有用的模型。;)

不过，HoorayImHelping 是对的——肯定有一些烦恼。不仅没有构造函数重载，也没有任何类型的方法重载。事件都是字符串标识的，如果您不小心，可能会产生各种问题。没有 ActionScript 枚举之类的东西。它没有抽象类的概念。名单还在继续。

但在这些部门的不足之处，它在灵活性方面表现出色。所以你有它。几乎不像 C++，有点像 Java，但更像是 JavaScript 的超集。希望有帮助！

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-27T15:07:03.747

类和类层次结构在 AS3 中是“伪造的”。AS3 更接近于 Javascript（实际上没有类的概念）并且适用于基于原型的对象。

# sql - 如何插入具有关系的表中？

> ID：916228
> 
> 赞同：2
> 
> 时间：2009-05-27T14:56:30.883
> 
> 标签：sql, foreign-keys, primary-key, entity-relationship

我只做过没有关系的数据库，但现在我需要做一些更严肃和正确的事情。

这是我的数据库设计： [![替代文字](https://i.stack.imgur.com/ag55o.jpg)](https://i.stack.imgur.com/ag55o.jpg)

1.  昆德=客户
2.  变量 = 产品
3.  Ordre = Order（*阅读*：我要下订单）
4.  VareGruppe = ehm..type？（阅读：汽车、椅子、壁橱等）
5.  VareOrdre = Product_Orders

这是我的 SQL (SQLite) 架构：

```
CREATE TABLE Post (
    Postnr INTEGER NOT NULL PRIMARY KEY,
    Bynavn VARCHAR(50) NOT NULL
);

CREATE TABLE Kunde (
    CPR INTEGER NOT NULL PRIMARY KEY,
    Navn VARCHAR(50) NOT NULL,
    Tlf INTEGER NOT NULL,
    Adresse VARCHAR(50) NOT NULL,
    Postnr INTEGER NOT NULL 
    CONSTRAINT fk_postnr_post REFERENCES Post(Postnr)
);

CREATE TABLE Varegruppe (
    VGnr INTEGER PRIMARY KEY,
    Typenavn VARCHAR(50) NOT NULL
);

CREATE TABLE Vare (
    Vnr INTEGER PRIMARY KEY,
    Navn VARCHAR(50) NOT NULL,
    Pris DEC NOT NULL,
    Beholdning INTEGER NOT NULL,
    VGnr INTEGER NOT NULL
        CONSTRAINT fk_varegruppevgnr_vgnr REFERENCES Varegruppe(VGnr)
);

CREATE TABLE Ordre (
    Onr INTEGER PRIMARY KEY,
    CPR INTEGER NOT NULL
        CONSTRAINT fk_kundecpr_cpr REFERENCES Kunde(CPR),
    Dato DATETIME NOT NULL,
    SamletPris DEC NOT NULL
);

CREATE TABLE VareOrdre (
    VareOrdreID INTEGER PRIMARY KEY,
    Onr INTEGER NOT NULL
        CONSTRAINT fk_ordrenr_onr REFERENCES Ordre(Onr),
    Vnr INTEGER NOT NULL 
        CONSTRAINT fk_varevnr_vnr REFERENCES Vare(Vnr),
    Antal INTEGER NOT NULL
); 
```

它应该可以正常工作。

但我对此感到困惑`Product_Orders`。

如何创建订单？例如，2 个产品使用`SQL INSERT INTO`? 我什么也做不了。

至今：

仅当我手动将产品和数据插入`Product_Orders`然后添加该数据以`Orders =`使其完成时。或者反过来（使用 1 个 SQL 创建一个订单，然后`Product_orders - 1`为每个条目手动将产品插入 SQL）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T15:01:50.013

您应该首先创建一个订单，然后在表 Product_Orders 中插入产品。这是必要的，因为您需要一个带有 id 的实际订单来将其与表 Product_Orders 相关联。

在能够在当前表中创建一条记录之前，您始终应该在外键表中创建一条记录。这样，您应该创建一个“帖子”、客户、类型、产品、订单和 product_order。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T15:11:17.780

试试这个 ...

首先你必须插入一个客户

```
insert into kunde values(1, 'navn', 1, 'adresse', 1) 
```

然后你插入一个类型

```
insert into VareGruppe values(1, 'Type1') 
```

然后你插入一个产品

```
insert into vare values(1, 'product1', '10.0', 1, 1) 
```

然后你添加一个订单

```
insert into ordre values(1, 1, '20090101', '10.0') 
```

然后你在 product_orders 表中插入一个寄存器

```
insert into VareOrdre values (1, 1, 1, 1) 
```

我觉得这就是。:-)

由于主键是自动递增的，因此不要将它们添加到插入中并像这样指定列

```
insert into vare(Nav, Pris, Beholdning, VGnr) values('product1', '10.0', 1, 1) 
```

用于`Select @@identity`查看onr值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T15:01:04.600

我认为你已经掌握了需要发生的事情。但是我认为您要了解的是如何确保数据完整性。

这就是交易变得重要的地方。

[http://www.sqlteam.com/article/introduction-to-transactions](http://www.sqlteam.com/article/introduction-to-transactions)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:08:33.290

是导致问题的销售价格（我猜这就是 SamletPris 的意思）吗？我可以看到这是一个问题。一种常见的设计解决方案是有 2 个表：Order 和 OrderLine。Order 是一个标题表——它将与 Customer 表以及任何其他“顶级”数据具有外键关系。OrderLine 表与 Order 表和 Product 表具有 FK 关系，以及数量、单价等对于订单行项目是唯一的。现在，要获取订单的销售价格，您需要对该订单的 OrderLine 表的（单价 * 数量）求和。存储整个订单的 SalesPrice 可能会导致大问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T15:11:47.623

注意以防万一这是 MySQL：如果您使用的是 MyISAM，MySQL 服务器会完全忽略外键。如果您希望在数据库端实际执行任何类型的完整性，而不仅仅是在您的逻辑中，则必须将引擎设置为 InnoDB。这不是您的问题，但需要注意。

fbinder 得到了正确的问题:)

# java - 我可以在不“做高级事情”的情况下使这个搜索相关性功能更好吗？

> ID：916247
> 
> 赞同：2
> 
> 时间：2009-05-27T15:00:25.290
> 
> 标签：java, search-engine

我的搜索引擎使用以下函数来计算相关性。

```
private static int calculateScore(String result, String searchStr, int modifier) 
{
    String[] resultWords = result.split(" ");
    String[] searchWords = searchStr.split(" ");

    int score = 0;
    for (String searchWord : searchWords) 
    {
        for (String resultWord : resultWords) 
        {
            if (resultWord.equals(searchWord))
                score += 10;
            else if (resultWord.startsWith(searchWord))
                score += 4;
            else if (resultWord.endsWith(searchWord))
                score += 3;
            else if (resultWord.contains(searchWord))
                score += 1;
        }

    }
    return score;
} 
```

没什么花哨的，而且我也没有足够的时间去做任何花哨的事情，但是我可以做任何简单的改进来使该功能更好地增加相关内容并降低不相关的内容吗？速度优化无需赘述，这只是功能的“功能部分”:)

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T15:03:47.280

不确定它是否算得上花哨，但是[soundex 比较](http://www.cs.princeton.edu/introcs/31datatype/Soundex.java.html)，大概在你的量表上获得 +1 分，将与印刷的未遂事件和同音字有一点相关性。

我建议使用[停用词列表](http://www.dcs.gla.ac.uk/idom/ir_resources/linguistic_utils/stop_words)来防止或从根本上减少从常用词授予的相关性。如果有人在搜索“the horse is on the roof”，您希望授予与“horse”和“roof”的相关性，而不是大量提高包含“the”的所有内容。

另一个简单的提升是为包含整个搜索字符串的结果赋予一大堆相关性（不区分大小写和标点符号）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T15:05:48.400

经典的向量空间模型实际上是标准的不错且相当简单（在实现中）的解决方案。

[http://www.miislita.com/term-vector/term-vector-3.html](http://www.miislita.com/term-vector/term-vector-3.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T15:05:53.547

在你做你的平等之前，你也应该规范化大小写。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T15:07:42.653

[如果Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)低于某个阈值，您可以将 +1 添加到分数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T15:08:26.037

如果您想让您的搜索算法更复杂一点，请查看[cosinesimilarity](http://en.wikipedia.org/wiki/Cosine_similarity)。它很容易实现并且在实践中效果很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T15:09:39.903

你可以：

*   剔除干扰词（the、a、at 等...）
*   更改可搜索文本相关性的权重 - 如果搜索词出现在文档的标题及其正文中，则标题可能更相关。
*   根据您的 resultWord 文本，考虑为文本中较早或较晚的单词添加权重。
*   使唯一的搜索词匹配更有价值（您必须确定是什么让一个词独一无二）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T15:06:06.307

很明显，但是您希望将所有内容都小写。

# xml - 如何从命令行运行 Delphi XML 模式绑定生成器？

> ID：916252
> 
> 赞同：0
> 
> 时间：2009-05-27T15:00:46.037
> 
> 标签：xml, delphi, command-line, binding, xsd

对于构建自动化，我想从构建脚本中调用 Delphi 中的 XML 数据绑定向导。我找到了 WSDLmp.exe，但这个工具似乎只生成基于 WSDL 的 Delphi 代码。

XML 模式绑定向导（为 XSD 文件生成 Delphi 代码）是否可用作命令行工具？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T19:29:12.143

因为它是一个向导，所以根据定义，它是一种 UI，而不是命令行。
也许你的意思是作为一个单独的 exe，你可以在没有 Delphi 的情况下启动？
AFAIK，这是不可能的。
仅供参考，它是 dclnet 设计时间包的一部分。向导对话框的类是 TXMLNewBindingDlg。

# asp.net - 为什么回发不能在我的域根上工作？

> ID：916258
> 
> 赞同：1
> 
> 时间：2009-05-27T15:01:39.297
> 
> 标签：asp.net, master-pages, postback

我在母版页上有一个非常简单的表单，但是当站点位于根目录时将无法使用。

工作正常：

> www.mysite.com/page.aspx
> 
> www.mysite.com/another/page.aspx

不工作：

> www.mysite.com

我单击按钮并将其回发到

> www.mysite.com/default.aspx

但是没有执行任何操作，现在如果我在 /default.aspx 上再次尝试该表单，它将回发并正常执行。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T15:11:32.490

在我看来，默认页面重定向要么是意外（或有意）丢失了所有表单数据。我首先建议不要重定向到不存在的页面。

但是，如果您坚持，我会尝试[URL rewriting 之](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)类的方法。希望一个模块的重写将保持表单数据完整，但我不能肯定它会。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:17:55.363

感谢您的回复，我刚刚想通了！

我正在使用 isapi 来确保我的 url 都是小写的，并且 301 将任何大写的 URL 重定向到它们等效的小写版本。

在回发时，它的动作是 Default.aspx ...我的脚本将其重定向到 default.aspx 并在回发之前丢失了值.. DOH！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:17:16.580

您的站点根目录下是否有 Index.aspx？

# c++ - Win32：将窗口置于顶部

> ID：916259
> 
> 赞同：34
> 
> 时间：2009-05-27T15:01:44.913
> 
> 标签：c++, winapi, visual-c++

我有一个 Windows 程序，其中有两个 2 个窗口：

```
hwnd (main interface)

hwnd2 (toplevel window, no parent, created by hwnd) 
```

当我双击 hwnd 时，我需要 hwnd2 弹出并显示一些数据，所以我使用这个函数将 hwnd2 带到顶部：

```
BringWindowToTop(hwnd2); 
```

hwnd2 被带到顶部，但有一件奇怪的事情。当我再次点击 hwnd2 时，hwnd（主界面）会自动再次弹出。我尝试使用以下函数来解决这个问题，但它们都不起作用。

```
SetWindowPos(hwnd, HWND_BOTTOM, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE);
                                                                  //doesn't work

BringWindowToTop(hwnd2);    //This is the function brings hwnd2 to top

SetForegroundWindow(hwnd2); //doesn't work

SetWindowPos(hwnd2, HWND_TOP, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE); 
                                                                  //doesn't work

SetWindowPos(hwnd2, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE);
                                       // hwnd2 "always" on top, not what I want

SetActiveWindow(hwnd2); // doesn't work too (for replying to Magnus Skog, thanks)

SwitchToThisWindow(hwnd2, TRUE);// got the same problem with BringWindowToTop function
SwitchToThisWindow(hwnd2, FALSE); 
```

我该如何解决这个问题？提前致谢。

（为了回复 aJ，hwnd2 没有父窗口，因为它需要是一个顶层窗口，所以它可以在其他窗口的前面/后面）

（hwnd2是一个媒体播放器，由几个窗口组成，其中一个窗口用于视频显示，另外两个用于进度条和音量条的轨迹栏控件，一个用于控制面板的工具栏控件。）

（有一个可能会有所帮助，无论我在hwnd2上点击哪个窗口，hwnd都会自动弹出，就像“鼠标在Z-order中的hwnd之上”一样，包括菜单栏和非客户区等）

（这个媒体播放器是用 Direct Show 写的。我使用 IVideoWindow::put_Owner 将视频窗口作为视频所有者，Direct Show 在内部创建一个子视频窗口作为视频窗口的子窗口。除了这个子视频窗口我看不到源代码，我在 hwnd2 中没有看到任何可疑的东西。）

我找到了原因，这是因为 Direct Show。我使用多线程执行它，然后问题就解决了。但为什么？？

这个问题可以通过使用 PostMessage（而不是 SendMessage）来解决。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2015-12-22T11:25:57.453

试试这个，据说来自M$

```
 HWND hCurWnd = ::GetForegroundWindow();
    DWORD dwMyID = ::GetCurrentThreadId();
    DWORD dwCurID = ::GetWindowThreadProcessId(hCurWnd, NULL);
    ::AttachThreadInput(dwCurID, dwMyID, TRUE);
    ::SetWindowPos(m_hWnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE);
    ::SetWindowPos(m_hWnd, HWND_NOTOPMOST, 0, 0, 0, 0, SWP_SHOWWINDOW | SWP_NOSIZE | SWP_NOMOVE);
    ::SetForegroundWindow(m_hWnd);
    ::SetFocus(m_hWnd);
    ::SetActiveWindow(m_hWnd);
    ::AttachThreadInput(dwCurID, dwMyID, FALSE); 
```

为了把一个窗口带到顶部，你应该得到你的窗口句柄，线程句柄，在前台的窗口线程句柄

然后我们将线程附加到前台窗口线程并通过 AttachThreadInput 获取输入，然后我们将窗口 z 顺序设置为最顶部，然后将其 z 顺序恢复为正常，调用 SetForegroundWindow,SetFocus,SetActiveWindow 以确保我们的窗口被带到顶部并且是活跃且专注

然后从旧的前台窗口线程中分离输入队列，使我们的线程成为唯一捕获输入事件的线程

那么我们为什么要调用 AttachThreadInput，那是因为

> SetFocus 将键盘焦点设置到指定窗口。该窗口必须附加到调用线程的消息队列。

AttachThreadInput 有什么作用？

> AttachThreadInput 函数可用于允许一组线程共享相同的输入状态。通过共享输入状态，线程共享其活动窗口的概念。通过这样做，一个线程总是可以激活另一个线程的窗口。该函数对于共享输入状态的不同线程创建的窗口之间的焦点状态、鼠标捕获状态、键盘状态和窗口 Z 顺序状态也很有用。

我们使用 SetWindowPos 将窗口带到最顶层，如果窗口被隐藏，我们使用 SWP_HIDEWINDOW 显示窗口

> SetWindowPos 函数更改子窗口、弹出窗口或顶级窗口的大小、位置和 Z 顺序。这些窗口根据它们在屏幕上的外观进行排序。最顶层的窗口获得最高排名，并且是 Z 顺序中的第一个窗口

如果你的问题是你的窗口也被最小化了，你应该在最后添加一行代码

```
ShowWindow(m_hWnd, SW_RESTORE); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-21T12:22:22.260

两者都很好用：

```
::SetForegroundWindow(wnd) 
```

或者

```
::SetWindowPos(m_hWnd,       // handle to window
            HWND_TOPMOST,  // placement-order handle
            0,     // horizontal position
            0,      // vertical position
            0,  // width
            0, // height
            SWP_SHOWWINDOW|SWP_NOSIZE|SWP_NOMOVE// window-positioning options
            ); 
```

但请记住，最后一个将窗口始终设置在顶部。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-12-05T02:37:21.997

经过多次尝试和错误。我找到了以下解决此问题的方法：

```
SendMessage(hwnd, WM_SYSCOMMAND, SC_RESTORE, 0); // restore the minimize window
SetForegroundWindow(hwnd); 
SetActiveWindow(hwnd); 
SetWindowPos(hwnd, HWND_TOP, 0, 0, 0, 0, SWP_SHOWWINDOW | SWP_NOMOVE  | SWP_NOSIZE);
//redraw to prevent the window blank.
RedrawWindow(hwnd, NULL, 0, RDW_FRAME | RDW_INVALIDATE | RDW_ALLCHILDREN ); 
```

hwnd 是您的窗口 HWND 。请不要只是复制和粘贴。您还需要`GetLastError`在每次 api 调用后检查 api 错误。

我在win7上确认了以下结果：

*   可以恢复最小化窗口并且没有错误返回。
*   如果窗口已经置顶，窗口标题会闪烁并且不返回错误。
*   如果窗口已经关闭，它将返回错误“0x578 无效的窗口句柄”。
*   它可以将所有非最顶层窗口的窗口置于最顶层并且不返回错误。（例如它将在最顶层的任务管理器后面）
*   它不会使窗口位于最顶部。用户可以在其上制作其他窗口。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-27T16:15:32.877

[SwitchToThisWindow](http://msdn.microsoft.com/en-us/library/ms633553.aspx)最适合我。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-27T15:08:42.760

你试过**SetActiveWindow()**吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-12T14:22:29.300

如果最小化，这将恢复应用程序并将其置于最前面：

```
ShowWindow(hWnd, SW_SHOW);
SetForegroundWindow(hWnd); 
```

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2015-06-25T13:25:19.290

//工作得很好！

```
Var
 WndHandle:HWND;

begin
 WndHandle :=FindWindowEx(0,0,nil,'Calculator');
 PostMessage(WndHandle,WM_SHOWWINDOW,SW_RESTORE,0);
 SetForegroundWindow(WndHandle);
end; 
```

# subsonic - SubSonic Inner join 选择问题

> ID：916269
> 
> 赞同：0
> 
> 时间：2009-05-27T15:02:48.670
> 
> 标签：subsonic

我有 3 个表，需要选择一些记录，在其中 2 个表中我有相同名称的文件，当我尝试在这些文件上使用 Where Expression 时，我收到错误消息：如果我使用 TABLENAME.Columns.COLNAME 这个错误消息显示：不明确的列名“FKLoginID”。如果我使用 TableNAme.COLColumn.QualifiedName ，它在创建的参数“@[dbo].[Tbl_PersonalInformation].[FKLoginID]0”附近有错误

如何查询这些表？谢谢

```
 SqlQuery q = new Select().From(Tables.TblStockbrokerBroadDirector)
               .InnerJoin(TblPersonalInformation.PersonalInfoIDColumn, TblStockbrokerBroadDirector.FKPersonalInfoIDColumn)
               .InnerJoin(TblCompanyInformation.BizInfoIDColumn, TblStockbrokerBroadDirector.FKBizInfoIDColumn)
               .Where(TblPersonalInformation.FKLoginIDColumn.QualifiedName).IsEqualTo(User.Identity.Name);

CREATE TABLE [dbo].[Tbl_CompanyInformation](
    [Code] [bigint] IDENTITY(111111111,1) NOT NULL,
    [BizInfoID] [nvarchar](20)  NOT NULL,
    [BizName] [nvarchar](50)  NOT NULL,
    [RegisterationNO] [nvarchar](50)  NOT NULL,
    [RegisterationPlace] [bigint] NOT NULL,
    [TypeBiz] [nvarchar](50)  NOT NULL,
    [DirectManagerCode] [nvarchar](20)  NOT NULL,
    [FKAddressID] [nvarchar](20)  NOT NULL,
    [FKLoginID] [nvarchar](20)  NOT NULL,
    [SabtDate] [nvarchar](50)  NOT NULL,
    [NewName] [nvarchar](50)  NULL,
    [OldName] [nvarchar](50)  NULL,
    [DateTasisAgahi] [nvarchar](50)  NOT NULL,
    [NOTasisAgahi] [nvarchar](20)  NOT NULL,
    [NOAsasname] [nvarchar](20)  NOT NULL,
    [FKStatus] [smallint] NOT NULL CONSTRAINT [DF_Tbl_CompanyInformation_FKStatus]  DEFAULT ((0)),
 CONSTRAINT [PK_Tbl_CompanyInformation_1] PRIMARY KEY CLUSTERED 
(
    [Code] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [IX_Tbl_Biz] UNIQUE NONCLUSTERED 
(
    [BizInfoID] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [IX_Tbl_CompanyRegNoP] UNIQUE NONCLUSTERED 
(
    [RegisterationNO] ASC,
    [RegisterationPlace] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]

CREATE TABLE [dbo].[Tbl_PersonalInformation](
    [Code] [bigint] IDENTITY(111111111,1) NOT NULL,
    [PersonalInfoID] [nvarchar](20)  NOT NULL,
    [FKLoginID] [nvarchar](20)  NULL,
    [FirstName] [nvarchar](50)  NOT NULL,
    [LastName] [nvarchar](150)  NOT NULL,
    [SSN] [nvarchar](10)  NOT NULL,
    [NationalCode] [nvarchar](10)  NOT NULL,
    [CopyNCard] [image] NULL,
    [Birthyear] [nvarchar](50)  NOT NULL,
    [Birthplace] [bigint] NOT NULL,
    [FKProvince] [smallint] NOT NULL,
    [FKAddressID] [nvarchar](20)  NOT NULL,
    [Phone] [nvarchar](50)  NULL,
    [Sex] [bit] NOT NULL CONSTRAINT [DF_Tbl_PersonalInformation_Sex]  DEFAULT ((0)),
    [FKStatus] [smallint] NULL CONSTRAINT [DF_Tbl_PersonalInformation_FKStatus]  DEFAULT ((0)),
 CONSTRAINT [PK_Tbl_PersonalInformation_1] PRIMARY KEY CLUSTERED 
(
    [Code] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [IX_Tbl_PersonalInformation] UNIQUE NONCLUSTERED 
(
    [PersonalInfoID] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

CREATE TABLE [dbo].[Tbl_Stockbroker_BroadDirector](
    [Code] [bigint] IDENTITY(111111111,1) NOT NULL,
    [StockbrokerCode] [nvarchar](20)  NOT NULL,
    [FKBizInfoID] [nvarchar](20)  NOT NULL,
    [FKPersonalInfoID] [nvarchar](20)  NULL,
    [IsStockbroker] [bit] NOT NULL CONSTRAINT [DF_Tbl_Stockbroker_BroadDirector_IsStockbroker]  DEFAULT ((0)),
    [IsBoardDirector] [bit] NOT NULL CONSTRAINT [DF_Tbl_Stockbroker_BroadDirector_IsBoardDirector]  DEFAULT ((0)),
    [FKStatus] [smallint] NULL CONSTRAINT [DF_Tbl_Stockbroker_BroadDirector_status]  DEFAULT ((0)),
    [StockPercent] [float] NULL CONSTRAINT [DF_Tbl_Stockbroker_BroadDirector_StockPercent]  DEFAULT ((0)),
    [SahamdarHoghoghi] [bit] NULL,
    [FkBizinfoIDSahamdar] [nvarchar](20)  NULL,
 CONSTRAINT [PK_Tbl_Stockbroker_BroadDirector] PRIMARY KEY CLUSTERED 
(
    [Code] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [IX_Tbl_Stockbroker_Code] UNIQUE NONCLUSTERED 
(
    [StockbrokerCode] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T15:52:51.113

以下应该有效：

```
SqlQuery query = DB.Select().From(Tables.TblStockbrokerBroadDirector)  
  .InnerJoin(TblPersonalInformation)  
  .InnerJoin(TblCompanyInformation)  
  .Where(TblPersonalInformation.Columns.FKLoginIDColumn).IsEqualTo(User.Identity.Name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T01:52:15.833

改变

```
.Where(TblPersonalInformation.FKLoginIDColumn.QualifiedName).IsEqualTo(User.Identity.Name); 
```

到

```
.Where(TblPersonalInformation.FKLoginIDColumn).IsEqualTo(User.Identity.Name); 
```

当您调用 .QualifiedName 时，您无意中调用了 Where(string columnName) 而不是 Where(TableColumn column)。

您可以通过检查 q.BuildSqlStatement() 的值来验证这一点。这对于调试非常有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T11:41:08.780

感谢您的回答，但是通过您的代码，我收到了此错误消息

```
Object reference not set to an instance of an object. 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

Source Error: 

Line 33:                .InnerJoin(TblCompanyInformation.BizInfoIDColumn, TblStockbrokerBroadDirector.FKBizInfoIDColumn)
Line 34:                .Where(TblPersonalInformation.FKLoginIDColumn).IsEqualTo(User.Identity.Name);
Line 35:            Response.Write(q.BuildSqlStatement());
Line 36:             q.ExecuteDataSet();
Line 37:         }

Source File: E:\MehdiBackup\Visual Studio 2008\Projects\EXtjsUI\EXtjsUI\testi\default.aspx.cs    Line: 35 

Stack Trace: 

[NullReferenceException: Object reference not set to an instance of an object.]
   SubSonic.ANSISqlGenerator.BuildConstraintSQL(String& constraintOperator, StringBuilder sb, Boolean isFirst, Boolean& expressionIsOpen, Constraint c) +129
   SubSonic.ANSISqlGenerator.GenerateWhere() +218
   SubSonic.ANSISqlGenerator.BuildSelectStatement() +124
   SubSonic.SqlQuery.BuildSqlStatement() +71
   IMPermit.testi._default.Page_Load(Object sender, EventArgs e) in E:\MehdiBackup\Visual Studio 2008\Projects\EXtjsUI\EXtjsUI\testi\default.aspx.cs:35
   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +15
   System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +33
   System.Web.UI.Control.OnLoad(EventArgs e) +99
   System.Web.UI.Control.LoadRecursive() +47
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1436 
```

# wpf - WPF 将 ComboBox 绑定到枚举（有点扭曲）

> ID：916278
> 
> 赞同：14
> 
> 时间：2009-05-27T15:04:12.940
> 
> 标签：wpf, data-binding, enums, combobox

那么问题是我有这个枚举，但我不希望组合框显示枚举的值。这是枚举：

```
public enum Mode
    {
        [Description("Display active only")]
        Active,
        [Description("Display selected only")]
        Selected,
        [Description("Display active and selected")]
        ActiveAndSelected
    } 
```

因此，在 ComboBox 中，我不想显示 Active、Selected 或 ActiveAndSelected，而是显示枚举的每个值的 DescriptionProperty。我确实有一个名为 GetDescription() 的扩展方法用于枚举：

```
public static string GetDescription(this Enum enumObj)
        {
            FieldInfo fieldInfo =
                enumObj.GetType().GetField(enumObj.ToString());

            object[] attribArray = fieldInfo.GetCustomAttributes(false);

            if (attribArray.Length == 0)
            {
                return enumObj.ToString();
            }
            else
            {
                DescriptionAttribute attrib =
                    attribArray[0] as DescriptionAttribute;
                return attrib.Description;
            }
        } 
```

那么有没有办法可以将枚举绑定到 ComboBox 并使用 GetDescription 扩展方法显示它的内容？

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-27T16:04:10.247

我建议使用 DataTemplate 和 ValueConverter。这将允许您自定义它的显示方式，但您仍然可以读取组合框的 SelectedItem 属性并获取实际的枚举值。

ValueConverters 需要大量样板代码，但这里没有什么太复杂的地方。首先创建 ValueConverter 类：

```
public class ModeConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter,
        CultureInfo culture)
    {
        return ((Mode) value).GetDescription();
    }
    public object ConvertBack(object value, Type targetType, object parameter,
        CultureInfo culture)
    {
        throw new NotSupportedException();
    }
} 
```

由于您只是将枚举值转换为字符串（用于显示），因此您不需要 ConvertBack ——这仅适用于双向绑定场景。

然后将 ValueConverter 的一个实例放入资源中，如下所示：

```
<Window ... xmlns:WpfApplication1="clr-namespace:WpfApplication1">
    <Window.Resources>
        <WpfApplication1:ModeConverter x:Key="modeConverter"/>
    </Window.Resources>
    ....
</Window> 
```

然后你就可以为 ComboBox 提供一个 DisplayTemplate 了，它使用 ModeConverter 来格式化它的项目：

```
<ComboBox Name="comboBox" ...>
    <ComboBox.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Converter={StaticResource modeConverter}}"/>
        </DataTemplate>
    </ComboBox.ItemTemplate>
</ComboBox> 
```

为了测试这一点，我也加入了一个标签，它会显示实际的 SelectedItem 值，它确实表明 SelectedItem 是枚举而不是显示文本，这正是我想要的：

```
<Label Content="{Binding ElementName=comboBox, Path=SelectedItem}"/> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T15:20:38.400

我喜欢你思考的方式。但是`GetCustomAttributes`使用`reflection`. 这对你的表现有什么影响？

查看这篇文章：WPF - 在 ComboBox 控件中显示枚举 [http://www.infosysblogs.com/microsoft/2008/09/wpf_displaying_enums_in_combob.html](http://www.infosysblogs.com/microsoft/2008/09/wpf_displaying_enums_in_combob.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-04-09T22:52:18.497

这就是我使用 MVVM 的方式。在我的模型上，我会定义我的枚举：

```
 public enum VelocityUnitOfMeasure
    {
        [Description("Miles per Hour")]
        MilesPerHour,
        [Description("Kilometers per Hour")]
        KilometersPerHour
    } 
```

在我的 ViewModel 上，我公开了一个属性，该属性以字符串的形式提供可能的选择，以及一个用于获取/设置模型值的属性。如果我们不想使用类型中的每个枚举值，这很有用：

```
 //UI Helper
    public IEnumerable<string> VelocityUnitOfMeasureSelections
    {
        get
        {
            var units = new []
                            {
                               VelocityUnitOfMeasure.MilesPerHour.Description(),
                               VelocityUnitOfMeasure.KilometersPerHour.Description()
                            };
            return units;
        }
    }

    //VM property
    public VelocityUnitOfMeasure UnitOfMeasure
    {
        get { return model.UnitOfMeasure; }
        set { model.UnitOfMeasure = value; }
    } 
```

此外，我使用了一个通用的 EnumDescriptionCoverter：

```
public class EnumDescriptionConverter : IValueConverter
{
    //From Binding Source
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (!(value is Enum)) throw new ArgumentException("Value is not an Enum");
        return (value as Enum).Description();
    }

    //From Binding Target
    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (!(value is string)) throw new ArgumentException("Value is not a string");
        foreach(var item in Enum.GetValues(targetType))
        {
            var asString = (item as Enum).Description();
            if (asString == (string) value)
            {
                return item;
            }
        }
        throw new ArgumentException("Unable to match string to Enum description");
    }
} 
```

最后，在视图中，我可以执行以下操作：

```
<Window.Resources>
    <ValueConverters:EnumDescriptionConverter x:Key="enumDescriptionConverter" />
</Window.Resources>
...
<ComboBox SelectedItem="{Binding UnitOfMeasure, Converter={StaticResource enumDescriptionConverter}}"
          ItemsSource="{Binding VelocityUnitOfMeasureSelections, Mode=OneWay}" /> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T15:23:04.823

除了使用反射和属性的问题，有几种方法可以做到这一点，但我认为最好的方法是创建一个包装枚举值的小视图模型类：

```
public class ModeViewModel : ViewModel
{
    private readonly Mode _mode;

    public ModeViewModel(Mode mode)
    {
        ...
    }

    public Mode Mode
    {
        get { ... }
    }

    public string Description
    {
        get { return _mode.GetDescription(); }
    }
} 
```

或者，您可以考虑使用[`ObjectDataProvider`](http://msdn.microsoft.com/en-us/library/system.windows.data.objectdataprovider.aspx).

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-27T15:33:31.837

我建议您使用我已经在[此处](https://stackoverflow.com/questions/878356/wpf-combobox-binding-to-enum-what-i-did-wrong/880175#880175)发布的标记扩展，只需稍作修改：

```
[MarkupExtensionReturnType(typeof(IEnumerable))]
public class EnumValuesExtension : MarkupExtension
{
    public EnumValuesExtension()
    {
    }

    public EnumValuesExtension(Type enumType)
    {
        this.EnumType = enumType;
    }

    [ConstructorArgument("enumType")]
    public Type EnumType { get; set; }

    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        if (this.EnumType == null)
            throw new ArgumentException("The enum type is not set");
        return Enum.GetValues(this.EnumType).Select(o => GetDescription(o));
    }
} 
```

然后你可以像这样使用它：

```
<ComboBox ItemsSource="{local:EnumValues local:Mode}"/> 
```

编辑：我建议的方法将绑定到字符串列表，这是不可取的，因为我们希望 SelectedItem 的类型为 Mode。最好删除 .Select(...) 部分，并在 ItemTemplate 中使用与自定义转换器的绑定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-17T14:24:48.673

我已经这样做了：

```
<ComboBox x:Name="CurrencyCodeComboBox" Grid.Column="4" DisplayMemberPath="." HorizontalAlignment="Left" Height="22"   Margin="11,6.2,0,10.2" VerticalAlignment="Center" Width="81" Grid.Row="1" SelectedValue="{Binding currencyCode}" >
            <ComboBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel/>
                </ItemsPanelTemplate>
            </ComboBox.ItemsPanel>
        </ComboBox> 
```

在代码中我设置了 itemSource ：

```
CurrencyCodeComboBox.ItemsSource = [Enum].GetValues(GetType(currencyCode)) 
```

# c++ - C++ 的检测（诊断）库

> ID：916282
> 
> 赞同：4
> 
> 时间：2009-05-27T15:05:10.257
> 
> 标签：c++, debugging, profiling, runtime, instrumentation

我正在考虑将代码添加到我的应用程序中，以收集诊断信息以供以后检查。是否为此目的创建了任何 C++ 库？我正在尝试做的类似于分析，但不一样，因为收集的数据将更多地用于调试而不是分析。

编辑：平台： 要收集的
Linux诊断信息：来自应用程序逻辑、各种断言和统计信息的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T15:07:58.597

我倾向于为此目的使用日志记录。 [Log4cxx](http://logging.apache.org/log4cxx/index.html)就像一个魅力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T19:54:38.597

您可能还想查看[libcwd](http://carlowood.github.io/libcwd/)：

> Libcwd 是面向 C++ 开发人员的线程安全、功能齐全的调试支持库。它包括带有自定义调试通道和设备的基于 ostream 的调试输出、强大的内存分配调试支持，以及对打印源文件的运行时支持：行号信息和解构类型名称。

*   [功能列表](http://carlowood.github.io/libcwd/www/features.html)
*   [教程](http://carlowood.github.io/libcwd/tutorial/index.html)
*   [快速参考](http://carlowood.github.io/libcwd/www/quickreference.html)
*   [参考手册](http://carlowood.github.io/libcwd/reference-manual/index.html)

此外，另一个有趣的日志库是[pantheios](http://www.pantheios.org/)：

> Pantheios 是一个开源 C/C++ 日志记录 API 库，提供 100% 类型安全、效率、通用性和可扩展性的最佳组合。它易于使用和扩展，高度可移植（独立于平台和编译器），而且最重要的是，它坚持 C 语言的传统，即您只需为使用的内容付费。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T16:17:47.693

如果调试是你正在做的，也许使用调试器。GDB 脚本很容易编写和使用。将它们与您的代码并行维护可能具有挑战性。

编辑 - 附加 Annecdote：

我维护的软件包括一个自制的仪器系统。宏用于对日志消息进行排队，配置选项控制记录的消息类别和记录的详细级别。一个线程处理日志队列，将消息刷新到文件并在文件变得太大时轮换文件（它们通常会这样做）。该系统提供了很多细节，但通常它会提供大量文件，我们的支持工程师必须花费数小时才能找到任何有用的东西。

现在，我只用过几次 GDB 来诊断错误，但是对于这些问题，它比日志系统有一些很好的优势。GDB 脚本允许我收集新的检测数据，而无需添加新的检测行并将我的软件的新版本部署到客户端。GDB 可以从第三方库生成消息（需要在某一时刻调试到 openssl）。GDB 在不使用时不会对软件增加运行时影响。GDB 在打印对象的内容方面做得很好；当需要记录新对象的状态时，代码级日志记录系统需要编写新的宏。

缺点之一是我生成的 gdb 脚本与源代码没有明确的关系。源文件和gdb脚本是独立开发的。理想情况下，对源文件的更改应该会影响并更新 gdb 脚本。一种想法是将特殊格式的注释放入代码中，并让脚本语言传递源文件以生成源文件的调试器脚本文件。最后，让 makefile 在构建周期中执行此脚本。

考虑为此目的使用 GDB 的潜力是一个有趣的练习，但我必须承认，可能有更好的代码级解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T16:43:48.857

如果您在 Linux 中执行应用程序，您可以在应用程序崩溃时使用“ulimit”生成内核（或 assert(false) 或 kill -6 ），稍后，您可以使用 gdb (gdb -c core_file binary_file) 和分析堆栈。

萨鲁2。

PD。对于分析，使用 gprof

# screen-scraping - 使用 Adblock Plus 订阅从下载的页面中删除广告

> ID：916284
> 
> 赞同：2
> 
> 时间：2009-05-27T15:05:19.180
> 
> 标签：screen-scraping, ads, adblock

我想使用 adblosck plus 订阅从我将要废弃的页面中删除广告。有没有人使用过这种方法？这种解决方案的性能如何？扩展本身使用的算法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T16:13:51.147

经过一番谷歌搜索后，我找到了扩展作者的帖子：http: [//adblockplus.org/blog/investigating-filter-matching-algorithms](http://adblockplus.org/blog/investigating-filter-matching-algorithms)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T13:15:38.303

更快的 ABP 匹配算法：[https ://adblockplus.org/forum/viewtopic.php?t=6118](https://adblockplus.org/forum/viewtopic.php?t=6118)

# json - 无法将 Struts2 结果类型设置为 json

> ID：916285
> 
> 赞同：8
> 
> 时间：2009-05-27T15:05:33.780
> 
> 标签：json, struts2

我想在 Struts2 中使用 json。但是，当我将操作返回类型设置为“json”时，我得到“没有为类型 'json' 定义的结果类型，其名称为 'success'。” Bellow 是 struts.xml 文件。

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
    <constant name="struts.custom.i18n.resources" value="resource"/>

    <package extends="struts-default" name="test">
        <action name="inputHandler" class="inputHandlerAction">
            <result name="input">/index.jsp</result>
            <result>/result.jsp</result>
        </action>
        <action name="setLangHandler" class="com.sesoft.test.setLanguageHandler">
            <result>/index.jsp</result>
        </action>

        <action name="Handler" class="com.sesoft.test.Handler">
            <result>/test2.jsp</result>
        </action>   
    </package>

    <package name="example" extends="json-default">

        <action name="ajaxHandler" class="com.sesoft.test.AjaxHandler">
            <result name="success" type="json" />
        </action>

    </package>
</struts> 
```

在我添加 json 操作之前，所有其他操作都执行得很好。但是在我添加 json Action 之后，服务器无法操作，错误代码为 503。

我已将“jsonplugin-0.33.jar”添加到 lib 目录中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-28T13:31:17.920

您没有在 struts.xml 包中定义 JSON 结果。如果你只需要默认的东西，那么你可以扩展 json-default 而不是 struts-default。如果您需要自定义软件包，请包含以下内容，这应该可以解决问题：

```
 <result-types>
        <result-type name="json" class="com.googlecode.jsonplugin.JSONResult"/>
    </result-types> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-10-18T03:30:53.207

你的包应该扩展 json-default

```
<package name="json-default" extends="struts-default">
    <result-types>
        <result-type name="json" class="org.apache.struts2.json.JSONResult"/>
    </result-types>
    <interceptors>
        <interceptor name="json" class="org.apache.struts2.json.JSONInterceptor"/>
    </interceptors>
</package> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-15T16:53:48.363

如果使用 Maven，您可能需要添加依赖项，例如

```
 <dependency>
            <groupId>org.apache.struts</groupId>
            <artifactId>struts2-json-plugin</artifactId>
            <version>2.2.3</version>
        </dependency> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-27T03:26:10.573

这是我的配置`pom.xml`：

```
<dependency>
    <groupId>org.apache.struts</groupId>
    <artifactId>struts2-core</artifactId>
    <version>2.3.1.2</version>
</dependency>

<dependency>
    <groupId>org.apache.struts</groupId>
    <artifactId>struts2-json-plugin</artifactId>
    <version>2.3.1.2</version>
</dependency> 
```

在操作结果中，您只需指定`type="json"`：

```
<result type="json"/> 
```

记住变量 getter 和 setter 作为`type="json"`响应在动作中给出了 getter。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-09T05:00:25.727

包含`json-default`在`extends`参数中：

```
<package name="default" extends="struts-default,json-default">
   <action> 
       ...
       ...
  </action>
</package> 
```

# database - 使用单一数据库的优缺点和最佳实践是什么？

> ID：916295
> 
> 赞同：15
> 
> 时间：2009-05-27T15:06:42.140
> 
> 标签：database, database-design

在工作中（一家价值数十亿美元的制造公司，拥有 12 人的 Windows 开发团队），我们即将为所有新应用程序使用单个主数据库，并将其与我们通常拥有数据库的模式分解前。还有一些常见的模式，比如员工目录和分支目录等等......

我仍然不确定我对这一举措的感受，但我们将在几个小时后就此召开会议，讨论利弊、最佳实践、陷阱等......所以我正在寻找您对此的看法... 好吗？不好吗？一年后我们会遇到什么问题？

欢迎任何想法、提示或建议。谢谢

**编辑** 在回答对此问题的评论时，我们使用的是 SQL Server 2005，我们实际上是在谈论将同一实例上的单独数据库移动到单个数据库中。驱动问题是跨数据库完全缺乏参照完整性，因为我们的大多数应用程序需要访问 *通用*数据，例如员工记录或分支机构信息。

**更新** 有几个人要求我用我们会议的结果更新这个问题，所以就在这里。我们反复讨论了这样做的利弊（我什至用投影仪向他们展示了这个问题），当我们完成时，我们几乎已经涵盖了这里所涵盖的利弊。大约一半的人认为我们可以通过正确的资源和承诺来完成它，大约一半的人认为我们做不到（或者效果不佳）。我们决定花一些时间与 Microsoft 一起了解他们的想法和针对特定平台的建议。在我们与他们交谈后，我一定会更新这个问题和[我的博客。](http://maxschmeling.blogspot.com/)感谢所有帮助和有用的答案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-27T16:07:33.937

由于庞大的规模，更大的数据库更难维护：备份需要更长的时间，灾难恢复更慢，这反过来需要更频繁的备份。您可以通过在维护计划中创建文件组和使用[文件组级别备份来解决这些问题，并且在崩溃恢复时，您可以使用“](http://msdn.microsoft.com/en-us/library/ms179401.aspx)[分段恢复](http://msdn.microsoft.com/en-us/library/ms190394.aspx)”策略来加快速度。

正确使用文件组将消除之前回复中提到的大部分“缺点”：它们可以分发 I/O，它们可以清理您的维护计划和备份/恢复策略，它们通过仅使损坏的部分脱机来提供可用性db 在崩溃的情况下。所以我想说，虽然这些“缺点”是合法的问题，但它们可以通过适当的部署策略来缓解。尽管这些缓解措施确实需要一位真正的、经验丰富的 dba 掌舵，因为它们将超越开发人员因需要而转变为 dba 的舒适区。

我能很快想到的一些优点：

1.  一致性。您可以进行备份恢复，以使所有数据保持一致。单独的数据库不允许这样做，因为您无法协调一组一致的备份，除非您在备份期间将它们全部脱机，或将它们设为 r/o。
2.  廉价的高可用性：您可以部署[数据库镜像](http://technet.microsoft.com/en-us/library/ms189852.aspx)以实现灾难恢复和高可用性。多个数据库存在问题，因为无法协调同时进行的故障转移，并且应用程序面临着寻找*每个*数据库当前位置的困境。
3.  安全。虽然大多数其他帖子都认为一个数据库更难保护，但我想说**更容易**保护。多个数据库似乎更难正确保护，因为每个人所做的是他们进行一次登录并将其添加到*该*数据库 db_owner 组。拥有一个数据库会使事情变得更难（除非你最终让每个人都成为 dbo，非常糟糕）但是一旦你开始做正确的事情（粒度访问），那么一个数据库并不比多个数据库更难，实际上更容易，因为你不会有跨多个数据库复制/维护一些公共组/权限。
4.  控制。将某些策略和良好实践强加于单个数据库而不是多个数据库将更容易（开发人员无法访问数据，应用程序数据访问仅通过模式上的执行权限来强制执行过程访问等）。

还有一些我在其他帖子中没有看到的缺点：

1.  这将比您现在认为的更难实现
2.  增加以前分离的应用程序之间的耦合将施加开发限制：你不能简单地改变你的模式，你必须与其他应用程序协调它（你可以说这也是以前的情况，但被刷到了地毯下通过拥有单独的数据库，你是对的）
3.  现在分布在多个数据库日志中的日志写入将合并到一个日志文件中。如果您的写入量很大，这可能会成为一个严重的瓶颈，并迫使您为新的整合日志文件购买一些昂贵的快速驱动器。通常，可以通过使日志驱动器成为跨多个条带的剥离阵列来解决此问题，以使其足够快（通常是raid 10）。
4.  [GAM/SGAM/PFS](http://www.sqlskills.com/BLOGS/PAUL/post/Inside-The-Storage-Engine-GAM-SGAM-PFS-and-other-allocation-maps.aspx)分配也将被合并，但同样可以通过正确使用文件组来缓解。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T15:28:19.587

优点：

*   你只需要记住一个连接字符串
*   当用户报告访问速度很慢时，您就知道是哪个数据库导致了问题

缺点：

*   The One DB 的备份需要很长时间，并且会随着时间的推移逐渐变长。
*   从备份中恢复数据将变得越来越困难。
*   一个应用程序的一项功能的性能调优（SQL Profiler，执行计划估计）会减慢每个应用程序的速度。
*   如果可能的话，限制对单个应用程序数据的访问是很麻烦的，这可能意味着在实践中所有开发人员和 DBA 都将获得整个王国的钥匙。
*   新开发人员/DBA 的学习曲线要​​大得多，因为他们需要导航一个大型且几乎无用的（对他们而言）数据库结构，这意味着培训/升级的成本更高。
*   当 The One 数据库出现故障时，您组织中的每个人都会玩纸牌游戏，直到它恢复。
*   为应用程序开发创建测试实例意味着复制整个数据库

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T15:14:52.827

我能想到的唯一“优点”是您的所有系统都将位于一个数据库中，因此可以在一个地方进行备份、存储等。但是，我认为这也是最大的“缺点”之一。

其他一些一般缺点：

*   将来将应用程序移动到不同的位置/服务器要困难得多。
*   如果任何应用程序使用 tempdb，可能会出现锁定问题。
*   使用另一个应用程序时，一个应用程序可能会出现不相关的性能降级。
*   如果所有表都在同一个数据库中，那么实现应用程序级别的安全模型会更加困难。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T13:13:28.923

在我看来，您的公司似乎正在两种完全不同的使用数据库技术的动机之间转换。首先是应用支持。二是数据整合。如果我在这点上是对的，那么这个过程将打开一大堆蠕虫，而且许多问题甚至无法通过将所有数据放在一个大数据库中来解决。

考虑你提出的两点。首先是不同数据库之间完全缺乏参照完整性。第二个是每个应用程序都有自己的模式的想法。这允许发生的是完全缺乏跨模式的引用完整性，使您回到现在所处的流沙中。

修复数据以实现引用完整性，修复模式以强制执行引用完整性，修复应用程序以使应用程序与新模式一致，这将是一项艰巨的任务。

以下是您的公司真正需要做的事情：拥有一个包含所有“企业数据”的单一概念数据库，并以这样一种方式定义，即执行引用完整性和实体完整性。修改现有模式，使它们符合概念数据库，除了那些纯粹是该模式本地的数据和统一概念数据库中未记录的数据。在需要的地方使用约束来保证这些模式所涵盖的数据不会失去完整性。

根据数据库管理、故障软、安全性和性能要求，而不是根据集成数据的需要来决定这些模式是属于一个数据库还是多个数据库。使用一个平台还是多个平台是一个可分离的决定。

如有必要，在不同的数据库中维护相同数据的同步副本。在上面的性能考虑中包括这样做的开销。

将概念数据库记录在 gazoo 之外。不要仅仅满足于数据形式的定义。还要坚持数据语义的定义。

请注意，如果您使用 ID 字段而不是自然键来强制引用完整性，您将不得不在一个模式中生成每个 ID 字段，并让 ID 和依赖数据之间的关联通过同义词、视图和同步复制来传播。

这并不容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T15:10:24.160

如果数据库越来越大，由于它的大小，备份变得越来越困难。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T15:11:25.470

如果您想在未来添加高流量应用程序，这可能意味着严重的可伸缩性问题，因为添加运行单独 db 的新数据库服务器比并行化单个 DB 要容易得多。至少在 SQL Server 中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T15:11:38.120

优点：

*   把所有东西都放在一个地方的便利
*   少考虑好的数据库设计

缺点：

*   甚至不相关的事情都在一个地方
*   较少考虑良好的数据库设计会导致数据标准化不佳

对我来说，这听起来像是一种懒惰，并且相信所有这些“花哨的象牙塔数据库”都是一文不值的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T15:12:24.097

我可以看到这很可怕，但考虑到使用 Oracle EBS、SAP 或其他本质上相同配置的系统的企业数量，我认为这不是坏事™。这是一个很大的举措，而且*很难*做到正确，但从长远来看，它确实可以改善整个企业的集成。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T15:12:57.527

我从未听说过这种方法，想知道会议进展如何。当数据彼此不相关时，我认为将多个应用程序组合到一个数据库中并没有真正的好处。

我认为如果您决定某个应用程序在某一时刻需要它自己的数据库服务器，您可能会遇到问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T15:17:08.907

啊，旧的 EggsInOneBasket 设计模式。这不是最喜欢的。

您只是在加剧由该数据库损坏引起的任何问题。分散风险！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-28T14:56:15.767

对于参照完整性问题，您可以在附属数据库中制作这些共享表的副本。您不能使用真正的复制，但您所做的是拒绝所有内容，但对大多数用户选择这些。

在同一台服务器上，您可以从主数据的官方存储库推送或拉取数据，并插入任何新行/更新任何更改的行。您甚至可以使用主数据库中的触发器来执行此操作（但我不推荐它）。

如果是不同的实例或服务器，您可以使用链接服务器或 SSIS。

您可以将公共数据放入每个数据库中的“核心”模式中。然后，您可以使用工具来检查每个附属数据库中的所有核心表是否一致。可能发生的更糟糕的情况是应用程序没有看到新员工，因为核心没有更新。保持数据库独立使您能够解耦并为您提供维护窗口。（如果您的主服务器停机进行维护，您甚至可以解耦并运行“独立”）。

我预计即使在大型企业中，您也只会看到几十个这样的核心实体表。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-28T15:38:20.067

还有许多其他方法可以解决参照完整性 (RI) 问题。我不像其他数据库那样熟悉 SQL Server。在 Informix 中，您可以使用同义词来指向其他 DB 中的对象并将它们用于您的 RI。在 Oracle 中，您可以将数据库链接到一个或多个数据库以完成相同的事情。这些方法的问题是，如果任何数据库出现故障，RI 将失败，从而导致相关数据库出现问题。选择会起作用，但插入会失败。合并可能是一个好主意，这取决于模式的大小以及其他可伸缩性问题。SQL Server 存在严重的可伸缩性问题。其他数据库平台允许使用共享所有方法（Oracle 的 RAC，最新的 Informix 版本）或分区的无共享方法（DB2 的 DPF、Informix XPS、Netezza、

我和这里的其他一些人有兴趣听听你们会议的结果。

# c# - 如何从 C# 循环 USB 设备？

> ID：916296
> 
> 赞同：9
> 
> 时间：2009-05-27T15:06:45.213
> 
> 标签：c#, api, stack, usb, peripherals

我想在某个事件触发后循环（模拟拔出并重新插入）USB 设备（调制解调器）。我在 codeproject 上找到了一个示例：

> [http://www.codeproject.com/KB/system/usbeject.aspx](http://www.codeproject.com/KB/system/usbeject.aspx)

这使我可以通过其非易失性串行识别+弹出设备，但我需要它来回收，而不仅仅是弹出。

我读过这个：

> [http://www.tech-archive.net/Archive/Development/microsoft.public.development.device.drivers/2005-02/1292.html](http://www.tech-archive.net/Archive/Development/microsoft.public.development.device.drivers/2005-02/1292.html)

我不明白。

这已在其他 USB 相关帖子中提到：

> [http://www.codeproject.com/KB/system/DriveDetector.aspx](http://www.codeproject.com/KB/system/DriveDetector.aspx)

这与我的问题无关。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T08:44:04.147

通过使用名为 devcon 的命令行工具让它工作，然后我从代码中调用它。

将 devcon.exe 放入其中一个系统路径，以便它可以在任何地方工作。

开发者大会：[开发者大会](http://support.microsoft.com/kb/311272)

称为：DEVCON 删除 *usb"*MI_01"

然后调用：DEVCON rescan

代码：

```
 System.Diagnostics.Process proc = new System.Diagnostics.Process();
 proc.StartInfo.FileName = "DEVCON";
 proc.StartInfo.Arguments = "Remove *usb"*MI_01";
 proc.StartInfo.RedirectStandardError = true;
 proc.StartInfo.RedirectStandardOutput = true;
 proc.StartInfo.UseShellExecute = false;
 proc.Start(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T13:24:28.833

您可以使用[C# Hardware Helper Lib](http://www.codeproject.com/Articles/21503/Hardware-Helper-Library-for-C)并添加[ResetDevice 功能](http://www.codeproject.com/Articles/21503/Hardware-Helper-Library-for-C?msg=4467165#xx4467165xx)。

只要确保你添加

```
public const int DICS_PROPCHANGE = ((0x00000003)); 
```

在`public class Native`下面 //PARMS，

```
public bool ResetDevice( IntPtr hDevInfo, IntPtr devInfoData )
{
int szOfPcp;
IntPtr ptrToPcp;
int szDevInfoData;
IntPtr ptrToDevInfoData;

Native.SP_PROPCHANGE_PARAMS pcp = new Native.SP_PROPCHANGE_PARAMS();
pcp.ClassInstallHeader.cbSize = Marshal.SizeOf(typeof(Native.SP_CLASSINSTALL_HEADER));
pcp.ClassInstallHeader.InstallFunction = Native.DIF_PROPERTYCHANGE;
pcp.StateChange = Native.DICS_PROPCHANGE; // for reset
pcp.Scope = Native.DICS_FLAG_CONFIGSPECIFIC;
pcp.HwProfile = 0;

szOfPcp = Marshal.SizeOf(pcp);
ptrToPcp = Marshal.AllocHGlobal(szOfPcp);
Marshal.StructureToPtr(pcp, ptrToPcp, true);
szDevInfoData = Marshal.SizeOf(devInfoData);
ptrToDevInfoData = Marshal.AllocHGlobal(szDevInfoData);
Marshal.StructureToPtr(devInfoData, ptrToDevInfoData, true);

bool rslt1 = Native.SetupDiSetClassInstallParams(hDevInfo, ptrToDevInfoData, ptrToPcp, Marshal.SizeOf(typeof(Native.SP_PROPCHANGE_PARAMS)));
bool rstl2 = Native.SetupDiCallClassInstaller(Native.DIF_PROPERTYCHANGE, hDevInfo, ptrToDevInfoData);

if (rslt1 && rstl2)
{
    return true;
}
return false;
} 
```

# html - CSS 菜单在 Safari 中显示不正确

> ID：916297
> 
> 赞同：0
> 
> 时间：2009-05-27T15:06:56.790
> 
> 标签：html, css, safari, cross-browser

我为我正在帮助开发的网站编写了一个 CSS 菜单，它在 IE 7 和 Firefox 3（在 Windows XP 上）中都能正确显示。

预期的效果是下拉菜单应该与其中最宽的元素一样宽（但不能更宽）。然而，在 Safari 中，它们的宽度似乎大约是应有宽度的两倍。我不知道如何解决这个问题。有什么帮助吗？

HTML 是：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head></head>
<body>
<div id="mainContainer">
  <div id="mainNavContainer">
    <img id="leftNavImg" src="imgsrc.jpg" alt="ignore me for now" height="34" width="91">
    <div id="topNav">
      <ul>
        <li><a href="#">Menu Item 1</a><ul>
          <li><a href="#">Submenu Item 1.1</a></li>
          <li><a href="#">Submenu Item 1.2</a></li>
          <li><a href="#">Submenu Item 1.3</a></li>
        </ul></li>
        <li><a href="#">Menu Item 2</a><ul>
          <li><a href="#">Submenu Item 2.1</a></li>
          <li><a href="#">Submenu Item 2.2</a></li>
          <li><a href="#">Submenu Item 2.3</a></li>
        </ul></li>
        <li><a href="#">Menu Item 3</a><ul>
          <li><a href="#">Submenu Items may have different lengths</a></li>
          <li><a href="#">short</a></li>
          <li><a href="#">or potentially moderately long</a></li>
          <li><a href="#">The submenu should be as wide as its longest item</a></li>
        </ul></li>
        <li><a href="#">etc...</a><ul>
          <li><a href="#">Submenu Item 4.1</a></li>
          <li><a href="#">Submenu Item 4.2</a></li>
          <li><a href="#">Submenu Item 4.3</a></li>
        </ul></li>
      </ul>
    </div>
  </div>
</div>
</body> 
```

和CSS是

```
 * {
    margin: 0;
    padding: 0;
  }
  ul, ol, dl, li, dt, dd {
    list-style: none;
  }
  body {
    background-color: #fff;
    margin: 20px;
    text-align: center;
    font-size: 12px;
    font-family: Arial, Helvetica, sans-serif;
  }

  #mainContainer {
    width: 975px;
    background-color: #fff;
    text-align: left;
    margin: 0 auto;
    position: relative;
    padding-top: 52px;
  }
  #mainNavContainer {
    height: 34px;
    font-size: 11px;
    width: 973px;
    border: 1px solid #dedede;
    background-color: #888;
    position: absolute;
    top: 0;
    color: #000;
  }
  #mainNavContainer #leftNavImg {
    padding: 0 20px 0 7px;
    float:left;
    border-right:1px solid #dedede;
  }

  #topNav {
    float: left;
  }
  #topNav ul {
    display: inline;
    text-align: center;
  }
  #topNav li {
    display: block;
    float: left;
    position: relative;
    border-right: 1px solid #DEDEDE;
    width: 102px;
  }
  #topNav li ul {
    display:none;
    border-bottom: 4px solid #422952;
    position:absolute;
    top: 35px;
    left:0px;
    width: auto;
    white-space: nowrap;
    text-align: left;
    z-index:100;
  }
  #topNav li li {
    display:block; 
    border-right: none;
    border-bottom: 2px solid #622952;
    background-color:#FBFBFB;
    width: 100%;
    font-size: 12px;
  }
  #topNav li a, #topNav form {
    text-decoration: none;
    display:block;
    color: #000;
    padding: 11px 6px;
  }
  #topNav li li a {
    padding: 9px 6px;
    color: #666;
    width: 100%;
  }
  #topNav a:hover {
    color: #fff;
    background-color: #824972;
  }
  #topNav li:hover ul {
    display:block; 
    z-index:100;
  }
  #topNav li li a:hover {
    background-image:none;
    background-color:#fff;
    color: #000;
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T16:01:25.680

移动

```
white-space: nowrap; 
```

从

```
#topNav li ul { ... 
```

到

```
#topNav li li a { ... 
```

干杯！

# sql - 带条件的 CONNECT_BY_ISLEAF

> ID：916300
> 
> 赞同：2
> 
> 时间：2009-05-27T15:07:37.710
> 
> 标签：sql, oracle

`START WITH`我使用整体和子句在表格上进行分层设置`CONNECT BY`，我使用它来设置垂直对齐的菜单系统，该系统可以向右扩展，具体取决于菜单选项是否有子项和总数级别数。此外，作为菜单选项的一部分，如果父母有孩子，我也会显示一个`'>'`符号来指定它。

我的问题是，我`CONNECT_BY_ISLEAF`用来确定菜单选项是否为叶子，但我的分层表中还有一列指定菜单选项是否处于活动状态。

因此，当我的菜单中有父/子设置的情况时，is和is的`ISLEAF`值，但我实际上已使子菜单选项处于非活动状态，我的符号仍显示在父级，即使此父项的子记录处于非活动状态。`Parent``0``Child``1``'>'`

知道如何将其与`CONNECT_BY_ISLEAF`值一起检查，以防止`'>'`即使此父菜单选项具有非活动子记录也出现符号？

基本上想要一些东西，如果基于`ISLEAF`值存在子记录但子记录处于非活动状态，则忽略此叶记录并假装它实际上不存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T15:12:40.553

```
SELECT  *
FROM    table
CONNECT BY
        parent = PRIOR id
        AND active = 1 
```

仅当它处于活动状态时才会选择一个孩子，如果这是您想要的。

请注意，此查询将返回`CONNECT_BY_ISLEAF = 1`没有活动子项的项目，并且它们可能会被视为您设计中的端点。

# data-structures - 平面文件的节定界

> ID：916318
> 
> 赞同：0
> 
> 时间：2009-05-27T15:10:20.917
> 
> 标签：data-structures, text-files

我需要生成一个包含几个不同部分的平面文件，每个部分都有不同的记录结构。所有数据都是分隔文本，每条记录单行。考虑到记录可以在引用的文本字段中包含换行符等，什么是一个好的分隔顺序或区分部分的机制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T15:16:40.903

您尚未指定要对该文件执行的操作。你用什么语言等等。

如果文件包含不同的部分和不同的结构，我建议使用[YAML](http://en.wikipedia.org/wiki/YAML)结构。

有许多[库](http://www.yaml.org/)允许使用[YAML](http://en.wikipedia.org/wiki/YAML)进行读/写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:31:45.273

好吧，如果您不必使用劣质的文本编辑器编辑文件，或者文件是人类可读的，您可以使用四个 C0 控制代码之一，它们是 ASCII 字符 28-31，用于分隔文字记录。他们只是因为前两点而没有流行起来。

# sql-server-2005 - Sql Server 2005 还原失败

> ID：916322
> 
> 赞同：1
> 
> 时间：2009-05-27T15:11:07.577
> 
> 标签：sql-server-2005, restore

运行 sql server 2005 我有数据库 A。我正在尝试从 A 的备份恢复到数据库 B。我想保留数据库 A 并从以前的一组数据创建一个新的测试数据库 B。

我尝试创建 B 并从 .bak 恢复并将数据库从管理工作室恢复到 B。

错误是...

> 标题：Microsoft SQL Server 管理
> 
> ## 工作室
> 
> 服务器“195448-APP2”的恢复失败。(Microsoft.SqlServer.Smo)
> 
> 如需帮助，请单击： http: [//go.microsoft.com/fwlink ?ProdName=Microsoft+SQL+Server&ProdVer=9.00.1399.00&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.FailedOperationExceptionText&EvtID=Restore+Server&LinkId=20476](http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=9.00.1399.00&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.FailedOperationExceptionText&EvtID=Restore+Server&LinkId=20476)
> 
> - - - - - - - - - - - - - - - 附加信息：
> 
> System.Data.SqlClient.SqlError：备份集包含一个数据库的备份，而不是现有的“B”数据库。(Microsoft.SqlServer.Smo)
> 
> 如需帮助，请单击： http: [//go.microsoft.com/fwlink ?ProdName=Microsoft+SQL+Server&ProdVer=9.00.1399.00&LinkId=20476](http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=9.00.1399.00&LinkId=20476)
> 
> - - - - - - - - - - - - - - - 纽扣：
> 
> ## 好的

我发现了这个我犹豫使用的片段，并想问它是否可以解决我在恢复数据库过程中更改 mdf 和 ldf 位置的问题，还是完全替换数据库 A 的项目。

```
ALTER DATABASE AdventureWorks
SET SINGLE_USER WITH
ROLLBACK IMMEDIATE
RESTORE DATABASE AdventureWorks
FROM DISK = 'C\:BackupAdventureworks.bak'
WITH MOVE 'AdventureWorks_Data' TO 'C:\Data\datafile.mdf',
MOVE 'AdventureWorks_Log' TO 'C:\Data\logfile.ldf',
REPLACE 
```

[ [http://blog.sqlauthority.com/2007/04/30/sql-server-fix-error-msg-3159-level-16-state-1-line-1-msg-3013-level-16-state -1-line-1/][1]](http://blog.sqlauthority.com/2007/04/30/sql-server-fix-error-msg-3159-level-16-state-1-line-1-msg-3013-level-16-state-1-line-1/][1])

对我来说，我会做到的......

```
RESTORE DATABASE B
FROM DISK = 'C:\backupofA.bak'
WITH    
MOVE 'B' TO 'C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data\B.mdf',
MOVE 'B_log' to 'C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data\B_log.ldf',
REPLACE 
```

我不知道它是否会影响数据库 A。我希望替换引用与 B 关联的文件。

或者如果应该

```
RESTORE DATABASE B
FROM DISK = 'C:\backupofA.bak'
WITH    
MOVE 'A' TO 'C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data\B.mdf',
MOVE 'A_log' to 'C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data\B_log.ldf',
REPLACE 
```

如果有人可以帮助我解决错误和/或确认此修复，我将非常感激，因为它不是我正在使用的数据库。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T15:27:14.237

您可以简单地使用[复制数据库向导](http://msdn.microsoft.com/en-us/library/ms188664.aspx)。如果您想像专业人士一样使用 T-SQL，那么 RESTORE .. MOVE ... REPLACE 将完成您的预期：将两个文件移动到您想要的位置，并用备份中的内容替换数据库 B。A 不受影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T10:17:29.510

如果我是你，我会使用向导：在 Sql Server Management Studio 中，右键单击“数据库”并选择“还原数据库...”。此对话框/向导将完全按照您的要求执行 - 只需选择要从中还原的源 .bak 文件/数据库，输入要还原到的数据库的名称并点击“确定”。

一些注意事项 - 如果您输入一个尚不存在的数据库的名称（听起来这就是您想要做的），它将为您创建该数据库。如果您输入现有数据库的名称，它将尝试恢复到该数据库。如果您尝试从不同数据库的备份还原到现有数据库，它将失败，但是您可以通过转到“选项”并选中“覆盖现有数据库”复选框来强制 Sql Server 覆盖现有数据库。

此外，如果您要恢复现有数据库的备份以创建该数据库的新的第二个副本，您可能会发现向导失败，因为它尝试使用与源当前使用的相同的数据库文件路径创建数据库数据库。要解决此问题，您需要单击“选项”并将所有“还原为”文件路径更改为尚不存在的文件。

您还可以让此向导生成 SQL 脚本，而不是实际执行实际还原（单击顶部的“脚本”按钮），如果您想学习如何在原始 SQL 中执行此类操作，这将非常方便。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-23T14:42:43.527

可以将数据库从sql server 7、sql server 2000恢复到sql server 2005。可以通过restore和replace命令来实现

```
use master 

restore database mydatabase from disk ='c:\mybackup.bak' with replace 
```

使用此脚本很容易在 sql server 中进行备份，无需任何外部工具。

查看[使用示例还原](http://dynamic-coding.blogspot.com/2009/07/database-restore-from-sql-server-7-sql.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T10:27:32.300

首先删除数据库 b。然后进行还原。

# java - 不同jar中的相同功能

> ID：916324
> 
> 赞同：0
> 
> 时间：2009-05-27T15:11:23.160
> 
> 标签：java, soap, conflict

我有一个问题，想知道是否有人遇到过和我一样的情况。

我将 java 版本从 1.4 升级到 1.6，

java6包含soap包本身，这意味着我之前使用的axissoap库将不会被调用。例如，javax.xml.soap.SOAPMessage。

无论如何我可以明确地强制应用程序使用旧的soap函数，而不是java6中包含的那个，因为它不适合我......

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T16:07:00.507

Bishiboosh 提到的背书机制是（不幸的是）要走的路。但是，可以编写`ClassLoader`覆盖其父级的 a。许多 Java EE 服务器都这样做。

希望 JDK7 将有一个模块实现，这意味着认可是不必要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T15:25:08.577

您可以使用[背书机制](http://java.sun.com/javase/6/docs/technotes/guides/standards/)。简而言之，您将要覆盖标准库的库放在一个目录中，告诉 Java 它在哪里，并且这些库在核心库之前加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:30:21.970

您可以使用 -Xbootclasspath/p 选项启动 JVM，并预先添加您的 Jars。但是，您应该首先了解您使用的轴版本是否适用于 1.6 以及推荐的配置是什么，因为如果存在真正的不兼容性，此解决方案可能会破坏其他内容。

# entity-framework - 实体框架 IQueryable

> ID：916330
> 
> 赞同：1
> 
> 时间：2009-05-27T15:12:15.953
> 
> 标签：entity-framework

我在查询实体模型以获取更多信息时遇到问题。

我的数据库有一个与事件表具有一对多关系的程序表。实体模型可以很好地生成关系，但我无法弄清楚如何查询模型以获取带有事件的程序对象。

我可以做这个：

```
var foo = from program in entities.ProgramSet
          where program.StartDate > DateTime.now
          orderby program.StartDate
          select program; 
```

那里没有问题。根据我在 Microsoft 页面（使用实体框架塑造查询）上找到的内容：msdn.microsoft.com/en-us/library/bb896272.aspx，如果我想获取子对象，我只需执行以下操作：

```
// Define a LINQ query with a path that returns 
// orders and items for a contact.
var contacts = (from contact in context.Contact
          .Include("SalesOrderHeader.SalesOrderDetail")
          select contact).FirstOrDefault(); 
```

但是，没有 .Include 或 Include 我可以在查询中找到。

有什么建议吗？我知道我可以对结果进行 foreach，然后在其上运行 .Events.Load() ，但这不会强制 IQueriable 结果执行 sql，而不是使其仅在 .ToList( ) 等被调用了吗？

这是我项目中的一些示例代码：

```
public class ProgramRepository : CT.Models.IProgramRepository
{
    CTEntities db = new CTEntities();

    public IQueryable<Program> FindAllPrograms()
    {

        return db.ProgramSet;
    }
    public IQueryable<Program> FindUpcomingPrograms()
    {

        var programs =  from program in FindAllPrograms()

               where program.StartDate > DateTime.Now
               orderby program.StartDate                                
               select program;
        return programs;

    } 
```

使用 FindUpComingPrograms 我希望它还包括事件数据。Program 和 Events 模型之间存在关系。Program 有一个 List `<`Events`>`属性，我想用 IQueryable 方法填充并返回它。

再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T15:27:52.927

Include 函数是 ObjectQuery 对象的一部分...

我认为您将需要重新编写查询以使其看起来像这样：

```
var contacts = context.Contact.Include("SalesOrderHeader.SalesOrderDetail").FirstOrDefault(); 

//Not sure on your dot path you might have to debug that a bit 
```

这是一篇[有](http://msdn.microsoft.com/en-us/library/bb738708.aspx)一些例子的文章......

# c# - 如何在 C# 中找到 2 个值之间的差异？

> ID：916332
> 
> 赞同：2
> 
> 时间：2009-05-27T15:12:34.937
> 
> 标签：c#, absolute-value

我正在使用在 10.000000 和 -10.000000 之间波动的振荡器

该值每 5 分钟更改一次。我想找出当前值与 5 分钟前的值之间的差异。这是我的逻辑。

```
1 bar ago (1BA)= -.2
Current bar (CB) = .3 
```

如果我执行以下操作，我不会得到 1 的值：

```
Abs(CB) - Abs(1BA) = .3 - .2 = 1 
```

然而：

```
Abs(CB- 1BA) = .3 - -.2 = 5 
```

我想简单地计算振荡器从一个时间帧到另一个时间帧的移动之间的差异。我在应用 Abs 时是否考虑到了正确的逻辑？

这是我的实际代码，请假设我调用的方法是正确的：

```
if (Oscillator(PoFast, PoSlow, PoSmooth)[0] > 
           Oscillator(PoFast, PoSlow, PoSmooth)[3]
    && Math.Abs(Oscillator(PoFast, PoSlow, PoSmooth)[0] - 
           Oscillator(PoFast, PoSlow, PoSmooth)[3]) > .25) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T15:16:02.293

在这两个中，绝对值（CB-1BA）是正确的，因为两个读数之间的变化为 0.5。

**编辑**：为了使它更具可读性，并假设你得到双值，你会做这样的事情，但有错误检查，并且可能使 .25 成为变量。

```
double[] values = Oscillator(PoFast, PoSlow, PoSmooth);
double currentBar = values[0];
double oneBarAgo = values[3];

if (currentBar > oneBarAgo && Math.Abs(currentBar - oneBarAgo) > .25)
{
    // do something
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T15:18:07.843

您的逻辑 Abs(CB-1BA) 是正确的。

顺便说一句，如果您不是开发人员，您真的认为您应该编写 C# 代码来交易期货合约吗？他们有足够的风险在最好的时候进行交易，不要介意当你编写代码来做这件事而你不是开发人员时！！！！

# c# - 为什么我的控制台应用程序不能使用 25 个或更多参数？

> ID：916345
> 
> 赞同：4
> 
> 时间：2009-05-27T15:16:51.857
> 
> 标签：c#, command-line-arguments

我正在制作一个控制台应用程序，在其中我将文件从资源管理器拖放到 .exe 上，它会根据我在程序逻辑中设置的规则将它们移动到适当的文件夹中。

该程序运行良好，但是当我选择超过 25 个文件并将它们放在我的 .exe 上时，我收到一个错误：

> Windows 无法访问指定的设备、路径或文件。您可能没有适当的权限来访问该项目。

如果我只从同一组中删除 24 个文件，它就可以正常工作。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T15:21:22.423

根据您的平台，您可能会遇到最大命令行长度。请参阅[此处](http://support.microsoft.com/kb/830473)了解更多信息。

“在运行 Microsoft Windows XP 或更高版本的计算机上，您可以在命令提示符处使用的最大字符串长度为 8191 个字符。在运行 Microsoft Windows 2000 或 Windows NT 4.0 的计算机上，您可以在以下位置使用的最大字符串长度命令提示符为 2047 个字符。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T15:19:02.537

是否导致超出命令行（以及参数）的最大长度的文件数，从而导致此错误？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T15:29:52.233

要回答后续问题，可能需要有关应用程序用途的更多信息，但如果可能，您可能会更改命令行参数以接受文件夹路径和模式以匹配您要路由的所有必要文件。或者将其更改为带有网格的 GUI 应用程序，您可以将其拖放到其中。

# javascript - 为什么 Mozilla 的这个 XMLHttpRequest 示例在 Firefox 3 中不起作用？

> ID：916357
> 
> 赞同：1
> 
> 时间：2009-05-27T15:18:54.503
> 
> 标签：javascript, ajax, firefox, rest, xmlhttprequest

我正在尝试从 Mozilla 获取使用 REST Web 服务以在 Firefox 3.0.10 下工作的示例代码。以下代码在 Firefox 中不起作用，但在 IE 8 中起作用！

1.  为什么这不起作用？
2.  IE 8 是否支持 XMLHttpRequest？我见过的大多数示例都使用 ActiveX 分配。我应该做什么？XMLHttpRequest 似乎更加标准化。

样本：

```
var req = new XMLHttpRequest();
req.open('GET', 'http://localhost/myRESTfulService/resource', false);    // throws 'undefined' exception
req.send(null);
if(req.status == 0)
  dump(req.responseText); 
```

open 语句引发异常，描述为“未定义”。这很奇怪，因为我分配了 req 对象，在 Firefox 中运行它，并在调用 open 之前检查以确保它已定义（它说它是“对象”类型）。

我也试过这个的异步版本，但没有运气。

**编辑2：**下面是我最近的代码：

```
function createRequestObject() {
    if( window.XMLHttpRequest ) {
        return new XMLHttpRequest();
    }
    else if( window.ActiveXObject ) {
        return new ActiveXObject( "Microsoft.XMLHTTP" );
    }

    return null;
}

function handleResponse( req ) {
    document.writeln( "Handling response..." );   // NEVER GETS CALLED
    if( req.readyState == 0 ) {
        document.writeln( "UNITIALIZED" );
    }
    else if( req.readyState == 1 ) {
        document.writeln( "LOADING" );
    }
    else if( req.readyState == 2 ) {
        document.writeln( "LOADED" );
    }
    else if( req.readyState == 3 ) {
        document.writeln( "INTERACTIVE" ); 
    }
    else if( req.readyState == 4 ) {
        document.writeln( "COMPLETE" );
        if( req.status == 200 ) {
            document.writeln( "SUCCESS" );
        }
    }
}

document.writeln( "" );
var req = createRequestObject();

try {
    document.writeln( "Opening service..." );
    req.onreadystatechange = function() { handleResponse( req ); };
    req.open('POST', 'http://localhost/test/test2.txt', true);  // WORKS IN IE8 & NOT FIREFOX

    document.writeln( "Sending service request..." );
    req.send('');

    document.writeln( "Done" );
}
catch( err ) {
    document.writeln( "ERROR: " + err.description );
} 
```

***编辑 3：***好的，我在 jQuery 中重新设计了这个。jQuery 在 IE 中运行良好，但从 Firefox 运行时会抛出“未定义”。我仔细检查并在 Firefox 中打开了“启用 JavaScript” - 似乎在所有其他网页中都可以正常工作。下面是jQuery代码：

```
function handleResponse( resp ) {
    alert( "Name: " + resp.Name );
    alert( "URL: " + resp.URL );
}

$(document).ready( function() {
    $("a").click( function(event) {

        try {
            $.get( "http://localhost/services/ezekielservices/configservice/ezekielservices.svc/test", 
                   "{}",
                   function(data) { handleResponse( data ); },
                   "json" );
        } 
        catch( err ) {
            alert("'$.get' threw an exception: " + err.description);
        }

        event.preventDefault();
    });
} );    // End 'ready' check 
```

**解决方案总结：**

好吧，网络课101。我的问题确实是跨域的。我正在查看未发布的网站（仅在文件系统上），该网站正在访问已发布的服务。当我在同一个域下发布我的网站时，它起作用了。

这也带来了 IE 和 Firefox 之间的重要区别。当IE遇到这种情况时，会提示用户是否接受跨域调用。Firefox 抛出异常。虽然我可以有一个例外，但更具描述性的例外会有所帮助。

感谢所有帮助过我的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T15:23:29.267

除非“ [http://www.mozilla.org/](http://www.mozilla.org/) ”是此请求的来源域，否则由于同源策略，这将不起作用

**编辑：** 好的，好的状态是 200，而不是 0。

请参阅[http://dogself.com/telluriumTest/](http://dogself.com/telluriumTest/)并单击“stackoverflow 测试”。它使用您的代码和工作。

特别是这段代码：

```
function test(){
    var req = new XMLHttpRequest();
    req.open('GET', 'index2.htm', false);    
    req.send(null);
    if(req.status == 200)
    alert("got some stuff back:"+req.responseText);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-01T18:00:33.517

发送同步请求时不要使用 onreadystatechange ('false')，将处理程序放在 send() 函数之后。如果请求是同步的，FF 似乎不会执行 onreadystatechange 函数。

[http://support.mozilla.com/tiki-view_forum_thread.php?locale=ca&comments_parentId=124952&forumId=1](http://support.mozilla.com/tiki-view_forum_thread.php?locale=ca&comments_parentId=124952&forumId=1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T15:47:01.077

我强烈推荐异步方式，一个函数启动请求，另一个函数处理响应。

```
function makeRequest() 
{
   var httpRequest;
   if (window.XMLHttpRequest) // firefox etc 
   {
       httpRequest = new XMLHttpRequest();
   } else if (window.ActiveXObject) { // ie
       httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
   }
   httpRequest.onreadystatechange = function(){handleResponse(httpRequest)};
   httpRequest.open('POST','http://localhost/test/test2.txt',true);
   httpRequest.send('');
}

function handleResponse(request)
{
    if(request.readyState == 4) {
        if(request.status == 200) {
        // handling code here
            // request.responseText is the string returned
        }
    }
} 
```

这是我们在我工作的地方使用的 ajax 调用的基本格式，这对于 Firefox、IE 和 Safari 应该是一样的。

旁注：你有萤火虫吗？它是解决 javascript 问题的绝佳资源。

编辑：试试这个代码：

```
<html>
<head>
<script>
function out(outStr) // cheap and dirty output function
{
    document.getElementById("out").innerHTML += "<br>" + outStr;
}

function handleResponse(req) {
    if( req.readyState == 0 ) {
        out("UNITIALIZED");
    }
    else if( req.readyState == 1 ) {
        out("LOADING");
    }
    else if( req.readyState == 2 ) {
        out("LOADED");
    }
    else if( req.readyState == 3 ) {
        out("INTERACTIVE"); 
    }
    else if( req.readyState == 4 ) {
        out("COMPLETE");
        if( req.status == 200 ) {
            out(req.responseText);
        }
    }
}

function createRequestObject() {
    var req = null  
    if(window.XMLHttpRequest) {
        req = new XMLHttpRequest();
    } else if(window.ActiveXObject) {
        req = new ActiveXObject("Microsoft.XMLHTTP");
    }
    return req;
}

function makeRequest()
{
    var req = createRequestObject();

    try {
        out("Opening service...");
        req.onreadystatechange = function() { handleResponse( req ); };
        req.open('POST', 'http://localhost/test/test2.txt', true);  // WORKS IN IE8 & NOT FIREFOX

        out("Sending service request...");
        req.send('');

        out("Done");
    }
    catch( err ) {
        out("ERROR: " + err.description);
    }
}
</script>
</head>
<body>
<div onclick="makeRequest();">test<br></div>
<div id="out">Output Here</div>
</body>
</html> 
```

点：[http://localhost/test/test2.txt](http://localhost/test/test2.txt)到您服务器上的现有文件。

不确定您的代码到底出了什么问题，但它正在直接写入文档，该文档似乎将所有已编写的代码都存放在那里。在这个版本中，我改为写一个 div。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T19:51:51.940

也不确定这里发生了什么，但只是想让大家知道 Mozilla 文档中的某个人正在观看此内容，以便在发现有必要时对文档进行调整。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-09T19:04:26.587

即使我有同样的问题，这是一个愚蠢的错误，我们不关注代码在 IE 中运行良好，但在 Chrome 和 Firefox 中出现问题

最初我们使用`Type="submit"`而不是`type="button"`虽然我们没有任何功能问题，例如更新表格，但是`HTTP: error 0`当我发出警报时我们进入了警报框`req.responseText` 使用下面的代码解决了我的问题

```
input type="button" name="btnEdit5" id="btnEdit5" value="Confirm" onClick="show_confirm()" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-19T14:44:11.073

除了客户端的所有明显错误外，主要原因是壁虎引擎在 servlet 的标头中查找 Access-Control-Allow-Origin。如果它没有找到它，它将中止通信并且你得到一个status=0 和statusText=null。此外，xml 解析错误中的 moz-nullprincipal。所有这些东西都非常具有误导性。解决此问题所需要做的就是：

```
response.setHeader("Access-Control-Allow-Origin","*"); 
```

在 servlet 代码中，生活会很好:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-11T22:17:20.810

换行

```
req.open('POST', 'http://localhost/test/test2.txt', true); // WORKS IN IE8 & NOT FIREFOX 
```

和

```
req.open('GET', 'http://localhost/test/test2.txt', true); // WORKS IN IE8 & NOT FIREFOX 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-23T23:57:14.317

我遇到了同样的问题。IE 可以工作而没有其他浏览器的原因是因为 IE 允许您使用“C:\xampp\htdocs\project3\project3.html”之类的 URL 打开文件，其他浏览器会将其更改为“file:///”之类的 URL C:/xampp/htdocs/project3/project3.html”。由于 PHP 文件的域必须与 javascript 文件的域相同，IE 可以工作，但其他浏览器则不能。确保使用“http://localhost/project3/project3.html”之类的 URL。请注意使用 localhost。还要确保在您的 javascript 调用中，您通过 localhost 调用 PHP 文件。

# php - 不一致的视频转换

> ID：916359
> 
> 赞同：0
> 
> 时间：2009-05-27T15:19:10.540
> 
> 标签：php, command-line, ffmpeg, exec

我有一个脚本调用命令来对上传的视频运行 ffmpeg 转换。但是，它仅在随机时间起作用。有时表单将完成提交并且 ffmpeg 进程将运行；在其他时候，ffmpeg 命令根本无法运行。这是我在 exec() 函数中运行的命令：

```
ffmpeg -i  "uploaded_file -b 450k  "converted_file" >/dev/null 2>&1 & 
```

谁能解释为什么这只适用于某些尝试而不适用于其他尝试？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T21:36:26.830

如果 ffmpeg 失败并抛出错误怎么办？现在你正在发送所有输出，`/dev/null`所以你永远不会知道。

更改`>/dev/null`为`>>/tmp/ffmpeglog` 保留日志

# apache - 使用 Mod-Rewrite 重定向时去除特定参数

> ID：916360
> 
> 赞同：0
> 
> 时间：2009-05-27T15:19:20.587
> 
> 标签：apache, .htaccess, mod-rewrite, redirect, parameters

我有一个非常复杂的 RewriteRule ，我需要检查 QueryString 中是否存在某些参数，然后重定向到相同的 URL，但这些参数被剥离。

如何删除一些参数并保留其余参数？

```
RewriteCond %{QUERY_STRING} color=red
RewriteCond %{QUERY_STRING} status=contiue
RewriteRule ^(.*)$ /$1? [R=301,L] 
```

网址就像：

```
"http://example.com/site.php?setup=done&color=red&weight=100&status=continue" 
```

（参数顺序和数量不可预测/硬编码）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T15:23:09.330

试试这些规则：

```
RewriteCond %{QUERY_STRING} ^(([^&]*&)*)(color=red|status=continue)($|&)(.*)
RewriteRule .* $0?%1%5 [N,E=REMOVED:true]
RewriteCond %{ENV:REMOVED} true
RewriteRule ^ %{REQUEST_URI} [L,R=301] 
```

另一种方法是使用 PHP 检查给定的参数并在那里删除它们。

# sql - 数据库模型结构

> ID：916367
> 
> 赞同：2
> 
> 时间：2009-05-27T15:21:40.240
> 
> 标签：sql, database

我有一个专栏*groups*。*组*在 group_types 中存储了不同的类型（买家、卖家、裁判）。只有当组是买方类型时，它才有另一种类型（更专业），如电气和机械。

我对如何将其存储在数据库中感到有些困惑。

有人可以建议我一个数据库结构吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T15:24:40.733

将您的存储`group_types`为分层表（带有`nested sets`或`parent-child`模型）：

`Parent-child`：

```
typeid 父名

1 0 买家
2 0 卖家
3 0 裁判
4 1 电气
5 1 机械师

```

```
SELECT  *
FROM    mytable
WHERE   group IN
        (
        SELECT  typeid
        FROM    group_types
        START WITH
                typeid = 1
        CONNECT BY
                parent = PRIOR typeid
        ) 
```

将选择 中的所有买家`Oracle`。

`Nested sets`：

```
typeid 小写名字
1 1 2 买家
2 3 3 卖家
3 4 4 裁判
4 1 1 电气
5 2 2 机械师

```

```
SELECT  *
FROM    group_types
JOIN    mytable
ON      group BETWEEN lower AND upper
WHERE   typeid = 1 
```

将选择任何数据库中的所有买家。

`Nested sets`如果您不需要分层排序或频繁更新`group_types`.

`Parent-child`在. `Oracle`_ `SQL Server`_ `MySQL`它允许简单的结构更改和分层排序。

请参阅我的博客中的这篇文章，了解如何在以下位置实现它`MySQL`：

*   [**分层查询`MySQL`**](http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T15:24:45.600

您可以存储其他类型，例如，`buyer_mechanical`或`buyer_electrical`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:27:40.740

你可以试试：

```
Group
group_id
group_name
group_parent_id

with entries (1, buyers, 0), (2, sellers, 0), (3, referee, 0), (4, electrical, 1), (5, mechanical, 1) 
```

这具有无限可扩展的优点，因此每个子组可以拥有任意数量的子组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:28:27.400

通常，您有扩展表。这些只是架构中的附加表，其中包含通过某种类型的键链接到主表的附加信息

例如，假设您的主表是：

```
People
  PersonId int, PK
  GroupTypeId int, FK to GroupTypes
  Name varchar(100)

GroupTypes
  GroupTypeId int, PK
  GroupTypeName varchar(20)

BuyerTypes
  BuyerTypeId int, PK
  BuyerTypeName varchar(20)

BuyerData
  PersonId int, FK
  BuyerTypeId int FK 
```

==== 此外，BuyerData 将在 PersonId 和 BuyerTypeId 上有一个复合主键 (PK)

提取买家数据时，您可以使用如下查询

```
SELECT *
  FROM People P 
    INNER JOIN BuyerData BD on (P.PersonId = BD.PersonId)
    INNER JOIN BuyerTypes BT on (BD.BuyerTypeId = BT.BuyerTypeId) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T15:36:38.260

grouptype: ID, Name ('buyers', 'sellers', 'referee')

group: GroupTypeID, ID, Name ('electrical' and 'mechanical' if grouptypeid == 'buyers')

联系人：GroupTypeID (NOT NULL)、GroupID (NULL)、其他属性

表组根据需要填充了 GroupTypes 的记录。

Contact.GroupID 可以为 NULL，因为 GroupType 不需要任何组。

UI 必须处理组选择。您可以让触发器检查组/类型逻辑。

# asp.net - 从 ASP.NET 应用程序打印日历或日记

> ID：916380
> 
> 赞同：1
> 
> 时间：2009-05-27T15:24:30.717
> 
> 标签：asp.net, printing, calendar, infragistics

我们有一个 ASP.NET 应用程序，它使用 Infragistics WebSchedule 控件以与 Outlook 相同的方式显示约会等。我们遇到的问题是客户希望能够打印出现在屏幕上的页面 - 控件本身似乎并不直接支持。

我们开发了一个水晶报表，它的工作还算不错，但它非常复杂，而且有点不稳定（它无法容纳特定日期的所有约会，所以如果有太多约会，它们就会溢出）。基本上，我们已经欺负了 Crystal 做一些它并不真正打算做的事情——渲染日记的图形表示，而不是以表格的方式列出数据。

有没有人有更好的选择？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:34:54.480

好吧，最后我决定在这种情况下丢弃水晶报表。它适用于表格数据和图形数据，但不适用于日记/调度程序的图形表示。

我选择了一个 XML/XSLT 解决方案，结果比我预期的要好——尤其是在速度方面。

我能够生成 XML 流，并根据日期范围将其提供给合适的 XSL 模板，该模板生成报告的每周或每月视图。一位同事在上面撒了一些 CSS，然后我们就整理好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-17T10:15:35.267

DayPilot Pro（我们的产品）支持 PNG 导出，可以轻松打印日历/日程安排（几乎是 HTML 控件的逐像素副本）。

它适用于日历（传统的类似于 Outlook 的日/周视图）：

[http://www.daypilot.org/demo/Calendar/](http://www.daypilot.org/demo/Calendar/)

对于调度程序（显示多个资源的时间线）：

[http://www.daypilot.org/demo/Scheduler/](http://www.daypilot.org/demo/Scheduler/)

尝试控件下方的**“打印/导出”按钮。**

# asp.net - 从 Microsoft 堆栈迁移到开源动态网站开发的最佳方式是什么？

> ID：916386
> 
> 赞同：2
> 
> 时间：2009-05-27T15:25:26.347
> 
> 标签：asp.net, open-source

我更熟悉 Microsoft 堆栈，并且对 ASP.NET 和 SQL 有一定的了解。

什么是学习和创建动态网站的最佳开源平台，专注于后端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T15:30:39.067

用于网站开发的[PHP](http://PHP.net)

用于数据库后端的[MySQL](http://mysql.com)（或[PostgreSQL ）。](http://postgresql.org)

都是开源的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:30:46.757

没有“最好的开源”之类的东西。有许多适合不同编程风格和个性的好方法。

今天一些比较流行的用于 Web 开发的开源语言是：

*   PHP
*   红宝石
*   Python

一些比较流行的开源数据库是：

*   PostgreSQL
*   MySQL

因为他们是免费的，所以给他们一个旋转，看看你喜欢什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:33:59.077

尝试从 dasBlog 开始。[您可以在](http://www.asp.net/learn/)[此处](http://www.asp.net/community/projects/)查看有关此项目的更多信息以及更多信息和视频

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:26:59.217

目前最流行的两个开源 webapp 平台是[Rails](http://rubyonrails.org/)和[Django](http://rubyonrails.org/)。他们都很棒，并且很高兴与他们一起工作。

# c# - 构建可扩展的 ASP.NET MVC Web 应用程序

> ID：916387
> 
> 赞同：7
> 
> 时间：2009-05-27T15:25:28.983
> 
> 标签：c#, asp.net, asp.net-mvc, queue, scaling

我目前正在用 c# 构建一个 ASP.NET MVC Web 应用程序。

我想确保构建此应用程序，以便将来可以横向扩展，而无需进行重大重构。

我非常热衷于使用某种队列将任何写入发布到我的数据库库，并有一个进程异步轮询该队列以执行更新。一旦这些数据被发送回数据库，客户端就需要使用新信息进行更新。这意味着根据服务器上执行的业务规则，将数据写回数据库的过程可能需要很短的时间。

我的问题是从客户端\浏览器的角度处理更新的最佳方式是什么。

我正在考虑将数据发送回服务器并将其添加到队列中并立即向客户端发送响应，然后以某种频率轮询以获取更新的数据。对此的任何最佳实践或模式将不胜感激。

此外，在从数据库读取数据方面，您是否建议使用任何特定技术，或者根据我的情况直接从 db 读取就足够了。

**更新** 我想我会发布一个更新，因为它已经有一段时间了。我们实际上最终使用了 Windows Azure，但该解决方案适用于其他平台。

我们最终做的是使用 Windows Azure 队列来发布消息\命令。这是一个非常快速的过程并立即返回。然后我们有一个工作角色，它在另一个线程上处理这些消息。这使我们能够最大限度地减少网络角色上的任何数据库写入\更新，理论上使我们能够更轻松地扩展。

我们会根据我们处理的数据类型，通过电子邮件甚至静默方式通知用户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T15:30:20.487

不确定这是否有帮助，但例如，为什么您不在页面上每 30 秒自动刷新一次。这有时就是新闻提要在体育网站上的工作方式，即页面将每 x 分钟更新一次。

```
<meta http-equiv="refresh" content="120;url=index.aspx">

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T23:16:53.103

为什么不让用户手动轮询请求的状态呢？这就是典型的电子商务应用程序的实现方式。当您在线购买商品时，订单会被提交到队列中等待完成。提交后，用户会看到一个“感谢您的订单”页面和一个可以检查订单状态的链接。用户可以随时访问链接查看状态，无需自动轮询机制。

您的情况与此有很大不同吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:49:54.700

对不起，在我之前的回答中，我可能误解了。我说的是“队列”作为存储在 SQL DB 中的东西，但似乎在再次阅读您的帖子时，您可能正在谈论一个单独的消息队列组件，如 MSMQ 或 JMS？

我永远不会在用户和后端 SQL DB 之间的前端放置消息队列。队列有利于跨时间扩展，这适用于后端组件之间，处理时间的差异是可以接受的（例如订单履行）......在与用户打交道时，这种差异通常是不可接受的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-09T02:21:34.693

虽然我不知道我是否同意原因的逻辑，但我知道像 jQuery 这样的东西会让你的生活变得更轻松。我建议制作一个您的客户端代码使用的 RESTful Web API。例如，您想向系统发布新订单并让客户响应？向 www.mystore.com/order/create 发帖，并让它返回新的 URI 以作为 URI (www.mystore.com/order/1234) 访问订单（即 order#）。然后将该响应存储在客户端代码中，并设置一个[jQuery 调用](https://stackoverflow.com/questions/1406580/jquery-ajax-polling-for-json-response-handling-based-on-ajax-result-or-json-cont)来轮询响应或停止轮询错误。

如需进一步阅读，请查看[这篇](http://en.wikipedia.org/wiki/Representational_State_Transfer)关于 REST 概念的 Wikipedia 文章。

此外，您可能会考虑[Reactive Extensions for .NET](http://msdn.microsoft.com/en-us/devlabs/ee794896.aspx)并在其中查看 RxJS 子项目，它有一些非常巧妙的方法来处理轮询问题，而不会导致您自己编写轮询代码。有趣的东西玩！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-09T02:57:13.957

也许您可以在 UI 中添加一个“待处理的交易”区域。当您对交易进行排队时，将其添加到用户的“待处理交易”列表中。

完成后，在用户下次请求新页面时在“待处理事务”列表中显示。

您可以将已完成的交易保持在列表中，直到用户单击它，或者在预定的时间长度内。

# c# - 发送内联 MHTML

> ID：916388
> 
> 赞同：2
> 
> 时间：2009-05-27T15:25:37.843
> 
> 标签：c#, .net, email, mhtml

我想知道是否可以通过 .NET 2.0 [MailMessage 对象](http://msdn.microsoft.com/en-us/library/system.net.mail.mailmessage.aspx)发送动态创建的内联 MHTML 文件。

内联我的意思是：它应该以用户可以看到的方式发送，一旦他打开电子邮件，而不必打开/下载附件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T13:46:57.717

（jdecuyper——感谢插件，因为我写了 aspNetEmail）。

您可以使用 aspNetEmail 执行此操作。您可以用您的 MHT 替换电子邮件的全部内容。

您无法使用 System.Net.Mail 执行此操作，但如果您想走商业路线，请发送电子邮件至 dave@advancedintellect.com，我将向您展示如何做到这一点。

如果您想走开源路线，您可以修改 codeproject 上的一些 SMTP 代码来执行此操作。基本上，您会将您的内容注入到 SMTP 进程的 DATA 命令中。

需要注意的一点：如果您的 MHT 文档包含嵌入的脚本、flash、activeX 对象或任何可能被邮件客户端阻止的东西，它可能不会呈现与您在浏览器中看到的相同的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T06:31:44.180

这有点棘手，但是是的，你可以做到。事实上，MailMessage 类只不过是系统的 CDO.Message 类之上的一个包装器，它可以做到这一点。您也可以使用 AlternateView 功能，它更简单：

```
MailMessage mailMessage = new MailMessage("me@me.com"
    ,"me@me.com"
    ,"test"
    ,"");
string ContentId = "wecandoit.jpg";
mailMessage.Body = "<img src=\"cid:" + ContentId + "\"/>";
AlternateView av = AlternateView.CreateAlternateViewFromString(mailMessage.Body
    ,null
    ,MediaTypeNames.Text.Html);
LinkedResource lr = new LinkedResource(@"d:\Personal\My Pictures\wecandoit.jpg");
lr.ContentId = ContentId;
lr.ContentType.Name = ContentId;
lr.ContentType.MediaType = "image/jpeg";
av.LinkedResources.Add(lr);
mailMessage.AlternateViews.Add(av);
SmtpClient cl = new SmtpClient();
cl.PickupDirectoryLocation = @"c:\test";
cl.DeliveryMethod = SmtpDeliveryMethod.SpecifiedPickupDirectory;
cl.Send(mailMessage); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T16:00:36.713

您是否尝试将一些图像添加到 html 电子邮件？

为此，您需要将图像嵌入到您的电子邮件中。我找到了一个[教程](http://www.codedigest.com/Articles/ASPNET/14_Email_with_Embedded_image_in_ASPNet_20.aspx)来用几行代码完成它。您也可以购买[aspnetemail](http://www.aspnetemail.com/)程序集。发送带有嵌入图像的电子邮件一直对我有很大帮助，如果出现任何问题，他们也有出色的支持团队。

请记住，嵌入图像会使您的电子邮件更重，但更好:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-16T16:52:46.107

可以通过 CDO.Message（必须添加到项目引用 COM 库“Microsoft CDO for Windows 2000 Library”）：

```
protected bool SendEmail(string emailFrom, string emailTo, string subject, string MHTmessage)
{
    string smtpAddress = "smtp.email.com";

    try
    {
      CDO.Message oMessage = new CDO.Message();

      // set message
      ADODB.Stream oStream = new ADODB.Stream();
      oStream.Charset = "ascii";
      oStream.Open();
      oStream.WriteText(MHTmessage);
      oMessage.DataSource.OpenObject(oStream, "_Stream");

      // set configuration
      ADODB.Fields oFields = oMessage.Configuration.Fields;
      oFields("http://schemas.microsoft.com/cdo/configuration/sendusing").Value = CDO.CdoSendUsing.cdoSendUsingPort;
      oFields("http://schemas.microsoft.com/cdo/configuration/smtpserver").Value = smtpAddress;
      oFields.Update();

      // set other values
      oMessage.MimeFormatted = true;
      oMessage.Subject = subject;
      oMessage.Sender = emailFrom;
      oMessage.To = emailTo;
      oMessage.Send();
    }
    catch (Exception ex)
    {
      // something wrong
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-16T16:43:36.563

可以通过 CDO.Message（必须添加到项目引用 COM 库“Microsoft CDO for Windows 2000 Library”）：

```
protected bool SendEmail(string emailFrom, string emailTo, string subject, string MHTmessage)
{
    string smtpAddress = "smtp.email.com";

    try
    {
      CDO.Message oMessage = new CDO.Message();

      // set message
      ADODB.Stream oStream = new ADODB.Stream();
      oStream.Charset = "ascii";
      oStream.Open();
      oStream.WriteText(MHTmessage);
      oMessage.DataSource.OpenObject(oStream, "_Stream");

      // set configuration
      ADODB.Fields oFields = oMessage.Configuration.Fields;
      oFields("http://schemas.microsoft.com/cdo/configuration/sendusing").Value = CDO.CdoSendUsing.cdoSendUsingPort;
      oFields("http://schemas.microsoft.com/cdo/configuration/smtpserver").Value = smtpAddress;
      oFields.Update();

      // set other values
      oMessage.MimeFormatted = true;
      oMessage.Subject = subject;
      oMessage.Sender = emailFrom;
      oMessage.To = emailTo;
      oMessage.Send();
    }
    catch (Exception ex)
    {
      // something wrong
    }
} 
```

# winapi - 有谁知道要传递给 dwmapi.dll 序号 #113 的参数是什么？

> ID：916392
> 
> 赞同：2
> 
> 时间：2009-05-27T15:26:31.680
> 
> 标签：winapi, windows-7

有谁知道要传递给 dwmapi.dll 序号 #113 的参数是什么？（Windows 7的）

我正在尝试将此方法合并到我正在编写的应用程序中。据我所知，这个方法负责为 Windows 做 Aero peek 事情。如果我不向该方法传递任何参数，它将显示所有打开的非最大化窗口的桌面和轮廓。当我尝试传递参数时没有任何反应——我已经通过反复试验完成了……主要是错误。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T15:32:21.980

不要这样做。它没有记录是有原因的，并且随时可能更改和/或删除。鉴于 Windows 7 尚未发布，您甚至无法保证它会出现在最终版本中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-22T14:19:50.153

我认为是因为并非所有 Windows 版本都支持 aeropeek，不支持家庭基本版，也许您可​​以实现自己的窗口 peek 或至少使用 alpha 透明度（同时绘制一些边框）来伪造它并使用窗口矩形查询底层窗口坐标像矩形碰撞检测算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T15:39:53.103

您的标签不一致。API 是应用程序编程接口。Ordinal #113 未记录，因为它不是应用程序接口的一部分。它可能存在是因为操作系统本身需要它，或者因为当前的 RC 尚未完成删除它等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-26T06:19:37.177

好吧，我曾经用 AeroPeek 功能模仿 Alt-Tab。

```
using System.Runtime.InteropServices;
...   
[DllImport("dwmapi.dll", EntryPoint = "#113", SetLastError = true)]
            internal static extern uint DwmpActivateLivePreview(uint a, IntPtr b, uint c, uint d);
...
//To call it
IntPtr peekHwnd = //<-- here goes the application Handle to aeropeek
//to enable
DwmpActivateLivePreview(1, peekHwnd, 0, 1);
...
//to disable
DwmpActivateLivePreview(0, peekHwnd, 0, 1); 
```

小心使用它，因为许多评论告诉你它由于某种原因没有记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T06:27:12.640

应用程序无法激活 Aero Peek 是有原因的——用户可以选择何时发生这种情况，而不是您。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T21:36:57.830

请阅读[Raymond Chen 的博客](http://blogs.msdn.com/oldnewthing/)，直到您意识到这是一个非常非常非常糟糕的主意！

# windows - 是否可以使用 Windows 2003 之前的操作系统推出我自己的 Amazon 系统映像？

> ID：916401
> 
> 赞同：0
> 
> 时间：2009-05-27T15:27:38.103
> 
> 标签：windows, amazon-ec2, amazon, amazon-ami

我一直在 Amazon Web Services 和网站上研究 EC2：

> “您还可以使用我们的捆绑工具上传您自己的操作系统。”

现在我一直在尝试找出唯一受支持的 Windows 版本是否是 Windows Server 2003，或者我是否能够虚拟化旧版本的 Windows 并将其混搭到 AMI 中？

那可能吗？有人实现了吗？

感谢您 SOer 可以提供的所有帮助。

乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-23T18:43:28.997

EC2 只允许您捆绑自己的开源 *nix 操作系统。由于许可问题，他们不会让您运行自己的 Windows 副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T18:45:57.903

仅当您使用 vmware 加载 *nix 平台时才将 windows 加载到 vm

# java - 如何将不同的并发策略分配给同一个（持久性）实体？

> ID：916407
> 
> 赞同：2
> 
> 时间：2009-05-27T15:28:35.950
> 
> 标签：java, hibernate, caching, concurrency

我正在使用 JPA，并且我正在为所有引用实体使用二级缓存。一切正常，我可以从二级缓存中获取实体，前提是它们之前已经被选中。

现在，我有两个应用程序，它们都使用相同的数据库（因此它们都使用相同的表、值等）。1.只读应用程序只是从数据库中读取数据，它根本不修改数据库。因此，我对二级缓存选择了**“READ_ONLY”并发策略，目的是为了获得更好的性能。**2.读写应用程序读写数据库数据，修改数据库。因此，我不得不为二级缓存选择**“READ_WRITE”或“NONSTRICT_READ_WRITE”并发策略**。

但是，并发策略是在每个实体类的注释中分配的，因此我无法以编程方式对其进行更改。（我不使用 JPA 的类映射文件，所以我不能使用两个映射文件，每个映射文件用于同一个实体类的不同并发策略。）

我的问题是，**有没有一种好方法可以根据我的 2 个不同的应用程序动态更改二级缓存的并发策略？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T20:06:59.150

我没有使用过 Hibernate，但至少如果您使用 JPA，甚至可以使用部署描述符文件覆盖单个注释。您还应该能够使用部署描述符覆盖任何供应商特定的属性。

不幸的是，我不能给你一个例子，但希望这对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T09:45:55.457

因此，我认为目前的解决方案是将每个实体的所有注解替换为 Hibernate 映射文件，这样对于不同的部署（也包括应用程序），我们可以使用不同的 Hibernate 映射文件。

# ruby-on-rails - 对于存储在 CVS 中并用于 Linux 服务器的 Rails 应用程序，最简单的部署/回滚方案是什么？

> ID：916408
> 
> 赞同：0
> 
> 时间：2009-05-27T15:28:54.357
> 
> 标签：ruby-on-rails, deployment, cvs

我有一个存储在 CVS 中的 Rails 应用程序，因为这是我们的公司标准。它需要部署到使用 Apache 和 Phusion Passenger 运行 Rails 的单个生产服务器上。

关于生产服务器：

*   红帽企业 Linux 5.1
*   该应用程序在我们公司内部使用，而不是在外部托管。
*   我有 root 访问权限，可以安装必要的软件。
*   我可以通过 ssh 访问该框，如果需要也可以在那里运行 cvs。

当前解决方案：

为此，我一直在使用 capistrano 的修补版本（几个 CVS 修复），但这有点过头了。（我查看了部署程序 vlad，但它不支持 CVS。）我想要一些更简单的东西，依赖项/补丁更少。

所需的解决方案：

*   我希望部署是一个检查 CVS 树的尖端并部署它的命令。
*   我希望回滚是恢复到以前安装的版本的单个命令。
*   几个 Rakefile 任务，或者一个 shell 脚本就可以了。
*   发布需要是唯一可识别的——通过时间戳、CVS 标签或某种版本号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:49:16.753

Capistrano 是当前 Rails 应用程序部署的黄金标准；如果你已经让它工作了，你为什么要改变它？

# vim - 在vim中轻松打开包含文件名？

> ID：916409
> 
> 赞同：5
> 
> 时间：2009-05-27T15:29:29.053
> 
> 标签：vim, text-editor

基本上，我正在编辑包含文件名的文件，并且我想要一种快速打开文件的方法，而无需键入路径/文件名：

```
include('inc/doctype.inc.php'); 
```

是否有捷径可寻？（理想情况下，我想使用 :tabnew 在新选项卡中打开文件。）

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T15:34:47.077

使用`g``f`快捷方式。将光标移动到路径字符串上，确切的光标位置并不重要，然后`g``f`在正常模式下按下。`g``f`代表“ **g** oto**文件**”。
请参阅 vims 帮助页面`:h gf`：

> 使用“ **isfname** ”选项找出文件名中应该包含哪些字符。尾随标点符号“.,:;!” 被忽略。使用“**路径**”选项作为目录名称列表来查找文件。还查找相对于当前文件的文件。使用 ' **suffixesadd** ' 选项来检查添加了后缀的文件名。如果找不到该文件，则使用“ **includeexpr** ”来修改名称并进行另一次尝试。

要返回，请`Ctrl-o`在正常模式下使用。
*注意：*此命令将光标位置带到跳转列表中较旧的位置。相反的命令是`Ctrl-i`将光标带到跳转列表中的较新位置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T15:36:31.037

将光标放在文件名上，然后`Ctrl+w``g``f`

`:h ctrl-w_gf`

# ruby-on-rails - 如何建模多博客网站？

> ID：916412
> 
> 赞同：2
> 
> 时间：2009-05-27T15:29:54.763
> 
> 标签：ruby-on-rails, database-design

我有这些表：

```
**Sites**
:has_many :blogs
:has_many :pages

**Blogs**
:belongs_to :site

**Pages**
:belongs_to :site
:belongs_to :blog 
```

基本上，我希望能够创建与站点相关或与具有如下路线的博客相关的页面：

```
/blogs/1/pages/1
/sites/1/pages/2 
```

使用我当前的设置，我的 Pages 表有一个用于 blog_id 和 site_id 的 foreign_key - 我只是想这样做：

*   如果正在为站点创建页面（意味着它不属于博客），则将 blog_id = 设置为 NULL，但相应地设置 site_id

*   但是，如果正在为博客（已经属于某个站点）创建页面，则设置相关的 site_id 和 blog_id

然后，如果我想要一个站点页面列表：我可以在 Pages 表中查询所有 NULL blog_ids，如果我想要博客页面，我将通过与博客的关系来获取它们。

更新：我接受了下面建议使用“多态关联”的答案，但这也可以使用单表继承来完成吗？如果是这样，哪种方法更好？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T20:54:48.553

您可以使用多态关联。

向表中添加外键和类型列`pages`。找到一个描述您的页面可以属于的类的共同属性的形容词。我想出了`pageable`（这给了我一个`pageable_id`和`pageable_type`专栏）。如果您使用迁移，请添加以下`Page`迁移：

```
# Adds "pageable_id" integer column and "pageable_type" string column.
t.references(:pageable, :polymorphic => true) 
```

在您的模型中，使用`has_many`/时指定多态关系`belongs_to`：

```
class Site < ActiveRecord::Base
  has_many :pages, :as => :pageable
end

class Blog < ActiveRecord::Base
  has_many :pages, :as => :pageable
end

class Page < ActiveRecord::Base
  belongs_to :pageable, :polymorphic => true
end 
```

瞧：

```
# Return all pages belonging to Site with ID 12, that is, return all pages
# with pageable_id 12 and pageable_type "site".
Site.find(12).pages

# Return all pages belonging to Blog with ID 3, that is, return all pages
# with pageable_id 3 and pageable_type "blog".
Blog.find(3).pages

# Returns the owner (Blog or Site) of Page with ID 27.
Page.find(27).pageable 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:55:46.540

您应该查看多态关联：[http ://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

基本上，您走在正确的轨道上，但是您正在尝试做的事情有一个现有的模式。

# batch-file - 我的批处理文件中的用户输入问题

> ID：916413
> 
> 赞同：3
> 
> 时间：2009-05-27T15:29:56.853
> 
> 标签：batch-file, user-input, if-statement

这是给我带来麻烦的代码部分：

```
IF EXIST TH_BUILD_* (
ECHO A current build of Test Harness exists.
set /p delBuild=Delete preexisting build [y/n]?: 
if "%delBuild%"=="y" (GOTO deleteandcontinue) else ( EXIT)
) 
```

出于某种原因，无论输入如何，批处理文件都会退出。为什么会发生这种情况（永远无法达到删除和继续）？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T16:33:39.097

测试时尝试使用延迟扩展`delBuild`：

```
setlocal enableextensions enabledelayedexpansion

IF EXIST TH_BUILD_* (
    ECHO A current build of Test Harness exists.
    set /p delBuild=Delete preexisting build [y/n]?: 
    if "!delBuild!"=="y" (
        GOTO deleteandcontinue
    ) else (
        exit
    )
)

:deleteandcontinue
@echo At deleteandcontinue 
```

`%var%`读取命令时扩展变量。括号之间的命令集被视为单个命令，因此`delBuild`在您进行测试时不存在。使用延迟扩展，变量在命令执行时被扩展，所以在测试的时候，`delBuild`有一个值。

# sql - LEFT OUTER JOIN 如何返回比左表中更多的记录？

> ID：916414
> 
> 赞同：221
> 
> 时间：2009-05-27T15:30:11.440
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我有一个非常基本的 LEFT OUTER JOIN 来返回左表中的所有结果以及来自更大表的一些附加信息。左表包含 4935 条记录，但是当我将其 LEFT OUTER JOIN 连接到另一个表时，记录数要大得多。

据我所知，LEFT OUTER JOIN 将返回左表中的所有记录以及右表中匹配的记录以及任何无法匹配的行的空值，这绝对是福音，因此我的理解是它应该不可能返回比左表中存在的行更多的行，但它的发生都是一样的！

SQL查询如下：

```
SELECT     SUSP.Susp_Visits.SuspReason, SUSP.Susp_Visits.SiteID
FROM         SUSP.Susp_Visits LEFT OUTER JOIN
                      DATA.Dim_Member ON SUSP.Susp_Visits.MemID = DATA.Dim_Member.MembershipNum 
```

也许我在语法上犯了错误，或者我对 LEFT OUTER JOIN 的理解不完整，希望有人能解释这是怎么发生的？

后记

感谢您提供出色的答案，我对 LEFT OUTER JOINS 的理解现在好多了，但是有人可以建议一种可以修改此查询的方法，以便我只返回左表中存在的尽可能多的记录吗？

此查询纯粹是为了生成报告，重复匹配只会使事情变得混乱。

/后记

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2009-05-27T15:32:47.283

LEFT OUTER JOIN 将返回 LEFT 表中的所有记录，并尽可能与 RIGHT 表连接。

如果有匹配，它仍然会返回所有匹配的行，因此，LEFT 中的一行匹配 RIGHT 中的两行将返回为两个 ROWS，就像 INNER JOIN 一样。

编辑：作为对您的编辑的回应，我刚刚进一步查看了您的查询，看起来您只是从 LEFT 表中返回数据。因此，如果您只需要 LEFT 表中的数据，并且只希望 LEFT 表中的每一行返回一行，那么您根本不需要执行 JOIN，直接从 LEFT 表中执行 SELECT 即可。

* * *

## 回答 #2

> 赞同：158
> 
> 时间：2009-05-27T15:38:26.057

```
Table1                Table2
_______               _________
1                      2
2                      2
3                      5
4                      6

SELECT Table1.Id, 
       Table2.Id 
FROM Table1 
LEFT OUTER JOIN Table2 ON Table1.Id=Table2.Id 
```

结果：

```
1,null
2,2
2,2
3,null
4,null 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2009-05-27T15:33:25.020

这并非不可能。左表中的记录数是它将返回的最小记录数。如果右表有两条记录匹配左表中的一条记录，它将返回两条记录。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-05-27T15:57:41.447

回应你的附言，这取决于你想要什么。

因为连接条件有多个匹配项，所以左表中的每一行都获得（可能）多行。如果您希望总结果的行数与查询左侧的行数相同，则需要确保您的连接条件导致一对一匹配。

或者，根据您实际想要的内容，您可以使用聚合函数（例如，如果您只需要右侧部分的字符串，您可以生成一列，该列是左侧结果的逗号分隔字符串。

如果您只查看外连接中的 1 或 2 列，您可能会考虑使用标量子查询，因为您将得到 1 个结果。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-05-27T15:33:25.287

左表中的每条记录将返回与右表中匹配记录一样多的次数——至少 1 条，但很容易超过 1 条。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-05-27T15:32:55.550

左右表之间可能是一对多的关系吗？

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-05-27T15:34:33.427

LEFT OUTER JOIN 就像 INNER JOIN（普通连接）一样，将为左表中的每一行返回与在右表中找到的匹配数一样多的结果。因此，您可以获得很多结果 - 最多 N x M，其中 N 是左表中的行数，M 是右表中的行数。

在 LEFT OUTER JOIN 中始终保证最少结果数至少为 N。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-05-27T15:57:35.127

如果您只需要右侧的任何一排

```
SELECT SuspReason, SiteID FROM(
    SELECT SUSP.Susp_Visits.SuspReason, SUSP.Susp_Visits.SiteID, ROW_NUMBER()
    OVER(PARTITION BY SUSP.Susp_Visits.SiteID) AS rn
    FROM SUSP.Susp_Visits
    LEFT OUTER JOIN DATA.Dim_Member ON SUSP.Susp_Visits.MemID = DATA.Dim_Member.MembershipNum
) AS t
WHERE rn=1 
```

要不就

```
SELECT SUSP.Susp_Visits.SuspReason, SUSP.Susp_Visits.SiteID
FROM SUSP.Susp_Visits WHERE EXISTS(
    SELECT DATA.Dim_Member WHERE SUSP.Susp_Visits.MemID = DATA.Dim_Member.MembershipNum
) 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-09-06T09:58:03.010

请注意，如果在包含左外连接的查询的“右侧”表上有 where 子句...如果右侧没有满足 where 子句的记录，则“左侧”的相应记录' 表将不会出现在您的查询结果中......

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-27T15:32:56.660

似乎每个 SUSP.Susp_Visits 行的 DATA.Dim_Member 表中有多行。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-27T15:33:38.937

如果 Dim_Member 中的多 (x) 行与 Susp_Visits 中的单行相关联，则结果集中将有 x 行。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-15T16:38:00.800

由于左表包含 4935 条记录，我怀疑您希望您的结果返回 4935 条记录。试试这个：

```
create table table1
(siteID int, 
SuspReason int)

create table table2
(siteID int, 
SuspReason int)

insert into table1(siteID, SuspReason) values 
(1, 678), 
(1, 186), 
(1, 723)

insert into table2(siteID, SuspReason) values 
(1, 678),
(1, 965)

select distinct t1.siteID, t1.SuspReason
from table1 t1 left join table2 t2 on t1.siteID = t2.siteID and t1.SuspReason = t2.SuspReason

union 

select distinct t2.siteID, t2.SuspReason 
from table1 t1 right join table2 t2 on t1.siteID = t2.siteID and t1.SuspReason = t2.SuspReason 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-09-09T07:29:11.097

您的查询将返回比左表（`SUSP.Susp_Visits`在您的情况下）更多的行数的唯一方法是条件（`SUSP.Susp_Visits.MemID = DATA.Dim_Member.MembershipNum`）匹配右表中的多行，即`DATA.Dim_Member`. 因此，在 中`DATA.Dim_Member`存在相同值的多行`DATA.Dim_Member.MembershipNum`。您可以通过执行以下查询来验证这一点：

`select DATA.Dim_Member.MembershipNum, count(DATA.Dim_Member.MembershipNum) from DATA.Dim_Member group by DATA.Dim_Member.MembershipNum`

# c# - 用于 Microsoft SQL Server、Oracle、MySQL 和 DB2 的 C# 数据库抽象

> ID：916425
> 
> 赞同：5
> 
> 时间：2009-05-27T15:32:27.097
> 
> 标签：c#, mysql, oracle, sql-server-2005

我需要一个抽象数据库的示例 C# 源代码（只需最少的代码修改即可轻松地从一个数据库更改为另一个数据库）。你知道一些高质量的示例网站或教程吗？

具体目标数据库如下：
1\. Microsoft SQL Server
2\. Oracle
3\. MySQL
3\. DB2

我的具体要求和遇到的问题如下：
1\. 数据访问中使用的类的抽象。
2.调用存储过程时使用参数。在 Microsoft SQL Server @ 中很好。其他数据库不支持@。
3\. 将查询语法从一个数据库转换到另一个数据库。我们是否有某种“通用”查询，然后创建一些生成查询到目标数据库的类？
4\. 数据访问层中的严格类型数据集。我从经验中记得 Visual Studio 的 TableAdapter 和 Query 向导在 MySQL 上失败了。

提前感谢您的专业知识和时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T15:36:35.840

看一下

*   [LLBLGEN](http://www.llblgen.com/)（商业）
*   [NHibernate](https://www.hibernate.org/343.html)（免费）
*   [我的世代](http://www.mygenerationsoftware.com/)（免费）
*   [NetTiers](http://nettiers.net/)（免费）

和其他 ORM

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T15:46:35.757

虽然我强烈推荐[NHibernate](https://www.hibernate.org/343.html)，但您可能还想查看[Microsoft 企业库](http://www.codeplex.com/entlib)的数据访问应用程序块。

当然，任何 ORM 都应该提供您需要的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-08T14:03:03.633

解决这个问题的最好方法是使用数据库提供者提供的接口；它们在功能上几乎是平行的。创建一个静态工厂类，根据配置的数据库为命令适配器、数据适配器和连接创建接口。例如：

```
 public static IDbDataAdapter GetDataAdapter (Database db)
    {
        switch (db)
        {
            default:
            case "MsSql":
                return new SqlDataAdapter ();
            case "MySql"
                return new MySqlDataAdapter ();
        }
    }

    public static IDbCommand GetCommand (Database db)
    {
        switch (db)
        {
            default:
            case "MsSql":
                return new SqlCommand ();
            case "MySql"
                return new MySqlCommand ();
        }
    } 
```

您的客户端代码不会知道其中的区别，尽管它必须传递配置字符串。使用 VS 文档检查您通常使用的每个对象提供的接口，并坚持使用这些接口，这将非常简单——尽管您可能不得不通过一些事情来破解。

# php - 为什么这个 php 循环不起作用？

> ID：916434
> 
> 赞同：0
> 
> 时间：2009-05-27T15:33:52.960
> 
> 标签：php, for-loop, if-statement

我有这个代码：

```
$thisTime = gmmktime(0, 0, 0);  
            for($i=0; $i<=95; $i++)
           {  
                $perfTimeNumber = ($i+1);  
                $perfTimestamp = $thisTime;  
                $perfTime = date("H:i", $perfTimestamp);           
        echo '<option value="'. $perfTimeNumber .'" selected="'.$sel.'">' .$perfTime .'</option>';   
                $thisTime = $thisTime+(15*60);
            } 
```

这可以很好地生成一个选择输入，其中包含从 01:00 到 24:45 的选项，间隔为 15 分钟。但是，如果我更改代码并添加一个 if 语句，我会得到一些奇怪的结果......

```
$thisTime = gmmktime(0, 0, 0);

            for($i=0; $i<=95; $i++)
            {
                $perfTimeNumber = ($i+1);
                $perfTimestamp = $thisTime;
                $perfTime = date("H:i", $perfTimestamp);
                if ($perfTime == '19:30') {
                    $sel = "selected";
                }
        echo '<option value="'. $perfTimeNumber .'" selected="'.$sel.'">' .$perfTime .'</option>';

                $thisTime = $thisTime+(15*60);
            } 
```

这个想法是（任意！）使选择输入默认为 19.30。上面的代码添加
`selected = "selected"`到 19:30 之后的每个选项，而不仅仅是 19:30 选项。如果我将 if 语句稍微更改为 `if ($perfTime = '19:30') { ...`ie，则使用单个`=`而不是`==`它会创建一组选项，所有选项的值都为 19:30。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T15:38:01.547

简短回答：因为每个回显操作都使用 $sel 的当前值。我假设它最初是空白的，所以前 N 个回声包含 selected=''。如果测试成功，$sel 被设置为“selected”，之后的每一次打印都包含 selected='selected'。如果你使用 $perfTime = '19:30'，它是一个赋值，所以测试总是成功，并且 $sel 总是被“选中”。

快速修复：添加设置 $sel = '' 的 else 子句。然而，还有其他奇怪的东西让我认为这只是一个代码片段（即总是使用 $thisTime 作为 $perfTimestamp ，而不是循环索引的东西，所以它总是在同一时间打印？）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T15:38:29.020

这是因为你从不重置`$sel`。

试试这个：

```
$sel = $perfTime == '19:30' ? 'selected' : ''; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:39:41.013

`$sel`没有在任何地方显式初始化，因此它为每次循环运行保持其“选定”值。

尝试`$sel = "";`作为循环中的第一行作为快速修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:40:25.130

嗯，可能是你应该这样做：

```
...
if ($perfTime == '19:30') {
  $sel = 'selected="selected"';
}else{
  $sel = "";  
}
... 
```

我认为只有存在“选定”属性才能使其被选中。

糟糕，我忘记了：还有

```
 echo '<option value="'. $perfTimeNumber .'" '.$sel.'>' .$perfTime .'</option>'; 
```

# python - 如何在 PythonCard 中处理 mouseMiddleDrag 事件？

> ID：916435
> 
> 赞同：1
> 
> 时间：2009-05-27T15:33:55.050
> 
> 标签：python, user-interface, wxpython, mouse, pythoncard

我想使用鼠标中键在用 Python 编写的应用程序中拖动图像，并使用 PythonCard/wxPython 作为 GUI。

最新版本的 PythonCard 仅实现“鼠标左键拖动”事件，我正在尝试修改 PythonCard 以处理“鼠标中键拖动”。

这是来自 Lib\site-packages\PythonCard\event.py 的相关代码：

```
class MouseMoveEvent(MouseEvent, InsteadOfTypeEvent):
    name = 'mouseMove'
    binding = wx.EVT_MOTION
    id = wx.wxEVT_MOTION

    def translateEventType(self, aWxEvent):
        if aWxEvent.Dragging():
            return MouseDragEvent.id
        else:
            return self.id

class MouseDragEvent(MouseMoveEvent):
    name = 'mouseDrag'
    id = wx.NewEventType()

class MouseMiddleDragEvent(MouseMoveEvent): #My addition
    name = 'mouseMiddleDrag'
    id = wx.NewEventType() 
```

我的添加不起作用。我能做些什么呢？是否有可以用来绕过 PythonCard 的特定 wxPython 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:01:59.847

事实证明，无论按下鼠标上的哪个按钮，*mouseDrag事件都是活动的。*要过滤鼠标中键，您需要从*MouseEvent调用**MiddleIsDown()*方法。

 *```
def on_mouseDrag( self, event ):       
    do_stuff()

    if event.MiddleIsDown():
        do_other_stuff() 
```

# apache-flex - Flex 消息安全

> ID：916437
> 
> 赞同：1
> 
> 时间：2009-05-27T15:34:01.120
> 
> 标签：apache-flex, messaging, blazeds

我正在尝试为 flex 应用程序创建一个模块，并且我想向客户端发送通知。我一直在寻找 BlazeDS 消息服务来向客户端推送通知，但我希望能够向某些客户端发送某些更新。Flex 通知框架似乎不允许这样做 - 例如，如果我们在消息中有一个具有用户用户 ID 值的字段，那么理论上任何客户端都可以订阅任何给定用户 ID 的所有消息，并且没有验证服务器端以确保已订阅的客户端以该用户 ID 登录。

我在这里错过了什么，还是在客户端编写我自己的轮询机制来处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T18:06:55.663

API 中确实有一个解决方案。第一步是编写一个扩展 FlexClientOutboundQueueProcessor 类的类。您需要覆盖一种方法：

```
public void add(List outboundQueue, Message message); 
```

基本上，您需要做的就是编写一些逻辑来确定是否应该进行以下调用：

```
outboundQueue.add(message) 
```

简单来说，如果你不把消息加入队列，那么消息就不会被推送到客户端。这个类中另一个重要的方法是：

```
FlexClient getFlexClient() 
```

您可以使用它来获取关联的 FlexSession 以及最终可能存在于您的应用程序中的身份验证信息。

完成此操作后，您只需使用适当的通道注册处理器。只需在“channel-definition”元素的“properties”元素中添加这个元素：

```
<flex-client-outbound-queue-processor class="com.foo.YourProcessor"/> 
```

我相信您也可以为队列处理器指定一个嵌套的“属性”元素，但我认为这不是必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-28T15:58:52.657

只要您[禁用通配符订阅](http://www.jamesward.com/blog/2009/07/22/protected-messaging-in-flex-with-blazeds-and-lcds)，您就可以为此使用子主题。

# bug-tracking - 查询与用户相关的所有工单的 Trac

> ID：916438
> 
> 赞同：2
> 
> 时间：2009-05-27T15:34:05.783
> 
> 标签：bug-tracking, trac

如何查询与用户相关的所有 trac 票证。即所有票证曾经被分配、现在分配、创建等等等等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T08:51:08.423

创建对`ticket_change`表的自定义查询。需要一些 SQL。对于分配一次/现在，查找其中`field='owner'`,`newvalue`列包含票证分配到的用户名的行。对于已创建的工单，只需`reporter`在`ticket`表中查询即可。

例子：

```
SELECT p.value AS __color__,
   id AS ticket, summary, component, version, milestone,
   t.type AS type, priority, t.time AS created,
   changetime AS _changetime, description AS _description,
   reporter AS _reporter
  FROM ticket t, enum p, ticket_change c
  WHERE p.name = t.priority AND p.type = 'priority'
  AND c.field = 'owner'
  AND c.newvalue = '$USER'
  AND c.ticket = t.id
  ORDER BY p.value, milestone, t.type, t.time 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T09:20:15.387

您可以使用[TraqQuery 表达式](http://trac.edgewall.org/wiki/TracQuery)来表达这一点。例如，如果您希望列 id、summary 和 status 显示并查询当前登录用户 ($USER) 的所有票证，则使用以下查询。

```
query:?col=id
&
col=summary
&
col=status
&
owner=$USER 
```

但是，此查询假定`owner`在票证的生命周期内 没有相同（因为可以更改所有权）。

如果您想要特定用户，请替换`$USER`为实际用户名。此外，如果您使用[Agilo 插件](http://www.agile42.com/cms/pages/agilo/)，您可以通过 web-UI 轻松创建新的查询。这是通过查看报告并向报告添加过滤器来完成的。

# asp.net - 第三方电子邮件发件人

> ID：916440
> 
> 赞同：3
> 
> 时间：2009-05-27T15:34:09.510
> 
> 标签：asp.net, email, email-client

我正在从我的 asp.net 应用程序发送电子邮件，我想看看是否有人可以推荐一个实际发送电子邮件的第三方。理想情况下，他们应该有某种可用的网络服务，我可以向其发送请求。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T19:01:20.543

麦克风，

看看下面的一些。他们有你的应用程序可以与之交互的可能对你有用/感兴趣的 API。我相信还有其他人，几个月前我经历了大约 5-10 家供应商，而这三个是我坚持的。

他们为您发送电子邮件到您的列表，并为您提供通过、查看、订阅、取消订阅等内容的列表。他们服务的最佳部分是他们与主要电子邮件提供商（hotmail、yahoo、 gmail 等），因此您的电子邮件不会最终进入垃圾邮件箱。

如果您想通过这些自动发送电子邮件，我很确定您可以编写一个 http 代理来与网站进行交互，如果它在 API 中不是您想要的那样。

www.constantcontact.com www.icontact.com www.mailchimp.com

每个都有其细微的差异，应该为您提供所需的起点。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:56:59.777

我过去曾使用[http://www.authsmtp.com](http://www.authsmtp.com)作为 SMTP 服务器。这在从 Amazon EC2 实例发送时特别有效。让其他人管理黑名单问题等真是太好了。您应该知道，尽管他们的服务对使用的唯一“发件人”地址的数量有限制（[当然可以升级](http://www.authsmtp.com/auth-smtp/pricing.html)）。

非常容易使用标准 System.Net.Mail API，只需在 web.config 中指定一个 smtp 服务器

```
 <system.net>
    <mailSettings>
      <smtp deliveryMethod="network">
        <network 
          host="mail.authsmtp.com" 
          port="2525" 
          defaultCredentials="false" 
          userName="ac55555" 
          password="your-password-here" />
      </smtp>
    </mailSettings>
  </system.net> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-06T21:40:12.507

我过去合作过的一些公司包括：Responsys、Acxiom Digital、PeopleSoft、Seibel、Eloqua、Marketo、Constant Contact、Blue Hornet、Mail Chimp 和 Exact Target。

我可以直接验证的唯一一个 API 是 Responsys，它实际上允许您在不登录并通过其 UI 手动执行某些操作的情况下发送电子邮件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T17:36:33.940

麦克风

我认为您必须查看您从应用程序发送的邮件类型。如果只是用户注册网站时带有密码的邮件，或者偶尔从桌面应用程序发送提醒，那么请坚持使用您的企业 ISP 和那里的 SMTP 服务器。只需使用 System.Net.Mail 编写您自己的邮件程序。

另一方面，如果您定期向数千人发送大量邮件，那么您必须至少关注两件事：

1.  没有将您的网址列入黑名单。
2.  发送邮件的百分比

就这两件事，专业的邮件提供商可以做得比其他任何人都好。除此之外，该提供商还为您提供了许多其他好处，例如报告、点击率等。我将[www.Aweber.com](http://www.aweber.com)用于我自己的业务，并且多年来一直非常满意。对于一个客户，我已经从[www.Getresponse.com](http://www.getresponse.com/)实施了这项服务，它们也很棒。

我相信这两个是业内最好的，被很多营销人员使用，我知道 Getresponse 有一个你可以编程的 api。

如果你想支持我 - 这是我的附属链接：

[www.Aweber.com](http://www.aweber.com/?213642)

[www.Getresponse.com](http://www.getresponse.com/index/ap3000)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-07T16:57:28.153

我想我明白你的问题可能是什么。我有一个我推销的软件程序，我想向数千人发送新闻通讯。

最初，我[从 Pensaworks 购买了 Spd E-Letter](http://www.pensaworks.com/newsletter_software.asp)。它是一个使用 Access 或 SQL Server 的 ASP 脚本。我将它与我的网站一起安装，并且因为提供了所有 ASP，所以我可以根据需要添加自定义项。

像这样的解决方案的好处在于您可以控制自己的数据。您没有将数据存储在其他人的数据库中。如果出于任何原因，他们切断了您的联系，第三方将不会将您的数据还给您。

几年来它对我来说效果很好......直到我改变了网络主机并且新网络主机的 SMTP 限制太低了。ISP 一次将批次限制为 50 封电子邮件（我认为这是数量），并且不允许我每小时发送超过几百封电子邮件。

我查看了该服务的数十家第三方提供商，从 ConstantContact 到 Bravenet 再到其他所有人。如果您要选择一个，那么大多数营销大师使用的是 AWeber 和 GetResponse。他们都按月收取费用，随着您数量的增加而增加，最终会花费您一大笔零钱，因此您最好从邮件中获得可观的收入以使其物有所值。

切换到这样的服务可能会令人沮丧。他们中的许多人不允许您仅添加现有列表，而是要求您联系所有人员并让他们再次选择加入。许多人还要求您始终使用双重选择注册，他们必须在添加之前回复电子邮件。您在选择服务时必须考虑这一点。

我要做的是找到一个可以用来发送邮件的 SMTP 服务。我环顾了一会儿，但这不是一项容易找到的服务。基本上，我希望有人接受我的电子邮件并将它们发送出去。只是一个 SMTP 服务器。

碰巧的是，我发现[我用来销售我的软件的服务 Plimus](http://www.plimus.com)是一个为他们提供 SMTP 服务的网络主机的合作伙伴。该虚拟主机是 DewaHost，您可以[为其专用于 SMTP 的服务器获得一个托管帐户](http://www.dewahost.com/smtphosting.html)。您确实需要直接联系 DewaHost 以与他们注册，但他们的月费率是合理的，每月最多 40 美元可无限发送电子邮件。

当然，还有其他人。您可以在 Google 上查找[“SMTP 服务器托管”，](http://www.google.com/search?q=smtp+server+hosting)但我无法为其他人担保。您会注意到 DewaHost 在该列表中名列前茅。

在您对自己问题的评论中，您说您想要“某种漂亮整洁的在线界面，显示我们发送的所有电子邮件，并允许我在用户请求时重新发送它们”。我认为您在尝试获取服务时遇到了麻烦。如果您已经在使用自己的 ASP.Net 程序来生成您自己的电子邮件并维护您的列表，那么它应该是您自己的程序或它的附加组件，例如我使用的 Spd E-Letter。

如果您想要一个 ASP.Net 解决方案，[有几个可用的包](http://www.google.com/search?hl=en&q=asp.net+newsletter+software)，例如[Absolute Newsletter](http://www.xigla.com/absolutenl/)。

我希望这可以帮助你。

路易斯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T15:41:34.130

您的 ISP/主机提供商是否提供 SMTP 服务器？如果不是，那么通过`System.Net.Mail`图书馆使用它怎么样？它不是网络服务，但使用起来很简单。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-06T14:50:04.213

[据我所知， CakeMail](http://www.cakemail.com)是唯一符合您所有标准的解决方案。

通常，它用于创建电子邮件活动并发送它们，因此它提供了您期望电子邮件活动经理提供的所有功能。要发送单个电子邮件，您只需创建一个新活动，将收件人添加到该活动，然后将其发送出去。如有必要，您可以重新发送广告系列。全部通过 API 管理。

它以每个收件人为基础工作，而不是像提到的其他解决方案那样需要固定的邮件列表。除了信用成本之外，也没有发送费用，您可以使用类似的解决方案（例如 Campaign Monitor）来体验。

在不久的将来，我们将在完全相同的配置中使用 CakeMail。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-08T15:39:03.807

根据您的使用要求，您是否考虑过使用 gmail？Google 提供了一个很好的安全 smtp 服务和很酷的（免费）好东西，用于使用 google 托管您自己的域电子邮件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-10T01:27:02.800

添加到上面马特的回答中，CakeMail 还提供了一个允许一次性电子邮件的[中继 API 类。](http://www.cakemail.com/support/api/relay)您可以通过我们的库之一与我们的 API 进行交互。

干杯，弗朗索瓦@CakeMail

# devexpress - Excel 和 Word DevExpress

> ID：916447
> 
> 赞同：0
> 
> 时间：2009-05-27T15:36:30.897
> 
> 标签：devexpress

我想知道在哪里以及如何在 DevExpress 中下载 Excel 和 Word。在办公室，我可以打开我正在处理的项目。但是如果我尝试在家里打开，它会说找不到 Word 和 Excel 参考。

请参阅附件以了解我所指的内容。谢谢你的帮助

[http://www.mypicx.com/05272009/pic/](http://www.mypicx.com/05272009/pic/)

=====

答：是的，它已安装在我的 PC 中。如何添加新的参考？

====

顺便说一句，当我添加参考 excel 和 word 时，这又是另一个错误：

=========== 如果您无法打开文件，您可以在此处查看 .gif 文件： http: [//www.tintin.ws/images/gif/pic.gif](http://www.tintin.ws/images/gif/pic.gif) [http://www.mypicx .com/05272009/mypic/](http://www.mypicx.com/05272009/mypic/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T07:14:37.867

在添加/删除程序中更改安装并包括“.Net Programmability”。这将安装主互操作程序集 (PIA)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:38:54.977

您需要在家用电脑上安装 Office。尝试删除并重新添加引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T15:39:21.093

您的家用计算机上是否安装了 Microsoft Office？

# c# - 如何在代码中设置 DataGridTextColumn 的绑定？

> ID：916454
> 
> 赞同：13
> 
> 时间：2009-05-27T15:36:54.640
> 
> 标签：c#, wpf, datagrid

我正在使用 CodePlex 的工具包：DataGrid。

我正在生成代码中的列。

如何在代码中设置**{Binding FirstName}**的等效项？

或者，我怎样才能**设置 value**，这就是我需要做的，不一定绑定它。我只想要数据网格中单元格中模型属性的值。

```
DataGridTextColumn dgtc = new DataGridTextColumn();
dgtc.Header = smartFormField.Label;
dgtc.Binding = BindingBase.Path = "FirstName"; //PSEUDO-CODE
dgtc.CellValue= "Jim"; //PSEUDO-CODE
CodePlexDataGrid.Columns.Add(dgtc); 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-27T15:48:56.143

未经测试，但以下应该有效：

```
dgtc.Binding = new Binding("FirstName"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-04-01T11:58:28.793

关于新绑定的第一个答案对我来说也是正确的。使用该答案的主要问题是 Binding 属于四个命名空间 8-(。正确的命名空间是 System.Windows.Data (.NET 4, VS2010)。这导致了更完整的答案：

```
dgtc.Binding = new System.Windows.Data.Binding("FirstName"); 
```

旁注：

在我的情况下，设置绑定的上下文是对 DataGrid 列的迭代。在可以更改绑定之前，必须将基类 DataGridColumn 转换为 DataGridTextColumn。然后可以更改绑定：

```
int pos = 0;
var dgtc = dataGrid.Columns[pos] as DataGridTextColumn;
dgtc.Binding = new System.Windows.Data.Binding("FirstName"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-22T12:17:17.913

例子：

```
DataGridTextColumn dataColumn = new DataGridTextColumn();
dataColumn.Header = "HeaderName";
dataColumn.Binding = new Binding("HeaderBind");
dataGrid.Columns.Add(dataColumn); 
```

# c++ - C++（真的）安全标准字符串搜索？

> ID：916455
> 
> 赞同：1
> 
> 时间：2009-05-27T15:37:04.997
> 
> 标签：c++, string, search, standards

缓冲区溢出问题是众所周知的。因此，我们有幸拥有诸如 wcscat_s() 之类的标准库函数。微软的好心人已经创建了类似的安全字符串函数，例如 StringCbCat()。

但是我有一个问题，我需要在*一些内存*中搜索一个字符串。标准库函数：

```
wcsstr( wchar_t* pMem, wchar_t* pStr ) 
```

看起来很棒，但是...有时我的记忆包含垃圾，有时是字符串。当它是垃圾时，我有时会耗尽分配的内存页面，[=访问冲突]。我可以编写自己的函数是的。但我的问题是是否有任何“标准”函数可以进行安全的字符串搜索，例如：

```
"wcsstr_s( wchar_t* pMem, size_t uiSize, wchar_t* pStr )" ? 
```

谢谢

**[编辑]** 感谢查尔斯贝利对我的问题的完美回答。也感谢其他人的努力。

对于那些怀疑我的情景是否合理的人：是的，当然最好不要在我的记忆中留下垃圾。但我可以想象这种情况可能发生的几种情况。在我的特殊情况下，它是逆向工程，我正在搜索的内存实际上不是“我的记忆”，它属于另一个我无法控制的过程。

（另一种假设情况可能是需要追踪损坏的内存的棘手调试情况。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T15:51:00.397

可能不是您正在寻找的答案，但也许这里最好的解决方案是正确初始化您的字符串和指针。如果你的记忆中包含垃圾，为什么不做正派的事情并设置

```
yourString[0] = '\0'; 
```

如果它真的只是一个任意位的缓冲区，那么最好使用[memcmp](http://www.cplusplus.com/reference/clibrary/cstring/memcmp/)之类的东西并沿着`N`字符滑动内存缓冲区的指针（其中`N`是您感兴趣的字符数减去您正在比较的字符串的长度）。这可能不是最有效的实现，但我应该认为应该是一种相当稳健的方法。

**[编辑]**你的问题让我很感兴趣，我做了一些实验。鉴于您似乎正在寻找更多 C 风格的答案，这是我想出的一小段代码来详细说明我的 memcmp 建议：

```
// SearchingMemoryForStrings.cpp : Defines the entry point for a win32 consol application
// Purpose : Demonstrates a way to search a section of memory for a particular string
//

#include <stdio.h>
#include <string.h>

#define VALUE_NOT_FOUND (-1)

int FindStringInBuffer( const char* pMemBuffer, const size_t& bufferSizeInBytes, const char* pStrToFind )
{
    int stringFound = VALUE_NOT_FOUND; // Return value which will be >= 0 if we find the string we're after
    const char* pMemToMatch = NULL; // An offset pointer to part of 'pMemBuffer' which we'll feed to memcmp to find 'pStrToFind'

    // Set up some constants we'll use while searching
    size_t lenOfStrToFind = strlen( pStrToFind );
    size_t lastSearchablePosition = bufferSizeInBytes - lenOfStrToFind;

    // Search the memory buffer, shifting one character at a time for 'pStrToFind'
    for( size_t i = 0; i <= lastSearchablePosition; i++ ) {
        pMemToMatch = &pMemBuffer[i];
        if( memcmp(pMemToMatch, pStrToFind, lenOfStrToFind) == 0 ) {
            // We found the string we're looking for
            stringFound = i;
            break;
        }
    }

    return stringFound;
}

void ReportResult( int returnVal, const char* stringToFind )
{
    if( returnVal == VALUE_NOT_FOUND ) {
        // Fail!
        printf("Error, failed to find '%s' - search function returned %d\n", stringToFind, returnVal );
    }
    else {
        // Win!
        printf("Success, found '%s' at index %d\n", stringToFind, returnVal );
    }
}

void FindAndReport( const char* pMemBuffer, const size_t& bufferSizeInBytes, const char* pStrToFind )
{
    int result = FindStringInBuffer( pMemBuffer, bufferSizeInBytes, pStrToFind );
    ReportResult( result, pStrToFind );
}

int main( int argc, char* argv[] )
{
    const int SIZE_OF_BUFFER = 1024; // Some aribitrary buffer size
    char some_memory[SIZE_OF_BUFFER]; // The buffer of randomly assigned memory to look for our string
    const char* stringToFind = "This test should pass";
    const char* stringYouWontFind = "This test should fail";

    FindAndReport( some_memory, SIZE_OF_BUFFER, stringYouWontFind ); // Should fail gracefully

    // Set the end of the buffer to the string we're looking for
    memcpy( &some_memory[SIZE_OF_BUFFER-strlen(stringToFind)], stringToFind, strlen(stringToFind) );

    FindAndReport( some_memory, SIZE_OF_BUFFER, stringToFind ); // Should succeed this time and report an index of 1003

    // Try adding at some arbitrary position
    memcpy( &some_memory[100], stringToFind, strlen(stringToFind) );

    FindAndReport( some_memory, SIZE_OF_BUFFER, stringToFind ); // Should still succeed but report the offset as 100

    FindAndReport( some_memory, SIZE_OF_BUFFER, stringYouWontFind ); // Should still fail

    return 0;
} 
```

该片段在 Visual Studio 2008 下编译为 Win32 控制台应用程序。给了我以下内容：

```
Error, failed to find 'This test should fail' - search function returned -1
Success, found 'This test should pass' at index 1003
Success, found 'This test should pass' at index 100
Error, failed to find 'This test should fail' - search function returned -1 
```

该`FindStringInBuffer`功能是您想要的，如果您需要处理宽字符，则需要进行一些转换，但这至少应该为您提供一些可以继续进行的想法。如果您确实提出了 wchar 版本，我很想看看解决方案是什么样的（我自己没有处理过它们）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T15:57:00.777

唉，我知道仍然没有标准的“安全”字符串库。BSD 为此提供了 strnstr，但据我所知，它不在 glibc 或 Microsoft 的 libc 中。我不知道有什么“好”的选择，除了你自己的。

作为参考，Microsoft 安全字符串库列于[http://msdn.microsoft.com/en-us/library/wd3wzwts(VS.80).aspx](http://msdn.microsoft.com/en-us/library/wd3wzwts(VS.80).aspx)并在[http://msdn.microsoft.com/en-us/library/bb288454.aspx](http://msdn.microsoft.com/en-us/library/bb288454.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T17:41:51.827

假设你`pStr`是空终止的，这`uiSize`是`wchar_t`可读内存的数量`pMem`：

```
wchar_t* pSubStr = std::search( pMem, pMem + uiSize, pStr, pStr + std::wcslen( pStr ) );

// Optionally, change to the 'conventional' strstr return value
if( pSubStr == pMem + uiSize)
    pSubStr = 0; 
```

# c# - SubSonic - AllStruct.cs 看起来不对

> ID：916456
> 
> 赞同：1
> 
> 时间：2009-05-27T15:37:05.807
> 
> 标签：c#, orm, subsonic, data-access-layer

使用 SubSonic 2.2，使用**sonic.exe**生成 DAL 后，**AllStruct.cs**内容看起来错误：

```
// <auto-generated />
namespace ...DAL
{
  #region Tables Struct
  public partial struct Tables
  { ... }

  #endregion

    #region Schemas
    public partial class Schemas
    { ... }
    #endregion

    #region View Struct
    public partial struct Views 
    { ... }
    #endregion

    #region Query Factories
  public static partial class DB
  { ... }
    #endregion

}
#region Databases
public partial struct Databases 
{ ... }
#endregion 
```

是否有任何理由将数据库区域放在命名空间之外？如果没有，我该如何纠正它（我没有找到生成代码的任何模板）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T01:44:22.680

SubSonic 数据库类似于供应商。每个提供者都生成自己的命名空间，因此 Databases 结构位于任何生成的命名空间之外是合适的。如果您配置多个提供程序，您的 AllStructs.cs 文件将有多个命名空间，每个命名空间都有自己的一组结构，就像您发布的那些一样。

模板生成文件可以在[这里找到](http://code.google.com/p/subsonicproject/source/browse/trunk/SubSonic/CodeGeneration/Templates/CS_StructsTemplate.aspx)

# css - 如何开发一个 100% 浏览器兼容的基于 CSS 的布局？

> ID：916457
> 
> 赞同：6
> 
> 时间：2009-05-27T15:37:33.110
> 
> 标签：css, jsf

我们正在为各种外部和内部网站创建一些布局。

其中一位开发人员正在使用基于用户代理切换他的 CSS 文件（一个用于 FF，一个用于 IE）的最佳实践。`:/`其他人则坚持使用基于表格的布局，因为它们与浏览器兼容。

我想要一些关于如何使用 CSS 布局和排列元素的小指导。这必须与浏览器兼容。不能使用网格布局或“CSS 框架”，因为它们对于此处所做的工作不灵活。

例如，如果我们从外部设计公司获得 90 像素宽的图像，我们不会将它们放入 60 像素宽的网格单元中。我们不会调整它们的大小以适应它们。如果公司设计了主页，那么点击链接并看到所有填充标志/图形的尺寸都缩小了，这看起来很愚蠢。

需要某种资源或建议来为我指明正确的方向。

**编辑**：这是增加的转折。我们不接触任何 HTML，我们使用来自 JSF 和 Oracle ADF 的基于组件的设计......它们将呈现 HTML，我们使用 CSS 来对齐和设置样式。

**Edit2**：我们可以在 HTML 渲染之前添加样式和属性。请记住，我们正在编辑的不是 .html 文件，它是由组件生成的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T15:42:42.507

让布局跨浏览器工作的唯一真正方法是*花时间在每个浏览器中进行测试*。各种版本的 IE 都有自己的特殊问题，所以使用条件注释来为它们提供额外的样式表。

从良好的语义有效 HTML 开始，不要尝试任何过于复杂的布局，你会没事的。

如果您不想使用 CSS 库/框架，则归结为体验和测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T15:45:29.567

100% 浏览器兼容的网站可能主要来自经验与反复试验相结合 - 主要是。随着 IE8 的推出，它变得更加容易，因为它（至少）完全符合 CSS2。不过，您仍然希望 IE7 和 IE6 能够正常运行。*彻底的测试至关重要。*

请记住，100% 浏览器兼容并不一定意味着它们必须看起来相同（[网站应该在所有浏览器中看起来都一样吗？](http://shouldwebsiteslookthesameinallbrowsers.com/)）。对于复杂的布局，应该接受微小的差异，并且可能必须存在一段时间。

以下是一些可能值得一看的链接：

*   [小盒子](http://www.thenoodleincident.com/tutorials/box_lesson/boxes.html)
*   [包含浮动](http://complexspiral.com/publications/containing-floats/)
*   [HTMLdog 高级 CSS](http://htmldog.com/guides/cssadvanced/)
*   [http://layouts.ironmyers.com/](http://layouts.ironmyers.com/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T15:44:17.853

100% 浏览器兼容性？听起来你需要某种邪恶的恶魔魔法和/或大量的诅咒和哭泣。

如果您不想使用任何类型的网格布局或 CSS 框架，您将不得不进行大量试验和错误，并检查浏览器之间的差异。

祝你好运。你会需要它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T15:41:09.153

至于布局，你可以看看这个网站是否可以成为一个很好的参考。[http://matthewjamestaylor.com/blog/perfect-2-column-left-menu.htm](http://matthewjamestaylor.com/blog/perfect-2-column-left-menu.htm)

还有诸如[Blueprint](http://www.blueprintcss.org/)之类的框架。

雅虎也有更复杂的[CSS 框架。](http://developer.yahoo.com/yui/grids/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T15:52:03.080

首先，您需要选择一种方法并坚持下去。让一个开发人员以一种方式做事而其他人以完全相反的方式做事，这就是在你开始之前就自找麻烦。

其次，您需要摒弃在每个浏览器中都具有相同体验的想法——如果这很难理解，那么可以这样想：浏览器只是用户使用您的内容的一种方式。您是否还计划为使用移动浏览器访问您网站的每个人提供相同的体验？还是基于文本的浏览器？还是屏幕阅读器？IE5呢？您的用户可以使用成千上万的用户代理怎么办？

这不全是坏消息。有很多资源可以帮助使用 CSS 正确布局，还有更多资源可以帮助解决 IE 中固有的错误。您可能会觉得有用的是：

*   [职位就是一切](http://www.positioniseverything.net/)
*   [PPK 的 QuirksMode](http://www.quirksmode.org/)
*   [一个列表分开](http://www.alistapart.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T22:07:13.930

我的建议是开始尝试让它发挥作用。当你遇到问题时，谷歌一段时间的答案。如果找不到，请在论坛中提问。我认为这就是大多数人学习 CSS 技巧的方式，因为许多错误和修复远非显而易见，您只需要逐渐成为受害者，然后了解所有 CSS 浏览器错误的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T22:15:38.907

我的建议是停止尝试使其 100% 跨浏览器兼容。花时间和资源为大男孩设计 - IE7/8、FF、Safari、（Chrome？）和 MAYBE Opera，因为它们很可能代表了超过 98% 的观众。您也可以在其中包含 IE6，但是 cmon，它已经是 2009 年了，我们还有两个浏览器版本。现在为 IE6 设计就像在 IE6 出现时为 IE4 设计一样。但这是你的决定。

根据我的经验，对于使用非标准浏览器的 1-2% 的用户来说，不值得你花时间（我上次检查过，等于钱）来尝试取悦所有人。但是，如果时间和金钱是无限的，那就尽情享受吧。

哦，给我一些钱，因为它是无限的：D

编辑 - 在 FireFox 中开始您的开发并从那里进行调整。这似乎是最“正确”的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T18:38:21.433

我建议第一步是使用某种形式的重置样式表（Eric Meyer 的版本在这里：[http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/](http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/)和这里的 YUI 版本：[http://developer.yahoo.com/yui/reset/](http://developer.yahoo.com/yui/reset/)）删除浏览器的默认样式，这似乎是某些浏览器不一致的基础。它并没有完全平整场地，但它可以消除一些颠簸，以获得更清洁的起点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T15:44:12.830

如今，一种常见的方法是编写您的 CSS，使其适用于 Firefox（和其他现代非 IE 浏览器），然后使用[IE 条件注释](http://www.quirksmode.org/css/condcom.html)添加特定于 IE 的修复。

不幸的是，任何不简单的页面布局都会在 IE 6 和 IE 7 中遇到错误，只能通过给这些浏览器稍微不同的 CSS 来解决。

归根结底，您必须在所有目标浏览器中测试您的 HTML/CSS；这真的无可替代。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T15:46:03.870

我可以添加到@Edeverett 和@Dev.e.loper 的回复中的唯一内容是建议将它们结合起来。

从可靠、有效、语义（有意义的）(X)HTML 标记开始。从标记的角度保持简单。使用众所周知的 CSS 库/框架。测试，测试，测试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-27T15:48:11.417

没有办法创建在所有浏览器中 100% 兼容的基于 CSS 的布局，因为有些浏览器没有通过[ACID 测试](http://acid3.acidtests.org/)。事实上，大多数浏览器都没有通过这个测试。

您只能希望在所有浏览器上看起来都不错（或者在带有错误和/或“功能”的浏览器上优雅地降级）。

这是设计使然：CSS 从来不是为了让所有浏览器上的东西看起来都一样，它只是告诉浏览器你想要什么的一种方式。浏览器开发人员可以根据您的意愿自由行事。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-27T15:49:06.003

浏览器的呈现方式不同。拥有干净、独立的 CSS 文件而不是在每个浏览器中破解一个“几乎可以工作”的单个文件并不是一件坏事。

虽然很少见，但有桌子的时间和地点，你只需要选择什么时候。当开发时间和 UI 为了“不使用表格的最佳实践”而做出合理的牺牲时，您不一定会成为赢家。

每个布局的细微差别都完全不同，以至于无法准确预测浏览器错误（/差异）——尽管有些布局比其他布局更常见。

我提到了差异和错误，因为浏览器之间的许多不一致之处归结为对 HTML 标准的不同且可能同样有效的解释。

至于关于浏览器兼容性的指导，除了***测试、测试、测试***之外没有其他解决方案。

安装尽可能多的浏览器（FF、Chrome、IE、Safari、Flock、Opera 等）。但是让不同版本的不同浏览器同时运行变得很棘手。这就是browsercam.com（商业）和browsershots.org（免费）等网站派上用场的地方。他们以您能想到的尽可能多的浏览器/操作系统组合为您的网站拍摄快照。

Browsercam.com 实际上允许您登录机器​​并在网站上玩耍，这可以方便地调试交互式 CSS 和 JS。

我的建议是：

*   读几本关于 CSS 的书
*   检查以确保您没有使用任何特定于浏览器的东西（如果您不确定，请检查 Google 上的所有内容） - 例如，任何以“-moz”开头的 CSS 属性都特定于基于 Mozilla 的浏览器（如 Firefox）
*   ***测试，测试，测试***

最后，请记住确保您了解[DocTypes](http://www.alistapart.com/articles/doctype/)以及它们如何影响您的 CSS；完全相同的 CSS 在同一个浏览器中使用不同的 DocType 会有所不同。它定义了浏览器如何处理您的 (X)HTML 和 CSS。因此，当您想知道为什么“这在 xyz.com 上有效但在此处无效！”时，请小心。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-27T15:51:28.400

好的。我知道我会为此获得一百万的嘘声，但*如果你觉得你的 CSS 变得过于复杂，如果你看到，你正在为你支持的每个浏览器使用一个 hack，如果你不能接受它不更多，只需使用天哪该死的桌子！*

撇开这一点不谈，这是确保您的标记/样式在每个浏览器中都能正常工作的唯一方法（顺便说一下，定义“每个”——我们是不是每个都在谈论 IE6？）你没有办法，但是，正如人们已经指出的那样，测试它在所有这些浏览器中。我已经看到人们为此使用一些第三方网站，比如[browsershots.org](http://browsershots.org/)以取得有限的成功。也许这会对你有所帮助。

# c# - XMLResolver 编译错误

> ID：916459
> 
> 赞同：1
> 
> 时间：2009-05-27T15:37:49.223
> 
> 标签：c#, xml, xmlreader

所以，我正在尝试使用 XMLResolver 来加载一个 xml 文件。当我从文件名创建 xmlreader 时它工作正常，但当我使用 stringreader 时失败。它给了我一个`XslLoadException: XSLT compiler error.`内在的例外是`"An entry with the same key already exists."`

```
 public override object GetEntity(Uri absoluteUri, string role, Type ofObjectToReturn)
    {
        string f = Path.Combine(@"C:\tmp", Path.GetFileName(absoluteUri.ToString()));
        string testaxCont = @"<xsl:stylesheet xmlns:xsl=""http://www.w3.org/1999/XSL/Transform"" version=""1.0""><xsl:template name=""J""/></xsl:stylesheet>";
        string testaxCont2 = File.ReadAllText(f);
        bool j = testaxCont.Equals(testaxCont2); //This equals true
        XmlReader tmp = XmlReader.Create(new StringReader(File.ReadAllText(f))); //crash
//            XmlReader tmp = XmlReader.Create(f); //don't crash
        return tmp;
    } 
```

* * *

```
testax.xslt    
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"><xsl:include href="testax2.xsl" /></xsl:stylesheet>

testax2.xsl
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"><xsl:template name="J"/></xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T15:42:38.620

我需要将虚线更改为`XmlReader tmp = XmlReader.Create(new StringReader(File.ReadAllText(f)),null,f);`With a file it has a base URI but with a string it is missing。

# visual-studio - 有没有办法在 Visual Studio 2008 的 DBML 文件中查找表？

> ID：916460
> 
> 赞同：10
> 
> 时间：2009-05-27T15:37:56.120
> 
> 标签：visual-studio, linq-to-sql, dbml

这些一直困扰着我多年。

回到过去，当我们自己寻找食物并使用 DataSet 时，您可以通过从顶部的下拉列表中选择您想要的内容来捕捉到 DataSet 中的特定表。

如果我有一个很大的 ol' Linq2Sql DBML 文件，其中包含很多表，那么导航将成为一场噩梦。有没有办法跳到特定的表？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-27T15:49:48.217

如果您打开了“属性”视图，则顶部有一个下拉菜单，您可以从中选择 DBML 实体，当您选择它时，画布应将焦点对准特定实体

# jquery-ui - jquery ui datepicker插件中的样式特定日期

> ID：916465
> 
> 赞同：3
> 
> 时间：2009-05-27T15:38:32.980
> 
> 标签：jquery-ui, datepicker

我正在编写一个用于预订培训设施的应用程序，并且我希望能够让预订设施的教练知道该设施何时已经为给定日期预订。

我正在使用 jquery-UI datepicker 插件，并且我希望能够为这些保留日期设置不同的表格单元格样式。我只是不知道如何将日期传递到插件中，因此我可以更改日历上这些日期的类。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T15:41:25.520

我会利用 beforeShowDay 事件来处理这个问题。

[http://api.jqueryui.com/datepicker/#option-beforeShowDay](http://api.jqueryui.com/datepicker/#option-beforeShowDay)

# yahoo-api - 我的 Yahoo 应用程序教程

> ID：916467
> 
> 赞同：0
> 
> 时间：2009-05-27T15:38:51.513
> 
> 标签：yahoo-api

我正在寻找一个教程来展示如何为 My Yahoo! 创建一个应用程序。雅虎的教程非常混乱。（我希望他们的平台像 Google Gadgets 一样简单！）。

我要创建的应用程序非常简单：一个包含一个字段的表单。您填写表格，按提交，然后您会在回复中获得一个额外的字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-05T18:50:20.473

My Yahoo 的应用程序是使用 Yahoo 应用程序平台构建的。从这里开始获取文档和示例：http: [//developer.yahoo.com/myyahoo/](http://developer.yahoo.com/myyahoo/)

特别是，您可能希望遵循此入门演练：http: [//developer.yahoo.com/yap/guide/creating_open_app.html](http://developer.yahoo.com/yap/guide/creating_open_app.html)

# grails - Acegi/Spring Security Grails 插件看不到用户实例的更改

> ID：916473
> 
> 赞同：3
> 
> 时间：2009-05-27T15:39:38.457
> 
> 标签：grails, spring-security

我正在使用 Acegi/Spring Security 插件在 Grails 中编写一个 Web 应用程序，并且无法让它查看我对用户实例所做的更改。我只使用 Groovy/Grails 大约三周，所以如果这个问题是微不足道的，请原谅我，因为我一直在研究邮件列表和教程试图找到答案。

每当我需要用户包含更多信息（例如电子邮件确认令牌或真实姓名）时，我一直在向用户域类添加新属性，因为我找不到任何相反的建议。创建新用户似乎一切都很好，但是当我编辑用户时，更改显示在用户列表中，但 Acegi 标记库和相关函数似乎没有看到更改。

这是来自 UserController.update() 的相关片段：

```
def person = User.get(params.id)
//...snip error checking...

//Update user attributes
person.username = params.email
person.email = params.email
person.userRealName = params.userRealName

//Attempt to save changes
if (person.save()) {
    //If successful, redirect back to profile viewing page
    redirect action: show, id: person.id
    return
}
else {
    //Otherwise, show errors and edit again
    render view: 'edit', model: buildPersonModel(person)
    return
} 
```

这段代码运行后，如果我总是按 ID 获取用户数据，我可以看到更改，但如果我使用 Acegi 标记或函数则看不到。例如，这不起作用：

```
loggedInUserInfo(field:'realName') 
```

但这确实：

```
User.get(loggedInUserInfo(field:'id').toLong()).realName 
```

新信息*有时会*在我注销并再次登录后出现，但通常不会出现，即使在 3 次或更多重新登录后通常也不会出现。另外，我尝试在 person.save() 中添加“flush:true”，但没有任何效果。

（外围问题：像这样摆弄 User 类对我来说是不是很糟糕？如果不是，向其中添加信息的最佳方法是什么？）

**更多调查后更新：** 看起来如果我在普通页面中使用 loggedInUserInfo()，它工作正常，但如果我在布局中使用它，它会表现出我描述的行为。会不会发生一些奇怪的缓存事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-20T11:35:16.297

我有一个解决这个问题的方法，我还为这个问题创建了一个[JIRA](http://jira.codehaus.org/browse/GRAILS-5407)条目。

Acegi 如何在内部更新其用户似乎存在错误。我以 grails 过滤器的形式提供了一种解决方法，它在每次访问控制器时手动更新用户的权限。不理想，但它有效。

干杯，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T18:27:50.853

您在修改用户类后是否运行了 grails generate-manager？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-19T15:44:04.713

我面临着同样的问题。我的解决方案是将 acegi 插件更新到 0.5.1 版（acegi 0.5.1 -- Grails Spring Security 2.0 插件）。

然后我设置在**/plugins/acegi-0.5.1/grails-app/conf/DefaultSecurityConfig.groovy**

```
cacheUsers = false 
```

现在瞧！这是工作！

路易斯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T21:46:53.267

我遇到了同样的问题，并遵循了上面 Maximilian Schweitzer 的建议。一开始它对我不起作用。

试试这些步骤，看看它是否能解决问题：

1.  我按照 Maximilian Schweitzer 的上述回答运行了 generate-manager 。
2.  尝试使用在我运行 generate-manager 之前创建的用户登录 - 没有用
3.  我创建了新用户（使用新的 UserController、gsp 等）
4.  尝试使用新用户登录工作正常。
5.  删除之前创建的旧用户并重新创建它们。它工作得很好。

虽然不确定它是否适用于您的情况。

！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T16:58:22.803

如果我没记错的话，Acegi 会缓存用户信息。检查“ `DefaultSecurityConfig`”文件（我认为这是 config/ 下的名称）以禁用用户信息缓存。您还可以在 authenticateService 上调用一些方法（现在不记得是什么方法）来驱逐用户缓存。

您也许可以在`UserController#update`闭包中找到后者。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-10T12:20:57.850

您必须重置经过身份验证的用户。下面的代码就是这样做的（来自[这个博客](http://manbuildswebsite.com/2010/02/23/how-to-login-a-user-with-the-grails-spring-security-plugin/)）。

```
import org.springframework.security.context.SecurityContextHolder
import org.springframework.security.providers.UsernamePasswordAuthenticationToken
import org.codehaus.groovy.grails.plugins.springsecurity.GrailsUserImpl
import org.springframework.security.GrantedAuthority
import org.springframework.security.GrantedAuthorityImpl

...

def refreshAuthenticatedUser(user) {
    GrantedAuthority[] auths = user.authorities.collect {
        new GrantedAuthorityImpl(it.authority)
    }
    def grailsUser = new GrailsUserImpl(
            user.username,
            "",
            user.enabled,
            true,
            true,
            true,
            auths,
            user)
    def authToken = new UsernamePasswordAuthenticationToken(grailsUser, '', auths)
    SecurityContextHolder.context.authentication = authToken

} 
```

# objective-c - 如何更改可可 NSBrowser 的背景颜色？

> ID：916477
> 
> 赞同：0
> 
> 时间：2009-05-27T15:40:06.100
> 
> 标签：objective-c, cocoa

如何从默认的白色更改可可 NSBrowser 的背景颜色？我是否需要覆盖其他东西才能做到这一点？我在网上搜索并没有发现任何有用的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T15:43:05.093

好吧，我没有经常使用 NSBrowser，但是[Apple 文档](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSBrowser_Class/Reference/Reference.html#//apple_ref/occ/instm/NSBrowser/setBackgroundColor)清楚地显示了一个 setBackgroundColor 方法。这不是你想要的吗？

# asp.net - asp.net cms 系统

> ID：916479
> 
> 赞同：1
> 
> 时间：2009-05-27T15:41:00.480
> 
> 标签：asp.net, content-management-system

我是 LAMP 开发人员，但需要向客户推荐 asp.net CMS 解决方案？.net 环境中领先的 CMS 解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T15:42:40.460

*   [博客引擎.NET](http://www.dotnetblogengine.net/)
*   [乌姆布拉科](http://umbraco.org/)
*   [AxCMS](http://weblogs.asp.net/scottgu/archive/2006/02/02/437220.aspx)
*   [点网核弹](http://en.wikipedia.org/wiki/DotNetNuke)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T15:45:16.120

*   [点网核弹](http://www.dotnetnuke.com/)
*   [乌姆布拉科](http://umbraco.org/)

您还可以查看[http://cmsmatrix.org/](http://cmsmatrix.org/)了解更多选项

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T15:48:03.743

[http://www.sitecore.net](http://www.sitecore.net)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T15:51:49.040

[Graffiti CMS是](http://graffiticms.com/)[Telligent](http://telligent.com/)的非开源 CMS 解决方案

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-02T19:32:20.313

www.kitgui.com[与](http://www.kitgui.com)服务器端方法无关，但仍然是通过 REST 而不是通过 FTP 进行的编程方法。这是最灵活的，因为我是这样做的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-02-13T09:44:23.013

DNN、Umbraco、Kentico、MojoPortal、Orcchard 等等。

这是一个很好的比较矩阵 --> [ASp.net CMS 比较矩阵](http://www.findbestwebhosting.com/web-hosting-blog/index.php/5-best-asp-net-content-management-systems)

# java - Java中的广义单例基类

> ID：916494
> 
> 赞同：2
> 
> 时间：2009-05-27T15:43:43.657
> 
> 标签：java, design-patterns, generics, templates, singleton

在 C++ 中，我知道可以使用模板创建单例基类。它在 Andrei Alexandrescu 的《现代 C++ 设计》一书中进行了描述。

可以在Java中实现这样的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T15:51:55.777

因为 Java 的泛型没有具体化，所以不可能以相同的方式实现泛化的 Singleton。因为泛型类型已从编译代码中“删除”，所以必须在运行时显式初始化单例。

结果是，单例模板在 Java 中不会提供太多价值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T15:52:57.663

我还没有在 Java 中看到一个令人满意的解决方案。有许多使用 C++ 中的模板或 .NET 中的泛型的示例，但是 Java 的泛型实现对静态成员有一些限制，这使得这很困难。

我见过的最好的选择是使用静态 HashMap 和工厂类。这允许您创建一个可以为任何类的多个 Singleton 提供服务的工厂。

有关实现，请参阅[这篇文章](http://forums.sun.com/thread.jspa?messageID=10630400#10630400)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T15:51:51.113

是的，但所有方法都有其缺陷。它们要么很昂贵（使用`synchronized`），要么无法进行测试（`final static`）。

请参阅右侧的链接：

*   [在 Java 中实现单例模式的有效方法是什么？](https://stackoverflow.com/questions/70689/efficient-way-to-implement-singleton-pattern-in-java)

*   [单例有什么问题？](https://stackoverflow.com/questions/86654/whats-wrong-with-singleton)

*   [单身人士：好的设计还是拐杖？](https://stackoverflow.com/questions/11831/singletons-good-design-or-a-crutch)

“最先进的技术”是使用容器或工厂根据需要创建单例并将它们保存在某种缓存中。参见 Spring、Guice 等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T16:20:48.933

1997 年，我尝试使用 JDK 1.0.2 来实现这一点，并得出结论，不可能创建可继承的单例。据我所知，Java 还没有获得任何允许这样做的新功能。

但是，手动执行此操作并不涉及大量样板代码，每个类可能 10 行左右。如果您需要创建某种匿名工厂机制，则单例可以为实例化协议实现一个带有占位符的接口。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-10T16:27:32.913

正如@reed-copsey 提到的，您可以使用静态 HashMap（或用于线程安全的 Hashtable）来存储不同模板的所有实例。单例类示例：

```
public class Singleton<T extends Parent> {
    private static HashMap<Class, Singleton> instanceMap = new HashMap<Class, Singleton>();

    private Singleton() {

    }

    public static <T> Singleton getInstance(Class<T> tClass) {
        if (!instanceMap.containsKey(tClass))
            instanceMap.put(tClass, new Singleton());
        return instanceMap.get(tClass);
    }

} 
```

您可以将此单例用作：

```
public static void main(String[] args) {
    Singleton instance1 = Singleton.getInstance(Child1.class);
    Singleton instance2 = Singleton.getInstance(Child1.class);
    assert instance1 == instance2;

    Singleton instance3 = Singleton.getInstance(Child2.class);
    assert instance1 != instance3;
} 
```

单例类将为不同的类类型返回不同的实例。

# qt - 减小 WAV 声音文件大小，而不会损失质量

> ID：916501
> 
> 赞同：3
> 
> 时间：2009-05-27T15:45:21.033
> 
> 标签：qt, cross-platform, audio

我的应用程序需要播放声音文件。我可以使用的唯一跨平台文件格式是 WAVE（我使用的是 Qt 框架的[QSound](http://doc.trolltech.com/4.5/qsound.html#details)）。

这些声音的文件大小非常大，我想知道是否有办法减少它，而不会损失（太多）质量。

我需要文件是立体声的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T15:49:18.577

减小 wav 文件大小的唯一方法是将其重新采样到较低的比特率或每个样本使用较少的比特。Wav 文件没有 mp3 或 ogg 等压缩功能。

如果您使用的是 16 位 44 khz 文件，您可以通过将采样率设置为 22khz 来将文件大小减半，而您将失去的只是一些高频。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T16:07:25.730

为什么不使用[FLAC](http://flac.sourceforge.net)？这是在不牺牲任何质量的情况下对 WAV 进行无损压缩的最佳方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T16:07:04.920

您可以对它们进行压缩（使用 zlib 或类似工具），然后按需解压缩它们。如果您有很多分钟的连续 wav，则可能值得研究音频特定的无损压缩算法，例如 FLAC。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-09T16:03:39.897

我知道这是一个老问题，但我还没有看到任何使用录音机的状态。

1.  打开录音机
2.  将所需文件拖入其中
3.  单击文件选项卡
4.  去属性
5.  从下拉框中选择文件转换
6.  立即转换
7.  选择质量
8.  点击确定

应该这样做我必须为我的电话服务这样做，因为它只允许 2.5MB .wav 格式。将文件缩小到 5MB 时的 25% 以下。

这有什么帮助

克里斯托弗迈克尔贸易推动者 www.trademovers.net

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T19:49:59.870

您可能应该看看 Qt 的[声子模块](http://doc.qtsoftware.com/4.5/phonon-module.html)。它是跨平台的，支持不同平台的原生格式。我认为您可以假设大多数操作系统都支持 MP3。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-07T06:40:09.063

根据定义，WAV 是**未压缩和无损**的。为了减小 WAV 文件的大小，您需要降低比特率或更改文件格式。但是，两者都涉及音频质量的损失（除非您使用 FLAC 或类似的东西）。

通常，您可以将比特率从 41000 或 48000 Hz 更改为 32000 Hz，而不会损失太多质量。或者，将文件转换为其他格式。

# c++ - 如何将用户定义的非托管类型转换为托管类型？

> ID：916507
> 
> 赞同：0
> 
> 时间：2009-05-27T15:47:02.840
> 
> 标签：c++, managed-c++

我有一个在 MSTest 中编写的测试，它是托管 C++，我正在尝试测试一个非托管类。具体来说，我正在尝试使用 PrivateObject 类来调用私有方法。

这是我到目前为止的代码：

```
CUnmanagedType foo;
PrivateObject privateFoo = gcnew PrivateObject( foo );

CString strFromFoo = privateFoo.Invoke( "ARandomPrivateMethod" ); 
```

当我编译时，我得到一个错误，即 foo 不能转换为 System::Type^。我尝试过执行以下操作：

```
PrivateObject privateFoo = gcnew PrivateObject( (gcnew System::Type^(foo)) ); 
```

但这不起作用，因为 System::Type^ 是一种抽象类型。有任何想法吗？

我看过这些问题，但他们使用的是预定义类型，而不是用户定义的类型： [如何将非托管双精度转换为托管字符串？](https://stackoverflow.com/questions/103298/how-to-convert-a-unmanaged-double-to-a-managed-string) [C ++中托管和非托管类型之间的转换？](https://stackoverflow.com/questions/741245/conversion-between-managed-and-unmanaged-types-in-c)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T19:23:06.880

PrivateObject 构造函数需要一个类型名，而不是一个实例。为此，您需要执行以下操作：

```
PrivateObject privateFoo = gcnew PrivateObject( "CUnmanagedType" ) 
```

# sql - 按周分组日期范围

> ID：916508
> 
> 赞同：4
> 
> 时间：2009-05-27T15:47:37.970
> 
> 标签：sql, tsql, datetime, date-range

我有一个日期范围，开始日期是今天之前的 2 年。例如）“2007 年 5 月 29 日”~“2009 年 5 月 29 日”。

如何突破日期范围，以便获得如下列表？

（开始日期以“05/27/2007”开始，而不是“05/29/2007”，因为工作日的开始是星期日，而“05/27/2007”是“05/29/2007”的一周的第一天和最后一个 EndDate 的相同推理，05/30/2009，即星期六）

```
StartDate   EndDate
05/27/2007  06/02/2007
06/03/2007  06/09/2007
...
05/24/2009  05/30/2009 
```

**[更新]**这是我的最终查询

```
WITH hier(num, lvl) AS (
    SELECT  0, 1
        UNION ALL
    SELECT  100, 1
        UNION ALL 
    SELECT  num + 1, lvl + 1
    FROM    hier
    WHERE   lvl < 100
)
SELECT  num, lvl,
    DATEADD(dw, -DATEPART(dw, '2007-05-29'), '2007-05-29') + num  * 7,
    DATEADD(dw, -DATEPART(dw, '2007-05-29'), '2007-05-29') + (num + 1) * 7
FROM    hier
where   num <= 104  --; 52 weeks/year * 2
ORDER BY num 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T16:07:57.743

```
WITH hier(num, lvl) AS (
        SELECT  0, 1
        UNION ALL
        SELECT  100, 1
        UNION ALL 
        SELECT  num + 1, lvl + 1
        FROM    hier
        WHERE   lvl < 100
        )
SELECT  DATEADD(dw, -DATEPART(dw, '29.05.2007'), '29.05.2007') + num  * 7,
        DATEADD(dw, -DATEPART(dw, '29.05.2007'), '29.05.2007') + (num + 1) * 7
FROM    hier
WHERE   DATEADD(dw, -DATEPART(dw, '29.05.2007'), '29.05.2007') + num * 7 < '29.05.2009' 
ORDER BY
        num 
```

这将生成一个包含您需要的范围的行集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T15:57:39.043

您需要确保正确发送@@DATEFIRST，然后您可以简单地使用下面的代码。不过请阅读 DATEFIRST，以便您完全理解它。

```
SET DATEFIRST 1

DECLARE @my_date DATETIME

SET @my_date = '2007-05-29'

SELECT
     DATEADD(dw, -DATEPART(dw, @my_date), @my_date) AS StartDate,
     DATEADD(dw, 6 - DATEPART(dw, @my_date), @my_date) AS EndDate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T16:09:46.273

在您的 SQL 语句中应该非常简单直接......我在处理日期和日期算术方面有着悠久的历史，所以我会采用类似的方法：

```
select 
      datepart( year, YourDateField ) as GroupYear,
      datepart( week, ( YourDateField - datepart( day, YourDateField ) +1 ) as GroupWeek,
      YourDateField,
      OtherFields
  from 
      YourTable
  where 
      whateverDateRange...
  group by 
     GroupYear,
     GroupWeek 
```

年和周的原因是，如果您跨越多年，您将在第一年的第 2 周之前有两年的第 1 周，依此类推。

现在，数学是如何工作的……对于 GroupWeek。这实际上将根据您的数据作为基础的任何日期计算一周的第一天...假设您有今年 5 月 25 日、26 日、27 日的数据...它们分别是第 2 天、第 3 天和第 4 天本周的 - 星期天从第 1 天开始一​​周。所以：

5 月 25 日 - 2 日（星期几）= 5 月 23 日（星期六）+1 = 5 月 24 日（星期天）。5 月 26 日 - 3 日（星期几）= 5 月 23 日 ... 等等 5 月 27 日 - 4 日（星期几）= 5 月 23 日

因此，通过还包括有问题的原始日期字段，您也可以在一个 SQL 调用中查看真实日期...

# mercurial - 让 Mercurial 在 Windows 中运行

> ID：916516
> 
> 赞同：6
> 
> 时间：2009-05-27T15:48:58.653
> 
> 标签：mercurial, tortoisehg

我是 Mercurial 的粉丝，并且已经在 Linux 上使用它几年了。有没有人有在 Windows Vista 上安装和运行它的经验？我发现的唯一安装说明看起来过于复杂。有没有人根据自己的个人经验建立一个体面的清单？

谢谢

克里斯

**跟进：使用几周后，我可以说 Windows 上的 Mercurial 与乌龟配合得很好。我发现的一个问题是推送性能似乎比在 linux 上慢得多。

我还发现 cygwin 有一个端口。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T16:03:49.263

看看[TortoiseHg](http://bitbucket.org/tortoisehg/stable/wiki/Home)。我一直在工作的开发环境（Windows XP）上使用它，并且完全没有问题。更好的是，它附带了您需要的所有东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-04T22:23:49.060

> *我也使用 TortoiseHg。您需要注意的一件事是 64 位。我使用 64 位 Vista。您必须为 TortoiseHg 快捷菜单创建一个 32 位资源管理器快捷方式才能工作。在 64 位 Vista 上，只需使用目标创建一个快捷方式：%Systemroot%\SysWOW64\explorer.exe /separated*

从 0.8 版开始（2009-07-01 发布）TortoiseHg 支持 Windows Vista 64 位资源管理器 shell 集成。感谢新的 C++ shell 扩展（我为此做出了重大贡献）。

检查当前版本 TortoiseHg-0.8.1-hg-1.3.1.exe 可从[http://bitbucket.org/tortoisehg/stable/downloads/](http://bitbucket.org/tortoisehg/stable/downloads/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T16:02:55.820

使用这些[安装程序](http://mercurial.berkwood.com/)怎么样？

如果我没记错的话，它会毫无问题地安装，然后您将拥有可以在命令行上使用的 hg 命令，就像在 Linux 中一样。至少客户端可以正常工作，我没有尝试运行任何 mercurial 服务器。

# c# - 使用 XML 创建 Windows 窗体

> ID：916518
> 
> 赞同：1
> 
> 时间：2009-05-27T15:49:11.883
> 
> 标签：c#, .net, xml, winforms

我正在开发一个将存储许多文档的 Windows 桌面应用程序，最初将有 4 种不同类型的文档，每一种都是 Windows 窗体，每个都有一些常见的细节（文档 ID、客户端 ID 等），然后是不同的字段基于文档类型。

我计划使用 XML 来指定每个表单的字段。所以我的问题是，获取 XML 文档并根据其内容呈现表单字段的最简单方法是什么？我应该只解析 XML 并创建表单字段，还是有更快更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:11:55.460

如果您使用 XML 作为元数据，并且元数据是相对静态的（例如 FieldName=X、DataType=Y 等）并且不必在运行时扩展，您可以考虑XmlSerialization 并在代码中处理生成的对象。

在完成这两种方法之后，我可以诚实地说，处理类型安全的对象比让业务逻辑和解析逻辑交织在一起要干净得多。话虽如此，如果您需要运行时可扩展性，它将无法工作（或者您将不得不跳过一些障碍）。

如果您的元数据**很少**更改，您甚至可能需要考虑某种形式的代码生成，而不是动态表单构建。

关于 Auxon 的回答，YMMV 与 3rd 方选项。我有一些效果很好的 OOTB，节省了我很多时间，还有一些我花了很多时间配置和调整以获得与我自己构建的结果不太一样的结果。根据此功能对您的应用程序的重要性，如果开始看到第 3 方框架适应成为一项大型开发任务，您可能需要考虑推出自己的功能。

# asp.net-mvc - 从 Web.Config 获取 MembershipProvider 的属性

> ID：916525
> 
> 赞同：-1
> 
> 时间：2009-05-27T15:50:32.270
> 
> 标签：asp.net-mvc, asp.net-membership

`MembershipProvider`我从in派生了一个类，`System.Web.Security`定义如下：

```
 public class RedditMembershipProvider : MembershipProvider
    {

        public RedditMembershipProvider()
        {

        }
        public override int PasswordAttemptWindow
        {
            get { return 10; }
        }
        /* snip all the similar properties definition
                 */
    } 
```

问题是我希望在`RedditMembershipProvider` 实例化时，我希望从 web.config 中读取所有属性，而不是从上面的代码定义中读取：

```
<membership defaultProvider="RedditMembershipProvider">
<providers>
<clear/>
<add name="RedditMembershipProvider" 
     type="RedditClone.Models.RedditMembershipProvider"
     PasswordAttemptWindow=20
   />
</providers>
</membership> 
```

所以当我`PasswordAttemptWindow`从视图中调用时，我应该得到 20，而不是 10。但现在我得到的是 10，而不是 20。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T18:22:38.267

```
public class YourMembershipProvider : MembershipProvider
{
    public override void Initialize(string name, NameValueCollection config)
    {
        if (!String.IsNullOrEmpty(config["yourValue"]))
        {
            _yourValue = config["yourValue"];
        }

        base.Initialize(name, config);
    }

    string  _yourValue;
    public override string YourValue
    {
        get
        {
            return _yourValue;
        }
    }

    ...
} 
```

编辑：错字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T16:08:53.683

傻我！我怎么会犯这种错误？

我只需要在我的代码中阅读 web.config 即可获取值

```
 public override int PasswordAttemptWindow
    {
        get { ConfigurationManager.AppSettings["membership"].value; }
    } 
```

更简单的方法是继承`RedditMembershipProvider`from`SqlMembershipProvider`并仅覆盖必要的细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T06:03:26.720

答案1是优雅的方式。例如读取属性`minRequiredPasswordLength`使用

```
public override void Initialize(string name, System.Collections.Specialized.NameValueCollection config) {
    if (!String.IsNullOrEmpty(config["minRequiredPasswordLength"])) {
        _minRequiredPasswordLength = Int32.Parse(config["minRequiredPasswordLength"]);
    } 
    base.Initialize(name, config);
} 
```

进而

```
public override int MinRequiredPasswordLength {
    get { return _minRequiredPasswordLength; }
} 
```

# javascript - 如何使用内联 JavaScript 或 CSS 隐藏 TD 标签？

> ID：916528
> 
> 赞同：17
> 
> 时间：2009-05-27T15:50:58.510
> 
> 标签：javascript, html, css, visibility

如何`<td>`使用 JavaScript 或内联 CSS 隐藏标签？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-27T15:54:44.977

```
.hide{

visibility: hidden

}

<td class="hide"/> 
```

**编辑 -** 只为你

显示和可见性之间的区别是这样的。

**“display”：**有很多属性或值，但你关注的是“none”和“block”。“none”就像一个隐藏值，“block”就像一个显示。如果您使用“none”值，您将**完全**隐藏您应用此 css 样式的任何 html 标记。如果您使用“块”，您将看到 html 标记及其内容。非常简单。

**“visibility”：**有很多值，但我们想更多地了解“hidden”和“visible”值。"hidden" 的工作方式与 display 的 "block" 值相同，但这将隐藏标签及其内容，但不会隐藏该标签的物理空间。例如，如果您有几行文本，然后是图像（图片），然后是一个三列两行的带有图标和文本的表格。现在，如果您将具有隐藏值的可见性 css 应用于图像，图像将消失，但图像使用的空间将保留在其位置，换句话说，您将在文本和文本之间以大空间（孔）结束桌子。现在，如果您使用“可见”值，您的目标标签和它的元素将再次可见。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-27T15:54:03.777

你期望在它的地方发生什么？表格无法重排以填充剩余空间 - 这似乎是浏览器响应错误的秘诀。

考虑隐藏 td 的内容，而不是 td 本身。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-27T15:53:31.953

同样的方式你会隐藏任何东西：`visibility: hidden;`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-08-13T14:30:01.193

使用 css 一切皆有可能（或几乎），只需使用：

```
display: none; //to hide

display: table-cell //to show 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-10-01T03:54:28.837

```
<td style = "display:none" >
<p> Content display none </p>
</td> 
```

或者

```
<td style="visibility:hidden"> Your content is hidden </td> 
```

请注意： 2 这些方式是不同的。您应该尝试检查结果。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-27T15:59:42.050

如果您在 javascript 中拥有更多内容，请考虑使用一些 javascript 库，例如[jquery](http://jquery.com)，它会降低一点速度，但会为您提供更具可读性的代码。

[您通过jquery](http://jquery.com)的问题代码：

```
$("td").hide(); 
```

当然，还有其他的 javascript 库，正如[wikipedia 上的比较](http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)所示。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-09T12:01:39.157

`<td>`您可以通过仅包含样式属性来简单地隐藏标签内容：`style = "display:none"`

例如

```
<td style = "display:none" >
<p> I'm invisible </p>
</td> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-04T15:32:46.330

我们可以使用以下内联 css 隐藏 a 中的内容：

```
<div style="visibility:hidden"></div> 
```

例如：

```
<td><div style="visibility:hidden">Your Content Goes Here:</div></td> 
```

# jquery - 使用 jQuery 突出显示活动元素

> ID：916533
> 
> 赞同：2
> 
> 时间：2009-05-27T15:51:47.463
> 
> 标签：jquery, binding, highlighting

所以我有一个无序列表，我想让 jQuery 突出显示该列表上的活动链接。我在 mouseenter 和 mouseleave 列表上有动画，当链接悬停时会增加字体大小。

我可以通过在 mouseleave 上使用 .unbind 来使链接保持增加的大小和颜色，但是当我尝试重新绑定链接时，链接会失去所有突出显示。

到目前为止，这是我的代码：

```
$(document).ready(function() {
  slide("#sliding-navigation", 22, 17, 175, .8);
});

function slide(navigation_id, font_out, font_in, time, multiplier) {
  // Creates the target paths
  var list_elements = navigation_id + " li.sliding-element";
  var link_elements = list_elements + " a";

  // Initiates the timer used for the initial sliding animation
  var timer = 0;

  // Create the beginning slide animation
  $(list_elements).each(function(i) {
    // updates timer
    timer = (timer*multiplier + time);
    $(this).animate({ marginLeft: "0" }, timer);
    $(this).animate({ marginLeft: "15px" }, timer);
    $(this).animate({ marginLeft: "0" }, timer);
  });

  // Creates the hover effect
  $(link_elements).each(function(i) {
    $(this).mouseenter(function () {
      $(this).animate({ fontSize: font_out }, 200);
    }),
    $(this).mouseleave(function () {
      $(this).animate({ fontSize: font_in }, 400);
    }),
    // Highlights active link      

    $('a').click(function() {
        $('a.active').bind('mouseleave');
        $('a.active').addClass('inactive');
        $('a.active').removeClass('active');
        $(this).removeClass('inactive');
        $(this).addClass('active');
        $(this).unbind('mouseleave');
    });
} 
```

对此的任何帮助将不胜感激。在此先感谢您的任何建议！

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T17:42:30.423

改变

```
$('a.active').bind('mouseleave'); 
```

至

```
 $('a.active').mouseenter(function () {
      $(this).animate({ fontSize: font_out }, 200);
    }).mouseleave(function () {
      $(this).animate({ fontSize: font_in }, 400);
    }), 
```

这是最简单的更改，使您的大部分代码保持不变。您可能想查看 jquery 的 live 函数，以便将函数绑定到特定类并让 jquery 处理事件。另外，请注意如何使用链接来使代码更小且更易于阅读。

[JQuery 事件/实时文档](http://docs.jquery.com/Events/live)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:55:51.040

我想到了！我没有通过实时功能获得它，并且可能有更好的方法来做到这一点。

这是我更改的原始代码：

```
$('a').click(function() {
    $('a.active').bind('mouseleave');
    $('a.active').addClass('inactive');
    $('a.active').removeClass('active');
    $(this).removeClass('inactive');
    $(this).addClass('active');
    $(this).unbind('mouseleave');
}); 
```

使用此代码：

```
$('a').click(function() {
    $('a').animate({ fontSize : font_in }, 0);
    $(this).animate({ fontSize : font_out }, 0);
    $('a.active').mouseenter(function () {
      $(this).animate({ fontSize: font_out }, 200);
    }).mouseleave(function() {
      $(this).animate({ fontSize: font_in }, 400);
    }),
    $('a.active').addClass('inactive');
    $('a.active').removeClass('active');
    $(this).removeClass('inactive');
    $(this).addClass('active');
    $(this).unbind('mouseleave mouseenter');
}); 
```

# php - PHP 会话意外过期

> ID：916542
> 
> 赞同：6
> 
> 时间：2009-05-27T15:52:37.883
> 
> 标签：php, session

我在这里不知所措。我在楼上有一组特定的用户，他们的会话似乎完全随机过期。这不仅仅是当他们离开网站一段时间时，它可能会在他们浏览时过期。对于我和我们的大多数用户来说，一切都很好。这不是浏览器问题，我们在 FF 和所有 IE 版本中都可以正常工作，而在 FF 和 IE 中的人不能正常工作。

我`gc_maxlifetime`在`43200`，垃圾收集是一个疯狂的低点`1/1000`（这不重要）。是否有可能在服务器上运行的其他东西正在随机删除我们的一些会话？我应该检查什么？这仍然不能解释为什么只有这个特定的群体似乎受到影响。

我有一些与默认设置不同的会话设置：

```
session.gc_maxlifetime = 43200
session.gc_divisor = 1000
session.save_path = /var/lib/php/session
session.use_only_cookies = Off
session.bug_compat_42 = Off 
```

前三个我不担心，但后两个会导致这种行为吗？我实际上从来没有通过 URL 发送 cookie，所以我没有充分的理由关闭 use_only_cookies。我不能保证在我到达这里之前制作这个应用程序的不合适的人没有利用这个`bug_compat_42`东西来设置会话变量，但是我希望这个问题不那么随机。

编辑：

在进一步调查中，我发现 Session 根本没有被破坏，但最终用户正在获得一个新的会话 ID。旧会话仍然完好无损地存在于服务器上，但在他们浏览时会随机启动一个新会话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T19:43:49.867

这里的问题原来是他们的浏览器将会话 cookie 设置为过早过期。我已经用这个你永远不必使用的肮脏、肮脏的黑客解决了这个问题。我对此并不感到自豪，但如果这对任何事情有所启发，请随时让我进入：

```
if (!headers_sent()) {
    if ($_COOKIE["PHPSESSID"] != "") {
        setcookie("PHPSESSID", $_COOKIE["PHPSESSID"], time()+43200, "/", ".mydomain.com");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:58:08.900

你能提供更多关于你的设置的信息吗？

我的第一个想法是随机清除您的临时文件目录。如果您使用的是标准 LAMP 设置，PHP 会将会话数据文件存储到 /tmp。如果它们被清理过程从那里删除，您将丢失会话。

编辑：我现在正在重新考虑这个问题。如果只有特定的用户组受到影响，那就不太可能了。

cookie设置如何？我会确保这些人没有使用动态代理之类的东西，并且您的 cookie 是为您网站的根域设置的。他们是否有可能将一些隐私清理软件（例如 CCleaner）设置为可能会删除其 cookie 的计划任务？

我会在他们的一台计算机上站起来，将 Firebug 扔到其中一台 Firefox 机器上，并检查 HTTP 请求以查看 cookie 是否被正确发送。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T16:01:26.260

我会在这些机器上安装一些 http 嗅探器，如[httpwatch](http://www.httpwatch.com)（付费但物有所值）或[fiddler](http://www.fiddler2.com)（免费），并查看会话 cookie 发生了什么（我认为它是 PHPSESSID，但不确定）。如果由于代理、奇怪的 apache 配置或其他原因在会话中间删除或更改了 cookie，这将是检测它的最佳方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-12T05:07:00.170

我知道这已经晚了。但仅适用于也有同样问题的一些人。

**[如果您加密和解密您的数据]**

我已经解决了这个问题，并花了我一段时间来找出问题所在。它不断为同一用户创建新的会话 ID。原来加密数据和解密数据是不一样的。解密数据返回一些额外的空格。从数据库或您使用的任何存储发送和返回时，请尝试检查您的数据值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-05T12:04:35.203

在我的项目中，一个库用于保护会话，有时我观察到我的会话突然被破坏。

[https://github.com/ezimuel/PHP-Secure-Session/blob/master/SecureSession.php](https://github.com/ezimuel/PHP-Secure-Session/blob/master/SecureSession.php)

首先我想知道这个库的目的是什么，我们也可以从 php.ini 中进行这些设置。

KEY_...一个新创建的这个KEY有什么用。

当我在 open() 中使用 print_r 时，我得到以下示例结果

```
Hqx_SecureSession Object
(
    [_debug:Hqx_SecureSession:private] => 
    [_key:protected] => 5ò™6žÝ°rIÐß'k Êii07ÀtCzªt@ü¸"‡ÄCžA¼ÿ£g{IP
    [_path:protected] => c:\hqp\xampp_1.7.4\tmp\
    [_name:protected] => PHPSESSID
    [_ivSize:protected] => 16
    [_keyName:protected] => KEY_PHPSESSID
    [_cookieParams:protected] => Array
        (
            [lifetime] => 7200
            [path] => /
            [domain] => dev.autoquotes.insurance.com
            [secure] => 
            [httponly] => 1
        )

    [_sessionId:protected] => 
    [_logger:Hqx_SecureSession:private] => 
)
htq827r4rjh9ob05nhlqb8vmd5ai52djb0bd0l42vk9un26df541c:\hqp\xampp_1.7.4\tmp 
```

# c++ - 等待多个事件 C++

> ID：916546
> 
> 赞同：6
> 
> 时间：2009-05-27T15:53:35.353
> 
> 标签：c++, multithreading, posix, pthreads

是否有推荐的方法来等待多个输入。例如，我希望我的程序能够接收来自 3 个来源的输入：

监听线程条件，例如 pthread_cond_wait()

从标准输入中获取数据，例如 getline()

监听套接字，例如 accept()

实现这一目标的最佳方法是什么？每个不同的输入源都需要一个线程吗？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T16:10:23.120

不需要单独的线程等待`accept(2)`和`stdin`-`poll/select`在这里使用。代替条件变量，在线程之间创建一个管道（如果我们谈论 CV，你已经有线程），在同一时间等待它，`poll`并在事件发生时写入它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T16:09:21.033

您可以使用系统调用在不使用多个线程的情况下侦听多个*文件描述符。*[`select(2)`](http://linux.die.net/man/2/select)您可以使用[`pthread_cond_timedwait`](http://www.opengroup.org/onlinepubs/000095399/functions/pthread_cond_timedwait.html)超时等待条件变量，这样您等待的时间不会超过特定时间。

我认为想要同时等待条件变量或某种文件描述符是非常不寻常的——如果你绝对确定这是你想要做的，你将不得不使用多个线程，一个线程调用`pthread_cond_wait`/`pthread_cond_timedwait`和另一个线程调用`select`或其他一些 I/O 函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-26T13:25:26.713

在现代 Linux 上，最好的方法是根本不使用`pthread_cond_wait`。只需使用[eventfd](http://linux.die.net/man/2/eventfd)，这将使您能够使用 select/poll/epoll 侦听多个事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T16:09:18.427

看起来这三个不同的消息传递选项对于单个线程来说是互斥的。单个线程在等待线程条件时如何从标准输入读取？

如果您真的不想生成三个线程，我能理解的唯一选择是以某种方式修改或参数化线程、流和套接字库以获取对同步对象的引用。

# database - 联系人管理系统架构

> ID：916550
> 
> 赞同：4
> 
> 时间：2009-05-27T15:54:06.320
> 
> 标签：database, database-design, schema

我正在寻找可以在为联系人管理系统设计数据库时参考的东西。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T17:55:57.400

谷歌建议：

[http://www.databaseanswers.org/data_models/](http://www.databaseanswers.org/data_models/)

# python - python/lua 的 Swig 绑定无法正确初始化成员数据

> ID：916555
> 
> 赞同：0
> 
> 时间：2009-05-27T15:55:27.957
> 
> 标签：python, lua, swig, initialization

我正在尝试为一组 C++ 类构建一组 Lua 绑定，但一直在玩弄 Python，看看我是否能得到更好的结果。在这两种语言中，绑定似乎都有效，但是，当我初始化包含其他类成员的类的实例时，似乎不能保证这些数据成员被初始化。

例如，上课：

```
class MyClass : public ParentClass // (Obviously) not a real class
{
    public:
        SomeClass sc;
        OtherClass oc;
};//Note that none of my classes have a constructor or destructor; this is by design. 
```

当我为这样的类生成绑定时，我可以执行如下语句：

```
var = module_name.MyClass()
print(var.sc.x, var.sc.y) 
```

我将预期的垃圾值打印到屏幕上。但是，如果我尝试打印有关 OtherClass 的实例的任何内容，很明显它已“被排除”——在 Lua 中它根本没有元表，而在 Python 中执行 dir(var.oc) 只提供默认函数。但是，如果我这样做：

```
var.oc = module_name.OtherClass() 
```

oc metatable / dir(oc) 调用是我所希望的，它可以按预期处理。

任何人都可以提供任何见解，为什么只有 - 一些 - 成员数据被初始化？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T17:46:04.517

原来这个问题与我遇到的另一个问题有关。有关解决方案，请参阅[此线程](https://stackoverflow.com/questions/941626/basic-assignment-of-swig-wrapped-variables-fails)。

# versioning - 在构建托管/SAAS 应用程序时，如果允许客户自定义，您如何管理多个版本？

> ID：916556
> 
> 赞同：5
> 
> 时间：2009-05-27T15:56:14.817
> 
> 标签：versioning, release-management, hosted-app, saas

假设您正在构建一个计算器应用程序。您将允许客户使用自己的徽标和 CSS 样式表自定义此计算器。客户将他们的域指向您托管的计算器，该应用程序将为每个客户提供正确的主题。例如：

*   *www.AcmeCalculator.com*将提供带有 Acme 标志的计算器，以及他们创造的平淡的企业风格。
*   *www.HellzCalc.com*将为计算器提供一些地狱天使骑自行车的标志和他们创建的黑色、血红色主题。

你推出了 Calculator 1.0，每个人都编写了他们的样式来使用这个版本。

下个月你准备发布 Calculator 1.1，它添加了一个新特性，比如说“科学模式”，它需要你添加一些新的 UI——在这个例子中是 HTML——组件。这意味着如果你推出 1.1，你将打破你客户的一些风格。

我想出的最佳解决方案是让应用程序的多个版本保持运行。例如：

*   *www.AcmeCalculator.com*解析到您的应用服务器，该服务器检查 Acme 当前的版本，并转发到*www.AcmeCalculator.com/1.0*
*   *www.HellzCalc.com*解析到您的应用服务器，它注意到他们正在新的 1.1 版本上运行，因为他们进入了更新的 CSS 以在新版本上工作并单击“完成升级”按钮或其他任何东西，所以他们得到重定向到“ *www.HellzCalc.com/1.1*

该系统的一个问题是，您将不可避免地遇到从不投资升级的懒惰客户。您将同时运行 200 个版本，试图修复每个版本中的错误，基本上会发疯。

一种解决方案是使用您每月托管费用的一部分来雇用“UI 迁移团队”，该团队将是一组设计师，他们唯一的工作就是不断让客户排队运行最旧的版本并调整他们的 CSS 并验证他们在最新版本上运行。这将允许您同时仅支持 X 个版本，其中 X 是您在 UI 迁移团队中投入多少资金的函数，添加资源以加快或减慢它们。

同样的想法也适用于数据库更改：Calculator 1.0 和 1.1 在数据库 1.0 上运行，但 Calculator 1.2 在数据库 1.1 上运行，等等。您可以添加带有版本名称的模式，并使用类似的“数据迁移团队”来移动数据架构 1.0 到架构 1.1，最终在没有（应用）客户端时删除架构 1.0。

我敢肯定这种类型的问题以前出现过，我想看看其他人是如何解决的。也许甚至有一个“最佳实践”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T17:45:22.943

除非您在企业领域并且您的客户需要对其应用程序进行大量定制并且您可以相应地向他们收费，否则我会避免这种情况。正如您所发现的，这是产品管理噩梦的冰山一角。SaaS 变得如此流行的原因之一是很难在不同的版本上管理不同的人，并且很难让人们升级。

这样做了几次（我是背景的产品经理，而不是工程师，所以我可能会感到与工程师必须实施的痛苦几乎一样严重），我建议使用可配置的参数。通常，您可以为此类配置收取额外费用。也就是说，基本价格几乎没有定制，更高的层级允许 CSS 定制、品牌等。请参阅 JobScore.com 以获取示例。为此收费的一个很好的理由是，小公司不在乎也不会付钱，但大公司想要这个功能，不会那么在意成本。获得这种价格溢价对于成功的 SaaS 产品至关重要：大多数 SaaS 公司 80% 的收入来自其产品的“企业”版本，因此您需要相应地定价。

无论如何，回到最初的问题：不要允许不同的版本，这可能会扼杀你的公司。相反，提供配置/变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-13T21:27:16.230

与其拥有并行的定制版本，不如实现一个可供所有客户访问的可**配置版本。**

编写代码会给你带来更多麻烦，但是当你启动并运行你的应用程序时，你只需要担心你的新需求是什么，而不是那些新需求会破坏什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-14T16:25:23.263

这是我在软件服务版本控制最佳实践中找到的一篇好文章，我相信这同样适用于您的问题。它基本上描述了两种可能的选项以及每个选项的优缺点。

1.  维护不同版本的软件。
2.  维护软件的单一基线版本。

[https://www.slideshare.net/TorryHarris/soa-serviceversioningbestpractices](https://www.slideshare.net/TorryHarris/soa-serviceversioningbestpractices)

在推出企业 SAAS 产品时，在某些时候，您不可避免地会支持软件产品的多个版本（如果您不支持这样的策略，就有失去客户的风险）。这种方法有一些好处，特别是它支持在需要时大规模重写 api/服务，同时不会因向后兼容性问题而陷入困境。然而，维护 200 多个版本的软件是不谨慎的，因此需要平衡限制支持的版本数量，并且还需要采用不推荐的策略来推动客户使用最新版本的产品。

# jquery - JQuery FullCalendar 1.1 插件 - 它支持事件修改吗？

> ID：916559
> 
> 赞同：1
> 
> 时间：2009-05-27T15:57:01.930
> 
> 标签：jquery

有谁知道当前版本的 JQuery FullCalendar 插件 1.1 版是否支持事件添加/删除/更新？

我需要在 asp.net mvc 应用程序中加载带有来自数据库的事件的日历，允许用户添加/更改/删除事件，然后将任何更改保留回数据库。

这是可行的吗？

感谢您的任何反馈！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T23:40:17.457

jQuery [FullCalendar](http://arshaw.com/fullcalendar/docs/)插件没有添加/删除/更新功能。但是，这就是我使用 MVC 提供该功能的方式：

*   [创建一个控制器操作，将数据库中的日历信息作为CalEvent](http://arshaw.com/fullcalendar/docs/#calevent-objects)对象数组返回
*   使用日期作为参数，为“添加”日历事件创建视图和关联的控制器操作，其中包含开始/结束日期、标题等字段。
*   使用 EventId 或日期作为参数创建用于编辑事件的控制器操作。您可能可以重用用于“添加”的相同视图。
*   在创建日历的选项中，为[`dayClick()`](http://arshaw.com/fullcalendar/docs/#triggered-events)要用于添加新日历事件的事件添加处理程序。[`eventClick()`](http://arshaw.com/fullcalendar/docs/#triggered-events)为要用于编辑或删除现有事件的事件添加处理程序。
*   在分别调用 dayClick() 或 eventClick() 时重定向到添加/编辑视图，然后在更新数据库后重定向回日历。如果第一项正确完成，日历将反映添加/编辑或删除。

# django - Django 模型继承：重复的类字段

> ID：916560
> 
> 赞同：0
> 
> 时间：2009-05-27T15:57:12.007
> 
> 标签：django, django-models

我有一个 Django 项目，其中每个模型都继承自一个通用的“对象”模型——它只定义了两个字段——对象的 ID（因此整个系统中的每个对象都有一个唯一的标识符）和一个“类型”。类型是特定实例的对象类型。这是一种“非规范化”字段，例如，可以更快地沿着树从 Object 移动到 Person。

基本上，我在其中一个继承模型中有一个字段，它与从 Object 继承的另一个类具有相同的名称 - 这意味着沿着关系传播的字段被覆盖。

我只是想知道是否有其他人有过类似的经历，以及是否有任何相当优雅的方法来解决它——除了在继承模型中重命名字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T16:07:17.480

也许重命名是合适的。如果您的某个字段与类具有相同的标识符，您可能会破坏一些命名约定（当然，这些只是约定）。

请参阅[PEP 8](http://www.python.org/dev/peps/pep-0008/)，*命名约定*部分。

```
Class Names

  Almost without exception, class names use the CapWords convention.
  Classes for internal use have a leading underscore in addition.

Method Names and Instance Variables

  Use the function naming rules: lowercase with words separated by
  underscores as necessary to improve readability. 
```

# asp.net - ASP.NET (MVC) - 将页面呈现到文件

> ID：916568
> 
> 赞同：2
> 
> 时间：2009-05-27T15:58:58.853
> 
> 标签：asp.net, asp.net-mvc, viewengine

我必须创建一堆静态 html 文件作为控制台/winform 作业。当前的解决方案使用字符串生成器。将 ASP.NET-MVC 与强类型视图页面 (System.Web.Mvc.ViewPage) 一起使用后，我想知道是否可以在不构建 ASP.NET 解决方案的情况下利用这些视图页面并将它们输出到流或文件中。

本质上，我想创建视图页面，传入强类型对象，然后渲染结果。

我也对其他视图引擎持开放态度。

如果这最终需要带来整个厨房水槽，那么我可以做一个字符串生成器样式。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T16:06:59.290

请注意这是否有帮助，因为我不清楚您的问题。

```
[控制器动作]
公共无效关于（）
{
    StringWriter builder = new StringWriter();
    TextWriter originalWriter = Response.Output;
    Response.SwitchWriter(builder);
    RenderView("关于");

    字符串 html = builder.ToString();

    originalWriter.Write(html);
}

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T21:27:11.263

我个人喜欢上面提到的 StringTemplate 选项，但您实际上可以在桌面应用程序中托管 ASP.NET 运行时。

[West Wind Technologies](http://www.west-wind.com)的Rick Strahl提供了如何设置的详细示例： [使用 ASP.Net 运行时扩展具有动态 HTML 脚本的桌面应用程序](http://www.west-wind.com/presentations/aspnetruntime/aspnetruntime.asp)

以下是其他几个示例：

*   [代码项目：在桌面应用程序中使用 ASP.NET 运行时](http://www.codeproject.com/KB/dotnet/usingaspruntime.aspx)
*   [MSDN 杂志：ASP。NET 客户端托管与 Cassini](http://msdn.microsoft.com/en-us/magazine/cc188791.aspx) —— 如何使用 ApplicationHost 类的具体细节。
*   [Andrew Peter 的博客：进程内 ASP.NET MVC Web 窗体视图渲染](http://andrewpeters.net/2008/11/19/in-process-aspnet-mvc-web-form-view-rendering/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T16:07:37.370

你需要的是一个模板引擎。我会推荐你[​​ StringTemplate](http://stringtemplate.org/)。它可以用作独立引擎，并且具有 .NET 版本。有一篇 CodeProject[文章](http://www.codeproject.com/KB/codegen/DotNetCodeGeneration.aspx)可以帮助您入门。

如果没有 ASP.NET 基础结构，AFAIK ASP.NET WebForms 就无法运行。

# ruby - 在 Ruby 中，“接收者”指的是什么？

> ID：916572
> 
> 赞同：24
> 
> 时间：2009-05-27T15:59:28.790
> 
> 标签：ruby, terminology

我正在阅读一个文档，该文档讨论了一种具有接收器的方法。什么是接收器？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-27T16:08:51.970

在 Ruby（以及其他从 SmallTalk 中获得灵感的语言）中，对象被认为是发送和接收“消息”。

在 Ruby 中，所有事物的基类 Object 都有一个发送方法：[Object.send](https://ruby-doc.org/core-3.0.0/Object.html#method-i-send)例如：

```
class Klass
  def hello
    "Hello!"
  end
end
k = Klass.new
k.send :hello     #=> "Hello!"
k.hello           #=> "Hello!" 
```

在这两种情况下，k 都是“hello”消息的*接收者*。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T16:04:39.373

在最初的 Smalltalk 术语中，“对象”上的方法被称为对象的消息（即，您没有在对象 foo 上调用方法，而是向对象 foo 发送了消息）。所以 foo.blah 正在发送“foo”对象正在接收的“blah”消息；“foo”是“blah”的接收者。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-27T16:00:54.450

之前的对象。

将调用方法 xy 想象为“向对象 x 发送指令 y”。

这是一种 smalltalk 的思维方式，它会在您接触到 Ruby 的一些更高级的特性时为您服务。

# delphi - Delphi "DOMVendor" Open XML and Xerces: known limitations?

> ID：916582
> 
> 赞同：2
> 
> 时间：2009-05-27T16:00:58.757
> 
> 标签：delphi, dom, openxml, msxml, xerces

Is it safe to use Open XML instead of MSXML as the DOM Vendor with Delphi's IXMLDocument interface?

Are there known limitations in basic functionality which I should be aware of?

And how do the Open XML and Xerces implementations differ? (Xerces needs additional libraries, while Open XML seems to be included in the executable iirc)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T04:09:16.017

Depends on what you need. MSXML is very feature complete and supports things like Schema and XPath among others. IIRC, OpenXML only provides DTD support and has not gotten much TLC in recent years. I have great respect for Dieter Köhler's work since he was a pioneer in the early days of Delphi and XML. I don't know if I would recommend it as the best solution today.

If you need IXMLDocument OpenXML is certainly an option, but I would stick with MSXML unless you have specific concerns about MSXML (e.g. need features of a specific version). If you are open to other libraries, here is a non-exhaustive list of other options you may want to consider:

*   DIXML - Commercial - Current and very feature complete (www.yunqa.de/delphi/doku.php/products/xml/index)

*   XMLPartner - Open Source - Not sure of current status, check CG NGs for recent updates (sourceforge.net/projects/tpxmlpartner)

*   OmniXML - Open Source, good design, similar API to IXMLDocument IIRC (www.omnixml.com)

*   NativeXML - Commercial, Non-Validating, very fast, non-standard but easy API (www.href.com/nativexml) **Note** ; NativeXML is by Nils Haeck of SimDesign.nl Nils' site is down at the moment..a long story behind this.

*   FWIW - I personally have used NativeXML and OmniXML and have no complaints. I have been looking at DIXML since it has a *very* impressive feature set that I need for a specific project.

David

# geolocation - 是否可以找到两个路由器之间的距离？

> ID：916584
> 
> 赞同：1
> 
> 时间：2009-05-27T16:01:19.003
> 
> 标签：geolocation, geospatial

我正在考虑制作一个有趣的项目，它可以告诉我我在整个房子的位置。我的想法是将两个路由器放在房子的不同位置，高度相同，然后发送 ping 请求或其他东西并检查延迟，由此它应该能够对我在房子里的位置进行三角测量。

我知道这只有在我与路由器处于同一级别时才会真正起作用，但我想知道这是否是一种可靠的方法。以前有没有其他人尝试过这样做，或者是否有更好或更便宜的方法来完成查找计算机的位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T16:25:59.970

[XO-OLPC 笔记本电脑使用声音](http://wiki.laptop.org/go/Acoustic_Tape_Measure)而不是无线电波来测量它们之间的距离。

假设您的 2 个路由器相距 1,000 英尺，而您站在它们之间。无线电信号只需 0.0000005 秒即可到达 500 英尺。我认为您的计算机时钟不够准确，无法测量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T16:10:04.260

我不认为ping时间是距离的可靠指标。如果路由器是无线的，则可能有其他因素会改变它们之间的延迟。也许在一天中的某些时候，该区域会存在更多的电磁干扰，这会影响延迟。

至于通过互联网确定距离，这也是不可能通过延迟来确定的，因为您正在通过许多不受您控制的路由器。有些可能会对它们产生很大的负载，这会导致更多的延迟并增加延迟（或减少），从而扭曲比例。

我不认为真的有办法在 3d 空间中找到路由器的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T16:20:24.677

您可能需要从 WiFi 系统中的无线电访问较低级别的信息。

XO-OLPC 笔记本电脑有一个测距应用程序，它可以告诉你两台 XO 笔记本电脑之间的距离，但我从来没有尝试过，所以这当然是可能的。

您还需要（准确）测量基站之间的距离。

# php - 如何为路由器中的键指定动态默认值，Zend 框架

> ID：916587
> 
> 赞同：0
> 
> 时间：2009-05-27T16:01:35.960
> 
> 标签：php, zend-framework, routing

这个问题与[这个有关](https://stackoverflow.com/questions/916143/adding-a-route-to-the-a-router-in-zend-framework)

如何将类别部分的默认设置为请求 url 中的类别值？

```
$Router=$this->_front->getRouter();
$CategoryRoute = new Zend_Controller_Router_Route('category/:category/:controller/:action/*',
           array(
                 'controller' => 'index',
                 'action'     => 'index',
                 'category'   => 'aaa'
           ));
$Router->addRoute('category', $CategoryRoute); 
```

换句话说，在我构建这条路线时，我需要将值 [aaa] 作为类别的值。[category] ​​总是有一个值，否则它将使用默认路由。

我的意思示例：
如果我使用 url [http://baseurl/category/mycat/index 浏览](http://baseurl/category/mycat/index)
网站， 我将被路由到 controller=index、action=index、category=mycat。
但是，在我使用 Zend_View::url() 帮助器的所有视图文件中，链接将指向：
[http://baseurl/category/aaa/somthing/somthing](http://baseurl/category/aaa/somthing/somthing) （使用上面的确切路线）
虽然我实际上需要他们指向：
[http://baseurl/category/mycat/somthing/somthing](http://baseurl/category/mycat/somthing/somthing)

发生这种情况是因为 category 的默认值是作为常量写入路由中的，而不是以某种方式从当前 URL 中获取的。
我目前通过自己从 URL 中提取类别并将其设为默认值来解决此问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T20:35:24.770

你的帖子有问题吗？:)

如果我说对了 - 你设置你的默认*类别*，如果你打电话，它将被使用

```
$this->url(array(),'category'); 
```

但是当你使用

```
$this->url(array('category'=>'my-category'),'category'); 
```

它将返回*category/my-category/index/idnex*而不是 *category/aaa/index/index*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-17T20:12:19.880

如果你使用

```
$this->url(array(), 'category'); 
```

它应该工作。

但请记住：只要您坚持使用默认值，您将始终获得一个简单的 /category 链接，但是当使用不同的参数时，它应该根据当前 URI 返回正确调整的 URL。

IE。如果 URI 是 /category/aaa/index/index 那么 $this->url(array(), 'category'); 将返回 /category，如果 URI 是 /category/xxx/index/index 则 $this->url(array(), 'category'); 将返回 /category/xxx，如果 URI 是 /category/xxx/index/process 那么 $this->url(array(), 'category'); 将返回 /category/xxx/index/process 等。

# c# - 监控许多网页/rss 提要

> ID：916588
> 
> 赞同：2
> 
> 时间：2009-05-27T16:02:29.610
> 
> 标签：c#, multithreading

我想同时监视许多网页/ rss 提要并定期轮询它们（它们可能都有不同的更新频率）。我正在考虑为每个要镜像的源创建一个线程，该线程将无限循环，然后在处理获取的数据后休眠直到下一次更新。

有没有人有更好的想法或如何做到这一点的例子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T16:06:37.137

使用计时器每 1（或 5）分钟启动一次。在计时器回调中，循环遍历您需要检查的 url，并验证它们是否应该被检查（正如您在评论中所说，它们将具有不同的同步时间）。您可以准备一个适当的结构来保存 url 和它们的超时时间，以及它们最后的时间。

如果一个 url 可以同步（时间已经过去），启动一个异步 HttpWebRequest 来获取它。这样，您将所有接收部分卸载到线程池线程，因此它不会影响您的主计时器回调线程。

请注意 - 如果您对响应进行大量处理，您可能希望在 HttpWebRequest 回调中启动常规线程以进行额外处理，或者实现某种队列，以便尽快释放线程池线程。

这是一个很好的解释如何发出异步请求： http: [//www.devnewsgroups.net/group/microsoft.public.dotnet.framework/topic23172.aspx](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework/topic23172.aspx)

您也可以通过 Google 搜索更多示例，但这是一个好的开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T16:07:00.833

为什么不只在一个时钟上同步它，例如让它们在每小时（10、20、30 等）的 10 点更新，而不是让所有线程在 10 分钟内随机更新。为什么需要为每个页面/提要创建一个线程？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T16:11:02.400

使用 Timer 对象通过 BackgroundWorkerThread 对象触发进程，以便您可以在后台处理事物。根据您拥有的提要数量，您可以考虑在较短的时间间隔内进行“交错”更新。假设每 5 分钟，工作线程启动，转到要监视的提要列表中的下一个提要并检查更新。

我相信您已经从一些提要阅读器那里看到，一次更新所有提要并不总是最好的解决方案，因为它可能会使用户界面冻结一段时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T16:13:10.713

我创建了一个窗口服务来完成您所描述的内容。每 n 分钟，守护进程唤醒，读取一个带有它需要获取的 url 的 XML 文件，处理所有数据并再次进入睡眠 n 分钟。我有一个线程用于获取数据，另一个线程用于监视 XML 文件的更改。XML 文件可以通过 Web 界面进行更新。

正如 yx 所指出的，没有必要每页创建一个线程，但是，如果您有很多 url 要 fecth，您可以将您的 url 分配到 100 个包中（例如），然后为每个包创建一个线程。然后，您必须等待最后一个线程完成，然后再让守护程序再次进入睡眠状态。

# c# - 如何编写两个参数都是接口的重载运算符

> ID：916594
> 
> 赞同：3
> 
> 时间：2009-05-27T16:04:36.860
> 
> 标签：c#, interface, operators, operator-overloading

我的大部分东西都在使用界面。我找不到创建重载运算符 + 的方法，它允许我对实现 IPoint 接口的任何对象执行加法

代码

```
 interface IPoint
{
    double X { get; set; }
    double Y { get; set; }
} 

```

```
 class Point : IPoint
{
   double X { get; set; }
   double Y { get; set; }

   //How and where do I create this operator/extension  ???
   public static IPoint operator + (IPoint a,IPoint b)
   {
     return Add(a,b);
   }

   public static IPoint Add(IPoint a,IPoint b)
   {
      return new Point { X = a.X + b.X, Y = a.Y + b.Y };
   } 
}

   //Dumb use case :
public class Test
{
   IPoint _currentLocation;

   public Test(IPoint initialLocation)
   {
     _currentLocation = intialLocation
   }
   public MoveOf(IPoint movement)
   {

      _currentLocation = _currentLocation + intialLocation;
     //Much cleaner/user-friendly than _currentLocation = Point.Add(_currentLocation,intialLocation); 
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T16:06:08.917

你没有。想象一下，如果您有两个 IPoint 实例 a 和 b，它们都是不同的类（实现 IPoint）。现在调用“a + b”。哪个 operator+ 被调用？返回哪个具体类型？

编辑：对不起，澄清您的评论，“不在 C# 中”。关于你是否应该能够做到这一点，我有一些哲学辩论，因为我怀疑你会造成一些严重的混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T16:22:47.777

我不认为你能做你所要求的，我过去看了看，结果是空的。问题是，即使在您的使用示例中`.Add`，您仍然需要将`movement`参数强制转换为 a`Point Type`才能访问该方法。我相信这是 C# 的一个限制，如果我错了，我会很高兴知道这一点。

我的建议是，如果你**知道**你*总是*会得到一个`Point Type`，`MoveOf`那么总是将它转换到`Point`方法内部是安全的，但是如果是这种情况，那么你应该接受`Point`作为参数。

我唯一能说的另一件事是，如果您`Point Type`最初创建 a 并将其传递给，则可以在强制转换之前`MoveOf`检查`movement`inside的类型。`MoveOf`当然，这里的问题是您最终必须对继承并使用该方法的**所有类型执行此操作。**`IPoint``MoveOf`

# c# - .IsNotEqualTo 不比较 Null

> ID：916596
> 
> 赞同：2
> 
> 时间：2009-05-27T16:05:10.633
> 
> 标签：c#, .net, subsonic

此查询将仅返回 Active=true 和 Exempt=false 的所有记录。它还应该返回 Active=true 和 Exempt IS NULL 的任何记录。我猜 .IsNotEqualTo 不与任何具有空值的记录进行比较？有没有办法在不设置默认值的情况下解决这个问题？

```
UserCollection ActiveUsersNotExempt = new UserCollection();
ActiveUsersNotExempt = DB.Select().From<User>()
                .Where(User.Columns.Active).IsEqualTo(true)
                .And(User.Columns.Exempt).IsNotEqualTo(true)
                .ExecuteAsCollection<UserCollection>();` 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T16:12:14.257

使用 AndExpression 如下获取嵌套约束（Exempt 不为真或为空）：

```
UserCollection ActiveUsersNotExempt = DB.Select().From<User>()
  .Where(User.Columns.Active).IsEqualTo(true)
  .AndExpression(User.Columns.Exempt).IsNotEqualTo(true)
  .Or(User.Columns.Exempt).IsNull()
  .ExecuteAsCollection<UserCollection>();` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T16:11:41.323

在 SQL 中，应用于 null 的运算符不会返回 true 或 false，而是返回 null。（此规则的一个例外是“IS”运算符）。

也就是说，`exempt != true`exempt 为 true 时表达式为 false，exexit 为 false 时为 true，extent 为 null 时为 null。

如果您希望您的条件在 exclude 为 false 或 null 时匹配，您需要构造如下查询：

```
active = true AND (exempt = false OR exempt IS NULL) 
```

或者

```
active = true AND COALESCE(exempt, false) = false 
```

希望这能让您对幕后发生的事情有所了解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T16:08:44.513

在 AND 子句中添加合并运算符，导致 NULLS 为“假”

```
.And(User.Columns.Exempt ?? false).IsNotEqualTo(true) 
```

# c++ - C++ 编译器可以重新排序结构中的元素吗

> ID：916600
> 
> 赞同：13
> 
> 时间：2009-05-27T16:06:14.330
> 
> 标签：c++, struct, element

C++ 编译器（特别是 g++）可以重新排序结构的内部元素吗？

我看到一些奇怪的行为，其中我的结构包含以下内容：

```
Struct SomeStruct{
   ...
   ...
   long someLong;
   long someLongArray[25];
   unsigned long someUnsignedLong;
   unsigned long someUnsignedLongArray[8];
   unsigned long int someUnsignedLongInt;
   ...
   ...
}; 
```

当我将输出写入文件时，*someUnsignedLongArray*和*someLongArray*的顺序似乎颠倒了（即*someLongArray[]*中的元素出现在*someUnsignedLong之后，而**someUnsignedLongArray[]*的元素出现在*someLong*之后）。这可能吗？？

谢谢

* * *

更新：根据要求，我正在使用以下内容写出结构：

```
int fd = open(fspec,O_RDWR|O_CREAT|O_TRUNC,0666);
int writeRes =  write(fd,(char *)&someStruct,sizeof(SomeStruct)); 
```

为了完整起见，这里是完整的结构：

```
struct SomeStruct{
byte someByte;
byte someByteArray[6];
char someChar;
char someCharArray[5];
char someCharArrayArray[3][5];
short someShort;
signed short someShortArray[2];
unsigned short someUnsignedShort;
unsigned short someUnsignedShortArray[8];
int someInt;
int someIntArray[3];
int someIntArrayArrayArrayArray[4][3][2][6];
int *pSomeInt;
unsigned int someUnsignedInt;
unsigned int someUnsignedIntArray[9];
long someLong;
long someLongArray[25];
unsigned long someUnsignedLong;
unsigned long someUnsignedLongArray[8];
unsigned long int someUnsignedLongInt;
long long someLongLong;
long long someLongLongArray[5];
bool someBool;
bool someBoolArray[3];
unsigned long long someUnsignedLongLong;
unsigned long long someUnsignedLongLongArray[5];
unsigned long long someUnsignedLongLongArrayArray[5][2];
unsigned long long int *pSomeUnsignedLongLongInt;
}; 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-27T16:20:24.490

它通常不能重新排序元素，不。

一个例外是如果有一个访问说明符将它们分开：

```
struct Foo {    
  A a;
  B b;
  C c;
private:
  D d;
  E e;
  F f;
}; 
```

`a`,`b`和`c`保证按此顺序存储，`d`,`e`和`f`保证按此顺序存储。但是不能保证和相对于和`a`存储在哪里。`b``c``d``e``f`

要记住的另一件事是编译器可以根据需要插入尽可能多的填充，即使它没有重新排序任何内容。

这是标准的相关部分：

第 9.2.12 节：

> 分配没有中间访问说明符的（非联合）类的非静态数据成员，以便后面的成员在类对象中具有更高的地址。由访问说明符分隔的非静态数据成员的分配顺序未指定 (11.1)"

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T16:13:12.863

它不能，请参阅[C 结构中的自动字段重新排序以避免填充](https://stackoverflow.com/questions/867471/automated-field-re-ordering-in-c-structs-to-avoid-padding)和[为什么 GCC 不优化结构？](https://stackoverflow.com/questions/118068/why-doesnt-gcc-optimize-structs)了解更多信息。

我不知道您所说的“反转”是什么意思，也许您应该添加一些代码和输出。

# c# - 为什么此对象相等性测试失败？

> ID：916608
> 
> 赞同：3
> 
> 时间：2009-05-27T16:07:11.130
> 
> 标签：c#

参加以下课程和单元测试。

```
public class Entity
    {
        public object Id { get; set; }

        public override bool Equals(object obj)
        {
            return this == (Entity)obj;
        }

        public static bool operator == (Entity base1, Entity base2)
        {
            if (base1.Id != base2.Id)
            {
                return false;
            }

            return true;
        }

        public static bool operator != (Entity base1, Entity base2)
        {
            return (!(base1.Id == base2.Id));
        }
    } 
```

* * *

```
 [TestMethod]
        public void Test()
        {
            Entity e1 = new Entity { Id = 1 };
            Entity e2 = new Entity { Id = 1 };
            Assert.IsTrue(e1 == e2); //Always fails
        } 
```

有人可以解释为什么它失败了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T16:11:19.360

您的`Id`财产是类型`object`。当您使用 1 作为每个实例的 Id 构造两个实例时，您最终会得到两个不同的盒装对象。然后，您将使用*引用*相等来比较这些对象。

建议的更改以解决此问题：

*   如果合适，`Id`将类型更改为类型。`int`
*   使用静态`object.Equals`方法比较 Ids 而不是 ==

这些中的任何一个都可以工作，但第一个是更可取的 IMO。

如果您有兴趣，还有其他各种方法可以使实现更简洁，但我知道这可能只是一个虚拟示例。一目了然的快速列表：

*   你应该`GetHashCode`和`Equals`.
*   您的`Equals`覆盖不应无条件地执行强制转换，因为如果对象的类型错误，则会引发异常。如果类型错误，则返回 false。
*   您当前的 == 实现可以简化为

    ```
    return base1.Id == base2.Id; 
    ```

*   您的 == 实现应该执行无效检查
*   通常最好通过返回来实现 != ，`!(base1 == base2)`除非您想要专业的行为。
*   `Equals`在非密封类中覆盖可能会出现问题。除非您计划继承，否则密封类是值得的（IMO - 这可能会引起争议）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T16:12:56.250

因为您依赖比较器的对象引用：

```
public object Id { get; set; } 
```

代替

```
 public static bool operator == (Entity base1, Entity base2)
    {
        if (base1.Id != base2.Id)
        {
            return false;
        }

        return true;
    } 
```

和

```
 public static bool operator == (Entity base1, Entity base2)
    {
        return object.Equals(base1.Id, base2.Id);
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T16:09:29.830

因为 e1.Id 和 e2.Id 是不同的对象。即使它们具有相同的值，它们也不是同一个对象，因此 base1.Id == base2.Id 失败。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T16:10:20.843

您对 equals 的实现只是比较引用，而不是对象的内容。您实际上是在比较两个指针，并且由于您创建了两个单独的对象，因此您的相等性将失败。

有几篇关于如何正确实现 Equals 的文章，这里是一个开始：

[http://weblogs.asp.net/tgraham/archive/2004/03/23/94870.aspx](http://weblogs.asp.net/tgraham/archive/2004/03/23/94870.aspx)

对于数据库实体，您可以通过仅比较数据库 ID 来执行快捷方式 Equals 实现，假设具有相同 ID 的两个对象在您的系统中被视为“相等”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T16:10:21.293

您的 Id 是一个对象，而不是一个 int。对于对象， == 运算符不会检查值是否相等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T16:10:14.663

因为您的 Id 属性是一个对象。

1（作为 int）被装箱到堆对象中，但每个 1 被装箱到一个单独的实例中。由于 Id 是一个对象，因此 base1.Id != base2.Id 条件检查*引用*相等而不是*值*相等，这正是您想要的。将 Id 更改为 int，或使用 Equals() 而不是 != 应该可以修复它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T16:11:59.497

如果你让你的`Id`成员成为一个`int`，它会工作的。但正如 CookieOfFortune 所说，当您比较两个对象时，它会查看它们是否是完全相同的对象，而不是它们是否具有相同的值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T16:13:25.797

将 Id 的类型更改为 int 或其他值类型。问题是您正在比较 2 个对象，我认为这是您重载 == 运算符来解决的问题

# c# - 传递可变数量的参数

> ID：916616
> 
> 赞同：5
> 
> 时间：2009-05-27T16:08:16.807
> 
> 标签：c#

我需要编写一个带有可变数量参数的函数。我读了一些关于 params[] 的内容，但我认为这对我来说行不通。我的函数需要获取可变数量的整数，然后为每个整数获取相应的布尔值。我必须遍历这些组合中的每一个并将它们输入到数据库中。只是想找人指出我正确的方向。谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-27T16:13:17.437

我建议构建一个结构，然后将它们作为参数传递。在我的示例中，您的结构代表某种分数：

```
public struct RaceScore
{
     public bool FinishedRace;
     public int Points;
} 
```

您的方法签名将是：

```
public void SaveScores(params RaceScore[] scores) 
```

这是调用 SaveScores 的示例：

```
RaceScore score = new RaceScore() { FinishedRace = true, Points = 20 };
RaceScore score2 = new RaceScore() { FinishedRace = false, Points = 15 };
SaveScores(score, score2); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-27T16:14:54.280

您可以使用参数来执行此操作，但参数需要是一些包含 int + bool 的类或结构。 `KeyValuePair<TKey,TValue>`如果您不想编写自己的类或结构，则在基类库中将起作用。

但是，如果您要遍历它们，我建议您`IEnumerable<T>`改用它，因为它更易于使用。

例如：

```
public void SaveValues(IEnumerable<KeyValuePair<int,bool>> values)
{
    foreach(var pair in values)
    {
        int intVal = pair.Key;
        bool boolVal = pair.Value;
        // Do something here...
    }
} 
```

同样的事情也适用于参数，即：

```
public void SaveValues(params KeyValuePair<int,bool>[] values) 
```

但是，这会迫使您创建一个数组。Using`IEnumerable<T>`将与数组一起使用，但也可以与值列表或 LINQ 查询结果等一起使用。这使得在许多情况下生成调用此函数更容易。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T16:12:11.587

没错 - 它不会像描述的那样工作。您可以做的是使用结构来连接 int 和 bool 值。结构的参数正在工作：

```
public struct IntBoolStruct {
   public bool BoolValue;
   public int IntValue;
}

public void YourMethod( params IntBoolStruct[] values ) {} 
```

编辑：根据您想要做什么，可为空的 int 也可能对您有所帮助。

```
public void YourMethod( params int?[] values ) {} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T16:25:56.257

另一个答案：你可以用一个简单的对象数组和参数来做到这一点。

 `````
 class paramstest {
        private void _passALot(params Object[] values) {
            System.Console.WriteLine(" [foreach]");

           foreach (object o in values) {
                System.Console.Write(o.ToString() + ", ");
            }

            System.Console.WriteLine(System.Environment.NewLine + " [for]");

            for (int i = 0; i < values.Length; i += 2) {
                int? testval = values[i] as Int32?;
                bool? testbool = values[i + 1] as Boolean?;

                System.Console.WriteLine(String.Format("Int: {0}, Bool: {1}", testval, testbool));
            }
        }

        public void test() {
            _passALot(1, true, 2, false, 3, true, "q", false);
        }
    } 
````  `给你

```
[前锋]
1，真，2，假，3，真，q，假，
 [为了]
诠释：1，布尔：真
诠释：2，布尔：假
诠释：3，布尔：真
诠释：，布尔：假

```

传递具有适当结构的字典或列表会更好:)

# jquery - jQuery 选择：向上遍历，然后向下遍历

> ID：916618
> 
> 赞同：6
> 
> 时间：2009-05-27T16:08:31.470
> 
> 标签：jquery, css-selectors

我正在努力解决如何使用 jQuery 选择特定元素。此处概述的条件：

*   在我的函数的相关点，`this`引用 a `span`。
*   这`span`可能是孩子、孙子或曾孙，但在层次结构的某个地方，它包含在`td`.
*   **我想`span`选择`td`.**
*   `span`可能是，`this`也可能是另一个`span`。
*   `span`要选择的标签是 contains 的直接子级`td`，因此`last-child`是可行的。但是，为了未来的灵活性，首选不假定它是直接子代的解决方案。

到目前为止，我正在使用它来选择正确的父元素：

```
$(this).parents('td') 
```

我不知道如何向下遍历 DOM 树以获取`span`selected 的最终内部`td`。谢谢！

**编辑**

根据我在下面的评论，也可以从 a`span`或中选择`div`，以最后一个为准。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T16:11:15.567

```
$(this).parents('td').children('span:last'); 
```

应该做的伎俩。

**编辑**

我没有注意到您不仅要与直系子女打交道。如果你想要所有的后代，那么你会使用

```
$(this).parents('td').find('span:last') 
```

我原以为`span`永远是`td`.

**最终编辑**

为了子孙后代的缘故（并让人们在未来更容易找到这个答案），因为这已经被接受为答案，Ben 在他的答案中提出了一个更优雅的解决方案，我将把它放在这里：

```
$(this).closest('td').find('div,span').filter(':last') 
```

正如 Ben 所说，您必须使用 JQuery 1.3`closest()`才能工作。干得好！:-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T16:39:56.540

在这种情况下，我更喜欢使用[最接近的，而不是](http://docs.jquery.com/Traversing/closest#expr)[parents](http://docs.jquery.com/Traversing/parents#expr)。您不必担心祖先中有两个或更多“td”元素。

```
$(this).closest('td').children("span:last") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T16:17:53.073

您要查找的函数是[find(expr)](http://docs.jquery.com/Traversing/find#expr)，它搜索所有后代节点：

```
$(this).closest('td').find('span:last') 
```

**编辑：**选择最后一个`div`或`span`：

```
$(this).closest('td').find('div,span').filter(':last') 
```

**编辑 2：** [Mark](https://stackoverflow.com/questions/916618/jquery-selection-traversing-up-then-back-down/916781#916781)提出了一个很好的观点，即使用[最接近（）](http://docs.jquery.com/Traversing/closest#expr)而不是[parents()](http://docs.jquery.com/Traversing/parents#expr)，但请注意，您需要为此使用 jQuery 1.3。

# c# - Microsoft Enterprise DAAB 和关闭连接

> ID：916622
> 
> 赞同：0
> 
> 时间：2009-05-27T16:08:52.467
> 
> 标签：c#, asp.net, sql-server-2005, daab

我注意到我们的一个内部应用程序正在使用 DAAB，并且它似乎存在某种连接泄漏。我想我记得当您使用以下代码时在某处读过：

```
Database db = DatabaseFactory.CreateDatabase("ConnectionString");
IDataReader rdr = db.ExecuteReader("sproc") 
```

连接已为您关闭，因此我进行了调查，但看起来并非如此。我对 DAAB 不太熟悉，有人知道会发生什么以及何时发生吗？此外，同一个应用程序有一堆类，如：

```
public class Example
{
   private Database db;
   public Example ()
   {
      db = DatabaseFactory.CreateDabase("ConnectionString");
   }

   public void Update(object o)
   {
      try
      {
         db.ExecuteNonQuery("sproc", o.parameter);
      }
      catch...
      }
      }
   }
 } 
```

起初这似乎有点令人畏惧，但就像我说的那样，我对 DAAB 并不熟悉。如果连接没有在 DAAB 中自行关闭，这些类会导致泄漏吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-31T17:16:54.207

entlib 3.0 中的 ExecuteReader 方法存在问题。这是为实现事务范围所做的修复，但在处理大量数据时出现错误。因此，他们已经对此进行了修复，并且该问题是由于该修复而导致的。因此，当您使用 ExecuteReader 方法时，您必须关闭连接。最好在上面提到的 using 块中使用它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T16:30:45.280

您是否尝试过配置数据阅读器？我总是这样做，并且没有任何挥之不去的联系。

```
Database db = DatabaseFactory.CreateDatabase("ConnectionString");
using (IDataReader rdr = db.ExecuteReader("sproc")) {
    // Use the data reader
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T16:20:07.733

我也在使用 Oracle 数据库上的 DAAB 调查泄漏 - 使用 Microsoft 驱动程序时一切正常，但我在使用 Oracle Odp.net 提供程序时遇到问题。在内部，DAAB 使用 CommandBehavior 枚举来控制 ExecuteReader 方法的连接生命周期，但 ExecNonQuery 方法的某处似乎有些不对劲。

# c# - nhibernate 1.2 和 2.0 的区别

> ID：916625
> 
> 赞同：1
> 
> 时间：2009-05-27T16:09:13.810
> 
> 标签：c#, .net, nhibernate

我似乎找不到任何关于 nhibernate 1.2 和 2.0 之间实际差异的信息。我找到了有关升级的潜在问题的信息，但没有找到包含哪些新功能或任何有关性能差异的信息。

如果两者之间有显着差异可以使我们的开发更高效或更容易，那么我想向我的主管推荐升级。如果那里没有任何值得弄乱的东西，那么我看不出尝试升级当前稳定的库的意义。

我打算发布指向我已经查看过的信息的链接，但我不允许这样做，因为我被认为是新用户。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-06T15:54:35.673

我花了 6 个月的时间将我的工作转化为升级。让我简单说明一下我们注意到的一些好处，以便您可以展示以下功能：

*   会话启动时间显着减少。这是 SessionFactory 在启动时初始化所需的时间。时间是~45 秒，现在是~5 秒。对于生产来说不是什么大问题，但对于开发人员来说绝对是个麻烦。请记住，我们大约有 200 个域对象。
*   我们在升级时利用了延迟加载（我不是指集合，而是类），这是默认设置。这是从 1.2 到 2.0 的变化。但是我们确实遇到了与会话断开连接的未完全加载的对象的问题。这些并不容易找到，但很容易解决。
*   我们利用了批处理，我认为这是新的。这对批量更新操作进行了一些重大改进，而 NH 并不是真正打算这样做的。
*   通过上述 2 项改进，我们发现特定夜间操作的时间减少了 30%。
*   我们对旧框架最大的抱怨之一是很难找到 1.2 的支持和最新信息。
*   改进了对分页和计数等内容的标准查询支持。标准查询很好，因为它们利用了一级缓存。
*   强类型的集合使用起来非常愉快。我们喜欢偶尔在域对象上使用 LINQ，而不是复杂的 SQL，并且必须拥有强类型的集合。
*   我们还使用 Ayende 的分析器，目前为 2.0+ 构建
*   还有其他的，但总而言之，我们的迁移经历并没有我们想象的那么可怕。我们有一些遗留的东西会让新罕布什尔州的人不寒而栗。您需要更改配置设置，升级一些不推荐使用的接口（我认为我们的解决方案中只有不到 30 个），但最大的痛苦是使域对象的所有属性/方法都虚拟化。实际上，我编写了一个快速程序来梳理我们的域对象并这样做，因为我们有这么多。

# tfs - TFS 构建代理没有响应

> ID：916644
> 
> 赞同：4
> 
> 时间：2009-05-27T16:12:07.360
> 
> 标签：tfs, build, agent

我遇到了一个我无法解决的问题，以下是详细信息：

我在我的 APPTier 和 Build Agent 中使用 TFS2008。最初，我在 Apptier 服务器（包括构建代理）中安装了所有内容，并且能够在 Apptier（和构建）服务器中启动构建。现在，我必须在不同的服务器上创建一个新的 Build 代理。我在我的构建机器中安装了 Team Foundation Build（我们称之为 MyBuildAgent）。使用 TeamExplorer 我创建了一个新的构建代理，指向我的构建机器来构建一些项目，但是当我开始构建时，它会抛出以下消息：

```
TF215085: An error occurred while connecting to agent \myproject\MyBuildAgent: TF215076: Team Foundation Build on computer MyBuildAgent (port 9191) is not responding. (Detail Message: Unable to connect to the remote server) 
```

“Visual Studio Team Foundation build”服务正在我的构建机器中运行，而且，我可以从 MyBuildAgent 在 Apptier 中启动构建，但我无法在 MyBuildAgent 本身中启动构建。

任何人都可以告诉我我做错了什么或者为了配置我的新构建代理我错过了什么部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T03:35:38.590

有两件事要尝试：

1）确保构建服务正在运行。（在 start->run 中输入 Services.msc，找到构建服务并启动它）

2) 如果服务已启动，请右键单击服务并选择属性。转到依赖项选项卡并删除 SSL 依赖项（如果存在）。

参考（链接很长，因为是google翻译的）：[http ://translate.google.com/translate?hl=en&sl=es&u=http://geeks.ms/blogs/elbruno/archive/2008/07/14 /tfs-build-error-tf215076-new-status-unreachable.aspx&ei=9gQeSsWMBJOctgPI7vyJCg&sa=X&oi=translate&resnum=5&ct=result&prev=/search%3Fq%3D%2522Team%2BFoundation%2BBuild%2Bon%2Bcomputer%2522%2B%2522Unable% 2Bto%2Bconnect%2Bto%2Bthe%2Bremote%2Bserver%2522%26hl%3Den](http://translate.google.com/translate?hl=en&sl=es&u=http://geeks.ms/blogs/elbruno/archive/2008/07/14/tfs-build-error-tf215076-new-status-unreachable.aspx&ei=9gQeSsWMBJOctgPI7vyJCg&sa=X&oi=translate&resnum=5&ct=result&prev=/search%3Fq%3D%2522Team%2BFoundation%2BBuild%2Bon%2Bcomputer%2522%2B%2522Unable%2Bto%2Bconnect%2Bto%2Bthe%2Bremote%2Bserver%2522%26hl%3Den)

3）如果您需要使用 SSL，请查看讨论配置它的链接： http: [//social.msdn.microsoft.com/forums/en-US/tfsbuild/thread/ae5f2472-dd11-4921-a485- a22aa58bae7e/](http://social.msdn.microsoft.com/forums/en-US/tfsbuild/thread/ae5f2472-dd11-4921-a485-a22aa58bae7e/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T09:47:18.060

首先检查您是否可以从应用程序层 ping 您的构建机器以排除简单的网络问题。

Secondly check that you have allowed port 9191 through the firewall on the build machine, you may need to add an explicit rule into the Windows Firewall to allow this.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:49:41.827

Ok, I got it working now. Even I had disabled the Windows Firewall in the AppTier and in my build machine, I figured out we had an ISA Server running on our network and it was the responsible for deny the access to the port 9191 in both server (apptier and build). Once we make a rule to allow the communication through this port everything worked just fine.

Thanks for the replies guys, I really apreciated your help!

# iphone - 如何在 iPhone 应用程序中调暗视图？

> ID：916656
> 
> 赞同：1
> 
> 时间：2009-05-27T16:14:02.800
> 
> 标签：iphone, objective-c, cocoa-touch

我见过很多 iPhone 应用程序在更新或下载内容时会使用活动指示器使屏幕变暗，让用户知道它很忙。我知道如何进行活动指示器，但我该如何进行调光？如果可以，请发布示例代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T16:17:23.573

他们实际上并没有调暗它，Apple 不允许应用程序调整屏幕亮度。他们只是在屏幕上放了一个黑色的半透明图像，效果类似。

### 编辑：

越狱应用程序可以调整屏幕亮度，并且有一个API可以做到这一点，但是Apple不会批准任何改变屏幕亮度的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T14:52:26.897

好的，我这样做的方式也是创建另一个视图并将不透明度设置得非常低。然后我将此视图添加为子视图。

# php - Developing a robust PHP postback handler

> ID：916657
> 
> 赞同：1
> 
> 时间：2009-05-27T16:14:13.970
> 
> 标签：php, mysql

I'm developing a php based CMS, and I'm currently re-writing it into a state that is usable for customers. (My first version was internal only; and a somewhat kludgy mess :P)

In my first version, I had a function called HandlePostBack() which checked for the existance of a significant number of $_POST variables - the submit button from each possible form. If it was set, then the appropriate command would be executed.

I'm wondering if there is a better way? I could migrate to a switch, and look for a single $_POST variable included in each form, and then execute the command. A minimum of code would be nice, so I can extend the system quickly and easily.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T16:51:28.780

It seems to me your form system could use a bit of a reworking. Why not represent each form as a class, and make the `HandlePostBack` function a method? Then you could detect the form that's been submitted and handle it.

```
class ProfileForm extends Form {
    private $form_items = array(
        new FormItem('name', 'datatype', 'other_parameters'),
        new FormItem('another_name', 'datatype', 'other_parameters'),
        ...
    );

    public function render() {
        ...
    }

    public function handlePostData() {
        ...
    }
} 
```

If you use a standard format for your submit button IDs (something like `<form_name>_submit`, you can do something like this on submission:

```
foreach ($_POST as $key => $value) {
    if (substr($key, strlen($key) - 7) == '_submit') {
        $className = ucfirst(substr($key, 0, strlen($key) - 7)) . 'Form';
        $form = new $className();
        $form->handlePostBack();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T16:20:06.783

I would try to do it differently. Why do you need a central point for all your posts? This is really bad practice.

Don't try to improve over it, try rethinking the whole idea of having a central point and get rid of it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T17:18:18.287

In similar cases I usually use hidden input 'form_action', so I can use different submit-buttons to provide different actions (like 'add', 'edit', 'delete' etc...)

```
<input type="submit" onclick="assignAction(this.form, 'myItem_delete');"...> 
```

Then on the server side i can split action by "_" and use 1-st part as form class identifier (i.e. for simple switch, or reflection...), and the second part says what method of form class should handle the postback data. In common code is like this

```
$handler = explode('_', $_POST['form_action']);
$className = $handler[0]; // not secure, but simple enough for example
if (class_exists($className))
{
   $form = new $className();
   $method = $handler[1]; // again too simple
   if (method_exists($form, $method))
   {
      $form->$method($_POST, $other_params...);
   }
} 
```

Sure, the example is too simple. But it's common idea works fine, as for me.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T00:31:26.667

One way to do this sort of thing is to route your requests to classes and if the `$_SERVER['REQUEST_METHOD'] == 'POST'` then call the post() method on that class. This would mean that the action on your form would map directly to some class which had a post method.

```
// routed from URL: /users
class Users implements Resource
{
    public function post() 
    {
        // do your post here
    }

    public function get()
    {
        // do it for GET requests too
    }
} 
```

While this is essentially the same thing as what you were doing before, it can let you organize your code a little better in that you can deal with requests in a generic way:

```
$resource = $resourceFactory->getResource($url);
$method = strtolower($_SERVER['REQUEST_METHOD']);
$response = $resource->$method(); // eg: $resource->post();
$response->respond(); 
```

Have a look at the [recess framework](http://www.recessframework.org/) which takes this idea a long way.

# python - 是否有可能用纯 Python 编写像魔兽世界一样大的 3D 游戏？

> ID：916663
> 
> 赞同：12
> 
> 时间：2009-05-27T16:16:05.137
> 
> 标签：python, 3d, direct3d

是否有可能用纯 Python 编写像魔兽世界一样大的 3D 游戏？假设使用 DirectX/D3D 绑定或 OpenGL 绑定。

如果不是，那么在 Python 中做这样一个项目的最大障碍是什么？我知道游戏往往属于 C 和 C++ 领域，但有时人们会出于习惯而做事！

任何信息都有助于满足我的好奇心。

### 编辑：

GIL 会发布关于 3d 客户端性能的主要问题吗？使用 OpenGL 或 DirectX 绑定与本机使用库的一般性能损失是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-27T16:19:57.047

是的。它将如何表现是另一个问题。

一个好的开发模式是在纯 python 中开发它，然后对其进行分析，并重写性能关键瓶颈，无论是在 C/C++/Cython 中，还是在 python 本身中，但使用更高效的代码。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-27T16:30:00.677

虽然我不了解《魔兽世界》的所有技术细节，但我想说像这样大小的 MMO 可以用[Stackless Python](http://en.wikipedia.org/wiki/Stackless_Python)构建。

EVE Online 使用它，他们有一台服务器可容纳 200,000 名用户。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-27T16:21:14.597

从技术上讲，任何图灵完备的编程语言都有可能。

但实际上，使用高级语言制作网络堆栈时会遇到麻烦，因为服务器必须非常快才能处理这么多玩家。

客户端上的游戏方面应该没有问题，因为图形用户界面或任务或键盘输入以及您拥有的东西并没有什么太复杂的地方。

问题将出现在服务器上计算密集型的任何地方。在人类时间发生的任何事情（例如登录）都可能会很好，但是如果某些事情需要瞬间超过一万用户，您可能想要使用 C 语言完成的外部库。

现在一些 Python 大师会从木制品中走出来，把我的脑袋扯下来，因为正如我在顶部所说的那样，从技术上讲，只要付出足够的努力，任何事情都可以完成。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-27T16:32:33.170

[Minions of Mirth](http://minionsofmirth.com/)游戏或多或少是一个完整的 MMO 魔兽世界，[主要是用 Python](http://www.garagegames.com/community/forums/viewthread/37703)完成的。客户端使用了 Torque 游戏引擎，它是用 C++ 编写的，但服务器代码和行为都是 Python。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-17T00:51:39.400

除了 Eve Online 之外，还有一些其他真实的行业示例。90 年代后期 Origin 的 Ultima Online 2 项目的服务器后端主要是基于 C++ 服务器基础架构的 Python，而来自 NCSoft 的已故 Tablua Rasa 游戏（与大多数相同的开发团队）具有相同的架构。

[Twisted Matrix](http://twistedmatrix.com) python 服务器框架最初是为了这个确切的目标而创建的——实际上是由当时 UO2 项目的开发人员创建的，并且有一家名为 Ninjaneering 的公司试图通过 MMO 项目将该代码库商业化。

lua 作为脚本引擎（例如 EQ2）已经有了发展，因为它更容易嵌入和实例化。

在这种环境下，python 的问题往往出在语言之间的接口上。当您将一些高性能系统从 python 迁移到 C/C++ 进行不可避免的优化时，跨语言边界来回推送数据和跨语言边界调用函数就成为一个问题。如果做得不好，序列化的成本可能会很高。例如，使用 SWIG 的早期版本会将指针序列化为其字符串表示形式，然后将字符串解析回另一端的指针！

查看90 年代中期的[这篇论文：](http://www.asbahr.com/paper1html/paper1.html)

但是，从长远来看，我认为这是可能的。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-27T16:22:05.077

是的，你可以用汇编、Java、Python 或brainfuck 来编写它。这只是你愿意投入多少时间。语言性能不再是主要问题，更多的是关于你使用哪种算法，而不是你使用什么语言。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-09-01T05:27:02.240

我认为您的具体问题的答案是“……在纯 Python 中……”答案是否定的。

Python 的速度不足以有效地调用 OpenGL 或 DirectX，无法以异常的帧速率重新创建《魔兽世界》。

就像许多其他人回答的那样，考虑到一些高级框架工作，可以使用具有脚本语言的 Python，但至少您需要某种用另一种语言（如 C++）编写的图形系统来处理图形。对于网络，鉴于 WoW 不是动作游戏，您可能可以使用纯 Python，但很可能该部分也需要一些非 Python 库。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-05-27T16:38:35.043

由于您的主要问题已经得到很好的回答，我将回答您后面的问题：

> GIL 会发布关于 3d 客户端性能的主要问题吗？

在 Python 2.6 中，引入了[多处理](http://docs.python.org/library/multiprocessing.html)库，因此您可以利用多个处理器内核而无需担心 GIL。[Stackless Python](http://www.stackless.com/)也有一些非常酷的相关内容。

> 使用 OpenGL 或 DirectX 绑定与本机使用库的一般性能损失是什么？

我没有任何基准来支持它，但是使用绑定与本机库的惩罚足够小，您无需担心它。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-11-01T08:22:16.353

我一直在尝试用 Python 编写 3D 游戏，并且给定了一个很好的渲染框架（我最喜欢的是 OGRE）和不错的绑定，你可以摆脱它真是太棒了。但是，尤其是对于游戏，您总是试图尽可能多地从硬件中挤出来。python的性能劣势最终会让人感受到。

我在使用 python 时遇到的主要问题是其巨大的调用开销。调用 python 函数，即使是从其他 python 函数调用也是非常昂贵的。在某种程度上，这是你为 python 的动态特性付出的代价。当你在一个符号上使用函数调用运算符“()”时，它必须确定它是一个函数还是一个类，查看方法解析顺序，处理关键字参数等。所有这些事情都提前完成较少动态（编译）语言的时间。

我见过有人试图通过手动内联函数调用来克服这个问题。我不必告诉你，这种药比疾病更糟。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-31T00:46:38.690

仅仅因为它可能会带来有趣的阅读，Civilization 部分是使用 Python 编写的。谷歌返回有趣的阅读材料。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-11-01T09:16:19.150

作为技术人员，我知道：

如果它可以用 C\C++ 编写，则可以用汇编编写（尽管需要更长的时间）。如果它可以用 C\C++ 编写并且不是低级代码 - 它可以在任何托管环境中编写。WoW 是一个用 C\C++ 编写的高级程序 python 是一个托管环境

有：WoW 可以用 python 编写，因此任何其他 MMORPG 都可以用 3D 编写......

* * *

最难的部分将是 3d 引擎，因为它是代码中“最重”的部分——您需要使用外部引擎（用 C\C++\Assebly 编写）或编写一个并优化它（不推荐）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-22T15:29:28.213

Python 没有被解释——它被标记化/“及时”字节码“解释”，它没有像 Java 那样的 VM。这意味着，在英语中，它可以是 daaaaaamnfast。虽然并非总是如此，这取决于问题和库，但 python*并不*慢，即使在知识渊博的人中，这也是一个常见的误解（包括那些刚刚没有尝试过 python 的深度 java 引擎人员）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-27T16:20:34.567

因为 Python 是被解释的，所以与 C/C++ 相比，性能会受到影响，但是，您可能希望使用 PyOpenGL 之类的东西而不是 DirectX，以便在更多操作系统上运行。

但是，我不明白为什么你不能用 Python 编写这样的游戏。

# javascript - HTML 中的 Qwerty 键盘

> ID：916664
> 
> 赞同：2
> 
> 时间：2009-05-27T16:16:11.643
> 
> 标签：javascript, html, keyboard, qwerty

我需要一个使用 HTML 按钮的 QWERTY 键盘，它将输入的信息输入到文本字段中。我可以把一个放在一起，但似乎这一定是以前做过的，我讨厌重新发明轮子。有谁知道我在哪里可以找到类似的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T16:26:17.020

好的，您在标签中提到了 javascript；那么这款时尚的键盘呢： [描述它的文章](http://designshack.co.uk/tutorials/creating-a-virtual-jquery-keyboard)- 和一个[演示](http://www.designshack.co.uk/tutorialexamples/vkeyboard/)。

# c# - 对于MVP设计中的View接口，IView的成员应该抽象到什么程度呢？

> ID：916665
> 
> 赞同：1
> 
> 时间：2009-05-27T16:16:14.077
> 
> 标签：c#, .net, asp.net, design-patterns

我还在学习MVP。我有一个 IView 和一个演示者。我有一个为此应用程序编写的自定义列表控件。我想添加一些项目，一次一个。我应该公开 IView.AddItem(Item) 还是应该公开 IView.MyCustomList 属性？

这是风格问题，还是对此有*正确*答案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:22:05.447

我个人认为良好的风格将保留 MVP 模式的目的并保持代码简洁。

如果我理解正确，您的`CustomList`属性将具有您的自定义控件的类型。通过视图接口公开此类属性将导致使用该接口（演示者）的所有代码依赖于您的控件（并将其作为依赖项引用）。这是可能的，并且可能足以满足您的要求，但违反了 MVP 设计模式。您可能希望将视图实现和演示者分成不同的程序集。但两者都必须参考您的控制。MVP 旨在分离用户界面特定交互和特定控制功能（在大多数情况下取决于框架/供应商）并将它们隐藏在业务逻辑（演示者）中。

在您的场景中，我建议将`AddItem`方法公开给演示者 - 视图实现负责处理用户控件或与显示数据相关的任何事项。另一方面，演示者将专注于检索数据并执行一些业务逻辑。

我怀疑您不必同时支持不同的用户界面技术（如 ASP.NET Web 窗体、WPF/Silverligth 或 ASP.NET MVC），但如果您假设必须将 ASP.NET MVC 网站移植到 destktop WPF应用程序，并坚持 MVP 设计模式，那么您将（在最好的情况下）只需要在每种 UI 技术中实现视图界面，​​为演示者、服务和所有业务逻辑东西保持相同的代码库（实际上从 ASP.NET MVC 到桌面将是一次冒险，但该示例应强调无需修改演示者和业务逻辑）。

* * *

PS。Java 中的一些框架具有代表 UI 组件的抽象接口（UI 模型），并且可以跨不同的 UI 技术重用。在这种情况下，通过其 UI 模型接口（它必须实现）公开一个 UI 组件是可以接受的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T08:27:30.123

是的，这完全是一个风格问题，无论你觉得哪个更舒服。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-15T15:05:59.960

通过不公开您的 CustomList，您可以更好地控制如何将项目添加到您的 CustomList。公开 AddItem 方法将更好地保护您的列表免受可能的滥用。

您可以选择，这取决于您希望对列表保留多少控制权。

# debugging - 生产服务器上的asp.net调试

> ID：916666
> 
> 赞同：2
> 
> 时间：2009-05-27T16:16:42.670
> 
> 标签：debugging, asp.net-3.5, production

我们最近在生产服务器上部署了一个 ASP.Net 应用程序，但在 IE 中遇到了一些问题。我们已经构建了一个基于 cookie 的自定义安全模块。有趣的部分是，所有浏览器的登台服务器上的一切都完美无缺，它也适用于生产服务器，但仅适用于 Firefox。该进程能够写入 cookie，但由于某种奇怪的原因，当从生产服务器上的 IE 登录时，身份验证无法读取 cookie。安全模块由另一家公司开发并交给我们，有趣的是该公司现已解散，没有人可以对整个模块进行一些知识共享。

你们会如何建议在生产服务器上调试/解决问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T16:20:57.623

尝试在网站上加入[ELMAH](http://code.google.com/p/elmah/)。安装是非常非侵入性的，你可以很快得到一些答案。

如果这不能满足您的需求（这可能是由于 cookie 问题而发生的），请尝试获取调试栏类型的应用程序并逐步完成该过程。

如果您仍然遇到问题，您可能需要使用类似[log4net](http://logging.apache.org/log4net/)的东西来注入一些额外的调试细节并查看结果，但这需要您重新编译应用程序并将其迁移。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T16:59:51.897

您应该做的第一件事就是让您的登台服务器准确地镜像您的生产服务器。例如，如果生产服务器不在您的主域中，那么临时服务器也不应该在那里。

如果您在使用 IE 时遇到问题，那么听起来安全区域是不同的。这可能是由诸如域问题之类的“小事”引起的。

从硬件到服务包级别，再到安装的软件，一切都绝对应该相同。如果他们不是这样的东西弹出。

一旦你可以在暂存中复制问题，然后，只有这样，才能修复它。调试生产是个坏主意。

# c# - 非泛型类型中的泛型方法

> ID：916667
> 
> 赞同：3
> 
> 时间：2009-05-27T16:16:47.210
> 
> 标签：c#, .net, generics

当你有这样的方法时：

```
public static T DoSomething<T> ( params T [ ] input ) 
```

C# 允许您在不指定 T 的情况下调用它，例如：

```
DoClass.DoSomething ( "1", "2", "3" ); 
```

编译器是否通过传递给它的内容来计算 T ？

这是一个好的约定（在这种情况下省略 T ）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T16:18:51.667

是的，编译器可以在大多数情况下推断出泛型类型参数。（如果我没记错的话，一个例外是当您的类型是 lambda 表达式时。）

通常认为在可以推断出通用参数时省略它们是非常好的做法。事实上，我会说它在一定程度上增加了可读性（指定它们通常是非常多余的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T16:19:05.007

是的，编译器通常会找出类型。它被称为“类型推断”。

是的，将 T 留在呼叫站点是最佳做法。你写的代码越少，以后需要阅读和理解的代码就越少。

如果您有[ReSharper](http://www.jetbrains.com/resharper/)，它将很好地向您展示在呼叫站点删除 可以和不能逃脱的地方。否则，您可以尝试将其取出，如果代码编译，则您不需要它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T16:19:57.187

是的，当编译器可以弄清楚 T 应该是什么时，指定它是多余的。我发现这是一个很棒的功能，因为当总是列出类型名称（尤其是长名称）时，它会变得乏味且难以阅读。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T16:25:38.643

正如许多人所提到的，这是由于编译器的泛型参数类型推断。它直接通过第一个参数发现类型。

另一件事 - 如果您阅读 .net 库的设计指南，实际上建议您以可以推断类型的方式编写所有泛型方法。根据设计指南书，不可推断的通用方法被认为更难理解，应尽可能避免使用。

# javascript - COMET JavaScript 库

> ID：916669
> 
> 赞同：18
> 
> 时间：2009-05-27T16:17:14.993
> 
> 标签：javascript, comet

我正在寻找一个简单可靠的 Comet javascript 库。我想保持从我的服务器（通过 PHP 脚本）到客户端的持久数据流。我尝试使用 iframe 技术构建自己的，但我遇到了很多与 safari 相关的问题。我只是希望其他人为它创建了一个简单的库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T16:27:08.297

有一个[jquery comet 插件](http://plugins.jquery.com/project/Comet) 可能最好的版本是[Dojo 库](http://www.dojotoolkit.org/about)

我有一个快速的命令列表，这些命令是我用来启动和运行彗星的码头服务器的命令[列表](http://www.hallofbrightcarvings.com/getting-started-with-comet/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-03T21:09:35.557

您需要的不仅仅是 javascript 库，还有服务器端实现。根据您的需要，您需要选择一个合适的实现。

您提到了 PHP，这对于长期持有的请求通常很困难。其他选项包括为您的彗星请求使用单独的服务器，或使用 SaaS 解决方案，例如[WebSync OnDemand](http://www.frozenmountain.com/websync)。

根据您为服务器选择的选项，您将拥有一个或多个可用的 JavaScript 客户端。但是您需要先确定您的服务器实现，然后使用适当的 javascript 实现来匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-13T15:00:30.280

Have a look at [http://www.ape-project.org/](http://www.ape-project.org/) Pretty quick setup process.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T16:26:04.710

你试过 JSON-RPC 吗？显然Dojo对它有很好的支持，虽然我没有彻底尝试过

[JSON-RPC](http://en.wikipedia.org/wiki/JSON-RPC)

[道场文档](http://dojotoolkit.org/book/dojo-book-0-9/part-3-programmatic-dijit-and-dojo/ajax-transports/remote-procedure-call-rpc)

# python - 如何调试 PYGTK 程序

> ID：916674
> 
> 赞同：7
> 
> 时间：2009-05-27T16:17:48.097
> 
> 标签：python, debugging, gtk, pygtk

当 python 在 pygtk 信号处理回调的中间引发异常时，异常被 gtk 主循环捕获，打印它的值并且主循环继续，忽略它。

如果你想用 pdb (python -m pdb myscript.py) 之类的东西进行调试，你希望当异常发生时 PDB 跳上它，你就可以开始调试了。正因为如此，这是不可能的。

那我该如何调试 pygtk 程序呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T16:21:23.957

您不能让 pdb 跳转到异常，因为异常被 gtk 的主循环捕获并静音。

其中一种选择是使用`pdb.set_trace()`：

```
import pdb
pdb.set_trace() 
```

请参阅[pdb 文档](http://docs.python.org/library/pdb.html)。

或者，您可以只使用[Winpdb](http://winpdb.org/)：

它是一个**独立于平台**的图形 GPL Python 调试器，支持通过网络进行远程调试、多线程、命名空间修改、嵌入式调试、加密通信，并且比 pdb 快 20 倍。

特征：

*   GPL 许可证。Winpdb 是免费软件。
*   与 CPython 2.3 到 2.6 和 Python 3000 兼容
*   与 wxPython 2.6 到 2.8 兼容
*   独立于平台，并在 Ubuntu Gutsy 和 Windows XP 上测试。
*   用户界面：rpdb2 是基于控制台的，而 winpdb 需要 wxPython 2.6 或更高版本。

[![截屏](https://i.stack.imgur.com/7D0Qp.jpg)](https://i.stack.imgur.com/7D0Qp.jpg)
[（来源：[winpdb.org](http://winpdb.org/images/screenshot_winpdb_small.jpg)）]

# visual-studio-2008 - 在 Windows 2000 Server 上运行 ASP.Net Web 应用程序的最高级别的 .Net Framework \ Visual Studio？

> ID：916676
> 
> 赞同：0
> 
> 时间：2009-05-27T16:18:01.793
> 
> 标签：visual-studio-2008, deployment, windows-server-2000

为 Windows 2000 Advanced Server SP4 操作系统开发和运行 ASP.Net Web 应用程序的 .Net Framework 和/或 Visual Studio 版本的最高级别是多少？

我想使用可能的最新技术来开发这样的 Visual Studio 2008，但不幸的是，客户端可以提供 Win2K 服务器来部署和运行应用程序。我知道 VS2008 可以针对 .Net 2.0 框架进行部署，并且 .Net 2.0 可以在 Win2k SP4 上运行，但我正在寻找社区确认这确实有效。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T16:38:30.753

是的，这会起作用（2.0 是适用于 Windows 2000 的最高版本）。

# c# - C#检测声卡

> ID：916677
> 
> 赞同：1
> 
> 时间：2009-05-27T16:18:05.163
> 
> 标签：c#

C# 2008

我正在使用下面的代码来确定用户是否安装了声卡。我找到了两种方法，想知道一种方法是否比另一种更好。有什么比我发布的更好吗？

我在运行 XP、Vista 和 Seven 的 Windows 桌面上检测到。

非常感谢您的任何建议，

```
public partial class Form1 : Form
{
    [DllImport("winmm.dll", SetLastError = true)]
    public static extern uint waveOutGetNumDevs();

    public Form1()
    {
        InitializeComponent();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        if (waveOutGetNumDevs() != 0)
        {
            Console.WriteLine("The sound card is detected");
        }
        else
        {
            Console.WriteLine("No sound card");
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        ManagementObjectSearcher searcher = 
            new ManagementObjectSearcher("Select ProductName from Win32_SoundDevice");

        foreach (ManagementObject device in searcher.Get())
        {
            Console.WriteLine("Sound card {0}", 
                device.GetPropertyValue("ProductName"));

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T16:35:58.980

我个人更喜欢 WMI（您的第二个解决方案）而不是通过 p/Invoke（您的第一个解决方案）引用 Win32 API ......我认为这可能是一个偏好问题。Win32 API 是可以使用的，并且显然比 WMI 具有潜在的本机性能优势。也就是说，WMI 正是为这种目的而提供的，那么为什么不使用它呢？

两者各有优缺点，虽然 WMI 比 Win32 API 更直观、更灵活，但你可以用一种比较全面的查询语言来查询它，它易于维护，易于阅读，它完成了它的工作好吧，那就是与操作系统配置进行通信，这正是您想要做的。

因此，我的结论是（在我看来）WMI 是要走的路。就像我说的那样，这只是我的观点，有些主观。

# jquery - 在站点点上看到的超级下拉菜单

> ID：916679
> 
> 赞同：0
> 
> 时间：2009-05-27T16:18:08.673
> 
> 标签：jquery, menu

我忙于处理站点点上显示的大型菜单示例，[但](http://www.sitepoint.com/blogs/2009/03/31/make-a-mega-drop-down-menu-with-jquery/)注意到它使用插件来延迟悬停。我如何调整 Jquery 以便我不使用该插件。抱歉，到目前为止我无法弄清楚我的代码

```
 $(document).ready(function() {

  function addsubmenu(){
    $(this).addClass("hovering");
    $(".hovering div").animate({"opacity": "toggle"}, { duration: "slow" });
    }

  function removesubmenu(){
    $(this).removeClass("hovering");
    }
}); 
```

但它什么也没做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-23T02:29:18.113

试试这个：

[http://www.geektantra.com/2009/09/jquery-mega-menu/](http://www.geektantra.com/2009/09/jquery-mega-menu/)

其简单快速且易于配置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T17:57:55.743

你不能真正避免在这里使用 HoverIntent，因为这本质上是脚本功能的“脊梁”，它启用了“悬停”行为。

如果您想要子菜单项上的自定义动画，您可以执行以下操作：

```
$(document).ready(function() {
    function addsubmenu(){
        $(this).animate({"opacity": "toggle"}, { duration: "slow" });
    }
    function removesubmenu(){
        $(this).animate({"opacity": "toggle"}, { duration: "fast" });
    }
}); 
```

# visual-studio - 使用 CAB 安装程序时 Windows CE 图标丢失

> ID：916680
> 
> 赞同：0
> 
> 时间：2009-05-27T16:18:20.263
> 
> 标签：visual-studio, embedded, windows-ce, icons, ico

我有一个 C# Windows CE 5.0 应用程序。我正在使用VS2005。我的可执行文件显示正确的图标（32x32 8 位）。如果我使用 ActiveSync 将 .exe 文件移动到 CE 设备，则该图标仍然正确显示。当我使用 CAB 文件安装应用程序时，图标丢失了。目前，图标是嵌入式资源。有什么建议么。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T17:50:40.983

对于 Windows CE，您必须进行软重置才能显示图标。即使使用 CAB 完全卸载并重新安装程序，图标也会查看存储在缓存中的图像。

# asp.net - 如何在 ASP.NET 中使用多个 .sitemap 文件

> ID：916681
> 
> 赞同：5
> 
> 时间：2009-05-27T16:18:43.150
> 
> 标签：asp.net, sitemap

我想我遗漏了一些关于站点地图的明显内容。

我正在尝试使用中继器为我们网站上的新站点地图生成一些导航。但我不想使用我们正常的 Web.sitemap 文件，我想使用我们的新文件……我们将其称为“Web.NEW.sitemap”。

代码在某种程度上似乎有些明显......

```
<asp:Repeater ID="rptMyRepeater" DataSourceID="mySitemap" runat="server">
    <ItemTemplate>
        blah blah blah
    </ItemTemplate>
</asp:Repeater>

<asp:SiteMapDataSource ID="mySitemap" runat="server" /> 
```

但是如何让 SiteMapDataSource 使用 Web.NEW.sitemap 而不是默认站点地图？我想添加一个属性，如：

```
SiteMapProvider="Web.NEW.sitemap" 
```

应该这样做，但没有骰子。

我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T16:34:41.620

您必须正确配置 web.config 才能使用[SiteMapDataSource](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sitemapdatasource.sitemapprovider.aspx)属性。使用[SiteMap 元素](http://msdn.microsoft.com/en-us/library/1e333zt4.aspx)：

```
<siteMap defaultProvider="oldProvider">
  <providers>
    <clear />
    <add name="oldProvider" type="System.Web.XmlSiteMapProvider" siteMapFile="web.sitemap" />
    <add name="newProvider" type="System.Web.XmlSiteMapProvider" siteMapFile="Web.NEW.sitemap" />
  </providers>
</siteMap> 
```

然后将 SiteMapProvider 属性设置为 web.config 文件中提供程序的名称。

```
SiteMapProvider="newProvider" 
```

# sql-server - 疯狂的 SSIS 组件安排

> ID：916682
> 
> 赞同：0
> 
> 时间：2009-05-27T16:18:45.350
> 
> 标签：sql-server, visual-studio, ssis

有没有办法告诉 Visual Studio 2005 在您关闭并重新打开 .dtsx 时不要重新排列您的 SSIS 包组件？VS2005 总是在“控制流”选项卡中移动我的组件，并将流指针调整到看似随机的位置，这很烦人。任何人都知道停止这个的设置（如果有的话）吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T16:23:15.013

SSIS 不会重新安排我的控制流或数据流。

我要么手动完成，要么使用自动布局，但如果没有我开始移动，它永远不会这样做。

它所做的唯一奇怪的事情是它在粘贴操作期间选择了组件的放置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-08T15:51:42.707

我找到了解决我的问题的方法。安装一定是有问题的，因为当我重新安装 2005 时，无论屏幕上有哪些组件（即数据流或序列容器），它都没有重新排列或调整我的任何布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-26T14:22:14.420

很抱歉复活一个旧线程，但我不想创建一个副本，但我现在（2017 年 3 月）在 Windows 10 上安装了带有 SSDT 2017 的 VS 2017 的全新安装时得到了这个。

我的队友上周第一次注意到它（也是同一组应用程序的 <1m 旧安装）。

我今天用他们的项目在我的机器上复制了这个问题。我们想知道 dtsx xml 的布局部分是否已损坏，因此将其删除并获得了重新生成的部分。我看过 XML 内容，正在保存新位置，但是当重新打开包时，它们会丢失，但*不是在所有包上*？！？！

**几分钟后更新** 继续调查的结果给出了一个相对简单的解决方法。(1) 对问题 .dtsx 包执行复制 + 粘贴，您现在有了 MyPackage.dtsx 和 MyPackage 1.dtsx。SAVE ALL (2) 删除原来的 MyPackage.dtsx。保存全部。(3) 将新的“MyPackage 1.dtsx”副本重命名回 MyPackage.dtsx 名称。保存全部。打开新复制的版本时，您会发现您上次尝试保存的布局毕竟被记住了。

希望这可以帮助其他最近偶然发现这个问题的人。谁在我发布的 30 分钟内否决了这个答案，我们在更新版本中看到了这个，在我的更新之前有点热衷于苛刻。

# asp.net - 如何在 ASP.NET 中创建带有复选框的自定义面板

> ID：916685
> 
> 赞同：0
> 
> 时间：2009-05-27T16:19:07.267
> 
> 标签：asp.net, controls, containers

我想在 ASP.NET（类似于面板）中创建一个自定义容器控件，其中一个复选框作为标题，在未选中时禁用所有包含的控件。

我该怎么做呢？

编辑：

为了扩展我的要求，我需要类似 Rob 建议的东西，即包含 CheckBox 和内容面板的 UserControl。但是，它应该在功能上类似于 Panel，因为我需要能够重用控件，在它的每个实例中定义不同的内容。很难解释，对于明显的“功能蠕变”感到抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T16:21:05.190

如果我没记错的话，当复选框未选中时，您禁用面板[使用启用的属性]，这将禁用面板中的项目。然后，您不需要单独禁用面板中的所有项目。同样，当您再次启用面板时，它将重新启用子控件。

```
myPanel.Enabled = false; //Child controls disabled
myPanel.Enabled = true; //Child controls enabled 
```

您还可以使用以下方法迭代面板中的每个控件：

```
foreach(Control control in myPanel)
{
    //Assume for the purpose of demonstration 
    //that each control within myPanel has an
    //"Enabled" property
    control.Enabled = myPanel.Enabled;
} 
```

这将设置面板中每个控件的 enabled 属性以匹配面板的属性 - 实际上，这超出了要求，因此并不是真正可取的。我只是为了演示目的提供了这个方法。

**编辑：**这可以通过 Rob 的用户控件设计来扩展 [例如]，您可以向用户控件添加一个属性以公开面板的控件集合：

```
public Control[] Controls
{
    return controlPanel.Controls;
} 
```

这基本上允许从用户控件外部修改控件的面板控件，并且不需要在用户控件内部的面板定义中分配控件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T16:34:40.233

我将使用以下内容创建一个 UserControl：

```
<asp:UpdatePanel ID="upDisableAllPanel" UpdateMode="Conditional" runat="server">
    <ContentTemplate>
        <asp:CheckBox AutoPostBack="true" ID="cbTogglePanel" runat="server" />
        <asp:Panel ID="pnlDisableAll" runat="server">
       ... controls here ...
        </asp:Panel>
    </ContentTemplate>
</asp:UpdatePanel> 
```

在代码隐藏中添加这个（VB示例）

```
Public MyControls As New ControlCollection(Me)

Protected Sub control_load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    bindControls()
End Sub

Protected Sub cbTogglePanel_CheckChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles cbTogglePanel.CheckChanged
    pnlDisableAll.Enabled = cbTogglePanel.Checked 'Or Not cbTogglePanel.Checked depending on how you have the cb labeled.'
End Sub

Public Sub bindControls()
    If MyControls IsNot Nothing And MyControls.Count > 0 Then
        pnlDisableAll.Controls.Clear()
        For Each cntrl As Control In MyControls
            pnlDisableAll.Controls.Add(cntrl)
        Next
    End If
End Sub 
```

@balabaster 是正确的，禁用面板将有效地禁用内部的所有内容。这会将其封装到可重复使用的容器中。

此代码假定您正在使用带有 Ajax.Net 库的 .Net 3.5 或 .Net 2，并且在内容页或母版页的某处声明了 ScriptManager。您使用*的是*Ajax 对吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T17:08:27.043

我想我会以不同的方式解决这个问题，我认为其中带有面板/复选框的 UserControl 不会按照您希望的方式工作，因为您将无法轻松地将其他控件添加到其中。

相反，我会为`Checkbox`控件创建一个 Ajax Extender，将 a`Panel`作为参数提供给它。然后，每当单击 时，让它使用类似这样的代码`Checkbox`访问每个子控件；`Panels`

```
foreach(Control c in pnlFoo.Controls)
{
   if (!(c is Checkbox)) // probably need a better check than this
   {                   // incase you have other checkboxes inside your panel
      c.Enabled = chkToggler.Checked;
   }
} 
```

# visual-studio - 使用 nHibernate，如何在 VS.NET 解决方案中布置文件？

> ID：916694
> 
> 赞同：1
> 
> 时间：2009-05-27T16:20:44.237
> 
> 标签：visual-studio, nhibernate, repository-pattern

使用 nHibernate（和存储库模式），您如何布置文件/文件夹？

我将使用 DDD，并使用存储库模式，因此我将拥有许多映射到我的数据库表的类，以及许多从接口继承的存储库等。

就像是：

```
/root/
/root/web.config
/root/class/user.cs
...
/root/repository/UserRepository.cs

/root/interface/iRepository.cs 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-10T21:12:01.697

“大量”存储库表明您要么需要重新考虑什么是真正的聚合根，要么您的域完全疯了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:23:26.980

对我来说，默认项目结构如下：

*   解决方案.Core

    *   有界上下文（例如产品、订购、会计）包含实体和值对象
        *   服务（包含存储库、服务等的接口）
*   Solution.DataContracts（用于 DTO-s）

*   Solution.Infrastructure（包含管道代码）
*   Solution.Configuration（包含基础设施配置。NH 映射、IOC 注册、约定等）
*   Solution.Services（包含 NHibernate 存储库等服务的实现）
*   Solution.Presentation（包含演示者或控制器）
*   Solution.Web（包含视图并将所有内容捆绑在一起）

它似乎很好地解耦，当循环依赖出现时，它表明可能存在设计问题。

# visual-studio-2008 - 1 个解决方案中的多个项目与 2008

> ID：916703
> 
> 赞同：0
> 
> 时间：2009-05-27T16:21:40.320
> 
> 标签：visual-studio-2008, migration

我在 VS 2003 中有各种单独的项目，每个项目都有一些公共文件（管理员）。现在我想将所有这些项目迁移到 VS 2008。我还希望所有项目都在 1 个单一解决方案下，以便我在主项目中有 1 个公共管理部分，每个项目作为子项目

前主项目
   - 管理部分
         -Sub Proj1 -Sub
         Proj2
         -SubProj3

只是想知道这是否可行。现在我为每个项目都有单独的 web.configs，如果我将项目组合到 1 个解决方案中，这将如何改变？在这种情况下，项目编译/构建如何工作？

任何建议都会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T16:27:27.190

你说你的项目是在 VS 2003 中。如果你使用的是 .NET 1.1，你会遇到 VS 2008 的问题。我相信 2008 只支持 .NET 2.0-3.5。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T16:34:20.217

配置文件“级联” - 您的应用程序将向上查询链，从最接近它的一个一直到 machine.config，直到找到包含所需信息的一个。所以你的 web-config 文件应该没有问题；他们每个人都将继续从事自己的项目。

就可行性而言，是的，您可以在同一个解决方案中拥有多个项目 - 甚至是多个 Web 项目。但是，您不能像您描述的那样嵌套它们。每个项目必须是解决方案的不同子项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T16:31:04.997

Visual Studio 2008 不支持子项目。

如果您有一个公共代码（不是文件），您可以通过创建一个项目来共享它们，并将其引用到需要该代码的任何其他项目。

如果您有内容（未编译）文件，您可以将它们作为资源文件添加到项目中并以编程方式访问它们。

这不适用于 Web 文件（例如：.htm、.css、.js 等）。

# c# - 带有字符串的 NHibernate 映射，没有真正的外键

> ID：916709
> 
> 赞同：1
> 
> 时间：2009-05-27T16:23:29.630
> 
> 标签：c#, sql, nhibernate

我有一个“实验室”类，它代表使用我的程序的公司的一个部门。它有一个名为“Employees”的子集合，旨在包含属于该实验室的所有员工。employee 表包含一个名为“Department”的字符串字段，表示他们所属的部门，Lab 表包含一个名为“Department”的字符串字段，表示 Lab 是哪个部门。当员工的部门与实验室的部门匹配时，该员工属于实验室。

我意识到让员工表包含 LabID 字段将是更可取的方法，但是员工表不在我的控制之下，我不想修改它。我宁愿在不添加员工到实验室的映射表的情况下执行此操作，因为部门对部门提供相同的结果。

这是我正在尝试使用的精简映射。

```
 <class name="Lab">
    <id name="LabID">
      <generator class="native" />
    </id>
    <property name="Department" />
    <!--- other properties --->
    <set name="Employees" table="Employee_copy" generic="true" inverse="true">
      <key column="Department" property-ref="Department" />      
      <one-to-many class="Employee" />
    </set>
  </class> 
```

返回的错误是

```
Identifier type mismatch; Found:<System.Int32> Expected:<System.String> Parameter name: identifier 
```

生成的查询运行良好。

```
SELECT employees0_.Department as Department1_, employees0_.EmployeeID as EmployeeID1_, employees0_.EmployeeID as EmployeeID30_0_, employees0_.CommonName as CommonName30_0_, employees0_.LastName as LastName30_0_, employees0_.NetUserID as NetUserID30_0_, employees0_.CompanyID as CompanyID30_0_, employees0_.Department as Department30_0_ FROM Employee employees0_ WHERE employees0_.Department='IS' 
```

那我做错了什么？

编辑：

另请注意，反向关联可以正常工作。

```
<many-to-one name="Lab" column="Department" property-ref="Department" class="Lab" /> 
```

两个对象的关联属性 - Lab：

```
public virtual int LabID { get; set; }
public virtual string Department { get; set; }
public virtual ISet<Employee> Employees { get; set; } 
```

员工：

```
public virtual int EmployeeID { get; protected set; }     
public virtual string Department { get; protected set; } 
public virtual Lab Lab { get; protected set; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T21:31:06.330

由于 Employee 表是不可变的，我最终创建了一个基于部门获取 Lab ID 的视图，并直接链接到该视图而不是 employee 表。

嗯。作品。

# silverlight - 将 BDD 场景与 Silverlight 测试的结果相关联

> ID：916710
> 
> 赞同：1
> 
> 时间：2009-05-27T16:23:32.377
> 
> 标签：silverlight, cucumber, bdd, fitnesse

我与一个使用行为驱动开发 (BDD) 来交付我们的应用程序的团队合作。我们已经开始提供 Silverlight 应用程序。

我想将同意**的以纯文本形式编写的 BDD 场景**与我们的 silverlight 应用程序的自动化测试结果相关联。因此，当应用程序中遇到某个场景时，会有一个简单的报告显示此映射到原始文本。这样我们的利益相关者（又名产品所有者）就可以快速获得有关已测试和交付的验收标准的反馈。

以前，我使用[Fitnesse](http://fitnesse.org/)和[Cucumber](http://cukes.info/)以及 xUnit/rSpec 来帮助产品所有者和开发人员在使用 BDD 交付 Web 应用程序时进行沟通。

我的问题是我没有看到使用这些报告工具之一插入 Silverlight 测试框架结果和 BDD 场景文本的简单方法。

**我的问题：**是否有人在使用 Silverlight 的 BDD 项目中提供此类“报告”？如果是这样，你是怎么做到的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-03T08:37:34.023

[SpecFlow](http://www.specflow.org)是一个使用 .NET 进行 BDD 的开源项目。从 3.1.2 版开始，它还支持 Silverlight。您可以在以下位置查看示例：http: [//github.com/techtalk/SpecFlow-Examples/tree/master/BowlingKata/BowlingKata-Silverlight-MsTest/](http://github.com/techtalk/SpecFlow-Examples/tree/master/BowlingKata/BowlingKata-Silverlight-MsTest/)

SpecFlow 使用纯文本定义格式（Gherkin - 与黄瓜相同的格式），并从中生成单元测试（在 Silverlight 的情况下，支持 MsTest）。

您还可以查看有关 SpecFlow Silvelight 集成的 wiki：[https ://github.com/techtalk/SpecFlow/wiki/silverlight-support](https://github.com/techtalk/SpecFlow/wiki/silverlight-support)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-19T08:31:07.943

如果您正在使用 Silverlight 工具包中附带的[Silverlight 测试框架](http://silverlight.codeplex.com/)，那么很遗憾，您今天找不到任何微不足道的扩展点来报告此类信息。

# c# - WebMethod 在参数中接收 null

> ID：916711
> 
> 赞同：6
> 
> 时间：2009-05-27T16:23:42.937
> 
> 标签：c#, asp.net, web-services

我有一个带有两个字符串参数的方法的 Web 服务。当我调试时，我可以在调用方法中看到它将两个字符串值传递给方法，但实际上 WebMethod 只是为这两个值获取 null。这是一些代码：

网络方法

```
[WebMethod(Description = "Set username and password for validation purposes.")]
public void Login(string uname, string pword)
{
    username = uname;
    password = pword;
} 
```

调用方法

```
NewsletterEmailSubscribers nes = new NewsletterEmailSubscribers();
nes.Login("Username", "Password"); 
```

我在这里做错了什么？

- 编辑 -

添加更多代码。

网络服务：

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ToolboxItem(false)]
public class NewsletterEmailSubscribers : WebService
{
    private static string username, password;

    public NewsletterEmailSubscribers()
    {

    }

    /// <summary>
    /// Logins the specified username.
    /// </summary>
    /// <param name="username">The username.</param>
    /// <param name="password">The password.</param>
    [WebMethod(Description = "Set username and password for validation purposes.")]
    public void Login(string uname, string pword)
    {
        username = uname;
        password = pword;
    }

    /// <summary>
    /// Adds subscriber email account.
    /// </summary>
    /// <param name="emailAddress">The email address</param>
    /// <param name="newsletterType">The newsletter they have signed up to receive</param>
    /// <param name="validationCode">The validation code</param>
    [WebMethod(Description = "Initial add of subscriber email address and newsletter signing up for.")]

    public void AddSubscriber(
        string emailAddress,
        string newsletterType,
        string validationCode)
    {
        // Check some values
        //Authenticate user, will throw exception if the user is invalid

        using (SOAValidation validation = new SOAValidation())
        {
            validation.ValidateConnection(validationCode, username, password, "Full");
        }

        OracleParameterCollection parameters = new OracleParameterCollection();
        parameters.AddWithValue("subscriber_email", emailAddress);
        parameters.AddWithValue("newsletter_type", newsletterType);
        Database.ExecuteQuery("dw.newsletter_pkg.newsletter_subscriber_add", parameters);
    }
} 
```

使用服务的网页 (NewsletterEmailSubscribers)

```
private void SubmitEmail(string email)
{
    if (ValidateEmail(email))
    {
        try
        {
            NewsletterEmailSubscribers nes = new NewsletterEmailSubscribers();
            nes.Login("Username", "Password");
            string validationCode;
            using (Cokesbury.RemoteValidation.Validator validator = new Cokesbury.RemoteValidation.Validator())
            {
                validationCode = validator.ValidationCode(System.Configuration.ConfigurationManager.AppSettings["PasswordSalt"].ToString());
            }

            // submit to db
            nes.AddSubscriber(email, "FICT", validationCode);
            // Switch to confirm message
            mvPage.SetActiveView(vwThankYou);
        }
        catch (Exception ex)
        {
            mvPage.SetActiveView(vwFail);
            bool rethrow = ExceptionPolicy.HandleException(ex, "Presentation Services Exception Policy");
            if (rethrow)
            {
                throw (ex);
            }
        }
    }
    else
        lblEmailError.Visible = true;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T18:22:44.553

您是否创建了此 Web 服务然后将其连接到您的其他代码，或者您是否将 Web 服务设计为使用与另一个相同的接口？

我做了一次后者并更改了 WebMethod 中参数的大小写，这导致我收到 null 而不是正确的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-26T11:29:16.690

就在今天发生在我身上，最后通过简单地更新服务解决了问题（正如达林建议的那样）。发生的事情是我重命名了 WebMethod 中的一些参数，但客户端仍然使用旧名称来发送请求。

# outlook - Outlook 2003 加载项停止加载

> ID：916713
> 
> 赞同：0
> 
> 时间：2009-05-27T16:24:27.727
> 
> 标签：outlook, add-in

我在 Visual Studio 2005 中使用 C# 2.0 创建了一个 Outlook 2003 加载项。当有人回复或创建新电子邮件时，此加载项会在工具栏上添加一个按钮。当用户单击按钮发送电子邮件时，代码会将这些信息记录到数据库中。我们的销售和营销团队使用此插件。IT 告诉我，每月至少有两到三次，他们必须卸载并重新安装加载项才能让它显示出来。我们似乎没有发现任何会导致它停止加载的东西。有什么我可以检查来解决这个问题的吗？

谢谢皇家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T11:44:26.963

此症状的最常见原因是未处理的异常，尤其是在连接和启动代码中。确保将所有内容都包含在 中`try catch`，尤其是在 Outlook 直接调用的事件处理程序中。

您还应该提供有关症状细节的更多信息。插件是否被禁用（即在禁用项目下列出）？它在注册表中的 LoadBehavior 值是否已更改为 2？

# c# - 如何使用管理员凭据运行 c# 应用程序？

> ID：916714
> 
> 赞同：6
> 
> 时间：2009-05-27T16:24:35.587
> 
> 标签：c#, windows-services

我编写了一个 C# 应用程序，当用户被锁定在他们的帐户（Active Directory）之外时，它可以解锁用户。应用程序在特定 OU 中搜索用户，并将在 ComboBox 中列出被锁定的用户。然后从 ComboBox 中选择该用户并选择解锁。

如果您以管理员身份登录，则可以完美运行。如果你是普通用户没有。

我想使用管理员凭据运行我的应用程序，但在普通用户下也尽可能安全。

我正在阅读可能对 Windows 服务进行编程，但我不清楚如何对我的应用程序进行编程以安装、作为服务运行以及在管理员凭据下运行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T16:28:52.770

这个应用程序背后的目标让我觉得是错误的。您基本上是在尝试创建一种允许非管理员用户解锁帐户的方法……这是有充分理由的，这是普通用户无法使用的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T16:50:12.527

您不必像其他人一样使用 Windows 服务来做某事。您可以使用模拟以其他用户身份登录以进行实际切换。这是我发现的一个使用 Windows dll“advapi32.dll”登录的示例。

从页面底部获取示例代码。我不想在这里复制他的代码。

[http://csharptuning.blogspot.com/2007/06/impersonation-in-c.html](http://csharptuning.blogspot.com/2007/06/impersonation-in-c.html)

模拟的一个警告是，进行模拟的计算机需要与您模拟的用户位于同一域中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T23:04:08.740

这是我用来在 Windows 2000 上运行的 ASP.NET 2.0 网站上执行模拟的类。

示例用法：

```
if (iu.impersonateValidUser("AdminUserName", "DomainName", "AdminPassword"))
{            
    // Do Something Under Other Users Security Context
    iu.undoImpersonation();
} 
```

就是这样...完成下面的课程。

```
using System;
using System.Runtime.InteropServices;
using System.Security.Principal;

public class ImpersonateUser
{
    public const int LOGON32_LOGON_INTERACTIVE = 2;
    public const int LOGON32_PROVIDER_DEFAULT = 0;

    WindowsImpersonationContext impersonationContext;

    [DllImport("advapi32.dll")]
    public static extern int LogonUserA(String lpszUserName,
        String lpszDomain,
        String lpszPassword,
        int dwLogonType,
        int dwLogonProvider,
        ref IntPtr phToken);
    [DllImport("advapi32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern int DuplicateToken(IntPtr hToken,
        int impersonationLevel,
        ref IntPtr hNewToken);

    [DllImport("advapi32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern bool RevertToSelf();

    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
    public static extern bool CloseHandle(IntPtr handle);

    public bool impersonateValidUser(String userName, String domain, String password)
    {
        WindowsIdentity tempWindowsIdentity;
        IntPtr token = IntPtr.Zero;
        IntPtr tokenDuplicate = IntPtr.Zero;

        if (RevertToSelf())
        {
            if (LogonUserA(userName, domain, password, LOGON32_LOGON_INTERACTIVE,
                LOGON32_PROVIDER_DEFAULT, ref token) != 0)
            {
                if (DuplicateToken(token, 2, ref tokenDuplicate) != 0)
                {
                    tempWindowsIdentity = new WindowsIdentity(tokenDuplicate);
                    impersonationContext = tempWindowsIdentity.Impersonate();
                    if (impersonationContext != null)
                    {
                        CloseHandle(token);
                        CloseHandle(tokenDuplicate);
                        return true;
                    }
                }
            }
        }
        if (token != IntPtr.Zero)
            CloseHandle(token);
        if (tokenDuplicate != IntPtr.Zero)
            CloseHandle(tokenDuplicate);
        return false;
    }

    public void undoImpersonation()
    {
        impersonationContext.Undo();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T16:50:39.623

看起来您想模拟管理员用户。这是[一篇文章和演示](http://www.codeproject.com/KB/cs/cpimpersonation1.aspx)。看起来是用 .Net 1 编写的，但应该可以帮助您入门。另请查看[WindowsIdentity](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx)类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T16:30:00.303

您不能（轻松地）使用 Windows 服务，因为 Windows 服务不能有 GUI。作为服务执行此操作的唯一方法是安装该服务，然后制作一个使用 IPC 将请求传达给服务的 GUI 应用程序。不过，这会打开一个潜在的漏洞。

如果您在 Vista 上运行，一个不错的选择是[编辑清单文件](http://helpware.net/VistaCompat.htm)并添加 requireAdministrator。

* * *

编辑：

听起来我的第一个建议可能是您想要的...要做到这一点，基本过程是：

*   使您的应用程序成为 Windows 服务。MSDN 上有此过程的[演练。](http://msdn.microsoft.com/en-us/library/aa984464(VS.71).aspx)
*   让您的服务响应某种形式的 IPC。您可以使用套接字、管道或任何其他形式的通信。该服务将“侦听”解除阻止用户的请求，然后执行此操作。
*   在机器上安装服务。这将使它以管理员身份运行，并且始终处于开启状态。
*   制作第二个应用程序作为客户端。使用相同的 IPC 技术与服务器进行通信。这将向服务发送解除阻塞客户端的请求。

然后，您可以以普通用户身份运行客户端（因为它只需要与服务对话，它不会执行任何需要权限的操作）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T17:23:24.533

我的 Intranet 站点上有一个非常相似的小部件，因此位于不同时区的 IT 部门的成员可以处理密码重置，当西海岸的域管理员不可用时，也可以执行帐户解锁。这是一个非常简单的任务，除了我是如何做到的......

```
 using System.DirectoryServices;

        // Impersonate the Admin to Reset the Password / Unlock Account //
        // Change variables below.
        ImpersonateUser iu = new ImpersonateUser();
        if (iu.impersonateValidUser("AdminUserName", "DomainName", "AdminPassword"))
        {
            resetPassword("AdminUserName", "AdminPassword", UserToReset, "NewPassword");
            iu.undoImpersonation();
        }

        // Perform the Reset / Unlock //
        public void resetPassword(string username, string password, string acct, string newpassword)
        {
            string Path = // LDAP Connection String
            string Username = username;
            string Password = password;
            string Domain = "DomainName\\"; // Change to your domain name

            DirectoryEntry de = new DirectoryEntry(Path, Domain + Username, Password, AuthenticationTypes.Secure);

            DirectorySearcher ds = new DirectorySearcher(de);

            ds.Filter = "(&(objectClass=user)(|(sAMAccountName=" + acct + ")))";

            ds.PropertiesToLoad.Add("displayName");
            ds.PropertiesToLoad.Add("sAMAccountName");
            ds.PropertiesToLoad.Add("DistinguishedName");
            ds.PropertiesToLoad.Add("CN");

            SearchResult result = ds.FindOne();

            string dn = result.Properties["DistinguishedName"][0].ToString();

            DirectoryEntry uEntry = new DirectoryEntry("LDAP://" + dn, username, password);

            uEntry.Invoke("SetPassword", new object[] { newpassword });
            uEntry.Properties["LockOutTime"].Value = 0;
            uEntry.CommitChanges();
            uEntry.Close();
        } 
```

我强烈同意如果使用不当可能会导致安全问题，我们会记录所有更改并通过电子邮件发送给域管理员（因此他们在循环中）并且我们会自动生成密码。这对我们的小型 IT 部门来说是一个巨大的帮助，因为管理员不再需要在凌晨 4 点起床来重置密码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T17:37:26.423

此代码将允许您调用另一个可执行文件并以管理员身份运行它。

```
try
{
   path = path_to_your_executable;

   ProcessStartInfo myProcess = new ProcessStartInfo(path);
   myProcess.Domain = domain;
   myProcess.UserName = username;
   myProcess.Password = password;
   myProcess.UseShellExecute = false;

   Process.Start(myProcess);
}
catch (Exception myException)
{
   // error handling
} 
```

不完全是您正在寻找的，但它是一个可能的解决方案。

# apache-flex - Flex：浏览器管理器的隐藏框架显示在页面上？

> ID：916716
> 
> 赞同：0
> 
> 时间：2009-05-27T16:24:57.490
> 
> 标签：apache-flex

我有一个使用 BrowserManager 进行深度链接的 flex 应用程序。

但是每当 # 更改时，新的哈希片段就会附加到页面底部。在 IE 中，它位于一个框架内，上面写着“浏览器历史支持的隐藏框架”。我什至不知道它是这样工作的。但无论如何，它不应该在页面上明显显示，但它是......任何人有任何想法是什么问题或如何解决它？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T19:03:02.040

我想通了...我从模板中复制了源代码并将其放入我的页面中...当我复制它时不知何故错过了这部分：

```
<link rel="stylesheet" type="text/css" href="history/history.css" /> 
```

它现在按预期工作......谢谢！

# objective-c - NSURLConnection 在 10.5.7 下崩溃

> ID：916718
> 
> 赞同：10
> 
> 时间：2009-05-27T16:25:07.240
> 
> 标签：objective-c, cocoa

我有一个下载股票价格的小应用程序，并且在我最近升级到 10.5.7 之前一直运行良好（多年来）。升级后，程序会在这个调用上崩溃：

```
NSString *currinfo = [NSString stringWithContentsOfURL:[NSURL URLWithString:[NSString stringWithFormat:@"http://finance.yahoo.com/d/quotes.csv?s=%@&f=l1c1p2", escsymbol]]]; 
```

奇怪的是，崩溃不会立即发生。这行代码被多次调用，没有任何问题，然后程序最终在1-2小时后由于这次调用崩溃而失败。

我最初在这里有一篇很长的帖子，描述了我调查这个问题的尝试。我收到了两个建议：（i）使调用异步（无论如何可能更好）和（ii）使用 NSZombieEnabled 来调查 Objective-C 对象被提前释放的可能性（这个评论是为了响应堆栈跟踪显示失败objc_msg 发送）。

我花了很多时间使调用异步（使用 [[NSURLConnection alloc] initWithRequest:theRequest delegate:self]），但这并没有帮助。该程序最终仍然失败，通常在 10-15 分钟后。在失败前的这段时间里，进行了许多异步调用，没有任何问题，返回数据等。一切都很好。然后程序又突然崩溃了。

然后我打开了 NSZombieEnabled。果然，当程序最终崩溃时，我得到了消息：

```
-[CFArray count]: message sent to deallocated instance 0x16b90bd0 
```

“info malloc 0x16b90bd0”然后产生：

```
0: 0x93db810c in malloc_zone_malloc
1: 0x946bc3d1 in _CFRuntimeCreateInstance
2: 0x9464a138 in __CFArrayInit
3: 0x946cd647 in _CFStreamScheduleWithRunLoop
4: 0x932d1267 in _Z16_scheduleRStreamPKvPv
5: 0x946bf15c in CFSetApplyFunction
6: 0x932b0e2b in CFNSchedulingSetScheduleReadStream
7: 0x9331a310 in _ZN12HTTPProtocol19createAndOpenStreamEv
8: 0x9332e877 in _ZN19URLConnectionLoader24loaderScheduleOriginLoadEPK13_CFURLRequest
9: 0x9332d739 in _ZN19URLConnectionLoader26LoaderConnectionEventQueue33processAllEventsAndConsumePayloadEP20XConnectionEventInfoI12XLoaderEvent18XLoaderEventParamsEl
10: 0x9332dbdd in _ZN19URLConnectionLoader13processEventsEv
11: 0x932d8dbf in _ZN17MultiplexerSource7performEv
12: 0x946ba595 in CFRunLoopRunSpecific
13: 0x946bac78 in CFRunLoopRunInMode
14: 0x9058c530 in +[NSURLConnection(NSURLConnectionReallyInternal) _resourceLoadLoop:]
15: 0x90528e0d in -[NSThread main]
16: 0x905289b4 in __NSThread__main__
17: 0x93de8155 in _pthread_start
18: 0x93de8012 in thread_start 
```

我不是阅读堆栈跟踪的专家，但此跟踪是否表明 Apple 代码存在问题，而不是我的代码？或者我可以以某种方式负责取消分配有问题的 CFArray 吗？我有什么方法可以进一步调查问题的原因吗？

* * *

（这是我原来的帖子的其余部分）

看到`stringWithContentsOfURL`已弃用，我切换到以下代码：

```
pathURL = [NSURL URLWithString:[NSString stringWithFormat:@"http://finance.yahoo.com/d/quotes.csv?s=%@&f=l1c1p2", escsymbol]];

NSURLRequest *request = [NSURLRequest requestWithURL:pathURL cachePolicy:NSURLRequestReturnCacheDataElseLoad timeoutInterval:30.0];

responseData = [ NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

NSString *currinfo = nil;

if ([error code]) {  dNSLog((@"%@ %d %@ %@ %@", [ error domain], [ error code], [ error localizedDescription], request, @"file://localhost/etc/gettytab"));  } 
```

这没有帮助。`sendSynchronousRequest`程序在任意时间后仍然在线崩溃，调试器中有以下信息：

```
0   0x93db7286 in mach_msg_trap
1   0x93dbea7c in mach_msg
2   0x946ba04e in CFRunLoopRunSpecific
3   0x946bac78 in CFRunLoopRunInMode
4   0x932b53eb in CFURLConnectionSendSynchronousRequest
5   0x905dca4b in +[NSURLConnection sendSynchronousRequest:returningResponse:error:] 
```

...ETC。

真正的崩溃实际上可能在不同的线程中：

```
0   libobjc.A.dylib                 0x965c3688 objc_msgSend + 24
1   com.apple.CoreFoundation        0x946cc581 _CFStreamSignalEventSynch + 193
2   com.apple.CoreFoundation        0x946ba595 CFRunLoopRunSpecific + 3141
3   com.apple.CoreFoundation        0x946bac78 CFRunLoopRunInMode + 88
4   com.apple.Foundation            0x9058c530 +[NSURLConnection(NSURLConnectionReallyInternal) _resourceLoadLoop:] + 320
5   com.apple.Foundation            0x90528e0d -[NSThread main] + 45
6   com.apple.Foundation            0x905289b4 __NSThread__main__ + 308
7   libSystem.B.dylib               0x93de8155 _pthread_start + 321
8   libSystem.B.dylib               0x93de8012 thread_start + 34 
```

我认为这是为下载 URL 而产生的线程。顺便说一句，错误处理代码工作正常——当我故意通过断开与互联网的连接导致错误时，错误只是在控制台中报告并且程序不会崩溃。

这令人难以置信的沮丧。我很乐意花尽可能多的时间来追踪问题，但我对 gdb 尤其是汇编语言的知识有限。我不知道如何找出 Foundation 代码的实际问题。起初我认为也许 autoreleased`NSString escsymbol`以某种方式被解除分配，但向它发送保留消息并没有帮助。如果*是*这样，我怎么证明呢？

其他人有这个问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T00:20:59.047

我认为尤金在这个帖子中的回复正确地描述了这个问题；经过一些测试，这是我得出的结论似乎正在发生，希望有一些细节可以帮助其他人解决这个问题：

重定向 URL 会定期导致失败。这发生在`NSURLConnection`. 我已经创建了一个测试项目来追踪这个错误，并且这种崩溃会一直发生（通常在 25-500 次迭代之间）。在 10.5.6 上运行相同的测试或不重定向 URL 不会失败（已运行多达 20,000 次迭代）。

有两种可能的解决方法：

1.  不要使用重定向 URL：
    显然这并不总是可行的，但如果它是一个已知的 URL，您仍然可以使用简单的调用（如`stringWithContentsOfURL:`），这样就可以正常工作。丹尼斯，在你的情况下，正确的服务器 URL 是`download.finance.yahoo.com`，不是`finance.yahoo.com`，所以我相信这会解决你的特定问题。使用`curl`你可以看到当你点击后一个地址时你会得到一个 301 重定向。
2.  使用异步调用并实现`connection:willSendRequest:redirectResponse:`
    如果你实现了这个委托方法的最基本的处理，一切似乎都正常。如果你忽略了这个调用（从而让系统使用它的默认实现），你就会崩溃。对于基本实现，只需返回传入的请求：

```
- (NSURLRequest *)connection:(NSURLConnection *)connection 
             willSendRequest:(NSURLRequest *)request 
            redirectResponse:(NSURLResponse *) redirectResponse
{
    return request;
} 
```

所有这些似乎都在向我表明，Apple 在 10.5.7 中的实施存在问题，但如果其他人对可能发生的事情有任何见解，请插话。

我已将我的测试项目的错误提交给 Apple，`rdar://6936109`并引用了 tjw 的报告 (Radar 6932684)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-29T18:57:54.873

这似乎与重定向有关。我的应用程序直接下载大约 500 兆数据（几百个单独的文件）不会崩溃。同一个应用程序下载较小的 URL 集，所有这些 URL 都会在该点随机崩溃几次（重新启动恢复，并且一遍又一遍地重新启动实际上会导致成功下载）。

编辑：顺便说一句，科林关于重新实现重定向的建议似乎不适用于 NSURLDownload :(。

EDIT2：好的，这似乎是一个竞争条件。添加 cerr << "重定向" << endl; 在回调中使用 NSURLDownload 为我“修复”它。休眠 1 秒或锁定本地静态互斥体没有任何效果......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-29T07:01:07.600

objc_msgSend 中的崩溃通常是由于不正确的对象生命周期（即对象已被释放并且正在发送消息）。

使用 NSZombieEnabled 运行您的代码，以确定这是否确实是您的问题，并查看哪个对象正在提前发布。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T17:33:54.823

在 Omni Group，我们在所有使用 NSURL 的应用程序中也看到了 10.5.7 中的这种新崩溃，在异步使用中（所以我认为同步的事情是一个红鲱鱼）。我们在 TextMate 中也遇到过这种情况（大概是在软件更新中）。

我已经在这个问题上记录了[Radar 6932684](http://rdar://6932684)，如果你也看到了，我强烈建议你们都报告它，无论你能收集到什么细节。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T09:07:28.873

我还在几个应用程序的 10.5.7 中看到了同样的崩溃。

鉴于实现最简单的`connection:willSendRequest:redirectResponse:`委托方法将解决问题，我认为可能与[雷达#6700222](http://www.openradar.me/6700222)高度相关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-26T00:17:22.673

值得一提的是，这似乎已在 10.5.8 上得到修复——但它已被一个*新*错误所取代，该错误在大约 2% 的时间里将重定向的响应主体添加到实际响应中。（通过旋转 -stringWithContentsOfURL: 很容易重现，但我们也曾在野外看到过。）将该错误报告为雷达 #7169953。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T01:42:39.487

We're seeing the same issue, using both the non-deprecated `stringWithContentsOfURL` and `sendSynchronousRequest` (in different places). We see the same type of behavior; the call can work fine for many iterations, and then will randomly fail (on identical requests).

Given that the synchronous calls are built on top of the async mechanism, there's no reason these calls shouldn't still be working properly. Unfortunately, we don't have a solution yet either.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T01:06:16.393

我建议不要使用同步 URL 连接。它确实需要一些代码重组，但阻塞网络上的主线程确实是一种糟糕的行为。（假设您在主线程中执行此操作）。

另外，我猜这是 Apple 计划弃用或停止维护的代码，这可能就是您在这里看到的。

希望有帮助……

# events - tinyos 中的事件是否在堆栈内发出信号？

> ID：916720
> 
> 赞同：0
> 
> 时间：2009-05-27T16:25:19.813
> 
> 标签：events, callstack, tinyos

我想问一些我认为在 tinyos2 编程手册中没有明确说明的问题。当命令或任务发出接口事件信号时，是立即调用连接函数，即在同一个调用堆栈中，还是这些信号事件“发布”以供以后执行？

我倾向于相信它是前一个，但只是为了澄清它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T19:19:32.770

TinyOS 1 or 2 does not make a difference here - this is a nesC question. Upon signal, execution begins immediately. However, if multiple components are wired to an interface, execution is done one after another (aka. fan-out).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T17:02:07.760

我只知道 TinyOS v1，但我相信它们在这方面是相同的。

事件只是函数调用，因此与调用者在同一个堆栈上执行。

如果需要发布某些内容以供以后执行，则应将其实现为任务。因此，需要长时间运行工作以响应事件但又不想干扰中断延迟的事件消费者应该安排一个任务，该任务应该做一点工作，然后安排一个任务去做更多的工作以同样的方式。

# c# - 设置 Window.Content 不会破坏之前的 UI？

> ID：916732
> 
> 赞同：3
> 
> 时间：2009-05-27T16:27:34.147
> 
> 标签：c#, wpf, xaml

我正在使用 XamlReader 加载 XAML 文件并将返回对象设置为窗口的 Content 属性。虽然这似乎运作良好，但它并没有达到我的预期。如果窗口的原始 XAML 包含键绑定或按钮，它们似乎仍然存在。键绑定仍然有效，代码中的任何 Button 对象仍然有效。自从我用新的 XAML 替换它们后，我原以为一切都会被破坏，但事实并非如此。

那么设置内容究竟是做什么的呢？它不做什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:57:06.303

更改 Content 属性您只是切换表示 Window 内容的对象，所有元素树都将被维护，包括绑定。在 WPF 中，您不能显式地处置控件，因为没有什么可处置的，我的意思是，没有要释放的非托管资源。如果以后不引用此控件，GC 将清理它们。对于键绑定，您必须以编程方式删除它们，遍历窗口控件或调用相应的应用程序命令清理器，例如：

```
ApplicationCommands.Close.InputGestures.Clear(); 
```

希望这可以帮助！

# c# - 从多个工作站收集数据

> ID：916745
> 
> 赞同：0
> 
> 时间：2009-05-27T16:30:46.590
> 
> 标签：c#, data-collection

我目前正在开发一个 Windows 服务，该服务将部署到公司内的所有工作站。该服务的目的是收集各种统计数据并将其记录在一个中心位置。

对于第一次迭代，每次有数据要记录时，服务都会直接调用 SQL 来记录。在大约 120 个工作站上对其进行测试告诉我，这不是一个好主意并且不会扩展。

有人可以推荐一种替代策略来收集不会使数据库服务器超载的相关数据吗？这将部署到大约 2000 台机器上。

我正在使用 C#。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T17:02:09.223

从您的问题来看，您似乎已经有了一个可行的解决方案，您只需要有关如何使其扩展的建议。这是我的两分钱：

*   不要在工作站的服务中保持 SQL 连接打开
*   尝试在内存中批量更新数据，并且仅在收集到一定数量的数据或经过一定的时间间隔后才更新数据库（使您的连接不那么冗长，更笨重）。
*   确保您的数据库已正确规范化以避免重复数据

就个人而言，对于需要扩展到 2000 个工作站的关键任务，我会使用商业产品，不会重新发明轮子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-06T20:07:15.557

只是回答结束问题。这是我最终实现它的方式。

**数据采集**

*   AC# 服务在工作站上运行。在不同的时间间隔（不是预先确定的，基于系统上的某些事件）它会触发数据收集。
*   数据被写入本地工作站上的文件。
*   然后将数据文件复制到网络位置。

**数据解析**

*   “进口商”程序按计划运行。它遍历自上次运行以来创建的所有文本文件，解析它们并将它们导入 SQL。

我以这种方式实现它的原因是：

*   避免我在原始问题中提到的 SQL 服务器的资源问题。
*   创建的文件非常小，1-2KB
*   Importer 会在过去几分钟内运行，以避免与正在进行的任何副本发生冲突。
*   Importer 删除已处理的文件并跳过不在其“lastscantime”和“currentTime-Xminute”窗口内的文件。

# .net - 通过 XAML 刷新 WPF UserControl

> ID：916752
> 
> 赞同：1
> 
> 时间：2009-05-27T16:32:21.250
> 
> 标签：.net, wpf, wpf-controls, refresh

我在 Visual Studio 2008 中使用 WPF。我有一个简单的 WPF UserControl，代码如下：

```
 public partial class UserControl1 : UserControl
  {
    public UserControl1()
    {
      InitializeComponent();
      Composite = new Composite();
    }

    protected override void OnRender(DrawingContext drawingContext)
    {
      //LayoutRoot is name of default Grid instance
      if (!LayoutRoot.Children.Contains(Composite))
      {
        LayoutRoot.Children.Add(Composite);
      }
    }

    public Composite Composite
    {
      get;
      set;
    }
  }

  public class Composite : ContentControl
  {
    protected override void OnRender(DrawingContext drawingContext)
    {
      drawingContext.DrawRectangle(new SolidColorBrush(Color), new Pen(Brushes.Black, 1.0), new Rect(RenderSize));
    }

    public Color Color
    {
      get;
      set;
    }
  } 
```

然后我在 WPF 应用程序中使用这个 UserControl，页面的 XAML 如下所示：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:test="clr-namespace:WpfControlLibrary1;assembly=WpfControlLibrary1"
    Title="Window1" Height="500" Width="700" Background="AliceBlue">
  <test:UserControl1 Name="uControl1">
    <test:UserControl1.Composite>
      <test:Composite Color="Green"/>
    </test:UserControl1.Composite>
  </test:UserControl1>
</Window> 
```

我的问题是：我必须在上面添加什么代码，以便通过将“复合颜色”更改为绿色以外的其他颜色并点击返回按钮，UserControl 会自动刷新？我正在寻找的行为是当您将 Window1 的背景更改为 AliceBlue 以外的颜色并点击返回时会发生什么。

当我运行代码时，可以看到正确的颜色，问题出在设计时通过 XAML 刷新。

非常感谢任何帮助我理解这里发生了什么的指针！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T16:57:35.613

WPF 已优化为仅在绝对必要时才重新绘制项目，因此您看到的行为部分是因为 WPF 不知道当您更改 Composite.Color 时，它需要重新绘制控件。

最重要的是，Visual Studio/Blend 设计器（或 XAML 控件）将无法注意到该属性已更改，因为您的控件未发出该属性已更改的信号；如果没有该通知，WPF 不知道该属性已更改（这样可以避免它一直检查是否有更改）。

虽然您可以实现 INotifyPropertyChanged 并修复第二个问题，但由于您是从 ContentControl 继承（在继承层次结构中，它实现了 INotifyPropertyChanged），您可以使用 DependencyProperty 并修复这两个问题 - 并获得更好的 WPF 绑定支持，以开机！

```
// DependencyProperty backing store for Color.  This enables animation, styling, binding, etc...
public static readonly DependencyProperty ColorProperty =
    DependencyProperty.Register("Color", typeof(Color), typeof(Composite), 
    new FrameworkPropertyMetadata(new Color(), FrameworkPropertyMetadataOptions.AffectsRender));

public Color Color
{
    get { return (Color)GetValue(ColorProperty); }
    set { SetValue(ColorProperty, value); }
} 
```

通过设置**FrameworkPropertyMetadataOptions.AffectsRender**，WPF 知道当此属性更改时，需要再次执行此项的渲染传递，并将重新渲染您的控件，调用您的 OnRender() 方法并显示新颜色。而且，作为一个 DependencyProperty，它会自动生成正确的 PropertyChanged 事件，以便任何观看您的类（如 WPF 的绑定和动画系统）的人都会在属性更改时立即收到更新通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T06:11:52.353

您正在以一种非常奇怪的方式处理此问题（让人想起 MFC 控件）；花一些时间阅读 WPF Unleashed 的前半部分（[http://www.amazon.com/Windows-Presentation-Foundation-Unleashed-WPF/dp/0672328917/ref=sr_1_1?ie=UTF8&s=books&qid=1243491021&sr =8-1](https://rads.stackoverflow.com/amzn/click/com/0672328917) )，读起来很愉快，一切都会*变得*更有意义。

# c# - 如何处理VS2008中的错误

> ID：916754
> 
> 赞同：0
> 
> 时间：2009-05-27T16:33:00.983
> 
> 标签：c#, visual-studio-2008, designer

当我尝试在 VS2008 中启动一个新的 C# 项目时，我立即收到错误消息：“无法为该文件显示设计器，因为其中没有任何类可以设计”，也就是说，我什至在写一行之前就得到了这个的代码。

对于这个相当普遍的问题，谷歌没有任何有用的解决方案，但我尝试重新安装我的 VS2008，但没有帮助。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T16:36:16.017

来自[MSDN](http://msdn.microsoft.com/en-us/library/0t335zts(VS.80).aspx)：

> 当 Visual Studio 找不到满足设计器要求的基类时，会发生此错误。示例包括： Visual Studio 找不到基类的设计器；基类是无法找到或加载的类。
> 
> **纠正这个错误**
> 
> *   窗体和控件必须派生自支持设计器的基类。如果您从正在处理的项目中的某些东西（例如继承的表单或控件）派生，则需要通过从“构建”菜单中选择“构建解决方案”来确保构建项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T16:38:17.090

备份然后重命名“我的文档”中的“Visual Studio 2008”目录。然后运行 ​​devenv.exe /safemode

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T16:45:25.280

根据您创建的项目类型，Visual Studio 可能错误地尝试使用表单设计器打开正常的 .cs 文件。如果是这种情况，请在您的解决方案中找到一个 .cs 文件并右键单击它。然后选择 Open with... 选择 CSharp Editor 并选择“Set as Default”。

另一方面，如果您尝试启动 Winforms 项目，则默认选择的第一个文件是 Form1.cs，它应该在编辑器中正确打开。在这种情况下，项目模板似乎有问题并且表单没有正确继承 - 尽管我希望重新安装来解决这个问题。

# iphone - iphone sdk 3.0，固件测试，不仅仅是模拟器

> ID：916756
> 
> 赞同：0
> 
> 时间：2009-05-27T16:33:33.260
> 
> 标签：iphone, iphone-sdk-3.0

测试使用 iphone 的 sdk 3.0 构建的应用程序。根据经验，我知道错误会出现在永远不会出现在模拟器中的硬件上，所以模拟器只会带我到此为止。是否可以将 3.0 beta 固件（不是 sdk）放在硬件设备上，如果可以，我在哪里可以找到 beta 固件？还是我必须等到六月中旬才能发布？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T16:59:07.220

首先，您需要成为 Apple Developer Network 的成员（免费），并拥有 iPhone Development 的会员访问权限（2.x 版免费）。

获得 iPhone 开发者许可证后，您将可以访问 iPhone 的 beta SDK 和 beta 固件（我目前在我的 iPhone 3G 上运行 3.0 beta 5）。

你可以看到如果你为 iPhone 开发者计划支付了 99 美元，你会得到什么

[替代文字 http://www.quicksnapper.com/files/5182/2042671054A1D7136B2BE0_m.png](http://www.quicksnapper.com/files/5182/2042671054A1D7136B2BE0_m.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T16:34:54.600

您可以在 Apple Developer 页面上下载它。

# python - 设置 svnperms 预提交钩子

> ID：916758
> 
> 赞同：0
> 
> 时间：2009-05-27T16:34:15.833
> 
> 标签：python, svn, unix, pre-commit

我正在尝试将 svnperms 实现到存储库中，但是在一些事情上遇到了困难：

pre-commit 具有执行权限：

```
-rwxrwxr-x   1 svnadm     svn           3018 May 27 10:11 pre-commit 
```

这是我在预提交中对 svnperms 的调用：

```
# Check that the author of this commit has the rights to perform
# the commit on the files and directories being modified.
SVNPERMS=/usr/local/svn/scripts/svnperms.py
$SVNPERMS -r $REPOS -t $TXN || exit 1 
```

我在指定的位置安装了 svnperms.py：

```
# ls -l /usr/local/svn/scripts
total 24
-rwxrwxr-x   1 svnadm     svn          11840 May 25 07:48 svnperms.py 
```

svnperms.py 是 UNIX 格式 - 没有 ^M 行结尾。

TortoiseSVN 回来了：

```
Command: Commit  
Modified: C:\projects\Sandbox\Trunk\Test.txt  
Sending content: C:\projects\Sandbox\Trunk\Test.txt  
Error: Commit failed (details follow):  
Error: 'pre-commit' hook failed with error output:  
Error: No such file or directory: python 
```

不带参数调用 svnperms 显示：

```
/usr/local/svn/scripts/svnperms.py
missing required option(s): repository, either transaction or a revision
Usage: svnperms.py OPTIONS

Options:
    -r PATH    Use repository at PATH to check transactions
    -t TXN     Query transaction TXN for commit information
    -f PATH    Use PATH as configuration file (default is repository
               path + /conf/svnperms.conf)
    -s NAME    Use section NAME as permission section (default is
               repository name, extracted from repository path)
    -R REV     Query revision REV for commit information (for tests)
    -A AUTHOR  Check commit as if AUTHOR had commited it (for tests)
    -h         Show this message 
```

UNIX 管理员最近安装了 python，但不确定是否所有依赖项都在那里。如果这是问题所在，我不确定如何确定，因为 python 似乎根据上面的输出工作。

我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T17:28:47.253

我的猜测是`python`二进制文件的位置不在`$PATH`svn 服务器中。沙邦行`svnperms.py`如下：

```
#!/usr/bin/env python 
```

但这假设可执行文件位于`$PATH`调用者的。如果您无权修改 subversion 服务器的运行时环境，请尝试将`python`shabang 行中的路径替换为`which python`交互式运行时给出的路径。

# jquery - jQuery滑块是如何实现的？

> ID：916766
> 
> 赞同：0
> 
> 时间：2009-05-27T16:36:04.770
> 
> 标签：jquery, jquery-ui

有人知道 jQuery 滑块是如何实现的吗？它是使用 JavaScript 画布库来绘制两条引导线还是其他什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T16:40:03.280

jQuery 滑块使用 HTML 元素来构建滑块。它不使用画布库。

这是滑块的构建方式：

```
<div id="slider" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
    <div class="ui-slider-range ui-widget-header" style="left: 17%; width: 50%;"/>
    <a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="left: 17%;"/>
    <a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="left: 67%;"/>
</div> 
```

这些类：`ui-widget ui-widget-content ui-corner-all ui-state-default`都来自[jQuery 用户界面 CSS 框架](http://jqueryui.com/docs/Theming/API)。

简而言之，这个插件混合使用 HTML 元素、CSS 样式和 jQuery 事件来模拟滑块控件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T16:41:29.733

它是开源的，您可以在[此处](http://jquery-ui.googlecode.com/svn/tags/1.7.1/ui/ui.slider.js)查看源代码。它不使用画布，只使用 html 元素。

# watin - WatiN 错误：无法加载

> ID：916769
> 
> 赞同：3
> 
> 时间：2009-05-27T16:36:49.183
> 
> 标签：watin

我正在使用 watiN 进行一个新的测试项目，但总是出现此错误，

无法加载文件或程序集 'WatiN.Core, Version=2.0.3.913, Culture=neutral, PublicKeyToken=db7cfd3acb5ad44e' 或其依赖项之一。试图加载格式不正确的程序。

我错过了什么？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T16:47:13.263

该程序集似乎是强命名的，因此您可以将它安装在 GAC 中（打开 C:\windows\assembly 并将 dll 拖到那里）。如果您在计算机上找不到它，您可能需要从 Internet 下载它。

如果做不到这一点，你是在 64 位计算机上吗？可能是 watin 要求您将程序作为 32 位应用程序执行（在 Visual Studio 中，这位于“构建配置”部分下）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-09T00:45:37.997

如果您需要在 64 位运行 WatiN，您可以在项目属性中获取源并将目标平台更改为 x64。重建项目并引用新的 64 位 WatiN.Core。它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T16:42:45.333

您是否需要在项目中添加对 WatiN 程序集的引用？或者可能将 WatiN 程序集复制到您的 /bin 文件夹？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-22T13:12:45.000

只是补充一下 - 如果您不能/不想为 32 位重新编译您的 Watin 项目并且它是使用 32 位编译的并且您想在 64 位环境中运行它，您需要将它的标题标志更改为使用 32 位。

这是通过发出以下命令来完成的：

```
"C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bin\CorFlags.exe" /32BIT+ myWatinProg.exe 
```

corFlags 命令是 64 位平台上的 windows SDK 的一部分。

（取自[http://sourceforge.net/projects/watintestrecord/forums/forum/682552/topic/3229029](http://sourceforge.net/projects/watintestrecord/forums/forum/682552/topic/3229029)）

# batch-file - 批处理文件：密码星/圈

> ID：916770
> 
> 赞同：1
> 
> 时间：2009-05-27T16:37:10.257
> 
> 标签：batch-file, passwords

就像您已经知道的那样，网站有某些特殊的密码字符，例如星号和圆圈。

这可能在批处理文件中，在以下文件中：？

如果这是不可能的，如果你输入它，你会什么都看不到吗？

```
set pass=
set /p pass=Enter your password: 
if {%pass%}=={} goto :begin
set authenticated=
for /f "tokens=*" %%a in (pass.txt) do (
    if {%%a}=={%pass%} set authenticated=true
)
if not defined authenticated (echo Invalid password & goto :begin) 
```

但我需要把它放进去：

```
for /f "delims=" %%i in ('cscript /nologo GetPwd.vbs') 
```

如何！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T16:39:52.047

不是直接的。您必须在其他东西中编写密码输入程序，然后从批处理文件中运行它以捕获密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T17:02:34.527

这里给出了几种实现这一点的方法：[我可以在 bat 文件中屏蔽输入文本吗](https://stackoverflow.com/questions/664957/can-i-mask-an-input-text-in-a-bat-file)？另外，也许有人将其标记为重复？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T18:04:44.713

另一种选择是我的 EditV32 (x86) 或 EditV64 (x64) 命令行工具。例如：

editv32 -m -p "密码：" PWD

-m 表示“屏蔽输入”，-p 是提示符。用户的输入存储在 PWD 环境变量中。你可以在这里得到它：

[http://www.westmesatech.com/editv.html](http://www.westmesatech.com/editv.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T19:22:12.593

[如何为批处理文件创建屏蔽输入](http://www.instructables.com/id/How-to-create-a-masked-input-to-a-batch-file/)- 这有帮助吗？它似乎因平台而有所不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T17:56:35.173

搞定了：

批处理文件：

```
@echo off
<nul: set /p passwd=Password: 
for /f "delims=" %%i in ('cscript /nologo GetPwd.vbs') do set passwd=%%i 
```

获取密码.vbs：

```
Set oScriptPW = CreateObject("ScriptPW.Password")
strPassword = oScriptPW.GetPassword()
Wscript.StdOut.WriteLine strPassword 
```

# visual-studio - 如何在 ClickOnce 部署中自动重命名“应用程序文件”文件夹

> ID：916771
> 
> 赞同：3
> 
> 时间：2009-05-27T16:37:41.897
> 
> 标签：visual-studio, clickonce

我们目前正在使用 Visual Studio 构建 ClickOnce 部署包，但我们想重命名“应用程序文件”，因为我们使用的网络服务器不支持空格。

我们发现，如果我们直接进入 .application 文件，我们可以修改指向的路径，也可以手动重命名文件夹。

有谁知道自动化的方法，无论是使用 MageUI 还是任何其他实用程序？将一个批处理脚本放在一起为我们进行更改是很诱人的。部署也使用未签名的文件，因为我们不需要担心证书（它只是一个内部应用程序）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-10T19:07:43.687

由于似乎没有人知道这个问题的答案，我自己找到了一种方法。我创建了一个 powershell 脚本。请注意，这仅适用于未签名的清单。

```
gci -Recurse -include *.application | ForEach-Object { [System.IO.File]::WriteAllLines($_.FullName, [System.IO.File]::ReadAllText($_.FullName).Replace("Application Files", "ApplicationFiles")) }
gci -recurse | Where {$_.psIsContainer -eq $true} | Where {$_.Name -eq "Application Files"} | ForEach-Object { $_.MoveTo($_.FullName.Replace("Application Files", "ApplicationFiles")) } 
```

我的powershell并不神奇，所以可能有更好的方法，但这就是我想出的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-04T22:31:22.960

首先，手动尝试。

将应用程序发布到文件夹（将发布位置设置为 C:\publish 之类的内容，并正确设置安装 URL，例如[http://myserver/myapp/](http://myserver/myapp/)）。

然后进去，将 Application Files 重命名为 C:\publish 中的 ApplicationFiles。

转到 C:\publish\ApplicationFiles\yourapp_a_b_c_d\ 文件夹并删除 yourapp.application。（相信我，如果你不这样做，当你重新添加文件时，mageui 会崩溃）。

运行 MageUI（它位于 c:\program files\microsoft sdks\windows\v7.0a\bin 或 v6.0a\bin 中，具体取决于您运行的 VS 版本）。

在 MageUI 中，单击打开，查找 c:\publish\ApplicationFiles\yourapp_a_b_c_d\yourapp.exe.manifest 并打开它（其中 a_b_c_d 是您的版本，yourapp 是您的应用程序名称）。

你应该看到名字和东西。单击文件。确保选中“填充时添加部署扩展...”，然后单击“填充”（尽管想想，都应该具有该扩展，除非您在 VS 中更改它）。这会将文件夹中的所有文件添加到应用程序清单/

保存并签署应用程序清单。

然后再次 clck 打开，打开 c:\publish\yourapp.application。

单击“应用程序参考”。在右侧，单击选择清单。浏览到您刚刚编辑的那个 (C:\publish\ApplicationFiles\yourapp_a_b_c_d\yourapp.exe.manifest)。这会更新部署清单，以便它可以在正确的应用程序清单中找到文件列表。保存并签署部署清单 (yourapp.application)。

将文件夹复制到网络服务器，它应该可以工作。

现在，如果这对你有用，你可以用 Mage 命令替换 mageui 的东西，并且可能做一些简单的脚本来将文件复制到新文件夹或将“应用程序文件”重命名为“应用程序文件”。

如果您需要，我可以为您提供 Mage 命令。

# python - 像 ConfigParser 这样的东西是否适合在运行之间保存状态（键、值）？

> ID：916779
> 
> 赞同：2
> 
> 时间：2009-05-27T16:39:41.843
> 
> 标签：python, xml, perl, configparser

我想在 Python 程序的运行之间保存一组键、值对（字符串、整数），在后续运行时重新加载它们，并编写更改以在下次运行时可用。

我不认为这些数据是配置文件，但它非常适合 ConfigParser 功能。我只需要两个[部分]。它只有几百对而且非常简单，所以我认为没有必要做一个实际的数据库。

以这种方式使用 ConfigParser 是否合适？我也考虑过使用 Perl 和 XML::Simple。那个怎么样？有没有办法在没有 Python 或 Perl 的 bash 中做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-27T16:49:26.503

好吧，你有更好的选择。例如，您可以使用[pickle](http://docs.python.org/library/pickle.html)或[json](http://docs.python.org/library/json.html)格式。Pickle 序列化模块非常好用。

```
import cPickle
cPickle.dump(obj, open('save.p', 'wb')) 
obj = cPickle.load(open('save.p', 'rb')) 
```

该格式不是人类可读的，并且 unpickling 对于错误或恶意构造的数据不安全。您不应该解开不受信任的数据。

如果您使用的是 python 2.6，则有一个名为[json](http://docs.python.org/library/json.html)的内置模块。使用起来就像泡菜一样简单：

```
import json
encoded = json.dumps(obj)
obj = json.loads(encoded) 
```

Json 格式是人类可读的，与 python 中的字典字符串表示非常相似。并且没有任何像泡菜这样的安全问题。

如果您使用的是较早版本的 python，则可以使用[simplejson](http://code.google.com/p/simplejson/)代替。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T16:55:39.660

对我来说，[PyYAML](http://pyyaml.org/wiki/PyYAML)非常适合这类事情。我以前使用过 pickle 或 ConfigParser。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T17:06:22.540

ConfigParser 是一种很好的方法。还有其他方法（已经提到的 json 和 cPickle 模块可能有用）也很好，这取决于您是否想要文本文件或二进制文件，以及您是否希望代码仅在旧版本的 Python 中工作。

您可能希望在您选择的方式之上有一个薄抽象层，以便更容易改变您的想法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T18:46:12.027

听起来像是[dbm](http://en.wikipedia.org/wiki/Dbm)的工作。基本上它是一个存在于您的程序外部的哈希。有很多实现。在 Perl 中，[将一个 dbm 与一个散列联系](http://perldoc.perl.org/AnyDBM_File.html)起来是微不足道的（即，让它看起来像一个 dbm 真的是一个普通的散列变量）。我不知道 Python 中是否有任何等效机制，但如果没有，我会感到惊讶。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T17:02:14.873

在 bash 中重新执行：如果您的字符串是有效的标识符，您可以使用环境变量和`env`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T03:45:52.743

如果您可以逐键更新状态键，那么任何 DBM 数据库都可以工作。如果您需要真正的高性能和紧凑的存储空间，那么 Tokyo Cabinet - [http://tokyocabinet.sourceforge.net/](http://tokyocabinet.sourceforge.net/)是一款很酷的玩具。

如果您想一次保存和加载整个内容（可能保留旧版本或类似版本）并且没有太多数据，那么只需使用 JSON。它比 XML 好用得多。我不知道 JSON 在 Python 中的实现如何，但在 Perl 中 JSON::XS 模块非常快。

# sql-server - 如何在视图中调用存储过程？

> ID：916784
> 
> 赞同：41
> 
> 时间：2009-05-27T16:41:22.793
> 
> 标签：sql-server, tsql, database-design

如何调用在视图中返回数据的存储过程？这甚至可能吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-27T18:16:33.757

SQL Server 中不允许这种构造。内联表值函数可以作为参数化视图执行，但仍然不允许像这样调用 SP。

下面是一些可互换使用 SP 和内联 TVF 的示例 - 您会看到 TVF 更灵活（它基本上更像是视图而不是函数），因此在可以使用内联 TVF 的地方，它们可以更灵活可用：

```
CREATE TABLE dbo.so916784 (
    num int
)
GO

INSERT INTO dbo.so916784 VALUES (0)
INSERT INTO dbo.so916784 VALUES (1)
INSERT INTO dbo.so916784 VALUES (2)
INSERT INTO dbo.so916784 VALUES (3)
INSERT INTO dbo.so916784 VALUES (4)
INSERT INTO dbo.so916784 VALUES (5)
INSERT INTO dbo.so916784 VALUES (6)
INSERT INTO dbo.so916784 VALUES (7)
INSERT INTO dbo.so916784 VALUES (8)
INSERT INTO dbo.so916784 VALUES (9)
GO

CREATE PROCEDURE dbo.usp_so916784 @mod AS int
AS 
BEGIN
    SELECT  *
    FROM    dbo.so916784
    WHERE   num % @mod = 0
END
GO

CREATE FUNCTION dbo.tvf_so916784 (@mod AS int)
RETURNS TABLE
    AS
RETURN
    (
     SELECT *
     FROM   dbo.so916784
     WHERE  num % @mod = 0
    )
GO    

EXEC dbo.usp_so916784 3
EXEC dbo.usp_so916784 4

SELECT * FROM dbo.tvf_so916784(3)    
SELECT * FROM dbo.tvf_so916784(4)

DROP FUNCTION dbo.tvf_so916784
DROP PROCEDURE dbo.usp_so916784
DROP TABLE dbo.so916784 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-10-22T11:07:43.603

```
exec sp_addlinkedserver 
        @server = 'local',
        @srvproduct = '',
        @provider='SQLNCLI',
        @datasrc = @@SERVERNAME
go

create view ViewTest
as
select * from openquery(local, 'sp_who')
go

select * from ViewTest
go 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-04-14T00:28:22.110

我能够在视图中调用存储过程（SQL Server 2005）。

```
CREATE FUNCTION [dbo].[dimMeasure] 
   RETURNS  TABLE  AS

    (
     SELECT * FROM OPENROWSET('SQLNCLI', 'Server=localhost; Trusted_Connection=yes;', 'exec ceaw.dbo.sp_dimMeasure2')
    )
RETURN
GO 
```

在存储过程中，我们需要设置：

```
set nocount on
SET FMTONLY OFF 
```

```
CREATE VIEW [dbo].[dimMeasure]
AS

SELECT * FROM OPENROWSET('SQLNCLI', 'Server=localhost;Trusted_Connection=yes;', 'exec ceaw.dbo.sp_dimMeasure2')

GO 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T16:46:45.060

如果您使用的是 Sql Server 2005，则可以使用表值函数。您可以直接调用它们并传递参数，同时将它们视为表格。

有关更多信息，请查看[表值用户定义函数](http://msdn.microsoft.com/en-us/library/ms191165(SQL.100).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T16:44:28.777

您必须编写如下视图的脚本。~~您实际上会将 proc 的结果写入表 var 或 temp 表，然后选择到视图中。~~

**编辑**- 如果您可以将存储过程更改为表值函数，它将消除选择临时表的步骤。

**编辑 2 ** - 评论是正确的，即无法像我建议的那样将 sproc 读入视图。相反，将您的过程转换为其他帖子中提到的表值函数并从中选择：

```
create view sampleView
as select field1, field2, ... 
from dbo.MyTableValueFunction 
```

我为混乱道歉

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-11T18:53:22.043

```
create view sampleView as 
select field1, field2, ... 
from dbo.MyTableValueFunction 
```

请注意，即使您的 MyTableValueFunction 不接受任何参数，您仍然需要在其后包含括号，即：

```
... from dbo.MyTableValueFunction() 
```

如果没有括号，您将收到“无效的对象名称”错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-18T14:03:27.217

我可能找到的最简单的解决方案是根据您从 SP 获得的数据创建一个表。然后从中创建一个视图：

从 SP 中选择数据时，在最后一步插入。SELECT * into table1 FROM #Temp

创建视图 vw_view1 作为 select * from table1

# sql-server - ASP.NET 成员资格错误

> ID：916787
> 
> 赞同：4
> 
> 时间：2009-05-27T16:42:37.003
> 
> 标签：sql-server, asp.net-membership

我正在使用 ASP.NET MVC。我将 ASP.NET 成员表插入到我的数据库中，我收到了下面写的错误。也许解决方案？谢谢。

> “System.Web.Security.SqlMembershipProvider”需要与架构版本“1”兼容的数据库架构。但是，当前的数据库架构与此版本不兼容。您可能需要使用 aspnet_regsql.exe（在框架安装目录中提供）安装兼容架构，或者将提供程序升级到更新版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T21:28:45.350

1.  确保数据库中存在“aspnet_SchemaVersions”表
2.  确保它包含您正在使用的每个“功能”的条目。aspnet 脚本*应该*为您执行此操作。
3.  检查您的安全性（连接字符串）以查看您是否有权从该表中选择、从 Web 应用程序执行 procs 等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T17:28:55.817

您是否运行了 aspnet_regsql.exe 文件？

C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regsql.exe

我已经做了无数次了，从来没有遇到过这个错误。尝试这样做。

编辑：

[替代文字 http://img529.imageshack.us/img529/9678/schema.png](http://img529.imageshack.us/img529/9678/schema.png)

也[看看这个](http://forums.asp.net/p/985097/1267872.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T20:51:20.043

感谢您的回复。这些文章非常有帮助。我发现了这个问题，这是一个典型的愚蠢错误。我使用了一个脚本来重新创建 Membership 的所有表。我没有将任何数据复制到这些表中。有一个名为 aspnet_schemaversions 的表。它需要一些值才能验证版本（duh）。当我将这些值添加到表中时，它开始工作。

常见 1 1 健康监测 1 1 成员资格 1 1 个性化 1 1 个人资料 1 1 角色管理器 1 1

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-02T04:30:26.740

旧帖子，但我有一个不同的解决方案：

在我的连接字符串中`web.config`，我已经`Persist Security Info=True;`包含了。删除它解决了我的架构错误，

> “System.Web.Security.SqlMembershipProvider”需要与架构版本“1”兼容的数据库架构。

# sql - mysql在同一张表的UPDATE中嵌套SELECT

> ID：916789
> 
> 赞同：11
> 
> 时间：2009-05-27T16:42:40.137
> 
> 标签：sql, mysql, join

本质上我需要做这样的事情......这只是一个例子......但是第一个查询的语法在 MySQL 中不起作用

```
update people set prize = '' 
where prize = 'Gold' and class = (select class from people where id = person_id);
update people set prize = 'Gold' where id = <id>; 
```

任何班级都只有一个人可以获得金奖。我只知道获得金奖的人的 person_id。

我试图在第一个查询中清除与 person_id 相同类别的任何以前的金奖获得者。然后将新的金牌得主设置在第二个。

我相信我需要使用某种类型的内部连接，但我对此不是 100% 确定的。

如果我可以在一个查询中完成全部工作，那会更聪明！

任何人都可以提供建议吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T17:34:00.190

在单个 SQL 查询中进行复杂的更新并不总是最好的。事实上，运行两个简单的查询可能更有效。因此，请务必对这两种解决方案进行基准测试。

MySQL 支持扩展`UPDATE`多表更新的语法。您可以将 a`JOIN`作为更新的一部分执行，而不是使用子查询。

然后您可以使用`IF()`函数（或`CASE`）`prize`有条件地将值更改为不同的值。

因此，如果您绝对必须使用单个查询，请尝试以下操作：

```
UPDATE people p1 JOIN people p2 
  ON (p1.class = p2.class AND p2.id = <person_id>)
SET prize = IF(p1.id = <person_id>, 'Gold', '')
WHERE p1.id = <person_id> OR p1.prize = 'Gold'; 
```

或者这个替代方案：

```
UPDATE people p1 JOIN people p2 
  ON (p1.class = p2.class AND p2.id = <person_id>)
SET p1.prize = CASE 
  WHEN p1.id = <person_id> THEN 'Gold'
  WHEN p1.prize = 'Gold' THEN ''
  ELSE p1.prize -- other cases are left as is
 END CASE; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T16:47:17.290

```
UPDATE people
SET    prize = CASE WHEN id = @lucky THEN 'Gold' ELSE 'Silver' END
WHERE  class = (
       SELECT  class
       FROM    people
       WHERE   id = @lucky
       ) 
```

这将授予所有用户`Silver`奖励，除了`@lucky`获得`Gold`.

如果您只需要更新`@lucky`和前冠军，请发出以下命令：

```
UPDATE people
SET    prize = CASE WHEN id = @lucky THEN 'Gold' ELSE 'Silver' END
WHERE  id = @lucky
       OR (class, prize) =
       (
       SELECT  class, 'Gold'
       FROM    people
       WHERE   id = @lucky
       ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T17:04:22.480

如果您在单个语句之后，您可以使用 CASE 运算符吗？未使用 MySQL，但类似：

```
UPDATE people
SET prize = CASE
              WHEN 'Gold' AND id != @newid THEN ''
              WHEN '' AND id = @newid THEN 'Gold'
            END 
WHERE class = ( 
                SELECT class 
                FROM people
                WHERE id = @newid 
              ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T16:55:27.507

您绝对可以创建一个将新获奖者的 id 作为参数的存储过程。

然后，您可以在一行中调用该存储过程。

我在这里使用 MS SQL，但类似于：

```
CREATE PROC UpdatePrize
  @newid int

AS

UPDATE people
SET prize = '' 
WHERE prize = 'Gold'
AND class = ( SELECT class 
              FROM people
              WHERE id = @newid )

UPDATE people
SET prize = 'Gold'
WHERE id = @newid

GO 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T17:06:16.377

由于您正在执行两个不同的更新，因此无需在一个查询中执行此操作。如果您担心数据不一致，因为这两个查询之一可能会失败，您可以使用事务并且回滚两个查询中的任何一个都会失败。

您当前的查询是完全可读和可理解的，而发布的解决方案远非易读。

# c++ - 如何在 C++ 中将 CString 转换为 double？

> ID：916790
> 
> 赞同：14
> 
> 时间：2009-05-27T16:42:45.193
> 
> 标签：c++, string, visual-c++, double, type-conversion

如何在 C++ 中将 a 转换`CString`为 a ？`double`

Unicode 支持也会很好。

谢谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-27T16:46:36.480

A`CString`可以转换为 a `LPCTSTR`，这基本上是 a `const char*`（`const wchar_t*`在 Unicode 版本中）。

知道了这一点，您可以使用[`atof()`](http://msdn.microsoft.com/en-us/library/hc25t012.aspx)：

```
CString thestring("13.37");
double d = atof(thestring). 
```

...或对于 Unicode 版本，[`_wtof()`](http://msdn.microsoft.com/en-us/library/hc25t012.aspx)：

```
CString thestring(L"13.37");
double d = _wtof(thestring). 
```

...或同时支持 Unicode 和非 Unicode 版本...

```
CString thestring(_T("13.37"));
double d = _tstof(thestring). 
```

（`_tstof()`是一个宏，根据是否`atof()`定义扩展）`_wtof()``_UNICODE`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-30T02:40:14.097

您*可以*使用`std::stringstream`. 唯一的要求是运营商`>>`和`<<`被执行。字符串流可以在`<sstream>`头文件中找到。

```
std::stringstream converter;
converter << myString;
converter >> myDouble; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T04:16:38.447

使用 boost lexical_cast 库，你可以

```
#include <boost/lexical_cast.hpp>
using namespace boost;

...

double d = lexical_cast<double>(thestring); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T16:45:14.440

[strtod](http://msdn.microsoft.com/en-us/library/kxsfc1ab(VS.80).aspx "MDSN")（或[wcstod](http://msdn.microsoft.com/en-us/library/kxsfc1ab(VS.80).aspx "MDSN")）会将字符串转换为双精度值。

（需要`<stdlib.h>`或`<wchar.h>`）

# c# - 处理多个文件的最简单的方法是什么

> ID：916794
> 
> 赞同：0
> 
> 时间：2009-05-27T16:43:10.573
> 
> 标签：c#, command-line, batch-file

我试图通过将多个文件拖到 .exe 上来启动程序，然后让 exe 根据程序本身的规则和逻辑将文件发送到不同的文件夹。

我遇到的问题是我通过控制台应用程序执行此操作，一次可以向 exe 发送多少信息是有限制的。

> 在运行 Microsoft Windows XP 或更高版本的计算机上，您可以在命令提示符处使用的最大字符串长度为 8191 个字符。在运行 Microsoft Windows 2000 或 Windows NT 4.0 的计算机上，可以在命令提示符处使用的字符串的最大长度为 2047 个字符。

解决这个问题的最简约的方法是什么？如果可能的话，我想避免让程序一直在后台运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T16:49:46.457

除了将文件拖到“.exe”之外，您还可以创建一个“热文件夹”来将文件放入其中。您需要编写应用程序来监视此文件夹（使用类似[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)的东西）并处理传入的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-15T00:13:54.310

有一种方法可以编写一个使用 FileSystemWatchter 类监视特定文件夹的 .net 程序。我写了[一些代码的例子来](http://www.xmlconverters.com/tutorials/edi-dotnet-watcher-service.html)调用我们公司的产品，但是你可以使用骨架来做你想做的事。

这个想法是您指向一个文件夹并订阅该文件夹上的某些事件（文件重命名、添加、删除等），以便在这些事件发生时触发您的代码。在这两者之间，您的程序只是等待。

然后你可以让那个文件夹成为你桌面上的一个文件夹，当你把东西放进去时，事情“神奇地”发生了。

网站上还提供了[Visual Studio 2005 解决方案](http://www.xmlconverters.com/tutorials/edi-watcher-dotnet.zip)。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T21:41:22.137

它不是 C#，但是当您右键单击文件或选择一组文件（任何地方，不仅限于您可以看到您的可执行文件），因为此 API*可能*不会将您限制为命令行参数长度限制。

那里。流畅，没有后台进程。唯一的缺点是您必须将其编写为 COM 组件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T16:46:33.140

您可以将“数据”写入文件并将文件作为参数吗？

# ruby - "k.send :hello" - 如果 k 是“接收者”，谁是发送者？

> ID：916795
> 
> 赞同：8
> 
> 时间：2009-05-27T16:43:23.227
> 
> 标签：ruby, terminology

在下面的例子中，如果k 实际上是接收者，为什么我们说“k.send :hello”而不是“k.receive :hello” [？](https://stackoverflow.com/questions/916572/in-ruby-what-does-the-receiver-refer-to)

*听起来*k是发送者而不是接收者。

当我们说“k.send :hello”时，如果不是 k，谁在发送？

（你和我一样困惑吗？）

```
class Klass
  def hello
    "Hello!"
  end
end
k = Klass.new
k.send :hello   #=> "Hello"
k.hello         #=> "Hello" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T16:46:37.400

在 Smalltalk 中，一切都是对象。“发送者”是消息来源范围的所有者（即“this”或“self”指针）的对象。

和以前一样，Ruby 继承了这个概念。用不太抽象的术语来说，如果我给你寄一封信，我是“发件人”（它来自我的办公室），而你是“收件人”（前面的地址是你的）。所以我会写 foo.send myLetter: 你，foo，收到我的信。发件人是隐含的，是执行“发布”的代码的所有者。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T18:30:51.277

包含此代码的任何对象都在发送消息 - 可能是 main。让我们用更明确的对象和正常的消息传递来看看它。

```
class Person
  attr_accessor :first_name, :last_name
  def initialize(first_name, last_name)
    @first_name, @last_name = first_name, last_name
  end
  def marry(other)
    self.last_name = other.last_name
  end
end

bob = Person.new('Bob', 'Smith')
patty = Person.new('Patricia', 'Johnson')

patty.marry bob 
```

在这段代码的最后一行，main 是发送`marry`给 patty，而 patty 依次发送自己`last_name=`和发送 bob `last_name`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T18:45:44.680

我可以看到您在哪里感到困惑，但问题主要是语义上的。您的论点是该`send`方法确实应该是`receive`，因为`k`正在*接收*消息（即`k.receive :hello`）。用简单的英语，你读`k.send :hello`作“k发送消息'hello'（给谁？）”，而不是“k发送消息'hello'”。

*可以*将方法重命名为“receive”，但这也有点用词不当，因为`k`可能*不会*收到消息——`k`可能不响应消息，`k`可能选择忽略它，或者`k`可能选择将其传递给另一个对象。在 Ruby（以及影响 Ruby 的 Smalltalk）中，方法更像是做某事的*请求*，而不是做某事的*命令*。

# emacs - Emacs 全局设置键到 C-TAB

> ID：916797
> 
> 赞同：40
> 
> 时间：2009-05-27T16:43:52.507
> 
> 标签：emacs, key-bindings

我正在尝试在 Emacs 中将键绑定设置为 Ctrl+TAB。我使用了以下调用：

```
(global-set-key (read-kbd-macro "C-TAB") 'my-func) 
```

但是，每当我使用它时，我都会得到一个

```
<C-tab> is undefined 
```

错误信息。尝试将绑定设置为“C-tab”会导致错误消息。

如何设置绑定到 C-TAB？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-27T17:30:38.090

与其他人建议的不同，如果您想在其他版本的 Emacs 中使用相同的配置文件，最好使用`kbd`（或基本上相同的东西）；适用于 Emacs 和 XEmacs 的多个版本，其中键序列的内部表示不同。`read-kbd-macro``kbd`

```
(global-set-key (kbd "<C-tab>") 'my-func) 
```

使用的输入格式`read-kbd-macro`记录在以下文档字符串中`edmacro-mode`：

> *   特殊字 RET、SPC、TAB、DEL、LFD、ESC 和 NUL 表示特殊控制字符。单词必须大写。
>     
>     
> *   尖括号中的单词，例如<return>、<down> 或<f1>，代表一个功能键。（注意，在标准配置中，功能键<return> 和控制键RET 是同义词。）您可以在RET、SPC 等单词上使用尖括号，但这里不需要它们。

这写得有些遗憾；第一个项目符号中提到的 TAB 是 TAB 的 ASCII 字符，添加 Control 修饰符对它有一些荒谬的作用。当您按下 Control-Tab 时，Emacs 会看到它（通过您的窗口系统；它不会在文本终端中工作）`<tab>`与 Control 修饰符一样，您可以将其表示为`C-<tab>`或`<C-tab>`。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-05-27T17:02:57.290

```
(global-set-key [C-tab] 'my-func) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-27T17:29:12.120

那是因为你使用`read-kbd-macro`不当。当您看到绑定到键的内容时：

```
C-h k C-TAB 
```

Emacs 告诉你：

```
<C-tab> is undefined. 
```

您需要在调用`read-kbd-macro`.

```
(global-set-key (read-kbd-macro "<C-tab>") 'my-func) 
```

而且，我不知道如何生成`<C-TAB>`，但它与`<C-tab>`.

```
(equal (kbd "<C-TAB>") (kbd "<C-tab>"))
->
nil 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-28T07:12:31.320

请注意，您也可以`global-set-key`交互调用。然后，您可以看到正确的绑定命令`repeat-complex-command`（另请参见[KeybindingGuide](http://www.emacswiki.org/emacs/KeybindingGuide)）：

1.  `M-x: global-set-key`
2.  键入您想要的组合键
3.  使用`C-x ESC ESC`( `repeat-complex-command`) 查看 apropiate 命令。在你的情况下，我得到：

    ```
    (global-set-key (quote [C-tab]) (quote my-func)) 
    ```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-27T17:01:24.127

而不是 using `read-kbd-macro`，尝试使用更简单的语法？

```
;(global-set-key [(control tab)] 'my-func) 
```

也许更简单的语法会有所作为？

更多关于[read-kbd-macro](http://www.xemacs.org/Documentation/21.5/html/xemacs-faq_8.html#SEC281)和[global-set-key](http://www.gnu.org/software/emacs/manual/html_node/emacs/Rebinding.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-27T03:55:10.890

在 gnu emacs lisp 参考手册第 21.1 节“键序列”中，他们使用 \t 来表示制表键。

使用 Lisp 参考手册中显示的语法，我将使用以下命令：

`(global-set-key (kbd "C-\t") 'my-func)`

# .net - 使开发人员之间的 sql 数据库模式保持同步

> ID：916804
> 
> 赞同：4
> 
> 时间：2009-05-27T16:45:22.333
> 
> 标签：.net, sql, development-environment

我们是一个小型开发团队（大约 5 人），在不同地点开展开发项目。我们使用 SVN 作为代码仓库。
我们现在遇到的最大问题是我们的数据库模式在我们所有人之间完全不同步。我有以下选择： 1\. 处理“中央”数据库。这是一个坏主意，很可能不会发生 2\. 有一个“看门人”开发人员将保持数据库的版本，并让每个开发人员让他们及时了解更改。3\. 让每个开发人员将他们的更改检查到数据库更改脚本中。这很快就会变得一团糟。

很抱歉提到它是一个 .net c# 项目

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-03T13:41:04.510

MS 有点落后，因为它还没有标准的解决方案，但是您的#3 选项（更改脚本）是当今的方式。大多数其他现代主流语言现在以各种不同的风格使用这种形式。例如检查 Rails 迁移。

[这篇文章](https://stackoverflow.com/questions/313/net-migrations-engine)讨论了一堆可用的第 3 方 .NET 解决方案。根据我的经验，[migratordotnet](http://code.google.com/p/migratordotnet/)是一个很好的选择。有关该问题的更详细检查，请查看 Martin Fowler 关于该主题的[文章](http://martinfowler.com/articles/evodb.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T05:40:48.907

我们在我目前正在从事的项目中遇到了同样的问题。我们采用了[Tarantino](http://code.google.com/p/tarantino/wiki/DatabaseChangeManagement)作为解决方案，效果出奇的好。每个开发人员都在使用本地数据库。当开发人员需要进行架构更改时，他/她会创建一个脚本并将其签入。

Tarantino 会跟踪每个开发人员已在其本地数据库上运行的脚本并应用新脚本。因此，如果开发人员 A 进行更改并检查 SQL 脚本，则开发人员 B 将在他/她从源代码管理中获取最新文件时获得更改。当开发者 B 在本地运行 Tarantino 时，只会应用最新的脚本。

当然，大部分都可以手动完成。塔伦蒂诺让它变得更容易，但它并不完美。一个优点是它可以相当容易地集成到构建过程中。还可以创建用于维护数据库中数据的脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:57:42.787

几年前，我读到了 Paul Graham 的一篇关于“敏捷数据库开发”的文章。我在谷歌搜索时遇到了麻烦。似乎所有这些术语都太笼统了，我的记忆有点模糊，无法接近。

我确实遇到了[http://code.google.com/p/migratordotnet/](http://code.google.com/p/migratordotnet/)

它以 Rails ActiveRecord 迁移器（前面提到过）为模型，但针对 .net。我不是.net 程序员，但这听起来像是您正在寻找的那种东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T16:54:06.777

这是一个难题。我们通过修改用于生成模式的 sql（从 Enterprise Architect 自动生成）来处理它。我们遇到了巨大的问题，人们不会更新他们的数据库模式，因为他们觉得重新创建包含有效测试数据的数据集需要很长时间。

我们的解决方案是：

*   将 SQL 模式生成添加到 SVN
*   向 SVN 添加数据插入脚本
*   将模式/数据转储添加到 SVN

我们使用 Hudson 设置了一个自动数据库构建，用于检查修订版中的更改。它会自动重新创建模式，插入所有数据，导出转储文件，然后将转储文件提交给 SVN。

基本上，它归结为运行数据库导入大约需要 20 秒。一旦使数据库创建速度加快，开发人员就不会经常这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T18:53:30.107

为什么在同一个数据库服务器上工作又是一个坏主意？因为所有开发人员都在进行可能会伤害他人的更改？如果是这种情况，我会让一个人处理架构更改并使用 VPN 进入拥有数据库服务器的网络。我现在也在同一条船上，刚刚拿起一个 Cisco 路由器来处理我的 VPN 需求，而且价格便宜（< 100 美元）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T16:52:14.690

假设您没有使用 Team Edition Visual Studio 产品，那么我会选择选项 3。将 sql 脚本也置于源代码控制之下。

保持他们的本地数据库同步与要求他们使用最新的源代码没有什么不同。

如果您使用的是 Team 产品，请开始使用 Database 版本（随 Developer Edition 提供）在源代码控制下管理您的数据库

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T16:48:53.260

您是否考虑过使用 Visual Studio Team Database Edition？它允许您将整个源数据库放入源代码控制中，每个开发人员都可以处理他们自己的更改，然后一旦他们签入，其他开发人员可以轻松地将这些更改部署到他们自己的工作副本中。

不确定是否有一个可以与 MSSCCI 提供程序一起使用的 SVN 插件 - 但我想应该有一些东西可以解决这个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T16:59:16.173

我也在一个小团队工作，现在我们将 SQL 模式和数据插入脚本签入存储库，就像我们的代码一样。

您需要确保人们及时了解最新的“来源”。对于任何重大更改/修订，我们倾向于实践，无论如何我们会面并讨论它们，让每个人都了解正在修改的内容，并提供在发布之前查看任何数据库更新的机会。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T17:01:50.630

这个问题不再常见。每个团队都必须在某个时候提出这个问题。我已经完成了通用 DB 方法和单独的 DB 方法。团队总是回到公共数据库。它更容易维护，每个人都应该尽早同步，经常同步。不过，这并不否定在版本控制中保留模式更改和定义的需要。您需要一个可重复的过程来更新您的测试、登台和生产环境。但是，纯 SQL 迁移并不总是足够的，有时您需要使用本机对象来生成数据或做出决策。我见过的最好的系统（类似于我自己用 perl、php 和 Java 构建的系统，但有几点改进）是 Ruby on Rails 迁移系统。

# jquery - 在 ASP.Net MVC 中部分更新后绑定 jQuery DatePicker

> ID：916807
> 
> 赞同：0
> 
> 时间：2009-05-27T16:45:41.020
> 
> 标签：jquery, asp.net-mvc, jquery-ui-datepicker

在我看来，我正在使用 Ajax 调用来动态显示表单以将新条目添加到列表中。成功添加条目后，列表将再次显示。

但是，在这种形式中，我有一个文本字段，用户需要在其中输入日期。我需要做什么才能将 jquery UI DatePicker 动态绑定到该字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-09T18:14:34.300

按照这里： [jQuery live() failed with jQuery UI datepicker](https://stackoverflow.com/questions/2386718/jquery-live-failing-with-jquery-ui-datepicker)

我发现这更有帮助：

```
$('#textfield_id').live('click', function () {
            $(this).datepicker('destroy').datepicker().focus();
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T16:54:35.980

```
$('#textfield_id').live('ready', function(){ $(this).datepicker(); }) 
```

不确定 datepicker 和 textfield 的确切名称，但这应该适用于使用此 id 添加到页面的任何文本字段，无论是否通过 ajax。

# svn - 如何回滚到以前的修订版并继续前进

> ID：916808
> 
> 赞同：2
> 
> 时间：2009-05-27T16:45:47.010
> 
> 标签：svn, tortoisesvn

我对需要取出的项目进行了一些更改。最简单的方法是回滚到 3 天前的项目，然后从那里开始。

如何使该修订版成为 ToutoiseSVN 中项目的新负责人？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T16:51:05.083

要恢复到以前的修订版，您实际上并没有恢复到该修订版 - 您创建一个新的变更集，当提交时 - 将恢复您的源代码看起来像那个修订版。

您可以通过在日志中标记几个提交，右键单击并选择“revert changes from this revision”来做到这一点。

不用担心，在您提交该变更集之前，什么都不会真正发生。

# java - 将一位插入字节数组

> ID：916809
> 
> 赞同：4
> 
> 时间：2009-05-27T16:45:47.323
> 
> 标签：java, binary, bit-manipulation, byte

我正在尝试将单个位插入到字节数组中，这会将字节数组中的所有位向左移动。

假设我有一个 Java 字节数组，如下所示：

```
byte[] byteArray = new byte[2];
byteArray[0] = 0x11
byteArray[1] = 0x00 
```

在二进制中，这个字节数组表示为：

```
0001 0001 0000 0000 
```

现在我想在第三位位置插入一个零（丢失字节数组中的最后一位），结果是：

```
0000 1000 1000 0000 
```

在 Java 中有没有简单的方法来做到这一点？我知道 BigInteger 类可以将整个字节数组转换为二进制字符串（然后以这种方式插入并转换回来），但这似乎效率低下。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T17:19:18.537

棘手的位是将字符移动到您实际想要插入位的位置，因为您只想移动其中的一部分。这可以使用这样的函数来完成：

```
public static char shift(char in, char n, char v)
{
    char lowMask = (1 << n) - 1;
    char highMask = 0xFF ^ lowMask;

    return (in & lowMask) | ((in & highMask) << 1) | ((v&1) << n);
} 
```

将位插入第一个字符后，您还必须移动数组的其余部分。这可以通过简单地向右移动一位 (<< 1) 并将下一个字符的最低有效位 (LSB) 设置为最后一个字符的最高有效位 (MSB) 的状态来完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T16:50:42.087

您将要使用位掩码和位移位。这段 Java 文档可能对您有用：

[http://72.5.124.55/docs/books/tutorial/java/nutsandbolts/op3.html](http://72.5.124.55/docs/books/tutorial/java/nutsandbolts/op3.html)

准确地说，您可能想要将字节数组转换为整数，为最低位创建一个变量并将它们复制过来，位掩码（使用 AND 掩码）原始变量中的那些位，位移原始变量，然后位掩码（使用 OR 掩码）您保留的低位。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T17:06:09.530

查看[**BitSet**](http://java.sun.com/javase/6/docs/api/java/util/BitSet.html)类。它可以非常简单地完成您需要的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-25T03:45:24.020

这里的这个函数可以在单个字节上工作，如果你需要做更大的事情，你可以转换为 unicode CHAR：

```
static byte InsertBit(byte original, byte location)
        {
            byte highBits=original & ~(1<<location-1) ;
            byte lowBits = (1 << location - 1) & (original >> 1);

            return (1<< location) | highBits |lowBits;
        } 
```

# visual-studio-2008 - 无法在 VS 2008 Designer 中显示自定义控件 - .NETCF

> ID：916810
> 
> 赞同：1
> 
> 时间：2009-05-27T16:45:54.797
> 
> 标签：visual-studio-2008, compact-framework, rendering, user-controls, designer

我在 Visual Studio 的 .NETCF windows mobile 项目中显示自定义（继承）控件时遇到问题。该控件在设计器图面上显示为一个灰色框，其中写有类名。

作为一个测试用例，我有一个简单的控件定义为：

```
public class ucButton2 : Button
{
} 
```

应该就像一个按钮，但它给出了有趣的行为。

过去，我用设计时属性文件解决了这个问题或类似问题。所以我在文件 DTA.xmta 中包含了以下内容

```
<?xml version="1.0" encoding="utf-16"?>
<Classes xmlns="http://schemas.microsoft.com/VisualStudio/2004/03/SmartDevices/XMTA.xsd">
  <Class Name="MyProject.CustomControls.ucButton2">
    <Description>Testbutton</Description>
    <DesktopCompatible>true</DesktopCompatible>
  </Class>
</Classes> 
```

现在事情变得非常奇怪——我开始在不相关的类型化数据集文件中收到来自 genasm.exe 的编译错误。

遵循这篇文章最后评论的建议： [http ://www.simonrhart.com/2008/02/upgrading-your-solutions-to-visual.html](http://www.simonrhart.com/2008/02/upgrading-your-solutions-to-visual.html)

我将 DTA.xmta 更改为具有“嵌入式资源”的构建操作

现在应用程序编译了，但没有任何改变——设计器界面仍然只显示一个带有类名的空框。

我已经关闭并重新打开了 Visual Studio，以确保不会发生奇怪的缓存——同样的行为。

就像我说的，过去 xmta 文件已经解决了这类问题。但这次没有。但同时，在过去，添加 xmta 文件并不会导致 genasm.exe 在编译时出错。在我的另一个项目中，我的 xmta 文件的构建操作为“无”，而不是“嵌入式资源”。

在运行时，一切正常。这纯粹是一个设计时问题。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-06-16T13:34:16.390

我会说您将 DesktopCompatible(true) 作为自定义属性添加到控件中。见：[这篇文章](http://blogs.msdn.com/b/xinyan/archive/2005/10/26/485306.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-13T23:48:58.973

这是因为智能设备控件设计器不支持视觉继承——或者我应该说它没有丰富的显示。无论是代码缺陷还是设计，它都不像桌面 .NET 控件设计器那样工作。有时它会显示它，有时它不会。

但是您的自定义控件代码仍然可以工作，只是并不总是按预期显示。

# java - 如何让 jcifs 与 apache 轴很好地配合使用

> ID：916820
> 
> 赞同：2
> 
> 时间：2009-05-27T16:47:16.463
> 
> 标签：java, axis2, ntlm

我需要将 Apache Axis 1.4 连接到使用 NTLM 身份验证来限制对其操作的访问的 Web 服务。我期待使用 Samba Jcifs 来处理 NTLM 握手。

我发现

[http://hc.apache.org/httpcomponents-client/ntlm.html](http://hc.apache.org/httpcomponents-client/ntlm.html)

这为我提供了如何将 HttpClient 4.0 与 jcifs 连接起来的绝佳指导。

麻烦的是，Axis 想使用 Http Client 3.0 并且这两个 api 看起来很不一样。

我可以看到两种可能性

1.  为 Axis 编写一个对象，让它插入 HttpClient 4。
2.  弄清楚如何将 HttpClient 3.0 与 Samba Jcifs 连接起来。

第 1 号看起来很重要，但可能第 2 号。我在网上找不到任何令人鼓舞的消息来描述如何做到这一点。

我的问题是：有没有人成功地将 samba jcifs 与 HttpClient 3.0 连接起来？有没有人已经创建了一个与 HttpClient 4 一起使用的 Axis HttpSender 对象？

有没有我没有考虑过的更好的选择？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-09-04T14:52:08.420

Finally have a solution to this.

### The problem

Apache Axis uses Apache `HTTPClient` which provides its own NTLM implementation.
However this implementation is incomplete; it only supports the primitive LM authentication.
The system I need to connect to insists upon the more recent NTLM authentication.

Therefore my Webservice was failing to authenticate when using the Apache HTTP Client with NTLM.

This actually then enters an infinite loop as the `HTTPClient` will never stop trying and failing to authenticate.

### The solution

jcifs fully supports all 3 versions of the NTLM handshake.
I have copy-and-pasted `org.apache.commons.httpclient.auth.NTLM` into my own class (it is declared as 'final' in order to defeat inheritance)

I have then overwritten the method

```
public String getType3Message(
        String user, String password, String host, String domain,
        byte[] nonce) throws AuthenticationException 
```

to construct an instance of `jcifs.ntlmssp.Type3Message` and use this object to return a `Type3Message` that has the NTML authentication correctly generated.

I then needed to create my own instance of `org.apache.commons.httpclient.auth.AuthScheme` to make use of this new NTLM implementation. call `org.apache.commons.httpclient.auth.AuthPolicy.registerAuthScheme(AuthPolicy.NTLM, MyNewAuthScheme.class)`

start up my WS endpoint stub.

And it works !!!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-13T12:23:22.313

回应谢尔盖的评论......

我的解决方案中有两个类别。像这样的授权方案

```
 import java.io.IOException;

import jcifs.ntlmssp.Type1Message;
import jcifs.ntlmssp.Type2Message;
import jcifs.ntlmssp.Type3Message;

import org.apache.commons.codec.binary.Base64;
import org.apache.commons.httpclient.Credentials;
import org.apache.commons.httpclient.HttpMethod;
import org.apache.commons.httpclient.NTCredentials;
import org.apache.commons.httpclient.auth.AuthChallengeParser;
import org.apache.commons.httpclient.auth.AuthScheme;
import org.apache.commons.httpclient.auth.AuthenticationException;
import org.apache.commons.httpclient.auth.InvalidCredentialsException;
import org.apache.commons.httpclient.auth.MalformedChallengeException;
import org.apache.commons.httpclient.auth.NTLMScheme;
import org.apache.commons.httpclient.util.EncodingUtil;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

/**
 * AuthScheme that delegates the work of reading and writing NTLM messages to
 * the JCIFS implementation
 * 
 * directly inspired by `org.apache.commons.httpclient.auth.NTLMScheme`
 * 
 *
 * This software is based upon voluntary contributions made by many
 * individuals on behalf of the Apache Software Foundation.  For more
 * information on the Apache Software Foundation, please see
 * .
 *
 */
public class JcifsNtlmScheme implements AuthScheme
{
    /** Log object for this class. */
    private static final Log LOG = LogFactory.getLog(NTLMScheme.class);

    /** NTLM challenge string. */
    private String ntlmchallenge = null;

    private static final int UNINITIATED = 0;
    private static final int INITIATED = 1;
    private static final int TYPE1_MSG_GENERATED = 2;
    private static final int TYPE2_MSG_RECEIVED = 3;
    private static final int TYPE3_MSG_GENERATED = 4;
    private static final int FAILED = Integer.MAX_VALUE;

    /** Authentication process state */
    private int state;

    /**
     * Default constructor for the NTLM authentication scheme.
     * 
     * @since 3.0
     */
    public JcifsNtlmScheme()
    {
        super();
        this.state = UNINITIATED;
    }

    /**
     * Constructor for the NTLM authentication scheme.
     * 
     * @param challenge
     *            The authentication challenge
     * 
     * @throws MalformedChallengeException
     *             is thrown if the authentication challenge is malformed
     */
    public JcifsNtlmScheme(final String challenge)
            throws MalformedChallengeException
    {
        super();
        processChallenge(challenge);
    }

    /**
     * Processes the NTLM challenge.
     * 
     * @param challenge
     *            the challenge string
     * 
     * @throws MalformedChallengeException
     *             is thrown if the authentication challenge is malformed
     * 
     * @since 3.0
     */
    public void processChallenge(final String challenge)
            throws MalformedChallengeException
    {
        String s = AuthChallengeParser.extractScheme(challenge);
        if (!s.equalsIgnoreCase(getSchemeName()))
        {
            throw new MalformedChallengeException("Invalid NTLM challenge: "
                    + challenge);
        }
        int i = challenge.indexOf(' ');
        if (i != -1)
        {
            s = challenge.substring(i, challenge.length());
            this.ntlmchallenge = s.trim();
            this.state = TYPE2_MSG_RECEIVED;
        }
        else
        {
            this.ntlmchallenge = "";
            if (this.state == UNINITIATED)
            {
                this.state = INITIATED;
            }
            else
            {
                this.state = FAILED;
            }
        }
    }

    /**
     * Tests if the NTLM authentication process has been completed.
     * 
     * @return true if Basic authorization has been processed,
     *         false otherwise.
     * 
     * @since 3.0
     */
    public boolean isComplete()
    {
        return this.state == TYPE3_MSG_GENERATED || this.state == FAILED;
    }

    /**
     * Returns textual designation of the NTLM authentication scheme.
     * 
     * @return `ntlm`
     */
    public String getSchemeName()
    {
        return "ntlm";
    }

    /**
     * The concept of an authentication realm is not supported by the NTLM
     * authentication scheme. Always returns `null`.
     * 
     * @return `null`
     */
    public String getRealm()
    {
        return null;
    }

    /**
     * Unsupported.
     */
    public String getID()
    {
        throw new UnsupportedOperationException();
    }

    /**
     * Returns the authentication parameter with the given name, if available.
     * 
     * 

     * There are no valid parameters for NTLM authentication so this method
     * always returns null.
     * 

     * 
     * @param name
     *            The name of the parameter to be returned
     * 
     * @return the parameter with the given name
     */
    public String getParameter(String name)
    {
        if (name == null)
        {
            throw new IllegalArgumentException("Parameter name may not be null");
        }
        return null;
    }

    /**
     * Returns true. NTLM authentication scheme is connection based.
     * 
     * @return true.
     * 
     * @since 3.0
     */
    public boolean isConnectionBased()
    {
        return true;
    }

    /**
     * Unsupported.
     */
    public static String authenticate(
            final NTCredentials credentials, final String challenge)
            throws AuthenticationException
    {
        throw new UnsupportedOperationException();
    }

    /**
     * Unsupported.
     */
    public static String authenticate(
            final NTCredentials credentials, final String challenge,
            String charset) throws AuthenticationException
    {
        throw new UnsupportedOperationException();
    }

    /**
     * Unsupported.
     */
    public String authenticate(
            Credentials credentials, String method, String uri)
            throws AuthenticationException
    {
        throw new UnsupportedOperationException();

    }

    /**
     * Produces NTLM authorization string for the given set of
     * {@link Credentials}.
     * 
     * @param credentials
     *            The set of credentials to be used for athentication
     * @param method
     *            The method being authenticated
     * 
     * @throws InvalidCredentialsException
     *             if authentication credentials are not valid or not applicable
     *             for this authentication scheme
     * @throws AuthenticationException
     *             if authorization string cannot be generated due to an
     *             authentication failure
     * 
     * @return an NTLM authorization string
     * 
     * @since 3.0
     */
    public String authenticate(Credentials credentials, HttpMethod method)
            throws AuthenticationException
    {
        LOG.trace("enter NTLMScheme.authenticate(Credentials, HttpMethod)");

        if (this.state == UNINITIATED)
        {
            throw new IllegalStateException(
                    "NTLM authentication process has not been initiated");
        }

        NTCredentials ntcredentials = null;
        try
        {
            ntcredentials = (NTCredentials) credentials;
        }
        catch (ClassCastException e)
        {
            throw new InvalidCredentialsException(
                    "Credentials cannot be used for NTLM authentication: "
                            + credentials.getClass().getName());
        }
        byte[] msgBytes = null;
        String response = null;
        if (this.state == INITIATED)
        {
            Type1Message msg = new Type1Message();
            // @see http://davenport.sourceforge.net/ntlm.html#theType1Message
            // dont' support Unicode
            // negotiate OEM
            // request authentication realm in Type2 response
            // not signed
            // not encrypted
            // not authenticated
            // no lan manager key
            // negotiate NTLM
            msg.setFlags(0x5206);
            msg.setSuppliedWorkstation(ntcredentials.getHost());
            msg.setSuppliedDomain(ntcredentials.getDomain());
            msgBytes = msg.toByteArray();
            this.state = TYPE1_MSG_GENERATED;
        }
        else if (this.state == TYPE2_MSG_RECEIVED)
        {
            byte[] msg2Bytes =
                    Base64.decodeBase64(EncodingUtil.getBytes(
                            this.ntlmchallenge,
                            method.getParams().getCredentialCharset()));
            try
            {
                Type2Message msg2 = new Type2Message(msg2Bytes);
                Type3Message msg3 =
                        new Type3Message(msg2, ntcredentials.getPassword(),
                                ntcredentials.getDomain(), ntcredentials
                                        .getUserName(), ntcredentials.getHost());
                msgBytes = msg3.toByteArray();
            }
            catch (IOException ex)
            {
                throw new AuthenticationException(
                        "unable to parse Type2Message", ex);
            }
            this.state = TYPE3_MSG_GENERATED;
        }
        else
        {
            throw new RuntimeException("failed to authenticate");
        }
        response = EncodingUtil.getAsciiString(Base64.encodeBase64(msgBytes));
        return "NTLM " + response;
    }
} 
```

还有一个注册授权方案的类，像这样

```
 import org.apache.commons.httpclient.Credentials;
import org.apache.commons.httpclient.NTCredentials;
import org.apache.commons.httpclient.auth.AuthPolicy;
import org.apache.commons.httpclient.auth.AuthScheme;
import org.apache.commons.httpclient.auth.CredentialsNotAvailableException;
import org.apache.commons.httpclient.auth.CredentialsProvider;
import org.apache.commons.httpclient.params.DefaultHttpParams;
import org.apache.commons.httpclient.params.DefaultHttpParamsFactory;
import org.apache.commons.httpclient.params.HttpParams;

/**
 * registers NTLM authentication for apache axis
 * 
 */
public class NtlmJcifsCredentials
{
    public static void register(String password)
    {
        final String username = System.getProperty("user.name");
        final String computername = System.getenv("COMPUTERNAME");
        final String userDomain = System.getenv("USERDOMAIN");
        register(username, password, computername, userDomain);
    }
    public static void register(String username, String password, String userDomain)
    {
        final String computername = System.getenv("COMPUTERNAME");
        register(username, password, computername, userDomain);
    }

    public static void register(
            String username, String password, String computername, String domain)
    {
        final NTCredentials ntCred =
                new NTCredentials(username, password, computername, domain);

        final CredentialsProvider ntlmCredProvider = new CredentialsProvider()
        {
            public Credentials getCredentials(
                    AuthScheme scheme, String host, int port, boolean proxy)
                    throws CredentialsNotAvailableException
            {
                return ntCred;
            }
        };
        final DefaultHttpParamsFactory paramFact =
                new DefaultHttpParamsFactory()
                {
                    @Override
                    protected HttpParams createParams()
                    {
                        HttpParams htp = super.createParams();
                        htp.setParameter(
                                CredentialsProvider.PROVIDER,
                                ntlmCredProvider);
                        return htp;
                    }
                };
        DefaultHttpParams.setHttpParamsFactory(paramFact);

        // we want all our jcifs encoding to be ascii
        jcifs.Config.setProperty("jcifs.encoding", "ASCII");

        // our jcifs implemented NTLM is required for MDW's authentication
        AuthPolicy.registerAuthScheme(AuthPolicy.NTLM, JcifsNtlmScheme.class);
    }
} 
```

在运行时我打电话

```
 NtlmJcifsCredentials.register(username, password, domain) 
```

我构建了我的端点存根，它就可以工作。作为一个有益的副作用，如果无法通过身份验证，这将简单地抛出一个异常 - 默认 Apache Commons 类将继续尝试无限连接 - 在 NTLM 的情况下，这很容易导致您的帐户被锁定在 Windows 之外。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-05T21:36:40.803

非常感谢本，干得好。对于我的解决方案，我需要根据您的课程进行 2 项改进。

1) **类 JcifsNtlmScheme**

jcifs 中的接口发生了变化（我使用的是 1.3.14 版本）。NTLM 标志是必需的，我不太确定，但 0x82 对我有用。

```
int flags = Type3Message.NTLMSSP_NEGOTIATE_OEM | Type3Message.NTLMSSP_NEGOTIATE_LM_KEY;

Type3Message msg3 =
        new Type3Message(msg2, ntcredentials.getPassword(),
        ntcredentials.getDomain(), ntcredentials.getUserName(), ntcredentials.getHost(), flags); 
```

2)**类 NtlmJcifsCredentials**

```
 DefaultHttpParams.setHttpParamsFactory(paramFact); 
```

这适用于第一次连接。这似乎是一个全局设置。它可能不是真正的线程安全的。我需要基于连接的凭据。所以我删除了这个类并在创建 web 服务存根后直接插入了内置的 Authenticator：

```
jcifs.Config.setProperty("jcifs.encoding", "ASCII");
AuthPolicy.registerAuthScheme(AuthPolicy.NTLM, JcifsNtlmScheme.class);

Authenticator authenticator = new Authenticator();
List<String> authScheme = new ArrayList<String>();
authScheme.add(Authenticator.NTLM);
authScheme.add(Authenticator.BASIC);
authenticator.setAuthSchemes(authScheme);
authenticator.setUsername(myusername);
authenticator.setPassword(mypassword);
authenticator.setHost(servername);
authenticator.setDomain(domain);        
exService._getServiceClient().getOptions().setProperty(HTTPConstants.AUTHENTICATE, authenticator);       
exService._getServiceClient().getOptions().setProperty(HTTPConstants.CHUNKED, Boolean.FALSE);
exService._getServiceClient().getOptions().setProperty(HTTPConstants.REUSE_HTTP_CLIENT, Boolean.TRUE); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-09T17:40:19.963

我已经让它工作了，但我还没有在 HTTP 中实现代理服务器支持。 [http://www.magsoft.nl/share/Axis2%20patch.zip](http://www.magsoft.nl/share/Axis2%20patch.zip) 我使用的所有 jar 都在项目 lib 目录中。有一些类路径要求。首先，Axis2 HTTPClient4 patch.jar 必须位于轴 jar 之上。此外，commons-httpclient-3.1.jar 需要仍在类路径中，但在 httpclient-4 jar 之后。

这是我实现客户端的方式：

```
 Scheme http = new Scheme("http", PlainSocketFactory.getSocketFactory(), 80);
SchemeRegistry sr = new SchemeRegistry();
sr.register(http);
HttpParams httpParms = new BasicHttpParams();
ClientConnectionManager connManager = new ThreadSafeClientConnManager(httpParms, sr);
DefaultHttpClient httpclient = new DefaultHttpClient(connManager, httpParms);
httpclient.getAuthSchemes().register(HttpTransportProperties.Authenticator.NTLM, new NTLMSchemeFactory());
httpclient.getCredentialsProvider().setCredentials(new AuthScope(host, -1), new NTCredentials(user, pass, host, domain));

sps = new SharepointServiceStub(addr.toString());

List authScheme = new ArrayList();
authScheme.add(HttpTransportProperties.Authenticator.NTLM);
HttpTransportProperties.Authenticator auth = new HttpTransportProperties.Authenticator();
auth.setHost(host);
auth.setDomain(domain);
auth.setUsername(user);
auth.setPassword(pass);
auth.setAuthSchemes(authScheme);
Options options = sps._getServiceClient().getOptions();
options.setProperty(org.apache.axis2.transport.http.HTTPConstants.REUSE_HTTP_CLIENT, true);
options.setProperty(org.apache.axis2.transport.http.HTTPConstants.CACHED_HTTP_CLIENT, httpclient);
options.setProperty(org.apache.axis2.transport.http.HTTPConstants.AUTHENTICATE, auth);
options.setProperty(org.apache.axis2.transport.http.HTTPConstants.CHUNKED, Boolean.TRUE);
options.setProperty(org.apache.axis2.transport.http.HTTPConstants.CONNECTION_TIMEOUT, 900000); // 15 minutes
options.setProperty(org.apache.axis2.transport.http.HTTPConstants.SO_TIMEOUT, 180000); // 3 minutes 
```

但要使其工作，您将需要以下树类：NTLMSchemeFactory.java

```
 package ...;

import org.apache.http.auth.AuthScheme;
import org.apache.http.auth.AuthSchemeFactory;
import org.apache.http.impl.auth.NTLMScheme;
import org.apache.http.params.HttpParams;

public class NTLMSchemeFactory implements AuthSchemeFactory
{

    public NTLMSchemeFactory()
    {
    }

    public AuthScheme newInstance(final HttpParams params)
    {
        return new NTLMScheme(new JCIFSEngine());
    }

} 
```

JCIFSScheme.java

```
 package ...;

import org.apache.http.impl.auth.NTLMScheme;

public class JCIFSScheme extends NTLMScheme
{
    public JCIFSScheme()
    {
        super(new JCIFSEngine());
    }
} 
```

JCIFSEngine.java

```
 package ...;

import java.io.IOException;

import jcifs.ntlmssp.Type1Message;
import jcifs.ntlmssp.Type2Message;
import jcifs.ntlmssp.Type3Message;
import jcifs.util.Base64;

import org.apache.http.impl.auth.NTLMEngine;
import org.apache.http.impl.auth.NTLMEngineException;

public class JCIFSEngine implements NTLMEngine
{
    public String generateType1Msg(String domain, String workstation) throws NTLMEngineException
    {

        Type1Message t1m = new Type1Message(Type1Message.getDefaultFlags(), domain, workstation);
        return Base64.encode(t1m.toByteArray());
    }

    public String generateType3Msg(String username, String password, String domain, String workstation, String challenge)
            throws NTLMEngineException
    {
        Type2Message t2m;
        try
        {
            t2m = new Type2Message(Base64.decode(challenge));
        } catch (IOException ex)
        {
            throw new NTLMEngineException("Invalid Type2 message", ex);
        }
        Type3Message t3m = new Type3Message(t2m, password, domain, username, workstation, 0);
        return Base64.encode(t3m.toByteArray());
    }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-28T11:20:23.383

这个[Axis2Patch.zip](http://www.magsoft.nl/share/Axis2%20patch.zip)是真正的救星。这就是我所做的：

使用内置 NTLMv2 的 httpclient4.1 beta1 编译 Axis2Patch。将其导入我的项目并同时导入 httpclient4.1beta1。

我改变了我的进口是这样的：

```
import org.apache.commons.httpclient.auth.AuthenticationException;
import org.apache.commons.httpclient.auth.NTLMScheme;
//import org.apache.commons.httpclient.NTCredentials;
//import org.apache.commons.httpclient.auth.AuthPolicy;

import org.apache.http.auth.AuthScope;
import org.apache.http.auth.NTCredentials;
import org.apache.http.auth.UsernamePasswordCredentials;
import org.apache.http.client.CredentialsProvider;
import org.apache.http.client.params.AuthPolicy; 
```

并且没有太多的代码更改它可以完美地工作。谢谢！

# git - 无法区分 Git 中两个单独分支中的文件

> ID：916822
> 
> 赞同：58
> 
> 时间：2009-05-27T16:47:30.440
> 
> 标签：git, unix, merge, diff

我在branchA中有FileA，在branchB中有FileB。

问题是我一次只能访问一个文件。我希望能够通过 FileMerge 或 meld 比较文件，因为它们是我为 Mac 找到的唯一 diffTools。

**如何通过融合/文件合并这两个文件来区分**？

* * *

[已解决]：**第一次开发的问题：** FileMerge 不允许标准输入

> Masi：您可以使用[opendiff 来允许 FileMerge](http://kerneltrap.org/index.php?q=mailarchive/git/2007/3/29/242485/thread)从标准输入中获取文件。所以接下来的问题就是如何让git的diff工具使用opendiff。

* * *

**第二个开发的问题：**让 Git 的 diff 工具在 Mac 中使用 opendiff

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-05-27T19:22:48.910

您可以使用“ [git mergetool](http://www.kernel.org/pub/software/scm/git/docs/git-mergetool.html "git-mergetool - 运行合并冲突解决工具来解决合并冲突") ”进行合并，并在现代 git（即 1.6.3 及更高版本）中使用“ [git difftool](http://www.kernel.org/pub/software/scm/git/docs/git-difftool.html "git-difftool - 使用常见的差异工具显示更改") ”进行图形工具的比较。当然，您必须先配置它们，但它们会进行一些自动检测（当然，有一些硬编码的偏好），如果我没记错的话，opendiff 支持是内置的。

然后当然你可以像使用普通的“git diff”一样使用你的图形工具（opendiff / FileMerge），例如

```
prompt> git difftool somebranch:UNREADME otherbranch:README 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-05-27T17:02:33.140

git 支持将分支名称作为存储库路径的一部分。例如，如果您的存储库中有以下文件，则`README`仅 on `master`，并且`UNREADME`仅 on `branch`：

```
master:README

branch:UNREADME 
```

您可以通过 git 区分它们：

```
git diff branch:UNREADME master:README 
```

您可以使用以下命令将存储库工件获取到标准输出`git show`：

```
git show branch1:UNREADME 
```

因此，如果您的外部 diff 实用程序可以在 bash 提示符下获取 2 个文件，您可以通过以下方式对它们进行 diff：

```
diff-command <(git show branch1:UNREADME) <(git show master:README) 
```

bash 语法获取封闭命令的输出，在`<(...)`管道中运行它并将管道的文件路径放在命令行上。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-05-27T16:54:48.087

例如，如果您当前正在结帐到 branchA，则可以使用以下命令：

```
git diff branchB path/to/common/file/between/branches.txt 
```

然后，如果您想要更改的子集，则可以编辑差异，或者保持原样，并将`git apply`差异作为补丁。至于执行此操作的 GUI 工具，希望其他人会在那里提出建议。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T19:21:05.967

从[docs](http://git-scm.com/docs/git-config#FILES)中，您的 .git/config 文件中需要类似于以下内容的内容：

```
# Our diff algorithm
[diff]
    external = opendiff 
```

# iphone - 捆绑和文件访问

> ID：916824
> 
> 赞同：3
> 
> 时间：2009-05-27T16:47:39.363
> 
> 标签：iphone, xcode

我已经向我的项目添加了一系列文件夹（使用添加现有文件选项）。这导致文件夹内容在 Xcode 中显示为蓝色文件夹。

以下作品：

```
NSString *imageName = [NSString stringWithFormat:@"/File-03/images/image-%02d.jpg", imageIndex];

return [UIImage imageNamed:imageName]; 
```

但是，我想切换到使用`imageWithContentsOfFile`，这样图像就不会被缓存。

下面的代码返回`nil`图像：

```
return [UIImage imageWithContentsOfFile:[NSString stringWithFormat:@"/File-03/images/image-%02d.jpg", imageIndex]]; 
```

我也尝试`imageWithContentsOfFile`使用捆绑包访问，不行。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T17:03:25.743

要在 iPhone 上访问和存储文件，我建议阅读[此](http://tinyurl.com/pkeu9m).

[Erica Sadun](http://www.tuaw.com/2007/11/13/iphone-coding-use-nsbundle-and-avoid-hard-coded-paths/)还写了一篇关于在 app bundle 中访问文件的短文。

请注意，文件在 Xcode 中的组织方式并未显示它们将如何最终出现在应用程序包中。最好的方法是在 Finder 中选择应用程序包，然后按住 CTRL 键单击并选择**Show Package Content**。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T18:06:25.617

好的，我在代码中找到了一种方法来获得我需要的东西：

```
 NSString *dir = [NSString stringWithFormat:@"File-03/images", imageIndex];
  NSString *file = [NSString stringWithFormat:@"image-%02d", imageIndex]; 
  NSString *path = [[NSBundle mainBundle] pathForResource:file ofType:@"jpg" inDirectory:dir];

  return = [UIImage imageWithContentsOfFile:path]; 
```

诀窍是在捆绑调用中**inDirectory 。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T01:33:28.023

您的 imageWithContentsOfFile 代码的问题在于您假设它`/`是捆绑包的根目录，而它是 FS 的根目录！

因此，`pathForResource:ofType:inDirectory:`这可能是获得所需路径的最简单方法。

否则，您可以获得捆绑包的根目录并将其作为路径的前缀。

# tsql - 如何按在该上下文中保留的列名排序？

> ID：916825
> 
> 赞同：0
> 
> 时间：2009-05-27T16:48:13.153
> 
> 标签：tsql

我正在使用带有“item”和“desc”等列的旧数据库（用于描述）。

显然，尝试进行有序选择时会出现问题，例如：

```
SELECT item, desc FROM blah ORDER BY desc 
```

目的是对列“desc”进行升序排序，但是 SQL 服务器会感到困惑，因为 desc 也是 order by 的修饰符...如何转义字段名称以使其正常工作？我是否必须选择该列的第二个副本作为要在 order by 中使用的不同名称？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-27T16:50:33.257

用方括号将关键字 desc 括起来：

```
SELECT item, [desc] FROM blah ORDER BY [desc] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T16:53:18.027

选择 b.item,b.desc from blah as b order by b.desc asc

我错了。以上确实是不正确的。括号是要走的路。

# editor - VMS EDT - 如何选择文件的完整内容？

> ID：916827
> 
> 赞同：2
> 
> 时间：2009-05-27T16:48:24.993
> 
> 标签：editor, vms

我使用 VMS EDT 已经有一段时间了。我将编辑/替换文本文件中的大量行并将其保存为不同的版本。

据我所知，删除文本文件中字符的唯一方法是按删除键。这个过程很慢，一按，只删除一个字符。

因此我想知道，有没有办法在 vms 编辑中快速选择多行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T17:42:34.807

你是说EDT吗？如果是这样，我已经很长时间没有在 VMS 上工作了，而且我没有运行它的系统来确认以下内容。然而，我找到了一本旧手册，谷歌找到了一些看起来很有用的网站，包括[这个](http://www.atl.lmco.com/projects/csim/gui/edt/)。如果您使用的是 EDT，这是一种应该有效的方法：

*   在要清除的文件上启动 EDT。
*   如果您是在线路模式下启动的，请输入 c 进入键盘模式，然后
*   确保您位于文件的顶部（或您要开始删除的位置）。
*   通过点击小键盘“。”标记要删除的文本的开头。钥匙。
*   移动到要删除的文本的末尾。如果您想转到文件的末尾，请按 GOLD 键（如果您远程登录，可能是键盘“7”），然后按键盘“4”。
*   按键盘“6”剪切文件的内容。请注意，这会将选定的文本放入剪切/粘贴缓冲区。您可以使用 GOLD 将其粘贴到光标点，然后使用键盘“6”。

您还可以使用 D 命令从 EDT 的行模式中删除文本。语法是

```
Dn1:n2 
```

其中 n1 是要删除的第一行， n2 是要删除的最后一行。我不记得如果你这样做会发生什么

```
D1: 
```

并且找不到记录，但如果您想删除整个文件的内容并且不知道最后一行号，则可能值得一试。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-26T20:56:26.730

IMO - 你最好使用 VMS 编辑器**的**TPU 版本。它是 EDT 的“现代”;) 版本，因此它具有几乎相同的击键/键盘。

命令：'edit/tpu' 查看'help edit'，然后选择'/tpu'。

它具有更多功能，在您的情况下选择多行很容易。按“选择”键，移动光标，然后删除或复制。不太特别。

赎金惠誉

# .net - 与匿名客户端混淆服务和证书

> ID：916834
> 
> 赞同：0
> 
> 时间：2009-05-27T16:49:30.530
> 
> 标签：.net, wcf, web-services, certificate, security

我已经设置了一个通过 netTcpBinding 使用传输安全的 WCF 服务。用于服务安全的证书由我们为开发创建的 CA 签名。

有人可以解释我的匿名客户端在本地没有安装相同的 CA 的情况下可以连接并与服务通信的工作原理吗？我对证书相当陌生，并假设必须在本地安装 CA，客户端才能解密来自服务的数据。

服务和客户端都在 Windows 机器上，客户端是 Windows Forms .NET 3.5 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T18:24:08.543

好吧，等式有两个部分：

*   您可以拥有一个**服务器**证书，该服务用于向客户端验证自己的身份（以证明它确实是它声称的服务）
*   您可以拥有**客户端**证书，客户端需要向服务器证明其身份

你对哪个感兴趣？

通常，如果您有服务器/服务证书，客户端将“知道”服务器的公钥（它可以安装在客户端的证书存储中，例如通过安装程序或通过下载和安装），或者它会询问关于创建代理时服务器的证书并将服务器的公钥存储在本地客户端配置文件中以供以后使用。然后，此配置将再次与客户端上的应用程序一起安装。

如果客户端想要针对服务对自己进行身份验证，它肯定需要将其客户端证书本地安装在客户端计算机的证书存储中。

我建议检查一下[WCF 安全指南](http://wcfsecurity.codeplex.com/Wiki/View.aspx?title=How%20Tos)- 这是一个很好的资源，他们可以解释如何比我做得更好！

在每个人都在同一个域中的全 Windows 环境中，这似乎有点矫枉过正——为什么不直接使用 Windows 提供的内置凭据呢？我想那会容易得多。

马克

# forms - 在Delphi中使用Free而不是Release作为模态表单是否安全？

> ID：916843
> 
> 赞同：13
> 
> 时间：2009-05-27T16:50:43.833
> 
> 标签：forms, delphi, memory-management, modal-dialog

Delphi 在线帮助说 Release 应该用于从内存中删除表单。但是，在模态形式的许多示例中，我已经看到了这种结构：

```
MyForm := TMyForm.Create(nil);
try
  MyForm.ShowModal;
finally
  MyForm.Free;
end; 
```

Free 是破坏模态表单的安全方法吗？正如我在 ShowModal 的源代码中看到的那样，Application.HandleMessage 将被调用，直到 ModalResult 不为 0。这就是 Free 不能干扰挂起的 windows 消息的原因吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-27T18:06:22.513

是的，通话`Free`后使用是安全的`ShowModal`。

您需要使用的情况`Release`是当您处于事件处理程序（例如，`OnClick`）中间时，事件之后的进一步处理将不得不访问表单。在这种情况下，调用`Release`会发布一条消息，该消息在事件处理程序完成并且控制返回到消息泵 ( / )`CM_RELEASE`之前不会释放事件。 在事件处理程序完成并且控制使其备份堆栈之前不会返回，因此之后调用实际上是处理消息的相同位置。`ProcessMessages``Application.Run``ShowModal``Free``CM_RELEASE`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T17:27:07.910

这取决于。`Free`表单不会调用事件处理程序`Release`，并且任何可能已发布到表单并排队的消息都不会被处理。因此，虽然在许多甚至大多数情况下调用`Free`(or `FreeAndNil`) 都可以正常工作，但由于看似随机的原因，它可能会导致一些非常奇怪的行为。

我建议的替代方法是在 OnClose 事件中将 Action 设置为 caFree，如下所示：

```
procedure FormClose(Sender : TObject; Action : TCloseAction)
begin
  Action := caFree;
end; 
```

然后，您可以编写如下代码：

```
TMyForm.Create(nil).ShowModal; 
```

而且您不需要专门释放表单，因为它会在完成后自行释放。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T16:53:25.763

当然，您也可以使用 FreeAndNil 例程。FreeAndNil 例程将仅在对象尚未为 nil 时释放该对象，并在释放后将其设置为 nil。如果你直接在一个已经被释放的对象上调用 free，你会得到一个访问冲突。

```
MyForm := TMyForm.Create(nil); 
try 
  MyForm.ShowModal; 
finally 
  FreeAndNil(MyForm); 
end; 
```

# java - Mac OS X Java SDK 支持

> ID：916850
> 
> 赞同：0
> 
> 时间：2009-05-27T16:52:21.087
> 
> 标签：java, macos

谁能告诉我，或将我发送到一个页面，可以告诉我 Mac OS X 开箱即用支持的 Java 版本？我知道例如 10.5 默认安装了 Java 1.5。10.4呢？10.3？10.2？10.1？

我的应用程序需要是跨平台的，我需要弄清楚要使用什么 Java 版本来构建我的 Java 代码。这也将确定我可以支持哪些版本的 Mac OS X，并且我显然希望尽可能地支持。

我最初使用 Java 1.6 编译并尝试在我的测试机器上运行 - Mac OS X 10.4.11（当然它崩溃了）。所以看起来 Java 1.6 完全出局了，因为 10.4 根本无法支持它，甚至完全更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T16:54:22.937

请参阅[此文档](http://developer.apple.com/technotes/tn2002/tn2110.html)，特别是**Java 版本字符串**部分。我不认为 Mac OS X 版本和 Java 版本之间存在一对一的关系。

# sas - 如何将宏函数的结果分配给 SAS 中的宏变量？

> ID：916851
> 
> 赞同：2
> 
> 时间：2009-05-27T16:52:36.203
> 
> 标签：sas, sas-macro

我有一个创建时间戳的宏（附加到输出文件名）。但是，与其记住宏将值分配给哪个宏变量，我更愿意将宏变量分配给宏的结果（如果这还不够循环的话）。

```
%let tms= %tms(); 
```

这是当前的宏......

```
%macro tms ;
    %* Create a Timestamp ;
 %let tms_date= %sysfunc(date(),yymmdd10.) ;  %* Todays date ;
 %let tms_time= %sysfunc(time(),time.) ;      %* Current Time ;

    %* Format mmddyyhhmmss ;
 %let tms=_%scan(&tms_date,1)%scan(&tms_date,2)%scan(&tms_date,3)%scan(&tms_time,1,:)%scan(&tms_time,2,:)%scan(&tms_time,3,:) ;

%mend ; 
```

您如何引用它以使其发挥作用？另外，我会从宏中删除“%let tms=”吗？

此外，相同的引用是否适用于以下 ODS 分配语句？

```
ods Tagsets.excelxp file="&outname.&tms..xml" style= Styles.XLsansPrinter ; 
```

感谢您抽出宝贵的时间....

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T19:01:03.260

具有返回值的宏通常称为宏函数。在 mend 语句之前，如果您放置一个不带分号的表达式/值，它将将该值返回给调用者。如果返回值在 if-else 块中，则 ; 将是必要的。

基本上，您可以按照您的建议进行操作，并从宏内部删除 %let tms= 。是的，我确实相信它可以与 ods 分配声明一起使用。

```
%macro tms ;
    %* Create a Timestamp ;
 %let tms_date= %sysfunc(date(),yymmdd10.) ;  %* Todays date ;
 %let tms_time= %sysfunc(time(),time.) ;      %* Current Time ;

        %* Format mmddyyhhmmss ;
 _%scan(&tms_date,1)%scan(&tms_date,2)%scan(&tms_date,3)%scan(&tms_time,1,:)%scan(&tms_time,2,:)%scan(&tms_time,3,:) 
%mend;
%let tms=%tms;
%put **&tms**; 
```

* * *

作为另一个建议，您可以通过使用 compress 函数而不是 %scan 函数来稍微简化代码，如下所示

```
%sysfunc(compress(_&tms_date.&tms_time,"-:")); 
```

# c# - IComparable 的接口约束

> ID：916852
> 
> 赞同：11
> 
> 时间：2009-05-27T16:52:46.263
> 
> 标签：c#, .net, generics, interface, icomparable

当我想限制类型 T 具有可比性时，我应该使用：

```
where T : IComparable 
```

或者

```
where T : IComparable<T> 
```

如果＃2有意义，我无法理解。任何人都可以解释有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T17:03:39.080

IComparable 和 IComparable<> 之间的主要区别在于第一个是预泛型，因此允许您使用任何对象调用 compare 方法，而第二个强制它共享相同的类型：

```
IComparable - CompareTo(object other);
IComparable<T> - CompareTo(T other); 
```

如果您不打算使用任何类型可能无法实现现代通用解决方案的旧 .net 1.0 库，我会选择第二个选项。您将获得性能提升，因为您将避免拳击，并且比较不需要检查类型匹配，您还将获得以最前沿的方式做事的温暖感觉......

* * *

为了解决 Jeff 的非常好的和相关的观点，我认为最好对泛型施加尽可能少的约束来执行任务。由于您完全控制了泛型内的代码，因此您知道您是否正在使用任何需要基本 IComparable 类型的方法。因此，考虑到他的评论，我个人会遵循以下规则：

*   如果您不希望泛型使用*仅*实现 IComparable 的任何类型（即遗留 1.0 代码）并且您没有从泛型内部调用任何依赖于 IComparable 参数的方法，则仅使用 IComparable<> 约束。

*   如果您*使用*仅实现 IComparable 的类型，则仅使用该约束

*   如果您正在使用需要 IComparable 参数的方法，但不使用仅实现 IComparable 的类型，那么当您使用接受泛型类型的方法时，使用 Jeff 的答案中的两个约束将提高性能。

为了扩展第三条规则 - 让我们假设您正在编写的课程如下：

```
public class StrangeExample<T> where ... //to be decided
{
    public void SortArray(T[] input)
    {
         Array.Sort(input);
    }

    public bool AreEqual(T a, T b)
    {
        return a.CompareTo(b) == 0;
    }
} 
```

我们需要决定对其施加什么限制。SortArray 方法调用 Array.Sort，它需要传入的数组包含实现 IComparable 的对象。因此我们*必须*有一个 IComparable 约束：

```
public class StrangeExample<T> where T : IComparable 
```

现在该类将编译并正常工作，因为 T 数组对 Array.Sort 有效，并且接口中定义了有效的 .CompareTo 方法。但是，如果您确定不想将类与不实现 IComparable<> 接口的类型一起使用，则可以将约束扩展到：

```
public class StrangeExample<T> where T : IComparable, IComparable<T> 
```

这意味着当 AreEqual 被调用时，它将使用更快、更通用的 CompareTo 方法，您将看到性能优势，但代价是无法将它与旧的 .NET 1.0 类型一起使用。

另一方面，如果您没有 AreEqual 方法，那么 IComparable<> 约束没有任何优势，因此您不妨放弃它 - 无论如何您只是在使用 IComparable 实现。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T17:21:25.987

您可能需要这两个约束，如：

```
where T : IComparable, IComparable<T> 
```

这将使您的类型与`IComparable`接口的更多用户兼容。的通用版本将有助于避免在值类型时装箱，[`IComparable`](http://msdn.microsoft.com/en-us/library/system.icomparable.aspx)并允许接口方法的更强类型的实现。支持两者可确保无论其他对象要求哪个接口，您的对象都可以遵守并因此很好地互操作。[`IComparable<T>`](http://msdn.microsoft.com/en-us/library/4d7sx9hd.aspx)`T`

例如，[`Array.Sort`](http://msdn.microsoft.com/en-us/library/system.array.sort.aspx)并[`ArrayList.Sort`](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.sort.aspx)使用[`IComparable`](http://msdn.microsoft.com/en-us/library/system.icomparable.aspx)，而不是[`IComparable<T>`](http://msdn.microsoft.com/en-us/library/4d7sx9hd.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T17:02:37.773

`IComparable<T>`允许比较器是*强类型*的。

你可以有

```
public int CompareTo(MyType other)
{
    // logic
} 
```

反对

```
public int CompareTo(object other)
{
    if (other is MyType)
        // logic
} 
```

例如，下一个示例女巫实现了这两个接口：

```
public class MyType : IComparable<MyType>, IComparable
{
    public MyType(string name, int id)
    { Name = name; Id = id; }

    public string Name { get; set; }
    public int Id { get; set; }

    public int CompareTo(MyType other)
    {
        if (null == other)
            throw new ArgumentNullException("other");
        return (Id - other.Id > 0 ? 1 : 0);
    }

    public int CompareTo(object other)
    {
        if (null == other)
            throw new ArgumentNullException("other");
        if (other is MyType)
            return (Id - (other as MyType).Id > 0 ? 1 : 0);
        else
            throw new InvalidOperationException("Bad type");
    }
}

MyType t1 = new MyType("a", 1);
MyType t2 = new MyType("b", 2);
object someObj = new object();

// calls the strongly typed method: CompareTo(MyType other)
t1.CompareTo(t2);
// calls the *weakly* typed method: CompareTo(object other)
t1.CompareTo(someObj); 
```

如果`MyType`仅使用 实现`IComparable<MyType>`，则第二个`compareTo(someObj)`是编译时错误。*这是强类型泛型*的优点之一。

另一方面，框架中有一些方法需要非泛型`IComparable`like `Array.Sort`。在这些情况下，您应该考虑像本示例中那样实现这两个接口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T17:06:34.863

这是两个不同的接口。在 .NET 2.0 之前没有泛型，所以只有`IComparable`. .NET 2.0 出现了泛型，并且可以将`IComparable<T>`. 他们做的完全一样。基本上 IComparable 已经过时了，尽管大多数图书馆都承认这两者。

要使您的代码真正兼容，请同时实现两者，但要一个调用另一个，这样您就不必编写相同的代码两次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T17:05:44.960

我将使用第二个约束，因为这将允许您引用接口的强类型成员。如果您选择第一个选项，那么您将不得不强制转换以使用接口类型。

# ruby - 从原始范围之外的红宝石块返回

> ID：916855
> 
> 赞同：2
> 
> 时间：2009-05-27T16:53:09.650
> 
> 标签：ruby

我想做一些看起来像这样的东西：

```
def make_wrapped_block(&block)
  puts "take_block:before"
  func = lambda do
    puts "Before calling make_wrapped_block's passed block"
    block.call
    puts "After calling make_wrapped_block's passed block"
  end
  puts "take block:after"
  func
end

def make_block
  make_wrapped_block do
    puts "Before return"
    return :pi
    puts "After return"
  end
end

make_block.call 
```

..那里会有许多`make_block`方法生成具有类似初始化和清理的闭包`make_wrapped_block`。

因为传递给`make_wrapped_block`in的块`make_block`返回，这会导致 LocalJumpError：

```
[ cpm juno ~/tmp/local-jump ] ruby bad.rb
take_block:before
take block:after
Before calling make_wrapped_block's passed block
Before return
bad.rb:15:in `make_block': unexpected return (LocalJumpError)
        from bad.rb:5:in `call'
        from bad.rb:5:in `make_wrapped_block'
        from bad.rb:20:in `call'
        from bad.rb:20 
```

现在，我可以让这个想法使用稍微不同的语法：

```
def make_wrapped_block(block)
  puts "take_block:before"
  func = lambda do
    puts "Before calling make_wrapped_block's passed block"
    block.call
    puts "After calling make_wrapped_block's passed block"
  end
  puts "take block:after"
  func
end

def make_block
  make_wrapped_block(lambda {
    puts "Before return"
    return :pi
    puts "After return"
  })
end

make_block.call 
```

这是有效的，因为当您从使用创建的匿名函数返回时`lambda`，它会退出匿名函数，而使用`Proc.new`和匿名块会尝试从其定义的范围返回。您不能将它们传递并安全返回。

**是否有一种安全的方法可以从它们创建的范围之外的传递块返回？**
第二种方法效果很好，但语法比第一种版本难看。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T02:28:11.110

好吧，你可以抓住一个`LocalJumpError`：

```
def make_wrapped_block(&block)
  puts "take_block:before"
  func = lambda do
    puts "Before calling make_wrapped_block's passed block"
    begin
      block.call
    rescue LocalJumpError
      # allow return / break
    end
    puts "After calling make_wrapped_block's passed block"
  end
  puts "take block:after"
  func
end

#...

make_block.call 
```

但这有点难看。

如果你不介意让返回有点尴尬，你可以`throw`改用：

```
def make_wrapped_block(&block)
  puts "take_block:before"
  func = lambda do
    puts "Before calling make_wrapped_block's passed block"
    catch (:return) { block.call }
    puts "After calling make_wrapped_block's passed block"
  end
  puts "take block:after"
  func
end

def make_block
  make_wrapped_block do
    puts "Before throw"
    throw :return
    puts "After throw"
  end
end 
```

但是，如果这对于编写你的方法的人来说可能有点奇怪`make_block` ，除非是你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T03:03:27.047

Ruby 方法/块/闭包/lambda 非常不一致，而且很麻烦。[这里有一份关于特质](http://innig.net/software/ruby/closures-in-ruby.rb)的综合指南。

在您的示例中归结为`return`. `do...end`闭包不是真正的闭包（出于性能原因）。`return`因此，返回的不是`do...end`，而是周围的方法。但是，在 a`lambda`中，`return`退出的是`lambda`而不是封闭方法，这是预期的行为。

# c# - 通用 .Net 生产者/消费者

> ID：916863
> 
> 赞同：8
> 
> 时间：2009-05-27T16:54:37.260
> 
> 标签：c#, .net, multithreading, producer-consumer

我正在玩弄在 C# 中实现通用生产者/消费者对 + 处理队列的想法，以获得乐趣。这个想法是您可以创建实现适当 IProducer 和 IConsumer 接口（提供的默认实现）的对象，这些接口主要由委托组成，将它们传递给`QueueProcessor`类实例，告诉它您想要多少消费者，然后去。

但我对自己说：“我自己，这肯定以前做过。”

那么有谁知道 C# 中生产者/消费者模式的良好**通用***实现*（VB.Net 也可以）？我正在寻找的基本要求：

*   对生产和消费类型（输入、排队任务和输出类型，或它们的任何组合）使用泛型
*   允许您指定有多少消费者将在队列中工作
*   允许您将多个队列链接或链接到管道中（我知道多个消费者很棘手）
*   允许您实现自己的生产者和消费者
*   允许您将任何 IEnumerable 转换为生产者（如果我必须自己实现，可以，只要可能）
*   基于委托（您可以使用 lambda 语法进行基本的消费者或生产者工作来处理单个项目）

或者如果没有，是什么陷阱阻止了它，你对如何实现它有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T22:35:32.000

[Microsoft CCR](http://msdn.microsoft.com/en-us/library/bb648752.aspx)包含您需要的大部分内容。

[以下](http://www.lnbogen.com/2008/02/04/microsoft-ccr-clean-way-to-write-parallel-code-in-net/)是一些代码示例和使用说明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-19T22:20:16.400

[Marc Gravell 在这个答案](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net/530228#530228)中写了一个很好的例子阻塞队列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T17:03:39.470

你看过[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)吗？

# sql-server-2005 - 选择数据库 FILEGROWTH 作为百分比或固定大小

> ID：916870
> 
> 赞同：1
> 
> 时间：2009-05-27T16:55:49.270
> 
> 标签：sql-server-2005

有谁知道与 FILEGROWTH 设置相关的任何问题（性能或其他）作为 % 而不是固定大小？% 相对于固定增量有什么优势？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T17:00:31.130

使用百分比可能意味着自动增长。当您将 10% 添加到 100GB 数据库时，您将添加 10GB。如果这需要超过 30 秒（它很容易）并且您有一个 30 秒超时的调用者会导致回滚，那么如果您有一个重试循环，那么您最终会在很长一段时间内进行大量磁盘活动。我可能知道有人发生了这种情况的变体：P

一般来说，确保对自动增长非常小心——它们应该作为最后的手段，而不是作为主要的增长管理策略。对于任何重要的生产数据库，您应该通过确保在维护窗口期间有足够的空间来管理增长。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T17:00:42.037

我建议使用固定增量。在小型增长数据库上使用 % 会导致数据库更频繁地增长。在大型数据库上使用 % 也会导致过度增长。最好的办法是密切监视您的数据库并设置与您的使用情况相匹配的固定增长。

# java - 这个Java代码如何编译？

> ID：916871
> 
> 赞同：6
> 
> 时间：2009-05-27T16:55:50.267
> 
> 标签：java, puzzle

一位同事遇到了一些看起来像这样的代码，但无法理解它是如何编译的：

```
class FooClass {
  public static void bar(String arg) {
     System.out.println("arg = " + arg);
     http://www.google.com
     System.out.println("Done!");
  }
} 
```

基本上，在方法中间粘贴了一个随机 URL，但`javac`并不在意。

我们解决了，所以如果没有其他人发现，我会发布答案，但我认为发布它很有趣。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-27T16:58:44.113

“http:”被解释为一个标签。接下来是行尾注释。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T16:59:19.323

你有一个标签

```
http: 
```

随后发表评论

```
//www.google.com 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T16:59:03.943

简单的。该网站上的突出显示说明了原因。

http：是一个标签，如break http；

//www.google.com 是评论。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T16:59:13.660

**http：**是标签。 **//**开始评论。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T16:59:28.810

“http:”是标签，“//”后面的部分当然是注释

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T20:15:17.430

另一个带有两个 http:// 的示例

```
public class Main {
    {
        http://en.wikipedia.org/wiki/Hello_world_program
        System.out.print("Hello ");
    } {
        http://java.sun.com/docs/books/tutorial/getStarted/application/index.html
        System.out.println("World!");
    }

    public static void main(String... args) {
        new Main();
    }
} 
```

# wpf - 选定项触发器

> ID：916872
> 
> 赞同：1
> 
> 时间：2009-05-27T16:55:50.393
> 
> 标签：wpf, xaml, triggers, selecteditem

我可以在任何支持 SelectedItem 的控件中对 SelectedItem 属性使用触发器吗？

```
<Trigger
    Property="SelectedItem"
    Value="{x:NotNull}" >
</Trigger> 
```

我想要的是当 SelectedItem 为*Not* null 以触发触发器时。

肿瘤坏死因子

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T17:05:52.260

您可以在 SelectedItem 属性上使用触发器，但当该值不为空时，您不能（默认情况下）触发。

你有两个选择：

1.  改写您的触发器以在 null 上触发（使用 Value="{x:Null}"），然后让您的“默认”值成为您想要在值不为 null 时发生的情况
2.  编写一个 ValueConverter，当它传递的值不为 null 时返回 true。

[这个堆栈溢出帖子](https://stackoverflow.com/questions/356194/wpf-datatrigger-where-value-is-not-null)详细描述了这两个选项。

# .net - 将数据访问策略切换到项目中？

> ID：916873
> 
> 赞同：2
> 
> 时间：2009-05-27T16:55:53.840
> 
> 标签：.net, data-access-layer, manual, auto-generate

在一个项目中，我们使用可自动生成大量代码的可视化设计器实现了数据访问层 (DAL)（在我们的示例中：.NET 中的强类型 DataSet 和 DataSetTableAdapters）。

但是，使用源代码管理我发现在 DAL 中编辑和添加新内容很麻烦。我们已经开始通过手动编写 SQL 语句（在我们的例子中：ADO.NET SqlCommands 等）来编写新的数据访问，这对我来说似乎更易于编辑，尤其是通过源代码管理查看更改。

但我也担心混合数据访问的方法。你有什么建议？坚持使用自动生成方法，在需要更改时继续转换为“手动”SQL 语句，还是其他？

编辑：受到解决切换数据访问策略的一般问题的好答案的启发，我概括了问题的公式。

模型数据的处理不是非常面向对象的。我们使用 .NET DataTables 而不是自定义对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T17:16:03.393

是的，坚持你所拥有的，并在必要和方便的时候进行重构。我讨厌不同意其他答案并混淆事物，但是通过使用另一个数据访问框架，您可能会用一个系统头痛换另一个系统。使用您感到舒适的基础知识。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T19:35:44.703

直接使用“裸”ADO.NET 并在代码中手动完成所有 DAL 工作似乎需要付出很多努力。我肯定会推荐查看其他人（NHibernate、Subsonic 等）推荐的 OR-mapper。

如果您在 SQL Server 中使用后端并且您使用的是 .NET 3.0 或更高版本，您还可以查看 Linq2SQL（其死亡的谣言被大大夸大了）以获得更简单的场景（从数据库表到数据库层对象的 1:1 映射） ，或实体框架用于更高级的场景（大量表、域模型中的大量对象继承、复杂的映射场景）。

EF 最近受到了很多不好的批评，这只是部分合理，恕我直言，新版本 EF v4（将于今年或明年某个时候推出 .NET 4.0 和 VS 2010）看起来非常有希望。

马克

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T19:56:42.133

如果在转换为手动 ADO 或继续使用数据集+表适配器之间进行选择，我认为您最好还是使用数据集。通过使用它，您可以获得免费的 CRUD，从而减少了创建和维护没有任何价值的 sql 的时间。

顺便说一句，您提出问题的方式听起来也不像是要采用更加面向对象的方法，这可能是放弃数据集+表适配器方法的一个论据。

如果您要处理越来越复杂的业务逻辑，您可能还想对 OR-mapper + 纯对象域进行一些研究/原型设计。不过，它对 RAD 方法的效果较差。如果我是你，我会检查 Linq 2 sql（如果你有一个简单的模式/对象结构并且对对象和表之间的 1:1 映射感到满意）或 NHibernate。实体框架还不够成熟。下一个版本会更好，但仍然可能需要很长时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T16:57:25.473

如果您要完全重写您的 DAL，那么也许您应该研究像[Sprint.NET](http://www.springframework.net/)或[NHibernate](https://www.hibernate.org/343.html)这样的持久性框架。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T19:49:10.853

DAL 通常是任何应用程序中设计最过度的部分。保持简单并构建您现在需要的东西或合理预期很快需要的东西。与实际连接、读取和写入数据库的具体细节相比，SqlCommand、SqlDataReader 等仍然相对抽象。

也就是说，如果您只使用一种通用方法，您的代码将更具可读性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T17:01:48.507

...或来自[Rob Conery的](http://blog.wekeroad.com/)[SubSonic](http://subsonicproject.com/) :)

至少查看您可以在项目页面中找到的 3 个视频。

# java - JUnit 中的测试方法阻止电子邮件发送

> ID：916874
> 
> 赞同：1
> 
> 时间：2009-05-27T16:55:55.197
> 
> 标签：java, email, junit

我正在用 Java 开发并使用 JUnit 来测试我的一些方法。我的一些方法发送电子邮件。电子邮件实际上是由产生的单独线程发送的。问题是，每当我测试这些方法时，一切都很好，除了电子邮件没有实际发送。我已经通过整个堆栈跟踪执行，并且与发送电子邮件相关的每个方法都被正确调用和执行。所以我测试了 JUnit 之外的方法，并且电子邮件发送正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T16:58:17.173

电子邮件线程是后台（守护程序）线程吗？也许由于您的测试在发送电子邮件之前完成，该线程正在终止？

如果您在要发送电子邮件之前和之后直接登录，这些日志条目会出现吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T17:06:40.400

如果它是后台线程，它可能会在测试方法完成时被静默杀死。这不会显示在调试器中，因为您正在单步执行。

您可能需要在 JUnit 测试工具中编写一些方便的方法，该方法在测试方法结束时等待，直到实际发送邮件。为了快速测试，您可以在测试方法的末尾放置一个 Thread.sleep() 以查看这是否有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T17:02:22.423

你有没有开启杀毒软件？我已经浪费了几个小时在后台使用无声防病毒软件解决类似问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-16T16:35:49.730

我感谢所有有用的回复。我尝试了大部分这些东西。原来它刚刚开始工作。也许这只是我们的堆栈或电子邮件服务器的问题。有点蹩脚。

# vim - 在 Vim 中 Yank 文件名/当前缓冲区的路径

> ID：916875
> 
> 赞同：208
> 
> 时间：2009-05-27T16:56:30.157
> 
> 标签：vim, clipboard, yank

假设当前缓冲区是打开编辑的文件，所以`:e`不显示`E32: No file name`.

我想拉出以下一项或全部：

*   文件名与状态行显示的完全相同，例如`~\myfile.txt`
*   文件的完整路径，例如`c:\foo\bar\myfile.txt`
*   只是文件名，例如`myfile.txt`

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2009-06-05T05:01:12.853

**TL;DR**

`:let @" = expand("%")`>

this will copy the file name to the *unamed register*, then you can use good old `p` to paste it. and of course you can map this to a key for quicker use.

`:nmap cp :let @" = expand("%")<cr>`

you can also use this for full path

`:let @" = expand("%:p")`

**Explanation**

Vim uses the *unnamed register* to store text that has been deleted or copied (yanked), likewise when you paste it reads the text from this register.

Using `let` we can manually store text in the register using `:let @" = "text"` but we can also store the result of an expression.

In the above example we use the function `expand` which expands wildcards and keywords. in our example we use `expand('%')` to expand the current file name. We can modify it as `expand('%:p')` for the full file name.

See `:help let` `:help expand` `:help registers` for details

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2009-05-27T17:05:55.550

几乎是您所要求的，它可能会这样做：`Ctrl+R %`将当前文件名拉到您所在的位置（命令提示符，编辑缓冲区，...）。有关更多信息，请参阅[此 Vim 提示](http://vim.wikia.com/wiki/Insert_current_filename)。

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2013-06-13T20:09:17.063

如果要将当前缓冲区文件名放在系统级剪贴板中，请尝试将寄存器更改为 @+：

```
" relative path
:let @+ = expand("%")

" full path
:let @+ = expand("%:p")

" just filename
:let @+ = expand("%:t") 
```

* * *

编辑 20140421：我经常使用这些，所以我创建了一些快捷方式。[Linux Vims 的操作显然与 Mac Vims 略有不同](https://stackoverflow.com/questions/11489428/how-to-make-vim-paste-from-and-copy-to-systems-clipboard)，因此也有一个特殊情况。如果您将以下内容放入您的`~/.vimrc`:

```
" copy current file name (relative/absolute) to system clipboard
if has("mac") || has("gui_macvim") || has("gui_mac")
  " relative path  (src/foo.txt)
  nnoremap <leader>cf :let @*=expand("%")<CR>

  " absolute path  (/something/src/foo.txt)
  nnoremap <leader>cF :let @*=expand("%:p")<CR>

  " filename       (foo.txt)
  nnoremap <leader>ct :let @*=expand("%:t")<CR>

  " directory name (/something/src)
  nnoremap <leader>ch :let @*=expand("%:p:h")<CR>
endif

" copy current file name (relative/absolute) to system clipboard (Linux version)
if has("gui_gtk") || has("gui_gtk2") || has("gui_gnome") || has("unix")
  " relative path (src/foo.txt)
  nnoremap <leader>cf :let @+=expand("%")<CR>

  " absolute path (/something/src/foo.txt)
  nnoremap <leader>cF :let @+=expand("%:p")<CR>

  " filename (foo.txt)
  nnoremap <leader>ct :let @+=expand("%:t")<CR>

  " directory name (/something/src)
  nnoremap <leader>ch :let @+=expand("%:p:h")<CR>
endif 
```

然后例如`<leader>cf`将复制当前缓冲区的相对路径（默认领导者是反斜杠（`\`））。我经常使用这些来在文件上运行命令或在命令行上做其他事情。我真的不经常使用最后一个文件名/目录名。

您可能会考虑更直观的映射，例如`<leader>cfr`相对映射、`<leader>cfa`绝对映射、`<leader>cff`仅文件名映射、`<leader>cfd`目录映射。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-03-03T09:42:16.923

如果这样做，您将在寄存器`:reg`中看到当前文件的名称。`%`例如，您可以使用 粘贴它`"%p`。

如果像我一样，您经常切换到“备用”缓冲区，那么将其完整路径和文件名放入`#`寄存器非常方便。例如，您可以使用 粘贴它`"#p`。

注意（以防这是我的设置特有的行为）：我在 Ubuntu 14.04.4 LTS 上使用 VIM 7.4.52。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-05-04T03:11:26.630

结合来自其他几个答案的信息：如果您想提取文件的当前完整路径并将其放入另一个窗口的命令缓冲区中，请先执行`:let @" = expand("%:p")`，然后移动到另一个窗口并键入`Ctrl+R "`。

用于复制文件，同时保留在同一目录中并保持旧文件处于打开状态。例如：

> **开始**：编辑*src/com/benatkin/paint/shapes/Circle.java*
> 
> 1.  类型`:let @" = expand("%:p")` *（路径被拉到主剪贴板缓冲区。）*
>     
>     
> 2.  打开一个新窗口`:sp`
>     
>     
> 3.  类型`:e Ctrl+R"`
>     
>     
> 4.  使用箭头键返回 Circle 并将其更改为 Square，然后按 <CR>
>     
>     
> 
> **结束**：编辑*src/com/benatkin/paint/shapes/Square.java*

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-10-06T11:54:32.463

在 Neovim/Ubunutu 上测试的答案。

```
:let @+=@% 
```

据我所知，`%`寄存器已经包含相对文件路径，因此只需将寄存器的内容移动`%`到代表您最喜欢的剪贴板的任何寄存器即可。

[这个 SO 答案](https://stackoverflow.com/a/1502258/2071807)涉及从一个寄存器复制到另一个

对我来说似乎很简单。不需要任何难以记住的`expand()`东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-12T16:08:12.960

这是我的解决方案：

```
" filename / dirname of the current file {{{
    " copy result to the system clipboard and echo the result
    " the cb> prompt means the clipboard
    " *f*ile *n*ame, ex. init.vim
    map <Leader>fn :let @+ = expand("%:t") \| echo 'cb> ' . @+<CR>
    " *f*ile *p*ath, ex. /home/user/nvim/init.vim
    map <Leader>fp :let @+ = expand("%:p") \| echo 'cb> ' . @+<CR>
    " *d*irectory *p*ath, ex. /home/user/nvim
    map <Leader>dp :let @+ = expand("%:p:h") \| echo 'cb> ' . @+<CR>
    " *d*irectory *n*ame, ex. nvim
    map <Leader>dn :let @+ = expand("%:p:h:t") \| echo 'cb> ' . @+<CR>
" }}} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-09-30T11:11:31.517

如果您想简单地拉出当前打开文件名的路径，则只需按：

1.  step1: ctrl + g [你会在窗口底部看到整个根路径]
2.  step2：用鼠标选择路径
3.  step3：鼠标中键粘贴

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-03-01T15:20:17.867

我把它放在我的vimc中：

```
nnoremap yl :let @" = expand("%:p")<cr> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-10-02T20:44:42.160

我使用 xclip 来访问 X 的剪贴板，所以我使用：

```
nmap <localleader>d :call system("xclip -i -selection clipboard", expand("%:p"))<CR> 
```

# c++ - MFC 应用程序的地图插件

> ID：916877
> 
> 赞同：2
> 
> 时间：2009-05-27T16:56:45.367
> 
> 标签：c++, visual-studio-2008, mfc, plugins, map

我想在 MFC 应用程序（Visual Studo 2008 with MFC Feature Pack）中显示地图。在我的脑海中，我有以下要求：

*   我必须能够添加自己的标记（简单的纬度/经度位置），最好使用不同的颜色/图标，以便可以区分不同类型的标记。
*   如果地图数据是从在线来源获取的，它必须是可缓存的，即我可以在某个（或多个）缩放级别为某个区域预加载地图，然后切换到“离线模式” . 或者，所有地图数据都与应用程序一起安装。
*   用户应该可以进行标准操作，例如放大/缩小和平移。
*   用户必须能够选择我的标记，最好是在它们周围拖动一个矩形。
*   由于整个应用程序是用 C++/MFC 编写的，我不想为此插件使用 .NET 运行时。
*   不应该花大价钱。

我目前正在使用一个名为“ESRI MapObjects LT2”的 ActiveX 插件，它可以以某种方式完成所有这些工作，但实现起来非常乏味，开发似乎在 Visual Studio 6 可用并且地图材料非常基本的时候停止了或非常昂贵。

我考虑过使用谷歌地图或谷歌地球，但我认为它们并不真正支持非基于网络的应用程序使用。我发现[ArcView](http://www.esri-germany.de/products/arcgis/arcview/index.html)是我目前使用的插件的某种继承者，但我认为我不属于目标受众，因为它提供的功能远远超出了我的需要。我也没有找到任何有关定价的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T17:01:09.897

如果您可以访问互联网，请重新考虑谷歌。您可以使 IE 浏览器的实例出现在应用程序的框架中。我相信您可以使用 ActiveX 控件。此外，Google 地球还可以将自己嵌入到网页中，也可能嵌入到应用程序中。

另一个选择是[Global Mapper](http://www.globalmapper.com/)，它远不如 Google Maps 或 Google Earth。

我们使用了 ESRI 很长一段时间，然后由于缺乏性能和缺乏支持而放弃了它。为许可证支付 1 万美元，然后被告知他们还需要 2 千美元，这样我们才能真正使用这个东西，真是太痛苦了。哦，然后再增加 2000 美元来添加一些额外的功能。即使它不起作用，他们的支持也令人沮丧到缺乏光彩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:44:33.970

我已经编写了一个渲染地图的开源 Geocaching 应用程序（它在 c++ 中），源位于：
[http](http://code.google.com/p/gpsturbo/)

://code.google.com/p/gpsturbo/ 它使用我自己的自定义渲染，但你可以撕掉地图如果你想解析。它使用谷歌图块渲染地图（并缓存图块以供离线使用），以及 Garmin 格式的 GPS 地图，还有一个 Openstreetmap 格式的渲染器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-21T15:19:12.287

如果你没有绑定谷歌地图，你可以选择 OpenStreetMap。

有几个已知的用于渲染 OSM 地图的应用程序：

*   [http://wiki.openstreetmap.org/wiki/Cobra](http://wiki.openstreetmap.org/wiki/Cobra)
*   宇宙
*   osmclient（在 SourceForge 上）

前两个直接渲染地图，最后一个使用 OpenStreetMap.org 瓦片。

您可以根据需要缓存任意数量的切片或数据，您不限于这样做。

# c# - 多个 .NET 配置文件和设置项目问题

> ID：916880
> 
> 赞同：4
> 
> 时间：2009-05-27T16:57:36.193
> 
> 标签：c#, .net, visual-studio-2008, installation, windows-installer

为了处理不同部署目标的设置，我将应用程序设置从 app.config 移到它自己的文件中，并通过 configSource 将该文件包含在 app.config 中。我还为每个目标创建了一个设置文件。这是一个插图：

```
Project A
   app.config (references settings.config)
   settings.config 
   settings.Release.config
   settings.Debug.config 
```

在构建后，我将适当的 settings.{configuration}.config 复制到输出目录。到目前为止工作正常，我可以在项目输出目录中看到 settings.config 文件，其中包含当前构建配置的设置：发布、调试等。

但是，我对此项目（项目 A）的设置项目有问题。最初，它不包括 settings.config 文件。因此，我将 settings.config 文件的构建操作设置为内容，并将项目 A 中的内容文件添加到设置项目中。这确保了 settings.config 文件包含在设置中。但是，由于安装项目似乎是从项目目录而不是输出目录中选择 settings.config 文件，因此安装程序中包含的 settings.config 文件不是应该的。我希望将输出目录中的那个包含在安装程序中，因为那个对于当前构建配置是正确的。我尝试了以下方法：

*   将 settings.config 作为文件添加到安装项目。但是，似乎我只能指定绝对路径。因此，当我从特定构建配置 (..bin\debug\settings.config) 的输出目录添加它时，它在其他构建配置中不起作用，因为 (..bin\debug\settings.config) 确实存在于指定的目录。我研究了在安装项目中使用相对路径或动态路径，其中可以将构建配置指定为路径的一部分，但我找不到任何东西。

我考虑使用预构建事件来实际修改项目目录中的 settings.config 文件，然后通过将其“复制到输出目录”设置为始终复制或如果更新则复制来将其复制到输出目录。这应确保将适当的 settings.config 复制到输出目录，就像基于构建后的解决方案一样，还应确保在安装项目包含之前更新 settings.config 文件的内容。但是，我不喜欢这个解决方案，因为我必须确保 settings.config 文件是可写的，然后才能进行任何更改，因为它是源代码控制的。如果它是只读的，那么我需要将其翻转为可写，进行更改，然后再次将其设置为只读。它增加了额外的复杂性。

我想知道是否有人有更好的想法或知道设置项目技巧，该技巧允许我在设置程序中包含适用于当前构建配置的 settings.config 文件。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-11T17:13:34.800

我决定以不同的方式实现相同的结果（能够为不同的目标环境提供不同的配置设置）。所以这就是我如何实现它并且它工作得很好。[我在这里阅读了一些关于MSBuild 社区任务](http://msbuildtasks.tigris.org/)的 XmlMassUpdate 任务的帖子，并决定使用它。这是我所做的：

1) 对于每个需要根据目标环境进行不同设置的项目，我在项目中添加了一个名为 app.config.substitutions.xml 或 web.config.substitutions.xml 的 xml 文件。所以，这个项目看起来像

```
Project A   
 app.config 
 app.config.substitutions.xml 
```

app.config.substitutions.xml 文件具有 XmlMassUpdate 将处理并应用于 app.config 文件的设置替换。以下是我使用的示例替换文件：

```
<configuration xmlns:xmu="urn:msbuildcommunitytasks-xmlmassupdate">
  <substitutions>
    <Development>
      <appSettings>
        <add xmu:key="key" key="SomeSetting" value="DevValue" />
      </appSettings>
    </Development>
    <Test>
      <appSettings>
        <add xmu:key="key" key="SomeSetting" value="TestValue" />
      </appSettings>
    </Test>
    <Release>
      <appSettings>
        <add xmu:key="key" key="SomeSetting" value="ReleaseValue" />
      </appSettings>
    </Release>
  </substitutions>
</configuration> 
```

有关如何指定替换的详细信息，请查看 XmlMassUpdate 的文档或只是对其进行搜索。

2) 现在我需要运行 XmlMassUpdate 作为构建自动化 (TeamBuild/MSBuild) 的一部分。因此，在 TeamBuild 构建定义文件（基本上是 proj 文件）的 BeforeCompile 中，我添加了以下内容以在具有相应 .substitution.xml 文件的配置文件上运行 XmlMassUpdate

```
 <PropertyGroup>
    <SubstitutionFileExtension>.substitutions.xml</SubstitutionFileExtension>
    <TargetEnvironment>Test</TargetEnvironment>
  </PropertyGroup>

  <Target Name="BeforeCompile" Condition="'$(IsDesktopBuild)'!='true'">
    <CreateItem Include="$(SolutionRoot)\**\app.config;$(SolutionRoot)\**\web.config">
      <Output ItemName="ConfigurationFiles" TaskParameter="Include"/>
    </CreateItem>
    <CreateItem Include="@(ConfigurationFiles)" Condition="Exists('%(FullPath)$(SubstitutionFileExtension)')">
      <Output ItemName="ConfigFilesWithSubstitutions" TaskParameter="Include"/>
    </CreateItem>
    <Message Text="Updating configuration files with deployment target specific settings..."/>
    <XmlMassUpdate
      ContentFile="%(ConfigFilesWithSubstitutions.FullPath)"
      SubstitutionsFile="%(ConfigFilesWithSubstitutions.FullPath)$(SubstitutionFileExtension)"
      ContentRoot="/configuration"
      SubstitutionsRoot="/configuration/substitutions/$(TargetEnvironment)"/>   
  </Target> 
```

请注意，配置文件在构建期间是只读的，我确保在运行此任务之前将它们设置为可写。实际上，我还有另一个在 XmlMassUpdate 之前运行的自定义 MSBuild 任务，它处理所有配置文件中的常见设置，例如连接字符串。该任务使配置文件可写。我也不会将修改后的配置文件检查回源代码管理。它们（部署目标的适当配置文件）包含在安装程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T14:32:18.197

如果我不得不解决这个问题，我会先问以下问题：

如果 settings.Debug.config 或 settings.Release.config 提供相同的信息，为什么 settings.config 必须受源代码控制？

如果我正确阅读了您的问题，答案是因为您需要强制 settings.config 文件作为构建输出的一部分出现。我猜这是因为您的设置项目正在使用内置的“主要输出”选项。

您可以做的是将该文件作为显式文件引用添加到您的安装项目中。右键单击安装项目并选择添加/文件，然后选择要包含的文件。正如您会注意到的（除非它已在 VS2008 中修复，遗憾的是我还不允许在工作中使用），手动添加的文件有一个非常烦人的限制 - 没有办法让路径构建配置知道。您可以通过将适当的 settings.config 文件复制到一个公共位置（例如 bin/Configuration）并从那里获取它来解决这个问题。这确实限制了您按顺序构建调试和发布版本，而不是并行构建，但对于许多人来说，这可能不是一个大问题。

如果您不需要使用 VS 设置项目，我强烈建议您查看 WiX（Windows Installer XML - 请参阅[http://wix.sourceforge.net/](http://wix.sourceforge.net/)了解更多信息）。这将很容易让您完成必要的工作，尽管如果您不熟悉 Microsoft Installer 的内部工作原理，最初的学习曲线可能会有点陡峭。Microsoft 自己使用 WiX 来完成一些非常重要的设置任务（例如 Office 2007、SQL Server 等）。人们曾希望 WiX 会成为 Visual Studio 的一部分（用于 VS 2010），但遗憾的是现在情况不再如此。

# asp.net - 如何使用 javascript 在客户端重新加载更新面板？

> ID：916895
> 
> 赞同：1
> 
> 时间：2009-05-27T17:00:17.997
> 
> 标签：asp.net, javascript, vb.net, visual-studio-2008, updatepanel

我有一个以编程方式创建的 gridview 按钮，我想在客户端加载一个带有发送数据的更新面板。我有一个隐藏的值字段，它在单击 gridview 按钮时获取其数据，并且我的更新面板中的下拉列表取决于该值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T17:19:54.523

虽然直接调用`__doPostBack`会起作用，但这并不是一个完美的解决方案，因为该函数的名称严格来说是 .Net 框架的实现细节。

更好的解决方案是使用[`ClientScriptManager.GetPostBackEventReference`](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.getpostbackeventreference.aspx)，它为您提供了对相同功能的更具弹性的界面。请注意，`GetPostBackEventReference`和`GetCallBackEventReference`不是一回事——前者会导致页面重新加载（部分或全部，取决于您的 UpdatePanel 的设置方式），而后者不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T17:52:56.283

最简单的方法是从客户端调用 __doPostBack。

在客户端 button1_onclick 方法上，调用：

```
__doPostBack('<%=UpdatePanel1.ClientID %>','Refresh:0,1,2');    //refresh update panel 
```

在后面的页面上添加以下事件处理程序以捕获回发调用：

```
protected void UpdatePanel1_Load(object sender, EventArgs e)
{
    string arg = Request.Form["__EVENTARGUMENT"];

    if (string.IsNullOrEmpty(arg)) return;

    if (arg.StartWith("Refresh")
    {
         //parse data first then do your thing here...
    }
} 
```

当然不要忘记将事件连接到上述方法：

```
protected void Page_Init(object sender, EventArgs e)
{           
    UpdatePanel1.Load += new EventHandler(UpdatePanel1_Load);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T17:06:33.070

我们使用 __dopostback() 方法来模拟回发并导致更新面板刷新

```
__doPostBack('controlName',''); 
```

不要忘记控件名称是它的 HTML ID（很可能包含美元等），而不仅仅是它的 ASP.NET ID。

据我所知，您可以调用此方法并传入隐藏的值字段或它所在的 div。

# compiler-construction - 在编程方面，语义是什么意思？

> ID：916897
> 
> 赞同：23
> 
> 时间：2009-05-27T17:00:29.947
> 
> 标签：compiler-construction, theory

这是[Eric Lippert 博客](http://blogs.msdn.com/ericlippert/archive/2009/05/25/why-is-the-return-type-parameter-last.aspx)中的一句话：

> **鉴于这种不幸的情况，首先强调存储机制，然后再强调语义**是有道理的 。

很容易获得“语义”含义的[字典定义](http://www.thefreedictionary.com/semantic)，但它在计算机术语中的含义是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-27T17:01:47.603

> 但就计算机术语而言，这意味着什么？

本质上是一样的。例子：

```
x = 5; 
```

以上是*语法*（表示）。该术语的*含义*（即语义）是将值 5 分配给称为 的符号（变量，随便什么）`x`。不同的语言提供不同的语法来提供相同的语义。例如，上面的作业可以写成

```
x := 5; 
```

在帕斯卡中，并且作为

```
x <- 5 
```

在其他几种语言中。在所有情况下，*含义*基本相同。但有时，相同的语法也可能具有*不同*的含义，具体取决于语言和/或上下文。例如，VB 将等号运算符重新定义为两种不同的含义。首先，一个任务，就像上面一样。

其次，在下面的代码sippet中，不是赋值，而是*比较*两个值的意思：

```
If x = 5 Then Console.WriteLine("x is 5") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T17:07:05.220

字典定义适用。

语义是（是？）所有关于单词的含义。

例如，如果您使用 .NET 类型 KeyValuePair 来表示键和值以外的其他内容，那么您就会遇到语义问题。它可能有效......它可能是最好的解决方案，但它在语义上并不准确。

这正是他在那篇博文中所说的。我们首先在类 C 语言中列出返回类型，但实际上返回是最后的。这在语义上是不准确的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-27T17:10:20.503

语义是我们的意思是程序应该做的事情。语法是对我们如何表达语义的特定于语言的约束。

理论上，只要程序的语义是正确的，用什么语言来写都没有关系。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-28T23:29:53.157

就编程语言术语而言，有几个语义概念：

*   **静态语义**会告诉您哪些程序符合语法并且格式正确。许多语言要么没有静态语义（Scheme、Ruby、Python、Icon、Lua、Perl），要么具有主要用于实现*类型系统*的静态语义（Java、C、C#、Haskell）。“使用前需要声明”是另一种可能的静态语义。静态语义回答了“**这个程序有意义吗？** ”这个问题，并在编译时这样做。

*   **动态语义**告诉你两件事之一：

    *   既然一个程序是有意义的，**那么它的意义是什么？** *含义*已经以许多不同的方式在数学上定义。经典的动态语义可以定义程序输入和程序输出之间的函数（或关系）。意义函数（“指称语义”）由 Dana Scott 和 Christopher Strachey 开创；意义关系（“公理语义学”）由托尼·霍尔开创。斯科特和霍尔获得图灵奖；Strachey 可能会，但他英年早逝。获得介绍的一个好方法是阅读 Tony Hoare 的书*Essays in Computing Science*。
    *   鉴于一个程序是有意义的，**它在执行时将如何表现？**. 这种语义通常称为“操作语义”，描述了程序在某种抽象机器上的执行。同样，有很多很多品种。今天，操作语义是首选工具，因为有强大的证明技术，例如，使用操作语义可以证明托管代码中永远不会出现内存错误。Robin Milner 获得*图灵*奖的部分原因是用于描述并发或多线程程序（CCS 和 pi 演算）的不同操作技术。如果你跳过证明，他 1999 年出版的关于*通信和移动系统*的书也是一本很好的书 :-)

如果您在手册或文章中阅读“语义”一词，并且上下文是非正式的英语而不是精确的数学描述，那么作者可能指的是动态操作行为——如果您愿意的话，是一种非正式描述的操作语义。这种非正式的描述对编译器编写者和程序员很有帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-27T17:02:42.827

据我了解，语义是“这对人类意味着什么”。这**是**它的作用，而不是它的**作用**。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-27T17:07:35.190

换句话说，考虑到文章的上下文，他的意思是开发人员最好`C#`专注于在声明变量时如何在内部存储数据，而不是太在意指定精确的方法。声明变量。

换句话说，通过这样做`C#`

```
static int customerCount 
```

您告诉编译器为静态可访问整数准备存储，然后告诉它将该存储标记为`customerCount`

而在 VB 中你会使用这条线

```
dim shared customerCount as Integer 
```

理论上，告诉编译器你有一个名为的变量`customerCount`，它应该存储并使其静态可用，哦顺便说一句，它恰好是一个整数。

这一切真的是一个很好的区分。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-27T17:09:47.243

来自博客的更多上下文：

> 因此，在 C 中，您将存储元数据放在首位（static int customerCount;）而不是语义放在首位（它可能是 var customerCount: static int;）。

他说“static int”出现在“customerCount”之前。调用“static int”**存储元数据**和“customerCount”**语义**。**存储元数据**是关于变量包含什么的信息——其中隐含的是它占用了多少位、它可能包含什么值、它是否在实例之间共享以及它的波动性。

**语义**，变量名称，是代码读者关于应该存储在变量中的信息的信息。变量*意味着*什么。你可以称它为“x”，程序也能正常工作，但程序员很难理解它。称它为“customerCount”为变量提供了意义，这就是语义。

# c - 在 C 中使用 fork()、pipe()、dup2() 和 exec() 时遇到问题

> ID：916900
> 
> 赞同：9
> 
> 时间：2009-05-27T17:00:45.983
> 
> 标签：c, exec, fork, pipe, dup2

这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <wait.h>
#include <readline/readline.h>

#define NUMPIPES 2

int main(int argc, char *argv[]) {
    char *bBuffer, *sPtr, *aPtr = NULL, *pipeComms[NUMPIPES], *cmdArgs[10];
    int fdPipe[2], pCount, aCount, i, status, lPids[NUMPIPES];
    pid_t pid;

    pipe(fdPipe);

    while(1) {
        bBuffer = readline("Shell> ");

        if(!strcasecmp(bBuffer, "exit")) {
            return 0;
        }

        sPtr = bBuffer;
        pCount = -1;

        do {
            aPtr = strsep(&sPtr, "|");
            pipeComms[++pCount] = aPtr;
        } while(aPtr);

        for(i = 0; i < pCount; i++) {
            aCount = -1;

            do {
                aPtr = strsep(&pipeComms[i], " ");
                cmdArgs[++aCount] = aPtr;
            } while(aPtr);

            cmdArgs[aCount] = 0;

            if(strlen(cmdArgs[0]) > 0) {
                pid = fork();

                if(pid == 0) {
                    if(i == 0) {
                        close(fdPipe[0]);

                        dup2(fdPipe[1], STDOUT_FILENO);

                        close(fdPipe[1]);
                    } else if(i == 1) {
                        close(fdPipe[1]);

                        dup2(fdPipe[0], STDIN_FILENO);

                        close(fdPipe[0]);
                    }

                    execvp(cmdArgs[0], cmdArgs);
                    exit(1);
                } else {
                    lPids[i] = pid;

                    /*waitpid(pid, &status, 0);

                    if(WIFEXITED(status)) {
                        printf("[%d] TERMINATED (Status: %d)\n",
                            pid, WEXITSTATUS(status));
                    }*/
                }
            }
        }

        for(i = 0; i < pCount; i++) {
            waitpid(lPids[i], &status, 0);

            if(WIFEXITED(status)) {
                printf("[%d] TERMINATED (Status: %d)\n",
                    lPids[i], WEXITSTATUS(status));
            }
        }
    }

    return 0;
} 
```

（代码已更新以反映他下面两个答案提出的更改，它仍然无法正常工作......）

这是失败的测试用例：

```
nazgulled ~/Projects/SO/G08 $ ls -l
total 8
-rwxr-xr-x 1 nazgulled nazgulled  7181 2009-05-27 17:44 a.out
-rwxr-xr-x 1 nazgulled nazgulled   754 2009-05-27 01:42 data.h
-rwxr-xr-x 1 nazgulled nazgulled  1305 2009-05-27 17:50 main.c
-rwxr-xr-x 1 nazgulled nazgulled   320 2009-05-27 01:42 makefile
-rwxr-xr-x 1 nazgulled nazgulled 14408 2009-05-27 17:21 prog
-rwxr-xr-x 1 nazgulled nazgulled  9276 2009-05-27 17:21 prog.c
-rwxr-xr-x 1 nazgulled nazgulled 10496 2009-05-27 17:21 prog.o
-rwxr-xr-x 1 nazgulled nazgulled    16 2009-05-27 17:19 test
nazgulled ~/Projects/SO/G08 $ ./a.out 
Shell> ls -l|grep prog
[4804] TERMINATED (Status: 0)
-rwxr-xr-x 1 nazgulled nazgulled 14408 2009-05-27 17:21 prog
-rwxr-xr-x 1 nazgulled nazgulled  9276 2009-05-27 17:21 prog.c
-rwxr-xr-x 1 nazgulled nazgulled 10496 2009-05-27 17:21 prog.o 
```

问题是我应该在那之后返回我的shell，我应该看到“Shell>”等待更多输入。您还可以注意到，您没有看到类似于“[4804] TERMINATED (Status: 0)”（但 pid 不同）的消息，这意味着第二个进程没有终止。

我认为它与 grep 有关，因为它有效：

```
nazgulled ~/Projects/SO/G08 $ ./a.out 
Shell> echo q|sudo fdisk /dev/sda
[4838] TERMINATED (Status: 0)

The number of cylinders for this disk is set to 1305.
There is nothing wrong with that, but this is larger than 1024,
and could in certain setups cause problems with:
1) software that runs at boot time (e.g., old versions of LILO)
2) booting and partitioning software from other OSs
   (e.g., DOS FDISK, OS/2 FDISK)

Command (m for help): 
[4839] TERMINATED (Status: 0) 
```

您可以轻松地看到两个“终止”消息...

那么，我的代码有什么问题？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-27T19:53:20.503

即使在管道的第一个命令退出（并因此关闭`stdout=~fdPipe[1]`）之后，父级仍然`fdPipe[1]`打开。

因此，管道的第二个命令`stdin=~fdPipe[0]`永远不会获得 EOF，因为管道的另一个端点仍然是打开的。

您需要`pipe(fdPipe)`为 each创建一个新的`|`，并确保关闭父节点中的两个端点；IE

```
for cmd in cmds
    if there is a next cmd
        pipe(new_fds)
    fork
    if child
        if there is a previous cmd
            dup2(old_fds[0], 0)
            close(old_fds[0])
            close(old_fds[1])
        if there is a next cmd
            close(new_fds[0])
            dup2(new_fds[1], 1)
            close(new_fds[1])
        exec cmd || die
    else
        if there is a previous cmd
            close(old_fds[0])
            close(old_fds[1])
        if there is a next cmd
            old_fds = new_fds
if there are multiple cmds
    close(old_fds[0])
    close(old_fds[1]) 
```

此外，为了更安全，您应该在执行任何and操作之前处理`fdPipe`和重叠的情况。如果有人设法在标准输入或标准输出关闭的情况下启动您的 shell，则可能会发生这种情况，并且会导致与此处的代码非常混淆。`{STDIN_FILENO,STDOUT_FILENO}``close``dup2`

### 编辑

```
 fdPipe1           fdPipe3
      v                 v
cmd1  |  cmd2  |  cmd3  |  cmd4  |  cmd5
               ^                 ^
            fdPipe2           fdPipe4 
```

除了确保关闭父级中的管道端点之外，我还试图指出`fdPipe1`,`fdPipe2`等*不能*相同`pipe()`。

```
/* suppose stdin and stdout have been closed...
 * for example, if your program was started with "./a.out <&- >&-" */
close(0), close(1);

/* then the result you get back from pipe() is {0, 1} or {1, 0}, since
 * fd numbers are always allocated from the lowest available */
pipe(fdPipe);

close(0);
dup2(fdPipe[0], 0); 
```

我知道您没有`close(0)`在当前代码中使用，但最后一段警告您要注意这种情况。

### 编辑

对您的代码进行的以下*最小*更改使其可以在您提到的特定失败情况下工作：

```
@@ -12,6 +12,4 @@
     pid_t pid；

- 管道（fdPipe）；
-
     而（1）{
         bBuffer = readline("Shell>");
@@ -29,4 +27,6 @@
         } 而（aPtr）；

+管道（fdPipe）；
+
         for(i = 0; i < pCount; i++) {
                 aCount = -1;
@@ -72,4 +72,7 @@
         }

+ 关闭（fdPipe[0]）；
+ 关闭（fdPipe[1]）；
+
         for(i = 0; i < pCount; i++) {
                 waitpid(lPids[i], &status, 0);

```

这不适用于管道中的多个命令；为此，您需要这样的东西：（未经测试，因为您还必须修复其他问题）

```
@@ -9,9 +9,7 @@
 int main(int argc, char *argv[]) {
     char *bBuffer, *sPtr, *aPtr = NULL, *pipeComms[NUMPIPES], *cmdArgs[10];
- int fdPipe[2], pCount, aCount, i, status, lPids[NUMPIPES];
+ int fdPipe[2], fdPipe2[2], pCount, aCount, i, status, lPids[NUMPIPES];
     pid_t pid；

- 管道（fdPipe）；
-
     而（1）{
         bBuffer = readline("Shell>");
@@ -32,4 +30,7 @@
                 aCount = -1;

+ 如果 (i + 1 < pCount)
+管道（fdPipe2）；
+
                 做 {
                         aPtr = strsep(&pipeComms[i], "");
@@ -43,11 +44,12 @@

                         如果（PID == 0）{
- 如果（我 == 0）{
- 关闭（fdPipe[0]）；
+ if(i + 1 < pCount) {
+ 关闭（fdPipe2[0]）；

- dup2（fdPipe [1]，STDOUT_FILENO）；
+ dup2(fdPipe2[1], STDOUT_FILENO);

- 关闭（fdPipe[1]）；
- } 否则 if(i == 1) {
+ 关闭（fdPipe2[1]）；
+ }
+ 如果（我！= 0）{
                                         关闭（fdPipe[1]）；

@@ -70,4 +72,17 @@
                         }
                 }
+
+ 如果（我！= 0）{
+ 关闭（fdPipe[0]）；
+ 关闭（fdPipe[1]）；
+ }
+
+ fdPipe[0] = fdPipe2[0]；
+ fdPipe[1] = fdPipe2[1]；
+ }
+
+ if (pCount) {
+ 关闭（fdPipe[0]）；
+ 关闭（fdPipe[1]）；
         }

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T17:48:02.657

在 execvp() 之后你应该有一个错误退出 - 它有时会失败。

```
exit(EXIT_FAILURE); 
```

正如@uncleo 指出的那样，参数列表必须有一个空指针来指示结束：

```
cmdArgs[aCount] = 0; 
```

我不清楚您是否让两个程序自由运行 - 似乎您需要管道中的第一个程序在开始第二个程序之前完成，如果第一个程序因为管道已满而阻塞，这不是成功的秘诀。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T18:11:55.200

乔纳森的想法是正确的。您依靠第一个进程来分叉所有其他进程。在下一个分叉之前，每个都必须运行完成。

相反，像你正在做的那样在循环中分叉进程，但在内部循环之外等待它们（在 shell 提示符的大循环的底部）。

```
loop //for prompt
    next prompt
    loop //to fork tasks, store the pids
        if pid == 0 run command
        else store the pid
    end loop
    loop // on pids
        wait
    end loop
end loop 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T17:43:19.720

一个潜在的问题是 cmdargs 末尾可能有垃圾。在将数组传递给 execvp() 之前，您应该使用空指针终止该数组。

不过，看起来 grep 正在接受 STDIN，所以这可能不会导致任何问题（还）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T17:24:47.323

我认为您的分叉进程将继续执行。

尝试：

*   将其更改为“返回 execvp”
*   添加“退出（1）；” 执行后

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-26T12:32:46.310

管道中的文件描述符被引用计数，并随着每个 fork 递增。对于每个分叉，您必须在两个描述符上发出关闭以将引用计数减少到零并允许管道关闭。我正在猜测。

# video - Lustre、Gluster 或 MogileFS？用于视频存储、编码和流式传输

> ID：916902
> 
> 赞同：28
> 
> 时间：2009-05-27T17:01:14.360
> 
> 标签：video, streaming, distributed-filesystem

如此多的选项，而测试它们的时间却如此之少......我想知道是否有人对用于视频流和存储/编码的分布式文件系统有经验。

我有很多巨大的视频文件（50GB 到 250GB）需要存储在某个地方，能够将它们编码为 mp4 并从多个 Adob​​e FMS 服务器流式传输它们。处理这一切的唯一方法是使用分布式文件系统，但现在的问题是哪个？

到目前为止，我的研究告诉我：

*   **Lustre**：成熟成熟的解决方案，被很多大公司使用，最好是大于 10G 的文件是内核驱动程序。
*   **Gluster**：新的，不太成熟的，基于 FUSE 的，这意味着易于安装，但由于 FUSE 开销可能会更慢。更好地处理大量较小的文件 ~1GB
*   **MogileFS** : 似乎只适用于小文件~MB，使用 HTTP 访问？？未来可能的 FUSE 绑定。

到目前为止，Lustre 似乎是赢家，但我想听听我所拥有的特定应用程序的真实体验。

Hadoop、Redhat GFS、Coda 和 Windows DFS 听起来也可以作为选项，因此欢迎任何体验。如果有人有基准，请分享。

经过一些实际经验，这是我学到的：

*   光泽：
    *   性能：惊人的快！我可以断言 Lustre 可以提供大量流，并且编码速度不受通过 Lustre 访问文件的影响。
    *   POXIS 兼容性：非常好！无需修改应用程序即可使用光泽。
    *   复制、负载平衡和故障转移：非常糟糕！对于复制负载平衡，我们和故障转移需要依赖其他软件，例如虚拟 IP 和 DRDB。
    *   安装：最糟糕的！普通人无法安装。需要内核、光泽补丁和调整的非常特定的组合才能使其正常工作。而当前的 luster 补丁通常适用于与新硬件/软件不兼容的旧内核。
*   MogileFS：
    *   性能：适用于小文件，但不适用于大中型文件。这主要是由于 HTTP 开销，因为所有文件都是通过 HTTP 请求发送/接收的，这些请求将所有数据编码为 base64，为每个文件增加了 33% 的开销。
    *   POXIX 兼容性不存在。所有应用程序都需要修改为使用 mogilefs，这使得它无法用于流式传输/编码，因为大多数流式传输服务器和编码工具不理解 MogileFS 协议。
    *   通过一次访问多个跟踪器，可以在应用程序中实现开箱即用的复制和故障转移以及负载平衡。
    *   安装相对容易，大多数发行版中都存在现成的软件包。我发现的唯一困难是设置数据库主从以消除单点故障。
        *   光泽：
    *   性能：对流媒体非常不利。在 10Gbps 网络中，我无法达到超过几 Mbps。客户端和服务器 CPU 因大量写入而猛增。对于编码工作，因为 CPU 在网络和 I/O 之前就已经饱和。
    *   POXIS：几乎兼容。我使用的工具可以将 gluster 挂载作为磁盘中的普通文件夹访问，但在某些边缘情况下，事情会开始导致问题。检查 gluster 邮件列表，你会发现有很多问题。
    *   复制、故障转移和负载平衡：最好的！如果他们真的工作。Gluster 是非常新的，它有很多错误和性能问题。
    *   安装太容易了。管理命令行非常棒，在多台服务器之间设置复制、条带化和分布式卷再简单不过了。

定论：

不幸的是，结论是“没有银弹”。

目前，我们将 Gluster3.2 中的媒体文件放在一个复制卷中，用于存储和转码。只要您没有很多服务器，就可以避免异地复制和条带卷。

当我们要流式传输媒体文件时，我们将它们复制到一个光泽卷，该卷通过 DR:DB 复制到第二个光泽卷。然后 wowza 服务器从 luster 卷中读取媒体文件。

最后，我们使用 MogileFS 在我们的 Web 应用程序服务器中提供缩略图。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-02T12:36:16.243

迄今为止，GlusterFS 对自己进行了很大改进。他们现在为大文件提供“粒度锁定”。请参阅此处：[http](http://www.gluster.org/community/documentation/index.php/WhatsNew3.3) ://www.gluster.org/community/documentation/index.php/WhatsNew3.3 此外，它也非常依赖于您应该工作的视频帧速率。如果您无法达到 4K 速率，Gluster 可以解决存储问题。如果对速度有巨大的需求，那么 Infiniband 可以发挥作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-31T04:13:54.110

MogileFS 非常适合这类事情。客户端库的质量略有不同，但如果没有使用几乎任何语言访问它的大型生产站点，我会感到惊讶。

HTTP 实际上是一个很好的协议。谁没有功能丰富且高效的 HTTP 客户端？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-06T17:51:58.607

查看 Hadoop 文件系统 (HDFS)。它的重点是非常大的文件和并行任务计算（使用 map/reduce），它具有高延迟但非常高的吞吐量。它目前用于 Facebook 和 amazon.com 等大型设施

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-03T08:59:21.937

Map-reduce 对 90/10 的写入/读取比率没有帮助！恒定的文件大小是一件好事，而且文件很小。因此，MogileFS 听起来是作为 Lustre/Gluster 的不错选择 - 缓存情况不合适。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-01T01:16:15.067

在命名系统中，最合适的是 MoglieFS。

但也许你可以完全不使用任何特殊系统。假设您有 4 个 Adob​​eFMS 服务器：

```
{video0.exmple.com,video1.exmple.com,video2.exmple.com,video3.exmple.com}. 
```

您可以使用简单的方案在这 4 个服务器之间分发所有视频，例如

```
 /*
     *  pseudo code
     */

    $server_id = get_server_id(filename);
    ...
    ...
    int function get_server_id(filename) 
    { 
       return hash(filename) mod 4;
    } 
```

对视频进行编码后，您的应用会

```
$server_id = get_server_id(file_name)
copy file_name to /mnt/$server_id/ 
```

[客户端将使用类似http://videoN.example.com/filename.mp4](http://videoN.example.com/filename.mp4)的方式访问视频，其中 N 是使用`get_server_id()`.

Lustre/Gluster 真的不是你应该寻找的。Lustre FS比较成熟，但是开发者要求你把这种FS上的文件当作“缓存”，即随时可能丢失。

Lustre/Gluster 的目标是在 HPC 中使用，以允许快速访问大量数据，而没有单个存储服务器成为性能瓶颈。这些系统的另一点是它们符合 POSIX 标准。在 HPC/科学研究环境中，您通常没有时间重新编写应用程序，因为您安装了新的酷而快速的 FS。

# c# - 如何获取属于自定义属性的属性？

> ID：916904
> 
> 赞同：11
> 
> 时间：2009-05-27T17:01:38.883
> 
> 标签：c#, reflection, attributes

我需要从自定义属性中找到应用自定义属性的属性类型。

例如：

```
[MyAttribute]
string MyProperty{get;set;} 
```

给定 MyAttribute 的实例，我如何获得 MyProperty 的类型描述符？

换句话说，我正在寻找 System.Type.GetCustomAttributes() 的反面

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-27T17:21:23.320

属性本身对用它装饰的对象一无所知。但是您可以在检索属性时注入此信息。
在某些时候，您必须使用类似于以下的代码来检索属性。

```
PropertyInfo propertyInfo = typeof(MyType).GetProperty("MyProperty");

Object[] attribute = propertyInfo.GetCustomAttributes(typeof(MyAttribute), true);

if (attribute.Length > 0)
{
    MyAttribute myAttribute = (MyAttribute) attributes[0];

    // Inject the type of the property.
    myAttribute.PropertyType = propertyInfo.PropertyType;

    // Or inject the complete property info.
    myAttribute.PropertyInfo = propertyInfo;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T17:05:51.777

自定义属性对属性元素一无所知，所以我认为除非您枚举系统中的所有类型并检查它们是否包含此类属性，否则您无法执行任何操作。

# hosting - 我应该在同一台服务器上托管网站和 REST API 还是拆分？

> ID：916920
> 
> 赞同：9
> 
> 时间：2009-05-27T17:03:06.557
> 
> 标签：hosting, scalability, amazon-web-services

我有一个由网站和 REST API 组成的 Web 应用程序。我应该将它们托管在同一台服务器上还是应该将它们托管在不同的服务器上？“服务器”是指服务器集群——负载均衡器后面的几台服务器。

API 主要是入站流量，网站 - 主要是出站。

如果重要的话 - 托管在 Rackspace 和/或 AWS 上。

这是我到目前为止所看到的：

**在同一台服务器上拥有网站和 REST API 的好处**

*   简单部署
*   简单的扩展 - 有些东西很慢 - 只需启动另一个实例
*   单负载均衡器配置
*   简单的监控
*   简单，简单，简单……
*   有效利用全双工网络（API - 入站，网站 - 出站）

**拆分的好处**

*   API 过载不会影响网站加载时间
*   详细监控（此时我会知道哪个组件使用资源）

任何意见？

谢谢

亚历山大

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T17:15:40.790

正如您所说，在大多数情况下，将 API 托管在与网站相同的服务器上会有更多优势。所以我会坚持这个选项。

但是，如果您预测网站或 API 的流量分配，那么单独的服务器可能更适合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T17:17:41.503

如果这是在负载均衡器上，为什么不将服务和页面留在同一个站点上，让负载均衡器/集群完成它的工作？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T17:17:47.727

您的优点/缺点列表是操作考虑因素，但您也应该考虑应用程序需求。

*   缓存？
*   安全？
*   其他资源，即文件系统

这些可能适用也可能不适用，但如果您的应用程序架构在两者之间有所不同，请务必将其纳入您的决定。

# c# - 如何将数据绑定对象的组合框字段绑定到数据源并仍然允许空值？

> ID：916921
> 
> 赞同：1
> 
> 时间：2009-05-27T17:03:10.067
> 
> 标签：c#, winforms, data-binding, null, datasource

我有一个数据绑定到客户对象的表单，其中一个字段是表示“类型”的可为空的 int。这显示为组合框，并且组合框绑定到“类型”表。

将具有空类型的客户加载到表单的数据源中时，组合框不显示任何值，但是在单击它时，您必须选择一个值。表单/组合框永远不会让您改回空白项目（在客户对象上表示“空”）。

我不想要数据库中的“虚拟行”，目前通过添加一个虚拟对象并在提交事件中将其清空（不干净！）来做到这一点。

是否有可能干净地做到这一点，并保持可为空的主键？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-10T13:24:01.403

有关可空数据绑定的其他链接和资源：

有人告诉我，到目前为止它已经成功了，你应该在你的数据库数据源和你的 UI 之间有一层业务对象，你可以按照 shahkalpesh 的建议添加一个项目，而不用担心它会进入数据库。

[Jez Humble 在这篇文章的底部和评论](http://blog.jezhumble.net/?p=3)中提供了一些关于绑定可空类型的信息，如果“您明确地将 DataSourceUpdateMode 设置为 DataSourceUpdateMode.OnPropertyChanged”，它建议绑定到可空类型是可行的。

关于数据绑定 Nullable 类型的另一篇文章：代码的乐趣 - [WinForms.NET 中的数据绑定和 Nullable 类型](http://www.thejoyofcode.com/Databinding_and_Nullable_types_in_WinForms.NET.aspx)

也许此用于绑定可为空的 DateTimePicker 的代码可以帮助您找到针对此问题或其他可为空问题的其他解决方案。

另请查看[Dan Hannan](http://blogs.interknowlogy.com/danhanan/archive/2007/01/21/10847.aspx)，了解我提出扩展方法的来源。

```
/// <summary>
    /// From BReusable
    /// </summary>
    /// <param name="dtp"></param>
    /// <param name="dataSource"></param>
    /// <param name="valueMember"></param>
    /// <remarks>With help from Dan Hanan at http://blogs.interknowlogy.com/danhanan/archive/2007/01/21/10847.aspx</remarks>
    public static void BindNullableValue(this DateTimePicker dateTimePicker, BindingSource dataSource, String valueMember,bool showCheckBox)
    {
        var binding = new Binding("Value", dataSource, valueMember, true);

        //OBJECT PROPERTY --> CONTROL VALUE
        binding.Format += new ConvertEventHandler((sender, e) =>
        {
            Binding b = sender as Binding;

            if (b != null)
            {
                DateTimePicker dtp = (binding.Control as DateTimePicker);
                if (dtp != null)
                {
                    if (e.Value == null)
                    {

                        dtp.ShowCheckBox = showCheckBox;
                        dtp.Checked = false;

                        // have to set e.Value to SOMETHING, since it's coming in as NULL
                        // if i set to DateTime.Today, and that's DIFFERENT than the control's current
                        // value, then it triggers a CHANGE to the value, which CHECKS the box (not ok)
                        // the trick - set e.Value to whatever value the control currently has. 
                        // This does NOT cause a CHANGE, and the checkbox stays OFF.

                        e.Value = dtp.Value;

                    }
                    else
                    {
                        dtp.ShowCheckBox = showCheckBox;
                        dtp.Checked = true;
                        // leave e.Value unchanged - it's not null, so the DTP is fine with it.
                    }

                }

            }
        });
        // CONTROL VALUE --> OBJECT PROPERTY
        binding.Parse += new ConvertEventHandler((sender, e) =>
        {
            // e.value is the formatted value coming from the control. 
            // we change it to be the value we want to stuff in the object.
            Binding b = sender as Binding;

            if (b != null)
            {
                DateTimePicker dtp = (b.Control as DateTimePicker);
                if (dtp != null)
                {
                    if (dtp.Checked == false)
                    {
                        dtp.ShowCheckBox = showCheckBox;
                        dtp.Checked = false;
                        e.Value = (Nullable<DateTime>)null;
                    }
                    else
                    {
                        DateTime val = Convert.ToDateTime(e.Value);
                        e.Value = val;
                    }
                }
            }
        });
        dateTimePicker.DataBindings.Add(binding);

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T10:07:56.127

如果您的主要目标是将组合恢复为空白并将值恢复为空，则只需在编辑行时按 Ctrl+0。

*我花了两天时间进行疯狂的研究和心脏病发作的风险，才发现它隐藏在某个地方的一个小帖子中。*

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-27T20:32:01.453

用于绑定到 Type 组合的数据源可能还有 1 个条目，其中包含 NULL 值。

```
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
类型 ID 名称
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1 业务
2 政府
-1 空

```

您可以为没有类型的客户存储 -1（如果允许客户不需要类型）。

# asp.net - 如何从网页 (asp.net) 启动 EXE

> ID：916925
> 
> 赞同：32
> 
> 时间：2009-05-27T17:04:04.260
> 
> 标签：asp.net, web-applications, internet-explorer-7

这是一个内部 Web 应用程序，我们希望 Web 页面包含指向多个 Win32 EXE 实用程序的链接。EXE 由我们信任和制作。（不管它是否询问是否可以运行或保存）。我尝试了仅在本地工作的直接链接（例如 C:\notepad.exe）。（这将是网络上的一个共享）。试过 File:/// 没有用。IE7是需要的浏览器。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2011-02-18T23:56:25.740

This assumes the exe is somewhere you know on the user's computer:

```
<a href="javascript:LaunchApp()">Launch the executable</a>

<script>
function LaunchApp() {
if (!document.all) {
  alert ("Available only with Internet Explorer.");
  return;
}
var ws = new ActiveXObject("WScript.Shell");
ws.Exec("C:\\Windows\\notepad.exe");
}
</script> 
```

Documentation: [ActiveXObject](http://msdn.microsoft.com/en-us/library/ie/7sw4ddf8%28v=vs.94%29.aspx), [Exec Method (Windows Script Host)](http://msdn.microsoft.com/en-us/library/ateytk4a%28v=vs.84%29.aspx).

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-27T17:09:08.213

怎么样：

```
<a href="\\DangerServer\Downloads\MyVirusArchive.exe" 
  type="application/octet-stream">Don't download this file!</a> 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-05-27T17:24:04.080

您可以通过使用 Fiddler 在使用链接时遵循操作来查看 iTunes 是如何做到的： http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewPodcast?id= [80028216](http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewPodcast?id=80028216)

1.  它下载一个js文件
2.  在 windows 上：js 文件确定计算机上是否安装了 iTunes：如果 IE 则查找 activeX 浏览器组件，如果 FF 则查找浏览器插件
3.  如果安装了 iTunes，则浏览器将被重定向到带有特殊传输的 URL：itms://...
4.  浏览器调用处理程序（由 iTunes exe 提供）。这包括启动 exe（如果它尚未运行）。
5.  iTunes exe 使用特殊 url 的其余部分向用户显示特定页面。

请注意，安装该 exe 时，会为浏览器的“itms”传输安装 URL 协议处理程序。

不是一个简单的工程项目可以复制，但绝对可行。如果您继续这样做，请考虑将相关软件开源。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-11-13T09:11:18.817

在 windows 中，可以在 Registry 中注册应用程序的指定协议。在这个[msdn 文档](https://msdn.microsoft.com/en-us/library/aa767914(v=vs.85).aspx)中显示了将应用程序注册到 URI 方案。

例如，要启动可执行文件“alert.exe”。可以注册以下项目。

```
HKEY_CLASSES_ROOT
   alert
      (Default) = "URL:Alert Protocol"
      URL Protocol = ""
      DefaultIcon
         (Default) = "alert.exe,1"
      shell
         open
            command
               (Default) = "C:\Program Files\Alert\alert.exe" 
```

然后你可以写一个html来测试

```
<head>
    <title>alter</title>
</head>

<body>
    <a href="alert:" >alert</a>
<body> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-02-22T11:06:30.107

作为Larry K 建议的[解决方案的一部分，注册您自己的协议可能是一种可能的解决方案。](https://stackoverflow.com/a/917011/12892)该网页可以包含一个简单的链接来下载和安装应用程序——然后它会在 Windows 注册表中注册自己的协议。

然后网页将包含带有参数的链接，这些参数将导致注册程序被打开，并且链接中指定的任何参数都被传递给它。[MSDN](http://msdn.microsoft.com/en-us/library/aa767914(VS.85).aspx)上有一个很好的描述如何做到这一点

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-05T13:01:51.507

如果应用程序是 C#，您可以使用[ClickOnce 部署](http://msdn.microsoft.com/en-us/library/t71a733d%28v=vs.80%29.aspx)，如果您不能保证用户将拥有该应用程序，这是一个不错的选择，但是您必须使用部署选项重新构建应用程序并从中获取一些样板代码每个项目。

您也可以使用[Javascript](https://stackoverflow.com/questions/3152482/running-exe-from-javascript)。

或者您可以注册一个应用程序来处理您可以定义[的新网络协议。](http://msdn.microsoft.com/en-us/library/aa767914%28v=vs.85%29.aspx)这也可能是“应用程序选择”协议，因此每次单击应用程序时，它都会链接到新协议上的页面，然后将此协议的所有处理传递给您的“选择应用程序”，该应用程序使用参数来查找和启动客户端 PC 上的应用程序。

高温高压

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T17:06:54.193

你试过[UNC 分享](http://en.wikipedia.org/wiki/Path_(computing)#Uniform_Naming_Convention)吗？

> `\\server\share\foo.exe`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-27T22:36:13.340

您是说在网页中插入指向恰好具有 .exe 扩展名的文件的链接时遇到问题吗？

如果是这样，那就退后一步。假设该文件具有 .htm 扩展名或 .css 扩展名。你怎样才能使它可下载？如果是静态链接，那么答案很明确：该文件需要位于 ASP.NET 应用程序的 docroot 中。IIS + ASP.NET 提供多种内容：.htm 文件、.css 文件、.js 文件、图像文件、*隐式*. 所有这些文件都在 docroot 下的某个位置，默认情况下是 c:\inetpub\wwwroot，但对于您的 webapp 来说肯定是不同的。您要公开的文件具有 .exe 扩展名这一事实不会改变 IIS 物理的基本定律。exe 必须位于 docroot 下。网络共享可能适用于某些浏览器。

当然，另一种方法是将文件的内容动态地直接写入 Response.OutputStream。这样您就不需要 .exe 在您的 docroot 中，但它不是直接下载链接。在这种情况下，可以通过单击按钮下载文件。

像这样的东西：

```
 Response.Clear(); 
    string FullPathFilename = "\\\\server\\share\\CorpApp1.exe";
    string archiveName= System.IO.Path.GetFileName(FullPathFilename);
    Response.ContentType = "application/octet-stream";
    Response.AddHeader("content-disposition", "filename=" + archiveName);
    Response.TransmitFile(FullPathFilename);
    Response.End(); 
```

# javascript - 从 HTML Canvas 元素生成图像数据

> ID：916934
> 
> 赞同：6
> 
> 时间：2009-05-27T17:05:57.080
> 
> 标签：javascript, html, canvas

从 HTML 画布元素的内容生成图像数据的最佳方法是什么？

我想创建图像数据，以便可以将其传输到服务器（用户不必直接保存到文件中）。图像数据应采用常见格式，例如 PNG 或 JPEG。

首选在多个浏览器中正常工作的解决方案，但如果每个解决方案都依赖于浏览器，则应以最新版本的 Firefox 为目标。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T18:07:29.263

Firefox 和 Opera 有一个`toDataURL()`方法可以返回数据 URL 格式的 PNG。您可以将结果分配给表单字段以将其提交给服务器。

数据 URL 采用 base-64 编码，因此您必须在服务器端对其进行解码。您还需要去掉“data:image/png;” 当然的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T17:08:24.173

我认为您可以使用的库是[Canvas2Image](http://www.nihilogic.dk/labs/canvas2image/)，它使用 Canvas 的本机功能，但它不适用于任何浏览器。我有这个库的优化版本，如果你愿意，我会与你分享。

然后您可以获取生成的[Data URI](http://en.wikipedia.org/wiki/Data_URI_scheme)并使用 Ajax 将其发送到服务器。

# sql-server - 如何加快简单加入

> ID：916940
> 
> 赞同：12
> 
> 时间：2009-05-27T17:06:27.203
> 
> 标签：sql-server, performance, join

我不擅长 SQL。

我正在寻找一种方法来加快这样的简单加入：

```
SELECT
    E.expressionID,
    A.attributeName,
    A.attributeValue
FROM 
    attributes A
JOIN
    expressions E
ON 
    E.attributeId = A.attributeId 
```

我这样做了成千上万次，随着桌子变大，它花费的时间越来越多。

我正在考虑索引 - 如果我要加快对单个表的选择，我可能会将非聚集索引放在表达式表的 expressionID 和属性表的 (attributeName, attributeValue) 上 - 但我不知道这是怎么回事可以申请加入。

**编辑**：我已经在表达式表上的 expressionId (PK)、attributeId (PK, FK) 上有一个聚集索引，在属性表上的 attributeId (PK) 上有另一个聚集索引

我已经看到[了这个](https://stackoverflow.com/questions/272665/speed-up-sql-join)问题，但我要求的是更一般的东西，可能更简单。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-27T17:08:26.247

您肯定希望`attributeID`在`attributes`和`expressions`表上都有索引。如果你目前没有这些索引，我认为你会看到一个很大的加速。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T17:09:27.667

事实上，因为返回的列太少，我会考虑为这个查询使用覆盖索引

即包含查询中所有字段的索引。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T17:18:32.827

您需要关心的一些事情是索引、查询计划和统计信息。

将索引放在attributeId上。或者，确保在attributeId 是键中的第一列的位置存在索引（如果它不是第一列，SQL Server 仍然可以使用索引，但它没有那么快）。

突出显示查询分析器中的查询并点击 ^L 以查看计划。您可以看到表是如何连接在一起的。 **几乎**总是，使用索引总比不使用好（有些情况下，如果表足够小，索引会减慢您的速度——但现在，请注意 99% 的时间索引是好的）。

注意表连接的顺序。SQL Server 维护有关表大小的统计信息，并将确定首先加入哪个更好。对内部 SQL Server 程序进行一些调查以更新统计信息——它太长了，所以我手边没有这些信息。

那应该让你开始。实际上，即使是这样一个简单的查询，也可以写一整章来说明数据库如何优化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T19:01:21.713

我敢打赌，您的问题是插入到该临时表中的行数巨大。有什么办法可以在数据库中的每一行 `WHERE`之前添加一个子句？`SELECT`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T17:44:02.587

另一件事是添加一些索引，如下所示：

```
attributes.{attributeId, attributeName, attributeValue}
expressions.{attributeId, expressionID} 
```

这是哈克！但如果它是最后的手段，它很有用。

这样做是创建一个可以由索引“完全回答”的查询计划。通常，索引实际上会导致上述查询中的双 I/O：一个命中索引（即探测表），另一个获取索引引用的实际行（提取属性名称等）。

如果“属性”或“表达式”是一个宽表，这将特别有用。也就是说，从一个表中获取行的成本很高。

最后，加快查询速度的最佳方法是添加 WHERE 子句！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T21:01:30.723

如果我正确理解了您的架构，那么您是在说您的表看起来像这样：

> ```
> Expressions: PK - ExpressionID, AttributeID
> Attributes:  PK - AttributeID 
> ```

假设每个 PK 都是一个聚集索引，这仍然意味着 Expressions 表需要进行索引扫描。您可能需要考虑在*Expressions*表上创建一个索引，例如：*AttributeID、ExpressionID*。这将有助于停止当前发生的索引扫描。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-24T12:11:05.467

尖端，

如果您想使用连接加快查询速度：

对于“inner join/join”，
不要使用 where 条件，而是在“ON”条件下使用。
例如：

```
 select id,name from table1 a  
       join table2 b on a.name=b.name
       where id='123'

     Try,

        select id,name from table1 a  
       join table2 b on a.name=b.name and a.id='123' 
```

对于“左/右连接”，
不要在“开”条件下使用，因为如果你使用左/右连接，它将获取任何一张表的所有行。所以，在“开”条件下不要使用它。所以，尝试使用“Where”条件

# nhibernate - 在 Nhibernate 中使用自定义 sql 语句删除一行

> ID：916943
> 
> 赞同：2
> 
> 时间：2009-05-27T17:06:40.370
> 
> 标签：nhibernate

我正在使用 NHibernate 并且有一个要求，当我删除一行时，我不应该硬删除该行，而是将状态更新为 delted 并设置一些系统属性，例如谁删除了等。

为此，我决定使用自定义 sql 语句。

```
<sql-delete>
  update PPDE set SysStatusID = 2 where PPDID =? 
</sql-delete> 
```

在 sql 语句中，我能够获得对 id 的引用，但是如何将 SysUserID 更新为删除该行的用户。

基本上如何在自定义 sql 语句中设置动态参数值。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T19:32:55.053

做你想做的事情的一种方法是实现一个 DeleteEvent-listener，它在 nhibernate 决定删除实体时触发。从那里，基于某些逻辑（通常您在实体上查找接口），您可以决定是要硬删除还是软删除实体。如果您要软删除它，您可以更新“IsDeleted”、“DeletedAt”、“DeletedBy”等属性。

可以在以下位置找到一篇很好的博客文章，详细描述上述内容：[NHibernate 常见问题解答 - 软删除](https://web.archive.org/web/20090209010820/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/04/08/soft-deletes.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T17:19:54.010

你能用[拦截器做到这一点吗](https://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/manipulatingdata.html#manipulatingdata-interceptors)

```
 public void OnDelete(object entity,
                         object id,
                         object[] state,
                         string[] propertyNames,
                         IType[] types)
    {
        // if entity is myentity 
        // update user property
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T17:30:50.057

Hibernate 将尝试用您的实体中的值自动替换“？”。当您调用`session.Delete(entity)`它时，它将使用映射到 PPDID 列的属性的值。

话虽如此，我认为在这种情况下使用自定义 sql 语句是一个坏主意。恕我直言，您的代码将难以理解和维护。当有人看到时，`session.Delete(entity)`他会期望执行 DELETE 语句，但它会得到一个 UPDATE 语句。我会坚持`session.Update(entity)`之前设置正确的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-11T23:19:44.313

但是在持久化操作中包含业务规则并不是一个好的方法。您的业​​务必须独立于删除等持久性操作。

# java - Java JTabbedPane，如何从按钮中选择选项卡？

> ID：916948
> 
> 赞同：7
> 
> 时间：2009-05-27T17:07:08.340
> 
> 标签：java, swing, jtabbedpane

如何像单击按钮一样选择选项卡？我已经用谷歌搜索并查看了所有操作，但只有这么多...... :(

有人知道手吗？

提前致谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T17:44:04.740

将动作侦听器添加到调用 setSelectedComponent 或 JTabbedPane 上的 setSelectedIndex 的按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T17:14:15.207

我不确定您对按钮的含义，但您可能正在寻找[`setSelectedComponent`](http://java.sun.com/javase/6/docs/api/javax/swing/JTabbedPane.html#setSelectedComponent(java.awt.Component))或[`setSelectedIndex`](http://java.sun.com/javase/6/docs/api/javax/swing/JTabbedPane.html#setSelectedIndex(int))。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-02T09:34:18.677

如果您的 jtabbedpane 的名称是 mytabbedpane，则如下所示：

```
mytabbedpane.getSelectedIndex(); 
```

它返回该选项卡的 int (0,1 .. n) 或

```
mytabbedpane.getSelectedComponent(); 
```

它返回选项卡名称的字符串（“Firts tab”，“Second tab”，...）。

如果您想将“getSelectedComponent()”用于布尔逻辑，您应该编写如下内容：

```
if (mytabbedpane.getSelectedComponent().equals("First tab")) {
     //code here
} 
```

对于“getSelectedIndex()”，当然是：

```
if (mytabbedpane.getSelectedIndex() == 0) {
     //code here
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-23T18:35:02.633

双击按钮，输入以下代码

```
JTabbedPane.setSelectedIndex(1); 
```

选项卡从 0 到 N 从左到右顺序开始

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-16T18:48:31.177

试试这个代码：

```
tabbedPane.addTab(tabName, component);
int count = tabbedPane.getTabCount();
tabbedPane.setSelectedIndex(count-1); 
```

# python - 是否有某个地方不兼容 64 位的 Python 包列表？

> ID：916952
> 
> 赞同：3
> 
> 时间：2009-05-27T17:07:22.350
> 
> 标签：python, 64-bit, packages

我将迁移到 64 位机器和 64 位操作系统 (Windows)，并试图弄清楚我正在使用的任何扩展/包是否会在我迁移时丢失。我似乎无法找到是否有人建立了 Python 2.5 [发布页面](http://www.python.org/download/releases/2.5/)上标记的已知问题列表。我一直在使用 2.5，但此时将移至 2.6。我看到由于模块依赖于在 64 位环境中不兼容的 C 扩展模块，因此会出现潜在的冲突。但我不知道如何预测它们。我想迁移到 64 位系统，因为我的 IT 人员告诉我，这是在内存阶梯上进行有意义的迁移的唯一方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T17:15:06.767

我们在 64 位 Red Hat Enterprise Linux 服务器上运行 2.5。

一切似乎都在工作。

我会建议你做我们所做的。

1.  获取虚拟机。

2.  加载应用程序。

3.  测试一下。

这比尝试做研究容易。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T17:09:48.787

也许您应该弄清楚“在记忆阶梯上进行有意义的提升”是什么意思。您目前是否需要处理超过 4GB 的 RAM？如果没有，那么您不需要 64 位系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T17:23:28.697

这实际上取决于您使用的特定模块。我正在运行几个 64 位 Linux 系统，但我使用的任何 C 模块都没有遇到问题。

大多数 C 模块都可以从源代码构建，因此您应该阅读 Python 分发实用程序[distutils](http://docs.python.org/install/index.html#install-index)以了解在找不到 64 位二进制文​​件时如何构建这些模块。

特定模块是否可以在 64 位环境中工作取决于代码的编写方式。许多模块在编译为 64 位时可以正常工作，但也有可能无法正常工作。许多流行的模块，例如来自[SciPy](http://www.scipy.org/)的模块都可以正常工作。

简而言之，您要么只需要在 64 位系统上尝试该模块，要么必须找到开发人员/项目页面并确定是否存在 64 位构建或是否存在已知错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T17:39:22.847

似乎您已经知道这一点，但为了完整起见，值得指出。话虽如此，请记住，纯 Python 包不应该有任何问题。

*其次，您也*不必安装 64 位版本的 Python，除非您计划运行一个占用超过 4 GB 内存的程序。32 位版本的 Python 应该可以在 64 位窗口上完美运行。

# linux - 如何查找某个进程正在操作哪些文件？

> ID：916954
> 
> 赞同：1
> 
> 时间：2009-05-27T17:07:35.220
> 
> 标签：linux, bash, rsyslog

就我而言，它是“rsyslogd”，

我发现它消耗了高达170M的内存，这太多了，

我检查了它位于 /etc/rsyslog.conf 的配置文件

然后检查其中写入的每个文件，

但徒劳无功。

我如何查找它当前正在操作的文件并查看里面发生了什么？

```
[root@slvdb2 log]# lsof -p `pidof rsyslogd`
COMMAND   PID USER   FD   TYPE             DEVICE    SIZE       NODE NAME
rsyslogd 1965 root  cwd    DIR                8,1    4096          2 /
rsyslogd 1965 root  rtd    DIR                8,1    4096          2 /
rsyslogd 1965 root  txt    REG                8,1  259072    2818209 /sbin/rsyslogd
rsyslogd 1965 root  mem    REG                8,1  142176    1097807 /lib64/ld-2.8.so
rsyslogd 1965 root  mem    REG                8,1 1804136    1097817 /lib64/libc-2.8.so
rsyslogd 1965 root  mem    REG                8,1  143096    1097871 /lib64/libpthread-2.8.so
rsyslogd 1965 root  mem    REG                8,1   88976    1097890 /lib64/libz.so.1.2.3
rsyslogd 1965 root  mem    REG                8,1   93416    1097834 /lib64/libgcc_s-4.3.0-20080428.so.1
rsyslogd 1965 root  mem    REG                8,1   53448    1097874 /lib64/librt-2.8.so
rsyslogd 1965 root  mem    REG                8,1   23208    1098015 /lib64/libdl-2.8.so
rsyslogd 1965 root  mem    REG                8,1   11368    4720595 /usr/lib64/rsyslog/imuxsock.so
rsyslogd 1965 root  mem    REG                8,1   23560    4720591 /usr/lib64/rsyslog/imklog.so
rsyslogd 1965 root  mem    REG                8,1   57808    1097853 /lib64/libnss_files-2.8.so
rsyslogd 1965 root  mem    REG                8,1   19504    4720596 /usr/lib64/rsyslog/lmnet.so
rsyslogd 1965 root  mem    REG                8,1    8584    4720598 /usr/lib64/rsyslog/lmtcpclt.so
rsyslogd 1965 root    0u  unix 0xffff880008a31c40            3909712 /dev/log
rsyslogd 1965 root    1w   REG                8,1     435    4014282 /var/log/messages
rsyslogd 1965 root    2w   REG                8,1 7723905    4014355 /var/log/secure
rsyslogd 1965 root    3w   REG                8,1       0    4014356 /var/log/maillog
rsyslogd 1965 root    4w   REG                8,1   58959    4014359 /var/log/cron
rsyslogd 1965 root    5w   REG                8,1       0    4014357 /var/log/spooler
rsyslogd 1965 root    6w   REG                8,1       0    4014358 /var/log/boot.log
rsyslogd 1965 root    7r   REG                0,3       0 4026531849 /proc/kmsg 
```

没有从上述文件中得到任何线索..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T17:13:34.350

```
lsof -p `pidof rsyslogd` 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T17:08:59.803

lsof 和 fuser 一样非常方便。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T17:48:28.303

您断言 rsyslogd 正在使用“太多”内存 (170MB)。与什么相比太多了？

首先，从阅读这篇[文章](https://stackoverflow.com/questions/131303/linux-how-to-measure-actual-memory-usage-of-an-application-or-process)开始。很可能 rsyslogd 没有使用您想象的那么多内存。如果你仍然认为它是，去了解[rsyslogd](http://www.rsyslog.com/)。您可能还想[浏览源代码](http://git.adiscon.com/?p=rsyslog.git;a=summary)。

完成更多分析后，您可能希望与 rsyslogd 开发人员展开对话，他们可能更适合回答您的问题。

顺便说一句，多次问同一个问题是一种糟糕的形式——你最好编辑[原始问题](https://stackoverflow.com/questions/912171/is-it-normal-for-rsyslogd-to-cost-170m-memory)。

就个人而言，鉴于您的主要问题似乎是“网站性能”（可能是网站），我建议先查看为网站本身提供服务的软件，然后再关注数百万使用的关键操作系统进程服务器每天。是的，问题可能是 rsyslogd 正在尝试将日志消息写入需要轮换的大文件，但它更有可能是为每个请求动态生成的内容，当它可以（并且应该）被缓存时。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T17:12:34.353

`lsof -p <pid>`应该做的伎俩。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T17:13:02.620

您可以了解该进程已在其中打开的文件`/proc/[pid_of_process]/fd/`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T17:20:08.363

应该做的伎俩：

```
/usr/sbin/lsof | grep rsyslogd 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T17:13:39.093

如果您想“查看内部”流程并查看“发生了什么”，您将需要使用类似 strace 的东西。

# php - Python OOP 与 PHP OOP 相比如何？

> ID：916962
> 
> 赞同：17
> 
> 时间：2009-05-27T17:09:28.213
> 
> 标签：php, python, oop, comparison

我基本上想知道 Python 是否像 PHP 那样有任何 OOP 缺点。PHP 一直在为最近几个版本开发他们的 OOP 实践。它在 PHP 中变得越来越好，但仍然不完美。我是 Python 的新手，我只是想知道 Python 的 OOP 支持是否更好或只是可比的。

如果 Python OOP 中有一些问题没有遵循正确的 OOP 实践，我肯定想知道这些。例如，据我所知，PHP 不允许多重继承。

谢谢大家！

编辑：对公共和私人的支持怎么样？或支持变量类型。我认为这些对于构建 OOP 软件很重要。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-27T17:12:51.513

我想说的是，Python 的 OOP 支持要好得多，因为它在语言的初期就被引入到语言中，而不是 PHP 将 OOP 固定在现有的过程模型上。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T17:21:57.063

Python 的 OOP 支持非常强大；它确实允许多重继承，并且一切都可以作为一流的对象（包括类、方法等）进行操作。

多态性通过鸭子类型来表达。例如，您可以以相同的方式迭代列表、元组、字典、文件、Web 资源等等。

有很多迂腐的小东西可能不是面向对象的，比如使用 len(list) 而不是 list.len() 获取序列的长度，但最好不要担心它们。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-27T17:56:20.880

Python OOP 模型的一个不同寻常的方面是它的封装机制。基本上，Python 假定程序员不会做坏事，因此它不会在任何程度上保护私有成员变量或方法。

它通过修改以两个下划线开头并以少于两个下划线结尾的成员名称来工作。这样的标识符到处都在更改，因此它们的类名前面加上了一个额外的下划线。因此：

```
class foo:
    def public(self):
        return self.__private()
    def __private(self):
        return 5

print foo().public()
print foo()._foo__private() 
```

以两个（或更多）下划线开头和结尾的名称不会被破坏，因此`__init__`python 用于构造新实例的方法被单独保留。

这是一个更详细地解释它的[链接。](http://docs.python.org/tutorial/classes.html#private-variables)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T17:16:37.323

我认为他们在这一点上是可比的。作为一个简单的测试，我怀疑[Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0201633612)或[Patterns of Enterprise Application Architecture](https://rads.stackoverflow.com/amzn/click/com/0321127420)中的任何模式，可以说是 OOP 中最有影响力的两本书，这两种语言都不可能实现。

这两种语言自幼年以来就突飞猛进。

就多重继承而言，它通常[会产生比它解决的问题更多的问题，而且如今](http://en.wikipedia.org/wiki/Diamond_problem)，作为有意的设计决策，它通常被排除在语言之外。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-27T17:35:30.343

另外：与 PHP 不同，Python 具有本机运算符重载（尽管它确实存在扩展）。爱它或恨它，它就在那里。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T17:35:45.710

如果您正在寻找“更纯粹”的 OOP，您应该关注 SmallTalk 和/或 Ruby。

随着对 OOP 的支持，PHP 有了很大的发展，但是由于它的工作方式（每次都重新加载所有内容），如果遵循 OOP 最佳实践，事情会变得非常缓慢。这是您很少听说过 PHP on Rails 的原因之一。

# java - Java 中的“调用者”是否与 Ruby 中的“接收者”相同？

> ID：916969
> 
> 赞同：6
> 
> 时间：2009-05-27T17:12:09.797
> 
> 标签：java, ruby, terminology

如果我说

```
x.hello() 
```

在 Java 中，对象 x 正在“调用”它包含的方法。

在 Ruby 中，对象 x 正在“接收”它包含的方法。

这只是表达相同想法的不同术语，还是这里的意识形态存在根本差异？

来自 Java 的我发现 Ruby 的“接收器”想法非常令人费解。也许有人可以用 Java 来解释这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T17:17:53.297

在您的示例`x`中*没有*调用`hello()`. 包含该片段的任何对象都是“调用”（即，它是“调用者”）。在Java中，`x`可以称为接收者；它正在接收对该`hello()`方法的调用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T19:11:49.917

区别不仅仅是术语。在Java 中，VM 确定给定对象是否“接受”您尝试发送的消息（即您尝试调用的方法）。如果对象的类型空间没有定义该方法，则会引发异常并且永远不会传递消息。

在 Ruby 中，消息**总是**被传递。对象可能会找到与之匹配的方法，也可能不会，在后一种情况下，它可能会抛出异常，*也可能不会*。Rails 就是建立在这个根本区别之上的。这就是为什么在 Java 平台上还没有像 Rails 一样有用的由 DB 支持的 Web 应用程序框架的原因之一（尽管有些已经接近了）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T17:17:40.770

如果我错了，请有人纠正我，但我认为您不能将这些术语应用于 Java。Ruby 来自 Smalltalk，它使用*消息*（而不是方法）在对象之间进行通信。从技术上讲，当您`myObj.to_s`在 Ruby 中执行此操作时，您将`to_s`消息发送到`myObj`并且它会相应地对该消息进行操作。使用该模型，`myObj`确实是此消息的接收者，而拥有发送消息的线路的类是发送者。

在 Java 中，这不存在。您有可以调用方法的对象。没有发送者和接收者。当您说意识形态存在根本差异时，您说得对。

# apache-flex - Flex：当对象有焦点突出显示父对象时？

> ID：916970
> 
> 赞同：1
> 
> 时间：2009-05-27T17:12:18.940
> 
> 标签：apache-flex

我在 HBox 对象中有一个 TextInput 和一个 Canvas 对象。当输入文本字段具有焦点时，它会突出显示，我想将其更改为包含 HBox，当输入文本具有焦点时突出显示。

有没有人对我如何做到这一点有任何想法？

这是我的代码：

```
<mx:HBox 
        keyDown="checkKey(event)" 
        horizontalGap="0">
        <mx:TextInput 
            id="searchBox" 
            width="500" 
            fontSize="25" 
            backgroundColor="#F0F0F0" 
            borderThickness="2" 
            borderColor="#666666" 
            borderStyle="solid"/>
        <mx:Canvas 
            borderThickness="2" 
            borderColor="#666666" 
            borderStyle="solid" 
            backgroundColor="#666666">
            <mx:Button 
                label="Search" 
                click="searchInputText()" 
                fontSize="21" 
                styleName="primaryButton"/>
        </mx:Canvas>
    </mx:HBox> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T17:37:19.420

我不认为 HBoxes 默认启用突出显示。但是您可以让 HBox 响应 focusIn 事件：将过滤器的 alpha 设置为 0 使其完全透明。

```
<mx:HBox 
    name="parentHBox"
    keyDown="checkKey(event)" 
    horizontalGap="0">
    <mx:filters>
        <mx:GlowFilter alpha=0.0>
    </mx:filters>
    <mx:TextInput 
            id="searchBox" 
            ...
            focusIn="{HBoxGlowFilter.alpha = 1.0}"
            focusOut="{HBoxGlowFilter.alpha = 0.0}"/>
    <mx:Canvas 
            ...>
            <mx:Button 
                    label="Search" 
                    click="searchInputText()" 
                    fontSize="21" 
                    styleName="primaryButton"/>
    </mx:Canvas>
</mx:HBox> 
```

希望这可以帮助。

# c++ - 使用 C++ MFC 进行递归文件搜索？

> ID：916973
> 
> 赞同：3
> 
> 时间：2009-05-27T17:12:36.503
> 
> 标签：c++, mfc, recursion, file-search

使用 C++ 和 MFC 递归搜索文件的最简洁方法是什么？

编辑：这些解决方案中的任何一个都提供通过一次通过使用多个过滤器的能力吗？我想用 CFileFind 我可以过滤 *.* 然后编写自定义代码以进一步过滤到不同的文件类型。有没有提供内置的多个过滤器（即*.exe、*.dll）？

EDIT2：刚刚意识到我所做的一个明显假设使我之前的 EDIT 无效。如果我尝试使用 CFileFind 进行递归搜索，我必须使用 *.* 作为我的通配符，否则子目录将不会匹配并且不会发生递归。因此，无论如何都必须单独处理对不同文件扩展名的过滤。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-27T17:16:21.753

使用[`CFileFind`](http://msdn.microsoft.com/en-us/library/f33e1618(VS.80).aspx).

看看 MSDN 中的这个[例子](http://msdn.microsoft.com/en-us/library/scx99850(VS.80).aspx)：

```
void Recurse(LPCTSTR pstr)
{
   CFileFind finder;

   // build a string with wildcards
   CString strWildcard(pstr);
   strWildcard += _T("\\*.*");

   // start working for files
   BOOL bWorking = finder.FindFile(strWildcard);

   while (bWorking)
   {
      bWorking = finder.FindNextFile();

      // skip . and .. files; otherwise, we'd
      // recur infinitely!

      if (finder.IsDots())
         continue;

      // if it's a directory, recursively search it

      if (finder.IsDirectory())
      {
         CString str = finder.GetFilePath();
         cout << (LPCTSTR) str << endl;
         Recurse(str);
      }
   }

   finder.Close();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T17:14:19.183

使用[Boost 的文件系统](http://www.boost.org/doc/libs/release/libs/filesystem/doc/index.htm)实现！

递归示例甚至在文件系统主页上：

```
bool find_file( const path & dir_path,         // in this directory,
                const std::string & file_name, // search for this name,
                path & path_found )            // placing path here if found
{
  if ( !exists( dir_path ) ) return false;
  directory_iterator end_itr; // default construction yields past-the-end
  for ( directory_iterator itr( dir_path );
        itr != end_itr;
        ++itr )
  {
    if ( is_directory(itr->status()) )
    {
      if ( find_file( itr->path(), file_name, path_found ) ) return true;
    }
    else if ( itr->leaf() == file_name ) // see below
    {
      path_found = itr->path();
      return true;
    }
  }
  return false;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T17:27:33.683

我知道这不是你的问题，但也很容易通过使用`CStringArray`

```
void FindFiles(CString srcFolder)
{   
  CStringArray dirs;
  dirs.Add(srcFolder + "\\*.*");

  while(dirs.GetSize() > 0) {
     CString dir = dirs.GetAt(0);
     dirs.RemoveAt(0);

     CFileFind ff;
     BOOL good = ff.FindFile(dir);

     while(good) {
        good = ff.FindNextFile();
        if(!ff.IsDots()) {
          if(!ff.IsDirectory()) {
             //process file
          } else {
             //new directory (and not . or ..)
             dirs.InsertAt(0,nd + "\\*.*");
          }
        }
     }
     ff.Close();
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T23:53:12.750

查看[recls](http://www.recls.org/)库 - 代表*recursive* *ls* - 这是一个适用于 UNIX 和 Windows 的递归搜索库。它是一个 C 库，可以适应不同的语言，包括 C++。从内存中，您可以使用如下内容：

```
using recls::search_sequence;

CString dir = "C:\\mydir";
CString patterns = "*.doc;abc*.xls";
CStringArray paths;
search_sequence files(dir, patterns, recls::RECURSIVE);

for(search_sequence::const_iterator b = files.begin(); b != files.end(); b++) {
    paths.Add((*b).c_str());
} 
```

它会在 C:\mydir 或其任何子目录中找到所有 .doc 文件和所有以 abc 开头的 .xls 文件。

我还没有编译这个，但它应该非常接近标记。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-04-10T06:00:13.080

```
CString strNextFileName , strSaveLog= "C:\\mydir";
Find.FindFile(strSaveLog);
BOOL l = Find.FindNextFile();
if(!l)
    MessageBox("");
strNextFileName = Find.GetFileName(); 
```

它不工作。即使文件存在于同一目录中，Find.FindNextFile() 也会返回 false ``

# python - Python相当于maplist？

> ID：916978
> 
> 赞同：12
> 
> 时间：2009-05-27T17:13:40.183
> 
> 标签：python, functional-programming, lisp

`maplist`Common Lisp函数的最佳 Python 等价物是什么？从[地图列表文档](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/fun_mapccm_ma_istcm_mapcon.html)：

> maplist 类似于 mapcar，只是该函数应用于列表的连续子列表。函数首先应用于列表本身，然后应用于每个列表的 cdr，然后应用于每个列表的 cdr 的 cdr，依此类推。

示例（伪代码，未经测试）：

```
>>> def p(x): return x
>>> maplist(p, [1,2,3])
[[1, 2, 3], [2, 3], [3]] 
```

**注意**：上例中传递给的参数`p`是列表`[1, 2, 3]`, `[2, 3]`, `[3]`; 即，`p`不适用于这些列表的元素。例如：

```
>>> maplist(lambda l: list(reversed(l)), [1,2,3])
[[3, 2, 1], [3, 2], [3]] 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T17:29:30.840

您可以为此编写一个小函数

```
def maplist(func, values):
    return [map(func, values[i:]) for i in xrange(len(values))]

>>> maplist(lambda a: a* 2, [1,2,3])
[[2, 4, 6], [4, 6], [6]] 
```

**[编辑]**

如果要在子列表上应用该函数，可以将函数更改为：

```
def maplist(func, values):
    return [func(values[i:]) for i in xrange(len(values))]

>>> maplist(lambda l: list(reversed(l)), [1,2,3])
[[3, 2, 1], [3, 2], [3]] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T20:39:28.320

正如@Cybis 和其他人所提到的，你不能用 Python 列表来保持 O(N) 的复杂性；您必须创建一个链接列表。冒着证明[Greenspun 的第 10 条规则](http://en.wikipedia.org/wiki/Greenspun%27s_Tenth_Rule)的风险，这里有这样一个解决方案：

```
class cons(tuple):
    __slots__=()

    def __new__(cls, car, cdr):
        return tuple.__new__(cls, (car,cdr))

    @classmethod
    def from_seq(class_, l):
        result = None
        for el in reversed(l):
            result = cons(el, result)
        return result

    @property
    def car(self): return self._getitem(0)

    @property
    def cdr(self): return self._getitem(1)

    def _getitem(self, i):
        return tuple.__getitem__(self, i)

    def __repr__(self):
        return '(%s %r)' % (self.car, self.cdr)

    def __iter__(self):
        v = self
        while v is not None:
            yield v.car
            v = v.cdr

    def __len__(self):
        return sum(1 for x in self)

    def __getitem__(self, i):
        v = self
        while i > 0:
            v = v.cdr
            i -= 1
        return v.car

def maplist(func, values):
    result = [ ]
    while values is not None:
        result.append(func(values))
        values = values.cdr
    return result 
```

测试结果：

```
>>> l = cons.from_seq([1,2,3,4])
>>> print l
(1 (2 (3 (4 None))))
>>> print list(l)
[1, 2, 3, 4]
>>> print maplistr(lambda l: list(reversed(l)), cons.from_seq([1,2,3]))
[[3, 2, 1], [3, 2], [3]] 
```

编辑：这是一个基于生成器的解决方案，它基本上解决了相同的问题，而不使用链表：

```
import itertools

def mapiter(func, iter_):
    while True:
        iter_, iter2 = itertools.tee(iter_)
        iter_.next()
        yield func(iter2) 
```

测试结果：

```
>>> print list(mapiter(lambda l: list(reversed(list(l))), [1,2,3]))
[[3, 2, 1], [3, 2], [3]] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T19:13:39.350

Eewww... 对列表进行切片是一种线性时间操作。迄今为止发布的所有解决方案都具有 O(n^2) 时间复杂度。我相信 Lisp 的 maplist 有 O(n)。

问题是，Python 的列表类型不是链表。它是一个可动态调整大小的数组（即，像 C++ STL 的“向量”类型）。

如果保持线性时间复杂度对您很重要，则不可能在 Python 列表上创建“maplist”函数。最好修改代码以使用列表中的索引，或者将列表转换为实际的链表（仍然是线性时间操作，但会产生很多开销）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-18T10:09:18.980

Python 有一个链表类型，称为`deque`：

```
from collections import deque

def maplist(f, lst):
    linked = deque(lst)
    results = []
    while linked:
        results.append(f(linked))
        linked.popleft() # assumes left is head, as in lisp

    return results

In [134]: maplist(lambda l: list(reversed(l))*2, [1,2,3])
Out[134]: [[3, 2, 1, 3, 2, 1], [3, 2, 3, 2], [3, 3]] 
```

线性时间，做同样的事情，将具有与对 lisp 列表的操作相同的性能特征（即修改内部元素将与被修改列表的长度呈线性关系）和相同的语义（即，如果`f`修改列表，它会修改它用于`f`该调用中的所有后续执行`maplist`；但是，因为这会创建 的副本`lst`，`f`所以不能修改`lst`，这与 Common Lisp 不同）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T17:34:11.080

这就像你的例子（我修改了 reyjavikvi 的代码）

```
def maplist(func, l):
    result=[]
    for i in range(len(l)):
        result.append(func(l[i:]))
    return result 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T17:35:27.003

您可以使用嵌套列表推导：

```
>>> def p(x): return x
>>> l = range(4)[1:]
>>> [p([i:]) for i in range(len(l))]
[[1, 2, 3], [2, 3], [3]] 
```

您可以使用它自己定义 maplist：

```
>>> def maplist(p, l): return [p([i:]) for i in range(len(l))]
>>> maplist(p, l)
[[1, 2, 3], [2, 3], [3]] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T18:23:34.380

修改亚伦的回答：

```
In [8]: def maplist(p, l): return [p([x for x in l[i:]]) for i in range(len(l))]
   ...: 

In [9]: maplist(lambda x: x + x, [1,2,3])
Out[9]: [[1, 2, 3, 1, 2, 3], [2, 3, 2, 3], [3, 3]] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-29T11:40:27.443

### `maplist()`链表的 O(N) 实现

```
maplist = lambda f, lst: cons(f(lst), maplist(f, cdr(lst))) if lst else lst 
```

请参阅[Python 链接列表](https://stackoverflow.com/questions/280243/python-linked-list)问题。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-05-27T17:30:23.630

我认为没有，但以下功能可以工作：

```
def maplist(func, l):
    for i in range(len(l)):
        func(l[i:]) 
```

# python - Windows 和 Linux 之间的 WxPython 差异

> ID：916987
> 
> 赞同：1
> 
> 时间：2009-05-27T17:16:34.750
> 
> 标签：python, windows, linux, user-interface, wxpython

我在 WxPython 上找到的教程都使用了来自 Linux 的示例，但在某些细节上似乎存在差异。

例如，在 Windows 中，小部件后面必须有一个面板才能正确显示背景。此外，教程中看起来不错的一些示例在我的计算机中不起作用。

那么，你知道有哪些重要的区别，或者可能是一个专注于 Windows 的好教程吗？

**编辑：**我只记得这一点：有人知道为什么在子类化 wx.App 时需要 OnInit() 方法，而不是更合乎逻辑的`__init__`()？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T17:38:02.040

我注意到我不久前写的一个小 GUI 中有一些奇怪的特性，但是自从我尝试这些细节已经很长时间了，这些细节是一个相当遥远的记忆。你有一些失败的具体例子吗？也许我们可以改进它们并修复错误？

您是否尝试[过官方的 wxPython 教程](http://www.wxpython.org/tut-part1.php)？...或者你是在追求更具体的东西吗？

**重新编辑**- 你应该使用`OnInit()`，因为你是[wx.App](http://docs.wxwidgets.org/stable/wx_wxapp.html#wxapponinit)的子类（即它是 wxWidgets 而不是 Python 的要求），并且 wxPython 实现是尽可能的，只是 wxWidgets 的包装器。

**[编辑]** Zetcode 有[一个相当长的 wxPython 教程](http://zetcode.com/wxpython/)。我自己没有仔细看过，但它可能会有所帮助？

[`wxWidgets::wxApp::OnInit()`](http://docs.wxwidgets.org/stable/wx_wxapp.html#wxapponinit)文档相当清楚：

> 这必须由应用程序提供，通常会创建应用程序的主窗口，可选择调用 wxApp::SetTopWindow。您可以使用 OnExit 清理此处初始化的任何内容，前提是该函数返回 true。

如果 wxWidgets 没有提供通用接口，那么与 Python 的`__init__(self,...)`. 使用独立于语言的初始化允许 wxWidgets 端口到其他语言看起来更相似，这应该是件好事吧？:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T17:33:12.173

> **编辑：** 我只记得这一点：有人知道为什么在子类化 wx.App 时需要 OnInit() 方法，而不是更合乎逻辑的方法`__init__()`吗？

我`OnInit()`用于对称：还有一种`OnExit()`方法。

编辑：我可能错了，但我认为`OnInit()`不需要使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T16:11:54.173

我发现了一些小的差异，但不记得所有的。这里有两个：

1) 布局可能会略有不同，例如，当在另一个操作系统中执行时，会导致事物不能完全适合在一个操作系统中的窗口中。我还没有调查过这种情况的原因，但是当我使用位置而不是大小来安排事情时，最常发生这种情况。

2）我必须`Refresh`在 Windows 中明确调用更多。例如，如果您将一个面板放在另一个面板上，则在您调用 Refresh 之前，您不会看到它在 Windows 中的顶部面板。

我一般来说，我在 Linux 中编写应用程序并在 Windows 中运行它们，并且事情的工作方式非常相似，所以这是一种合理的方法，但对我来说，在操作系统切换后完全直接运行的情况很少见。``*`