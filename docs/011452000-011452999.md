# StackOverflow 问答 11452000-11452999

# php - 在 PHP 中测量总网站加载时间

> ID：11452003
> 
> 赞同：1
> 
> 时间：2012-07-12T12:35:52.247
> 
> 标签：php, web-applications, time, benchmarking, microtime

我正在寻找一种方法来测量 php 中（HTTP）Web 请求的每个步骤，类似于 Firebug 的时间线或[http://tools.pingdom.com](http://tools.pingdom.com)。我可以使用计时器来测量 Web 请求，但我正在寻找 PHP 中的一些函数，它可以将总加载时间拆分到每个部分。

例如，如果我有一个提供 URL 的文本框，那么我想显示一个网页需要多长时间来加载，按以下方式拆分：连接时间、DNS 时间、发送和等待和接收时间。

我想要这些统计数据来优化我的网站。我正在寻找用 PHP 编写代码。

我已经查看了在`Microtime()`脚本的开头和结尾使用`curl()`两者之间的 a ，然后计算加载所需的时间，但这是 PHP 完成输出所需的时间，而不是加载所有所需的时间图像和 CSS。我的问题是，这些时间不是 tools.pingdom.com 或 firebug 返回的。

我用 DOM 提取 css、图像和 js 标签。然后用 curl 或 file_get_content 加载它们。总时间为（开始时间-结束时间）。但它显示一个错误的时间！

我还看到了[用于获取文件大小和页面加载时间的 PHP 函数](https://stackoverflow.com/questions/3714909/php-function-for-getting-file-size-and-loading-time-for-a-page)）。它问的和我的问题一样，但没有人说我们如何计算这个时间。有什么功能可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:45:44.833

我不知道有任何 PHP API 可以提供页面加载速度分析的详细信息。我知道可以帮助您开发上述功能的最接近的框架是“Google Page Insight”。

它可作为 Firefox、Chrome 中的插件使用，也可作为在线服务使用。Google Page Insight 还提供 Apache HTTP 服务器插件和 API 来开发您自己的应用程序：

请找到相同的网址：

简介页面：[https](https://developers.google.com/speed/pagespeed/insights) ://developers.google.com/speed/pagespeed/insights 开发者指南：[https ://developers.google.com/speed/docs/insights/v1/getting_started](https://developers.google.com/speed/docs/insights/v1/getting_started)

# c# - C# 从递归函数追加到 XML 文件中

> ID：11452006
> 
> 赞同：1
> 
> 时间：2012-07-12T12:36:09.207
> 
> 标签：c#, xml, file, recursion, append

我正在尝试创建一个包含文件夹和文件描述的 XML 文件。我使用递归方法浏览文件夹内容，我想在每次调用时附加数据。

这是我使用的代码：

```
 DataSet ds = new DataSet("Folders");
        ds.Tables.Add(Folder);
        ds.Tables.Add(Files);
        ds.WriteXml(AppDomain.CurrentDomain.BaseDirectory + "\\FolderList.xml"); 
```

您能否告诉我如何在 xml 文件底部的每个函数调用数据处继续添加？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:51:47.343

```
string rootPath = @"......";
XElement xRoot = new XElement("Root",new XAttribute("Path",rootPath));
RecurseDirs(rootPath, xRoot);
var xmlString = xRoot.ToString();

void RecurseDirs(string root, XElement xRoot)
{
    foreach (var dir in Directory.EnumerateDirectories(root))
    {
        XElement xdir = new XElement("Directory",
                                        new XAttribute("Name",Path.GetFileName(dir)),
                                        new XAttribute("CreationTime",Directory.GetCreationTime(dir)));
        xRoot.Add(xdir);
        RecurseDirs(dir,xdir);
    }

    foreach (var dir in Directory.EnumerateFiles(root))
    {
        XElement xfile = new XElement("File", 
            new XAttribute("Name", Path.GetFileName(dir)),
            new XAttribute("CreationTime", File.GetCreationTime(dir)));
        xRoot.Add(xfile);
    }
} 
```

# asp.net - 在 Global.asax 文件中创建计时器

> ID：11452011
> 
> 赞同：5
> 
> 时间：2012-07-12T12:36:22.593
> 
> 标签：asp.net, vb.net, timer, global-asax

**我想每一个小时执行一个存储过程，并且必须通过在 Global.asax 文件中创建计时器**来将数据集加载到应用程序（dropdrown 或一些 asp.net 控件）中。

对于这种开发来说是非常新的，请任何人都可以发布代码或提供我在编码中必须做的确切流程以及如何加载 asp.net 控件（下拉或列表控件）。

先感谢您，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T12:43:04.687

像这样的调度任务不适用于 aspx 应用程序。

但是，您可以尝试几种技巧/解决方法：

[http://www.codeproject.com/Articles/12117/Simulate-a-Windows-Service-using-ASP-NET-to-run-sc](http://www.codeproject.com/Articles/12117/Simulate-a-Windows-Service-using-ASP-NET-to-run-sc)

[http://www.west-wind.com/weblog/posts/2007/May/10/Forcing-an-ASPNET-Application-to-stay-alive](http://www.west-wind.com/weblog/posts/2007/May/10/Forcing-an-ASPNET-Application-to-stay-alive)

[http://www.mikesdotnetting.com/Article/129/Simple-task-Scheduling-using-Global.asax](http://www.mikesdotnetting.com/Article/129/Simple-task-Scheduling-using-Global.asax)

您最好创建 Windows 服务或使用内置的 Windows 调度程序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-12T12:44:44.407

ASP.NET 是不适合这项工作的工具。

从设计上讲，Web 应用程序是一个请求-响应系统。它侦听请求、处理这些请求并返回响应。在该范围之外，应该假设应用程序没有运行。（实际上，IIS 可能会出于多种原因关闭应用程序，并在收到新请求时再次唤醒它。）

您想要的计划任务可能是[Windows Service](http://myhosting.com/blog/2010/09/creating-windows-service-visual-studio-2010/)。这旨在在服务器的后台运行。包含一个计时器非常简单，它可以运行任务以响应该计时器的滴答事件。

想一想……当计时器滴答作响时， Web 应用程序*会做什么？*如果它正在执行后台进程而不实际响应 Web 请求，它将如何“将数据加载到某个 asp.net 控件中”？如果没有请求页面，就*没有*页面可以显示给用户。

我想这会起作用的方式是 Windows 服务将读取一些数据，运行一些业务逻辑来转换该数据，并将转换后的数据写入数据库中的另一个表或一组表。然后，Web 应用程序在填充其页面上的控件时将始终引用该其他表或表集。从本质上讲，Web 应用程序*不知道*转换数据的后端过程。它只是显示最新转换的数据恰好是什么。

# .net - 有什么方法可以让 Rhino Mock 在运行时自动生成“Expect.Calls”？

> ID：11452015
> 
> 赞同：1
> 
> 时间：2012-07-12T12:36:43.577
> 
> 标签：.net, unit-testing, mocking, rhino-mocks, automocking

有什么方法可以让 Rhino Mock 在运行时自动生成“Expect.Calls”？

因此，如果我们将 Rhino 模拟拟人化，它会说……“根据这个设置，我将为我遇到的任何属于实现这些接口的类的方法生成一个 expect.call。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T17:05:31.043

您可以使用*RhinoMocks*[`dynamic mock`](http://ayende.com/wiki/Rhino+Mocks+Introduction.ashx)的概念来模拟整个接口实现，或者使用[RhinoMocks](http://blog.ploeh.dk/2010/11/13/RhinoMocksbasedAutomockingWithAutoFixture.aspx)可以帮助您。如果您能够为您的想法提供更清晰的示例，那么有人可以为您提供更好的解决方案。*[`autofixture`](http://blog.ploeh.dk/2010/08/19/AutoFixtureAsAnAutomockingContainer.aspx)*

# objective-c - 应用程序图标问题上的远程通知徽章

> ID：11452016
> 
> 赞同：1
> 
> 时间：2012-07-12T12:36:44.037
> 
> 标签：objective-c, ios, push-notification

Guyz 请帮助我了解徽章计数管理。我已经阅读了苹果指南，但不完全了解谁负责依靠图标进行管理？如果我的应用程序不是前台，我会收到警报（图标上显示“1”）并且如果我点击查看我的应用程序正在启动并且我减少了 badgeCount：

```
[UIApplication sharedApplication].applicationIconBadgeNumber = [UIApplication sharedApplication].applicationIconBadgeNumber - 1; 
```

一个通知就可以了。但是我应该在哪里增加我的徽章数量？例如，如果我收到 2 或 3 个通知，我的应用程序图标上仍然有“1”……或者 iOS 是否应该自行增加该数量？

编辑：我已经发现服务器应该发送正确的号码，例如：

```
{
"aps" : {
    "badge" : 9
} 
```

}

但是，例如，如果我已经“阅读”了一些新闻并且当前数字不是“9”而是“7”，那么服务器如何知道正确的数字？我需要将该信息传递给服务器吗？请解释一下这是如何工作的！提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:49:53.570

当您的应用程序处于后台（暂停）或根本没有运行时，iOS 正在处理应用程序图标上的徽章，并将其设置为在通知有效负载中找到的数字。iOS 不会对通知进行任何计数。

当应用程序运行时，它负责徽章更新。在你的情况下，我认为它应该像邮件应用程序一样工作，所以应用程序应该告诉服务器用户已经阅读了一些东西，这样服务器就知道有多少新闻还没有被阅读，这样服务器就可以在应用程序再次进入后台并且有新消息。

[调度、注册和处理通知](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html#//apple_ref/doc/uid/TP40008194-CH103-SW4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:07:16.127

该主题已在 SO 上多次讨论，请查看以下链接，应该为您提供实现此功能的想法和限制：

[iPhone：自动增加徽章计数器](https://stackoverflow.com/questions/6212116/iphone-increment-badge-counter-automatically)

[推送通知徽章自动递增](https://stackoverflow.com/questions/1942605/push-notification-badge-auto-increment)

# java - Hibernate @AttributeOverrides 在多个属性上而不显式命名每个属性

> ID：11452017
> 
> 赞同：1
> 
> 时间：2012-07-12T12:36:44.933
> 
> 标签：java, hibernate, orm, seam, java-ee-6

设置：休眠 4.0 (JPA 2.0)、Java EE 6

我有以下问题：我有一个用 @Embeddable 注释的类“HandAttributes”，它包含很多布尔属性。在另一个类“人”中，我想**两次**嵌入这个类。这个想法是，“属性”类中的值表示“人”可以在其左右手上具有的属性。

据我了解@AttributeOverride 的可能性，我可以覆盖HandAttributes 类中的每个属性并给它们一个新的列名，即“BrokenNailRight”和“BrokenNailLeft”。但正如我所提到的，这些属性有很多，所以我宁愿不明确地覆盖它们。

是否有可能通过提供某种命名模式来覆盖 Embeddable 类中的**所有属性？**就像*将字符串“left”添加到所有列*或任何类似内容。

我希望这个问题是可以理解的，我期待您的任何想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T09:18:18.867

> 是否有可能覆盖 Embeddable 类中的所有属性？

我从来没有听说过这样的事情，我很确定这是不可能的。

您确定要*嵌入*这些对象吗？这会产生很多真正的静态代码，最好这样写：

```
public class Human {
Hand leftHand;
Hand rightHand;
...
} 
```

甚至

```
public class Alien {
Map<ConnectedBodyPart, Hand> hands
...
} 
```

这也应该启用`getBrokenNails()`...的通用版本

# codeigniter - 下载（大）文件：简单重定向与下载帮助程序

> ID：11452019
> 
> 赞同：0
> 
> 时间：2012-07-12T12:36:54.040
> 
> 标签：codeigniter

我有一个关于制作下载系统的问题。我过去做过一个，但它非常基本。我所做的是将下载的文件名添加到数据库中：

```
id | title     | filename
---|-----------|--------------
 1 | Something | something.zip 
```

然后，当用户访问 download.php?id=1 时，他将被简单地重定向到：*/path/to/downloads/something.zip*，使用：

```
header('Location: /path/to/downloads/something.zip'); 
```

这会导致浏览器自动开始下载。但是这样做可以吗？我正在使用 Codeigniter 构建一个下载系统，并且有一个下载助手可用。要提供下载，我需要：

```
$data = file_get_contents('/path/to/downloads/something.zip');
$name = 'Something';

force_download($name, $data); 
```

我注意到，由于 file_get_contents()，与简单的重定向相比，这种方式的下载速度较慢。我有一些大型下载（最大 1 GB）。你有什么建议？我应该使用 Codeigniter 下载帮助程序，直接使用重定向到文件还是其他方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:48:36.017

取自[php.net](http://php.net/manual/pt_BR/function.header.php)

```
function downloadFile( $fullPath ){ 

// Must be fresh start 
if( headers_sent() ) 
die('Headers Sent'); 

// Required for some browsers 
if(ini_get('zlib.output_compression')) 
ini_set('zlib.output_compression', 'Off'); 

// File Exists? 
if( file_exists($fullPath) ){ 

// Parse Info / Get Extension 
$fsize = filesize($fullPath); 
$path_parts = pathinfo($fullPath); 
$ext = strtolower($path_parts["extension"]); 

// Determine Content Type 
switch ($ext) { 
   case "pdf": $ctype="application/pdf"; break; 
   case "exe": $ctype="application/octet-stream"; break; 
   case "zip": $ctype="application/zip"; break; 
   case "doc": $ctype="application/msword"; break; 
   case "xls": $ctype="application/vnd.ms-excel"; break; 
   case "ppt": $ctype="application/vnd.ms-powerpoint"; break; 
   case "gif": $ctype="image/gif"; break; 
   case "png": $ctype="image/png"; break; 
   case "jpeg": 
   case "jpg": $ctype="image/jpg"; break; 
   default: $ctype="application/force-download"; 
} 

header("Pragma: public"); // required 
header("Expires: 0"); 
header("Cache-Control: must-revalidate, post-check=0, pre-check=0"); 
header("Cache-Control: private",false); // required for certain browsers 
header("Content-Type: $ctype"); 
header("Content-Disposition: attachment; filename=\"".basename($fullPath)."\";" ); 
header("Content-Transfer-Encoding: binary"); 
header("Content-Length: ".$fsize); 
ob_clean(); 
flush(); 
readfile( $fullPath ); 

} else die('File Not Found'); 

} 
```

# java - 如何使用 Java 反射调用抛出异常的方法？

> ID：11452021
> 
> 赞同：19
> 
> 时间：2012-07-12T12:36:57.227
> 
> 标签：java, exception, reflection, invoke

我想调用一个方法，使用 Java 反射。

问题是这个方法（我写的）抛出了一个异常（我创建了一个*myCustomException*）。当我添加 try/catch 子句时，我无法运行我的项目，因为 Eclipse 说“catch 子句无法访问”。

这是我尝试在*MyClass*类中调用*myMethod*时：

 *```
270\.    myMethod.invoke(null, myParam); // NB : null because myMethod is static 
```

当*myMethod*不抛出*MyCustomException*时，一切都很好。但是当它抛出*MyCustomException*时，我收到以下错误消息：

假设我尝试调用类 BarClass( *)*中的*fooMethod()*，并且：

```
java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.tests.MyClass.test5(270)
    at com.tests.MyClass.main(297)
Caused by: com.tests.MyCustomException
    at com.tests.barClass.fooMethod(BarClass.java:129)
    ... 6 more 
```

甚至可能吗？无论如何感谢您的帮助。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-12T12:39:39.780

您可以得到它的原因，这将是原始异常。

```
InvocationTargetException.getCause(); 
```

从文档：

> InvocationTargetException 是一个已检查的异常，它包装了由调用的方法或构造函数抛出的异常。

[http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/InvocationTargetException.html](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/InvocationTargetException.html)

在您的 catch 块中，您可以检查异常是否来自您期望的类型并处理它。

一种简单的方法是：

```
try {
   ...
} catch (InvocationTargetException ite) {
   if (ite.getCause() instanceof SomeExceptionType) {
      ...
   } else {
      ...
   }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-12T12:47:56.057

一种方法：

```
try { myMethod.invoke(null, myParam); }
catch (InvocationTargetException e) { 
  try { throw e.getCause(); }
  catch (MyCustomException e) { ...}
  catch (MyOtherException e) { ...}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:44:18.097

如果您试图`catch`在执行的方法中添加一个子句`myMethod.invoke(null, myParam)`，那么这显然不是正确的做法。在这种情况下，您通过反射调用该方法，这不是捕获异常的地方，因为该`invoke`方法会引发其他异常。一旦调用了引发异常的方法，如果我没记错的话，如果有异常，它将被抛出并包裹在一个`InvocationTargetException`中。

[检查此解释](http://docs.oracle.com/javase/tutorial/reflect/member/methodTrouble.html)的最后一部分关于`InvocationTargetException`.*

# html - 测量 html5 画布元素上的文本高度

> ID：11452022
> 
> 赞同：14
> 
> 时间：2012-07-12T12:36:58.913
> 
> 标签：html, text, html5-canvas, measurement

我知道如果现在将在画布上呈现某些文本，我可以使用 context.measureText 来获取它的宽度。有没有办法做同样的事情但得到文本的高度？

只是对自己的一个想法-也许我可以将文本旋转 90 度然后测试宽度？...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-23T16:53:52.163

这个 SO 答案可能针对您的需要过度设计了 [如何在 HTML 画布上找到文本的高度？](https://stackoverflow.com/questions/1134586/how-can-you-find-the-height-of-text-on-an-html-canvas)

我更喜欢一些更简单的东西：

```
var text = "Hello World";
var font = "Serif";
var size = "16";
var bold = false;

var div = document.createElement("div");
    div.innerHTML = text;
    div.style.position = 'absolute';
    div.style.top  = '-9999px';
    div.style.left = '-9999px';
    div.style.fontFamily = font;
    div.style.fontWeight = bold ? 'bold' : 'normal';
    div.style.fontSize = size + 'pt'; // or 'px'
document.body.appendChild(div);
var size = [ div.offsetWidth, div.offsetHeight ];
document.body.removeChild(div);

// Output
console.log( size );
var pre = document.getElementById( "output" );
if( pre )
    pre.innerHTML = size;
```

```
<pre id="output"></pre>
```

参考： [http ://www.rgraph.net/blog/2013/january/measuring-text-height-with-html5-canvas.html](http://www.rgraph.net/blog/2013/january/measuring-text-height-with-html5-canvas.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-29T14:47:09.927

我有同样的问题，我发现的是这个。从您的字符串中获取字体大小。我不知道为什么，但它仅在您在 PT 中设置属性时才有效，而不是在 PX 中。

```
ctx.font="20px Georgia"; // This will not work.
ctx.font="20pt Georgia"; // This is what we need. 
```

然后从中获取价值。

```
var txtHeight = parseInt(ctx.font); 
```

现在您有了文本的高度。就像我说的，在我这边，我必须将 PT 中的大小设置为 PX

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:41:04.093

您可以以像素为单位设置画布的字体大小，然后您应该能够将其用作文本框的高度。然而，当我开始这样做时，我发现我需要在像素高度上增加大约 50% 才能获得准确的值：

```
var textHeight = fontSize * 1.5; 
```

如果这对您来说还不够好，这里列出了几个非常成熟的解决方案[，](https://stackoverflow.com/questions/1134586/how-can-you-find-the-height-of-text-on-an-html-canvas)其中一个使用该`getImageData`方法来计算垂直像素的数量。

# regex - 多行正则表达式无法按预期工作

> ID：11452023
> 
> 赞同：0
> 
> 时间：2012-07-12T12:36:59.733
> 
> 标签：regex

我在 Notepad++ 中使用正则表达式，试图匹配如下的一般模式：

```
/*
<FooBar>(<--find open bracket and end on finding a closing bracket-->) 

 <FooBar> (foo 
bar);  
  <FooBar>  (foo 
bar 
baz)  
*/ 
```

我正在尝试使用匹配：

```
 ^\s*?<FooBar>\s+?.+?\(.*?\) 
```

启用了“匹配换行符”，但没有按预期工作；带有书签的行显示在上面的空白行上，并且无法为我需要的所有行添加书签。

我想使用这个正则表达式使用“在文件中查找”在多个文件中搜索匹配项。

所以我发现了一些东西。因为它使用多行，所以 \s* 将在到达 foobar 之前匹配。所以通过替换删除所有背线

```
^\s+ 
```

没有什么可以解决这个问题。

```
^\s*<foobar>\s+.+?\(.*?\) 
```

完全符合我的需要，但有一个问题，那就是 notepad++ 不会为所有标记的行添加书签，只是查找的开始；如果它是多行查找，它只会为匹配的第一行添加书签（尽管其余行将被标记）。因此，这意味着如果您使用“在文件中查找”进行搜索，它只会返回不太有用的带有书签的行。

但是，您可以通过 Search-->Remove Unbookmarked Lines 删除所有未标记的行，但我需要进行批量搜索，所以这似乎是不可能的。

但是，其他编辑器会返回所有标记的行，例如 editpad pro。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:46:02.943

不知道我是否理解你的期望，buf这样的事情怎么样：

```
^\s*<FooBar>\s*\((\n|.)*\) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:48:37.027

Notepad++ 不能正确支持跨越多行的正则表达式。我确实找到了这个解决方法：[https ://stackoverflow.com/a/4473041/785745](https://stackoverflow.com/a/4473041/785745)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:45:53.563

如果您正在专门寻找 Notepad++ 多行正则表达式，请查看[这篇文章](http://markantoniou.blogspot.com/2009/02/regular-expressions-guide.html)。

# c# - 使用 c# 进行 HTML 解析

> ID：11452024
> 
> 赞同：2
> 
> 时间：2012-07-12T12:37:13.373
> 
> 标签：c#, html, string, replace, html-agility-pack

我正在一个asp.net网站上工作。我需要使用c#替换html中的特定字符串。以下是html。在这里，我需要使用 c# 代码将“@name”替换为有效名称。我尝试使用 java 脚本。它正在工作。我如何使用 c# 实现这一点？

如何使用 c# 或 HtmlAgilityPack 获取当前页面的 HTML 以解析它？

HTML：

```
<div>
In the @name, you may have configured an iPad in both the AppleDevices and the TabletDevices configuration. However, because AppleDevices may have been set for a small display size, you want an iPad to use the TableDevices configuration (which has a larger screen). Reorder the devices in the following order so that an iPad will use the TableDevices configuration first.
Tablet Devices
Apple Devices
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:39:35.060

```
var result = html.Replace("@name", valid_name) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T12:40:12.370

最简单的方法是使用[`String.Replace(String, String)`](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)方法：

```
string newString = html.Replace("@name", "valid name"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T14:38:03.127

假设这是 MVC 看看我的[CsQuery](http://www.github.com/jamietre/csquery)项目。CsQuery 是一个 jQuery 端口和 CSS 选择器引擎，您可以使用它直接处理 HTML。但更重要的是，该项目包含一个示例，其中包含在 MVC 下以 C# 呈现页面之前访问页面 HTML 的代码。

访问局部视图非常容易，请参阅 Rick Strahl 的有关该主题的[博客文章](http://www.west-wind.com/weblog/posts/2012/May/30/Rendering-ASPNET-MVC-Views-to-String?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20RickStrahl%20%28Rick%20Strahl%27s%20WebLog%29)。

但是，如果您想访问页面的整个 HTML 并可能在呈现之前对其进行更改，则需要创建一个 custom `ViewEngine`，并对控制器进行回调，以便您可以访问 HTML。正确地做到这一点涉及很多。与其复制数百行代码，不如看一下 CsQuery 中包含的示例 MVC 应用程序，特别是`CsQueryView`文件夹中的类：

[https://github.com/jamietre/CsQuery/tree/master/examples/CsQuery.MvcApp](https://github.com/jamietre/CsQuery/tree/master/examples/CsQuery.MvcApp)

这包括一个自定义视图引擎和一个自定义 Controller 基类，可让您向控制器添加方法，如下所示：

```
// runs for all actions
public void Cq_Start()
{
    Doc["a.not-allowed"]
        .Attr("onclick","javascript:alert('You're not authorized to click this')");
}

// runs for the Index action
public void Cq_Index()
    Doc["div"].Css("border", "1px solid red;");
} 
```

这些方法在对应的常规操作方法*之后*调用，并设置 的值`Doc`。`Doc`是一个`CQ`对象（CsQuery 中的核心对象）。这包含页面的所有 HTML。它就像一个 jQuery 对象。在您的情况下，您可以使用 jQuery 方法，例如：

```
// select all divs on the page
var div = Doc["div"];

// do parameter substitution
var newText = div.Text().Replace("@name", valid_name);

// update the text
div.Text(newText); 
```

要切换您的 MVC 应用程序以使用此视图引擎，您需要将此代码添加到`Application_Start`：

```
ViewEngines.Engines.Clear();
ViewEngines.Engines.Add(new CsQueryViewEngine()); 
```

但是，如果不想使用 CsQuery，该示例应该向您展示如何在 MVC 中访问 HTML 输出，然后再呈现。它使用反射来找出在控制器中回调的方法，并且可以很容易地调整它以提供 HTML 字符串而不是 CsQuery 对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T13:21:05.353

```
string htmlContent=@"<div>In the @name, you may have configured an iPad in both the AppleDevices and the TabletDevices configuration. However, because AppleDevices may have been set for a small display size, you want an iPad to use the TableDevices configuration (which has a larger screen). Reorder the devices in the following order so that an iPad will use the TableDevices configuration first.
Tablet Devices
Apple Devices
</div>";
string htmlNewContent=htmlContent.Replace("@name",valid_name); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T12:45:02.703

如果只是这个替换，你可以使用 string.Replace();

您的代码看起来像一个 html teplate。如果您的变量列表会增加，我强烈建议您使用 Razor 作为模板引擎，您可以在其中获得静态类型、html 表中的智能感知和其他功能。

# c# - 如何使用工作流向一个团队的所有成员发送电子邮件？

> ID：11452036
> 
> 赞同：0
> 
> 时间：2012-07-12T12:38:01.953
> 
> 标签：c#, email, workflow, dynamics-crm-2011

在工作流程中，我创建了一些实体并将其所有者设置为团队。现在我想向该团队的每个成员发送电子邮件。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T14:24:55.657

如果您可以创建一个 Exchange 分发列表，然后将默认队列的电子邮件地址设置为该分发列表，那将很容易：![发送工作流电子邮件](../Images/dc10990a2a8a2e4703d2d541cc9a4a26.png)

# php - 如何确定递归 foreach 函数中的第一个元素？

> ID：11452039
> 
> 赞同：0
> 
> 时间：2012-07-12T12:38:18.800
> 
> 标签：php

我有一个生成嵌套导航菜单的函数：

```
function recursive_foreach($array, $display) {
    $out = '<ul>';
    foreach ($array as $key => $value) {
        ... 
        $out .= '<li class="'. $is_active . $is_parent . '"><a href="' . $url . '">' . $value['name'] . '</a>'; }   
        if (is_array($value['has_children'])) { 
            $out .= recursive_foreach( ...
        }
        $out .= "</li>";
    }   
    $out .= '</ul>';    
    return $out;    
} 
```

我想将 css 类添加到第一个“ul”元素。我知道如何确定 foreach 循环中的第一个元素，但我怎样才能将它排除在外？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:40:39.547

您可以使用 CSS 选择器`:first-child`( [MDN](https://developer.mozilla.org/en/CSS/%3afirst-child) ) 或`:first-of-type`( [MDN](https://developer.mozilla.org/en/CSS/%3afirst-of-type) ) 来定位相应的`<ul>`元素，因此您不需要向该元素添加特定的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T12:41:28.157

最好传递一个适当的参数：

```
function recursive_foreach($array, $display, $first = true) {
    ...
    recursive_foreach($foo, $bar, false);
    ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T12:41:31.473

您可以使用[`:first-child`](http://www.w3schools.com/cssref/sel_firstchild.asp)CSS 选择器。:)

所以，你的 CSS 应该是这样的：

```
ul li:first-child { /* CSS Code */ } 
```

它兼容：

*   浏览器 7+
*   火狐
*   铬合金
*   苹果浏览器

因为您可以使用纯 CSS 来定位它，而无需更改标记！:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T12:40:26.463

通常第一个`$key`为零，因此您可以检查该条件：

```
$first = $key === 0; 
```

如果您的第一个密钥不同，请使用第一个密钥：

```
$first = $key === $firstKey; 
```

如果您的第一个密钥发生更改，请先获取它：

```
list($firstKey) = array_keys($array); 
```

希望这会有所帮助。

在 CSS 本身中，您也可以只使用[`:first-child`伪类^(*CSS2*)](http://www.w3.org/TR/CSS2/selector.html#first-child)。所以不需要[为各种浏览器添加一个类^(*Browser Support*)](http://caniuse.com/#feat=css-sel2)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-12T12:41:33.967

[:first-child](http://reference.sitepoint.com/css/pseudoclass-firstchild)很好，但并不完全兼容。

# objective-c - 使用 NSNotificationCenter 从 MainView 发生 GestureRecognizers 时更改 UIView 布局

> ID：11452050
> 
> 赞同：1
> 
> 时间：2012-07-12T12:39:05.160
> 
> 标签：objective-c, core-animation, core-graphics, uigesturerecognizer, nsnotificationcenter

我添加了一些视图作为子视图并处理 UILongPressGestureRecognizer （这是识别我已将手指放在 UI 元素中的正确手势吗？？）和 UIPanGestureRecognizer 以在屏幕中移动视图（请参阅我以前的问题以获得想法我正在建造的东西-> [SO](https://stackoverflow.com/questions/11437192/how-to-add-uiview-subviews-in-a-view-aligned-like-3x3-table/11437834#11437834)）

我想在放手指时添加动画（翻转，像小缩放一样），然后在移动视图时重新排列其他视图，最后放置并重新排列视图。

我的第一个问题是，当长按视图时，手势被识别，但是虽然这个手势还没有结束，但我无法将视图移动到屏幕上并重新定位。我该如何解决这个问题？LongPress 一个 UI 元素 (UIMyView) 为这个事件做任何动画，然后不拿走我的手指开始移动它，就像 PanGesture 已经在工作一样。

创建了一个 UIView 子类并在其中添加了所需的 UIGestureRecognizers。

我使用 NSNotificationCenter 通知 MainViewController 发生了手势，因此我可以更改视图的布局（这是正确的方法，或者我可以将这个手势以其他方式发生推送到我的超级视图控制器，例如将事件推送到下一个响应者） ?

我使用 drawTextInRect 方法将字符绘制到视图的大小，这就是为什么我不能只更改视图内部的布局。

在 MainViewController 中，我在 NSNotification 观察者选择器中为特定视图调用 setNeedsDisplay，但是在拖动它时不起作用，它只显示一个空的白色视图，就像我需要的视图已更改但尚未显示线程暂停的原因或某物。

当 PanGesture 结束时，我再次通知 MainViewController 并再次调用 setNeedsDisplay，但现在它可以工作，除了我设置的背景颜色（并且已设置），保持在拖动时应显示的先前条件，但角色再次正确绘制。

我的思想进入了线程！？

[编辑] 一些代码示例：

```
 // Inside the UIMyView
-(void) touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event
{
     [[NSNotificationCenter defaultCenter] postNotificationName:@"MyViewNotification" object:self];
    // Here I will put my animations, not yet proceed with them
    // Code for lastLocation
    isViewTouched = YES;
    [self setNeedsDisplay];
}
- (void) touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event
{
     // code for moving the View with finger
}

-(void) touchesEnded:(NSSet*)touches withEvent:(UIEvent*)event
{
  isViewTouched = NO;
  [self setNeedsDisplay];
}

-(void) drawLayout
{
  UILabel* labelToDraw = [[UILabel alloc] init];
  labelToDraw.text = @"1";
  labelToDraw.font = [self getFont];
  labelToDraw.textcolor = [UIColor blackColor];
  self.backgroundColor = [UIColor whiteColor];
  [labelToDraw drawTextInRect:self.bounds];
}
// The same method with other color values and text exist for another layout.
// Called inside of drawRect:(CGRect)rect when calling setNeedsDisplay as I know and it is

-(void) drawRect:(CGRect)rect
{
  if (isViewTouched) [self drawLayout];
  else [self drawLayoutMoving];
}
    //Superview Controller notified
-(void) handleMyViewNotification:(NSNotification*)notification
{
  myViewMoving = [notification object];
  [self performSelectorInbackground:@selector(manageArrayOfMyViews) withObject:nil];
}

-(void) manageArrayOfMyViews
{
  // animate and reorder the array of views not touched
} 
```

我是 Objective-C 的新手，所以我在这里遗漏了一些东西，我想知道我的方法总体上是否正确。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:37:32.130

手势识别器似乎不是解决问题的最简单方法。尝试使用

```
- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
```

检测触摸的开始并播放开始动画。然后

```
- (void) touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
```

拖动您的视图。和

```
- (void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event 
```

当手指不再出现在屏幕上时，进行最终设置。

**例如：**

```
- (void)touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event {
   UITouch *touch = [touches anyObject];
   if ([touch.view isKindOfClass: [MyView class]]) {
      //play animation on touch.view
      lastLocation = [touch locationInView: self.view];
   }
}

- (void)touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event {
   UITouch *touch = [touches anyObject];
    if ([touch.view isKindOfClass: [MyView class]]) {
       CGPoint location = [touch locationInView: self.view];

       CGFloat xDisplacement = location.x - lastLocation.x;
       CGFloat yDisplacement = location.y - lastLocation.y;

       CGRect frame = touch.view.frame;
       frame.origin.x += xDisplacement;
       frame.origin.y += yDisplacement;
       touch.view.frame = frame;
   }
} 
```

**[编辑]**

正如我从您的代码中猜想的那样，您正在尝试在要移动的视图顶部绘制一个带有数字的标签。您不需要实现自定义 drawRect 方法，您的任务可以更轻松地完成。当您创建一个稍后将要拖动的视图时，您添加一个 UILabel 作为子视图并按照您想要的方式对其进行自定义：

```
UIView* viewToDrag = [[UIView alloc] initWithFrame: // your frame];
UILabel* subLabel = [[UILabel alloc] initWithFrame: CGRectMake(0, 0, viewToDrag.frame.size.width, viewToDrag.frame.size.height)];
 subLabel.tag = 0xff; // example tag, you can define it 
 [self customizeStaticLabel: subLabel]; //subroutine to customize your usual label appearance: set text, font, etc
[viewToDrag addSubview: subLabel];
[self.view addSubview: viewToDrag];

//insert release calls for subLabel and viewToDrag if you're NOT using ARC 
```

仅此而已，您的标签现在是可拖动视图的子项。而且您不需要任何通知，也不需要调用 setNeedsDisplay。

拖动视图时，可以更改视图的 subLabel：

```
UILabel* labelToChange = (UILabel*)[touch.view viewWithTag: 0xff]; //this will get a subview label
[self customizeDraggedLabel: labelToChange]; 
```

在 touchesEnded 中，你需要让你的标签恢复正常状态，所以

```
UILabel* labelToChange = (UILabel*)[touch.view viewWithTag: 0xff];
[self customizeStaticLabel: labelToChange]; 
```

以及更改标签外观的子程序，例如：

```
-(void) customizeStaticLabel: (UILabel*) label{
   label.textColor = [UIColor redColor];
}

-(void) customizeDraggedLabel: (UILabel*) label{
   label.textColor = [UIColor blackColor];
} 
```

# internationalization - Symfony 路由：可以调用路由但不能转发到

> ID：11452058
> 
> 赞同：2
> 
> 时间：2012-07-12T12:39:29.033
> 
> 标签：internationalization, url-routing, locale, symfony-2.1

我有一条仅针对区域设置的路线，没有任何其他信息（即起始页）：

```
homepage:
    pattern:  /{_locale}/
    defaults: { _controller: OurStartBundle:Default:index } 
```

如果我直接调用路由它可以工作（即：localhost/de_DE/）但是如果我转发它会抛出错误：

> 无法解析控制器名称“/app_dev.php/de_DE/”。

我使用这样的控制器方法转发：

```
$locale = \Locale::acceptFromHttp($_SERVER['HTTP_ACCEPT_LANGUAGE']);    
return $this->forward($this->generateUrl('homepage', array('_locale' => $locale))); 
```

任何人都知道为什么这不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:48:01.120

您正在尝试将请求转发到 URI，而不是捆绑字符串。

例如，您的前转呼叫应该是...

```
$response = $this->forward('OurStartBundle:Default:index', array(
    '_locale' => 'de_DE'
)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:54:20.213

问题是我在想要重定向的地方使用了 $this->forward()，应该使用 $this->redirect()。

解决方案是：

```
$locale = \Locale::acceptFromHttp($_SERVER['HTTP_ACCEPT_LANGUAGE']);
return $this->redirect($this->generateUrl('OurStartBundle_homepage', array('_locale' => $locale))); 
```

# regex - 使用C#程序FNR查找和替换属性，找不到文件

> ID：11452070
> 
> 赞同：1
> 
> 时间：2012-07-12T12:40:10.153
> 
> 标签：regex, cmd, expression

我有一个主虚拟机，上面托管了一些网站。当我部署它的副本时，这些设置是标准值，我经常需要更改它们以适应不同的数据库。为此，我想使用一个小的 c# 程序，这样我就可以使用正则表达式来查找和替换所需的任何属性。为此，我使用 fnr (http://findandreplace.codeplex.com/)。

findandreplace.bat：

```
set DATABASE="dbname"
set DBHOST="my.host.name"
set DBPORT="1234"
set ENV="this.env"

ECHO CHANGE DATABASE
"fnr" --cl --dir "D:\Inetpub\wwwroot" --fileMask "web.config" --includeSubDirectories --useRegEx --find "<add key=\"DATABASE\" value=\".*\"\s*>" --replace "<add key=\"DATABASE\" value=\"%DATABASE%\">"

ECHO CHANGE HOST
"fnr" --cl --dir "D:\Inetpub\wwwroot" --fileMask "web.config" --includeSubDirectories --useRegEx --find "<add key=\"HOST\" value=\".*\"\s*>" --replace "<add key=\"HOST\" value=\"%DBHOST%\">"

ECHO CHANGE PORT
"fnr" --cl --dir "D:\Inetpub\wwwroot" --fileMask "web.config" --includeSubDirectories --useRegEx --find "<add key=\"ConnectionString\" value=\"Data Source.*>" --replace "<add key=\"ConnectionString\" value=\"Data Source=(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = %%3%%)(port = %DBPORT%)) )(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = %%2%%)));User ID=%%0%%;Password=%%1%%;Enlist=false\">"

set /p await= "any key to continue" 
```

Windows 命令提示符最后给了我以下输出：

```
CHANGE PORT
The system cannot find the file specified.
 "any key to continue" 
```

我可以看到前两个通过，如果我检查它应该接触的文件，则值已正确更改。我只是不明白为什么更改端口不起作用，并告诉我它找不到指定的文件。一，它不指定任何单个文件，二，它查找与前两个相同的文件。

此外，如果我尝试在 FNR 中运行正则表达式（查找部分，具有与仅 web.config 文件相同的参数并且在相同的文件夹+子文件夹中），它会完美地找到文件。

有人知道我做错了什么吗？提前致谢。

# c++ - C++：使用#if std::is_fundamental ::MSVC 2010 中条件编译的值

> ID：11452074
> 
> 赞同：2
> 
> 时间：2012-07-12T12:40:18.460
> 
> 标签：c++, conditional-compilation, typetraits

在我的模板中，我需要根据 typename 是否为基本类型来使用不同的代码部分。

编译此代码会在 MSVC 中给出 C4067（预处理器指令后的意外标记 - 需要换行符）：

```
template <typename T>
void MyClass<T>::foo()
{
// ... some code here
#if std::is_fundamental<T>::value
    if(m_buf[j] < m_buf[idx_min])
        idx_min = j;
#else
    const ASSortable& curr = dynamic_cast<ASSortable&>(m_buf[j]);
    const ASSortable& curr_min = dynamic_cast<ASSortable&>(m_buf[idx_min]);
    // error checking removed for simplicity
    if(curr.before(curr_min))
        idx_min = j;
}
#endif 
```

该模板适用于原始数据类型和我自己的（从 ASSortable 派生的）数据类型，并且从模板实例化代码中引发错误：

```
template class MyClass<char>; 
```

尝试将预编译器表达式修改为此也不起作用：

```
#if std::is_fundamental<T>::value == true 
```

并产生相同的确切警告。

任何想法如何使此代码无警告？

**编辑**想到的另一件事是将其转换为运行时检查并使用“常量 if 表达式”警告..​​.真的没有办法在没有专业化和额外膨胀的*单个*函数中优雅地做到这一点?

**编辑#2**所以我解决这个问题的方法（这很明显，但不知何故让我逃脱了......）是定义一个`bool ASSortable::operator<(const ASSortable& _o) const {return this->before(_o);};`可以完成工作并使代码干净的方法（再次）。

我的代码中不再有`if`s 或`#ifdef`s 或任何类似的混乱！

不敢相信我什至问了这个问题，因为它有一个如此明显和简单的答案:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T14:06:11.543

解决该问题的常见模式是将函数移动到专用的基类并滥用继承将其带到您的范围：

```
template <typename T, bool is_fundamental>
struct Foo_impl {
   void foo() {
   }
};
template <typename T>
struct Foo_impl<T,true>
{
   void foo() {              // is fundamental version
   }
};
template <typename T>
class Foo : public Foo_impl<T, std::is_fundamental_type<T>::value> {
   // ...
}; 
```

`foo`另一种方法是将它们实现为类中的私有函数，并根据特征在内部分派给它们。这是一个非常简单且更清洁的解决方案，但如果两个版本之一`foo_impl`无法编译，则会失败。在这种情况下，您可以使用，因为其他人建议使用模板成员函数来解决，**但**我仍然会提供非模板`foo`作为公共接口，转发到私有`foo_impl`模板。原因是其中`template`有一个*破解*条件编译的实现细节，而不是接口的一部分。您不希望用户代码使用与您自己的类的类型不同的模板参数调用该成员函数。借用pmr的回答：

```
template <typename T>
struct Foo
{
  template <typename U = T, 
            typename std::enable_if< 
              std::is_fundamental<U>::value, int >::type* _ = 0
           >
  void foo() {
    std::cout << "is fundamental" << std::endl;
  }
//... 
```

该解决方案允许用户代码如下：

```
Foo<int> f;
f.foo<std::string>(); 
```

它将实例化一个您不需要也不想要的函数，并将执行您不想要的逻辑。即使用户不试图欺骗你的类，接口中的模板这一事实也可能令人困惑，并使用户认为可以为不同的类型调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:04:06.663

您正在混淆编译状态。预处理器在实际编译器之前运行，并且不知道类型或模板。它只是执行（非常）复杂的文本替换。

当前的 C++中没有像`static if`¹这样的东西，因此您必须求助于不同的方法来启用条件编译。对于我更喜欢​​的功能`enable_if`。

```
#include <type_traits>
#include <iostream>

template <typename T>
struct Foo
{
  template <typename U = T, 
            typename std::enable_if< 
              std::is_fundamental<U>::value, int >::type = 0
           >
  void foo() {
    std::cout << "is fundamental" << std::endl;
  }

  template <typename U = T, 
            typename std::enable_if< 
              !(std::is_fundamental<U>::value), int >::type = 0
           >
  void foo() {
    std::cout << "is not fundamental" << std::endl;
  }
};

struct x {};

int main()
{
  Foo<int> f; f.foo();
  Foo<x> f2; f2.foo();
  return 0;
} 
```

* * *

¹参考文献：

[视频](http://channel9.msdn.com/Events/GoingNative/GoingNative-2012/Static-If-I-Had-a-Hammer)：如果 Alexandrescu 在 Going Native 中呈现，则为静态。

[n3322](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3322.pdf) : Walter E. Brown 的提议`static if`

[n3329](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3329.pdf) : Sutter、Bright 和 Alexandrescu 的提议`static if`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:45:14.803

预处理器在编译的早期运行，在编译器分析类型并知道它的含义之前`std::is_fundamental<T>::value`，因此它不能以这种方式工作。

相反，使用专业化：

```
template<bool> void f();

template<> void f<true>() {
    if(m_buf[j] < m_buf[idx_min])
        idx_min = j;
}

template<> void f<false>() {
    const ASSortable& curr = dynamic_cast<ASSortable&>(m_buf[j]);
    const ASSortable& curr_min = dynamic_cast<ASSortable&>(m_buf[idx_min]);
    // error checking removed for simplicity
    if(curr.before(curr_min))
        idx_min = j;
}

template <typename T>
void MyClass<T>::foo()
{
// ... some code here
    f<std::is_fundamental<T>::value>();
} 
```

**编辑：**您可能需要创建一个成员函数，但是因为它是一个非专业模板`f`，所以这不是直接可能的。`MyClass<T>`您可以创建`f`一个全局函数，将调用委托给`MyClass`. 但是，还有另一种方法。

使用重载，这变成：

```
void MyClass<T>::f(const true_type&) {
    if(m_buf[j] < m_buf[idx_min])
        idx_min = j;
}

void MyClass<T>::f(const false_type&) {
    const ASSortable& curr = dynamic_cast<ASSortable&>(m_buf[j]);
    const ASSortable& curr_min = dynamic_cast<ASSortable&>(m_buf[idx_min]);
    // error checking removed for simplicity
    if(curr.before(curr_min))
        idx_min = j;
}

template <typename T>
void MyClass<T>::foo()
{
// ... some code here
    f(std::is_fundamental<T>::type());
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T12:48:48.623

`std::is_fundamental<T>::value == true`不能在预处理时使用。我想您将不得不对 std::enable_if 使用一些 SFINAE 技巧：

```
template <typename T>
typename std::enable_if<std::is_fundamental<T>::value, void>::type 
MyClass<T>::foo()
{
    // ... some code here

    if(m_buf[j] < m_buf[idx_min])
        idx_min = j;
}

template <typename T>
typename std::enable_if<!std::is_fundamental<T>::value, void>::type 
MyClass<T>::foo()
{
    // ... some code here

    const ASSortable& curr = dynamic_cast<ASSortable&>(m_buf[j]);
    const ASSortable& curr_min = dynamic_cast<ASSortable&>(m_buf[idx_min]);
    // error checking removed for simplicity
    if(curr.before(curr_min))
        idx_min = j;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T12:45:51.317

这几乎就是它所说的，你不能`::`在预处理器指令中使用。实际上，您唯一可以在之后使用`#if`的是在编译时之前定义的常量表达式。[你可以在这里](http://msdn.microsoft.com/en-us/library/ew2hz0yd.aspx)找到一些信息

# javascript - 如何有效地计算给定原始日期的连续日期

> ID：11452075
> 
> 赞同：3
> 
> 时间：2012-07-12T12:40:19.157
> 
> 标签：javascript, date

这适用于基本上允许您设置给定事件的第一个日期，然后设置重复周期的系统。

例如。我设定了一个从现在起一周的日期，即 2012 年 7 月 19 日，所以我知道我必须把猫和牛奶一起放出去。我还将它设置为每周通知，因此在未来几周我希望收到相同的通知。

该原始日期位于我的数据库中，这对于第 1 周来说很好，但在第 2 周，我需要将日期作为原始日期加上 1 周返回。

从表面上看，这似乎很简单，但我需要确保我可以考虑闰年和不同的重复频率（每两周一次、每月一次、每年一次，等等）。

我想将其保留为 javascript 实现 - 因为它更快，而且我觉得可能需要的代码比更新数据库中的日期要少。也许这是无法实现的，任何指针都会很好。

我认为这些可能是一个起点：

[给定开始日期，如何在javascript中计算到当前日期的年数](https://stackoverflow.com/questions/10006318/given-a-start-date-how-to-calculate-number-of-years-till-current-date-in-javas)

[给定一个日期，我如何有效地计算给定顺序（每周、每月、每年）中的下一个日期？](https://stackoverflow.com/questions/2317584/given-a-date-how-can-i-efficiently-calculate-the-next-date-in-a-given-sequence)

更新，我写了下面的内容来返回在每种不同情况下添加的时间量，从那里我可以使用下面的答案：

```
var strDate = $(this).find('.next').text();
            var frequency = $(this).find('.occurs').text();
            var frmDate = getDateObject(strDate);
            var toDate = new Date();

            var days = parseInt(Math.floor((frmDate - toDate) / 86400000));

            if(days < 0) {
                // find out how many WHOLE 'frequencies' have passed
                var weeks = Math.ceil(0 - (days / 7));
                var months = Math.ceil(0 - (monthDiff(toDate,frmDate)));
                var years = Math.ceil(months / 12);
                //alert(days + '/' + weeks + '/' + fortnights + '/' + months + '/' + quarters + '/' + years);

                if(frequency == 'Weekly') { frmDate.add(weeks).weeks(); }
                if(frequency == 'Fortnightly') { frmDate.add(weeks*2).weeks(); }
                if(frequency == 'Monthly') { frmDate.add(months).months(); }
                if(frequency == 'Quarterly') { frmDate.add(months*3).months(); }
                if(frequency == 'Annually') { frmDate.add(years).years(); }

                var newdate = frmDate.toString("dd/MM/yyyy");
                //alert(newdate);

                $(this).find('.next').text(newdate);
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:43:20.947

我会做的（可能不是最好的解决方案，我现在只是想出来）是从初始日期开始并使用循环：`while`您观察的日期小于当前日期，增加观察日期一周（两周、一个月、一年等）。如果您降落在当前日期，则会发生该事件。否则就另当别论了。

您可以使用诸如`date.setDate(date.getDate()+1);`将日期增加一天、`+7`一周相同、分别使用月`set/getMonth`和`set/getFullYear`年的方法。如果你给出一个超出范围的值，JS 会包装它（所以 3 月 32 日变成了 4 月 1 日）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:47:54.283

此外，为此的 SQL 实现将使用 DATEADD：

[http://sql-plsql.blogspot.com/2010/07/dateadd.html](http://sql-plsql.blogspot.com/2010/07/dateadd.html)

您不必担心闰年等特殊日期，因为大多数 Date 函数都会处理这些问题。

或者，您可以按照其他用户的建议使用 getDate()、getMonth()。var 今天 = 新日期（）；today.setDate(today.getDate() + numberOfDaysToAdd);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-30T08:57:08.393

请查看以下代码以获取一些原始想法

```
 var someDate = new Date();
for(var i = 0 ; i < 7 ; i++)
    {
someDate.setDate(someDate.getDate() + 1);   
        console.log(someDate)
    } 
```

您可以在下面的小提琴中进行相同的测试

[从当天起连续 7 天](http://jsfiddle.net/prodeveloper/qqqt7yyL/)

# sql - 如何：对项目进行分组，检索组的一个（随机）行数据并在一个 SQL 子句中计算每个组中的行数

> ID：11452079
> 
> 赞同：0
> 
> 时间：2012-07-12T12:40:30.400
> 
> 标签：sql, oracle

我在数据库中有简单的表，其中列 error_id、error_group_id 和消息。我想在 UI 中显示列表，其中显示消息和每个错误组的出现。

错误消息可能略有不同（例如：设置 X 在日期过期），例如日期可能会发生变化，但 error_group_id 是来自要用于分组的已定义常量的哈希值，不会改变（例如，可能是 ( AssemblyName+"设置过期").GetHashCode()。

目前我可以列出带有消息的组：

```
 SELECT message, error_group_id
 FROM (SELECT error_id, message, error_group_id,
 rank() OVER ( PARTITION BY error_group_id ORDER BY error_id) rank
 FROM cc_errors)
 WHERE rank <= 1; 
```

输出：（随机选择一个）消息，组散列。（每组仅一次）。

但是，我想要有关组内有多少个单独的错误消息的信息（双击组打开显示单个错误列表的窗口）。我想计算这个 SQL 子句中每个组的出现次数。

所以想要的输出如下（每组单行）：

消息，组哈希，组内的消息计数。

项目使用 oracle 作为数据库。

有人可以帮忙吗：P

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T13:08:14.367

您可以`COUNT`在当前查询中添加一个：

```
SELECT message, error_group_id, cnt
  FROM (SELECT error_id,
               message,
               error_group_id,
               rank() OVER (PARTITION BY error_group_id ORDER BY error_id) rank,
               count(*) OVER (PARTITION BY error_group_id) cnt
          FROM cc_errors)
 WHERE rank <= 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:49:12.280

我想你只是在寻找`group by`：

```
 select distinct c.message, c.error_group_id, t.error_group_count
   from cc_errors c
           inner join
        (select error_group_id, count(*) as error_group_count
           from cc_errors
          group by error_group_id) t  on t.error_group_id = c.error_group_id 
```

这会返回您要求的内容，但似乎没有意义。我会这样做：返回所有带有组 ID 的消息，然后当您单击组 ID 时，执行`select count(*) from cc_errors where error_group_id = @groupId`

# android - 布局 XML 中多个视图的一个属性（避免重复代码）

> ID：11452088
> 
> 赞同：0
> 
> 时间：2012-07-12T12:40:59.203
> 
> 标签：android, xml

我有以下布局 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" 
    android:layout_gravity="center"> // The layout_gravity doesn't seem to affect 
                                     // the button Views 
                                     // (I guess this is the wrong way to do it)

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Genre1" />

    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Genre2"
         />

</LinearLayout> 
```

如何为我的所有按钮视图制作单个通用属性配置，例如**android:layout_gravity="center" ？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:52:47.557

您可以将某个 View 的公共属性包装在一个样式下。

在您的 values 文件夹中创建一个 styles.xml 文件，然后声明样式：

```
<style name="list_item_title">
    <item name="android:textStyle">bold</item>
    <item name="android:textColor">@android:color/black</item>
    <item name="android:textSize">18sp</item>
    <item name="android:padding">0dp</item>
</style> 
```

然后，在您的 TextView （或按钮，或任何视图...）上：

```
<TextView
    android:id="@+id/tv1"
    style="@style/list_item_title" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:46:27.393

你试过`android:gravity="center"`而不是 `android:layout_gravity="center"`

或者你可以`android:layout_gravity="center"`在你的按钮 xml中尝试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:54:16.213

写在下面一行

```
android:gravity="center" 
```

代替

```
android:layout_gravity="center" 
```

它会解决你的问题。

# mysql - sql多重连接和计数

> ID：11452100
> 
> 赞同：0
> 
> 时间：2012-07-12T12:41:35.813
> 
> 标签：mysql, join, count

我有这样的桌子。但似乎 MySQL 目前不计算我的第二次加入。我想知道我在评论列表的报告处理计数方面错过了什么。

![在此处输入图像描述](../Images/c31c5ceef6c51d43e0b04c1993ab0f15.png)

我希望平均费率也计算报告

```
SELECT *, avg(rate.score), count(report.id) FROM `comment`
left join rate on (comment.id = rate.comment_id)
left join report on (comment.id = report.comment_id)
group by comment.id

id  text            id      comment_id  score   id      comment_id  type    avg(rate.score)     count(report.comment_id)
1   good article    1       1           2       1       1           1       4.0000              20
2   bad article     NULL    NULL        NULL    NULL    NULL        NULL    NULL                0 
```

**好文章**有**2**篇报道。

`count(report.id)`给我错误的价值。我的错误是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:44:17.370

```
SELECT 
    *,
    avg(rate.score),
    (SELECT 
            count(report.comment_id)
        FROM
            report
        WHERE
            comment.id = report.comment_id) AS num_reports
FROM
    comment
        left join
    rate ON (comment.id = rate.comment_id)
group by comment.id 
```

这是示例：

[http://sqlfiddle.com/#!2/cf313/15](http://sqlfiddle.com/#!2/cf313/15)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:46:35.223

你不需要 *. 试试这个

```
SELECT comment.id, avg(rate.score), count(report.id) FROM `comment` 
left join rate on (comment.id = rate.comment_id) 
left join report on (comment.id = report.comment_id) 
group by comment.id 
```

# google-app-engine - 使用 AuthSubUtil.exchangeForSessionToken 访问 Google 云端硬盘

> ID：11452103
> 
> 赞同：0
> 
> 时间：2012-07-12T12:41:41.987
> 
> 标签：google-app-engine, google-apps, google-drive-api, google-apps-marketplace

在 Google AppEngine 上，我已经通过 Google Docs 的身份验证...使用**AuthSub** [authshub](https://developers.google.com/accounts/docs/AuthSub)访问。

我们设法做到了`AuthSubUtil.exchangeForSessionToken(..)`。

**问题：是否可以使用此令牌跟进并获得对 Google Drive 的访问权限？**

... new Drive.Builder(httpTransport, jsonFactory, credential);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T22:37:15.910

我不确定 AuthSub 是否适用于 Google Drive API，但如果可以，此代码段应该可以解决您的问题：

```
new Drive.Builder(httpTransport, jsonFactory, new HttpRequestInitializer() {
  @Override
  public void initialize(HttpRequest request) {
    HttpHeaders headers = request.getHeaders();
    // Not sure if this test is necessary as headers might never be null.
    if (headers == null) {
      headers = new HttpHeaders();
      request.setHeaders(headers);
    }
    headers.setAuthorization("AuthSub token=\"<TOKEN>\"");
  }
}).build(); 
```

**重要提示**：请注意 AuthSub 已被弃用，您应该尽快迁移您的应用程序以使用 OAuth 2.0。

# c# - 如何在下载之前对特定文件进行一些操作？

> ID：11452105
> 
> 赞同：1
> 
> 时间：2012-07-12T12:41:54.787
> 
> 标签：c#, asp.net, handler, reportviewer, rdlc

如果我有一些报告并且我想在用户通过 ( `Export to pdf file`) 下载此报告之前执行特定操作（例如在此 pdf 中添加水印）。

> 如何处理导出按钮？

* * *

*注意：*我想要一些通用的方法，因为我有很多报告，我不想重复代码。我只想`pdf`在下载文件之前对文件执行特定的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:49:49.280

假设您已经可以访问没有水印的原始 PDF：

实现这样的东西；

[如何在现有 PDF 中插入带有 iTextSharp 的图像？](https://stackoverflow.com/questions/583629/how-can-i-insert-an-image-with-itextsharp-in-an-existing-pdf)

重定向或二进制下载带水印的文件。

完毕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:55:46.140

最简单的方法是一个静态类，该类具有一个方法，该方法需要一个 pdf 文件，也许还有水印图像，将其分类并传回。

如果你想要一些更通用的东西，例如你想说密码保护和/或给 pdf 加水印，或者你有非 pdf 报告你想做一些事情。

然后接口 IPrepareForExport 并在各种类型的“报告”上实现它，或者可能使用装饰器模式和一些属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:58:36.620

现在这不是一个容易实施的解决方案。但它是完全通用的。

您应该实施[自定义报告呈现器](http://msdn.microsoft.com/en-us/magazine/cc163840.aspx)。

通过为 Reporting Services 创建呈现器，您可以将报表呈现为您选择的格式。

只要您有报告导出，它就可用。

看看这个博客：[SSRS的PDF水印/背景渲染扩展](http://www.broes.nl/2011/02/pdf-watermarkbackground-rendering-extension-for-ssrs-part-1/)

他已经对你想做的事情做了一个扩展。

然后，您可以通过编辑 RSReportServer.Config 文件来删除您不希望支持[的现有呈现选项。](http://msdn.microsoft.com/en-us/library/ms156281%28v=sql.100%29.aspx)

您的报告数量无关紧要，因为这是一处配置更改。

# javascript - 将javascript对象转换为有序逗号分隔值

> ID：11452106
> 
> 赞同：3
> 
> 时间：2012-07-12T12:41:58.317
> 
> 标签：javascript, arrays, json, recursion, hash

我试图让json中的项目有序排列。我能够选择 json 中存在的“术语”值，但是是否可以按照我在预期输出部分中显示的方式进行排列？我添加了一个 jsfiddle 链接来显示我到达的位置：

```
[
    {
        "Link": "http://testLink.com/1",
        "_index": "test",
        "_source": {
            "Author": "SAM",
            "Map": [
                {
                    "Company": [
                        {
                            "Apple_Inc": [
                                {
                                    "count": 1,
                                    "term": "Apple"
                                }
                            ],
                            "sector": "Technology",
                            "term": "Apple Inc",
                            "ticker": "AAPL",
                            "type": "BCap"
                        }
                    ],
                    "count": 1,
                    "term": "Company"
                },
                {
                    "Country": [
                        {
                            "Canada": [
                                {
                                    "Canada": [
                                        {
                                            "count": 1,
                                            "term": "Toronto"
                                        }
                                    ],
                                    "count": 1,
                                    "term": "Canada"
                                }
                            ],
                            "United_States": [
                                {
                                    "count": 1,
                                    "term": "United States"
                                }
                            ],
                            "currency": "Dollar (USD)",
                            "index": "DOW JONES INDUS. AVG , S&P 500 INDEX , NASDAQ COMPOSITE INDEX",
                            "region": "North Americas",
                            "term": "Canada"
                        }
                    ],
                    "count": 1,
                    "term": "Country"
                },
                {
                    "Personality": [
                        {
                            "count": 1,
                            "term": "Bart Prince"
                        },
                        {
                            "count": 1,
                            "term": "Thomas"
                        },
                        {
                            "count": 1,
                            "term": "Deborah Hornstra"
                        },
                        {
                            "count": 1,
                            "term": "Henderson Sotheby"
                        },
                        {
                            "count": 1,
                            "term": "Max Alliance"
                        }
                    ],
                    "count": 5,
                    "term": "Personality"
                }
            ]
        },
        "id": "YMFT112"
    },
    {
        "Link": "http://testLink.com/2",
        "_id": "YMFT113",
        "_index": "test",
        "_source": {
            "Author": "MAX",
            "Map": [
                {
                    "Company": [
                        {
                            "Microsoft Corp": [
                                {
                                    "count": 1,
                                    "term": "Microsoft"
                                }
                            ],
                            "sector": "Technology",
                            "term": "Microsoft",
                            "ticker": "AAPL",
                            "type": "BCap"
                        }
                    ],
                    "count": 1,
                    "term": "Company"
                },
                {
                    "Country": [
                        {
                            "Brazil": [
                                {
                                    "count": 1,
                                    "term": "Brazil"
                                }
                            ],
                            "currency": "Dollar (USD)",
                            "region": "South Americas",
                            "term": "Brazil"
                        }
                    ],
                    "count": 1,
                    "term": "Country"
                },
                {
                    "SalesRelated": [
                        {
                            "count": 1,
                            "term": "traffic"
                        }
                    ]
                },
                {
                    "Personality": [
                        {
                            "count": 1,
                            "term": "Maximor"
                        },
                        {
                            "count": 1,
                            "term": "R.V.P"
                        },
                        {
                            "count": 1,
                            "term": "Wenger"
                        },
                        {
                            "count": 1,
                            "term": "SAF"
                        }
                    ],
                    "count": 4,
                    "term": "Personality"
                }
            ]
        }
    }
] 
```

[http://jsbin.com/exuwet/3/edit](http://jsbin.com/exuwet/3/edit)

* * *

提示输入 If field Selected = `Country`,

预期输出：

```
YMFT112;    Country;    United States;  United States;      NA;         http://testLink.com/1;

YMFT112;    Country;    Canada;         Canada;             Toronto;    http://testLink.com/1;

YMFT113;    Country;    Brazil;         Brazil;             NA;         http://testLink.com/2; 
```

如果字段选择 = `Company`,

预期输出：

```
YMFT112; Company;   Apple Inc;      Apple;      http://testLink.com/1;

YMFT113; Company;   Microsoft Corp; Microsoft;  http://testLink.com/2; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T11:32:37.277

您可以在本机可用时使用 JSON 对象，也可以使用[JSON2](https://github.com/douglascrockford/JSON-js/)作为 shim。

之后，只需使用 JavaScript 的内置排序功能即可。您提供一个函数，将数组项相互比较

```
var myArray = JSON.parse(jsonString);
myArray.sort(function(a, b){
    var nameA = a._source.Map.Company.term;
    var nameB = b._source.Map.Company.term;

    if (nameA === nameB) {
        return 0;
    } else if (nameA < nameB) {
        return -1
    }
    return 1;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:52:59.913

使用`eval('(' + json_object + ')')`，您将能够创建一个 JavaScript 对象。该对象将是一个数组，您可以使用`.`. 例如，如果你的`json_object`被称为数据，例如：那么

```
 var temp = eval('(' + data + ')'); // temp now is an array. 
```

如果要访问第一个`_index`或`id`从`json`对象：

```
 "_index": "test",
    "id": "YMFT112", 
```

做alert( `temp[0]._index`)，它会告诉你`"test"`。对于其他属性，遵循相同的逻辑。[这个](https://stackoverflow.com/questions/945015/alternatives-to-javascript-eval-for-parsing-json)stackoverflow 问题或[JSON](http://www.json.org/js.html)页面将帮助您了解在其他方面必须做什么才能完成任务。雅虎有一个称为[YUI](http://yuilibrary.com/yui/docs/json/)的 API ，它可能会更有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-27T02:26:42.617

这是使用[对象扫描的解决方案](https://github.com/blackflux/object-scan)

```
// const objectScan = require('object-scan');

const data = [{"_index":"test","id":"YMFT112","_source":{"Author":"SAM","Map":[{"count":1,"term":"Company","Company":[{"sector":"Technology","ticker":"AAPL","Apple_Inc":[{"count":1,"term":"Apple"}],"term":"Apple Inc","type":"BCap"}]},{"count":1,"term":"Country","Country":[{"region":"North Americas","index":"DOW JONES INDUS. AVG , S&P 500 INDEX , NASDAQ COMPOSITE INDEX","United_States":[{"count":1,"term":"United States"}],"term":"Canada","currency":"Dollar (USD)","Canada":[{"count":1,"term":"Canada","Canada":[{"count":1,"term":"Toronto"}]}]}]},{"count":5,"term":"Personality","Personality":[{"count":1,"term":"Bart Prince"},{"count":1,"term":"Thomas"},{"count":1,"term":"Deborah Hornstra"},{"count":1,"term":"Henderson Sotheby"},{"count":1,"term":"Max Alliance"}]}]},"Link":"http://testLink.com/1"},{"_index":"test","_id":"YMFT113","_source":{"Author":"MAX","Map":[{"count":1,"term":"Company","Company":[{"sector":"Technology","ticker":"AAPL","Microsoft Corp":[{"count":1,"term":"Microsoft"}],"term":"Microsoft","type":"BCap"}]},{"count":1,"term":"Country","Country":[{"region":"South Americas","Brazil":[{"count":1,"term":"Brazil"}],"term":"Brazil","currency":"Dollar (USD)"}]},{"SalesRelated":[{"count":1,"term":"traffic"}]},{"count":4,"term":"Personality","Personality":[{"count":1,"term":"Maximor"},{"count":1,"term":"R.V.P"},{"count":1,"term":"Wenger"},{"count":1,"term":"SAF"}]}]},"Link":"http://testLink.com/2"}];

const find = (term, input) => {
  const r = objectScan([`[*]._source.Map[*].${term}[*].**.term`], {
    reverse: false,
    filterFn: ({ key, parents, context }) => {
      if (Object.values(parents[0]).some((e) => e instanceof Object)) {
        return;
      }
      const root = parents[parents.length - 2];
      context.push([
        root.id || root._id,
        parents[parents.length - 5].term,
        key[key.length - 3].replace(/_/g, ' '),
        ...parents.slice(0, -7).filter((e) => !Array.isArray(e)).map((p) => p.term).reverse(),
        root.Link
      ]);
    }
  })(input, []);
  const maxLength = Math.max(...r.map((e) => e.length));
  r
    .filter((e) => e.length < maxLength)
    .forEach((e) => e.splice(-1, 0, 'NA'.repeat(maxLength - e.length)));
  return r;
};

console.log(find('Country', data).map((e) => e.join(';    ')).join('\n'));
/* =>
YMFT112;    Country;    United States;  United States;      NA;         http://testLink.com/1
YMFT112;    Country;    Canada;         Canada;             Toronto;    http://testLink.com/1
YMFT113;    Country;    Brazil;         Brazil;             NA;         http://testLink.com/2
 */
console.log(find('Company', data).map((e) => e.join(';    ')).join('\n'));
/* =>
YMFT112; Company;   Apple Inc;      Apple;      http://testLink.com/1
YMFT113; Company;   Microsoft Corp; Microsoft;  http://testLink.com/2
 */
```

```
.as-console-wrapper {max-height: 100% !important; top: 0}
```

```
<script src="https://bundle.run/object-scan@13.8.0"></script>
```

*免责声明*：我是[对象扫描的作者](https://www.npmjs.com/package/object-scan)

# objective-c - xcode的第一步 - 表视图问题

> ID：11452109
> 
> 赞同：1
> 
> 时间：2012-07-12T12:42:08.940
> 
> 标签：objective-c, cocoa, ios6

我正在尝试编写一个简单的表格视图 > 详细应用程序以开始熟悉 obj-c。我使用字典来填充表格，而不是单击一个单元格，我会看到一个空白的详细信息视图。这项工作（我自豪地说）。当我尝试将信息发送到详细视图时，情况变得更糟，这是我得到的调试错误：

**2012-07-12 14:32:41.906 StoryboardTutorial[79624:f803]-[UIView setText:]：无法识别的选择器发送到实例 0x6eae8d0**

**2012-07-12 14:32:41.908 StoryboardTutorial[79624:f803]****由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[UIView setText:]：无法识别的选择器发送到实例 0x6eae8d0”* **

 ** ***First throw call stack: (0x13ca022 0x155bcd6 0x13cbcbd 0x1330ed0 0x1330cb2 0x2d41 0xdba1e 0xdbd11 0xed8fd 0xedaef 0xeddbb 0xee85f 0xeee06 0xc8a852d 0xeea24 0x27bd 0xa55c5 0xa57fa 0x93a85d 0x139e936 0x139e3d7 0x1301790 0x1300d84 0x1300c9b 0x12b37d8 0x12b388a 0x14626 0x1c4d 0x1bb5 0x1) terminate called throwing an exception(lldb)**

这是一些代码块：

**DetailViewController.h**

```
//  DetailViewController.h

#import <UIKit/UIKit.h>

@interface DetailViewController : UIViewController{
    NSString *city;
    NSString *state;
    IBOutlet UILabel *cityLabel;
    IBOutlet UILabel *stateLabel;
}

@property (nonatomic,retain) NSString *city,*state;
@property (retain,nonatomic) IBOutlet UILabel *cityLabel,*stateLabel;

@end 
```

**细节视图控制器.m**

```
//  DetailViewController.m

#import "DetailViewController.h"

@implementation DetailViewController
@synthesize city,state,cityLabel,stateLabel;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
    stateLabel.text = state;
    cityLabel.text = city;

} 
```

**视图控制器.m**

```
-(void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    DetailViewController *detail = [self.storyboard instantiateViewControllerWithIdentifier:@"detail"];
    detail.city = [dataSource objectAtIndex:indexPath.row];
    detail.state = [states objectForKey:detail.city];
    [self.navigationController pushViewController:detail animated:YES];
    UITableViewCell *cell;
    cell = [tableView cellForRowAtIndexPath:indexPath];
    cell.textLabel.shadowColor = [UIColor clearColor];
}

- (void)setupArray{
    states = [[NSMutableDictionary alloc] init];
    [states setObject:@"Roma" forKey:@"Lazio"];
    [states setObject:@"Milano" forKey:@"Lombardia"];

    dataSource = [states allKeys];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:44:52.050

`UIView`没有`setText`方法。您正在与之交谈的`UIView`人需要有一个属性`text`才能有一个方法`setText`

错误最有可能出现在这些行之一中

```
stateLabel.text = state;
cityLabel.text = city; 
```

其中之一不能是您认为的对象类型（也就是 a`UIView`而不是 a `UILabel`）。除非你在`setText`别的地方打电话。

尝试将其更改为

```
if ([stateLabel isKindOfClass:[UILabel class]]) stateLabel.text = state;      
if ([cityLabel isKindOfClass:[UILabel class]]) cityLabel.text = city; 
```*

# c++ - 有没有办法在不使用 /UNICODE 编译的情况下使用 MFC 的 CEdit 函数“ShowBalloonTip”？

> ID：11452112
> 
> 赞同：2
> 
> 时间：2012-07-12T12:42:15.387
> 
> 标签：c++, user-interface, mfc

我们有一个用 MBCS 字符集编译的超过 100 万行的 MFC 软件，我们希望利用 CEdit 的 ShowBalloonTip 或其他“Vista 通用控件”的功能。但是在[文档](http://msdn.microsoft.com/en-us/library/bb531404)中，它指出为了使用这些功能，程序应该用 /UNICODE 编译

有没有办法在不启用 /UNICODE 的情况下使用这些功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-12T13:06:36.493

您可以自己发送 EM_SHOWBALLOONTIP 消息，不必使用 CEdit 辅助方法。但是，您当然不能避免必须提供 Unicode 字符串来初始化所需的 EDITBALLOONTIP 结构。周围有很多转换方法，mbtowc() 或 MultiByteToWideChar() 可以完成工作。

# geolocation - Sencha Touch 2 使用谷歌地图进行地理定位

> ID：11452114
> 
> 赞同：0
> 
> 时间：2012-07-12T12:42:22.750
> 
> 标签：geolocation, maps, touch, extjs

我正在尝试在我用 sencha 框架编写的应用程序上实现地理定位，但我真的不知道如何使用 Sencha Touch 2 和 Google Maps Api 实现地理定位。我有以下代码：

```
Ext.define('App.view.WhereAmI', {
    extend: 'Ext.Container',
    xtype: 'whereAmI',
    //? fullscreen: true,

    requires: [
        'Ext.Map'
    ],

    config: {
        layout: 'fit',
        scrollable: true,
        styleHtmlContent: true,
        style: 'text-align: center; background-color:white;',

        items: 
        [
            {
                xtype: 'toolbar',
                docked: 'top',
                title: 'Where Am I?',
                minHeight: '60px',
                items: [
                    {
                        ui: 'back',
                        xtype: 'button',
                        id: 'backButton',
                        text: 'Powrót',
                    },

                    {
                        minHeight: '60px',
                        right: '5px',
                        html: ['<img src="resources/images/Image.png"/ style="height: 100%; ">',].join(""),
                    },
                ],          
            },
            {
                xtype:'map',
            },
        ]
    },
    //launch : function () { },
}); 
```

我究竟需要在这个视图中添加什么来实现我当前位置的标记？

感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T12:04:44.380

尝试使用地理位置：

```
 var geo = Ext.create('Ext.util.Geolocation', {
        autoUpdate:false,
        listeners:{
            locationupdate:function (geo) {
                console.log('Current latitude: ' + geo.getLatitude() + 'Long: ' + geo.getLongitude());
            },
            locationerror:function (geo, bTimeout, bPermissionDenied, bLocationUnavailable, message) {
                if (bTimeout) {
                    alert('Timeout occurred.');
                } else {
                    alert('Error occurred.');
                }
            }
        }
    }); 
```

或添加

`useCurrentLocation:true,`

在煎茶触摸图中

# eclipse - 无法将 Oracle 10g XE 连接到 Eclipse

> ID：11452115
> 
> 赞同：1
> 
> 时间：2012-07-12T12:42:39.710
> 
> 标签：eclipse, oracle10g, database-connection

> **可能重复：**
> [Eclipse 无法在 Windows 7 上连接 oracle 10g XE](https://stackoverflow.com/questions/7055283/eclipse-cannot-connect-oracle-10g-xe-on-windows-7)

当我尝试测试连接时出现此错误..

> java.sql.SQLException：Io 异常：网络适配器无法建立连接”

现在要做什么？我也从站点下载了 ojdbc14.jar，但我仍然收到此错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:49:54.313

执行以下步骤首先使用 Sql plus 检查：

```
SQL*Plus: Release 10.2.0.1.0 - Production on Tue Jul 29 08:51:27 2008
Copyright (c) 1982, 2005, Oracle. All rights reserved.
SQL> conn system
Enter password:
Connected.
SQL> select instance_name from V$instance;
INSTANCE_NAME
----------------
xe
SQL>

Here is the listener status and services

C:\>lsnrctl services

LSNRCTL for 32-bit Windows: Version 10.2.0.1.0 - Production on 29-JUL-2008 08:46:43
Copyright (c) 1991, 2005, Oracle. All rights reserved.
Connecting to (ADDRESS=(PROTOCOL=tcp)(HOST=)(PORT=1521))
Services Summary...
Service "XEXDB" has 1 instance(s).
Instance "xe", status READY, has 1 handler(s) for this service...
Handler(s):
"D000" established:0 refused:0 current:0 max:1002 state:ready
DISPATCHER <machine: KIRANKUMAR-PC, pid: 3632>
(ADDRESS=(PROTOCOL=tcp)(HOST=KiranKumar-PC)(PORT=49160))
Service "XE_XPT" has 1 instance(s).
Instance "xe", status READY, has 1 handler(s) for this service...
Handler(s):
"DEDICATED" established:0 refused:0 state:ready
LOCAL SERVER
Service "xe" has 1 instance(s).
Instance "xe", status READY, has 1 handler(s) for this service...
Handler(s):
"DEDICATED" established:0 refused:0 state:ready
LOCAL SERVER
The command completed successfully

C:\>lsnrctl status

LSNRCTL for 32-bit Windows: Version 10.2.0.1.0 - Production on 29-JUL-2008 08:46:56
Copyright (c) 1991, 2005, Oracle. All rights reserved.
Connecting to (ADDRESS=(PROTOCOL=tcp)(HOST=)(PORT=1521))
STATUS of the LISTENER
------------------------
Alias LISTENER
Version TNSLSNR for 32-bit Windows: Version 10.2.0.1.0 - Production
Start Date 29-JUL-2008 08:39:27
Uptime 0 days 0 hr. 7 min. 29 sec
Trace Level off
Security ON: Local OS Authentication
SNMP OFF
Default Service XE
Listener Parameter File C:\oraclexe\app\oracle\product\10.2.0\server\network\admin\listener.ora
Listener Log File C:\oraclexe\app\oracle\product\10.2.0\server\network\log\listener.log
Listening Endpoints Summary...
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=KiranKumar-PC)(PORT=1521)))
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=KiranKumar-PC)(PORT=8080))(Presentation=HTTP)(Session=RAW))
Services Summary...
Service "XEXDB" has 1 instance(s).
Instance "xe", status READY, has 1 handler(s) for this service...
Service "XE_XPT" has 1 instance(s).
Instance "xe", status READY, has 1 handler(s) for this service...
Service "xe" has 1 instance(s).
Instance "xe", status READY, has 1 handler(s) for this service...
The command completed successfully

C:\>TNSPING xe
TNS Ping Utility for 32-bit Windows: Version 10.2.0.1.0 - Production on 29-JUL-2008 08:49:28
Copyright (c) 1997, 2005, Oracle. All rights reserved.
Used parameter files:
C:\oraclexe\app\oracle\product\10.2.0\server\network\admin\sqlnet.ora

Used TNSNAMES adapter to resolve the alias
Attempting to contact (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = KiranKumar-PC)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = XE)))
OK (250 msec)

C:\>tnsping localhost-pc<hostname>
TNS Ping Utility for 32-bit Windows: Version 10.2.0.1.0 - Production on 29-JUL-2008 08:49:42
Copyright (c) 1997, 2005, Oracle. All rights reserved.
Used parameter files:
C:\oraclexe\app\oracle\product\10.2.0\server\network\admin\sqlnet.ora
Used HOSTNAME adapter to resolve the alias
Attempting to contact (DESCRIPTION=(CONNECT_DATA=(SERVICE_NAME=))(ADDRESS=(PROTOCOL=TCP)(HOST=127.0.0.1)(PORT=1521)))
OK (170 msec) 
```

请检查这个...让我知道解决方案..希望这会有所帮助！

# php - 编辑 PHP 页面...在 PHP 中

> ID：11452118
> 
> 赞同：-2
> 
> 时间：2012-07-12T12:42:54.663
> 
> 标签：php, forms

对于什么是复杂的想法和项目，这是一个相当复杂的问题。我想知道是否有办法通过 PHP 页面编辑 PHP 页面的某些行？假设一个页面 (index.php) 是供公众使用的，而另一个页面 (edit.php) 将是编辑此页面上某些内容的页面。我正在寻找一种更新数据的方法，而不仅仅是替换文件。

edit.php 文件将显示当前存在的内容并允许用户更改并保存它。这可能吗？我已经可以看到回复说“你为什么不使用数据库？”......我认为这样更容易吗？任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:52:40.103

我的建议是创建一个表示他们可以编辑的信息的对象，然后使用 PHP[序列](http://uk3.php.net/manual/en/function.unserialize.php)[化](http://uk3.php.net/serialize)和反序列化将其映射到字符串并返回。

字符串可以存储在文本文件中，如果您添加新属性，PHP 会非常优雅地处理对对象的更改。

如果您希望他们实际更改 PHP 代码，它可能会非常不稳定。

# apache - CMIS：在服务器端缓存数据

> ID：11452121
> 
> 赞同：0
> 
> 时间：2012-07-12T12:43:12.150
> 
> 标签：apache, repository, cmis, apache-chemistry

我正在为我的应用程序编写一个 CMIS 接口（服务器）。服务器需要从数据库加载数据来处理请求。目前我正在为每个请求加载相同的数据。

有没有一种常用的方法来缓存这些数据。每个 cmis 客户端都支持 cookie 吗？还有其他机会缓存这些数据吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T11:44:10.017

您不应依赖 cookie。一些客户端和客户端库支持它们，但不是全部。Cookie 可以提供帮助，您应该使用它们，但要为没有 cookie 支持的简单客户端做好准备。

由于您的数据通常绑定到用户，因此您可以根据用户名构建缓存。但这取决于您的存储库和您的用例，您可以并且应该缓存什么。存储库信息和类型定义是很好的候选者。但你应该小心其他一切。

# java - 为什么使用 Android 插件进行 Jenkins 多配置作业失败？

> ID：11452125
> 
> 赞同：1
> 
> 时间：2012-07-12T12:43:26.877
> 
> 标签：java, android, testing, android-emulator, jenkins

> ...\Jenkins\workspace\AndroidTestCalculatorTest3\density\160\os\2.2\resolution\QVGA\build.xml:185：
> 
> 找不到...\android-sdks\tools\ant\build.xml 导入自
> 
> ...\Jenkins\workspace\AndroidTestCalculatorTest3\density\160\os\2.2\resolution\QVGA\build.xml

我应该怎么做才能在詹金斯不会有任何问题的服务器上导入这个文件/路径？

有时我有超时问题有没有办法改变超时的长度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T18:21:06.833

您项目中的构建文件无法从 Android SDK 中找到父级 Ant 构建文件。

在“执行 Ant 脚本”构建步骤中，在“高级...”下的“属性”下，您应该添加：

```
sdk.dir=$ANDROID_HOME 
```

这假设已经为 Jenkins 用户设置了 ANDROID_HOME 环境变量，或者您正在使用 Android Emulator Plugin（看起来像您）。

# glsl - GLSL 像素化着色器中的边框伪影

> ID：11452129
> 
> 赞同：2
> 
> 时间：2012-07-12T12:43:40.450
> 
> 标签：glsl, shader, fragment-shader

我在 GLSL 中做一个简单的像素化着色器。除了我在像素化边界看到的这个边界伪影之外，一切都按预期工作。

代码是：

```
precision mediump float;

uniform sampler2D Texture0;
uniform int pixelCount;
varying vec2 fTexCoord;

void main(void)
{
   float pixelWidth = 1.0/float(pixelCount);

   float x = floor(fTexCoord.x/pixelWidth)*pixelWidth + pixelWidth/2.0;
   float y = floor(fTexCoord.y/pixelWidth)*pixelWidth + pixelWidth/2.0;

   gl_FragColor = texture2D(Texture0, vec2(x, y));
} 
```

请看附图。

我不知道为什么会这样。
请在这件事上给予我帮助...

![像素化之间的边界伪影。](../Images/901ab4cb2188badc2b4fcd978106b753.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:44:48.583

我认为您的问题与纹理插值有关。

您是否正在使用`GL_NEAREST`纹理采样器（这使得纹理采样器使用点采样器而不是一些插值）？

```
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST );
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST ); 
```

此外，您可能不应该使用 mipmap。

了解实际纹理图像的外观以及几何形状的外观也很有用（我假设您正在渲染单个四边形）。

# android - 带有 Pinned Header 的自定义 ListView，在设置填充时导致 Jank

> ID：11452130
> 
> 赞同：10
> 
> 时间：2012-07-12T12:43:47.510
> 
> 标签：android, listview, lag

我有一个自定义列表视图，其中包含一个固定标题和 x 数量的“上推”视图，可以上推并隐藏在列表视图上方。

我附上了图片来解释它们。对不起“黑色审查”，只是为了隐藏客户标志等。

我的问题是，如果我向固定的 Header 视图添加填充，我将让列表视图项浮动在它后面。

固定标题视图的实现方法与您搜索 PinnedHeaderListView 时会发现的技术相同，即静态视图和列表视图中的标题。

我找到了一种启用填充的方法，即通过将与固定标题相同的填充应用于实际的 listView，但仅当静态标题可见时。

但是，调用 setPadding 会导致我想删除一个非常明显的 Jank。有谁知道如何删除这个卡顿？

我有一个带有简单视图和虚拟数据的简单应用程序，它没有显示此卡顿，因此卡顿的数量可能取决于单元布局的复杂性。

```
private void updateIfShouldShowStaticHeaderView() {

    //unfortunately setting the padding of the listView causes JANK.

    //any ideas?
    int bottomOfFloatingHeader = floatingHeader.getBottom();
    if (bottomOfFloatingHeader < mHeaderViewHeight) {
        staticHeaderViewIsVisible = true;
        staticHeader.setVisibility(View.VISIBLE);

        //need to set padding of listView to avoid having list-view items float behind my padded static header
        setPadding(0, staticHeader.getPaddingTop(), 0, getPaddingBottom());
    } else {
        staticHeaderViewIsVisible = false;
        staticHeader.setVisibility(View.INVISIBLE);
        //need to set padding of listView to avoid having list-view items float behind my padded static header
        setPadding(0, 0, 0, getPaddingBottom());
    }
} 
```

首先是显示上推标题的图像 ![显示上推的标题](../Images/e70786bd39572fa3b77b8dcf282ad404.png)

这是一张图片，展示了如何在填充的静态固定视图后面绘制事物。值得注意的是，如果我调整 listView 的填充，它会按预期工作，但我会在打开/关闭静态标题视图时得到 Jank (slowdown) 。

![显示如果我不调整填充可见的错误](../Images/e993f9a9d4422b6384e9be5ec4f09435.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:45:05.617

需要有关您的问题的更多信息。

据我了解，Jank 是由于您正在使用大量数据和可绘制对象。

尝试为您的视图启用硬件加速。

有关硬件加速的更多信息，请尝试此[http://developer.android.com/guide/topics/graphics/hardware-accel.html](http://developer.android.com/guide/topics/graphics/hardware-accel.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-16T13:44:39.540

由于 listView 上的 setPadding 会导致布局调用，因此效率非常低，尤其是在具有复杂 listView 单元格的情况下。一种解决方案是将背景图形添加到代表所需填充的固定标题中。这意味着整个固定的标题是实心的。然后列表视图的元素将被绘制在该图形后面。这是我们最终得到的解决方案。

它可以工作，但最好剪辑 listView。

# delphi - Delphi 函数崩溃 - StrToDateTime

> ID：11452132
> 
> 赞同：0
> 
> 时间：2012-07-12T12:43:48.923
> 
> 标签：delphi, date

谁能对我的问题提出建议。我将日期格式设置为“JUL/12 - 12 15:35”，但是当使用 StrToDateTime 时会给出 EConvertError。

我可以用这种包含 2 日期分隔符的格式做什么？

* * *

使用下一个代码

```
 function LocaleFormatStrToDateTime(const S: string): TDateTime;
        var
          LFormatSettings: TFormatSettings;
        begin
          LFormatSettings := GetLocaleFormatSettings(LOCALE_SYSTEM_DEFAULT);
          LFormatSettings.ShortTimeFormat := FormatSettings.ShortTimeFormat;
          LFormatSettings.TimeSeparator := FormatSettings.TimeSeparator;
          Result := StrToDateTime(S, LFormatSettings);
        end;

---------- 
```

**

> 最好的解决方案是使用 jvDateUtil.StrToDate*

**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T14:00:57.923

您的格式完全是非标准的（并且几乎难以理解），因此无法由内置的日期/时间格式化程序处理。

您已经设计了自己的格式，因此您需要编写自己的代码来进行转换。这是大自然告诉你不要使用[古怪的日期和时间格式](http://qurgh.wizage.net/hovpoh.htm)的方式！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-12T12:50:26.393

您尝试转换的字符串可能与默认系统格式不兼容。查看[方法签名和描述](http://www.delphibasics.co.uk/RTL.asp?Name=StrToDateTime)表明您可以覆盖它以满足您的需求，请参见[此处](https://stackoverflow.com/questions/3330679/23-02-2011-123456-is-not-valid-date-and-time)的示例。

如果您发布到目前为止的一段代码将会很有帮助，也许您忽略了一些东西。

* * *

**编辑**

我错过了您使用复杂格式的事实，包括日期的多个分隔符，我不确定 delphi 是否支持。

我想在这种情况下，您可以将字符串分成几部分，然后将[它们编码为 TDateTime](http://www.delphibasics.co.uk/RTL.asp?Name=EncodeDateTime)。要将您的月份名称转换为月份编号，您可以遍历`LFormatSettings.ShortMonthNames`数组，例如：

```
 String longMonth:= copy(S, 0, 3);
  for i := Low(LFormatSettings.ShortMonthNames) to High(LFormatSettings.ShortMonthNames) do
      if SameText(longMonth, LFormatSettings.ShortMonthNames[i]) then begin
          shortMonth:=FormatFloat('00', i);
          Break;
      end; 
```

# windows-phone-7 - XElement.Load(stream) 抛出 System.NotSupportedException

> ID：11452137
> 
> 赞同：2
> 
> 时间：2012-07-12T12:44:10.323
> 
> 标签：windows-phone-7, wp7test

当我正在获取字节数据时，我正在尝试转换为如下所示的 XELement

```
using (Stream streamResult = new MemoryStream(byteArray))
{
    XElement xElement = XElement.Load(streamResult); // exception thrown here
} 
```

以下是异常详细信息：

> System.Xml.dll PageRequest::PostProcess: System.NotSupportedException: NotSupportedException at System.Xml.XmlTextReaderImpl.ParseText(Int32& startPos, Int32& endPos, Int32& outOrChars) 在 System.Xml .XmlTextReaderImpl.FinishPartialValue() 在 System.Xml.XmlTextReaderImpl.get_Value() 在 System.Xml.Linq.XContainer.ReadContentFrom(XmlReader r) 在 System.Xml.Linq.XContainer.ReadContentFrom(XmlReader r, LoadOptions o) 在 System。 Xml.Linq.XElement.ReadElementFrom(XmlReader r, LoadOptions o) 在 System.Xml.Linq.XElement..ctor(XmlReader r, LoadOptions o)
> 在 System.Xml.Linq.XElement.Load(XmlReader reader, LoadOptions options) 在System.Xml.Linq.XElement.Load（流流，LoadOptions 选项）

XML有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T20:14:30.580

当流不包含有效的 XML 时，我在 Windows Phone 应用程序中遇到了 System.NotSupportedException。

就我而言，我使用的是来自 Web 请求的响应流，在某些情况下该请求会返回错误页面。

# django - 访问 Django 模板中过滤对象的属性

> ID：11452138
> 
> 赞同：0
> 
> 时间：2012-07-12T12:44:12.767
> 
> 标签：django

我想显示画廊列表（画廊名称和第一张图片），如下所示：

```
 {% for gallery in galleries %}
            <a href="/gallery/{{ gallery.slug }}">
              <div class="gallery_box">
                 <h2>{{ gallery.translatedName }}</h2>
                 <img src="{{ (gallery.image_set.all|first).path }}"/>
              </div>
            </a>                         
        {% endfor %} 
```

但

```
 {{ (gallery.image_set.all|first).path }} 
```

是无效的。如何访问属性“路径”

```
 {{ gallery.image_set.all|first }} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:47:38.220

而不是使用`first`过滤器，你可以做`{{ gallery.image_set.all.0.path }}`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T00:38:13.887

JamesO 有正确的答案，但如果你真的需要使用过滤器，你可以使用`with`：

```
{% with gallery.image_set.all|first as first_image %}{{ first_image.path }}{% endwith %} 
```

# sql-server-2005 - 如何合并 SQL Server Reports RDL 中具有相同值的行（特定列的）？

> ID：11452140
> 
> 赞同：3
> 
> 时间：2012-07-12T12:44:18.867
> 
> 标签：sql-server-2005, reporting-services, bids, rdl

我是使用 BIDS 中的 RDL 处理 SQL Server 2005 Reporting Servives 的新手。

我需要修改现有报告，以便可以合并相邻行中的单元格，这些单元格对于该特定列具有相同的值。

例如：考虑这是从报告 RDL 使用的存储过程返回的表。

```
_________________________________________________  
Id      SubCategory    Field1     Field2   Total  
_________________________________________________  
1       a              Bob        US       17  
1       b              John       UK       17  
2       a              Mary       AUS      12  
3       d              Ram        IND      19  
4       b              Alex       UK       09  
4       c              Abby       FR       09  
5       e              Tim        IT       03  
_________________________________________________ 
```

表格示例 - 无法格式化文本：（此处为图片：http_://i.stack.imgur.com/gWEH5.png_

我需要做的是我希望将单元格合并为一个单元格，其中同一列中的两个相邻行具有相同的值。

Like`Id 1`重复了两次，因此必须合并这些单元格。（还有`4`）

同样，`Total`对于具有 Id 的单元格的最后一列`1`，`4`必须合并。

RDL 有用于列的“TextBox”，我在这个论坛上看到了一些其他问题，但与`Tablix`Matrix 相关，所以我认为如果我提到它会更好。

我需要在 RDL 中完成这种合并，并且在导出到 Excel 时也应该存在。

希望有人能尽快提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T16:43:59.393

更改 SQL 查询以在 ID 上使用分组依据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:59:54.140

在报告服务中，将 Id On Row group Of Tablix Upaer 拖动到 Detail Group 并拖动其他字段（Total 除外）Besid ID 和表中的垂直虚线之前。并将 Total 拖到垂直虚线之后的第一个单元格

# f# - 从存储为 F# 中的概率序列的离散分布函数中提取随机数

> ID：11452142
> 
> 赞同：4
> 
> 时间：2012-07-12T12:44:22.393
> 
> 标签：f#, sequence

有一个给定的浮点数序列（在 0 和 1 之间），长度为 N，表示整数 0..N-1 上的分布函数。我们试图从这个分布中抽取一个随机数。一种方法是在 [0, 1] (float) 中绘制一个均匀随机变量，然后计算该数字的逆累积分布函数。

如果分布在一个数组中，代码将如下所示：

```
let matched distribution draw =
  let rec matchRest distribution draw start = 
    if start = Array.length distribution then start-1
    else
      let left = draw - distribution.[start]
      if left <= 0 then start
      else matchRest distribution left (start+1)
  matchRest distribution draw 0 
```

其中`distribution`是分布函数，`draw`是统一的 [0,1] 数。

当分布是任何序列时，如何重写此函数以工作？显然我可以创建一个临时数组，但这似乎不是一个优雅的解决方案......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T13:03:37.820

你的`matched`函数是一个搜索过程。您不必分解序列来搜索合适的索引；[Seq 模块](http://msdn.microsoft.com/en-us/library/ee353635.aspx)中的高阶函数可以帮助您：

```
/// Taken from http://missingfaktor.blogspot.in/2012/02/f-option-cheat-sheet.html
let getOrElse d = function
    | Some a -> a
    | None -> d

let matched distribution draw =
    distribution 
    |> Seq.scan (fun (s, d0) d -> (s+1, d0-d)) (0, draw)
    |> Seq.tryPick (fun (s, d) -> if d <= 0 then Some s else None)
    |> getOrElse (Seq.length distribution-1) 
```

在最坏的情况下，您仍然可以通过 枚举整个序列`Seq.length`。我认为如果可能的话，最好改成`Seq.length distribution-1`一个已知的常数。

# php - Magento 访问嵌套数据

> ID：11452143
> 
> 赞同：0
> 
> 时间：2012-07-12T12:44:32.133
> 
> 标签：php, magento

我有一个对象，我正在尝试从中访问数据，但似乎无法访问它。

使用`Mage::log($request->debug());`

我得到以下输出

```
Array
(
[all_items] => Array
    (
        [0 (Mage_Sales_Model_Quote_Item)] => Array
            (
                [item_id] => 593
                [quote_id] => 536
                [created_at] => 2012-07-12 11:40:17
                [updated_at] => 2012-07-12 12:10:31
                [product_id] => 37191
                [store_id] => 8
                [is_virtual] => 0
                [sku] => 30018025
                [name] => Fish Snowboard 2012
                [free_shipping] => 
                [is_qty_decimal] => 0
                [no_discount] => 0
                [weight] => 5000.0000
                [qty] => 1
                [price] => 429.12
                [base_price] => 429.12
                [discount_percent] => 0.0000
                [discount_amount] => 0.0000
                [base_discount_amount] => 0.0000
                [tax_percent] => 20
                [tax_amount] => 85.8200
                [base_tax_amount] => 85.8200
                [row_total] => 429.12
                [base_row_total] => 429.12
                [row_total_with_discount] => 0.0000
                [row_weight] => 5000
                [product_type] => simple
                [price_incl_tax] => 514.94
                [base_price_incl_tax] => 514.9400
                [row_total_incl_tax] => 514.94
                [base_row_total_incl_tax] => 514.94
                [weee_tax_disposition] => 0
                [weee_tax_row_disposition] => 0
                [base_weee_tax_disposition] => 0
                [base_weee_tax_row_disposition] => 0
                [weee_tax_applied] => a:0:{}
                [weee_tax_applied_amount] => 0
                [weee_tax_applied_row_amount] => 0
                [base_weee_tax_applied_amount] => 0
                [qty_options] => Array
                    (
                    )

                [product (OrganicInternet_SimpleConfigurableProducts_Catalog_Model_Product)] => Array
                    (
                        [entity_id] => 37191
                        [entity_type_id] => 4
                        [attribute_set_id] => 10
                        [type_id] => simple
                        [sku] => 30018025
                        [has_options] => 0
                        [required_options] => 0
                        [created_at] => 2011-06-19 17:34:46
                        [updated_at] => 2012-01-19 14:28:08
                        [name] => Fish Snowboard 2012
                        [small_image] => /f/i/fish-snowboard-2012-164.jpg
                        [thumbnail] => /f/i/fish-snowboard-2012-164.jpg
                        [url_key] => burton-fish-snowboard-2012-164cm
                        [url_path] => burton-fish-snowboard-2012-164cm
                        [msrp_enabled] => Use config
                        [msrp_display_actual_price_type] => Use config
                        [gift_message_available] => 
                        [status] => 1
                        [visibility] => 4
                        [enable_googlecheckout] => 1
                        [tax_class_id] => 2
                        [price] => 524.9400
                        [weight] => 5000.0000
                        [is_salable] => 1
                        [stock_item (Mage_CatalogInventory_Model_Stock_Item)] => Array
                            (
                                [item_id] => 35510
                                [product_id] => 37191
                                [stock_id] => 1
                                [qty] => 2.0000
                                [min_qty] => 0.0000
                                [use_config_min_qty] => 1
                                [is_qty_decimal] => 0
                                [backorders] => 0
                                [use_config_backorders] => 1
                                [min_sale_qty] => 1.0000
                                [use_config_min_sale_qty] => 1
                                [max_sale_qty] => 0.0000
                                [use_config_max_sale_qty] => 1
                                [is_in_stock] => 1
                                [notify_stock_qty] => 0.0000
                                [use_config_notify_stock_qty] => 1
                                [manage_stock] => 1
                                [use_config_manage_stock] => 1
                                [stock_status_changed_auto] => 0
                                [stock_status_changed_automatically] => 0
                                [use_config_qty_increments] => 1
                                [qty_increments] => 0.0000
                                [use_config_enable_qty_inc] => 1
                                [use_config_enable_qty_increments] => 1
                                [enable_qty_increments] => 0
                                [type_id] => simple
                                [stock_status] => 1
                                [product_name] => Fish Snowboard 2012
                                [store_id] => 8
                                [product_type_id] => simple
                                [product_status_changed] => 1
                                [ordered_items] => 1
                            )

                        [request_path] => burton-fish-snowboard-2012-164cm
                        [tier_price] => Array
                            (
                            )

                        [is_in_stock] => 1
                        [store_id] => 8
                        [customer_group_id] => 0
                    )

                [tax_class_id] => 2
                [has_error] => 
                [is_nominal] => 
                [base_original_price] => 514.9400
                [taxable_amount] => 514.94
                [base_taxable_amount] => 514.94
                [is_price_incl_tax] => 1
                [discount_calculation_price] => 429.12
                [base_discount_calculation_price] => 429.12
                [base_weee_tax_applied_row_amount] => 0
            )

    )

[dest_country_id] => GB
[dest_region_code] => 
[dest_street] => ndjn
[dest_city] => ihho
[dest_postcode] => iohih
[package_value] => 514.94
[package_value_with_discount] => 429.12
[package_weight] => 5000
[package_qty] => 1
[package_physical_value] => 429.12
[free_method_weight] => 5000
[store_id] => 8
[website_id] => 4
[free_shipping] => 0
[base_currency (Mage_Directory_Model_Currency)] => Array
    (
        [currency_code] => GBP
    )

[package_currency (Mage_Directory_Model_Currency)] => Array
    (
        [currency_code] => GBP
    )

[country_id] => GB
[region_id] => 0
[city] => 
[postcode] => 
[p_rcondition_name] => package_standard
[ignore_free_items] => 
) 
```

我想访问`$request[all_items][0][price]`和`$request[all_items][0][product][price]`

我尝试了不同的视图，但无论我做什么，我似乎都无法得到我想要的部分。

一旦你知道如何，我相信它很简单：P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:59:02.663

你可以试试这个：

```
$items = $request->getAllItems();
$itemPrice = $items[0]->getPrice();
$productPrice = $items[0]->getProduct()->getPrice(); 
```

您可以在此处找到有关 Varien_Object 的一些信息：http: [//alanstorm.com/magento_varien_object_debugging](http://alanstorm.com/magento_varien_object_debugging)

# java - 在与服务不同的命名空间/包中定义 WebFault（使用 cxf / jax-ws）

> ID：11452144
> 
> 赞同：0
> 
> 时间：2012-07-12T12:44:32.050
> 
> 标签：java, web-services, jax-ws, cxf

我正在使用带有 cxf 实现的 jax-ws 来实现 Web 服务。
我有几个使用 @WebService 注释注释的服务。
在不同的包中，我定义了异常（从 RuntimeException 继承）并使用具有唯一命名空间的 @WebFault 注释它们。每个异常类都拥有一个带有异常数据 (faultInfo) 的 bean，该异常数据 (faultInfo) 与故障位于相同的命名空间和包中，并使用 @XMlType 进行注释。
示例：
故障类别：

```
@WebFault(name = "GeneralRemoteFault", targetNamespace = WebServices.MyNamespace)
public class GeneralRemoteFault extends RuntimeException
{
    private GeneralRemoteFaultException faultInfo;
    public GeneralRemoteFault(String message, GeneralRemoteFaultException faultInfo) {
        super(message);
        this.faultInfo = faultInfo;
    }
    public GeneralRemoteFault(String message, GeneralRemoteFaultException faultInfo, Throwable cause) {
        super(message, cause);
        this.faultInfo = faultInfo;
    }
    public GeneralRemoteFaultException getFaultInfo() {
        return faultInfo;
    }
} 
```

故障 Bean：（使用将其放入 WebServices.MyNamespace 命名空间的 package-info）

```
@XmlType(name = "GeneralRemoteFaultException ")
public class GeneralRemoteFaultException 
{
    private String objId;
    public GeneralRemoteFaultException () {}
    public GeneralRemoteFaultException (String objId)
    {
        this.objId = objId;
    }
    public String getObjId()
    {
        return objId;
    }
    public void setObjId(String objId)
    {
        this.objId = objId;
    }
} 
```

服务方式：

```
List<ValidationErrors> validateObject(
        @WebParam(name = "object") ValidationObject object,
        @WebParam(name = "groups") String[] groups) throws GeneralRemoteFault; 
```

当我运行服务器 CXF 时抱怨以下错误：

```
ERROR org.apache.cxf.service.factory.ReflectionServiceFactoryBean.fillInSchemaCrossreferences:305
[main] - Schema element {http://www.example.com/schema}ValidationRemoteFault references undefined type
{http://www.example.com/schema}ValidationRemoteFaultException for service {http://web_services.example.com/}ValidationService 
```

在调试运行服务的代码后，我注意到模式集合（XmlSchemaCollection.schemas）不包括故障 bean 的命名空间，这就是它失败的原因（它只包含服务和故障）。似乎 CXF 没有考虑到错误 bean 将被定义在一个单独的命名空间中而不是其他的选项，并且不会将错误 bean 模式加载到模式集合中。即使我将故障 bean 与故障（如上定义）放在同一个命名空间中，命名空间的模式 (XmlSchema) 也不会仅包含故障的 JAXB 类型。

任何有关解决错误的见解将不胜感激。

这是弹出消息的堆栈：

```
at org.apache.ws.commons.schema.XmlSchemaCollection.getTypeByQName(XmlSchemaCollection.java:229)
at org.apache.cxf.common.xmlschema.SchemaCollection.getTypeByQName(SchemaCollection.java:109)
at org.apache.cxf.service.factory.ReflectionServiceFactoryBean.fillInSchemaCrossreferences(ReflectionServiceFactoryBean.java:301)
at org.apache.cxf.service.factory.ReflectionServiceFactoryBean.create(ReflectionServiceFactoryBean.java:269)
  - locked <0x1670> (a org.apache.cxf.jaxws.support.JaxWsServiceFactoryBean)
at org.apache.cxf.jaxws.support.JaxWsServiceFactoryBean.create(JaxWsServiceFactoryBean.java:205)
at org.apache.cxf.frontend.AbstractWSDLBasedEndpointFactory.createEndpoint(AbstractWSDLBasedEndpointFactory.java:101)
at org.apache.cxf.frontend.ServerFactoryBean.create(ServerFactoryBean.java:159)
at org.apache.cxf.jaxws.JaxWsServerFactoryBean.create(JaxWsServerFactoryBean.java:207)
at org.apache.cxf.jaxws.EndpointImpl.getServer(EndpointImpl.java:442)
  - locked <0x1678> (a org.apache.cxf.jaxws22.EndpointImpl)
at org.apache.cxf.jaxws.EndpointImpl.doPublish(EndpointImpl.java:329)
at org.apache.cxf.jaxws.EndpointImpl.publish(EndpointImpl.java:246) 
```

谢谢，
阿夫纳

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T08:20:46.163

它应该可以工作，但尝试强制 JAXB 使用相同的命名空间设置错误 bean 的注释`namespace`属性，如下所示`@XmlType`

```
@XmlType(name = "GeneralRemoteFaultException ", namespace = WebServices.MyNamespace) 
```

此外，您可以强制您的 Web 服务类使用相同的命名空间来设置注释`targetNamespace`中的属性，如下所示：`@WebService`

```
@WebService(name = "myService", targetNamespace =  WebServices.MyNamespace) 
```

如果这不起作用，请添加生成的 WSDL 以检查命名空间问题。

# ios - 在 iOS 上自动清除缓存文件夹（清空/清除）

> ID：11452145
> 
> 赞同：15
> 
> 时间：2012-07-12T12:44:36.563
> 
> 标签：ios, caching, storage, mission-critical

我有一个应用程序，可让您下载可以扩展您的应用程序使用的“模块”。
当用户下载一个模块时，我从服务器获取一个 ZIP 文件并将其解压缩到他的 Caches 文件夹中。（每个 zip 的大小都可以从 60k 到 2MB）。

不幸的是，有超过**300 个**模块可用，许多用户至少将其中的 50-60 个下载到他们的设备上。

最近，我收到很多抱怨说模块只是从用户设备上*消失*了，所以我做了一些调查，并在 Apple 的文档中发现了以下措辞。

> iOS 会在必要时从 Caches 目录中删除您的文件，因此如果数据文件被删除，您的应用程序将需要正常降级。

还有以下文章进一步解释了这种情况：http: [//iphoneincubator.com/blog/data-management/local-file-storage-in-ios-5](http://iphoneincubator.com/blog/data-management/local-file-storage-in-ios-5)

我的问题是，我没有**优雅**降级的实际方法，因为我不能自动让用户下载这么多模块。这可能需要几个小时，具体取决于互联网连接和模块的大小。

所以我有几个问题：

1.  你们中是否有人不得不处理类似的情况，如果是，如何处理？
2.  有谁知道 iOS 何时清除缓存？什么被认为是“低空间”警告？这样我至少可以给用户一个警告，说他没有足够的空间来安装新模块。
3.  有没有办法在缓存文件夹被清除之前收到某种警告？

这是苹果公司的一个非常令人沮丧的举动，我真的看不到出路。真的很想听听你的一些想法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-12T14:01:42.830

**编辑**：经过一些测试，这似乎工作得很好并且没有被清除。

这还没有 100% 得到证实，但它在我们的基本测试中运行良好（我会在结果出来时发布更全面的结果）。似乎将数据保存到应用程序的“应用程序支持”文件夹可以解决这些问题，因为该文件夹没有被清除。

[文档](http://developer.apple.com/library/ios/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/AccessingFilesandDirectories/AccessingFilesandDirectories.html#//apple_ref/doc/uid/TP40010672-CH3-SW11)状态：

> 使用应用程序支持目录常量**NSApplicationSupportDirectory**，附加您的`<bundle_ID>`for: 您的应用程序为用户创建和管理的资源和数据文件。您可以使用此目录来存储应用程序状态信息、计算或下载的数据，甚至是您代表用户/自动保存文件管理的用户创建的数据。`

您可以按如下方式访问该文件夹（按照苹果官方文档的要求，注意附加捆绑包 ID）：

```
[[NSSearchPathForDirectoriesInDomains(NSApplicationSupportDirectory, NSUserDomainMask, YES) lastObject] stringByAppendingPathComponent:[[NSBundle mainBundle] bundleIdentifier]] 
```

希望这对任何人都有帮助，正如我所说，我将在周末发布更全面的测试结果。

***编辑 2：*** 添加此行以防止从应用程序支持同步临时内容非常重要。我在 applicationDidFinishLaunching 的末尾使用它：

```
[[NSURL URLWithString:NSApplicationSupportDir] setResourceValue:@(YES) forKey:NSURLIsExcludedFromBackupKey error:nil]; 
```

# c# - 在 C# 中递归复制目录时文件正在使用错误

> ID：11452154
> 
> 赞同：0
> 
> 时间：2012-07-12T12:45:17.250
> 
> 标签：c#, directory, copy

我正在尝试使用以下函数将包括所有子目录的整个目录复制到同一驱动器上的另一个文件夹：

```
 private static void CopyAll(DirectoryInfo source, DirectoryInfo target)
    {
        // Check if the target directory exists, if not, create it.
        if (Directory.Exists(target.FullName) == false)
        {
            Directory.CreateDirectory(target.FullName);
        }

        // Copy each file into it’s new directory.
        foreach (FileInfo fi in source.GetFiles())
        {
            Console.WriteLine(@"Copying {0}\{1}", target.FullName, fi.Name);
            fi.CopyTo(Path.Combine(target.ToString(), fi.Name), true);
        }

        // Copy each subdirectory using recursion.
        foreach (DirectoryInfo diSourceSubDir in source.GetDirectories())
        {
            DirectoryInfo nextTargetSubDir = target.CreateSubdirectory(diSourceSubDir.Name);
            CopyAll(diSourceSubDir, nextTargetSubDir);
        }
    } 
```

调用：

```
 public void copyTemplate(string templatepath, string destpath)
    {
        DirectoryInfo s = new DirectoryInfo(@"C:\temp\templates\template1");
        DirectoryInfo t = new DirectoryInfo(@"C:\temp\www_temp\gtest");

        CopyAll(s, t);
    } 
```

这会产生错误：

```
The process cannot access the file 'C:\temp\templates\template1\New folder\alf.txt' because it is being used by another process. 
```

我没有使用该文件，第三方软件告诉我没有进程正在锁定该文件，所以我怀疑复制功能在某处跳闸。

任何人都可以阐明为什么会发生这种情况或建议一个可以更好地完成这项工作的功能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:43:33.970

您可能需要考虑锁定对文件的访问，它不应该过多地降低您的速度，并且应该避免同时访问文件的任何尝试。

```
private object lockObj = new object();

lock(lockObj)
{
 //Code to access file
} 
```

这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:18:45.703

用下面的替换 CopyAll() 函数解决了这个问题。

```
public static void CopyFolder(string sourceFolder, string destFolder)  
        {  
            if (!Directory.Exists(destFolder))  
                Directory.CreateDirectory(destFolder);  
            string[] files = Directory.GetFiles(sourceFolder);  
            foreach (string file in files)  
            {  
                string name = Path.GetFileName(file);  
                string dest = Path.Combine(destFolder, name);  
                File.Copy(file, dest);  
            }  
            string[] folders = Directory.GetDirectories(sourceFolder);  
            foreach (string folder in folders)  
            {  
                string name = Path.GetFileName(folder);  
                string dest = Path.Combine(destFolder, name);  
                CopyFolder(folder, dest);  
            }  
        } 
```

# linux - Chrome Kiosk 模式会忽略缩放设置

> ID：11452157
> 
> 赞同：0
> 
> 时间：2012-07-12T12:45:22.703
> 
> 标签：linux, google-chrome, zooming, kiosk

我有一个简单的 shell 脚本，可以在某个 url 上以 kiosk 模式启动 chromium。它工作正常，但在自助服务终端模式下，Chrome 设置的缩放级别似乎被忽略了。

我通常可以使用 ctrl + 或 ctrl - 来放大或缩小，但如果浏览器在没有“人工帮助”的情况下从脚本运行，这显然不是一个选项

由于屏幕分辨率低，默认放大太多。我尝试了 Chrome Autozoom 扩展，但由于某种原因，这使它缩小*了*太多（我设置扩展的缩放级别并不重要）。

我只想在 Kiosk 模式下启动浏览器时指定缩放级别。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T17:28:08.160

我们有相同的设置 [ linux kiosk 在 kiosk 模式下运行 chrome ] 但我还没有看到这个。您可以在 Chrome 中设置默认缩放设置：

[http://fartersoft.com/blog/2010/11/12/setting-a-default-zoom-level-for-chrome-browser/](http://fartersoft.com/blog/2010/11/12/setting-a-default-zoom-level-for-chrome-browser/)

您是否正在同步主目录并可能覆盖 chrome 的设置目录？您的设置中必须有某种机制覆盖设置 --- 或者可能是权限问题。在启用您的隐私/安全设置和脚本之前，请务必按照您想要的方式设置 Chrome --- 确保设置正确---。

如果 chrome 无法写入它的配置目录，或者，如果该目录被覆盖，您的设置将不会被保留 --- 否则，像您描述的信息亭应该使用您指定的设置。正如我所说，我们以这种方式设置信息亭，并为低分辨率的触摸屏设置默认缩放设置。

有关您的设置的任何其他信息可能会影响此问题吗？

# hadoop - 使用 MR1 CDH4 运行简单的 MapReduce Streaming 作业失败

> ID：11452158
> 
> 赞同：2
> 
> 时间：2012-07-12T12:45:30.677
> 
> 标签：hadoop, hadoop-streaming

我有一个运行 CDH4 的集群最近从 CDH3 升级。Hive 目前运行良好。但是我似乎无法让它运行甚至简单的 MR Streaming 作业（版本 1）。纱线已安装但未使用。这是命令行输入和输出

```
$ /usr/lib/hadoop/bin/hadoop jar /usr/lib/hadoop-0.20-mapreduce/contrib/streaming/hadoop-  streaming-2.0.0-mr1-cdh4.0.0.jar grep -input /input -output /output/ 'dfs[a-z.]+' 
```

检查日志揭示了这一点：

```
packageJobJar: [/tmp/hadoop-hdfs/hadoop-unjar7491355516546899751/] [] /tmp/streamjob1375201380112960182.jar tmpDir=null
12/07/12 07:26:29 WARN mapred.JobClient: Use GenericOptionsParser for parsing the arguments. Applications should implement Tool for the same.
12/07/12 07:26:29 INFO util.NativeCodeLoader: Loaded the native-hadoop library
12/07/12 07:26:29 WARN snappy.LoadSnappy: Snappy native library is available
12/07/12 07:26:29 INFO snappy.LoadSnappy: Snappy native library loaded
12/07/12 07:26:29 INFO mapred.FileInputFormat: Total input paths to process : 3
12/07/12 07:26:29 INFO streaming.StreamJob: getLocalDirs(): [file:////data/hadoop-0.20/cache/mapred/mapred/local]
12/07/12 07:26:29 INFO streaming.StreamJob: Running job: job_201207120604_0018
12/07/12 07:26:29 INFO streaming.StreamJob: To kill this job, run:
12/07/12 07:26:29 INFO streaming.StreamJob: UNDEF/bin/hadoop job  -Dmapred.job.tracker=frost:54311 -kill job_201207120604_0018
12/07/12 07:26:29 INFO streaming.StreamJob: Tracking URL: >http://alpha:50030/jobdetails.jsp?jobid=job_201207120604_0018
12/07/12 07:26:30 INFO streaming.StreamJob:  map 0%  reduce 0%
12/07/12 07:26:57 INFO streaming.StreamJob:  map 100%  reduce 100%
12/07/12 07:26:57 INFO streaming.StreamJob: To kill this job, run:
12/07/12 07:26:57 INFO streaming.StreamJob: UNDEF/bin/hadoop job  -Dmapred.job.tracker=frost:54311 -kill job_201207120604_0018
12/07/12 07:26:57 INFO streaming.StreamJob: Tracking URL: >http://alpha:50030/jobdetails.jsp?jobid=job_201207120604_0018
12/07/12 07:26:57 ERROR streaming.StreamJob: Job not successful. Error: NA
12/07/12 07:26:57 INFO streaming.StreamJob: killJob...
Streaming Command Failed! 
```

日志输出很多失败减少任务：

```
2012-07-12 07:26:46,785 INFO org.apache.hadoop.mapred.TaskInProgress: Error from attempt_201207120604_0018_m_000001_2: java.io.IOException: Type mismatch in key from map: expected org.apache.hadoop.io.Text, recieved org.apache.hadoop.io.LongWritable
    at org.apache.hadoop.mapred.MapTask$MapOutputBuffer.collect(MapTask.java:861)
    at org.apache.hadoop.mapred.MapTask$OldOutputCollector.collect(MapTask.java:501)
    at org.apache.hadoop.mapred.lib.IdentityMapper.map(IdentityMapper.java:38)
    at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:50)
    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:393)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:327)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:270)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:416)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1232)
    at org.apache.hadoop.mapred.Child.main(Child.java:264) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:21:50.453

您能否查看为您提交的作业生成的 job.xml（通过 JobTracker Web 界面），并查看映射器的定义值是什么？（`mapreduce.map.class`财产）。

从您包含的映射日志中，您可能已经配置了身份映射器（因此 LongWritable 作为输出键出现，而不是文本的作业定义值）：

> 映射中键的类型不匹配：预期 org.apache.hadoop.io.Text，收到 org.apache.hadoop.io.LongWritable

如果是这种情况，您需要查看 2.0.0 hadoop 的 Streaming 代码（我没有立即手头），以查看`hadoop-streaming-2.0.0-mr1-cdh4.0.0.jar`使用您的参数启动 jar 将如何配置和运行作业

# javascript - 如何处理网页中的后台 ajax 调用

> ID：11452159
> 
> 赞同：0
> 
> 时间：2012-07-12T12:45:33.703
> 
> 标签：javascript, jquery, html, css, ajax

我这里有一个情况：

我有一个带有中间对话框弹出窗口（由下拉菜单组成）的用户登录表单，以验证由 ajax 调用填充的用户角色。

问题是当我单击提交表单时，中间对话框弹出窗口和下拉列表中没有填充角色，它会在下拉列表为空的 5-7 秒后填充。

我们可以在 ajax 中处理，使用状态或者当 ajax 完成时，我们可以弹出填充下拉列表的对话框。

下面是我的代码：

形式

```
<form name = "loginForm" method="post" action="#">
    <div class = "container">
    <table>
        <tr>
            <td>
                <h1 class = "heading">Enhanced Quality Control 2.0</h1><br>
            </td>
        </tr>
        <tr>
            <td>
                <table class = "maintable">
                    <tr>
                        <td>
                            <table>
                                <tr>
                                    <td>
                                        <label for="login">Login ID&nbsp;&nbsp;</label>
                                    </td>
                                    <td>    
                                        <input id="login" type="text" onfocus="clearDefault(this.value);" onblur="setDefault();" value="Enter your Login ID" style="position:relative; margin-left: 80px; background-color:#19A053;border:none;width:100%;height:26px;color:#FFFFFF;font-size:20px;padding-left:10px;font-style:italic"/>
                                    </td>
                                </tr>   
                                <tr>
                                    <td>
                                        <br><label for="password" >Password&nbsp;&nbsp;</label>
                                    </td>
                                    <td>
                                        <br>
                                        <input id="password" type="password" onfocus="clearDefault(this.value);" onblur="setDefault();" value="Enter Password" style = "position:relative; margin-left: 80px; background-color:#19A053;border:none;width:100%;height:26px;color:#FFFFFF;font-size:20px;padding-left:10px;font-style:italic"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>
                                        <br>
                                        <input type = "checkbox" style= "background-color:#19A053" style="position:relative; margin-left: 80px; background-url:images/user.png">&nbsp;&nbsp;Remember me next time</input>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>
                                        <br>
                                        <img class="submit" src = "images/button.PNG" name = "image" style="position:relative; margin-left: 80px; background-color:#19A053;border:none;" />
                                        <input type="hidden" value="" id="role" />
                                    </td>   
                                </tr>
                            </table>
                        </td>
                        <td>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    </div>
    </form>

Intermediate Dialog Code

<div id="dialog" title="Select User Role" style="display:none;">
        <p>You have multiple user roles assigned. Please select any one of the roles and click on the 'Continue' button.</p>
        <table>
            <tr>
                <td>Select user role</td>
                <td>
                    <div class="dropdown" id="dropdown">
                        <select id="roles" name="Select user role" style="z-index: 10;"> //EMPTY DROPDOWN
                    </select>
                </div>
                </td>
            </tr>
        </table>
    </div>

SCRIPT CODE
    **

    $(document).ready(function(){ 
                // Dialog Link
                $('.submit').click(function () {
                    makeGetRequest();           //Call for First Click and shoot ajax call
                });

                function makeGetRequest() { // AJAX CALL METHOD
                    var login = document.getElementById('login').value;
                    var password = document.getElementById('password').value;
                    http.open('get', 'ajax.jsp?login=' + login+ '&password=' + password);
                    http.onreadystatechange = processResponse; //CALLBACK FUNCTION
                    http.send(null);
                }

    //AJAX CALLBACK FUNCTION - Issue is the dialog opens up before the dropdown is populated i need to wait a bit 
                function processResponse() {
                    if(http.readyState == 4 && http.status == 200){
                        var response = http.responseText;

**
                    document.getElementById('roles').innerHTML = response;
                    $('#dialog').dialog('open'); //Dialog Opens before data is ready in my "roles" dropdown
                }

            } 
```

提前致谢！！！！干杯...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:49:48.150

考虑使用[jQuery.get()](http://api.jquery.com/jQuery.get/)函数在返回函数（数据）中添加要在 ajax 返回时执行的脚本：

```
$.get('ajax/test.html', function(data) {

    $('.result').html(data);
    alert('Load was performed.');

}); 
```

其中 data 是您的服务器响应。

# c++ - 为什么在父类中声明虚函数时出现未解决的外部错误？

> ID：11452160
> 
> 赞同：4
> 
> 时间：2012-07-12T12:45:34.297
> 
> 标签：c++, class, function, virtual, parent

我有这个父类：

```
enum UI_STATE
{
    UI_STATE_SPLASH_SCREEN,
    UI_STATE_LOGIN_SCREEN,
    UI_STATE_CHARACTER_CREATION_SCREEN,
    UI_STATE_CHARACTER_CHOOSE_SCREEN,
    UI_STATE_LOADING_SCREEN,
    UI_STATE_GAMEPLAY,
    UI_STATE_EXIT_REQUESTED,
    UI_STATE_UNKNOWN
};

[event_source(native)]
class UserInterface
{
protected:
    MyGUI::Gui *mGUI;

public:
    static UserInterface *Instance;
    UI_STATE UI_CURRENT_STATE;

public:
    UserInterface()
    {
        MyGUI::OgrePlatform* mPlatform = new MyGUI::OgrePlatform();
        mPlatform->initialise(BaseObjects::mWindow, BaseObjects::mSceneMgr);
        mGUI = new MyGUI::Gui();
        mGUI->initialise();

        UI_CURRENT_STATE = UI_STATE_UNKNOWN;
    }

    ~UserInterface()
    {
        mGUI->destroyAllChildWidget();
        mGUI->shutdown();

        delete mGUI;
        mGUI = NULL;

        delete Instance;
        Instance = NULL;
    }

    virtual void update();
    virtual void GAMEPLAY_SCREEN_ShowTargetBox();
    virtual void GAMEPLAY_SCREEN_HideTargetBox();

...//some other methods
}

UserInterface *UserInterface::Instance = NULL; 
```

还有两个子类，其中一个是覆盖这 3 个虚拟函数，第二个是对这 3 个函数不做任何事情。

孩子 1：

```
#ifndef GameplayScreenInterface_h
#define GameplayScreenInterface_h

#include "UserInterface.h"
#include "ControllableCharacterAdv.h"

class GameplayScreenUserInterface : public UserInterface
{
private:
...

public:
    GameplayScreenUserInterface()
    {
...
    }

    void GAMEPLAY_SCREEN_ShowTargetBox()
    {
        ...
    }

    void GAMEPLAY_SCREEN_HideTargetBox()
    {
        ...
    }

    void update()
    {
        UpdateTargetBox();
        UpdateCharacterBox();
    }

    void UpdateCharacterBox()
    {
...
    }

    void UpdateTargetBox()
    {
        if (...)
        {
            if (...)
            {
            ...
            }
            else if (...)
            {
...
            }
            else
            {
            ...
            }
        }
        else
            GAMEPLAY_SCREEN_HideTargetBox();
    }
};

#endif GameplayScreenInterface_h 
```

和孩子 2：

```
#ifndef LoginScreenInterface_h
#define LoginScreenInterface_h

#include "UserInterface.h"
#include "NetworkManager.h"

class LoginScreenUserInterface : public UserInterface
{
public:
    LoginScreenUserInterface()
    {
...
    }
};

#endif LoginScreenInterface_h 
```

和编译错误:(

```
Error 9 error LNK1120: 3 unresolved externals
Error 8 error LNK2001: unresolved external symbol "public: virtual void __thiscall UserInterface::GAMEPLAY_SCREEN_HideTargetBox(void)" (GAMEPLAY_SCREEN_HideTargetBox@UserInterface@@UAEXXZ)
Error 7 error LNK2001: unresolved external symbol "public: virtual void __thiscall UserInterface::GAMEPLAY_SCREEN_ShowTargetBox(void)" (GAMEPLAY_SCREEN_ShowTargetBox@UserInterface@@UAEXXZ)
Error 6 error LNK2001: unresolved external symbol "public: virtual void __thiscall UserInterface::update(void)" (?update@UserInterface@@UAEXXZ) 
```

任何人都知道如何摆脱这些错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T12:50:06.573

这些不是编译错误，而是链接错误。您的源代码编译得很好，但是您没有在基类中提供三个虚函数的实现。

当你在类声明中提到成员函数时，你所做的只是*声明*函数：你告诉编译器函数的名称是什么，它的参数类型是什么，它的返回类型是什么；这让编译器很高兴。您仍然需要提供一些实现，或标记函数抽象，以满足链接器的要求。

在你的 cpp 文件中`UserInterface`添加这些：

```
void UserInterface::update() {
    // default implementation
}
void UserInterface::GAMEPLAY_SCREEN_ShowTargetBox() {
    // default implementation
}
void UserInterface::GAMEPLAY_SCREEN_HideTargetBox() {
    // default implementation
} 
```

或者，如果这些虚函数中的一些或全部没有默认实现，`= 0`请在标题中添加：

```
virtual void update() = 0;
virtual void GAMEPLAY_SCREEN_ShowTargetBox() = 0;
virtual void GAMEPLAY_SCREEN_HideTargetBox() = 0; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-12T12:48:53.940

因为您需要定义一个主体`UserInterface::GAMEPLAY_SCREEN_HideTargetBox`（它可能是一个空的实现，如果这对您和您的应用程序的逻辑来说是可以的）。

如果您不想在基类中定义此函数，请将其设为纯虚拟：

```
virtual void GAMEPLAY_SCREEN_HideTargetBox() = 0; 
```

这将使您的基类`UserInterface`抽象（您将无法创建具有 type 的对象`UserInterface`）并且所有派生类（您希望是非抽象的）*必须*为此函数定义主体。

PS 这些是链接器错误，而不是编译器错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:07:53.870

编译器无法通过查看您的源代码来证明没有人会自己实例化父类。因此，它为父创建虚拟方法表，并且为了初始化该表，链接器正在寻找父函数的地址。

为避免这种情况，您需要通过将 =0 附加到定义来声明父函数纯虚拟。这样编译器将自己禁止父类的实例化，将 NULL 放入 VMT 并且链接器无需寻找任何东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T13:03:56.930

真的很快，它是“基”类和“派生”类（或“子类”），而不是父类和子类。

自从我从事 C++ 工作以来已经有十年了，但我相信问题是因为您的 LoginScreenUserInterface 类没有实现虚拟方法。如果一个虚方法没有被覆盖，那么基类实现就会被调用。由于您没有方法基类实现。您收到链接错误。如果你想拥有一个没有默认实现的虚拟基类，你应该通过在末尾添加一个 = 1 来将其声明为纯虚拟：

虚拟无效更新（）= 0；

这将迫使任何派生类提供实现。如果您不想强制派生类提供实现，请在基类中提供类似 { } 的内容。

# c# - 以通用方式调用方法

> ID：11452161
> 
> 赞同：0
> 
> 时间：2012-07-12T12:45:37.180
> 
> 标签：c#, .net, collections, types

使用此代码，我通过其名称获取某个对象的属性：

```
string propName = "Buttons"; // getting this runtime
Type t = container.GetType();
PropertyInfo p = t.GetProperty(propName);
object prop = p.GetValue(container, null); 
```

属性的类型取决于属性名称，但所有属性都实现了`IList`接口，因此它们都有`Add()`方法。现在我希望能够使用此方法向该属性添加元素。但是我不能在`object`类型上调用这个方法。我需要以某种方式将其转换为运行时，但在此之前我必须以某种方式使用`prop.Add()`，这当然会触发编译错误。有没有办法在运行时独立于对象类型调用方法（当然要确保对象具有该方法）。

PS如果问题不清楚，我可以添加更多细节。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:47:14.830

只需将结果转换为`IList`?

```
IList prop = (IList)p.GetValue(container, null); 
```

然后，您将可以访问`IList`成员。当然，这假设您是正确的，因为它们总是正确的，`IList`否则您将开始得到`InvalidCastException`s。

* * *

或者，但我不建议这样做，您始终可以假设该`Add`方法存在并使用动态鸭子类型：

```
dynamic prop = p.GetValue(container, null);
prop.Add("Foo"); 
```

以上将在运行时使用 DLR 解决。它将尝试找到一个`Add`采用单个`string`参数的公共方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:49:08.520

```
MethodInfo methodInfo = t.GetMethod("Add");
result = methodInfo.Invoke(prop, parametersArray); 
```

# c# - 如何调整标签的字符间距

> ID：11452169
> 
> 赞同：1
> 
> 时间：2012-07-12T12:46:27.573
> 
> 标签：c#, asp.net, label

如何调整标签控件中的字符间距。属性窗口中没有这样的属性。

```
<asp:Label ID="label01" runat="server" Text="EXPLORATIONS" Font-Bold="True"     
Font-Names="Verdana" Font-Size="Small" ForeColor="#999999"></asp:Label> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:49:12.580

您可以使用 CSS[`letter-spacing`属性](http://www.w3schools.com/cssref/pr_text_letter-spacing.asp)：

```
<asp:Label ID="label01" runat="server" Text="EXPLORATIONS" Font-Bold="True" Font-Names="Verdana" Font-Size="Small" ForeColor="#999999" CssClass="YourStyle" />

<style>
.YourStyle
{
    letter-spacing: 4px;
}
</style> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-12T12:48:41.057

您可以将 a`CssClass`应用于您`Label`可以在其中指定字母间距的控件。

像这样的东西

```
<style type="text/css">
        .spacing
        {
            letter-spacing:12px;
        }
</style>

<asp:Label ID="Label1" runat="server" Text="Your nice text line" 
      CssClass="spacing" /> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-12T12:49:21.537

使用[css](/questions/tagged/css "显示标记为“css”的问题")，您可以调整[字母间距](https://developer.mozilla.org/en/CSS/letter-spacing)：

```
label#label01{
    letter-spacing: 1em;
} 
```

# emacs - emacs Dired 查找上一个匹配项

> ID：11452173
> 
> 赞同：1
> 
> 时间：2012-07-12T12:46:38.703
> 
> 标签：emacs

我在dired中标记了一堆文件

然后点击`A`通过它们搜索正则表达式

从那里`M-,`进入下一场比赛

我如何回到最后一场比赛？

即`M-,`在这种情况下与此相反的是什么

*我知道你可以做到这一点，但我在任何地方*的文档中都找不到任何东西

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T15:58:48.107

我不认为 dired/tags 会这样做。

您正在调用的功能`M-,`似乎`tags-loop-continue,`是最终`re-search-forward`只能使用的。如果你想看一下，这两个函数是定义的`etags.el`，但似乎没有任何类似`tags-loop-goback`函数或等价物的东西。

但是，正如gnu-emacs-help 邮件列表中关于与您的问题相同的问题的[讨论中所指出的，](http://lists.gnu.org/archive/html/help-gnu-emacs/2008-02/msg00444.html) [Icicles](http://emacswiki.org/emacs/Icicles)显然可以做您想做的事。*

# entity-framework - Automapper 和延迟加载与 EF 和性能

> ID：11452176
> 
> 赞同：2
> 
> 时间：2012-07-12T12:46:43.473
> 
> 标签：entity-framework, automapper

我有一个这样的模型

```
public class Exam
{
    public int NewsId { get; set; }
    public string Title { get; set; }
    public string Description{ get; set; }
    public string Program{ get; set; }
 } 
```

和这样的视图模型

```
public class ExamViewModel
{
    public int NewsId { get; set; }
    public string Title { get; set; }
} 
```

我像这样配置Automapper

```
AutoMapper.Mapper.CreateMap<Exam, ExamViewModel>(); 
```

在 ActionResult 中，我使用了这样的 Automapper：

```
 public ActionResult Exam()
    {
        var examsDb = db.Exams;
        IEnumerable<ExamViewModel> examViewModel = AutoMapper.Mapper.Map<IEnumerable<Exam>, IEnumerable<ExamViewModel>>(examsDb);

        return View(examViewModel);
    } 
```

在视图中我循环遍历它

```
 @model IEnumerable<AraParsESOL.ViewModels.ExamViewModel>
       <ul>
      @foreach (var e in Model)
        { 
           <li>
              @Html.ActionLink(e.Title, "Type", "Exam")
            </li>
          }
      </ul> 
```

我的问题是：正如您在模型中看到的那样，有 4 个属性，但在 viewModel 中只有 2 个属性。

我怎样才能在 viewModel 中只获得这两个属性而不是整个模型？

这里发生的情况是，在每个循环之后，它都会从数据库中获取所需的列，但我只想要这两个属性，而不是返回数据库。

我可以像这样获取数据库 db.Exam.ToList(); 但这会导致整个数据库恢复。我想在这里使用最佳实践？

我知道我可以通过匿名类型和选择命令从数据库中获取数据，但是 automapper 的用途是什么？这里最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:20:41.620

不要使用 AutoMapper。它不适合`IQueryable<T>`. 相反，使用 LINQ 投影：

```
public ActionResult Exam()
{
    var examsDb = db.Exams;
    IEnumerable<ExamViewModel> examViewModel = 
        from e in db.Exams
        select new ExamViewModel
        {
            NewsId = e.NewsId,
            Title = e.Title
        };

    return View(examViewModel);
} 
```

如果查看生成的 SQL，您将看到仅返回`NewsId`和`Title`列。[看起来 AutoMapper 的人对解决这个缺点很感兴趣](http://lostechies.com/jimmybogard/2011/02/09/autoprojecting-linq-queries/)，但从那以后我没有听说过任何关于它的消息。

# tridion - AmbientDataFramework 中的日期/日期时间对象类型

> ID：11452177
> 
> 赞同：13
> 
> 时间：2012-07-12T12:46:49.073
> 
> 标签：tridion

在 SDL Tridion 2009 中使用环境数据框架时，我遇到了 Date (java) / DateTime (.net) 类型的问题。

我在 java 中设置一个声明值，如下所示：

```
Date myDate = rs.getDate("DATE_FIELD_IN_DB");
store.put(CLAIM_URI_DATE, myDate); 
```

这太棒了，生活太棒了:)

在我的 Web 应用程序（即 .net）中，我需要从声明存储中获取此值，当我尝试这样做时，它会失败：

我的代码是：

```
if (_store.Contains(new Uri("taf:claim:company:date"))) {
  DateTime claimdata = _store.Get<DateTime>("taf:claim:company:date"); 
  Response.Write(claimdata.ToString());
} 
```

错误信息是：

> [RuntimeException] Codemesh.JuggerNET.NTypeValue.Throw(Int64 inst) +373 Codemesh.JuggerNET.JavaClass.ThrowTypedException(Int64 inst) +1365 Codemesh.JuggerNET.JavaMethod.CallInt(JavaProxy jpo) +233 Tridion.ContentDelivery.AmbientData.JuggerNetTypeHelper。 FromProxyObject(Object proxyObject) +738
> Tridion.ContentDelivery.AmbientData.ClaimStore.Get(Uri claimUri) +109

我也尝试将其作为对象获取，然后将其转换为 DateTime。我显然在这里犯了一个非常基本的错误，任何帮助将不胜感激。

我还在这里阅读了 SDL 文档：http: [//sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/concept_26FDE76C277D43F893175E512EFDF09A](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/concept_26FDE76C277D43F893175E512EFDF09A)，它显示了 java 数据对象已转换为 .net DateTime。

谢谢

约翰

**更新**

根据彼得的建议，我已经检查并确保正确的 jar 文件到位。

值得一提的是，日期作为“日期”类型存储在 SQL 数据库中，典型值不包括时间戳，例如“2011-09-03”。在 Java 中，这一切功能仍然很好，我可以将值用作日期。仍然在 .Net 中获取值时，会引发类型化异常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T12:56:40.070

它应该自动转换它。但是，您确定您没有使用与 java.util.Date 不同的 Date 对象吗？那里有好几个...

如果你真的不能让它工作，你可以通过将日期存储为字符串（以 ISO 8601 格式）然后在 .NET 端使用 DateTime.Parse 来解决它。

但就像我说的：它通常工作正常，所以可能还有其他问题。

您的 ADF 是否适用于 .NET 中的其他内容？也许它缺少 .NET 方面的设置步骤......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-21T10:12:40.393

有点长镜头，但您能否验证已安装正确的 JDBC 驱动程序，如本问题/答案中所述？

[从 Tridion Broker Service (2009 SP1) 加载 CustomMeta 时出现异常](https://stackoverflow.com/questions/10122587/exception-loading-custommeta-from-tridion-broker-service-2009-sp1)

日期值，是否包含时间？当您从商店获得价值时，您能否确保它确实如此？

# core-plot - 如何在图表中显示数字？

> ID：11452179
> 
> 赞同：-1
> 
> 时间：2012-07-12T12:47:14.347
> 
> 标签：core-plot

如何在 X 和 Y 轴上显示自定义数字？我需要在 x 轴上显示我的自定义主题名称，在 Y 轴上显示标记。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:22:03.360

在绘图上设置`labelTextStyle`和`labelFormatter`以创建自动数据标签。这适用于任何绘图类型。

# solr - 干草堆解决双重请求和字符转义

> ID：11452183
> 
> 赞同：2
> 
> 时间：2012-07-12T12:47:26.643
> 
> 标签：solr, django-haystack

两个问题合并为一个问题：

为什么 haystack auto_query 向 solr 发送两个请求并转义 : 字符？

我已经按照手册中的说明设置了 haystack，一切运行正常，但是每当我跟踪我的 solr 日志时，如果来自 haystack（用于一个查询），我会看到两个请求，如果来自管理页面，则会看到一个请求：

所以我查询：

```
title:ong 
```

从干草堆我得到：

```
Jul 12, 2012 2:37:30 PM org.apache.solr.core.SolrCore execute
INFO: [collection1] webapp=/solr path=/select/ params={spellcheck=true&sort=cand+desc&fl=*+score&start=0&q=(title\:ong)&spellcheck.count=1&spellcheck.collate=true&wt=json&fq=django_ct:(ads.model1+OR+ads.model2+OR+ads.model3)&rows=1} hits=0 status=0 QTime=21
Jul 12, 2012 2:37:30 PM org.apache.solr.core.SolrCore execute
INFO: [collection1] webapp=/solr path=/select/ params={spellcheck=true&sort=cand+desc&fl=*+score&start=0&q=(title\:ong)&spellcheck.count=1&spellcheck.collate=true&wt=json&fq=django_ct:(ads.model1+OR+ads.model2+OR+ads.model3)&rows=0} hits=0 status=0 QTime=23 
```

而从管理部分：

```
Jul 12, 2012 2:42:35 PM org.apache.solr.core.SolrCore execute
INFO: [collection1] webapp=/solr path=/select params={spellcheck=true&indent=true&q=title:ong&wt=json} hits=2 status=0 QTime=12 
```

haystack请求中存在额外的参数，这是可以理解的。

如您所见， q 参数是相同的。

几乎一样：任何人都可以说出为什么 haystack auto_query 会转义 : 字符并发出两个请求？

我相信，因为 : 被转义，Solr 不会仅从字段“title”返回“ong”，而是搜索 title\:ong 作为字符串，当然它不会返回任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:09:56.057

我刚刚发现它为什么会逃脱冒号字符。那是因为 AutoQuery 默认会清理它们

```
class AutoQuery(BaseInput):
....
def prepare(self, query_obj):
....
    for token in tokens:
        if not token:
            continue
        if token in exacts:
            query_bits.append(Exact(token, clean=True).prepare(query_obj))
        elif token.startswith('-') and len(token) > 1:
            # This might break Xapian. Check on this.
            query_bits.append(Not(token[1:]).prepare(query_obj))
        else:
            query_bits.append(Clean(token).prepare(query_obj)) 
```

## 仍在寻找为什么它会发出两个请求...

最新的编辑：

由于这个位，它发出了两个请求

```
 if self.results and hasattr(self.results, 'query') and self.results.query.backend.include_spelling:
        context['suggestion'] = self.form.get_suggestion() 
```

在 SearchView().create_response()

# jquery - 限制 jQuery 可拖动项与兄弟元素重叠/碰撞

> ID：11452185
> 
> 赞同：10
> 
> 时间：2012-07-12T12:47:30.473
> 
> 标签：jquery, jquery-ui, draggable, jquery-ui-draggable, containment

我需要使用 jQuery UI 通过一些额外的限制来限制可拖动对象的包含区域。我需要防止可拖动元素与同一容器中的其他元素重叠。我需要允许在“moveInHere”区域而不是“butNotHere”区域移动。可能吗？

```
<div id="moveInHere">

    <div id="dragMe"> </div>

    <div id="butNotHere"> </div>

</div>

<script type="text/javascript">

    $("#dragMe").draggable({
        containment: "#moveInHere"
    });

</script> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-12T14:01:49.837

**编辑：新解决方案**

我为此找到了一个名为[JQuery UI Draggable Collision](http://sourceforge.net/projects/jquidragcollide/)的插件。使用它，实现您想要的功能变得微不足道。请参阅以下 jsFiddle 示例： http: [//jsfiddle.net/q3x8w03y/1/](http://jsfiddle.net/q3x8w03y/1/)（使用 JQuery UI Draggable Collision 的 1.0.2 版本，以及 JQuery 1.7.2 和 JQueryUI 1.1.18。）

这是代码：

```
$("#dragMe").draggable({
    obstacle: "#butNotHere",
    preventCollision: true,
    containment: "#moveInHere"
}); 
```

​</p>

**旧解决方案**

以下应该工作。不过，它有一个小故障。一旦 div 发生碰撞，您必须“重新抓取”正在拖动的 div，这可能有点烦人。也许其他人会知道如何解决这个问题。[你可以在这里](http://jsfiddle.net/MrAdE/8/)看到我的 jsFiddle 示例：http : [//jsfiddle.net/MrAdE/8/](http://jsfiddle.net/MrAdE/8/)

```
var prevOffset, curOffset;
$("#dragMe").draggable({
    drag: function(e,ui) {
        prevOffset= curOffset;
        curOffset= $.extend({},ui.offset);
        return true;
    }
});

$("#butNotHere").droppable({
    greedy: true,
    over: function(e,ui) {
        ui.helper.offset(curOffset= prevOffset).trigger("mouseup");
    },
    tolerance: "touch"
});​ 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-12T13:48:44.210

这让我费了不少心思。基本上我在`droppable`要避免的元素上创建了一个，然后在拖动结束时设置一个布尔值。然后，我在未记录的还原函数覆盖中使用它来取消删除。它仅在`#dragMe`完全结束时才有效`#butNotHere`：

```
$(document).ready(function(){
    var shouldCancel = false;
    $('#dragMe').draggable({
        containment: '#moveInHere',
        revert: function(){
            if (shouldCancel) {
                shouldCancel = false;
                return true;
            } else {
                return false;
            }
        }
    });
    $('#butNotHere').droppable({
        over: function(){
            shouldCancel = true;
        },
        out: function(){
            shouldCancel = false;
        }
    });
}); 
```

查看工作演示并随意使用它：http: [//jsfiddle.net/H59Nb/31/](http://jsfiddle.net/H59Nb/31/)

# xpages - XspDateTimeHelper 和 XspInputText

> ID：11452187
> 
> 赞同：1
> 
> 时间：2012-07-12T12:47:33.300
> 
> 标签：xpages

我正在尝试根据 Keith Strickland 的示例为 XPages 构建 JSF 库控件。

[http://xprentice.gbs.com/A55BAC/keithstric.nsf/default.xsp?documentId=82770C11FA7B9B21852579C100581766](http://xprentice.gbs.com/A55BAC/keithstric.nsf/default.xsp?documentId=82770C11FA7B9B21852579C100581766)

我正在尝试创建一个函数，该函数创建一个带有附加 DatePicker 控件的 InputBox 控件。

这是我尝试过的代码：

```
 XspInputText inputText = new XspInputText();
    inputText.setId("inputText1");

    DateTimeConverter converter = new DateTimeConverter();
    converter.setType("date");
    inputText.setConverter(converter);
    XspDateTimeHelper dateTimeHelper = new XspDateTimeHelper();

    dateTimeHelper.setId("dateTimeHelper1");
    inputText.getChildren().add(dateTimeHelper);
    inputText.setRendered(true);
    this.getChildren().add(inputText); 
```

InputText 控件已呈现，但未呈现 Converter、Validator 和 DatePicker 按钮。

嗨，基思的回答解决了这个问题，但现在我有了另一个。我试图将输入文本添加到 exlib 中的 fromtable 中。如果没有围绕“DateTimePicker”的表单表，则可以正确呈现，但使用表单表，它只会呈现为文本字段。

这是完整的代码：

```
 public class Libcontrol extends UIComponentBase implements FacesComponent {

            private static final String RENDERER_TYPE = "de.chris.Libcontrol ";
            private static final String COMPONENT_FAMILY = "de.chris";

            public void CommonContactInfo() {
                    setRendererType(RENDERER_TYPE);
            }

            @Override
            public String getFamily() {
                    return COMPONENT_FAMILY;
            }

            @SuppressWarnings("unchecked")
            public void initBeforeContents(FacesContext arg0) throws FacesException {

                    UIFormTable table = new UIFormTable();
                    table.setId("mytable");
                    table.setDisableRowError(false);
                    table.setDisableErrorSummary(true);
                    table.setLabelPosition("left");

                    UIFormLayoutRow row = new UIFormLayoutRow();
                    row.setId("myrow");
                    row.setLabel("DATEROW");

                    XspInputText inputText = new XspInputText();
                    inputText.setId("inputText1");

                    DateTimeConverter converter = new DateTimeConverter();
                    converter.setType("date");
                    inputText.setConverter(converter);
                    XspDateTimeHelper dateTimeHelper = new XspDateTimeHelper();

                    dateTimeHelper.setId("dateTimeHelper1");
                    inputText.getChildren().add(dateTimeHelper);
                    inputText.setRendered(true);
                    this.getChildren().add(inputText);

                    row.getChildren().add(inputText);
                    table.getChildren().add(row);

                    this.getChildren().add(table);

            }

            public void buildContents(FacesContext arg0, FacesComponentBuilder arg1) throws FacesException {
            // Do Nothing
            }

            /**
            * This method must be present because we're implementing FacesComponent
            */
            public void initAfterContents(FacesContext arg0) throws FacesException {
            // Do nothing
            }
    } 
```

我不确定问题出在哪里，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T03:18:52.943

好的，我想我可能已经找到了你的问题。在 XPage/自定义控件本身上，设置以下属性：

dojoParseOnLoad=true

道场主题=真

或者，如果您不想在 XPage/自定义控件中设置这些属性，您可以在渲染器 encodeBegin 中执行它，并在调用 super.encodeBegin() 之前的某处使用以下行：

```
//Here context = FacesContext or FacesContext.getCurrentInstance();
UIViewRootEx rootEx = (UIViewRootEx) context.getViewRoot();
rootEx.setDojoParseOnLoad(true);
rootEx.setDojoTheme(true); 
```

# html - css 适用于 Firefox/Chrome 但不适用于 IE

> ID：11452189
> 
> 赞同：2
> 
> 时间：2012-07-12T12:47:39.527
> 
> 标签：html, css, internet-explorer, firefox, google-chrome

我有这个 HTML 和 css 并且在 chrome/firefox 中可以正常工作，但是在 IE 上，标题布局超出了位置，并且悬停时不显示子菜单，请您帮忙：

```
<html>
    <head>
    <title>title</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="description" content="" />
    <meta name="robots" content="all" />
    <link href="images/favicon.ico" type="image/x-icon" rel="icon" /><link href="images/favicon.ico" type="image/x-icon" rel="shortcut icon" />     
    <link rel="stylesheet" type="text/css" href="css/style.css" />

    </head>

    <body>
     <div id="page">
        <div id="header">
            <div class="content">
                <div id="logo">
                    <a href="/"><img src="images/logo.gif" title="" alt="" /></a>
                </div>

                <div class='cssmenu'>
                    <ul>
                       <li class='active'><a href='index.html'><span>Home</span></a></li>
                       <li><a href='#'><span>Products</span></a>
                          <ul>
                             <li><a href='#'><span>Product 1</span></a></li>
                             <li><a href='#'><span>Product 2</span></a></li>
                          </ul>
                       </li>
                       <li><a href='#'><span>About</span></a></li>
                       <li><a href='#'><span>Contact</span></a></li>
                           <li><a href='#'><span>About</span></a></li>
                       <li><a href='#'><span>Contact</span></a></li>
                       <li><a href='#'><span>Contact</span></a></li>
                    </ul>
                </div>

            </div>
        </div>

        <div id="sub_header">
            <div class="content">
                <div class="content_l">
                    <span id="sub_head_title">Welcome</span>
                </div>
                <div class="content_r">
                    <span>
                    Call
                    <strong>000000000000</strong>
                    </span>
                </div>
            </div>
        </div>
       </div>   
    </body>

</html> 
```

而CSS是：

```
* html .clearfix, 
* html #main_panel {
  height: 1%;
  overflow: hidden;
}

/* float clearing for IE7 */
*+html .clearfix {
  min-height: 1%;
}

/* float clearing for everyone else */
.clearfix:after {
  clear: both;
  content: ".";
  display: block;
  height: 0;
  visibility: hidden;
  font-size: 0;
}

html, body { 
background: #e5e5e5; 
font-size: 13px; 
}

#header { 
    background: transparent url(../images/header-bg.jpg) repeat-x; height: 60px;
}

#header .content, #sub_header .content { 
overflow: visible; position: relative; 
}

#header .content, #sub_header .content {
    overflow: visible;
    position: relative;
}

div.content {
    margin: 0 auto;
    overflow: hidden;
    width: 980px;
}

#logo { 
position: absolute; 
}

#logo { margin: 8px 0 8px 0; }
#logo a { border: none; }

#page #sub_header {
    margin-bottom: 0;
}

#sub_header {
    line-height: 49px;
}

#sub_header {
    background: none repeat scroll 0 0 #EEEEEE;
    border-bottom: 1px solid #DDDDDD;
    margin-bottom: 30px;
    overflow: hidden;
}

.content_l {
    float: left;
    overflow: hidden;
    width: 50%;
}

.content_r {
    float: right;
    text-align: right;
    width: 50%;
}

#sub_header span {
    color: #2D2D2D;
    line-height: 49px;
}

#sub_head_title {
    font: bold 21px Arial;
    text-shadow: 2px 2px 2px #FFFFFF;
}

a.header_button_children span {
    background: url("../images/header-children-off.gif") no-repeat scroll right -51px transparent;
    padding-right: 25px;
}
a.header_button span {
    height: 19px;
    padding: 8px 10px 3px;
}

/*css Menu ................*/

.cssmenu{
    border:none;
    border:0px;
    margin:0;
    padding:0px;
    font: 67.5% 'Lucida Sans Unicode', 'Bitstream Vera Sans', 'Trebuchet Unicode MS', 'Lucida Grande', Verdana, Helvetica, sans-serif;
    font-size:14px;
    font-weight:bold;
    position: absolute;
    right: 0;
    }
.cssmenu ul{
    background:#333333;
    height:35px;
    list-style:none;
    /*margin:0 0 0 287px;*/
    margin:0;
    padding:0;
    }
.cssmenu li{
    float:left;
    padding:0px;
    }
.cssmenu li a{
    background:#333333 url('../images/seperator.gif') bottom right no-repeat;
    color:#cccccc;
    display:block;
    font-weight:normal;
    line-height:35px;
    margin:0px;
    padding:0px 25px;
    text-align:center;
    text-decoration:none;
    }
.cssmenu li a:hover, .cssmenu ul li:hover a{
    background: #2580a2 url('../images/hover.gif') bottom center no-repeat;
    color:#FFFFFF;
    text-decoration:none;
    }
.cssmenu li ul{
    background:#333333;
    display:none;
    height:auto;
    padding:0px;
    margin:0px;
    border:0px;
    position:absolute;
    width:225px;
    z-index:200;
    /*top:1em;
    /*left:0;*/
    }
.cssmenu li:hover ul{
    display:block;

    }
.cssmenu li li {
    background:url('../images/sub_sep.gif') bottom left no-repeat;
    display:block;
    float:none;
    margin:0px;
    padding:0px;
    width:225px;
    }
.cssmenu li:hover li a{
    background:none;

    }
.cssmenu li ul a{
    display:block;
    height:35px;
    font-size:12px;
    font-style:normal;
    margin:0px;
    padding:0px 10px 0px 15px;
    text-align:left;
    }
.cssmenu li ul a:hover, .cssmenu li ul li:hover a{
    background:#2580a2 url('../images/hover_sub.gif') center left no-repeat;
    border:0px;
    color:#ffffff;
    text-decoration:none;
    }
.cssmenu p{
    clear:left;
    }   

/*End of css Menu ................  */ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:54:30.603

它和我一起工作，但似乎缺少 DOCTYPE 所以你的浏览器午餐怪癖模式，所以添加

```
<!DOCTYPE html> 
```

之前`<html>`标记以防止您的 IE 浏览器切换到 Quirks 模式。

# php - URL重写不起作用

> ID：11452195
> 
> 赞同：1
> 
> 时间：2012-07-12T12:48:00.420
> 
> 标签：php, .htaccess

在我的网站上，我试图将一个长 URL 重写为一个对 SEO 友好的 URL。

我有以下代码，但它似乎没有任何影响！但是，如果我输入`dgadgdfsg`我的 htaccess，它会引发内部服务器错误。所以我假设它与重写规则有关。

```
RewriteEngine On
RewriteRule ^([^/]*)/([^/]*)/([^/]*)$ /missing-people/user-profile.php?userID=$1&firstName=$2&lastName=$3 [L] 
```

我已确认 mod_rewrite 已打开。

* * *

这是当前网址

http://mysite.com/missing-people/user-profile.php?userID=1&firstName=Liam&lastName=Gallagher

这就是我想要的样子

http://mysite.com/1/Liam/Gallagher

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T15:49:57.680

将您的 RewriteRule 更改为此（根据您的版本稍作修改）

```
RewriteRule ^([^/]+)/([^/]+)/([^/]+)/?$ missing-people/user-profile.php?userID=$1&firstName=$2&lastName=$3 [QSA,L] 
```

如果这不起作用，请尝试`R`为测试目的放置一个标志（这将使您的浏览器将原始 URI 更改为：`/missing-people/user-profile.php?userID=1&firstName=Liam&lastName=Gallagher`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:53:39.943

假设您`userID`的仅由数字组成，`firstName`并且`lastName`仅由字母数字组成。

```
RewriteEngine On
RewriteRule /(\d+)/(\w+)/(\w+)/ /missing-people/user-profile.php?userID=$1&firstName=$2&lastName=$3 [L] 
```

一个更严格的版本，除了为评估的正则表达式的开头和结尾设置边界之外，它做同样的事情。

```
RewriteEngine On
RewriteRule /^(\d+)\/(\w+)\/(\w+)$/ /missing-people/user-profile.php?userID=$1&firstName=$2&lastName=$3 [L] 
```

# asp.net-mvc-3 - MVC3中的字符串到html表

> ID：11452199
> 
> 赞同：0
> 
> 时间：2012-07-12T12:48:03.830
> 
> 标签：asp.net-mvc-3

```
string htmltable = "<table><tr><th>Head1</th><th>Head2</th><tr><td>data</td><td>Data</td></tabel>"; 
```

我通过调用为我生成字符串的类来获取这个字符串。我需要在我的视图中将此字符串解析为表格。

鉴于我正在打电话

`@TestProject.Html.tableCreation()`

它给我一个字符串。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:05:31.090

您从服务器端获取表格作为字符串。现在你只需要附加它。

```
$("body").append(htmltable) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:08:34.560

我建议您稍微更改一下并创建一个返回 MvcHtmlString 的 HTML 帮助程序。例如：

```
public static MvcHtmlString CreateTable<TModel, TProperty>(this HtmlHelper<TModel> helper,  string htmlString)
{
//Build table logic here using TagBuilder or System.Web.UI.WebControls.Table
   return MvcHtmlString.Create(htmlString);
} 
```

要在您的视图中使用 @Html.CreateTable("Your string here"Could do the url.action()... as well );

如果这不起作用，您可以使用 javascript 将 html 嵌入到 div 标签中...

# javascript - 如何判断 jsTree 是否已满载？

> ID：11452205
> 
> 赞同：23
> 
> 时间：2012-07-12T12:48:31.593
> 
> 标签：javascript, jstree

我正在尝试编写一个在 jsTree 上打开特定节点的函数，但是我遇到了一个问题，即在从 ajax 调用加载我的基树之前执行该函数。如何判断我的 jstree 数据是否已加载并等待加载完成。以下是我尝试使用的功能。

```
function openNodes(tree, nodes) {
    for (i in nodes) {
        $('#navigation').jstree("open_node", $(nodes[i]));
    }
} 
```

我正在使用以下命令加载我的初始树

```
$("#navigation").jstree({
    "json_data": {
        "ajax": {
            "url": function(node) {
                var url;
                if (node == -1) {
                    url = "@Url.Action("BaseTreeItems", "Part")";
                } else {
                    url = node.attr('ajax');
                }
                return url;
            },
            "dataType": "text json",
            "contentType": "application/json charset=utf-8",
            "data": function(n) { return { id: n.attr ? n.attr("id") : 0, ajax: n.attr ? n.attr("ajax") : 0 }; },
            "success": function() {
            }
        }
    },
    "themes": { "theme": "classic" },
    "plugins": ["themes", "json_data", "ui"]
}); 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-07-12T12:57:06.997

在对元素调用 .jstree() 之前，可以将回调绑定到`before.jstree`事件`loaded.jstree`：

```
$(selector)
.bind('before.jstree', function(e, data) {
    // invoked before jstree starts loading
})
.bind('loaded.jstree', function(e, data) {
    // invoked after jstree has loaded
    $(this).jstree("open_node", $(nodes[i]));
})
.jstree( ... ) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-11-12T20:19:09.697

在较新版本的 jstree 中，您可能需要等到所有节点都完成加载后才能与它们交互。为此，您需要：

```
ready.jstree 
```

所以：

```
$(selector)
    .bind('ready.jstree', function(e, data) {
        // invoked after jstree has loaded
     })
... 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-17T21:20:56.123

我使用了 setInterval 和 clearInterval：

```
var interval_id = setInterval(function(){
     // $("li#"+id).length will be zero until the node is loaded
     if($("li#"+id).length != 0){
         // "exit" the interval loop with clearInterval command
         clearInterval(interval_id)
         // since the node is loaded, now we can open it without an error
         $("#tree").jstree("open_node", $("li#"+id))
      }
}, 5); 
```

JStree 的“.loaded”回调只对根节点有效；“._is_loaded”可能会起作用，而不是检查节点的长度，但我还没有尝试过。无论哪种方式，动画设置都会导致树中较深的节点在几毫秒后加载。setInterval 命令创建一个定时循环，在加载所需节点时退出。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-09-26T16:08:27.800

你最好先调用 $.ajax() 函数来获取你想要的数据，你可以在 success: 字段中调用 $().jstree() 函数，就像我的代码一样。

```
 var fullTree;
$.ajax({
  url :"./php/select_tree.php",
  data : fullTree,
  method : "GET",
  dataType : "json",
  success : function(fullTree){
    $("#jstree").jstree({
      "core" : {
        "data" :fullTree,
        "check_callback" : true
       },
       "plugins" : [ "contextmenu", "dnd", "changed", "wholerow" ]
    });
  }
})
; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-01-04T08:54:08.243

我在我的情况下使用`refresh.jstree`事件（我需要经常动态更改和刷新 jstree 中的节点）。

根据文档，它

> 刷新调用完成时触发

[jsTree 文档（事件）](https://www.jstree.com/api/#/?q=.jstree%20Event&f=refresh.jstree)

示例代码：

`$.post( [url], ... ).done(function(){ $jstree.jstree().settings.core.data = result; $jstree.jstree().refresh(); }); $(selector).on('refresh.jstree', function(){ // do something });`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-09-24T16:04:06.233

[免责声明：这不适用于 OP，因为状态插件未在设置代码中列出。]

如果您使用状态插件，请使用 state_ready.jstree 事件而不是 ready.jstree 或 loaded.jstree 事件。

```
$(selector).on('state_ready.jstree', function () {
    // open desired node
}) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-09-24T14:09:38.670

您不必添加间隔。该插件在通过 ajax 加载的节点上设置一个类。

```
.one("reselect.jstree", function (evt, data) {
        if ($("#MYTREEID").find(".jstree-loading").length == 0) {
            alert('my ajax tree is done loading");
        }
    }) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-30T22:57:30.613

由于我没有找到解决方案，这适用于当前版本的 JSTree (3.3.7) 我将在这里发布我的工作方法。

首先，我在 select_node 上绑定并告诉 jstree 打开父节点，每当我选择 i 节点时。

```
var strIdentifierJsTree  = "#your-whatever-id-to-jstree";
var strNode2Select = "#your-whatever-id-to-your-node-which-parents-has-to-be-showed";

$( strIdentifierJsTree ).on("select_node.jstree", function (e, data) {
       $(strIdentifierJsTree).jstree(true).open_node( data.node.parent );
}); 
```

然后我绑定到加载功能：

```
$( strIdentifierJsTree ).bind('loaded.jstree', function(e, data) {
       $(strIdentifierJsTree).jstree(true).select_node( strNode2Select );
}); 
```

现在它将在 JSTree 初始化后（完全加载时）选择我的节点，并打开所有父节点，无论嵌套深度如何。像其他答案中提到的那样，单个开放节点方法对我不起作用。

# iphone - linkedin 连接 API 给出错误 401 - iphone

> ID：11452212
> 
> 赞同：3
> 
> 时间：2012-07-12T12:48:42.463
> 
> 标签：iphone, ios, oauth, linkedin

嗨，我正在使用linkedin iphone api通过电子邮件发送连接邀请

请求 xml：

```
<?xml version='1.0' encoding='UTF-8'?>
    <mailbox-item>
        <recipients>
            <recipient>
                <person path="/people/email=%@">
                    <first-name>%@</first-name>
                    <last-name>%@</last-name>
                </person>
            </recipient>
        </recipients>
        <subject>Invitation to Connect</subject>
        <body>Please join my professional network on LinkedIn.</body>
        <item-content>
            <invitation-request>
                <connect-type>friend</connect-type>
            </invitation-request>
        </item-content>
    </mailbox-item> 
```

其中 %@ 表示动态值。内容类型：text/xml 请求方法：POST

响应 xml：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <error>
        <status>401</status>
        <timestamp>1342092385484</timestamp>
        <request-id>FX9SK3ZVG9</request-id>
        <error-code>0</error-code>
        <message>[unauthorized]. OAU:076lb67kcfe2|dc01dc46-4d78-44d2-9f9b-49053b8094db|*01|*01:1342092534:iZ/mDlOL7eo4fGv2O/rQZKe8oCA=</message>
    </error> 
```

还验证了授权标头是否正确。我还使用 oAuth 调试控制台进行了调试，我在调试控制台中输入了相同的值，但签名密钥不同。

那么签名密钥有问题吗？我也去过论坛。但我仍然无法找到确切的问题。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T17:51:56.187

There's a sample LinkedIn iPhone client on github here: [https://github.com/synedra/LinkedIn-OAuth-Sample-Client](https://github.com/synedra/LinkedIn-OAuth-Sample-Client)

You should be able to use that to see what the proper headers look like. As you're on a macintosh (or wouldn't be developing for the iPhone), I strongly encourage you to use HTTPScoop to watch the traffic when using the simulator and see what the differences are between what your application is doing and what the sample client does.

# ruby-on-rails - 获取最多评论的对象

> ID：11452215
> 
> 赞同：4
> 
> 时间：2012-07-12T12:48:50.560
> 
> 标签：ruby-on-rails, ruby-on-rails-3, acts-as-commentable

我正在使用[acts_as_commentable_with_threading](https://github.com/elight/acts_as_commentable_with_threading) gem 让用户能够评论我的博客文章。

我现在要做的是显示评论最多的帖子，但我不知道如何查询它们（据我所知，gem 不提供这种方法）。你能给我写一些提示或想法如何实现这样的目标吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T14:05:25.427

这是我用来返回发布最多项目的顶级用户的方法。它可以帮助您解决问题。我把它放在 Application Helper 中，因为它是我的侧导航栏的一部分，将在 Web 应用程序的每个页面上使用。

```
def top_posters
    User.all(:select => "users.*, COUNT(user_id) as post_count",
       :joins => "LEFT JOIN posts AS posts ON posts.user_id = users.id",
       :group => "posts.user_id",
       :order => "post_count DESC",
       :limit => 5)
end 
```

在我看来，我有

```
<% top = top_posters() %>
<% for t in top %>
    <li><%= link_to t.username, user_path(t) %>
        (<%= t.posts.public_posts.count %>)</li>
<% end %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-18T00:27:50.543

对于 Rails 4+

你应该使用这样的东西：

```
Article.select("articles.*, COUNT(commentable_id) as comments_count")
                    .joins("LEFT JOIN comments AS comments ON comments.commentable_id = articles.id")
                    .group("comments.commentable_id")
                    .order("comments_count DESC")
                    .where("commentable_type = 'Article'")
                    .limit(5) 
```

# javascript - javascript 在链接上不起作用

> ID：11452230
> 
> 赞同：0
> 
> 时间：2012-07-12T12:50:06.797
> 
> 标签：javascript, jquery

我有这个html：

```
 <a style="display:block; padding:100%; text-decoration: none;" href="http://google.com " class="Jasmin" id="target_site_to_visit">

<span data-app-id="88" class="btn" id="visit_site" style="right:22px; top:65px; padding:5px;z-index: -99999;">VISIT SITE</span>

</a> 
```

这个jQuery：

```
 (function($){
            $('#target_site_to_visit').live('click',function(event){
            event.preventDefault();
           var appName=$('#target_site_to_visit').attr('class');
          $.post('db/update_site_viewed.php',{ name:appName }, function(data){

              throw new Error("AppName: "+appName);

          },'html').error(function(data){

             throw new Error("Error: "+data.responseText);
          });
          document.location.href=$('#target_site_to_visit').attr('href');
      }); })(jQuery); 
```

每当单击按钮时都会出现问题。执行 post 方法将数据放入数据库。但这仅在 jquery 中的最后一行不存在时才会发生：document.location.href .. 重定向以某种方式影响帖子.. 并且可能不会执行 post 方法.. 导致没有记录插入到数据库中（或在其他 post 方法不执行）.. 这可能是原因..因为重定向确实影响 post 方法的执行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:52:41.580

这将解决您的问题

```
<script type="text/javascript">
        $('#target_site_to_visit').live("click",function(event){
        event.preventDefault();
       var appName=$('#target_site_to_visit').attr('class');
      $.post('db/update_site_viewed.php',{ name:appName }, function(data){

     //    console.log("AppName: "+appName);

      },'html').error(function(data){

       //  console.log("Error: "+data.responseText);
      });
    //  document.location.href=$('#target_site_to_visit').attr('href');
  }); 
```

但是使用 .on() 而不是 .live().Like

```
<script type="text/javascript">
            $(document).on("click",'#target_site_to_visit',function(event){
            event.preventDefault();
           var appName=$('#target_site_to_visit').attr('class');
          $.post('db/update_site_viewed.php',{ name:appName }, function(data){

         //    console.log("AppName: "+appName);

          },'html').error(function(data){

           //  console.log("Error: "+data.responseText);
          });
        //  document.location.href=$('#target_site_to_visit').attr('href');
      }); 
   </script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:52:50.133

您需要将要侦听的事件（在本例中`click`）传递给该`live`方法。

```
$("#somediv").live("click", function () {
    console.log("you clicked it");
}); 
```

此外，正如其他回答者所说，您应该使用`on`而不是`live`，这里有一篇文章解释了原因：[http ://bitovi.com/blog/2011/04/why-you-should-never-use-jquery-live .html](http://bitovi.com/blog/2011/04/why-you-should-never-use-jquery-live.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:53:11.397

您似乎没有指定事件的类型。应该是`'click'`，如果我对 jQuery 语法的有限知识是正确的，它应该是回调之前的第一个参数。

为了安全起见，我希望任何打算由 JavaScript 处理的链接都具有`href="javascript:void(null);"`. 这样，即使事件处理程序未能取消事件，也不会发生任何事情。当您将鼠标悬停在其状态栏中时，用户在其状态栏中看到 JavaScript 链接也比指向 Google 的链接更容易混淆。

# android - 连接到 Web 服务后无法打开图库

> ID：11452232
> 
> 赞同：1
> 
> 时间：2012-07-12T12:50:22.260
> 
> 标签：android, web-services, video, gallery

我可以连接到网络服务，但我想做的是在连接网络服务后我想打开画廊并从那里选择一个视频。你能帮我看看问题出在哪里吗？这是我的代码：

```
package com.isoft.uploader;

import java.util.ArrayList;

import org.json.JSONArray;
import org.json.JSONObject;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class UploaderActivity extends Activity 
{

//ArrayList<Response> WebData= new ArrayList<Response>();
public static final int SELECT_VIDEO=1;
public static final String TAG="UploadActivity";
String path="";
final String NAMESPACE = "http://tempuri.org/";
final String SERVICEURL = "http://192.168.10.177/androidws/isandroidws.asmx";
final String METHOD_NAME1="OzelVeriAlanlariniGetir";
final String METHOD_NAME="KullaniciGiris";
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Button enter=(Button)findViewById(R.id.Enter);
    final EditText username=(EditText)findViewById(R.id.username);
    final EditText password=(EditText)findViewById(R.id.password);
    enter.setOnClickListener(new View.OnClickListener() 
    {

        @Override
        public void onClick(View arg0) 
        {
            // TODO Auto-generated method stub
            //request code for Webservice
            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
            //sending the username to the webservice
            request.addProperty("kullaniciAdi",username.getText().toString());
            //sending the password to the webservice
            request.addProperty("password",password.getText().toString());
            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
            envelope.dotNet = true;
            //Putting the request in an envelope
            envelope.setOutputSoapObject(request);
            HttpTransportSE transport = new HttpTransportSE(SERVICEURL);
            try
            {
                 transport.call("http://tempuri.org/"+METHOD_NAME, envelope);
                 //getting the response from the webservice
                 Integer response = (Integer) envelope.getResponse();
                 if(response!=0)
                 {
                    openGaleryVideo();
                 }//end of if statement
            }//end of try 
            catch(Exception exception)
            {
                exception.printStackTrace();
            }//end of catch

        }//end of onClick method
    });//end of OnclickListener method
}//end of onCreate method

public void openGaleryVideo()
{
    Intent intent=new Intent();
    intent.setType("video/*");
    intent.setAction(Intent.ACTION_GET_CONTENT);
    startActivityForResult(Intent.createChooser(intent, "Select Video"),SELECT_VIDEO);
}//end of openGaleryVideo method

public String getPath(Uri uri)
{   
    String[] projection = { MediaStore.Video.Media.DATA};
    Cursor cursor = managedQuery(uri, projection, null, null, null);
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
}//end of getPath method
}//end of main 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:53:18.860

也许 Android 类 AsyncTask 会有所帮助。

在 doInBackground 方法上发出 WebService 请求并在 postExecute 方法上显示图库。

更多信息：[Android 文档上的 AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)

**更新：** 将 onclick 方法内容替换为：

```
AsyncTask<String, Void, Integer> task = new AsyncTask<String, Void, Integer>(){

    @Override
    protected Integer doInBackground(String... params) {

        // TODO Auto-generated method stub
        //request code for Webservice
        SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
        //sending the username to the webservice
        request.addProperty("kullaniciAdi",username.getText().toString());
        //sending the password to the webservice
        request.addProperty("password",password.getText().toString());
        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.dotNet = true;
        //Putting the request in an envelope
        envelope.setOutputSoapObject(request);
        HttpTransportSE transport = new HttpTransportSE(SERVICEURL);
        try
        {
             transport.call("http://tempuri.org/"+METHOD_NAME, envelope);
             //getting the response from the webservice
             return (Integer) envelope.getResponse();
        }//end of try 
        catch(Exception exception)
        {
            exception.printStackTrace();
        }//end of catch
        return 0;
    }

    protected void onPostExecute(Integer result) {
        if(result!=0)
        {
           openGaleryVideo();
        }//end of if statement
    };
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T06:16:27.900

这是解决方案：

```
package com.isoft.uploader;

import java.util.ArrayList;

import org.json.JSONArray;
import org.json.JSONObject;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class UploaderActivity extends Activity 
{

//ArrayList<Response> WebData= new ArrayList<Response>();
public static final int SELECT_VIDEO=1;
public static final String TAG="UploadActivity";
String path="";
final String NAMESPACE = "http://tempuri.org/";
final String SERVICEURL = "http://192.168.10.177/androidws/isandroidws.asmx";
final String METHOD_NAME1="OzelVeriAlanlariniGetir";
final String METHOD_NAME="KullaniciGiris";
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Button enter=(Button)findViewById(R.id.Enter);
    final EditText username=(EditText)findViewById(R.id.username);
    final EditText password=(EditText)findViewById(R.id.password);
    final  AlertDialog ad=new AlertDialog.Builder(this).create();
    enter.setOnClickListener(new View.OnClickListener() 
    {

        @Override
        public void onClick(View arg0) 
        {
            // TODO Auto-generated method stub
            //request code for Webservice
            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
            //sending the username to the webservice
            request.addProperty("kullaniciAdi",username.getText().toString());
            //sending the password to the webservice
            request.addProperty("password",password.getText().toString());
            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
            envelope.dotNet = true;
            //Putting the request in an envelope
            envelope.setOutputSoapObject(request);
            HttpTransportSE transport = new HttpTransportSE(SERVICEURL);
            Object response = null;
            try
            {
                 transport.call("http://tempuri.org/"+METHOD_NAME, envelope);
                 //getting the response from the webservice
                 response= envelope.getResponse();
            }
            catch(Exception exception)
            {
                exception.printStackTrace();
            }//end of catch
            if(response!=null && Integer.parseInt(response.toString()) != 0)
            {
                openGaleryVideo();
            }
            else
            {
                ad.setMessage("Lütfen Kullanıcı Adınızı ve Şifrenizi Kontrol Ediniz.");
                ad.show();  
            }

        }//end of onClick method

    });//end of OnclickListener method
}//end of onCreate method
public void openGaleryVideo()
{
    Intent intent=new Intent();
    intent.setType("video/*");
    intent.setAction(Intent.ACTION_GET_CONTENT);
    startActivityForResult(Intent.createChooser(intent, "Select Video"),SELECT_VIDEO);
}//end of openGaleryVideo method

public String getPath(Uri uri)
{   
    String[] projection = { MediaStore.Video.Media.DATA};
    Cursor cursor = managedQuery(uri, projection, null, null, null);
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
}//end of getPath method
}//end of main 
```

# spotify - 如何播放 Spotify 音乐流

> ID：11452236
> 
> 赞同：2
> 
> 时间：2012-07-12T12:50:31.427
> 
> 标签：spotify, naudio, bass.dll

首先，我是音频编程的新手，所以请耐心等待。

我正在尝试使用 NAudio 或 BASS.Net 或任何其他 .net 音频库播放 Spotify 音乐。

据我所知，libspotify 将音乐作为原始 PCM 数据提供。[Spotify 流 (libspotify) 的采样率是多少？](https://stackoverflow.com/questions/10760949/what-is-the-sample-rate-of-spotify-stream-libspotify)

来自 spotify 文档：样本以整数形式提供，请参阅 sp_audioformat。一帧由与通道数相同的样本数组成。即交错是在样本级别。

当我尝试播放歌曲时，spotify 使用 8192 字节缓冲区进行回调

频道 = 2

采样率 = 44100

帧数 = 2048

我需要一些帮助来将这些信息翻译成 NAudio 术语。

我也尝试过使用 spotify 到 Bass.Net 示例（BASSPlayer.cs）。但是我还没有从我的扬声器中听到一个音符。我试过用 NAudio 和 Bass.NET 播放一首 mp3 歌曲，效果很好，所以扬声器音量还可以。 [https://github.com/Alxandr/SpotiFire/blob/master/SpitiFire.Server/BASSPlayer.cs](https://github.com/Alxandr/SpotiFire/blob/master/SpotiFire.Server/BASSPlayer.cs)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:53:41.200

NAudio 取得了突破。这就是我想出的，通过使用试错法。我不确定这是否是从 sampleRate/channels 计算参数的正确方法......

但是这首歌正在播放:-)

```
IWavePlayer waveOutDevice = new WaveOut();

using (var pcmStream = new FileStream(PcmFile, FileMode.Open))
{
    const int songDuration = 264000;
    const int sampleRate = 44100;
    const int channels = 2;
    var waveFormat = WaveFormat.CreateCustomFormat(WaveFormatEncoding.Pcm, sampleRate * channels, 1, sampleRate * 2 * channels, channels, 16);
    var waveStream = new RawSourceWaveStream(pcmStream, waveFormat);

    waveOutDevice.Init(waveStream);
    waveOutDevice.Play();
    Thread.Sleep(songDuration);
    waveOutDevice.Stop();
    waveStream.Close();
    waveOutDevice.Dispose();
} 
```

# opengl - OpenTK 矩阵变换

> ID：11452241
> 
> 赞同：2
> 
> 时间：2012-07-12T12:50:43.577
> 
> 标签：opengl, matrix, opentk

这是顶点着色器：

```
uniform mat4 projection;
uniform mat4 view;
uniform mat4 model;

void main(void)
{
    gl_Position = projection * view * model * gl_Vertex;
    gl_TexCoord[0] = gl_MultiTexCoord0;
} 
```

我的理解是，通过各种变换，模型空间最终变成了裁剪空间，也就是一个由每个轴上的每个单元直接绘制到视口的框，即(-1, 1,0)处的东西在顶部视口的左侧。当我从着色器中删除所有矩阵变换时，

```
gl_Position = gl_Vertex; 
```

并作为模型传入一个简单的四边形

```
public Vector3[] verts = new Vector3[] {
    new Vector3(-1f, -1f, 0),
    new Vector3(1f, -1f, 0),
    new Vector3(1f, 1f, 0),
    new Vector3(-1f, 1f, 0),
};

public Vector2[] coords = new Vector2[] {
    new Vector2(0, 1f),
    new Vector2(1f, 1f),
    new Vector2(1f, 0f),
    new Vector2(0f, 0f),
};

public uint[] indices = new uint[] {
    0,1,2,
    0,2,3,
}; 
```

我得到了预期的全屏图像。当我应用转换时，图像在屏幕中央显示为一个小方块，正如您所期望的那样。当我尝试在 CPU 上的剪辑坐标中计算模型顶点的位置时，就会出现问题：

```
public Vector4 testMult(Vector4 v, Matrix4 m)
{
    return new Vector4(
        m.M11 * v.X + m.M12 * v.Y + m.M13 * v.Z + m.M14 * v.W,
        m.M21 * v.X + m.M22 * v.Y + m.M23 * v.Z + m.M24 * v.W,
        m.M31 * v.X + m.M32 * v.Y + m.M33 * v.Z + m.M34 * v.W,
        m.M41 * v.X + m.M42 * v.Y + m.M43 * v.Z + m.M44 * v.W);
}

Matrix4 test = (GlobalDrawer.projectionMatrix * GlobalDrawer.viewMatrix) * modelMatrix;

Vector4 testv = (new Vector4(1f, 1f, 0, 1));
Console.WriteLine("Test Input: " + testv);
Console.WriteLine("Test Output: " + Vector4.Transform(testv, test));
Vector4 testv2 = testMult(testv, test);
Console.WriteLine("Test Output: " + testv2);
Console.WriteLine("Test Output division: " + testv2 / testv2.W); 
```

（传入的矩阵与传递给着色器的矩阵相同）

然后程序继续在剪辑空间之外提供输出，除以 W 导致除以 0：

```
Test Input: (1, 1, 0, 1)
Test Output: (0.9053301, 1.207107, -2.031746, 0)
Test Output: (0.9053301, 1.207107, -1, 0)
Test Output division: (Infinity, Infinity, -Infinity, NaN) 
```

创建矩阵如下：

```
projectionMatrix = Matrix4.CreatePerspectiveFieldOfView((float)Math.PI / 4, window.Width / (float)window.Height, 1.0f, 64.0f);
projectionMatrix =
(1.81066, 0, 0, 0)
(0, 2.414213, 0, 0)
(0, 0, -1.031746, -1)
(0, 0, -2.031746, 0)

viewMatrix = Matrix4.LookAt(new Vector3(0,0,4), -Vector3.UnitZ, Vector3.UnitY);
viewMatrix = 
(1, 0, 0, 0)
(0, 1, 0, 0)
(0, 0, 1, 0)
(0, 0, -4, 1)

modelMatrix = 
(0.5, 0  , 0  , 0)
(0  , 0.5, 0  , 0)
(0  , 0  , 1  , 0)
(0  , 0  , 0  , 1) 
```

所以，问题是为什么；我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T16:46:10.700

编辑*（从评论中添加真实答案）*

默认情况下，您的 OpenTK 矩阵是转置的。它看起来使用行向量而不是列向量。因此，您需要将乘法作为 (model * view * proj)，而不是 (proj * view * model)。要么在上传之前转置所有矩阵。

* * *

实际上剪辑空间不是从-1到1，而是从-W到W，其中W是剪辑空间向量的第四个分量。

您可能想到的是*标准化设备*坐标，每个轴的范围从 -1 到 1。您可以通过将裁剪空间向量的 X、Y 和 Z 坐标除以裁剪空间 W 分量来获得该值。这种划分称为*透视划分*。

这是在将剪辑空间坐标传递给 gl_Position 后在幕后完成的。

不过，您的剪辑空间坐标为 0，这对我来说似乎不正确。

这里有更多细节：[OpenGL FAQ : Transformations](http://www.opengl.org/archives/resources/faq/technical/transformations.htm)。

# mysql - MySQL - 从一个表返回与另一表中的多个数据组合匹配的数据

> ID：11452242
> 
> 赞同：0
> 
> 时间：2012-07-12T12:50:45.837
> 
> 标签：mysql, sql

我`meta_data`用以下结构调用了表

```
id, fk_id, label, data 
```

其中 fk_id 链接到另一个表 -`books`

该`meta_data`表具有以下条目：

```
|id|fk_id|label|data   |
|--|-----|-----|-------|
|1 |1    |pages|10     |
|2 |2    |pages|10     |
|3 |1    |pub  |smith  |
|4 |3    |pub  |smith  | 
```

我想选择匹配多个参数的`books`条目，例如AND 。 `meta_data``pages = 10``pub = smith`

因此，使用上面的示例，我将在表中返回`books`id 为 1 的条目（2 和 3 将不包括在内，因为它们匹配标准之一，但它们不匹配两者）。

此查询也需要是动态的，因此我可以查询`meta_data`表中的 1 个或多个标签/数据组合，例如，我在上面的示例中查询 2 个组合，但可能想要查询 4 ​​或 5。

此外，表中可能有多个条目`meta_data`具有相同的标签但数据值不同。例如，可能还有另一行：

```
|5 |1    |pub  |jones  | 
```

谁能给我一个例子，说明这个查询应该如何使用 MySQL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:57:24.487

这是您在问题中指定的条件的示例。如果您希望条件更加动态，您应该在应用程序中动态构建查询。

```
Select b.book_name from books b, meta_data m, meta_data md
WHERE b.id = m.fk_id and b.id = md.fk_id 
and m.label ='pages' and m.data = 10 
and md.label ='pub' and md.data='smith' 
```

# wpf - 即将卸载之前的用户控件的屏幕截图

> ID：11452243
> 
> 赞同：0
> 
> 时间：2012-07-12T12:50:54.720
> 
> 标签：wpf, mvvm, user-controls, screenshot

我正在构建一个 pos 系统，它有一个主 ContentControl 来显示应用程序的不同屏幕。我使用 DataTemplates 将我的视图模型映射到视图。为了在 ContentControl 中显示的不同视图之间导航，我想在卸载 UserControl（或 ContentControl 更改）时将 UserControl 的屏幕截图存储在视图模型中。

我在这里发布了一个相关问题[WPF Binding FrameworkElement event to command](https://stackoverflow.com/questions/10934040/wpf-binding-frameworkelement-event-to-command) 我试图将命令绑定到 FrameworkElement.Unloaded 但这不起作用（请参阅该链接上的答案）

在不破坏 MVVM 模式的情况下这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:24:28.780

[这](https://stackoverflow.com/questions/7754704/how-can-i-create-thumbnail-from-wpf-window-and-convert-it-into-bytes-so-i-can)是如何在 wpf 中进行屏幕截图的一个很好的链接。

这是我要做的：

我处理导航的 mainviewmodel 应该在设置新的 contentviewmodel 之前公开一个事件并引发此事件。旧的 contentviewmodel 应该在 eventargs 中。在您订阅事件的主窗口代码隐藏中（此处不破坏 mvvm）。当这个事件被引发时，你可以调用 screenshot 方法并将结果放到 oldviewmodel 中。

编辑：

主窗口代码隐藏

```
void NavigationChangingEvent(object sender, NavChangingArgs args)
{
   var oldvm = args.ChangingViewmodel;
   oldvm.Screenshoot = this.mycontentcontrolwheremyviewmodelareshown.GetJpgImage(1, 90);
} 
```

# c# - 将位图头添加到字节数组，然后创建位图文件

> ID：11452246
> 
> 赞同：6
> 
> 时间：2012-07-12T12:50:56.467
> 
> 标签：c#, image, bitmap

我有一个来自相机的 ByteArray，它只是一个流，没有位图头。

我已经搜索了一个演示，但它们都是用 C++ 编写的。

我尝试在我的代码中添加一个位图头，但抛出了 ParameterException。如何从 ByteArray 制作位图文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2017-05-17T11:23:36.377

您不能直接使用没有位图标头的原始数据创建位图类。位图标题就像位图图像的配方。它包括有关宽度、高度、每像素位数、数据长度等的基本信息，以便为图像制作适当的数组。

如果您仔细查看[此处的位图标头结构，则制作位图标头相当容易](https://en.wikipedia.org/wiki/BMP_file_format#Example_1)

* * *

**但是没有什么比源代码的完整示例更好的了。**

我将它们分解成几部分，并在整个过程中为您评论每个步骤。它可能看起来有点过分和冗长，但我想这对你来说将是一个很好的指南。

* * *

> 以下是像素格式为 RGB24 的 2×2 像素、24 位位图（Windows DIB 标头 BITMAPINFOHEADER）的示例。
> 
> BMP 文件格式 - 维基百科

```
#region Bitmap Making...

// BmpBufferSize : a pure length of raw bitmap data without the header.
// the 54 value here is the length of bitmap header.
byte[] BitmapBytes = new byte[BmpBufferSize + 54];

#region Bitmap Header
// 0~2 "BM"
BitmapBytes[0] = 0x42;
BitmapBytes[1] = 0x4d;

// 2~6 Size of the BMP file - Bit cound + Header 54
Array.Copy(BitConverter.GetBytes(BmpBufferSize + 54), 0, BitmapBytes, 2, 4);

// 6~8 Application Specific : normally, set zero
Array.Copy(BitConverter.GetBytes(0), 0, BitmapBytes, 6, 2);

// 8~10 Application Specific : normally, set zero
Array.Copy(BitConverter.GetBytes(0), 0, BitmapBytes, 8, 2);

// 10~14 Offset where the pixel array can be found - 24bit bitmap data always starts at 54 offset.
Array.Copy(BitConverter.GetBytes(54), 0, BitmapBytes, 10, 4);
#endregion

#region DIB Header
// 14~18 Number of bytes in the DIB header. 40 bytes constant.
Array.Copy(BitConverter.GetBytes(40), 0, BitmapBytes, 14, 4);

// 18~22 Width of the bitmap.
Array.Copy(BitConverter.GetBytes(image.Width), 0, BitmapBytes, 18, 4);

// 22~26 Height of the bitmap.
Array.Copy(BitConverter.GetBytes(image.Height), 0, BitmapBytes, 22, 4);

// 26~28 Number of color planes being used
Array.Copy(BitConverter.GetBytes(0), 0, BitmapBytes, 26, 2);

// 28~30 Number of bits. If you don't know the pixel format, trying to calculate it with the quality of the video/image source.
if (image.PixelFormat == System.Drawing.Imaging.PixelFormat.Format24bppRgb)
{                        
    Array.Copy(BitConverter.GetBytes(24), 0, BitmapBytes, 28, 2);
}

// 30~34 BI_RGB no pixel array compression used : most of the time, just set zero if it is raw data.
Array.Copy(BitConverter.GetBytes(0), 0, BitmapBytes, 30, 4);

// 34~38 Size of the raw bitmap data ( including padding )
Array.Copy(BitConverter.GetBytes(BmpBufferSize), 0, BitmapBytes, 34, 4);

// 38~46 Print resolution of the image, 72 DPI x 39.3701 inches per meter yields
if (image.PixelFormat == System.Drawing.Imaging.PixelFormat.Format24bppRgb)
{
    Array.Copy(BitConverter.GetBytes(0), 0, BitmapBytes, 38, 4);
    Array.Copy(BitConverter.GetBytes(0), 0, BitmapBytes, 42, 4);
}

// 46~50 Number of colors in the palette
Array.Copy(BitConverter.GetBytes(0), 0, BitmapBytes, 46, 4);

// 50~54 means all colors are important
Array.Copy(BitConverter.GetBytes(0), 0, BitmapBytes, 50, 4);

// 54~end : Pixel Data : Finally, time to combine your raw data, BmpBuffer in this code, with a bitmap header you've just created.
Array.Copy(BmpBuffer as Array, 0, BitmapBytes, 54, BmpBufferSize);

#endregion - bitmap header process
#endregion - bitmap making process 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:54:22.863

使用 System.Drawing.Bitmap 类

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-12T13:24:26.173

这将起作用

...

```
using System;
using System.IO;
using System.Drawing; 
```

...

```
public Image ByteArrayToImage(byte[] byteArrayIn)
{

 MemoryStream ms = new MemoryStream(byteArrayIn);
                   Image img = Image.FromStream(ms);
                   return img;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-12T13:03:41.627

也许这就是你要找的...

[http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/e57f7731-c703-4c17-b1a2-32b155f9b745/](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/e57f7731-c703-4c17-b1a2-32b155f9b745/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-12T12:54:35.153

查看这些链接：

*   [读取图像标题](http://www.codeproject.com/KB/cs/ReadingImageHeaders.aspx)
*   [创建和初始化标题 - 保存到位图文件](http://msdn.microsoft.com/en-us/library/aa446563.aspx#scibf_topic4)(MSDN)

*   [http://www.wischik.com/lu/programmer/1bpp.html](http://www.wischik.com/lu/programmer/1bpp.html)

# android - 在 SQLite While 循环中添加数组

> ID：11452251
> 
> 赞同：0
> 
> 时间：2012-07-12T12:51:15.360
> 
> 标签：android, android-listview

我正在使用这个-> [http://www.ezzylearning.com/tutorial.aspx?tid=1763429](http://www.ezzylearning.com/tutorial.aspx?tid=1763429)创建我自己的自定义列表视图。

对于我的项目，我使用 while 循环来获取数据并取回数据。

原始代码是：

```
DownloadClass data[] = new DownloadClass[] { 
    new DownloadClass("test", "test"), 
    new DownloadClass("test", "Sunny")
}; 
```

但是对于我的情况..

```
DownloadClass data[] = new DownloadClass[] {};
SQLFunctions entry = new SQLFunctions(this);
entry.open();
highestID = entry.getHighestId();
for (int l = 1; l < highestID; l++) {
    Long longVal  = Long.valueOf(l);
    new DownloadClass(entry.getName(longVal).toString(), entry.getURL(longVal).toString());
} 
```

列表视图似乎是空的，因为我知道没有插入数据。任何帮助表示赞赏。谢谢。

编辑：我的下载类：

```
public class DownloadClass {
        public String name;
        public String url;
        public DownloadClass(){
            super();
        }

        public DownloadClass(String name, String url) {
            super();
            this.name = name;
            this.url = url;
        }
    } 
```

我的新活动

```
DownloadClass data[] = new DownloadClass[]; // need to work on this
    SQLFunctions entry = new SQLFunctions(this);
    entry.open();
    highestID = entry.getHighestId();
    Log.e("HIGHEST ID", highestID.toString());
    if (highestID > 1) {
    for (int l = 0; l < highestID; l++) {
        Long longVal = Long.valueOf(l);
        //String name = entry.getName(longVal);
        //String id = entry.getURL(longVal);
        //Log.e("NAME", name + " - " + id);
data[l] = new DownloadClass(entry.getName(longVal).toString(),entry.getURL(longVal).toString());
        }
    }
entry.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:52:43.030

您永远不会将新`DownloadClass`对象添加到数组中。如果您要使用数组而不是数组`ArrayList`（老实说，这可能是您想要的），您还需要分配大小。

当您遍历循环时，您需要将新对象分配给数组中的一个位置。

`data[i] = new DownloadClass(...);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:56:05.597

试试这个，让我知道会发生什么..

```
DownloadClass data[]; 
SQLFunctions entry = new SQLFunctions(this);
entry.open();
highestID = entry.getHighestId();
data[] = new DownloadClass[highestID];
for (int l = 0; l < highestID; l++) {
Long longVal  = Long.valueOf(l);
data[i] = new DownloadClass(entry.getName(longVal).toString(), entry.getURL(longVal).toString());
} 
```

也用 0 index.. 而不是 1.. 开始你的循环

**更新：**

首先，您正在动态创建对象数组。所以你必须知道数组的大小。

其次，您的循环从索引 1 开始，它应该是 0。

# php - 表单数据和Button在同一个_POST

> ID：11452252
> 
> 赞同：0
> 
> 时间：2012-07-12T12:51:22.350
> 
> 标签：php, javascript, html

晚上！

我在弄清楚如何让特定的代码部分工作时遇到了一个问题，我有这个：

```
 <form>
        TestCheckBox
        <input type="checkbox" name="TestCheckBox" value="Yes" />
    </form>

    <div id="search">
        <input type="text" id="search_bar" /> 
        <input type="button" value="Search!" />
    </div> 
```

在一个 php 文件中，我有这个：

```
if($_POST['TestCheckBox'] == 'Yes'){
echo "TEST";
}
if (isset($_POST['action']) && !empty($_POST['action'])) {
generateHTML($_POST['action']);
}
else {
echo "NOTHING IS HERE";
} 
```

显然这不是如何做到这一点。我很好奇我可以让我的搜索栏提交也包含在复选框中的帖子数据。

（这是一个搜索栏，复选框是高级搜索选项，所以我自然只想要一个搜索按钮）。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:54:33.083

1.  给输入名称（没有它们它们不能成功控制）
2.  将它们放在表单中（否则它们仅对客户端脚本有用）
3.  使表单发出 POST 请求（默认为 GET）。
4.  使用提交按钮，以便提交表单（常规按钮仅适用于客户端脚本）

包含标签也是有益的（它告知用户控件的用途并提供更大的点击目标（后者对于复选框和单选按钮尤其重要））。

这样的：

```
<form method="post">
    <label for="TestCheckBox">TestCheckBox</label>
    <input type="checkbox" name="TestCheckBox" id="TestCheckBox" value="Yes" />
    <div id="search">
        <label for="search_bar">Query</label>
        <input type="text" id="search_bar" name='action' /> 
        <input type="submit" value="Search!" />
    </div>
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:53:11.410

您必须将`<form>`所有`<inputs>`.

```
<form>
    TestCheckBox
    <input type="checkbox" name="TestCheckBox" value="Yes" />

    <div id="search">
        <input type="text" id="search_bar" /> 
        <input type="button" value="Search!" />
    </div>
</form> 
```

# javascript - 柱形图中的颜色没有变化

> ID：11452253
> 
> 赞同：0
> 
> 时间：2012-07-12T12:51:22.693
> 
> 标签：javascript, google-visualization

我的应用程序中的颜色没有改变。我必须制作一个柱形图，但 x 轴上每个标签的颜色都没有变化。

```
<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Sales'],
          ['2004',  1000],
          ['2005',  1170],
          ['2006',  660 ],
          ['2007',  1030]
        ]);

        var options = {
          colors:['#A2C180','#3D7930','#FFC6A5','#FFFF42','#DEF3BD','#00A5C6','#DEBDDE','#000000'],
          title: 'Company Performance',
          hAxis: {title: 'Year', titleTextStyle: {color: 'red'}}
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html> 
```

或任何人告诉我如何在给定代码上添加或显示 x 轴标签....

```
<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
       var data = new google.visualization.DataTable();
    var raw_data = [
    ["January", parseFloat('120')],
    ["Februry", parseFloat('150')],
    ["March", parseFloat('50')],
    ["April", parseFloat('90')],
    ["May", parseFloat('100')],
    ["June", parseFloat('130')]
    ];
  var years = [' '];

    data.addColumn('string', 'sales');
    for (var i = 0; i  < raw_data.length; ++i) {
        data.addColumn('number', raw_data[i][0]);
    }

    data.addRows(years.length);

    for (var j = 0; j < years.length; ++j) {
        data.setValue(j, 0, years[j].toString());
    }
    for (var i = 0; i  < raw_data.length; ++i) {
        for (var j = 1; j  < raw_data[i].length; ++j) {
            data.setValue(j-1, i+1, raw_data[i][j]);
        }
    }
        var options = {
          colors:['#A2C180','#3D7930','#FFC6A5','#FFFF42','#DEF3BD','#00A5C6','#DEBDDE','#000000'],
          title: 'Company Performance',
          hAxis: {title: 'Year', titleTextStyle: {color: 'red'}}
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:08:55.790

使用 Google 的图表，它会将您拥有的数据视为具有 4 个值的一系列数据，而不是单独的数据位，并且实际上不可能将颜色应用于系列中的每个条形。

[正如在这个问题/答案](https://stackoverflow.com/questions/7938127/assign-different-color-to-each-bar-in-a-google-chart)中所看到的，有很多方法几乎可以实现您想要的，但不幸的是，没有什么能完全满足您的期望。

# javascript - 有什么方法可以规避 XHR 不使用动态子域对跨域请求发送 cookie？

> ID：11452257
> 
> 赞同：2
> 
> 时间：2012-07-12T12:51:32.957
> 
> 标签：javascript, ajax, cookies, cross-domain, same-origin-policy

我正在开发一个我想像这样工作的登录系统：

未登录时尝试发布会弹出带有 u/p 字段的警报 -> 提交 u/p ajax 命中登录路由 -> 成功登录设置“登录”cookie -> 再次尝试发布现在成功。无需重新加载页面。

看来我已经遇到了所有这些 CORS/跨域访问控制的障碍，因为我正在使用动态子域和 XHR 请求。

您可以在anywhere.mysite.com 并且必须将跨域ajax 到user.mysite.com/login 才能登录。

为了允许 login() 设置 cookie，您必须指定来源（没有“*”通配符），设置“Access-Control-Allow-Credentials = true”标头，并使用“xhrFields”提交 ajax : {'withCredentials': true}' 参数。我可以让它工作。

我的问题是动态域。不可能在接受的来源列表中设置所有可能的子域。是否有任何可能的方法让它接受 .mysite.com 作为来源，以便所有 subdomains.mysite.com 都通过？

[这篇文章](https://stackoverflow.com/a/3076648)列出了设置 document.domain = "company.com"; 的可能性。在 iframe 中实现这种功能，但我不确定在上面的登录流程中我会在哪里插入 iframe 或者它如何工作......

有什么想法吗？

# database - 在 Solaris 10 上安装 Oracle11g

> ID：11452264
> 
> 赞同：3
> 
> 时间：2012-07-12T12:51:44.170
> 
> 标签：database, solaris-10, database-installation

我正在本地 sun 机器上的 Solaris 10 上安装 Oravcle 11G。我已遵循 oracle 文档中提供的所有 pre-req 步骤，但毕竟当我尝试使用 oracle 用户运行安装程序时。安装程序检查 pre-reqs 并给我以下错误：

> > > > 检查监视器：必须配置为以 256 色显示。无法使用命令 /usr/openwin/bin/xdpyinfo 执行自动检查显示颜色。检查是否设置了 dsiplay 变量
> > > > 
> > > > > 设置显示变量我使用了以下命令： $DISPLAY=localhost:0.0 export DISPLAY

如果我忽略此错误继续安装，它会说：

> > 准备从 /tmp/OraInstall2012-07-12_05-57-10PM 启动通用安装程序。请稍候...$ Xlib：服务器拒绝连接到“localhost:0.0” Xlib：客户端无权连接到服务器。

请不要让我在 sun 服务器上本地执行安装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:18:57.063

只需关闭 root 会话并以 oracle 用户身份重新登录，然后发出`xclock`命令，您应该会看到图形时钟出现。这意味着好的，所以您现在可以运行`./runinstaller`命令来安装 oracle 软件。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-27T18:49:04.417

以root身份打开unix终端登录

# 主机+

以 oracle 用户 $xclock 身份打开另一个终端登录

您应该能够看到时钟显示。你很好运行runInstaller.sh

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T01:33:08.323

1) 以 root 身份登录 XWindows 2) 打开终端 3) 输入 'xhost +' 4) 输入 'su - oracle' 5) 输入 'export DISPLAY=:0.0' 6) runInstaller（或使用所需的任何安装程序）

# mysql - INSERT ... ON DUPLICATE KEY - 如何在非主键上执行此操作？

> ID：11452269
> 
> 赞同：2
> 
> 时间：2012-07-12T12:52:01.517
> 
> 标签：mysql, sql

我有以下问题。我有一个表，其中包含`id`、`track_id`和`artist_id`等列`title`。唯一的唯一键是主键`id`，它是一个自增整数。`track_id`不是唯一的。

因此，出现了我需要更新`title`具有特定`track_id`. 如果不存在这样的记录，则应创建一个新记录。我不能使用 REPLACE INTO 或 INSERT...ON DUPLICATE KEY，因为这些操作使用唯一键或主键。我也不能使用多个查询，因为要进入的系统需要在单个查询中完成这些类型的操作。该查询可以根据需要尽可能复杂，但它们都必须位于一个查询中。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:02:41.470

按以下顺序执行这两个查询：

```
update track set
title = ?
where track_id = ?;

insert into track (nonkey_col_1, nonkey_col_2, ...)
select 'nonkey_col_1_value',  'nonkey_col_2_value', ...
from track
where not exists (select * from track where track_id = ?)
limit 1; 
```

其中只有一个会产生任何影响：第一个仅在有一行时执行。第二个仅在*没有*行的情况下执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:58:02.740

你只是想做一个upsert。如果不存在则插入，如果存在则更新。android 无法做到这一点，因为它不支持多个查询。

我对这类事情的处理方法是：首先`select track_id from ... where track_id=THE_ID`。如果`resultCursor.getCount()!=0`则该行存在，因此您需要`update`，否则`insert`。

至于时间，sqlite数据库中的单个标量是非常快的。

# ruby-on-rails-3 - 如何使用 netbeans 配置 rvm

> ID：11452277
> 
> 赞同：2
> 
> 时间：2012-07-12T12:52:38.517
> 
> 标签：ruby-on-rails-3, configuration, rvm

我已经在我的 rvm 中安装了 ruby​​ 1.9.2-p1890 并且 gem 目录是

```
/Users/abhay/.rvm/gems/ruby-1.9.2-p180 
```

我的 netbeans 检测到 rvm 和 ruby​​ 已安装，但是当我右键单击项目属性->管理时

```
gem home is - /Users/abhay/.rvm/rubies/ruby-1.9.2-p180/lib/ruby/gems/1.9.1

gem path is - /Users/abhay/.rvm/rubies/ruby-1.9.2-p180/lib/ruby/gems/1.9.1

gem tool is - /Users/abhay/.rvm/rubies/ruby-1.9.2-p180/bin/gem (1.8.24)

interpreter - /Users/abhay/.rvm/rubies/ruby-1.9.2-p180/bin/ruby 
```

当我运行我的项目时，我收到了这个错误

```
 /Users/abhay/.rvm/rubies/ruby-1.9.2-p180/bin/ruby: No such file or directory -- script/server (LoadError) 
```

# html - 如何在cshtml文件中隐藏复选框值 - mvc html

> ID：11452284
> 
> 赞同：1
> 
> 时间：2012-07-12T12:52:46.203
> 
> 标签：html, asp.net-mvc, razor

我有一个代码

```
@if (Model.Subscribed)
{ 
<div>
@Html.CheckBox("Subscribed", false) I would like to unsubscribe! 
</div>
}
else
{ 
<input type="hidden" name=Subscribed" value="true" />
} 
```

我想在选中复选框后隐藏整个句子。第一次点击提交时它是隐藏的，但是当返回表单页面时，复选框语句会以未标记的复选框返回。

谁能帮我。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T12:52:43.963

这是你要找的吗？

```
@Html.CheckBox("Subscribed", false, new { onclick = "javascript:$('#spnSubscribed').hide();" }) <span id="spnSubscribed">I would like to subscribe!</span> 
```

# c# - 使用 C# 表达式的通用约束 - 不能隐式转换类型

> ID：11452287
> 
> 赞同：4
> 
> 时间：2012-07-12T12:52:53.490
> 
> 标签：c#, generics, lambda, expression

我已经开始使用 C# Expression 构造，并且我有一个关于泛型如何在以下情况下应用的问题：

考虑我有一个类型`MyObject`，它是许多不同类型的基类。在这个类中，我有以下代码：

```
// This is a String Indexer Expression, used to define the string indexer when the object is in a collection of MyObjects
public Expression<Func<MyObject, string, bool>> StringIndexExpression { get; private set;}

// I use this method in Set StringIndexExpression and T is a subtype of MyObject
protected void DefineStringIndexer<T>(Expression<T, string, bool>> expresson) where T : MyObject
{
    StringIndexExpression = expression;
} 
```

这就是我的使用方式`DefineStringIndexer`：

```
public class MyBusinessObject : MyObject
{

   public string Name { get; set; }

   public MyBusinessObject() 
   {
       Name = "Test";
       DefineStringIndexer<MyBusinessObject>((item, value) => item.Name == value);
   }

} 
```

但是在里面的赋值中`DefineStringIndexer`我得到了编译错误：

> 无法将类型 System.Linq.Expression.Expression< MyObject, string, bool > 隐式转换为 System.Linq.Expression.Expression < MyBusinessObject, string, bool >>

在这种情况下，我可以将泛型与 C# 表达式一起使用吗？我想在 DefineStringIndexer 中使用 T ，这样我就可以避免在 lambda 中转换 MyObject 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:07:26.217

分配将不起作用，因为`Func<MyBusinessObject,string,bool>`类型与分配不兼容`Func<MyObject,string,bool>`。但是，这两个函子的参数是兼容的，因此您可以添加一个包装器以使其工作：

```
protected void DefineStringIndexer<T>(Func<T,string,bool> expresson) where T : MyObject {
    StringIndexExpression = (t,s) => expression(t, s);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:01:05.240

这对你会更好吗？

编辑：添加`<T>`到约束-认为您将需要它:)

```
class MyObject<T>
{
    // This is a String Indexer Expression, used to define the string indexer when the object is in a collection of MyObjects 
    public Expression<Func<T, string, bool>> StringIndexExpression { get; private set;} 

    // I use this method in Set StringIndexExpression and T is a subtype of MyObject 
    protected void DefineStringIndexer<T>(Expression<T, string, bool>> expresson) 
        where T : MyObject<T> // Think you need this constraint to also have the generic param
    { 
        StringIndexExpression = expression; 
    } 
} 
```

然后：

```
public class MyBusinessObject : MyObject<MyBusinessObject>
{ 

   public string Name { get; set; } 

   public MyBusinessObject()  
   { 
       Name = "Test"; 
       DefineStringIndexer<MyBusinessObject>((item, value) => item.Name == value); 
   } 

} 
```

# java - 从模式中提取 n-gram

> ID：11452290
> 
> 赞同：2
> 
> 时间：2012-07-12T12:53:07.003
> 
> 标签：java, n-gram

我试图从从文本文档中提取的模式中提取 ngram，模式具有不同数量的术语。

例如：如果模式 p={t1,t2,t3}

我们需要提取 ngram 3

应该是这样的

```
t1
t2
t3

t1, t2
t2,t3

t1,t2,t3 
```

我写了一些代码，但效果不佳。

```
 public Hashtable<String, Pattern> findGrams(XMLDocument d) {
    ArrayList<Pattern> patterns = d.getPatterns();

    System.out.println("patterns " + d.getPatterns());

    ArrayList terms = new ArrayList();
    Hashtable Grams = new Hashtable();

    String s = "";

    // to extract all terms from the pattern
    for (int i = 0; i < patterns.size(); i++) {
        Pattern pat = (Pattern) patterns.get(i);
        terms.clear();
        for (int z = 0; z < pat.getNumitems(); z++) {
            terms.add(pat.getItems().get(z).toString());
        }

        // to generate grams from the pattern
        int j = 0;
        int x=0;
        for (int y = 1; y <= ngram ; y++) {

             for ( x = 0; x < terms.size() & j != y; x++) {
                    s = terms.get(x).toString();

                    if (y > 1) {
                        for (j = x + 1; j < terms.size() & terms.indexOf(j) < ngram; j++) {
                            s = s + "," + terms.get(j).toString();
                        }
                    }

                    if (!Grams.contains(s)) {
                        System.out.println(s);
                        Grams.put(s, i);
                    }
                }

        }
    }
    return (Grams);
} 
```

请提供任何帮助，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T09:51:19.990

我希望这会给你想要的。

```
import java.util.*;

public class Test {

    public static List<String> ngrams(int n, String str) {
        List<String> ngrams = new ArrayList<String>();
        String[] words = str.split(" ");
        for (int i = 0; i < words.length - n + 1; i++)
            ngrams.add(concat(words, i, i+n));
        return ngrams;
    }

    public static String concat(String[] words, int start, int end) {
        StringBuilder sb = new StringBuilder();
        for (int i = start; i < end; i++)
            sb.append((i > start ? " " : "") + words[i]);
        return sb.toString();
    }

    public static void main(String[] args) {
        for (int n = 1; n <= 3; n++) {
           for (String ngram : ngrams(n, "t1 t2 t3"))
               System.out.println(ngram);
            System.out.println();
        }
    }
} 
```

# c# - net xmlserializer：保持属性顺序

> ID：11452293
> 
> 赞同：0
> 
> 时间：2012-07-12T12:53:14.050
> 
> 标签：c#, .net, xml-serialization

我可以成功地将我的类 Item 写入 xml 文件。但是属性的顺序改变了......

假设我有 Item 类

```
class Item
{
   Name
   Price
   Id

} 
```

当我使用 .net xmlserializer 将它写入 xml 文件时，我从我的类 decleration 中得到不同的顺序，例如

```
<Item Price="y" Name="x"  Id="z"  /> 
```

但我想要这样 [保持 decleration order]

```
<Item Name="x" Price="y" Id="z"  /> 
```

我怎么能在 NET 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:56:56.203

你不应该关心订单。如果是，那么您没有正确处理您的 xml

> 第 3.1 节“请注意，开始标签或空元素标签中属性规范的顺序并不重要。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-28T13:25:03.017

您热衷于属性的顺序，那么`IXmlSerializable`界面将使您控制类的序列化/反序列化过程。属性的顺序由代码行的顺序决定：

```
public void WriteXml(XmlWriter writer)
{
  //First example xml element
  writer.WriteStartElement("Item1");
  writer.WriteAttributeString("Name", Name);
  writer.WriteAttributeString("Price", Price);
  writer.WriteAttributeString("Id", Id);
  writer.WriteEndElement();

  //Second example xml element
  writer.WriteStartElement("Item2");
  writer.WriteAttributeString("Price", Price);
  writer.WriteAttributeString("Id", Id);
  writer.WriteAttributeString("Name", Name);
  writer.WriteEndElement();
} 
```

输出：

```
<Item1 Name="x" Price="y" Id="z">
<Item2 Price="y" Id="z" Name="x"> 
```

如您所见，如果您切换代码行，则顺序会更改。

但请注意，实现此接口会覆盖默认过程，让您自己编写整个序列化/反序列化过程。

小心谨慎

# iis-5 - HTTP 403.9 - 禁止访问：错误

> ID：11452294
> 
> 赞同：0
> 
> 时间：2012-07-12T12:53:14.390
> 
> 标签：iis-5

我`ve been constantly getting the same error,like "HTTP 403.9 - Access Forbidden: Too many users are connected Internet Information Services Technical Information". I went through this site and found this command -> "C:\Inetpub\AdminScripts\adsutil set w3svc/MaxConnections 40" to set maximum connections.Even after running this command I still have the same error. I`正在使用 IIS V.5.1、Oracle 10g、IE 9.0。有没有更好的解决方法？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:15:29.580

使用更大的数字。

如果你有足够的钱来支付 MS IIS 和 Oracle 的许可，那么你应该能够买得起支持 40 多个并发请求的硬件（这里没有你的设置/代码来测试 - 我希望我最便宜的 PC今天可以购买将支持超过 500 个运行 Linux、Apache 和 MySQL/Postgress 的并发连接）。

# c# - MVC3 单选按钮

> ID：11452295
> 
> 赞同：0
> 
> 时间：2012-07-12T12:53:15.230
> 
> 标签：c#, asp.net-mvc-3, radio-button

我正在使用 C# + MVC3。我在表单上有一个单选按钮，但我遇到了一些问题。

在 Index.cshtml，我有：

```
<div class="display-label">
    Label
</div>
<div class="display-field">@Html.RadioButton("rdActive", ((FakeClass)ViewBag.FakeFilter).Situation, "S"); 
```

在我的控制器索引处，我有：

```
 ViewBag.FakeFilter = new FakeClass()
    {
        Situacao = (Request.Form["rdActive"] == "" ? null : Request.Form["rdActive"])
    } 
```

我得到 ArgumentNullPointerException

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T13:28:31.193

根据我对您的错误的理解，它会抛出 Nullpontier，因为您收到的是空的，`Request.Form["rdActive"]`因此当代码通过该操作时，会将 null 返回给 viewbag。

现在我看到奇怪的是，帮助程序的重载在最后一个参数中接收一个布尔值，而你正在传递一个带有“s”的字符串。

这

```
@Html.RadioButton("rdActive", ((FakeClass)ViewBag.FakeFilter).Situation, "S") 
```

应该

```
@Html.RadioButton("rdActive", ((FakeClass)ViewBag.FakeFilter).Situation, true) 
```

或者

```
@Html.RadioButton("rdActive", ((FakeClass)ViewBag.FakeFilter).Situation, false) 
```

检查参数

![在此处输入图像描述](../Images/7f6642d5485101d1e66de93fe9a2687c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:56:23.117

也许 ViewBag 在您的视图中不可用，请尝试使用 TempData["FakeFilter"] 可以从任何视图访问并在您阅读后被删除（默认情况下）

# python-3.x - 导入父目录进行简要测试

> ID：11452299
> 
> 赞同：21
> 
> 时间：2012-07-12T12:53:28.543
> 
> 标签：python-3.x, pythonpath, project-layout

我已经从头到尾搜索了这个站点，但还没有找到一种方法可以在 Python3x 中真正完成我想要的。这是一个简单的玩具应用程序，所以我想我可以在断言中编写一些简单的测试用例，然后收工。它确实会生成报告等，所以我想确保我的代码在更改时不会做任何奇怪的事情。

我当前的目录结构是：（仅包括相关部分）

```
project
  -model
     __init__.py
     my_file.py
     -test
       my_file_test.py 
```

我很高兴让 my_file_test.py 导入 my_file.py。

就像我说的那样。我从上到下搜索了这个网站，但没有任何解决方案有效。我的 Python 版本是 3.2.3，在 Fedora 17 上运行。

以前尝试过的尝试： [https :](https://stackoverflow.com/questions/4655526/how-to-accomplish-this-relative-import-in-python) [//stackoverflow.com/questions/5078590/dynamic-imports-relative-imports-in-python-3 从父文件夹导入模块](https://stackoverflow.com/questions/714063/python-importing-modules-from-parent-folder) [谁能解释python的相对导入？](https://stackoverflow.com/questions/1918539/can-anyone-explain-pythons-relative-imports) [如何在python中完成相对导入](https://stackoverflow.com/questions/4655526/how-to-accomplish-this-relative-import-in-python)

几乎在每次尝试中，我都会遇到以下错误：

ImportError: No module named * OR ValueError: Attempted relative import in non-package

这里发生了什么。我已经尝试了关于 SO 以及整个互联网的所有公认答案。在这里没有做任何花哨的事情，但作为 .NET/Java/Ruby 程序员，这被证明是直观性的绝对定义。

编辑：如果重要的话，我尝试加载我试图在 REPL 中导入的类，我得到以下信息：

```
>>> import datafileclass
>>> datafileclass.methods
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
>>> x = datafileclass('sample_data/sample_input.csv')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'module' object is not callable 
```

如果这很重要...我知道课程中的功能有效，但我无法导入它，这导致无法进行测试。将来肯定会引起集成问题。（更改名称以保护无辜者）在几周内获得此库迭代所需的功能......任何帮助都可能有用。本来可以在 Ruby 中完成，但客户希望 Python 作为一种学习体验，

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-12T13:00:57.943

像这样构造你的代码：

```
project
  -model
    __init__.py
    my_file.py
  -tests
    __init__.py
    test_my_file.py 
```

重要的是，您的`tests`目录也应该是一个模块目录（其中有一个空`__init__.py`文件）。

然后在 test_my_file.py 中使用`from model import my_file`，并从顶层目录运行`python -m tests.test_my_file`。这是作为模块调用`test_my_file`的，这会导致 Python 设置其导入路径以包含您的顶层。

更好的是，您可以使用 pytest 或 nose，运行`py.test`会自动获取测试。

我意识到这并不能回答您的问题，但是使用 Python 标准实践而不是反对它们会容易得多。这意味着在他们自己的顶级目录中使用测试来构建您的项目。

# java - 单例对象正在重新创建

> ID：11452304
> 
> 赞同：4
> 
> 时间：2012-07-12T12:53:56.637
> 
> 标签：java, android, singleton

我面临一个问题，我创建了一个`Controller`单例类，但是当我访问同一应用程序的不同活动时，它的对象正在重新创建，

**Main_Activity**是我的启动活动

```
public class Main_Activity extends Activity{
       private Controller simpleController;
       protected void onCreate(Bundle savedInstanceState) {
                 super.onCreate(savedInstanceState);
                 setContentView(R.layout.main);
                 simpleController = Controller.getInstance(this);
       }
} 
```

这是我`Controller`的单例，在其中我设置了从现在开始 10 秒的警报，我`MyMainLocalReciever`收到该警报并使用通知进行通知。

```
public class Controller {
       private MediaPlayer mp;
       public Context context;
       private static Controller instance;

       public static Controller getInstance(Context context) {
              if (instance == null) {
                    instance = new Controller(context);
              }
              return instance;
       }

      private Controller(Context context) {
            Log.d("TAG", "Creating Controller object");
            mp = null;
            this.context = context;
            setAlarm(10);
        }

     public void setAlarm(int position) {
        Intent intent = new Intent(context, MyMainLocalReciever.class);
        intent.putExtra("alarm_id", "" + position);
        PendingIntent sender = PendingIntent.getBroadcast(context,
                position, intent, PendingIntent.FLAG_UPDATE_CURRENT);

        // Get the AlarmManager service
        AlarmManager am = (AlarmManager) context
                .getSystemService(Activity.ALARM_SERVICE);
        am.cancel(sender);
        am.set(AlarmManager.RTC_WAKEUP, System.currentTimeMillis()
                + (position*1000), sender);
    }

} 
```

这是我`MyMainLocalReciever`通知的接收器，我正在绑定一个启动名为的活动的意图`NotificationDialog`

```
public class MyMainLocalReciever extends BroadcastReceiver {
private NotificationManager notificationManager;
private int alarmId = 0;

@Override
public void onReceive(Context context, Intent intent) {
    if (notificationManager == null) {
        notificationManager = (NotificationManager) context
                .getSystemService(Context.NOTIFICATION_SERVICE);
    }
    Bundle bundle = intent.getExtras();

    String alarm_Id = bundle.getString("alarm_id");

        try {
        alarmId = Integer.parseInt(alarm_Id);
    } catch (Exception e) {
        Log.d("Exception", "exception in converting");
    }

    Controller myC = Controller.getInstance(context);
    if ((myC.getMp() != null)) {
        myC.getMp().stop();
        myC.setMp(null);
    }
    if (myC.getMp() == null) {

            myC.setMp(MediaPlayer.create(context , R.id.mpFile));
            myC.getMp().start();
    }

    NotificationCompat.Builder builder = new NotificationCompat.Builder(context)
            .setTicker("Its Ticker")
            .setSmallIcon(R.drawable.ic_launcher)
            .setContentTitle("Its Title")
            .setContentText("Its Context")
            .setAutoCancel(true)
            .setContentIntent(
                    PendingIntent.getActivity(context, 0, new Intent(context,
                            NotificationDialog.class)
                            .addFlags(Intent.FLAG_ACTIVITY_NEW_TASK
                                    | Intent.FLAG_ACTIVITY_CLEAR_TASK), 0));

    notificationManager.notify("interstitial_tag", alarmId,
            builder.getNotification());

}

} 
```

到现在（之前`NotificationDialog`）代码正在工作`MediaPlayer`，类中的完美对象也`Controller`工作正常，但是当我`Controller`在这里访问我的单例时`NotificationDialog`，它正在创建控制器的新对象，它不应该这样做，它应该保留那个`Controller`是单例的对象.

```
public class NotificationDialog extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.notification_dialog);

}

public void onViewContent(View v) { //this method is invoked when I click on a button binded in xml file

    Controller myC = Controller.getInstance(getApplicationContext());

    if (myC.getMp() != null) {
        myC.getMp().stop();
        myC.setMp(null);
    }
    finish();
} 
```

}

请在这方面帮助我，我将感谢您的帮助。问候

**编辑：** 这是我的清单

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".Main_Activity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="test.SettingsActivity"
        android:label="@string/app_name" />
    <activity
        android:name="test.NotificationDialog"
        android:label="@string/app_name" />
    <service android:name="test.MyService" >
    </service>

    <receiver
        android:name="test.MyMainLocalReciever"
        android:process=":remote" />
</application> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T13:26:21.957

当您的进程在后台空闲时，它会被 Android 杀死。如果没有活动组件（活动、服务等）或需要内存（即使您有活动组件），Android 将终止您的进程。

当用户使用您的通知时，Android 会为您创建一个新进程。这就是 Singleton 消失并需要重新创建的原因。

**编辑：**

在您发布清单后，我立即看到了问题。就是这个：

```
<receiver
    android:name="test.MyMainLocalReciever"
    android:process=":remote" /> 
```

你的进程没有被杀死。您的 BroadcastReceiver 正在另一个单独的进程中运行。在那个过程中，单身人士还没有建立起来。

`android:process=":remote"`从`<receiver>`清单中的标签中删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:59:55.327

请阅读[Initialization-on-demand holder idiom](http://en.wikipedia.org/wiki/Initialization-on-demand_holder_idiom)。这是一篇关于 Java 编程语言中正确的 Singleton 的非常清晰和简单的文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:04:14.277

由于 Singleton 将是许多活动使用的静态对象，因此您不必将 Context 传递给构造函数。将它传递给需要它的方法是一个更好的选择。

```
public class Controller {

        private static volatile Controller instance = null;

        private Controller () {   }

        public static Controller getInstance() {
                if (instance == null) {
                        synchronized (Controller .class)
                                if (instance == null) {
                                        instance = new Controller();
                                }
                }
                return instance;
        }

        public void setAlarm(Context context, int position) {
             // do stuff
        }
} 
```

# iphone - 一段时间后如何更新解析数据

> ID：11452305
> 
> 赞同：-3
> 
> 时间：2012-07-12T12:54:05.690
> 
> 标签：iphone, ios, ios4

我有 xml [http://weather.yahooapis.com/forecastrss?w=20070458&u=c](http://weather.yahooapis.com/forecastrss?w=20070458&u=c)，我希望当 xml 更新时，我的数据也会更新。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:59:24.390

如您所见，此 XML 有`ttl`节点，它告诉*生存时间*是 60 秒。因此，您可以定期（每分钟一次，根据**TTL**值）检查此 URL 并保持最新状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:01:58.123

阅读本教程以获取[xmlparser](http://www.xcode-tutorials.com/parsing-xml-files/)和[NSXMLParser 类参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)。我想这会对你有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:02:01.243

你可以对它进行投票。

```
static void timerHandler(CFRunLoopTimerRef timer, void *info)
{
    //request the xml here and compare it with the previous one
}

- (void)weatherMonitor
{
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    CFRunLoopTimerContext context = {0, self, NULL, NULL, NULL};
    CFRunLoopTimerRef timer = CFRunLoopTimerCreate(kCFAllocatorDefault, CFAbsoluteTimeGetCurrent(), 1, 0, 0, timerHandler, &context);//use your own time interval
    CFRunLoopAddTimer(CFRunLoopGetCurrent(), timer, kCFRunLoopDefaultMode);
    CFRelease(timer);
    CFRunLoopRun();
    [pool drain];
} 
```

在后台线程中运行 weatherMonitor。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T13:31:00.117

您有 2 个选项：

1.  实施[Easy APNS](http://www.easyapns.com/)，它将通知您的应用程序任何更改。您可以直接在通知消息中传递 xml 数据，或者您可以在收到通知后立即发起请求以提取 xml。
2.  在您的应用程序中设置一个计时器，该计时器将启动请求以每 1-10-60 分钟检查一次 xml 更新，无论如何。

两者各有利弊，取决于你的要求和能力。有一点很清楚：除了实现推送通知之外，您无法在不发送请求的情况下从外部接收数据。即使应用程序没有运行，实施[Easy APNS也会为您的应用程序提供数据。](http://www.easyapns.com/)另一方面，使用计时器将是最快/最简单的方法。你决定。干杯!

# c# - 带有 .HTML 的 asp.net 中的可路由 URL 在托管服务器中出现 404 错误

> ID：11452316
> 
> 赞同：0
> 
> 时间：2012-07-12T12:54:31.323
> 
> 标签：c#, asp.net

我的网站[http://www.indiatimepass.info](http://www.indiatimepass.info)有可路由的 url，它在 url 中运行良好，没有任何“。” （点）但如果我添加一个“。” （点）在 url 它给我没有找到页面错误。

[http://www.indiatimepass.info/link/11/welcome.html](http://www.indiatimepass.info/link/11/welcome.html)给出错误

[http://www.indiatimepass.info/tags/asp.net](http://www.indiatimepass.info/tags/asp.net)也报错

[http://www.indiatimepass.info/tags/free](http://www.indiatimepass.info/tags/free) bse 提示工作正常

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:27:01.623

我找到了答案...

```
 <system.webServer>
        <modules runAllManagedModulesForAllRequests="true">
            <remove name="UrlRoutingModule"/>
            <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, system.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        </modules>
        <handlers>
            <add name="UrlRoutingHandler" preCondition="integratedMode" verb="*" path="UrlRouting.axd" type="System.Web.HttpForbiddenHandler, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
        </handlers>
    </system.webServer> 
```

谢谢。

# visual-studio - 塑料单片机中的代码共享

> ID：11452321
> 
> 赞同：2
> 
> 时间：2012-07-12T12:54:43.970
> 
> 标签：visual-studio, plasticscm

我正在尝试 Plastic SCM，但我正在努力解决一个特定问题。我想在另一个项目中包含一些通用代码。我终于想出了如何制作一个 xlink，但后来发现你不能从另一个存储库中选择一个子文件夹，而必须包含整个东西。当我这样做时，Visual Studio 对第二个 AssemblyInfo 以及可能的其他一些事情产生了影响。

现在我可以将裸代码文件放入“模块”存储库中，但我希望将其作为一个 VS 项目来方便地管理和开发它。

我现在想出的是：

*   程序回购
    *   解决方案
        *   项目
            *   XLink 到“模块包括回购”
*   模块开发回购
    *   解决方案
        *   项目
            *   XLink 到“模块包括回购”
*   模块包括回购
    *   要包含的文件

这应该可行，但需要为我要包含的每组文件使用单独的存储库。没有更好的方法来实现这一目标吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:50:02.753

根据您的评论，您需要的是利用 Xlinks。

Plastic SCM 中的 Xlink 基本上是给定变更集上路径的特殊目录条目，因此保留了“cset 不变性”。

有两种 xlink：

*   Readonly xlinks：这意味着您只需使用链接的代码来构建，但在处理链接它的源树时不会修改它。
*   Writable xlinks：这意味着您将在处理项目时修改链接的代码。它们类似于 git 子模块，但“做得对”，这意味着，塑料处理所有管道以将父级更新为在子级上创建的新 cset。

回答您的问题：是的，现在您需要 3 个存储库来设置您正在处理的项目：1) Program Repo 2) Module Dev Repo 3) Module Incl Repo（这是其他两个将引用的项目） )

只读 xlinks 的工作流程是：

*   您在“program repo”上创建指向“module incl repo”的xlink，例如：

cm xlink src\incl / 23@ModuleIncl@yourserver:8087

这意味着您正在 src\incl 创建一个 xlink，指向 repo“ModuleIncl”中的变更集 23。

*   您签入以提交您新创建的 xlink

*   更新你的 wk 以从 xlink 获取代码（它不是在 ci 上完成的）

*   然后，如果在某些时候您需要更新到 cset 30，您将编辑 xlink（从 CLI 或 GUI）以指向新的：

cm xlink -e src\incl / 30@ModuleIncl@yourserver:8087

这对于只读工作流程来说已经足够了。

您可以在此处找到有关 Xlinks 的更多信息[http://www.plasticscm.com/releases/4.1/manuals/en/xlinksguide.pdf](http://www.plasticscm.com/releases/4.1/manuals/en/xlinksguide.pdf)

# internet-explorer - 如何使用 WebBrowser 控件禁用 VB6 中的缓存？

> ID：11452322
> 
> 赞同：2
> 
> 时间：2012-07-12T12:54:50.400
> 
> 标签：internet-explorer, caching, vb6, webbrowser-control

我使用这段代码：

```
WebBrowser1.Navigate (url)

Dim html As String
html = WebBrowser1.Document.body.innerhtml 
```

在页面的 html 中，我什至放了元：

```
<meta http-equiv="cache-control" content="no-cache"> 
```

我尝试按照此处关于类似[SO 问题](https://stackoverflow.com/questions/3421144/how-to-disable-caching-in-the-net-webbrowser-control)的建议进行操作，但这对 VB6 都没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T14:04:20.747

尝试做：

```
WebBrowser1.Navigate url, 4 
```

4 关闭缓存。

# animation - cocos2d动画预加载导致内存崩溃

> ID：11452324
> 
> 赞同：0
> 
> 时间：2012-07-12T12:55:10.340
> 
> 标签：animation, cocos2d-iphone, ccsprite

我在 cocos2d 项目中遇到内存管理问题。对于我的应用程序，我需要在交互开始之前构建所有动画。我有三个动画。每个都有大约 20 个 png 文件，分辨率为 1300 x 1000 像素，大小为 200ko。

所以在我的初始化中我只是写了：

```
self.animation = [CCAnimation animation];
[_animation setDelayPerUnit:0.04];
for(int i = 1; i <= 20; i++)
{
   [_animation addSpriteFrameWithFilename:[NSString stringWithFormat:@"image(%d)@2x.png",i]];
}
[[CCAnimationCache sharedAnimationCache] addAnimation:_animation name:@"animationWin"]; 
```

这种代码被执行了 3 次。如果我运行我的应用程序，它会直接崩溃。如果我只预加载 2 个动画，我就不会崩溃。如果我在 for 循环中设置断点，我可以看到它在其中崩溃。

我不知道如何解决这个问题......你有什么想法吗？

非常感谢你的帮助 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T19:56:56.203

> 每个都有大约 20 个 png 文件，分辨率为 1300 x 1000 像素，大小为 200ko。

让我们做一些数学，好吗？

假设 PNG 文件是 32 位并且您没有启用 NPOT（非二次幂）支持，每个纹理消耗：

1300x1000 => 扩展到 2 的幂 => 2048x1024 => 像素数 => 2,097,152 => 每像素乘以 32 位（4 字节）颜色深度 => 8 MB => 乘以 20 纹理 => tadaaa … 高达 160 MB纹理内存使用。

**嗯，有你的问题！**

PNG的文件大小无关紧要。它是一种压缩格式。但是纹理是未压缩的，除非你切换到压缩得非常好的 PVR，但你也会得到伪影和变色。

绝对最好的解决方案是调低您尝试加载的艺术品的大小和/或数量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T17:32:08.500

以下将为您清除内容。

```
NSLog(@"AppDelegate<applicationDidReceiveMemoryWarning> : before purging all caches");
[[CCTextureCache sharedTextureCache] dumpCachedTextureInfo];
[[CCSpriteFrameCache sharedSpriteFrameCache] removeUnusedSpriteFrames];
[[CCDirector sharedDirector] purgeCachedData];
NSLog(@"AppDelegate<applicationDidReceiveMemoryWarning> : after purging all caches");
[[CCTextureCache sharedTextureCache] dumpCachedTextureInfo]; 
```

更改为 PVR 格式将无济于事，因为纹理大小决定了内存量（PVR 只会受益于“磁盘”大小和加载时间，而不是运行时所需的 RAM）。每个像素的深度将：

```
+(void) mediumPixelFormat{
    [CCTexture2D setDefaultAlphaPixelFormat:kTexture2DPixelFormat_RGBA4444];
} 
```

您可以随时更改格式。我还注意到 1300x1000，这在 POT 中非常浪费。这实际上将占用与 2048x2048 纹理一样多的空间。有什么方法可以与您的图形艺术家合作将其剃成 1024x1024 ，或者将 3 个纹理组合成 2 个？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:26:24.433

那么我认为你使用了太多的内存。您应该尝试使用 spritesheets/batchnodes，另一种纹理格式，如 PVRTC，并尝试使用不同的像素格式。

为了帮助解决上述所有问题，我推荐[Texture Packer](http://www.codeandweb.com/texturepacker/)

# javascript - Javascript 找不到这些变量，为什么？

> ID：11452327
> 
> 赞同：2
> 
> 时间：2012-07-12T12:55:18.093
> 
> 标签：javascript, cordova, logcat

我正在使用 Phonegap 创建一个 Android 应用程序（录音机），但我的代码中有以下 2 个错误：

1.  `ReferenceError: Can't find variable: Media.`

2.  `TypeError: Result of expression 'mediaRec' undefined is not an object.`

第一个错误发生在应用程序运行时。第二个错误发生在我调用 recordAudio(); 时。方法。

如果您知道，请告诉我有什么问题。

```
var mediaRec;
var src;
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {

}
function init() {
    document.getElementById('status').innerHTML = "Recording Status";
    src = "myrecording.mp3";
    mediaRec = new Media(src, onSuccess, onError);
}

function recordAudio() {
    // Record audio
    mediaRec.startRecord();
    // Stop recording after 10 sec
    var recTime = 0;
    var recInterval = setInterval(function() {
        recTime = recTime + 1;
        setAudioPosition(recTime + " sec");
        if (recTime >= 10) {
            clearInterval(recInterval);
        }
    }, 1000);
}

// Stop audio
function stopRecording() {
    if (mediaRec) {
        mediaRec.stopRecord();
    }
    clearInterval(mediaTimer);
    mediaTimer = null;
}
// onSuccess Callback
function onSuccess() {
    console.log("recordAudio():Audio Success");
}
// onError Callback 
function onError(error) {
    alert('code: ' + error.code + '\n' + 'message: ' + error.message + '\n');
}
// Set audio position
function setAudioPosition(position) {
    document.getElementById('rec_position').innerHTML = position;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-30T17:14:37.793

我认为 scr = "/android_asset/www/myrecording.mp3" 因为asset/www/中的目录phonegap ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-17T14:48:01.200

请务必添加定义全局**媒体**构造函数的“cordova-plugin-media”插件。请参阅[Cordova 媒体文档](https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-media/index.html) `cordova plugin add cordova-plugin-media --save`

发生这种情况的另一个原因是一定要等到设备准备好 Cordova 事件后再`new Media`调用构造函数。

# xcode - XCode 使用方向更改更改背景图像

> ID：11452328
> 
> 赞同：2
> 
> 时间：2012-07-12T12:55:23.440
> 
> 标签：xcode, uiwebview, background-image, device-orientation

我有一个 iPhone 应用程序，它由一个显示网站的 UIWebView 组成。在 UIWebView 在我的`ViewController.m`文件中完成加载后，我已经为它设置了一个背景图像，如下所示：

```
- (void)webViewDidFinishLoad:(UIWebView *)webView {
     // Set UIWebView Background Image
     self->webView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"ui-background-portrait.png"]];
} 
```

当设备处于纵向时这很好，但是如果用户将设备方向切换为横向，我想更改背景图像，如果他们再次切换，则返回纵向等。

我写了下面的代码，但我不知道把它放在哪里（因为它需要在切换方向时更改背景图像；不仅仅是一次）：

```
- (void)webViewDidFinishLoad:(UIWebView *)webView {
    // Set UIWebView Background Image
    if (UIDeviceOrientationIsPortrait([UIDevice currentDevice].orientation))
    {
        // code for Portrait orientation  
        self->webView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"ui-background-portrait.png"]];
    }
    if (UIDeviceOrientationIsLandscape([UIDevice currentDevice].orientation))
    {
        // code for landscape orientation  
        self->webView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"ui-background-landscape.png"]];
    }
} 
```

我怎样才能做到这一点？如果你能给我代码并指出把它放在哪里，那将是一个很大的帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:01:29.710

在您的视图控制器中覆盖这些方法之一并将您的代码放在那里。

[– willRotateToInterfaceOrientation:duration:](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/willRotateToInterfaceOrientation%3aduration%3a)

[– willAnimateRotationToInterfaceOrientation:duration:](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/willAnimateRotationToInterfaceOrientation%3aduration%3a)

[– didRotateFromInterfaceOrientation：](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/didRotateFromInterfaceOrientation%3a)

将此代码放入您的 ViewController.m

```
- (void) didRotateFromInterfaceOrientation:(UIInterfaceOrientation) fromInterfaceOrientation
{
    // Set UIWebView Background Image
    if (UIDeviceOrientationIsPortrait([UIDevice currentDevice].orientation))
    {
        // code for Portrait orientation  
        self->webView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"ui-background-portrait.png"]];
    }
    if (UIDeviceOrientationIsLandscape([UIDevice currentDevice].orientation))
    {
        // code for landscape orientation  
        self->webView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"ui-background-landscape.png"]];
    }
} 
```

# kendo-ui - 在 MVC 中重新绑定剑道网格

> ID：11452329
> 
> 赞同：2
> 
> 时间：2012-07-12T12:55:31.833
> 
> 标签：kendo-ui, kendo-grid, kendo-asp.net-mvc

在使用下面的 JavaScript 过滤数据后，我试图通过单击按钮重新绑定 Kendo Grid，但它不起作用。我应该怎么办？

**我使用 Kendo.Mvc.Dll 的 HTML 代码：**

```
Html.Kendo().Grid<EquityStreet.Data.ESData.Proc_GetESManagersListAndFilterResult>().Name("GridESManager").BindTo(Model.ESManagersList).Columns(columns =>
 {
     columns.Bound(m => m.pkESManagerId).Template(@<input type="checkbox" id="@item.pkESManagerId" />).Title("").Width("2%");
     columns.Bound(m => m.pkESManagerId).Template(@<text> @item.FirstName @item.LastName</text>).Title("Name");
     columns.Bound(m => m.CompanyName).Title("Company");
     columns.Bound(m => m.MobileNo).Title("Phone Number");
     columns.Bound(m => m.ESManagerStatus).Template(@<text>@(item.ESManagerStatus == 1 ? "Active" : "Inactive")</text>).Title("Status");
     columns.Bound(m => m.pkESManagerId).Template(@<text> <a href="../Utilities/NewESManager?EId=@item.pkESManagerId" class="access_btn">
     </a><a href="../Utilities/NewESManager?EId=@item.pkESManagerId" class="notes_btn"></a><a href="../Utilities/NewESManager?EId=@item.pkESManagerId" class="edit_btn">
     </a><a href="../Utilities/NewESManager?EId=@item.pkESManagerId" class="delete_btn"></a>
            </text>).Title("Actions");
 }).ToolBar(tb =>
 {
     tb.Template("<div class='GridSearchHeader'><div style='float:left'><input type='button' value='Reset Pwd'><input type='button' value='Delete'></div><label>Filter: </label><input type='search' style='width: 230px' id='txtSearch'><select id='Status'><option value=-1>Select</option><option value=1>Active</option><option value=0>Inactive</option></select><input type='button' onclick='FilterList()' value='Go'><input type='button' value='Reset'></div>");
 }).Pageable()
                              ) 
```

**JavaScript：**

```
 $.post('@Url.Action("FilterESManagerList", "../../Utilities")', { Keyword: Search, UserStatus: status }, function (result) {
            var grid = $("#GridESManager").data("kendoGrid");
            grid.dataSource.data(result);
            grid.refresh();
            alert(grid);
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T10:23:13.330

调用`grid.dataSource.data(result)`应该重新绑定网格，除非`result`它不是预期的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-27T22:51:03.840

尝试这个：

```
$("#gridName").data("kendoGrid").dataSource.sync(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-11T14:05:39.203

看起来在使用ajax-binding时，调用`grid.dataSource.fetch()`会触发datasource中定义的read方法并自动重新绑定。

# php - 如果参数不正确，则停止实例化类

> ID：11452338
> 
> 赞同：2
> 
> 时间：2012-07-12T12:56:05.293
> 
> 标签：php, class

是否可以创建一个像这样运行的 PHP 类：

```
class Foo
{
    function __construct($param)
    {
        if (!is_numeric($param))
        {
            // stop class
        }
    }
}

$a = new Foo(2);
$b = new Foo('test');

var_dump($a);
var_dump($b); 
```

这将返回

```
object(Foo)[1]
null 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:57:55.500

我知道停止创建新对象而不立即终止脚本的唯一方法是抛出异常：

```
class Foo {
    public function __construct($param) {
        if (!is_numeric($param)) {
            throw new \InvalidArgumentException('Param is not numeric');
        }
    ...
} 
```

当然，您必须确定并在调用代码中捕获异常并适当地处理问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T12:58:55.713

创建一个`static create($param)`返回新实例或 null 如果`$param`无效。您还可以考虑使用异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T14:43:49.553

您可以尝试抛出异常并从与变量声明相同范围内的另一个函数中捕获它：

```
class Foo
{
    function __construct($param)
    {

        if( !is_numeric($param) )
            return true;
        else
            throw new Exception();

    }

}

function createFooObject($v){
    try{ $x = new Foo($v); return $x; }
    catch(Exception $e){
        unset($x);
    }
}

$a = createFooObject(2);
$b = createFooObject('test');

var_dump($a);
var_dump($b); 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-07-12T13:06:57.770

几乎和你一样：

```
<?
public class newClass {

    public __CONSTRUCT($param = false){

        if(!is_numeric($param)){
            return false
        }

    }

}

$class = new newClass(1);
if($class){
    //success / is a number
}else{
    // fail, not a number, so remove the instance of the class
    unset($class);
}
?> 
```

在构造函数的参数中设置`$param = false`将告诉脚本如果没有输入将其设置为 false

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-07-12T13:02:53.053

`null`如果参数不是数字则返回：

```
<?php

    class Foo{

       public function __construct($param = null){
          if( !is_numeric($param) ){
             return null;
          }
       }

    }

?> 
```

# intellij-idea - 重定向 IntelliJ IDEA 的 IDE 终端

> ID：11452340
> 
> 赞同：1
> 
> 时间：2012-07-12T12:56:05.933
> 
> 标签：intellij-idea, terminal

我正在使用 Java 的[lanterna](http://code.google.com/p/lanterna/)库来编写基于控制台的基本 GUI。该库包括一个基于 Swing 的终端以及输出到系统终端应用程序的能力。

在 IDEA 中，当我尝试将系统终端功能与此库一起使用时，它会输出到 IDE 终端。有没有办法让 IntelliJ IDEA 直接`stdout`连接到系统终端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:17:24.350

IntelliJ IDEA doesn't have such feature. You can run the app in the real terminal and use Remote debugging instead.

# c++ - 在 QDockWidget 停靠时自动调整 QMainWindow 的大小

> ID：11452342
> 
> 赞同：1
> 
> 时间：2012-07-12T12:56:16.557
> 
> 标签：c++, qt, qmainwindow, qdockwidget

我有一个 QWidget 扩展以适应 QMainWindow。我可以停靠一个 QDockWidget，但前提是它适合当前的 QMainWindow 大小。

即使 QMainWindow 太小，我也希望能够删除 QDockWidget，在这种情况下调整它的大小以适应小部件。

可能吗？

**从评论编辑：**

当我将小部件拖到主窗口上时，窗口太小而无法容纳小部件，它不会停靠。因此，我不能使用停靠或取消停靠时发出的`QDockWidget`信号。信号。`topLevelChanged(bool)``QDickWidget`

# c# - 访问其他类中实现的接口方法

> ID：11452345
> 
> 赞同：2
> 
> 时间：2012-07-12T12:56:23.923
> 
> 标签：c#, .net-4.0, interface

我是 C# 新手，正在尝试实现一个接口。我知道我不能将访问修饰符放在接口方法上，那么如何在下面的“TestClass2”的公共静态“Create”方法中访问“TestValue”？我得到的错误是......

*“TestClass1”不包含“TestValue”的定义，并且找不到接受“TestClass1”类型的第一个参数的扩展方法“TestValue”*

```
public interface IParent
{
    string TestValue { get; }
}

public class TestClass1 : IParent
{
    string IParent.TestValue
    {
        get { return "hello"; }
    }
}

public class TestClass2
{
    private string _testValue;

    public static TestClass2 Create(TestClass1 input)
    {
        TestClass2 output = new TestClass2();
        output._testValue = input.TestValue;
        return output;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T12:59:08.183

**在您的具体实现中**添加`public`访问修饰符：

 **```
public class TestClass1 : IParent
{
    private TestClass1 _testValue; 

    public string TestValue
    {
        get { return "hello"; }
    }
} 
```

编辑：当您实际编写显式接口实现时，我建议您查看以下 SO 问题：[C# Interfaces。隐式实现与显式实现](https://stackoverflow.com/questions/143405/c-interfaces-implicit-and-explicit-implementation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:03:34.697

接口声明中不需要访问修饰符，因为接口的目的是为实现该接口的任何类定义可公开访问的协定。本质上，尽管您没有在定义中指定访问修饰符，但所有方法/属性都被视为公共的。

这意味着当您实现接口时，您必须*提供*与接口的方法/属性签名相匹配的*公共方法/属性。*

简而言之，将*public*访问修饰符添加到您的具体类实现中，您会很开心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T12:16:46.807

我尝试将对象转换为界面以获得这样的解决方案

```
public class TestClass2
{
    private string _testValue;

    public static TestClass2 Create(TestClass1 input)
    {
        TestClass2 output = new TestClass2();
        output._testValue =  ((ITestInterface)input).TestValue;
        return output;
    }
} 
```

这也有效，但我更喜欢更简单的解决方案。**

# c# - 在 Metro 应用程序的设置窗格中删除项目

> ID：11452346
> 
> 赞同：1
> 
> 时间：2012-07-12T12:56:27.353
> 
> 标签：c#, xaml, windows-8, windows-runtime

我正在使用 C# 和 XAML 开发 Metro 应用程序，在我的应用程序中，我有两个视图 View1 和 View2，对于 View1，我需要一个设置窗格，其中“选项、关于、注销”作为设置选项，对于 View2，我需要删除那些设置，那么我如何从设置魅力中删除设置选项，如果有人知道这个请帮助我，在此先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T10:22:15.650

查看[MSDN App 设置示例](http://code.msdn.microsoft.com/windowsapps/App-settings-sample-1f762f49)。基本上，您需要做的是：

1.  连接 CommandsRequested 事件处理程序：`SettingsPane.GetForCurrentView().CommandsRequested += onCommandsRequested;`
2.  在您的事件处理程序中，根据您的应用呈现的 View`onCommandsRequested`决定是添加还是删除s。`SettingsCommand`

    ```
    if (View1)
    {
        if (commands not added)
        {
            // add commands
        }
    }
    else if (View2)
    {
        if (commands not removed)
        {
            // removed commands
        }
    }
    else
    {
        throw new Exception("Unknown view!");
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-01T05:40:45.683

```
void OnCommandsRequested(SettingsPane sender, SettingsPaneCommandsRequestedEventArgs args)
{
    args.Request.ApplicationCommands.Clear();
    // or
    args.Request.ApplicationCommands.RemoveAt(0);
} 
```

# icons - Twitter Bootstrap 和 Font Awesome 出现重复图标问题

> ID：11452356
> 
> 赞同：10
> 
> 时间：2012-07-12T12:57:16.910
> 
> 标签：icons, twitter-bootstrap, duplicates, font-awesome

我遇到了这个菜单的问题，其图标使用引导程序和字体真棒，格式较少，并且在运行时使用 JavaScript 编译。

黑色和蓝色同时出现！

编码：

```
<div class="well sidebar-nav">
    <ul class="nav nav-list">
        <li class="nav-header">Relatórios</li>
          <li><a href="#"><i class="icon-facebook-sign"></i> Acessos na s-Commerce</a></li>
          <li><a href="#"><i class="icon-shopping-cart"></i> Acessos para a loja</a></li>
    </ul>
</div> 
```

浏览器输出：

![重复的图标](../Images/d05c98cc9e70d273dcd6e33e89d94d29.png)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-30T18:25:55.823

使用新版本的引导程序，我在 CSS 上所做的是：

```
 [class^="icon-"], [class*=" icon-"]{
    background:none;
  } 
```

像魅力一样工作:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-19T12:05:07.760

必须将此添加到我的 CSS

```
[class^="icon-"], [class*=" icon-"]{
    background:none!important;
}

.btn [class^="icon-"], .btn [class*=" icon-"] {
    line-height: 1.3em;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-16T20:42:34.573

嘿，我今天遇到了同样的问题，但我似乎通过在**font-awesome.css**和**bootstrap.css**下添加样式表修复来解决它，因为我不能在我的情况下使用 LESS。

```
<style type="text/css"> .icon {background:none;} </style> 
```

希望它可以帮助某人。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-12T12:57:17.597

当我写这个问题时，我想到从引导程序中删除 sprites.less 包括。固定并像魅力一样工作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-01T08:07:44.807

如果您使用 IE 6 或 7 JS 修复文件**lte-ie7.js**而不指定 if < IE 8，您也会得到双图标。

```
<!--[if lt IE 8]>
<script src="lte-ie7.js"></script>
<![endif]--> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-04T02:12:11.087

确保您使用的是没有图标部分的 Twitter Bootstrap css。

在这种情况下，字体会覆盖图像。

他们专门为这种情况提供了一个版本

如您所见，CSS 有 3 个主要版本：

*   完成：主+响应+图标
*   没有图标：主要 + 响应式
*   没有响应行为：主+图标

[关联](http://www.bootstrapcdn.com/#legacy_tab)

//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css

请注意清除您的浏览器现金以获取其他论坛或此论坛中发布的任何解决方案。删除精灵或添加更正将解决问题，但最好删除与图标有关的所有 css。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-08T07:36:16.387

对我来说，上述所有需要将 FA 图标的背景更改为 的解决方案都`none`不起作用。我使用的是由 javascript 插入的 Fontawesome 套件。

对我有用的解决方案是通过 javascript 插入将 Fontawesome 的实现更改为 css 样式表注入。

您可以使用 FontAwesome CDN 或您自己下载的 css：

```
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous"> 
```

# ember.js - Ember 数据多态关联

> ID：11452361
> 
> 赞同：13
> 
> 时间：2012-07-12T12:57:39.193
> 
> 标签：ember.js, ember-data

有没有人想出多态关联和余烬数据的答案？

我们需要某种方式来查询关系另一端的类型。

有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T09:25:25.430

使用最新的 ember-data 构建，您现在可以使用多态关联：

您需要配置模型以使其具有多态性：

```
/* polymorphic hasMany */
App.User = DS.Model.extend({
 messages: DS.hasMany(App.Message, {polymorphic: true})
});

App.Message = DS.Model.extend({
  created_at: DS.attr('date'),
  user: DS.belongsTo(App.User)
});

App.Post = App.Message.extend({
  title: DS.attr('string')
});

/* polymorphic belongsTo */
App.Comment = App.Message.extend({
  body: DS.attr('string'),
  message: DS.belongsTo(App.Message, {polymorphic: true})
}); 
```

您还需要`alias`在您的`RESTAdapter`

```
DS.RESTAdapter.configure('App.Post' {
  alias: 'post'
});
DS.RESTAdapter.configure('App.Comment' {
  alias: 'comment'
}); 
```

您的服务器预期的结果应该是这样的：

```
{
    user: {
        id: 3,
        // For a polymorphic hasMany
        messages: [
            {id: 1, type: "post"},
            {id: 1, type: "comment"}
        ]
    },

    comment: {
        id: 1,
        // For a polymorphic belongsTo
        message_id: 1,
        message_type: "post"
    }
} 
```

[此 github 线程](https://github.com/emberjs/data/pull/750)中的更多信息

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T20:46:14.653

所以我有东西。它还没有完成，也没有完全干净，但它可以工作。基本上，我使用 mixin 来完全绕过 Ember 关联。我确信这可以滚动到适配器或商店中，但现在这可行。

多态模型来自带有 itemId 和 itemType 的 JSON：

```
App.Follow = DS.Model.extend
  user: DS.belongsTo('App.User')
  itemId: DS.attr("number")
  itemType: DS.attr("string") 
```

我在与之关联的模型中添加了一个 mixin：

```
App.Hashtag = DS.Model.extend App.Polymorphicable,
  follows:(-> 
  name: DS.attr("string")
    @polymorphicFilter(App.Follow, "Hashtag")
  ).property('changeCount')  #changeCount gives us something to bind to

  followers: (->
    @get('follows').map((item)->item.get('user'))
  ).property('follows') 
```

mixin 实现了三种方法，一种是更新 changeCount，一种是返回模型的类型，一种是通过 itemType 和 id 过滤模型的 polymorphicFilter 方法：

```
App.Polymorphicable = Ember.Mixin.create
  changeCount: 1 

  polymorphicFilter: (model, itemType)->
    App.store.filter model, 
      (data) =>
        if data.get('itemId')
          @get('id') is data.get('itemId').toString() and data.get('itemType') is itemType 

  itemType:()->
    @constructor.toString().split('.')[1]

  updatePolymorphicRelationships:()->
    @incrementProperty('changeCount') 
```

除了必须调用 updatePolymorphicRelationship 以确保绑定触发之外，控制器层受到保护，不受所有这些 jankyness 的影响：

```
App.HashtagController = Ember.ObjectController.extend
  follow:()->
    App.Follow.createRecord({
      user: @get('currentUserController.content')
      itemId: @get('id')
      itemType: @get('content').itemType()
    })
    #this provides a way to bind and update. Could be refactored into a didSave()
    #callback on the polymorphic model.
    @get('content').updatePolymorphicRelationships()
    App.store.commit() 
```

这就是我到目前为止所拥有的。我试图将东西保留在模型层中，因为它只是从适配器层移除了一步。如果看起来 Ember Data 将来根本不会考虑多态，那么将这一切提升到更高的水平是有意义的，但就目前而言，这可行并且让我的控制器（相对）干净。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-06T17:04:46.070

ember 数据现在支持多态关联

[https://github.com/emberjs/data/commit/e4f7c3707217c6ccc0453deee9ecb34bd65c28b9](https://github.com/emberjs/data/commit/e4f7c3707217c6ccc0453deee9ecb34bd65c28b9)

# xml - 所有元素的 XPath，但我们只获取名称重复的元素中的第一个匹配项

> ID：11452367
> 
> 赞同：0
> 
> 时间：2012-07-12T12:58:02.923
> 
> 标签：xml, xpath, xquery, distinct, nodes

它应该返回所有第一次出现的具有相同名称的节点，即使子节点和属性不同。

例如

```
<Data>
  <A>
    <X randomattr="1"/>
    <Y randomattr="1"/>
    <Z/>
  </A>
  <B>
    <X/>
    <X randomattr="3"/>
    <Z/>
  </B>
</Data> 
```

它应该返回 3 个节点，第一个是 X、Y 和 Z，因为下面的节点将有一个重复的名称。如果 X 元素之一没有 randomattr 或者另一个元素具有不同的值，请不要介意。

我不想要 name() 中的不同值，我想返回整个节点。就像是

```
/Data/*/*[distinct-values(name())] 
```

我也知道我可以用双循环遍历所有节点，但我问自己是否有一个简单的单行或函数，或者像 distinct[1] 这样的特殊 Xpath 语法谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:10:52.360

我想这就是你可能正在寻找的。使用了一些简单的测试：

*   (Xpath 2.0)`/Data/*/*[not((preceding-sibling::*/name(.)=name(.)) or (../preceding-sibling::*/*/name(.)=name(.)))]`
*   (Xpath 1.0)`/Data/*/*[not((name(preceding-sibling::*)=name(.)) or (name(../preceding-sibling::*/*)=name(.)))]`

在请求使其工作到任何深度之后......我不熟悉您的架构，但从示例中我假设您正在寻找的节点是底层节点。以下使用后代轴在进行名称检查时搜索没有子节点的节点。

*   `/Data/descendant::*[not(name() = preceding::*[not(child::*)]/name())][not(child::*)]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T09:37:11.440

我会接受 alwaysWrong 的问题，但我从他那里学到的东西和我刚刚学到的 AXES 东西研究后回答了另一种可能性。

```
/Data/*/*[not(name() = preceding::*[name(../..)='Data']/name())] 
```

（First name() 也可以是 self::*/name() 以下语法）

对于任何情况，这将是我认为更容易和最好的路线，因为当叶级别很深时，它不会以指数方式增长。只需更改先例的条件以匹配“从根”同级，例如 [name(../..)='Data'] 或定义此层次结构级别的所有节点的条件，或者如果它们共享，则为前面的::name_node相同的qname

# node.js - 翡翠动态数据

> ID：11452371
> 
> 赞同：2
> 
> 时间：2012-07-12T12:58:10.243
> 
> 标签：node.js, pug, string-interpolation

使用 node.js 我将一些变量传递给玉视图：

```
res.render('index', {
        locals: { 
                      name: user.name, 
                      hashpassword: JSON.stringify(user.hashPass), 
                      languages: JSON.stringify(langs)}
                }); 
```

在玉文件中，我有：

```
body
    #heading
      h1 nodechat
      label !{locals.languages} // working - printing whole json string
    #content
      - var laangs = !{locals.languages} //not working here!
                   //SyntaxError: Unexpected token .

      - each item in laangs
        label= item.EnglishName 
```

问题是我无法将 locals.languages 传递给玉文件中的变量。如果我将它分配给单个 html 元素（如标签），它可以工作，但是当我尝试使用***var =***时，它不起作用。

可能是什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T13:01:55.447

请参阅下面的更改...

```
body
    #heading
      h1 nodechat
      label !{locals.languages} // working - printing whole json string
    #content
      //- Do it like this...You're already in JavaScript land after the -
      - var laangs = locals.languages
      - each item in laangs
        label= item.EnglishName 
```

**将!{locals.languages}**更改为**locals.languages**

# java - 通过套接字发送大文件

> ID：11452373
> 
> 赞同：1
> 
> 时间：2012-07-12T12:58:21.133
> 
> 标签：java

我在套接字文件发送器上工作，它工作得很好，但我不能用它发送大文件。总是出现堆错误。然后我改变了客户端的代码，所以它会分块发送文件。现在我可以发送大文件，但出现了新问题。现在我收到了空的小文件和较大的文件，例如无法播放视频。这是发送文件的客户端代码：

```
public void send(File file) throws UnknownHostException, IOException {

    // Create socket
    hostIP = "localhost";
    socket = new Socket(hostIP, 22333);

    //Send file

    FileInputStream fis = new FileInputStream(file);
    BufferedInputStream bis = new BufferedInputStream(fis);

    DataInputStream dis = new DataInputStream(bis);

    OutputStream os = socket.getOutputStream();

    //Sending size of file.
    DataOutputStream dos = new DataOutputStream(os);
    dos.writeUTF(file.getName() + ":" + userName);

    byte[] arr = new byte[1024];
    try {
        int len = 0;
        while ((len = dis.read(arr)) != -1) {
            dos.write(arr, 0, len);

        }
    } catch (IOException ex) {
        ex.printStackTrace();
    }

    dos.flush();

    socket.close();
} 
```

这是服务器代码：

```
void start() throws IOException {

        // Starts server on port.
        serverSocket = new ServerSocket(port);

        int bytesRead;

        while (true) {
            connection = serverSocket.accept();

            in = connection.getInputStream();

            clientData = new DataInputStream(in);

            String[] data = clientData.readUTF().split(":");
            String fileName = data[0];
            String userName = data[1];

            output = new FileOutputStream("C:/" + fileName);
            long size = clientData.readLong();
            byte[] buffer = new byte[1024];

            // Build new file
            while (size > 0 && (bytesRead = clientData.read(buffer, 0, (int) Math.min(buffer.length, size))) != -1) {
                output.write(buffer, 0, bytesRead);
                size -= bytesRead;
            }
            output.close();
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:09:21.700

您未能将文件的长度写入客户端中的流：

```
long size = clientData.readLong(); 
```

所以服务器中的调用正在读取实际文件的前 8 个字节，谁知道这个数量是多少。您不必从流中读取长度，因为您只编写了一个文件。在读取文件名和用户名（不是很安全吗？）之后，您可以读取流直到 EOF。如果您想通过同一个打开的套接字发送多个文件，那么您需要在读取文件之前知道长度。

您的阅读缓冲区也很小。您应该至少为 8192 而不是 1024。并且您需要将所有 .close() 放在 finally 块中，以确保您的服务器和客户端在出现异常时正确关闭。

# model-view-controller - ExtJs4 将 treeStore 级别映射到 Store

> ID：11452374
> 
> 赞同：0
> 
> 时间：2012-07-12T12:58:22.823
> 
> 标签：model-view-controller, extjs, grid, extjs4, store

将树存储的级别映射到平面存储的好方法是什么。就我而言，

我想对搜索条件进行分组。所有搜索条件都插入到 treeStore 的顶层，除非它们被分组，在这种情况下它们成为顶层逻辑（AND 或 OR）节点的子节点。因此，在网格中，我想显示顶级节点（通过我将在模型中定义的一些 toString 方法）。这是最简单的部分，我只需遍历树的顶层并为 Store/grid 生成输出。但是，当我想从网格/存储中删除某些内容时，还需要从代表实际逻辑结构的树存储中删除它。

那么，如何跟踪哪个文本存储项对应于我的 treeStore 中的哪个顶级节点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:49:14.200

将数据加载到 store 或 treegrid（但不能同时加载），然后从一个对象收集记录并将它们添加到另一个对象（使用 store.add() 或 treestore.getRootNode().appendChild()）。此时如果你有对记录的引用，你可以说 store.remove([record]); 然后 treestore.getRootNode().removeChild(record); 从两者中删除它。

# ruby-on-rails - 警告：Nokogiri 是针对 LibXML 版本 2.7.3 构建的，但已动态加载 2.7.8

> ID：11452380
> 
> 赞同：18
> 
> 时间：2012-07-12T12:58:45.537
> 
> 标签：ruby-on-rails, nokogiri, osx-mountain-lion

全新安装 Mac OS X 10.8 Mountain Lion 并安装 Ruby 1.9.3 和 Ruby on Rails 3.2.6 后，我启动 Rails 控制台并收到以下警告消息：

> 警告：Nokogiri 是针对 LibXML 版本 2.7.3 构建的，但已动态加载 2.7.8

我该如何解决？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-12T12:58:46.113

我找到了一些针对 Lion 的修复程序，但还没有针对 Mountain Lion 的修复程序。尽管如此，我已经尝试过这个并且它有效：

```
gem uninstall nokogiri libxml-ruby

brew update
brew uninstall libxml2
brew install libxml2 --with-xml2-config
brew link libxml2

brew install libxslt
brew link libxslt

gem install nokogiri -- --with-xml2-include=/usr/local/Cellar/libxml2/2.8.0/include/libxml2/ --with-xml2-lib=/usr/local/Cellar/libxml2/2.8.0/lib/ --with-xslt-dir=/usr/local/Cellar/libxslt/1.1.26/ 
```

来源（狮子）：[https ://gist.github.com/1349681](https://gist.github.com/1349681)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-26T01:44:15.933

我重新安装了Ruby，修复了它。能够使用内置库。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-11-29T17:51:44.640

```
gem uninstall nokogiri
bundle install 
```

更好：

```
gem pristine nokogiri 
```

笔记：

当您升级系统和库更改时，这种情况会反复发生。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-07T05:34:11.490

请注意，@Davids 帖子中的链接会干扰您的构建工具并链接到您的操作系统（如果您使用的是 brew，这很可能不是您想要的），但是您可以只执行上面的每个命令，*除了*省略 'brew 链接' 行，一切仍然会很好，例如：

```
gem uninstall nokogiri libxml-ruby
brew update
brew uninstall libxml2
brew install libxml2 --with-xml2-config
brew install libxslt

gem install nokogiri -- --with-xml2-include=/usr/local/Cellar/libxml2/2.8.0/include/libxml2/ --with-xml2-lib=/usr/local/Cellar/libxml2/2.8.0/lib/ --with-xslt-dir=/usr/local/Cellar/libxslt/1.1.26/ 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-19T05:29:20.837

把`gem 'nokogiri'`上面`gem 'pg'`放在我的 Gemfile 中为我解决了这个问题。

我的 Gemfile 中没有 nokogiri，但它是 Gemfile.lock 中的一个依赖项，所以我明确地将它放在我的 Gemfile 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-23T11:30:11.927

根据@David 的回答，以下步骤对我来说已经足够了。没有编译器标志和自定义路径。

```
gem uninstall nokogiri

brew update
brew install libxml2
brew update libxml2
brew link libxml2

gem install nokogiri 
```

# android - 谷歌地图如何在安卓设备上获取位置？

> ID：11452384
> 
> 赞同：3
> 
> 时间：2012-07-12T12:58:59.427
> 
> 标签：android, google-maps, locationmanager, location-aware

我是一名 android 开发人员，并且一直在使用它来开发上下文感知应用程序。位置是上下文感知最重要的事情之一，该位置的准确性非常重要。

我知道如何使用 LocationManager 从 GPS 获取位置...我知道如何在 Android 上使用 Google 地图开发应用程序...以及如何在地图上显示用户...等等。但是我的朋友们在他们去的时候发现了这一点到国外参加会议，与谷歌地图相比，他们从 LocationManager 获得的位置非常不准确。

他们使用了我的应用程序（尚未发布..），我从 LocationManager 获取了我的位置，并注册了 GPS 和网络提供商。如果我在地图上标出手机给我的位置......这是非常不准确的......有时它认为用户在巴塞罗那，即使他们正在美国参加会议。

此外，由于会议是在室内举行的，因此 GPS 不会有太大帮助，因为它很难找到解决办法。

android 上的 google 地图是否获得类似于 google 告诉 android 开发人员从 LocationManager 获取位置并注册 onLocationChanged 位置侦听器的位置？如果确实如此……他们的结果如何更准确……他们如何过滤任何异常值？或者他们是否使用任何内部服务来获得更准确的位置，也许谷歌认为如果开发人员获得了准确的位置，他们可能会滥用它？

有什么想法或意见吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T15:47:20.433

此代码由 Android 开发者关系技术主管 Reto Meier 编写，他撰写了有关 Android 应用程序开发的书。另外，我记得那是在 2011 年的 Google IO 会议上发表的。这是最接近 Google Places 中使用的内容。无论如何它都很聪明;) [https://code.google.com/p/android-protips-location/](https://code.google.com/p/android-protips-location/)

# java - Hibernate 映射一对多关系：Parent's PK to Child's FK

> ID：11452388
> 
> 赞同：2
> 
> 时间：2012-07-12T12:59:08.807
> 
> 标签：java, hibernate, hibernate-mapping

我有一个经典的一对多关系，在使用 Hibernate 保存它时，我无法将父级的 PK 列值传递给子级的 FK 列。
**家长班**

```
@Id
@GeneratedValue(strategy=GenerationType.AUTO)
private int holdingPK;

@OneToMany(mappedBy="holding",targetEntity=PolicyType.class,fetch=FetchType.LAZY, cascade = CascadeType.ALL)
@XmlElement(name = "Policy")
private Set<PolicyType> policy; 
```

**儿童班**

```
@Id
@GeneratedValue(strategy=GenerationType.AUTO)
private int policyPK;

@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name="HoldingFK",nullable = false)
private HoldingType holding; 
```

这`HoldingPK`是一个自动生成的表示主键的序列列。当我插入一个 Holding 行时会生成值。所以我想动态地将 HoldingPK 值传递给孩子的`HoldingFK`列。
**测试代码**

```
HoldingType obj = new HoldingType();
obj.setCurrencyTypeCode("6");
obj.setHoldingKey("123");
Set<PolicyType> set = new TreeSet<PolicyType>();
PolicyType policy = new PolicyType();
policy.setJurisdiction("Haha");
set.add(policy);
obj.setPolicy(set);
session.save(obj);
transaction.commit(); 
```

所以我可以将 Child 的其他值传递给 Child Table 列，只是 Parent PK 没有到达 Child 的 FK 列。

在这里，我将 XML 文档值保存到数据库中。为此，我使用 JAXB 将 XML 编组为 Java 对象，然后使用 Hibernate 持久化对象。通过这种方式，我使用 Hibernate 重用 JAXB 生成的类，这些 PK 和 FK 元素在 XML 上不存在。这些是特定于数据库的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:57:07.110

您只是忘记初始化双向关联的拥有方。您只初始化了反面（具有`mappedBy`属性的一面）。Hibernate 只考虑拥有方知道关联是否存在（没有`mappedBy`属性的一方）。

将此添加到您的代码中（在保存保存之前）：

```
policy.setHolding(obj); 
```

旁注：如果您命名`policy`字段（和访问器），您的代码将更具可读性`policies`。它们有很多，所以它应该有复数形式。

# xquery - 将文件从一个目录移动到另一个目录

> ID：11452395
> 
> 赞同：0
> 
> 时间：2012-07-12T12:59:50.263
> 
> 标签：xquery, marklogic

我可以在 xquery 中将文件从一个目录物理移动到另一个目录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T23:08:54.783

不，没有 MarkLogic 功能可以从文件系统中删除文件。您可以做的最接近的是`xdmp:save`空文本或二进制文件，覆盖任何现有文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:34:15.950

我假设您的意思是文档（而不是文件）。

MarkLogic 使用[MVCC](http://en.wikipedia.org/wiki/Multiversion_concurrency_control)。您必须复制和删除 - 如果您要“移动”的文档数量不大，您可以在单个事务中执行此操作。

# android - 彩带安卓解决方案

> ID：11452396
> 
> 赞同：1
> 
> 时间：2012-07-12T12:59:50.740
> 
> 标签：android, eclipse, image, artifact, dithering

Android Activity 或 OpenGL 中带状图像的可能解决方案是什么。

看看下面的答案。

希望能帮助到你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:59:52.863

色带解决了ooooooooooyyyyyyyeaaaaaaaaaa

我分两个阶段解决了色带问题

1) * 当我们使用 BitmapFactory 解码资源时，它会解码显示色带的 RGB565 资源，而不是使用 ARGB_8888，所以我使用 BitmapFactory.Options 将解码选项设置为 ARGB_8888

第二个问题是，每当我缩放位图时，它再次被带状

2）这是最困难的部分，经过大量搜索终于奏效*用于缩放位图的方法 Bitmap.createScaledBitmap 在缩放后也将图像缩小为 RGB565 格式，我得到了带状图像（解决这个问题的旧方法是使用至少一个png 中的透明像素，但没有像 jpg 或 bmp 这样的其他格式起作用）所以在这里我创建了一个方法 CreateScaledBitmap 来使用生成的缩放位图中的原始位图配置来缩放位图（实际上我从 logicnet.dk 的帖子中复制了该方法和翻译成java)

```
 BitmapFactory.Options myOptions = new BitmapFactory.Options();
    myOptions.inDither = true;
    myOptions.inScaled = false;
    myOptions.inPreferredConfig = Bitmap.Config.ARGB_8888;//important
    //myOptions.inDither = false;
    myOptions.inPurgeable = true;
    Bitmap tempImage =  
    BitmapFactory.decodeResource(getResources(),R.drawable.defaultart, myOptions);//important

    //this is important part new scale method created by someone else
    tempImage = CreateScaledBitmap(tempImage,300,300,false);

    ImageView v = (ImageView)findViewById(R.id.imageView1);
    v.setImageBitmap(tempImage); 
```

// 功能

```
public static Bitmap CreateScaledBitmap(Bitmap src, int dstWidth, int dstHeight, boolean filter)
{
    Matrix m = new Matrix();
    m.setScale(dstWidth  / (float)src.getWidth(), dstHeight / (float)src.getHeight());
    Bitmap result = Bitmap.createBitmap(dstWidth, dstHeight, src.getConfig());
    Canvas canvas = new Canvas(result);
    //using (var canvas = new Canvas(result))
    {
        Paint paint = new Paint();
        paint.setFilterBitmap(filter);
        canvas.drawBitmap(src, m, paint);
    }
    return result;

} 
```

如果我错了，请纠正我。如果它对你有用，也可以评论。

## 我很高兴我解决了它，希望它对大家有用。

对于 OpenGL，您只需绑定应用上层函数后创建的位图

# android - 信号 11 (SIGSEGV)，使用 Bump API 时 android 中的故障地址

> ID：11452398
> 
> 赞同：2
> 
> 时间：2012-07-12T12:59:54.950
> 
> 标签：android, android-service, bump

我正在尝试开发一个使用凹凸 API 的应用程序。第一次一切正常。不知何故，如果我按下主页按钮并返回应用程序，它会毫无例外地崩溃（有时它可以正常工作 2 或 3 次）。当我检查 logcat 时，我得到了以下堆栈跟踪：

```
16:33:18.915: I/DEBUG(31): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
07-11 16:33:18.915: I/DEBUG(31): Build fingerprint: 'generic/sdk/generic/:2.2/FRF91/43546:eng/test-keys'
07-11 16:33:18.915: I/DEBUG(31): pid: 280, tid: 338  >>> dig.app.com <<<
07-11 16:33:18.915: I/DEBUG(31): signal 11 (SIGSEGV), fault addr 4897c000
07-11 16:33:18.915: I/DEBUG(31):  r0 4897bfe0  r1 4897bfe8  r2 ffecb094  r3 00000000
07-11 16:33:18.915: I/DEBUG(31):  r4 00000000  r5 00000000  r6 00000000  r7 00000000
07-11 16:33:18.915: I/DEBUG(31):  r8 00000000  r9 00000000  10 00000000  fp 00000000
07-11 16:33:18.915: I/DEBUG(31):  ip 00000000  sp 480cadf8  lr 00000010  pc afd0f234  cpsr a0000010
07-11 16:33:19.025: I/DEBUG(31):          #00  pc 0000f234  /system/lib/libc.so
07-11 16:33:19.061: W/dalvikvm(280): JNI WARNING: native code passing in bad object 0x4003fc78 0x4003fc78 (Check_SetFloatField)
07-11 16:33:19.061: W/dalvikvm(280):              in Landroid/graphics
/Path;.native_computeBounds (ILandroid/graphics/RectF;)V (SetFloatField)
07-11 16:33:19.061: I/dalvikvm(280): "main" prio=5 tid=1 RUNNABLE
07-11 16:33:19.061: I/dalvikvm(280):   | group="main" sCount=0 dsCount=0 s=N obj=0x4001d8e0 self=0xccb0
07-11 16:33:19.061: I/dalvikvm(280):   | sysTid=280 nice=0 sched=0/0 cgrp=default handle=-1345026008
07-11 16:33:19.061: I/dalvikvm(280):   | schedstat=( 955496474453 102439081045 208084 )
07-11 16:33:19.061: I/dalvikvm(280):   at android.graphics.Path.native_computeBounds(Native Method)
07-11 16:33:19.135: I/DEBUG(31):          #01  pc 00051e22  /data/data/dig.app.com/lib/libandroid-api.so
07-11 16:33:19.135: I/DEBUG(31):          #02  pc 0005401a  /data/data/dig.app.com/lib/libandroid-api.so
07-11 16:33:19.135: I/DEBUG(31):          #03  pc 0005609e  /data/data/dig.app.com/lib/libandroid-api.so
07-11 16:33:19.135: I/DEBUG(31):          #04  pc 000512fe  /data/data/dig.app.com/lib/libandroid-api.so
07-11 16:33:19.135: I/DEBUG(31):          #05  pc 0001103c  /system/lib/libc.so
07-11 16:33:19.135: I/DEBUG(31):          #06  pc 00010b20  /system/lib/libc.so
07-11 16:33:19.135: I/DEBUG(31): code around pc:
07-11 16:33:19.135: I/DEBUG(31): afd0f214 e2522020 3a00004d e35c0018 0a000033 
07-11 16:33:19.135: I/DEBUG(31): afd0f224 e35c0008 0a000018 e491c004 e1a0400c 
07-11 16:33:19.135: I/DEBUG(31): afd0f234 e8b10fe0 f5d1f040 e2522020 2491c004 
07-11 16:33:19.135: I/DEBUG(31): afd0f244 e1833804 e1a04824 e1844805 e1a05825 
07-11 16:33:19.135: I/DEBUG(31): afd0f254 e1855806 e1a06826 e1866807 e1a07827 
07-11 16:33:19.145: I/DEBUG(31): code around lr:
07-11 16:33:19.145: I/DEBUG(31): stack:
07-11 16:33:19.145: I/DEBUG(31):     480cadb8  00000000  
07-11 16:33:19.145: I/DEBUG(31):     480cadbc  005cc628  [heap]
07-11 16:33:19.145: I/DEBUG(31):     480cadc0  00000000  
07-11 16:33:19.145: I/DEBUG(31):     480cadc4  afd103f0  /system/lib/libc.so
07-11 16:33:19.145: I/DEBUG(31):     480cadc8  00000003  
07-11 16:33:19.145: I/DEBUG(31):     480cadcc  afd41724  /system/lib/libc.so
07-11 16:33:19.145: I/DEBUG(31):     480cadd0  00562878  [heap]
07-11 16:33:19.145: I/DEBUG(31):     480cadd4  c0000000  
07-11 16:33:19.145: I/DEBUG(31):     480cadd8  0007d0c4  [heap]
07-11 16:33:19.145: I/DEBUG(31):     480caddc  0007d0c0  [heap]
07-11 16:33:19.145: I/DEBUG(31):     480cade0  488470a1  
07-11 16:33:19.145: I/DEBUG(31):     480cade4  afd0c741  /system/lib/libc.so
07-11 16:33:19.145: I/DEBUG(31):     480cade8  80a7cdd9  /data/data/dig.app.com/lib/libandroid-api.so
07-11 16:33:19.145: I/DEBUG(31):     480cadec  005cc5e0  [heap]
07-11 16:33:19.145: I/DEBUG(31):     480cadf0  df002777  
07-11 16:33:19.145: I/DEBUG(31):     480cadf4  e3a070ad  
07-11 16:33:19.145: I/DEBUG(31): #00 480cadf8  fffffffe  
07-11 16:33:19.145: I/DEBUG(31):     480cadfc  48847099  
07-11 16:33:19.145: I/DEBUG(31):     480cae00  480cae4c  
07-11 16:33:19.145: I/DEBUG(31):     480cae04  0007d0c4  [heap]
07-11 16:33:19.155: I/DEBUG(31):     480cae08  0007d0c0  [heap]
07-11 16:33:19.155: I/DEBUG(31):     480cae0c  488470a1  
07-11 16:33:19.155: I/DEBUG(31):     480cae10  00000002  
07-11 16:33:19.155: I/DEBUG(31):     480cae14  48847098  
07-11 16:33:19.155: I/DEBUG(31):     480cae18  48847008  
07-11 16:33:19.155: I/DEBUG(31):     480cae1c  80a51e25  /data/data/dig.app.com/lib/libandroid-api.so
07-11 16:33:19.155: I/DEBUG(31): #01 480cae20  00000000  
07-11 16:33:19.155: I/DEBUG(31):     480cae24  480cae4c 
```

Bump API 作为本机库包含在我的应用程序中 ( `libandroid-api.so`)。为了连接到凹凸服务器，我正在使用服务，并且在`onStop`（当我按下主页按钮时）我正在**取消绑定**服务并且在`onStart`（当从后台恢复时）我将**绑定**服务。因此，如果我继续此 UnBinding 和 Binding 2 或 3 次，我会收到此错误。

我已经对这个信号 11 (SIGSEGV)、故障地址进行了一些搜索，并发现它是在应用程序进行无效内存引用时发生的。我无权访问这个本机库。我不知道该怎么办。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:19:06.163

我有同样的问题，事实是第一次`api.configure`工作正常，下一次尝试只是让应用程序崩溃。

我在这里发布了我认为同样的问题：[Bump API Android crash](https://stackoverflow.com/questions/11411169/bump-api-android-crash)

我自己解决了这个问题，我围绕凹凸 api 构建了一个单例，所以我确保该 api 只配置一次，然后只在配置后返回。你会在我的问题中找到代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T22:46:10.490

每个应用程序在单例上运行时，您应该只调用一次配置。

# url - URL重写不起作用

> ID：11452402
> 
> 赞同：0
> 
> 时间：2012-07-12T13:00:18.127
> 
> 标签：url, mod-rewrite, url-rewriting, rewrite

你能告诉我为什么这个重写没有通过第二个值吗？tt 值已传入 %1，但名称不在 %2 中

```
RewriteBase /
RewriteRule ^wedding-hair-and-make-up-images-([^/]*)-(.*)\.php$ franchisee-gallery.php?franchise_name=$1&id_tt=$2 [L]
RewriteCond %{THE_REQUEST} ^(GET|POST|HEAD|TRACE)\ /franchisee-gallery.php
RewriteCond %{QUERY_STRING} name=([^\&]*) 
RewriteCond %{QUERY_STRING} tt=(.*) 
RewriteRule ^franchisee-gallery.php$ wedding-hair-and-make-up-images-%1-%2.php? [R,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:41:32.407

%N 指的是最后一个条件的匹配组，所以 %1​​ 是条件的匹配： RewriteCond %{QUERY_STRING} tt=(.*)

[http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#RewriteCond](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#RewriteCond)

**RewriteCond 反向引用：这些是 %N (1 <= N <= 9) 形式的反向引用，它提供从当前条件集中最后匹配的 RewriteCond 访问模式的分组部分（同样，在括号中）。**

对于您的情况，您可以将“franchisee-gallery.php”的访问权限重写为另一个 PHP，从而进行重定向（通过 HTTP Header *Location*）。我不知道如何通过 Rewrite 做到这一点。也许使用 PERL 外部重写程序，使用 RewriteMap。

* * *

解决方案成立！使用自定义环境变量，可以将匹配的值存储在临时变量中！

```
RewriteEngine on
RewriteBase /
RewriteRule ^wedding-hair-and-make-up-images-([^/]*)-(.*)\.php$ franchisee-gallery.php?franchise_name=$1&id_tt=$2 [L]

RewriteCond %{REQUEST_URI} ^/franchisee-gallery.php
RewriteCond %{QUERY_STRING} name=([^&]*)
RewriteRule .* - [E=name:%1]

RewriteCond %{REQUEST_URI} ^/franchisee-gallery.php
RewriteCond %{QUERY_STRING} tt=([^&]*)
RewriteRule .* - [E=tt:%1]

RewriteCond %{THE_REQUEST} ^(GET|POST|HEAD|TRACE)\ /franchisee-gallery.php
RewriteRule ^franchisee-gallery.php$ wedding-hair-and-make-up-images-%{ENV:name}-%{ENV:tt}.php? [R,L] 
```

# usertype - 如何在实体和 org.hibernate.usertype.UserType 之间创建多对多关系

> ID：11452405
> 
> 赞同：1
> 
> 时间：2012-07-12T13:00:22.647
> 
> 标签：usertype

我有一个这样的实体：

```
 @Entity
    @Table(name = "PLATFORM")
    public class Platform{

        @Id
        @Column(name = "PLATFORM_ID")
        @GeneratedValue(strategy = GenerationType.AUTO)
        private Integer platformId;

        @ManyToOne(fetch=FetchType.EAGER)
        @JoinColumn(name="PLATFORM_TYPE_ID")
        private PlatformType platformType;

        //must be manytomany but how?
        private List<MimeType> supportedMimeTypes;
        ... 
```

我有一个 MimeType 类，它确实是一个 org.hibernate.usertype.UserType。

```
import java.sql.Types;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

public class MimeType extends EnumarationType{
    private static final long serialVersionUID = 1L;

    public static final MimeType XML = new MimeType(new Integer(0), "XML");
    public static final MimeType JSON = new MimeType(new Integer(1), "JSON");

    protected static ArrayList<MimeType> list = new ArrayList<MimeType>();

    static {
        SQL_TYPES = new int[] { Types.INTEGER };
        list.add(XML);
        list.add(JSON);
    }

    public MimeType(){      
    }

    public MimeType(Integer value, String label) {
        super(value, label);
    }

    public List<?> getList() {
        return list;
    }

    public static MimeType getById(int id) {
        Iterator<MimeType> it = list.iterator();
        while (it.hasNext()) {
            MimeType status = it.next();
            int statusId = Integer.parseInt(status.getValue());
            if (statusId == id)
                return status;
        }
        return null;
    }

    public static MimeType getByName(String name) {
        Iterator<MimeType> it = list.iterator();
        while (it.hasNext()) {
            MimeType status = it.next();
            String statusName = status.getLabel();
            if (statusName.equalsIgnoreCase(name))
                return status;
        }
        return null;
    }
}

import java.io.Serializable;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Types;
import java.util.Iterator;
import java.util.List;

import org.hibernate.HibernateException;
import org.hibernate.usertype.UserType;

public abstract class EnumarationTypeBase implements UserType, Serializable {

    protected static int[] SQL_TYPES = { Types.VARCHAR };

    protected String label;

    protected Object value;

    protected String resourceKey;

    public EnumarationTypeBase() {
    }

    public String getLabel() {
        return label;
    }

    public void setLabel(String label) {
        this.label = label;
    }

    public abstract List<?> getList();

    private Object getValue() {
        return value;
    }

    public void setValue(Object value) {
        this.value = value;
    }

    public EnumarationTypeBase resolveFromValue(Object value) {
        List<?> list = getList();

        if (list == null)
            return null;

        EnumarationTypeBase result = null;
        for (Iterator<?> itr = list.iterator(); itr.hasNext();) {
            EnumarationTypeBase enm = (EnumarationTypeBase) itr.next();
            if (enm.getValue().toString().equals(value.toString())) {
                result = enm;
                break;
            }
        }

        return result;
    }

    public EnumarationTypeBase resolveFromLabel(Object label) {
        List<?> list = getList();

        if (list == null)
            return null;

        EnumarationTypeBase result = null;
        for (Iterator<?> itr = list.iterator(); itr.hasNext();) {
            EnumarationTypeBase enm = (EnumarationTypeBase) itr.next();
            if (enm.getLabel().equals(label.toString())) {
                result = enm;
                break;
            }
        }

        return result;
    }

    public String toString() {
        return getLabel();
    }

    public int[] sqlTypes() {
        return SQL_TYPES;
    }

    public Class<?> returnedClass() {
        return getClass();
    }

    public Object nullSafeGet(ResultSet resultSet, String[] names, Object owner) throws HibernateException,
            SQLException {

        value = resultSet.getString(names[0]);

        return resultSet.wasNull() ? null : resolveFromValue(value);
    }

    public void nullSafeSet(PreparedStatement statement, Object value, int index) throws HibernateException,
            SQLException {
        EnumarationTypeBase enumType = (EnumarationTypeBase) value;
        if (value == null) {
            statement.setNull(index, sqlTypes()[0]);
        } else {
            statement.setString(index, enumType.getValue().toString());
        }
    }

    public boolean equals(Object x, Object y) {
        if (x == y)
            return true;
        if (null == x || null == y)
            return false;
        return x.equals(y);
    }

    public boolean equals(Object obj) {
        if (obj instanceof EnumarationTypeBase)
            return this.getValue().equals(((EnumarationTypeBase) obj).getValue());

        return super.equals(obj);
    }

    public Object assemble(Serializable cached, Object owner) throws HibernateException {
        return cached;
    }

    public Serializable disassemble(Object value) throws HibernateException {
        return (Serializable) value;
    }

    public Object replace(Object original, Object target, Object owner) throws HibernateException {
        return original;
    }

    public Object deepCopy(Object value) {
        return value;
    }

    public boolean isMutable() {
        return false;
    }

    public int hashCode(Object x) throws HibernateException {
        return x.hashCode();
    }

    public int hashCode() {
        return (new Integer(this.getValue().toString())).intValue();
    }

    public String getResourceKey() {
        if (resourceKey == null)
            resourceKey = resolveFromValue(this.value).resourceKey;
        return resourceKey;
    }

    public void setResourceKey(String resourceKey) {
        this.resourceKey = resourceKey;
    }
}

public abstract class EnumarationType extends EnumarationTypeBase {

    protected static int[] SQL_TYPES = { Types.VARCHAR };

    public EnumarationType() {
    }

    public EnumarationType(Integer value, String label) {
        this.value = value.toString();
        this.label = label;
    }

    public EnumarationType(String value, String label) {
        this.value = value.toString();
        this.label = label;
    }

    public EnumarationType(Integer value, String label, String resourceKey) {
        this.value = value.toString();
        this.label = label;
        this.resourceKey = resourceKey;
    }

    public String getValue() {
        return (String) value;
    }

    public BigDecimal getBigDecimalValue() {
        BigDecimal tValue = new BigDecimal(getValue());
        return tValue;
    }

    public void setValue(String value) {
        this.value = value;
    }

} 
```

那么我如何定义实体平台和非实体用户类型 MimeType 之间的多对多关系。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:37:18.117

我解决了这个问题。这是工作代码

```
...  

    @ElementCollection(targetClass = MimeType.class,fetch=FetchType.EAGER) 
    @CollectionTable(name = "PLATFORM_MIME_TYPE", joinColumns = @JoinColumn(name = "PLATFORM_ID"))
    @Enumerated(EnumType.ORDINAL)
    @Column(name = "MIME_TYPE_ID", columnDefinition="integer")
    @Type(
            type = Constants.ENUMERATION_TYPE,
            parameters = {
                    @Parameter(
                        name  = "enumClass",                     
                        value = "com.ba.reme.model.enums.MimeType"),
                    @Parameter(
                        name  = "identifierMethod",
                        value = "toInt"),
                    @Parameter(
                        name  = "valueOfMethod",
                        value = "fromInt")
                    }
        )
    private Set<MimeType> supportedMimeTypes;

    ... 
```

和 MimeType 枚举：

```
public enum MimeType {
    XML(1), 
    JSON(2),
    RSS(3);

    private int value;

    MimeType(int value) {
        this.value = value;
    }

    // the identifierMethod
    public int toInt() {
      return value;
    }

     // the valueOfMethod
     public  static MimeType fromInt(int value) {   
         switch(value) {
             case 2: return JSON;
             case 3: return RSS;
             default: return XML;
         }
    }

    public String toString() {
      switch(this) {
        case RSS: return "rss";
        case JSON: return "json";
        default: return "xml";
      }
    }

} 
```

# ruby-on-rails - Rails 模型验证是否优先？

> ID：11452406
> 
> 赞同：2
> 
> 时间：2012-07-12T13:00:23.190
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

在一个模型中，我有以下验证：

```
validates_presence_of :company_name, :message => "Must have a company name"
validates_uniqueness_of :company_name, :message => "Does this company exist? As this company name isn't unique." 
```

这是否意味着它会在唯一性之前检查公司名称的存在？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:12:20.517

来自 rails 指南：“验证将按照注册时的顺序运行。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:07:08.203

是的，检查将按顺序进行

您可以通过以下方式进行检查：

```
if obj.errors.on(:company_name)
    errMsg << obj.errors.on(:company_name)[0]
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:07:46.510

是的，它会首先检查存在。它按顺序运行验证

# php - 通过 PHP 连接 SOQL 数据库

> ID：11452408
> 
> 赞同：1
> 
> 时间：2012-07-12T13:00:33.190
> 
> 标签：php, database, connect, soql

我对 php 和数据库非常陌生。突然间，我接到了这个社区服务项目，他们希望我连接到 SOQL 数据库，检索数据并将其显示在页面上。

作为一个完整的新手，我在谷歌中搜索了如何连接到 soql 数据库，但无济于事。我知道对于 mysql，我可以通过运行建立链接/连接`mysql_connect(host, user, password)`；在一个 php.ini 文件中。有没有办法做类似的事情`SOQL`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:11:05.007

抱歉，您无法通过 PHP 连接到 SOQL 数据库。

但是，您可以使用 JavaScript 执行此操作，然后使用 ajax 接收基于数据库的 PHP 输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-09T09:12:34.043

Salesforce 提供 Web 服务 API(REST) 来连接其生态系统。

[https://developer.salesforce.com/docs/api-explorer/sobject](https://developer.salesforce.com/docs/api-explorer/sobject)

# java - 我们有m2e时是否需要安装Maven？

> ID：11452409
> 
> 赞同：8
> 
> 时间：2012-07-12T13:00:35.170
> 
> 标签：java, eclipse, maven, eclipse-plugin, m2e

我已经通过 Eclipse 市场安装`m2e`在我的*Eclipse Indigo中。*

我需要`maven`显式安装并设置`M2_HOME`环境变量吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-12T13:03:04.607

没有也没有。m2e 有一个嵌入式 Maven，但您不必使用它。

有关更多详细信息，请参阅[常见问题解答](http://wiki.eclipse.org/M2E_FAQ#What_Maven_version_is_used_by_plugin)，它称为**Maven Embedder**：

> **插件使用什么 Maven 版本**
> 
> 插件**实际上并没有使用 Maven**本身。它使用的组件是 Maven 的一部分，称为 Maven Embedder。该组件不适用于 Maven 2.0.x。Embedder 由 Maven 命令行界面 (CLI) 从 2.1 版开始使用，其中包括许多改进以允许它实际嵌入 Maven。
> 
> m2eclipse 目前正在使用**Maven 3.0**中的 Embedder 组件。如果您想执行安装在其他地方的特定版本的 Maven，您可以从 Maven 启动配置中执行此操作，或者在 Maven / Installations 首选项页面中将其选为默认值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T13:02:52.610

m2e 带有自己的相关库副本。

除非您对特定 Maven 版本有特定要求，否则您不需要单独安装。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T13:03:33.203

## 不

m2e 全部捆绑在一起。此外，afaik，m2e 使用 Maven3。

# facebook - 使用 RestFB 在 Facebook 帖子上设置突出显示

> ID：11452415
> 
> 赞同：0
> 
> 时间：2012-07-12T13:01:06.590
> 
> 标签：facebook, restfb

使用`RestFB`API，您如何`"highlight"`在帖子上设置，即使帖子成为亮点，使其明显且引人注目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:47:20.733

您目前无法执行此操作，API 不支持此操作。

如果它不在这里（developers.facebook.com/docs/reference/api/user/#posts），则不受支持。

# php - CakePHP 2：如何在 Controller 中运行从 SchemaShell 类生成的方法

> ID：11452417
> 
> 赞同：1
> 
> 时间：2012-07-12T13:01:15.793
> 
> 标签：php, cakephp-2.0, shellexecute

我想从控制器中的操作生成“schema.php”。我试过了：

```
$m = new SchemaShell();
$m->params = array('force');
$m->generate(); 
```

但这不起作用。显示几个通知。

如何让它发挥作用？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:07:44.357

解决方案：

```
$m = new SchemaShell();
$m->params = array('force' => 1, 'file' => 'schema.php');
$m->startup();
$m->generate(); 
```

# css - 使用 css 将垂直对齐设置为 div

> ID：11452423
> 
> 赞同：1
> 
> 时间：2012-07-12T13:01:36.230
> 
> 标签：css, html

我有一个`<a>`标签，`<div>`我想要文本，`<a>`但`vertical-align:middle;`它不起作用，文本在顶部。为什么？

**CSS：**

```
div.banner 
{
    margin-top: 20px;
    padding: 18px 24px 50px 69px;
    background:url(banner.jpg) top center no-repeat;
    width:106px;
    height:38px;
    text-align:left;
    word-wrap: break-word;
    vertical-align: middle;
}

div.banner a
{
    display: block;
    width: 118%;
    margin-left:-13px;
} 
```

**HTML：**

```
<div class="banner">
  <a target="_blank" href="http://10.0.0.145/used-test-eq/bb_0">
    See All<br>used-test-eq
  </a>
</div> 
```

另外我希望文本位于地平线中心，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:07:17.677

添加与 div 高度相同的 line-height。

> vertical-align 属性可以分解为三个易于理解的步骤：
> 
> *   它仅适用于内联或内联块元素
>     
>     
> *   它影响元素本身的对齐方式，而不是其内容（应用于表格单元格时除外）
>     
>     
> *   当它应用于表格单元格时，对齐会影响单元格内​​容，而不是单元格本身

请参阅[了解 CSS 的 vertical-align 属性](http://www.impressivewebs.com/css-vertical-align/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:03:54.887

您需要设置行高，在底部添加行。

```
div.banner 
{
    margin-top: 20px;
    padding: 18px 24px 50px 69px;
    background:url(banner.jpg) top center no-repeat;
    width:106px;
    height:38px;
    text-align:left;
    word-wrap: break-word;
    vertical-align: middle;
    line-height:38px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:10:15.537

看到的 css 代码没问题，但垂直对齐：中间；拼写错误。这个正确的拼写vertical-align:middle;

# javascript - 实现在画布内拖动图像

> ID：11452424
> 
> 赞同：1
> 
> 时间：2012-07-12T13:01:37.780
> 
> 标签：javascript, html, html5-canvas

我想实现在画布内拖动图像。我想要最简单的代码。到目前为止，我已经看到了很多示例，但它们使用了复杂的实现方式。我想要一个易于学习和实施的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T14:20:19.517

这很难。您首先需要编写一个可以检测您何时单击特定元素的函数。但是，在我们这样做之前，我们必须定义“元素”的含义。它是单个绘制指令（例如矩形或弧线）的产物，还是复杂的东西？（想象一下，我想画一只猫，让整只猫作为一个整体可拖动。）

画布只不过是像素的集合。如果您希望您的程序具有“形状”甚至“视为一个单元的形状集合”的概念，您需要自己将它们实现为画布本身外部的数据结构。一旦你有了它，你可以编写一个`onmousedown`处理程序来获取单击的 x/y 点并确定单击位于哪个形状（如果有）（如果它位于多个形状内，请检查哪个具有最重要的 z-index） . 然后添加一个`onmousemove`处理程序，该处理程序根据形状数据对象中的信息擦除和重绘画布上的形状。

这是一个中等难度的问题，具有非常困难的先决条件（创建可以描述各种形状以及形状集合的数据结构）。我*强烈*建议您使用已经解决了这些问题的画布绘图库。我使用[cake.js](http://code.google.com/p/cakejs/)，但有很多[可用](http://www.createjs.com/#!/EaselJS)的[选项](http://paperjs.org/) [。](http://kineticjs.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:32:08.383

如果你不必使用 HTML5 画布，jQuery UI 会简单很多：

HTML：

```
<img class="drag-me" src="http://www.google.com/images/srpr/logo3w.png">​ 
```

JavaScript：

```
$(function() {

    $('.drag-me').draggable();
}); 
```

看到它在行动：

[http://jsfiddle.net/flackend/TQzSe/](http://jsfiddle.net/flackend/TQzSe/)

jQuery UI API 也有很多选项可以让它按照你的意愿行事：http: [//jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)

另外，如果它不能满足您的需求，您自己也很容易实现。如果您需要帮助，请在此处发布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-19T12:47:17.783

jsfiddle.net/Zevan/QZejF/5 这可能会对您有所帮助。

```
<html>
<head>
<title>Test Page</title>
<script type="text/javascript" src="jquery.js"></script>
</head>
<body>

<canvas id="c" width = "500" height = "500" ></canvas>

<script type="text/javascript">
var canvas = $("#c");
var c = canvas[0].getContext("2d");

//var path = "http://wonderfl.net/images/icon/e/ec/ec3c/ec3c37ba9594a7b47f1126b2561efd35df2251bfm";
var path = "blue.jpg";
var path2 = "purple.jpg";
var image1 = new DragImage(path, 200, 100);
var image2 = new DragImage(path2, 300, 100);

var loop = setInterval(function() {

    c.fillStyle = "gray";
    c.fillRect(0, 0, 500, 500);

    image1.update();
    image2.update();
}, 30);

var mouseX = 0,
    mouseY = 0;
var mousePressed = false;
var dragging = false;
canvas.mousemove(function(e) {
    mouseX = e.offsetX;
    mouseY = e.offsetY;
})

$(document).mousedown(function() {
    mousePressed = true;
}).mouseup(function() {
    mousePressed = false;
    dragging = false;
});

function DragImage(src, x, y) {
    var that = this;
    var startX = 0,
        startY = 0;
    var drag = false;

    this.x = x;
    this.y = y;
    var img = new Image();
    img.src = src;
    this.update = function() {
        if (mousePressed ) {

                var left = that.x;
                var right = that.x + img.width;
                var top = that.y;
                var bottom = that.y + img.height;
                if (!drag) {
                    startX = mouseX - that.x;
                    startY = mouseY - that.y;
                }
                if (mouseX < right && mouseX > left && mouseY < bottom && mouseY > top) {
                    if (!dragging){
            dragging = true;
                        drag = true;
                    }

                }

        } else {

            drag = false;
        }
        if (drag) {
            that.x = mouseX - startX;
            that.y = mouseY - startY;
        }
        c.drawImage(img, that.x, that.y);
    }
}
</script>
</body>
</html> 
```

# c# - 模棱两可的错误 c# / sql

> ID：11452425
> 
> 赞同：-4
> 
> 时间：2012-07-12T13:01:43.517
> 
> 标签：c#, sql-server

有人可以告诉我为什么我收到此代码错误吗？

```
 SqlCommand scGetClaimedDetails = new SqlCommand(
    "SELECT SUM(isclaimable) as claimable, SUM(isclaimed) as claimed,SUM(total) as total from" +
    " ( SELECT CASE WHEN claimed = 'Y' THEN inv_amt *.45 END as isclaimed, (inv_amt *.45) as inclaimable, inv_amt as total from invasset" +
    " INNER JOIN Invoice ON invoice.invoice = invasset.invoice WHERE invasset.asset_no = @AssetNumber ) as D2", DataAccess.AssetConnection); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:07:23.887

在子查询中指定 inv_amt 列来自哪里（是 invoice.inv_amt 还是 invasset.inv_amt）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:08:26.667

> 不明确的列名 inv_amt

它像两个表一样接缝，`invasset`并且`Invoice`都包含 column `inv_amt`，您必须将其引用到内部`SELECT`语句中的别名，例如：`invoice.inv_amt`或`invasset.inv_amt`：

```
SELECT SUM(isclaimable) as claimable, SUM(isclaimed) as claimed, 
       SUM(total) as total 
FROM
( 
   SELECT CASE WHEN claimed = 'Y' THEN invoice.inv_amt *.45 END as isclaimed, 
   (inv_amt *.45) as  inclaimable, inv_amt as total 
   from invasset INNER JOIN Invoice  ON invoice.invoice = invasset.invoice 
   WHERE invasset.asset_no = @AssetNumber 
) as D2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:09:05.833

当我将您的代码格式化为人类可读的...

```
SqlCommand scGetClaimedDetails = new SqlCommand(
    "SELECT
         SUM(isclaimable) AS claimable,
         SUM(isclaimed) AS claimed,
         SUM(total) AS total
     FROM
         (SELECT
              CASE WHEN claimed = 'Y' THEN inv_amt *.45 END AS isclaimed,
              (inv_amt *.45) AS inclaimable,
              inv_amt AS total
          FROM
              invasset
              INNER JOIN Invoice ON invoice.invoice = invasset.invoice
          WHERE
              invasset.asset_no = @AssetNumber) AS D2",
    DataAccess.AssetConnection); 
```

我不禁注意到你的外部`SELECT`正在寻找一个名为的列`isclaimable`，而你的内部`SELECT`正在返回一个名为`inclaimable`. 你的代码有错别字。

**编辑：**针对您对问题的评论，哪些表包含该字段`inv_amt`？显然，您正在引用两个拥有它的表。由于您引用的唯一表是`invasset`并且`Invoice`显然这两个表都有一个名为`inv_amt`. 您必须在查询中指定您想要的。

所以而不是：

```
`inv_amt AS total` 
```

你会想要这样的东西：

```
`invasset.inv_amt AS total` 
```

（假设这是您想要的表，否则使用另一个表。）

# android - 是否有适合在已知环境中识别对象的图像处理库/AR 技术？

> ID：11452432
> 
> 赞同：5
> 
> 时间：2012-07-12T13:02:36.557
> 
> 标签：android, iphone, image-processing, augmented-reality, object-detection

我需要检测场景中的对象（在 iPhone 和 Android 上）。环境以一种应该使问题更容易和更准确的方式受到约束：

1.  环境小而知名......用户正在探索一个我可以提前拍照的单间或小的户外区域，以“训练”或约束算法
2.  用户在空间内的位置通常是有限的......即使空间很大，用户也可能被限制在空间内的特定路径中
3.  被检测到的物体是相对静止的……它们是环境的一部分，不会移动

但是，使问题变得更加困难：

1.  我无法通过在对象上放置标记来修改环境，因此我需要识别对象本身
2.  这些对象看起来非常相似，因此我们可能必须使用周围场景作为输入，而不仅仅是单个项目

例如，想象一下沿着一条小路穿过一座历史悠久的墓地（您不允许在草地上行走）。当用户将手机指向墓碑时，我希望能够识别墓碑并估计用户相对于墓碑的位置（这样我就可以估计用户在路径上的位置）。如果你只看墓碑，许多墓碑看起来都非常相似。提前我可以走那条路，从不同的角度为物体拍摄多张照片。

是否有适合此类对象检测问题的算法或库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:07:13.267

这是您可能正在寻找的东西：http: [//3dar.us/](http://3dar.us/)

他们有自己的图书馆，您可以在其中获得接近您想要的东西（对象的位置、您的位置、距离等）。唯一需要注意的是，它现在仅适用于 iPhone？祝您搜索顺利！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T13:25:32.170

如果周围的场景彼此之间存在很大差异，您可能可以使用简单的快速技术（如直方图匹配）来区分场景。这可用于确定您在哪个场景中，并缩小搜索范围。如果您可以区分场景，则可以切换到对象检测模式，以查找特定场景中预期的特定对象。我想如果对象是静态的并且有据可查，您可能能够搜索一组最可识别的特征描述符的预编译，确定它们的相对姿势等。 PTAMM 的方法与此大致相似（确定场景，加载场景的特征点，在当前场景中跟踪）。

如果您的示例（匹配墓碑）是您实际尝试的，那么问题将变得更加困难（我认为，至少从表面上看，大多数墓碑和背景在几何形状、颜色等方面都非常相似）。路径约束意味着您可以根据方位缩小搜索集（除非所有墓碑都面向同一方向）。之后，您将必须尽最大努力使用剩余的出色功能（文本？）。

# winforms - 它使用什么系统颜色作为此窗口底部的背景色？

> ID：11452434
> 
> 赞同：0
> 
> 时间：2012-07-12T13:02:42.550
> 
> 标签：winforms

我对颜色的十六进制代码不感兴趣，而是对它的系统名称感兴趣，以便在表单中使用并匹配不同版本 Windows 中的颜色

![在此处输入图像描述](../Images/b55b34f364b74bb66a5aaa57a54333b9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:51:02.790

该窗格称为“详细信息窗格”，在“组织”>“布局”下的菜单中显示/隐藏它很明显。我不相信它具有系统颜色，因为背景实际上是图像，这在 Windows Vista 中更为明显：

![在此处输入图像描述](../Images/bbdd7629b2b7c9f625f8fb1d71112a74.png)

在 Windows 7 中，他们只是将其替换为更安静的图像，只在窗格的顶部边框下留下微妙的阴影效果。在[这个线程](http://www.sevenforums.com/customization/54723-details-pane-customization.html)中，他们讨论了在 Windows 7 中更改图像，这进一步证实了它可能是图像而不是颜色。

# ios4 - 单击按钮时从一个视图移动到另一个视图----？

> ID：11452438
> 
> 赞同：0
> 
> 时间：2012-07-12T13:02:56.963
> 
> 标签：ios4

我是 iPhone 的新手，并开发了一个应用程序“在基于单一视图的应用程序中单击按钮时显示下一个和上一个图像”。我想要在运行我的应用程序时“一个开始按钮和欢迎消息视图”，然后单击开始按钮，想要继续我已经开发的应用程序，我使用 Next 和 Back 按钮制作的内容正确显示了下一个和上一个图像。我还希望，在按钮单击（开始）时，图像会在一段时间（5 秒）后自动移动，而无需单击下一个图像，以便用户可以使用手动从一个图像移动到另一个图像或在一段时间后自动移动.

在此先感谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T18:17:11.847

我不明白您所说的“在我已经开发的应用程序上”。我你想在视图之间移动避免罪恶

我建议您查看 UIScrollView 参考指南并查看 Apple 提供的示例代码。

[UIScrollView 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html "UIScrollView 参考")

要使用非手势检测在图像之间移动，您还可以在按钮的 IBAction 上使用 UIView 动画执行一些动画。

我敢肯定，如果浏览一下苹果示例和指南，您将开发应用程序的速度如此之快。

# c# - 面料花型返回类型方法

> ID：11452441
> 
> 赞同：0
> 
> 时间：2012-07-12T13:03:05.597
> 
> 标签：c#, .net, design-patterns, factory-pattern

我是.net 的初学者。我正在尝试了解织物图案方法。

我找到了这个代码[示例](https://stackoverflow.com/q/3578648/1067943)：

```
 public abstract class Person
{
    public string Name { get; set; }
    public decimal Salary { get; set; }
}

public class Employee : Person
{
    public Employee()
    {
        this.Salary = 20000;
    }

}

public class Pilot : Person
{
    public string PilotNumber { get; set; }

    public Pilot()
    {
        this.Salary = 50000;
    }
}

public static class PersonFactory
{
    public static Person CreatePerson(string typeOfPerson)
    {
        switch (typeOfPerson)
        {
            case "Employee":
                return new Employee();
            case "Pilot":
                return new Pilot();
            default:
                return new Employee();
        }
    }
} 
```

并使用工厂：

```
Person thePilot = PersonFactory.CreatePerson("Pilot");
    ((Pilot)thePilot).PilotNumber = "123ABC"; 
```

我无法理解此示例中的 CreatePerson 方法。

```
public static Person CreatePerson(string typeOfPerson)
    {
        switch (typeOfPerson)
        {
            case "Employee":
                return new Employee();
            case "Pilot":
                return new Pilot();
            default:
                return new Employee();
        }
    } 
```

该方法返回 Person 类型，但在 switch 运算符中，您可以看到它创建并返回 Pilot() 或 Employee() 实例类。

这怎么可能是方法签名中的返回类型定义与函数本身的返回类型不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:13:27.750

将工厂方法更新为泛型方法会容易得多。像这样。

```
public static TPerson CreatePerson<TPerson>() where TPerson: Person {
    if (typeof(TPerson) == typeof(Employee)) {
        return new Employee();
    } else if (typeof(TPerson) == typeof(Pilot)) {
        return new Pilot();
    } else {
        return new Employee();
    }
} 
```

然后你可以不用任何演员来使用它：

```
Pilot pilot = PersonFactory.CreatePerson<Pilot>();
pilot.PilotNumber = "123ABC"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:05:02.817

因为所有这些返回类型都继承自 Person。您可以从函数隐式返回派生类。

```
public class Employee : Person <------ this Employee is inheriting the abstract class 'Person' (but not implementing anything from it)
{
    public Employee()
    {
        this.Salary = 20000;
    }

} 
```

例如上面 - Employee 类实际上也是一个 Person ，因为它继承自抽象类（它实际上没有实现抽象类的任何东西，因为没有什么要实现的）

这里的 Person 类是抽象的，但它没有指定任何抽象成员——这只是测试代码吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:05:48.850

因为 Pilot 继承自 Person。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T13:05:57.040

Employee 和 Pilot 类是person 的*子类*或*派生类*。在 OOP 中，这类似于*关系*。员工是人，飞行员是人，因此返回其中一种类型是完全合法的。调用者将不知道（不使用反射）它返回的是什么*类型*的人，也不应该关心。

# java - 读取 JSTL 标记上的 JSF 属性 (MyFaces 1.2)

> ID：11452451
> 
> 赞同：0
> 
> 时间：2012-07-12T13:03:47.453
> 
> 标签：java, jstl, myfaces

我在将旧应用程序从 MyFaces 1.1 迁移到 MyFaces 1.2 时遇到问题。在旧应用程序中，如果有一个 ManagedBean exampleMBean，我可以通过 ${exampleMBean.somePropertie} 读取这些属性，但是在将 MyFaces 迁移到 MyFaces 1.2 后，这种访问不起作用，总是返回 null。

如果我尝试使用，那么这不起作用。标记无法检索 ${exampleMBean.someValue} 值。为了解决这个问题，我将 c:if 测试事件替换为 t:div 渲染 =“#{exampleMBean.someValue}”，现在可以工作了。

如果我尝试使用具有显式值的 JSTL 标记，它们会起作用，但是当我尝试访问“jsf 上下文”时，无法检索到该值。

我正在使用 JBoss 4.2.3 并且我的项目将 org.jboss.jbossfaces.WAR_BUNDLES_JSF_IMPL 设置为 true 以使用我的项目附带的 myfaces 库。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:02:07.247

我已经解决了在两个上下文中“启动”bean 的问题，实际上我只是在 ManagedBeans 超类中创建了一个“create”方法并调用它，这个方法启动 bean 并将它扔到两个上下文 JSP 和 JSF 中。可能不是一个“聪明”的解决方案，但将是暂时的。

# c# - 通过 http 的 WCF 客户端数据

> ID：11452452
> 
> 赞同：1
> 
> 时间：2012-07-12T13:03:49.537
> 
> 标签：c#, .net, wcf

我是 WCF 的新手，我创建了一个包含 DataContract 的服务，该服务应该保持数据成员状态，但是在我调用 getdata 后，我返回的状态为空。虽然当我使用 tcp 时，值是保留的。

```
 [ServiceContract(Namespace = "http://KamiServiceHost.net/Go")]
public interface IService1
{
    [OperationContract]
    DataItem GetData();

    [OperationContract]
    void SaveData(DataItem item);
}

 [ServiceBehavior(InstanceContextMode = InstanceContextMode.PerSession)]
public class Service1 : IService1
{
    private DataItem _item1;
    private DataItem item
    {
        get { return _item1; }
        set { _item1 = value; }
    }

    public void SaveData(DataItem setitem)
    {
        item = setitem;
    }

    public DataItem GetData()
    {
        return item;
    }
} 
```

主机 app.config

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.web>
    <compilation debug="true" />
  </system.web>
  <system.serviceModel>
    <services>
      <service name="Service.Service1" behaviorConfiguration="myServiceBehavior">
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8000"/>
            <add baseAddress="net.tcp://localhost:9000"/>
          </baseAddresses>
        </host>
        <endpoint address="Service1" binding="basicHttpBinding" contract="Service.IService1"></endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="myServiceBehavior">
          <serviceMetadata httpGetEnabled="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
 </configuration> 
```

客户端代码：

```
 client.Open();
        var dataItem = new DataItem() { Name = "my object", Number = 12 };
        client.SaveData(dataItem);

        var data = client.GetData();

        Console.WriteLine(string.Format("Name: {0}    Number: {1}", data.Name, data.Number)); 
```

数据的值为空，我不知道为什么..任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:12:21.843

BasicHttpBinding 不支持该实例模式：http: [//msdn.microsoft.com/en-us/library/ms730879.aspx](http://msdn.microsoft.com/en-us/library/ms730879.aspx)。如果没有会话支持，您在第一次调用时提供的对象实例就会丢失

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:14:07.783

如果您的服务设置为每个实例，那么对于每个调用，您将在服务器上获得服务类的不同实例，因此您返回的项目当然将为空。

# android - 安卓市场/谷歌播放

> ID：11452459
> 
> 赞同：0
> 
> 时间：2012-07-12T13:04:09.377
> 
> 标签：android, google-play

我昨天在google play上传了我的应用程序，今天如果我在google play搜索我的应用程序的标题，我的应用程序出现在80到100个应用程序之后？？为什么会这样，有什么建议吗？？？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:19:51.053

您给您的应用程序起的名称可能很常见，并且市场上出现的应用程序默认根据其标签显示。尝试为您的应用程序赋予唯一性，而不是尝试。这还取决于下载的次数用户，喜欢，对他们的评论等等......随着您的应用程序的费率增加，它会自动在图表中上升。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:20:10.287

那是因为您的应用名称、评级、#downloads。1\. 确保您的名字不被其他人使用或至少不经常使用 2\. 确保您获得尽可能多的星级/评分（请用户对应用程序评分）。您的应用程序的排名越好/越多，您的应用程序就越有可能首先显示 3\. 下载计数器也会影响排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:11:02.233

评分基于受欢迎程度、点击次数等。您还应该尝试推广您的应用程序。文档谈到了它。

> 准备宣传材料。
> 
> 要充分利用 Google Play 的营销和宣传能力，您需要为您的应用程序创建宣传材料，例如屏幕截图、视频、图形和宣传文字。

另请查看：

[https://stackoverflow.com/questions/4058297/how-to-promote-android-app](https://stackoverflow.com/questions/4058297/how-to-promote-android-app)

而[这个](http://www.androidtapp.com/tag/how-to-promote-your-android-apps/)

# android - 在android中合并两个或多个.wav文件

> ID：11452464
> 
> 赞同：11
> 
> 时间：2012-07-12T13:04:28.903
> 
> 标签：android

首先，我必须告诉你，我是 android 新手。我想合并两个 .wav（音频文件）文件。我已经用谷歌搜索过，使用 javax 包很容易将它们组合起来，但它在 android 上不受支持。你能告诉我如何在android中做到这一点。你能建议我任何可以帮助的教程或图书馆吗？提前感谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-12T13:16:38.217

作为新手，用户只会从文件中读取字节并将其与第二个文件连接！

但它不是那样工作的。在组合两个文件时，你必须非常小心波形文件头。幸运的是，我已经准备好了片段，这将对你有所帮助。

干得好

```
private void CombineWaveFile(String file1, String file2) {
    FileInputStream in1 = null, in2 = null;
    FileOutputStream out = null;
    long totalAudioLen = 0;
    long totalDataLen = totalAudioLen + 36;
    long longSampleRate = RECORDER_SAMPLERATE;
    int channels = 2;
    long byteRate = RECORDER_BPP * RECORDER_SAMPLERATE * channels / 8;

    byte[] data = new byte[bufferSize];

    try {
        in1 = new FileInputStream(file1);
        in2 = new FileInputStream(file2);

        out = new FileOutputStream(getFilename3());

        totalAudioLen = in1.getChannel().size() + in2.getChannel().size();
        totalDataLen = totalAudioLen + 36;

        WriteWaveFileHeader(out, totalAudioLen, totalDataLen,
        longSampleRate, channels, byteRate);

        while (in1.read(data) != -1) {

            out.write(data);

        }
        while (in2.read(data) != -1) {

            out.write(data);
        }

        out.close();
        in1.close();
        in2.close();

        Toast.makeText(this, "Done!!", Toast.LENGTH_LONG).show();
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
}

private void WriteWaveFileHeader(FileOutputStream out, long totalAudioLen,
long totalDataLen, long longSampleRate, int channels, long byteRate)
throws IOException {

    byte[] header = new byte[44];

    header[0] = 'R';
    header[1] = 'I';
    header[2] = 'F';
    header[3] = 'F';
    header[4] = (byte)(totalDataLen & 0xff);
    header[5] = (byte)((totalDataLen >> 8) & 0xff);
    header[6] = (byte)((totalDataLen >> 16) & 0xff);
    header[7] = (byte)((totalDataLen >> 24) & 0xff);
    header[8] = 'W';
    header[9] = 'A';
    header[10] = 'V';
    header[11] = 'E';
    header[12] = 'f';
    header[13] = 'm';
    header[14] = 't';
    header[15] = ' ';
    header[16] = 16;
    header[17] = 0;
    header[18] = 0;
    header[19] = 0;
    header[20] = 1;
    header[21] = 0;
    header[22] = (byte) channels;
    header[23] = 0;
    header[24] = (byte)(longSampleRate & 0xff);
    header[25] = (byte)((longSampleRate >> 8) & 0xff);
    header[26] = (byte)((longSampleRate >> 16) & 0xff);
    header[27] = (byte)((longSampleRate >> 24) & 0xff);
    header[28] = (byte)(byteRate & 0xff);
    header[29] = (byte)((byteRate >> 8) & 0xff);
    header[30] = (byte)((byteRate >> 16) & 0xff);
    header[31] = (byte)((byteRate >> 24) & 0xff);
    header[32] = (byte)(2 * 16 / 8);
    header[33] = 0;
    header[34] = RECORDER_BPP;
    header[35] = 0;
    header[36] = 'd';
    header[37] = 'a';
    header[38] = 't';
    header[39] = 'a';
    header[40] = (byte)(totalAudioLen & 0xff);
    header[41] = (byte)((totalAudioLen >> 8) & 0xff);
    header[42] = (byte)((totalAudioLen >> 16) & 0xff);
    header[43] = (byte)((totalAudioLen >> 24) & 0xff);

    out.write(header, 0, 44);
} 
```

# c++ - QProgressBar 中的无限进度

> ID：11452465
> 
> 赞同：0
> 
> 时间：2012-07-12T13:04:30.197
> 
> 标签：c++, qt

我需要在我正在使用的 QProgressBar 中显示不确定的进度/忙碌效果。我在文档中读到，可以通过将最大值和最小值设置为 0 来创建它。我尝试了相同的方法，但无法正确设置。我读到了一个可能的错误，即当我使用 Plastique 样式时，不会发生这种效果。是否可以通过其他方式获得效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:36:17.770

一个（不一定是 C++）解决方案可能是只显示一个显示正在运行的进度条的动画 GIF？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:40:06.913

我也遇到过这个问题！我发现如果你确保工作是在工作线程中完成的，而不是在主线程中，它会更好地工作。但遗憾的是，您仍然会在某些时候进度条显示奇怪的东西。

# regex - 使用正则表达式搜索任意单词

> ID：11452469
> 
> 赞同：0
> 
> 时间：2012-07-12T13:04:52.047
> 
> 标签：regex, qt

我有一个问题，我需要找到一个单词，它可以是当前格式 NormalWord 或在单词中包含数字和 - （减号），例如 1Word-withnumber1-Morecharacters。或包含 c 引用字符 'My word' 我曾尝试使用 (qt) QRegExp rx("(((\w+\b)|('.*'))"); 但是这种结构仅适用于普通单词，例如 SimpleWord 或“简单单词”，但当我有一个像 1Word-withnumber1-Morecharacters 或 Word1-withsomeMorecharacters 这样的单词时则不行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:27:12.473

尝试这样的事情：`(\w+(-\w+)*|'.[^']*')`

将`[^']`匹配除撇号/单引号之外的任何内容。

# javascript - javascript中标签的innerHTML问题

> ID：11452472
> 
> 赞同：-1
> 
> 时间：2012-07-12T13:05:07.453
> 
> 标签：javascript

我试图用文本更新标签

```
var label_count2 = document.createElement("label");              
        label_count2.setAttribute("id", "label_count2");     
        label_count2.style.textAlign = "right";
        label_count2.style.border = "none"; 

gradient_div.appendChild(label_count2);            
self.parent.appendChild(gradient_div);

 updateText : function (text){

        document.getElementById("label_count2").innerHTML = count; 

    }, 
```

当我尝试调用`updateText()`屏幕中的值时没有改变。

我在调试器中检查了它，我看到该值是正确的。

我试图改变`innerHTML`To `innerText`，它也没有奏效。

如果我添加行`label_count2.innerHTML = "any text"`，那么我可以看到该值。

你能告诉我为什么它不能从函数中工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:07:43.730

这：

```
self.parent.appendChild(gradient_div); 
```

让我觉得（虽然我不能确定）你正在将元素添加到父窗口。如果是这种情况，则`document`来自子窗口的 将不包含该元素，因此“getElementById()”将返回`null`。

如果是这样的话，那么：

```
 self.parent.document.getElementById('label_count2').innerHTML = count; 
```

可能会奏效。

# git - 我可以签出/创建一个包含某些提交的标签吗？

> ID：11452474
> 
> 赞同：0
> 
> 时间：2012-07-12T13:05:14.107
> 
> 标签：git, git-branch, git-tag

我想创建一个省略某些提交的标签。因此，在创建标签时，我选择添加哪些提交（或省略哪些提交）。这将使我能够部署热修复并省去较旧（和较新）的提交。

同样可以通过使用分支来实现，但我不想为每个环境（开发、测试、登台、产品）创建一个分支。因此，如果我可以在 1 个分支中创建所有标签，我可以只将 prod 标签部署到 prod 并将 HEAD 部署到其余部分（dev、test、staging）。

也许有 git-notes 的东西？

（樱桃采摘到标签？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T06:39:21.503

如前所述，在 git 中，标签用于标识单个提交。单个提交标识整个存储库的状态和特定时间点，因此您所要求的无法在 git 中完成。

就像说的那样，可以做的是创建一个新分支，您可以在其中挑选您想要的东西，然后标记它。

我不明白你关于 prod 不需要分支的评论。确实如此，我们已经这样做了很长时间，即使使用 git 以外的其他 VCS 软件（即使已支持选择性标记/标签，因此分离是明确的）。通常的做法是为生产版本创建一个新分支，或者为每个版本创建一个分支，或者一个包含所有产品版本的生产分支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T06:24:40.350

在 Git 中，标签用于标识单个提交，分支用于标识一系列提交。您可以通过从不同的分支（或您所称的环境）中选择所需的提交来创建新分支。然后将新分支部署到 prod 并将 HEAD 部署到其余分支（开发、测试、登台）。但是，您可能需要考虑使用更适合的不同工作流程。

见[http://nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)

# javascript - 从 javascript 运行网站功能

> ID：11452475
> 
> 赞同：0
> 
> 时间：2012-07-12T13:05:14.730
> 
> 标签：javascript, google-chrome, google-chrome-extension, document

这就是我到目前为止所得到的

```
function onReady(callback) {
    if (document.readyState === "complete") window.setTimeout(callback, 0);
    else window.addEventListener("load", callback, false);
}
onReady(function() {
    removeit("new");
});

function removeit() {
    el = document.querySelector("#toolbarCurtain");
    if (el) {
        el.style.setProperty("display", "", null);
    } * * EXEC COMMAND
    return;
} 
```

“ **EXEC COMMAND”是我要调用站点本身中的函数的地方。该函数称为drawPlayer（），当我在chrome控制台中键入drawPlayer（）时，它可以工作。我不能让我的脚本调用该函数，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:21:02.563

取自[这里](https://stackoverflow.com/a/11388087/608886)。

所有注入的代码都在一个孤立的世界中运行，这是一个与主网站的 JS 上下文隔离的 javascript 上下文。这是一种内置的安全措施，无法禁用。

解决方案是附加一个脚本。如果您需要大量执行，通常应该设置一个自定义通信事件，并且只注入一个脚本来侦听该自定义事件并`eval()`获取事件数据。[以下是 Google 建议的执行方式。](http://code.google.com/chrome/extensions/content_scripts.html#host-page-communication)

请记住，这仅在目标站点没有 CSP（内容安全策略）时才有效。

```
var RunInThisContext = function(c){ 
    var code = document.createTextNode(c);
    var script = document.createElement('script');
    script.type='text/javascript';
    script.appendChild(code);
    document.body.appendChild(script);      
}; 
```

像这样使用：

```
RunInThisContext('('+(function(){ 
     /////////////////////
     //
     //   RUN YOUR FUNCTIONS HERE
     //
     /////////////////////
}).toString()+'()); '); 
```

# mysql - GROUP_CONCAT 返回多条记录

> ID：11452476
> 
> 赞同：1
> 
> 时间：2012-07-12T13:05:17.947
> 
> 标签：mysql, group-concat

我有很多表并执行大查询（大约 5-7 个左连接）。看起来像这样

```
SELECT *, t.id
GROUP_CONCAT(field SEPARATOR '|') AS fields,
GROUP_CONCAT(other SEPARATOR '|') AS others
FROM table t
LEFT JOIN tablefields tf ON t.id = tf.user_id
LEFT JOIN tableothers to ON t.id = to.user_id
GROUP BY t.id 
```

这是问题。所有字段都连接良好，但即使连接表中只有一行，两个字段也会**像 'value|value|value|value' （15-17 次） 。**

我做错了什么？

附言

我不能使用 DISTINCT，因为一个字段是 section_id 而另一个字段是 note。注意可能相似，但 section_id 是唯一的。

聚苯乙烯

[https://gist.github.com/3098105](https://gist.github.com/3098105)

查看查询结果的一部分。

```
mysql> SELECT * FROM tablename;
+----+---------+------------+-----------+
| id | user_id | section_id | note_data |
+----+---------+------------+-----------+
|  1 |    1331 | UserVideo  | test      |
|  2 |    1331 | UserNCAA   | test      |
+----+---------+------------+-----------+
2 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T14:39:12.340

`tablefields`当您在和中都有多个匹配的行时`tableothers`，您将获得这些行的叉积。（我相信这是马库斯亚当斯在他的评论中得到的。）

如果您想要每个表中的“列表”，而不生成任何“重复”，请尝试以下操作：

```
SELECT tt.id
     , tt.fields
     , GROUP_CONCAT(to.other ORDER BY to.other SEPARATOR '|') AS `others`
  FROM (SELECT t.id
             , GROUP_CONCAT(tf.field ORDER BY tf.field SEPARATOR '|') AS `fields`
          FROM table t
          LEFT JOIN tablefields `tf` ON t.id = tf.user_id
         GROUP BY t.id
       ) tt
  LEFT JOIN tableothers `to` ON tt.id = to.user_id
 GROUP BY tt.id, tt.fields 
```

别名为 as 的内联视图为`tt`您提供了来自 的列表`tablefields`，每个`t.id`. 然后可以将该结果集连接到`tableothers`表中，以从该表中获取列表。以这种方式生成结果集可避免在每个表中有多个匹配行时生成额外的重复项，否则会产生叉积。

* * *

您注意到您无法使用`DISTINCT`关键字，因为您在要保留的每个列表中都有重复的值。如果这不是必需的，如果您可以允许消除重复值，那么您使用`DISTINCT`关键字来获得几乎相同的结果：

```
SELECT t.id
     , GROUP_CONCAT(DISTINCT tf.field ORDER BY tf.field SEPARATOR '|') AS `fields`
     , GROUP_CONCAT(DISTINCT to.other ORDER BY to.other SEPARATOR '|') AS `others`
  FROM table t
  LEFT JOIN tablefields `tf` ON t.id = tf.user_id
  LEFT JOIN tableothers `to` ON t.id = to.user_id
 GROUP BY t.id 
```

这种方法允许生成叉积，但随后消除了所有重复项，包括由“叉积”操作生成的重复值以及存在于本机数据中的那些重复项。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-12T13:09:04.527

这是因为 t.*。您应该只选择要应用分组的列。就像是

```
SELECT t.id, 
GROUP_CONCAT(field SEPARATOR '|') AS fields, 
GROUP_CONCAT(other SEPARATOR '|') AS others 
FROM table t 
LEFT JOIN tablefields tf ON t.id = tf.user_id 
LEFT JOIN tableothers to ON t.id = to.user_id 
GROUP BY t1.id 
```

# javascript - 如何在 PlayN 中添加对自定义 JavaScript 事件触发器的支持？

> ID：11452477
> 
> 赞同：-1
> 
> 时间：2012-07-12T13:05:19.187
> 
> 标签：javascript, html, playn

我正在尝试制作一个 PlayN 游戏，该游戏需要从 HTML5 版本中的一些非标准 javascript 触发器（设备上的硬件按钮）进行控制。Android、iOS 版本都将是相当标准的。

我在哪里寻找接线？

此外，（可能是一个愚蠢的）导出构建的 HTML5 以在 Web 服务器上发布的最佳方式是什么？

谢谢，

马丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:47:05.607

每个项目都带有针对每个平台的特定子项目，您可以在其中放置 html 5 特定代码。

[从命令行构建您的 HTML 项目。](https://stackoverflow.com/questions/10892062/in-playn-how-can-i-build-the-html-version-of-my-project-from-the-command-line/10899856#10899856)

# padding - 如何在 EditText 之间留出空间，而不是 Margin 我想在 Android 中设置 Padding

> ID：11452481
> 
> 赞同：0
> 
> 时间：2012-07-12T13:05:41.827
> 
> 标签：padding, margin

我必须在 EditText 字段之间设置填充，如果我设置填充它会影响 HintText 而不是字段。那么，如何设置填充，边距效果，但我不想使用边距。建议我怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T09:39:38.373

我修复了错误..这只是关于逻辑，我没有使用。

# ssrs-2008 - 在 SSRS Axapta 2012 中使用 2 个数据集

> ID：11452485
> 
> 赞同：5
> 
> 时间：2012-07-12T13:05:56.023
> 
> 标签：ssrs-2008, reporting-services, axapta, dynamics-ax-2012

在 2012 年，任何员工的维度都可能是多个（动态）。

除了员工详细信息，我还需要显示尺寸。现在，我在 ssrs 中有一个带有 empl 详细信息的数据集和另一个带有维度（多个）的数据集。

我怎样才能一起显示它，例如
名称：XYZ
维度1
维度2
维度3

名称：ABC
维度1
维度2
。
.
.

预先感谢
问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:02:40.620

根据您的需要，您可以通过子报告或使用[LookUp()](http://msdn.microsoft.com/en-us/library/ee210531%28v=sql.105%29.aspx)函数来执行此操作。

请在 Stack Overflow 上查看以下内容：[Using Fields in Multiple Datasets in SSRS](https://stackoverflow.com/questions/10342896/using-fields-in-multiple-datasets-in-ssrs)

看起来您正在寻找的 LookUp() 函数。这是[一篇](http://blog.jontav.com/post/23229005764/ssrs-lookup)关于使用这种技术的好文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-15T13:02:24.707

您可以将单个表用于 emp 详细信息和维度。为每个维度类型创建单独的字段。并用价值填充它们。然后将它们显示在 ssrs 表上。

希望这可以帮助。

# javascript - HTML 选择列表 - 如何使用 jQuery 添加水印？

> ID：11452487
> 
> 赞同：2
> 
> 时间：2012-07-12T13:06:03.323
> 
> 标签：javascript, jquery, html

好吧，这有点让我发疯。我有一个带有下拉菜单的基本 HTML 页面：

```
<select id="someDropDown" class="watermarked">
   <option value="">Please Select</option>
   <option>Item 1</option>
   <option>Item 2</option>
</select> 
```

使用这个 jQuery 插件，它说我可以为选择列表添加水印：

[http://archive.plugins.jquery.com/project/TinyWatermark](http://archive.plugins.jquery.com/project/TinyWatermark)

这是我的 jQuery：

```
$(document).ready(function() {
    $('.watermarked').watermark('watermark', 'derp');
}); 
```

使用这种 CSS 样式：

```
.watermark 
{
    color: #999;
} 
```

当我这样做时，下拉列表不再下降，但它带有水印......我在这里做错了什么？

顺便说一句-这在 chrome 中已损坏，但只有在我双击该元素时才能在 IE9 中使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T19:11:00.703

我不确定您是否可以通过选择来做到这一点。如果您查看演示，则全部用于文本输入字段。这通常是占位符文本的工作方式。

不过试试这个。它禁用“请选择”项目，因此当您打开列表时，它是灰色的，您无法再次选择它。但是，这不会正常更改颜色。

```
<select id="someDropDown" class="watermarked">
   <option disabled selected>Please Select</option>
   <option>Item 1</option>
   <option>Item 2</option>
</select> 
```

**jQuery解决方案**

确保请选择选项具有属性`disabled selected`，并且整个选择具有`gray`类。这将使您在页面上看到的下拉框设置为灰色字体颜色。jQuery 代码将遍历未禁用的选项并使它们变黑。Then, when the selection changes, it will remove the `gray`class making the dropdown box black (default) as well.

**CSS**

```
.gray {
    color:#ccc;
} 
```

**HTML**

```
<select id="someDropDown" class="watermarked gray">
   <option disabled selected>Please Select</option>
   <option>Item 1</option>
   <option>Item 2</option>
</select> 
```

**JS**

```
$("#someDropDown option:not([disabled])").css("color", "#000");
$("#someDropDown").change(function() {
    $(this).css('gray');
}); 
```

[演示](http://jsbin.com/izacog)

# android - 联系人选择器，获取电话号码

> ID：11452491
> 
> 赞同：1
> 
> 时间：2012-07-12T13:06:26.913
> 
> 标签：android, android-contacts

当用户在联系人选择器中选择联系人时，我一直在谷歌搜索以了解如何获取电话号码。我知道如何打开联系人选择器。但不是如何获得电话号码。

我试过这些例子：

[http://mobile.tutsplus.com/tutorials/android/android-essentials-using-the-contact-picker/](http://mobile.tutsplus.com/tutorials/android/android-essentials-using-the-contact-picker/)
[http://www.enkeladress.com/article.php/android_snippen_show_contact_picker](http://www.enkeladress.com/article.php/android_snippen_show_contact_picker)

还有很多 stackoverflow 线程，但[Phone](http://developer.android.com/reference/android/provider/Contacts.Phones.html)类似乎已被弃用。那么，我该怎么做呢？

提前致谢！

（真的很抱歉英语不好！希望你能理解！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T09:37:51.373

这对我有用。

```
Uri contactData = data.getData();
Cursor c =  main.managedQuery(contactData, null, null, null, null);
if (c.moveToFirst()) {
    String contactId = c.getString(c.getColumnIndex(ContactsContract.Contacts._ID));
}

Cursor c1 = mcontext.getContentResolver().query(Data.CONTENT_URI,
    new String[] {Data._ID, Phone.NUMBER, Phone.TYPE, Phone.LABEL},
    Data.CONTACT_ID + "=?" + " AND "
    + Data.MIMETYPE + "='" + Phone.CONTENT_ITEM_TYPE + "'",
    new String[] {String.valueOf(contactId)}, null);
c1.moveToFirst();
String number = c1.getString(1); 
```

我从谷歌文档中得到了查询。您在第一个位置得到字符串，因为这是上面查询中的位置。
[http://developer.android.com/reference/android/provider/ContactsContract.Data.html](http://developer.android.com/reference/android/provider/ContactsContract.Data.html)

# c# - 嵌套集合 - 问题，当实体的命名空间已更改时

> ID：11452492
> 
> 赞同：3
> 
> 时间：2012-07-12T13:06:31.917
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, ravendb

我使用 RavenDb 作为我的门户。以下文件示例`Question`：

```
{
  "CreatedOn": "2012-07-12T09:40:44.7514005Z",
  "CreatedBy": {
    "DisplayName": "Kamil",
  },
  "Subject": "My q",
  "Content": "My q content",
  "Tags": [
    "myQ"
  ],
  "Answers": {
    "$type": "System.Collections.ObjectModel.Collection`1[[QA.Core.Entities.Answer, QA.Core]], mscorlib",
    "$values": [
      {
        "CreatedOn": "2012-07-12T09:42:06.9852492Z",
        "CreatedBy": {
          "DisplayName": "Kamil",
        },
        "ModifiedOn": "2012-07-12T09:43:07.8442347Z",
        "ModifiedBy": {
          "DisplayName": "Kamil",
        },
        "Content": "My answer.",
        "IdNumber": 1,
        "Supporters": {
          "$type": "System.Collections.ObjectModel.Collection`1[[QA.Core.Entities.User, QA.Core]], mscorlib",
          "$values": []
        },
        "IsOfficial": true,
        "AttachmentHeaders": []
      }
    ]
  },
  "NumberOfViews": 3,
  "Supporters": {
    "$type": "System.Collections.ObjectModel.Collection`1[[QA.Core.Entities.User, QA.Core]], mscorlib",
    "$values": []
  },
  "NotificationEmails": [],
  "AttachmentHeaders": [],
  "LastAnswerId": 1
} 
```

在 Question 类的大重构命名空间发生变化之后。在文档元数据（在 raven 中）中检测到更改并且没关系。但是嵌套集合怎么样：

```
 "Supporters": {
    "$type": "System.Collections.ObjectModel.Collection`1[[QA.Core.Entities.User, QA.Core]], mscorlib",
    "$values": []
  }, 
```

? 当我尝试从应用程序级别获取该文件时，该文件会产生错误。当我将其更改为：

```
 "Supporters": [], 
```

但如果我必须对 200 个文档执行该操作，这不是解决方案。

有没有办法自动做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T07:54:22.867

是的，请参阅：

[http://ravendb.net/docs/client-api/set-based-operations](http://ravendb.net/docs/client-api/set-based-operations)

# sql - SQL：根据财务报告的最后付款日期创建帐龄桶

> ID：11452498
> 
> 赞同：4
> 
> 时间：2012-07-12T13:06:42.873
> 
> 标签：sql, sql-server-2008, tsql, financial, accounting

我需要在客户级别创建信用余额账龄报告。

笔记：

1.  账龄基于客户的最后付款日期。

2.  一个客户可以有多个帐户，有时会出现将付款应用到错误帐户的错误。例如，账户余额为 15 美元的客户支付 15 美元。这 15 美元的付款可能会被应用到错误的帐户，从而使客户在一个帐户上的余额为 -15 美元，而在另一个帐户上的余额为 15 美元。该客户需要从报告中排除。

获取具有贷方余额的客户的 SQL：

```
SELECT 
  ACCOUNT.CUST_ID
, sum(ACCOUNT.BALANCE)

FROM ACCOUNT

GROUP BY ACCOUNT.CUST_ID

HAVING sum(ACCOUNT.BALANCE) < 0 
```

获取最新付款日期的 SQL：

```
SELECT

  TRANSACTIONS.CUST_ID
, MAX(TRANSACTIONS.POST_DATE)

FROM TRANSACTIONS

WHERE TRANSACTIONS.TX_TYPE = 'PAYMENT'

GROUP BY TRANSACTIONS.CUST_ID 
```

我需要为老化桶创建列，例如：

'0 - 30' 贷方余额

'0 - 30' 信用余额客户数量

'31 - 60'...

我打算在 max(TRANSACTIONS.POST_DATE) 和 "yesterday" - DATEADD(dd,-1,getdate()) 之间使用 DATEDIFF 函数使用 CASE 语句来创建存储桶。

但是，在执行存储桶总和和计数计算之前，使用变量或存储过程根据最后付款日期来分离客户不是更有效吗？

关于如何准确有效地做到这一点的任何想法？到目前为止，我一直在通过一个简单的查询来获取具有信用余额的客户以及他们的最后付款日期，然后自己使用 Excel 创建老化桶。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:48:14.770

你的方法是正确的方法。我不确定为什么你认为在存储过程中做某事会比在查询中做更有效。

我想你想要一个类似的查询：

```
select (case when t.DaysAgo between 0 and 30 then '0-30'
             when t.DaysAgo between 31 and 60 then '31-60'
             else 'OLD'
        end),
       <whatever you want here>
from (SELECT ACCOUNT.CUST_ID, sum(ACCOUNT.BALANCE) as balance
      FROM ACCOUNT
      GROUP BY ACCOUNT.CUST_ID
     ) a left outer join
     (SELECT TRANSACTIONS.CUST_ID, MAX(TRANSACTIONS.POST_DATE) as LastPaymentDate,
             datediff(d, X(TRANSACTIONS.POST_DATE), getdate()) as DaysAgo, 
      FROM TRANSACTIONS
      WHERE TRANSACTIONS.TX_TYPE = 'PAYMENT'
      GROUP BY TRANSACTIONS.CUST_ID
     ) t
     on a.cust_id = t.cust_id 
group by  (case when t.DaysAgo between 0 and 30 then '0-30'
                when t.DaysAgo between 31 and 60 then '31-60'
                else 'OLD'
           end) 
```

通常，您应该让 SQL 引擎优化查询。通常（但绝对不总是！）会做得很好，让你思考你想要完​​成的事情。

您将有额外的逻辑来排除某些客户并引入其他字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:56:00.977

我需要澄清一件事。如果客户可能有多个帐户，并且付款可能会在不正确的帐户上过帐，您如何处理？

意思是，如果客户有多个帐户，您如何确定将付款过帐到错误的帐户。这是否意味着即使某个客户拥有多个帐户，该客户对于不同的帐户仍然具有相同的 CustID？

因为如果每个帐户的 CustID 不同，我真的相信没有办法正确处理它，而不是使用您当前使用的 Excel 中的旧时尚方式。

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T01:32:41.007

有趣！.. 我编写了一个当铺应用程序，在该应用程序中，我们根据最后的利息支付日期或在没有利息 pymt 的情况下，pawn_date 对典当进行老化。有时客户在利息支付上落后 2 个月，但如果他们 90 天或更长时间没有支付利息或赎回典当，则只需支付 1 个月的利息以避免没收典当。因此，我们使用 (today - last_pymt_date) 来显示自上次 int pymt 或典当日期以来经过的天数。

每个客户可以有多个典当，因此一个客户主记录连接到多个典当详细记录。这是向正确客户付款的正确方法，您找到特定的典当记录，使用 pymt 更新，然后您可以查询每个客户典当以获得每个客户的总金额。

# arrays - 如何在 XSLT 中处理不同循环中的数组

> ID：11452508
> 
> 赞同：1
> 
> 时间：2012-07-12T13:07:07.083
> 
> 标签：arrays, xslt, xsl-variable

我在处理以下 xml 代码时遇到问题：

```
<?xml version="1.0" encoding="UTF-8"?>
<searchresult>
  <head>
    <heading>
      <title>Column1</title>
      <dataType>TEXT</dataType>
    </heading>
    <heading>
      <title>Column2</title>
      <dataType>DATE</dataType>
      <dataFormat>SHORT_DATE</dataFormat>
    </heading>
  </head>
  <data>
    <row>
      <column>
        <value>Hello</value>
      <column>
      <column>
        <value>2012-07-12</value>
      <column>
    </row>
    <row>
      <column>
        <value>Good bye</value>
      <column>
      <column>
        <value>2012-07-13</value>
      <column>
    </row>
  </data>
</searchresult> 
```

我需要将此 xml 转换为 EXCEL 兼容文件（我使用 urn:schemas-microsoft-com:office:office、urn:schemas-microsoft-com:office:excel 和 urn:schemas-microsoft-com:office:spreadsheet 命名空间它）

问题是我不知道如何在行/列/值上应用来自标题/标题元素 dataType + dataFormat（如果可用）的信息。这将帮助 Excel 识别其单元格内的数据类型。很明显，我需要保持秩序。列数及其元数据是动态的，每个 XML 可能不同。

我需要得到这样的东西：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<Workbook --several namespaces here-->

<Worksheet ss:Name="SearchResult">
  <Table x:FullRows="1" x:FullColumns="1">
    <Row ss:Height="12.75">
      <Cell>
        <Data ss:Type="String">Column1</Data>
      </Cell>
      <Cell>
        <Data ss:Type="String">Column2</Data>
      </Cell>
    </Row>
    <Row ss:Height="12.75">
      <Cell>
        <Data ss:Type="String">Hello : TEXT</Data>
      </Cell>
      <Cell>
        <Data ss:Type="Date">2012-07-12 : DATE - SHORT_DATE</Data>
      </Cell>
    </Row>
    <Row ss:Height="12.75">
      <Cell>
        <Data ss:Type="String">Good bye : TEXT</Data>
      </Cell>
      <Cell>
        <Data ss:Type="Date">2012-07-12 : DATE - SHORT_DATE</Data>
      </Cell>
    </Row>
  </Table>
</Worksheet>    
</Workbook> 
```

我尝试了几次创建有用且有效的东西，但我所有的尝试都失败了。当前版本在这里：

```
 <xsl:template match="searchresult">
    <Worksheet>
      --some unimportant script--
      <Table x:FullColumns="1" x:FullRows="1">
        <xsl:apply-templates select="head" />
        <xsl:apply-templates select="elements/row"/>
      </Table>
    </Worksheet>
  </xsl:template>

  <xsl:template match="head">       
    <Row>
      <xsl:for-each select="*">
        <!-- resolve data-type and remember it as variable -->
        <xsl:variable name="concat('dataType', position())" select="dataType">
          <xsl:choose>
            <xsl:when test="TEXT">
              <xsl:value-of select=".">String</xsl:value-of>
            </xsl:when>
            <xsl:when test="DATE">
              <xsl:value-of select=".">DateTime</xsl:value-of>
            </xsl:when>
          </xsl:choose>
        </xsl:variable>
        <xsl:variable name="concat('dataFormat', position())" select="dataFormatter" >
          <!-- create style IDs for different formats -->
        </xsl:variable>
        <Cell>
          <Data ss:Type="String">
            <xsl:value-of select="title/." />
          </Data>
        </Cell>
      </xsl:for-each>
    </Row>              
  </xsl:template>

  <xsl:template match="elements/row/column">
    <xsl:for-each select="values">
      <Cell>
        <!-- resolve order within loop and pick correct data-type variable -->
        <xsl:variable name="type" select="concat('$dataType', position())" />
        <xsl:variable name="format" select="concat('$dataFormat', position())" />
        <Data ss:Type="$type">
          <xsl:value-of select="concat(normalize-space(.),' : ', $type)"/>
          <!-- check if data format is set -->
          <xsl:if test="//TODO">
            <xsl:value-of select="concat(' - ', $format)" />
          </xsl:if>
        </Data>
      </Cell>
    </xsl:for-each>
  </xsl:template>

</xsl:stylesheet> 
```

这个版本没用，因为我不能使用任何变量值作为变量名，它必须是常量值。解析整个数据以某种方式工作，但是当我尝试实现数据类型和数据格式时，它就坏了。

**编辑**：有关数据类型和数据格式的信息被放置在 head 元素中，该元素包含有关列及其标题的所有信息。列在单独的模板中处理，它们不直接连接到头部元素的列定义。仅通过元素的顺序来维护关系。我需要处理每一行和每个单元格（对于正确的列）的数据类型和可能的数据格式（这是可选的）信息，而不仅仅是标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:52:23.897

您可以使用键按位置查找**标题**元素

```
<xsl:key name="headings" match="heading" use="count(preceding-sibling::heading)" /> 
```

然后，假设您位于**列**元素上，您将根据位置获得关联的数据类型，如下所示

```
<xsl:variable 
   name="dataType" 
   select="key('headings', count(preceding-sibling::column))/dataType" /> 
```

即对于一行中的第一个**列****元素**，您将查找第一个**标题**元素，并获取数据类型。

 ****关于您的 XSLT 的其他一些事情确实需要注意。首先，动态变量名称，如下所示是不允许的

```
<xsl:variable name="concat('dataType', position())" select="dataType"> 
```

**如果您使用select**属性，也不允许在变量中包含非空内容。

其次，如果要在输出属性中使用变量值，则需要使用属性值模板。而不是这样做...

```
<Data ss:Type="$type"> 
```

你会这样做

```
<Data ss:Type="{$type}"> 
```

此外，您应该更喜欢**xsl:apply-templates**而不是**xsl:for-each**，因为它们鼓励代码重用、减少嵌套代码，并且更符合 XSLT 的精神。

无论如何，这里是完整的 XSLT（注意使用虚构的命名空间）

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:x="x" xmlns:ss="ss">
   <xsl:output method="xml" indent="yes"/>
   <xsl:key name="headings" match="heading" use="count(preceding-sibling::heading)"/>

   <xsl:template match="searchresult">
      <Worksheet>
         <Table x:FullColumns="1" x:FullRows="1">
            <xsl:apply-templates select="head"/>
            <xsl:apply-templates select="data/row"/>
         </Table></Worksheet>
   </xsl:template>

   <xsl:template match="head">
      <Row>
         <xsl:apply-templates select="heading"/>
      </Row>
   </xsl:template>

   <xsl:template match="heading">
      <Cell>
         <Data ss:Type="String">
            <xsl:value-of select="title"/>
         </Data>
      </Cell>
   </xsl:template>

   <xsl:template match="row">
      <row>
         <xsl:apply-templates select="column"/>
      </row>
   </xsl:template>

   <xsl:template match="column">
      <Cell>
         <xsl:variable name="dataType" select="key('headings', count(preceding-sibling::column))/dataType"/>
         <xsl:variable name="type">
            <xsl:choose>
               <xsl:when test="$dataType = 'TEXT'">
                  <xsl:text>String</xsl:text>
               </xsl:when>
               <xsl:when test="$dataType = 'DATE'">
                  <xsl:text>Date</xsl:text>
               </xsl:when>
            </xsl:choose>
         </xsl:variable>
         <xsl:variable name="dataFormat" select="key('headings', count(preceding-sibling::column))/dataFormat"/>
         <Data ss:Type="{$type}">
            <xsl:value-of select="concat(normalize-space(.),' : ', $type)"/>
            <xsl:if test="$dataFormat">
               <xsl:value-of select="concat(' - ', $dataFormat)"/>
            </xsl:if>
         </Data>
      </Cell>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<Worksheet xmlns:x="x" xmlns:ss="ss">
   <Table x:FullColumns="1" x:FullRows="1">
      <Row>
         <Cell>
            <Data ss:Type="String">Column1</Data>
         </Cell>
         <Cell>
            <Data ss:Type="String">Column2</Data>
         </Cell>
      </Row>
      <row>
         <Cell>
            <Data ss:Type="String">Hello : String</Data>
         </Cell>
         <Cell>
            <Data ss:Type="Date">2012-07-12 : Date - SHORT_DATE</Data>
         </Cell>
      </row>
      <row>
         <Cell>
            <Data ss:Type="String">Good bye : String</Data>
         </Cell>
         <Cell>
            <Data ss:Type="Date">2012-07-13 : Date - SHORT_DATE</Data>
         </Cell>
      </row>
   </Table>
</Worksheet> 
```****

# tridion - Tridion 工作流程 - 组件版本历史不正确

> ID：11452515
> 
> 赞同：12
> 
> 时间：2012-07-12T13:07:20.847
> 
> 标签：tridion

我们为我们的一个客户设置了 YAWF（Yet Another Workflow Framework）。我们有一个简单的 Workflow 流程，它完全按照我们的要求工作，除了组件版本历史。

在版本历史中，我们只看到“Tridion Content Manager System NT Author”，而不是创建或更新组件的用户名。

我怀疑这是用于执行 YAWF 的 MTS 用户帐户。但是，我们确实需要用户名出现在版本历史记录中。

也许我们错误地配置了 YAWF？

有没有其他人遇到过这个问题，或者知道我们如何解决它？

我们正在使用 Tridion 2011。（还没有 SP1）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T14:10:13.120

那会是在您的工作流程中执行最后一步的帐户吗？

你似乎很确信它是 YAWF，你试过没有它吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-21T13:34:22.370

一般来说，可能有不同的人在开发一个版本，因为只有在所有活动完成后才会进行签入。

您可以通过遍历活动执行者来解决此问题，并在完成消息中包含评论。

另一种选择可能是冒充作者：

```
Set oTDSE = CreateObject("TDS.TDSE") 
oTDSE.Impersonate("[Author]") 
oTDSE.Initialize() 

' use TDSE 

Set oTDSE = Nothing 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-19T19:40:00.550

Thats expected behavior. If workflow's last activity is Automatic. It is always performed by *Tridion Content Manager System NT Author*.The user with which workflow service agent is running. As a work-around you can use J stuarts solution. I did similar one too.

Added another activity atlast as automatic. And performed this activity with the user who created the content originally. That way content is checked in with author details. However, to impersonate in workflow make sure your Tridion machine has impersonation user NT AUTHORITY\SYSTEM with user type Windows.

```
public void UpdateVersion(string workitemid,string componentid)
    {
        try
        {
            Stopwatch _watch = new Stopwatch();
            _watch.Start();
            Logger.Debug("Entered RPPTridionWorkflow UpdateVersion ");
            WorkItemData workItem = (WorkItemData)CoreServiceClient.Read(workitemid, options);
            ProcessInstanceData processInstance =
                (ProcessInstanceData)CoreServiceClient.Read(workItem.Process.IdRef, options);
            ActivityData creatorActivityData = getActivityDataBasedOnName(workitemid, "Content Creation");
            if (creatorActivityData != null)
            {
                LinkToUserData linktoAuthorUser = creatorActivityData.Owner;
                UserData authorUser = (UserData)CoreServiceClient.Read(linktoAuthorUser.IdRef, options);
                CoreServiceClient.Impersonate(authorUser.Title);
            }
            ActivityData[] ieActivities = processInstance.Activities;
            int currentActivity = ieActivities.Length - 1;
            if (ieActivities != null)
            {
                ActivityInstanceData activityInstance =
                   (ActivityInstanceData)CoreServiceClient.Read(processInstance.Activities[currentActivity].Id, options);

                ActivityFinishData finishData = new ActivityFinishData();
                finishData.Message = "Finished automatically and upded version info for component checked in";
                CoreServiceClient.FinishActivity(activityInstance.Id, finishData, options);
                CoreServiceClient.Close();
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-05T05:56:39.783

我意识到这是一个老问题，但我最近从核心服务的角度与同样的问题作斗争，并想分享我采取的路线（可能有人会在我将其部署到生产之前指出我可能出错的地方）。

在使用 Core Service 尝试了几种不同的方法后，我决定将最终手动活动添加到我的工作流中，并将自定义逻辑添加到前面的自动活动中。在自动活动的核心服务逻辑中，我完成当前的自动活动（返回最终的手动活动实例），模拟原始作者，启动最终的活动实例（作为作者）并完成最终的活动实例（再次，作为作者）。

我正在使用 SessionAwareCoreServiceClient 并在 Content Manager 机器本身上运行。我必须在 Tridion Content Manager 配置实用程序的 Impersonation Users 中添加“NT AUTHORITY\SYSTEM”（使用 Impersonate 可能存在安全隐患，因此请确保它对您的环境有意义）：

![冒充用户](../Images/221f94b0ee5866c9a8d7ceb459134efc.png)

代码看起来像这样（虽然我省略了一些东西，比如获取当前活动实例，从第一个手动活动中检索原始作者，我添加了 using SessionAwareCoreServiceClient 以提供一些上下文）：

```
using (SessionAwareCoreServiceClient client = new SessionAwareCoreServiceClient())
{
    ActivityFinishData activityFinish = new ActivityFinishData()
    {
        Message = message,
        NextAssignee = new LinkToTrusteeData() { IdRef = authorUser.IdRef }
    };

    // Finish current automatic activity
    ActivityInstanceData finalActivity = client.FinishActivity(activityInstance.Id, activityFinish, new ReadOptions());

    // Impersonate original author
    client.Impersonate(authorUser.Title);

    // Start final (manual) activity as author - if you don't start it, then non-Administrators can't finish them.
    client.StartActivity(finalActivity.Id, null);
    // Finish final (manual) activity as author
    client.FinishActivity(finalActivity.Id, activityFinish, null);
} 
```

希望我没有做任何太愚蠢的事情，并且可能这个答案会帮助像我这样不得不从各种其他问题/博客/参考资料中拼凑起来并执行一些试错法的人（这可能会使工作流程变得乏味）。

# android - 网格视图中的单选按钮

> ID：11452519
> 
> 赞同：1
> 
> 时间：2012-07-12T13:07:38.143
> 
> 标签：android, android-layout

是否可以在 gridview 中添加单选按钮？或者我可以让复选框像 gridview 中的单选按钮一样工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:37:24.373

这是一个例子。真的可以只使用一个单选按钮。但这是一个应该有所帮助的例子。当然我没有给你一切，但这应该告诉你这是可能的

```
import android.content.Context;
import android.util.AttributeSet;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.RadioButton;
import android.widget.TableLayout;
import android.widget.TableRow;

public class ToggleButton extends TableLayout  implements OnClickListener {

    private static final String TAG = "ToggleButton";
    private RadioButton activeRadioButton;

    /** 
     * @param context
     */
    public ToggleButton(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
    }

    /**
     * @param context
     * @param attrs
     */
    public ToggleButton(Context context, AttributeSet attrs) {
        super(context, attrs);
        // TODO Auto-generated constructor stub
    }

    @Override
    public void onClick(View v) {
        final RadioButton rb = (RadioButton) v;
        ///////// do whatever /////////////

    }

    /* (non-Javadoc)
     * @see android.widget.TableLayout#addView(android.view.View, int, android.view.ViewGroup.LayoutParams)
     */
    @Override
    public void addView(View child, int index,
            android.view.ViewGroup.LayoutParams params) {
        super.addView(child, index, params);
        setChildrenOnClickListener((TableRow)child);
    }

    /* (non-Javadoc)
     * @see android.widget.TableLayout#addView(android.view.View, android.view.ViewGroup.LayoutParams)
     */
    @Override
    public void addView(View child, android.view.ViewGroup.LayoutParams params) {
        super.addView(child, params);
        setChildrenOnClickListener((TableRow)child);
    }

    private void setChildrenOnClickListener(TableRow tr) {
        final int c = tr.getChildCount();
        for (int i=0; i < c; i++) {
            final View v = tr.getChildAt(i);
            if ( v instanceof RadioButton ) {
                v.setOnClickListener(this);
            }
        }
    }

    public int getCheckedRadioButtonId() {
        if ( activeRadioButton != null ) {
            return activeRadioButton.getId();
        }

        return -1;
    }
} 
```

并创建一个这样的布局（当然你需要清理它，但你明白了）

```
<?xml version="1.0" encoding="utf-8"?>
<com.example.android.view.ToggleButton
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content" android:layout_height="wrap_content"
    android:id="@+id/radGroup1">
    <TableRow>
            <RadioButton android:id="@+id/rad1" android:text="Button1"
                android:layout_width="105px" android:layout_height="wrap_content"
                android:textSize="13px" />
            <RadioButton android:id="@+id/rad2" android:text="Button2"
                android:layout_width="105px" android:textSize="13px"
                android:layout_height="wrap_content" />
            <RadioButton android:id="@+id/rad3" android:text="Button3"
                android:layout_width="105px" android:textSize="13px"
                android:layout_height="wrap_content" />
    </TableRow>
    <TableRow>
            <RadioButton android:id="@+id/rad1" android:text="Button1"
                android:layout_width="105px" android:layout_height="wrap_content"
                android:textSize="13px" />
            <RadioButton android:id="@+id/rad2" android:text="Button2"
                android:layout_width="105px" android:textSize="13px"
                android:layout_height="wrap_content" />
            <RadioButton android:id="@+id/rad3" android:text="Button3"
                android:layout_width="105px" android:textSize="13px"
                android:layout_height="wrap_content" />
    </TableRow>
    <TableRow>
            <RadioButton android:id="@+id/rad1" android:text="Button1"
                android:layout_width="105px" android:layout_height="wrap_content"
                android:textSize="13px" />
            <RadioButton android:id="@+id/rad2" android:text="Button2"
                android:layout_width="105px" android:textSize="13px"
                android:layout_height="wrap_content" />
            <RadioButton android:id="@+id/rad3" android:text="Button3"
                android:layout_width="105px" android:textSize="13px"
                android:layout_height="wrap_content" />
    </TableRow>
</com.example.android.view.ToggleButton> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:07:10.840

我已使用复选框使其工作。这里checkedVideo是一个布尔数组，它保存被选中的复选框的值。

```
selectCB.setId(position);
                selectCB.setOnClickListener(new OnClickListener() {

                    public void onClick(View v) {
                        // TODO Auto-generated method stub

                        CheckBox cb = (CheckBox) v;
                        int id = cb.getId();
                        Log.i(LOG_TAG, "Clicked ? "+id);
                        if(checkedVideo[id])
                        {
                            checkedVideo[id] = false;
                            cb.setChecked(false);
                        }
                        else
                        {
                            for(int index = 0; index < count; index++)
                            {
                                checkedVideo[index] = false;
                            }
                            checkedVideo[id] = true;
                            cb.setChecked(true);
                            notifyDataSetChanged();
                        }
                    }
                });

                Log.i(LOG_TAG, "Checked ? "+checkedVideo[position]);
                selectCB.setChecked(checkedVideo[position]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T05:27:46.757

您可以像这样制作自定义视图...

```
public class RadioGridView extends LinearLayout {

    private int mClickedPosition = -1;

    private Context mContext;

    private int[] mItems;
    private ImageView[] iv_items;

    public RadioGridView(Context context, int[] items) {
       super(context);

       this.mContext = context;
       this.mItems = items;

       init();
    }

    private void init() {

    if (mItems != null) {
        iv_items = new ImageView[mItems.length];

        GridView gv = new GridView(mContext);
        addView(gv);

        gv.setBackgroundColor(0xffffffff);
        gv.setColumnWidth(50);
        gv.setNumColumns(GridView.AUTO_FIT);
        gv.setVerticalSpacing(10);
        gv.setHorizontalSpacing(10);
        gv.setStretchMode(GridView.STRETCH_COLUMN_WIDTH);
        gv.setGravity(Gravity.CENTER);

        final RadioGridViewAdapter adapter = new RadioGridViewAdapter();

        gv.setAdapter(adapter);

        gv.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            if (mClickedPosition >= 0) {
            iv_items[mClickedPosition].setBackgroundColor(Color.WHITE);
            }
            iv_items[position].setBackgroundColor(Color.RED);
            mClickedPosition = position;

            if (mOnGridItemClickListener != null) {
            mOnGridItemClickListener.onItemClick(position);
            }

                adapter.notifyDataSetChanged();

        }
        });
    }

    }

    public int getSelectedPosition() {
        return mClickedPosition;
    }

    /*********************************************************
     * Listener Interface
     ********************************************************/
    public interface OnGridItemClickListener {
    public void onItemClick(int position);
    }

    public OnGridItemClickListener mOnGridItemClickListener = null;

    public void setOnGridItemClickListener(OnGridItemClickListener l) {
        mOnGridItemClickListener = l;
    }

    /*********************************************************
     * RadioGidViewAdapter
     *********************************************************/
    class RadioGridViewAdapter extends BaseAdapter {

    @Override
    public int getCount() {
        return mItems.length;
    }

    @Override
    public Object getItem(int position) {
        return mItems[position];
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        if (convertView == null) {
        convertView = new ImageView(mContext);
        }

        iv_items[position] = (ImageView) convertView;
        iv_items[position].setImageResource(mItems[position]);

        return convertView;
    }

    }
} 
```

然后，像这样在活动中使用它。

```
public class RadioGridActivity extends Activity {

    private int[] mItems = {
        R.drawable.gv_img_01, 
        R.drawable.gv_img_02, 
        R.drawable.gv_img_03, 
        R.drawable.gv_img_04
    };

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        final RadioGridView rgv = new RadioGridView(this, mItems);
        setContentView(rgv);

        rgv.setOnGridItemClickListener(new OnGridItemClickListener() {

        @Override
        public void onItemClick(int position) {

        Toast.makeText(RadioGridActivity.this, "pos=" + position, 0).show();
        }
    });

    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T09:11:26.420

我编辑我的代码。RadioGridView 应该像这样更改...

因为上面代码中没有刷新Gridview中的第一项。

背景 mItemsBg 应该是第一次设置的......嗯......

```
public class RadioGridView extends LinearLayout {

    private int mClickedPosition = -1;

    private Context mContext;

    private int[] mItems;
    private int[] mItemsBg;
    private ImageView[] iv_items;

    RadioGridViewAdapter adapter;

    public RadioGridView(Context context, int[] items) {
        super(context);

        this.mContext = context;
        this.mItems = items;

        init();
    }

    private void init() {

    if (mItems != null) {
        iv_items = new ImageView[mItems.length];

        mItemsBg = new int[mItems.length];
        for (int i = 0; i < mItems.length; i++) {
        mItemsBg[i] = Color.WHITE;
        }

        GridView gv = new GridView(mContext);
        addView(gv);

        gv.setBackgroundColor(0xffffffff);
        gv.setColumnWidth(50);
        gv.setNumColumns(GridView.AUTO_FIT);
        gv.setVerticalSpacing(10);
        gv.setHorizontalSpacing(10);
        gv.setStretchMode(GridView.STRETCH_COLUMN_WIDTH);
        gv.setGravity(Gravity.CENTER);

        adapter = new RadioGridViewAdapter();
        gv.setAdapter(adapter);

        gv.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
            int position, long id) {

            if (mClickedPosition >= 0) {
            mItemsBg[mClickedPosition] = Color.WHITE;
            }
            mItemsBg[position] = Color.RED;
            mClickedPosition = position;

            adapter.notifyDataSetChanged();

            if (mOnGridItemClickListener != null) {
            mOnGridItemClickListener.onItemClick(position);
            }

        }
        });

    }

    }

    /*********************************************************
     * Listener Interface
     ********************************************************/
    public interface OnGridItemClickListener {
         public void onItemClick(int position);
    }

    public OnGridItemClickListener mOnGridItemClickListener = null;

    public void setOnGridItemClickListener(OnGridItemClickListener l) {
         mOnGridItemClickListener = l;
    }

    /*********************************************************
     * RadioGidViewAdapter
     *********************************************************/
    class RadioGridViewAdapter extends BaseAdapter {

    @Override
    public int getCount() {
        return mItems.length;
    }

    @Override
    public Object getItem(int position) {
        return mItems[position];
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        if (convertView == null) {
            convertView = new ImageView(mContext);
        }

        iv_items[position] = (ImageView) convertView;
        iv_items[position].setImageResource(mItems[position]);
        iv_items[position].setBackgroundColor(mItemsBg[position]);

        return convertView;
    }

    }
} 
```

# sql-server-2008 - 恢复数据库 - 如何保持复制到位

> ID：11452527
> 
> 赞同：6
> 
> 时间：2012-07-12T13:07:56.273
> 
> 标签：sql-server-2008, replication

服务器 A：有两个数据库 - DB1(Publisher) 和 DB2(Subscriber)
复制目前在这两个数据库上工作正常。

服务器 B：有两个数据库 - DB1(Publisher) 和 DB2(Subscriber)
复制目前对这两个数据库工作正常。

现在，由于一些测试问题，我想将 DB1(Publisher) 的副本从 Server1 恢复到 Server2。
但我担心复制。

在 Server2 上保持复制的最佳方法是什么？

我正在考虑遵循这些步骤 -

*   从 Server1 备份数据库 DB1
*   在 DB1 上禁用所有*关联*的SQL Server 代理作业，在 Server2 上禁用 DB2
*   在第 1 步中从后面恢复 Server2 上的数据库 DB1
    （我需要选择 WITH KEEP_REPLICATION 选项吗？？）
*   在 DB1 上启用 SQL Server 代理作业，在 Server2 上启用 DB2

如果这些步骤看起来可以，请指导一下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-12T10:17:58.467

请参阅下面我如何成功恢复复制（事务复制）。

```
1 - I script everything related to that publication - so that I can create it again from those scripts if things go wrong
2 - I script all the user and permissions in the database I want to restore (if the backup comes   from a different environment/server)
3 - disable any processes that hit the database you want to restore
4 - backup the current database
5 - restore verifyonly the backup you have just created (in case you need to restore it)
6 - see if you have enough disk space
7 - check if the database is involved in replication

---------------------------------------
--> 5 - see if the database is involved in replication (transactional replication)
---------------------------------------
SELECT 
name as [Database name],
CASE is_published 
    WHEN 0 THEN 'No' 
    ELSE 'Yes' 
    END AS [Is Published],
CASE is_merge_published 
    WHEN 0 THEN 'No' 
    ELSE 'Yes' 
    END AS [Is Merge Published],
CASE is_distributor 
    WHEN 0 THEN 'No' 
    ELSE 'Yes' 
    END AS [Is Distributor],
CASE is_subscribed 
    WHEN 0 THEN 'No' 
    ELSE 'Yes' 
    END AS [Is Subscribed]
FROM sys.databases
WHERE database_id > 4
go

use DB1
go
-- at the DB1 database
declare @db sysname
select @db = 'DB1'
SELECT DATABASEPROPERTYEX ( @db, 'IsSyncWithBackup' )
--0

--change the value to TRUE
sp_replicationdboption @dbname= 'DB1',
                   @optname= 'sync with backup',
                   @value='true'

--=====================================================================================
-- THE RESTORE
-- note the backup of the tail of the transaction log alongside the restore.
-- note also the KEEP_REPLICATION option
--=====================================================================================

USE [master]
ALTER DATABASE [DB1] SET SINGLE_USER WITH ROLLBACK IMMEDIATE
BACKUP LOG [DB1] TO  DISK = N'F:\SQLBackups\UserDB\DB1\SQLAPPLON1_the_tail_log.trn' WITH     NOFORMAT, NOINIT,  NAME = N'tail log backup', NOSKIP, NOREWIND, NOUNLOAD,  STATS = 1

RESTORE DATABASE [DB1] FROM  DISK =   N'F:\SQLBackups\UserDB\DB1\SQLAPPLON1_DB1_FULL_20140909_222917.bak' 
WITH  FILE = 1,  MOVE N'DB1' TO N'E:\SQLData\DB1.mdf', 
 MOVE N'DB1_log' TO N'E:\SQLLogs\DB1_log.ldf',  
 KEEP_REPLICATION,  
 NOUNLOAD,  
 REPLACE,  STATS = 1
 go

ALTER DATABASE [DB1] SET MULTI_USER
GO
--=====================================================================================
-- THE RESTORE - FINISH
--=====================================================================================

---------------------------------------
-- set sync with backup to false (unless decided otherwise)
-- problem with this is that it slows the log reader a bit

use DB1
go
-- at the DB1 database
declare @db sysname
select @db = 'DB1'
SELECT DATABASEPROPERTYEX ( @db, 'IsSyncWithBackup' )
--1

--change the value to False
sp_replicationdboption @dbname= 'DB1',
                       @optname= 'sync with backup',
                       @value='FALSE'

-- at the DB1 database
declare @db sysname
select @db = 'DB1'
SELECT DATABASEPROPERTYEX ( @db, 'IsSyncWithBackup' )
--0

---------------------------------------
--Script to Enable/Disable Database for Replication
use master
exec sp_replicationdboption @dbname = 'DB1',
@optname = 'publish',
@value = 'True'
go

---------------------------------------
-- There were some problems
-- the backup that I needed to use to restore the DB was much older and from a different server

-- I used these two commands
-- from inside the DB1 database (in the publisher)

use DB1
go

DBCC OPENTRAN 
sp_replrestart

-- http://msdn.microsoft.com/en-us/library/ms174390.aspx

--sp_replrestart is an internal replication stored procedure and s
--hould only be used when restoring a database published in a transactional replication 
--topology as directed in the topic Strategies for 
--Backing Up and Restoring Snapshot and Transactional Replication.

--Used by transactional replication during backup and restore so that 
--the replicated data at the Distributor is synchronized with data at the Publisher. 
--This stored procedure is executed at the Publisher on the publication database.

--How if works? 
--sp_replrestart will fill NO-OP (No-Operation) transaction which will cause the 
--LSN's to increase until the log LSN matches the LSN as per Distribution database. 
--So from there-on, Logreader agent will be able to read the LSN, it is expecting.

--Note: Depending on how old the backup of the Published database which was restored, 
--it may take hours for this operation and may make the transaction log to grow big.
--and grow by gigs, until they match.

--=====================================================================================
-- THE TEST
-- I add the folowing table to the published database
-- then I add the article to the publication
-- start a snapshot
-- and check if the article is in the subscription
-- when I generated the SNAPSHOT - it only generate this ONE ARTICLE
--=====================================================================================

use DB1
go
--DROP TABLE dbo.marcelo_test

create table dbo.marcelo_test(
i int not null identity(1,1) not for replication
,the_name varchar(40) not null )

insert into marcelo_test values ('belluno')
insert into marcelo_test values ('rovigo')
insert into marcelo_test values ('feltre')
insert into marcelo_test values ('cremona')
insert into marcelo_test values ('padova')
insert into marcelo_test values ('vicenza')
insert into marcelo_test values ('venezia')

select * from dbo.marcelo_test

alter table dbo.marcelo_test
add constraint pk_marcelo primary key clustered (i) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T17:17:44.373

如果将复制数据库的备份还原到另一个服务器或数据库，则无法保留复制设置。在这种情况下，您需要在备份恢复后重新创建所有发布和订阅。请参阅[备份和恢复快照和事务复制](http://msdn.microsoft.com/en-us/library/ms152560.aspx)的策略中的*恢复复制中涉及的数据库*部分。

# c++ - 保证全局变量的正确初始化顺序

> ID：11452536
> 
> 赞同：0
> 
> 时间：2012-07-12T13:08:29.190
> 
> 标签：c++

[我已经实现了与本文](http://www.drdobbs.com/when-enum-just-isnt-enough-enumeration-c/184403955?pgno=1)类似的表示枚举可能性的自定义类：

```
// Color.h

class Color {
public:
    static const Color Red;
    static const Color Green;
    static const Color Blue;
    //...
private:
    explicit Color(int code);
    //...

    int code;
    static std::set<Color> colors;
};

// Color.cpp:

const Color Color::Red(1);
const Color Color::Green(2);
const Color Color::Blue(3);    
//... 
```

现在，当我想使用例如的实例时遇到问题`Color`：`Color::Red`在另一个翻译单元中初始化全局变量。我知道发生这种情况是因为没有定义首先初始化哪个翻译单元全局变量。如何解决初始化排序问题？

我能想到的唯一解决方案是使用漂亮的计数器。但我不知道如何在不影响枚举类语法的情况下使用它。我正在考虑将`set()`方法添加到`Color`. 然后我可以在一个漂亮的计数器中调用这个方法，比如初始化程序：

```
// Color.h

class Color {
public:
    void set(int code);
    //...
private:
    Color() { /* empty */}
    //...
};

static class ColorInitializer {
    ColorInitializer () {
        static bool initialized = false;
        if(initialized)
            return;

        Color::Red.set(1);
        Color::Green.set(1);
        Color::Blue.set(1);
        initialized = true;
    }
} colorInitializer;

// Color.cpp

const Color Color::Red;
const Color Color::Green;
const Color Color::Blue; 
```

但是我在这里看到的问题是该`set`方法可以在尚未构造的对象上调用。可以吗，还是行为未定义？如何更好地解决未定义初始化顺序的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:13:38.207

在 C++11 中（如果你负担得起的话）你可以使用扩展的常量表达式功能：

```
class Color {
public:
    static constexpr const Color Red;
    static constexpr const Color Green;
    static constexpr const Color Blue;
private:
    constexpr explicit Color(int code);
    //...
};

// Color.cpp:

constexpr Color Color::Red(1);
constexpr Color Color::Green(2);
constexpr Color Color::Blue(3);    
//... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:22:41.430

首先不要使用全局对象。相反，使用函数：

```
class Color {
public:
    static const Color &Red() {
      static const Color c( 1 );
      return c;
    }

    static const Color &Green() {
      static const Color c( 2 );
      return c;
    }

    static const Color &Blue() {
      static const Color c( 3 );
      return c;
    }
private:
    explicit Color(int code);
    //...
}; 
```

您现在可以使用这些函数来初始化其他对象；调用它们将确保调用`Color`对象的构造函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T13:29:11.100

由于您的 Color 对象是轻量级的，因此只能使用静态函数。

```
class Color {
public:
    static Color Red() { return Color(1); }
    static Color Green() { return Color(2); }
    static Color Blue() { return Color( 3 ); }
private:
    explicit Color(int code);
}; 
```

唯一的问题是您不能将这些对象传递给期望指针或非常量引用的函数（但在这种情况下，非常量引用可能无论如何都是荒谬的）。

# eclipse - 如何将战争文件部署到生产玻璃鱼服务器

> ID：11452537
> 
> 赞同：0
> 
> 时间：2012-07-12T13:08:30.537
> 
> 标签：eclipse, web-services, jakarta-ee, axis2, glassfish-3

我正在使用 Eclipse 和轴 2 框架。我做了一个网络服务。该服务运行良好，但它在本地主机上。现在我已经在我的服务器上安装了 glass fish 3.1.2。我想在那里部署我的网络服务。Eclipse 创建了一个 Project **LoginService**，在该项目下的**modules**目录下存在**.war**文件。但是当我右键单击它时，什么也没有发生。这是我所做的

 **```
I made a project in eclipse.
Created a java class which has two functions
Right click on this java file and then selected other-> web services.
Under run time i selected axis2 framework.
Click next and finish
Then click on the project and selected run on server. 
```

之后 eclipse 创建了一个名为 LoginService 的项目，在该项目下有一个 .war 文件，但是如何将它部署到我的生产服务器？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T06:46:03.203

我做的。正如我所说，首先创建动态 Web 项目，在配置部分中单击“修改”，然后选择“Axis2 Web 服务”。请务必将“动态 web 模块版本”从 3.0 更改为 2.5。然后点击完成。Eclipse 将为您创建一个项目。展开项目节点。然后在“Java Resources”下的“src”文件夹中创建一个类。我假设这是您的网络服务。完成代码后，右键单击它，然后选择 New->other->Web Services->Web Service。然后单击“Web 服务运行时：Apache 轴”并将其更改为“Apache Axis2”。然后是“服务 EAR 项目：LoginService”。这是在此阶段单击完成时 Eclipse 将创建的名称。如果没有任何问题，您的 Web 服务已部署在 glass fish 上。现在右键单击项目节点并选择“在服务器上运行”。Eclipse 将显示结果。那是给你本地机器上的服务器的。现在进入正题，如果你想在另一台机器上部署那个服务怎么办......这很简单。

记住“登录服务（服务 EAR 项目：登录服务）”。只需右键单击它，然后选择“导出->EAR 文件”。选择目的地。单击“完成”。将 EAR 文件复制到您的另一台机器上。打开玻璃鱼。单击应用程序。然后单击“部署”，然后找到您的 Ear 文件并单击完成。而已。现在您的服务已部署到另一台服务器。

或者您可以右键单击您的实际项目，选择“导出->WAR 文件”。但我只为 EAR 文件这样做。希望它也能帮助其他人**

# c# - 具有等效于 AutoFixture 'With' 的匿名值的广义 Func 包装

> ID：11452539
> 
> 赞同：3
> 
> 时间：2012-07-12T13:08:39.583
> 
> 标签：c#, unit-testing, mocking, autofixture

在基于 AutoFixture 的测试中，我试图尽可能清晰地表达以下内容：

*当我传给这个方法的`<input>`参数`x`，匿名填写其他参数，结果是……*

以工厂方法为例：-

```
class X
{
    public static X Create( Guid a, Guid b, Guid c, String x, String y); 
```

我试图表达为一系列简洁的测试：

1.  如果我通过 null for `x`，它应该抛出
2.  如果我通过 null for `y`，它应该抛出

为了表达我可以说：

```
var fixture = Fixture();
var sut = default( Func<Guid, Guid, Guid,string,X>);
sut = fixture.Get( ( Guid anonA, Guid anonB, Guid anonC, string anonY ) => 
    x =>
        X.Create( anonA, anonB, anonC, x, anonY ) );

Assert.Throws<ArgumentNullException>( () => sut( null)); 
```

对于仅略有不同的第二种情况，我需要这样做：

```
var fixture = Fixture();
var sut = default( Func<Guid, Guid, Guid,string,X> );
sut = fixture.Get( ( Guid anonA, Guid anonB, Guid anonC, string anonX ) => 
    y =>
        X.Create( anonA, anonB, anonC, anonX, y ) );
Assert.Throws<ArgumentNullException>( () => sut( null)); 
```

对于属性，`With`在 AutoFixture 中有。方法（和/或 ctor）参数是否有等价物？

PS 0\. 我不介意在这种情况下是否有必要进入“魔术”字符串 - 即，有`x`一点 be `"x"`。

PS 1\. 房间里的另一头大象是我的头撞到了`Get`AutoFixture 中的 4 倍过载 - 或者是因为我在这个环境中有一个旧版本？

PS 2.也愿意接受关于如何建模的更好建议 - 只要他们处理我希望它是方法调用而不是属性或字段的事实（并且我希望它在 AutoFixture 样式中工作）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T15:45:16.423

AutoFixture 中确实没有任何功能可以让这更容易，但我愿意接受建议。但是，我不明白您如何以强类型的方式表达类似的东西。语法会是什么样子？

但是，如果您只需要它来测试 Null Guards 的工作，您可以使用 AutoFixture.Idioms 来实现。

这是一个例子。

```
var fixture = new Fixture();
var assertion = new GuardClauseAssertion(fixture);
var method = typeof(GuardedMethodHost).GetMethod("ConsumeStringAndInt32AndGuid");
assertion.Verify(method); 
```

如果您查看[源代码，`Ploeh.AutoFixture.IdiomsUnitTest.Scenario`](https://github.com/AutoFixture/AutoFixture/blob/master/Src/IdiomsUnitTest/Scenario.cs)您会发现其他示例，但我承认这是 AutoFixture 文档记录较少的领域之一......

另一件事完全是具有很少（或没有）参数的方法比具有许多参数的方法更好，所以您是否考虑过引入参数对象？

# selenium - 系统挂起并显示消息“此页面上的脚本可能正忙，或者它可能已停止响应”

> ID：11452540
> 
> 赞同：0
> 
> 时间：2012-07-12T13:08:41.143
> 
> 标签：selenium, selenium-ide

在一个页面中，有一组组合框，单击“添加”后，似乎选择了另一组组合框。在 selenium ide 中记录用户操作时，单击第二组组合框时出现以下错误：

> 此页面上的脚本可能正忙，或者可能已停止响应。您可以停止脚本，也可以继续查看脚本是否会完成。脚本：chrome//selenium-ide/content/selenium-core/lib/sizzle.js:2

系统在此之后挂起。

可以手动完成相同的用户操作而不会出现任何问题。

但是，如果 selenium ide 窗口打开，手动完成时也会出现同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-14T08:44:56.060

如果页面有大量数据，这是正常的。发生这种情况时，您需要使用等待表达式为 webdriver 提供更多时间。隐式等待应该解决它：

```
driver = webdriver.Firefox()
driver.implictly_wait(5)
driver.get("yout page")
driver.find_elem... 
```

我希望这可以解决您的问题。

# objective-c - 在字段中列出电子邮件地址（xcode 4）

> ID：11452543
> 
> 赞同：-4
> 
> 时间：2012-07-12T13:08:52.077
> 
> 标签：objective-c, list, xcode4

我想用加号按钮创建一个字段（包含电子邮件地址列表）。此按钮打开联系人列表，当我选择联系人时，此联系人的 lemail 会在我的字段中排名。

事实上，我希望与 MFMailComposeViewController 具有相同的界面，但只是针对收件人字段。谢谢你。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:08:52.337

查找`UITableView`如何制作可以与之交互的电子邮件地址列表。要发送电子邮件，您可以使用`MessageUI`.

您需要将视图控制器设置为表视图的委托和数据源。然后覆盖`cellForRowAtIndexPath`以显示电子邮件地址并`didSelectRowAtIndexPath`打开电子邮件对话框。要发送电子邮件，您可以使用类似

```
if ([MFMailComposeViewController canSendMail])
{
    MFMailComposeViewController *mailController = [[MFMailComposeViewController alloc] init];
    [mailController setSubject:@"Subject"];
    [mailController setMessageBody:@"" isHTML:NO];
    [mailController setMailComposeDelegate:self];
    [self presentModalViewController:mailController animated:YES];
} 
```

一旦您有东西要展示，请随时返回您遇到的任何错误或具体问题。请记住，SO 不是我们为您制作免费代码的地方，但我们很乐意帮助您解决问题。

# java - 迷失在理解片段/选项卡 + 操作栏 + 滑动 (ICS)

> ID：11452544
> 
> 赞同：1
> 
> 时间：2012-07-12T13:08:52.593
> 
> 标签：java, android, android-actionbar, android-4.0-ice-cream-sandwich, swipe

我正在尝试将片段和滑动与 ActionBar 一起使用。我做了所有这些，但我不明白如何访问 listView 或片段中的按钮。

这是活动：

```
public class MainActivity extends FragmentActivity implements ActionBar.TabListener {

SectionsPagerAdapter mSectionsPagerAdapter;

ViewPager mViewPager;
private static int SCAN = 1;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mSectionsPagerAdapter = new SectionsPagerAdapter(getSupportFragmentManager());

    // Set up the action bar.
    final ActionBar actionBar = getActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

    // Set up the ViewPager with the sections adapter.
    mViewPager = (ViewPager) findViewById(R.id.pager);
    mViewPager.setAdapter(mSectionsPagerAdapter);

    //  -------------------- Swipe ----------------------- //

    // When swiping between different sections, select the corresponding tab.
    // We can also use ActionBar.Tab#select() to do this if we have a reference to the
    // Tab.
    mViewPager.setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {
        @Override
        public void onPageSelected(int position) {
            actionBar.setSelectedNavigationItem(position);
        }
    });

    // For each of the sections in the app, add a tab to the action bar.
    for (int i = 0; i < mSectionsPagerAdapter.getCount(); i++) {
        actionBar.addTab(
                actionBar.newTab()
                        .setText(mSectionsPagerAdapter.getPageTitle(i))
                        .setTabListener(this));
    }

}

// ------------------------- Methodes On du menu --------------------------- //

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

// Ecouteurs qui correspondent à chaque bouton présent dans le menu
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case R.id.menu_camera:

            // app icon in action bar clicked; go home
            Intent intent = new Intent(this, ScanBarActivity.class);
            intent.putExtra("METHODE", "SCAN");
            startActivityForResult(intent, SCAN);
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
}

// -------------------------  Methodes On des Tab ----------------------------//

public void onTabUnselected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) {
}

public void onTabSelected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) {
    mViewPager.setCurrentItem(tab.getPosition());
}

public void onTabReselected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) {
}

public class SectionsPagerAdapter extends FragmentPagerAdapter {

    public SectionsPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int i) {
        Fragment fragment = new DummySectionFragment();
        Bundle args = new Bundle();
        args.putInt(DummySectionFragment.ARG_SECTION_NUMBER, i + 1);
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public int getCount() {
        return 4;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        switch (position) {
            case 0: return getString(R.string.title_section1).toUpperCase();
            case 1: return getString(R.string.title_section2).toUpperCase();
            case 2: return getString(R.string.title_section3).toUpperCase();
            case 3: return getString(R.string.title_section4).toUpperCase();
        }
        return null;
    }
} 
```

}

DummySectionFragment ：

```
public class DummySectionFragment extends Fragment {
public DummySectionFragment() {
}

public static final String ARG_SECTION_NUMBER = "section_number";

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    Bundle args = getArguments();
    switch (args.getInt(ARG_SECTION_NUMBER)){
    case 1: 

        return inflater.inflate(R.layout.page_accueil, container, false);
    case 2:
        return inflater.inflate(R.layout.page_courses, container, false);
    case 3:

        break;
    case 4:

        break;
    }
    TextView textView = new TextView(getActivity());
    textView.setGravity(Gravity.CENTER);
    textView.setText(Integer.toString(args.getInt(ARG_SECTION_NUMBER)));
    return textView;

} 
```

}

以及 page_courses.xml 的 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:id="@+id/pageAccueil"
android:orientation="vertical" >

<RelativeLayout 
    android:id="@+id/coursesRelativePart1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:padding="5dp"
    >

    <Button
        android:id="@+id/coursesAjoutListe"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@null"
        android:drawableTop="@drawable/folder_icon"
        android:layout_alignParentRight="true" />

    <LinearLayout
        android:id="@+id/coursesLinearTexteDescr"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@id/coursesAjoutListe"
        android:orientation="vertical">

        <TextView
            android:id="@+id/textViewCoursesTitre"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:textSize="@dimen/TitleSize"
            android:text="@string/coursesTextTitre"
            android:paddingBottom="5dp"/>
        <TextView
            android:id="@+id/textViewCoursesDescr"
            android:layout_width="match_parent"
            android:layout_height="fill_parent"
            android:textSize="@dimen/TextSize"
            android:text="@string/coursesTextDescr" />

    </LinearLayout>
</RelativeLayout>

<ListView
        android:id="@+id/listViewCoursesListe"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        /> 
```

我在一个页面（关于 Fragments）中看到了 onAttach() 方法，但我不知道应该在哪里使用，或者它是否是正确的方法。我只想将一个监听器附加到按钮@+id/coursesAjoutListe 并填充我的listView @+id/listViewCoursesListe。

非常感谢:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T07:01:39.150

尝试覆盖 DummyFragment 的 onStart() 方法，并使用 getActivity().findViewById()

```
 @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        ...
    }

    @Override
    public void onStart() {
        // TODO Auto-generated method stub
        super.onStart();
        switch (args.getInt(ARG_SECTION_NUMBER)){
        case 1: 

            break;
        case 2:
            Button btncoursesAjoutListe = (Button) getActivity().findViewById(R.id.coursesAjoutListe);
            ListView lvlistViewCoursesListe = (ListView) getActivity().findViewById(R.id.listViewCoursesListe);

            btncoursesAjoutListe.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    PopulateListview(lvlistViewCoursesListe)
                }
            });
        case 3:

            break;
        case 4:

            break;
        }

    } 
```

不过有点建议.. 您可以通过不同的片段分隔页面.. 这样您就不必在所有覆盖上使用该开关。

# c++ - 为什么 pthread_exit 会抛出被省略号捕获的东西？

> ID：11452546
> 
> 赞同：15
> 
> 时间：2012-07-12T13:08:57.473
> 
> 标签：c++, exception, exception-handling, pthreads, cancellation

如果被调用的函数`pthread_create`具有以下结构

```
try{
  ...code....
  pthread_detach(pthread_self());
  pthread_exit(NULL);
}catch(...){
  std::cout<<"I am here"<<std::endl;
} 
```

为什么省略号的异常处理程序在执行时被调用`pthread_exit`？（请注意`std::exception`，例如，不会抛出）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-12T13:31:50.487

至少在 GCC 中`pthread_exit`可能会抛出一个 ___forced_unwind 异常，用于在线程退出期间展开堆栈。它不继承自`std::exception`，因此不能被视为一个。如果您确实捕获了该异常，请务必重新`throw`处理它，以便它可以完成它的工作：

```
try {
...
} catch (abi::___forced_unwind&) {
    throw;
} catch (...) {
    // whatever
} 
```

抛出异常的原因`pthread_exit`是指定永远不会返回。让它抛出保证了堆栈分配的变量的清理，并且在它的位置之后不会执行代码（除非你捕捉到展开异常......）。然而，这不是可移植的，例如 Clang 使用了完全不同的机制。

顺便说一句，这是另一个`catch (...)`成语弊大于利的情况。它有时用于“稳定”抛出未知异常的代码。但这只会将损害的可见性推迟到以后的时间和地点，从而无法确定问题的真正根源。在这种捕获中唯一合理的做法是最少的清理，可能是记录，然后重新抛出。由于未处理的异常而崩溃的进程并不是一个漂亮的景象，但它可以提供一个可调试的崩溃转储，清楚地显示错误的命令。但这只是我的怨恨，与...`catch (...)`几乎没有关系`pthread_exit`

# struts2 - 需要由 FileUploadInterceptor 创建的 Struts2 字段错误键

> ID：11452553
> 
> 赞同：2
> 
> 时间：2012-07-12T13:09:16.850
> 
> 标签：struts2, struts-validation

我正在使用 Struts2 - FileUploadInterceptor 来处理正在上传的文件的内容类型和最大大小。

为了显示错误消息，`<s:fielderror/>`显示错误消息是完美的。

我正在处理一个包含多个部分的页面，我需要显示仅属于该部分的错误消息，问题`<s:fielderror/>`是它显示所有错误消息并解决此参数将被传递，例如

```
<s:fielderror><s:param>firstName</s:param></s:fielderror> 
```

我不确定 FileUploadInterceptor 为内容类型错误和最大大小错误创建的错误键是什么，请帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:44:16.413

如果我理解正确，我认为你想做这样的事情：

```
<s:fielderror>[some reference to a content type error]</s:fielderror>
<s:fielderror>[some reference to a max size error]</s:fielderror> 
```

这样您就可以分别/不同地渲染它们。

目前这是**不可能的**，因为`<s:fielderror/>`只需要字段名称。
您不能以这种方式分隔一个字段的多个错误。

此外，查看 中方法的[源代码](http://www.docjar.com/html/api/org/apache/struts2/interceptor/FileUploadInterceptor.java.html)，首先检查最大大小，如果检查失败，则会设置错误。如果最大大小已经失败，则代码不会继续检查允许的类型。`acceptFile``FileUploadInterceptor`

```
 353           } else if (maximumSize != null && maximumSize < file.length()) {
  354               String errMsg = getTextMessage(action, "struts.messages.error.file.too.large", new Object[]{inputName, filename, file.getName(), "" + file.length()}, locale);
  355               if (validation != null) {
  356                   validation.addFieldError(inputName, errMsg);
  357               }
  358   
  359               LOG.warn(errMsg);
  360           } else if ((!allowedTypesSet.isEmpty()) && (!containsItem(allowedTypesSet, contentType))) {
  361               String errMsg = getTextMessage(action, "struts.messages.error.content.type.not.allowed", new Object[]{inputName, filename, file.getName(), contentType}, locale);
  362               if (validation != null) {
  363                   validation.addFieldError(inputName, errMsg);
  364               }
  365   
  366               LOG.warn(errMsg);
  367           } 
```

因此，您一次应该只得到其中一个错误。

# java - Richfaces 特殊代码

> ID：11452557
> 
> 赞同：0
> 
> 时间：2012-07-12T13:09:35.787
> 
> 标签：java, firefox, jsf, richfaces, opera

我必须使用`rich:combobox`来显示一个组合。
在某些情况下，我必须添加一个空的`comboboxItem = new SelectItem("","")`.
这在 IE8、Chrome、Safari 上运行良好。
它`&nbsp;`用FF和Opera编写。
查看richfaces代码，我看到了带有一段奇怪代码 的类`ComboBoxBaseRenderer`、方法：`getItems`

```
if("".equals(convertedValue)) {
 convertedValue = "\u00A0";
} 
```

似乎 FF 和 Opera 将`\u00A0`其视为真正的空白字符并将其转换为空白空间。
这怎么可能解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:56:27.633

从 JavaScript 的角度来看，Opera 和 Firefox 就在这里。

由 ECMAScript 5.1 第 7.2 节定义的[空白](http://ecma-international.org/ecma-262/5.1/#sec-7.2)

```
\u0009  Tab <TAB>
\u000B  Vertical Tab    <VT>
\u000C  Form Feed   <FF>
\u0020  Space   <SP>
\u00A0  No-break space  <NBSP>
\uFEFF Other category “Zs” Byte Order Mark Any other Unicode “space separator”  <BOM> <USP> 
```

[HTML 4 定义的空格](http://www.w3.org/TR/html4/struct/text.html#whitespace)（已弃用）

```
ASCII space (&#x0020;)
ASCII tab (&#x0009;)
ASCII form feed (&#x000C;)
Zero-width space (&#x200B;) 
```

[HTML5 定义的空格字符](http://dev.w3.org/html5/spec/common-microsyntaxes.html#space-character)

```
U+0020 SPACE, 
"tab" (U+0009), 
"LF" (U+000A), 
"FF" (U+000C), 
"CR" (U+000D). 
```

# c# - 嵌套产生返回 IEnumerable > 惰性求值

> ID：11452559
> 
> 赞同：13
> 
> 时间：2012-07-12T13:09:37.663
> 
> 标签：c#, .net, linq, ienumerable, lazy-evaluation

我写了一个`SplitBetween`类似于`String.Split`.

```
> new List<int>(){3,4,2,21,3,2,17,16,1}
> .SplitBetween(x=>x>=10)

[3,4,2], [3,2], [], [1] 
```

资源：

```
// partition sequence into sequence of contiguous subsequences
// behaves like String.Split
public static IEnumerable<IEnumerable<T>> SplitBetween<T>(this IEnumerable<T> source, 
                                                          Func<T, bool> separatorSelector, 
                                                          bool includeSeparator = false)
{
    var l = new List<T>();
    foreach (var x in source)
    {
        if (separatorSelector(x))
        {
            if (includeSeparator)
            {
                l.Add(x);
            }
            yield return l;
            l = new List<T>();
        }
        else
        {
            l.Add(x);
        }
    }
    yield return l;
} 
```

本着 LINQ 的精神，我认为这种方法应该做惰性求值。但是，**我的实现对外部 IEnumerable 进行惰性评估，而*不是对内部 IEnumerable***进行惰性评估。我怎样才能解决这个问题？

外部行为如何是惰性的演示。Assume`ThrowingEnumerable<int>`是一个`IEnumerable<int>`当任何人试图迭代它时会爆炸的（参见 Skeet 的 Edulinq）。

```
(new List<int>(){1,2,3,10,1})
.Concat(Extensions.ThrowingEnumerable<int>())
.SplitBetween(x=>x>=10)
.First().ToList();

[1,2,3] 
```

但内心的行为*并不懒惰*

```
(new List<int>(){1,2,3,10,1})
.Concat(Extensions.ThrowingEnumerable<int>())
.SplitBetween(x=>x>=10)
.ElementAt(2).First();

BOOM 
```

我们在这里期望 1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T23:45:58.700

**编辑：**你的方法没有任何问题，除了当你枚举它时抛出的枚举会真正“繁荣”。这就是它的意义所在。它没有适当的`GetEnumerator`定义。所以你的代码没有真正的问题。在第一种情况下`First`，您只是枚举直到获得第一个结果集（just `{ 1, 2, 3 }` ），而不是枚举抛出的可枚举（这意味着`Concat`没有被执行）。但是在第二个示例中，您在`2`拆分后要求元素，这意味着它也会枚举投掷可枚举并且会“繁荣”。这里的关键是要理解`ElementAt` **枚举集合**直到索引被要求并且不是天生的懒惰（它不能）。

我不确定是否完全懒惰是去这里的方式。问题在于，将惰性拆分为外部序列和内部序列的整个过程在一个枚举器上运行，该枚举器可以根据枚举器状态产生不同的结果。例如，您仅枚举外部序列，内部序列不再是您所期望的。或者如果只枚举一半的外序列和一个内序列，那么其他内序列的状态会是什么？你的方法是最好的。

下面的方法是惰性的（仍然会繁荣，因为这是有保证的），因为它不使用中间的具体实现，**但可能比您的原始方法慢，因为它不止一次遍历列表**：

```
public static IEnumerable<IEnumerable<T>> SplitBy<T>(this IEnumerable<T> source, 
                                                     Func<T, bool> separatorPredicate, 
                                                     bool includeEmptyEntries = false,
                                                     bool includeSeparators = false)
{
    int prevIndex = 0;
    int lastIndex = 0;
    var query = source.Select((t, index) => { lastIndex = index; return new { t, index }; })
                      .Where(a => separatorPredicate(a.t));
    foreach (var item in query)
    {
        if (item.index == prevIndex && !includeEmptyEntries)
        {
            prevIndex++;
            continue;
        }

        yield return source.Skip(prevIndex)
                           .Take(item.index - prevIndex + (!includeSeparators ? 0 : 1));
        prevIndex = item.index + 1;
    }

    if (prevIndex <= lastIndex)
        yield return source.Skip(prevIndex);
} 
```

**总的来说，你原来的方法是最好的。如果您需要完全懒惰的东西，那么我的以下答案很合适。**请注意，它仅适用于以下情况：

```
foreach (var inners in outer)
    foreach (var item in inners)
    { 
    } 
```

并不是

```
var outer = sequence.Split;
var inner1 = outer.First;
var inner2 = outer.ElementAt; //etc 
```

**换句话说，不适合在同一内部序列上进行多次迭代。如果您完全意识到这种危险的构造**：

* * *

## 原答案：

这不使用中间具体集合，不`ToList`使用源可枚举，并且完全是惰性/迭代器：

```
public static IEnumerable<IEnumerable<T>> SplitBy<T>(this IEnumerable<T> source,
                                                     Func<T, bool> separatorPredicate,
                                                     bool includeEmptyEntries = false,
                                                     bool includeSeparator = false)
{
    using (var x = source.GetEnumerator())
        while (x.MoveNext())
            if (!separatorPredicate(x.Current))
                yield return x.YieldTill(separatorPredicate, includeSeparator);
            else if (includeEmptyEntries)
            {
                if (includeSeparator)
                    yield return Enumerable.Repeat(x.Current, 1);
                else
                    yield return Enumerable.Empty<T>();
            }
}

static IEnumerable<T> YieldTill<T>(this IEnumerator<T> x, 
                                   Func<T, bool> separatorPredicate,
                                   bool includeSeparator)
{
    yield return x.Current;

    while (x.MoveNext())
        if (!separatorPredicate(x.Current))
            yield return x.Current;
        else
        {
            if (includeSeparator)
                yield return x.Current;
            yield break;
        }
} 
```

简短，甜蜜和简单。我添加了一个附加标志来表示是否要返回空集（默认情况下它会忽略）。没有那个标志，代码就更简洁了。

感谢您提出这个问题，这将在我的扩展方法库中！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T06:09:29.290

这个不会使用`List<>`，也不会 BOOM。

```
public static IEnumerable<IEnumerable<T>> SplitBetween<T>(this IEnumerable<T> source,
                                                          Func<T,bool> separatorSelector, 
                                                          bool includeSeparators=false) 
{
    if (source == null)
        throw new ArgumentNullException("source");

    return SplitBetweenImpl(source, separatorSelector, includeSeparators);
}

private static IEnumerable<T> SplitBetweenInner<T>(IEnumerator<T> e,
                                                   Func<T,bool> separatorSelector)
{
    var first = true;

    while(first || e.MoveNext())
    {
        if (separatorSelector((T)e.Current))
            yield break;    

        first = false;
        yield return e.Current;
    }
}

private static IEnumerable<IEnumerable<T>> SplitBetweenImpl<T>(this IEnumerable<T> source,
                                                               Func<T,bool> separatorSelector, 
                                                               bool includeSeparators) 
{
    using (var e = source.GetEnumerator())
        while(e.MoveNext())
        {
            if (separatorSelector((T)e.Current) && includeSeparators)
                yield return new T[] {(T)e.Current};
            else
                {
                yield return SplitBetweenInner(e, separatorSelector);
                if (separatorSelector((T)e.Current) && includeSeparators)
                    yield return new T[] {(T)e.Current};
                }
        }
} 
```

* * *

**测试：**

```
void Main()
{
    var list = new List<int>(){1, 2, 3, 10, 1};
    foreach(var col in list.Concat(Ext.ThrowingEnumerable<int>())
                           .SplitBetween<int>(x=>x>=10).Take(1))
    {
        Console.WriteLine("------");
        foreach(var i in col)
            Console.WriteLine(i);
    }
} 
```

**输出：**

```
------
1
2
3 
```

* * *

**测试2**

```
var list = new List<int>(){1, 2, 3, 10, 1}
foreach(var col in list.Concat(Ext.ThrowingEnumerable<int>())
                       .SplitBetween<int>(x=>x>=10).Take(2)) 
```

**输出：**

```
------
1
2
3
------
1
*Exception* 
```

在这里，异常是因为`ThrowingEnumerable`-enumeration 的第一个元素将与`1`.

* * *

**测试3：**

```
var list = new List<int>(){1, 2, 3, 10, 1, 17};
foreach(var col in list.Concat(Ext.ThrowingEnumerable<int>())
                       .SplitBetween<int>(x=>x>=10, true).Take(4)) 
```

**输出：**

```
------
1
2
3
------
10
------
1
------
17 
```

这里没问题，因为*Exception*元素会进入它自己的组，因此不会被迭代，因为`Take(4)`：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T00:30:23.197

这是一个我认为可以满足您要求的解决方案。

问题是您只有一种带有产量的方法，并且您在枚举外部集合**时手动创建内部集合。**`IEnumerable`第二个问题是你的“测试”方式甚至在我下面的代码上也失败了。但是，正如 David B 在他的评论中指出的那样，您**必须**遍历所有元素来定义 external 元素的数量`IEnumerable`。但是您可以推迟内部`IEnumerable`s 的创建和填充。

```
public static IEnumerable<IEnumerable<T>> SplitBetween<T>(this IEnumerable<T> source,Func<T,bool> separatorSelector, bool includeSeparators=false)
{
    IList<T> sourceList = source.ToList();
    var indexStart = 0;
    var indexOfLastElement = sourceList.Count - 1;
    for(int i = 0; i <= indexOfLastElement; i++)
        if (separatorSelector(sourceList[i]))
        {
            if(includeSeparators)
                yield return SplitBetweenInner(sourceList, indexStart, i);
            else
                yield return SplitBetweenInner(sourceList, indexStart, i - 1);

            indexStart = i + 1;
        }
        else if(i == indexOfLastElement)
            yield return SplitBetweenInner(sourceList, indexStart, i);        
}

private static IEnumerable<T> SplitBetweenInner<T>(IList<T> source, int startIndex, int endIndex)
{
    //throw new Exception("BOOM");
    for(int i = startIndex; i <= endIndex; i++)
        yield return source[i];
} 
```

请注意，它的行为与您的代码略有不同（当最后一个元素满足分隔符条件时，它不会创建另一个空列表 - 它取决于此处的正确定义，但我发现更好，因为行为与元素出现在源列表的开头）

如果您测试代码，您将看到内部`IEnumerable`执行被延迟。

如果抛出异常行未注释：

```
(new List<int>(){3,4,2,21,3,2,17,16,1}).SplitBetween(x=>x>=10, true).Count(); 
```

返回`4`

```
(new List<int>(){3,4,2,21,3,2,17,16,1}).SplitBetween(x=>x>=10, true).First().Count(); 
```

投掷`BOOM`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T01:19:51.310

```
 public static IEnumerable<IEnumerable<T>> SplitBetween<T>(this IEnumerable<T> source, Func<T, bool> separatorSelector, bool includeSeparators = false)
  {
    var state = new SharedState<T>(source, separatorSelector, includeSeparators);
    state.LastList = state.NewList  = new InnerList<T>(state, 0);
    for (; ; )
    {
      if (state.NewList != null)
      {
        var newList = state.NewList;
        state.NewList = null;
        yield return newList.Items();            
      }
      else if (state.IsEnd)
        break;
      else
        state.CheckNext();
    }
  }
  class SharedState<T>
  {
    public SharedState(IEnumerable<T> source, Func<T, bool> separatorSelector, bool includeSeparators)
    {
      this.source = source;
      this.separatorSelector = separatorSelector;
      this.includeSeparators = includeSeparators;

      this.iterator = source.GetEnumerator();

      this.data = source as IList<T>;
      if (data == null)
      {
        cache = new List<T>();
        data = cache;
      }
    }
    public readonly IEnumerable<T> source;
    readonly IEnumerator<T> iterator; 
    public readonly IList<T> data;
    readonly List<T> cache;
    public readonly Func<T, bool> separatorSelector;
    public readonly bool includeSeparators;
    public int WaveIndex = -1;
    public bool IsEnd = false;
    public InnerList<T> NewList;
    public InnerList<T> LastList;

    public void CheckNext()
    {
      WaveIndex++;
      if (!iterator.MoveNext())
      {
        if (LastList.LastIndex == null)
          LastList.LastIndex = WaveIndex;
        IsEnd = true;
      }
      else
      {
        var item = iterator.Current;
        if (cache != null)
          cache.Add(item);
        if (separatorSelector(item))
        {
          LastList.LastIndex = includeSeparators ? WaveIndex + 1 : WaveIndex;
          LastList = NewList = new InnerList<T>(this, WaveIndex + 1);
        }
      }
    }
  }

  class InnerList<T>
  {
    public InnerList(SharedState<T> state, int startIndex)
    {
      this.state = state;
      this.StartIndex = startIndex;
    }
    readonly SharedState<T> state;
    public readonly int StartIndex;
    public int? LastIndex;

    public IEnumerable<T> Items()
    {
      for (var i = StartIndex; ; ++i)
      {
        if (LastIndex != null && i >= LastIndex)
          break;
        if (i >= state.WaveIndex)
          state.CheckNext();
        if (LastIndex == null || i < LastIndex)
          yield return state.data[i];
      }
    }
  } 
```

# php - ImageMagick 和使用 PHP 上传的文件

> ID：11452568
> 
> 赞同：1
> 
> 时间：2012-07-12T13:10:04.430
> 
> 标签：php, imagemagick

我正在使用 PHP 处理上传图像文件，然后使用 ImageMagick 创建图像的缩略图。

**问题：**我应该如何向 Imagemagick 提供源文件和目标文件的路径？

我给出了源文件的位置，`$_FILES['photo']['tmp_name'];`结果类似于

```
/tmp/php2c3dCg 
```

对于目标文件，我必须提供完整路径，例如

```
/home/mywebsite/public_html/public/img/posts/thumbnail/1087_1174cc2995db2a19472da1bbf1665e94b5121246.jpg 
```

**问题**

1.  我是否必须提供目标图像的完整路径？在 Imagemagick 网站上的示例中，它使用了`convert dragon.gif -resize 64x64 resize_dragon.gif`. 当我尝试`convert /tmp/php2c3dCg -thumbnail 220x220^ -gravity center -extent 220x220 -quality 90 /home/mywebsite/public_html/public/img/posts/thumbnail/1087.jpg`它似乎工作。我怎样才能缩短它？

2.  `/tmp/php2c3dCg`位于根而不是`public_html`? 我没有看到 中的文件夹`public_html`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:26:57.523

### 1.

您可以使用相对于工作目录的路径。如果您使用的是 PHP `exec()`，则工作目录是包含 PHP 脚本的目录。但是绝对路径有什么问题，您的脚本不在乎它们是否很长，并且它是一个较少的问题来源。

### 2.

是的，它在系统的临时目录中。这是 PHP 放置用户上传文件的地方。它们在处理请求后被删除，因此如果您想保留它，您需要复制/处理它并将其保存在其他地方。

# java - 删除旧的 .lck 文件

> ID：11452569
> 
> 赞同：0
> 
> 时间：2012-07-12T13:10:05.183
> 
> 标签：java, linux

我最近不得不在我们公司担任系统管理员。我有一些 Linux/Unix 知识，但还不足以适应这个地方，但这只是问题的一部分。

我必须管理的其中一台服务器的磁盘空间严重短缺。现在我知道有各种 Web 服务编写它们的日志，以及每个日志包含的内容。然而，这些日志没有明确定义的约会机制。其中一些只包含几个月或几周的日志，一些包含一年的日志。

最糟糕的是，它们都有一个 .lck 文件。现在我可以看到，只有最近（今天）修改过的文件，这似乎是当前文件。

**我的问题是，尝试删除旧日志文件的 .lck 文件并将它们归档是否安全？**

日志文件由 Java 和 log4j 在 CentOS 服务器上创建。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:45:58.270

*我会争辩说，关于安全的问题纯粹是*学术问题——如果空间如此严重短缺，那么迟早会失败。无论喜欢与否，*都*需要清理这些文件。如果安全是绝对关键的，那么利用任何冗余基础设施或安排一些维护时间来取消各种服务可能是有意义的，以便在晚上来电之前处理这个问题。

我首先建议通过所有服务器和应用程序并启用任何本机支持的日志轮换方案，例如[log4j](https://stackoverflow.com/q/1050256/507519)。

其余的则需要建立一个外部日志轮换系统，例如将日志使用`logrotate`的`cron`空间保持在合理的大小。那么日志文件和对应的服务应该观察一段时间，寻找意想不到的缺陷，比如：

*   删除后仍在使用的日志文件

*   重新创建文件后在某个随机偏移处继续写入的应用程序

*   刚刚中断的应用程序。

*   ...

# jasper-reports - 使用 JasperReports 生成 csv

> ID：11452576
> 
> 赞同：0
> 
> 时间：2012-07-12T13:10:26.130
> 
> 标签：jasper-reports

我**必须**用 JasperReports 生成一个简单的 csv 文件。

执行此操作的最简单的 jrxml 文件是哪个？

我试过这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport 
xmlns="http://jasperreports.sourceforge.net/jasperreports" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports  http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" 
name="report5a" 
language="groovy">

<field name="col1" class="java.lang.String"/>
<field name="col2" class="java.lang.Integer"/>
<field name="col3" class="java.lang.Integer"/>
<field name="col4" class="java.lang.String"/>
<detail>
    <band height="16">
        <textField>
            <reportElement x="0" y="0" width="1000" height="15"/>
            <textFieldExpression><![CDATA[$F{col1}]]></textFieldExpression>
        </textField>
        <textField>
            <reportElement x="1000" y="0" width="1000" height="15"/>
            <textFieldExpression><![CDATA[$F{col2}]]></textFieldExpression>
        </textField>
        <textField>
            <reportElement x="2000" y="0" width="1000" height="15"/>
            <textFieldExpression><![CDATA[$F{col3}]]></textFieldExpression>
        </textField>
        <textField>
            <reportElement x="3000" y="0" width="1000" height="15"/>
            <textFieldExpression><![CDATA[$F{col4}]]></textFieldExpression>
        </textField>
    </band>
</detail>
</jasperReport> 
```

它正在工作，但为什么我必须提供宽度或高度参数？？？如果 x 和 width 属性太低，那么值将被削减。例如，如果所有的值（前面提到的）除以 1000，那么结果将只包含 4 个字符。

想法？

谢谢

佐姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T21:31:20.227

JasperReports 当然可以生成 CSV 文件。但如果这是您唯一的目标，那么还有比 JR 更好的选择。它比您需要的要大得多。

为了避免像现在这样设置愚蠢的宽度，您应该设置属性[net.sf.jasperreports.print.keep.full.text](http://jasperforge.org/uploads/publish/jasperreportswebsite/trunk/config.reference.html#net.sf.jasperreports.print.keep.full.text)。

编辑：设置该属性后，您的字段宽度可以是任何正值。您无需担心使它们足够宽以容纳文本而无需换行。

# c# - 将参数传递给委托c#

> ID：11452578
> 
> 赞同：5
> 
> 时间：2012-07-12T13:10:28.350
> 
> 标签：c#, delegates

我有一个问题，我希望将函数调用添加到委托，但是这些函数调用中的每一个都将具有唯一的参数。我无法弄清楚或在其他地方找到解决方案，所以我转向你们:)

下面的一些伪..

（所以基本上，我正在创建一个委托和一个事件，并且 AddToDelegate 函数应该将函数调用添加到事件（具有唯一值），然后 GetData 函数在一个字符串中返回所有响应 -*问题出在作为行的 AddToDelegate 函数`a += new A(SomeFunc)(i.ToString());`实际上应该只是 a`+= new A(SomeFunc);`* )

有没有办法与代表一起做到这一点 - 还是我在叫错树？

```
public delegate string A(string s);
public event A a;

public void AddToDelegate()
{
    for (int i = 0; i < DelegateList.Length; i++)
    {
        a += new A(SomeFunc)(i.ToString());
    }
}

public string GetData()
{
    StringBuilder _sb = new StringBuilder();
    if (a != null)
    {
        Delegate[] DelegateList = a.GetInvocationList();
        for (int i = 0; i < DelegateList.Length; i++)
        {
            _sb.Append(((A)DelegateList[i]));
        }
    }
    return _sb.ToString();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:35:01.487

不确定你真正想要什么，但你可以使用一个匿名函数，将这个额外的变量保存在它的范围内：

```
a += new A( s => { 
    string extra_value = i.ToString();
    return SomeFunc(s, extra_value);
  }); 
```

可以简化为：

```
a += s => SomeFunc(s, i.ToString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:47:51.840

是的，您可以通过[labda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)和[闭包](https://stackoverflow.com/questions/595482/what-are-closures-in-c)来做到这一点。

下面的示例将创建添加委托到 a ，该委托将在循环时使用 i 的值调用 SomeFunc。需要该变量`capture`来确保捕获正确的值 - 请参阅[如何告诉 lambda 函数捕获副本而不是 C# 中的引用？](https://stackoverflow.com/questions/451779/how-to-tell-a-lambda-function-to-capture-a-copy-instead-of-a-reference-in-c)

```
public event Action<string> a;

public void AddToDelegate()
{
    for (int i = 0; i < DelegateList.Length; i++)
    {
        int capture = i;
        a += () => SomeFunc(capture.ToString());
    }
}

public string GetData()
{
    StringBuilder _sb = new StringBuilder();
    if (a != null)
    {
        Delegate[] DelegateList = a.GetInvocationList();
        for (int i = 0; i < DelegateList.Length; i++)
        {
            _sb.Append((Action<string>)DelegateList[i]());
        }
    }
    return _sb.ToString();
} 
```

# python - 编辑许多文本文件的脚本

> ID：11452579
> 
> 赞同：3
> 
> 时间：2012-07-12T13:10:28.490
> 
> 标签：python, bash, scripting

我有一个 c++ 程序，它生成许多数据文件，每个文件都包含三列。现在，在这些数据文件中的每一个中，第三列都会有一些异常条目`-nan`。如何编写脚本以打开这些数据文件中的每一个并找到第三列具有的`nan`所有行并删除所有这些行？是否可以在 bash 或 python 中编写一个可以做到这一点的脚本？例子：

```
100   0.1    15.8334
100   0.2    16.7895
100   0.3     -nan
100   0.4    15.8543
100   0.5      -nan 
```

在这个文件中，我希望删除第 3 行和第 5 行，以便我的文件看起来像

```
100   0.1    15.8334
100   0.2    16.7895
100   0.4    15.8543 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:14:58.203

像（在bash中）这样的东西：

```
for file in files ;do
  grep -v -- -nan file > file.$$ && mv file.$$ file
done 
```

不过可能应该在代码中清理它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:23:05.680

```
sed -i -e '/-nan/d' datafile.txt 
```

要对多个文件进行操作，可以将“datafile.txt”替换为匹配所有文件的 glob，或使用 for 循环

```
for file in data1.txt data2.txt data3.txt; do
    sed -i -e '/-nan/d' $file
done 
```

或者`find`命令：

```
find . -name "data*.txt" -exec sed -i -e '/-nan/d' {} + 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:15:17.733

这是基本机制：

```
with open('yourfile.txt') as fin, open('yourfile_output.txt', 'w') as fout:
    for line in fin:
        try:
            c1, c2, c3 = line.split()
            if c3 != '-nan':
                fout.write(line)
        except ValueError as e:
            pass # Handle cases where number of cols != 3 
```

然后把它放在一个函数中并使用 glob.iglob 来重新输入匹配文件名的列表并循环......

另一个可能的选择只是为了完整性：

```
from math import isnan

with open('yourfile.txt') as fin, open('yourfile_output.txt', 'w') as fout:
    for line in fin:
        try:
            c1, c2, c3 = map(float, line.split())
            if not isnan(c3):
                fout.write(line)
        except ValueError as e:
            pass # Handle cases where number of cols != 3 
```

# sql - SQL选择查询到删除语句

> ID：11452580
> 
> 赞同：0
> 
> 时间：2012-07-12T13:10:38.890
> 
> 标签：sql

我有以下查询：

```
select acc.Username from accounts acc
left join accountevents ace on acc.accountid=ace.accountid
left join leads lds on lds.leadid=acc.leadid
where lds.DateEntered>'2011-01-01' and lds.DateEntered<'2011-02-01'
Group by acc.Username
Having count(ace.accounteventid)=0 
```

我想让它成为一个删除语句：

```
delete username from accounts 
left join accountevents ace on accounts.accountid=ace.accountid 
left join leads lds on lds.leadid=accounts.leadid
where Leads.DateEntered>'2011-01-01' and lds.DateEntered<'2011-02-01' 
Having count(accountevents.accounteventid)=0 
```

我收到以下错误：关键字“Having”附近的语法不正确。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T13:13:00.987

我认为您应该按照以下方式重写它：

```
delete from accounts where username in ( <here goes your select statement> ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:39:49.163

从选择查询中可以看出，表accounts 与表accountevents 和leads 有关系。所以首先你必须从子表或外键表和主表中删除记录。如果您`DELETE Rule to CASCADE`在数据库设计或表中设置了 ，请运行此查询。

```
DELETE FROM [TableName] where UserName ='UserName'   -- TableName should be your primary table it may be Accounts or AccountsEvents or Leads 
```

如果您没有在数据库设计中设置删除规则，那么您必须运行三个查询。首先从子表中删除数据，然后从父表中删除数据。

```
Delete from accounts where username = 'name'
Delete from eventsaccounts where accountid = 'accountsid'
Delete from leads where leadid = 'leadid' 
```

# java - SqlResultSetMapping 列作为和实体

> ID：11452586
> 
> 赞同：8
> 
> 时间：2012-07-12T13:11:06.487
> 
> 标签：java, jpa, entities, sqlresultsetmapping

我真的很困惑，列结果集映射如何工作？当我使用列而不是实体时，我在映射什么？看看这个例子...

```
Query q = em.createNativeQuery(
       "SELECT o.id AS order_id, " +
           "o.quantity AS order_quantity, " +
           "o.item AS order_item, " + 
           "i.name AS item_name, " +
         "FROM Order o, Item i " +
         "WHERE (order_quantity > 25) AND (order_item = i.id)",
       "OrderResults");

   @SqlResultSetMapping(name="OrderResults",
       entities={
           @EntityResult(entityClass=com.acme.Order.class, fields={
               @FieldResult(name="id", column="order_id"),
               @FieldResult(name="quantity", column="order_quantity"),
               @FieldResult(name="item", column="order_item")})},
       columns={
           @ColumnResult(name="item_name")}
       ) 
```

我可以理解他在这里试图做什么，实体结果将是他想要的结果集，字段将尝试将字段映射到别名，列结果到底在做什么？看起来它没有映射到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-05T14:09:09.627

您将结果集中的 4 个字段映射到 2 个 Java 类：第一个类是 Order 实体，第二个是（可能）应包含“item_name”db 字段的字符串。

```
DB:                         Java
---                         ----
order_id              --->  \
order_quantity        --->  Order entity
order_item            --->  /
item_name             --->  String 
```

为了读取查询结果：

```
for (Object[] record : query.getResultList()) {
   Order order = (Order)record[0];
   String itemName = (String)record[1];
} 
```

# html - 带有嵌套不可编辑标签的换行符和 contenteditable

> ID：11452590
> 
> 赞同：6
> 
> 时间：2012-07-12T13:11:19.457
> 
> 标签：html, contenteditable

我对`contenteditable`HTML 中的元素有一个奇怪的情况。我们有一个富文本编辑器，客户可以将预制模板（由我们）加载到其中，然后可以根据需要（大部分）修改该模板。

我们的部分模板已被标记为不可直接编辑，但仍可以删除等。但是，当一个这样的元素是一行中的第一个元素（直接在`<br/>`标签之后）并且用户命中`DEL`以上行。因为它`contenteditable=false`，浏览器似乎删除的不是整个不可编辑的跨度，`<br/>`而是整个不可编辑的跨度。

示例 HTML 是这样的

```
<div contenteditable=true>
    <span>blah blah blah</span><br/>
    <span contenteditable="false">You cant edit this value directly</span>
</div> 
```

如果用户将光标放在`blah blah blah`, 之后并点击`DEL`整个下一个可编辑内容，则删除，而不是换行符。

有没有办法，javascript或其他方式来解决这个问题？

我已经尝试检测光标位置（使用 rangy）和插入临时空格等，但我似乎无法让它具有所需的行为，这只是不可编辑的标签被带到上一个线。

我们将编辑器的使用仅限于 Chrome，因此无需担心 IE 或 FF。

[一个例子的jsfiddle](http://jsfiddle.net/HgRsF/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T21:03:20.410

制作每个 span `contenteditable`，然后用户将无法删除您不想编辑的 span，并摆脱可编辑的 div 。

这是我的 JSFiddle 版本：http: [//jsfiddle.net/howderek/HgRsF/2/](http://jsfiddle.net/howderek/HgRsF/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-18T14:35:00.673

这个问题是从 2012 年开始的，从那时起，这个问题就得到了修复，嵌套`contenteditable`标签按预期工作。[像这个错误](https://code.google.com/p/chromium/issues/detail?id=238000)仍然存​​在一些问题，但总的来说该功能应该是可用的。

# java - System.nanoTime() 的精度与精度

> ID：11452597
> 
> 赞同：25
> 
> 时间：2012-07-12T13:11:43.483
> 
> 标签：java, nanotime

文档[`System.nanoTime()`](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#nanoTime())说明如下（强调我的）。

> 此方法只能用于测量经过的时间，与系统或挂钟时间的任何其他概念无关。返回的值表示自某个固定但任意时间以来的纳秒（可能在将来，因此值可能为负数）。**此方法提供纳秒精度，但不一定提供纳秒精度。**不保证值的变化频率。

在我看来，这可以用两种不同的方式来解释：

1.  上面粗体**字**是指单独的返回值。然后，精度和准确度要从数字的意义上来理解。也就是说，精度是指有效数字的个数——截断的位置，而精度是数字是否正确（比如这里的顶部答案中描述的 ['precision'和'accuracy'有什么区别？](https://stackoverflow.com/questions/8270789/what-is-the-difference-between-precision-and-accuracy)）

2.  上面粗体**字**是指方法本身的能力。然后，精度和准确性将被理解为飞镖类比（[http://en.wikipedia.org/wiki/Precision_vs._accuracy#Accuracy_versus_precision:_the_target_analogy](http://en.wikipedia.org/wiki/Precision_vs._accuracy#Accuracy_versus_precision:_the_target_analogy)）。所以，低精度，高精度 => 错误的值被重复命中，精度很高：想象物理时间静止，连续调用 nanoTime() 返回相同的数值，但它与实际经过的时间不同，因为参考时间由一些*恒定*的偏移量。

哪种解释是正确的？我的观点是，解释 2 意味着使用 nanoTime() 测量时间*差*（通过减去两个返回值）将正确到纳秒（因为测量中的恒定误差/偏移将被消除），而解释 1 将'不能保证测量之间的这种一致性，因此不一定意味着时差测量的高精度。

* * *

**2013 年 4 月 15 日更新：** Java 7 文档[`System.nanoTime()`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#nanoTime())已更新，以解决可能与之前的措辞混淆的问题。

> 返回正在运行的 Java 虚拟机的高分辨率时间源的当前值，以纳秒为单位。
> 
> 此方法只能用于测量经过的时间，与系统或挂钟时间的任何其他概念无关。返回的值表示自某个固定但任意的*原始*时间以来的纳秒（可能在将来，因此值可能为负数）。在 Java 虚拟机实例中，此方法的所有调用都使用相同的来源；其他虚拟机实例可能使用不同的来源。
> 
> 此方法提供纳秒精度，但不一定提供纳秒分辨率（即值更改的频率） - 除了分辨率至少与[`currentTimeMillis()`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#currentTimeMillis()).
> 
> 由于数值溢出，超过大约 292 年（2 ^(63纳秒）的连续调用的差异将无法正确计算经过的时间。)
> 
> 仅当计算在 Java 虚拟机的同一实例中获得的两个此类值之间的差异时，此方法返回的值才有意义。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-12T13:56:36.123

In Clojure command line, I get:

```
user=> (- (System/nanoTime) (System/nanoTime))
0
user=> (- (System/nanoTime) (System/nanoTime))
0
user=> (- (System/nanoTime) (System/nanoTime))
-641
user=> (- (System/nanoTime) (System/nanoTime))
0
user=> (- (System/nanoTime) (System/nanoTime))
-642
user=> (- (System/nanoTime) (System/nanoTime))
-641
user=> (- (System/nanoTime) (System/nanoTime))
-641 
```

So essentially, `nanoTime` doesn't get updated every nanosecond, contrary to what one might intuitively expect from its *precision*. In Windows systems, it's using the `QueryPerformanceCounter` API under the hood (according to [this article](https://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks)), which in practice seems to give about 640 ns *resolution* (in my system!).

Note that `nanoTime` can't, by itself, have any *accuracy* at all, since its absolute value is arbitrary. Only the *difference* between successive `nanoTime` calls is meaningful. The (in)accuracy of that difference is in the ballpark of 1 microsecond.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-12T13:36:09.197

第一种解释是正确的。在大多数系统上，三个最低有效数字将始终为零。这实际上提供了微秒精度，但以纳秒的固定精度水平报告。

事实上，现在我再看一遍，你的第二种解释也是对正在发生的事情的有效描述，甚至可能更是如此。想象冻结时间，报告将始终是相同的错误纳秒数，但如果理解为整数微秒，则正确。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-12T09:30:52.730

`System.currentTimeMillis()`&之间的差异的一个非常有趣的特征`System.nanoTime()`是它`System.nanoTime()`不会随挂钟而改变。我在具有大量时间漂移的 Windows 虚拟机上运行代码。`System.currentTimeMillis()`当 NTP 纠正这种漂移时，每次可以向后或向前跳 1-2 秒，从而使准确的时间戳变得毫无意义。（Windows 2003、2008 VPS 版本）

`System.nanoTime()`但是，不受更改挂钟时间的影响，因此您可以通过 NTP 检索时间并根据`System.nanoTime()`上次检查 NTP 后应用校正，并且您的时间比`System.currentTimeMillis()`不利的挂钟条件更准确

这当然是违反直觉的，但了解一下很有用

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-02-15T20:34:21.113

如果像我这样的人来一次又一次*地*阅读这个问题仍然有点理解它，这里有一个更简单（我希望）的解释。

`Precision`是关于您保留多少位数。每个：

```
long start = System.nanoTime();
long end   = System.nanoTime(); 
```

将是一个精确的数字（很多数字）。

由于`accuracy`仅*与 something 比较来*衡量，因此单独调用 to`System.nanoTime`没有任何意义，因为它的值是非常任意的，并且不依赖于我们可以衡量的东西。区分其准确性的唯一方法是对其进行两次不同的调用，因此：

```
 long howMuch = end - start; 
```

*不会*有纳秒的精度。事实上，在我的机器上，差异是 0.2 - 0.3 微秒。

# php - Javascript window.onload 不会在每台计算机上加载

> ID：11452598
> 
> 赞同：2
> 
> 时间：2012-07-12T13:11:44.633
> 
> 标签：php, javascript, jquery, codeigniter

我在页面上添加了一些 javascript 以根据用户选择更新特定的 div。

我选择了这种方法，而不是简单地通过 PHP 从数据库中加载信息，因为它可以在通过 AJAX 打开页面时由用户动态更改

div就是`<div id='fight'>`div。它调用的`update_fight()`函数是下面的函数。我包含了整个 .js 文件以供参考，以防我遗漏了一些东西。

```
window.onload = (function(){
update_fight();
});

function get_main(page){
     $.ajax({
            type: "POST",
            async: false,
            url: 'http://rickymason.net/d4beta/welcome/loadmain',
            dataType: 'json', 
            data: { page: page },
            success: function(content){
                var html = '';
                html += content['content'];
                $('#main').html(html);
            }
        });    
}

function pop_zone(page){
     $.ajax({
        type: "POST",
        async: false,
        url: 'http://rickymason.net/d4beta/welcome/popzone',
        dataType: 'json', 
        data: { page: page },
        success: function(content){
            var html = $(content['content'])
            var $dialog = $('<div></div>')
            .html(html)
            .dialog({
                    autoOpen: false,
                    title: 'Select Zone',
                    modal: true,
                    width: 800,
                    resizable: false 
            });
            $dialog.dialog('open');
        }
    });     
}
$(document).ready(function() {
    $("#pop_zone").dialog({autoOpen:false});    
});

function update_fight() {
    $.ajax({
        type: "POST",
        async: false,
        url: 'http://rickymason.net/d4beta/welcome/loadmain',
        dataType: 'json', 
        data: { page: 'get_zone' },
        success: function(content){
            var html = '';
            html += content['content'];
            $('#fight').html(html);
        }
    });   
}

function sql_zone(zone) {
    $.ajax({
        type: "POST",
        async: false,
        url: 'http://rickymason.net/d4beta/welcome/sql_zone',
        dataType: 'json', 
        data: { zone: zone },
        success: function(){
            update_fight();
        }
    });   
}

$("#changezone").live('click', function() {
    var page = 'change';
    pop_zone(page);
});

$(".zone").live("click",function() {
    var zone = this.id;
    sql_zone(zone);
    alert ( "Updated: Zone " + this.id );
}); 
```

`update_fight()`调用我的控制器`loadmain`：可以在这里看到：

```
 public function loadmain()
    {
        $content = $this->main_model->get_zone();
        $page['content'] = $content;
        echo json_encode($page);
    } 
```

`get_zone()`可以在这里看到：

```
 public function get_zone()
    {
        $user_id = $this->tank_auth->get_user_id();
        $itemroll = $this->db->query("SELECT current_zone, z.name FROM user_load ul
                                    INNER JOIN zones z
                                    ON z.id = ul.current_zone
                                    WHERE ul.user_id = $user_id");
        $result = $itemroll->row_array();
        $zone['current_zone']= $result['current_zone'];
        $zone['name'] = $result['name'];
        //HTML Formatting
        $content = '';
        $content .= "<div id='change'><input type='button' id='changezone' value='Zone'></input></div> ";
        $content .= "<div id='zonename'><a href='". base_url()."welcome/fight'>". $zone['name']."</a></div>";
        return $content;
    } 
```

是否有任何明显的问题可能导致在偶尔页面加载或新页面加载期间无法正常工作？

这肯定会出现在所有 3 个浏览器中，尽管在 IE7 中更为一致。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:13:40.653

你有 jQuery，所以使用它;)。

改变

```
window.onload = (function(){ 
```

至

```
$(function() { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:23:00.377

如果您使用的是 jQuery，那么我建议挂钩：

```
$(window).load(function() {
  update_fight();
}); 
```

如果你想要 JavaScript，那么：

```
window.onload = function() {
  update_fight();
}; 
```

参考：

*   [http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)
*   [https://developer.mozilla.org/en/DOM/window.onload](https://developer.mozilla.org/en/DOM/window.onload)

# c - 非套接字错误的套接字操作

> ID：11452600
> 
> 赞同：0
> 
> 时间：2012-07-12T13:11:55.337
> 
> 标签：c, sockets

嘿，你能告诉我 sock_path 在 unix 中是什么吗？

我完全糊涂了……我收到一个错误“非套接字上的套接字操作”。

这条路径是否包含我们定义的结构以及存储结构的位置！！我已经发布了我的整个客户端代码。

我在双方（客户端和服务器）都遇到同样的错误......请帮助......我没有得到 sock_path 部分？

```
#define SOCK_PATH "echo_socket" 

int main(void) 
{
    int s, t, len;  
    struct sockaddr_un remote;  
    char str[100];  

    if ((s = socket(AF_UNIX, SOCK_STREAM, 0)) == -1) { 
        perror("socket");  exit(1); 
    } 

    printf("Trying to connect...\n");  
    remote.sun_family = AF_UNIX;  

    strcpy(remote.sun_path, SOCK_PATH);  
    len = strlen(remote.sun_path) + sizeof(remote.sun_family);   

    int val=connect(s, (struct sockaddr *)&remote, len);   
    if ( val< 0) {
       perror("connect");  
       exit(1);
    }

    printf("Connected.\n");  

    while(printf("> "), fgets(str, 100, stdin), !feof(stdin)) {
       if (send(s, str, strlen(str), 0) == -1) {
          perror("send"); 
          exit(1); 
       }

       if ((t=recv(s, str, 100, 0)) > 0) { 
          str[t] = '\0';  
          printf("echo> %s", str);
       } else {
          if (t < 0) perror("recv");  
          else printf("Server closed connection\n");   
          exit(1);
       }
    }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T18:41:38.060

您是否尝试使用 unix 套接字进行文件操作？如果是，则分配给 sun_path 的 SOCK_PATH 应该是文件名。

看看这个.. [http://beej.us/guide/bgipc/output/html/multipage/unixsock.html](https://web.archive.org/web/20171129152510/http://beej.us/guide/bgipc/output/html/multipage/unixsock.html)

# django - 未授予 Django 管理员访问权限

> ID：11452601
> 
> 赞同：2
> 
> 时间：2012-07-12T13:11:58.750
> 
> 标签：django, django-admin, django-templates, django-urls

我正在尝试为我正在创建的项目运行 /admin。我在这里面临两个问题

1.当我将浏览器指向 127.0.0.1/admin/ 它说找不到页面但是当我将浏览器指向 127.0.0.1 然后我得到我的项目文件中的文件列表如何纠正这个

2.每次我重新启动apache都没有创建pyc文件？？

```
 -rwxrwxrwx 1 root root  546 2012-07-11 15:45 manage.py
  -rwxrwxrwx 1 root root    0 2012-07-12 17:53 __init__.py
  -rwxrwxrwx 1 root root   34 2012-07-12 18:03 test
  -rw-r--r-- 1 root root  114 2012-07-12 18:03 __init__.pyc
   drwxr-xr-x 2 root root 4096 2012-07-12 18:20 tmp
  -rwxrwxrwx 1 root root 4489 2012-07-12 18:20 settings.py
  -rwxrwxrwx 1 root root  585 2012-07-12 18:34 urls.py 
```

我已`django.contrib.admin`在 settings.py 文件中包含已安装的应用程序，这也是下面的 urls.py 文件

```
 from django.conf.urls import patterns, include, url

  # Uncomment the next two lines to enable the admin:
  from django.contrib import admin
  admin.autodiscover()

  urlpatterns = patterns('',
      # Examples:
      # url(r'^$', '{{ project_name }}.views.home', name='home'),
      # url(r'^{{ project_name }}/', include('{{ project_name }}.foo.urls')),

      # Uncomment the admin/doc line below to enable admin documentation:
      # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

      # Uncomment the next line to enable the admin:
      url(r'^admin/', include(admin.site.urls))
  ) 
```

`EDIT`

我还没有创建任何模块..我应该创建一个模块然后访问管理员吗？

`EDIT1`

```
import os

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "settings")

# This application object is used by the development server
# as well as any WSGI server configured to use this file.
from django.core.wsgi import get_wsgi_application
application = get_wsgi_application() 
```

/etc/apache2/httpd.conf

```
 WSGIScriptAlias / /opt/mysite/wsgi.py
  WSGIPythonPath /opt/mysite

  <Directory /opt/mysite>
  <Files wsgi.py>
  Order deny,allow
  Allow from all
  </Files>
  </Directory> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:20:45.720

单击`http://127.0.0.1:8000/`，您需要端口。如果你也去，`http://127.0.0.1`你只会看到文件列表。你不使用`runserver`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:16:42.357

It looks to me that your apache is improperly configured.

Check out these docs:

[https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi)

[http://blog.dscpl.com.au/2010/03/improved-wsgi-script-for-use-with.html](http://blog.dscpl.com.au/2010/03/improved-wsgi-script-for-use-with.html)

To be sure, you could start Django on its on development server and see if you can access the admin area.

* * *

Try this in your django.wsgi:

```
import os,sys

#add your django project in PYTHONPATH
sys.path.append('/home/django/project/path/')

os.environ['DJANGO_SETTINGS_MODULE']='projectName.settings'

import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

apache_django_wsgi.conf:

```
Alias /uploads/ "pathTo/uploads/"
<Directory "pathTo/uploads/">
    Order allow,deny
    Options Indexes
    Allow from all
    IndexOptions FancyIndexing
</Directory>

Alias /static/ "pathTo/sitestatic/"
<Directory  "pathTo/sitestatic/">
    Order allow,deny
    Options Indexes
    Allow from all
    IndexOptions FancyIndexing
</Directory>

WSGIScriptAlias / "pathTo/apache/django.wsgi"
<Directory "pathTo/apache/django.wsgi">
    Order deny,allow
    Allow from all
</Directory> 
```

Then, in your /etc/apache2/httpd.conf (or wherever it is located)

```
Include "/pathTo/apache_django_wsgi.conf" 
```

# javascript - 将 onclick 事件添加到按钮会导致页面错误

> ID：11452602
> 
> 赞同：0
> 
> 时间：2012-07-12T13:11:59.190
> 
> 标签：javascript, asp.net, html, vb.net

下面是我的 asp.net 应用程序中一个按钮的 html 代码，它使用 vb 作为其服务器端语言。该按钮在服务器端处理，其中的代码也在下面列出。我的问题是当我添加一个 onclick 事件时（我想在同一页面或父页面中调用 javascript 函数，因为此页面仅显示在我们应用程序的 iframe 中，从不独立）。

目前，这是按钮的 html

```
<asp:button class="smalltextbutton" id="Button1" runat="server" Text="Save"></asp:button> 
```

当更改为以下内容时，在启动页面时出现错误，指出“编译器错误消息：BC30456：'refreshParentTree' 不是 'ASP.tasks_modifytask_aspx' 的成员。”

```
<asp:button class="smalltextbutton" id="Button1" OnClick="refreshParentTree()" runat="server" Text="Save"></asp:button> 
```

现在 javascript 函数非常基本，在表单之外，这就是它的样子。

```
<script language="javascript">
 function refreshParentTree(){
        alert('refresh parent tree hit');
        }
</script> 
```

在服务器端，这是我处理按钮单击的代码（vb）

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    'DEBUG: 
    If Trace.IsEnabled Then cGK_testSpot.Text += "<div style='border: solid thin orange;'>Button1_Click() STARTING<br>"
    'DEBUG: 
    If Trace.IsEnabled Then cGK_testSpot.Text += "<div style='border: solid thin green;'>printArrayList (delete ALL EXCEPT this list from P2_CustomFields_Detail): " + CustomFieldsLibrary.printArrayList(arlist_dynCompnts) + "</div>"

    If Page.IsValid Then
        CustomFieldsLibrary.deleteAllDynamicFieldsExceptThisList(lnCurrent, 13, -1, arlist_dynCompnts, (New SqlConnection((New ConnInfo).GetConnString)), True)
        UpdateDatabase()
        If Not Trace.IsEnabled Then Server.Transfer("viewTask.aspx?taskgrpid=" & lnCurrent & "&taskgrpcategory=13&ptaskgrpid=" & Request.QueryString("ptaskgrpid") & "&ptaskgrpcategory=" & Request.QueryString("ptaskgrpcategory") & "&refresh=true")
    Else
        populateDropDowns()
    End If

    If Trace.IsEnabled Then cGK_testSpot.Text += "<div style='border: solid thin green;'>printArrayList: " + CustomFieldsLibrary.printArrayList(arlist_dynCompnts) + "</div>"
    'DEBUG: 
    If Trace.IsEnabled Then cGK_testSpot.Text += "<br>Button1_Click() ENDED</div>"
End Sub 
```

所以基本上，我正在寻找这里做错了什么，为什么页面会给我错误，一旦这些问题得到解决，我将需要 onclick 在同一页面上调用一个 javascript 函数，然后调用父母，或直接父母。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:17:17.550

[使用`OnClientClick`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.onclientclick.aspx)而不是`OnClick`.

An`<asp:button>`是一个服务器端元素，因此它具有自己的 ASP.NET 特定的服务器端属性，这些属性在服务器端进行处理。就常规 HTML 元素而言，这`OnClick`不是您认为的那样。编译器正在服务器上寻找该代码，但它不存在。

`OnClientClick`另一方面，它只是被视为一个字符串，编译器不会对其进行评估。（除了`onclick`在输出中发出 HTML 属性。）它假定会有客户端代码来处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:15:47.970

尝试将 OnClick 更改为 onclick（小写字母）。由于标签有一个 runat="server" 属性，它是一个服务器控件，然后 OnClick 将引用一个必须在代码隐藏中定义的服务器端事件。

# javascript - 从 java 脚本中的 Json Array 获取值？

> ID：11452603
> 
> 赞同：0
> 
> 时间：2012-07-12T13:12:08.830
> 
> 标签：javascript, asp.net, json

我创建 JSON 数组，如`jarray`.

它有 id 和相应的值。

我还有另一个变量 `arr`。

现在，我如何使用 id 从 json 数组中获取值的值。

这意味着如果我需要`jarray`使用 var检查`id=04`。

如果我发现 04 我需要像 Apple 这样的特定 id 的值作为输出。

如何在 Json 数组中使用 If 条件？

```
var jarray=[{"id":"04","value":"Apple"},{"id":"13","value":"orange"}];
var id=04; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:14:28.127

这将返回 id 为 "04" 的所有项目的数组：

```
var matches = jarray.filter(function(a){return a.id==id;}); 
```

如果你确定只有一个，你可以拿`matches[0];`。

请注意，这适用于作为`"04"`或提供的 id `04`。

为了确保与旧浏览器（可能没有过滤器功能）的兼容性，请参阅[此](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/filter)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:21:05.103

像这样：

```
for (i=0;i<jarray.length;i++)
    {
        var tempValue = jarray[i];
        if (tempValue["id"] == id)
            alert( "value is : " + tempValue["value"] );
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:15:31.840

```
var i=0;
while(i<jarray.length) {
  if(jarray[i].id==id) {
    var val=jarray[i].value;
    break;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T13:15:49.673

您可以使用[Underscore 的 _.find` 方法之类的方法](http://underscorejs.org/#find)，也可以编写自己的方法，这可能更适合您的情况：

```
function findId(id, arr, member) {
  for(i in arr) {
    // You could use === here depending on your needs
    if(arr[i]['id'] == id) {
      return member === undefined ? arr[i] : arr[i][member];
    }
  }
  return false;
}
findId('04', jarray, 'value'); // Apple 
```

# c# - 使用安装项目安装的应用程序无法访问文件夹

> ID：11452604
> 
> 赞同：0
> 
> 时间：2012-07-12T13:12:12.370
> 
> 标签：c#, .net, setup-project, file-access

我有 .net 应用程序，编译后一切正常。它将图像文件保存到其文件夹中。当我`Ctrl+F5`在 Visual Stuio 中使用时，或者当我将 exe 文件复制到某个文件夹时，就可以了。但是，当我制作安装项目时，我有一个`System.UnauthorizedAccessException`, 在线`image.Save(....);`. 如何访问我的应用程序？

# xml - 维护 Eclipse 中自动格式化的 XML 注释部分的格式

> ID：11452606
> 
> 赞同：6
> 
> 时间：2012-07-12T13:12:14.973
> 
> 标签：xml, eclipse, pretty-print

在 Eclipse (Helios) 中，我有这个 XML 源文件：

```
<?xml version="1.0" encoding="utf-8"?>
<!--
I wanted to 
===========
save this format of the comments.

-->
<x>
</x> 
```

在格式化文件（Ctrl+Shift+F）时，我重新格式化了评论。

```
<?xml version="1.0" encoding="utf-8"?>
<!-- I wanted to =========== save this format of the comments. -->
<x>
</x> 
```

是否有关闭漂亮打印评论部分的选项？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-25T10:05:13.687

我正在使用 Eclipse 3.6.0。

在 Windows > 首选项 > XML > XML 文件 > 编辑器中：

取消选中**连接线**选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T10:07:03.550

您可以只选择部分 XML 文件进行格式化，而忽略注释部分。

# android - SMS DeliveryBroadcast (BroadCastReceiver) OnReceive 永远不会被调用

> ID：11452608
> 
> 赞同：2
> 
> 时间：2012-07-12T13:12:19.753
> 
> 标签：android, sms, broadcastreceiver

我正在测试一些短信发送和接收结果应用程序。它按预期发送短信，并祝酒“短信已发送”。但它从不敬酒“短信已送达”。它也永远不会达到

```
Log.i("BROADCASTRECEIVER", String.valueOf(getResultCode())); 
```

这意味着永远不会为 SMS_DELIVERED 结果调用 OnReceive...知道为什么吗？...

```
public class C extends Activity {

    static String[] params;

    static Context context;
    ProgressDialog pd;
    BroadcastReceiver smsDeliveryBroadcast, smsSendBroadcast;
    String SENT = "SMS_SENT";
    String DELIVERED = "SMS_DELIVERED";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.c);
        params = new String[3];
        params[0] = "00905067161660";
        params[1] = "smsC.";
        params[2] = "smsC..";
        new ServerSMSThread().execute(params);
    }

    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        unregisterReceiver(smsDeliveryBroadcast);
        unregisterReceiver(smsSendBroadcast);
        super.onPause();
    }

    @Override
    protected void onResume() {
        // TODO Auto-generated method stub

        super.onResume();
    }

    public void sendSMS(String phoneNumber, String message) {
        Log.i("NO", phoneNumber);
        PendingIntent sentPI = PendingIntent.getBroadcast(this, 0, new Intent(
                SENT), 0);

        PendingIntent deliveredPI = PendingIntent.getBroadcast(this, 0,
                new Intent(DELIVERED), 0);

        registerSMS();

        SmsManager sms = SmsManager.getDefault();
        sms.sendTextMessage(phoneNumber, null, message, sentPI, deliveredPI);

    }

    private void registerSMS() {
        smsSendBroadcast = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) {

                // TODO Auto-generated method stub
                switch (getResultCode()) {
                case Activity.RESULT_OK:
                    Toast.makeText(context, "SMS sent", Toast.LENGTH_SHORT)
                            .show();
                    Log.i("MONITOR", "SMS Gonderildi");
                    break;
                case SmsManager.RESULT_ERROR_GENERIC_FAILURE:
                    Toast.makeText(context,
                            "SMS sending failed: Generic failure",
                            Toast.LENGTH_SHORT).show();
                    break;
                case SmsManager.RESULT_ERROR_NO_SERVICE:
                    Toast.makeText(context, "SMS sending failed: No service",
                            Toast.LENGTH_SHORT).show();
                    Log.i("MONITOR", "SMS sending failed: No service");
                    break;
                case SmsManager.RESULT_ERROR_NULL_PDU:
                    Toast.makeText(context, "SMS sending failed: Null PDU",
                            Toast.LENGTH_SHORT).show();
                    Log.i("MONITOR", "SMS sending failed: Null PDU");
                    break;
                case SmsManager.RESULT_ERROR_RADIO_OFF:
                    Toast.makeText(context, "SMS sending failed: Radio off",
                            Toast.LENGTH_SHORT).show();
                    Log.i("MONITOR", "SMS sending failed: Radio off");
                    break;
                }
            }
        };
        smsDeliveryBroadcast = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) {

                Log.i("BROADCASTRECEIVER", String.valueOf(getResultCode()));
                // TODO Auto-generated method stub
                switch (getResultCode()) {
                case Activity.RESULT_OK:
                    Toast.makeText(context, "SMS delivered", Toast.LENGTH_SHORT)
                            .show();
                    Log.i("MONITOR", "SMS Teslim edildi");
                    break;
                case Activity.RESULT_CANCELED:
                    Toast.makeText(context, "SMS not delivered",
                            Toast.LENGTH_SHORT).show();
                    Log.i("MONITOR", "SMS not delivered");
                    break;

                default:
                    Toast.makeText(context, "SMS result bilinmiyor",
                            Toast.LENGTH_SHORT).show();
                    Log.i("MONITOR", "SMS result bilinmiyor");
                    break;
                }
            }
        };

        // ---when the SMS has been sent---
        registerReceiver(smsSendBroadcast, new IntentFilter(SENT));
        // ---when the SMS has been delivered---
        registerReceiver(smsDeliveryBroadcast, new IntentFilter(DELIVERED));
    }

    public class ServerSMSThread extends AsyncTask<String, Void, Void> {

        @Override
        protected void onPostExecute(Void result) {
            // TODO Auto-generated method stub
            super.onPostExecute(result);
            if (pd.isShowing())
                pd.dismiss();
            startActivity(new Intent(C.this,B.class).addFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT));
        }

        @Override
        protected void onPreExecute() {
            // TODO Auto-generated method stub
            super.onPreExecute();
            pd = ProgressDialog.show(C.this, "Sending SMS...", "Please wait.");
            Log.i("MONITOR", "SMS Gonderiliyor");
        }

        @Override
        protected Void doInBackground(String... params) {
            // TODO Auto-generated method stub
            for (int i = 1; i < params.length; i++) {
                sendSMS(params[0], params[i]);
            }
            try {
                Thread.sleep(2000);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            return null;
        }
    }

} 
```

AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.tekeli.order"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="11" />
    <uses-permission android:name="android.permission.SEND_SMS" ></uses-permission>
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".ActivityOrderActivity"
            android:label="@string/app_name">
            <intent-filter >
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name=".B" ></activity>
         <activity android:name=".C"></activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T06:08:29.547

`onCreate()`我认为您应该尝试在该方法中注册您的接收器（smsSendBroadcast 和 smsDeliveryBroadcast），并在`onDestroy()`.

我在这里做类似的事情！！！ [Android PendingIntent 额外内容，BroadcastReceiver 未收到](https://stackoverflow.com/questions/14571564/android-pendingintent-extras-not-received-by-broadcastreceiver/14612215#14612215)

# java - 为什么 Hibernate 包含一个带有插入的标识字段？

> ID：11452611
> 
> 赞同：2
> 
> 时间：2012-07-12T13:12:21.923
> 
> 标签：java, hibernate

模型类：

```
@Entity
@Table(name = "CSU_AUDIT")
@NamedQuery(name = "findAllEventsForObjectId", query = "from AuditEvent e where e.objectId = :objectId order by e.auditTimestamp desc")
public class AuditEvent implements Serializable {
    /**
     * 
     */
    private static final long serialVersionUID = 577051869176721340L;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int auditId;

    @Column(name = "INSERT_TS")
    private Date auditTimestamp;

    @Column(name = "OBJECT_ID")
    private String objectId;

    @Column(name = "ACTION_CODE")
    private String actionCode;

    @Column(name = "USER_ID")
    private String userId;

    @Column(name = "FIELD_NAME")
    private String fieldName;

    @Column(name = "OLD_VALUE")
    private String oldValue;

    @Column(name = "NEW_VALUE")
    private String newValue; 
```

简单的 DAO 方法：

```
public void insertEvent(AuditEvent event) {
        final Session session = sessionFactory.getCurrentSession();
        session.beginTransaction();
        log.info("Saving audit event...");
        log.debug(event);
        session.save(event);
        session.getTransaction().commit();
    } 
```

会话工厂由 Spring 的`AnnotationSessionFactoryBean`.

相关异常信息（如有必要，可提供更多信息）：

```
2012-07-12 09:01:41,049 DEBUG org.hibernate.event.def.AbstractSaveEventListener - executing identity-insert immediately
2012-07-12 09:01:41,053 DEBUG org.hibernate.jdbc.AbstractBatcher - about to open PreparedStatement (open PreparedStatements: 0, globally: 0)
2012-07-12 09:01:41,066 DEBUG org.hibernate.SQL - insert into CSU_AUDIT (auditId, ACTION_CODE, INSERT_TS, FIELD_NAME, NEW_VALUE, OBJECT_ID, OLD_VALUE, USER_ID) values (default, ?, ?, ?, ?, ?, ?, ?)
2012-07-12 09:01:41,100 DEBUG org.hibernate.jdbc.AbstractBatcher - about to close PreparedStatement (open PreparedStatements: 1, globally: 1)
2012-07-12 09:01:41,117 DEBUG org.hibernate.util.JDBCExceptionReporter - could not insert: [com.cinfin.ecm.csudocmgr.audit.AuditEvent] [insert into CSU_AUDIT (auditId, ACTION_CODE, INSERT_TS, FIELD_NAME, NEW_VALUE, OBJECT_ID, OLD_VALUE, USER_ID) values (default, ?, ?, ?, ?, ?, ?, ?)]
com.ibm.db2.jcc.c.SqlException: DB2 SQL error: SQLCODE: -206, SQLSTATE: 42703, SQLERRMC: AUDITID 
```

我不明白为什么该字段注释为`@ID`并`@GeneratedValue(strategy = GenerationType.IDENTITY)`包含在插入中。我读过的所有内容都表明hibernate应该完全省略这个字段。在数据库方面，该字段将作为身份生成，尽管我没有生成代码来确定它是如何声明的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T14:02:39.327

正如您在日志中看到的，它`default`作为生成列的值传递，这意味着：使用该列的默认值。[DB2 的文档](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/admin/r0000970.htm)说：

> 默认
> 
> 指定使用默认值。指定 DEFAULT 的结果取决于列的定义方式，如下所示：
> 
> [...]
> 
> *   如果使用 IDENTITY 子句，则该值由数据库管理器生成。

# c# - 表达差异 >

> ID：11452614
> 
> 赞同：5
> 
> 时间：2012-07-12T13:12:35.743
> 
> 标签：c#, covariance, contravariance, variance

这次只是一个快速而简短的。`Func<T,TResult>` [是逆变](http://msdn.microsoft.com/en-us/library/bb549151.aspx)的（***编辑***：类型参数 T 是）。现在，我不使用`Func<T,TResult>`，而是使用`Expression<Func<T,TResult>>`，并且似乎已经走到了死胡同。**更新 - 完整代码示例：**

```
public interface IColoredObject
{
    string Color { get; }
}

public class Item : IColoredObject
{
    public string Color { get; set; }

    public double Price { get; set; }
}

public partial class MainWindow : Window
{
    private IList<Item> _items;

    public IList<Item> Items
    {
        get
        {
            if (_items == null)
            {
                _items = new List<Item>();
                _items.Add(new Item() { Color = "black" });
                _items.Add(new Item() { Color = "blue" });
                _items.Add(new Item() { Color = "red" });
            }
            return _items;
        }
    }

    public MainWindow()
    {
        InitializeComponent();
        Expression<Func<IColoredObject, bool>> filter = x => x.Color == "black";
        Item i = Get(filter);
    }

    public Item Get(Expression<Func<Item, bool>> filter)
    {
        return Items.AsQueryable().Where(filter).FirstOrDefault();
    }
} 
```

该调用是使用`Expression<Func<IColoredObject, bool>>`as 参数进行的，如果我没有误解逆变性，应该可以工作，因为.`IColoredObject``Item`

我得到的是一个转换异常，说的是

无法转换

```
System.Linq.Expressions.Expression`1[System.Func`2[MyNs.IColoredObject,System.Boolean]] 
```

至

```
System.Linq.Expressions.Expression`1[System.Func`2[MyNs.Item,System.Boolean]] 
```

有没有办法解决这个问题并让它工作？

**编辑：**

由于我所说的有些不准确，这里有更多的背景。代码示例已更新。此外，我检查了 MSDN 所说的`Func<T, TRes>`：

```
public Item GetFunc(Func<Item, bool> filter)
{
    return Items.AsQueryable().Where(filter).FirstOrDefault();
} 
```

如 MS 所示，这可以与逆变类型参数一起使用，如下所示：

```
 Func<IColoredObject, bool> filterFunc = x => x.Color == "black";
 GetFunc(filterFunc); 
```

这再次让我想知道为什么这适用于`Func<T, TRes>`但不适用于`Expression<Func<T, TRes>>`......

***最后...***

选择了选中的答案，因为这是我最终所做的。正如我在下面的评论中所说的那样，`Get`-Method 利用 NHibernate 来获取数据。但显然 NHibernate 具有接受接口查询并自动选择实现该接口的类型的功能。这本身并不能解决问题，但正如您在下面看到的那样，没有真正的解决方案，因为这里遇到的是预期的行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T14:30:05.467

`Expression<TDelegate>` 是一个类，所以它不能对泛型参数有变化。`Delegate`和之间也有很大的区别`Expression<Delegate>`。虽然您可以将`Item`object 传递到`Func<IColoredObject, bool>`并因此可以转换`Func<IColoredObject, bool>`为`Func<Item, bool>`，`Expression<Func<Item, bool>>`但就像获取`Item`和返回 bool 的方法的代码一样。您可以分析和更改此代码添加`Item`特定的方法和属性，显然这对于​​使用`IColoredObject`.

可以使用 ExpressionVisitor更改into对象`IColoredObject`中的所有参数条目。下面是一个在简单情况下执行这种转换的访问者（即没有显式接口实现）。可能有更简单的解决方案可以解决您的问题，但是如果不了解更多详细信息，很难找到它。`Expression<Func<IColoredObject, bool>>``Item`

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;

interface IGizmo
{
    bool Frobnicate();
}

class Gizmo : IGizmo
{
    public bool Frobnicate()
    {
        Console.WriteLine("Gizmo was frobnicated!");

        return true;
    }
}

public sealed class DelegateConversionVisitor : ExpressionVisitor
{
    IDictionary<ParameterExpression, ParameterExpression> parametersMap;

    public static Expression<Func<T2, TResult>> Convert<T1, T2, TResult>(Expression<Func<T1, TResult>> expr)
    {
        var parametersMap = expr.Parameters
            .Where(pe => pe.Type == typeof(T1))
            .ToDictionary(pe => pe, pe => Expression.Parameter(typeof(T2)));

        var visitor = new DelegateConversionVisitor(parametersMap);
        var newBody = visitor.Visit(expr.Body);

        var parameters = expr.Parameters.Select(visitor.MapParameter);

        return Expression.Lambda<Func<T2, TResult>>(newBody, parameters);
    }

    public DelegateConversionVisitor(IDictionary<ParameterExpression, ParameterExpression> parametersMap)
    {
        this.parametersMap = parametersMap;
    }

    protected override Expression VisitParameter(ParameterExpression node)
    {
        return base.VisitParameter(this.MapParameter(node));
    }

    private ParameterExpression MapParameter(ParameterExpression source)
    {
        var target = source;
        this.parametersMap.TryGetValue(source, out target);

        return target;
    }
}

class Program
{
    static void Main()
    {
        Expression<Func<IGizmo, bool>> expr = g => g.Frobnicate();

        var e2 = DelegateConversionVisitor.Convert<IGizmo, Gizmo, bool>(expr);

        var gizmo = new Gizmo();
        e2.Compile()(gizmo);
    }
} 

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T14:27:27.123

C# 仅对**接口**和**委托**类型具有协变和逆变。例如，这将起作用：

```
IEnumerable<Func<IColoredObject, bool>> ie1 = XXX;
IEnumerable<Func<Item, bool>> ie2 = ie1;                // works! 
```

请注意，在上面的示例中，`ie2 = ie1`即使类型不同，分配也会顺利进行。这是因为`Func<T, TResult>`它的第一个类型参数是逆变的（“in”）`T`，*而* `IEnumerable<T>`它的`T`. 这里，`Func<,>`是一个委托，`IEnumerable<>`也是一个接口。

不过`Expression<TDelegate>`是一**类**。C# 不支持类类型的协变/逆变。

因此`Expression<Something>`永远不会转换为`Expression<SomethingAlmostTheSame>`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T13:19:45.350

这一行：

```
public Item Get(Expression<Func<Item, bool>> filter) { /* ... */  } 
```

应该是：

```
public Item Get(Expression<Func<IColoredObject, bool>> filter) { /* ... */  } 
```

在这种情况下，如果要调用`Get`传递的方法，则必须使用接口`Expression<Func<IColoredObject, bool>>`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T13:20:06.610

在尝试计算协变和逆变时，我总是感到困惑。但你的例子对我来说似乎很清楚。您的方法 Get(...) 需要一个 Item 类型的表达式。由于 Item 是从 IColoredObject 派生的，因此不能使用 IColoredObject 类型的表达式，只能使用 Item 类型或从 Item 派生的类型。IColoredObject 是“更抽象的”，因此任何期望类型 Item（或其派生类）的东西都不能使用它。

问问自己：假设 Item 定义了 IColoredObject 没有的属性 X，那么 IColoredObject 类型的表达式将如何定义属性 X？

# regex - 正则表达式帮助 - 找到某些子字符串而不是其他

> ID：11452621
> 
> 赞同：0
> 
> 时间：2012-07-12T13:13:05.380
> 
> 标签：regex

我正在尝试构建一个正则表达式来查找字符串中是否有逗号，而不是斜杠逗号。例如 - 这里有一个匹配项：**aaa,aaa** 这里没有一个匹配项：**aaa\,aaa**

你能想出解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:16:01.470

这应该工作：`[^\\],`. 它应该匹配任何不是 a`\`后跟 a 的字符`,`。（我使用 Regex Pal 的[Regex Tester](http://regexpal.com/)对此进行了测试）。在您的情况下，根据您使用的语言，您可能只需要使用这个：`[^\],`.

但是，此模式假定它`,`不是**字符串**中的第一个字母。如果您还想应对这种可能性，您应该考虑使用这个：`(^,)|([^\\],)`. 这将检查 the`,`是字符串的第一个字母还是前面没有 a `\`。

编辑：问题似乎是对于这样的情况：`aaa,aaa`，我建议的正则表达式需要一个字符（之前的那个`,`）。我在 Java 代码中尝试了以下行：`String[] grp = "aaa,aaa".split("(?<!\\\\),");`它对我有用（如上面其他答案中所建议的那样）。如果您提供有关您使用的语言的信息，您可能有更大的机会获得帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:20:38.037

试试这个：

```
.*(?<!\\),.* 
```

通常有四种不同的断言类型：

```
(?=pattern)
    is a positive look-ahead assertion
(?!pattern)
    is a negative look-ahead assertion
(?<=pattern)
    is a positive look-behind assertion
(?<!pattern)
    is a negative look-behind assertion 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:16:49.750

You can use [negative lookbehind](http://www.regular-expressions.info/lookaround.html#lookbehind) to match only the comma:

```
/(?<!\\),/ 
```

If your regex engine does not support that, you'd use a [negated character class](http://www.regular-expressions.info/charclass.html#negated), which also matches the character before the comma (or the string start):

```
/(^|[^\\]),/ 
```

# android - 将地图设置为浏览器的 Android MAP 意图，如何重置？

> ID：11452624
> 
> 赞同：1
> 
> 时间：2012-07-12T13:13:16.160
> 
> 标签：android, android-intent, navigation, maps

我有一个应用程序启动导航，其代码类似于：

```
 Uri uri = Uri.parse("http://maps.google.com/maps?saddr=42.35892,-71.05781&daddr=40.756054,-73.986951");
 Intent intent = new Intent(android.content.Intent.ACTION_VIEW, uri);
     startActivity(intent); 
```

在我第一次运行的模拟器中，它要求我选择应用程序，MAPS 或 WEB，我选择了 web，现在模拟器总是通过 web 进入谷歌地图，我如何重置此设置，所以它会再次询问我所以我可以用地图应用程序测试一切吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:18:35.430

您需要更改操作系统下管理应用程序中的默认应用程序设置。您可以使用此[http://www.howtogeek.com/?post_type=post&p=43135](http://www.howtogeek.com/?post_type=post&p=43135) 作为指南。

# image - 如何将图像分成相同大小的块？

> ID：11452625
> 
> 赞同：2
> 
> 时间：2012-07-12T13:13:18.093
> 
> 标签：image, matlab, image-processing, fft, sliding-window

我有一个图像，我想把它分成相同大小的块。例如图像大小为 16。我想划分我的图像，他们在每个块上应用函数（例如 SVD、DWT、傅里叶变换）来搜索哪些块彼此相似。例如，我可以复制图像的一部分并将其粘贴到图像的另一部分，以便块彼此相似，我想搜索那些相似的块。

我是 Matlab 的新手，如果有人能帮助我如何划分图像，我真的很感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:25:37.443

您可以使用`blockproc`或`im2col`。有关示例，请参见[文档。](http://www.mathworks.ch/help/toolbox/images/ref/blockproc.html)`blockproc`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:40:24.687

我无法提供 matlab 答案，但您可以查看[图像分割](http://en.wikipedia.org/wiki/Segmentation_%28image_processing%29)（以谷歌为例）。有许多不同的方法可以做到这一点，具体取决于您想要的细分类型。

您还可以查看论文[Super-Resolution from a Single Image](http://www.wisdom.weizmann.ac.il/~vision/SingleImageSR.html)，该论文描述了一种在各种尺度上搜索自身重复出现的图像块的方法。链接的论文还描述了如何从多个图像中的小特征创建图像数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-14T12:30:58.477

我有一个用 python 编写的解决方案，您可以将其转换为对您有用的形式。

```
rsize = 4   #row size of the kernel
csize = 4   #column size of the kernel

for r in range(0,resized.shape[0] - rsize, rsize):
    for c in range(0,resized.shape[1] - csize, csize):
        window = resized[r:r+rsize,c:c+csize] 
```

我假设图像的大小为 17 x 17。在这里，图像的最后一列和最后一行可以用零填充，这样代码才能正常工作。

您可以将此逻辑应用于 MATLAB。

# svn - 如何在没有 root 权限的情况下将 svn 迁移到新系统

> ID：11452626
> 
> 赞同：2
> 
> 时间：2012-07-12T13:13:18.517
> 
> 标签：svn

我想将一台服务器中的 svn 存储库迁移到另一台服务器。我无权访问该服务器，但我拥有所有权限的 svn 访问权限。我可以在我的另一台服务器上复制整个 svn 存储库吗？

我无法访问服务器，因为它是 Assembla 提供的托管 svn

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:31:23.003

我认为他们有颠覆 1.7，在 1.7 中添加了一个用于远程转储的新工具，称为 svnrdump。 [http://svnbook.red-bean.com/en/1.7/svn.ref.svnrdump.c.dump.html](http://svnbook.red-bean.com/en/1.7/svn.ref.svnrdump.c.dump.html)

# iphone - .Deb 安装程序为 iphone

> ID：11452627
> 
> 赞同：1
> 
> 时间：2012-07-12T13:13:21.823
> 
> 标签：iphone, installation, asihttprequest, deb

我正在为越狱的 idevices 创建一个应用程序，并且需要能够将 .debs 安装到 /Library/Themes/ 我到处寻找文档或示例，但不出所料，我没有发现任何有用的东西。我首先想从 URL 中获取 .deb，然后只需将该包安装到用户文件夹中即可。如果有人对此有任何经验或可能会指出我正确的方向，将不胜感激。

这是一个类似的问题，但似乎从未真正得到回答。 [如何以编程方式在越狱的 iphone 上安装 .deb 文件？](https://stackoverflow.com/questions/5393713/how-to-install-a-deb-file-on-a-jailbroken-iphone-programmatically)

```
//SYCRONIZED REQUEST
- (IBAction)grabURL:(id)sender
{
NSURL *url = [NSURL URLWithString:@"http://freeappl3.com/com.freeapple.quickunlock_0.0.1-  
25_iphoneos-arm.deb"];
ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
[request startSynchronous];
NSError *error = [request error];
if (!error) {
    NSString *response = [request responseString];
    NSLog(@"responce String = %@",response);
}
}

- (IBAction)grabURLInBackground:(id)sender
{

 NSURL *url = [NSURL URLWithString:@"http://freeappl3.com/com.freeapple.quickunlock_0.0.1-
25_iphoneos-arm.deb"];
ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];

NSString *path = @"/Library/Themes/";

[request setDelegate:self];
[request setDownloadDestinationPath:path];
[request setDownloadProgressDelegate:progress];
[request startAsynchronous];
}

- (void)requestFinished:(ASIHTTPRequest *)request
{
// Use when fetching text data
NSString *responseString = [request responseString];
 NSLog(@"responce String = %@",responseString);

// Use when fetching binary data
NSData *responseData = [request responseData];
     NSLog(@"responce Data = %@",responseData);

}

- (void)requestFailed:(ASIHTTPRequest *)request
{
NSError *error = [request error];
     NSLog(@"responce Error = %@",error);
} 
```

日志

//当我使用我的方法“grabUrl：”

```
!<arch>
debian-binary   1311198441  0     0     100644  4         `
2.0
control.tar.gz  1311198441  0     0     100644  381       ` 
```

/当我使用我的方法“grabUrlInBackground：”

```
ThemeCatcher2[44212:16a03] responce Error = Error Domain=ASIHTTPRequestErrorDomain Code=8  
"Failed to move file from '/var/folders/jw/j5qzb3b51s17ywd9m7vw52y40000gn/T/62973B18-B19A-  
47FC-B2FB-A7E7F8C831AA-44212-00042A5738D4841E' to '/Library/Themes/'" UserInfo=0x9151ea0 
{NSUnderlyingError=0x9151fa0 "The operation couldn’t be completed. (Cocoa error 4.)", 
NSLocalizedDescription=Failed to move file from 
'/var/folders/jw/j5qzb3b51s17ywd9m7vw52y40000gn/T/62973B18-B19A-47FC-B2FB-A7E7F8C831AA-
44212-00042A5738D4841E' to '/Library/Themes/'} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:00:20.417

尝试使用

```
system("/usr/bin/dpkg -i <filename_of_deb_including_extension>"); 
```

不过，您需要 root 权限。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T05:23:52.533

使用以下代码

```
NSString *appsyncDebPath=@"/var/root/appsync.deb";
NSString *cmdString=[NSString stringWithFormat:@"/usr/bin/dpkg  -i %@ >/tmp/dpkg.log;",appsyncDebPath];
const char  *cmdChar=[cmdString UTF8String];
system(cmdChar); 
```

在此之前，您应该执行

```
setuid(0);
setgid(0); 
```

# php - 我如何使用循环函数从数字中删除点

> ID：11452629
> 
> 赞同：-2
> 
> 时间：2012-07-12T13:13:30.173
> 
> 标签：php, html

我有这个代码。我的问题是如何从输出中的其余数字中删除 0.1 一个。

它给出：计数器是 1464.1 我希望它给出：计数器是 1464

```
<?php
$i = 1000;
$t = 10;
while ($i < 100000000) {
echo"<p>The counter is $i";
$i = $i + ($i / $t);
}
?> 
```

输出是：

> 计数器是 1000
> 
> 柜台是1100
> 
> 柜台是1210
> 
> 柜台是1331
> 
> 计数器是 1464.1
> 
> 柜台是1610.51

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:15:03.497

使用[整数](http://php.net/manual/en/function.intval.php)：

```
echo '<p>The counter is '.intval($i) .'</p>'; 
```

编辑：

显示目的仅使用上面的代码。

数据操作用途：

```
$i = intval ($i + ($i / $t)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:15:38.987

使用[`intval()`](http://php.net/manual/en/function.intval.php)：

```
$i = intval( $i + ($i / $t) ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:14:51.710

您可以在回显时键入 cast 它。

```
echo "<p>The counter is " . (int)$i . "</p>"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T13:16:16.703

您可以使用：

```
echo "<p>The counter is ".floor($i)."</p>"; 
```

或者

```
echo "<p>The counter is ".intval($i)."</p>"; 
```

这些将有效地“切断”小数（或给你整数值）

或者您可以四舍五入到最接近的整数：

```
echo "<p>The counter is " . round($i) . "</p>"; 
```

或者，如果您试图从答案中减去 .1（在没有更多示例的情况下在 OP 中不清楚），您可以这样做：

```
echo "<p>The counter is ".($i - .1)."</p>"; 
```

# codeigniter - 具有库和模型支持的 Codeigniter pre_system 挂钩

> ID：11452638
> 
> 赞同：-1
> 
> 时间：2012-07-12T13:14:03.900
> 
> 标签：codeigniter, hook

我想在代码执行的一开始就为我的网站加载元信息。IE，我将从数据库中提取徽标 src、站点名称和元关键字/描述，并将其设置为会话以在我的页面执行时显示。我正在尝试使用 codeigniter 钩子来做到这一点。但是当我使用 pre_system 钩子时，它不会加载库和模型。

我将使用相同的场景为我的脚本（如 wordpress 或 joomla）生成安装程序，因此我需要一种正确的方法来在页面执行之前初始化我的配置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:21:19.403

使用 MY_Controller 扩展 CI_controller 并在其构造函数中加载所有数据：

```
class My_Class extends MY_Controller {

   function __construct()
   {
       parent::__construct();
       //Load logo
       //Load site name
       //Load meta
   }
} 
```

# java - ServiceTracker 与 BundleTracker

> ID：11452641
> 
> 赞同：0
> 
> 时间：2012-07-12T13:14:16.750
> 
> 标签：java, osgi

OSGi 企业规范定义了两种跟踪方式：按服务或按捆绑。

这两种方式有什么区别？在哪些情况下，应该使用一种方式而不是另一种方式？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T13:34:26.757

取决于您愿意跟踪的内容。

BundleTracker 跟踪捆绑包，请参阅：

*   [http://www.osgi.org/javadoc/r4v42/org/osgi/util/tracker/BundleTracker.html](http://www.osgi.org/javadoc/r4v42/org/osgi/util/tracker/BundleTracker.html)
*   [http://www.osgi.org/javadoc/r4v42/org/osgi/util/tracker/BundleTrackerCustomizer.html](http://www.osgi.org/javadoc/r4v42/org/osgi/util/tracker/BundleTrackerCustomizer.html)

ServiceTracker 跟踪服务实例，请参阅：

*   [http://www.osgi.org/javadoc/r4v42/org/osgi/util/tracker/ServiceTracker.html](http://www.osgi.org/javadoc/r4v42/org/osgi/util/tracker/ServiceTracker.html)
*   [http://www.osgi.org/javadoc/r4v42/org/osgi/util/tracker/ServiceTrackerCustomizer.html](http://www.osgi.org/javadoc/r4v42/org/osgi/util/tracker/ServiceTrackerCustomizer.html)

所以很明显，如果您对捆绑包发生的事情感兴趣，您可以使用 BundleTracker。如果您对服务实例感兴趣，可以使用 ServiceTracker。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T06:43:11.247

简单地说：捆绑就是罐子。您可以跟踪它是否已安装、成功启动、尚未启动等。

一个包可以发布零个或多个服务。OSGi 术语中的服务是活动的 java 对象，它为您提供做某事的方法。即使捆绑包在那里，它的服务也可能已经消失（例如，因为捆绑包已停止；或已安装但尚未启动）。即使 bundle 处于 ACTIVE 状态，它仍然可能在等待某些条件以提供其服务 - 它完全取决于 bundle 决定何时注册和取消注册其服务。

在最典型的情况下，您的代码与服务一起使用——例如，您获取 LogService 并调用它的 log() 方法。因此，在 99% 的情况下，您应该对 ServiceListener 感兴趣（或者，更好的是，使用 ServiceTracker，它的作用相同，但会为您处理一些典型的同步陷阱）。

希望这可以帮助 ：）

# r - 使用 RODBC 保持前导零

> ID：11452642
> 
> 赞同：5
> 
> 时间：2012-07-12T13:14:16.677
> 
> 标签：r, leading-zero

我正在尝试将 Access 数据库中的数据导入 R。我想导入某些专业的 CIP 代码，其中可能包含前导零。RODBC 将 CIP 代码转换为数值，即使它在 Access 中定义为文本。谁能阐明我如何在导入时将此字段强制转换为文本字段？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T13:28:16.037

尝试在函数中使用`as.is = TRUE`参数`sqlQuery`。这通常对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:33:17.197

```
library(RODBC)
channel=odbcConnectAccess2007("plz.accdb")
plz = sqlQuery(channel,"SELECT * from PLZ",as.is=TRUE) 
```

# c# - 如何在运行时使用 NLog 获取当前目标文件的路径？

> ID：11452645
> 
> 赞同：61
> 
> 时间：2012-07-12T13:14:42.950
> 
> 标签：c#, nlog

我将 NLog 与下一个配置一起使用：

```
 <targets>
    <target xsi:type="File" name="f" fileName="${basedir}/logs/${shortdate}.log"
            layout="${longdate} ${uppercase:${level}} ${message}" />
  </targets>
  <rules>
    <logger name="*" minlevel="Trace" writeTo="f" />
  </rules> 
```

我试图获取（我检查，集合中只有一个 FileTarget）的`FileName`属性`FileTarget`

```
NLog.LogManager.GetCurrentClassLogger().Info("test");
var logFile = (from t in NLog.LogManager.Configuration.AllTargets
                where t is NLog.Targets.FileTarget
                select (NLog.Targets.FileTarget)t).FirstOrDefault(); 
```

但是 logFile.FileName 只包含文件名的模式，正是它在设置中指定的方式。

如何进入当前日志文件的运行时路径？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-07-24T10:57:27.777

这对我有用：

```
var fileTarget = (FileTarget) LogManager.Configuration.FindTargetByName("file");
// Need to set timestamp here if filename uses date. 
// For example - filename="${basedir}/logs/${shortdate}/trace.log"
var logEventInfo = new LogEventInfo {TimeStamp = DateTime.Now}; 
string fileName = fileTarget.FileName.Render(logEventInfo);
if (!File.Exists(fileName))
    throw new Exception("Log file does not exist."); 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-05-09T13:01:52.337

即使您在 NLog XML 配置中设置`async="true"`（即您的目标由 包裹），此方法也将起作用：`AsyncTargetWrapper`

```
 private string GetLogFileName(string targetName)
    {
        string fileName = null;

        if (LogManager.Configuration != null && LogManager.Configuration.ConfiguredNamedTargets.Count != 0)
        {
            Target target = LogManager.Configuration.FindTargetByName(targetName);
            if (target == null)
            {
                throw new Exception("Could not find target named: " + targetName);
            }

            FileTarget fileTarget = null;
            WrapperTargetBase wrapperTarget = target as WrapperTargetBase;

            // Unwrap the target if necessary.
            if (wrapperTarget == null)
            {
                fileTarget = target as FileTarget;
            }
            else
            {
                fileTarget = wrapperTarget.WrappedTarget as FileTarget;
            }

            if (fileTarget == null)
            {
                throw new Exception("Could not get a FileTarget from " + target.GetType());
            }

            var logEventInfo = new LogEventInfo { TimeStamp = DateTime.Now };
            fileName = fileTarget.FileName.Render(logEventInfo);
        }
        else
        {
            throw new Exception("LogManager contains no Configuration or there are no named targets");
        }

        if (!File.Exists(fileName))
        {
            throw new Exception("File " + fileName + " does not exist");
        }

        return fileName;
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-12-19T23:53:53.637

目标可以被多次包装（在我的例子中我有一个过滤器），所以下面的代码片段是一种更通用的展开方法，适用于多个级别，并且不对目标名称做出假设。

```
Target target = LogManager.Configuration.FindTargetByName(targetName);
while ((target != null) && (target is WrapperTargetBase))
{
    target = (target as WrapperTargetBase).WrappedTarget;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-23T00:34:33.700

*我知道我的回答并没有完全回答问题，但最困难的是找到正确的目标并正确地转换它，然后我们可以访问任何属性。我也没有找到适合我的答案的问题，因此在这里发布......*

即使您在 NLog XML 配置中设置`async="true"`（即您的目标由一个`AsyncTargetWrapper`或任何 TargetWrapper 包装），此方法也将起作用：

使用 NLog 版本：3.1.0.0

运行时版本：v4.0.30319

```
 private Target FindTargetByName(string targetName)
    {
        if (LogManager.Configuration == null)
            return null;

        Target t = LogManager.Configuration.FindTargetByName(targetName);

        if (t is NLog.Targets.Wrappers.WrapperTargetBase)
        {
            var list = LogManager.Configuration.AllTargets.ToList();
            t = list.Find(x => x.Name == targetName + "_wrapped");
            return t;
        }
        else
        {
            return t;
        }
    } 
```

名为 emailError 的 MailTarget 的用法

```
var emailError = (MailTarget)FindTargetByName("emailError");
emailError.SmtpServer = "" //you can set or get 
```

# mysql - 找不到 mysqldump 命令 - MAMP

> ID：11452648
> 
> 赞同：1
> 
> 时间：2012-07-12T13:14:47.347
> 
> 标签：mysql, terminal, dump

运行 MAMP 时如何将 mysqldump 添加到导出路径。我尝试了一些通过谷歌找到的导出命令，但没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T18:37:53.093

首先在这里找到二进制文件使用“whereis mysqldump”

然后：PATH=$PATH:PATH_FROM_ABOVE_COMMAND 导出路径

# apache - 在没有 mod_alias 的情况下重定向（301）单页？

> ID：11452650
> 
> 赞同：0
> 
> 时间：2012-07-12T13:14:54.650
> 
> 标签：apache, .htaccess, mod-rewrite, redirect, mod-alias

如何在没有 mod_alias 的情况下为 .htaccess 中的单页创建永久重定向（301）？

铁

[http://www.example.com/oldpage](http://www.example.com/oldpage) --> [http://www.elpmaxe.com/newpage](http://www.elpmaxe.com/newpage)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T09:29:22.027

我的队友给了我很好的答案：

```
RewriteCond %{http_host} www\.example\.com$ [nc]
RewriteCond %{request_uri} ^/oldpage(/)?$ [nc]
RewriteRule ^(.*)$ http://www.elpmaxe.com/newpage [r=301,L,NC,NS,QSA] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-13T01:17:38.693

使用 mod_rewrite 和以下 .htaccess

```
RewriteEngine on
RewriteRule ^oldpage/(.*)$ newpage/$1 [R=301] 
```

# orbeon - 将表单数据和生成的 pdf 从 orbeon 发送到 Web 服务

> ID：11452653
> 
> 赞同：1
> 
> 时间：2012-07-12T13:15:05.353
> 
> 标签：orbeon

是否可以设置 Orbeon Forms 以将表单**和**pdf 中输入的数据发送到另一个站点或 Web 服务？我尝试使用[http://wiki.orbeon.com/forms/doc/developer-guide/configuration-properties/configuration-properties-form-runner#TOC-Workflow-send-button](http://wiki.orbeon.com/forms/doc/developer-guide/configuration-properties/configuration-properties-form-runner#TOC-Workflow-send-button)中所述的工作流发送按钮，但它在这种情况下，只有 xml 数据或 pdf 被发送到成功页面。

有没有其他方法可以获取用户输入的数据并生成 PDF 到另一个 Web 应用程序？我是这个领域的新手，所以我可能错过了文档中的一些明显内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T00:31:36.630

您是对的：当使用[工作流发送](http://wiki.orbeon.com/forms/doc/developer-guide/configuration-properties/configuration-properties-form-runner#TOC-Workflow-send-button)按钮和 POST 或 PUT 时，指向 PDF 或 XML 文档的 URL 将被发送到成功或错误页面。但是，*文档 ID*也作为`document`请求参数发送。所以我会：

1.  设置属性以生成 PDF，以便在 POST 或 PUT 中发送 PDF。
2.  `document`在目标页面中，使用请求参数中提供给您的文档 ID 从 URL 检索 PDF，从持久层检索 XML 。

作为请求参数发送`document`是在 3.9 版本之后实现的，因此您需要使用 Orbeon Forms 4.0 或更高版本（在撰写本文时，您可以使用[4.0 M6](http://blog.orbeon.com/2012/07/orbeon-forms-40-m6.html)）。

# wordpress - 如何按类别和标签过滤 WordPress 结果？

> ID：11452656
> 
> 赞同：0
> 
> 时间：2012-07-12T13:15:14.273
> 
> 标签：wordpress, filter, tags

我创建了一个搜索表单和 search.php 文件来显示结果。唯一的事情是，我想过滤包括标签而不是内容和标题。此过程是否有任何 wordpress 功能？

搜索表格代码：

```
<?php if(is_category(array('general-support','activities','discount-cards','equipment','financial','holidays','medical','respite')) || is_single()){?>

<div style="width:auto; margin:0px 40px 0px 20px;">

    <form role="search" action="<?php bloginfo('siteurl');?>" style="margin:0px; padding:0px;">

        <div>
            <h2>Search for</h2>
            <div><input type="text" name="s" id="s" style="width:100%; padding:5px; border:1px solid #ccc; box-shadow:inset 1px 1px 1px #f0f0f0;" /></div>
            <div><input type="hidden" value="14,16,21,18,20,15,22,19,17" name="cat" id="scat" /></div>
        </div>

    </form>

</div>

<?php } ?> 
```

搜索.php

```
<?php query_posts($query_string . '&showposts=10'); ?>

<?php if (have_posts()) : ?>

    <?php $post = $posts[0]; // Hack. Set $post so that the_date() works. ?>

<?php while (have_posts()) : the_post(); ?>

<div <?php post_class() ?> id="post-<?php the_ID(); ?>">
    <div class="entry">

        <!--start.entry-wrapper-->
        <div class="entry-wrapper">

            <!--start.post-thumbnail-->

            <?php if(has_post_thumbnail()){?>

            <div class="post-thumbnail-wrapper">
                <a href="<?php the_permalink();?>">
                    <?php the_post_thumbnail('category-thumb'); ?>
                </a>
            </div>

            <?php } ?>

            <!--end.post-thumbnail-->

            <!--start.post-entry--->
            <div class="post-enry-wrapper">
                <h2><a href="<?php the_permalink(); ?>" title="<?php printf( esc_attr__( 'Permalink to %s', 'udesign' ), the_title_attribute( 'echo=0' ) ); ?>" rel="bookmark"><?php the_title(); ?></a></h2>
                <div class="postmetadata">
                    <?php the_content();?>              
                </div>
            </div>

            <!--end.post-entry-->
            <div class="clear"></div>
        </div>
        <!--end.entry-wrapper-->

    </div>

    <?php if(!is_category() && !is_single()){?>

    <div><?php if(function_exists('kc_add_social_share')) kc_add_social_share(); ?></div>

    <?php }?>

</div>
<div class="addGap"></div>
<?php endwhile; ?>

<div class="clear"></div>

<?php       // Pagination
if(function_exists('wp_pagenavi')) :
    wp_pagenavi();
else : ?>

    <div class="navigation">
    <div class="alignleft"><?php previous_posts_link() ?></div>
    <div class="alignright"><?php next_posts_link() ?></div>
</div>

<?php       endif; ?> 
```

请指教，我不喜欢使用任何插件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T19:32:03.063

假设我理解您的问题，这应该会有所帮助：

[http://codex.wordpress.org/Function_Reference/wp_get_post_terms](http://codex.wordpress.org/Function_Reference/wp_get_post_terms)

如果您有多个分类法（不仅仅是标签）并希望将它们合并到单个 alpha 排序数组中，请告诉我。在某个地方我有一个功能可以进行合并/排序。

# android - 可视表 [android]

> ID：11452658
> 
> 赞同：0
> 
> 时间：2012-07-12T13:15:18.160
> 
> 标签：android

我想知道是否有任何东西可以让我为我的 android 应用程序使用一个表格，就像 Microsoft excel 一样，但用户不能编辑。

我已经查看了 eclipse 中的布局，但它们似乎都不能正常运行。

我在 android 2.2 上开发

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:19:53.737

试试这个编码，以显示表格视图。

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent" android:layout_height="wrap_content" >
<TableRow android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/Show">
    <TextView android:layout_width="50dp" android:layout_height="20dp" android:textColor="#ff8000"
        android:id="@+id/Entry"  android:layout_weight="1" android:gravity="left"/>

    <TextView android:layout_width="50dp" android:layout_height="20dp" android:textColor="#ff8000"
        android:id="@+id/sales"  android:layout_weight="1" android:gravity="right" />
</TableRow>
   </TableLayout> 
```

# html - 使 div 不可索引？

> ID：11452667
> 
> 赞同：1
> 
> 时间：2012-07-12T13:15:44.230
> 
> 标签：html, indexing, search-engine

我有一个 div，其中包含一些我不想被搜索引擎索引的句子。

是否有可能以某种方式向谷歌隐藏这一点？

我考虑过使用框架，并让框架内的网站被 robots.txt 阻止，但我从不喜欢使用框架的想法。

还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:30:26.697

从技术上讲，您可以使用`iframe`并放入`<meta name=robots content=noindex>`iframed 文档。使用合适的属性和 CSS，您可以使 iframed 文档大部分显示为页面的一部分，尽管您仍然需要为其保留一些固定区域。

或者您可以`div`使用 JavaScript 生成，然后认为禁用 JavaScript 时不会看到它。请注意，搜索引擎机器人*可能会*执行 JavaScript 代码，因此*可能会*“看到”生成的内容，尽管我不认为现在或不久的将来会发生这种情况。

如果内容是文本，没有内部标记或图像等，则可以使用 CSS 规则为空`div`，该规则使用`:before`伪元素和`content`属性添加内容。对于禁用 CSS 或使用激进的用户样式表的用户，这将失败，并且搜索引擎机器人有一天可能会开始解释 CSS。

也可能有更棘手的方法，但总的来说，我认为没有好的方法。考虑一下为什么要阻止根据其内容查找页面可能更有用。作为隐藏信息的工具，它效率低下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:43:02.620

您可以从句子中创建图像，然后文本不会被索引。

# git - git diff，显示与删除和添加相同的行

> ID：11452675
> 
> 赞同：34
> 
> 时间：2012-07-12T13:15:57.427
> 
> 标签：git, git-diff

我不小心在 master 上工作，我不得不开设一个新分支。

我几乎完全恢复了它的原始形式。在一节课上，我得到了以下我无法理解的差异。

```
index 4a9abb8..7c55879 100755
--- a/includes/site.inc.php
+++ b/includes/site.inc.php
@@ -142,11 +142,11 @@ class site{

        public $tplEngine = 'smarty';

-
+       
     private $_productsByType = array();
     private $logger;
-    protected $locale = 'tr_TR';
-
+    protected $locale = 'tr_TR';  
+ 
```

它说我删除并添加了相同的东西，原则上与原始索引没有区别，我不希望这个文件被视为修改过。

我应该怎么办 ？谢谢。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-07-12T13:30:19.790

这可能是空白更改。您可以运行`git diff -w`，这将忽略任何空白更改。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-12T13:18:29.187

检查空格。被替换的“空”行中有空格。您也可能不小心将制表符替换为空格，反之亦然。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-09T19:09:55.957

除了空格/制表符之外，从不同编辑器（甚至在 Windows 上）和/或不同操作系统输入的行尾也会导致显示重复的差异行；LF (linux/Unix) 与 CRLF (Windows)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T13:21:55.167

非空行的第二个版本在分号后有一个空格，空行也有不同数量的空格。

应该有一个选项可以让 git 突出显示这些隐藏的空间，以便差异提供更多信息，但我没有手边的手册。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-12T13:20:03.430

检查空格或行尾差异。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-01-16T13:30:40.733

由于命令行输出中有时不显示尾随空格，因此使用

```
git difftool 
```

在将 vimdiff 指定为您的 difftool via 之后`git config --global diff.tool vimdiff`可能会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-07T10:16:41.687

请注意，如果您使用新选项， [git 1.8.4（2013 年 7 月）](https://github.com/git/git/blob/master/Documentation/RelNotes/1.8.4.txt#L49-L51)将不再向您显示只有空行的更改。`-B`

> " `git diff`" 学习了一种忽略 hunks 的模式，其更改仅包括添加和删除空白行，这与`diff -B`GNU diff 的 " "（忽略空白行）相同。

请参阅[提交 36617af7ed594d1928554356d809bd611c642dd2](https://github.com/git/git/commit/36617af7ed594d1928554356d809bd611c642dd2)：

> 补丁的目标是尽可能地引入 GNU diff `-B/--ignore-blank-lines`。短选项不可用，因为它已用于“ `break-rewrites`”。
> 
> 使用此选项时，`git diff`不会创建仅添加或删除空行的块，但如果它们足够接近“有价值的”更改，仍将显示空行添加/抑制。
> 
> 以下是对该选项的更详尽描述：
> 
> *   真正的变化很有趣
> *   与有趣的变化足够接近（小于上下文大小）的空行被认为是有趣的（递归定义）
> *   每个有趣的变化都使用“上下文”行
> *   如果两个块之间的间隔小于“inter-hunk-context”，它们将合并为一个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-22T18:40:58.867

有时会发生这种情况，因为 git 使用的默认 diff 算法使用启发式方法来消除昂贵的边缘情况，这可能会导致次优结果。

我遇到了一个与此相同的问题，由于空格、行尾等原因我无法解释。 `git diff`正在显示一个被删除然后重新添加的特定行，作为显示为 3 行已删除和添加了 2 行，但实际上删除了 2 行并添加了 1 行。其他差异程序显示预期的 2 行已删除和 1 行添加。

发生这种情况的文件有 4736 行 (114 KB)，差异总计为 640 次插入和 1340 次删除，有问题的大块位于文件中间。我无法将它简化为一个更小的测试用例，它表现出同样的问题：在任何地方进行最轻微的扰动都会使问题消失。我唯一的结论是我陷入了差异算法启发式的这些边缘案例之一。

除了默认的，Git 还支持[多种其他差异算法。](https://git-scm.com/docs/diff-options/2.8.2)通过将算法切换到 、 或 中的任何一个`minimal`，`patience`我`histogram`的问题在这种情况下就消失了。

另请参阅来自嵌入式 LibXDiff 库的 git 源代码中的[此注释](https://github.com/git/git/blob/master/xdiff/xdiffi.c#L37)。

# jquery - jQueryUI：正确删除可拖动元素

> ID：11452677
> 
> 赞同：7
> 
> 时间：2012-07-12T13:16:05.193
> 
> 标签：jquery, jquery-ui

我正在开发一个可视化编辑器，该编辑器需要用户可以随意添加、删除和拖动元素。每个元素都可以`div`使用 jQueryUI 进行拖动。新元素被附加到`div`代表工作空间的父元素。每个元素内部都有一个按钮来删除它。这一切都很好。

我遇到的问题是，当我删除不是最近创建的元素时，所有其他可拖动元素都会改变位置。这似乎是由使用`relative`定位的可拖动元素引起的。

目前，我的删除功能只是调用`$('#item-x').remove()`. 还有另一种方法我应该删除可拖动元素吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-12T13:19:06.287

尝试`.draggable("destroy")`改用。我用得很好。

[您可以在jqueryUI Draggable destroy](http://jqueryui.com/demos/draggable/#method-destroy)查看此方法和所有其他方法、选项和事件

**更新**

对不起，我认为你的问题是别的。您需要做的是改变您的方法，因为从 dom 中删除元素实际上与元素存在无关`draggable`。您需要用一个元素封装您的可拖动对象，例如与您的可拖动对象具有相同高度和宽度的 div，然后随意销毁可拖动对象。

HTML：

```
<div id="conteiner">
   <div class="dragConteiner"><div id="draggable1" class="draggable"></div></div>
   <div class="dragConteiner"><div id="draggable2" class="draggable"></div></div>
   <div class="dragConteiner"><div id="draggable3" class="draggable"></div></div>
</div> 
```

jQuery：

```
$(function(){

  $("#draggable1").draggable();
  $("#draggable2").draggable();
  $("#draggable3").draggable();
  $("#draggable2").on('mouseup',function(){
    alert('bye draggable!');
    $(this).draggable('destroy');
    //in case you like to use if after
    //$(this).hide();
    //as in your code
    $(this).remove();
  })
}) 
```

CSS：

```
.draggable{
  height:50px;
  width:50px;
  background: green;    
}

.dragConteiner{
   height:50px;
   width:50px;
   margin-top:5px;    
}

#conteiner{
   margin-top:25px;
   margin-left:25px;
} 
```

​​一个[jsfiddle](http://jsfiddle.net/tHZTM/6/)示例

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:15:01.883

原来这个问题是这个问题的副本[，](https://stackoverflow.com/questions/6904531/jquery-ui-draggable-absolute-instead-of-relative)但我正在寻找错误的东西。

根据另一个问题，解决方案是简单地将元素更改为具有绝对定位。然而，我发现我的元素总是会恢复到相对定位，即使我在他们的 CSS 中指定它们应该是绝对的，所以现在我这样做：

```
$('#item-x').draggable().css("position", "absolute"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-03T23:11:38.543

由于某些原因破坏功能不起作用。如果你想从元素中完全删除拖动属性，试试这个

```
var temp = $("#dragItem").draggable().remove(); 
```

这通过删除可拖动属性返回元素。捕获临时变量并将其分配回父元素

```
$(temp).appendTo("#parentContainer") 
```

让我知道这个是否奏效。

# php - 如何获取字符串中带点的数字数据？

> ID：11452678
> 
> 赞同：1
> 
> 时间：2012-07-12T13:16:07.347
> 
> 标签：php

有一个字符串变量，其中包含带点的数字数据，例如`$x = "OP/1.1.2/DIR";`。数字数据的位置可以在任何情况下根据用户的需要在应用程序中修改，斜线可以被任何其他字符改变；但虚线数字数据是强制性的。`1.1.2`那么如何从字符串中提取点数数据呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T13:23:03.963

使用[正则表达式](http://www.regular-expressions.info/)：

```
(\d+(?:\.\d+)*) 
```

分解：

*   `\d+`查找一位或多位数字
*   `\.`文字十进制`.`字符
*   `\d+`后跟一个或多个数字
*   `(...)*`这意味着匹配此模式的 0 次或多次出现
*   `(?:...)`这告诉引擎不要为这个组创建反向引用（基本上，我们不使用引用，所以有一个没有意义）

你没有提供太多关于数据的信息，所以我做了以下假设：

*   数据将始终包含至少一个数字
*   数据可能只包含一个没有点的数字
*   数据可能包含多位数字
*   数字本身可以包含任意数量的点/数字对

如果这些假设中的任何一个不正确，您将不得不修改正则表达式。

示例用法：

```
$x = "OP/1.1.2/DIR";

if (!preg_match('/(\d+(\.\d+)*)/', $x, $matches)) {
    // Could not find a matching number in the data - handle this appropriately
} else {
    var_dump($matches[1]); // string(5) "1.1.2"
} 
```

# ruby-on-rails - rails 重构查询以实现正确的 sql 注入

> ID：11452680
> 
> 赞同：0
> 
> 时间：2012-07-12T13:16:10.373
> 
> 标签：ruby-on-rails, activerecord

这是原始查询

```
where(countries.map{|c| "zones.countries LIKE '%#{c}%'"}.join(' OR ')) 
```

现在我会用 ? 重写这个查询？像这样的运营商

```
where(countries.map{|c| "zones.countries LIKE ?", "%#{c}%"}.join(' OR ')) 
```

但它不起作用。有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:24:37.990

```
where(countries.map { |c| "zones.countries LIKE ?" }.join(" OR "), *countries.map{ |c| "%#{c}%"}) 
```

您可以用这样的`where`东西替换上面的第一个参数以避免一个循环

```
("zones.countries LIKE ? OR " * countries.size).gsub(/ OR $/, '') 
```

# javascript - Javascript 未在网站上加载，但在 jsfiddle 上

> ID：11452686
> 
> 赞同：-2
> 
> 时间：2012-07-12T13:16:33.550
> 
> 标签：javascript, html

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:18:29.997

查看错误控制台：

```
Uncaught ReferenceError: $ is not defined 
```

您的网站缺少 jQuery。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:19:42.960

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:18:23.960

你还没有定义一个`$`函数。

jsfiddle 版本从 jQuery 1.7.2 加载一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T13:18:26.380

如果您打开控制台，您将看到以下错误消息：

> 未捕获的 ReferenceError：$ 未定义

您没有加载 jQuery 库。

# android - How to clear the Child activities on clicking the particular tab

> ID：11452689
> 
> 赞同：0
> 
> 时间：2012-07-12T13:16:46.143
> 
> 标签：android, android-tabhost, android-tabs

I want to know how to clear child activities and how to invoke the parent activity of a particular tab on its second click (tab functionality like on iPhone?). I want to invoke the click listener for each tab. Assume as if the application gets deeper while using, it's hard to use the back button often to reach the parent activity. So i need to invoke the parent activity by clicking the tab.

On first tab it is working fine, here is the code

```
getTabWidget().getChildAt(0).setOnClickListener(new OnClickListener() { 
    public void onClick(View v) {      
        if (getTabHost().getCurrentTabTag().equals("gebrauchte")) { 
            Intent intent = new Intent(getApplicationContext(),TabHome.class);
            intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
            startActivity(intent);
        } else{                 
            tabs.setCurrentTab(0);  
        }
    }
}); 
```

I tried to use the same code for the second tab with getChildAt(1), should i give TabHome class for all intent, if I try to give their respective class of 2nd, 3rd and 4th tab, the tabHost gets hidden.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:32:11.737

您不需要在选项卡上设置 onClickListener。我建议使用[带有 Fragments 的 Android 选项卡](http://android.codeandmagic.org/2011/07/android-tabs-with-fragments/)

# php - PHP strtotime function - not safe to rely on system's timezone?

> ID：11452692
> 
> 赞同：1
> 
> 时间：2012-07-12T13:16:54.137
> 
> 标签：php, strtotime

I want to convert a date - 2012-05-25 to the unix timestamp. When i'm using the strtotime() function, it says

> PHP Warning: strtotime(): It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected 'Asia/Calcutta' for 'IST/5.0/no DST' instead in /var/www/html/__modules/tickets/library/Notification/RD_time.php on line 323.

Please help me out. I need to flush these reports by tonight.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-12T13:18:14.537

只需按照警告中的说明进行操作并使用[`date_default_timezone_set`](http://php.net/manual/en/function.date-default-timezone-set.php)

例如：

```
date_default_timezone_set('America/New_York'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-28T11:08:50.900

您可以在代码开头添加以下内容：

```
date_default_timezone_set('Africa/Lagos');//or change to whatever timezone you want 
```

如果你想这样做一次，你可以把时区放在你的 php.ini 文件中。您可以搜索`date.timezone`，您的 php.ini 文件中应该有这样的块：

```
[Date]
; Defines the default timezone used by the date functions
; http://php.net/date.timezone
date.timezone = Africa/Lagos 
```

请务必重新启动服务器（`service httpd restart`在 linux 上）。

时区列表可以在这里找到[http://www.php.net/manual/en/timezones.php](http://www.php.net/manual/en/timezones.php)。

# xml - 在 xslt 中添加更多逻辑

> ID：11452699
> 
> 赞同：0
> 
> 时间：2012-07-12T13:17:19.280
> 
> 标签：xml, xslt, xslt-1.0, xslt-2.0

我的输入 XML 文件

```
<employerinfo id="2242">
<Employer>
 <Employeedetail>Sam SR Engineer 10%</Employeedetail>
 <Employeedetail>Sam SR 26%</Employeedetail>
 <Employeedetail>Sam SR</Employeedetail>
<Employeedetail>Sam GRTE</Employeedetail>
</Employer >
</employerinfo> 
```

预期的输出文件

```
<Employer>
<Employeedetails>
 <Employeedetail1>
  <Employeedetail>
   <Name>Sam</Name>
   <Grade>SR Engineer</Grade>
   <Experience>10</Experience>
  </Employeedetail>
  <Employeedetail>
   <Name>Sam</Name>
   <Grade>SR</Grade>
   <Experience>26</Experience>
 <Employeedetail>
   <Name>Sam</Name>
   <Grade>SR</Grade>
   <Experience>10</Experience>
</Employeedetail>
 <Employeedetail>
   <Name>Sam</Name>
   <Grade>GRTE</Grade>
   <Experience>10</Experience>
</Employeedetail >
</Employeedetail1>
</Employeedetails>
</Employer> 
```

我尝试在 Google 中搜索这种类型的 XML 如何在 xslt 1.0 和 xslt 2.0 中执行

其他几个 Stack Overflow 用户也帮助了我。但这仍然是最终的细节输入 XML。

如果我在 XML 中添加了额外的父节点并且如果我在 XSLT 中进行了修改，我将没有得到值

请帮我

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:42:04.877

到目前为止，这是我的解决方案：

```
<?xml version='1.0' encoding="UTF-8"?>

<xsl:stylesheet
    xmlns:xsl='http://www.w3.org/1999/XSL/Transform'
    version='1.0'
    >
<xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

<xsl:template match="Employer">
<Employer>
<Employeedetails>
<Employeedetail1>
<xsl:apply-templates select="Employeedetail"/>
</Employeedetail1>
</Employeedetails>
</Employer>
</xsl:template>

<xsl:template match="Employeedetail">
<Employeedetail>
<xsl:variable name="s1" select="normalize-space(.)"/>
<xsl:variable name="name" select="substring-before($s1,' ')"/>
<Name><xsl:value-of select="$name"/></Name>

<xsl:variable name="s2" select="substring-after($s1,' ')"/>
<xsl:call-template name="t">
    <xsl:with-param name="s" select="$s2"/>
    <xsl:with-param name="grade"></xsl:with-param>
    <xsl:with-param name="exp"></xsl:with-param>
</xsl:call-template>
</Employeedetail>
</xsl:template>

<xsl:template name="t">
<xsl:param name="s"/>
<xsl:param name="grade"/>
<xsl:param name="exp"/>
<xsl:choose>
    <xsl:when test="contains($s,' ')">
        <xsl:call-template name="t">
            <xsl:with-param name="s" select="substring-after($s,' ')"/>
            <xsl:with-param name="grade"><xsl:value-of select="$grade"/><xsl:text> </xsl:text><xsl:value-of  select="substring-before($s,' ')"/></xsl:with-param>
            <xsl:with-param name="exp"><xsl:value-of  select="substring-after($s,' ')"/></xsl:with-param>
        </xsl:call-template>
    </xsl:when>
    <xsl:otherwise>
        <xsl:choose>
            <xsl:when  test="string-length($exp)&gt;0">
                <Grade><xsl:value-of select="normalize-space($grade)"/></Grade>
                <Experience><xsl:value-of select="$exp"/></Experience>
            </xsl:when>
            <xsl:otherwise>
                <Grade><xsl:value-of select="normalize-space($s)"/></Grade>
                <Experience>10</Experience>
            </xsl:otherwise>
        </xsl:choose>

    </xsl:otherwise>
</xsl:choose>
</xsl:template>

</xsl:stylesheet> 
```

结果：

```
<Employer>
  <Employeedetails>
    <Employeedetail1>
      <Employeedetail>
        <Name>Sam</Name>
        <Grade>SR Engineer</Grade>
        <Experience>10%</Experience>
      </Employeedetail>
      <Employeedetail>
        <Name>Sam</Name>
        <Grade>SR</Grade>
        <Experience>26%</Experience>
      </Employeedetail>
      <Employeedetail>
        <Name>Sam</Name>
        <Grade>SR</Grade>
        <Experience>10</Experience>
      </Employeedetail>
      <Employeedetail>
        <Name>Sam</Name>
        <Grade>GRTE</Grade>
        <Experience>10</Experience>
      </Employeedetail>
    </Employeedetail1>
  </Employeedetails>
</Employer> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T16:56:53.443

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:strip-space elements="*"/>
<xsl:output indent="yes" omit-xml-declaration="yes"/>

<xsl:template match="Employer">
 <Employer>
  <Employeedetails>
   <Employeedetail1>
    <xsl:apply-templates/>
   </Employeedetail1>
  </Employeedetails>
 </Employer>
</xsl:template>

<xsl:template match="Employeedetail">
 <xsl:analyze-string select="." regex="^(.*) ((SR|GR).*?)( ([0-9]+)%)?$">
  <xsl:matching-substring>
   <Employeedetail>
    <Name><xsl:value-of select="regex-group(1)"/></Name>
    <Grade><xsl:value-of select="regex-group(2)"/></Grade>
    <Experience><xsl:value-of select="if(regex-group(5)) then regex-group(5) else 10"/></Experience>
   </Employeedetail>
  </xsl:matching-substring>
 </xsl:analyze-string>
</xsl:template>

</xsl:stylesheet> 
```

# android - -webkit-tap-highlight-color in Android 3 browser

> ID：11452702
> 
> 赞同：3
> 
> 时间：2012-07-12T13:17:32.387
> 
> 标签：android, webkit

We have a form with a number of inputs. Whenever I tap the form, it's highlighted gray.

I have

```
* { -webkit-tap-highlight-color: rgba(255,255,255,0); } 
```

(I used rgba(255,255,255,0) as well)

This disables this highlight behavior on iOS5 and Android 4\. Android 2.3.4 doesn't highlight as well (I suppose it just doesn't have this behavior).

But on Galaxy Tab 10.1 the gray box is still there - any way to fix it?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-04T13:52:43.387

您的问题可以通过以下方式解决：

```
* {
    -webkit-tap-highlight-color: transparent;
} 
```

# sql-server - 在 ORDER BY 中首先放置某一行

> ID：11452708
> 
> 赞同：2
> 
> 时间：2012-07-12T13:18:01.383
> 
> 标签：sql-server, tsql

我想更改由选择产生的记录的顺序。

我希望某条记录在我的列表中排在第一位，其他记录排在后面。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T13:19:28.970

```
ORDER BY CASE WHEN col = 'something' -- whatever identifies "a certain row"
  THEN 1 ELSE 2 END,
  col; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-12T13:21:33.510

你可以[`CASE`](http://msdn.microsoft.com/en-us/library/ms181765.aspx)在`ODRER BY`

```
SELECT Col1, Col2
FROM Table
ORDER BY 
  CASE WHEN Col1 = @certainrecord THEN 0 ELSE 1 END
, Col1
, Col2 
```

# asp.net - 回发时 IE8 asp.net 导航取消错误

> ID：11452710
> 
> 赞同：0
> 
> 时间：2012-07-12T13:18:08.097
> 
> 标签：asp.net, internet-explorer-8, dns, postback

在我们公司，我们购买了一个正在 Intranet 区域测试的 Web 应用程序。我们使用的是 IE 8。

基本上，在特定页面上，有几个按钮，其中一个填充了一个相当大的网格视图。

然后，当我单击另一个导致回发的按钮时，我立即得到一个“取消网页导航（DNS 错误）”。

起初我认为这可能是 URL 太长的问题，但事实并非如此。

然后，供应商在他的计算机上执行了相同的操作，并且运行正常。显然，这不是网站本身的问题，而可能是 IE8 的配置问题。

遗憾的是，我们无法使用 Firefox 或 IE9 进行测试。我们被 IE8 卡住了。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:27:49.633

看看[这个线程](http://answers.microsoft.com/en-us/ie/forum/ie8-windows_other/dns-error-server-cannot-be-found-ever-on-ie8-on-my/d5422e90-7ca7-4548-af7a-5984adecd50d)上的答案，特别是 SpritX 的答案。发生这种情况的原因有很多，您可以在讨论中尝试一些解决方案。

# build - 如何在 MacOSX Lion 上构建 pHash（使用最新的 ffmpeg-devel）

> ID：11452712
> 
> 赞同：2
> 
> 时间：2012-07-12T13:18:18.597
> 
> 标签：build, compiler-errors, ffmpeg, osx-lion, phash

在 OSX 上构建 pHash 0.9.4 可能会很棘手。对于那些遇到问题的人，我在下面的冗长回答可能会有所帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T06:53:25.830

确保您的 macports 已完全更新并正常工作。这意味着最近的 Xcode，并在 Xcode 首选项->下载->组件中安装命令行工具！

```
$ sudo port selfupdate

# if you've had previous build issues:
$ sudo port clean --all

# get pHash
wget http://www.phash.org/releases/pHash-0.9.4.tar.gz
tar zxvf pHash-0.9.4.tar.gz
cd pHash-0.9.4

# remove old versions of ffmpeg, e.g.
$ sudo port installed ffmpeg
$ sudo port uninstall --follow-dependents ffmpeg @0.7.11_1+mmx
$ sudo port uninstall --follow-dependents ffmpeg @0.7.8_0

# install latest ffmpeg-devel version (@20120329 for me) - enable the non-free stuff as well
$ sudo port install ffmpeg-devel +nonfree

# double check that you have some new header files
$ ll -tr /opt/local/include/

total 8816
-rw-r--r--    1 root  admin      191 Dec 23  2004 lua.hpp
-rw-r--r--    1 root  admin     1026 Dec 27  2007 lualib.h
-rw-r--r--    1 root  admin     5777 Dec 27  2007 lauxlib.h
...

drwxr-xr-x    6 root  admin      204 Jul 12 17:27 libmodplug
drwxr-xr-x    3 root  admin      102 Jul 12 17:32 libswscale
drwxr-xr-x    3 root  admin      102 Jul 12 17:32 libswresample
drwxr-xr-x    3 root  admin      102 Jul 12 17:32 libpostproc
drwxr-xr-x   41 root  admin     1394 Jul 12 17:32 libavutil
drwxr-xr-x    5 root  admin      170 Jul 12 17:32 libavformat
drwxr-xr-x    8 root  admin      272 Jul 12 17:32 libavfilter
drwxr-xr-x    3 root  admin      102 Jul 12 17:32 libavdevice
drwxr-xr-x   10 root  admin      340 Jul 12 17:32 libavcodec

# get CImg and copy CImg.h into your pHash dir
$ cd ..
$ wget http://downloads.sourceforge.net/project/cimg/CImg-1.5.0.zip
$ unzip CImg-1.5.0.zip
$ cp CImg-1.5.0/CImg.h pHash-0.9.4/
$ cd pHash-0.9.4

# copy the JNI headers from your Java SDK into your pHash dir - for 1.7.0 they're here:
$ cp /Library/Java//JavaVirtualMachines/1.7.0.jdk/Contents/Home/include/jni.h ./
$ cp /Library/Java//JavaVirtualMachines/1.7.0.jdk/Contents/Home/include/darwin/jni_md.h ./

# install libsndfile, libsamplerate and mpg123 if not installed already
$ sudo port install libsndfile
$ sudo port install libsamplerate
$ sudo port install mpg123

# now run configure, with Java enabled as you likely want those cool bindings, and expect the missing libavcodec error:
$ ./configure --enable-java 
```

或者这会更有意义：

```
$ ./configure --enable-java CPPFLAGS="-I/opt/local/include" LDFLAGS="-L/opt/local/lib" 
```

但是 configure 完全忽略了新的 include/lib 路径 :( 似乎它们是在 configure 内部硬编码的。

```
...
checking CImg.h usability... no
checking CImg.h presence... no
checking for CImg.h... no
checking whether CImg.h is in the current or src directory.... yes

*** Configuring video Hash ***

checking whether FFmpeg is present... checking for avcodec_alloc_frame in -lavcodec... no
configure: error: 

*** libavcodec not found. 
```

那么既然 configure 期望所有的库和包含在 /usr/local/ （而不是 /opt/local）中，我不能让它在别处寻找，唯一剩下要做的就是暴力破解它！:D

```
# edit ./configure as follows
$ nano configure
CTRL-W -> search for ' -L/' (note the space)

# edit the lines as follows
LDFLAGS="$LDFLAGS -L/usr/local/lib -L/opt/local/lib"
CPPFLAGS="$CPPFLAGS -I/usr/local/include -I/opt/local/include"  

# Or do the newbie version (I actually did this the first time!)
$ sudo mv /usr/local/lib /usr/local/lib-foo
$ sudo mv /usr/local/include/ /usr/local/include-foo
$ sudo ln -s /opt/local/lib /usr/local/lib
$ sudo ln -s /opt/local/include /usr/local/include

$ ll /usr/local/

total 16
drwxr-xr-x  32 root  wheel  1088 Jun 29 18:04 bin
drwxr-xr-x   3 root  wheel   102 Mar  6 14:40 etc
lrwxr-xr-x   1 root  wheel    18 Jul 12 19:27 include -> /opt/local/include
drwxr-xr-x  11 root  wheel   374 Jul 12 19:22 include-foo
lrwxr-xr-x   1 root  wheel    14 Jul 12 19:27 lib -> /opt/local/lib
drwxr-xr-x  25 root  wheel   850 Jul 12 19:23 lib-foo
drwxr-xr-x   8 root  wheel   272 Oct 11  2010 sbin
drwxr-xr-x   4 root  wheel   136 Jun 12 11:52 share

# at this point ./configure should work ok 
```

是时候运行 make - 你会得到一堆错误：

```
$ make

# on to the code bits:
# we need to adjust src/cimgffmpeg.cpp to support the latest version of ffmpeg
# a few things have moved from being deprecated to having been completely changed:

$ make 2>&1 | grep error

cimgffmpeg.cpp:57: error: 'av_open_input_file' was not declared in this scope
cimgffmpeg.cpp:70: error: 'CODEC_TYPE_VIDEO' was not declared in this scope
cimgffmpeg.cpp:134: error: 'avcodec_decode_video' was not declared in this scope
cimgffmpeg.cpp:202: error: 'av_open_input_file' was not declared in this scope
cimgffmpeg.cpp:216: error: 'CODEC_TYPE_VIDEO' was not declared in this scope
cimgffmpeg.cpp:283: error: 'avcodec_decode_video' was not declared in this scope
cimgffmpeg.cpp:339: error: 'av_open_input_file' was not declared in this scope
cimgffmpeg.cpp:357: error: 'av_open_input_file' was not declared in this scope
cimgffmpeg.cpp:368: error: 'CODEC_TYPE_VIDEO' was not declared in this scope
cimgffmpeg.cpp:399: error: 'av_open_input_file' was not declared in this scope
cimgffmpeg.cpp:410: error: 'CODEC_TYPE_VIDEO' was not declared in this scope

# change as follows; left: original downloaded source, right: modified source 

$ diff ~/Downloads/pHash-0.9.4-fresh/src/cimgffmpeg.cpp ~/dev/pHash-0.9.4/src/cimgffmpeg.cpp

57c57
<       if(av_open_input_file(&st_info->pFormatCtx, st_info->filename, NULL, 0, NULL)!=0)
---
>       if(avformat_open_input(&st_info->pFormatCtx, st_info->filename, NULL, NULL)!=0)

70c70
<       if(st_info->pFormatCtx->streams[i]->codec->codec_type==CODEC_TYPE_VIDEO) 
---
>       if(st_info->pFormatCtx->streams[i]->codec->codec_type==AVMEDIA_TYPE_VIDEO) 

134c134
<         avcodec_decode_video(st_info->pCodecCtx, pFrame, &frameFinished,packet.data, packet.size);
---
>         avcodec_decode_video2(st_info->pCodecCtx, pFrame, &frameFinished, &packet);

202c202
<       if(av_open_input_file(&(st_info->pFormatCtx),st_info->filename,NULL,0,NULL)!=0){
---
>       if(avformat_open_input(&(st_info->pFormatCtx),st_info->filename,NULL,NULL)!=0){

216c216
<           if(st_info->pFormatCtx->streams[i]->codec->codec_type==CODEC_TYPE_VIDEO) 
---
>           if(st_info->pFormatCtx->streams[i]->codec->codec_type==AVMEDIA_TYPE_VIDEO) 

282,283c282
<           avcodec_decode_video(st_info->pCodecCtx, pFrame, &frameFinished,
<                                packet.data,packet.size);
---
>           avcodec_decode_video2(st_info->pCodecCtx, pFrame, &frameFinished, &packet);

339c338
<   if (av_open_input_file(&pFormatCtx, file, NULL, 0, NULL))
---
>   if (avformat_open_input(&pFormatCtx, file, NULL, NULL))

357c356
<   if (av_open_input_file(&pFormatCtx, file, NULL, 0, NULL))
---
>   if (avformat_open_input(&pFormatCtx, file, NULL, NULL))

368c367
<        if(pFormatCtx->streams[i]->codec->codec_type==CODEC_TYPE_VIDEO) 
---
>        if(pFormatCtx->streams[i]->codec->codec_type==AVMEDIA_TYPE_VIDEO) 

399c398
<   if (av_open_input_file(&pFormatCtx, filename, NULL, 0, NULL))
---
>   if (avformat_open_input(&pFormatCtx, filename, NULL, NULL))

410c409
<            if(pFormatCtx->streams[i]->codec->codec_type==CODEC_TYPE_VIDEO) 
---
>            if(pFormatCtx->streams[i]->codec->codec_type==AVMEDIA_TYPE_VIDEO) 
```

我敢肯定，这很有趣，不用担心我们快到了。

```
# make should now complete with only useless warnings
$ make
$ sudo make -n install

# if all went well you've not got pHash with Java bindings
# let's build the Java files and test it

$ cd ll bindings/java/org/phash/
$ javac *.java

# go back to the Java bindins root and run
$ cd ../..

# oh yeah.. if you actually DID rename the include/lib dirs previously then: 
$ sudo rm /usr/local/lib
$ sudo rm /usr/local/include
$ sudo mv /usr/local/include-foo/ /usr/local/include
$ sudo mv /usr/local/lib-foo/ /usr/local/lib

# drum roll..
$ java -Djava.library.path=/usr/local/lib org/phash/pHash -mh ~/Downloads/s01.jpg ~/Downloads/s02.jpg 
File 1: /Users/xxx/Downloads/s01.jpg
File 2: /Users/xxx/Downloads/s02.jpg
0.3159722222222222

# now go try out your image recognition app ideas ;) 
```

# javascript - 拉斐尔剪辑图像问题

> ID：11452713
> 
> 赞同：1
> 
> 时间：2012-07-12T13:18:22.133
> 
> 标签：javascript, image, raphael, crop

好的，我知道标题很模糊，但这是我更具体的问题。目前，我试图避免使用 PHP 和 SQL 来存储我正在使用的裁剪工具中的数据点。裁剪工具为我提供了左上角 (x,y) 坐标和右下角 (x, y) 坐标，他们希望我将它们提交给 PHP 数据库以制作漂亮的图片。

我找到了 Raphael 并注意到他们有一个 clip-rect 工具，可以让你剪裁图像，它会显示剪裁的图像。我想要做的是拍摄那个剪裁的图像并用它填充拉斐尔圆。

```
var paper = Raphael(10, 50, 500, 400);

        var paperCenter_X = 500/2;
        var paperCenter_Y = 400/2;

        //var circle = paper.circle(50, 40, 60);
        var circle = paper.circle(paperCenter_X, paperCenter_Y, 100);

        circle.attr("stroke", "#000");
        var grabImage = document.getElementById("jelly");

        var src = grabImage.src;
        //alert(src);
        var img = paper.image(src, 10, 10, 800, 600);
            img.attr({"clip-rect":"0 0 100 150"});
        //var newImage = new Image();
        //newImage.src = img.src;
        alert(newImage.src);

        circle.attr({fill: 'url("'+img+'")'}); 
```

所以我注释掉的东西是我试过的东西，只是不起作用。理想情况下，我想做的只是用 img.attr({"clip-rect":"0 0 100 150"}); 填充圆圈。关于如何做到这一点的任何建议都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T17:39:52.587

我怀疑它是否可能使用 RaphaelJS，但使用直接 SVG 是可能的。

它使用 SVG 模式标签完成。

试试这个代码

```
<?xml version="1.0" encoding="UTF-8"?>
<svg version="1.1"
     baseProfile="full"
     xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     xmlns:ev="http://www.w3.org/2001/xml-events">
    <title>Text Pattern Fill Example</title>
    <defs>
        <pattern id="img1" patternUnits="userSpaceOnUse" width="600" height="450">
            <image xlink:href="http://lorempixel.com/600/500/" x="0" y="0"
                width="600" height="450" />
        </pattern>
    </defs>
    <path d="M5,50
             l0,100 l100,0 l0,-100 l-100,0
             M215,100
             a50,50 0 1 1 -100,0 50,50 0 1 1 100,0
             M265,50
             l50,100 l-100,0 l50,-100
             z"
          fill="url(#img1)" />    
</svg> 
```

在这里演示 [http://jsfiddle.net/5kJSa/](http://jsfiddle.net/5kJSa/)

原始代码取自这里[http://www.boogdesign.com/examples/svg/path-pattern-fill.svg](http://www.boogdesign.com/examples/svg/path-pattern-fill.svg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T17:55:52.657

另一个答案。

与原始代码的小偏差。

我使用带圆角的矩形而不是圆形，并使用了填充属性。

```
<img id="jelly" src="http://lorempixel.com/400/200/" style="display:none;" />

<script type="text/javascript">
    var paper = Raphael(10, 50, 500, 400);

        var paperCenter_X = 500/2;
        var paperCenter_Y = 400/2;

var grabImage = document.getElementById("jelly");
var src = grabImage.src;

paper.rect(0, 0, 200, 200, 600).attr({
    fill: "url("+src+")",
    "stroke-width": 2
});

// Commenting your original code.
/*
        //var circle = paper.circle(50, 40, 60);
        var circle = paper.circle(paperCenter_X, paperCenter_Y, 100);

        circle.attr("stroke", "#000");
        var grabImage = document.getElementById("jelly");

        var src = grabImage.src;
        //alert(src);
        var img = paper.image(src, 10, 10, 800, 600);
            img.attr({"clip-rect":"0 0 100 150"});
        //var newImage = new Image();
        //newImage.src = img.src;
        alert(newImage.src);

circle.attr({fill: 'url("'+img+'")'});

*/

</script>
​ 
```

在这里检查小提琴[http://jsfiddle.net/8XmqM/](http://jsfiddle.net/8XmqM/)

一个非常基本的代码版本如下所示

```
var paper = Raphael(10, 50, 500, 500);
paper.rect(0, 0, 200, 200, 600).attr({
    fill: "url(http://lorempixel.com/400/200/)",
    "stroke-width": 2
});​ 
```

# xml - 有没有办法使用 Visual Studio 快速识别文件中格式错误的 xml 组件？

> ID：11452715
> 
> 赞同：2
> 
> 时间：2012-07-12T13:18:24.253
> 
> 标签：xml, visual-studio-2010

我有几个以奇怪的方式损坏的大型 XML 文件……某些字符以看似随机的间隔添加/删除。

当我将文本粘贴到 Visual Studio 中的 XML 文件中时，IDE 将通过加下划线来识别文件的问题（非法字符、缺少空格等）。问题是，这些文件非常大，我不想尝试滚动浏览它们，寻找红色的波浪线。

有没有办法（比如一些快捷键/序列）从一个问题区域跳到下一个问题区域？这些文件中的数据已经是可疑的，但如果我至少可以将它们加载到我的导入器中，那么其他问题将更容易解决。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T13:46:23.327

正如 Oded 所说，可以通过在错误列表窗口中双击它们来快速导航到 XML 错误。我找不到快捷键，但这不是非常必要的。这就足够了。

# emacs - 如何在 elisp 中为交互式缓冲区设置名称

> ID：11452724
> 
> 赞同：3
> 
> 时间：2012-07-12T13:18:51.170
> 
> 标签：emacs, elisp

我在 emacs 中定义了以下函数 -

```
(defun web2py-server ()
 (interactive)
 (shell-command "cd /opt/web2py; python /opt/web2py/web2py.py &")) 
```

以上在emacs中创建了一个新的缓冲区，如何为窗口设置一个名称“abc”。

谢谢，穆尔塔萨

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T13:49:59.543

您可以通过调用以交互方式执行此操作`M-x rename-buffer`，也可以将名称添加到函数中：

```
(defun web2py-server () 
  (interactive) 
  (shell-command "cd /opt/web2py; python /opt/web2py/web2py.py &")
  (rename-buffer "abc")) 
```

编辑：

如果您想要一个持续的交互式过程，最好`start-process`使用`shell-command`. 这允许您在启动进程时指定输出缓冲区。否则，莫里茨的答案看起来比我原来的要好。如果您对 start-process 感兴趣，可以先将您的`shell-command`行替换为以下内容：

```
(let ((default-directory "/opt/web2py"))
  (start-process "my-server" "abc" "python" "/opt/web2py/web2py.py") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-12T14:08:57.070

使用`shell-command`的第二个参数 ,`OUPTUT-BUFFER`为此：

```
(defun web2py-server ()
 (interactive)
 (shell-command "cd /opt/web2py; python /opt/web2py/web2py.py &"
                (get-buffer-create "abc"))) 
```

# javascript - .live("keyup") 上的 jQuery 崩溃

> ID：11452728
> 
> 赞同：0
> 
> 时间：2012-07-12T13:19:00.467
> 
> 标签：javascript, jquery, keyup

我这里有一些代码：

```
$(document).ready(function() {
$("#querybox").live("keyup", function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if (code == 13) {
       $("#querybox").blur();
    }
    else {
        search(document.getElementById('querybox').value);
    }

    /*if (document.getElementById('querybox').value == "") {
        $("center").removeHighlight();  
    }*/
});
}); 
```

检测到 keyUp 并使用它来搜索某些内容。问题是：当#querybox 退格到它为空的点时，整个页面崩溃，我得到“Awwww，Snap！” 来自谷歌浏览器的消息。

我正在使用 jQuery v1.7.2

谢谢一百万！

**编辑**

我还应该指出，*search()*函数突出显示正文中的文本（注意注释部分）。我正在使用[高亮](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)插件...

* * *

搜索 Fn：

```
function search(query) {
    $("center").removeHighlight();
    $(".paragraph").highlight(query);
    $(".highlight").each(function (index) {
        $(this).attr("id", "tmpforgoToByClassScrollhighlight" + index);
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:29:54.013

尝试[`.on(...)`](http://api.jquery.com/on/)改用：

```
$("#querybox").on("keyup", function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    var queryBox = this;
    if (code === 13) {   // PRESSED ENTER
       queryBox.blur();
    }
    else {
        search(queryBox.val());
    }
}); 
```

* * *

# 更新后：

您可能希望更好地了解如何执行搜索功能。

缓存其中一些 jQuery 元素，这样您就不会在每个 keyup 上一遍又一遍地选择它们。

另外，我没有浏览所有`.highlight`代码，但其中可能存在一个不允许空字符串的错误**，**这就是网站导致浏览器崩溃的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:27:19.473

您应该改用.delegate [()](http://api.jquery.com/delegate/)

```
$(document).ready(function() {
//It will be a good advice to replace body with a parent element of #querybox
$("body").delegate("#querybox","keyup", function(e) {
 var code = (e.keyCode ? e.keyCode : e.which);
  if (code == 13) {
    $("#querybox").blur();
  }
  else {
    search(document.getElementById('querybox').value);
  }

  /*if (document.getElementById('querybox').value == "") {
    $("center").removeHighlight();  
   }*/
 });
}); 
```

# ios - 如何在 iPhone 上使用 OpenGL ES 绘制实心圆？

> ID：11452729
> 
> 赞同：4
> 
> 时间：2012-07-12T13:19:00.870
> 
> 标签：ios, opengl-es

如何在 iPhone 上用 openGl 画一个实心圆圈？

我找到了很多解决方案，但没有一个有效。可能是因为有很多方法可以做到这一点。但是最短代码的方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-12T17:31:14.557

对于一个真正平滑的圆圈，您将需要一个自定义片段着色器。例如，以下顶点着色器：

```
 attribute vec4 position;
 attribute vec4 inputTextureCoordinate;

 varying vec2 textureCoordinate;

 void main()
 {
    gl_Position = position;
    textureCoordinate = inputTextureCoordinate.xy;
 } 
```

和片段着色器：

```
 varying highp vec2 textureCoordinate;

 const highp vec2 center = vec2(0.5, 0.5);
 const highp float radius = 0.5;

 void main()
 {
     highp float distanceFromCenter = distance(center, textureCoordinate);
     lowp float checkForPresenceWithinCircle = step(distanceFromCenter, radius);

     gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * checkForPresenceWithinCircle;     
 } 
```

将在您绘制到屏幕的正方形内绘制一个平滑的红色圆圈。您需要为`position`属性提供正方形的顶点，并在 X 和 Y 中为`inputTextureCoordinate`属性提供范围从 0.0 到 1.0 的坐标，但这将绘制一个与视口分辨率允许的一样锐利的圆，并且执行速度非常快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:35:10.613

一种方法是使用 GL_POINTS：

```
glPointSize(radius);
glBegin(GL_POINTS); 
glVertex2f(x,y); 
glEnd(); 
```

另一种选择是使用 GL_TRIANGLE_FAN：

```
radius = 1.0;
glBegin(GL_TRIANGLE_FAN);
glVertex2f(x, y);
for(int angle = 1; angle <= 360; angle = angle + 1)
glVertex2f(x + sind(angle) * radius, y + cosd(angle) * radius);
glEnd(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T18:49:17.233

要获得圆的verces：

```
 float[] verts=MakeCircle2d(1,100,0,0)

     public static float[] MakeCircle2d(float rad,int points,float x,float y)//x,y  ofsets
     {
            float[] verts=new float[points*2+2];
            boolean first=true;
            float fx=0;
            float fy=0;
            int c=0;
            for (int i = 0; i < points; i++)
            {
                    float fi = 2*Trig.PI*i/points;
                    float xa = rad*Trig.sin(fi + Trig.PI)+x ;
                    float ya = rad*Trig.cos(fi + Trig.PI)+y ;
                    if(first)
                    {
                        first=false;
                        fx=xa;
                        fy=ya;
                    }
                    verts[c]=xa;
                    verts[c+1]=ya;
                    c+=2;
            }
            verts[c]=fx;
            verts[c+1]=fy;
            return verts;
      } 
```

如果您想要一个空圆圈，请将其绘制为 GL10.GL_LINES

```
 gl.glDrawArrays(GL10.GL_LINES, 0, verts.length / 2); 
```

或者如果你想要一个填充的，把它画成 GL10.GL_TRIANGLE_FAN

```
 gl.glDrawArrays(GL10.GL_TRIANGLE_FAN, 0, verts.length / 2); 
```

它的 java 但很容易转换为 c++/objc

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T02:19:08.413

这是使用着色器的超快速方法...只需使用顶点缓冲区制作一个四边形，并为四边形的每个角设置 UV 从 -1 到 1。

浮动中的顶点缓冲区应该如下所示： 注意：这也需要一个索引缓冲区。

```
var verts = new float[20]
{
    -1, -1, 0,   -1, -1,
    -1, 1, 0,   -1, 1,
    1, 1, 0,   1, 1,
    1, -1, 0,   1, -1,
};

#VS
attribute vec3 Position0;
attribute vec2 Texcoord0;

varying vec4 Position_VSPS;
varying vec2 Texcoord_VSPS;

uniform vec2 Location;

void main()
{
    vec3 loc = vec3(Position0.xy + Location, Position0.z);
    gl_Position = Position_VSPS = vec4(loc, 1);
    Texcoord_VSPS = loc.xy;
}
#END

#PS
varying vec4 Position_VSPS;
varying vec2 Texcoord_VSPS;

uniform vec2 Location;

void main()
{
    float dis = distance(Location, Texcoord_VSPS);
    if (.1 - dis < 0.0) discard;

    gl_FragData[0] = vec4(0, 0, 1, 1);
}
#END 
```

# php - 显示div的单句

> ID：11452732
> 
> 赞同：0
> 
> 时间：2012-07-12T13:19:09.137
> 
> 标签：php, javascript, css

我想显示 div 的第一行，并在末尾附加“...”，然后在单击时显示整个块删除“...”。另外，我想知道如何在第二次单击时将其切换回紧凑的单行版本。

有没有一种简单的方法可以通过 javascript 做到这一点？我使用 jQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:22:46.290

我通常使用的方法是将两个版本的文本（短和长）在 HTML 中彼此相邻放置。一个是隐藏的（较长的），当您单击它时，您的 jQuery 可以在两个元素之间交换...

您可以使用 PHP 的[`substr()`](http://php.net/manual/en/function.substr.php)函数来准备您的字符串...

```
echo substr("This is a long line of text",0,9) . '...';

// This is a... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:27:16.460

```
$string = "Two birds flew over the rainbow. The second bird had a stroke.";
$shorten = substr($string, 0, strpos($string, '.')) . '...'; 
```

假设您没有任何缩写标题，这会将文本缩短为第一句。

jQuery 也很简单。

```
<script>
$(document).ready(function(){
    $('#toggle').hide();
    $('.toggle').click(function(){
        $('#toggle').toggle();
    });
});
</script>
<?php echo $shorten; ?>
<br /><a href="#" class="toggle">read more</a>
<div id="toggle"><?php echo $string; ?></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:33:26.340

可能不是最优雅的解决方案，但应该可以工作......

```
div span { display:none; }
div b { font-weight:normal; }

<div>Blah blah blah blah<b>...</b> <span>blah blah blah blah blah</span></div>

jQuery("div").toggle(function() {
        $(this).find("b").hide();
        $(this).find("span").show();
  },
  function() {
        $(this).find("b").show();
        $(this).find("span").hide();
  }). 
```

# php - PHP appendChild 给出了很好的致命错误 - 未捕获的异常 'DOMException' 带有消息'层次结构请求错误 - 我如何在标签之后添加 html

> ID：11452734
> 
> 赞同：0
> 
> 时间：2012-07-12T13:19:13.493
> 
> 标签：php, dom, appendchild

在我的一段代码中，我试图使用 PHP DOM 查找所有 img 标签，直接在之后添加另一个 img 标签，然后将所有这些标签包装在一个 div 中，即

```
<!-- From this... -->
<img src="originalImage.jpg" />

<!-- ...to this... -->
<div class="wrappingDiv">
    <img src="originalImage.jpg" />
    <img src="newImage.jpg" />
</div> 
```

这是我正在尝试的~~PHP~~：

```
$dom = new domDocument;
$dom->loadHTML($the_content_string);
$dom->preserveWhiteSpace = false;
    //get all images and chuck them in an array
$images = $dom->getElementsByTagName('img');
foreach ($images as $image) {
            //create the surrounding div
    $div = $image->ownerDocument->createElement('div');
    $image->setAttribute('class','main-image');
        $added_a = $image->parentNode->insertBefore($div,$image);
        $added_a->setAttribute('class','theme-one');
        $added_a->appendChild($image);
            //create the second image
    $secondary_image = $image->ownerDocument->createElement('img');
    $added_img = $image->appendChild($secondary_image);
    $added_img->setAttribute('src', $twine_img_url);
    $added_img->setAttribute('class', $twine_class);
    $added_img->appendChild($image);
    }

echo $dom->saveHTML(); 
```

直到我创建 $add_img 变量的所有内容都可以正常工作。好吧，至少它不会出错。是最后四行杀死了它。

我显然在做一些相对愚蠢的事情......那里有任何可爱，可爱的人能够指出我在哪里做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:51:40.307

第一的：

您正在尝试将图像附加到此处的图像（但当然在 HTML 中，图像不能有子图像，将图像附加到 div）：

```
$added_img = $image->appendChild($secondary_image); 
```

它一定要是

```
$added_img = $added_a->appendChild($secondary_image); 
```

再次在这里：

```
$added_img->appendChild($image); 
```

必须：

```
$added_a->appendChild($image); 
```

但这根本行不通，因为 NodeList 是实时的。一旦你追加一个新图像，这个图像是 $images 的一部分，你将陷入无限循环。因此，首先使用初始图像填充一个数组，而不是使用 NodeList。

```
$imageList= $dom->getElementsByTagName('img');
$images=array();
for($i=0;$i<$imageList->length;++$i)
{
  $images[]=$imageList->item($i);
} 
```

# java - 为什么从命令提示符运行 JAR 文件时出现异常？

> ID：11452735
> 
> 赞同：3
> 
> 时间：2012-07-12T13:19:17.090
> 
> 标签：java, exception, jar, command-prompt

嗨，我在 Eclipse 上使用导出选项制作了一个可运行的 JAR 文件。但是，当我通过命令提示符运行文件时，我得到以下信息

```
Exception in thread "main" java.lang.NoSuchMethodError
    at org.eclipse.jdt.internal.jarinjarloader.RsrcURLConnection.getInputStream(RsrcURLConnection.java:43)
    at java.net.URL.openStream(Unknown Source)
    at sun.misc.URLClassPath$Loader.getResource(Unknown Source)
    at sun.misc.URLClassPath.getResource(Unknown Source)
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClassInternal(Unknown Source)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Unknown Source)
    at org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:56) 
```

有没有人对我做错了什么有任何想法？对整个创建可运行文件等来说非常新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:21:03.217

你的 jar 是用比你运行它的计算机更新的 java 版本编译的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:46:33.760

提取 jar 文件查找文件 META-INF/MANIFEST-MF。这个文件应该有一个条目

```
Main-Class : <you fully qualified classname having main method> 
```

检查您提到的作为 Main-Class 的类是否具有 main 方法 ( `public static void main(String[] arg)`)

# objective-c - 在没有默认蓝色或灰色选择样式的情况下更改 UITableViewCell 的 imageview

> ID：11452741
> 
> 赞同：1
> 
> 时间：2012-07-12T13:19:45.290
> 
> 标签：objective-c, uitableview

我在其上添加了自定义 UITableViewCell 和 ImageView（以及其他自定义元素），在选择时我更改了 ImageView 上的图像，但在我的 imageView 上也可以看到默认选择样式颜色。如果我尝试在 UITableViewCell 上设置选择样式 none，则 ImageView 不会更改其默认图像。如果设置为灰色结果相同，则单元格采用蓝色并显示在 imageview 中。如果他们有办法通过允许用户在单元格上选择来更改图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:40:32.983

将单元格选择样式设置为无并在 onTouch 事件上更改 imageview 的图像...

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

    UITouch *touch = [touches anyObject];

    if ([touch view] == yourImageView)
    {
            //add your code for image touch here 
    }

} 
```

希望能帮助到你...

# python - 在matplotlib中操纵线宽以进行孵化

> ID：11452743
> 
> 赞同：5
> 
> 时间：2012-07-12T13:19:47.417
> 
> 标签：python, pdf, plot, matplotlib, hatchstyle

在 matplotib 图中，采用 hash 关键字的阴影线宽非常细。我在几年前发现了一些关于此的帖子，并声称已制作了补丁，但我仍然无法找到增加影线线宽的方法。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T13:29:27.367

不幸的是，目前无法在 Agg 后端设置影线的线宽。宽度在 src/_backend_agg.cpp 文件中被硬编码为“1.0”：

```
hatch_path_stroke.width(1.0); 
```

对于其他后端（例如 PDF 后端）也是如此，但对于这些情况，猴子补丁可能更容易。

# java - 有没有办法在 jbutton 上设置 jbutton？

> ID：11452753
> 
> 赞同：0
> 
> 时间：2012-07-12T13:20:13.880
> 
> 标签：java, swing, jpanel, jbutton, sprite

我想知道这一点，因为我们正在 Swing 中制作游戏，并且我们制作了地图图块，`jButtons`而不是`jPanels`出于任何原因。现在我们想把单位放在上面，这样当单位在上面时地图背景仍然会显示。有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T14:35:30.067

好的，所以我不确定这是否真的是您正在寻找的内容以及您的应用程序当前的设置方式，但这是一个将 JButtons 置于彼此之上的示例（如果这不是您想要的，请考虑发布SSCCE[并](http://sscce.org)提供更多详细信息）。还有其他替代方法和更好的方法来处理此类事情，但是由于您通过 JButton 询问 JButton，所以这里有一个片段显示：

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.net.MalformedURLException;
import java.net.URL;

import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.plaf.ButtonUI;
import javax.swing.plaf.basic.BasicButtonUI;

public class TestButtonGrid {

    protected int x;
    protected int y;

    protected void initUI() throws MalformedURLException {
        final JFrame frame = new JFrame();
        frame.setTitle(TestButtonGrid.class.getSimpleName());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        final JPanel panel = new JPanel(new GridBagLayout());
        ImageIcon icon = new ImageIcon(new URL("http://manhack-arcade.net/pivot/isdrawing/tile_bluerock.png"));
        ImageIcon unit = new ImageIcon(new URL("http://static.spore.com/static/image/500/642/783/500642783372_lrg.png"));
        ButtonUI ui = new BasicButtonUI();
        GridBagConstraints gbc = new GridBagConstraints();
        gbc.weightx = 1.0;
        gbc.weighty = 1.0;
        gbc.fill = GridBagConstraints.BOTH;
        for (int i = 0; i < 3; i++) {
            for (int j = 0; j < 3; j++) {
                gbc.gridx = i;
                gbc.gridy = j;
                JButton button = new JButton(icon);
                button.setBorderPainted(false);
                button.setPreferredSize(new Dimension(icon.getIconWidth(), icon.getIconHeight()));
                button.setUI(ui);
                button.setOpaque(false);
                panel.add(button, gbc);
                if (i == j) {
                    // Choose a layout that will center the icon by default
                    button.setLayout(new BorderLayout());
                    JButton player = new JButton(unit);
                    player.setPreferredSize(new Dimension(unit.getIconWidth(), unit.getIconHeight()));
                    player.setBorderPainted(false);
                    player.setUI(ui);
                    player.setOpaque(false);
                    button.add(player);
                }
            }
        }
        frame.add(panel);
        frame.setResizable(false);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    new TestButtonGrid().initUI();
                } catch (MalformedURLException e) {
                    e.printStackTrace();
                }
            }
        });
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T14:12:39.993

拥有一个包含按钮的面板可能是一个更好的主意。然后，您的面板可以使用鼠标事件侦听器在单击时执行操作。

使用 jPanel 的优点是您可以在其中设置布局，这将使您在其中定位按钮更加容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:52:09.687

好吧，可以将 JButton 放在您无法看到的其他 JButton 上。

```
CardLayout cl = new CardLayout();
JPanel jpnlMain = new JPanel(cl);
jpnlMain.add(new JButton(), "FIRST");
jpnlMain.add(new JButton(), "SECOND"); 
```

然后也许您可以创建一个扩展 Cardlayout 或 JPanel 的类，以使其同时显示这两个项目。

**编辑**

做了一个小测试，HJere 是一个 Button Buttonception 中的一个 Button！

主类：

```
import javax.swing.JFrame;

public class Test {
    public static void main(String[] arg0){
        SpecialButton sp = new SpecialButton();
        JFrame jf = new JFrame();
        jf.add(sp);
        jf.setVisible(true);
        jf.pack();
    }
} 
```

特殊按钮类：

```
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;

    public class SpecialButton extends JButton{
        SpecialButton(){
            super();
            JButton jbtnMid = new JButton();
            JLabel jlblMid = new JLabel(new ImageIcon(this.getClass().getResource("/Images/arrowUpIcon.png")));
            jbtnMid .add(jlblMid);
            this.add(jbtnMid);
            this.setVisible(true);
        }
    } 
```

# c# - 页面复制失败

> ID：11452757
> 
> 赞同：1
> 
> 时间：2012-07-12T13:20:17.460
> 
> 标签：c#, asp.net, episerver, episerver-6-r2

我在表服务器树中的复制/粘贴操作有问题。

当我尝试复制和粘贴页面时，后台作业正在运行，但是它失败并出现错误：

> 未能将页面“测试内容页面”复制到“主页”页面下方。

你有没有遇到过这样的情况？可能是权利问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T13:48:03.893

我以前遇到过这个问题。这是因为子页面的页面类型不在父页面的可用页面类型中。

您可以通过在管理员模式下查看您的主页类型、单击设置按钮然后选择可用的页面类型选项卡来检查这一点。确保您的测试内容页面的页面类型是允许的。

如果您使用的是页面类型构建器，您还需要在代码中更新页面类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T13:36:47.523

它是单页还是部分树？如果它是一棵树，则在您复制的页面或其子页面下不允许其类型的子页面仍然可能存在问题。

# google-chrome - Chrome 扩展：如何列出本地目录的内容

> ID：11452758
> 
> 赞同：7
> 
> 时间：2012-07-12T13:20:19.550
> 
> 标签：google-chrome, google-chrome-extension, filesystems, google-chrome-os

## 我想做的事：

我想为测试目的创建一个 Chrome 扩展程序。并且该扩展应该能够**访问**本地**硬盘驱动器**上的目录和文件。

## 我是怎么做到的：

`file:///*`我在我的`manifest.json`文件中请求了权限。然后我确保选中了该复选框`Allow access to file URLs`。然后我为一个文件制作了一个 XHR：

```
 var xhr = new XMLHttpRequest();  
  xhr.open("GET", 'file://c:/dir/file.name', true);     
  xhr.onload = function(e) {  
      console.log('response: ', xhr.response);
  }  
  xhr.send(); 
```

...以及整个目录的 XHR：

```
 var xhr = new XMLHttpRequest();  
  xhr.open("GET", 'file://c:/dir/', true);     
  xhr.onload = function(e) {  
      console.log('response: ', xhr.response);
  }  
  xhr.send(); 
```

...对于*整个*文件系统：

```
 var xhr = new XMLHttpRequest();  
  xhr.open("GET", 'file:///', true);     
  xhr.onload = function(e) {  
      console.log('response: ', xhr.response);
  }  
  xhr.send(); 
```

## 发生了什么：

*   我能够为我的文件请求获得​​正确的响应。
*   当我请求一个目录时，我收到了 Chrome 的默认人类可读目录概述的源代码：

.

```
 <html>
  <head>
  <script> 
```

*[...]*

```
 </script>
  <style> 
```

*[...]*

```
 </style>
  <title id="title"></title>
  </head>
  <body>
  <div id="listingParsingErrorBox" i18n-values=".innerHTML:listingParsingErrorBoxText"></div>
  <span id="parentDirText" style="display:none" i18n-content="parentDirText"></span>
  <h1 id="header" i18n-content="header"></h1>
  <table id="table">
    <tr class="header">
      <td i18n-content="headerName"></td>
      <td class="detailsColumn" i18n-content="headerSize"></td>
      <td class="detailsColumn" i18n-content="headerDateModified"></td>
    </tr>
  </table>
  </body>
  </html> 
```

*[...]*

```
 <script>start("C:\\dir\\");</script>
  <script>addRow("..","..",1,"0 B","11/11/11 11:11:11 AM");</script>
  <script>addRow("file.name","file.name",0,"4.9 kB","11/11/11 11:11:11 PM");</script> 
```

*   当我请求整个文件系统时，我得到了一个错误。

## 我的问题：

我能够阅读简单的文件。但是我的扩展如何获得一个很好的机器可读的目录或整个文件系统的**概述？**谢谢。

***编辑：***我知道 FileSystem API 旨在访问沙盒`filesystem://`，但也许 Chrome 允许扩展也访问`file://`. 我找不到任何有关`file://`从 Chrome 扩展程序访问的文档，所以我只能猜测。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:27:10.220

独立 Chrome 中没有内置功能。

解析目录列表页面的替代方法：

1.  NPAPI 扩展（C++，推荐）
2.  具有文件系统访问权限的本地服务器。[NodeJS 是一个不错的选择](http://www.ipreferjim.com/2011/12/install-nodejs-under-chromeos-cr-48/)。

# c++ - 单例 C++ 模板类

> ID：11452760
> 
> 赞同：2
> 
> 时间：2012-07-12T13:20:32.123
> 
> 标签：c++, templates, singleton

> **可能重复：**
> [为什么模板只能在头文件中实现？](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file)

我意识到在 SO 上已经很少有这样的话题，但我没有找到任何可以回答我的问题的话题。

我已经使用本教程[http://www.codeproject.com/Articles/4750/Singleton-Pattern-A-review-and-analysis-of-existin编写了我的模板单例类](http://www.codeproject.com/Articles/4750/Singleton-Pattern-A-review-and-analysis-of-existin)

但不幸的是，我不断收到错误：

> /home/USER/testcode/cpp_workshop/main.cpp:-1: 错误: 未定义对“Singleton::Instance()”的引用:-1: 错误: collect2: ld

我的单例.h

```
#ifndef SINGLETON_H
#define SINGLETON_H

template <typename T>
class Singleton
{
public:
    static T& Instance();

protected:
    virtual ~Singleton();
    inline explicit Singleton();

private:
    static T* _instance;
    static T* CreateInstance();
};

template<typename T>
T* Singleton<T>::_instance = 0;

#endif // SINGLETON_H 
```

单例.cpp

```
#include "singleton.h"
#include <cstdlib>

template <typename T>
Singleton<T>::Singleton()
{
    assert(Singleton::_instance == 0);
    Singleton::_instance = static_cast<T*>(this);
}

template<typename T>
 T& Singleton<T>::Instance()
{
    if (Singleton::_instance == 0)
    {
        Singleton::_instance = CreateInstance();
    }
    return *(Singleton::_instance);
}

template<typename T>
inline T* Singleton<T>::CreateInstance()
{
    return new T();
}

template<typename T>
Singleton<T>::~Singleton()
{
    if(Singleton::_instance != 0)
    {
        delete Singleton::_instance;
    }
    Singleton::_instance = 0;
} 
```

这就是我所说的（使用 normall - 不是模板或任何东西 - 类`Game`） `Singleton<Game>::Instance().run();`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:23:57.793

将您的方法定义放在标题中的类定义下，然后删除您的 cpp. 模板化方法和模板化类的方法必须在标头中定义（有几个骇人听闻的例外）。

根据请求，以下是“骇人听闻的例外”：

*   1) 见@Desmond Hume 的回答
*   2) 仅使用定义方法的 cpp 中的模板类。例如，您可以在 cpp 的未命名命名空间中声明/定义模板类，这很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:31:00.237

您可以将您的`Singleton`类的定义放入头文件中**，或者您可以保持声明（头文件）和定义（** *.cpp*文件）的分离，如果您更喜欢它并`Singleton`使用每个您将要使用它的类型。要显式实例化`Singleton`类，请尝试将以下内容放在 .cpp 文件的末尾：

```
template
class Singleton<Game>; 
```

对于另一种类型，它的外观相同：

```
template
class Singleton<AnotherGame>; // just for example 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:29:41.843

不可能将模板类的定义（头文件）和实现（cpp）分开。所以你有两种解决方案之一：

1-实现头文件.h中的所有内容。像这样的东西

```
template <typename T>
class Singleton
{
public:
    static T& Instance(){}

protected:
    virtual ~Singleton(){}
    inline explicit Singleton(){}

private:
    static T* _instance;
    static T* CreateInstance(){}
}; 
```

另一种解决方案是将 .cpp 类重命名为 .hpp。不要在 .hpp 文件中包含 .h 文件，反之亦然。即在 .h 文件中包含 .hpp 文件

我个人更喜欢第一种解决方案

干杯

# android - 点击页面正文时Android / iOS输入聚焦

> ID：11452764
> 
> 赞同：6
> 
> 时间：2012-07-12T13:20:46.430
> 
> 标签：android, iphone, ios, webkit, mobile-safari

*问题是关于显示 HTML5 页面的标准浏览器，而不是 WebView*

测试设备是 Galaxy Tab 10.1，尽管这也出现在 iPad 上。

该页面有一个表格。表格有固定的宽度和

```
margin-left: auto;
margin-right: auto; 
```

当我触摸并按住页面正文（**表单外部**）时，其中一个表单输入（通常是第一个，尽管有时是第二个）被聚焦（并显示屏幕键盘）。

有什么解释为什么会出现这种行为？知道如何预防吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T14:57:21.863

使用[HTML5 的 autofocus](http://www.w3schools.com/html5/att_input_autofocus.asp)属性来强制浏览器最初关注你想要的元素。

```
<input autofocus="autofocus" /> 
```

较旧的浏览器将忽略该属性。

# hibernate - 线程“主”java.lang.AbstractMethodError 中的异常：ch.qos.logback.classic.Logger.isTraceEnabled()Z

> ID：11452765
> 
> 赞同：1
> 
> 时间：2012-07-12T12:51:41.840
> 
> 标签：hibernate

我是休眠的新手。我已经搜索了所有链接。但我找不到答案。我试图执行休眠注释示例我得到了一个错误

`Exception in thread "main" java.lang.AbstractMethodError: ch.qos.logback.classic.Logger.isTraceEnabled()Z`

请参考以下详细信息。

这是我的 POJO 课程

```
package com.vaannila.course;
import java.io.Serializable;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Table;
@Entity
@Table(name="COURSES")
public class Course implements Serializable 
{
private long courseId;
private String courseName;
public Course() 
{
}
public Course(String courseName) 
{
this.courseName = courseName;
}
@Id
@GeneratedValue
@Column(name="COURSE_ID" ,updatable = false, nullable = false)
public long getCourseId() 
{
return this.courseId;
}
public void setCourseId(long courseId) 
{
this.courseId = courseId;
}
@Column(name="COURSE_NAME", nullable=false)
public String getCourseName() 
{
return this.courseName;
}
public void setCourseName(String courseName) 
{
this.courseName = courseName;
}
} 
```

* * *

这是我的配置文件

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC
        "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
    <session-factory>
        <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
        <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/sample</property>
        <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
        <property name="hibernate.connection.username">sa</property>
        <property name="connection.password">root</property>
        <property name="show_sql">true</property>
        <property name="hbm2ddl.auto">create</property>
        <mapping class="com.vaannila.course.Course" />
    </session-factory>
</hibernate-configuration> 
```

* * *

这是我的 util 类是

```
package com.vaannila.util;
import org.hibernate.SessionFactory;
import org.hibernate.cfg.AnnotationConfiguration;
public class HibernateUtil 
{
private static final SessionFactory sessionFactory;
static {
try {
sessionFactory = new AnnotationConfiguration().configure().buildSessionFactory();
} 
catch (Throwable ex) 
{
System.err.println("Initial SessionFactory creation failed." + ex);
throw new ExceptionInInitializerError(ex);
}
}
public static SessionFactory getSessionFactory() 
{
return sessionFactory;
}
} 
```

* * *

这是我的测试课

```
package com.vaannila.course;

import org.hibernate.HibernateException;
import org.hibernate.Session;
import org.hibernate.Transaction;

import com.vaannila.util.HibernateUtil;

public class Main {
public static void main(String[] args)
{
    Main obj = new Main();
    Long courseId1 = obj.saveCourse("Physics");

}
public Long saveCourse(String courseName)
{
Session session = HibernateUtil.getSessionFactory().openSession();
Transaction transaction = null;
Long courseId = null;
try 
{
transaction = session.beginTransaction();
Course course = new Course();
course.setCourseName(courseName);
courseId = (Long) session.save(course);
transaction.commit();
} 
catch (HibernateException e) 
{
transaction.rollback();
e.printStackTrace();
}
finally
{
session.close();
}
return courseId;
}
} 
```

* * *

类路径中的罐子是

1.hibernate-commons-annotations.jar
2.hibernate-annotations.jar
3.ejb3-persistence.jar
4.hibernate3.jar
5.dom4j-1.6.1.jar
6.logback-classic-0.8.jar
7.logback-经典-0.3.jar
8.logback-core-0.9.6.jar
9.slf4j-api-1.5.8.jar
10.jta-1.1.jar
11.dom4j-1.6.1.jar
12.antlr-2.7.6 .jar
13.commons-collections-3.1.jar
14.cglib-2.2.jar
15.asm-1.5.3.jar

## 16.mysql-connector-java-5.0.4.jar

堆栈跟踪是

```
Exception in thread "main" java.lang.AbstractMethodError: ch.qos.logback.classic.Logger.isTraceEnabled()Z
    at org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:116)
    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:111)
    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2119)
    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2115)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1339)
    at com.lara.Manager.main(Manager.java:20) 
```

# php - 页面只有一定等级的会员才能看到

> ID：11452766
> 
> 赞同：0
> 
> 时间：2012-07-12T13:21:02.420
> 
> 标签：php, redirect, member

在我的成员数据库中，我有一个名为 rank 的部分。

基本上，我试图做的是让某些页面对排名高于 12 的成员可见，如果排名低于 12，那么它们将被重定向回主页。（显然，对于 5 级以上成员、7 级以上成员、20 级以上成员等，他们将有很多不同的页面）

任何人都可以帮我提供教程或其他东西吗？

我之前确实向我当前的代码寻求过帮助，但我认为该代码永远不会起作用，我已经改变它并使用它一周了，不可能看到任何其他方法让它[工作唯一的区域](https://stackoverflow.com/questions/11450594/members-rank-only-areas/11450704#comment15112749_11450704)

我还在学习 php，所以理想情况下，一个简单易懂的教程会很好。

数据库：

```
id int(11) 
username varchar(200) latin1_swedish_ci 
password varchar(216) latin1_swedish_ci 
security varchar(200) latin1_swedish_ci 
email varchar(216) latin1_swedish_ci 
ip varchar(200) latin1_swedish_ci 
rank varchar(216) latin1_swedish_ci 
name varchar(30) latin1_swedish_ci 
age varchar(40) latin1_swedish_ci 
gender varchar(40) latin1_swedish_ci 
location varchar(40) latin1_swedish_ci 
helpfaerie int(11) 
profile text latin1_swedish_ci 
about text latin1_swedish_ci 
tasks text latin1_swedish_ci 
joined varchar(216) latin1_swedish_ci 
laston int(200) 
icedmutereason text latin1_swedish_ci 
icedmutedetails text latin1_swedish_ci 
icedmuteby varchar(200) latin1_swedish_ci 
icedmutedate int(200) 
posts int(11) 
signature varchar(216) latin1_swedish_ci 
avatar varchar(216) latin1_swedish_ci 
neohtml text latin1_swedish_ci 
siggy text latin1_swedish_ci 
verify int(11) 
changedpass int(1) 
```

头文件.inc.php

```
<?php 

include ($_SERVER['DOCUMENT_ROOT'].'/dblink.php'); 
include ($_SERVER['DOCUMENT_ROOT'].'/addon.php'); 

$geterror= $_GET['error'];

$error= stripplus($geterror);

$extra = mysql_fetch_array(mysql_query("SELECT * FROM extra WHERE id='1'"));

$cp = mysql_fetch_array(mysql_query("SELECT * FROM members WHERE username = '$username'"));

$weather = $extra[weather];
$wurl = $extra[wurl];
$games = $extra[games];
$xword = $extra[xword];
$xword2 = $extra[xword2];
$xworddate = date("M j Y",$extra[xworddate]); 
$userinfo = mysql_fetch_array(mysql_query("SELECT * FROM members WHERE username='$username'"));
$rank = $userinfo[rank];

if (!$checkrank) { $checkrank = 0; }
if (!$rank) { $rank = 0; }
if (!$rank == ' ') { $rank = 0; }
if ($rank < $checkrank)
{

     header("Location: $baseurl/index.php?error=You+can+not+view+this+page.");
}

if ($rank >= 30)
{

    $admin = "<a href=\"$baseurl/staff/admin.php\">Admin</a>";
}

if ($username)
{

mysql_query("UPDATE members SET laston = $timestamp+120 WHERE username='$username'");

mysql_query("UPDATE members SET ip = '$ip' WHERE username='$username'");

    $login = "Welcome $username :) <a href=\"$baseurl/logout.php\" >Logout</a>";

$helpfaerie = "<a href=\"$baseurl/helpfaerie.php\" >Help Faerie</a>";

}

else
{
$login = "<form name=\"login\" action=\"$baseurl/login.pro.php\" method=\"post\"  > <input type=\"hidden\" name=\"act\" value=\"doLogin\" color=\"#000000\" valign=\"middle\" >&nbsp;Username: <input type=\"text\" name=\"username\" color=\"#000000\"  style=\"width:100px; height:20px;font-size:10px;\">
Password: <input type=\"password\" name=\"password\"  style=\"width:100px; height:20px;font-size:10px;\"> <input type=\"submit\" name=\"submit\" value=\"Login\" style=\"width:42px; height:20px;font-size:10px;\"></form>";

}

ECHO <<<END 
```

然后是 font.php

```
<?php
$pagetitle = "Add Font";

session_start();

// Rank Limit
       $limit = 10;

        // Using a session 
    $rank = $_SESSION['rank'];

       // Using a cookie
       $rank = $_COOKIE['rank'];

    if ($rank < $limit) {
        header("$baseurl/index.php?error=You+can+not+view+this+page.");
        exit();
        die();
    }

include ($_SERVER['DOCUMENT_ROOT'].'/staff/header.inc.php');

ECHO <<<END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:55:49.217

您正在寻找的是可能与身份验证相结合的 ACL（访问控制列表）。ACL 将允许您指定具有特定凭据的用户可以访问哪些资源。

我找到了一些教程，但这不适合胆小的人。

*   [http://phpmaster.com/role-based-access-control-in-php/](http://phpmaster.com/role-based-access-control-in-php/)

*   [http://blog.davidjclarke.co.uk/database-driven-zend-acl-tutorial-part-one.html](http://blog.davidjclarke.co.uk/database-driven-zend-acl-tutorial-part-one.html)

*   [http://www.developer.com/lang/php/creating-a-custom-acl-in-php.html](http://www.developer.com/lang/php/creating-a-custom-acl-in-php.html)

也许您可以使用 phpclasses 中的一个类来帮助您入门：

[PHPClasses ACL 搜索结果](http://www.phpclasses.org/search.html?words=acl&x=0&y=0&go_search=1)

此外，据我所知，所有流行的框架都有 ACL 和身份验证资源。（Zend 框架、Symfony、CakePHP）。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:55:38.153

由于您的数据库中有一个 rank 字段，因此您必须使用查询来检索它：

```
$user = mysql_fetch_array(mysql_query("SELECT rank FROM members WHERE username='$username'")); 
```

之后你可以检查它，然后你必须创建一个 if/switch 来管理各种等级及其背后的逻辑：

```
if(!is_array($user) || $user['rank'] < 12){
     header('Location: homepage');
} else {
 //manage page that only ranked user can have

} 
```

请记住，这是一个简单且“糟糕”的解决方案，因为它会查询您将访问的每个页面和每个用户，但它会给您一个想法，您可以使用登录页面来处理更复杂的版本它将在会话中存储排名并在每个页面中检索它以确定用户是否可以查看它：

```
if(!isset($_SESSION['user_rank'] || $_SESSION['user_rank']<12)
    header('Location : defaultpage.php'); 
```

# javascript - 替换 jquery 对象中键的值

> ID：11452771
> 
> 赞同：1
> 
> 时间：2012-07-12T13:21:18.607
> 
> 标签：javascript, jquery

我创建了一个模态插件，该插件具有默认或用户定义的选项。这些值中的大部分将传递给函数并更新，当发生这种情况时，我希望在选项中更新值。理想情况下，我不想更新每个单独的对象，而是希望将对象（选项）作为一个整体来处理和更新。

以下是用户选项：

```
modalDialog({
    ID: 'before_unload',
    title: 'opt.heading',
    message: 'opt.text',
    confirm: 'opt.confirm',
    cancel: 'opt.cancel',
    link: $(this).attr('href'),
}); 
```

每个以“选择”开头的选项。将对它们执行功能。这是处理选项的 modalDialog 插件的代码

```
var options = $.extend(defaults, options);
        return this.each(function() {
            var o = options;
            var reg = '^opt.*'; //regex to find all 'opt.' values
            console.log(o);
            $.each(o, function(i, v) { //for each value
                if(i != 'save'){    
                    if(v.match(reg)){ // match to regex
                        console.log(i+': '+v);
                        var newval = rc.getResource(v); // function to update value
                        console.log(newval); //value has been updated, function works
                        v = i.replace(i, newval); // update the index with new value
                        console.log('New i:v = '+i+': '+v); // checked and it works

//Now the question is, how do I update o (options with the new values?)

                    }
                };
            }); 
```

在上面的代码中，假设 rc.getResource(v) 返回一个不同的农场动物名称，具体取决于传递给它的值，我用我的新农场动物名称更新该值，并检查它是否都匹配并且一切正常，直到我更新选项。我试过`o = options.replace(i,v)`了，它回来了 options.replace 不是一个函数。

我确实有一个想法是在我创建了一个新值（执行我的函数）之后取消设置/删除相应的 i:v 并将新值添加到对象中，例如

```
i1 = i;
v1 = i.replace(i, newval);
o -=  i:v;
o += i1:iv; 
```

唉，我的大脑已经疲惫不堪，迫切需要帮助，我将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T13:56:21.980

你不能这样做吗？：

```
o[i] = v; 
```

# python - Python Twisted：如何停止 TLS？

> ID：11452774
> 
> 赞同：1
> 
> 时间：2012-07-12T13:21:31.120
> 
> 标签：python, encryption, twisted, ssl

这里有几个示例说明如何在已经建立连接后启动 TLS。但是我找不到相反的方法，关闭 TLS。 [http://twistedmatrix.com/documents/current/core/howto/ssl.html](http://twistedmatrix.com/documents/current/core/howto/ssl.html)

我可以为客户端生成一个一次性随机密码，使用 TLS 交换它，再次重新连接，然后向客户端询问该密码以避免连接劫持吗？有没有办法在不丢失连接的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:18:47.827

如果停止 TLS，就无法避免连接劫持。一旦您终止了对该连接的保护，所有的赌注都没有了：TLS 的好处只有在加密会话持续存在时才会持续。

我认为不支持停止 TLS，但实际上，没有充分的理由这样做，除非您需要对连接执行一些非常奇怪的低级操作，例如将其交给其他级别的硬件路由。即使那样，也可能有更好的方法来做到这一点。

# windows - Git 服务器和克隆

> ID：11452775
> 
> 赞同：0
> 
> 时间：2012-07-12T13:21:32.130
> 
> 标签：windows, git, ubuntu-10.04, head, git-clone

我已经创建了我的 git 服务器，此链接[链接](http://www.vogella.com/articles/Git/article.html) git clone 在服务器中工作，但是当我在本地机器上克隆我的项目时，我遇到了一个问题“警告：远程 HEAD 引用不存在的引用，无法结帐。” 我用于克隆“git clone [http://domain.com/project.git](http://domain.com/project.git) ”我使用虚拟机（domain.com = 192.168.1.196）作为 git 服务器和 windows 作为本地机器。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:55:13.460

在服务器上，在新文件夹中运行以下命令来初始化一个新的裸 git repo...

```
git init --bare 
```

在您的本地计算机上，转到现有文件夹并创建一个新文件夹并运行。

```
git init 
```

将文件复制到此文件夹并执行。

```
git commit -am "New repository with a new file" 
```

然后将您的服务器添加为远程。

```
git remote add myserver http://domain.com/project.git 
```

下一步是推送到您的服务器。

```
git push -u myserver master 
```

# html - 在 HTML 中使用 colspan 和 rowspan 以下列格式绘制表格？

> ID：11452777
> 
> 赞同：0
> 
> 时间：2012-07-12T13:21:36.267
> 
> 标签：html, html-table

我想按以下格式绘制表格：

![我想画的桌子](../Images/e1e4f25651429490af0efdc4606df26c.png)

但它没有正确显示。它在最后一列之后插入一些行。如何修复 HTML？

```
<tr>
    <th rowspan="2">Client ID</th>
    <th rowspan="2">Trade ID</th>
    <th rowspan="2">Symbol</th>
    <th rowspan="2">Average Price</th>
    <th colspan="3">DTD</th>
    <th colspan="3">MTD</th>
    <th rowspan="2">Net YTD</th>
</tr>

<tr>
    <td><core:out value="${orderBookData.clientID}" /><br></td>
    <td><core:out value="${orderBookData.tradeID}" /></td>
    <td><core:out value="${orderBookData.symbol}" /></td>
    <td><core:out value="${orderBookData.averagePrice}" /></td>
    <td><core:out value="${orderBookData.DTD}" /></td>
    <td><core:out value="${orderBookData.MTD}" /></td>
    <td><core:out value="${orderBookData.YTD}" /></td>
    <td><core:out value="${orderBookData.DTD}" /></td>
    <td><core:out value="${orderBookData.MTD}" /></td>
    <td><core:out value="${orderBookData.YTD}" /></td>
    <td><core:out value="${orderBookData.YTD}" /></td>
</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:43:43.410

您的标题行非常准确。但是，您需要在后续`<td>`标签中考虑额外的行和列。由于第 1-4 列和第 7 列是`rowspan="2"`，因此您需要第二个`<tr>`带有两个`<td>`标签的时间来说明第 5-6 列中所需的额外单元格。此外，由于您希望在 5-6 列下各有三个单元格，因此您需要将该数字增加三倍。因此需要六个：

```
<tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
</tr> 
```

下面的所有后续行都需要 11 个`<td>`标签，因为您必须考虑所有七列以及四个额外的单元格。

```
<tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
</tr> 
```

JS 小提琴：http: [//jsfiddle.net/Aj5k7/2/](http://jsfiddle.net/Aj5k7/2/)

`rowspan`和`colspan`属性教程： [http ://www.tizag.com/htmlT/tables.php/](http://www.tizag.com/htmlT/tables.php/)

# c# - 如何使用 LINQ to SQL 将单行添加到列表中？

> ID：11452778
> 
> 赞同：2
> 
> 时间：2012-07-12T13:21:46.537
> 
> 标签：c#, asp.net, linq-to-sql

所以我有一个办公地点表，每一列都包含相关信息（即办公室名称、地址、城市、州、邮编、国家）。

我在界面中设置了供用户选择办公室，其余的都是为他们填写的。

我知道如何使用通用列表并使用包含多行的一列填充它，就像我使用从同一张表中列出办公室位置的下拉菜单一样。

我不知道如何用单行中的多列填充通用列表。

例如，这是我为前者工作的代码：

```
 private List<string> selectLocs()
    {
        Locs offLoc = new Locs();

        List<string> objList = new List<string>();

        var select = from l in offLoc.Locations
                     orderby l.OFFICE
                     select l;

        foreach (Location loc in select)
        {
            objList.Add(loc.OFFICE);
        }

        return objList;
    } 
```

这是后一种情况的代码，不完整，因为我不知道如何做同样的事情：

```
 private List<string> selectAddr(string strLoc)
    {
        List<string> objList = new List<string>();

        Locs offLocs = new Locs();

        var select = from l in offLocs.Locations
                     where l.OFFICE == strLoc
                     select l;

        //foreach what? in select? Do I even use a foreach loop?

        return objList;
    } 
```

不知道为什么以前没有人问过这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T13:28:42.343

你的第一种方法可以简化：

```
private List<string> SelectLocations()
{
    Locs offLoc = new Locs();
    return (from l in offLoc.Locations
            orderby l.OFFICE
            select l.OFFICE).ToList();
} 
```

你的第二种方法：

```
private List<string> SelectAddresses(string strLoc)
{
    Locs offLocs = new Locs();
    return (from l in offLocs.Locations
            where l.OFFICE == strLoc
            select l.ADDRESS).ToList();
} 
```

更新：如果您需要多个属性，则返回完整的位置对象：

```
private List<Location> SelectLocations(string strLoc)
{
    Locs offLocs = new Locs();
    return (from l in offLocs.Locations
            where l.OFFICE == strLoc
            select l).ToList();
} 
```

还要尽量避免使用匈牙利表示法（为变量名添加前缀，用于描述变量类型）。而不是`strLoc`你可以使用`locationName`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T13:30:49.303

你的第一种方法可能是

`return new Locs().Locations.OrderBy(m => m.Office).Select(l => l.OFFICE).ToList()`

您的第二个查询可能不应该返回一个列表，而是一个位置

```
private Location selectAddr(string strLoc)
{
    return new Locs().Locations.FirstOrDefault(m => m.OFFICE == strlLoc);
} 
```

或者如果你想要一个地址列表（这不是很清楚）

```
private IList<string> selectAddr(string strLoc)
{
    return new Locs().Locations.Where(m => m.OFFICE == strlLoc)
    .Select(l => l.ADDRESS).ToList();
} 
```

或位置列表

```
private IList<Location> selectAddr(string strLoc)
{
    return new Locs().Locations.Where(m => m.OFFICE == strlLoc)
    .ToList();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T13:43:46.427

塞弗瑟斯。以上所有答案都是有效的，但我不确定他们是否回答了您的问题。您在问如何从一行返回多列，对吗？

您可以在这里使用匿名类型来提供帮助，例如

```
private IList<string> selectAddr(string strLoc)
{
    Locs offLocs = new Locs();
    var xx = (from l in offLocs.Locations
            where l.OFFICE == strLoc
            select new { l.Address1, l.Address2, l.County });

return xx.Select(a=>String.Concat(x.Address1, x.Address2, x.County).ToList();

} 
```

但是，您可以进一步简化它，

```
private IList<string> selectAddr(string strLoc)
    {
        Locs offLocs = new Locs();
        return (from l in offLocs.Locations
                where l.OFFICE == strLoc
                select String.Concat(l.Address1, l.Address2, l.County)).ToList();

    } 
```

或者更好

```
var offLocs = new Locs();
return offLocs.Where(o=>o.Office = strLoc).Select(l=>String.Concat(l.Address1, l.Address2, l.County)).ToList(); 
```

但这只是口味问题！

# python - 用beautifulsoup解析并得到一个mp3链接

> ID：11452783
> 
> 赞同：-1
> 
> 时间：2012-07-12T13:22:22.133
> 
> 标签：python, beautifulsoup

我正在尝试解析网页以仅获取第一个 mp3 链接。我将解析的 html 将如下所示（在网页中）：

```
<a href="#" playlist="http://dn-naverdic.ktics.co.kr/naverdic/f759cdac78d6e201e5dfd928acc70e2a/4ffec2f7/naverdic/endic/sound/clear/us/007/007582.mp3" class="play3 N=a:wrd.listencom,r:3,i:85c05904f36749e6aa9f6fd3f461f63c"> 
```

我已经尝试使用“a”作为参数的 find_all 函数，并尝试让它找到“播放列表”，但我无法让它工作。

该代码是我在网上找到的另一个修改程序的一部分（很多代码行），但是我试图为漂亮的汤做的部分在所有尝试中都失败了，所以我真的没有示例可以发布，因为它们都没有工作，我不断收到错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:37:25.103

我正在使用的当前机器上没有 BeautifulSoup，但这里有一些使用[lxml](http://lxml.de/)的示例代码。也许你可以告诉我们你正在使用什么代码？

```
from lxml.html import etree
from lxml.html import HTMLParser
from cStringIO import StringIO
soup = """<body><a href="#" playlist="http://dn-naverdic.ktics.co.kr/naverdic/f759cdac78d6e201e5dfd928acc70e2a/4ffec2f7/naverdic/endic/sound/clear/us/007/007582.mp3" class="play3 N=a:wrd.listencom,r:3,i:85c05904f36749e6aa9f6fd3f461f63c"></body>"""
root = etree.parse(StringIO(soup),HTMLParser())
root.xpath('//a')
# Will return: [<Element a at 0x30840a0>] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T15:10:44.423

有很多方法可以做到（可能太多了。）这可能会帮助您入门：

```
>>> import urllib2
>>> from bs4 import BeautifulSoup
>>> 
>>> url = 'http://endic.naver.com/search.nhn?isOnlyViewEE=N&query=Rule'
>>> page = urllib2.urlopen(url)
>>> soup = BeautifulSoup(page)
>>> 
>>> playlists = soup.find_all("a", {"playlist": True})
>>> playlists
[<a class="play3 N=a:wrd.listencom,r:3,i:85c05904f36749e6aa9f6fd3f461f63c" href="#" playlist="http://dn-naverdic.ktics.co.kr/naverdic/e883ec39de5d45840c2744705c2918c7/4ffee8ca/naverdic/endic/sound/clear/us/007/007582.mp3">
<img alt="play" class="play" height="18" src="http://dicimg.naver.com/endic/img/play.gif" width="19"/>
</a>, <a class="play3 N=a:wrd.listenuk,r:3,i:85c05904f36749e6aa9f6fd3f461f63c" href="#" playlist="http://dn-naverdic.ktics.co.kr/naverdic/7001326345aadc53fa3911f9083065d7/4ffee8ca/naverdic/endic/sound/uk/0990000/0992050.mp3">
<img alt="play" class="play" height="18" src="http://dicimg.naver.com/endic/img/play.gif" width="19"/>
</a>]
>>> 
>>> playlists[0].get("playlist")
'http://dn-naverdic.ktics.co.kr/naverdic/e883ec39de5d45840c2744705c2918c7/4ffee8ca/naverdic/endic/sound/clear/us/007/007582.mp3' 
```

# mysql - 意外的函数调用

> ID：11452784
> 
> 赞同：3
> 
> 时间：2012-07-12T13:22:30.933
> 
> 标签：mysql, c, gcc

我正在使用**MySQL 5.0.51a**，当我的程序退出时，我发现了一个导致无限循环（以堆栈溢出和 seqgfault 结束）的错误。

我发现如果我有一个名为 的函数`shutdown()`，它会在调用`mysql_close()`.

我在下面包含了一个最小的示例 C 源文件和 makefile 以显示问题的实际情况。在示例中，`shutdown()`尽管未被 调用，但仍被调用`main()`。

这里发生了什么？我是否与libmysqlclient`shutdown()`中的 a 发生冲突？`shutdown()`如果是这样，gcc 是否有理由不知道它？

我正在使用 gcc (GCC) 4.2.4 (Ubuntu 4.2.4-1ubuntu4)

* * *

mysql_shutdown.c：

```
#include <stdio.h>
#include <mysql/mysql.h>

#define HOST "<hostname>"
#define USER "<username>"
#define PASSWD "<password>"
#define DB "<dbname>"

MYSQL *connection;

void shutdown(void)
{
    printf("shutdown called\n");
}

int main()
{
    connection = mysql_init(NULL);
    mysql_real_connect(connection, HOST, USER, PASSWD, DB, 0, NULL, 0);
    mysql_close(connection);

    return 0;
} 
```

生成文件：

```
mysql_shutdown: mysql_shutdown.c
        gcc  -Wall -Wextra -Werror `mysql_config --cflags` -o $@ $^ `mysql_config --libs` 
```

输出：

```
$ ./mysql_shutdown
shutdown called 
```

请注意，这似乎与[GCC 函数名冲突](https://stackoverflow.com/questions/10087706/gcc-function-name-conflict)中显示的行为相反。在那种情况下，预期的函数没有被调用，而在我的例子中，一个函数在不被预期的时候被调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T08:41:25.757

最有可能发生的是，因为`mysql_config --libs`它为您提供了 MySQL 库文件的列表，并且该`shutdown()`函数位于库中的*不同*目标文件中，所以它没有被购买。

您必须了解大多数链接器的工作方式。他们要做的是将您明确列出的所有目标文件捆绑在一起，最终得到部分可执行文件和尚未解析的符号列表。

然后通过在那些库中定位可以解析符号的目标文件来搜索库以解析这些符号。通常情况下，您会`mysql_close()`在其中一个库中找到并从该库加载其目标文件。但是该操作可能会引入*更多*需要解析的符号，这反过来又会导致更多的库被搜索。

例如，假设通常在 MySQL 库之一中提供的`mysql_close()`调用。`shutdown()`但是，因为您*已经*定义了它，所以加载`mysql_close()`不会导致出现未解析的*符号*`shutdown`。所以没有必要去任何图书馆寻找它。

它*确实会*导致`mysql_close()`调用一个完全不同`shutdown()`的 ，即您在代码中提供的那个。

# c# - 让这个 SQL 查询更高效

> ID：11452785
> 
> 赞同：1
> 
> 时间：2012-07-12T13:22:31.273
> 
> 标签：c#, sql, foreach

我有以下查询，它根据采购订单检查收货，以查看最初订购了哪些物品以及通过收货预订了多少物品。例如，我下达了 10 个香蕉奶昔的采购订单，然后我生成了一个收货单，说明我在所述采购订单上收到了 5 个这样的奶昔。

```
SELECT t.PONUM, t.ITMNUM, t.ordered, 
       SUM(t.received) as received, 
       t.ordered - ISNULL(SUM(t.received),0) as remaining, 
       SUM(t.orderedcartons) as orderedcartons, 
       SUM(t.cartonsreceived) as cartonsreceived, 
       SUM(t.remainingcartons) as remainingcartonsFROM(SELECT pod.PONUM, 
       pod.ITMNUM, pod.QTY as ordered, ISNULL(grd.QTYRECEIVED, 0) as received, 
       pod.DELIVERYSIZE as orderedcartons, 
       ISNULL(grd.DELIVERYSIZERECEIVED, 0) as cartonsreceived, 
       (pod.DELIVERYSIZE - ISNULL(grd.DELIVERYSIZERECEIVED, 0)) as remainingcartons
FROM TBLPODETAILS pod 
  LEFT OUTER JOIN TBLGRDETAILS grd 
    ON pod.PONUM = grd.PONUM and pod.ITMNUM = grd.ITMNUM) t
GROUP BY t.ITMNUM, t.PONUM, t.ordered
ORDER BY t.PONUM 
```

它返回以下数据：

```
PONUM   ITMNUM  ordered received remaining orderedcartons cartonsreceived remainingcartons

1       1     5.0000    3.0000      2.0000   5.0000         3.0000          2.0000 
```

接下来，我有一个 C# 循环来根据从上述查询返回的数据生成更新查询：

```
foreach (DataRow POUpdate in dt.Rows) {...

query += "UPDATE MYTABLE SET REMAININGITEMS=" + remainingQty.ToString() 
       + ", REMAININGDELIVERYSIZE=" + remainingBoxes.ToString() + " WHERE ITMNUM=" 
       + itemNumber + " AND PONUM=" + poNumber + ";"; 
```

然后我对数据库执行每个更新查询。这在我的本地开发机器上运行良好。

但是，部署到生产服务器会在第一次查询中撤回超过 150,000 条记录。

所以循环这么多行会锁定 SQL 和我的应用程序。是前锋吗？是将所有数据加载到内存中的原始选择吗？两个都？我可以将此查询合并为一个查询并删除 C# 循环吗？如果是这样，实现这一目标的最有效方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T13:34:36.920

在 SQL 中，目标应该是一次在整个表上编写操作。SQL 服务器可以非常高效地执行此操作，但在任何交互上都需要大量开销，因为它需要处理事务的一致性、原子性等。所以在某种程度上，每个事务的固定成本很高，因为服务器来做它的事情，但是您在事务中额外行的边际成本非常低 - 更新 1m 行可能是更新 10 行的 1/2。

这意味着 foreach 将导致 SQL 服务器不断地与您的应用程序来回切换，并且每次都会发生锁定/解锁和执行事务的固定成本。

您可以编写查询以在 SQL 中操作，而不是在 C# 中操作数据吗？您似乎想根据您的选择语句编写一个相对简单的更新（例如，参见[SQL update from one Table to another based on a ID match](https://stackoverflow.com/questions/224732/sql-update-from-one-table-to-another-based-on-a-id-match)。

尝试以下操作（未测试代码，因为我无权访问您的数据库结构等）：

```
UPDATE MYTABLE 
  SET REMAININGITEMS = remainingQty, 
  REMAININGDELIVERYSIZE=remainingBoxes
From 
(SELECT t.PONUM, t.ITMNUM, t.ordered, 
       SUM(t.received) as received, 
       t.ordered - ISNULL(SUM(t.received),0) as remaining, 
       SUM(t.orderedcartons) as orderedcartons, 
       SUM(t.cartonsreceived) as cartonsreceived, 
       SUM(t.remainingcartons) as remainingcartonsFROM(SELECT pod.PONUM, 
       pod.ITMNUM, pod.QTY as ordered, ISNULL(grd.QTYRECEIVED, 0) as received, 
       pod.DELIVERYSIZE as orderedcartons, 
       ISNULL(grd.DELIVERYSIZERECEIVED, 0) as cartonsreceived, 
       (pod.DELIVERYSIZE - ISNULL(grd.DELIVERYSIZERECEIVED, 0)) as remainingcartons
FROM TBLPODETAILS pod 
  LEFT OUTER JOIN TBLGRDETAILS grd 
    ON pod.PONUM = grd.PONUM and pod.ITMNUM = grd.ITMNUM) t
GROUP BY t.ITMNUM, t.PONUM, t.ordered
ORDER BY t.PONUM ) as x

join MYTABLE on MYTABLE.ITMNUM=x.itmnum AND MYTABLE.PONUM=i.ponum 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T13:36:00.800

正如 KM 在评论中所说，这里的问题是回到客户端应用程序，然后通过另一个数据库行程对每一行进行操作。这很慢，并且可能导致愚蠢的小错误，这可能会导致虚假数据。

此外，将字符串连接到 SQL 通常被认为是一个非常糟糕的主意 - SQL 注入（如 Joel Coehoorn 所写）是一种真正的可能性。

怎么样：

```
create view OrderBalance 
as 
SELECT t.PONUM, t.ITMNUM, t.ordered, 
       SUM(t.received) as received, 
       t.ordered - ISNULL(SUM(t.received),0) as remaining, 
       SUM(t.orderedcartons) as orderedcartons, 
       SUM(t.cartonsreceived) as cartonsreceived, 
       SUM(t.remainingcartons) as remainingcartonsFROM(SELECT pod.PONUM, 
       pod.ITMNUM, pod.QTY as ordered, ISNULL(grd.QTYRECEIVED, 0) as received, 
       pod.DELIVERYSIZE as orderedcartons, 
       ISNULL(grd.DELIVERYSIZERECEIVED, 0) as cartonsreceived, 
       (pod.DELIVERYSIZE - ISNULL(grd.DELIVERYSIZERECEIVED, 0)) as remainingcartons
FROM TBLPODETAILS pod 
  LEFT OUTER JOIN TBLGRDETAILS grd 
    ON pod.PONUM = grd.PONUM and pod.ITMNUM = grd.ITMNUM) t
GROUP BY t.ITMNUM, t.PONUM, t.ordered 
```

这似乎正是您的“MYTABLE”拥有的数据 - 也许您甚至不再需要 MYTABLE，您可以使用视图！

如果您在 MYTABLE 上有其他数据，您的更新将变为：

```
UPDATE MYTABLE 
SET REMAININGITEMS       = ob.remainingitems, 
    REMAININGDELIVERYSIZE = ob.remainingBoxes
from MYTABLE mt 
   join OrderBalance ob 
on mt.ITMNUM = ob.itemNumber 
AND mt.PONUM = ob.poNumber 
```

（尽管正如 David Mannheim 所写，最好不要使用视图并使用类似于他提出的解决方案）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:35:09.047

其他答案向您展示了一种完全在 RDBMS 中执行整个更新的好方法。如果您可以那样做，那就是完美的解决方案：由于额外的往返和数据传输问题，您无法用 C#/RDBMS 组合击败它。

但是，如果您的更新需要*一些*由于某种原因无法在 RDBMS 中执行的计算，您应该修改您的代码以构建单个参数化更新来代替您当前正在构建的可能巨大的 150000 行更新。

```
using (var upd = conn.CreateCommand()) {
    upd.CommandText = @"
        UPDATE MYTABLE SET
            REMAININGITEMS=@remainingQty
        ,   REMAININGDELIVERYSIZE=@remainingBoxes
        WHERE ITMNUM=@itemNumber AND PONUM=@poNumber";
    var remainingQtyParam = upd.CreateParameter();
    remainingQtyParam.ParameterName = "@remainingQty";
    remainingQtyParam.DbType = DbType.Int64; // <<== Correct for your specific type
    upd.Parameters.Add(remainingQtyParam);
    var remainingBoxesParam = upd.CreateParameter();
    remainingBoxesParam.ParameterName = "@remainingBoxes";
    remainingBoxesParam.DbType = DbType.Int64; // <<== Correct for your specific type
    upd.Parameters.Add(remainingBoxesParam);
    ...
    foreach (DataRow POUpdate in dt.Rows) {
        remainingQtyParam.Value = ...
        remainingBoxesParam.Value = ...
        upd.ExecuteNonQuery();
    }
} 
```

这个想法是将 150,000 个看起来相同的更新变成一个实际上是单个语句的*参数化更新。*

# sql-server - 使用变量和游标中的数据库名称进行跨数据库查询

> ID：11452786
> 
> 赞同：0
> 
> 时间：2012-07-12T13:22:34.893
> 
> 标签：sql-server, database

我对游标中的数据库名称有疑问。这里是当前代码

```
DECLARE @IDES INT
DECLARE @IDPROD INT

DECLARE @count INT
SET @count = 0

DECLARE CUR_CONSO CURSOR LOCAL fast_forward FOR

    SELECT E2.id_es ,P3.id_prod FROM
    [gpto_v004p001].[dbo].[GPTO_PRODETAB] P1
    INNER JOIN
    [fer_v008].[dbo].[T_PRODUIT] P3
    ON P3.GPTO_PRODUIT_ID = P1.GPTO_PRODUIT_ID
    INNER JOIN [gpto_v004p001].[dbo].[GPTO_ETAB] E1
    ON E1.ETABID = P1.ETABID
    INNER JOIN
    [fer_v008].[dbo].[t_etablissement] E2
    ON E1.ETABUC = LEFT(E2.code_es,5)
    LEFT JOIN
    [fer_v008].[dbo].[t_produit_etablissement] PE1
    ON PE1.id_prod = P3.id_prod AND PE1.id_es = E2.id_es
    WHERE PE1.id_es IS NULL AND GPTO_PRODUIT_ETAPE = 4

OPEN CUR_CONSO

FETCH CUR_CONSO INTO @IDES , @IDPROD

WHILE @@FETCH_STATUS = 0

BEGIN

    IF NOT EXISTS (Select * from [fer_v008].[dbo].[t_produit_etablissement] where id_es=@IDES and id_prod=@IDPROD) -- Pas d'enregistrements
    BEGIN

        INSERT INTO [fer_v008].[dbo].[t_produit_etablissement]
               ([id_es],[id_prod],[gest_prod])
         VALUES
               (@IDES,@IDPROD,0)

        SET @count = @count + 1

    END

FETCH CUR_CONSO INTO @IDES , @IDPROD

END

CLOSE CUR_CONSO

DEALLOCATE CUR_CONSO 
```

由于数据库是版本化的，我需要使用数据库名称作为保存在参数表中的变量。对于简单的脚本，我使用 Execute 命令作为这个

```
DECLARE @base_travail varchar(128)
SELECT @base_travail = val_str_par FROM t_parametre WHERE nom_par = 'base_travail'
DECLARE @execcmd varchar(max)
SET @execcmd = 'insert into #tmpfiltres SELECT TOP 1 filtre_exu FROM ' 
  +  @base_travail + '.dbo.t_export_util WHERE id_exu =' + convert(varchar,@id_exu)
Execute (@execcmd) 
```

但是当我有光标时怎么办？第一个示例代码只是一个示例，整个脚本超过 400 行，所以我无法在字符串模式下切换所有脚本。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-17T16:23:42.063

我遇到过同样的问题。与数据库兼容级别有关。

此代码：

```
DECLARE @VARSql varchar(2000), @ID int;
SET @VARSql = 'USE [SomeOtherDatabase]; DECLARE cur CURSOR GLOBAL for 
  SELECT Max(SomeTableID) FROM [dbo].[SomeTable];';
Exec(@VARSql); open cur; fetch next from cur into @ID; close cur; deallocate cur;
PRINT @ID 
```

产生了这个错误：

```
Msg 16958, Level 16, State 3, Line 3
Could not complete cursor operation because the set options have changed since the cursor was declared. 
```

在 SQL 2008 服务器上运行。
调用数据库的兼容级别为 90 (Sql Svr 2005)。上面代码中的 SomeOtherDatabase 具有兼容级别 100 (Sql Svr 2008)。

如果您更改兼容性级别，以便调用和被调用的数据库相同，问题就解决了。

```
select * from sys.databases
ALTER DATABASE [CallingDatabase] SET COMPATIBILITY_LEVEL = 100; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-25T13:24:33.980

我有同样的问题。这是我的解决方案；

```
DECLARE CUR_CORSO CURSOR **FAST_FORWARD FORWARD_ONLY** FOR 
```

...

# compiler-construction - D的编译时评估的用例是什么

> ID：11452791
> 
> 赞同：8
> 
> 时间：2012-07-12T13:22:49.730
> 
> 标签：compiler-construction, ocaml, d

我将此功能集成到我最喜欢的语言 OCaml 中，我知道这是 D 中的性感功能，但是除了一些优化之外，编译时评估的用例是什么？越多越好，极客越好:-)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-12T15:45:26.953

当然，优化是一个很大的用例。像[ctRegex](http://dlang.org/phobos/std_regex.html#ctRegex)这样的东西比它们的运行时编译的正则表达式（通常）表现得更好。解析器生成器也很有趣（请参阅[Pegged](https://github.com/PhilippeSigaud/Pegged)）并且将受到越来越多的关注。人们才刚刚开始挖掘可以做的事情。

您可以`mixin(import_c("header.h"))`为任意 C 头文件解析和构建 D 接口文件（当然，您需要在 D 中为 C 编写解析器来执行此操作）。

`"%0.2f"`由于格式字符串（例如， ）通常在编译时已知，因此可以进行极快的字符串格式化。您可以读取格式字符串并仅生成格式化所需的代码，去除各种不必要的部分。

[vibe.d](http://vibed.org/)实际上支持编译时模板。模板文件（基于 Jade/HAML）可以包含 D 代码。它读取它并生成一个自定义的 D 代码块（把它想象成“”~标题~“...”）。我不相信作者已经做过基准测试，但它应该非常快。

您基本上可以在保持高水平的同时获得专门的手动优化代码的好处。很难回答您的问题，因为我们只是不知道它的用途。它让我想起了 C++ 模板。他们的设计者没有预料到它启用的高级元编程技术。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-12T15:34:29.710

一些建议：

*   **在编译时**解析一个 PEG 语法，组装一个 PEG 解析器，然后使用所述解析器怎么样？这是[挂钩](https://github.com/PhilippeSigaud/Pegged)项目。
*   大型静态查找表的构建。
*   为正则表达式生成最佳本机代码：[std.regex.StaticRegex](http://dlang.org/phobos/std_regex.html#StaticRegex)
*   从定义文件实现 protobufs。
*   许多函数，如果它们的输入在编译时是已知的，那么就可以在运行时而不是在运行时进行评估——所有这些都不会改变函数的实现。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-13T23:10:38.703

当与 一起使用时`mixin`，它可以提供很大的灵活性。

考虑以下示例：

```
template StructFromFile(string fileName){
    string makeStructMembersCode(string[] s){
        if(0==s.length){
            return null;
        }
        string memberName=s[0].strip;
        return q{
            string }~memberName~q{;
            }~makeStructMembersCode(s[1..$]);
    }
    struct StructFromFile{
        mixin(makeStructMembersCode(import(fileName).splitLines));
    }
} 
```

这将创建一个结构，它的成员是文本文件的行。现在，假设您在数据库中有一个表，并且您想创建一个 D 结构来存储该表中的行。您可以编写一个 shell 脚本来读取该表的架构并将其写入文件，然后使用`StructFromFile`它自动创建一个可以保存该表行的结构。如果更改架构，则不会更改结构的代码。但是，您确实必须更改任何依赖于旧模式的代码 - 但这是一件好事，因为它会将运行时错误转化为编译错误。

当然，您也可以使用此方法添加 getter+setter 属性，并将其用于 XML DTD 和 Web 服务。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-06T17:34:27.147

这是我能想到的最极客的编译时评估应用程序：以函数的形式为您自己的编程语言编写一个编译器，该函数`string f(string code)`将您的编程语言的源代码作为参数并输出 D 代码。然后写类似

```
mixin( f( import("my_code_file") ) ); 
```

到你的`main.d`文件中。这样您就可以滥用 D 编译器及其后端为您生成可执行文件。如果需要，您可以编写一个 shell 脚本（或类似的脚本）来创建`main.d`文件并在其上运行 D 编译器。这样，您就可以为您的语言获得一半的编译器。至少你不需要关心后端。;)

Appart 从那，我已经阅读了 D 中的编译时光线跟踪器。

# r - 如何在 R 包函数中使用非 ASCII 符号（例如 £）？

> ID：11452796
> 
> 赞同：13
> 
> 时间：2012-07-12T13:23:03.777
> 
> 标签：r, warnings, package, ascii

我的一个 R 包中有一个简单的函数，其中一个参数是`symbol = "£"`：

```
formatPound <- function(x, digits = 2, nsmall = 2, symbol = "£"){ 
  paste(symbol, format(x, digits = digits, nsmall = nsmall)) 
} 
```

但是在运行时`R CMD check`，我收到以下警告：

```
* checking R files for non-ASCII characters ... WARNING
Found the following files with non-ASCII characters:
  formatters.R 
```

绝对是`£`导致问题的那个符号。如果我用合法的 ASCII 字符替换它，比如`$`，警告就会消失。

**问题：如何`£`在我的函数参数中使用而不引起`R CMD check`警告？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-12T13:27:06.043

看起来“编写 R 扩展”在第 1.7.1 节[“编码问题”](http://cran.r-project.org/doc/manuals/R-exts.html#Encoding-issues)中涵盖了这一点。

* * *

此页面中的一项建议是使用 Unicode 编码`\uxxxx`。由于 £ 是 Unicode 00A3，您可以使用：

```
formatPound <- function(x, digits=2, nsmall=2, symbol="\u00A3"){
  paste(symbol, format(x, digits=digits, nsmall=nsmall))
}

formatPound(123.45)
[1] "£ 123.45" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-02-24T20:28:34.450

作为一种解决方法，您可以使用`intToUtf8()`以下功能：

```
# this causes errors (non-ASCII chars)
f <- function(symbol = "➛")

# this also causes errors in Rd files (non-ASCII chars)
f <- function(symbol = "\u279B")

# this is ok
f <- function(symbol = intToUtf8(0x279B)) 
```

# java - Hibernate注解映射，复杂图

> ID：11452801
> 
> 赞同：0
> 
> 时间：2012-07-12T13:23:10.713
> 
> 标签：java, hibernate, orm, hibernate-mapping

在为交付的图表进行正确映射时，我遇到了一些大问题。它看起来像这样：

[![图表](../Images/db586a16fdc266d60084bca6a9099da6.png)](https://i.stack.imgur.com/6V2XY.jpg)

现在，到目前为止，我这样做了，希望它没问题（省略 getter/setter）。你会注意到`USERS`has `DOMAIN_ID`，忽略它，因为它不是完整的图表。

**功能组**

```
@Entity
@Table(name = "FUNCTIONALITY_GROUP")
public class FunctionalityGroup implements Serializable
{
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
@Column(name = "FUNCTIONALITY_GROUP_ID")
private Long functionalityGroupId;

@Column(name = "FUNCTIONALITY_GROUP_NM")
private String functionalityGroupName;

@Column(name = "FUNCTIONALITY_GROUP_DESC")
private String functionalityGroupDesc;

@OneToMany(fetch = FetchType.LAZY, mappedBy = "funcionalityGroupId")
private List<Functionality> functionalityList;
} 
```

**功能性**

```
@Entity
@Table(name = "FUNCTIONALITY")
public class Functionality implements Serializable
{
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
@Column(name = "FUNCTIONALITY_ID")
private Long functionalityId;

@Column(name = "FUNCTIONALITY_NM")
private String functionalityGroupName;

@Column(name = "FUNCTIONALITY_DESC")
private String functionalityGroupDesc;

@Column(name = "FUNCTIONALITY_GROUP_ID")
private Long funcionalityGroupId;

@ManyToMany(fetch = FetchType.LAZY)
@JoinTable(name = "ROLE_FUNCTIONALITY",
        joinColumns = {@JoinColumn(name = "FUNCTIONALITY_ID")},
        inverseJoinColumns = {@JoinColumn(name = "ROLE_ID")})
private List<Role> roleList;
} 
```

**角色**

```
@Entity
@Table(name = "ROLE")
public class Role implements Serializable
{
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
@Column(name = "ROLE_ID")
private Integer roleId;
@Column(name = "ROLE_NM")
private String roleName;
@Column(name = "ROLE_DESC")
private String roleDesc;
@Column(name = "OBJECT_TYPE")
private String objectType;

@ManyToMany(fetch = FetchType.LAZY, mappedBy = "roleList")
private List<Functionality> functionalityListy;
} 
```

**用户**

```
@Entity
@Table(name = "USERS")
public class Users implements Serializable
{
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
@Column(name = "USER_ID")
private Long userId;
@Column(name = "USER_DESC")
private String userDesc;
@Column(name = "FIRST_NM")
private String firstNM;
@Column(name = "LAST_NM")
private String lastNM;
@Column(name = "IS_ENABLED")
private String isEnabled;
} 
```

我不知道 Role_Member 和 Role_Member_Entry 应该如何映射和处理对象世界，有人可以给我一些点击吗？谢谢！

通常我会用多对多的角色连接用户，但实体 Role_Member_Entry 破坏了一切。

# wso2 - WSO2 ESB Carbon 应用程序在自动部署后取消部署，没有日志错误

> ID：11452813
> 
> 赞同：0
> 
> 时间：2012-07-12T13:23:59.327
> 
> 标签：wso2, wso2esb

我有一个要在 wso2 esb 中部署的碳应用程序。我部署它，我可以在日志中看到如何成功部署，但之后它开始取消部署并显示任何错误。这是日志条目：

```
TID: [0] [WSO2 ESB] [2012-07-12 15:13:46,521] INFO {org.wso2.carbon.application.deployer.internal.ApplicationManager} - Successfully Undeployed Carbon Application : myApp {super-tenant} {org.wso2.carbon.application.deployer.internal.ApplicationManager}
TID: [0] [WSO2 ESB] [2012-07-12 15:13:46,425] INFO {org.wso2.carbon.application.deployer.internal.ApplicationManager} - Undeploying Carbon Application : myApp... {org.wso2.carbon.application.deployer.internal.ApplicationManager
TID: [0] [WSO2 ESB] [2012-07-12 15:13:23,551] INFO {org.wso2.carbon.application.deployer.internal.ApplicationManager} - Successfully Deployed Carbon Application : myApp {super-tenant} {org.wso2.carbon.application.deployer.internal.ApplicationManager
TID: [0] [WSO2 ESB] [2012-07-12 15:13:22,727] INFO {org.wso2.carbon.application.deployer.internal.ApplicationManager} - Deploying Carbon Application : myApp-1.0.0.car... {org.wso2.carbon.application.deployer.internal.ApplicationManager 
```

有时我什至可以看到创建的代理，但几秒钟后，该应用程序已从应用程序列表中消失。

有什么帮助或想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T06:31:31.130

尝试只部署代理服务，看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T19:39:47.857

你有什么作为注册表资源，注册表资源的服务器角色是什么？

如果要将C-App中的registry资源部署到ESB中，需要将registry资源的Server role改为ESB server role。

谢谢并恭祝安康，

哈沙娜

# jquery - Chrome 中的 Spinner，IE9 在同步 ajax 获取请求期间不可见

> ID：11452817
> 
> 赞同：2
> 
> 时间：2012-07-12T13:24:17.617
> 
> 标签：jquery, css, google-chrome, internet-explorer-9

我希望我的用户在 ajax 请求期间看到微调器。我的微调器在 Firefox 13 上完美运行。然而，在 Chrome 和 IE9 中它不起作用，尽管我的 ajax 请求需要相当长的时间。像1,2秒。

```
$('#fileManager').on('click', '.navSpan', function() {

    /* show spinner */
    $('.fileManager-spinner').show();

    /* synchronous  ajax fetch and manipulation goes here */

    /* hide spinner when done */
    $('.fileManager-spinner').hide();
} 
```

如果我删除`$('.fileManager-spinner').hide();`线，它就会变得可见并开始在 Chrome 和 IE 中旋转。但是，当该线存在时，它不会变得可见。

或者，如果我调试代码并在`.show()`and之间暂停执行`.hide()`，它也会停留在屏幕上。但正如我所说，在正常情况下，不可能看到微调器。

这是旋转器。

```
<div class="fileManager-spinner" style="display: none;"></div> 
```

下面是微调器CSS。

```
.fileManager-spinner
{
    position:relative;
    top: 50%;
    left: 50%;
    margin-left: -50px; /* half width of the spinner gif */
    margin-top: -50px; /* half height of the spinner gif */
    text-align:center;
    z-index:1234;
    overflow: auto;
    width: 100px; /* width of the spinner gif */
    height: 102px; /*hight of the spinner gif +2px to fix IE8 issue */  
    background-image: url(../../Images/fileManager/loader/loaderBig.gif);
    background-repeat:no-repeat;
} 
```

可能是什么问题呢 ？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:27:56.017

我猜从您在这里展示的内容来看，您正在执行同步 ajax 查询。在此查询期间，Chrome 的引擎不会离开 javascript 线程，也不会更新屏幕。

您应该使用异步 ajax 请求并简单地删除回调中的微调器。

请注意，下一个版本的 jquery (1.8) 将不推荐使用同步 ajax 查询。

您可以使用

```
// show spinner
$.ajax({
  url: "http://fiddle.jshell.net/favicon.png",
  // some things
}).done(function ( data ) {
  // remove spinner
}); 
```

请参阅[jquery ajax done、always 和 fail 函数](http://api.jquery.com/jQuery.ajax/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:32:14.340

Ajax 应该是非阻塞的。您需要在 Ajax 请求返回后运行的函数中进行隐藏。

所以...

```
$.ajax(...).done(function(){ $(".fileManager-spanner").hide(); }); 
```

应该管用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T14:39:18.817

当调用成功返回时，使用调用中的内置`success`参数`$.ajax`来执行函数。

我不确定您使用同步调用是否有特定原因，但如果没有，我建议切换到异步调用。

# xcode - Xcode 4.3.3 有效的配置文件

> ID：11452822
> 
> 赞同：0
> 
> 时间：2012-07-12T13:24:31.990
> 
> 标签：xcode, certificate, provisioning, portal

在 Xcode 4.3.3 中，我可以将我的应用程序提交到应用商店，它正在“等待审核”。我从我的设备（iPad）中删除了我的应用程序，然后我决定重新打开它。我不能不做到这一点。Xcode 表示构建成功，但随后会出现一条消息，指出“找不到此可执行文件的有效配置文件”。它不会在 Xcode 中显示为红旗，而是它自己的窗口。

我从来没有处理过像 Xcode 和供应门户和代码签名这样令人沮丧的苹果产品。苹果，为这个永无止境的挫折循环做点什么。啊！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:10:08.437

当我第一次学习这个时，我也有这种感觉：

> 我从来没有处理过像 Xcode 和供应门户和代码签名这样令人沮丧的苹果产品。

如果您刚刚将应用程序提交到 App Store，则您使用了**分发**配置文件。不过，您应该检查以确保您的**开发人员**资料仍然有效。在左栏顶部的 Xcode 中单击您的项目，然后单击 Build Settings > Code Signing > Code Signing Identity > Debug > Any iOS SDK。它应该这样说：

> iPhone 开发者（当前匹配“iPhone 开发者等等等等”）

如果没有这样说，请从下拉列表中选择您的个人资料。如果没有匹配的个人资料。您需要重新下载它。让我知道这是否有帮助。

# c# - 改进我失败的正则表达式

> ID：11452826
> 
> 赞同：0
> 
> 时间：2012-07-12T13:24:46.887
> 
> 标签：c#, regex, string

我的正则表达式正在工作 - 直到它捕获的字符串形式略有变化。它过去总是采用以下形式：

```
Word1 - Word2 - 01.2.3456.7890 - xx-xx - Word 3 [Word-inbracket] 
```

我对捕获`xx-xx`.

为了捕获此数据，以下正则表达式起作用：

```
(.+\s*-\s*.+\s*-\s*.+)\s*-\s*(\w{1,3}\s*-\s*\w{1,3})\s*-\s*.+ 
```

从中选择组[2]。

然而，现在字符串已经改变了形式，因此有时会出现另一个破折号，以及 . 后面的 1 到 4 个字符之间的另一组字母`xx-xx`。（请记住，这只有时会发生）。

所以，现在我还需要捕获以下形式的信息：

```
Word1 - Word2 - 01.2.3456.7890 - xx-xx-XxxX - Word 3 [Word-inbracket]
Word1 - Word2 - 01.2.3456.7890 - xXX-XxX-xxxx - Word 3 [Word-inbracket] 
```

等等。

除了以前捕获的字符串之外，我如何编辑我的正则表达式来捕获这个字符串？最干净的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:37:20.097

有点hacky，但这可以解决问题：

```
(.+\s*-\s*.+\s*-\s*.+)\s*-\s*((\w{1,3}\s*-\s*\w{1,3})|(\w{1,4}\s*-\s*\w{1,4}))\s*-\s*.+ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:42:18.317

我相信这应该这样做：

```
(.+?\s*-\s*.+?\s*-\s*.+?)\s*-\s*(\w{1,3}\s*-\s*\w{1,3})\s*(?:-(\w{1,3}))?\s*-\s*.+ 
```

我所做的更改是：

*   通过添加“？”使开头的任何字符匹配不贪心。在他们之后 - 当额外的位存在时，这可以防止他们狼吞虎咽。
*   添加了 '(?:-(\w{1,3}))?' 如果存在，它匹配可选的额外位，但不捕获'-'前缀（'？：'使外部组不捕获）。

这将为您提供一个包含可选位的额外捕获组。

[您可以在此处](http://regexr.com?31guu)看到它的实际效果（已编辑）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:45:59.190

基于输入行，可以完全采用更简化的方法。

以下正则表达式匹配这两种情况，并且也应该适用于对被修改部分的任何其他修改。

```
([^-]*-){3}\s*([^\s]+).* 
```

这应该捕获第一组“Word1 - Word2 - 01.2.3456.7890 -”，然后是第二组“xx-xx-XxxX”。

另请注意，我假设第二个所需组不包含空格，因为示例字符串没有空格。

解释：

```
([^-]*-){3}    # captures the "word1 - word2 - word3.234.234 -" block
\s*
([^\s]+)       # captures the "xx-xx-xxx" block up to the first whitespace char.
.*             # matches the rest of the line 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T14:06:28.673

这更清楚 .+\s-\s(.+)\s-\s.+$

# syntax-highlighting - 向 JamWiki-1.2 添加语法荧光笔

> ID：11452830
> 
> 赞同：1
> 
> 时间：2012-07-12T13:25:16.303
> 
> 标签：syntax-highlighting

教程[http://sinnerinc22.blogspot.de/2010/07/adding-syntax-highlighter-to-jamwiki.html](http://sinnerinc22.blogspot.de/2010/07/adding-syntax-highlighter-to-jamwiki.html)描述了如何在[JAMWiki](http://jamwiki.org/wiki/en/JAMWiki)中启用语法高亮。

我的问题是，在最新版本的 JAMWiki v1.2 中，要修改的两个文件`WEB-INF/jsp/top.jsp`不再`WEB-INF/jsp/close-document.jsp`存在......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T02:28:37.270

[JAMWiki 1.2链接](http://jamwiki.org/wiki/en/Help%3aTag_extensions#a_.3Csource.3E)提供了一个第三方语法高亮标签扩展，可能对您有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T17:29:56.300

我只是按照 SHJS 说明而不是 JAMWiki 说明将[SHJS添加到我的安装中。](http://shjs.sourceforge.net/)只需编辑 JAMWiki JSP 页面以添加[此处](http://shjs.sourceforge.net/doc/documentation.html)记录的内容。要了解它是如何工作的，请查看[此 HTML 文档](http://ultrastudio.org/en/Special%3aReview?review=4ca60e46-0956-3f22-983c-e3ed986dfd03&pkg=1&cls=3&view=1)的源代码。

在你编辑 JSP 之后你甚至不需要编译任何东西，服务器会自动为你做这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-25T20:04:58.890

跟进 Audrius 的回答，这正是您需要修改的内容。

1.  `./jamwiki.war/WEB-INF/jsp/topic.jsp` [修改它看起来像这样](https://gist.github.com/garypaduana/11301202)
2.  [下载 SHJS zip](http://shjs.sourceforge.net/doc/download.html)并将所有单个文件从`./css/`、`./lang/`、`./sh_main.js`和zip 复制`./sh_style.css`到`JamWiki.war/shjs/`. （这将展平目录结构，因此现在所有内容都在`./shjs/`. 展平结构是可选的，但它使在 jsp 中引用它们时路径更容易。）
3.  您可以`.war`使用 7zip 修改或挖掘您的 Web 应用程序容器文件系统并直接放置 JSP 和 shjs 文件夹。
4.  根据您首选的编辑方法，根据需要重新部署或刷新。

# javascript - 将图像加载到织物画布背景

> ID：11452831
> 
> 赞同：4
> 
> 时间：2012-07-12T13:25:26.773
> 
> 标签：javascript, canvas, html5-canvas, filereader, fabricjs

您好我正在尝试上传图像并将其作为画布背景。代码片段：

```
function handleMenuImage(e){
    var reader = new FileReader();
    reader.onload = function(event){
        var img = new Image();
        img.src = event.target.result;
        canvas.setWidth(img.width);
        canvas.setHeight(img.height);
        canvas.setBackgroundImage(img.src, canvas.renderAll.bind(canvas));

        //set the page background
        menuPages[currentPage].pageBackground.src = img.src;
        canvas.backgroundImageStretch = false;

    }
    reader.readAsDataURL(e.target.files[0]); 
} 
```

问题是画布没有显示背景。我可以在 chrome devtools 中看到画布背景 src。背景实际上已设置，但不知何故未显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:32:07.707

这似乎奇怪的令人困惑。如果你想要 HTMLCanvasElement 上的背景图片，为什么不直接通过 CSS 设置背景图片呢？

```
#myCanvas {
  background-image: url(http://placekitten.com/100/100);
} 
```

或者通过 JavaScript 设置 CSS：

```
canvas.style.backgroundImage = 'url(http://placekitten.com/100/100)'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-21T09:16:18.917

试试下面的代码：

```
var raw_reader = new FileReader();
raw_reader.onload = function (event){
  var reader = new FileReader();
  reader.onload = function(event){
    var img = new Image();
    img.src = event.target.result;
    canvas.setWidth(img.width);
    canvas.setHeight(img.height);
    canvas.setBackgroundImage(img.src, canvas.renderAll.bind(canvas));

    //set the page background
    menuPages[currentPage].pageBackground.src = img.src;
    canvas.backgroundImageStretch = false;

  }
  reader.readAsDataURL(e.target.files[0]); 
}
raw_reader.readAsBinaryString(e.target.files[0]); 
```

# oracle - Oracle wm_concat 获取一行然后 Case 检查值

> ID：11452835
> 
> 赞同：0
> 
> 时间：2012-07-12T13:25:43.450
> 
> 标签：oracle, oracle10g

我只想按 Painter 或不按 Painter 排序。

甲骨文 10g

# 示例数据：

**工作类型**

*   厨师
*   画家
*   程序员
*   邮递员
*   接待员
*   家庭主妇
*   父亲
*   母亲
*   ETC

一个人可以为每种工作类型设置一行，但他们可以拥有多个工作。

```
SELECT   ...(LIST OF FIELDS)...,
         WM_CONCAT(job_type) AS myJob_Type
FROM     (MYTABLE)
GROUP BY ...(LIST OF FIELDS)... 
```

这为我提供了逗号分隔列表中 myJob_Type 中的所有 job_type。这行得通。

现在我想要一种方法，当作业中有“画家”时，我可以按 myJob_Type 进行排序。我不关心任何其他工作类型。所以我的想法是提出一个案例，如果 Painter 在 myJob_Type 中，但是当我让它工作时，我又会得到多行。

```
SELECT ...(LIST OF FIELDS)...,
WM_CONCAT(job_type) AS myJob_Type,
CASE WHEN(job_ype like '%Painter%') THEN '1'
ELSE '0'
END

FROM     (MYTABLE)
GROUP BY ...(LIST OF FIELDS)...,
         job_ype 
```

尝试了另一种选择。

```
SELECT ...(LIST OF FIELDS)...,
WM_CONCAT(job_type) AS myJob_Type,

CASE WHEN(myJobType like '%Painter%') THEN '1'
ELSE '0'
END

FROM      (MYTABLE)
GROUP BY  ...(LIST OF FIELDS)...,
          myJobType 
```

有什么建议么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:31:24.167

你可以试试：

```
select   ...
         wm_concat(job_type) as myJob_Type,
         sum(decode(job_type,'Painter',1,0))
from     ...
group by ... 
```

# python - django 数据库路由器无法导入名称连接

> ID：11452837
> 
> 赞同：1
> 
> 时间：2012-07-12T13:26:03.347
> 
> 标签：python, database, django

我对 Django 1.4（python 2.6）上的数据库路由器有疑问。我已遵循文档（https://docs.djangoproject.com/en/dev/topics/db/multi-db/#automatic-database-routing）但是当我运行我的服务器时，我有以下错误消息：

```
django.core.exceptions.ImproperlyConfigured: Error importing database router MyDBRouter: "cannot import name connection" 
```

我的设置.py

```
DATABASES = {
    'default': {
        ...
    },
    'other' : {
        ...
    }
}
DATABASE_ROUTERS = ['core.models.MyDBRouter',] 
```

这里是数据库路由器代码：

```
class MyAppRouter(object):
    def db_for_read(self, model, **hints):
        "Point all operations on myapp models to 'other'"
        if model._meta.app_label == 'myapp':
            return 'other'
        return None

    def db_for_write(self, model, **hints):
        "Point all operations on myapp models to 'other'"
        if model._meta.app_label == 'myapp':
            return 'other'
        return None

    def allow_relation(self, obj1, obj2, **hints):
        "Allow any relation if a model in myapp is involved"
        if obj1._meta.app_label == 'myapp' or obj2._meta.app_label == 'myapp':
            return True
        return None

    def allow_syncdb(self, db, model):
        "Make sure the myapp app only appears on the 'other' db"
        if db == 'other':
            return model._meta.app_label == 'myapp'
        elif model._meta.app_label == 'myapp':
            return False
        return None 
```

我尝试用“默认”替换无，但它仍然不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T08:52:15.557

我通过在 settings.py 上添加“from django.db import connections”解决了这个问题

```
151 # Database router                                                                                                                                       
152 from django.db import connections
153 DATABASE_ROUTERS         = ['core.models.MyDBRouter',] 
```

现在服务器运行正常！但是路由器只是被django忽略了->要修复它，永远不要将路由器保存在模型中！创建新文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-26T18:06:33.123

这对我没有好处，我在这里发布了我的解决方案[https://stackoverflow.com/a/17888067/978912](https://stackoverflow.com/a/17888067/978912)，也许它可以避免通过无尽的导入链进行调试的痛苦。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-05T15:35:29.697

就像`Zakum`在他的解决方案中说的那样，

如果上述解决方案不适合您，请查看您是否进行了导入

```
from django.db.models import Model 
```

在您的任何路由文件中。如果是这样，您必须将其删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-23T22:33:55.057

对我来说，问题被编码在`__init__.py`我的一个应用程序的文件中。我认为init文件是文件的直接依赖关系`settings.py`，这可能会导致循环导入。

# deployment - Sharepoint 2010 列表架构部署

> ID：11452840
> 
> 赞同：0
> 
> 时间：2012-07-12T13:26:18.930
> 
> 标签：deployment, sharepoint-2010, custom-lists

我在 VS2010 中创建了一个列表架构定义和列表实例。我有一个同时部署列表定义和实例的功能，以及一个为每个新子站点激活新功能的功能订书机。

我的列表定义 schema.xml 是：

```
 <Fields>
  <Field Name="StartDate" Type="DateTime" Required="FALSE" DisplayName="Start Date" StaticName="StartDate" ID="9ea1256f-6b67-43b0-8ab7-1d643bf8a834" SourceID="http://schemas.microsoft.com/sharepoint/v3" ColName="datetime1" RowOrdinal="0" />
  <Field Name="EndDate" Type="DateTime" Required="FALSE" DisplayName="End Date" StaticName="EndDate" ID="900503fa-4ab1-4938-be75-b40694ab97b6" SourceID="http://schemas.microsoft.com/sharepoint/v3" ColName="datetime2" RowOrdinal="0" /> 
```

我成功部署并使用我的站点定义创建了一个新站点，列表成功创建，一切正常。

现在我想在我的列表中添加另一个字段，我回到 Visual Studio 2010 编辑列表定义 schema.xml 并在元数据字段部分添加另一个字段。

schema.xml 现在是：

```
 <Fields>
  <Field Name="StartDate" Type="DateTime" Required="FALSE" DisplayName="Start Date" StaticName="StartDate" ID="9ea1256f-6b67-43b0-8ab7-1d643bf8a834" SourceID="http://schemas.microsoft.com/sharepoint/v3" ColName="datetime1" RowOrdinal="0" />
  <Field Name="EndDate" Type="DateTime" Required="FALSE" DisplayName="End Date" StaticName="EndDate" ID="900503fa-4ab1-4938-be75-b40694ab97b6" SourceID="http://schemas.microsoft.com/sharepoint/v3" ColName="datetime2" RowOrdinal="0" />

  <!-- New Field -->

  <Field Name="TestRedeploy" Type="Text" Required="FALSE" DisplayName="TestRedeploy" StaticName="TestRedeploy"  RichText="True" Sortable="FALSE" ID="A5656659-CD3E-4C84-AEAC-554DCE25434B" SourceID="http://schemas.microsoft.com/sharepoint/v3" ColName="ntext3" RowOrdinal="0" />
</Fields> 
```

我成功构建和部署，但是当我进入列表设置以检查是否添加了新列时，我发现所有列都已被删除。您能帮我弄清楚如何使用 schema.xml 部署新列吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T11:55:07.367

您应该尝试重新安装部署列表的功能

转到 sharepoint 2010 管理控制台并写入

install-spfeature -path "14'hive 中的功能文件夹名称" -force

在此之后进行 IISRESET 并重新加载页面。这应该足以使该字段可见。

顺便说一句，你永远不应该在你的 xml 中包含 colname 和 rowordinal 值。这些将在部署字段时由 sharepoint 自动提供。当前部署可能面临的一个问题是已经有一个列表字段映射到 colname="ntext3"。

# ios - 在不中断交互的情况下向 UIView 添加圆角。

> ID：11452842
> 
> 赞同：4
> 
> 时间：2012-07-12T13:26:23.033
> 
> 标签：ios, rounded-corners, uibezierpath, cashapelayer

这个答案很好用，[将圆角添加到 UITableView 的顶部？](https://stackoverflow.com/questions/8621798/adding-rounded-corners-to-only-top-of-uitableview)除了我的 UIBarButtonItems 不再可点击。我的猜测是，面具现在位于破坏交互的按钮之上。

有没有人有任何想法来实现这一点而不干扰其他视图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T13:29:37.820

您是否尝试过仅屏蔽`tableView's`图层：

```
CAShapeLayer * maskLayer = [CAShapeLayer layer];
maskLayer.path = [UIBezierPath bezierPathWithRoundedRect: self.bounds byRoundingCorners: UIRectCornerTopLeft | UIRectCornerTopRight cornerRadii: (CGSize){10.0, 10.}].CGPath;

self.tableView.layer.mask = maskLayer; 
```

或者只是使用：

```
self.tableView.layer.cornerRadius = 10.0 
```

整张桌子

# email - WinRT/Metro/Win8 共享合同 - 如何发送带有主题、文本和附件的邮件？

> ID：11452845
> 
> 赞同：1
> 
> 时间：2012-07-12T13:26:25.307
> 
> 标签：email, microsoft-metro, windows-runtime

是否有内置功能可以将文本和图像等多种类型共享给其他应用程序？我发现的只是与 Windows 8 的内置邮件应用程序共享文本或仅图像。

想发邮件的主题、文字和附件都是预设好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T18:35:53.150

根据我的经验，当前版本的 Mail（发布预览版）根本无法做到这一点。如果您有附件，它会忽略主题和文本。看起来我们将不得不等待 RTM 或使用另一个电子邮件客户端进行测试。

**更新：** AFAIK，即使在 RTM 之后仍然如此。邮件客户端根本无法同时处理邮件正文和附件。

# delphi - 阻止 TWebBrowser 接受丢弃的文件

> ID：11452852
> 
> 赞同：2
> 
> 时间：2012-07-12T13:26:47.437
> 
> 标签：delphi, file, droppable, twebbrowser

我有一个接受拖放文件的表单，以及放置在同一表单上的 TPanel 控件上的 TWebBrowser 控件。

主要的是，当我在表单上放置一个文件时，它的路径被添加到 TEdit 控件中。但是，当用户将文件拖放到表单上时，有时他们实际上可能会将其拖放到 TWebBrowser 上，根据文件类型，它可以为用户保存或运行文件。这是我实际上不想发生的事情，我只想让 TWebBrowser 忽略删除的文件或像表单一样处理它。

这是我用来处理 WM_DROPFILES 消息的代码：

```
procedure TMainForm.AcceptFiles( var msg : TMessage );
const
  cnMaxFileNameLen = 255;
var
  i,
  nCount     : integer;
  acFileName : array [0..cnMaxFileNameLen] of char;
begin
  // find out how many files we're accepting
  nCount := DragQueryFile( msg.WParam,
                           $FFFFFFFF,
                           acFileName,
                           cnMaxFileNameLen );

  // query Windows one at a time for the file name
  for i := 0 to nCount-1 do
  begin
    DragQueryFile( msg.WParam, i,
                   acFileName, cnMaxFileNameLen );

    // do your thing with the acFileName
    //MessageBox( Handle, acFileName, '', MB_OK );
    Edit1.Text := acFileName;
  end;

  // let Windows know that you're done
  DragFinish( msg.WParam );
end; 
```

先感谢您。任何线索将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T15:44:29.513

要拦截 TWebBrowser 中的拖放操作，您必须实现[`IDropTarget`](http://msdn.microsoft.com/en-us/library/ms679679%28v=vs.85%29.aspx)和[`IDocHostUIHandler`](http://msdn.microsoft.com/en-us/library/aa753260%28v=vs.85%29.aspx)接口。那么您必须使用该[`GetDropTarget`](http://msdn.microsoft.com/en-us/library/aa753255%28v=vs.85%29.aspx)方法来传递您自己的 IDropTarget 实现。

对于示例 delphi 代码，请尝试这篇文章[`How to handle drag and drop in a TWebBrowser control`](http://www.delphidabbler.com/articles?article=25&part=1)

# entity-framework - Entity Framework DeleteObject 查询很多项

> ID：11452853
> 
> 赞同：2
> 
> 时间：2012-07-12T13:26:49.883
> 
> 标签：entity-framework, linq-to-entities

我在尝试使用 Entity Framework 删除对象时遇到问题，我之前查询上下文以获取我需要删除的对象列表，然后一一调用 deleteobject

```
IQueryable result = context.CustomObjects.Where(t=>t.Property = something)

foreach (CustomObject customObj in result)
{
      context.DeleteObject(customObj);
} 
```

当我调用 DeleteObject 时，EF 执行一个奇怪的查询，如下所示：

```
exec sp_executesql N'SELECT 
[Extent1].[Value1] AS [Value1], 
[Extent1].[Value2] AS [Value2], 
[Extent1].[Value3] AS [Value3], 
FROM [CustomObject] AS [Extent1]
WHERE [Extent1].[ID] = @EntityKeyValue1',N'@EntityKeyValue1 int',@EntityKeyValue1=59 
```

此查询似乎搜索 ID = something 的所有对象，但 ID 它只是实体键的一部分，确实由 3 个字段组成，因此它像 n 千个项目一样附加并且使过程非常缓慢，这是我的一种行为无法理解，我总是这样删除对象，我从来没有遇到过这样的问题

有人可以有一个想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T14:59:33.390

您可能正在获取由 where 查询定义的多个对象。此外，对于您获取的每个对象，您将获取对象 CustomObject 上的所有字段。

正在执行的查询是一个选择查询，因此这证实了上述行为。

如果您想要更好的性能，那么我建议您执行以下操作：

```
var entityToDelete = new SomeEntity();
SomeEntity.PK = 12;
var context = new YourContextntities();
context.YourEntitites.Attach(entityToDelete);
context.YourEntitites.Remove(entityToDelete);
context.SaveChanges(); 
```

# android - Bundle中的Android HashMap？

> ID：11452859
> 
> 赞同：97
> 
> 时间：2012-07-12T13:27:01.680
> 
> 标签：android, dictionary, bundle

使用它`android.os.Message`的`Bundle`sendMessage 方法发送。因此，是否可以将 a`HashMap`放入 a 中`Bundle`？

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2012-07-12T13:35:43.013

尝试：

```
Bundle extras = new Bundle();
extras.putSerializable("HashMap",hashMap);
intent.putExtras(extras); 
```

在第二个活动中

```
Bundle bundle = this.getIntent().getExtras();

if(bundle != null) {
   hashMap = bundle.getSerializable("HashMap");
} 
```

因为[Hashmap](http://developer.android.com/reference/java/util/HashMap.html) 默认实现`Serializable`，所以你可以使用`putSerializable`Bundle 传递它并使用其他活动`getSerializable`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-12T13:29:37.507

根据[doc](http://developer.android.com/reference/java/util/HashMap.html)，`Hashmap`implements `Serializable`，所以你可以`putSerializable`猜到。你试过了吗？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-08-23T06:06:48.667

请注意：如果您使用的是 AppCompatActivity，则必须调用 `protected void onSaveInstanceState(Bundle outState) {}`( **NOT** `public void onSaveInstanceState(Bundle outState, PersistableBundle outPersistentState) {}` ) 方法。

示例代码...

存储地图：

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putSerializable("leftMaxima", leftMaxima);
    outState.putSerializable("rightMaxima", rightMaxima);
} 
```

并在 onCreate 中接收它：

```
if (savedInstanceState != null) {
    leftMaxima = (HashMap<Long, Float>) savedInstanceState.getSerializable("leftMaxima");
    rightMaxima = (HashMap<Long, Float>) savedInstanceState.getSerializable("rightMaxima");
} 
```

对不起，如果它是某种重复的答案 - 也许有人会发现它很有用。:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-10-24T18:57:05.780

如果要发送捆绑包中的所有密钥，可以尝试

```
for(String key: map.keySet()){
    bundle.putStringExtra(key, map.get(key));
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-24T07:17:14.877

```
 public static Bundle mapToBundle(Map<String, Object> data) throws Exception {
    Bundle bundle = new Bundle();
    for (Map.Entry<String, Object> entry : data.entrySet()) {
        if (entry.getValue() instanceof String)
            bundle.putString(entry.getKey(), (String) entry.getValue());
        else if (entry.getValue() instanceof Double) {
            bundle.putDouble(entry.getKey(), ((Double) entry.getValue()));
        } else if (entry.getValue() instanceof Integer) {
            bundle.putInt(entry.getKey(), (Integer) entry.getValue());
        } else if (entry.getValue() instanceof Float) {
            bundle.putFloat(entry.getKey(), ((Float) entry.getValue()));
        }
    }
    return bundle;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-02T23:39:57.070

我正在使用我的 Parcelable 的 kotlin 实现来实现这一点，到目前为止它对我有用。如果您想避免繁重的可序列化，这很有用。

另外为了让它工作，我建议将它与[这些一起使用](https://stackoverflow.com/a/49078895/6241054)

宣言

```
class ParcelableMap<K,V>(val map: MutableMap<K,V>) : Parcelable {
    constructor(parcel: Parcel) : this(parcel.readMap(LinkedHashMap<K,V>()))

    override fun writeToParcel(parcel: Parcel, flags: Int) {
        parcel.writeMap(map)
    }

    override fun describeContents(): Int {
        return 0
    }

    companion object CREATOR : Parcelable.Creator<ParcelableMap<Any?,Any?>> {
        @JvmStatic
        override fun createFromParcel(parcel: Parcel): ParcelableMap<Any?,Any?> {
            return ParcelableMap(parcel)
        }
        @JvmStatic 
        override fun newArray(size: Int): Array<ParcelableMap<Any?,Any?>?> {
            return arrayOfNulls(size)
        }
    }

} 
```

采用

写

```
val map = LinkedHashMap<Int, String>()
val wrap = ParcelableMap<Int,String>(map)
Bundle().putParcelable("your_key", wrap) 
```

读

```
val bundle = fragment.arguments ?: Bundle()
val wrap = bundle.getParcelable<ParcelableMap<Int,String>>("your_key")
val map = wrap.map 
```

不要忘记，如果您的地图`K,V`默认未打包，则它们必须实现`Parcelable`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-17T16:01:19.337

在科特林：

```
hashMap = savedInstanceState?.getSerializable(ARG_HASH_MAP) as? HashMap<Int, ValueClass>

putSerializable(ARG_HASH_MAP, hashMap) 
```

# javascript - 如果跨度存在，则将类添加到链接

> ID：11452861
> 
> 赞同：0
> 
> 时间：2012-07-12T13:27:07.147
> 
> 标签：javascript, jquery

我有一个通过 AJAX 检索的链接列表。我解析链接并将它们附加到一个div。然而，有时我需要考虑在“a”之后有一个“跨度”。

代码如下所示：

```
<ul>
   <li><a href="/link1" class="list-link">Link1 </a></li>
   <li><a href="/link1" class="list-link">Link1 </a><span class="sometimes-here"></span></li>
   <li><a href="/link1" class="list-link">Link1 </a></li>
   ...
</ul> 
```

所以我想要做的是定位“li”何时由一个跨度组成，然后将该类（“有时在这里”）作为附加类应用到“a”。

我应该详细说明我需要什么，因为您只回答了如何过滤掉所有不包含跨度的“li”。我希望最终结果看起来像这样。

```
<a href="/link1" class="list-link">Link1 </a>
<a href="/link1" class="list-link sometimes-here">Link1 </a>
<a href="/link1" class="list-link">Link1 </a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:29:21.670

尝试这个

```
$('li:has(span)').find('a').addClass('yourClass'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:30:20.037

```
$('li:has(span) a').addClass('yourClass'); 
```

# android - 在 Android 上显示实时 UDP 或 RTP 流（多播）

> ID：11452865
> 
> 赞同：4
> 
> 时间：2012-07-12T13:27:12.807
> 
> 标签：android, udp, video-streaming, rtp

几周以来我是 Android 开发的新手，我需要编写一个可以向用户显示以 UDP 或 RDP 多播的实时流的应用程序。该流位于诸如“rtp://230.0.0.11:1234”之类的地址，并且由于此模块由WIFI发出： [http ://www.ikusi.es/public/ctrl_public_prod.php?accion=verProducto&id_familia =34&id_gama=186&id_producto=351](http://www.ikusi.es/public/ctrl_public_prod.php?accion=verProducto&id_familia=34&id_gama=186&id_producto=351)

我已经尝试从播放器（Daroon 播放器，来自 PlayStore）中读取它，并且效果很好，所以我认为我的愚蠢问题不是由于广播。

我看到可以通过不同的方式向用户显示视频内容：

*   使用带有 ACTION_VIEW 的新 Intent，Android 选择一个可以查看内容的应用；

*   使用 MediaPlayer 类和 VideoView。

我有两个问题，让我们从最重要的开始： - 对于上述两种解决方案，都有一个问题：我到处都读到 MediaPlayer 只支持 http/s 和 rtsp 协议，对吗？对于动作视图，这是我之前尝试过的：

```
 Uri streamURL = Uri.parse("rtp://230.0.0.11:1234");
    Intent streamIntent = new Intent(Intent.ACTION_VIEW);
    streamIntent.setData(streamURL);
//  streamIntent.setDataAndType(streamURL,"video/*");   
    startActivity(streamIntent); 
```

这是 LogCat ：

```
07-11 00:25:58.119: D/AndroidRuntime(2659): Shutting down VM
07-11 00:25:58.119: W/dalvikvm(2659): threadid=1: thread exiting with uncaught exception (group=0x40015560)
07-11 00:25:58.129: E/AndroidRuntime(2659): FATAL EXCEPTION: main
07-11 00:25:58.129: E/AndroidRuntime(2659): java.lang.IllegalStateException: Could not execute method of the activity
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.view.View$1.onClick(View.java:2144)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.view.View.performClick(View.java:2485)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.view.View$PerformClick.run(View.java:9080)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.os.Handler.handleCallback(Handler.java:587)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.os.Handler.dispatchMessage(Handler.java:92)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.os.Looper.loop(Looper.java:123)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.app.ActivityThread.main(ActivityThread.java:3683)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at java.lang.reflect.Method.invokeNative(Native Method)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at java.lang.reflect.Method.invoke(Method.java:507)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at dalvik.system.NativeStart.main(Native Method)
07-11 00:25:58.129: E/AndroidRuntime(2659): Caused by: java.lang.reflect.InvocationTargetException
07-11 00:25:58.129: E/AndroidRuntime(2659):     at java.lang.reflect.Method.invokeNative(Native Method)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at java.lang.reflect.Method.invoke(Method.java:507)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.view.View$1.onClick(View.java:2139)
07-11 00:25:58.129: E/AndroidRuntime(2659):     ... 11 more
07-11 00:25:58.129: E/AndroidRuntime(2659): Caused by: android.content.ActivityNotFoundException: No Activity found to handle Intent { act=android.intent.action.VIEW dat=rtp://230.0.0.11:1234 }
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1409)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1379)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.app.Activity.startActivityForResult(Activity.java:2827)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at android.app.Activity.startActivity(Activity.java:2933)
07-11 00:25:58.129: E/AndroidRuntime(2659):     at fr.infosat.tvreplay.MainActivity.listStream(MainActivity.java:35)
07-11 00:25:58.129: E/AndroidRuntime(2659):     ... 14 more
07-11 00:26:00.079: I/Process(2659): Sending signal. PID: 2659 SIG: 9 
```

我的理解是错误InvocationTargetException，通常是由于类名错误，这里不能直接解决，因为我在startActivity中没有调用任何类。但是我认为我的语法不正确，也许该方法不适合使用。当然，如果我取消注释 setDataAndType 行，它会显示相同的错误。

当我启动我的隐式意图时，我注意到错误出现了。

*   我的第二个问题是 Daroon Player 在我的机顶盒上运行良好，我可以在电视上看到我的流。但是当我尝试从 Eclipse 模拟器启动它时，它无法播放，即使我可以从 VLC 播放它......模拟器是否强大到足以读取这些流？

我希望你对如何解决这个问题有一些线索！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:49:06.920

首先，您会遇到异常，因为您的设备上没有安装可以处理此类`rtp://`url 的应用程序。

您可能想在开始之前检查意图：[queryIntentActivities(..)](http://developer.android.com/reference/android/content/pm/PackageManager.html#queryIntentActivities%28android.content.Intent,%20int%29)

其次，我认为模拟器与任何可用的真实设备相比都非常慢，您可能不想使用模拟器来测试 A/V 流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-23T10:54:33.780

VLC Android SDK 在 UDP/RTP 中非常完美

[https://code.videolan.org/videolan/vlc-android](https://code.videolan.org/videolan/vlc-android)

```
libvlc 
```

# ruby-on-rails - 奇怪的路线故障，在设计和自己的控制器之间混合

> ID：11452866
> 
> 赞同：1
> 
> 时间：2012-07-12T13:27:15.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, routes, link-to

我有一个真正奇怪的路线行为。我发现了我认为导致错误的行。
这是有问题的行（在 application.html.erb 中）：

```
<%= link_to "Official Top", :controller => "tops", :action => "show", :id => 10 %> 
```

当我想使用设计登录时，当我转到此链接时，就会出现问题：

```
http://localhost:3000/users/sign_in 
using <%= link_to "sign in", new_user_session_path %> 
```

没有这条线，一切都很好，但是当这条线出现时，我遇到了这个错误：

```
No route matches {:controller=>"devise/tops", :action=>"show", :id=>10} 
```

与这条线有什么联系 oO 为什么它混合设计和顶部？这条线路怎么会麻烦设计路线？真的很奇怪......除了我所有的路线看起来都很好

```
new_user_session GET   /users/sign_in(.:format)   devise/sessions#new
top GET                /tops/:id(.:format)        tops#show 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:30:55.213

请试试：

```
<%= link_to "Official Top", :controller => "/tops", :action => "show", :id => 10 %> 
```

我认为添加“/”将解决您的问题，因为它现在正在设计目录中搜索 Tops 控制器......使用“/”，它将在“主控制器”目录中搜索

# maven - flexmojos忽略配置？

> ID：11452868
> 
> 赞同：0
> 
> 时间：2012-07-12T13:27:16.537
> 
> 标签：maven, swc, flexmojos

我正在尝试从 Flex 库构建 SWC 文件，无论我做什么，flexmojos (3.6.1) 似乎在 bin/classes 文件夹中构建了一个“config.xml”文件，该文件为空，并使用它对于配置，完全忽略了我放入 plugin > configuration 元素中的所有内容。我已经尝试过通过 m2e 和 Jenkins 运行命令行，每次都遇到同样的问题。我被卡住了，我不知道我做错了什么。

这是我的 POM 的构建部分。

```
<sourceDirectory>${basedir}/src</sourceDirectory>
<directory>${basedir}/bin</directory>
<plugins>
    <plugin>
        <groupId>org.sonatype.flexmojos</groupId>
        <artifactId>flexmojos-maven-plugin</artifactId>
        <version>3.6.1</version>
        <extensions>true</extensions>
        <dependencies>
            <dependency>
                <groupId>com.adobe.flex</groupId>
                <artifactId>compiler</artifactId>
                <version>${flex.version}</version>
                <type>pom</type>
            </dependency>
        </dependencies>
        <configuration>
            <computeDigest>false</computeDigest>
            <allowSourcePathOverlap>true</allowSourcePathOverlap>
            <debug>false</debug>
            <warnings>
                <no-constructor>false</no-constructor>
            </warnings>
        </configuration>
    </plugin>
</plugins> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T18:49:46.110

Turns out I was running an older compile-swc target. When I flipped over to the new target I was fine. the m2e Eclipse plugin did not provide me the choice to select the latest target in their build configuration settings.

# vb.net - 简单 CRUD 应用程序的面向对象设计/架构

> ID：11452872
> 
> 赞同：0
> 
> 时间：2012-07-12T13:27:41.500
> 
> 标签：vb.net, class, architecture, encapsulation

我已经用 VB6 编程了几年，现在我开始使用 VB.Net。我开发了几个解决方案，但这些解决方案不符合通用设计标准。我是金融业务中唯一的开发人员。我的解决方案有效，但我没有人可以向任何人学习正确的架构。

我正在开发一个新的应用程序，我希望它能够正确完成。但是，我不知道什么应该是类/对象等。我认为我使用了太多全局变量并且没有封装任何东西。

该申请用于提交费用。用户（用户应该是一个班级？）可以输入带有行项目的费用。我正在使用 datagridview 来显示/添加行项目。还将有一个历史选项卡显示用户的所有费用，以及一个审核选项卡，以便费用审核者可以批准行项目。

数据在 SQL Server 中的几张表中，一张用于费用表头，一张用于费用行，一张用于用户信息。批准的费用被插入到同一 SQL Server 数据库上的第三方应用程序中进行支付。

你会用什么方法来设计这样一个简单的应用程序？谢谢你能给我的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:10:03.627

你需要做更多的学习。然而，我发现对快速开发对象模型而不用过多担心数据库方面很有用的一件事是实体框架。将实体模型添加到您的项目并阅读它。

# ruby-on-rails-3 - 如何扩展渲染器以将模板的路径添加到模板渲染的 html 中

> ID：11452874
> 
> 赞同：0
> 
> 时间：2012-07-12T13:27:43.327
> 
> 标签：ruby-on-rails-3

我正在处理的这个项目上有很多 .erb 文件，为了便于从浏览器中进行调试，我希望每个模板文件的路径都像这样隐藏在源代码中（仅用于开发），`<!-- BEGIN /path/to/file -->`并且`<!-- END /path/to/file -->`

您如何进行更改`render`，以便它在每个渲染之前添加它正在使用的模板的路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:39:56.040

看看我为此使用的要点：

[https://gist.github.com/1386152](https://gist.github.com/1386152)

对于导轨 2

[https://gist.github.com/905286](https://gist.github.com/905286)

# php - Codeigniter 未显示 404 错误页面

> ID：11452877
> 
> 赞同：0
> 
> 时间：2012-07-12T13:27:51.157
> 
> 标签：php, codeigniter, http-status-code-404

我正在使用 codeigniter 开发一个新网站，这是我的第一次 codeigniter 体验。我怀疑 404 错误无法正常工作，当我尝试加载不存在的控制器或现有控制器的错误功能时，我得到了标准的 webserver 404 错误，而不是 codeigniter 错误。

我没有触摸路由配置文件中的“404_override”选项。正常吗？我希望（但也许我错了）在这些情况下会调用 show_404() 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:30:41.917

您的 .htaccess 文件是否设置正确？

```
RewriteEngine on
RewriteCond $1 !^(index\.php|images|robots\.txt)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

您必须设置一个 .htaccess 文件才能使自定义错误页面正常工作。查看官方[文档](http://codeigniter.com/user_guide/general/urls.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:32:44.313

Codeigniter 应该显示它的 404 页面，除非您没有从 URI 中删除 index.php。在这种情况下，您可以尝试在不接触 CodeIgniter 的情况下打开另一个文件。看看[这里](http://codeigniter.com/user_guide/general/urls.html)看看如何删除 index.php 使用`.htaccess`.

**更新：**

ISS 似乎有一个解决方案：ISAPI_Rewrite Lite（商业产品的免费、精简版）。我在[这里找到了](http://codeigniter.com/forums/viewthread/95238/#481913)

# google-apps-script - 谷歌表单结果 - 添加序列号

> ID：11452880
> 
> 赞同：0
> 
> 时间：2012-07-12T13:27:56.327
> 
> 标签：google-apps-script, numbers, response, google-forms

Google 表单结果：
提交表单响应时，会在结果电子表格中自动添加日期/时间戳。向每个响应添加序列号（唯一 ID 值）以便我可以在 Apps 脚本中引用给定响应的最佳方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:07:48.473

[您可以使用 Apps 脚本在表单提交](https://developers.google.com/apps-script/understanding_events)时创建触发器，并在最后一列中添加唯一 ID。

# c# - 隐式运算符和类层次结构

> ID：11452881
> 
> 赞同：3
> 
> 时间：2012-07-12T13:28:03.250
> 
> 标签：c#

我有以下类层次结构。

```
public abstract class ResourceBase { }

public abstract class WebResourceBase : ResourceBase  {
  public ResourceBase LocalPath { get; set; }
  public ResourceBase FtpPath { get; set; }
}

public class JavaScript : WebResourceBase { } 
```

我想做的是有这样的声明。

```
new JavaScript() {
  LocalPath = "/path/goes/here/1.js",
  FtpPath = "ftp://path/goes/here/1.js"
} 
```

这里明显的答案是使用隐式运算符，但问题是我想为那些与声明的类型相同的属性分配派生类型，`LocalPath`并且`FtpPath`将是 type `JavaScript`。

我希望我的解决方案比目前的解决方案更灵活。这段代码只是让我的皮肤爬行。希望有一种使用反射的方法，我尝试使用`StackTrace`该类查找信息，但没有运气。任何帮助，将不胜感激。谢谢。

```
public abstract class ResourceBase { 
  public static implicit operator ResourceBase(string path) {
            if (path.EndsWith(".js"))
                return new JavaScript(path);
            // etc...
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:32:51.207

[这假设这`WebResourceBase`实际上是为了继承`ResourceBase`.]

不幸的是，您将无法使隐式运算符看起来更好 - 泛型在这里不起作用。

* * *

**替代方案：限制 ResourceBase 的泛型**

现在我已经重新阅读并理解了您的目标，一个选择是修改您的类以包含引用派生类的通用参数（有点像自引用）：

```
public abstract class ResourceBase 
{ }

public abstract class WebResourceBase<T> : ResourceBase
    where T : WebResourceBase<T>
{
    public T LocalPath { get; set; }
    public T FtpPath { get; set; }
}

public class JavaScript : WebResourceBase<JavaScript> 
{ 
} 
```

然后你会在 中看到，`JavaScript`属性`LocalPath`和`FtpPath`现在也是类型`JavaScript`。

现在您的作业将*只*接受`JavaScript`类型：

```
new JavaScript() 
{
    LocalPath = new JavaScript("/path/goes/here/1.js"),
    FtpPath = new JavaScript("ftp://path/goes/here/1.js")
} 
```

这种方法的好处是它将基础属性限制为当前类型或更多派生，而不是更少派生。

* * *

**替代方案：显式解析而不是`implicit`运算符**

如果您需要将`LocalPath`and`FtpPath`变量保留为`ResourceBase`，或者无法在此处使用泛型，您的隐式运算符将开始变得混乱。最好提供一些明确的东西，比如静态方法：

```
new JavaScript() 
{
    LocalPath = JavaScript.Parse("/path/goes/here/1.js"),
    FtpPath = JavaScript.Parse("ftp://path/goes/here/1.js")
}

class JavaScript
{
    public static ResourceBase Parse(string s)
    {
        if (path.EndsWith(".js"))
            return new JavaScript(path);

        throw new Exception();
    }
} 
```

* * *

**替代方案：类层次结构解析而不是`implicit`运算符**

通过构造函数将使用字符串的概念烘焙到类型中，并使属性 public 为只读：

```
public abstract class ResourceBase
{ }

public abstract class WebResourceBase
{
    public ResourceBase LocalPath { get; private set; }
    public ResourceBase FtpPath { get; private set; }

    protected abstract ResourceBase ParseLocalPath(string s);
    protected abstract ResourceBase ParseFtpPath(string s);
}

public class JavaScript : WebResourceBase<JavaScript> 
{ 
    protected override ResourceBase ParseLocalPath(string s)
    {
        // etc.
    } 
    protected override ResourceBase ParseFtpPath(string s)
    {
        // etc.
    } 
} 
```

* * *

老实说，只是为了从字符串中将两个属性设置为特定类型，这似乎有点矫枉过正，你有很多选择——即使是隐式运算符也可以工作。

选择一个最容易理解的。除非你去挖掘它，否则运算符重载往往会被隐藏起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T14:13:44.747

[我也认为`WebResourceBase`应该继承自`ResourceBase`]

`protected`在派生类可以订阅的基类上具有映射机制：

```
public abstract class ResourceBase
{
    // Records how to make a ResourceBase from a string, 
    // on a per-extension basis
    private static Dictionary<string, Func<string, ResourceBase>> constructorMap
        = new Dictionary<string, Func<string, ResourceBase>>();

    // Allows a derived type to subscribe itself
    protected static void Subscribe(
        string extension, 
        Func<string, ResourceBase> ctor)
    {
        if (constructorMap.ContainsKey(extension))
            throw new Exception("nuh uh");

        constructorMap.Add(extension, ctor);
    }

    // Given a string, finds out who has signed up to deal with it,
    // and has them deal with it
    public static implicit operator ResourceBase(string s)
    {
        // Find a matching extension
        var matches = constructorMap.Where(kvp => s.EndsWith(kvp.Key)).ToList();

        switch (matches.Count)
        {
            case 0:
                throw new Exception(
                  string.Format("Don't know how to make {0} into a ResourceBase",
                                s));
            case 1:
                return matches.Single().Value(s);
            default:
                throw new Exception(string.Format(
                  "More than one possibility for making {0} into a ResourceBase",
                  s));
        }
    }
} 
```

中间类型基本上没有变化，但是通过一些类型检查，我无法确定如何在编译时强制执行：

```
public abstract class WebResourceBase : ResourceBase
{
    private ResourceBase localPath;
    public ResourceBase LocalPath
    {
        get { return localPath; }
        set
        {
            if (value.GetType() != GetType())
            {
                throw new Exception("Naughty");
            }
            localPath = value;
        }
    }        

    private ResourceBase ftpPath;
    public ResourceBase FtpPath
    {
        get { return ftpPath; }
        set
        {
            if (value.GetType() != GetType())
            {
                throw new Exception("Naughty");
            }
            ftpPath = value;
        }
    }
} 
```

具体类型如下所示：

```
public class JavaScript : WebResourceBase
{
    public JavaScript()
    {

    }
    private JavaScript(string s)
    {
    }

    static JavaScript()
    {
        Subscribe("js", s => (ResourceBase)new JavaScript(s));
    }
} 
```

用法如您指定：

```
 var js = new JavaScript
        {
            LocalPath = "hello.js",
            FtpPath = "hello.js"
        }; 
```

请注意，尽管在and`ResourceBase`的签名中，在上述语句之后and**都是**对象。`constructorMap``Subscribe``LocalPath``FtpPath` **`JavaScript`**

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:45:30.840

我只想在流程中添加一个额外的间接层（令人惊讶的是，这是一个很好的设计问题的答案；））。

我要么添加一个带有两个字符串参数的新构造函数，要么添加两个额外的字符串属性，或者两者兼而有之。（我假设您只是从这里添加两个新的字符串属性；您可以从那里推断。）

如果添加一个新属性：`JavaScriptLocalPath`它可以在它的 set 方法中将字符串转换为`ResourceBase`特定于的派生类型，`JavaScript`并使用该结果设置`LocationPath`属性。我认为它的 get 方法也可以从其中提取该字符串`ResourceBase`（这样您也不必费心存储该字符串`string`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T13:50:48.560

这是我的想法：

```
public abstract class WebResourceBase {
  public ResourceBase LocalPath { get; set; }
  public ResourceBase FtpPath { get; set; }

  protected abstract ResourceBase ConvertFromString(string path);
  public string LocalPathStr { set { LocalPath = ConvertFromString(value); } }
  public string FtpPathStr { set { FtpPath = ConvertFromString(value); } }
} 
```

应该可以改进。**

# mysql - MySQL 简化这个查询？

> ID：11452884
> 
> 赞同：2
> 
> 时间：2012-07-12T13:28:11.127
> 
> 标签：mysql, database, reporting, google-visualization, simplify

我已经编写 MySQL 查询很长时间了，但是当涉及到这个问题时，我完全觉得自己像个新手，我似乎无法弄清楚如何简化这个查询。基本上**我只是想**从我们的数据库中生成一个以逗号分隔的收入列表，最终插入谷歌图表。我也必须为“过去的 31 天”做一个，所以我有点搞砸了，除非我想出了如何简化它。

我表中的数据库列是...

> *   time：订单进来的时间 int() （UNIX时间戳格式）
> *   价格：十进制的订单是多少（10,2）

```
SELECT
 CONCAT(
 (SELECT SUM(price) FROM orders WHERE time < (UNIX_TIMESTAMP() - (6 * 86400)) AND time > (UNIX_TIMESTAMP() - (7 * 86400))),
 ',',
 (SELECT SUM(price) FROM orders WHERE time < (UNIX_TIMESTAMP() - (5 * 86400)) AND time > (UNIX_TIMESTAMP() - (6 * 86400))),
 ',',
 (SELECT SUM(price) FROM orders WHERE time < (UNIX_TIMESTAMP() - (4 * 86400)) AND time > (UNIX_TIMESTAMP() - (5 * 86400))),
 ',',
 (SELECT SUM(price) FROM orders WHERE time < (UNIX_TIMESTAMP() - (3 * 86400)) AND time > (UNIX_TIMESTAMP() - (4 * 86400))),
 ',',
 (SELECT SUM(price) FROM orders WHERE time < (UNIX_TIMESTAMP() - (2 * 86400)) AND time > (UNIX_TIMESTAMP() - (3 * 86400))),
 ',',
 (SELECT SUM(price) FROM orders WHERE time < (UNIX_TIMESTAMP() - 86400) AND time > (UNIX_TIMESTAMP() - (2* 86400)) ),
 ',',
 (SELECT SUM(price) FROM orders WHERE time > (UNIX_TIMESTAMP() - 86400))
 ) as chart_rev 
FROM orders_basic
LIMIT 0,1 
```

如果可能的话，我需要像这样以 24 小时为增量。

与往常一样，非常感谢任何帮助。谢谢！

**解决方案**

*请注意：仔细查看您的结果，它们可能存在，只是顺序错误，如果是，请反转您的排序。*

```
SELECT GROUP_CONCAT(total_sum) AS sum_list FROM
(
    SELECT
        FLOOR((UNIX_TIMESTAMP() - time) / 86400) AS date,
        SUM(price) AS total_sum
    FROM
        orders_basic
    WHERE
        is_testorder < 1
          AND FROM_UNIXTIME(time) > DATE_SUB(NOW(), INTERVAL 1 WEEK)
    GROUP BY
        date
) AS s 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:44:15.250

可能是这样的？

```
SELECT GROUP_CONCAT(total_sum) AS sum_list FROM
(
    SELECT
        DATE(FROM_UNIXTIME(time)) AS date,
        SUM(price) AS total_sum
    FROM
        orders
    WHERE
        FROM_UNIXTIME(time) > DATE_SUB(NOW(), INTERVAL 1 MONTH)
    GROUP BY
        date
) AS s 
```

这应该为您提供上个月销售总额的逗号分隔列表。但它会按日期分组，而不是 24 小时增量（根据该`time`列，截止日期将是午夜）。

# python - Python读取大文件并在之后拆分：

> ID：11452887
> 
> 赞同：1
> 
> 时间：2012-07-12T13:28:16.550
> 
> 标签：python, split

基于此文件中一行的示例

```
1:alpha:beta 
```

我正在尝试让 python 读取文件，然后逐行打印第二个之后的内容`':'`

```
import fileinput
#input file

x = fileinput.input('ids.txt')
strip_char = ":"

for line in x:
    strip_char.join(line.split(strip_char)[2:]) 
```

这不会产生任何结果，但是从单行的控制台会话中它可以正常工作

```
Python 2.7.3rc2 (default, Apr 22 2012, 22:35:38) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
data = '1:alpha:beta'
strip_char = ":"
strip_char.join(data.split(strip_char)[2:])
'beta' 
```

请问我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:34:33.550

如果它是第二个 ':' 之后的所有内容作为字符串（可以包括 ':'），则使用 maxsplit 选项，例如：

```
line.split(':', 2)[2] 
```

例如：

```
>>> d = '1:alpha:beta:charlie:delta'
>>> d.split(':', 2)
['1', 'alpha', 'beta:charlie:delta'] 
```

**这样可以节省之后的加入**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:32:51.157

对于给定的数据格式，这将起作用：

```
 with open('data.txt') as inf:
    for line in inf:
        line = line.strip()
        line = line.split(':')
        print ':'.join(line[2:]) 
```

对于`'1:alpha:beta'`输出将是`'beta'`

对于`'1:alpha:beta:gamma'`输出将是`'beta:gamma'` （感谢@JAB 指出这一点）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:31:12.767

函数返回的值不会在非交互模式下自动发送到标准输出，您必须显式打印它们。

因此，对于 Python 2，使用`print line.split(strip_char, 2)[2]`. 如果你曾经使用过 Python 3，它将是`print(line.split(strip_char, 2)[2])`.

（乔恩克莱门茨的道具，我忘了你可以限制一个字符串被分割的次数。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T13:41:23.780

你得到的只是'beta'，因为 join 给你一个字符串：

```
data = '1:alpha:beta'
strip_char = ":"
strip_char.join(data.split(strip_char)[2:])
'beta' 
```

尝试这个：

```
lines=[]
with open('filePath', 'r') as f:
    for line in f.readlines():
        lines.append(line.strip())

for line in lines: print line.split(':')[1:] 
```

# asp.net-mvc - Telerik Grid MVC 并选中所有页面上的所有复选框

> ID：11452888
> 
> 赞同：3
> 
> 时间：2012-07-12T13:28:18.257
> 
> 标签：asp.net-mvc, checkbox, telerik, grid

在 Telerik 演示站点上，我们可以看到如何实现某种功能的示例： [“选中网格列中的所有复选框”](http://demos.telerik.com/aspnet-mvc/razor/grid/headerfootertemplates?theme=vista&Grid-page=1)。但就我而言，它有两个缺点：

1.  它没有选中所有页面上的所有复选框。
2.  它没有在不同的页面上保存复选框的状态。

有人知道如何解决这些问题吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T17:07:55.673

在网格中使用分页的主要原因之一是您不必从数据存储中检索所有数据并生成大量 HTML 来推送到客户端。

根据我的经验，大多数用户都知道“全选”复选框仅检查当前页面上的项目。我还没有看到一个网站，选中这样的复选框实际上会检查所有记录，即使是那些我看不到的记录。

如果您的操作会影响超过当前记录页面，我建议您添加一个按钮，清楚地指示该操作将影响**所有**记录，然后向您的数据层发送一个命令，该命令将执行该操作。这将表现得更好（您不必通过网络发送可能很长的 id 列表）并允许用户了解他们的行为的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T16:49:37.027

只要我知道没有内置功能可以这样做。当您在第一页选择记录并更改到第二页时，也会发生同样的问题，您会丢失之前选择的任何内容。

要实现该功能，您有 2 个选项（我在以前的项目中都使用过）

1）在每次检查时，对您的一个控制器进行 Ajax 调用，并将您选择的任何内容存储在会话变量中（如果您有很多记录，这可能效率低下） 2）创建一个 javascript 变量并将您的选择存储在那里，然后发送使用 json 变量或逗号分隔值字符串返回控制器

正如我所说，我已经使用了这两种方法，所以这取决于这是否适合你

希望能帮助到你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T16:31:12.183

我无法对此进行测试，所以我不是 100% 确定，但是看看 Telerik 的示例，它没有持久化的一个原因是因为网格的每个“页面”都需要回发，并且在控制器操作结果方法中，它们是'没有为绑定到网格的项目传递模型（或视图模型），它们只是将该项目列表返回到视图，因此它永远不会“保存”哪些项目被检查/选择以及哪些那些不是。您应该能够通过将视图模型作为 HttpPost 操作结果方法的参数，然后在发布后将该列表传递回视图，以便它保留选择的项目而不是创建新项目来解决此问题。这不会解决不选择所有项目的问题，但它至少应该保留在整个页面中选择的那些。我认为它不适用于所有项目的原因是它只能选择当时实际显示的项目。您可能想要发布（或 ajax）来选择“所有”项目。

# dynamics-ax-2009 - 显示方法 - 多表单数据源

> ID：11452892
> 
> 赞同：4
> 
> 时间：2012-07-12T13:28:37.007
> 
> 标签：dynamics-ax-2009, x++, axapta

这似乎是一个简单的问题，但出于某种原因，我很烦恼。

我有一个包含 3 个数据源的表单 - `InventTable`, `InventSum`, `InventDim`.

因此，例如，我的网格显示；

*项目、名称、站点、仓库、实物库存*

我在`InventDim`表单 DataSource 上放置了一个显示方法，但我需要访问`ItemId`from`inventTrans`或`InventSum`. （显然是在寻找“当前”的 itemId）。

我只能访问作为标准`inventDim`传递的参数`_inventDim`。

访问“当前” itemId 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-12T14:40:14.080

好的，我找到了答案，非常感谢 Joris de Gruyter 的引用；

[http://daxmusings.blogspot.co.uk/2011/10/forum-advanced-display-method-querying.html](http://daxmusings.blogspot.co.uk/2011/10/forum-advanced-display-method-querying.html)

关键是将显示方法放在`InventSum`数据源上。

然后您可以使用`_inventSum.joinChild()`来检索链接的`inventDim`，这是 Joris 的示例；

```
display Qty AvailPhysical(InventSum _inventSum)
{
    InventDim       joinDim, dimValues;
    InventDimParm   dimParm;
    InventSum       localSum;

    //THE IMPORTANT LINE...
    dimValues.data(_inventSum.joinChild());

    dimParm.initFromInventDim(dimValues);

    select sum(AvailPhysical) from localSum where localSum.ItemId == _inventSum.ItemId
        #InventDimExistsJoin(localSum.InventDimId, joinDim, dimValues, dimParm);

    return localSum.AvailPhysical;
} 
```

我相信这将在未来帮助某人！

# vbscript - VBS 调用 CMD 并在参数中引用

> ID：11452894
> 
> 赞同：0
> 
> 时间：2012-07-12T13:28:49.753
> 
> 标签：vbscript, cmd

我正在尝试将一段代码作为命令行参数传递给在 WinXP 上运行的程序。我无法将整个代码片段作为一个参数传递。它被 SPACE 和 QUOTE 字符分割（如预期的那样）。引用整个内容并使用 QUOTE、SLASH 或 CARAT 转义 QUOTE 字符也失败了......

```
Const TheCode = "main(""Literal String Argument"", 123, true)"
Set oShell = WScript.CreateObject ("WScript.Shell")
oShell.Run """c:\Folder with space\ArgTest.vbs"" """ & TheCode & """" 
```

我运行以下 vbs 脚本来回显参数以测试收到的内容。

ArgTest.vbs：

```
Dim ArgumentIndex
For ArgumentIndex = 0 to Wscript.Arguments.Count - 1
    Call Msgbox(Wscript.Arguments(ArgumentIndex), vbOKOnly+vbInformation, "Argument " & ArgumentIndex)
Next 
```

编辑：原来是 VBS Echo 脚本指出了引号。使用 QUOTE 转义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:45:08.183

Windows 中没有转义引号的标准。如何转义引号完全取决于应用程序开发人员的判断。如果您的应用程序没有说明如何操作的文档，那么您将不得不自己发现它（假设应用程序甚至支持转义引号）

听起来您尝试了反斜杠：

```
Const TheCode = "main(\""Literal String Argument\"", 123, true)" 
```

您还说您尝试过插入符号：

```
Const TheCode = "main(^""Literal String Argument^"", 123, true)" 
```

您是否尝试过将引号加倍？

```
Const TheCode = "main(""""Literal String Argument"""", 123, true)" 
```

# vba - 在 Excel 中将数据从一个工作表移动到另一个工作表。

> ID：11452897
> 
> 赞同：0
> 
> 时间：2012-07-12T13:29:16.573
> 
> 标签：vba, excel

我正在尝试在 VBA 中编写从另一个工作簿获取数据并将其粘贴到正确位置的代码。例如：

在一个工作簿中：

```
123 x  
321 xx  
159 xxx  
235 xxxx 
```

x 列应该被复制并放置在正确的位置，最终如下所示：

```
235    xxxx
321    xx
123    x
159    xxx 
```

我已经设法获取数据，但问题是当我尝试将其放入正确的单元格时；块中的`If`语句`For...Next`不能正常工作。这是我的代码：

```
Sub copyToWorkbook()
    Dim arr(32) As String
    Dim rr(32) As String
    Dim temp(32) As String

For k = 1 To 32
    temp(k) = Cells(k, 1).Value
Next
With ActiveSheet
        .Range("B200:B300").FormulaArray = "='" & "g:" & "\[" & "PPM_et_top_fournisseur.xls" & "]" _
                    & "PPM officiels" & "'!" & "B12:B43"
End With
Dim q As Integer
For f = 1 To 32
    q = 199 + f
    arr(f) = Cells(q, 2).Value
    Cells(f, 8) = arr(f)
Next

With ActiveSheet.Range("C200:C300")
     .FormulaArray = "='" & "g:" & "\[" & "PPM_et_top_fournisseur.xls" & "]" _
                    & "PPM officiels" & "'!" & "J12:J43"
     .Value = .Value
End With

Dim w As Integer

For o = 1 To 32
    w = 199 + o
    rr(o) = Cells(w, 3).Value
    Cells(o, 9) = rr(o)
Next
For t = 1 To 32
    For n = 1 To 32
        If Cells(20, 1).Value <> arr(n) Then
           Cells(n, 7) = arr(n)
            Else: Cells(t, 10) = "nop"
        End If
    Next
Next
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:36:56.917

这看起来像您正在尝试使用`VLOOKUP`.

但是，如果您真的想在 VBA 中完成此操作，我建议将源书加载到二维数组中，然后循环遍历数组以将其值输出到适当行中的目标工作表。

本周早些时候我在这里回答了一个类似的问题：[EXCEL VBA Paste from array, change paste order](https://stackoverflow.com/questions/11426973/excel-vba-paste-from-array-change-paste-order/11433921#11433921)

唯一真正的区别似乎是该人使用了整列数据，并且水平重新排列而不是垂直排列。

话虽如此，听起来您确实可以使用`VLOOKUP`公式根据第一列查找 x 列值。

# playn - ImageLayer setRepeatX 和 setRepeatY 不起作用？

> ID：11452901
> 
> 赞同：0
> 
> 时间：2012-07-12T13:29:24.903
> 
> 标签：playn

我尝试为 ImageLayer 设置 RepeatX/RepeatY 以允许无限翻译。

来自：[PlayN - 在背景层重复图像](https://stackoverflow.com/questions/11331695/playn-repeat-image-in-background-layer)

```
final ImageLayer bgLayer = graphics().createImageLayer(bgImage);
bgLayer.setRepeatX(true);
bgLayer.setRepeatY(true);
graphics().rootLayer().add(bgLayer); 
```

然后我在我的更新循环中翻译。我已经尝试过PNG和JPG。这似乎不起作用？我错过了什么明显的东西吗？

在此先感谢，斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:21:06.647

显然我对 setRepeat 的功能有点困惑。这与基于图块的图像一起使用。不是我要找的。

我将手动管理这个。

# jquery-plugins - 完整日历：如何在有事件的日子里显示“忙碌的一天”而不显示每个事件？

> ID：11452908
> 
> 赞同：0
> 
> 时间：2012-07-12T13:29:52.420
> 
> 标签：jquery-plugins, fullcalendar

我正在使用 jquery FullCalendar。现在我需要一个显示它的较小版本。

我想在月视图中“突出显示”有事件的一天（但不显示每个事件），并使用 qTip 在鼠标悬停时显示当天的事件列表。

有没有办法做到这一点？
感谢帮助干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:07:31.660

我认为您可以处理日历中的一些事件......并为那些忙碌的日子应用不同的 CSS 类，甚至自己处理绘图事件。

在后端，您应该为有多个事件的一天返回一个事件。它应该是标题为“忙碌”和日期的“虚拟”事件。

[手动渲染事件](http://arshaw.com/fullcalendar/docs/event_rendering/renderEvent/)

[EventRender，回调处理事件的绘制](http://arshaw.com/fullcalendar/docs/event_rendering/eventRender/)

# xquery - 删除与查询匹配的所有文档？

> ID：11452911
> 
> 赞同：2
> 
> 时间：2012-07-12T13:30:08.400
> 
> 标签：xquery, marklogic

我想删除与某些谓词匹配的所有文档。我提出的查询如下，但没有从数据库中删除任何内容。

我怀疑这是因为 $doc 设置为文档的 XML 值而不是文档本身。任何人都可以对此有所了解吗？

```
xquery version "1.0-ml";
for $doc in cts:search(fn:collection("MYCOLLECTIONNAME")/MyDocumentRoot,
    cts:or-query((
    cts:element-range-query (xs:QName("MyElement"), "=", "MyElementValue"),
    )), "unfiltered" )
    return xdmp:document-delete($doc); 
```

该文件看起来像

```
<MyDocumentRoot>
  <MyElementName>MyElementValue</MyElementName>
</MyDocumentRoot> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T16:34:15.350

您确实将文档的内容传递给 xdmp:document-delete 而不是它的 uri。您可以使用 example 派生 uri `fn:base-uri()`，但是像这样，您要删除的所有文档都首先从数据库中检索，这是不必要的。

相反，启用 URI 词典，并使用`cts:uris`来执行删除。分批删除 1000 个文档也可能是明智之举。

！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T16:42:28.723

xdmp:document-delete() 获取文档的 URI，而不是节点。所以最简单的解决方法是将 $doc 包装在 base-uri(.) 中：

```
return xdmp:document-delete(base-uri($doc)) 
```

但是，如果您启用了 URI 词典，您可以编写一个更快的查询，如下所示：

```
let $query := cts:and-query((
                cts:collection-query("MYCOLLECTIONNAME"),
                cts:or-query((...)) (: put your full or query here :)
              ))
for $uri in cts:uris("",(),$query) return xdmp:document-delete($uri) 
```

在后一种情况下，您不必阅读每个文档来获取其 URI。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-13T23:06:43.070

`xdmp:collection-delete("MYCOLLECTIONNAME")`也值得一提。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-12T15:00:11.860

在最后一行，更改为

```
xdmp:document-delete(fn:base-uri($doc)); 
```

# jquery - 我可以在同一个 Web 应用程序中使用 Jquery UI 和 Jquery mobile 吗？

> ID：11452912
> 
> 赞同：1
> 
> 时间：2012-07-12T13:30:13.187
> 
> 标签：jquery, asp.net, jquery-ui, asp.net-4.0

我希望我的应用程序可以在桌面和 Ipad 上正确查看。我快速浏览了 Jquery mobile，它看起来非常简单。我的问题是：我已经引用了 Jquery UI。Jquery UI 会干扰 Jquery mobile 吗？

如果 Jquery mobile 也可以在基于桌面的 Web 应用程序上使用，那么我们为什么要使用 Jquery UI。为什么人们不总是使用 Jquery Mobile 以便他们自动获得基于 Ios 的设备的视图？

我太困惑了。当我在已经具有 Jquery UI 的网站中添加对 Jquery mobile 的引用时会发生什么？我不想破坏我的实时网站。有什么建议么？

我正在使用 Asp.Net 4.0 Vanilla 并且有很多 gridview 等。jquery mobile 是否有助于在基于桌面的应用程序以及基于平板电脑的应用程序上正确显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T15:25:39.367

jQuery Mobile 更像是一种标记语言——它实际上是为移动应用程序而不是移动网站设计的，并且同时兼容 iPhone、iPad 和 Android。jQuery-UI 是一组主要为桌面浏览器设计的小部件。您仍然可以将 jQuery-UI 与 jQuery Mobile 一起使用，但您可能不应该这样做。

如果您只是在使用基本网站，那么 CSS 媒体查询是您的最佳选择。谷歌那个确切的短语或[从这里开始](http://css-tricks.com/css-media-queries/)。

如果您仍然想使用 jQuery Mobile，有许多方法可以将移动用户从您的公共网站重定向到移动网站。可能我会尝试的第一个是侵入性最小的：在顶部添加一个链接，将用户引导到移动网站，并使用上述 CSS 媒体查询向桌面用户隐藏它：

```
@media all and (min-width: 701px) {
    #link-to-mobile-site {
        display: none;
    }
} 
```

这使移动访问者可以随时继续使用完整的网站，在他们不使用时为他们提供易于添加书签的链接，并为您创建最少的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:34:47.717

Jquery 和 jquery mobile 的 css 之间存在冲突的可能性......此外，尝试在 jquery mobile 上制作它，因为 jquery mbl 是专门为 ipad/iphone 制作的，并且在桌面上看起来也很整洁

# ios - UIBezierPath 持久化核心数据

> ID：11452918
> 
> 赞同：8
> 
> 时间：2012-07-12T13:30:30.393
> 
> 标签：ios, core-data, uibezierpath

我正在开发一个用户可以用手指在屏幕上绘图的应用程序。我为此使用 UIBezierPath。我需要保留这个数据，它是一个包含多个 BezierPath 对象的 NSArray。解决此问题的最佳方法是什么？存储在coredata中，使用NSData存储在文件中？非常感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-12T13:59:58.760

您是否期望必须存储多个对象？您是否需要能够根据某些过滤器或排序来获取它们？我建议使用 Core Data 来为自己节省大量打包/解包数据的工作量。没有真正的理由将其存储在文件中。

**编辑：**

正如另一个答案所说，您只需将其存档到 NSData。UIBezierPath类遵循 NSCoding 协议，因此您可以执行以下操作来归档它[：](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIBezierPath_class/Reference/Reference.html)

```
NSData *bezierData = [NSKeyedArchiver archivedDataWithRootObject:bezierPath]; 
```

您可以将该 NSData 对象持久保存在 Core Data 中。

要解码存档，假设我们有一个`bezierData`NSData 对象，您可以执行以下操作：

```
UIBezierPath *bezierPath = [NSKeyedUnarchiver unarchiveObjectWithData:bezierData]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T18:06:07.313

将 UIBezierPath 归档到 NSData，并将其作为 NSData 类型的属性存储在 CoreData 中。如果您将其设为可转换属性，您可以拥有更简单的 API。

这很容易做到，尤其是对于已经支持归档的类。

有关详细信息，请参阅此文档。

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdNSAttributes.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdNSAttributes.html)

# c++ - 如何在 C++ 中将 int 转换为枚举？

> ID：11452920
> 
> 赞同：267
> 
> 时间：2012-07-12T13:30:36.400
> 
> 标签：c++, casting, enums

如何将 int 转换为 C++ 中的枚举？

例如：

```
enum Test
{
    A, B
};

int a = 1; 
```

如何转换`a`为 type `Test::A`？

* * *

## 回答 #1

> 赞同：305
> 
> 时间：2012-07-12T13:33:14.567

```
int i = 1;
Test val = static_cast<Test>(i); 
```

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2012-07-12T13:33:15.513

```
Test e = static_cast<Test>(1); 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-07-12T13:48:54.580

你的代码

```
enum Test
{
    A, B
}

int a = 1; 
```

解决方案

```
Test castEnum = static_cast<Test>(a); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2019-08-15T21:27:08.503

分拆结束的问题，“我如何将 a 转换为类型`Test::A`”，而不是严格要求在那里有*演员*表，并迟到几年才回答，因为这似乎是一个流行的问题，没有其他人提到过替代方案，根据 C++11 标准：

> 5.2.9 静态转换
> 
> ...对于某些发明的临时变量（8.5） ，如果声明 格式正确，则表达式`e`可以`T` 使用`static_cast`形式的 a 显式转换为类型。这种显式转换的效果与执行声明和初始化，然后使用临时变量作为转换的结果相同。`static_cast<T>(e)``T t(e);``t`

因此，直接使用表单`t(e)`也可以，您可能更喜欢它的整洁：

```
auto result = Test(a); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-16T14:55:23.703

`Test castEnum = static_cast<Test>(a-1);`将投射`a`到`A`. 如果您不想子结构 1，您可以重新定义`enum`：

```
enum Test
{
    A:1, B
}; 
```

在这种情况下`Test castEnum = static_cast<Test>(a);`，可用于强制`a`转换为`A`.

# tomcat - netbeans 和 tomcat 7 在保存时部署

> ID：11452925
> 
> 赞同：5
> 
> 时间：2012-07-12T13:30:44.730
> 
> 标签：tomcat, netbeans, deployment, netbeans-7.1

我正在使用**netbeans 7.1.2**和**tomcat 7**。当我在 .java 或 .xhtml 文件中进行一些更改时，文件会在我保存时部署，但我必须重新启动 tomcat 服务器才能在浏览器中查看更改。
你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-26T13:04:05.450

通常，xhtml 文件更改应在部署到没有启动服务器的 tomcat 后应用。但是在重新启动服务器之前，Java 文件更改并不适用。

检查对 xhtml 文件所做的更改是否成功应用于 tomcat Web 应用程序中的 war 文件。如果成功添加，则重新加载您的页面。应适用更改。

解决问题。

对于应用 java 端更改而无需重新启动 tomcat，有一些工作要做。

您可以在调试模式下执行此操作。附加调试，然后单击应用代码更改按钮。它将进行热部署。

或者在 conf 下编辑你的 tomcat 中的 server.xml。

```
<Host name="localhost"  appBase="webapps"
            unpackWARs="true" autoDeploy="true"
            xmlValidation="false" xmlNamespaceAware="false"> 
```

设置自动部署=真

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-26T20:16:13.693

我认为现在回答这个问题为时已晚。

但是对于谁有这个问题。

我遇到了同样的问题，为了修复它，我必须清理项目，然后通过 tomcat 运行它。这样，tomcat应该重建我的项目，所以一切都是新鲜和干净的，我的问题就这样解决了。

# python - QWidget：必须在 QPaintDevice 之前构造一个 QApplication

> ID：11452937
> 
> 赞同：5
> 
> 时间：2012-07-12T13:31:26.020
> 
> 标签：python, pyqt, pyqt4

首先，出于兼容性原因，我将 Windows 7-64 位与 PyQwt5.2.0、PyQt4.5.4、NumPy1.3.0、python2.6.2 32 位一起使用。

在运行我的脚本时，会出现：

```
QWidget: Must construct a QApplication before a QPaintDevice 
```

在网上冲浪，寻找修复它的方法，我得到了`QWidget`继承`QObject`和`QPaintDevice`（它几乎是我使用的每个对象都继承了），并且`QMainWindow`继承了`QWidget`. 我还知道一些静态函数正在尝试使用某个类，但我不太明白它的含义。

如果有人可以解释这一点，我将不胜感激。

PS：如有翻译错误，请见谅。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T16:59:00.437

从代码来看，错误是由第 102 行引起的。在那里，在加载模块时，您创建了一个`QWidget`（更准确地说是 a `QMainWindow`）。这发生在**创建之前**`QApplication`。

另外，我不知道为什么你有这个 start 变量，因为它似乎没有被使用。

如果要使用对象创建它，请在方法`HelloBegin`中移动它。`__init__`

**编辑：**

如果您想在加载模块时显示启动屏幕，您需要由一个小型、轻量级的模块启动应用程序。在本模块中，您将：

1.  创建 QApplication
2.  打开您的启动画面/消息框
3.  然后才加载其他模块

为了一切顺利，我会在一个单独的函数中导入模块，并使用一个小技巧来确保它仅在 GUI 准备好后启动。代码将如下所示：

```
from PyQt4.QtGui import QApplication
from PyQt4.QtCore import QTimer
def startApp():
    import m1
    import m2
    wnd = createWindow()
    wnd.show()
import sys
app = QApplication(sys.argv)
splash = createSplashScreen()
splash.show()
QTimer.singleShot(1, startApp) # call startApp only after the GUI is ready
sys.exit(app.exec_()) 
```

`createSplashScreen`创建启动画面的函数在哪里

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-05T08:22:46.630

*我在运行unittest*时遇到了错误。

```
QWidget: Must construct a QApplication before a QWidget 
```

解决方案是为每种测试方法构建 QApplication。

```
app = QtWidgets.QApplication(sys.argv) 
```

# php - 如何正确使用 HTTP_X_FORWARDED_FOR？

> ID：11452938
> 
> 赞同：42
> 
> 时间：2012-07-12T13:31:34.567
> 
> 标签：php, proxy, ip, forwarding

好的，我有一个小的身份验证问题。我的 Web 服务允许使用用户名和密码通过 HTTP 连接到我的 API，但此连接也可以限制为特定的 IP 地址。

这意味着`$_SERVER['REMOTE_ADDR']`可能是不正确的。我已经知道任何 IP 信息都不能真正被依赖——我有这个限制只是为了增加另一层安全性。

如果这是对我的 Web 服务器的请求的一般概述：

`clientSERVER => clientPROXY => myPROXY => mySERVER`

那么这意味着 mySERVER 显示`REMOTE_ADDR`myPROXY 而不是客户端，并将客户端的实际 IP 发送为`HTTP_X_FORWARDED_FOR`.

为了克服这个问题，我的 Web 服务有一个“受信任的代理”IP 地址列表，如果`REMOTE_ADDR`来自这些受信任的 IP 地址之一，那么它会告诉我的 Web 服务实际 IP 地址是`HTTP_X_FORWARDED_FOR`.

现在问题出在clientPROXY上。这意味着（经常） mySERVER 获得`HTTP_X_FORWARDED_FOR`具有多个 IP 地址的值。根据`HTTP_X_FORWARDED_FOR`文档，该值是以逗号分隔的 IP 地址列表，其中第一个 IP 是实际真实客户端的 IP 地址，其他每个 IP 地址都是代理的 IP 地址。

那么，如果`HTTP_X_FORWARDED_FOR`有多个值并且我的服务受 IP 限制，我是否必须根据`HTTP_X_FORWARDED_FOR`允许的 IP 列表检查“最后一个”值并忽略实际的客户端 IP？

我假设在一个系统中，我必须设置允许的 IP 地址列表，列入白名单的 IP 地址应该是代理的地址，而不是代理后面的 IP（因为它可能是一些本地主机 IP 并且经常更改） .

什么`HTTP_CLIENT_IP`？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-05-13T05:56:59.150

您可以使用此函数获取正确的客户端 IP：

```
public function getClientIP(){       
     if (array_key_exists('HTTP_X_FORWARDED_FOR', $_SERVER)){
            return  $_SERVER["HTTP_X_FORWARDED_FOR"];  
     }else if (array_key_exists('REMOTE_ADDR', $_SERVER)) { 
            return $_SERVER["REMOTE_ADDR"]; 
     }else if (array_key_exists('HTTP_CLIENT_IP', $_SERVER)) {
            return $_SERVER["HTTP_CLIENT_IP"]; 
     } 

     return '';
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-06-17T23:45:42.993

我喜欢 Hrishikesh 的答案，我只有这个要添加...因为我们看到在使用多个代理时遇到了一个逗号分隔的字符串，我们发现有必要添加一个爆炸并获取最终值，比如这个：

```
$IParray=array_values(array_filter(explode(',',$_SERVER['HTTP_X_FORWARDED_FOR'])));
return reset($IParray); 
```

array_filter 在那里删除空条目。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-08-03T09:13:50.457

鉴于最新的[httpoxy](https://httpoxy.org/)漏洞，确实需要一个完整的例子，如何`HTTP_X_FORWARDED_FOR`正确使用。

所以这里有一个用 PHP 编写的示例，如何检测客户端 IP 地址，如果您知道客户端可能位于代理后面并且您知道该代理是可以信任的。如果您不知道任何受信任的代理，请使用`REMOTE_ADDR`

```
<?php

function get_client_ip ()
{
    // Nothing to do without any reliable information
    if (!isset ($_SERVER['REMOTE_ADDR'])) {
        return NULL;
    }

    // Header that is used by the trusted proxy to refer to
    // the original IP
    $proxy_header = "HTTP_X_FORWARDED_FOR";

    // List of all the proxies that are known to handle 'proxy_header'
    // in known, safe manner
    $trusted_proxies = array ("2001:db8::1", "192.168.50.1");

    if (in_array ($_SERVER['REMOTE_ADDR'], $trusted_proxies)) {

        // Get the IP address of the client behind trusted proxy
        if (array_key_exists ($proxy_header, $_SERVER)) {

            // Header can contain multiple IP-s of proxies that are passed through.
            // Only the IP added by the last proxy (last IP in the list) can be trusted.
            $proxy_list = explode (",", $_SERVER[$proxy_header]);
            $client_ip = trim (end ($proxy_list));

            // Validate just in case
            if (filter_var ($client_ip, FILTER_VALIDATE_IP)) {
                return $client_ip;
            } else {
                // Validation failed - beat the guy who configured the proxy or
                // the guy who created the trusted proxy list?
                // TODO: some error handling to notify about the need of punishment
            }
        }
    }

    // In all other cases, REMOTE_ADDR is the ONLY IP we can trust.
    return $_SERVER['REMOTE_ADDR'];
}

print get_client_ip ();

?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-29T18:03:41.017

您还可以使用[mod_remoteip](https://httpd.apache.org/docs/current/mod/mod_remoteip.html)通过 Apache 配置解决此问题，方法是将以下内容添加到 conf.d 文件中：

```
RemoteIPHeader X-Forwarded-For
RemoteIPInternalProxy 172.16.0.0/12
LogFormat "%a %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-07T23:24:43.107

如果在数据库中使用它，这是一个好方法：

将数据库中的 ip 字段设置为 varchar(250)，然后使用：

```
$theip = $_SERVER["REMOTE_ADDR"];

if (!empty($_SERVER["HTTP_X_FORWARDED_FOR"])) {
    $theip .= '('.$_SERVER["HTTP_X_FORWARDED_FOR"].')';
}

if (!empty($_SERVER["HTTP_CLIENT_IP"])) {
    $theip .= '('.$_SERVER["HTTP_CLIENT_IP"].')';
}

$realip = substr($theip, 0, 250); 
```

然后您只需对照数据库 ip 字段检查 $realip

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-26T12:21:42.370

请注意，“HTTP_X_FORWARDED_FOR”很容易被欺骗，例如使用浏览器插件更改条目......所以请注意！

试试这个来自 Hrishikesh Mishra 的修改后的代码（未测试）：

```
 function getClientIP(){  

 if (array_key_exists('HTTP_X_FORWARDED_FOR', $_SERVER) && preg_match('/\b((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}\b/', $_SERVER["HTTP_X_FORWARDED_FOR"])){
        return  $_SERVER["HTTP_X_FORWARDED_FOR"];  
 }else if (array_key_exists('REMOTE_ADDR', $_SERVER)) { 
        return $_SERVER["REMOTE_ADDR"]; 
 }else if (array_key_exists('HTTP_CLIENT_IP', $_SERVER)) {
        return $_SERVER["HTTP_CLIENT_IP"]; 
 } 

 return '';
} 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2013-06-17T02:55:32.083

HTTP_CLIENT_IP 是获取用户 IP 地址的最可靠方式。接下来是 HTTP_X_FORWARDED_FOR，然后是 REMOTE_ADDR。按顺序检查所有三个，假设设置的第一个（`isset($_SERVER['HTTP_CLIENT_IP'])`如果设置了该变量，则返回 true）是正确的。您可以使用各种方法独立检查用户是否正在使用代理。看看[这个](https://stackoverflow.com/questions/4527345/determine-if-user-is-using-proxy)。

# iphone - 这是 iOS 私有 API 实现吗？

> ID：11452939
> 
> 赞同：2
> 
> 时间：2012-07-12T13:31:41.080
> 
> 标签：iphone, ios, ipad, api

我正在开发一个需要更改 UITabBar 高度的 iOS 应用程序。首先，我通过 tabbar 的 frame 属性对其进行了更改，但这并没有给出预期的结果，而且图标大小也非常小。因此，我编写了以下代码来更改标签栏的背景并增加其图标的大小。

```
for (UIView *view in ctrl.tabBar.subviews) {
    if ([NSStringFromClass(view.class) isEqualToString:@"_UITabBarBackgroundView"]) {
        [view removeFromSuperview];

        CGRect frame = ctrl.tabBar.frame;
        frame.origin = CGPointZero;
        frame.size.height = floor(frame.size.height / 2);

        UIView *background = [[UIView alloc] initWithFrame:frame];
        background.backgroundColor = [UIColor colorWithRed:0.15 green:0.15 blue:0.15 alpha:1.0];
        background.userInteractionEnabled = NO;

        [ctrl.tabBar addSubview:background];
        [ctrl.tabBar sendSubviewToBack:background];

        [background release];
    }

    for (UIView *subview in view.subviews) {
        if ([NSStringFromClass(subview.class) isEqualToString:@"UITabBarSwappableImageView"]) {
            CGRect frame = subview.frame;
            frame.size.height = 80;
            subview.frame = frame;
            subview.contentMode = UIViewContentModeCenter;
        }

        if ([NSStringFromClass(subview.class) isEqualToString:@"UITabBarButtonLabel"]) {
            CGRect sFrame = subview.frame;
            sFrame.size.height += diff;
            subview.frame = sFrame;
        }
    }
} 
```

所以我想确认一下，“这个代码是否可以安全地获得批准？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:49:39.853

您没有使用未记录的 API，但是您可能正在使用[HIG](http://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/Introduction/Introduction.html)。没有明确的方式说苹果是否会接受这一点，但绝对不建议反对[HIG](http://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/Introduction/Introduction.html)。

所以一切顺利！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:51:34.663

您不必担心因使用私有 API 而被拒绝，因为您没有使用私有 API。现在商店中的许多应用程序都带有自定义标签栏，因此在此基础上也不应该成为问题。但是，通过某些方式设置标签栏的样式，您可能不遵守[iOS 人机界面指南](http://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/MobileHIG/MobileHIG.pdf)。根据[App Store Review Guidelines](https://developer.apple.com/appstore/guidelines.html)，尤其是[本页](https://developer.apple.com/appstore/resources/approval/guidelines.html)的第 10 节，不遵循界面指南是拒绝的理由。我建议阅读指南以获取更多信息；无论如何，他们有很多好的建议。

Apple 现在对提交的回复似乎比以前快了很多，所以看起来你已经设置好了所有东西，你可以把它发送进去看看他们怎么说。我预计不会出现重大问题，但苹果拥有最终决定权。他们通常会准确地告诉你哪里出了问题，这样你就可以轻松地纠正它。

# java - 自动排列动态添加值的图形

> ID：11452940
> 
> 赞同：1
> 
> 时间：2012-07-12T13:31:42.270
> 
> 标签：java, jfreechart

我使用这种方法创建了一个 JFreeChart 对象：

```
private JFreeChart createChart(XYDataset xydataset)
    {
        jfreechart = ChartFactory.createTimeSeriesChart("Server Throughtput", "Time", "Bytes/s", xydataset, true, true, false);
        XYPlot xyplot = (XYPlot) jfreechart.getPlot();
        ValueAxis valueaxis = xyplot.getDomainAxis();
        valueaxis.setAutoRange(true);
        valueaxis.setFixedAutoRange(60000D);
        valueaxis = xyplot.getRangeAxis();
        valueaxis.setRange(0.0D, 100D);

        return jfreechart;
    } 
```

图表会自动更新。我设置为最大值 100D。一段时间后收到的值超过 100D。如何在运行时自动调整图表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T14:50:36.157

调用`valueaxis.setRange(0.0D, 100D)`将自动范围标志设置为 false。使范围`valueaxis.setAutoRange(true)`在（或代替）之后自动更新调用`valueaxis.setRange(0.0D, 100D)`

在您的示例中，您正在重用`valueaxis`来保存`DomainAxis`和`RangeAxis`。此代码自动范围两个轴：

```
 XYPlot plot = (XYPlot) result.getPlot();
        ValueAxis domainAxis = plot.getDomainAxis();
        domainAxis.setAutoRange(true);
        domainAxis.setFixedAutoRange(60000.0);  
        ValueAxis rangeAxis = plot.getRangeAxis();
        rangeAxis.setAutoRange(true); 
```

# git - git format-patch 包含 repo 中的所有文件，只需要最后一次提交

> ID：11452943
> 
> 赞同：0
> 
> 时间：2012-07-12T13:31:50.630
> 
> 标签：git

我对 git 很陌生，对堆栈也很陌生，所以如果我无法正确格式化我的问题，我深表歉意。

我正在尝试将这两个文件包含在我上次提交的补丁文件中。我试过这个：

```
git format-patch master --stdout> mypatchfilename.patch 
```

和这个：

```
git format-patch -1 master --stdout> mypatchfilename.patch 
```

在这两种情况下，补丁文件都包含整个存储库，而不仅仅是我上次提交中的两个文件。我无法将文档或教程中的任何内容拼凑在一起。如何在我的补丁中包含最后一次提交？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:03:09.647

对于最后一次提交：`git format-patch --stdout HEAD~1..HEAD`会做。用于`git log --oneline`获取所选提交的列表，以便您在制作补丁系列时检查自己。然后，当您调用 format-patch 命令时，变更集选择参数将相同。例如：

```
git log --oneline origin/master.. # list changes on current HEAD not on origin/master
git format-patch --stdout origin/master.. # make a patch containing those changes 
```

虽然我会将输出设置为一个目录并创建一组补丁供`git am`以后使用。

# sql - 为什么一个有效的 SQL 查询不能作为子查询工作？

> ID：11452945
> 
> 赞同：0
> 
> 时间：2012-07-12T13:32:05.597
> 
> 标签：sql, oracle10g, subquery

我有以下查询，它可以工作并产生我需要的输出。

```
SELECT
*
FROM
(SELECT
  ref_year, ref_no, min(sequence_number) sequence_number
FROM
  case_decisions
WHERE
  stage = 'C'
AND
  decision_code <> 'IA'
GROUP BY
  ref_year,
  ref_no
) temp

INNER JOIN /* Produce table of first decisions only */
  case_decisions cdec
ON
  temp.ref_year = cdec.ref_year
AND
  temp.ref_no = cdec.ref_no
AND
  temp.sequence_number = cdec.sequence_number; 
```

但是，如果我尝试将它用作另一个工作查询的子查询连接（如下所示），我会收到一条错误消息，指出 fdec.ref_no 不是有效标识符。我认为我编写子查询的方式存在问题，但找不到它。

```
LEFT OUTER JOIN
(SELECT
  *
FROM
  (
  SELECT
    ref_year, ref_no, min(sequence_number) sequence_number
  FROM
    case_decisions
  WHERE
    stage = 'C'
  AND
    decision_code <> 'IA'
  GROUP BY
    ref_year,
    ref_no
  ) temp

INNER JOIN /* Produce table of first decisions only */
  case_decisions cdec
ON
  temp.ref_year = cdec.ref_year
AND
  temp.ref_no = cdec.ref_no
AND
  temp.sequence_number = cdec.sequence_number
) fdec
ON
  resolved.ref_year = fdec.ref_year
AND
  resolved.ref_no = fdec.ref_no 
```

给出一个完整的查询：

```
SELECT
  resolved.*,
  fdec.decision_code initial_decision

FROM
  (SELECT
    t1.ref_year,
    t1.ref_no,
    t1.date_decision_status_achieved,
    t1.sequence_number
  FROM
    case_decisions t1
    LEFT OUTER JOIN
    case_decisions t2
  ON
    (t1.ref_year = t2.ref_year
  AND
    t1.ref_no = t2.ref_no
  AND
    t1.sequence_number < t2.sequence_number)
WHERE
  t2.ref_year IS NULL
AND
  t2.ref_no IS NULL
AND
  (t1.status = 8 OR t1.status =11)
AND
  t1.decision_code <> 'IA'
AND
  t1.date_decision_status_achieved between '01-APR-2008' and '01-JUN-2008' /* dates for testing purposes only */) resolved

LEFT OUTER JOIN
(SELECT
  *
FROM
  (SELECT
    ref_year, ref_no, min(sequence_number) sequence_number
  FROM
    case_decisions
  WHERE
    stage = 'C'
  AND
    decision_code <> 'IA'
  GROUP BY
    ref_year,
    ref_no
  ) temp

INNER JOIN /* Produce table of first decisions only */
  case_decisions cdec
ON
  temp.ref_year = cdec.ref_year
AND
  temp.ref_no = cdec.ref_no
AND
  temp.sequence_number = cdec.sequence_number) fdec
ON
  resolved.ref_year = fdec.ref_year
AND
  resolved.ref_no = fdec.ref_no
; 
```

我看过类似的 SO 问题，但似乎没有人在尝试我是什么（我希望有迹象表明我做错了）。对于我在这里缺少的东西有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:34:58.973

问题在这里：

```
select * 
from (
    select ref_year,
        ref_no,
        min(sequence_number) sequence_number
    from case_decisions
    where stage = 'C'
        and decision_code <> 'IA'
    group by ref_year,
        ref_no
    ) temp
inner join case_decisions cdec on temp.ref_year = cdec.ref_year
    and temp.ref_no = cdec.ref_no
    and temp.sequence_number = cdec.sequence_number
) fdec on resolved.ref_year = fdec.ref_year 
```

您选择`ref_no`了两次（一次来自`temp`，一次来自，`cdec`因为`*`），所以它不知道`ref_no`要引用哪一列。而不是`*`，仅引用您需要的列。

试试这个版本：

```
select resolved.*,
    fdec.decision_code initial_decision
from (
    select t1.ref_year,
        t1.ref_no,
        t1.date_decision_status_achieved,
        t1.sequence_number
    from case_decisions t1
    left outer join case_decisions t2 on (
            t1.ref_year = t2.ref_year
            and t1.ref_no = t2.ref_no
            and t1.sequence_number < t2.sequence_number
        )
    where t2.ref_year is null
        and t2.ref_no is null
        and (
            t1.status = 8
            or t1.status = 11
        )
        and t1.decision_code <> 'IA'
        and t1.date_decision_status_achieved between '01-APR-2008' and '01-JUN-2008' /* dates for testing purposes only */
) resolved
left outer join (
    select temp.ref_year, temp.ref_no, cdec.decision_code
    from (
        select ref_year,
            ref_no,
            min(sequence_number) sequence_number
        from case_decisions
        where stage = 'C'
            and decision_code <> 'IA'
        group by ref_year,
            ref_no
    ) temp
    inner join case_decisions cdec on temp.ref_year = cdec.ref_year
        and temp.ref_no = cdec.ref_no
        and temp.sequence_number = cdec.sequence_number
) fdec on resolved.ref_year = fdec.ref_year
    and resolved.ref_no = fdec.ref_no; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:39:47.337

我最好的猜测是“*”在子查询中引入了两个名为“ref_no”的列，因为 temp 和 cdec 都有该列。

尝试将选择更改为：

```
select cdec.*, temp.sequence_number 
```

我以前在其他数据库中看到过这个错误，但消息更清晰。

# javascript - Facebook 注销按钮在 Firefox 的屏幕上爬行

> ID：11452948
> 
> 赞同：2
> 
> 时间：2012-07-12T13:32:09.013
> 
> 标签：javascript, facebook, macos, firefox, facebook-login

在此处访问我们的网站[http://readabout.me/](http://readabout.me/)，然后单击页面右下角的使用 Facebook 登录按钮。在完成使用我们的应用程序登录的步骤后，登录按钮将变为注销按钮，并开始慢慢地在屏幕上爬行，哈哈。

由于某种原因，登录按钮上似乎一遍又一遍地调用 Facebook 调整大小 JavaScript，但我无法弄清楚。我之前在 Stack Overflow 上的 JavaScript 调试很幸运，所以希望你们能帮助我:-)

非常感谢！我向你保证，这是你会遇到的最奇怪的 HTML/JS 错误之一，哈哈。

菲利普

PS 我在 Mac OS X 上使用 Firefox。它似乎在所有其他浏览器中都可以正常工作。

PPS 这是一个动画 gif：http: [//i.imgur.com/dRhrn.gif](https://i.imgur.com/dRhrn.gif)

![在此处输入图像描述](../Images/d35a8ca3b37aa6ccedd1756be7f4befc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:11:01.690

这是一个重复的问题。这似乎是facebook上的一个错误。

[如何防止 facebook-SDK (Javascript) 将注销按钮从右向左移动 ("PluginResize")](http://facebook.stackoverflow.com/questions/11402525/how-to-prevent-the-facebook-sdk-javascript-is-moving-the-logout-button-from-ri/11410112#11410112)

# php - 将 .php 重定向到 .html 扩展 404 错误

> ID：11452949
> 
> 赞同：1
> 
> 时间：2012-07-12T13:32:10.960
> 
> 标签：php, .htaccess, redirect

我正在尝试将所有 .php 文件转换为使用 .html 扩展名运行，但它给了我`404 Page Not found error`：

如果我运行带有 .php 扩展名的文件，它运行良好但不是带有 .html 扩展名，我也检查`mod_rewrite is enabled`过。

我安装了 Ubuntu 12 版本和 PHP 5.3。

htaccess 代码如下：

```
AddHandler application/x-httpd-php .php .html
AddType application/x-httpd-php .html
Options +FollowSymLinks
RewriteEngine on
RewriteBase /
RewriteRule ^(.*)\.html$ $1.php [L]
#RewriteCond %{REQUEST_URI} ^(.*)\.php$
#RewriteRule ^(.*) /$1.html [R=301,L] 
```

请帮帮我，怎么了？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:43:35.197

它适用于：

```
RewriteEngine On
RewriteRule ^(.*)\.html$ $1.php [L] 
```

# asp.net-mvc - Asp.net MVC URL 和目录结构

> ID：11452957
> 
> 赞同：1
> 
> 时间：2012-07-12T13:32:41.500
> 
> 标签：asp.net-mvc

我已经阅读了许多关于 Asp.net MVC 和目录结构的问题，但我仍然不明白如何模仿常规 URL 目录，例如 www.mysite.com/books/adventure/uk

而且，当您想到诸如主页、关于、联系我们等标准站点页面时。您不想为每个页面创建一个控制器，但您也不希望 URL 看起来像这样：www.mysite。 com/home/about 您最好希望它是 www.mysite.com/about

任何人都对 maproute 对象有足够的了解来帮助我理解这一点？

谢谢， 雅克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:21:31.977

这是完全可定制的`global.asax.cs`

默认情况下，一个新的 MVC 项目会添加遵循约定的标准 'catchall' 路由：`www.mysite.com/Controller/Action/ID`

如果您想要一些不同的东西，例如您的 www.mysite.com/about 路由到 HomeController.About() 操作的示例，您可以在包罗万象的**之前**添加以下路由：

```
routes.MapRoute(
    "My About Route",
    "About",
    new { controller = "Home", action = "About" }
); 
```

您可以添加任意数量的不遵循 MVC 通用约定的自定义路由，如果您愿意，甚至可以完全替换通用路由。

* * *

编辑：

要在下面回答您的评论，不，您不一定需要为每个可能的操作添加路线，而是可以制作一条适合 url 模式的路线 - 就像包罗万象的路线一样。`{controller}`和`{action}`是特殊的关键字。

例子：

1.）程序有一个SetController，但用户习惯称它们为Batches：

```
routes.MapRoute(
    "Batch",
    "Batch/{action}/{id}",
    new { controller = "Set", action = "Index", id = UrlParameter.Optional }
); 
```

2.) 您更喜欢按控制器的对象类型进行分组，但 URL 必须是动词/名词格式：

*   飞行控制器
*   酒店控制器
*   /查找/飞行 /预订/飞行
*   /查找/酒店/预订/酒店/希尔顿

 ````
routes.MapRoute(
    "NewCatchall",
    "{action}/{controller}/{name}",
    new { controller = "Home", action = "Index", name = UrlParameter.Optional }
); 
```

第二个示例可以完全替换默认路由，并且所有可能的 url 都适合其格式。所以没有什么会继续检查任何其他路线。重要的是要知道路由是按顺序检查的，并且使用与请求匹配的第一个模式 - 其余的被忽略。

这些对我学习时很有用：

*   [http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)
*   [http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/asp-net-mvc-routing-overview-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/asp-net-mvc-routing-overview-cs)
*   [http://blogs.msdn.com/b/tmarq/archive/2010/04/01/asp-net-4-0-enables-routing-of-extensionless-urls-without-impacting-static-requests.aspx](http://blogs.msdn.com/b/tmarq/archive/2010/04/01/asp-net-4-0-enables-routing-of-extensionless-urls-without-impacting-static-requests.aspx)`

# asp.net-mvc-3 - 具有实时变化数据的 Solr

> ID：11452961
> 
> 赞同：1
> 
> 时间：2012-07-12T13:32:52.967
> 
> 标签：asp.net-mvc-3, solr

我们正在开发基于 ASP.NET MVC3(C#) 的大型电子商务网站。我们计划实施 Solr 以获得更好的搜索结果。

站点中有一个名为“最受欢迎产品”的功能。顾名思义，它根据客户查看特定产品的次数显示站点上最受欢迎的产品。

在产品详细信息页面或产品列表页面上，我们通过放置一个唯一（最受欢迎的图标）图标来区分它，该图标表示最受欢迎的产品。

现在我们的问题是，我们如何更新产品在 solr 索引中识别为最受欢迎的标志或状态？或者我们如何将这些功能与 solr 联系起来？

注意：更新整个 solr 索引以实现此功能非常昂贵。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T14:24:28.373

我能想到几个建议。可能还有更多。

1.  在单独的 Solr 分片中拥有最受欢迎的产品（您知道的产品和您猜想的产品）。这个核心应该比其他核心小得多。索引更新和提交会更快。

2.  [4.0近实时搜索](http://wiki.apache.org/solr/NearRealtimeSearch)中有一个 solr 功能。. 您可以在上述核心（甚至整个索引）上使用此功能。此功能需要 solr 4.0

3.  如果您还不能使用 Solr 4.0，那么就拥有一个“实时”核心和“甲板上”核心。使用新的标志/状态更新甲板核心。提交此新数据后，将 on-deck 与 live core 交换。现在“实时”核心上的新搜索具有新数据。重复。

4.  在频繁更改索引核心的情况下关闭或减少搜索预热查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T16:07:59.947

Use [ExternalFileField](http://lucene.apache.org/solr/api-4_0_0-ALPHA/org/apache/solr/schema/ExternalFileField.html) to store popularity data for products (it's available in 3.6 too). This lets you update that field without the need to reindex anything.

# java - java.io.IOException：服务器返回 HTTP 响应代码：URL 为 500

> ID：11452967
> 
> 赞同：0
> 
> 时间：2012-07-12T13:33:00.333
> 
> 标签：java, xml-parsing, jdom

我有以下代码来调用 URL：`http://10.105.0.120/24online/servlet/ClientRegistrationResponse?action=response&phone=919638983856&actioncode=0000`

代码 ：

```
StringBuffer request=new StringBuffer();
             request.append(xml);
             URL url = new URL(url);
             HttpURLConnection obj = null;   
                obj = (HttpURLConnection)url.openConnection();  //create a SSL connection object server-to-server

                ((URLConnection)obj).setDoInput(true);
                ((URLConnection)obj).setDoOutput(true);
                ((URLConnection)obj).setUseCaches(false);
//              ((URLConnection)obj).setReadTimeout(10);
                ((URLConnection)obj).setRequestProperty("Content-Type","application/x-www-form-urlencoded");
                obj.setRequestMethod("POST");
                obj.setRequestProperty("charset", "US-ASCII");
                //obj.setConnectTimeout(PropertyReader.IN_REQUEST_TIMEOUT);
                //obj.setReadTimeout(PropertyReader.IN_REQUEST_TIMEOUT);
                // Here the HTTPS request URL is created

                DataOutputStream dataoutputstream = new DataOutputStream(((URLConnection)obj).getOutputStream());
                dataoutputstream.writeBytes(request.toString());    //request
                //dataoutputstream.flush(); 
                dataoutputstream.close(); //connection closed
                BufferedReader bufferedreader = new BufferedReader(new InputStreamReader(((URLConnection)obj).getInputStream()));
                String res = "";

                                while ( (res = bufferedreader.readLine()) != null ) {

                    conresponse += res;
                }
                bufferedreader.close(); 
```

但我收到以下错误：

```
java.io.IOException: Server returned HTTP response code: 500 for URL: http://10.105.0.120/24online/servlet/ClientRegistrationResponse?action=response&phone=919638983856&actioncode=0000
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1313)
    at cyberoam.corporate.integration.XMLSenderReceiver.sendFileData1(XMLSenderReceiver.java:70)
    at cyberoam.corporate.modes.TopupRequestThread.sendTopupRequest(TopupRequestThread.java:56)
    at cyberoam.corporate.modes.TopupRequestThread.run(TopupRequestThread.java:31)
org.jdom.input.JDOMParseException: Error on line -1: Premature end of file.
    at org.jdom.input.SAXBuilder.build(SAXBuilder.java:504)
    at cyberoam.corporate.integration.XMLProcessor.parseXML(XMLProcessor.java:392)
    at cyberoam.corporate.modes.TopupRequestThread.sendTopupRequest(TopupRequestThread.java:62)
    at cyberoam.corporate.modes.TopupRequestThread.run(TopupRequestThread.java:31)
Caused by: org.xml.sax.SAXParseException: Premature end of file.
    at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
    at org.apache.xerces.util.ErrorHandlerWrapper.fatalError(Unknown Source)
    at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
    at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
    at org.apache.xerces.impl.XMLVersionDetector.determineDocVersion(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
    at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
    at org.jdom.input.SAXBuilder.build(SAXBuilder.java:489)
    ... 3 more
Caused by: org.xml.sax.SAXParseException: Premature end of file.
    at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
    at org.apache.xerces.util.ErrorHandlerWrapper.fatalError(Unknown Source)
    at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
    at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
    at org.apache.xerces.impl.XMLVersionDetector.determineDocVersion(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
    at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
    at org.jdom.input.SAXBuilder.build(SAXBuilder.java:489)
    at cyberoam.corporate.integration.XMLProcessor.parseXML(XMLProcessor.java:392)
    at cyberoam.corporate.modes.TopupRequestThread.sendTopupRequest(TopupRequestThread.java:62)
    at cyberoam.corporate.modes.TopupRequestThread.run(TopupRequestThread.java:31)
Caused by: org.xml.sax.SAXParseException: Premature end of file.
    at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
    at org.apache.xerces.util.ErrorHandlerWrapper.fatalError(Unknown Source)
    at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
    at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
    at org.apache.xerces.impl.XMLVersionDetector.determineDocVersion(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
    at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
    at org.jdom.input.SAXBuilder.build(SAXBuilder.java:489)
    at cyberoam.corporate.integration.XMLProcessor.parseXML(XMLProcessor.java:392)
    at cyberoam.corporate.modes.TopupRequestThread.sendTopupRequest(TopupRequestThread.java:62)
    at cyberoam.corporate.modes.TopupRequestThread.run(TopupRequestThread.java:31)
2012-07-12 18:52:49,416 - PIPE_COMM: In Receiving Object for /usr/local/nas/pipes/raam_to_gui_pipe
******************SMPPThread constructor called***************** 
```

这个错误的原因是什么？就像我直接从浏览器调用 URL 一样，它工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:59:25.407

Is there a question?

You have sent a bad request to the server, and it is responding with an internal server error (code 500). The logical thing to do is to check your HTTP server logs (it is a 10.* IP address, so it is local to you).

Also the JDOM Exceptions are in a different thread or something.... there is no JDOM related code in the code you show, and the exception stack traces are not linked in any way to the IOException with the 500 status response. Alternatively, you are ignoring the status-500 response (IOException), and then expecting the JDOM code in that same thread to parse a (probably empty) error-response from the server (which would no doubt end in a premature end-of-file).

You need to:

*   check your server logs
*   handle all exceptions appropriately
*   potentially add some debug code to enable you to inspect the data you send to / retrieve from the server.

# java - 处理必须子类化的单例

> ID：11452969
> 
> 赞同：10
> 
> 时间：2012-07-12T13:33:01.633
> 
> 标签：java, servlets, enums, singleton

在问题[中，什么是在 Java 中实现单例模式的有效方法？](https://stackoverflow.com/questions/70689/what-is-an-efficient-way-to-implement-a-singleton-pattern-in-java?rq=1)投票最多的答案是，使用枚举来实现单例。

很好，我理解这些论点，分别是语言优势。

但是，我有一组定义单例但需要扩展其他类的类，这对于 enum 方法是不可能的，**因为 enums 不能 subclass**。

Joshua Bloch 在他的幻灯片中说：

> *   但是缺少一件事——你不能扩展枚举类型
>     *   在大多数情况下，您不应该
>     *   一个引人注目的用例——操作代码

在大多数情况下，您不应该：**有人可以详细说明**吗？我已经实现了几个 servlet 并且它们扩展了`HttpServlet`，为什么这些不应该是单例？我的应用程序中只需要它们的一个实例。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T13:45:22.910

一个 Singleton 类可以扩展其他类；实际上默认情况下在 Java 中它无论如何都会扩展 Object. 然而 Josh 指的是你不应该扩展一个 Singleton 类，因为一旦你扩展它，就会出现超过 1 个实例。

回复评论：

实际上，实现 Singleton 的最佳方法是：

从有效的Java

```
// Singleton with static factory
public class Elvis {
private static final Elvis INSTANCE = new Elvis();
private Elvis() { ... }
public static Elvis getInstance() { return INSTANCE; }
public void leaveTheBuilding() { ... }
} 
```

在这里，Elvis 可以扩展任何其他类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T13:44:52.950

您不应该关心 servlet 的实际实例 - 生命周期管理由 servlet 容器根据您同意的 Servlet 规范合同处理。如果将部分服务器端功能实现为单例是有意义的，那么请继续按照您喜欢的方式执行此操作，并从您的 servlet 中使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:40:23.733

Josh 指的是扩展枚举类型，而不是让单例类型扩展其他东西。

# java - 如何配置 Log4j 以避免具有相同内容的连续日志？

> ID：11452970
> 
> 赞同：0
> 
> 时间：2012-07-12T13:33:05.943
> 
> 标签：java, logging, log4j, slf4j

**无需编写适配器就可以实现吗？**

```
log.info("test1"); //12/07/2012 10:08:51
log.info("test1"); //12/07/2012 10:08:52
log.info("test2"); //12/07/2012 10:08:53
log.info("test2"); //12/07/2012 10:08:54
log.info("test3"); //12/07/2012 10:08:55
log.info("test1"); //12/07/2012 10:08:56 
```

预期输出：

> 12/07/2012 10:08:51 INFO - teste1 12/07/2012
> 10:08:53 INFO - teste2 12/07/2012
> 10:08:55 INFO - teste3 12/07/2012
> 10:08:56 INFO - 睾丸1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T16:51:05.577

[过滤器](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/spi/Filter.html)应该可以工作。

（间距因为stackoverflow想要它）

# python - 如果 SetUpClass 中的某些条件失败，则跳过单元测试

> ID：11452981
> 
> 赞同：19
> 
> 时间：2012-07-12T13:33:33.437
> 
> 标签：python, unit-testing, python-3.x, python-unittest

我正在使用`pyUnit`框架对我的应用程序进行单元测试测试。如果 setUpClass 中的某些条件失败，有什么方法可以跳过课堂上的所有测试？

目前，我正在 setUpClass 中设置环境（创建资源、配置全局设置）。但是，如果这些资源创建中的任何一个失败......我正在引发异常。相反，我想跳过整个测试套件。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-07-12T13:50:23.880

得到了答案：

对于那些被困在这里的人-

可以通过以下方式从 setUpClass 中跳过 unittest -

```
raise unittest.SkipTest(message) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-06-21T01:59:47.863

[文档](https://docs.python.org/3/library/unittest.html#skipping-tests-and-expected-failures)建议使用 TestCase.skipTest() ，而不是显式引发 SkipTest 异常。例如：

```
def setUp(self):
    if skip_tests_flag:
        self.skipTest('skipped test due to skip_tests_flag') 
```

# jquery - Selenium IDE 和自定义的 confirm() 函数冲突

> ID：11452982
> 
> 赞同：0
> 
> 时间：2012-07-12T13:33:35.247
> 
> 标签：jquery, selenium, firefox-addon, selenium-ide, simplemodal

我正在使用Eric Martin 的[简单模式对话框](http://www.ericmmartin.com/projects/simplemodal/)。并定义了一个功能，例如

```
function confirm(message, options) {....
  } 
```

自定义所有确认对话框。它在所有浏览器中都能很好地工作。除了我启用 Selenium IDE 时，我的自定义确认对话框功能无法捕获“选项”参数和 firefox 控制台回显，如下所示：

```
options is undefined callback=options.callback; 
```

**Selenium IDE 可见时出错**

![在此处输入图像描述](../Images/f094bccbf67a46361937507a9cfe3b53.png)

**Selenium IDE 关闭时的正常行为** ![在此处输入图像描述](../Images/209bc88ce1dd1fd00267951fc304528b.png)

请帮我解决这个问题，这样我就应该能够运行硒测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T04:56:58.470

当前可能的解决方案：

它向我揭示了[selenium IDE 记录器](http://code.google.com/p/selenium/source/browse/trunk/ide/src/extension/content/recorder.js?r=8284)也覆盖了各种功能。当前可能的快速摆脱此错误的方法是重命名 confirm() 函数及其引用:(

# macos - 如何将菜单操作路由到窗口内的 NSViewController？

> ID：11452983
> 
> 赞同：8
> 
> 时间：2012-07-12T13:33:40.130
> 
> 标签：macos, cocoa, nsmenuitem, nsresponder

我在主应用程序菜单中有一个菜单项，我想将其操作路由到视图控制器 ( `NSViewController`)。界面层次结构如下所示：有一个主应用程序窗口控制器，由`NSWindowController`. 窗口内部有一个拆分视图，拆分视图中的右视图由`NSViewController`.

```
Window + NSWindowController
    `-- NSSplitView
           `-- NSView
           `-- NSView + NSViewController 
```

菜单项连接到 Interface Builder 中的 First Responder。有问题的视图控制器实现了适当的方法，但菜单项保持禁用状态。当我将方法移至 时`NSWindowController`，菜单项将启用。

我想我需要将视图控制器获取到响应者链，所以我将它设置`nextResponder`为窗口控制器；没有雪茄。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T09:49:55.357

最后，我为我的窗口控制器添加了一个基类，并将它的调用转发到“子”控制器：

```
- (id) childControllerForSelector: (SEL) selector
{
    for (id controller in [childControllers copy])
        if ([controller respondsToSelector:selector])
            return controller;
    return nil;
}

- (BOOL) respondsToSelector: (SEL) selector
{
    return [super respondsToSelector:selector] ? YES :
        [self childControllerForSelector:selector] ? YES :
            NO;
}

- (void) forwardInvocation: (NSInvocation*) invocation
{
    id child = [self childControllerForSelector:[invocation selector]];
    [invocation invokeWithTarget:child];
}

- (NSMethodSignature*) methodSignatureForSelector: (SEL) selector
{
    NSMethodSignature *signature = [super methodSignatureForSelector:selector];
    if (!signature) {
        id child = [self childControllerForSelector:selector];
        signature = [child methodSignatureForSelector:selector];
    }
    return signature;
} 
```

这是很多代码，但它是一种通用的解决方案，可以使控制器代码免于临时转发。希望这不是太多的魔法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T17:08:48.880

您可以将窗口控制器设置为窗口的委托，因此它现在将成为响应者链的一部分。

假设您有自己的 子类`NSWindowController`，那么您可以简单地在那里捕获菜单事件并在控制器中调用适当的方法。

不幸的是，文档建议不要尝试在各种视图和子视图之间的响应者链中插入任何内容，因此您不能只是将视图控制器挤在那里。

更多[here](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/EventOverview/EventArchitecture/EventArchitecture.html)，但我认为您已经咨询过。

# java - 从字符串中删除特殊字符？

> ID：11452984
> 
> 赞同：0
> 
> 时间：2012-07-12T13:33:40.723
> 
> 标签：java, string

我有类似的字符串

```
Join our<\/strong>\u00a0<strong>&#8220;Worldwide Host Your Own Screening Tour! 
```

而且我要

```
Join our Worldwide Host Your Own Screening Tour! 
```

我的代码::

```
String str = "Join our<\/strong>\u00a0<strong>&#8220;Worldwide Host Your";
System.out.println(str.replaceAll("<\/strong>\u00a0<strong>&#8220;", " ")); 
```

错误

```
 Invalid escape sequence (valid ones are  \b  \t  \n  \f  \r  \"  \'  \\ ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:39:19.830

尝试这个：

```
String str = "Join our<\\/strong>\u00a0<strong>&#8220;Worldwide Host Your";
System.out.println(str.replaceAll("<\\\\/strong>\\u00a0<strong>&#8220;", " ")); 
```

[`String.replaceAll`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#replaceAll%28java.lang.String,+java.lang.String%29)需要一个正则表达式。

您也可以使用[StringUtils](http://commons.apache.org/lang/)（这有点简单）：

```
StringUtils.replace(str, "<\\/strong>\u00a0<strong>&#8220;", "") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:43:50.327

试试看。

```
 String s="Join our<\\/strong>\u00a0<strong>&#8220;Worldwide Host Your Own Screening Tour!";
    System.out.println(s.replaceAll("<\\\\/strong>\\u00a0<strong>&#8220;", " ")); 
```

弗朗西斯科获胜。

# wpf - 更改 WPF 中光标“hittest”边界区域的大小

> ID：11452985
> 
> 赞同：2
> 
> 时间：2012-07-12T13:33:44.810
> 
> 标签：wpf, cursor

是否可以使用 WPF 中的光标来增加用于命中测试的点的大小？

我希望能够使用类似于光标图像所覆盖的整个区域的东西来进行测试，而不是仅仅使用一个点。

我正在做一些我需要接收鼠标事件（进入/离开/等）的线条图，但是必须将光标对准小笔画厚度可能会很棘手，并且简单地增加厚度对我来说不是一个选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:48:22.140

您可以在此处使用的一种技术是绘制具有相同几何形状并增加厚度的第二条线或路径，使其不可见并将其放置在可见线的顶部。要做到这一点`Stroke=Transparent`，这将是不可见的，但仍会拾取鼠标事件。

这使您可以控制命中测试区域，诚然，您需要做一些额外的工作。

# xsd - biztalk 信封

> ID：11452986
> 
> 赞同：0
> 
> 时间：2012-07-12T13:33:49.520
> 
> 标签：xsd, biztalk, envelope

假设我想从我的源消息中分批一个 rootnode/child/child/repeatingnode 节点。我会将 Body Xpath 设置为 rootnode/child/child/...

但是现在，只要有根节点/子/子/节点不存在的源消息，接收端口就会失败。（当然，无法执行 Body Xpath）。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:42:13.157

不幸的是，您不能有条件地处理信封 - 管道现在期望信封存在。

你能把你的非封装消息分成一个单独的管道吗？这将是最合乎逻辑的方法。

# java - 为 XPath 评估设置当前节点

> ID：11452987
> 
> 赞同：1
> 
> 时间：2012-07-12T13:33:55.487
> 
> 标签：java, xslt, xpath, xalan, jaxp

给定一个节点列表和该列表中的当前节点，有没有办法使用 javax.xml.xpath （或 org.apache.xpath 可能）来评估位置相关的 XPath 表达式，例如：

```
position()=last()-1 
```

javax.xml.xpath 包含：

> evaluate(String expression, Object item, QName returnType) 在指定的上下文中计算一个 XPath 表达式，并将结果作为指定的类型返回。

我想我可以创建一个临时节点，将节点列表中的节点添加为子节点，并将与当前节点对应的子节点作为上下文进行评估，但是（假设甚至可以）有更好的方法吗？

或者，在 XSLT 1.0 中，假设我将这三个东西（节点列表、节点和 xpath 表达式（作为字符串））作为变量。是否可以将此表达式应用于节点，使用节点列表作为上下文，并将结果作为变量获取？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T16:01:39.723

大多数 XPath API，当然还有 JAXP API，只允许您设置单例焦点，即您可以选择任何项目作为上下文项目的焦点，但上下文位置和大小固定为 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T14:28:17.727

Xalan Java 支持[http://www.exslt.org/dyn/functions/evaluate/index.html](http://www.exslt.org/dyn/functions/evaluate/index.html)所以你应该可以使用例如

```
<xsl:variable name="nodes" select="/root/foo/bar"/>
<xsl:variable name="expression" select="concat('$nodes/', $yourPath)"/>
<xsl:variable name="result" select="dyn:evaluate($expression)"/> 
```

（`xmlns:dyn="http://exslt.org/dynamic"`当然有定义）。

这有帮助吗？我不确定我是否理解拥有节点列表和单个节点并希望将两者用作上下文的部分。

至于 Java 端并在 DOM NodeList 中找到最后一个节点之前的节点，还`nodeList.getItem(nodeList.getLength() - 2)`不够吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T04:57:04.750

[这篇 7 年前的帖子](http://osdir.com/ml/text.xml.xalan.java.user/2005-01/msg00018.html)表明，可能有一个特定于 Xalan 的非 XSLT 解决方案可用，但实现独立性和 Michael 的回应将我推向了寻找基于 XSLT1 的有效解决方案的方向。

这里是; 我不确定它是否对其他人有用。我想知道是否有更简单的方法？

只要您正确设置了所有内容，您就可以依赖 XSLT。从规范：

> 在 XSLT 中，最外层的表达式（即不属于另一个表达式的表达式）按如下方式获取其上下文：
> 
> 上下文节点来自当前节点
> 
> 上下文位置来自当前节点在当前节点列表中的位置；第一个位置是 1

从最后开始，我得到将表达式 $expression 应用于变量 $result 的结果：

```
 <xsl:variable name="result" >
            <xsl:apply-templates select="$vNodeSet" mode="myeval">
                <xsl:with-param name="expression" ><xsl:value-of select="$expression"/></xsl:with-param>
                <xsl:with-param name="pos" ><xsl:value-of select="$pos"/></xsl:with-param>
            </xsl:apply-templates>
        </xsl:variable> 
```

apply-templates 将合适的“当前节点列表”推送到以下模板：

```
 <xsl:template match="*" mode="myeval">
    <xsl:param name="expression">1\. </xsl:param>
    <xsl:param name="pos">3</xsl:param>

    <xsl:choose>
        <xsl:when test="position()=$pos">
            <xsl:value-of select="dyn:evaluate($expression)" /></xsl:when>
        <xsl:otherwise /> 
    </xsl:choose>

  </xsl:template> 
```

此模板评估我想成为“当前节点”的节点的表达式。注意：

1.  dy:evaluate 的使用（感谢 Martin！）
2.  $pos 标识我想要的当前节点。

我能够使用[Dimitre](https://stackoverflow.com/a/3562716/1031689)对较早问题的回答来计算 $pos；我还使用了他的变量名 vNodeSet

感谢 Dimitre、Martin 和 Michael！

# objective-c - 如何在 iOS 中使用 twitvid 在 Twitter 上上传视频？

> ID：11452989
> 
> 赞同：2
> 
> 时间：2012-07-12T13:34:01.560
> 
> 标签：objective-c, ios

我想使用 twitvid api 在 Twitter 上上传视频。我找到了这个“http://twitvid.pbworks.com/w/file/44841746/TwitVidSDK-iOS.zip”，但再次面临错误“'upload' REQUEST '87c60K0W' DID FAIL WITH ERROR: Error Domain=TVErrorBackendDomain Code= 1001 “无法使用 OAuth 进行身份验证。” UserInfo=0x6d33670 {NSLocalizedDescription=无法使用 OAuth 进行身份验证。}”。对不起我的英语不好。我无法跟踪错误...请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-13T09:33:49.563

您需要在 twitter 中创建一个开发者帐户，然后创建您的应用程序。您将获得密钥和应用程序密钥。使用此密钥来验证您的应用程序，然后通过 twitter api 您可以上传视频。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T09:59:06.437

我认为您必须创建一个新的 Twitter 应用程序，然后您将在此应用程序的详细信息中看到 Consumer Key、Consumer Secret、Token Key ...。之后，在 TwitVidSampleViewController.m 中替换它们并重新开始运行。

# php - 联系表格 PHP 代码未发送“选择”菜单

> ID：11452990
> 
> 赞同：0
> 
> 时间：2012-07-12T13:34:03.760
> 
> 标签：php, html, drop-down-menu, html-select

我在下面有一个下拉菜单“选择”的 HTML 代码，在它下面是用于发送所选选项的 PHP。我找不到它为什么不发送它。

```
<p class="input-block">
    <label for="contact-enquirytype">
        <strong>Drop Menu</strong>
    </label>

    <select for="contact-enquirytype">
        <option type="select" value="Option 1" name="enquirytype" id="contact-enquirytype-1">
            Option 1
        </option>
        <option type="select" value="Option 2" name="enquirytype" id="contact-enquirytype-2">
            Option 2
        </option>

        <option type="select" value="Option 3" name="enquirytype" id="contact-enquirytype-3">
            Option 3
        </option>
    </select>
</p> 
```

和 PHP：

```
$select_enquirytype = strip_tags($_POST['enquirytype']); 
```

我有其他输入文本和收音机正在发送正常，只有下拉列表没有发送。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T13:35:29.983

该`name`属性必须在`<select>`标签中：

```
<select name="enquirytype"> 
```

然后，您必须将其从`<option>`标签中删除

```
<option value="Option 1" id="contact-enquirytype-1"> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T13:35:27.270

您的 select 元素没有 name 属性。

更改：`<select for="contact-enquirytype">`为`<select name='enquirytype'>`。for 属性在这里没用。此外，您的选项标签不需要名称属性，也不需要类型属性。正确的方法是：

```
<select name="enquirytype">
    <option value="Option 1" id="contact-enquirytype-1">Option 1</option>
    <option value="Option 2" id="contact-enquirytype-2">Option 2</option>
    <option value="Option 3" id="contact-enquirytype-3">Option 3</option>
</select> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-12T13:38:00.863

您的选择远不正确。它应该如下：

```
<select name="enquirytype">
    <option value="1">Option 1</option>
    <option value="2">Option 2</option>
    <option value="3">Option 3</option>
</select> 
```

不要学究气，但如果您不确定任何事情，请阅读[W3C 的 HTML 元素指南。](http://www.w3.org/wiki/HTML/Elements)

# jsf - 标签在 facelets 中不起作用

> ID：11452992
> 
> 赞同：0
> 
> 时间：2012-07-12T13:34:09.220
> 
> 标签：jsf, jakarta-ee, jsf-2, facelets

大家好，我遇到了一个非常奇怪的问题。我创建了一个客户端模板 facelet 和模板 facelet。但是当我运行我的网页时，它不会插入定义的标签。我的意思是不工作。这是我的代码
insert.xhtml：

```
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets">
<head>
   <title>facelet example </title>
</head>
<body> 
  <ui:insert name="face1"> </ui:insert>
  <ui:insert name="face2"> </ui:insert>
  <ui:insert name="face3"> </ui:insert>
  <ui:insert name="face4"> </ui:insert>
</body>
</html> 
```

撰写.xhtml：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
   xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html">
<body>
   <ui:composition template="insert.xhtml">
   <ui:define name="face1">
   <center><h2>Facelet</h2></center>
   <h3>Welcome to the Facelet world..........</h3>
  </ui:define>
  <ui:define name="face2">Enter UserID :<br/>
   <h:inputText id="it" /><br/><br/>
   </ui:define>
   <ui:define name="face3">Enter Password :<br/>
   <h:inputSecret id="is" /><br/><br/>
   </ui:define>
  <ui:define name="face4">
   <h:commandButton id="b" value="Submit" />
  </ui:define>
   </ui:composition>
</body>
</html> 
```

但是当我`<include src="compose.xhtml">`在 insert.xhtml 中使用标签时，它会显示完整的 facelet。但包含标签只有在我这样写时才有效

```
<insert name="face1">
<include src="compose.xhtml"/>
</insert> 
```

如果我在包含之前删除`insert`标签，那么包含也不起作用。我对 JSF 2.0 facelets 的这种奇怪行为感到恶心。请帮助我
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T00:45:04.720

尝试遵循本教程，如果您是 JSF 2 模板的新手，这将非常有帮助。[这是链接](http://www.mkyong.com/jsf2/jsf-2-templating-with-facelets-example/)。

我认为问题出在您尝试使用的模板的路径中：

```
<ui:composition template="insert.xhtml"> 
```

应该 ：

```
<ui:composition template="/insert.xhtml"> 
```

如果模板在根文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T05:03:02.987

首先，您需要了解标签中的“模板”属性是可选的，因此这意味着您的代码中有一个小错误。正如您所知，facelet 将仅包含标签之间的部分，所以

```
xmlns="http://www.w3.org/1999/xhtml" 
   xmlns:ui="http://java.sun.com/jsf/facelets" 
  xmlns:h="http://java.sun.com/jsf/html" 
```

这应该带有组合而不是在 html 标记中。
你的问题类似于[这个问题](https://stackoverflow.com/questions/4792862/how-to-include-another-xhtml-in-xhtml-using-jsf-2-0-facelets)。我希望这对你也有帮助。
谢谢

# c# - Expression.Call 用法

> ID：11452996
> 
> 赞同：2
> 
> 时间：2012-07-12T13:34:23.857
> 
> 标签：c#, expression-trees

我尝试`ToLower`使用以下表达式调用将字符串转换为大小写。

```
var tolowerMethod = typeof(string).GetMethods().Where(m => m.Name == "ToString").FirstOrDefault(); 
var toLowerMethodCall = Expression.Call(memExp,tolowerMethod,new Expression[0]); 
```

我面临一些问题来创建一个表达式调用来格式化一个值，比如：`"05/12/2012 12:00:00"`to `{0:MM/dd/yyyy}`。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-12T14:21:33.917

那么没有这样的方法可以采用一种格式的日期字符串并将其重新格式化为另一种格式。您必须将该字符串转换为 a`DateTime`然后再转换回 a `string`。

以下是创建这样一个 lambda 的方法：

```
var dateStr = Expression.Parameter(typeof(string));
var asDateTime = Expression.Call(typeof(DateTime), "Parse", null, dateStr); // calls static method "DateTime.Parse"
var fmtExpr = Expression.Constant("MM/dd/yyyy");
var body = Expression.Call(asDateTime, "ToString", null, fmtExpr); // calls instance method "DateTime.ToString(string)"
var lambdaExpr = Expression.Lambda<Func<string, string>>(body, dateStr); 
```

然后编译并调用它。

```
var method = lambdaExpr.Compile();
method("05/12/2012 12:00:00"); // "05/12/2012" 
```

# mysql - MySQL 查询 - 子句 `where (varchar)` 返回仅以数字开头的项目。为什么？

> ID：11452999
> 
> 赞同：5
> 
> 时间：2012-07-12T13:34:27.930
> 
> 标签：mysql, sql

我有一个有趣的结果，但不明白为什么。

```
SELECT * 
  FROM items im
 WHERE ItemNumber 
```

`ItemNumber`是一个`varchar(50)`。

此查询的结果是返回所有`ItemNumber`以数字开头的项目。如果`ItemNumber`以字母开头，则将其排除在外。

有没有人解释为什么查询以这种方式交互？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T13:41:45.930

这是 MySQL 的聪明策略，并假设它知道你的意思（而不是做你写的）。

任何计算结果为非零的表达式都被认为是真的。那些以字母开头的项目不能（隐含地）转换为数字，因此它被认为是零，因此是“假”。我认为具有（字符）值`'0'`的项目也被排除在外。

例如，以下语句将愉快地删除表中的所有行：

```
DELETE FROM foobar
WHERE 42; 
```

您无法关闭此行为。即使在 ANSI 模式下，MySQL 也不会抛出语法表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:45:22.643

MYSQL 将返回 ItemNumber 以数字开头的所有行`greater than equal to 0.5 and less than equal to -0.5`。它考虑所有数字`greater >= +/-0.5 as true`。And`where`子句仅基于 true 或 false 起作用。

```
true >= -0.5  > false < 0.5 <= true 
```

*非常聪明，mysql*将所有`>= +/-0.5`数字视为 1（真）。对于**四舍五入的非零值**，它是**true**。

 **如果你写

```
SELECT * FROM items im WHERE 1; // will return all rows.
SELECT * FROM items im WHERE 0.5; // will return all rows.
SELECT * FROM items im WHERE 0.4; // will return nothing.
SELECT * FROM items im WHERE 1 and 0.2; // will return nothing.
SELECT * FROM items im WHERE 0.3 or 0.5; // will return all rows. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:37:54.263

您的 WHERE 子句正在等待 BOOLEAN，我现在不知道 mysql 如何管理数字 varchar，但我认为 mysql 可能会假设数字起始字符串等于 true。它可以将查询解释为

```
SELECT * 
  FROM items im
  WHERE ItemNumber IS TRUE 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T13:47:02.777

MySQL 支持这个应该被删除的布尔值。它会导致混乱，并会返回错误/意外的结果。没有其他 RDBMS 支持这一点。假设您有一个带有参数的过程，但您忘记指定它，如下所示

```
WHERE col 
```

它将返回所有数据并且很难调试

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-12T13:38:24.593

也许您应该将 ItemNumber 与某些东西进行比较。或者试试

```
WHERE ItemNumber NOT NULL 
```

或类似的东西

```
WHERE ItemNumber != '' 
```**