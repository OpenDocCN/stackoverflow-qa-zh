# StackOverflow 问答 10033000-10033999

# ruby-on-rails-3 - 如何从 rails 3 route 找到控制器和操作

> ID：10033000
> 
> 赞同：1
> 
> 时间：2012-04-05T17:14:05.333
> 
> 标签：ruby-on-rails-3, routing

这基本上是[这个问题](https://stackoverflow.com/questions/3481731/reverse-rails-routing-find-the-the-action-name-from-the-url)的 rails 3 版本。没有自己解析，如何从 URL 字符串中获取组件（控制器、操作、参数）？

该方法`ActionController::Routing::Routes#recognize_path`已被[弃用](http://apidock.com/rails/ActionController/Routing/RouteSet/recognize_path)，我无法让它被替换的方法以相同的方式工作：

```
1.9.3p125 :019 > ActionDispatch::Routing::RouteSet.recognize_path('/accounts/new', {:method => :get})
NoMethodError: undefined method `recognize_path' for ActionDispatch::Routing::RouteSet:Class 
```

这是有道理的，因为它不是静态方法。查看源代码也没有启发我。欢迎任何指点。

编辑：

```
ruby 1.9.3p125 (2012-02-16 revision 34643) [x86_64-darwin11.3.0]
Rails 3.2.3 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T17:50:08.853

这对我有用（Ruby 1.9.2，Rails 3.1.0）：

```
Rails.application.routes.recognize_path('/accounts/new', {:method => :get}) 
```

# javascript - 使用 jquery 从 HTML5 数据元素获取并执行函数 + 参数

> ID：10033004
> 
> 赞同：0
> 
> 时间：2012-04-05T17:14:30.687
> 
> 标签：javascript, jquery, html

我正在制作一个 phonegap 程序，我想使用一个`.on('tap')`事件而不是`onClick="blah(param1,param2)"`因为 400 毫秒的延迟。我想要做的是给一个“可点击”项目列表一个“button1”类，并为每个项目给它一个`data-meth="dosomething3()"`，然后在点击某物时检索它。到目前为止，我的示例没有使用点击，而是点击。

```
 <script>
    $(document).ready(function() {
    console.log('document ready');
    $(".button1").on('click', function(e){ //this will changed to 'tap' eventually
    e.preventDefault();
    console.log("logged click");
    var tempp=$(this).data("meth");
    alert(tempp);
    tempp; // thought this would call the function as it is written in the data-meth value but it doesn't
    });

    });
    function dosomething(){
    console.log('dosomething called');

    }
function dosomething(var1,var2){
alert('hello:' +var1+' just showing var2'+var2);
}

    </script>

My simple html is 

    <ul>
    <li style="text-align:center" class="button1" data-meth="dosomething()" >One</li>
    <li style="text-align:center"  class="button1" data-meth="dosomething2(var1,var2)">Two</li>
    <li style="text-align:center" class="button1" data-meth="dosomething3()">Three</li>
    </ul> 
```

我如何获取并调用基于函数的函数或存储在 data-meth 值中的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:20:08.170

在我的头顶上：

```
$(".button1").click(function() {
    var functionName = $(this).attr("data-meth").split("(")[0];
    var functionParams = $(this).attr("data-meth").split(")")[0].split[","];
    window[functionName](functionParams);
});​ 
```

`functionParams`将是一个包含您的值的数组。这可能是也可能不是你需要的。你也可以`eval`像这样使用ever-evil：

```
$(".button1").click(function() {
    eval($(this).attr("data-meth"));
});​ 
```

在这种情况下，您可以传入您的参数并像往常一样对待它们。

# ruby-on-rails - 保存/更新具有嵌套属性和单表继承的模型

> ID：10033015
> 
> 赞同：0
> 
> 时间：2012-04-05T17:15:19.777
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nested-attributes, single-table-inheritance

我有一个模型，`ModelRun`接受另一个模型的嵌套属性，`ParameterValue`。( `ModelRun has_many :parameter_values`.) 但是，`ParameterValue`也使用单表继承来保存两个子类：`NumericParameter`和`FileParameter`. `FileParameter`使用[CarrierWave](https://github.com/jnicklas/carrierwave)存储文件。

问题在于，在`ModelRunController`保存或更新 a`ModelRun`时，默认情况下`@model_run.save`或`@model_run.update_attributes`不识别`ParameterValue`属性的类型 - 它只是尝试将它们存储为`ParameterValue`. 这适用于`NumericParameter`值，但它引发了一个例外，`FileParameters`因为[CarrierWave 上传器没有被挂载](https://stackoverflow.com/a/8310758/81554)来处理文件上传，因此 ActiveRecord 在尝试将文件序列化到数据库时失败。

处理这个问题的最干净的方法是什么？我想到的唯一解决方案是在控制器和方法中手动填充`@model_run.parameter_values`集合，因为我可以分辨每个应该是哪种类型并一个一个地创建正确的对象。然而，这似乎重新实现了很多 Rails 魔法，因为我不能只使用或不再使用 - 似乎它首先放弃了使用的大部分优势。有没有更好的方法，Rails Way™？`create``update``ParameterValue``ModelRun.new(params[:model_run])``@model_run.update_attributes``accepts_nested_attributes_for`

每个模型的相关部分复制如下。

### 模型运行.rb

```
class ModelRun < ActiveRecord::Base
  has_many :parameter_values, dependent: :destroy

  accepts_nested_attributes_for :parameter_values, allow_destroy: true

  attr_accessible :name, 
                  :description, 
                  :geometry_description, 
                  :run_date, 
                  :run_date_as_string, 
                  :parameter_values_attributes
end 
```

### 参数值.rb

```
class ParameterValue < ActiveRecord::Base
  belongs_to :model_run

  attr_accessible :type,
                  :parameter_id, 
                  :description, 
                  :numeric_value,
                  :model_run_id,
                  :parameter_file
end 
```

### 数字参数.rb

```
class NumericParameter < ParameterValue
  attr_accessible :numeric_value
end 
```

### 文件参数.rb

```
class FileParameter < ParameterValue
  mount_uploader :parameter_file, ParameterFileUploader

  attr_accessible :parameter_file
end 
```

### 参数文件上传器.rb

```
class ParameterFileUploader < CarrierWave::Uploader::Base
  storage :file

  def store_dir
    "#{Rails.root}/uploads/#{model.class.to_s.underscore}/#{model.id}"
  end

  def cache_dir
    "#{Rails.root}/tmp/uploads/cache/#{model.id}"
  end

end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T06:29:45.123

如果我很了解您，您正试图通过传递：type? 来找到在 STI 层次结构中实例化正确子类的便捷方法。如果您以后不需要更改类型，您可以将此技巧添加到您的 ParameterValue 类

```
class ParameterValue < ActiveRecord::Base
    class << self
      def new_with_cast(*attributes, &block)
        if (h = attributes.first).is_a?(Hash) && !h.nil? && (type = h[:type] || h['type']) && type.length > 0 && (klass = type.constantize) != self
          raise "wtF hax!!"  unless klass <= self
          return klass.new(*attributes, &block)
        end

        new_without_cast(*attributes, &block)
      end
      alias_method_chain :new, :cast

    end
  end 
```

在此之后，传递正确的类型将导致正确的ParameterValue instatntiating，包括上传者，验证等。

# php - 在同一个查询中两次使用 INNER JOIN

> ID：10033020
> 
> 赞同：4
> 
> 时间：2012-04-05T17:15:54.457
> 
> 标签：php, mysql

我仍在尝试掌握 SQL。我构建了 1 个查询，从 filter_thread（包含 'filter_id' 和 'thread_id' 列）表和 filter（'filter_id 和 'tag'）表中提取 thread_id's

然后，我使用完全不同的查询来查找包含“thread_id”的线程表内容。

我意识到这不是最好的方法，但无法获得成功的查询。有人能帮忙吗？

```
$query = "SELECT ft0.thread_id 
FROM filter f0 
INNER JOIN filter_thread ft0 ON ft0.filter_id = f0.filter_id 
WHERE f0.tag LIKE '%filter1%' 
OR f0.tag LIKE '%filter2%'"
$result = $query->result_array();
$thread = array();
foreach ($result as $thread_id)
{
   $id = $thread_id['thread_id'];
   $query = $this->db->query("SELECT * FROM thread WHERE thread_id='$id'");
   $thisRow = $query->result_array();
   array_push($thread, $thisRow[0] );
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T17:22:22.013

您可以在单个查询中执行此操作，如下所示：

```
SELECT t.*
  FROM filter AS f0
 INNER JOIN filter_thread AS ft0
    ON ft0.filter_id = f0.filter_id
 INNER JOIN thread AS t
    ON ft0.thread_id = t.thread_id
 WHERE f0.tag LIKE '%filter1%'
    OR f0.tag LIKE '%filter2% 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:20:27.963

```
select t.x, t.y, ... from thread t
inner join filter f on f.thread_id = t.thread_id
inner join filter_thread ft on ft.filter_id = f.filter_id
where bla bla 
```

也许有一些团体...？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T08:18:35.543

试试这个

```
SELECT t.*, f0.*
FROM filter f0 
INNER JOIN filter_thread ft0 ON ft0.filter_id = f0.filter_id 
INNER JOIN thread t ON t.thread_id = ft0.thread_id 
WHERE f0.tag LIKE '%filter1%' 
OR f0.tag LIKE '%filter2%'"
GROUP BY f0.filter_id 
```

# wordpress - 如何根据标题值在 Wordpress 中显示帖子附件

> ID：10033021
> 
> 赞同：0
> 
> 时间：2012-04-05T17:15:56.407
> 
> 标签：wordpress, attachment, caption, qtranslate

我想根据我博客的语言（法语和英语）自动显示帖子附件（PDF）。

当帖子以法语版本显示时，我想显示法语 PDF，当帖子以英文显示时，我想显示英文版。

我使用 qtranslate 插件，但我使用附件的标题（“fr”或“en”）来创建一种条件标签。

我尝试了下面的代码，但它不起作用。你有什么想法可以帮助我吗？

非常感谢，德姆。

```
<!-- PDF EN -->
<?php if(qtrans_getLanguage()=='en'): ?>
    <?php
        if ( $attachments = get_children( array(
            'post_type' => 'attachment',
            'post_mime_type' => array('application/doc','application/pdf','application/msword'),
            'numberposts' => 1,
            'post_status' => null,
            'post_parent' => $post->ID,
            ))) ;
            foreach ($attachments as $attachment) {
            if ($attachment->post_excerpt == 'en') {
                echo '<a href="' . wp_get_attachment_url( $attachment->ID ) . '"><img src="' .get_bloginfo('template_directory') . '/images/pdf.png" alt="Pdf" class="pdf" /></a>';
                echo '';
            }
            }
    ?>
<?php endif; ?>
<!-- PDF FR -->
<?php if(qtrans_getLanguage()=='fr'): ?>
    <?php
        if ( $attachments = get_children( array(
            'post_type' => 'attachment',
            'post_mime_type' => array('application/doc','application/pdf','application/msword'),
            'numberposts' => 1,
            'post_status' => null,
            'post_parent' => $post->ID,
            ))) ;
            foreach ($attachments as $attachment) {
            if ($attachment->post_excerpt == 'fr') {
                echo '<a href="' . wp_get_attachment_url( $attachment->ID ) . '"><img src="' .get_bloginfo('template_directory') . '/images/pdf.png" alt="Pdf" class="pdf" /></a>';
                echo '';
            }
            }
    ?>
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-30T17:19:40.090

我创建了一个简单的修复程序，允许您使用 Wordpress qTranslate 插件选择多媒体文件的语言

[https://github.com/rafaelcalleja/qTranslateMultimediaLanguage](https://github.com/rafaelcalleja/qTranslateMultimediaLanguage)

# javascript - 用jQuery替换一个元素而不是另一个元素

> ID：10033022
> 
> 赞同：0
> 
> 时间：2012-04-05T17:16:03.363
> 
> 标签：javascript, jquery

我想在运行页面时替换一个（或每个）元素（数字）而不是类中的另一个元素（数字）。

我尝试使用以下代码但不正确，我该怎么办？

**演示：http:** [//jsfiddle.net/yMnDt/](http://jsfiddle.net/yMnDt/)

```
<div class="myGrid">
    1
    <p>
    123145
</div>​

$(".myGrid").clone().find('1').replaceWith( "8" ); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:32:35.610

如果您只想用 8 替换数字 1 您需要进行以下更改

> *   您需要在跨度标签中输入“1”

请检查以下链接

[http://jsfiddle.net/8nrS2/1/](http://jsfiddle.net/8nrS2/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:23:00.093

这是你想要的吗？[http://jsfiddle.net/yMnDt/7](http://jsfiddle.net/yMnDt/7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:43:17.977

这使用 replaceWith 并且正文中没有警报 [http://jsfiddle.net/T2GAZ/](http://jsfiddle.net/T2GAZ/)

# java - 如何使用发送的项目特定数据切换活动

> ID：10033024
> 
> 赞同：2
> 
> 时间：2012-04-05T17:16:25.297
> 
> 标签：java, android

我环顾四周，可能是因为我不确定我在寻找什么，但我不知道如何做一些我认为在 android 上应该很容易的事情。

我有一组数据要显示在屏幕上。该数据是一个包含数据库键、名称和图像的类。

我目前将此数据显示为 ImageView 和 TextView。我遍历数组并将新行添加到包含图像和文本的 TableLayout。

我希望图像和文本都可以点击，变成一个新的活动。

这个新活动需要知道所单击行的数据库键才能显示正确的数据。

这是我到目前为止所拥有的：

```
private void fillSuggestionTable(TableLayout tabSuggestions, Suggestion[] arrToAdd)
{
    for(int i = 0; i < arrToAdd.length; i++)
    {
        /* Create a new row to be added. */
        TableRow trSuggestion = new TableRow(this);
        trSuggestion.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));

        /* Create objects for the row-content. */
        ImageView imgDisplayPicture = new ImageView(this);
        ImageHandler.loadBitmap(arrToAdd[i].strImageURL, imgDisplayPicture);
        imgDisplayPicture.setLayoutParams(new LayoutParams(50,50));

        TextView txtArtistName = new TextView(this);
        txtArtistName.setText(arrToAdd[i].strName);
        txtArtistName.setTextColor(Color.parseColor("#000000"));

        /* Add data to row. */
        trSuggestion.addView(imgDisplayPicture);
        trSuggestion.addView(txtArtistName);

        /* Add row to TableLayout. */
        tabSuggestions.addView(trSuggestion, new TableLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:32:35.373

要将额外数据传递给另一个 Activity，您需要使用 Intent.putExtra(name, value) 方法添加额外信息。

例如，发送 Intent：

```
Intent i = new Intent([pass info about next Activity here]);
i.putExtra("databaseKey", databaseKey);
startActivity(i); 
```

再次获取数据：

```
public void onCreate(Bundle savedInstance)
{
    // Do all initial setup here

    Bundle extras = getIntent().getExtras();
    if (extras != null && extras.containsKey("databaseKey"))
    {
        int databaseKey = extras.getInt("databaseKey");
        // Load database info
    }
    else
    {
        // No data was passed, do something else
    }
} 
```

编辑：要找出何时单击表的行，您需要实现 View.OnClickListener 并为您使用的 TableRows 设置 onClickListener。

例如：

```
/* Create a new row to be added. */
TableRow trSuggestion = new TableRow(this);
trSuggestion.setOnClickListener([listener]); 
```

您将遇到的唯一问题是将视图的 ID 与相关的数据库行 ID 相关联。HashMap 应该会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:34:14.697

您使用 TableView 是否有原因？[使用ListView](http://developer.android.com/resources/tutorials/views/hello-listview.html)和自定义[CursorAdapter](http://developer.android.com/reference/android/widget/CursorAdapter.html)似乎您想要完成的工作会容易得多，适配器可以处理从数据库到 ListView 行的转换。此时开始一个知道数据库 ID 的新活动是微不足道的：

```
mListView.setOnItemClickListener(new OnItemClickListener() {
  @Override
  public void onItemClick (AdapterView<?> parent, View view, int position, long id) {
    Intent i = new Intent(MyActivity.this, MyOtherActivity.class);
    i.putExtra("database_id", id);
    startActivity(i);
  }
}); 
```

在 MyOtherActivity 中：

```
private int dbId;
protected void onCreate(Bundle savedInstanceState) {
  //do stuff
  dbId = getIntent().getIntExtra("database_id", -1); // the -1 is the default if the extra can't be found
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:33:28.153

这是一个非常简单的过程。[这个博客](http://www.anotherandroidblog.com/2011/05/27/passing-data-with-an-intent/)用简单的术语解释它。

# android - 尝试从 ArrayList 中删除对象时崩溃

> ID：10033025
> 
> 赞同：0
> 
> 时间：2012-04-05T17:16:27.123
> 
> 标签：android, object, crash, arraylist

我有一个问题，我无法找到解决方案。我正在制作一个小游戏，如果 _sballs ArrayList 中的对象与另一个名为 ball 的对象发生碰撞，将被删除。我遇到的问题是，当发生冲突时，当我尝试从 ArrayList 中删除对象时，应用程序崩溃。

```
for(GObject sballgraphic : _sballs){
            Coordinates sballcoords = sballgraphic.getCoords();
            if(coords.getY() - coords._height > sballcoords.getY() + sballcoords._height && coords.getX() - coords._width > sballcoords.getX() + sballcoords._width){
                _sballs.remove(sballgraphic);
            }
        } 
```

因此代码将球坐标与所有球对象进行比较，以检查是否存在碰撞，然后尝试移除球。

这里有什么问题？:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T17:22:25.720

我猜“崩溃”是一个`ConcurrentModificationException`.

发生这种情况是因为您在使用迭代器迭代集合时尝试从集合中删除（增强 for 的内部工作原理）。

您的选择是：

1.  使用索引进行迭代（旧式`for( i=0; i<_sballs.size(); i++ )`）
2.  显式使用迭代器进行迭代，并使用迭代器的`remove()`方法。
3.  通过将它们放入另一个列表来记住要删除的项目，然后`removeAll()`在循环完成后使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:20:36.567

你不能做这样的操作，因为你正在修改`_sballs`你正在迭代的那个。

```
ArrayList<GObject> _sballs;
ArrayList<GObject> _sballsForRemove;

for(GObject sballgraphic : _sballs){
            Coordinates sballcoords = sballgraphic.getCoords();
            if(coords.getY() - coords._height > sballcoords.getY() + sballcoords._height && coords.getX() - coords._width > sballcoords.getX() + sballcoords._width){
                _sballsForRemove.add(sballgraphic);
            }
        }
_sballs.removeAll(_sballsForRemove); 
```

# javascript - 如何将值 1 赋予带有类的文本框

> ID：10033026
> 
> 赞同：-2
> 
> 时间：2012-04-05T17:16:27.477
> 
> 标签：javascript

我想知道下面的代码是否将所有`input type='text'`值删除回`""`：

```
var inp = document.getElementsByTagName('input');
for (var i = inp.length - 1; i >= 0; i--) {
    if ('text' === inp[i].type) inp[i].value = "";
} 
```

然后我想知道我是否有一个`input`which is `type='text'`but which `class`is `.num_questions`。我如何对其进行编码，以便它查找类名并为其赋值`"1"`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:39:43.213

`className`Html Dom 元素上有一个属性。

```
function hasCssClass(elt,clz) {
    return elt.className.match(new RegExp('(\\s+|^)'+clz+'(\\s+|$)'));
}

var inp = document.getElementsByTagName('input'); 
for (var i = inp.length-1; i>=0; i--) { 
  if ('text'===inp[i].type && hasCssClass(inp[i],'num_questions')) {
       inp[i].value = "?"; 
  }
} 
```

[http://jsbin.com/aluzuv/2](http://jsbin.com/aluzuv/2)

**编辑**- 按要求跟进。

每个 HTML DOM 元素都有一个`className`属性，它是一个字符串，包含一个以空格分隔的 CSS 类*列表*，这些类适用于该元素。为了确定一个类是否适用于特定元素，您需要在列表中搜索该字符串。

有几种方法可以做到这一点。一种方法是用空格分割 className 字符串，然后查看所需的类（针）是否等于结果字符串数组中的任何元素。这可能是这样的：

```
function hasCssClass(elt, clz) {
  var classes = elt.className.split(/\s+/);
  for(i=0; i<classes.Length;i++) {
     if (clz == classes[i]) return true;
  }
  return false;
} 
```

另一种方法是使用正则表达式匹配；这就是我所做的，因为对我来说它更简洁。我使用的正则表达式查找*something*，然后是类名，然后是*something else*。第*一个*是`(\\s+|^)`，它在英语中的意思是“一个或多个空白字符，或者，字符串的开头”。其他的*东西*是`(\\s+|$)`，在英语中是“一个或多个空白字符，或字符串的结尾”。因此，整个正则表达式匹配一个字符串，该字符串包括：

*   空格或字符串开头
*   所需的类名
*   空格或字符串结尾

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:39:42.643

好吧，我认为您的问题不应该被否决，在 javascript 中处理 classNames 并不容易。所以这是我的答案：

```
var inp = document.getElementsByTagName('input');
for (var i = inp.length-1; i>=0; i--) {
   if ('text'===inp[i].type) {
      if(inp[i].className.indexOf('num_questions') > -1){
         inp[i].value = "1";
      } else{
         inp[i].value = "";
      }
   }
} 
```

# bash - 如何在bash中制作* ='*'？

> ID：10033031
> 
> 赞同：1
> 
> 时间：2012-04-05T17:16:46.707
> 
> 标签：bash

我是 bash 脚本的新手，遇到以下问题：我正在尝试制作一个搜索脚本，让我可以使用 find 和/或 grep 以及可选参数搜索包含某个字符串的文件，但我被困住了最后一个问题，在所有情况下都不匹配条件的 * 字符。

我的脚本有 3 个参数：

*   string_to_search（必填）
*   文件名模式（可选）
*   路径（可选）

例子 ：

```
./search_text.sh 'string_to_search' 'file_name_pattern' /path 
```

我想得到以下内容：

*   如果未指定 file_name_pattern 或为 *（带或不带引号）=> grep
*   如果 file_name_pattern 不是 * 或 '*' => find + grep

这是我的代码：

```
#!/bin/bash

# ------------------------------------
# Set default values for optional parameters (tests)

if [ ! -z $2 ] 
then 
    FILE_TYPE=$2
    echo 'FILE_TYPE : var 2'
else
    FILE_TYPE="*"
    echo 'FILE_TYPE : *'
fi

if [ ! -z $3 ] 
then 
    LOCATION=$3
    echo 'LOCATION : var 3'
else
    LOCATION=.
    echo 'LOCATION : .'
fi

# ------------------------------------
# Do search / show conditions

if [ "$FILE_TYPE" == \* ];
  then 
    #grep -rn -C 0  --color=always  "$1" $LOCATION | less -R;
    echo ' => GREP';
  else
    #find $LOCATION -iname $FILE_TYPE | sort | xargs grep "$1" --color=always -n  2>/dev/null | less -R;
    echo '=> FIND';
fi 
```

只需运行此代码以在最后显示 2 个回声以进行测试。

**现在我的问题是：**

```
./search_text.sh 'string_to_search' '*.php' /path  => works (FIND)
./search_text.sh 'string_to_search' '*' /path      => works (GREP)
./search_text.sh 'string_to_search' '*'            => works (GREP)
./search_text.sh 'string_to_search' *              => ERROR => goes to FIND INSTEAD OF GREP :-(
./search_text.sh 'string_to_search'                => works (GREP) 
```

换句话说，我怎么能写出以下条件：

```
 if [ "$FILE_TYPE" == \* ]; 
```

这样在命令行中将这些值作为参数传递时，* 应该被视为与 '*' 相同吗？

即使用 \* 转义 * 当我们只将不带引号的 * 传递给脚本时，条件也不匹配。

换句话说，我想让 * 像在任何其他命令中一样被视为普通通配符，以便 * = '*'

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:28:00.810

当你用`*`bash 编写时，它被解释为当前目录中的文件匹配。因此，您的脚本实际上被调用了`./search_text.sh 'string_to_search' a.txt b.txt`（假设当前目录中只有两个文件，名为“a.txt”和“b.txt”）。因为 'a.txt' 不是 '*'，所以会执行您的查找代码。我知道防止它的唯一方法是用撇号（`'`）括起来——就像你做的那样——或者用反斜杠（'\'）转义它

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T17:32:58.847

您可以使用禁用所有全局扩展

```
 set -o noglob 
```

之后`*`并不特别：

```
$ ls *
ls: *: No such file or directory 
```

但是，在调用您的脚本之前，没有办法强制您的用户执行此操作。由于用户的外壳，而不是您的脚本，控制 globbing 您没有追索权。

你唯一的选择是治疗

```
./search_text.sh 'string_to_search' * 
```

完全一样

```
./search_text.sh 'string_to_search' file1 file2 
```

反正就是这样。

换句话说，当没有指定尾随目录并且`$1`不是文字时`*`使用这种`grep`情况。

# mysql - 如何从table2的id列中存在table1.id的table1中选择记录？

> ID：10033035
> 
> 赞同：1
> 
> 时间：2012-04-05T17:17:20.210
> 
> 标签：mysql

我有两张桌子

**人们**

```
name    id

man1    456
man2    123
man3    789 
```

**笔记**

```
content id

testing 123
hello   456 
```

`SELECT DISTINCT id FROM people`是 的超集`SELECT DISTINCT id FROM notes`。

我想写两个查询。一种从表中选择所有记录`people`，其中存在记录，`notes`其中 id 列中的`notes`值等于`people.id`。

```
name    id

man1    456
man2    123 
```

另一个从表中选择不存在`people`记录的所有记录，其中 id 列中的值等于`notes``notes``people.id`

```
content id

man3    789 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:24:12.260

```
SELECT * FROM PEOPLE WHERE ID IN (SELECT ID FROM NOTES) 
```

结果 Man1 456 & Man2 123

```
SELECT * FROM PEOPLE WHERE ID NOT IN (SELECT ID FROM NOTES) 
```

结果 Man3 789

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:20:24.110

```
--people with notes
select distinct p.id, p.name
from people p
inner join notes n on p.id = n.id

--people with no notes
select p.id, p.name
from people p
left outer join notes n on p.id = n.id
where n.id is null 
```

# asp.net - ASP.NET MS11-100：如何更改发布表单值的最大数量限制？价值=“10000000000”不工作

> ID：10033039
> 
> 赞同：0
> 
> 时间：2012-04-05T17:17:34.127
> 
> 标签：asp.net, .net, asp.net-mvc-3, post, web-config

我收到此错误消息。

```
Server Error in '/' Application.
Operation is not valid due to the current state of the object.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.InvalidOperationException: Operation is not valid due to the current state of the object.

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace:

[InvalidOperationException: Operation is not valid due to the current state of the object.]
   System.Web.HttpValueCollection.ThrowIfMaxHttpCollectionKeysExceeded() +2420322
   System.Web.HttpValueCollection.FillFromEncodedBytes(Byte[] bytes, Encoding encoding) +58
   System.Web.HttpRequest.FillInFormCollection() +159

[HttpException (0x80004005): The URL-encoded form data is not valid.]
   System.Web.HttpRequest.FillInFormCollection() +217
   System.Web.HttpRequest.get_Form() +104
   Microsoft.Web.Infrastructure.DynamicValidationHelper.<>c__DisplayClass8.<MakeCollectionsLazy>b__2() +12
   Microsoft.Web.Infrastructure.DynamicValidationHelper.<>c__DisplayClass12.<ReplaceCollection>b__e() +61
   Microsoft.Web.Infrastructure.DynamicValidationHelper.<>c__DisplayClass12.<ReplaceCollection>b__11() +17
   Microsoft.Web.Infrastructure.DynamicValidationHelper.DeferredCountArrayList.get_Count() +17
   System.Collections.Specialized.NameObjectCollectionBase.get_Count() +15
   System.Web.HttpRequest.ValidateNameValueCollection(NameValueCollection nvc, RequestValidationSource requestCollection) +23
   System.Web.HttpRequest.get_Form() +150
   System.Web.HttpRequestWrapper.get_Form() +11
   System.Web.Mvc.HttpRequestExtensions.GetHttpMethodOverride(HttpRequestBase request) +126
   System.Web.Mvc.AcceptVerbsAttribute.IsValidForRequest(ControllerContext controllerContext, MethodInfo methodInfo) +41
   System.Web.Mvc.HttpGetAttribute.IsValidForRequest(ControllerContext controllerContext, MethodInfo methodInfo) +40
   System.Web.Mvc.<>c__DisplayClass11.<RunSelectionFilters>b__d(ActionMethodSelectorAttribute attr) +24
   System.Linq.Enumerable.All(IEnumerable`1 source, Func`2 predicate) +145
   System.Web.Mvc.ActionMethodSelector.RunSelectionFilters(ControllerContext controllerContext, List`1 methodInfos) +319
   System.Web.Mvc.ActionMethodSelector.FindActionMethod(ControllerContext controllerContext, String actionName) +59
   System.Web.Mvc.ReflectedControllerDescriptor.FindAction(ControllerContext controllerContext, String actionName) +62
   System.Web.Mvc.ControllerActionInvoker.FindAction(ControllerContext controllerContext, ControllerDescriptor controllerDescriptor, String actionName) +16
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +105
   System.Web.Mvc.Controller.ExecuteCore() +116
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +37
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +21
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +12
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +50
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8969201
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

我已经尝试过建议的修复

```
<appSettings>
   <add key="aspnet:MaxHttpCollectionKeys" value="1001" />
</appSettings> 
```

我试着把它放在一个疯狂的数字上

```
<add key="aspnet:MaxHttpCollectionKeys" value="10000000000" /> 
```

但它仍然给我同样的错误（我有很多字段但不是很多）。我正在使用 asp.net mvc 3（剃须刀）。我正在使用.net 4.0。

我通过 jquery ajax(seralizeArrary) 发送整个表单，所以我不知道这是否与它有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T09:37:45.790

使用更合理的值，例如`32000`, 这对我来说很好。

> 有没有办法将其限制为允许使用的形式而不是像现在看起来那样的全局形式？

不，我认为不可能按表单处理此设置。这是因为值在路由发生之前很早就被解析了，但只有在路由之后才能知道它属于什么“形式”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-02T06:31:31.957

以下是限制：

1.  MaxHttpCollectionKeys 是一个 int，所以它可以有一个整数的最大值 (int.MaxValue: 2,147,483,647)
2.  最小值为 1
3.  默认值为 1000

[![在此处输入图像描述](../Images/32f7ef79b9f08ba6ab5f0bf33e6582cd.png)](https://i.stack.imgur.com/itNkT.png)

[在 MSDN 上查看](https://msdn.microsoft.com/en-us/library/hh975440(v=vs.120).aspx)

# android - 在电话和 Kindle-Fire 上定位 Android 应用

> ID：10033050
> 
> 赞同：1
> 
> 时间：2012-04-05T17:19:09.387
> 
> 标签：android, kindle-fire

我会将我的应用程序定位到所有 android 设备，最好的方法是什么？到目前为止，我将针对 Android 手机和 Kindle-fire，这是我的想法。

android 手机及其在图像、字体大小等方面按预期工作......所以我想测试我的应用程序是否适合 kindle-fire：

使用以下规范为 kindle-fire 创建 AVD 模拟器，但我在 kindle-fire 上测试时遇到了一些问题：

1.  图像被拉伸（不确定是否应该为 kindle-fire 增加图像大小？）
2.  字体大小比安卓手机小（我已经测试过）
3.  我的活动中没有后退按钮，所以我假设用户将能够在 kindle-fire 中使用后退箭头按钮，但在模拟器中没有显示。

这是Kindle Fire的规格

*   宽度：600 像素
*   高度：1024px
*   抽象 LCD 密度：169
*   目标：Android 2.3.3 - API 级别 10
*   内存：512 MB

为了在 android 手机和 amazon kindle-fire 上的外观和感觉，我需要做什么？

我应该创建两个单独的项目并以字体大小和图像大小为目标吗？

我不确定我还需要考虑什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:37:40.100

对于字体，请务必使用`sp`度量单位。

对于图像，您可以将它们存储在不同的文件夹中，并使用不同的属性命名文件夹。

[http://developer.android.com/guide/topics/resources/providing-resources.html](http://developer.android.com/guide/topics/resources/providing-resources.html)

不过我会说，我很难区分 kindle 和我的 10 英寸平板电脑，因为它们都被 android 判断为很大。所以我只是为它们创建了不同的布局，并在 onCreate 中检查了屏幕大小。这是代码。

```
Display display = ((WindowManager)getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
if(display.getWidth() <= 600 || display.getHeight() <= 600) 
{
    this.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR_LANDSCAPE);
    setContentView(R.layout.kindle_fire_layout);
} 
else 
{       
    setContentView(R.layout.anything_else);     
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T18:51:28.980

要在模拟器上进行测试，请使用下面的代码来避免 android 将其识别为 xlarge 设备。然后，您可以将资源放在应有的位置。另请记住，kindle fire ui 会从栏的视图中移除一些像素等，因此您可能还需要考虑

```
final Configuration config = new Configuration(context.getResources().getConfiguration()); 
config.screenLayout = (config.screenLayout & Configuration.SCREENLAYOUT_LONG_MASK) + Configuration.SCREENLAYOUT_SIZE_LARGE; 
context.getResources().updateConfiguration(context.getResources().getConfiguration(), context.getResources().getDisplayMetrics()); 
```

# lossless-compression - 无损压缩JPEG gstreamer元素？

> ID：10033052
> 
> 赞同：1
> 
> 时间：2012-04-05T17:19:14.407
> 
> 标签：lossless-compression, gstreamer

下面的管道可以很好地保存压缩的 JPEG 图像，但是有没有办法使用 gstreamer 保存无损压缩的 JPEG 图像？

> gst-launch v4l2src always-copy=false num-buffers=1 chain-ipipe=true ！'视频/x-raw-yuv，格式=（fourcc）NV12，宽度=2176，高度=1944'！dmaiaccel ！dm365facedetect draw-square=true ！dmaienc_jpeg ！文件接收器位置=$FILE_NAME

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T01:29:05.990

假设您安装了所有 GStreamer 插件（好的、坏的和丑陋的），您可以通过 FFmpeg GStreamer 元素使用大量的无损视频压缩器。其中包括 ffenc_png（用于 PNG 编码）、ffenc_jpegls（无损 JPEG 算法）和许多不太常见的算法。

但是，如果我正确阅读了您的 GStreamer 命令行，您似乎正在调用一系列与特定类型的硬件相关的自定义组件（我一直在谷歌搜索，但我还没有完全确定它是什么）。JPEG 编码器组件是“dmaienc_jpeg”。链中它前面的元素 (dm365facedetect) 可能只输出 dmaienc_jpeg 可以解释的数据。但是，如果它是通用色彩空间，那么您可以通过 FFmpeg 无损编码器发送它，可能在两者之间进行色彩空间转换。可以通过对元素调用“gst-inspect”并研究输出（src 和 sink 数据类型）来确定答案。

**根据新数据更新：**好消息：dm365facedetect 元素以 NV12 格式输出原始 YUV。非常灵活，您有很多选择。

你在哪个平台？如果您使用的是 Ubuntu Linux，请使用以下命令安装一堆 GStreamer 插件：

```
apt-get install gstreamer0.10-plugins-good \
  gstreamer0.10-plugins-bad gstreamer0.10-plugins-ugly gstreamer0.10-ffmpeg 
```

一些无损编解码器选项：PNG，通过“pngenc”或“ffenc_png”（尽管从技术上讲，由于 YUV -> RGB 颜色空间转换，这可能会导致一点点损失）、“ffenc_huffyuv”、“ffenc_jpegls”或“ffenc_ljpeg”。当您对这些进行编码时，请通过 avimux 组件发送它们。因此，对命令行末尾的示例进行了修改：

```
... ! dm365facedetect draw-square=true ! ffenc_ljpeg ! \
  avimux ! filesink location=$FILE_NAME 
```

预计无损编解码器数据会比您之前获得的 JPEG 数据大一些。尝试使用不同的编解码器，看看你喜欢什么，并确保你可以使用你喜欢的工具链解码另一端的数据（FFmpeg 和 VLC 应该总是能够处理它）。

# python - 在 crontab 作业上使用 sudo 进行身份验证

> ID：10033057
> 
> 赞同：2
> 
> 时间：2012-04-05T17:19:53.480
> 
> 标签：python, crontab

我调用了一个 python 脚本，`sudo -u user_name python python_scipt.py`我需要使用 crontab 安排它每 30 分钟运行一次。问题是如何在 crontab 上使用 sudo 对其进行身份验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T20:14:57.510

一切都解决了`sudo crontab -u username -e`

学分到 9000

# ruby-on-rails - 使用触发器进行 Rails 测试

> ID：10033061
> 
> 赞同：5
> 
> 时间：2012-04-05T17:20:18.250
> 
> 标签：ruby-on-rails, ruby, testing

我注意到 Rails 在开发数据库中创建触发器而不是在测试数据库中创建触发器，因为它是从 schema.rb 创建测试数据库而不是运行迁移。我有一个触发器（作为迁移）并且需要测试它是否正确，我该怎么做？我尝试手动将触发器添加到测试数据库，但没有奏效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T18:22:59.737

默认情况下，rails 使用独立于数据库的 schema.rb 设置测试数据库，它不理解触发器之类的东西。

如果您更改`config.active_record_schema_format`为`:sql`then rails 将转储代表开发数据库结构的原始 SQL 并使用它来重新创建测试数据库。此转储放置在 development.sql 中，然后使用它代替 schema.rb

此转储是使用您的数据库提供的命令行工具完成的，因此将尊重活动记录不知道的触发器等功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T15:14:08.680

如果你更喜欢 Ruby 转储而不是 SQL 转储，你可以试试这个 gem：

[https://github.com/jovoto-team/trackless_triggers](https://github.com/jovoto-team/trackless_triggers)

它支持 mysql 的转储触发器和函数。

# android - 从 SDK 8 更改为 7 时自定义 ImageViews 消失

> ID：10033062
> 
> 赞同：0
> 
> 时间：2012-04-05T17:20:21.883
> 
> 标签：android, sdk

我一直在为 Android SDK 8 创建一个应用程序，它运行良好。由于大多数用户使用的是 SDK 7 及更高版本，我尝试切换到 SDK 7，但随后我的自定义 ImageViews 从我的 RelativeLayout 中消失了。该应用程序不会崩溃。**这可能是因为我使用了 SDK 8 中的一些框架吗？如果是这样：是否有一种简单的方法可以找出我的代码的哪一部分使用了 SDK 8（即不根据开发人员文档检查每个方法的 API 级别）？**

真的有太多代码在这里发布。我的清单文件包括

```
<uses-sdk   android:minSdkVersion="7"
            android:targetSdkVersion="7"> 
```

我的 project.properties 文件有这一行

```
target=android-7 
```

直到现在它们曾经是 8 个，但我把它们都改成了 7 个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:15:06.847

不确定这是否是您的问题，但要回答查找您正在使用的 API 是否高于最低 API 版本的一般问题：

更新到最新版本的 Android 开发者工具，并从命令行，从项目的根文件夹运行 lint。除其他外，它会检查“对所有目标 API 都不支持的 API 的 API 访问”。

有用的资源：

[lint 的开发人员工具页面](http://tools.android.com/tips/lint)
[Lint 检查的完整列表](http://tools.android.com/tips/lint-checks)

# objective-c - 以 Sprite 为中心的缩放图层

> ID：10033064
> 
> 赞同：0
> 
> 时间：2012-04-05T17:20:24.017
> 
> 标签：objective-c, cocos2d-iphone, zooming

我正在开发一个小游戏，其中一艘飞船穿过一个层（doh！），在某些情况下飞船靠近敌人，整个层在飞船上以缩放级别放大取决于船和敌人之间的距离。所有这一切都很好。

然而，主要的问题是，我如何保持变焦以飞船为中心？

目前我通过update方法控制GameLayer对象的缩放，代码如下：

```
-(void) prepareLayerZoomBetweenSpaceship{
    CGPoint mainSpaceShipPosition  = [mainSpaceShip position];
    CGPoint enemySpaceShipPosition = [enemySpaceShip position];

    float distance = powf(mainSpaceShipPosition.x - enemySpaceShipPosition.x, 2) + powf(mainSpaceShipPosition.y - enemySpaceShipPosition.y,2);
    distance = sqrtf(distance);

    /*
        Distance > 250 --> no zoom
        Distance < 100 --> maximum zoom
     */
    float myZoomLevel = 0.5f;
    if(distance < 100){ //maximum zoom in
        myZoomLevel = 1.0f;
    }else if(distance > 250){
        myZoomLevel = 0.5f;
    }else{
        myZoomLevel = 1.0f - (distance-100)*0.0033f;
    }

    [self zoomTo:myZoomLevel];
}

-(void) zoomTo:(float)zoom {
    if(zoom > 1){
        zoom = 1;
    }

    // Set the scale.
    if(self.scale != zoom){
        self.scale = zoom;
    }
} 
```

基本上我的问题是：如何缩放图层并将其准确地居中在两艘船之间？我想这就像用两根手指捏缩放！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:06:23.287

下面是一些应该让它为你工作的代码。基本上你想要：

1.  `parentNode`在的坐标系中更新您的船舶位置
2.  找出这些新位置将导致屏幕被绑定到哪个轴。
3.  缩放和重新定位`parentNode`

我添加了一些稀疏的评论，但如果您还有其他问题/问题，请告诉我。首先将其转储到测试项目中可能是最简单的......

**ivars 放入您的 CCLayer：**

```
CCNode *parentNode;
CCSprite *shipA;
CCSprite *shipB;
CGPoint destA, deltaA;
CGPoint destB, deltaB;
CGPoint halfScreenSize;
CGPoint fullScreenSize; 
```

**初始化要放入 CCLayer 的东西：**

```
CGSize size = [[CCDirector sharedDirector] winSize];
fullScreenSize = CGPointMake(size.width, size.height);
halfScreenSize = ccpMult(fullScreenSize, .5f);
parentNode = [CCNode node];
[self addChild:parentNode];

shipA = [CCSprite spriteWithFile:@"Icon-Small.png"]; //or whatever sprite
[parentNode addChild:shipA];

shipB = [CCSprite spriteWithFile:@"Icon-Small.png"];
[parentNode addChild:shipB];

//schedules update for every frame... might not run great.
//[self schedule:@selector(updateShips:)]; 

//schedules update for 25 times a second
[self schedule:@selector(updateShips:) interval:0.04f]; 
```

**Zoom / Center / Ship 更新方式：**

```
-(void)updateShips:(ccTime)timeDelta {
    //SHIP POSITION UPDATE STUFF GOES HERE
    ...

    //1st: calc aspect ratio formed by ship positions to determine bounding axis
    float shipDeltaX = fabs(shipA.position.x - shipB.position.x);
    float shipDeltaY = fabs(shipA.position.y - shipB.position.y);
    float newAspect = shipDeltaX / shipDeltaY;

    //Then: scale based off of bounding axis

    //if bound by x-axis OR deltaY is negligible
    if (newAspect > (fullScreenSize.x / fullScreenSize.y) || shipDeltaY < 1.0) { 
        parentNode.scale = fullScreenSize.x / (shipDeltaX + shipA.contentSize.width);
    } 
    else { //else: bound by y-axis or deltaX is negligible
        parentNode.scale = fullScreenSize.y / (shipDeltaY + shipA.contentSize.height);
    }

    //calculate new midpoint between ships AND apply new scale to it
    CGPoint scaledMidpoint = ccpMult(ccpMidpoint(shipA.position, shipB.position), parentNode.scale);
    //update parent node position (move it into view of screen) to scaledMidpoint
    parentNode.position = ccpSub(halfScreenSize, scaledMidpoint);
} 
```

另外，我不确定它在处理一堆事情时的表现如何——但那是一个单独的问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T10:14:49.583

你为什么不移动整个视图，并定位它，使船在屏幕的中心？我没有用你的例子试过，但它应该是直截了当的。也许是这样的——

```
CGFloat x = (enemySpaceShipPosition.x - mainSpaceShipPosition.x) / 2.0 - screenCentreX;
CGFloat y = (enemySpaceShipPosition.y - mainSpaceShipPosition.y) / 2.0 - screenCentreY;

CGPoint midPointForContentOffset = CGPointMake(-x, -y);

[self setContentOffset:midPointForContentOffset]; 
```

...您已经设置 screenCentreX 和 Y 的地方。我已经有一段时间没有使用 UISCrollView （一直在 Unity 中做一些事情，所以我忘记了所有的 Obj-C），我不记得如何contentOffset 受缩放级别的影响。试试看！（我假设您使用的是 UIScrollView，如果您不是，也许您也可以尝试）

# jquery - JSON.parse() 的语法错误

> ID：10033066
> 
> 赞同：4
> 
> 时间：2012-04-05T17:20:26.857
> 
> 标签：jquery, json

我从字符串中获取 json 的自定义方法：

```
function GetJSON(a) {
        if (typeof a !== "string" || !a || a == null) return null;
        a = a.replace(/\r\n|\r|\n|\t/g, '').replace(/\\/g, '/');
        return new Function("return " + a)();
    }

    var notes ='{editable:true,useAjax:false,notes:[{"top":76,"left":411,"width":30,"height":30,"text":"hill","editable":true},{"top":183,"left":556,"width":30,"height":30,"text":"lake","editable":true}]}';

    return GetJSON(notes); //<-- works fine

    //I am trying to replace my custom method with
      return JSON.parse(notes); 
```

但是当我调用 JSON.parse() 时出现语法错误

有什么问题？

编辑：我粘贴了从调试输出传递给 JSON.parse() 的实际值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:28:23.917

```
notes = "{editable:true,useAjax:false,notes:[" + notes + "]}"; 
```

你忘了在这里引用你的钥匙。它应该是：

```
notes = '{"editable":true,"useAjax":false,"notes":[' + notes + ']}'; 
```

最终的 JSON 应该是：

```
var notes ='{"editable":true,"useAjax":false,"notes":[{"top":76,"left":411,...' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:21:55.737

您的注释部分`,`在两组之间缺少 a `{}`，使其无效 JSON。

它应该是

```
[..snip..] "editable":true}, ' + '{"top":20,"left"[...snip...]
                           ^^--- missing 
```

# html - 我将如何扩展 bb-ruby gem 以使用扰流标签？

> ID：10033068
> 
> 赞同：0
> 
> 时间：2012-04-05T17:20:28.297
> 
> 标签：html, ruby, gem, libraries, bbcode

我正在做一个需要一些 bbcode 的小东西，我真的需要它有剧透标签。我通读了将我自己的标签添加到库中的示例，但我并不真正了解它是如何工作的。我想要扰流板标签做的只是有一个隐藏一些文本的可切换按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T03:50:04.960

对于 bb-ruby，当您调用 bbcode_to_html 作为第一个参数时，您似乎可以发送自己的标签定义......所以：

```
"Your string with [spoiler]spoiler[/spoiler]".bbcode_to_html(my_spoiler) 
```

my_spoiler 是：

```
my_spoiler = {
  'Spoiler' => [
    /\[spoiler\](.*?)\[\/spoiler\]/mi, # regex to match spoiler
    '<div class="spoiler"><a>Show Spoiler</a><p>\1</p></div>',   # what to output, change this if needed
    'Spoiler text',                    # description
    '[spoiler]this is a spoiler[/spoiler]', # sample
    :spoiler                           # actual tag used
  ]
} 
```

您需要将输出更改为您需要的内容，并且还需要使用 javascript 在 jQuery 中显示剧透：

```
$('.spoiler').each(function () {
  $(this).find('p').hide();
  $(this).find('a').click(function () {
    $(this).find('p').toggle();
  });
}); 
```

我注意到你说你也尝试过 bbcoder，因为我是作者，所以我也会发布如何做到这一点。对于 bbcoder，您需要在应用程序初始化中或开始解析实际字符串之前添加类似内容：

```
BBCoder.configure do
  tag :spoiler do
    <<-EOS
<div class="spoiler">
  <a>Show Spoiler</a>
  <p>#{content}</p>
</div>
    EOS
  end
end 
```

配置 BBCoder 后，您就可以开始使用了，它会从那时起知道扰流器标签并为您解析它，所以您只需要做

```
"My [spoiler]spoiler string[/spoiler]".bbcode_to_html 
```

我还没有测试过这些解决方案，但它们应该可以毫不费力地工作。

# python - Python。取消根目录

> ID：10033071
> 
> 赞同：2
> 
> 时间：2012-04-05T17:20:43.010
> 
> 标签：python, directory, chroot

我使用以下命令对目录进行了 chroot：

```
os.chroot("/mydir") 
```

如何在chrooting之前返回到上一个目录？也许可以取消根目录？

**解决方案：**

感谢菲哈格。我找到了解决方案。简单的例子：

```
import os
os.mkdir('/tmp/new_dir')
dir1 = os.open('.', os.O_RDONLY)
dir2 = os.open('/tmp/new_dir', os.O_RDONLY)

os.getcwd()                # we are in 'tmp'
os.chroot('/tmp/new_dir')  # chrooting 'new_dir' directory
os.fchdir(dir2)
os.getcwd()                # we are in chrooted directory, but path is '/'. It's OK.
os.fchdir(dir1)
os.getcwd()                # we came back to not chrooted 'tmp' directory

os.close(dir1)
os.close(dir2) 
```

[更多信息](http://docs.python.org/library/os.html#process-parameters)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:23:41.790

如果你没有改变你当前的工作目录，你可以简单地调用

```
os.chroot('../..') # Add '../' as needed 
```

当然，这需要`CAP_SYS_CHROOT`能力（通常只授予root）。

如果您更改了工作目录，您[仍然可以 escape](http://www.bpfh.net/simes/computing/chroot-break.html)，但更难：

```
os.mkdir('tmp')
os.chroot('tmp')
os.chdir('../../') # Add '../' as needed
os.chroot('.') 
```

如果`chroot`更改当前工作目录，您可以通过打开目录并使用[`fchdir`](http://docs.python.org/library/os.html#process-parameters)返回来解决此问题。

当然，如果您打算在正常程序的过程中退出 chroot（即不是演示或安全漏洞利用），您应该重新考虑您的程序。首先，你真的需要逃避 chroot 吗？为什么不能事先将所需的信息复制到其中？

此外，考虑使用第二个进程，该进程位于 chroot 之外并响应 chroot 进程的请求。

# asp.net-mvc - 将 MVC 内容文件夹放入区域

> ID：10033072
> 
> 赞同：5
> 
> 时间：2012-04-05T17:20:44.633
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-areas

首先，我明白，MVC 3 默认模板的`Content`文件夹不是强制性的 css/img/etc。存储文件夹。

我仍然喜欢`Content`文件夹的概念，将其作为图像和样式表以及其他可能的东西的“可引用”存储位置（我还将整个 jQuery 自定义控件放入`Content`其中包含 .js 文件的子文件夹）。

到目前为止，我还没有在我的项目中使用 MVC `Area`，因为我没有足够复杂的。现在是时候了。

我正在考虑`Content`在每个`Area`. 它会起作用吗？有什么“坏”的东西可以变成它吗？像我一样无法通过`../Content/MyControl`？还是 MVC`Area`只是项目的根，只是一个单独的根？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T18:04:14.987

该区域几乎就像一个单独的项目（但不是真的）。您可以使用

```
Url.Content("~/Areas/AreaName/Content/FileInfo"); 
```

或者

```
<link type="text/css" src="RootOfSiteInfo/Areas/AreaName/Content/FileInfo"/> 
```

无法访问静态内容应该没有任何问题，尽管我个人将所有内容都保留在根内容文件夹（单点存储）中，因为很多时候 CSS 和类似内容在我们的项目中跨区域共享。

# c# - 枚举和字典

> ID：10033077
> 
> 赞同：4
> 
> 时间：2012-04-05T17:21:01.770
> 
> 标签：c#, .net, dictionary, enums

我希望我能以一种对每个人都清楚的方式来解释我的问题。我们需要您对此提出建议。

我们有一个枚举类型，它定义了超过 15 个常量。我们从 Web 服务接收报告并将其一列转换为此 Enum 类型。根据我们从该网络服务收到的信息，我们使用 Dictionary 运行特定功能

我为什么要征求意见？假设这些 Enum 内容中有 3 个满足我们字典中的特定功能，但其余的使用相同的功能。那么，有没有办法以更好的方式将它们添加到我们的字典中，而不是一个一个地添加它们？我还想保留这种结构，因为到时候，我们可能会在未来为我描述为“其余部分”的那些功能提供特定功能。

为了更清楚，这里有一个我们正在尝试做的例子：

枚举：

```
public enum Reason{
    ReasonA,
    ReasonB,
    ReasonC,
    ReasonD,
    ReasonE,
    ReasonF,
    ReasonG,
    ReasonH,
    ReasonI,
    ReasonJ,
    ReasonK
} 
```

定义我们的字典：

```
public Dictionary<Reason, Action<CustomClassObj, string>> ReasonHandlers = new Dictionary<Reason, Action<CustomClassObj, string>>{
    { Reason.ReasonA, HandleReasonA },
    { Reason.ReasonB, HandleReasonB },
    { Reason.ReasonC, HandleReasonC },
    { Reason.ReasonD, HandleReasonGeneral },
    { Reason.ReasonE, HandleReasonGeneral },
    { Reason.ReasonF, HandleReasonGeneral },
    { Reason.ReasonG, HandleReasonGeneral },
    { Reason.ReasonH, HandleReasonGeneral },
    { Reason.ReasonI, HandleReasonGeneral },
    { Reason.ReasonJ, HandleReasonGeneral },
    { Reason.ReasonK, HandleReasonGeneral }
}; 
```

所以基本上我要问的是，有没有办法更智能地添加**原因、功能对？**因为正如您在 ReasonC 之后看到的，所有其他原因都使用相同的功能。

谢谢你的建议。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-05T17:25:29.750

您可以尝试这样的事情，只将自定义原因处理程序放在字典中，然后回退到通用处理程序。

```
public Dictionary<Reason, Action<CustomClassObj, string>> ReasonHandlers = new Dictionary<Reason, Action<CustomClassObj, string>>{
    { Reason.ReasonA, HandleReasonA },
    { Reason.ReasonB, HandleReasonB },
    { Reason.ReasonC, HandleReasonC }};

public Action<CustomClassObj, string> ReasonHandlerLookup (Reason reason) {
    Action<CustomClassObj, string> result = null;
    ReasonHandlers.TryGetValue(reason, out result);
    return result ?? HandleReasonGeneral;
} 
```

# matlab - Matlab：实现 CTRL+C 的功能，但在代码中

> ID：10033078
> 
> 赞同：21
> 
> 时间：2012-04-05T17:21:01.960
> 
> 标签：matlab

我希望能够通过在代码中调用命令来终止我当前正在运行的脚本（函数）。Return 只会终止当前函数而不是整个脚本。因此，回报不是唯一的。

我正在寻找的是一个完全执行`CTRL`+操作的命令`C`。我已经看到了这个：[如何停止执行](http://www.mathworks.com/matlabcentral/newsreader/view_thread/246447)，并注意到那里也没有人为这个问题提供正确的答案。

最终我想**在关闭图形时终止整个正在运行的脚本**：

```
hFig = figure('CloseRequestFcn',{@closeHandler});

.
.
.
function closeHandler (src,evnt)

    CTRL+C    <--- I am looking for such a command     
end 
```

PS。**函数 error() 也不起作用：**试试这个：

```
function terminateInCode()

hFig = figure('CloseRequestFcn',{@closeHandler});

while(1)

   plot(10*rand,10*rand,'+');
   pause(0.1);
end;

   function closeHandler (src,evnt)
      delete(hFig);
      error('program terminated!');
   end
end 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-10T22:19:47.110

[这是一个基于yuk 回答](https://stackoverflow.com/a/10037172/931379)的示例函数。组件包括：

*   确保命令窗口具有焦点以接收`CTRL`+`C`
*   发生中断后使用计时器释放`CTRL`+`C`
*   使用 Java 机器人按`CTRL`+`C`

示例函数如下：

```
function terminateExecution
%terminateExecution  Emulates CTRL-C
%    terminateExecution   Stops operation of a program by emulating a
%    CTRL-C press by the user.
%
%    Running this function
%
%Example:
%for ix = 1:100
%    disp(ix)
%    if ix>20
%        terminateExecution;
%    end
%end

%1) request focus be transferred to the command window
%   (H/T http://undocumentedmatlab.com/blog/changing-matlab-command-window-colors/)
cmdWindow = com.mathworks.mde.cmdwin.CmdWin.getInstance();
cmdWindow.grabFocus();

%2) Wait for focus transfer to complete (up to 2 seconds)
focustransferTimer = tic;
while ~cmdWindow.isFocusOwner
    pause(0.1);  %Pause some small interval
    if (toc(focustransferTimer) > 2)
        error('Error transferring focus for CTRL+C press.')
    end
end

%3) Use Java robot to execute a CTRL+C in the (now focused) command window.

%3.1)  Setup a timer to relase CTRL + C in 1 second
%  Try to reuse an existing timer if possible (this would be a holdover
%  from a previous execution)
t_all = timerfindall;
releaseTimer = [];
ix_timer = 1;
while isempty(releaseTimer) && (ix_timer<= length(t_all))
    if isequal(t_all(ix_timer).TimerFcn, @releaseCtrl_C)
        releaseTimer = t_all(ix_timer);
    end
    ix_timer = ix_timer+1;
end
if isempty(releaseTimer)
    releaseTimer = timer;
    releaseTimer.TimerFcn = @releaseCtrl_C;
end
releaseTimer.StartDelay = 1;
start(releaseTimer);

%3.2)  Press press CTRL+C
pressCtrl_C

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function pressCtrl_C
    import java.awt.Robot;
    import java.awt.event.*;
    SimKey=Robot;
    SimKey.keyPress(KeyEvent.VK_CONTROL);
    SimKey.keyPress(KeyEvent.VK_C);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function releaseCtrl_C(ignore1, ignore2)
    import java.awt.Robot;
    import java.awt.event.*;
    SimKey=Robot;
    SimKey.keyRelease(KeyEvent.VK_CONTROL);
    SimKey.keyRelease(KeyEvent.VK_C); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-05T22:57:06.647

不确定它是否会起作用，只是一个想法。如何从 MATLAB 模拟键盘按键？

您可以尝试`java.awd.Robot`：

```
import java.awt.Robot;
import java.awt.event.*;
SimKey=Robot;
SimKey.keyPress(KeyEvent.VK_CONTROL);
SimKey.keyPress(KeyEvent.VK_C); 
```

或[WScript.Shell 和 SendKeys](http://www.mathworks.com/support/solutions/en/data/1-33DJ6K/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-05T21:26:03.837

不幸的是，它似乎无法做到：

[数学作品](http://www.mathworks.com/support/solutions/en/data/1-177AH/index.html?product=ML&solution=1-177AH)

> ***除了使用键盘的+***组合之外，没有办法在 MATLAB 中以编程方式发出***`Ctrl`+ 。`C`******`Ctrl``C`***
> 
> 作为替代方案，您可以使用 ERROR 命令强制执行将退出代码的错误。例如：

```
error('Program terminated for a specific reason') 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-17T20:46:56.040

这是使用未记录的 Matlab 调用将键事件直接放入命令窗口的替代方法。这样做的方法受到保护；这使用反射来取消保护它。

与@yuk 和@Persuit 的答案不同，这似乎没有控制键粘连的问题。此外，它将始终直接发布到命令窗口，没有任何竞争条件或其他确保焦点的问题。而且，我认为它会确定性地触发——它会立即执行。

需要注意的是，它使用未记录的调用来检索命令窗口实例的句柄。这因版本而略有不同，因为它取决于窗口框架布局。Yair Altman (undocumentedmatlab.com) 在文件交换方面的一些工作具有更强大的功能，可以以更一般的方式抓住它；此代码应该适用于大多数现代版本的 Matlab（在 R2011a 上测试，Mac 和 Win）。

```
function interrupt

import java.awt.event.KeyEvent
import java.util.Calendar
import java.lang.reflection.*

cmdwin = handle(com.mathworks.mde.cmdwin.CmdWin.getInstance().getComponent(0).getComponent(0).getComponent(0),'CallbackProperties');

argSig = javaArray('java.lang.Class',1);
argSig(1) = java.lang.Class.forName('java.awt.event.KeyEvent');
method = cmdwin.getClass().getDeclaredMethod('processKeyEvent',argSig);
method.setAccessible(true);

cal = Calendar.getInstance();
args = javaArray('java.lang.Object',1);
args(1) = KeyEvent(cmdwin,KeyEvent.KEY_PRESSED,cal.getTime().getTime(),KeyEvent.CTRL_DOWN_MASK,KeyEvent.VK_C,KeyEvent.CHAR_UNDEFINED);
method.invoke(cmdwin,args); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-05T18:06:51.490

您可以使用该功能`error`。你会回到matlab。

它会产生一个错误，但这也是您`CTRL+C`在 matlab 脚本中按 时通常会发生的情况。

您应该添加某种消息，例如`error('Interrupted by user');`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-10T20:07:36.230

这不完全是您所要求的，但考虑到您的示例，您的问题可以这样解决：

```
function terminateInCode()

hFig = figure('CloseRequestFcn',{@closeHandler});

stop=0;
while(~stop)
   plot(10*rand,10*rand,'+');
   pause(0.1);
end;

   function closeHandler (src,evnt)
      delete(hFig);
      stop=1;
   end
end 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-04-17T16:02:26.737

尝试返回语句。它会把你赶出一个功能。

如果你想完全终止它，你需要使用 ERROR。

如果它真的那么灾难性，你总是可以使用 EXIT 。

# hibernate - Hibernate 4.1.2 HHH000342：无法获得与查询元数据的连接：没有为 jdbc:hsqldb:mem:test 找到合适的驱动程序

> ID：10033082
> 
> 赞同：4
> 
> 时间：2012-04-05T17:21:27.063
> 
> 标签：hibernate, jdbc, persistence

我做错了什么？

我的persistence.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="Test" transaction-type="RESOURCE_LOCAL">
           <provider>org.hibernate.ejb.HibernatePersistence</provider>
           <class>User</class>
            <properties>
              <property name="hibernate.connection.driver_class" value="org.hsqldb.jdbcDriver"/>
              <property name="hibernate.connection.url" value="jdbc:hsqldb:mem:test"/>
              <property name="hibernate.connection.password" value="sa"/>
              <property name="hibernate.connection.username" value=""/>
              <property name="hibernate.hbm2ddl.auto" value="create"/>
              <property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect"/>
              <property name="hibernate.show_sql" value="true"/>
              <property name="hibernate.format_sql" value="true"/>
            </properties>
          </persistence-unit> 
```

我的代码

```
...
Persistence.createEntityManagerFactory("Test")
... 
```

我收到这个错误

```
javax.persistence.PersistenceException: [PersistenceUnit: Test] Unable to build EntityManagerFactory
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:915)
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:890)
    at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:57)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:63)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:47)
    at com.aol.biz.vendor.persistence.TestVpsUser.setUp(TestVpsUser.java:32)
    at junit.framework.TestCase.runBare(TestCase.java:125)
    at junit.framework.TestResult$1.protect(TestResult.java:106)
    at junit.framework.TestResult.runProtected(TestResult.java:124)
    at junit.framework.TestResult.run(TestResult.java:109)
    at junit.framework.TestCase.run(TestCase.java:118)
    at junit.framework.TestSuite.runTest(TestSuite.java:208)
    at junit.framework.TestSuite.run(TestSuite.java:203)
    at org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:130)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.hibernate.HibernateException: Connection cannot be null when 'hibernate.dialect' not set
    at org.hibernate.service.jdbc.dialect.internal.DialectFactoryImpl.determineDialect(DialectFactoryImpl.java:97)
    at org.hibernate.service.jdbc.dialect.internal.DialectFactoryImpl.buildDialect(DialectFactoryImpl.java:67)
    at org.hibernate.engine.jdbc.internal.JdbcServicesImpl.configure(JdbcServicesImpl.java:170)
    at org.hibernate.service.internal.StandardServiceRegistryImpl.configureService(StandardServiceRegistryImpl.java:75)
    at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:159)
    at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:131)
    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:71)
    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2274)
    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2270)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1739)
    at org.hibernate.ejb.EntityManagerFactoryImpl.<init>(EntityManagerFactoryImpl.java:93)
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:905)
    ... 18 more 
```

但！！

如果我在创建工厂之前手动加载了 jdbc 驱动程序类 - 一切正常。o_o

```
try {
            Class.forName("org.hsqldb.jdbcDriver");
        } catch (ClassNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
```

如果没有这一步，我怎么能做到这一切？请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T10:06:37.217

我对 4.1.2.Final 也有类似的问题。但如果我回滚到 4.1.1.Final，我的程序运行良好。

# selenium - 如何使用 Selenium 在 UI 中验证本地语言

> ID：10033086
> 
> 赞同：1
> 
> 时间：2012-04-05T17:21:53.943
> 
> 标签：selenium, automation

我是测试新手，并且有一个关于我们如何使用 Selenium 验证本地语言的问题。假设我有一些链接可以让我选择语言，那么如果我选择一种语言，我该如何验证呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T21:07:32.123

嗯，你可以

*   在页面上搜索该语言的标志
*   检查数字格式或时间格式（在某些语言环境中会发生变化）
*   验证某些众所周知的文本（如问候语）是否已更改。说，从`Good evening`到`Dobrý večer`（那是捷克语;））

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T21:10:16.327

通过页面上的任何内容！假设我们的页面仅由一个元素组成，或者

```
<div>
    It's time to kick ass and chew bubble gum!
</div> 
```

或者

```
<div>
    Il est temps de botter le cul et mâcher de la gomme à bulles!
</div> 
```

然后，使用 Selenium，您可以获取元素，获取内部文本并进行验证！Java 中的示例：

```
// assuming driver is a good WebDriver instance
WebElement elem = driver.findElement(By.xpath("//div"));
if (elem.getText().contains("kick ass")) {
    System.out.println("It's English!");
} else if (elem.getText().contains("botter le cul")) {
    System.out.println("It's French!");
} 
```

从 Java 7 开始，您甚至可以在 String 上使用 switch-case，因此您可以针对很多很多语言进行消化测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T22:56:00.223

我们使用 l10n 的字典文件。Dictionary 是一个 xml 文件，其中的字符串存储为`<string key="Cancel">Cancel</string>`. 因此，出于测试目的，我们将 all 替换`</string>`为类似的内容，并将`@@@</string>`所有空格替换为 '_'（可以在 notepad++ 中使用 ctrl+h 完成，例如，可以借助[此答案](https://stackoverflow.com/questions/9703892/how-to-replace-whitespace-with-notepad-between-two-characters)替换空格）。然后我们在我们的网站上选择与修改过的字典相对应的语言。下一步由 Selenium IDE 脚本完成：浏览整个网站并使用 Selenium IDE 命令存储页面文本。然后解析并回显所有不以@@@结尾的单词并分析是否可以或应该翻译的单词是硬编码的。`<string key="...">``</string>``storeBodyText | text`

不是纯粹的自动化，但总比没有好:) 我认为这种方法不仅可以应用于 xml 字典文件，还可以应用于您用于字符串的任何存储。

PS。如果您不想执行本地化测试，但只想确保通过单击链接应用了某种语言（恐怕这正是您要查找的内容），单击链接后，您可以获得文本来自任何元素并将其与预期文本（`storeText(locator, variableName)`对于 IDE）进行比较。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-06-10T11:03:19.530

```
<!-- Using Selenium IDE -->
<tr>
<td>storeAttribute</td>
    <td>//html@lang</td>
    <td>language</td>
</tr>
<tr>
    <td>echo</td>
    <td>The label is ${language}</td>
    <td></td>
</tr> 
```

# ruby-on-rails - Paginate child models Kaminari on rails 3.1

> ID：10033090
> 
> 赞同：0
> 
> 时间：2012-04-05T17:22:02.410
> 
> 标签：ruby-on-rails, ruby-on-rails-3, pagination, kaminari

我有 2 个模型`images`和`categories`.

关系是：

**- 图像属于一个类别。**

**- 一个类别有许多图像。**

在对象`index.html.erb`视图中`categories`，我希望为所有类别每页分页 20 张图像。

我的意思是，我想对所有类别的所有图像进行分页，每页 20 张图像。

在我`index action`的`categories_controller.rb`方法中，我有：

```
def index
    @categories = Category.all
    @categories.each do |category| 
     @images = Kaminari.paginate_array(category.images).page(1).per(1)
    end
    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @categories }
    end
   end 
```

在 index.html.erb 我有：

```
<% @images.each do |image|%>

code for each image here

<% end %>  
<% paginate @images %> 
```

但这对我来说是行不通的。我看不到任何图像显示。

**我怎样才能实现这个功能？并解决这个问题？**谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:42:22.727

```
@categories.each do |category| 
  @images = Kaminari.paginate_array(category.images).page(1).per(1)
end 
```

在这个循环中，你每次都覆盖@images，所以很明显，你不会得到你期望的;）

我认为你想做的是：

```
@images = Image.where("category_id IS NOT NULL").page(params[:page]).per(20) 
```

`.where("category_id IS NOT NULL")`如果图像必须属于某个类别，则不需要。

# c - 为什么访问 malloced 结构数组的成员会出现错误？

> ID：10033091
> 
> 赞同：1
> 
> 时间：2012-04-05T17:22:03.893
> 
> 标签：c, memory-management, segmentation-fault, malloc

我正在通过 Learn C The Hard Way 工作，并且对某些事情感到困惑。我已经编写了我遇到的问题的简化版本，以便更容易理解它：

```
#include <stdlib.h>

#define GROUP_SIZE 10
#define DATA_SIZE 64

struct Dummy {
    char *name;
};

struct Group {
    struct Dummy **dummies;
};

int main() {
    struct Group *group1 = malloc(sizeof(struct Group));
    group1->dummies = malloc(sizeof(struct Dummy) * GROUP_SIZE);
    struct Dummy *dummy1 = group1->dummies[3];

    // Why does this seg fault?
    dummy1->name = (char *) malloc(DATA_SIZE);

    return 0;
} 
```

当我尝试在我的一个假人上设置名称指针时，我遇到了段错误。使用 valgrind 它告诉我这是未初始化的空间。为什么是这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:27:04.783

您的使用*似乎*`dummies`与其*声明*不一致。从您使用该`dummies`字段的方式来看，它似乎`dummies`是一个结构*数组*，`Dummy`而不是一个结构数组*数组*。`Dummy`如果是这种情况，请将您的声明更改为：

```
struct Group {
    struct Dummy *dummies; // Single asterisk
}; 
```

然后按如下方式更改您的用法：

```
struct Dummy *dummy1 = &group1->dummies[3]; 
```

当然，这假设`GROUP_SIZE`是四个或更多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:25:06.187

你从来没有为`Dummy`自己分配空间。您需要执行以下操作：

```
group1->dummies = malloc(sizeof(Dummy *) * GROUP_SIZE);
for(int i = 0; i < GROUP_SIZE; i++) {
   group1->dummies[i] = malloc(sizeof(struct Dummy));
} 
```

# c++ - 为什么程序继续运行，当我告诉它停止时？

> ID：10033093
> 
> 赞同：0
> 
> 时间：2012-04-05T17:22:14.890
> 
> 标签：c++

我正在努力用 C++ 创建一个小二十一点控制台游戏。我已经编写了几乎所有的代码（你可能会觉得它很乱，但我好像没有这方面的经验）。它有效，但不完全。如您所知（或不知道），当您的牌值等于 21 时，您赢了游戏，如果您有更多，您就输了。在我的项目中，游戏永远不会停止，当你得到 21 时，当庄家得到 21 或当你超过 21 时，游戏仍在进行。也许我忘了添加一些东西，如果你能指出我会非常高兴！:) [代码](http://pastebin.com/d5JN6jRb)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:35:56.250

在您的`main()`函数中，您正在定义一个新的局部状态变量：

```
GAMESTATE GSState = GAME; 
```

这会影响其他班级正在更新以指示游戏结束的全局。

您应该只为其分配一个值：

```
GSState = GAME; 
```

使用 gcc，`-Wshadow`如果您希望编译器警告您这种潜在的错误（但可能有很多误报），您可以使用标志进行编译。

# xna - xna 中的大型多人游戏

> ID：10033094
> 
> 赞同：2
> 
> 时间：2012-04-05T17:22:17.613
> 
> 标签：xna, client

您如何看待 xna 和大型多人游戏？例如服务器和 100 个客户端？有没有很好的教程如何在 xna 中创建客户端服务器应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T11:40:55.937

当然有关于如何做到这一点的教程。我个人使用 Lidgren 作为我的在线原型。我只用 4 个人测试了它，服务器运行在低资源 ubuntu vps 上，运行在 Mono 上，所以我不能告诉你它将如何扩展，但我相信其他人可以。

如需快速阅读，请查看网站[http://code.google.com/p/lidgren-network-gen3/](http://code.google.com/p/lidgren-network-gen3/)，您可以阅读 wiki 帖子和 google 群组以了解其他人的想法。

主站点上的 wiki 帖子有一些类似教程的基本帖子，但没有太详细。或者你甚至可以查看这个网站并获得更详细的教程[http://dirkkok.wordpress.com/lets-make-a-multi-player-game/](http://dirkkok.wordpress.com/lets-make-a-multi-player-game/)。但这并不一定会让您擅长编写网络游戏，但它肯定会让您入门。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:28:11.930

App Hub 上有一个很好的代码示例，用于管理网络游戏的状态 [http://create.msdn.com/en-US/education/catalog/sample/network_game_state_management](http://create.msdn.com/en-US/education/catalog/sample/network_game_state_management)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T18:33:23.847

而不是网络游戏状态示例，我会指向客户端/服务器示例：
[http ://create.msdn.com/en-US/education/catalog/sample/network_cs](http://create.msdn.com/en-US/education/catalog/sample/network_cs)

但是，我怀疑这将如何扩展到**大型**多人游戏（“100 个客户”不是）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T20:37:04.783

你可以试试[PlayerIO](http://playerio.com)，他们有很棒的多人游戏服务，而且对于初学者来说它是免费的，除非你的游戏越来越大并且你想要更多的带宽、并发用户等。我和他们一起工作过，他们很棒。它还有一个内置的数据库系统，非常易于使用，因此您可以存储关卡信息、玩家选项等任何您想要的东西。它有很多很酷的东西，我建议你去看看 playerio.com。

如果你同意它，我可以向你展示连接和发送等的例子。为了回答一次可以有多少用户在线，他们的免费计划允许 500 名用户同时在线（但总体上可以有数千名用户），您可以通过付费计划让更多用户在线

# jquery - 好的 JS **Dropdown** 复选框节点树？

> ID：10033098
> 
> 赞同：6
> 
> 时间：2012-04-05T17:22:35.690
> 
> 标签：jquery, treeview

我正在寻找具有复选框的良好下拉节点树。类似于ComboBox 中的[ASP.NET ComboBox / TreeView](http://demos.telerik.com/aspnet-ajax/treeview/examples/functionality/treeviewcombobox/defaultcs.aspx?product=combobox)：

![在此处输入图像描述](../Images/7fd5fef59ceaf02ab9e6f5683af1076f.png)

我发现一个类似的 jQuery 组件是[DDCL dropdown-check-list](http://code.google.com/p/dropdown-check-list/)：

![在此处输入图像描述](../Images/3acc9c2d044479d00fa1bead9dd74294.png)

但它是一个列表，而不是一棵树。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:36:29.350

看看[jsTree](http://www.jstree.com/)，尤其是[复选框](http://www.jstree.com/documentation/checkbox)演示。

# image - 膨胀文件（更大的大小）

> ID：10033099
> 
> 赞同：0
> 
> 时间：2012-04-05T17:22:42.837
> 
> 标签：image, file, size

我有一个 21 KB 的图像。

我想“膨胀”图像，使其占用 20MB 或更多。是否有任何软件或技术可以做到这一点（在 Win7 中）？

图像文件为 .jpg 格式。如果有帮助，我知道如何将其更改为不同的图像类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-16T05:23:47.317

您可以通过人为地向图像添加噪声来使图像膨胀，因此它不会扭曲图像，但会增加它的大小。我相信这可以在 Photoshop 中完成，但我不确定。

# single-sign-on - 集中身份管理的最佳解决方案

> ID：10033104
> 
> 赞同：2
> 
> 时间：2012-04-05T17:23:08.547
> 
> 标签：single-sign-on, cas, josso, openidm

我正在研究 IdM 的开源解决方案。

到目前为止，我的选择是`OpenIDM`, `OpenAM`, `Josso`& `CAS`。

但大多数解决方案都专注于`SSO`，但我的要求更多的是用户管理和配置。可以`Josso/CAS/OpenIDM`提供用户配置/取消配置、组策略等吗？任何开源替代品`Atlassian Crowd`，匹配每个功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:21:42.780

您提到的开源解决方案主要关注 SSO，而不是身份管理。JOSSO 具有用户配置功能，但 AFAIK 它不包括组策略。如果您正在寻找完整的身份管理解决方案，则需要查看[Cloudseal](http://www.cloudseal.com)、[Crowd](http://www.atlassian.com/software/crowd/overview)、Oracle 等商业产品。

# c# - c# 事件处理错误

> ID：10033106
> 
> 赞同：-1
> 
> 时间：2012-04-05T17:23:09.293
> 
> 标签：c#, datagridview, event-handling

我有方法

```
private void getValues(object sender, EventArgs e)
    {
        int id = int.Parse(dgvTable.Rows[dgvTable.CurrentRow.Index].Cells[0].Value.ToString());
        var values = from c in v.db.TotalDoc
                     where c.TotalID == id
                     select c.TotalAmount;
        dgvValues.DataSource = values;
    } 
```

和这一行的datagridview“dgvTable”错误

```
dgvTable.CellClick += new EventHadler(getValues); 
```

错误文本是：“getValues”没有重载与委托“System.EventHandler”匹配

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:26:15.770

`DataGridView.CellClick`方法签名是 a而`DataGridViewCellEventHandler`不是 type `EventHandler`。将您的方法签名更改为：

`private void getValues(object sender, DataGridViewCellEventArgs e)`

并将您的声明更改为：

```
dgvTable.CellClick += new DataGridViewCellEventHandler(getValues); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:26:24.500

```
private void getValues(object sender, DataGridViewCellEventArgs e) 
```

# c# - 从 C# 中的字符串中选择一个子字符串

> ID：10033114
> 
> 赞同：-6
> 
> 时间：2012-04-05T17:24:27.830
> 
> 标签：c#

如何从C#中最合理的字符串中选择一个子字符串，从空格到符号'#'？例如：

```
"Jungle #welcome to the jungle" 
```

结果：`#welcome`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:25:40.100

```
string originalString = "Jungle #welcome to the Juncle";
string subString = originalString.Substring(originalString.IndexOf("#"));
subString = subString.Substring(0, subString.IndexOf(" ")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:28:58.560

```
使用 System.Text.RegularExpressions；

Match m = Regex.Match("丛林#欢迎来到丛林", @"\s(#\w+?)\s");
Console.WriteLine(m.Captures[0].Value);
// ＃欢迎
```

# php - 如何限制用户每天可以发布的评论或回复评论的数量

> ID：10033118
> 
> 赞同：2
> 
> 时间：2012-04-05T17:24:41.000
> 
> 标签：php, limit, insert-query

我的社交网络上有评论区和评论区的回复。我们在手动垃圾邮件发送者方面遇到了一些麻烦，我打算限制某人每天可以发布的评论数量。

以下是评论和回复评论的插入查询：

```
//COMMENTS

$query = "INSERT INTO `CysticAirwaves` ( 
                                        `FromUserID`,
                                        `ToUserID`,
                                        `comment`,
                                        `status`,
                                        `statusCommentAirwave`,
                                        `date`,
                                        `time`

                                ) VALUES (

                                    '" . $auth->id ."',
                                    '" . $prof->id ."',
                                    '" . mysql_real_escape_string($_POST['ProfileComment']) ."',
                                    'active',
                                    'active',
                                    '" . date("Y-m-d") . "',
                                    '" . date("G:i:s") . "')";
    mysql_query($query,$connection); 

    if($auth->id == $prof->id) {
        $just_inserted = mysql_insert_id();
        $query = "UPDATE `CysticAirwaves` SET `status` = 'dead' WHERE `FromUserID` = '" . $auth->id . "' AND `ToUserID` = '" . $prof->id . "' AND `id` != '" . $just_inserted . "'";
        $request = mysql_query($query,$connection);
}

//REPLIES

$query = "INSERT INTO `CysticAirwaves_replies` (
                                    `AirwaveID`,
                                    `FromUserID`,
                                    `comment`,
                                    `status`,
                                    `date`,
                                    `time`
                                ) VALUES (
                                    '" . mysql_real_escape_string($_POST['comment']) . "',
                                    '" . $auth->id . "',
                                    '" . mysql_real_escape_string($_POST['reply']) . "',
                                    'active',
                                    '" . date("Y-m-d") . "',
                                    '" . date("G:i:s") . "'
                                    )";
    mysql_query($query,$connection);

    $mailto = array();

    /* get the person that wrote the inital comment */
    $query = "SELECT `FromUserID` FROM `CysticAirwaves` WHERE `id` = '" . mysql_real_escape_string($_POST['comment']) . "' LIMIT 1";
    $request = mysql_query($query,$connection);
    $result = mysql_fetch_array($request);
    $comment_author = new User($result['FromUserID']); 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:32:00.680

您可以执行选择以查看该用户在当前日期的表中有多少条目：

```
SELECT COUNT(*)
FROM   CysticAirwaves
WHERE  userid = $auth->id
  AND  date = CURDATE() 
```

然后仅`INSERT`在数字低于您的阈值时执行。`INSERT`或者，您可以在对每个执行此检查`INSERT`并退回呼叫的触发器上放置一个触发器。（“最佳实践”是将其放在数据库中，因为这将是与数据库相关的限制，但这是您的决定）

**自从我完成 MySQL 触发器以来**已经有一段时间了，但我***认为*这就是你所追求的：**

 **```
delimeter |

CREATE TRIGGER reply_threshold BEFORE INSERT ON CysticAirwaves_replies
  FOR EACH ROW BEGIN
    DECLARE reply_count INT;
    SET reply_count = (SELECT COUNT(*) FROM CysticAirwaves_replies WHERE userid = NEW.userid AND `date` = CURDATE());
    IF reply_count > 5 THEN
      SIGNAL SQLSTATE SET MESSAGE_TEXT = 'Too many replies for today';
    END IF;
  END;

|
delimeter ; 
```

本质上，如果您在表中插入回复并且已超过阈值，则会引发 sql 错误以停止操作。您不能“阻止”每次插入，但您可以引发异常，使其失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:29:36.847

当您没有登录系统时，您只能通过 ip 地址进行限制。但是ip可以改变，这就是问题所在。

最好的方法是通过登录来保护表单。只有用户登录后才能发帖。

最后一种技术是使用像[Recaptcha](https://developers.google.com/recaptcha/docs/php)这样的验证码，然后在大多数情况下，机器人会填写您的表单并向您的系统发送垃圾邮件。

当你有一个登录。然后制作一个与您的用户表相关的表并计算 INSERTS。在您插入新评论之前，请检查表格是否今天有插入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T17:31:24.503

在插入评论之前，您检查用户在一天内发表的评论是否超过 5 条。如果是，则不插入评论并显示一条消息。

```
SELECT COUNT(*) FROM CysticAirwaves_replies WHERE FromUserID = the_user_id AND date = CURDATE() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T17:36:53.817

除了在每次插入之前进行计数之外，您还可以直接将用户发表的评论数量存储在某处，因此您不必每次都进行 count(*) （如果用户有很多评论和表格，这可能会很昂贵你有有点大）。

喜欢，评论：

```
SELECT comment_count FROM comment_count_table WHERE user_id = ? 
```

如果该值足够小，您可以：

```
UPDATE comment_count_table SET comment_count = comment_count + 1 WHERE user_id = ? 
```

请注意这一点，因为您需要以某种方式重置该计数器。在我的公司，我们将此设置实施为“最后修改的字段”。当我们执行 SELECT 时，如果“最后修改日期”不是今天，那么我们重置计数器。

另一种选择是让 cron 作业每天为所有用户重置一次计数器，但这太昂贵了。**

# mysql - 将 mysql 工作台“创建表”导入 phpmyadmin

> ID：10033119
> 
> 赞同：1
> 
> 时间：2012-04-05T17:24:42.433
> 
> 标签：mysql, phpmyadmin, mysql-workbench

我一直在使用 MySQL Workbench 创建我的数据库，但最近决定将结构导出到 phpmyadmin。

Workbench 有一个功能，您可以自动生成创建脚本，这样做时我得到以下输出：

```
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL';

CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ;

USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`User`
-- -----------------------------------------------------

DROP TABLE IF EXISTS `mydb`.`User` ;

CREATE  TABLE IF NOT EXISTS `mydb`.`User` (
  `idUser` INT NOT NULL AUTO_INCREMENT ,
  `Username` VARCHAR(25) NOT NULL ,
  `Password` VARCHAR(25) NOT NULL ,
  `Email` VARCHAR(45) NOT NULL ,
  `DateJoined` DATETIME NOT NULL ,
  PRIMARY KEY (`idUser`) )
ENGINE = InnoDB;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS; 
```

我的实际数据库要复杂得多，但我仅以此为例。所以现在我有了创建语句，我尝试将文件导入 phpmyadmin，这不起作用，并且还在 phpmyadmin 本身中运行代码。两次，我都收到此错误：

```
#1044 - Access denied for user 'myusername'@'localhost' to database 'mydb' 
```

我最初认为问题是我试图在没有设置用户的情况下执行 sql。因此，我在 Workbench 中设置了一个用户，并尝试运行新的 create 语句（它也创建了我的用户和足够的角色），但我得到了同样的错误。

最后，我尝试在 phpmyadmin 中创建用户并运行初始脚本，但我一直收到相同的错误。

有人可以帮忙吗？

编辑：在实际错误消息上方，突出显示以下行：

```
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci;** 
```

我尝试更改字符集，但仍然出现错误。

# php - Windows Server 2008 R2 / IIS7.5 上缺少 IUSR 帐户

> ID：10033126
> 
> 赞同：17
> 
> 时间：2012-04-05T17:25:19.603
> 
> 标签：php, iis-7.5, installation, windows-server-2008-r2

我的任务是在这台机器上安装 PHP5.4。手动安装步骤之一是将 IUSR 帐户配置为具有特定权限。问题是，我看到 IIS_IUSRS 组，但没有 IUSR 帐户。列出的唯一用户是管理员用户、访客帐户和安全软件用户。我不是真正的 Windows 服务器类型，更像是一个 *NIX 人 - 所以这有点令人沮丧。我到处搜索并没有找到合适的答案，但我学到了很多关于 IIS7.5 的知识——所以这并不是完全浪费时间。我尝试了几个建议，发现了几个类似的问题，但到目前为止没有任何效果。我也尝试过自己创建IUSR帐户，但无济于事。如果有人知道如何做到这一点，我将不胜感激。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-04-06T17:21:30.080

经过几个小时试图弄清楚这一点，我终于做到了。所以，对于任何可能遇到同样问题的人，这里就是答案。

这就是我找到IUSR的地方和方式。

首先，让我解释一下，我不确定导致在我的系统上难以找到 IUSR 的特定设置和/或设置是什么。但是，我确实找到了它，所以它是：我右键单击需要授予 IUSR 访问权限的文件夹/文件，然后选择“属性”。

单击“安全”选项卡 =>“编辑”（在组和用户下）=>“添加”（在组和用户下）

这会将您带到“选择用户、计算机、服务帐户或组”窗口。

单击“对象类型...”按钮，然后选择所有内容并单击“确定”。

接下来，单击“位置...”并选择最父选项（这很可能是服务器本身）并单击“确定”

接下来，单击“高级”按钮并选择“立即查找”按钮。

您将看到几个搜索结果。有些是组，有些是实际用户。

在*此*列表中，您将找到 IUSR 用户名。选择它，然后点击“确定”。

你有它。

我不确定为什么会发生这种情况，但是，我怀疑（请记住，我对 Windows 作为服务器不太了解）我怀疑这与在我们所有服务器上使用 Active Directory 服务器进行身份验证和安全有关. 我相信这是因为没有用我正在使用的服务器的名称指示 IUSR 用户，尽管大多数（但不是全部）其他组和用户名在点击“查找”后在搜索结果列表中现在'。就是这样。:)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-10T07:18:12.107

这是因为 IUSR 不是用户帐户，而是“内置安全主体” - 在授予文件或文件夹权限时，内置安全主体是可以指定的用户类别之一，但在 lusrmgr 中不可见.msc 并且不能添加到组中。

关于命名 - 一些旧文档仍然提到与 IIS 6 一起使用的帐户 IUSR_MACHINENAME，但从 IIS 7 开始，此帐户重命名为 IUSR 并且不再与机器绑定......

有关更多详细信息，请参阅文章[“IIS 6 与 IIS 7 IUSR 帐户”](https://web.archive.org/web/20140405093648/http://certcities.com/editorial/columns/story.asp?EditorialsID=395)，其中详细解释了它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T14:23:21.353

我发现的另一个技巧，添加IUSR（在本地服务器用户中不可见，在组中），只需将IUSR添加到您的IIS根文件夹和数据库所在的文件夹中。这对我有用。

# hadoop - 使用 Java 运行 EmbeddedPig 时，Pig 脚本中的 ORDER BY 作业失败

> ID：10033131
> 
> 赞同：2
> 
> 时间：2012-04-05T17:25:48.277
> 
> 标签：hadoop, apache-pig

我有以下猪脚本，它使用 grunt shell 完美运行（将结果存储到 HDFS 没有任何问题）；但是，如果我使用 Java EmbeddedPig 运行相同的脚本，最后一个作业 (ORDER BY) 会失败。如果我将 ORDER BY 作业替换为其他作业，例如 GROUP 或 FOREACH GENERATE，则整个脚本在 Java EmbeddedPig 中成功。所以我认为是 ORDER BY 导致了这个问题。有人有这方面的经验吗？任何帮助，将不胜感激！

猪脚本：

```
 REGISTER pig-udf-0.0.1-SNAPSHOT.jar;
    user_similarity = LOAD '/tmp/sample-sim-score-results-31/part-r-00000' USING PigStorage('\t') AS (user_id: chararray, sim_user_id: chararray, basic_sim_score: float, alt_sim_score: float);
    simplified_user_similarity = FOREACH user_similarity GENERATE $0 AS user_id, $1 AS sim_user_id, $2 AS sim_score;
    grouped_user_similarity = GROUP simplified_user_similarity BY user_id;
    ordered_user_similarity = FOREACH grouped_user_similarity {                           
        sorted = ORDER simplified_user_similarity BY sim_score DESC;
        top    = LIMIT sorted 10;
        GENERATE group, top;
    };
    top_influencers = FOREACH ordered_user_similarity GENERATE com.aol.grapevine.similarity.pig.udf.AssignPointsToTopInfluencer($1, 10);
    all_influence_scores = FOREACH top_influencers GENERATE FLATTEN($0);
    grouped_influence_scores = GROUP all_influence_scores BY bag_of_topSimUserTuples::user_id;
    influence_scores = FOREACH grouped_influence_scores GENERATE group AS user_id, SUM(all_influence_scores.bag_of_topSimUserTuples::points) AS influence_score;
    ordered_influence_scores = ORDER influence_scores BY influence_score DESC;
    STORE ordered_influence_scores INTO '/tmp/cc-test-results-1' USING PigStorage(); 
```

Pig的错误日志：

```
12/04/05 10:00:56 INFO pigstats.ScriptState: Pig script settings are added to the job
12/04/05 10:00:56 INFO mapReduceLayer.JobControlCompiler: mapred.job.reduce.markreset.buffer.percent is not set, set to default 0.3
12/04/05 10:00:58 INFO mapReduceLayer.JobControlCompiler: Setting up single store job
12/04/05 10:00:58 INFO jvm.JvmMetrics: Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized
12/04/05 10:00:58 INFO mapReduceLayer.MapReduceLauncher: 1 map-reduce job(s) waiting for submission.
12/04/05 10:00:58 WARN mapred.JobClient: Use GenericOptionsParser for parsing the arguments. Applications should implement Tool for the same.
12/04/05 10:00:58 INFO input.FileInputFormat: Total input paths to process : 1
12/04/05 10:00:58 INFO util.MapRedUtil: Total input paths to process : 1
12/04/05 10:00:58 INFO util.MapRedUtil: Total input paths (combined) to process : 1
12/04/05 10:00:58 INFO filecache.TrackerDistributedCacheManager: Creating tmp-1546565755 in /var/lib/hadoop-0.20/cache/cchuang/mapred/local/archive/4334795313006396107_361978491_57907159/localhost/tmp/temp1725960134-work-6955502337234509704 with rwxr-xr-x
12/04/05 10:00:58 INFO filecache.TrackerDistributedCacheManager: Cached hdfs://localhost/tmp/temp1725960134/tmp-1546565755#pigsample_854728855_1333645258470 as /var/lib/hadoop-0.20/cache/cchuang/mapred/local/archive/4334795313006396107_361978491_57907159/localhost/tmp/temp1725960134/tmp-1546565755
12/04/05 10:00:58 INFO filecache.TrackerDistributedCacheManager: Cached hdfs://localhost/tmp/temp1725960134/tmp-1546565755#pigsample_854728855_1333645258470 as /var/lib/hadoop-0.20/cache/cchuang/mapred/local/archive/4334795313006396107_361978491_57907159/localhost/tmp/temp1725960134/tmp-1546565755
12/04/05 10:00:58 WARN mapred.LocalJobRunner: LocalJobRunner does not support symlinking into current working dir.
12/04/05 10:00:58 INFO mapred.TaskRunner: Creating symlink: /var/lib/hadoop-0.20/cache/cchuang/mapred/local/archive/4334795313006396107_361978491_57907159/localhost/tmp/temp1725960134/tmp-1546565755 <- /var/lib/hadoop-0.20/cache/cchuang/mapred/local/localRunner/pigsample_854728855_1333645258470
12/04/05 10:00:58 INFO filecache.TrackerDistributedCacheManager: Creating symlink: /var/lib/hadoop-0.20/cache/cchuang/mapred/staging/cchuang402164468/.staging/job_local_0004/.job.jar.crc <- /var/lib/hadoop-0.20/cache/cchuang/mapred/local/localRunner/.job.jar.crc
12/04/05 10:00:58 INFO filecache.TrackerDistributedCacheManager: Creating symlink: /var/lib/hadoop-0.20/cache/cchuang/mapred/staging/cchuang402164468/.staging/job_local_0004/.job.split.crc <- /var/lib/hadoop-0.20/cache/cchuang/mapred/local/localRunner/.job.split.crc
12/04/05 10:00:59 INFO filecache.TrackerDistributedCacheManager: Creating symlink: /var/lib/hadoop-0.20/cache/cchuang/mapred/staging/cchuang402164468/.staging/job_local_0004/.job.splitmetainfo.crc <- /var/lib/hadoop-0.20/cache/cchuang/mapred/local/localRunner/.job.splitmetainfo.crc
12/04/05 10:00:59 INFO filecache.TrackerDistributedCacheManager: Creating symlink: /var/lib/hadoop-0.20/cache/cchuang/mapred/staging/cchuang402164468/.staging/job_local_0004/.job.xml.crc <- /var/lib/hadoop-0.20/cache/cchuang/mapred/local/localRunner/.job.xml.crc
12/04/05 10:00:59 INFO filecache.TrackerDistributedCacheManager: Creating symlink: /var/lib/hadoop-0.20/cache/cchuang/mapred/staging/cchuang402164468/.staging/job_local_0004/job.jar <- /var/lib/hadoop-0.20/cache/cchuang/mapred/local/localRunner/job.jar
12/04/05 10:00:59 INFO filecache.TrackerDistributedCacheManager: Creating symlink: /var/lib/hadoop-0.20/cache/cchuang/mapred/staging/cchuang402164468/.staging/job_local_0004/job.split <- /var/lib/hadoop-0.20/cache/cchuang/mapred/local/localRunner/job.split
12/04/05 10:00:59 INFO filecache.TrackerDistributedCacheManager: Creating symlink: /var/lib/hadoop-0.20/cache/cchuang/mapred/staging/cchuang402164468/.staging/job_local_0004/job.splitmetainfo <- /var/lib/hadoop-0.20/cache/cchuang/mapred/local/localRunner/job.splitmetainfo
12/04/05 10:00:59 INFO filecache.TrackerDistributedCacheManager: Creating symlink: /var/lib/hadoop-0.20/cache/cchuang/mapred/staging/cchuang402164468/.staging/job_local_0004/job.xml <- /var/lib/hadoop-0.20/cache/cchuang/mapred/local/localRunner/job.xml
12/04/05 10:00:59 INFO mapred.Task:  Using ResourceCalculatorPlugin : null
12/04/05 10:00:59 INFO mapred.MapTask: io.sort.mb = 100
12/04/05 10:00:59 INFO mapred.MapTask: data buffer = 79691776/99614720
12/04/05 10:00:59 INFO mapred.MapTask: record buffer = 262144/327680
12/04/05 10:00:59 WARN mapred.LocalJobRunner: job_local_0004
java.lang.RuntimeException: org.apache.hadoop.mapreduce.lib.input.InvalidInputException: Input path does not exist: file:/Users/cchuang/workspace/grapevine-rec/pigsample_854728855_1333645258470
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.partitioners.WeightedRangePartitioner.setConf(WeightedRangePartitioner.java:139)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:62)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
    at org.apache.hadoop.mapred.MapTask$NewOutputCollector.<init>(MapTask.java:560)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:639)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:323)
    at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:210)
Caused by: org.apache.hadoop.mapreduce.lib.input.InvalidInputException: Input path does not exist: file:/Users/cchuang/workspace/grapevine-rec/pigsample_854728855_1333645258470
    at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.listStatus(FileInputFormat.java:231)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigFileInputFormat.listStatus(PigFileInputFormat.java:37)
    at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.getSplits(FileInputFormat.java:248)
    at org.apache.pig.impl.io.ReadToEndLoader.init(ReadToEndLoader.java:153)
    at org.apache.pig.impl.io.ReadToEndLoader.<init>(ReadToEndLoader.java:115)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.partitioners.WeightedRangePartitioner.setConf(WeightedRangePartitioner.java:112)
    ... 6 more
12/04/05 10:00:59 INFO filecache.TrackerDistributedCacheManager: Deleted path /var/lib/hadoop-0.20/cache/cchuang/mapred/local/archive/4334795313006396107_361978491_57907159/localhost/tmp/temp1725960134/tmp-1546565755
12/04/05 10:00:59 INFO mapReduceLayer.MapReduceLauncher: HadoopJobId: job_local_0004
12/04/05 10:01:04 INFO mapReduceLayer.MapReduceLauncher: job job_local_0004 has failed! Stop running all dependent jobs
12/04/05 10:01:04 INFO mapReduceLayer.MapReduceLauncher: 100% complete
12/04/05 10:01:04 ERROR pigstats.PigStatsUtil: 1 map reduce job(s) failed!
12/04/05 10:01:04 INFO pigstats.PigStats: Script Statistics:

HadoopVersion    PigVersion    UserId    StartedAt    FinishedAt    Features
0.20.2-cdh3u3    0.8.1-cdh3u3    cchuang    2012-04-05 10:00:34    2012-04-05 10:01:04    GROUP_BY,ORDER_BY

Some jobs have failed! Stop running all dependent jobs

Job Stats (time in seconds):
JobId    Maps    Reduces    MaxMapTime    MinMapTIme    AvgMapTime    MaxReduceTime    MinReduceTime    AvgReduceTime    Alias    Feature    Outputs
job_local_0001    0    0    0    0    0    0    0    0    all_influence_scores,grouped_user_similarity,simplified_user_similarity,user_similarity    GROUP_BY   
job_local_0002    0    0    0    0    0    0    0    0    grouped_influence_scores,influence_scores    GROUP_BY,COMBINER   
job_local_0003    0    0    0    0    0    0    0    0    ordered_influence_scores    SAMPLER   

Failed Jobs:
JobId    Alias    Feature    Message    Outputs
job_local_0004    ordered_influence_scores    ORDER_BY    Message: Job failed! Error - NA    /tmp/cc-test-results-1,

Input(s):
Successfully read 0 records from: "/tmp/sample-sim-score-results-31/part-r-00000"

Output(s):
Failed to produce result in "/tmp/cc-test-results-1"

Counters:
Total records written : 0
Total bytes written : 0
Spillable Memory Manager spill count : 0
Total bags proactively spilled: 0
Total records proactively spilled: 0

Job DAG:
job_local_0001    ->    job_local_0002,
job_local_0002    ->    job_local_0003,
job_local_0003    ->    job_local_0004,
job_local_0004

12/04/05 10:01:04 INFO mapReduceLayer.MapReduceLauncher: Some jobs have failed! Stop running all dependent jobs 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-03T18:12:16.083

确保 PIG_HOME 环境变量设置为 pig 安装。

# regex - 使用类似正则表达式的条件生成字符串

> ID：10033133
> 
> 赞同：15
> 
> 时间：2012-04-05T17:25:52.443
> 
> 标签：使用正则表达式, , regex, string, delphi, generator, enumerator

我想知道实现满足以下第二个思考要求的最佳字符串生成器类是否可行：

* * *

*   ~~[使用正则表达式](/questions/tagged/regex "显示标记为“正则表达式”的问题")的生成标准~~
*   ~~[字典顺序](http://en.wikipedia.org/wiki/Lexicographical_order)枚举。~~
*   ~~计数属性~~
*   ~~索引访问~~

 ~~我对正则表达式感到不舒服：我无法想出一段起始代码，但我只是想到了一个使用 TList 作为基类并使用过滤器（正则表达式）来对抗“蛮力”生成的字符串的幼稚实现。

~~其他最佳选择是什么？~~

* * *

*   排序：首先按长度（最短的优先），然后按字典顺序。
*   指定要在生成中使用的字符范围：所有可打印或 [AZ]、[az]、数字、特殊符号和最终空格（正则表达式？）的任何可能组合。
*   字符串长度以给定的最小值/最大值为界。
*   搜索空间受边界限制：开始字符串和结束字符串，可以过滤（正则表达式？）

* * *

**上次编辑**

首先，我使用*正则表达式*而不是正则表达式来改写标题。

我正在考虑*修改第一个要求*，因为它是一扇敞开的大门，可能会导致难以*解决的问题*。

我需要正确措辞的建议和帮助。

第二个想法要求编辑完成。仍然对改进建议持开放态度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T17:35:32.597

老问题，但没有人回答，赏金仍然有效，我已经准备好解决方案，所以这里有一个可能的答案：

我曾经写过一个[小程序](http://www.benibela.de/tools_en.html#regexgen)来做到这一点。然而，它是在 C++/Qt 中的（虽然我几乎所有的程序都是用 Delphi 编写的，其中一个是 C++ 的），不支持 Unicode 并且不保证顺序

**它的工作原理如下：**

1.  全部 ？{} + * | () 运算符被扩展（到最大限制），因此只保留字符类和反向引用。

    例如`[a-c]+|t*|([x-z]){2}foo\1|(a|b)(t|u)` 变成`[a-c]|[a-c][a-c]|[a-c][a-c][a-c]|[a-c][a-c][a-c][a-c]||t|tt|tt|ttt|ttt|([x-z][x-z])foo\1|at|au|bt|bu`

    （后一个表达式中的 | 只是符号，程序将每个替代子正则表达式保存在一个列表中）

2.  对多个字符的反向引用被对单个字符的反向引用替换。

    例如上面的表达式变成`[a-c]|[a-c][a-c]|[a-c][a-c][a-c]|[a-c][a-c][a-c][a-c]||t|tt|tt|ttt|ttt|([x-z])([x-z])foo\1\2|at|au|bt|bu`

    现在每个替代子正则表达式都匹配一个固定长度的字符串。

3.  对于每个备选方案，都会打印从类中挑选字符的所有组合：

    例如上面的表达式变成`a|b|c|aa|ba|..|cc|aaa|baa|...|ccc|aaaa|...|cccc||t|tt|tt|ttt|ttt|xxfooxx|yxfooyx|...|zzfoozz|at|au|bt|bu`

**您可能可以添加 shortlex 订单保证，如下所示：**

1.  按字母顺序对类中的字符进行排序

2.  对上述第 2 步中获得的备选方案进行排序以获取长度

    （有成倍增加的替代方案，但与结果字符串的数量相比，它们的数量通常可以忽略不计）

3.  对字符类和反向引用进行排序/交换，使每个引用向后指向

4.  像以前一样枚举单个固定长度替代方案的可能字符串，但从最后一个字符类开始，而不是从第一个字符类开始以获得字母顺序。

    （如果有任何指向前方的反向引用，这将不起作用）

5.  如果有多个相同长度的替代项，请以“并行”方式枚举它们，比较它们当前的字符串并按字母顺序打印最低的。（即合并每个备选方案的已排序列表。）

    这可以被优化，例如通过检测后缀中的不同前缀和安全字符类，可以在不影响排序的情况下进行枚举。（例如 a[az]|b[az] 具有不同的前缀，并且 [az] 可以在没有任何比较的情况下枚举）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-30T19:21:08.453

我会通过为该语言构建最小[确定性有限自动机](http://en.wikipedia.org/wiki/Finite-state_machine)来做到这一点。如果您从正则表达式开始，这可以通过 Thompson 构造自动完成，然后是子集构造和最小化。例如，请参阅[此说明](http://lambda.uta.edu/cse5317/notes/node9.html)。

有了 DFA，您可以使用以下算法：

```
Let P = { < START, [""] > } be a set of pairs <State, list of strings>
for n = 0, 1, ... Max
  Let P' = {} be a new set 
  while P is not empty 
    Remove the pair <s, L> from P 
    For each transition s -- c --> t in alpha order of c
      if t is an accepting state,
          output l + c for each string l in L
      put <t, L + c> in P' (** i.e. append c to each string in L)
  end
  Set P = P'
end 
```

请注意，标记的步骤`**`必须是真正的集合插入，因为很容易出现重复项。

这是一个核心算法。`P`可以随着输出长度呈指数增长，但这只是跟踪未来输出字符串的所有可能性的代价。您提到的顺序/大小/空间限制可以通过在列表中保持排序顺序`L`并在达到资源限制时切断搜索来确保。

**编辑**

这是一个玩具 Java 示例，我在其中硬编码了带有可选减号的简单二进制浮点文字的 DFA。这使用与上面的伪代码略有不同的方案来获得严格的输出排序顺序并适应字符范围。

```
import java.util.Comparator;
import java.util.TreeSet;

public class Test{

    public static class DFA {

        public static class Transition  {

            final int to;
            final char lo, hi; // Character range.

            public Transition(int to, char lo, char hi) {
                this.to = to;
                this.lo = lo;
                this.hi = hi;
            }

            public Transition(int to, char ch) {
                this(to, ch, ch);
            }
        }

        // transitions[i] is a vector of transitions from state i.
        final Transition [] [] transitions;

        // accepting[i] is true iff state i is accepting
        final boolean [] accepting;

        // Make a fresh immutable DFA.
        public DFA(Transition [] [] transitions, boolean [] accepting) {
            this.transitions = transitions;
            this.accepting = accepting;
        }

        // A pair is a DFA state number and the input string read to get there.
        private static class Pair {
            final int at;
            final String s;

            Pair(int at, String s) {
                this.at = at;
                this.s = s;
            }
        }

        // Compare pairs ignoring `at` states, since 
        // they are equal iff the strings are equal.
        private Comparator<Pair> emitOrder = new Comparator<Pair>() {
            @Override
            public int compare(Pair a, Pair b) {
                return a.s.compareTo(b.s);
            }
        };

        // Emit all strings accepted by the DFA of given max length.
        // Output is in sorted order.
        void emit(int maxLength) {
            TreeSet<Pair> pairs = new TreeSet<Pair>(emitOrder);
            pairs.add(new Pair(0, ""));
            for (int len = 0; len <= maxLength; ++len) {
                TreeSet<Pair> newPairs = new TreeSet<Pair>(emitOrder);
                while (!pairs.isEmpty()) {
                    Pair pair = pairs.pollFirst();
                    for (Transition x : transitions[pair.at]) {
                        for (char ch = x.lo; ch <= x.hi; ch++) {
                            String s = pair.s + ch;
                            if (newPairs.add(new Pair(x.to, s)) && accepting[x.to]) {
                                System.out.println(s);
                            }
                        }
                    }
                }
                pairs = newPairs;
            }
        }
    }

    // Emit with a little DFA for floating point numbers.
    public void run() {
        DFA.Transition [] [] transitions = {
            {   // From 0
                new DFA.Transition(1, '-'),
                new DFA.Transition(2, '.'),
                new DFA.Transition(3, '0', '1'),
            },
            {   // From 1
                new DFA.Transition(2, '.'),
                new DFA.Transition(3, '0', '1'),
            },
            {   // From 2
                new DFA.Transition(4, '0', '1'),
            },
            {   // From 3
                new DFA.Transition(3, '0', '1'),
                new DFA.Transition(4, '.'),
            },
            {   // From 4
                new DFA.Transition(4, '0', '1'),
            }  
        };
        boolean [] accepting = { false, false, false, true, true };
        new DFA(transitions, accepting).emit(4);
    }

    public static void main (String [] args) {
        new Test().run();
    }
} 
```~~

# c# - 在 c# 中将大量图像显示为缩略图的最佳实践

> ID：10033134
> 
> 赞同：1
> 
> 时间：2012-04-05T17:25:52.947
> 
> 标签：c#, winforms, image-processing, design-patterns

我已经到了通过调试和跟踪对象很难得到答案的地步，所以我需要一些帮助。

**我正在尝试做的事情：** 我的屏幕捕捉宠物项目的历史表格。历史记录必须将所有图像列为缩略图（例如：picasa）。

**我做了什么：** 我创建了一个 HistoryItem:UserControl。这个历史项目有几个按钮、一个复选框、一个标签和一个图片框。这些按钮用于删除/编辑/复制图像。复选框用于选择一个或多个图像，标签用于一些信息文本。图片框从作为路径的公共属性获取图像，并且一个方法创建一个比例缩略图以在加载控件时显示它。此用户控件有两个公共事件。一种用于删除图像，另一种用于使鼠标进入和鼠标离开所有控件的事件冒泡。为此，我使用[EventBroadcastProvider](http://www.codeproject.com/Articles/13216/Broadcasting-Events-through-a-Control-Hierarchy)。冒泡很有用，因为无论我将鼠标移到控件上的哪个位置，按钮都会出现。dispose 方法已扩展，我手动删除了事件。

通过循环包含所有图像路径的 xml 文件来加载所有图像。对于此 XML 中的每个图像，我创建了一个新的 HitoryItem，它被添加到流布局面板中（经过一些编码以排序和限制加载的图像数量）。

**问题：** 当我在历史表单中午餐时，流布局面板中填充了我的 HistoryItem 自定义控件，我的内存使用量急剧增加。从 14Mb 到大约 100MB，加载了 100 张图像。通过关闭历史表单并处理我可以处理的任何内容，甚至尝试调用 GC.Collect() 内存增加仍然存在。我搜索任何无法像图像或事件一样正确处置的对象，但无论我在哪里使用它们，它们都会被处置。问题接缝来自多个来源。一是冒泡的事件没有正确处理，二是来自图片框本身。当仅加载没有任何图像处理甚至事件的自定义控件时，我可以通过将所有代码注释为有限版本来看到所有这些。如果没有这些事件，内存消耗就会减少 20%。

* * *

所以我真正的问题是，如果这种逻辑、流布局面板和带有图片框的自定义控件，是否是将大量图像显示为缩略图的最佳解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:29:23.410

我曾经这样做过，但在内存管理方面很糟糕。例如，您冒着越来越多的 GDI 句柄的风险（例如，如果每个控件都创建 Font 或其他 GDI 对象实例），而这个问题不能用 GC.Collect() 解决。

我在 ComponentOwl.com 工作，我们开发了一个用于管理图像缩略图的控件，称为[Better Thumbnail Browser](http://www.componentowl.com/better-thumbnail-browser)，它还可以为您加载、调整大小和缓存缩略图：

![更好的缩略图浏览器概述](../Images/02fc59202e09661164012dd49fc81a3c.png)

他们还有一个名为[Better ListView Express](http://www.componentowl.com/better-listview-express)的免费组件，它仍然对图像缩略图有很好的支持。

# php - 具有 http 访问权限的 codeigniter cron 作业

> ID：10033136
> 
> 赞同：1
> 
> 时间：2012-04-05T17:26:05.287
> 
> 标签：php, http, codeigniter, cron

对不起，如果这是一个重复的问题......我已经四处搜索并找到了类似的建议，但没有任何帮助我的确切问题。请原谅菜鸟的问题，CRON 对我来说是新事物。

我有一个 codeigniter 脚本，它抓取另一个站点的 html DOM 并将其中的一些存储在数据库中。我想定期运行这个脚本。这使我开始研究 cron 工作。

我的页面位于 myserver.com/index.php/update

我意识到我可以使用 curl 运行 cron 作业并运行此页面。如果我想更安全一点，我可以在末尾添加一个字符串，例如：

myserver.com/index.php/update/asdfh2784fufds

并在我的 CI 控制器中检查。

这似乎是最安全的，但似乎不是做事的“正确”方式。

我已经研究过从命令行运行 CI，并且可以执行基本页面，例如：

php index.php 我的控制器

但是当我尝试这样做时：

php index.php 更新

它不起作用。我怀疑这是因为它需要使用 HTTP 来抓取外部页面的 DOM。

所以，我的问题：

**如何使用需要 HTTP 访问的 cron 作业安全地运行 codeigniter 脚本？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:41:11.127

你有几个选择。最简单的方法是让您的脚本在执行之前确保`$_SERVER['REMOTE_ADDR']`来自同一台机器。

另一种方法是使用`https`并让 wget 或 curl 使用 HTTP 身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:26:24.697

究竟出了什么问题？它抛出了什么错误？

我之前在命令行中使用过 CI，没有任何问题。不要忘记，如果您不在脚本所在的文件夹中，您需要指定它的完整路径。

就像是

```
php /path/to/ci_folder/index.php update 
```

您也可以在控制器上添加。

```
if ($this->input->is_cli_request())
    // run the script
else
    // echo some message saying not allowed. 
```

仅当 php 脚本在命令行上运行时，这将运行所需的内容。

希望它有所帮助。

# c# - C# 反射列表：对象与目标类型不匹配

> ID：10033141
> 
> 赞同：3
> 
> 时间：2012-04-05T17:26:37.440
> 
> 标签：c#, reflection

尝试使用反射将类对象添加到列表中，但是当使用我的类对象作为参数调用 Add 方法时，我得到“对象与目标类型不匹配”

这是相关的代码段（您`classString = "Processor"`现在可以假设）

```
PC fetched = new PC();

// Get the appropriate computer field to write to
FieldInfo field = fetched.GetType().GetField(classString);

// Prepare a container by making a new instance of the reffered class
// "CoreView" is the namespace of the program.
object classContainer = Activator.CreateInstance(Type.GetType("CoreView." + classString));

/*
    classContainer population code
*/

// This is where I get the error. I know that classContainer is definitely
// the correct type for the list it's being added to at this point.
field.FieldType.GetMethod("Add").Invoke(fetched, new[] {classContainer}); 
```

然后这是上面代码将 classContainers 添加到的类的一部分：

```
public class PC
{
    public List<Processor> Processor = new List<Processor>();
    public List<Motherboard> Motherboard = new List<Motherboard>();
    // Etc...
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T17:30:36.287

您正在尝试调用- 您想根据字段的`List.Add(Processor)`值*调用*它：`PC`

 *```
field.FieldType.GetMethod("Add").Invoke(field.GetValue(fetched),
                                        new[] {classContainer}); 
```

但是，我个人建议您*不要*使用这样的公共字段。考虑改用属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-03T04:39:12.787

此方法会将新项目添加到所有列表//只是而不是插入使用添加

```
 IList list = (IList)value;// this what you need to do convert ur parameter value to ilist

        if (value == null)
        {
            return;//or throw an excpetion
        }

        Type magicType = value.GetType().GetGenericArguments()[0];//Get class type of list
        ConstructorInfo magicConstructor = magicType.GetConstructor(Type.EmptyTypes);//Get constructor reference

        if (magicConstructor == null)
        {
            throw new InvalidOperationException(string.Format("Object {0} does not have a default constructor defined", magicType.Name.ToString()));
        }

        object magicClassObject = magicConstructor.Invoke(new object[] { });//Create new instance
        if (magicClassObject == null)
        {
            throw new ArgumentNullException(string.Format("Class {0} cannot be null.", magicType.Name.ToString()));
        }
        list.Insert(0, magicClassObject);
        list.Add(magicClassObject); 
```*

# c++ - C++11 Lambda 表达式作为回调函数

> ID：10033142
> 
> 赞同：6
> 
> 时间：2012-04-05T17:26:42.857
> 
> 标签：c++, user-interface, lambda, callback, c++11

是否有任何 C++ GUI 工具包支持将回调函数定义为 C++11 lambda 表达式？我相信这是使用 C#（至少与 C++ 相比）编写基于 GUI 的程序的独特优势。对于将 lambda 表达式作为参数的函数，我应该使用什么类型签名，这些签名如何支持隐式转换？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T17:45:35.807

问题第二部分的答案：您可以使用`std::function<Signature>`where `Signature`= eg`void (int)`或 - 如果 lambda 不采用闭包 - 好的旧`void (Foo*)(int)`方法，因为没有闭包的 lambda 必须可转换为正确的函数类型。因此，例如调用带有签名的方法：

```
void AddHandler(std::function<void (int)> const &); 
```

可能看起来像这样：

```
myObject.AddHandler([&](int _) {
    // do something and access captured variables by reference
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T19:06:59.090

> 是否有任何 C++ GUI 工具包支持将回调函数定义为 C++11 lambda 表达式？

如果他们接受函数指针，那么您至少可以使用不捕获任何内容的 lambda。这样的 lambda 可以自动转换为函数指针。

> 对于将 lambda 表达式作为参数的函数，我应该使用什么类型签名，这些签名如何支持隐式转换？

如果您希望人们使用 lambdas 或任何可调用对象，那么您可以让您的 API 接受 std::function 对象，或者使用模板：

```
template<typename Callback>
void do_it(Callback c) {
    c();
}

do_it([&]{ c = a+b; }); 
```

模板将允许内联 lambda，而 std::function 需要间接。这对于 GUI 回调可能无关紧要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T02:35:12.803

有一个新的 GUI 工具包可以满足您的要求。它试图提供许多功能来提高开发效率。

图书馆简介。 [http://nanaproject.wordpress.com/2011/12/16/preliminary-study-of-nana-c-library/](http://nanaproject.wordpress.com/2011/12/16/preliminary-study-of-nana-c-library/)

一篇文章解释了如何通过结合使用库和 std::bind 来降低复杂性。 [http://nanaproject.wordpress.com/2012/01/31/idioms-and-insights-for-a-good-design/](http://nanaproject.wordpress.com/2012/01/31/idioms-and-insights-for-a-good-design/)

玩得开心！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-22T06:38:01.077

使用 C++11 模板库，GUI 是否支持 lambda 并不重要。您可以使 GUI 对消息执行任何操作，并在域逻辑端保留相同的代码。查看这篇关于[驯服 Qt](http://templatious.org/goodstuff/virtual-packs)的文章和这些[示例](https://github.com/davidkazlauskas/DecoupledGuiExamples)。

# asp.net - ASP.NET 我应该在 pre_init 或 page_load 中使用“checkUser”函 数吗

> ID：10033148
> 
> 赞同：0
> 
> 时间：2012-04-05T17:27:26.463
> 
> 标签：asp.net

只是想知道我有一个检查页面语言（多语言站点）的功能，如果不是默认语言，我们需要重定向到一个部分的默认语言，即

```
if (Sitecore.Context.Language.Name != LanguageManager.DefaultLanguage.ToString())
{
     Sitecore.Context.SetLanguage(LanguageManager.DefaultLanguage, true);
     Response.Redirect(SourceHomeUrl(), true);
} 
```

我只是想知道最好将它放在 pre_init 中，即在加载任何内容之前进行此检查然后重定向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:32:11.687

如果您可以在 pre init 事件中执行此操作，则最好在此处执行此操作，以便您可以在发生任何额外/不必要的加载和处理之前重定向用户，而不是在 page_load 中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:33:36.943

这似乎是合理的，但我也会考虑处理多语言应用程序的其他替代方法，例如将特定语言的文本存储在数据库或资源文件中

[http://msdn.microsoft.com/en-us/goglobal/bb688115](http://msdn.microsoft.com/en-us/goglobal/bb688115)

# javascript - 创建一个插件以在另一个网站上添加我的网站功能

> ID：10033149
> 
> 赞同：1
> 
> 时间：2012-04-05T17:27:26.793
> 
> 标签：javascript, api, plugins, iframe, oauth

我有一个带有数据库和某个对象的搜索引擎的网站 A，用户可以在我的网站上创建帐户，然后为这些对象添加评论。我需要使用类似插件的东西创建一个 api，这将导致在另一个网站 B 上拥有搜索引擎。

本来打算做fb或twitter插件的：想要使用我的api的开发者只需要在网站B上添加一行js，一行html，然后它就会加载插件。但我想知道如何组织它。

这就是我的猜测：我在我的网站 A 上创建了一个页面，将搜索引擎放在上面。我创建了一个js，它将在开发者页面（网站B）上的iframe中加载这个页面，在他添加的div下拥有我的插件。然后我实施 OAuth 2（使用提供者等，因此人们可以发布请求以更改我的数据库），并且网站 B 中的一个人将能够在网站 B 上对搜索引擎的对象发表评论。

实际上它似乎与fb评论插件过程相同，但是做所有这些东西似乎太复杂了。这是正确的方法吗？谁能详细说明我在实施过程中应该面临的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T20:05:33.807

您需要开发一个体面的 API，它可以返回 JSON 格式的搜索结果（如果您想取悦所有人，还可以返回 XML）。这已经为其他开发人员提供了使用您网站功能的能力，这主要是后端工作。所以他们可以开发自己的小部件。

要将自己的小部件开发为搜索小部件，您不需要那么多，您只需要一个设置目标（可能是必需的元素）或/和一个初始化方法（对开发人员来说更灵活），然后将目标传递给该方法。

绑定搜索按钮，抓取术语搜索，调用您的 API，当您获得结果时显示它们或/并执行自定义回调将结果作为参数传递，灵活性）

如果你的 javascript 做得很好，你也可以在那里创建一个小 API，以便通过 javascript 使用你的 API。然后甚至可以轻松地将其移植到 jQuery 插件或类似的东西上。

提供 JSON 时，请始终记住为 API 设置标头以允许跨域或改为使用 jsonp。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T14:11:53.427

您的问题暗示了一个架构方向，但是对于这样的选择，要求太宽泛了。我会先缩小你的要求。OAuth 2.0 可能有助于满足您的需求，但至少要问自己以下问题：

*   需要保护哪些用户数据？
*   需要哪些第三方数据访问权限？什么功能？
*   如果您使用 OAuth 2.0，您准备好遵循仍在变化的规范吗？您愿意成为身份验证提供者吗？
*   可以接受哪些服务器端语言/平台？
*   还有哪些其他安全注意事项对您很重要？（如社交分享、第三方应用信任度...）
*   您愿意在多大程度上依赖第三方工具？还是自己写？

我同意将您的设计建模为 FB、Twitter 或 Google 并不是一个坏主意，因为他们已经做过这类事情。

您可以查看新书[OAuth 2.0 入门](http://shop.oreilly.com/product/0636920021810.do)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T23:09:43.040

如果您允许网站 B 在后台向网站 A 发出 POST 请求，OAuth 2 可能会有所帮助。

相反，如果您希望允许访问网站 B 的用户发表评论，那么带有指向网站 A 的表单的 iframe 就足够了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T23:18:02.047

以下是向用户提供自定义搜索的两种简单方法。

最简单的选择是做谷歌所做的事情——在你的网站上搜索将遵循一个简单的、定义明确的 API——这样

```
www.mysite.com/search?q=keyword1+keyword2 
```

以 HTML 格式返回结果列表。

然后你会告诉你的用户包含一段 HTML：

```
<form action="http://www.mysite.com/search" method="get">
   <input name="q" type="text" value="Search">
</form> 
```

这样做可以，尽管此时您可能希望通过更好的搜索选项、用于搜索表单的 javascript 包装器、用于返回数据的 JSON 或 XML 格式、安全性、更好地考虑所有这些的 API 来改进事物.

另一种方法是使用 javascript 并为数据提供回调工具，因此 URL：

```
www.mysite.com/js-search?q=keyword1+keyword2&callback=someHandle 
```

将返回一个包含 JSON 数据的 javascript 文件，并在加载时调用“someHandle”。使用您的 API 的开发人员必须编写自己的方式来发出请求和处理程序。请记住，由于 XSS，查询可能来自您合作伙伴的服务器。最简单的方法可能是让您自己的搜索提供简单且有据可查的内容，以便其他人可以利用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-14T04:30:41.437

更简单但不一定是最明智的选择是创建一些使用 JSONP 在您的网站上调用的 JS。

iFrame 不是 W3C 标准，尽可能避免使用它们。编写带有一些事件的 Javascript，这些事件将对您自己的服务器进行一些 JSONP 调用，并相应地以 Javascript 的形式返回结果，因此它能够与页面进行交互。

# java - 将 JLabels 添加到 JList？

> ID：10033152
> 
> 赞同：2
> 
> 时间：2012-04-05T17:27:48.390
> 
> 标签：java, swing, jlabel, jlist

到目前为止，我已经尝试简单地浏览我的标签并将每个标签添加到列表的列表模型中：

```
listModel.addElement(label); 
```

所以这是可行的，但它只是给出了标签的字符串表示，而不是实际的标签。

基本上，是否有可能有一个 JLabels 的 JList？如果没有，那么有一个可以更新的可滚动 JLabels 列表的好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:55:14.967

（几乎）永远不需要将 a`JComponent`放在 Swing 组件的模型端（`JList`, `JTree`, `JTable`, ... ）。在你的中`ListModel`，你把`Object`你想要可视化的 s 放在 a 中`JList`，然后让渲染器处理表示。

因此，如果您想将每个标签表示`Object`为特殊标签，您可以在渲染器中创建该标签。

有关更多信息，请参阅[Swing 列表教程](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)。本教程不包含自定义渲染器，而是让您[参考组合框教程的自定义渲染器部分](http://docs.oracle.com/javase/tutorial/uiswing/components/combobox.html#renderer)，这非常相似

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:41:39.680

`JList`, `JTable`,`JComboBox's popup`默认情况下`JLabel / JComponent`从 中返回`Renderer`，那么没有理由将这些`JComponents`类型放到`JList`（在这种情况下）

```
but it simply gives a string representation of the label rather than the actual label 
```

*   请阅读[Renderer](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)的工作原理、[JLabel](http://docs.oracle.com/javase/tutorial/uiswing/components/label.html)和[Icon以及](http://docs.oracle.com/javase/tutorial/uiswing/components/icon.html)[此处](http://www.java2s.com/Code/Java/Swing-JFC/Table-Renderer-Editor.htm)和[此处](http://www.exampledepot.com/egs/javax.swing.table/pkg.html)的示例，

*   的概念`Renderers`类似于`JList`, `JTable`,`JComboBox's popup`

# c# - 无法将方法组或将数组转换为列表作为其方法

> ID：10033156
> 
> 赞同：0
> 
> 时间：2012-04-05T17:28:05.630
> 
> 标签：c#, wcf, web-services, rest

我在下面的代码中收到一个错误，它说我无法将方法组 ListStudents 转换为 generic.list，如果我在 ListStudents 末尾尝试 () 我得到：无法将数组转换为列表

我想做的就是将一些用户硬编码到一个数组中并在我的 GET 请求中返回它们是否有解决方法？

```
 [WebInvoke(Method = "GET", BodyStyle = WebMessageBodyStyle.Bare, RequestFormat = WebMessageFormat.Xml, ResponseFormat = WebMessageFormat.Xml, UriTemplate = "")]
    List<Student> GetStudentCollection();
}
[DataContract(Name="Student")]
public class Student
{
    [DataMember(Name = "StudentID")]
    public string StudentID { get; set; }
    [DataMember(Name = "FirstName")]
    public string FirstName { get; set; }
    [DataMember(Name = "LastName")]
    public string LastName { get; set; }

}
public class RawDataService : IReceiveData
{
    public Student[] ListStudents()
    {
       List<Student> student = new List<Student>()
       {
           new Student { StudentID="bla", FirstName="bla", LastName="bla"},
           new Student { StudentID="bla1", FirstName="bla1", LastName="bla1"},
           new Student { StudentID="bla2", FirstName="bla2", LastName="bla2"}
       };
        return student.ToArray();
    }

    public List<Student> GetStudentCollection()
    {
        return ListStudents(); //error on this line, cant convert array to list
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:29:03.780

`ListStudents`是一个方法，而不是一个属性，所以试试这个：

```
return ListStudents(); 
```

此外，更改`ListStudents()`方法以返回`List`如下：

```
 public List<Student> ListStudents()
    {
        List<Student> student = new List<Student>()
        {
            new Student { StudentID="bla", FirstName="bla", LastName="bla"},
            new Student { StudentID="bla1", FirstName="bla1", LastName="bla1"},
            new Student { StudentID="bla2", FirstName="bla2", LastName="bla2"}
        };
        return student;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:30:58.300

尝试使用`ToList`linq 扩展方法：

```
using System.Linq;

...

public Student[] ListStudents()
{
   List<Student> student = new List<Student>()
   {
       new Student { StudentID="bla", FirstName="bla", LastName="bla"},
       new Student { StudentID="bla1", FirstName="bla1", LastName="bla1"},
       new Student { StudentID="bla2", FirstName="bla2", LastName="bla2"}
   };
    return student.ToArray();
}

public List<Student> GetStudentCollection()
{
    return ListStudents().ToList(); //<-- this is the change you need
} 
```

但是，为了**减少转换次数，**我建议更改方法如下：

```
public Student[] ListStudents()
{
   return GetStudentCollection().ToArray();
}

public IList<Student> GetStudentCollection()
{
   var students = new List<Student>()
   {
       new Student { StudentID="bla", FirstName="bla", LastName="bla"},
       new Student { StudentID="bla1", FirstName="bla1", LastName="bla1"},
       new Student { StudentID="bla2", FirstName="bla2", LastName="bla2"}
   };

   return students();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T17:35:33.793

除非您有使用数组的理由，否则只需按原样返回列表。为什么要花 CPU 向下转换为数组，然后再备份为 List：

```
public class RawDataService : IReceiveData
{
    public List<Student> ListStudents()
    {
       List<Student> students = new List<Student>()
       {
           new Student { StudentID="bla", FirstName="bla", LastName="bla"},
           new Student { StudentID="bla1", FirstName="bla1", LastName="bla1"},
           new Student { StudentID="bla2", FirstName="bla2", LastName="bla2"}
       };
        return students;
    }

    public List<Student> GetStudentCollection()
    {
        return ListStudents(); //error on this line, cant convert array to list
    } 
```

但是，如果您必须返回数组，则将出现错误的行更改为：

```
 using System.Linq;
  ...
  return ListStudents().ToList(); 
```

# java - RXTX 两路串行通信第一次运行后不发送数据

> ID：10033160
> 
> 赞同：2
> 
> 时间：2012-04-05T17:28:19.007
> 
> 标签：java, serial-port, pic, rxtx, serial-communication

我从 RXTX 网站编辑了一个已经制作的示例。我也是 Java 和串行通信编程的新手。

该应用程序一次完美运行。它从 PIC 中读取缓冲区并发送我输入的数字。LED 亮起，PIC 发回相同的缓冲区，要求输入一个数字。但是当我输入它时，LED 熄灭，没有任何东西再次亮起，我再次收到要求输入数字的消息。

微控制器的软件没有任何问题，因为它与超级终端完美配合。

代码如下：

```
import gnu.io.CommPort;
import gnu.io.CommPortIdentifier;
import gnu.io.SerialPort;
import gnu.io.SerialPortEvent;
import gnu.io.SerialPortEventListener;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

/**
 * This version of the TwoWaySerialComm example makes use of the 
 * SerialPortEventListener to avoid polling.
 *
 */
public class Test
{
    public Test()
    {
        super();
    }

    void connect ( String portName ) throws Exception
    {
        CommPortIdentifier portIdentifier = CommPortIdentifier.getPortIdentifier(portName);
        if ( portIdentifier.isCurrentlyOwned() )
        {
            System.out.println("Error: Port is currently in use");
        }
        else
        {
            CommPort commPort = portIdentifier.open(this.getClass().getName(),2000);

            if ( commPort instanceof SerialPort )
            {
                SerialPort serialPort = (SerialPort) commPort;
                serialPort.setSerialPortParams(9600,SerialPort.DATABITS_8,SerialPort.STOPBITS_1,SerialPort.PARITY_NONE);

                InputStream in = serialPort.getInputStream();
                OutputStream out = serialPort.getOutputStream();

                serialPort.addEventListener(new SerialReader(in));
                serialPort.notifyOnDataAvailable(true);

                (new Thread(new SerialWriter(out))).start();

            }
            else
            {
                System.out.println("Error: Only serial ports are handled by this example.");
            }
        }     
    }

    /**
     * Handles the input coming from the serial port. A new line character
     * is treated as the end of a block in this example. 
     */
    public static class SerialReader implements SerialPortEventListener 
    {
        private InputStream in;
        private byte[] buffer = new byte[1024];

        public SerialReader ( InputStream in )
        {
            this.in = in;
        }

        public void serialEvent(SerialPortEvent arg0) {
            int data;

            try
            {
                int len = 0;
                while ( ( data = in.read()) > -1 )
                {
                    if ( data == '\n' ) {
                        break;
                    }
                    buffer[len++] = (byte) data;
                }
                System.out.print(new String(buffer,0,len));
            }
            catch ( IOException e )
            {
                e.printStackTrace();
                System.exit(-1);
            }             
        }

    }

    /** */
    public static class SerialWriter implements Runnable 
    {
        OutputStream out;

        public SerialWriter ( OutputStream out )
        {
            this.out = out;
        }

        public void run ()
        {
            try
            {                
                int c = 0;
                while ( ( c = System.in.read()) > -1 )
                {
                    this.out.write(c);
                }                
            }
            catch ( IOException e )
            {
                e.printStackTrace();
                System.exit(-1);
            }            
        }
    }

    public static void main ( String[] args )
    {
        try
        {
            (new Test()).connect("COM3");
        }
        catch ( Exception e )
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:58:36.450

您的问题（对我来说）不清楚，因为不清楚您对图片进行了准确的编程。不过，我的猜测是，您对 \n 字符作为终止符的期望是导致问题的原因。

# asp.net - ASP.Net Stream I/O - 通过文件上传

> ID：10033163
> 
> 赞同：1
> 
> 时间：2012-04-05T17:28:31.287
> 
> 标签：asp.net, iis, telerik, filestream, memorystream

我有一个带有文件上传要求的 ASP.net 网络表单，最终用户将 Excel 文件（可能是 .csv）上传到网络服务器，然后通过 AJAX 样式回发填充一系列文本框。（页面使用 Telerik RadAjaxManager / VB asp.net 3.0）

当您从网页将文件上传到服务器时，它会在服务器上显示为内存流还是文件流？如何将此流（作为字符串）加载到 ADO 数据表中？

这是我在概念和编码方面遇到一些困难的地方。

1.  上传的文件是内存流还是我需要将它存储在服务器上的 Tmp 目录中以便我可以读取它？我宁愿不创建任何 tmp 文件（除非它们被我的服务器自动处理掉）。

2.  如何从 Stream in 转到可以用逗号分割的 String？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T21:14:39.643

我对 Telerik 的 RadAsyncUpload - [Telerik RadAsyncUploadDemos](http://demos.telerik.com/aspnet-ajax/upload/examples/async/webmail/defaultcs.aspx?product=asyncupload)很幸运- 它适用于 Ajax 调用，因此您不必在上传时禁用 ajax。

它会将文件上传到流中，直到您回发。然后，您可以使用 UploadedFiles 属性访问它们。您可以选择通过 TargetFolder 属性指定文件夹位置，它会在成功上传和回发后将文件复制到该位置。

您可以使用 OnFileUpload 事件来处理上传的文件，然后将其解析出来，正如本帮助文章 - [RadControls for ASP.NET AJAX 文档 - OnFileUploaded 中所述](http://www.telerik.com/help/aspnet-ajax/asyncupload-fileuploadedevent.html)

# functional-programming - 查找是否存在重复 SML NJ

> ID：10033165
> 
> 赞同：5
> 
> 时间：2012-04-05T17:28:45.440
> 
> 标签：functional-programming, sml, smlnj

我想编写一个函数来搜索列表并查找此列表中是否有任何重复值。该函数应返回一个布尔值。这是我所在的位置，但这不起作用...

```
fun myFunc [] = true
myFunc(x::xs) = 
if(x=myFunc(xs)) then false
else myFunc(xs);

[1,2,2,3,4,5,6] should return true
[1,2,3,4,5,6,7] should return false
[1,2,3,4,5,6,1] should return true 
```

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T18:46:35.023

正如@Marcin 在评论中所说，一种简单有效的方法是使用 set 来检查重复。SML/NJ 在[Utility Library](http://www.smlnj.org/doc/smlnj-lib/Manual/util-lib-part.html#section:0)中有许多可用的集合结构。

关于您的功能，您无法比较`x`，`myFunc xs`因为它们的类型可能不同。空列表是没有重复的列表（`myFunc []`应该返回`false`）。

这有效：

```
fun duplicated [] = false
  | duplicated (x::xs) = (List.exists (fn y => x = y) xs) orelse (duplicated xs) 
```

然而，最坏情况的时间复杂度是*O(n ² )*（`n`是列表的长度），这是非常低效的。

# json - 用于执行限制的“Origin”http 标头的兼容性

> ID：10033166
> 
> 赞同：13
> 
> 时间：2012-04-05T17:28:48.360
> 
> 标签：json, security, http, rest, browser

我正在构建一个 RESTful JSON api，我担心[json 数据盗窃](http://jeremiahgrossman.blogspot.com/2007/01/gmail-xsrf-json-call-back-hackery.html)和[Cross-Site Request Forgery](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29)。

为解决这两个问题而创建的一个很好的解决方案是[Origin http 标头](https://wiki.mozilla.org/Security/Origin)。但是我担心这种方法与所有现代浏览器都不兼容。这是一个有效的担忧吗？由于兼容性问题，Origin http 标头是否无用？[在执行HTTP 引用检查](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#CSRF_Prevention_without_a_Synchronizer_Token)时是否应该考虑来源？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-29T10:34:41.347

这是兼容浏览器和已知问题的列表。现在由您决定是否可以忍受这些限制：

[我可以用吗...](http://caniuse.com/#search=CORS)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-05T03:12:34.973

这是一个有效的担忧。有人可能正在使用不完全支持它的旧浏览器。测试版中也可能存在错误。

还可以考虑添加 `X-Frame-Options: SAMEORIGIN`到您的 JSON API 以防止有人将您的网站包含到 iframe 中。

还可以考虑在返回的 JSON 响应前添加特殊字符，并在 JSON 解码器中手动将它们去掉。这就是 Google 的做法： [为什么 Google 会在前面添加 while(1)；到他们的 JSON 响应？](https://stackoverflow.com/questions/2669690/why-does-google-prepend-while1-to-their-json-responses)

此外，为了额外的安全性，请考虑为每个请求包含一个[随机数](https://en.wikipedia.org/wiki/Cryptographic_nonce)，并签署请求以验证它来自您的代码而不是网络钓鱼站点。这类似于[OAuth1.0 的](https://www.rfc-editor.org/rfc/rfc5849)工作方式。另一种方法是为每个会话生成一个自动过期的令牌，并在需要时刷新令牌。这就是[OAuth2.0](http://oauth.net/2/)的工作原理。这允许按需使访问无效，例如，如果您发现错误，则旧客户端必须升级。

# jquery - jScrollPane 和 NivoSlider WP 插件之间的 jQuery 冲突问题

> ID：10033167
> 
> 赞同：1
> 
> 时间：2012-04-05T17:28:52.917
> 
> 标签：jquery, jscrollpane, nivo-slider

我遇到了[jScrollPane](http://jscrollpane.kelvinluck.com/)和 NivoSlider WP 插件的冲突问题。在安装 NivoSlider 之前，jScrollPane 工作正常。安装后我收到以下错误：

```
$('.scrollpane').jScrollPane is not a function 
```

[我已经尝试了所有我知道的并且在文档](http://api.jquery.com/jQuery.noConflict/)中列出的 jQuery.noConflict 组合。

我还尝试了这里找到的所有建议：[jScrollPane 滚动条问题](https://stackoverflow.com/questions/5773821/jscrollpane-scrollbar-problem)

这包括使用 WPScrollPane 插件，尽管它确实阻止了错误的发生，但它似乎不起作用。

以下是带有冲突 JS 的 pastebin：

*   [尼沃滑块](http://pastebin.com/GenKX5fv)
*   [jScrollPane](http://pastebin.com/1SCZ51JB)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:44:08.407

我追踪了导致此问题的问题。NivoSlider WP 插件通过 Wordpress 中的[wp_footer()](http://codex.wordpress.org/Function_Reference/wp_footer)钩子包含了一个附加版本的 jQuery。为了解决这个问题，我进入了插件文件并编辑了 nivoslider4wp-show.php。

在我的 Wordpress 安装中：

> {wordpress 目录}/wp-content/plugins/nivo-slider-for-wordpress/nivoslider4wp-show.php

在第 32 行，我删除了：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script> 
```

问题解决了！

# grails - Grails 或 Play 框架的动态 ACL？

> ID：10033168
> 
> 赞同：2
> 
> 时间：2012-04-05T17:28:54.710
> 
> 标签：grails, playframework, acl

我正准备将一个 Java Swing 应用程序移植到网络上。该应用程序是一个多业务应用程序，因此对于每个业务将至少有一个管理员，并且该管理员可以将权限（针对每个模块）授予该业务的用户。

换句话说：我有模块帐户、客户和发票，以及读写权限。企业 A 有 3 个用户：John、Mike 和 Mary。

John 是管理员，授予 Mike 对客户和发票的读写访问权限，但没有对帐户的访问权限，并授予 Mary 对帐户的读写访问权限、对发票的读取访问权限以及对客户的无访问权限。

我的问题是：是否有任何模块/插件可以为 Play Framework 或 Grails 执行此操作？如果没有，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:45:55.763

[对于 Grails， Spring Security](http://grails.org/plugin/spring-security-core)和[Shiro](http://grails.org/plugin/shiro)都有插件

使用 Spring Security，您可以在运行时创建角色，并在运行时将用户添加到角色。

有一个名为[spring-security-ui](http://grails.org/plugin/spring-security-ui)的插件为您提供了执行此操作的 GUI，但我认为它不适合您的用例，因为您可能不希望 John 授予对他自己业务以外的其他业务的访问权限。Spring-security-ui 更像是一个超级管理员的 GUI。但是创建自己的用户界面来授予访问权限应该很容易。

您需要决定是否需要三个角色；ROLE_ADMIN、ROLE_READ 和 ROLE_WRITE，并添加额外的检查（例如过滤器）来检查用户是否正在尝试访问自己的业务。或者如果你想为每个业务动态添加三个角色，即ROLE_BUSINESS1_ADMIN、ROLE_BUSINESS2_ADMIN等。

动态添加角色：

```
String roleName = ...
def role = Role.findByAuthority(roleName) ?: new Role(authority: roleName).save() 
```

向用户添加角色：

```
PersonRole.create user, role, true 
```

（在上面的示例中，域对象称为 Person 和 Role，但您可以使用任何其他名称）

要为 URL 动态添加访问规则，您需要使用[Requestmap Instances Stored in the Database](http://grails-plugins.github.com/grails-spring-security-core/docs/manual/guide/5%20Configuring%20Request%20Mappings%20to%20Secure%20URLs.html#5.3%20Requestmap%20Instances%20Stored%20in%20the%20Database)，或者您可以通过编程方式检查访问`SpringSecurityUtils.ifAnyGranted(roles)`

我没有使用 Shiro 的经验，但我想它可以做同样的事情。

# plugins - 从 CRM 4.0 中检索实体，但我没有相应的 guid

> ID：10033172
> 
> 赞同：0
> 
> 时间：2012-04-05T17:29:05.160
> 
> 标签：plugins, entity, crm

我正在开发一个插件。每当发生联系人更新时，该插件都应该做一些事情。我正在使用 service.Retreive("contact",guid,cols) 检索整个联系人对象。

有没有办法访问/检索 CRM 中存在的其他实体？我的要求是，每当有联系人更新事件时，我想更新组织中存在的另一个实体，而我没有该实体的 guid。

非常感谢您的帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T03:49:23.013

我不太确定我是否正确理解了你..

首先，如果您想使用您为其注册事件的实体的字段，则不必使用“Retrive”方法。您可以使用图像。在每个步骤中，您都可以附加“Pre”和“Post”图像。Image 在核心平台操作发生之前或操作完成之后获取主要实体的属性。

当然，您可以通过插件访问其他实体（即使您没有 GUID）。为此，您可以使用 Fetch 或 Query Expression。

更多信息[在这里（crm4）](http://msdn.microsoft.com/en-us/library/bb928429.aspx)。希望这可以帮助。

# c# - 如何在我的 XML 中找到特定节点？

> ID：10033173
> 
> 赞同：16
> 
> 时间：2012-04-05T17:29:08.137
> 
> 标签：c#, xml, nodes

我必须从以下 XML 中读取 xml 节点“名称”，但我不知道该怎么做。

这是 XML：

```
<?xml version="1.0" standalone="yes" ?>
  <games>
    <game>
      <name>Google Pacman</name>
      <url>http:\\www.google.de</url>
    </game>
  </games> 
```

代码：

```
using System.Xml;

namespace SRCDSGUI
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            XmlDocument doc = new XmlDocument();
            doc.Load(Application.StartupPath + @"\games.xml");

            XmlElement root = doc.DocumentElement;
            XmlNodeList nodes = root.SelectNodes("//games");

            foreach (XmlNode node in nodes)
            {
                listBox1.Items.Add(node["game"].InnerText);
            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-05T17:37:25.337

也许试试这个

```
XmlNodeList nodes = root.SelectNodes("//games/game")
foreach (XmlNode node in nodes)
{
    listBox1.Items.Add(node["name"].InnerText);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-12-12T11:30:48.537

或者试试这个：

```
XmlNodeList nodes = root.GetElementsByTagName("name");
for(int i=0; i<nodes.Count; i++)
{
listBox1.Items.Add(nodes[i].InnerXml);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T17:37:53.840

你真的很接近 - 你找到了游戏节点，你为什么不更进一步，如果它作为游戏下的子节点存在，你为什么不更进一步，只获取名称节点？

在你的每个循环中：

```
listBox1.Items.Add(node.SelectSingleNode("game/name").InnerText); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-06T19:40:58.920

这是一个简单函数的示例，它从 XML 文件中查找并获取两个特定节点并将它们作为字符串数组返回

```
private static string[] ReadSettings(string settingsFile)
    {
        string[] a = new string[2];
        try
        {
            XmlTextReader xmlReader = new XmlTextReader(settingsFile);
            while (xmlReader.Read())
            {
                switch (xmlReader.Name)
                {
                    case "system":
                        break;
                    case "login":
                        a[0] = xmlReader.ReadString();
                        break;
                    case "password":
                        a[1] = xmlReader.ReadString();
                        break;
                }

            }    
            return a;
        }
        catch (Exception ex)
        {
            return a;
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-23T12:02:43.353

```
import xml.etree.ElementTree as ET

tree= ET.parse('name.xml')
root= tree.getroot()

print root[0][0].text 
```

*   根=游戏
*   根[0] = 游戏
*   根[0][0] = 名称
*   根[0][1] = 网址
*   使用“.text”获取值的字符串表示
*   这个例子是使用python

# java - 无法在 Glassfish 中为 h2 数据库创建连接池和数据源

> ID：10033181
> 
> 赞同：0
> 
> 时间：2012-04-05T17:29:38.417
> 
> 标签：java, jakarta-ee, glassfish, h2

这是我的 glassfish-resources.xml：

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE resources PUBLIC "-//GlassFish.org//DTD GlassFish Application Server 3.1 Resource Definitions//EN" "http://glassfish.org/dtds/glassfish-resources_1_5.dtd">
<resources>
  <jdbc-connection-pool res-type="javax.sql.DataSource"
datasource-classname="org.h2.jdbcx.JdbcDataSource"
pool-resize-quantity="1" max-pool-size="5" steady-pool-size="0"
statement-timeout-in-seconds="60" name="jdbc/test_pool">
    <property name="driverClass" value="org.h2.Driver"/>
    <property name="URL" value="jdbc:h2:D:\test\test;IFEXISTS=TRUE;AUTO_SERVER=TRUE"/>
    <property name="User" value="root"/>
    <property name="Password" value="root"/>
  </jdbc-connection-pool>
  <jdbc-resource object-type="system-all" enabled="true" jndi-name="jdbc/test" pool-name="jdbc/test_pool" />
</resources> 
```

通过m2eclipse使用**maven glassfish插件**将war部署到服务器后，当我这样做时，`asadmin> list-jdbc-connection-pools`我的连接池不在列表中。我真的迷路了

**编辑。**

```
asadmin add-resources 
```

出于某种原因工作正常

Glassfish 3.1.2（构建 23）

POM.xml：

```
 <dependency>
                <groupId>org.glassfish</groupId>
                <artifactId>maven-embedded-glassfish-plugin</artifactId>
                <version>3.1.1</version>
                <type>maven-plugin</type>
            </dependency>

<plugin>
                <groupId>org.glassfish.maven.plugin</groupId>
                <artifactId>maven-glassfish-plugin</artifactId>
                <version>2.1</version>
                <configuration>
                    <glassfishDirectory>d:\glassfish3</glassfishDirectory>
                    <user>admin</user>
                    <passwordFile>d:\password.txt</passwordFile>
                    <debug>true</debug>
                    <echo>true</echo>
                    <domain>
                        <name>domain1</name>
                        <adminPort>4848</adminPort> <!-- mandatory for mvn glassfish:deploy -->
                    </domain>
                    <components>
                        <component>
                            <name>${project.artifactId}</name>
                            <artifact>${project.build.directory}/${project.build.finalName}.war</artifact>
                        </component>
                    </components>
                </configuration>
            </plugin> 
```

**EDIT2** 问题已解决。谢谢大家！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:44:05.980

尝试直接从**管理控制台**添加连接池。然后**ping**看它是否在听。

# java - 通过 list.contains 方法未检测到数据表中的 JSF 重复值

> ID：10033187
> 
> 赞同：0
> 
> 时间：2012-04-05T17:30:47.200
> 
> 标签：java, jsf-2, primefaces, javabeans

好的，我有一个数据表，用户在上面输入一个显示在数据表中的值。现在，我已经在 backing bean 中编写了这段代码

```
if (countryList.contains(country)) {
            FacesMessage msg = new FacesMessage("Duplicated", "This country has already been added");
            FacesContext.getCurrentInstance().addMessage(null, msg);
        } else{

            countryList.add(country);
            this.country = new Country();
              } 
```

数据表和输入字段 xhtml 是

```
<p:outputPanel>  
                                <h:panelGrid columns="3" cellpadding="5" cellspacing="5">

                                    <p:column>
                                        <h:outputLabel for="country"  value="Country: "></h:outputLabel>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="country" maxlength="25" value="#{profileInfoManagedBean.country.country}" required="false" label="Country">
                                            <p:watermark value="Enter a country name" for="country" />
                                            <p:ajax event="blur" update="msg1" />
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:message id="msg1" for="country" display="icon"></p:message>
                                    </p:column>

                                </h:panelGrid>
                                <p:commandButton value="Add" action="#{profileInfoManagedBean.addCountry}" update=":mainForm" style="margin:10px 0" id="btnAdd"/>
                            </p:outputPanel> 
```

现在，问题是，当我第一次添加国家时，它没有检测到国家名称的重复。我正在使用 JSF 2.0。

# ruby-on-rails - 在 Rails 控制台中预览 activerecord 查询？

> ID：10033191
> 
> 赞同：3
> 
> 时间：2012-04-05T17:30:58.820
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

有没有办法在 Rails 控制台中预览查询而不执行它们？

编辑：我希望能够在不执行破坏性查询的情况下预览它们：

```
u = User.first
d = User.open_documents.first 
```

我想在不执行的情况下预览它：

```
u.open_documents.delete(d) 
```

在表达式末尾添加 .to_sql 的建议答案适用于

```
u.open_documents.to_sql 
```

但是当被调用时

```
u.open_documents.delete(d).to_sql 
```

执行 delete(!) 并产生错误：

```
NoMethodError: undefined method `to_sql' for #<Array:0x585e4a8> 
```

当像这样调用时，我也得到一个错误：

```
u.open_documents.first.to_sql
NoMethodError: undefined method `to_sql' for #<Array:0x585e4a8> 
```

任何解决方法的想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T17:53:50.303

您可以在 ActiveRecord::Relation 上调用 .to_sql 以查看将要执行的 SQL。

```
User.where(:id => 4).to_sql
 => "SELECT \"users\".* FROM \"users\"  WHERE \"users\".\"id\" = 4" 
```

此外，如果它是行中的最后一个命令，控制台只会自动执行关系（并实例化对象），因此您可以这样做：

```
relation = User.where(:id => 4); 1
=> 1 
```

从而为关系设置一个变量而不运行它。

我实际上不确定你想要这两个中的哪一个，但它们都是方便的技巧。

# php - 操作扫描的pdf文件php

> ID：10033193
> 
> 赞同：0
> 
> 时间：2012-04-05T17:31:21.413
> 
> 标签：php, pdf-generation

我的网络服务器上有一些 pdf 文件，我想在这些文件的每一页上附加我网站的签名并按原样保存。这些文件是扫描的，而不是纯文本。我想制作一个程序来读取这些文件并向它们添加签名。我尝试使用 fpdf 和 fpdi 文件，但在修改扫描页面时，它显示“FPDF 错误：无法在预期位置找到对象 (8, 0)”错误。我的应用程序不是基于 zend，所以我不想为此使用 zend_pdf，我尝试了许多其他选项，我正在使用共享主机，因此无法安装新的 php 扩展。是否有任何库或可以为我做的事情，或者如果我可以用纯 php 做到这一点。

# c++ - c++中下面这句话是什么意思

> ID：10033194
> 
> 赞同：3
> 
> 时间：2012-04-05T17:31:23.007
> 
> 标签：c++, new-operator, placement-new

> **可能的重复：**
> [C++ 的“新位置”](https://stackoverflow.com/questions/222557/cs-placement-new)

在下面的代码中，第 3 行代表什么，是类型转换的方式吗？要不然是啥

```
 void someCode()
 {
   char memory[sizeof(Fred)];     // Line #1
   void* place = memory;          // Line #2

   Fred* f = new(place) Fred();   // Line #3
   // The pointers f and place will be equal

   ...
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:32:27.327

这是**[Placement new](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.10)**的典型用法。
它允许您分配内存，然后在该特定内存位置构造对象。

第 3 行本质上只是调用构造函数`Fred::Fred()`。构造函数中的`this`指针`Fred`将等于`place`. 因此，返回的指针`f`将等于`place`。

# ldap - 正在开发的 ldap 架构

> ID：10033204
> 
> 赞同：1
> 
> 时间：2012-04-05T17:32:28.330
> 
> 标签：ldap

我已经使用 LDAP 很多年了，我在开发中为 LDAP 模式工作的大多数公司看起来就像生产中的模式 QA（Staging）。

等：后缀“dc=firm,dc=com”

几个月前我刚开始在一家新公司工作，SA 告诉我我做错了，在开发中后缀应该是后缀“dc=firm,dc=dev”。

我觉得这会带来很多问题，而不是编程和移动数据以进行测试等。我想对此发表一些看法。我看到这是一个数据，它应该看起来像生产、质量保证等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:55:06.420

“后缀”（实际上是“命名上下文”）是什么无关紧要。任何代码都应该完全独立于目录的内容，目录所在的位置（从网络的角度来看，服务器运行什么软件，该软件是什么版本等。任何“知道”这些事情的代码代码很差，不健壮，脆弱，容易出错。

# sql - 使用 Liquibase 进行数据库迁移有什么好处？

> ID：10033205
> 
> 赞同：8
> 
> 时间：2012-04-05T17:32:31.243
> 
> 标签：sql, liquibase

我正在评估 Liquibase 并试图弄清楚它在数据迁移方面是否比仅使用 SQL 脚本有任何优势。假设我正在执行以下操作：

我的版本 0 数据库架构如下所示：

```
CREATE TABLE  `Person` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `firstName` varchar(255) NOT NULL,
  `lastName` varchar(255) NOT NULL,
  PRIMARY KEY (`id`)
); 
```

数据库中填充了一些由以下插入表示的现有数据：

```
INSERT INTO `Person` (`id`, `firstName`, `lastName`) VALUES (1, 'foo', 'bar'); 
```

然后我决定向 Person 表添加另一列，该列不为空，但我不想丢失任何现有数据。从版本 0 到版本 1 的迁移脚本如下所示：

```
ALTER TABLE `Person` ADD COLUMN `dob` date DEFAULT NULL;

UPDATE `Person` set `dob` = '1970-01-01';

ALTER TABLE `Person` MODIFY COLUMN `dob` NOT NULL; 
```

Liquibase 能让这个用例变得更容易吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T17:38:54.660

liquibase 为您提供的主要功能是能够跟踪哪些更改已应用于哪些数据库。

在您的示例中，您列出的 SQL 将正是 liquibase 将执行的操作，但它将能够知道您的开发数据库是版本 Y，并且当您“更新”您的数据库时，它只会应用几个新的更改，而生产在版本 X 上，当您“更新”生产时，它将应用更多更改。

注意：liquibase 独立跟踪更改，而不是使用单个版本来支持多个开发人员和/或代码分支。

除了跟踪应用的更改之外，liquibase 可以为您带来的其他优势包括：

*   能够对多种数据库类型进行相同的更改描述。
*   能够在应用的内容中拥有 if/then 逻辑。
*   生成的数据库历史文档。
*   能够轻松指定更复杂的多语句更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T03:23:13.893

我最近经历了同样的事情。请参阅：[向现有表添加不可为空的列失败。“值”属性是否被忽略？](https://stackoverflow.com/questions/8904316/adding-a-non-nullable-column-to-existing-table-fails-is-the-value-attribute-b)

如果不将其设置为列的默认值，则无法（在单个 SQL 语句中）为现有行添加具有值的列。因此，如果您希望现有行具有与添加的新行不同的值（包括如果您根本不想要列上的默认值），您将需要至少两个 SQL 语句。因此，使用 liquibase 您仍然需要在您描述的三个步骤中添加此列。

所以我对你的问题的回答是：**是的，使用 liquibase 比仅维护一系列 SQL 脚本更有优势。但这不是其中之一。:)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T22:35:11.393

在我看来，螨给你两全其美。您可以继续使用您的 sql 脚本，它管理是否已在数据库上执行脚本，并为您提供与典型的基于 Rails 的迁移或 Liquibase 相同的上下功能。

让我知道你的想法。

[https://github.com/soitgoes/mite](https://github.com/soitgoes/mite)

# .net - 在 ruby 中使用带有 Cucumber 的通用 .NET 类

> ID：10033209
> 
> 赞同：0
> 
> 时间：2012-04-05T17:32:44.223
> 
> 标签：.net, ruby, cucumber, bdd

我们在 ruby​​ 下使用 Cucumber 和 .NET 绑定。

我们有一些我们想要测试的通用 .NET 类，但我们不确定如何在导入 .dll 后在 ruby​​ 中初始化它们（我们可以看到如何初始化非通用类）。

举个简单的例子，拿类

```
public class MessageAndResponse<TMessageType, TResponseType>
{
    TMessageType Message {get; set;}
    TResponseType Response {get; set;}
} 
```

我们将如何创建一个实例以在 Cucumber 和 Ruby 中使用？

# c# - 使用 XPathEvaluate 获取 Linq-to-Xml 查询中的文本节点值

> ID：10033212
> 
> 赞同：2
> 
> 时间：2012-04-05T17:33:00.953
> 
> 标签：c#, xpath, linq-to-xml

我最近遇到了一种情况，我必须使用 XPath 作为 Linq to XML 查询的一部分，发现它的行为有点奇怪。我确信还有其他方法可以使用本机 XElement API 方法解决问题，但在这种情况下，XPath 更适合定位我需要的特定 XML 文本值，因为文档结构非常复杂。我最终找到了一种让它工作的方法（见下文），但它不是很漂亮，这通常意味着我错过了一些东西。

我的问题是如何使用[XPathEvalute](http://msdn.microsoft.com/en-us/library/bb341675.aspx)或其他一些 XPath 方法返回一个字符串值，该字符串值可以在 where 语句中使用或作为 select 方法中新对象的一部分。我找到了一个在 LINQ 中使用大量强制转换和[Null 合并运算符](http://weblogs.asp.net/scottgu/archive/2007/09/20/the-new-c-null-coalescing-operator-and-using-it-with-linq.aspx)的解决方案，但必须有一种更清洁的方法。问题的根源在于 XPathEvaluate 方法通常会返回一个 XText 元素（强制转换为通用对象），但 Linq 将其转换为 IEnumerable 以便它可以延迟执行。当您尝试访问该对象的值时，这会导致问题，因为在执行查询之前它不会实现。

下面是示例： 使用以下 XML 文档查找所有拥有同名男孩和女孩的父母。这必须使用 XPath 查询来完成，因为在我的情况下，文档结构非常复杂。

```
//Use C# Program Language type in LinqPad
void Main()
{
    var xml = XElement.Parse(@"<Root>
        <Parent>
            <Boy>Anne</Boy>
        </Parent>
        <Parent>
            <Boy>Alex</Boy>
            <Girl>Alex</Girl>
        </Parent>
        <Parent>
            <Boy>Jay</Boy>
        </Parent>
    </Root>");

    var q1 = from e in xml.XPathSelectElements("/Parent")
             select e;

    q1.Dump();

    var q2 = from e in q1
             let boy = ((IEnumerable<Object>)e.XPathEvaluate("Boy/text()")).Cast<System.Xml.Linq.XText>().FirstOrDefault() ?? new System.Xml.Linq.XText("")
             let girl = ((IEnumerable<Object>)e.XPathEvaluate("Girl/text()")).Cast<System.Xml.Linq.XText>().FirstOrDefault() ?? new System.Xml.Linq.XText("")
             select new {t=boy.GetType(), b=boy, g=girl, same=(boy.Value==girl.Value)};

    q2.Dump();
} 
```

结果是：

![在此处输入图像描述](../Images/b27fc4644f47a240a68e8f1e667c704c.png)

您可以看到第二个元素被标识为具有同名的男孩和女孩。在仍然使用 XPath 的同时是否有更简洁的方法，或者我是否坚持使用上面的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T18:03:32.837

可以使用`XPathSelectElement`代替`XPathEvaluate`吗？

```
var q2 = from e in q1
         let boy = (string)e.XPathSelectElement("Boy")
         let girl = (string)e.XPathSelectElement("Girl")
         where boy.StartsWith("A") //Optional use in where statement
         select new { t = boy.GetType(), b = boy, g = girl, same = (boy == girl) }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:56:50.377

这个怎么样，不确定你是否需要't'。

```
var q2 = q1.Select (q => 
    new 
    { 
        Boy  = q.XPathSelectElement("Boy"),
        Girl = q.XPathSelectElement("Girl"),
    }
);

var q3 = q2.Select (q => 
    new 
    {
        Boy = q.Boy == null ? string.Empty : q.Boy.Value, 
        Girl = q.Girl == null ? string.Empty : q.Girl.Value
    } 
);

var q4 = q3.Select (q => new { q.Boy, q.Girl, same=q.Boy==q.Girl });

q4.Dump(); 
```

可以改写为

```
var q2 = q1.
    Select (q => new { Boy  = q.XPathSelectElement("Boy"),Girl = q.XPathSelectElement("Girl"),}).
    Select (q => new { Boy = q.Boy == null ? string.Empty : q.Boy.Value, Girl = q.Girl == null ? string.Empty : q.Girl.Value}).
    Select (q => new { q.Boy, q.Girl, same=q.Boy==q.Girl }
);

q2.Dump(); 
```

# javascript - 如何在我的网站上添加“添加到收藏夹”按钮或链接？

> ID：10033215
> 
> 赞同：52
> 
> 时间：2012-04-05T17:33:25.273
> 
> 标签：javascript, jquery, html, bookmarks

我正在使用 Drupal 建立一个网站。在每个页面的标题上，我想要一个图像（由我自定义设计），它将充当自定义的“添加到收藏夹”按钮。单击图像应将网站的 URL 添加到用户浏览器的收藏夹（书签）中。这应该适用于所有浏览器，IE7+、FF、Opera、Chrome。我无法在网上找到很多关于此的信息。我想 javascript 应该可以完成这项工作，但我在 Javascript 方面没有太多经验 :) 所以我需要你的帮助！

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-04-05T17:36:27.943

jQuery版本

```
$(function() {
  $('#bookmarkme').click(function() {
    if (window.sidebar && window.sidebar.addPanel) { // Mozilla Firefox Bookmark
      window.sidebar.addPanel(document.title, window.location.href, '');
    } else if (window.external && ('AddFavorite' in window.external)) { // IE Favorite
      window.external.AddFavorite(location.href, document.title);
    } else if (window.opera && window.print) { // Opera Hotlist
      this.title = document.title;
      return true;
    } else { // webkit - safari/chrome
      alert('Press ' + (navigator.userAgent.toLowerCase().indexOf('mac') != -1 ? 'Command/Cmd' : 'CTRL') + ' + D to bookmark this page.');
    }
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<a id="bookmarkme" href="#" rel="sidebar" title="bookmark this page">Bookmark This Page</a>
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-03-01T14:26:19.800

此代码是 iambriansreed 答案的更正版本：

```
<script type="text/javascript">
    $(function() {
        $("#bookmarkme").click(function() {
            // Mozilla Firefox Bookmark
            if ('sidebar' in window && 'addPanel' in window.sidebar) { 
                window.sidebar.addPanel(location.href,document.title,"");
            } else if( /*@cc_on!@*/false) { // IE Favorite
                window.external.AddFavorite(location.href,document.title); 
            } else { // webkit - safari/chrome
                alert('Press ' + (navigator.userAgent.toLowerCase().indexOf('mac') != - 1 ? 'Command/Cmd' : 'CTRL') + ' + D to bookmark this page.');
            }
        });
    });
</script> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-03T15:07:03.330

我遇到了一些 rel="sidebar" 的问题。当我在链接标签中添加它时，书签将在 FF 上工作，但在其他浏览器中停止工作。所以我通过代码添加 rel="sidebar" 来解决这个问题：

```
jQuery('.bookmarkMeLink').click(function() {
    if (window.sidebar && window.sidebar.addPanel) { 
        // Mozilla Firefox Bookmark
        window.sidebar.addPanel(document.title,window.location.href,'');
    }
    else if(window.sidebar && jQuery.browser.mozilla){
        //for other version of FF add rel="sidebar" to link like this:
        //<a id="bookmarkme" href="#" rel="sidebar" title="bookmark this page">Bookmark This Page</a>
        jQuery(this).attr('rel', 'sidebar');
    }
    else if(window.external && ('AddFavorite' in window.external)) { 
        // IE Favorite
        window.external.AddFavorite(location.href,document.title); 
    } else if(window.opera && window.print) { 
        // Opera Hotlist
        this.title=document.title;
        return true;
    } else { 
        // webkit - safari/chrome
        alert('Press ' + (navigator.userAgent.toLowerCase().indexOf('mac') != - 1 ? 'Command/Cmd' : 'CTRL') + ' + D to bookmark this page.');

    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-16T23:54:16.677

```
 if (window.sidebar) { // Mozilla Firefox Bookmark
     window.sidebar.addPanel(document.title,location.href,""); 
```

它添加了书签，但在侧边栏中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-01T14:01:18.380

感谢@Gert [Grenander](https://stackoverflow.com/questions/3024745/cross-browser-bookmark-add-to-favorites-javascript/3024846#3024846)、[@Alaa.Kh](https://stackoverflow.com/questions/10033215/how-do-i-add-an-add-to-favorites-button-or-link-on-my-website/19162706#19162706)和[Ross Shanon](http://www.yourhtmlsource.com/javascript/addtofavorites.html)

尝试下订单：

一切正常——除了 Firefox 书签功能。出于某种原因，“window.sidebar.addPanel”不是调试器的功能，尽管它工作正常。

问题是它从调用`<a ..>`标签中获取值：title 作为书签名称，href 作为书签地址。所以这是我的代码：

javascript:

```
$("#bookmarkme").click(function () {
  var url = 'http://' + location.host; // i'm in a sub-page and bookmarking the home page
  var name = "Snir's Homepage";

  if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1){ //chrome
    alert("In order to bookmark go to the homepage and press " 
        + (navigator.userAgent.toLowerCase().indexOf('mac') != -1 ? 
            'Command/Cmd' : 'CTRL') + "+D.")
  } 
  else if (window.sidebar) { // Mozilla Firefox Bookmark
    //important for firefox to add bookmarks - remember to check out the checkbox on the popup
    $(this).attr('rel', 'sidebar');
    //set the appropriate attributes
    $(this).attr('href', url);
    $(this).attr('title', name);

    //add bookmark:
    //  window.sidebar.addPanel(name, url, '');
    //  window.sidebar.addPanel(url, name, '');
    window.sidebar.addPanel('', '', '');
  } 
  else if (window.external) { // IE Favorite
        window.external.addFavorite(url, name);
  } 
  return;
}); 
```

html:

```
 <a id="bookmarkme" href="#" title="bookmark this page">Bookmark This Page</a> 
```

* * *

`<a href="javascript:window.external.addFavorite('http://tiny.cc/snir','snir-site')">..</a>` 在 Internet Explorer 中，'addFavorite':和 'AddFavorite':之间存在差异 `<span onclick="window.external.AddFavorite(location.href, document.title);">..</span>`。

这里的例子：http: [//www.yourhtmlsource.com/javascript/addtofavorites.html](http://www.yourhtmlsource.com/javascript/addtofavorites.html)

重要的是，在 chrome 中，我们无法使用 js ( [aspnet-i](http://www.codeproject.com/script/Membership/View.aspx?mid=3644865) ) 添加书签：http: [//www.codeproject.com/Questions/452899/How-to-add-bookmark-in-Google-Chrome-Opera-and-安全部队](http://www.codeproject.com/Questions/452899/How-to-add-bookmark-in-Google-Chrome-Opera-and-Saf)

# linux - gdb - 使用物理内存转储文件调试内核

> ID：10033221
> 
> 赞同：2
> 
> 时间：2012-04-05T17:34:02.967
> 
> 标签：linux, debugging, gdb, crash-dumps

我有一个物理内存转储文件和一个符号文件（vmlinux），我想用 gdb 中的符号文件分析转储文件的内容。例如，要查看物理内存转储时 init_task 的状态：

```
(gdb) print &init_task
=> show the address of init_task in physical memory dump file, said 0xc0XXXXXX

(gdb) print ((struct task_struct *) 0xc0XXXXXX)->tasks
=> show the content of init_task.tasks in physical memory dump file) 
```

我刚刚尝试了 gdb 命令“restore”和“target core”，都不起作用。“restore”需要在正在运行的进程上使用，“target core”需要在核心文件（ELF 64-bit LSB core file）中作为输入。

```
(gdb) restore binary physical-memory-dump-file
You can't do that without a process to debug.

(gdb) target core physical-memory-dump-file
"physical-memory-dump-file" is not a core dump: File format not recognized 
```

任何想法？谢谢。

更新1：嗨，帕万，感谢您的提醒；因为我在特殊平台上工作，所以它上面的引导加载程序会将完整的物理内存保存到转储文件中，在内核从恐慌/糟糕重启后。所以物理内存转储文件将与物理内存具有相同的大小，并且可以从它的第一个字节映射到内核中的 0xc000:0000。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T04:21:54.317

物理内存转储和核心文件并不完全相同。核心文件只是映射到地址空间的可执行映像；当内核崩溃时，它应该在内存中的某个位置留下一个 ELF 文件，其中硬编码的地址指向图像的其他部分。在 GDB 接受它并匹配您拥有的符号之前，您可能必须从您拥有的内存转储中提取 ELF 图像（去除未使用的部分）。

# iphone - NSDate 来自 NSString - dateFromString 返回 nil

> ID：10033224
> 
> 赞同：0
> 
> 时间：2012-04-05T17:34:14.987
> 
> 标签：iphone, time, nsdate, nsdateformatter

我想从日期字符串中获取 NSDate 对象，但它返回 nil。我究竟做错了什么？谢谢！

```
NSString *dateString = @"2012-04-05T13:27:32.369Z";

NSDateFormatter* df = [[NSDateFormatter alloc]init];
[df setDateFormat:@"YYYY-MM-dd'T'HH:mm:ss.SSSZ"];
NSDate* date = [df dateFromString:dateString];
NSLog(@"1%@",date);
[df release]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:54:21.193

必须引用“Z”：

```
NSDateFormatter* df = [[NSDateFormatter alloc]init];
NSString *dateString = @"2012-04-05T13:27:32.369Z";
[df setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"];
NSDate* date = [df dateFromString:dateString];
NSLog(@"1: %@",date);

NSString *newDateString = [df stringFromDate:date];
NSLog(@"2: %@",newDateString); 
```

NSLog 输出：

> 1: 2012-04-05 17:27:32 +0000
> 2: 2012-04-05T13:27:32.369

请记住，`NSLog`将`NSDate`默认格式化程序与当前时区一起使用。

请参阅：[Date_Field_Symbol_Table](http://unicode.org/reports/tr35/#Date_Field_Symbol_Table)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:37:02.683

应该是`yyyy`几年

```
[df setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:05:19.043

使用 NSDateFormatter 获取 NSDate 然后使用 - (NSTimeInterval)timeIntervalSince1970 获取自 1970 年以来的秒数。

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setTimeZone:[NSTimeZone timeZoneWithName:@"UTC"]];
[formatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"];
NSDate *date = [formatter dateFromString:@"2012-04-05T13:27:32.369Z"];
NSLog(@"Date: %@", date);
NSLog(@"1970: %f", [date timeIntervalSince1970]);
NSLog(@"sDate: %@", [formatter stringFromDate:date]);
[formatter release]; 
```

希望能帮助到你。

# objective-c - Objective-C 可重入函数

> ID：10033226
> 
> 赞同：1
> 
> 时间：2012-04-05T17:34:17.430
> 
> 标签：objective-c, deadlock, reentrancy

我是Objective C的新手，我遇到了以下问题：

```
-(void) funcA
{
   // array is NSMutableArray within class definition and initialised at alloc method
   [array setLength:0];
   ...    
   // make search and delegate itself for callback to funcB
}

-(void)  funcB:(NSData*) data 
{
    [array: appendData:data];
}

(void) funcC
{
      //Finished collecting data
      //Signal caller for funcA that all data is received.
} 
```

这个想法是调用 funcA 以连接到服务器，该服务器通过调用 funcB 多次附加数据，然后在发送所有数据时最后调用 funcC。还行吧。

我遇到的问题是 funcA 可以被多次调用，这导致数组在处理旧请求的过程中将被设置为长度 0。

现在我已经尝试了 funcA 中的 [NSLock lock] 和 funcC 中的 [NSLock unlock] 但是第二个请求上的 lock 调用造成了死锁。我了解同步是解决此问题的另一种方法，但我只看到函数中的块。

我通常用 C 编程，我会使用 pthread_mutex 但我想一直坚持使用 obj C。假设它们是不同的线程，但似乎它们不是（因为死锁）。

我怎么解决这个问题？

谢谢。印地

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:39:09.553

我相信您只是在寻找可重入锁。`pthread_mutex`默认情况下不是递归的，而是作为一个*选项*。`@synchronized`是递归的。`NSLock`不是。

如果这是您的需要，您可以使用`NSRecursiveLock`.

# javascript - 将 jqueryui 覆盖保持在相同的 DOM 位置

> ID：10033228
> 
> 赞同：0
> 
> 时间：2012-04-05T17:34:18.833
> 
> 标签：javascript, jquery, jquery-ui, overlay, modal-dialog

无论如何要`jQueryUI`在同一个 DOM 位置保持覆盖？

## [看看这个](http://jsfiddle.net/HjhRD/)

HTML

```
<div id="parent">
    <div id="over" title="title">
        Stuff
    </div>
</div> 
```

JS：

```
$('#over').dialog({modal: true}); 
```

如果您在 DOM 上检查它，您会注意到叠加层被移动到`document.body`

有什么办法让它保持在起始位置吗？（的直接孩子`div#parent`）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:59:36.363

不知道你为什么想要这个，但类似：http: [//jsfiddle.net/BGBuc/](http://jsfiddle.net/BGBuc/)应该让你开始。

JS

```
$('#over').dialog({
    modal: true,
    create:function(event, ui) {
        setTimeout(function(){
            $('#parent').append($('div.ui-widget-overlay')).append($('div.ui-dialog'));
        },1);
    }
});​ 
```

# android - 为 ASP.NET MVC 3 应用程序创建 Android 应用程序

> ID：10033231
> 
> 赞同：2
> 
> 时间：2012-04-05T17:34:21.923
> 
> 标签：android, asp.net-mvc-3, mobile

我已经有一个 ASP.NET MVC3 应用程序，我想为它开发一个 Android 应用程序，我有哪些选择？

经过一番研究，我想我可能会：

*   制作一个使用MVC 应用程序中的**控制器的****原生 Android**应用程序。要使用它，我需要在每个控制器中添加方法以将数据转换为 JSON，以便我可以发送到 Android 应用程序。
***   忘记整个 ASP.NET 应用程序并尝试从 android 应用程序**直接连接到 SQL 服务器。**我知道我需要编写一个中间 ASP.NET 代码来与数据库通信。*   从 MVC 应用程序创建一个**移动 Web 视图**并在 Android 应用程序中使用它。（我不知道这是否可能以及如何去做）。**

 **这些选项中的任何一个是否有效，还有哪些其他选项？这是最好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:41:11.297

另一种选择是可以创建另一个 MVC 应用程序或区域，其中包含专门用于该应用程序的数据访问控制器。

我知道您使用的是 MVC3，但您可能想以 MVC4 web api 为例。

最佳实践表明你应该在你的应用程序和数据库之间有某种服务层，所以我会从你的列表中删除第二个选项。其他两个选项虽然是可行的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:20:14.163

您可以使用 jquery mobile 或[KendoUI](http://www.kendoui.com)（如果您想为许可证付费，这是一个很棒的产品套件）来帮助开发一个仅 HTML5+Js 的应用程序，该应用程序连接到您的 MVC 项目提供的数据作为 JSON 数据。

编写纯 html+Js 应用程序后，您可以使用[PhoneGap](http://phonegap.com/)将其编译为适用于 Android 和 iOs 的应用程序。**

# c++-cli - 动态添加 menuStrip 项

> ID：10033232
> 
> 赞同：0
> 
> 时间：2012-04-05T17:34:27.317
> 
> 标签：c++-cli

所以我在向 menuStrip 动态添加项目时遇到问题。我的意思是我知道如何向其中添加项目，但我不知道如何为这些动态添加的项目制作 Click 处理程序。

```
for(int i = 0; i < grupiuKiekis; i++)
    {
        row2 = mysql_fetch_row(result2);
        System::String^ grupesName = gcnew String(row2[1]);
        pasirinktiGrupęToolStripMenuItem->DropDownItems->Add(grupesName);
    } 
```

请告诉我正确的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T22:07:37.180

Add 方法有几个重载。您可以使用[允许您显式指定 EventHandler 的重载](http://msdn.microsoft.com/en-us/library/ms160942.aspx)，或者您可以构造一个[ToolStripItem](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripitem.aspx)，在其上设置一个[单击处理程序](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripitem.click.aspx)，然后[添加 ToolStripItem](http://msdn.microsoft.com/en-us/library/bxdt0s8t.aspx)。

## 编辑

这基本上是你想要做的：

```
for(int i = 0; i < grupiuKiekis; i++)
{
    row2 = mysql_fetch_row(result2);
    System::String^ grupesName = gcnew String(row2[1]);
    ToolStripItem^ item = gcnew ToolStripItem();
    item->Text = grupesName;
    item->Click += gcnew EventHandler(this, &Form1::clickHander);
    pasirinktiGrupęToolStripMenuItem->DropDownItems->Add(item);
}

void clickHander(Object^ sender, EventArgs^ e)
{
    ToolStripItem^ item = (ToolStripItem^) sender;
    System::String^ grupesName = item->Text;
    // Do what you need to do.
} 
```

# javascript - 茉莉花窥探不存在的物体

> ID：10033234
> 
> 赞同：1
> 
> 时间：2012-04-05T17:34:32.753
> 
> 标签：javascript, backbone.js, coffeescript, jasmine

我有一个具有以下操作的骨干路由器：

```
index: ->
  @collection = new App.Collections.ThingsCollection()
  @collection.fetch success: ->
    # ... 
```

我正在尝试使用 Jasmine 使用如下所示的测试来测试此功能：

```
it 'fetches the collection from the server', ->
  @router.index()
  expect(@router.collection.fetch).toHaveBeenCalled() 
```

尝试为`@router.collection.fetch()`. 因为在实际调用`@router.collection`该函数之前不存在`@router.index()`，所以我无法创建这样的间谍......

```
@fetchStub = spyOn(@router.collection, 'fetch') 
```

...因为`@router.collection`还不存在。我没有将 的构造`@collection`放在一个`initialize()`函数中，因为对于不使用它的函数来说似乎没有必要使用它，例如`new()`. 可能有一个众所周知的解决方案，但我一直找不到。任何帮助，将不胜感激。

## 更新

到目前为止，这就是我解决它的方法，但更优雅的解决方案会很好。

```
 initialize: ->
    @collection = new App.Collections.ThingsCollection()

  index: ->
    if @collection.models.length > 0
      # Assumes @collection.fetch() has already been called (i.e. switching between actions)
      view = new App.Views.ThingsIndex(collection: @collection)
      $('#app-container').html(view.render().el)
    else
      # Assumes @collection.fetch() has not been called (i.e. a new page view or refresh)
      that = this
      @collection.fetch success: ->
        view = new App.Views.ThingsIndex(collection: that.collection)
        $('#app-container').html(view.render().el) 
```

这样我就可以拥有以下规格：

```
describe 'App.Routers.ThingsRouter', ->
  beforeEach ->
    @router = new App.Routers.ThingsRouter
    @fetchStub = spyOn(@router.collection, 'fetch')

  it 'fetches the collection from the server', ->
    @router.index()
    expect(@fetchStub).toHaveBeenCalled() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:51:55.640

怎么样，在你的`before`功能中：

```
@router.collection = new App.Collections.ThingsCollection() 
```

[这里](http://pivotal.github.com/jasmine/jsdoc/symbols/jasmine.Spy.html#andReturn)有更多相关信息。

# jquery - 单击后停止悬停？

> ID：10033237
> 
> 赞同：0
> 
> 时间：2012-04-05T17:35:12.063
> 
> 标签：jquery, html

只是一个简单的问题，我有一个图形，其中包含一个图像和一个带有类覆盖的跨度。在我的 js 中，悬停时覆盖不透明度会发生变化以显示图像背后的内容。

一旦用户单击图像，我需要不透明度状态保持 1，但问题是当鼠标离开 .overlay 区域时，不透明度恢复为 0。

有没有办法停止悬停中流？

JS：

```
$(".overlay").hover(function () {
        $(this).stop().animate({'opacity':'1.0'}, 400);
    }, function () {
        $(this).stop().animate({'opacity':'0'}, 400);
    }); 
```

HTML

```
<figure>
    <div class="contents">
        <img src="images/photo_person.png" alt="Name">
        <div><span class="overlay"><h3>Name/h3> Occupation</span></div>

        <div class="bio">
        <div class="close"><a href="#">x</a></div>
        <div class="scroll-pane">
        <p>Content Text Here</p>
        </div>
        </div> 
</div>
</figure> 
```

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:37:16.040

删除悬停处理程序 onclick：

```
$(".overlay").click(function () {
    $(this).unbind("hover");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:40:13.517

这应该这样做：

```
cool_function($('.overlay'));

function cool_function(selector) {

    $(selector).hover(function() {
        $(this).stop().animate({
            'opacity': '1.0'
        }, 400);
    }, function() {
        $(this).stop().animate({
            'opacity': '0'
        }, 400);
    }).click(function() {
        $(this).unbind('mouseenter mouseleave click');
        $(this).click(function(){
            cool_function($(this));
        });
    });
}​ 
```

见小提琴：http: [//jsfiddle.net/xEyCB/1/](http://jsfiddle.net/xEyCB/1/)

# php - Symfony - 在 localhost 上配置现有项目

> ID：10033239
> 
> 赞同：2
> 
> 时间：2012-04-05T17:35:25.657
> 
> 标签：php, symfony1, symfony-1.4

我是 Symfony 的新手。我想开始使用现有项目。我将源下载到本地主机。我配置了 apache，当我尝试运行 /index.php（从 web 目录）或 frontend.php 时，它给了我一个空白页。为什么？我没有配置数据库。我做不到

```
php symfony doctrine:insert-sql 
```

它说在学说命名空间中没有定义任何任务。

编辑没有缓存目录。我创建了它，现在我得到错误页面（内部服务器错误）。可能是因为没有配置数据库。如何通过schema.yml进行配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T21:30:30.553

我猜你正在使用 symfony 1.4，或者告诉我我是否错了。

您可以从 symfony 网站查看入门：[http](http://www.symfony-project.org/getting-started/1_4/en/02-Prerequisites) ://www.symfony-project.org/getting-started/1_4/en/02-Prerequisites ，这是拥有开发环境的一个很好的起点。

尝试 als 启动这些命令：

```
php symfony project:permissions
php symfony cc 
```

# c++ - 在openCV中循环使用带有蒙版的图像

> ID：10033243
> 
> 赞同：2
> 
> 时间：2012-04-05T17:35:38.533
> 
> 标签：c++, image-processing, opencv

我需要从图像中收集一些数据。循环应该用面具完成。

例如，我有一个简单的十字掩码：

```
 1  
1 1 1
  1 
```

我需要知道图像每个点的灰度值之和。

我可以使用简单的循环，如下所示：

```
// looping except first and last
int nr = image.rows-1;
int nc = image.cols-1;

    for (int j=1; j<nr; j++) { // for all rows

    const uchar* previous = image.ptr<const uchar>(j-1); // previous row
    const uchar* current = image.ptr<const uchar>(j); // current row
    const uchar* next = image.ptr<const uchar>(j+1); // next row

    for (int i=1; i<nc; i++) {
        sum = previos[i] + current[i] + current[i-1] 
                          + current[i+1] + next[i];

    }
} 
```

但我认为我做错了。也许我应该使用类似的东西`cv::Mat kernel()`？

我需要掩码作为参数，所以我可以使用任何类型的掩码。

是否有现成的功能可以循环使用蒙版的图像？（有 filter2D 功能，但我不需要对图像进行更改，只需对像素进行一些计算）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T21:09:06.860

如果您想要每个像素的总和，那不正是这样`filter2d()`做的吗？您计算每个像素的总和，然后使用这些总和继续 SUSAN：（未经测试的代码）

```
cv::Mat img;
// TODO: load img
cv::Mat kernel = cv::Mat::ones(3,3,CV_8U);
// TODO: set some elements to zero you don't like
cv::Mat sums = img.clone();
cv::filter2d(img, sums, -1, kernel);
// TODO: use sums for further computation 
```

在图像边缘发生的情况取决于您为 指定的边框外插类型`filter2d`。[从文档](http://opencv.itseez.com/modules/imgproc/doc/filtering.html)：

> 本节中描述的函数和类的另一个共同特征是，与简单的算术函数不同，它们需要外推一些不存在的像素的值。例如，如果要使用高斯 3×3 滤波器对图像进行平滑处理，那么在处理每行中最左侧的像素时，需要它们左侧的像素，即图像外部的像素。您可以让这些像素与最左边的图像像素相同（“复制边界”外推法），或者假设所有不存在的像素为零（“恒定边界”外推法），等等。OpenCV 使您能够指定外推方法。有关详细信息，请参阅函数borderInterpolate() 和本节中对borderType 参数的讨论以及下面的各种函数。

```
/*
 Various border types, image boundaries are denoted with '|'

 * BORDER_REPLICATE:     aaaaaa|abcdefgh|hhhhhhh
 * BORDER_REFLECT:       fedcba|abcdefgh|hgfedcb
 * BORDER_REFLECT_101:   gfedcb|abcdefgh|gfedcba
 * BORDER_WRAP:          cdefgh|abcdefgh|abcdefg
 * BORDER_CONSTANT:      iiiiii|abcdefgh|iiiiiii  with some specified 'i'
 */ 
```

# php - 在上传时定义图像最大和最小宽度高度

> ID：10033245
> 
> 赞同：-2
> 
> 时间：2012-04-05T17:35:56.400
> 
> 标签：php, image, image-resizing, image-uploading

我真的搜索了所有网站并尝试使用 GD getimagesize 函数，但没有希望，我想在上传时设置最小和最大图像宽度和高度..所以如果不相等则显示错误；这是原始代码：

```
 <?php
$page = "user_editprofile_photo";
include "header.php";
$task = ( isset($_POST['task']) ? $_POST['task'] : NULL );
// CHECK FOR ADMIN ALLOWANCE OF PHOTO
if( !$user->level_info['level_photo_allow'] )
{
  header("Location: user_home.php");
  exit();
}
// SET ERROR VARIABLES
$is_error = 0;
// DELETE PHOTO
if( $task == "remove" )
{
  $user->user_photo_delete();
  $user->user_lastupdate();
  exit();
}
// UPLOAD PHOTO
if( $task == "upload" )
{
  $user->user_photo_upload("photo");
  $is_error = $user->is_error;
  if( !$is_error )
  {
    // SAVE LAST UPDATE DATE
    $user->user_lastupdate(); 
    // DETERMINE SIZE OF THUMBNAIL TO SHOW IN ACTION
    $photo_width = $misc->photo_size($user->user_photo(), "100", "100", "w");
    $photo_height = $misc->photo_size($user->user_photo(), "100", "100", "h");

    // INSERT ACTION
    $action_media = Array(Array('media_link'=>$url->url_create('profile', $user->user_info['user_username']), 'media_path'=>$user->user_photo(), 'media_width'=>$photo_width, 'media_height'=>$photo_height));
    $actions->actions_add($user, "editphoto", Array($user->user_info['user_username'], $user->user_displayname), $action_media, 999999999, TRUE, "user", $user->user_info['user_id'], $user->user_info['user_privacy']);
  }
}

// GET TABS TO DISPLAY ON TOP MENU
$field = new se_field("profile", $user->profile_info);
$field->cat_list(0, 0, 0, "profilecat_id='{$user->user_info['user_profilecat_id']}'");
$cat_array = $field->subcats;

// ASSIGN VARIABLES AND INCLUDE FOOTER
$smarty->assign('is_error', $is_error);
$smarty->assign('cats', $cat_array);
include "footer.php";
?> 
```

我在这里补充：

```
if( $task == "upload" )
$photo=$user->user_photo();
{
list($img_width, $img_height, $img_type, $attrs)=getimagesize($photo);
  if($img_width >= 193 && $img_height >= 290)
  $user->user_photo_upload("photo");
  $is_error = $user->is_error;
  if( !$is_error ) 
```

1-以这种方式：

```
if($task == "upload")$photo = $user->user_photo();
  { $user->user_photo_upload("photo"); 
```

根本不会上传任何图像......

2-以这种方式：

```
 if($task == "upload"){  
$user->user_photo_upload("photo");
$photo = $user->user_photo(); 
```

没有效果..它甚至上传 16px 的图像。谢谢，如果你能帮忙，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:55:04.680

看起来您的`if($task == "upload")`内容并没有完全包含您想要的内容。如果您以更易于阅读的格式查看代码：

```
<?php 
$task = (isset($_POST['task']) ? $_POST['task'] : NULL);
$is_error = 0;
if($task == "remove")
{
    $user->user_photo_delete();
    $user->user_lastupdate();
    exit();

}
if($task == "upload") $photo = $user->user_photo();
{
    list($img_width, $img_height, $img_type, $attrs) = getimagesize($photo);
    if($img_width >= 193 && $img_height >= 290) $user->user_photo_upload("photo");
    $is_error = $user->is_error;
    if(!$is_error)
    {
        $user->user_lastupdate();
        $photo_width = $misc->photo_size($user->user_photo(), "100", "100", "w");
        $photo_height = $misc->photo_size($user->user_photo(), "100", "100", "h");
        $action_media = array(array('media_link' => $url->url_create('profile', $user->user_info['user_username']), 'media_path' => $user->user_photo(), 'media_width' => $photo_width, 'media_height' => $photo_height));
        $actions->actions_add($user, "editphoto", array($user->user_info['user_username'], $user->user_displayname), $action_media, 999999999, TRUE, "user", $user->user_info['user_id'], $user->user_info['user_privacy']);

    }

}
$field = new se_field("profile", $user->profile_info);
$field->cat_list(0, 0, 0, "profilecat_id='{$user->user_info['user_profilecat_id']}'");
$cat_array = $field->subcats;
$smarty->assign('is_error', $is_error);
$smarty->assign('cats', $cat_array);
include "footer.php";
?> 
```

你可以看到`$photo = $user->user_photo();`应该应该用花括号代替。`list()`它总是会从每次开始执行代码。

我不知道这是否是问题所在，但您似乎有正确的想法。我不知道`$photo = $user->user_photo();`返回什么，但文件存储在`$_FILES['image']['tmp_name']`（如果您的输入名称具有类型文件和名称图像），您可以获取文件大小信息，`getimagesize($_FILES['image']['tmp_name'])`如[http://www.php.net/manual/en上所述/function.move-uploaded-file.php](http://www.php.net/manual/en/function.move-uploaded-file.php)

确保您的表单标签包含`enctype="multipart/form-data"`在其中，否则`$_FILES`数组将为空。

# java - 使用 Java 将音频文件分成 10 段的段

> ID：10033248
> 
> 赞同：-3
> 
> 时间：2012-04-05T17:36:15.927
> 
> 标签：java, audio

我有一个音频文件。我想使用 java 分割成 10 秒。有没有一种简单的方法可以做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:50:48.403

简而言之：不，没有。这在很大程度上取决于文件格式。是`.wav`，`.mp3`还是别的什么？您需要了解格式，读取数据并根据文件格式将您的 10s 段写入单独的文件，可能在中间进行解码/编码。寻找一些音频库——它们会减轻你的痛苦。

# javascript - 将 jQuery Mobile 1.0.1 与 jQuery 1.7.2 一起使用

> ID：10033259
> 
> 赞同：0
> 
> 时间：2012-04-05T17:37:12.450
> 
> 标签：javascript, jquery, ajax, jquery-mobile, refactoring

我正在重构使用 jQuery Mobile 开发的 Web 应用程序。该任务包括划分包含多个`data-role="page"`到多个 html 文件的单个 html 文件。

页面将`data-role="content"`通过 AJAX 加载。问题是所有附加的事件现在都必须是`live()`//而不是`delegate()`.`on()``bind()`

jQueryMobile 的稳定版本是 1.0.1，此版本推荐的 jQuery 核心是 1.6.4，也就是说`on()`不可用。

我的问题是：使用 jQuery Mobile 1.0.1 和 jQuery 1.7.2 有多安全？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:43:58.130

最新的稳定 jQMobile 旨在与 jQ 1.6.4 一起使用...

看起来（与上述评论一致）1.1.0 应该与 1.7.x 一起使用

[jQ Mobile docs](http://jquerymobile.com/download/)，虽然我记得专门阅读过这个

给我一分钟，我会尝试找到确切的参考。

# jquery - 在动态创建的锚点上调用 jQuery EasyTooltips

> ID：10033261
> 
> 赞同：0
> 
> 时间：2012-04-05T17:37:17.753
> 
> 标签：jquery, jquery-plugins, tooltip

我认为我的问题的答案是使用 delegate() 但我不完全确定 - 并且需要一个指针......

我正在使用相当出色的 EasyTooltip 插件向 div 中的所有锚点添加简单的工具提示。

这一切都可以在 document.ready() 上执行以下操作：

```
jQuery(".profile-popup").each(function() {
    jQuery(this).easyTooltip({
        useElement: "toolTipLikingIt",
        xOffset: -100,
        yOffset: -20
    });
}); 
```

但是，在某些情况下，我也在脚本的其他地方向该 div 添加新的锚点。我确实尝试向创建锚点的事件添加对相同 .easyTooltip() 函数的调用，但这无法正常工作。

任何人都可以提出解决方案吗？

该插件来自：[http ://cssglobe.com/post/4380/easy-tooltip--jquery-plugin](http://cssglobe.com/post/4380/easy-tooltip--jquery-plugin)

谢谢！

史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:34:35.517

你是对的，切换到委托应该可以解决你的问题，因为它会对动态添加的元素做出反应。这是几个月前写的一篇文章，它应该为您提供选择正确方法所需的所有信息：

[http://www.elijahmanor.com/2012/02/differences-between-jquery-bind-vs-live.html](http://www.elijahmanor.com/2012/02/differences-between-jquery-bind-vs-live.html)

# c# - 如何使用 XmlSerializer 创建 XmlRepository？

> ID：10033266
> 
> 赞同：2
> 
> 时间：2012-04-05T17:37:45.750
> 
> 标签：c#, xml, xml-serialization, repository, repository-pattern

我很难尝试创建 XmlRepository。这里的问题我只能选择使用 XmlSerializer 来做到这一点。

请检查一下。我的代码真的很乱，令人沮丧。我想知道如何改进这段代码，我正在考虑创建一个单例，但我不确定如何继续。

```
 public interface IRepository<T>
    where T : class
{
    T GetById(object id);
    IEnumerable<T> All();
    void Insert(T entity);
    void Remove(T entity);
    void SaveChanges();
} 

public class XmlRepository : IRepository<Configuration>
{
    public XmlRepository(string filename)
    {
        FileName = filename;
    }

    public XmlRepository(string filename)
    {
        FileName = filename;
    }

    internal string FileName { get; private set; }

    private Configuration GetById(object id)
    {
        throw new NotImplementedException();
    }

    public IEnumerable<Configuration> All()
    {
        return Get();
    }

    public void Insert(Configuration entity)
    {
        var configurations = Get();
        configurations.Add(entity);
        Save(configurations);
    }

    public void Remove(Configuration entity)
    {
        var configurations = Get();
        configurations.Remove(entity);
        Save(configurations);
    }

    private List<Configuration> Get()
    {
        try
        {
            XmlSerializer serializer = new XmlSerializer(typeof(List<Configuration>), null, new Type[] { typeof(BinaryConfiguration) }, new XmlRootAttribute("Configurations"), "http://ofimbres.wordpress.com/");
            StreamReader myWriter = new StreamReader(FileName);
            var list = serializer.Deserialize(myWriter);
            myWriter.Close();

            return (List<Configuration>)list;
        }
        catch (InvalidOperationException ex)
        {
            throw ex;
        }
    }

    public void Save(object configurations)
    {
        try
        {
            XmlSerializer serializer = new XmlSerializer(configurations.GetType(), null, new Type[] { typeof(BinaryConfiguration) }, new XmlRootAttribute("Configurations"), "http://ofimbres.wordpress.com/");
            StreamWriter myWriter = new StreamWriter(FileName);
            serializer.Serialize(myWriter, configurations);
            myWriter.Close();
        }
        catch (XmlException ex)
        {
            throw ex;
        } 
    }
} 
```

有任何疑问，请告诉我。非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:48:45.247

我不会在每次调用存储库时读取和写入文件，而是执行以下操作：

在构造函数中，您将文件读入`Configuration`对象列表。就像你现在在`Get`方法中所做的那样。您将此列表保存在类的字段中，并将其用于所有其他方法（添加等）。

您的存储库确实有一个`SaveChanges`方法，因此这是将配置序列化回磁盘的理想位置。

这应该比当前的方法性能更高，复杂性更低，因此也更不容易出错。

**编辑：**这是一个开始：

```
public class XmlRepository : IRepository<Configuration>
{
    private readonly List<Configuration> configurations;

    public XmlRepository(string filename)
    {
        FileName = filename;

        XmlSerializer serializer = new XmlSerializer(typeof(List<Configuration>), null, new Type[] { typeof(BinaryConfiguration) }, new XmlRootAttribute("Configurations"), "http://ofimbres.wordpress.com/");
        using (StreamReader myWriter = new StreamReader(FileName))
        {
            configurations = (List<Configuration>)serializer.Deserialize(myWriter);
            myWriter.Close();
        }
    }

    internal string FileName { get; private set; }

    public Configuration GetById(object id)
    {
        return (from c in configurations where c.Id == id select c).Single();
    }

    public IEnumerable<Configuration> All()
    {
        return configurations;
    }

    public void Insert(Configuration entity)
    {
        configurations.Add(entity);
    }

    public void Remove(Configuration entity)
    {
        configurations.Remove(entity);
    }

    public void SaveChanges()
    {
        XmlSerializer serializer = new XmlSerializer(configurations.GetType(), null, new Type[] { typeof(BinaryConfiguration) }, new XmlRootAttribute("Configurations"), "http://ofimbres.wordpress.com/");
        using (StreamWriter myWriter = new StreamWriter(FileName))
        {
            serializer.Serialize(myWriter, configurations);
            myWriter.Close();
        }
    }
} 
```

**还有一些一般性的建议**

*   用于`using`处理需要处理的文件/流和其他资源（`StreamReader`在`StreamWriter`这种情况下）。这保证了即使出现异常也会关闭文件。
*   不要捕获并重新抛出异常，或者如果你这样做了，至少使用`throw`而不是`throw ex`保留完整的堆栈跟踪。

希望这可以帮助！

# c - 使用 PSA 算法计算方位角和仰角

> ID：10033268
> 
> 赞同：1
> 
> 时间：2012-04-05T17:37:58.207
> 
> 标签：c, algorithm, astronomy

这里有一个 PSA 算法的实现：

[http://www.psa.es/sdg/sunpos.htm](http://www.psa.es/sdg/sunpos.htm)

我将此测试代码添加到 sunpos.cpp 以计算 2008 年 8 月 6 日 6:00 慕尼黑的太阳位置。但我得到无用的结果，输出是：

天顶角：71.034037 方位角：86.052150

```
#include <stdio.h>
main(){

    cTime t = {2008, 8, 6, 6.0, 0.0, 0.0};
    cLocation l = {11.6, 48.1};
    cSunCoordinates s;

    sunpos(t, l, &s);

    printf("%f %f\n", s.dZenithAngle, s.dAzimuth);
} 
```

有人对这个算法有经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:47:48.663

正如我评论的那样，我认为函数的结果是好的：

结果是太阳位置几乎在东方，海拔为 4 度。(90 - 86)。看起来是正确的。

你确定你输入的是UTC时间吗？我在一个[网站上](http://www.timeanddate.com/worldclock/city.html?n=168)看到德语在夏天有当地时间 UTC+2。那么 6:00 在德语中实际上是 8:00。它解释了你的结果吗？

# android - 防止 LogCat 会话过滤器窃取焦点

> ID：10033269
> 
> 赞同：9
> 
> 时间：2012-04-05T17:37:59.103
> 
> 标签：android, eclipse, logcat

我已经为 logcat 设置了一系列过滤器，并希望将注意力集中在特定的过滤器上，但是每当会话过滤器收到一条消息时，它就会从我想要的过滤器中窃取焦点。

我一直无法在网上找到任何参考资料，也无法在 Eclipse 中找到任何设置。我可以防止会话过滤器窃取焦点吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-05T17:55:13.900

只是为了更新，因为自从这篇文章以来它发生了一些变化。

`Monitor logcat for messages from applications in workspace`对我来说，需要在你的 eclipse > window > preferences -> Android -> LogCat 中取消选中一个标有：的框，如下所示：

![调试应用程序时禁用自动 Eclipse 焦点](../Images/b0f5b37c987a590f6a8a38ddf2dbb9cf.png)

* * *

在这里找到了答案：[如何阻止 eclipse 为 android logcat 自动创建过滤器？](https://stackoverflow.com/questions/9042145/how-do-i-stop-eclipse-from-auto-creating-filters-for-android-logcat)

这可以通过**在工作区中有来自应用程序的消息时禁用显示 logcat 视图来实现。**这是 eclipse 中的样子：

![在此处输入图像描述](../Images/b3d10e0eaf4e685c489eafdfdb0b3b62.png)

# android - OnRestart Activity，坏项目在列表视图中突出显示

> ID：10033272
> 
> 赞同：0
> 
> 时间：2012-04-05T17:38:09.610
> 
> 标签：android, listview, highlight

我的列表视图是使用 relativeLayout 创建的。当我触摸“texViewLibelleListe”时，使用 OnClick 方法突出显示列表视图的项目（在“bleu_c”中）并开始一个新活动（“ActiviteSoldeAchat”）。当我销毁此活动（“ActiviteSoldeAchat”）时，第一个活动重新启动。

我的问题：当我重新启动活动或突出显示好项目时，我想禁用列表视图中所有项目的突出显示。我怎样才能做到这一点？此时，这不是突出显示的好项目。任何想法？

谢谢您的帮助

我发现的唯一一种解决方案是在 OnResume 方法中完全重新加载列表视图，如下所示： adapter = new ListeAdapter(this, listeRepository.GetAll()); ListListe.setAdapter（适配器）；

## 但我认为，这不是一个干净的解决方案

主要活动：

```
public class ActiviteSoldeListe extends Activity {
ListView ListListe;
Button boutonAjouterListe;

private ListeAdapter adapter;
private ListeRepository listeRepository=new ListeRepository(this);;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.soldeliste);

    //On récupère tous les éléments de notre interface graphique grâce aux ID
    ListListe = (ListView) findViewById(R.id.listListe);

    // ouverture de la base
    listeRepository.Open();

    // récupération de tous les éléments de la table achat et adaptateur
    adapter = new ListeAdapter(this, listeRepository.GetAll());

    // fermeture de la base
    listeRepository.Close();

    ListListe.setAdapter(adapter);

}
//au lancement de l'activité
protected void onStart(){
    super.onStart();
}
protected void onRestart(){
    super.onRestart();
}

protected void onResume(){
    super.onResume();
    UpdateAdapter();

}

private void UpdateAdapter() {
    listeRepository.Open();
    adapter.setListes(listeRepository.GetAll());
    listeRepository.Close();
    adapter.notifyDataSetChanged();
} 
```

列表视图的 Tha adpater ：

```
public class ListeAdapter extends BaseAdapter implements OnClickListener{

private List<Liste> listeListe;
private LayoutInflater inflater;
private Context context;

public int confirmDelete;

public void setListes(List<Liste> listeListe) {
    this.listeListe = listeListe;
}

public ListeAdapter(Context context, List<Liste> listeListe) {
    this.listeListe = listeListe;
    this.setContext(context);
    this.inflater = LayoutInflater.from(context);
}

public int getCount() {
    return listeListe.size();
}

public Object getItem(int position) {
    return listeListe.get(position);
}

public long getItemId(int position) {
    return listeListe.get(position).getId();
}

private class ViewHolder {
    public TextView tvLibelleListe;
    public TextView tvDate;
    public Button btSupprimer;

}

public View getView(final int position, View view, ViewGroup viewGroup) {

    final ViewHolder holder;

    if (view == null) {
        holder = new ViewHolder();
        view = inflater.inflate(R.layout.layout_item_liste, null);

        holder.tvLibelleListe = (TextView) view
                .findViewById(R.id.textViewLibelleListe);
        holder.tvDate = (TextView) view
                .findViewById(R.id.textViewDate);
        holder.btSupprimer = (Button) view
                .findViewById(R.id.buttonSupprimerListe);
        view.setTag(holder);
    } else {
        holder = (ViewHolder) view.getTag();
    }

    final Integer IdListe  = listeListe.get(position).getId();
    final RelativeLayout listlayout = (RelativeLayout) view.findViewById(R.id.ListViewListe);

    holder.tvLibelleListe.setText(listeListe.get(position).getLibelleListe() + " - " +  listeListe.get(position).getouvert());
    holder.tvDate.setText(listeListe.get(position).getdate() + "");
    holder.btSupprimer.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                ConfirmDelete(getContext(), IdListe);
                }
    });

    holder.tvLibelleListe.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            listlayout.setBackgroundResource(R.color.bleu_f);

            ActiviteSoldeListe soldeListeActivity = (ActiviteSoldeListe) getContext();

            Intent intent = new Intent();
            intent.setClass(soldeListeActivity, ActiviteSoldeAchat.class);
            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            intent.putExtra("IdListe",IdListe);
            soldeListeActivity.startActivity(intent);

            }
});
    holder.tvDate.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            listlayout.setBackgroundResource(R.color.bleu_f);

            ActiviteSoldeListe soldeListeActivity = (ActiviteSoldeListe) getContext();

            Intent intent = new Intent();
            intent.setClass(soldeListeActivity, ActiviteSoldeAchat.class);
            intent.putExtra("IdListe",IdListe);
            soldeListeActivity.startActivity(intent);

            }
});

    return view;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T07:47:49.143

而不是重新加载总列表视图尝试以下..

```
@Override
public void onResume() {
    super.onResume();
    adapter.notifyDataSetChanged();
} 
```

# asp.net - 在登录期间使用 sql server 在 asp.net 中验证区分大小写的密码

> ID：10033278
> 
> 赞同：5
> 
> 时间：2012-04-05T17:38:34.760
> 
> 标签：asp.net, sql-server, sql-server-2008, sql-server-2005, c#-4.0

**返回成功**

```
Dim user = "ravi"
        Dim pass = "admin"
        objcmd.CommandText = "Select * from ADMIN_INFO where ADMIN_ID='" & user & "' and ADMIN_PASS='" & pass & "'" 
```

**返回成功**

```
Dim user = "ravi"
        Dim pass = "ADMIN"
        objcmd.CommandText = "Select * from ADMIN_INFO where ADMIN_ID='" & user & "' and ADMIN_PASS='" & pass & "'" 
```

执行查询后，两者都返回成功，其中仅在表`ravi`中`admin`可用。那么，我如何检查是否区分大小写。需要帮忙 ！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:51:49.673

```
CREATE TABLE #temp
(
    Password Varchar(2)
)
insert into #temp values('a') 
```

## 第一种方法

```
select Password  from #temp Where Password COLLATE Latin1_general_CS_AS  = 'A' 
select Password  from #temp Where Password COLLATE Latin1_general_CS_AS  = 'a' 
```

## 第二种方法

```
select Password  from #temp Where cast(Password as varbinary(2))  = cast('A' as varbinary(15)) 
select Password  from #temp Where cast(Password as varbinary(2))  = cast('a' as varbinary(15)) 
```

* * *

```
drop table #temp 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:58:46.047

本文可能会对您有所帮助：[SQL Server 查询中区分大小写的搜索](http://vyaskn.tripod.com/case_sensitive_search_in_sql_server.htm)。但是，一开始就将密码保存为纯文本通常不是一个好习惯。

此外，您可以只从数据库中选择管理员行，然后在 .Net 端进行密码比较，默认情况下比较区分大小写。

```
bool result = string1.Equals(string2); //this is case sensitive unless you specify otherwise 
```

# storyboard - 在 UISearchDisplayController 之后 prepareForSegue

> ID：10033279
> 
> 赞同：2
> 
> 时间：2012-04-05T17:38:37.690
> 
> 标签：storyboard, didselectrowatindexpath, searchdisplaycontroller

编辑：

我刚刚发现：[如何从 UISearchBarDisplayController 结果到 detailViewController](https://stackoverflow.com/questions/9325103/how-to-segue-from-a-uisearchbardisplaycontroller-result-to-a-detailviewcontrolle)

我来看看！

* * *

我正在使用情节提要将“搜索栏和搜索显示控制器”与核心数据 fetchedResultsController 相结合。也就是说，我必须区分：

```
if (self.tableView == self.searchDisplayController.searchResultsTableView) {
    ... 
```

以及我刚刚列出从数据存储中获取的结果的情况。

但是，在以下情况下，我无法获得正确的行（索引路径）：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"StoreDetails"]) {
        UINavigationController *navigationController = segue.destinationViewController;
        StoreDetailsTableViewController *controller = (StoreDetailsTableViewController *)navigationController.topViewController;
        controller.managedObjectContext = self.managedObjectContext;

        Store *storeToDetail = nil;
        NSIndexPath *indexPath = [self.tableView indexPathForCell:sender];  // This gives wrong row when having searched using searchDisplayController
        NSLog(@"Row: %i", indexPath.row);                                                   // row is always 0
        if (self.tableView == self.searchDisplayController.searchResultsTableView) {
            storeToDetail = [self.filteredListContent objectAtIndex:indexPath.row];
        } else {
            storeToDetail = [self.fetchedResultsController objectAtIndexPath:indexPath];
        }

         controller.storeToDetail = storeToDetail;
    }
} 
```

之后调用：

```
- (BOOL)searchDisplayController:(UISearchDisplayController *)controller       shouldReloadTableForSearchString:(NSString *)searchString
{
    [self filterContentForSearchText:searchString scope:@"All"];
    ... 
```

和：

```
- (void)filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope
{
    [self.filteredListContent removeAllObjects];

    for (Store *store in [self.fetchedResultsController fetchedObjects])
    {
        if ([scope isEqualToString:@"All"] || [store.name isEqualToString:scope])
        {
            NSComparisonResult result = [store.name compare:searchText options:(NSCaseInsensitiveSearch|NSDiacriticInsensitiveSearch) range:NSMakeRange(0, [searchText length])];
            if (result == NSOrderedSame)
            {
                [self.filteredListContent addObject:store];
            }
        }
    }
} 
```

取自 Apple 的 TableSearch 示例。

最初的问题是双重的：

1) self.tableView 似乎不等于 self.searchDisplayController.searchResultsTableView 是 prepareForSegue

2) 已搜索 indexPath (row) 始终为 0。

我想我可以使用 didSelectRow... 代替或组合使用，但我相信 prepare... 应该是可能的？！此外，在尝试使用 didSelectRow 时...我确定如何将对象从相关行传递到目标控制器。也就是说，我可以在 didSelectRow... 中获得正确的 indexPath... 但我只知道如何在 preparFor... 中获得 segue 目的地

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
{
    Store *storeToDetail = nil;
    if (tableView == self.searchDisplayController.searchResultsTableView)
    {
        storeToDetail = [self.filteredListContent objectAtIndex:indexPath.row];
    }
    else
    {
        storeToDetail = [self.fetchedResultsController objectAtIndexPath:indexPath];
    }

    // How to get segue destination controller and set object?!
    // Before doing:
    [self performSegueWithIdentifier:@"StoreDetails" sender:self];
} 
```

任何帮助深表感谢。也许是对展示如何组合这些东西的教程的参考。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-06T13:58:26.090

在这种情况下，`sender`参数 of`prepareForSegue:sender:`设置为启动 segue 的表视图单元格。

只需向您的单元格添加一个属性来保存`Store`属于该单元格的属性，您无需执行任何索引路径或表格视图比较舞蹈。

你最终应该得到一些简单的东西

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    FooCell *cell = (FooCell *)[self.tableView dequeueReusableCellWithIdentifier:CELL_IDENTIFIER];
    Foo *foo = [self fooForIndexPath:indexPath];

    cell.foo = foo;
    // additional initialization

    return cell;
} 
```

和

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"view detail"]) {
        DetailViewController *destViewController = segue.destinationViewController;
        destViewController.foo = [(FooCell *)sender foo];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T14:54:29.210

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender

{

如果（self.filteredListContent）

{//NSLog(@"过滤后的数据";}

别的

{//NSLog(@"post all";}

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-28T19:12:51.940

您使用了错误的测试。

```
if (self.tableView == self.searchDisplayController.searchResultsTableView) {
  ... 
```

这总是会失败，你在问两个不同的 tableViews 是否不同。答案始终是否定的。

但是，您可以测试发件人是否来自 searchResultsTableView。

```
NSIndexPath *searchIndexPathOfSelectedCell = [self.searchDisplayController.searchResultsTableView indexPathForCell:sender];

if (searchIndexPathOfSelectedCell) {
  ... 
```

# scapy - 如何用 scapy 更改数据包数据？

> ID：10033285
> 
> 赞同：3
> 
> 时间：2012-04-05T17:39:20.487
> 
> 标签：scapy

如何用 scapy 更改数据包数据？

我尝试使用`sniff()`然后`send()`编辑的数据包，但它不会工作，因为原始数据包已经到达它的目的地。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T20:56:13.257

“但它不会起作用，因为原始数据包已经到达它的目的地。”

因此，首先您需要设置一些中间人解决方案，以便两端之间的所有通信都穿过您的设备，并让您修改数据包数据。

用于此功能 /attack 的一些众所周知的软件包是 ettercap 和 cain/abel。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T10:50:20.330

iTayb,

似乎您对使用 scapy 代理某种服务感兴趣？如果有，是哪一个？

首要任务是数据包如何通过运行 scapy 的盒子。通过在远程机器上设置网关以匹配 scapy 框来做到这一点。如果这是为了某种渗透测试，您将需要欺骗一些 MAC 地址。您可以使用 scapy 使用 arpcachepoison 方法或使用第三方程序（如 ettercap）来执行此操作。

完成此操作后，您使用 sniff() 和 send() 的方法应该会更好一些，只需确保在到达发送部分之前更改数据包；) 这是一个小例子，说明如何做到这一点.. .这里我只是更改 IP 标头目标地址，但您可以更改任何您想要的。

```
from scapy import *

def chgSend(x):
    x[IP].dst = '192.168.1.1'
    send(x)
while 1:
    sniff(prn=chgSend) 
```

直流

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-08T09:12:51.960

我有同样的问题，

我认为问题在于您启用了 ip_forward，因此在 scapy 发送修改后的数据包之前，原始数据包被转发到原始目的地。

从理论上讲，解决方案是在 iptables 中创建一个规则，将您想要修改的数据包转发到另一个端口（这或多或少是 Ettercap 内部所做的），

```
 i.e = iptables -t nat -A PREROUTING -p tcp --destination-port "YourInterestingPort" -j REDIRECT   --to-port 1234 
```

然后在 scapy 中监听那个端口，修改数据包并将数据包发送到原始端口。

由于过滤，此解决方案难以实施，您必须仅重定向和修改您想要的数据包并排除 syn ack arp 等......

如果要修改服务器的响应，一种更简单的方法是，而不是即时修改数据包，而是充当中介。

*   ARP欺骗
*   iptables
*   打开一个套接字，接收数据包，打开一个连接并将其发送到原始目的地（假装你是客户端）。然后，从原目的地接收答案，修改答案，返回给原查询者。

    ```
    while True:
       c, addr = s_mb.accept()             # Establish connection with client.
       query = c.recv(BUFFER_SIZE)

       s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
       s.connect((IP, PORT))
       s.send(PACKET)
       response = s.recv(1024)
       if response = "THIS IS THE RESPONSE THAT I WANT TO MODIFY":
        if(real_simulation):
            fakeresponse = "MODIFIED RESPONSE"
            #print "The packet has beeb modified"
           else:
            fakeresponse = response
       s.close()     
       c.send(fakeresponse) 
    ```

（对不起，脏代码）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-18T19:57:19.073

如果您使用 scapy send() 函数，那么它将创建一个新数据包，但使用 MITMf 您不需要任何发送函数，只需更改数据包字段，如 scapy 语法，不使用发送函数或需要创建新数据包......

这是 [**MITMf**](https://github.com/byt3bl33d3r/MITMf)
的一个很好的 github 存储库，这个存储 库就像 scapy 一样，从头开始编写，具有完全适合您的目标的能力。
**示例代码：**

```
if packet.haslayer(ICMP):
   log.info('Got an ICMP packet!')
   packet.dst = '192.168.1.0' 
```

# maven - Maven代理设置不起作用

> ID：10033286
> 
> 赞同：14
> 
> 时间：2012-04-05T17:39:24.650
> 
> 标签：maven, proxy, maven-3

我在 conf/settings.xml 中设置了 Maven 代理设置

```
<proxy>
  <active>true</active>
  <protocol>http</protocol>
  <host>proxy.my-company.com</host>
  <port>8080</port>
</proxy> 
```

但是当我运行 maven build 时，出现以下错误。有人可以帮忙吗

```
[警告] org.apache.maven.wagon:wagon-ssh:jar:2.2 的 POM 丢失，没有可用的依赖信息

```

详细日志

```
mvn -X

Apache Maven 3.0.4 (r1232337; 2012-01-17 03:44:56-0500)
Maven 主页：C:\tools\apache-maven-3.0.4
Java 版本：1.6.0_12，供应商：Sun Microsystems Inc.
Java 主页：C:\tools\Java\jdk1.6.0_12\jre
默认语言环境：en_US，平台编码：Cp1252
操作系统名称：“windows xp”，版本：“5.1”，arch：“x86”，系列：“windows”

[INFO] 错误堆栈跟踪已打开。
[调试] 从 C:\tools\apache-maven-3.0.4\conf\settings.xml 读取全局设置
[调试] 从 C:\Documents and Settings\desibaba\.m2\settings.xml 读取用户设置
[调试] 在 C:\Documents and Settings\desibaba\.m2\repository 使用本地存储库
[调试] 在 C:\Documents and Settings\desibaba\.m2\repository 中使用优先级为 10 的管理器 EnhancedLocalRepositoryManager
[INFO] 正在扫描项目...
[调试] 通过 proxy.my-company.com:8080 将 http://repo.maven.apache.org/maven2 的优先级为 0 的连接器 WagonRepositoryConnector 用作 null
下载：http://repo.maven.apache.org/maven2/org/apache/maven/wagon/wagon-ssh/2.2/wagon-ssh-2.2.pom
[DEBUG] 写入分辨率跟踪文件 C:\Documents and Settings\desibaba\.m2\repository\org\apache\maven\wagon\wagon-ssh\2.2\wagon-ssh-2.2.pom.lastUpdated
[警告] org.apache.maven.wagon:wagon-ssh:jar:2.2 的 POM 丢失，没有可用的依赖信息
[调试] org.apache.maven.wagon:wagon-ssh:jar:2.2:
[调试] org.codehaus.plexus:plexus-utils:jar:1.1:runtime
[调试] 通过 proxy.my-company.com:8080 将 http://repo.maven.apache.org/maven2 的优先级为 0 的连接器 WagonRepositoryConnector 用作 null
下载：http://repo.maven.apache.org/maven2/org/apache/maven/wagon/wagon-ssh/2.2/wagon-ssh-2.2.jar
下载：http://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/1.1/plexus-utils-1.1.jar
[DEBUG] 写入分辨率跟踪文件 C:\Documents and Settings\desibaba\.m2\repository\org\apache\maven\wagon\wagon-ssh\2.2\wagon-ssh-2.2.jar.lastUpd
吃过的
[DEBUG] 写入分辨率跟踪文件 C:\Documents and Settings\desibaba\.m2\repository\org\codehaus\plexus\plexus-utils\1.1\plexus-utils-1.1.jar.last
更新
[DEBUG] 从 ClassRealm [plexus.core, parent: null] 中查找打包 pom 的生命周期映射
[错误] 构建无法读取 1 个项目 -> [帮助 1]
org.apache.maven.project.ProjectBuildingException：处理 POM 时遇到了一些问题：
[错误] 无法解析的构建扩展：无法解析插件 org.apache.maven.wagon:wagon-ssh:2.2 或其依赖项之一：无法解析以下工件：org.apache.maven.wagon:wagon-ssh :jar:2.2, org.codehaus.plexus:plexus-utils:jar:1.1: 在中央找不到工件 org.apache.maven.wagon:wagon-ssh:jar:2.2 (http://repo.maven.apache .org/maven2) @

        在 org.apache.maven.project.DefaultProjectBuilder.build(DefaultProjectBuilder.java:363)
        在 org.apache.maven.DefaultMaven.collectProjects（DefaultMaven.java:636）
        在 org.apache.maven.DefaultMaven.getProjectsForMavenReactor（DefaultMaven.java:585）
        在 org.apache.maven.DefaultMaven.doExecute（DefaultMaven.java:234）
        在 org.apache.maven.DefaultMaven.execute（DefaultMaven.java:156）
        在 org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
        在 org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
        在 org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:597)
        在 org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced（Launcher.java:290）
        在 org.codehaus.plexus.classworlds.launcher.Launcher.launch（Launcher.java:230）
        在 org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
        在 org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
[错误]
[错误] 项目 xxx (C:\t1\9630727\pom.xml) 有 1 个错误
[错误] 无法解析的构建扩展：无法解析插件 org.apache.maven.wagon:wagon-ssh:2.2 或其依赖项之一：无法解析以下工件：org.apache.maven.wagon:wagon-ssh :jar:2.2, org.codehaus.plexus:plexus-utils:jar:1.1: 在中央找不到工件 org.apache.maven.wagon:wagon-ssh:jar:2.2 (http://repo.maven.apache .org/maven2) -> [帮助 2]
org.apache.maven.plugin.PluginResolutionException：无法解析插件 org.apache.maven.wagon:wagon-ssh:2.2 或其依赖项之一：无法解析以下工件：org.apache.maven.wagon： wagon-ssh:jar:2.2, org.codehaus.plexus:plexus-utils:jar:1.1: 在中央找不到 artifactorg.apache.maven.wagon:wagon-ssh:jar:2.2 (http://repo.maven .apache.org/maven2)

```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-16T19:04:51.317

我不能用 MVN 3.0.4 做到这一点，但我用 3.0.3 做

这似乎是[3.0.4 版本中的一个错误](https://issues.apache.org/jira/browse/MNG-5237)。

上面的 jira 条目给出了 maven 3.0.4 错误的解决方法：添加

```
<build>
    <extensions>
        <extension>
            <!-- this extension is required by wagon in order to pass the proxy -->
            <groupId>org.apache.maven.wagon</groupId>
            <artifactId>wagon-http-lightweight</artifactId>
            <version>2.2</version>
        </extension>
    </extensions>
</build> 
```

给你的`pom.xml`

这对我有用

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-10T07:43:20.090

无需接触您的 POM，您可以将此[库](http://repo.maven.apache.org/maven2/org/apache/maven/wagon/wagon-http-lightweight/2.2/wagon-http-lightweight-2.2.jar)添加到 M2_HOME/lib/ext 并在您的 settings.xml 中使用以下代理设置。

```
<proxy>
...
  <username>DOMAIN\USERNAME</username>
  <password>PASSWORD</password>
... 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-09-15T17:32:42.390

我尝试将代理设置引入几个不同位置的 settings.xml 文件，但似乎在运行时没有一个被拾取。

但是，我发现有一个环境变量`MAVEN_OPTS`，我终于能够设置代理信息并在运行时反映它：

```
MAVEN_OPTS
-Dhttp.proxyHost=proxy.myproxy.com -Dhttp.proxyPort=80 -Dhttps.proxyHost=proxy.myproxy.com -Dhttps.proxyPort=80 
```

[![Windows 7 系统变量条目](../Images/1c7db775dc04acdc6d62da1f11dfe557.png)](https://i.stack.imgur.com/NmeRu.png)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-04-05T17:48:51.593

您的设置文件应如下所示：

```
<settings>
    <proxies>
        <proxy>
            <active>true</active>
            <protocol>http</protocol>
            <username><username-optional></username>
            <password><password-optional></password>
            <host><hostname></host>
            <port><port></port>
        </proxy>
    </proxies>
</settings> 
```

如果这不起作用，请尝试将您的代理设置放入 IE 等浏览器中，看看它是否有效。还可以尝试直接点击代理以确保它不是代理配置脚本。我不知道 maven 是否与这些配合得很好。

虽然如果它是一个配置脚本，该脚本应该列出在您的情况下使用的正确代理。

**编辑**

我看到您正在以 conf/settings.xml 的形式工作，它在哪里？通常 settings.xml 文件位于：

> /path/to/user/home/.m2/settings.xml

在 Windows 中为您服务

> C:\Documents and Settings\用户名\.m2\settings.xml

或者

> C:\用户\用户名\.m2\settings.xml

或者直接把它放在你的 maven 项目 POM 文件中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-05-11T03:19:00.643

使用 mvn -X 查看 settings.xml 的读取顺序

现在使用 mvn help:effective-settings 查看有效设置

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-09-16T07:25:30.580

我有类似的问题。添加后 `nonProxyHosts`

标签问题已解决。请注意，`"zzz.zz.com"`必须用适当的服务器替换。

```
<proxy>
...
...
 <nonProxyHosts>localhost|127.0.0.1|zzz.zz.com</nonProxyHosts>
...
...
</proxy> 
```

详情[http://maven.apache.org/guides/mini/guide-proxies.html](http://maven.apache.org/guides/mini/guide-proxies.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-14T14:11:36.717

对不起，我恢复了这样一个旧线程，但也许这会帮助有同样错误的人。

我遇到了**与@OP 描述的相同的问题**。我结合了此处描述的一些解决方案尝试，它对我有用。

**简要问题描述：**

我用java写了一个小聊天程序，效果很好。几天后，我在工作中得到了一台新笔记本电脑，不得不安装和转移所有东西。我在两台笔记本电脑上都使用了 Eclipse（版本：Neon.2 Release (4.6.2)），唯一的区别是，我在旧笔记本电脑上使用了 Eclipse 的 Maven 插件，而在新笔记本电脑上我直接安装了 Maven。

**我做了什么来解决这个问题？**

首先，我将代理设置写入Maven`settings.xml`中，如本[代理指南中所述。](http://maven.apache.org/guides/mini/guide-proxies.html)但它对我不起作用。

注意：我更改了 settings.xml 下`C:\Program Files\apache-maven-3.3.9\conf`

然后我阅读了@Vijay Krish 的评论

```
"Note: We have to add above elements in settings.xml available under 'user.home\.m2' folder. If file doesn't exists already in the mentioned path, create it." 
```

没有settings.xml，所以我只是复制了一个`C:\Program Files\apache-maven-3.3.9\conf`，`user.home\.m2`然后再次尝试运行一个Maven构建，它工作正常。

我希望这对任何在这个问题上苦苦挣扎的人都有用。

此致

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-01-09T16:42:59.507

Maven 有两个 settings.xml，具体取决于您在 IDE 中引用的 settings.xml。确保代理信息在您引用的那个中可用。

1.  一个位于 .m2 目录
    C:\Users...m2\repository
2.  另一个在 Maven 文件夹的 conf 目录中可用。
    apache-maven-XXX

在我的情况下，代理信息是从点号获取的。1 但我试图修改 maven 目录中的 settings.xml

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-03-03T18:10:19.007

我不确定这是否是您的问题，但我注意到我必须确保 https 代理位于 http 代理之前才能使用 https 代理。可能是因为它们在我的配置中是相同的主机名。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-25T07:45:53.587

如果您使用 NTLM 代理，请参考[这个](https://stackoverflow.com/a/24540105/1802348)对我有用的解决方案！

如果您使用的是 IntelliJ 等 IDE，请确保您正在更改 IDE 使用的同一 maven 的 settings.xml！我的意思是可能捆绑了 Maven，如果您更改系统 maven settings.xml，很明显它不会工作！所以请检查 IDE 配置。如果您需要更多帮助，请指定 IDE 名称。

是的，这很愚蠢，但值得一试！检查您的系统路径环境变量是否与您正在更新的 settings.xml 完全相同的 Maven 路径。

希望这可以帮助！

# php - 如何在数据库中实现文件夹、子文件夹

> ID：10033290
> 
> 赞同：4
> 
> 时间：2012-04-05T17:39:46.617
> 
> 标签：php, mysql, sql, recursion, relational-database

我在逻辑编程方面遇到问题，但我认为这可能是另一种更容易在 SQL 命令中执行此操作的解决方案，但是，让我们来解决问题。

我在 MySQL (InnoDb) 中有一个像这样的表：

```
CREATE TABLE IF NOT EXISTS `folder` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `folder_id` INT NOT NULL ,
  `name` VARCHAR(100) NULL ,
  `hidden` TINYINT(1)  NOT NULL DEFAULT 0 ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_folder_folder1` (`folder_id` ASC) ,
  CONSTRAINT `fk_folder_folder1`
    FOREIGN KEY (`folder_id` )
    REFERENCES `folder` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB 
```

这看起来很简单，但我想列出文件夹，以使该文件夹的子文件夹将显示在其下方。就像在任何文件存储库中一样。

例如：
在表中：

```
id  name    folder_id
1   root    1
2   etc     1
3   dev     1
4   apache  2
5   php     2
6   mysql   2
7   hda     3
8   hda1    3
9   lib     1 
```

我想这样展示它：

```
root
    etc
        apache
        php
        mysql
    dev
        hda
        hda1
    lib 
```

问题是，有没有办法通过 SQL 命令或 PHP 来做到这一点？
我尝试在 PHP 中制作，但我看不到没有递归函数的方法。但我没有成功。

**解决方案：**
因为 MySQL 不接受 WITH 子句，所以 SQL 中的递归函数是开箱即用的。多谢你们。

```
SELECT c2.name
FROM folder c1 LEFT OUTER JOIN folder c2
ON c2.folder_id = c1.id WHERE c2.folder_id = 1  // the id of the parent folder
AND c2.id != c2.folder_id               // Remove the parent folder
ORDER BY c2.folder ASC 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:43:17.470

您面临实施称为朴素树的[SQL 反模式的危险。](http://media.pragprog.com/titles/bksqla/trees.pdf)看这本书的pdf，它展示了几个很好的解决方案。

# arrays - Perl 中的显式包错误

> ID：10033291
> 
> 赞同：0
> 
> 时间：2012-04-05T17:40:09.703
> 
> 标签：arrays, perl

我正在尝试解析一个字符串并将这些部分放在一个数组中，然后将数组组件分配给新变量。我在我的代码中以完全相同的方式完成了此操作并且它可以工作，但现在它失败了，我不知道为什么。我认为这很简单，我离得太近了，看不到它。

```
sub timeDiff {
    my ($tday,$tmon,$tyear,$pday,$pmon,$pyear,$tvalue,$pvalue,$reset);
    my (@arrSplitTDate,@arrSplitPDate,$arrSplitTDate,$arrSplitPDate);
    $tvalue = $_[0];
    $pvalue = $_[1];

    print $tvalue;
    print $pvalue;
    @arrSplitTDate = split(/\//, $tvalue);
    $tday = $arrSplitTdate[1];
    $tmon = $arrSplitTdate[0];
    $tyear = $arrSplitTdate[2];

    print $tday . "\n";
    print $tmon . "\n";
    print $tyear . "\n";
} 
```

这是错误：

```
Global symbol "@arrSplitTdate" requires explicit package name at LargeLDAPSearch.pl line 173, <DATA> line 558. 
```

有人看到错误的原因吗？谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T17:44:42.130

您的 camelCasing 在变量声明和预期用途之间是不同的。

`arrSplitTDate`对比`arrSplitTdate`

# jasper-reports - iReports 4.5.1 子报表仅在最后一页显示，页脚中没有页码

> ID：10033293
> 
> 赞同：1
> 
> 时间：2012-04-05T17:40:26.053
> 
> 标签：jasper-reports, ireport, jasperserver

如何仅在报告的最后一页显示子报告（实际上是两个）。同时，我不希望在显示子报表的最后一页中显示父报表页眉和页脚信息。

我在用：

iReport 4.5.1 作为我的报表设计器和返回引用游标的 Oracle 11g/存储过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:39:02.757

将两个子报表放在摘要带上，然后在报表属性中确保选中“新页面上的摘要”字段并取消选中“带有页眉和页脚的摘要”字段。

# winapi - 基本用户输入

> ID：10033294
> 
> 赞同：1
> 
> 时间：2012-04-05T17:40:29.597
> 
> 标签：winapi, assembly, x86, masm, irvine32

我正在学习一些汇编语言（x86 Irvine.32 windows7）并且有一个关于如何从用户输入的问题。我所拥有的书并没有深入探讨它。我想提示用户：

```
myfirst BYTE "Welcome! This program calculates the sum of a list of numbers.", 0dh, 0ah, 0dh, 0ah ; greeting 
        BYTE "How many integers will be added? : " 
```

那么用户将输入 X。我如何读取用户输入的内容并将其放入变量中？

是不是很简单：

```
INVOKE ReadConsole, SomeVairable 
```

SomeVairable 在 .data 中定义为一个字节的位置？

编辑：

```
INCLUDE Irvine32.inc

BufSize = 80

.data
buffer BYTE BufSize DUP(?)
stdInHandle HANDLE ?
bytesRead   DWORD ?
myfirst BYTE "Welcome! This program calculates the sum of a list of numbers.", 0dh, 0ah, 0dh, 0ah ; greeting 
        BYTE "How many integers will be added? : "
mysecond BYTE "Please enter the "

.code
main PROC

    mov edx, OFFSET myfirst                         ;move the location of myfirst into edx
    call WriteString    

    ; Get handle to standard input
    INVOKE GetStdHandle, STD_INPUT_HANDLE
    mov stdInHandle,eax

    ; Wait for user input
    INVOKE ReadConsole, stdInHandle, ADDR buffer,
      BufSize, ADDR bytesRead, 0

    exit
main ENDP
END main 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:56:07.760

不，它（至少通常）没有那么简单。

用户输入的内容将被读取为*字符串*，而不是数字。您通常必须读取字符串（通常超过一个字节长），然后将其转换为整数。您可能希望在进行转换之前验证字符串中的所有字符都是数字，或者您可能希望将转换与验证结合起来。

具体看`ReadConsole`电话，有两件事要记住。首先，您需要检索控制台的句柄，通常使用[`GetStdHandle`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683231.aspx). 然后，您需要提供[`ReadConsole`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684958.aspx)它所期望的所有六个左右的参数。

# css - 有没有办法为“除第一个/最后一个元素之外的所有元素”指定一个 CSS 简写？

> ID：10033299
> 
> 赞同：53
> 
> 时间：2012-04-05T17:40:39.240
> 
> 标签：css, css-selectors

很多时候，需要为除第一个（或最后一个）元素之外的所有元素指定 CSS 样式是很自然的。例如，在设置段落样式时，您希望为除最后一个元素之外的每个元素添加下边距（或者类似地，为除第一个元素之外的每个元素添加上边距）。

有没有办法做到这一点：

*   比定义更简洁`p {...}`，然后`p:first-child {...}`？
*   比`p:nth-child(-n+1)`?更直接和直观

如果没有，您是否知道添加它的任何尝试？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-04-05T17:43:12.033

对于`p`除第一个子元素之外的所有元素，请使用其中之一（第二个元素得到更好的支持）：

```
p:not(:first-child)
p:first-child ~ p 
```

对于`p`除最后一个子元素之外的所有元素：

```
p:not(:last-child) 
```

对于`p`除第一个和最后一个子元素之外的所有元素：

```
p:not(:first-child):not(:last-child) 
```

像往常一样，直到 IE9+`:not()`和`:last-child`其他浏览器的相对较新版本才支持 CSS3。除非您使用 JavaScript 或其他方式为您的第一个和最后一个孩子添加类，否则您在浏览器支持（IE8 和更早版本）方面不会走得太远。

请记住，[流入段落和它们的祖先之间的垂直边距折叠](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)，所以除非您也想将这些段落的容器元素的边距归零，否则您不需要将第一个和它们的边距归零。最后一个`p`元素。这是一个[小提琴](http://jsfiddle.net/BoltClock/cHxFg)来说明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T18:17:20.263

如果不需要 IE7-8 支持，您可以使用[`:not()`CSS 选择器](http://www.quirksmode.org/css/not.html)，例如：

```
p:not(:first-child) {
    ...
} 
```

但是，如果您需要支持 IE7+，可能仍然存在这种情况，您可以使用一个小技巧，通常可以让您走得更远。一个鲜为人知的事实是，`:first-child`伪选择器实际上可以在 IE7+ 中工作（`:last-child`虽然不是），就像[其他一些 css 选择器](http://www.456bereastreet.com/archive/201002/forgotten_css_selectors/)一样，这使得在水平浮动布局中添加垂直边距之类的东西成为可能。

想象一下这个html：

```
<ul>
    <li>Item #1</li>
    <li>Item #2</li>
    <li>Item #3</li>
    <li>Item #4</li>
</ul> 
```

这是一些CSS：

```
/* General reset */
ul, li { list-type: none; margin: 0; padding: 0; }
/* Make horizontal */
ul > li { float: left; } 
```

所以现在所有列表项都是水平相邻的，现在我们想在所有项目之间添加一个边距，但不是在右侧或左侧，我们可以在 css 中这样做：

```
/* General reset */
ul, li { list-type: none; margin: 0; padding: 0; }
/* Make horizontal */
ul > li { float: left; margin-left: 10px; }
ul > li:first-child { margin-left: 0; } 
```

这通常涵盖了 95% 的情况，我想要一些独特的东西，然后其余的[“被遗忘”选择器涵盖另外几个百分比](http://www.456bereastreet.com/archive/201002/forgotten_css_selectors/)，之后您需要添加一些通常在后端中通常不会成为瓶颈的类这页纸。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T17:42:38.650

好吧，你可以这样做：

```
p:not(:first-child) {...} 
```

但只有最新的浏览器支持`:not`伪类。

除此之外，没有。您最好的选择是为所有人指定一个样式，然后为第一个/最后一个覆盖它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-25T11:12:48.787

我建议使用`first-of-type`：

```
p:not(:first-of-type) { ... } 
```

[浏览器支持（*caniuse*）](http://caniuse.com/#search=first-of-type)

# iphone - 按升序显示记录 - 逻辑问题

> ID：10033301
> 
> 赞同：2
> 
> 时间：2012-04-05T17:40:45.287
> 
> 标签：iphone, objective-c, ios, json, cocoa-touch

我有一个如下的 JSON 字符串；

```
{
    "1": {
        "name": "Jerry",
        "age": "12"

    },
    "2": {
        "name": "Bob",
        "age": "16"

    "3": {.....
} 
```

我只显示了 2 条记录，但这个 JSON 中将有 100 条记录。这其中有一个顺序1、2、3等是记录的顺序号。

我正在订购这些记录（如显示第一条记录，然后是第二条和第三条，依此类推）。下面提供了我的代码。

这里有一个问题，当我有超过 10 条记录时，它不会按顺序显示记录。它首先显示 1，然后显示 11、12、13……直到 19。然后显示 2，然后显示 21、22、23……直到 29。

我的代码如下，我该如何修改它来解决我的问题？

可能的解决方案：如果我们可以在小于 10 的数字中添加前导 0，它应该可以正确过滤掉。但我知道这不是正确的方法。

```
NSDictionary *dic = content;

            self.mutArr = [[NSMutableArray alloc] init];

            NSArray *array = [dic allKeys];
            NSArray * sortedArray = [array sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)];

            for (NSString *str in sortedArray)
            {
                NSDictionary *dic2 = [dic objectForKey:str];
                Person *person = [[Person alloc] init];            
                person.nameOfRestaurant=[dic2 objectForKey:@"name"];
                person.personStartDate=[dic2 objectForKey:@"age"];

                [self.mutArr addObject:person];

            }

            self.personEntries = [NSArray arrayWithArray:self.mutArr]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:44:23.620

这是因为您按*字典顺序*对数字进行排序（即好像它们是*words*）。您应该提供自己的排序比较器实现，将字符串转换为整数，然后才比较它们以进行排序。

# objective-c - 从 uiimageview 获取旋转后的图像

> ID：10033303
> 
> 赞同：2
> 
> 时间：2012-04-05T17:40:52.020
> 
> 标签：objective-c, ios, uiimage, core-graphics, cgaffinetransform

我创建了一个应用程序，我可以在其中使用手势旋转、调整大小、翻译图像。然后我需要从`UIImageView`. **我在Stack-overflow**的某个地方找到了这部分代码。[这里](https://stackoverflow.com/questions/2856556/creating-a-uiimage-from-a-rotated-uiimageview)虽然回答了笑脸问题，但是需要输入角度。同一个人在其他地方写了我正在使用的更好的解决方案。但它有一个问题。通常它会返回一个空白图像。或截断的图像（通常从顶部）。因此代码有问题，需要进行一些更改。我的问题是，我是 Core-graphics 的新手，并且严重陷入了这个问题。

```
UIGraphicsBeginImageContext(imgView.image.size);
CGContextRef context = UIGraphicsGetCurrentContext();
CGAffineTransform transform = imgView.transform;
transform = CGAffineTransformScale(transform, 1.0, -1.0);
CGContextConcatCTM(context, transform);
CGContextDrawImage(context, CGRectMake(0, 0, imgView.image.size.width, imgView.image.size.height), imgView.image.CGImage);
UIImage *newRotatedImage = [UIImage imageWithCGImage: CGBitmapContextCreateImage(context)];
UIGraphicsEndImageContext(); 
```

**编辑 1.1** 感谢您的示例代码，但它又出现了问题。让我更详细地解释一下，我正在使用手势来缩放、翻译和调整图像大小。所以所有这些数据都保存在 imageview 的 transform 属性中。我喜欢 core-image 中的另一种方法。所以我将代码更改为：

```
CGRect bounds =  CGRectMake(0, 0, imgTop.size.width, imgTop.size.height);
CIImage *ciImage = [[CIImage alloc] initWithCGImage:imageView.image.CGImage options:nil];
CGAffineTransform transform = imgView.transform;
ciImage = [ciImage imageByApplyingTransform:transform];
return [UIImage imageWithCIImage:ciImage] ; 
```

现在我得到了挤压和错误尺寸的镜像。很抱歉再次打扰您。你能指导我如何在 coreimage 中使用 imageview 的变换来获得正确的图像吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T04:48:38.260

```
CIImage *ciImage = [[CIImage alloc] initWithCGImage:fximage.CGImage options:nil];
CGAffineTransform transform = fxobj.transform;
float angle = atan2(transform.b, transform.a);
transform = CGAffineTransformRotate(transform, - 2 * angle);
ciImage = [ciImage imageByApplyingTransform:transform];
UIImage *screenfxImage = [UIImage imageWithCIImage:ciImage]; 
```

请记住添加代码：`transform = CGAffineTransformRotate(transform, - 2 * angle);`因为旋转方向相反

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T05:17:48.287

这是文档的链接：- [http://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CoreImageFilterReference/Reference/reference.html](http://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CoreImageFilterReference/Reference/reference.html)

旋转图像的示例代码：-

```
 CIImage *inputImage = [[CIImage alloc] initWithImage:currentImage];
        CIFilter * controlsFilter = [CIFilter filterWithName:@"CIAffineTransform"];
        [controlsFilter setValue:inputImage forKey:kCIInputImageKey];
        [controlsFilter setValue:[NSNumber numberWithFloat:slider.value] forKey:@"inputAngle"];
        CIImage *displayImage = controlsFilter.outputImage;
        UIImage *finalImage = [UIImage imageWithCIImage:displayImage];

        CIContext *context = [CIContext contextWithOptions:nil];
        if (displayImage == nil || finalImage == nil) {
            // We did not get output image. Let's display the original image itself.
            photoEditView.image = currentImage;
        }
         else {

            CGImageRef imageRef = [context createCGImage:displayImage fromRect:displayImage.extent];
            photoEditView.image = [UIImage imageWithCGImage:imageRef];
            CGImageRelease(imageRef);
        }
        context = nil;
        [inputImage release]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T20:49:38.697

我为这类事情创建了一个 Objective-C 类。[你可以在 GitHub ANImageBitmapRep](https://github.com/unixpickle/ANImageBitmapRep)上查看它。以下是您将如何进行旋转：

```
ANImageBitmapRep * ibr = [myImage image];
[ibr rotate:anAngle];
UIImage * rotated = [ibr image]; 
```

请注意，这里`anAngle`是弧度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-27T05:48:31.603

我在目标 C 中创建了示例应用程序来执行此操作（减去缩放部分）。如果有人感兴趣，您可以在此处下载：[https ://github.com/gene-code/coregraphics-drawing/tree/master/coregraphics-绘图/测试](https://github.com/gene-code/coregraphics-drawing/tree/master/coregraphics-drawing/test)

# c# - Redis 和 ServiceStack.Net Redis 丢失数据

> ID：10033304
> 
> 赞同：0
> 
> 时间：2012-04-05T17:40:53.750
> 
> 标签：c#, redis

我正在测试 Redis，但我遇到了问题。如果我存储超过 8000 个项目，则会丢失超过 2 条记录。丢失的数据量与插入的记录量成正比。

```
 class ProdutoDTO
  {
     public long id { get; set; }
     public string name { get; set; }
  }

 using (var produtosRedis = redisClient.GetTypedClient<ProdutoDTO>())
 {
     for (var i = 0; i < 15000; i++)
     {
        ProdutoDTO produto = new ProdutoDTO();
        produto.id = produtosRedis.GetNextSequence();
        produto.name = "test" + produto.id.ToString();
        produtosRedis.Store(produto);
     }
  } 
```

我解决了：

旧代码：

```
class ProdutoDTO  {
 public long id { get; set; }
 public string name { get; set; }
} 
```

新代码：

```
class ProdutoDTO  {
 public long Id { get; set; }
 public string name { get; set; }
} 
```

因为，C# Redis 客户端适用于任何具有单个主键的 POCO——默认情况下应该是 Id。

有关 C# Redis 的更多信息：[ServiceStack.Net Redis：存储相关对象与相关对象 ID](https://stackoverflow.com/questions/8914349/servicestack-net-redis-storing-related-objects-vs-related-object-ids)

# php - 过滤输入的最佳位置？

> ID：10033305
> 
> 赞同：4
> 
> 时间：2012-04-05T17:41:01.000
> 
> 标签：php

我想知道过滤用户提交输入的最佳位置在哪里。关于过滤器，我说的是[filter_var](http://php.net/manual/en/function.filter-var.php)和[filter_input](http://www.php.net/manual/en/function.filter-input.php)。

我想出了三个场景：

1.  从 POST/GET 过滤数据，并将过滤数据传递给按原样处理的函数。
2.  从 POST/GET 获取原始数据，并按原样传递给函数过滤它的函数。
3.  从 POST/GET 过滤数据，过滤是函数中的第二次。

这些方法中的每一种都有其优点和缺点。我正在寻找一些可能是最佳或标准做法的见解。

方法 1 将经过清理的数据传递给函数，因此函数可以更小，而不必清理传入的所有内容。缺点是，如果在任何其他地方调用了您的函数并且未清理数据，这可能会导致问题。这只需要良好的编码实践，以记住在传递给函数之前对所有内容进行清理。

方法 2 你永远不必担心你的函数会处理未经处理的数据，但函数会更大。

方法3是最安全的，但是比较浪费。编写了更多代码，并且数据可能会在通过可能的各种功能时被多次清理，从而浪费 CPU 资源和时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:44:49.430

我认为你的每一种方法都是有效的，只要你[让错误的代码看起来是错误](http://www.joelonsoftware.com/articles/Wrong.html)的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:45:19.070

正如你所说，最好的方法是在使用之前过滤通过 get 或 post 从输入发送的数据

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:48:28.957

我认为最好的选择是使用函数过滤它们，以便您可以重用代码。为此创建一个课程并快乐;）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:04:22.227

从上述**场景中，1 和 2** 适用于良好实践。虽然数字 3 没有必要像您所说的那样过滤输入数据两次，这会浪费资源。

因此，情景 1 或 2；这取决于您要处理的情况。

# data-visualization - 使用具有灵活播放功能的动态图表的丰富 iPad 应用程序

> ID：10033310
> 
> 赞同：0
> 
> 时间：2012-04-05T17:41:24.990
> 
> 标签：data-visualization, qlikview

什么图表工具最有希望开发一个丰富的 iPad 应用程序，可以显示具有回放功能的动态图表？最终用户应该能够更改在 x 轴和 y 轴上绘制的内容。

此外，是否可以使用 QlikView 或 Tableau 构建此类应用程序来处理图表？我为此使用 API 吗？另外，FusionCharts怎么样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T17:12:46.133

Tableau 可以开箱即用地为您做到这一点，并且构建图表本身是微不足道的。

完成此操作的基本步骤是：

*   下载 Tableau Desktop 使用该工具创建您的可视化 - 对于“重播”功能，将数据库字段（如“日期”）放在 Tableau 的“页面”架子上。
*   将完成的可视化项发布到 Tableau Server
*   在 iPad 上，将 Safari 指向 Tableau Server 上托管的可视化项，或下载免费的 Tableau 应用程序并执行相同的操作。

如果您想这样称呼它，这里的“问题”是 Tableau Server 正在为您渲染可视化项进行所有繁重的工作 - 没有您依赖的应用程序端 API 或库 - 您只是将移动设备用作查看器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T11:07:04.530

Qlikview 的方法也非常相似。

*   下载 Qlikview 个人版（免费）
*   开发您需要的应​​用程序
*   将应用程序部署到 Qlikview Server（您将需要许可证）
*   在 iPad 上使用 Safari 访问 Qlikview 服务器上的应用程序

可以通过桌面 PC 使用 IE 插件或浏览器访问相同的 Qlikview 应用程序，而无需使用 Ajax 客户端进行安装。

如果您想查看一些演示应用程序，您可以在 iPad 上访问它们，网址为[http://demo.qlikview.com/](http://demo.qlikview.com/)

# c++ - std::sort 对少量数据很慢

> ID：10033312
> 
> 赞同：2
> 
> 时间：2012-04-05T17:41:47.787
> 
> 标签：c++, qt, sorting

我发现 std::sort 仅对 1000 个项目进行排序非常慢。

在类模板`template <typename T> class TableModel : public QAbstractTableModel`中，我具有以下对表格进行排序的功能。

```
template<typename T>
void TableModel<T>::sort(int column, Qt::SortOrder order = Qt::AscendingOrder) {
    if(order == Qt::AscendingOrder) {
        qSort(m_list.begin(), m_list.end(), less<T>(column));
    } else {
        qSort(m_list.begin(), m_list.end(), greater<T>(column));
    }
    reset();
 } 
```

我注意到如果我只有随机洗牌，我的桌子就是洗牌然后立即显示。所以这让我认为它的排序很慢。谁能帮我加快 QTable 的排序？

这是较少的结构。

```
template<typename T>
struct less {
    int index;
    less(int index) : index(index) {}
    bool operator()(const T& first, const T& second) {
        return T::less(first, second, index);
    }
}; 
```

T::less 是一个函数，它所做的只是根据给定的索引进行比较。

当我稍后需要处理大约 100,000 个项目时，慢被定义为仅 1000 个项目的 5 秒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:44:49.200

我怀疑这`m_list`是按价值存储物品并且交换它们很昂贵。您可以尝试实现更快的交换或通过智能指针将它们存储在容器中。

当然，分析器可以帮助您更准确地查明问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:55:14.507

由于 m_list 是一个 QList，它没有与普通列表相同的接口或性能特征。例如，显然 QList 在内部存储了一个 T* 数组。如果排序算法知道这个实现细节，这个表示可以在没有任何复制的情况下被排序。相比之下，std::sort 可能是对周围的值进行深度复制，或者可能是移动它们，这比在 QList 数组中排序指针要多。

最好将 Qt 容器与 Qt 算法一起使用，因为 Qt 算法更有可能专门用于 Qt 容器。或者您可以避免使用 Qt 容器而只使用标准库。

无论如何，尝试使用 Qt 的`qSort`算法：

```
template<typename T>
void TableModel<T>::sort(int column, Qt::SortOrder order = Qt::AscendingOrder) {
    if(order == Qt::AscendingOrder) {
        qSort(m_list.begin(), m_list.end(), less<T>(column));
    } else {
        qSort(m_list.begin(), m_list.end(), greater<T>(column));
    }
    reset();
} 
```

* * *

### 原始答案

std::sort 不能利用列表中的节点可以在不复制元素的情况下移动的事实。假设您使用 std::list 或类似的东西，请使用 sort 成员函数。

```
template<typename T>
void TableModel<T>::sort(int column, Qt::SortOrder order = Qt::AscendingOrder) {
    std::random_shuffle(m_list.begin(), m_list.end());
    if(order == Qt::AscendingOrder) {
       m_list.sort(less<T>(column));
    } else {
       m_list.sort(greater<T>(column));
    }
    reset();
} 
```

如果您不能这样做，那么您可以通过确保您的元素在使用 C++11 时启用移动来优化所有这些副本。

# android - Android (Google Play) 推荐跟踪限制

> ID：10033313
> 
> 赞同：1
> 
> 时间：2012-04-05T17:41:54.777
> 
> 标签：android, google-play, tracking, referrer

使用 INSTALL_REFERRER 和我们自己的广播接收器，我们能够在我们的应用程序中跟踪推荐程序的安装。但是，我们在跟踪过程中遇到了某些限制。有没有人能够解决这些问题？

1.  当我们与另一个用户共享一个活动 URL 时，当第二个用户尝试打开该 URL 时，他会遇到两个打开它的选项，浏览器和 Google Play。只有当用户通过 Google Play 安装应用程序时，才会进行推荐跟踪。

2.  对于 2.1 等旧版本，我们无法捕获推荐跟踪。因此，如果第二个用户拥有 OS 2.1，则该应用程序不会跟踪安装。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T22:56:05.710

为了在将链接发送给其他用户时加载引荐来源网址（并且为了避免浏览器/谷歌播放问题），链接不应是：

> [https://play.google.com/store/apps/details?id=com.xxx.appname&referrer=abc](https://play.google.com/store/apps/details?id=com.xxx.appname&referrer=abc)

但

> market://details?id=com.xxx.appname&referrer=abc

# android - 销毁 ViewPager 和 FragmentStatePagerAdapter 上的页面

> ID：10033315
> 
> 赞同：9
> 
> 时间：2012-04-05T17:42:14.047
> 
> 标签：android, android-viewpager

我们正在尝试创建一个基于 ViewPager 的 Android 应用程序，该应用程序在运行时接收添加和删除页面的指令。几乎就像选项卡式浏览器体验一样，您可以删除当前选项卡或删除特定选项卡。

根据 Google 文档，我们使用 FragmentStatePagerAdapter，它旨在用于有大量页面的情况，更像是列表视图。

但是当我们尝试： - 删除一个不在屏幕上的页面 - 并从同一个类中创建一个新的片段对象 - 并在页面的相同位置被删除我们注意到 Android 平台恢复了死页并显示给用户。我们刚刚创建的新对象根本不运行“onCreate”、“onCreateView”或“onActivityCreated”。

我们正在寻找解决此问题的方法，迫使平台使用来自同一类的新片段对象。有任何想法吗？

我们发现，如果我们销毁当前页面，平台确实会销毁该页面并从同一类创建一个新对象。这是一个复制问题和此行为的小示例。

来源：[http ://dl.dropbox.com/u/8333012/SimpleAdapter/SimplePager.zip](http://dl.dropbox.com/u/8333012/SimpleAdapter/SimplePager.zip)

视频：[http ://www.youtube.com/watch?v=-oaXXwU8PSI&hd=1](http://www.youtube.com/watch?v=-oaXXwU8PSI&hd=1)

从这个项目中，当您触摸第一页上的 TextView 时，它旨在将第二页（绿色）删除到新的蓝色页面。你会看到，即使从第一页开始，第二页仍然是绿色的。但是，当您按下第二页（绿色）上的返回 Android 按钮并触摸 TextView 时，创建的第二页将是正确的蓝色。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-06T01:11:44.810

当您处理 ListView 并更改您调用的适配器的底层数据时`notifyDataSetChanged()`，任何反映数据集的 View 都会自行刷新。这也是您应该使用片段寻呼机适配器的方式。

在您的情况下，您没有通知适配器。但是，如果是`FragmentPagerAdapter`/`FragmentStatePagerAdapter`它并没有什么不同，因为这些适配器`notifyDataSetChanged()`“默认”忽略。为了让它工作覆盖`getItemPosition()`你的适配器实现

```
@Override
public int getItemPosition(Object object) {
    return POSITION_NONE;
} 
```

正如已经说过的，在您添加/删除片段调用之后（在您的`showOtherPage()`）

```
mAdapter.notifyDataSetChanged(); 
```

# javascript - JavaScript/jQuery google 风格网站预览

> ID：10033316
> 
> 赞同：2
> 
> 时间：2012-04-05T17:42:17.527
> 
> 标签：javascript, jquery, live-preview

我记得不久前在这里关注了一个类似的东西，它叫做 Shark.js 或 Sharpe.js（但我的名字可能是错误的）。我试过用谷歌搜索它，浏览这里，我的浏览器历史，但我没有运气。不是wkhtmltopdf，我知道的很多。有人知道它可能叫什么或我在说什么吗？请问你有它的链接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:49:06.120

堆栈溢出问题：[jQuery 网页预览](https://stackoverflow.com/questions/3162815/jquery-webpage-preview)

来自第二个答案： http: [//craigsworks.com/projects/qtip/demos/content/thumbnail](http://craigsworks.com/projects/qtip/demos/content/thumbnail)

这应该是你要找的，不知道是不是完全一样的东西，但是一样功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:45:58.630

不确定如何在客户端 javascript 中实时完成此操作。但是，我敢打赌，Google 使用服务器端进程来捕获屏幕截图，然后使用 javascript 请求图像以显示给客户端。

# java - 使用 MigLayout 用两个组件填充整个单元格

> ID：10033321
> 
> 赞同：0
> 
> 时间：2012-04-05T17:42:32.503
> 
> 标签：java, swing, layout, layout-manager, miglayout

我有两个组件，我希望它们都填充[MigLayout](http://www.miglayout.com/)中的同一个单元格：

例如，我想给这两个组件约束是这样的：

```
cell 0 0 1 1, push, grow 
```

并让它们在内部完全重叠放置`cell 0 0`

（如果我只使用上面的代码，它们最终会在单元格中并排共享空间）

为了实现这一点，我必须向[MigLayout](http://www.miglayout.com/)约束添加什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T06:04:14.717

我最终通过在 MigLayout 中给第一个组件一个*id来解决这个问题：*

`cell 0 0 1 1, push, grow, id myid`

然后使用第一个组件的边界（使用 id 引用）将第二个组件显式定位在第一个组件的顶部：

`pos myid.x myid.y myid.x2 myid.y2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T05:21:48.147

将它们放置在具有 CardLayout 的面板中，并在必要时进行交换。

# python - 我的食谱搜索程序（守护进程）的图像缓存循环出错

> ID：10033324
> 
> 赞同：2
> 
> 时间：2012-04-05T17:42:39.787
> 
> 标签：python, linux, ubuntu, ubuntu-unity

我编写了一个守护程序，用于从 Gourmet Recipe Manager 的数据库（即 GNU/Linux 的食谱管理器）中搜索食谱

我的程序通过一个循环从 sqlite 数据库中读取每个配方元素所需的信息。

（这样的 Ubuntu Linux 守护进程称为“范围”。
这样的范围为 ubuntu unity 提供了更多搜索资源。）

'model' 包含通过 DBUS 传送到 Ubuntu Unity 的信息。

理论上，您可以使用 URI 作为 'model' 中图像的来源，
但开发人员在 IRC 中说我无法使用数据 URI。

我也对此进行了测试，但对我来说它不起作用。

所以我在 /tmp 中缓存（d）图像。

现在您可以查看所有食谱，并根据标题搜索特定的食谱，但图像关联完全是错误的。如果您搜索 2.th ，则会显示 2.th 的配方，但会在 sqlite 表中显示第一个配方的图像。

这里有两张图片，用来理解问题：
[2.th recipe 获取第一个 recipe 的图片](http://imgur.com/81Otj,tFCbX#0)

我已经在一些 IRC 房间寻求帮助，但没有人能帮助我......

我认为您必须以某种方式保存每个图像的状态。

**如果您有一个不需要缓存图像的解决方案，我会很高兴。**

完整的源文件可以在这里查看：[http ://bazaar.launchpad.net/~gotwig/lens-cooking/lens-cooking/view/head:/unity-scope-gourmet](http://bazaar.launchpad.net/~gotwig/lens-cooking/lens-cooking/view/head:/unity-scope-gourmet)

所以，这是我的代码的特定部分：

```
if row[14]:
        open('/tmp/unity-scope-gourmet/icon' + str(i), 'wb').write(row[14])
        model.append(uri, '/tmp/unity-scope-gourmet/icon' + str(i), 1, "text/html", title, comment, uri)
else:
        if os.path.exists('/tmp/unity-scope-gourmet/icon' + str(i)):    os.remove('/tmp/unity-scope-gourmet/icon' + str(i))
        model.append(uri, '', 1, "text/html", title, comment, uri) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T13:31:07.183

我通过将缓存图像的文件名与配方的每个 ID 结合起来解决了这个问题。

代码：

```
i = row[0] 
```

在此处查看完整的解决方案：http: [//bazaar.launchpad.net/~gotwig/lens-cooking/lens-cooking/revision/32](http://bazaar.launchpad.net/~gotwig/lens-cooking/lens-cooking/revision/32)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:21:55.180

听起来您在描述一个简单的计数器错误。我不清楚你是如何初始化你的计数器“i”的，但如果它关闭了一个，简单的解决方案是在使用它之前简单地添加一个，即：

```
open('/tmp/unity-scope-gourmet/icon' + str(i+1), 'wb').write(row[14])
                                           ^^^ 
```

# java - 使用一个连接从域中读取多个 html 源

> ID：10033326
> 
> 赞同：-2
> 
> 时间：2012-04-05T17:42:45.887
> 
> 标签：java

我正在开发的 java 应用程序存在一些问题，我正在使用 HtmlCleaner 2.2 库（用于 web-harvest proyect 的库）并且获取页面源代码没有问题。

当我想递归浏览该网站并获得一个类别和产品树作为子级时，我的问题就开始了。我猜脚本每次访问一个页面，它都算作一个用户进入该站点，所以当它访问 15 或 20 个类别或产品页面时，网站防火墙会阻止我的 ip 大约一个小时。

有了这个问题，我想到了 2 个解决方案，第一：使用代理，我不会被禁止，我可以使用线程更快地下载，第二：只打开一个连接。我想使用代理是个坏主意，所以我想用一个简单的代码问，**递归访问网站的 300000 个产品而不被禁止的最佳方法是什么？**最快最简单

将源放在一个字符串中就足以算作已访问。我不想讨论最好的方法，只需要一个合理的方法。

**声明：这是一项学校任务，我不会从中获利，我正在努力减少对网站的危害**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:52:42.083

如果您的爬虫为您正在抓取的网站提供合法的商业价值，您可以联系网站所有者并要求提供数据馈送或排除他们的禁止算法（毕竟，让人们将他们的产品暴露给潜在客户通常是有益的）买家）。

**更新**

根据您的陈述，这是一项学校任务，请您的老师帮助寻找一个愿意为教育利益而被流量轰炸的网站，或联系网站所有者，解释您在做什么，然后询问获得许可。

# c++ - C++ 将已经存在的对象实例暴露给脚本语言

> ID：10033335
> 
> 赞同：1
> 
> 时间：2012-04-05T17:43:16.960
> 
> 标签：c++, python, scripting, lua

所以，我希望能够用脚本语言修改已经实例化的 C++ 对象。我一直在用 LuaBind 研究 Lua，用 SWIG 或 Boost::Python 研究 Python，但我看到的只是如何创建对象的新实例，但我想修改已经存在的实例。例子：

C++：

```
Player playerOne = new Player(); 
```

脚本语言：

```
playerOne.Transform.x += 5; 
```

这是否可能，如果可以，您会建议作为一个好的语言/库来实现这一目标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T05:01:23.907

我最近需要做同样的事情。我也考虑过（并使用过）Boost.Python，但就个人而言（尽管我很喜欢 Boost），我觉得将 Boost 库的一半拖入以获得一个功能有点过头了。

所以，如果你有兴趣，我最近实现了一个非常轻量级的 Python 包装库，称为 ECS:Python。ECS:Python（嵌入式 C++ 脚本与 Python）专为希望将对象从 C++ 应用程序公开到嵌入式 Python 解释器以进行交互式脚本编写的 C++ 开发人员而设计。

它的免费（BSD）和开源：http: [//sourceforge.net/projects/ecspython](http://sourceforge.net/projects/ecspython)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T15:58:41.010

在我的主要项目中，我们使用 LuaBind，它运行良好。我们基本上做你要求做的事情。我们有现有的 C++ 对象，我们希望以各种方式扩展其行为，但是在对象本身的 C++ 代码中对行为进行这些更改将是大量工作和风险。

因此，在您的示例中，您需要至少 2 个 C++ 包装器类 - 一个代表“游戏”，允许您编写 API 函数来返回玩家，以及一个包装器类，用于包装您可以返回的 C++ 玩家类卢阿。每个包装器函数都将具有 api 函数/属性，这些函数/属性将摆弄它在内部包装的单个对象，lua 可以调用并将值传递给。这是一篇文章的链接，它为您提供了使用 LuaBind 的非常简单的示例及其外观：

[http://blog.nuclex-games.com/tutorials/cxx/luabind-introduction/](http://blog.nuclex-games.com/tutorials/cxx/luabind-introduction/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T12:44:19.067

我在我的项目中遇到了问题。看看我在 Ogre3d 论坛上的帖子： [http ://www.ogre3d.org/forums/viewtopic.php?f=5&t=41631&p=332200&hilit=mrmclovin#p405204](http://www.ogre3d.org/forums/viewtopic.php?f=5&t=41631&p=332200&hilit=mrmclovin#p405204)

代码示例：

```
int main (int argc, char * const argv[])
{
  try
  {
    // Initialize the python interpreter
    Py_Initialize();

    // Create a module dynamically
    object module((handle<>(borrowed(PyImport_AddModule("NameOfMyModule")))));

    // Retrieve the module's namespace
    object main_namespace(module.attr("__dict__"));

    // Put a c++ class named "Car" exported using boost.python into our module
    main_namespace["Car"] = class_<Car>("Car")
                                               .def("drive", &Car::drive)......;

   // The class car now exists in a dynamic module
   // and that module is accessable everywhere as longs as the python interpreter exists

   // Create a instance of Car here
   Car* myCar = new Car(...);

   // Now simply add it to the module. Make sure you have exposed class Car before adding instances
   main_namespace["car_instance"] = object(ptr(myCar)); // the boost python ptr() class make sure not to copy the pointee but only copy pointer adress
  }
  catch( error_already_set )
  {
    PyErr_Print();
  }

  return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:33:31.843

没有任何机制可以将*值*从宿主语言转换为脚本语言。如果您希望在脚本语言中可以访问特定对象实例，则必须通过某些函数将其提供给脚本语言*。*

这与任何其他正确封装的 C++ 类型没有什么不同。如果对象 A 创建并存储了某个实例 T，那么对象 B 获得它的唯一方法是调用 A 上的返回 T 的函数。

# java - 具有键和值的 HashMap 等于使用 Java 的另外两个哈希图的值

> ID：10033336
> 
> 赞同：0
> 
> 时间：2012-04-05T17:43:17.430
> 
> 标签：java, hashmap

我有两个散列图，我想填充第三个散列图，其中键将是第一个散列图的值，值将是第二个散列图的值拆分为数组。IE：

```
hashmap1 = {1=e1, 2=e2}
hashmap2 = {10=word1-word2-word3, 20=word4-word5-word6}
the result:
hashmap3 = {e1=word1-word2-word3, e2=word4-word5-word6} 
```

这是我到目前为止所做的：

```
 static HashMap<Integer, String> catnamecatkeys = new HashMap<Integer, String>();

    static HashMap<Integer, String> keywords = new HashMap<Integer, String>();

    static HashMap<String, String> tempHash = new HashMap<String, String>();

    static HashMap<String, String[]> hash = new HashMap<String, String[]>();

    static String[] arr;

    public static void main(String[] args) {

    catnamecatkeys.put(1, "e1");
    catnamecatkeys.put(2, "e2");
    keywords.put(1, "word1-word2-word3");
    keywords.put(2, "word4-word5-word6");

    for (int key : catnamecatkeys.keySet()) {
        tempHash.put(catnamecatkeys.get(key),null);
    }

    for(String tempkey: tempHash.keySet()){          
        tempHash.put(tempkey,keywords.entrySet().iterator().next().getValue());
        arr = tempHash.get(tempkey).split("-");
        hash.put(tempkey, arr);
    }
    System.out.println(tempHash);
    for (String hashkey : hash.keySet()) {
        for (int i = 0; i < arr.length; i++) {
            System.out.println(hashkey + ":" + hash.get(hashkey)[i]);
        }

       }

    } 
```

但输出是：

```
hashmap3 = {e1=word1-word2-word3, e2=word1-word2-word3} 
```

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:56:40.920

你的问题是这一行：

```
keywords.entrySet().iterator().next().getValue() 
```

总是要返回`keywords`HashMap 的相同条目。尝试使用以下内容构建新的哈希图：

```
for (int i = 1; i < 3; i++) {
    tempHash.put(catnamecatkeys.get(i), keywords.get(i));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:04:16.730

您应该在循环外初始化迭代器，这是完整的示例 -

```
static HashMap<Integer, String> catnamecatkeys = new HashMap<Integer, String>();

static HashMap<Integer, String> keywords = new HashMap<Integer, String>();

static HashMap<String, String> tempHash = new HashMap<String, String>();

static HashMap<String, String[]> hash = new HashMap<String, String[]>();

static String[] arr;
public static void main(String[] agrs)
{     
   catnamecatkeys.put(1, "e1");
        catnamecatkeys.put(2, "e2");
        keywords.put(1, "word1-word2-word3");
        keywords.put(2, "word4-word5-word6");

        for (int key : catnamecatkeys.keySet()) {
            tempHash.put(catnamecatkeys.get(key),null);
        }
     Set<Entry<Integer,String>> set =  keywords.entrySet();
      Iterator<Entry<Integer, String>>  iterator= set.iterator();
        for(String tempkey: tempHash.keySet()){          
            tempHash.put(tempkey,iterator.next().getValue());
            arr = tempHash.get(tempkey).split("-");
            hash.put(tempkey, arr);
        }
        System.out.println(tempHash);
        for (String hashkey : hash.keySet()) {
            for (int i = 0; i < arr.length; i++) {
                System.out.println(hashkey + ":" + hash.get(hashkey)[i]);
            }

           }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T20:20:18.433

根据你的例子，你有：

```
hashmap1 = {1=e1, 2=e2}
hashmap2 = {10=word1-word2-word3, 20=word4-word5-word6}
the result:
hashmap3 = {e1=word1-word2-word3, e2=word4-word5-word6} 
```

hashmap1 和 hashmap2 之间没有公共键，因此我们试图将 hashmap1 中键为“1”的值与 hashmap2 中键为“10”的值相关联。除非保留有关如何将条目从 hashmap1 映射到 hashmap2 的附加信息，否则无法执行此操作。如果使用保证迭代顺序与插入顺序相同的映射（例如 LinkedHashMap），则此附加信息可以是映射中的插入顺序。

# javascript - 为 Aptana Studio 编写自定义命令

> ID：10033339
> 
> 赞同：0
> 
> 时间：2012-04-05T17:43:25.780
> 
> 标签：javascript, eclipse, aptana

我已经通过 Ruby 包编写/修改了几个自定义片段（呃，糟糕！）但我想变得更复杂一些......

a) 我可以解析/修改当前文档吗？（通常是 JavaScript）

b) 我可以进入项目文件树并阅读内容吗？

c) 是否可以在非 Ruby 中编写命令？例如 JavaScript 或 Python？

具体来说，我想写一些自动管理导入的东西（我从 ActionScript 编辑器中错过的东西）以减少手动输入： var MyClass = require('path/to/MyClass'); 然后一遍又一遍地手动对它们进行排序......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:56:52.230

您可以做任何您喜欢使用 Java/Eclipse 做的事情。不幸的是，本机尚不支持其他语言（即 JavaScript 或 Python），但您可以尝试在此处查看一些相关页面：[http ://code.google.com/p/jrfonseca/wiki/PythonMonkey](http://code.google.com/p/jrfonseca/wiki/PythonMonkey)

根据您的观点，我将调查[https://wiki.appcelerator.org/display/tis/Interacting+with+Eclipse+or+Java](https://wiki.appcelerator.org/display/tis/Interacting+with+Eclipse+or+Java)，因为这将提供一些有关如何从 Ruby 中调用 Java 类的信息。

对于项目，我会查看导航器框架。

对于解析/AST，我建议查看 github 上 Aptana 源代码中的 JavaScript 解析器/编辑器：[https ://github.com/aptana/studio3/tree/development/plugins/com.aptana.editor.js](https://github.com/aptana/studio3/tree/development/plugins/com.aptana.editor.js)

# safari - 布局更改时的 Safari 渲染问题

> ID：10033340
> 
> 赞同：1
> 
> 时间：2012-04-05T17:43:40.390
> 
> 标签：safari, render

Safari 5 给了我一个奇怪的渲染问题。这是一个 JS/jQuery 图像带。当您单击一个时，它会从当前选定的图像中删除“选定”类并将其应用于您刚刚选择的类，移动蓝色边框以显示更改。它还会更新从 JSON 提要中检索到的其他一些内容。

问题在于，当内容大小发生变化并推动传送带时，边框渲染会破裂。看到它的最佳方式是在这张图片中。

[http://i.imgur.com/4DVPK.jpg](http://i.imgur.com/4DVPK.jpg)

以前有人见过这样的事情吗？这是标记。

```
<span id="photo-index">1 of 21</span>
<span id="photo-caption"><span class="count">1.</span>bla bla bla</span>
<div class="jquery-belt" id="article-photo-belt">
    <div class="window">
        <ul class="clearFix" style="width: 2232px;">
            <li class="selected">
                <a href="#"><img width="75" height="75" alt="..." title="..." src="..."></a>
            </li>
            <li>
                <a href="#"><img width="75" height="75" alt="..." title="..." src="..."></a>
            </li>
            <li>
                <a href="#"><img width="75" height="75" alt="..." title="..." src="..."></a>
            </li>
            <li>
                <a href="#"><img width="75" height="75" alt="..." title="..." src="..."></a>
            </li>
        </ul>
    </div>
    <span class="btn next"><a href="#"></a></span>
</div> 
```

# inheritance - Django中的通用视图继承

> ID：10033343
> 
> 赞同：0
> 
> 时间：2012-04-05T17:43:44.577
> 
> 标签：inheritance, multiple-inheritance, django-generic-views

问题是如何将 kwargs 从 URL 传递到父类视图？

**网址.py**

```
urlpatterns = patterns('',
    url(r'^(?P<x>\d+)/(?P<y>\d+)/scout/$', 
        login_required(ScoutView.as_view()), name="scout"),
) 
```

**视图.py**

查看第一类**__ *init* __**方法。

```
class MapFieldActionView(TemplateView):
    def __init__(self, *args, **kwargs):
        """I NEED TO GET X AND Y HERE."""
        super(MapFieldActionView, self).__init__()
        x, y = kwargs['x'], kwargs['y']

class ScoutView(MapFieldActionView):
    def __init__(self, *args, **kwargs):
        super(ScoutView, self).__init__(*args, **kwargs)

    template_name = "world/actions/scout.html"

    def get_context_data(self, **kwargs):
        pass 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:57:27.610

您可以使用 self.kwargs 字典访问通过 URL 参数传递给类视图的任何 kwargs。该字典将可用于 get_queryset() 和 get_context_data() 方法。

# php - 通过 PHP 打开多个窗口

> ID：10033344
> 
> 赞同：0
> 
> 时间：2012-04-05T17:43:48.257
> 
> 标签：php

相当简单的问题，我还没有看到任何关于这个确切场景的问题。

我在页面上有一个表格。"Page 1" 表单的动作是调用一个 PHP 文档，目标设置为 _blank。“Page 2” PHP 文档处理信息，然后将标题信息设置为特定页面。“行动一”

* * *

我希望“操作 1”改为打开多个页面；我知道通过 javascript 执行此操作的几种方法，但是，如果可能的话，我希望完全保留在 PHP 文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:47:42.870

由于 php 是一种服务器端语言，而 HTTP（谢天谢地）无法重定向到*多个*URL，因此您需要在 JavaScript中实现您的[功能。](http://blogs.msdn.com/b/oldnewthing/archive/2006/11/01/922449.aspx)请注意，这极有可能在移动和外来用户代理上失败，无论如何这对用户来说都是一个麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:54:38.737

有一种方法可以打开多个页面，但它并不是很好。您可以使用帧来执行此操作，并始终将一帧作为下一个目标，这将是一个新的框架集，将一帧作为下一个目标，依此类推。

完成后，您可以继续打开新帧 - 直到最后一个帧的大小约为目标屏幕上的一个像素。这仅在浏览器仍然支持框架时才有效。

# java - Android Froyo：使用信任所有套接字工厂连接到 https 导致目标服务器无法响应

> ID：10033345
> 
> 赞同：1
> 
> 时间：2012-04-05T17:43:48.647
> 
> 标签：java, android, ssl

这一次我真的被困住了。我正在为 Froyo (2.2.0) 开发 Android 应用程序。我需要连接到通过`https`. 至于现在信任所有证书是我想做的事情（我将在接下来的几天内解决这个问题，但现在发布在我身上）。我已经从[这篇非常有用的帖子](https://stackoverflow.com/questions/2642777/trusting-all-certificates-using-httpclient-over-https)中复制粘贴了代码。太完美了，我这样构建我的客户：

```
public class RestClient {
    private static final String LOG_TAG = "RestClient";

    private HttpClient httpClient;
    private Context context;

    public RestClient(Context context) {
        this.httpClient = CustomSSLSocketFactory.getCustomHttpClient();
        this.context = context;
    }

    public String post(String path, String requestBody,
        String optFieldOfInterest) {
        HttpPost httpPost = new HttpPost(getAddress() + path);
        httpPost.setEntity(prepareStringEntity(requestBody));
        Log.d(LOG_TAG, "Executing request:\n" + requestBody);
        return executeRequest(httpPost, optFieldOfInterest);
    }

    private StringEntity prepareStringEntity(String requestBody) {
        StringEntity entity = null;
        try {
            entity = new StringEntity(requestBody, "UTF-8");
            entity.setContentType("application/json");
        } catch (UnsupportedEncodingException e) {
            Log.e(LOG_TAG, "Error while preparing request", e);
        }
        return entity;
    }

    private String executeRequest(HttpRequestBase request)
          throws ClientProtocolException, IOException {
        HttpResponse httpResponse = null;
        String responseString = null;
        httpResponse = httpClient.execute(request); // Exception line
        if (httpResponse.getStatusLine().getStatusCode() == HttpStatus.SC_OK) {
            String responseBody =
                IOHelper.parseStream(httpResponse.getEntity().getContent());
            Log.d(LOG_TAG, "Response body:\n" + responseBody);
            responseString = responseBody;
        } else {
            Log.w(LOG_TAG, "I am not passing through here my log shows it");
        }
        return responseString;
    }
} 
```

但是我遇到以下错误：

```
org.apache.http.NoHttpResponseException: The target server failed to respond
    at org.apache.http.impl.conn.DefaultResponseParser.parseHead(DefaultResponseParser.java:85)
    at org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:174)
    at org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:179)
    at org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:235)
    at org.apache.http.impl.conn.AbstractClientConnAdapter.receiveResponseHeader(AbstractClientConnAdapter.java:259)
    at org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:279)
    at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:121)
    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:421)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
    at com.mycompany.myproject.ws.client.MySSLHttpClient.executeRequest(MySSLHttpClient.java:70)
    at com.mycompany.myproject.ws.client.MySSLHttpClient.post(MySSLHttpClient.java:120)
    at com.mycompany.myproject.ws.asynctasks.RegisterDeviceAsyncTask.doInBackground(RegisterDeviceAsyncTask.java:57)
    at com.mycompany.myproject.ws.asynctasks.RegisterDeviceAsyncTask.doInBackground(RegisterDeviceAsyncTask.java:1)
    at android.os.AsyncTask$2.call(AsyncTask.java:185)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
    at java.lang.Thread.run(Thread.java:1019) 
```

我看到其他人也偶然发现了类似的问题。例如，[这篇文章](https://stackoverflow.com/questions/6216209/https-connection-android)列出了两种解决方案，但都不适合我。[该线程](https://stackoverflow.com/questions/2052299/httpclient-on-android-nohttpresponseexception-through-umts-3g)还提出了一种新的解决方案，也不适用于我。大多数列出的修复程序甚至都没有改变我得到的异常。

如您所见，我尝试了很多事情。希望其他人遇到这样的问题并找到另一种解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T08:59:37.417

现在问题已经解决了。

问题不在于 java / Android 代码，而在于服务器配置。案例如下：我试图访问开发环境服务器。然而，事实证明我们的基础架构工程师使用与生产服务器完全相同的证书对其进行了配置。这意味着证书中的主机名是错误的（与生产环境匹配）。

奇怪的是，这些网络服务可以通过 Firefox 和 Chrome 访问，即使使用了错误的证书，这导致了所有的混乱。

希望在这里描述我的案例将有助于将来其他人解决同样的问题。

# webdriver - 在 Selenium 2.0 Webdriver 中按 id 定位元素失败

> ID：10033346
> 
> 赞同：1
> 
> 时间：2012-04-05T17:43:53.367
> 
> 标签：webdriver, selenium-webdriver

我正在使用 Selenium 2.0 网络驱动程序。每当我尝试在我的页面中查找某些内容时，我的脚本偶尔会失败。它抛出一个异常：

> 无法定位元素：{"method":"id","selector":"username"};

我的代码的一部分：

```
driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);

WebElement userName = driver.findElement(By.id("username"));
userName.clear();
userName.sendKeys("admin"); 
```

它有时使用相同的代码成功通过。我不明白发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T20:14:51.343

有时会发生这种情况，因为页面加载速度比您预期的要慢。我正在通过应用我自己的包装器助手来解决问题。它看起来像这样：

```
 private WebElement foundElement;

 public WebElement find(By by){
    for (int milis=0; milis<3000; milis=milis+200){
       try{
       foundElement = driver.findElement(by);

       }catch(Exception e){
         Thread.sleep(200);
       }

     }
    return foundElement;
 } 
```

稍后在代码中：

```
WebElement userName = find(By.id("username")); 
```

这种方法将尝试找到它，如果没有找到，则休眠 200 毫秒并重试。如果在 3 秒内找不到（可编辑），它将崩溃（您可能不得不在方法中说它会抛出一些异常）

每当我不确定页面的加载速度时，我都会应用它...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T07:34:57.940

解决问题的最佳方法是使用 WebDriverWait 对象让驱动程序等到 id 元素加载到浏览器中 -

```
new WebDriverWait(driver, 10).until(new ExpectedCondition<Boolean>() {

        public Boolean apply(WebDriver arg0) {

            WebElement element = driver.findElement(By.id("username"));

            return element.isDisplayed();
        }
    }); 
```

这确保驱动程序停止检查 id 元素是否已加载。如果它没有在 10 秒内加载，则会抛出 timedOutException。

# web-services - HTML5 和下载文件的巨大本地存储

> ID：10033348
> 
> 赞同：-1
> 
> 时间：2012-04-05T17:43:58.207
> 
> 标签：web-services, html, mp3, local-storage

我正在为分布式 MP3 播放器选择一个平台。它的基本功能将是：

*   验证自己并查询中央服务器（通过对 asmx Web 服务的 HTTP 请求）
*   以某些 JSON 格式获取已批准的 MP3 列表
*   将这些 MP3 下载到本地磁盘
*   播放下载的文件（不是流，播放器也必须在没有临时连接到服务器的情况下工作）

我正在考虑基于 HTML5 的播放器。但我不确定新 HTML5 的 File 对象功能。是否可以将大量 (GB) 的 mp3 数据下载并存储到本地磁盘并仅在 HTML5/js 中访问？

我是不是错过了什么？是否还有一些其他的空白？客户需要尽可能多的平台播放器，因此在 WPF C# 中快速工作是最后的选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T21:09:46.723

我会研究 HTML5 File API 或 chrome 扩展（允许使用 Web SQL DB 进行无限存储）。

文件 API 规范在这里：

[http://dev.w3.org/2009/dap/file-system/pub/FileSystem/](http://dev.w3.org/2009/dap/file-system/pub/FileSystem/)

基本上所有其他存储机制对大多数浏览器都有硬性限制，即使 Web SQL 规定允许您在应用程序中指定最大 db 大小。

# asp.net - ASP.NET 密码强度正则表达式

> ID：10033357
> 
> 赞同：2
> 
> 时间：2012-04-05T17:44:26.933
> 
> 标签：asp.net, regex

我在我的 ASP.NET 网站上使用 ASP.NET Membership 属性进行身份验证。我希望密码非常安全。我希望它们长 7 位，包含一个字母、数字和一个特殊字符。

[我发现这被添加到 web.config](http://msdn.microsoft.com/en-us/library/system.web.security.membership.passwordstrengthregularexpression%28v=vs.85%29.aspx)

```
passwordStrengthRegularExpression=" @\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})" 
```

但是，当我将此添加到我的会员资料时，我收到以下错误：

```
Name cannot begin with the '(' character, hexadecimal value 0x28\. Line 26, position 445. 
```

所以看起来它在 @ 符号之后没有看到转义字符，它正在尝试使用该引号来结束标记。知道我做错了什么吗？

最后，我将如何修改它以也需要一个小写字母和一个大写字母？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:46:48.477

如果您试图转义`"`并且这是在您的 web.config 文件中，您需要这样做`&quot;`，这是 xml 的正确引用实体。至于你想要的正则表达式，试试这个

```
^(?=[a-z]+)(?=.*?\d+)(?=.*?[`~!@#$%^&*\(\)\-_}{\]\[=+\\|]+).{7,}$ 
```

将匹配以下粗体项目

*   地狱
*   你好
*   地狱0号
*   地狱0Th
*   **他！第 10 次**
*   **他！l0Th**
*   **他！l0Th3534534**
*   **他！l0Thdggfsg**

`(?=.*?[A-Z]+)`如果您还希望至少需要一个大写字母，则可以添加，并使其仅匹配最后 3 个。最后，您可以从上面的正则表达式修改以下块，以仅包含您想要允许的特殊字符。

```
[`~!@#$%^&*\(\)\-_}{\]\[=+\\|] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T17:46:32.297

试试这个：

```
ValidationExpression="(?=^.{7,51}$)([A-Za-z]{1})([A-Za-z0-9!@#$%_\^\&amp;\*\-\.\?]{5,49})$" 
```

[在这里](http://regexlib.com/?AspxAutoDetectCookieSupport=1)你可以找到很多样品

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T17:56:01.660

与其处理没有人理解的表达式，不如使用三个（或更多）。以下是这个想法的一些伪代码：

```
abort('to short') if password.length < 8
abort('at least one letter') if password !~ /[a-z]/i
abort('at least two digits') if password !~ /[0-9].*[0-9]/
abort('at least one special character') if password !~ /[!@#$%^\*-=\+\?]/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-19T13:50:28.853

'由[Itrend 解决方案](http://www.itrendsolutions.com)添加 -密码验证

创建一个方法并传递您的文本以验证密码强度.. Dim password AsString password = Trim(txtnewpassword.Text)

DimSmallCharacter() AsString = {“a”、“b”、“c”、“d”、“e”、“f”、“g”、“h”、“i”、“j”、“k”、 “l”、“m”、“n”、“o”、“p”、“q”、“r”、“s”、“t”、“u”、“v”、“w”、“x” "、"y"、"z"、"A"、"B"、"C"、"D"、"E"、"F"、"G"、"H"、"J"、"K"、 “L”、“M”、“N”、“O”、“P”、“Q”、“R”、“S”、“T”、“U”、“V”、“W”、“X” ", "Y", "Z"} DimsmallchacountAsInteger = 0 ForEachsmallchaAsStringInSmallCharacter If (password.Contains(smallcha)) Then smallchacount = smallchacount + 1 EndIf Next Ifsmallchacount<= 0 Then MessageBox("密码必须包含一个字母字符") Exit Sub EndIf

Dim Numbers() AsString = {“0”、“1”、“2”、“3”、“4”、“5”、“6”、“7”、“8”、“9”} DimnumbercountAsInteger = 0 ForEachnumAsStringIn Numbers If (password.Contains(num)) Then numbercount = numbercount + 1 EndIf Next Ifnumbercount<= 0 Then MessageBox("密码必须包含一个数字") Exit Sub EndIf

DimSpecial() AsString = {"@"、"#"、"$"、"%"、"^"、"&"、"*"、"("、")"、"!"} DimcountSpecialAsInteger = 0 ForEach spec AsStringIn Special If (password.Contains(spec)) Then countSpecial = countSpecial + 1 EndIf Next IfcountSpecial<= 0 Then MessageBox("密码必须包含一个特殊字符") Exit Sub

如需更多说明，请[联系我们](http://www.itrendsolutions.com)

# iphone - Iphone 应用程序在解锁屏幕后卡住

> ID：10033360
> 
> 赞同：0
> 
> 时间：2012-04-05T17:44:40.200
> 
> 标签：iphone, objective-c

当我让我的应用程序打开一段时间时，iPhone/iPod 会锁定屏幕。当我解锁它时，我的应用程序会卡住 2 秒钟，然后它会恢复并继续照常运行。为什么是这样 ？我该如何预防？

为了防止这种情况发生，有什么`PLIST`方法可以在应用程序进入锁定屏幕时停止应用程序的进程（可能不是一个更好的主意）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:50:31.033

我不太确定您的第一个问题的答案（您可能在 applicationDidBecomeActive 方法中做了一些繁重的事情，或者应用程序只是重新分配了内存），但我可以回答第二个问题。

您可以通过调用简单地防止自动锁定：
`[[UIApplication sharedApplication] setIdleTimerDisabled: YES];`
一个很好的地方是在`applicationDidFinishLaunching`应用程序委托的方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:57:40.240

在您的应用程序委托中，您是否有任何可能减慢您的应用程序的代码？检查以下方法？

*   -(void) applicationWillResignActive:(UIApplication *)application
*   -(void) applicationDidBecomeActive:(UIApplication *)application
*   -(void) applicationDidEnterBackground:(UIApplication*)application
*   -(void) applicationWillEnterForeground:(UIApplication*)application
*   -(void) applicationWillTerminate:(UIApplication *)application

还使用上述方法确保您的应用程序正确挂起。

当您的应用在内部收到内存警告时记录：

```
-(void) applicationDidReceiveMemoryWarning:(UIApplication *)application 
```

也许当您暂停或重新打开您的应用程序时，会出现内存问题。

# asp.net-mvc-3 - 用于编辑弹出窗口的 MVC3 部分视图

> ID：10033361
> 
> 赞同：1
> 
> 时间：2012-04-05T17:44:41.887
> 
> 标签：asp.net-mvc-3, partial-views, edit

我正在编写一个 MVC3 项目。现在我有一个表，其中包含 Data as actionLinks 列：

```
<td style="color: Black; background-color: Bisque; text-align: center; width: 410px">
                @Html.ActionLink(@item.LookUp_NameString, "EditPartial", "Capitation", new { id = item.CAPITATION_RATE_ID }, new { @class = "actionLink" })
            </td> 
```

EditPartial 顾名思义是一个局部视图，我需要将其作为弹出菜单打开，以便用户可以编辑对象的详细信息保存它，然后我们可以返回原始页面。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:03:31.913

您可以使用 jQuery 和 jQueryUi 来捕获单击并在对话框中打开呈现的操作。

```
<div id="popupWindow" style="display: none;" ></div>

<script type="text/javascript">     
    $(function() {
        $("#popupWindow").dialog({
            width: 600,
            autoOpen: false
        }); 

        $('a.actionLink').click(function() {
            var url = $(this).attr('href');
            $('#popupWindow').load(url, function() {
                $('#popupWindow').dialog('open');
            });
            return false;
        });
    }); 
</script> 
```

# java - GSON 反序列化名称/值对数组

> ID：10033366
> 
> 赞同：9
> 
> 时间：2012-04-05T17:44:59.660
> 
> 标签：java, gson

我的字符串是：

```
"[{"property":"surname","direction":"ASC"}]" 
```

我可以让 GSON 反序列化它，而不添加/包装它吗？基本上，我需要反序列化一组名称-值对。我尝试了几种方法，但无济于事。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T20:59:53.797

您基本上想将其表示为地图列表：

```
public static void main( String[] args )
{
    String json = "[{\"property\":\"surname\",\"direction\":\"ASC\"}]";

    Type listType = new TypeToken<ArrayList<HashMap<String,String>>>(){}.getType();

    Gson gson = new Gson();

    ArrayList<Map<String,String>> myList = gson.fromJson(json, listType);

    for (Map<String,String> m : myList)
    {
        System.out.println(m.get("property"));
    }
} 
```

输出：

> 姓

如果您的数组中的对象包含一组已知的键/值对，您可以创建一个 POJO 并映射到它：

```
public class App 
{
    public static void main( String[] args )
    {
        String json = "[{\"property\":\"surname\",\"direction\":\"ASC\"}]";
        Type listType = new TypeToken<ArrayList<Pair>>(){}.getType();
        Gson gson = new Gson();
        ArrayList<Pair> myList = gson.fromJson(json, listType);

        for (Pair p : myList)
        {
            System.out.println(p.getProperty());
        }   
    }
}

class Pair
{
    private String property;
    private String direction;

    public String getProperty() 
    {
        return property;
    }    
} 
```

# coldfusion - 从结果中获取 id 的问题

> ID：10033372
> 
> 赞同：0
> 
> 时间：2012-04-05T17:45:50.923
> 
> 标签：coldfusion

我正在从存储的过程中返回 2 个结果，并尝试显示徽标，如果其中一个具有徽章 2。它们有一个值为 1 和 2 的徽章 id 列。我正在尝试这样做，但它不会工作：

```
<cfif qBadges.badgeid EQ 2>
 logo here
</cfif> 
```

如果我将其更改为 1，它将显示旧徽标。2 是我刚刚添加的新徽标。谢谢！

**编辑**

```
<cfstoredproc procedure="sel_MemberBadges_p" datasource="DSN">
        <cfprocparam type="In" cfsqltype="CF_SQL_INTEGER" value="#ID#">
        <cfprocresult name="qBadges">
</cfstoredproc>

<cfif qBadges.badgeid EQ 2>
         new logo here
<cfelseif qBadges.badgeid EQ 1>
         old logo
</cfif> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:51:45.740

做这个

```
<cfif qBadges.badgeid[1] EQ 2>
    new logo here
<cfelseif qBadges.badgeid[2] EQ 1>
     old logo
</cfif> 
```

这是因为除非您指定所需的行，否则它将返回第一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:54:08.810

尝试转储结果，以便您可以看到徽章 id 值：

```
 <cfstoredproc procedure="sel_MemberBadges_p" datasource="DSN">
    <cfprocparam type="In" cfsqltype="CF_SQL_INTEGER" value="#ID#">
    <cfprocresult name="qBadges">
  </cfstoredproc>
<cfdump var="#qBadges#" />
<cfabort />
<cfif qBadges.badgeid EQ 2>
     new logo here
<cfelseif qBadges.badgeid EQ 1>
     old logo
</cfif> 
```

# c++ - Eclipse IDE 中的 C++ 错误“未在此范围内声明 nullptr”

> ID：10033373
> 
> 赞同：57
> 
> 时间：2012-04-05T17:45:53.233
> 
> 标签：c++, g++, eclipse-cdt

我正在运行 Eclipse Helios，并且安装了 g++-4.6。希望 g++4.6 实现 C++ 11 特性我没有错。我创建了一个使用 nullptr 和 auto 关键字的 C++ 项目。构建给出以下错误： -

```
../{filename}.cpp:13:13: error: ‘nullptr’ was not declared in this scope

../{filename}.cpp:14:2: warning: ‘auto’ will change meaning in C++0x; please remove it [-Wc++0x-compat] 
```

实际上，直到昨天它还在建设中。我今天不知从何而来。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-04-05T17:49:47.367

根据[C++11 的 GCC 页面](http://gcc.gnu.org/projects/cxx0x.html)：

要启用 C++0x 支持，请将命令行参数 -std=c++0x 添加到 g++ 命令行。或者，要启用除 C++0x 扩展之外的 GNU 扩展，请将 -std=gnu++0x 添加到您的 g++ 命令行。GCC 4.7 及更高版本也支持 -std=c++11 和 -std=gnu++11。

你编译了`-std=gnu++0x`吗？

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-06T11:12:39.433

终于知道该怎么做了。在 Project Properties -> C/C++ Build -> Settings -> GCC C++ Compiler -> Miscellaneous 下添加了 -std=c++0x 编译器参数。现在可以了！

但是如何为所有 C++ 项目默认添加这个标志呢？有人吗？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-08-11T11:37:12.560

您使用的是 g++ 4.6 版本，您必须调用标志 -std=c++0x 进行编译

> **g++ -std=c++0x *.cpp -o 输出**

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-05T17:48:47.503

这是实际的编译器错误还是代码分析错误？有时代码分析可能有点粗略并报告无效错误。

要关闭项目的代码分析，请在项目资源管理器中右键单击您的项目，单击属性，然后转到 C/C++ 常规选项卡，然后是代码分析。然后单击“使用项目设置”并禁用您不希望使用的设置。

另外，您确定要使用 C++11 编译器进行编译吗？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-12-13T00:48:48.817

转到设置 - >编译器...并添加标志“让 g++ 遵循即将到来的 C++0x ISO C++ 语言标准 [std=c++0x]

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-09T06:40:37.063

我在“-c -fmessage-length=0”之后添加了“,-std=c++0x”，在项目属性 -> C/C++ 构建 -> 设置 -> GCC C++ 编译器 -> 杂项下。不要忘记添加逗号“，”作为分隔符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-09T11:18:54.933

尝试使用不同版本的 gcc 对我有用——在我的情况下是 gcc 4.9。

# php - 如何自动将除美国以外的其他国家/地区的流量重新路由到默认网页？

> ID：10033379
> 
> 赞同：0
> 
> 时间：2012-04-05T17:46:24.330
> 
> 标签：php, redirect

我想限制对我网站的完整功能访问，仅限从美国访问的用户。任何尝试从任何其他国家/地区访问该网站的用户我想根据 IP 识别该流量，或者该用户可能不在美国，并显示一个默认网页，例如“我们将很快在您的国家/地区推出”.. 等。 信息。

我已经看到了由 spotify.com 和 netflix.com 实现的此功能，并且当我尝试从印度访问这些站点时，得到了一个类似的即将推出的页面。如何使用 PHP 实现这一点？

感谢您的任何指导或见解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:58:09.197

您需要使用地理定位服务。有些是免费的，有些不是：

[Akamai](http://www.akamai.com/html/technology/products/edgescape.html)、[Quova](http://www.quova.com/)、Digital Envoy（[数字元素服务](http://www.digitalelement.com/)）、Google (JavaScript)、[Maxmind](https://www.maxmind.com/app/ip-location)、[hostip.info](http://hostip.info)、[Geobytes](http://www.geobytes.com/)、[IP2Location](http://www.ip2location.com/)、[IP-GEO](https://ip-geo.appspot.com/)。

每次查询都需要连接一些服务（可以缓存结果）。其他服务允许您下载 IP 到国家/地区映射的数据库。

# javascript - 只从 Facebook JavaScript SDK 中的每个相册中提取一张照片？

> ID：10033381
> 
> 赞同：2
> 
> 时间：2012-04-05T17:46:32.610
> 
> 标签：javascript, facebook, facebook-graph-api

从 Facebook JavaScript SDK 中的每个相册中只提取一张（第一张或最后一张，不管）照片是真的吗？

我试图为每张专辑制作一个周期，但我认为为每张专辑向 Facebook 发出请求并不是一个好主意，特别是如果用户有 50 张或更多专辑。我需要它在每个专辑旁边显示缩略图。

我尝试了什么：

```
FB.api('/me/albums?access_token='+response.authResponse.accessToken,function(response){
    if(response.error){
        alert(response.error);
    }
    else {
        var albums = new Array();
        albums = response.data;
        var albumsCount = albums.length;
        var albumsString = "";
        var i = 0;
        for(i = 0; i<albumsCount;i++){

            //Here is that bad idea with requests in every cycle
            FB.api('/'+albums[i].id+'/photos?access_token='+FB.getAuthResponse().accessToken,function(response){
                if(response.error) {
                    alert(response.error);
                }
                else {
                    var photo=response.data;
                    var photoHere="<img src='"+photo[i].picture+"'>";
                }
            });
            //End of bad idea

            albumsString+="<a href='#' return false'>"+albums[i].name+"</a><br/>";
        }
        var toHTML="List of your albums: "+albumString+"<br/>";
        document.getElementById("resultAlbums").innerHTML=toHTML;
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:56:53.657

您似乎正在寻找每张专辑的封面照片。我发现的一个技巧是使用专辑 ID 中的 /picture 连接。

因此，https://graph.facebook.com/[album_id]/picture 将重定向到该专辑的封面图片。

这将消除对内部慢循环的需要。

您需要通过将 ?access_token=.. 添加到 url 来进行身份验证，以显示非公开专辑的封面。

# java - Eclipse JAR 导出不起作用

> ID：10033382
> 
> 赞同：0
> 
> 时间：2012-04-05T17:46:48.493
> 
> 标签：java, eclipse, jar

我刚刚开始学习 Java（大约一周前），最近几天我使用 Slick2D 构建了一个小游戏。无论如何，每当我从 Eclipse 导出 JAR 并使用“java blahblahblah.jar”运行它时，我都会收到以下错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: /Users/andy/Desktop/game/jar
Caused by: java.lang.ClassNotFoundException: .Users.andy.Desktop.game.jar 
```

一切都被勾选导出，LWJGL 和 Slick2D jar 在 lib 文件夹中，我已经尝试过 FatJar。我在互联网上查看过，似乎找不到任何有效的解决方案。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T18:04:03.123

> 无论如何，每当我从 Eclipse 导出一个 JAR 并使用 'java blahblahblah.jar' 运行它时，我都会得到 [an error]

你需要使用：

```
java -jar blahblahblah.jar 
```

**编辑：** 根据对您原始帖子的评论，您似乎正在导出没有清单的 jar。确保`Runnable Jar`从导出菜单中进行选择。`Run Configuration`导出时还要确保为您的游戏选择有效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:55:08.657

试试这个：

```
java -cp your_jar.jar package.name.ClassName 
```

其中 ClassName 是定义了 main 的类。

-cp 开关表示类路径，它指定 java 将用来查找类的位置。

在此之后，是用作入口点的类的名称。如果您想为它（主要方法）提供参数，那么它们将在类名之后。

如果需要在类路径中指定多个jar文件，linux上用冒号隔开，windows下用分号隔开

# java - 一个 ArrayList 键中的多个值

> ID：10033385
> 
> 赞同：1
> 
> 时间：2012-04-05T17:46:53.327
> 
> 标签：java, arraylist

我试图将多个值放在一个 arraylist 键中，但我得到了一个错误：

班级：

```
public class BestellenWindow extends javax.swing.JFrame {
    private ArrayList<String> bestelling = new ArrayList<String>(); 

    public BestellenWindow() {
        initComponents();
    } 
```

执行的操作：

```
private void BestellenbuttonActionPerformed(java.awt.event.ActionEvent evt) 
{
    bestelling.add(Barcodetext.getText(), Aantaltext.getText());
    System.out.println(bestelling.get(0));       
} 
```

错误：

> 没有为 add(java.lang.String,java.lang.String) 方法找到合适的方法 java.util.ArrayList.add(int,java.lang.String) 不适用（实际参数 java.lang.String 无法转换通过方法调用转换为 int) 方法 java.util.ArrayList.add(java.lang.String) 不适用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:00:30.480

在 Java 中有两个元素。1\. 列表接口：这不包含任何键。它具有值的集合。您可以通过 add(value) 方法一一添加。2\. Map ：它为一组值保存一个键。

```
List<String> userName = new ArrayList<String>();
userName.add("Jesper");
userName.add("Mafue");

Map<Long,String> userMap = new HashMap<Long,String>();
userMap.put(1l,"Jesper");
userMap.put(2l,"Mafue"); 
```

从地图中，您可以通过提供键来检索值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:52:04.043

An`ArrayList`只是一个列表。它没有“钥匙”。如果要按键存储对象，请使用接口的实现`Map`（例如`HashMap`）而不是`List`.

但是，法线`Map`每个键只能存储一个值。如果要存储多个值，可以使用 a `Map<K, List<V>>`（`K`键类型和`V`值类型在哪里），或者您可以使用例如`Multimap`来自[Google Guava](http://code.google.com/p/guava-libraries/)的值。

但还有另一个，也许是更好的解决方案。创建一个新类来保存条形码和 anantal，并将该类的实例存储在您的`ArrayList`. 例如：

```
public class Bestelling {
    private String barcode;
    private int aantal;

    public Bestelling(String barcode, int aantal) {
        this.barcode = barcode;
        this.aantal = aantal;
    }

    public String getBarcode() {
        return barcode;
    }

    public int getAantal() {
        return aantal;
    }
}

// Later:
Bestelling b = new Bestelling(Barcodetext.getText(),
                              Integer.parseInt(Aantaltext.getText()));
bestelling.add(b); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:51:15.147

您正在尝试调用该方法

```
list.add(int index, String value) 
```

它用于在特定位置插入元素。

如果这是您真正想要做的，那么我猜它`Barcodetext`应该包含一个数字字符串，因此您需要将其转换为`int`with

```
Integer.parseInt(Barcodetext.getText()) 
```

相反，如果您想添加多个值，只需调用该方法两次：

```
bestelling.add(Barcodetext.getText());
bestelling.add(Aantaltext.getText()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:23:04.550

使用任一：

```
bestelling.add(...);
bestelling.add(...);
... 
```

或者

```
bestelling.addAll(Arrays.asList(..., ...)); 
```

# asp.net-mvc - NHibernate ISession：异常后没有任何东西可以持久化

> ID：10033388
> 
> 赞同：0
> 
> 时间：2012-04-05T17:47:07.753
> 
> 标签：asp.net-mvc, nhibernate, isession

我对 NHibernate 有疑问`ISession`。当我尝试将错误保存到数据库中时（例如，在 XYZ col 上保存具有重复键的实体）并回滚`Transaction`；`ISession`实例进入 BROKEN/INVALID 状态，此后不会保留任何记录，并且每次都会`NHibernat`引发另一个异常，告诉我第一次问题。

我使用过类似的 ISession 方法，`Flush, Clear, Close`但我的问题存在。另一种方法是请求另一个`ISession`实例，`ISessionFactory`但是当我使用它时，另一个奇怪的问题：`illegal attempt to associate a collection with two open sessions`.

如何在不重新请求另一个 ISession 实例的情况下恢复 ISession 实例`ISessionFactory`？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T13:04:55.070

你不能，也不应该。

如果事务失败，您必须中止请求并显示错误。

合乎逻辑的推论是会话异常不应成为常规流程的一部分。

现在，由于您使用的是 MVC，下面是一个示例，说明如果您允许错误，错误处理可能如何工作：

```
public ActionResult CreateFoo(FooModel model)
{
    if (ModelState.IsValid)
    {
        try
        {
            SaveThe(model);
            TheTransaction.Commit();
            return RedirectToAction("Whatever");
        }
        catch (WhateverTheDuplicateKeyExceptionIs)
        {
            ModelState.AddModelError("", "Duplicate XYZ");
        }
    }
    return View();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T13:36:35.247

您无法恢复 ISession。从[文档](http://nhforge.org/doc/nh/en/index.html#manipulatingdata-exceptions)：

> 如果 ISession 抛出异常，您应该立即回滚事务，调用 ISession.Close() 并丢弃 ISession 实例。ISession 的某些方法不会使会话保持一致状态。

[创建 ISession 也很便宜](http://catchblock.com/blog/post/2012/02/12/How-much-does-it-cost-to-create-NHibernate-session-Part-2.aspx)，因此没有理由尝试重用它。如果您有 MVC 应用程序，您可能希望每个请求都有 ISession。

# performance - 在 jvm 缓存中存储 500 mb 的数据可以像 sql 查询一样进行搜索，这是一个好的设计吗？

> ID：10033390
> 
> 赞同：1
> 
> 时间：2012-04-05T17:47:13.123
> 
> 标签：performance, caching, lucene

我要求在 1 秒内获取数据库表的搜索查询结果。此时数据库表正在缓慢返回结果。必须将表移动到缓存并从那里搜索，以便搜索结果快速出现。我想在我现有的搜索页面上进行谷歌类型页面刷新——这意味着页面应该在用户键入时刷新。
为了实现这一点，搜索结果应该在一秒钟内返回。我的数据库是 teradata。它的查询至少需要 2 到 3 秒。因此我想寻找其他选项，比如缓存。我想使用缓存以便结果快来。

列是
**company , Id , Industry, parent ...4 more**
它是一个搜索页面。所以如果用户输入“ja”所有从 ja 开始的项目

**公司 ------------- ID ------------- 行业 --------------父**
jaico ----- -------- 222 -------------油漆 ------------- Jaico asia
Jammy fruits---------- --- 232-------------food-------------- jammy International

该表包含 320 万行，存在 8 列。搜索数据需要返回所有 8 列。按字节计算，每行有 150 个字符。所以总字节数为 320 万 * 150 个字符 = 480 兆字节。我需要将这么多数据存储在缓存中，然后在它们之间触发搜索查询（如 sql（分组、排序、排序））。在这种情况下，最好的选择是什么

1.  ehcache
2.  jboss缓存
3.  尼菲尼斯潘
4.  Apache Lucene

请建议哪个选项好。在内存中进行缓存还是使用 lucene 更好？
**什么需要缓存？-->**是一张320万行8列的表。
**为什么要缓存它？-->**要缓存它，以便搜索结果比 sql 查询**更快**。如果我使用 sql 查询需要很长时间。因此我想转向缓存数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:56:08.230

看看 Apache Solr——你可以通过正确的部署获得这种性能。一方面，您可以分片来分发查询。

# sql - '@starttimestamp' 附近的语法不正确。期待 SELECT 或 (

> ID：10033393
> 
> 赞同：1
> 
> 时间：2012-04-05T17:47:32.260
> 
> 标签：sql, sql-server, sql-server-2008

我在这里做错了什么？

```
Declare @starttimestamp datetime = getdate();
RAISERROR(N'Code not valid until %s', 16, 1, CAST(@starttimestamp AS VARCHAR)); 
```

产生一个错误说`Incorrect syntax near 'CAST'.`和`Incorrect syntax near '@starttimestamp'. Expecting SELECT or (`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:54:31.913

您不能在 raiserror 命令中执行功能。首先将您的日期转换为字符串，如下所示：

```
Declare @starttimestamp datetime = getdate(),
        @TextDate  char(19)
select @TextDate = convert(char(19),@starttimestamp,120)

RAISERROR(N'Code not valid until %s', 16, 1, @TextDate) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:54:23.240

```
Declare @starttimestamp varchar(20) = cast(getdate() as varchar(20)); 
RAISERROR(N'Code not valid until %s', 16, 1, @starttimestamp ); 
```

# c# - 将 IFRAME 投射到位图中

> ID：10033394
> 
> 赞同：0
> 
> 时间：2012-04-05T17:47:36.110
> 
> 标签：c#, winforms, iframe

如果我从我的 webBrowser 获得 IFRAME elemenet 并将其转换为位图，是否有可能？IFRAME 使用指向动态图像的 src 属性。

通常，当我想使用 IMG 元素执行此操作时，我会将其复制到剪贴板`IHTMLControlRange`，然后从那里将其转换为位图。

这似乎不适用于 IFRAME，有人有解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:55:46.747

您应该能够使用打印屏幕功能，模仿 ALT-Print Screen 操作。这将为您提供作为位图的窗口，其中包括 iFrame，然后您需要将精确坐标归零并裁剪位图。

这是另一个解决 C# 打印屏幕功能的 SO 问题：

[.NET 2.0 WinForm 打印屏幕](https://stackoverflow.com/questions/1008249/net-2-0-winform-print-screen)

这是一篇关于在 C# 中裁剪图像的文章：

[http://msdn.microsoft.com/en-us/library/7wt4bf7h.aspx](http://msdn.microsoft.com/en-us/library/7wt4bf7h.aspx)

编辑：更改了我最初发布的用于图像裁剪的 URL……这更具体到 WPF，抱歉。

# javascript - 迭代多维位置数组

> ID：10033396
> 
> 赞同：0
> 
> 时间：2012-04-05T17:47:59.103
> 
> 标签：javascript, google-maps

我正在将 gmap 从 Java V2 迁移到 Java V3，并且在尝试同时在地图上放置多个位置时遇到问题。过程爆炸了。这是由于语法错误（感谢 Chang 指出）。以下内容已被编辑（来自原​​始帖子）并按预期工作。

外部脚本文件：

```
//<![CDATA[    
function initialize() {
var myOptions = {
center: new google.maps.LatLng(41, -81.64),
zoom: 7,
mapTypeId: google.maps.MapTypeId.ROADMAP
};

var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

setMarkers(map, storeloc);
}

/*
* create a multidim array of locations,
* array elements title,lat,lng,zIndex.
*/
var storeloc = [
    ['7515 Auburn Road Painesville', 41.66, -81.24, 4],
    ['8775 Darrow Road Twinsburg', 41.305634, -81.440208, 3],
    ['2496 E Aurora Road Twinsburg', 41.311218, -81.459404, 2]
    ];

/*
* Define setMarkers function with map and locations parameters
* storeloc multidim array assigned to locations
*/
function setMarkers(map, locations){

var i;
for (i = 0; i < locations.length; i++) {
      var store = locations[i];
      var myLatLng = new google.maps.LatLng(store[1], store[2]);
      var marker = new google.maps.Marker({
         position: myLatLng,
         map: map
      });
    }
  }

//edit
google.maps.event.addDomListener(window,'load',initialize);
//]]> 
```

然后在 HTML 中调用 initialize() 函数：body onload="initialize()"

在将 addDomListener 添加到脚本文件的末尾之前，我收到一条错误消息，提示初始化无效。RWhite35

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T01:55:01.900

上面编辑的帖子是这个问题的答案。`initialize()`除了使用 onload 事件处理程序调用 HTML body 标记内的函数之外，我还在脚本末尾添加了以下 DOM 侦听器行。

```
google.maps.event.addDomListener(window,'load',initialize); 
```

# flash - .swf 未在 Internet Explorer 中加载，chrome 在 safari、firefox 中加载？

> ID：10033398
> 
> 赞同：0
> 
> 时间：2012-04-05T17:48:09.837
> 
> 标签：flash, internet-explorer

怎么可能是 SWF 没有在 windows 上的 Internet Explorer chrome 中加载，但在 osx 上的 Firefox 和 safari 上运行良好？

我将文件称为 myhomepage.fr/videoplayer.swf

IE 不支持直接所有的 swf 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:51:48.303

您确实应该使用某种嵌入来包含您的 SWF。在幕后，IE 以前只是生成一个隐藏的 html 文档来包装 .swf。

使用 SWFObject：[http ://code.google.com/p/swfobject/](http://code.google.com/p/swfobject/)

# extjs4 - 如何在两个商店之间共享一个 AJAX 调用？

> ID：10033400
> 
> 赞同：4
> 
> 时间：2012-04-05T17:48:35.193
> 
> 标签：extjs4, store

我有两个 Sencha/ExtJS4 网格，它们使用完全相同的数据（即相同的 store.proxy.url），但每个都使用不同的过滤器，因此每个都有自己的单独存储。问题是我正在进行不必要的 AJAX 调用来检索要使用的额外副本。

进行单个 AJAX 调用然后在两个商店之间共享数据以进行独立过滤的推荐方法是什么？

潜在的解决方案：

*   创建两个扩展同一个商店的类？
*   使用相同的代理实例？
*   检索一个商店然后克隆它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:59:17.043

Ext JS 4 框架似乎是为了让每个视图都有自己的存储而构建的。如其他答案所述，您最好的选择是创建第二个商店并将所有记录从一个复制到另一个。

```
function cloneStore(src, dest) {
    var recs = src.getRange(); // returns array of records
    dest.loadRecords(recs);  // removes existing records before batch add
} 
```

该功能的确切实现可能会有所不同，具体取决于您需要如何分散数据。如果每个网格只需要一个数据子集开始，您可以从您的 Ajax 调用初始化一个主存储，然后直接在 store.data MixedCollection 上使用过滤器创建两个子存储。

```
// Note: This function isn't exactly "good practice"
// Actual implementation may vary
function populateSubStores(master, storeA, storeB) {
    var dataA = master.data.filter(/* filter criteria for store A */),
        dataB = master.data.filter(/* filter criteria for store B */);
    // dataA and dataB are MixedCollections of records
    storeA.loadRecords(dataA.getRange());
    storeB.loadRecords(dataB.getRange());
} 
```

或者它的一些变体。这应该足以让您朝着正确的方向开始。

如果您真的很热情，您可以创建一种新类型的商店，它维护表示来自不同视图的过滤器状态的单独 MixedCollections，然后将每个过滤器状态作为商店返回，该商店具有相同的接口，`Ext.data.Store`但具有在“ master" 存储的内部表示，以便现有视图可以在没有覆盖的情况下运行。但我不推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T12:30:24.960

您可以创建一个存储的两个实例，然后使用`getRange()`和`add()`方法将数据从一个存储复制到另一个存储。创建两个类似乎不合理。

# javascript - setSubmitMode 方法在用户之间表现不同

> ID：10033408
> 
> 赞同：2
> 
> 时间：2012-04-05T17:49:01.143
> 
> 标签：javascript, dynamics-crm-2011, outlook-2010

我有两个自定义选项列表：类型和持续时间。类型选择列表有两个选项，持续时间有三个。根据他在类型选项列表中选择的内容，两个变量之一将传递到 OOTB 描述文本框。根据他在*两个*选项列表中选择的内容，六个变量之一将传递到自定义保修文本框。两个文本框都是可编辑的，因此他可以根据需要调整段落长度的变量。

**问题 1**：setSubmitMode 方法一开始不存在。当它不存在时，他无法修改报价。 **解决方案 1**：我在 OnChange 事件上将 setSubmitMode 设置为“始终”。

**问题 2**：当他试图修改报价时，它会抛出一个只读错误，但仍然允许他修改并保存报价。 **解决方案 2**：我在 OnChange 事件上将 setSubmitMode 设置为“脏”，并添加了一个带有 setSubmitMode 的 OnSave 事件为“始终”。

**问题 3**：当他试图修改报价时，他得到一个“你想保存你的更改”对话框。当他单击“是”时，它会清除他的更改，当他单击“否”时，引用允许他修改它......***我无法生成用户正在获取的对话框。***

我们已经在 CRM for Outlook 和浏览器中进行了尝试。

如果有助于了解，在我们的两个设置中，它看起来就像打开了一个新的报价窗口。但是，在我的情况下，新窗口会立即关闭，而 Outlook 中没有对话框。但在浏览器中，它也会关闭原始表单。（这并不理想，但仍然比他得到的要好。）

谢谢和问候，米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T13:11:27.823

我不确定是否完全理解您的问题，但对于这类问题，我总是使用相同的解决方案。在 OnSave 事件中，我有这段代码来保存由 javascript 编辑的只读字段：

```
 if (Xrm.Page.getAttribute("my_field").getIsDirty()) {
    Xrm.Page.getAttribute("my_field").setSubmitMode("always");
 } 
```

没有 setSubmitMode("dirty") 或其他任何东西。即使在 onChange 事件中。

我希望它有所帮助，否则请毫不犹豫地添加有关您的流程的更多信息。

凯文

# oauth - 哪些 OAuth 提供程序在世界范围内被广泛使用？

> ID：10033412
> 
> 赞同：-2
> 
> 时间：2012-04-05T17:49:26.430
> 
> 标签：oauth, single-sign-on, oauth-2.0

我正忙于通过 OAuth 提供商的单点登录来识别我网站的用户。关键是电子邮件，所以我想在这里获得提供电子邮件的服务列表。

Twitter、viadeo、linkedin 不提供电子邮件，即使授予访问用户详细信息的权限。

现在，我可以使用 facebook 和 live ID。

使用了哪些其他基于 OAuth 的服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:47:51.367

追求大公司可能是个好主意...

*   谷歌有很多人使用的很多服务，也有公司使用谷歌应用程序，所有员工都有一个有效的谷歌账户！=> 他们提供 oAuth
*   微软有 MSN Live，几年前它的前身 Instante Messenger 被包含在 Windows 中，也被很多人使用！=> 他们提供 oAuth
*   Facebook 拥有 8.45 亿月活跃用户和 4.83 亿日活跃用户 => 他们提供 oAuth

我会追随这三个，因为他们是各自领域的大玩家，而且他们都提供 oAuth。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T06:05:44.557

我会说重要的是 facebook、google、yahoo 和 myopenid

# ruby-on-rails - 如何将omniauth的路由从/auth/:provider更改为/myapp/auth/:provider

> ID：10033413
> 
> 赞同：14
> 
> 时间：2012-04-05T17:49:26.977
> 
> 标签：ruby-on-rails, ruby-on-rails-3, omniauth

如何将触发omniauth的路由从使用 /auth/:provider 更改为 /myapp/auth/:provider ？

我也不想重定向，因为我的服务器会将 /myapp/ 中不存在的任何内容发送到错误的位置。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-09-12T15:42:52.140

这是我在**config.ru**文件中执行此操作的方法。我的情况，我的提供者是[CAS](http://www.jasig.org/cas)。

```
use OmniAuth::Builder do
  configure do |config|
      config.path_prefix = '/my-app-path/auth'
  end
  provider :cas,  CAS::OPTIONS 
end 
```

请注意，这`CAS::OPTIONS`是一个具有 CAS 配置的数组`omniauth::cas`。这似乎工作正常。我认为您也必须更改omniauth回调：`/auth/:provider/callback`应该以`/my-app-path/auth/:provider/callback`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-05T18:48:25.077

您可以通过`:setup`选项更改它

来源：[https ://github.com/omniauth/omniauth/blob/e9978e377f1ac2b7271e5a8486dfe103a1c1d48d/lib/omniauth/strategy.rb#L304-L307](https://github.com/omniauth/omniauth/blob/e9978e377f1ac2b7271e5a8486dfe103a1c1d48d/lib/omniauth/strategy.rb#L304-L307)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-13T17:54:50.117

在初始化程序中添加以下选项：

```
option :request_path, 'https://yourdomain.com/auth/yourprovider/callback' 
```

重新启动您的应用服务器并尝试！

# ruby-on-rails - ruby 正则表达式正在使用最后一个匹配来分隔字符串，但应该首先使用

> ID：10033414
> 
> 赞同：0
> 
> 时间：2012-04-05T17:49:30.273
> 
> 标签：ruby-on-rails, ruby, regex, mechanize

我正在解析网站的来源并使用此正则表达式：

```
/page\.php\?id\=([0-9]*)\"\>(.*)\<\/a\>\<\/span\>/.match(self.agent.page.content) 
```

`self.agent.page.content`包含由 mechanize 获取的页面的来源。正则表达式基本上可以工作，但在第二场比赛中，它确实比它应该获取的更多，因为`<\/a\>\<\/span\>`源中有一个以上，而正则表达式使用最后一个，所以我得到一堆 html 废话。如何告诉正则表达式将第一个匹配项用作“结束标记”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:57:01.223

.* 是贪婪的，而 .*? 是非贪婪的。尝试：

```
/page\.php\?id\=([0-9]*)\"\>(.*?)\<\/a\>\<\/span\>/.match(self.agent.page.content) 
```

# algorithm - 哈希表与树

> ID：10033417
> 
> 赞同：6
> 
> 时间：2012-04-05T17:49:40.240
> 
> 标签：algorithm, data-structures, hash, tree, hashtable

哈希表总是比树快吗？虽然哈希表具有 O(1) 的搜索复杂性，但假设如果由于设计不良的哈希函数发生大量冲突，并且如果我们使用链式结构（例如平衡树）处理冲突，那么搜索的最坏情况运行时间将是 O(log n ）。因此，即使在最坏的情况下，我是否可以得出大数据集或小数据集的结论，哈希表总是比树快？另外，如果我有足够的内存并且我不想进行范围搜索，我可以一直使用哈希表吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T17:56:30.093

> 哈希表总是比树快吗？

不，并非*总是*如此。这取决于很多事情，例如集合的大小、散列函数以及某些散列表的实现——还有删除操作的数量。

哈希表*平均*`O(1)`每个操作- 但情况并非总是如此。他们可能在*最坏的情况下*。*`O(n)`*

 **目前我能想到的一些喜欢树木的原因：

1.  订购很重要。【hash-tables不维护顺序，BST按定义排序】
2.  [延迟](http://en.wikipedia.org/wiki/Latency_%28engineering%29)是一个问题——你不能忍受`O(n)`可能发生的事情。[这可能对实时系统至关重要]
3.  数据可能与您的散列函数“相似”，并且许多元素散列到相同位置 [冲突] 并非不可能。[这有时可以通过使用不同的哈希函数来解决]
4.  对于相对较小的集合 - 哈希表之间的隐藏常数很多时候`O(1)`比树的高得多 - 对于小型集合，使用树可能更快。

但是 - 如果数据很大，延迟不是问题，并且冲突是不可能的 - 哈希表在渐近上比使用树更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:56:38.267

如果由于设计不良的哈希函数发生了很多冲突，并且如果我们使用链式结构（比如平衡树）处理冲突，那么搜索的最坏情况运行时间将是**O(n)**（而不是 O(log n)）。因此，即使在最坏的情况下，您也无法得出大数据集或小数据集的结论，哈希表总是比树快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:55:28.610

使用哈希表，并使用适当的维度对其进行初始化。例如，如果您仅使用一半空间，则碰撞很少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T17:55:39.910

在最坏的情况下，您将在 hast-tables 中有 O(n) 时间。**但这**比现在 sun exploding write 的可能性要小数十亿，所以当使用一个好的散列函数时，你可以放心地假设它在 O(1) 中工作，除非 sun 爆炸。
另一方面，哈希表和树的性能可能因实现、语言和月相而异，所以这个问题的唯一好的答案是“尝试两者，*思考*并选择更好”。**

# terminal - 从终端使用 Octave 运行函数

> ID：10033418
> 
> 赞同：2
> 
> 时间：2012-04-05T17:49:42.347
> 
> 标签：terminal, octave

我想在我的 test.m 文件中运行一个函数——比如说 test。我想从终端使用 Octave 运行此功能。所以，它应该是这样的：

```
$>/Users/me/octave/bin/octave test(param1,param2)? 
```

我怎样才能做到这一点？我可以在 Matlab 中做到这一点。但我没有在 Octave 中找到方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T18:01:40.040

You can use `octave --eval CODE`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-18T05:33:08.123

可以在[此处](http://wiki.octave.org/FAQ#How_do_I_execute_an_Octave_script.3F)找到 Octave 的相关文档。要使用输入 args 运行函数：

1.  在终端`cd`到您的工作目录。
2.  键入`octave`以打开交互式会话。
3.  `ls`检查您的函数文件是否在您的工作目录中，`cd`如果没有，则检查该目录。
4.  键入函数的名称，然后按正确的顺序在括号中输入参数，例如：`>foo(100)`。然后，您的函数将运行，吐出您打印的任何内容以及不以 . 结尾的代码行的所有结果`;`。

# wpf - WPF绑定到函数？

> ID：10033419
> 
> 赞同：1
> 
> 时间：2012-04-05T17:49:45.903
> 
> 标签：wpf, data-binding

首先让我说我对 WPF 很陌生，所以要温柔。

看起来这应该很容易，但我只是错过了一些东西。我已经在一些类/属性上实现了 INotifyPropertyChanged，并开始将它们绑定到 XAML 中的元素，但现在我有一个更复杂的绑定来进行更新文本或更改颜色。我需要的是，当我的对象的 Alarm 属性设置为 true 时，我需要更改颜色、启动动画、创建和显示控件中的其他元素。我以为当属性更改时我可以在我的控件中调用一个函数，但由于 WPF 隐藏了元素如何“绑定”到模型的属性，我不知道如何连接它。有没有更好的方法来对属性更改执行这种更复杂的响应？如果没有，那里有样品吗？我找不到任何与我正在寻找的内容相近的东西，但我可能没有使用正确的术语进行搜索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:46:13.673

> 我需要的是，当我的对象的 Alarm 属性设置为 true 时，我需要更改颜色、启动动画、创建和显示控件中的其他元素。

*   **更改颜色：**将要更改颜色的元素的颜色/前景绑定到设置警报的布尔值，并在基于布尔值`IValueConverter`返回的绑定中添加一个。`Brush`
*   **启动动画：**在需要动画的任何元素上使用（数据）触发器，在该触发器中，使用情节提要来定义所需的动画。
*   **在控件中创建和显示其他元素：**这实际上取决于您的 MVVM 做得如何，如果这些元素是`ObservableCollection`通过`ListBox`/ `ListView`/的可视化`ItemsControl`（它应该），将 a`Command`连接到设置警报开/关的任何东西（ Button 类有一个内置的 Command 属性，其他`UIElement`s 可能需要使用*System.Windows.Interactivity*）并且在 this`Command`将指向的方法中，向 中添加一个新项，将`ObservableCollection`通过添加一个新项来`ItemsControl`自动反映更改控制。

当然这只是原始信息，你可能对所有这些东西都不熟悉，这就是谷歌发挥作用的时候；）

高温下，

呸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:57:04.407

您的计时器/警报只需要在它过去时更新绑定属性。然后该属性应引发 PropertyChanged 事件以通知 GUI 进行更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:28:01.717

您应该查看在视图模型中的属性更改时触发的 DataTriggers。EnterActions 和 ExitActions 将允许您在属性值更改时播放故事板。这是一个如何使用它的示例[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.triggerbase.enteractions.aspx)。您可以使用内容控件并设置模板或 ContentTemplate 的样式来添加所有元素并让它控制其他元素的可见性或不透明度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:55:13.943

对于响应属性更改事件的复杂行为，您应该使用以下方法：（我正在输入这个自由式，所以请原谅任何小的语法错误）

```
class MyClass : INotifyPropertyChanged
{    
    //Presumably you've already done this part
    private object _myProperty = null;
    public object MyProperty
    {
        get { return _myProperty; }
        set
        {
            _myProperty = value;
            NotifyPropertyChanged("MyProperty");
        }
    }

    public MyClass()
    {
        this.PropertyChanged += My_PropertyChanged;
    }

    private void My_PropertyChanged( object sender, PropertyChangedEventArgs e)
    {
        if( e.PropertyName == "MyProperty" )
        {
            //Do Something complicated
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T20:54:39.890

我不认为你在看这个权利。您的类具有逻辑、执行计算、强制约束和强制属性之间的关系。如果您有警报，希望有一些业务逻辑来处理这个问题，并且应该在课堂上（而不是 UI）完成。UI 不是为处理警报而构建的，它是为显示该警报的状态和操作而构建的。您将在警报情况下使新控件可见并隐藏其他控件。在动画上，我认为您可能想要抛出一个您监听的事件来启动动画。那里的想法是，当引发警报时可以注册额外的句柄 - 您希望将业务逻辑与 UI 分离（而不是将业务逻辑拉入 UI）。

# django - 无法在 auto_now = True 的表单上显示 DateField

> ID：10033422
> 
> 赞同：1
> 
> 时间：2012-04-05T17:50:02.313
> 
> 标签：django, django-models

我有一个带有 auto_now 的模型，并为更新和创建字段设置了 auto_now_add：

```
class HotelProfiles(models.Model):
  fe_result_id = models.AutoField(primary_key=True)
  fe_created_date = models.DateTimeField(verbose_name='Created',
                                         blank=True,
                                         auto_now_add=True)
  fe_updated_date = models.DateTimeField(verbose_name='Updated',
                                         blank=True, 
                                         auto_now=True) 
```

在管理员中，它显示这两个字段，但使它们不可编辑。它们似乎没有传递给我要呈现的表单。我不希望它们可编辑，但我想显示在我的表单顶部。我怎样才能做到这一点？

这是在我的 HotelProfilesAdmin 类中：

```
readonly_fields = ('fe_result_id', 'fe_created_date', 'fe_updated_date', 'fe_owner_uid')
#date_hierarchy = 'lto_end_date' 
fieldsets = (
    ("Internal Use Only", {
        'classes': ('collapse',),
        'fields': ('fe_result_id', 'fe_created_date', 'fe_owner_uid', 'fe_updated_date', 'fe_result_status')
    }), 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:01:58.310

*   将您想要的字段设为只读
*   显式覆盖此管理表单中可用的字段（只读字段将存在但只读）

例子：

```
from django.contrib import admin

class HotelProfilesAdmin(admin.ModelAdmin) :
    # Keep the fields readonly
    readonly_fields = ['fe_created_date','fe_updated_date']

    # The fields in the order you want them
    fieldsets = (
        (None, {
            'fields': ('fe_created_date', 'fe_updated_date', ...other fields)
        }),
    )

# Add your new adminform to the site
admin.site.register(HotelProfiles, HotelProfilesAdmin) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T20:08:10.827

为了他人的利益，我想出了一个方法来做到这一点。我是 Django 的新手，所以如果有更好的方法，我很想听听。视图代码如下。我不确定 Django 是否没有从查询中返回字段，但我发现确实如此。因此，我不理解的表单渲染中的某些内容删除了这些字段，因此无法渲染它们。因此，我在渲染之前将它们复制到一个名为 read_only 的字典中并将其传递。

```
try:
    hotel_profile = HotelProfiles.objects.get(pk=hotel_id)
    read_only["created_on"] = hotel_profile.fe_created_date
    read_only["updated_on"] = hotel_profile.fe_updated_date
    f = HotelProfileForm(instance=hotel_profile)
    #f.save()
except:
    f = HotelProfileForm()
    print 'rendering blank form'
return render_to_response('hotels/hotelprofile_form.html', {'f' : f, 'read_only': read_only}, context_instance=RequestContext(request)) 
```

# c# - 关于数组大小的面试练习，即我不能使用arraylist、链表或任何标准列表类

> ID：10033424
> 
> 赞同：0
> 
> 时间：2012-04-05T17:50:05.940
> 
> 标签：c#, arrays, dynamic

自从我使用花哨的 IDE 和 C# 以来，我对脑筋急转弯问题变得生疏了。我有这个问题的解决方案，但我真正的问题是**我应该如何处理数组大小？**假设我不能使用列表。这是用 C# 编写的。

数组大小可能太小，或者只是在当前状态下浪费内存。我省略了对负硬币等的检查，所以我们可以只关注算法。所以我想摆脱这条线：`double [] minList = new double[1000];`

这是面试问题，返回总和为一个值的最小硬币数量（如果不可能，则返回-1：

```
public static Main(string [] args) {
    double[] coins = {0.01, 0.05, 0.10, 0.25};
    Console.WriteLine(MinNumberOfCoinsToSum(0.24, coins));
} 

public static int MinNumberOfCoinsToSum(double sum, double [] coins)
{
    double [] minList = new double[1000];

    minList[0] = sum;

    for (int i = 1; i < minList.Length; i++)
    {
        double buffer = minList[i-1];
         for (int j = 0; j < coins.Length; j++)
         {
             if(minList[i-1] - coins[j] >= 0.0)
             {
                    buffer = Math.Min(buffer, minList[i-1] - coins[j]);
             }
          }

          minList[i] = Math.Min(minList[i-1], Math.Round(buffer, 2));

          if (minList[i] == 0.0)
          {
                return i;
          }             
     }
      return -1;
} 
```

好吧，这是一个接受你们所说的答案（尽管如果没有找到它不会返回-1）：

```
private static int MinNumberOfCoinsToSumRecursiveDecimalVersion(decimal sum,  decimal [] coins)
    {
        decimal buffer = sum;
        for(int i = 0; i < coins.Length; i++)
        {
            if(sum - coins[i] >= 0)
            {
                buffer = Math.Min(buffer, sum - coins[i]);
            }
        }
        if (buffer == sum && sum == 0m)
            return 0;

        if(buffer == sum && sum != 0m)
        {
            return Int32.MinValue;
        }
        int result = 1 + MinNumberOfCoinsToSumRecursiveDecimalVersion(Math.Min(buffer, sum),  coins);
        return result;
    } 
```

然而，我真正的问题是，当我事先不知道数组大小时，如何处理数组大小。顺便说一句，谢谢你的小数点……那在面试时会很尴尬。

```
public int MinNumberForCoinSum(int sum, decimal [] coins) {
    // I assume there is a custom Util class, but it would be checking null, empty, or any other business requirement
    foreach(var verification in VerificationUtil.GetArrayVerifications()) {
        verification.Verify(coins);
    }

    if(sum < 0 ) { Throw new InvalidArgumentException()); }

    return MinNumberOfCoinsToSumRecursiveDecimalVersion(sum, coins);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:50:10.330

处理未知数组大小的经典解决方案是使用初始容量，然后在它满时开始调整大小。增长因子通常为 2。这是 .NET 框架中大多数不断增长的数据结构（列表、堆栈、队列等）所做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T21:34:53.323

如果我听起来令人讨厌，请原谅：你离题了。这个问题与调整数组大小无关。这是一个解决方案。

```
public static int numberOfCoins(double[] coins, double sum){
    int total = 0;
    Arrays.sort(coins);
    int amount = (int)(sum*100);//convert to int for precision
    for(int i=coins.length-1; i>=0 && amount > 0; i--){
        int coin = (int)(100*coins[i]);//convert to int for precision
        total+=amount/coin;
        amount%=coin;
    }
    if(amount>0)
       return -1;
    return total;
}//numberOfCoins 
```

测试代码

```
public static void main(String... args){
    double[] den = {0.01,.10,.05,.25};
    System.out.println(numberOfCoins(den,1.65));
} 
```

编辑以处理案例：

在这种情况下，我建议重载该函数。通过在下面添加

```
public static int numberOfCoins(int[] coins, int sum){
    int total = 0;
    Arrays.sort(coins);
    int amount = sum;
    for(int i=coins.length-1; i>=0 && amount > 0; i--){
        total+=amount/coins[i];
        amount%=coins[i];
    }
    if(amount>0)
        return -1;
    return total;
}//numberOfCoins 
```

# ruby-on-rails - 回形针异常：回形针::AdapterRegistry::NoHandlerError

> ID：10033425
> 
> 赞同：42
> 
> 时间：2012-04-05T17:50:08.097
> 
> 标签：ruby-on-rails, paperclip

在 rails 3.2.2 中使用 Paperclip 3.0.1 我得到了这个错误：

```
**Paperclip::AdapterRegistry::NoHandlerError** 
(No handler found for "2009-11-29-133527.jpg"): 
```

在我的模型中，我有：

```
class Product < ActiveRecord::Base
    ...
    has_many :assets 
    accepts_nested_attributes_for :assets
 end

 class Asset < ActiveRecord::Base
     belongs_to :product
     has_attached_file :image,
               :path => ":rails_root/public/system/:attachment/:id/:style/:filename",
               :url => "/system/:attachment/:id/:style/:filename", 
               :styles => { :medium => "300x300>", :thumb => "100x100>" }
  end 
```

异常在以下位置引发：

```
def create
     **@product = Product.new params[:product]**
     ...
end 
```

带参数：

```
{...,
 "product"=>{"title"=>"wibble1", 
             **"assets_attributes"=>{"0"=>{"image"=>"2009-11-29-133527.jpg"}
                                  },** 
             "description"=>"Who is wibble...", 
             "price"=>"23.45"
            }, 
             "commit"=>"Create Product", 
             ...} 
```

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-06-19T19:46:25.167

引发此错误是因为您没有为 Paperclip 提供正确的课程。它只是一个字符串。

你应该收到这样的东西`params`

```
"asset"=>
  {"image"=>
    #<ActionDispatch::Http::UploadedFile:0x000000056679e8
    @content_type="image/jpg",
    @headers= "Content-Disposition: form-data; name=\"asset[image]\";
      filename=\"2009-11-29-133527.jpg\"\r\nContent-Type: image/jpg\r\n",
    @original_filename=""2009-11-29-133527.jpg"",
    @tempfile=#<File:/tmp/RackMultipart20120619-1043-yvc9ox>>} 
```

你应该在你的视图中有这样的东西（在 HAML 中，非常简化）：

```
= form_for @product, html: { multipart: true } do |f|
  = f.fields_for :asset do |asset_form|
    = asset_form.file_field :image 
```

请记住将您的表单设置为`multipart: true`.

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-04-09T16:07:55.593

我自己也遇到了这个问题。在我的情况下，这是由于跳过标记中的多部分表单声明引起的。

我正在使用formtastic，所以我添加了这个并让它工作：

`semantic_form_for @picture, :html => {:multipart => true} do |f|`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-07-08T03:38:14.210

请注意，在使用 HTML5 画布时，有一种情况值得注意。获取画布数据作为 DataURI 字符串并将其发送到服务器可能会导致此错误。Canvas .toDataURL() 将给出类似“data:image/png;base64,iVBORw0KGg...”的内容，您可以将其与其他信息一起发送到服务器，因此它不同于标准的多部分表单上传。在服务器端，如果您只是将其设置为回形针附件字段，您将收到此错误。您需要将其转换为文件或 IO 对象。你可以这样写一个临时文件：

```
data_uri = params[:canvasDataUri]
encoded_image = data_uri.split(",")[1]
decoded_image = Base64.decode64(encoded_image)
File.open("signature.png", "wb") { |f| f.write(decoded_image) } 
```

或使用 Ruby 的 StringIO，它的作用类似于内存文件接口

```
@docHolder.document = StringIO.new(decoded_image) 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T16:10:53.217

我有`<input type="file" ... multiple="multiple">`文件输入，所以回形针附件数据在一个数组中。我只是通过删除文件输入上的多个属性来解决这个问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-03-11T10:08:24.897

我的问题是不接受路由中的 get 方法，所以我将其更改为补丁方法并且它工作正常。

```
<%= form_for @product, :url => "/products/#{@product.id}/upload",:method => :patch, :html => { :multipart => true } do |f| %> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-01T14:33:37.043

我很确定您的问题出在视图中的 form_for 上，请尝试以下操作：

```
<%= form_for @restaurante, :html => { :multipart => true } do |form| %>
   Nome:<%= form.text_field :nome%>
   Endereço:<%= form.text_field :endereco %>
   Especialidade:<%= form.text_field :especialidade %>
   Foto:<%= form.file_field :foto %>
   <%= form.submit 'create'%>
<% end %> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-14T07:37:06.690

我遇到了同样的问题，我认为是因为有两个表共享相同的`attached_file_name`......在我的情况下，我在`:photo`活动和推文中都添加了一列，那么情况似乎是系统可以找到其中一个但不是另一个。因为文件保存在`/public/photo/:id/:id`路径中，如果你有两列都命名为`photo`，那么我认为问题就出现了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-05T17:56:20.650

确保在安装 Paperclip ('rake db:migrate') 后迁移数据库...此外，您可能需要将 Paperclip 生成的新数据字段添加到模型中的“attr_accessible”行。当我试图让 Paperclip 在我的一个项目中工作时，我遇到了类似的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-12T11:07:34.413

对我来说，问题是这样的：

我在控制器中使用了这样的行，正如在一些答案中看到的那样：

```
@image = User.find(params[:id]).image.<b>path</b>(:small) 
```

我遇到了“文件没有处理程序”的问题

所以，我刚刚删除了“路径”并且它起作用了：

```
@image = User.find(params[:id]).image(:small) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-25T19:15:07.820

就我而言，我传递了字符串，就像@MauricioPasquierJuan 的回答一样，但我没有使用表格，所以其余的答案不适用。

我找不到任何有关如何以编程方式更新附件的文档 - 可以分配哪些类型，以及为什么分配和保存修改后的记录不会保存修改后的附件。这个问题是我发现的最接近的问题。

在处理上传的 zip 文件中的文件的函数中，将提取的文件保存到临时文件后，这是我的解决方案：

```
record.attachment = File.new( tempfile_path_as_string ) ## probably not the only option
record.attachment.save                                  ## next line doesn't update attachment without this
record.save 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-02-20T16:43:10.037

当我们从 4.2.x 升级到 4.3.x 时，我们必须将主要的回形针字段属性（`picture`、`image`等）从相对 URL 更改为完整 URL 以消除此错误。

# ios - 如何在旧硬件上测试新应用程序？（Xcode 4.3.2 和基本 SDK iOS 5.1；测试设备是 iPhone 3G 和 iOS 4.2.1）

> ID：10033427
> 
> 赞同：2
> 
> 时间：2012-04-05T17:50:12.830
> 
> 标签：ios, xcode, armv6

我正在开发一个 iPhone 应用程序，它不仅应该在新 iPhone 上运行，而且还应该在旧设备上运行。因此，为了进行测试，我确实将配置文件加载到我的旧 iPhone 3G (iOS 4.2.1) 并将其与我的 mac 连接。在 Xcode 中，我也确实将 iOS 部署目标设置为 3.0。使用此设置，该应用程序可以在 iPhone 4 上运行，但不能在我的旧 iPhone 3G 上运行。

我知道我还必须将架构设置为`armv7`to `armv6`，但是当我输入“armv6”时，它会跳回“armv7”。

那么，我必须做什么才能在旧设备上测试新应用程序？我必须输入什么值，我必须在哪里输入它们？我需要为实际的 SDK 下载一些插件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T18:08:10.207

我们正在为我工​​作中的一些应用程序在 iOS 4 和 3 上测试应用程序，通常两个关键点是手臂架构和部署目标，正如您已经指出的那样。

首先，如果您有多个目标，请确保您在任何地方都有正确的配置。

其次，您指出 armv7 “跳”回 armv6。它不应该发生。确保您在第一行使用“armv6”正确输入此字段，在弹出窗口的第二行使用“$(ARCHS_STANDARD_32_BIT)”。

最后，当您尝试启动应用程序时，您的控制台中是否有任何警告或消息？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:52:20.740

XCode 带有一个 iOS 模拟器...您应该能够从 iOS 3.2 - 5.1 进行测试

如果您还没有它，请转到 XCode 中的更新管理器并下载 iOS 5.0 模拟器。

# flash - Flex 4.6 增加套接字接收缓冲区大小

> ID：10033433
> 
> 赞同：1
> 
> 时间：2012-04-05T17:50:54.810
> 
> 标签：flash, apache-flex, sockets, flex4.5, flex4.6

我遇到了套接字问题，我发送的数据在客户端（Flash/Flex）被截断。我的服务器发送的数据已满且完好无损，但 flash 不会等待适当的时间，然后触发一个表示读取数据的事件。这导致数据没有被完全读取，并且（因此）之后我无法解析出对象。我们正在探索将对象剥离成更小的块的可能性，但我们的想法是让它尽可能轻量级，因此我们宁愿让它按预期的方式工作，而不是修补临时解决方案。

我不完全确定将其称为接收“缓冲区”是否正确，因为某些计算机能够接收所有数据而其他计算机则将其截断（这意味着缓冲区足够但闪存不等待无论出于何种原因，适当的时间安排活动）......如果有人有任何想法，我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:12:31.410

如果没有看到您的实现代码，听起来好像可用的字节数或总字节数没有被考虑在内。

这是我使用的一个实现：

```
package
{
    import flash.events.Event;
    import flash.events.EventDispatcher;
    import flash.events.IOErrorEvent;
    import flash.events.ProgressEvent;
    import flash.events.SecurityErrorEvent;
    import flash.net.Socket;

    public class WebRequestService extends EventDispatcher
    {

        //------------------------------
        //  model
        //------------------------------

        protected var hostname:String;

        protected var port:uint;

        public var requestMessage:String;

        public var responseMessage:String;

        private var _socket:Socket;

        //------------------------------
        //  lifecycle
        //------------------------------

        public function WebRequestService(hostname:String, port:uint, requestMessage:String)
        {
            this.hostname = hostname;
            this.port = port;
            this.requestMessage = requestMessage;

            _socket = new Socket();
            _socket.addEventListener(Event.CONNECT, socketConnectHandler);
            _socket.addEventListener(ProgressEvent.SOCKET_DATA, socketDataHandler);
            _socket.addEventListener(Event.CLOSE, socketCloseHandler);
            _socket.addEventListener(IOErrorEvent.IO_ERROR, socketErrorHandler);
            _socket.addEventListener(SecurityErrorEvent.SECURITY_ERROR, socketSecurityErrorHandler);

            _socket.connect(hostname, port);
        }

        protected function socketConnectHandler(event:Event):void
        {
            responseMessage = "";
            _socket.writeUTFBytes(requestMessage);
            _socket.flush();
        }

        protected function socketDataHandler(event:ProgressEvent):void
        {
            while (_socket.bytesAvailable > 4)
            {
                responseMessage += _socket.readUTFBytes(_socket.bytesAvailable);
            }
        }

        protected function socketCloseHandler(event:Event):void
        {
            dispose();
        }

        protected function socketErrorHandler(event:IOErrorEvent):void
        {
            trace("socket error.");
        }

        protected function socketSecurityErrorHandler(event:SecurityErrorEvent):void
        {
            trace("socket security error.");
        }

        public function dispose():void
        {
            if (!_socket)
                return;

            if (_socket.connected)
                _socket.close();

            _socket.removeEventListener(Event.CONNECT, socketConnectHandler);
            _socket.removeEventListener(ProgressEvent.SOCKET_DATA, socketDataHandler);
            _socket.removeEventListener(Event.CLOSE, socketCloseHandler);
            _socket.removeEventListener(IOErrorEvent.IO_ERROR, socketErrorHandler);
            _socket.removeEventListener(SecurityErrorEvent.SECURITY_ERROR, socketSecurityErrorHandler);
        }

    }
} 
```

# ios - 一个 NSData 中的部分 `<` 和部分 `<`

> ID：10033436
> 
> 赞同：0
> 
> 时间：2012-04-05T17:51:05.880
> 
> 标签：ios, soap, wsdl, touchxml

我正在使用[http://sudzc.com](http://sudzc.com)生成的代码访问[http://graphical.weather.gov/xml/SOAP_server/ndfdXMLserver.php](http://graphical.weather.gov/xml/SOAP_server/ndfdXMLserver.php)

正在发送 SOAP 消息，我可以看到返回的消息，这里我有一个`NSData`我打印出来的屏幕截图`connectionDidFinishLoading`。

有线的事情是，符号`<`在开始时显示正确，但随后是`&lt;`.

谁能建议我如何解决这个问题？

![输出](../Images/9717930f8e556a1356a0b111b8b7ae3b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:40:58.307

我不确定您是否可以简单地应用现有编码，例如方便功能的`stringByReplacingPercentEscapesUsingEncoding:`存在方式，但如果现有解决方案不存在，您始终可以使用`stringByReplacingOccurrencesOfString:withString:`.

不过，我会先尝试四处寻找编码转换器，因为我发现这`&lt;`不是您文本中的唯一实体。`&gt;`也存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:44:20.983

我检查了这个 Web 服务的 WSDL，它实际上在 html 正文部分返回了一个 xml。

```
<message name="NDFDgenByDayResponse">
   <part name="dwmlByDayOut" type="xsd:string" />
</message> 
```

所以这个响应实际上是正确的，我只需要自己解析它。

# javascript - FB.login 调用后，Facebook JavaScript SDK 未在 chrome 中设置访问令牌 cookie

> ID：10033442
> 
> 赞同：4
> 
> 时间：2012-04-05T17:51:18.847
> 
> 标签：javascript, ruby-on-rails, facebook

我正在使用 Facebook JavaScript SDK 为我的网站实现登录。我已经让它在 Safari 和 Firefox 上运行，但不能在 Chrome 上运行。

调用 FB.login 方法后，我可以从 Facebook 检索访问令牌，但它不像在 Firefox 和 Safari 中那样在 cookie 中设置访问令牌和用户 ID。目前，我正在手动将访问令牌和用户 ID 写入 cookie，以便登录流程正常工作，但它仍然让我很吃惊，因为访问令牌不是单独用 Chrome 编写的。

有没有人遇到过这个并且知道手头的修复？非常感激。

下面是我的初始化和登录逻辑代码：

```
window.fbAsyncInit = function() {
  FB.init({
    appId      : "#{AppConfig.facebook['app_id']}", // App ID
    status     : true, // check login status
    cookie     : true, // enable cookies to allow the server to access the session
    xfbml      : true  // parse XFBML
  });

  // Additional initialization code here
};

// Load the SDK Asynchronously
(function(d){
   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
   if (d.getElementById(id)) {return;}
   js = d.createElement('script'); js.id = id; js.async = true;
   js.src = "//connect.facebook.net/en_US/all.js";
   ref.parentNode.insertBefore(js, ref);
 }(document));

$(function() {
  $(".fb-login-button").click(function() {
    FB.login(function(response) {
      if (response.authResponse) {
        console.log("Welcome! Fetching your information...");
        $.cookie("user_id", response.authResponse.userID);
        $.cookie("access_token", response.authResponse.accessToken);
        window.location = "#{oauth_facebook_callback_url}";
      } else {
        console.log("User cancelled login or did not fully authorize.");
      }
    }, {scope: 'publish_stream,offline_access,email,user_events,create_event,user_location'});
  });
}); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-10T01:26:57.330

如果您在本地测试您的应用程序，请注意 Google Chrome**不**支持本地文件（包括`localhost`）的 cookie，除非您使用`--enable-file-cookies`标志启动它。但是，如果您使用本地 IP 地址（<code>127.0.0.1）进行测试，Chrome 确实支持 cookie。

您可以在此处查看有关此行为的讨论：[http ://code.google.com/p/chromium/issues/detail?id=535](http://code.google.com/p/chromium/issues/detail?id=535)

（答案修改自[为什么 Chrome 会忽略本地 jQuery cookie？](https://stackoverflow.com/questions/335244/why-does-chrome-ignore-local-jquery-cookies)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T23:12:44.820

请注意，JS SDK 已经将查看者的最新 ID 和 access_token 存储在**fbsr_APPID** cookie 中。每次用户使用`FB.ui`、`FB.login`、`FB.getLoginStatus`with`force = true`或`FB.init`with时，该 cookie 都会更新为最新数据`status: true`。

我强烈建议使用此方法而不是存储您自己的 cookie，因为它是使用您的应用程序的密钥签名的，就像[signed_request](https://developers.facebook.com/docs/authentication/signed_request/)参数一样。您应该按照那里的说明进行解码，验证签名，如果它有效，请使用它。这将防止伪造（但仍可能无法防止短期重放攻击）。

# javascript - 通过 Jquery 在操作后更改链接

> ID：10033443
> 
> 赞同：0
> 
> 时间：2012-04-05T17:51:25.637
> 
> 标签：javascript, jquery, events

我有一个下载链接，用户下载后我想删除下载链接并更改文本。我能够做到这一点，但它做得如此之快，以至于用户无法下载 exe 文件。如果我以某种方式延迟它会是一个解决方案吗？有没有更好的方法来做我正在做的事情？

这是我的 JS

```
function removeLink(){
    try{
        $('#downloadLink').text("Thank You For Downloading This Software!");
        $('#downloadLink').attr('href', 'javascript:void(0)');
    }
    catch(err){
        alert(err.message);
    }
} 
```

关联

```
<a href="download.exe" title="Download" id="download" onclick="removeLink()">Download</a> 
```

我也知道这不是一种非常“安全”的方式，因为我只是使用 javascript，但这主要是针对普通用户的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:57:56.497

像这样的东西？

```
$('#downloadLink').click(function() {
  $(this).replaceWith('<span>Thanks for downloading...</span>');
}); 
```

如果您仍然遇到无法正常工作的问题，`window.location = 'download.exe';`请在点击功能的顶部放置一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:58:05.367

所以 - 知道它不是一种安全的方法 - 有什么问题：

```
$('a').on('click', function() {
    $(this).text('Thank You For Downloading This Software!').removeAttr('href');
});​ 
```

将选择器更改为适用的内容，而不是`$('a')`

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-05T17:58:45.490

您可能不想要函数 removeLink() 因为您没有调用它。而是使用

```
$(document).ready(){

}); 
```

还有你的超时问题......

使用 jQuery 的[delay()](http://api.jquery.com/delay/)

另一件事是您正在调用#downloadLink...不要忘记将ID添加到标签中。

编辑：正如其他人所说，您可能只想在 jQuery 中完成整个功能。

# java - 匿名类实现接口，不能有参数

> ID：10033445
> 
> 赞同：1
> 
> 时间：2012-04-05T17:51:31.560
> 
> 标签：java

我有一些我正在尝试重新编译和理解的代码，但我有一个无法编译的方法，我希望找到好的解决方法。方法如下。

```
private void launchEventPanel(String title) { 
    EventQueue.invokeLater(new Runnable(title) { 
        public void run() { 
        JFrame myFrame = new JFrame(); 
        myFrame.setTitle("Conference Call"); 
        myFrame.setIconImage(CallConference.this.myCore.myPanel.myIconManager.getPromptIcon(CallEMart.class.toString())); 
        myFrame.getContentPane().add(CallConference.this.myEventPanel, "Center"); 
        myFrame.pack(); 
        myFrame.setVisible(true); } }); } 
```

EventQueue.invokeLater 的第二行没有编译，我得到错误“匿名类实现接口，不能有参数”。

非常感谢任何帮助和解决方法。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T17:55:13.620

那是因为 Runnable 只是一个接口，它不接受任何参数作为匿名类。要绕过它，您可以将 final 分配给 upper 参数：

```
private void launchEventPanel(final String title) { 
    EventQueue.invokeLater(new Runnable() { 
        public void run() { 
        JFrame myFrame = new JFrame(); 
        myFrame.setTitle("Conference Call");  
        myFrame.setIconImage(CallConference.this.myCore.myPanel.myIconManager.getPromptIcon(CallEMart.class.toString())); 
        myFrame.getContentPane().add(CallConference.this.myEventPanel, "Center"); 
        myFrame.pack(); 
        myFrame.setVisible(true); } }); } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:55:19.777

嗯，正如它所说，你不能给`Runnable`“构造函数”参数，因为没有构造函数——它是一个接口。

相反，`title` `final`请直接在内部类中声明并使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T17:55:11.327

```
private void launchEventPanel(final String title) { 
    EventQueue.invokeLater(new Runnable() { 
        public void run() { 
        JFrame myFrame = new JFrame(); 
        myFrame.setTitle("Conference Call"); 
        myFrame.setIconImage(CallConference.this.myCore.myPanel.myIconManager.getPromptIcon(CallEMart.class.toString())); 
        myFrame.getContentPane().add(CallConference.this.myEventPanel, "Center"); 
        myFrame.pack(); 
        myFrame.setVisible(true); } }); } 
```

你完成了。尽管据我所知，您实际上并没有`title`在代码中使用任何地方的值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T18:01:14.333

您可以将匿名类转换为嵌套类。它将允许您将参数传递给构造函数。

```
private static final MyRunnable implements Runnable {

    private final String title;

    public MyRunnable(String title) {
        this.title = title;
    }

    @Override
    public void run() {
        // use title here
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T17:56:46.623

`Runnable`是一个接口，因此它不包含接受字符串的构造函数，您在这一行中正在执行此操作：`EventQueue.invokeLater(new Runnable(title) {`

如果您想使用`title`in `public void run()`，只需将 title 作为最终参数，您就可以在该方法中自由使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T17:59:11.577

好吧，正如消息所说：java.lang.Runnable 是一个接口，因此您不能将标题传递给它的构造函数。采用：

```
EventQueue.invokeLater(new Runnable() { 
```

反而。

请注意，标题不在任何地方使用。如果在 Runnable 中需要它，则需要将其声明为 final：

```
private void launchEventPanel(final String title) { 
EventQueue.invokeLater(new Runnable() { 
    public void run() { 
    JFrame myFrame = new JFrame(); 
    myFrame.setTitle(title); 
```

# ruby-on-rails - 给定一个字符串，如何在一个回车后跟另一个字符串？

> ID：10033452
> 
> 赞同：6
> 
> 时间：2012-04-05T17:52:05.510
> 
> 标签：ruby-on-rails, ruby

我有一个这样的字符串`string1`：

```
Hello World, join my game: 
```

我想让 string1 变成：

```
Hello World, join my game:

http://game.com/url 
```

如何使用 ruby​​ 附加回车，然后附加来自另一个变量的链接？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-05T18:03:25.157

这实际上取决于您要输出的内容。

$标准输出：

```
puts "Hello\n\n#{myURL}" 
```

或者

```
puts "Hello"
puts
puts myURL 
```

或者

```
puts <<EOF
Hello

#{myURL}
EOF 
```

如果您将其输出到`html.erb`或`.rhtml`文档中：

```
<%= "Hello<br /><br />#{myURL}" %> # or link_to helper 
```

如果您已经有这样的字符串，`string1`则可以使用`+=`或附加到它`<<`：

```
string1  = "Hello world, join my game:"
myUrl    = "http://example.com"
string1 += "\n\n#{myUrl}" 
```

或者：

```
string1 = "Hello world, join my game:"
myUrl   = "http://example.com"
string +=<<EOF

#{myUrl}
Here's some other details
EOF 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-05T18:00:23.830

假设你有这些字符串：

```
string1 = 'foo'
string2 = 'bar' 
```

这是将它们与中间换行符组合的三种方法：

字符串插值：

```
"#{string1}\n#{string2}" 
```

'+' 运算符：

```
string1 + "\n" + string2 
```

数组和.join

```
[string1, "\n", string2].join 
```

或者

```
[string1, string2].join("\n") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T17:56:15.537

据我所知，没有新的线路常数。使用转义序列 '\n'。像：

```
puts "1\. Hello\n2\. World" 
```

参考：[http ://en.wikibooks.org/wiki/Ruby_Programming/Strings](http://en.wikibooks.org/wiki/Ruby_Programming/Strings)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-05T15:25:02.010

如果您使用 puts 语句，则在新行上打印的简单方法如下：

```
puts "Hello, here is the output on line1", "followed by some output on line2" 
```

这将返回：

```
Hello, here is the output on line1
followed by some output on line2 
```

如果您在终端的 irb 中运行代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-15T04:18:25.220

## 以数组形式输出。

如果您要多次附加到同一个字符串变量，并且您想稍后在新行中输出这些附加字符串中的每一个，您可能需要考虑使用数组来存储每个字符串，然后在显示/输出它们。

```
output = []

output << "Hello World, join my game:"

output << "http://game.com/url"

output << "Thank You!" 
```

现在，如果您在终端或其他地方，您可以`puts`在输出数组上使用：

```
puts output
#=> Hello World, join my game:
#=> http://game.com/url
#=> Thank You! 
```

如果你想在 HTML 中显示它，你可能需要使用以下`join()`方法：

```
output.join('<br>')
#=> "Hello World, join my game:<br>http://game.com/url<br>Thank You!" 
```

你可以在方法中使用任何你喜欢的东西`join()`，所以如果你想在每个字符串之间有两个换行符，你可以这样做：

```
puts output.join("\n\n")
#=> Hello World, join my game:

#=> http://game.com/url

#=> Thank You! 
```

# templates - 如何根据传递的模型参数值呈现模板值？

> ID：10033453
> 
> 赞同：0
> 
> 时间：2012-04-05T17:52:10.043
> 
> 标签：templates, grails, model, render, gsp

我想在一个页面上呈现相同的模板，该模板应该根据参数值（3 或 4）显示值。视图是——

```
 <td >
<g:render template="gdxqStatusTemplate" model="[param:3]" /> </td>
</td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td >
<g:render template="gdxqStatusTemplate" model="[param:4]" /> </td>
</td> 
```

控制器有 -

```
 [ total3:totalValue3,total4:totalValue4] 
```

如何在模板代码中显示适当的总计值 -

```
<table >
    <tr ><td class="InputText" nowrap><b>   MessageQ Status,/td>

<tr> <td class="NoLight" nowrap>Total MessageQ : ${total+params}***/* IT SHOWS "total4" NOT THE VALUE.*/***
</td></tr>
<tr height=30></tr>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:00:24.750

哟必须改变：

```
 <g:render template="gdxqStatusTemplate" model="[param:3]" /> 
```

经过

```
 <g:render template="gdxqStatusTemplate" bean="${total3}" /> 
```

并在您的模板中替换：

```
 <td class="NoLight" nowrap>Total MessageQ : ${total+params}</td> 
```

经过：

```
 <td class="NoLight" nowrap>Total MessageQ : ${it}</td> 
```

文档检查： http: [//grails.org/doc/2.0.x/ref/Tags/render.html](http://grails.org/doc/2.0.x/ref/Tags/render.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:03:13.507

你知道你可以在这里使用数组或对象吗？喜欢

```
model: [total: [null, null, totalValue3, totalValue4]] 
```

并用作

```
<td class="NoLight" nowrap>Total MessageQ : ${total[params]}</td> 
```

# spring - 如何将上传的文件绑定到表单对象属性？

> ID：10033454
> 
> 赞同：2
> 
> 时间：2012-04-05T17:52:10.323
> 
> 标签：spring, spring-mvc, multipartform-data

我想要这样的表单对象：

```
public class FormData {

    private MultipartFile file1;

    private MultipartFile file2;

    // setters/getters for above fields and other properties
} 
```

我希望 SpringMVC 将例如`<input type="file" name="file1">`HTML 表单字段绑定到我的表单对象属性。我在. `<form:file path="file1" />`_ 有可能吗？如果不是，这个限制是否根植于 Spring 内部太深而无法轻易克服？`<form:input type="file" path="file1" />``spring-form.tld`

我知道如何将文件上传表单值绑定到控制器方法参数（在[文档](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-multipart)中描述）：

```
@RequestMapping(value = {"/"}, method = RequestMethod.POST)
public ModelAndView compare(@ModelAttribute(FORM_BEAN_NAME) FormData formData,
    @RequestParam("file1") MultipartFile file1,
    @RequestParam("file2") MultipartFile file2,
    BindingResult bindingResult) { 
```

但是，如果所有 HTML 表单元素都绑定到一个类并且在添加新的上传字段时方法签名不会提升，我会更高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:23:01.847

几年前我就是这样做的。我能记得的唯一区别是我使用`CommonsMultipartFile`而不是界面。如果你尝试这个会发生什么，它会抛出一个异常或者只是值没有被绑定？

# verilog - Verilog，FPGA，使用单元化寄存器

> ID：10033459
> 
> 赞同：3
> 
> 时间：2012-04-05T17:52:47.953
> 
> 标签：verilog, fpga, cpu-registers, xilinx, fsm

我有一个关于我正在研究的 AGC/SPI 控制器的奇怪行为的问题。它在 Verilog 中完成，针对 Xilinx Spartan 3e FPGA。控制器是一个依赖外部输入启动的 FSM。FSM 的状态存储在未显式初始化的**state_reg**中，因为我认为未初始化的寄存器默认为零。当我实现控制器时，FSM 不会运行。监控 SPI 总线我没有观察到任何活动。为了监控 FSM，我将**state_reg**路由到了一个输出总线，该总线连接到一个 LED 组。这就是行**assign data_out = state_reg**是在做。我发现，当我这样做时，FSM 的 AGC/SPI 控制器运行正常，正如在 SPI 总线上观察到的那样。似乎正在发生的事情是**state_reg**在初始化时处于未确定状态，因此 FSM 永远不会处于任何状态，因此它不会运行。但是通过将**state_reg**分配给一个输出，它初始化为**00000000**，正如我从一开始就期望它做的那样。所以我的问题是，未初始化的寄存器是否应该假定值为 0？通过将未初始化的寄存器分配给输出，这是否会迫使它像看起来那样假设为零？或者这里发生了什么我不明白的事情？下面是我的代码。我已经评论了将 *state_reg** 分配给**输出线 [7:0] data_out的相关部分**. 我知道这是一个很长的问题，但我真的很想了解我应该期待什么样的行为。谢谢。

```
 module agc_control
        (
            input wire [7:0] agc_data,
            input wire clk,
            input wire agc_start,
            input wire AMP_DO,
            output reg MOSI,
            output reg SCK,
            output reg CS_AMP,
            output wire inhibit_ADC,
            output wire [7:0] data_out  
         );

        //signals
        reg [4:0] state_reg,
        reg [2:

0] ampclkreg;
    reg ampclk;
    reg [7:0] agc_data_reg;
    reg agc_running;
    reg [7:0] data_out_reg;
    wire agc_done;

    //ampclk generation
    always @(posedge clk)
        begin
            ampclkreg = ampclkreg + 1;
            if (ampclkreg == 3)
                begin
                    ampclkreg = 0;
                    ampclk = ~ampclk;
                end
        end

    always @(posedge clk)
        begin
            if(agc_start == 1)
                begin
                    agc_running = 1'b1;
                    agc_data_reg = agc_data;
                end
            if(agc_done == 1)
                begin
                    agc_running = 1'b0;
                end
        end

    //FSM
    always @(posedge ampclk)
        begin
            if (agc_running == 0)
                begin
                    SCK = 0;
                    state_reg = 0;
                    CS_AMP = 1;
                end
            if (agc_running == 1)
                begin
                    case (state_reg)
                        0:  begin
                                CS_AMP = 1;
                                SCK = 0;
                                state_reg = 1;
                            end
                        1:  begin
                                CS_AMP = 0;
                                MOSI = agc_data_reg[7];
                                state_reg = 2;
                            end
                        2:  begin
                                SCK = 1;
                                state_reg = 3;
                            end
                        3:  begin
                                SCK = 0;
                                MOSI = agc_data_reg[6];
                                state_reg = 4;
                            end
                        4:  begin
                                SCK = 1;
                                state_reg = 5;
                            end
                        5:  begin
                                SCK = 0;
                                MOSI = agc_data_reg[5];
                                state_reg = 6;
                            end
                        6:  begin
                                SCK = 1;
                                state_reg = 7;
                            end
                        7:  begin
                                SCK = 0;
                                MOSI    = agc_data_reg[4];
                                state_reg = 8;
                            end
                        8:  begin
                                SCK = 1;
                                state_reg = 9;
                            end
                        9:  begin
                                SCK = 0;
                                MOSI = agc_data_reg[3];
                                state_reg = 10;
                            end
                        10:begin
                                SCK = 1;
                                state_reg = 11;
                            end
                        11:begin
                                SCK = 0;
                                MOSI = agc_data_reg[2];
                                state_reg = 12;
                            end
                        12:begin
                                SCK = 1;
                                state_reg = 13;
                            end
                        13:begin
                                SCK = 0;
                                MOSI = agc_data_reg[1];
                                state_reg = 14;
                            end
                        14:begin
                                SCK = 1;
                                state_reg = 15;
                            end
                        15:begin
                                SCK = 0;
                                MOSI = agc_data_reg[0];
                                state_reg = 16;
                            end
                        16:begin
                                SCK = 1;
                                state_reg = 17;
                            end
                        17:begin
                                CS_AMP = 1;
                                state_reg = 18;
                            end
                        18:begin
                                SCK = 0;
                                state_reg = 19;
                            end
                        19:begin
                                state_reg = 19;
                            end
                    default: state_reg = 19;
                endcase
            end
        end

    //retrieve previous vlaues
    always @(posedge clk)
    begin
        case(state_reg)
            2: begin
                    if (ampclkreg == 2)             
                        data_out_reg[7] = AMP_DO;
                end
            4: begin
                    if (ampclkreg == 2)
                        data_out_reg[6] = AMP_DO;
                end
            6: begin 
                    if (ampclkreg == 2)
                        data_out_reg[5] = AMP_DO;
                end
            8:  begin
                    if (ampclkreg == 2)
                        data_out_reg[4] = AMP_DO;
                end
            10:begin
                    if (ampclkreg == 2)
                        data_out_reg[3] = AMP_DO;
                end
            12:begin
                    if (ampclkreg == 2)
                        data_out_reg[2] = AMP_DO;
                end
            14:begin
                    if (ampclkreg == 2)
                        data_out_reg[1] = AMP_DO;
                end
            16:begin
                    if (ampclkreg == 2)
                        data_out_reg[0] = AMP_DO;
                end

        endcase
    end

    //output wire [7:0] data_out--to top module to drive 7 LEDs and display state_reg
    assign data_out =  state_reg;

    assign agc_done = (state_reg == 19);
    assign inhibit_ADC = (agc_running == 1);

    endmodule 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-06T16:35:38.140

我在 FPGA 的背景下回答（我对 Xilinx FPGA 最有经验）；我不同意蒂姆的回答。

当 FPGA 被编程和初始化时，*许多*内部资源被初始化为一个已知状态。这包括所有触发器和块 ram。通过在整个设计中添加一揽子重置逻辑，如果您可以依靠内部元素初始化为已知状态，您*可能会使其变得比需要的复杂得多。*高扇出复位网络会使路由器的设计实施变得更加困难，并且将您的设计映射到切片也因您选择的复位而变得复杂 - 尤其是异步复位。

我的建议：

*   为您的寄存器使用初始化值。仔细检查您正在使用的版本的赛灵思 XST 文档以了解支持的语法。与普遍认为的相反，初始化值在大多数情况下都会得到尊重。这样做的另一个好处是芯片的初始状态将与模拟的初始状态相匹配。
*   仅重置必要的控制信号并单独保留数据路径寄存器，以实现更有效的映射（例如，流水线到移位寄存器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T13:50:18.917

> 所以我的问题是，未初始化的寄存器是否应该假定值为 0？

**不**，他们假设 x。对于 Synthesis，您必须重置，因为它们可能持有任何值。我没有 FPGA 经验，但 Nathan Farrington 建议它们也被重置/初始化。

对于 FPGA，执行以下操作就足够了：

```
reg [4:0] state_reg = 'b0, 
```

对于综合，我建议在重置子句中执行此操作。

```
always @(posedge clk or negedge reset) begin
  if (!reset) begin
    state_reg <= 'b0 ;
  end
  else begin
    ..
  end
end 
```

# winapi - win32读取文件

> ID：10033460
> 
> 赞同：0
> 
> 时间：2012-04-05T17:52:55.533
> 
> 标签：winapi, low-memory, retro-computing

我正在用 win32 编写一个老式的 mmorpg（它应该在非常旧的机器上运行），我想读取一个可以是 ASCII 或 Unicode（很少）的文件，并计算其中的行数。由于这些机器的内存非常低，我不能一次在 RAM 中保留超过 4KB。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:55:59.797

一次以小块读取文件，例如内存预算大小的 1/10。计算每个块中的行结束。

您面临的唯一真正问题是您需要处理从一个块的末尾到下一个块的开头的 cr+lf 对。

顺便说一句，您的意思是 4MB 而不是 4KB？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:06:29.387

只是提出一些不同的东西......

```
type foo.txt|find /C /V "~`!@#$%^&*()_+" 
```

或者真的只是以下我认为......已经有一段时间了

```
find /C /V "" foo.txt 
```

# python - 如何将 python 的 difflib.unified_diff 的输出应用到原始字符串？

> ID：10033461
> 
> 赞同：4
> 
> 时间：2012-04-05T17:53:01.147
> 
> 标签：python, diff

因此，使用 Python 的[difflib](http://docs.python.org/library/difflib.html)，我可以生成两个字符串的差异：

```
foo = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit.\n Nullam sed orci lobortis lectus bibendum vehicula.\n Integer iaculis eros porttitor velit porttitor scelerisque.\n Nunc venenatis nibh.'.splitlines()
bar = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit.\n Mauris placerat, odio ut viverra gravida, elit leo tincidunt nisi, a pellentesque velit arcu id magna.\n Integer iaculis eros porttitor velit porttitor scelerisque.\n Nunc venenatis nibh.'.splitlines()

diff = difflib.unified_diff(foo, bar, lineterm='') 
```

然后，如果我们愿意，我们可以检查差异：

```
>>> print '\n'.join(diff)
--- 
+++ 
@@ -1,4 +1,4 @@
 Lorem ipsum dolor sit amet, consectetur adipiscing elit.
- Nullam sed orci lobortis lectus bibendum vehicula.
+ Mauris placerat, odio ut viverra gravida, elit leo tincidunt nisi, a pellentesque velit arcu id magna.
  Integer iaculis eros porttitor velit porttitor scelerisque.
  Nunc venenatis nibh. 
```

这就是我卡住的地方。如何将该差异应用于字符串`foo`以产生字符串`bar`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:02:21.417

如果您使用 ndiff，那么您可以使用 restore 恢复原始字符串

```
>>> diff = difflib.ndiff(foo, bar)
>>> diff = list(diff)
>>> print ''.join(difflib.restore(diff, 2))
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam sed orci lobortis lectus bibendum baculo mihi. Integer iaculis eros porttitor velit porttitor scelerisque. Nunc venenatis nibh.
>>> ''.join(difflib.restore(diff, 2))==''.join(bar)
True
>>> ''.join(difflib.restore(diff, 1))==''.join(foo)
True
>>> 
```

请注意，由于统一差异通常会丢弃比较等于开头的行，因此几乎不可能恢复到原始字符串。ndiff 显示所有内容，因此可以直接恢复原始内容。

# umbraco - Umbraco 4.6：按版本获取节点

> ID：10033462
> 
> 赞同：0
> 
> 时间：2012-04-05T17:53:01.863
> 
> 标签：umbraco

我正在尝试获取已发布节点的先前版本以与当前节点进行比较。我找到了 Document.GetContentFromVersion 但似乎无法在 NodeFactory 中找到等效项或将 Content 转换为 Node 类型的方法。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:52:37.217

NodeFactory 中没有与 Document.GetContentFromVersion 等效的方法，因为 NodeFactory 从 umbraco.config 缓存中获取数据，而 Document 从数据库中提取数据（请参阅[Node 和 Document 之间的区别](http://our.umbraco.org/wiki/reference/api-cheatsheet/difference-between-node-and-document)）。

您可以像使用 Document 或 Node 一样获取 Content 对象的属性：

```
var old = Document.GetContentFromVersion(version);
var oldProperty = old.getProperty("propertyAlias"); 
```

为了比较，节点：

```
var nodeProperty = node.GetProperty("propertyAlias");

if (oldProperty.Value == nodeProperty.Value)
{
    ...
} 
```

文档：

```
var docProperty = node.getProperty("propertyAlias");
if (oldProperty.Value == docProperty.Value)
{
    ...
} 
```

# deployment - Capifony: parse error on build_bootstrap.php

> ID：10033466
> 
> 赞同：0
> 
> 时间：2012-04-05T17:53:26.667
> 
> 标签：deployment, symfony, shared-hosting, capifony

I'm trying to deploy for first time my application to production. For this I want to ue Capifony. I followed Capifony.org instructions but I'm stuck with this error

```
Parse error: syntax error, unexpected T_STRING, expecting T_CONSTANT_ENCAPSED_STRING or '(' in Sensio/Bundle/DistributionBundle/Resources/bin/build_bootstrap.php on line 35
Parse error: syntax error, unexpected T_STRING, expecting T_CONSTANT_ENCAPSED_STRING or '(' in app/console on line 13
Parse error: syntax error, unexpected T_STRING, expecting T_CONSTANT_ENCAPSED_STRING or '(' in app/console on line 13 
```

My hosting provider gives PHP 5.2 as default, but I have access to 5.3 so I need to set up php path on Capifony config.

This is my deploy.rb

```
#Application
set :application, "acme"
set :domain,      "#{application}.com"
set :deploy_to,   "/home/user/public_html/acme"
set :app_path,    "app"

#Repository
set :repository,  "git@bitbucket.org:user/repo.git"
set :scm,         :git
set :deploy_via,  :rsync_with_remote_cache
set :git_enable_submodules, 1 

set :model_manager, "doctrine"

role :web,        domain                         # Your HTTP server, Apache/etc
role :app,        domain                         # This may be the same as your `Web` server
role :db,         domain, :primary => true       # This is where Rails migrations will run

set  :keep_releases,  3

#Symfony2
set :shared_files,      ["app/config/parameters.ini"]
set :shared_children,     [app_path + "/logs", web_path + "/uploads", "vendor"]
set :update_vendors, true
set :dump_assetic_assets, true

#Server connection
set :user, "user"
ssh_options[:forward_agent] = true
ssh_options[:port] = "2222"
set :use_sudo, false

set :php_bin, "/opt/php53/bin/php" 
```

And finally on my development environment I never got those errors.

Edit: Command executed by capifony when error is thrown

```
/opt/php53/bin/php bin/vendors install --reinstall

Symfony    -> 2.0.12
Capifony   -> 2.1.5
Capistrano -> 2.11.2 
```

console line 13: use Symfony\Bundle\FrameworkBundle\Console\Application;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T09:57:17.070

As a workaround, adding PHP 5.3 path at the beginning of the PATH solve this issue.

# javascript - 更改 iframe src 的效果？

> ID：10033478
> 
> 赞同：0
> 
> 时间：2012-04-05T17:54:36.800
> 
> 标签：javascript, html, css

我正在制作一个简单的网络应用程序，我想要导航链接，而不是使用`<a>`标签，而是更改 iframe 的 SRC。发生这种情况时，有没有办法让旧页面“向上滑动”并快速滑出 iframe，然后让新页面加载？如果可能的话，我只想使用 HTML、Javascript 和 CSS。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:19:55.960

在您继续阅读之前，让我问您：您真的需要 iframe 吗？除非确实别无选择，否则您应该避免在网站中加载网站。它很慢，通常会导致跨浏览器出现很多问题。

如果您将其用于导航，那么肯定可以使用 AJAX 来加载新内容吗？或者您可以最初加载所有可能的内容并隐藏所有内容，但只有一个。

顺便说一句，如果你还没有太多经验（如果我有错误的印象，我很抱歉）：不要害怕 AJAX 这个词。它只是一个 Javascript 函数，它允许将数据发送到服务器，然后在加载页面后处理它返回的任何内容。它也称为 XML HTTP 请求。

在任何情况下，诸如 jQuery (http://jquery.com) 或原型 (http://prototypejs.org/) 之类的 Javascript 框架应该会让您的工作变得更轻松。

如果您没有其他选择：

1）执行JS的链接很简单：`<a href="#" onclick="return own_javascript_function();">`或者`<a href="javascript:my_function()">`例如。

2）让您的函数使用新内容创建一个新的 iframe（`var newframe = new HTMLIFrameElement()`然后设置 src 等）并将其插入到前一个 iframe 下方。给它一个较低的 z-index 以将其隐藏在另一个下方。

3) 将 iframe 滑出：使用容器 div`position:relative`将 iframe 与`position:absolute`. 让我们`javascript_function()`使用计时器将 iframe 的 css 属性`top`从 0 更改为 -500（或 iframe 的任何高度）。使用 jQuery 实现这一点特别容易。完成后，删除旧 iframe 并将新 iframe 的 z-index 设置为 1（以避免需要越来越低的 z-indices）。

请记住，您可以`<div>`使用 ajax 将新内容加载到其中来做同样的事情；只要您不从外部域加载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:14:19.887

我想到了两个选择。

如果您不使用 jQuery，我建议您研究一下。

1) 使用口罩。当用户点击链接时，遮罩将淡入页面内容（位置：绝对；顶部：0；左侧：0；宽度：100%；高度：$windowHeight；颜色：#{mask-color}）。淡入完成后，使用新内容重新加载 iframe。然后，淡出面具。

注意：（用 slideUp/slideDown 替换 fadeIn/fadeOut 以获得幻灯片效果，请参阅 jquery 效果：[http](http://api.jquery.com/category/effects/) ://api.jquery.com/category/effects/ ）

消退：

```
$('#elemendId').fadeOut(); 
```

淡入：

```
$('#elemendId').fadeOut(); 
```

我认为默认淡入淡出时间是 500，因此您需要为加载页面的代码设置超时

```
setTimeout(function() { ... load new iframe ... }, 500) 
```

2) 抛弃 iFrame 并对内容执行 AJAX 请求。就像是

```
$.post('path/to/file.html', function(data) {
 $('#destination-div').html(data)
}); 
```

更容易，你可能不会遇到那么多问题。

编辑：我实际上不确定方法＃1是否有效......我忘记了你是否可以在 iframe 上放置一个遮罩

# c# - 使用 SQL Server CE 的 SaveChanges() 上的 System.Data.UpdateException

> ID：10033485
> 
> 赞同：0
> 
> 时间：2012-04-05T17:54:55.490
> 
> 标签：c#, .net, sql-server-ce, ado.net-entity-data-model

我正在创建一个使用 SQL Server CE 3.5 作为其数据存储的基于 Entity Framework 4 的应用程序。

我有一个使用从实体数据模型创建的脚本生成的空`.sdf`文件。`.sqlce`

当我运行此代码时：

```
Item item = new Item();
item.ID = 1;
item.Title = "example";
item.Value = 37;

using (ModelContainer context = new ModelContainer())
{
    context.ItemsSet.AddObject(item);

    context.SaveChanges();
} 
```

在`SaveChages()`我得到这个`System.Data.UpdateException`：

> SQL Server Compact 不支持服务器生成的键和服务器生成的值。

从[这个问题](https://stackoverflow.com/questions/2479896/objectcontext-savechanges-fails-with-sql-ce)我知道，当与实体框架一起使用时，SQL Server CE 3.5 不支持自动生成的主键。但是，在我的情况下，我明确设置了要添加的项目的 ID 属性。

还有什么问题吗？

**编辑：**

这是`.sqlce`删除后我的脚本的内容`IDENTITY(1,1)`：

```
-- Creating table 'ItemsSet'
CREATE TABLE [ItemsSet] (
    [ID] int NOT NULL,
    [Title] nvarchar(4000)  NOT NULL,
    [Value] int NULL
);
GO

-- Creating primary key on [ID] in table 'ItemsSet'
ALTER TABLE [ItemsSet]
ADD CONSTRAINT [PK_ItemsSet]
    PRIMARY KEY ([ID] );
GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:28:37.277

如果您已将其设置为在数据库中自动递增，则从代码中显式设置 ID 不会做任何事情。您可以使用 uniqueidentifier 或修改表中的主键并删除自动增量。然后您就可以将 Id 设置为代码中的值。查看此线程[SQL Server Compact 不支持服务器生成的键和服务器生成的值](https://stackoverflow.com/questions/648449/server-generated-keys-and-server-generated-values-are-not-supported-by-sql-serve)

# php - 如何将一个类关闭到另一个文件中

> ID：10033497
> 
> 赞同：0
> 
> 时间：2012-04-05T17:55:24.477
> 
> 标签：php, class

我有一个非常大的单个类文件，我想打破这个太大的类并将它的代码分布在多个文件中，但**不**使用扩展方法，因为我只想对这个类使用相同的对象例如：

文件一：

```
class name {

    public function admin_logout(){

    if(isset($_SESSION['wcddl_admin'])) {
        unset($_SESSION['wcddl_admin']);
            session_destroy();
            header("Location:index.php");
  }

} 
```

文件 b：

```
include("a.php");

 } 
```

我尝试了类似的方法，但没有用

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T21:12:33.603

您不能创建语法无效的 php 文件。但是您可以为每种方法包含一个文件。

```
class name {
    public function admin_logout(){
        include('methods/admin_logout.php');
    }
    public function mymethod(){
        include('methods/mymethod.php');
    }
} 
```

或者您可以使用魔术方法 __call 构建一个类

```
class name {
    public function __call($name, $arguments){
        include('methods/'.$name.'.php');
    }
} 
```

但是，如果您被迫做类似的事情，也许您应该改变项目的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T20:54:50.953

您不能在 php.ini 文件中本地拆分一个类。我想您可以做一些花哨的事情，例如动态构建文件然后加载它，但这会很痛苦。

对于您的高级课程，您可以为普通用户创建一个基类，然后将其扩展为高级课程。但很可能你想在一门课上放太多东西。

您可能想开始另一个问题并描述您要解决的问题。

# visual-studio - Visual Studio - 管理不同的项目版本

> ID：10033503
> 
> 赞同：0
> 
> 时间：2012-04-05T17:55:45.227
> 
> 标签：visual-studio

管理我的 VS 项目的不同版本的最佳方法是什么。这是一个普遍的问题，因为我经常发现自己创建了一个项目文件夹的完整副本，以便在代码中尝试一些不同的东西，而不是冒险搞砸。

我想保存我的项目的状态，包括我编译的任何 dll。切换到项目的不同“版本”并进行更改，重新编译 .. 并能够访问两个 dll（我想它们的命名略有不同），并通过“switchign”访问两个版本中的代码状态“对它......除了复制整个项目之外，还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:58:14.300

你需要一个版本控制系统。许多支持本地分支的分布式版本控制系统（即 Git、Mercurial 等）之一将使您的场景只需几个命令即可。

Stack Overflow 上有很多关于版本控制系统的问题：[https ://stackoverflow.com/questions/tagged/version-control?sort=votes](https://stackoverflow.com/questions/tagged/version-control?sort=votes)

# mysql - 如何提高选择操作的执行速度

> ID：10033507
> 
> 赞同：0
> 
> 时间：2012-04-05T17:56:04.930
> 
> 标签：mysql, sql

```
create table foo (id int(11) auto_increment, value varchar(255)) 
```

该表包含大约 10,00,000 行，并且选择操作（例如 select id、来自 foo 的值）大约需要 2-3 秒才能执行，我该如何提高这里的速度

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:04:32.203

select id, value from foo 将返回整个表。您提到的 2-3 秒可能包括传输结果所需的时间。这通常比数据库服务器执行实际查询花费的时间要长得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:16:37.473

如果没有 WHERE 子句（如您发布的查询）并且您正在选择一百万行，那么很有可能不是查询需要 2-3 秒来执行它实际上是花时间来发送数据网络。

您的应用程序实际上可以一次使用一百万条数据库记录吗？如果您向用户显示该数据，那么您可能会对其进行分页，因此请更改您的查询以选择更易于管理的块中的数据。

```
SELECT id, value 
FROM foo
LIMIT $offset, $pgsize -- these two values will come from your application 
```

如果您真的，真的需要一次所有这些行，那么我建议您缓存它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:58:28.183

为 where 子句中使用的字段添加索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:03:39.480

```
CREATE INDEX id_index ON foo (id) USING BTREE; 
```

[您可以在http://dev.mysql.com/doc/refman/5.0/en/create-index.html](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)看到更多信息

# java - 双重类型铸造一个令牌

> ID：10033510
> 
> 赞同：1
> 
> 时间：2012-04-05T17:56:11.380
> 
> 标签：java, casting, binary

试图理解这个代码片段的数学。提供的令牌始终为 8 位数字。它进入一个类型为 long 的类。令牌被分解成单独的字节以通过流发送。

```
long token = 85838276; 

byte cp[] = {
            1, 0, 0, 0, 0
            };

cp[4] = (byte)(int)token; // not sure what would become of token
cp[3] = (byte)(int)(token >> 8);   
cp[2] = (byte)(int)(token >> 16);  
cp[1] = (byte)(int)(token >> 24); 
```

我理解类型转换 (byte) 部分，但没有 (byte)(int) 在一起。long 类型的令牌是否必须一次降级一种简单类型？你不能省略 (int) 并得到相同的结果吗？

顺序是重要的还是只是为了清楚起见从 cp[4] 写到 cp[1] 。我意识到 cp[4] 中的令牌将不等于原始值，因为字节类型可以容纳的最大值是 127。一旦到达目的地，是否可以重新创建原始令牌？

最后我想在 php.ini 中重新创建它。我知道一个字符串已经是一个字节流。发送的每个字符都是一个字节。我是否需要发送一个字符串，每个字符都等于它所代表的整数值。比如一个for 41

更新：所以根据 Louis Wasserman 的回答，当类型转换为字节时，只保留最后一个字节。

```
Token  in binary: 101000111011100100111000100 // cp[4] = 11000100

Token shifted 08: 1010001110111001001 // cp[3] = 11001001

Token shifted 16: 10100011101 // cp[2] = 00011101

Token shifted 24: 101 // cp[1] = 101 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:57:34.053

据我所知，`(byte) (int)`相当于`(byte)`在这种情况下。

并非所有双重演员都是如此，但在这里似乎是正确的。他们都是“缩小”演员转换。

# php - 带有对象的 PHP 内存取消设置数组

> ID：10033516
> 
> 赞同：1
> 
> 时间：2012-04-05T17:56:34.203
> 
> 标签：php

**测试一：**

```
class Entity { }

$entities = array();
echo "START: ". number_format(memory_get_usage()) . "\n";
for($i = 0; $i < 100000; ++$i)
{
    $entities[] = new Entity();
}
echo "BEFORE UNSET: ". number_format(memory_get_usage()) . "\n";
unset($entities);
echo "AFTER UNSET: ". number_format(memory_get_usage()) . "\n"; 
```

输出：

```
START: 631,664
BEFORE UNSET:44,404,904
AFTER UNSET: 8,954,568 
```

* * *

**测试二：**

```
class Entity { }

$entities = array();
echo "START: ". number_format(memory_get_usage()) . "\n";
for($i = 0; $i < 100000; ++$i)
{
    $entity = new Entity();
    $entities[] = &$entity;
}
echo "BEFORE UNSET: ". number_format(memory_get_usage()) . "\n";
unset($entities);
echo "AFTER UNSET: ". number_format(memory_get_usage()) . "\n"; 
```

输出：

```
START: 631,664
BEFORE UNSET: 10,480,480
AFTER UNSET: 631,752 
```

在我遇到内存限制问题后，我玩了一下......

所以在那之后我想知道垃圾收集是如何工作的：

1.  为什么测试**一比测试****二**需要更多的内存？
2.  **为什么在测试一**中取消设置数组后 php 会保留内存？

谢谢戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:59:39.007

1.  第一个是您将实际对象保存到数组中的每个值，因此当您取消设置数组时，这些对象仍然存在。
    *   这就是这个数组占用更多内存的原因——它存储的是**实际对象**
2.  第二个，您只是保存对对象的引用（仅在 for 循环的范围内），一旦未设置，对象就消失了。

    *   这个数组占用*内存少*的原因是它只存储对对象的**引用。**

因此，如果您执行此处的操作：

```
$entities = array();
echo "START: ". number_format(memory_get_usage()) . "\n";
for($i = 0; $i < 100000; ++$i)
{
    $entities[] = new Entity;
}
echo "BEFORE UNSET: ". number_format(memory_get_usage()) . "\n";
foreach($entities as &$entity) {
    unset($entity);
}
unset($entities);
echo "AFTER UNSET: ". number_format(memory_get_usage()) . "\n"; 
```

并且您取消设置数组中的每个对象。您得到与第二次尝试相同的结果：

例子：

> 开始：3,237,720 未设置
> 前：21,297,640 未设置
> 后：3,237,488

演示：[http ://codepad.org/oUjzA46D](http://codepad.org/oUjzA46D)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:45:07.663

> 为什么测试一比测试二需要更多的内存？

**PHP 为存储标识符分配的内存比为引用分配的内存多**（您的第一个测试按标识符分配）。

从[手册](http://php.net/manual/en/language.oop5.references.php)：

> PHP 引用是一个别名，它允许两个不同的变量写入相同的值。从 PHP 5 开始，对象变量不再包含对象本身作为值。它只包含一个对象标识符，允许对象访问者找到实际对象。当一个对象通过参数发送、返回或分配给另一个变量时，不同的变量不是别名：它们持有标识符的副本，它指向同一个对象。

这使得标识符有些神奇，并且它们是经过特殊处理的。

> 为什么在测试一中取消设置数组后php会保留内存？

`unset`仅仅标记一个变量的内存，供 GC 算法释放；它不会立即释放内存。当我运行您的第一个测试时，会释放大量内存（尽管没有第二个测试那么多，可能是由于分配了更大的大小）。

# xml - 使用 XSLT 计算计算列的总计

> ID：10033518
> 
> 赞同：0
> 
> 时间：2012-04-05T17:56:40.883
> 
> 标签：xml, xslt, itunes

我今天刚学习 XSLT，当时我想从 iTunes 中漂亮地打印播放列表导出 (xml)。我终于明白了 XSLT 与 XML 的关系以及它的用途。我从 [iTunes2Html](http://www.greeley.org/~hod/dj/iTunes.html "iTunes2Html")中获取了代码，并为我自己的目的对其进行了定制。我创建了一个动态列，它是歌曲的播放时间/持续时间（对于设置开始和结束时间的人/djs 很有用！）。在显示结束时我想要的是所有持续时间列的总和。我不知道该怎么做。到目前为止，我已经研究了堆栈溢出和谷歌，但没有运气。我发现的结果令人困惑。

那么任何人都可以帮我弄清楚如何计算动态/计算列的总数吗？看到[类似的问题](http://www.stylusstudio.com/xsllist/200002/post40910.html "十年前的类似问题")

这是 XSLT 的相关部分

```
<td> <!-- calculating duration : formattime(end | total - start | 0), is there a simpler way to do it? -->
<xsl:variable name="totduration">
 <xsl:choose>
    <xsl:when test="string(number(following-sibling::Start_Time))='NaN'">
        <xsl:value-of select="following-sibling::Stop_Time"/>
    </xsl:when>
    <xsl:when test="string(number(following-sibling::Stop_Time))='NaN'">
        <xsl:value-of  select="number(following-sibling::Total_Time) - number(following-sibling::Start_Time)"/>
    </xsl:when>          
    <xsl:otherwise>
        <xsl:value-of  select="number(following-sibling::Stop_Time) - number(following-sibling::Start_Time)"/>
    </xsl:otherwise>
  </xsl:choose>
</xsl:variable>
<!-- for the javascript approach using jquery. didn't work -->
<span class="sumData" style="display:none"> <xsl:value-of select="$totduration"/></span> 
<xsl:call-template name="formatTime">
  <xsl:with-param name="t" select="$totduration"/>
</xsl:call-template>
</td> 
```

编辑：澄清持续时间计算的逻辑。由于 start 和 stop 是可选的，因此实际公式为 (stop | total) - (start | 0)。这意味着如果两者都不存在，则持续时间与长度相同，即它从头到尾播放！每首歌都有这个属性。但是，即使定义了一个节点（开始或停止），则持续时间可能与歌曲的总长度不同。

一些示例 XML

```
 <songlist>
<song>
  <Track_ID>169</Track_ID>
  <Name>AAAAA</Name>
  <Album>AAAAA</Album>
  <Genre>AAAAA</Genre>
  <Start_Time>78000</Start_Time>
  <Stop_Time>122000</Stop_Time>
  <Total_Time>357537</Total_Time>
</song>
<song>
  <Track_ID>174</Track_ID>
  <Name>BBBBBB</Name>
  <Artist>BBBBBB</Artist>
  <Album>BBBBBB</Album>
  <Genre>BBBBBB</Genre>
  <Stop_Time>120000</Stop_Time>
  <Total_Time>275043</Total_Time>
</song>
<song>
  <Track_ID>177</Track_ID>
  <Name>CCCCCC</Name>
  <Artist>CCCCCC</Artist>
  <Album>CCCCCC</Album>
  <Genre>CCCCCC</Genre>
  <Stop_Time>62000</Stop_Time>
  <Total_Time>287738</Total_Time>
</song>
<song>
  <Track_ID>180</Track_ID>
  <Name>DDDDDDD</Name>
  <Artist>DDDDDDD</Artist>
  <Album>DDDDDDD</Album>
  <Genre>DDDDDDD</Genre>
  <Start_Time>43000</Start_Time>
  <Total_Time>400274</Total_Time>
</song> 
```

这是输出 ![截屏](../Images/68a0c95e71f5b9efa3dec9337dfb7787.png)

将出现在持续时间列底部的所需输出（即所有持续时间的总和）：

```
Total Playtime Duration - 9:43 
```

还有更好的方法（如上所示）在 xslt 中执行此公式吗？我目前正在使用`xsl:choose`检查 NaN 并相应地使用替代方法。我不禁认为必须有更好的方法。

```
formattime((stop | total) - (start | 0)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T11:06:53.320

这应该会给你你正在寻找的东西：

```
<xsl:variable name="total" select="
  sum(song[Stop_Time &gt; 0]/Stop_Time | song[not(Stop_Time &gt; 0)]/Total_Time)
  -
  sum(song/Start_Time)
" /> 
```

对于您的 XML 示例，它的计算结果为`583274`，即`9m, 43s`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:16:05.060

使用 xpath 函数[sum](http://www.w3schools.com/xpath/xpath_functions.asp)并使用表达式选择要求和的所有节点。例如

```
<xsl:value-of select="sum(/my/node)"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T03:16:34.507

```
<xsl:variable name="totalduration" select="
  sum($songs/song[Stop_Time > 0]/Stop_Time | $songs/song[not(Stop_Time > 0)]/Total_Time )
  -
  sum($songs/song/Start_Time)
" />
<p> Total Duration for playlist:   
  <xsl:call-template name="formatTime">
    <xsl:with-param name="t" select="$totalduration"/>
  </xsl:call-template>
</p> 
```

感谢@tomalak，这是我最终使用的最终代码。我把它放在这里以供将来参考。

# php - Iphone 应用程序的 PHP sql 时间戳

> ID：10033529
> 
> 赞同：-2
> 
> 时间：2012-04-05T17:57:24.733
> 
> 标签：php, iphone, sql, timestamp

我怎么能像 Twitter 和 Facebook 那样做呢。

*   如果帖子是在 1 小时内发布的 - 显示几分钟前。（即：5 分钟前、39 分钟前等）
*   如果帖子是在 1 小时前但不到 24 小时前发布的，请显示多少小时（即：2 小时前、7 小时前、22 小时前）
*   如果发帖时间超过 24 小时，请显示发帖天数（3 天前、8 天前、18 天前等）

我怎样才能使用 php 和 sql 来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:26:18.107

最简单的解决方案是使用`DateTime:diff()`

[http://www.php.net/manual/en/datetime.diff.php](http://www.php.net/manual/en/datetime.diff.php)

将当前的 time() 与数据库日期进行比较。

# java - Java：在 Graphics 中使用 setClip 会更有效吗？

> ID：10033534
> 
> 赞同：4
> 
> 时间：2012-04-05T17:57:54.827
> 
> 标签：java, image, clip

我的屏幕外`BufferedImage`太大，无法一次全部显示。所以我`getSubimage`用来绘制整个图像的一部分。我想知道使用`setClip`on 是否`Graphics`会使用更少的资源。文档说“渲染操作在剪切区域之外没有影响”。如果我使用剪辑与不使用剪辑会有多大区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T22:51:14.050

当您在`Graphics`对象上设置剪辑（例如 a `Rectangle(0, 0, 100, 100)`），然后使用相同的`Graphics`对象绘制图像（例如大小为 300x300 的图像）时，将省略位于剪辑之外的图像部分。只会绘制示例的左上角 100x100 角。

这样做的主要优点是，它大大加快了绘图**过程**。我不太确定它是*如何*让它更快的；事实上，我现在正在查找这个。

无论如何，我发现这在设计全屏游戏时非常方便。您制作的剪辑绘制到屏幕上的效率越高，您的游戏运行就越流畅。当一段时间内没有更新屏幕组件时，剪辑保持空白，不绘制任何内容并为游戏逻辑留下资源。

# regex - 寻找更简洁的 RegEx 解决方案来匹配 SSN 的不同格式

> ID：10033537
> 
> 赞同：1
> 
> 时间：2012-04-05T17:58:08.457
> 
> 标签：regex

要查看我想要的内容，请查看我正在使用的正则表达式。我会尽量用英文解释。我想匹配`4444`or`444444444`或`444-44-4444`。这就是我所拥有的，它可以满足我的需求。

```
^[0-9]{9}$|^[0-9]{4}$|^[0-9]{3}-[0-9]{2}-[0-9]{4}$ 
```

没有 OR 有没有办法做到这一点？我想过这样做

```
([0-9]{3}-?[0-9]{2}-?)?[0-9]{4} 
```

但这允许`222-222222`我想排除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:02:00.200

您应该能够使用反向引用来做到这一点：

```
^(?:\d{3}(-?)\d{2}\1)?\d{4}$ 
```

如果 a`-`存在，它会被捕获并且可以用 来引用`\1`。如果它不存在，`\1`将只是空的。所以它本质上意味着：如果`-`在那个位置，它也必须在另一个位置。

[**演示**](http://regexpal.com/?flags=m&regex=%5E%28?%3a%5B0-9%5D%7B3%7D%28-%29?%5B0-9%5D%7B2%7D%5C1%29?%5B0-9%5D%7B4%7D%24&input=4444%0A444444444%0A444-44-4444%0A222-222222%0A22222-2222)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:17:05.087

标记为实际答案的模式失败，因为它与有效 SSN 号码的美国规范不匹配！

[使用匹配无效器，此模式有效，并根据政府规范社会安全号码随机化](http://www.ssa.gov/employer/randomization.html)抛出 000 和 666 或以 9xx 开头的数字

```
# To use this regex pattern specify IgnoreWhiteSpace due to these comments.
^                           # Beginning of line anchor      
(?!9)                       # Can't be 900- 999                                   
(?!000)                     # If it starts with 000 its bad (STOP MATCH!)
(?!666)                     # If it starts with 666 its bad (STOP MATCH!)
(?<FIRST>\d{3})             # Match the First three digits and place into First named capture group
(?:[\s\-]?)                 # Match but don't capture a possible space or dash
(?<SECOND>\d\d)             # Match next two digits
(?:[\s-]?)                  # Match but don't capture a possible space or dash
(?<THIRD>\d{4})             # Match the final for digits
$                           # EOL anchor 
```

我在我的博客文章[.Net 中的正则表达式 (Regex) 匹配无效器 (?!) 中](http://omegacoder.com/?p=30)描述了匹配无效器的使用。

# html - 将包含三个连续 div 的 div 浮动在内容 div 上

> ID：10033543
> 
> 赞同：0
> 
> 时间：2012-04-05T17:58:33.593
> 
> 标签：html, css

在一个容器中有三个 div，我想漂浮在一个大 div 上。我该怎么做呢？到目前为止我有这个...

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head>
<style type="text/css">
<!--

div.HeaderContainer { float:left; }
div.One {  float:left; border: 1px solid; }
div.Two {  float:left;} 
div.Three {  float:left; border: 1px solid; } 
div.Content{ float:none; }

-->
</style>
</head>
<body>

<div class = "HeaderContainer">
    <div class="One">one</div>
    <div class="Two" id="tdAmplicon">two</div>
    <div class="Three">three</div>
</div>
<div class="Content" >content</div>

</body>
</html> 
```

但是，这只会将内容 div 放在 HeaderContainer div 的左侧。如何使内容 div 浮动在 HeaderContainer div 下方？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:01:46.783

```
div.Content { clear: both; } 
```

将内容 div 放在下面`HeaderContainer`

[http://jsfiddle.net/ZDE6C/](http://jsfiddle.net/ZDE6C/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:11:20.647

或者，您可以将`float:left;`on替换`div.HeaderContainer`为`overflow:hidden;`：

```
div.HeaderContainer { overflow: hidden; } 
```

[http://jsfiddle.net/ZDE6C/1/](http://jsfiddle.net/ZDE6C/1/)

# c# - WPF 窗口关闭事件用法

> ID：10033551
> 
> 赞同：4
> 
> 时间：2012-04-05T17:58:53.453
> 
> 标签：c#, wpf, events

我有一个`Window`类（例如`public partial class Foo : Window`），当我创建窗口时，我就这样注册了该`Closed`事件。

```
foo = new Foo();
foo.Closed += FooClosed;

public void FooClosed(object sender, System.EventArgs e)
{
} 
```

当有人按下`foo`窗口内的按钮时，我打电话`this.Close()`但我的`FooClosed`似乎没有被调用。

我是否错误地注册了该活动？

**更新**

顺便说一句，我想要完成的只是*知道*何时`foo`关闭，因此我可以将引用设置回`null`. 有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T18:04:09.823

几天前回答了问题检查[WPF 关闭时执行代码](https://stackoverflow.com/questions/10018308/execute-code-when-a-wpf-closes/10018412#10018412)

您的代码可能有问题，因为这对我来说很好。

主窗口.xaml.cs

```
namespace WpfApplication1
{

    public partial class MainWindow : Window
    {
        private Foo foo;

        public MainWindow()
        {
            InitializeComponent();

            foo = new Foo();
            foo.Closed += FooClosed;
            foo.Show();
        }

        public void FooClosed(object sender, System.EventArgs e)
        {
            //This gets fired off
            foo = null;
        }

    }
} 
```

Foo.xaml

```
<Window x:Class="WpfApplication1.Foo"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Foo" Height="300" Width="300">
    <Grid>
        <Button Click="Button_Click">Close</Button>
    </Grid>
</Window> 
```

Foo.xaml.cs

```
namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for Foo.xaml
    /// </summary>
    public partial class Foo : Window
    {
        public Foo()
        {
            InitializeComponent();
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            this.Close();
        }
    }
} 
```

# jsp - 将 JSP 变量作为参数传递给 javascript 函数

> ID：10033555
> 
> 赞同：8
> 
> 时间：2012-04-05T17:59:04.373
> 
> 标签：jsp

我在 head 的脚本标记中定义了一个函数。（在 JSP 中）我想在 JSP 中声明一个字符串变量并将其作为参数传递给该函数

```
<%  String uname ="multiple"; %>
<form action="ExampleServlet" method="post" onclick="pagetype(${uname});"><br>
    <input type="submit" name="Log in" value="Login" />
</form> 
```

但这不起作用。需要帮忙

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-05T18:03:31.380

你必须像这样使用

```
<% String uname ="multiple"; %>
<form action="ExampleServlet" method="post" onclick="pagetype('<%=uname%>');"><br>
    <input type="submit" name="Log in" value="Login" />
</form> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-09-25T16:45:00.233

如果你想避免 scriplet，你可以通过将它放在单引号之间来使用表达式语言。

```
onclick="pagetype('${uname}')"; 
```

如果没有引号，它会尝试查找名称与 uname 的值相同的变量。

PS：使用 chrome/firefox dev-tools 调试来找出问题所在。

# ruby-on-rails - Ruby on Rails - 将输出打印到缓冲区

> ID：10033559
> 
> 赞同：0
> 
> 时间：2012-04-05T17:59:21.460
> 
> 标签：ruby-on-rails, ruby, buffer, helper

我有一个返回一个大 HTML 字符串的大方法。这是非常无效的，并且浏览器需要很长时间才能一次加载所有 HTML。我的问题是：Ruby on Rails 是否有办法将部分 HTML 打印到缓冲区，所以它不会一次全部完成？

这就是我的意思：

```
module TestHelper
    def my_method
        output = ""
        output += "<div>"
        output += "<span>Test</span>"
        output += "</div>"
        return output
    end
end 
```

但我想知道我是否可以这样做：

```
module TestHelper
    def my_method
        print_to_page "<div>"
        print_to_page "<span>Test</span>"
        print_to_page "</div>"
    end
end 
```

我的问题*不*在于如何以不同的方式或“正确”的方式来做，我这样做是有原因的。我已经在网上搜索并阅读了相关信息，`with_output_buffer`但我不知道它是如何工作的。有什么建议么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-05T19:46:46.623

更高版本的 rails 支持[流式传输](http://api.rubyonrails.org/classes/ActionController/Streaming.html)，这有效地为您提供所需的内容。

但！请注意，您所要求的就是您所需要的。使用[firebug](http://www.google.com/url?sa=t&rct=j&q=firebug&source=web&cd=1&ved=0CDQQFjAA&url=http://getfirebug.com/&ei=TPV9T7jvKaWhiAfaz8ztDQ&usg=AFQjCNGT1rhhsYGPQx5Vr5A8RvhIgdSp9g)的 net 选项卡查看页面加载需要多长时间，以及时间花在了哪里。如果浏览器花费特别长时间等待获取任何页面数据，那么流式传输可能会对您有所帮助。但是，请记住，要使用流式处理，您的代码还必须能够以块的形式生成 HTML 页面。这可能比你想象的要难——比如

```
<%= table_tag { render_huge_table } %> 
```

不能使用。

# sse - 我在哪里可以找到 AMD FMA 4 内在函数的参考资料？

> ID：10033562
> 
> 赞同：4
> 
> 时间：2012-04-05T17:59:37.680
> 
> 标签：sse, simd, avx, amd-processor, fma

我正在尝试修改一段使用 SSE（128 位）调用的代码，以使用 Bulldozer Opteron 上的 256 位 FMA 功能。我似乎无法找到这些调用的内在函数。

这个论坛上的一些问题使用了这些内在函数（例如： [如何在 256 位 AVX 向量中找到水平最大值](https://stackoverflow.com/questions/9795529/how-to-find-the-horizontal-maximum-in-a-256-bit-avx-vector)）

我发现了这个：http: [//msdn.microsoft.com/en-us/library/gg445140.aspx](http://msdn.microsoft.com/en-us/library/gg445140.aspx)
和[http://software.intel.com/sites/products/documentation/studio/composer/en-us/2011/ compiler_c/index.htm#intref_cls/common/intref_avx_fmadd_ps.htm](http://software.intel.com/sites/products/documentation/studio/composer/en-us/2011/compiler_c/index.htm#intref_cls/common/intref_avx_fmadd_ps.htm)

但我似乎无法在 AMD 开发人员文档中找到任何内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T11:52:25.080

您可以在文件中找到内在函数`fma4intrin.h`。这是该文件中的 256 位指令，其中一些功能属性被剥离。这些`__buitin*`函数发出 FMA 指令，这是它们名称的一部分。所以如果你想找到一个内在的函数名，你需要`__builtin_instructionname`在返回后查找正确的并使用周围的函数包装器。

```
/* 256b Floating point multiply/add type instructions.  */
_mm256_macc_ps (__m256 __A, __m256 __B, __m256 __C)
{
  return (__m256) __builtin_ia32_vfmaddps256 ((__v8sf)__A, (__v8sf)__B, (__v8sf)__C);
}

_mm256_macc_pd (__m256d __A, __m256d __B, __m256d __C)
{
  return (__m256d) __builtin_ia32_vfmaddpd256 ((__v4df)__A, (__v4df)__B, (__v4df)__C);
}

_mm256_msub_ps (__m256 __A, __m256 __B, __m256 __C)
{
  return (__m256) __builtin_ia32_vfmaddps256 ((__v8sf)__A, (__v8sf)__B, -(__v8sf)__C);
}

_mm256_msub_pd (__m256d __A, __m256d __B, __m256d __C)
{
  return (__m256d) __builtin_ia32_vfmaddpd256 ((__v4df)__A, (__v4df)__B, -(__v4df)__C);
}

_mm256_nmacc_ps (__m256 __A, __m256 __B, __m256 __C)
{
  return (__m256) __builtin_ia32_vfmaddps256 (-(__v8sf)__A, (__v8sf)__B, (__v8sf)__C);
}

_mm256_nmacc_pd (__m256d __A, __m256d __B, __m256d __C)
{
  return (__m256d) __builtin_ia32_vfmaddpd256 (-(__v4df)__A, (__v4df)__B, (__v4df)__C);
}

_mm256_nmsub_ps (__m256 __A, __m256 __B, __m256 __C)
{
  return (__m256) __builtin_ia32_vfmaddps256 (-(__v8sf)__A, (__v8sf)__B, -(__v8sf)__C);
}

_mm256_nmsub_pd (__m256d __A, __m256d __B, __m256d __C)
{
  return (__m256d) __builtin_ia32_vfmaddpd256 (-(__v4df)__A, (__v4df)__B, -(__v4df)__C);
}

_mm256_maddsub_ps (__m256 __A, __m256 __B, __m256 __C)
{
  return (__m256) __builtin_ia32_vfmaddsubps256 ((__v8sf)__A, (__v8sf)__B, (__v8sf)__C);
}

_mm256_maddsub_pd (__m256d __A, __m256d __B, __m256d __C)
{
  return (__m256d) __builtin_ia32_vfmaddsubpd256 ((__v4df)__A, (__v4df)__B, (__v4df)__C);
}

_mm256_msubadd_ps (__m256 __A, __m256 __B, __m256 __C)
{
  return (__m256) __builtin_ia32_vfmaddsubps256 ((__v8sf)__A, (__v8sf)__B, -(__v8sf)__C);
}

_mm256_msubadd_pd (__m256d __A, __m256d __B, __m256d __C)
{
  return (__m256d) __builtin_ia32_vfmaddsubpd256 ((__v4df)__A, (__v4df)__B, -(__v4df)__C);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T11:40:01.977

您可能需要此文档[http://support.amd.com/TechDocs/43479.pdf](http://support.amd.com/TechDocs/43479.pdf)。它包含所有 XOP 和 FMA4 内在函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-24T09:38:35.927

只是为了完成 - 对于上述标题的 Microsoft 版本，请使用：

```
#include <immintrin.h> 
```

# jquery - 使用 jquery 在窗口中定位元素

> ID：10033566
> 
> 赞同：0
> 
> 时间：2012-04-05T17:59:57.293
> 
> 标签：jquery, offset

```
var wdt = document.body.offsetWidth/2.6

var hgt = document.body.offsetHeight/4

$("#element").offset({left:wdt, top:hgt}) 
```

我想要做的是相对于身体定位图像（#element）..即相对于窗口的中心......对于不同的浏览器/窗口大小/屏幕......无论任何屏幕。

这是有效的..还是还有更多..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:01:02.863

```
$("#element").css({left:50%, top:50%}); 
```

或者

```
$("#element").css({left:window.innerWidth/2.6, top:window.innerHeight/4}); 
```

应该这样做。或者更好的是，在您的 CSS 文件中：

```
#element {
    left:50%;
    top:50%;
} 
```

请注意，这将根据左上角定位您的元素，因此它不会出现在确切的中心。为了解决这个问题，您可以这样做（保留上面的 CSS）：

```
$("#element").offset({
    left:-$(this).css("width")/2,
    top:-$(this).css("height")/2
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:02:21.990

使用 jQuery

```
$("img").css({
  top: ($(window).height()-$("img").height())/2,
  margin: '0 auto'
}); 
```

# c++ - C++ 集合迭代器移除

> ID：10033567
> 
> 赞同：9
> 
> 时间：2012-04-05T18:00:05.687
> 
> 标签：c++, stl, set

是否允许擦除迭代器指向的元素，并在一行中推进相同的迭代器以转到下一个元素？

```
set<int>::iterator it = S.begin();
while (it != S.end()) {
    if (shouldBeRemoved(*it)) {
        S.erase(it++); // is this line valid?
    } else {
        ++it;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T18:03:45.097

> **是否允许擦除迭代器指向的元素，并在一行中推进相同的迭代器以转到下一个元素？**

是的，它是有效的。

* * *

**理由：**

`it++`递增`it`，以便它引用下一个元素但产生其原始值的副本。因此，`it`不指`erase()`调用时删除的元素。如果`std::set`只有被擦除元素的迭代器无效。^(#1)

您可以将此代码示例视为样板代码，以删除迭代器所引用的元素。

* * *

**参考：**

对于`std::set`，
^(#1) **C++03 标准 23.1.2/8：**

> 只有迭代器和对已擦除元素的引用无效

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:04:00.237

是的，它是有效的。表达式`it++`在调用函数之前被完全评估，因此函数接收 的先前值`it`，但在被删除（和无效）时，迭代器已经递增。

# android - Android上BlueoothChat程序中的干扰消息

> ID：10033568
> 
> 赞同：0
> 
> 时间：2012-04-05T18:00:20.883
> 
> 标签：android, bluetooth

我目前正在使用 android 设备上的示例 BluetoothChat 程序开发我的程序。这是您可以参考的网站：http: [//developer.android.com/resources/samples/BluetoothChat/src/com/example/android/BluetoothChat/index.html](http://developer.android.com/resources/samples/BluetoothChat/src/com/example/android/BluetoothChat/index.html)

基于某些原因，我想继续向接收者发送消息。因此，我在 BluetoothChat 类中名为 sendMessage() 的方法上执行此操作。

```
byte[] send = message.getBytes(); 
for(int i = 0; i < 5; i++)  //simply add a while loop here
mChatService.write(send); 
```

有时，消息会相互干扰。例如消息是 1234。所以接收者应该收到五个单独的消息。但是，接收方可能会收到 4 条消息，其中一条消息是 12341234。模式不是唯一的。有时接收者 3 消息与两条消息是 12341234。有时它运行完美，接收五个单独的消息。

我不知道哪个（发送者或接收者或两者）有问题。如何解决这样的问题？非常感谢~

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T20:27:49.100

您似乎假设写入和读取之间存在一对一的对应关系。通常它确实以这种方式工作，但不能保证 - 你看到的奇怪行为实际上是典型的。

因此，您有责任将（通过您的 socket.read）接收到的数据分解为消息。

通常你会使用固定长度的消息，或者你会在消息头中包含消息的长度。使用固定长度的消息确实可以简化事情，但通常不够灵活。

# ruby-on-rails - 前置输入标签（simple_form + bootstrap-sass）关闭了几个像素

> ID：10033572
> 
> 赞同：4
> 
> 时间：2012-04-05T18:00:31.383
> 
> 标签：ruby-on-rails, twitter-bootstrap, simple-form

我想使用这里看到的文本输入字段：

[http://simple-form-b​​ootstrap.plataformatec.com.br/articles/new](http://simple-form-bootstrap.plataformatec.com.br/articles/new)

（这是该页面上的第二个文本输入字段。）

我让它在其他 Rails 应用程序中工作，但由于某种原因，在我当前的应用程序中，前置标签和文本输入之间存在几个像素的间隙。我已经使用该`--bootstrap`选项安装了 simple_form，并验证了 Rails/haml/bootstrap/bootstrap-sass 版本与工作的 rails 应用程序相同。

我不会覆盖我的样式表中的任何相关 css（我已将其全部注释掉以确保）。

任何想法为什么 Bootstrap 没有表现出应有的行为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T09:15:08.733

我真的不知道这里有什么问题，但我有同样的事情。

比较`span.add-on`标签，我发现他们的标签`float: left`上有一个。我添加了它，它似乎起到了作用。

我还注意到他们使用的是 twitter 2.01。我使用的是 2.02，所以可能发生了一些变化。

编辑：这搞砸了附加跨度。

```
.input-prepend .add-on,
.input-append input {
  float: left;
} 
```

是我添加的。感觉不对，但它现在正在工作。希望其他更了解引导程序的人可以提供帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T19:49:48.287

我没有查看更改以了解原因，但我可以确认它在 2.0.1 中按预期工作，并且在 2.0.2 中有描述的差距。要恢复到旧的正确行为，您可以将 Gemfile 中现有的 bootstrap-sass 行替换为：

```
gem 'bootstrap-sass', '2.0.1' 
```

并更新您的捆绑包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T10:06:33.767

你需要添加这个：`content_tag :span, "attribute", :class => "add-on", :style => 'margin-right: -5px;'`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-02T17:31:54.493

The accepted solution will cause problems if there is an error on the page due to validations. Simple_form actually has a wrapper that will allow you to do this and is much better when handling errors.

```
<%= f.input :name, :wrapper => :append, :class => "inline" do %>
    <%= f.input_field :name%>
    <%= content_tag :span, "@", :class => "add-on abbn" %>
<% end %> 
```

# c# - 无法在谷歌浏览器上使用 XMLHttpRequest 加载动态生成的 xml

> ID：10033575
> 
> 赞同：0
> 
> 时间：2012-04-05T18:00:39.437
> 
> 标签：c#, javascript, jquery, asp.net, xmlhttprequest

我有一个生成 XML 输出的 aspx 文件。在另一个页面上，我正在尝试使用 XMLHttpRequest open 方法来读取从 aspx 文件输出的 XML。FF、IE、Safari 似乎都可以工作，除了 Chrome。但是，在 chrome 上，如果我直接转到地址栏上的 aspx 页面，则会按预期生成 xml。任何帮助表示赞赏。

这是aspx代码：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="ProviderFinderXML.aspx.cs" Inherits="Pages_ProviderFinderXML" %>

<%@ OutputCache Duration="6" VaryByParam="Type" %> 
```

背后的aspx代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

using System.Xml;
using System.ServiceModel.Syndication;
using System.Text;
using System.Data;

public partial class Pages_ProviderFinderXML : System.Web.UI.Page
{    
    protected string appPath = Helper.GetApplicationPath();
    private DataTable dataTable, dataTable2;
    private Helper helper = new Helper();

    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected override void OnInit(EventArgs e)
    {
        float center_lat = 0, center_lng = 0;
        int radius = 0;
        if (Request.QueryString["lat"] != null)
            center_lat = Common.ConvertToFloat(Request.QueryString["lat"].ToString());
        if (Request.QueryString["lng"] != null)
            center_lng = Common.ConvertToFloat(Request.QueryString["lng"].ToString());
        if (Request.QueryString["radius"] != null)
            radius = Common.ConvertToInt(Request.QueryString["radius"].ToString());
        int categoryId = 0;
        if (Request.QueryString["categoryId"] != null)
            categoryId = Common.ConvertToInt(Request.QueryString["categoryId"].ToString());

        Response.Buffer = false;
        Response.Clear();
        Response.ContentType = "application/xml";
        XmlTextWriter xmlWriter = new XmlTextWriter(Response.Output);
        xmlWriter.WriteStartDocument();

        xmlWriter.WriteStartElement("markers");

        int perPage = 0, currentPage = 1;

        dataTable = helper.DIR_GetNearbyDirectoryMembersByLatLng(center_lat, center_lng, radius, categoryId, perPage, currentPage);

        if (dataTable.Select().Length > 0)
        {
            xmlWriter.WriteAttributeString("title", cRow["title"].ToString().Replace("'", "\\'"));
        }
        xmlWriter.WriteEndDocument();

        xmlWriter.Flush();

        xmlWriter.Close();

        base.OnInit(e);

        Response.Close();
    }

    private string GetFullyQualifiedUrl(string url)
    {
        return string.Concat(Request.Url.GetLeftPart(UriPartial.Authority), ResolveUrl(url));
    }

} 
```

这是调用该 aspx 页面的测试页面代码部分：

```
<script type="text/javascript">

            $(document).ready(function () {
                searchLocationsNear();
            });

            function searchLocationsNear() {
                var searchUrl = 'http://localhost/integrativediagnosis2/Pages/ProviderFinderXML.aspx?lat=42.3584308&lng=-71.0597732&radius=20';
                var xmlhttp;
                if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                    xmlhttp = new XMLHttpRequest();
                }
                else {// code for IE6, IE5
                    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
                }
                xmlhttp.open("GET", "ProviderFinderXML.aspx?lat=42.3584308&lng=-71.0597732&radius=20", false);
                xmlhttp.send();
            }

        </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:14:07.470

使用 JQuery.ajax 代替手工调用。

使用 Fiddler 或其他 HTTP 跟踪工具确认所有请求都按预期发送/接收。

我没有立即看到任何错误。没有读取输出的代码，因此不清楚“在 Chrome 中不起作用”是什么意思。

# java - 将用 Java 构建的应用程序核心更改为 Scala - 一个错误和其他疑问

> ID：10033576
> 
> 赞同：0
> 
> 时间：2012-04-05T18:00:41.803
> 
> 标签：java, eclipse, list, scala

想象一个应用程序有 2 个模块。一个称为核心，其作用类似于具有一组接口（并定义了一些函数）的 API。

另一个模块称为 CoreTest 并实现了一些扩展 API 的类，并且使用 JUnit 在该核心中进行测试。

现在我只想将核心模块更改为 Scala。我是 scala 的菜鸟 :)。

到目前为止，我遇到了一个错误：

> 该项目未构建，因为其构建路径不完整。找不到 scala.collection.immutable.List 的类文件。修复构建路径，然后尝试构建这个项目 ScalaCoreTest

所以提出了一些疑问。

*   我可以使用 Scala 为 Scala 定义的结构吗？
*   我是否应该避免在 scala 中使用其他无法“翻译”为 Java 的东西？

我正在使用带有 scala 插件的 eclipse。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:18:41.107

右键单击项目并选择“配置 > 添加 Scala Nature”。这将正确配置您的构建路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:16:04.140

检查您的项目中是否包含标准 Scala 库。在 Package Explorer 中右键单击项目，选择 Properties、Java Build Path、Libraries。

您应该在那里至少看到一个 JRE 系统库和一个 Scala 库。

您的项目可能缺少 Scala 库。通过单击右侧的“添加库...”按钮添加它，选择“Scala Library”，然后单击完成。

# pdf - WebClient.DownloadData() 返回 0 个字节

> ID：10033578
> 
> 赞同：1
> 
> 时间：2012-04-05T18:00:51.637
> 
> 标签：pdf

我正在尝试将 PDF 下载到要附加到 MailMessage 的内存流中。这是我的代码：

```
string pdfUrl = "http://dev.domain.com/pdf+files/sample.pdf";
WebClient client = null;
MemoryStream stream;
try
{
    client = new WebClient();
    stream = new MemoryStream(client.DownloadData(pdfUrl));
    attachments.Add(new Attachment(stream, "Sample.pdf");
}
finally
{
    client.Dispose();
} 
```

从 client.DownloadData(pdfUrl) 返回的 byte[] 长度为 0。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T21:43:16.220

下载可以从 Web 浏览器工作但以编程方式尝试时失败的原因有很多。这些原因包括：缺少 cookie（包括身份验证令牌）、不匹配的方法（POST 与 GET）、缺少表单字段、不同的 HTTP 标头、重定向问题等。

查看[此屏幕抓取问题目录，](https://stackoverflow.com/a/1521292/126352)了解有关如何解决的更多信息。

如果我不得不猜测您的情况出了什么问题，我会猜测缺少 cookie 或 HTTP 标头。

# android - 处理未捕获的异常后，如何阻止我的应用程序僵尸化？

> ID：10033580
> 
> 赞同：6
> 
> 时间：2012-04-05T18:00:57.730
> 
> 标签：android, exception-handling

我正在通过以下方式处理我的应用程序中发生的任何未捕获的异常：

```
Thread.setDefaultUncaughtExceptionHandler(this); 
```

这是我实现 UncaughtExceptionListener 的启动器 Activity。我处理异常并将其发送到我的日志服务器就好了，但是，我的应用程序并没有结束。它只是像僵尸一样运行，直到按下主页或返回按钮。处理异常后如何终止进程？

**编辑**
这是一个测试和工作活动，它抛出一个未捕获的异常，该异常将被（由线程）捕获并处理。永远不会发布 toast，一旦记录异常，进程就会变成僵尸。

```
class TestActivity extends Activity implements UncaughtExceptionListener {

    @Override public void onCreate(Bundle icicle) {
        super.onCreate(icicle);

        Thread.setDefaultUncaughtExceptionHandler(this);
        throw new RuntimeException("I'm a destuctive booger.");

        setContentView(R.layout.activity_test);
    }

    @Override public void uncaughtException(Thread thread, Throwable toss) {
        Log.e(TAG, "An uncaught exception has been recieved.", toss);
        Toast.makeText(this, "Big Error", Toast.LENGTH_LONG).show();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T23:32:31.167

我对您的示例代码进行了一些测试，发现`finish()`可以从`uncaughtException()`. 它是无声的，但是不会向用户提供任何反馈，并且像您一样，`Toast`即使使用`getApplicationContext()`.

`NotificationManager`发送我能够工作的任何反馈的唯一方法是`Notification`使用`getApplicationContext()`.`Context`

我没有花太多时间在上面，但不幸的是，这似乎确实意味着`PendingIntent`当用户单击通知本身时必须提供处理。如果用于生成未处理异常的集合，那么这样做`Activity`显然会冒无限循环的风险。`Activity``PendingIntent`

但是，有可能创建一个不同的基础，`Activity`可能带有一个可以打开并解释崩溃的对话框主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:11:01.443

不确定是否有更温和的方法来处理此问题，但您可以尝试：

```
import android.os.Process;

Process.killProcess(Process.myPid()); 
```

# c++ - Qt Creator，调用函数

> ID：10033582
> 
> 赞同：1
> 
> 时间：2012-04-05T18:01:11.523
> 
> 标签：c++, qt, qt-creator

我在 QT 创建者的不同类中调用函数时遇到问题。

在这里，在主类`mainWindow.cpp`中，我调用了一个函数，`studentsearcher.cpp` 这是用户按下按钮时发生的一个函数，问题出在这个

```
void MainWindow::on_FindButton1_clicked(){

      StudentSearcher searchStudent;
      searchStudent.exec();
      searchStudent.search_id(55);  //   <---- the problem
} 
```

这会产生以下 2 条错误消息：

```
1.undefined reference to StudentSearcher::search_id(int)
2.collect2: ld returned 1 exit status 
```

这是 StudentSearcher.h 文件的一部分：

```
class StudentSearcher : public QDialog
{
    Q_OBJECT

public:
    explicit StudentSearcher(QWidget *parent = 0);

    void search_id(int idNum);

    ~StudentSearcher();

private slots:

private:
    Ui::StudentSearcher *ui; 
```

这是studentSearcher.cpp中函数的定义

```
void search_id(int idNum){
int idNumber = idNum;

} 
```

我已经尝试解决这个问题很长时间了，我尝试了一些非常愚蠢的事情，比如： `searchStudent.exec(search_id(55));`

并认为它行不通，因为我认为 .exec() 是构造函数部分....对不起，我对编码和 QT 有点不满意，但是...我似乎无法弄清楚如何让这个愚蠢的事情发挥作用。我尝试了很多东西，但都没有成功...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:06:47.090

您的 search_id 实现是一个免费功能。您需要使其成为成员函数：

```
void StudentSearcher::search_id(int idNum){
    int idNumber = idNum;
} 
```

# android - 如何与android中的服务交谈

> ID：10033585
> 
> 赞同：1
> 
> 时间：2012-04-05T18:01:27.173
> 
> 标签：android

我有一个启动前台服务的活动。该服务启动一个从麦克风录制语音的类 (recwav)。从我需要访问录音的 recwav 类 toget maxamplitude 的活动中。

什么是正确的方法？

使用信使对象或广播？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:01:57.737

这听起来像是本地服务的示例。您可以将 Activity 绑定到服务，然后您的 Activity 类将能够调用您在该服务类上公开的任何公共方法：

> 服务最常见的用途之一是作为辅助组件与应用程序的其他部分一起运行，与其他组件在同一进程中。除非另有明确说明，否则 .apk 的所有组件都在同一进程中运行，因此这是一种典型情况。
> 
> 以这种方式使用时，通过假设组件在同一个进程中，您可以大大简化它们之间的交互：服务的客户端可以简单地将他们从它接收到的 IBinder 转换为服务发布的具体类。

[http://developer.android.com/reference/android/app/Service.html#LocalServiceSample](http://developer.android.com/reference/android/app/Service.html#LocalServiceSample)

# java - Convert Decimal to Binary using Recursion Java

> ID：10033587
> 
> 赞同：0
> 
> 时间：2012-04-05T18:01:33.663
> 
> 标签：java, recursion, binary, decimal

I am trying to simply convert to Binary with recursion. I am having problems with the return statement. This compiles but give an overflow error when run. I don't know what to return (or if my statement is wrong) to prevent this error.

Thanks!

```
public static String convertToBinary(int number)
{
  if(number > 0)
    {
      convertToBinary(number / 2);
      convertToBinary((number % 2 ));
     }

   return convertToBinary((number));
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T18:09:30.127

我相信你的问题是在 number/2 和 number%2 上调用 convertToBinary。这段代码对我来说很好，与你所拥有的没有什么不同：

```
import java.util.Scanner;

public class DecToBin {

public static void main(String[] args) {

    int input;
    Scanner scan = new Scanner(System.in);

    System.out.print("Enter number to convert to binary: ");
    input = scan.nextInt();
    convert(input);

}

public static void convert(int num) {
    if (num>0) {
        convert(num/2);
        System.out.print(num%2 + " ");
    }
}

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T18:06:27.700

好吧，问题似乎是您实际上并没有在递归方法中做任何事情。

在其最基本的形式中，您的递归方法应包含：

1.  一种或多种逃逸条件。
2.  递归调用自身。

（这是一个过于简单的观点，但现在可以了。）

问题是您缺少一些转义条件来处理参数为一位长的情况，即您无法再细分它。

您的代码的另一个问题是您没有对递归调用的结果做任何事情。您应该存储并连接它们。

我建议您重新开始：先编写一个转换单个位的方法（这将是非递归的），然后将递归添加到它。（一般建议：不要害怕丢弃代码并从头开始。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T18:06:05.890

假设这是家庭作业，我会指出主要错误..

```
return convertToBinary((number)); 
```

return 应该返回一个值，而不是调用函数。这只会添加一个导致溢出的递归状态堆栈。尝试将之前调用的值保存到变量中并返回。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T18:13:17.133

如果这不是家庭作业，请考虑： [http ://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#toBinaryString%28int%29](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#toBinaryString%28int%29)

或者

[http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#toString%28int,%20int%29](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#toString%28int,%20int%29)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T18:06:00.677

一旦`number`达到零，该方法将简单地一遍又一遍地调用自己。final`return`需要返回别的东西——比如一个字符串。话虽如此，我认为这种方法并不是非常理想的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-06-29T04:36:55.720

试试下面 -:

```
public static String dec2Bin(int num) {
    String result = ((num % 2 == 0) ? "0" : "1"); // expr

    if (abs(num) > 1) {
        result = dec2Bin(num / 2) + result;
    }

    return result;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-27T10:47:28.920

以下将递归工作。如果数字是负数，它将添加“-”作为结果的前缀。

```
 void printBinary (int n) {
            if (n < 0) {         //base case
                System.out.print("-");
                printBinary(-n);
            } else if (n < 2) {    //base case
                System.out.print(n);
                return;
            } else {
                printBinary(n/2);   //recursive step
                int answer = n%2;   
                System.out.print(answer);
            }

        } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-17T13:18:47.680

```
class DecBin {
    static int convert(int i) {
        if (i > 0) {
            convert (i/2);
            System.out.println(i%2);
            return 0;
        } else {
            return 0;
        }
     }

    public static void main(String[]  args) {
        DecBin.convert(10);
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-04T23:27:59.540

这可行，但您必须从头开始打印

```
static void printBinary(int x){
     if(x==0)System.out.printf("%3d", x);
      else{
           System.out.printf("%3d",x%2);
           printBinary(x/2);
      }
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-06-24T04:40:30.767

我试图创建一个通用子例程，它接受任何十进制整数并将其转换为所需的 BASE。

```
private Integer convertToBaseN(int num,int n, int pow)
{
    Integer r = num%n;

    if(num < n)
        return new Double((Math.pow(10, pow-1))*r.doubleValue()).intValue();

    return convertToBaseN(num/n, n,pow+1)+ 
            new Double(Math.pow(10, pow-1)*r.doubleValue()).intValue();
}

    num :- Decimal No you want to convert.
    n:- Base to which you want to convert ( n =2 in your case).
    pow = 1 (fixed);

    Input=> convertToBaseN(503,5, 1); Output=> 4003
    Input=> convertToBaseN(7,2, 1); Output=> 111 
```

注意：- 它不适用于负数。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-06-08T13:46:17.170

```
public class DecImalToBinary {
    public static String decimalToBinary(int num){
        StringBuilder sb= new StringBuilder();
        if (num <2){
            return ""+ num;
        }
        else{
            return (sb.append(num%2)) + decimalToBinary((num/2));           
        }
    }

    public static void main(String[] args){
        System.out.println(decimalToBinary(8));
    }
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2016-06-06T00:44:04.467

只需将 (number/2*10) 的二进制转换添加到数字的其余部分：

```
int binary(int dec) {
    int remainder=dec%2;

    if (dec==1 || dec==0)
        return dec;
    else
        return remainder + (binary(dec/2)*10);
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2017-02-14T22:35:17.210

这是我的解决方案：

```
 public static String binaerRec(int number)
{
    if (number > 1)
    {
        return binaerRec(number / 2) + number % 2;
    } else
    {
        return 1 + "";
    }
} 
```

玩得开心

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2016-11-26T04:54:28.687

```
public String convertirABinario(int n){
    String b = "";
    if (n == 0 || n == 1){
      b = "" + n;
    }
    else{
      b = b + convertirABinario(n/2) + n%2;
    }
    return b;
} 
```

# .net - What is the difference between Calling a method by one of the three methods?

> ID：10033589
> 
> 赞同：1
> 
> 时间：2012-04-05T18:01:40.037
> 
> 标签：.net, multithreading, asynchronous, synchronous, begininvoke

What is the difference between Calling a method by one of the three methods ?

1.  via Creating a new thread
2.  Synchronous call through Invoke
3.  Asynchronous call through BeginInvoke and alternatively EndInvoke

I am assuming all the calls will be using a matching delegate under the hood.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:06:21.250

[（假设 .NET 给定了您的用户名……）这三个选项是使用委托](http://msdn.microsoft.com/en-us/library/ms173171%28v=vs.80%29.aspx)的不同方式。

创建新线程并不是专门“调用方法”，而是使用指定的委托作为在新线程中运行的方法来启动新线程。这将为您启动一个全新的线程，并在单独的线程中运行您的委托。

通过 BeginInvoke/EndInvoke 异步调用委托是类似的，只是它将使用 ThreadPool 而不是创建新线程。

通过 Invoke 同步调用委托只会直接在当前执行的线程上调用委托。这实际上只是调用了委托所引用的方法。

# php - 无法通过 php 连接到 mysql，但从命令行可以正常工作

> ID：10033592
> 
> 赞同：1
> 
> 时间：2012-04-05T18:01:48.667
> 
> 标签：php, mysql, centos

我只是在设置一个新的 VPS 来学习设置我自己的 Web 服务器并坚持这个非常基本的步骤。

```
PHP 5.3.3
MySQL 5.1.61
CentOS release 6.2 (Final) 
```

我可以在命令行使用 mysql 连接到服务器，或者使用 Navicat 远程连接到服务器，没有问题。我已将主机设置为 '%' 进行测试，因为 localhost 也不起作用。我尝试过使用“localhost”、IP 等。

```
Connect failed: Access denied for user 'stats'@'localhost' (using password: YES) 
```

用户：

```
+-----------+---------+
| Host      | User    |
+-----------+---------+
| %         | stats   |
| 127.0.0.1 | root    |
| localhost | root    |
+-----------+---------+ 
```

我的代码：

```
<?php
    $mysqli = new mysqli("localhost", "user", "db", "pw");
?> 
```

直接从命令行运行 php 脚本时出错（无 Web 服务器）：

```
PHP Warning:  mysqli::mysqli(): (28000/1045): Access denied for user 'stats'@'localhost' (using password: YES) in /xxx/db.php on line 5
Connect failed: Access denied for user 'stats'@'localhost' (using password: YES) 
```

通过 apache 运行时返回相同的值。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:09:47.063

这一行：

```
$mysqli = new mysqli("localhost", "user", "db", "pw"); 
```

应该：

```
$mysqli = new mysqli("localhost", "user", "pw", "db"); 
```

密码位于数据库名称之前

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:03:58.997

你正在混合`mysql`和`mysqli`

**编辑**

检查您尝试连接数据库的用户的权限。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-05T18:07:53.487

您输入了正确的密码吗？检查密码

# c++ - 取消引用运算符与具有 void* 的数组偏移运算符给出不同的结果

> ID：10033598
> 
> 赞同：0
> 
> 时间：2012-04-05T18:02:15.893
> 
> 标签：c++, arrays, void-pointers, dereference

以下 C++ Win32 控制台程序将数组分配给指向 void 的指针，并以两​​种不同的方式打印结果：

```
// Foo.cpp : A Win32 console application.
//
#include "stdafx.h"

typedef unsigned char elem_type;
#define ELEM_COUNT 4

int _tmain(int argc, _TCHAR* argv[])
{
    elem_type *ary = new elem_type[ELEM_COUNT];
    for (int i = 0; i < ELEM_COUNT; i++)
    {
        ary[i] = ((i + 1) * 5); // multiples of 5
    }
    void *void_ary = ary;

    for (int i = 0; i < ELEM_COUNT; i++)
    {
        printf("void_ary[%d] is %u\t", i, ((elem_type*)void_ary)[i]);
        printf("*(void_ary+%d) is %u\n", i, *((elem_type*)(void_ary))+i);
    }

    void *allocd_ary;
    return 0;
} 
```

这是输出：

```
void_ary[0] is 5        *(void_ary+0) is 5
void_ary[1] is 10       *(void_ary+1) is 6
void_ary[2] is 15       *(void_ary+2) is 7
void_ary[3] is 20       *(void_ary+3) is 8 
```

使用方括号会打印出我预期的结果。但是取消引用指针偏移量不会，***即使数组正在被 typecast***。

为什么会出现差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:04:08.140

那是因为您要取消引用该值，然后将“i”添加到结果中。您需要在指针强制转换或使用更明显的 static_cast 周围加上更多括号。

如：

`*(static_cast<elem_type*>(void_ary)+i)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:05:43.407

```
printf("*(void_ary+%d) is %u\n", i, *((elem_type*)(void_ary))+i); 
```

在这里，您似乎在添加之前取消引用该值`i`。这将导致始终获取数组的第一个元素（因为您取消引用相同的指针 5 次）并添加`i`到它。

尝试：

```
*((elem_type*)(void_ary)+i) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T18:06:33.613

你的表达不是同一个意思。你写的是什么

```
*(void_ary+i) 
```

其实不是这样的。事实上它是

```
void_ary[0]+i 
```

根据你的`printf`符号。

* * *

如果你写

```
*((elem_type*)(void_ary))+i 
```

作为

```
*((elem_type*)(void_ary)) + i 
```

然后我认为它变得更加清晰。您正在寻找：

```
*((elem_type*)(void_ary)+i) 
```

# objective-c - Best iOS design pattern for basic one view showing/hiding

> ID：10033599
> 
> 赞同：0
> 
> 时间：2012-04-05T18:02:17.110
> 
> 标签：objective-c, ios, design-patterns, uiview, uiviewcontroller

I tested some own design patterns but not satisfied because a bit complex compared to the task to achieve..

I have a playground, using pure C++ stuff without UI. At the bottom, I'd like to have only a basic button on which the user can click to show a menu (basically a view from a .xib)

I tried to do that with two view, one "calling" show/hide methods of the other... A mess, using tagged instances etc.

How would you achieve that without a toolbar which would take too much space on the screen ?

Many thanks for your advices and experiences.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:16:55.097

如果我正确理解您的问题，您可以阅读以下内容： [Presting View Controllers from Other View Controllers](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ModalViewControllers/ModalViewControllers.html)

我建议您为应用程序中的每个视图使用一个视图控制器。因此，话虽如此，您制作了一个视图控制器和一个包含按钮的视图（以编程方式或界面生成器），然后单击时您将使用我链接的技术来呈现弹出框/模态视图控制器的视图。

我认为 Apple 的文档很好，但我也可以提供一些教程：

*   [http://timneill.net/2010/09/modal-view-controller-example-part-1/](http://timneill.net/2010/09/modal-view-controller-example-part-1/)
*   [http://timneill.net/2010/11/modal-view-controller-example-part-2/](http://timneill.net/2010/11/modal-view-controller-example-part-2/)

# android - Android - Getting value from another method

> ID：10033606
> 
> 赞同：0
> 
> 时间：2012-04-05T18:02:48.667
> 
> 标签：android, class, methods, call

I'm still a bit new to Java and went straight in Android programming so I'm a little bit confused in some programming practices.. I just want to ask how can I call this method from another class to my OnCreate()? My method is in DBFunctions.java. Basically, I will use this in my game's options.

```
public void checkExistence(Cursor check) {
    String sql = "SELECT * FROM option WHERE id = 1";
    check = db.rawQuery(sql, null);`
} 
```

I want to call this in my OnCreate(). If value exists, I just want first to display "Value exists", else "No Value exists". Please also correct me if the cursor inside the parameter is right..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:14:45.680

创建一个实例，`DBFunctions`然后调用`checkExistence()`. 例如：

```
DBFunctions dbfunc = new DBFunctions();
    if (dbfunc.checkExistence()) {
        /* do something */
    } else {
       /* do something else */
    } 
```

所以改变你的`checkExistence()`签名：返回一个布尔值，并且 Cursor 应该是你方法中的一个局部变量：

```
public boolean checkExistence() {
    boolean exists = false;
    String sql = "SELECT * FROM option WHERE id = 1";
    Cursor cursor = db.rawQuery(sql, null);
    exists =  (cursor.getCount() > 0);
    cursor.close();
    return exists;
} 
```

另一种选择是将`static`修饰符添加到`checkExistence()`并按如下方式调用它：

```
if (DBFunctions.checkExistence()) {
    /* do something */
} else {
   /* do something else */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:10:02.363

要从另一个类调用此方法，您首先必须创建`DBFunctions`. 然后这个方法调用的语法看起来像这样：

```
Cursor mycursor = ...;

DBFunctions myFunctions = new DBFunctions();
myFunctions.checkExistence(mycursor); 
```

或者，如果您想避免创建 的实例`DBFunctions`，可以将 static 关键字添加到方法声明中，例如：

```
public static void checkExistence(Cursor check) {
    String sql = "SELECT * FROM option WHERE id = 1";
    check = db.rawQuery(sql, null);
} 
```

然后，您可以在没有实例的情况下调用静态方法`DBFunctions`：

```
DBFunctions.checkExistence(mycursor); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:07:57.060

首先，您应该在方法中将 Cursor 声明为局部变量。获得 Cursor 后，检查该值是否存在并返回一个布尔值。方法原型应如下所示：

```
public boolean checkExistence() 
```

在 onCreate 方法中，您将调用它，如下所示：

```
if (new DBFunctions().checkExistence()) {
    // do something
} else {
   // do something else
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:08:06.000

如果你想调用任何属于其他类的方法，你可以通过引用它的类名来调用它，如下所示:::(使该函数成为静态的)

ClassName.FunctionName() 就是这样......

即使你可以从你的函数返回值，如果 void 使用你的返回类型......

# c# - DataGridView.CellClick 方法不起作用

> ID：10033609
> 
> 赞同：2
> 
> 时间：2012-04-05T18:03:06.327
> 
> 标签：c#, datagridview, event-handling

```
//FormLoad    
dgvTable.CellClick += new DataGridViewCellEventHandler(getValues);

//somwhere in FormClass
private void getValues(object sender, DataGridViewCellEventArgs e)
    {
        int id = int.Parse(dgvTable.Rows[dgvTable.CurrentRow.Index].Cells[0].Value.ToString());
        var values = from c in v.db.TotalDoc
                     where c.TotalID == id
                     select c.TotalAmount;
        dgvValues.DataSource = values;
    } 
```

我在表单上有两个 datagridviews (dgv)。我从第一个 dgv (dgvTable) 中选择 dataID，并在另一个 dgv 中获取这些 id 的所有值。但是 e 方法 dgvTable.CellClick() 没有效果。我得到了 emtpy dgv。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:00:24.987

好的，在您发表评论后，我只是建议您使用`.ToList()`帮助网格来识别数据源：

```
 int id = int.Parse(dgvTable.Rows[dgvTable.CurrentRow.Index].Cells[0].Value.ToString());
 var values = (from c in v.db.TotalDoc
               where c.TotalID == id
               select c.TotalAmount).ToList();
 dgvValues.DataSource = values; 
```

# json.net - 防止 Json.NET 4.5 在使用 MicrosoftDateFormat 时附加时区偏移量

> ID：10033612
> 
> 赞同：21
> 
> 时间：2012-04-05T18:03:15.317
> 
> 标签：json.net

缺少自定义`DateTimeConverterBase`实现，是否有某种方法可以让 Json.NET 4.5+ 在设置为 use时为给定`DateFormatHandling.MicrosoftDateFormat`的任何非 UTC 附加时区偏移量`DateTime`？

```
"\/Date(1333645844276-0600)\/" 
```

## 细节

我正在将一个 API 项目从使用内置 .NET`JavaScriptSerializer`切换到使用 Json.NET 生成 JSON。在 Json.NET 中，对于 UTC `DateTime`，默认的日期时间序列化类似于 .NET 版本：

```
"\/Date(1333645844276)\/" 
```

对于非 UTC，与 不同`JavaScriptSerializer`的是，Json.NET 会在结果中附加一个时区偏移量（我所在的地区为 -6，每年的这个时候）：

```
"\/Date(1333645844276-0600)\/" 
```

这是我用来将 Json.NET 4.5+ 切换回`\/Date(...)\/`格式（称为`MicrosoftDateFormat`）的代码：

```
JsonSerializerSettings customJsonSettings = new JsonSerializerSettings() {
    DateFormatHandling = DateFormatHandling.MicrosoftDateFormat
};
string result = JsonConvert.SerializeObject(DateTime.Now, customJsonSettings); 
```

该解决方案似乎就像告诉 Json.NET 使用不同的`DateTimeZoneHandling`设置一样简单。我已经尝试了`DateTimeZoneHandling`( `Local`、`Utc`、`Unspecified`和`RoundtripKind`) 的所有设置，它们都在输出中保持“-0600”。事实上，对于非 UTC ，它们都产生相同的结果`DateTime`。

```
JsonSerializerSettings customJsonSettings = new JsonSerializerSettings() {
    DateFormatHandling = DateFormatHandling.MicrosoftDateFormat,
    DateTimeZoneHandling = DateTimeZoneHandling.Utc
};
string result = JsonConvert.SerializeObject(DateTime.Now, customJsonSettings);
"\/Date(1333647855743-0600)\/" 
```

## 警告

理想情况下，我会在 UTC 度过我所有的时间。我当然打算在这个 API 的下一个版本中这样做。由于这是一个实时 API，因此在发布新版本之前不值得冒险更改输出。对于大多数 JSON 解析系统来说，这似乎不是问题，但我不能冒险改变，因为 JSON 标准没有正式说明日期序列化。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T10:40:10.450

它对我来说似乎工作得很好，见下文。我的 JSON.NET 程序集说它的版本是“4.5.0.0”。

```
JsonSerializerSettings customJsonSettings = new JsonSerializerSettings()
{
    DateFormatHandling = DateFormatHandling.MicrosoftDateFormat,
    DateTimeZoneHandling = DateTimeZoneHandling.Utc
};
string result = JsonConvert.SerializeObject(DateTime.Now, customJsonSettings);
Console.WriteLine(result); // "\/Date(1344249339881)\/" 
```

也许这是一个已修复的错误？

显式创建日期：

```
var x = new { thedate = new DateTime(2009, 2, 15, 0, 0, 0, DateTimeKind.Local) };

Console.WriteLine(JsonConvert.SerializeObject(x,
    new JsonSerializerSettings() {
        DateFormatHandling = DateFormatHandling.MicrosoftDateFormat
    }));
// {"thedate":"\/Date(1234652400000+0100)\/"}

Console.WriteLine(JsonConvert.SerializeObject(x,
    new JsonSerializerSettings() {
        DateFormatHandling = DateFormatHandling.MicrosoftDateFormat,
        DateTimeZoneHandling = Newtonsoft.Json.DateTimeZoneHandling.Utc
    }));
// {"thedate":"\/Date(1234652400000)\/"}

Console.WriteLine(JsonConvert.SerializeObject(x,
    new JsonSerializerSettings() {
        DateFormatHandling = DateFormatHandling.MicrosoftDateFormat,
        DateTimeZoneHandling = Newtonsoft.Json.DateTimeZoneHandling.Local
    }));
// {"thedate":"\/Date(1234652400000+0100)\/"} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-12-15T14:43:19.423

`DateTime`我找到了一个从最新版本 9.0.0中删除时区偏移的解决方案：

```
var time = DateTime.Now;

Console.WriteLine(JsonConvert.SerializeObject(time, new JsonSerializerSettings()
{
    DateFormatHandling = DateFormatHandling.IsoDateFormat,
    DateTimeZoneHandling = Newtonsoft.Json.DateTimeZoneHandling.Unspecified
}));

//"{"thedate": "2016-12-15T09:20:00.9375403"}; 
```

# javascript - 如何确定扩展的目录

> ID：10033618
> 
> 赞同：5
> 
> 时间：2012-04-05T18:03:27.687
> 
> 标签：javascript, firefox, firefox-addon

我需要从 JavaScript 中获取扩展安装目录的路径。

我的目标是从 Firefox 扩展写入扩展目录中的 JSON 文件。为此，我需要确定扩展在 Firefox 配置文件中的安装目录。

我使用这段代码：

```
function writeToFile()
{
    var id  = "plugin@uua";// The extension's id from install.rdf(i.e. <em:id>)
    var ext = Components.classes["@mozilla.org/extensions/manager;1"]
                        .getService(Components.interfaces.nsIExtensionManager)
                        .getInstallLocation(id)
                        .getItemLocation(id);
    var file = Components.classes["@mozilla.org/file/local;1"]
                         .createInstance(Components.interfaces.nsILocalFile);
    file.initWithPath(ext.path); 
    file.append("config.json");     
    var foStream = Components.classes["@mozilla.org/network/file-output-stream;1"]   
                             .createInstance(Components.interfaces.nsIFileOutputStream);
    foStream.init(file, 0x02 | 0x08 | 0x20, 0666, 0); 
    var data = '[ {"id" : "2"} ]';
    foStream.write(data, data.length);
    foStream.close(); 
```

它抛出以下错误：

```
TypeError:Components.classes['@mozilla.org/extensions/manager;1'] is undefined. 
```

**我本质上需要从 JavaScript 中自动获取扩展的路径。** 我仔细检查了我的扩展程序的 ID，我还尝试从其他扩展程序写入文件，但没有成功。

* * *

非常感谢您的回复。无论如何，它并没有让我立即解决我的问题，但它迫使我阅读 Mozilla 文档。我终于明白了它是如何工作的。再次感谢。

**解决上述问题：**

```
 Components.utils.import("resource://gre/modules/AddonManager.jsm");
    Components.utils.import("resource://gre/modules/FileUtils.jsm");
    AddonManager.getAddonByID("plugin_id", function(addon) {

    var uri = addon.getResourceURI("config.json");
    var file = Components.classes["@mozilla.org/file/local;1"]
                         .createInstance(Components.interfaces.nsILocalFile);
    var stringUri = uri.asciiSpec;
    stringUri = stringUri.replace(new RegExp(/\//g), '\\');
    stringUri = stringUri.slice(8);
    alert(stringUri);
    file.initWithPath(stringUri);
    alert(addon.hasResource("config.json"));

    var stream = FileUtils.openFileOutputStream(file,
                                                FileUtils.MODE_WRONLY 
                                                | FileUtils.MODE_CREATE 
                                                | FileUtils.MODE_TRUNCATE);
    stream.write(dataToWrite, dataToWrite.length);
    stream.close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:00:14.610

从 Firefox 4 开始，您应该使用[Add-on Manager API](https://developer.mozilla.org/en/Addons/Add-on_Manager/AddonManager)：

```
Components.utils.import("resource://gre/modules/AddonManager.jsm");

AddonManager.getAddonByID(id, function(addon)
{
  var uri = addon.getResourceURI("config.json");
  if (uri instanceof Components.interfaces.nsIFileURL)
    writeToFile(uri.file);
}); 
```

请注意，新 API 是异步的，获取有关扩展的数据可能需要一些时间。[`<em:unpack>true</em:unpack>`此外](https://developer.mozilla.org/en/Install_Manifests#unpack)，您需要在您`install.rdf`的`config.json`. 写入扩展目录还有另一个问题：更新扩展时，那里的所有文件都将被替换。一个更好的主意可能是写入配置文件目录中的文件，这样您就不需要牺牲性能。

[使用FileUtils.jsm](https://developer.mozilla.org/en/JavaScript_code_modules/FileUtils.jsm)可以简化写入文件：

```
Components.utils.import("resource://gre/modules/FileUtils.jsm");

var stream = FileOutputStream.openFileOutputStream(file, FileUtils.MODE_WRONLY | FileUtils.MODE_CREATE);
stream.write(data, data.length);
stream.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:22:40.607

Firefox 4 取代了 nsIExtensionManager 的使用，取而代之的是[Add-on Manager](https://developer.mozilla.org/en/Addons/Add-on_Manager)。

所以你应该使用[附加管理器](https://developer.mozilla.org/en/Addons/Add-on_Manager)来代替 FF >= 4

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:25:52.123

您可以使用以下命令找到用户的配置文件目录：

```
Components.utils.import("resource://gre/modules/Services.jsm");
Services.dirsvc.get("ProfD", Ci.nsILocalFile) 
```

将文件保存在这里可能是一个更好的主意，但我不知道上下文。

# php - 如何选择最佳必应地图路线？

> ID：10033619
> 
> 赞同：1
> 
> 时间：2012-04-05T18:03:28.493
> 
> 标签：php, bing-maps

我想用这个脚本来计算旅程距离。很简单。除了这会返回与 Bing Maps 本身不同的答案。好的，我明白了。但我想要的是一种选择“最好”的方法。如何定义最好？Bing 会选择的那个。例如，在这种情况下，它是 11.9 英里（这是正确的）。

然而，脚本认为它是 182 英里——如果它使用不同的 Shuttleworth/Bedford，这是真的。

我如何让它给我 Bing 会选择的那个？

出于我使用这个脚本的目的，我不能有一个“可供选择的选项”，它需要自己决定。

```
<?php
$from="Bedford";
$to="Shuttleworth";
$load="http://dev.virtualearth.net/REST/v1/Routes?wp.1=$from&wp.2=$to&key=MYAPIKEY&distanceUnit=mile";
$data= file_get_contents($load);
echo $data;
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:53:54.310

我不会为了测试它而获得 Bing API 密钥，所以在你自己测试之前不要太兴奋。

我怀疑正在发生的事情是 Bing 正在使用它认为是您当前的位置来确定 Bedford 和 Shuttleworth 的含义。因此，如果它认为你在英格兰，你会选择 Bedford 和 Shuttleworth England，如果你在世界其他地方有 Bedford 和 Shuttleworth，它会选择这些。我在德克萨斯州，我得到了你想要的 11.9 英里的路线。因此，也许 Bing 足够聪明，知道除了相距 182 英里的贝德福德和沙特尔沃思以外，世界各地的人们都在寻找英国人。我猜你的代码所在的服务器靠近错误的贝德福德和沙特尔沃思。

所以我查看了 API，在[Bing API 用户上下文参数](http://msdn.microsoft.com/en-us/library/ff701704.aspx)中记录了 UserLocation 参数，您可以在其中输入纬度和经度以帮助 Bing 做出决定。尝试将该参数添加到您的查询中并输入您的实际经度和纬度，或者，如果失败，请尝试为美国德克萨斯州奥斯汀市（我所在的地方）输入一个参数，或者在贝德福德和沙特尔沃思之间添加一个参数有兴趣。

# java - 如何根据某些值生成彩色地图

> ID：10033643
> 
> 赞同：1
> 
> 时间：2012-04-05T18:04:34.080
> 
> 标签：java, swing, map, geotools

我有一个形状文件，一张简单的国家地图，我需要在屏幕上显示，但每个国家都需要有特定的颜色。假设我有一个`int`名为 的变量`HKDensity = 21`，那么如果 21 的值是红色，那么香港多边形的颜色应该是红色。

这是针对 Java Swing 中的学校作业，非常感谢任何帮助、提示示例。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:06:43.293

```
Color colour = new Color(/*r*/ density / MAX_DENSITY, /*g*/ density / MAX_DENSITY, /*b*/ density / MAX_DENSITY); 
```

或者其他的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T08:18:26.657

有关如何在多边形中显示 shapefile 和颜色的详细信息，请查看[GeoTools 样式教程。](http://docs.geotools.org/stable/userguide/examples/stylelab.html)本教程仅展示了如何生成单一颜色，但您应该能够轻松地了解如何创建可变颜色填充。

# jquery - jplayer全屏

> ID：10033644
> 
> 赞同：4
> 
> 时间：2012-04-05T18:04:34.830
> 
> 标签：jquery, jplayer

如何检测 jplayer 是否处于全屏模式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T18:09:29.637

`jp-video-full`jplayer在全屏时向 div添加一个类。

您可以将该选择器用于您想要实现的任何目标。

```
if ($("#jp_container_1").hasClass("jp-video-full")) {
    //do something
} else {
   //do something else
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T21:57:25.690

好的，这就是我必须去的：

```
 $("a.jp-full-screen").click(function(){

  if($(this).attr("title")=="full screen"){
         $(".hover, ul#navigation").hide()
  }
  })

  $("a.jp-restore-screen").click(function(){
     if($(this).attr("title")=="restore screen"){
         $(".hover, ul#navigation").show()
  }
 }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-27T13:00:56.603

```
if ($("#jp_container_1").status.cssClass == 'jp-video-full') {} else {} 
```

# vb.net - 在 VB.NET 中实现 WCF

> ID：10033651
> 
> 赞同：-3
> 
> 时间：2012-04-05T18:05:23.737
> 
> 标签：vb.net, wcf

我们有一个 vb.net 应用程序，我们在其中实现了多线程。我们确定我们需要实现 .net 远程处理或 WCF。在 MSDN 上研究 .NET 中的远程处理之后，Microsoft 考虑了 .NET 框架 4.0 的远程处理遗留问题，并建议改用 WCF。在 VB.NET 应用程序中实现 WCF 有多容易？

更新：我们已经在我们的应用程序中实现了 WCF。WCF 是一项非常强大的技术，如果您希望实施和部署 SOA - 我强烈建议您购买一些书籍并研究该技术。我们花了大约一个月的时间来熟悉这项技术并根据我们的需要实施它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:21:28.047

WCF 是在 .Net 3 中引入的。如果您的应用程序是 .Net 3 或更高版本，无论您使用的是 VB.Net 还是 C#，都可以使用 WCF。如果您使用的是 .Net 2 或更低版本，则必须首先将您的应用程序移植到更新的框架版本。

# photoshop-script - JSX - 将文件夹复制到目标 - ExtendScript

> ID：10033653
> 
> 赞同：1
> 
> 时间：2012-04-05T18:05:26.717
> 
> 标签：photoshop-script, jsx

我正在尝试将选定的文件夹复制到定义的目标。

```
function importLabs(selected) {
    if(selected = "labAuto") {
        //Open Folder dialog box
       var myLab=Folder.selectDialog("Import");   
       myLab.copy ("~/Desktop/In here");
   }
} 
```

想不通这个 我是否使用了错误的函数 .copy()？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:43:13.420

不幸的是，文件夹没有复制方法。

您需要先创建目标文件夹，然后复制每个文件。如果您还想复制子文件夹，那么您需要递归地进行。

# tsql - T-SQL 比较 2 个用户名

> ID：10033655
> 
> 赞同：0
> 
> 时间：2012-04-05T18:05:30.337
> 
> 标签：tsql

我在下面有 3 张桌子。我正在尝试比较每个用户的角色。那就是我想显示 John 有 2 个角色，而 Jane 有 1 个角色。目前我只显示它们之间的共同角色。

*   `Sec_role (PK R_KEY, rname)`
*   `Role_User(PK R_KEY, PK USER_KEY)`
*   `User(PK USER_KEY, Name)`

样本数据：

```
Sec_Role          Role_User       User

R_Key|rname|      R_Key|User_Key  User_KEY|NAME
1    |Analyst     1    |1         1       |John
2    |Sysadmin    2    |1         2       |Jane  
                  2    |2 
```

我想得到

```
User | Role    | User2 | Role2  
John | Analyst | Jane  | (Empty because she isn't an analyst)   
John | sysadmin| Jane  |Sysadmin 
```

* * *

```
SELECT U.Name AS User1,  
       U2.Name AS User2,  
       R.rname AS Role1  
       R2.Rname AS Role2  
FROM Sec_Role AS R
LEFT OUTER JOIN Role_User AS RU
ON R.R_Key=RU.R_Key
LEFT OUTER JOIN User AS U
ON U.User_Key=RU.User_Key

LEFT OUTER JOIN Sec_Role AS R2
ON R2.R_Key=R.R_Key  <---(I think this is the issue here)
LEFT OUTER JOIN Role_User AS RU2
ON R2.R_Key=RU2.R_Key
LEFT OUTER JOIN User AS U2
ON U2.User_Key=RU2.User_Key

WHERE U.Name ='John'
AND U2.Name='Jane' 
```

目前我正在获得这两个用户的交集。

```
User | Role    | User2 | Role2   
John | sysadmin| Jane  |Sysadmin 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:19:11.713

```
WHERE U.Name ='John'
OR U2.Name='Jane' 
```

注意 OR 不是 AND

为什么有 4 列

```
 SELECT U.Name AS User,  
           R.rname AS Role   
    FROM Sec_Role AS R
    LEFT OUTER JOIN Role_User AS RU
    ON R.R_Key=RU.R_Key
    LEFT OUTER JOIN User AS U
    ON U.User_Key=RU.User_Key
    where uName in ('','')
    order by 1, 2 
```

尝试这个

```
 SELECT U.Name AS User1,  
   U2.Name AS User2,  
   R.rname AS Role1  
   R2.Rname AS Role2  
 FROM Sec_Role AS R
 LEFT OUTER JOIN Role_User AS RU
 ON R.R_Key=RU.R_Key
 LEFT OUTER JOIN User AS U
   ON U.User_Key=RU.User_Key
   and U.Name ='John'

 LEFT OUTER JOIN Sec_Role AS R2
 ON R2.R_Key=R.R_Key  <---(I think this is the issue here)
 LEFT OUTER JOIN Role_User AS RU2
 ON R2.R_Key=RU2.R_Key
 LEFT OUTER JOIN User AS U2
   ON U2.User_Key=RU2.User_Key
   AND U2.Name='Jane' 
```

# java - GWT - 首次加载数据时引发属性更改成员变量的问题

> ID：10033671
> 
> 赞同：0
> 
> 时间：2012-04-05T18:06:21.553
> 
> 标签：java, gwt, jakarta-ee, asynchronous, event-handling

我有一个 GWT 应用程序，它在加载页面时加载产品。每当发生更改时，我都会在产品对象（及其子对象）上使用 PropertyChangeEvent 来更新字段的值。

当然，我不希望在第一次加载产品时引发此 PropertyChangeEvent。为此，我将 raisePropertyChange 值设置为 false，但它似乎不起作用。请在代码库下方找到：

```
// Class ProductBaseImpl
public abstract class PropChangeImpl {

    // The raise property change event, should be turned off conditionally
    private boolean raisePropertyChangeEvent = true;

    protected boolean getRaisePropertyChangeEvent() {
        return this.raisePropertyChangeEvent;
    }

    protected void setRaisePropertyChangeEvent(final boolean value) {
        this.raisePropertyChangeEvent = value;
    }

    protected void raisePropertyChangeEvent(String fieldName, Object oldValue, Object newValue) {
        if (this.raisePropertyChangeEvent ) {
            // --> HERE IS THE PROBLEM <--
            // This IF loop must not be true when loading the product first time
            System.out.println("Property change event raised!");
            // the update operations go here
        } else {
            System.out.println("Property change event not raised!");
        }
    }
}

// Class ProductBaseImpl
public abstract class ProductBaseImpl extends PropChangeImpl {

    private static HandlerRegistration productChangeBeginRegistration;
    private static HandlerRegistration productChangeEndRegistration;

    protected E instance;

    protected ProductBaseImpl(final E instance) {
        this.instance = instance;

        // Stop updates when a new product loads
        if (ProductBaseImpl.productChangeBeginRegistration == null) {
            ProductBaseImpl.productChangeBeginRegistration = Core.getEventBus().addHandler(ProductChangeBeginEvent.TYPE, new  ProductChangeBeginEventEventHandler() {
                @Override
                public void onProductChangeBegin(final ProductChangeBeginEvent event) {
                    ProductBaseImpl.this.raisePropertyChangeEvent(false);
                }
            });
        }

        if (ProductBaseImpl.productChangeEndRegistration == null) {
            ProductBaseImpl.productChangeEndRegistration = Core.getEventBus().addHandler(ProductChangeEndEvent.TYPE, new ProductChangeEndEventtHandler() {
                @Override
                public void onProductChangeEnd(final ProductChangeEndEvent event) {
                    ProductBaseImpl.this.raisePropertyChangeEvent(true);
                }
            });
        }
    }
}

// Class ProductSubObj1
public class ProductSubObj1 extends ProductBaseImpl {
    public ProductSubObj1 (final E instance) {
        super(instance);
        // some other operations
    }
}

// similar to above, I have classes ProductSubObj1, ProductSubObj2  ...

// Class ProductProvider, that fetches the product from service to UI
public class ProductProvider {

    // some properties and members

    public void fetchProduct(String productId) {

        // Let listeners know the product is about to change
        Core.getEventBus().fireEvent(new ProductChangeBeginEvent(productId));

        // Call the service to get the product in Json data

        // After processing the data to be available for the UI  (and scheduleDeferred)
        Core.getEventBus().fireEvent(new ProductChangeEndEvent(productId));
    }
} 
```

正如代码中的内联注释，控件始终位于

```
if (this.raiseDataChangeEvent) 
```

第一次加载产品时我不想发生的块。

你能告诉我我做错了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:52:13.450

你可以这样做吗：？

```
protected void raisePropertyChangeEvent(String fieldName, Object oldValue, Object newValue) {
        if (this.raisePropertyChangeEvent && oldValue != null /*Or whatever your default unloaded value is*/) {
            // --> HERE IS THE PROBLEM <--
            // This IF loop must not be true when loading the product first time
            System.out.println("Property change event raised!");
            // the update operations go here
        } else {
            System.out.println("Property change event not raised!");
        }
    } 
```

# jquery - Page_ClientValidate 未定义 (ASP.NET MVC)

> ID：10033672
> 
> 赞同：2
> 
> 时间：2012-04-05T18:06:22.850
> 
> 标签：jquery, asp.net-mvc, validation

我有一个 ASP.NET MVC 表单，布局如下：

```
@using (Html.BeginForm(null, null, FormMethod.Post, new { id = "ccform" }))
{
    @Html.ValidationSummary(true, "Please correct the errors and try again.")
    <fieldset>
        ...
    </fieldset>
} 
```

我对这种形式有一些特殊的处理，如下所示：

```
$(function () {
    $('#ccform').submit(function (e) {
        e.preventDefault();
        if (typeof (Page_ClientValidate) == 'function') {
            Page_ClientValidate();
        }
        if (Page_IsValid) {
           ...
        }
    });
}); 
```

但我发现 Page_ClientValidate*始终*未定义。

在网上搜索，我发现当验证组件不可用时可能会出现这种情况。但似乎我需要的一切。

任何人都可以提供一些提示吗？

**编辑**

正如内森所说，我偏离了轨道。在我的 Google 搜索中，我最终查看了 WebForm 验证。事实证明，在 MVC 中答案非常简单。

```
if ($('#ccform').valid()) {
} 
```

好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:20:10.027

`Page_ClientValidate()`是 ASP.NET Webforms 验证的一部分，它不与 ASP.NET MVC 一起使用。您将不得不使用[jQuery Validation 之](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)类的东西进行 ASP.NET MVC 输入验证。

# javascript - jQuery 在追加元素后立即为 div 元素返回 0 的高度

> ID：10033679
> 
> 赞同：4
> 
> 时间：2012-04-05T18:06:39.350
> 
> 标签：javascript, jquery, dom

我有一个最初没有内容的浮动 div。我使用jQuery将一组元素追加到div中，然后立即调用原始div的height方法。我添加的元素在样式表中有一个定义的最小高度，而浮动 div 没有。问题是当我在原始 div 上调用 height 时，我得到 0。

如果我使用 setTimeout 将呼叫延迟 1 毫秒，我会得到正确的高度。我的理论是，当我调用height方法时，浏览器还没有完成对DOM的渲染，所以它还没有设置顶级元素的hei?ht。这个高度会有所不同，所以使用固定高度是不合适的。有谁知道可能导致此问题的原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:27:27.893

如果没有任何结果，那么您可能暂时需要考虑延迟的 .then() 函数。这是使用 jsFiddle 的示例：http: [//jsfiddle.net/yTTRq/](http://jsfiddle.net/yTTRq/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:16:06.417

这应该取决于 dom 的大小。如果它很大，会有轻微的延迟。

# javascript - 从对象创建的 Javascript 对象总是引用最后一个元素

> ID：10033680
> 
> 赞同：0
> 
> 时间：2012-04-05T18:06:42.537
> 
> 标签：javascript, object, iteration

这是一个奇怪的问题。鉴于下面的 javascript，我希望 newFunctions 对象包含包装原始对象的函数，但它只运行循环中发生的最后一个操作。var actionToCall 不应该复制对 currentAction 当前正在查看的内容的引用，并且在循环迭代时不更改？我被难住了。

```
 var typeArray = {
    type1: {
      function1: function() {
        console.log("this is function 1");
      },
      function2: function() {
        console.log("this is function 2");
      }
    },
    type2: {
      somefunction: function() {
        console.log("this is some function")
      }
    },
    type3: {
      blah: function() {
        return;
      },
      moreBlah: function(something) {
        console.log(something);
      },
      evenMore: function() {
        console.log("I'm last!");
      }
    }
  },
      index,
      typeIndex,
      currentType,
      actionIndex,
      currentAction,
      newFunctions = {};

  for(typeIndex in typeArray) {
    currentType = typeArray[typeIndex];
    for(actionIndex in currentType) {
      currentAction = currentType[actionIndex];

      console.log(currentAction.toString());

      newFunctions[actionIndex] = function() {
        var actionToCall = currentAction;

        console.log("about to run action");

        actionToCall.call(this);

        console.log("action has been called");
      }
    }
  }

  console.log(newFunctions);

  for(index in newFunctions) {
    (newFunctions[index])();
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:24:36.617

这是因为 actionToCall 被分配给 currentAction。

由于 currentAction 是全局的，它的值随着循环迭代而不断变化。

当循环结束时，currentAction 被分配给 evenMore。

这是使用自我执行功能来诱导范围的修复。

```
var typeArray = {
    type1: {
        function1: function() {
            console.log("this is function 1");
        },
        function2: function() {
            console.log("this is function 2");
        }
    },
    type2: {
        somefunction: function() {
            console.log("this is some function")
        }
    },
    type3: {
        blah: function() {
            return;
        },
        moreBlah: function(something) {
            console.log(something);
        },
        evenMore: function() {
            console.log("I'm last!");
        }
    }
},
index,
typeIndex,
currentType,
actionIndex,
currentAction,
newFunctions = {};

for(typeIndex in typeArray) {
    currentType = typeArray[typeIndex];
    for(actionIndex in currentType) {
        currentAction = currentType[actionIndex];

        console.log(currentAction.toString());

        //induce scope here so actionToCall keeps the current value of currentAction.
        (function(){

            var actionToCall = currentAction;
            newFunctions[actionIndex] = function() {

                console.log("about to run action");

                actionToCall.call(this);

                console.log("action has been called");
            }
        })();
    }
}

console.log(newFunctions);

for(index in newFunctions) {
    (newFunctions[index])();
} 
```

# google-app-engine - 如何避免任务队列中的执行延迟

> ID：10033682
> 
> 赞同：1
> 
> 时间：2012-04-05T18:06:44.230
> 
> 标签：google-app-engine, task-queue, scheduled-tasks

我们如何在入队后尽快安排推送队列任务执行？

我们是否需要使用 Pull Queues 来使用 cron 作业？

我们会定期看到在我们的推送队列中等待执行的任务有很长的延迟（20 分钟）。我们将在队列中看到 6,000 多个任务，在最后一分钟没有执行和未执行。然后任务最终被安排执行，我们得到一个大的突发峰值，因为队列以很快的速度耗尽。

例如，队列定义如下所示：

```
<queue>
    <name>example</name>
    <target>1</target>
    <rate>20/s</rate>
    <bucket-size>40</bucket-size>
    <max-concurrent-requests>10</max-concurrent-requests>
    <retry-parameters>
        <min-backoff-seconds>10</min-backoff-seconds>
        <max-backoff-seconds>60</max-backoff-seconds>
        <max-doublings>2</max-doublings>
    </retry-parameters>
</queue> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T05:36:51.997

拉队列和推队列都可能发生延迟。任务队列提供可靠的任务执行，从不早于请求，但有时会晚于请求，例如从一个数据中心故障转移到另一个数据中心时。调度是尽力而为的，而不是实时的。

# c++ - 写入串行端口 (C++/Windows)

> ID：10033685
> 
> 赞同：1
> 
> 时间：2012-04-05T18:06:56.263
> 
> 标签：c++, windows, serial-port

我一直在寻找一种写入串行端口的方法。我发现的每一种方式都无法实施。我目前用于 Recvfrom() 函数的程序要求我禁用预编译的标头（我不确定这是否是一个问题）。所以我基本上要问的是，有没有办法通过串行端口传输变量，如果有，最简单的方法是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:14:59.647

预编译的头文件并不是真正的问题 - 如果您直接在项目中包含其他代码而不是构建库，您可能必须将其添加`#include stdaxf.h`到该代码中，或者您可以简单地将 .h 和 .cpp 文件直接包含到您的代码中文件。

如果您想[直接在win32 中与串口通信，](http://msdn.microsoft.com/en-us/library/ms810467.aspx)这很容易。最大的问题是处理线程并等待新数据到达 - 但如果您只想发送并坐在那里等待响应，这很容易

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:32:18.963

这是 msdn 文档中函数 recvfrom() 的链接。还包含一个样本。[http://msdn.microsoft.com/en-us/library/windows/desktop/ms740120%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740120%28v=vs.85%29.aspx) 我在VS2010中编译没有任何问题。

只需确保您的 cpp 文件中的第一行是

```
#include "stdafx.h" 
```

否则你会遇到各种编译器和链接错误。如果您按照我之前写的内容进行操作，则预编译的标头不是问题。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:32:50.883

您可以使用 qextserialport 库与 QT 进行串行通信。

# dynamic - 来自弱引用游标的表达式类型错误

> ID：10033686
> 
> 赞同：1
> 
> 时间：2012-04-05T18:06:56.997
> 
> 标签：dynamic, plsql, oracle10g, ref-cursor

我正在尝试获取一个引用游标来运行动态查询并返回结果。这是我正在尝试做的一个例子：

```
DECLARE
    TYPE CUR_DATA IS REF CURSOR;
    OUT_DATA CUR_DATA;
    SQL_Statement       NVARCHAR2(8000);
BEGIN
    SQL_Statement := ' SELECT * FROM dual ';        
    OPEN OUT_DATA FOR SQL_Statement;
END; 
```

为什么这会给我一个错误提示：表达式类型错误？这个引用游标是弱类型的，不是吗？帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:28:41.873

在 Oracle 文档中提到`Select`Statement 支持`CHAR`, `VARCHAR2`, 或`CLOB`( `not NCHAR or NVARCHAR2`)。如果你想实现，`NVARCHAR`那么我知道的唯一解决方案是`translate` 使用`CHAR_CS`参数将 char 转换为数据库字符集。输出数据类型是`VARCHAR2`.

```
DECLARE
    TYPE CUR_DATA IS REF CURSOR;
    OUT_DATA CUR_DATA;
    SQL_Statement       NVARCHAR2(4000); --declare this as VARCHAR2
    SQL_Statement_var       VARCHAR2(4000);
BEGIN
    SQL_Statement := N'SELECT * FROM dual ';        
    SQL_Statement_var := TRANSLATE(SQL_Statement USING CHAR_CS);
    OPEN OUT_DATA FOR SQL_Statement_var;
END; 
```

`No errors.`

如果`NVARCHAR2`不是强制性的，则尝试使用提供的基本数据类型进行创建。

```
DECLARE
    TYPE CUR_DATA IS REF CURSOR;
    OUT_DATA CUR_DATA;
    SQL_Statement       VARCHAR2(4000); --declare this as VARCHAR2
BEGIN
    SQL_Statement := ' SELECT * FROM dual ';        
    OPEN OUT_DATA FOR SQL_Statement;
END; 
```

参考：

[翻译...使用](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions197.htm)

[开放供声明](http://docs.oracle.com/cd/B28359_01/appdev.111/b28370/openfor_statement.htm)

# exception - 空气制动的开源替代品？

> ID：10033688
> 
> 赞同：33
> 
> 时间：2012-04-05T18:07:03.530
> 
> 标签：exception, error-logging, airbrake

是否有系统的替代开源版本，例如[http://airbrake.io/pages/home](http://airbrake.io/pages/home)

我会使用 airbrake，但它纯粹用于内部软件和异常管理

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-04-13T22:01:49.033

就在这里。这是[https://github.com/errbit/errbit](https://github.com/errbit/errbit)；它完全符合我们的通知器/API。

如果您是一家大公司，我们会提供 Airbrake 的托管版本。

问候，来自 Airbrake 的 Ben。

# javascript - soundmanager2 IE 播放问题

> ID：10033694
> 
> 赞同：0
> 
> 时间：2012-04-05T18:07:37.250
> 
> 标签：javascript, html, flash

我目前正在 IE/flash 上下文（不是 html5）中使用 soundmanager2。问题是在以下情况下，不会发生 mp3 内容的音频播放，其中“onload”回调函数被定义为 null 或作为几乎什么都不做的函数。

```
soundManager.createSound({
               id: 'someidforasoundfile',
               url: 'pathtoaudiofile.mp3',
               autoLoad: true,
               autoPlay: true,
               onload: function() {
                               return 1;
               },
               volume: 50
}); 
```

如果我将“onload”回调定义为：

```
function() { alert('zing'); } 
```

soundmanager2 实际上会开始播放音频文件……但是会弹出一个恼人的警报，用户必须应对。

这是 soundmanager2 配置问题还是其他问题？

提前致谢！

ct

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T07:37:51.207

我认为我的理解是，当用户指示流时，会有消息警报指示歌曲正在开始，或者他们必须获得许可。

我会说它的声音管理器，因为 flash 可以在没有任何“用户”权限的情况下流式传输或下载媒体内容。这当然是受限/受限于：示例 mp3、视频、其他 SWF 文件.ect

但是说下载 zipfile 或其他媒体类型可能需要权限。

他们可能在（警报）函数中创建此消息或弹出出现，检查该源代码并遵循其脚本。

如果您有一些源代码，请发布我会看看它

# r - R识别符号变化之前的一行

> ID：10033696
> 
> 赞同：7
> 
> 时间：2012-04-05T18:07:46.990
> 
> 标签：r

我有一个向量：

```
df <- c(5,9,-8,-7,-1) 
```

如何在符号更改之前识别位置？IE`df[2]`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-05T18:14:25.820

这很简单，如果你知道这个`sign`功能......

```
which(diff(sign(df))!=0)
# [1] 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:16:48.657

我更喜欢 Joshua 的回答，但这里有一个更复杂的替代方案，只是为了好玩：

```
head(cumsum(rle(sign(df))$lengths),-1) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-05T18:20:23.787

如果你想成为一个可怕的人，你总是可以使用 for 循环：

```
signchange <- function(x) {
    index = 0
    for(i in 1:length(x))
    {
        if(x[i] < 0)
        {
            return (index)
        }
        else
        {
            index = index + 1
        }
    }
    return (index)
} 
```

# asp.net - 接收焦点时更改文本框背景 (asp.net)

> ID：10033700
> 
> 赞同：0
> 
> 时间：2012-04-05T18:07:59.010
> 
> 标签：asp.net

我想在收到焦点时重置文本框的背景图像。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:04:09.700

像这样的东西应该工作：

```
$("input").focus(function(){
    $("input").css("background-color","#FFFFCC"); //adjust for background-image
});
$("input").blur(function(){
    $("input").css("background-color","#ffffff"); //adjust for background-image
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:15:32.673

如果“重置”意味着永久清除背景图像，则需要通过 javascript 事件来操作 CSS。

例如，如果你使用 jQuery - 你可以这样做：

```
$('input#some_id').focus(
  function(){ 
    $(this).css('background-image', 'none'); 
  }
); 
```

其他 JS 库也有类似的功能。如果您还没有使用 JS 库，您可能需要认真考虑一下。

如果您只是需要暂时“重置”直到焦点离开，您可以使用 ':focus' css 伪类，如下所示：

```
input#some_id:focus
{
    background-image: none;
} 
```

# jquery - jQuery从链接列表中提取文本

> ID：10033702
> 
> 赞同：0
> 
> 时间：2012-04-05T18:08:05.730
> 
> 标签：jquery

我正在尝试使用 jQuery 搜索链接列表并从与条件匹配的链接中获取文本。这是一个示例结构：

```
<div class="shortcut_box">
    <p>Select a category</p>
    <ul id="select_nav">
    <li><a href="doing-business/directory/#acupuncture">Acupuncture</a></li>
    <li><a href="doing-business/directory/#advertising">Advertising</a></li>
    <li><a href="doing-business/directory/#apparel">Clothing and Apparel</a></li>
    <li><a href="doing-business/directory/#automotive">Automotive</a></li>
    </ul>
</div>
<h3 id="index_heading"></h3>​ 
```

有一个脚本可以将变量设置为哈希标记之后的字符串（例如“apparel”）。我想使用该变量，在列表中搜索带有以“服装”结尾的链接的项目，并将 H3 标记设置为“服装和服装”。

该变量是在鼠标点击时设置的，但也是通过在页面加载时检查 url 来设置的，所以我不能使用基于鼠标点击的函数。

这是我一直在玩但不起作用的一些代码：

```
// manually set url variable for testing
url = 'apparel';
$('#index_heading').html($("#select_nav a[value.match(/url$/)]").text()); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:14:11.753

您可能想尝试使您的正则表达式不区分大小写`/url$/i`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:17:16.770

试试这个：

```
// manually set url variable for testing
url = 'apparel';
var wantedId = "";

$('a').each(function() {
    if($(this).attr("href").split("#")[1] == url) {
        wantedId=$(this).id;
    }
});​​

$('#index_heading').html($("#" + wantedId).text()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:17:23.573

使用[jQuery 的 Attribute contains](http://api.jquery.com/attribute-contains-selector/)选择器，您的代码应该可以工作：

```
url = 'apparel';
$('#index_heading').html($("#select_nav a[href*='"+url+"']").text());​​​​​​​​​​​​​​​​ 
```

在这里演示：http: [//jsfiddle.net/5WqVz/](http://jsfiddle.net/5WqVz/)

# iphone - xCode 4.3.2 - 了解添加到目标

> ID：10033706
> 
> 赞同：1
> 
> 时间：2012-04-05T18:08:11.117
> 
> 标签：iphone, xcode, sqlite, sdk, target

我有一个包含 SQLite 数据库的应用程序。我刚刚升级到 Lion 和 xCode 4.3.2，当我现在在 xCode 中拖放新版本的数据库时，我得到一个框，询问我是否要“将文件添加到目标”。

默认情况下不勾选该框。这是正确的还是我应该向目标添加一个 SQLite 数据库（这是什么意思）？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:26:30.477

> 目标指定要构建的产品，并包含从项目或工作区中的一组文件构建产品的说明 - ( [Apple's Documentation](http://developer.apple.com/library/ios/#featuredarticles/XcodeConcepts/Concept-Targets.html) )

由于您的项目可能包含多个目标（产品），XCode 基本上会询问您是否要将此资产包含在目标中（以便可以访问它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:10:56.267

当然，您应该将 SQLite 文件添加到要使用它的目标中。这意味着您要将文件附加到指定的目标，如果目标很多，您可能希望将特定文件添加到特定目标。

# c# - 我应该使用线程还是任务 - 多客户端模拟

> ID：10033713
> 
> 赞同：11
> 
> 时间：2012-04-05T18:08:35.620
> 
> 标签：c#, multithreading, task-parallel-library, simulation

我正在编写一个客户端模拟程序，其中所有模拟客户端针对服务器运行一些预定义的例程 - 这是一个在 azure 中运行的具有四个实例的 Web 服务器。

所有模拟客户端在连接到服务器后运行相同的例程。

在任何时候，我都想使用我的程序模拟 300 到 800 个客户。

我的问题是：我应该创建 N 个客户端类实例并在 N 个不同的线程中运行它们吗？或者

我应该使用任务库来做这些事情吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-05T19:13:51.847

您当然不应该创建 800 个线程。

让我们退后一步。您有一个称为“服务器”的设备，它接收来自“客户端”的“请求”并将“响应”发送回这些客户端。假设请求是邮局投递的纸张，响应是包含书籍的盒子，也是邮局投递的。

您希望*模拟*800 个客户端以测试服务器。

假设线程是人，处理器是椅子。一个人只能坐在椅子上工作。

创建 800 个线程相当于出去雇佣 800 人，然后付钱给每个人发一封信给服务器。但是你只有四把椅子，所以这 800 个人必须轮流使用椅子。

这在现实生活中将是一个*可笑的解决方案。*线程，就*像人一样，非常昂贵*。您应该尽量减少创建的线程数。

那么，您是否应该改为通过任务工厂创建 800 个任务并让 TPL 为您并行化它们？

不，你也不应该那样做。TPL 有一群人（线程）可供借鉴，它试图安排事情，使工资单上的人不超过可供他们坐的椅子。但你的任务不是“受椅子限制” - - 人们将坐在椅子上，将请求发送到服务器，然后在等待响应返回时离开椅子。**在他们等待的同时，TPL 现在不得不雇佣更多的人来服务额外的任务。**

访问 Web 服务器是 I/O 绑定的；**您应该只为受 CPU 限制的任务创建线程池任务。**

正确的解决方案是雇用*两个*人。

一个人——“I/O 完成线程”——除了将请求放入邮箱并检查传入的包之外什么都不做。另一个人——“模拟”人——计算出模拟 800 个客户的正确“时间表”。模拟人制定时间表，然后睡觉。当需要向服务器发送另一个请求时，她会醒来。当她醒来时，她告诉 I/O 完成线程将这封信放入邮箱中，并在收到响应时唤醒她。然后她再次进入睡眠状态，直到该发送另一个请求或响应的时间了进来，需要验证。

您应该做的是（1）获取 C# 5 的 beta 版本并用于`async/await`创建向服务器发送请求的任务，然后将控制权交还给消息循环，直到该发送另一个请求或响应来了或者，如果您不想使用 C# 5，您应该创建一个任务完成源，并设置具有正确延续的任务。

简而言之：处理许多并行 I/O 任务的正确方法是创建非常少量的线程，每个线程一次只做非常少量的工作。让 I/O 完成线程处理 I/O 的细节。**你不需要雇佣 800 人来模拟发送 800 封信。** 雇*两个*人，一个看信箱，一个写信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:51:49.783

在这种情况下，答案并不是那么简单。这实际上取决于您希望如何模拟您的客户：

1.  如果您想连接 800 个客户端，但不一定同时连接，那么使用`Task`s 是个好主意。它们是轻量级的，并且可以有效地利用底层`ThreadPool`.

2.  如果您真的希望客户端完全并行，恐怕没有办法真正避免线程。没有什么神奇的方法可以同时执行 800 个轻量级任务。抽象是轻量级的`Task`，正是因为它使用了线程池。这意味着许多任务被映射到少量的实际线程。但是，当然，这意味着它们并不是真正并行运行，而是尽可能安排运行。的最大线程数为 250（AFAIK），因此如果您使用s `ThreadPool`，一次实际执行的“客户端”不会超过 250 个。`Task`解决方案是将最大线程数设置为 800，但此时它与使用经典线程相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T18:12:35.577

我会使用任务库，让任务库为您处理所有线程。您不想启动 800 个线程。一次同时运行这么多线程是个坏主意，这是另一个讨论这个问题的堆栈溢出问题：[.NET 应用程序中的最大线程数？](https://stackoverflow.com/questions/145312/maximum-number-of-threads-in-a-net-app)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T18:56:56.953

对于这个[*应用程序域*](http://msdn.microsoft.com/en-us/library/cxk374d9%28v=vs.71%29.aspx)是你最好的选择。

应用*程序域*是 .NET 应用程序在其中执行的运行时隔离单元。它提供托管内存边界、应用程序配置设置容器以及为分布式应用程序提供通信接口。

每个 .NET 应用程序通常只承载一个应用程序域，该域由 CLR 在给定进程/程序启动时自动创建。在单个进程/程序中创建其他应用程序域有时很有用（在您的情况下）。使用多个应用程序域可以避免通信复杂性，并使用多个单独的进程出现，并提供任务隔离。

对于你想要的，你有两个选择。

1.  在同一域中的单独线程上启动 X 线程。

这将意味着您将不得不非常厌倦线程安全，这对于模拟多个登录、模拟客户端等任务将非常困难。

1.  在同一进程中启动 X 个线程，每个线程在其自己的应用程序域中。

这将使每个旋转线程保持隔离，并且托管应用程序/程序也易于访问。通过让你们所有人在 X 个单独的应用程序域中进行 X 模拟，每个域将被隔离并且无法通过静态类成员等干扰另一个客户端模拟。

*以下是 Joseph Albahari 的书[C# 4.0 In a Nutshell](http://www.albahari.com/nutshell/)的摘录的帮助，我强烈建议您获取：*

40 个并发客户端模拟的示例可能对您有用：

```
class program
{
    static void main()
    {
        // Create 40 domains and 40 threads.
        AppDomain[] domains = new AppDomain[40];
        Thread[] thread = new Thread[40];

        for (int i = 0; i < 40; i++)
        {
            domains[i] = AppDomain.CreateDomain("Client Simulation " + i);
            thread[i] = new Thread(SimulateClientInOtherDomain);
        }

        // Start all threads, passing to each thread its app domain.
        for (int j = 0; j < 40; j++)
            threads[j].Start(domains[j]);

        // Wait for the threads to finish.
        for (int k = 0; k < 40; k++)
            threads[k].Join();

        // Unload the application domains.
        for (int l = 0; l < 40; l++)
            AppDomain.Unload(domains[l]);
    }

    // Thread start with input of with domain to run on/in.
    static void SimulateClientInOtherDomain(object domain)
    {
        ((AppDomain)domain).DoCallBack(Simulate);
    }

    static void Simulate()
    {
       Client simClient1 = new Client("Bill", "Gates", ...);
       simClient1.Simulate();
    }
} 
```

我希望这有帮助。

# php - 用逗号分隔的 POST 搜索 Mysql

> ID：10033714
> 
> 赞同：-2
> 
> 时间：2012-04-05T18:08:40.533
> 
> 标签：php, mysql

我正在搜索 POST 的位置：sok3 = 0,2,6

然后，我想从 table2 中选择与此 POST(sok3) 匹配的所有用户，其中列可能是这样的：

表格1：

```
id|name
1 |myname 
```

表2：

```
id|uid|sok3
0 |1  |0
1 |1  |2
2 |1  |4
3 |1  |6
4 |6  |1
5 |6  |2
6 |6  |4 
```

我尝试过：

```
SELECT * from table1 as tab1 LEFT JOIN table2 as tab2 ON(tab2.uid = tab1.id) Where .. 
```

我得到的结果是 3 场比赛。但我只想要 1 个结果，其中有匹配项。如果 0 则匹配，如果 0,2 则匹配等。

我知道我什至不搜索帖子..只是不知道如何解决它：/

我该如何解决这个问题？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:20:43.530

在查询中使用 SELECT DISTINCT 名称或 GROUP BY 名称

# c# - 结合 RFID 阅读器在 arduino 中接收 USB 串行数据

> ID：10033715
> 
> 赞同：0
> 
> 时间：2012-04-05T18:08:44.330
> 
> 标签：c#, c, serial-port, arduino

我正在做一个 Arduino 项目。扫描 RFID 标签时，Arduino 板会将时间戳和 RFID 代码保存到 ROM 中。RFID 数据已被接收，`Serial.read()`但现在我需要将存储的数据从我的 Arduino ROM 获取到我的计算机。

为此，我必须读取串行数据（在本例中使用 C#）并且工作正常。但是因为我的 Arduino 板需要知道何时将数据写入串口，所以我首先需要向 Arduino 板发送命令。

使用 Arduino IDE 的“串行监视器”，我尝试发送一些数据，但 Arduino 没有收到它。当我在 RFID 前面放置一个 RFID 标签时，Arduino 板确实接收到数据。所以在我看来，RFID阅读器以某种方式保留了串行端口输入？这甚至可能吗？

有人知道我的问题的解决方案吗？请注意，这是我的第一个 Arduino 项目，C 对我来说是新的。

一些信息：

*   Arduino UNO
*   RFID 阅读器：创新 ID12
*   RTC 时钟模块
*   C
*   C＃
*   。网

下面的代码是整个 Arduino 项目。

```
#include "Wire.h"
#include <EEPROM.h>
#include "EEPROMAnything.h"

#define DS1307_ADDRESS 0x68
byte   zero = 0; //workaround for issue #527
int    buttonState = 0;
byte   value;
int    byteaddress = 0;
int    bytesize = 0;
int    lastTag = 0;
byte   incomingByte;

struct config_t
{
    int seconds;
    int hours;
    int minutes;
} timestamp;

int  RFIDResetPin = 13;

//Register your RFID tags here
char tag1[13] = "03000DEB55B0";
char tag2[13] = "03000DB88137";
char tag3[13] = "03000DC8E026";
char tag4[13] = "03000623FBDD";
char tag5[13] = "03000DB8B701";

void setup()
{
  pinMode(7, INPUT);
  Wire.begin();

  Serial.begin(9600);

  pinMode(RFIDResetPin, OUTPUT);
  digitalWrite(RFIDResetPin, HIGH);

  EEPROM_readAnything(0, timestamp);
  setDateTime(); //MUST CONFIGURE IN FUNCTION

  pinMode(11, OUTPUT);
}

void loop()
{
  buttonState = digitalRead(7);

  char tagString[13];
  int index = 0;
  boolean reading = false;

  if (buttonState == HIGH) {   
    // turn LED on:    
    printDate(); 
    delay(200);
  }

  while(Serial.available()){

    buttonState = digitalRead(7);

    int readByte = Serial.read(); //read next available byte

    if(readByte == 2) reading = true; //begining of tag
    if(readByte == 3) reading = false; //end of tag

    if(reading && readByte != 2 && readByte != 10 && readByte != 13){
      //store the tag
      tagString[index] = readByte;
      index ++;
    }

    incomingByte = Serial.read();
    Serial.println(incomingByte);
  }

  checkTag(tagString); //Check if it is a match
  clearTag(tagString); //Clear the char of all value
  resetReader(); //eset the RFID reader
}

void checkTag(char tag[]){
///////////////////////////////////
//Check the read tag against known tags
///////////////////////////////////

  int currentTag = 0;

  if(strlen(tag) == 0 || strlen(tag) < 12)
     return; //empty, no need to continue

  if(compareTag(tag, tag1) && lastTag != 1){ // if matched tag1, do   this
    Serial.println("Scanned tag 1");
    lastTag = 1;
    currentTag = 1;
    printDate();
    bleepSucces(11);
  }
  else
  if(compareTag(tag, tag2) && lastTag != 2){ //if matched tag2, do this
    Serial.println("Scanned tag 2");
    lastTag = 2;
    currentTag = 2;
    printDate();
    bleepSucces(11);
  }
  else
  if(compareTag(tag, tag3) && lastTag != 3){
    Serial.println("Scanned tag 3");
    lastTag = 3;
    currentTag = 3;
    printDate();
    bleepSucces(11);
  }
  else
  if(compareTag(tag, tag4) && lastTag != 4){
    Serial.println("Scanned tag 4");
    lastTag = 4;
    currentTag = 4;
    printDate();
    bleepSucces(11);
  }
  else
  if(compareTag(tag, tag5) && lastTag != 5){
    Serial.println("Scanned tag 5");
    lastTag = 5;
    currentTag = 5;
    printDate();
    bleepSucces(11);
  }
  else
  {
    if(currentTag == 0 && lastTag == 0){
      Serial.println("Unknown Tag, see below:");
      Serial.println(tag); //read out any unknown tag
      //resetReader();
      lastTag = 0;
      bleepFail(11);
    }
    return;
  }
}

void bleepSucces(int pin)
{
  digitalWrite(pin, HIGH);
  delay(300);
  digitalWrite(pin, LOW);
  delay(20);
  digitalWrite(pin, HIGH);
  delay(150);
  digitalWrite(pin, LOW);
}

void bleepFail(int pin)
{
  digitalWrite(pin, HIGH);
  delay(1200);
  digitalWrite(pin, LOW);
}

void resetReader()
{    //Reset the RFID reader to read again.
  digitalWrite(RFIDResetPin, LOW);
  digitalWrite(RFIDResetPin, HIGH);
  delay(150);
}

void clearTag(char one[])
{
//clear the char array by filling with null - ASCII 0
//Will think same tag has been read otherwise
  for(int i = 0; i < strlen(one); i++)
    one[i] = 0;
}

boolean compareTag(char one[], char two[])
{ //compare two tags to see if same,
  //strcmp not working 100% so we do this

  if (strlen(one) == 0)
     return false; //empty

  for(int i = 0; i < 12; i++){
    if(one[i] != two[i])
      return false;
  }
  return true; //no mismatches
}

void setDateTime()
{
  byte second =      20; //0-59
  byte minute =      37; //0-59
  byte hour =        20; //0-23
  byte weekDay =     2; //1-7
  byte monthDay =    3; //1-31
  byte month =       4; //1-12
  byte year  =       12; //0-99

  Wire.beginTransmission(DS1307_ADDRESS);
  Wire.write(zero); //stop Oscillator

  Wire.write(decToBcd(second));
  Wire.write(decToBcd(minute));
  Wire.write(decToBcd(hour));
  Wire.write(decToBcd(weekDay));
  Wire.write(decToBcd(monthDay));
  Wire.write(decToBcd(month));
  Wire.write(decToBcd(year));

  Wire.write(zero); //start 

  Wire.endTransmission();
}

byte decToBcd(byte val)
{  // Convert normal decimal numbers to binary coded decimal
  return val / 10 * 16  +  val % 10;
}

byte bcdToDec(byte val)
{  // Convert binary coded decimal to normal decimal numbers
  return val / 16 * 10  +  val % 16;
}

void printDate()
{
  // Reset the register pointer
  Wire.beginTransmission(DS1307_ADDRESS);
  Wire.write(zero);
  Wire.endTransmission();

  Wire.requestFrom(DS1307_ADDRESS, 7);

  int second = bcdToDec(Wire.read());
  int minute = bcdToDec(Wire.read());
  int hour = bcdToDec(Wire.read() & 0b111111); //24 hour time
  int weekDay = bcdToDec(Wire.read()); //0-6 -> sunday - Saturday
  int monthDay = bcdToDec(Wire.read());
  int month = bcdToDec(Wire.read());
  int year = bcdToDec(Wire.read());

  //Set variables in our struct
  timestamp.hours = hour;
  timestamp.minutes = minute;
  timestamp.seconds = second;

  //Save the timestamp to EEPROM
  bytesize = EEPROM_writeAnything(byteaddress, timestamp);
  byteaddress = byteaddress + bytesize;

  //if (Serial.available() > 0) {
    writeSerial();
  //}
}

void writeSerial()
{  
  Serial.print("{");
  // read a byte from the current address of the EEPROM
  for (int i=0; i <= byteaddress + 4; i = i + 2){
      value = EEPROM.read(i);
      Serial.print(value, DEC);

      if (i < byteaddress+4)
         Serial.print(((i-1)%3 == 0) ? ", " : " ");
  }
  Serial.println("}");     
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:03:13.323

arduino UNO 只有 1 个串口，pin 0 和 1 实际上连接到 usb 端口。

您将需要使用[softwareserial](http://arduino.cc/hu/Reference/SoftwareSerial)在软件中创建一个串行端口来与您的 RFID 阅读器通信，并将 RFID 阅读器连接到其他引脚，然后是 0 和 1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T07:13:02.473

Sibster 是正确的引脚 0 和 1 用于硬件串行和 USB 连接到 PC。对 RFID 使用 SPI、I2c 或软件串行（取决于您所拥有的）。此外，您可能最好使用 SD 卡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T01:40:57.280

当您从 arduino ide 读取时，如果
您输入 a`'2'`实际上等于`50`.`('0'==48)`

尝试将`if`语句更改为`readByte != '2'`

除非你输入某种控制字符实际上等于`2`.

# java - 如何在 Spring MVC 中验证我的域对象上的对象字段？

> ID：10033716
> 
> 赞同：1
> 
> 时间：2012-04-05T18:08:53.233
> 
> 标签：java, validation, spring-mvc, annotations

我有一个对象`Foo`，它包含对 object 的引用，`Bar`该引用具有对 object 的引用`Baz`，并且为了`Foo`有效，`Bar`必须对`Baz`.

问题是它`Bar` *不需要*有效的、非 null`Baz`的有效，所以我不能简单地将验证放在那里，我需要它在`Foo`.

这是我正在谈论的类结构的简单伪版本：

```
class Foo {
    // Bar needs to have a valid Baz. Something like this would be ideal:
    // @HasAValidBaz(message="Baz is required")
    Bar bar;   
}

class Bar {
    // Baz can be null and Bar will still be valid
    // But if there _is_ a Baz, it needs to be valid
    Baz baz;
}

class Baz {
    @NotBlank(message="My String is required")
    String myString;
} 
```

我知道我可以使用类级自定义验证注释来做到这一点，但问题是这些错误对象和相应的消息适用于类实例而不是字段实例，我需要能够轻松地在旁边显示错误消息正确的表单域。

有没有一种好方法可以做到这一点，还是我坚持在控制器中实现这个验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:46:47.973

注释很好，但在这种情况下可能不合适。问题是注释是在实际类上标记的，这意味着你不能在同一个类上真正有两种类型的验证注释——这似乎是你的问题。使用老式的 Spring MVC 方法来实现 Spring Validator 类可能更适合您。这是一个例子：

```
public class FooValidator implements Validator {

    @Override
    public boolean supports(Class<?> clazz) {
        return Foo.class.equals(clazz);
    }

    @Override
    public void validate(Object target, Errors errors) {

        Foo foo = (Foo) target;

        if(foo.getBar() == null) {
            errors.rejectValue("bar", "bar[emptyMessage]");
        }
        else if(foo.getBar().getBaz() == null){
            errors.rejectValue("bar.baz", "bar.baz[emptyMessage]");
        }
    }
} 
```

而且您的 Spring 控制器仍然与使用注释几乎相同：

```
@Controller
public class FooController {

    @InitBinder("foo")
    protected void initBinder(WebDataBinder binder) {
        binder.setValidator(new FooValidator());
    }

    @RequestMapping(value="fooPage", method = RequestMethod.POST)
    public String processSubmit(@Valid Foo foo, BindingResult result, ModelMap m) {
        if(result.hasErrors()) {
            return "fooPage";
        }
        ...
        return "successPage";
    }
} 
```

# php - 引号 (“„) 和其他特殊字符的 PHP 编码问题

> ID：10033719
> 
> 赞同：0
> 
> 时间：2012-04-05T18:08:59.027
> 
> 标签：php, mysql, encoding, utf-8, internationalization

我在德国网站上的编码有问题。我有一段文字：

> “Eröffnungsfeier FIS 高山滑雪 WM 2011”</p>

当此文本保存到数据库中时，我得到了？而不是那些引号。

我试过放置

```
header("Content-Type: text/html; charset=utf-8");
mb_internal_encoding("UTF-8");
setlocale(LC_ALL, 'de_DE.utf-8'); 
```

在文件的顶部没有成功。

当我用过

```
mysql_set_charset('utf8', $connect); 
```

但是，当在到达第一个字符（如 ö）后在上面插入文本时，文本的其余部分将被删除。

表字符集和排序规则是 UTF-8。脚本文件保存为没有 BOM 的 UTF-8。

我不知道在哪里看。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:15:51.137

1) 检查您的数据库的架构 - 文本字段是否设置为存储 utf-8？

2) 听起来*发布*到此脚本的页面没有发送 UTF-8。它有正确的`Content-Type`标题吗？显示什么`echo urlencode($var)`？（这是查看您获得的原始字节的巧妙技巧）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T08:26:25.433

The things I did helped. Especially `mysql_set_charset('utf8', $connect);`. The problem was that there was some unwanted code left by another programmer (utf8_decode). Looks like he couldn't deal with utf-8 encoding other way.

I've also found out that `mysql_set_charset('utf8', $connect);` is not really needed if you're consistent with the encoding from the beginning.

# java - 可以'java中的静态方法，它返回null

> ID：10033721
> 
> 赞同：-1
> 
> 时间：2012-04-05T18:09:06.377
> 
> 标签：java, static-methods

我正在尝试访问我创建的 Utils 类中的静态方法：

```
 public class Utils{

 public static Date convertToDate(String dateString, String dFormat){

    SimpleDateFormat dateFormat = new SimpleDateFormat(dFormat, Locale.US);

    Date convertedDate;
    try {
        convertedDate = dateFormat.parse(dateString);
        Log.i("date", "convertedDate =  " + convertedDate);

    } catch (ParseException e) {
        e.printStackTrace();
        return null;
    }

    return convertedDate;

}
 } 
```

当我尝试像这样访问此方法时：

```
 Utils.convertToDate("03-04-2012", "mm-dd-yyyy"); 
```

我得到一个空指针异常。

这怎么可能？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:10:52.150

我的猜测是抛出异常的不是*那个*方法-而是它返回 null 并且您正在使用返回值的事实，如下所示：

```
Date date = Utils.convertToDate("03-04-2012", "mm-dd-yyyy");
System.out.println(date.toString()); 
```

这就是有效地吞下异常并假装没有问题的问题。请注意，您的格式应该是“MM-dd-yyyy”而不是“mm-dd-yyyy”。`convertedDate`另请注意，如果您在`try`块中声明并返回它，而不是在返回之前等待从块中出来，您的代码会更简单`try`。

（说了这么多，我没*想到*代码会抛出异常。它不会给你想要的值，但实际解析应该没问题......如果你能产生一个简短但完整的演示问题的程序，这真的很有帮助。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:11:56.480

改用这个：

```
Utils.convertToDate("03-04-2012", "MM-dd-yyyy"); 
```

since`mm`代表分钟，while`MM`代表月份。

# jquery - jQuery .each() 或其他方法。我应该使用哪个？

> ID：10033725
> 
> 赞同：-1
> 
> 时间：2012-04-05T18:09:30.270
> 
> 标签：jquery, jquery-ui-slider

我们有两个使用 jQuery Reel 插件的 360 查看器。两者使用类在同一页面上旋转得很好。我们使用 jQuery UI 设置了缩放功能和旋转滑块。问题是我们无法让每个滑块或缩放按钮来控制其父图像。任何人都可以帮忙吗？谢谢，网址是[http://www.dmns.org/test/jquery-360/index.html](http://www.dmns.org/test/jquery-360/index.html)。任何帮助表示赞赏。代码如下。

```
 var zoomAmount = 100;
 var originalHeight = 0;
 var originalWidth = 0;
// Slide Bar for the "Zoom" control
var zoomSlider;
var totalFrames;
var isObjectRotatingViaSlider = false;
var isObjectZoomingViaSlider = false;
var maxZoomAmount = 2;
var image = $('.image');

$(document).ready(function () {
var images = $('.imageSequence').attr('value');
var imgArray = images.split(',');
totalFrames = imgArray.length;
originalHeight = $('.image').height();
originalWidth = $('.image').width();
var image = $('.image');
image.reel(
{
    brake: 1,
    frames: totalFrames,
    images: imgArray,
    //preload: totalFrames,
    cw: true,
    hint: "Click and drag",
    clickfree: false,
    preloader: 20

});

 //  var wrappingDiv = $('.example');
//$(wrappingDiv).each(function () {
    $('.ZoomIn').on('click', function (e) {
        ZoomIn();
        e.preventDefault();
    });
    $('.ZoomOut').on('click', function (e) {
        ZoomOut();
        e.preventDefault();
    });
    $('.DefaultSize').on('click', function (e) {
        e.preventDefault();
        DefaultSize();

    });

//});//End Each

//iPad check to show or hide sliders
var isiPad = navigator.userAgent.match(/iPad/i) != null;
var isiPhoneOriPod = (navigator.userAgent.match(/iPhone/i)) ||  (navigator.userAgent.match(/iPod/i))
var ua = navigator.userAgent.toLowerCase();
var isAndroid = ua.indexOf("android") > -1; //&& ua.indexOf("mobile");
if (!isiPad && !isAndroid && !isiPhoneOriPod) {
    // alert('not iPad');
    $(".viewerSlider, .instructionMessaging, .desktopMessage").show();
    //Rotation sliders
    ReadyRotationSlider();
    ReadyZoomSlider();
    SetUpTimer();
} else if (isiPad || isAndroid || isiPhoneOriPod) {
    $('.viewerSlider').hide();
    $(".viewerSlider, .instructionMessaging, .mobileMessage").show();
    //alert('is an iPad, Android, or iPhone or iPod');
}
else {
    alert('is an something else');
    $('.viewerSlider').show();
}
//maybe get this to play
$('button').on("click", function () {
    image.trigger("play");
});

}); //End doc ready

function ZoomIn() {

// Zoom in Image but keep borders the same
var newWidth = $('.image').width() + zoomAmount;
var newHeight = $('.image').height() + zoomAmount;

//Move and zoom the image
var newX = (originalHeight - newHeight) / 2;
var newY = (originalWidth - newWidth) / 2;

$('.imgHolder').find('img').stop(false, true).animate({ 'width': newWidth, 'height': newHeight, 'top': newX, 'left': newY }, { duration: 200 });
}

function ZoomOut() {
// Zoom in Image but keep borders the same
var newWidth = $('.image').width() - zoomAmount;
var newHeight = $('.image').height() - zoomAmount;

if (newHeight <= originalHeight || newWidth <= originalWidth) {
    newHeight = originalHeight;
    newWidth = originalWidth;
}

var newX = (originalHeight - newHeight) / 2;
var newY = (originalWidth - newWidth) / 2;

$('.imgHolder').find('img').stop(false, true).animate({ 'width': newWidth, 'height':  newHeight, 'top': newX, 'left': newY }, { duration: 200 });
 }

 function DefaultSize() {
$('.imgHolder').find('img').stop(false, true).animate({ 'width': originalWidth,  'height': originalHeight, 'top': 0, 'left': 0 }, { duration: 200 });
 }

 function FreeZoom(amount) {

// Zoom in Image but keep borders the same
var newWidth = originalWidth * ((100 + amount) / 100);
var newHeight = originalHeight * ((100 + amount) / 100);

var newX = (originalHeight - newHeight) / 2;
var newY = (originalWidth - newWidth) / 2;

$('.imgHolder').find('img').stop(false, true).animate({ 'width': newWidth, 'height': newHeight, 'top': newX, 'left': newY }, { duration: 200 });
}

 //Rotation Sliders

 function SetUpTimer() {
setInterval('UpdateImageViaSliders()', 50);
 }

function UpdateImageViaSliders() {
if (isObjectRotatingViaSlider) {
    RotateViaSlider($('.rotationSlider').slider("value"));
} else if (isObjectZoomingViaSlider) {
    FreeZoom($('.zoomSlider').slider("value"));
}
 }

function ReadyRotationSlider() {
$(".rotationSlider").slider({
    slide: function (event, ui) {
        isObjectRotatingViaSlider = true;
    },
    stop: function (event, ui) {
        isObjectRotatingViaSlider = false;
    }
});
}

function ReadyZoomSlider() {
$(".zoomSlider").slider({
    slide: function (event, ui) {
        isObjectZoomingViaSlider = true;
    },
    stop: function (event, ui) {
        isObjectZoomingViaSlider = false;
    }
});
 }

 function RotateViaSlider(rotateNumber) {
var newFrame = Math.floor((rotateNumber * totalFrames) / 100);
$('.image').trigger('frameChange', newFrame);
 } 
```

在 HTML 中，我有两组这样的。

```
<div class="example">
    <div class="block">
        <div class="imgHolder">
            <img class="image" src="images/smooshed150dpi/Kachina0001.png" height="448" width="360" />
        </div>
    </div>
    <div class="instructionMessaging">
        <p class="mobileMessage">
            Swipe to spin image</p>
        <p class="desktopMessage">
            Click and drag left and right to spin image</p>
    </div>
    <div class="controlsWrapper">
        <!--<div id="ZoomIn">
                        Zoom In
                    </div>-->
        <a href="#" class="ZoomIn controlBtn">(+) Zoom In</a>
        <!--<div id="ZoomOut">
                        Zoom Out
                    </div>-->
        <a href="#" class="ZoomOut controlBtn">(-) Zoom Out</a> <a href="#" class="DefaultSize controlBtn">
            Default size</a>
        <div class="viewerSlider">
            <span>Rotate</span>
            <div class="rotationSlider">
            </div>
        </div>
        <div class="viewerSlider">
            <span>Zoom</span><div class="zoomSlider">
            </div>
        </div>
    </div>
    <input type="hidden" class="imageSequence" name="imageSequence" value="images/smooshed150dpi/Kachina0001.png,images/smooshed150dpi/Kachina0002.png,images/smooshed150dpi/Kachina0003.png,images/smooshed150dpi/Kachina0004.png,images/smooshed150dpi/Kachina0005.png,images/smooshed150dpi/Kachina0006.png,images/smooshed150dpi/Kachina0007.png,images/smooshed150dpi/Kachina0008.png,images/smooshed150dpi/Kachina0009.png,images/smooshed150dpi/Kachina0010.png,images/smooshed150dpi/Kachina0011.png,images/smooshed150dpi/Kachina0012.png,images/smooshed150dpi/Kachina0013.png,images/smooshed150dpi/Kachina0014.png,images/smooshed150dpi/Kachina0015.png,images/smooshed150dpi/Kachina0016.png,images/smooshed150dpi/Kachina0017.png,images/smooshed150dpi/Kachina0018.png,images/smooshed150dpi/Kachina0019.png,images/smooshed150dpi/Kachina0020.png,images/smooshed150dpi/Kachina0021.png,images/smooshed150dpi/Kachina0022.png,images/smooshed150dpi/Kachina0023.png,images/smooshed150dpi/Kachina0024.png,images/smooshed150dpi/Kachina0025.png,images/smooshed150dpi/Kachina0026.png,images/smooshed150dpi/Kachina0027.png,images/smooshed150dpi/Kachina0028.png,images/smooshed150dpi/Kachina0029.png,images/smooshed150dpi/Kachina0030.png,images/smooshed150dpi/Kachina0031.png,images/smooshed150dpi/Kachina0032.png,images/smooshed150dpi/Kachina0033.png,images/smooshed150dpi/Kachina0034.png,images/smooshed150dpi/Kachina0035.png,images/smooshed150dpi/Kachina0036.png,images/smooshed150dpi/Kachina0037.png" />
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:37:36.433

控件只做他们被告知的事情：

```
$('.element').doStuff();
// doStuff is just a fake generic function 
```

控件正在查找具有“元素”类的所有元素并将更改应用于它们。在某些情况下，元素就是控件本身（例如，具有该类的所有控件`.ZoomIn`都做同样的事情......我的意思是完全相同的事情；就您要绑定的事件而言，它们充当彼此的副本）和在某些情况下，它是目标（例如，所有具有该类的图像都会`.image`受到影响）。

因此，要使其单独工作，您需要使用某种方式修改代码以区分它们。最简单的方法是将每组图像和控件包装在某种 Div 中。div 甚至不需要是唯一的，因为我们会将自己限制在其中。

一个通用示例可能如下所示：

```
$('.someButton').click(function() {
  var $this = $(this);
  var theImage = $this.closest('.parentDiv').find('.image'); // parentDiv is the classname of the mini wrapper
  theImage.doStuff(); // will only affect the image(s) inside the mini wrapper
}); 
```

修复整个插件超出了 Stack Overflow 答案的范围，但我希望这能让您了解出了什么问题。请记住，当您查看源代码时，选择器之类的选择器`$('.image')`将抓取具有该类名的所有节点。

# java - 有什么区别：使用 JPA @TableGenerator 的序列 ID，@GeneratedValue 与数据库 Auto_Increment

> ID：10033727
> 
> 赞同：14
> 
> 时间：2012-04-05T18:09:42.783
> 
> 标签：java, sql, sql-server, jpa, eclipselink

**Q1。**: 在数据库中使用序列 ID 有什么区别

**一个。**

```
CREATE TABLE Person
(
   id long NOT NULL AUTO_INCREMENT
   ...
   PRIMARY KEY (id)
) 
```

**相对**

**B.**

```
@Entity
public class Person {
    @Id
    @TableGenerator(name="TABLE_GEN", table="SEQUENCE_TABLE", pkColumnName="SEQ_NAME",
        valueColumnName="SEQ_COUNT", pkColumnValue="PERSON_SEQ")
    @GeneratedValue(strategy=GenerationType.TABLE, generator="TABLE_GEN")
    private long id;
    ...
} 
```

我的系统是**高度并发**的。由于我的数据库是 Microsoft SQL 服务器，我认为它不支持`@SequenceGenerator`，所以我必须坚持使用`@TableGenerator`容易出现并发问题的数据库。

**Q2。**此处的此链接（[http://en.wikibooks.org/wiki/Java_Persistence/Identity_and_Sequencing#Advanced_Sequencing](http://en.wikibooks.org/wiki/Java_Persistence/Identity_and_Sequencing#Advanced_Sequencing)）表明**B**可能会遇到并发问题，但我不理解建议的解决方案。如果有人能向我解释如何避免**B**的并发问题，我将不胜感激。这是他们解决方案的一个片段：

`If a large sequence pre-allocation size is used this becomes less of an issue, because the sequence table is rarely accessed.`

**Q2.1**：我们在这里谈论多少分配大小？我应该做`allocationSize=10`还是`allocationSize=100`？

`Some JPA providers use a separate (non-JTA) connection to allocate the sequence ids in, avoiding or limiting this issue. In this case, if you use a JTA data-source connection, it is important to also include a non-JTA data-source connection in your persistence.xml.`

**Q2.2**：我使用 EclipseLink 作为我的提供者；我必须按照上面的建议去做吗？

**Q3。**如果**B**遇到并发问题，**A**是否也会遇到同样的问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-10T14:59:14.940

A：使用 IDENTITY id 生成，`@GeneratedValue(IDENTITY)`

B：使用 TABLE id 生成

JPA 支持三种类型，`IDENTITY, SEQUENCE and TABLE.`

两者都有取舍。

IDENTITY 不允许预分配，因此在每次 INSERT 后需要额外的 SELECT，防止批量写入，并且需要刷新才能访问 id，这可能导致并发性差。

TABLE 允许预分配，但在序列表上的锁可能存在并发问题。

从技术上讲，SEQUENCE id 生成是最好的，但并非所有数据库都支持它。

使用 TABLE 排序，如果您使用 100 的 preallocaiton 大小，那么只有每 100 次插入才会锁定序列表中的行，因此只要您通常不会同时有 100 次插入，您就不会遭受任何损失并发。如果您的应用程序做了很多插入，可能使用 1000 或更大的值。

EclipseLink 将使用单独的事务进行 TABLE 排序，因此将减少任何与序列表锁定有关的并发问题。如果您使用的是 JTA，那么您需要指定一个非 jta 数据源来执行此操作并在您的 persistence.xml 属性中配置一个序列连接池。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-09T15:11:05.363

使用 TableGenerator 将在表中查找和维护下一个 id 值，并且基本上由 JPA 而不是您的数据库维护。当您有多个线程访问您的数据库并试图找出 id 字段的下一个值可能是什么时，这可能会导致并发问题。

auto_increment 类型将使您的数据库关心您的表的下一个 id，即。它将在运行插入时由数据库服务器自动确定——这肯定是并发安全的。

**更新：**

有什么东西让你远离使用 GenerationType.AUTO 吗？

GenerationType.AUTO 确实选择了一种适当的方式来检索您的实体的 id。所以在最好的情况下使用内置功能。但是，您需要检查生成的 SQL 并查看那里究竟发生了什么——因为 MSSQL 不提供序列，我假设它会使用 GenerationType.IDENTITY。

如前所述， auto_increment 列负责分配下一个 id 值，即。那里没有并发问题 - 即使有多个线程并行处理数据库。挑战在于将此功能转移给 JPA 使用。

# php - 在 PHP 中将字符串传递给 Javascript 函数 - 如何正确转义？

> ID：10033731
> 
> 赞同：1
> 
> 时间：2012-04-05T18:10:00.267
> 
> 标签：php, javascript, escaping, quote

我有以下代码：

```
echo '
    <td>    
        <input type="button" name="delete" value="X" onclick="clearSelection(this.form, '.$type.');this.form.submit();" />
    </td>'
; 
```

问题是我不能将字符串传递给`clearSelection()`Javascript 函数，因为`$type`需要放在括号中。

我用反斜杠、u0222、多引号等尝试了它，但没有什么能让我找到解决方案。

**解决方案：**

```
$type = json_escape_string($type);
$raw_text = "clearSelection(this.form, $type); this.form.submit();";
$escaped_text = htmlspecialchars($raw_text);
echo '<td><input type="button" name="delete" value="X" onclick="'.$escaped_text.'" /></td>';

function json_escape_string($str){
    $str = strtr($str, array('\\'=>'\\\\',"'"=>"\\'",'"'=>'\\"',"\r"=>'\\r',"\n"=>'\\n','</'=>'<\/'));
    return "'".$str."'";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:11:40.497

你需要先逃脱它：

```
$escaped_text = HtmlSpecialChars(json_encode($raw_text)); 
```

`json_encode()`将其转换为有效的 JS 字符串，然后将其`HtmlSpecialChars()`转义以在 HTML 属性中使用。

如果您有没有 json_encode() 的旧版本 PHP，请改用：

```
$escaped_text = HtmlSpecialChars(json_escape_string($raw_text));

function json_escape_string($str){
    $str = strtr($str, array('\\'=>'\\\\',"'"=>"\\'",'"'=>'\\"',"\r"=>'\\r',"\n"=>'\\n','</'=>'<\/'));
    return "'".$str."'";
} 
```

对于您的特定变量：

```
$escaped_type = HtmlSpecialChars(json_escape_string($type));
echo '<td><input type="button" name="delete" value="X" onclick="clearSelection(this.form, '.$escaped_type.'); this.form.submit();" /></td>'; 
```

# php - 使用 for 循环访问类变量

> ID：10033734
> 
> 赞同：3
> 
> 时间：2012-04-05T18:10:08.667
> 
> 标签：php, oop

我想用`for`循环访问类变量，这是我的简单类

```
class test{
    public $var1 = 1;
    public $var2 = 2;
    public $var3 = 3;
    public $var4 = 4;
}

$class = new test(); 
```

这就是我尝试使用循环访问变量的方式

```
for($i = 1; $i <= 4; $i++){
    echo $class->var.$i;
} 
```

我得到错误说 `Notice: Undefined property: test::$var in C:\xampp\htdocs\test\index.php on line 12`

好吧，这并不是一个大错误，我实际上得到了回显的值，但我仍然不明白为什么会出现这个错误？

如果我这样做，一切正常：

```
echo $class->var1; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T18:11:53.237

```
for($i = 1; $i <= 4; $i++){
    $var = 'var' . $i;
    echo $class->$var;
} 
```

或者，如评论中所述，这将适用于较新版本的 PHP

```
for($i = 1; $i <= 4; $i++){
    $class->{'var' . $i}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:18:00.380

代码没有按照你的想法做。`$i`由于您在 for 循环中，它只回显 1-4 。如果您要更改类中的变量，您的输出仍将是 1-4。

未定义的属性通知是线索：它正在尝试访问该属性`var`。

如果您想存储重复和/或关联的数据，尤其是在您的示例中，通常更适合存储为数组：

```
class test{
    public $vars;

    public function __construct()
    {
        $this->vars = array(1, 2, 3, 4);
    }
}

$obj = new test();

foreach($obj->vars as $var)
{
    echo $var;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T18:18:08.997

echo 使用点 (.) 运算符，而不是 $class 的成员调用。

众多解决方案之一：

```
for($i = 1; $i <= 4; $i++){
     echo $class->{'var'.$i};
} 
```

[活的例子在这里](http://codepad.viper-7.com/LVw7j0)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T18:18:21.573

您实际上并没有得到回应，而是得到`$i`回应。

`echo $class->var.$i;`被解释为`echo ($class->var).($i);`. 由于`var`不是变量（因此错误），它变成`echo ''.$i;`，所以你得到 的值`$i`。恰好它`var1`的值为 1。（换成`$var1`别的东西，你会明白我的意思）

要解决此问题，您可以执行以下操作：

```
for($i = 1; $i <= 4; $i++){
    $class->{'var'.$i}
} 
```

首先计算其中的内容`{}`，因此读取正确的属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T18:13:11.930

这已经在最近的 PHP 版本上运行良好，但试试这个：

```
for($i = 1; $i <= 4; $i++){
    $v = 'var'.$i;
    echo $class->$v;
} 
```

# android - Ellipsize 在此表格布局中不起作用

> ID：10033735
> 
> 赞同：0
> 
> 时间：2012-04-05T18:10:09.473
> 
> 标签：android, layout

我目前正在尝试学习Android。几天来一直在阅读教程和手册。我陷入了布局问题。

我正在从网页中抓取内容并将其显示给用户。这就是我的应用程序的工作。

我的布局如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" android:padding="5px">

<TextView
    android:id="@+id/tvOutput"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<ScrollView
    android:id="@+id/scrollView1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" android:layout_marginTop="5dp">

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <TableLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:stretchColumns="0" android:id="@+id/tblOutput">

            <TableRow
                android:id="@+id/tableRow1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow3"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow4"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow5"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow6"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow7"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow8"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow9"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow10"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

            <TableRow
                android:id="@+id/tableRow11"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TableRow>

        </TableLayout>

        <Button
            android:id="@+id/btnBack"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/lblBack" android:layout_marginTop="10dip"/>

        <Button
            android:id="@+id/btnSendSMS"
            android:layout_width="80dp"
            android:layout_height="wrap_content"
            android:text="@string/lblSendSMS" />

    </LinearLayout>

</ScrollView> 
```

通过代码，我将遍历 TableRows 并分别添加两个 TextView。下面是它的一个示例：

```
 for(i=1;i<=11;i++){
                    TextView tv1 = new TextView(getApplicationContext());
                    TextView tv2 = new TextView(getApplicationContext());

                    //get values and store it in strValue1 & strValue2
                    //....

                    tv1.setText(strValue1); //a long text
                    tv2.setText(strValue2); //would always be a 3 letter value
                    //tv1.setEllipsize(TruncateAt.MARQUEE);
                    //tv1.setMarqueeRepeatLimit(1);
                    tv1.setSingleLine(true);
                    tv1.setEllipsize(TruncateAt.END);
                    tv1.setGravity(Gravity.LEFT);

                    tr = (TableRow) findViewById( getResources().getIdentifier("tableRow"+i, "id", getPackageName()));
                    tr.addView(tv1);
                    tr.addView(tv2);
                } 
```

问题是，每个 TableRow 上第一个 TextView 的 setEllipsize() 没有做任何事情。它只显示第一个 TextView 的文本（长文本溢出宽度），甚至不显示 TextView2。

当我在现有的 TextView（我的布局中的第一个 TextView - 您可以从上面的 XML 中看到，它位于表格布局上方）上尝试 setEllipsize() 和 setSingleLine() 时，它工作正常。

有什么想法我哪里出错了吗？或者有什么建议吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:19:21.840

您需要使用任何一种可能的方式为 TextView 设置固定高度。设置行数或仅设置 TextView 布局的高度。如果您不这样做，那么由于 ure textview 将 wrap_content 作为高度，它将调整大小并显示所有文本。

所以先固定textview的大小，然后setellipsize()

# file - 在 Java Web 应用程序的“网页”文件夹中动态创建一个目录

> ID：10033737
> 
> 赞同：0
> 
> 时间：2012-04-05T18:10:31.753
> 
> 标签：file, jsp, servlets, directory

所以我试图在网页文件夹中动态创建一个文件夹。我正在制作一个游戏数据库。每次添加游戏时，我都会这样做：

```
public void addGame(Game game) throws DatabaseException {
    em.getTransaction().begin();        
    em.persist(game);   
    em.getTransaction().commit();
    File file = new File("C:\\GameDatabaseTestFolder");
    file.mkdir();      
} 
```

所以一切都在这里工作。文件 get 已创建。但我想创建这样的文件夹：

```
public void addGame(Game game) throws DatabaseException {
    em.getTransaction().begin();        
    em.persist(game);   
    em.getTransaction().commit();
    File file = new File(game.getId()+"/screenshots");
    file.mkdir();      
} 
```

或类似的东西。所以它将在我的 jsp 文件所在的位置创建，并且它的 id 会在游戏中消失。我不明白默认情况下创建文件夹的位置。

提前谢谢你，大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:15:05.837

默认情况下，它相对于“当前工作目录”，即在 Java 运行时环境启动服务器时当前打开的目录。这可能是例如`/path/to/tomcat/bin`、 或`/path/to/eclipse/workspace/project`等，具体取决于服务器的启动方式。

您现在应该意识到这种情况在 Web 应用程序内部是**无法控制的。**

您也不想将其存储在扩展的 WAR 文件夹中（您的 JSP 所在的位置），因为任何更改都会在您重新部署 WAR 时丢失（原因很简单，这些文件不包含在原始 WAR 中） .

而是使用绝对路径。例如

```
String gameWorkFolder = "/path/to/game/work/folder";
new File(gameWorkFolder, game.getId()+"/screenshots"); 
```

您可以通过将其作为属性文件设置或 VM 参数提供来使其可配置。

### 也可以看看：

*   [JSP中的图像上传和显示](https://stackoverflow.com/questions/8552776/image-upload-and-display-in-jsp)
*   [getResourceAsStream() 与 FileInputStream](https://stackoverflow.com/questions/2308188/getresourceasstream-vs-fileinputstream/2308388#2308388)

# ear - 应用服务器之上的网络服务器

> ID：10033738
> 
> 赞同：0
> 
> 时间：2012-04-05T18:10:43.487
> 
> 标签：ear

假设如果给定一个场景，我们将 Web 服务器放在应用程序服务器之上，该 Web 服务器可以提供哪些帮助

1) 在非分布式企业应用程序上 (ear
2) 在分布式企业应用程序上 (ear)
3) 在 Web 应用程序上 (war)...我认为在这种情况下我们不需要应用服务器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T11:17:50.290

在多层架构中，应用服务器执行业务规则和数据访问层。通过这种方式，可以针对一个应用服务器使用不同的前端，例如 Web、移动、本机。

# unit-testing - 您将如何为可以运行无数数据库查询的数据密集型应用程序创建单元测试？

> ID：10033739
> 
> 赞同：1
> 
> 时间：2012-04-05T18:10:50.787
> 
> 标签：unit-testing, phpunit

我正在开发一个报告应用程序（在 PHP 中）。这个应用程序在 UI 中有大量不同的过滤器、粒度等，并且基于这些过滤器等，后端构造了一个海量查询以从数据库中提取数百行数据。

怎么可能为这样的事情编写单元测试？

假设我用一些已知数据创建了一个测试数据库。我会创建一堆测试，将返回的数据集（对于任何过滤器设置）与测试中的硬编码 SQL 查询进行比较？

这是否意味着对于任何架构更改，我必须返回并更改测试中的每个 SQL 查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T05:54:29.607

单元测试不是以使用真实代码或数据的方式进行测试，而是模拟您使用的所有内容。你不会以你描述的方式测试它，也不需要。你不是在测试你得到什么数据，只是你提供的数据，在方法处理它之后，是你期望的或类似的。

例如，如果您有一个方法可以返回从数据库中检索到的数据，那么数据库与您的测试无关。您正在测试该方法和其中的逻辑；您可以在其中调用哪些方法，对您期望其中的这些方法执行的操作的期望（例如返回您可以对其进行断言的值的通用表示）等，并且该方法之外的所有内容都被模拟（即泛型表示）。

在一个简单的示例中，如果您创建了一个方法作为某物的 setter，并且将一个方法用作该某物的 getter，那么您将编写一个测试，说明当我使用 setter 时，getter 将返回相同的值。 ...繁荣，两种方法都经过测试。

这就是为什么您听说 TDD（测试驱动开发）的原因，起初它可能会觉得反直觉，但它迫使开发人员将编写可测试代码所需的部分放在一起，最终导致代码更好。是的，您可以编写功能完美的代码，但它不一定是可测试的（或几乎不可能），这表明它完全耦合得太厉害了，这意味着它不是那么可重用的。例如，您可以创建一个注入对象类型的方法，而不是创建一个返回苹果数量的方法，这样无论您在项目的那个部分使用什么类型的水果，它都可以返回一个计数（橙子，苹果，梨，甚至根本没有水果）。这使得该方法可重用，也意味着你不会

无论如何，请提供您的代码示例和测试，以查看问题所在。

# mongodb - 使用 NoSQL 为简单的 webapp 构建设计良好的数据库

> ID：10033742
> 
> 赞同：0
> 
> 时间：2012-04-05T18:10:59.627
> 
> 标签：mongodb, nosql

我来自 SQL 世界，所以请不要问我 NoSQL 中没有表、关系等，我知道，但我很难理解如何在没有关系的类别中保存新闻。

因此，假设我们想要将新闻、新闻类别、标签、用户资料和用户对新闻的评论保存在数据库中。使用 SQL，我认为这个任务可以用这样的架构来解决（不要看语法，它是伪代码）：

```
categories ( id, title )
news (id, title, content, category_id)
users (id, first_name, last_name, homepage_url)
news_comments (id, news_id, user_id, comment)
tags (id, title)
news_tags (news_id, tag_id) 
```

如何使用 MongoDB / CouchDB / NoSQL 解决此任务？我对良好的架构感兴趣，我不需要了解诸如索引之类的特定内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:38:09.557

通常，您需要对数据进行非规范化。您的“新闻”记录如下所示：

```
news (id, title, content, category_title, [tags]) # that is list of tags 
```

或者在技术上更精确，例如：

```
(id, type=news, title, content, category_title, [tags]) 
```

您可以按“外键”过滤，因此

```
news_comments (id, news_id, user_id, comment) 
```

如果您想为给定新闻选择评论，这不是什么大问题，但如果您想显示用户的`first_name`，您可能希望将该数据包含在评论记录本身中。

那么如果用户在评论后更改了它的数据怎么办？

1.  你真的不在乎
2.  你在工作中使用了错误的工具

有一个选项 3，您可以找到所有评论并更新它们，但如果这种情况足够常见，您可能需要从关系数据库开始。

# c# - xml 从 web 服务到列表框

> ID：10033743
> 
> 赞同：0
> 
> 时间：2012-04-05T18:11:02.787
> 
> 标签：c#, wcf, web-services, rest

我在本地计算机上运行了一个 Web 服务[http://localhost:8000/Service/](http://localhost:8000/Service/)当我导航到它时，它会以列表格式显示一些硬编码信息，如下所示：

```
<ArrayOfStudent>
<Student>
<StudentID>bla</StudentID>
<FirstName>bla</FirstName>
<LastName>bla</LastName>
</Student>
<Student>
<StudentID>bla1</StudentID>
<FirstName>bla1</FirstName>
<LastName>bla1</LastName>
</Student>
<Student>
<StudentID>bla2</StudentID>
<FirstName>bla2</FirstName>
<LastName>bla2</LastName>
</Student>
</ArrayOfStudent> 
```

如何获取这样的 xml 列表并将其从我的 uri [http://localhost:8000/Service/](http://localhost:8000/Service/)添加到列表框中，因为它已完成我无法添加对 Windows 窗体应用程序的服务引用？

例如，这是一种如何将图像从 uri 添加到图像框的方法：

```
 public Image GetImage(int width, int height)
    {
        string uri = string.Format("http://localhost:8000/Service/picture/{0}/{1}", width, height);
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);

        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
        {
            using (Stream stream = response.GetResponseStream())
            {
                return new Bitmap(stream);
            }
        }
    } 
```

然后我所要做的就是`pictureBox1.Image = GetImage(pictureBox1.Height, pictureBox1.Width);`在我想要的任何地方打电话。我只是不知道如何从我的服务中添加文本数据？

我正在尝试这样的事情：http: [//www.dotnetcodecentral.com/Post/215/wcf-rest-sumption/convert-or-deserialize-wcf-rest-response-to-objects-list](http://www.dotnetcodecentral.com/Post/215/wcf-rest-consuming/convert-or-deserialize-wcf-rest-response-to-objects-list)

```
 private void button2_Click(object sender, EventArgs e)
    {
        HttpWebRequest req = (HttpWebRequest)WebRequest.Create(uri);
        HttpWebResponse resp = (HttpWebResponse)req.GetResponse();
        Stream strm = resp.GetResponseStream();
        XElement xdoc = XElement.Load(strm); // XElement.Load has some invalid arguements?
        q = From student In xdoc.<Student>// from here
            Select New With {
                .StudentNo = student.<StudentID>.Value,
                .Firstname = student.<FirstName>.Value,
                .Surname = student.<LastName>.Value,
            }; // to here is abit of a mess
        listBox1.DataSource = q.ToList();
    }
} 
```

**编辑**- 格式问题？

![在此处输入图像描述](../Images/05d00b4a9490229a639b94a243a6c611.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:27:09.747

```
XDocument xDoc = XDocument.Load(url);
var students = xDoc.Descendants("Student")
    .Select(n => new
    {
        StudentNo = n.Element("StudentID").Value,
        Firstname = n.Element("FirstName").Value,
        Surname = n.Element("LastName").Value
    })
    .ToList();

dataGridView1.DataSource = students; 
```

# redirect - 如何将所有 http 流量重定向到 https

> ID：10033744
> 
> 赞同：3
> 
> 时间：2012-04-05T18:11:06.013
> 
> 标签：redirect, https, jenkins

我正在通过默认的 winstone 容器挤压运行 Jenkins，我想将所有对[http://jenkins-server](http://jenkins-server)的调用重定向到[https://jenkins-server](https://jenkins-server)。有没有办法在不通过 apache 等运行 Jenkins 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:59:58.960

至少您需要位于端口 80 中并将浏览器重定向到[https://jenkins-server 的东西](https://jenkins-server)。Jenkins 没有内置此功能。

[请参阅https://wiki.jenkins-ci.org/display/JENKINS/Starting+and+Accessing+Jenkins](https://wiki.jenkins-ci.org/display/JENKINS/Starting+and+Accessing+Jenkins)上的 Jenkins 命令行选项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-05T16:17:35.233

首先，您必须在您的 jenkin 名称（可能是 localhost）上生成证书（公共和私有）并将公共证书导入浏览器。使用您生成的证书（可能是包含公钥和私钥的 JKS 格式）并行托管您的 jenkin。

有关更多信息，请参阅“[在 jenkins 中启用 HTTPS？](https://stackoverflow.com/questions/40126736/enable-https-in-jenkins/55515308#55515308) ”

# c# - 低级差异：具有静态方法的非静态类与具有静态方法的静态类

> ID：10033745
> 
> 赞同：13
> 
> 时间：2012-04-05T18:11:20.057
> 
> 标签：c#, .net, performance, static-classes

我想知道使用具有静态方法的非静态类与具有相同静态方法的静态类相比的一般好处（或缺点）是什么，*除了*我不能使用非静态类中的静态方法作为扩展方法。

例如：

```
class NonStaticClass
{
    public static string GetData()
    {
        return "This was invoked from a non-static class.";
    }
} 
```

与此相反：

```
static class StaticClass
{
    public static string GetData()
    {
        return "This was invoked from a static class.";
    }
} 
```

使用一种方法而不是另一种方法对性能/内存的影响是什么？

**注意：**假设我不需要实例化该类。我的用例场景仅限于这样的事情：

```
Console.WriteLine(NonStaticClass.GetData());
Console.WriteLine(StaticClass.GetData()); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T18:15:27.633

主要的好处是，如果你将类设为静态，编译器将确保你的类只有静态成员。

因此，任何阅读代码的人都会立即看到无法实例化该类，并且无需考虑与该类的任何实例的交互。因为不可能有。

在 clr 级别，没有`static`. 静态类是`abstract`and `sealed`，它有效地防止了继承和实例化。

至于性能，我看不到编译器或运行时优化其中一个的任何可能性。

在这个例子中，我将专注于向读者尽可能清楚地表达你的意图。您可以随时进行优化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T18:14:21.347

有一些特殊性/限制：

*   你不能实例化静态类
*   你不能继承静态类

因此，如果您假设您的类有这样的行为（例如 helper/util 或扩展方法容器），如果您想限制它的使用 - make it `static`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T18:19:18.983

没有好处或缺点。这只是架构决定。

在提供函数集或函数库的情况下使用仅静态类。因为你不能实例化它，但你可以像使用它一样。

```
MyMathLibrary.Plot(...) 
```

这种类型*通常*暗示状态较少的行为。我重复一遍，*通常*。

当您具有“普通”类型但需要某种*无状态*方法时，请使用具有静态成员的简单类，例如：

```
public class MyType
{
    .... //some members 

    public static MyType ReadFromXml(XmlReader reader) {}
    public static void SaveToXml(MyType mt) {}
} 
```

没有灵丹妙药，这只是架构师选择的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T18:14:38.830

性能影响：基本上没有。

您可以创建 的实例`NonStaticClass`，但由于它没有非静态覆盖方法，因此它与说 几乎一样有用`object obj = new object()`，也就是说，它可能对锁定很有用，仅此而已。将类设为 static 可以防止有人对其进行新的修改，但这并没有真正的*危害*。

这更像是一种自我记录的方式，表示没有理由创建类的实例。

# qt - Qt：鼠标事件处理程序可以互相阻塞吗？

> ID：10033747
> 
> 赞同：1
> 
> 时间：2012-04-05T18:11:24.060
> 
> 标签：qt, event-handling

我有一个简单的父小部件，它重新实现了 mousePressEvent/mouseReleaseEvent。父级的子小部件使用 enterEvent/leaveEvent。当我将鼠标悬停在子小部件上时， leaveEvent/enterEvent 会执行，但是当我单击并按住鼠标时，mousePressEvent 会执行，但 enterEvent/leaveEvent 会静音（换句话说，没有单击和拖动）。关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T20:11:52.700

如果您按住小部件上的鼠标按钮，则该小部件会**抓取**鼠标事件，直到您释放按钮。这不是 Qt 的特殊功能，您可以在我知道的所有其他 GUI API 中找到类似的行为。

查看 Qt 文档的相关部分：

[QWidget / 事件](http://qt-project.org/doc/qt-4.8/QWidget.html#events)：

> 当鼠标光标在窗口小部件内时按下鼠标按钮，或者当窗口小部件使用grabMouse() 抓取鼠标时，将调用mousePressEvent()。**按下鼠标而不释放它实际上与调用grabMouse() 相同。**

[无效 QWidget::grabMouse ()](http://qt-project.org/doc/qt-4.8/qwidget.html#grabMouse)：

> 抓取鼠标输入。此小部件接收所有鼠标事件，直到调用 releaseMouse()；**其他小部件根本没有鼠标事件**。

# asp.net - 依赖注入到 AuthorizationFilterAttribute

> ID：10033749
> 
> 赞同：4
> 
> 时间：2012-04-05T18:11:36.100
> 
> 标签：asp.net, asp.net-mvc-3, unity-container

总的来说，我对 Unity 和 IoC 还是很陌生，像往常一样，我很快就陷入了困境……

我为 ASP.NET Web API Beta 创建了一个授权过滤器属性。我现在需要将我的授权人注入到属性中，但是由于这是一个属性，我不能简单地`public TestAuthAttribute(IAuthorizer Authorizer)`在构造函数中执行此操作。

所以我决定创建一个用 [Dependency] 属性装饰的公共属性来进行属性注入，但是它没有得到解决。

这是代码：

```
public class TestAuthAttribute : AuthorizationFilterAttribute
{
    [Dependency]
    public IAuthorizer Authorizer { get; set; }

    public TestAuthAttribute() {
        ...
        }

    private bool authorizeCore(HttpRequestMessage request)
    {
        if (Authorizer == null)
            throw Error.ArgumentNull("Null Authorizer");  // <<<<< this is null
    } 
```

当控制器用 [TestAuth] 装饰时，触发属性但未解析授权者，它为空）

我已将以下代码放在我的控制器中，并且授权器确实得到了解决...

```
[Dependency]
    public IAuthorizer Authorizer { get; set; } 
```

为什么在我的 AuthorizationFilterAttribute 中没有解决这种依赖关系以及如何将授权者注入到 AuthorizationFilterAttribute 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T22:56:19.457

完全披露：我没有使用涡轮机。

话虽如此，我认为它可能会为您解决问题，或者至少向您展示如何解决它。

他们在这里有一个 Unity Nuget 包：http: [//nuget.org/packages/MvcTurbine.Unity](http://nuget.org/packages/MvcTurbine.Unity)

您可以在他们的 codeplex 网站上找到更多详细信息：http: [//mvcturbine.codeplex.com/](http://mvcturbine.codeplex.com/)

希望有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-30T17:28:00.300

我将 Ninject 用于类似目的。我确实有对 Ninject.Web.WebAPI 的引用，它工作得很好。

但是，这似乎不适用于 MVC4 RC。

# windows-8 - 摆脱 Metro 界面

> ID：10033754
> 
> 赞同：6
> 
> 时间：2012-04-05T18:11:54.657
> 
> 标签：windows-8

我工作的公司主要运行 Windows XP 机器。这些机器已经老旧，需要更换。我想等到 Windows 8 发布，因为它指日可待。所以，我下载了 Windows 8 来测试运行并找出我的用户、程序、组策略等问题。

安装后我注意到几乎所有东西都发生了变化，我有点迷失了一段时间。在我看来，Metro 界面很糟糕，肯定会让我的用户感到沮丧。如果他们不习惯使用它，他们会经常骚扰我。更不用说它会导致我们的团体政策进行大量修改。

总的来说，我认为支持可能会很耗时。所以，我想知道是否有办法禁用 Metro 界面并在桌面上显示传统的开始按钮。如果可能的话，我想在没有黑客的情况下做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T19:47:31.690

无法禁用 Metro 并用“开始”按钮替换“开始”屏幕。从现在开始，“开始”屏幕将成为您选择程序的方式。

您仍然可以使用传统桌面和任务栏运行应用程序。您可以通过单击开始屏幕上的桌面磁贴或使用键盘上的 Windows 键 + D 来访问桌面。新的Win8任务栏没有开始按钮，点击键盘上的Windows键会弹出开始屏幕。

**编辑**：Windows 8.1 已将旧的“开始”按钮添加回任务栏。

如果您的用户主要将电子邮件和 Web 浏览器用于他们的应用程序，那么 Metro UI 虽然需要学习曲线，但无论如何对您的用户来说可能是更好的体验。如果您的用户可以从移动性更强、触控驱动的体验中受益，那么 Metro 可能会更好。如果您有很多需要 Visual Studio 或 Photoshop 等工具的高级用户，那么他们将在传统桌面上花费大量时间，因为这些应用程序对于 Metro UI 没有意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T19:23:36.407

尽管在进入桌面之前我无法绕过 (Metro) 开始屏幕，但我真的建议您看看[ClassicShell](http://classicshell.sourceforge.net/)。它是一个开源项目，为您提供开始菜单和开始按钮。同样，在登录后，您仍然会看到开始屏幕，并且似乎没有办法摆脱这种情况，这在具有`RPEnabled` `REG_DWORD`价值的 beta 版本中是可能的。

此外，您可以通过策略更改摆脱锁定屏幕（在登录提示之前）。启动`gpedit.msc`提升，然后转到`Computer Configuration`-> `Administrative Templates`-> `Control Panel`->`Personalization`并在左窗格中双击设置`Do not display the lock screen`并将其设置为`Enabled`.

除了上述情况，我会接受 Kate 的建议，即坚持使用 Windows 7。太多的桌面用户对 Windows 8 的可用性（或者说缺乏可用性）表示不满，因此微软不得不采取行动的可能性很小重新启用一些传统元素。我当然不会抱太大希望...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T18:32:10.070

您可以尝试使用 Metrocontroller (google for it)，据说它会禁用部分或全部 Metro 功能

# android - 如何通过 ADB 关闭 Wifi？

> ID：10033757
> 
> 赞同：62
> 
> 时间：2012-04-05T18:11:57.740
> 
> 标签：android, shell, adb, android-wifi

我正在自动化 wifi 呼叫的测试程序，我想知道有没有办法通过 adb 关闭/打开 wifi？

我想禁用/启用 wifi 或终止 wifi 呼叫（com.movi​​al.wificall）并重新启动它。

是否可以通过 adb 和 shell 命令来完成这一切？

到目前为止，我发现：

```
android.net.wifi.WifiManager
setWifiEnabled(true/false) 
```

我只是不知道如何把它放在一起

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2012-04-06T02:48:20.147

# 通过 ADB 使用“svc”（需要 root 权限）：

**使能够：**

```
adb shell su -c 'svc wifi enable' 
```

**禁用：**

```
adb shell su -c 'svc wifi disable' 
```

# 通过 ADB 使用关键事件：

```
adb shell am start -a android.intent.action.MAIN -n com.android.settings/.wifi.WifiSettings
adb shell input keyevent 20 & adb shell input keyevent 23 
```

第一行启动“wifi.WifiSettings”活动，打开 WiFi 设置页面。第二行模拟按键。

我在 Droid X 上测试了这两行。但由于设置布局不同，上述关键事件可能需要在其他设备中进行编辑。

更多关于“keyevents”的信息[在这里](https://stackoverflow.com/questions/7789826/adb-shell-input-events)。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2012-07-13T14:41:00.817

我正在寻找相同的方法来打开/关闭蓝牙，我发现了这个：

```
adb shell svc wifi enable|disable 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-09-14T08:18:47.743

在非 root 设备上切换 wifi 的简单方法是使用简单的应用程序：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        WifiManager wfm = (WifiManager) getSystemService(Context.WIFI_SERVICE);
        try {
            wfm.setWifiEnabled(Boolean.parseBoolean(getIntent().getStringExtra("wifi")));
        } catch (Exception e) {
        }
        System.exit(0);
    }
} 
```

AndroidManifest.xml：

```
<uses-permission android:name="android.permission.CHANGE_WIFI_STATE" /> 
```

亚行命令：

```
$ adb shell am start -n org.mytools.config/.MainActivity -e wifi true
$ adb shell am start -n org.mytools.config/.MainActivity -e wifi false 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-05-09T05:29:11.963

```
adb shell "svc wifi enable" 
```

这有效并且它在后台执行操作而无需打开相关选项！

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-10-29T08:38:17.080

1.  去位置`android/android-sdk/platform-tools`
2.  `shift`+右键单击
3.  在此处打开 cmd 并键入以下命令

    1.  `adb shell`
    2.  `su`
    3.  `svc wifi enable/disable`
4.  完毕！！！！！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-06-08T14:26:19.003

我测试了这个命令：

```
adb shell am start -a android.intent.action.MAIN -n com.android.settings/.wifi.WifiSettings
adb shell input keyevent 19 && adb shell input keyevent 19 && adb shell input keyevent 23 
```

并且仅适用于窗口的提示，可能是因为某些驱动程序

该`adb shell svc wifi enable|disable`解决方案仅适用于 root 权限。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-24T14:02:38.993

与引号一起使用

前任：**`adb shell "svc wifi enable"`**

这将工作:)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-11-21T18:49:06.747

我可以这样做：

```
settings put global wifi_on 0
settings put global wifi_scan_always_enabled 0 
```

有时，如果在启动期间完成（即修复[这样的](https://forum.xda-developers.com/showthread.php?t=2507778)引导循环），它不会很好地应用，您也可以先启用飞行模式：

```
settings put global airplane_mode_on 1
settings put global wifi_on 0
settings put global wifi_scan_always_enabled 0 
```

其他选择是通过以下方式强制执行此操作：

```
while true; do settings put global wifi_on 0; done 
```

在 LG G5 (SE) 上的 Android 7 中使用（无根）stock mod 进行了测试。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-12-10T19:15:49.243

所有这些`input keyevent`组合都依赖于安卓/硬件，这很痛苦。

但是，我终于找到了我的旧 android 4.1 设备的组合：

```
adb shell am start -a android.intent.action.MAIN -n com.android.settings/.wifi.WifiSettings
adb shell "input keyevent KEYCODE_DPAD_LEFT;input keyevent KEYCODE_DPAD_RIGHT;input keyevent KEYCODE_DPAD_CENTER" 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-08-15T19:31:58.077

### 通过 Android 11 上的 cmd 命令（无需 root）

### 启用 WIFI（打开）：

```
adb shell cmd -w wifi set-wifi-enabled enable 
```

### 禁用 WIFI（关闭）：

```
adb shell cmd -w wifi set-wifi-enabled disable 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-10T17:06:29.557

这适用于android 7.1.1，无根

```
adb shell am start -a android.intent.action.MAIN -n com.android.settings/.wifi.WifiSettings && adb shell input keyevent 23 && adb shell input keyevent 23 
```

这将启动活动，然后发送 DPAD 中心键事件。我添加了另一个 DPAD 中心作为实验，看看您是否可以以相同的方式启用它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-05T19:33:54.390

以下方法**不需要 root**并且应该可以在任何地方工作（根据[docs](https://developer.android.com/reference/android/net/wifi/WifiManager#setWifiEnabled(boolean))，即使在 Android Q+ 上，如果你保留`targetSdkVersion = 28`）。

1.  制作一个空白应用程序。

2.  创建一个`ContentProvider`：

    ```
    class ApiProvider : ContentProvider() {

        private val wifiManager: WifiManager? by lazy(LazyThreadSafetyMode.NONE) {
            requireContext().getSystemService(WIFI_SERVICE) as WifiManager?
        }

        private fun requireContext() = checkNotNull(context)

        private val matcher = UriMatcher(UriMatcher.NO_MATCH).apply {
            addURI("wifi", "enable", 0)
            addURI("wifi", "disable", 1)
        }

        override fun query(uri: Uri, projection: Array<out String>?, selection: String?, selectionArgs: Array<out String>?, sortOrder: String?): Cursor? {
            when (matcher.match(uri)) {
                0 -> {
                    enforceAdb()
                    withClearCallingIdentity {
                        wifiManager?.isWifiEnabled = true
                    }
                }
                1 -> {
                    enforceAdb()
                    withClearCallingIdentity {
                        wifiManager?.isWifiEnabled = false
                    }
                }
            }
            return null
        }

        private fun enforceAdb() {
            val callingUid = Binder.getCallingUid()
            if (callingUid != 2000 && callingUid != 0) {
                throw SecurityException("Only shell or root allowed.")
            }
        }

        private inline fun <T> withClearCallingIdentity(block: () -> T): T {
            val token = Binder.clearCallingIdentity()
            try {
                return block()
            } finally {
                Binder.restoreCallingIdentity(token)
            }
        }

        override fun onCreate(): Boolean = true

        override fun insert(uri: Uri, values: ContentValues?): Uri? = null

        override fun update(uri: Uri, values: ContentValues?, selection: String?, selectionArgs: Array<out String>?): Int = 0

        override fun delete(uri: Uri, selection: String?, selectionArgs: Array<out String>?): Int = 0

        override fun getType(uri: Uri): String? = null
    } 
    ```

3.  `AndroidManifest.xml`连同必要的许可一起声明：

    ```
    <uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />

    <application>

        <provider
            android:name=".ApiProvider"
            android:authorities="wifi"
            android:exported="true" />
    </application> 
    ```

4.  构建应用程序并安装它。

5.  亚行致电：

    ```
    adb shell content query --uri content://wifi/enable
    adb shell content query --uri content://wifi/disable 
    ```

6.  使用调用这些命令的短名称创建批处理脚本/shell 函数/shell 别名。

根据您的设备，您可能需要额外的权限。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-09-25T06:11:25.877

**`ADB Connect to wifi with credentials :`**

您可以使用以下 ADB 命令连接到 wifi 并输入密码：

adb wait-for-device shell am start -n com.android.settingstest/.wifi.WifiSettings -e WIFI 1 -e AccessPointName "enter_user_name" -e Password "enter_password"

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-10-22T07:27:37.020

在Android测试中我这样做： InstrumentationRegistry.getInstrumentation().getUiAutomation().executeShellCommand("svc wifi **enable** ") InstrumentationRegistry.getInstrumentation().getUiAutomation().executeShellCommand("svc wifi **disable** ")

# c# - 以编程方式创建 SQL Server 表

> ID：10033758
> 
> 赞同：5
> 
> 时间：2012-04-05T18:12:08.857
> 
> 标签：c#, sql-server-2008-r2, sqlcommand

我需要在 C# 中以编程方式创建一个 SQL Server 2008 表，以便应该从列列表生成表的列（每个列名是表中一行的名称）

我的问题是遍历列列表并创建记录的表的命令字符串是什么：

```
List<string> columnsName = ["col1","col2","col3"] 
```

我想创建一个包含`columnsName`. 但是由于列表大小不是恒定的，我需要遍历列表来生成表格列。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-05T21:32:15.807

简单的答案是

```
CREATE TABLE table_name
(
    column_name1 data_type,
    column_name2 data_type,
    column_name3 data_type,
    ....
) 
```

来自[w3Schools.com](http://www.w3schools.com/sql/sql_create_table.asp)

在 C# 中，使用[字符串生成器](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)连接查询，然后执行查询。

```
StringBuilder query = new StringBuilder();
query.Append("CREATE TABLE ");
query.Append(tableName);
query.Append(" ( ");

for (int i = 0; i < columnNames.Length; i++)
{
    query.Append(columnNames[i]);
    query.Append(" ");
    query.Append(columnTypes[i]);
    query.Append(", ");
}

if (columnNames.Length > 1) { query.Length -= 2; }  //Remove trailing ", "
query.Append(")");
SqlCommand sqlQuery = new SqlCommand(query.ToString(), sqlConn);
SqlDataReader reader = sqlQuery.ExecuteReader(); 
```

注意：tableName、columnNames 和 columnTypes 将被替换为您从中获取数据的内容。根据您的描述，听起来您正在从查询中获取列值，因此您可能会使用 while 循环来迭代结果以构建查询，而不是使用 for 循环和数组。如果您需要使用此方法的示例，请告诉我，我今晚会做一个。

如果您在创建表时遇到语法问题，可以尝试在 MS SQL Server Management Studio 中创建表（或示例表），然后右键单击表并选择 Script Table as\Create To\New Query Editor Window。这将向您显示用于构建查询的脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:18:34.043

您是否希望实现类似实体-属性-值模型的东西？

[http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)

# arrays - 通过从 Matlab 工作区派生的 2 个数组在 Simulink 中绘制 XY 图

> ID：10033761
> 
> 赞同：2
> 
> 时间：2012-04-05T18:12:22.717
> 
> 标签：arrays, matlab, plot, simulink

我在工作区中有 2 个一维数组，一个（xarray）用作 x 轴，另一个（yarray）用作 y 轴。

```
xarray =

     1     2     3     4     5     6     7     8     9    10

yarray =

   500   200   800     0     0     0     0     0     0     0 
```

我想在 Simulink 中做的是从工作区读取这些数组并生成 XY 图。我可以从 Matlab 命令行轻松地做到这一点`(figure; plot(xarray, yarray))`，但是，我想从 Simulink 做到这一点。

我尝试使用两个“for workspace”块从工作区读取每个数组，然后将它们连接到“XY 图”的相应输入，但是，我得到的错误是：

> 端口宽度或尺寸错误。'simulink_model/XY Graph/Mux' 的输出端口 1 是具有 18 个元素的一维向量。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T21:00:04.257

使用外部矩阵时，simulink 可能有点棘手。

所以有几件事：1）矩阵需要有数组作为列（幸运的是你可以在simulink本身中进行转置操作）

2）你需要第一列来代表数组的时间输入：所以在你的情况下，你可以使用的第一个输入`[xarray; xarray]'`，第二个输入，你可以使用 [xarray; yarray]' （提供，当然 xarray 不会改变）

3）不要忘记修改范围首选项以查看所有数据（默认最大值为 [-1;1]）

# php - Zend - 组合框值取决于另一个组合框值

> ID：10033765
> 
> 赞同：0
> 
> 时间：2012-04-05T18:12:32.260
> 
> 标签：php, zend-framework, combobox, zend-form, zend-studio

Zend Framework 中是否有一种方法可以根据在前一个组合框中选择的值填充组合框，但在同一页面上？

就我而言，我有一个用于域的组合框和一个用于专业化的组合框。如果我在第一个组合框（域）中选择信息学，我想用一个专业化填充第二个组合 - “信息学”。但是如果我在第一个中选择数学，我想用两个专业来填充第二个：“数学”和“数学与信息学”。

谢谢！索林

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T23:37:55.557

如果您在服务器的数据库中拥有域和专业化之间关系的数据。您可以将更改事件的侦听器附加到您的域组合框，并通过使用 ajax 发布请求检索所选域的专业化来相应地填充第二个组合框：

这是一个使用 jquery 的示例：

```
 $(".domain").change(function()
{
  var domainId=$(this).val();
  var dataString = 'domainId='+ domainId; 

 $.ajax
 ({
   type: "POST",
   url: baseurl+"getSpecialisations", 
   data: dataString,
   cache: false,
   success: function(html)
          {
            $(".specialisation").html(html);
          }
 });
}); 
```

并在您的控制器中创建一个操作 getSpecialisationsAction 来检索您的域的规范，查看[此处](http://blog.ekini.net/2007/08/28/jquery-ajax-in-zend-framework/)以获取有关如何将发布请求发送到 zend 操作的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T22:38:04.990

我使用了一个非常简单的解决方案：根据所选的域，我在一个页面上设置了选择域的选项，并在另一个页面上设置了选择专业化的选项。

# jquery - 使用 jQuery 在 iPad 上切换视频源

> ID：10033767
> 
> 赞同：3
> 
> 时间：2012-04-05T18:12:39.530
> 
> 标签：jquery, ipad, html, video, jquery-mobile

我一直在尝试使用 jQuery 通过单击链接来切换在 iPad 上播放的视频。它在浏览器中运行良好，但是当我在 iPad 上尝试它时，它只是暂停视频而不加载另一个视频。

```
// switch video sources on the fly
    //

}).on('click', '.video-nav a', function(e){

    // pause the current video
    //
    $("#" + $(this).attr("data-video-id"))[0].pause();

    // change the source of the video in question
    //
    $("#" + $(this).attr("data-video-id") + " > source").attr("src", $(this).attr("data-video"));

    // load the new source
    //
    $("#" + $(this).attr("data-video-id"))[0].load();

    // play the new video
    //
    $("#" + $(this).attr("data-video-id"))[0].play();

    // make the button's parent "active" by adding it as a class
    //
    $(this).parent().addClass("active").siblings().removeClass("active");

}); 
```

这就是我设置html的方式：

```
<video id="non" width="444" height="339" controls="true" preload="false" poster="images/image1.png">
                <source src="videos/video1.mp4" type='video/mp4' />
            </video>        

            <div class="video-nav">

                <ul>
                    <li class="active"><a class="fourty-ten-ten" href="#" rel="external" data-video="videos/video1.mp4" data-video-id="non" data-poster="images/image1.png"></a></li>

                    <li><a class="fourty-ten-twenty" href="#" rel="external" src="" data-video="videos/video2.mp4" data-video-id="non" data-poster="images/image2.png"></a></li>
                </ul>
            </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T16:33:20.277

因此，对于任何寻找的人，这里有一个在 iPad 上更改视频源的解决方案：

html是这样设置的：

```
<div class="vid-wrapper">
   <video id="video" data-vid="video" controls preload="none">
      <source src="videos/video1.mp4" type='video/mp4' />
   </video>

   <a data-vid="video1.mp4">&nbsp;</a>
   <a data-vid="video2.mp4">&nbsp;</a>
</div> 
```

并且 jQuery 是这样设置的：

```
$(document).on('click', 'a[data-vid]', function(){
        var $this = $(e.target),
            video = $this.attr('data-vid'),
            newVid = $this.siblings('video');

        // pause the current video
        newVid[0].pause();
        // change the source of the video in question
        newVid.attr('src', 'videos/' + video);
        // load the new source
        newVid[0].load();
        // play the new video
        newVid[0].play(); 
```

});

希望这可以帮助有需要的人！

# java - 为什么我收到错误“整数太大”？我在最后加上一个“L”

> ID：10033768
> 
> 赞同：3
> 
> 时间：2012-04-05T18:12:43.560
> 
> 标签：java, javac, long-integer

以下代码未在 Java 中编译：

java version "1.6.0_24" OpenJDK Runtime Environment (IcedTea6 1.11.1) (suse-3.1-x86_64) OpenJDK 64-Bit Server VM (build 20.0-b12, mixed mode)

```
public class XOR
{
    public static void main(String[] args)
    {
        long one = 595082963178094600000L;
    }
} 
```

这会引发错误：

```
XOR.java:5: integer number too large: 595082963178094600000 
```

但我已经正确地指出它很长！以下也会引发错误：

```
public class XOR
{
    public static void main(String[] args)
    {
        long one = new Long( "595082963178094600000" );
    }
} 
```

这抛出：

```
java.lang.NumberFormatException: For input string: "595082963178094600000" 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-05T18:15:08.733

好吧，也许是因为它*是* `too large`？

```
595082963178094600000  //your value
  9223372036854775807  //Long.MAX_VALUE 
```

您将需要`BigInteger`或`BigDecimal`：

```
new BigInteger("595082963178094600000") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:42:00.640

long 的值必须介于 -9,223,372,036,854,775,808 和 9,223,372,036,854,775,807 之间。您不能将大于这些值的值分配给很长的变量，即使您将 L 附加到它，它也会溢出该值并在编译时导致错误。

# clr - 将 Numeric.Complex 与 PInvoke 一起使用是否安全？（它没有 LayoutKind.Sequential）

> ID：10033783
> 
> 赞同：3
> 
> 时间：2012-04-05T18:14:27.097
> 
> 标签：clr, complextype, memory-layout

我想在非托管 PInvoke 场景中使用 System.Numerics.Complex。使用 ILSpy，我注意到它没有分配 LayoutKind.Sequential 属性。

```
/// <summary>Represents a complex number.</summary>
[Serializable]
public struct Complex : IEquatable<Complex>, IFormattable
{
    private double m_real;
    private double m_imaginary;
    ... 
```

在不转换为期望公共内存布局的本机函数的情况下给出指向 Complex[] 数组的指针是否安全，即：实数第一，虚数第二？或者，CLR 是否会因为某种原因打乱它的真实和虚构属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:22:32.257

LayoutKind.Sequential 是所有主要 .NET 编译器的默认值：http: [//msdn.microsoft.com/en-us/library/system.runtime.interopservices.layoutkind.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.layoutkind.aspx)

即使它不会：改变属性顺序的唯一原因是对齐问题。由于 System.Numerics.Complex 确实只有两个双重成员，因此没有理由交换它们。所以IMO你是安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:37:15.590

你很好，因为这是一个*struct*。它有一个隐含的 [StructLayout] 是顺序的。你可以从 typeof(Complex).IsLayoutSequential 中看到一些东西。对于类来说*并非*如此，它需要显式声明。

是的，字段可以在对象的内部表示中交换。但这无关紧要，因为 pinvoke 编组器必须编组对象。编组器中内置了一个隐含的 Marshal.StructureToPtr() 。Fwiw，这种交换不会发生，因为两个双打的包装已经是最佳的。它们很合身，不留任何填充物。所以编组器只创建一个指向对象的指针，而不必复制它。

所有的好消息:)

# c - 标准c宏来指示MAC地址的长度？

> ID：10033785
> 
> 赞同：2
> 
> 时间：2012-04-05T18:14:41.637
> 
> 标签：c, macros, mac-address

是否有标准（或半标准、广泛部署的）C 宏用于：

1.  格式为 00:11:22:33:44:55 的 MAC 地址长度，即 17 个字节。
2.  原始 MAC 的长度，即 6 个字节。

我曾多次在专有头文件中看到这些定义，但我看到很多示例/教程代码，否则它们使用“正确”宏并且没有任何内容——“6”总是硬编码的。

FWIW我在Linux上。

显然，定义我自己的标准是微不足道的，但我想尽可能使用标准。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:29:33.937

一些平台定义了一个“/usr/include/net/ethernet.h”，它执行以下操作：

`#define ETHER_ADDR_LEN 6`

`if_ether.h`并且一些平台在（位于各个地方，包括netinet）中有类似的定义。

但是，我不知道定义“字符串格式”地址长度的任何内容，并且我不知道任何强加这些`#define`s 的标准，因此它们可能不是普遍可移植的。

# wpf - WPF双动画| 如何指定产地

> ID：10033796
> 
> 赞同：0
> 
> 时间：2012-04-05T18:15:12.170
> 
> 标签：wpf, animation

如何为基于故事板的双动画指定原点。

以下是代码

```
<Storyboard x:Key="gridin">
  <DoubleAnimation BeginTime="00:00:00" Duration="00:00:05"  Storyboard.TargetName="gridA" Storyboard.TargetProperty="Width" From="100" To="300" ></DoubleAnimation>
  <DoubleAnimation BeginTime="00:00:00" Duration="00:00:05"  Storyboard.TargetName="gridA" Storyboard.TargetProperty="Height" From="100" To="300" ></DoubleAnimation>
 </Storyboard> 
```

gridA 是要在其上完成动画的网格。

这个问题是 gridA 动画是从顶部中间开始的。我想将原点设置为 0.5、0.5，但无法获取设置此值的位置。

一种选择是以某种方式使用 RenderTransform 并设置 RenderTransformOrigin。我想避免这种方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:34:19.727

您可以将 gridA 放在另一个（更大的）Grid 中，`HorizontalAlignment`并`VerticalAlignment`设置为`Center`：

```
<Grid Width="300" Height="300">
    <Grid Name="gridA" HorizontalAlignment="Center" VerticalAlignment="Center">
    </Grid>
</Grid> 
```

就我个人而言，我更喜欢为`ScaleTransform`in制作动画`RenderTransform`。

# emacs - 在议程视图中匹配属性

> ID：10033797
> 
> 赞同：4
> 
> 时间：2012-04-05T18:15:20.223
> 
> 标签：emacs, org-mode

我想收集并创建一个包含标题中只有“ID”属性的标题块。

即要过滤的标题看起来像

```
* Headline 
   :PROPERTIES:
   :ID: my-id
   :END: 
```

我正在使用以下代码来配置不起作用的自定义议程命令

```
(setq org-agenda-custom-commands
           '(("c" "MY Agenda"
          ((tags "ID"))))) 
```

我已经阅读了组织手册[http://orgmode.org/manual/Matching-tags-and-properties.html#Matching-tags-and-properties](http://orgmode.org/manual/Matching-tags-and-properties.html#Matching-tags-and-properties)但仍然无法弄清楚如何去做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T19:00:06.843

您的代码要求它查找标题上带有`:ID:`标签的所有标题。要查找属性，您必须使用属性匹配功能，该功能在链接手册页的下方列出。

由于我假设您需要它来匹配任何 ID 而不仅仅是特定 ID，因此您必须通过匹配 ( `=`) 或不匹配 ( `<>`) 大括号中的正则表达式来使用正则表达式匹配。

要匹配您的 ID 属性，您需要正则表达式为`ID={.+}`. 如果您用作`.*`匹配项，它也会匹配没有任何 ID 属性的标题。如果您有一些要匹配的 ID 有一些共同点，您可以调整正则表达式以匹配它们。

因此，您的自定义议程命令必须是：

```
(setq org-agenda-custom-commands
           '(("c" "MY Agenda"
          ((tags "ID={.+}"))))) 
```

# sql - 将第二个表中的 N 列中的值乘以 N 列？

> ID：10033805
> 
> 赞同：1
> 
> 时间：2012-04-05T18:15:54.077
> 
> 标签：sql

所以我得到了一个数据库，我需要做一些报告来找出每次遭遇的成本。它基本上看起来像这样：

```
ID     ItmQty1    ItmQty2    ItmQty3    etc...
1      3             1        0 
```

我需要通过将其乘以这样的价格表来获得总成本：

```
ItmCost1    ItmCost2    ItmCost3    etc...
21.50         10.75        3.53 
```

并希望以如下结果结束：

```
ID    ItmQty1    ItmTTL1    ItmQty2    ItmTTL2      ...    EncounterTTL
1        3        64.50         1        10.75                  75.25 
```

只是不确定连接如何处理表之间的多对一关系。

这将在 SQL Server 2008 和 SSRS 上完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:26:47.250

好吧，您的架构有点非正统（至少可以说），但它是可行的：

```
SELECT
    i.ID
,   i.ItmQty1
,   i.ItmQty1 * c.ItmCost1 as ItmTTL1
,   i.ItmQty2
,   i.ItmQty2 * c.ItmCost2 as ItmTTL2
,   i.ItmQty3
,   i.ItmQty3 * c.ItmCost3 as ItmTTL3
-- and so on
FROM Items i
JOIN Costs c on 1=1 
```

# iphone - CAShapeLayer：动画填充颜色

> ID：10033808
> 
> 赞同：1
> 
> 时间：2012-04-05T18:16:05.757
> 
> 标签：iphone, animation, layer

我目前正在使用 CAShapeLayer 绘制饼图。要求之一是动画饼图的创建。为了实现这一点，我正在为“strokeEnd”属性设置动画以动画路径的绘制。有没有办法为颜色的填充设置动画？

# c#-4.0 - 指定的对象未被识别为假对象。问题

> ID：10033813
> 
> 赞同：19
> 
> 时间：2012-04-05T18:16:24.420
> 
> 标签：c#-4.0, tdd, nunit, fakeiteasy

我遇到了一个问题，即在一个极其简单的测试中调用 FakeItEasy 失败并出现错误“指定的对象未被识别为假对象”。调用很简单：

```
A.CallTo(myService.MyMethod(listOfStringsFilter)).MustHaveHappened(); 
```

伪造同样简单（A.Fake()），并使用一种方法伪造一个接口，该方法接受一个列表并返回一个列表。在调试模式下，我看到 myService 的实例属于 {Fake IMyInterface} 类型。无论如何，这个问题真的让我很困惑，在此先感谢您的帮助。

**更新：**

这是我自己的错误，我需要打电话说：

```
A.CallTo(() => myService.MyMethod(listOfStringsFilter)).MustHaveHappened(); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-07T21:28:43.403

这是我自己的错误，我需要打电话说：

```
A.CallTo(() => myService.MyMethod(listOfStringsFilter)).MustHaveHappened(); 
```

# database - 当角色根据请求的信息不断变化时，如何支持授权？

> ID：10033815
> 
> 赞同：0
> 
> 时间：2012-04-05T18:16:31.623
> 
> 标签：database, dynamic, authorization, roles

我对授权过程感到非常困惑。我正在开发一个网络应用程序，我们有小组，人们一起工作——因此小组内的所有人都可以使用这些信息。我们还有一个“关注”群组的功能（我听到推特了吗？），这样群组的关注者也可以访问，但只能阅读群组的数据（在我的情况下，是一些“帖子”，是的类似FB的帖子）。问题是授权人——在一个***好的方面***方法。实际上，我的工作进展顺利，因为我直接将授权工作提供给我使用的 sql 查询 - 通过限制 WHERE 子句中的记录。但出于某种原因，我觉得这种方式很糟糕——非常糟糕。只有我能在代码中添加授权工作，感觉会更好。但也许这种方法是好的，我不知道！如果是这样，那就告诉我，或者告诉我一个更好的方法来做到这一点。是的，我正在创建一个 RESTful API，如果这可能有助于理解我的问题。最后一点，我只是这一切的初学者-中级者，所以如果您觉得问题描述不正确，请多多包涵。还有一件事，它不是 facebook 或 twitter 的副本，也不是两者的混合。谢谢！

好的。也许我应该包含一个数据访问层的代码示例。这应该让我更容易理解我的问题。这是返回具有给定 ID 的“项目”的代码。项目成员（列在 project_members 表中）或关注它的人（列在 project_followers 表中）可以访问项目。

```
 public function getProjectById($id) {
        $auth = new Auth();
        $userid = $auth->getCurrentUserId();

        $sql = "SELECT P.id, P.userId, P.name, P.description, P.creationTime, P.startTime, P.endTime, P.isOpen FROM projects P INNER JOIN project_members PM ON PM.projectid = P.id AND (P.id = '{id}') AND (PM.userId = '{userid}' OR P.isOpen = 1)";

        return $this->result($sql, array( "userid" => $userid, "id" => $id ));
    } 
```

现在，由于某种晦涩的原因，我发现查询很脏。也许它可能很干净，但是以这种方式处理授权是否很好。或者有没有其他更好的方法？

# java - 从基于 Web 的应用程序到基于桌面的应用程序的通信

> ID：10033821
> 
> 赞同：1
> 
> 时间：2012-04-05T18:17:10.827
> 
> 标签：java, spring, desktop-application, rmi

我正在开发一个应用程序，它由两部分组成，一个是基于 Web 的，另一个是桌面应用程序，基于 Web 的应用程序将调用基于桌面的应用程序，两台机器都在局域网中。应用程序是用 Java 编写的。有人建议我使用 RMI。基于 Web 的应用程序将充当 RMIClient，而桌面应用程序将充当 RMIServer。对于基于 Web 的应用程序，我们使用 Spring Framework，spring 为内部使用 java RMI 的 RMI 服务提供了自己的方式。我决定基于此模式进行原型设计。

现在我已经使用 Spring 创建了 RMIClient，请参见下面的代码：-

```
package com.rmi.client;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
@Controller
public class MainController {

@RequestMapping("/callrmiserver")
public void callRMISever(){
    ApplicationContext ctx = new ClassPathXmlApplicationContext("ServiceBean.xml");
    System.out.print("before getbean");
    Hello hello = (Hello) ctx.getBean("helloService");
    System.out.print("i am greeting from "+hello.greeting());
   }

 } 
```

ServiceBean.xml 文件如下：

```
<?xml version="1.0" encoding="UTF-8"?>
    <beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"      xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<bean id="Helloservice" class="org.springframework.remoting.rmi.RmiProxyFactoryBean">
    <property name="serviceUrl" value="rmi://localhost:1009/Services" />
    <property name="serviceInterface" value="com.rmi.client.Hello" />
</bean> 
```

界面是这样的：

```
package com.rmi.client;

public interface Hello {
  String greeting();
} 
```

基于桌面的 RMIServer 就像

```
package rmiapplication;
import java.net.MalformedURLException;
import java.rmi.Naming;
import java.rmi.RemoteException;
import java.rmi.registry.LocateRegistry;
public class RMIServer {
    public static void main(String[] args) throws RemoteException,  MalformedURLException {
       System.out.println("server conf...");
               LocateRegistry.createRegistry(1009);
               Hello hello = new HelloImpl();
               Naming.rebind("Services", hello);
               System.out.println("server.RMI Server is ready.");
        }

  } 
```

方法的实现部分是： -

```
package rmiapplication; 
```

导入 java.rmi.RemoteException；导入 java.rmi.server.UnicastRemoteObject；

公共类 HelloImpl 扩展 UnicastRemoteObject 实现 Hello{

```
private static final long serialVersionUID = 6789759288861838122L;

public HelloImpl() throws RemoteException {
    }

    public String greeting() throws RemoteException {
        System.out.print("i am at server side call");
        return "greeting";
    }

    } 
```

当我运行整个设置时，从 rmiregistry、RMIServer 和基于 web 的应用程序开始，我得到 java.rmi.NotBoundException 这里是完整的堆栈跟踪：-

```
SEVERE: Servlet.service() for servlet [rmi] in context with path [/SpringRMIClient] threw exception [Request processing failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.rmi.client.RMIService#0' defined in class path resource [ServiceBean.xml]: Cannot resolve reference to bean 'Helloservice' while setting bean property 'Helloservice'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'Helloservice' defined in class path resource [ServiceBean.xml]: Invocation of init method failed; nested exception is org.springframework.remoting.RemoteLookupFailureException: Could not find RMI service [rmi://localhost:1009/Services] in RMI registry; nested exception is        java.rmi.NotBoundException: Services] with root cause
    java.rmi.NotBoundException: Services
at sun.rmi.registry.RegistryImpl.lookup(Unknown Source)
at sun.rmi.registry.RegistryImpl_Skel.dispatch(Unknown Source)
at sun.rmi.server.UnicastServerRef.oldDispatch(Unknown Source)
at sun.rmi.server.UnicastServerRef.dispatch(Unknown Source)
at sun.rmi.transport.Transport$1.run(Unknown Source)
at sun.rmi.transport.Transport$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at sun.rmi.transport.Transport.serviceCall(Unknown Source)
at sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source)
at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Source)
at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
at java.lang.Thread.run(Unknown Source)
at sun.rmi.transport.StreamRemoteCall.exceptionReceivedFromServer(Unknown Source)
at sun.rmi.transport.StreamRemoteCall.executeCall(Unknown Source)
at sun.rmi.server.UnicastRef.invoke(Unknown Source)
at sun.rmi.registry.RegistryImpl_Stub.lookup(Unknown Source)
at java.rmi.Naming.lookup(Unknown Source)
at org.springframework.remoting.rmi.RmiClientInterceptor.lookupStub(RmiClientInterceptor.java:200)
at org.springframework.remoting.rmi.RmiClientInterceptor.prepare(RmiClientInterceptor.java:147)
at org.springframework.remoting.rmi.RmiClientInterceptor.afterPropertiesSet(RmiClientInterceptor.java:135)
at org.springframework.remoting.rmi.RmiProxyFactoryBean.afterPropertiesSet(RmiProxyFactoryBean.java:68)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1469)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1409)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)
at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1317)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1076)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:563)
at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:872)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:423)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83)
at com.rmi.client.MainController.callRMISever(MainController.java:13)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:175)
at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:421)
at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:409)
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:774)
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.ha.tcp.ReplicationValve.invoke(ReplicationValve.java:333)
at org.apache.catalina.ha.session.JvmRouteBinderValve.invoke(JvmRouteBinderValve.java:219)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:279)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)
at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

现在我不确定这出了什么问题我已经尝试过谷歌但没有任何成功现在我有两个基于此的问题

1.  如何消除上述异常，我也尝试过在局域网中使用不同的机器
2.  我们从基于 Web 的应用程序触发桌面应用程序的最佳方法是什么，以便它开始执行。完整的问题陈述是我们有在基于 Web 的应用程序上运行的编译器和在本地机器上运行的编译代码

谢谢，

我得到了解决方案，如果有人遇到与使用 RMI 的 Spring Web 应用程序和非 Spring 桌面应用程序通信相关的任何问题，请发邮件给我

感谢社区的支持

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T08:02:15.353

发现在某些情况下，spring 服务器和非 spring 客户端会在 rmi 上产生问题。但是当您使用非 spring 服务器和 spring 客户端（Web 服务器到桌面应用程序）时，这是可能的。就我而言，使用时出现问题

这是我的客户

```
public void getRMIServer(){
    Registry registry = null;
    Hello stub;
    try {
        System.out.println("IN RMI CLients");
        registry = LocateRegistry.getRegistry("localhost");
        stub = (Hello) registry.lookup("yash");
        System.out.println(stub.greeting());
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

这是我的服务器

```
public static void main(String[] args){
    try {
        System.out.println("RMI Server Started");
        HelloImpl hello = new HelloImpl();
        UnicastRemoteObject.unexportObject(hello, true);
        Hello stub = (Hello) UnicastRemoteObject.exportObject(hello, 0);
        Registry reg = LocateRegistry.createRegistry(1098);
        reg.rebind("yash", stub);
        System.out.println("server.RMI Server is ready.");
    } catch (Exception e) {
        e.printStackTrace();
    }

} 
```

我们还需要将驻留在服务器和客户端上的共享资源，这不过是通用接口

```
package shared;
import java.rmi.Remote;
import java.rmi.RemoteException;
import java.util.Map;
  public interface Start extends Remote{
  public void startRMI(Map<Object,Object> m) throws RemoteException;
  public void stopRMI() throws RemoteException;
} 
```

共享资源是扩展远程接口的接口

如果有人需要工作解决方案，请告诉我

# android - 如何通过名称引用从 XML 中获取字符串？

> ID：10033822
> 
> 赞同：0
> 
> 时间：2012-04-05T18:17:10.730
> 
> 标签：android

我正在尝试做这样的事情

```
public class CytatCore {

    public static void cytatCore(int number, TextView tv) {

       tv.setText(R.string.text+number);
    }
} 
```

我在 xml 中有很多名为“text1”、“text2”等的字符串。只有最后一个值在变化。我尝试以几种方式做到这一点，但我仍然在代码中遇到错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:23:38.190

我认为followin代码会为你工作

```
switch(number) {
    case 1 : tv.setText(R.string.text1);
    case 2 : tv.setText(R.string.text2);
} 
```

在使用此类型代码时，将 text1、text2 也放入您的 R.string；开关盒也处理得更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:25:48.713

我对您要完成的工作感到有些困惑，因为您的问题没有写清楚，但是我会在黑暗中尝试一下，并假设您的问题是

> 如何在 XML 中的字符串末尾附加一个数字？

**编辑：**我的假设是错误的，看来你的问题是

> 如何通过名称引用从 XML 中获取字符串？

使用`getIdentifier()`a 的方法`Context`将按名称查找 ID...但请注意，如果使用非常频繁，则不建议使用此操作，因为它很慢。

```
public class CytatCore {

    public static void cytatCore(Context context, int number, TextView tv) {

       int textId = context.getResources().getIdentifier("text" + number, "string", context.getPackageName());
       tv.setText(textId);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T18:42:01.977

另一个选择是获取对`Resources`对象的引用并使用方法[`getIdentifier()`](http://developer.android.com/reference/android/content/res/Resources.html#getIdentifier%28java.lang.String,%20java.lang.String,%20java.lang.String%29)。如果您正在进行一项活动，那么您可以执行以下操作：

```
public void cytatCore(int number, TextView tv) {    
    int id = getResources().getIdentifier("text" + 1, "string", this.getPackageName());
    t.setText(id);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:22:54.597

尝试将名称放入数组中：

```
...
private String[] ids = new String[N];
for (int i = 0; i < N; i++) {
    ids[i] = context.getString(R.string.resource_name) + i;
} 
```

进而：

```
...
public static void cytatCore(int i, TextView tv) {
    tv.setText(ids[i]);
} 
```

或者简单地说：

```
 ...
public static void cytatCore(int i, TextView tv) {
    tv.setText(context.getString(R.string.resource_name) + i);
} 
```

# sql - 在 PostgreSQL 9.1 中编写过程

> ID：10033825
> 
> 赞同：1
> 
> 时间：2012-04-05T18:17:17.690
> 
> 标签：sql, postgresql-9.1

我正在尝试在 Postgres 9.1 中编写一个过程（函数）来从视图中选择所有数据并返回它（所有列），以便我们的应用程序可以使用它。目的是让应用程序在需要数据时调用该过程。我的问题是我似乎无法获得正确的语法来让它返回任何数据。我在 MySQL、SQL Server 和 Oracle 中编写过程序，但从未在 postgres 中编写过程序，而且情况完全不同。一旦它工作是最好的方式来调用它只使用选择“函数名”？任何帮助，将不胜感激。

```
CREATE OR REPLACE FUNCTION fg.get_flight_times()
RETURNS setof record AS
$BODY$
declare times record;
begin
select * into times from fg.fn_dy_dest_dep_arr;
return;
end;
$BODY$
LANGUAGE plpgsql VOLATILE
COST 100;
ALTER FUNCTION fg.get_flight_times()
OWNER TO jason;
GRANT EXECUTE ON FUNCTION fg.get_flight_times() TO fltrakr; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:41:19.043

在 PL/pgSQL 函数中，您需要使用 RETURN NEXT 或 RETURN QUERY，如手册中所述：

[http://www.postgresql.org/docs/current/static/plpgsql-control-structures.html#AEN54092](http://www.postgresql.org/docs/current/static/plpgsql-control-structures.html#AEN54092)

`RETURNS setof record` 在 9.1 中不再需要用户，使用起来`returns table`更容易。如果你只想返回 SELECT 语句的结果，你也可以使用 SQL，这使得函数更容易：

```
CREATE OR REPLACE FUNCTION fg.get_flight_times()
    RETURNS table (col1 integer, col2 text, col3 text)
$BODY$
   select col1, col2, col3 from fg.fn_dy_dest_dep_arr;
$BODY$
LANGUAGE sql
VOLATILE
COST 100; 
```

请注意，在这种情况下，您必须在创建时指定函数返回的列定义。使用该版本，您只需使用：

```
select * from fg.get_flight_times(); 
```

使用时，`returns setof record`您不需要在创建时指定列，但是从函数中选择时将被迫这样做（我发现这更复杂，因为*每次*使用函数时都需要这样做）：

```
CREATE OR REPLACE FUNCTION fg.get_flight_times()
    RETURNS setof record
$BODY$
   select * from fg.fn_dy_dest_dep_arr;
$BODY$
LANGUAGE sql
VOLATILE
COST 100; 
```

这是这样使用的：

```
select *
from fg.get_flight_times() f(col1 integer, col2 text, col3 text); 
```

在我看来要复杂得多（因为调用者需要知道列的结构**和**数据类型）

请阅读手册，我在这里写的所有内容也都记录在那里（我知道它只是因为我已经阅读了手册......）

# ruby-on-rails-3 - FactoryGirl Rspec 和 SQLite3::ConstraintException

> ID：10033830
> 
> 赞同：0
> 
> 时间：2012-04-05T18:17:29.177
> 
> 标签：ruby-on-rails-3, rspec, factory-bot

我正在尝试创建一些关联的工厂，但事件不起作用：

**工厂.rb**

```
 factory :user, class: User do
    first_name 'John'
    last_name 'Doe'
    email { "#{first_name}.#{last_name}@example.com".downcase } 
    username 'johndoe'
    password 'johndoe'
    password_confirmation 'johndoe'

    association :account_id, factory: :account 
  end

  factory :account, class: Account do
    #id is the only field
  end

  factory :event, class: Event do
    name 'Go to the Dentist'
    start_date "#{Time.now.next_month}"  
    end_date "#{Time.now+1.hour.next_month}" 
    copyright "#{Time.now.year}" 

    association :account_id, factory: :account  
  end 
```

**控制器规格.rb**

```
before(:each) do
  @request.env["devise.mapping"] = Devise.mappings[:user]
  @user = FactoryGirl.create(:user_profile, :username => 'johndoe' )
  sign_in @user
  @acct = FactoryGirl.create(:account, :id => @user.account_id)
  @event = FactoryGirl.create(:event, :account_id => @acct.id)
end 
```

但是这条事件线是一切都出错的地方。即使我使用 @user.account_id 为事件设置 :account_id ，它也会失败并出现以下错误：

```
Failure/Error: @event = FactoryGirl.create(:event, :account_id => @acct.id)
     ActiveRecord::StatementInvalid:
       SQLite3::ConstraintException: constraint failed: INSERT INTO "event" ("account_id", "copyright", "created_at", "deleted", "end_date", "info", "name", "start_date", "type", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
     # ./spec/controllers/controller_spec.rb:13:in `block (3 levels) in <top (required)>' 
```

非常感谢您对此提供的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T20:22:47.660

我认为您获得约束异常的原因是您的表中已经有一些数据与您尝试添加的信息相冲突。

您可能想删除所有数据，然后尝试 rspec 测试用例。

# asp.net - 在会话到期时注销用户

> ID：10033831
> 
> 赞同：0
> 
> 时间：2012-04-05T18:17:32.837
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, session, forms-authentication

如果会话过期，强制用户再次登录的最佳方法是什么。我正在使用表单身份验证。即使用户在浏览器中打开了多个选项卡，该解决方案也需要工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T18:40:28.730

这会自动发生。会话过期后，用户请求的需要身份验证的下一页应重定向到登录页面。如果您的意思是如果放置时间过长希望页面不再显示，则有几种方法。

1.  将[META REFRESH 标记](https://stackoverflow.com/questions/484964/asp-net-push-redirect-on-session-timeout)添加到每个页眉。刷新时间应该接近或等于会话超时。请注意，如果您进行 AJAX 调用，刷新标签不会将计时器重置为零。

2.  使用[Javascript setTimeout 函数](https://stackoverflow.com/search?q=javascript%20settimeout%20session%20timeout)在会话超时之前进行重定向。

# sql - 使用 LIKE 组合过滤结果的方法

> ID：10033833
> 
> 赞同：0
> 
> 时间：2012-04-05T18:17:45.987
> 
> 标签：sql, sql-server

我在人和一些电子代码之间有多对多的关系。带有代码的表格有代码本身，以及代码的文本描述。查询的典型结果集可能是（有许多包含“损坏”的代码，所以我觉得最好搜索文本描述而不是为每个代码添加一堆 OR。）

```
id#    text of code
1234   broken laptop
1234   broken mouse 
```

目前，我获得这样的结果集的最佳方法是使用`LIKE%broken%`过滤器。在不更改文本描述的情况下，有什么方法可以只返回一个代码实例`broken`？因此，在上面的示例中，查询只会返回 1234 和损坏的鼠标或损坏的笔记本电脑。在这种情况下，返回哪个并不重要，我要寻找的是该人代码的任何文本描述中是否存在“损坏”。

我目前的解决方案是创建一个可以返回的视图

```
`id#    text of code
1234   broken laptop
1234   broken mouse` 
```

并`SELECT DISTINCT ID#`在查询视图时使用以获取每个视图的一个实例。

实际编辑查询

`SELECT tblVisits.kha_id, tblICD.descrip, min(tblICD.Descrip) as expr1 FROM tblVisits inner join icd_jxn on tblVisits.kha_id = icd_jxn.kha)id inner join tblICD.icd_fk=tblICD.ICD_ID group by tblVisits.kha_id, tblicd.descrip having (tblICD.descrip like n'%broken%')`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:21:22.603

您可以使用以下查询来选择 MIN 代码。这将确保每个 id 只有文本。

```
SELECT t.id, MIN(t.textofcode) as textofcode
FROM table t
WHERE t.textofcode LIKE '%broken%'
GROUP BY t.id 
```

更新的实际查询：

```
SELECT tblVisits.kha_id, 
  MIN(tblICD.Descrip) 
FROM tblVisits 
INNER JOIN icd_jxn ON tblVisits.kha_id = icd_jxn.kha)id 
INNER JOIN tblicd ON icd_jxn.icd_fk = tbl.icd_id
WHERE tblICD.descrip like n'%broken%'
GROUP BY tblVisits.kha_id 
```

# python - 使用 Python 在父文件夹中启动 qsub 失败

> ID：10033835
> 
> 赞同：2
> 
> 时间：2012-04-05T18:18:00.090
> 
> 标签：python, pbs

我正在创建一个 Python 脚本来在远程计算集群上设置一系列计算。但是我遇到了一个问题。

远程服务器上的计算使用以下命令开始：

```
qsub Run.sh 
```

Run.sh 位于文件夹 ./sol/

如果我输入 ./sol/ 并运行：

```
python25 -c "import os;os.system(\"qsub Run.sh\")" 
```

每件事都像它应该的那样工作。但是，如果我位于 ./ 并运行此命令：

```
python25 -c "import os;os.chdir(\"sol\");os.system(\"qsub Run.sh\")" 
```

qsub 失败并显示此错误消息：

```
*** error from copy
Host key verification failed.
lost connection
*** end error output 
```

有人知道为什么吗？我使用 python 2.5.1 和 unix 2.6.18

# javascript - 如何在不使用 innerHTML 的情况下添加特殊的 html 字符

> ID：10033837
> 
> 赞同：2
> 
> 时间：2012-04-05T18:18:05.847
> 
> 标签：javascript, html

所以我正在研究一个微型库[html.js](https://github.com/voldsoftware/html/)，基本上它创建了文本节点`document.createTextNode`但是当我想创建一个文本节点时`a&nbsp;b`我得到`a&amp;nbsp;b`了所以我想知道如何在`&`不使用 innerHTML 的情况下转义字符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:47:18.333

Javascript 支持该`\uXXXX`表示法，因此在不间断空格的情况下，它将是`\u00A0`.

`document.createTextNode('a\u00A0b');`

这就是你所能得到的。它是一个文本节点，仅由文本组成，从实体引用创建的文本或从普通字符创建的文本之间没有区别。

如果这不是您想要的，您应该再看一下 innerHtml。你不能阅读它，修改它并把它放回去吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:28:23.440

js 中没有太多功能来编码/解码 html 实体。不过，似乎有一些库可以帮助您实现这一目标。这是我在goodle上找到的一个..没有尝试过，但你可以检查一下，或者寻找其他人。

[http://www.strictly-software.com/htmlencode](http://www.strictly-software.com/htmlencode)

# php - 序列化对象并缓存它们的奇怪行为

> ID：10033842
> 
> 赞同：3
> 
> 时间：2012-04-05T18:18:26.643
> 
> 标签：php, zend-framework, serialization, zend-cache

我遇到了一个我似乎无法缩小范围的问题。在 Zend Framework 应用程序中，我使用 Zend Cache 来缓存自定义*Response*对象中包含的潮汐和天气数据。最初创建数据时，一切正常。我序列化它并缓存它。然后当我点击刷新并从缓存中提取数据时，我收到以下错误：

> **消息：字符串无法解析为 XML**
> 
> 堆栈跟踪：
> 
> 0 /home/cilosis/mysites/tidely/application/views/scripts/tides/location.phtml(38): SimpleXMLElement->__construct('')
> 
> 1 /home/cilosis/mysites/tidely/library/Zend/View.php(108): include('/home/cilosis/...')
> 
> 2 /home/cillosis/mysites/tidely/library/Zend/View/Abstract.php(888): Zend_View->_run('/home/cillosis/...')
> 
> ...

这发生在我正在访问包含在我的自定义“响应对象”中的 XML 的视图中：

```
<div class="data-box">

<h3>Current Weather</h3>
<hr>
<?php

// *** THIS IS LINE 38  ***                         
$weather_XML = new SimpleXMLElement($this->response->_weatherdata->weatherResults);
$params = $weather_XML->data->parameters;

$img_path = $params->{'conditions-icon'}->{'icon-link'};

echo("<img src='".$img_path."'>");

... 
```

这是第一次运行时（缓存之前）对象相关部分的转储：

```
["_weatherdata"]=>
  object(Tidely_WeatherData)#79 (6) {
    ["weatherResults"]=>
    string(6399) "<?xml version="1.0"?>
       <dwml version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="http://graphical.weather.gov/xml/DWMLgen/schema/DWML.xsd">
          ...
       </dwml> " 
```

在您看到“...”的地方，还有很多其他 XML 数据。XML 来自 NWS（国家气象服务）API，我通过 XML 验证器运行它，它没有显示任何错误。一旦我序列化我的对象并缓存它，问题就会发生。下面是我的 Zend Cache 设置：

```
// Setup caching
$frontendOptions = array('lifeTime' => 30, 'automatic_seralization' => false);
$backendOptions = array('cache_dir' => '../application/cache');
$this->_cache = Zend_Cache::factory('Core', 'File', $frontendOptions, $backendOptions); 
```

我正在用这个进行缓存和检索：

```
// Assign cache id
// Example query: "Chesapeake Bay Virginia"
$cache_id = 'request_results_' . $this->response->_querydata->query);
$cache_id = str_replace(' ', '_', $cache_id);
$cache_id = str_replace('-', '_', $cache_id);

// Check cache for this query
if ( ($results = $this->_cache->load($cache_id)) === false)
{
   // Cache not found, process request and generate response
   ...

   // Cache request output for specific query
   $serialized_data = serialize($this->response);
   $this->_cache->save($serialized_data, $cache_id);

   // Return processed request results
   return $this->response;
}
else
{
   // Return results from cache
   return unserialize($results);
} 
```

一旦我发出请求并缓存它，`$this->response`对象输出如下：

> object(Tidely_ResponseData)#65 (7) { ["_querydata"]=> object(Tidely_QueryData)#66 (9) { ["query"]=> string(40) "bayou-la-batre-mississippi-sound alabama" ["source"]=> string(15) "TidesController" ["request_type"]=> string(3) "url" ["url_components"]=> array(2) { ["state"]=> string(7 ）“阿拉巴马州”[“位置”]=>字符串（32）“bayou-la-batre-mississippi-sound”}[“return_type”]=>字符串（4）“JSON”[“time_range”]=>数组（ 2) { ["start"]=> object(DateTime)#64 (3) { ["date"]=> string(19) "2012-04-05 18:06:51" ["timezone_type"]=> int(3) ["timezone"]=> 字符串(3) "UTC" } ["end"]=>object(DateTime)#63 (3) { ["date"]=> string(19) "2012-04-06 18:06:51" ["timezone_type"]=> int(3) ["timezone"]= > string(3) "UTC" } } ["hasError"]=> bool(false) ["userMessage"]=> NULL ["logMessage"]=> NULL } ["_locationdata"]=> object(Tidely_LocationData)# 80 (31) { ["location_id"]=> string(5) "18921" ["station_name"]=> string(33) "Bayou La Batre, Mississippi Sound" ["station_url_name"]=> string(32) " Bayou-la-batre-mississippi-sound" ["station_type"]=> string(11) "下属" ["station_id"]=> string(7) "8739051" ["station_lat"]=> string(8) " +30.3717" ["station_lon"]=> 字符串(8) "-88。2750" ["station_height_offset_high"]=> 字符串(5) "*1.23" ["station_height_offset_low"]=> 字符串(5) "*1.23" ["station_time_offset_high"]=> 字符串(3) "112" ["station_time_offset_low" ]=> 字符串(2) "74" ["station_ref_station_id"]=> 字符串(7) "8760551" ["state_id"]=> 字符串(1) "1" ["state_name"]=> 字符串(7) "阿拉巴马州" ["state_url_name"]=> 字符串(7) "阿拉巴马州" ["timezone"]=> 字符串(2) "-6" ["dst"]=> 字符串(1) "1" ["city_name"] => string(14) "Bayou La Batre" ["city_zip"]=> string(5) "36509" ["city_lat"]=> string(7) "30.4014" ["city_lon"]=>string(8) "-88.2467" ["adjacentStations"]=> string(321) "a:10:{i:8739051;d:2.6562027890531361;s:7:"TEC4393";d:8.0529290086617618;i:8740448;d ：11.564338218805837; I：8735180; d：14.637787569358004; I：8741196; d：17.602722038773138; I：8734635; d：17.824002491920826; I：8733810; d：19.474837234444919; I：8737048; d：24.414028460259932; I：8742221; d：27.466706516499691 ;i:8731952;d:31.251405048051701;}" ["city_distance"]=> string(15) "2.6562027890531" ["multipleResults"]=> string(0) "" ["multipleCount"]=> int(0) [ "hasMultiple"]=> bool(false) ["showStates"]=> bool(false) ["showLocations"]=> bool(false) ["hasError"]=> bool(false) ["userMessage"]=> NULL ["logMessage"]=> NULL } ["_tidedata"]=> object(Tidely_TideData)#68 (6) { ["tideResults"]=> NULL ["queryStart"]=> NULL ["queryEnd"]=> NULL ["hasError"]=> bool(false) [" userMessage"]=> NULL ["logMessage"]=> NULL } ["_weatherdata"]=> object(Tidely_WeatherData)#79 (6) { ["weatherResults"]=> string(6399) " 气象预报 2012-04- 05T18:06:57Z[http://graphical.weather.gov/xml/](http://graphical.weather.gov/xml/)气象发展实验室产品生成处[http://www.nws.noaa.gov/disclaimer.html](http://www.nws.noaa.gov/disclaimer.html) http://www.weather.gov/ [http://www.weather. gov/images/xml_logo.gif](http://www.weather.gov/images/xml_logo.gif) http://www.weather.gov/feedback.php point1 [http://forecast.weather.gov/MapClick.php?textField1=30.37&textField2=-88.28](http://forecast.weather.gov/MapClick.php?textField1=30.37&textField2=-88.28)k-p24h-n1-1 2012-04-05T08:00:00-05:00 2012-04-05T20:00:00-05:00 k-p24h-n1-2 2012-04-05T20:00:00- 05:00 2012-04-06T09:00:00-05:00 k-p3h-n5-3 2012-04-05T13:00:00-05:00 2012-04-05T16:00:00-05:00 2012 -04-05T19:00:00-05:00 2012-04-05T22:00:00-05:00 2012-04-06T01:00:00-05:00 每日最高温度 81 每日最低温度 63 温度 79 79 74 69 67 露点温度 66 65 64 64 61 风速 12 11 11 13 14 风向 240 260 280 300 330 相对湿度 64 63 71 84 81 天气类型、覆盖范围和强度条件图标[http://forecast.weather.gov/ images/wtf/tsra60.jpg](http://forecast.weather.gov/images/wtf/tsra60.jpg) http://forecast.weather.gov/images/wtf/tsra60.jpg [http://forecast.weather.gov/images/wtf/scttsra60.jpg](http://forecast.weather.gov/images/wtf/scttsra60.jpg) http://forecast.weather.gov /images/wtf/nscttsra20.jpg[http://forecast.weather.gov/images/wtf/nsct.jpg](http://forecast.weather.gov/images/wtf/nsct.jpg) " ["queryStart"]=> float(1333649211.6989) ["queryEnd"]=> float(1333649217.2038) ["hasError"]=> bool(false ) ["userMessage"]=> NULL ["logMessage"]=> NULL } ["hasError"]=> bool(false) ["userMessage"]=> NULL ["logMessage"]=> NULL }

当我*查看源代码*时，“weatherResults”部分有 XML ，我没有复制和粘贴它，因为它相当长。这是当我按下刷新并使用上述对象的缓存副本时发生的情况：

> object(Tidely_ResponseData)#65 (7) { ["_querydata"]=> object(Tidely_QueryData)#66 (9) { ["query"]=> string(40) "bayou-la-batre-mississippi-sound alabama" ["source"]=> string(15) "TidesController" ["request_type"]=> string(3) "url" ["url_components"]=> array(2) { ["state"]=> string(7 ）“阿拉巴马州”[“位置”]=>字符串（32）“bayou-la-batre-mississippi-sound”}[“return_type”]=>字符串（4）“JSON”[“time_range”]=>数组（ 2) { ["start"]=> object(DateTime)#64 (3) { ["date"]=> string(19) "2012-04-05 18:10:30" ["timezone_type"]=> int(3) ["timezone"]=> 字符串(3) "UTC" } ["end"]=>object(DateTime)#63 (3) { ["date"]=> string(19) "2012-04-06 18:10:30" ["timezone_type"]=> int(3) ["timezone"]= > string(3) "UTC" } } ["hasError"]=> bool(false) ["userMessage"]=> NULL ["logMessage"]=> NULL } ["_locationdata"]=> object(Tidely_LocationData)# 67 (31) { ["location_id"]=> string(0) "" ["station_name"]=> string(0) "" ["station_url_name"]=> string(0) "" ["station_type"]= > string(0) "" ["station_id"]=> string(0) "" ["station_lat"]=> string(0) "" ["station_lon"]=> string(0) "" ["station_height_offset_high" ]=> 字符串(0) "" ["station_height_offset_low"]=> string(0) "" ["station_time_offset_high"]=> string(0) "" ["station_time_offset_low"]=> string(0) "" ["station_ref_station_id"]=> string(0) "" ["state_id"]=> string(0) "" ["state_name"]=> string(0) "" ["state_url_name"]=> string(0) "" ["timezone"]=> string(0) "" ["dst"]=> 字符串(0) "" ["city_name"]=> 字符串(0) "" ["city_zip"]=> 字符串(0) "" ["city_lat"]=> 字符串( 0) "" ["city_lon"]=> 字符串(0) "" ["adjacentStations"]=> 字符串(0) "" ["city_distance"]=> 字符串(0) "" ["multipleResults"]=> string(0) "" ["multipleCount"]=> int(0) ["hasMultiple"]=> bool(false) ["showStates"]=> bool(false) ["showLocations"]= > bool(false) ["hasError"]=> bool(false) ["userMessage"]=> NULL ["logMessage"]=> NULL } ["_tidedata"]=> object(Tidely_TideData)#68 (6) { ["tideResults"]=> NULL ["queryStart"]=> NULL ["queryEnd"]=> NULL ["hasError"]=> bool(false) ["userMessage"]=> NULL ["logMessage"]=> NULL } ["_weatherdata"]=> object(Tidely_WeatherData)#69 (6) { ["weatherResults"]=> NULL ["queryStart"]=> NULL ["queryEnd"]=> NULL ["hasError"]=> bool(false) ["userMessage"]=>NULL ["logMessage"]=> NULL } ["hasError"]=> bool(false) ["userMessage"]=> NULL ["logMessage"]=> NULL }

在序列化/反序列化和保存缓存的过程中，它以某种方式将所有字符串设置为空或NULL！所以当然，我收到了 XML 错误，因为它是空的。

是否有其他人在使用 Zend Cache（或任何其他缓存库）缓存对象时遇到问题？这与序列化有关吗？我缺少缓存设置吗？很抱歉解释太长，并提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T19:46:06.110

PHP 资源**不能被序列化**，这就是为什么你不能序列化你的对象（这将间接序列化一个 SimpleXML 对象）。

在序列化之前，您需要将您的对象转换为格式良好的 XML 字符串 ( `SimpleXMLElement::asXML()`)，一旦您的对象被反序列化，将您的字符串重新转换为 SimpleXML 对象 ( `simplexml_load_string()`)。

[请参阅此处](http://fr2.php.net/manual/en/book.simplexml.php)了解更多信息。[这个问题](https://stackoverflow.com/questions/1992906/why-it-is-not-possible-to-serialize-php-built-in-objects)也很有用。

* * *

**在新的细节后编辑**：在您的问题中有这些新元素，我知道您的问题不是来自序列化的 SimpleXML 对象。你有什么理由不使用`automatic_serialization`吗？（顺便说一下，**我**猜你拼错了）而不是让 Zend_Cache 自动序列化/反序列化你的对象。

* * *

**编辑#2**：阅读以下来自*cilosis*的评论以获得最终解决方案。

# ruby-on-rails - Sunspot::Rails - 如何在保存某些请求后不提交

> ID：10033845
> 
> 赞同：1
> 
> 时间：2012-04-05T18:18:35.193
> 
> 标签：ruby-on-rails, sunspot, sunspot-rails

我有一个模型可以在查看后更新其查看次数。这会导致模型被重新索引，即使 view-count 属性没有被索引。显然，我不会在每次查看页面时都点击 Solr。

在此特定操作期间，如何防止 Sunspot 提交对此模型的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:24:36.567

我只是在这里猜测，但太阳黑子是否可能与 Rails 交易挂钩？如果是这样，您可能希望在活动记录之外手动更新观看次数，如下所示：

```
class Page
  after_commit :update_counter
  def update_counter
    unless self.persisted?
      Page.update_all(["page_count = ?", self.page_count + 1, "id = #{self.id}")
    end
   end
end 
```

# java - Java 中的“val$title”（美元符号表达式）是什么？

> ID：10033847
> 
> 赞同：5
> 
> 时间：2012-04-05T18:18:58.817
> 
> 标签：java, swing

```
private void launchEventPanel(String title) {
    EventQueue.invokeLater(new Runnable(title) {
        public void run() {
            JFrame myFrame = new JFrame();
            myFrame.setTitle(this.val$title);
            myFrame.setIconImage(CrConference.this.mainCore.myPanel.myIconManager.getPromptIcon(Mart.class.toString()));
            myFrame.getContentPane().add(Conference.this.myEventPanel, "Center");
            myFrame.pack();
            myFrame.setVisible(true);
        }
    });
} 
```

我得到了一些我试图编译和理解的代码。高度赞赏的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T18:21:20.893

如[here](http://www.dreamincode.net/forums/topic/238605-decompiled-java-code-val-fix/page__view__findpost__p__1723899?s=db3843f9efe50a397d66c26812a5e0f4 "Dream.In.Code 论坛：反编译的 Java 代码，Val$ 修复")和[here](http://www.mindfiresolutions.com/A-tip-on-val%24-field-in-Java-decompiled-code-1725.php "Mindfire 解决方案：Java 反编译代码中 val$ 字段的提示")所述，构造函数的参数`Runnable`和字段名称的“this.val$”由编译器添加并显示在生成的字节码中。因此，这些额外的东西反映在反编译的代码中。

要获得原始的反编译代码，请在前面的调用和from`final`的声明中添加`title`和删除：`title``Runnable``this.val$``title`

```
private void launchEventPanel(final String title) {
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            JFrame myFrame = new JFrame();
            myFrame.setTitle(title);
            myFrame.setIconImage(CrConference.this.mainCore.myPanel.myIconManager.getPromptIcon(Mart.class.toString()));
            myFrame.getContentPane().add(Conference.this.myEventPanel, "Center");
            myFrame.pack();
            myFrame.setVisible(true);
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T18:21:46.847

这一行：

```
myFrame.setTitle(this.val$title); 
```

`JFrame`只是简单地设置一个对象的标题，使用属性的值`val$title`来做到这一点。`val$title`是当前类的实例属性，它的名称有点不寻常（因为`$`），但对于 Java 中的标识符有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T18:21:17.710

第 5 行只是设置框架的标题（您在 windows 的窗口框架顶部看到的文本）“this.val$title”只是一个名为 val$title 的本地成员，编写代码的人存储了标题字符串在。

虽然很少看到大多数基于 C 的语言将 $ 视为字母字符，如 az 或 AZ。

# paypal - Moodle Paypal_enrolment 插件不能与 Paypal 沙盒一起使用？

> ID：10033849
> 
> 赞同：0
> 
> 时间：2012-04-05T18:19:17.473
> 
> 标签：paypal, paypal-sandbox, moodle

我正在使用 Moodle 1.9 Paypal_enrolment 插件，以便访问课程的学生首先通过贝宝支付金额，然后访问课程。

我正在按照此处给出的步骤进行操作：

[http://docs.moodle.org/19/en/Paypal_enrolment](http://docs.moodle.org/19/en/Paypal_enrolment)

实施后，我想用 Paypal Sanbox 进行测试，但遇到了一些问题。我们如何启用贝宝沙箱，以便我可以在贝宝沙箱中测试流程。也检查这个链接[http://moodle.org/mod/forum/discuss.php?d=171745](http://moodle.org/mod/forum/discuss.php?d=171745)阐述了与我类似的问题。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T09:00:52.447

要启用 Paypal 沙箱，您需要在 中添加以下代码行`config.php`：

```
$CFG->usepaypalsandbox = 'TRUE'; 
```

不确定这是否已同时修复，但您可能还需要编辑`ipn.php`以使用 SSL 和端口 443：

```
$paypaladdr = empty($CFG->usepaypalsandbox) ? 'www.paypal.com' : 'ssl://www.sandbox.paypal.com';
$fp = fsockopen ($paypaladdr, 443, $errno, $errstr, 30); 
```

更多信息：

[http://docs.moodle.org/dev/Enrolment_plugins#Note_about_Paypal_Sandbox](http://docs.moodle.org/dev/Enrolment_plugins#Note_about_Paypal_Sandbox)

# groovy - 如何将参数传递给 Groovy 中的 ant.java() 方法

> ID：10033853
> 
> 赞同：0
> 
> 时间：2012-04-05T18:19:54.337
> 
> 标签：groovy, antbuilder

我正在尝试将 ant`<java>`任务转换为 groovy。我正在使用以下代码：

```
def ant = new AntBuilder();
ant.java(classpath:'jar_file_path', classname:'Main', fork:'true') 
```

我还有一个要传递给该方法的命令行参数列表。

*   Q1。我应该如何将命令行参数传递给 groovy 中的方法？
*   Q2。任何关于 groovy 的文档可以让我快速入门吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:25:39.973

你应该能够做到：

```
def ant = new AntBuilder();
ant.java(classpath:'jar_file_path', classname:'Main', fork:'true') {
  arg( value: 'arg 1' )
} 
```

至于学习 Groovy，[groovy in action](http://www.manning.com/koenig2/)第二版可作为早期访问电子书获得

# java - 枚举国际化异常

> ID：10033855
> 
> 赞同：0
> 
> 时间：2012-04-05T18:20:03.820
> 
> 标签：java

我有一个枚举，我试图将其国际化，例如：

```
public enum ActivityEnum {
PROJECT_CREATED, PROJECT_EDITED, PROJECT_DONATION;

@Override
public String toString() {
    switch (this) {
    case PROJECT_CREATED:
        return Messages.get("activity.project.created");
    case PROJECT_EDITED:
        return Messages.get("activity.project.edited");
    case PROJECT_DONATION:
        return Messages.get("activity.project.donation");
        default: return super.toString();
    }
}

private ActivityEnum activityEnum;

public ActivityEnum getActivityEnum() {
    return activityEnum;
}

public void setActivityEnum(ActivityEnum activityEnum) {
    this.activityEnum = activityEnum;
} 
```

}

现在，请注意我的 messages.properties 中定义的键包含字符串格式化程序，例如：

```
activity.project.created = User <%s> created project <%s> 
```

好吧，问题是当我在代码中的其他地方对这个枚举做一些事情时，它会抛出一个异常，比如：

```
MissingFormatArgumentException occured : Format specifier 's' 
```

所以基本上它希望当我在`toString`enum 类中获得密钥时，也应用 args 进行格式化，但这我只在以后使用该枚举时才这样做......

```
activity.summary = String.format(activityEnum.toString(), args); 
```

你能给我一个关于如何处理这个问题的建议吗？

**更新**：

如果我使用经典方式，一切都很好：

```
PROJECT_CREATED("User <%s> created project <%s>"), PROJECT_EDITED(
        "User <%s> edited project <%s>"), PROJECT_DONATION(
        "User <%s> made a donation of <%d> to project <%s>"); 
```

但这没有国际化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:56:39.030

*   在构造函数中传递密钥并将其存储在成员字段中
*   写一个方法，如：

    公共字符串 toDisplayString(String... args){ ... }

*   摆脱 switch 语句

# c# - 是否可以在电子邮件正文中发送 aspx 页面？

> ID：10033862
> 
> 赞同：0
> 
> 时间：2012-04-05T18:20:50.387
> 
> 标签：c#, asp.net, email, c#-4.0, smtp

```
<div class="popup-holder">
            <div class="popup-frame">
                <div class="container">
                    <div class="mail-block">
                        <div class="mail-holder">
                            <strong class="mail-logo"><a href="#">abc website</a></strong>
                            <div class="mail-page">
                                <div class="mail-page-holder">
                                    <div class="mail-page-frame">
                                        <p>Hello &lt;<asp:Label ID="lblfriend" runat="server" Text="Label"></asp:Label>>!,</p>
                                        <p>Great News!  &lt;One of your FB Friends/<asp:Label ID="lblmyname" runat="server" Text="Label"></asp:Label>>  has invited you to BlissLink.</p>
                                        <p>(<asp:Label ID="lblmyname1" runat="server" Text="Label"></asp:Label>) says:  &lt;<asp:Label
                                            ID="lblmess" runat="server" Text="abc is fun ,"></asp:Label>><br /><br /></p>
                                        <p></p>
                                        <ul class="f-list">
                                            <li>
                                                <asp:Image ID="Image3" runat="server" width="48" height="48" />
                                                <strong class="title"><span><asp:Label ID="Label2" runat="server" ></asp:Label></span></strong>
                                            </li>
                                            <li>
                                                <asp:Image ID="Image4" runat="server" width="48" height="48" />
                                                <strong class="title"><span> 
                                                    <asp:Label ID="Label3" runat="server" ></asp:Label></span></strong>
                                            </li>
                                            <li>
                                                <asp:Image ID="Image5" runat="server" width="48" height="48" />
                                                <strong class="title"><span><asp:Label ID="Label4" runat="server" ></asp:Label></span></strong>
                                            </li>
                                            <li>
                                                <asp:Image ID="Image6" runat="server" width="48" height="48" />
                                                <strong class="title"><span><asp:Label ID="Label5" runat="server" ></asp:Label></span></strong>
                                            </li>
                                            <li>
                                                <asp:Image ID="Image7" runat="server" width="48" height="48" />
                                                <strong class="title"><span> <asp:Label ID="Label6" runat="server"></asp:Label></span></strong>
                                            </li>
                                            <li>
                                                <asp:Image ID="Image8" runat="server" width="48" height="48" />
                                                <strong class="title"><span> <asp:Label ID="Label7" runat="server" ></asp:Label></span></strong>
                                            </li>
                                            <li>
                                                <asp:Image ID="Image9" runat="server" width="48" height="48" />
                                                <strong class="title"><span><asp:Label ID="Label8" runat="server" ></asp:Label></span></strong>
                                            </li>
                                            <li>
                                                <asp:Image ID="Image10" runat="server" width="48" height="48" />
                                                <strong class="title"><span> <asp:Label ID="Label9" runat="server" ></asp:Label></span></strong>
                                            </li>
                                            <li>
                                                <asp:Image ID="Image11" runat="server" width="48" height="48" />
                                                <strong class="title"><span><asp:Label ID="Label10" runat="server" ></asp:Label></span></strong>
                                            </li>
                                            <li>
                                                <asp:Image ID="Image12" runat="server" width="48" height="48" />
                                                <strong class="title"><span><asp:Label ID="Label11" runat="server" ></asp:Label></span></strong>
                                            </li>
                                        </ul>
                                        <asp:Button ID="Button6" runat="server" Text="Expand Your Network"  CssClass="btn" />
                                        <span class="bot-text">Cheers,<br />Your abc Team</span>
                                    </div>
                                </div>
                            </div>
                            <span class="un">If you have no more interest in receiving our news, <a href="#">unsubscribe.</a></span>
                        </div>
                    </div>
                </div>
            </div>
        </div> 
```

这些图像是在运行时决定的，是否将其嵌入到电子邮件正文中

请帮忙

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T18:35:34.163

如果您只想要电子邮件中的那部分标记，则将其放在用户控件 (myEmailControl.ascx) 中。然后，您可以从发送电子邮件的脚本中调用控件上的 Render() 并拦截控件的 html 输出。然后，您可以将该 html 放入电子邮件正文中。（您的图片还需要绝对网址，以便它们显示在电子邮件中，但我相信您已经想到了这一点）

发送电子邮件的页面/处理程序：

```
 StringBuilder htmlResponse = new StringBuilder();
    using (StringWriter sw = new StringWriter(htmlResponse))
    {
        using (HtmlTextWriter textWriter = new HtmlTextWriter(sw))
        {
            Control emailBody = Page.LoadControl("myEmailControl.ascx");
            emailBody.RenderControl(textWriter);
        }
    }
    string emailHtml = htmlResponse.ToString(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T18:27:38.550

您可以从页面下载呈现的 HTML 并将其发送：

```
WebRequest request = WebRequest.Create("http://server.com/path/to/page.aspx");
WebResponse response = request.GetResponse();

StringReader reader = new StringReader(response.GetResponseStream());

string html = reader.ReadToEnd(); 
```

现在您只需发送`html`电子邮件中的内容即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:29:10.883

您最好的选择可能是将图像输出为 HTML 中的 Base 64。

```
<img src="data:image/png;base64,iVBrkJggg==" alt="Base 64 encoded!" /> 
```

在您后面的代码中，获取图像，将其转换为 Base 64 并将其打印为 src！

# android - 调试Android引擎连接Android项目时出现NoClassDefFoundError

> ID：10033863
> 
> 赞同：1
> 
> 时间：2012-04-05T18:20:50.607
> 
> 标签：android

我正在努力解决我的新 Android C2DM 测试项目的一个问题： **Android Engine Connected Android Project。** 问题是：

在 LogCat: **04-04 19:35:09.414: E/AndroidRuntime(320): java.lang.NoClassDefFoundError: com.google.android.c2dm.C2DMessaging**

调试窗口中的位置： **InvocationTargetException.class** InvocationTargetException.(Thrownable) 第 50 行

例外：**NoClassDefFoundError**

1.  有谁知道我缺少什么文件（以及在哪里）以及如何修复？
2.  知道在哪里/如何获取用于调试的 Google API 源？

非常感谢您的投入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T11:14:17.677

问题是最新的 ADT 不允许库（.jar）在除“libs”之外的任何其他文件夹中，因此请将文件夹从“lib”重命名为“libs”，然后再次添加现有的三个库（.jar）。

# php - 日期格式函数

> ID：10033870
> 
> 赞同：0
> 
> 时间：2012-04-05T18:21:26.430
> 
> 标签：php, date, format

也许是一个愚蠢的问题，但我找不到合适的功能：

我有一个字符串日期`04/05/2012`

我如何才能传递到这种格式：`2012-04-05 20:18:11`插入 mySQL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:23:24.487

日期和strtotime的组合...

```
$my_date = date('Y-m-d H:i:s',strtotime('04/05/2012')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:25:04.117

```
$dateTime = new DateTime($your_time_string);
echo $dateTime->format("Y-m-d H:i:s"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T18:25:53.173

时间不能靠自己“制造”。但是，如果您要插入当前的日期时间设置，则将使用以下代码：

```
$dt = date( "Y-m-d H:i:s", time() ); 
```

您可以使用`dleiftah`' 语句，但这种情况下的时间将始终是`00:00:00`

# java - java服务器和android客户端之间的SSL连接失败

> ID：10033872
> 
> 赞同：0
> 
> 时间：2012-04-05T18:21:30.830
> 
> 标签：java, android, ssl

我正在尝试在 java 主机和 android 客户端之间设置相互身份验证 SSL 连接。不知道为什么连不上。以下是 Android 客户端应用程序和 Java 服务器的代码。

客户端代码：

```
private SSLContext createSSLContext(final Context cont){
    SSLContext ssl_cont = null;
    try {
        Log.d(TAG, "TrustStore - Initializing");   
        KeyStore trustStore = KeyStore.getInstance("BKS");
        TrustManagerFactory trustManagerFactory = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
        InputStream trustStoreStream = cont.getResources().openRawResource(R.raw.myclienttruststore);
        trustStore.load(trustStoreStream, "client".toCharArray());
        trustManagerFactory.init(trustStore);
        Log.d(TAG, "TrustStore - Initialized");

        // Setup keystore
        Log.d(TAG, "KeyStore - Initializing");
        KeyStore keyStore = KeyStore.getInstance("BKS");
        KeyManagerFactory keyManagerFactory = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
        InputStream keyStoreStream = cont.getResources().openRawResource(R.raw.myclient);
        keyStore.load(keyStoreStream, "client".toCharArray());
        keyManagerFactory.init(keyStore, "client".toCharArray());
        Log.d(TAG, "KeyStore - Initialized");

        ssl_cont = SSLContext.getInstance("TLS");
        ssl_cont.init(keyManagerFactory.getKeyManagers(), trustManagerFactory.getTrustManagers(), null); 
    } catch (Exception e) {
        // TODO Auto-generated catch block
        alertbox("SSLClient", "ERROR: " + e.getMessage());
        Log.d(TAG, "ERROR: " + e.getMessage());
    }
    return ssl_cont;
}

OnClickListener onConnClick = new OnClickListener() {

    public void onClick(View arg0) {
        // TODO Auto-generated method stub
        try {
            // Setup the SSL context to use the truststore and keystore
            Log.d(TAG, "Started..");
            SSLContext ssl_context = createSSLContext(cont);
            Log.d(TAG,"here 1...");
            SSLSocketFactory socketFactory = (SSLSocketFactory) ssl_context.getSocketFactory();
            Log.d(TAG,"here 2...");
            socket = (SSLSocket) socketFactory.createSocket(ipadd.getText().toString().trim(), Integer.parseInt(port.getText().toString().trim()));
            Log.d(TAG,"here 3...");
            dataOut = new DataOutputStream(socket.getOutputStream());
            dataIn = new DataInputStream(socket.getInputStream());
            dataOut.writeUTF("Hello !!");
            msgin.setText("Connected");
            Log.d(TAG, "Completed..");
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            msgin.setText("Not connected");
            alertbox("Main", "ERROR: " + e.getMessage());
            Log.d(TAG, "ERROR: " + e.getMessage());
        }
    }
}; 
```

服务器代码：

```
 try {
        mySSLServerFac = (SSLServerSocketFactory) SSLServerSocketFactory.getDefault();
        mySSLServerSocket = (SSLServerSocket) mySSLServerFac.createServerSocket(9999);
        System.out.println("Listening on 9999\n");
        mySSLSocket = (SSLSocket) mySSLServerSocket.accept();           
        DataInputStream input = new DataInputStream(mySSLSocket.getInputStream());
        DataOutputStream output = new DataOutputStream(mySSLSocket.getOutputStream());      
        do{
            System.out.println("Remote IP Address : " + mySSLSocket.getInetAddress());
            msg = input.readUTF().toString();
            System.out.println(msg);
            java.util.Scanner sc = new java.util.Scanner(System.in);
            output.writeUTF(sc.nextLine());
        }while(msg != "exit");
        System.out.println(msg);                
    } catch (Exception e) {
        e.printStackTrace();
    } 
```

我在服务器上遇到“没有通用密码套件”错误。因为我在 SSL 连接设置中无处可去。如果您发现错误或主要问题，请让我帮助。

这是我创建证书和信任库所遵循的[链接。](http://blog.callistaenterprise.se/2011/11/24/creating-self-signed-certificates-for-use-on-android/)我创建的 Truststore 和 kestore 在[这里](http://dl.dropbox.com/u/60536209/Android%20cert%20and%20store.rar)

我正在使用 Android 2.2 和 BKSProvider 1.46，请告诉我哪里出错了。我必须尽快结束这个项目。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:24:18.450

从堆栈跟踪看来，您捕获的异常不包含消息。

```
Log.d(TAG, e.getMessage()); 
```

它与 SSL 无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:34:36.863

解决了！问题出在java主机的信任库上，跟着[这篇](https://stackoverflow.com/questions/9548807/sslhandshakeexception-no-cipher-suites-in-common)文章。

需要为客户端/服务器指定 trustStore，因为它们使用默认的 trustStore，导致失败。在服务器上使用 -Djavax.net.ssl.trustStore=servertruststore.jks -Djavax.net.ssl.trustStorePassword=server 并在客户端创建自己的密钥库和信任库允许会话完成。这是 -Djavax.net.debug=ssl,handshake 帮助很大。

整个命令是： java -Djavax.net.ssl.keyStore=server.jks -Djavax.net.ssl.keyStorePassword=server -Djavax.net.ssl.trustStore=servertruststore.jks -Djavax.net.ssl.trustStorePassword=server SSL服务器

现在我开始创建 sslsession 和多线程编程。

# ruby-on-rails - Rails 3 - 创建关联模型时自动编号？

> ID：10033873
> 
> 赞同：0
> 
> 时间：2012-04-05T18:21:39.077
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, ruby-on-rails-3.1, nested-forms

我有类似于以下的模型 -

```
Table: series
         - id: integer
         - volumes: integer
         - title: string

class Series < ActiveRecord::Base
  has_many :books, :dependent => :destroy
  accepts_nested_attributes_for :books, :reject_if => 
      proc { |attributes| attributes[:title].blank? }
  validates_associated :books
end

Table: books
    - id: integer
    - series_id: integer
    - title: string
    - volume: integer

class Book < ActiveRecord::Base
  belongs_to :series
  validates :title, :volume, :presence => true
  validates :title, :uniqueness => 
      { :scope => :series_id, 
        :message => 'Book titles must be unique within a series.'}
end 
```

我正在使用nested_form gem 构建一个统一的表单，通过同一个表单输入系列信息和每本书的信息。

有没有办法在每本书添加到系列时自动填充每本书的“音量”属性？

我是否需要修改nested_form 生成的JavaScript 来完成此操作，或者我可以在ActiveRecord 中做些什么？

# jquery - jquery 按钮没有正确对齐

> ID：10033875
> 
> 赞同：1
> 
> 时间：2012-04-05T18:21:45.330
> 
> 标签：jquery, css, jquery-ui

有谁知道如何在不使用的情况下对齐这些 jquery 按钮`float:left`？

`<button>`使用任何其他元素时会出现此问题`<a>`：

[http://jsbin.com/afixij/edit#javascript,html,live](http://jsbin.com/afixij/edit#javascript,html,live)

jquery的网站上也有同样的问题：

[http://jqueryui.com/demos/button/#default](http://jqueryui.com/demos/button/#default)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:28:28.560

这是因为类`.ui-button`在`jquery-ui.css`使用`display: inline-block;`

![在此处输入图像描述](../Images/db11b78e43cf8a12051bfec727379829.png)

如果您将其更改为，问题就会消失`display: inline-table;`

![在此处输入图像描述](../Images/15b7c3eab0bdb959b93cec9eb8ff1ff6.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:08:36.990

我以前没有这个问题，所以我使用旧版本的 jquery-ui 检查了我的旧代码。我注意到旧`.ui-button`课程没有`overflow:visible`将`overflow:hidden`其更改为`overflow:visible`，瞧，它已修复。

# azure - Microsoft.WindowsAzure.StorageClient.CloudBlockBlob.DownloadBlockList 返回 0 个块

> ID：10033876
> 
> 赞同：1
> 
> 时间：2012-04-05T18:21:46.660
> 
> 标签：azure, azure-storage, azure-blob-storage

我正在使用`CloudBlobContainer.ListBlobs`. 然后，我使用以下代码遍历每个条目以显示 blob 的大小：

```
 foreach (IListBlobItem item in blobs)
        {
            if (item.GetType() == typeof(CloudBlobDirectory))
            { }
            else if (item.GetType() == typeof(CloudBlockBlob))
            {
                CloudBlockBlob blockBlob = (CloudBlockBlob)item;
                IEnumerable<ListBlockItem> blocks = blockBlob.DownloadBlockList(new BlobRequestOptions { BlobListingDetails = BlobListingDetails.All });
                Console.WriteLine(blockBlob.Name.PadRight(50, ' ') + 
                   blocks.Sum(b => b.Size));
            }
            else
            {
                Console.WriteLine(item.Uri.LocalPath);
            }

        } 
```

但是，当我检查变量的计数时`blocks`，它始终为 0。这是为什么呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T20:05:33.103

我相信（不是 100% 肯定）`DownloadBlockList()`只有当 blob 最初以块的形式上传时才有效，而不是一次全部上传。这可能就是为什么你没有得到任何回报。

无论如何，您似乎只想要 blob 的总大小。因此使用该`blob.Properties.Length`属性可能是一种更简单的方法：

```
CloudBlockBlob blockBlob = (CloudBlockBlob)item;
blockBlob.FetchAttributes();
Console.WriteLine(blockBlob.Name.PadRight(50, ' ') + blockBlob.Properties.Length); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:06:36.213

我认为您应该检查 CloudBlob 而不是 CloudBlockBlob 类型。如果你加上另一个，你能得到尺寸吗？如果不是这样，您是否看到代码进入 else if 并且 b.size 只是零？

# silverlight - WP7 - 等待启动主页，直到异步调用完成

> ID：10033882
> 
> 赞同：1
> 
> 时间：2012-04-05T18:22:34.583
> 
> 标签：silverlight, windows-phone-7, navigation

我正在制作的应用程序需要在导航到第一页 (MainView.xaml) 之前从 json REST 服务获取一些数据。向视图模型发出请求的控制器类有一些静态列表，可帮助映射 ID（自上次运行以来可能已更改），用于稍后为视图模型生成 REST 请求。当 MainView 初始化时，它会立即从这个控制器类中调用信息，这会因为 ID 映射尚未加载而失败。因此，我加载了一个名为 LoadingScreen 的视图。此视图运行控制器的方法，该方法映射 ID，然后将应用程序的视图导航到 MainView。

```
public LoadingScreen()
{
     Dispatcher.BeginInvoke(TVController.populateMaps);
     InitializeComponent();
} 
```

映射 ID 后，控制器执行此操作

```
Deployment.Current.Dispatcher.BeginInvoke(() =>
{
     (Application.Current.RootVisual as PhoneApplicationFrame).Navigate(new Uri("/View/MainView.xaml", UriKind.Relative));
}); 
```

但出于两个原因，我想避免临时查看：

1.  后退按钮稍后将用户引导至此页面
2.  这是糟糕的编码。我只想篡改 SplashScreen 图像。

我一直在寻找这样做的替代方法，并且我设法阻止了 WMAppManifest.xml 到 LoadingScreen（在 App.xaml.cs 中）的默认任务导航。但是我在控制器类中的断点似乎表明当我从 App.xaml.cs 运行它时，它的 PopulateMaps 方法和异步请求没有做任何事情。这是我尝试过的除其他外：

```
public App()
{
     //INITIALIZING THE ELEMENTARY STUFF .......

     RootFrame.Navigating += new NavigatingCancelEventHandler(RootFrame_Navigating);

}
void RootFrame_Navigating(object sender, NavigatingCancelEventArgs e)
{
     e.Cancel = true;
     TVController.populateMaps();
} 
```

我想找到一种避免出现临时加载屏幕的方法。

# java - 从 JAR 运行 Main.class，在应用程序框架中显示结果

> ID：10033884
> 
> 赞同：0
> 
> 时间：2012-04-05T18:22:50.430
> 
> 标签：java, swing

我试图让一个名为 JTA 的插件在 JInternalFrame 中运行。我试过运行小程序版本并调用 Main.class 没有成功。

我被告知我不能使用 jInternalFrame.add(Object) 调用对象。当我尝试 de.mud.jta.Main main = new de.mud.jta.Main(); 时，我得到 NO SUITABLE METHOD FOR ADD 编译，错误指向 jDesktopPane1.add(main);

这是我所知道的：

Main.class 创建一个新的 JFrame。如果有某种方法可以让它填充我的 jInternalFrame 来代替制作一个新的就可以了。我也会对在我的应用程序的 DesktopFrame 中打开新的 JFrame 感到满意。在这一点上，我什至会接受一个全新的框架打开（某种弹出窗口）。

这是 Main.class 源代码：

```
/*
 * This file is part of "JTA - Telnet/SSH for the JAVA(tm) platform".
 *
 * (c) Matthias L. Jugel, Marcus MeiÃŸner 1996-2005\. All Rights Reserved.
 *
 * Please visit http://javatelnet.org/ for updates and contact.
 *
 * --LICENSE NOTICE--
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 * --LICENSE NOTICE--
 *
 */
package de.mud.jta;

import de.mud.jta.event.FocusStatusListener;
import de.mud.jta.event.OnlineStatusListener;
import de.mud.jta.event.ReturnFocusRequest;
import de.mud.jta.event.SocketRequest;

import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JOptionPane;
import javax.swing.KeyStroke;
import java.awt.PrintJob;
import java.awt.datatransfer.Clipboard;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.URL;
import java.util.Iterator;
import java.util.Map;
import java.util.Properties;

/**
 * <B>JTA - Telnet/SSH for the JAVA(tm) platform</B><P>
 * This is the implementation of whole set of applications. It's modular
 * structure allows to configure the software to act either as a sophisticated
 * terminal emulation and/or, adding the network backend, as telnet
 * implementation. Additional modules provide features like scripting or an
 * improved graphical user interface.<P>
 * This software is written entirely in Java<SUP>tm</SUP>.<P>
 * This is the main program for the command line telnet. It initializes the
 * system and adds all needed components, such as the telnet backend and
 * the terminal front end. In contrast to applet functionality it parses
 * command line arguments used for configuring the software. Additionally
 * this application is not restricted in the sense of Java<SUP>tmp</SUP>
 * security.
 * <P>
 * <B>Maintainer:</B> Matthias L. Jugel
 *
 * @version $Id: Main.java 499 2005-09-29 08:24:54Z leo $
 * @author Matthias L. Jugel, Marcus Meissner
 */
public class Main {

  private final static int debug = 0;

  private final static boolean personalJava = false;

  /** holds the last focussed plugin */
  private static Plugin focussedPlugin;

  /** holds the system clipboard or our own */
  private static Clipboard clipboard;

  private static String host, port;

  public static void main(String args[]) {
    final Properties options = new Properties();
    try {
      options.load(Main.class.getResourceAsStream("/de/mud/jta/default.conf"));
    } catch (IOException e) {
      System.err.println("jta: cannot load default.conf");
    }
    String error = parseOptions(options, args);
    if (error != null) {
      System.err.println(error);
      System.err.println("usage: de.mud.jta.Main [-plugins pluginlist] "
                         + "[-addplugin plugin] "
                         + "[-config url_or_file] "
                         + "[-term id] [host [port]]");
      System.exit(0);
    }

    String cfg = options.getProperty("Main.config");
    if (cfg != null)
      try {
        options.load(new URL(cfg).openStream());
      } catch (IOException e) {
        try {
          options.load(new FileInputStream(cfg));
        } catch (Exception fe) {
          System.err.println("jta: cannot load " + cfg);
        }
      }

    host = options.getProperty("Socket.host");
    port = options.getProperty("Socket.port");

    final JFrame frame = new JFrame("jta: " + host + (port.equals("23")?"":" " + port));

    // set up the clipboard
    try {
      clipboard = frame.getToolkit().getSystemClipboard();
    } catch (Exception e) {
      System.err.println("jta: system clipboard access denied");
      System.err.println("jta: copy & paste only within the JTA");
      clipboard = new Clipboard("de.mud.jta.Main");
    }

    // configure the application and load all plugins
    final Common setup = new Common(options);

    if (port == null || port.length() == 0) {
      if (setup.getPlugins().containsKey("SSH")) {
        port = "22";
      } else {
        port = "23";
      }
    }

    setup.registerPluginListener(new OnlineStatusListener() {
      public void online() {
        frame.setTitle("jta: " + host + (port.equals("23")?"":" " + port));
      }

      public void offline() {
        frame.setTitle("jta: offline");
      }
    });

    // register a focus status listener, so we know when a plugin got focus
    setup.registerPluginListener(new FocusStatusListener() {
      public void pluginGainedFocus(Plugin plugin) {
        if (Main.debug > 0)
          System.err.println("Main: " + plugin + " got focus");
        focussedPlugin = plugin;
      }

      public void pluginLostFocus(Plugin plugin) {
        // we ignore the lost focus
        if (Main.debug > 0)
          System.err.println("Main: " + plugin + " lost focus");
      }
    });

    Map componentList = setup.getComponents();
    Iterator names = componentList.keySet().iterator();
    while (names.hasNext()) {
      String name = (String) names.next();
      JComponent c = (JComponent) componentList.get(name);
      if (options.getProperty("layout." + name) == null) {
        System.err.println("jta: no layout property set for '" + name + "'");
        frame.add("South", c);
      } else
        frame.getContentPane().add(options.getProperty("layout." + name), c);
    }

    if (!personalJava) {

      frame.addWindowListener(new WindowAdapter() {
        public void windowClosing(WindowEvent evt) {
          setup.broadcast(new SocketRequest());
          frame.setVisible(false);
          frame.dispose();
          System.exit(0);
        }
      });

      // add a menu bar
      JMenuBar mb = new JMenuBar();
      JMenu file = new JMenu("File");
      file.setMnemonic(KeyEvent.VK_F);
      JMenuItem tmp;
      file.add(tmp = new JMenuItem("Connect"));
      tmp.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_C, KeyEvent.SHIFT_MASK | KeyEvent.CTRL_MASK));
      tmp.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent evt) {
          String destination =
                  JOptionPane.showInputDialog(frame,
                                              new JLabel("Enter your destination host (host[:port])"),
                                              "Connect", JOptionPane.QUESTION_MESSAGE
                  );
          if (destination != null) {
            int sep = 0;
            if ((sep = destination.indexOf(' ')) > 0 || (sep = destination.indexOf(':')) > 0) {
              host = destination.substring(0, sep);
              port = destination.substring(sep + 1);
            } else {
              host = destination;
            }
            setup.broadcast(new SocketRequest());
            setup.broadcast(new SocketRequest(host, Integer.parseInt(port)));
          }
        }
      });
      file.add(tmp = new JMenuItem("Disconnect"));
      tmp.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent evt) {
          setup.broadcast(new SocketRequest());
        }
      });
      file.addSeparator();
      if (setup.getComponents().get("Terminal") != null) {
        file.add(tmp = new JMenuItem("Print"));
        tmp.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_P, KeyEvent.CTRL_MASK));
        tmp.addActionListener(new ActionListener() {
          public void actionPerformed(ActionEvent evt) {
              PrintJob printJob =
                      frame.getToolkit().getPrintJob(frame, "JTA Terminal", null);
              // return if the user clicked cancel
              if (printJob == null) return;
              ((JComponent) setup.getComponents().get("Terminal"))
                      .print(printJob.getGraphics());
              printJob.end();
          }
        });
        file.addSeparator();
      }
      file.add(tmp = new JMenuItem("Exit"));
      tmp.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent evt) {
          frame.dispose();
          System.exit(0);
        }
      });
      mb.add(file);

      JMenu edit = new JMenu("Edit");
      edit.add(tmp = new JMenuItem("Copy"));
      tmp.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_C, KeyEvent.CTRL_MASK));
      tmp.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent evt) {
          if (focussedPlugin instanceof VisualTransferPlugin)
            ((VisualTransferPlugin) focussedPlugin).copy(clipboard);
        }
      });
      edit.add(tmp = new JMenuItem("Paste"));
      tmp.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_V, KeyEvent.CTRL_MASK));
      tmp.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent evt) {
          if (focussedPlugin instanceof VisualTransferPlugin)
            ((VisualTransferPlugin) focussedPlugin).paste(clipboard);
        }
      });
      mb.add(edit);

      Map menuList = setup.getMenus();
      names = menuList.keySet().iterator();
      while (names.hasNext()) {
        String name = (String) names.next();
        mb.add((JMenu) menuList.get(name));
      }

      JMenu help = new JMenu("Help");
      help.setMnemonic(KeyEvent.VK_HELP);
      help.add(tmp = new JMenuItem("General"));
      tmp.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
          Help.show(frame, options.getProperty("Help.url"));
        }
      });
      mb.add(help);

      frame.setJMenuBar(mb);

    } // !personalJava

    frame.pack();

    if ((new Boolean(options.getProperty("Applet.detach.fullscreen"))
            .booleanValue()))
      frame.setSize(frame.getToolkit().getScreenSize());
    else
      frame.pack();

    frame.setVisible(true);

    if(debug > 0) 
      System.err.println("host: '"+host+"', "+host.length());
    if (host != null && host.length() > 0) {
      setup.broadcast(new SocketRequest(host, Integer.parseInt(port)));
    }
    /* make sure the focus goes somewhere to start off with */
    setup.broadcast(new ReturnFocusRequest());
  }

  /**
   * Parse the command line argumens and override any standard options
   * with the new values if applicable.
   * <P><SMALL>
   * This method did not work with jdk 1.1.x as the setProperty()
   * method is not available. So it uses now the put() method from
   * Hashtable instead.
   * </SMALL>
   * @param options the original options
   * @param args the command line parameters
   * @return a possible error message if problems occur
   */
  private static String parseOptions(Properties options, String args[]) {
    boolean host = false, port = false;
    for (int n = 0; n < args.length; n++) {
      if (args[n].equals("-config"))
        if (!args[n + 1].startsWith("-"))
          options.put("Main.config", args[++n]);
        else
          return "missing parameter for -config";
      else if (args[n].equals("-plugins"))
        if (!args[n + 1].startsWith("-"))
          options.put("plugins", args[++n]);
        else
          return "missing parameter for -plugins";
      else if (args[n].equals("-addplugin"))
        if (!args[n + 1].startsWith("-"))
          options.put("plugins", args[++n] + "," + options.get("plugins"));
        else
          return "missing parameter for -addplugin";
      else if (args[n].equals("-term"))
        if (!args[n + 1].startsWith("-"))
          options.put("Terminal.id", args[++n]);
        else
          return "missing parameter for -term";
      else if (!host) {
        options.put("Socket.host", args[n]);
        host = true;
      } else if (host && !port) {
        options.put("Socket.port", args[n]);
        port = true;
      } else
        return "unknown parameter '" + args[n] + "'";
    }
    return null;
  }
} 
```

我怎样才能让这个类运行，并让它创建的东西在我的应用程序的框架中运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:56:42.773

由于这是 GPL 代码，您可以根据需要重写它。

就像现在一样，JFrame 是静态 main 方法中的局部变量，它不是可从外部获得的属性，也不是您可以获取的返回值，也不是您处理的参数，它会被填充。

不修改源代码：否。

# php - PHP生成的图像未缓存

> ID：10033891
> 
> 赞同：0
> 
> 时间：2012-04-05T18:23:28.953
> 
> 标签：php

我用 PHP 生成了一些图片，这些图片没有被浏览器缓存。

我通过一个 php 文件输出一些图片，网址如下所示：

[http://127.0.0.1:8080/workspace/cps/index.php?act=file&act2=preview_or_icon&template=disable&file_id=341](http://127.0.0.1:8080/workspace/cps/index.php?act=file&act2=preview_or_icon&template=disable&file_id=341)

在我的 php 文件中，我有：

```
header('Content-Type: image/jpeg');
header('Content-Transfer-Encoding: binary');
//Read File 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:41:18.820

添加了这个：

```
header("Cache-Control: private, max-age=10800, pre-check=10800");
header("Pragma: private");
header("Expires: " . date(DATE_RFC822,time()+60*60*24*30)); 
```

并修复！

# git - 本地分支丢失远程跟踪分支

> ID：10033892
> 
> 赞同：2
> 
> 时间：2012-04-05T18:23:30.540
> 
> 标签：git, branch, tracking

我有一个从未遇到过的奇怪情况。

我刚刚为我的开发和主分支完成了 git fetch 更新：

```
From remote-host:my_repo
   f3946b5..c3b2d44  develop    -> origin/develop
   72830fe..14d8be6  master     -> origin/master 
```

我的主分支上的 Git 状态正确地报告我落后了。但是，在我的开发分支上，没有迹象表明我落后了：

```
dumbo:my_repo wade$ git checkout develop
Switched to branch 'develop'
dumbo:my_repo wade$ git status
# On branch develop
nothing to commit (working directory clean) 
```

我确定这是因为我的本地开发分支不再跟踪起源/开发：

```
dumbo:my_repo wade$ git branch -avv
 * develop                   24f29e2 Updated config
  master                    60d5d8f [origin/master: behind 109] Deploy w/ session_fix
  remotes/origin/HEAD       -> origin/master
  remotes/origin/develop    c3b2d44 Deploy changes
  remotes/origin/master     14d8be6 Deploy changes 
```

现在，我知道我可以用 git branch --set-upstream 修复它，但我的问题是，它是如何被破坏的？我当然没有采取任何有意识的行动来删除远程跟踪关联。

我的正常工作流程是：

```
 (on branch develop)
  git stash (if necessary)
  git fetch
  git merge or git rebase origin/develop
  git checkout master
  git merge origin/master
  git checkout develop 
```

关于哪些操作会导致跟踪分支关联被破坏的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:27:34.713

从这些信息中真的很难判断。我猜你不小心删除了分支，当你重新创建它时，你没有表示跟踪。

另一种方法是您可能手动编辑了配置并意外删除了该行。

# php - 试图在 PHP 页面之间发送数据；Post/cURL 不起作用，会话变得混乱

> ID：10033895
> 
> 赞同：1
> 
> 时间：2012-04-05T18:23:41.433
> 
> 标签：php, session, post, curl

我最近问了这个问题[Posting data with curl - 实际上刷新到下一页](https://stackoverflow.com/questions/9999741/posting-data-with-curl-actually-refreshing-to-the-next-page)，但我很快意识到解决方案并不是很好......

所以我在几个地方的 PHP 页面之间传递数据。这是我目前的问题：

我依赖 cookie，因此我会在每个页面的顶部检查是否启用了 cookie：

```
session_start();
if (!isset($_COOKIE['PHPSESSID'])) {
    if ($_GET['rd'] == '1') {
        header('Location: *redirect url*');
    } else {
        *refresh the page, setting 'rd' to '1'*
    }
} 
```

但是，由于这是每个页面上的“标题”，它需要是通用的。例如，任何发送给它的帖子或获取数据（从另一个页面或表单）都应该发送到重定向页面。

获取很容易，因为我可以将它包含在 url 中，但是我在使用 Post 时遇到了问题。

我从 cURL 开始将 Post 数据发送到下一页，但我意识到它实际上并没有转到该页面

```
$ch = curl_init($some_url);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, 'myvar=something');
curl_exec($ch);
curl_close($ch);$ch = curl_init($some_url);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, 'myvar=something');
curl_exec($ch);
curl_close($ch); 
```

cURL 之后不会加载 $url ；它返回它

所以有人建议我使用 Sessions，我很快意识到这不是一个很好的解决方案；

1.  重定向时，如果我把Post数据设置为Session变量（存储数据），那么每个使用Post数据的页面都需要检查数据是在Post还是Session中。
2.  它效率不高 - 我在两个页面之间发送数据，不一定是有关会话的信息。

关于数字 2，我设置了另一个会话变量来告诉下一页是否已将 Post 数据移动到 Session。但是，每次我必须重置该变量时，它只会让事情变得复杂和不整洁。

**示例：** 我有一个将表单数据发送到验证页面的注册页面。这两个都有标题来检查是否启用了cookie。

发布数据被发送到验证页面，如果出现问题，我无法将数据发布回验证页面（告诉用户问题出在哪里），我必须设置一个带有注册错误的会话变量. 每次，我都必须取消设置注册错误变量。

现在我认为验证页面上不需要cookie，但我不想要任何漏洞，我不知道以后会添加什么。

**回到问题**

1.  我需要检查是否在每个页面上启用了 cookie。
2.  我不知道我当前的应用程序是否是最有效的方式（重定向）；这肯定引起了很多问题
3.  如果有人能告诉我如何在不重定向的情况下检查 cookie（并且不与其他任何内容冲突），那就是一个解决方案
4.  **我不想依赖 javascript 或隐藏表单**；我想控制体验
5.  我需要有效地在两个页面之间发送数据。不喜欢某些应用程序的会话，因为我需要设置和取消设置每个页面的变量。

我知道这是一项艰巨的任务，但如果有人能提供帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:13:12.267

如果所有中间页面都在验证表单数据，则将其废弃；只需在同一个 PHP 脚本中执行此操作。最简单的是，您可以拥有：

```
<?php
    $yourkey = 'goeshere';
    if (!isset($_COOKIE[$yourkey])) {
        setcookie($yourkey, $value, $expires);
    }

    if (isset($_POST['submit'])) {
        $errors = array();
        // do validation here
        // iterate over your fields and add any errors to $errors array
        if (empty($errors)) {
            // redirect if there are no errors, if you really need to
            header('Location: success.php');
            exit;
        }
    }
?>
<html>
  <body>
    <form method="post" action="">
      <label for="name">Your name:</label>
      <input type="text" name="name" value="<?php echo isset($_POST['name']) ? $_POST['name'] : ''; ?>" id="name" />
      <input type="submit" name="submit" value="Submit" />
    </form>
  </body>
</html> 
```

在您的 HTML 页面中有一个 XSS 漏洞`echo`POST 数据，但我将把它留给您来确保安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:02:44.390

我不确定这是否有帮助，但也许您可以尝试限制页面数量？我通常做的是将表单和验证放在一个 php 页面上。您检查用户是否在开始时发送了某些内容，如果发送了，请检查并显示任何错误。如果没有，请出示表格。

# iphone - 什么时候是拉 Facebook 朋友的最佳时机？

> ID：10033896
> 
> 赞同：1
> 
> 时间：2012-04-05T18:23:58.723
> 
> 标签：iphone, facebook, facebook-graph-api

对于我的 iPhone 应用程序，用户可以使用 Facebook 登录，然后该应用程序可以获得已经在该应用程序上的朋友列表。现在我想知道 - 用户的 Facebook 好友何时应该被拉下。应该是用户开始使用应用程序并使用 Facebook 登录的时间吗？还是应该在后台线程中定期完成？或者它实际上应该在我的应用程序的 Web 服务端完成（使用从 iPhone 应用程序接收和发送的访问令牌）最好的做法是什么？

主要的担忧是

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T23:41:22.487

几个选项：

从问题下方的评论中，将好友列表缓存至少 24 小时。好友列表很少经常更改（除非用户未满 25 岁，否则它可能会更频繁地更改...从统计上讲）。

您还可以使用 Real Time API 订阅用户的另一个选项。将他们的朋友信息存储在您的服务器上，当 Facebook 告诉您他们添加了一个新朋友时，您将其添加到您的数据存储中。然后，您可以查询自己的服务器，而不是使用 Graph API。

# python - 错误 python 日期时间/时间导入...

> ID：10033898
> 
> 赞同：-4
> 
> 时间：2012-04-05T18:24:10.330
> 
> 标签：python, datetime

有错误

```
ValueError: time data '2012-03-15 9:45:00 AM' does not match format '%Y-%m-%d %H:%M:%S' 
```

如何转换为日期时间？问题是上午/下午，这`%I:%M:%S%p`对我不起作用。

我需要添加日期`time.strftime("%H:%M:%S", (0,0,0,8,56,0,0,0,0))`

**编辑二：尝试使用...**

**

```
import time
from time import strftime
from datetime import date, time, datetime 
```

** 此顺序中的这些导入会导致以下问题

start_time=time.time()

```
start_time = time.time()
AttributeError: type object 'datetime.time' has no attribute 'time' 
```

旧编辑......

```
datetime.combine(y='a date',z= 'a time') 
```

y 是`datetime.date` z 是`datetime.time`

`y=datetime(t.year, t.month, t.day)`这解决了。

给出了一个问题。

z 是`datetime.time`

`datetime.combine(y, datetime.time(18, 54, 32)`)

错误信息.............

```
 a =datetime.combine(y, datetime.time(18, 54, 32))
TypeError: descriptor 'time' requires a 'datetime.datetime' object but received a 'int' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:30:20.183

看看 dateutil 包[http://pypi.python.org/pypi/python-dateutil](http://pypi.python.org/pypi/python-dateutil)

```
from dateutil import parser
date = parser.parse("2012-03-15 9:45:00 AM") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:27:11.733

怎么样：

```
>>> import datetime
>>> datetime.datetime.strptime("2012-03-15 9:45:00 AM", "%Y-%m-%d %I:%M:%S %p")
datetime.datetime(2012, 3, 15, 9, 45)
>>> datetime.datetime.strptime("2012-03-15 9:45:00 PM", "%Y-%m-%d %I:%M:%S %p")
datetime.datetime(2012, 3, 15, 21, 45) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T20:31:48.110

关于更新：从 datetime 模块导入的内容一团糟。正确的样本是：

```
>>> from datetime import date, time, datetime
>>> d=date(2012,10,01)
>>> t=time(10,11,12)
>>> datetime.combine(d,t)
datetime.datetime(2012, 10, 1, 10, 11, 12) 
```

# java - 如何在不更改所有派生类的情况下调用基类方法

> ID：10033904
> 
> 赞同：2
> 
> 时间：2012-04-05T18:24:28.043
> 
> 标签：java, oop

我有一个名为的类`Base`，它有一个名为`execute()`. 大约有 100 个类派生自这个基类并提供自己的`execute()`. 现在，我有一些我想放入的通用逻辑`Base.SomeMethod()`。这个方法需要在结束时调用`execute()`。我的问题是否可以在不更改每个派生类的`execute()`方法的情况下调用它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T18:28:06.547

```
public class Base {
    public final void execute() {
        doExecute();
        someMethod();
    }

    protected abstract void doExecute();

    public void someMethod() {
    }
} 
```

此解决方案可防止[超级代码异味](http://en.wikipedia.org/wiki/Call_super)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:27:43.697

是的，但是您必须更改呼叫者。调用者将不得不调用一个`doExecute()`（尽管为它找到一个更好的名称）方法，您在基类中将其定义为 final，`execute()`然后调用公共代码。

另一种选择是面向方面的编程，但我不建议为此目的，即“破解”代码。

问题是：为什么在 100 个左右的类中更改方法的名称会出现这样的问题？只需在 IDE 中单击鼠标即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:27:45.023

不是我知道的。下次您应该考虑可能要为所有扩展类添加一些通用操作，并调用`super.execute()`!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:28:06.517

只能通过使用可以检测您的代码的东西；这对于纯 Java 是不可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T03:17:31.163

让我按照我的理解陈述你的问题：Animal 类有 Breath() 方法，该方法具有实现，并且由于继承，所有子类都有这个成员，除非有非常不同的呼吸方式，否则没有人会覆盖。

现在，在 Breath 方法结束时，您想调用动物类的 CloseEyes() 方法，并且可能是某些或所有子类覆盖了 CloseEyes() 方法。

所以你的问题：每次你想让他们关闭眼睛的任何动物呼吸，但来自动物类而不是派生类。

1.  如果在许多派生类中已经存在 CloseEyes() 方法，那么您在调用基类的 CloseEyes() 时实际上做错了。

2.  如果您仍然希望只调用基类的方法，那么为什么需要相同的方法名称 - 您只需说 AnimalEyeClose() ，将其设为私有并将其放在 Animal 类中。

# php - 终止进一步执行 jquery

> ID：10033908
> 
> 赞同：1
> 
> 时间：2012-04-05T18:24:46.317
> 
> 标签：php, jquery, ajax

我刚开始我的 jQuery jouerny，我仍然很难理解一些基本主题，所以我决定用几行 PHP 编写一个简单的脚本来尝试一些事情。我有一个主页：

```
<?php session_start(); ?>
<!DOCTYPE html>
<html>
    <head>
        <title> TEST </title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

    </head>
    <body>

        <a  href = "http://www.abv.bg/" class="isLogged">abv.bg</a>
        <br />
        <hr />
        <a  href = "http://www.yahoo.com/" class="isLogged">Yahoo!</a>
        <br />
        <hr />
        <a href = "http://www.southparkstudios.com/" class="isLogged">South Park</a>
        <br />
        <hr />
        <a  href = "http://www.youtube.com/" class="isLogged">Youtube</a>
        <br />
        <hr />
        <a  href = "http://www.vbox7.com/" class="isLogged">Vbox</a>
        <br />
        <hr />
        <a  href = "http://www.sa.dir.bg/" class="isLogged">Dir.BG</a>
        <br />

        <div class="isLogged"> hi<div>

                <script type="text/javascript">
                    $(document).ready(function(){
                        var Status = <?php echo $_SESSION['isLogged'] ?>
                        $('.isLogged').click(function(){
                            if(Status!=true){
                                var Check = prompt('Enter Password', '');
                                $.post('check.php', {Check:Check}, function(data) {  var result = data;
                                    alert(result); exit;
                                });

                            }

                        });

                    }); 
                </script>
                </body>
                </html> 
```

重要的部分在标签中。如您所见，我想进行一个非常简单的检查，如果用户输入了密码，并让他打开带有 class="isLogged" 的链接，如果他是。我很难理解的是如何管理我的 php 端脚本，这就是我现在所拥有的：

```
<?php session_start();
$data = $_POST['Check'];
$yes = "[{data}]";
$no = 'N';
if ($data != 'Ivan')
{

echo json_encode($yes);
}
else
{

$_SESSION['isLogged'] = true;
}
?> 
```

但我不知道如何在 PHP 端格式化我的数据，所以我可以在脚本中进行适当的检查。但是我已经达到了那么远，至少`echo json_encode($yes);`我用它来进行检查，但是我仍然无法找到如何阻止链接加载。所以它提出了很多问题，但希望得到正确答案并不难。

谢谢

勒龙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:09:52.803

你可以这样做。我认为这就是你想要做的：在允许用户继续点击链接之前检查正确的密码。

```
<script type="text/javascript">
    $(document).ready(function(){

        var Status = <?php echo (bool)$_SESSION['isLogged']; ?>

        $('.isLogged').click(function(){

            if(!Status)
            {
                var Check = prompt('Enter Password', '');
                var Success = false;

                $.post('check.php', {Check:Check}, function(data) {

                    var response = $.parseJSON(data);

                    if(response.result)
                    {
                        Success = true;
                    }
                });

                /*
                    If you return false in a .click() it stops the link being visited. The browser won't follow the href.
                    So here, if the password was wrong, Success will be false and thus the link won't be visited
                */
                return Success;
            }

        });

    }); 
</script> 
```

PHP端：

```
<?php
    session_start();

    $out = array('result' => false);

    if($_SERVER['REQUEST_METHOD'] == 'POST')
    {
        $password = 'Ivan';
        $input = $_POST['Check'];

        if(strcmp($input, $password) === 0) // case sensitive string comparison,  0 = strings are same
        {
            $_SESSION['isLogged'] = true;
            $out['result'] = true;
        }
    }

    echo json_encode($out);

?> 
```

免责声明：我很欣赏这是一个学习练习，而不是一个实际的系统，这显然不是保护内容的安全方式，因为我们无法阻止用户浏览链接（如果他们愿意）或禁用 javascript。

# c# - 如何从另一个 XAML 页面引用 Windows Phone ApplicationBar？

> ID：10033912
> 
> 赞同：1
> 
> 时间：2012-04-05T18:25:01.687
> 
> 标签：c#, windows-phone-7, xaml, application-bar

我在尝试在 FileTypes.cs 类内的函数中引用在 xaml 页面 (ViewFilesPage.xaml) 中定义的 ApplicationBar 时遇到问题，所有这些都来自同一个项目。

ViewFilesPage.xaml 中的 ApplicationBar 代码：

```
<phone:PhoneApplicationPage.ApplicationBar>
        <shell:ApplicationBar IsVisible="True">
            <shell:ApplicationBarIconButton IconUri="Graphics/ApplicationBar/NewFile.png" Click="NewFile" Text="New File" />
            <shell:ApplicationBarIconButton IconUri="Graphics/ApplicationBar/NewFolder.png" Click="NewFolder" Text="New Folder" />
            <shell:ApplicationBarIconButton IconUri="Graphics/ApplicationBar/Delete.png" Click="DeleteFile" Text="Delete File" />
            <shell:ApplicationBarIconButton IconUri="Graphics/ApplicationBar/OpenFile.png" Click="OpenFile" Text="Open File" />
            <shell:ApplicationBar.MenuItems>
                <shell:ApplicationBarMenuItem x:Name="CutFileButton" IsEnabled="True" Click="CutFile" Text="Cut" />
                <shell:ApplicationBarMenuItem x:Name="CopyFileButton" IsEnabled="True" Click="CopyFile" Text="Copy" />
                <shell:ApplicationBarMenuItem x:Name="PasteFileButton" IsEnabled="True" Click="PasteFile" Text="Paste" />
            </shell:ApplicationBar.MenuItems>
        </shell:ApplicationBar>
    </phone:PhoneApplicationPage.ApplicationBar> 
```

FileTypes.cs中C#函数的代码：

```
public static StackPanel ShowFiles(string Path)
    {

        string[] FileNames = isoStore.GetFileNames(Path + "*");
        string[] DirectoryNames = isoStore.GetDirectoryNames(Path + "*");
        int NumberOfFiles = FileNames.Length, NumberOfDirectories = DirectoryNames.Length, i;

        StackPanel FilesStackPanel = new StackPanel();
        FilesStackPanel.Orientation = System.Windows.Controls.Orientation.Vertical;
        FilesStackPanel.Margin = FilesMenuMargin;

        if (NumberOfFiles + NumberOfDirectories == 0)
        {
            TextBlock Message = new TextBlock();

            if (ViewFilesPage.ApplicationBar.Buttons.Count > 2)
            {
                ViewFilesPage.ApplicationBar.Buttons.RemoveAt(2);
                ViewFilesPage.ApplicationBar.Buttons.RemoveAt(2);
            }

            Message.Text = "Empty directory";
            FilesStackPanel.Children.Add(Message);
        }
        else
        {
            for (i = 0; i < NumberOfDirectories; i++)
            {
                if (DirectoryNames[i] != "" && DirectoryNames[i] != "RecycleBin")
                {
                    FilesStackPanel.Children.Add(WriteFileLines(Path, DirectoryNames[i], true));
                    FilesStackPanel.Children.Add(ShowFiles(Path + DirectoryNames[i] + "/"));
                }
            }

            for (i = 0; i < NumberOfFiles; i++)
            {
                FilesStackPanel.Children.Add(WriteFileLines(Path, FileNames[i], false));
            }
        }
        return FilesStackPanel;
    } 
```

而不是 ViewFilesPage.ApplicationBar 我需要一个对 ApplicationBar 的工作引用，所以我可以修改按钮的数量。

# emacs - emacs 相当于 ct

> ID：10033914
> 
> 赞同：4
> 
> 时间：2012-04-05T18:25:04.370
> 
> 标签：emacs

寻找一种等效的剪切和粘贴策略来复制 vim 的“cut til”。如果我真的知道它在 vim 中的名称，我敢肯定这是可以用谷歌搜索的，但这是我正在寻找的内容：

如果我有这样的文本块：

```
foo bar (baz) 
```

我在行的开头，我想剪到第一个括号，在视觉模式下，我会这样做：

```
 ct ( 
```

我认为可能有一种方法可以回顾，我认为您可以传递更具体的正则表达式。但无论如何，寻找一些 emacs 等价物来进行这种文本替换。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T18:42:56.073

以下是三种方式：

1.  只需键入`M-d``M-d`即可删除两个单词。这将留下最后的空间，所以你必须自己删除它，如果你将这两个词粘贴回其他地方，然后再将其添加回来。
2.  `M-z`is `zap-to-char`，它从光标中删除文本，直到并包括您指定的字符。在这种情况下，你必须做一些事情，比如`M-2``M-z``SPC`快速到并包括第二个空格字符。
3.  键入`C-SPC`设置标记，然后使用 进入增量搜索`C-s`，键入一个空格以跳转到第一个空格，然后`C-s`向前搜索下一个空格，`RET`终止搜索，最后`C-w`杀死您选择的文本。

就个人而言，我通常会选择#1。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T18:46:14.043

正如ataylor所说`zap-to-char`的那样，对zap-to-char的以下修改正是您想要的

```
(defun zap-up-to-char (arg char)
  "Like standard zap-to-char, but stops just before the given character."
  (interactive "p\ncZap up to char: ")
  (kill-region (point)
               (progn
                 (search-forward (char-to-string char) nil nil arg)
                 (forward-char (if (>= arg 0) -1 1))
                 (point))))

(define-key global-map [(meta ?z)] 'zap-up-to-char)           ; Rebind M-z to our version 
```

顺便说一句，不要忘记它有能力用负前缀向后退

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T18:42:07.990

这听起来像`zap-to-char`在 emacs 中，`M-z`默认绑定。请注意，这`zap-to-char`将剪切所有字符*，包括*您选择的字符。

# bash - 如何在 Gvim 内部的后台运行进程？

> ID：10033922
> 
> 赞同：3
> 
> 时间：2012-04-05T18:25:52.400
> 
> 标签：bash, shell, vim

好吧，我实际上需要做的是`CTRL`-`Z`退出从插入模式开始的进程`GVim`。

我的命令`:Cdprun`执行`cdprun.sh`它运行一个 sudo-ed 守护进程。我可以`&`在 sudo-ed 守护程序调用的末尾添加以在后台运行，这可以工作，但不会提示用户输入密码。相反，我想摆脱它`CTRL`，`Z`但键盘中断不起作用。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T16:50:04.457

在这种情况下，您通常有两个选择：通用使用 @Nicalas Martin 提到的 vim-addon-async 或带有内置解释器支持的 vim 之类的东西：带有期望模块的 tcl，带有 pyexpect 的 python，带有 Expect 的 perl，也许还有其他东西（注意：所有提到的软件包都没有随 tcl/python/perl 一起提供）。其次是针对当前情况：它是在另一个地方背景。根据您的解释，我猜您的脚本看起来像

```
#!/bin/sh
<...>
sudo run-daemon --daemon-args # Last executed line 
```

， 我对吗？比你可以把背景放在另一个地方：不是

```
sudo run-daemon --daemon-args & 
```

， 但

```
sudo sh -c "nohup run-daemon --daemon-args &" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:23:43.810

这是一个处理vim中异步命令的脚本。不是一个完美的解决方案，但可能是一个很好的临时解决方案。[http://www.vim.org/scripts/script.php?script_id=3307](http://www.vim.org/scripts/script.php?script_id=3307)

# git - git add ./*.java 不起作用？

> ID：10033925
> 
> 赞同：1
> 
> 时间：2012-04-05T18:26:06.070
> 
> 标签：git, version-control

我当前的 Java 项目中有一堆 Java 文件，我一直在修改它们，我想从项目的根文件夹（在 Ubuntu 中）一举将它们全部添加。

我试过了：

```
git add ./*.java 
```

但这并没有。我尝试像这样转义星号：

```
git add ./\*.java 
```

但这并没有。然后我试着像这样引用它：

```
git add "./*.java" 
```

但这并没有。

“git add”的手册页给出了一个例子：

> 从 Documentation 目录及其子目录下的所有 *.txt 文件中添加内容：
> 
> ```
>  $ git add Documentation/\*.txt 
> ```

我尝试使用上面的“文档”之类的目录来限定它，但这也不起作用。

我错过了什么？

[**更新**]我在下面尝试了@GoZoner 的建议并且它有效，但前提*是*文件是新的，而不是如果它们是已更新的预先存在的文件。这很奇怪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T20:48:36.297

您需要转义“。”

```
git add \./\*.java 
```

作品。

```
$ git add \./\*.c
$ git status
# On branch br1
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#   new file:   bang/boo.c
#   new file:   bing/one.c
# 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-16T04:53:19.493

```
git add -u *.java 
```

其中
**-u**添加修改后的跟踪文件
***.java**是 pathspec

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:20:38.693

而不是做'git add'使用：

```
git status 
```

这将向您显示哪些文件是新的（git 未知）以及哪些文件已被修改。更重要的是，对于您的情况，“git status”将显示报告文件的完整路径。知道完整路径后，您将能够使用 'git add full-path-to.java' 一个接一个地添加它们，或者，如果一切看起来都可以提交，那么 'git add -A' 会将它们全部添加。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-30T19:35:35.043

如果您想将自己限制在 git 已经知道的文件中，您可以将 git-ls-files 与过滤器结合使用：

`git ls-files [path] | grep '\.java$' | xargs git add`

在这里，您必须指定文件夹的路径。

**或者**

在这里，您给出了在排除标准 git 排除项的同时显示缓存的**c**和其他**o**文件的说明：每个目录中的 .git/info/exclude、.gitignore 以及用户的全局排除文件。

`git ls-files -co --exclude-standard | grep '\.java$'| xargs git add`

从这个答案[递归地按模式添加文件](https://stackoverflow.com/questions/2855140/recursively-add-files-by-pattern)。

# c++ - 使用包含 QProcess 枚举的 QString 在 QTextBrowser 中设置文本

> ID：10033926
> 
> 赞同：0
> 
> 时间：2012-04-05T18:26:17.520
> 
> 标签：c++, qt, qprocess, qtextbrowser

我想将包含两个 QProcess 枚举的 QString 写入 QTextBrowser。因此，我在我的一种方法中使用了：

```
QString Text = "Error! Exit-Status: " + Status + QString(" Error-Code: ") + Prozess.error() + " File not created!"

Dialog.mytextBrowser -> setText(Text); 
```

这也有效，但缺少 QProcess::ExitStatus "Status" 的值和 Prozess.error() 的值。我必须更改哪些值才能将值放入 QTextBrowser？问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T12:45:45.187

好的，问题已由 QString 解决`Text = QString( "Error! Exit-Status: %1 Error-Code: %2 File not created!" ).arg( Status ).arg(Prozess.error());`。无论如何，谢谢支持。

# stripes - Shiro 总是将我重定向到 login.jsp

> ID：10033929
> 
> 赞同：3
> 
> 时间：2012-04-05T18:26:21.170
> 
> 标签：stripes, shiro

**这是来自 shiro.ini 的配置**

> shiro.loginUrl = /login.jsp
> 
> ######### URL 配置 ################### [urls] /login.jsp = anon /public/login/** = anon /public /app/** = 认证

**条纹**...

```
@UrlBinding("/public/app/")
public class CalculatorActionBean implements ActionBean {
.....

}

@UrlBinding("/public/login/")
public class UserAuthenticateBean implements ActionBean {

    private static final transient Logger log = LoggerFactory.getLogger(UserAuthenticateBean.class);
    private ActionBeanContext context;
    private String username;
    private String password;
    private String message;

    public ActionBeanContext getContext() {
        return context;
    }

    public void setContext(ActionBeanContext context) {
        this.context = context;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    @DefaultHandler
    @DontValidate
    public Resolution defaultHander() {
        return new ForwardResolution("/login.jsp");
    }

    public Resolution login() {

        Subject currentUser = SecurityUtils.getSubject();
        log.info("CU=" + currentUser.toString());

        if (!currentUser.isAuthenticated()) {
            TenantAuthenticationToken token = new TenantAuthenticationToken(username, password, "jdbcRealm");
            //UsernamePasswordToken token = new UsernamePasswordToken("akumar", "ash");
            token.setRememberMe(true);
            try {
                currentUser.login(token);
            } catch (UnknownAccountException uae) {
                log.info("There is no user with username of " + token.getPrincipal());
            } catch (IncorrectCredentialsException ice) {
                log.info("Password for account " + token.getPrincipal() + " was incorrect!");
            } catch (LockedAccountException lae) {
                log.info("The account for username " + token.getPrincipal() + " is locked.  "
                        + "Please contact your administrator to unlock it.");
            } // ... catch more exceptions here (maybe custom ones specific to your application?
            catch (AuthenticationException ae) {
                //unexpected condition?  error?
                ae.printStackTrace();
            }
        }

        if (currentUser.isAuthenticated()) {
            message = "Success";
        } else {
            message = "Fail";
        }

        System.out.println(message);

        message += getUsername() + getPassword();
        return new ForwardResolution("/logged_in.jsp");
    }
} 
```

登录的.jsp

```
<a href ="/oc/public/app">app</a> 
```

现在，如果我从 shiro.ini 中删除 /public/app/** = authc 行，我可以为登录用户和访客访问 /public/app

如果我保留这条线，那么没有人可以访问该页面并返回 login.jsp

使我抓狂！

帮助！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T22:47:35.850

更改您的 urls 配置以让 'authc' 过滤实际的登录 url：

```
[main]
...
authc.loginUrl = /login.jsp

[urls]
/login.jsp = authc
/public/login/** = anon 
/public/app/** = authc 
```

过滤器`authc`足够聪明，可以知道请求是否未经过身份验证，仍然让它通过底层页面，以便用户可以登录。

# java - 使用 Dozer Java API 配置自定义转换器

> ID：10033937
> 
> 赞同：7
> 
> 时间：2012-04-05T18:27:03.993
> 
> 标签：java, dozer

我正在尝试使用 Dozer Java API 使用自定义转换器映射两个 Java 类。有没有办法可以在 Java 中配置类级自定义转换器？现在我必须在 XML 中添加配置：

```
<configuration>
    <custom-converters>
        <converter type="com.abc.A2BConverter" >
            <class-a>com.abc.ClassA</class-a>
            <class-b>com.abc.ClassB</class-b>
      </converter>
    </custom-converters>     
</configuration>` 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-16T11:18:43.390

推土机文档说：

> 事实上，配置的某些部分（例如全局配置块）只能以 Xml 格式表示。（[链接](http://dozer.sourceforge.net/documentation/apimappings.html)）

据我所知，必须在这个全局配置块中定义类级自定义转换器。

所以：不，您不能通过 Java API 定义它们。

# paypal - 我应该为 PayPal 沙盒使用什么用户名/密码/签名？

> ID：10033940
> 
> 赞同：5
> 
> 时间：2012-04-05T18:27:17.490
> 
> 标签：paypal, paypal-sandbox

我正在尝试使用 Paypal NVP API 退款交易。我在沙盒帐户中有一些付款，但是当我尝试通过 API 退款时，我得到了`You do not have permissions to make this API call`. 但我不确定我应该使用什么凭据。

根据[文档](https://www.paypalobjects.com/en_US/ebook/PP_NVPAPI_DeveloperGuide/overview.html)，它说：

> 要访问 PayPal API，您需要能够识别您身份的 API 凭证（API 签名或 API 证书）。在 PayPal 沙盒测试环境中运行的示例程序中使用以下示例 API 签名和密码。
> 
> `API username sdk-three_api1.sdk.com`
> `API password QFZCWN5HZM8VBG7Q`
> `API signature A‑IzJhZZjhg29XQ2qnhapuwxIDzyAZQ92FRP5dqBzVesOkzbdUONzmOU`

我尝试为发出退款的沙盒商家帐户生成 API 凭据，但每次尝试时 Paypal 网站都会崩溃。这些是正确的凭据吗？我需要做什么来测试这个？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-06T02:29:16.990

您的测试帐户没有凭据。

要开始在 Sandbox 中使用支付卡，您必须首先创建一个买家测试帐户并启用店内结帐。

登录沙箱后，您将在菜单**API 和支付卡凭据**中找到该选项 ，然后单击它，您将获得选项**创建测试帐户**，创建帐户后，您将获得 API 用户名、API 密码和签名。

在您的应用程序中使用这些 API 用户名、API 密码和签名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-02-02T13:37:02.103

登录后，我在我的帐户中找到了这些详细信息：

转到**沙盒**选项卡

在此下方，您将找到**Accounts**。单击**帐户**。

将显示您的所有电子邮件列表。

单击属于企业帐户的电子邮件 ID。

您将看到两个选项：电子邮件 ID 下方的**个人资料**和**通知。**

单击**配置文件**后，将弹出一个窗口，其中包含名称**帐户详细信息**。

在那里，您将看到选项卡**API Credentials**。在此您将找到您的用户名、密码和签名。请注意：您只会在您的业务类型帐户中找到这些详细信息，而不是针对买家类型。

# php - 有没有办法调整视频大小？

> ID：10033941
> 
> 赞同：1
> 
> 时间：2012-04-05T18:27:21.600
> 
> 标签：php, html

我从我的数据库中检索嵌入代码视频。但是，在 db 中，它们是 650 x 650。我想要的是使它们变小。

使用模板精简版标签，我试过这个

```
<tr>
    <td>Videos</td>
    <td>
        <div height="100" width =" 200" /> 
            {foreach value=movieF from=$movieFragman}
                {$movieF.embedCode} 
            {/foreach}
        </div>
    </td>                
</tr> 
```

但`div`不起作用。我能为此做些什么？

使用下面的代码，我设置了 div 的宽度高度

```
 </style><style type="text/css">
    {literal}
    div.embed
    {
    width:200px;
    height:100px;
    }

    {/literal}
    </style> 
```

有时候是这样的.. ![在此处输入图像描述](../Images/a189c89cdb9ba52d7ae415ebd41fb9c5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:42:26.650

这是工作

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>
    $(document).ready(function(){
       $('.test embed').attr('height','');
       $('.test embed').height(600);
       $('.test embed').attr('width','');
       $('.test embed').width(600);
    });
</script>
</head>
<body>
    <div class="test"> 
        <embed src="http://www.abc.com/images/player2.swf?video=173350&amp;movieid=1500%22" wmode="window" bgcolor="#000000" allowfullscreen="true" scale="noScale" width="640" height="483" type="application/x-shockwave-flash">
    </div>
</body>
</html> 
```

# wcf - 如何在 WSFederationHttpBinding 中支持流式传输？

> ID：10033947
> 
> 赞同：1
> 
> 时间：2012-04-05T18:27:40.060
> 
> 标签：wcf, streaming, ws-federation

我有一个 wcf 服务，用于将大文件上传和下载到服务器。我正在使用 MTOM 消息编码，并且我想使用流传输模式。但是我们使用的是 wsFederationHttpBinding。如何在 wsFederationHttpBinding 中支持流式传输？

我的 WCF 服务 web.config 代码如下，

```
<wsFederationHttpBinding>
 <binding  name="UploadserviceFederation"
                      messageEncoding="Mtom"
                  maxBufferPoolSize="2147483647"
                  maxReceivedMessageSize="2147483647" >
          <readerQuotas maxStringContentLength="2147483647"
                      maxDepth="2147483647"
                      maxBytesPerRead="2147483647"
                      maxArrayLength="2147483647"/>

          <security mode="TransportWithMessageCredential">
            <!-- Ping token type MUST be SAML 1.1, do not change -->
            <message 
              issuedTokenType="http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1" negotiateServiceCredential="false">
              <!-- TODO: You must put the proper issuer URN of the Ping STS; normally this would be the Ping base URL -->
              <issuer address="https://my-issuer.com" binding="customBinding" bindingConfiguration="FileUploadSTSBinding" />
            </message>
          </security>
        </binding>

      </wsFederationHttpBinding>

<customBinding>
        <binding name="FileUploadSTSBinding">
          <security authenticationMode="UserNameOverTransport" requireDerivedKeys="false"
              keyEntropyMode="ServerEntropy" requireSecurityContextCancellation="false"
              requireSignatureConfirmation="false">
          </security>
          <httpsTransport maxReceivedMessageSize="2147483647" maxBufferPoolSize="2147483647" maxBufferSize="2147483647" />
        </binding>
</customBinding> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-09-29T14:32:30.510

已经有几年了，所以我不知道这是否仍然有帮助，但我在试图找出同样的问题时遇到了这篇文章，所以它可能会对某人有所帮助。

事实证明，它实际上非常简单......一旦你的舞蹈恰到好处。

可能最简单的事情（也是我首先尝试的）是从 WS2007FederationHttpBinding 继承。事实证明，它有一个虚拟的 GetTransport 方法，因此您可以覆盖它并返回一个将 TransferMode 设置为 Streamed 的 HttpsTransport 实例：

```
public class FileUploadSTSBinding : WS2007FederationHttpBinding
{
    protected override TransportBindingElement GetTransport()
    {
        return new HttpsTransportBindingElement()
        {
            TransferMode = TransferMode.Streamed
        };
    }
} 
```

然而，这样做揭示了另外一些东西：由于我的绑定不再是一个可识别的绑定类型，svcutil 不再将其视为 WS2007FederationHttpBinding，而是将其视为自定义绑定，这导致客户端配置生成为堆栈绑定元素，而不是使用联合绑定提供的快捷方式：

```
 <customBinding>
                <binding name="CustomBinding_ISdk">
                    <security defaultAlgorithmSuite="Default" authenticationMode="IssuedTokenOverTransport"
                        requireDerivedKeys="true" includeTimestamp="true" messageSecurityVersion="WSSecurity11WSTrust13WSSecureConversation13WSSecurityPolicy12BasicSecurityProfile10">
                        <issuedTokenParameters keyType="BearerKey">
                            <additionalRequestParameters>
                                <trust:SecondaryParameters xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">
                                    <trust:KeyType xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://docs.oasis-open.org/ws-sx/ws-trust/200512/Bearer</trust:KeyType>
                                </trust:SecondaryParameters>
                            </additionalRequestParameters>
                        </issuedTokenParameters>
                        <localClientSettings detectReplays="false" />
                        <localServiceSettings detectReplays="false" />
                    </security>
                    <textMessageEncoding />
                    <httpsTransport />
                </binding> 
```

..它显示了底层绑定元素实际上*是*什么，这让你可以随心所欲地调整它们。而且，事实证明，它们与实际绑定并没有太大区别，因为唯一真正特殊的部分是安全元素，并且变化不大。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:53:54.707

您必须在自定义绑定中启用流传输模式，因为只有`BasicHttpBinding`,`NetTcpBinding`和`NetNamedPipeBinding`绑定公开该`TransferMode`属性。有关示例，请参见[本文。](http://msdn.microsoft.com/en-us/library/ms789010.aspx)

# c# - 与屏幕上的控件分离后，RichTextBox 文本在 VisualBrush 中消失

> ID：10033950
> 
> 赞同：2
> 
> 时间：2012-04-05T18:27:51.097
> 
> 标签：c#, wpf, richtextbox, visualbrush

我有一个通过 VisualBrush 完成的缩略图预览。Preview 是一个 ItemsControl，它包含其他元素 RichTextBox。

```
var preview = new VisualBrush(itemsControl, ViewboxUnits = BrushMappingMode.Absolute,
                    Viewbox = Rect(controlSize),
                    Stretch = Stretch.Uniform); 
```

当 ItemsControl 是应用程序可视化树的一部分时，预览和控件本身显示得很好，但是当我从应用程序可视化树中删除 ItemsControl（例如 canvas.Remove(itemsControl)）时，RichTextBox 控件在预览中变得不可见（VisualBrush）而所有其他控件都照常显示。

```
public void SetActiveControl(ItemsControl newItemsControl) {
    canvas.Children.Remove(currentItemsControl);
    canvas.Children.Add(newItemsControl);
    currentItemsControl = newItemsControl;
} 
```

我比较了 RichTextBox 与应用程序可视化树分离前后的属性。区别在于属性 IsLoaded（在 TRUE 之前，在 FALSE 之后）和 IsVisible（在 TRUE 之前，在 FALSE 之后）。但是其他元素（例如路径）具有相同的差异，并且仍然可以正确显示在预览中。

我无法理解 canvas.Remove(itemsControl) 如何隐藏 RichTextBox 但保留其他控件！任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T21:09:47.800

视觉画笔无法冻结。因此，您可以在从可视树中分离控件之前从 VisualBrush 创建 ImageBrush。这是一个如何做到这一点的示例：[“冻结”该 VisualBrush](http://marktinderholt.wordpress.com/2008/04/14/freeze-that-visualbrush/)。

# html - 如何在多个选择框中选择一个选项并从所选选项加载数据

> ID：10033951
> 
> 赞同：0
> 
> 时间：2012-04-05T18:27:51.537
> 
> 标签：html, drop-down-menu

我试图弄清楚如何从选定的选项加载数据。例如，在多选下拉框中，我有 3 个选项：

```
Option 1: Apple
Option 2: Orange
Option 3: Pear 
```

假设我有每个选项的数据列表。例如，当我选择 Apple 时，它​​会在内部 div 中加载一个表格，在第一列中描述其价格、重量和国家/地区。

当我选择第二个选项时，它将允许我将它与第一个选项进行比较。它应该加载到第二列。例如：

```
Option  :   Apple  | Orange
Price   :   $3.95  | $2.50
Weight  :   40g    | 50g
Country :   USA    | Brazil 
```

很高兴知道理想的语言/方法是什么？JavaScript / jQuery ?

编辑：对不起，如果有任何混淆，我的主要问题是如何做我刚才描述的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T01:23:47.413

我强烈建议您为此使用[jQuery](http://jquery.com/)。除此之外，jQuery 拥有[出色的文档](http://docs.jquery.com/Main_Page)。

# python - 鸭子打字：如何避免名称冲突？

> ID：10033953
> 
> 赞同：4
> 
> 时间：2012-04-05T18:27:55.963
> 
> 标签：python, language-agnostic, duck-typing, dynamic-typing

我认为理解鸭子类型的想法，并希望在我的代码中更频繁地使用它。但是，我担心一个潜在的问题：名称冲突。

假设我想要一个对象做某事。我知道合适的方法，所以我简单地调用它，看看会发生什么。一般来说，有三种可能的结果：

1.  找不到该方法并`AttributeError`引发异常。这表明该对象不是我认为的那样。没关系，因为使用鸭子打字我要么捕捉到这样的异常，要么我愿意让外部范围处理它（或让程序终止）。

2.  方法找到了，它正是我想要的，一切都很好。

3.  方法找到了，但不是我想要的方法；它是来自完全不相关的类的同名方法。执行将继续，直到稍后检测到不一致的状态，或者在最坏的情况下，程序会默默地产生不正确的输出。

现在，我可以看到优质名称如何降低结果#3 的机会。但是项目被合并，代码被重用，库被交换，并且很可能在某些时候两个方法具有相同的名称并且完全不相关（即，它们不打算在多态中相互替代）。

我正在考虑的一个解决方案是添加方法名称的注册表。每个注册表记录将包含：

*   方法名称（唯一；即每个名称只有一条记录）
*   它的概括描述（即，适用于它可能被调用的任何实例）
*   它打算用于的一组类

如果将方法添加到新类，则需要将类添加到注册表（手动）。那时，程序员可能会注意到该方法是否与已经附加的含义不一致，并且如果需要，使用另一个名称。

每当调用方法时，程序会自动验证名称是否在注册表中，并且实例的类是记录中的类之一。如果不是，则会引发异常。

我知道这是一种非常繁重的方法，但在某些精度至关重要的情况下，我可以看到它可能很有用。是否尝试过（在 Python 或其他动态类型语言中）？有没有做类似事情的工具？还有其他值得考虑的方法吗？

注意：我不是指全局级别的名称冲突，避免命名空间污染是正确的方法。我指的是方法名称的冲突；这些不受名称空间的影响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:40:37.030

好吧，如果这很*关键*，您可能不应该使用鸭子打字......

实际上，程序是有限的系统，传递给任何特定例程的可能类型的范围不会引起您担心的问题（通常只有一种类型传入）。

但是如果你想解决这个问题，python 提供了[ABCs](http://docs.python.org/library/abc.html)（抽象基类）。这些允许您将“类型”与任何一组方法相关联，因此可以像您建议的注册表一样工作（您可以以正常方式从 ABC 继承，或者简单地向它“注册”）。

然后，您可以手动检查这些类型或使用[pytyp](http://www.acooke.org/pytyp/)的装饰器自动检查。

但是，尽管是 pytyp 的作者，并且发现这些问题很有趣，但我个人并不认为这种方法有用。实际上，您担心的事情根本不会发生（如果您想担心某些事情，请关注在使用高阶函数时缺少类型文档！）。

PS note - ABC 纯粹是元数据。他们不强制执行任何事情。此外，使用 pytyp 装饰器进行检查效率极低——您真的只想在关键的地方执行此*操作*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:40:57.093

如果您遵循良好的编程习惯，或者让我说您的代码是否是 Pythoic，那么您可能很少会遇到此类问题。请参阅[常见问题解答 在模块中使用导入的“最佳实践”是什么？](http://docs.python.org/faq/programming.html#what-are-the-best-practices-for-using-import-in-a-module). 如果您尝试重用 Python 保留名称和/或标准库或与模块名称发生名称冲突，通常不建议将名称空间弄乱并且唯一可能发生冲突的时间。但是，如果您遇到这样的冲突，那么代码就会出现严重问题。例如

1.  为什么有人将变量命名为列表或定义一个名为 len 的函数？
2.  当他/她打算在当前命名空间中导入变量时，为什么有人会命名一个变量 difflib？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:43:58.460

要解决您的问题，请查看[抽象基类](http://docs.python.org/library/abc.html)。它们是处理这个问题的 Pythonic 方式；您可以在基类中定义常见行为，甚至可以定义确定特定对象是否是抽象基类的“虚拟基类”的方法。这在某种程度上模仿了您所描述的注册表，而不需要所有类事先都知道注册表。

但在实践中，这个问题并不像您预期​​的那样频繁出现。如果方法没有按您期望的方式工作，那么带有`__iter__`方法或方法的对象就会被破坏。`__str__`同样，如果您说函数的参数需要在`.callback()`其上定义方法，那么人们会做正确的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T19:00:36.793

如果您担心缺少静态类型检查会导致一些错误通过，答案不是进行类型检查，而是编写测试。

在存在单元测试的情况下，类型检查系统作为捕获错误的手段在很大程度上变得多余。虽然类型检查系统确实可以捕获一些错误，但它只会捕获一小部分潜在错误。要赶上其余部分，您需要进行测试。这些单元测试必然会捕捉到类型检查系统会捕捉到的大多数类型错误，以及类型检查系统无法捕捉到的错误。

# javascript - 对于与 XHR 过滤的多对多/has_many 关系，是否有任何好的后端独立 HTML/CSS/JS 小部件？

> ID：10033954
> 
> 赞同：1
> 
> 时间：2012-04-05T18:27:58.910
> 
> 标签：javascript, html, css, has-and-belongs-to-many, m2m

我一直在寻找一个很好的后端独立 HTML/CSS/JS 小部件，用于与 XHR 过滤的多对多/has_many 关系，但我似乎找不到任何东西。

我很难相信人们会不断地重新发明这个轮子。

我错过了什么？

**编辑**：好的，从不理解它的人数来看，这是一个糟糕的问题。

我相信常规的 Web 交互应该以最低的成本来实现（它应该已经是 HTML 或安装包）。

大多数情况下都是如此。但是，我很难找到从集合中挑选项目的东西（不是自动完成，比仅仅一个字符串更复杂的东西。如果你想要一个例子，假设你想挑选用户并在挑选时显示他们的头像.)。

想象一下：

当您希望用户提供

*   表单中的一个短字符串，你给他们一个输入框
*   表单中的长文本，你给他们一个文本区域
*   一段 HTML（例如，对于博客文章的正文），你给他们一个带有[CKEditor](http://ckeditor.com/)或[TinyMCE的文本区域](http://www.tinymce.com/)
*   从一个简短的列表中选择一些东西，你给他们一个下拉菜单（比如一个选择框）
*   一个基于各种已知替代方案的字符串，你给他们一个带有自动完成功能的输入框（[jQuery UI Autocomplete](http://jqueryui.com/demos/autocomplete/)，[YUI Autocomplete](http://yuilibrary.com/yui/docs/autocomplete/)等）
*   一组来自多种选择的项目，你给他们......*鼓声......*

我不知道！这就是我的问题。我搜索了一下，只能想出[jquery-tokeninput](http://loopj.com/jquery-tokeninput/demo.html)作为一个可靠的选项。

# java - 如何通过套接字java发送列表

> ID：10033960
> 
> 赞同：0
> 
> 时间：2012-04-05T18:28:09.727
> 
> 标签：java, sockets, serializable

我正在尝试通过套接字发送一个对象。

其对象网

```
public class Net {
    public List<NetObject> objects; //= new ArrayList<NetObject>(); // place + transition
    public List<ArcObject> arcs; // = new ArrayList<ArcObject>(); // arcs - objects
} 
```

这是 ArcObject 类

```
public class ArcObject implements Observer  {

    public NetObject o1;
    public NetObject o2;
    public String parameter;
} 
```

这是 NetObject 类

```
public class NetObject implements Observer{
public int index; // index of object
public int type; // type - place=1, transition=2 ...
public int x; // position
public int y;
public List<Integer> tokens ; //list of tokens
//public List<ArcObject> arcs = new ArrayList<ArcObject>();
public String guard;
// etc... 
} 
```

然后我连接到服务器

```
 String computername=InetAddress.getLocalHost().getHostName();
        kkSocket = new Socket(computername, 4444);
        OutputStream outputStream = null ;
        ObjectOutputStream  out = null ; 
        outputStream = kkSocket.getOutputStream();  
        out = new ObjectOutputStream(outputStream); 
```

然后我尝试通过套接字发送对象

```
out.writeObject(petriNet); //petriNet object is from class Net 
```

但客户给了我一个例外

```
java.io.NotSerializableException: petri.ArcObject 
```

但是 ArcObject 类不能实现 Serializable，因为它已经实现了 Observer，所以我应该如何通过包含两个列表的套接字发送对象。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:30:35.463

您可以实现多个接口。只需在声明中用逗号分隔它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:29:47.733

`ArcObject`它的所有成员（及其成员等）都需要实现`Serializable`接口（它只是一个标记接口，没有实现方法）。

哦，你可以实现多个接口。你不能做的是扩展多个类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T18:30:27.837

> ArcObject 类不能实现 Serializable，因为它已经实现了 Observer

是的，它可以。一个类可以实现多个接口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T18:31:06.147

您实际上可以在 Java 中实现多个接口。因此可以实现 Observer AND Serializable。

# regex - grep 中的 GNU 正则表达式在 redhat 与 Windows 上的工作方式不同

> ID：10033961
> 
> 赞同：0
> 
> 时间：2012-04-05T18:28:09.987
> 
> 标签：regex, grep

我正在尝试查找与以下内容匹配的任何字符串：

```
AAA-### 
```

其中 A 是任何字母字符，可以有 2 到 5 个。

# 是任何数字，可能有 1 个或多个。

因此，应该找到以下字符串：

```
ABC-123
DE-4
FGHI-56789 
```

但这不应该被发现：

```
A15-B432 
```

我尝试了一些不同的东西，比如：

```
grep [[:alpha:]]\{2,5\}-[[:digit:]]\+ 
```

然而，这并没有奏效。

这是redhat上的gnu grep。在我的测试中，在我的 Windows 机器上使用 grep，它也使用了 gnu grep，这很有效。两者似乎都是 2.5.1 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:45:04.547

您需要`-E`扩展正则表达式的标志：

```
$ cat file
ABC-123
DE-4
FGHI-56789
A15-B432
$ grep [[:alpha:]]\{2,5\}-[[:digit:]]\+ file 
$ grep -E [[:alpha:]]\{2,5\}-[[:digit:]]\+ file 
ABC-123
DE-4
FGHI-56789 
```

我个人更喜欢使用`''`来避免所有`\`字符：

```
$ grep -E '[[:alpha:]]{2,5}-[[:digit:]]+' file 
ABC-123
DE-4
FGHI-56789 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:45:03.967

你知道哪个部分不工作吗？

是`[:alpha:]`and`[:digit:]`还是 the`\{2,5\}`或者只是您没有将正则表达式括在引号中的事实

```
grep '[[:alpha:]]\{2,5\}-[[:digit:]]\+'? 
```

# java - 构建和验证 Gigya 签名

> ID：10033963
> 
> 赞同：10
> 
> 时间：2012-04-05T18:28:14.713
> 
> 标签：java, encoding, base64, gigya

根据 Gigya 的[构造签名的说明，我编写了一个方法来根据指定的时间戳和 UID 验证 gigya 签名](http://developers.gigya.com/030_Gigya_Socialize_API_2.0/010_Developer_Guide/57_Security#Constructing_a_signature)。这是 Gigya 的***伪***代码：

```
string constructSignature(string timestamp, string UID, string secretKey) {
    // Construct a "base string" for signing
    baseString = timestamp + "_" + UID;
    // Convert the base string into a binary array
    binaryBaseString = ConvertUTF8ToBytes(baseString);
    // Convert secretKey from BASE64 to a binary array
    binaryKey = ConvertFromBase64ToBytes(secretKey);
    // Use the HMAC-SHA1 algorithm to calculate the signature 
    binarySignature = hmacsha1(binaryKey, baseString);
    // Convert the signature to a BASE64
    signature = ConvertToBase64(binarySignature);
    return signature;
} 
```

[[原文如此]](https://stackoverflow.com/questions/10033963/constructing-and-validating-a-gigya-signature#comment12987098_10033963)

这是我的方法（省略异常处理）：

```
public boolean verifyGigyaSig(String uid, String timestamp, String signature) {

    // Construct the "base string"
    String baseString = timestamp + "_" + uid;

    // Convert the base string into a binary array
    byte[] baseBytes = baseString.getBytes("UTF-8");

    // Convert secretKey from BASE64 to a binary array
    String secretKey = MyConfig.getGigyaSecretKey();
    byte[] secretKeyBytes = Base64.decodeBase64(secretKey);

    // Use the HMAC-SHA1 algorithm to calculate the signature 
    Mac mac = Mac.getInstance("HmacSHA1");
    mac.init(new SecretKeySpec(secretKeyBytes, "HmacSHA1"));
    byte[] signatureBytes = mac.doFinal(baseBytes);

    // Convert the signature to a BASE64
    String calculatedSignature = Base64.encodeBase64String(signatureBytes);

    // Return true iff constructed signature equals specified signature
    return signature.equals(calculatedSignature);
} 
```

`false`即使不应该，此方法也会返回。任何人都可以发现我的实施有问题吗？我想知道调用者或 gigya 本身是否存在问题 - **“您的方法已检出”是一个有效的答案**。

~~我正在使用 Apache Commons 的[`Base64`](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html)类进行编码。~~

[在Gigya 的常见问题解答](http://developers.gigya.com/059_FAQ#How_do_I_deal_with_signatures.3F)中还可以找到有关签名的更多（有些多余的）信息，以防万一。

**为了进一步澄清这一点**：`uid`、、`timestamp`和`signature`都取自 gigya 设置的 cookie。为了验证这些没有被欺骗，我正在使用`uid`and `timestamp`，并确保`signature`可以使用我的密钥进行重建。当它不应该在过程中的某个时刻指示错误/格式问题时，它失败的事实，无论是使用我的方法，在前端，还是使用 gigya 本身。这个问题的目的本质上是排除上述方法中的错误。

**注意：**我也尝试过 URL-encoding `uid`：

```
String baseString = timestamp + "_" + URLEncoder.encode(uid, "UTF-8"); 
```

虽然我认为这并不重要，因为它只是一个整数。也是如此`timestamp`。

**更新：**

根本问题已经解决，但问题本身仍然悬而未决。有关更多详细信息，请参阅[我的答案](https://stackoverflow.com/a/10157301)。

**更新 2：**

事实证明，我对我使用的是哪个 apache`Base64`类感到困惑——我的代码使用的不是[Commons Codec 版本](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html)，而是[Commons Net 版本](http://commons.apache.org/net/api-3.1/org/apache/commons/net/util/Base64.html)。这种困惑源于我的项目中有大量第三方库，以及我`Base64`多年来对 Apache 库的许多实现一无所知——我现在意识到[Commons Codec](http://commons.apache.org/codec/)旨在解决这种情况。看来我在编码方面迟到了。

在切换 Commons Codec 的版本后，该方法的行为正确。

我将把赏金奖励给[@erickson](https://stackoverflow.com/users/3474/erickson)，因为[他的回答](https://stackoverflow.com/a/10135651/697449)很到位，但请为他们出色的洞察力投票支持这两个答案！我将暂时开放赏金，以便他们得到应有的关注。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-13T05:23:25.893

我会仔细看看你的 Base-64 编码和解码。

您是否为此使用第三方库？如果有，是哪一个？如果没有，您能否发布您自己的实现或至少一些示例输入和输出（用十六进制表示字节）？

有时使用的“额外”Base-64 字符会有所不同（用字符替换“/”和“+”）。也可以省略填充，这会导致字符串比较失败。

* * *

正如我所怀疑的，正是 Base-64 编码导致了这种差异。但是，导致问题的是尾随空格，而不是填充或符号的差异。

您使用的[`encodeBase64String()`](http://commons.apache.org/net/api-3.1/org/apache/commons/net/util/Base64.html#encodeBase64String%28byte%5B%5D%29)方法始终将 CRLF 附加到其输出中。Gigya 签名不包括此尾随空格。比较这些字符串是否相等仅因为空格的差异而失败。

使用[`encodeBase64String()`](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html#encodeBase64String%28byte%5B%5D%29)Commons Codec 库（而不是 Commons Net）来创建有效的签名。

如果我们将签名计算分解，并针对 Gigya SDK 的验证器测试其结果，我们可以看到删除 CRLF 会创建一个有效的签名：

```
public static void main(String... argv)
  throws Exception
{
  final String u = "";
  final String t = "";
  final String s = MyConfig.getGigyaSecretKey();

  final String signature = sign(u, t, s);
  System.out.print("Original valid? ");
  /* This prints "false" */
  System.out.println(SigUtils.validateUserSignature(u, t, s, signature));

  final String stripped = signature.replaceAll("\r\n$", "");
  System.out.print("Stripped valid? ");
  /* This prints "true" */
  System.out.println(SigUtils.validateUserSignature(u, t, s, stripped));
}

/* This is the original computation included in the question. */
static String sign(String uid, String timestamp, String key)
  throws Exception
{
  String baseString = timestamp + "_" + uid;
  byte[] baseBytes = baseString.getBytes("UTF-8");
  byte[] secretKeyBytes = Base64.decodeBase64(key);
  Mac mac = Mac.getInstance("HmacSHA1");
  mac.init(new SecretKeySpec(secretKeyBytes, "HmacSHA1"));
  byte[] signatureBytes = mac.doFinal(baseBytes);
  return Base64.encodeBase64String(signatureBytes);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-13T02:25:50.990

代码审查时间！我喜欢做这些。让我们检查您的解决方案，看看我们在哪里失败。

在散文中，我们的目标是将时间戳和 UID 下划线连接在一起，将 UTF-8 的结果强制转换为字节数组，将给定的 Base64 密钥强制转换为第二个字节数组，[SHA-1](http://en.wikipedia.org/wiki/SHA-1)将两个字节数组连接在一起，然后将结果转换回Base64。很简单，对吧？

（是的，那个伪代码有一个错误。）

现在让我们逐步检查您的代码：

```
public boolean verifyGigyaSig(String uid, String timestamp, String signature) { 
```

您在这里的方法签名很好。虽然很明显，您需要确保您创建的时间戳和您正在验证的时间戳使用完全相同的格式（否则，这将始终失败）并且您的字符串是 UTF-8 编码的。

（[有关字符串编码如何在 Java 中工作的更多详细信息](http://docs.oracle.com/javase/tutorial/i18n/text/string.html)）

```
 // Construct the "base string"
    String baseString = timestamp + "_" + uid;

    // Convert the base string into a binary array
    byte[] baseBytes = baseString.getBytes("UTF-8"); 
```

这很好（[参考 a](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#getBytes%28java.lang.String%29)，[参考 b](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/charset/Charset.html)）。*但是，*在未来，考虑[`StringBuilder`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html)显式地使用 for 字符串连接，而不是依赖[编译器时的优化来支持这个特性](https://stackoverflow.com/a/5430215/517815)。

请注意，到目前为止，文档在使用“UTF-8”还是“UTF8”作为您的字符集标识符方面是不一致的。不过，“UTF-8”是公认的标识符；我相信“UTF8”是为了遗留和兼容性目的而保留的。

```
 // Convert secretKey from BASE64 to a binary array
    String secretKey = MyConfig.getGigyaSecretKey();
    byte[] secretKeyBytes = Base64.decodeBase64(secretKey); 
```

拿着它！这打破了[封装](http://en.wikipedia.org/wiki/Encapsulation_%28object-oriented_programming%29)。它在功能上是正确的，但是如果您将它作为参数传递给您的方法，而不是从另一个源中拉入它会更好（在这种情况下，将您的代码耦合到 的细节`MyConfig`）。否则，这也很好。

```
 // Use the HMAC-SHA1 algorithm to calculate the signature 
    Mac mac = Mac.getInstance("HmacSHA1");
    mac.init(new SecretKeySpec(secretKeyBytes, "HmacSHA1"));
    byte[] signatureBytes = mac.doFinal(baseBytes); 
```

是的，这是正确的（[参考 a](http://docs.oracle.com/javase/1.4.2/docs/guide/security/jce/JCERefGuide.html#AppA)，[参考 b](http://docs.oracle.com/javase/1.4.2/docs/api/javax/crypto/spec/SecretKeySpec.html)，[参考 c](http://docs.oracle.com/javase/1.4.2/docs/api/javax/crypto/Mac.html#doFinal%28byte%5B%5D%29)）。我这里没有什么要补充的。

```
 // Convert the signature to a BASE64
    String calculatedSignature = Base64.encodeBase64String(signatureBytes); 
```

正确，并且...

```
 // Return true iff constructed signature equals specified signature
    return signature.equals(calculatedSignature);
} 
```

... 正确的。忽略警告和实现说明，您的代码会按程序检查。

不过，我会推测几点：

1.  [您是否按照此处](http://docs.oracle.com/javase/tutorial/i18n/text/string.html)定义的方式对您的 UID*或*时间戳的输入字符串进行了 UTF-8 编码？如果你没有这样做，你将*不会*得到你期望的结果！

**   您确定密钥正确且编码正确吗？确保在调试器中检查这一点！

    *   就此而言，如果您可以使用 Java 或其他方式访问签名生成算法，请在调试器中验证整个事情。如果做不到这一点，合成一个将帮助您检查您的工作，因为[文档中提出了编码警告](http://docs.oracle.com/javase/tutorial/i18n/text/string.html)。* 

 *也应该报告伪代码错误。

我相信在这里检查您的工作，尤其是您的字符串编码，将揭示正确的解决方案。

* * *

## 编辑：

我检查[了他们`Base64`](http://wikifiles.gigya.com/SDKs/Java/doc/com/gigya/socialize/Base64.html)对[Apache Commons Codec 的](https://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html)实现。测试代码：

```
import org.apache.commons.codec.binary.Base64;
import static com.gigya.socialize.Base64.*;

import java.io.IOException;

public class CompareBase64 {
    public static void main(String[] args) 
      throws IOException, ClassNotFoundException {
        byte[] test = "This is a test string.".getBytes();
        String a = Base64.encodeBase64String(test);
        String b = encodeToString(test, false);
        byte[] c = Base64.decodeBase64(a);
        byte[] d = decode(b);
        assert(a.equals(b));
        for (int i = 0; i < c.length; ++i) {
            assert(c[i] == d[i]);
        }
        assert(Base64.encodeBase64String(c).equals(encodeToString(d, false)));
        System.out.println(a);
        System.out.println(b);
    }
} 
```

简单的测试表明它们的输出具有可比性。输出：

```
dGhpcyBpcyBteSB0ZXN0IHN0cmluZw==
dGhpcyBpcyBteSB0ZXN0IHN0cmluZw== 
```

我在调试器中验证了这一点，以防万一我在视觉分析中无法检测到空格并且断言没有命中。它们是相同的。为了确定，我还检查了一段[lorem ipsum 。](http://www.lipsum.com/)

这是[他们的签名生成器的源代码](http://developers.gigya.com/030_Server_SDKs/Java)，没有 Javadoc（作者信用：Raviv Pavel）：

```
public static boolean validateUserSignature(String UID, String timestamp, String secret, String signature) throws InvalidKeyException, UnsupportedEncodingException
{
    String expectedSig = calcSignature("HmacSHA1", timestamp+"_"+UID, Base64.decode(secret)); 
    return expectedSig.equals(signature);   
}

private static String calcSignature(String algorithmName, String text, byte[] key) throws InvalidKeyException, UnsupportedEncodingException  
{
    byte[] textData  = text.getBytes("UTF-8");
    SecretKeySpec signingKey = new SecretKeySpec(key, algorithmName);

    Mac mac;
    try {
        mac = Mac.getInstance(algorithmName);
    } catch (NoSuchAlgorithmException e) {
        return null;
    }

    mac.init(signingKey);
    byte[] rawHmac = mac.doFinal(textData);

    return Base64.encodeToString(rawHmac, false);           
} 
```

根据我在上面所做的一些更改更改您的函数签名并运行此测试用例会导致两个签名都得到正确验证：

```
// Redefined your method signature as: 
//  public static boolean verifyGigyaSig(
//      String uid, String timestamp, String secret, String signature)

public static void main(String[] args) throws 
  IOException,ClassNotFoundException,InvalidKeyException,
  NoSuchAlgorithmException,UnsupportedEncodingException {

    String uid = "10242048";
    String timestamp = "imagine this is a timestamp";
    String secret = "sosecure";

    String signature = calcSignature("HmacSHA1", 
              timestamp+"_"+uid, secret.getBytes());
    boolean yours = verifyGigyaSig(
              uid,timestamp,encodeToString(secret.getBytes(),false),signature);
    boolean theirs = validateUserSignature(
              uid,timestamp,encodeToString(secret.getBytes(),false),signature);
    assert(yours == theirs);
} 
```

当然，正如转载的那样，问题出在 Commons Net 上，而 Commons Codec 似乎没问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-14T20:58:06.867

好吧，我昨天终于从 gigya 那里收到了关于这个问题的回复，事实证明他们自己的服务器端 Java API 公开了一种处理这个用例的方法，[`SigUtils.validateUserSignature`](http://wikifiles.gigya.com/SDKs/Java/doc/com/gigya/socialize/SigUtils.html#validateUserSignature%28java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%29)：

```
if (SigUtils.validateUserSignature(uid, timestamp, secretKey, signature)) { ... } 
```

今天，我能够验证此呼叫的行为是否正确，从而解决了当前的问题，并将整个帖子变成了对我来说的一种面对面的时刻。

**然而：**

我仍然对为什么我自己的自制方法不起作用感兴趣（而且我有赏金要奖励）。下周我将再次检查它，并将其与`SigUtils`类文件进行比较，以尝试找出问题所在。*

# asp.net-mvc-3 - 这可能是一个错误吗？

> ID：10033971
> 
> 赞同：0
> 
> 时间：2012-04-05T18:28:42.377
> 
> 标签：asp.net-mvc-3, visual-studio-2010, entity-framework, unit-testing

我有以下测试用例

```
 [TestMethod()]
    [DeploymentItem("Courses.sdf")]
    public void RemoveCourseConfirmedTest()
    {

        CoursesController_Accessor target = new CoursesController_Accessor();
        int id = 50;

        ActionResult actual;
        CoursesDBContext db = target.db;
        Course courseToDelete = db.Courses.Find(id);

        List<CourseMeet> meets = courseToDelete.meets.ToList<CourseMeet>();

        actual = target.RemoveCourseConfirmed(courseToDelete);
        foreach (var meet in meets)
        {
            Assert.IsNull(db.Meets.find(meet));
        }
        Assert.IsNull(db.Courses.Find(courseToDelete.courseID));

    } 
```

从我的控制器测试以下方法。

```
 [HttpPost, ActionName("RemoveCourse")]
    public ActionResult RemoveCourseConfirmed(Course course)
    {
        try
        {
            db.Entry(course).State = EntityState.Deleted;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        catch (DbUpdateConcurrencyException)
        {
            return RedirectToAction("RemoveMeet", new System.Web.Routing.RouteValueDictionary { { "concurrencyError", true } });
        }
        catch (DataException)
        {
            ModelState.AddModelError(string.Empty, "Unable to save changes. Try again.");
            return View(course);
        }

    } 
```

我知道我应该使用 Mock db .... 但是对于这个项目，我决定采用这种方法。

所以这会发生。当我运行实际的网站时，此功能运行良好，并删除了课程和属于它的所有会议。

但是当我运行测试时，我得到以下异常

```
System.InvalidOperationException: The operation failed: The relationship could not be
changed because one or more of the foreign-key properties is non-nullable. When a change is
made to a relationship, the related foreign-key property is set to a null value. If the
foreign-key does not support null values, a new relationship must be defined, the foreign-
key property must be assigned another non-null value, or the unrelated object must be
deleted. 
```

如果我从测试中注释掉以下行，这是更有趣的部分

```
List<CourseMeet> meets = courseToDelete.meets.ToList<CourseMeet>(); 
```

并用以下内容替换循环：

```
foreach (var meet in db.Meets.ToList())
{
    Assert.IsFalse(meet.courseID == courseToDelete.courseID);
} 
```

我没有得到任何异常并且测试用例通过了。

我是否遗漏了有关实体框架的某些内容，或者这是一个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:54:05.623

好吧，这已经开放了一段时间了。我仍然无法找到明确的答案，但更多地使用 MVC 和 EF 我认为发生的事情是，一旦我执行该行

```
List<CourseMeet> meets = courseToDelete.meets.ToList<CourseMeet>(); 
```

会议被加载到对象管理器中，因此当父对象被删除时，不再有对父课程的引用。

# jakarta-ee - 如何在没有 Java EE 应用服务器的 Java 集群中执行单例

> ID：10033973
> 
> 赞同：2
> 
> 时间：2012-04-05T18:28:48.667
> 
> 标签：jakarta-ee

今天，使用 JPA、Guice、JSR 303 bean 验证构建平台非常快。掀起一些东西是相当容易的。

假设我正在使用 Guice，并且我有一个轮询进程作为 JVM 机器集群中的单例。我怎么能轻易做到

1.  当集群启动（3台机器）时，只有一台启动了单例
2.  当运行单例的机器出现故障时，另一台机器启动了单例

对于今天的图书馆来说，这不会太难，对吧？我看的越多，我认为 jgroups 就是答案，但想听听其他人的意见（Jboss 使用我迄今为止看到的 jgroups）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T13:15:44.010

如果您的应用程序中有一个可用的中央数据库，则可以在数据库表行上使用悲观锁。特定服务器节点上的每个单例都试图在特定表行上获得一个悲观锁（在 Oracle 中由“SELECT FOR UPDATE”获取）。如果单例获得锁，它可以做任何需要的事情。否则它只是等待锁。如果正在工作的单例实例出现故障，另一个等待的单例将获得锁，从而开始工作。您必须注意不要通过提交或回滚来结束事务，以确保只要实例处于活动状态就保持行级锁。

或者，工作单例可以定期保存时间戳，其他等待的单例检查该时间戳是否在特定时间间隔内更新。如果它不再更新，另一个单例可以获得该时间戳的“所有者”并开始自己工作。这种方法不需要专门的数据库连接来持有锁，但是接管到另一个集群成员会更慢，因为必须等待超时。

——罗伯特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:35:42.407

我会选择[hazelcast](/questions/tagged/hazelcast "显示标记为“hazelcast”的问题")和分布式锁定，看看[Hazelcast 和 Singleton](https://groups.google.com/forum/?fromgroups#!topic/hazelcast/TRVPKCfZHNE)。

可能[赤土陶器](/questions/tagged/terracotta "显示标记为“兵马俑”的问题")也可以做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-16T16:17:31.497

正如许多人所建议的那样，您可以使用 JGroups（没有任何 App 服务器）来完成此任务。示例实现可以在[http://speakingjava.blogspot.in/2014/10/how-to-execute-singleton-task-in-cluster.html找到](http://speakingjava.blogspot.in/2014/10/how-to-execute-singleton-task-in-cluster.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T12:46:00.903

我正在研究更多。JBoss 看起来他们使用看起来很简单的 jgroups，这也可能是一种方法。

# c# - ASP.NET 试图查找我拥有的 ID 是否是 CheckBoxList 控件的子控件之一

> ID：10033975
> 
> 赞同：0
> 
> 时间：2012-04-05T18:28:58.707
> 
> 标签：c#, asp.net, asp.net-ajax, controls

我被困在这个问题上，似乎找不到解决办法。我有一个 CheckBoxList 控件。如果您不知道，CheckBoxList 控件上的 FindControl() 方法会返回“this”。微软这样做是因为他们在内部没有创建很多 ListItem 对象，而只是创建了一个。无论如何，我试图找出一个回发控件是否是我的 CheckBoxList 中的控件之一。我的代码看起来类似于：

```
if (!(System.Web.UI.ScriptManager.GetCurrent(Page) == null)) {
string postbackControlId =            System.Web.UI.ScriptManager.GetCurrent(Page).AsyncPostBackSourceElementID;
    if (!string.IsNullOrEmpty(postbackControlId))
    {
       Control control = ControlFinder.RecursiveFindChildControl(Controls, postbackControlId);
       if (!(control == null))
        { }
    }
} 
```

无论如何要枚举 CheckBoxList 的子控件或查找我拥有的 ID 是否等于他们的 ID 之一？

谢谢，迈克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:52:38.037

如果您只是想查明回发是否是由 中的一项引起的`CheckBoxList`，则无需遍历整个控件层次结构。您甚至不需要深入了解列表。这样的事情应该可以正常工作：

```
string elementID = ScriptManager.GetCurrent(Page).AsyncPostBackSourceElementID;
if (elementID.Contains(chkList.UniqueID))
{
    //one of the checkboxes caused the postback
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:52:52.747

`UniqueID`a中的`CheckBox`a`CheckBoxList`是加 a 的`UniqueID`加项的索引，因此您可以检查是否是这样的控件之一：`CheckBoxList``$``postbackControlId``CheckBox`

```
if (postbackControlId.StartsWith(this.checkBoxList.UniqueID + "$"))
{
    int itemIndex = Convert.ToInt32(
        postbackControlId.Substring(this.checkBoxList.UniqueID.Length + 1), 10);
    // ...
} 
```

# redirect - IIS 7.5 URL 重写模块和重定向

> ID：10033979
> 
> 赞同：1
> 
> 时间：2012-04-05T18:29:19.963
> 
> 标签：redirect, iis-7.5, url-rewrite-module

我的公司目前正在着手进行大型网站重定向，我认为这将为我们提供绝佳的机会，使 URL 对用户和谷歌更友好。

为您简要介绍一下情况，我是 SEO 人员，我正在与外部开发人员打交道，以便在不损害 Google 当前排名的情况下重定向网站。我在 sharepoint 方面没有太多经验，因此我非常感谢任何帮助理解和了解我的情况是否可以解决的问题。

该网站使用 IIS7.5，他们最近安装了 URL 重写模块以创建更用户友好的 URL。我的问题是，通过创建一个对用户更友好的 URL，这会导致额外的重定向吗？

例如：如果用户在 www.domain.com 中键入，这将永久（301）重定向到 www.domain.com/pages/home.aspx。开发人员告诉我，为了重写 URL 以显示更友好的内容（例如www.domain.com/home）这将不得不导致另一个永久重定向。因此，本质上该过程将如下所示：

**请求：http://www.domain.com**

**服务器响应：HTTP /1.1 301 重定向**

1）重定向到：http://www.domain.com/pages/home.aspx

**服务器响应：HTTP /1.1 301 重定向**

2) 重定向到：http://www.domain.com/home

**服务器响应：HTTP/1.1 200 OK**

URL 重写模块真的是这样工作的吗？我会认为它不必创建另一个重定向来创建一个对用户更友好的 URL？

我的第二个问题是......重定向发生在同一台服务器上。所以基本上是这样的情况：

www.old-domain.com

www.dev-domain.com

www.new-domain.com

旧域需要重定向到新域，因此我们进行了测试，以便在继续项目之前查看 HTTP 状态代码是否正确。所以开发者将 dev-domain 重定向到 new-domain 并且重定向看起来像这样：（开发者在下面的斜体评论）

**请求：http://www.dev-domain.com**

**服务器响应：HTTP/1.1 301 永久移动**

1）重定向到：http://www.new-domain.com/

**服务器响应：HTTP/1.1 302 重定向**

2）重定向到：http://www.dev-domain.com/Pages/home.aspx

*SharePoint 的备用访问映射会导致这种情况发生，并且无法解决此问题。*

**服务器响应：HTTP/1.1 301 永久移动**

3）重定向到：http://www.dev-domain.com/pages/home.aspx

**服务器响应：HTTP/1.1 301 永久移动**

4) 重定向到：http://www.new-domin.com/pages/home.aspx

**服务器响应：HTTP/1.1 200 OK**

开发人员指出重定向回开发域然后返回新域的原因是因为 SharePoint 的备用访问映射，并且没有办法解决这个问题。这是完全正确的吗？

任何帮助都将不胜感激！

# c# - C#/XNA/HLSL - 深度图搞砸了

> ID：10033983
> 
> 赞同：2
> 
> 时间：2012-04-05T18:29:38.097
> 
> 标签：c#, xna, hlsl

我有一段时间没有意识到这一点，但我的深度图搞砸了。对于：黑色像素 = 近剪裁平面，白色像素 = 远剪裁平面 - 基本上，如果我走向地面上 100x1x100 的正方形，然后走进它（到达 99、0 和 99 的坐标），整个深度图就会转动白色的。这表明每个像素都在远裁剪平面上，这是我不想要的！ [例子](http://i.stack.imgur.com/4toDX.png)

这是处理渲染深度图的代码：

```
GraphicsDevice.Clear(Color.White);
effect.MainEffect.CurrentTechnique = effect.MainEffect.Techniques["DepthProcess"];
GraphicsDevice.SetVertexBuffer(line);
effect.MainEffect.CurrentTechnique.Passes[0].Apply();
GraphicsDevice.DrawPrimitives(PrimitiveType.TriangleStrip, 0, 2); 
```

以及 HLSL 代码（顶点着色器、像素着色器）：

```
DVOut DVShader(VIn _in)
{
    DVOut o;
    o.position = mul(_in.position, WorldViewProjection);
    float a = o.position.z/o.position.w;
    o.color = float4(a,a,a,1);
    return o;
}

float4 DPShader(DVOut _in) : COLOR
{
    return _in.color;
}

technique DepthProcess
{
    pass Pass0
    {
        ZEnable = TRUE;
        ZWriteEnable = TRUE;
        AlphaBlendEnable = FALSE;
        VertexShader = compile vs_2_0 DVShader();
        PixelShader = compile ps_2_0 DPShader();
    }
} 
```

这是因为 1/0 错误吗？或者矩阵乘法有什么问题？还是w/e？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T03:57:22.903

解决了。不知何故，乘法将 W 分量设置为非常小的值。

我没有使用同质除法，而是除以 10，得到了可以接受的结果。

# embedded-linux - 在 Coldfire uCLinux 上调试页面分配失败

> ID：10033984
> 
> 赞同：0
> 
> 时间：2012-04-05T18:29:43.220
> 
> 标签：embedded-linux, uclinux, coldfire

我有时会在我的 Coldfire uCLinux 系统上得到以下崩溃输出。如何找出导致问题的原因？

```
4 月 4 日 10:44:33（无）user.debug 系统日志：启动 NTP
sh：页面分配失败。顺序：8，模式：0xd0
来自 41da5dcc 的堆栈：
        4005b0f2 400553b6 40207431 406131f8 00000008 000000d0 00000008 00000000
        000000a2 000a2000 000a2000 0000000c 40544a14 00000000 405434fc 00000077
        41da5eac 00000000 00000010 00000000 41da5008 41da5000 00000000 00000100
        00000000 41da5000 00000000 000200d0 4024eecc 00000080 00000000 00000000
        4005de52 000000d0 00000008 4024eec8 00000000 00000001 00004d09 00079100
        00000004 00003f20 00013424 41cd7000 41da5fcc 41da5f2a 00015790 00000000
禁用 CONFIG_FRAME_POINTER 的调用跟踪：

 [4005b0f2] [400553b6] [40207431] [4005de52] [40067d64]
 [40093892] [4004b15e] [400390d8] [40020e70] [400677d8]
 [40020e70] [401f0c92] [40068468] [4006aa4e] [40020ea0]
 [4002386c]
内存信息：
每个 CPU 的 DMA：
CPU 0: hi: 0, btch: 1 usd: 0
Active_anon:0 active_file:0 inactive_anon:0
 非活动文件：4484 脏：0 写回：0 不稳定：0
 免费：8806 平板：565 映射：0 页表：0 反弹：0
DMA free:35216kB min:1016kB low:1268kB high:1524kB active_anon:0kB inactive_anon:0kB active_file:0kB inactive_file:17936kB present:65024kB pages_scanned:0 all_unreclaimable？不
lowmem_reserve[]：0 0 0
DMA：0*4kB 0*8kB 1*16kB 4*32kB 6*64kB 3*128kB 46*256kB 44*512kB 0*1024kB 0*2048kB 0*4096kB 0*8192kB 0*16384kB = 35216kB
总共 4484 个页面缓存页面
0 页内存
0 页保留
0 页面共享
0 页非共享
从进程 476 (sh) 分配长度 663552 失败
每个 CPU 的 DMA：
CPU 0: hi: 0, btch: 1 usd: 0
Active_anon:0 active_file:0 inactive_anon:0
 非活动文件：4484 脏：0 写回：0 不稳定：0
 免费：8804 平板：567 映射：0 页表：0 反弹：0
DMA free:35216kB min:1016kB low:1268kB high:1524kB active_anon:0kB inactive_anon:0kB active_file:0kB inactive_file:17936kB present:65024kB pages_scanned:0 all_unreclaimable？不
lowmem_reserve[]：0 0 0
DMA：0*4kB 0*8kB 1*16kB 4*32kB 6*64kB 3*128kB 46*256kB 44*512kB 0*1024kB 0*2048kB 0*4096kB 0*8192kB 0*16384kB = 35216kB
总共 4484 个页面缓存页面
无法为进程文本/数据分配 RAM，errno 12
sh：页面分配失败。顺序：8，模式：0xd0
来自 41ea6dcc 的堆栈：
        4005b0f2 400553b6 40207431 40645848 00000008 000000d0 00000008 00000000
        000000a2 000a2000 000a2000 0000000c 40544a6c 00000000 405434fc 00000077
        41ea6eac 00000000 00000010 00000000 41ea6008 41ea6000 00000000 00000100
        00000000 41ea6000 00000000 000200d0 4024eecc 00000080 00000000 00000000
        4005de52 000000d0 00000008 4024eec8 00000000 00000001 00004d09 00079100
        00000004 00003f20 00013424 410ae600 41ea6fcc 41ea6f2a 00015790 00000000
禁用 CONFIG_FRAME_POINTER 的调用跟踪：

 [4005b0f2] [400553b6] [40207431] [4005de52] [40067d64]
 [40093892] [4004b15e] [400390d8] [40020e70] [400677d8]
 [40020e70] [401f0c92] [40068468] [4006aa4e] [40020ea0]
 [400239c2] [4002386c]
内存信息：

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T19:22:40.783

您的系统已用完 1 MB 可用页面。借助两个分配器的力量，您需要一个大小为 1 MB 的空闲页面来分配 663552 个字节。这是由内存碎片引起的。通常，MMU 会重新组织可用空间，以使其对于新分配看起来是连续的。

您只能通过预防来解决问题。如果 663552 字节是 sh 二进制文件，则必须防止它不断地重新加载到内存中。这可以通过将其放入 XIP 文件系统来完成。

它可能是由 shell 完成的堆分配。在这种情况下，您将不得不更改导致如此大的 malloc 的任何处理。

在系统级别，您还必须查看哪些程序较大或导致较大的 malloc 并更改它们的行为，以便它们不会导致更多碎片。

# java - cookie的设置值

> ID：10033990
> 
> 赞同：0
> 
> 时间：2012-04-05T18:30:08.777
> 
> 标签：java, android, cookies

你能告诉我如何为 cookie 设置值吗？我经常在许多代码中看到它的示例，例如这里：[http](http://www.javadrive.jp/servlet/cookie/index4.html) ://www.javadrive.jp/servlet/cookie/index4.html ，但我不能这样做，因为 setValue(String) 方法未定义键入 Cookie。请告诉我怎么做。

# fortran - 本地化 Fortran 77 中常用块变量的范围

> ID：10033991
> 
> 赞同：0
> 
> 时间：2012-04-05T18:30:08.883
> 
> 标签：fortran, fortran-common-block

我正在使用广泛使用 COMMON BLOCKS 来处理这个 F77 代码，并且这些 COMMON BLOCKS 也用于 C 程序（在名称修改之后）。如果 foo(a, b, ...) 是 fortran 代码的主要例程，那么无论如何都要使 COMMON BLOCKS 成为 foo() 的本地程序，以便我可以执行以下操作？

```
program new_control_routine()

...
call foo(a1,b1,...)
...
call foo(a2,b2,...)
...
end 
```

关键是要多次调用“foo”，每个调用都有*独立*的公共块，即使这些块具有相同的名称。我知道的唯一方法是在“foo”的第二次调用中重命名 COMMON BLOCKS 和相关子例程，使其成为另一个例程“foo1”，所以我可以这样做：

```
programe new_control_routine()
...
call foo(a1,b1,...)
...
call foo1(a2,b2,...) 
```

但这肯定是平凡且容易出错的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:45:53.870

公共块的要点是它们是全局的，任何使用它们名称的例程都可以访问它们。您能否在公共块数组中创建变量并传递索引，以便您的不同调用访问不同的元素？

为什么要限制自己使用 FORTRAN 77？使用 Fortran 95/2003，您可以创建用户定义类型并创建该类型的数组变量。然后传递要处理的元素的索引。用户定义类型可以是一组复杂的变量。该变量可以是子例程的参数或模块变量。

# tfs - TFS 2010 - 路径 E:\SSIS 已映射到工作区 PC-mypc01

> ID：10033992
> 
> 赞同：1
> 
> 时间：2012-04-05T18:30:09.663
> 
> 标签：tfs

我有许多 SSIS 包分布在整个 TFS 中，例如`\Imports\impSSIS01\\`，`\OtherPackages\Exports\expSSIS02\\`等等。每当我打开其中的任何一个时，我都希望工作目录是`E:\SSIS\`，例如`E:\SSIS\impSSIS01\\*.\*`，`E:\SSIS\expSSIS01\\*.\*` 当我尝试像这样设置我的工作区时，我得到了错误：

> 路径`E:\SSIS`已映射到工作区`PC-MYCP01`

我不在乎它是否已经映射。我知道它已经映射了。我**希望**它已经被映射。让我映射一下。

（另外，这是否意味着我的团队中没有其他人可以使用`E:\SSIS\`？我希望不会，这是我们都需要使用的共享驱动器。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:40:31.113

您是否尝试过删除所有映射，然后将 Tfs 集合的根映射到 e:\ssis。这样获取子文件夹的最新信息会将内容提取到相对于 e:\ssis 的文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:00:49.790

下载免费的**[Team Foundation Sidekicks 2010](http://www.attrice.info/cm/tfs/)**。它提供了一种方便的方式来删除和修改工作区。

# php - 访问 JSON 数组值？

> ID：10033994
> 
> 赞同：-1
> 
> 时间：2012-04-05T18:30:16.783
> 
> 标签：php, json, parsing, multidimensional-array, data-access

eSo 我有一些已解析的 php 数据，这些数据从我的数据库中获取，然后使用 json_encode() 解析为 JSON。然后我使用 JSONparse() 来制作我的数组对象。我的代码如下所示：

`$.get("fetchDatabase.php", function(data){
var parsedData = jQuery.parseJSON(data); }`

我剩下的数组 `parsedData` 看起来像这样：

```
[

{"person0":{"name":["Erik Steen"],"age":["1"]}},
{"person1":{"name":["Frida Larsson"],"age":["1"]}},
{"person2":{"name":["Abdi Sabrie"],"age":["2"]}},
{"person3":{"name":["Achraf Malak"],"age":["3"]}},
{"person4":{"name":["Adam Anclair"],"age":["1"]}}

] 
```

我已将这些数组放在一个名为

```
var peopleArray= { people: [ parsedData ] }; 
```

到目前为止，一切都很好。现在我想要的是能够访问某些 people 属性。比如名字或年龄。我如何定位这些属性？我试图在没有运气的情况下打印这些属性。我试过了：

```
alert (peopleArray.people[0].person1.name); 
```

哪个返回：

```
Uncaught TypeError: Cannot read property 'name' of undefined 
```

**如何访问这些属性？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:39:00.283

除了错字（“ `namn`”）之外，问题在于您将数组放入数组中：

```
var peopleArray = { people: [ parsedData ] }; 
```

既然`parsedData`是一个数组，那么你最终得到的是这样的结构：

```
// peopleArray
{ people :  [ [  { "person0" : ... }, ...  ] ]  }
//  oops -----^ 
```

看到问题了吗？由于`parsedData`已经是一个数组，因此正确的代码是：

```
var peopleArray = { people: parsedData }; 
```

# backbone.js - Backbone.js 将模板与 html 文件分开

> ID：10033996
> 
> 赞同：7
> 
> 时间：2012-04-05T18:30:29.863
> 
> 标签：backbone.js, underscore.js

我正在开发一个 Backbone.js 应用程序。我们正在使用 underscore.js 模板将内容加载到视图中。目前我们在 index.html 文件中拥有所有模板，因此文件的大小正在增加。谁能帮我找到将这些模板与其他文件分离的解决方案？提前致谢。

**编辑**

最近我访问了[Backbone 模式](http://ricostacruz.com/backbone-patterns)，发现我们可以使用[JST 模板](http://ricostacruz.com/backbone-patterns/#jst_templates)为每个模板创建单独的模板文件。他们解释说我们可以创建一个`jst.js`文件来放置我们所有的模板代码：

```
// http://myapp.com/javascripts/jst.js
window.JST = {};

window.JST['person/contact'] = _.template(
    "<div class='contact'><%= name %> ..."
);

window.JST['person/edit'] = _.template(
   "<form method='post'><input type..."
);

<script src="http://myapp.com/javascripts/jst.js"></script> 
```

现在所有模板都在`jst.js`文件中。但是，如果您有很多模板并且想要将模板移动到单独的文件中，您可以创建单独的模板文件：

```
// http://myapp.com/javascripts/jst.js
window.JST = {};

//http://myapp.com/javascripts/contactPerson.template.js
window.JST['person/contact'] = _.template(
    "<div class='contact'><%= name %> ..."
);

//http://myapp.com/javascripts/editPerson.template.js
window.JST['person/edit'] = _.template(
   "<form method='post'><input type..."
);

<script src="http://myapp.com/javascripts/jst.js"></script>
<script src="http://myapp.com/javascripts/contactPerson.js"></script>
<script src="http://myapp.com/javascripts/editPerson.js"></script> 
```

请让我知道是否有任何更简单的想法。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-11T11:23:02.850

您可以在单独的 html 文件中拥有模板，并可以使用[requirejs](http://requirejs.org/)将它们作为文本加载。有一个名为[text](https://github.com/requirejs/text)的插件可以帮助您做到这一点。

例子：

```
define([
  'text!templates/sampleTemplate.html'
], function(tmpl){

    var Sampleview = Backbone.View.extend({
      id: 'sample-page',

      template: _.template(tmpl),

      render: function() {
        $(this.el).html(this.template());
        return this;
     }
  });
  return SampleView;
}); 
```

html 文件“templates/sampleTemplate.html”将取自 require.js 配置中指定的根路径

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T00:25:29.350

通过加载它们`xhr`。lib requirejs (requirejs.org) 以这种方式加载 html 文件依赖项。这将在开发中起作用，但模板应在生产中编译到 js 文件中。

# tastypie - 美味的：save_m2m

> ID：10033997
> 
> 赞同：1
> 
> 时间：2012-04-05T18:30:33.767
> 
> 标签：tastypie

我对为什么在美味的资源中需要 save_m2m 的理解尚不清楚。在 POST 中，如果我只发布与创建一个模型相关的数据并且不发送与 m2m 对象相关的任何内容，我还需要执行 save_m2m.xml 吗？为什么需要它？如果我覆盖 save_m2m 什么都不做会发生什么？它似乎工作正常并且我的资源已创建，我不确定这可能会导致任何隐藏的影响。能否请您发表评论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T14:23:27.397

如果您没有标记任何字段，则`is_m2m=True`该方法实际上不会做任何事情。来自 save_m2m 中的 sweetpie 文档字符串：

```
"""
Handles the saving of related M2M data.

Due to the way Django works, the M2M data must be handled after the
main instance, which is why this isn't a part of the main ``save`` bits.

Currently slightly inefficient in that it will clear out the whole
relation and recreate the related data as needed.
""" 
```

在 sweetpie 的资源`save_m2m`方法中检查 is_m2m 设置为 True 的字段，如果没有找到它就什么也不做，所以如果你的资源类没有任何 m2m 并且任何其他资源不会从它继承，你可以覆盖`save_m2m`什么都不做的方法。

你实际上会比美味派领先一个循环（一个小小的加速呜呼！;)）。