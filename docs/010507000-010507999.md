# StackOverflow 问答 10507000-10507999

# ruby-on-rails - Postgresql WITH 语句在 Heroku 上无效

> ID：10507002
> 
> 赞同：0
> 
> 时间：2012-05-08T21:44:04.770
> 
> 标签：ruby-on-rails, postgresql, heroku

我有一个 Rails`find_by_sql`方法可以在本地、控制台和语句中正常工作，也可以直接在 Postgresql 中使用，但是`ActiveRecord::StatementInvalid`当我将它部署到 Heroku 时，该语句会导致错误。

我在本地运行 Postgresql 版本 9.0.3，并在其 Cedar 堆栈上的 Heroku 上使用共享数据库。

我得到的错误是：

```
PG::Error: ERROR: syntax error at or near "WITH normal_items" LINE 1: WITH normal_items AS (SELECT normal_items_month, count(id)... ^ : WITH normal_items AS (SELECT normal_items_month, count(id) as normal_items_total FROM (SELECT date_trunc('month',created_at) as normal_items_month, id from items WHERE items.a_foreign_key_id IS NULL) z group by normal_items_month), special_items AS (SELECT special_items_month, count(id) as special_items_total FROM (SELECT date_trunc('month',created_at) as special_items_month, id from items WHERE items.a_foreign_key_id IS NOT NULL) x group by special_items_month ) SELECT to_char(month, 'fmMon') as month, coalesce(normal_items_total, 0) as normal_items_total, coalesce(special_items_total, 0) as special_items_total FROM (select generate_series(min(normal_items_month), max(normal_items_month), '1 month'::interval) as month FROM normal_items) m LEFT OUTER JOIN normal_items ON normal_items_month = month LEFT OUTER JOIN special_items ON special_items_month = month 
```

为便于阅读，声明如下：

```
WITH normal_items AS (SELECT normal_items_month, count(id) as normal_items_total 
                      FROM (SELECT date_trunc('month',created_at) as normal_items_month, id from items 
                            WHERE items.a_foreign_key_id IS NULL) z 
                      group by normal_items_month), 
    special_items AS (SELECT special_items_month, count(id) as special_items_total 
                      FROM (SELECT date_trunc('month',created_at) as special_items_month, id from items 
                            WHERE items.a_foreign_key_id IS NOT NULL) x 
                      group by special_items_month ) 
SELECT 
to_char(month, 'fmMon') as month, 
coalesce(normal_items_total, 0) as normal_items_total, 
coalesce(special_items_total, 0) as special_items_total 
FROM (select generate_series(min(normal_items_month), max(normal_items_month), '1 month'::interval) as month FROM normal_items) m 
LEFT OUTER JOIN normal_items ON normal_items_month = month 
LEFT OUTER JOIN special_items ON special_items_month = month 
```

这只是为我提供了一些与 Google Charts 一起使用的统计信息，输出为：

```
Jun 178 0
Jul 0   0
Aug 72  0
Sep 189 0
Oct 24  0
Nov 6   0
Dec 578 0
Jan 0   0
Feb 0   0
Mar 89  0
Apr 607 0
May 281 0
Jun 510 0
Jul 190 0
Aug 0   0
Sep 501 0
Oct 409 0
Nov 704 0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T21:56:06.227

Heroku 的共享计划运行`PostgreSQL 8.3`不支持`WITH`关键字（在 中介绍[`PostgreSQL 8.4`](http://www.postgresql.org/about/featurematrix/)）。

如果您升级到 Heroku 的[专用数据库](https://devcenter.heroku.com/articles/heroku-postgresql)包，您将能够使用`PostgreSQL 9.1`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T22:06:25.303

默认的 Heroku 共享数据库是 Postgres 8.3 - 您可以在共享数据库计划的公开测试版中使用 9.1 - 更多详细信息，请访问[https://postgres.heroku.com/blog/past/2012/4/26/heroku_postgres_development_plan/](https://postgres.heroku.com/blog/past/2012/4/26/heroku_postgres_development_plan/)。

对于生产，您可以以每月 50 美元的价格使用新宣布的 Crane 计划[https://postgres.heroku.com/blog/past/2012/4/26/heroku_postgres_development_plan/](https://postgres.heroku.com/blog/past/2012/4/26/heroku_postgres_development_plan/)

# android - 在 SQLiteDatabase.query() 中使用 String[] selectionArgs

> ID：10507005
> 
> 赞同：52
> 
> 时间：2012-05-08T21:44:15.830
> 
> 标签：android, android-sqlite, android-cursor

如何使用`String[] selectionArgs`in `SQLiteDatabase.query()`？我希望我可以将它设置为`null`，因为我没有用它。我只是想将整个未排序的表从数据库加载到`Cursor`. 关于如何实现这一目标的任何建议？

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2012-05-08T22:13:30.097

selectionArgs 替换选择字符串中的任何问号。

例如：

```
String[] args = { "first string", "second@string.com" };
Cursor cursor = db.query("TABLE_NAME", null, "name=? AND email=?", args, null); 
```

至于你的问题 - 你可以使用 null

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-08T21:47:01.963

是的，您可以将除表名之外的所有参数设置为**null 。**

例如：

```
Cursor cursor = db.query("TABLE_NAME", null, null, null, null, null, null); 
```

# javascript - 我可以使用 javascript 或任何其他技术根据用户输入将焦点切换到窗口或选项卡上吗？

> ID：10507008
> 
> 赞同：3
> 
> 时间：2012-05-08T21:44:30.477
> 
> 标签：javascript, browser, tabs, window, onfocus

1.  我有一个显示结果列表的网页。

2.  我单击其中一个结果以查看产品。它会打开一个新窗口/选项卡。

3.  现在我有来自同一网站的 2 个窗口/选项卡，但 1 个显示结果页面，另一个显示产品页面。

4.  在产品页面内，我有一个链接，上面写着“返回列表”

5.  如果我按下它，我可以返回到相同的结果列表。

6.  所以现在我有两个窗口/选项卡显示相同的结果列表。

我有兴趣知道它是否有效的新行为是：

a) 如果我点击产品页面中的返回列表，我可以将焦点切换到显示结果列表的原始窗口/选项卡，而不是我在 5 和 6 中描述的内容吗？

b) 如果对 a 的回答是肯定的，我可以为多个产品窗口做吗？即如果我多次重复步骤2？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T21:51:26.963

你可以做类似的事情：

```
var BackToList = function() {
    window.opener.focus(); // this sets the focus on the window that opened your product
    window.close();  // and this closes the product window
}; 
```

然后你的链接应该调用`BackToList`函数..

如果您的链接是一个简单的`a`标签并且它有一个 id，那么您可以在窗口`load`事件中这样做：

```
document.getElementById("the id goes here").onclick = BackToList; 
```

# python - django 序列化外键对象

> ID：10507011
> 
> 赞同：5
> 
> 时间：2012-05-08T21:44:42.617
> 
> 标签：python, django, django-models, django-serializer

*   [用外键模型序列化 django 模型](https://stackoverflow.com/questions/4015229/serialize-django-model-with-foreign-key-models)
*   [在 Django 中序列化外键对象](https://stackoverflow.com/questions/3753359/serializing-foreign-key-objects-in-django)
*   [在单个查询中获取外键对象 - Django](https://stackoverflow.com/questions/2832997/get-foreign-key-objects-in-a-single-query-django)

已经有几个问题要求同样的事情。但它们是 2010 年的，对我没有太大帮助。所以我认为这可能是自 2010 年以来这方面的一些更新？

在谷歌上我找到了这个[链接](http://mohtasham.info/article/serializing-foreign-key-django-model/)，它解释了[自然键](http://docs.djangoproject.com/en/dev/topics/serialization/#natural-keys)的用法。但是，我担心从中获取异物的问题，`django.contrib.auth.models.User`因此无济于事。

我的问题如下。我想序列化 QuerySet 所以我也得到外键对象，因为我想将它作为 JSON 传递给客户端。来自的序列化`django.core`程序不会这样做。因此，在我的情况下，为了简单地解决问题，我在模型中添加了另一个字段以包含我需要的来自外来对象的值。但是它引入了冗余数据。

我的示例模型包含`username`我希望尽可能删除的模型，而是通过外键获取它。

```
 user = models.ForeignKey(User)
    username = models.CharField(max_length=100, null=False) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T22:08:21.800

一种可能的解决方法是根据查询集的返回构造您自己的字典对象。你会做这样的事情：

```
queryset = Model.objects.all()
list = [] #create list
for row in queryset: #populate list
    list.append({'title':row.title, 'body': row.body, 'name': row.user.username})
recipe_list_json = json.dumps(list) #dump list as JSON
return HttpResponse(recipe_list_json, 'application/javascript') 
```

您需要导入 json 才能使其正常工作。

```
import json 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-29T11:34:39.153

您可以使用 Django REST 框架的[序列化](http://www.django-rest-framework.org/api-guide/serializers.html#modelserializer)程序。

# ruby - 基本帮助：阅读 Ruby 脚本案例语法

> ID：10507020
> 
> 赞同：1
> 
> 时间：2012-05-08T21:45:18.410
> 
> 标签：ruby, switch-statement

我以前从未用 ruby​​ 脚本做过任何事情，并希望这里有人能快速回答。我正在进行一个时间敏感的项目，并希望 SO 可以提供一些见解。

我在这里搜索了一些 ruby​​ 脚本指南，并认为我理解了以下大部分代码，但有些事情我无法弄清楚。

我有以下 ruby​​ 脚本的例外情况，我只需要知道它在做什么：

其中 docName 和 document_name 是文件路径的字符串

```
case docName 
when /^QRX/ then document_name = "/TRPRR/#{docName}"
when /^BVN/ then document_name = "/TRPRR/#{docName}"
.... 
```

还有很多其他案例，我理解案例陈述。我不明白以下内容：

**/^QRX/**是某种正则表达式还是什么？**#{docName}**有什么作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T21:47:44.843

是的`/^QRX/`， 等对 执行正则表达式匹配`docName`，如果匹配，则执行以下代码。

这`#{docName}`是 ruby​​ 处理字符串插值的方式：

```
docName = "foo"
puts "/TRPRR/#{docName}" # Outputs "/TRPRR/foo" 
```

# asp.net - 使用 iTextSharp 生成 QR 条码

> ID：10507028
> 
> 赞同：2
> 
> 时间：2012-05-08T21:46:10.320
> 
> 标签：asp.net, itextsharp, barcode, vb.net-2010

我有一组值说

```
arr(0)="Sam"
arr(1)="1452"
arr(2)="NY" 
```

我想用这些值生成一个二维码。我们正在使用 ITextSharp。任何帮助将不胜感激。我正在使用 vb.net。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T07:26:55.717

以下是一些如何使用 iText 创建条形码的示例：

[http://itextpdf.com/examples/iia.php?id=297](http://itextpdf.com/examples/iia.php?id=297)（最后一个是二维码）

API的数据在这里：

[http://api.itextpdf.com/itext/com/itextpdf/text/pdf/BarcodeQRCode.html](http://api.itextpdf.com/itext/com/itextpdf/text/pdf/BarcodeQRCode.html)

请注意，尽管这些链接引用了 iText 的 Java 版本，但 iTextSharp 中的名称应该非常相似。

# php - 如何为评论投票

> ID：10507033
> 
> 赞同：1
> 
> 时间：2012-05-08T21:46:27.907
> 
> 标签：php, mysql

我正在尝试做一个喜欢按钮（不是 Facebook），只是在我的文章评论中为我的网站添加投票功能。我已将每个赞按钮放置在回显评论的 while 循环中，以便每个赞按钮图像都出现在每个评论框中，这部分是我的代码

```
 if(isset($_SESSION['username'])) { 
 echo"<a href=\"\"><input type=\"image\"name=\"like\"src=\"like.jpeg\"></a>";
    } 
```

我正在尝试使用此代码检查是否单击了按钮，如果是，则应将指定的值插入到喜欢表中。

```
 if(isset($_POST['like'])) {

   $query1   = "INSERT INTO likes (
                likes_id, user_id, 
                comment_id, total_likes)  
                VALUES (NULL,'".$_SESSION['logged_username']."', '".$_SESSION['article_id']."', $page_name+1)";
                mysql_query($query1) or die mysql_error()); 
```

但代码根本不起作用。

没有显示错误，也没有任何内容插入到 likes 表中。

请问我怎样才能使这项工作/问题来自哪里？如果这不可行，什么可能是更好的解决方案？

请原谅我的代码格式，我无意不尊重这个社区。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T21:48:37.730

你有一个不应该有括号的地方：

```
mysql_query($query1));
                    ^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T21:47:54.380

要弄清楚实际错误是什么，请执行此操作。

```
mysql_query($query1) or die(mysql_error()); 
```

# php - 如何使用 $variable 作为已定义常量的名称来访问 php 定义的常量

> ID：10507034
> 
> 赞同：3
> 
> 时间：2012-05-08T21:46:34.040
> 
> 标签：php

我有一个使用 define() 定义的变量 我想将该变量的部分名称存储在一个常规的 php $variable 中，然后通过动态设置名称来访问该定义的变量。IE。：

```
define('xxx_yyy',123);
$a='xxz';
$b='_yyy';

//How to I echo out "123" now?  (without using echo xxx_yyy);
//Something like these (don't work):
echo $a$b;
echo {$a$b}; 
```

我唯一能想到的是：

```
$defined=get_defined_vars();
echo $defined[$a$b]; 
```

但这似乎很笨重

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T21:51:11.863

```
echo constant ( $a . $b ); 
```

是我认为你正在寻找的，因为它是一个常数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T21:49:53.587

您可以使用常量（）。[http://us3.php.net/manual/en/function.constant.php](http://us3.php.net/manual/en/function.constant.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T21:50:29.153

它不是一个变量，它是一个[常数](http://php.net/manual/en/function.constant.php)：

```
echo constant ( $a . $b ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-10T08:58:09.920

正确的函数是**[get_defined_constants()](http://www.php.net/manual/en/function.get-defined-constants.php)**而不是**get_defined_vars()**。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-05-08T21:51:20.253

要使 123 回显，请使用以下命令：

```
echo $a . $b; 
```

此外，define() 使常量不是变量。

# c# - 如何使实体框架不连接表？

> ID：10507035
> 
> 赞同：1
> 
> 时间：2012-05-08T21:46:36.407
> 
> 标签：c#, sql, entity-framework-4

好的，所以我再次测试 EF 的性能，我只想从我的数据库中返回一个简单的结果。

例子

```
var jobsList = from j in mf.Jobs
                       where j.UserID == 1001 select new { Job = j }; 
```

不幸的是，这将我的用户对象加入了这个列表，我不希望 EF 这样做。我如何告诉EF不要仅仅因为有关系而加入。基本上我只想要该表中的一个简单行。

还是我需要使用不同类型的检索。我仍在使用下面的基本类型的数据库检索，我觉得现在有更好的方法来处理数据库工作。

```
SqlConnection myconnection = new SqlConnection(); 
```

**编辑**

基本上我在更清晰的背景下说的话。是不是只得到以下内容。

```
Job.JobID
Job.UserID
//Extra properties 
```

我得到

```
Job.JobID
Job.UserID
Job.User
//Extra properties 
```

该用户对象很容易消耗比需要更多的内存，而且我不需要它。

**我的解决方案**

所以我仍然不太相信EF，这就是原因。我关闭了 LazyLoading 并将其打开，并没有真正注意到那里的性能差异太大。然后，我将我的 SqlConnection 类型方法使用的数据量与我的 EF 方法进行了比较。

我得到了完全相同的结果集，这是性能差异。

对于我的实体框架方法，我会返回一份工作列表。

```
MyDataEntities mf = new MyDataEntities(); // 4MB for the connection...really?
mf.ContextOptions.LazyLoadingEnabled = false;
// 9MB for the list below
var test = from j in mf.Jobs
           where j.UserID == 1031
           select j;
foreach (Job job in test) {
     Console.WriteLine(job.JobID);
} 
```

对于执行存储过程并返回结果集的我的 SqlConnection 方法。

```
//356 KB for the connection and the EXACT same list.
List<MyCustomDataSource.Jobs> myJobs = MyCustomDataSource.Jobs.GetJobs(1031); 
```

我完全理解 Entity Framework 比标准的 SqlConnection 做得更多，但是如果它要为结果集占用至少 25 倍的内存，为什么还要大肆宣传。只是似乎不值得。

毕竟，我的解决方案是不使用 EF。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:09:38.583

该`User`属性是作业类的一部分，但在您访问它之前不会被加载（延迟加载）。所以它实际上并没有“加入”。

如果您只想要两个指定的列，您可以编写

```
var jobsList = from j in mf.Jobs
               where j.UserID == 1001 
               select new { 
                          Job.JobID, 
                          Job.UserID 
                          }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:11:50.733

此行为最可能的原因是您将[`LazyLoadingEnabled`属性](https://www.deveducate.com/blog/post/2010/11/11/Is-Lazy-Loading-in-EF-4-Evil-or-the-Second-Coming.aspx)设置为 true。

如果是这种情况，则不会在原始查询中恢复用户。但是，如果您尝试访问此属性，即使您在调试时通过检查进行访问，它也会从数据库中加载。但前提是您尝试访问它。

您可以检查这个打开一个 SQL Server Profiler，并查看哪些命令开始发送到数据库。

您的代码没有使用急切加载或显式加载。所以这一定是原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:34:10.347

实体框架[不](https://stackoverflow.com/questions/3274241/entity-framework-4-selective-lazy-loading-properties)支持[延迟加载**属性**](http://ayende.com/blog/4377/nhibernate-new-feature-lazy-properties)。但是，它具有[表格拆分功能](http://weblogs.asp.net/manavi/archive/2011/04/24/associations-in-ef-4-1-code-first-part-4-table-splitting.aspx)

强调属性。当然，Entity Framework 支持延迟加载行

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T22:17:27.390

在您访问 Job 的 User 属性之前，用户实际上并未附加到上下文。如果您想为用户获取空值，请关闭延迟加载。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T21:57:02.110

我认为 EF 不知道您只想要一个结果。尝试这样的事情。

```
Job jobsItem = mf.Jobs.Single(j=>j.UserID==1001) 
```

如果你不想使用lambas...

```
Job JobItem = (from j in mf.Jobs where j.UserID == 1001 select j).Single() 
```

我现在附近没有编译器，我希望语法是正确的。如果您愿意，可以使用`var`代替`Job`您的变量。它没有效果，但我认为`Job`在这种情况下更具可读性。

# java - 为什么我的线程程序只使用一个 CPU？

> ID：10507041
> 
> 赞同：6
> 
> 时间：2012-05-08T21:47:10.400
> 
> 标签：java, multithreading, cpu

我有一个执行长时间计算的程序，所以我想加快它的性能。所以我现在尝试启动 3 个线程，但`java.exe`仍然占用了 25% 的 CPU 使用率（因此，只使用了一个 CPU），即使我尝试使用并设置实时`.setPriority(Thread.MAX_PRIORITY);`优先级（24），它仍然存在。`java.exe`我尝试使用`RealtimeThread`，但似乎它的工作速度更慢。如果每个线程都分配给一个处理器，并且总CPU使用率增加到75％，那将是完美的，但我不知道该怎么做。这就是我的代码现在的样子：

```
Thread g1 = new MyThread(i,j);
g1.setPriority(Thread.MAX_PRIORITY);
g1.run();
Thread g2 = new MyThread(j,i);
g2.setPriority(Thread.MAX_PRIORITY);
g2.run();
Thread g3 = new MyThread(i,j);
g3.setPriority(Thread.MAX_PRIORITY);
g3.run();
if (g1.isAlive()) {
        g1.join();
}
if (g2.isAlive()) {
        g2.join();
}
if (g3.isAlive()) {
        g3.join();
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-08T21:48:47.013

您实际上并没有使用线程。

你需要打电话`.start()`，不是`.run()`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-08T21:49:35.390

这与 CPU 无关——您实际上并没有启动 3 个线程，而是在主线程上运行所有内容。要启动一个线程，调用它的`start()`方法，而不是`run()`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-08T21:53:33.710

首先，正如其他人所建议的那样，您并没有真正使用多个线程。这是因为您正在调用 run() 方法，该方法最终在调用线程中完成工作。

现在，为了解决您的其余问题，我认为这是指如何最大限度地提高多线程进程的效率。这不是一个简单的问题，但我会给你一些基础知识。（其他人，请随意插话。）

最大限度地提高进程效率的最佳方法是尝试使所有线程执行大致相同的工作量，并尽量防止它们阻塞。也就是说，“平衡”工作负载以使应用程序高效运行是您的工作。

通常，您不能分配线程在特定的 CPU 内核上运行；这通常是操作系统和 CPU 本身的工作。操作系统调度进程（使用您提供的优先级），然后 CPU 可以在指令级别进行自己的调度。除了设置优先级之外，其余的调度完全不受您的控制。

编辑：我沉迷于分号。

# css - Magento 中的当前/活动导航链接状态

> ID：10507043
> 
> 赞同：0
> 
> 时间：2012-05-08T21:47:13.333
> 
> 标签：css, magento, navigation

我为我的 Magento 网站构建了自定义导航，现在我正忙于如何添加：

```
class="current" 
```

到用户当前正在查看的列表项。谢谢，-山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T18:42:38.067

我不完全清楚您在寻找什么 - 但如果您的意思是您已将 CMS 页面添加到标准菜单（这是一个常见要求），那么您可以测试您正在使用的 cms 页面

```
Mage::getSingleton('cms/page')->getIdentifier(); 
```

菜单通常被调用`catalog/navigation/top.phtml`，这是添加额外静态链接的好地方。

如果这不是你的意思，你能提供更多细节吗？包括您尝试过的内容/您正在使用的自定义代码。

# ios5 - iOS 5 屏幕上对象的位置

> ID：10507044
> 
> 赞同：1
> 
> 时间：2012-05-08T21:47:14.973
> 
> 标签：ios5, uiimageview, nsuserdefaults

我正在创建一个测试应用程序，它将添加多个带有图像的 UIImageViews。用户将能够移动和旋转这些图像。我有 UIGestureRecognizers 并正在工作，但我还需要跟踪用户在屏幕上留下图像的位置。这样，如果他们关闭应用程序并返回，他们放置图像的位置就会被记住。

我知道我应该为此使用 NSUserDefaults，但我的问题是如何跟踪可能大量 UIImageView 在屏幕上的位置。我假设我需要以某种方式获取它们的 x/y 坐标并将其存储在 NSUserDefaults 中。

有人对如何做到这一点有建议吗？

-布赖恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T16:25:14.023

UIView 有一个属性子视图。我建议遍历数组。这是一个例子：

```
NSMutableDictionary *coordinates = [[NSMutableDictionary alloc] init];
for (id subview in view.subviews) {
    if ([subview isKindOfClass:[UIImageView class]]) {
        [coordinates setObject:[NSValue valueWithPoint:subview.frame.origin] forKey:imageViewIdentifier];
    }
}
//store coordinates in NSUserDefaults
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
[userDefaults setObject:coordinates forKey:@"ImageViewCoordinates"];
[userDefaults synchronize]; 
```

您可以使用一些标识符来节省内存，而不是将整个图像视图存储为坐标字典中的键。该对象是一个 NSValue，因此要从中获取 x/y 值，您可以使用`[[value pointValue] x]`或`[[value pointValue] y]`。

这是一个读回数据（并将视图恢复正常）的示例。

```
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
NSDictionary *coordinates = [userDefaults dictionaryForKey:@"ImageViewCoordinates"];
//Key can be any type you want
for (NSString *key in coordinates.allKeys) {
    UIImageView *imageView;
    //Set UIImageView properties based on the identifier
    imageView.frame.origin = [coordinates objectForKey:key];
    [self.view addSubview:imageView];
    //Add gesture recognizers, and whatever else you want
} 
```

# maven - 部署到 Fuse ESB 时的 Spring 版本不兼容 (ServiceMix 4.4.1-fuse-03-06)

> ID：10507046
> 
> 赞同：0
> 
> 时间：2012-05-08T21:47:27.157
> 
> 标签：maven, osgi, apache-servicemix

我的问题是如何强制捆绑使用与它一起打包的 Spring 版本而不是 ESB 上安装的版本？

我有一个简单的 Webservices WAR，我正在尝试在 Fuse ESB 中安装和启动它。WAR 依赖于 Spring 3.0.6，我在 ESB 中安装了 Spring 3.0.5 功能。安装并尝试启动捆绑包后，我收到以下错误。

**22:24:43,869 | 错误 | l 控制台线程 | RegisterWebAppVisitorWC | 163 - org.ops4j.pax.web.pax-web-extender-war - 1.0.3 | 注册异常。跳过。org.springframework.beans.factory.parsing.BeanDefinitionParsingException：配置问题：无法从 URL 位置导入 bean 定义 [classpath:META-INF/spring/app-context.xml] 违规资源：ServletContext 资源 [/WEB-INF/cxf -servlet.xml]；嵌套异常是 org.springframework.beans.factory.BeanDefinitionStoreException：从类路径资源 [META-INF/spring/app-context.xml] 解析 XML 文档时出现意外异常；嵌套异常是 org.springframework.beans.FatalBeanException：命名空间 [http://www.springframework.org/schema/jdbc] 的类 [org.springframework.jdbc.config.JdbcNamespaceHandler] 没有实现 [org.springframework.beans .**

这表明正在使用意外版本的 Spring。我可以看到 3.0.6 在 Bundle-Classpath 上。我原以为捆绑应该只使用捆绑 lib 文件夹中的 Spring 版本。

我也有这个 pom 配置，以便在将 WAR 部署到 ServiceMix 时将 Maven 依赖项包含在类路径中。

```
 <plugin>
                <artifactId>maven-war-plugin</artifactId>
                <configuration>
                    <archive>
                        <manifest>
                            <addClasspath>true</addClasspath>
                            <classpathPrefix>lib/</classpathPrefix>
                            <classpathLayoutType>repository</classpathLayoutType>
                        </manifest>
                    </archive>
                    <webXml>src/main/webapp/WEB-INF/web.xml</webXml>
                    <webResources>
                        <resource>
                            <directory>src/main/resources</directory>
                            <targetPath>WEB-INF</targetPath>
                            <includes>
                                <include>**.*</include>
                            </includes>
                        </resource>
                    </webResources>
                </configuration>
            </plugin> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T09:56:15.443

包类路径由来自 的 Import-Packages 定义`MANIFEST.MF`，而不是 /lib 文件夹。您可能需要配置[Maven-Bundle-Plugin](http://felix.apache.org/site/apache-felix-maven-bundle-plugin-bnd.html)以使用 Spring 3.0.6。

# metadata - 从 DOI 获取元数据

> ID：10507049
> 
> 赞同：41
> 
> 时间：2012-05-08T21:47:37.403
> 
> 标签：metadata, bibtex, doi

数字[对象标识符](https://en.wikipedia.org/wiki/Digital_object_identifier)(DOI) 是一个全球唯一的字符串，用于标识电子文档（例如，学术文章的 PDF）。它本质上提供了一种创建文档永久链接的方法（例如，[http://dx.doi.org/10.1145/146585.146609](http://dx.doi.org/10.1145/146585.146609)）。

是否有 Web 服务（或任何其他系统）可以从给定 DOI 获取文档的元数据（最好是 BibTeX 形式）？

*编辑添加一些说明性信息。*

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2016-10-28T18:22:42.587

[DOI 手册文档的第 5.4.1 节内容协商](http://www.doi.org/doi_handbook/5_Applications.html)指出，“DOI 注册机构正在为其 DOI 名称实施内容协商，特别是为用户提供增值元数据表示。” 根据[http://crosscite.org](http://crosscite.org)的 DOI 内容协商文档的[第 4 节支持的内容类型](http://citation.crosscite.org/docs.html#sec-4)，“目前三个 DOI 注册机构已经为其 DOI 实施了内容协商：CrossRef、DataCite 和 mEDRA。” 支持的格式列表（取决于注册机构）包括 BibTeX via （这是[http://doi2bib.org](http://doi2bib.org)使用的方法）和格式化的书目条目 via （这是[@anumi 建议的方法](https://stackoverflow.com/a/34202810/108197)`Accept: application/x-bibtex``Accept: text/bibliography`以上）。使用后一种标头时，必须指定`style=bibtex`媒体类型参数。

两种相关的 mimetype 提供了稍微不同的表示。一个请求`GET http://dx.doi.org/10.1038/nrd842`产生`Accept: application/x-bibtex`响应

```
@article{Atkins_2002,
    doi = {10.1038/nrd842},
    url = {http://dx.doi.org/10.1038/nrd842},
    year = 2002,
    month = {jul},
    publisher = {Springer Nature},
    volume = {1},
    number = {7},
    pages = {491--492},
    author = {Joshua H. Atkins and Leland J. Gershell},
    title = {From the analyst{\textquotesingle}s couch: Selective anticancer drugs},
    journal = {Nature Reviews Drug Discovery}
} 
```

与`Accept: text/bibliography; style=bibtex`

```
@article{Atkins_2002, title={From the analyst’s couch: Selective anticancer drugs}, volume={1}, ISSN={1474-1784}, url={http://dx.doi.org/10.1038/nrd842}, DOI={10.1038/nrd842}, number={7}, journal={Nature Reviews Drug Discovery}, publisher={Springer Nature}, author={Atkins, Joshua H. and Gershell, Leland J.}, year={2002}, month={Jul}, pages={491–492}} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-12-10T13:11:46.490

`curl -LH "Accept: text/bibliography; style=bibtex" http://dx.doi.org/10.1038/nrd842`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-10-28T06:51:52.640

看看这些人是如何实现它的：www.doi2bib.org。

我在我的一个项目中做了什么：

*   查看了他们的`url`请求结构：`http://www.doi2bib.org/doi2bib`++ 。`?id=``{your doi here}`
*   然后使用他们的...很好`API`地获取数据（例如[http://www.doi2bib.org/doi2bib?id=10.1016%2Fj.actpsy.2016.09.007](http://www.doi2bib.org/doi2bib?id=10.1016%2Fj.actpsy.2016.09.007)）并且响应是：
    *   `@article{Leinen_2016, doi = {10.1016/j.actpsy.2016.09.007}, url = {http://dx.doi.org/10.1016/j.actpsy.2016.09.007}, year = 2016, month = {nov}, publisher = {Elsevier {BV}}, volume = {171}, pages = {36--46}, author = {Peter Leinen and Stefan Panzer and Charles H. Shea}, title = {Hemispheric asymmetries of a motor memory in a recognition test after learning a movement sequence}, journal = {Acta Psychologica} }`
*   然后你可以按照你想要的方式解析它。

这帮助我完成了我需要做的事情。但是，最好的方法是查看他们的[GitHub](https://github.com/davidagraf/doi2bib)存储库并尝试构建自己的存储库。

希望能帮助到你！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-06-24T00:52:34.707

CrossRef[有一个 API](http://search.crossref.org/help/api)，您可以使用 API 密钥，该密钥可以从[http://www.crossref.org/requestaccount/](http://www.crossref.org/requestaccount/)免费获得。

# android - 过渡效果和意图

> ID：10507057
> 
> 赞同：2
> 
> 时间：2012-05-08T21:47:55.830
> 
> 标签：android, android-layout, android-intent

不太清楚如何解释它，所以显示一些代码肯定会对我有所帮助。

```
Intent i = new Intent(Main.this, screen1.class);
    i.putExtra("uid", username);
    i.putExtra("pwd", password);
    startActivity(i);

    /** Fading Transition Effect */
    overridePendingTransition(R.anim.fadein, R.anim.fadeout); 
```

我想开始另一个活动，同时有意地传递一些字符串。我的问题是 overridePendingTransition 不工作我相信是因为意图。

我知道我什么时候这样做：

```
 startActivity(new Intent(Main.this,
            screen1.class));
       Main.this.finish();

    /** Fading Transition Effect */
    overridePendingTransition(R.anim.fadein, R.anim.fadeout); 
```

overridePendingTransition 工作得很好。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T22:22:04.440

尝试

```
Intent i = new Intent(Main.this, screen1.class);
i.putExtra("uid", username);
i.putExtra("pwd", password);
startActivity(i);

/** Fading Transition Effect */
Main.this.overridePendingTransition(R.anim.fadein, R.anim.fadeout); 
```

# node.js - 服务器端包含在 expressjs 中

> ID：10507059
> 
> 赞同：2
> 
> 时间：2012-05-08T21:48:03.510
> 
> 标签：node.js, express

是否可以使用 express.js 生成服务器端包含？

我正在尝试在不同页面上重用我的页眉和页脚标记，以便我可以在一个地方进行页眉/页脚更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T22:04:52.173

尝试使用部分。您必须在一些模板引擎之间进行选择。默认模板引擎是jade，因此您必须执行以下操作：创建文件views/header.jade 并将您的东西放入。在您的操作中，您可以使用`partial('header');`

有关更多信息，请参阅[expressjs 文档](http://expressjs.com/guide.html#view-partials)。

# asp.net - Word 超链接未打开 asp.net 文件

> ID：10507062
> 
> 赞同：0
> 
> 时间：2012-05-08T21:48:29.823
> 
> 标签：asp.net, html, ms-word

我有一些需要超链接的 Word 文件。超链接转到带有锚点的 htm 文件，但出于安全原因，该 htm 文件不是通过直接 url 提供的。相反，它链接到 ashx 处理程序文件，该文件检索文件并执行 response.write 以在浏览器中显示 html 文件。但是，在它执行此操作之前，它会检查以确保存在有效的会话，如果没有，则它只是重定向到登录页面。这在从 ASP.Net 站点中链接时工作正常，但是当我从本地 MSWord 文件链接到它时，它显然不知道有一个有效的会话（即使我已经在浏览器中登录），并重定向到登录页面。有没有办法解决？不幸的是，为了兼容性，这些 Word 文档需要采用 Word 97-2003 格式...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:36:02.820

不，这行不通。

在浏览器之外打开 word 文件并单击链接将开始一个全新的会话；无论您当前是否在网站上打开了浏览器窗口。

因为新会话正在启动，所以 Web 服务器将假定您根本没有登录。从技术上讲，你不是。

# c - 无法找到 Segfault 原因

> ID：10507073
> 
> 赞同：2
> 
> 时间：2012-05-08T21:49:13.350
> 
> 标签：c, segmentation-fault

该程序应该根据传递给它的参数创建 x 数量的线程。argv[1] 是 main 应该休眠的数量，argv[2] 是 proprocer 线程的数量，而 argv[3] 是消费者线程的数量。该程序编译良好，我用来运行它的命令是：**program 10 1 1**。

我已经盯着这段代码一段时间了，我似乎无法找到导致分段错误的原因。说不定第二双眼睛就能很快的把它挑出来。

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <semaphore.h>
#include <pthread.h>
#include "buffer.h"

void *producer(void *);
void *consumer(void *);

// Semaphores
sem_t empty;
sem_t full;
pthread_mutex_t mutex;

// Buffer
int placed = 0;
buffer_item buffer[BUFFER_SIZE];
int insert_item(buffer_item item){
    /* INSERT ITEM INTO BUFFER */
    int z;
    sem_wait(&empty);

    //mutex lock
    z = pthread_mutex_lock(&mutex);
    if (z != 0){
        return -1;
    }
    buffer[placed] = item;

    //mutex unlock
    z = pthread_mutex_unlock(&mutex);
    if (z != 0){
        return -1;
    }

       sem_post(&full);
    placed++;
    printf("producer produced %d\n", item);
}

int remove_item(buffer_item *item){
    /* REMOVE ITEM FROM BUFFER */
    int m;
    placed--;
    sem_wait(&full);

    //mutex lock
    m = pthread_mutex_lock(&mutex);
    if (m != 0){
        return -1;
    }
       buffer[placed] = -1;

    //mutex unlock
    m = pthread_mutex_unlock(&mutex);
    if (m != 0){
        return -1;
    }

       sem_post(&empty);
    printf("consumer consumed %d\n", rand);
    return 0;
}

// Main

int main(int argc, char *argv[]){
    int sleepNum, pThreadNum, cThreadNum, p;
    sleepNum = atoi(argv[1]);
    pThreadNum = atoi(argv[2]);
    cThreadNum = atoi(argv[3]);

    // Initialize Semaphores & mutex
    sem_init(&empty, 0, BUFFER_SIZE);
    sem_init(&full, 0, 0);
    pthread_mutex_init(&mutex, NULL);

    // Create producer thread
    pthread_t tid[pThreadNum];

    int g=pThreadNum-1;
    while(g >= 0){
        p = pthread_create(&tid[g], NULL, producer, NULL);
        g--;
    }
    printf("created prod thread");
    // Create consumer thread
    pthread_t kid[cThreadNum];
    g = cThreadNum-1;
    while(g >= 0){
        p = pthread_create(&kid[g], NULL, consumer, NULL);
        g--;
    }

    // Sleep for argv[0]
    sleep(sleepNum);

    // Destroy mutex & semaphores
        sem_destroy(&empty);
        sem_destroy(&full);
        p = pthread_mutex_destroy(&mutex);

    // Exit
    exit(0);
}

// Producer
void *producer(void *param){
    buffer_item rand;
    unsigned int *seed;
    int b;
    while(1){
        sleep(2);
        rand = rand_r(seed);
        b = insert_item(rand);
        if (b < 0){
            printf("Error producing item.");
        }
    }
}

// Consumer
void *consumer(void *param){
    buffer_item rand;
    int d;
    while(1){
        sleep(2);
        d = remove_item(&rand);
        if (d < 0){
            printf("Error removing item");
        }
    }
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:58:27.223

在 Unix 上，您可以通过转储核心并检查 gdb 中的核心文件来从分段错误中获取回溯。

```
$ ulimit -c <max core file size in 1k blocks>
$ gdb program core
gdb> bt 
```

应该转储回溯，您可以准确地看到哪一行出现了段错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:09:31.043

在生产者中，您使用的是未初始化的指针。尝试使用 malloc 为其分配一些内存。我没有确切解释它是什么，因为您将其标记为作业。

也不要依赖 printf 语句的输出来告诉你程序在使用线程时到达了哪里。如果您在每个 printf 之后显式刷新输出流，这会有所帮助，那么您几乎会了解正确的事件序列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:33:10.983

用-g编译你的程序，`gcc -g program.c -lpthread` 然后 `gdb a.out` 设置断点为 `b main` `start` ，然后`s`用于逐步执行，看看它在哪里下降。

正如有人已经提到您的生产者函数具有未初始化的指针`unsigned int *seed;`

这个程序也[失去了与之相关的唤醒问题](http://askldjd.wordpress.com/2010/04/24/the-lost-wakeup-problem/)，以及正常的解锁问题（如函数插入项，如果在执行之前插入项线程上下文切换怎么办`placed++`。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-19T19:55:08.270

这是一篇很棒的文章，用于查找段错误的原因。

[关联](http://software.intel.com/en-us/articles/determining-root-cause-of-sigsegv-or-sigbus-errors)

[链接镜像在这里，以防万一它发生故障......你永远不知道。](http://compsci.dalton.org/~nostrer/segfault.html)

# regex - Perl 模式匹配，我们打印所有匹配的部分，但只打印匹配的部分（而不是其余部分）

> ID：10507076
> 
> 赞同：2
> 
> 时间：2012-05-08T21:49:34.163
> 
> 标签：regex, perl, sed, grep, pattern-matching

我正在寻找在 Perl 中执行此操作的解决方案。

示例：如果我的字符串是：

```
my $content = 'toto /app/blah titi\nhuh/app/ttt wew'; 
```

我的模式是：`/app/something`我想在数组中作为输出：`/app/blah`和`/app/ttt`.

（这基本上是什么`grep -E -o '\/app\/[a-z]*'`）

我不能让它工作！我试过：

```
my $content = 'toto /app/blah titi\nhuh/app/ttt wew';
$content =~ m/(\/app\/[a-z]*)/;
print "Group: $1 $2\n"; 
```

但这只会打印：（`/app/blah`不是`/app/ttt`）

无论如何，我不知道如何将结果放在表格中：

```
my (@table) = @_; 
```

该表不包含任何内容！

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T22:03:29.973

您想使用[`/g`](http://search.cpan.org/perldoc?perlretut#Global_matching)修饰符使正则表达式将所有匹配项作为列表返回：

```
@table = $content =~ m/(\/app\/[a-z]*)/g;
print "Group: @table\n"; 
```

此外，[`@_`](http://search.cpan.org/perldoc?perlvar#@ARG)与正则表达式没有任何关系。相反，它是传递给当前子例程的参数列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-05T11:42:15.343

我正在为一些快速的 bash 脚本编写一个内衬，其中 Perl 将扮演一个角色，这对我有用：

```
$ echo foo000bar000baz | perl -ne 'for(m/(foo)|(baz)/g){ if ($_ ne "") { print "$_\n"}}'            
foo
baz 
```

也适用于多行

```
$ echo 'foo
> 123
> bar
> 456
> baz ' | perl -ne 'for(m/(foo)|(baz)/g){ if ($_ ne "") { print "$_\n"}}'
foo
baz 
```

解释（原谅并纠正我的错误，因为我不是 Perl 的高级水平）：

`STDIN`piped to `perl`: 可以是任何东西，比如`cat $file`

1.  `m/Regular Expression within parenthesis indicating capture group/g`
2.  `for loop`从上面的比赛中制作
3.  打印`if`匹配不`""`（空）

# jquery - 在 beforeSend 上停止 $.ajax

> ID：10507079
> 
> 赞同：47
> 
> 时间：2012-05-08T21:49:44.890
> 
> 标签：jquery, ajax

我有这个 jQuery ajax 调用：

```
$.ajax({
    url : 'my_action',
    dataType: 'script',
    beforeSend : function(){
        if(1 == 1) //just an example
        {
            return false
        }
    },
    complete: function(){
        console.log('DONE');
    }
}); 
```

`beforeSend`如果条件返回`true`但返回 false 不会停止 ajax 调用，我想停止ajax 调用。

我怎样才能`stop`在 ajax 上调用`beforeSend`？

======= 更新 =========

`return false`也可以。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-05-08T21:53:13.123

```
$.ajax({
    url : 'my_action',
    dataType: 'script',
    beforeSend : function(xhr, opts){
        if(1 == 1) //just an example
        {
            xhr.abort();
        }
    },
    complete: function(){
        console.log('DONE');
    }
}); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-08T21:53:45.393

大多数 jQuery Ajax 方法返回一个 XMLHttpRequest（或等效的）对象，因此您可以只使用 abort()。

```
var test = $.ajax({
    url : 'my_action',
    dataType: 'script',
    beforeSend : function(){
        if(1 == 1) //just an example
        {
            test.abort();
            return false
        }
    },
    complete: function(){
        console.log('DONE');
    }
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-08T21:54:32.240

```
beforeSend:function(jqXHR,setting)
{
    // if(setting.url != "your url") jqXHR.abort();
    if(1 == 1) //just an example
    {
        jqXHR.abort();
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-07-07T19:20:58.613

`xhr.done()`; 这对我有用

```
$.ajax({
    url : 'my_action',
    dataType: 'script',
    beforeSend : function(xhr){
        if(1 == 1) //just an example
        {
            return false
        };
        xhr.done(); //this works for me
    },
    complete: function(){
        console.log('DONE');
    }
}); 
```

[http://api.jquery.com/jquery.ajax/](http://api.jquery.com/jquery.ajax/)

```
jqXHR.done(function( data, textStatus, jqXHR ) {}); 
```

成功回调选项的替代构造，请参阅`deferred.done()`实现细节。

# python - “Bad marshal data”Django 开发服务器错误

> ID：10507080
> 
> 赞同：6
> 
> 时间：2012-05-08T21:49:51.830
> 
> 标签：python, django

将数据插入我的 MySQL 数据库时出现此错误

```
ValueError at /admin/arbkdb/arbkcompany/
bad marshal data (unknown type code)
Request Method: GET
Request URL:    http://[2001:6f8:1c00:18b::2]:9000/admin/arbkdb/arbkcompany/
Django Version: 1.3
Exception Type: ValueError
Exception Value:    
bad marshal data (unknown type code)
Exception Location: /usr/lib/python2.7/dist-packages/simplejson/__init__.py in <module>, line 111
Python Executable:  /usr/bin/python
Python Version: 2.7.2
Python Path:    
['/home/ardian/.experiments/arbk',
 '/usr/lib/python2.7',
 '/usr/lib/python2.7/plat-linux2',
 '/usr/lib/python2.7/lib-tk',
 '/usr/lib/python2.7/lib-old',
 '/usr/lib/python2.7/lib-dynload',
 '/usr/local/lib/python2.7/dist-packages',
 '/usr/lib/python2.7/dist-packages',
 '/usr/lib/python2.7/dist-packages/PIL',
 '/usr/lib/python2.7/dist-packages/gst-0.10',
 '/usr/lib/python2.7/dist-packages/gtk-2.0',
 '/usr/lib/pymodules/python2.7',
 '/usr/lib/python2.7/dist-packages/ubuntu-sso-client',
 '/usr/lib/python2.7/dist-packages/ubuntuone-client',
 '/usr/lib/python2.7/dist-packages/ubuntuone-control-panel',
 '/usr/lib/python2.7/dist-packages/ubuntuone-couch',
 '/usr/lib/python2.7/dist-packages/ubuntuone-installer',
 '/usr/lib/python2.7/dist-packages/ubuntuone-storage-protocol']
Server time:    Tue, 8 May 2012 16:15:19 -050 
```

# 追溯

```
Environment:

Request Method: GET
Request URL: http://[2001:6f8:1c00:18b::2]:9000/admin/arbkdb/arbkcompany/

Django Version: 1.3
Python Version: 2.7.2
Installed Applications:
['admin_tools',
 'admin_tools.theming',
 'admin_tools.menu',
 'admin_tools.dashboard',
 'django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'arbkdb',
 'south',
 'django.contrib.admin']
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/usr/lib/pymodules/python2.7/django/core/handlers/base.py" in get_response
  89\.                     response = middleware_method(request)
File "/usr/lib/pymodules/python2.7/django/contrib/messages/middleware.py" in process_request
  11\.         request._messages = default_storage(request)
File "/usr/lib/pymodules/python2.7/django/contrib/messages/storage/__init__.py" in <lambda>
  31\. default_storage = lambda request: get_storage(settings.MESSAGE_STORAGE)(request)
File "/usr/lib/pymodules/python2.7/django/contrib/messages/storage/__init__.py" in get_storage
  17\.         mod = import_module(module)
File "/usr/lib/pymodules/python2.7/django/utils/importlib.py" in import_module
  35\.     __import__(name)
File "/usr/lib/pymodules/python2.7/django/contrib/messages/storage/user_messages.py" in <module>
  8\. from django.contrib.messages.storage.fallback import FallbackStorage
File "/usr/lib/pymodules/python2.7/django/contrib/messages/storage/fallback.py" in <module>
  2\. from django.contrib.messages.storage.cookie import CookieStorage
File "/usr/lib/pymodules/python2.7/django/contrib/messages/storage/cookie.py" in <module>
  5\. from django.utils import simplejson as json
File "/usr/lib/pymodules/python2.7/django/utils/simplejson/__init__.py" in <module>
  111\.     import simplejson
File "/usr/lib/python2.7/dist-packages/simplejson/__init__.py" in <module>
  111\. from decoder import JSONDecoder, JSONDecodeError

Exception Type: ValueError at /admin/arbkdb/arbkcompany/
Exception Value: bad marshal data (unknown type code) 
```

附言。我不知道如何描述为什么会出现这个错误，因为它是在插入大量数据时出现的，我不知道为什么

这是我的模型数据 [https://github.com/ardian/arbk/blob/master/arbkdb/models.py](https://github.com/ardian/arbk/blob/master/arbkdb/models.py)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T12:21:55.470

看起来不是数据库问题，而是文件损坏消息。删除 *.pyc 和 *.pyo 文件可以解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T09:32:15.997

通常内存中的操作崩溃会给你这种值错误，错误的编组错误。当电源出现故障并且 appengine 配置文件损坏时，就会发生这种情况。

对我来说，这个问题很常见，我只是直接卸载（删除）并重新安装appengine并重新开始工作。***删除 .pyc 文件有时不起作用。***

# asp.net-mvc-3 - 即使关闭了自动完成功能，Firefox 也会缓存隐藏的输入

> ID：10507088
> 
> 赞同：4
> 
> 时间：2012-05-08T21:50:59.447
> 
> 标签：asp.net-mvc-3, html, caching, autocomplete, hidden-field

我有一个`autocomplete`属性设置为`off`.

在这个表单中，有一个隐藏的输入元素（使用 ASP.NET MVC 的`Html.HiddenFor()`方法生成，但这应该无关紧要）：

```
<input type="hidden" value="0" name="Status" id="Status" data-val-required="The Status field is required." data-val-number="The field Status must be a number." data-val="true"> 
```

当表单提交时，这个值加一并且模型返回给视图。如果我将状态值写入页面，我可以看到该值已正确递增。

但是，这个隐藏的输入字段总是被缓存。它永远不会得到正确的值。我尝试`autocomplete`直接在输入元素上设置属性，但没有成功。

如何获取此隐藏字段以获取正确的值？我宁愿不使用任何 Javascript。

**编辑**：提供更多代码...

控制器

```
//This code is being executed, and the status is being incremented.
shippingOrder.Status = (shippingOrder.Status != (int)OrderStatus.Closed) ? shippingOrder.Status + 1 : shippingOrder.Status; 
```

看法

```
@using (Html.BeginForm("Number", "Order", FormMethod.Post, new { id = "orderSummary", autocomplete = "off" })) {
    ...
    @Html.HiddenFor(m => m.Status)
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:02:11.567

根据[这里](https://stackoverflow.com/questions/4837744/hiddenfor-not-getting-correct-value-from-view-model)的这篇文章， html帮助器`HiddenFor`总是首先使用发布的值，然后是模型中的值。

正如您所说，将值写入页面时，您可以看到它增加了，但助手正在使用先前发布的值，这是预期的行为。

该链接确实建议使用`ModelState.Remove("Status")`或`ModelState.Clear()`在分配新值之前。

它还建议另一种选择可能是不使用`HiddenFor`助手，而是自己构建隐藏字段。与此类似：

`<input type="hidden" name="Status" value="@Model.Status" />`

无论哪种方式，您的问题看起来都是基于类似的情况。

# database - 有没有办法从 Lift 中的 DB 模式生成模型代码？

> ID：10507089
> 
> 赞同：2
> 
> 时间：2012-05-08T21:51:09.053
> 
> 标签：database, scala, model, lift

所有书籍、示例和教程都告诉人们如何从 Scala Lift 实现中的模型代码生成模式。有什么办法可以代替吗？

有没有办法从 Lift 中的 DB 模式生成模型代码？我正在将 RoR Web 应用程序迁移到 Lift。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:52:25.813

可悲的是，我认为不是。[有人谈论为](https://stackoverflow.com/a/9526237/115478)[Squeryl](http://squeryl.org/)做这样的事情（您可以使用 lift-squeryl-record 来使用它），但我认为它从未发生过。

# c# - ASMX Web 服务 - SoapHttpClientProtocol.InvokeAsync

> ID：10507096
> 
> 赞同：1
> 
> 时间：2012-05-08T21:51:37.237
> 
> 标签：c#, wpf, web-services, asynchronous, asmx

我有一个将 XML 数据异步上传到 Web 服务的 WPF 应用程序。我从非 UI 线程调用 Web 服务：

```
Task.Factory.StartNew(() => {
  WebServiceHelper.ImportMarketDataAsync(....);
}); 
```

我已经使用 wsdl.exe 生成了代理。代理类提供了两种不同的方式来异步调用 Web 服务函数：

1) *方法名*异步

2) 开始*方法名* & 结束*方法名*

第一种方法使用 SoapHttpClientProtocol.InvokeAsync，第二种方法使用 SoapHttpClientProtocol.BeginInvoke。

在任何一种情况下，当代理点击调用函数（即 InvokeAsync 或 BeginInvoke）时，都会从 UI 线程内调用 Web 服务调用，因此由于 UI 线程很忙，因此应用程序似乎没有响应。如果我在 foreach 循环中为一组 250 个元素的集合调用异步函数，UI 将冻结，直到所有异步调用完成。

有没有办法在不阻塞主 UI 线程的情况下调用 asmx Web 服务？

先谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:53:43.710

当应用程序附加到 VS2010 进行调试时，UI 会冻结。当我自己运行应用程序时，应用程序并没有冻结。与调试器有关。

# javascript - 什么是与 JavaScript/HTML/jQuery 相关的“.el”？

> ID：10507100
> 
> 赞同：17
> 
> 时间：2012-05-08T21:51:52.587
> 
> 标签：javascript, jquery, html

我从谷歌搜索中找不到很多东西，但我可能在谷歌搜索错误的术语。

我试图从这里了解“$.el”中的“el”是什么：http: [//joestelmach.github.com/laconic/](http://joestelmach.github.com/laconic/)

```
$.el.table(
  $.el.tr(
    $.el.th('first name'),
    $.el.th('last name')),
  $.el.tr(
    $.el.td('Joe'),
    $.el.td('Stelmach'))
).appendTo(document.body); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-08T21:54:21.470

`el`只是一个标识符，它指的是一个元素，一个 DOM 元素，这是该库中的一个约定。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-08T22:00:49.867

您可以在github中查看项目的[源代码获得解释：](https://github.com/joestelmach/laconic/blob/master/laconic.js)

```
// If we're in a CommonJS environment, we export our laconic methods
  if(typeof module !== 'undefined' && module.exports) {
    module.exports = laconic;
  } 

  // otherwise, we attach them to the top level $.el namespace
  else {
    var dollar = context.$ || {};
    dollar.el = laconic;
    context.$ = dollar;
  } 
```

该代码意味着 $.el 命名空间将具有该函数`laconic()`，并且该函数使用创建元素`document.createElement`并将其附加到主体。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T01:46:57.363

`el`是一个放置在`$`对象上的函数，可以调用它来生成 DOM 元素：

```
$.el('table') 
```

`el`还充当其他对象的占位符，例如`table`函数：

```
$.el.table() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-08T21:53:53.723

它创建一个元素树并将它们附加到 body

# python - 如何对csv表中的数据进行行到列的转置？

> ID：10507104
> 
> 赞同：29
> 
> 时间：2012-05-08T21:52:21.400
> 
> 标签：python, csv

我是脚本新手。我有一个表 ( `Table1.txt`)，我需要创建另一个表，其中 Table1 的行按列排列，反之亦然。我找到了 Perl 和 SQL 的解决方案，但 Python 没有。

我两天前刚开始学习Python，所以就我所知：

```
import csv
import sys

with open(sys.argv[1], "rt") as inputfile:
   readinput = csv.reader(inputfile, delimiter='\t')
   with open("output.csv", 'wt') as outputfile:
      writer = csv.writer(outputfile, delimiter="\t")
      for row in readinput:
            values = [row[0], row[1], row[2], row[3]]
            writer.writerow([values]) 
```

这只是将列复制为列。我现在想做的是把最后一行写成，`writer.writecol([values])`但似乎没有这样的命令，而且我还没有找到另一种将行写成列的方法。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-08T22:44:38.420

@Ashwini 的答案是完美的。魔法发生在

```
zip(*lis) 
```

让我解释一下为什么会这样： zip 需要（在最简单的情况下）两个列表并“压缩”它们：`zip([1,2,3], [4,5,6])`将变为`[(1,4), (2,5), (3,6)]`. 因此，如果您将外部列表视为矩阵，而将内部元组视为行，那就是转置（即，我们将行转换为列）。

现在，`zip`是一个任意数量的函数，因此它可以接受两个以上的参数：

```
# Our matrix is:
# 1 2 3
# 4 5 6
# 7 8 9

zip([1,2,3], [4,5,6], [7,8,9])

>>> [(1, 4, 7), (2, 5, 8), (3, 6, 9)]

# Now it is
# 1 4 7
# 2 5 8
# 3 6 9 
```

我们面临的问题是，在您的情况下，我们不知道要传递给`zip`. 但至少，我们已经知道这些论点：它们是`lis`! `lis`是一个列表，并且该列表的每个元素也是一个列表（对应于输入文件中的一行数字）。这`*`只是 Python 告诉函数的方式*“请使用后面的任何元素作为参数，而不是事物本身！”*

所以

```
lis = [[1,2,3], [4,5,6]]
zip(*lis) 
```

完全一样

```
zip([1,2,3], [4,5,6]) 
```

恭喜，现在你是 Python 专家了！;-)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-05-08T22:01:28.613

通常转置一系列可迭代对象的解决方案是： zip(*original_list)

样本输入：

```
1   2   3   4   5
6   7   8   9   10
11  12  13  14  15 
```

**程序：**

```
with open('in.txt') as f:
  lis = [x.split() for x in f]

for x in zip(*lis):
  for y in x:
    print(y+'\t', end='')
  print('\n') 
```

**输出：**

```
1   6   11  

2   7   12  

3   8   13  

4   9   14  

5   10  15 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-05-08T22:56:43.207

既然我们在谈论列、行和转置，也许值得一提`numpy`

```
>>> import numpy as np
>>> x = np.array([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
>>> x
array([[ 1,  2,  3],
       [ 4,  5,  6],
       [ 7,  8,  9],
       [10, 11, 12]])
>>> x.T
array([[ 1,  4,  7, 10],
       [ 2,  5,  8, 11],
       [ 3,  6,  9, 12]]) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-09T09:10:32.080

只是为了构建@Akavall 答案，如果您想从文件中读取，转置然后再次保存，只需执行以下操作：

```
from numpy import genfromtxt, savetxt
data = genfromtxt('in.txt')
savetxt('out.txt',data.T) 
```

`data.T`第三行是数据被转置的地方。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T21:59:32.683

这是一种方法，为简单起见，假设您只想按顺序打印出对象：

```
 # lets read all the data into a big 2d array
  buffer = []
  for row in readinput: 
        values = [row[0], row[1], row[2], row[3]]  
        buffer.append(values)       

  # what you have in your code
  for i in range(len(buffer)):
      for j in range(len(buffer[0])):
          print buffer[i][j]

  # this is called a transpose; we have buffer[i][j] to read row then column, 
  #    switch i and j around to do the opposite
  for i in range(len(buffer[0])):
      for j in range(len(buffer)):
          print buffer[j][i] 
```

由于您需要一个数组传递给`writer.writerow`，您可以这样做

```
 for i in range(len(buffer[0])):
      writer.writerow([buffer[j][i] for j in range(len(buffer))]) 
```

# android - android：在特定时间做某事

> ID：10507111
> 
> 赞同：0
> 
> 时间：2012-05-08T21:52:47.413
> 
> 标签：android, scheduling

我读过几乎所有在 Stackoverflow 和其他地方有相同问题的文章，但那些让我感到困惑。

我的问题：例如，我希望我的应用程序在特定时间向用户敬酒（例如闹钟应用程序在特定时间响起），我希望我的应用程序在 2 天和 10 小时后显示敬酒。但是，在此期间，每件事都可能发生，例如应用程序关闭，手机将重新启动或等等......并且应用程序没有显示任何内容。

我的问题是：如何在 android App 中的特定时间做某事？

那么现在有什么解决办法呢？任何人都可以帮助我并给我一个示例代码吗？提前谢谢你，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T21:55:24.713

你想要的是一个[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)

您还可以在[此处找到教程。](http://justcallmebrian.com/?p=129) 如果您要安排一个精确的时间，您可能想要保守一点，早点起床，然后使用 Timer 安排敬酒以进行更精细的控制。

# google-apps-script - 用于置换列、行或任何范围的脚本

> ID：10507118
> 
> 赞同：1
> 
> 时间：2012-05-08T21:53:09.943
> 
> 标签：google-apps-script

**编辑：**我更改了代码以包括按名称提供范围的可能性（以 A1 表示法），因为这可能比提供`Range`对象更有效（如果范围最终没有移动）并且在简单的情况下肯定更容易使用。AdamL 的想法（见下面的答案）。

* * *

在某些电子表格中，我需要置换行或列。要求用户手动执行此操作不是很好。因此，在菜单中制作可以运行脚本的正确命令似乎是一个合理的解决方案。

奇怪的是，我找不到任何可以置换行/列的函数（无论是内置的还是由其他人编写的）。所以我自己写了一个，然后考虑出版。但由于我对 JavaScript 和 Google Apps Script 的经验很少，我想让其他人检查这个功能。我也有一些问题。所以我们开始吧。

* * *

```
// Parameters:
// - ranges An Array with ranges which contents are to be permuted.
//          All the ranges must have the same size. They do not have to be
//          vectors (rows or columns) and can be of any size. They may come from
//          different sheets.
//          Every element of the array must be either a Range object or a string
//          naming the range in A1 notation (with or without sheet name).
// - permutation An Array with 0-based indexes determining desired permutation
//               of the ranges. i-th element of this array says to which range
//               should the contents of i-th range be moved.
// - temp A range of the same size as the ranges in "ranges". It is used to
//        temporarily store some ranges while permuting them. Thus the initial
//        contents of this range will be overwritten and its contents on exit is
//        unspecified. Yet if there is nothing to be moved ("ranges" has less
//        than 2 elements or all ranges are already on their proper places) this
//        range will not be used at all.
//        It is advised to make this range hidden so the "garbage" doesn't
//        bother user.
//        This can be either a Range object or a string naming the range in A1
//        notation (with or without sheet name) - just as with the "ranges".
// - sheet An optional Sheet object used to resolve range names without sheet
//         name. If none is provided active sheet is used. Note however that it
//         may cause issues if user changes the active sheet while the script is
//         running. Thus if you specify ranges by name without sheet names you
//         should provide this argument.
//
// Return Value:
// None.
//
// This function aims at minimizing moves of the ranges. It does at most n+m
// moves where n is the number of permuted ranges while m is the number of
// cycles within the permutation. For n > 0 m is at least 1 and at most n. Yet
// trivial 1-element cycles are handled without any moving (as there is nothing
// to be moved) so m is at most floor(n/2).
//
// For example to shift columns A, B and C by 1 in a cycle (with a temp in
// column D) do following:
//
// permuteRanges(
//   ["A1:A", "B1:B", "C1:C"],
//   [1, 2, 0],
//   "D1:D",
//   SpreadsheetApp.getActiveSheet()
// );
function permuteRanges(ranges, permutation, temp, sheet) {
  // indexes[i] says which range (index of ranges element) should be moved to
  // i-th position.
  var indexes = new Array(permutation.length);
  for(var i = 0; i < permutation.length; ++i)
    indexes[permutation[i]] = i;

  // Generating the above array is linear in time and requires creation of a
  // separate array.

  // Yet this allows us to save on moving ranges by moving most of them to their
  // final location with only one operation. (We need only one additional move
  // to a temporary location per each non-trivial cycle.)

  // Range extraction infrastructure.

  // This is used to store reference sheet once it will be needed (if it will be
  // needed). The reference sheet is used to resolve ranges provided by string
  // rather than by Range object.
  var realSheet;
  // This is used to store Range objects extracted from "ranges" on
  // corresponding indexes. It is also used to store Range object corresponding
  // to "temp" (on string index named "temp").
  var realRanges;

  // Auxiliary function which for given index obtains a Range object
  // corresponding to ranges[index] (or to temp if index is "temp").
  // This allows us to be more flexible with what can be provided as a range. So
  // we accept both direct Range objects and strings which are interpreted as
  // range names in A1 notation (for the Sheet.getRange function).
  function getRealRange(index) {
    // If realRanges wasn't yet created (this must be the first call to this
    // function then) create it.
    if(!realRanges) {
      realRanges = new Array(ranges.length);
    }

    // If we haven't yet obtained the Range do it now.
    if(!realRanges[index]) {
      var range;

      // Obtain provided range depending on whether index is "temp" or an index.
      var providedRange;
      if(index === "temp") {
        providedRange = temp;
      } else {
        providedRange = ranges[index];
      }

      // If corresponding "ranges" element is a string we have to obtain the
      // range from a Sheet...
      if(typeof providedRange === "string") {
        // ...so we have to first get the Sheet itself...
        if(!realSheet) {
          // ...if none was provided by the caller get currently active one. Yet
          // note that we do this only once.
          if(!sheet) {
            realSheet = SpreadsheetApp.getActiveSheet();
          } else {
            realSheet = sheet;
          }
        }
        range = realSheet.getRange(providedRange);
      } else {
        // But if the corresponding "ranges" element is not a string then assume
        // it is a Range object and use it directly.
        range = providedRange;
      }

      // Store the Range for future use. Each range is used twice (first as a
      // source and then as a target) except the temp range which is used twice
      // per cycle.
      realRanges[index] = range;
    }

    // We already have the expected Range so just return it.
    return realRanges[index];
  }

  // Now finally move the ranges.

  for(var i = 0; i < ranges.length; ++i) {
    // If the range is already on its place (because it was from the start or we
    // already moved it in some previous cycle) then don't do anything.
    // Checking this should save us a lot trouble since after all we are moving
    // ranges in a spreadsheet, not just swapping integers.
    if(indexes[i] == i) {
      continue;
    }

    // Now we will deal with (non-trivial) cycle of which the first element is
    // i-th. We will move the i-th range to temp. Then we will move the range
    // which must go on the (now empty) i-th position. And iterate the process
    // until we reach end of the cycle by getting to position on which the i-th
    // range (now in temp) should be moved.
    // Each time we move a range we mark it in indexes (by writing n on n-th
    // index) so that if the outer for loop reaches that index it will not do
    // anything more with it.

    getRealRange(i).moveTo(getRealRange("temp"));

    var j = i;
    while(indexes[j] != i) {
      getRealRange(indexes[j]).moveTo(getRealRange(j));

      // Swap index[j] and j itself.
      var old = indexes[j];
      indexes[j] = j;
      j = old;
    }

    getRealRange("temp").moveTo(getRealRange(j));
    // No need to swap since j will not be used anymore. Just write to indexes.
    indexes[j] = j;
  }
} 
```

* * *

问题是：

1.  这是否正确实施？可以改进吗？

2.  参数验证怎么样？我应该这样做吗？如果它们无效，我该怎么办？

3.  我不确定是否使用`copyTo`或`moveTo`。我决定了，`moveTo`因为在我看来，我打算做的事情更多。但现在转念一想，我认为这可能`copyTo`会更有效率。

4.  我还注意到，`Range`移动的并不总是被清除。特别是在调试器中。

5.  撤消/重做似乎是此功能的一个问题。似乎每个`moveTo`都是电子表格上的单独操作（甚至更糟，但也许这只是我测试时谷歌文档的低响应性）并且撤消排列不是一个单一的操作。有什么可以做的吗？

6.  我为该函数编写的文档声称它适用于*不同的工作表甚至不同的电子表格*。我实际上并没有检查过；) 但 Google Apps 脚本文档似乎并没有否认它。它会那样工作吗？

* * *

*我不确定这是否是提出此类问题的合适场所（因为这不是一个真正的问题），但由于[Google Apps 脚本社区支持正在转移到 Stack Overflow](https://groups.google.com/a/googleproductforums.com/forum/#!topic/apps-script/mZEVqsmTqrQ)，我不知道还能去哪里问。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T14:24:25.360

您不认为在执行速度方面使用数组可能更有效吗？

试试这个例如：（我在各处添加了日志以显示发生了什么）（另请注意，工作表限制为 255 列......注意列表长度）

```
function permutation() {
var sh = SpreadsheetApp.getActiveSheet();
var ss = SpreadsheetApp.getActiveSpreadsheet();
var lr = ss.getLastRow()
var lc=ss.getLastColumn();
var data = sh.getRange(1,1,lr,lc).getValues()
Logger.log(data)

var temp2= new Array();
var h=data.length
Logger.log(h)
var w=data[0].length
Logger.log(w)
for(nn=0;nn<w;++nn){
var temp1= new Array();
for (tt=0;tt<h;++tt){
  temp1.push(data[tt][nn])
  }
  temp2.push(temp1)
  }
Logger.log(temp2) 
Logger.log(temp2.length) 
Logger.log(temp2[0].length) 
sh.getRange(1,1,lr,lc).clear()
sh.getRange(1,1,lc,lr).setValues(temp2)
} 
```

最好的问候， 塞尔吉

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T02:43:30.170

Adam，根据我在 Apps Script GPF 方面的有限经验，我了解到最好尽可能限制 get 和 set 调用（您也可以在其中包括 moveTo/copyTo）。

您是否认为将范围名称而不是范围作为参数传递会更好（为此，您可能还需要一种机制来传递工作表名称和电子表格键，以支持您跨不同工作表工作的要求/spreadsheets），然后可以避免琐碎的“getRange”以及琐碎的“moveTo”。

此外，如果您只是传输值，最好不要将其移动到临时范围，而是将这些数组分配给脚本中的变量，然后可以稍后在正确的位置“设置”。但是，如果您需要复制格式或公式，那就另当别论了。

# java - 如何添加设置 for 循环中的 List 的值？

> ID：10507123
> 
> 赞同：-5
> 
> 时间：2012-05-08T21:53:29.480
> 
> 标签：java

我想迭代`accountset` `List<AccountTO>`和设置的值`AccountID`。

实际上，`accountset`我正在获取值：`100,101,102`我想将值添加到`List<AccounTO>`并设置它们`AccountID`并将其传递给服务调用。有什么我可以去的或任何其他程序。

```
for(String s :group.getAccounts().keySet())
{
    System.out.println("===="+s.lastIndexOf("-"));
    System.out.println("sub"+s.substring(0,s.lastIndexOf("-")));
    accountSet.add(s.substring(0, s.lastIndexOf("-")));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:11:25.457

如果我正确理解了这个问题，它应该相当简单：

```
List<AssetAllocationTO> someList = new ArrayList<AssetAllocationTO>();

for (String string : group.getAccounts().keySet()){
            AssetAllocationTO al = new AssetAllocationTO();
            al.setAccountID(string);
            someList.add(al);
} 
```

# c++ - 重构代码以使用 Boost 共享指针

> ID：10507125
> 
> 赞同：4
> 
> 时间：2012-05-08T21:53:37.633
> 
> 标签：c++, refactoring, shared-ptr, smart-pointers

我使用普通指针编写了一个项目，现在我厌倦了手动内存管理。

在重构过程中可以预见到哪些问题？

到现在为止，我已经花了一个小时来替换`X*`我`shared_ptr<X>`想要自动管理内存的类型。然后我`dynamic_cast`改为`dynamic_pointer_cast`. 我仍然看到更多错误（与`NULL`传递`this`给函数相比）。

我知道这个问题有点模糊和主观，但我认为我可以从已经这样做的人的经验中受益。

有没有一些陷阱？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:00:15.437

尽管在任何地方都可以轻松使用`boost::shared_pointer`，但您应该根据所有权语义使用正确的智能指针。

在大多数情况下，您将希望`std::unique_ptr`默认使用，除非所有权在多个对象实例之间共享。

如果您遇到周期性所有权问题，您可以使用`boost::weak_ptr`.

还要记住，在传递 shared_ptr 时，出于性能原因（避免原子增量），您应该始终通过 const 引用传递它们，除非您真的想将所有权授予不同的实体。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T23:32:59.000

> 有没有一些陷阱？

是的，根据墨菲定律，如果你**盲目地**用 shared_ptr 替换每个指针，结果会证明这不是你想要的，你将在接下来的 6 个月里寻找你引入的错误。

> 在重构过程中可以预见到哪些问题？

内存管理效率低下，未使用的资源存储时间过长，内存泄漏（循环引用），无效引用计数（相同的指针分配给多个不同的 shared_pointers）。

不要盲目地用 shared_ptr 替换所有内容。仔细研究程序结构并确保 shread_ptr 是必需的，它代表了你想要的。

此外，**请确保您使用**支持简单分支（git 或 mercurial）的版本控制，因此当您破坏某些内容时，您可以恢复到以前的状态或运行类似于“git bisect”的内容来定位问题。

> 显然你需要用 shared_ptr 替换 X*

错误的。这取决于上下文。如果您有一个指向某个数组中间的指针（例如，像素数据操作），那么您将无法用 shared_ptr 替换它（并且您不需要）。只有在需要确保对象的自动释放时才需要使用 shared_ptr。对象的自动释放并不总是您想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-09T04:27:28.690

如果你想坚持使用 boost，你应该考虑是需要 boost::shared_ptr 还是 boost::scoped_ptr。shared_ptr 是类之间共享的资源，而 scoped_ptr 听起来更像您可能想要的（至少在某些地方）。scoped_ptr 超出范围时会自动删除内存。

将 shared_ptr 传递给函数时要小心。shared_ptr 的一般规则是按值传递，以便创建副本。如果你通过引用传递它，那么指针的引用计数将不会增加。在这种情况下，您最终可能会删除一段您希望保持活动状态的内存。

但是，在某些情况下，您可能希望通过引用传递 shared_ptr。也就是说，如果您希望在不同的函数中分配内存。在这种情况下，只需确保调用者在它调用的函数的生命周期内仍然持有指针。

```
void allocPtr( boost::shared_ptr< int >& ptrByRef )
{
    ptrByRef.reset( new int );
    *ptrByRef = 3;
}

int main()
{
    boost::shared_ptr< int >& myPointer;
    // I want a function to alloc the memory for this pointer.

    allocPtr( myPointer ); // I must be careful that I still hold the pointer
                           // when the function terminates

    std::cout << *ptrByRef << std::endl;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-09T23:24:22.370

我列出了所涉及的步骤/问题。他们为我工作，但我不能保证他们是 100% 正确的

0) 检查是否有循环共享指针。如果是这样，这会导致内存泄漏吗？我的情况，幸运的是，循环不需要被打破，因为如果我有一个循环，循环中的对象是有用的，不应该被破坏。使用弱指针打破循环

1）您需要将“大多数”替换`X*`为`shared_ptr<X>`. shared_ptr （仅？）在每次动态分配 X 后立即创建。在所有其他时间，它是复制构造的，或者是用空指针构造的（以发出 NULL 信号）。为了安全起见（但效率有点低），请仅通过引用传递这些 shared_ptrs 。无论如何，您可能从未通过引用传递您的指针以开始 => 不需要额外的更改

2）您可能`dynamic_cast<X*>(y)`在某些地方使用过。将其替换为 `dynamic_pointer_cast<X>(y)`

3）无论你通过哪里`NULL`（例如，表示计算失败），传递一个空的共享指针。

4) 删除相关类型的所有删除语句

5）让你的基类 B 继承自`enable_shared_from_this<B>`. 然后无论你经过`this`，通过，`shared_from_this()`。如果函数需要派生类型，您可能必须进行静态转换。请记住，当您调用时`shared_from_this()`，一些`shared_ptr`必须已经拥有`this`。特别是，不要调用`shared_from_this()`类的构造函数

我确信可以半自动化这个过程以获得语义上等效但不一定非常有效的代码。程序员可能只需要推理循环引用（如果有的话）。

我在许多这些步骤中使用了很多正则表达式。大约花了3-4个小时。到目前为止，代码已编译并正确执行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-06T03:51:41.903

有一个工具可以尝试自动转换为智能指针。我从来没有尝试过。这是以下论文摘要的引述： [http ://www.cs.rutgers.edu/~santosh.nagarakatte/papers/ironclad-oopsla2013.pdf](http://www.cs.rutgers.edu/~santosh.nagarakatte/papers/ironclad-oopsla2013.pdf)

> 为了强制执行难以静态检查的安全属性，Ironclad C++ 通过模板化的“智能指针”类应用动态检查。使用半自动重构工具，我们已将近 50K 行代码移植到 Ironclad C++

# php - FB PHP SDK 的 getAccessToken() 是检索用户身份验证令牌的可靠方法吗？

> ID：10507128
> 
> 赞同：0
> 
> 时间：2012-05-08T21:53:50.823
> 
> 标签：php, javascript, session, facebook-php-sdk, facebook-oauth

所以我有一个 FB 应用程序，在某些情况下，我需要我的 Javascript 使用与 index.php 位于同一域中的 php 文件将内容加载到 div 中。对于其中一些，我想确保用户仍然有效和/或需要身份验证令牌和 FB 用户 ID。我通过在 php 文件中创建一个 FB PHP SDK 的实例来实现这一点，该文件由 javascript 注入 ajax 并使用 getUser() 和 getAccessToken()。但是，我注意到，有时 getAccessToken() 调用会莫名其妙地失败并报告它需要一个有效的访问令牌才能执行该操作。

getAccessToken() 是确保用户登录到 FB 的可靠（甚至是理想）方式还是我应该做其他事情（例如，将我从签名请求中解析的访问令牌存储在 Javscript 中并将其作为变量传递给 php我正在注入的文件）？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:03:00.720

最可靠的可能是获取他们的详细信息。过去，我有一个“getUser”实例返回 true，但用户实际上并没有登录。所以现在我也得到了他们所有的细节，这更可靠：

```
$facebook = new Facebook(array(
                            'appId' => FB_APP_ID,
                            'secret' => FB_APP_SECRET,
                            'cookie' => true
                    ));
$FB_UID=false;
try {
    $FB_UID = $facebook->getUser();
    // This verifies the user is actually logged in. teh above can return "true" but the following will crap out and throw exception
    $FB_me = $facebook->api('/me');  // 'birthday'
    // Not needed:
    // $FB_token = $facebook->getAccessToken();

} catch (FacebookApiException $e) {
    $FB_UID = false;
    $FB_me = false;
    // $FB_token = false;
} 
```

# php - 使用 Mootools 从选择器框中的“单击”事件触发 JSON 请求

> ID：10507129
> 
> 赞同：0
> 
> 时间：2012-05-08T21:53:50.910
> 
> 标签：php, javascript, ajax, events, mootools

当我使用 mootools 从 HTML 选择器框中选择一个选项时，我试图触发异步 JSON 请求。

我有以下表单元素：

```
<form method="post" id="sel">
 <select id = "_selecor_id" size=3>
   <option value = "value_a" id = "option_a">OptionA</option>
   <option value = "value_b" id = "option_b">OptionB</option>
 </select>
<p id="response"></p>
</form> 
```

我正在使用以下 javascriipt/mootools 发送带有表单信息的 JSON 请求

```
window.addEvent('domready', function()
{

$('_selecor_id').addEvent('click', function(){

    new Request.JSON({
    url: "my_php_script.php",
    onSuccess: function(response)
    {
      $('response').set('html', response.params)
    }
  }).get($('sel'));
})
}); 
```

到以下 php 脚本

```
$result['params'] = $_GET;
echo json_encode($result); 
```

但是，我在 Chrome 的开发人员工具中被告知“无法读取 null 的属性“参数””，我不明白为什么这里的请求应该为“null”。任何想法将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:32:47.837

嘿，伙计，您的问题的答案在于问题本身。

当您单击选择时触发事件，就像您说“选择一个选项”一样

单击选择将是错误的，但是在选择中单击一个选项，您要查找的是 onChange 事件，代码如下：

**HTML**

```
// Notice no form tag needed unless you are serializing other items
<select id = "_selecor_id" size=3>
    <option value = "value_a" id = "option_a">OptionA</option>
    <option value = "value_b" id = "option_b">OptionB</option>
</select>
<p id="response"></p> 
```

**JAVASCRIPT**

```
window.addEvent('domready', function(){
    $('_selecor_id').addEvent('change', function(){
        new Request.JSON({ // This must return a valid json object
            url: "my_php_script.php",
            data: {
                'value': this.get('value')
            }
            onSuccess: function(responseJSON, responseText){
                $('response').set('html',responseJSON.params);
            }
        }).send();
    })
}); 
```

**PHP**

```
$result['params'] = isset($_GET['value']) ? $_GET['value'] : 'Not Set';
echo json_encode($result); 
```

responseJson 变量现在将包含类似 {"params":"value_b"}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:33:46.870

试试这个代码：

```
window.addEvent('domready', function(){
    $('_selecor_id').addEvent('click', function(){
        new Request.JSON({
            url: "my_php_script.php",
            onSuccess: function(response){
                $('response').set('html',(response || this.response || this.responseText || {params: ''}).params)
            }
        }).get($('sel'));
    })
}); 
```

# coldfusion - 如何使用 ColdFusion 从 PowerPoint 文件中提取幻灯片注释

> ID：10507136
> 
> 赞同：4
> 
> 时间：2012-05-08T21:54:38.047
> 
> 标签：coldfusion, powerpoint

我有一个 .PPT（PowerPoint，可转换为 ODP 或 PPTX）文件，每张幻灯片上都有演讲者备注。我想将整个演示文稿提取成动态的东西，这样我就可以创建一个演讲者备忘单，以便在我讲话时在电话或桌子上运行（带有演讲者备注的幻灯片缩略图）。我经常这样做，以至于讨厌用手做。

这*几乎*很容易`<cfpresentation format="html" showNotes="yes">`将 PPT 拆分为 HTML 页面并为每张幻灯片创建一个图像。然而，cfpresentation 不会转移演讲者的笔记，它们会在翻译中丢失。

我也尝试过`<cfdocument>`，一旦转换为 PDF，它就没有保留幻灯片注释的选项。

有没有办法从 ColdFusion 中取出 PowerPoint 文件中的笔记？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T18:06:06.850

最简单的解决方案：

将 PowerPoint 演示文稿转换为 OpenOffice ODP 格式。那是一个ZIP文件。CFML 可以解压缩它，里面有一个 content.xml 文件，其中包含幻灯片和注释，因此 CFML 可以从该格式中提取注释。

鉴于 CFDOCUMENT 功能，也许 ColdFusion 甚至可以为您将 PPT 转换为 ODP？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T00:40:50.387

~~没有办法直接在 CF 中执行此操作。您可以通过使用底层 Java 来做到这一点。~~我站得更正了。使用[<cfpresentation> 标签](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7910.html)上的 showNotes 属性，应该将注释添加到 HTML。

作为替代方案，或者如果由于某种原因不起作用，您应该能够使用[Apache POI](http://poi.apache.org/)来执行此操作，尽管您可能需要使用比您的 Coldfusion 版本提供的更新版本的 poi，这[可能需要一些额外的工作](http://cfsearching.blogspot.com/2009/02/how-to-install-poi-35-beta-on.html)。

```
public static LinkedList<String> getNotes(String filePath) {
   LinkedList<String> results = new LinkedList<String>();

   // read the powerpoint
   FileInputStream fis = new FileInputStream(filePath);
   SlideShow slideShow = new SlideShow(is);
   fis.close();

   // get the slides
   Slide[] slides = ppt.getSlides();

   // loop over the slides
   for (Slide slide : slides) {

      // get the notes for this slide.
      Notes notes = slide.getNotesSheet();

      // get the "text runs" that are part of this slide.
      TextRun[] textRuns = notes.getTextRuns();

      // build a string with the text from all the runs in the slide.
      StringBuilder sb = new StringBuilder();
      for (TextRun textRun : textRuns) {
         sb.append(textRun.getRawText());
      }

      // add the resulting string to the results.
      results.add(sb.toString());
   }

   return results;
} 
```

继承复杂的格式可能是一个挑战（项目符号列表、粗体、斜体、链接、颜色等），因为您必须更深入地挖掘[TextRun](http://poi.apache.org/apidocs/org/apache/poi/hslf/model/TextRun.html)以及相关的 API 并弄清楚如何生成 HTML。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-09T01:56:47.953

CFPRESENTATION（至少从第 9 版开始）确实有一个 showNotes 属性，但您仍然必须解析输出。根据输出的标记，jQuery 可以很短地抓取你想要的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T14:42:18.870

感觉很糟糕，我的上述答案没有奏效，所以我挖了一点。它有点过时了，但它确实有效。 [PPTUtils](http://pptutils.riaforge.org/)，它基于@Antony 建议的 apache 库。我更新了这个功能来做你想做的事。您可能需要稍微调整一下才能完全按照您的意愿行事，但我喜欢这个实用程序以数据格式而不是您必须解析的 HTML 格式返回数据的事实。

为了以防万一，这里是我用来查找“getNotes()”函数 的[POI API 参考。](http://poi.apache.org/apidocs/org/apache/poi/hslf/usermodel/SlideShow.html)

```
 <cffunction name="extractText" access="public" returntype="array" output="true" hint="i extract text from a PPT by means of an array of structs containing an array element for each slide in the PowerPoint">
      <cfargument name="pathToPPT" required="true" hint="the full path to the powerpoint to convert" />
      <cfset var hslf = instance.loader.create("org.apache.poi.hslf.HSLFSlideShow").init(arguments.pathToPPT) />
      <cfset var slideshow = instance.loader.create("org.apache.poi.hslf.usermodel.SlideShow").init(hslf) />
      <cfset var slides = slideshow.getSlides() />
      <cfset var notes = slideshow.getNotes() />
      <cfset var retArr = arrayNew(1) />
      <cfset var slide = structNew() />
      <cfset var i = "" />
      <cfset var j = "" />
      <cfset var k = "" />
      <cfset var thisSlide = "" />
      <cfset var thisSlideText = "" />
      <cfset var thisSlideRichText = "" />
      <cfset var rawText = "" />
      <cfset var slideText = "" />

      <cfloop from="1" to="#arrayLen(slides)#" index="i">
           <cfset slide.slideText = structNew() />
           <cfif arrayLen(notes)>
                <cfset slide.notes = notes[i].getTextRuns()[1].getRawText() />
           <cfelse>
                <cfset slide.notes = "" />
           </cfif>
           <cfset thisSlide = slides[i] />
           <cfset slide.slideTitle = thisSlide.getTitle() />    
           <cfset thisSlideText = thisSlide.getTextRuns() />
           <cfset slideText = "" />

           <cfloop from="1" to="#arrayLen(thisSlideText)#" index="j">
                <cfset thisSlideRichText = thisSlideText[j].getRichTextRuns() />
                <cfloop from="1" to="#arrayLen(thisSlideRichText)#" index="k">
                     <cfset rawText = thisSlideRichText[k].getText() />     
                     <cfset slideText = slideText & rawText />  
                </cfloop>
           </cfloop>

           <cfset slide.slideText = duplicate(slideText) />
           <cfset arrayAppend(retArr, duplicate(slide)) />

      </cfloop>

      <cfreturn retArr />
 </cffunction> 
```

# ruby-on-rails - turkee：未定义的方法“reverse_merge！” 对于零：NilClass

> ID：10507138
> 
> 赞同：0
> 
> 时间：2012-05-08T21:54:40.317
> 
> 标签：ruby-on-rails, mechanicalturk

在试图让[土耳其人](https://github.com/aantix/turkee)工作时，我得到了一个`undefined method`reverse_merge！对于 nil:NilClass` 错误。

我的代码：

```
class MechanicalTurksController < ApplicationController
  def new
    @mechanical_turk = MechanicalTurk.new
    @disabled = Turkee::TurkeeFormHelper::disable_form_fields?(params)
  end
end

<%= turkee_form_for(@mechanical_turk, params) do |f| %>
    <%= f.label :first_name %>
    <%= f.text_field :first_name, disabled: @disabled %>

    <br />
    <%= f.submit "Save", class:"btn btn-primary", disabled: @disabled %>
<% end %>

class MechanicalTurk < ActiveRecord::Base

end 
```

我认为问题在于`params`哈希。我认为它缺少一些东西。文件说

> Mechanical Turk 现在要求将 hitId、workerId 和 turkSubmitTo 参数与 assignmentId 和表单参数一起传递。

这是我的日志的输出：

```
Started GET "/mechanical_turks/new?assignmentId=ASSIGNMENT_ID_NOT_AVAILABLE&hitId=2Z2MN9U8P9Y3B78UW1US1YIM5R7VEG" for 208.54.40.228 at 2012-05-08 17:35:24 -0400
Processing by MechanicalTurksController#new as HTML
  Parameters: {"assignmentId"=>"ASSIGNMENT_ID_NOT_AVAILABLE", "hitId"=>"2Z2MN9U8P9Y3B78UW1US1YIM5R7VEG"}
  Rendered mechanical_turks/new.html.erb within layouts/application (0.9ms)
Completed 500 Internal Server Error in 2ms

ActionView::Template::Error (undefined method `reverse_merge!' for nil:NilClass):
    1: <%= turkee_form_for(@mechanical_turk, params) do |f| %>
    2:     <%= f.label :first_name %>
    3:     <%= f.text_field :first_name, disabled: @disabled %>
    4: 
  app/views/mechanical_turks/new.html.erb:1:in `_app_views_mechanical_turks_new_html_erb___897197135_79286580' 
```

我还在[GitHub 上](https://github.com/aantix/turkee/issues/12)发布了一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T19:05:31.327

使用来自 github 的最新版本，现在可以使用。

# c# - 验证影响整个表单，不能按下任何按钮

> ID：10507139
> 
> 赞同：1
> 
> 时间：2012-05-08T21:54:42.610
> 
> 标签：c#, .net, forms, validation

我有一个包含大量控件的页面（gridviews、reportviewers、按钮等）

现在，我有几个文本框和下拉菜单，它们代表“表单”用户可能希望通过单击按钮来填写和提交。其中一些控件包含“RequiredFieldValidator”。

```
<fieldset runat="server" >
                    <asp:Label ID="lblName" runat="server" Text="Name:" AssociatedControlID="txtName" />
                    <asp:RequiredFieldValidator ID="rfvTxtName" runat="server" ControlToValidate="txtName" Text="(Required)" />
                    <asp:TextBox ID="txtName" Width="175px" runat="server" />
                    ....
                    ....
 </fieldset> 
```

我遇到的问题是因为这些验证控件，整个asp表单上没有其他按钮可以点击。

问题是; 如何将此验证设置为仅收听该特定字段集而不是整个页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T22:01:33.557

将这些控件的[ValidationGroup](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.validationgroup.aspx)属性设置为唯一的值。

更多信息[在这里](http://msdn.microsoft.com/en-us/library/ms227424.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T22:02:32.767

设置你的控件的`ValidationGroup`属性，使它们成为一个 group 。像

```
<asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Button" 
            ValidationGroup="MyGroup" /> 
```

> ValidationGroup 属性指定在验证时验证哪组控件。此属性主要用于表单中有多个按钮的情况。

[ASP.NET ValidationGroup 属性](http://www.w3schools.com/aspnet/prop_webcontrol_imagebutton_validationgroup.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:10:36.353

对于不想验证的控件，您还可以将属性**CausesValidation**更改为**False 。**

# php - 在具有特定 ID 的 div 中插入来自 PHP 的值

> ID：10507140
> 
> 赞同：0
> 
> 时间：2012-05-08T21:54:43.357
> 
> 标签：php, javascript, jquery, mysql, html

编辑：我找到了一个使用 jquery 和 php 中的 append() 的解决方案，我构建了包含我想要插入到选项卡 div 中的所有信息的数组。然后我通过将数组编码为 json 结束回显它，并使用 getJSON 捕获数组，将这个数组发送到 jquery。现在我可以成功地将我的数据添加到相应的 div 中。谢谢您的帮助

这是我的情况：在我的主页上，用户可以输入一个链接并将其与链接类型一起发送到数据库（如果它是关于自然、新闻、技术、娱乐的链接..）现在在同一页面上，我有一个在不刷新整个页面的情况下加载的 div，在这个 div 中我有一个选项卡式界面，其中每个选项卡代表一个链接的类型。每个选项卡内都有一个相应类型的链接。在我的数据库中，我存储链接和链接的类型

这是我的问题：我如何才能正确地用链接填充选项卡，知道要填充的选项卡的 ID 仅在读取 PHP 脚本中的数据库时才知道

这是带有选项卡界面的div

```
<div class="tabs">
    <ul class="tab_nav">  
        <li><a href="#News">News</a></li>  
        <li><a href="#Technology">Technology</a></li>  
        <li><a href="#Sport">Sport</a></li>  
    </ul>  
    <div id="News">
    </div>
    <div id="Technology">
    </div>
    <div id="Sport">
    </div>
</div> 
```

我想要做的是将某种类型的链接插入到具有相应 ID 的 div 中。只有在获取数据库时才知道链接的类型（和 div 的 ID）。

我是制作网站的新手，我完全被困在这里。我不知道该如何处理。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:02:46.500

尝试这个：

```
$('a').each(function(){
   t = $(this).text();
   $("#" + t).text($(this).attr("href"))
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:06:44.230

这是你想要的吗？

```
$('a').each(function(){
   $(this).clone().appendTo("#" + $(this).text());
})​ 
```

这是整个代码：[点击这里！](http://jsfiddle.net/KePyM/1/)

**注意：**它使用 jquery。只想说，因为你说你对网络的新事物。

# c# - 如何查找更改了哪些注册表值？

> ID：10507141
> 
> 赞同：0
> 
> 时间：2012-05-08T21:54:43.803
> 
> 标签：c#, .net, registry

我正在尝试查找对注册表进行了哪些更改或启动了哪些进程。例如：如果我更改 windows-explorer 的视图以显示隐藏的文件和文件夹 - 我想查看哪个注册表项被更改了。

有人建议使用进程监视器，但是 a) 有太多的注册表访问，并且 b) 我在那里找不到对注册表的任何更改。（虽然我记得读过它是对控制它的注册表的更改）

我这样做是因为我希望我的程序做同样的事情。

C# 中的答案会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:05:53.670

是的，哇，这可能会变得非常棘手，因为注册表可能很大。在过去，我会导出注册表的一个分支，比如 HKEY_LOCAL_MACHINE\SOFTWARE\InnaTech，然后运行一些我怀疑正在编辑该分支中的内容的程序，然后再次将其导出到另一个文件。如果分支不是很大，那么我可以观察它的差异，否则我会使用普通的差异程序 ala WinDiff 来查找任何更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:25:40.850

RegNotifyChangeKeyValue() 是您需要调用的系统函数。我从未见过有人尝试从 C# 中使用它，但使用它应该不会比调用任何其他非托管代码更麻烦。基本上，你调用它，它在第一次更改后返回，你再次调用它并等待下一个 chande。

**http://msdn.microsoft.com/en-us/library/windows/desktop/ms724892%28v=vs.85%29.aspx**

对其用途有相当好的描述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T21:58:58.223

[http://www.mydigitallife.info/trick-to-enable-show-hidden-files-and-folders-in-windows/](http://www.mydigitallife.info/trick-to-enable-show-hidden-files-and-folders-in-windows/)

转到“开始”菜单并单击“运行”（Windows Vista 和 Windows 7 使用“开始搜索”）。键入 RegEdit 并按 Enter 键运行注册表编辑器。导航到以下注册表项：

**HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\ CurrentVersion\Explorer\Advanced\Folder\Hidden\SHOWALL**

在右窗格中，验证 CheckedValue 值数据是否为 ​​REG_DWORD 类型。如果不是（如属于 REG_SZ），则删除 CheckedValue 值数据。如果 CheckedValue 已被删除，则创建一个新的 DWORD（32 位）值并将其命名为 CheckedValue。双击 CheckedValue 并将其值数据更改为 1（病毒可能会将其更改为 0 或 2）。在同一注册表项中，验证 Type 值数据是否为 ​​REG_SZ 类型，并且具有值数据单选。如果没有，请将其设置为收音机。病毒可能会将其更改为空白。设置系统显示或显示所有隐藏文件、文件夹和驱动器，然后检查是否显示隐藏文件和文件夹。

# css - 如何“z-index”使菜单始终位于内容之上

> ID：10507143
> 
> 赞同：25
> 
> 时间：2012-05-08T21:54:52.970
> 
> 标签：css, z-index

我有一个问题，我不知道如何纠正这个问题。我想要的是“红色框”保持在 z-index 2 中的页面顶部，而背景上的所有内容都保持在索引 1 上，但不知何故，这段代码正在“折叠”图层。如果有人可以帮助我，我真的很感激。对不起我的英语不好。提前致谢。

```
<html>
<head>
<title></title>
<style type="text/css">

body { margin: 0; }

#container {
    position: absolute;
    float: right;
    z-index: 1;

}

.left1 { 
    background-color: blue;
    height: 50px;
    width: 100%;

}
.left2 { 
    background-color: green;
    height: 50px;
    width: 100%;

}

#right { 
    background-color: red;
    height: 300px;
    width: 300px;
    float:right;
    z-index: 999999;
    margin-top: 0px;
    position: relative;
}

</style>
</head>

<body>

<div id="container"></div>
<div class="left1">LEFT BLUE</div>
<div class="left2">LEFT GREEN</div>
</div>
<div id="right">RIGHT RED</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-08T22:10:31.780

您很可能不需要 z-index 来执行此操作。您可以使用相对定位和绝对定位。

我建议您更好地了解 css 定位以及相对定位和绝对定位之间的区别......我看到您正在设置`position: absolute;`一个元素并试图浮动该元素。它不会工作的朋友！当您了解 CSS 中的定位时，您的工作会轻松很多！;)

**编辑：**为了清楚起见，定位不是他们的替代品，我确实使用`z-index`. 我只是尽量避免使用它们。开始使用`z-indexes`无处不在似乎很容易和有趣......直到您遇到与它们相关的错误并发现自己不得不重新访问和管理`z-indexes`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-05-21T07:43:09.647

您可以将样式放在容器 div 菜单中：

```
<div style="position:relative; z-index:10">
   ...
   <!--html menu-->
   ...
</div> 
```

前 ![在此处输入图像描述](../Images/9ffe9d0e4a9e97c60a21d139158463e2.png)

后

![在此处输入图像描述](../Images/f1b41beaff01ffd6a20f86c1fa4c6908.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T22:07:43.810

```
#right { 
  background-color: red;
  height: 300px;
  width: 300px;
  z-index: 9999;
  margin-top: 0px;
  position: absolute;
  top:0;
  right:0;
} 
```

位置：绝对；顶部：0；对：0；在这里工作！:) 还要去掉浮动！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-08T22:19:16.903

好的，我假设你想把 .left 放在容器中，所以我建议你编辑你的 html。关键是`position:absolute`和`right:0`

```
#right { 
    background-color: red;
    height: 300px;
    width: 300px;
    z-index: 999999;
    margin-top: 0px;
    position: absolute;
    right:0;
} 
```

这是完整的代码：http: [//jsfiddle.net/T9FJL/](http://jsfiddle.net/T9FJL/)

# c++ - SDL_PollEvent 未获取所有事件

> ID：10507144
> 
> 赞同：0
> 
> 时间：2012-05-08T21:54:53.817
> 
> 标签：c++, sdl

我目前正在使用 SDL 制作游戏，但遇到了 SDL 无法接收某些事件的问题。例如，我将按下“w”向前移动，同时移动鼠标环顾四周。但是假设我然后按“a”或“d”，SDL 不会选择这些事件，甚至当我释放“w”时，SDL 也不会选择 KEYUP 事件。我首先在windows中编写了这段代码，一切正常，但切换到ubuntu后，它不再按预期工作了。这是我轮询事件的主循环：

```
while(Running)
{
    while(SDL_PollEvent(&event))
        Events(&event);
    if( active ){
        Loop();
        Render();
    }
} 
```

这是 Events() 中的代码：

```
switch(Event->type)
    {
        case SDL_QUIT:
            Running = false;
            break;
        case SDL_KEYDOWN:
            switch(Event->key.keysym.sym)
            {
                case SDLK_ESCAPE:
                    Running = false;
                    break;
                case SDLK_a:
                    keyStates['a'] = true;
                    break;
                case SDLK_s:
                    keyStates['s'] = true;
                    break;
                case SDLK_d:
                    keyStates['d'] = true;
                    break;
                case SDLK_w:
                    keyStates['w'] = true;
                    break;
                case SDLK_LSHIFT:
                    camera.setSpeed(2.0f);
                    break;
            }
            break;
        case SDL_KEYUP:
            switch(Event->key.keysym.sym)
            {
                case SDLK_a:
                    keyStates['a'] = false;
                    break;
                case SDLK_s:
                    keyStates['s'] = false;
                    break;
                case SDLK_d:
                    keyStates['d'] = false;
                    break;
                case SDLK_w:
                    keyStates['w'] = false;
                    break;
                case SDLK_LSHIFT:
                    camera.setSpeed(1.0f);
                    break;
            }
            break;
        case SDL_MOUSEBUTTONDOWN:
            switch(Event->button.button)
            {
                case SDL_BUTTON_MIDDLE:
                    mouse.middle = true;
                    break;
            }
            break;
        case SDL_MOUSEBUTTONUP:
            switch(Event->button.button)
            {
                case SDL_BUTTON_MIDDLE:
                    mouse.middle = false;
                    break;
            }
            break;
        case SDL_MOUSEMOTION:
            if( moving ){
                camera.lookat(float(Event->motion.x - winWidth/2),float(Event->motion.y - winHeight/2), MOUSE_SENSITIVITY, dt);
                SDL_EventState(SDL_MOUSEMOTION, SDL_IGNORE);
                SDL_WarpMouse(winWidth/2, winHeight/2);
                SDL_EventState(SDL_MOUSEMOTION, SDL_ENABLE);
            }
            break;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:10:44.833

> keyStates['a'] = true;

有`SDL_GetKeyState`这个。使用它而不是手动维护数组。

```
Uint8 keys[SDLK_LAST];
Uint8* sdlKeys = SDL_GetKeyState(0);
memcpy(keys, sdlKeys, sizeof(keys)); 
```

.

```
bool keyPressed(SDLKey key){
    return keys[key] == SDL_PRESSED;
} 
```

还要检查[文档](https://wiki.libsdl.org/FrontPage)。

# iphone - 单击菜单项时获取菜单项位置 Cocos2D（将它们传递给函数）

> ID：10507158
> 
> 赞同：3
> 
> 时间：2012-05-08T21:56:32.043
> 
> 标签：iphone, objective-c, ios, cocos2d-iphone

当我单击它时，有什么方法可以在 Cocos2d 中获取菜单按钮的位置？

所以我有一个菜单：

你好世界.h

```
//creating a menu
CCMenu *menu; 
```

你好世界.m

```
// initializing the menu and its position
menu = [CCMenu menuWithItems:nil];
menu.position = ccp(0,0);

// set cells in placing grid
[self setItem];
[self addChild:menu];

- (void)setItem
{
  //this method is a loop that creates menu items
  //but i've simplified it for this example, but please keep in mind that there are lots 
  //of menu items and tagging them could be troublesome

  for (int i = 1; i <= 13; i++) {
      for (int j = 1; j <= 8; j++) {

        // this creates a menu item called grid
        CCMenuItem grid = [CCMenuItemSprite 
          itemWithNormalSprite:[CCSprite spriteWithSpriteFrameName:@"menuItem.png"]
          selectedSprite:[CCSprite spriteWithSpriteFrameName:@"selected.png"] 
          target:self 
          // when button is pressed go to someSelector function
          selector:@selector(someSelector:)];

          //coordinates
          float x = (j+0.55) * grid.contentSize.width;
          float y = (i-0.5) * grid.contentSize.height;

          //passing the coordinates
          grid.position = ccp(x, y);

          //add grid to the menu
          [menu addChild:grid];

          //loop unless finished
       }
  }

}

-(void)someSelector:(id)selector
{
   //i know when the button is pressed but is there any way 
   //to pass selected menu coordinates to this function?
   NSLog(@"Grid is pressed");
} 
```

基本上上面发生的事情是 - 我创建一个菜单，然后我调用一个创建菜单项的函数，一旦创建了这些菜单项，它们就会被添加到菜单中。每个菜单项都有一个 self 目标，选择器是 someSelector 函数，我想将参数传递给（菜单按钮位置）。

我想在这里做的是，

当我在模拟器中运行程序时，我希望能够获得按下菜单按钮的位置。

谢谢，期待您的回音。

我想我找到了解决自己问题的方法：

```
-(void)someSelector:(id)selector 
```

必须改为

```
-(void)someSelector:(CCMenuItem *) item 
```

然后你可以这样做：

```
NSLog(@"Grid is pressed %f %f", item.position.x, item.position.y); 
```

瞧！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:12:10.387

In your handler, you can cast the sender as a CCMenuItem and access its position from that:

```
-(void)someSelector:(id)sender
{
   //i know when the button is pressed but is there any way 
   //to pass selected menu coordinates to this function?
   NSLog(@"Grid is pressed");
   CCMenuItem* menuItem = (CCMenuItem*)sender;
   float x = menuItem.position.x;
   float y = menuItem.position.y;
} 
```

# sql - 确定在 BULK INSERT 中导致“文件意外结束”错误的 ROW？

> ID：10507162
> 
> 赞同：32
> 
> 时间：2012-05-08T21:57:05.977
> 
> 标签：sql, sql-server, sql-server-2008, bulkinsert

我正在做一个批量插入：

```
DECLARE @row_terminator CHAR;
SET @row_terminator = CHAR(10); -- or char(10)

DECLARE @stmt NVARCHAR(2000);
SET @stmt = '
  BULK INSERT accn_errors
   FROM ''F:\FullUnzipped\accn_errors_201205080105.txt''
   WITH 
      (
        firstrow=2,
FIELDTERMINATOR = ''|''  ,
ROWS_PER_BATCH=10000
   ,ROWTERMINATOR='''+@row_terminator+'''
   )'
exec sp_executesql @stmt; 
```

并收到以下错误：

```
Msg 4832, Level 16, State 1, Line 2
Bulk load: An unexpected end of file was encountered in the data file.
Msg 7399, Level 16, State 1, Line 2
The OLE DB provider "BULK" for linked server "(null)" reported an error. The provider did not give any information about the error.
Msg 7330, Level 16, State 2, Line 2
Cannot fetch a row from OLE DB provider "BULK" for linked server "(null)". 
```

有没有办法知道这个错误发生在哪一行？

我能够毫无问题地导入 10,000,000 行，然后出现错误

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-10-29T20:29:16.807

要找到麻烦的行，请使用错误文件说明符。

```
BULK INSERT myData
FROM 'C:\...\...\myData.csv'
WITH (
FIELDTERMINATOR = ',',
ROWTERMINATOR = '\n',
ERRORFILE = 'C:\...\...\myRubbishData.log' 
); 
```

myRubbishData.log 将包含有问题的行，并且伴随文件 myRubbishData.log.txt 将为您提供文件中的行号和偏移量。

配套文件示例：

```
Row 3 File Offset 152 ErrorFile Offset 0 - HRESULT 0x80004005
Row 5 File Offset 268 ErrorFile Offset 60 - HRESULT 0x80004005
Row 7 File Offset 384 ErrorFile Offset 120 - HRESULT 0x80004005
Row 10 File Offset 600 ErrorFile Offset 180 - HRESULT 0x80004005
Row 12 File Offset 827 ErrorFile Offset 301 - HRESULT 0x80004005
Row 13 File Offset 942 ErrorFile Offset 416 - HRESULT 0x80004005 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-08T22:19:11.557

好玩，好玩，好玩。我还没有找到调试这些问题的好方法，所以我使用蛮力。也就是说，FirstRow 和 LastRow 选项非常有用。

从 LastRow = 2 开始并继续尝试。将结果加载到一次性表格中，您可以轻松截断该表格。

而且，您还应该记住，第一行也可能会给您带来问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-10-28T20:48:30.103

我有一个使用批量导入的 csv 文件

```
BULK INSERT [Dashboard].[dbo].[3G_Volume]
FROM 'C:\3G_Volume.csv'
WITH
(
FIRSTROW = 2,
FIELDTERMINATOR = '","',
ROWTERMINATOR = '\n'
)
GO 
```

通常我使用这个脚本，它没有问题，但在极少数情况下。

我遇到这个错误..

“链接服务器“（null）”的 OLE DB 提供程序“BULK”报告了错误。提供程序没有提供有关该错误的任何信息。

通常，当最后一行有空白值（null）时会发生这种情况。

您需要在 MS access db 中链接您的 csv 文件以检查数据。（如果您的 csv 不超过 140 万行，您可以在 excel 中打开它）

由于我的数据大约有 300 万行，因此我需要使用 access db。

然后检查最后一行的空格数，并将空行数减去 csv 的总行数。

如果最后有 2 个空白行并且总行数为 30000005 脚本将变成这样..

```
BULK
INSERT [Dashboard].[dbo].[3G_Volume]
 FROM 'C:\3G_Volume.csv'
WITH
(
FIRSTROW = 2,
FIELDTERMINATOR = '","',
ROWTERMINATOR = '\n',
Lastrow = 30000003
)
GO 
```

干杯... Mhelboy

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-09T00:51:32.783

如果 CHAR(10) 是行终止符，我认为您不能像在 BULK INSERT 中那样将其放在引号中。但是，有一种未记录的方式来表示它：

```
ROWTERMINATOR = '0x0A' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-09T07:36:16.173

是的-正如 Gordon 正确指出的那样，BULK INSERT 会在其错误消息中提供更多细节，而解决此问题的唯一方法是使用蛮力方法。但是，首先，根据您收到的错误，它要么不理解您的行终止符，要么文件末尾缺少行终止符。使用 FIRSTROW 和 LASTROW 将有助于确定这一点。

因此，您需要执行以下操作：

1.  检查文件末尾是否有行终止符。如果没有，请放入一个并重试。还要确保最后一行包含所有必要的字段。它说'EOF'，那是你的问题。
2.  您确定每行末尾都有一个 LF 吗？试试 CR (\n, 0x0D) 看看是否可行。
3.  还是行不通？尝试设置 LASTROW=2 并重试。然后尝试 LASTROW=3。如果您的文件中有超过三行并且此步骤失败，则行终止符不起作用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-07T14:31:09.420

我遇到了同样的问题。我编写了一个 shell 脚本来在 Linux 中创建一个 .csv。我将此 .csv 带到 Windows 并尝试批量加载数据。它没有“喜欢”逗号....不要问我为什么，但是我在批量导入中更改为 * 作为分隔符，并在我的 .csv 中用 * 查找和替换逗号 .. 有效..我改成~作为分隔符，这有效...制表符也有效-它不喜欢逗号....希望这对某人有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-13T19:18:07.347

以我的经验，这几乎总是由最后两行中的某些内容引起的。 `tail`导入文件，它仍然应该给你失败。然后在全文编辑器中打开它，您可以看到非打印字符，如 CR、LF 和 EOF。即使您不知道为什么，这应该使您能够将其整合到工作中。例如，[BULK INSERT 失败，最后一行有行终止符](https://stackoverflow.com/q/25291988/2662901)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-07-05T17:04:30.363

我通过将所有字段转换为字符串然后使用通用 FIELDTERMINATOR 解决了这个问题。这有效：

```
BULK INSERT [dbo].[workingBulkInsert]  
FROM 'C:\Data\myfile.txt' WITH (
   ROWTERMINATOR = '\n', 
   FIELDTERMINATOR = ',' 
) 
```

我的数据文件现在看起来像这样：

```
"01502","1470"
"01504","686"
"02167","882"
"106354","882"
"106355","784"
"106872","784" 
```

第二个字段是没有双引号分隔符的十进制类型（如 1470.00）。将两者都格式化为字符串消除了错误。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-11T12:32:11.253

我有一个使用批量导入的 CSV 文件

您需要创建一个表，并且所有列都应该可以为空并删除最后一行中的空格，只添加那些在 excel 中可用的列。并且请不要创建主列，此过程不会自动增加身份，这就是创建错误的原因。

我已经完成了这样的批量插入：

```
CREATE TABLE [dbo].[Department](
    [Deptid] [bigint] IDENTITY(1,1) NOT NULL,
    [deptname] [nvarchar](max) NULL,
    [test] [nvarchar](max) NULL,
 CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
    [Deptid] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, 
    ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO

CREATE TABLE [dbo].[Table_Column](
    [column1] [nvarchar](max) NULL,
    [column2] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO

BULK INSERT Table_Column
FROM 'C:\Temp Data\bulkinsert1.csv'
WITH (
    FIELDTERMINATOR = ',',
    ROWTERMINATOR='\n' ,
    batchsize=300000 
);

insert into [dbo].[Department] 
select column1,column2 from Table_Column 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-07-05T16:52:12.033

如果我将所有字段转换为字符串然后使用通用字段分隔符，我就解决了这个问题。

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2014-11-13T23:35:39.347

产生此错误的行没有 `CHAR(10)`终止符或有不必要的空格

# android - 如何在来电屏幕上设置自定义按钮？

> ID：10507163
> 
> 赞同：-3
> 
> 时间：2012-05-08T21:57:07.147
> 
> 标签：android

我浏览了一些帖子，但其中大多数都讨论了放置带有信息的图像或字符串。

但是，我需要放置操作某些呼叫功能的按钮。

有没有一种方法可以在所有 android 发行版中普遍适用？

（我想用我的按钮在普通屏幕上方弹出自定义屏幕。这是个好主意，还是有更直接的方法来实现这一点？）

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:31:27.973

在现有设备上，没有一种合法的方式可以将您自己的按钮“放在”拨号器应用程序活动的任何部分（包括来电屏幕）。这种功能需要拨号器显式地为其提供 API。库存系统防止后台应用程序将它们自己的可点击区域“置于”当前在前台的任何内容之上。（这也是一件好事，这样做的坏理由远远超过了合法的理由。）

如果您想这样做，您将不得不考虑构建您自己的操作系统版本以支持它。或者，如果您将设备解锁到足以安装您自己的应用程序来处理拨号器的所有功能。然后您可以为第三方应用程序提供一个 API 来执行此操作（或者只是将您的按钮“烘焙”到拨号器）但我想能够正确连接所有这些以实际拨打您的电话将非常困难。

# php - 使用 PHP 进行排序，但某些条目可以具有相同的值

> ID：10507165
> 
> 赞同：0
> 
> 时间：2012-05-08T21:57:28.213
> 
> 标签：php

我正在研究马评级系统，我需要根据另一个（已填充）字段的值（所有这些都存储在 MySQL 数据库中）为每匹马分配值。

考虑以下简化示例：-

四马比赛，每匹马的赔率如下：-

马 A - 2/1 马 B - 3/1 马 C - 3/1 马 D - 5/1

由于马 A 的价格最低，我想给它一个值 1。

但是，马 B 和 C 的价格相同，所以我想给他们两个。

马 D 的价格次之，所以我想给它 3 的值。

当我第一次开始这样做时，我认为这很容易，但现在已经到了循环让我发疯的阶段。任何建议将不胜感激。

提前谢谢了。

鉴于我在下面收到的来自 Daan 的回复，我还应该补充一点，我的问题由于我的表格有几个子集而更加复杂（即，它在任何一天都包含不止一场比赛，并且需要单独排名） .

我的桌子目前是：-

比赛日期 | 比赛时间 | 赛马场 | 马名 | 预测 | 预测率 | ID

为此目的，比赛日期将始终相同。赛马时间和赛马场共同确定了有问题的比赛。

预测是给每匹马的价格（在这个阶段已经输入），这是需要对其进行共享排名以存储在 predict_rate 中的价格。

id 只是表中每个条目的唯一索引。

这就是我现在要做的（它不起作用......惊喜......）

```
 $testdude=mysql_query("SELECT DISTINCT racecourse,racetime FROM picking") or die(mysql_error());

while($rih=mysql_fetch_array($testdude)){
$testdude1=mysql_query("SELECT s1.forecast, s1.horsename, COUNT(DISTINCT s2.forecast) AS rank FROM picking s1 JOIN picking s2 ON (s1.forecast <= s2.forecast) GROUP BY s1.horsename;");
while($rih1=mysql_fetch_array($testdude1)){
mysql_query("UPDATE picking SET forecast_rate='$testdude1[rank]' where horsename='$testdude1[horsename]'") or die(mysql_error());
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:25:35.950

这称为共享排名，在 MySQL 中最容易做到这一点。看看[这个教程](http://code.openark.org/blog/mysql/sql-ranking-without-self-join)，看看你是否可以让它工作。如果没有，请提供有关您的表格布局的更多详细信息，我将为您提供量身定制的示例 :)

# c# - 监听 5060 端口

> ID：10507166
> 
> 赞同：0
> 
> 时间：2012-05-08T21:57:44.853
> 
> 标签：c#, sockets

我正在开发一个 SIP 客户端。为此，我必须侦听端口 5060 以获取传入的 SIP 服务器消息。为此，我编写了一些代码。（另外我在程序中拥有管理员权限。）

```
 WindowsPrincipal pricipal = new WindowsPrincipal(WindowsIdentity.GetCurrent());
    bool hasAdministrativeRight = pricipal.IsInRole(WindowsBuiltInRole.Administrator);
    if (hasAdministrativeRight == true)
    {
        TcpListener server;
        Int32 port = 5060;
        IPAddress localAddr = IPAddress.Parse("127.0.0.1");
        server = new TcpListener(localAddr, port);
        server.Start();
        Byte[] bytes = new Byte[256];
        String data = null;
        while (true)
        {
            Console.Write("Waiting for a connection... ");
            TcpClient client = server.AcceptTcpClient();
            Console.WriteLine("Connected!");
            data = null;
            NetworkStream stream = client.GetStream();
            int i;
            while ((i = stream.Read(bytes, 0, bytes.Length)) != 0)
            {
                data = System.Text.Encoding.ASCII.GetString(bytes, 0, i);
                Console.WriteLine("Received: {0}", data);
                data = data.ToUpper();

                byte[] msg = System.Text.Encoding.ASCII.GetBytes(data);
                stream.Write(msg, 0, msg.Length);
                Console.WriteLine("Sent: {0}", data);
            }

            client.Close();
        }
    } 
```

我得到 SocketException：“试图以访问权限禁止的方式访问套接字”（本机错误代码：10013）...

你对此有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:00:43.277

您似乎正在运行两个应用程序，并且它们正试图访问同一个套接字。

[微软对您的问题的](http://support.microsoft.com/kb/819124)评价：

> **WSAEACCES (10013)**
> 
> *   **翻译**：权限被拒绝
> *   **说明**：试图以访问权限禁止的方式访问套接字。比如sendto使用广播地址，但是setsockopt(SO_BROADCAST)没有设置广播权限，就会出现这个错误。
>     
>     
>     
>     WSAEACCES 错误的另一个可能原因是当调用绑定 (Wsapiref_6vzm.asp) 函数时（在 Microsoft Windows NT 4 .0 Service Pack 4 [SP4] 或更高版本中），另一个程序、服务或内核模式驱动程序被绑定到具有独占访问权限的相同地址。这种独占访问是 Windows NT 4.0 SP4 及更高版本的新功能，它是通过使用 SO_EXCLUSIVEADDRUSE 选项实现的。

# python - 使用 Python 请求选择表单

> ID：10507169
> 
> 赞同：3
> 
> 时间：2012-05-08T21:58:12.503
> 
> 标签：python-requests, python, mechanize, python-requests

我想使用一个能够填写表格和处理重定向的python库：

1.  “主页”有一个表格`{'username':'user', 'password':'pass'}`
2.  “重定向”页面将我带到一个新页面
3.  “新”页面有一个指向最终页面的链接
4.  “最终”页面有一个表格`{'Field 1':'Data 1', 'Field 2':'Data 2'}`

我想进入“最终”页面并填写表格。我已经浏览了 SO 中关于[python-requests](/questions/tagged/python-requests "显示标记为“python-requests”的问题")的每一篇文章，阅读了 API 文档和整个用户指南。

我已经能够使用 mechanize 填写“主页”页面表格：

```
import mechanize
# Fill out Log In form
br = mechanize.Browser()
br.open('http://www.yourfavoritesite.com')
br.select_form(nr=0)
br['username'] = 'user'
br['password'] = 'pass'
br.submit() 
```

此外——在网页上禁用重定向后——我已经能够使用机械化来填写“新”页面表单：

```
# Click link
br.find_link(text='Admin')
req = br.click_link(text='Admin')
br.open(req)

# Fill out Final form
br.select_form(nr=0)
br['Field 1'] = 'Data 1'
br['Field 2'] = 'Data 2'
br.submit() 
```

如果我不禁用重定向并且页面重定向会发生什么我没有进入“新”页面并且当我尝试填写表单时出现以下错误：

```
File "<stdin>", line 1, in <module>
File "/usr/local/lib/python2.7/dist-packages/mechanize/_mechanize.py", line 524, in select_form
     raise FormNotFoundError("no form matching "+description)
mechanize._mechanize.FormNotFoundError: no form matching nr 0 
```

我听说 Python Requests 非常简单，我想使用这个库，假设我可以做一些事情：

```
import requests
# Fill out Log In form
data = {'username':'admin', 'password':'pass'}
r = requests.get('http://www.yourfavoritesite.com', allow_redirects=True)
r = requests.put(r.url, data=data)

# Follow redirect to "new" page

# Click link
# I haven't heard of this feature in requests

# Fill out Final form
data = {'Field 1':'Data 1', 'Field 2':'Data 2'}
r = requests.put(r.url, data=data) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T16:10:55.783

我知道这很旧，但我相信您正在寻找的答案`requests`是（显然）不是`get`，而是`post`。

来自： [http ://docs.python-requests.org/en/latest/user/quickstart/#more-complicated-post-requests](http://docs.python-requests.org/en/latest/user/quickstart/#more-complicated-post-requests)

```
>>> payload = {'key1': 'value1', 'key2': 'value2'}
>>> r = requests.post("http://httpbin.org/post", data=payload)
>>> print r.text
{
  ...
  "form": {
    "key2": "value2",
    "key1": "value1"
  },
  ...
} 
```

# java - 我的应用程序冻结，如何在其中实现线程？

> ID：10507171
> 
> 赞同：4
> 
> 时间：2012-05-08T21:58:19.033
> 
> 标签：java, android, multithreading, freeze

你能帮我弄清楚如何为此实现线程，所以它在等待服务器的答案时不会冻结？我已经尝试了 5 个小时左右，我只是找不到在线程中使用它的方法，然后返回它以使用 tv.setText(); 设置文本；

```
package zee.rhs.dk;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;
import java.net.UnknownHostException;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

public class AndroidClientActivity extends Activity {

private String ip = "90.184.254.246";
private int port = 8081;
private String line;
private TextView tv;
private Button btn;
private Socket socket;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    tv = (TextView) findViewById(R.id.tv);
    btn = (Button) findViewById(R.id.btn);
    btn.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            BufferedReader in = null;
            PrintWriter out = null;
            try {
                socket = new Socket(ip, port);
                out = new PrintWriter(socket.getOutputStream(), true);
                out.println("update");

                in = new BufferedReader(new InputStreamReader(socket
                        .getInputStream()));

                while ((line = in.readLine()) == null) {
                }
                tv.setText(line);

            } catch (UnknownHostException e) {
                Toast.makeText(AndroidClientActivity.this,
                        "Can't reach ip: " + ip, Toast.LENGTH_LONG).show();
                e.printStackTrace();
            } catch (IOException e) {
                Toast.makeText(AndroidClientActivity.this,
                        "Accept failed at port: " + port, Toast.LENGTH_LONG)
                        .show();
                e.printStackTrace();
            } finally {
                out.close();
            }
        }
    });
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:32:25.250

[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)是您正在寻找的。从帮助页面：

```
 private class DownloadFilesTask extends AsyncTask<URL, Integer, Long> {
     protected Long doInBackground(URL... urls) {
         int count = urls.length;
         long totalSize = 0;
         for (int i = 0; i < count; i++) {
             totalSize += Downloader.downloadFile(urls[i]);
             publishProgress((int) ((i / (float) count) * 100));
         }
         return totalSize;
     }

     protected void onProgressUpdate(Integer... progress) {
         setProgressPercent(progress[0]);
     }

     protected void onPostExecute(Long result) {
         showDialog("Downloaded " + result + " bytes");
     }
 } 
```

请记住，`doInBackground`它在单独的线程中`onPostExecute`运行，并在完成后在 UI 线程中运行`doInBackground`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:03:12.833

将负责向服务器请求的代码放入单独的线程中：

```
Thread thread = new Thread() {
    @Override
    public void run() {
        try {
            // put your socket operations here   
        } catch (InterruptedException e) {
           // handle exception if you need
        }
    }
};

thread.start(); 
```

# javascript - 使用多个版本的 RequireJS

> ID：10507176
> 
> 赞同：1
> 
> 时间：2012-05-08T21:58:57.660
> 
> 标签：javascript, dojo, requirejs

我有一个使用 Dojo 1.7.2 构建的 Web 应用程序，使用 RequireJS 通过 AMD 加载单个模块。我想添加一个稍微定制的 ACE 代码编辑器版本 0.2.0 副本，它大约有 9 个月大的历史，并使用早期的、不兼容的 RequireJS 版本来加载自身。

真的，我只想包含不同的 JavaScript 文件（Dojo 和 ACE），而不会发生命名空间冲突（在全局函数上`declare`，`require`这是 RequireJS 旨在帮助防止的东西）。我想在不进一步定制任何一个项目的情况下做到这一点。这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T03:43:40.230

Ace 的作者建议使用 master 分支中的最新版本，它应该与最近的 RequireJS 兼容。

顺便说一句，您能否在某处发布您如何使用 RequireJS 运行 Dojo 1.7.2？

# gdata - 使用 GData API，是否可以授权应用程序访问单个 Google Doc 电子表格？

> ID：10507183
> 
> 赞同：0
> 
> 时间：2012-05-08T21:59:58.347
> 
> 标签：gdata

我想通过 GDATA API 在已发布的 Google 电子表格中读取和写入数据，但我不希望我的应用程序通过完整的电子表格授权进行身份验证（授予它对该用户文档的完全访问权限）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T08:18:02.583

[根据官方文档](https://developers.google.com/google-apps/spreadsheets/#authorizing_requests_with_oauth_20 "谷歌电子表格 API 3.0 版")似乎是不可能的。

该文档没有说明是否可以限制身份验证 OAuth2 的范围：`http(s)://spreadsheets.google.com/feeds/`。

# android - 从应用程序外部返回 Activity 时

> ID：10507186
> 
> 赞同：0
> 
> 时间：2012-05-08T22:00:26.037
> 
> 标签：android, android-intent

这是场景。当屏幕变黑或从应用程序外部返回活动（电话、多任务处理）时，我希望能够调用 onResume() 函数中的函数。

如果我在同一个应用程序中使用后退按钮，我不希望调用此函数。我正在做的是要求该人再次提供敏感凭据，如果他们从外部来源返回应用程序。

我觉得答案可能在于意图过滤器，但我还没有找到任何符合我需要的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:06:24.900

您可以使用 startActivityForResults 开始您的活动并覆盖 onBackPressed 以使其他活动返回特定结果。

捕捉结果你会知道是否按下了后退按钮。

# opengl - 为什么 CGLFlushDrawable 这么慢？（我正在使用 VBO）

> ID：10507190
> 
> 赞同：1
> 
> 时间：2012-05-08T22:01:04.603
> 
> 标签：opengl, buffer, flush, frame-rate

**我的申请详情：**

运行：Macbook pro 4GB RAM，ATI Radeon X1600 128MB VRAM，Opengl 版本：2.1 ATI-7.0.52

使用垂直同步（通过 CVDisplay）：是

编程语言：Lisp (Lispworks) with FFI to Opengl

**像素格式信息**

*   ns-open-gl-pfa-深度大小 32
*   ns-open-gl-pfa-sample-buffers 1
*   ns-open-gl-pfa-samples 6
*   ns-open-gl-pfa-加速 1
*   ns-open-gl-pfa-no-recovery 1
*   ns-open-gl-pfa-backing-store 0
*   ns-open-gl-pfa-virtual-screen-count 1

*[1 = YES, 0 = NO] 用于布尔属性*

**我的应用程序中有以下网格：**

14 个静态网格（不会改变）。我已经为每个具有静态绘制类型的网格定义了一个 VBO。

2 个动态网格（每帧更改）。我已经为每个具有流绘制类型的网格定义了一个 VBO。

对于这些动态网格，每帧我使用空指针绑定缓冲区数据，然后映射缓冲区，更新映射缓冲区并取消映射缓冲区。

当我运行应用程序并使用 Opengl 分析器检查时：它显示以下（统计视图）：

*CGLFlushDrawable：*

*   平均时间（微秒）：*52990.63 = 52.990 毫秒*
*   % GL 时间：*98.55*
*   % 应用时间：*43.96*

难怪我的 FPS 很差，大约 6-7 FPS。

优化 CGLFlushDrawable 的方法是什么，因为我只是调用了 flushBuffer，而我相信它又调用了 CGLFlushBuffer。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T19:40:01.890

好吧，原来***我的ATI Radeon X1600显卡有问题***。

没有任何改变，当我在另一台更新的 13 英寸 Macbook Pro 上测试相同的代码时，它具有英特尔高清显卡 3000 和 384MB DDR3 SDRAM，考虑到我所期望的动态网格，该应用程序可以在大约 30 FPS 的情况下正常工作有。

此外，***CGLFlushDrawable 中没有任何瓶颈，***就像我的旧 MBP 一样。此外，在 VBO 分配后可用的 VRAM 中的内存量保持不变（这也是我所期望的）。这不是我的旧 MBP 上发生的事情。

最后，我的 MBP 显示器崩溃了（虽然不够频繁），外接 LCD 显示器也无法正常工作，这表明我的显卡有问题。

@Brad，感谢您的所有投入。

# c# - 如何获取 Action 委托调用的名称/详细信息？

> ID：10507205
> 
> 赞同：2
> 
> 时间：2012-05-08T22:01:53.340
> 
> 标签：c#, c#-4.0

我正在测试一些类似方法调用的性能，这些方法调用包含在一些计时和日志记录语句中。我通过[Action 委托](http://msdn.microsoft.com/en-us/library/system.action.aspx)参数传递这些方法。

有没有办法打印有关通话的详细信息？

例如：

```
var httpResult = TestService(() => serviceHttp.Search(criteria));
var tcpResult = TestService(() => serviceTcp.Search(criteria));
var localResult = TestService(() => servicelocal.Search(criteria));

...

private static double TestService(Action serviceOperation)
{
    const int iterations = 15;
    ...

    for (var i = 0; i < iterations; i++)
    {
        var watch = Stopwatch.StartNew();

        ...

        Console.WriteLine(string.Format("{0} ElapsedMilliseconds={1}", ????, watch.ElapsedMilliseconds));
         // Ideally this would print something like "serviceTcp.DoStuff(...) ElapsedMilliseconds=313"
    }

    ...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:36:27.917

将您的测试方法声明更改为

```
private static double TestService(Expression<Action> expression) 
```

调用`Compile`表达式对象的方法获取测试方法：

```
var serviceOperation = expression.Compile(); 
```

`Expression`对象可以提供很多关于方法调用的信息，你可以从这样的开始：

```
private static string GetMethodCallDescription(Expression<Action> expression)
{
    var mce = (MethodCallExpression)expression.Body;
    var method = mce.Method;
    var sb = new StringBuilder();
    sb.Append(method.DeclaringType.Name);
    sb.Append(".");
    sb.Append(method.Name);
    sb.Append("(");
    bool firstarg = true;
    foreach(var arg in mce.Arguments)
    {
        if(!firstarg)
        {
            sb.Append(", ");
        }
        else
        {
            firstarg = false;
        }
        sb.Append(arg.ToString());
    }
    sb.Append(")");
    return sb.ToString();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T22:44:37.070

你可以不使用表达式树来做到这一点；只需更改TestService的签名，分别取action和parameter，使用`Delegate.Target`and`Delegate.Method`属性获取类型和方法：

```
var httpResult = TestService(serviceHttp.Search, criteria);
var tcpResult = TestService(serviceTcp.Search, criteria);
var localResult = TestService(servicelocal.Search, criteria);

...

private static double TestService<T>(Action<T> serviceOperation, T parameter)
{
    const int iterations = 15;
    ...

    for (var i = 0; i < iterations; i++)
    {
        var watch = Stopwatch.StartNew();

        ...

        string typeName = serviceOperation.Method.IsStatic
                          ? serviceOperation.Method.DeclaringType.Name
                          : serviceOperation.Target.GetType().Name;
        string methodName = serviceOperation.Method.Name;
        Console.WriteLine(string.Format("{0}.{1} ElapsedMilliseconds={2}", typeName, methodName, watch.ElapsedMilliseconds));
         // Ideally this would print something like "serviceTcp.DoStuff(...) ElapsedMilliseconds=313"
    }

    ...
} 
```

# android - 通过 XML 数据的受控迭代

> ID：10507206
> 
> 赞同：0
> 
> 时间：2012-05-08T22:01:57.320
> 
> 标签：android

下午好，

我有一个简单的应用程序（只是学习），它从模拟文件中读取一些 xml 数据。XML 数据很好地分为 6 个类别，我使用 SAX 解析器来读取它。我的应用程序基本上有两个按钮 prev 和 next。因此，当应用程序加载时，我希望看到第一类 xml 数据。当用户按下下一个按钮......那么我想看到下一类数据等等。我的问题是如何来回浏览数据？我是否将其全部加载到具有某种排序形式的数据对象中并在对象中来回迭代，或者我是否将 atty 字段添加到父元素并仅在 xml 中搜索请求的 atty 和子数据？我不预见 xml 会变得非常大。只是试图获得更多有经验的输入来了解如何将数据与 gui 同步。

TIA JB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:19:56.657

有很多方法可以解决它。通常一个不错的路径是将 XML 解析为数据结构，[适配器](http://developer.android.com/reference/android/widget/Adapter.html)可以使用该数据结构来创建视图结构并返回它们以便显示。这将使您能够很好地控制数据的外观，并允许您非常轻松地与许多不同的复杂视图结构联系起来。

您存储它的数据结构也有很多可能性。哪些效果最好通常取决于您的特定数据集。

鉴于我对您的数据的了解，ArrayList 似乎是一种简单的方法。为自己创建一个类，该类将包含有关一个类别的所有数据。当您从 XML 文件中提取数据时，在解析器中创建该类的对象，每次进入新类别时，都将您的对象添加到 ArrayList。完成后，您应该有一个 List 结构，该结构在每个索引处都有 1 个类别对象（及其所有数据）。

一旦你完成了这个设置，就让你自己成为一个带有 List的[ArrayAdapter 。](http://developer.android.com/reference/android/widget/ArrayAdapter.html)覆盖 getView() 方法以扩充您的视图对象并使用列表中的数据填充它们。

然后，此适配器可以提供父视图（ViewPager、ViewSwitcher、ListView 等）。这些父视图将使您的数据结构的迭代变得容易（即从一个类别切换到下一个类别并返回。）

# mysql - 如何按计数限制 SQL LEFT JOIN 查询的结果集

> ID：10507210
> 
> 赞同：3
> 
> 时间：2012-05-08T22:02:42.553
> 
> 标签：mysql, sql, join

我希望使用 LEFT JOIN 查询从具有一对多关系的两个表中获取一些结果，但根据“孩子”的数量限制结果集。我有两个表结构如下：

```
customers
id    name    ...
1     "bob"   ...
2     "jill"  ...

orders
id    customer_id    ...
100   1              ...
101   2              ...
102   1              ... 
```

（表中的其余数据与此查询无关。）

我想做的是获取所有客户 ID 及其订单 ID，按客户排序，**但仅限于下了多个订单的客户。**在此示例中，结果如下所示：

```
cust_id    order_id
1          100
1          102 
```

我从一个基本的 LEFT JOIN 开始，将订单 ID 与他们的客户配对，但不知道如何排除所有未订购至少两次的客户。

```
SELECT 
    `customers`.`id` AS `cust_id`,
    `orders`.`id` AS `order_id`
FROM
    `customers`
LEFT JOIN `orders` ON
    `customers`.`id` = `orders`.`customer_id`
ORDER BY
    `cust_id` 
```

谢谢大家。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T22:05:17.040

一种方法是创建一个内联视图，以获取拥有多个订单的客户及其内部连接。如果您不喜欢 JOIN，您也可以执行 IN 或 EXISTS

```
SELECT 
    `customers`.`id` AS `cust_id`,
    `orders`.`id` AS `order_id`
FROM
    `customers`
LEFT JOIN `orders` ON
    `customers`.`id` = `orders`.`customer_id`
INNER JOIN 
      (SELECT `customer_id `    
       FROM `orders`
       GROUP BY `customer_id`    
       HAVING COUNT(id) > 1) as `morethanone`
On
    `customer`.`id`  = `morethanone`.`custmor_id`
ORDER BY
    `cust_id` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:12:16.880

首先，您不需要将联接保留在外部，因为该联接与内部联接之间的唯一区别是包括没有订单的客户，并且您不需要它们在结果中，因为他们的订单少于两个.

```
SELECT customers.id AS `cust_id`, orders.id AS `order_id`
FROM customers
     INNER JOIN orders ON `customers`.`id` = `orders`.`customer_id`
     INNER JOIN orders count_orders ON customers.id = count_orders.customer_id
GROUP BY count_orders.id, orders.id
HAVING count(count_orders.id) >= 2
ORDER BY `cust_id` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T22:18:24.627

嘿，我想我有点慢，但无论如何我都会发布我的答案。它略有不同，但仍然有效。

```
SELECT `customers`.`id` AS `cust_id` , count( orders.id ) AS count_orders
FROM `customers`
JOIN `orders` ON `customers`.`id` = `orders`.`customer_id`
GROUP BY customers.id
HAVING count( orders.id ) >1
ORDER BY `cust_id` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T22:16:53.190

如果您排除尚未订购的客户，那么 LEFT JOIN 是不必要的，不是吗？

由于您需要结果集中的订单 ID，因此需要首先运行 COUNT 查询。

在 SQL Server 2005+ 中，CTE 将完成计数查询，然后可以根据该计数查询生成您想要的结果集：

```
WITH customerWithMoreThanOneOrder AS
(
    SELECT 
        `customers`.`id` AS `cust_id`
    FROM
        `customers`
    INNER JOIN `orders` ON
        `customers`.`id` = `orders`.`customer_id`
    GROUP BY 
        `customers`.`id`
    HAVING COUNT(0) > 1
)

SELECT 
    `customers`.`id` AS `cust_id`,
    `orders`.`id` AS `order_id`
FROM
    `customers`
INNER JOIN `orders` ON
    `customers`.`id` = `orders`.`customer_id`
WHERE `customers`.`id` IN (SELECT cust_id FROM customerWithMoreThanOneOrder)
ORDER BY
    `cust_id` 
```

如果您使用的数据库不支持这种结构，那么只需将计数查询放在 IN 子查询的括号中，如下所示：

```
SELECT 
    `customers`.`id` AS `cust_id`,
    `orders`.`id` AS `order_id`
FROM
    `customers`
INNER JOIN `orders` ON
    `customers`.`id` = `orders`.`customer_id`
WHERE `customers`.`id` IN (SELECT 
                               `customers`.`id` AS `cust_id`
                           FROM
                               `customers`
                           INNER JOIN `orders` ON
                               `customers`.`id` = `orders`.`customer_id`
                           GROUP BY 
                               `customers`.`id`
                           HAVING COUNT(0) > 1)
ORDER BY
    `cust_id` 
```

如果您有任何问题，请告诉我

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-09T00:32:46.260

作为其他答案的替代方案，您可以使用 IN 子句。

```
SELECT 
    `customers`.`id` AS `cust_id`,
    `orders`.`id` AS `order_id`
FROM
    `customers`
LEFT JOIN `orders` ON
    `customers`.`id` = `orders`.`customer_id`
WHERE `customer_id` IN (SELECT `customer_id` FROM `orders` GROUP BY `customer_id` HAVING COUNT(*) > 1)
ORDER BY
    `cust_id` 
```

# opengl - 如何将纹理复制到 PyOpenGL 中的 pbo 中？

> ID：10507215
> 
> 赞同：3
> 
> 时间：2012-05-08T22:03:22.347
> 
> 标签：opengl, textures, pyopengl, pbo

在愉快地使用 PyOpenGL 一段时间后，我现在严重卡住了。我正在开发一个 Python 包，它允许我使用 GLSL 着色器和 OpenCL 程序进行图像处理，使用纹理作为将我的数据进出 GLSL 着色器和 OpenCL 程序的标准化方式。

一切正常，除了我无法成功将纹理复制到 pbo（像素缓冲区对象）中。我正在使用 pbo 将我的纹理数据输入/输出 OpenCL，这在 PyOpenCL 中运行良好且快速：我可以将我的 OpenCL 输出从它的 pbo 复制到纹理并显示它，我还可以将数据从 cpu 加载到一个公益组织。但是我绝望地试图用 GPU 上已经存在的纹理数据填充我的 pbo，这是我需要做的才能将 GLSL 着色器生成的图像加载到 OpenCL 中以进行进一步处理。

我已经阅读了两种方法：变体 1 绑定 pbo，绑定纹理并使用 glGetTexImage() 变体 2 将纹理附加到帧缓冲区对象，绑定 fbo 和 pbo 并使用 glReadPixels()

我还读到 glReadPixels() 和 glGetTexImage() 的 PyOpenGL 版本在绑定 pbo 时应该使用的“空”指针有问题，因此我使用的是 OpenGL.raw.GL 变体。

但在这两种情况下，我都会收到“无效操作”错误，我真的看不出我做错了什么。下面是我的pixelbuffer Python类的load_texture()方法的两个版本，我希望我没有把它们剥离得太远......

变体1：

```
 def _load_texture(self, texture):
        glBindBuffer(GL_PIXEL_PACK_BUFFER_ARB, self.id)
        glEnable(texture.target)
        glActiveTexture(GL_TEXTURE0_ARB)
        glBindTexture(texture.target, texture.id)
        OpenGL.raw.GL.glGetTexImage(texture.target, 0, texture.gl_imageformat,
                                    texture.gl_dtype, ctypes.c_void_p(0))
        glBindBuffer(GL_PIXEL_PACK_BUFFER_ARB, 0)
        glDisable(texture.target) 
```

变体 2：

```
 def _load_texture(self, texture):
        fbo = FrameBufferObject.from_textures([texture])
        glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0,
        texture.target, texture.id, 0)
        glReadBuffer(GL_COLOR_ATTACHMENT0)
        glBindFramebuffer(GL_FRAMEBUFFER, fbo.id)
        glBindBuffer(GL_PIXEL_PACK_BUFFER, self.id)
        OpenGL.raw.GL.glReadPixels(0, 0, self.size[0], self.size[1],
                                   texture.gl_imageformat, texture.gl_dtype,  
                                   ctypes.c_void_p(0))
        glBindBuffer(GL_PIXEL_PACK_BUFFER, 0)
        glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0,
                               GL_TEXTURE_RECTANGLE_ARB, 0, 0)
        glBindFramebuffer(GL_FRAMEBUFFER, 0) 
```

编辑（添加一些关于我的 pbo 的错误和初始化的信息）：

我得到的变体 1 的错误是：

```
OpenGL.error.GLError: GLError(
    err = 1282,
    description = 'invalid operation',
    baseOperation = glGetTexImage,
    cArguments = (
        GL_TEXTURE_RECTANGLE_ARB,
        0,
        GL_RGBA,
        GL_UNSIGNED_BYTE,
        c_void_p(None),
    ) 
```

我正在像这样初始化我的 pbo：

```
 self.usage = usage
    if isinstance(size, tuple):
        size = size[0] * size[1] * self.imageformat.planecount
    bytesize = self.imageformat.get_bytesize_per_plane() * size
    glBindBuffer(self.arraytype, self.id)
    glBufferData(self.arraytype, bytesize, None, self.usage)
    glBindBuffer(self.arraytype, 0) 
```

'self.arraytype' 是 GL_ARRAY_BUFFER, self.usage 我已经尝试了所有可能性以防万一，但 GL_STREAM_READ 似乎最适合我的使用类型。我通常使用的大小是 1024 x 1024，4 个平面，每个平面 1 个字节，因为它是无符号整数。这在从主机传输像素数据时效果很好。

我也在 Kubuntu 11.10 上，使用 NVIDIA GeForce GTX 580，GPU 上有 3Gb 内存，使用专有驱动程序，版本 295.33

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T01:24:14.647

我自己找到了一个解决方案，但并没有真正理解它为什么会产生如此巨大的差异。

我拥有的代码（对于两种变体）基本上是正确的，但需要在那里调用 glBufferData 才能工作。在我的原始代码中初始化我的 pbo 时，我已经进行了*相同*的调用，但我的猜测是，在初始化和我尝试加载纹理之间发生了足够的事情，导致 pbo 内存在此期间以某种方式被取消分配。

现在我只将该调用移近我的 glGetTexImage 调用，它可以在不更改任何其他内容的情况下工作。

奇怪，我不确定这是一个错误还是一个功能，如果它与 PyOpenGL、NVIDIA 驱动程序或其他东西有关。如果它是预期的行为，它肯定没有记录在任何容易找到的地方。

下面的变体 1 代码可以工作并且速度也非常快，当以相同的方式处理时，变体 2 也可以正常工作，但速度大约只有一半。

```
def _load_texture(self, texture):
    bytesize = (self.size[0] * self.size[1] *
                self.imageformat.planecount *
                self.imageformat.get_bytesize_per_plane())
    glBindBuffer(GL_PIXEL_PACK_BUFFER_ARB, self.id)
    glBufferData(GL_PIXEL_PACK_BUFFER_ARB,
                 bytesize,
                 None, self.usage)
    glEnable(texture.target)
    glActiveTexture(GL_TEXTURE0_ARB)
    glBindTexture(texture.target, texture.id)
    OpenGL.raw.GL.glGetTexImage(texture.target, 0, texture.gl_imageformat,
                                texture.gl_dtype, ctypes.c_void_p(0))
    glBindBuffer(GL_PIXEL_PACK_BUFFER_ARB, 0)
    glDisable(texture.target) 
```

# meteor - Meteor collection.insert 回调问题

> ID：10507216
> 
> 赞同：8
> 
> 时间：2012-05-08T22:03:22.897
> 
> 标签：meteor

根据 Meteor 文档....

> `collection.insert(doc, [callback])`
> 
> **回调**函数
> 
> 选修的。如果存在，则使用错误对象作为第一个参数和 _id 作为第二个参数调用。

……然后再下来……

> 在服务器上，如果您不提供回调，则插入块，直到数据库确认写入，或者如果出现问题则抛出异常。如果您确实提供了回调，则 insert 立即返回。插入完成（或失败）后，将使用错误和结果参数调用回调，与方法相同。

它是哪个，错误和_id或错误和结果？我确实有 Meteor.methods 正确触发他们的回调并出现错误，结果可用于范围。

我只是无法让回调在 collection.insert(doc, [callback]) 上正常工作

无论哪种方式，我都无法让我的回调注册任何东西？

```
function insertPost(args) {
  this.unblock;
  if(args) { 
    post_text = args.text.slice(0,140);
    var ts = Date.now();  
    Posts.insert({
      post: post_text,
      created: ts
    }, function(error, _id){
      // or try function(error, result) and still get nothing 
      // console.log('result: ' + result);
      console.log('error: ' + error);
      console.log('_id: ' + _id); //this._id doesn't work either
    });

  }
  return;
} 
```

我究竟做错了什么？我从凌晨 2 点开始编码......我的时区下午 6 点......我很模糊，所以我可能（可能）遗漏了一些非常明显的东西。

干杯斯蒂夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T10:30:17.910

由于这是服务器端代码，您可以这样做：

```
var id = Posts.insert({data}); // will block until insert is complete 
```

并且 id 将可用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-09T18:41:31.313

这是一个错误，在下一个版本中修复。现在，如果您向 提供回调`insert`，它将使用`error`和`result`参数调用，其中`result`是新文档的 ID，如果出现错误，则返回 null。

# php - 从会话 PHP 中获取价值

> ID：10507217
> 
> 赞同：0
> 
> 时间：2012-05-08T22:03:25.683
> 
> 标签：php, session, session-variables, sessionid

我不确定为什么会话中没有返回变量用户名。当用户登录时，我开始会话：

```
$username = trim($_POST['username']);
if(!isset($_SESSION)){ session_start(); }
$_SESSION[$this->GetLoginSessionVar()] = $username; 
```

在用户的欢迎页面上，当我运行 echo 命令时，我看到返回了正确的变量。但我不确定为什么 return 语句不起作用。我的 PHP 文件中有以下内容：

```
function UserName()
{

    return  isset($_SESSION['name_of_user']) ? $_SESSION['name_of_user'] : "Unknown User" ;
    //echo $_SESSION['name_of_user'];
} 
```

在我的 html 中，我有：

```
Welcome back <?PHP $fgmembersite->UserName(); ?>! 
```

我还检查了会话 ID，它也正在正确生成。你能帮我理解我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T22:07:43.343

是`fgmembersite`一个对象并且有它调用的函数`UserName`吗？

如果是，你只是错过了一个`echo`

```
<?PHP echo $fgmembersite->UserName(); ?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T22:11:05.247

您必须添加 echo 或 print 所以应该是这样的；

```
<?PHP echo $fgmembersite->UserName(); ?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T22:07:53.230

你需要打印出你的变量。采用

`Echo`或者`print`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-08T22:07:59.047

可能您应该添加输出：

```
<?php print $fgmembersite->UserName(); ?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-09T19:01:23.767

如果您使用的是我认为您正在使用的脚本，您需要查看 fg_membersite.php 中的行：

```
function CheckLoginInDB($username,$password) 
```

在该行中，您应该有一个 MySQL 语句：

```
$qry = "SELECT etc... 
```

当我尝试添加 UserAvatar 时，我可以通过将其添加到那个 MySQL 字符串来做到这一点。

附带说明一下，我在添加用户名时也遇到了麻烦，对于我的生活，我无法弄清楚为什么它的工作方式与我以前的解决方法有什么不同，但不知何故，但我仍然相信其中的一些东西文件最终会成功。

编辑：

好的，我明白了，只需这样做：

echo $fgmembersite->用户名（$用户名）；

用户名将立即弹出。我不知道为什么，我不知道足够的 php 来解释它，但我只能假设这会让你继续前进。

# python - 用Python在文件中间插入行？

> ID：10507230
> 
> 赞同：81
> 
> 时间：2012-05-08T22:04:52.980
> 
> 标签：python

有没有办法做到这一点？假设我有一个文件是这样的名称列表：

1.  阿尔弗雷德
2.  账单
3.  唐纳德

我如何在第 x 行（在本例中为 3）插入第三个名字“查理”，并自动将所有其他人发送到一行？我见过其他类似的问题，但他们没有得到有用的答案。可以做到吗，最好用方法或循环？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-05-08T22:10:20.563

这是一种方法。

```
with open("path_to_file", "r") as f:
    contents = f.readlines()

contents.insert(index, value)

with open("path_to_file", "w") as f:
    contents = "".join(contents)
    f.write(contents) 
```

`index`和`value`是您选择的行和值，行从 0 开始。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2015-10-20T14:38:38.187

如果您想在文件中搜索子字符串并将新文本添加到下一行，其中一种优雅的方法如下：

```
import fileinput
for line in fileinput.FileInput(file_path,inplace=1):
    if "TEXT_TO_SEARCH" in line:
        line=line.replace(line,line+"NEW_TEXT")
    print line, 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-06-02T22:55:43.437

我发现有一种技术组合对解决这个问题很有用：

```
with open(file, 'r+') as fd:
    contents = fd.readlines()
    contents.insert(index, new_string)  # new_string should end in a newline
    fd.seek(0)  # readlines consumes the iterator, so we need to start over
    fd.writelines(contents)  # No need to truncate as we are increasing filesize 
```

在我们的特定应用程序中，我们想在某个字符串之后添加它：

```
with open(file, 'r+') as fd:
    contents = fd.readlines()
    if match_string in contents[-1]:  # Handle last line to prevent IndexError
        contents.append(insert_string)
    else:
        for index, line in enumerate(contents):
            if match_string in line and insert_string not in contents[index + 1]:
                contents.insert(index + 1, insert_string)
                break
    fd.seek(0)
    fd.writelines(contents) 
```

如果您希望它在匹配的每个实例之后插入字符串，而不仅仅是第一个，请删除`else:`（并且正确地取消缩进）和`break`.

另请注意，`and insert_string not in contents[index + 1]:`防止它在 之后添加多个副本`match_string`，因此重复运行是安全的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-05-08T22:13:34.597

您可以将数据读入列表并将新记录插入您想要的位置。

```
names = []
with open('names.txt', 'r+') as fd:
    for line in fd:
        names.append(line.split(' ')[-1].strip())

    names.insert(2, "Charlie") # element 2 will be 3\. in your list
    fd.seek(0)
    fd.truncate()

    for i in xrange(len(names)):
        fd.write("%d. %s\n" %(i + 1, names[i])) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-06-13T22:13:03.423

接受的答案必须将整个文件加载到内存中，这对于大文件来说效果不佳。以下解决方案将插入右行的新数据的文件内容写入同一目录中的临时文件（因此在同一文件系统上），一次只从源文件中读取小块。[然后它以一种有效](https://docs.python.org/3.8/library/shutil.html#platform-dependent-efficient-copy-operations)的方式（Python 3.8+）用临时文件的内容覆盖源文件。

```
from pathlib import Path
from shutil import copyfile
from tempfile import NamedTemporaryFile

sourcefile = Path("/path/to/source").resolve()
insert_lineno = 152  # The line to insert the new data into.
insert_data = "..."  # Some string to insert.

with sourcefile.open(mode="r") as source:
    destination = NamedTemporaryFile(mode="w", dir=str(sourcefile.parent))
    lineno = 1

    while lineno < insert_lineno:
        destination.file.write(source.readline())
        lineno += 1

    # Insert the new data.
    destination.file.write(insert_data)

    # Write the rest in chunks.
    while True:
        data = source.read(1024)
        if not data:
            break
        destination.file.write(data)

# Finish writing data.
destination.flush()
# Overwrite the original file's contents with that of the temporary file.
# This uses a memory-optimised copy operation starting from Python 3.8.
copyfile(destination.name, str(sourcefile))
# Delete the temporary file.
destination.close() 
```

编辑 2020-09-08：我刚刚[在 Code Review 上找到了一个答案，该答案](https://codereview.stackexchange.com/a/238038/1205470)与上面类似，但有更多解释——它可能对某些人有用。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-05-08T22:10:10.357

1.  `file.readlines()`使用或将文件解析为 python 列表`file.read().split('\n')`
2.  根据您的标准，确定必须插入新行的位置。
3.  使用 插入一个新的列表元素`list.insert()`。
4.  将结果写入文件。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-05-09T01:27:50.790

您没有向我们展示输出应该是什么样子，因此一种可能的解释是您希望将其作为输出：

1.  阿尔弗雷德
2.  账单
3.  查理
4.  唐纳德

（插入 Charlie，然后将 1 添加到所有后续行。）这是一种可能的解决方案：

```
def insert_line(input_stream, pos, new_name, output_stream):
  inserted = False
  for line in input_stream:
    number, name = parse_line(line)
    if number == pos:
      print >> output_stream, format_line(number, new_name)
      inserted = True
    print >> output_stream, format_line(number if not inserted else (number + 1), name)

def parse_line(line):
  number_str, name = line.strip().split()
  return (get_number(number_str), name)

def get_number(number_str):
  return int(number_str.split('.')[0])

def format_line(number, name):
  return add_dot(number) + ' ' + name

def add_dot(number):
  return str(number) + '.'

input_stream = open('input.txt', 'r')
output_stream = open('output.txt', 'w')

insert_line(input_stream, 3, 'Charlie', output_stream)

input_stream.close()
output_stream.close() 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-02-05T12:55:05.603

一个简单但效率不高的方法是读取整个内容，更改它然后重写它：

```
line_index = 3
lines = None
with open('file.txt', 'r') as file_handler:
    lines = file_handler.readlines()

lines.insert(line_index, 'Charlie')

with open('file.txt', 'w') as file_handler:
    file_handler.writelines(lines) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-10-21T05:55:27.750

```
location_of_line = 0
with open(filename, 'r') as file_you_want_to_read:
     #readlines in file and put in a list
     contents = file_you_want_to_read.readlines()

     #find location of what line you want to insert after
     for index, line in enumerate(contents):
            if line.startswith('whatever you are looking for')
                   location_of_line = index

#now you have a list of every line in that file
context.insert(location_of_line, "whatever you want to append to middle of file")
with open(filename, 'w') as file_to_write_to:
        file_to_write_to.writelines(contents) 
```

这就是我最终获得要插入文件中间的任何数据的方式。

这只是伪代码，因为我很难清楚地了解正在发生的事情。

基本上你读入整个文件并将其添加到一个列表中，然后将你想要的行插入到该列表中，然后重新写入同一个文件。

我相信有更好的方法可以做到这一点，可能效率不高，但至少对我来说更有意义，我希望对其他人有意义。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2019-07-16T18:26:40.603

对于您自己创建原始文件并且碰巧知道插入位置的特殊情况，下面是一个稍微尴尬的解决方案（例如，您提前知道需要在第三行之前插入带有附加名称的行，但在您获取并写下其余名称之前不会知道名称）。我认为，按照其他答案中的描述，读取、存储然后重写文件的全部内容比这个选项更优雅，但对于大文件来说可能是不可取的。

您可以在插入位置留下一个不可见空字符 ('\0') 的缓冲区，以便稍后覆盖：

```
num_names = 1_000_000    # Enough data to make storing in a list unideal
max_len = 20             # The maximum allowed length of the inserted line
line_to_insert = 2       # The third line is at index 2 (0-based indexing)

with open(filename, 'w+') as file:
    for i in range(line_to_insert):
        name = get_name(i)                    # Returns 'Alfred' for i = 0, etc.
        file.write(F'{i + 1}. {name}\n')

    insert_position = file.tell()             # Position to jump back to for insertion
    file.write('\0' * max_len + '\n')         # Buffer will show up as a blank line

    for i in range(line_to_insert, num_names):
        name = get_name(i)
        file.write(F'{i + 2}. {name}\n')      # Line numbering now bumped up by 1.

# Later, once you have the name to insert...
with open(filename, 'r+') as file:            # Must use 'r+' to write to middle of file 
    file.seek(insert_position)                # Move stream to the insertion line
    name = get_bonus_name()                   # This lucky winner jumps up to 3rd place
    new_line = F'{line_to_insert + 1}. {name}'
    file.write(new_line[:max_len])            # Slice so you don't overwrite next line 
```

不幸的是，没有办法删除任何没有被覆盖的多余空字符（或者通常是文件中间任何位置的任何字符），除非您随后重写所有内容。但是空字符不会影响您的文件对人类的外观（它们的宽度为零）。

# windows-7 - 如何写入公共应用程序数据文件夹？

> ID：10507233
> 
> 赞同：4
> 
> 时间：2012-05-08T22:05:17.630
> 
> 标签：windows-7, vb6, windows-xp, appdata, userappdatapath

我有一个要为*All Users*安装的 Visual Basic 6.0 应用程序，例如，无论谁登录计算机，该设置都保存在一个位置。我有以下代码来定位公共位置：

```
Const ssfCOMMONAPPDATA = &H23
Dim strAllUsersPath As String

strAllUsersPath = CreateObject("Shell.Application").NameSpace(ssfCOMMONAPPDATA).Self.Path 
```

在 Windows XP 上，此路径指向`C:\Documents and Settings\All Users\Application Data\`文件夹。设置将设置文件复制到那里，一切都很好。Visual Basic 6.0 应用程序可以随时更改它。

在 Windows 7 上，此路径指向`c:\ProgramData`文件夹。需要管理员权限的设置将文件复制到那里。但是，当我的 Visual Basic 6.0 应用程序启动并访问该文件时，Windows 7 会将设置文件复制到 C:\Users{USER LOGIN}\AppData\Local\VirtualStore\ 并在那里执行所有操作。结果，因为对于每个用户，Windows 7 将设置文件复制到单独的用户目录，用户最终拥有不同的设置文件。

我是否将文件存储在错误的位置？我是否以不正确的方式进行操作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-08T22:23:55.420

这个也咬过我。该`ProgramData`文件夹具有共享读取访问权限，没有共享写入访问权限。您当然可以在安装过程中更改文件夹的权限，但我认为这与微软的意图相反。请参阅[其他问题](https://stackoverflow.com/questions/131666/vista-and-programdata)以获取一些有用的链接

[微软认为应该怎么做。](http://www.microsoft.com/en-us/download/details.aspx?id=3859)

# php - 对包含 12 个 php 变量的表进行排序，并将行限制为页面加载时的最低 5 行

> ID：10507235
> 
> 赞同：0
> 
> 时间：2012-05-08T22:05:36.120
> 
> 标签：php, html-table, jquery-ui-sortable

前几天我问了这个问题，但我删除了它，因为我太模糊了，所以这里有更详细的信息，希望有人能提供帮助。对不起，如果解释很长，但我想确保这次有意义。

我有一个健身网站，显示人们在 drupal 上运行的健身测试的分数，所以我使用的是 mysql 和 php。

该网站还有一个名为`Trianables`. 可训练是您可以锻炼的东西，例如速度和力量，它们将帮助您在运动中变得更好。共有12个可训练对象。

您对每个可训练项都有一个分数，该分数由 php 代码计算，该代码从数据库中选择 1 个或多个体能测试结果（取决于可训练项），计算您与数据库中其他运动员相比的排名，将该计算放入一个数字中1-5，其中 1 是最低 20% 的运动员，5 是前 20% 的运动员，然后将此数字存储在 php 变量中，以便我可以将其放置在页面的不同区域。我通常使用这样的代码对图像执行此操作

```
echo "<img src='http://example.com/images/score$Balance.png'>"; 
```

这个例子会给我一个名为 score4.png 的图像。我有 score1.png-score5.png

**我在页面内的不同选项卡上显示可训练分数，但我想做的是在第一个选项卡上显示他们得分最低的 5 个可训练项（如 1 和 2），并为每个选项显示一个练习，以便他们可以看到5个最重要的练习来改进。**

**这将需要一个脚本，该脚本包含所有 12 个变量（每个可训练变量 1 个），将它们从最低数字排列到最高数字，然后仅输出最低的 5 个变量。**

使用数组执行此操作的最佳方法是什么？我已经想出如何使用数组来按顺序使用此代码吐出最低的 5 个数字

```
<?php

$worsttrains=array($trainable1, $trainable2, $trainable3, $trainable4, $trainable5, $trainable6, $trainable7, $trainable8, $trainable9, $trainable10, $trainable11, $trainable12);

asort($worsttrains, SORT_NUMERIC);
$worst5trains=array_slice($worsttrains, 0, 5, true);

foreach ($worst5trains as $a)

echo " ".$a ;

echo "<br>";

?> 
```

最后，我想我希望数据以表格格式显示，如下面的代码，但我需要一个代码，它按分数列中的变量排序，它需要在其行中携带其他信息（可训练和练习），只能显示变量最低的 5 行。这可以通过数组实现还是我需要查看 jquery 之类的东西？

```
<table>
 <tr>
  <th>Trainable</th>
  <th>Score</th>
  <th>Exercise</th>
</tr>
<tr>
 <td>Balance</td>
 <td>$balance</td>
 <td>Balance Board Squat</td>
</tr>
<tr>
 <td>Lower Strength</td>
 <td>$lowerstrength</td>
 <td>Squats</td>
</tr>
<tr>
 <td>Lower Power</td>
 <td>$lowerpower</td>
 <td>Forward Jump Squats</td>
</tr>
<tr>
 <td>Lower Quickness</td>
 <td>$lowerquickness</td>
 <td>Skater Hop</td>
</tr>
<tr>
 <td>Reaction Time</td>
 <td>$reactiontime</td>
 <td>4 Corner Listen</td>
</tr>
<tr>
 <td>Brakes</td>
 <td>$brakes</td>
 <td>Monger Hop</td>
</tr>
<tr>
 <td>Upper Quickness</td>
 <td>$upperquickness</td>
 <td>Light Ball Toss</td>
</tr>
</table> 
```

如果这比在表格中更容易，我也可以使用 div。

如果您需要澄清，我希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T08:44:20.757

我认为这就是你要找的：

```
<?php
$arr = array(
   array(0 => "trainable",1=>100,2=>"exercise"),
   array(0 => "balance",1=>50,2=>"balance board squat"),
   array(0 => "lower strength",1=>200,2=>"squats")
);

foreach ($arr as $key => $row) {
    $score[$key]  = $row[1];
}

array_multisort($score, SORT_ASC, $arr);

print_r($arr);
?> 
```

输出：

```
Array
(
    [0] => Array
        (
            [0] => balance
            [1] => 50
            [2] => balance board squat
        )

    [1] => Array
        (
            [0] => trainable
            [1] => 100
            [2] => exercise
        )

    [2] => Array
        (
            [0] => lower strength
            [1] => 200
            [2] => exercise
        )

) 
```

您可以根据需要拼接，然后您可以打印表格。当然，您可以扩展初始数组 ( `$arr`) 以包含 12 个练习，或者如果您愿意，可以更多。

# python - 爬取网站搭建货币兑换字典

> ID：10507236
> 
> 赞同：0
> 
> 时间：2012-05-08T22:05:36.740
> 
> 标签：python

我需要为美元建立一个货币字典，它看起来像这样：

```
exchange_rates = {'USD': 1.00000,
                  'EUR': 1.32875,
                  'GBP': 1.56718, ...} 
```

我需要获得大约 15 种货币，并且**我需要每天构建这个字典**。以前有人这样做过吗，他们可以在哪里向我展示他们正在使用的脚本/他们正在抓取的网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:13:23.077

检查此 API： http: [//openexchangerates.org/documentation/](http://openexchangerates.org/documentation/)

# google-maps - 查找带有地理编码地址的 Fusion Table 条目

> ID：10507237
> 
> 赞同：2
> 
> 时间：2012-05-08T22:05:39.307
> 
> 标签：google-maps, google-fusion-tables

我有一个 Fusion Tables 表，其中包含明尼苏达州所有国会选区的位置[数据](https://www.google.com/fusiontables/DataSource?snapid=S488484plf1)。

我想让用户输入她的地址，让 Google Maps API 对其进行地理编码，然后从表格中吐出她居住的地区。

我曾希望我可以通过`orderBy: ST_DISTANCE`在查询中使用来选择最近的地区。但是，这并不总是返回地址实际所在的地区。例如：http: [//jsfiddle.net/2vGSB/](http://jsfiddle.net/2vGSB/)

假设甚至有可能，我如何返回一组坐标所在的区域？

**编辑**

在深入研究文档后，我发现`where: ST_INTERSECTS`. 它似乎正在做我需要的事情：http: [//jsfiddle.net/DY49c/](http://jsfiddle.net/DY49c/)

# django - 扩展 django-registration RegisterForm 类的正确方法

> ID：10507238
> 
> 赞同：2
> 
> 时间：2012-05-08T22:05:41.577
> 
> 标签：django, django-forms, django-registration

所以我有 django 注册，并且我想扩展表单的验证以禁止在电子邮件已在使用的情况下进行注册 - 这样做的方法是什么？

我有这个（嗯，我真的没有。我的笔记本电脑被我的 gf 征用在 hulu 上观看 The Voice，所以这个来自记忆和我的 ipad）：

```
import django-registration.registrationForm

class customRegistrationForm(form.RegistrationForm):
    def clean_email(self):
        #check here like the one for username! 
```

我可以这样做吗？另外，我应该把这个自定义表格贴在哪里？我假设我没有把它放在 django-registration 文件夹中，所以在我的应用程序文件夹中......我是“打算”把它放在一个特定的文件夹中吗？如果我只是将它粘贴在基本 app_name 文件夹中并调用 customRegistrationForm，这有关系吗？

干杯! 安德鲁

更新

好的，所以我已经解决了要在 django 中“覆盖”内容，我需要将类放在**init** .py 中，并且如果我想拾取一个子文件夹，它需要它自己的**init** .py 文件

“文件夹” **init** .py 文件可以为空

不知道为什么会这样，大概是 python 的东西？另外，不确定我是否可以在文件夹中的单独文件中包含 customRegisterForm.py，或者它是否*需要*在**init** .py中

无论如何，接下来是覆盖似乎并不像我想象的那样起作用。

在 Java 中，当我扩展一个类时，可以访问所有类的非私有成员，并且它们的行为与父类中定义的完全一样。在 django 中，我得到了很多

> “customRegistrationForm”对象没有属性“get_form_class”

或我没有明确创建的方法的名称......我在覆盖中遗漏了什么吗？

更新更新

我复制了第二个例子

> [http://pbjots.blogspot.com/2012/01/customising-django-registration-no.html](http://pbjots.blogspot.com/2012/01/customising-django-registration-no.html)

这是一种享受。仍然不确定为什么扩展不能保留所有这些方法，或者我是否只是通过盲目复制代码而*破坏*了某些东西——有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T14:30:10.183

查看*RegistrationFormUniqueEmail*表单。它是 django-registration 的内置类，可以完成工作

```
from registration.forms import RegistrationFormUniqueEmail 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T02:35:04.193

要扩展注册表以包含电子邮件，您首先需要扩展**UserCreationForm**以包含电子邮件字段。您可以创建一个名为 forms.py 的文件来包含该特定应用程序所需的所有表单，但根据我的经验，您不必经常使用**init.py**。

以下是如何扩展注册表单以包含电子邮件的示例：

```
from django.contrib.auth.forms import UserCreationForm
from django import forms
from django.contrib.auth.models import User

class RegisterForm(UserCreationForm):
    email = forms.EmailField(label="E-Mail")    

    class Meta:
        model = User
        fields = ("username", "email", )

    def clean_email(self):
        email = self.cleaned_data["email"]

        try:
        User.objects.get(email=email)
        except User.DoesNotExist:
        return email

        raise forms.ValidationError("A user with that email address already exists.") 
```

看看这个 Django 教程，它很好地概述了这个过程。 [https://docs.djangoproject.com/en/1.4/intro/tutorial01/](https://docs.djangoproject.com/en/1.4/intro/tutorial01/)

# ios - 几个本地化版本仍然只显示英文

> ID：10507240
> 
> 赞同：1
> 
> 时间：2012-05-08T22:05:51.607
> 
> 标签：ios, xcode, localization

我决定使用相同的代码库将我的几个项目合并到一个项目中，并为我的应用程序的不同版本使用不同的目标。

我的应用程序被翻译成 7 种语言，默认为英语。其他语言是：瑞典语、荷兰语、德语、法语、波兰语和西班牙语。之前的翻译工作就像一个魅力。我正在使用`NSLocalizedString`并`Localizable.strings`翻译了我的。但是，现在我将我的项目合并在一起，并添加了`InfoPlist.strings`文件，应用程序坚持使用默认文本（英文）。当我启动应用程序并得到“共享位置”问题时，我得到的是本地化语言的问题（所以操作系统确实得到了本地化），但应用程序的其余部分仍然是英文的。

文件翻译正确，没有错误。我测试了几种语言，但都是英文的。如果我将其设置`CFBundleDevelopmentRegion`为 eg `Swedish`，则整个应用程序都是瑞典语。所以本地化工作，但应用程序忽略系统设置。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T20:35:41.533

我找到了我的问题的答案。我有几个字符串文件，一个用于我的应用程序翻译，一个用于每个调用的目标，`InfoPlist.strings`其中只包含本地化的应用程序名称。这些不能包含在其中，因为每个目标的这些都是不同的。`CFBundleDisplayName``CFBundleName``Localizable.strings`

我`InfoPlist.strings`从我的项目中删除了这些文件，现在该应用程序再次本地化。

# mysql - 多对多关系：选择不属于特定球队的球员

> ID：10507245
> 
> 赞同：1
> 
> 时间：2012-05-08T22:06:03.640
> 
> 标签：mysql, sql, group-by, left-join

我尝试对此进行研究，但不确定要搜索什么。我有一个`players`表和一个团队表和一个链接器表。一名球员可以在多支球队。

我需要选择所有不在 XYZ 队中的球员。

我试过了：

```
SELECT * FROM players LEFT JOIN linker ON players.playerID = linker.playerID
WHERE NOT linker.teamID = 'XYZ' 
```

但随后一名球员被多次返回，我得到误报（假设球员在 XYZ、ABC 和 LMNOP 团队中 - 该球员被返回两次）。

我试过使用`GROUP BY players.playerID`which 来处理重复项。但后来我得到了误报，XYZ 上的玩家出现在列表中。

我确定我缺少一些东西。

（PS我需要这个的原因是建立一个可以加入球队的球员列表，即尚未加入球队的球员。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:09:26.710

使用`NOT IN`：

```
SELECT * 
FROM players 
WHERE playerID NOT IN
      ( SELECT playerID  
        FROM linker 
        WHERE teamID = 'XYZ'
      ) 
```

* * *

使用`LEFT JOIN - IS NULL`，您的尝试更正：

```
SELECT players.* 
FROM players 
  LEFT JOIN linker 
    ON  linker.playerID = players.playerID 
    AND linker.teamID = 'XYZ'
WHERE linker.playerID IS NULL 
```

* * *

使用`NOT EXISTS`：

```
SELECT * 
FROM players 
WHERE NOT EXISTS
      ( SELECT *
        FROM linker 
        WHERE linker.playerID = players.playerID 
          AND linker.teamID = 'XYZ'
      ) 
```

# java - Java-NIO：将 FileChannel.read() 与 offset-address / NullPointer 一起使用

> ID：10507247
> 
> 赞同：0
> 
> 时间：2012-05-08T22:06:05.007
> 
> 标签：java, nio, offset, filechannel

有谁知道如何使用`FileChannel.read(ByteBuffer[],int,int)`java-NIO 的 -method 来读取文件的某个部分？

```
ByteBuffer[] bb = new ByteBuffer[(int) fChannel.size()];
fChannel.read(bb, offsetAddress, endAddress); 
```

尝试执行 read() 方法时抛出 NullPointer。缓冲区应该足够大，offsetAddress 为 0，endAddress 255，文件大小远不止于此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:08:02.033

您正在创建一个数组，但您没有在其中放入任何内容。

也许是这样的：

```
ByteBuffer[] bb = new ByteBuffer[(int) fChannel.size()];
bb[0] = ByteBuffer.allowcate(1024);
bb[1] = ByteBuffer.allowcate(1024);
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-17T17:45:37.427

您将一个空数组传递给该方法，因此读取会引发 NPE，因为没有要读取的缓冲区。

但似乎你做错了， FileChannel.read(ByteBuffer[],int,int) 方法应该执行“分散读取”，其中来自文件通道的数据被顺序读取到一系列缓冲区，例如将文件头和正文从文件读取到不同的缓冲区：

```
ByteBuffer header = ByteBuffer.allocate( headerLength );
ButeBuffer body = ByteBuffer.allocate( bodyLength );
FileChannel ch = FileChannel.open( somePath );
ch.read( new ByteBuffer[]{ header, body }, dataOffset, headerLength + bodyLength ); 
```

将使用第一个 headerLength 字节填充标头，并使用以下 bodyLength 字节填充正文。

如果您只想将文件中的字节读取到缓冲区中（这似乎是 OP 想要的），您应该使用 FileChannel.read(ByteBuffer,long) 方法，该方法将读取与剩余字节一样多的字节给定的缓冲区：

```
ByteBuffer bb = ByteBuffer.allocate( bytesToRead );
FileChannel ch = FileChannel.open( somePath );
ch.read( bb, dataOffset ); 
```

# licensing - Rhino 许可证 - 防止多个试用期

> ID：10507248
> 
> 赞同：3
> 
> 时间：2012-05-08T22:06:12.637
> 
> 标签：licensing, time-trial, rhino-licensing

我们正在向任何在 .NET 桌面应用程序中成功实施 Rhino Licensing 的人寻求建议。我们已按照以下说明成功地将 Rhino Licensing 集成到我们的 C# Winforms 应用程序中；

[犀牛授权](http://www.jagregory.com/writings/rhino-licensing/)

目前，打开我们软件的唯一方法是将其链接到有效的许可证文件。我们计划向所有请求试用的用户颁发试用许可证（30 天后到期），但问题是我们如何制定一个计划，防止用户在每次许可证到期时获得新的试用/演示许可证。从理论上讲，这将使他们能够在多个试用期许可我们的软件，这可能是不可避免的。

我的担忧与试用许可证问题有关。我们最初考虑根据生成原始许可证时提供的电子邮件地址来限制试用许可证的问题，但现在用户可以使用临时收件箱电子邮件帐户注册无限数量的许可证。

您采用了哪些方法来防止用户在初始期限到期后重新获得试用/演示许可证？请假设在用户注册试用许可证后，原始许可证会自动从服务器提供给用户。

欢迎所有想法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T01:17:22.310

您可以创建一个唯一的硬件 ID，该 ID 在用户“激活”许可证并保存时发送到服务器。

如果用户请求新的试用版并尝试激活它，服务器将响应指示硬件 ID 已存在于数据库中并撤销许可证。

# php - 来自多个 URL 的 PHP 页面引用检查

> ID：10507250
> 
> 赞同：-1
> 
> 时间：2012-05-08T22:06:21.263
> 
> 标签：php, database, reference

我有一个 php 脚本，可以限制人们在我的网站上下载内容的次数。我通过谷歌搜索找到了这个脚本，并对其进行了一些修改以使其适合我。

问题是我对php一无所知。脚本的第一部分检查引用页面。当我复制 php 脚本时，它被设置为检查单个 URL。我的问题是我想从多个页面引用php脚本，因为一个页面上有flash，而我为没有flash的手机创建的另一个页面。因此，该链接仅适用于一个页面 - 带有我在脚本中替换的 url 的页面。

我的问题是，在参考检查中包含多个 URL 的代码是什么？我不知道这是否非常简单，或者是否有可能。

下面是检查引用 URL 的 php 脚本部分，然后继续登录到 mySQL DB 开始下载。

```
$referer = $_SERVER['HTTP_REFERER'];

$keymatch= $_SESSION['key'];
$pass='key';
$md5value= md5($pass);

if (($referer=="my url containing php script link")&& ($keymatch==$md5value)) {

$username = "user";
$password = "password";
$hostname = "host";
$database = "database";
$dbhandle = mysql_connect($hostname, $username, $password)
or die("Unable to connect to MySQL");
$selected = mysql_select_db($database,$dbhandle)
or die("Could not select $database"); 
```

提前感谢您的帮助。

-理查德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:11:38.753

而不是在一个链接上检查引用匹配：

```
if (($referer=="my url containing php script link")... 
```

创建一个链接数组并与之匹配：

```
$referers = array('link1', 'link2','link3');
if((in_array($referer, $referers)... 
```

# html - CSS 菜单 CSS 混乱

> ID：10507253
> 
> 赞同：0
> 
> 时间：2012-05-08T22:06:26.737
> 
> 标签：html, css

我有以下 HTML，但我不确定如何对 CSS 进行编码，以便当我将鼠标悬停在主`li`菜单上时会显示下拉菜单。

```
 <li><a href="#">#</a>
            <ul class="sub_menu">
                <li><a href="#">#</a></li>
                <li><a href="#">#</a></li>
                <li><a href="#">#</a></li>
                <li><a href="#">#</li></li>
                </ul>
            </li>` 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T22:08:19.793

```
li ul {
    display: none;
}

li:hover ul {
    display: block;
} 
```

这在 IE6 中不起作用，但没有人再关心它了。

# c - 一个套接字多线程

> ID：10507255
> 
> 赞同：0
> 
> 时间：2012-05-08T22:06:42.033
> 
> 标签：c, sockets, protocols

我正在编写一个复杂的通信协议的一部分，以从单个计算机终端控制多个医疗设备。计算机终端需要管理大约20个这样的设备。每个设备都使用相同的协议进行通信，称为 DEP。现在，我创建了一个循环，该循环在不同设备中进行多路复用以发送请求并接收与特定设备关联的患者数据。所以这个循环的结构，一般来说，是这样的：

```
Begin Loop
   Select Device i
      if Device.Socket has Data
         Strip Header
         Copy Data on Queue
      end if

      rem_time = TIMEOUT - (CurrentTime - Device.Session.LastRequestTime)
      if TIMEOUT <= 0
         Send Re-association Request to Device
      else
         Sort Pending Request According to Time
         Select First Request
            Send the Request
            Set Request Priority Least
         end Select
      end if
   end Select
end Loop 
```

我可能在上面的伪代码中犯了一些错误，但我希望我已经清楚了这个循环试图做什么。我有选择设备的优先级列表结构和该设备的待处理请求，因此，所有请求和设备都以良好的最佳间隔选择。

我忘了说，上面的循环实际上并没有解析接收到的数据，但它只是剥离了标题并将其放入队列中。队列中的数据在不同的线程中解析并记录在文件或数据库中。

我希望添加一个功能，以便其他计算机也可以导入数据并远程控制连接到计算机终端的设备。为此，我需要创建一个套接字来监听这个无限循环中的命令，并在执行解析的不同线程中发送数据。

现在，我对所有并发专家的问题是：使用单个套接字在两个不同的线程中进行读写是一个好的设计吗？每个线程都将严格参与读取或写入，而不是两者。另外，我相信套接字在进程级别上是同步的，所以我需要锁来同步来自不同线程的一个套接字的读写吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:52:00.513

让多个线程处理一个套接字本身并没有错。然而，基于这一非常普遍的想法，有许多好的和坏的设计。如果您不想在编写应用程序时重新发现问题，我建议您四处寻找最适合您计划的特定数据包处理方式的设计。

让一个线程处理一个套接字也没有本质上的错误。但是，如果您将逻辑处理放在该线程上，那么您选择了错误的设计，因为该线程在最后一个请求上“工作”时无法处理请求。

在您的特定代码中，您可能会遇到问题。如果您的数据包支持分段，或者即使您的算法由于时间问题而稍微领先于硬件，您可能只是在缓冲区中“接收”了部分数据包。在这种情况下，您的算法将以两种方式失败。

1.  它将处理一个部分数据包，其中包含数据的第一部分。
2.  它将错误处理后续数据包，因为缓冲区中的信息不会以有效的数据包头开始。

在遇到此类故障之前，很难设想和诊断。也许您的库已经缓冲和拆分消息，也许没有。

简而言之，您的设计并不取决于有多少线程访问您的套接字：有多少线程访问您的套接字是由您的设计决定的。

# java - GridBagLayout - 一行的高度导致下一行的宽度发生变化

> ID：10507257
> 
> 赞同：2
> 
> 时间：2012-05-08T22:07:10.190
> 
> 标签：java, swing, awt, layout-manager, gridbaglayout

我正在处理的 UI 显示一个面板，允许用户选择电影并播放。有播放，暂停等控件。

布局似乎看起来像我想要的那样。该面板使用 GridBagLayout。第 2 行显示状态消息的文本区域，第 3 行显示带有按钮和进度条的面板。

我遇到的问题是，当文本区域中有太多文本行时，第 3 行中的按钮会环绕。这与外框的高度无关。

第 2 行的高度影响第 3 行的宽度。我不明白这种行为。我想知道是否有人可以告诉我我做错了什么以及如何解决？我附上了代码。

在一个稍微不同的主题上，如果您正在查看代码，您能否提出一种在最底部组件和最外层面板之间留出边距的方法？

预先感谢您的帮助。

问候，
彼得

```
 private static JButton CreateImageButton(String fileName) {
        JButton retVal = new JButton("xxx");
        return retVal;
    }

    public MoviePanel() {
        this.setLayout(new GridBagLayout());
        this.setBackground(Color.WHITE);

        JButton btnRefresh = CreateImageButton("refresh.png");
        GridBagConstraints c = new GridBagConstraints(); 
        c.gridx=0;
        c.gridy=0;
        c.fill = GridBagConstraints.NORTH;
        c.insets.left = 10; c.insets.right = 10; c.insets.top = 10;
        this.add(btnRefresh, c);

        JComboBox cbMovieList = new JComboBox();
        c = new GridBagConstraints();
        c.gridx = 1;
        c.gridy = 0;
        c.fill = GridBagConstraints.HORIZONTAL;
        c.insets.right = 10; c.insets.top = 10;
        c.weightx = 1.0;
        this.add(cbMovieList, c);

        JButton btnAuthorize = new JButton("Get Info");
        c = new GridBagConstraints();
        c.gridx = 1;
        c.gridy = 1;
        c.anchor = GridBagConstraints.WEST;
        c.insets.top = 10;
        this.add(btnAuthorize, c);

        JTextArea txtInfo = new JTextArea();
        txtInfo.setFont( new Font("SansSerif", Font.BOLD, 12));
        txtInfo.setBackground(Color.cyan);
        // txtInfo.setText("abc\ndef");
        txtInfo.setText("abc\ndef\nghi\njkl\nmno\npqr\nstu\nvwx\nyz");
        c = new GridBagConstraints();
        c.gridx = 1;
        c.gridy = 2;
        c.anchor = GridBagConstraints.NORTHWEST;
        c.weighty = 1.0;
        c.insets.top = 10;

        this.add(txtInfo, c);

        JPanel controllerOuter = new JPanel();
        controllerOuter.setLayout(new BoxLayout(controllerOuter, BoxLayout.Y_AXIS));
        controllerOuter.setBorder(BorderFactory.createRaisedBevelBorder());

        FlowLayout controllerLayout = new FlowLayout(FlowLayout.CENTER);
        controllerLayout.setHgap(0);
        JPanel controller = new JPanel(controllerLayout);

        controller.setBorder(new EmptyBorder(10, 10, 10, 10));

        Dimension dim = new Dimension(60, 40);
        JButton btnPlay = CreateImageButton("play.png");
        btnPlay.setPreferredSize(dim);

        controller.add(btnPlay);
        JButton btnPause = CreateImageButton("pause.png");
        btnPause.setPreferredSize(dim);
        controller.add(btnPause);
        JButton btnStop = CreateImageButton("stop.png");
        btnStop.setPreferredSize(dim);
        controller.add(btnStop);
        JButton btnForward = CreateImageButton("forward.png");
        btnForward.setPreferredSize(dim);
        controller.add(btnForward);
        JComboBox cbAspectRatio = new JComboBox();
        cbAspectRatio.setPreferredSize(new Dimension(100, 40));
        cbAspectRatio.setBorder(new EmptyBorder(0, 10, 0, 0));
        controller.add(cbAspectRatio);

        controllerOuter.add(controller);

        JProgressBar pbProgress = new JProgressBar(0, 100);
        pbProgress.setPreferredSize(new Dimension(350, 40));
        pbProgress.setBorder(new EmptyBorder(0, 10, 10, 10));
        pbProgress.setValue(50);
        pbProgress.setString("50/100");
        pbProgress.setStringPainted(true);
        pbProgress.setForeground(Color.BLUE);
        pbProgress.setBorderPainted(true);
        controllerOuter.add(pbProgress);

        c = new GridBagConstraints();
        c.gridx = 0;
        c.gridy = 3;
        c.gridwidth = 2;
        c.weightx = 1.0;
        this.add(controllerOuter, c);
    } 
```

![这是图像](../Images/cdf7cc0d6c78ef19ea47861d028aed4b.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T10:34:22.337

我在您的代码中看到了几件事：

1.  您强制 JButton 的首选大小。如果可能的话，我会删除它，因为这通常会给你带来比解决方案更多的问题。如果你想强制使用preferredSize，你还应该注意设置最小和最大尺寸，否则你会得到像你观察到的奇怪行为
2.  您使用 BoxLayout 来显示控件。虽然这是完全可以接受的，但 BoxLayout 还依赖最小/最大尺寸来执行布局，这是您没有设置的。
3.  您使用叠瓦式布局。这也很好，但为什么不只使用 MoviePanel 的 GridBagLayout 呢？
4.  通常 TextAreas 被包裹在 JScrollPane 中，以防文本太大。你也可以在TextArea上设置LineWrap(true)，这样就不会在右边走得太远。通过在 TextArea 上设置行/列，您将定义它的preferreSize（以防止它依赖于它包含的文本）。
5.  在您的上，`GridBagConstraints`填充属性只能是：`NONE`、、或（您对其中之一使用了 VERTICAL）。此外，不需要重新创建新实例，您可以反复使用相同的 GridBagConstraint，当您为组件设置约束时，LayoutManager 会自动克隆它。`VERTICAL``HORIZONTAL``BOTH`

现在对于解决方案，我发现了几个：

1.  添加时`contollerOuter`，还要指定`c.fill = GridBagConstraints.HORIZONTAL;`（这是解决问题的最简单方法）
2.  当您设置 JButton 的 preferredSize 时，还要强制它们的 minimumSize 为相同的值。
3.  仅使用 GridBagLayout 来布局所有组件。（这将是我的最爱）
4.  将 FlowLayout 替换为带有 X_AXIS 的 BoxLayout。

请记住 GridBagConstraints 属性：

*   gridx, gridy：指定位置
*   gridwidth, gridheight：指定 colspan/rowspan
*   weightx, weighty：指定谁获得额外的水平/垂直空间以及比例
*   锚点：指定组件与其“单元格”的对齐方式，如果“单元格”大于组件
*   填充：指定组件是否应拉伸到单元格宽度/高度

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T10:31:39.007

只需`JPanel`为每个添加一个`Center and Bottom`即可为您解决问题，因此直到您`JTextArea`的`GridBagLayout`意愿服务于目的，然后`BorderLayout`MAIN`JPanel`将完成。此外，对整体进行添加`JScrollPane`也减少了其他领域所需的工作量。看看代码和输出：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.border.*;

public class JTextPaneExample extends JPanel
{
    private Icon info = UIManager.getIcon("OptionPane.informationIcon");
    private Icon error = UIManager.getIcon("OptionPane.errorIcon");

    private static JButton CreateImageButton(String fileName) {
        JButton retVal = new JButton("xxx");
        return retVal;
    }

    private void createAndDisplayGUI()
    {
        JFrame frame = new JFrame("JTextPane Example");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        this.setLayout(new BorderLayout());
        this.setBackground(Color.WHITE);

        JPanel centerPanel = new JPanel();
        centerPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
        centerPanel.setLayout(new GridBagLayout());
        centerPanel.setBackground(Color.WHITE);
        JButton btnRefresh = CreateImageButton("refresh.png");
        GridBagConstraints c = new GridBagConstraints(); 
        c.gridx=0;
        c.gridy=0;
        c.fill = GridBagConstraints.NORTH;
        c.insets.left = 10; c.insets.right = 10; c.insets.top = 10;
        centerPanel.add(btnRefresh, c);

        JComboBox cbMovieList = new JComboBox();
        c = new GridBagConstraints();
        c.gridx = 1;
        c.gridy = 0;
        c.fill = GridBagConstraints.HORIZONTAL;
        c.insets.right = 10; c.insets.top = 10;
        c.weightx = 1.0;
        centerPanel.add(cbMovieList, c);

        JButton btnAuthorize = new JButton("Get Info");
        c = new GridBagConstraints();
        c.gridx = 1;
        c.gridy = 1;
        c.anchor = GridBagConstraints.WEST;
        c.insets.top = 10;
        centerPanel.add(btnAuthorize, c);

        JTextArea txtInfo = new JTextArea();
        txtInfo.setFont( new Font("SansSerif", Font.BOLD, 12));
        txtInfo.setBackground(Color.cyan);
        // txtInfo.setText("abc\ndef");
        txtInfo.setText("abc\ndef\nghi\njkl\nmno\npqr\nstu\nvwx\nyz");
        JScrollPane scroller = new JScrollPane();
        scroller.setViewportView(txtInfo);
        c = new GridBagConstraints();
        c.gridx = 1;
        c.gridy = 2;
        c.anchor = GridBagConstraints.NORTHWEST;
        c.fill = GridBagConstraints.HORIZONTAL;
        c.weighty = 1.0;
        c.insets.top = 10;

        centerPanel.add(scroller, c);

        JPanel controllerOuter = new JPanel();
        controllerOuter.setLayout(new BoxLayout(controllerOuter, BoxLayout.Y_AXIS));
        controllerOuter.setBorder(BorderFactory.createRaisedBevelBorder());

        FlowLayout controllerLayout = new FlowLayout(FlowLayout.CENTER);
        controllerLayout.setHgap(0);
        JPanel controller = new JPanel(controllerLayout);

        controller.setBorder(new EmptyBorder(10, 10, 10, 10));

        Dimension dim = new Dimension(60, 40);
        JButton btnPlay = CreateImageButton("play.png");
        btnPlay.setPreferredSize(dim);

        controller.add(btnPlay);
        JButton btnPause = CreateImageButton("pause.png");
        btnPause.setPreferredSize(dim);
        controller.add(btnPause);
        JButton btnStop = CreateImageButton("stop.png");
        btnStop.setPreferredSize(dim);
        controller.add(btnStop);
        JButton btnForward = CreateImageButton("forward.png");
        btnForward.setPreferredSize(dim);
        controller.add(btnForward);
        JComboBox cbAspectRatio = new JComboBox();
        cbAspectRatio.setPreferredSize(new Dimension(100, 40));
        cbAspectRatio.setBorder(new EmptyBorder(0, 10, 0, 0));
        controller.add(cbAspectRatio);

        controllerOuter.add(controller);

        JProgressBar pbProgress = new JProgressBar(0, 100);
        pbProgress.setPreferredSize(new Dimension(350, 40));
        pbProgress.setBorder(new EmptyBorder(0, 10, 10, 10));
        pbProgress.setValue(50);
        pbProgress.setString("50/100");
        pbProgress.setStringPainted(true);
        pbProgress.setForeground(Color.BLUE);
        pbProgress.setBorderPainted(true);
        controllerOuter.add(pbProgress);

        add(centerPanel, BorderLayout.CENTER);
        add(controllerOuter, BorderLayout.PAGE_END);

        frame.getContentPane().add(this);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new JTextPaneExample().createAndDisplayGUI();
            }           
        });
    }
} 
```

这是添加更多行时的输出：

![布局](../Images/ca56d4fa01b4e385d01c11353e925868.png)

# java - 调用accept() 的线程会发生什么？

> ID：10507259
> 
> 赞同：0
> 
> 时间：2012-05-08T22:07:29.390
> 
> 标签：java, sockets, network-programming

我有一个正在侦听套接字的服务器线程。用这样的声明：

```
Socket client = serverSocket.accept(); 
```

调用此接受函数的线程实际发生了什么？javadoc 说“侦听与此套接字建立的连接并接受它。该方法阻塞，直到建立连接。” “阻塞”是指一种忙于等待的形式，还是线程暂停/处于睡眠状态，直到它收到作为中断的请求或其他东西？此外，这种行为是否可以推广到套接字上的所有阻塞函数调用，如读取等......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T22:14:43.917

简单地说，线程只是停止并等待建立连接。建立连接后，它将继续执行下一条指令。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-08T22:31:17.357

这取决于实施。不仅是 Java 是如何实现的，还有 Java 正在调用的运行时库和操作系统系统调用是如何实现的。但是，阻塞以等待文件句柄可用是操作系统可以优化的类型，因此这些调用*往往*是非忙等待。所以，你不能确定，但​​也许。

# sql - 如何在实体框架中直接获取 DbDataReader 对象？

> ID：10507260
> 
> 赞同：0
> 
> 时间：2012-05-08T22:07:42.027
> 
> 标签：sql, entity-framework, dbdatareader

根据 MSDN (http://msdn.microsoft.com/en-us/library/dd487208.aspx)，`DbDataReader`在实体框架中运行 SQL 查询的过程中创建了一个名为的对象。

实体框架将其“翻译”`DbDataReader`为实体类。

如何直接访问 DbDataReader？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:36:21.753

如果您自己执行查询，则可以访问数据阅读器：

```
using (var command = context.Connection.CreateCommand())
{
    command.CommandText = "SELECT ...3;
    using (var reader = command.ExecuteReader())
    {
        ...
    }
} 
```

# c++ - 如何使用宏参数作为字符串文字？

> ID：10507264
> 
> 赞同：98
> 
> 时间：2012-05-08T22:07:58.890
> 
> 标签：c++, c-preprocessor, string-literals

我试图弄清楚如何编写一个宏，它将变量名的字符串文字表示以及变量本身传递给函数。

例如给出以下函数。

```
void do_something(string name, int val)
{
   cout << name << ": " << val << endl;
} 
```

我想写一个宏，所以我可以这样做：

```
int my_val = 5;
CALL_DO_SOMETHING(my_val); 
```

哪个会打印出来：`my_val: 5`

我尝试执行以下操作：

```
#define CALL_DO_SOMETHING(VAR) do_something("VAR", VAR); 
```

但是，正如您可能猜到的那样，引号内的 VAR 不会被替换，而只是作为字符串文字“VAR”传递。所以我想知道是否有办法让宏参数本身变成字符串文字。

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2012-05-08T22:12:14.583

使用预处理器[`#`运算符](http://en.cppreference.com/w/cpp/preprocessor/replace#.23_and_.23.23_operators)：

```
#define CALL_DO_SOMETHING(VAR) do_something(#VAR, VAR); 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-05-08T22:12:09.223

您想使用字符串化运算符：

```
#define STRING(s) #s

int main()
{
    const char * cstr = STRING(abc); //cstr == "abc"
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-10-01T22:31:21.993

```
#define NAME(x) printf("Hello " #x);
main(){
    NAME(Ian)
}
//will print: Hello Ian 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-08-23T18:32:55.530

也许你试试这个解决方案：

```
#define QUANTIDISCHI 6
#define QUDI(x) #x
#define QUdi(x) QUDI(x)
. . . 
. . .
unsigned char TheNumber[] = "QUANTIDISCHI = " QUdi(QUANTIDISCHI) "\n"; 
```

# solr - 使用单个 Key 从 Solr 获取记录

> ID：10507272
> 
> 赞同：0
> 
> 时间：2012-05-08T22:08:35.677
> 
> 标签：solr

我正在使用 solr 并查看了文档，但找不到使用密钥从 Solr 获取单个记录的方法？

如果我知道记录的键值，我需要传递给 Solr 以获取此记录的查询是什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:13:54.880

不确定您所说的键是什么意思，但是从上下文中猜测，您的意思是由您的架构定义的字段，如果是这种情况，您可以发出以下命令：

```
// Assumes Id is a schema field

// If via solr admin
q=Id:1

// Properly escaped
q=Id%3A1 
```

# elasticsearch - 按字段查询字符串的多个分析器

> ID：10507276
> 
> 赞同：1
> 
> 时间：2012-05-08T22:09:02.293
> 
> 标签：elasticsearch

对于特定查询，我如何按字段（语音名称、名称）定义单独的查询分析器。只需在索引/类型的放置映射中为语音名称和名称定义搜索分析器？

```
{
    "query_string" : {
        "fields" : ["phonetic_name", "name^5"],
        "query" : "italian food",
        "use_dis_max" : true
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T01:11:53.327

您可以在创建索引时为字段指定分析器，例如：

```
curl -s -XPOST localhost:9200/myindex -d '{
  "mappings":{
    "mytype":{
      "properties":{
        "field1":{"store":"yes","index":"not_analyzed","type":"string"},
        "field2":{"store":"yes","analyzer":"whitespace","type":"string"},
        "field3":{"store":"yes","analyzer":"simple","type":"string"},
      }
    }
  }
}' 
```

# ssl-certificate - 在同一个域下使用具有多个虚拟主机的通配符 ssl 证书？

> ID：10507278
> 
> 赞同：0
> 
> 时间：2012-05-08T22:09:06.463
> 
> 标签：ssl-certificate, vhosts

首先，我对 SSL 证书几乎一无所知，除了如何通过 CPanel 安装它们。

场景是这样的。我正在构建一个网络应用程序，它将使用多个虚拟主机来尝试将内容数据库彼此隔离。每个虚拟主机都将是主域的子域。例如：

```
http://www.maindomain.com
http://account1.maindomain.com
http://account2.maindomain.com
http://account3.maindomain.com
etc 
```

我们希望将 SSL 添加到主域的每个子域，从而将上述变为：

```
https://www.maindomain.com
https://account1.maindomain.com
https://account2.maindomain.com
https://account3.maindomain.com
etc 
```

所以对我来说显而易见的选择是获得通配符 ssl 证书，但是我不知道这是否与单个虚拟主机兼容，这就是问题所在。

我可以获得通配符 ssl 证书，将其安装在一台服务器（以及将来的多个网络服务器）上，并让该证书在所有虚拟主机上工作，还是每个虚拟主机一个证书？

# php - 使用 Facebook PHP api 发布 => UOAuthException: (#282) 需要扩展权限：share_item throw

> ID：10507279
> 
> 赞同：0
> 
> 时间：2012-05-08T22:09:07.617
> 
> 标签：php, facebook, facebook-graph-api, facebook-opengraph

这是我的代码：

```
<?
session_start();

require_once($_SERVER['DOCUMENT_ROOT'].'/admin/config.php');
require_once($_SERVER['DOCUMENT_ROOT'].'/admin/fonctions.php');

include '../api/facebook.php';
include '../api/xhttp.php';

  $config = array();
  $config['appId'] = '35455XXXXXXX207';
  $config['secret'] = '6006855f3aXXXXXXXXX9bce45a426';
  $config['fileUpload'] = false; // optional

  $facebook = new Facebook($config);

$args = array(
    'message'   => 'Hello from my App!',
    'link'      => 'http://www.masteringapi.com/',
    'caption'   => 'Visit MasteringAPI.com For Facebook API Tutorials!',
    'access_token'  => $access_token
);

$retour_login = json_decode(stripslashes($_GET['session']), true);
$uid = $retour_login['uid'];
$access_token = $retour_login['access_token'];

$post_id = $facebook->api("/me/feed", "post", $args);

?> 
```

但它返回：未捕获的 OAuthException：必须使用活动访问令牌来查询有关当前用户的信息。有任何想法吗 ？

谢谢！

* * *

这是我的新代码：

```
<?

  $config = array();
  $config['appId'] = '3545XXXXXXX6207';
  $config['secret'] = '60068XXXXXXXXXXXe45a426';

  $facebook = new Facebook($config);

$retour_login = json_decode(stripslashes($_GET['session']), true);
$uid = $retour_login['uid'];
$access_token = $retour_login['access_token'];

$me = null;
// Session based API call.
if ($session) {
  try {
    $uid = $facebook->getUser();
    $me = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
  }
}

if(!isset($_GET['session'])) {
    $params = array(
    'locale' => 'fr_FR',
    'display' => 'popup', 
    'req_perms' => 'email,user_about_me,user_birthday,user_location',
    'ext_perms' => 'publish_stream,share_item,manage_pages'
    );
    header("Location: ".$facebook->getLoginUrl($params));
}

        $args = array(
                'message'   => "XXXX",
                'link'      => 'XXXX',
                'name'      => 'XXXX',
                'picture'   => 'XXXX',
                "caption"=> "lien.com",
                      "type"=> "link");

        $post_id = $facebook->api("/me/links", "post", $args);

?> 
```

这次我收到此错误：OAuthException：（＃282）需要扩展权限：share_item throw

有任何想法吗 ？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:26:26.917

您没有将访问令牌传递给它。

查看 getAccessToken()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T02:10:20.083

从您的代码示例看来，您正在尝试使用变量 $access_token 来创建您的 $args 数组，然后再定义 $access_token 变量。我会切换变量定义的顺序：

```
$retour_login = json_decode(stripslashes($_GET['session']), true);
$uid = $retour_login['uid'];
$access_token = $retour_login['access_token'];

$args = array(
'message'   => 'Hello from my App!',
'link'      => 'http://www.masteringapi.com/',
'caption'   => 'Visit MasteringAPI.com For Facebook API Tutorials!',
'access_token'  => $access_token
); 
```

这是假设 $retour_login['access_token'] 包含有效的 Facebook 访问令牌。否则，您将需要使用 Facebook SDK 获取当前用户的访问令牌：

```
$access_token = $facebook->getAccessToken(); 
```

# c++ - 将未排序的链接列表变成已排序的链接列表？(C++)

> ID：10507280
> 
> 赞同：0
> 
> 时间：2012-05-08T22:09:11.723
> 
> 标签：c++, list

我在尝试将**INSERT**函数转换为按字母顺序对节点进行排序的函数时遇到问题。我已经写下了到目前为止我尝试过的内容......但它只检查第一个节点的名称，看它是否大于函数参数中新节点的给定名称。有人可以给我一个想法，我将如何能够通过每个节点并能够比较它们的键（名称）并相应地左右放置它们？以下是到目前为止我的代码和**INSERT**函数中的内容......

```
 // UnSortedLnkList.h
    //----------------------------

    #include <iostream>
    #include <afxwin.h>

    using namespace std;

    #define new DEBUG_NEW

    struct Node  {
        string m_name;  // key
        int m_age;

        Node* m_next;
        Node(const string& name, int age, Node* next = NULL);
    };

    ostream& operator<< (ostream&, const Node&);

    class ULnkList  {
        friend ostream& operator<< (ostream&, const ULnkList&); // 1.5
    public:
        ULnkList();
        // copy ctor
        ULnkList(const ULnkList& existingList );            // 5
        ~ULnkList();                                        // 4

        bool IsEmpty() const;
        int Size() const;
        bool Insert(const string& name, int age);           // 1
        bool Delete(const string& name);                    // 3
        bool Lookup(const string& name, int& age) const;    // 2

        ULnkList& operator =(const ULnkList& list2);        // 6

        bool Delete2(const string& name);   

    private:

        Node* m_head;   // points to head of the list
        int m_num;     // the number of entries in the list

        // helper functions:
        void Clear();                                       // 7
        void Copy(const ULnkList& list2);                   // 8
    };

    // UnSortedLnkList.cpp
    //----------------------------
    #include "UnSortedLnkList.h"
    #include <iostream>
    #include <string>
    using namespace std;

    Node::Node(const string& name, int age, Node* next)
    : m_name(name), m_age(age), m_next(next)
    {}

    ostream& operator<< (ostream& os, const Node& n)    // cout << n;
    {
        os << "Name: " << n.m_name << "\tAge: " << n.m_age;
        return os;
    }

    ULnkList::ULnkList()
    : m_head(new Node("",-99,NULL)), m_num(0)
    {
        //m_head = new Node("",-99,NULL);
    }
    //
    ULnkList::ULnkList(const ULnkList& existingList ) 
    {
        Copy(existingList);
    }

    void ULnkList::Copy(const ULnkList& existingList)
    {
        m_num = existingList.m_num;
        // create dummy node
        m_head = new Node("",-99,NULL);
        // traverse existing list
        Node *pe = existingList.m_head->m_next;
        Node *pThis = m_head;
        while( pe != 0)
        {
            // create a copy of the Node in OUR list
            pThis->m_next  = new Node(pe->m_name,pe->m_age,0);

            // update pointers
            pe = pe->m_next;
            pThis = pThis->m_next;
        }
    }

    void ULnkList::Clear()
    {
        Node *p = m_head->m_next;
        Node *tp = m_head;          // trail pointer
        while( p != 0)
        {
            delete tp;

            // update pointers
            tp = p;  // 
            p = p->m_next;
        }

        delete tp;
    }

    ULnkList& ULnkList::operator =(const ULnkList& list2)  // list1 = list2;
    {
        // list1 = list1;  // check for self-assignment
        if( this != &list2 )
        {
            this->Clear(); // normally Clear();
            this->Copy(list2);
        }

        // l1 = l2 = l3;

        return *this;
    }

    bool ULnkList::IsEmpty() const
    {
        return m_num == 0;
        // return m_head->m_next == NULL;
    }

    int ULnkList::Size() const
    {

        return m_num;
    }
    //

    ULnkList::Insert(const string& name, int age)
    {
        Node *current = m_head->m_next;
        Node *previous = m_head;
        if (m_head->m_next == NULL) 
        {
            m_head->m_next   = new Node(name,age,m_head->m_next); 
            m_num++;
            return true;
        }
        if (name < m_head->m_next->m_name)
        {
            m_head->m_next = new Node(name,age,m_head->m_next);
            m_num++;
            return true;
        }

        return true;
    }

    //
    ostream& operator<< (ostream& os, const ULnkList& list) // cout << list;
    {
        Node *p = list.m_head->m_next; // first node with data

        while( p != 0 )
        {
            cout << *p << endl;  // ????

            // update p
            p = p->m_next;
        }
        cout << "--------------------------------------" << endl;

        return os;
    }

    //   input: name
    //// output: age if found
    bool ULnkList::Lookup(const string& name, int& age) const
    {
        // linear search
        Node *p = m_head->m_next;

        while( p != 0)
        {
            if( name == p->m_name )
            {
                // found it
                age = p->m_age;
                return true;
            }

            // update p
            p = p->m_next;
        }
        return false;
    }
    //
    bool ULnkList::Delete(const string& name)
    {
        Node *p = m_head->m_next;
        Node *tp = m_head;          // trail pointer
        while( p != 0)
        {
            if( name == p->m_name )
            {
                // found it, so now remove it
                // fix links
                tp->m_next = p->m_next;
                // delete the node
                delete p;

                return true;
            }

            // update pointers
            tp = p;  // tp = tp->m_next;
            p = p->m_next;
        }
        return false;
    }

    bool ULnkList::Delete2(const string& name)
    {
        Node *p = m_head;
        while( p->m_next != 0 )     // ?????
        {
            if( p->m_next->m_name == name )
            {
                Node *save = p->m_next;
                // remove the node
                // fix links
                p->m_next = p->m_next->m_next;
                // delete memory
                delete save;
                return true;
            }

            // update pointers
            p = p->m_next;
        }
        return false;
    }
    //
    ULnkList::~ULnkList()
    {
        Clear();
    }
    // 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:22:25.200

我对这段代码有一点警告

```
if(name > m_head->m_name ){
while(name > current->m_next->m_name){
    current = current->m_next;
}
// add temp = current->next
current->m_next = new Node(name,age)
// current->next->next = temp 
```

您不想在插入位置后丢失列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T22:14:28.193

我猜这是作业，所以我不打算编写代码。我建议您的 Insert() 函数可以通过比较输入字符串，然后执行插入逻辑，从头部遍历列表，直到它到达“正确”位置。那是假设您必须使用文字列表作为数据结构。如果您想要更好的平均插入性能，您可以使用二叉树作为您的底层结构，但这会使列表遍历更加复杂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:29:40.987

你的问题在于这段代码：

```
 if (name < m_head->m_next->m_name)
    {
        m_head->m_next = new Node(name,age,m_head->m_next);
        m_num++;
        return true;
    } 
```

为了以排序方式插入，我可能会使用某种带有递归函数调用的辅助函数。

但这可能有效：

```
Node *current = m_head;
if(name > m_head->m_name ){
    while(name > current->m_next->m_name){
        current = current->m_next;
    }
    current->m_next = new Node(name,age,current->m_next);
}
else{
    m_head = new Node(name,age,m_head);
} 
```

这将以升序方式插入。我还没有测试它，但让我知道它是否有效！希望这可以帮助！

# xcode - xcode uitableview

> ID：10507288
> 
> 赞同：0
> 
> 时间：2012-05-08T22:09:48.873
> 
> 标签：xcode, uitableview

我有一个对象数组，我在 UItable 中填充了每个对象的属性之一是 YES/NO 值

我使用 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath { 来填充我的表格，如下所示。

我的代码为数组中的每个对象创建一个表条目。我只想使用数组中“显示”属性设置为“是”的对象来填充表格？我该怎么做呢？

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *cellidentifier = @"customcell";
customcell *cell = (customcell *)[tableView dequeueReusableCellWithIdentifier:
                                  cellidentifier];

my_details *myObj = [appDelegate.myArray objectAtIndex:indexPath.row];

// UITableViewCell cell needs creating for this UITableView row.
if (cell == nil)

{
    NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"customcell" owner:self options:nil];

    for (id currentObject in topLevelObjects) {
        if ([currentObject isKindOfClass:[customcell class]]) {
            cell = (customcell *) currentObject;
            break;
        }
    }
}

    cell.line1.text = myObj.line1;
    cell.line2.text = myObj.line2;
    cell.line3.text = myObj.line3;

return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:23:13.273

在将对象发送到表进行显示之前尝试过滤它们是个好主意。

您可以使用 NSPredicate 过滤对象数组，当对象更改其状态时，显示属性设置为 yes，重新过滤数组并将其传递给 tableview。

```
NSPredicate *testForTrue = [NSPredicate predicateWithFormat:@"display == YES"];
NSArray *filteredArray = [myObjectsArray filteredArrayUsingPredicate:testForTrue]; 
```

获得过滤数组后，您需要将其传递给 tableView 并告诉它重新加载数据以刷新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T12:04:15.903

正如@Sorin 表示你必须过滤你的表。这可以在插入表格之前或期间完成。哪一个是品味问题（以及您通常遵循哪些编程准则）

a) 之前有所有数据 -> 过滤器 -> 有缩减集 -> 显示缩减表

b）在拥有所有数据->计算#items->按行引入->显示表期间，您必须调整numberOfRowsInSection（伪代码！）

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
  counter=0;
  for each in table
     if value = YES counter++
  return counter;
} 
```

在 cellForRowAtIndexPath 中，您现在必须通过全局变量跟踪要插入的下一行：（伪代码！）

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell;
    static NSString *CellIdentifier = @"Cell";
    cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    rowcounter++;
    cell.textLabel.text=[selectionTableArray objectAtIndex:rowcounter];
    return cell;
} 
```

# javascript - 如何在 jquery 中获取 textarea 的值？

> ID：10507294
> 
> 赞同：111
> 
> 时间：2012-05-08T22:10:31.730
> 
> 标签：javascript, jquery, textarea

我有这个表格，我试图从文本区域获取值。出于某种原因，它不想。

```
<form action="/profile/index/sendmessage" method="post" enctype="application/x-www-form-urlencoded">
    <div class="upload_form">
        <dt id="message-label"><label class="optional" for="message">Enter Message</label></dt>
        <dd id="message-element">
        <textarea cols="60" rows="5" id="message" name="message"></textarea></dd>
        <dt id="id-label">&nbsp;</dt>
        <dd id="id-element">
        <input type="hidden" id="id" value="145198" name="id"></dd>
        <dt id="send_message-label">&nbsp;</dt>
        <dd id="send_message-element">
        <input type="submit" class="sendamessage" value="Send" id="send_message" name="send_message"></dd>
    </div>
</form>

$("input.sendamessage").click(function(event) {
    event.preventDefault();

    var message = $('textarea#message').html();
    var id      = $('input#id').val();

    console.log(message + '-' + id);
}); 
```

或[jsfiddle](http://jsfiddle.net/patrioticcow/SvbZJ/1/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2012-05-08T22:11:18.250

textarea 的值也采用[`val`](https://api.jquery.com/val/#val1)以下方法：

```
var message = $('textarea#message').val();
console.log(message);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<textarea cols="60" rows="5" id="message" name="message">
Hello,
 world!
</textarea>
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-05-08T22:11:36.453

您需要使用`.val()`textarea 因为它是一个元素而不是包装器。尝试

```
$('textarea#message').val() 
```

[更新的小提琴](http://jsfiddle.net/skram/SvbZJ/2/)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-05-08T22:12:18.927

你应该使用`val()`而不是`html()`

```
var message = $('#message').val(); 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-07-08T10:06:21.590

在 javascript 中：

```
document.getElementById("message").value 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-05-03T10:44:59.857

你不需要使用`textarea#message`

```
var message = $('textarea#message').val(); 
```

你可以直接使用

```
var message = $('#message').val(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-02-26T16:36:13.530

您应该在使用 val() 之前检查 textarea 是否为空，否则，您将收到未定义的错误。

```
if ($('textarea#message') != undefined) {
   var message = $('textarea#message').val();
} 
```

然后，你可以对消息做任何事情。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-03-27T13:01:35.610

你可以直接使用

```
var message = $.trim($("#message").val()); 
```

阅读更多@[使用jQuery Val()方法获取TextArea的值](http://www.jquerypot.com/how-to-get-the-value-of-a-textarea-using-jquery/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-02-05T10:35:11.297

您还可以通过元素的**name 属性**获取值。

```
var message = $("#formId textarea[name=message]").val(); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-06-22T21:22:15.540

`$('textarea#message')`不能是未定义`$`的（当然，如果你指的是 jQuery）。

`$('textarea#message')`可能长度为 0，然后`$('textarea#message').val()`为空，仅此而已

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-02-07T14:39:49.973

所有值始终与`.val()`.

见下面的代码：

```
var message = $('#message').val(); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-02-08T07:46:02.407

你不需要使用`.html()`. 你应该去`.val()`。

来自以下文档[`.val()`](https://api.jquery.com/val/)：

> 该`.val()`方法主要用于获取`input`,`select`和等表单元素的值`textarea`。在空集合上调用时，它返回`undefined`.

```
var message = $('#message').val(); 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2018-01-15T10:54:18.293

您还可以通过名称而不是 id 来获取值，如下所示：

```
var message = $('textarea:input[name=message]').val(); 
```

# jquery - 获取没有'px'的元素的行高

> ID：10507296
> 
> 赞同：31
> 
> 时间：2012-05-08T22:10:56.603
> 
> 标签：jquery

如何在没有“px”的情况下检索元素的行高？

使用它，我得到了包括 px 在内的完整行高值。

```
$('#example').css('line-height'); 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-05-08T22:13:27.833

将其解析为整数`parseInt`

`parseInt($('#example').css('line-height'), 10);`

输出：

`18`

作为整数。其他解决方案维护 String 类型。

**编辑**

对于可能包含小数点的值，您可以使用`parseFloat()`

`parseFloat($('#example').css('line-height'));`

输出：

`18.4`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-08T22:13:44.707

只需将 替换`px`为`''`。

`$('#example').css('line-height').replace('px', '');`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T22:13:26.610

将其保存到变量中然后进行替换

```
var aux = $('#example').css('line-height').replace('px', ''); 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2014-01-22T09:24:28.280

**在咖啡脚本中**

```
getElementProperty = (el, property) -> 
  val = el.css(property).replace "px" , "" 

  parseInt val

getElementProperty $("#myElement"), "line-height" 
```

这应该给它！

# python - 将路径字符串拆分为驱动器、路径和文件名部分

> ID：10507298
> 
> 赞同：18
> 
> 时间：2012-05-08T22:11:04.560
> 
> 标签：python, path, split, filepath

我是 python 和一般编码的新手。我正在尝试从每行都有路径名的文本文件中读取。我想逐行读取文本文件并将行字符串拆分为驱动器、路径和文件名。

到目前为止，这是我的代码：

```
import os,sys, arcpy

## Open the file with read only permit
f = open('C:/Users/visc/scratch/scratch_child/test.txt')

for line in f:
    (drive,path,file) = os.path.split(line)

    print line.strip()
    #arcpy.AddMessage (line.strip())
    print('Drive is %s Path is %s and file is %s' % (drive, path, file)) 
```

我收到以下错误：

```
File "C:/Users/visc/scratch/simple.py", line 14, in <module>
    (drive,path,file) = os.path.split(line)
ValueError: need more than 2 values to unpack 
```

当我只需要路径和文件名时，我没有收到此错误。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-08T22:28:04.137

您需要先使用`os.path.splitdrive`：

```
with open('C:/Users/visc/scratch/scratch_child/test.txt') as f:
    for line in f:
        drive, path = os.path.splitdrive(line)
        path, filename = os.path.split(path)
        print('Drive is %s Path is %s and file is %s' % (drive, path, filename)) 
```

笔记：

*   该`with`语句确保文件在块的末尾关闭（当垃圾收集器吃掉文件时文件也会关闭，但使用`with`通常是一个好习惯
*   you don't need the brackets - os.path.splitdrive(path) returns a tuple, and this will get automatically unpacked
*   `file` is the name of a class in the standard namespace and you should probably not overwrite it :)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-08T22:24:05.653

您可以使用 os.path.splitdrive() 获取驱动器，然后使用 path.split() 获取剩余部分。

```
## Open the file with read only permit
f = open('C:/Users/visc/scratch/scratch_child/test.txt')

for line in f:
    (drive, path) = os.path.splitdrive(line)
    (path, file)  = os.path.split(path)

    print line.strip()
    print('Drive is %s Path is %s and file is %s' % (drive, path, file)) 
```

# php - PHP效率与HTML？

> ID：10507300
> 
> 赞同：-2
> 
> 时间：2012-05-08T22:11:15.290
> 
> 标签：php, performance

我想知道什么似乎更有效。如果我需要使用

```
ThisIsMySuperLongLineOfHTMLCodeThatIsRepeatedManyTimes 
```

在我的代码中有很多，实际上设置类似的东西是否更有效，服务器明智

```
$repeat = 'ThisIsMySuperLongLineOfHTMLCodeThatIsRepeatedManyTimes' 
```

然后使用

```
<?php echo $repeat; ?> 
```

在它的地方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:14:20.027

**定义高效。** PHP 处理比直接 HTML 花费的时间*稍长*，即使两者都通过 PHP 解析器运行。但是，您的代码看起来更简洁且更易于管理，尤其是当您需要更改重复行、重复次数或在不同位置重复时。而且它在服务器上占用的空间更少，因此代码实际上可能会*稍微*快一些，因为硬盘读取时间过长，具体取决于该行重复了多少次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T22:14:34.677

PHP 将花费更长的时间，因为它必须运行代码，然后将其输出为 HTML（使用 echo）。HTML 将沿着页面向下显示并显示它的使用次数。

编辑：看起来您特别关注服务器而不是用户的速度。其他答案是正确的，使用 PHP 将是更小的文件大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:20:06.183

纯 html 是运行此程序的最有效方式。php 需要由服务器解析，因此需要一些额外的过程才能将其发送到用户客户端。如果您不多次更改“$repeat”，则可以使用纯 html。老实说，我不认为您的“超长 html 行”太长以至于 php 或 html 无论如何都需要很多时间。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-08T22:14:15.363

执行时间处理时间？没有把握。

为了重复字符串？php。（节省服务器空间）。

```
<?php
$string = 'ThisIsMySuperLongLineOfHTMLCodeThatIsRepeatedManyTimes';
for($i = 0; i < 10; $i++) {
    echo $string;
}

?> 
```

将使用比“ThisIsMySuperLongLineOfHTMLCodeThatIsRepeatedManyTimesThisIsMySuperLongLineOfHTMLCodeThatIsRepeatedManyTimesThisIsMySuperLongLineOfHTMLCodeThatIsRepeatedManyTimesThisIsMySuperLongLineOfHTMLCodeThatIsRepeatedManyTimesThisIsMySuperLongLineOfHTMLCodeThatIsRepeatedManyTimes”等更少的空间。

# c++ - std::string.c_str() 的值与 std::string 不同吗？

> ID：10507301
> 
> 赞同：1
> 
> 时间：2012-05-08T22:11:17.010
> 
> 标签：c++, cstring, stdstring

我一直在使用 C++ 字符串，并尝试`char *`使用`std::string`C 函数（例如`strcpy()`. 由于`strcpy()`需要`char *`作为参数，因此我必须将其转换为如下所示：

```
std::string destination;
unsigned char *source;
strcpy((char*)destination.c_str(), (char*)source); 
```

代码工作正常，当我在调试器中运行程序时， 的值`*source`存储在 中`destination`，但由于某些奇怪的原因，它不会与语句一起打印出来

`std::cout << destination;`

我注意到如果我使用

`std::cout << destination.c_str();`

该值打印正确，一切正常。为什么会这样？是否有更好的方法将`unsigned char*`或复制`char*`到`std::string`（字符串流？）这似乎只发生在我`foo.c_str()`在复制操作中指定字符串时。

编辑：要回答“你为什么要这样做？”这个问题，我用`strcpy()`一个简单的例子。有时它比分配更复杂。例如，必须将仅 X 数量的字符串 A 复制到字符串 B 中，使用`strncpy()`或将 a 传递`std::string`给 C 库中的函数，该函数将 a`char *`作为缓冲区的参数。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T22:14:54.587

这就是你想要的

```
 std::string destination = source; 
```

你所做的在很多层面上都是错误的......你正在写一个`std::string`......我的意思是......不是很酷的人......它比这更复杂，数组正在调整大小，阅读- 只有记忆......作品。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T22:15:55.190

这根本不是一个好主意，原因有两个：

1.  `destination.c_str()`是一个 const 指针，丢弃它的 const 并写入它是未定义的行为。
2.  您还没有设置字符串的大小，这意味着它甚至不需要足够大的缓冲区来保存可能导致访问冲突的字符串。

`std::string`有一个构造函数，它允许它从一个`char*`如此简单的写法中构造出来：

`std::string destination = source`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T22:16:12.443

那么你正在做的是未定义的行为。您的 c_str() 返回一个 const char * 并且不打算分配给。为什么不使用定义的构造函数或赋值运算符。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-08T22:16:29.553

`std::string` 定义从`const char*`to[的隐式转换](http://www.cplusplus.com/reference/string/string/operator=/)`std::string`...所以使用它。

您决定将错误丢弃为`c_str()`返回 a `const char*`，即它不允许写入其底层缓冲区。你尽你所能来解决这个问题，但它没有奏效（你不应该对此感到惊讶）。

`c_str()``const char*`有充分的理由返回 a 。您不知道该指针是否指向字符串的底层缓冲区。你不知道这个指针是否指向一个足够大的内存块来保存你的新字符串。该库正在使用它的接口来准确地告诉您应该如何使用的返回值，`c_str()`而您完全忽略了这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T22:47:38.537

不要做你正在做的事！！！

我重复！

**不要做你正在做的事！！！**

当你做一些奇怪的事情时它似乎有点工作是字符串类是如何实现的结果。你几乎可以肯定是在记忆中写你不应该写的东西和一堆其他虚假的东西。

当您需要与写入缓冲区的 C 函数进行交互时，有两种基本方法：

```
std::string read_from_sock(int sock) {
    char buffer[1024] = "";

    int recv = read(sock, buffer, 1024);
    if (recv > 0) {
      return std::string(buffer, buffer + recv);
    }
    return std::string();
} 
```

或者你可以试试 peek 方法：

```
std::string read_from_sock(int sock) {

    int recv = read(sock, 0, 0, MSG_PEEK);
    if (recv > 0) {
      std::vector<char> buf(recv);
      recv = read(sock, &buf[0], recv, 0);
      return std::string(buf.begin(), buf.end());
    }
    return std::string();
} 
```

当然，这些不是非常强大的版本……但它们说明了这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T22:15:45.207

首先你应该注意返回的值`c_str`是a `const char*`，不能修改。实际上它甚至不必指向`string`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-08T22:51:54.430

回应您的编辑：

> 必须使用 strncpy() 仅将 X 数量的字符串 A 复制到字符串 B

如果字符串 A 是一个 char 数组，而字符串 B 是 std::string，并且 strlen(A) >= X，那么你可以这样做：

```
B.assign(A, A + X); 
```

> 将 std::string 传递给 C 库中的函数，该函数将 char * 作为缓冲区的参数

如果参数实际上是`const char *`，您可以使用`c_str()`它。但是，如果它只是 plain `char *`，并且您使用的是符合 C++11 的编译器，那么您可以执行以下操作：

```
c_function(&B[0]); 
```

但是，您需要确保字符串中有数据的空间（就像您使用普通的 c 字符串一样），您可以通过调用`resize()`函数来做到这一点。如果函数将未指定数量的字符作为以 null 结尾的 c 字符串写入字符串，那么您可能希望在之后截断字符串，如下所示：

```
B.resize(B.find('\0')); 
```

您可以在 C++11 编译器而不是 C++03 编译器中安全地执行此操作的原因是，在 C++03 中，标准不保证字符串是连续的，但在 C++11 中，它们是. 如果你想要 C++03 中的保证，那么你可以使用`std::vector<char>`。

# html - django - 清理用于生产的 HTML 模板

> ID：10507307
> 
> 赞同：0
> 
> 时间：2012-05-08T22:11:29.177
> 
> 标签：html, django, django-templates, http-compression

是否有 django 工具可以让我“准备”用于生产的静态 HTML 模板？

我的模板越来越多的注释和搁置的代码在开发时很有用，但是在部署时，这些额外的注释将对性能造成不必要的影响（我不想公开它们）。

是否有用于修剪 HTML 的 django 插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:17:12.147

[HTML::Clean](http://search.cpan.org/~lindner/HTML-Clean-0.8/lib/HTML/Clean.pm)可能会这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:39:59.683

这是运行时处理的片段：http: [//djangosnippets.org/snippets/123/](http://djangosnippets.org/snippets/123/) 如果它会延迟您的页面呈现并且这是不可接受的，您应该编写一个脚本来迭代模板并在部署后应用它:)

# objective-c - 对字符串的 NSMutableArray 进行排序：“发送到实例的无法识别的选择器”

> ID：10507320
> 
> 赞同：0
> 
> 时间：2012-05-08T22:12:28.170
> 
> 标签：objective-c

我制作了一个程序，它从用户那里获取一些输入字符串（它停止输入“exit”），将它们放入 NSMutableArray 并对其进行排序：

```
#import <Foundation/Foundation.h>
#import <Cocoa/Cocoa.h>

NSInteger compare( id id1, id id2, void* context)
{
    NSString* str1=[id1 stringValue], *str2=[id2 stringValue]; /* ****** exception here */
    const char* buf1, *buf2;
    buf1=[str1 UTF8String];
    buf2=[str2 UTF8String];
    if(strcmp(buf1,buf2)<0)
        return NSOrderedAscending;
    else
        return NSOrderedDescending;
}

int main (int argc, const char * argv[])
{
    NSAutoreleasePool* pool=[[NSAutoreleasePool alloc]init];
    NSMutableArray* array=[[NSMutableArray alloc]init];
    NSString* str=@"";
    char buffer[100];
    NSLog(@"Type a sequence of strings, ending with 'exit', the strings will be sorted in alphabethical order");
    while(! [str isEqualToString:@"exit\n"])
    {
        fgets(buffer,100,stdin);
        str=[NSString stringWithUTF8String: buffer];
        [array addObject: str];

    }
    [array sortUsingFunction: compare context: NULL];
    [array release];
    [pool drain];
    return 0;
} 
```

但是我在用“ ****** ”标记的行中遇到了一个异常，它说：

```
2012-05-09 00:10:14.502 CLITest[1029:903] -[NSCFString stringValue]: unrecognized selector sent to instance 0x10010cbf0 
```

似乎它没有从 id 中获取字符串值。为什么？我应该如何更改比较器方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:16:15.003

`id1`并且`id2`实际上是`NSString`s，即使它们被强制转换`id`并传递给您的函数（这种方法很有用，因为您可以定义`compare`函数以便对自定义对象进行排序）。

调用字符串是没有意义`stringValue`的（事实上，`NSString`没有名为 的成员函数`stringValue`）。

要使用字符串，只需转换回`NSString`s。

```
NSString *s1 = (NSString*) id1;
NSString *s2 = (NSString*) id2; 
```

这不是绝对必要的（您甚至可以直接使用`id1`and `id2`），但是强制转换会避免您收到编译器警告（这也是一个更清晰的代码）。

# android - 无需智能手机即可支持多屏

> ID：10507322
> 
> 赞同：0
> 
> 时间：2012-05-08T22:12:37.843
> 
> 标签：android, android-compatibility, android-screen-support

我已经阅读了[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

我的问题是，我如何才能在 Google Play 上仅针对 Galaxy Tab 7.0（Android 2.2）或更高版本进行过滤？

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="11" />

<supports-screens
    android:largeScreens="true"
    android:normalScreens="false"
    android:smallScreens="false"
    android:xlargeScreens="true" /> 
```

我实际上是这样做的，但看起来像 Galaxy S2 或 XPeria Arc 这样的出色手机具有“大”屏幕，因此该应用程序也适用于这些手机。我该如何过滤？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:44:21.373

上传到 Google Play 后，您可以手动过滤掉您不支持的额外设备。

这个[链接](https://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&ctx=go&answer=1286017)有关于这个主题的额外信息。

# c++ - 从 v8 函数中获取默认参数的最短方法（单线）？

> ID：10507323
> 
> 赞同：5
> 
> 时间：2012-05-08T22:12:39.577
> 
> 标签：c++, node.js, v8, node.js-addon

自从我使用 C++ 以来已经有很长一段时间了，而且自从我把头转向硬类型以来甚至更久了。我只是在寻找一个可以**工作**的班轮来从 v8 获取参数，或者在未提供参数时获取默认值。

```
v8::String::Utf8Value arg0(args[0]);
v8::String::Utf8Value arg1(args[1]);
v8::String::Utf8Value arg2(args[2]);
const char *username = (args.Length() > 0) ? *arg0 : "";
const char *password = (args.Length() > 1) ? *arg1 : "";
const char *service = (args.Length() > 2) ? *arg2 : "login"; 
```

输出：

```
函数（）；// { 用户名：“”，密码：“”，服务：“登录”}
函数（'1'）；// { 用户名：“1”，密码：“”，服务：“登录” }
函数（'1'，'2'）；// { 用户名：“1”，密码：“2”，服务：“登录” }
func('a', 'b', 'c'); // { 用户名：“a”，密码：“b”，服务：“c” }

```

不幸的是，以下接近理想的解决方案对我不起作用（有什么想法吗？）：

```
const char *username = (args.Length() > 0) ? *v8::String::Utf8Value(args[0]->ToString()) : "";
const char *password = (args.Length() > 1) ? *v8::String::Utf8Value(args[1]->ToString()) : "";
const char *service = (args.Length() > 2) ? *v8::String::Utf8Value(args[2]->ToString()) : "login"; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-09T21:42:29.577

Vyacheslav Egorov 用他的评论指出了这一点，当我访问字符串时，它已经被破坏了。最终我最终使用：

```
char *get(v8::Local<v8::Value> value, const char *fallback = "") {
    if (value->IsString()) {
        v8::String::AsciiValue string(value);
        char *str = (char *) malloc(string.length() + 1);
        strcpy(str, *string);
        return str;
    }
    char *str = (char *) malloc(strlen(fallback) + 1);
    strcpy(str, fallback);
    return str;
} 
```

使用示例：

```
v8::Handle<v8::Value> myMethod(const v8::Arguments &args) {
    char *username = get(args[0], "user");
    char *password = get(args[1], "pass");

    ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T18:45:11.653

这段代码非常适合我从一行中的 v8 值中提取字符串值：

```
std::string tempString(*v8::String::Utf8Value(args[someInteger])); 
```

std::string 构造函数应该处理您的默认场景，而不需要额外的代码，但如果您确实需要手动检查空值，这很简单。

这段代码作为示例，它获取所有参数的字符串值并将它们打印到标准输出，当然也将它们放入一个不错的数组中，因为打印它们有什么用？

```
std::string* printAllArgs(const Arguments& args){
    std::cout << "PRINTING ALL ARGS: ";
    std::string* stringArray = new std::string[args.Length()];
    for(int i = 0; i < args.Length(); i++){
        std::string tempString(*v8::String::Utf8Value(args[i]));
        stringArray[i] = tempString;
        std::cout << tempString << ";";
    }
    return stringArray;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T07:05:56.987

Egorov 是正确的，因为临时`AsciiValue`对象已像紧凑符号中的智能指针一样自动销毁：

```
const char *username = *v8::String::Utf8Value(args[0]->ToString());
//transient AsciiValue object has gone out of scope, and its destructor has been called in
//  previous line, rendering the pointer (content) invalid henceforth!
... 
```

这是因为`AsciiValue`已经超出了该单行范围的范围。

相反，如果您打算多次使用“缓存”指针，则应将其分成 2 行：

```
{
  v8::String::Utf8Value usernameObj(args[0]->ToString());
  const char *username = *usernameObj;
  ...
  //use username pointer as often as desired; it remains valid in this entire scope.
  doSomethingWithString(username); //OK

  //can also dereference Utf8Value object only when needed:
  doSomethingWithString(*usernameObj); //OK
}
//here, usernameObj is out of scope and is destroyed, and username will become invalid. 
```

如果只打算使用一次字符串值，使用紧凑表示法仍然完全可以：

```
doSomethingWithString(*v8::String::Utf8Value(args[0]->ToString())); //OK 
```

该`doSomethingWithString`函数获得正确的值来使用。只有从它返回时，`Utf8Value`如果自动销毁。

String::AsciiValue 也会发生同样的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-18T06:17:43.707

```
string bi = info[0]->IsUndefined() ? "backwardIndex.dat" : string(*Nan::Utf8String(info[0])); 
```

# java - Maven需要手动更新依赖？

> ID：10507335
> 
> 赞同：0
> 
> 时间：2012-05-08T22:13:38.343
> 
> 标签：java, eclipse, maven

我是 Maven 新手，使用 Eclipse 的*m2e*插件。我仍然在 Maven 周围徘徊，但似乎每当我需要导入一个新库时，例如`java.util.List`，现在我必须手动完成为 jar 找到正确存储库并将其添加到依赖项中的麻烦聚甲醛。这似乎是个大麻烦，特别是因为在公共存储库中找不到某些 jar，因此必须将它们上传到本地存储库。

我是否在 Eclipse 中遗漏了一些关于 Maven 的内容？当 Eclipse 自动导入新库时，有没有办法自动更新 POM？

我试图了解使用 Maven 如何节省时间/精力......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T22:19:07.160

你选了一个坏例子。无论 Maven 配置如何，Java 标准运行时附带的实际 Java 库的一部分都在那里。

考虑到这一点，如果你想添加一些外部的东西，比如 Log4j，那么你需要添加一个对 Log4j 的项目依赖。然后，Maven 将获取依赖信息并创建一个“签名”以进行搜索，首先在本地缓存中，然后在外部存储库中。

这样的签名可能看起来像

```
groupId:artifactId:version 
```

也许

```
groupId:artifactId:version:classifier 
```

这标识了一个 Maven“模块”，然后将其下载并配置到您的系统中。一旦到位，它将**模块中的所有类添加**到您配置的项目中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T22:30:02.317

Maven 主要节省了在构建中下载和组织 JAR 文件的时间。通过定义“标准”项目布局和“标准”构建顺序，Maven 消除了“为什么我的项目不构建”抽奖活动中的大量猜测。此外，您可以使用简洁的命令（例如“mvn dependency:tree”）以递归方式打印出您的项目所依赖的所有 JAR 的列表。

警告说明：如果您使用的是 M2E 插件和 Eclipse，您也可能会遇到插件本身的问题。1.0 版本（在 eclipse.org 上托管）远不如之前的 0.12 版本（在 Sonatype 上托管）友好。您可以通过从 apache (maven.apache.org) 下载和安装 Maven 的“独立”版本并从命令行运行 Maven 在一定程度上解决这个问题。这实际上比尝试在 Eclipse 中运行 Maven 稳定得多（根据我的个人经验），并且可以在您尝试了解 Maven 时为您省去一些痛苦。

# tcl - 如何在不执行其他命令的情况下错误读取期望？

> ID：10507336
> 
> 赞同：1
> 
> 时间：2012-05-08T22:13:38.903
> 
> 标签：tcl, telnet, expect, cisco

我有一个问题。我有一个简单的期望脚本，我在 php 脚本中调用它来登录到 cisco 终端服务器，以在实验室时间结束后清除 vty 行。逻辑很简单，如果用户在场，那么它只占用 vty 0 行。

如果用户不存在，则会出现问题... cisco 路由器只显示一个错误，说明 %connection to clear 或其他内容，并期望运行脚本的其余部分，这是不必要的，因为我正在管理一个由 10 个路由器组成的实验室并加载配置需要大量时间的文件。

如果我收到该消息，请告诉我如何从日志和结束脚本中读取错误。

* * *

```
#! /usr/bin/expect -f

spawn telnet 192.168.2.1
set user [lindex $argv 0]
set pass [lindex $argv 1]
expect "Username:"
send "$user\r"
expect "Password:"
send "$pass\r"
expect "*>"
send "enable\r"
expect "*#"
send "clear line vty 0\r"
send "\r"
expect "*#"
send "copy tftp://192.168.2.3 running-config\r"
send "config\r"
send "\r"
expect "*#\r\n" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T00:57:38.440

您要询问的错误处理代码在这里...

```
send "clear line vty 0\r"
expect {
    "confirm]" { send "\r" }
    "% Not allowed" { send "quit\r"; exit }
}
expect "#" 
```

这会寻找`[confirm]`或`% Not allowed to clear current line`并做出适当的通过/不通过决定。

我对你的脚本做了一些修改，这样我就可以在我实验室的机器上运行它。我不确定您是如何禁用路由器要求启用密码的，但这可能是要添加到您的脚本中的内容。

如果您想让脚本更健壮，您可以`show user`在清除行之前发出 a，并且只清除脚本不在的行。我将把它作为练习留给你来试验。

* * *

```
#!/usr/bin/expect -f

spawn telnet 172.16.1.5
set user [lindex $argv 0]
set pass [lindex $argv 1]

expect "Username: "
send "$user\r"
expect "assword: "
send "$pass\r"
expect ">"
send "enable\r"
expect "assword: "
send "$pass\r"
expect "#"
send "clear line vty 0\r"
expect {
    "confirm]" { send "\r" }
    "% Not allowed" { send "quit\r"; exit }
}
expect "#"
send "copy tftp://192.168.2.3 running-config\r"
expect "Source filename *]? "
send "config\r"
expect "Destination filename *]? "
send "running\r"
expect "#"
exit 
```

# javascript - 我可以在 Javascript 中识别（图形输入板）笔压吗？

> ID：10507341
> 
> 赞同：8
> 
> 时间：2012-05-08T22:14:15.557
> 
> 标签：javascript, graphics, pen-tablet

有没有办法使用javascript识别笔压。最好我不想使用 Flash 并尝试将其作为纯 JS 完成。

编辑：好的，我意识到 Wacom 平板电脑是有可能的，因为它们附带的软件可以与他们的 javascript api 一起使用以使其成为可能（[演示](http://www.wacomeng.com/web/index.html)）。但这对使用 Trust 平板电脑或任何其他品牌的人没有好处……所以真的没有好处。

如果不是 JS，任何人都知道如何在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-11T19:43:43.483

是的 - 如果用户安装了 Wacom 数位板，那么他们的浏览器将有一个您可以访问的插件。[http://www.wacomeng.com/web/index.html](http://www.wacomeng.com/web/index.html)

作者编辑：我很久以前写过这个。请看下面的评论

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-12-11T21:39:14.820

Microsoft 在 IE 11 中实现了称为[指针事件](http://msdn.microsoft.com/en-us/library/ie/dn433244%28v=vs.85%29.aspx)的东西。它允许您访问压力属性以及诸如笔倾斜和接触几何尺寸之类的东西。

到目前为止，它仅适用于 IE11（以及带有供应商前缀的 IE10），但有一个[W3C 候选推荐](http://www.w3.org/TR/pointerevents/)，因此它可能在未来成为标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T22:15:41.973

不，那是不可能的。可能甚至没有Flash。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T23:11:37.690

Javascript 作为一种编程语言，它本身并不比任何其他语言都具有或缺乏读取此类数据的能力。

语言不重要。重要的是您可以从该语言中使用的 API。

Javascript 可以在许多不同的环境中运行，其中一些可能可以访问此类硬件的 API。但是，大多数 Javascript 都是在 Web 浏览器环境中运行的，这显然是您的意思。

Web 浏览器环境提供了许多 API。最明显的是 DOM，它使您能够操作页面等。不过，浏览器中还有其他可用的 API。例如，地理位置 API。

所有这些都是由 W3C 定义的标准 API（或者在某些情况下正在由 W3C 定义），这意味着所有支持它们的浏览器都应该使它们以相同的方式工作。

对您来说不幸的是，没有用于使用压力垫的标准 API，因此您的问题的直接答案是否定的，它无法完成。

未来是否会出现还有待观察，但我对此表示怀疑。

但是有一种方法可以做到：ActiveX。

ActiveX 是微软在旧版 IE 中提供的 API。它基本上提供了一种从浏览器中访问几乎任何 Windows DLL 代码的方法。

由于 Windows 的压力笔设备驱动程序将作为 DLL 提供，这意味着理论上您应该能够通过 ActiveX 控件在浏览器中访问它。因此，是的，您可以使用 Javascript 对其进行编程。

不过，坏消息是这不是我推荐的。ActiveX 作为一种基于浏览器的技术早已被放弃，因为它造成了大量的安全漏洞。我认为最新版本的 IE 甚至不支持它（我希望不，无论如何），这意味着您将被迫使用旧版本的 IE（并且只有 IE - 没有其他浏览器支持它）才能运行你的代码。不理想。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T22:16:38.980

您只能在本机应用程序中执行此操作。Javascript 无法访问笔压信息

# vim - 获取vim修改文件而不是移动新版本就可以了？

> ID：10507344
> 
> 赞同：9
> 
> 时间：2012-05-08T22:14:21.280
> 
> 标签：vim

我希望我的应用程序在我保存文件时自动更新。所以我使用 inotify (ubuntu) 来创建检测事件的观察者。

问题是 vim**覆盖**文件而不是更新它。所以我的观察者在第一次更新后丢失了。

我想知道，有没有办法设置 vim 所以它不使用交换文件并直接更新文件？

（我尝试`:set noswapfile`了该`-n`选项，即在不改变行为的情况下删除交换文件）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-08T22:30:26.057

你可以这样做：

```
:set backupcopy=yes 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T09:08:34.310

使用 Vim，您可以通过`'backupcopy'`设置来控制它；但是，我曾经采取了另一种方法并监视了目录，而不是文件本身：

```
inotifywait --quiet --monitor --event modify --format '%w%f' "$dir" 
```

这需要在我的脚本中进行更多处理（检查修改后的文件是否与我的列表匹配），但也使我能够捕获新创建的文件。

# jquery - $.ajax 和 JSONP。ParseError 和 Uncaught SyntaxError: Unexpected token :

> ID：10507345
> 
> 赞同：20
> 
> 时间：2012-05-08T22:14:25.680
> 
> 标签：jquery, ajax, json

首先，我一直在几个主题中寻找我的问题的答案，但我找不到适用于我的代码的解决方案。

我正在尝试从 servlet 获得答案，如果我`http://XXXZZZ/Servlet/Login?login=pepe&pass=1234`按预期收到有效的 JSON：

```
{"id":3,"login":"pepe","key":"0D1DBA4BE87E02D43E082F9AA1ECFDEB"} 
```

但是当我对 $.ajax 进行同样的尝试时，我得到了 2 个错误。

```
$.ajax({
    type : "Get",
    url :"http://XXXZZZ/Servlet/Login",
    data :"login="+login+"&password="+pass,
    dataType :"jsonp",
    success : function(data){
    alert(data);},
    error : function(httpReq,status,exception){
    alert(status+" "+exception);
    }
}); 
```

第一个错误（在弹出窗口中）：

```
parsererror Error: jQuery17104145435250829905_1336514329291 was not called 
```

第二个错误（在 Chrome 控制台中）：

```
Uncaught SyntaxError: Unexpected token : Login 1 
```

（还有我在等待的 JSON）。

PS我必须使用dataType：“jsonp”，因为如果我使用“json”，我也会遇到跨域问题。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-08T22:23:07.557

如果您使用的是 jsonp 则语法错误

你需要返回

```
myJsonMethod({"id":3,"login":"pepe","key":"0D1DBA4BE87E02D43E082F9AA1ECFDEB"}); 
```

并添加到您的 ajax 请求选项

```
jsonp: false,
jsonpCallback: "myJsonMethod" 
```

所以

```
$.ajax({
    type : "Get",
    url :"http://XXXZZZ/Servlet/Login",
    data :"login="+login+"&password="+pass,
    dataType :"jsonp",
    jsonp: false,
    jsonpCallback: "myJsonMethod",
    success : function(data){
        alert(data);},
    error : function(httpReq,status,exception){
        alert(status+" "+exception);
    }
}); 
```

（*当然，`success`正如[@voyager 所](https://stackoverflow.com/a/10507372/128165)指出*的那样修复）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-08T22:16:52.113

```
succes : function(data){ 
```

这是一个错字：

```
success : function(data){ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T22:21:13.783

首先，您的成功参数中有错字；你错过了结局。此外，当您执行 JSONP 请求时，您需要以 JSONP 格式返回您的 JSON 信息；其中应包含回调令牌作为返回字符串的一部分。示例 JSONP 字符串如下所示：

```
yourcallbacktoken({"id":3,"login":"pepe","key":"0D1DBA4BE87E02D43E082F9AA1ECFDEB"}) 
```

查看此页面以获取有关 JSONP 规范的更多信息：http: [//devlog.info/2010/03/10/cross-domain-ajax/](http://devlog.info/2010/03/10/cross-domain-ajax/)

# javascript - 如何使用 JavaScript Overlay 反序列化列表列表的 json 表示？

> ID：10507347
> 
> 赞同：0
> 
> 时间：2012-05-08T22:14:31.740
> 
> 标签：javascript, json, list, gwt, deserialization

我有实现这些简化接口的扩展服务器端 java 对象：

```
interface Vector {
  public double getX();
  public double getY();
}

interface Geometry {
  public List<Vector> getShell();//can get big
  public List<List<Vector>> getHoles();
}

interface Feature {
  public String getID();
  public List<Geometry> getGeometry();
} 
```

我构建了一个使用 gson lib 转换为 json 的功能列表。结果看起来像这样，除了它要大得多。

> [{"i":"304","g":[{"s":[{"x":-3169996.4370428286,"y":1.1231962684336938E7},{"x":-3287403.71248886,"y":1.1192826925854929 E7},{"x":-2935181.88615077,"y":1.115369116737292E7}....

我能够将 json 解析为 JsArray，其中 JsFeature 是实现功能接口的 javascriptobject。

如何在不必逐个向量解析我的 json 向量的情况下获取其余数据。理想情况下，我想有一种方法将 List 转换为 JsList，其中 JsGeometry 是一个实现 Geometry 的 JavascriptObject 类，其中包括一个 List 等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:35:41.530

您可以实现一个`List`将所有内容委托给底层的类`JsArray`，但这并不像听起来那么容易（以及为什么它不是内置的 GWT）。

我宁愿推荐使用[AutoBean](http://code.google.com/p/google-web-toolkit/wiki/AutoBean)：

```
interface Factory extends AutoBeanFactory {
   AutoBean<Feature> feature();
}

Factory factory = GWT.create(Factory.class);

Feature feature = AutoBeanCodex.decode(factory, Feature.class, jsonString).as(); 
```

运行时开销很小，几乎与`List`包装 a相同，`JsArray`但您无需编写任何代码即可使其工作。

另请注意，您甚至可以在服务器端使用 AutoBean 而不是 GSON。

# knockout.js - Knockout Mapping Plugin 在表格中显示数据

> ID：10507360
> 
> 赞同：1
> 
> 时间：2012-05-08T22:15:51.273
> 
> 标签：knockout.js, knockout-mapping-plugin

我有来自 JSON 的数据：

```
[
  {"ProjectName":"Region1.Site1","Turbine":"T1","Fault":0,"Description":"No Fault"},
  {"ProjectName":"Region1.Site1","Turbine":"T2","Fault":0,"Description":"No Fault"},
  {"ProjectName":"Region1.Site1","Turbine":"T3","Fault":1,"Description":"In Alarm"},
  {"ProjectName":"Region1.Site1","Turbine":"T4","Fault":1,"Description":"In Alarm"},
  {"ProjectName":"Region1.Site2","Turbine":"T1","Fault":0,"Description":"No Fault"},
  {"ProjectName":"Region1.Site2","Turbine":"T2","Fault":0,"Description":"No Fault"},
  {"ProjectName":"Region1.Site2","Turbine":"T3","Fault":1,"Description":"In Alarm"},
  {"ProjectName":"Region1.Site2","Turbine":"T4","Fault":1,"Description":"In Alarm"}
] 
```

我想将此数据显示到表头为`Project Name`, `Turbine`, `Fault`,的表中`Description`。

我也在使用 Knockout.js 和[映射插件](http://knockoutjs.com/documentation/plugins-mapping.html)。这是一个[JSFiddle 来展示我到目前为止的尝试](http://jsfiddle.net/WaQJp/1/)。

我主要有两个目标

1.  将此数据放入表中
2.  每当故障状态更改时更新该行。每行由 ProjectName 和 Turbine 的组合唯一标识。

* * *

谢谢桑迪普。

我在尝试使用映射插件时遇到了这个声明的问题。

`var viewModel = {};`

`viewModel.Stats = ko.mapping.fromJS(data);`

你能告诉我我做错了什么吗？此外，当我收到数据更新时，以下语句是否有效？

`ko.mapping.fromJS(data,viewModel);`

由于映射插件不起作用，我不得不使用 ko.utils.Arraymap 函数。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T09:02:03.987

这是工作副本。[关联](http://jsfiddle.net/WaQJp/3/)

代码被破坏 - 没有匹配的大括号和引用“数据”而不是 Stats。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:23:51.250

看起来您有一些额外的括号和括号（在数据 json 定义之后和*applyBindings*之后）。除此之外，您只需将“foreach:Data”更改为“foreach:Stats”，以便您的*tbody*指向 viewModel 的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T11:57:24.787

这是我正在做的一个例子，它几乎是同一件事：

```
var UserRecord = function (data) {
    ko.mapping.fromJS(data, {}, this);
};

var mapping = {
    key: function (data) {
        return ko.utils.unwrapObservable(data.Id);
    },
    create: function (options) {
        return new UserRecord(options.data);
    }
};

function UserListViewModel() {
     this.users = ko.mapping.fromJS(data, mapping)
} 
```

它不起作用的原因是因为您有一个数组，您必须告诉 KO 映射每个数组项中的每个属性都需要是可观察的。

# c# - 网格视图上的动态复选框

> ID：10507362
> 
> 赞同：0
> 
> 时间：2012-05-08T22:15:59.013
> 
> 标签：c#, asp.net, gridview

我有一个 c# aspx web 应用程序，旨在动态生成其大部分组件。有这个 GridView 是为了显示一些复选框。

奇怪的是它不显示运行时的组件，而是显示名称空间，即`System.UI.Webcontrols.CheckBox`.

我需要查看复选框；如何解决？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:GridView ID="GridView1" runat="server" OnRowDataBound="GridView1_RowDataBound" />
    </div>
    </form>
</body>
</html>

[aspx.cs]

namespace ChkBoxOnGridView
{
    public partial class WebForm1 : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            PopulateGridView();
        }
        protected void GridView1_RowDataBound(Object sender, GridViewRowEventArgs e)
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                CheckBox cb = new CheckBox();
                e.Row.Cells[1].Controls.Add(cb);
            }
        }

        private void PopulateGridView()
        {
            GridView1.DataSource = null;
            GridView1.Columns.Clear();

            DataTable dt = new DataTable();

            dt.Columns.Add(new DataColumn("DTA", typeof(System.String)));
            dt.Columns.Add(new DataColumn("Is Visible", typeof(System.Web.UI.WebControls.CheckBox)));

            CheckBox chkbx = new CheckBox();
            chkbx.Checked = true;

            DataRow row1 = dt.NewRow();
            row1["DTA"] = "Some Text";
            row1["Is Visible"] = chkbx;
            dt.Rows.Add(row1);

            foreach (DataColumn col in dt.Columns)
            {
                BoundField bField = new BoundField();
                bField.DataField = col.ColumnName;
                bField.HeaderText = col.ColumnName;
                GridView1.Columns.Add(bField);
            }

            GridView1.DataSource = dt;
            GridView1.DataBind();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T22:23:36.547

您需要使用[GridView.RowdataBound 事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)在每一行中单独创建每个对象。

您可以使用`e.Row.Cells[]`

但是，为了确保您在正确的位置创建它，您必须在此事件中检查您所在的行不是页眉或页脚或寻呼机。您可以通过检查e.Row的[GridViewRow.RowType 属性并检查它是否为](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.rowtype.aspx)`DataRow`

```
 void CustomersGridView_RowDataBound(Object sender, GridViewRowEventArgs e)
{

  if(e.Row.RowType == DataControlRowType.DataRow)
  {
    CheckBox cb = new CheckBox();
    // cb.id = ... and other control setup
    // add your control here:
    e.Row.Cells[0].Controls.Add(cb);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:38:16.143

我会说你不能在 DataTable 中控制控件。[Is Visible] 应该是一个布尔值

我将使用模板列在 On Init 事件中添加列。请参阅这个 SO 问题： [向 ASP.NET Gridview 添加动态列](https://stackoverflow.com/questions/234935/adding-dynamic-columns-to-an-asp-net-gridview)

# c++ - C++ 语法：Object* foo(0);

> ID：10507363
> 
> 赞同：0
> 
> 时间：2012-05-08T22:16:06.007
> 
> 标签：c++, syntax

我想不出比这更好的标题了，因为我真的不明白那行应该是什么意思。所以，它在一个函数内的一个while循环中，这里又是：

```
 Object* foo(0); 
```

如果它是一个指针变量的声明，那到底是什么`(0)`东西？在几行之后将`foo`真的用作变量，如下所示：`foo=new Something;`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T22:17:32.073

它正在初始化指向`NULL`.

相当于：

```
Object* foo = NULL; 
```

或者

```
Object* foo = 0; // since NULL is defined as 0 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T22:18:08.360

它声明一个指向`Object`并用 0 (NULL) 初始化它的指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T23:59:58.513

这是 C++ 不是 C 的地方之一。在 C++ 中，

```
int i(47); 
```

等效于（至少在这种情况下）：

```
int i = 47; 
```

严格来说，它构造了一个名为`i`of class的对象，`int`并调用了一个构造函数来初始化该对象。所以，

```
Object * foo(0); 
```

完全一样

```
Object * foo = 0; 
```

它构造了一个名为`foo`“pointer-to-Object”类的对象（这里`Object`是一个类型名称，所以它实际上是一个类而不是一个对象）并使用一个构造函数来初始化新对象。

//B

# android - Ti.Android.currentActivity.startActivity() 停止启动活动

> ID：10507364
> 
> 赞同：1
> 
> 时间：2012-05-08T22:16:07.530
> 
> 标签：android, android-intent, titanium

我基本上使用的是来自锻造钛的导航控制器（[导航控制器](http://vimeopro.com/appcelerator/forging-titanium/video/27834295)）。我也在尝试使用下面的代码启动各种网页。问题是，在应用程序中浏览了一会儿之后，意图似乎不再启动活动。

有没有其他人遇到过类似的问题？如果是这样，它是如何解决的？

感谢您的时间

```
exports.openWebPage = function(url) {
    if (Ti.Network.online) {
        if (Ti.Platform.osname === 'android') {
            var intent = Ti.Android.createIntent({
                action: Ti.Android.ACTION_VIEW,
                data: encodeURI(url),
                className: 'com.android.browser.BrowserActivity',
                packageName: 'com.android.browser'
            });
            intent.addCategory(Ti.Android.CATEGORY_BROWSABLE);
            Ti.Android.currentActivity.startActivity(intent);
            Ti.API.info('openWebPage: ' + url);

        }
        else {
            Ti.Platform.openURL(url);
            Ti.API.info('openWebPage: ' + url);
        }
    }
    else {
        alert('Please establish an internet connection first');
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:26:28.963

也许你可以帮助这是我最近在携带意图中的网址时发生的事情

```
Intent i = new Intent (Intent.ACTION_VIEW, Uri.parse (url));
startActivity (i); 
```

URL 必须以 http:// 或 https:// 开头，否则你会得到一个非常好的异常。

# r - R biglm预测搜索因变量

> ID：10507369
> 
> 赞同：2
> 
> 时间：2012-05-08T22:16:35.110
> 
> 标签：r

我正在使用 biglm 包对数据集进行回归。使用以下代码，回归运行良好：

```
chunkStart <- seq(1,150000000,1000000)
chunkEnd <- seq(1000000,151000000,1000000)
ff <- price ~ factor(Var1) + factor(Var2)

#for(i in 1:length(chunkStart)){
for(i in 1:5){

startRow <- chunkStart[i]
endRow <- chunkEnd[i]    
curchunk <- data.frame( price=x[startRow:endRow,1]
     ,Var1=factor( x[startRow:endRow,6], levels=1:3), Var2= factor( x[startRow:endRow,7], levels=1:3 ) )

    if(i == 1){
    a <- biglm(ff,curchunk )
    }
    if(i != 1){
    a <- update(a,curchunk )
    }
rm(curchunk )
gc()
print(paste(i, " | ",startRow ," | ",endRow ," | ", sep=""))
flush.console()
}

> summary(a)
Large data regression model: biglm(ff, curchunk)
Sample size =  5000000 
                 Coef    (95%     CI)    SE p
(Intercept)    0.0457  0.0454  0.0461 2e-04 0
factor(Var1)2  0.0189  0.0184  0.0194 2e-04 0
factor(Var1)3  0.0148  0.0142  0.0155 3e-04 0
factor(Var2)2 -0.0331 -0.0335 -0.0326 2e-04 0
factor(Var2)3 -0.0417 -0.0426 -0.0408 4e-04 0 
```

当我尝试使用 biglm 对象“a”进行预测时，问题就来了。

```
> df1 <- data.frame(y[1:1000,])
> pred1 <- predict(a, df1)
Error in eval(expr, envir, enclos) : object 'price' not found 
```

为什么`predict`函数要寻找`price`/ 因变量？有什么建议么？

编辑：

```
> head(df1)
  Var1 Var2
1    3    3
2    3    1
3    3    2
4    2    1
5    2    2
6    1    1
> str(df1)
'data.frame':   1000 obs. of  2 variables:
 $ Var1: Factor w/ 3 levels "1","2","3": 3 3 3 2 2 1 2 1 2 1 ...
 $ Var2: Factor w/ 3 levels "1","2","3": 3 1 2 1 2 1 1 1 2 1 ...
> pred1 <- predict(a, df1)
Error in eval(expr, envir, enclos) : object 'price' not found 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T23:57:09.890

它寻找因变量的原因是 predict 方法使用`model.frame`来自 stats 包的调用，并且该函数要求所有变量都存在于新数据中。这在`model.frame`帮助页面上进行了说明，但没有解释其背后的动机。

您实际上需要做的就是在新数据中创建一个与因变量同名的变量，然后用零（或任何非缺失值）填充它。所以如果你运行它应该可以工作：

```
df1$price <- 0
pred1 <- predict(a, df1) 
```

# objective-c - 在 Xcode .c 头文件中导入 complex.h 头文件会产生编译错误

> ID：10507375
> 
> 赞同：3
> 
> 时间：2012-05-08T22:17:10.073
> 
> 标签：objective-c, c, xcode

我有一个项目包含目标 c 和 c 文件的混合。在其中一个 c 头文件中，我尝试导入 complex.h。Xcode 生成连接到 NSObjRuntime.h 的 13 个编译错误：

NSObjRuntime.h

解析问题预期的标识符或“（”

解析问题未知类型名称'NSString'...

NSZone.h 会产生更多的编译错误。

在我看来，错误来自 .c 文件中无法识别的 Objective C 代码。我应该将我的 c 文件转换为目标 c 以导入 complex.h 还是有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T22:25:07.860

> 在我看来，错误来自 .c 文件中无法识别的 Objective C 代码。

确切地。

> 我应该将我的 c 文件转换为目标 c 以导入 complex.h 还是有更优雅的解决方案？

在这个例子中不需要使用 objc。因此，无需将其编译为 objc。`complex.h`不需要或包含 objc 标头。

您只是在 c 翻译中不包含 objc 标头。

如果此包含来自前缀标头，则可以使用：

```
#if defined(__OBJC__)
#import <Foundation/Foundation.h>
#endif 
```

如果它是通过您包含的另一个标头导入的，您将不得不考虑您的包含依赖项。有时有不必要的包含，有时您可以使用`#if defined(__OBJC__)`.

# r - 在包中包含“哈希表”

> ID：10507377
> 
> 赞同：2
> 
> 时间：2012-05-08T22:17:13.437
> 
> 标签：r, package

我正在整理一个我已经工作了将近一年的包。我有一个音节查找功能所需的哈希表。哈希表实际上只是一个查找表的环境（我想我不是计算机专家）。您可以在下面看到我创建它的功能。我有一个数据集`DICTIONARY`（大约 20,000 个字），将在加载包时加载。我还把这个`DICTIONARY`传递给散列函数，以便在加载包时创建一个新环境；像`env <- hash(DICTIONARY)`htis 这样的东西是我现在加载环境的方式。如何在加载包时使函数在启动时运行，以便为使用我的包的人创建这个新环境？

```
hash <- function(x, type = "character") {
    e <- new.env(hash = TRUE, size = nrow(x), parent = emptyenv())
    char <- function(col) assign(col[1], as.character(col[2]), envir = e)
    num <- function(col) assign(col[1], as.numeric(col[2]), envir = e)
    FUN <- if(type=="character") char else num
    apply(x, 1, FUN)
    return(e)
}

#currently how I load the environment with the DICTIONARY lookup table
env <- hash(DICTIONARY) 
```

`DICTIONARY`如果它有帮助，这里是标题：

```
 word syllables
1     hm         1
2    hmm         1
3   hmmm         1
4   hmph         1
5  mmhmm         2
6   mmhm         2
7     mm         1
8    mmm         1
9   mmmm         1
10   pff         1 
```

你们中的许多人可能会想“这取决于用户是否要加载环境”。有效点，但此软件包的目标受众是识字领域的人。该领域的 R 用户并不多，所以我必须让这个东西尽可能容易使用。只是想弄清楚我为什么要这样做的哲学，这样它就不会成为争论的焦点。

先感谢您。（PS 我看过本手册（[LINK](http://cran.r-project.org/doc/manuals/R-exts.html#Package-structure)），但似乎找不到有关此主题的任何信息）

**编辑：根据安德烈的建议，我认为它会是这样的？但我不确定。这会在包中的所有其他函数和数据集加载后加载吗？这件事让我有点困惑。**

```
.onLoad <- function(){
   env <- hash(DICTIONARY)
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-09T00:04:25.727

如果哈希将不经常更改（从您的问题描述来看，这似乎是这种情况），然后将哈希保存到您的包源树中

```
save(env, file="<my_pkg>/R/sysdata.rda") 
```

安装包后，`env`将在名称空间内可用，`my_pkg:::env`. 请参阅“编写 R 扩展”的第 1.1.3 节。您可能有一个脚本，例如在“/inst/scripts/make_env.R”中创建的脚本，`env`并且您作为开发人员在`env`需要更新的极少数情况下使用该脚本。

另一种可能性是哈希更改，但仅在*安装*包时发生。然后解决方案是编写在包安装时评估的代码。所以在文件 /R/env.R 中写一些类似的东西

```
env <- local({
    localenv <- new.env(parent=emptyenv())
    ## fill up localenv, then return it
    localenv[["foo"]] = "bar"
    localenv
}) 
```

解决的可能性`.onLoad`是每次加载包时数据都会发生变化，例如，因为它正在从某个在线源检索更新。

```
env <- new.env(parent=emptyenv())

.onLoad <- function(libname, pkgname)
{
    ## fill up env
    env[["foo"]] = "bar"
} 
```

# javascript - 在 Javascript 中更改每个对象的值

> ID：10507378
> 
> 赞同：1
> 
> 时间：2012-05-08T22:17:25.460
> 
> 标签：javascript

将附加路径信息添加到每个 javascript 对象的最佳方法是什么？就像每个 jpg 名称之前的“assets/img/upload/”？我有 url="assets/img/upload/02.jpg" 等？那将是很大的帮助！

我现在的数据：

```
[Object { url="02.jpg"}, 
 Object { url="03.jpg"}, 
 Object { url="09.jpg"}, 
 Object { url="04.jpg"}, 
 Object { url="5.jpg"}
 ...] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:20:30.600

一个简单的for循环：

```
for(var i = 0; i < array.length; i++)
{
  array[i].url = "assets/img/upload/" + array[i].url;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:20:48.790

假设您的对象数组称为 MyArray：

```
for (var i = 0, LoopTimes = MyArray.length; i < LoopTimes; i++) {
       MyArray[i].url = "assets/img/upload/" + MyArray[i].url;
} 
```

注意：

a) 左大括号与`for`语句在同一行。有关解释，请参阅 youtube 上 Javascript The Good Parts 上的 Crokfod。在 javascript 中，将左大括号放在下一行会产生一些难以检测的奇怪错误。

b) 我在 LoopTimes 中缓存了 MyArray 的长度，这样我就不必在每次迭代时评估数组的长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T23:01:58.227

如果你只打算在现代浏览器中运行这段代码，你总是可以考虑使用对象的`map`方法`Array`。

假设您的对象数组称为“数组”

```
array.map(function(item) {return item.url = "assets/img/upload/" + item.url;}); 
```

这将运行匿名函数，该函数接受数组中的“项目”，并在数组的每个元素上返回修改后的 url 字段。

如果您需要您的代码在旧版浏览器上运行，请坚持使用其他贡献者建议的 for 循环。

# javascript - 我的 mailto 链接中的换行符在 Android 手机上已损坏

> ID：10507387
> 
> 赞同：2
> 
> 时间：2012-05-08T22:18:17.143
> 
> 标签：javascript, android, mailto

我有一个 Web 应用程序，我正在尝试针对移动设备进行优化，而我直接的 mailto 功能无法在我的 Android 手机上的默认邮件客户端上运行。它适用于 gmail 客户端，但不适用于与 Exchange 电子邮件集成的本机客户端。（它似乎也适用于 iphone fwiw。）本机客户端中发生的情况是回车后的所有内容都被切断。所以说我有以下内容：

```
 sendLinkByEmail: function (subject, message, url)
    {
        var parsedMessage = encodeURIComponent("Isn't this cool?\n I am sending you an email!");
        var emailLink = "mailto:?Subject=" + encodeURIComponent(subject) + "&body=" + parsedMessage;
        window.location = emailLink;
        return false;
    } 
```

如果我选择使用 Gmail 应用程序打开，我会看到我所期望的：

> 这不是很酷吗？
> 
> 我给你发了封邮件！

但是如果我用邮件应用程序打开它，我会得到

> 这不是很酷吗？

就是这样。

如果我使用 %0A 或 %0D%0A 而不是 \n 或者如果我不使用 encodeURIComponent（例如，消息只是字面上的“Foo%0D%0ABar”——我只是得到 Foo），也会发生同样的事情。

我无法弄清楚那个愚蠢的邮件客户端在做什么！有人知道吗？

非常感谢！！！

* * *

刚刚意识到我的问题甚至更大——即使是编码 & (%26) 之后，愚蠢的邮件客户端也会截断任何内容，因此我也无法嵌入 URL，这是该功能的重点。

从 web 应用程序打开邮件客户端是否有任何替代 mailto 的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:27:21.237

根据我的经验，您在 mailto: 链接中使用 \n 的成功因邮件客户端而异。我发现最好的方法是使用 %0d 代替 \n，但即便如此，并非所有客户端都会支持它。

如果格式对您很重要，那么 mailto: 链接不是您想要的。

# c# - C# webservice 将类转换为自身

> ID：10507389
> 
> 赞同：4
> 
> 时间：2012-05-08T22:18:30.680
> 
> 标签：c#, .net, web-services

我遇到了网络服务的问题。我通常的开发方法是创建如下类。

```
namespace Project.Entities
{
    public class Entity
    {
        //Some Members        
    }
}
namespace Project.Service
{
    public class EntityService
    {
        public Project.Entities.Entity Get(int EntityID); 
        // More Methods to retrive Entities
    }
} 
```

当允许应用程序/网站直接访问数据库时，这对我来说很好。我现在需要通过 web 服务公开 Project.Service 方法，例如

```
namespace Project.API
{
    public class EntitiyWebService
    {
        [WebMethod()]
        public Project.Entities.Entity Get(int EntityID)
        {
            return new Project.Service.EntityService(EntityID);
        }
    }
} 
```

我的问题是，如果我从另一个应用程序（使用 Project.Entities）调用我的 web 服务，我无法转换`Project.Entities.Entity`为`Project.API.EntityWebService.Entity`. 我想我明白为什么这不能编译，因为就编译器而言，这两个类除了它们的名字之外没有任何共同之处。

我真正需要知道的是我是否因为不良做法而遇到了这个问题，如果我需要尽快开始重新设计，或者我不应该担心它，只是在我的应用程序中将我的引用从 更改`Entities.Entity`为`API.EntityWebService.Entity`（当然这可以' t 是最好的解决方案），或者我将如何创建转换方法，因为我的应用程序和我的 web 服务都使用相同的 DLL，它只是引入了需要转换的 web 服务。或者如果我错误地实施了正确的想法，或者错过了一些东西。或者以上都不是...

我考虑过让我的 web 服务只返回 XML 并在我的应用程序中序列化结果，但这似乎是一种冗长的方法，必须有更好的解决方案。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T22:22:45.030

在处理 Web 服务时，我们采取了不尝试让 .net 对自定义对象进行常规序列化/反序列化的方法。

相反，我们使用 JSON 传递所有内容。有一些标准工具可以使序列化/反序列化过程非常顺利。如[http://json2csharp.com/](http://json2csharp.com/)和[http://json.codeplex.com/](http://json.codeplex.com/)

有几个原因。首先是通过使用像 JSON 这样的标准，那么几乎所有的东西都可以使用它。其次，XML 很混乱……非常混乱。做对也很难，做错也很容易。第三，我们可以更轻松地控制准确的输出。

Finally, an interesting note about passing JSON objects is that you can add new fields to it at the provider and change your consumers at a later date. It's very forgiving.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T22:37:57.727

You shuld start using WCF.

In WCF you can expose the data you want using DataContracts.

All the serialization and deserialization happens automatically, and you get the same type on the client and on the server with no additional effort.

# c# - 提取所有函数声明的正则表达式

> ID：10507390
> 
> 赞同：0
> 
> 时间：2012-05-08T22:18:31.980
> 
> 标签：c#, regex

我不擅长正则表达式，所以我需要一个正则表达式的帮助，它可以从 word doc 中提取所有 C 函数声明。我已经在内存中加载了单词 doc 并阅读了文本，所以这不是问题。此外，所有函数都以 INTERNAL_ 开头，显然以 ); 结尾。例如

INTERNAL_DisplayMessage ( 参数 a, int b );

所以基本上，我需要将整个函数声明从 INTERNAL_ 提取到 ; 的正则表达式。所有 API 的返回值都是相同的，所以这无关紧要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T22:27:58.233

像`(INTERNAL_.+?\);)`应该工作一样简单的东西。对于这些类型的任务，我强烈推荐[RegExr 。](http://gskinner.com/RegExr/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T23:06:58.757

您需要使用此正则表达式：

```
 (INTERNAL_[^ ]+?\s?\(.*?\);) 
```

外括号使函数的所有文本都被捕获在一个组内。

函数声明括号用反斜杠转义`\(` `\)`，因此它们被视为文字，而不是分组。

`[^ ]\s?`表示任何不是空格的字符，一次或多次，后跟一个可选空格，就在左括号之前

`.*?`表示任何字符，`*`任何次数（包括 o），尽可能最少

由于您的函数声明在其中包含 \n ，因此您需要使用该`RegexOptions.Singleline`选项作为 Regex 构造函数的第二个参数来创建您的正则表达式：

> 指定单行模式。更改点 (.) 的含义，使其匹配每个字符（而不是除 \n 之外的每个字符）。

请参阅文档：[RegexOptions 枚举](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regexoptions%28v=vs.95%29.aspx)

一个检查正则表达式的好地方是这个：

[www.regexplanet.com](http://www.regexplanet.com/)

它使您可以更改语言并设置选项。对于 SinleLine 选项，请检查该页面上的“点 (.) 匹配每个字符而不是除换行符 (Singleline) 之外的每个字符”选项。

# javascript - 在 Adob e AIR 中加载的 .swf 找不到其媒体文件

> ID：10507392
> 
> 赞同：0
> 
> 时间：2012-05-08T22:18:52.277
> 
> 标签：javascript, flash, air, swfobject

我正在开发一个加载从 InDesign（交互式书籍）导出的 .swf 文件的 Adob​​e AIR javascript 应用程序。该 .swf 有一个“MySWF_Resources”目录，其中包含一个示例 .flv 视频。

问题是，当我使用 SWFobject 将该 .swf 加载到我的 AIR 应用程序中时，它失去了加载其资产的能力 - 在 AIR 环境中运行时路径不正确。在浏览器中执行的同一个 .swf 文件会从“MySWF_Resources”目录正确加载视频。

是否可以以某种方式强制 .swf 应在其中查找文件的工作目录？AIR 以某种方式破坏了包含的 .swfs 的相对路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T19:03:05.683

以下是如何通过 SWF 在空中应用程序中包含 FLV/电影文件。您需要使用 FLV 文件的绝对路径，因为 Flash 不知道 Air app:/ 结构。您可以执行以下操作：

1.  包括 AIRAliases.js（位于 air sdk 包中）
2.  包括 jPlayer ([链接](http://www.jplayer.org))
3.  添加用于调用的空中事件侦听器（[LINK](http://help.adobe.com/en_US/air/html/dev/WS5b3ccc516d4fbf351e63e3d118676a5d46-8000.html#WS5b3ccc516d4fbf351e63e3d118676a5d46-7ffc)）
4.  将当前目录保存到 javascript 中的变量/对象
5.  位置的反斜杠 ( `myVar.replace(/\\/g,"/")`)
6.  将 location + file.flv 传递给 jPlayer 对象

使用 jPlayer 可以节省许多步骤，但如果您想通过标准 SWF 来完成，则需要通过 javascript 创建嵌入/对象并传入 flashvars 以获取 FLV 文件的位置。然后让 flashvars 通过 ActionScript ( [LINK](http://helpx.adobe.com/flash/kb/pass-variables-swfs-flashvars.html) ) 在 SWF 中设置内容源。

# ruby-on-rails - 建立关系记录时内存膨胀

> ID：10507393
> 
> 赞同：1
> 
> 时间：2012-05-08T22:18:58.173
> 
> 标签：ruby-on-rails, ruby, memory-leaks, mongoid

在关系上构建记录时，我遇到了占用太多内存的过程。在谈论这样的代码时应该预料到：

注意`Scan`和`Item`是 Mongoid 文档和扫描`has_many`项目。

```
1000.times do
  item = scan.items.build
  item.save
end 
```

我不需要这种关系来保存这些对象，所以我第一次尝试绕过它是这样的：

```
1000.times do
  item = Item.new(scan_id: scan.id)
  item.save
end 
```

不幸的是，它产生了相同的结果。它不在垃圾收集中。这是一个快速测试：

```
class Foo
end

1000.times do |i|
  foo = Foo.new
  if i % 100 == 0
    ObjectSpace.garbage_collect 
    puts ObjectSpace.each_object(Foo).count 
  end  
end 

# => 1
# => 2
# => 2
# => 2
# => 2
# => 2
# => 2
# => 2
# => 2
# => 2

1000.times do |i|
  item = Item.new(scan_id: scan.id)
  item.save
  if i % 100 == 0
    ObjectSpace.garbage_collect 
    puts ObjectSpace.each_object(Item).count 
  end  
end 

# => 100
# => 200
# => 300
# => 400
# => 500
# => 600
# => 700
# => 800
# => 900
# => 1000 
```

所以我的问题是如何使用关系的引用创建记录，而不会因`scan.items`持有这些对象的关系而导致内存膨胀？甚至可能吗？

编辑：

即使每隔一段时间重新加载`scan`一次`reload`方法也无济于事，WeakRef 也无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T18:57:15.437

该问题可能是由身份映射引起的。身份映射将文档存储在内存中，因此可以重复使用它们，而不是为同一个文档多次访问 db。在 Rails 中，身份映射在每次请求后都会自动清除，因此通常我们不会注意到内存消耗有太大差异。但是，当在请求-响应周期之外工作时，应该使用`unit_of_work`. 查看[Mongoid：IdentityMap](http://mongoid.org/docs/identity_map.html)了解更多详情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T22:35:31.763

如果可能，我会尝试利用 ActiveRecords find_each

[APi on ActiveRecord 的 Find Each](http://apidock.com/rails/ActiveRecord/Batches/ClassMethods/find_each)

如果那不可行，那么我会做一个 find_in_batches。祝你好运！

# android-camera-intent - 相机意图拍摄的照片的方向

> ID：10507398
> 
> 赞同：1
> 
> 时间：2012-05-08T22:19:12.770
> 
> 标签：android-camera-intent, android-contentresolver

我通过有意启动它从相机中捕获了几张图像。

```
Intent cameraIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE); 
```

当我在捕获图像后在视图中显示图像时，它的方向始终是横向的，无论它是以纵向还是其他方式捕获的。我希望这是基于我在这个论坛上读到的内容。

但是，当我在图库应用程序或文件管理器中查看它时，它会以正确的方向显示。

图库应用程序如何知道捕获方向是什么？我想访问相同的信息，但它似乎不在 ExifInterace 或 ContentResolver 中。

# php - 将变量传递给 iframe（相同域）

> ID：10507402
> 
> 赞同：0
> 
> 时间：2012-05-08T22:19:30.990
> 
> 标签：php, wordpress, cookies, session-variables

我如何将变量传递给同一域上的 iframe。

我能想到的最合乎逻辑的方法是使用会话变量或 cookie？

为了把它放在上下文中，它是 wordpress 页面的类别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:23:02.113

`parent`您可以使用javascript中的关键字访问父窗口

例子：

```
var newValue = parent.getElementById('inputValue').value; 
```

也可以访问子窗口

```
var iframeElement = document.getElementById("MyFrame");

var ifram = (iframeElement.contentWindow) ? iframeElement.contentWindow : (iframeElement.contentDocument.document) ? iframeElement.contentDocument.document : iframeElement.contentDocument; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T22:24:38.833

它确实取决于您尝试传递的变量类型... Javascript，PHP，还是对您有影响？

# ruby-on-rails - Capybara 使用 find('') 检测 CSS ID 模型 ID

> ID：10507404
> 
> 赞同：0
> 
> 时间：2012-05-08T22:20:17.403
> 
> 标签：ruby-on-rails, unit-testing, rspec, capybara

我目前正在使用 Intranet 工作，其中包括创建发票。

在编写测试时，我使用 Rspec 和 Capybara 进行测试，在运行请求测试时，我想创建一张发票并添加一些项目以确保正确计算增值税。

但是，我似乎遇到了一个问题，即 Capybara 找到第一个 #item_price 并尝试匹配它而不是新创建的项目。

以下是我的请求测试中的一些代码。

```
...
...
# Laptop for 369.96 inc vat
click_link "Add Item"
fill_in "Quantity", :with => 1
fill_in "Price", :with => 369.96
fill_in "Description", :with => "laptop for 369"
click_button "Create Item"
page.should have_content("Item was successfully created")

find('#item_quantity').should have_content(1)
find('#item_price').should have_content(369.96)
find('#item_description').should have_content("laptop for 369")
find('#item_total').should have_content(369.96)

find('#invoice_subtotal').should have_content(308.30)
find('#invoice_vat').should have_content(61.66)
find('#invoice_total').should have_content(369.96)

# Laptop for 337.53 inc vat
click_link "Add Item"
fill_in "Quantity", :with => 1
fill_in "Price", :with => 337.53
fill_in "Description", :with => "laptop for 337"
click_button "Create Item"
page.should have_content("Item was successfully created")

find('#item_quantity').should have_content(1)
### the offending code below
find('#item_price').should have_content(337.53)
###
find('#item_description').should have_content("laptop for 337")
...
... 
```

我希望能够添加`#item_price_2`2 将是项目 ID。执行此操作并更改`find('#item_price').should have_content(337.53)`为`find('#item_price_#{invoice.id}').should have_content(337.53)`我得到异常：

```
Nokogiri::CSS::SyntaxError:
unexpected '#' after '[#<Nokogiri::CSS::Node:0x007f991889f270 @type=:CONDITIONAL_SELECTOR, @value=[#<Nokogiri::CSS::Node:0x007f991889f3d8 @type=:ELEMENT_NAME, @value=["*"]>, #<Nokogiri::CSS::Node:0x007f991889f9c8 @type=:ID, @value=["#item_price_"]>]>]' 
```

将其更改为双引号也会`"#item_price_{invoice.id}"`给我这个例外：

`undefined local variable or method`# 发票'

我猜这是因为我没有使用 FactoryGirl，所以`invoice`还没有设置为方法。在这种情况下，我没有使用 FactoryGirl，因为我想测试用户如何与发票和项目表单进行交互。

解决此问题的最佳方法是什么？有没有更好的方法来做我想做的事情？

提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:13:29.793

`invoice`您关于尚未设置的猜测是正确的。提交表单后，您可以设置它：

`invoice = Invoice.last`

然后你的规格应该通过。

# java - 使用哪个图像

> ID：10507409
> 
> 赞同：6
> 
> 时间：2012-05-08T22:21:03.993
> 
> 标签：java, image, bufferedimage, imageicon

我已经阅读了 java api，但我仍然不明白两者之间的主要区别：

1) ImageIcon 2) BufferedImage 3) VolatileImage 4) 图像

有人能告诉我每个人什么时候使用吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-08T23:02:22.950

我不会将此解释称为使用 Java Image 类型的绝对标准，但这些是我遵循的经验法则：

**1\. 图像图标**

这通常在您想要添加到按钮或用作窗口图标的小图像时使用。这些可以直接从任何实现`Image`接口的东西中创建。

**2.缓冲图像**

通常在您需要操作图像中的单个像素时使用，或者当您想要双缓冲自定义`paint(Graphics g)`方法时使用。映像驻留在 RAM 中，因此它会占用大量空间，并且对`BufferedImage`实例的修改通常不是硬件加速的。

**3\. VolatileImage**

硬件加速的图像，所以它很快，但是在你完成绘画之前你会冒着硬件支持的缓冲区被覆盖的风险（尽管这种情况很少发生，根据 Oracle 的说法，这只是基于 Windows 的机器的问题）。`BufferedImage`它比双缓冲自定义方法更难使用`paint(Graphics g)`，但如果您发现自己在渲染到屏幕之前做了很多预处理，那么它是非常值得的。

**4\. Image** 这基本上只是一个接口，它定义了每个人都`Image`应该拥有的一些基本功能。当您不需要修改图像的内容和/或想要使处理只读图像数据的方法最灵活时，您应该使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T23:13:57.603

此外，ImageIcon 实现了可序列化，因此您可以通过 java 套接字发送它。如果您有 Image 对象，则必须将它们转换为 ImageIcon 并发送。当客户端获取 ImageIcons 时，它可以再次将它们转换为图像。

# javascript - JavaScript - 从脚本将值写入 html 表单

> ID：10507410
> 
> 赞同：5
> 
> 时间：2012-05-08T22:21:09.980
> 
> 标签：javascript, html, forms

我想知道如何将值输入到带有 html 的表单中。因此，当用户访问该站点时，文本框中已经有数字，他们使用这些数字来玩和“加法游戏”。这是我到目前为止所拥有的：

```
 <script type="text/javascript">

    function addSubmit() {
//trying to have num1 and num2 write into the html form
    var num1= Math.floor(89+Math.random()*11);
    var num2 = Math.floor(89+Math.random()*11);
    /*num1 = value1
    num2 = value2*/
    document.getElementById("value1").value = num1;
    document.getElementById("value2").value = num2;

    var guess = document.getElementById("submit").value;
    var answer = num1 + num2;
    //have to write this to main window
    if (guess == answer)
    document.writeln("Congratulations you answered correctly! The answer to: "+num1+"+"+num2+"= "+answer);
    else
    document.writeln("Nice try, but the correct answer to: "+num1+"+"+num2+"= "+answer);
    }

    function addGiveUp() {
    var num1 = Math.floor(89+Math.random()*11)
    var num2 = Math.floor(89+Math.random()*11)
    document.addition.value1.value=num1;
    document.addition.value2.value=num2;
    var guess = document.getElementById("submit").value;
    var answer = (document.getElementById("value1").value) + (document.getElementById("value2").value);
    document.writeln("Never give up! The answer to: "+num1+"+"+num2+"= "+answer);
    }
    </script>
    <form name="addition" action="" method="get">
    <table border="1">
             <tr>
         <td>Value 1:</td> <td><input type="text" name="value1" id="value1"/></td>
                 </tr>
             <tr>
         <td>Value 2:</td> <td><input type="text" name="value2" id="value2"/></td>
                 </tr>
             <tr>
         <td>Answer:</td> <td><input type="text" id="answer" /></td>
                 </tr>
             <tr><td><input type="button" value="Submit" onClick="addSubmit()" id="submit" /></td><td><input type="button" value="Give Up" onClick="addGiveUp()" /></td></tr>
             </table>
    </form> 
```

我很感激任何帮助！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:45:11.637

好吧，您可以在创建表单后放置此脚本：

```
<form name="addition" action="" method="get">
            <table border="1">
                     <tr>
                 <td>Value 1:</td> <td><input type="text" name="value1" id="value1"/></td>
                         </tr>
                     <tr>
                 <td>Value 2:</td> <td><input type="text" name="value2" id="value2"/></td>
                         </tr>
                     <tr>
                 <td>Answer:</td> <td><input type="text" id="answer" /></td>
                         </tr>
                     <tr><td><input type="button" value="Submit" onClick="addSubmit()" id="submit" /></td><td><input type="button" value="Give Up" onClick="addGiveUp()" /></td></tr>
                     </table>
</form>

<!-- This is the script-->
 <script type="text/javascript">
      document.getElementById("value1").value = Math.floor(89+Math.random()*11);
      document.getElementById("value2").value = Math.floor(89+Math.random()*11);​
  </script> 
```

这将为您生成随机数并将它们放入表格中参见此处的代码：http: [//jsfiddle.net/wVAFt/](http://jsfiddle.net/wVAFt/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:26:49.133

```
<input type="text" id="answer" value="5" >

or

document.getElementById("answer").value = "5"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:46:48.530

要在输入字段中包含数字，您可以将它们设置为具有值，例如`value="10"`默认值是 10，直到用户更改它。

# asp.net - 更改 Gridview 数据源或选择语句 ijn 代码？

> ID：10507412
> 
> 赞同：0
> 
> 时间：2012-05-08T22:21:23.067
> 
> 标签：asp.net, .net, sql-server, parameters, sqldatasource

我有一个带有 sqldatasource 等的 gridview。对于网格，我还有一个搜索文本框。如果用户需要过滤记录，我想使用带有参数的 sql 过程动态调整 SqlDataSource 的 SELECT 语句，可以从文本框中获取值。我喜欢分页、排序等所有自动功能，所以我不想只绑定旧方式。

有什么线索吗？

谢谢，

```
 <form id="form1" runat="server">
    <div>

        <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
            ConnectionString="<%$ ConnectionStrings:NorthwindConnectionString %>" 
            SelectCommand="SelectCategorie" SelectCommandType="StoredProcedure">
            <SelectParameters>
                <asp:ControlParameter ControlID="TextBox1" Name="CategorieName" 
                    PropertyName="Text" Type="String" />
            </SelectParameters>
        </asp:SqlDataSource>
        <asp:SqlDataSource ID="SqlDataSource3" runat="server" 
            ConnectionString="<%$ ConnectionStrings:NorthwindConnectionString %>" 
            SelectCommand="SELECT [ProductName], [ProductID] FROM [Alphabetical list of products]">
        </asp:SqlDataSource>
        <br />
        <br />
        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        <br />
        <asp:Button ID="Button3" runat="server" Text="Button" />
        <br />
        <br />
        <asp:DropDownList ID="DropDownList1" runat="server" 
            DataSourceID="SqlDataSource3" DataTextField="ProductName" 
            DataValueField="ProductName">
        </asp:DropDownList>
        <br />
        <br />
                <asp:Button ID="Button2" runat="server" Text="Change the datasource" />
        <br />
        <br />
                <asp:GridView ID="GridView1" runat="server" 
                    DataKeyNames="ProductID" DataSourceID="SqlDataSource1">
                    <Columns>
                        <asp:BoundField DataField="ProductID" HeaderText="ProductID" 
                            InsertVisible="False" ReadOnly="True" SortExpression="ProductID" 
                            DataFormatString="[Yassine {0}]" />
                        <asp:BoundField DataField="ProductName" HeaderText="ProductName" 
                            SortExpression="ProductName" />
                        <asp:BoundField DataField="SupplierID" HeaderText="SupplierID" 
                            SortExpression="SupplierID" />
                        <asp:BoundField DataField="CategoryID" HeaderText="CategoryID" 
                            SortExpression="CategoryID" />
                        <asp:BoundField DataField="CategoryName" HeaderText="CategoryName" 
                            SortExpression="CategoryName" />
                        <asp:BoundField DataField="Description" HeaderText="Description" 
                            SortExpression="Description" />
                        <asp:BoundField DataField="QuantityPerUnit" HeaderText="QuantityPerUnit" 
                            SortExpression="QuantityPerUnit" />
                        <asp:BoundField DataField="UnitPrice" HeaderText="UnitPrice" 
                            SortExpression="UnitPrice" />
                        <asp:BoundField DataField="UnitsInStock" HeaderText="UnitsInStock" 
                            SortExpression="UnitsInStock" />
                        <asp:BoundField DataField="UnitsOnOrder" HeaderText="UnitsOnOrder" 
                            SortExpression="UnitsOnOrder" />
                        <asp:BoundField DataField="ReorderLevel" HeaderText="ReorderLevel" 
                            SortExpression="ReorderLevel" />
                        <asp:CheckBoxField DataField="Discontinued" HeaderText="Discontinued" 
                            SortExpression="Discontinued" />
                    </Columns>
                </asp:GridView>
        <br />
        <br />

    </div>
    </form> 
```

和幕后的代码：

```
Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Button2_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button2.Click
        SqlDataSource1.SelectCommand = "SelectCategorieParDescription"
        SqlDataSource1.SelectParameters.Add("@ProductName", DropDownList1.DataValueField)
    End Sub
End Class 
```

这是我得到的错误：

**过程或函数 SelectCategorieParDescription 指定的参数过多**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:45:29.407

我们对您想要做的事情使用类似的方法。困难的方法如下（您可以[在此处](http://www.codeproject.com/Articles/104299/Very-Powerful-Generic-Irony-Based-Database-Searche)查看有关此的文章：

1.  为您的搜索语法创建语法
2.  为该语法创建解析器
3.  与解析器一起创建一个解释器，将您的搜索语法转换为 SQL（WHERE 部分）
4.  创建一个存储过程，可以使用这个 whereSql 字符串并与完整的查询连接并调用 EXEC(@sqlQuery)

但是，所有这些可能需要您一段时间，另一种选择是将您的搜索功能限制为单个字符串。例子：

1.  假设您的查询可以搜索 2 列：名称、socsecNumber
2.  每当您读取字符串 john 时，您会将其转换为： name like '%john%' or (convert socsecNumber to string) like '%john%'
3.  由您决定是否始终使用 % ，或者仅当用户的输入类似于：joh*
4.  接收 where 查询的存储过程有点像这样：

    ```
    ALTER PROCEDURE [dbo].[usp_SearchForObjectsForDashboard]
        @searchTerm as varchar(250)
    BEGIN
        ...
        SET @sql = 'SELECT ...
            ...
            WHERE someConditionOfYourOwn = whatever
             AND ' + @searchTerm

        EXEC(@sql) 
    END 
    ```

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:17:19.350

我会尽量详细说明。为您的问题提供编码解决方案有点超出范围。我将提供一些关于如何处理这个问题的想法。希望其他人也能为此添加一些有价值的观点。

搜索可以通过多种方式实现。这完全取决于您的要求和搜索的效率。根据您的问题，我相信您正在尝试实现的是进行搜索和几个过滤选项

例如说你想搜索员工（并说你想按名字/姓氏/部门/经理搜索）

**首先你可以有（除了 GridView 和 SqlDataSource）**

1）搜索框的文本框。

2) 按选项搜索（4 个 RadioButtons 或带有`firstname`, `lastname`, `department`,的 DropDownList `manager`）

3）一个按钮

4) 带有两个参数 ( `searchText`, `searchBy`)的存储过程

在您的存储过程中，根据您的`SearchBy`类型，您可以通过以下方式构建您的选择搜索查询`searchText`

**伪代码**

```
if (searchBy == firstname)
{
    set @sql = select ...... where firstName = searchText
}
else if (searchBy == lastname)
{
    set @sql = select ...... where lastName = searchText
}
else if (searchBy == department)
{
    set @sql = select ...... where department = searchText
}
else if (searchBy == manager)
{
    set @sql = select ...... where manager = searchText
}

exec(@sql) 
```

在您的 button_click 中，您将从 DropDownList 或 RadioButton`searchText`的 TextBox中更改 sqlDataSource Select Parameters `searchBy`

这又是极简主义。您可以根据需要扩展它。例如

1)`like`在选择查询中使用子句来获取相似匹配而不是完全匹配（在 UI 中，您可以为用户提供在精确、相似匹配之间进行选择的选项）

2）您可以为用户提供在多个列中搜索的选项

等等（选项是无穷无尽的；同样取决于您的要求）

# c++ - c ++迭代器循环与索引循环

> ID：10507414
> 
> 赞同：1
> 
> 时间：2012-05-08T22:21:48.463
> 
> 标签：c++, iterator, boost-tokenizer

我知道这是一个非常愚蠢的问题，但我想澄清一下。

假设我有一个字符串向量看起来像，

```
vector<int> vnTemp; // suppose this vector has {1,2,3,4,5}
vector<int>::iterator vn_it;

//Now, I want to print out only 1 to 4.
for(int i=0; i<4; ++i)
    cout << vnTemp[i] << endl; 
```

非常简单。但是当我想使用迭代器打印出等效结果时该怎么办？例如，

```
// .. continuing from the code above
for(vn_it = vnTemp.begin(); vn_it != vnTemp.end()-1; ++vn_it)
    cout << *it << endl; 
```

当然，`vnTemp.end()-1`由于它是指针，所以会导致错误。

在这种情况下，等效的 for 循环是什么？当它们都在优化（-o）模式下编译时是否有任何性能差异？

* * *

编辑：

我刚刚意识到这实际上适用于`vector`. 我使用`boost::tokenizer` 代码时发生的问题是这样的：

```
typedef boost::tokenizer<boost::char_separator<char> > tokenizer;

boost::char_separator<char> sep("_");
tokenizer::iterator tok_it;

tokenizer tokens(strLine, sep); //strLine is some string line
for(tok_it=tokens.begin(); tok_it != tokens.end(); ++tok_it){
... } 
```

这是原始代码，当我尝试`tokens.end()-1`在 for 循环中说时发生错误。

有什么办法可以解决这个问题吗？对歧义感到抱歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T22:50:25.897

`boost::tokenizer`只提供前向迭代器；这意味着您不能从分词器迭代器中减去。如果您希望循环避免处理最后一个令牌，则必须在处理您所在的令牌之前“先行”。像这样的东西

```
tokenizer tokens(strLine, sep); //strLine is some string line
tok_it = tokens.begin();
if(tok_it!=tokens.end())
{
    ++tok_it;
    for(auto last_tok = tokens.begin(); tok_it != tokens.end(); ++tok_it){
        // Process last_tok here
        . . .
       last_tok = tok_it;    
    }
} 
```

**编辑：** 另一种方法是将令牌复制到具有更灵活迭代器的容器中：

```
std::vector<std::string> resultingTokens(tokens.begin(), tokens.end());
for(auto tok=resultingTokens.begin(); tok!=resultingTokens.end()-1; ++tok)
{
    // whatever
} 
```

# c# - 在 C# 中解析 JSON API

> ID：10507416
> 
> 赞同：16
> 
> 时间：2012-05-08T22:21:54.750
> 
> 标签：c#, json, parsing, json.net

所以我对编程还很陌生，但我希望能更深入地了解它。我最近开始参与一个项目，为一个在 JSON 中使用 API 系统的网站创建一个 WinForm 程序。

我以前从未使用过 API，所以我不太确定它是如何工作的，但看了几分钟后，我似乎掌握了它的要点。我不明白在 C# 中解析 JSON 是如何工作的。

经过一番谷歌搜索后，我找到 [了这个链接。](http://www.masnun.me/2011/07/08/quick-json-parsing-with-c-sharp.html)我让它（在某种程度上）与这段代码一起工作。

```
static void Main(string[] args)
{
        WebClient c = new WebClient();
        var vLogin = c.DownloadString("https://www.openraid.us/index.php/api/login/username/password");
        //Returns string 
        //{"status":1,"error":null,"token":"250-1336515541-c48d354d96e06d488d1a2530071ef07c9532da26"} 
        //Token = random, no decisive length*/
        JObject o = JObject.Parse(vLogin);
        Console.WriteLine("Login Status: " + o["status"]);
        String sToken = "" + o["token"];
        Console.WriteLine(sToken);
        Console.WriteLine("");
        //Breaks after this
        var myRaids = c.DownloadString("https://www.openraid.us/index.php/api/myraids/"+sToken);
        JObject r = JObject.Parse(myRaids); //error occurs here
        String sEventId = "" + r["event_id"];
        Console.WriteLine("Event ID: " + sEventId);
        Console.ReadLine();
} 
```

所以对我来说，看起来我已经完成并处理了第一个页面，但是当我进入第二个页面时，我得到了这个错误。

> 从 JsonReader 读取 JObject 时出错。当前 JsonReader 项不是对象：StartArray。路径''，第 1 行，位置 1。

所以我想我的问题是，如何解析超过 1 页或 JSON 调用，以及将 JSON 对象的每个部分（例如 、 和 、 分解为 C# 字符串的最简单方法`status`是`error`什么`token`？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-28T11:56:21.980

您是否尝试过使用 JArray？取决于您要返回的对象类型

```
WebClient client = new WebClient();
var data = client.DownloadString("");
var jArray = JArray.Parse(data); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T01:54:31.873

JSON 需要括号用于数组和多个对象之间的逗号。

这是[根据 JSON 标准](http://www.json.org/)。我还建议[通过 NuGet 使用 JSON.net](http://nuget.org/packages/newtonsoft.json)而不是本机 JSON 解析器，除非它太过分并且你不能有额外的膨胀。

例如，您使用两个单独的 JSON 对象解析文件 - 以下内容不适用于 JSON 标准（两个对象之间缺少逗号，并且两个对象未用括号封装）：

```
{"status":1,"error":null}
{"status":2,"error":null} 
```

从文件中解析的以下 3 个 JSON 对象确实有效（具有多个对象的括号和对象之间的逗号）：

```
[{"glossary": {"title": "fun glossary","SeeAlso": ["GML", "XML"]},
{"glossary": {"title": "grey glossary","SeeAlso": ["GML", "XML"]},
{"glossary": {"title": "blue glossary","SeeAlso": ["GML", "XML"]}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:29:19.807

您可以使用 for 循环将每个 JSON 对象（数组）切割成更多对象，C# API 是 System.Json

```
var jsonArray = JsonArray.Parse(st);//st is the string which contain the JSON objects
foreach (var item in jsonArray) {
    JsonObject ob = new JsonObject(item);
    foreach (var t in ob.Values) {
        JsonObject oo = new JsonObject(t);
        foreach (var x in oo) {
            textBox1.AppendText(x.Key + “ : ” + x.Value + “\n”);
        }
    }
} 
```

# vb.net - xna / 内容管道 / 资产和屏幕管理

> ID：10507417
> 
> 赞同：0
> 
> 时间：2012-05-08T22:22:03.333
> 
> 标签：vb.net, xna

我是 XNA 的新手，这是一个哲学问题。在我见过的大多数示例中，游戏资源被定义为私有类变量，在 LoadContent 方法中加载，然后使用 Draw 方法进行绘制。如果我有一个有很多屏幕的大型游戏，那么这个类的顶部可能会有相当多的声明。

话虽如此，这是我的问题

1.  我应该在 Texture2D.FromFile() 上使用内容管道吗？

2.  除了更快的加载还有什么优势。

3.  我应该在 LoadContent() 子之外调用 Content.Load(Of T)([some assets name]) 吗？

您如何处理不同屏幕的加载资源？您是否在顶部声明所有资产？

先谢谢了，

埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:16:39.407

使用内容管道允许您使用二进制文件编译纹理，这样可以节省空间、加载时间，并保护您的资产免遭编辑/未经授权的使用（如果您关心的话）。另一方面，如果您希望资产是可编辑的（如纹理包），`FromFile()`这是有效的。该文件必须存在于预期的目录中，当然可以正常使用。

这是一种很好的做法，但最终取决于您选择加载内容的位置。请记住，内容加载需要从磁盘读取，这不是您想要确定的每一帧都做的事情，也不是我们在游戏期间真正喜欢做的事情。您需要设置游戏状态管理，以便在加载屏幕或游戏启动期间而不是在游戏本身期间完全加载内容。当然，这正是关卡加载屏幕的用途！如果您非常聪明，您可以在游戏暂停期间偷偷加载，这是银河战士 Prime 的“门加载”。但是，根据游戏的范围和资产，您实际上并不需要像那样动态加载。

最后，关于倾销资产：答案是 OO 编程的伟大比喻：抽象。如果您在组织成员时遇到问题，那么根据需要（并且仅在合理的情况下）将它们移动到继承的类或子类中。在我的游戏设计中，我很少有超过 2 `Texture2D`s， 1 `SoundBank`，也许每个类有一个`VertexBuffer`/ 。`IndexBuffer`如果我设计得很好，它们就会存储在像“Sprite”这样的基类中，任何视觉对象都从该基类中继承。在我最新的一组工具中，我已经深入了一个层次，所以现在它看起来像“ `Player.base`（即 Sprite）`.Animation.Texture`”，如果你想访问实际的纹理......但你不需要，因为所有动画/绘图由类完全处理`Animation`并由 Sprite 以及`Position`, `Rotation`, `Scale`,`Bounding`等更新。

所以，把你的游戏分解成对象。如果你在你的类中存储 a并且在你`Texture2D PlayerTex`的绘图中，你没有利用 OO 编程。存储在一个类中，该类还定义了播放器的所有其他方面和行为（方法）。现在您只需要 in ，并且在您调用. 你可以更进一步！这里有一些几乎每个游戏都会有的类：（所有动态对象的基类），（存储风景和每个关卡并处理它们的交互）， （存储并在每个完成时增加其成员）， （存储一堆`Vector2 PlayerPos``Game``Draw``PlayerTex``PlayerPos``PlayerTex``PlayerPos``Player``Game``Player myPlayer``Draw``myPlayer.Draw(SpriteBatch .. etc)``Entity``Level``Entities``GameScreen``Level``ScreenManager``Screen`s 来更新，比如`GameScreen`, `MenuScreen`, `PauseScreen`) `LoadingScreen`... 这个列表还在继续。在这一点上，你的`Game1`类所做的就是更新`ScreenManager`，如果你继承`ScreenManager`自`IDrawableGameComponent`，你甚至不必这样做。

我希望我没有深入到 OO 101 的深处，但是如果您在跟踪主类的所有成员时遇到困难，您应该开始分解。这是一项基本的 OO 技能。

如果一切都失败了，请学会自由地使用`#region <name>`/`#endregion`标签。老实说，无论如何都要使用它们，它们会让一切变得更好。

# scala - Scala：将@unchecked注释放在foreach中的位置

> ID：10507419
> 
> 赞同：4
> 
> 时间：2012-05-08T22:22:19.197
> 
> 标签：scala, foreach, unchecked

我有以下内容：

```
samples.sliding(2).foreach{case List(a, b)=> printf("%x %x\n", a.value, b.value)} 
```

我知道单个“案例”将匹配所有可能的值，但我收到“匹配并非详尽无遗”警告。Scala 书解释了将 @unchecked 注释放在普通完全指定的匹配表达式上的位置，但不适用于上面的形式。如何注释上述内容以阻止编译器抱怨？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-08T22:50:11.070

`@unchecked`只为匹配操作中的选择*器*定义，不为任意函数定义。所以你可以

```
foreach{ x => (x: @unchecked) => x match { case List(a,b) => ... } } 
```

但这有点拗口。

或者，您可以创建一种方法，将部分函数不安全地转换为完整函数（实际上只是转换为 的函数超类`PartialFunction`）：

```
def checkless[A,B](pf: PartialFunction[A,B]): A => B = pf: A => B 
```

然后你可以

```
samples.sliding(2).foreach(checkless{
  case List(a,b) => printf("%x %x\n", a.value, b.value)
}) 
```

并且您没有任何警告，因为它期待一个部分功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:13:23.990

不知道`@unchecked`，但为什么不直接调用`x.head`and `x.tail.head`or `x(0)`and `x(1)`呢？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-08T22:29:48.993

如果您确定它永远不会发生，为什么不添加一个虚拟案例？

```
samples.sliding (2).foreach {
  case List (a, b) => printf ("%x %x\n", a.value, b.value)
  case _           => sys.error ("impossible")
} 
```

# javascript - Phantom.js 不能从 OSX 控制台运行

> ID：10507428
> 
> 赞同：0
> 
> 时间：2012-05-08T22:23:50.757
> 
> 标签：javascript, macos, console, extjs, phantomjs

我正在开发一个 ExtJS 应用程序，我想使用 Phantom.js 将视图呈现为 pdf。我已经下载了 OSX 的二进制包，解压后添加了一个符号链接并将其添加到 PATH 中。在控制台中运行“phantomjs”后，我得到：

```
phantomjs script.js 
```

就这样。当我尝试运行任何示例脚本时，它会崩溃说`require is undefined`，我无法检查版本，基本上它是不可用的。我可以运行 bat 文件，它给了我 phantomjs shell。删除我之前下载的所有内容后，我仍然可以运行具有相同结果的“phantomjs”命令。可能是因为 Sencha 的 SDK 有它，但它在 PATH 中不可见，所以我不确定。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T01:35:34.000

一如既往地在提交问题后几秒钟发现问题。Sencha 的 SDK 有一些自定义或损坏的 phantomjs.bat 版本，并且整个文件夹被添加到 PATH 中。

# php - PHP 死函数

> ID：10507437
> 
> 赞同：1
> 
> 时间：2012-05-08T22:24:56.183
> 
> 标签：php, html, echo, die

我怎么能使用 php die 函数来阻止某些 div 加载？我知道它可能与死机不完全相同，但是我如何才能仅阻止特定的 div 加载？所以我希望不加载学习“col”和“col last”，而是加载 div id 栏。另外，如何使 if 语句中的 H2 标记不适用于 else 语句中的表？

```
<html>
<body>

<div id="header">
<div id="site">
    <h1><a href="#">site</a></h1>
    </div>

   <div id="menuholder">
    <ul id="menu">
        <li><a href="index.html">Home</a></li>
        <li class="active"><a href="about.php">about application</a></li>
        <li><a href="#">register</a></li>
        <li><a href="#">contact</a></li>
    </ul>
    </div>

</div>

<div id="teaser">
    <div class="wrap">
        <div id="image"></div>
        <div class="box">

<?php
session_start ();
if (isset($_SESSION['username']))
echo "<h2>Welcome, ".$_SESSION['username']."!</h2>";
else
die("You must be logged in to view this page. 
Register to gain access to learn more about the application.    
<form action='login.php' method='POST'>
<table>
<tr><td>Username: </td><td><input type='text' name='username'/></td><td>Password: </td> <td>              <input type='password' name='password'/></td> <td><input type='submit'  name='submit' value='Login'/></td></tr>
</table>
</form>
");

?>

            <p>Information about the application would go here</p>

        </div>

    </div>
</div>

<div id="bar">
    <div class="wrap">

    </div>
</div>

<div class="wrap">
    <div class="col">
        <h3>Learn <span class="red">More</span></h3>
        <p>More info </p>
    </div>
    <div class="col">
        <h3>User <span class="red">Statistics</span></h3>
        <p>More info</p>
    </div>
    <div class="col last">
        <h3>About <span class="red">Phapsy</span></h3>
        <p>More info</p>

    </div>
</div>

<div id="footer">
    <p class="right">Contact: </p>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:28:00.707

你不能。`die()`指示 PHP 停止进一步处理。

但是，这将起作用：

```
<?php
session_start ();
if (isset($_SESSION['username'])) {
    echo "<h2>Welcome, ".$_SESSION['username']."!</h2>";
    $auth = true;
} else {
    $auth = false; // Show the following HTML
?>
You must be logged in to view this page. 
Register to gain access to learn more about the application.    
<form action='login.php' method='POST'>
<table>
<tr><td>Username: </td><td><input type='text' name='username'/></td><td>Password: </td> <td>              <input type='password' name='password'/></td> <td><input type='submit'  name='submit' value='Login'/></td></tr>
</table>
</form>
<?php } // End ?> 
```

然后在别处...

```
<?php if ( $auth == true ) { // Display this HTML only if authenticated ?>
    <div class="col last">
        <h3>About <span class="red">Phapsy</span></h3>
        <p>More info</p>

    </div>
<?php } // End ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:27:59.193

在该部分中，只需使用and`else`显示您想要显示的任何文本。你不需要。`echo()``exit``die()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:29:19.027

使用 if 块：

```
<?php if($stuff): ?>
    <div></div>
<?php endif; ?> 
```

“死”是句号；有办法拦截它，但不是方便的方法。在稍微不同的情况下，“return”可能会做您需要的事情（因为它只退出当前函数或文件）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T22:30:07.103

“所以我希望不要加载学习“col”和“col last””。用鼠标突出显示这些线条。点击删除键:)

如果您不希望它们显示，请使用`if else`语句。它将`if`首先查看该部分，如果为真，则执行代码，如果为假，它将移至`else`语句并尝试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T22:30:57.683

请不要死！不要放弃希望——总有一个选择。

尝试从条件语句中输出您的标记。

# mysql - SQL按0排序

> ID：10507444
> 
> 赞同：-1
> 
> 时间：2012-05-08T22:26:06.500
> 
> 标签：mysql, sql-order-by

我在尝试订购我的结果集列表时遇到了一些困难。我试图创建分页。我有一张名为 Track 的表。我使用以下 sql 来检索分页使用的身份列表：

```
SELECT trackid FROM track ORDER BY filelength limit 10 
```

结果：

```
1
2
3
4
5
6
7
8
9
10 
```

然后，我执行以下语句：

```
SELECT * FROM track ORDER BY filelength ASC LIMIT 10 
```

我收到以下信息：

```
250   Track 250    0
251   Track 251    0   
252   Track 252    0   
253   Track 253    0   
254   Track 254    0   
255   Track 255    0   
256   Track 256    0   
257   Track 257    0   
258   Track 258    0   
259   Track 259    0 
```

在第二个结果集中，我看到结果集给出了不同的轨道，我希望第一个结果集中的 id 相同，但它似乎从 250 开始。为什么会这样？

我在这个表中有大约 20000 行，所有列文件长度列都是 0。

我正在运行 Mysql 服务器 5.1.30 - 社区版

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T22:33:49.750

你自己说的：

> 并且所有列文件长度列都是 0。

`ORDER BY filelength`噪音也是如此，将返回**任意行。**数据库引擎将以特定于实现的方式选择*任何*行，因为它们都具有同等资格并且没有指定特定的顺序。

关系数据库的表中不**存在“自然顺序”之类的东西。**你似乎在假设。

使用有意义的列以`ORDER BY`定义的顺序选择行。像：

```
SELECT trackid FROM track ORDER BY trackid LIMIT 10；

```

* * *

为达到这个：

> 我基本上想要一个只包含第二个查询的 id 的结果集（可选没有限制）

尝试：

```
SELECT trackid
FROM   track
WHERE  trackid BETWEEN 250 AND 259
ORDER  BY trackid; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T22:30:47.973

你从两张不同的桌子上拉出来。`playitem`不是`track`：

```
SELECT trackid FROM playitem ORDER BY filelength limit 10
SELECT * FROM track ORDER BY filelength ASC LIMIT 10 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-08T23:09:05.990

Well if you are trying to use this for pagination. In SQL the LIMIT clause can take two arguments. With two arguments, the first argument specifies the offset of the first row to return, and the second specifies the maximum number of rows to return. The offset of the initial row is 0 (not 1)

For example, the first one would be:

```
LIMIT 0, 10 
```

The next one would be:

```
LIMIT 10, 10 
```

The next one would be:

```
LIMIT 20, 10 
```

And so on...

# javascript - 带有热键的可滚动无序列表

> ID：10507446
> 
> 赞同：1
> 
> 时间：2012-05-08T22:26:12.677
> 
> 标签：javascript, jquery, html

我正在尝试构建一个无序列表 i HTML，用户可以在其中“选择”列表项（基本上，单击时它们只是被复制到 div 中）

虽然这很容易实现，但用户还应该能够按键盘上的一个键使列表滚动到第一个列表项，该列表项的第一个字母等于按下的键的字母。

图片供参考：

![在此处输入图像描述](../Images/144f53c549ce62aa76cb32c064ae3554.png)

假设上面的列表中有 200 多个列表项，我想“搜索”/去**飞机**，我在键盘上按了**A**，列表滚动到列表中以“a”开头的第一个实例

我想知道是否已经有任何 jQuery 插件可以做到这一点？:-) 一直在四处寻找，但一点运气都没有。如果没有，我当然必须自己写，我只是不确定如何实际捕获用户按下的字母。

非常感谢任何有关如何创建它的提示！:-)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:17:18.477

我编写了代码来覆盖`<select multiple="multiple">`. 我的结论是尝试这样做是个坏主意，因为每个浏览器如何处理输入和 jQuery 代码。

我建议 Mortensen 先生找到一个 UI 小部件或替代品，例如滚动 div 内的复选框，这将提供更可预测的行为，然后将我的代码功能应用于该选择。`<select>`我坚持使用通用代码有多种选择：

**不一致之处：**我很惊讶*Opera*能按我的意愿工作。*IE 7*只是忽略了我的代码。*Chrome*：当按下一个键来选择一个不可见的项目时，它会向上滚动，但不会向下滚动。令人费解。*Firefox*：我不能`event.preventDefault()`工作。所以我的整个代码都被忽略了。

[http://jsfiddle.net/rtLF2/](http://jsfiddle.net/rtLF2/)

```
<html>
  <head>
    <style type="text/css">

    </style>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        var indices = {};
        var count = 1;

        // build a dictionary matching first letters to indices of where
        // they were found
        $("#mylist option").each(function() {
          var letter = $(this).text().charAt(0).toLowerCase();
          if(!indices[letter]) {
            indices[letter] = [];
          }
          indices[letter].push(count);
          count++;
        });

        var lastletter = "";
        var lastindex = -1;

        $("#mylist").on('keypress', function(event) {
          event.preventDefault();
          var pressed = String.fromCharCode(event.keyCode).toLowerCase();
          if(pressed == lastletter) {
            lastindex == indices[lastletter].length - 1 ? lastindex = 0 : lastindex++;
          }
          else {
            lastletter = pressed;
            lastindex = 0;
          }

          if(indices[lastletter]) {
            var target = indices[lastletter][lastindex];
            $("#mylist option:selected").each(function() {
              $(this).removeAttr("selected");
            });
            $("#mylist option:nth-child(" + target + ")").attr("selected", "selected");
          }
        });
      });
    </script>
  </head>
  <body>
    <select id="mylist" multiple="multiple" size="5">
      <option value="1">Tank</option>
      <option value="2">APC</option>
      <option>Mini tricycle</option>
      <option>Bike</option>
      <option>Megatank</option>
      <option>Brawler</option>
      <option>Trailer</option>
      <option>Md Tank</option>
      <option>Armored van</option>
      <option>War Machine</option>
    </select>
  </body>
</html> 
```

# jquery - 堆栈溢出 $.colorbox.resize

> ID：10507451
> 
> 赞同：0
> 
> 时间：2012-05-08T22:26:38.777
> 
> 标签：jquery, colorbox

在调用`$.colorbox.resize();`. 我已将问题缩小到该方法，没有它一切运行良好，尽管模态的大小错误。

```
Uncaught RangeError: Maximum call stack size exceeded
d.extend.type
d.extend.makeArray
d.fn.d.init
d
g.plugins.fn.clone
a.each.a.fn.(anonymous function)
g.plugins.fn.clone
a.each.a.fn.(anonymous function)
g.plugins.fn.clone
a.each.a.fn.(anonymous function)
g.plugins.fn.clone
a.each.a.fn.(anonymous function)
g.plugins.fn.clone
a.each.a.fn.(anonymous function)
g.plugins.fn.clone
a.each.a.fn.(anonymous function)
... 
```

我只是在浏览器的控制台中创建了一些动态颜色框，而不是通过我通常的事件处理程序和方法运行。每次我尝试使用`$.colorbox.resize()`这些动态颜色框时，都会出现堆栈溢出。这让我认为该错误与显示和准备颜色框的任何自定义代码无关。

我正在使用 jQuery 1.5.2。

为什么会发生堆栈溢出，我该如何防止它发生？

**更新**

还有一些用于我的控制流的伪代码：

```
mouseClickHandler = function()
{
    async_method_1(function()
    {
        someMethod1()
    })
}

someMethod1 = function()
{
    async_method_2(function()
    {
        someMethod2()
    })
}
someMethod2 = function()
{
    $.colorbox.resize();
} 
```

**更新 2**

正如我之前提到的，除了上面的代码之外，在控制台中创建颜色框也会导致堆栈溢出。例如，如果我在浏览器的控制台中输入以下两行，我仍然会得到溢出。

```
$.colorbox({html:'<h1>hello world</h1>'})
$.colorbox.resize() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T14:22:08.263

我自己弄清楚了这个问题。发生堆栈溢出是因为页面中包含两次颜色框。一旦我删除了第二个脚本标签，一切又恢复了。

没有理由为什么任何人都需要两次包含颜色框，但是对于不小心犯错误的可怜的开发人员来说，模糊的堆栈溢出并不是合理的惩罚:)。我知道彩盒开发人员使用 SO。也许，他可以设置冗余故障保险或`throw new Error`带有有用信息的信息。

# javascript - 使用phonegap下载文件

> ID：10507465
> 
> 赞同：2
> 
> 时间：2012-05-08T22:28:07.577
> 
> 标签：javascript, xcode, cordova, download, phonegap-plugins

我正在尝试使用 phone gap[cordova 1.7.0] 从服务器下载文件，但是我到目前为止使用的所有插件都无法正常工作。你知道我怎样才能通过使用 JavaScript 或一个好的 phonegap 插件来做到这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T00:08:42.787

[FileTransfer.download()](http://docs.phonegap.com/en/1.7.0/cordova_file_file.md.html#FileTransfer_download)！

# java - 避免返回通配符类型

> ID：10507466
> 
> 赞同：11
> 
> 时间：2012-05-08T22:28:17.433
> 
> 标签：java, generics, wildcard, generic-collections

我有一个带有单例通配符类型集合的类，例如：

```
public ObliviousClass{

    private static final ObliviousClass INSTANCE = new ObliviousClass();

    private Map<Key, Type<?>> map = new HashMap<Key, Type<?>>();

    public void putType(Key key, Type<?> type){
        map.put(type);
    }

    // returns the singleton
    public static ObliviousClass getInstance(){
        return INSTANCE;
    }

} 
```

我希望能够在客户端代码中向此集合添加不同的参数化类型：

```
void clientMethod(){
    ObliviousClass oc = ObliviousClass.getInstance();

    Type<Integer> intType = ...
    Type<String> stringType = ...

    oc.putType(new Key(0), intType);
    oc.putType(new Key(1), stringType);
} 
```

到目前为止，据我了解，一切都很好。但是客户还需要能够获得`Type<?>`提供的`Key`. 因此，将添加类似以下的方法`ObliviousClass`：

```
public Type<?> getType(Key key){
    return map.get(key);
} 
```

[但在我方便的Effective Java](http://java.sun.com/docs/books/effective/)副本中，我读到：

> 不要使用通配符类型作为返回类型。

我理解这个问题，因为客户必须将返回的`Type<?>`. 但我真的不想制作`ObliviousClass`一个泛型类型`ObliviousClass<T>`，因为这样我上面的客户端代码就不起作用了......

**我想做的事情有更好的设计吗？** -我目前的解决方案是为客户端提供静态方法；类似于：

```
public static <T> void getType(ObliviousClass instance, Key key, Type<T> dest){
    dest = (Type<T>)instance.getType(key);
} 
```

我四处搜寻，但找不到完全消除我困惑的答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T23:25:53.953

这是一种在映射中存储给定类型的多个实例的类型安全方法。关键是您需要`Class`在检索值时提供一个实例才能执行运行时类型检查，因为静态类型信息已被删除。

```
class ObliviousClass {

  private final Map<Key, Object> map = new HashMap<Key, Object>();

  public Object put(Key key, Object value)
  {
    return map.put(key, value);
  }

  public <T> T get(Key key, Class<? extends T> type)
  {
    return type.cast(map.get(key)); 
  }

} 
```

用法如下所示：

```
oc.put(k1, 42);
oc.put(k2, "Hello!");
...
Integer i = oc.get(k1, Integer.class);
String s = oc.get(k2, String.class);
Integer x = oc.get(k2, Integer.class); /* Throws ClassCastException */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:03:04.580

只需输入您的班级：

```
public ObliviousClass <T> {

    private Map<Key, Type<T>> map = new HashMap<Key, Type<T>>();

    public void putType(Key key, Type<T> type){
        map.put(type);
    }

    public Type<T> getType(Key key){
        map.get(key);
    }
} 
```

仅供参考，此时您可以使用[委托模式](http://en.wikipedia.org/wiki/Delegation_pattern)。

*您的*示例客户端代码需要声明`ObliviousClass`:`ObliviousClass<String>`和`ObliviousClass<Integer>`.

### 编辑：

如果你*必须*有多种类型，你可以在你的方法上强加一个类型，但是你会得到一个编译器警告，因为不安全的强制转换：

```
public class ObliviousClass {

    private final Map<Key, Type<?>> map = new HashMap<Key, Type<?>>();

    public void putType(Key key, Type<?> value) {
       map.put(key, value);
    }

    @SuppressWarnings("unchecked")
    public <T> Type<T> getType1(Key key, Class<T> typeClass) {
       return (Type<T>)map.get(key); 
    }

    @SuppressWarnings("unchecked")
    public <T> Type<T> getType2(Key key) {
        return (Type<T>) map.get(key);
    }
} 
```

客户可以像这样键入对这些方法的调用：

```
Type<Integer> x = obliviousClass.getType1(key, Integer.class);
Type<Integer> y = obliviousClass.<Integer>getType2(key); 
```

选择您喜欢哪个并使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-04T17:33:06.803

对于那些多年后遇到这个问题的人来说，这不是 Java 泛型的设计方式。（我打算发表评论，但有更多细节。）

通用模式为每个类型 ID 管理一个*父*类，而不是多个不同的类。如果我们考虑更简单的 List<T>，则字符串或整数的列表（如 List<String> 或 List<Integer>）就是泛型的定义方式。每种类型一个类。这样，在引用值时就有了一致的类型。存储不相关的类型与 List<Object> 相同。只有程序员才能知道何时存储了多种类型以及如何通过强制转换来检索它们。

将子类存储到父类是可以的，但是当从集合中访问而不进行强制转换时，父类的联系就是已知的。例如，使用 Map<String, Runnable> 之类的接口定义的通用集合。但是，即使将其他公共方法添加到实现中，也只有 run() 方法是可见的（除非程序员显式强制转换）。要访问其他方法，必须进行强制转换。

这是 Java 中的一个限制。可以定义一种语言来了解 L-Value 类型——甚至是 Java。但事实并非如此。添加新功能时，[Sun 和] Oracle 会考虑许多向后兼容的因素。使用泛型编译的代码旨在在具有类型擦除的旧 JVM 上运行。一旦确定泛型是一致引用的，Java 就会在编译时使用类型擦除。字节码使用对象，就好像实例被（某种）定义为列表一样。如果选择放弃向后兼容性，如 Java 9 和 11，那么多种类型*可能*是可行的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-19T12:17:38.643

根据设计，您`ObliviousClass`的 不知道它所持有的项目的参数化类型。所以为了打字安全，你应该避免这样的设计：-\

但如果你想保留它，首先要做的就是你必须施放。这是没有办法的。但是你这样做的方式很容易出错。例如：

```
oc.put(k1, intType);
oc.put(k2, strType);
Type<Integer> tint = oc.get(k1, Integer.class)
Type<String>  tstr = oc.get(k1, String.class)  // typo in k2: compile fine 
```

最糟糕的是，由于类型擦除，它只会在你实际使用时在运行时失败`tstr`，而不是当你从`ObliviousClass`.

因此，您可以通过以其他方式跟踪参数化类型来提高安全性。例如，您可以将键与类型相关联，而不是丢失它：

```
@Value // lombok
class Key<T> {
    private int index;
}

class Type<T> {}

class ObliviousClass {

    // side note: static final can be public safely
    public static final ObliviousClass instance = new ObliviousClass();

    private List<Type<?>> map = new ArrayList<>();

    public <T> Key<T> appendType(Type<T> type){
        // here, I found it nicer that obliviousClass generates and return the key
        // otherwise use:  "public <T> void appendType(key<T> key, Type<T> type)"
        // that binds parametrized type of both key and type arguments
        map.add(type);
        return new Key<>(map.size() - 1);
    }

    public <T> Type<T> get(Key<T> key){
        return (Type<T>) map.get(key.index);
    }
} 
```

然后你可以使用它，例如：

```
 Type<Integer> intType = new Type<>();
    Type<String>  strType = new Type<>();
    Key<Integer> k1 = ObliviousClass.instance.appendType(intType);
    Key<String>  k2 = ObliviousClass.instance.appendType(strType);

    Type<Integer> t1 = ObliviousClass.instance.get(k1);
    Type<String>  t2 = ObliviousClass.instance.get(k2);
    Type<String>  t3 = ObliviousClass.instance.get(k1); // won't compile 
```

# wpf - 在 DataGrid 中，如何将布尔值表示为“是/否”而不是复选框？

> ID：10507469
> 
> 赞同：1
> 
> 时间：2012-05-08T22:28:44.373
> 
> 标签：wpf, vb.net, binding, .net-4.0, datagrid

> **可能重复：**
> [WPF：将布尔值显示为“是”/“否”](https://stackoverflow.com/questions/841808/wpf-display-a-bool-value-as-yes-no)

我正在 VB.Net 2010 (.NET 4.0) 中编写一个 WPF 程序，该程序对一个简单类使用数据绑定，该类是我编写的另一个简单类的 ObservableCollection。到目前为止，我有一个显示信息的 DataGrid，我可以根据需要添加和删除项目，但我似乎遇到了一个相当基本的概念：

除了各种 DataGrid 列允许的默认行为之外，我如何以某种方式显示数据？

我的原始类中有一个名为“reversed”的布尔值，我们称之为“x”。我希望显示“x”的 ObservableCollection 的 DataGrid 在 Reversed 列下显示“是”或“否”，而不是选中或未选中的复选框（DataGridCheckBoxColumn）。

有什么好方法可以做到这一点还是我在浪费时间？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T00:16:18.727

```
[ValueConversion(typeof(bool), typeof(string))]
public class FlopBoolean : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if (bool)value return "yes"; 
        return "no";
    }
    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {

       return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T11:38:34.940

如果您有一个绑定到 DataView 或 DataGridView 的对象集合，则可以创建一个属性并在数据网格中显示该属性。例子：

```
Public Class Example
     <Browsable(False)> Public Property isLinked As Boolean

     <DisplayName("Linked")> Public ReadOnly Property LinkedDisplay As String
        Get
            If isLinked Then
                Return "Yes"
            Else
                Return "No"
            End If
        End Get
    End Property
End Class 
```

它的缺点是您将无法在 datagridview 上编辑此列。

# javascript - 如何在 Sencha Touch 2 中单击面板时显示叠加层

> ID：10507470
> 
> 赞同：1
> 
> 时间：2012-05-08T22:28:49.120
> 
> 标签：javascript, sencha-touch-2

我在 Sencha Touch 2 中有一个 ActionSheet 和一个面板。我想在面板中单击图标地图时显示 ActionSheet 叠加层，我该怎么做？

Panel.js

```
Ext.define('app.view.principalTabPanel', {
    extend: 'Ext.tab.Panel',

    config: {
        ui: 'light',
        items: [
            {
                xtype: 'mappanel',
                title: 'Map',
                iconCls: 'locate'
            }
        ],
        tabBar: {
            docked: 'bottom',
            ui: 'light'
        }
    }

}); 
```

询问.js

```
Ext.define('app.view.takePhoto', {
    extend: 'Ext.ActionSheet',

    config: {
        items: [
        {
            text: 'Delete draft',
            ui  : 'decline'
        },
        {
            text: 'Save draft'
        },
        {
            text: 'Cancel',
            ui  : 'confirm'
        }
        ]
    }

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:11:14.260

您可以通过在`tab`项目对象内的选项卡中添加一个侦听器来做到这一点。

```
{
    xtype: 'mappanel',
    title: 'Map',
    iconCls: 'locate'
    tab: {
        listeners: {
            tap: function() {
                var sheet = Ext.create('app.view.takePhoto');
                sheet.show();
            }
        }
    }
} 
```

在该侦听器中，我们创建您的`app.view.takePhoto`类的一个新实例并显示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T09:01:50.373

将 show() 更改为 showBy() 后，我遇到了同样的问题。指定 html id 而不是组件就可以了

```
.showBy(Ext.get('ext-tab-5')); 
```

代替

```
.showBy('settingsTab') 
```

似乎该方法只能在 DOM 元素上调用。

希望这会有所帮助。

# html - 我是否在 erb 中发现了内存泄漏，或者我是否遗漏了一些重要的东西？请指教

> ID：10507473
> 
> 赞同：1
> 
> 时间：2012-05-08T22:29:04.237
> 
> 标签：html, ruby, memory, erb

请帮助我理解为什么这个看似简单的 erb 渲染循环的内存会永远增长。

“alltext.erb”是一个基本的文本文件，看起来像这样：

```
<% 5000000.times do %>
  spam
<% end %> 
```

下面的测试用例在内存中增长，直到最终达到 ~670MB

```
require 'erb'

filename = File.expand_path("../alltext.erb", __FILE__)
file_contents = File.read(filename)
renderer = ERB.new(file_contents)

# Undiagnosed memory leak below...
loop do

  html = renderer.result();

  # Display memory in kb
  puts `ps -o rss= -p #{Process.pid}`.to_i

  # Attempt to clear variables and force garbage collection
  html = nil
  filename = nil
  file_contents = nil
  renderer = nil
  GC.start

  # Display memory in kb
  puts `ps -o rss= -p #{Process.pid}`.to_i

  sleep(5)
end 
```

我希望将所有变量设置为 nil 并强制垃圾收集，以及超出范围（继续进行永久循环的下一次迭代）会释放一些内存。请帮助我了解我在这里缺少什么。

我的红宝石版本是 1.9.2-p180。我在 OSX 上，但这是测试用例复制在当前 Ubuntu 服务器上观察到的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:35:34.813

正如ayckoster 所建议的那样，“您正在创建文件并且永远不会关闭它们”。利用：

```
file_contents = File.read(filename) 
```

代替：

```
file_contents = File.new(filename).read 
```

# url - maven 存储库 url 中的最佳“子域”

> ID：10507474
> 
> 赞同：1
> 
> 时间：2012-05-08T22:29:08.257
> 
> 标签：url, maven, repository, naming-conventions

我有一些代码想要回馈给“世界”，即开源世界。

我想把它放在 sonatype.com 的“中央存储库”上。

我的问题是，根据我在公司的代码库，什么是好的存储库名称，以及我将远程/贡献于 sonatype 的开源代码？

例子：

```
(would be in company's private repository)
com.mycompanyname
com.mycompanyname.variousnamesandprojects.blah.blah

(would be in company's private repository)
com.mycompanyname.commons
~or~
com.mycompanyname.oss.contributions
~or~
com.mycompanyname.youridea
~or~
com.mycomapnyname.convention 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T06:55:45.760

您应该使用与您的公司域类似的 groupId，其顺序与 java 包中的相反。正如你所建议的那样

```
com.mycompanyname.WHATEVER 
```

*你*应该像你需要的那样分组。我不建议在公司内部和外部使用不同的 groupId。在该 groupId com.mycompanyname 中，您可以根据需要进行分组，例如：

```
com.mycompanyname.common
com.mycompanyname.maven
com.mycompanyname.maven.plugins
com.mycompanyname.projectName 
```

# spring - 如何让 Spring 3.1.1 与 App Engine 数据存储一起使用

> ID：10507478
> 
> 赞同：1
> 
> 时间：2012-05-08T22:29:19.867
> 
> 标签：spring, google-app-engine, google-cloud-datastore

请大家给我看一个关于如何让 Spring 3.1.1 在 Google App Engine 上运行的教程，好吗？

我遵循了几个教程，并设法让简单的 HelloWorld 示例在 App Engine 上工作。然而，当我走得更远时，我卡在了 Spring 和 Datastore 之间的持久化过程中。我查看了这个线程[在 Spring 3.1 中配置 JDO？](https://stackoverflow.com/questions/8853133/configuring-jdo-in-spring-3-1)，但它在本地主机上工作，但由于 javax.naming.NamingException，当我部署到应用程序引擎时它不起作用。

因此，我正在寻找一个不太简单的教程，它涵盖了现实生活应用程序的基本方面，例如视图、模型和数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T15:19:54.073

花了大约一天的时间试图完成这项工作，我想我会在这里添加一些额外的有用信息。首先看看这个项目[https://github.com/hleinone/spring-gae-jdo](https://github.com/hleinone/spring-gae-jdo)和这个问题：[http](http://code.google.com/p/googleappengine/issues/detail?id=1240) ://code.google.com/p/googleappengine/issues/detail?id=1240 -- 评论24是有用的。

如果有人想使用注释驱动的配置来解决这个问题，我是这样做的：

```
package com.domain.yourcode.configuration;

import javax.jdo.JDOHelper;
import javax.jdo.PersistenceManagerFactory;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.orm.jdo.GAETransactionAwarePersistenceManagerFactoryProxy;
import org.springframework.orm.jdo.JdoTransactionManager;
//import org.springframework.orm.jdo.TransactionAwarePersistenceManagerFactoryProxy;

@Configuration
public class JDOConfiguration {

    private static final PersistenceManagerFactory pmf =     JDOHelper.getPersistenceManagerFactory("transactions-optional");

    @Bean
    public GAETransactionAwarePersistenceManagerFactoryProxy proxyPmf() {
        GAETransactionAwarePersistenceManagerFactoryProxy proxy = 
                new GAETransactionAwarePersistenceManagerFactoryProxy();
        proxy.setTargetPersistenceManagerFactory(pmf);
        proxy.setAllowCreate(false);
        return proxy;
    }

    @Bean
    public JdoTransactionManager transactionManager() {
        JdoTransactionManager mgr = new JdoTransactionManager();
        mgr.setPersistenceManagerFactory(pmf);
        return mgr;
    }

} 
```

你仍然需要`<tx:annotation-driven/>`你的 applicationContext.xml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T17:52:16.080

[Jappstart](http://code.google.com/p/jappstart/)是查看使用 Spring 和 Datastore（通过 JPA）的 GAE 工作示例的好地方，也是构建基本 GAE/J 应用程序的良好起点。

# java - C ++（可能还有Java）如何锁定对象以进行同步？

> ID：10507487
> 
> 赞同：1
> 
> 时间：2012-05-08T22:30:12.763
> 
> 标签：java, c++, synchronization, locking

当对象被锁定在 C++ 和 Java 等语言中时，实际上是在低级别上执行的？我认为这与 CPU/缓存或 RAM 无关。我最好的猜测是这发生在操作系统的某个地方？它会在执行上下文切换的操作系统的同一部分内吗？

我指的是锁定对象，同步方法签名（Java）等。

答案可能取决于哪种特定的锁定机制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T22:39:44.107

锁定涉及同步原语，通常是*互斥体*。天真地说，互斥锁只是一个表示“锁定”或“解锁”的布尔标志，但细节在于：必须以原子方式读取、比较和设置互斥锁值，以便多个线程尝试相同的互斥锁'不要破坏它的状态。

但除此之外，指令必须正确排序，以便程序以正确的顺序可以看到互斥变量的读取和写入效果，并且没有线程在不应该因为失败而无意进入临界区时及时查看锁更新。

内存访问排序有两个方面：一个是由编译器完成的，如果认为这样做更有效，它可以选择重新排序语句。这是相对微不足道的预防，因为编译器知道什么时候必须小心。更困难的现象是 CPU 本身在内部可能会选择重新排序指令，并且在访问互斥变量以进行锁定时必须防止这样做。这需要硬件支持（例如，导致管道刷新和总线锁定的“锁定位”）。

最后，如果您有多个物理 CPU，每个 CPU 都会有自己的缓存，并且在任何执行指令取得进一步进展之前将状态更新传播到所有 CPU 缓存变得很重要。这又需要专门的硬件支持。

如您所见，同步是一项（可能）昂贵的业务，它确实妨碍了并发处理。然而，这只是您为拥有一个供多个独立上下文执行工作的单个内存块而付出的代价。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T22:32:06.857

C++ 中没有对象锁定的概念。您通常会在特定于操作系统的功能之上实现自己的功能，或者使用库提供的同步原语（例如`boost::scoped_lock`）。如果你有 C++11 的访问权限，你可以使用线程库提供的锁，它与 boost 有类似的接口，[看看](http://en.cppreference.com/w/cpp/thread).

在 Java 中，JVM 也会为您完成同样的工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T22:32:28.113

它`java.lang.Object`内置了一个监视器。这就是用于锁定同步关键字的内容。JDK 6 添加了一个并发包，为您提供了更细粒度的选择。

这有一个很好的解释：

[http://www.artima.com/insidejvm/ed2/threadsynch.html](http://www.artima.com/insidejvm/ed2/threadsynch.html)

我很久没有写过 C++ 了，所以我不知道如何用那种语言来写。我上次写它时语言不支持它。我相信这都是第 3 方库或自定义代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T22:33:24.297

它确实取决于特定的锁定机制，通常是信号量，但您不能确定，因为它依赖于实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-09T04:13:51.917

我所知道的所有架构都使用原子[比较和交换](http://en.wikipedia.org/wiki/Compare-and-swap)来实现它们的同步原语。例如，请参阅[AbstractQueuedSynchronizer](http://www.docjar.com/html/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.java.html)，它在一些 JDK 版本中用于实现 Semiphore 和 ReentrantLock。

# mysql - 在 MySQL 上创建数据库，如何进行涉及赔率的查询

> ID：10507492
> 
> 赞同：1
> 
> 时间：2012-05-08T22:30:46.070
> 
> 标签：mysql, sql

我正在 MySQL 上创建一个涉及赌博赔率（即 2/1 或 11/2）的数据库，MySQL 无法识别这种格式的数据，所以我如何为这些赌博赔率创建数据类型。我当然可以将这些以十进制形式表示，但是我想知道是否可以以这种方式存储它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:33:29.563

如果您不需要在计算或`ORDER`ing 中使用它们，您可以将它们以纯文本形式存储在 VARCHAR 列中。或者您可以使用两列，一列用于第一部分，另一列用于分数的第二部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:34:35.950

您可以使用两个字段将赔率存储为分子/分母对。如果您只想使用一个字段，唯一明智的方法是使用十进制形式。

我建议使用十进制值，除非您需要在字符串中显示赔率，在这种情况下，使用分子/分母对可能会很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T22:44:29.107

我认为将它们存储为小数是前进的方向，我假设在某些时候您可能想要进行涉及赔率的计算，在这种情况下，小数会更方便。您可以使用查找表来存储 varchar 表示，因为那里有一些古怪的分数，所以它不是找到最低真分数（例如 100/30、6/4）的情况，所以您可以有一个像这样的表所以：

```
Decimal    |    Fraction
1.5        |    2 / 3
2.0        |    Evens
3.0        |    6 / 4
3.33       |    100 / 30
4.0        |    3 / 1 
```

# ruby-on-rails - Rails 数据表服务器端处理无法排序/查找

> ID：10507498
> 
> 赞同：1
> 
> 时间：2012-05-08T22:31:17.997
> 
> 标签：ruby-on-rails, datatables, server-side

如果我将处理从客户端更改为服务器端，我将获得表的所有信息，但我无法搜索和排序列。但它可以转到下一页。我只有 2 列用于搜索和排序来测试它。希望你能帮助我。

数据库：

```
t.text     "comment"
t.datetime "created_at",           :null => false
t.datetime "updated_at",           :null => false
t.integer  "source_stock_id"
t.integer  "destination_stock_id"
t.integer  "order_id" 
```

js.coffee-代码：

```
jQuery ->
  $("#product_relocates_table").dataTable
    bProcessing: true
    bServerSide: true
    sAjaxSource: $('#product_relocates_table').data('source')
    "aaSorting": [[ 0, "desc" ]] 
```

数据表代码：

```
class ProductRelocatesDatatable

  delegate :params, :h, :link_to, to: :@view

  def initialize(view)
    @view = view
  end

  def as_json(options = {})
    {
      sEcho: params[:sEcho].to_i,
      iTotalRecords: ProductRelocate.count,
      iTotalDisplayRecords: product_relocates.total_count,
      aaData: data
    }
  end

  private

  def data
    product_relocates.map do |product_relocate|
      [
          h(product_relocate.created_at),
          h(product_relocate.comment),
          h(product_relocate.source_stock),
          h(product_relocate.destination_stock),
          h(product_relocate.quantity),
          link_to('Show', [:admin, product_relocate])
      ]
    end
  end

  def product_relocates
    @product_relocates ||= fetch_product_relocates
  end

  def fetch_product_relocates
    product_relocates = ProductRelocate.order("#{sort_column} #{sort_direction}")
    product_relocates = product_relocates.page(page).per(per)

    if params[:sSearch].present?
      search_string = search_columns.map do |search_column|
        "#{search_column} like :search"
      end.join(" OR ")

      product_relocates = product_relocates.where(search_string, search: "%#{params[:sSearch]}%")
    end

    product_relocates
  end

  def page
    params[:iDisplayStart].to_i/per + 1
  end

  def per
    params[:iDisplayLength].to_i > 0 ? params[:iDisplayLength].to_i : 10
  end

  def search_columns
    %w[product_relocates.created_at product_relocates.comment]
  end

  def sort_columns
    %w[product_relocates.created_at product_relocates.comment]
  end

  def sort_column
    sort_columns[params[:iSortCol_0].to_i]
  end

  def sort_direction
    params[:sSortDir_0] == "desc" ? "desc" : "asc"
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T12:03:15.147

我重构了一个处理服务器端多列搜索和排序的超类：

[https://gist.github.com/2936095](https://gist.github.com/2936095)

源自：

[http://railscasts.com/episodes/340-datatables](http://railscasts.com/episodes/340-datatables)

```
class Datatable
  delegate :params, :h, :raw, :link_to, :number_to_currency, to: :@view

  def initialize(klass,view)
    @klass = klass
    @view = view
  end

  def as_json(options = {})
    {
      sEcho: params[:sEcho].to_i,
      iTotalRecords: @klass.count,
      iTotalDisplayRecords: items.total_entries,
      aaData: data
    }
  end

private

  def data
    []
  end

  def items
    @items ||= fetch_items
  end

  def fetch_items
    items = filtered_list
    items = selected_columns(items)
    items = items.order(sort_order)
    items = items.page(page).per_page(per_page)
    if params[:sSearch].present?
      items = items.where(quick_search)
    end
    items
  end

  def filtered_list
    @klass.all
  end

  def selected_columns items
    items
  end

  def quick_search
    search_for = params[:sSearch].split(' ')
    terms = {}
    which_one = -1 
    criteria = search_for.inject([]) do |criteria,atom|
      which_one += 1
      terms["search#{which_one}".to_sym] = "%#{atom}%"
      criteria << "(#{search_cols.map{|col| "#{col} like :search#{which_one}"}.join(' or ')})"
    end.join(' and ')
    [criteria, terms]
  end

  def page
    params[:iDisplayStart].to_i/per_page + 1
  end

  def per_page
    params[:iDisplayLength].to_i > 0 ? params[:iDisplayLength].to_i : 10
  end

  def columns
    []
  end

  def sort_order
    colnum = 0
    sort_by = []
    while true
      break if !sorted?(colnum)
      sort_by << "#{sort_column(colnum)} #{sort_direction(colnum)}"
      colnum += 1
    end
    sort_by.join(", ")
  end

  def sorted? index=0
    !params["iSortCol_#{index}"].nil?
  end

  def sort_column index=0
    index = "iSortCol_#{index}"
    columns[params[index].to_i]
  end

  def sort_direction index=0
    index = "sSortDir_#{index}"
    params[index] == "desc" ? "desc" : "asc"
  end
end 
```

# mobile - 使用三次贝塞尔曲线过渡的星巴克移动导航

> ID：10507505
> 
> 赞同：0
> 
> 时间：2012-05-08T22:32:09.753
> 
> 标签：mobile, css, navigation

我试图基本上复制星巴克的移动导航，但我不知道如何在单击三行时获得平滑的幻灯片过渡。看起来他们正在使用 CSS3 过渡来实现这个动画，但我无法复制它。

我得到了相同的结果，但没有动画，因为 CSS3 没有动画显示：继承。

这是我的 JSFiddle，任何人都可以通过像 Starbucks.com 在他们的暴民导航中使用的 CSS3 三次贝塞尔过渡来改进它吗？（你必须调整你的窗口大小才能看到他们的暴民导航）

ps 这需要是 CSS3，请不要使用 jQuery 动画 :-)

[http://jsfiddle.net/zQxNd/2/](http://jsfiddle.net/zQxNd/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:08:42.407

我遇到的最佳方法是将隐藏菜单的默认样式设置为：

```
display:block;
overflow:hidden;
height:0; 
```

然后在你的 .open 中设置元素的高度：

```
height: 200px; 
```

我编辑了你的小提琴来展示：http: [//jsfiddle.net/zQxNd/3/](http://jsfiddle.net/zQxNd/3/)

此外，最好编写一个快速的 jQuery 函数来通过 jQuery 设置高度 - 这并不理想，但它是我使用我们拥有的工具找到的最佳解决方案。

编辑：为了获得确切的动画速度，你可以玩这个很棒的小应用程序：[http ://cubic-bezier.com/](http://cubic-bezier.com/)

一旦你把时间安排下来，你可以`ease-in`用这样的东西替换你的过渡声明：

```
transition: all 1s cubic-bezier(.17,.67,.83,.67) 
```

# xml - PeopleSoft XML Publisher - 隐藏空行集

> ID：10507509
> 
> 赞同：0
> 
> 时间：2012-05-08T22:32:19.393
> 
> 标签：xml, peoplesoft, rowset, bi-publisher

我有一个正在构建的报告，它使用一个包含六个子行集的行集。我正在通过按钮上的 pplcode 生成此报告。我声明了行集：

```
rs_resp = CreateRowset(Record.AVZ_JD_RESP_TBL);
&rs_expr = CreateRowset(Record.AVZ_JD_EXPR_TBL);
&rs_skls = CreateRowset(Record.AVZ_JD_SKLS_TBL);
&rs_educ = CreateRowset(Record.AVZ_JD_EDUC_TBL);
&rs_lic = CreateRowset(Record.AVZ_JD_LIC_TBL);
&rs_cond = CreateRowset(Record.AVZ_JD_COND_TBL);
&rs_dtl = CreateRowset(Record.AVZ_JD_DTL_VW, &rs_resp, &rs_expr, &rs_skls, &rs_educ, &rs_lic, &rs_cond); 
```

然后我遍历并填充行集：

```
&rs_dtl.Fill("WHERE FILL.AVZ_JD_DESCRID = :1 AND EFFDT = %DATEIN(:2)", &jdDescrID, &effdt); 
```

等等。

在我的报告中，我在顶部有一些来自父行集的东西，然后是子行集（带有“节标题”）如下：

孩子一：来自 &rs_resp 的数据

孩子二：来自 &rs_expr 的数据...我的问题不是所有的行集都有数据，我想从我的报告中排除这些部分。我第一次尝试在 RTF 模板的条件区域中使用@numrows，但很快就被提醒即使是空行集也至少有 1 行...

挑战似乎是获得标题以及受条件影响的数据区域......

有没有人这样做过，或者有什么想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T10:42:26.667

您当前的订单似乎类似于
Parent 1
Parent 2

   孩子 1.1
   孩子 1.2
   孩子 2.1
   孩子 2.2
   孩子 1.3
   孩子 1.4
   孩子 2.3
   孩子 2.4
   孩子 1.5

在您尝试在上面使用的方法中，您最终将拥有 &rs_dtl 中的所有父行和相应行集中的所有子行。在这种情况下，您将需要在 RTF 模板中搜索相应的子行（对于存在的每个父行），我会说这是一项繁琐的任务。

而是尝试按以下顺序对行集进行排序：

父母 1
   孩子 1
   孩子 2
   孩子 3
   孩子 4
父母 2
   孩子 1
   孩子 2
   孩子 3
   孩子 4

这将使您更容易打印父行的子行。此外，可以进行检查 - 以验证子行是否为空并相应地打印。

# asp.net - ASP.NET MVC3，试图从 SQL Server CE 迁移到 Server 2008 R2

> ID：10507514
> 
> 赞同：0
> 
> 时间：2012-05-08T22:32:49.103
> 
> 标签：asp.net, sql-server, asp.net-mvc, sql-server-2008, entity-framework

我有一个 MVC3 项目，到目前为止我一直在使用 SQL Compact Edition 进行开发。我现在正试图转移到在另一台机器上运行的 SQL Server 2008 R2。我已经用 Visual Studio 连接到这个数据库并获得了一个连接字符串，我用它来替换我现有的连接字符串。

```
<add name="CPContext" connectionString="Data Source=CSP111;Initial Catalog=CONTESTPLATFORM;Persist Security Info=True;User ID=sa;Password=<%MY PASSWORD%>" providerName="System.Data.SqlClient" />
<!--Old Connection String
<add name="CPContext" connectionString="Data Source=|DataDirectory|ContestPlatform.sdf" providerName="System.Data.SqlServerCe.4.0" />
--> 
```

我正在使用初始化程序类为数据库提供一些初始值。这在我的 Global.asax.cs 文件中被调用，如下所示：

```
protected void Application_Start()
    {
        Database.SetInitializer<CPContext>(new ContestPlatformInitializer());

        AreaRegistration.RegisterAllAreas();

        RegisterGlobalFilters(GlobalFilters.Filters);
        RegisterRoutes(RouteTable.Routes);
    } 
```

现在，当我运行我的项目时，第一次尝试访问数据库时会引发异常。

```
Model compatibility cannot be checked because the database does not contain model
metadata. Model compatibility can only be checked for databases created using Code 
First or Code First Migrations. 
```

这是我主页上引发异常的代码：

```
IQueryable<Submission> submissions = db.Submissions.Where(s => s.ContestId == contestId && s.Entry.isPrivate != true && s.Entry.isApproved); 
```

当我转到我的数据库时，没有创建任何表。实体框架的新手，帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T04:18:15.643

我怀疑问题是新数据库还没有“填充”，因为数据库对象（例如表、视图）和它们的数据都不存在。

我不熟悉 SQL CE，但您需要做的是将数据库从 CE 迁移到新服务器。当我将项目从开发环境转移到生产环境时，我经常这样做，因为每个环境的数据库服务器都不同。

阅读如何将 CE 数据库复制到 Sql Server 数据库。您可能可以在 Sql Server Business Development Studio 中创建一个项目来执行此操作。

# javascript - jQuery 图像加载循环 - 包装 HTML 和检查大小？

> ID：10507516
> 
> 赞同：0
> 
> 时间：2012-05-08T22:32:52.317
> 
> 标签：javascript, jquery, html

我有一个包含图像的文件夹，我正在使用 jQuery 加载这些图像。这段代码：

```
$(function () {
    var i=1;
    for (i=1;i<=50;i++){
        var curImg = "blog/wp-content/uploads/" + i + ".jpg";
        var img = new Image();         
        $(img).load(function () {                                 
             $(this).hide();
             $('#loader').removeClass('loading')
                         .append(this);
             $(this).fadeIn();
         }).error(function () {})                            
         .attr('src', ''+curImg+'');                    
    }
}); 
```

可以很好地从此文件夹中顺利加载 50 张图像。我正在尝试做两件事：

1.  我想添加这样的链接：`<a href='blog/wp-content/uploads/" + i + ".jpg' class='picLink'>`到每个单独的图像。我曾尝试`.wrap`在我的`.load`函数中使用，但这对我不起作用。这只是创建了一个链接嵌套（例如`<a><a></a></a>`）。
2.  目前这会找到前 50 张照片，从 1 号开始，然后加载它们。但是，如果添加更多照片，它们将不会被找到，并且最旧的将永远是第一个。我希望它找到文件夹中的所有照片并首先打印最新的（最高数字）。可以假设不会超过 4000 张照片。那么是否可以反向执行此循环，从 4000 开始，检查该照片是否存在并继续工作并加载文件夹中存在的照片？

在此先感谢您的帮助，我希望问题足够清楚！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:47:45.900

对于 1\. 你可以做这样的[事情](http://jsfiddle.net/mowglisanu/zzNmw/)

```
$(function () {
    var i=1;
    for (i=1;i<=50;i++){
        var curImg = "blog/wp-content/uploads/" + i + ".jpg";
        var img = new Image();         
        $(img).load(function () {                                 
             $(this).hide();
             $('#loader').removeClass('loading')
                         .append($('<a href="'+this.src+'"></a>').append(this));
             $(this).fadeIn();
         }).error(function () {})                            
         .attr('src', ''+curImg+'');                    
    }
}); 
```

此外，它们可能不按顺序加载，因为某些图像的加载时间可能比其他图像长。

对于 2\. 我认为您应该在服务器端获取图像计数并将其注入到 for 循环中，例如，

```
for (i=<?php echo $count; ?>; i > <?php echo ($count>50?$count-50:0); ?>; i--){ 
```

假设您使用的是 php，其中`$count`表示文件夹中的图像数量。

# php - 如何在php中获取部分从jquery加载的页面的整个html

> ID：10507523
> 
> 赞同：2
> 
> 时间：2012-05-08T22:33:57.280
> 
> 标签：php, jquery, html, web-scraping, onload

我有这个问题好几天了...我必须从 php 加载页面的整个 html。在此页面上，有一个 jquery 函数，当所有页面加载完毕时会调用该函数。此函数将其他 html 加载到页面中，因此我必须加载所有 html（也加载了 jquery 的部分）。我可以知道我让所有页面都试图找到一些仅从 jquery 加载的标签。（例如：名称为XXX的标签输入、属性多的标签输入等）

所以我尝试：

```
$html = file_get_contents("http://wwww.siteToScrape.com");
if (strpos($html, 'multiple') !== false) {
    echo 'found';
} else {
    echo 'not found';
} 
```

但结果是“未找到”。

然后我下载[了简单的 html dom](http://simplehtmldom.sourceforge.net/)并尝试：

```
include 'simple_html_dom.php';
$html = file_get_html("http://wwww.siteToScrape.com");
if (strpos($html, 'multiple') !== false) {
    echo 'found';
} else {
    echo 'not found';
} 
```

但结果仍然“未找到”。

所以我想得到一些 php 脚本来模拟浏览器（所以也可以加载 jquery），我下载了[PHP Scriptable Web Browser](http://simpletest.org/en/browser_documentation.html)并尝试：

```
require_once('browser.php');
$browser = new SimpleBrowser();
$p = $browser->get('http://wwww.siteToScrape.com');
if (strpos($p, 'multiple') !== false) {
    echo 'found';
} else {
    echo 'not found';
} 
```

但结果仍然是“未找到”。我不知道该怎么做..有人可以帮助我吗？谢谢！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T22:49:05.617

*据我所知， “仅使用 PHP”*是不可能的。Javascript 在客户端而不是服务器上运行，因此如果没有某种浏览器模拟器环境是不可能的。

**编辑：**您可以将 javascript 放在网页本身中，这将在整个网页完全生成后获取整个网页的 innerHTML，然后使用 ajax 调用将其发送到您的服务器。您必须保持在同源策略的限制范围内（这不允许您对主机网页来自的域以外的域进行 ajax 调用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T22:52:24.630

问题是您正在尝试混合服务器和客户端。

PHP 在服务器上运行 Javascript（因此也包括 jQuery）在客户端浏览器中运行。

使用 PHP 运行 javascript 没有简单的方法。据我所知，这甚至是不可能的。其他语言（例如 Java）可能能够完成您正在尝试做的事情。

你应该看看另一种方法来做到这一点。

这也是为什么网络爬虫永远不会受到您使用 javascript 所做的事情的影响的原因。这是开发时要牢记的一件好事。这些爬虫根本不会为您的动态加载编制索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T14:06:35.940

就像其他人所说的那样，jquery 是 javascript，通常由客户端（Web 浏览器）而不是服务器执行。

PHP 作为一种服务器端语言，没有 javascript 解释器。

我所知道的使用 PHP 运行 javascript 的最简单方法是通过 Web 测试工具，该工具通常集成了无头浏览器。您可以查看[mink ，它具有](http://mink.behat.org/)[僵尸](http://zombie.labnotes.org/)node.js 无头浏览器的后端。

还有带有各种 PHP 接口的 phantomjs 无头浏览器[，](https://github.com/diggin/php-PhantomjsRunner)[我](http://phantomjs.org/)通过快速的谷歌搜索找到了它。

在资源更密集的领域，还有[selenium](http://seleniumhq.org/)，它也有 PHP 接口。

# javascript - 有没有一个好的服务器端基于 javascript 的 rest API 测试框架？

> ID：10507527
> 
> 赞同：1
> 
> 时间：2012-05-08T22:34:37.503
> 
> 标签：javascript, node.js, testing, serverside-javascript

我想测试用 java 编写的 rest api 的外部端点，但我想从 javascript 运行测试，以便与我们的客户端 web 应用程序共享 js 代码和测试框架。有没有一个好的图书馆可以让这更容易，所以我不必重新发明轮子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:45:23.647

我还没有尝试过，但是 VCR 的 node.js 版本[https://github.com/elcuervo/vcr.js](https://github.com/elcuervo/vcr.js)看起来很有希望。

尽管如果不是太复杂，我只会对响应进行存根。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:37:02.287

我使用restler作为http客户端

[https://github.com/danwrong/restler](https://github.com/danwrong/restler)

和用于 TDD/BDD 的 mocha

[http://visionmedia.github.com/mocha/](http://visionmedia.github.com/mocha/)

编写测试非常简单，几乎不涉及样板文件，即使它本身实际上并不是一个框架

```
test('/authenticate service should authenticate user', function(done) {

    var myService = service.getLocator().authenticate;
    var params = {username: "...", password: "..."};
    service.postJson(myService.host, '/authenticate', params, function(data, response) {
        data.username.should.eql('...');
        done();
    });

}); 
```

# scala - 在 ENSIME 中禁用括号（paren）自动完成

> ID：10507530
> 
> 赞同：0
> 
> 时间：2012-05-08T22:35:25.740
> 
> 标签：scala, emacs, ensime

当我键入一个左括号时，[ENSIME 会](https://github.com/aemoncannon/ensime)自动插入一个右括号。如何禁用此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T06:24:40.143

当您打开 scala-mode-feature-electric-mode （这是 scala-mode 文档中的“推荐”模式）时，Emacs 的 scala-mode 完成。如果它是手动发生的，请在您的 emacs 启动文件中查找以下行并将它们注释掉：

```
(add-hook 'scala-mode-hook
           '(lambda ()
          (scala-mode-feature-electric-mode)
              )) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T03:08:11.777

尽管 ENSIME 确实有一些格式化选项，但插入括号似乎并不是其中之一。你确定不是paredit？我过去曾与它斗争过。这是有关它如何自动插入括号的[一些信息。](http://www.emacswiki.org/emacs/AutoPairs)即使已加载，我也可以禁用以查看是否是问题所在。

# objective-c - 用户选择时的多选行为不同于 setSelected:animated：

> ID：10507531
> 
> 赞同：0
> 
> 时间：2012-05-08T22:35:31.310
> 
> 标签：objective-c, ios, uitableview

我有一个 UITableView 显示通讯录中的联系人。我启用了多选编辑样式。当我展示 tableView 时，它按预期工作。用户点击一行，单元格左侧的红色复选标记就会填充。太好了。

我将这些选择保存在呈现视图控制器的数组属性中。当我再次显示我的表格时，我希望这些单元格保持选中状态（即，不是蓝色突出显示，只是红色复选标记仍然填充）。在 cellForRowAtIndexPath: 我得到那个索引路径的单元格的对象，测试当前视图控制器的数组是否包含那个对象，如果是的话`[cell setSelected:YES];`

在我看来，这应该导致与用户触摸单元格时相同的选定外观（只是红色复选标记）。取而代之的是，红色的勾号确实会填满，但单元格也会暂时突出显示蓝色，并且文本会永久变为白色，给人的印象是联系人的名字已经消失了。如果有帮助，我很乐意发布代码，但这似乎只是 UITableView 的一个怪癖，有人可能熟悉吗？编辑：这张图片显示了我拥有（和想要）的那种复选标记。我无法拼凑，但为什么当我调用 [cell setSelected:YES]; 它的行为与响应触摸时的行为不同。你在这里看到的是在我调用 [cell setSelected:YES]; 之后。它看起来几乎是我想要的，但名字已经消失了。我不

![在此处输入图像描述](../Images/9165121fcdff60d9924d9f3f938d4a13.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:48:43.337

如果我了解您正在寻找的视觉效果，您应该通过使用`cell.accessoryType = UITableViewCellAccessoryCheckmark;`而不是`[cell setSelected:YES];`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T17:37:56.227

这解决了。我想我是通过尝试在 cellForRowAtIndexPath 中设置选择来为自己制造问题。也许表格视图对单元格的重用让它变得疯狂？

使单元格在多选样式表的表示之间正确选择的解决方案是将选定的索引存储在 viewWillDisappear 中。我给呈现视图控制器一个属性`NSArray *selectedIndexes`，并在 viewWillDisappear 中调用

`[self.presentingViewController setSelectedIndexes:[myTableView indexPathsForSelectedRows]];`

然后在 viewWillAppear 中，我将该数组放入一个 ivar，遍历它并调用`[myTableView selectRowForIndexPath:[selectedIndexes objectAtIndex:i] animated:YES];` That 就可以了。感谢 user523234 的评论。帮助我在正确的轨道上思考。

# ruby-on-rails - factory_girl 的替代品

> ID：10507540
> 
> 赞同：1
> 
> 时间：2012-05-08T22:36:27.473
> 
> 标签：ruby-on-rails, factory-bot

在我看来，就我的目的而言，`factory_girl`完全糟糕透了。一些限制包括：

### 不支持调试

如果我包含`debugger`语句，它们将被视为模型属性。我没有调用调试器，而是得到奇怪的错误。

```
FactoryGirl.define do 
  factory :admin do
    name do
      debugger # <-- Does not work.
      Forgery(:name).full_name
    end

    email                 { Forgery(:email).address }

    debugger # <-- Does not work either.

    password              "secret"
  end
end 
```

### 关联的限制

我是不是太蠢了，还是没有优雅的方式向用户添加两个帖子？

```
FactoryGirl.define do
  factory :post do
    title "Foobar"
    content "Some content"
  end

  factory :user do
    name { Forgery(:name).full_name }
    email                 { Forgery(:email).address }

    # This does not work, if the Post model requires Post#user to be set.
    posts [FactoryGirl.create(:post), FactoryGirl.create(:post)]
  end
end 
```

另请参阅[Factory Girl - 为什么不断创建记录？](https://stackoverflow.com/questions/5370266/factory-girl-why-are-records-being-continually-created)

### 倾向于触发铁轨中的奇怪错误

我不记得发生了什么，但 factory_girl 经常出现奇怪的问题。

所以给出这些例子。是否有没有这些问题的 factory_girl 替代品？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-07T21:25:17.703

我同意并发现工厂女孩的作用过于复杂。

不久前，我写了一个更简单的 gem，它（至少在当时）是基于 Factory Girl 的测试的替代品。

工厂定义使用更简单的 Ruby，因此其行为与您期望的一样。

看看： [https ://github.com/ginty/craky](https://github.com/ginty/cranky)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T22:43:15.950

为什么要在工厂定义中而不是在结果对象的代码中进行调试？

有什么问题

```
user = FactoryGirl.create(:user)
2.times do
  FactoryGirl.create(:post, user: user)
end 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-08T22:59:34.767

DSL 中的调试器语句可能会出现问题。你不知道它什么时候会运行。

FactoryGirl 可以运行 DSL，保存工厂的表示，并在使用工厂时使用内存中的内部表示。

此外，除了 self 之外，没有要检查的变量。自我将成为构建定义的胚芽对象。

冒着为 FactoryGirl 辩护的风险，如果您的 FactoryGirl 替代品是用于填充数据的 DSL，那么您仍然会遇到调试支持的问题。

替代方案包括固定装置和仅调用 ActiveRecord 来填充测试数据。真的，FactoryGirl 没有太多的 ActiveRecord，它只是更多面向符号的调用，所以人们可以制作有意义的符号名称，这都是 FactoryGirl 应该做的。

您不能将调试器语句放在夹具的中间，或者放在要发送到 create 方法的哈希中间，但至少您不会被诱惑。

（参见 Factory Girl - 为什么不断创建记录？，这是 FactoryGirl 完美运行的示例，但用户告诉它创建四个记录，然后当它创建四个记录时感到惊讶。）

所以也许如果你坚持使用固定装置和 ActiveRecord 调用，事情就会变得很简单，以至于你不会感到困惑。

# starteam - 是否可以使用 StarTeam 2009 从命令行将 CR 导出到 csv？

> ID：10507542
> 
> 赞同：2
> 
> 时间：2012-05-08T22:36:29.667
> 
> 标签：starteam

我希望能够 从命令行[导出更改请求。](http://kb.microfocus.com/display/4/kb/article.aspx?aid=35003&n=1&docid=18030043&tab=search)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T12:19:58.387

至少对于 StarTeam 2009 和更早版本，命令行工具 (stcmd)
旨在
通过允许您签出一组文件以构建它们来自动化您的构建过程。
（它也支持签入文件，但该工具主要用于签出文件）。

要提取 CR 的内容，您可以使用**报告**（通过 UI），
也可以用 Java 编写一些内容，以利用**StarTeam SDK**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-02T18:11:19.473

发布的答案表明此命令行选项不可用。该声明在 StarTeam 11.0 中是准确的，但现在不再如此。最新版本的 StarTeam 现在有一个新的命令行客户端，它允许您使用类似 SQL 的查询，因此您现在可以直接选择、插入和更新项目。这意味着 StarTeam 现在原生支持导出。这也为您提供了一个新选项，可以使用 INSERT 导入新项目；但是，您最大的挑战是数据字段映射（您是否具有正确的状态、严重性等以及字段名称是否正确映射）和工作流支持（数据的当前状态是否符合您定义的工作流规则，假设您使用自定义 APE 来支持 CR 工作流程）。

还值得注意的是，上面列出的**报告**选项并不是通过 UI 实现的最佳选项，因为有一个**高级 --> 导出**选项，允许您将顶部窗格中的所有选定/过滤项目导出到CSV 文件。我的猜测是，这种方法将是 Report 选项的更好替代方案，该选项具有有限的格式选项，并且产生的输出除了打印形式之外很难用于任何其他形式。

# php - 从插件 cakephp 加载插件

> ID：10507543
> 
> 赞同：0
> 
> 时间：2012-05-08T22:36:38.057
> 
> 标签：php, cakephp, cakephp-1.3

假设我在 CakePHP 应用程序中有一个插件，它需要一些功能或一些资产，这些功能或资产位于我的应用程序的另一个插件中。有没有办法可以将其他插件导入到我当前的插件中，这样我就可以访问它的功能（使用 App::import 或其他东西）

请让我知道如何实现这一目标

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:51:39.167

当然你可以——就像 APP 本身一样：

```
App::import('Lib', 'PluginName.ClassName') 
```

ETC

# java - 图像块的缓冲图像

> ID：10507545
> 
> 赞同：3
> 
> 时间：2012-05-08T22:36:48.307
> 
> 标签：java, image, swing

我想创建一个游戏，我希望有许多可以响应箭头键的图像图块。我应该使用 BufferedImage 来创建每个单独的图块吗？

参考：[Java 游戏区难度](https://stackoverflow.com/questions/10505000/java-game-playing-area-difficulty)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:40:04.303

[`RobotChase`](http://robotchase.sourceforge.net/)是一款`BufferedImage`以这种方式使用的基于瓷砖的游戏。替代方案包括：

*   实现接口，如此处引用[的](https://stackoverflow.com/a/10505042/230513)`Icon`示例所示。
*   [将组件的文本设置为合适的 Unicode 字形，如此处](https://sites.google.com/site/drjohnbmatthews/buttons)所示。

# c# - ASP.NET 页面作为弹出窗口加载缓慢，但不是独立链接

> ID：10507546
> 
> 赞同：0
> 
> 时间：2012-05-08T22:36:57.893
> 
> 标签：c#, javascript, asp.net, .net-4.0, popup

有一个奇怪的，在这里。

我正在开发一个基本的 ASP.NET/C# 代码隐藏应用程序，其中汇总数据列在网格中，每条记录都有一个随附的“更新”按钮。单击该按钮会触发一个 window.open()，其中将网格每一行的 ID 传递到查询字符串中，以检索相关记录以在新窗口中进行编辑。

呈现的“网格”页面示例：

```
window.open('EditTool.aspx?ID=' + ID, 'new_window', width=550, height=300'); 
```

当页面从按钮打开时，渲染可能需要 10 秒以上。当我打开一个新选项卡并将 URL 和查询字符串内容粘贴到地址栏中时，页面几乎立即呈现。

我在页面的内容中添加了 log4net 语句，看起来所有的控件和 C# 代码隐藏都在几毫秒内执行。

为了调查起见，我已经停用了弹出窗口阻止程序，并且我已经在 IE7（工作场所标准，呃）、FF 和 Chrome 上进行了尝试。

关于如何使渲染更快的任何想法，或者我可以在哪里查看是什么减慢了它？

**更新：**

我创建了一个新的 shell webapp，它有一个按钮打开一个空的（只是当你“添加新项目”时添加的东西）ASPX 作为弹出窗口。弹出窗口立即呈现。我还修改了我现有的应用程序以打开一个空的弹出窗口，我得到了同样的延迟。看起来应用服务器在开始处理页面之前正在等待处理某些内容，而不是缓慢地呈现页面。

ASP.NET 是否有一个设置，您可以告诉它不要在每次渲染时重新编译页面？

# apache - 将子域重定向到相同的子域名但不同的域名

> ID：10507548
> 
> 赞同：2
> 
> 时间：2012-05-08T22:37:06.470
> 
> 标签：apache, .htaccess, mod-rewrite, redirect, subdomain

我有一个名为 exmaple.com 的网站有很多子域

```
test1 , test2 , test2.example.com 
```

例如，我如何将具有确切子域的子域重定向到另一个域名

```
test1 , test2 , test3.example.net 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:50:43.743

使用 %1 %2 等从 RewriteCond 中获取正则表达式匹配组。

您可能知道，$1 $2 匹配 RewriteRule 中的正则表达式组

在我的脑海中，这在 mod_rewrite 活跃时非常简单：

```
 RewriteEngine On
 RewriteCond %{REQUEST_HOST} (.+)\.example\.com
 RewriteRule (.*) http://%1.example.net$1 [R,QSA] 
```

这假设您从单个虚拟主机为所有这些子域提供服务，但如果不是，您可以将此规则集复制到每个人的配置或 .htaccess 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:54:48.437

这可能有效。把它放在你的 .htaccess 中。

```
RewriteEngine On
RewriteCond %{HTTP_HOST} (.*).example.com
RewriteRule (.*) http://%1.example.net/$1 [R=301,QSA,L] 
```

还没有测试它，但它应该给你一个开始。

# java - MonoTouch + IKVM 项目中的 JIT 编译问题

> ID：10507549
> 
> 赞同：2
> 
> 时间：2012-05-08T22:37:10.593
> 
> 标签：java, ios, xamarin.ios, ikvm, aot

我正在通过[ikvm-monotouch](https://github.com/samskivert/ikvm-monotouch)和 MonoTouch 将 Java 游戏移植到 iOS。我遇到了一个让我有点头疼的错误，虽然我不确定这是否是 MonoTouch 中的实际错误，所以我在点击错误数据库之前在这里询问。

在反映对象字段的方法期间，我收到下面的 JIT 编译错误。我（到目前为止）只在反映实现的对象时看到此错误`Cloneable`，尽管我不确定这是否是触发此错误的具体原因。

```
Unhandled Exception: System.TypeInitializationException: An exception was thrown by the type initializer for ikvm.internal.ClassLiteral`1 ---> System.ExecutionEngineException: Attempting to JIT compile method 'ikvm.internal.ClassLiteral`1<java.lang.Cloneable>:.cctor ()' while running with --aot-only.
   --- End of inner exception stack trace ---
   at System.Reflection.MonoField.GetValue (System.Object obj) [0x0006a] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System.Reflection/MonoField.cs:124 
   at IKVM.Internal.TypeWrapper.LazyInitClass () [0x00063] in /Users/nathan/projects/ikvm-monotouch-git/runtime/TypeWrapper.cs:1841 
   at IKVM.Internal.TypeWrapper.get_ClassObject () [0x00027] in /Users/nathan/projects/ikvm-monotouch-git/runtime/TypeWrapper.cs:1756 
   at IKVM.NativeCode.java.lang.Class.getInterfaces (java.lang.Class thisClass) [0x0001c] in /Users/nathan/projects/ikvm-monotouch-git/runtime/openjdk.cs:2556 
   at java.lang.Class.getInterfaces () [0x00000] in <filename unknown>:0 
   at java.lang.Class.privateGetPublicFields (Set ) [0x00000] in <filename unknown>:0 
   at java.lang.Class.privateGetPublicFields (Set ) [0x00000] in <filename unknown>:0 
   at java.lang.Class.getFields (ikvm.internal.CallerID ) [0x00000] in <filename unknown>:0 
```

ikvm-monotouch TypeWrapper 类的快速链接：[https ://github.com/samskivert/ikvm-monotouch/blob/master/runtime/TypeWrapper.cs](https://github.com/samskivert/ikvm-monotouch/blob/master/runtime/TypeWrapper.cs)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:22:45.437

TypeWrapper.cs 中的第 1841 行是：

```
clazz = (java.lang.Class)typeof(ikvm.@internal.ClassLiteral<>).
    MakeGenericType(type).GetField("Value").GetValue(null); 
```

所以它要么与：

a)从某种意义上说，AOT 编译器**在编译时**`MakeGenericType`不知道它需要创建一个. 由于它不知道，因此它不会编译导致.**`ClassLiteral<Cloneable>``ExecutionEngineException`**

 **您可以通过*提示*AOT 编译器需要该代码来解决此问题。例如，在您的代码中添加一个**不会**被链接或优化的地方。

```
new ClassLiteral<Cloneable> (); 
```

b）`GetField("Value")`从某种意义上说（托管）链接器可能已删除该字段。但是它应该失败了`NullReferenceException`（而不是在.cctor内）所以我**不**相信这是一个链接器问题。

OTOH，通过禁用项目中的链接器，在设备上重建和执行（如果它开始工作，那么这是一个链接器问题，您将能够通过使用字段`[Preserve]`上的属性来解决此问题`Value`（并在之后重新启用链接器）。**

# python - Python字符串插值：只显示必要的小数位

> ID：10507554
> 
> 赞同：12
> 
> 时间：2012-05-08T22:37:42.033
> 
> 标签：python, string, formatting

如果我有例如 x = 40 我想要以下结果：

```
40" 
```

对于 x = 2.5，结果应该是......

```
2.5" 
```

所以我基本上想格式化到最多一位小数。我目前使用这个：

```
"{0:0.1f}\"".format(x, 1) 
```

但这总是精确显示一位小数，这并不是我真正想要的......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-08T22:43:54.527

一种选择是

```
"{0}\"".format(str(round(x, 1) if x % 1 else int(x))) 
```

`x`如果没有小数部分，它将显示为整数。很可能有更好的方法来解决这个问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-29T17:15:39.673

这是可重复使用的，可用于`str`、`float`或`int`，并将转换`''`为`0`：

```
def minimalNumber(x):
    if type(x) is str:
        if x == '':
            x = 0
    f = float(x)
    if f.is_integer():
        return int(f)
    else:
        return f 
```

用于：

```
print "{}\"".format(minimalNumber(x)) 
```

例子：

```
x = 2.2
print "{}\"".format(minimalNumber(x))
x = 2.0
print "{}\"".format(minimalNumber(x)) 
```

哪个输出：

```
2.2"
2" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-09T00:19:40.373

也许不一定完全干净的解决方案，但我认为至少更明确一点：

```
"{1:0.{0}f}\"".format(int(not float(x).is_integer()), x) 
```

可能会被更神秘的取代（基于 Michael Mior 舍入的想法）：

```
"{1:0.{0}f}\"".format(int(x % 1 > 0), x) 
```

如果您更喜欢较短的表达式（尽管不那么 Pythonic）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-07T22:52:06.073

```
a = 2.50
b = 42.0
c = 900.0
print("{0:.1f}".format(a).rstrip('0').rstrip('.'))
print("{0:.1f}".format(b).rstrip('0').rstrip('.'))
print("{0:.1f}".format(c).rstrip('0').rstrip('.')) 
```

输出：

```
2.5
42
900 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-01T14:25:54.070

如果您负担得起更改结果类型的费用，则可以使用简单的检查：

```
if float(x) == int(x):
    print(int(x))
else:
    print(x) 
```

不花哨，但直观。

# c# - 用于 C# 超时的文档列表 API 客户端

> ID：10507557
> 
> 赞同：0
> 
> 时间：2012-05-08T22:37:58.250
> 
> 标签：c#, google-docs-api

我正在为 c# 中的 google docs api 开发一个简单的包装器。我遇到的问题是我的测试超时。有时。当我运行所有测试（只有 12 个）时，它通常会在第 8 个测试删除功能时挂断。大约 6.5 分钟后，它会继续，但之后的每次测试也会在每次测试的 6.5 分钟后超时。如果我单独运行测试，那么每次都可以正常工作。

这是第一个超时的方法：

更新以显示异常处理

```
[TestMethod]
public void CanDeleteFile()
{
    var api = CreateApi();
    api.UploadFile("pic.jpg", "..\\..\\..\\pic.jpg", "image/jpeg");
    try
    {
        var files = api.GetDocuments();
        api.DeleteFile("pic.jpg");
        var lessFiles = api.GetDocuments();
        Assert.AreEqual(files.Count - 1, lessFiles.Count);
    }
    catch (Google.GData.Client.GDataRequestException ex)
    {
        using (StreamWriter writer = new StreamWriter("..\\..\\..\\errors.log", true))
        {
            string time = DateTime.Now.ToString();
            writer.WriteLine(time + ":\r\n\t" + ex.ResponseString);
        }
        throw ex;
    }

} 
```

它在`var lessFiles = api.GetDocuments();`第二次调用该方法时超时。我有其他方法调用该方法两次，它们不会超时，但这个会。

所有测试方法使用的超时方法：

```
 public AtomEntryCollection GetDocuments(DocumentType type = DocumentType.All, bool includeFolders = false)
    {
        checkToken();
        DocumentsListQuery query = getQueryByType(type);
        query.ShowFolders = includeFolders;
        DocumentsFeed feed = service.Query(query);
        return feed.Entries;
    } 
```

它在这条线上超时`DocumentsFeed feed = service.Query(query);`。如果我请求疯狂数量的文件，这将更接近可接受。我不是。我要求 5 - 6，具体取决于我正在运行的测试。

我尝试过的事情：

*   从我的谷歌文档帐户中删除所有文件，只留下 1-2 个文件，具体取决于要检索的测试。
*   单独运行测试（它们都通过并且没有超时，但我不应该这样做）
*   检查我的网络速度以确保它不是非常慢（15mbps 下降 4.5mbps 上升）

我没主意了。如果有人知道为什么它可能会开始对我超时？欢迎任何建议。

**编辑**

正如@gowansg 建议的那样，我在我的代码中实现了指数退避。它在同一点开始失败，但出现同样的异常。然后我编写了一个测试来发送 10000 个请求，以获取驱动器中所有文档的完整列表。它在没有使用指数退避的情况下顺利通过。接下来我修改了我的测试类，以便跟踪发送了多少请求。我的测试在请求 11 时崩溃。

完整的例外：

```
Google.GData.Client.GDataRequestException was unhandled by user code
Message=Execution of request failed: https://docs.google.com/feeds/default/private/full
Source=GoogleDrive
StackTrace:
     at GoogleDrive.GoogleDriveApi.GetDocuments(DocumentType type, Boolean includeFolders) in C:\Users\nlong\Desktop\projects\GoogleDrive\GoogleDrive\GoogleDriveApi.cs:line 105
     at GoogleDrive.Test.GoogleDriveTests.CanDeleteFile() in C:\Users\nlong\Desktop\projects\GoogleDrive\GoogleDrive.Test\GoogleDriveTests.cs:line 77
InnerException: System.Net.WebException
     Message=The operation has timed out
     Source=System
     StackTrace:
          at System.Net.HttpWebRequest.GetResponse()
          at Google.GData.Client.GDataRequest.Execute()
     InnerException: 
```

**另一个编辑**

似乎我只有在第二次上传后请求文档数量后才会崩溃。我不确定为什么会这样，但我肯定会研究我的上传方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:31:19.303

如果您的测试在单独运行时通过，但在连续运行时没有通过，那么您可能会达到请求速率限制。我在您对 JotaBe 的回答中注意到您提到的请求超时异常。您应该查看 http 状态代码以[了解该做什么](https://developers.google.com/google-apps/documents-list/#handling_api_errors)。在 503 的情况下，您应该实施[异常后退](https://developers.google.com/google-apps/documents-list/#implementing_exponential_backoff)。

**更新建议**

`try-catch`在抛出异常的行周围放置 a并捕获`Google.GData.Client.GDataRequestException`. 根据[消息来源](http://code.google.com/p/google-gdata/source/browse/trunk/clients/cs/src/core/exceptions.cs)，有两个属性可能对您有价值：

```
 /// <summary>
    /// this is the error message returned by the server
    /// </summary>
    public string ResponseString
    { ... } 
```

和

```
 //////////////////////////////////////////////////////////////////////
    /// <summary>Read only accessor for response</summary>
    //////////////////////////////////////////////////////////////////////
    public WebResponse Response
    { ... } 
```

希望这些包含一些对您有用的信息，例如 HTTP 状态代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T22:41:52.513

您可以显式设置单元测试的超时时间。在这里，您可以获得有关它的大量信息：

*   [如何：设置运行测试的时间限制](http://msdn.microsoft.com/en-us/library/ms243175.aspx)

您可以在有`Thread.Sleep(miliseconds)`问题的方法之前包含在单元测试中。可能您的请求在太短的时间内被谷歌文档拒绝了。

# android - ProGuard 不会混淆 Android 项目？

> ID：10507566
> 
> 赞同：0
> 
> 时间：2012-05-08T22:39:39.730
> 
> 标签：android, security, proguard

我尝试在我的 Android 项目中包含 ProGuard，因为我希望我的应用程序在反编译后不那么“可读”，所以我配置了 ProGuard，并且反编译的应用程序（使用 apktool）与 ProGuard 没有区别。

这是我的 proguard.cfg 文件：

```
-optimizationpasses 5
-dontwarn org.apache.commons.codec.binary.Base64
-dontusemixedcaseclassnames
-dontskipnonpubliclibraryclasses
-dontpreverify
-verbose
-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*

-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider
-keep public class * extends android.app.backup.BackupAgentHelper
-keep public class * extends android.preference.Preference
-keep public class com.android.vending.licensing.ILicensingService

-keepclasseswithmembernames class * {
    native <methods>;
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet);
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet, int);
}

-keepclassmembers class * extends android.app.Activity {
   public void *(android.view.View);
}

-keepclassmembers enum * {
    public static **[] values();
    public static ** valueOf(java.lang.String);
}

-keep class * implements android.os.Parcelable {
  public static final android.os.Parcelable$Creator *;
} 
```

另外，我将此行添加到 project.properties：proguard.config=proguard.cfg

# c++ - 如何用 QTest 测试 QTableView 版本？

> ID：10507571
> 
> 赞同：1
> 
> 时间：2012-05-08T22:40:06.743
> 
> 标签：c++, unit-testing, qt, qt4, qtestlib

我想用 QTest 模拟 QTableView 单元格的版本。

我尝试了不同的方法，但没有任何成功：

```
qtableview->show(); 
/* I think that in my unit test I should no need 
that, could you confirm ? */

QModelIndex modelIndex = qtableview->model()->index(1,1); 
//I have tested that modelIndex is valid and that I retrieved expected data

/*First try: set the currentIndex on modelIndex 
thinking that keyClicks on qtableview will work 
on selected element of the tableview*/
qtableview->setCurrentIndex(modelIndex );
QTest::KeyClicks(qtableview,“Hello Word”);
QCOMPARE->index(1,1).data(), “Hello World”); // —&gt; FAILED

/*Second approach
Get the cell widget*/
QWidget * qwidget = qtableview->indexWidget( modelIndex );
//—&gt; No test since the qwidget is NULL… why ?

/*Third approach
Get the cell widget through the delegate*/
QWidget * qwidget = 
      qtableview->itemDelegate( modelIndex )->createEditor(qtableview,       
                                                           QStyleOptionViewItem(), 
                                                           modelIndex );
QTest::KeyClicks(qwidget ,“Hello Word”);
QCOMPARE->index(1,1).data(), “Hello World”); // —&gt; FAILED 
```

我也在三个方法中添加了没有任何成功

```
QTest::mouseDClick(qtableview)
QTest::KeyClicks(qtableview,“Hello Word”); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:59:34.983

我认为您需要在显示小部件后处理事件。如果 QListView 被隐藏，它可能不会做任何事情（因为它应该！）。看看 qWaitForWindowShown(qtableview) 是否可以解决问题。如果这不起作用，请通过调用 QCoreApplication::processEvents() 直接运行事件循环。看看 qWaitForWindowShown，它可能会旋转一个事件循环。

# sql-server - 带有数据连接文件的 Excel

> ID：10507573
> 
> 赞同：4
> 
> 时间：2012-05-08T22:40:22.187
> 
> 标签：sql-server, excel, excel-2007

有什么方法可以让 Excel 2007 连接到 SQL Server 中的表或视图，而无需维护单独的“数据连接文件”？我希望连接字符串可以嵌入到 Excel 文档中。我想传递这个 Excel 文档，而不必随它一起发送数据连接文件。执行此操作的唯一方法是将数据连接文件放在具有正确权限的网络文件共享上。这看起来很荒谬，因为安全设置为 Windows 身份验证。

我们希望远离 ODBC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T03:06:18.410

是的，你可以用 VBA 做到这一点。

您可以使用内置数据库查询（查询表）或通过 ADO 来完成。

如果您没有任何（或太多）编程经验（或使用 ADO 的经验），您可能会想要走查询表路线。找出代码的最简单方法是启动宏记录器，选择 Data | 获取外部数据 | 新的数据库查询。然后选择新的数据源 SQL Server，然后从那里开始。

完成后，停止宏记录器并查看代码。生成的代码中可能有很多额外的东西，但它应该让你开始。

# python - python和mysql中的矩阵乘法

> ID：10507577
> 
> 赞同：4
> 
> 时间：2012-05-08T22:41:24.567
> 
> 标签：python, mysql, sql, math

我有一本货币兑换字典，如下：

```
exchange_rates = {'USD': 1.00000,
                  'EUR': 1.32875,
                  'GBP': 1.56718, ...} 
```

然后我检索产品的销售信息，使用：

```
SELECT price, currency FROM sales 
```

可能有一百万行，可能如下所示：

```
- 2.99    USD
- 3.01    EUR
- etc. 
```

我将如何进行矩阵乘法以获得美元的总和？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T22:46:58.793

与其从数据库中获取一百万行并在 Python 中进行计算，不如将您的字典提供给数据库并让数据库进行计算并将结果发回给您。

您可以通过进行类似于以下的查询来做到这一点：

```
SELECT SUM(price * exchange_rate) AS total
FROM sales
LEFT JOIN
(
    SELECT 'USD' AS currency, 1.00000 AS exchange_rate
    UNION ALL
    SELECT 'EUR', 1.32875
    UNION ALL
    SELECT 'GBP', 1.56718
    -- ...
) AS exchange
ON exchange.currency = sales.currency 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T22:44:29.940

做

```
SELECT price FROM sales 
```

然后总结你得到的所有项目，假设你表中的数字是美元。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:53:27.223

```
SELECT SUM(price * factor) 
FROM 
       ( 
        SELECT sales.price AS price, exchange.factor AS factor
        FROM   sales
        JOIN   exchange ON exchange.currency = sales.currency
       ) AS t 
```

这假设您有一个交换表

# php - 在 PHP 中加载页面并提交表单

> ID：10507581
> 
> 赞同：0
> 
> 时间：2012-05-08T22:42:32.197
> 
> 标签：php, curl, form-submit

我正在创建一个使用在线编译器的系统。IDEONE 为我提供了此功能（通过 Web 服务），但要付出大量编译的代价。

然后我尝试使用[codepad](http://codepad.org)，但它没有 Web 服务... codepad 有一个初始页面，然后单击它的提交按钮，显然加载相同的页面（表单的操作是“/”）...

我正在使用 curl 加载页面，但出现“内部服务器错误”。这是我的代码：[pastebin 代码](http://pastebin.com/SrB6f0mg)，我使用的是 000webhost，我不知道是我做错了什么还是我的网络服务器不支持它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:50:19.690

您是否真的删除了 TIMEOUT？或者也许扩展它？

试试这个也许：

```
<html>
<div align="center">
    <form action="compilador.php" method="POST">
        <textarea id="source" name="source"></textarea>
        <input type="submit" value="Enviar" />
<?php
    if(isset($_POST['source']) && $_POST['source'] != "")
    {
       $ch = curl_init();

 /**
 * Set the URL of the page or file to download.
 */
 curl_setopt($ch, CURLOPT_URL, "http://codepad.org");

 /**
 * Ask cURL to return the contents in a variable instead of simply echoing them to  the browser.
 */
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

$post_data=$_POST;

        $post_data['lang'] = 'C';
        $post_data['private'] = True;
        $post_data['run'] = True;

        foreach($post_data as $key => $value)
        {
            $post_items[] = $key . '=' . $value;
        }
        $post_string = implode ('&', $post_items);

        curl_setopt($ch, CURLOPT_POSTFIELDS, $post_string);

        $result = curl_exec ($ch);

 /**
 * Close cURL session
 */
 curl_close($ch);

        echo "<br /><br />RESULT: {".$result."}";
    }

    ?>
    </form>
</div>
</html> 
```

# entity-framework-4 - 为什么 Mini-Profiler 只显示 SQL 文本的“ExecuteStoreCommands”？

> ID：10507582
> 
> 赞同：0
> 
> 时间：2012-05-08T22:42:38.807
> 
> 标签：entity-framework-4, mvc-mini-profiler

我刚刚将 MiniProfiler 连接到我的 MVC3 项目。我正在使用 EF4.0 并为我的实体生成 POCO 类。

如果重要的话，这些生成的 ObjectContexts 使用 ObjectSet<>。我还在上下文中将 NInject 用于 IoC。（我在 RequestScope 中有这些，但我将它们更改为 TransientScope 以排除该问题）。

我看到的所有分析都将“ExecuteStoreCommands”显示为查询。

关于为什么会出现“ExecuteStoreCommands”而不是 SQL 的任何想法？我在 SQL Profiler 中看到真正的 sql，如下所示：

```
exec sp_executesql N'SELECT 
[Project2].[OrderID] AS [OrderID], 
... 
```

我是否因为不在 EF4.1/4.2/4.3 上而遇到麻烦？是因为我没有使用 CodeFirst 吗？是 POCO 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T14:33:00.210

看起来我在使用 MiniProfiler 库时遇到了问题。对象的序列化`SqlTiming`（通过 FromJSON）保存了`FormattedCommandString`只有一个 get 方法的对象。在反序列化时，这意味着`CommandString`and`FormattedCommandString`都是`null`。

反序列化之前的快速（hacky）修复是：

```
profilerString = profilerString.Replace("FormattedCommandString", "CommandString");
var profiler = MiniProfiler.FromJson(profilerString); 
```

# java - 在生产中将 jpeg 图像存储为带有方形框的黑色背景颜色

> ID：10507585
> 
> 赞同：0
> 
> 时间：2012-05-08T22:43:02.447
> 
> 标签：java, image-processing, encoding

我正在从 URL 重新调整 jpeg 图像的大小，并使用 Java servlet 中的 JPEGImageEncoder 存储在某个目录中。

代码在我们的开发 Solaris 服务器中运行良好。但它将图像存储为带有方形框的黑色背景色。

请帮助我解决可能的问题。提前致谢。

```
BufferedImage thumbImage = new BufferedImage(thumbWidth, 
          thumbHeight, BufferedImage.TYPE_INT_RGB);
Graphics2D graphics2D = thumbImage.createGraphics();
graphics2D.setRenderingHint(RenderingHints.KEY_INTERPOLATION,
          RenderingHints.VALUE_INTERPOLATION_BILINEAR);
graphics2D.drawImage(image, 0, 0, thumbWidth, thumbHeight, null);

JPEGImageEncoder encoder = JPEGCodec.createJPEGEncoder(out);
JPEGEncodeParam param = encoder.getDefaultJPEGEncodeParam(thumbImage);

int quality = Integer.parseInt(nquality);
quality = Math.max(0, Math.min(quality, 100));
param.setQuality((float)quality / 100.0f, false);
encoder.setJPEGEncodeParam(param);
encoder.encode(thumbImage); 
```

-马诺伊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T13:38:50.197

我得到了解决方案。

实际上，无法从 Java 代码访问源图像 url。这就是我得到黑色图像的原因。我们将 url 更改为可访问，现在它工作正常。

谢谢。

# ruby-on-rails - 导轨：确认 | 如何在确认框中默认选择“取消”？

> ID：10507589
> 
> 赞同：1
> 
> 时间：2012-05-08T22:43:35.510
> 
> 标签：ruby-on-rails, ruby

单击链接时会出现确认框消息。

```
<%= link_to 'Close Account',
    @profile,
    :confirm => "Are you sure?",
    :method => :delete
%> 
```

出现确认框时，默认选择“确定”按钮；我希望默认选择“取消”按钮，这样如果用户不小心按回车，那么配置文件记录将是安全的，不会被删除。

是否可以选择“取消”按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T22:49:11.873

确认框由 Javascript 生成，使用 Rails 中的属性选择器（注`data-confirm`）在元素上。不幸的是，这个框是由浏览器生成的，所以没有真正的直接控制。如果您使用的是最新版本的 Rails，我建议您查看 jQuery UI，并使用[对话框](http://jqueryui.com/demos/dialog)库。在这里，您可以进行自定义确认，甚至可以进行属性绑定，例如`data-uiconfirm`. 看起来像这样：

```
<%= link_to 'Close Account',
    @profile,
    :data =>
      {:uiconfirm => "Are you sure?"},
    :method => :delete
%> 
```

属性绑定如下：

```
$('[data-uiconfirm]').dialog(....) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:48:46.270

不，这是一个浏览器实现的东西，没有办法改变选中的框。如果您想解决这个问题，您必须制作自己的弹出代码，您可以在其中更改选择。

# java - asin() 函数有问题

> ID：10507591
> 
> 赞同：0
> 
> 时间：2012-05-08T22:43:43.127
> 
> 标签：java, android, math, trigonometry

我有这两行代码：

```
var[1] =var[2].multiply(var[3]).multiply(var[4]).multiply(new BigDecimal(Math.sin(var[5].doubleValue())));
    var[5] =new BigDecimal(Math.asin(var[1].divide(var[2],precision,BigDecimal.ROUND_HALF_UP).divide(var[3],precision,BigDecimal.ROUND_HALF_UP).divide(var[4],precision,BigDecimal.ROUND_HALF_UP).doubleValue())); 
```

我为 var[2]、var[3]、var[4] 和 var[5] 赋值以获得 var[1]。

使用的方程是

```
var[1]=var[2]*var[3]*var[4]*sin(var[5]) 
```

然后我试图使用我刚刚得到的 var[1] 和其他变量的相同值来获取 var[5]，它给了我一个错误的数字，我不明白为什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:46:01.250

你确定你的数字是弧度而不是度数吗？

尝试转换为弧度：[http](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Math.html#toRadians(double) ://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Math.html#toRadians(double )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:10:34.873

**改写**

我正在清理一些算术蜘蛛网，但是：

```
Math.asin(Math.sin(1)) == ~1
Math.asin(Math.sin(3.14 / 2)) == ~3.14 / 2  // 1.57
Math.asin(Math.sin(3.14)) == ~0 
```

就像[文档](http://developer.android.com/reference/java/lang/Math.html#asin%28double%29)说 Math.asin() 的结果绑定在 -Pi/2 和 Pi/2 之间...

所以你的答案看起来“不正确”，因为它被限制在这个范围内。

**备用**

最 asin() 将返回的是： Pi/2 = 1.57

并且 2 > 1.57 所以：

2 - 1.57 = 0.43

1.57 - 0.43 = 1.14

因此：2 = 1.14

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:53:48.500

我认为你的问题是

var[5] = asin(var[1]/var[2]/var[3]/var[4])

而不是

var[5] = asin(var[1] 除以 (var[2]*var[3]*var[4]))

我希望我正确理解了您的代码。

# asp.net-mvc - MVC 3 Code First ViewModel - 如何？

> ID：10507592
> 
> 赞同：2
> 
> 时间：2012-05-08T22:43:43.310
> 
> 标签：asp.net-mvc, c#-4.0, viewmodel, code-first

我目前正在使用 ASP .NET MVC 3 和 - 对于数据访问 - 实体框架的代码优先方法。

我已经阅读了很多文档、博客、stackoverflow 问题等，但还没有找到以下问题的准确答案，我希望有人可以帮助我。

我有一个包含两个实体的简单（数据库）模型：项目和客户

```
public class Project
{
    public int Id { get; set; }
    public string Name { get; set; }
    public virtual Customer Customer { get; set; }
} 
```

和...

```
public class Customer
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int Rate { get; set; }
} 
```

为了显示 - 例如 - 我创建了一个简单的 ViewModel 的客户列表：

```
public class ProjectListModel
{
    public List<Project> Projects { get; set; }
} 
```

我的控制器中的代码是：

```
public ActionResult ProjectList()
{
    var model = new ProjectListModel()
    {
        Projects = db.Projects.OrderBy(x => x.Customer.Id).ToList<Project>()
    };
    return PartialView("_ProjectList", model);
} 
```

所以我可以显示项目列表，甚至是对应的客户名称。

```
@Html.DisplayFor(modelItem => item.Name), @Html.DisplayFor(modelItem => item.Customer.Name)) 
```

这里开始我的问题;-)

我不确定在返回“数据库对象”列表时是否正确理解了 ViewModel 的概念。你会怎么做？我可以想象一个新课程：

```
public class SingleProjectForViewModel
{
  public string ProjectName {get;set;}
  public string CustomerName { get;set;}
} 
```

并将我的 ViewModel 更改为：

```
public class ProjectListModel
{
  public List<SingleProjectForViewModel> {get;set;}
} 
```

...但是我的控制器中的代码会变得很长，只是为了填充 ViewModel（从 DB 中获取，创建 SingleProjectForViewModel 的实例并将这个实例添加到实例化的列表中）——对于这个例子来说，这可以，但是有更大的数据类还有更复杂的视图...！？

我还阅读了有关 Auto-Mapper 的信息，但我不确定使用此工具解决此类“问题”是否“正确”。

非常感谢您阅读本文 - 以及更多的回答或任何建议！:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:03:21.673

您正确理解视图模型。它们旨在消除视图层与数据层的任何耦合。

您可以/应该将数据访问代码分解为辅助类和方法，以消除控制器的复杂性。这些方法将查询数据层并返回视图模型。

我没有使用过自动映射器，但这听起来肯定可以在这里提供帮助。

# asp.net - 如何在 Asp.NET 中防止 XSS

> ID：10507596
> 
> 赞同：2
> 
> 时间：2012-05-08T22:44:23.283
> 
> 标签：asp.net, xss, security, cross-site

可以使用哪些技术来防止在 asp.net 中执行跨站点脚本？是否有任何非现成的实现可用于实现网站免受 xss 的保护？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T05:37:58.400

我们为此做了很长时间的内部开发，但最终微软为它提供了一个库。我们现在用这个完全替换了我们的库。它可以简单地使用如下：

```
string sanitizedString = Microsoft.Security.Application.Sanitizer.GetSafeHtmlFragment(string myStringToBeChecked); 
```

此方法的唯一问题是它会修剪多个用行尾字符分隔的空格。如果您不希望这种情况发生，您可以考虑先根据行尾字符 (\r\n) 拆分字符串，然后计算这些拆分字符串前后的空格数，应用消毒剂，将空格追加并连接.

除此之外，微软图书馆工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T22:48:38.297

microsoft 反跨站点脚本库是一个好的开始。它有一些有用的辅助方法来防止 XSS。它现在是更大的[Microsoft Web 保护库的一部分](http://wpl.codeplex.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-12T18:21:42.263

**保护跨站脚本攻击的方法如下。**

```
 1\.  Use HtmlEncoding while saving the input content that is received from web  application controls usch as textbox etc.
 2\.  Use InnerText instead of InnerHtml while displaying data on the page.
 3\.  Do the input sanitization before saving the data into database. 
```

# html - 如何打破跨度列表

> ID：10507605
> 
> 赞同：3
> 
> 时间：2012-05-08T22:45:07.780
> 
> 标签：html, css

我有一个表，在一些单元格中我很少`<span>`，`<td>`包含这些跨度的类具有`word-wrap: break-word; white-space: normal;`.

换句话说：`<td class="breakit"><span>foo</span><span>bar</span></td>`

和：`.breakit{ word-wrap: break-word; white-space: normal; }`

好吧，无论我缩小浏览器多少，它都不会破坏跨度！

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T22:56:22.233

为什么？因为 foo 和 bar 之间没有空格。

在你的 HTML 中放入一个空格，或者将条跨度向下移动一行，它就会中断。

**更新** 我想我找到了真正的原因：

“无论您如何指定表格宽度，每个表格都有一个最小尺寸，并且它永远不会显示小于该尺寸。最小尺寸由每个单元格中最长单个单词的长度计算。” 发现于： http: [//www.devx.com/projectcool/Article/17870/0/page/9](http://www.devx.com/projectcool/Article/17870/0/page/9)

...并且此规则似乎适用于每个单元格，也就是说，单元格的最小宽度由其中最长的单词决定。

（这是不将表格用于一般布局目的的另一个原因）。

# android - 如何从 DatePickerDialog 中获取 DatePicker？

> ID：10507607
> 
> 赞同：9
> 
> 时间：2012-05-08T22:45:09.203
> 
> 标签：android, datepicker, datepickerdialog

我有一个弹出 android.app.DatePickerDialog 的活动。

```
DatePickerDialog dialog =  new DatePickerDialog(this, startDateSetListener, start_cal.get(Calendar.YEAR), start_cal.get(Calendar.MONTH), start_cal.get(Calendar.DATE)); 
```

我想从 DatePickerDialog 访问 DatePicker 视图，以便设置最小和最大日期。API 参考说有一个方法 getDatePicker 并且自 API 1 以来一直存在，但它是无效的，我的 ide 不喜欢它。

```
DatePicker picker = dialog.getDatePicker(); 
```

“方法 getDatePicker() 未定义 DatePickerDialog 类型”

任何人都知道创建方法的 API 是什么，或者我如何可以使用 DatePicker 来编辑最小/最大日期？

我正在使用 API 7，平台 2.1。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-08T23:41:40.853

尽管 getter 方法仅在 Honeycomb 及更高版本中可用（正如 dmon 正确指出的那样），您仍然可以相当容易地访问使用反射`DatePicker`封装的对象。`DatePickerDialog`它看起来像这样：

```
DatePickerDialog dialog = ... // create dialog
Field mDatePickerField = dialog.getClass().getDeclaredField("mDatePicker");
mDatePickerField.setAccessible(true);
DatePicker mDatePickerInstance = (DatePicker) mDatePickerField.get(dialog); 
```

从这一点开始，您有了对内部`DatePicker`对象的引用，您应该能够根据自己的喜好对其进行更改。请注意任何明显的拼写错误，因为我是直接在浏览器中输入的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T22:49:24.980

您误读了，它仅在 API 11 之后可用：

“公共 DatePicker getDatePicker () 自：API 级别 11”。*[仔细](http://developer.android.com/reference/android/app/DatePickerDialog.html#getDatePicker%28%29)*看。

# c - libpng 1.5.10 错误：取消引用指向不完整类型的指针

> ID：10507610
> 
> 赞同：8
> 
> 时间：2012-05-08T22:45:26.220
> 
> 标签：c, libpng

```
png_read_info (png_ptr, info_ptr);
{ 
    png_byte color_type = info_ptr->color_type;
    png_byte bit_depth  = info_ptr->bit_depth;
    ... 
```

最后两行我得到

> 错误：取消引用指向不完整类型的指针

怎么了？在 libpng 1.4 中，这总是可以的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-11T05:21:35.907

该`png_info`结构已从`png.h`1.5.0 中删除，现在您应该将此指针与`png_get_*`and`png_set_*`函数一起使用。

如[libpng 手册](http://www.libpng.org/pub/png/libpng-manual.txt)中所述：

> png_info 结构旨在提供有关 PNG 文件的信息。曾几何时，png_info 的字段旨在让用户直接访问。然而，这往往会导致使用动态加载库的应用程序出现问题，因此开发了一组用于 png_info 的接口函数（png_get_*() 和 png_set_*() 函数），并且不推荐直接访问 png_info 字段..

例如：

```
png_uint_32 height;
height = png_get_image_height( png_ptr,  info_ptr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-22T18:13:42.143

如果您尝试设置不再可直接访问的 info_ptr 的内容，请使用 png_set_IHDR()

如[libpng 手册中所述](http://www.libpng.org/pub/png/libpng-1.2.5-manual.html#section-4.3)

# python - 检查 QuerySet 中是否存在对象

> ID：10507612
> 
> 赞同：3
> 
> 时间：2012-05-08T22:45:47.930
> 
> 标签：python, django, for-loop, django-queryset

所以我有一个用户模型和一个晚餐模型。它们由 LotteryEntry 模型关联。（又名人们必须进入彩票才能被选中去吃饭）

假设我有一个这样的晚餐查询集：

```
first_page_dinners = Dinner.objects.all().order_by('-created_at')[:5] 
```

以及当前登录用户的“彩票”查询集

```
entries = LotteryEntry.objects.filter(user=request.user) 
```

现在在模板中，我正在遍历晚餐对象，但还想检查该人是否已经为该晚餐输入了彩票......所以像这样：

```
{% for d in dinners %}
   {% if entries.contains(d) %}
   //custom html here if user has already entered lottery
   {% endif %}
{% endfor %} 
```

然而，“.contains”不是真实的。django/python 是否提供了这样一个不错的小方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T23:13:50.933

尝试使用[values_list](https://docs.djangoproject.com/en/dev/ref/models/querysets/#values-list)，这样检查对象是否存在会更容易：

```
dinner_entries = LotteryEntry.objects.filter(user=request.user).values_list('dinner__id', flat=True) 
```

在您的模板中，您可以像这样检查：

```
{% if d.id in dinner_entries %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:01:30.133

如果不更详细地了解您的数据模型，很难回答您的问题，但我仍然尝试这样做：

慢，但应该有效：尝试在每顿晚餐的彩票条目上进行迭代，然后在记录中查找您的外键字段`LotteryEntry`。如果引用的晚餐与外部循环中的晚餐记录匹配，那么您就在那里。

如果您想要一个更快的解决方案，那么您需要根据您的条目查询集准备一个字典，将晚餐记录映射到相应`LotteryEntry`的记录。`get`然后，您可以使用此映射通过调用字典的方法来查找相应的彩票条目。如果没有彩票条目，那么您将仅获得`None`.

# rrdtool - 如何按日期修剪 rrd 文件

> ID：10507613
> 
> 赞同：1
> 
> 时间：2012-05-08T22:45:53.517
> 
> 标签：rrdtool, rrd

您好，有没有办法按日期修剪 rrd 文件？它似乎可能是`rrdtool dump file`垃圾场

```
<!-- 2012-05-07 19:15:00 UTC / 1336418100 --> <row><v> 0.0000000000e+00 </v></row>
<!-- 2012-05-07 19:20:00 UTC / 1336418400 --> <row><v> 9.6589767000e-01 </v></row>
<!-- 2012-05-07 19:25:00 UTC / 1336418700 --> <row><v> 3.4568563333e-02 </v></row>
<!-- 2012-05-07 19:30:00 UTC / 1336419000 --> <row><v> 9.6402870667e-01 </v></row> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T20:27:03.603

您可以在还原之前编辑转储文件...不确定修剪的含义，因为 rrdfiles 始终保持相同的大小。

# apache - 需要帮助将 apache 重定向转换为 nginx

> ID：10507616
> 
> 赞同：0
> 
> 时间：2012-05-08T22:46:24.770
> 
> 标签：apache, url-rewriting, nginx

我需要从 Apache 迁移到 Nginx，并且需要一些帮助来转换此规则

```
RewriteRule ^resizer/(.*)x(.*)/r/(.*) resizer/thumb.php?src=http://$3&h=$2&w=$1&zc=1&a=t&s=1 
```

我有以下似乎不起作用

```
location /resizer {
    rewrite ^resizer/(.*)x(.*)/r/(.*) resizer/thumb.php?src=http://$3&h=$2&w=$1&zc=1&a=t&s=1 last;
} 
```

感谢您在这方面的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:01:41.277

这对我有用

```
rewrite ^/resizer/(.*)x(.*)/r/(.*)$ /resizer/thumb.php?src=http://$3&h=$2&w=$1&zc=1&a=t&s=1 last; 
```

# c++ - LNK1112 上 Directshow C++ CLR 项目

> ID：10507617
> 
> 赞同：0
> 
> 时间：2012-05-08T22:46:47.203
> 
> 标签：c++, clr, directshow

我正在尝试从 C++ 重建 CLR C++ 中的程序，但出现链接器错误

```
1>strmbasd.lib(strmiids.obj) : fatal error LNK1112: module machine type 'x64' conflicts with target machine type 'X86' 
```

我的项目设置为 Win32，属性设置为目标机器 x86。我一直在重建基类以匹配 Win32，但我不知道它在哪里或为什么失败

链接器命令行如下所示：

```
/OUT:"C:\Users\ME\Documents\Code\X C++\Trial2\DirectshowC++\Debug\DirectshowC++.exe" /INCREMENTAL /NOLOGO /MANIFEST /MANIFESTFILE:"Debug\DirectshowC++.exe.intermediate.manifest" /MANIFESTUAC:"level='asInvoker' uiAccess='false'" /DEBUG /ASSEMBLYDEBUG /PDB:"C:\Users\ME\Documents\Code\X C++\Trial2\DirectshowC++\Debug\DirectshowC++.pdb" /SUBSYSTEM:WINDOWS /ENTRY:"main" /DYNAMICBASE /FIXED:No /NXCOMPAT /MACHINE:X86 /ERRORREPORT:PROMPT strmiids.lib strmbasd.lib  kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:51:36.240

我会尝试添加“C:\Program Files\Microsoft SDKs\Windows\v6.0\Lib\x86”作为链接器路径选项的第一个条目。显然，您应该修复路径以匹配系统上已安装的文件夹。

# math - 找到向量之间的角度

> ID：10507620
> 
> 赞同：0
> 
> 时间：2012-05-08T22:46:51.883
> 
> 标签：math, vector, angle

> **可能的重复：**
> [找到向量之间的符号角](https://stackoverflow.com/questions/2150050/finding-signed-angle-between-vectors)

我需要一些数学问题的帮助。

所以，我得到了一个向量 v，代表一个方向，以及两个点 s 和 t。我要做的是找到应用于我的向量 v 的旋转，以使其与两个给定点定义的向量平行。

目前我在某种程度上实现了这一点，也就是说，我能够找到角度，而不是应用它的方式（顺时针或逆时针）。

目前我只是在计算向量点积的 acos。

欢迎任何意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:01:20.053

假设`acos`给你一个介于 0 和 pi 之间的值。

假设向量 from `s`to`t`被称为`u`。正如你已经计算过的，

```
acos((v . u)/(|v| * |u|)) 
```

给你一个角度`alpha`。现在实际上，`v`可以向一个或另一个方向`u`旋转。`alpha`

你可能需要这个 2D，但我会先用 3D 继续。

旋转应该围绕垂直于`v`和的向量进行`u`。这个向量当然是两者的叉积：`u x v`

让我们看一个例子：

```
 / v
  /
 /\  alpha
/  )
------------ u 
```

在这种情况下，`u x v`给出一个朝向显示器外部的矢量。同时，您可以看到配给`alpha`应**逆时针**进行以`v`与 平行`u`。

也就是说，在 3D 中，您必须计算`w = u x v`并始终相对于 逆时针`v`旋转。或者，您可以相对于（即）顺时针旋转。`alpha``w``v``alpha``-w``v x u`

在 2D 中，我假设您想要旋转`z`并且您不知道哪个方向。您可以应用与上述相同的方法：

*   计算`w = u x v`
*   如果`w`具有正 z（x 和 y 将为零）
    *   然后，`v`应逆时针旋转。
    *   否则，`v`应顺时针旋转。

# objective-c - Objective-c：从方法返回自动释放的对象

> ID：10507621
> 
> 赞同：3
> 
> 时间：2012-05-08T22:46:58.597
> 
> 标签：objective-c, methods, nsarray, autorelease, nsobject

是什么阻止了自动释放的实例`NSArray`在它返回到的方法中使用之前被释放？

```
- (NSArray *) f {
    return [NSArray array];
}

- (void) g {
    NSArray *a = [self f];
    // do something with a
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T23:01:34.217

> 是什么阻止了自动释放的 NSArray 实例在它返回到的方法中使用之前被释放？

自动释放池是**每个线程**的。也就是说，自动释放的对象实际上是`release`在每个线程的基础上发生的延迟调用。

因此，如果调用`drain`者和被调用者之间没有调用，则不会因为池耗尽而释放自动释放的对象（除非严重的线程愚蠢）。

一般来说，游泳池会在非常好的指定时间排干，就像凯文说的：

• 运行循环将在每次通过循环的底部排出池

• 通过 GCD 分派的块将在池上下文中执行，该上下文将“不时地”耗尽（实现细节）。NSOperationQueue 的行为类似

• 其他线程负责自己做

因此，在您的简单示例中，代码执行是非常线性的，并且通过检查，在返回和调用者中的使用之间的执行线程中不会有任何消耗。

（请注意，这也是无用的原因之一`retainCount`；它既不考虑由引起的任何“延迟释放”调用，`autorelease`也不量化任何每个线程的保留。实际上，您应该将保留/释放视为完全按-thread; 如果你在一个线程上保留一个对象，你应该在同一个线程上释放它，*除非你明确地将所有权从一个线程转移到另一个线程*。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T22:55:59.170

自动释放的对象仅在其周围的池被耗尽时才被释放。这不是幕后发生的一些神奇的过程。这是在明确定义的时间发生的确定性事件。通常，当控制返回到运行循环时，池会被耗尽。如果您建立自己的嵌套池，那么您可以控制何时排水。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T22:55:38.577

自动释放池在事件循环的迭代期间被耗尽。由于正是这种消耗导致释放消息被发送到自动释放的对象，它们在调用方法中仍然有效。

# c# - 使用 jQuery $.Ajax 将 DTO 与附加参数一起传递给 WebMethod

> ID：10507624
> 
> 赞同：3
> 
> 时间：2012-05-08T22:47:14.023
> 
> 标签：c#, javascript, jquery, webmethod

再会，

我的 WebMethod 看起来有点像这样......

```
[WebMethod]
    public static string ProcessItem(Item item, ItemStatus status)
    {
        try
        {
            item.Process(status);
            return "Success!";
        }
        catch (Exception ex)
        {
            return ex.Message;
        }
    } 
```

我有一个看起来有点像这样的 jQuery 方法......

```
function Process(dto, status) {
        $.ajax({
            type: 'POST',
            url: 'ProcessPO.aspx/ProcessItem',
            data: JSON.stringify(dto) + status',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            success: function (msg) {
                if (msg.d)
                    alert('success');
            },
            error: function (xhr, status, errorThrown) {
                alert(xhr.responseText);
            }
        });
    } 
```

在 data: 行中，我如何连接两者以便正确传递？

dto 是这样定义的...

```
var dto = { 'item': item }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T22:52:22.600

```
var d = JSON.Stringify(dto);
d.status = status; 
```

然后在ajax调用中

```
data: d 
```

此外，通过查看您的代码，您可能希望返回一个 JsonResult。

```
return Json(new {Success=true}); //Success
return Json(new {Success=false, Message = ex.Message}); //Failure

//if it is a get request
return Json(new {Success=true}, JsonRequestBehavior.AllowGet) //Success
return Json(new {Success=false, Message = ex.Message}, JsonRequestBehavior.AllowGet) //Failure 
```

这将允许您在 javascript 中查看该方法的结果。

```
success: function(response){
    if(response.Success){
        alert('Success!');
    }else{
        alert('Failure! ' + response.Message);
    }
} 
```

# ant - 在 ant 或 subant 任务完成后移动 ant dir 项目

> ID：10507626
> 
> 赞同：0
> 
> 时间：2012-05-08T22:47:25.583
> 
> 标签：ant

目前我正在使用 shell 脚本来执行以下操作：

```
cd myproject1/
ant
cd ..
if grep 'sucessful' myproject/buil.log then move myproject ../backup/today/ 
```

对于 myproject2、myproject3，依此类推。

如果发生一些错误，项目将保留在当前目录中以进行重新处理，但整个过程仍在继续。

我想将此过程迁移到 ant 构建脚本，但我不知道如何执行此操作。

我看过 ant 和 subant 任务。Ant 看起来更适合这项工作，但我找不到使用 ant 循环目录列表并将任务移动到一起的方法，检查 ant 任务是否完成。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:01:41.600

签出这个答案：

[在不同目录中的不同 ant 脚本中运行特定目标](https://stackoverflow.com/questions/9132766/running-specific-target-in-different-ant-scripts-in-different-directories/9140052#9140052)

我建议您的子模块构建应该引发错误，而不是尝试复制日志解析逻辑。

# 更新

如果这是为了支持部署而设计的，也许您应该考虑一个 groovy 脚本？会更好地支持异常条件：

```
def ant = new AntBuilder()

scanner = ant.fileScanner {
    fileset(dir:".", includes:"test*/build.xml")
}

scanner.each { f ->
    try {
        ant.ant(antfile:f)
    }
    catch (e) {
        ant.mkdir(dir:"backup")
        ant.move(todir:"backup", file:f.parent) 
    }
} 
```

Groovy 具有出色的 ANT 集成，也可以嵌入到您的 ANT 构建中：

```
<target name="run">
    <taskdef name="groovy" classname="org.codehaus.groovy.ant.Groovy" classpathref="build.path"/>

    <fileset id="buildFiles" dir="." includes="test*/build.xml"/>

    <groovy>
        project.references.buildFiles.each { 
            def f = new File(it.toString())
            try {
                ant.ant(antfile:f)
            }
            catch(e) {
                ant.mkdir(dir:"backup")
                ant.move(todir:"backup", file:f.parent) 
            }
        }
    </groovy>
</target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:09:13.797

这些方面的东西可能是您正在寻找的东西：

```
<target name="compile" >

    <javac srcdir="${src.dir}" destdir="${class.dir}" />

</target >

<target name="copy" depends="compile" >

    <mkdir dir="${dest.dir}" />

    <copy todir="${dest.dir}" overwrite="true">

        <fileset dir="${class.dir}" includes="**" />

        <fileset dir="${src.dir}" includes="**" />

        ...

   </copy>

</target> 
```

# telerik - telerik RadSocialShare 控件无法读取受限页面的内容

> ID：10507627
> 
> 赞同：0
> 
> 时间：2012-05-08T22:47:35.440
> 
> 标签：telerik

我正在使用 RadSocialShare facebook 按钮在 facebook 上共享页面。用户应登录才能访问此页面。如果我使用此页面 URL 在 RadSocialShare 中共享，则 facebook 无法读取此页面中的内容，它会共享登录页面中的内容。有没有办法可以在 facebook/google+/twitter 等上分享受限页面的一些内容？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T15:09:32.180

你不能，Facebook 发送一个单独的请求来索引页面，因此这些隐藏的页面对它的爬虫来说是隐藏的。见这里：[http](http://www.telerik.com/help/aspnet-ajax/socialshare-controlling-content-for-facebook.html) ://www.telerik.com/help/aspnet-ajax/socialshare-controlling-content-for-facebook.html 。

# jquery - Google API 是否始终位于其各自的 URL 上？

> ID：10507628
> 
> 赞同：1
> 
> 时间：2012-05-08T22:47:37.977
> 
> 标签：jquery, ajax, google-api

我刚开始使用 googleapis.com，他们在其中托管 jquery 代码以供使用。我在用：

```
https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js 
```

现在我的问题是这些代码是否总是存在？或者它们是否曾经被删除，因为我计划使用上述脚本的来源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T22:52:00.170

它们总是在那里，您现在应该考虑使用 1.7.2 版！

数以百万计的网站从 Google API 获取 jQuery 文件，因此它们不会很快被删除，除非它们真的过时了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T23:09:08.023

对，他们是！

`Google`使用它`CDN (Content Delivery Network)`通过将文件移动到离您最近的服务器来帮助您以最快的方式获取库。

除了**速度非常快**之外，它还可以帮助您**保持更新**（在关键错误修复的情况下），还可以为您的网站**节省带宽**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T22:53:21.543

我在网站上使用完全相同的 jQuery 库源已经快一年多了。看起来很酷。

当然，谷歌可以做他们想做的事，所以如果你想确保下载文件......

# c# - BouncyCastle，生成 RSA 密钥对需要多长时间？

> ID：10507634
> 
> 赞同：2
> 
> 时间：2012-05-08T22:48:30.233
> 
> 标签：c#, vb.net, bouncycastle

我正在使用 Bouncy Castle（c#/vb.net 版本）并生成一个 4096 字节的 RSA 密钥对，以通过以下例程在我的证书中使用：

```
Public Shared Function GenerateRSAKeypair(keylength As Integer) As AsymmetricCipherKeyPair
    Dim r As New RsaKeyPairGenerator()
    r.Init(New KeyGenerationParameters(New SecureRandom(), keylength))
    Dim keys As AsymmetricCipherKeyPair = r.GenerateKeyPair()
    Return keys
End Function 
```

该过程可以正常工作，但是需要很长时间，最多一分钟（我使用的是 2.4ghz 奔腾 DualCore）。

由于我对 RSA 和所有这些事情没有太多经验（几乎没有），我只是想问一下生成密钥需要这么长时间是否正常，或者我做错了什么。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T16:40:23.190

在阅读了一些关于 RSA 的理论之后，我可以确认代码没有任何问题，生成这么大的密钥只需要很长时间。

# ruby-on-rails - 当我覆盖 ActiveRecord 模型的 getter 和 setter 时发生了奇怪的事情

> ID：10507635
> 
> 赞同：0
> 
> 时间：2012-05-08T22:48:36.407
> 
> 标签：ruby-on-rails, activerecord

我有一个`User`模型，其中包含手机号码。手机号码将以国际格式保存在数据库中。因为用户通常不知道这一点并且不喜欢国际格式，所以我更改了 getter 和 setter，以便用户能够以本地格式输入数字，并且如果没有国际前缀，他们会显示本地格式。

```
class User < ActiveRecord::Base
  def mobile=(number)
    # Strip whitespace, dashes and slashes first
    [" ", "-", "/", "\\"].each do |particle|
      number.gsub!(particle, "")
    end

    # Check if there is leading 00, this indicates a
    # country code.
    number.gsub!(/^00/,"+")

    # Check if there is only one leading zero. If there is,
    # treat as German number
    number.gsub!(/^0/,"+49")

    # Now write to attribute. Validate later.
    puts "Writing: #{number}"
    write_attribute(:mobile, number)
  end

  def mobile
    number = read_attribute(:mobile)
    puts "Reading: #{number}"

    # If this is a German number, display as local number.
    number.gsub!(/\+49/,"0")

    number
  end
end 
```

现在，这似乎并不像预期的那样工作。这是我的`rails console`会议：

```
> u = User.new(:mobile => "0163 12345")
Writing: +4916312345
 => #<User id: nil, mobile: "+4916312345", ...> 
```

这按预期工作。所以，让我们检查一下吸气剂：

```
> u.mobile
Reading: +4916312345
 => "016312345" 
```

看起来不错。但最好再检查一遍：

```
> u.mobile
Reading: 016312345
 => "016312345" 
```

怎么回事？我的属性变了。这仅限于getter函数吗？

```
> u
 => #<User id: nil, mobile: "016312345", ...> 
```

不，它甚至在数据库模型中设置属性。

如果我两次访问该属性，则该属性会更改。我没有访问`write_attribute`. 为什么我的属性会改变？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:06:29.913

考虑这个简化的例子：

```
class User
  def initialize
    @attributes = { :mobile => "+4916312345" }
  end
  def read_attribute name
    @attributes[name]
  end
end 
```

请注意，它`read_attribute`返回属性的值，而不是值的*副本*。

现在：

```
user = User.new
mobile = user.read_attribute :mobile
=> "+4916312345"
mobile.gsub!(/\+49/,"0")
=> "016312345"
mobile = user.read_attribute :mobile
=> "016312345"   # because we modified it in place with gsub! 
```

您需要做的就是使用`gsub`而不是`gsub!`在您的 getter 中，并且由于您永远不会`+49`在同一个字符串中多次替换，所以您最好使用`sub`.

```
def mobile
  number = read_attribute(:mobile)
  puts "Reading: #{number}"

  # If this is a German number, display as local number.
  number.sub(/\+49/,"0")
end 
```

# ruby-on-rails - 模块范围不对

> ID：10507644
> 
> 赞同：2
> 
> 时间：2012-05-08T22:49:28.720
> 
> 标签：ruby-on-rails, ruby

我试图通过将常用方法移动到模块或类中并将其包含/继承在不同模块下命名空间的新类中。如果我在同一个模块下有两个类命名空间，那么只要我在同一个命名空间下，我就可以在不包括模块名称的情况下调用它们。但是，如果我有一个从不同模块中包含的方法，而不是我的命名空间范围更改，我不知道为什么或如何避免它。

例如。此代码有效并返回“bar”：

```
module Foo
  class Bar
    def test_it
      Helper.new.foo
    end
  end
end

module Foo
  class Helper
    def foo
      'bar'
    end
  end
end

Foo::Bar.new.test_it 
```

但是如果我将方法 test_it 移到一个模块中，那么它就不再起作用了：NameError: uninitialized constant Mixins::A::Helper.

```
module Mixins; end

module Mixins::A
  def self.included(base)
    base.class_eval do
      def test_it
        Helper.new.foo
      end
    end
  end
end

module Foo
  class Bar
    include Mixins::A
  end
end

module Foo
  class Helper
    def foo
      'bar'
    end
  end
end

Foo::Bar.new.test_it 
```

此外，如果 class_eval 正在评估字符串而不是块，则范围变为 Foo::Bar 而不是 Foo。

```
module Mixins; end

module Mixins::A
  def self.included(base)
    base.class_eval %q{
      def test_it
        Helper.new.foo
      end
    }
  end
end

module Foo
  class Bar
    include Mixins::A
  end
end

module Foo
  class Helper
    def foo
      'bar'
    end
  end
end

Foo::Bar.new.test_it 
```

有人有想法吗？

编辑：

多亏了 Wizard 和 Alex，我最终得到了这段代码，它并不漂亮，但可以完成工作（*注意它使用的是 Rails helper constantize*）：

```
module Mixins; end

module Mixins::A
  def self.included(base)
    base.class_eval do
      def test_it
        _nesting::Helper
      end
      def _nesting
        @_nesting ||= self.class.name.split('::')[0..-2].join('::').constantize
      end
    end
  end
end

module Foo 
  class Helper
  end

  class Bar
    include Mixins::A
  end
end

module Foo2 
  class Helper
  end

  class Bar
    include Mixins::A
  end
end

Foo::Bar.new.test_it    #=> returns Foo::Helper
Foo2::Bar.new.test_it   #=> returns Foo2::Helper 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T15:01:53.823

要理解这个问题，您需要了解常量查找在 Ruby 中是如何工作的。它与方法查找不同。在这段代码中：

```
module Mixins::A
  def self.included(base)
    base.class_eval do
      def test_it
        Helper.new.foo
      end
    end
  end
end 
```

`Helper`指的是一个名为“Helper”的常量，它位于`A`、`Mixins`或在顶层（即 in `Object`）中定义，而*不是*定义在 中的称为“Helper”的常量`Bar`。仅仅因为你`class_eval`这个带有 class 的代码`Bar`，并没有改变它。如果您知道“词法绑定”和“动态绑定”之间的区别，那么您可以说 Ruby 中的常量解析使用*词法*绑定。您期望它使用动态绑定。

请记住，您传递给的块`base.class_eval`被编译为字节码*一次*，随后，每次`included`调用钩子时，相同的预编译块（包括对 的引用`Helper`）将使用不同的类（`base`）作为`self`. 每次执行时，解释器都不会重新解析和编译块`base.class_eval`。

另一方面，如果您将*String*传递给，则*每次*钩子运行时都会`class_eval`重新解析和编译该字符串。重要提示：从 String 编辑的代码在*null lexical environment*中进行评估。这意味着来自周围方法的局部变量*不可*用于从字符串编辑的代码。更重要的是，这也意味着周围的范围不会影响ed 代码中的持续查找。*`included``eval`**`eval``eval`***

 ***如果您确实希望动态解析常量引用，则显式常量引用将永远无法工作。这根本不是该语言的工作方式（并且有充分的理由）。想一想：如果常量引用是动态解析的，取决于 的类，`self`你永远无法预测对事物的引用是如何在运行时解析的。如果您在模块中有这样的代码......`Array``Hash`

```
hash = Hash[array.map { |x| ... }] 
```

...并且模块与嵌套类混合到一个类中`Hash`，`Hash.[]`将引用*嵌套类*而不是`Hash`标准库！显然，动态解析常量引用有太多的名称冲突和相关错误的可能性。

现在使用方法查找，这是另一回事。OOP 的整个概念（至少是 OOP 的 Ruby 风格）是方法调用（即消息）的作用取决于接收者的类。

如果您确实想动态查找常量，具体取决于接收器的类，您可以使用`self.class.const_get`. 这可以说比`eval`使用 String 来实现相同的效果更干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:09:40.393

```
module Mixins::A
  def self.included(base)
    base.class_eval do
      def test_it
        Foo::Helper.new.foo 
```

* * *

编辑：

在有机会玩弄代码之后，我发现了更多问题。我认为您无法完全按照您的尝试做，但这很接近：

```
module Mixins::A
  def self.included(base)
    base.class_eval do
      def test_it
        self.class.const_get(:Helper).new.foo
      end
    end
  end
end

module Foo
  class Bar
    include Mixins::A
  end
end

module Foo
  class Bar::Helper
    def foo
      'bar'
    end
  end
end 
```

请注意，由于在 Ruby 中解析常量的方式，Helper 类需要在 Foo::Bar 下命名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T16:22:33.990

在过去的几个主要版本中，Ruby 中的常量查找相对于#class_eval 发生了变化。有关更多信息，请参阅此帖子：http: [//jfire.posterous.com/constant-lookup-in-ruby](http://jfire.posterous.com/constant-lookup-in-ruby)***

# c# - 为什么一条线出错而另一条没有？

> ID：10507645
> 
> 赞同：-2
> 
> 时间：2012-05-08T22:49:32.770
> 
> 标签：c#, compiler-errors

我的问题真的很简单，但数小时的谷歌并没有为我（显然）独特的情况提供答案。问题是在以下代码中使用了未分配的变量

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SimpleBasicCompiler
{
    class Lines : System.Collections.IEnumerable
    {
        // Variables
        private ArrayList<string> lines;

        // Constructor
        public Lines()
        {
            lines = new ArrayList();
        }

        public void Add(string line)
        {
            lines.add(line);
        }

        // Iterator
        public System.Collections.IEnumerator GetEnumerator()
        {
            for (int i = 0; i < lines.length(); i++)
            {
                yield return lines[i];
            }
        }

        public void Print()
        {
            foreach (string line in lines)
            {
               XFormMain.SetStatus(line); // this line errors
               System.Console.Write(line); // this line dosn't
            }
        }

    } // End Class Lines
} // End namespace 
```

我的问题是为什么？我无法更改声明或它使迭代器语法无效我什至尝试了以下

```
public void Print()
    {
        string lineB = "";
        foreach (string line in lines)
        {
           lineB = line; // now this line errors
           XFormMain.SetStatus(lineb); // and this line doesn't
           System.Console.Write(line); // this line doesn't in either situation
        }
    } 
```

我想如果我知道为什么一条线有效而一条线我不能弄清楚但是......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:03:04.580

您发布的代码存在严重问题（即使没有该`Print`方法，也无法编译）。不`ArrayList<T>`存在类。我认为应该是`List<string>`这样。我还没有见过合适的用法`ArrayList`。

你得到的错误可能是因为`ArrayList`它没有类型（这使得它成为一个糟糕的列表实现），但你却在向它询问字符串。编译器知道它可能包含任意对象，它会阻止您假设它只有字符串。

我想第二行没有出错的原因是因为编译器在遇到第一个错误时停止了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:20:19.070

这编译：

```
 class Lines : System.Collections.IEnumerable {
        // Variables
        private ArrayList lines;

        // Constructor
        public Lines() {
            lines = new ArrayList();
        }

        public void Add(string line) {
            lines.Add(line);
        }

        // Iterator
        public System.Collections.IEnumerator GetEnumerator() {
            for (int i = 0; i < lines.Count; i++) {
                yield return lines[i];
            }
        }

        public void Print() {
            string lineB = "";
            foreach (string line in lines)
            {
               lineB = line;
//               XFormMain.SetStatus(lineb);
               System.Console.Write(line); 
            }
        }
    } 
```

有几个问题：

ArrayList 在 System.Collections，而不是 System.Collections.Generic

ArrayList 不是泛型，所以`ArrayList<string>`不正确

ArrayList.add 不存在

ArrayList.length() 不存在

这是一个可能有帮助的建议。先编写一点代码，然后看看它是否可以编译。从空的类声明开始。如果您的类是从另一个类派生的，则添加下一个，并存根基类或接口所需的任何方法以使其编译。一次添加一个方法的内部结构，并在完成每个方法时进行编译。经常像这样编译将避免由代码中的多个错误引起的奇怪问题。它还会阻止您及早进入错误的轨道，例如将 ArrayList 用作泛型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T22:58:44.280

尝试这个：

```
foreach (string line in lines.ToArray(typeof(string)))         
{ 
```

# php - PHP - 如何从内容块中检索和处理所有图像及其父锚标记？

> ID：10507646
> 
> 赞同：1
> 
> 时间：2012-05-08T22:49:36.467
> 
> 标签：php, regex, image, xpath, anchor

*注意：我使用的是 Wordpress，但我认为它与答案无关，所以我在 SO 上问过它。如果我错了，请告诉我/移动问题。*

好的，我正在加载丰富的内容块（通过 Wordpress），这些内容经常包含许多包装在锚标签中的图像。我想逐步浏览所有这些，以便将它们显示为`a`带有相关`img`s 的标签。

我[已经找到](http://www.snilesh.com/resources/wordpress/extract-images-from-wordpress-post/)了这个方便的正则表达式驱动的代码，它让我的图像非常好：

```
 // Get the all post content in a variable
            $posttext = $post->post_content;
            //$posttext1 = get_cleaned_excerpt();

            // We will search for the src="" in the post content
            $regular_expression = '~src="[^"]*"~';
            $regular_expression1 = '~<img [^\>]*\ />~';

            // WE will grab all the images from the post in an array $allpics using preg_match_all
            preg_match_all( $regular_expression, $posttext, $allpics );

            // Count the number of images found.
            $NumberOfPics = count($allpics[0]);

            // This time we replace/remove the images from the content
             $only_post_text = preg_replace( $regular_expression1, '' , $posttext1);
            /*Only text will be printed*/

            // Check to see if we have at least 1 image
            if ( $NumberOfPics > 0 )
            {

            $this_post_id = get_the_ID();

            for ( $i=0; $i < $NumberOfPics ; $i++ )
            {           $str1=$allpics[0][$i];
            $str1=trim($str1);
            $len=strlen($str1);
            $imgpath=substr_replace(substr($str1,5,$len),"",-1);

            $theImageSrc = $imgpath;
            global $blog_id;
            if (isset($blog_id) && $blog_id > 0) {
                $imageParts = explode('/files/', $theImageSrc);
                if (isset($imageParts[1])) {
                    $theImageSrc = '/blogs.dir/' . $blog_id . '/files/' . $imageParts[1];
                }
    }

            ?>

            <img class="alignleft" src='<?php echo get_bloginfo('template_directory').'/timthumb.php?src=' . $theImageSrc  . '&h=150&w=150'; ?>' height="150" width="150" alt=""/> 
```

我真的很想`img`用相关的 parent包裹那个底部`a`。在这里的任何帮助将不胜感激。

要搜索的内容示例可能是：

```
 <h5>
    <a href="http://www.example.com/imagefoo.jpg">
        <img class="size-thumbnail wp-image-4091 alignleft" src="http://www.example.com/imagefoo-150x150.jpg" alt="" width="150" height="150" />
    </a>
</h5>
<h5>
    <a href="http://www.example.com/Image-Bar.jpg">
        <img class="wp-image-4087 alignleft" title="Image - Bar" src="http://www.example.com/Image-Bar-150x150.jpg" alt="" width="150" height="150" />
    </a>
</h5>
<h5>
    <a href="http://www.example.com/Image-Alphe.jpg">
        <img class="wp-image-4090 alignleft" title="Image-Alpha" src="http://www.example.com/Image-Alpha-150x150.jpg" alt="" width="150" height="150" />
    </a>
</h5>
    <a href="http://www.example.com/EXAMPLE-image-150.jpg"><img class="size-thumbnail wp-image-4088 alignleft" title="EXAMPLE-image-150" src="http://www.example.com/EXAMPLE-image-150-150x150.jpg" alt="" width="150" height="150" /></a>
<h5>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</h5>

<a href="http://www.example.com/insanely-long-permalink-created-as-if-by-a-madman-who-knows-no-bounds-of-shame/" rel="attachment wp-att-2780">
    <img class="alignright size-thumbnail wp-image-2780" title="Exhibition Title: Image Name by Artist Person" src="http://www.example.com/wp-content/uploads/2011/12/ExtraordinaryImage-150x150.jpg" alt="Example UK | Exhibition: Image by Artist Person" width="150" height="150" />
</a>
Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. 
```

**编辑：**这是根据我的需要的工作代码。它使用 XPath，基于下面 cHao 的回答。（对于它的价值，我发现[Tizag 的网页](http://www.tizag.com/xmlTutorial/xpathtutorial.php)作为 XPath 入门非常有用，旁边还有[这个 EarthInfo 页面](http://www.earthinfo.org/xpaths-with-php-by-example/)。）：

```
 // Get the all post content in a variable
            $posttext = $post->post_content;

            $document = DOMDocument::loadHTML($posttext);
            $xpath = new DOMXPath($document);
             $i = 0;
            # for each link that has an image inside it, set its href equal to
            # the image's src.
            foreach ($xpath->query('//a/img/..') as $link) :

                $img = $link->getElementsByTagName('img')->item(0);
                $link_src = $link->getAttribute('href');
                $link_title = $link->getAttribute('title');
                $img_src = $img->getAttribute('src');

                $theImageSrc = $img_src;
                global $blog_id;
                if (isset($blog_id) && $blog_id > 0) {
                    $imageParts = explode('/files/', $theImageSrc);
                    if (isset($imageParts[1])) {
                        $theImageSrc = '/blogs.dir/' . $blog_id . '/files/' . $imageParts[1];
                    }
                }

                ?>

                <a href="<?php echo $link_src; ?>" rel="lightbox[<?php echo $this_post_id; ?>]" title="<?php if ($link_title) {
                    echo $link_title;
                } else { the_title(); } ?>" class="cboxElement">
                <img class="alignleft" src='<?php echo get_bloginfo('template_directory').'/timthumb.php?src=' . $theImageSrc  . '&h=150&w=150'; ?>' height="150" width="150" alt=""/>
            </a>

            <?php

            endforeach;

            ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:10:06.867

您最好不要尝试使用正则表达式来查找图像。他们在解析 HTML 方面很糟糕。

相反，请查看 DOMDocument 和 DOMXPath 类。

```
$document = DOMDocument::loadHTML($posttext);
$xpath = new DOMXPath($document);

# for each link that has an image inside it, set its href equal to
# the image's src.
foreach ($xpath->query('//a[/img]') as $link) {
    $img = $link->getElementsByTagName('img')->item(0);
    $src = $img->getAttribute('src');

    # do your mangling of $src here, resulting in $href.
    # for example...
    $href = preg_replace('/-\d+x\d+(?=\.[^.]*$)/', '', $src);

    $link->setAttribute('href', $href);
}

$fixed_html = $document->saveHTML(); 
```

# android - 通过“名单 objectKeypoints" 对象到向量 在本机代码中

> ID：10507647
> 
> 赞同：0
> 
> 时间：2012-05-08T22:49:44.680
> 
> 标签：android, opencv, java-native-interface, feature-detection

我目前正在开发一个android应用程序。在 java 方面，我将 a 传递`List<KeyPoint> objectKeypoints`给本机代码。但是我怎样才能将本机端的这个作业转换`Vector<Keypoint> objectKeypoints`为进一步处理。

示例：Java 端我的调用方法：

```
List<KeyPoint> objKeypoints;
Mat mGrayMat = ;// is not empty;
FeatureDetector featureDetector = FeatureDetector.create(FeatureDetector.SURF);
featureDetector.detect(obj_keypoints, mGrayMat);

FindObject(objKeypoints,mGrayMat ); 
```

本机端 C++ 代码；

```
JNIEXPORT void JNICALL Java_my_app_AndroidAppView_FindObject(JNIEnv* env, jobject obj, jobject obj_keypoints, jlong matAddrObjGray){
// How to convert obj_keypoints to Vector<KeyPoint>?
Vector<KeyPoint> objectKeypoints = ....;
Next Step is calculating the descriptors for the Keypoints.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:57:58.187

你不能，除非它真的是一个向量。如果接口只指定列表，则应将其作为列表处理。如果需要 Vector，请将接口更改为需要 Vector。

你也可以从列表中构建一个新的向量，但它看起来毫无意义地昂贵。

# pagination - 推动嵌套集与分页相结合

> ID：10507655
> 
> 赞同：0
> 
> 时间：2012-05-08T22:50:37.277
> 
> 标签：pagination, propel, nested-sets

```
$root = AnimeCommentQuery::create()->findRoot(2);
$html = "<ul>{$root->getComment()}";

foreach ($root->getDescendants() as $post)
{
  $html .= '<li style="padding-left: '.$post->getLevel().' em;">';
  $html .= $post->getComment();
  $html .= ' by '.$post->getIbfMembersRelatedByInsertBy()->getName();
  $html .= "</li>";
}

$html .= "</ul>";
echo $html; 
```

我想对帖子进行分页，但我无法通过以下方式执行此操作：

```
$root = AnimeCommentQuery::create()->findRoot(2)->paginate(2, 1); 
```

或者

```
$root = AnimeCommentQuery::create()->paginate(2, 1)->findRoot(2); 
```

可以使用 propel 的标准分页来完成吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T11:25:50.520

不知道会不会太晚了......

首先，您不能在同一个查询中使用分页和查找，它们都是终止方法。

我认为你需要的是这样的：

```
$comments = AnimeCommentQuery::create()->inTree(2)->orderByBranch()->paginate(2,1); 
```

然后`foreach`通过你的方式`Collection`。

现在你必须在何时关闭和打开列表、检查当前级别等方面有点聪明。页面 2+ 的顶部和底部也会考虑一些因素。祝你好运！

嵌套集 API 值得进一步研究[http://www.propelorm.org/behaviors/nested-set.html#complete_api](http://www.propelorm.org/behaviors/nested-set.html#complete_api)，得到了相当多的了解。

还可以考虑使用 a`->joinWith()`在`getIbfMembersRelatedByInsertBy()`主查询中预先填充。

# android - Maven / Android：从父项目调用子模块上的自定义目标

> ID：10507656
> 
> 赞同：0
> 
> 时间：2012-05-08T22:50:41.480
> 
> 标签：android, maven, build, multi-module

我有一个包含三个子模块的 Maven 聚合（父）项目。其中一个模块是可以部署到设备模拟器的 Android 项目。我希望能够从我的顶级父项目运行“mvn clean install android:deploy android:run”并让它在所有子模块和“mvn android:deploy android:run”上运行“mvn clean install”仅在我的 Android 模块上。我需要能够从一行运行所有 maven 命令，以便与持续集成套件集成。

有没有办法做到这一点（在我的 POM 文件中使用特殊配置或通过传递特定的命令行参数）？

我尝试按照此处的说明进行操作：[Maven profile for single module](https://stackoverflow.com/questions/2400984/maven-profile-for-single-module)。我设置了两个配置文件（一个包含所有模块，一个只包含我的 Android 模块）并运行类似 'mvn -Pall clean install -Pandroid android:deploy android:run' 但 Maven 无法解析不同的配置文件参数目标。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:24:24.103

### 有没有办法做到这一点（在我的 POM 文件中使用特殊配置或通过传递特定的命令行参数）？

有点，假设您在这里使用 maven 配置文件，您可以将两个 mvn 命令放在一行中，第二个命令将在第一个命令完成后启动。

在 Linux 中，使用：

```
mvn -Pall clean install ; mvn -Pandroid android:deploy android:run 
```

在 Windows 中，使用：

```
mvn -Pall clean install & mvn -Pandroid android:deploy android:run 
```

希望这可以帮助。

# ruby-on-rails-3 - created_at 的猴子补丁

> ID：10507660
> 
> 赞同：1
> 
> 时间：2012-05-08T22:51:08.983
> 
> 标签：ruby-on-rails-3, monkeypatching

我正在尝试编写一个猴子补丁来为 created_at 添加一个方法。

我创建了一个 date_time_extras.rb 文件并将其放在`lib`目录中，内容如下：

```
class DateTime
  def beginning_of_hour
    change(:min => 0)
  end
end 
```

从控制台我做：

```
record.created_at.beginning_of_hour 
```

但这会产生方法丢失错误。看起来 created_at 不是日期时间？因为`DateTime.new.beginning_of_hour`有效，并且`record.created_at.class`产量`ActiveSupport::TimeWithZone`。

那么如何为 created_at 类型的日期编写猴子补丁呢？

我正在使用 Rails 版本 3.0.10。

**更新**

也试过

```
module ActiveSupport
  class TimeWithZone
    def beginning_of_hour
      change(:min => 0)
    end
  end
end 
```

无济于事

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:58:47.377

您是否尝试在其中声明它`class Time`？

```
class DateTime
  def beginning_of_hour
    change(:min => 0)
  end
end 
```

`TimeWithZone`看起来它将其 time 对象委托给`Time`not `DateTime`。

还`TimeWithZone`包含不仅仅是`@time`对象，所以你必须做类似的事情

```
module ActiveSupport
  class TimeWithZone
    def beginning_of_hour
      self.time.change(:min => 0)
    end
  end
end 
```

但我不是 100% 确定该代码。

# facebook - 获取 facebook 用户访问令牌/PHP SDK 3.1.1

> ID：10507661
> 
> 赞同：0
> 
> 时间：2012-05-08T22:51:10.030
> 
> 标签：facebook, facebook-graph-api

由于本文没有回答问题（[如何获取用户访问令牌？](https://stackoverflow.com/questions/7856441/how-to-get-user-access-token)），我想问一下如何获取用户访问令牌。

我已经有了我的应用访问令牌，很简单。我还在最新的 php sdk Base_facebook 类中看到了一个 getUserAccesstoken 函数，但它没用，因为最后你只获得了应用程序访问令牌。

这是我的身份验证流程：用户进入粉丝专页应用程序，在某些时候，他必须授权权限：

```
$facebook = new Facebook(array(
    'appId' => $app_id,
    'secret' => $secret,
    'cookie' => true
));

$user = $facebook->getUser(); 

if($user == 0) {

  $login_url = $facebook->getLoginUrl($params = array('scope' => "publish_stream", 'redirect_uri' => "https://www.facebook.com/pages/PAGENAME/PAGE-ID?sk=app_APP-ID0&app_data=af"));

echo ("<script> top.location.href='".$login_url."'</script>");
} 
```

这很好，app_data“af”参数设置为取回粉丝页面应用程序中的页面。

因为我意识到，当我删除应用程序并返回身份验证页面时，用户 cookie ($user) 仍然设置，因此不会再次询问用户权限。

出于这个原因，我也想检查权限，因此我需要用户访问令牌

```
 try{
        $permissions = $facebook->api("/me/permissions", 'GET', array('access_token' => "$access_token" ));
    }
    catch (Exception $e) {echo ("<script> top.location.href='".$login_url."'</script>"); }

    if( array_key_exists('publish_stream', $permissions['data'][0]) ) {
        // Permission is granted!

    } else {
        echo ("<script> top.location.href='".$login_url."'</script>");
    } 
```

所以我尝试了服务器端身份验证示例（[https://developers.facebook.com/docs/authentication/server-side/](https://developers.facebook.com/docs/authentication/server-side/)），但是当然这在这里不起作用，因为您无法从内部读取 $_REQUEST应用程序，所以我会卡在这里。- 你们如何检查应用程序内的权限？

```
 $app_id = "YOUR_APP_ID";
   $app_secret = "YOUR_APP_SECRET";
   $my_url = "YOUR_URL";

   session_start();
   $code = $_REQUEST["code"];

   if(empty($code)) {
     $_SESSION['state'] = md5(uniqid(rand(), TRUE)); //CSRF protection
     $dialog_url = "https://www.facebook.com/dialog/oauth?client_id=" 
       . $app_id . "&redirect_uri=" . urlencode($my_url) . "&state="
       . $_SESSION['state'];

     echo("<script> top.location.href='" . $dialog_url . "'</script>");
   }

   if($_REQUEST['state'] == $_SESSION['state']) {
     $token_url = "https://graph.facebook.com/oauth/access_token?"
       . "client_id=" . $app_id . "&redirect_uri=" . urlencode($my_url)
       . "&client_secret=" . $app_secret . "&code=" . $code;

     $response = file_get_contents($token_url);
     $params = null;
     parse_str($response, $params);

     $graph_url = "https://graph.facebook.com/me?access_token=" 
       . $params['access_token'];

     $user = json_decode(file_get_contents($graph_url));
     echo("Hello " . $user->name);
   }
   else {
     echo("The state does not match. You may be a victim of CSRF.");
   } 
```

TIA 和欢呼，丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:19:00.397

请参阅 Facebook 开发人员文档中有关服务器端身份验证的部分：[https ://developers.facebook.com/docs/authentication/server-side/](https://developers.facebook.com/docs/authentication/server-side/)

或者您可以使用混合客户端-服务器身份验证：http: [//developers.facebook.com/blog/post/534/](http://developers.facebook.com/blog/post/534/)

# java - Safari 不显示框架内容

> ID：10507663
> 
> 赞同：0
> 
> 时间：2012-05-08T22:51:19.807
> 
> 标签：java, javascript, safari, frames

我正在使用以下 Java 代码动态生成写入帧的 JavaScript。它在 Firefox 中运行良好，但在 Safari 中它显示一个空白区域并且没有错误。

代码：

```
js.append("parent.window.dialog.$renderControls();\n");
            js.append("var doc = parent.frames[1].document;\n");
            js.append("doc.open('text/html','replace');\n");
            js.append("alert('test10');\n");
            js.append("if(!doc){\n");
            js.append("alert('no doc');\n");
            js.append("}\n");
            js.append("debugger;\n");
            js.append("doc.write('Hi There');\n");
            js.append("doc.close();\n"); 
```

# ajax - JSF 2.0：按 ENTER 时的 ajax 请求

> ID：10507664
> 
> 赞同：10
> 
> 时间：2012-05-08T22:51:23.463
> 
> 标签：ajax, jsf

当我在 inputText 字段中单击“输入”时，我需要执行 ajax 请求，而无需刷新页面。那是我的代码：

```
<h:form id="form-test">
   <p:growl id="messages" showDetail="true"/>
   <p:inputText id="inputEnter" 
             onkeypress="if (event.keyCode == 13) {onchange(); return false; }" 
             value="#{bean.content}">
       <f:ajax event="change" listener="#{bean.save}" update="messages"/>
   </p:inputText>
</h:form> 
```

在bean中我有一个简单的方法：

```
public void save(AjaxBehaviorEvent event){
  ...
} 
```

一切正常，但它刷新页面！为什么 ？我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T11:32:44.757

已经有一个与您的问题类似的线程[如何处理按下 ENTER 键以触发 onBlur() 事件？](https://stackoverflow.com/questions/6548176/how-to-handle-the-enter-keypressed-to-trigger-an-onblur-event)

我只想改变

```
onkeypress="if (event.keyCode == 13) {e.preventDefault();
inputEnter.onchange(); return false; }" 
```

如果你使用 JQuery

```
$('#form-test\\:inputEnter').onchange(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-20T10:03:26.390

我认为您需要输入 render param ，因此它不会再次渲染整个页面。

```
<h:form id="form-test">
   <p:growl id="messages" showDetail="true"/>
   <p:inputText id="inputEnter" 
             onkeypress="if (event.keyCode == 13) {onchange(); return false; }" 
             value="#{bean.content}">
       <f:ajax event="change" render="messages" listener="#{bean.save}" update="messages"/>
   </p:inputText>
</h:form> 
```

# asp.net-mvc - 从 IIS ASP.NET 应用程序读取 pst (Outlook) 文件

> ID：10507665
> 
> 赞同：0
> 
> 时间：2012-05-08T22:51:25.187
> 
> 标签：asp.net-mvc, iis, outlook, pst

我必须创建一种基于 .PST 文件的 Web 邮件。

我需要从用户提供的 PST 文件中读取所有 MailItems、文件夹、联系人和所有内容。

我目前正在使用 DCOM 互操作来创建一个应用程序并使用 Session 添加我的文件存储。

我的问题是我什至无法实例化 Outlook.Application，代码根本无法运行。

如果我更改为 Visual Studio Development Web Server，一切都按预期工作，但如果我更改为本地 IIS Web Server .. 没有任何反应 =/

到目前为止我做了什么：

*   在 web.config 上设置用户名并传递模拟
*   设置用户名并通过 iis -> 身份验证 -> ASP.NET 模拟在我的网站上进行模拟
*   添加了对所有人、网络服务、IIS_IUSRS、我在临时 asp 文件中的用户帐户、网站文件和 pst 文件的权限，我正在尝试读取

不幸的是，我已经使用 TDD 实现了我需要的所有东西，所以改变我这样做的方式并不是一个好主意，比如迁移到 NMapi 之类的。

提前致谢

**编辑：**

正如我之前提到的，我不能使用另一个库（那个库似乎可以工作，但它非常昂贵）。

我只需要它在本地服务器上运行。它是一个 Web 应用程序，但仅适用于 localhost。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T08:40:48.057

在服务器端使用 Outlook 不是一个好主意，如下所述：http: [//support.microsoft.com/kb/257757](http://support.microsoft.com/kb/257757)

> Microsoft 目前不推荐也不支持任何无人值守、非交互式客户端应用程序或组件（包括 ASP、ASP.NET、DCOM 和 NT 服务）的 Microsoft Office 应用程序自动化，因为 Office 可能表现出不稳定的行为和/或在此环境中运行 Office 时出现死锁。

也许看看[http://www.independentsoft.de/pst/](http://www.independentsoft.de/pst/)

# jquery - jquery-mobile 收音机被选中但不显示

> ID：10507683
> 
> 赞同：1
> 
> 时间：2012-05-08T22:54:03.377
> 
> 标签：jquery, jquery-mobile

Javascript 决定在页面加载时检查哪个按钮。代码成功检测到这一点，但未显示“已检查”按钮。

我已将 .checkboxradio("refresh") 添加到单选组和单个单选按钮，但无济于事。演示在这里：http: [//jsfiddle.net/mckennatim/a9jx9/](http://jsfiddle.net/mckennatim/a9jx9/)

.button("refresh") 导致错误。

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tax</title> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.css" />
    <link href="css/tax.css" rel="stylesheet" type="text/css" />
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.js"></script>  
</head>
<body>
<div id="page2" data-role="page"  data-add-back-btn="true">
    <div data-role="content">
        <div id="proCG">
            <fieldset data-role="controlgroup" data-mini="true">
                <legend>Tax Capital Gains </legend>
                <input type="radio" name="choProCG" id="radProCG1" value="1" />
                <label for="radProCG1">as ordinary income</label>
                <input type="radio" name="choProCG" id="radProCG2" value="0" />
                <label for="radProCG2">at a separate rate</label>
            </fieldset>
        </div>
        <div id="txthere"></div>
    </div>
</div>      
</body>
</html> 

<script>
$('#page2').live('pageinit', function(event) {    
    console.log('here');
    $("#radProCG2").prop("checked", true).checkboxradio("refresh");
    $('input[name=choProCG]').checkboxradio("refresh");
    $('#txthere').append('duck');
    $('#txthere').append($('input[name=choProCG]:checked').val());
    $('input[name=choProCG]').change( function(e){
        $('#txthere').append(this.value);
        $('#txthere').append('frog');

    }); 
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T09:51:37.467

试试这个[http://jsfiddle.net/CGpGD/2/](http://jsfiddle.net/CGpGD/2/)

或者

下面的代码

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tax</title> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.css" />
    <link href="css/tax.css" rel="stylesheet" type="text/css" />
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.js"></script>  
</head>
<body>
<div id="page2" data-role="page"  data-add-back-btn="true">
    <div data-role="content">
        <div id="proCG">
            <fieldset data-role="controlgroup" data-mini="true">
                <legend>Tax Capital Gains </legend>
                <input type="radio" name="choProCG" id="radProCG1" value="1" />
                <label for="radProCG1">as ordinary income</label>
                <input type="radio" name="choProCG" id="radProCG2" value="0" />
                <label for="radProCG2">at a separate rate</label>
            </fieldset>
        </div>
        <div id="txthere"></div>
    </div>
</div>      
</body>
</html> 

<script>

$('#page2').live('pageinit', function(event) {  

    console.log('here');
    $("#radProCG2").attr("checked", true).checkboxradio("refresh");
    $('input[name=choProCG]').checkboxradio("refresh");
    $('#txthere').append('duck');
    $('#txthere').append($('input[name=choProCG]:checked').val());
    $('input[name=choProCG]').change( function(e){
        $('#txthere').append(this.value);
        $('#txthere').append('frog');

    }); 
});
</script>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T05:46:15.683

在 html 中尝试此代码..

```
<div data-role="fieldcontain">
    <fieldset data-role="controlgroup">
        <legend>Choose a pet:</legend>
            <input type="radio" name="radio-choice-1" id="radio-choice-1" value="choice-1" checked="checked" />
            <label for="radio-choice-1">Cat</label>

            <input type="radio" name="radio-choice-1" id="radio-choice-2" value="choice-2"  />
            <label for="radio-choice-2">Dog</label>

            <input type="radio" name="radio-choice-1" id="radio-choice-3" value="choice-3"  />
            <label for="radio-choice-3">Hamster</label>

            <input type="radio" name="radio-choice-1" id="radio-choice-4" value="choice-4"  />
            <label for="radio-choice-4">Lizard</label>
    </fieldset>
</div> 
```

# iphone - 来自 NSString 的 html 加载

> ID：10507687
> 
> 赞同：0
> 
> 时间：2012-05-08T22:54:26.097
> 
> 标签：iphone, objective-c, ios

来自 NSString 的 html 加载。

我有以下问题：我得到了 html 代码，想得到一个 webView 只是不知道如何做和搜索，如果有人愿意告诉我你是怎么做的，或者会欣赏任何例子，还没有找到例子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T23:10:50.030

```
UIWebView* newWebView = [[UIWebView alloc] initWithFrame:CGRectMake(x,y,width,height)];
[newWebView loadHTMLString:htmlString baseURL:[NSURL URLWithString:urlString]];
[self.view addSubview:newWebView];
[newWebView release]; 
```

# python - python固定字符串大小

> ID：10507688
> 
> 赞同：3
> 
> 时间：2012-05-08T22:54:30.073
> 
> 标签：python, string

假设我需要一个*长*的元素，每个元素用空格分隔。此外，我需要第*i 个*元素为 a `1`，其余元素为 a `0`。最简单的pythonic方法是什么？

因此`n = 10`，如果 和`i = 2`，我想要 `0 1 0 0 0 0 0 0 0 0`

我想要一个`new string[]`你可以在 C++ 中获得的东西，但是 Python 版本让我望而却步。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T22:57:36.620

使用列表。

```
n = 10
i = 2

mylist = ["0"] * n
mylist[i-1] = "1"
print " ".join(mylist) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T23:04:31.267

以下 Python 生成器表达式应生成您要查找的内容：

```
" ".join("1" if i == (x+1) else "0" for x in range(n)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T23:16:42.837

Python REPL 中的以下示例应该对您有所帮助。Python 生成器表达式`" ".join(bin((1<<n)+(1<<n>>i))[3:])`应该是一个解决方案。

```
>>> n=10
>>> i=2
>>> " ".join(bin((1<<n)+(1<<n>>i))[3:])
'0 1 0 0 0 0 0 0 0 0' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T23:05:43.953

这看起来像家庭作业，所以我将用英语而不是 Python 来描述我的答案。

使用列表推导创建`n`字符串列表，从`'1'`（如果项目的索引是`i`）和`'0'`（否则）中选择每个元素。将列表的元素连接起来，并在它们之间留一个空格。

您可以通过多种方式根据布尔值从两个项目中进行选择。其中一个是将两个项目放在一个序列中，并用布尔值索引序列，从而选择第一个元素 if`False`和第二个元素 if `True`。在这种特殊情况下，您还可以将布尔值转换为`'0'`或`'1'`以多种方式（例如先转换为整数，然后再转换为字符串）。

我不明白`new string[]`评论——那不是 C++ 语法。

**编辑**

这是Python：

```
' '.join([('0', '1')[x == i - 1] for x in range(n)]) 
```

或者

```
' '.join([str(int(x == i - 1)) for x in range(n)]) 
```

我更喜欢前者——很明显它会生成零和一，并且可以轻松地将它们更改为其他内容。它`i - 1`不是`i`针对`i`从一开始和`x`从零开始进行调整。通常情况下，我不会那样做。在所有条件相同的情况下，我更喜欢始终使用从零开始的索引，除非输入和输出格式需要从一开始的值。在这种情况下，我会尽快转换输入并尽可能晚地转换输出，并且绝对避免将两者混合在同一段代码中。

您可以安全地删除方括号，将列表推导转换为生成器推导。对于大多数意图和目的，它们的工作方式相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T23:07:42.387

只需使用“+”连接字符串：

```
("0 "*i + "1 " + "0 "*(n-i-1))[:-1] 
```

或者你也可以使用字节数组：

```
a = bytearray(("0 "*n)[:-1])
a[i*2] = "1"
print str(a) 
```

# asp.net - 关于网格控制

> ID：10507691
> 
> 赞同：0
> 
> 时间：2012-05-08T22:54:50.433
> 
> 标签：asp.net, grid, paging, obout

更改网格上的页面后，我在使用 Obout 网格控件时遇到问题。例如，测试可从其站点 (aspnet_grouping_initial.aspx) 下载的示例之一，如果您更改网格上的页面，则无法再展开/折叠分组。

如果您在更改页面后尝试执行任何操作，则在所有网格示例中都存在相同的问题。

有没有人想出如何解决这个问题？

请注意，它在他们的网站上有效，但在您可以下载的代码示例中无效。

我已经通过电子邮件发送了他们的支持，但没有回复。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T13:12:14.080

我无法重现此问题。“aspnet_grouping_initial.aspx”示例没有问题，如果您更改页面或页面大小，您仍然可以展开/折叠组或执行其他操作（排序等）。没有其他人报告过这样的问题，所以这可能是由于您的某些原因造成的。你测试的是什么浏览器？导航到网格中的不同页面后，您是否在客户端收到任何错误？所有资源（脚本、样式表、图像）是否在浏览器中正确加载？

# android - 如何在android的webview中调试javascript

> ID：10507693
> 
> 赞同：36
> 
> 时间：2012-05-08T22:55:03.353
> 
> 标签：android, ios, debugging, webview

我有一个在 iOS 上运行良好但在 Android 上运行良好的 webview。有没有一种工具可以让我在浏览器中连接到 Android webview 并使用 firefox 或 webkit 控制台对其进行调试？目前我不知道是什么导致 webview 在 Android 中不起作用。

在 iOS 中，我可以打开我的 iPad 或 iPhone 模拟器，打开 webview 窗格，然后在我的桌面浏览器中监听端口 9999，它向我展示了你在 webkit 开发工具/调试工具中看到的工具。

我正在为 Android 寻找类似的工具，或者至少让我开始调试。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2016-05-31T21:19:27.220

调试 WebView 最简单的方法是通过 USB 将您的 Android 设备连接到 PC，并使用 Chrome 开发工具检查您的 WebView。

因此，您将需要：

**1)**在我们的设备上激活 USB 调试。你可以找到它`Settings >> Developer Options >> Debugging >> USB Debugging`（激活复选框）

**2)**通过 USB 将您的设备连接到计算机

注意：如果您在 Windows 上进行开发，请为您的设备安装适当的 USB 驱动程序。请参阅Android 开发者网站上的[OEM USB 驱动程序。](https://developer.android.com/studio/run/oem-usb.html)

**3)**打开 Chrome 浏览器并在 URL 字段中输入：`chrome://inspect/#devices`

**4)**确认“发现 USB 设备”已激活

**5)**在您的设备上，警报会提示您允许从您的计算机进行 USB 调试。点击确定。

**6)**在 chrome://inspect 页面上显示每个连接的设备。单击`inspect`连接的设备，您将获得控制台。

更详细的手册是[**Debugging Android WebView**](https://developer.chrome.com/devtools/docs/remote-debugging#debugging-webviews)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-12T01:00:48.943

签出[weinre](http://people.apache.org/~pmuellr/weinre/docs/latest/)。它提供了类似于 Chrome 开发人员的工具，用于从 WebKit 浏览器调试到在远程设备上运行的浏览器。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-01-08T23:48:14.960

如果您**不使用 Android 4.4**，根据[http://developer.android.com/guide/webapps/debugging.html](http://developer.android.com/guide/webapps/debugging.html)，您将享受老式的调试方式......

> 如果您没有运行 Android 4.4 或更高版本的设备，您可以使用控制台 JavaScript API 调试您的 JavaScript 并查看输出到 logcat 的消息。

**对于 Android 4.4 及更高版本**，您将享受远程调试，请参阅[https://developers.google.com/chrome-developer-tools/docs/remote-debugging#debugging-webviews](https://developers.google.com/chrome-developer-tools/docs/remote-debugging#debugging-webviews)

> 从 Android 4.4 (KitKat) 开始，您可以使用 DevTools 在原生 Android 应用程序中调试 Android WebViews 的内容。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-07-14T10:31:39.227

这些是我用来调试`WebView`设备中内容的步骤：

1.  在您的设备中启用开发者模式
2.  将设备插入PC并启用USB调试（如果需要安装驱动程序）
3.  `Application`在您的自定义类或`Activity`加载 web 视图的位置添加此行

    ```
    //if your build is in debug mode, enable webviews inspection
    WebView.setWebContentsDebuggingEnabled(BuildConfig.DEBUG); 
    ```

4.  打开 Chrome 并转到`chrome://inspect`，您应该会在远程目标列表中看到您的设备

5.  从 Android Studio 开始调试您的应用
6.  当 a`WebView`被添加到布局中时，在您打开的选项卡中会出现一个带有 Inspect 按钮的屏幕截图，点击那里将打开一个 Chrome 开发者控制台

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-14T17:54:07.687

如果您正在寻找调试在 webview 中运行的 javascript 代码的解决方案，请查看 jsHybugger - 用于 Android webviews 的 JavaScript/HTML5/CSS 调试器。

[http://www.jsHybugger.org](http://www.jsHybugger.org)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-09T07:51:58.080

我在以前的项目中使用 javascript 处理过 webview，我遇到了同样的问题。我还没有找到直接调试代码的方法，但我使用了 javascript 接口将信息发送到我的活动。通过这种方式，您可以记录 javascript 的活动或显示一些 Toast 消息。

当您的 java 方法没有被调用时，通常意味着您在 JS 代码中犯了某种错误。

我知道这不是解决您的问题的高科技解决方案，但至少是这样，并且对我有用。

祝你好运，沃塔

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-10T12:25:05.937

尝试[OutFront JS](https://github.com/paanSinghCoder/OutFrontJS)

它将控制台消息记录到屏幕上。对调试移动浏览器很有帮助。

它有助于：

*   捕获移动浏览器中的警告、消息和错误。
*   项目清单

适用于所有移动浏览器，甚至是中文浏览器。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-05-08T23:06:58.213

尝试通过在桌面上安装 adb 来访问设备的 ADB Logcat...

# javascript - Javascript IE 事件，这个

> ID：10507699
> 
> 赞同：0
> 
> 时间：2012-05-08T22:56:03.870
> 
> 标签：javascript, events, this, compatibility, explorer

好的，我有链接列表，我正在使用 for 循环处理它们，并附加事件。链接会获得一个调用函数的点击事件。该函数需要对调用它的对象进行操作。像这样：

```
 <ul><li id = 'myId'>Text</li>
    <li id = 'myId'>Text</li>
    <li id = 'myId'>Text</li>
    <li id = 'myId'>Text</li>
    </ul>

   var grab = document.getElementsByTagName('li');
   for (var x =0;x<grab.length;x++){
       grab[x].attachEvent('onmouseover',doSomething);
       }

    function doSomething(){
        this.setAttribute('color','yellow');
    } 
```

这在除 IE 之外的所有浏览器中都运行良好，我遇到的问题似乎是 IE 希望“this”成为窗口，而不是调用事件的对象。

我知道 JQuery 很容易解决这个问题，只是我无法在这种情况下访问 JQuery。有没有办法，就在常规的 javascript 中，正确使用“this”，或者一种近似的方法其他人都有的行为？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:56:53.673

只需使用旧标准的可靠`on[event]`处理程序。

```
for (var x = 0, len = grab.length; x < len; x++) { 
   grab[x].onmouseover = doSomething;
} 
```

并确保您实际上没有复制问题中显示的 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:01:41.383

我认为事件被传递给函数，你应该可以使用`evt.srcElement`

```
for (var x =0;x<grab.length;x++){
       grab[x].attachEvent('onmouseover', doSomething);
 }

 function doSomething(evt){
     evt.srcElement.setAttribute('color','yellow');
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T23:32:53.760

你也可以这样做：

```
<ul><li id = 'myId'>Text</li>
<li id = 'myId'>Text</li>
<li id = 'myId'>Text</li>
<li id = 'myId'>Text</li>
</ul>

var grab = document.getElementsByTagName('li');
for (var x =0;x<grab.length;x++){
    grab[x].attachEvent('onmouseover',function(){
        doSomething.call(grab[x]);
    });
}
function doSomething(){
    this.setAttribute('color','yellow');
} 
```

# javascript - 无法弄清楚为什么 WebGL 不会绘制三角形

> ID：10507703
> 
> 赞同：-2
> 
> 时间：2012-05-08T22:56:25.057
> 
> 标签：javascript, webgl

我不确定这是否是正确的协议，但我有一个项目位于：

[https://github.com/mkarbowski/angry-bears](https://github.com/mkarbowski/angry-bears)

这是我对 WebGL 游戏的尝试。我已经使用 OpenGL ES 2.0 与 android 一起工作过，所以我认为 WebGL 不会有太大的飞跃。但是整个无法调试脚本正在杀死我。更不用说缺乏有意义的错误了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T03:17:41.637

好吧，首先你会遇到 GL 错误。找出原因可能会很好。

您可以使用“调试上下文”来查找它们。请参阅[WebGL Wiki 中的此条目](http://www.khronos.org/webgl/wiki/Debugging)

我添加了包含那里引用的文件，并将这一行添加到您在 engine.js 中的代码中，第 26 行

```
gl = WebGLDebugUtils.makeDebugContext(gl, function(err, funcName, args) {
  throw WebGLDebugUtils.glEnumToString(err) + ": " + funcName;
}); 
```

在 gltexture.js 你有这样的代码

```
texture = gl.createTexture();
gl.bindTexture(gl.TEXTURE_2D, this.texture); 
```

this.texture 没有定义。可能你之前是想这样定义就行了？

```
this.texture = gl.createTexture(); 
```

然后您用于加载图像的 onload 回调使用“this”，但在回调的上下文中没有“this”。解决这个问题的最简单方法是声明另一个变量“that”或创建一个属性并使用[bind](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)。

```
that = this;  // define that
image = new Image();
image.onload = function() {
  loaded = true;
  gl.bindTexture(gl.TEXTURE_2D, that.texture);  // using that
  return gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);
}; 
```

这摆脱了错误

按照代码。下一件事，而不是检查纹理是否加载到 GLUtils.useTexture 我刚刚添加

```
 gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, 
                  gl.RGBA, gl.UNSIGNED_BYTE, 
                  new Uint8Array([255,0,0,255])); 
```

到 GLTexture 所以它总是以一个 1 像素的纹理开始，如果真正的纹理加载，它将被替换。

接下来，您的 TriangleTest.draw 正在每帧创建一个缓冲区。可能不是你想要的。

然后我开始在你的代码周围添加 console.log 东西。我将透明颜色更改为随机

```
 gl.clearColor(0, 0, Math.random(), 1); 
```

这样我就可以看到程序正在运行。

我发现您在 useCamera 中传递的矩阵没有投影矩阵。我将其设置为标识，然后更改顶点，使它们位于剪辑空间中，只是为了在屏幕前获得一些东西。那有一个黑色的三角形。

所以我查看了你的 GLUtils.useTexture。在其中你调用 texture.getTexture() 这是一个不存在的函数。将其更改为

```
gl.bindTexture(gl.TEXTURE_2D, texture.texture) 
```

现在它渲染了一些东西。

其他随机评论

*   使用开发工具（在 Chrome 或 Safari 中）。Firefox 中的 Ctrl-Shift-J 或 Cmd-Shift-J 或类似工具
*   有时[WebGL Inspector](http://benvanik.github.com/WebGL-Inspector/)会有所帮助。
*   console.log 和 console.error 是你的朋友。console.error 至少在 Chrome 中为您提供堆栈跟踪。
*   停止使用 setTimeout。而是使用[requestAnimationFrame](http://paulirish.com/2011/requestanimationframe-for-smart-animating/)。一个优点是，如果您的代码死了，它将停止。使用 setTimeout，浏览器将不断调用，使其难以调试。另一个优点是，当您的页面不是前端选项卡时，它通过不 DoSing 他们的系统来表明您关心您的用户。
*   打印和检查所有 WebGL 调用会很有帮助。按照上面调试上下文的示例，很容易编写一个包装器，它 (a) 打印每个调用并 (b) 检查没有未定义的参数。（例如，参见[WebGL Wiki ）](http://www.khronos.org/webgl/wiki/Debugging)
*   如果您使用的是 Chrome，请尝试 Chrome 20 (Chrome Canary)。它为 WebGL 错误提供了更多错误消息。Firefox 也是如此。

祝你的项目好运

# objective-c - 使用 Objective-C 的 Mac OS X 守护进程 - launchd

> ID：10507710
> 
> 赞同：11
> 
> 时间：2012-05-08T22:57:22.570
> 
> 标签：objective-c, macos, launchd, launch-daemon

我是 Mac OS X 世界的新手，但我有 Windows 开发技能。

我需要开发一个从 Web 服务上传/下载文件的守护程序（在 Windows 上将是 Windows 服务）。

**我的问题是：**是否可以创建一个用 Objective-C 编写的应用程序作为守护进程（上传/下载）并在操作系统开始使用 launchd 时启动它？或者还有另一种创建守护进程的方法？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T08:02:29.253

在 OS X 上，这些服务称为 LaunchDaemon（系统范围）和 LaunchAgent（用户特定）。您创建一个配置，告诉系统何时启动、运行哪个可执行文件、如何处理 stdin、stdout 和 stderr，传递哪些参数等等。看看这些手册页：

```
launchd(8)       # the service controlling other services
launchctl(1)     # the command to control services
launchd.plist(5) # the configuration format for services 
```

守护程序可以用任何在 OS X 上运行的语言编写。因此，Objective-C 是 Mac 平台的典型选择，但是从 Ruby、Python 和 Perl 到 AppleScript 到纯 C 或 C++ 的任何其他语言都可以。

不，没有其他（推荐的）方法可以在 Mac 上执行此操作。`init.d`-style 脚本在 Mac [或在 Darwin，它是 UNIX 层] 上不起作用。或者，更准确地说，没有运行它们的基础设施。

有关详细信息，请参阅[守护程序和服务编程指南](https://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/Introduction.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T08:20:01.927

I don't know if I have understood correctly but I guess you can do it. The next link could be a good start for understand how Daemons work in Objective-C [Apple Developer](https://developer.apple.com/library/mac/#technotes/tn2005/tn2083.html) Then here there is a interesting piece of code. [It is about GPS but it might be usefull](http://chrisalvares.com/blog/?p=7). Also get a look of this github folder.[It is a controller for start/stop daemons](https://github.com/ivanvc/DaemonController)

# java - 中环修改java

> ID：10507712
> 
> 赞同：-1
> 
> 时间：2012-05-08T22:57:56.580
> 
> 标签：java, arrays, if-statement, for-loop, while-loop

在这个循环中：

```
while(a < 100){
    a=a+1;
    for(i = 0;i < arr.length;i++){
        if(x < arr[i]){
            arr2[i] = arr2[i] - z;
            x = x - z;
            if(x > arr[i]) break;
        }
    }
} 
```

`i`th 元素可能大于`x`导致中断但`i+1`可能小于`x`并且我想从中减去`x`，我`i+1`怎样才能使循环跳过`arr[i]`并继续前进`arr[i+1]`而不完全破坏循环并且不从顶部开始迭代？

我的输出的一个例子是我的循环在 2`arr2=(0,0,0,2,0,0,5)`处`x=3`终止，因为它小于 3，但我仍然想从 5 中减去。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:15:04.177

我想你可能打算这样做，但我无法想象你试图实现什么。在纸上尝试算法。

```
for (int i = 0; i < arr.length; i++){
    if (x < arr[i]) {
        arr2[i] -= z;
        x -= z;
        if (x <= 0) {
            break;
        }
        // Continue with smaller x (assuming z > 0) for rest of arr.
    }
} 
```

* * *

***在 for 循环中：***

```
for (START; CONDITION; STEP) {
    STMT1;
    continue;
    STMT2;
 } 
```

相当于：

```
 START;
 loop:
     if (!CONDITION) {
         goto endloop;
     }
     STMT1;
     goto step;
     STMT2;
 step:
     STEP;
     goto loop;
 endloop: 
```

# javascript - 如何保留这个 jQuery 事件处理程序？

> ID：10507714
> 
> 赞同：1
> 
> 时间：2012-05-08T22:58:02.507
> 
> 标签：javascript, jquery, event-handling

我在 dom 元素上有一个点击甚至处理程序。

```
jQcurrentOption.click(function () {
 //IMPLEMENTATION
}); 
```

克隆此元素时，`.cloneNode(true)`它会丢失其事件处理程序:(。我知道我可以更改 jQuery（请注意，因此我仍在使用 1.4.4`live`而不是`bind`（1.7+））

```
jQcurrentOption.live("click",function(){
 //IMPLEMENTATION
}); 
```

但是我很好奇是否有办法保留这些处理程序而不用`live`（或`bind`）定义它们。有时我没有使用 jQuery 来应用的好处`live`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:00:47.163

你试过 jQuery`clone()`吗？

```
var $clone = jQcurrentOption.clone(true); 
```

如果您`true`作为参数传递，它会克隆事件处理程序。

* * *

除此之外，jQuery 1.4.4 支持`delegate()`，相当于 1.7 的`on()`：

```
$("select").delegate("option.current", "click", function () {
 //IMPLEMENTATION
}); 
```

这样您的各个元素就不需要复制事件处理程序。

* * *

只是要说明一点：尽管`delegate()`从 1.7 开始已弃用，但它确实与更现代的 相同`on()`，唯一的区别是参数顺序。这是当前的实现（1.7.2）：

```
delegate: function( selector, types, data, fn ) {
  return this.on( types, selector, data, fn );
} 
```

# android - MapView 和 AsyncTask

> ID：10507716
> 
> 赞同：1
> 
> 时间：2012-05-08T22:58:21.313
> 
> 标签：android, android-asynctask, android-mapview, runnable

我正在尝试使用我创建的 AsyncTask 类来更新 MapView。问题是当我调用执行 AsyncTask 时出现此错误：

```
 "Can't create a Handler inside a thread that has not called Looper.prepare()" 
```

我尝试使用在 UI 线程上运行任务

```
Handler hand = new Handler(Looper.getMainLooper());
    hand.post(new Runnable() {

        public void run() {
            new RxThread().execute();

        }

    }); 
```

但这只是给了我同样的错误。我意识到我的 MapView 没有调用 looper prepare，并且由于我在单独的 Activity 而不是 Main Activity 上运行 MapView，因此我无法使其正常工作。有没有人对此有很好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:02:27.663

IIRC，您的错误是因为您首先`AsyncTask`在后台线程上引用。您只能在主应用程序线程上创建和`execute()`一个。`AsyncTask`

# c# - 如何在 DataGridView 中搜索唯一 ID

> ID：10507720
> 
> 赞同：0
> 
> 时间：2012-05-08T22:59:23.380
> 
> 标签：c#, winforms, datagridview

我有一个 datagridview 并通过以下接口填充其数据源属性：

```
mainGrid.DataSource = IFace.fillMainGridView(); 
```

mainGrid 有一个名为 CustID 的列。如果我使用数据绑定填充 mainGrid，则很容易搜索 CustID，如下所示：

```
customerBindingSource.Filter = "CustID like '%" + SearchtextBox.Text + "%'"; 
```

我正在尝试使用此代码来搜索 CustID。我正在尝试使用以下代码搜索 CustID，但它不起作用

```
for(int rowIndex = 0; rowIndex<mainGrid.Rows.Count; rowIndex++)
for (int columnIndex = 0; columnIndex < mainGrid.ColumnCount; columnIndex++)
{
    if (mainGrid[columnIndex, rowIndex].Value.ToString() == SearchtextBox.Text)
        return rowIndex;
} 
```

请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:27:41.907

我认为这会奏效

```
 foreach (DataRow row in mainGrid.Rows)
        {
            if (row["ColumnName"].ToString() == SearchtextBox.Text )
            {
            return CustID;
            }
        } 
```

# ruby-on-rails-3 - 未定义的方法`user_topics_path'

> ID：10507726
> 
> 赞同：0
> 
> 时间：2012-05-08T22:59:42.503
> 
> 标签：ruby-on-rails-3, routes

我已经为此工作了一段时间，我快要发疯了。我有表用户、主题和用户主题。`has_many`Users 和 UserTopics 之间以及 Topics 和 UserTopics 之间都有关系。目前我收到错误：

```
undefined method `user_topics_path' 
```

引发错误的代码行是：

```
<%= form_for current_user.usertopics.find_by_user_id(@user),
         :html => { :method => :delete },
         :remote => true do |f| %> 
```

在 user.rb 我有：

```
has_many :usertopics, :class_name => 'UserTopic', 
                      :foreign_key => "topic_id",
                      :dependent => :destroy 
```

在 routes.rb 我有：

```
 resources :usertopics 
```

从我到目前为止收集到的信息来看，错误在于这些代码段。我尝试了在网上找到的其他建议，但无济于事。任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:19:09.410

将您的路线更改为：

```
resources :user_topics 
```

# php - 为什么这是一个解析错误？

> ID：10507731
> 
> 赞同：1
> 
> 时间：2012-05-08T23:00:02.967
> 
> 标签：php, syntax

以下代码

```
$t =   1 – (1 - 2); 
```

产量：

`Parse error: syntax error, unexpected T_STRING on line 3`在 php 5.2.3 和 5.4 中我得到`Parse error: in <file> on line 3`

对我来说，似乎我正在从另一个表达式中减去一个表达式，我认为这是合法的。为什么这是一个解析错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T23:03:54.720

第一个“-”是一个破折号，但它应该是一个连字符减号，就像后者一样：“-”。替换它，您的代码将起作用。

# jsp - 您可以将没有 .jsp 扩展名的文件呈现为 JSP 吗？

> ID：10507733
> 
> 赞同：10
> 
> 时间：2012-05-08T23:00:38.633
> 
> 标签：jsp, jakarta-ee, servlets, web.xml

是否可以告诉标准 Java EE servlet 容器将文件解释和呈现为 JSP，即使它没有 .jsp 扩展名？

假设我的 WAR 根目录中有一个名为 foo.xyz 的文件。该文件包含一些 jstl 逻辑，正如您在 .jsp 文件中所期望的那样。如果我请求[http://myserver/myapp/foo.xyz](http://myserver/myapp/foo.xyz)我将看到该文件中的文字代码呈现为文本。有没有办法配置 Web 应用程序，使其使用 JSP 解释器呈现文件而不更改文件扩展名？

请不要问我为什么要这样做。约束很复杂。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-02-19T09:21:56.360

您可以在您的文件中添加以下配置，以使以beeeing`web.xml`结尾的文件作为 JSP 处理：`.xyz`

```
<jsp-config>
    <jsp-property-group>
        <url-pattern>*.xyz</url-pattern>
    </jsp-property-group>
</jsp-config> 
```

此解决方案适用于 Tomcat 和 Websphere。并且可能与任何 JEE 兼容的服务器容器一起使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-08T23:08:04.023

将该 URL 模式上的 JSP servlet 映射添加到您的 webapp 的`web.xml`.

```
<servlet-mapping>
    <servlet-name>jsp</servlet-name>
    <url-pattern>*.xyz</url-pattern>
</servlet-mapping> 
```

请注意，这假定 servletcontainer 自己的 JSP servlet 使用 servlet 名称注册，该名称是`jsp`JSP servlet 的事实上的标准 servlet 名称。验证`<servlet>`servletcontainer 自己的条目`web.xml`以确保。例如 Tomcat，这是`/conf/web.xml`其安装文件夹中的文件。

# razor - MVC 4 ActionLink 字典 htmlAttributes 不起作用

> ID：10507737
> 
> 赞同：7
> 
> 时间：2012-05-08T23:01:13.030
> 
> 标签：razor, asp.net-mvc-4

我希望这只是一个错误，但我想也许这只是我。

```
@Html.ActionLink("Test", "Test", "Test",
  new { id = 1 },
  new Dictionary<string, object> { { "class", "ui-btn-test" }, { "data-icon", "gear" } }) 
```

这确实有效，但如果我想添加更多属性，我必须手动完成！

```
@Html.ActionLink("Test", "Test", "Test",
  new { id = 1 },
  new { @class="ui-btn-test", data_icon="gear", data_new_attr="someextra" }) 
```

第一个不再工作了，我需要这个工作。第二个有效但不在乎它是否有效，因为我正在尝试添加更多属性，除非另有说明，否则对象将无法工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T18:27:42.617

所提供的辅助方法都不`ActionLink`接受您指定的参数。唯一采用 IDictionary 类型参数作为 html 属性的参数需要 RouteValueDictionary 作为路由值。实际上，您当前正在调用一个将您的字典视为匿名对象的函数

尝试

```
@Html.ActionLink("Test", "Tesz", "Test",
new RouteValueDictionary(new {id = 1}),
new Dictionary<string, object> { { "class", "ui-btn-test" }, { "data-icon", "gear" } }) 
```

或者实现你自己的扩展方法。

# java - 我可以使用 Eclipse、windowbuilder 链接两个 JFrame 窗口吗？

> ID：10507740
> 
> 赞同：1
> 
> 时间：2012-05-08T23:01:26.977
> 
> 标签：java, eclipse, swing, jframe, windowbuilder

我正在为一个有趣的编程项目制作一个网络站点。我想添加一个登录屏幕，使用 Jframe，一旦他们登录，它将转到第二个 JFrame 携带所有信息。所以我们称第一个为“logIn”，第二个为“socialNetwork”。

我要做的基本上是在程序中有一个读/写文件，并且每一行都是一个用户名和一个密码，也是一个创建新配置文件的选项，然后将其添加到文件中。如果用户点击“logIn”上的登录按钮，我将读取该文件，如果他们的用户名和密码匹配，它将发送或调出主配置文件查看器或“socialNetwork”是否有一行代码要做到这一点？有教程可以链接我吗？当我寻找它时，我认为我不是在寻找正确的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-23T01:38:57.010

看来您需要使用 PrintWriter。 [如何在 Java 中创建文件并写入文件？](https://stackoverflow.com/questions/2885173/java-how-to-create-and-write-to-a-file)

读取文件你会使用这样的东西

```
String delims = "[ ]+";
Scanner fileScan = new Scanner(new File("theFileName"));

while(fileScan.hasNext()){
    String str = fileScan.nextLine();
    String[] tokens = str.split(delims);
  ...

//now your tokens[0] has username
// and tokens[1] has password
...//do something with it
} 
```

# css - CSS 字体速记验证

> ID：10507750
> 
> 赞同：1
> 
> 时间：2012-05-08T23:02:10.820
> 
> 标签：css, validation, w3c-validation

我通过 w3 验证器放置了一些 css（我知道这有点毫无意义，因为它对 css3 犹豫不决）但我发现了一些我试图修复的可能是错误的东西。

这是它发现的错误之一，但我认为它没有任何问题。也许你们能看到我看不到的东西。

它给出的错误是......

> 值错误：字体/不是字体系列值：粗体 3.7em / 0.82 Impact、Charcoal、sans-serif

代码是...

```
font:bold 3.7em/0.82 Impact, Charcoal, sans-serif; 
```

JJ

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:13:28.843

我~~认为~~这肯定是验证器中的一个错误（[你不是唯一一个有问题的人](https://www.google.com/#hl=en&safe=off&output=search&q=font+shorthand+validation+w3c)），因为我从[官方规范](http://www.w3.org/TR/CSS2/fonts.html#font-shorthand)中提取了一个示例，并且它得到了同样的错误。

我验证了这一点：

```
* { font: bold 3.7em/0.82 Impact, Charcoal, sans-serif; }
p { font: x-large/110% "New Century Schoolbook", serif } /* from specs */ 
```

得到了这个：

```
Sorry! We found the following errors (2)
URI : TextArea
1    *   Value Error : font / is not a font-family value : bold 3.7em / 0.82,Impact,Charcoal,sans-serif
2    p   Value Error : font / is not a font-family value : x-large / 110% "New Century Schoolbook",serif 
```

资料来源：

*   [http://www.w3.org/TR/CSS2/fonts.html#font-shorthand](http://www.w3.org/TR/CSS2/fonts.html#font-shorthand)
*   [http://jigsaw.w3.org/css-validator/validator](http://jigsaw.w3.org/css-validator/validator)

jigsaw css 验证器并不完美。它是软件，所以它包含错误。在这些情况下，最好的办法是检查主题的规范并尝试验证示例代码，如果在这种情况下确实有效，请尝试看看它与您自己的有何不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T03:47:08.447

[该错误于](http://lists.w3.org/Archives/Public/www-validator-css/2012May/0003.html)2012 年 5 月 3 日在 W3C CSS Validator 的邮件列表中报告。还没有回复，我预计在修复错误之前需要几天甚至几周的时间。这可能与他们重写了与字体相关的处理属性值的某些部分有关，在此过程中也出现了一些其他错误（现已修复）。

要么等待开发并手动检查 CSS 代码的此类部分，要么使用单独的字体属性而不是`font`速记。CSS 速记通常是有风险的，不是因为浏览器错误（不再是），而是由于概念上的困难以及人们在使用这种具有复杂语义和句法特性的结构时容易出错。

由于这些原因，重写大量现有代码几乎没有用，但对于个别规则和新代码，最好避免使用“font:bold 3.7em/0.82 Impact, Charcoal, sans-serif;”（即使它符合）并改用单个属性：

```
font-weight: bold;
font-size: 3.7em;
line-height: 0.82;
font-family: Impact, Charcoal, sans-serif; 
```

人们使用速记的主要原因`font`可能是他们在许多地方、在多个规则中使用*相同的设置。*通常可以编写一次设置并在规则中使用合适的选择器列表，并且只覆盖所需的元素，这对于可维护性和代码可读性来说更好。

# php - 需要帮助为 PHP 和 htaccess 编写 URL 重写规则正则表达式

> ID：10507754
> 
> 赞同：1
> 
> 时间：2012-05-08T23:02:29.037
> 
> 标签：php, regex, .htaccess, url, rewrite

我读过很多关于如何使用重写规则和正则表达式的网站，但它们都倾向于针对特定示例而没有分解每一个语法并实际上帮助我学习概念以便我可以编写我需要的代码类型。

任何帮助深表感谢！

我有一个这样的网址[http://www.mysite.com/myphp.php?x=1A&y=2B&c=some1&d=some2](http://www.mysite.com/myphp.php?x=1A&y=2B&c=some1&d=some2)

我希望这样重写：[http ://www.mysite.com/some1/some2](http://www.mysite.com/some1/some2)

这看起来很简单，但正如我所提到的，我还没有遇到一个网站以一种我可以弄清楚如何使其工作的方式来解释这些概念。

在此特定示例中，?x= 始终相同，而 1A 则不同。这同样适用于 php 字符串的其他每个部分，但是，我假设重写规则应该处理 .php 文件和我真正感兴趣的变量之间的任意数量的字符。

再次感谢任何可以帮助解释这一点或提供有关重写规则和正则表达式的高质量资源来帮助我学习它的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T00:29:12.027

像这样的规则将起作用（经过测试）：

```
RewriteRule ^([^/]+)/([^/]+) myphp.php?x=1A&y=2B&c=$1&d=$2 [L] 
```

这包括三个部分：

1.  `RewriteRule`指定这是重写规则（与条件或其他指令相反）。命令是将第 2 部分重写为第 3 部分。
2.  这部分是一个正则表达式，只有当 URL 匹配这个正则表达式时，规则才会运行。在这种情况下，我们说 - 查找字符串的开头，然后是一堆非斜线字符，然后是一个斜线，然后是另一束非斜线字符。括号表示括号内的部分将被存储以供将来参考。
3.  最后，这部分说以这种格式重写给定的 URL。$1 和 $2 指的是被捕获和存储的部分（反向引用）

至于mod_rewrite上的优质资源，过去我通过搜索“mod_rewrite教程”找到了一些（我认为[这](http://www.sitepoint.com/guide-url-rewriting/)对于初学者来说是一个很好的）。他们大多是这样的，所以如果有什么你不明白的具体内容，请在继续之前把它排除在外。我不确定如何解释语法。

正则表达式是另一回事，同样，那里有许多资源 - 包括初学者。一旦你掌握了正则表达式的基本窍门，你就可以使用[Python re 页面](http://docs.python.org/library/re.html)作为参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:09:40.877

添加到.htaccess 之类的东西（未测试）？

```
RewriteEngine on
RewriteRule ^/([0-9a-z]+)/([0-9a-z]+)/$ /?c=$1&d=$2 [L] 
```

假设 x 和 y 不感兴趣。

# c# - 将此字符串转换为十进制

> ID：10507759
> 
> 赞同：1
> 
> 时间：2012-05-08T23:03:23.403
> 
> 标签：c#

听起来很容易，但是当我尝试实现时，我很想知道格式化程序是如何进行这种转换的，这是我需要转换为十进制的一些字符串示例

```
00.24
48.34
01.24 
```

有谁知道我怎么能做到这一点？我试过这样

```
try
{
   decimal x =  Convert.ToDecimal("00.24", );
   //Which formatter do I need to pass??
   decimal x =  Convert.ToDecimal("00.24", Formatter???);
}
Catch(Exception e)
{
    throw new Exception()
} 
```

但它不起作用，因为结果是 24D，我需要 0.24D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T23:06:02.580

我怀疑您的系统文化不是英语，并且有不同的数字格式规则。尝试将不变文化作为格式提供者传递：

```
decimal d = Convert.ToDecimal("00.24", CultureInfo.InvariantCulture); 
```

你也可以使用`Decimal.Parse`：

```
decimal d = Decimal.Parse("00.24", CultureInfo.InvariantCulture); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T23:06:13.767

为什么不直接使用`Decimal.Parse`

```
decimal x = Decimal.Parse("00.24");
Console.WriteLine(x);  // Prints: 00.24 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T23:06:09.457

我认为 Decimal.TryParse 应该可以工作。更多信息[在这里](http://msdn.microsoft.com/en-us/library/system.decimal.tryparse.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T23:15:16.257

您得到的结果是因为点`.`被视为组（千）分隔符。解析器只是丢弃它，并且不检查组大小是否正确。所以“20.100.200”或“1.2.3.4”也会被解析为 20100200 和 1234。

这发生在许多欧洲文化中，例如“es”

您必须使用任何不将 a`.`视为组分隔符但将其视为小数分隔符的区域性。`CultureInfo.InvariantCulture`是可能的文化之一（它与 en-US 的配置基本相同）。

# java - 正则表达式查找代码注释中的坏词

> ID：10507762
> 
> 赞同：1
> 
> 时间：2012-05-08T23:04:14.793
> 
> 标签：java, regex, eclipse, filter, profanity

我们有一个大型应用程序（仅 40,000 多行评论），我们将其移交给另一家公司，但需要确保我们的代码评论符合犹太教规。我查找不适当代码注释的计划如下... 1 - 获取亵渎词的黑名单 2 - 在 eclispe 的代码搜索中使用正则表达式来查看这些词是否在我们的应用程序中，并手动检查每个案例。

对于第 1 项，我已经看到一些应用程序或 Web 服务进行过滤，但有人知道在线某处的简单单词列表吗？

对于第 2 项，我如何简单地在 eclispe 中搜索单词 hamburger OR Pizza？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T23:21:31.260

为什么要使用 Eclipse？

我只是建立一个“顽皮的词”列表，并使用`find`和`grep`搜索代码库的出现。然后访问每个文件并查看点击量。（您可以通过在每个标记文件的开头添加“FIXME”样式注释来自动化后者，并使用 Eclipse 的工作列表支持来检查标记文件。是否值得取决于您必须点击的次数看着。）

请记住，您会得到误报（取决于您的谨慎程度）和误报……作者在不使用顽皮的话的情况下说出了冒犯性的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T09:56:10.887

[CodePro Analytix](https://developers.google.com/java-dev-tools/download-codepro)有一个静态代码分析检测器，称为“不恰当的语言”。您可以轻松地在其配置中添加更多调皮的话，然后在分布式团队或自动静态代码分析调查中使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T21:58:53.437

简单而正确的答案如下...在 Eclipse 中，您可以运行正则表达式来匹配单词，只需检查正则表达式按钮并将您的单词作为比萨饼 | 汉堡包。

# java - 实现 ServletWrappingController 时出现未知异常

> ID：10507763
> 
> 赞同：0
> 
> 时间：2012-05-08T23:04:24.977
> 
> 标签：java, servlets, spring-mvc

我一直在努力实现 ServletWrappingController 方法，但遇到了一些问题。这是我的配置...

```
<!-- Setup Spring ServletWrappers -->
<bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    <property name="mappings">
        <props>
            <prop key="/spellchecker/google-spellchecker.do">tinyMCESpellCheckerWrappingController</prop>
        </props>
    </property>
</bean>

<bean id="tinyMCESpellCheckerWrappingController" class="org.springframework.web.servlet.mvc.ServletWrappingController">
    <property name="servletClass">
        <value>org.tinymce.spellchecker.TinyMCESpellCheckerServlet</value>
    </property>
    <property name="servletName">
        <value>doPost</value>
    </property>
</bean> 
```

我遇到了一些例外...

> 严重：上下文初始化失败 org.springframework.beans.factory.BeanCreationException：创建 ServletContext 资源 [/WEB-INF/dispatcher-servlet.xml] 中定义的名称为“urlMapping”的 bean 时出错：bean 的初始化失败；嵌套异常是 org.springframework.beans.factory.BeanCreationException：在 ServletContext 资源 [/WEB-INF/dispatcher-servlet.xml] 中定义名称为“tinyMCESpellCheckerWrappingController”的 bean 创建错误：调用 init 方法失败；嵌套异常是 java.lang.InstantiationException
> 
> 原因：org.springframework.beans.factory.BeanCreationException：在 ServletContext 资源 [/WEB-INF/dispatcher-servlet.xml] 中定义名称为“tinyMCESpellCheckerWrappingController”的 bean 创建错误：调用 init 方法失败；嵌套异常是 java.lang.InstantiationException

我在这里没有看到错误消息，所以我不确定从哪里开始调试以确定原因......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T09:10:50.033

我刚刚检查了您的另一篇[文章](https://stackoverflow.com/questions/10504548/how-to-integrate-googlespellchecker-with-springmvc-with-servletwrappingcontrolle)，似乎 TinyMCESpellCheckerServlet 类是一个抽象类，它在尝试实例化此类时导致了此问题。

# jquery-plugins - 为什么 jquery.validate 的输入需要标签？

> ID：10507767
> 
> 赞同：0
> 
> 时间：2012-05-08T23:05:23.170
> 
> 标签：jquery-plugins

我只是从 jquery.validation 开始并喜欢它。在尝试理解全局时，我觉得特别有用的一个参考是[http://docs.jquery.com/Plugins/Validation/Reference#Markup_recommendations](http://docs.jquery.com/Plugins/Validation/Reference#Markup_recommendations)。我不明白的一部分是为什么标签需要与每个输入相关联。是的，我知道创建标签是为了显示错误提示，但是，这些是不同的标签。我无法检测到标签标签上的任何变化，没有它也可以正常工作。有谁知道为什么？谢谢

> 每个输入都有一个与之关联的标签：标签的 for 属性是指输入的 id 属性。

```
<label for="firstname">Firstname</label><input id="firstname" name="fname" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:29:46.567

在这种情况下`label`，实际上是 HTML 元素，它为鼠标用户增加了可用性改进，如果用户单击元素内的文本，它会切换控件。

在 HTML`label`中是一个可选元素，这意味着您不需要`label`为每个元素提供`input`

# microcontroller - PIC18f452 端口监听问题

> ID：10507768
> 
> 赞同：0
> 
> 时间：2012-05-08T23:05:26.947
> 
> 标签：microcontroller, microchip, mikroc

为什么这段代码不起作用？我想要的只是 portb 在我按下按钮时切换。

```
main
trisb=0
trisa=0xff
while true
if ra0<>0 then
portb = not portb
end if
wend .end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T16:16:07.763

我不确定那是什么；是伪代码吗？

无论如何，您需要触发从 RA0 == 0 到 RA0 == 1 的 CHANGE。正如所写，只要 RA0 == 1，那么您的 PORTB 每次循环都会切换。

这是 C 语言中的一个示例：

```
int main(void)
{
    unsigned char bButtonValue = 0;

    TRISA = 0xFF;
    TRISB = 0x00;

    while (1)
    {
        if (RA0 != bButtonValue) 
        {
            bButtonValue = RA0;
            if (bButtonValue == 1)
            {
                 PORTB= ~PORTB;
            }
         }
     }
} 
```

请记住，对于一个真实的应用程序，您可能希望消除开关输入的抖动（确保在触发更改事件之前它对于几个样本是稳定的。

# javascript - Javascript用单个正斜杠替换反斜杠和正斜杠的组合

> ID：10507770
> 
> 赞同：0
> 
> 时间：2012-05-08T23:05:44.247
> 
> 标签：javascript, replace, escaping

在 Javascript 中，我在将字符串中的 '/' 替换为 '/' 时遇到了一些麻烦。我试过这个

```
string.replaceAll("\\/","/")); 
```

这有什么问题？我正在转义转义字符，即反斜杠。

请指教。谢谢 编辑：我有一个转义的 URL，例如 http://www.gogobeans.com。我需要将其更改为[http://www.gogobeans.com](http://www.gogobeans.com)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T23:09:22.157

我从未听说过`replaceAll`纯 javascript 中的方法，请尝试`replace`使用正则表达式：

```
 string.replace(/\\\//g, "/"); 
```

我已经转义了转义字符，`\\`然后转义了范围字符`/`，它应该可以工作。

JSFiddle：**[演示](http://jsfiddle.net/ult_combo/s4vvb/1/)**

# yui - 使用 Uploadify 的 Web 上传程序问题

> ID：10507775
> 
> 赞同：1
> 
> 时间：2012-05-08T23:06:04.450
> 
> 标签：yui, uploadify, progress, uploader

我正在开发一个允许我的客户将大量高分辨率图像文件上传到我的系统的网站。我尝试了几个上传器，但它们似乎不像我预期的那样可靠——尤其是在 Windows 上。

我尝试了以下方法：

1.  上传 2 和 3
2.  YUI 上传器（雅虎上传器）

以上上传者均依赖 Adob​​e Flash。

上述上传者最常见的一个最明显的问题是，该进度似乎不适用于 Windows。在上传实际完成之前，它要么停留在 100% 要么 0%。文件似乎上传正常，但进度条完全消失了。不过，这在 MAC 上不是问题。我相信问题不在我的代码中，因为即使是上传者的演示网站也遇到了同样的问题。

最重要的是，我听到客户抱怨上传者在大约 33 个文件之后“自我中止”。他们似乎并不那么可靠。

我的问题是：

1.  有没有办法解决？至少改善视觉效果（使进度条在窗口下方）
2.  是否有任何其他上传器/方法可以让我的客户可靠地将大量文件传送到我的服务器？

想法枯竭，我的客户感到沮丧。

# ruby-on-rails - Twitter bootstrap 显示带有灰色文本的按钮

> ID：10507777
> 
> 赞同：12
> 
> 时间：2012-05-08T23:06:10.160
> 
> 标签：ruby-on-rails, css, twitter-bootstrap

我在我的 Ruby on Rails 应用程序上使用 Twitter Bootstrap 作为框架。

我使用`link_to`以下 CSS 类生成样式为按钮的链接：“btn btn-primary btn-mini”。

例如：

```
<%= link_to 'New Event', url_for(:action => 'new', :controller => 'events') , :class => "btn btn-primary btn-mini" %> 
```

生成以下html

```
<a href="/events/new" class="btn btn-primary btn-mini">New Event</a> 
```

按钮显示正确，但按钮文本显示为灰色而不是白色。在功能上它工作正常，它没有被禁用左右。当鼠标悬停在按钮上时，文本也会变成白色。

我测试了几个案例。我得出的结论是，每当生成的（或硬编码的）链接以正斜杠（/）开头时，按钮文本都是灰色的。每当它以相对资源开始时

我正在运行 Rails 3.2.2，并使用最新的 twitter-bootstrap-gem。

我该如何解决？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-08T23:08:05.320

您是否运行了脚手架生成器？Scaffold.css 会导致这种情况。如果你删除它，你会很高兴。

您还可以使用 --skip-stylesheets 运行生成器以防止创建它们

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-02T14:49:53.923

不要完全删除您的scaffold.css 文件夹，只需删除内容并将文件夹留在那里。如果您在其他时间再次生成脚手架，特别是如果您处于开发阶段的开始，该文件夹可能会重新出现，您将遇到同样的问题。所以如果你只是删除内容，它是一样的事情，系统以后不会再添加另一个文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-13T12:49:59.853

如果您已经有一个应用程序正在运行并且您决定安装 bootstrap 并且不再有 Scaffold.css，您可以将其添加到您的 bootstrap.css 中定义按钮属性的部分（我的：第 2726 行）：

```
.btn:visited { 
color: #FFF
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-25T14:44:06.123

只需添加`:style`到您的按钮。

```
<%= link_to 'New Event', url_for(:action => 'new', :controller => 'events') , :class => "btn btn-primary btn-mini", :style=>'color:#FFFFFF;' %> 
```

# windows - 如何找到所有未覆盖和可见的窗口？

> ID：10507779
> 
> 赞同：0
> 
> 时间：2012-05-08T23:06:18.900
> 
> 标签：windows, pinvoke, user32

我需要为所有可见且未被其他窗口覆盖的窗口获取窗口句柄。

我可以使用 User32 调用获取非最小化窗口的所有窗口句柄，但这会返回其他窗口后面的窗口。我只想要用户实际可以看到的那些。

我想我可以得到所有窗口的 z 顺序，将该列表与“可见”（即非最小化）窗口匹配，获取每个窗口的矩形边界，然后计算出哪些窗口被其他窗口覆盖。 ..但必须有一个更简单的方法？

# objective-c - dismissModalViewController 中的自定义 UIView 动画

> ID：10507781
> 
> 赞同：0
> 
> 时间：2012-05-08T23:06:37.433
> 
> 标签：objective-c, ios, uiviewcontroller, catransition

放置自定义动画代码以关闭 modalviewcontroller 的正确位置在哪里。

我尝试将以下内容放入 viewdiddisappear、viewwilldisappear 但行为不正确。有什么想法吗？谢谢！！

```
[UIView beginAnimations:@"suck" context:NULL];
[UIView setAnimationDuration:1.0];
[UIView setAnimationTransition:103 forView:self.navigationController.view cache:YES];
[UIView setAnimationPosition:CGPointMake(260, 431)];
[UIView commitAnimations]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:12:19.047

试试这个：

```
UIViewController *myController = [[[MyViewController alloc] init] autorelease];
UIViewAnimationTransition transition = UIViewAnimationTransitionCurlUp; // or whatever effect you want
[UIView beginAnimations:nil context:nil];
[UIView setAnimationTransition:transition forView:[self window] cache:YES];
[navController presentModalViewController:myController animated:NO]; // or dismissModalViewController in your case
[UIView commitAnimations]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T09:37:04.380

我想我想通了。我按照以下示例进行操作：

[http://developer.apple.com/library/ios/#samplecode/BubbleLevel/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/BubbleLevel/Introduction/Intro.html)

基本上从超级视图中删除了第二个视图并重新插入了第一个视图。转换在后缀中正常工作。

谢谢您的帮助。

# iphone - tableHeaderView 无法正确显示 UIView

> ID：10507784
> 
> 赞同：0
> 
> 时间：2012-05-08T23:06:46.413
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我正在尝试将带有分页的 UIScrollView 作为标题添加到我的表格中，但不幸的是它没有正确显示。htableHaderView 的大小调整为 my 的大小`imagesScrollView`，但仅显示一半，其余区域为空白。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    ImagesViewController *imagesScrollView = [[ImagesViewController alloc] initWithNibName:@"ImagesViewController" bundle:nil];

    tableView.tableHeaderView = imagesScrollView.view;
    imagesScrollView = nil;

} 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:23:53.250

我尝试了以下代码：

***视图控制器.h***

```
#import <UIKit/UIKit.h>
@interface ViewController : UITableViewController
@end 
```

***视图控制器.m***

```
#import "ViewController.h"
#import "ImagesViewController.h"
@implementation ViewController
- (void)viewDidLoad {
    [super viewDidLoad];
    ImagesViewController *imageVC  = [[ImagesViewController alloc] initWithNibName:@"ImagesViewController" bundle:nil];
    [[self tableView] setTableHeaderView:[imageVC view]];
    imageVC = nil;
}
@end 
```

***图像视图控制器.h***

```
#import <UIKit/UIKit.h>
@interface ImagesViewController : UIViewController
@property (strong, nonatomic) IBOutlet UIScrollView *ScrollView;
@property (strong, nonatomic) IBOutlet UIView *ViewInScrollView;
@end 
```

***图像视图控制器.m***

```
#import "ImagesViewController.h"
@implementation ImagesViewController
@synthesize ScrollView;
@synthesize ViewInScrollView;
- (void)viewDidLoad {
    [super viewDidLoad];
    [[self ViewInScrollView] setFrame:CGRectMake(0, 0, 768 * 2, 400)];
    [[self ViewInScrollView] setBackgroundColor:[UIColor orangeColor]];
    [[self ScrollView] setContentSize:[[self ViewInScrollView] frame].size];
}
@end 
```

`ImagesViewController`的 xib 是一个视图，768 宽 x 200 高（我制作了一个基于 iPad 的`UITableView`单视图应用程序）。它的内部`view`是一个`UIScrollView`，设置为占据整个`[view frame]`区域。然后我把它放在`UIView`里面。

我的测试给了我一个橙色矩形的标题，我可以按照您的预期滚动它。这让我相信也许你需要检查你`imagesScrollView`在 Interface Builder 中的冲击/支柱。确保所有边距和宽度都是固定/灵活的，因为您需要它才能正确显示。

# google-docs-api - 下载链接（通过 API）到 google docs 上可公开访问的文件返回 401

> ID：10507785
> 
> 赞同：0
> 
> 时间：2012-05-08T23:06:52.483
> 
> 标签：google-docs-api

我已经通过文档 API 上传了一个（pgp）文件，并将其可见性更改为公开。但是，我无法使用该文件的内容链接公开下载它。

以下是相关文件元数据的 xml 相关位。

```
$ curl -H "GData-Version: 3.0" -H "Authorization: Bearer ..." https://docs.google.com/feeds/default/private/full

...
    <content type="application/pgp-encrypted" src="https://doc-0c-c0-docs.googleusercontent.com/docs/securesc/tkl8gnmcm9fhm6fec3160bcgajgf0i18/opa6m1tmj5cufpvrj89bv4dt0q6696a4/1336514400000/04627947781497054983/04627947781497054983/0B_-KWHz80dDXZ2dYdEZ0dGw3akE?h=16653014193614665626&amp;e=download&amp;gd=true"/>
...
    <gd:feedLink rel="http://schemas.google.com/acl/2007#accessControlList" href="https://docs.google.com/feeds/default/private/full/file%3A0B_-KWHz80dDXZ2dYdEZ0dGw3akE/acl"/>

$ curl -H "GData-Version: 3.0" -H "Authorization: Bearer ..." https://docs.google.com/feeds/default/private/full/file%3A0B_-KWHz80dDXZ2dYdEZ0dGw3akE/acl

...
  <entry gd:etag="W/&quot;DUcNRns4eCt7ImA9WhVVFUw.&quot;">
    <id>https://docs.google.com/feeds/id/file%3A0B_-KWHz80dDXZ2dYdEZ0dGw3akE/acl/default</id>
...
    <gAcl:role value="reader"/>
    <gAcl:scope type="default"/>
... 
```

为相关文件返回的角色/范围是`reader/default`，表示它是公共的。（它还会在 Web UI 中显示为公共共享访问。）

但是，访问 content 元素中的 src 属性会导致：

```
$ curl --verbose 'https://doc-0c-c0-docs.googleusercontent.com/docs/securesc/tkl8gnmcm9fhm6fec3160bcgajgf0i18/opa6m1tmj5cufpvrj89bv4dt0q6696a4/1336514400000/04627947781497054983/04627947781497054983/0B_-KWHz80dDXZ2dYdEZ0dGw3akE?h=16653014193614665626&e=download&gd=true'

< HTTP/1.1 401 Unauthorized
< Server: HTTP Upload Server Built on May 7 2012 18:16:42 (1336439802)
< WWW-Authenticate: GoogleLogin realm="http://www.google.com/accounts"
< Date: Tue, 08 May 2012 22:48:37 GMT
< Expires: Tue, 08 May 2012 22:48:37 GMT
< Cache-Control: private, max-age=0
< Content-Length: 0
< Content-Type: text/html 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:35:08.323

您似乎正在尝试发布文档：[https ://developers.google.com/google-apps/documents-list/#publishing_documents_by_publishing_a_single_revision](https://developers.google.com/google-apps/documents-list/#publishing_documents_by_publishing_a_single_revision)

发布后，rel 设置为“http://schemas.google.com/docs/2007#publish”的链接将指向网络上发布的文档。

# php - camelCase to dash - 两个大写字母并排

> ID：10507789
> 
> 赞同：17
> 
> 时间：2012-05-08T23:07:08.167
> 
> 标签：php, regex, camelcasing

我正在使用此函数将 CamelCase 转换为虚线字符串：

```
function camel2dashed($className) {
    return strtolower(preg_replace('/([^A-Z-])([A-Z])/', '$1-$2', $className));
} 
```

它有点工作，但是当我有前任时有问题。这个字符串：`getADog`。它回来了`get-adog`，但我想要`get-a-dog`

我应该如何更改我的代码？谢谢

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-08T23:08:43.433

使用[前瞻断言](http://www.regular-expressions.info/lookaround.html)：

```
function camel2dashed($className) {
    return strtolower(preg_replace('/([a-zA-Z])(?=[A-Z])/', '$1-', $className));
} 
```

在线查看它：[ideone](http://ideone.com/wK42i)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-08T23:28:49.937

如果您知道您的字符串不是以大写字母开头，则不需要先行断言来执行此操作，您可以在每个大写字母之前插入一个连字符，如下所示：

```
function camel2dashed($className) {
    return strtolower(preg_replace('/([A-Z])/', '-$1', $className));
} 
```

这仍然无法处理@sfjedi 的“companyHQ”->“company-hq”之类的情况。为此，您必须明确测试不应该拆分的允许的大写子字符串，或指定一些通用规则（例如，不要在最后一个字符之前添加连字符）。

[您可以在这个虚拟重复问题](https://stackoverflow.com/questions/1993721/how-to-convert-camelcase-to-camel-case)的答案中找到一些更复杂的替代方案。

# php - PHP 似乎不能很好地使用 XML 字符串？

> ID：10507793
> 
> 赞同：0
> 
> 时间：2012-05-08T23:07:47.940
> 
> 标签：php, javascript, xml

我正在创建一个应用程序，用户在画布上绘制形状，然后从数据库中保存和检索它们。保存部分工作正常，但现在，我正在尝试加载此 XML 内容，这就是麻烦开始的地方。

首先，用户有一个他们创建的文档列表，当单击它时，它将该文档加载到应用程序中以执行此操作，我使用以下代码，首先是一个 javascript 函数，它获取文档的 ID，然后将其发送到 PHP 脚本它从数据库中检索该文档数据。PHP 脚本会将文档数据加载到`$_SESSION['data']`变量中。完成后，它会返回将用户重定向到应用程序页面的 javascript 函数。

```
function loadDocument(docID){
    $.ajax({
        url: "load_a_document.php",
        type: "POST",     
        data: { 
            documentID: docID,
        }, 
        success: function(data) 
        {
            alert(data); //THIS DISPLAYS THE XML WITH NO PROBLEMS???
            window.location = "application.php";
        }      
    });
}; 
```

PHP 查询数据库并检索文档的名称和 XML 内容，然后执行以下操作：

```
$_SESSION['document_Name'] = $doc_NAME;
$_SESSION['document_XML'] = $doc_DATA;

echo($_SESSION['document_XML']); //this is 'data' on the ajax success call 
```

现在，当 PHP 完成时，它会回显 php 上下文，这会显示在 AJAX 的 success:{} 的警告框中，没有任何问题。现在它将用户带到实际的应用程序，其开始如下：

```
<?php 
session_start();

$document_Name = $_SESSION['document_Name'];
$document_Data = $_SESSION['document_XML'];
?>
<script>
    alert(" <?php echo $document_Name; ?> "); //WORKS FINE
    alert(" <?php echo $_SESSION['document_Name']; ?> ") //WORKS FINE

    //alert(" <?php echo $document_Data; ?> "); //STOPS THE PAGE LOADING
    //alert(" <?php echo $_SESSION['document_XML']; ?> ") //STOPS THE PAGE LOADING
</script> 
```

获取前两项没有问题，只要 XML 数据是打印机，那么它们就是一个真正的问题。我不明白为什么XML`loadDiagram()`可以`alert ()`但我的应用程序页面不能。数据是否以某种方式损坏？

感谢您的任何反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:10:18.180

您可能在导致问题的字符串中有引号。尝试

```
alert(<?php echo json_encode($document_Data) ?>); 
```

# wcf - WCF 服务：没有通道可以接受带有操作的消息

> ID：10507795
> 
> 赞同：1
> 
> 时间：2012-05-08T23:07:58.723
> 
> 标签：wcf

我在收到消息时遇到了问题：

```
"There was no channel that could accept the message with action." 
```

在服务器端和

```
"The message could not be processed. This is most likely because the action." 
```

在客户端。

我正在从 Windows 服务调用我的 WCF 服务，并且我在服务器上的 ISS 中托管了我的 WCF 服务。

这一切在我的本地主机上运行良好。我想我在配置中遗漏了一些东西。

我的`Web.config`样子是这样的：

```
<?xml version="1.0"?>
<configuration>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
    <appSettings>
        <add key="FileTransferPath" value="c:\FileServer\"/>
    <add key="BackUpFileTransferPath" value="c:\BackedUpFiles\"/>
    <add key="DBPath" value="C:\ProjectsSVN\Acso.accdb"/>
    </appSettings>
  <system.serviceModel>
      <services>
          <service name="FileTransfer.FileTransfer">
              <endpoint address="" binding="wsHttpBinding" contract="FileTransfer.IFileTransfer">
                  <identity>
                      <dns value="localhost" />
                  </identity>
              </endpoint>
              <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
              <host>
                  <baseAddresses>
                      <add baseAddress="http://localhost:65051/FileTransfer/" />
                  </baseAddresses>
              </host>
          </service>
      </services>
      <behaviors>
          <serviceBehaviors>
              <behavior>
                  <!-- To avoid disclosing metadata information, 
          set the value below to false and remove the metadata endpoint above before deployment -->
                  <serviceMetadata httpGetEnabled="True"/>
                  <!-- To receive exception details in faults for debugging purposes, 
          set the value below to true.  Set to false before deployment 
          to avoid disclosing exception information -->
                  <serviceDebug includeExceptionDetailInFaults="False" />
              </behavior>
          </serviceBehaviors>
      </behaviors>

      <bindings>
      <basicHttpBinding>
        <binding name="WSHttpBinding_IFileTransfer"
          maxReceivedMessageSize="2147483647">
          <readerQuotas
            maxDepth="64"
            maxStringContentLength="2147483647"
            maxArrayLength="2147483647"
            maxBytesPerRead="4096"
            maxNameTableCharCount="16384"/>
        </binding>
      </basicHttpBinding>

    </bindings>
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

   <!--Turn on to log Trace-->
  <system.diagnostics>
    <sources>
      <source name="System.ServiceModel"
              switchValue="Information, ActivityTracing"
              propagateActivity="true">
        <listeners>
          <add name="traceListener"
              type="System.Diagnostics.XmlWriterTraceListener"
              initializeData= "c:\logs\FileTransferTraces.svclog" />
        </listeners>
      </source>
    </sources>
  </system.diagnostics>

</configuration> 
```

我的`App.config`样子是这样的：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
  </configSections>
  <connectionStrings>
    <add name="cs"
      connectionString="Provider=Microsoft.ACE.OLEDB.12.0;Data Source=|DataDirectory|\ProjectsSVN\Acso.accdb;Persist Security Info=True"
      providerName="System.Data.OleDb" />
    <add name="csc"
      connectionString="Provider=Microsoft.ACE.OLEDB.12.0;Data Source=|DataDirectory|\ProjectsSVN\AcsoGPClient.accdb;Persist Security Info=True"
      providerName="System.Data.OleDb" />
  </connectionStrings>
  <appSettings>
    <add key="FromEmail" value="abc@igi.com.au"/>
    <add key="Subject" value="Your Password"/>
    <add key="DBPath" value="C:\Program Files\Default Company Name\GPWindowServiceSetup\AccersoGPClient.accdb"/>
  </appSettings>
  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_IService11" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://ws2008.igi.aus/AcsoService/Service1.svc" binding="basicHttpBinding"
        bindingConfiguration="BasicHttpBinding_IService11" contract="AccersoService.IService1"
        name="BasicHttpBinding_IService11" />
    </client>
  </system.serviceModel>

</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T07:41:28.937

尝试使客户端绑定定义`<basicHttpBinding/>`与服务配置中的相同定义完全相同。

# iphone - 限制输入到 UITextField 的字符数

> ID：10507799
> 
> 赞同：1
> 
> 时间：2012-05-08T23:08:30.520
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uitextfield

我有一个 UITextField ，其中我限制输入超过 2 位数字。现在，它工作正常，但是当我点击文本字段并选择所有内容然后键入它不允许我覆盖现有的 2 位数字。

关于如何在这里使用“selectedTextRange”属性的任何线索？

```
- (BOOL)cell:(RunnerTableViewCell *)iCell shouldChangeCharactersInRange:(NSRange)iRange replacementString:(NSString *)iString {
    self.navigationItem.rightBarButtonItem.enabled = YES;
    NSCharacterSet *anUnacceptedInput = [[NSCharacterSet decimalDigitCharacterSet] invertedSet];
    int aCharacterUpperLimit = 2;
    BOOL aReturnValue = YES;

    NSInteger aTotalLength = iCell.inputField.text.length + [iString length];
    NSLog(@"iString=%@ aTotalLength=%d",iString,aTotalLength);
    if ([[iString componentsSeparatedByCharactersInSet:anUnacceptedInput] count] > 1 || (aTotalLength > aCharacterUpperLimit && ![iString isEqualToString:kRunnerEmptyString]) || [iString length] > aCharacterUpperLimit) {
        aReturnValue = NO;
    }
    return aReturnValue;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:17:23.503

试试这个：

```
NSInteger aTotalLength = iCell.inputField.text.length + [iString length] - iRange.length; 
```

# html - 如何将每 3 个 div 的内容包装在一个 div 中？

> ID：10507821
> 
> 赞同：1
> 
> 时间：2012-05-08T23:11:16.773
> 
> 标签：html, wordpress, loops

我需要将“loopcontent”类的每三个 div 包装在“threeacross”类的新 div 中。我是 WordPress 的新手，还不是 PHP 专家，但我边走边学。

这是我的循环：

```
 <?php if(have_posts()) : while(have_posts()) : the_post(); ?>
            <div class="loopcontent">
                <?php
                    if ( has_post_thumbnail() ) {
                        the_post_thumbnail();
                    } else {
                        // the current post lacks a thumbnail
                    }
                ?>
                <h1><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h1>
                <?php the_excerpt(); ?>
            </div>

        <?php endwhile; else : ?>

            <div class="loopcontent">
                <h1>Page Not Found</h1> 
                <p>Looks like the page you're looking for isn't here anymore. Try browsing the <a href="">categories</a>, <a href="">archives</a>, or using the search box below.</p>
                <?php include(TEMPLATEPATH.'/searhform.php'); ?>
            </div>

        <?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T23:57:39.810

像这样的东西应该工作。这会保持运行计数并每三个帖子放置一次 div 包装。让我知道这是否有帮助。如果没有，请告诉我它在输出什么，我可以对其进行调整：

```
<?php
if(have_posts()) : for($count=0;have_posts();$count++) : the_post();
    $open = !($count%3) ? '<div class="threeacross">' : ''; //Create open wrapper if count is divisible by 3
    $close = !($count%3) && $count ? '</div>' : ''; //Close the previous wrapper if count is divisible by 3 and greater than 0
    echo $close.$open;
?>
<div class="loopcontent">
    <?php
    if(has_post_thumbnail()) the_post_thumbnail();
    else{
    // the current post lacks a thumbnail
    }
    ?>
    <h1><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h1>
    <?php the_excerpt(); ?>
</div>
<?php endfor; else : ?>
<div class="loopcontent">
    <h1>Page Not Found</h1> 
    <p>Looks like the page you're looking for isn't here anymore. Try browsing the <a href="">categories</a>, <a href="">archives</a>, or using the search box below.</p>
    <?php include(TEMPLATEPATH.'/searhform.php'); ?>
</div>
<?php endif; ?>
<?php echo $count ? '</div>' : ''; //Close the last wrapper if post count is greater than 0 ?> 
```

# algorithm - 购买最大物品的算法

> ID：10507826
> 
> 赞同：3
> 
> 时间：2012-05-08T23:11:53.010
> 
> 标签：algorithm

我们有 N 金币和 M 银币。有k个物品，每个都有一定的成本，A金币和B银币，其中A或B也可以为零。

购买最大数量商品的算法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T12:46:21.250

### 这是背包问题吗？

你描述的问题不是[背包问题](http://en.wikipedia.org/wiki/Knapsack_problem)。在这里，您只想最大化项目数量，而不是它们的总成本。在背包问题中，您感兴趣的是最大化总成本，同时尊重麻袋的容量。换句话说，你想抓住最有价值的物品，可以装在你的袋子里。您并不真正关心它们中有多少，而只关心它们是最有价值的！

下面，我们将讨论问题的两种变体：

1.  *单一货币*——金银币可相互兑换
2.  *多种正交货币*——金币不能转换成白银。

### 单一货币变体

假设你只被允许花费 N 金币和 M 银币，下面是一个应该可以工作的算法：

```
1\. Sort the items by cost, from cheapest to the most expensive.
2\. totalCost = 0; i = 1
3\. while totalCost <= goldToCost(N) + silverToCost(M) + item[i].cost
4\.    totalCost = totalCost + items[i].cost
5\.    i++
6\. endWhile
7\. return i 
```

由于排序，该算法只需要*O(nlogn)*时间。

### 多币种

上述解决方案假设两种货币可以相互转换。该问题的另一个变体涉及正交货币，其中两种货币不能相互兑换。在这种情况下，所有成本都将被指定为向量。

为了解决这个问题，使用了动态规划算法。我们需要询问是否表现出以下两个特征：

1.  [最优子结构](http://en.wikipedia.org/wiki/Optimal_substructure)。问题的最优解是否源自其子问题的最优解？例如，`S(M, N)`我们可以使用 M 金币和 N 银币购买的最大物品数量。我们可以`S(M, N)`使用递归关系推导吗？
2.  [重叠的子问题](http://en.wikipedia.org/wiki/Overlapping_subproblem)。S(M, N) 的子问题是否反复用于计算更大的子问题？

想象一个有 N 行 M 列的二维表。这

```
+---+---+---+---+---+-----+---+
|   | 0 | 1 | 2 | 3 | ... | N |
+---+---+---+---+---+-----+---+
| 0 |   |   |   |   |     |   |
| 1 |   |   |   |   |     |   |
| 2 |   |   |   |   | ... |   |
| 3 |   |   |   |   |     |   |
| : |   |   |   |   |     |   |
| M |   |   |   |   |     |   |
+---+---+---+---+---+-----+---+ 
```

我们的算法基本上会填写这张表。在行`i`、列`j` `S[i, j]`中，使用 i 金币和 j 银币可以购买的最大物品数量。

为了完成该表，我们可以使用两个按字典顺序排序的数组，`I`并且`D`. 首先，gold 作为主排序键，silver 次要。第二，白银是主要的，黄金是次要的。填写第 0 行和第 0 列是直截了当的。然后我们串联遍历这两个排序的数组，然后我们可以使用下面的递归来完成表格

```
S[0, 0] = 0
S[i, j] = 0   if i < 0 or j < 0 
S[i, j] = max(S[i-1,j-1] + d[i-1,j-1], S[i-1,j] + d[i-1,j], S[i,j-1] + d[i,j-1]) 
```

`d[i*,j*]`您可以使用 购买的其他物品数量在哪里`<i,j> - <i*, j*>`，其中`<i*, j*>`之一在哪里`{<i-1, j-1>, <i-1, j>, <i, j-1>}`。换句话说，你可以用剩下的钱买多少。计算这个的搜索涉及对两个按字典顺序排序的序列（`I`或`D`）之一进行二进制搜索。

该解决方案需要*O((MN + n)logn)*时间来计算并使用*O(MN + n)*空间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T06:13:24.470

在这个问题中，每个项目都有一个二维成本。让项目 i 的成本为 c[i] = < a, b > 其中 a 是金币的成本，b 是银币的成本。

现在可以*部分*订购物品，以便物品 i 比物品 j“不贵”，如果

```
c[i] = <a, b>    c[j] = <a', b'>  and    a <= a' AND b <= b' 
```

请注意，这是*部分*订单。两个项目 <1, 2> 和 <2, 1> 在这个偏序中是不可比较的；两者都不比另一个贵。

现在很清楚，贪心算法可以安全地购买物品，只要它们与剩余的*所有*其他物品相比“不贵”，但是当有多个不可比较的物品可用时，可以进行更多分析（例如搜索）需要。

例如，如果成本是

```
 <1, 1>
 <2, 1>
 <1, 2>
 <3, 3> 
```

这导致了这个部分顺序：

```
 <1, 1>
       /      \
     <2, 1>   <1, 2>
         \   /
         <3, 3> 
```

（最贵的物品在底部）。贪心算法会先购买<1, 1>。之后，<2, 1> 和 <1, 2> 都是可行的购买选项。如果算法选择购买 <2, 1>，那么下一个要购买的是 <1, 2>，因为它现在并不比所有其他剩余物品 (<3, 3>) 贵。

简单的贪心算法可能会失败。设置<2, 1>, <1, 2>, <3, 0>，初始硬币数量gold = 4, silver = 2，最优解是<1, 2> 和<3, 0> , 但首先购买 <2, 1> 会导致只能购买该物品（购买时留下的 <2, 1> 硬币不允许购买其余两个物品中的任何一个）。

我会接近这个购买构建部分订单结构，然后执行回溯搜索。如果时间限制不允许完全回溯，我将使用有限回溯作为其他贪婪算法的启发式方法。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-08T23:17:31.893

没有“算法”。

您正在描述背包问题的一个版本，这是一个众所周知的 NP 完全问题。对于问题的 SMALL 版本，使用小的 N、M 和 k，您只需遍历所有不同的组合。对于较大的版本，没有已知的方法可以找到计算时间少于宇宙生命周期的“最佳”解决方案。

最接近解决这个问题的方法涉及一个称为线性规划的领域。这......不是一件简单的事情，但如果你愿意，你可以去阅读它。

# mysql - mySQL：使用“max”时获取行的其余数据

> ID：10507827
> 
> 赞同：3
> 
> 时间：2012-05-08T23:11:53.453
> 
> 标签：mysql

我有一个看起来有点像这样的表：

```
user_id   item_id   bid_amount
5         12        22
6         12        47
7         12        40
6         14        55 
```

我正在尝试获得每个项目的最高出价以及属于该出价的 user_id。我目前的尝试：

```
select user_id, max(bid_amount) from bids group by item_id; 
```

失败得相当壮观。我认为它只是他组中第一行的 user_id - 是否有一个查询可以让我获得我想要的数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:13:50.137

```
SELECT user_id, item_id, bid_amount FROM bids 
WHERE (item_id, bid_amount) IN (
   SELECT item_id, MAX(bid_amount) FROM bids GROUP BY item_id
) 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/f62a5/3)

# asp.net-mvc-3 - 如何在 Ajax 帖子中将 div 的 html 传递给 @Url.Action

> ID：10507829
> 
> 赞同：0
> 
> 时间：2012-05-08T23:12:05.367
> 
> 标签：asp.net-mvc-3, c#-4.0, jquery

# A. 到目前为止我成功的地方：

1.  我有 3 个 div”NewAction NewController NewArea

2.  我有一个 $.Ajax 帖子，其 url 当前如下 '@Url.Action("CurrentAction", "CurrentController", new { area = "CurrentArea" })'

3.  我有几个页面需要这个特定的 Ajax 帖子，所以我将 Ajax 帖子放在一个部分中，并且每个使用它的主页在部分调用中都有一个参数，例如：

    @Html.Partial("_PartialPage", new [] { "NewAction", "NewController", "NewArea" })

4.  上面 #1 中的 div 已成功使用 #3 中的字符串值动态填充

# B. 我的困难在哪里：

尽管进行了许多努力和尝试，但我无法将 #2 中的 @Url.Action 值更改为 #1 中 div 中的值。

我什至尝试声明 C# 私有变量并使用填充上述 div 的 foreach 填充它们，并将这些值传递给 @Url.Action 链接，但出现运行错误。

有谁知道我可以将部分调用（＃3）中的参数值传递给上面＃2中的Ajax帖子中的Url.Action方法的方法。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T06:14:50.337

您可以有一个方法来提取传递给这个强类型部分的值并构建 url：

```
@model string[]

@functions {
    public string GetUrl() {
        if (Model != null && Model.Length > 2)
        {
            var values = new RouteValueDictionary();
            values["controller"] = Model[0];
            values["action"] = Model[1];
            values["area"] = Model[2];
            return Url.RouteUrl(values);
        }
        return Url.Action("CurrentAction", "CurrentController", new { area = "CurrentArea" });
    }
}

<script type="text/javascript">
    var url = @Html.Raw(Json.Encode(GetUrl()));    
    $.ajax({
        url: url,
        type: 'POST',
        success: function(result) {
            // ...
        }
    });
</script> 
```

将呈现如下：

```
<script type="text/javascript">
    var url = "/NewArea/NewAction/NewController";
    $.ajax({
        url: url,
        type: 'POST',
        success: function(result) {
            // ...
        }
    });
</script> 
```

但是，如果您不需要单独使用这些路由值，另一种可能性是将整个 url 直接传递给局部视图：

```
@Html.Partial("_About", Url.Action("NewAction", "NewController", new { area = "NewArea" })) 
```

然后在部分内部简单地使用它：

```
@model string
<script type="text/javascript">
    var url = @Html.Raw(Json.Encode(Model));    
    $.ajax({
        url: url,
        type: 'POST',
        success: function(result) {
            // ...
        }
    });
</script> 
```

# jquery - Jquery 切换覆盖 preventdefault

> ID：10507832
> 
> 赞同：1
> 
> 时间：2012-05-08T23:12:51.830
> 
> 标签：jquery, toggle, preventdefault

嗨，我有一个隐藏在屏幕侧面的导航菜单，可以切换不幸的是它不允许我点击里面的锚链接（它只是切换，我可以做些什么来覆盖防止默认值并获取锚标签工作？

```
var one = {queue:true, duration:1250, easing: 'easeInOutExpo'};
var two = {queue:true, duration:1500, easing: 'easeInOutExpo'};

$('nav').toggle(
function()  { showMenu() },
function()  { hideMenu() });

$(window).bind('load', function() {
setTimeout ( 'hideMenu()', 1000 );
});

function hideMenu()
{
$('nav').animate({ left: '-=270' },  one);
$('#container').animate({ left: '-=270' }, two);
}
function showMenu()
{
$('nav').animate({ left: '+=270' },  one);
$('#container').animate({ left: '+=270' }, two);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:30:14.920

假设链接在`nav`元素内，并触发在该元素上设置的动画？

```
$('a', 'nav').on('click', function(e) {
    e.stopPropagation();
}); 
```

将停止点击锚点冒泡到`nav`元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:35:43.997

要使锚点起作用，它**必须**提供一个非空`href`属性

`.click()`你阻止这样的默认行为

```
$('a.optional-class').click(function(e){
    e.preventDefault(); // it's way more powerful than...
    // your code goes here
    return false; // ... than this
}); 
```

问题是上述两种技巧（？）以不同的方式工作，1）`.preventDefault()`只是告诉浏览器这个锚实际上不是一个锚，不应该被视为一个；阻止任何`<a />`操作 2)`return false`告诉浏览器用户实际上没有点击链接；这**不会**阻止滚动网站，如果

```
<a href="#some_id_here">
<!-- some code and height goes here... -->
<div id="some_id_here"></div> 
```

# php - get_browser() 返回 FALSE

> ID：10507833
> 
> 赞同：11
> 
> 时间：2012-05-08T23:13:07.987
> 
> 标签：php, browscap

*- 在 Linux 上运行 PHP 5.3.8-*

首先，我们已经解决了这个问题，直到函数返回预期值。但是，我仍然有很多未解决的问题，而且“解决方案”更像是一种破解方法。

我在这个问题上花了一天的大部分时间，所以请耐心等待我解释所做的事情。首先，问题在于 is 的返回值`get_browser()`，`FALSE`它不是记录在案的返回值。这使我假设`FALSE`返回意味着函数中存在某种错误状态。

测试代码，经过多次迭代，变成了一个简单的`var_dump(get_browser($agent, true))`. 我运行测试时直接传递用户代理字符串，以及不传递任何参数，例如`var_dump(get_browser())`，所有参数都具有相同的返回值。

已尝试/验证的内容，返回值没有变化：

**浏览器.ini：**

*   有最新版本，也测试了几个以前的版本

**权限：**

*   bowscap.ini - 初始权限为 644，但我尝试了 644-777 的所有权限

*   包含 browscap.ini 的目录 - 初始权限为 755，也尝试了 777

*   验证 PHP 可以使用其他功能访问文件和目录，例如`file()`

**用户代理**

*   尝试传递手动用户代理字符串

*   尝试通过 $_SERVER['HTTP_USER_AGENT']

*   与远方的朋友验证了我的用户代理字符串 -`get_browser()`按预期返回值。

**php.ini**

*   browscap 设置指向正确的位置

*   再次验证`echo count(file(ini_get('browscap')));`

**错误日志**

*   检查 PHP 和 Apache 错误日志中是否提及“browscap”或任何甚至密切相关的内容 - 没有什么不寻常的。

**文件结构**

这就是我怀疑错误的来源。browscap.ini 位于`/var/php/`，具有如上所述的适当权限。我的想法是 PHP 可能无法访问这个目录，或者类似的东西。但是，此目录也是存储会话的位置，因此不太可能。

**解决方案”**

解决该问题的方法是将 browscap.ini 移至公共 Web 目录。我很好奇为什么会这样，特别是考虑到未记录的返回值。“解决方案”有效，但不是我想我会找到的解决方案......

是否`get_browser()`有特殊权限要求或类似的要求？`file()`可以访问目录和文件就好了，但`get_browser()`不能（大概）。在这个问题上，我几乎已经把头发拉了出来，并且希望得到一些解决方案！

谢谢阅读！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T07:05:13.827

您已经尝试了所有必需的方法。

[http://php.net/manual/en/function.get-browser.php](http://php.net/manual/en/function.get-browser.php)注意：

> 为了使其工作，您的[browscap](https://php.net/manual/en/misc.configuration.php#ini.browscap)配置设置`php.ini`必须指向`browscap.ini`系统上文件的正确位置。
> 
> `browscap.ini`未与 PHP 捆绑，但您可以在此处找到最新的[php_browscap.ini](http://browscap.org/)文件。
> 
> 虽然`browscap.ini`包含许多浏览器的信息，但它依赖于用户更新来保持数据库最新。文件的格式是不言自明的。

* * *

> 解决该问题的方法是将 browscap.ini 移至公共 Web 目录。

它可能指向那个位置。即公共网络目录

> get_browser() 是否有特殊的权限要求或类似的要求？

仅需要读取权限。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-06T08:51:05.820

我遇到了与原始海报完全相同的问题。解决方案？php.ini 需要 browscap.ini 文件的绝对路径。

因此，即使 PHP 找到了该文件并且它出现在`phpinfo()`的输出中，以下行是问题所在：

```
browscap = browscap.ini 
```

用那条线，`getBrowser()`返回`false`。

但是，将其更改为绝对路径有效，如下所示：

```
browscap = /etc/browscap.ini 
```

希望这对某人有帮助！这是一个奇怪的...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-14T13:32:53.077

实际上，即使手册页上没有记录，该`get_browser`函数也可能`FALSE`由于多种原因返回。

至少看看[底层的源代码](http://lxr.php.net/xref/PHP_5_3/ext/standard/browscap.c#454)，让我们假设一下。

我建议你看看那里，然后让我知道你是否还有其他问题。那时我也许可以回答他们。

# symfony - gzip 使用 symfony2 压缩动态内容

> ID：10507844
> 
> 赞同：3
> 
> 时间：2012-05-08T23:14:14.540
> 
> 标签：symfony, gzip

告诉 symfony2 尊重 Web 浏览器发送的“Accept-Encoding”标头和（如果可能的话）gzip-compress 响应中呈现的内容是否容易/可能？

基于[http://developer.yahoo.com/performance/rules.html#gzip](http://developer.yahoo.com/performance/rules.html#gzip)这似乎是个好主意。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T14:03:08.217

如果您使用的是 Apache httpd，那么这很容易 - 只需在 httpd.conf 中启用 mod_deflate 模块并为不同类型添加 AddOutputFilterByType 行（更多信息：[http ://httpd.apache.org/docs/2.0/ mod/mod_deflate.html](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html)）。我不相信 symfony2 可以自己 gzip 一些东西，因为这通常是 web 服务器的工作。

# php - Kohana ORM 访问信息

> ID：10507846
> 
> 赞同：0
> 
> 时间：2012-05-08T23:14:21.103
> 
> 标签：php, orm, kohana

我正在尝试学习如何访问和显示信息。我有类别、论坛、主题和帖子。forums 属于类别，topics 属于论坛，posts 属于主题。我不知道如何访问帖子。

表：

```
categories {category_id, category_title}
forums {forum_id, forum_title}
categories_forums {id_category, id_forum}
topics {topic_id, topic_title}
forums_topics{id_forum, id_topic}
posts {post_id, post title}
topics_posts {id_topic, id_post} 
```

楷模：

```
class Model_Category extends ORM {

protected $_primary_key = 'category_id';

protected $_has_many = array(
    'forums'=> array(
        'model' => 'forum',               
        'through' => 'categories_forums',   
        'far_key' => 'id_forum',     
        'foreign_key' => 'id_category'  
    ),
  );
}

class Model_Forum extends ORM {

protected $_primary_key = 'forum_id';

 protected $_belongs_to = array(
    'categories'=> array(
        'model' => 'category',                
        'through' => 'categories_forums',   
        'far_key' => 'id_category',       
        'foreign_key' => 'id_forum'   
    ),
);

protected $_has_many = array(
    'topics'=> array(
        'model' => 'topic',                
        'through' => 'forums_topics',    
        'far_key' => 'id_topic',       
        'foreign_key' => 'id_forum'   
    ),
  );
}

class Model_Topic extends ORM {

protected $_primary_key = 'topic_id';

protected $_belongs_to = array(
    'forums'=> array(
        'model' => 'forum',                
        'through' => 'forums_topics',    
        'far_key' => 'id_forum',       
        'foreign_key' => 'id_topic'   
    ),
);

protected $_has_many = array(
    'posts'=> array(
        'model' => 'post',                
        'through' => 'topics_posts',    
        'far_key' => 'id_post',       
        'foreign_key' => 'id_topic'   
    ),
  );
}

class Model_Post extends ORM {

protected $_primary_key = 'post_id';

protected $_belongs_to = array(
    'topics'=> array(
        'model' => 'topic',                
        'through' => 'topics_posts',    
        'far_key' => 'id_topic',       
        'foreign_key' => 'id_post'   
    ),
  );
} 
```

到目前为止，我有以下内容：

```
foreach ($categories as $category) :
echo $category->category_title;
foreach ($category->forums->find_all() as $forum) :
echo $forum->forum_title;
$num_topics = $forum->topics->count_all(); echo $num_topics;
$num_posts = $forum->topics->posts->count_all(); echo $num_posts;
endforeach;
endforeach; 
```

问题是 echo $num_posts 显示 0。我猜我访问的帖子错误。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T07:57:54.000

1.  您必须迭代`topics`才能获得帖子。
2.  `count_all()`Kohana 重置模型后。

你必须这样做：

```
 $topics = $forum->topics->find_all()->as_array();

    $num_topics = count($topics);

    foreach($topics as $topic) 
    {
        $num_post_in_topic = $topic->posts->find_all()->count();
    } 
```

# apache - 如何从 Apache 将欢迎消息打印到控制台

> ID：10507847
> 
> 赞同：0
> 
> 时间：2012-05-08T23:14:21.457
> 
> 标签：apache, httpd.conf

我下载了 microapache 并注意到它在启动时有一个空控制台（Windows 机器，从 USB 记忆棒运行）

我想在控制台 dos 框中显示“欢迎！转到 localhost:8888 以查看我的应用程序”这一行。

是否可以在 httpd.conf 中为此定义一个条目，例如 "welcome_message "hello" " ？

**更新**：我的“go.bat”在 5 秒内关闭，所以我想在 apache 控制台中显示它，我的 go.bat 看起来像这样：

```
@echo off start /min "QueryTool" server/mapache.exe -w 
ping localhost -n 5 > nul 
@start "" /b "C:\Program Files\Internet Explorer\iexplore.exe" http://localhost:8888 
```

所以..这个关闭了，我想在“apache窗口”中显示一条消息，以防用户由于某种原因无法自动打开 localhost:8888。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:11:37.697

试试这个，它可能不是你想要的，但它是我能想到的最接近的：

去.bat

```
@echo off 
start launch.bat
ping localhost -n 5 > nul 
@start "" /b "C:\Program Files\Internet Explorer\iexplore.exe" http://localhost:8888 
```

创建一个名为 launch.bat 的新文件：

```
@echo off
echo Welcome! go to localhost:8888 to view my app
mapache.exe 
```

那有输出：

```
Welcome! go to localhost:8888 to view my app
Apache/1.3.37 (Win32) PHP/4.4.7 running... 
```

如果您只想显示消息，您可以执行以下操作：

```
@echo off 
start /min "QueryTool" server/mapache.exe -w 
ping localhost -n 5 > nul 
@start "" /b "C:\Program Files\Internet Explorer\iexplore.exe" http://localhost:8888
echo Welcome! go to localhost:8888 to view my app
@pause 
```

在这种情况下，go.bat 将在欢迎消息中保持打开状态，直到他们按任意键将其关闭。

# android - Eclipse 无法识别我的手机版本

> ID：10507850
> 
> 赞同：1
> 
> 时间：2012-05-08T23:14:53.557
> 
> 标签：android, eclipse

当我尝试在 Eclipse 中运行我的 android 项目时，我的手机出现了......但不是版本或其他任何东西。就好像完全没有认出来一样。这是一个屏幕截图

![在此处输入图像描述](../Images/cfa922ed16e4e0e80a1303a14cb603b0.png)

有什么建议么？我在手机上启用了 USB 调试，并从摩托罗拉的网站下载了正确的手机驱动程序。我有 droid 2 global。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:31:54.417

重置 ADB 并拔下/插入您的设备，直到它工作;）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T04:24:45.630

采取命令提示符。将目录更改为/android/platform-tools/ 运行以下命令，看看你的手机是否被ADB检测到

```
$adb devices 
```

如果找不到您的手机，请尝试卸载驱动程序并使用 PdaNet 安装驱动程序。还要更新 Android SDK 并确保您已在其中安装了 Google USB 驱动程序 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T04:12:51.737

在清单中试试这个：

```
<uses-sdk
    android:minSdkVersion="11"
    android:targetSdkVersion="17" /> 
```

它对我有用。

# jquery - jQuery设置元素的高度

> ID：10507853
> 
> 赞同：3
> 
> 时间：2012-05-08T23:15:19.680
> 
> 标签：jquery

如何使用 each() 方法将内部 div 的高度设置为其父级？

```
<div class="box">
    <div class="inner">Stuff</div>
</div>
<div class="box">
    <div class="inner">Stuff</div>
</div>
<div class="box">
    <div class="inner">Stuff</div>
</div>
<div class="box">
    <div class="inner">Stuff</div>
</div> 
```

这似乎不起作用：

```
$('.box').each(function(){
    var $this = $(this);
    var $inner = $this.find(".inner");
    $inner.height( $this.height );

}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T23:16:07.923

要获取元素的高度，您必须使用[**方法**](http://api.jquery.com/height/) `height()`：

```
$('.box').each(function(){
    var $this = $(this);
    var $inner = $this.find(".inner");
    $inner.height( $this.height() );
}); 
```

# grails - 如何在单元测试中针对 Spring Security 对用户进行身份验证

> ID：10507854
> 
> 赞同：10
> 
> 时间：2012-05-08T23:15:32.720
> 
> 标签：grails, spring-security

我正在使用带有 grails 2.0 的 spring 安全核心插件（1.2.7）

假设我有一个控制器，其方法使用 @Secured 注释。

```
class ArticleController {
    def springSecurityService

    @Secured(['ROLE_PREMIUM_USER'])
    def listPremium() { 
        render 'premium content'
    }
} 
```

在我的单元测试中，我想测试具有角色“ROLE_PREMIUM_USER”的用户是否可以看到 listPremium 方法的内容。我怎样才能做到这一点？

我知道它应该如下开始：

```
@TestFor(ArticleController)
@Mock([SpringSecurityService])
class ArticleControllerTests {
    void testListPremium() {
    defineBeans {
        springSecurityService(SpringSecurityService)
    }
         //but how to login the user here in order to see premium content?

        controller.listPremium()
        assert response.text() == 'premium content'
    }
} 
```

我不确定如何验证检查 ROLE_PREMIUM_USER 的用户或模拟操作。有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T21:32:37.473

您也许可以使用

```
SpringSecurityUtils.reauthenticate username, null 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T13:24:38.553

我们创建了自定义 AuthenticationHelper：

```
public final class AuthenticationHelper {

    public static Authentication authenticate(UserDetailsService userDetailsServiceImpl, String userName) {

        UserDetails userDetails = userDetailsServiceImpl.loadUserByUsername(userName);

        UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(userDetails, userDetails.getPassword());

        UsernamePasswordAuthenticationToken result = new UsernamePasswordAuthenticationToken(userDetails, token.getCredentials(), userDetails.getAuthorities());
        result.setDetails(token.getDetails());
        Authentication auth = result;

        SecurityContextHolder.getContext().setAuthentication(auth);
        auth = SecurityContextHolder.getContext().getAuthentication();

        Assert.assertTrue(auth.isAuthenticated());

        return auth;
    }
} 
```

重要的部分是：

```
SecurityContextHolder.getContext().setAuthentication(auth); 
```

# java - JDBC - 如何插入字符串值

> ID：10507857
> 
> 赞同：2
> 
> 时间：2012-05-08T23:16:06.823
> 
> 标签：java, mysql, sql, jdbc

当尝试使用 JDBC 将字符串的值插入我的数据库而不是插入字符串的值时，它会插入字符串的名称。

我有一个名为 firstName 的字符串，该字符串的值由用户输入给出。

这是我的sql语句：

```
String sql = "Insert INTO users (ID, firstName, address) VALUES ('124','+firstName()','123')"; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T23:19:03.867

由于各种原因，最好使用`java.sql.PreparedStatement`. 执行带参数的语句。例如，如果你想避免[sql 注入](http://en.wikipedia.org/wiki/SQL_injection)攻击。

请参阅[*The Java Tutorials中的*](http://docs.oracle.com/javase/tutorial/index.html)[*Using Prepared Statements*](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)中的示例。[](http://docs.oracle.com/javase/tutorial/index.html)

 *使用带参数的 SQL 语句的优点是您可以使用相同的语句并在每次执行时为其提供不同的值。

```
PreparedStatement pstmt = conn.prepareStatement(
   "UPDATE EMPLOYEES SET FIRST_NAME= ? WHERE ID = ?");

pstmt.setString(1, "user1080390"); // set parameter 1 (FIRST_NAME)
pstmt.setInt(2, 101); // set parameter 2 (ID)

int rows = pstmt.executeUpdate(); // "rows" save the affected rows 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:25:46.590

尝试这个

`String sql = "Insert INTO users (ID, firstName, address) VALUES ('124','"+firstName()+"','123')";`

为了防止 sql 注入，您需要在查询中使用之前对字符串进行转义或尝试准备好的语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T10:36:56.297

像这样的东西。。

```
String firstName ="sample";
String sql = "Insert INTO users (ID, firstName, address) VALUES ('124',"+firstName+",'123')"; 
```*

# javascript - 使用 Greasemonkey 为页面上的日期添加粗体标签？

> ID：10507860
> 
> 赞同：2
> 
> 时间：2012-05-08T23:16:11.537
> 
> 标签：javascript, jquery, regex, greasemonkey

我有一个打印 div 的 Greasemonkey 脚本——有效！但是，我希望能够在此 div 中的所有日期中添加粗体标签。

日期格式为 MM/DD/YYYY

所以像：

```
var regex = '\d{2}\/\d{2}\/\d{4}'; 
```

那么我将如何执行搜索替换？如果 div 被调用`loanTable`：

非工作概念：

```
$("#loanTable").html().replace( regex, "<b>" regex "</b>" ) 
```

像上面这样的东西应该可以工作，但我不确定它的确切语法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:37:12.590

使用[正则表达式捕获组](http://www.regular-expressions.info/javascript.html)：

```
var loanTable   = $("#loanTable")
var loanHTML    = loanTable.html ().replace (/(\d{2}\/\d{2}\/\d{4})/g, "<b>$1</b>");
loanTable.html (loanHTML); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:38:41.490

这段代码不是有效的 JS：

```
var regex = '\d{2}\/\d{2}\/\d{4}';
$("#loanTable").html().replace( regex, "<b>" regex "</b>" ) 
```

正则表达式的语法是`/regex/`，不带引号或`new Regex('regex')`带引号。

首先将 html 分配给一个变量。也`<b>`几乎不再使用了，`<strong>`是新标准。然后，`replace()`将正则表达式和字符串或函数作为参数。要多次替换，您必须使用该`g`标志。最后，要做你想做的事，你可以使用替换令牌，比如`$1`等等......

```
var re = /\d{2}\/\d{2}\/\d{4}/g; // 'g' flag for 'global';
var html = $("#loanTable").html();

$("#loanTable").html(html.replace(re, '<strong>$&</strong>')); // The `$&` token returns the whole match 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T00:12:34.203

上次我使用 GreaseMonkey 时，让 jQuery 在您的用户脚本中运行并不容易。

使用以下代码在没有 jQuery 的情况下执行此操作：

```
var loanTable = document.getElementById('loanTable');
loanTable.innerHTML = loanTable.innerHTML.replace(/(\d{1,2}\/\d{1,2}\/\d{4})/g, "<b>$1</b>"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T23:41:03.707

这其中的一个小方面：您需要使用`+`运算符连接字符串：

```
$("#loanTable").html().replace( regex, "<b>" + regex + "</b>" ) 
```

# computer-science - 寻找一组方程的解

> ID：10507863
> 
> 赞同：0
> 
> 时间：2012-05-08T23:16:56.737
> 
> 标签：computer-science, graph-theory, breadth-first-search, solver, equations

假设我在一些变量之间有一些已知的关系，例如`a = b + c`和一个起始解决方案，例如`a=2, b=1, c=1`。我正在编写一些代码，例如，给定更新`a=3`，我更新 and 的值，`b`以便`c`仍然满足关系，例如设置`b=2`（显然有很多可能性，我只需要*一个*）。

在实践中，有很多关系，它们不是线性的。该代码通过用户为每个变量提供函数作为其他变量的函数来工作，例如`a(b,c)`、`b(a,c)`和`c(a,b)`。然后我构建一个依赖关系图，当一个值发生变化时，我会执行广度优先搜索之类的操作来更新其他值。这似乎可行，但我不禁认为我正在重新发明轮子，这是一些众所周知的计算机科学/图论问题。也许甚至还有一个包裹？

谁能提供一些链接或一些关于我正在解决的问题的见解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T18:11:48.370

这看起来像是找到`F(a,b,c)=b+c-a`接近给定起点（例如`b=1, c=1`.）的多维函数（例如 ）的根

[Wiki](http://en.wikipedia.org/wiki/Root-finding_algorithm)页面描述了一种变量函数的求根方法，并具有指向更高维方法的链接。这些方法与多维优化问题有关。

有很多实现：[SciPy](http://docs.scipy.org/doc/scipy/reference/optimize.html)、[GNU](http://www.gnu.org/software/gsl/manual/html_node/Multidimensional-Root_002dFinding.html)、Mathematica、Matlab、...

# python - 如何使用 neo4jrestclient 创建具有 python 字典属性的节点？

> ID：10507864
> 
> 赞同：2
> 
> 时间：2012-05-08T23:17:01.923
> 
> 标签：python, dictionary, neo4j, neo4j.py

将键值存储从我的字典中获取到 neo4jrestclient 中的节点属性的最简单/最佳方法是什么？

我有一本字典

```
nodeDict = {"color":"Red", "width":16, "height":32} 
```

如何在节点创建期间将字典插入属性列表？

从 neo4jrestclient 文档页面，创建具有属性的节点的方法是

```
n = gdb.nodes.create(color="Red", widht=16, height=32) 
```

我可以遍历字典，为每个键值存储生成一个 JSON 请求，但这似乎是错误的。创建节点和分配属性应该使用单个 JSON 请求来完成，对吧？

我可以将字典转换为字符串，去掉花括号，并将冒号更改为等号，但这似乎也是错误的。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:05:12.553

我不知道 neo4j API；但鉴于您所描述的，[参数解包](http://docs.python.org/tutorial/controlflow.html#unpacking-argument-lists)应该可以完成这项工作：

```
n = gdb.nodes.create(**nodeDict) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T06:43:11.297

另外，我不确定 Neo4jRestClient 是否支持 Cypher，但你可以这样做[http://docs.neo4j.org/chunked/snapshot/query-create.html#create-create-single-node-from-地图](http://docs.neo4j.org/chunked/snapshot/query-create.html#create-create-single-node-from-map)，

```
create n = {props} 
```

并将 props 作为参数传入。

高温高压

# rm - 安装 Pow 时出现 rm 错误：“权限被拒绝”

> ID：10507866
> 
> 赞同：0
> 
> 时间：2012-05-08T23:17:24.333
> 
> 标签：rm, rack-pow

我想安装 Pow。`curl get.pow.cx | sh`在我的主目录中运行会产生：

```
*** Installing Pow 0.3.2...
rm: Current: Permission denied 
```

在前面添加`sudo`并没有改变任何东西。

希望这不是一个新手问题，并且与其他人相关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:50:07.423

您正在下载的 shell 脚本似乎`curl get.pow.cx`正在尝试删除名为 的目录/链接`Current`，但缺少足够的权限或目录/链接不存在。您可能需要从计算机上用户的主目录中执行操作。该程序将负责将文件放在相关目录中（至少应该如此）。

# c# - 计算当前（非平均）下载速度

> ID：10507870
> 
> 赞同：5
> 
> 时间：2012-05-08T23:17:54.037
> 
> 标签：c#, download, download-manager

在我的下载管理器应用程序中，我使用下面的代码来计算当前的传输速率：

```
 TimeSpan interval = DateTime.Now - lastUpdateTime;

        downloadSpeed = (int)Math.Floor((double)(DownloadedSize + cachedSize - lastUpdateDownloadedSize) / interval.TotalSeconds);

        lastUpdateDownloadedSize = DownloadedSize + cachedSize;
        lastUpdateTime = DateTime.Now; 
```

这主要以我想要的方式工作（我每 4 秒左右更新一次速度），但是随着下载率的波动，总会出现一些疯狂的峰值。我的平均下载速度约为 600 kB/s，有时会显示 10.25 MB/s 甚至是负值，例如 -2093848 B/s。这怎么可能？

计算实时下载率的最佳方法是什么？我对平均速率（DownloadedSize / TimeElapsed.TotalSeconds）不感兴趣，因为它没有给出现实的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T23:33:15.517

鉴于“实时”是无法实现的，您应该尝试模拟它，通过使间隔尽可能小和精确，并计算间隔内的平均值，检查代码中的完整性。例如：

```
DateTime now = DateTime.Now;
TimeSpan interval = now - lastUpdateTime;
timeDiff = interval.TotalSeconds;
sizeDiff = DownloadedSize + cachedSize - lastUpdateDownloadedSize;
speed = (int)Math.Floor((double)(sizeDiff) / timeDiff);
lastUpdateDownloadedSize = DownloadedSize + cachedSize;
lastUpdateTime = now; 
```

与您的代码的一个区别：

1.  现在只计算一次，使用两次。

# html - Div 背景图像 Z-Index 问题

> ID：10507871
> 
> 赞同：30
> 
> 时间：2012-05-08T23:18:14.813
> 
> 标签：html, css

我试图让我的内容的背景图像出现在页眉和页脚后面。目前，内容背景的顶部突出到页眉上，您可以看到底部略微覆盖了页脚（请注意页脚边框颜色的轻微变化）。我尝试将设置应用于`z-index:-100;`有效但也使文本无法选择的内容。然后我尝试应用`z-index:1;`到内容，但这并没有使内容出现在页眉/页脚下。

[链接到网站](http://www.sfu.ca/~jca41/stuph/la3/template.html)

![在此处输入图像描述](../Images/8cd69c3c044e2e5153a0bb455c0461fe.png)

```
//html
<div id="wrapper">
    <header>
        <div id="logo"></div>
        <nav>
            <ul>
                <li id="aboutNav"><a href="template.html">home</a></li>
                <li id="menuNav"><a href="">menu</a></li>
                <li id="specialsNav"><a href="">specials</a></li>
            </ul>
        </nav>  
    </header>
    <div id="content">
        content <br> goes <br> here <br>
        <a href="http://www.google.ca" target="_blank">google</a>
    </div>
</div>
<footer>
    <div id="thumbsDesc"></div>
    <div id="thumbs"></div>
</footer>

//css
header {
    width: 100%;
    height: 100px;
    background: url(../img/top.png) repeat-x;
    z-index: 110;
}

#wrapper #content {
    color: #FFFFFF;
    background: url(../img/body.png) repeat-y;
    width: 524px;
    padding: 25px 30px 25px 30px;
    position: absolute;
    bottom: 100px;
    top: 90px;
    margin: 0 0 0 150px;
    z-index: 1;
}

footer {
    margin: -107px 0 0 0;
    width: 100%;
    height: 107px;
    background: url(../img/bottom.png) repeat-x;
    z-index: 100;
} 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-05-08T23:22:21.237

为了解决这个问题，你在页脚和页眉上使用了 z-index，但是你忘记了位置，如果要使用 z-index，元素必须有一个位置：

**将此 CSS 添加到您的页脚和页眉：**

```
position: relative; 
```

**编辑：**

还注意到#backstretch 上的背景图像有一个负的z-index，不要使用它，有些浏览器会变得很奇怪......

**从#backstretch 中删除：**

```
z-index: -999999; 
```

在此处阅读有关[Z-Index 的一些信息！](http://www.w3schools.com/cssref/pr_pos_z-index.asp)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-08T23:22:35.640

要使 z-index 起作用，您还需要给它一个位置：

```
header {
    width: 100%;
    height: 100px;
    background: url(../img/top.png) repeat-x;
    z-index: 110;
    position: relative;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T23:22:39.600

将您的页眉和页脚位置设置为“绝对”，这应该可以解决问题。希望它对您的项目有所帮助并祝您好运！

# google-maps - Google Places API 返回稀疏结果与 Google Places iPhone 应用程序

> ID：10507872
> 
> 赞同：1
> 
> 时间：2012-05-08T23:18:33.663
> 
> 标签：google-maps, google-places-api

我正在构建一个应用程序，它使用 Google Places API 来显示我当前位置附近的餐馆。由于某种原因，与我从 Google Places iPhone 应用程序中看到的结果相比，结果非常稀疏。例如，在我农村的家中，Google Places 应用程序会显示 2.4 英里外的最近位置。此纬度/经度的 Places API 显示 15.7 英里外的最近位置。

是否有可能“Google Places”应用程序没有使用 Google Places API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:07:37.920

Google Places 应用程序不使用 Google Places API，因此您不会看到完全相同的结果，但您应该会看到类似的结果。

**使用 Places API 时的一些提示：**

*   默认情况下，Places API 将返回的结果按您选择`radius`的方式排序`prominence`，而不是`distance`。如果您想找到最近的地方，就像您正在尝试的那样，请在不带参数`rankby=distance`的查询中使用。`radius`

*   [根据文档](https://developers.google.com/maps/documentation/places/)，尝试使用`keyword`参数而不是“名称”参数：“关键字”参数与所有可用字段匹配，包括但不限于名称、类型和地址，以及客户评论和其他第三方-派对内容，这往往会返回更多结果。

如果您遵守这些提示，您很可能会获得与 Places App 类似的结果。

# c++ - 无法编译 C++ 构造函数

> ID：10507874
> 
> 赞同：2
> 
> 时间：2012-05-08T23:18:46.627
> 
> 标签：c++, constructor

谁能向我解释这段代码有什么问题以及如何修复它？这是一个更大项目的一部分，如果您需要更多信息以便给出答案，请告诉我。

我得到的错误是：

```
 g++ -c search.cpp
    search.cpp: In constructor ‘Search::Search()’:
    search.cpp:26:26: error: ‘callnumber’ was not declared in this scope
    make: *** [search.o] Error 1

Search::Search()
        {
            ifstream input;
            input.open("data.txt", ios::in);

            if(!input.good())
                //return 1;
            string callnumber;
            string title;
            string subject;
            string author;
            string description;
            string publisher;
            string city;
            string year;
            string series;
            string notes;

            while(! getline(input, callnumber, '|').eof())
            {   
                getline(input, title, '|');
                getline(input, subject, '|');
                getline(input, author, '|');
                getline(input, description, '|');
                getline(input, publisher, '|');
                getline(input, city, '|');
                getline(input, year, '|');
                getline(input, series, '|');
                getline(input, notes, '|');

            Book *book = new Book(callnumber, title, subject, author, description, publisher, city, year, series, notes);
            Add(book);
            }   

                input.close();

        } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-08T23:20:50.353

在这条线上：

```
if(!input.good())
    //return 1;
string callnumber; 
```

您用分号注释掉了该行并且您没有使用大括号，并且 C++ 在标记之间的空格和换行符¹对空格不敏感，因此通过删除注释（并添加缩进）我们可以看到相当于

```
if (!input.good())
    string callnumber; 
```

我们可以看到 的声明`callnumber`是本地的`if`. 添加大括号或分号以使声明位于`callnumber`外部`if`（或完全删除它）：

```
if (!input.good()) { // or ;
    //return 1;
}
string callnumber; 
```

* * *

¹宏除外

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T23:21:40.007

因为你评论了这一行

```
if(!input.good())
    //return 1; 
```

字符串 callnumber 仅在该范围内声明，在其外部无法使用。

也删除 if 语句或取消注释返回行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T23:22:42.423

```
 if(!input.good())
            //return 1;
        string callnumber; 
```

有效地

```
 if(!input.good()) {
            //return 1;
            string callnumber;
        } 
```

因为注释掉的`//return 1;`不是声明。所以`callnumber`被创建然后立即消失在范围之外。

# regex - 使用正则表达式的 Javascript getTextBetweenTags 函数

> ID：10507880
> 
> 赞同：0
> 
> 时间：2012-05-08T23:19:58.307
> 
> 标签：regex

我有以下功能来获取标签之间的文本，但它也在重新处理标签，所以任何人都告诉我正则表达式中的错误。

String.prototype.getTextBetweenTags = function (tagname) {

```
var pattern = "<" + tagname + " ?.*>(.*)</" + tagname + ">";  
return this.match(pattern)[0]; 
```

}

返回`<title>hello</title>`

应该只返回**Hello**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:21:24.767

结果的第一个元素是整个字符串。元素 1 是第一个捕获组的内容。

试试这个：

```
return this.match(pattern)[1]; 
```

另外，不要使用正则表达式来解析 HTML。您的正则表达式可能会以数百种方式破坏。

# php - 分解字符串并检查数据库是否有重复

> ID：10507882
> 
> 赞同：-2
> 
> 时间：2012-05-08T23:20:20.037
> 
> 标签：php, mysql

如何获取一个字符串`business, jquery, css`和`explode`该字符串并检查 mySQL 数据库以查看每个单词是否已经在数据库条目中？

谢谢，鼓手392

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:23:13.803

```
$string = "business, jquery, css";
$exploded = explode(",", $string);

$result = /* database select query */

foreach ($exploded as $value) {
    // $value contains the value being processed
    // compare $result to $value and do what's needed

} 
```

PHP 手册：[explode()](http://ca3.php.net/explode)

希望这能让您了解您需要做什么。

**编辑：**感谢 Chris 建议先进行数据库查询

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:25:58.650

`explode`使用带有“，”分隔符的PHP函数，分配给一个新的数组变量。

我会改进上一个答案，我觉得在 foreach 循环*之外使用 SELECT 查询会更好。*然后您将避免执行相同的查询 3 次。

```
$result = /* database select query */
foreach ($exploded as $value) {
    // compare $result to $value and do what's needed
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T23:28:08.983

```
$conn = mysql_connect("localhost", "mysql_user", "mysql_password");
mysql_select_db("database", $conn);

$string  = "business, query, css";
$array = explode(", ", $string);

foreach($array as $str){

    $result = mysql_query("SELECT * FROM tableName WHERE columnName='$str'", $conn);
    $num_rows = mysql_num_rows($result);

    if($num_rows > 0)
        //found
    else
        //not found
} 
```

# javascript - Node.js 与 Geddy：geddy.string.uuid(x) 是否确保字符串是唯一的？

> ID：10507886
> 
> 赞同：1
> 
> 时间：2012-05-08T23:21:18.320
> 
> 标签：javascript, node.js, geddy

我正在学习使用 Node.js 和 Geddy 制作简单应用程序的教程。对于每个新条目，它都会设置条目 ID，`geddy.string.uuid(10)`并且似乎不运行任何其他检查。我担心的是，当创建一个新条目时，这可能会生成与前一个条目相同的 ID，如果 id 已经存在，本教程中的保存脚本将覆盖/更新一个条目。

我知道如果它可能发生，这将是一种罕见的情况，但我认为如果可以的话，让这件事发生是不负责任的。我知道在 PHP 中我会进行某种检查以确保它是唯一的，并且只是想知道 Geddy 是否已经为我这样做了，因为教程似乎不担心它？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:25:56.073

uuid 不会发生两次。

从技术上讲，有 340,282,366,920,938,463,463,374,607,431,768,211,456（16 的 32 次方）中的一个概率会出现重复。Geddy 的 uuid 函数（与大多数其他函数一样）使用 32 个十六进制数字（128 位）的随机位。请参阅[http://en.wikipedia.org/wiki/Universally_unique_identifier#Random_UUID_probability_of_duplicates](http://en.wikipedia.org/wiki/Universally_unique_identifier#Random_UUID_probability_of_duplicates)。基本上，你不会得到重复的。

附带说明一下，有趣的是，您在这里传递了 10 个 uuid `geddy.string.uuid(10)`：. 在[最新版本的 getty string.js](http://mde.github.com/geddy/doc/symbols/src/lib_utils_string.js.html)中，uuid 不带参数，因此 10 将被忽略。

```
148   this.uuid = function () {
149     var chars = _UUID_CHARS, uuid = [], rnd=0, r;
150     for (var i = 0; i < 36; i++) {
151       if (i==8 || i==13 ||  i==18 || i==23) {
152         uuid[i] = '-';
153       } else {
154         if (rnd <= 0x02) rnd = 0x2000000 + (Math.random()*0x1000000)|0;
155         r = rnd & 0xf;
156         rnd = rnd >> 4;
157         uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];
158       }
159     }
160     return uuid.join('');
161   }; 
```

如果您的 geddy 版本中的 10 将十六进制数字的数量限制为 10，那么您发生碰撞的机会只有 1,099,511,627,776（1 万亿）分之一。这仍然不太可能，尽管它可能会被迫找到重复的 id。

# c++ - 带有 Visual Studio 2010 的 libzip

> ID：10507893
> 
> 赞同：13
> 
> 时间：2012-05-08T23:21:55.170
> 
> 标签：c++

是否有为 Visual Studio 2010 编译 libzip 的文档？我从 libzip 网站和 Google 看到的所有内容都没有返回任何结果。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-09T00:33:11.460

### 编辑：

在开始此处提供的答案之前，这似乎不再是@Thomas Klausner 下面的[答案](https://stackoverflow.com/a/12239625/424459)的问题。

* * *

以下应该为您提供 VS10 解决方案：

1.  如果您还没有这样做，请安装[CMake](http://www.cmake.org/cmake/resources/software.html)

2.  [下载zlib](http://www.zlib.net/)并将其解压缩到例如`C:\devel`. 下载链接位于主页的一半左右。目前这提供了 zlib 版本 1.2.7。

    *   要解决此仅影响 64 位 Windows 的[CMake 错误，请添加](http://public.kitware.com/Bug/view.php?id=11240)

        ```
        if(CMAKE_SIZEOF_VOID_P EQUAL 8 AND MSVC)
          set_target_properties(zlibstatic PROPERTIES STATIC_LIBRARY_FLAGS "/machine:x64")
        endif() 
        ```

        到 C:\devel\zlib-1.2.7\CMakeLists.txt 结尾

3.  下载并解压[libzip](http://www.nih.at/libzip/)到 eg`C:\devel`

4.  在**VS10 命令提示符下**，`cd C:\devel\zlib-1.2.7`

5.  `mkdir build && cd build`

6.  `cmake .. -G"Visual Studio 10" -DCMAKE_INSTALL_PREFIX="C:\devel\installed\zlib"` 这会将安装路径设置为`C:\devel\installed\zlib`而不是默认的`C:\Program Files\zlib`. 对于 64 位 Windows，`"Visual Studio 10 Win64"`用作`-G`参数。

7.  `msbuild /P:Configuration=Debug INSTALL.vcxproj`

8.  `msbuild /P:Configuration=Release INSTALL.vcxproj`

9.  `cd C:\devel\libzip-0.10.1`

10.  `mkdir build && cd build`

11.  `cmake .. -G"Visual Studio 10" -DCMAKE_PREFIX_PATH="C:\devel\installed\zlib"` 将路径设置为安装 zlib 的位置，以便 CMake 可以找到 zlib 的包含文件和库。同样，对于 64 位 Windows，`"Visual Studio 10 Win64"`请用作`-G`参数。

这应该导致`C:\devel\libzip-0.10.1\build\libzip.sln`. 看起来代码中存在一些特定于 POSIX 的问题，但它们应该很容易解决（例如，在 zipconf.h 中`#include <inttypes.h>`需要替换为`#include <stdint.h>`；有些`snprintf`调用需要替换为，例如`_snprintf`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-02T20:47:46.970

我无法发表评论，所以除了弗雷泽的回答：在过去的几天里，libzip 的最新存储库版本应该在 VS 上编译而无需额外的补丁。请尝试一下，让开发人员知道是否仍然缺少部件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-28T15:50:29.123

无法评论上面的答案，但试图让它工作，最后发现配置属性下的输出目录和调试中的命令。

您可以删除 ALL_BUILD、ZERO_CHECK、INSTALL 和 PACKAGE，它将构建良好，而不会出现任何链接错误或 linux 特定错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-05-14T19:04:51.607

使用 libzip-1.0.1、zlib-1.2.8 和 VS Community 2013。

添加到路径：

C:\Program Files (x86)\CMake\bin;C:\Windows\Microsoft.NET\Framework64\v4.0.30319

cmake 行变成：

```
cmake .. -G"Visual Studio 12 Win64" -DCMAKE_INSTALL_PREFIX="C:\devel\installed\zlib" 
```

devel\libzip-1.0.1\lib\zip_source_filep.c:189 更改：

```
mask = umask(S_IXUSR | S_IRWXG | S_IRWXO); 
```

到：

```
mask = umask(_S_IREAD | _S_IWRITE); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-12-11T12:52:22.603

使用

*   zlib-1.2.8 路径的环境变量`%ZLIB_DIR%`，
*   `%LIBZIP_DIR%`对于 libzip-1.0.1 的路径
*   VS 2015 速成版，和
*   `%LIBZIP_DIR%/lib/zip_source_filep.c`根据[http://hg.nih.at/libzip/rev/80457805a1e7](http://hg.nih.at/libzip/rev/80457805a1e7)修补的文件，

构建 zlib 和 libzip 的过程变成了这样：

### 构建 zlib

```
> cd /d %ZLIB_DIR% && md build & cd build
> cmake .. -G"Visual Studio 14 2015 Win64"- DCMAKE_INSTALL_PREFIX="%ZLIB_DIR%"
> msbuild /P:Configuration=Debug INSTALL.vcxproj
> msbuild /P:Configuration=Release INSTALL.vcxproj 
```

### 构建 libzip

```
> cd /d %LIBZIP_DIR% && md build & cd build
> cmake .. -G"Visual Studio 14 2015 Win64" -DCMAKE_PREFIX_PATH="%ZLIB_DIR%"
> msbuild /P:Configuration=Debug ALL_BUILD.vcxproj
> msbuild /P:Configuration=Release ALL_BUILD.vcxproj 
```

完毕！

（所以你看，[@MikeLischke](https://stackoverflow.com/questions/10507893/libzip-with-visual-studio-2010#comment32632229_12239625)，CMake 有时确实可以开箱即用......）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-16T16:19:36.307

在当前的 zlib 版本中，对此有一个贡献：

`zlib-1.2.8\contrib\vstudio\vc10\zlibvc.sln`

我在加载时遇到错误，因为其中一个配置在我的机器上无效，但重新编译解决了这个问题。我还必须更改项目属性>`Configuration Properties>Linker>Input>Additional Dependencies`以将 Debug 配置更改`zlibwapi.lib`为`zlibwapid.lib`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-31T21:06:18.523

在 Visual Studio 2015、Win64 中：

如果构建 libzip 失败并显示如下消息：

```
Could NOT find ZLIB (missing: ZLIB_LIBRARY) (found version "1.2.8"). 
```

您所要做的就是将生成的“zlib.dll/zlibd.zll”和“zlib.lib/zlibd.lib”复制到 zlib 目录的顶部（.h/.c 文件所在的位置）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-23T15:33:17.267

Christian Severin 给出的答案对我帮助很大，但需要对 VS2019 和 32 位进行一些更新：

*   使用 VS 2019 构建时，必须使用 -A 选项，而不是使用“Win64”。
*   使用 VS 2019 构建时，32 位存档是“Win32”，而不是 x86。
*   “Building zlib”部分有错字，必须是`Win64" -DCMAKE_...`，破折号前有一个空格

这是一个使用 VS2019 和 32 位构建的工作示例：

```
cd /d %ZLIB_DIR% && md build & cd build
cmake .. -G"Visual Studio 16 2019" -DCMAKE_INSTALL_PREFIX="%ZLIB_DIR%" -AWin32
msbuild /P:Configuration=Release INSTALL.vcxproj
cd /d %LIBZIP_DIR% && md build & cd build
cmake .. -G"Visual Studio 16 2019" -DCMAKE_INSTALL_PREFIX="%ZLIB_DIR%" -AWin32
msbuild /P:Configuration=Release ALL_BUILD.vcxproj 
```

# asp.net-mvc - 将 Castle Windsor 与 SignalR 集成 - 我应该如何处理？

> ID：10507894
> 
> 赞同：8
> 
> 时间：2012-05-08T23:22:04.227
> 
> 标签：asp.net-mvc, castle-windsor, signalr

我开始使用 SignalR，一旦配置好一切，它就可以很好地工作。但是，我所开发的几乎所有应用程序都使用 Castle Windsor，因此能够将它们一起使用会很棒。我想这样做的原因是我可以在持久连接中使用 Castle 依赖项/服务。

我仔细研究了源代码，看起来我可以用基于 Castle 的替代 DependencyResolver（即，实现 IDependencyResolver 的 Castle），或者我可以将 DependencyResolver 的用法更改为 Castle。

其中哪一个是更好的主意？我可以使用另一种方法来结合 Castle 和 SignalR 吗？

谢谢，埃里克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T10:31:24.577

# 2016 年 8 月更新

根据评论，我不再使用下面的方法，但现在使用 GlobalHost.DependencyResolver

所以在 Global.asax.cs 我初始化的东西

```
public static void Init(IWindsorContainer container)
{
    var conn = configurationManager.ConnectionStrings["SRSQL"].ConnectionString;
    GlobalHost.DependencyResolver.Register(typeof(IHubActivator), 
                                      () => new SignalHubActivator(container));
    GlobalHost.DependencyResolver.Register(typeof(ILoggingService), 
                                      container.Resolve<ILoggingService>);
    //etc or you could just pass your existing container to the resolver
    GlobalHost.DependencyResolver.UseSqlServer(conn);    
} 
```

然后在集线器

```
private ILoggingService LoggingService{ get; set; }

    public NotificationHub()
    {
        LoggingService = GlobalHost.DependencyResolver.Resolve<ILoggingService>();
    } 
```

并且为了完整性

```
public class SignalHubActivator: IHubActivator
{
    private readonly IWindsorContainer _container;

    public SignalHubActivator(IWindsorContainer container)
    {
        _container = container;
    }

    public IHub Create(HubDescriptor descriptor)
    {
                var result=  _container.Resolve(descriptor.HubType) as IHub;

        if (result is Hub)
        {
            _container.Release(result);
        }

    return result;
    }

} 
```

### 2012年的旧答案

我选择了设置我们自己的 DependencyResolver 的第一个选项

```
AspNetHost.SetResolver(new SignalResolver(_container)); 
```

如果需要，我可以提供 SignalResolver，但现在不考虑可读性。

另一个重要的注意事项是集线器必须有一个空的构造函数，以便我们的城堡容器通过属性注入，例如

```
public class NotificationHub : Hub, INotificationHub
    { 

public INotificationService NotificationService { get; set; } 
```

和请求的解析器

```
public class SignalResolver : DefaultDependencyResolver
    {
        private readonly IWindsorContainer _container;

        public SignalResolver(IWindsorContainer container) 
        {
            if (container == null)
            {
                throw new ArgumentNullException("container");
            }
            _container = container;
        }

        public override object GetService(Type serviceType) 
        {
            return TryGet(serviceType) ?? base.GetService(serviceType);
        }

        public override IEnumerable<object> GetServices(Type serviceType)
        {
            return TryGetAll(serviceType).Concat(base.GetServices(serviceType));
        }

        private object TryGet(Type serviceType)
        {
            try
            {
                return _container.Resolve(serviceType);
            }
            catch (Exception)
            {
                return null;
            }
        }

        private IEnumerable<object> TryGetAll(Type serviceType)
        {
            try
            {
                var array = _container.ResolveAll(serviceType);
                return array.Cast<object>().ToList();
            }
            catch (Exception)
            {
                return null;
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T21:34:56.533

这就是我最终做的事情。首先，我跟随 Windsor wiki 获取我的 ASP.NET MVC3 设置。我的 Global.asax.cs：

```
private static IWindsorContainer _container;

    protected void Application_Start()
    {
        BootstrapContainer();
        RegisterRoutes(RouteTable.Routes);
        AreaRegistration.RegisterAllAreas();
        RegisterGlobalFilters(GlobalFilters.Filters);
    }

    protected void Application_End()
    {
        _container.Dispose();
    }

    private static void BootstrapContainer()
    {
        _container = new WindsorContainer().Install(FromAssembly.This());
        RouteTable.Routes.MapHubs(new CastleWindsorDependencyResolver(_container));
        var controllerFactory = new WindsorControllerFactory(_container.Kernel);
        ControllerBuilder.Current.SetControllerFactory(controllerFactory);
    }
    ... 
```

CastleWindsorDependencyResolver 来自[这里](https://github.com/AGiorgetti/SignalR.Castle.Windsor/blob/master/SignalR.Castle.Windsor/CastleWindsorDependencyResolver.cs)

复制：

```
public class CastleWindsorDependencyResolver : DefaultDependencyResolver
{
    private readonly IWindsorContainer _container;

    public CastleWindsorDependencyResolver(IWindsorContainer container)
    {
        if (container == null)
        {
            throw new ArgumentNullException("container");
        }

        _container = container;

        // perform the lazy registrations
        foreach (var c in _lazyRegistrations)
            _container.Register(c);

        _lazyRegistrations.Clear();
    }

    public override object GetService(Type serviceType)
    {
        if (_container.Kernel.HasComponent(serviceType))
            return _container.Resolve(serviceType);
        return base.GetService(serviceType);
    }

    public override IEnumerable<object> GetServices(Type serviceType)
    {
        IEnumerable<object> objects;
        if (_container.Kernel.HasComponent(serviceType))
            objects = _container.ResolveAll(serviceType).Cast<object>();
        else
            objects = new object[] { };

        var originalContainerServices = base.GetServices(serviceType);
        if (originalContainerServices != null)
            return objects.Concat(originalContainerServices);

        return objects;
    }

    public override void Register(Type serviceType, Func<object> activator)
    {
        if (_container != null)
            // cannot unregister components in windsor, so we use a trick
            _container.Register(Component.For(serviceType).UsingFactoryMethod<object>(activator, true).OverridesExistingRegistration());
        else
            // lazy registration for when the container is up
            _lazyRegistrations.Add(Component.For(serviceType).UsingFactoryMethod<object>(activator));

        // register the factory method in the default container too
        //base.Register(serviceType, activator);
    }

    // a form of laxy initialization is actually needed because the DefaultDependencyResolver starts initializing itself immediately
    // while we now want to store everything inside CastleWindsor, so the actual registration step have to be postponed until the
    // container is available
    private List<ComponentRegistration<object>> _lazyRegistrations = new List<ComponentRegistration<object>>();
}

public static class WindsorTrickyExtensions
{
    /// <summary>
    /// Overrideses the existing registration:
    /// to overide an existiong component registration you need to do two things:
    /// 1- give it a name.
    /// 2- set it as default.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="componentRegistration">The component registration.</param>
    /// <returns></returns>
    public static ComponentRegistration<T> OverridesExistingRegistration<T>(this ComponentRegistration<T> componentRegistration) where T : class
    {
        return componentRegistration
        .Named(Guid.NewGuid().ToString())
        .IsDefault();
    }
} 
```

我不确定 HubsInstaller 是否试图从同一个项目中执行 WTF，但我自己制作了似乎工作正常的WTF（我当然愿意接受任何建议，为什么这会很糟糕）：

```
public class HubsInstallers : IWindsorInstaller
{
    public void Install(IWindsorContainer container, IConfigurationStore store)
    {
        container.Register(Classes.FromThisAssembly()
                            .BasedOn<IHub>()
                            .LifestyleTransient());
    }
} 
```

这也适用于较新的 SignalR 版本 0.5+

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-29T16:34:42.807

[鸽子的答案](https://stackoverflow.com/a/10549707/229052)很好，但有点令人困惑，添加了另一个更具体的答案。我的主要目标是这样工作：

```
[HubName("MyHub")]
public class MyHub : Hub
{
    public IJobRepository JobRepository { get; }

    public MyHub(IJobRepository jobRepository)
    {
        JobRepository = jobRepository ?? throw new ArgumentNullException(nameof(jobRepository));
    }
...
} 
```

当然，您想要的是为您创建集线器，它们通常由 SignalR 创建，但现在它们具有一些依赖关系，SignalR 无法创建它们。SignalR 本身有一个 Dependency Resolver（在 SignalR 命名空间中），用于获取自己的依赖项，您可以向其中添加内容，但我们希望 Windsor 还记得吗？所以我们将改变`IHubActivator`创建集线器的方式，我们不会使用 SignalR，而是使用这个：

```
public class SignalRHubActivator : IHubActivator
{
    private readonly IWindsorContainer _container;

    public SignalRHubActivator(IWindsorContainer container)
    {
        _container = container;
    }

    public IHub Create(HubDescriptor descriptor)
    {
        var result = _container.Resolve(descriptor.HubType) as IHub;
        if (result is Hub)
        {
            _container.Release(result);
        }
        return result;
    }
} 
```

要在 SignalR 容器中替换它，您必须执行以下操作：

```
// Get an instance of the hub creator (see note below)
var _hubActivator = new SignalRHubActivator(container);

// Get the SignalR's Default Dependency Resolver
var signalRResolver = new Microsoft.AspNet.SignalR.DefaultDependencyResolver();
// Override the IHubActivator service
signalRResolver.Register(typeof(IHubActivator), () => _hubActivator);
// now map SignalR with this configuration
appBuilder.MapSignalR(new HubConfiguration { Resolver = signalRResolver }); 
```

就是这样，您还应该在 Windsor 注册您的所有集线器

```
container.Register(Classes.FromThisAssembly()
    .BasedOn(typeof(Microsoft.AspNet.SignalR.Hub)));
...
container.Register(Component.For<IJobRepository>()).ImplementedBy<JobRepository>()); 
```

**注意：**我也将 SignalRHubActivator 注册为组件，这是因为`Startup`我使用的类接收激活器作为依赖项：

```
container.Register(Component.For<SignalRHubActivator>().
    DependsOn(Dependency.OnValue("container", container))); 
```

# php - 让 TextWrangler 将 drupal 文件识别为 PHP？

> ID：10507905
> 
> 赞同：0
> 
> 时间：2012-05-08T23:23:19.433
> 
> 标签：php, drupal, textwrangler

我正在编写一些 drupal 模块等，我希望 textwrangler 为我做语法高亮。这些文件是 PHP 文件，但它们需要不同的扩展名才能与 drupal（即`.module`）一起使用。我在自定义扩展映射中添加了“.module”-> PHP，但它没有像我的 .php 文件那样做任何语法突出显示。我重新启动了 TextWrangler，但它不起作用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:45:31.460

我自己也在尝试，但这也是我能从他们那里找到的全部。

如果您发现文件扩展名没有映射到您想要的语言，只需将其添加到“自定义扩展名映射”列表中。如果存在冲突，自定义映射将始终优先于内置映射。

来自 Bare Bones—— [http://www.barebones.com/support/textwrangler/current_notes.html](http://www.barebones.com/support/textwrangler/current_notes.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:51:31.620

我有一个类似的问题。我最终转到窗口的左下角，然后从该特定文件的下拉列表中选择 PHP。这种方法对我来说效果很好。

我认为 TextWrangler 记得旧的语法突出显示，因此如果您在更改扩展名之前打开文件，那么它为什么现在没有更改。只是猜测（不是事实）。

# c# - WCF 对象类型格式化程序错误

> ID：10507908
> 
> 赞同：1
> 
> 时间：2012-05-08T23:24:03.187
> 
> 标签：c#, wcf, web-services, serialization, soapui

我在我的 WCF 服务中使用以下数据协定，当我的客户端是 C# 控制台应用程序时它可以工作

```
[DataContract]
public class PersonField
{
    private string _fieldName;
    private object _fieldValue;

    public PersonField()
    {
    }

    public PersonField(string FieldName, object FieldValue)
    {
        _fieldName = FieldName;
        _fieldValue = FieldValue;
    }
    [DataMember]
    public string FieldName
    {
        get { return _fieldName; }
        set { _fieldName = value; }
    }
    [DataMember]
    public object FieldValue
    {
        get { return _fieldValue; }
        set { _fieldValue = value; }
    }
} 
```

但

当我从 SOAP UI(http://www.soapui.org/) 尝试它时，我得到以下响应

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
   <s:Body>
      <s:Fault>
         <faultcode xmlns:a="http://schemas.microsoft.com/net/2005/12/windowscommunicationfoundation/dispatcher">a:DeserializationFailed</faultcode>
         <faultstring xml:lang="en-US">The formatter threw an exception while trying to deserialize the message: There was an error while trying to deserialize parameter entities. The InnerException message was 'Element FieldValue from namespace http://schemas.datacontract.org/2004/07/Entities.Person cannot have child contents to be deserialized as an object. Please use XmlNode[] to deserialize this pattern of XML.'.  Please see InnerException for more details.</faultstring>
      </s:Fault>
   </s:Body>
</s:Envelope> 
```

我不能在 WCF 中使用类型对象吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:53:00.590

For SoapUI it does not know what types could be in `object`. You have to define the known types so that the schema (WSDL) exposes them to SoapUI. Have a look at [this MSDN article](http://msdn.microsoft.com/en-us/library/ms730167.aspx)

You should have something like

```
[DataContract]
[KnownType(typeof(Type1))]
[KnownType(typeof(Type2))]
public class PersonField { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:52:11.277

我没有尝试过，但我认为你不能。如果实体是对象类型，则无法明确指定合同，因为您无法提前知道类型，正如预期的那样。

# entity-framework - EF Code First Migration with Multiple Database / DbContext

> ID：10507910
> 
> 赞同：8
> 
> 时间：2012-05-08T23:24:10.290
> 
> 标签：entity-framework, code-first, entity-framework-migrations, multiple-databases

我有两个数据库，每个数据库都有自己的 dbcontext。我已经设置了两个迁移配置。我可以为第一个数据库添加迁移（`Add-Migration DB1_InitialCreate -ConfigurationTypeName DB1Configuration`）。当我尝试使用第二个数据库创建初始迁移时：`Add-Migration DB2_InitialCreate -ConfigurationTypeName DB2Configuration`，我收到以下错误：

> 无法生成显式迁移，因为以下显式迁移处于挂起状态：[201205082215265_DB1_InitialCreate]。在尝试生成新的显式迁移之前应用挂起的显式迁移。

所以我按照它说的做并更新数据库：

```
Update-Database -ConfigurationTypeName DB1Configuration 
```

然后我尝试再次为第二个数据库添加迁移，但我不断收到同样的错误。

关于如何让迁移适用于两个数据库/上下文的任何想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-09T17:50:48.423

我已经能够回答我自己的问题了。我的两个配置类存在于同一个命名空间中。我一将它们分开，一切就正常了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-19T23:07:46.830

使用**Entity Framework 6**，这很容易。

对于一个数据库的多个 DbContexts 和每个自己的数据库的多个 DbContexts 都是相同的过程：

`Enable-Migrations -ContextTypeName <DbContext-Name-with-Namespaces> -MigrationsDirectory:<Migrations-Directory-Name>`

`Add-Migration -configuration <DbContext-Migrations-Configuration-Class-with-Namespaces> <Migrations-Name>`

`Update-Database -configuration <DbContext-Migrations-Configuration-Class-with-Namespaces> -Verbose`

[来源](http://www.codeproject.com/Tips/801628/Code-First-Migration-in-Multiple-DbContext)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-18T13:06:07.007

已经有一段时间了，但这可能是您问题的更好答案:)

```
Update-Database -ConfigurationTypeName "SlaveConfiguration"
                -StartupProjectName "FacturatieMVCv2.Data" -Verbose 
                -ConnectionString "connstring;" 
                -ConnectionProviderName "System.Data.SqlClient" 
```

# javascript - 对闭包内对象的赋值行为类似于指针

> ID：10507914
> 
> 赞同：0
> 
> 时间：2012-05-08T23:24:41.000
> 
> 标签：javascript, closures

我在 javascript 闭包中偶然发现了一个非常奇怪的行为。如果闭包的“全局”变量是一个对象，那么从它到另一个变量的任何赋值都表现得像某种指针。一个简单的代码应该更好地解释我的意思：

```
function closure() {      
  var foo = {key1 : 'value 1'};
  return {
    method: function(){
      var bar = foo;
      bar.key2 = 'value2';
      return 'foo has attributes : ' + foo.key1 + ' and ' + foo.key2
    }
  }
}  
var someVar = closure();
someVar.method();  // returns "foo has attributes : value 1 and value2" (!!!) 
```

我显然希望获得`foo has attributes : value 1 and undefined`只是`bar`被修改过的......但是，脚本实际上修改了两者`bar`并且`foo`让我很困惑。

我还注意到，当`foo`和`bar`是字符串或数字时，一切都按预期工作 - 修改`bar`不会影响`foo`.

```
function closure() {
  var foo = 10;
  return {
    method: function(){
      var bar = foo; 
      bar += 1;
      return 'foo is : ' + foo + ' and bar is ' + bar
    }
  }
}
var someVar = closure();
someVar.method(); // returns "foo is : 10 and bar is 11" 
```

我花了整个晚上试图找出这种行为的原因......没有运气。我得到了相同的结果是 SpiderMonkey 和 V8（在 Chrome 和 node.js 上）。

我要做的当然是在不影响 foo 的情况下修改第一个示例中的 bar。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:28:08.900

当你这样做时`var bar = foo;`，两者`bar`和`foo`都指向同一个对象。如果您不想`foo`更改，则需要*克隆* `foo`. 当你克隆时，你会得到一个全新的对象，并且`bar`会指向它。[这个答案](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-clone-a-javascript-object)有一些关于在 Javascript 中克隆对象的信息。

此外，此行为不限于闭包。它将发生在常规的 Javascript 代码中：

```
var foo = {a: 10, b: 6};
var bar = foo; 
bar.c = 7;
console.log(foo); 
```

将显示**为**`foo`具有属性`a`,`b`和。 **`c`**

 **您所看到的是大多数面向对象语言的标准行为。当您处理对象时，您处理的是对这些对象的*引用*，而不是特定的实例值。您看不到数字，因为在 Javascript 中它们是原始类型，因此您处理的是实际值而不是对这些值的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T23:30:59.170

这是几乎所有面向对象语言的完全正常的预期行为，当然是我能想到的所有动态语言。变量保存对对象的引用，而不是对象本身。它就像一个指针，但从内存位置的细节中抽象出来；你不能对它或任何东西做算术。就使用它而言，看起来变量直接保存了对象，但事实并非如此。如果将对象传递给函数，即使 JavaScript 是按值传递的，该函数也可以修改该对象。如果你将它分配给另一个变量，你不会得到一个副本，而是一个别名：两个变量指向同一个对象。

如果你想复制，你必须明确地这样做。没有内置的方法可以自动执行此操作，但请参阅[此问题](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-clone-a-javascript-object)以获取一些选项。**

# objective-c - If 语句 - 某个值或更多

> ID：10507918
> 
> 赞同：-5
> 
> 时间：2012-05-08T23:25:43.840
> 
> 标签：objective-c

我有一个应用程序，我希望它只在 int 值是某个数字或更高的情况下做一些事情，我似乎无法弄清楚如何去做，如果它正好是数量，我可以做，但如果它更多.

例如，我的 int 值为 0，每次按下按钮时它都会上升，当它变为 20 或更高时，我希望它在按下另一个按钮时执行某些操作。

感谢他的帮助！

```
- (IBAction)storeTroll:(id)sender {
    if (count == 20) {
        trollButton.hidden = NO;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:35:36.520

```
Operator    Description
x == y  Returns true if x is equal to y
x > y   Returns true if x is greater than y
x >= y  Returns true if x is greater than or equal to y
x < y   Returns true if x is less than y
x <= y  Returns true if x is less than or equal to y
x != y  Returns true if x is not equal to y 
```

所以，使用 >= ：

```
- (IBAction)storeTroll:(id)sender {
    if (count >= 20) {
        trollButton.hidden = NO;
    }
} 
```

# android - Android NDK代码的反汇编

> ID：10507923
> 
> 赞同：-2
> 
> 时间：2012-05-08T23:26:04.610
> 
> 标签：android, eclipse, gcc, android-ndk, arm

> **可能重复：**
> [如何从 gcc 中的 C/C++ 源代码获取汇编程序输出？](https://stackoverflow.com/questions/137038/how-do-you-get-assembler-output-from-c-c-source-in-gcc)

我有一个简单的问题。

我有一些为 Android 应用程序编写的本机 C++ 代码。

当我在 Eclipse 中编译我的项目时，有什么办法可以看到我的 GCC 编译器生成了哪些汇编代码？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T08:01:20.407

你可以通过多种方式做到这一点。

1.  将 -S 标志添加到`LOCAL_CFLAGS`您的`Android.mk`. 然后`run ndk-build`。但这将在第一个文件上失败，因此您不会在以后的文件中获得汇编代码。
2.  `arm-linux-androideabi-gcc -S file.cpp`从命令行手动调用所需文件。此外，您可能需要传递正确的包含定义。运行`ndk-build V=1`以查看它使用的命令行
3.  正常运行构建以获取共享库（.so 文件）。并运行`arm-linux-androideabi-objdump -d libYourLibrary.so >disasm.txt`。这将分解整个库，而不仅仅是一个 .cpp 文件。

# javascript - 使用多个命名选择器整合 jQuery 函数

> ID：10507924
> 
> 赞同：0
> 
> 时间：2012-05-08T23:26:20.757
> 
> 标签：javascript, jquery

我正在寻找一种类似于 PHP 中的 switch 函数的技术，因此我可以将单个函数用于多个命名选择器。将根据调用函数的选择器添加额外的代码。

我的示例是“保存并关闭”按钮旁边的“保存”按钮，后者具有关闭手风琴的附加代码。

如果单击“保存”按钮，它将调用：

```
 $('form[name=experienceForm]').submit(function(eve) {

            eve.preventDefault();
            tinyMCE.triggerSave();

            var FormData = $(this).serialize();
            var requestThis = $(this);
            var inputCom = $(this).find('input[name=inputCom]').val();
            var inputTitle = $(this).find('input[name=inputTitle]').val();

                $.ajax({
                        type : 'POST',
                        url : '<?php echo site_url('resume/update'); ?>',
                        data: FormData,
                        dataType: "html",
                        context : $(this),
                        success : function(msg){
                        requestThis.closest('.item').children('h3').children('a').text(inputCom+' : '+inputTitle);

                        if(msg != '') {

                        showNotice(msg);
                        }

                        },

                        error: function(msg){
                        alert('FAIL '+msg);
                        }
                    }); 

    }); 
```

我希望“保存并关闭”按钮执行与上述相同的操作，并添加以下内容：

```
 $('input[name=experienceClose]').click(function(eve) {

        eve.preventDefault();
        tinyMCE.triggerSave();          
        $(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().accordion({active:"false"});
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:38:08.023

不知道我得到了这个问题，但是开关功能会这样做吗，他们也有它们在 Javascript 中吗？

```
$('input[name=experienceClose], form[name=experienceForm]').on('click submit', function(e) {
    e.preventDefault();
    tinyMCE.triggerSave();  

    switch ($(this).attr('name')) {   //based on the buttons name
        case 'experienceClose' : //would be the name of the save and close button
            //do something for save and close button
        break;
        case 'experienceForm' :  //would be the name of the save only button
            //do something for save button only
        break;
        default:
            //do something on neither of the above
    }
}); 
```

另一方面，如果只有两个按钮，则 if/else 语句可能更合适。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:08:35.867

假设按钮将匹配一个模式，就像`name="experience*"`你可以做这样的事情：

```
// just save the form
function save(e)  { 
    // all the stuff to do in either case
}

// just close it
function close() {
    // death by a thousand parents
}

// use "on" instead of older jQuery constructs
$('form').on('click', '[name^="experience"]', function(e) {
    switch(this.name) {
        case 'experienceSave':
            save.call(this,e);
            break;
        case 'experienceForm':
            save.call(this,e);
            close();
            break;
        default: 
           throw 'Why am i here?';
     }
}); 
```

这是怎么回事：

1) 选择器获取任何具有以“经验”`name`开头的属性的东西。`^=`

2)`this`在事件处理程序中是被点击的元素。

3)`switch`在 Javascript 中与任何类 C 语言相同。

4）在这样的事情中抛出错误是件好事。如果您没有`default`案例并添加了一些恰好与选择器匹配的标记，那么如果没有默认值，它只会静默失败。当不应该发生的事情发生时抛出错误，使调试更容易。如果您担心真正的用户看到错误，那么当您投入生产时添加一个全局`window.onerror`处理程序，该处理程序会在静默失败之前向您发送电子邮件或其他内容:)

# winapi - GetPrivateProfileString - 缓冲区长度

> ID：10507927
> 
> 赞同：9
> 
> 时间：2012-05-08T23:26:48.790
> 
> 标签：winapi, ini

Windows 的 GetPrivateProfileXXX 函数（用于处理 INI 文件）在处理缓冲区长度方面有一些奇怪的规则。

GetPrivateProfileString 的文档指出：

> 如果 [..] 提供的目标缓冲区太小而无法容纳请求的字符串，则该字符串将被截断并后跟一个空字符，并且返回值等于 nSize 减一。

我读了这篇文章，我意识到这种行为使得无法区分代码中的两种场景：

*   当值字符串的长度正好等于 nSize - 1 时。
*   当nSize 值（即缓冲区）太小时。

我以为我会做实验：

我在 INI 文件中有这个：

```
[Bar]
foo=123456 
```

我用这些参数调用了 GetPrivateProfileString 作为测试：

```
// Test 1\. The buffer is big enough for the string (16 character buffer).
BYTE* buffer1 = (BYTE*)calloc(16, 2); // using 2-byte characters ("Unicode")
DWORD result1 = GetPrivateProfileString(L"Bar", L"foo", NULL, buffer, 16, fileName);

// result1 is 6
// buffer1 is { 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 0, 0, 0, 0, ... , 0, 0 }

// Test 2\. The buffer is exactly sufficient to hold the value and the trailing null (7 characters).
BYTE* buffer2 = (BYTE*)calloc(7, 2);
DWORD result2 = GetPrivateProfileString(L"Bar", L"foo", NULL, buffer, 7, fileName);

// result2 is 6\. This is equal to 7-1.
// buffer2 is { 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 0, 0 }

// Test 3\. The buffer is insufficient to hold the value and the trailing null (6 characters).
BYTE* buffer3 = (BYTE*)calloc(6, 2);
DWORD result3 = GetPrivateProfileString(L"Bar", L"foo", NULL, buffer, 6, fileName);

// result3 is 5\. This is equal to 6-1.
// buffer3 is { 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 0, 0 } 
```

调用此代码的程序无法确定实际键值的长度是否确实为 5 个字符，甚至是 6 个字符，因为在最后两种情况下，结果等于 nSize - 1。

唯一的解决方案是检查 result == nSize - 1 并使用更大的缓冲区调用函数，但在缓冲区大小正好合适的情况下，这是不必要的。

没有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T23:39:48.923

没有更好的办法。只需尝试确保第一个缓冲区足够大。解决此问题的任何方法都必须使用文档中未描述的内容，因此无法保证正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-02-03T19:36:08.477

当我致力于将一些古老的代码带入未来时，我发现了这个关于缓冲和私有配置文件 API 的问题。经过我自己的实验和研究，我可以确认提问者关于无法确定字符串何时恰好为 nSize - 1 或缓冲区太小之间的差异的原始陈述。

有没有更好的办法？Mike 接受的回答说没有根据文档，您应该*尝试*确保缓冲区足够大。Marc 说要增加缓冲区。Roman 说检查错误代码。一些随机用户说您需要提供一个足够大的缓冲区，并且与 Marc 不同的是，它继续显示一些扩展他的缓冲区的代码。

有没有更好的办法？让我们了解事实！

由于 ProfileString API 的年代久远，因为这个问题的所有标签都不涉及任何特定语言并且为了便于阅读，我决定使用 VB6 来展示我的示例。随意为您自己的目的翻译它们。

* * *

**GetPrivateProfileString 文档**

根据[GetPrivateProfileString 文档](https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getprivateprofilestring)，提供这些 Private Profile 函数只是为了与基于 Windows 的 16 位应用程序兼容。这是很好的信息，因为它使我们能够了解这些 API 函数可以做什么的限制。

16 位有符号整数的范围为 -32,768 到 32,767，无符号 16 位整数的范围为 0 到 65,535。如果这些函数真的是为在 16 位环境中使用而设计的，那么我们遇到的任何数字很可能都会被限制在这两个限制之一。

该文档指出，返回的每个字符串都将以空字符结尾，并且还说不适合提供的缓冲区的字符串将被截断并以空字符终止。因此，如果一个字符串确实适合缓冲区，则倒数第二个字符以及最后一个字符都将为空。如果只有最后一个字符为空，则提取的字符串与提供的缓冲区的长度完全相同 - 1 或缓冲区不够大以容纳字符串。

在倒数第二个字符不为空的情况下，提取的字符串的长度准确或对于缓冲区来说太大，GetLastError 将返回错误号[234 ERROR_MORE_DATA (0xEA)](https://docs.microsoft.com/en-us/windows/desktop/debug/system-error-codes--0-499-)，使我们无法区分它们。

* * *

**GetPrivateProfileString 接受的最大缓冲区大小是多少？**

虽然文档没有说明最大缓冲区大小，但我们已经知道这个 API 是为 16 位环境设计的。经过一些实验，我可以得出结论，最大缓冲区大小为**65,536**. 如果文件中的字符串大于 65,535 个字符，我们会在尝试读取字符串时开始看到一些奇怪的行为。如果文件中的字符串长度为 65,536 个字符，则检索到的字符串长度为 0 个字符。如果文件中的字符串长度为 65,546 个字符，则检索到的字符串长度为 10 个字符，以空字符结尾并从文件中包含的字符串的最开头截断。API 将写入大于 65,535 个字符的字符串，但无法读取大于 65,535 个字符的任何内容。如果缓冲区长度为 65,536 且文件中的字符串长度为 65,535 个字符，则缓冲区将包含文件中的字符串，并且还以单个空字符结尾。

这为我们提供了第一个虽然不是完美的解决方案。如果您想始终确保您的第一个缓冲区足够大，请将该缓冲区设置为 65,536 个字符长。

```
Private Declare Function GetPrivateProfileString Lib "kernel32" Alias "GetPrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long

Public Function iniRead(ByVal Pathname As String, ByVal Section As String, ByVal Key As String, Optional ByVal Default As String) As String
    On Error GoTo iniReadError
    Dim Buffer As String
    Dim Result As Long
    Buffer = String$(65536, vbNullChar)
    Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, 65536, Pathname)
    If Result <> 0 Then
        iniRead = Left$(Buffer, Result)
    Else
        iniRead = Default
    End If
iniReadError:
End Function 
```

* * *

现在我们知道了最大缓冲区大小，我们可以使用**文件的大小**来修改它。如果您的文件长度小于 65,535 个字符，则可能没有理由创建如此大的缓冲区。

在文档的备注部分中，它说初始化文件中的一个部分必须具有以下形式：

> [部分]
> 键=字符串

我们可以假设每个部分都包含两个方括号和一个等号。经过一个小测试，我能够验证 API 是否可以接受节和键之间的任何类型的换行符（vbLf、vbCr 或 vbCrLf / vbNewLine）。这些细节以及节和键名的长度将允许我们缩小最大缓冲区长度，并确保文件大小足以在我们尝试读取文件之前包含一个字符串。

```
Private Declare Function GetPrivateProfileString Lib "kernel32" Alias "GetPrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long

Public Function iniRead(ByVal Pathname As String, ByVal Section As String, ByVal Key As String, Optional ByVal Default As String) As String
    On Error Resume Next
    Dim Buffer_Size As Long
    Err.Clear
    Buffer_Size = FileLen(Pathname)
    On Error GoTo iniReadError
    If Err.Number = 0 Then
        If Buffer_Size > 4 + Len(Section) + Len(Key) Then
            Dim Buffer As String
            Dim Result As Long
            Buffer_Size = Buffer_Size - Len(Section) - Len(Key) - 4
            If Buffer_Size > 65535 Then
                Buffer_Size = 65536
            Else
                Buffer_Size = Buffer_Size + 1
            End If
            Buffer = String$(Buffer_Size, vbNullChar)
            Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, Buffer_Size, Pathname)
            If Result <> 0 Then
                iniRead = Left$(Buffer, Result)
                Exit Function
            End If
        End If
    End If
    iniRead = Default
iniReadError:
End Function 
```

* * *

**增加缓冲区**

现在我们已经非常努力地确保第一个缓冲区足够大，并且我们已经修改了最大缓冲区大小，对我们来说，从较小的缓冲区开始并逐渐增加缓冲区的大小来创建可能仍然更有意义一个足够大的缓冲区，我们可以从文件中提取整个字符串。根据文档，API 会创建 234 错误来告诉我们还有更多可用数据。他们使用这个错误代码告诉我们用更大的缓冲区重试是很有意义的。一遍又一遍地重试的缺点是它的成本更高。文件中的字符串越长，读取它所需的尝试次数越多，花费的时间就越长。64 KB 对于今天的计算机来说并不算多，而且今天的计算机速度非常快，

我已经对 GetPrivateProfileString API 进行了相当多的搜索，我发现通常当没有广泛了解 API 的人尝试创建足够大的缓冲区以满足他们的需求时，他们选择 255 的缓冲区长度。这将允许您可以从文件中读取最多 254 个字符的字符串。我不确定为什么有人开始使用它，但我假设有人在某个地方想象这个 API 使用缓冲区长度限制为 8 位无符号数的字符串。也许这是WIN16的限制。

除非最大缓冲区长度更小，否则我将从 64 字节的低缓冲区开始，然后将数字翻两番，直到最大缓冲区长度或 65,536。将数字加倍也是可以接受的，更大的乘法意味着更少尝试读取更大字符串的文件，而相对而言，一些中等长度的字符串可能有额外的填充。

```
Private Declare Function GetPrivateProfileString Lib "kernel32" Alias "GetPrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long

Public Function iniRead(ByVal Pathname As String, ByVal Section As String, ByVal Key As String, Optional ByVal Default As String) As String
    On Error Resume Next
    Dim Buffer_Max As Long
    Err.Clear
    Buffer_Max = FileLen(Pathname)
    On Error GoTo iniReadError
    If Err.Number = 0 Then
        If Buffer_Max > 4 + Len(Section) + Len(Key) Then
            Dim Buffer As String
            Dim Result As Long
            Dim Buffer_Size As Long
            Buffer_Max = Buffer_Max - Len(Section) - Len(Key) - 4
            If Buffer_Max > 65535 Then
                Buffer_Max = 65536
            Else
                Buffer_Max = Buffer_Max + 1
            End If
            If Buffer_Max < 64 Then
                Buffer_Size = Buffer_Max
            Else
                Buffer_Size = 64
            End If
            Buffer = String$(Buffer_Size, vbNullChar)
            Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, Buffer_Size, Pathname)
            If Result <> 0 Then
                If Buffer_Max > 64 Then
                    Do While Result = Buffer_Size - 1 And Buffer_Size < Buffer_Max
                        Buffer_Size = Buffer_Size * 4
                        If Buffer_Size > Buffer_Max Then
                            Buffer_Size = Buffer_Max
                        End If
                        Buffer = String$(Buffer_Size, vbNullChar)
                        Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, Buffer_Size, Pathname)
                    Loop
                End If
                iniRead = Left$(Buffer, Result)
                Exit Function
            End If
        End If
    End If
    iniRead = Default
iniReadError:
End Function 
```

* * *

**改进的验证**

根据您的实现，改进对路径名、部分和键名的验证可能会阻止您需要准备缓冲区。

根据[维基百科的 INI 文件页面](https://en.wikipedia.org/wiki/INI_file)，他们说：

> 在 Windows 实现中，密钥不能包含字符等号 (=) 或分号 (;)，因为它们是保留字符。该值可以包含任何字符。

和

> 在 Windows 实现中，该部分不能包含字符右括号 ( ] )。

对 GetPrivateProfileString API 的快速测试证明这只是部分正确。只要分号不在开头，我就可以在键名中使用分号。他们没有在文档或维基百科中提及任何其他限制，尽管可能还有更多限制。

查找 GetPrivateProfileString 接受的部分或键名的最大长度的另一个快速测试给了我 65,535 个字符的限制。使用大于 65,535 个字符的字符串的效果与我在测试最大缓冲区长度时的体验相同。另一项测试证明，此 API 将接受一个空白字符串作为部分或键名。根据 API 的功能，这是一个可接受的初始化文件：

> []
> =你好世界！

根据维基百科，对空格的解释各不相同。在又一次测试之后，Profile String API 肯定会从部分和键名中去除空格，所以如果我们也这样做可能没问题。

```
Private Declare Function GetPrivateProfileString Lib "kernel32" Alias "GetPrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long

Public Function iniRead(ByVal Pathname As String, ByVal Section As String, ByVal Key As String, Optional ByVal Default As String) As String
    On Error Resume Next
    If Len(Pathname) <> 0 Then
        Key = Trim$(Key)
        If InStr(1, Key, ";") <> 1 Then
            Section = Trim$(Section)
            If Len(Section) > 65535 Then
                Section = RTrim$(Left$(Section, 65535))
            End If
            If InStr(1, Section, "]") = 0 Then
                If Len(Key) > 65535 Then
                    Key = RTrim$(Left$(Key, 65535))
                End If
                If InStr(1, Key, "=") = 0 Then
                    Dim Buffer_Max As Long
                    Err.Clear
                    Buffer_Max = FileLen(Pathname)
                    On Error GoTo iniReadError
                    If Err.Number = 0 Then
                        If Buffer_Max > 4 + Len(Section) + Len(Key) Then
                            Dim Buffer As String
                            Dim Result As Long
                            Dim Buffer_Size As Long
                            Buffer_Max = Buffer_Max - Len(Section) - Len(Key) - 4
                            If Buffer_Max > 65535 Then
                                Buffer_Max = 65536
                            Else
                                Buffer_Max = Buffer_Max + 1
                            End If
                            If Buffer_Max < 64 Then
                                Buffer_Size = Buffer_Max
                            Else
                                Buffer_Size = 64
                            End If
                            Buffer = String$(Buffer_Size, vbNullChar)
                            Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, Buffer_Size, Pathname)
                            If Result <> 0 Then
                                If Buffer_Max > 64 Then
                                    Do While Result = Buffer_Size - 1 And Buffer_Size < Buffer_Max
                                        Buffer_Size = Buffer_Size * 4
                                        If Buffer_Size > Buffer_Max Then
                                            Buffer_Size = Buffer_Max
                                        End If
                                        Buffer = String$(Buffer_Size, vbNullChar)
                                        Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, Buffer_Size, Pathname)
                                    Loop
                                End If
                                iniRead = Left$(Buffer, Result)
                                Exit Function
                            End If
                        End If
                    End If
                    iniRead = Default
                End If
            End If
        End If
    End If
iniReadError:
End Function 
```

* * *

**静态长度缓冲区**

有时我们需要存储具有最大长度或静态长度的变量。用户名、电话号码、颜色代码或 IP 地址是您可能希望限制最大缓冲区长度的字符串示例。必要时这样做可以节省您的时间和精力。

在下面的代码示例中，Buffer_Max 将被限制为 Buffer_Limit + 1。如果限制大于 64，我们将从 64 开始并像以前一样扩展缓冲区。小于 64 并且我们只会使用我们的新缓冲区限制读取一次。

```
Private Declare Function GetPrivateProfileString Lib "kernel32" Alias "GetPrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long

Public Function iniRead(ByVal Pathname As String, ByVal Section As String, ByVal Key As String, Optional ByVal Default As String, Optional Buffer_Limit As Long = 65535) As String
    On Error Resume Next
    If Len(Pathname) <> 0 Then
        Key = Trim$(Key)
        If InStr(1, Key, ";") <> 1 Then
            Section = Trim$(Section)
            If Len(Section) > 65535 Then
                Section = RTrim$(Left$(Section, 65535))
            End If
            If InStr(1, Section, "]") = 0 Then
                If Len(Key) > 65535 Then
                    Key = RTrim$(Left$(Key, 65535))
                End If
                If InStr(1, Key, "=") = 0 Then
                    Dim Buffer_Max As Long
                    Err.Clear
                    Buffer_Max = FileLen(Pathname)
                    On Error GoTo iniReadError
                    If Err.Number = 0 Then
                        If Buffer_Max > 4 + Len(Section) + Len(Key) Then
                            Dim Buffer As String
                            Dim Result As Long
                            Dim Buffer_Size As Long
                            Buffer_Max = Buffer_Max - Len(Section) - Len(Key) - 4
                            If Buffer_Limit > 65535 Then
                                Buffer_Limit = 65535
                            End If
                            If Buffer_Max > Buffer_Limit Then
                                Buffer_Max = Buffer_Limit + 1
                            Else
                                Buffer_Max = Buffer_Max + 1
                            End If
                            If Buffer_Max < 64 Then
                                Buffer_Size = Buffer_Max
                            Else
                                Buffer_Size = 64
                            End If
                            Buffer = String$(Buffer_Size, vbNullChar)
                            Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, Buffer_Size, Pathname)
                            If Result <> 0 Then
                                If Buffer_Max > 64 Then
                                    Do While Result = Buffer_Size - 1 And Buffer_Size < Buffer_Max
                                        Buffer_Size = Buffer_Size * 4
                                        If Buffer_Size > Buffer_Max Then
                                            Buffer_Size = Buffer_Max
                                        End If
                                        Buffer = String$(Buffer_Size, vbNullChar)
                                        Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, Buffer_Size, Pathname)
                                    Loop
                                End If
                                iniRead = Left$(Buffer, Result)
                                Exit Function
                            End If
                        End If
                    End If
                    iniRead = Default
                End If
            End If
        End If
    End If
iniReadError:
End Function 
```

* * *

**使用 WritePrivateProfileString**

为确保使用 GetPrivateProfileString 读取字符串没有问题，请在使用 WritePrivateProfileString 之前将字符串限制为 65,535 个或更少字符。包含相同的验证也是一个好主意。

```
Private Declare Function GetPrivateProfileString Lib "kernel32" Alias "GetPrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long
Private Declare Function WritePrivateProfileString Lib "kernel32" Alias "WritePrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpString As Any, ByVal lpFileName As String) As Long

Public Function iniRead(ByVal Pathname As String, ByVal Section As String, ByVal Key As String, Optional ByVal Default As String, Optional Buffer_Limit As Long = 65535) As String
    On Error Resume Next
    If Len(Pathname) <> 0 Then
        Key = Trim$(Key)
        If InStr(1, Key, ";") <> 1 Then
            Section = Trim$(Section)
            If Len(Section) > 65535 Then
                Section = RTrim$(Left$(Section, 65535))
            End If
            If InStr(1, Section, "]") = 0 Then
                If Len(Key) > 65535 Then
                    Key = RTrim$(Left$(Key, 65535))
                End If
                If InStr(1, Key, "=") = 0 Then
                    Dim Buffer_Max As Long
                    Err.Clear
                    Buffer_Max = FileLen(Pathname)
                    On Error GoTo iniReadError
                    If Err.Number = 0 Then
                        If Buffer_Max > 4 + Len(Section) + Len(Key) Then
                            Dim Buffer As String
                            Dim Result As Long
                            Dim Buffer_Size As Long
                            Buffer_Max = Buffer_Max - Len(Section) - Len(Key) - 4
                            If Buffer_Limit > 65535 Then
                                Buffer_Limit = 65535
                            End If
                            If Buffer_Max > Buffer_Limit Then
                                Buffer_Max = Buffer_Limit + 1
                            Else
                                Buffer_Max = Buffer_Max + 1
                            End If
                            If Buffer_Max < 64 Then
                                Buffer_Size = Buffer_Max
                            Else
                                Buffer_Size = 64
                            End If
                            Buffer = String$(Buffer_Size, vbNullChar)
                            Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, Buffer_Size, Pathname)
                            If Result <> 0 Then
                                If Buffer_Max > 64 Then
                                    Do While Result = Buffer_Size - 1 And Buffer_Size < Buffer_Max
                                        Buffer_Size = Buffer_Size * 4
                                        If Buffer_Size > Buffer_Max Then
                                            Buffer_Size = Buffer_Max
                                        End If
                                        Buffer = String$(Buffer_Size, vbNullChar)
                                        Result = GetPrivateProfileString(Section, Key, vbNullString, Buffer, Buffer_Size, Pathname)
                                    Loop
                                End If
                                iniRead = Left$(Buffer, Result)
                                Exit Function
                            End If
                        End If
                    End If
                    iniWrite Pathname, Section, Key, Default
                    iniRead = Default
                End If
            End If
        End If
    End If
iniReadError:
End Function

Public Function iniWrite(ByVal Pathname As String, ByVal Section As String, ByVal Key As String, ByVal Value As String) As Boolean
    On Error GoTo iniWriteError
    If Len(Pathname) <> 0 Then
        Key = Trim$(Key)
        If InStr(1, Key, ";") <> 1 Then
            Section = Trim$(Section)
            If Len(Section) > 65535 Then
                Section = RTrim$(Left$(Section, 65535))
            End If
            If InStr(1, Section, "]") = 0 Then
                If Len(Key) > 65535 Then
                    Key = RTrim$(Left$(Key, 65535))
                End If
                If InStr(1, Key, "=") = 0 Then
                    If Len(Value) > 65535 Then Value = Left$(Value, 65535)
                    iniWrite = WritePrivateProfileString(Section, Key, Value, Pathname) <> 0
                End If
            End If
        End If
    End If
iniWriteError:
End Function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T23:50:25.740

不，不幸的是，没有更好的方法。您必须提供足够大的缓冲区。如果不够，请重新分配缓冲区。[我从这里](http://social.msdn.microsoft.com/Forums/zh/vclanguage/thread/87805f6a-43b7-4c7e-a09b-f8ecf710af6f)拿了一个代码片段，并适应了你的情况：

```
int nBufferSize = 1000;
int nRetVal;
int nCnt = 0;
BYTE* buffer = (BYTE*)calloc(1, 2); 

do
{
    nCnt++;
      buffer = (BYTE*) realloc (buffer , nBufferSize * 2 * nCnt);
      DWORD nRetVal = GetPrivateProfileString(L"Bar", L"foo", NULL,         
            buffer, nBufferSize*nCnt, filename);    
} while( (nRetVal == ((nBufferSize*nCnt) - 1)) || 
            (nRetVal == ((nBufferSize*nCnt) - 2)) ); 
```

但是，在您的特定情况下，文件名的长度不能大于 MAX_PATH，因此`(MAX_PATH+1)*2`总是合适的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-13T16:05:29.717

我知道这有点晚了，但我想出了一个很棒的解决方案。如果没有剩余缓冲区空间（返回长度 + 1 = 缓冲区长度），则增大缓冲区并再次获取值。重复该过程，直到有剩余的缓冲区空间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-10T21:34:02.207

`GetLastError`也许，马上打电话`GetPrivateProfileString`是一种方法。如果缓冲区足够大并且没有其他错误，`GetLastError`则返回 0。如果缓冲区太小，则`GetLastError`返回`234 (0xEA) ERROR_MORE_DATA`。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-02-07T09:45:42.700

最好的解决方案肯定是 Brogan 的，但是检查文件大小作为缓冲区大小的上限是错误的。尤其是在处理位于 Windows 或系统文件夹中的 INI 文件时，许多映射到注册表中的键被读取和/或写入。映射结构见：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\IniFileMapping 
```

有关其工作原理的完整说明，您可以阅读[文档的](https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-getprivateprofilestring#remarks)[备注部分`GetPrivateProfileString`](https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-getprivateprofilestring#remarks)。

因此，您可以将许多字符串重新映射到足够长的注册表，但磁盘上只有一个小的 INI 文件。在这种情况下，解决方案无法读取。

当不使用所需文件的绝对路径或它不在程序的当前工作目录中时，该解决方案还有另一个小问题，因为`GetPrivateProfileStrings`在 Windows 目录中搜索初始化文件。此操作不在`FileLen`函数中，解决方案也不对此进行检查。

最终分配了 64K 的内存并接受了这个限制。

# objective-c - 在目标c IOS 5中的按钮事件处理程序中绘制线

> ID：10507935
> 
> 赞同：0
> 
> 时间：2012-05-08T23:28:33.230
> 
> 标签：objective-c, ipad, ios5, line

我尝试使用此功能在目标 c 中画线

```
-(IBAction) DrawLine
{
    CGContextRef c = UIGraphicsGetCurrentContext();

        CGFloat red[4] = {1.0f, 0.0f, 0.0f, 1.0f};
        CGContextSetStrokeColor(c, red);
        CGContextBeginPath(c);
        CGContextMoveToPoint(c, 5.0f, 5.0f);
        CGContextAddLineToPoint(c, 50.0f, 50.0f);
        CGContextStrokePath(c);
} 
```

但我发现 c 为 null 或 nil 为什么？解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:09:19.207

我找到了答案

[http://www.techotopia.com/index.php/An_iOS_5_iPhone_Graphics_Drawing_Tutorial_using_Quartz_2D](http://www.techotopia.com/index.php/An_iOS_5_iPhone_Graphics_Drawing_Tutorial_using_Quartz_2D)

# c# - 在 ASP.NET MVC 3 中注入 IPrincipal - 我做错了什么？

> ID：10507937
> 
> 赞同：4
> 
> 时间：2012-05-08T23:28:57.137
> 
> 标签：c#, asp.net-mvc-3, razor, ninject

我有一个自定义的 IIdentity 实现：

```
public class FeedbkIdentity : IIdentity
{
    public int UserId { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public string Name { get; set; }

    public FeedbkIdentity() 
    {
        // Empty contructor for deserialization
    }

    public FeedbkIdentity(string name)
    {
        this.Name = name;
    }

    public string AuthenticationType
    {
        get { return "Custom"; }
    }

    public bool IsAuthenticated
    {
        get { return !string.IsNullOrEmpty(this.Name); }
    }
} 
```

和自定义 IPrincipal

```
public class FeedbkPrincipal : IPrincipal
{
    public IIdentity Identity { get; private set; }

    public FeedbkPrincipal(FeedbkIdentity customIdentity)
    {
        this.Identity = customIdentity;
    }

    public bool IsInRole(string role)
    {
        return true;
    }
} 
```

在 global.asax.cs 我反序列化 FormsAuthenticationTicket userData 并替换

HttpContext.Current.User：

```
protected void Application_AuthenticateRequest(Object sender, EventArgs e)
{
    HttpCookie authCookie = Request.Cookies[FormsAuthentication.FormsCookieName];

    if (authCookie != null)
    {
        FormsAuthenticationTicket authTicket = FormsAuthentication.Decrypt(authCookie.Value);

        JavaScriptSerializer serializer = new JavaScriptSerializer();

        FeedbkIdentity identity = serializer.Deserialize<FeedbkIdentity>(authTicket.UserData);

        FeedbkPrincipal newUser = new FeedbkPrincipal(identity);
        HttpContext.Current.User = newUser;
    }
} 
```

然后，在 Razor Views 中，我可以这样做：

```
@(((User as FeedbkPrincipal).Identity as FeedbkIdentity).FirstName) 
```

我已经在使用 Ninject 为会员提供者注入自定义用户存储库，并且我一直在尝试将 IPrincipal 绑定到 HttpContext.Current.User：

```
internal class NinjectBindings : NinjectModule
{
    public override void Load()
    {
        Bind<IUserRepository>().To<EFUserRepository>();
        Bind<IPrincipal>().ToMethod(ctx => ctx.Kernel.Get<RequestContext>().HttpContext.User).InRequestScope();
    }
} 
```

但它不起作用。

我要做的就是能够像这样访问我的自定义 IIdentity 属性： `@User.Identity.FirstName`

我怎样才能使这项工作？

**编辑**

我期待通过将 IPrincipal 绑定到 HttpContext.Current.User 如下所示：[MVC3 + Ninject：注入用户 IPrincipal 的正确方法是什么？](https://stackoverflow.com/questions/7877415/mvc3-ninject-what-is-the-proper-way-to-inject-the-user-iprincipal)我将能够`@User.Identity.FirstName`在我的应用程序中访问。

如果不是这种情况，如链接问题所示，将 IPrincipal 绑定到 HttpContext.Current.User 的目的是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T00:07:27.687

我建议创建您自己的基础 WebViewPage。请参阅[http://haacked.com/archive/2011/02/21/changeing-base-type-of-a-razor-view.aspx](http://haacked.com/archive/2011/02/21/changing-base-type-of-a-razor-view.aspx)

然后在里面你可以做

```
public FeedbkPrincipal FeedbkPrincipal
{
    get
    {
        return User as FeedbkPrincipal;
    }
}

public FeedbkIdentity FeedbkIdentity
{
     get
     {
         return FeedbkPrincipal.Identity as FeedbkIdentity;
     }
} 
```

那么它只是

```
@FeedbkIdentity.FirstName 
```

视野之内。

> 如链接问题所示，将 IPrincipal 绑定到 HttpContext.Current.User 的目的是什么

依赖注入允许您在运行时选择组件。在给出的例子中，你可以做

```
public MyClassConstructor(IPrincipal principal) { // } 
```

并且 IPrincipal 将自动绑定到用户。请注意，这不会让您访问您的特定`FeedbkPrincipal`属性，因为即使在运行时它会变成 type `FeedbkPrincipal`，您的类也不知道这一点。依赖注入不是您当前问题的解决方案，因为您确实需要一种访问具体类的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T00:26:31.653

假设`HttpContext.User`设置正确，您可以创建一个全局过滤器来自动填充您`ViewBag`的`FeedbkIdentity`.

例如

创造它

```
public class FeedbkPrincipalIntoViewBagAttribute : ActionFilterAttribute
{
    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        var principal = filterContext.HttpContext.User as FeedbkPrincipal;
        if (principal != null)
        {
            filterContext.Controller.ViewBag.Identity = principal.Identity as FeedbkIdentity;
        }
    }
} 
```

注册它

```
protected void Application_Start()
{
    GlobalFilters.Filters.Add(new FeedbkPrincipalIntoViewBagAttribute());
} 
```

用它

```
@ViewBag.Identity.FirstName 
```

# java - Arraylist 映射到 Hashmap

> ID：10507938
> 
> 赞同：-1
> 
> 时间：2012-05-08T23:28:58.333
> 
> 标签：java, json, arraylist, hashmap, multimap

在解析 JSON 文件时，如下所示：

```
{
"heading1" : [
  {
    "heading2" : {
        "subhead2" : {
           "value" : "value<heading2>"
        }
     },
     "heading3" : [
        {
           "heading4" : {
              "subhead4" : "value<heading4>",
           },
           "heading5" : [
              {
                 "subhead51" : {
                    "511" : "value<heading51>",
                 },
                 "subhead52" : {
                    "522" : "value<heading52>",
                 },
               <..similar such heading5 sets>
              }
           ],
          }
      }
  }
 ],
} 
```

我有一个 ArrayList 变量，如下所示。

```
 List<Map<String,String>> childMap = new ArrayList<Hashmap<String,String>>(); 
```

我将值输入到这个 childMap 中，如下所示：

```
 for(i = 0; i<result.length; i++){
    Map<String,String> childSubMap = new HashMap<String,String>();
     childsubMap.put(heading51,value<heading51>);
     childsubMap.put(heading52,value<heading52>);

    childMap.add(childSubMap);
  } 
```

父映射变量：

```
 Map<String,String> parentMap = new HashMap<String,String>();
     parentMap.put(heading2,value<heading2>);
     parentMap.put(heading4,value<heading4>); 
```

我正在使用最终的组合地图进行数据提取。

有没有办法像下面这样组合它：

```
 Key             |       Value
  __________________________________________________________
  heading2, value<heading2>      |  <Set 1>
  heading4, value<heading4>      |    heading51, value<heading51>
                                 |    heading52, value<heading52>
                                 |  <Set 2>
                                 |    heading51, value<heading51>
                                 |    heading52, value<heading52>
                                 |  ..<many such Sets> 
```

我在这里先向您的帮助表示感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:33:17.243

如果您只想将列表中的所有地图合并为一个地图，然后执行

```
for (Map<String,String> m : childMap)
{
    parentMap.putAll(childMap);
} 
```

如果您有任何重复的密钥，则将保留最后一个，其余的将被丢弃。

# c# - 如何从代码中获取 customErrors 的 defaultRedirect 值？

> ID：10507939
> 
> 赞同：6
> 
> 时间：2012-05-08T23:29:11.657
> 
> 标签：c#, .net, asp.net-mvc, web-config, custom-errors

我只想做以下事情：

```
var defaultRedirectUrl = SomeMethodToGetDefaultRedirect(); 
```

当然在 web.config 我有

```
<customErrors mode="On" defaultRedirect="~/Error"/> 
```

这该怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-09T07:36:27.653

谢谢马克，很有帮助。我真正想问的是“如何从我的 asp mvc 应用程序的 web.config 中获取 customErrors 部分的“defaultRedirect”属性？”。

根据您的帖子，答案是：

```
 CustomErrorsSection customErrorsSection = (CustomErrorsSection) ConfigurationManager.GetSection("system.web/customErrors");
        string defaultRedirect = customErrorsSection.DefaultRedirect; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-08T23:50:54.303

如果我正确理解您的问题，这应该会有所帮助（从 msdn 复制）

```
// Get the Web application configuration.
Configuration configuration =  WebConfigurationManager.OpenWebConfiguration( "/aspnetTest");

// Get the section.
CustomErrorsSection customErrorsSection = (CustomErrorsSection)configuration.GetSection("system.web/customErrors");

// Get the collection
CustomErrorCollection customErrorsCollection =  customErrorsSection.Errors;

// Get the currentDefaultRedirect
string currentDefaultRedirect =  customErrorsSection.DefaultRedirect; 
```

# visual-c++ - 在 Visual c++/CLI 中获取字节数组的切片

> ID：10507940
> 
> 赞同：0
> 
> 时间：2012-05-08T23:29:36.607
> 
> 标签：visual-c++

我想获取一个删除第一个字节的数组切片，即类似于 myArray[1..myArray->Length]。如何在 Visual C++/CLI 中执行此操作？

谢谢，调频

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:32:57.527

如果这是一个托管数组 ( `cli::array`)，那么您可以使用[`ArraySegment<T>`](http://msdn.microsoft.com/en-us/library/1hsbd92d.aspx)，它是用于数组“切片”和分区的托管框架结构。

# git - 接收后挂钩中的 Git 结帐：“不是 git 存储库 '。'”

> ID：10507942
> 
> 赞同：19
> 
> 时间：2012-05-08T23:29:50.853
> 
> 标签：git

我的服务器上有一个非裸存储库（dirs /home/andrew/web 和 /home/andrew/web/.git），将 receive.denyCurrentBranch 设置为忽略并创建 post-receive 钩子：

```
#!/bin/sh
GIT_WORK_TREE=/home/andrew/web git checkout -f 
```

当我运行 sh .git/hooks/post-receive 时，一切正常。但是当我从我的电脑推送时，我收到了这个错误：

```
remote: fatal: Not a git repository: '.' 
```

有没有办法解决这个问题？最终无需切换裸回购？

谢谢

编辑：这是我的新接收后挂钩。为什么会这样，已在接受的答案中进行了描述。

```
echo "\nChecking out $PWD"
GIT_DIR=/home/andrew/web/.git
GIT_WORK_TREE=/home/andrew/web git checkout -f 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-09T09:49:36.420

[编辑，2017 年 2 月：这个旧答案仍然受到一点影响，所以让我们添加一些注释。(1) 这种实时更新通常是一个坏主意：确保您知道为什么要这样做，并且不会破坏自己的工作。(2) 在 Git 2.3 之后，您现在可以配置`receive.denyCurrentBranch`为`updateInstead`，以及 Git 2.4 及更高版本中的挂钩调整。有关详细信息，请参阅[文档`git config`。](https://www.kernel.org/pub/software/scm/git/docs/git-config.html) ]

post-receive 挂钩运行时`$GIT_DIR`设置为`.`。这会导致 git 查找`./HEAD`,`./refs/heads/master`等，而不是`.git/HEAD`,`.git/refs/heads/master`等。但是，由于您没有`$PWD`对钩子进行任何更改（如图所示），因此钩子将在`.git`子目录 ( `/home/andrew/web/.git`) 中运行，因此这个失败非常神秘：`.`实际上将是一个有效的 git 存储库。

避免硬编码路径名的一种标准技巧是`cd ..; git checkout -f`用作接收后挂钩。这就是设置`$GIT_DIR`成为问题的地方，因为在`cd ..`钩子运行之后（仍然假设这种情况）`/home/andrew/web`，当然此时，`$GIT_DIR`应该是`.git`而不是`.`. 对此的标准修复只是取消设置`GIT_DIR`（将其设置为`.git`也可以）。

不过，如图所示，您的 post-receive 钩子对我来说效果很好（通过适当的硬编码路径更改）。然后我再次从类似 Unix 的机器上推送，而不是 PC。是否有可能发生其他事情，将目录从`.git`子目录中更改出来？你可以做一些类似`echo running in $PWD`在钩子里的事情来看看你在哪里。

# binary - 计算机中的二进制转十进制

> ID：10507945
> 
> 赞同：2
> 
> 时间：2012-05-08T23:30:21.800
> 
> 标签：binary, decimal, computer-architecture

计算机如何将二进制，例如 110011 (51) 转换为相应的 ASCII 值 53('5') 和 49('1')？此外，计算机如何将 53 和 49 转回 110011？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T23:46:23.213

二进制到十进制的转换通常作为一个重复的除法循环。如果我们从一个数字 N 开始，(N mod 10) 是最后一个数字，然后我们继续将 N 除以 10 并重复以获得其他数字。

1.  我们从 N=51 开始
2.  51 mod 10 是 1。最后一位是 1。
3.  除以 10 以丢弃我们刚刚提取的数字（整数除法），得到 5。
4.  （这是步骤 2 的重复，使用不同的 N）5 mod 10 是 5。下一个数字是 5。
5.  5/10 是 0（四舍五入），所以我们完成了。倒序的数字是 1 和 5。
6.  我们将 48 添加到每个数字值以获取 ASCII 中相应的十进制数字。
7.  所以最终结果是“51”。

从字符串转换为内部表示更加容易。

1.  累加器中从 0 开始
2.  取第一个字符（此处为“5”）。那是 ASCII 53。减去 48 得到 5。
3.  将其添加到我们的累加器中得到 0+5=5。
4.  注意还有一个数字。将累加器乘以 10 得到 50。
5.  返回步骤 1

在下一次迭代中（即“1”=ASCII 49）再次减去 48：49-48=1。我们在累加器上加 1，得到 51。没有更多字符，所以我们完成了，结果是 51。

计算机的内部表示是二进制的这一事实是偶然的。我们只需要能够在计算机内部进行加减乘乘即可将字符串转换为数字。

（当然，减法只是一个负数的加法，而乘法只是一个加法序列，所以真正需要的只是加法。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:58:37.543

To turn binary into ASCII:

1) take your number divide it by 10 decimal (1010 binary) and calculate the remainder 2) With the remainder, add 48 (the ASCII value for '0'). This gives you the last digit. 3) If the quotient is 0, stop 4) If the quotient is more than 0, start again from step 1 using the quotient.

Eg. Convert 51 (110011) to ASCII using base 10 (1010):

```
110011 / 1010  = 0101 (5 decimal) remainder 0001

0001 (the remainder from above) + 110000 ('0') = 110001 (49 decimal or '1' in ASCII)

0101 (the quotient from above) / 1010 = 0 remainder 0101
0101 (the remainder) + 110000 ('0') = 110101 (53 decimal or '5' in ASCII) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T23:42:38.403

尝试为此目的编写一个计算机程序。它通常在软件中完成，尽管一些处理器具有特殊用途的十进制指令。假设您的工作是查看带有二进制整数的纸条并制作带有 Unicode 代码点的纸条，您很快就会掌握基本大纲。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T23:38:14.307

无论哪种方式，它都不会改变它们。`53`永远是`53`记忆中的一个。

发生的情况是，当它需要显示时，会调用一个函数，该函数知道当它看到数字时`53`，它会生成我们眼睛看到的图形`5`。或者在内存中它可能将数字`53`转换为数字`53`and `51`，最终某些程序将显示为字符`"5"`and `"3"`。

而且`53`总是`110101`。存储单元是位序列，并以十进制`53`形式保存位`001101011`。

同样，有一些功能可以看到这些位，并可以在您的屏幕上生成 character`"5"`和 character `"3"`。

但在计算机内部，它总是数字，总是二进制。

# asp.net - 正则表达式验证器 asp.net

> ID：10507946
> 
> 赞同：0
> 
> 时间：2012-05-08T23:30:31.550
> 
> 标签：asp.net, regex

这是漫长的一天，我的课程作业还剩下一点点要做，但我终其一生都无法理解为什么这个正则表达式验证器在我的 aspx 文件中不起作用。

```
<asp:GridView ID="GridView1" runat="server"></asp:GridView>    
    <br />
    Product:
    <asp:TextBox ID="TextBox2" runat="server" ></asp:TextBox>
    <asp:RegularExpressionValidator ID="RegularExpressionValidator1" 
    runat="server" ErrorMessage="a-z only" ControlToValidate="TextBox2" 
    ValidationExpression="^[a-z]*$"></asp:RegularExpressionValidator> 

    <br />
    <br /> 
```

```
 <br />
    Old Name:     

    <asp:DropDownList ID="ddItems" runat="server" Width="128px" AutoPostBack="true" >                         
    </asp:DropDownList> 

    <br />
    <br />
    New Name: 
    <asp:TextBox ID="TextBox3" runat="server" ontextchanged="TextBox3_TextChanged" AutoPostBack="true" ></asp:TextBox>

    <asp:RegularExpressionValidator ID="RegularExpressionValidator2" 
    runat="server" ErrorMessage="a-z only" ControlToValidate="TextBox3" 
    ValidationExpression="^[a-z]*$"></asp:RegularExpressionValidator> 

    <br />
    <br />
    <asp:Button ID="Button2" runat="server" onclick="Button2_Click" Text="Update Name" />

    <div align="left">
<asp:Button ID="back" runat="server" Text="Back" onclick="back_Click" /> 
```

有时他们允许文本，这是所需的行为，有时他们不允许。这可能是因为我的 c 语言代码还是错误肯定在 aspx 文件中？

问候，刘易斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:45:56.970

根据您的评论，将您的正则表达式更改为`"^[A-Za-z ]*$"`是否允许大小写字母以及任何顺序的空格。请注意，此正则表达式也将匹配空字符串，因为没有所需的字符数。

# javascript - 使用 JavaScript 检测 Internet 连接

> ID：10507949
> 
> 赞同：5
> 
> 时间：2012-05-08T23:30:56.213
> 
> 标签：javascript, html

目前，我正在制作一个缓存 iPhone 应用程序，其中包含一些需要互联网的功能，以及其他不需要的功能。我想知道如何使用 JavaScript 检测 Internet 连接，使某些页面显示“无 Internet 连接”文本，而其他页面正常工作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-08T23:32:53.587

在 HTML5 中，您可以使用：

```
 navigator.onLine 
```

检测互联网连接。

现场演示：http: [//jsfiddle.net/DerekL/fHQK4/](http://jsfiddle.net/DerekL/fHQK4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:48:04.787

您可以制作一个 iframe 并将 src 设置为 google。如果它没有在几秒钟内触发 onload，他们可能没有互联网。

# java - 测试依赖时间的服务方法

> ID：10507955
> 
> 赞同：1
> 
> 时间：2012-05-08T23:31:58.300
> 
> 标签：java, testing, junit, mocking, integration-testing

我正在尝试使用在数据库表中查找当前“处理周期”的方法为服务编写集成测试。但是，并不总是有一个有效的处理周期，因此该方法可能会返回 null（有几周没有进行处理）。我想为这个方法编写一个 JUnit 测试，但由于它不会总是返回一个值，我会根据我运行测试的时间得到不同的结果。

period 对象和服务如下所示：

```
public interface ProcessingPeriod {
    int getSeqno();
    Date getStart();
    Date getEnd();
}

public class PeriodService {
    /* Look up the current period; if not currently in a period, return null */
    public ProcessingPeriod getCurrentPeriod() { /* execute a sql query */ }

    /* Look up the current period; if not currently in a period, get the next upcoming period */
    public ProcessingPeriod getCurrentOrNextPeriod() { /* execute a sql query */ }

    /* Look up the current period; if not currently in a period, get the most recent period */
    public ProcessingPeriod getCurrentOrPreviousPeriod() { /* execute a sql query */ }
} 
```

的实例`PeriodService`由 Spring 应用程序上下文管理，我的 JUnit 测试使用`SpringJUnit4ClassRunner`来构造测试上下文并将服务对象提供给测试。我的 JUnit 测试目前看起来像：

```
@Test
public void testGetCurrentPeriod() {
    ProcessingPeriod period = service.getCurrentPeriod();
    if (period != null) {
        Date now = new Date();
        assertThat(period.getStart(), lessThanOrEqualTo(now));
        assertThat(period.getEnd(), greaterThanOrEqualTo(now));
    }
} 
```

但是，如果在处理期间不运行测试，这似乎没有多大帮助。我怎样才能有意义地测试该`getCurrentPeriod`方法实际上从数据库中获取了正确的时间段？我应该嘲笑数据库吗？我还想对数据库实际执行查询，以帮助确保 SQL 有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T12:03:21.547

instead of using in my code `new Date()`, `getCurrentTimeMillis()`, etc. i always use a time provider that contains all time related methods i need.

```
interface TimeProvider {
  Date getDate();
  int getCurrentQuarter();
  ...
} 
```

production implementation is obvious. for tests, however, you can put any provider you need so you can set any time you like in tests. it works good with spring. but it works only when you test code that doesn't use it's own internal clock (sleep, lock, quartz, etc).

looks like it fits your example but you will have to refactor your production code

# bash - 如何用awk比较两个文件中的数字字段

> ID：10507957
> 
> 赞同：1
> 
> 时间：2012-05-08T23:32:27.300
> 
> 标签：bash, awk

我有这两个文件：file1

```
2537

1279

1075

12799

1474

135441

1260

1169

1281

10759 
```

和文件2

```
1070,1279960511,BR,USA,UNITED STATES
1278,1279960511,US,USA,UNITED STATES
1279,1279960527,CA,CAN,CANADA
1289,1279967231,US,USA,UNITED STATES
2679,1279971327,CA,CAN,CANADA
1279,1279971839,US,USA,UNITED STATES
1279,1279972095,CA,CAN,CANADA
1279,1279977471,US,USA,UNITED STATES
127997,1279977983,CA,CAN,CANADA
127997,1279980159,US,USA,UNITED STATES
127998,1279980543,CA,CAN,CANADA
107599,1075995007,US,USA,UNITED STATES
107599,1075995023,VG,VGB,VIRGIN ISLANDS, BRITISH
107599,1075996991,US,USA,UNITED STATES
107599,1075997071,CA,CAN,CANADA 
```

我想：对于 file1 的每个条目，通过 file2 的第一列，当该列中的值大于“file1”元素时，然后返回 file2 的第三个元素我尝试了很多方法，但没有一个有效我要么得到一个空文件或打印的内容与我预期的不同我最后一次尝试是：

```
awk -F, '
BEGIN {FS="," ; i=1 ; while (getline < "file2") { x[i] = $1 ; y[i] = $3 ; i++ }}

{ a[$1] = $1 ; h=1 ; while (x[h] <= a[$1]) { h++ } ; { print y[h] }}' file1 
```

但这永远运行它不会停止也不会给我任何帮助plzzz这已经杀死我好几天了，我放弃了谢谢

期望的输出：

```
#this is a comment and i ll write file 2 as if it was a matrix  

because file1[1] > file2[1,1] ... and file1[1] > file2[2,1] .... and file1[1] > file2[3,1] ... and file1[1] > file2[4,1] but file1[1] < file2[5,1] ... then print file2[4,3] ... which is "US"

now go to file1[2] :

file[2] > file2[1,1] ... and file1[2] > file2[2,1] ... but file1[2] <= file2[3,1] ... then print file2[3,3] 
```

总之我想打印：“第一行的第三个元素（col）（来自file2）file1元素首先变成>下一行的第一个元素（file2）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:46:17.713

我将您的 AWK 脚本作为以下内容的基础。我更改了变量名称以使它们更有意义，因为这有助于自我记录。

```
#!/usr/bin/awk -f
BEGIN {
    FS=","
    count = 1
    while (getline < "file2") {
        key[count] = $1
        countrycode[count] = $3
        count++
    }
}

{
    for (idx = 1; idx <= count; idx++)
    {
        if ($1 < key[idx]) {
            print countrycode[idx]
            next
        }
    }
} 
```

示例运行（打印`$0`而不是`$3`仅打印 - 上面的代码仅打印`$3`）：

```
$ sort -n -k1,1 -t, file2 > tmp; mv tmp file2
$ ./scannums file1
2679,1279971327,CA,CAN,CANADA
1289,1279967231,US,USA,UNITED STATES
1278,1279960511,US,USA,UNITED STATES
127997,1279977983,CA,CAN,CANADA
2679,1279971327,CA,CAN,CANADA
1278,1279960511,US,USA,UNITED STATES
1278,1279960511,US,USA,UNITED STATES
1289,1279967231,US,USA,UNITED STATES
127997,1279977983,CA,CAN,CANADA 
```

请注意，file1 中的值 135441 没有打印任何内容，因为 file2 中的任何内容都不符合条件。

如果您愿意，可以将其制成单线。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T00:48:06.020

这行得通吗？

```
sort -n -t"," -k1,1 file1 file2 | awk -F"," '{if ($3 != "") {s = $3;} else {print $1 " " s;}}' 
```

生产

```
1075 BR
1169 BR
1260 BR
1279 US
1281 US
1474 US
2537 US
10759 CA
12799 CA
135441 CA 
```

如果file1中的原始顺序很重要，可以使用以下

```
awk '{print NR "," $1}' file1 file2 | sort -t"," -n -k 2,2 | awk -F"," '{if ($4 != "") {s = $4;} else {print $1 " " s;}}' | sort -t"," -k1,1 | cut -d" " -f2 
```

生产

```
US
CA
BR
BR
US
CA
US
BR
CA
US 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T23:38:55.047

您不能只`xargs`用于作业的“读取文件1”部分吗？awk 中的单个“在 file2 中查找值”部分非常简单，并且您避免了双文件指针......

编辑：使用 xargs 和 awk 的示例。

```
cat file1 | xargs awk '$1 > ARGV[2] {print $3; return}' file2 
```

编辑：这个例子有效（现在在我的电脑上试过......）

使用 -n 1 作为 xargs 的选项以在每次传递中仅传递一个参数。存储后删除“val”参数，因此 AWK 只获取文件名 (file2) 并知道要做什么。找到时标记，返回不存在。

```
cat file1 | xargs -n 1 awk -F, 'BEGIN {val = ARGV[2]; ARGC--; found=0} $1 > val {if (found==0) { print val, $3; found = 1}}' file2 
```

编辑：较短的版本

```
cat file1 | xargs -n 1 awk -F, 'BEGIN {val = ARGV[2]; ARGC--} (!found) && ($1 > val)  {print val, $3; found = 1}' file2 
```

脚本版本：

```
#!/usr/bin/awk -f
BEGIN {
  val = ARGV[2]
  ARGC--
}
(!found) && ($1 <= val) {
  # cache 3rd column of previous line
  prev = $3
}
(!found) && ($1 > val) {
  # print cached value as soon as we cross the limit
  print val, prev
  found = 1
} 
```

将其命名为 find_val.awk 并 chmod +x 。您只需`find_val.awk somefile somevalue`以相同的方式执行和使用 xargs

```
cat file1 | xargs -n 1 find_val.awk file2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-09T00:05:54.600

# 长单线：

这是您可以执行此操作的一种方法：

```
cat file1|grep -vE '^$'|while read min; do cat file2|while read line; do val=$(echo $line|cut -d, -f1); if [ $min -lt $val ]; then short_country=$(echo $line|cut -d, -f3); echo $min: $short_country "($val)"; break; fi; done; done 
```

这产生了输出

```
2537: CA (2679)
1279: US (1289)
1075: US (1278)
12799: CA (127997)
1474: CA (2679)
1260: US (1278)
1169: US (1278)
1281: US (1289)
10759: CA (127997) 
```

# 解释

如果你在脚本中分解它，而不是让它成为一个单行，它更容易理解：

```
#!/bin/bash

cat file1 |                               # read file1
grep -E '^[0-9]+$' |                      # filter out lines in file1 that don't just contain a number
while read min; do                        # for each line in file1:
  cat file2 |                               # read file2
  grep -E '^([0-9]+,){2}[A-Z]{2},' |        # filter out lines in file2 that don't match the right format
  while read line; do                       # for each line in file2:
    val=$(echo $line|cut -d, -f1)             # pull out $val: the first comma-delimited value
    if [ $min -lt $val ]; then                # if it's greater than the $min value read from file1:
      short_country=$(echo $line|cut -d, -f3)   # get the $short_country from the third comma-delimited value in file2
      echo "$min: $short_country ($val)"        # print it to stdout. You can get rid of ($val) here if you're not interested in it.
      break                                     # Now that we've found a value in file2, stop this loop and go to the next line in file1
    fi
  done
done 
```

因为你最初没有指定你的输出格式，我猜。希望这种方式对您有用。

# android - (SQLiteDatabase & SQLiteOpenHelper) 重复功能

> ID：10507967
> 
> 赞同：0
> 
> 时间：2012-05-08T23:33:42.813
> 
> 标签：android, sqlite, software-design

我可以通过两种方式打开 SQLiteDatabase：

```
SQLiteDatabase.openDatabase()
SQLiteOpenHelper.getWritableDatabase () 
```

似乎两种方法之间没有区别，除了使用时更多的控制`SQLiteDatabase.openDatabase()`

Q1-为什么要重复？

Q2-从软件设计的角度来看，我如何从中受益

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:41:33.147

创建自己的扩展类`SQLiteOpenHelper`允许您从主代码中删除大量 SQLite 数据库代码。您覆盖`onCreate(...)`and`onUpdate(...)`方法以允许它在您的应用程序首次运行时自动创建数据库，并在您的应用程序的未来升级中更新数据库。

它也很有用，因为您可以将方法添加到扩展`SQLiteOpenHelper`中以执行所有“样板”任务（查询、插入、删除等）。实际上，您的主代码永远不需要对数据库的引用——它可以简单地调用扩展`SQLiteOpenHelper`类上的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T02:50:35.307

`SQLiteDatabase`提供较低级别的访问和控制，同时，如上所述，`SQLiteOpenHelper`处理大量样板代码，您通常应该更喜欢它。您需要使用的一种情况`SQLiteDatabase`是当您想要在外部存储上打开一个数据库（通常是预填充的）时——由于`SQLiteOpenHelper`您无法指定数据库文件位置，它默认为在您的应用程序的私有目录（在 下`org.myapp/databases`）中创建一个。

# html - html中标签a的type属性是如何实现的？

> ID：10507968
> 
> 赞同：3
> 
> 时间：2012-05-08T23:34:03.267
> 
> 标签：html

[W3C 学校](http://www.w3schools.com/html5/att_a_type.asp)声明“类型属性指定链接文档的 MIME 类型”并作为`<a href="http://www.w3schools.com" type="text/html">W3Schools</a>`示例提供。如果我更改`text/html`为`application/zip`标题`accept`字段**不**更改。

规范中的[解释](http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#links-created-by-a-and-area-elements)还指出该属性是“纯粹的建议”。这意味着，浏览器可以简单地忽略它吗？

它会期望，该属性反映在“接受”标题字段中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T23:44:51.797

规范中没有任何内容表明 UA 在跟随链接时必须更改`Accept`标头以匹配`type`属性。它所说的只是 UA 不能依赖`type`来确定要检索的资源的类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T23:43:50.967

> 该`type`属性（如果存在）给出链接资源的 MIME 类型。这纯粹是建议性的。该值必须是有效的 MIME 类型。用户代理不得认为类型属性具有权威性——在获取资源时，用户代理不得使用包含在资源链接中的元数据来确定其类型。

正如它所说，它纯粹是建议性的，用户代理**不能**认为它具有权威性。换句话说，它甚至不能保证它是正确的，而只是一个*提示*。我认为这纯粹是基于实用性，因为链接很快就会变得陈旧；链接不能指示链接到资源的内容。没有关于用户代理*应该*如何处理该属性的其他规范。例如，用户代理可以使用它来直观地向用户指出该链接将（可能）指向 PDF 文件。我不知道现在这样做的用户代理。该属性没有任何其他指定用途，因此也不应更改`Accept`标题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-18T22:37:45.893

type 属性对于脚本和 HTML5 音频/视频非常重要。如果您通过 HTML5 JavaScript API 访问音频/视频（例如，当用户玩游戏时启动音频），如果浏览器无法播放指定为音频/源的任何文件，则 JavaScript 将严重失败视频节点。

使用 JavaScript，您可以在尝试访问媒体之前检查浏览器是否能够播放媒体，但您不仅必须知道 MIME 类型，还必须知道媒体文件中使用的编解码器，而根据文件扩展名。

这就是 type 属性发挥作用的地方，JavaScript 可以从 type 属性获取该信息，然后查询浏览器是否能够播放该类型的媒体。

媒体播放时服务器发送的 MIME 类型仍然必须正确，您无法使用 type 属性来补偿服务器上不正确的 MIME 类型，无论是 HTML5 媒体还是该属性所在的任何其他标签用过的。

# ruby-on-rails - Rails：Ajax 调用不适用于“require jquery”

> ID：10507970
> 
> 赞同：0
> 
> 时间：2012-05-08T23:34:27.493
> 
> 标签：ruby-on-rails, jquery

当我在 application.js 文件中包含 jquery 时，我的 rails 应用程序上有一个 AJAX 调用不起作用。每当我提交表单（使用 form_for）时，什么都没有发生。问题是没有那条 jquery 行，我无法使用我的 html-delete-methods，导致另一个异常。

我正在使用 Rails 3.2.3 和 ruby​​ 1.9.3p194

这里有一些代码：

**应用程序.js：**

```
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require_tree . 
```

**form.html.erb：**

```
<%= form_for(user.relationships.build(id: @user.id), remote: true) do |f| %> 
```

**控制器.rb**

```
respond_to do |format|
      format.html { redirect_to @patient }
      format.js
end 
```

想念我的是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:31:22.960

尝试这个：

```
<% relationship = user.relationships.build user_id: @user.id
<%= form_for relationship, url: relationship_path(relationship, format: :js) do |f| %> 
```

# c# - 填充数组时出现 NullReferenceException

> ID：10507975
> 
> 赞同：0
> 
> 时间：2012-05-08T23:35:23.617
> 
> 标签：c#, nullreferenceexception

```
[DataContract]
public class PersonField
{
    private string _fieldName;
    private object _fieldValue;

    public PersonField()
    {
    }

    public PersonField(string FieldName, object FieldValue)
    {
        _fieldName = FieldName;
        _fieldValue = FieldValue;
    }
    [DataMember]
    public string FieldName
    {
        get { return _fieldName; }
        set { _fieldName = value; }
    }
    [DataMember]
    public object FieldValue
    {
        get { return _fieldValue; }
        set { _fieldValue = value; }
    }
} 
```

我有上面的这个类，它在我的 WCF 服务中使用。当我尝试在客户端为此创建数组时

```
PersonField[] test = new PersonField[2];
test[0].FieldName = "test"; 
```

我得到对象引用未设置为对象的实例。不知道我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:38:59.537

由于这是一个类，因此您正在创建一个引用数组，而不是实际的对象。您仍然需要自己分配实例：

```
PersonField[] test = new PersonField[2];
test[0] = new PersonField();
test[0].FieldName = "test";
test[1] = new PersonField(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:39:36.943

为此，您必须这样做。你也需要`test[0]`用`new`关键字初始化。

```
PersonField[] test = new PersonField[2];
test[0] = new  PersonField();
test[0].FieldName = "test";
test[1] = new  PersonField();
test[1].FieldName = "test2"; 
```

> **值类型和引用类型数组**
> 
> 考虑以下数组声明：C#
> 
> **SomeType[] array4 = new SomeType[10];**
> 
> 此语句的结果取决于 SomeType 是值类型还是引用类型。如果它是值类型，则该语句将创建一个包含 10 个 SomeType 类型实例的数组。如果 SomeType 是引用类型，则该语句创建一个包含 10 个元素的数组，每个元素都初始化为一个空引用。
> 
> 有关值类型和引用类型的详细信息，请参阅类型（C# 参考）。

[这是 MSDN 链接](http://msdn.microsoft.com/en-us/library/0a7fscd0%28v=vs.80%29.aspx)

# android - 水平滚动视图的Android设置位置

> ID：10507976
> 
> 赞同：18
> 
> 时间：2012-05-08T23:35:28.253
> 
> 标签：android, position, horizontalscrollview

我正在尝试设置水平滚动视图的位置，使其与按下的按钮相对应。我试过用它来设置它不成功：

```
HorizontalScrollView hsv = (HorizontalScrollView)findViewById(R.id.ScrollView);
int x, y;
x = hsv.getLeft();
y = hsv.getTop();
hsv.scrollTo(x, y); 
```

这没有任何结果，滚动视图不受影响。xml：

```
 <HorizontalScrollView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/ScrollView"
        android:layout_width="fill_parent"
        android:layout_height="50dp"
        android:layout_alignParentBottom="true"
        android:background="@null"
        android:scrollbars="none" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="horizontal" >

            <Button
                android:layout_width="100dp"
                android:layout_height="fill_parent"
                android:layout_marginBottom="-5dp"
                android:text="btn0" 
                android:id="@+id/btn0"
                android:background="@drawable/yellow_btn" />

            <Button
                android:layout_width="100dp"
                android:layout_height="fill_parent"
                android:layout_marginBottom="-5dp"
                android:background="@drawable/yellow_btn"
                android:text="bnt1"
                android:id="@+id/btn1" />

            <Button
                android:layout_width="100dp"
                android:layout_height="fill_parent"
                android:layout_marginBottom="-5dp"
                android:background="@drawable/yellow_btn"
                android:text="btn2"
                android:id="@+id/btn2" />

            <Button
                android:layout_width="100dp"
                android:layout_height="fill_parent"
                android:layout_marginBottom="-5dp"
                android:background="@drawable/yellow_btn"
                android:text="btn3"
                android:id="@+id/btn3" />

      <Button
                android:layout_width="100dp"
                android:layout_height="fill_parent"
                android:layout_marginBottom="-5dp"
                android:background="@drawable/yellow_btn"
                android:text="btn4"
                android:id="@+id/btn4" />

      <Button
                android:layout_width="100dp"
                android:layout_height="fill_parent"
                android:layout_marginBottom="-5dp"
                android:background="@drawable/yellow_btn"
                android:text="btn5"
                android:id="@+id/btn5" />

        </LinearLayout>
    </HorizontalScrollView> 
```

因此，如果在启动新活动时按下第 5 个按钮（在屏幕外），我想设置新视图，以便水平滚动视图一直向右而不是一直向左开始。

**如何设置水平滚动视图的位置？**

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-08T23:38:58.853

现在您正试图滚动到 Horizo​​ntalScrollView 的左上角而不是按钮的位置。尝试滚动到按钮的 (x, y) 位置，如下所示：

```
HorizontalScrollView hsv = (HorizontalScrollView) findViewById(R.id.ScrollView);
Button button = (Button) findViewById(R.id.btn5);
int x, y;
x = button.getLeft();
y = button.getTop();
hsv.scrollTo(x, y); 
```

**编辑：**

如果将这段代码放在`onCreate()`. 即使您调用`setContentView()`了 ，布局也尚未测量和初始化。这意味着`getLeft()`and`getTop()`方法[都将返回 0](https://stackoverflow.com/questions/3591784/android-get-width-returns-0)。尝试在布局完全初始化之前设置滚动位置是没有效果的，所以需要`hsv.scrollTo()`在`onCreate()`.

似乎可行的一种选择是将代码放入`onWindowFocusChanged()`：

```
@Override
public void onWindowFocusChanged(boolean hasFocus) {
    super.onWindowFocusChanged(hasFocus);

    HorizontalScrollView hsv = (HorizontalScrollView) findViewById(R.id.ScrollView);
    Button button = (Button) findViewById(R.id.btn5);
    int x, y;
    x = button.getLeft();
    y = button.getTop();
    hsv.scrollTo(x, y);
} 
```

但是，每次 Activity 获得或失去焦点时都会调用此函数，因此您最终可能会比预期更频繁地更新滚动位置。

一个更优雅的解决方案是继承 Horizo​​ntalScrollView 并将滚动位置设置为`onMeasure()`，在您知道视图已初始化之后。为此，我将您的布局拆分为两个文件并添加了一个名为 MyHorizo​​ntalScrollView 的新类：

```
package com.theisenp.test;

import android.content.Context;
import android.util.AttributeSet;
import android.view.View;
import android.widget.HorizontalScrollView;

public class MyHorizontalScrollView extends HorizontalScrollView {

    public MyHorizontalScrollView(Context context) {
        super(context);
        addButtons(context);
    }

    public MyHorizontalScrollView(Context context, AttributeSet attrs) {
        super(context, attrs);
        addButtons(context);
    }

    /**
     * Inflates the layout containing the buttons and adds them to the ScrollView
     * @param context
     */
    private void addButtons(Context context) {
        View buttons = inflate(context, R.layout.buttons, null);
        addView(buttons);

    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);

        //Find button 5 and scroll to its location
        View button = findViewById(R.id.btn5);
        scrollTo(button.getLeft(), button.getTop());
    }
} 
```

创建 MyHorizo​​ntalScrollView 时，它会自动膨胀并添加按钮布局。然后在调用 super 之后`onMeasure()`（以便它知道布局已经完成初始化）它设置滚动位置。

这是新的 main.xml。它只包含新的 MyHorizo​​ntalScrollView，尽管您可以轻松地将它放在线性或相对布局内并添加其他视图元素。（您将替换`com.theisenp.test`为 MyHorizo​​ntalScrollView 所在的包的名称）：

```
<?xml version="1.0" encoding="utf-8"?>
<com.theisenp.test.MyHorizontalScrollView
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/ScrollView"
android:layout_width="fill_parent"
android:layout_height="50dp"
android:layout_alignParentBottom="true"
android:background="@null"
android:scrollbars="none" /> 
```

这是由 MyHorizo​​ntalScrollView 自动膨胀的buttons.xml 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="fill_parent"
android:orientation="horizontal" >

    <Button
    android:id="@+id/btn0"
    android:layout_width="100dp"
    android:layout_height="fill_parent"
    android:layout_marginBottom="-5dp"
    android:text="btn0" />

    <Button
    android:id="@+id/btn1"
    android:layout_width="100dp"
    android:layout_height="fill_parent"
    android:layout_marginBottom="-5dp"
    android:text="bnt1" />

    <Button
    android:id="@+id/btn2"
    android:layout_width="100dp"
    android:layout_height="fill_parent"
    android:layout_marginBottom="-5dp"
    android:text="btn2" />

    <Button
    android:id="@+id/btn3"
    android:layout_width="100dp"
    android:layout_height="fill_parent"
    android:layout_marginBottom="-5dp"
    android:text="btn3" />

    <Button
    android:id="@+id/btn4"
    android:layout_width="100dp"
    android:layout_height="fill_parent"
    android:layout_marginBottom="-5dp"
    android:text="btn4" />

    <Button
    android:id="@+id/btn5"
    android:layout_width="100dp"
    android:layout_height="fill_parent"
    android:layout_marginBottom="-5dp"
    android:text="btn5" />

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-11-18T11:49:33.967

虽然这是一个老问题，但我最近遇到了同样的问题，并找到了另一个但不太复杂的解决方案。

让我们假设原始问题中的给定布局文件，并假设如果以给定布局启动活动，则需要将水平滚动视图滚动到按钮 5。

要实现滚动到按钮 5，请将以下代码放入`onCreate()`Activity 的方法中：

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Some code such as layout inflation.

        final HorizontalScrollView hsv = (HorizontalScrollView) findViewById(R.id.ScrollView);

        // Scrolling to button 5.
        hsv.post(new Runnable() {
            @Override
            public void run() {
                // Get the button.
                View button = findViewById(R.id.btn5);

                // Locate the button.
                int x, y;
                x = button.getLeft();
                y = button.getTop();

                // Scroll to the button.
                hsv.scrollTo(x, y);
            }
        });
    }
} 
```

# php - 无法在 PHP 文件中包含/执行 CGI 文件

> ID：10507979
> 
> 赞同：3
> 
> 时间：2012-05-08T23:35:39.733
> 
> 标签：php, parsing, cgi, execution

使用 SSI，我可以简单地将其包含在我的 HTML 文件中，并且 CGI 脚本的输出会显示在页面上：

```
<!--#include virtual="script.cgi"--> 
```

现在我正在尝试做同样的事情，但它不是 HTML 文件，而是在 PHP 文件中。我整天都在研究这个问题，每个解决方案都给我带来了以下问题。我将列出它们，从我认为应该工作以及晦涩难懂的开始...

* * *

1) `<?php include("script.cgi"); ?>`

**结果：** 没有执行。这只是打印出 CGI 文件的全部内容，就好像它只是一个文本文件一样。

* * *

2) `<?php virtual("script.cgi"); ?>`

**结果：** `Fatal error: Call to undefined function virtual() in test.php on line #`。

这让我很困扰，因为我读到的所有内容都表明这是正确的做法。我不是 PHP 专家，但怎么可能`virtual`是“未定义函数”？它[在官方 PHP 文档](http://php.net/manual/en/function.virtual.php)中被列为对 PHP 版本 5 有效。

* * *

3) `<?php exec("script.cgi"); ?>`

**结果：** 空白。没有什么。

* * *

4)

```
<?php
    $fd = fopen("script.cgi", "r");
    fpassthru($fd);
?> 
```

**结果：** 没有执行。这只是打印出 CGI 文件的全部内容，就好像它只是一个文本文件一样。

* * *

5)`<?php echo system("script.cgi"); ?>`

**结果：** 喜忧参半。它会执行，但 CGI 脚本的“结果”会打印两次，并且前面是“Content-type: text/html”。这个我不明白。

`Content-type: text/html resultresult`

并通过删除`echo`...

`<?php system("script.cgi"); ?>`， 结果是...

`Content-type: text/html result`

* * *

6)`<?php print("/usr/bin/perl script.cgi"); ?>`

**结果：**没有执行。它只是打印出 print 语句 ( `/usr/bin/perl script.cgi`) 之后包含的内容。（我并不感到惊讶，但论坛中有人声称这对他们有用。）

* * *

那么我需要做什么才能执行并包含 CGI 文件的结果呢？这似乎应该很容易，但我不知道还能尝试什么。

我在有权编辑`htaccess`文件的 Apache/Linux 服务器 (cPanel) 上。它运行 PHP 版本 5.2.17。

是的，当我在浏览器中打开 CGI 文件时，它会执行并显示结果，因此我们知道服务器已配置为执行 CGI 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-11-08T13:20:24.283

如果 PHP 作为 Apache 模块运行，则 CGI 变量在内部传递。在调用希望在环境中找到它们的 CGI 脚本之前，应该将它们复制到那里。

然后，CGI 脚本可能会在内容之前写入 HTTP 响应标头。似乎没有办法阻止 PHP 显示标题。所以脚本必须适当地处理脚本输出。

例如：

```
<?php
    foreach($_SERVER as $key => $value)
        putenv("$key=$value");
    $rtc = 0;
    $out = array();
    $mycgi = "/full/path/to/my/script.cgi";
    exec($mycgi, $out, $rtc);
    $in_header = true;
    foreach($out as $value)
    {
        if ($in_header)
        {
            if (strlen($value) == 0)
                $in_header = false;
            else
                header($value);
        }
        else
        {
            echo "$value\n";
        }
    }
    if ($rtc)
        error_log("$mycgi rtc=$rtc", 0);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:42:41.560

我已经尝试了所有方法，但似乎没有任何东西可以正常工作或根本没有。因此，对我来说，唯一的答案是*不能*或*不*应该这样做。此外，将 CGI/Perl 与 PHP 混合可能不是最佳实践。

将任何小的 CGI/Perl 脚本简单地重写为 PHP 应该不会太难。任何太大而无法重写的东西，那么在这种情况下，最好在整个站点上坚持使用 Perl。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T23:51:02.697

尝试

```
passthru("/usr/bin/perl /full/path/script.cgi"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T04:06:01.803

像 apache2 一样执行 CGI 怎么样？

我不断地将二进制 CGI 包装在 PHP5 中，没有任何问题。

您需要通过在 exec() 之前放置一些 putenv() 指令来模拟 Web 服务器调用，并使用 exec() 和 3 个给定参数（以检查返回值是否为 0）。

putenv() 可用于建立与 apache2 提供 CGI 完全相同的环境——它也适用于传递 URL 参数。

如果一个人可以选择用一种语言写作，那肯定会更好——

但是有些场景需要接口——是否只需要创建 I/O 包装器。

如果您不能以这种方式成功 - 如果您使用 cURL 调用 cgi，则 apache2 将通过调用创建所需的环境。这可能比要求的更复杂 - 更像是最后的手段。

对不起，我不能提供一个例子，可能足以说明它是如何工作的。

相反，它正在寻找一种从 CGI 执行 PHP 的方法 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-12T16:09:18.560

```
<?php
$cgi = exec_cgi("path to cgi");
$cgi->addParameter->contentType("typeofcode");
?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-13T18:07:20.793

为我工作

```
<?
echo "sometextadd".shell_exec( "/dirtofile/filecontaincgi.cgi  | {

#commandinssh as sed 's/.*$/&<\/TR><TD>/' | and other

}")."sometextadd";

?> 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-07-10T07:24:49.503

我从这里得到了以下对我有用的解决方案：[link](https://help.brinkster.com/KB/a273/php-call-out-to-cgi-script-example.aspx)

为了方便起见，转储代码：

```
 <?php
    $data = file_get_contents("http://fullpathto.cgi",0);
    echo $data;
    ?> 
```

安装程序是 C++ 编译的 .cgi 模块，在 zend 服务器 + unix box 上运行

# php - 带有 __set() 和 __get() 的多维数组

> ID：10507983
> 
> 赞同：1
> 
> 时间：2012-05-08T23:36:16.820
> 
> 标签：php, methods, multidimensional-array, magic-methods

> **可能重复：**
> [使用 __set 解决数组，但为什么呢？](https://stackoverflow.com/questions/4310473/using-set-with-arrays-solved-but-why)

`__set()`是否可以使用 PHP 的魔法和方法设置多维数组`__get()`？即`$Foo->arrayKey['anotherKey']='newValue';`会设置`$foo->_data['arrayKey']['anotherKey']=='newValue';`

```
//example setting values to $_data[$k]
class Foo
{
   private $_data=array();

   public function __set($k, $v)
   {
       $this->_data[$k]=$v;
   }

   public function __set($k)
   {
       return $this->_data[$k];
   }
} 
```

# algorithm - 查找 SVG 路径内的最大矩形

> ID：10507984
> 
> 赞同：1
> 
> 时间：2012-05-08T23:36:24.793
> 
> 标签：algorithm, math, svg, geometry

给定由 SVG 路径构成的不规则形状，如何计算可以容纳在其中的最大矩形（只有水平和垂直边框）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:56:34.633

I don't think you can find the largest rectangle in the general case. You should better consider the problem to find the largest rectangle that fits inside a shape that is drawn on a grid, it will give you a good approximation of what you are looking for and by decreasing the step of the grid, you can increase the precision of your approximation.

On a grid the problem can be solved in O(n) where n is the number of cells in the grid.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:35:19.153

SVG 路径由线段、三次贝塞尔路径、二次贝塞尔路径和椭圆弧组成。因此它是分段可微的。它由有限数量的段组成，而不是无限循环。别笑，像 Haskell 这样的“懒惰”编程语言可以很容易地表示这样的事情，但在 SVG 中是不允许的。特别是，尽管 SVG 路径在我们看来可能看起来像分形，但它在数学上不可能是分形。此外，常量只能是整数或 IDL 浮点数，它们是 IEEE 单精度浮点数。因此，在网格点处具有所有这些数字的网格的分辨率可能被认为很大，但它肯定是有限的。

使用这些事实，我声称一般来说，如果 SVG 路径包含一个区域，那么路径中包含的矩形存在最大区域；并且有一种易于处理的算法可以找到（至少）一个面积最大的矩形。

任何算法都需要考虑困难的情况，例如（近似）空间填充曲线，它可能有大量小但仍然“最大”的矩形。我不知道算法，所以我们可以在这里考虑如何开发一个。你能解决仅由线段构成的路径的问题吗？网格生成算法会有帮助吗？考虑具有相同中心和面积的矩形的角在一对双曲线上是否有帮助？了解凸包算法是否有帮助？您是否需要称为 max-min 的微分方法，或者可能不需要？那么，您将如何扩展您的算法以允许其他类型的路径段？将这些路径段近似为多边形路径是否有必要、有帮助或没有必要？

# php - MySQL 从 php var 和其他表中插入组合

> ID：10507987
> 
> 赞同：1
> 
> 时间：2012-05-08T23:36:48.290
> 
> 标签：php, mysql, sql

我正在尝试将 php 变量和来自另一个表的 1 行数据的组合插入到我的 sql 表中。我发现了类似的例子，但没有一个具有这种组合的例子。

`OTHERTABLE.liveDate`将是我需要单条记录的地方，但我需要添加一个条件，例如`WHERE id='1'`来自 OTHERTABLE

`'$navid', '$loginid', '$total', '$where'`不是来自 OTHERTABLE

```
INSERT INTO myTable (`navid`,`loginid`, `pageDisplayNum`, `whereFrom`, `liveDate`) 
VALUES ('$navid', '$loginid', '$total', '$where', 'OTHERTABLE.liveDate') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:40:30.787

```
INSERT INTO myTable (`navid`,`loginid`, `pageDisplayNum`, `whereFrom`, `liveDate`) 
select '$navid', '$loginid', '$total', '$where', OTHERTABLE.liveDate 
from OTHERTABLE
where OTHERTABLE.id='1' 
```

# seo - 谷歌上次抓取我的网站时的 API，请提供 URL？

> ID：10507993
> 
> 赞同：1
> 
> 时间：2012-05-08T23:37:48.913
> 
> 标签：seo, google-search

我有一堆目前已在 Google 中编入索引的 URL。鉴于这些网址，有没有办法弄清楚谷歌最后一次抓取它们是什么时候？

手动，如果我检查 Google 中的链接并检查“缓存”链接，我会看到它被抓取的日期。有没有办法自动做到这一点？某种 Google API？

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T17:48:51.993

Google 不为此类数据提供 API。跟踪上次抓取信息的最佳方法是挖掘您的服务器日志。

在您的服务器日志中，您应该能够通过它的典型用户代理识别 Googlebot：`Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html)`。然后您可以查看 Googlebot 抓取了哪些网址以及何时抓取。

如果您想确定是 Googlebot 抓取了这些页面，您可以[使用反向 DNS 查找来验证它。](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=80553). Bingbot 还支持反向 DNS 查找。

如果您不想手动解析服务器日志，您可以随时使用[splunk](http://www.splunk.com/)或[logstash 之](http://logstash.net/)类的东西。两者都是很棒的日志处理平台。

另请注意，SERP 中的“缓存”日期不一定与上次抓取的日期相匹配。Googlebot 可以在“缓存”日期之后多次抓取您的网页，但不会更新其缓存版本。您可以将“缓存日期”更多地视为“最后索引”日期，但这也不完全正确。无论哪种情况，如果您需要重新索引页面，您始终可以使用 Google 网站管理员工具 (GWT)。GWT 中有一个选项可以强制 Googlebot 重新抓取页面，并重新索引页面。每周有 50 个或类似的限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T13:56:26.630

```
<?php

$domain_name = $_GET["url"];

//get googlebot last access
function googlebot_lastaccess($domain_name)
{
    $request = 'http://webcache.googleusercontent.com/search?hl=en&q=cache:'.$domain_name.'&btnG=Google+Search&meta=';
    $data = getPageData($request);
    $spl=explode("as it appeared on",$data);
   //echo "<pre>".$spl[0]."</pre>";
    $spl2=explode(".<br>",$spl[1]);
    $value=trim($spl2[0]);
   //echo "<pre>".$spl2[0]."</pre>";
    if(strlen($value)==0)
    {
        return(0);
    }
    else
    {
        return($value);
    }      
} 

$content = googlebot_lastaccess($domain_name);
$date = substr($content , 0, strpos($content, 'GMT') + strlen('GMT'));
echo "Googlebot last access = ".$date."<br />"; 

function getPageData($url) {
 if(function_exists('curl_init')) {
 $ch = curl_init($url); // initialize curl with given url
 curl_setopt($ch, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']); // add useragent
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); // write the response to a variable
 if((ini_get('open_basedir') == '') && (ini_get('safe_mode') == 'Off')) {
 curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true); // follow redirects if any
 }
 curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5); // max. seconds to execute
 curl_setopt($ch, CURLOPT_FAILONERROR, 1); // stop when it encounters an error
 return @curl_exec($ch);
 }
 else {
 return @file_get_contents($url);
 }
}
?> 
```

只需上传这个 PHP 并创建一个 Cron-Job。您可以按以下方式对其进行测试.../bot.php/url=http://www....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T14:28:32.010

[您可以使用链接http://www.gbotvisit.com/](http://www.gbotvisit.com/)检查 google bot 上次访问

# iphone - 如何加密 iPhone 上传和下载信息？

> ID：10507994
> 
> 赞同：4
> 
> 时间：2012-05-08T23:37:54.007
> 
> 标签：iphone, security, caching, encryption, ssl

如果我为我的 iphone 应用程序使用 SSL 连接以使用 web 作为数据源来查询数据库，那么从服务器到 iphone 来回传输的链接和信息是否可能会以没人能看到的方式加密。此外，我相信 iPhone 会缓存信息，Web 界面可以缓存进出设备的数据。

另一个人告诉我：

> SSL 只是传输，应用程序在设备上使用的内容并没有加密，因为传输的内容是加密的。如果应用程序不使用缓存并且您使用 SSL，那么您可能是安全的，简单的事实是几乎所有应用程序都会在传输数据之前缓存数据。因此，您的设备上会有未加密的数据。

那么，如果我想构建一个使用 Web 作为数据源、在应用程序上不存储任何内容并且不使用缓存的应用程序，我有什么选择。我希望所有来自和将要加密的数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:42:34.580

在某个时候，您将从服务器接收数据。这些数据需要放在某个地方，比如数据缓冲区。绝对没有办法解决这个问题。如果您使用 SSL，则传输过程将被加密。正如您的“其他人”所说，只要您不明确缓存数据，那么您可以在 iOS 上保护自己。

我不确定你在这里期待什么，否则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T23:43:39.497

没有任何。除了传输数据之外，要执行任何操作，您需要对其进行解密。如果它被解密，它将在您设备的 RAM 中。这有多安全取决于应用程序。理论上可以对加密数据执行一些操作，但实际上这仅对少数应用程序有用（而且很难开发）。