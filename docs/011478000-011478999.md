# StackOverflow 问答 11478000-11478999

# c# - .NET 中的 URL 编码正斜杠 (/)

> ID：11478002
> 
> 赞同：9
> 
> 时间：2012-07-13T20:35:35.610
> 
> 标签：c#, url, rabbitmq

如何强制`Uri`或`HttpWebRequest`允许包含两者的uri `/`，`%2f`如下所示？

```
http://localhost:55672/api/exchanges/%2f/MyExchange 
```

* * *

我试过这个...

```
WebRequest request = 
    HttpWebRequest.Create("http://localhost:55672/api/exchanges/%2f/MyExchange"); 
```

...还有这个...

```
Uri uri = new Uri("http://localhost:55672/api/exchanges/%2f/MyExchange", true);
WebRequest request = HttpWebRequest.Create(uri); 
```

...还有这个...

```
UriBuilder builder = new UriBuilder();
builder.Port = 55672;
builder.Path = "api/exchanges/%2f/MyExchange";
WebRequest request = HttpWebRequest.Create(builder.Uri); 
```

但是，所有这些`request.RequestUri`最终`http://localhost:55672/api/exchanges///MyExchange`都会`request.GetResponse()`产生 404 响应。

仅供参考，我正在尝试使用 RabbitMQ 的 HTTP API 并在 Chrome 中键入 Url 会产生预期的 JSON 结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-23T21:12:12.180

我们刚刚遇到了同样的问题，发现如果您的目标是 .NET 4.0 框架，就会存在这个问题。如果您以 .NET 4.5 框架为目标，它就会消失。因此，如果这是您的选择，请切换您的目标框架，它应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-24T09:59:58.913

不久前与 RabbitMQ 管理 API 通信时，我遇到了同样的问题。我写了一篇关于它的博客文章，包括几个解决方案：

[http://mikehadlow.blogspot.co.uk/2011/08/how-to-stop-systemuri-un-escaping.html](http://mikehadlow.blogspot.co.uk/2011/08/how-to-stop-systemuri-un-escaping.html)

您可以通过对 System.Uri 代码的一些讨厌的反射或通过 App.config（或 Web.config）中的设置来关闭该行为：

```
<uri> 
    <schemeSettings>
        <add name="http" genericUriParserOptions="DontUnescapePathDotsAndSlashes" />
    </schemeSettings>
</uri> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T20:40:21.967

请使用 Server.UrlEncode 它是服务器端必需的，否则将是 System.Uri.EscapeDataString

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T20:37:24.587

对包含保留字符的部分使用 Server.Encode。 [http://msdn.microsoft.com/en-us/library/ms525738(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/ms525738(v=vs.90).aspx)

# perl - Perl：从另一个文件访问“我的”变量

> ID：11478010
> 
> 赞同：5
> 
> 时间：2012-07-13T20:36:30.060
> 
> 标签：perl

我们有一个用于执行维护的 Perl 脚本。我需要对其进行修改以处理更多任务。问题是脚本已编译，并且源代码很久以前就丢失了。

我尝试使用 B::Deparse 来重新创建文件，但 Deparse 并不完美，并且输出被破坏（以及非常大的 ~5000 行 deparsed 代码）。

在阅读了解析后的代码后，我发现我需要修改一个函数。编译后的脚本会加载一个纯文本脚本模块，因此我更改了模块以覆盖该函数并执行我需要它执行的任务。现在的问题是我无法访问主脚本“我的”变量。

这是一个例子：

```
# main.pl

my $a = 1;

sub call_me {
    print "unmodified";
}

use MOD;

call_me;

MOD.pm
package MOD;

main::{'call_me'} = sub {
    print "\$main::a = $main::a\n";
} 
```

结果是：“ `$main::a =`”而不是获得真正的价值。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T20:51:17.753

简短的回答是声明的变量`my`在其词法范围之外是不可访问的。如果您不能将声明更改为“我们的”（由于原始脚本的疯狂“编译”性质），那么您还没有倒霉。Perl 几乎总是提供一种方法来解决这些类型的事情。

在这种情况下，您可以安装[PadWalker](https://metacpan.org/module/PadWalker)模块并执行以下操作（这是您最初发布的代码的调整版本）：

`main.pl`脚本：

```
my $a = 1;

sub call_me {
    print "unmodified: $a";
}

use MOD;

call_me; 
```

然后你的模块：

```
package MOD;

# closed_over($code_ref) returns a hash ref keyed on variable
# name(including sigil) with values as references to the value
# of those variables
use PadWalker qw(closed_over);

{
    # grab a reference to the original sub
    my $orig = \&main::call_me;

    # no need to use the symbol table, a glob reference is fine
    # but you can't use sub main::call_me { ... } either
    *main::call_me = sub {
        my $a = closed_over($orig)->{'$a'};
        print "\$main::a = $$a\n";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-18T23:35:46.577

如果您有想要的特定内容，这是一个单行字。根据需要扩展。

perl -e '$foo = eval ( `cat ./my.pl`." return \$some_my_var;"); 打印“$foo”'

# java - 我可以使用同步到最终字段吗？

> ID：11478011
> 
> 赞同：5
> 
> 时间：2012-07-13T20:36:32.820
> 
> 标签：java, final, synchronize

考虑下面的代码，我想让它成为一个线程安全的类，这样它就永远不会得到奇数：

```
class Test {
  private int value = 0;
  private final Object lock;

  public void add() {
    synchronized (lock) {
      value++;
      value++;
    }
  }

  public int getValue() {
    synchronized (lock) {
      return value;
    }
  } 
} 
```

我现在对宣布为 final 的 lock 字段表示怀疑，这有关系吗？还是会破坏线程安全？

我认为如果锁字段没有声明为最终的，这应该是一个线程安全的类。如果这个结论是错误的，请纠正我，谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-13T20:42:21.103

> 我现在对宣布为 final 的 lock 字段表示怀疑，这有关系吗？

*是的，它被认为是仅*锁定`final`字段对象的最佳实践。

如果可以更改引用，则可以更改锁定的对象，从而破坏线程安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T20:42:49.110

应该可以。甚至可能使它更安全，因为在执行期间不能简单地将其他东西分配给锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T20:43:35.553

您可以使用 ReadWriteLock 来实现相同的结果并实现安全。

参考：

[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReadWriteLock.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReadWriteLock.html)

[http://www.javapractices.com/topic/TopicAction.do?Id=118](http://www.javapractices.com/topic/TopicAction.do?Id=118)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T20:51:37.943

如果您要锁定实例，那么 final 是可以接受的。如果您希望在类上锁定或放置互斥锁，则将变量设为静态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T20:42:34.307

在 Java 中，同步是由锁定对象的某个隐藏字段完成的。同样 final 意味着 REFERENCE 是最终的，而不是对象本身。

例子：

```
final Bar bar = new Bar(); //bar hase property lock
bar.lock = XYZ; //will work, object is not FINAL
bar = new Bar(); //fail, the reference is FINAL 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-13T20:54:28.610

当您尝试同步多个线程时，它们必须基于相同的对象引用/实例进行同步。这确保了它们都基于相同的数据同时同步。

希望这有点道理；您只需要基于最终变量而不是动态变量进行同步。

> 如果方法修改了静态字段，则必须同步对该字段的访问，即使该方法通常仅由单个线程使用。客户端不可能在这种方法上执行外部同步，因为不能保证不相关的客户端也会这样做，[请参阅](https://www.securecoding.cert.org/confluence/display/java/LCK05-J.+Synchronize+access+to+static+fields+that+can+be+modified+by+untrusted+code)。

# rest - 服务器端数据库处理程序脚本

> ID：11478012
> 
> 赞同：0
> 
> 时间：2012-07-13T20:36:33.040
> 
> 标签：rest, restful-url, restful-architecture

我们正在通过 Python 将数据从 Linux 设备推送到 cosm.com 上的 RESTful API。我们现在想在我们自己的服务器上实现数据处理和存储。特别是，HTTP PUT 方法用于推送到站点的 API。

我是 1 的研发人员，我在枪下。
感谢您的时间。

# java - Java regexp 分组替换

> ID：11478015
> 
> 赞同：6
> 
> 时间：2012-07-13T20:36:57.860
> 
> 标签：java, regex

有没有办法转换字符串

```
"m1, m2, m3" 
```

到以下

```
"m1/build, m2/build, m3/build" 
```

仅通过使用`String.replaceAll(regex, replacement)`方法？

到目前为止，这是我最好的尝试：

```
System.out.println("m1, m2, m3".replaceAll("([^,]*)", "$1/build"));
>>> m1/build/build, m2/build/build, m3/build/build 
```

如您所见，输出不正确。但是，在 Linux 的`sed`命令中使用相同的正则表达式会给出正确的输出：

```
echo 'm1, m2, m3' | sed -e 's%\([^,]*\)%\1/build%g'
>>> m1/build, m2/build, m3/build 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T20:41:39.917

如果你从另一端看问题（从字面上看！）你会得到一个寻找终结符的表达式，而不是内容。这个表达式效果更好：

```
System.out.println("m1, m2, m3".replaceAll("(\\s*(,|$))", "/build$1")); 
```

这是[ideone 上该程序的链接](http://ideone.com/jYnUA)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T20:41:24.903

`([^,]*)`可以匹配空字符串，甚至可以匹配两个空格。尝试`([^,]+)`或`(\w+)`。

另一个小注意事项 - 您可以`$0`用来引用整个匹配的字符串，避免捕获的组：

```
System.out.println("m1, m2, m3".replaceAll("\\w+", "$0/build")); 
```

# css - IE7 z-index 和堆叠上下文 -- z-index 可以在任何地方使用，除了 IE7

> ID：11478029
> 
> 赞同：1
> 
> 时间：2012-07-13T20:38:39.587
> 
> 标签：css, internet-explorer-7, z-index

所以我想出了这个jsfiddle： http: [//jsfiddle.net/3sdES/2/](http://jsfiddle.net/3sdES/2/)，它产生了一些有趣的结果。

在 IE7 以外的任何浏览器中，页面呈现的“modal”元素覆盖在其他所有内容之上： ![铬屏幕截图](../Images/7a053a3d6734d748a3f7e442f784f3d9.png)

但是在 IE7 中，z-indexes 似乎不像在其他地方那样工作： ![IE7截图](../Images/5a81d4a31a56a74ec5e259dbb6b834e7.png)

我理解 IE7 和 z-indexes 的方式是它为每个设置了“位置”的元素创建一个新的堆叠索引。但是我在这里处理的所有元素都有位置设置；我的理解是它们应该在相同的堆叠上下文中，因此背景（z-index 1040）应该出现在模态（z-index 1050）后面……但显然 IE7 不会发生这种情况。

有什么想法吗？我已经尝试在整个 DOM 中移动内容，在任何地方应用位置和 z-index，但我无法让 IE7 满意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T20:46:15.727

将 1200 的 z-index 应用于`.module`模态周围的 div 可修复 IE7 中的问题。

# java - 在 Lucene 中模糊搜索多词项

> ID：11478030
> 
> 赞同：2
> 
> 时间：2012-07-13T20:38:48.950
> 
> 标签：java, lucene

我正在尝试添加搜索功能，允许人们通过电子邮件地址（如果有）或姓名（如果没有）查找潜在朋友。我目前正在研究 Lucene，但我愿意考虑其他解决方案。我正在尝试创建一组文档：

```
|  id  |   text   |   text   |
| 1234 | a@b.com  | John Doe |
| 1235 | ab@c.com | Jane Doe |
| 1236 | c@ba.com | Madonna  | 
```

（是的，`text`指定为乘）

这都被索引了

```
new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, new KeywordAnalyzer())); 
```

然后我进行搜索：

```
TopDocs results = mySearcher.search(
    new FuzzyQuery(new Term("text", term), 2, 0),
    10); 
```

我可以很好地使用电子邮件进行搜索。搜索`a@b.com`，`ab@c.com`一切正常。我也可以搜索单个单词的名称，比如`Madonna`就好了。但是，一旦我尝试找到多词名称，一切就崩溃了。搜索`John`、`Jane`、`John Doe`或`Doe`全部不返回任何结果。

我很好奇更好的方法（2 编辑距离匹配可以带我走多远有一些明显的限制），以及如何使多词匹配起作用。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-19T11:38:45.140

至于多词匹配，我会查看您的分析器，以及您传递给每个文档中每个字段的 analyze.yes / analyze.no 设置。

分析器对搜索进行标记，但如果您不使用相同的分析器实例进行搜索和索引，则会出现各种带有空格的奇怪行为 - 除其他外。

# oracle - Oracle group by，从非分组列中获取第一个元素

> ID：11478033
> 
> 赞同：3
> 
> 时间：2012-07-13T20:39:01.950
> 
> 标签：oracle, group-by, aggregate

我对 Oracle 很陌生，最近遇到了一个问题：

我有一个包含以下列的表：person_id、account_login、add_date。

```
person_id | account_login | add_date
----------|---------------|------------
1         | user1         | 2012-07-10
1         | user2         | 2012-07-09
2         | user3         | 2012-07-05
2         | user4         | 2012-07-04 
```

一个人可以有多个 account_logins。对于每个人，我想获取最旧的 account_login ：

```
person_id | account_login | add_date
----------|---------------|------------
1         | user2         | 2012-07-09
2         | user4         | 2012-07-04 
```

所以我所做的是：

```
select
  person_id,
  MAX(account_login) KEEP (DENSE_RANK FIRST ORDER BY add_date)
from
  table
group by
  person_id; 
```

我得到了我想要的结果，但我认为我的查询语法远非良好。Oracle 强迫我使用聚合函数，我使用 MAX() 或 MIN() 知道它完全没有意义。

有没有办法比这更好地编写查询？（甲骨文 11g）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:09:37.937

您可以单独使用 DENSE_RANK 作为分析，并从结果查询中进行选择：

```
SELECT person_id, account_login, add_date
  FROM (SELECT table.*
             , DENSE_RANK() OVER (PARTITION BY person_id ORDER BY add_date) rnk
         FROM table)
 WHERE rnk = 1; 
```

不确定您认为哪个版本更优雅。如果您在同一日期为特定的 person_id 创建了两个帐户，它也没有说明该怎么做。如果您的 add_date 中也有时间组件，那么您应该没问题。如果可能出现平局，也许 ROW_NUMBER() 会给你一个更理想的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T01:06:52.450

您可以像这样加入表格和嵌套视图

```
select person_id,account_login,add_date
from tab inner join 
(select person_id,min(add_date) add_date 
from tab group by person_id) 
using(person_id,add_date) 
```

顺便说一句，我真的不认为这很清楚。

# c++ - C C++ 函数名冲突和崩溃不一致

> ID：11478034
> 
> 赞同：3
> 
> 时间：2012-07-13T20:39:04.000
> 
> 标签：c++, function, conflict

有人可以解释此用户错误导致不一致崩溃的幕后原因。

这里是主要功能

```
#include "foo.h"  
inline int Bar(const int &a)  
{  
...  
}  
...  
int b=Bar(a); 
```

在“foo.C”中还有一个函数的副本

```
inline int Bar(const int &a) 
```

这是问题所在。我既没有 foo.h 也没有 foo.C，并且 foo.h 中没有 Bar(int) 的声明。
在我的同事更新了他的 foo.C 中的一些其他函数之后，一切都可以编译并与旧版本的 foo.h 和 foo.C 一起正常工作，代码仍然可以正常编译，但它在执行时开始崩溃。
通过 ddd 调试显示，当我的 main 函数调用 Bar() 时，它实际上是在 foo.C 中调用 Bar()，而不是我自己定义的 Bar()。
当然，修复是静态我自己的函数或更改我自己的 Bar() 函数的名称。

我知道编写这样的代码杂乱无章，并且容易出现这样的错误。有人可以向我解释为什么代码会不一致地崩溃吗？

谢谢你们

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T20:51:57.527

内联函数仍然有外部链接。也就是说，它们由编译器发出到相应的目标文件中，当链接器链接应用程序时，它认为所有具有相同签名（包括它们的名称和封闭命名空间）的函数都是相同的。由于定义了该函数，`inline`它随机选择其中一个定义并删除另一个定义，而不会出错。（这违反了*单一定义规则*，根据标准导致未定义的行为。）

为防止出现此问题，请使用匿名命名空间，如下所示：

```
namespace {
inline int Bar(const int &a)  
{  
...  
}  
} 
```

在您的情况下，在 foo.C 或 main 中这样做就可以了。等效地，您可以添加`static`：

```
static int Bar() {} 
```

如果你用 C 语言编写。

使用匿名命名空间或`static`关键字使函数成为翻译单元的本地函数，因此链接器不会将其视为外部符号。这样，您可以在不同的翻译单元中拥有具有相同签名的任意数量的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T20:52:30.590

我认为您正在使用 foo 定义的 Bar 函数，因为在您定义自己的 Bar 函数之前，它是通过 foo.h #included 的。

我很惊讶您的编译器没有警告您有关重复定义（非法），但是如果您在 #include "foo.h" 之前定义了 Bar 函数，则应该会引发错误。

这个 URL 说重新定义内联是非法的，除非内联是相同的：

[C静态内联函数重定义规则](https://stackoverflow.com/questions/6448276/c-static-inline-function-redefinition-rules)

我的编译器对此抛出错误。最好的避免方法是使用单独的命名空间或宏保护。

# asp.net-mvc - 从 MvcHtmlString 解析属性

> ID：11478035
> 
> 赞同：0
> 
> 时间：2012-07-13T20:39:06.437
> 
> 标签：asp.net-mvc, asp.net-mvc-3, validation, html-helper, unobtrusive-validation

我需要能够解析 MvcHtmlString 中的属性（HtmlHelper 扩展的结果），以便我可以更新和添加它们。

例如，以这个 HTML 元素为例：

```
<input type="text" id="Name" name="Name" 
 data-val-required="First name is required.|Please provide a first name."> 
```

我需要从中获取值`data-val-required`，将其拆分为两个属性，第二个值进入一个新属性：

```
<input type="text" id="Name" name="Name" 
 data-val-required="First name is required."
 data-val-required-summary="Please provide a first name."> 
```

我正在尝试使用 HtmlHelper 扩展方法来执行此操作，但我不确定解析属性的最佳方法。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-14T01:06:53.587

完成您想要的一个想法是使用全局操作过滤器。这将获取操作的结果，并允许您在将它们发送回浏览器之前对其进行修改。我使用这种技术将 CSS 类添加到页面的 body 标记中，但我相信它也适用于您的应用程序。

这是我使用的代码（归结为基础）：

```
public class GlobalCssClassFilter : ActionFilterAttribute {
    public override void OnActionExecuting(ActionExecutingContext filterContext) {
        //build the data you need for the filter here and put it into the filterContext
        //ex: filterContext.HttpContext.Items.Add("key", "value");

        //activate the filter, passing the HtppContext we will need in the filter.
        filterContext.HttpContext.Response.Filter = new GlobalCssStream(filterContext.HttpContext);
    }
}

public class GlobalCssStream : MemoryStream {
    //to store the context for retrieving the area, controller, and action
    private readonly HttpContextBase _context;

    //to store the response for the Write override
    private readonly Stream _response;

    public GlobalCssStream(HttpContextBase context) {
        _context = context;
        _response = context.Response.Filter;
    }

    public override void Write(byte[] buffer, int offset, int count) {
        //get the text of the page being output
        var html = Encoding.UTF8.GetString(buffer);

        //get the data from the context
        //ex var area = _context.Items["key"] == null ? "" : _context.Items["key"].ToString();

        //find your tags and add the new ones here
        //modify the 'html' variable to accomplish this

        //put the modified page back to the response.
        buffer = Encoding.UTF8.GetBytes(html);
        _response.Write(buffer, offset, buffer.Length);
    }
} 
```

需要注意的一件事是，我相信 HTML 被缓冲到 8K 块中，因此如果您的页面超过该大小，您可能必须确定如何处理它。对于我的应用程序，我不必处理这个问题。

此外，由于所有内容都是通过此过滤器发送的，因此您需要确保所做的更改不会影响 JSON 结果等内容。

# configuration - Hadoop 配置属性返回 Null

> ID：11478036
> 
> 赞同：1
> 
> 时间：2012-07-13T20:39:09.133
> 
> 标签：configuration, hadoop, configuration-files

我写了一个简单的代码来测试如何在 Hadoop 中设置配置。

```
public static void main(String[] args) {

        Configuration conf = new Configuration();
        conf.addResource("~/conf.xml");
        System.out.println(conf);
        System.out.println(conf.get("color"));
} 
```

上述程序的输出为：

```
Configuration: core-default.xml, core-site.xml, ~/conf.xml
null 
```

从而`conf.get("color")`返回`null`。但是，我已将该属性明确设置`conf.xml`如下：

```
<property>
        <name>color</name>
        <value>yellow</value>
        <description>Color</description>
</property> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T22:02:34.237

需要将资源添加为 URL，否则字符串将被解释为类路径资源（目前无法解析并被忽略 - 我知道您认为警告消息会被转储到某处）：

```
/**
 * Add a configuration resource. 
 * 
 * The properties of this resource will override properties of previously 
 * added resources, unless they were marked <a href="#Final">final</a>. 
 * 
 * @param name resource to be added, the classpath is examined for a file 
 *             with that name.
 */
public void addResource(String name) {
  addResourceObject(name);
} 
```

无论如何，试试这个（我在 syserr 中变黄了）：

```
@Test
public void testConf() throws MalformedURLException {
    Configuration conf = new Configuration();

    conf.addResource(new File("~/conf.xml")
            .getAbsoluteFile().toURI().toURL());
    conf.reloadConfiguration();
    System.err.println(conf);

    System.err.println(conf.get("color"));
} 
```

# c - 什么是nameser_compat.h，为什么不包括在内？

> ID：11478037
> 
> 赞同：3
> 
> 时间：2012-07-13T20:39:08.430
> 
> 标签：c, macos, bind

我正在尝试获取一些代码来编译，这些代码试图在 nameser_compat.h 头文件中使用一些定义。如果设置了某些 BIND 兼容性，则该文件显然包含在 nameser.h 中。

我正在尝试在 OSX 上编译，但显然未设置此值，因为它没有将文件拉入。除了 nameser.h 之外，我是否应该手动将 nameser_compat.h 导入到我的代码中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T00:05:26.983

在我的 Mac OS X 10.7.4 机器上，我可以找到三个相关的文件：

```
/usr/include/arpa/nameser.h
/usr/include/arpa/nameser_compat.h
/usr/include/nameser.h 
```

我采用了这段微不足道的代码（在文件中`xx.c`）：

```
#include <nameser.h>
int main(void) { return 0; } 
```

并像这样编译它以获得显示的输出：

```
$ /usr/bin/gcc -O3 -g -std=c99 -Wall -Wextra -DBIND_8_COMPAT -H -c xx.c
. /usr/include/nameser.h
.. /usr/include/arpa/nameser_compat.h
... /usr/include/machine/endian.h
.... /usr/include/i386/endian.h
..... /usr/include/sys/cdefs.h
...... /usr/include/sys/_symbol_aliasing.h
...... /usr/include/sys/_posix_availability.h
..... /usr/include/sys/_endian.h
...... /usr/include/libkern/_OSByteOrder.h
....... /usr/include/sys/_types.h
........ /usr/include/machine/_types.h
......... /usr/include/i386/_types.h
....... /usr/include/libkern/i386/_OSByteOrder.h
.. /usr/include/sys/param.h
... /usr/include/sys/types.h
.... /usr/include/sys/appleapiopts.h
.... /usr/include/machine/types.h
..... /usr/include/i386/types.h
...... /usr/include/i386/_types.h
.... /usr/include/sys/_structs.h
... /usr/include/sys/syslimits.h
... /usr/include/machine/param.h
.... /usr/include/i386/param.h
..... /usr/include/i386/_param.h
... /usr/llvm-gcc-4.2/bin/../lib/gcc/i686-apple-darwin11/4.2.1/include/limits.h
.... /usr/llvm-gcc-4.2/bin/../lib/gcc/i686-apple-darwin11/4.2.1/include/syslimits.h
.... /Applications/Xcode.app/Contents/Developer/usr/llvm-gcc-4.2/lib/gcc/i686-apple-darwin11/4.2.1/include/limits.h
..... /Applications/Xcode.app/Contents/Developer/usr/llvm-gcc-4.2/lib/gcc/i686-apple-darwin11/4.2.1/include/syslimits.h
..... /usr/include/limits.h
...... /usr/include/machine/limits.h
....... /usr/include/i386/limits.h
........ /usr/include/i386/_limits.h
... /usr/include/sys/signal.h
.... /usr/include/machine/signal.h
..... /usr/include/i386/signal.h
...... /usr/include/i386/_structs.h
.... /usr/include/sys/_structs.h
..... /usr/include/machine/_structs.h
...... /usr/include/i386/_structs.h
....... /usr/include/mach/i386/_structs.h
Multiple include guards may be useful for:
/usr/include/sys/_symbol_aliasing.h
$ 
```

这表明使用`-DBIND_8_COMPAT`set，`nameser_compat.h`包含标题。源代码显示这是预期的：

```
#ifndef _NAMESER_9_H_
#define _NAMESER_9_H_

#ifdef BIND_8_COMPAT
#include <arpa/nameser_compat.h>
#endif 
```

# objective-c - 在目标 c 中使用 ivars 与属性的原因

> ID：11478038
> 
> 赞同：24
> 
> 时间：2012-07-13T20:39:13.200
> 
> 标签：objective-c, properties, ivar

我一直找不到关于这个主题的任何信息，而且我所知道的大部分信息都是完全偶然的（并且花了几个小时试图弄清楚我的代码为什么不起作用）。在学习objective-c时，我发现大多数教程都使用相同的名称制作变量和属性。我不明白其重要性，因为似乎该属性完成了所有工作，而变量只是坐在那里。例如：

**测试.h**

```
@interface Test : NSObject {
    int _timesPlayed, _highscore;
}

@property int timesPlayed, highscore;

// Methods and stuff

@end 
```

**测试.m**

```
@implementation Test

  @synthesize timesPlayed = _timesPlayed;
  @synthesize highscore   = _highscore;

  // methods and stuff

@end 
```

**我知道的**

1）好的，所以今天我发现（经过数小时的困惑），无论您对属性做了多少更改，`highscore = 5091231`当您尝试调用 [test highscore] 时它都不会改变任何东西，因为它仍然会返回 _highscore 的值其中（我认为）是在 test.h 中设置的 ivar。所以 test.m 中所有变量的变化都需要改变 _highscore 而不是 highscore。（如果我在这里错了请纠正我）

2）如果我理解正确（我可能不理解）， test.h 中设置的 ivars 代表实际内存，而 @properties 只是访问该内存的方法。因此，在实现之外，我无法访问 _highscore 而不通过该属性。

**我不明白的**

基本上我对这种情况不了解的是我是否需要使用 ivars 或者我是否可以只使用 @property 和 @synthesize。似乎 ivars 只是额外的代码，除了让我感到困惑之外，它并没有真正做任何事情。我见过的一些最近的 tuts 似乎没有使用 ivars，但后来有些使用了。那么这只是编码偏好还是实际上很重要？我曾尝试通过 Apple 的文档进行搜索，但我在其中迷失了方向，似乎从未找到我想要的东西。任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-07-13T20:51:09.530

您可以将合成属性的语法视为`@synthesize propertyName = variableName`.

这意味着如果您编写`@synthesize highscore = _highscore;`一个具有该名称的新 ivar，`_highscore`将为您创建。因此，如果您愿意，您可以通过访问变量直接访问存储属性的`_highscore`变量。

# 一些背景

在某些我不记得的编译器版本之前，综合语句没有创建 ivar。相反，它只说明了它应该使用什么变量，所以你必须声明变量和属性。如果您使用下划线前缀合成，那么您的变量需要具有相同的前缀。现在您不必再自己创建变量，而是将创建一个具有`variableName`您在综合语句中指定的变量（如果您还没有自己声明它，在这种情况下它只是用作财产）。

# 你的代码在做什么

您`highscore`在声明变量时显式创建一个调用的 ivar，然后`_highscore`在合成属性时隐式创建另一个调用的 ivar。这些不是同一个变量，因此更改其中一个不会改变另一个。

# 是否应该使用变量？

这确实是一个关于偏好的问题。

## 临变量

有些人觉得如果你不必到处写代码，代码就会变得更干净`self.`。人们还说它更快，因为它不需要方法调用（尽管它可能永远不会对您的应用程序性能产生可衡量的影响）。

## 专业属性

更改属性的值将调用所有必要的 KVO 方法，以便其他类可以在值更改时得到通知。默认情况下，对属性的访问也是原子的（不能从多个线程访问），因此从多个线程读取和写入属性更安全（这并不意味着属性指向的对象是线程安全的，如果它是一个可变数组，然后多线程仍然可以破坏非常糟糕的东西，它只会阻止两个线程将属性设置为不同的东西）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-13T20:50:32.527

正如您所建议的，您可以只使用`@property`和`@synthesize`不声明 ivars。上面的问题是您`@synthesize`将属性名称映射到编译器生成的新 ivar。因此，出于所有意图和目的，您的类定义现在是：

```
@interface Test : NSObject {
int timesPlayed;
int highscore;
int _timesPlayed;
int _highscore;
}
...
@end 
```

如果您通过访问它，直接为 ivar 分配值`timesPlayed`将永远不会显示，`self.timesPlayed`因为您没有修改正确的 ivar。

你有几个选择：

1 删除您在原始帖子中声明的两个 ivars，让`@property`/`@synthesize`动态二人组做他们的事情。

2 将您的两个 ivars 更改为以下划线“_”为前缀

3 将您的`@synthesize`陈述更改为：

```
@implemenation Test
@synthesize timesPlayed;
@synthesize highscore;

... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T20:56:46.753

我通常只使用@property 和@synthenize。

@property 为编译器和用户提供有关如何使用您的属性的说明。天气它有一个二传手，那个二传手是什么。它期望并返回什么类型的值。这些指令然后被自动完成（以及最终将针对类编译的代码）和@synthesize 使用

@synthesize 默认会创建一个与你的属性同名的实例变量（这可能会让人感到困惑）

我通常会执行以下操作

```
@synthesize propertyItem = _propertyItem; 
```

这将默认创建一个 getter 和一个 setter 并处理自动释放以及创建实例变量。它使用的实例变量是_propertyItem。如果你想访问实例变量，你可以这样使用它。

```
_propertyItem = @"Blah"; 
```

这是一个错误。您应该始终使用 getter 和 setter。这将使应用程序根据需要发布和更新。

```
self.propertyItem = @"Blah"; 
```

这是处理它的更好方法。使用 synthesize 的 = _propertyItem 部分的原因是您不能执行以下操作。

```
propertyItem = @"Blah"; // this will not work. 
```

它会建议您将其替换为 _propertyItem。但您应该改用 self.propertyItem 。

我希望这些信息有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T20:50:08.790

在您的示例中，`@synthesize timesPlayed = _timesPlayed;`创建一个名为的新 ivar `_timesPlayed`，并且该属性引用该 ivar。 `timesPlayed`将是一个完全独立的变量，与属性没有任何关系。如果您只是使用`@synthesize timesPlayed;`，那么该属性将引用`timesPlayed`.

下划线约定的目的是更容易避免当您想通过属性（即通过合成的 setter 方法）直接分配给 ivar 时意外地直接分配给 ivar。但是，如果您真的想要，您仍然可以直接访问 _timesPlayed。合成一个属性只是为 ivar 自动生成一个 getter 和 setter。

通常，您不需要为属性声明 ivar，尽管可能存在您想要的特殊情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-14T06:49:31.870

这可能是一个老问题..但在“现代”，`@synthesize`- 是不必要的。

```
@interface       SomeClass : NSObject
@property NSString * autoIvar;
@end
@implementation  SomeClass
- (id) init { return self = super.init ? _autoIvar = @"YAY!", self : nil; }
@end 
```

`_underscored`支持 ivar 是自动合成的......并且可以在 THIS 类的实现中直接使用（即，无需调用`self`/调用自动生成的访问器）。

如果您想支持子类访问（无需调用）的能力，或者出于*其他原因描述的无数其他原因，*您只*需要*合成它。`_backingIvar``self`

# javascript - rails：在页面加载之前加载图像

> ID：11478040
> 
> 赞同：-2
> 
> 时间：2012-07-13T20:39:22.060
> 
> 标签：javascript, jquery, ruby-on-rails

在页面加载时如何显示加载图像？

你们能指出我正确的方向吗？我有一个使用一些 jquery 和 javascript 的 rails 应用程序。加载页面需要一些时间。很可能是因为我在我的 javascript 中使用嵌入的 ruby​​ 代码进行了几个 SQL 查询。

现在，当用户单击链接以转到该特定站点时，几秒钟内没有任何反应，然后整个页面加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:27:51.153

您可以通过在所有内容前面放置一个带有加载动画的重叠默认 div 来创建加载页面。然后当你的 Javascript 完成时，有一个回调将隐藏加载 div。

但是，我会说 90% 的情况下，当您需要页面加载动画时，您应该考虑尽可能多地延迟加载（稍后加载）处理的方法。不惜一切代价尽量避免页面延迟。

# zend-framework - Zend Select() 在声明后添加案例？

> ID：11478042
> 
> 赞同：0
> 
> 时间：2012-07-13T20:39:33.150
> 
> 标签：zend-framework

我正在学习 Zend 框架，并且正在解决数据库带来的不便。

使用 php 你可以像这样进行一些字符串操作

```
$sqlstatement = "select id,name from TABLE where ID='$id'";

if ($admin == true) {
$sqlstatement .= " and admin = 'Yes'";  
} 
```

有没有办法用 Zend 做到这一点？目前我正在做这样的事情。

```
if ($admin == true){

   $sqlstatement = $this->select()
                        ->from($this->_name,array('id','name'))
                        ->where("ID='$id'")
                        ->where("admin = 'Yes'");

}else{

   $sqlstatement = $this->select()
                        ->from($this->_name,array('id','name'))
                        ->where("ID='$id'");
} 
```

理想情况下，我想做类似...

```
 $sqlstatement = $this->select()
                        ->from($this->_name,array('id','name'))
                        ->where("ID='$id'");
if ($admin == true){
       $sqlstatement .= $this->select()
                             ->where("admin = 'Yes'");
} 
```

我有一个模型创建查询并将它们返回到我的视图。所以 $this->select() 实际上发生在我的模型类函数中并返回 Zend_Db_Table_Row 对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T20:40:47.323

是`select()`的，返回选择对象，您可以根据需要多次调用方法，因此：

```
$sqlstatement = $this->select()
                     ->from($this->_name,array('id','name'))
                     ->where("ID='$id'");
if ($admin == true){
       $sqlstatement->where("admin = 'Yes'");
} 
```

你也应该真正使用参数化查询来避免 SQL 注入，所以我会将这段代码重写为：

```
$sqlstatement = $this->select()
                     ->from($this->_name, array('id','name'))
                     ->where('ID= ?', $id);
if ($admin){
       $sqlstatement->where('admin = ?', 'Yes');
} 
```

# android - Chris Banes 在 Fragment 中拉取刷新 ListView/GridView

> ID：11478047
> 
> 赞同：3
> 
> 时间：2012-07-13T20:40:08.327
> 
> 标签：android, listview, fragment, pull-to-refresh

我正在尝试将 Chris Banes Pull 包含在 Fragment 中以刷新实现，并且在创建 PullToRefreshListView 时出现以下错误：

```
java.lang.NoSuchFieldError: com.handmark.pulltorefresh.library.R$id.pull_to_refresh_text 
```

PullToRefreshListView 创建的重点是在继承 ListFragment 的类中的 onCreateView：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {

    ViewGroup viewGroup = (ViewGroup) super.onCreateView(inflater, container, savedInstanceState);

    View lvOld = viewGroup.findViewById(android.R.id.list);

    listView = new PullToRefreshListView(getActivity());
    listView.setId(android.R.id.list);
    listView.setLayoutParams(new FrameLayout.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, ViewGroup.LayoutParams.FILL_PARENT));
    listView.setDrawSelectorOnTop(false);
    adapter = new LazyAdapter(getActivity());
    listView.setAdapter(adapter);

    FrameLayout parent = (FrameLayout) lvOld.getParent();

    parent.removeView(lvOld);
    lvOld.setVisibility(View.GONE);

    parent.addView(listView, new FrameLayout.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, ViewGroup.LayoutParams.FILL_PARENT));

    return viewGroup;

} 
```

布局如下：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:background="#FF0000">

    <ListView
        android:id="@+id/android:list"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
    />

</LinearLayout> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T14:50:10.063

[从 Johan Nilsson更换“拉动刷新”小部件](http://markupartist.com)[http://markupartist.com](http://markupartist.com) 后，我遇到了同样的错误 。有必要从布局目录中删除 header.xml（包含对错误消息中提到的文本的引用）。文本已经是 Chris Banes 图书馆的一部分。

# php - 如何在悬停时更改文本并在鼠标移出时恢复为默认值？

> ID：11478048
> 
> 赞同：1
> 
> 时间：2012-07-13T20:40:15.373
> 
> 标签：php, jquery, html

我有一个显示如下计数的 div：

例如，当鼠标悬停在 div 上时，如何将文本从 0 更改为任何单词，并在鼠标离开时恢复为 0。

我试过这段代码，但没有用。

```
$('.post-fav a').bind('mouseenter',function() {
    var default_text = $(this).text();
    $(this).css({'background-position' : 'left bottom', 'color' : '#1871a4'});
    $(this).html('<?php _e('favorite','deluxe'); ?>');
});
$('.post-fav a').bind('mouseleave',function() {
    $(this).css({'background-position' : 'left top', 'color' : '#666'});
    $(this).text(default_text);
}); 
```

默认文本是可变的，每个元素都有特定的计数，当鼠标移过时我需要以某种方式存储初始计数..我不能在 js 中将其硬编码为 0 或任何其他计数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T20:44:08.490

你只需要使用hover功能，第一个参数是mouseover，第二个是mouseout：

```
$('div').hover(
    function() { $(this).html('anyword'); },
    function() { $(this).html('0'); }
); 
```

**编辑：**

```
var storedtext;
$('div').hover(
    function() { 
        storedtext = $(this).html();
        $(this).html('anyword'); 
    },
    function() { $(this).html(storedtext); }
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T20:51:16.460

```
$inittext=$('div').html; 
```

然后正如幕府将军所说

```
$('div').hover(
function() { $(this).html('anyword'); },
function() { $(this).html($inittext); }
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T20:56:00.577

最好的方法是使用数据属性：

```
<div data-initial-value="0">
<script>
$('div').bind('mouseenter',function() {
  var default_text = $(this).text();
  $(this).css({'background-position' : 'left bottom', 'color' : '#1871a4'});
  $(this).html('<?php _e('favorite','deluxe'); ?>');
});
$('div').bind('mouseleave',function() {
  $(this).css({'background-position' : 'left top', 'color' : '#666'});
  $(this).text($(this).data('initialValue');
}); 
</script> 
```

# c++ - LNK2013 错误“修复溢出”

> ID：11478055
> 
> 赞同：4
> 
> 时间：2012-07-13T20:40:39.453
> 
> 标签：c++, arm, microsoft-metro, windows-runtime, winrt-xaml

我有一个用 c++ 编写的 Windows 8 Metro 应用程序，我正在尝试编译到 ARM。在链接期间，我收到以下错误的许多实例：

```
"error LNK2013: BLX23(T) fixup overflow.  Target '<mangledName>' is out of range" 
```

[MSDN 网站](http://msdn.microsoft.com/en-us/library/bc3e8d1t%28v=vs.110%29.aspx "MSDN 网站")说：“您可以通过创建多个图像或使用 /ORDER 选项来解决此问题，以便指令和目标更接近。”

但我真的不明白如何使它工作。有问题的符号是编译器生成的，不涉及安腾架构，因此该页面上的其他建议不适用。此外，有错误的文件是 *.g.cpp 文件，由编译器从项目中包含的 xaml 页面生成。

Metro 应用程序在 Win32 配置上运行得很好，所以我想知道是否有更多 ARM 经验的人可以更好地了解如何解决此类问题。

设置是 Windows 8 RP x64 上的 Visual Studio 2012 RC。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-02T16:48:48.500

这是由于 ARM 上的增量链接中的一个不幸错误，可以通过禁用增量链接来解决。正如另一个答案中提到的，这是因为被调用函数和调用站点彼此相距太远，以至于链接器需要插入长分支岛（并且在使用增量链接时创建长分支岛存在一个非常特殊的错误） .

据我所知，这个错误并没有针对 RTM 修复（当我自己发现这个问题时，修复 RTM 版本为时已晚），但它是已知的并计划在未来的版本中修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T21:00:02.623

关键问题是 ARM 指令集仅支持编译器试图用来生成函数调用的指令的*相对位移，并且这些位移中的位数有限。*在您的情况下，您的代码太多，以至于被调用函数和调用站点在地址空间中相距甚远，以至于位移中没有足够的位供编译器生成正确的调用指令。

这可能发生在 ARM 和 IA64 (Itanium) 上，但不会发生在 x86 和 x86-64 中，因为这些指令集具有跳转/调用指令，可以分支到进程地址空间中的任何可能地址。

解决此问题的唯一方法是在最终的可执行映像中将调用者和被调用者靠得更近。这样做的一种方法是在源文件中移动代码，因为通常编译器和链接器将函数代码放入可执行文件中的顺序与在源文件中声明函数的顺序相同（在一个翻译单元内）。优化通常会改变该顺序，但在大多数情况下，它几乎是正确的。

如您提供的链接中所述，另一个选项是使用链接器的`/ORDER`命令行选项手动移动函数。创建一个订单文件，并将出现此问题的函数放在一起，假设它们没有太多。由于听起来您正在处理自动生成的代码，这可能是最好的选择，因为您不希望每次重新生成代码时都必须对其进行编辑。

您可能还想向[connect.microsoft.com](http://connect.microsoft.com/)发布错误报告，因为默认工具集确实不应该强迫您处理这个相当奇怪的错误（由于 ARM 指令集的限制，这是一个非常真实的错误 -这不是编译器的错）。

# ruby-on-rails - 如何编写包含第 3 个模型并按其过滤的 Rails 查询？

> ID：11478056
> 
> 赞同：0
> 
> 时间：2012-07-13T20:40:43.320
> 
> 标签：ruby-on-rails, ruby-on-rails-3

给定以下模型：

```
User (id)
  has_many :groups
  has_many :communities

Groups (community_id (OPTIONAL) )
  belongs_to :user
  belongs_to :community

Communities (id, archived (boolean) )
  has_many :groups
  has_many :group_members, :include => :user 
```

我可以通过以下方式轻松获取用户组：

current_user.groups

问题是如果一个社区被归档，我不希望它在 current_user.groups 中返回。

如何获取社区未存档的所有用户组？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:25:40.810

`current_user.groups.joins(:community).where('communities.archived' => false)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:21:07.943

这可能有点笨拙，但您可以轻松地循环 `current_user.groups`，并检查每个组的社区是否已存档。也许是这样的

```
all_groups = current_user.groups
final_list = []
all_groups.each { |g| 
  if !g.community.archived
    final_list << g
  end
} 
```

这将遍历所有的`current_user`组并检查每个组是否已存档。如果没有，它会将其添加到一个名为`final_list`. 可能有更优雅的方式来做这件事，但这至少让你知道你应该做什么。

# android - 应用商店多个名称

> ID：11478065
> 
> 赞同：0
> 
> 时间：2012-07-13T20:41:36.333
> 
> 标签：android, iphone, ios, app-store, google-play

我正计划开发一款非常有用的好应用程序，无论它在哪个国家/地区使用。这就是为什么我已经计划从一开始就使用多种语言进行开发。我知道您可以通过本地化和/或其他情节提要轻松做到这一点，但使用相应语言的标题也会很好。如果应用程序是关于房屋的，在英语中应该是“我的家”，在西班牙语中应该是“Mi hogar”。这在appStore中可能吗？（我相信不是）在 google Play（Android 市场）中呢？将同一个应用程序以不同的语言多次分发并具有相应的名称是否会有所帮助，还是只会稀释下载量并避免它成为“流行应用程序”？（我想是的）有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:17:42.350

您当然可以为 google play 商店中的应用程序的每种语言设置单独的标题（以及所有列表详细信息）。当您将应用程序上传到开发者控制台并单击列表详细信息下的“添加语言”时，您将能够输入语言特定信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:40:21.817

两者（应用程序名称和应用程序中的更改语言）在 iOS 中都是可能的。

如何更改应用名称：

[如何根据选择的语言更改 iPhone 应用程序名称？](https://stackoverflow.com/questions/4509888/how-to-change-iphone-app-name-according-to-language-selected)

如何更改应用内容：

[http://www.raywenderlich.com/2876/how-to-localize-an-iphone-app-tutorial](http://www.raywenderlich.com/2876/how-to-localize-an-iphone-app-tutorial)

# html - 替代

> ID：11478067
> 
> 赞同：32
> 
> 时间：2012-07-13T20:41:50.253
> 
> 标签：html, css, deprecated

其他人以前曾问过这个问题，但我从未见过足够的答案。`<center>`标签是否有有效的替代品？

我知道有`margin: 0 auto;`，但这需要设置宽度。还有`align="center"`，但我相信那也是无效的代码。

有没有`<center>`这么简单有效的东西？在极少数情况下我仍然最终使用它，即使它已被弃用。就在今天，我最终使用 a`<center>`将需要以网页为中心的一个按钮居中。是的，我可以设置宽度并给出它`margin: 0 auto`，但要使单个元素居中需要做很多工作，而且它弄脏了我的代码，我为保持有序而感到自豪。`<center>`如果没有任何东西可以取代它，我真的不明白为什么首先被弃用。

谢谢！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-13T20:43:50.317

`text-align: center`是你应该使用的。事实上，理想的方式是这样的：

```
.center {
    text-align: center;
}
.center > div, .center > table /* insert any other block-level elements here */ {
    margin-left: auto;
    margin-right: auto;
} 
```

显然，它并不像您希望的那么简单。

就个人而言，我只是使用：

```
.center {text-align: center;}
.tmid {margin: 0px auto;} 
```

然后在需要的地方申请课程。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-13T20:53:06.703

如果没有中心标签，要让元素居中并不容易。

为此，您需要做一个即使在 IE6 中也有效的解决方法：

您需要一个 div 包装器围绕您想要居中并使用的元素`text-align:center; width:100%`。在这个 div 中放置另一个 div 并设置`margin`为 auto 和`text-align:left;`

```
<div style="text-align:center; width:100%">
    <div style="margin:auto; text-align:left;">
        This Container is centered
    </div>
</div> 
```

如果您只想使文本居中，您可以使用`<p style="text-align:center;"></p>`

这是核心。为了简化事情，您可以为此使用一个类（如 Kolink 所写）：

CSS：

```
.center {
    text-align:center;
    width:100%;
}
.center:first-child { //doesn't work in IE 6
    margin:auto;
    text-align:left;
} 
```

HTML：

```
<div class="center">
    <div>
        This Container is centered
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-09-01T18:35:18.130

居中元素我用这个：

```
.middlr {
   display: block;
   margin: auto;
} 
```

适用于每个/任何元素。为我工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-14T18:11:37.453

不推荐使用的原因`<center>`是它不是语义标签，而是表示性的，我们应该避免在 HTML 中使用任何本质上不是语义的东西。

这与其他表示元素（如 等）已被弃用的原因`<b>`相同`<i>`，因为在 CSS 中有实现相同目的的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-07T03:36:34.287

```
.centered {
  margin-left: auto !important;
  margin-right: auto !important;
}
* > .centered {
  text-align: center !important;
  display: block;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-10-07T23:41:20.470

**更换中心标签：（**你*应该同时做*）

将此样式用于父元素：

> 文本对齐：居中；

将此样式用于当前元素：

> 左边距：自动；边距右：自动；

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-23T19:22:26.547

这是 PHP-STORM 报价：使用这个：

```
<div style="text-align: center;"></div> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-07-13T20:43:33.843

`text-align: center`是等效的 CSS

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-09-15T22:06:35.483

我在博客上找到了这个答案

```
<img src="bullswithhorns.jpg" alt="Michael with the bull" style="width:150px;height:200px;margin:0px auto;display:block">
```

[资源](http://bloggingfear.blogspot.com/2012/11/how-to-center-image-using-html-5-code.html)

# cocoa - NSComboBox 列表默认滚动到底部

> ID：11478069
> 
> 赞同：1
> 
> 时间：2012-07-13T20:41:55.570
> 
> 标签：cocoa, scroll, nscombobox

我有一个完全标准的 NSComboBox。它设置了一个数据源来为其提供内容，效果很好。问题是当用户单击查看列表时，它开始一直滚动到列表底部而不是顶部。我发现

```
- (void)scrollItemAtIndexToTop:(NSInteger)index 
```

并尝试过

```
[comboBox scrollItemAtIndexToTop:0]; 
```

在各个地方，但它什么也没做。这比其他任何事情都更烦人，我无法弄清楚。

提前致谢。

编辑：来自数据源的代码：

```
- (NSInteger)numberOfItemsInComboBox:(NSComboBox *)aComboBox
{
    return [[engineTypesArrayController arrangedObjects] count];
}

- (id)comboBox:(NSComboBox *)aComboBox objectValueForItemAtIndex:(NSInteger)index
{
    return [[[engineTypesArrayController arrangedObjects] objectAtIndex:index] valueForKey:@"title"];
}

- (NSString *)comboBoxCell:(NSComboBoxCell *)aComboBoxCell completedString:(NSString *)uncompletedString
{
    NSArray *matchingObjects = [[engineTypesArrayController arrangedObjects] filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"(logTenCustomizationProperty_title BEGINSWITH[c] %@)", uncompletedString]];

    if (matchingObjects && ([matchingObjects count] > 0))
    {
        return [[matchingObjects objectAtIndex:0] valueForKey:@"title"];
    }
    else
    {
        return nil;
    }
} 
```

comboBox:indexOfItemWithStringValue 未实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:35:38.037

添加此委托方法有效：

```
#pragma mark - ComboBox delegate
- (void)comboBoxWillPopUp:(NSNotification *)notification
{
    NSComboBox *comboBox = [notification object];

    [comboBox scrollItemAtIndexToVisible:0];
} 
```

# mysql - MySQL - 索引问题

> ID：11478074
> 
> 赞同：2
> 
> 时间：2012-07-13T20:42:11.593
> 
> 标签：mysql, indexing

我第一次使用 MySQL 制作更大的数据库。由于它将变得更大，因此我需要更好的查询性能。所以我研究了索引。因为这是我学到的，所以我总是创建一个名为 id 的列，它会自动递增并用作主索引。

经过一番搜索和阅读，我想我已经了解了一些关于索引的事情，但我想确定一下。

当您使用带有例如 WHERE 子句的选择查询时，索引很有用，因为它不是搜索整个表，而是只搜索较小的部分。您应该索引在 WHERE 和 JOIN 子句中使用的内容。

只在 phpMyAdmin 中为要索引的列添加索引是否足够好，或者在执行选择查询时我必须做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T20:44:26.757

您不需要对 SELECT 语句进行任何更改。MySQL 会在可能的情况下自动使用索引进行查找。

所以是的，通过 phpMyAdmin 添加索引就足够了。

要查看实际情况，一旦您创建了索引，请尝试运行以 EXPLAIN 为前缀的 SELECT 查询。MySQL 会告诉你正在使用哪些索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T20:50:01.890

您确实可以在`where`子句中使用索引，但通常您不知道要搜索哪些索引，而是搜索更有意义的数据，例如姓名、电子邮件地址、日期等。

当您连接表时，使用索引的力量就会出现，无论是为了搜索性能还是为了数据库的大小。想象一下，如果您有一个包含员工的数据库，并且您想跟踪他们所属的办公室。每个员工只有一张表，将有一个包含办公室名称的字符字符串，即“阿尔伯克基总部”。字符字符串占用大量空间并且搜索速度很慢。

相反，设计有两个表和索引的员工表只需要为每个员工存储一个 int（另一个表的索引）。第二张表跟踪所有办公室。当数据记录的数量增加时，整个数据库变得更小。这种方法也更容易维护，并且在各个方面都更好。

无论哪种方式 - 你永远不会出错的索引，你也可以在你将创建的每个表中添加一个（我相信有人可能不同意这个说法，但通常我会说你应该去做）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T20:46:27.757

只需添加索引。如果可能，数据库引擎将使用它。要查看数据库引擎是否使用它，您可以`explain`在查询之前添加一个，它将输出它的作用。例子：

```
explain select * from your_table 
```

# javascript - 附加到 DOMWindow 实例而不是 self 的嵌套方法调用

> ID：11478075
> 
> 赞同：0
> 
> 时间：2012-07-13T20:42:12.793
> 
> 标签：javascript, jquery, prototypejs

```
someSingleton = (function() {    
    var someFunction = function() {
        console.log(this);
        someOtherFunc();
    };

    var someOtherFunc = function() {
        console.log(this);
    };

    return {
        method: someFunction
    }
})();

someSingleton.method(); 
```

如果运行这个，您会注意到第一个方法将按预期返回对象，而第二个嵌套方法调用 someOtherFunction 将返回 DOMWindow 对象。

除了将实例（this）作为参数传递给第二个方法之外，我如何使第二个方法调用引用包含对象而不是 DOMWindow。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T20:52:38.197

`someOtherFunc.call(this);`

它仅取决于函数的调用方式，而不取决于函数的定义位置或方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:01:32.720

一种常见的方法是使用`bind`函数来存储方法的上下文。一个简单的例子可能看起来像这样：

```
someSingleton = (function() {   

    var singleton = {};

    var _bind = function (func, me) {
        return function () {
            func.apply(me, arguments);   
        }
    }

    var someFunction = _bind(function() {
        console.log(this);
        someOtherFunc();
    }, singleton);

    var someOtherFunc = _bind(function() {
        console.log(this);
    }, singleton);

    singleton.method = someFunction;

    return singleton;
})();

someSingleton.method();​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T20:54:31.533

`call`您可以使用方法*^([[MDN]](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/Call))*显式指定函数的调用上下文：

```
var someFunction = function() {
    console.log(this);
    someOtherFunc.call(this);
}; 
```

`this`to的错误绑定`window`是一个常见的 JavaScript 错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T20:57:24.843

理解`this`javascript 可能是一个挑战。我可以推荐阅读[Douglas Crockford 的 Javascript: The Good Parts](https://rads.stackoverflow.com/amzn/click/com/0596517742)以获得更好的理解。同时，您可以查看此链接 :) [http://javascriptweblog.wordpress.com/2010/08/30/understanding-javascripts-this/](http://javascriptweblog.wordpress.com/2010/08/30/understanding-javascripts-this/)

将父对象分配给变量是很常见的`that`。这样，您可以通过它访问它的属性和功能：

```
(function(){
  var that = this;
  that.someFunc = function(){};
  that.someOtherFunc = function(){
    console.log(that);
  };
})(); 
```

# bing-maps - 必应地图：在调用calculateDirections 后为每个转弯添加一个PushPin

> ID：11478082
> 
> 赞同：0
> 
> 时间：2012-07-13T20:43:04.923
> 
> 标签：bing-maps

我正在为 Bing 地图开发“快速道路”功能。我的想法是，一旦用户点击地图，DirectionsManager 类就会计算路线，这样如果用户想要制作一条绕曲线的路线，他们就不必多次点击。他们只需单击两次，页面将完成其余的工作。（顺便说一句，如果有人有更好的方法，请告诉我 - 这是我第一次通过解决方案。）

我正在尝试 MSDN 上的 DirectionsManager 示例，并减少了与 RouteLeg 类有关的示例代码 (http://msdn.microsoft.com/en-us/library/hh312823)，我有以下基本代码：

```
function directionsModuleLoaded() {
    var directionsManager = new Microsoft.Maps.Directions.DirectionsManager(map);

    var startWaypoint = new Microsoft.Maps.Directions.Waypoint({ location: new Microsoft.Maps.Location(42.71926499622451,-84.57241695374249) });
    var endWaypoint = new Microsoft.Maps.Directions.Waypoint({ location: new Microsoft.Maps.Location(42.71390477940529,-84.5766870304942) });

    directionsManager.addWaypoint(startWaypoint);
    directionsManager.addWaypoint(endWaypoint);

    directionsManager.calculateDirections();
}

function displayMessage(e) {
    alert("The calculated route has " + e.route[0].routeLegs[0].itineraryItems.length + " direction steps.");
} 
```

这确实有效。我输入一对纬度/经度值，它计算并显示“圆角”路线。我希望的是一种在路线的每个方向变化的部分放置一个 PushPin 的方法，所以如果需要三个小路线转弯，就会显示一个 PushPin，每个点都有一个两段相遇。那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T20:03:29.687

您可以从 DirectionManager 类调用[getAllWaypoints()](http://msdn.microsoft.com/en-us/library/hh312802.aspx)来获取所有航点的数组。

对于每个航点，您可以调用[getLocations()](http://msdn.microsoft.com/en-us/library/hh312838.aspx)来获取航点对象的位置。

然后，您可以在每个位置创建一个图钉，方法是将 waypoint.getLocations() 传递给图钉[构造函数](http://msdn.microsoft.com/en-us/library/gg427615.aspx)以及任何其他设置选项，然后将图钉添加到地图。

# javascript - 包含带有 innerHTML 的脚本 - 转义字符

> ID：11478085
> 
> 赞同：2
> 
> 时间：2012-07-13T20:43:14.940
> 
> 标签：javascript, escaping, innerhtml

我正在尝试`<script>`在 innerHTML 中输出一个元素：

```
<script type="text/javascript">
    function fileManager()
    {
        data = document.getElementById("FM");
        data.innerHTML = "<script type='text/javascript' src='functions.js'></script>";
    }
</script>
    <div id="FM"></div>
    <ul id="show-menu">
        <li onClick="fileManager()">File Manager
    </ul> 
```

脚本的 innerHTML 位完美运行，只是在双引号 (") 内转义字符存在问题。整个`<script type='text/javascript' src='functions.js'></script>`似乎被破坏/写入不正确，我似乎无法弄清楚它有什么问题。

如果您想知道，functions.js 文件仅`document.write("test");`用于测试目的。

由于某些未知原因，这不起作用。结果是一个损坏的页面，我在脚本中看到了一些其他功能，这没有意义。如何正确逃避它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T20:46:56.450

[脚本中的文字`<script>`/`</script>`实际上破坏了包含脚本本身的 html 标记](https://stackoverflow.com/questions/236073/why-split-the-script-tag-when-writing-it-with-document-write)。还有 `.innerHTML` [不执行或加载脚本](http://www.w3.org/TR/2008/WD-html5-20080610/dom.html#innerhtml0)的问题。所以我建议：

```
function fileManager()
{
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = 'functions.js';
    document.getElementById("FM").appendChild(script);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T20:47:57.317

某些浏览器中存在一个错误，当您尝试使用 javascript 插入脚本标签时会出现问题。您需要做的是像这样分解脚本标签：

```
"<scr"+"ipt..........</scr"+"ipt>" 
```

这将起作用。

# android - 图片走出手机屏幕

> ID：11478089
> 
> 赞同：0
> 
> 时间：2012-07-13T20:43:46.240
> 
> 标签：android, xml, camera, image, sizing

我正在尝试制作一个图像应用程序，并且我的一个 xml 文件中有一个按钮和图像视图。我在图像视图上有一张默认图片。在某些设备上，它太小或太大。我不希望图片超出屏幕或按钮。我该怎么做？这是xml代码

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<Button
    android:id="@+id/btakePic"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:text="Take Picture" />

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="fill_parent"
    android:layout_height="400dp"
    android:gravity="center"
    android:src="@drawable/android_syh" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T20:54:53.920

也许这就是你想要的：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/RelativeLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"    
    >

    <Button
        android:id="@+id/btakePic"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:text="Take Picture" />

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_above="@+id/btakePic"        
         />

</RelativeLayout> 
```

没有必要，`android:gravity="center"`因为你有`android:layout_width="fill_parent"`

希望有帮助。

# objective-c - 在与其他 UIView(s) 相交之间插入一个 UIView

> ID：11478094
> 
> 赞同：0
> 
> 时间：2012-07-13T20:44:20.780
> 
> 标签：objective-c, uiview, position

我有一个包含 9 个 UIViews 的屏幕（想象 3x3 表和视图，每行 3 个视图）占据所有屏幕。我拖动一个 UIView，然后移动它，然后我希望一旦 touchEnded 将其放置在其他拦截 UIView 之间的某个位置，并再次使用 UIViews 的 3x3 屏幕，当然现在使用拖动的 UIView 重新排序，我（以某种方式）放置它.

除了 UIViews 的重新排序之外，一切都很好。我需要一种方法来找出我猜想与其他 UIView 最相交的地方（最大的区域在可拖动 UIView 框架具有的所有 UIView 之间相交）并用新位置重新排序所有 UIView。

所有这些都发生在超级视图中，它拥有所有视图并具有带有 UIView 的 NSMutableArray。我不想移动列表中的对象，而是通过框架找到解决方案。

想象一下，您在一张桌子上有 9 张牌，并在这个 3x3 网格中更改它们的位置。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T20:50:40.950

只需使用 view.center 来确定该点是否与另一个视图相交。如果它们不重叠，则中心只会命中一个视图。您可以使用以下代码来获取相交视图中的点。

```
CGPoint centerInOtherView = [thisView convertPoint:thisView.center toView:otherView]; 
```

然后您可以使用以下代码测试交集。

```
if ([otherView pointInside:centerInOtherView withEvent:nil]){
    // Do Something
} 
```

此时您知道拖动视图的中心与您正在测试的视图一致

您也可以像这样重新排列您的视图。

```
UIView *mySuperView = [thisView superview];
NSUInteger index = [[[mySuperView subviews] indexOfObject:otherView];
[thisView removeFromSuperview];
[mySuperView insertSubview:newView atIndex:index]; 
```

# iphone - setHidden 函数与 tableView 对象的奇点

> ID：11478098
> 
> 赞同：0
> 
> 时间：2012-07-13T20:44:48.627
> 
> 标签：iphone, uigesturerecognizer, hidden

我，

当识别出 longTapGesture 时，我尝试管理滚动视图内的 tableView 的外观。当 longTapGesture 结束时，这个 tableView 必须消失。我在两个“if”块中使用 setHidden 函数来显示和消失 tableView。它在第一个 longTapView 之后工作，但之后，tableView 不再出现。

我想 setHidden 函数有问题。这是我的代码：

```
-(void)handleLongPress:(UILongPressGestureRecognizer *)gestureRecognizer
{

    if(self.tableView==nil)
    {

        NSLog(@"tableView initiee");
        self.tableView = [[UITableView alloc] initWithFrame:CGRectMake(gestureRecognizer.view.center.x - 10, gestureRecognizer.view.center.y - 10, 100, 100)];
        [self addSubview:self.tableView];
    }

    self.tableView.layer.cornerRadius = 20.0;
    self.tableView.layer.frame = CGRectInset(tableView.layer.frame, 20, 20);

    if (gestureRecognizer.state == UIGestureRecognizerStateBegan) {
        [self.tableView setHidden:NO];
        NSLog(@"tableView apparait");
    }

    if(gestureRecognizer.state == UIGestureRecognizerStateEnded)
    {
        [self.tableView setHidden:YES];
        NSLog(@"tableView disparait");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:15:01.337

我想我可能发现了你的问题。 `self.tableView.layer.frame = CGRectInset(tableView.layer.frame, 20, 20);`每次调用 table view 层的宽度和高度都会减少 40。因此，通过第二次调用，您有一个角半径为 20 的 20x20 框架。这将不可见。尝试评论该行，看看它是否有效。

你想用那行代码来完成什么？

# asp.net - 无法让 JQuery UI Dialog 做我想做的事

> ID：11478102
> 
> 赞同：0
> 
> 时间：2012-07-13T20:45:07.933
> 
> 标签：asp.net, jquery-ui

我只想要一个显示几行文本的弹出窗口。我有这个链接

```
<a href="" onclick=".dialog('open')">Help</a> 
```

我的标题中的这个javascript

```
<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
  <script type="text/javascript">
      $(document).ready(function () {
          var $dialog = $('<div></div>')
        .html('This dialog will show every time!')
        .dialog({
            autoOpen: false,
            title: 'Basic Dialog'
        });

          $('#helpModal').click(function () {
              $dialog.dialog('open');
              // prevent the default action, e.g., following a link
              return false;
          });
      });
  </script>
</asp:Content> 
```

我不断更改代码以匹配我想要的，但我无法得到它。我只想要一个带有一些文本的弹出窗口，并将其设置为灰色和焦点...底部有一个“确定”按钮来关闭模式窗口。

我觉得我不应该有这么多麻烦...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T20:58:53.530

更改您的href：

```
<a href="" id="helpModal" >Help</a> 
```

为了 $('#helpModal').click 函数启动

[在这里](http://jsfiddle.net/wvQJR/)提琴

如果你想在链接中使用 onclick .dialog() 不是一个有效的调用

```
<script type="text/javascript">
    //outside document ready
  function click_link()    {
        var $dialog = $('<div></div>')
        .html('This dialog will show every time!')
        .dialog({
            autoOpen: false,
            title: 'Basic Dialog'
        });

        $dialog.dialog('open');
              // prevent the default action, e.g., following a link
              return false;
 }
</script>
<a href="#" onclick="click_link();" >Help2</a> 
```

[在这里](http://jsfiddle.net/wvQJR/2/)提琴

# ruby-on-rails-3 - Rails 即使事务回滚，也要在事务中保存记录？

> ID：11478105
> 
> 赞同：5
> 
> 时间：2012-07-13T20:45:20.613
> 
> 标签：ruby-on-rails-3, transactions

我有一系列记录要保存为交易的一部分。除了正常的 AR 记录外，我还在进行信用卡网关交易。如果它或 AR 交易失败，我希望一切都回滚......除了我从信用卡网关返回的失败交易的数据（原因、日期等）。就像是

```
def pay
  Payment.transaction do
    payment.save
    other.save
    result = credit_card.purchase  # this does the gateway transaction, no database stuff
    if result.failure
      raise ActiveRecord::Rollback
      result.save  # this is the part I want to always save
    end
    another.save
  end
end 
```

有没有办法从失败回滚中排除事务中的特定部分？

导轨 3.2.5，MySQL 5.1

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-13T22:23:19.977

我不是 100% 确定我理解你为什么要这样做，但你能把信用卡的东西保存在交易之外吗？

```
result = nil
Payment.transaction do
  payment.save
  other.save
  result = credit_card.purchase  # this does the gateway transaction, no database stuff
  if result.failure
    raise ActiveRecord::Rollback      
  end
end
result.save 
```

（由于块变量作用域的工作方式，您需要在事务之前将结果设置为 nil）

另一种可能的策略是利用事务是在每个连接的基础上完成的这一事实。两个线程将使用不同的连接，所以你可以这样做：

```
Payment.transaction do
  payment.save
  other.save
  result = Thread.new do
    ActiveRecord::Base.connection_pool.with_connection do
      credit_card.purchase.tap do |result|
        result.save
      end
    end
  end.join.value
  if result.failure 
    raise ActiveRecord::Rollback
  end
end 
```

或者也许只是：

```
Payment.transaction do
  payment.save
  other.save
  result = credit_card.purchase
  Thread.new do
    ActiveRecord::Base.connection_pool.with_connection do
      result.save
    end
  end.join
  if result.failure 
    raise ActiveRecord::Rollback
  end
end 
```

这里购买发生在另一个线程上，即使用它自己的数据库连接。该线程中发生的任何事情都不会回滚

# android - 如何在选项卡应用程序中从意图转到另一个意图

> ID：11478113
> 
> 赞同：0
> 
> 时间：2012-07-13T20:46:17.053
> 
> 标签：android, android-intent, android-tabhost

我有基于标签的应用程序。在一个选项卡中，我有一个扩展 ListActivity 的类。在保留标签栏的同时触发 onClick 时，我需要另一个活动。我想在保留标签栏的同时通过 onClick 转移到另一个标签。

此代码有效，但隐藏标签栏：

```
Intent intent = new Intent(getApplicationContext(),SectionContentList.class);   

// put values to intent which will get in the LoginSuccess    Activity
Log.d("",appState.MainCategories.get(position).get("feedUrl"));
intent.putExtra("FeedURL", appState.MainCategories.get(position).get("feedUrl"));

// Start LoginSuccess Activity
startActivity(intent); 
```

如何在保留底部标签栏的同时转移到这个新意图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T05:53:43.983

我给了你标签活动管理的例子//已经声明了标签活动使用的数量包 com.technosoft.Concina_Peru;

```
import android.app.TabActivity;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.ImageView;
import android.widget.TabHost;
import android.widget.TextView;

import com.technosoft.FirstTab.FirstTab;
import com.technosoft.FourthTab.FourthTab;
import com.technosoft.SecondTab.SecondTab;
import com.technosoft.ThirdTab.ThirdTab;

public class ConcinaPeruTabbar extends TabActivity {

    public static Context tabContext;
    public static TabHost tabHost;
    Context con;
    public static String var = "";

    public static Concina_Database db;

    private void setupTabHost() {
        tabHost = (TabHost) findViewById(android.R.id.tabhost);
        tabHost.setup();
    }   

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.starttab);
        tabContext = this;
        con = this.getApplicationContext();
        db = new Concina_Database(con);

        setupTabHost();
        setupTab(new TextView(this), "Inicio");
        setupTab(new TextView(this), "Recetas");
        setupTab(new TextView(this), "Favoritos");
        setupTab(new TextView(this), "Mas");

    }

    private void setupTab(final View view, final String tag) {
        View tabview = createTabView(tabHost.getContext(), tag);
        if(tag.equals("Inicio")){

            tabHost.addTab((tabHost.newTabSpec("Inicio")).setIndicator(
                    tabview).setContent(new Intent(this, FirstTab.class)));
        }
        if(tag.equals("Recetas")){

        tabHost.addTab((tabHost.newTabSpec("Recetas")).setIndicator(
                tabview).setContent(new Intent(this, SecondTab.class)));

        }
        if(tag.equals("Favoritos")){

            tabHost.addTab((tabHost.newTabSpec("Favoritos")).setIndicator(
                tabview).setContent(new Intent(this, ThirdTab.class)));

        }
        if(tag.equals("Mas")){

            tabHost.addTab((tabHost.newTabSpec("Mas")).setIndicator(
                tabview).setContent(new Intent(this, FourthTab.class)));

        }
    }

    private static View createTabView(final Context context, final String text) {
        View view = LayoutInflater.from(context)
                .inflate(R.layout.tabs_bg, null);
        TextView tv = (TextView) view.findViewById(R.id.tabsText);

        ImageView iv = (ImageView) view.findViewById(R.id.imageView1);
        if (text.equals("Inicio")) {
            iv.setBackgroundResource(R.drawable.tab_bg_image);
        }
        if (text.equals("Recetas")) {
            iv.setBackgroundResource(R.drawable.tab_bg_image1);
        }
        if (text.equals("Favoritos")) {
            iv.setBackgroundResource(R.drawable.tab_bg_image2);
        }
        if (text.equals("Mas")) {
            iv.setBackgroundResource(R.drawable.tab_bg_image3);
        }

        tv.setText(text);
        return view;
    }
} 
```

//第一个选项卡活动在这里定义

```
public class FirstTab extends ActivityGroup{
    public static FirstTab group_FirstTab;

    private  ArrayList<View> history = new ArrayList<View>();
    ProgressDialog PD;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        group_FirstTab = this;
        View view = getLocalActivityManager().startActivity("CitiesAct", new
                Intent(FirstTab.this,Inicio.class).addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP)).getDecorView();
        replaceView(view);
    }
    public void replaceView(View view) {  

          history.add(view);
          setContentView(view);

      }
    public void RemoveView(){
         history.clear();

    }
    public void back(){
          if(history.size() > 1) {  
              history.remove(history.size()-1);  
              setContentView(history.get(history.size()-1));

          }else{
              finish();
          }
      }

     public boolean onKeyDown(int keyCode, KeyEvent event)
     {              
            if(keyCode == KeyEvent.KEYCODE_BACK){                   
                group_FirstTab.back();
                    return true;
            }
            return super.onKeyDown(keyCode, event);
     }

} 
```

类似的有另一个选项卡活动..现在你想去意图一个选项卡到另一个选项卡活动到另一个选项卡活动下面的代码跟随

对于 ex 想要将 0 标签活动转到 1 标签活动，然后使用

```
tab activity Class tab_0{
    ConcinaPeruTabbar.tabHost.setCurrentTab(1); 
} 
```

如果您想将一个选项卡活动转到 simaar 选项卡活动，请使用此视图视图 =

```
 FirstTab.group_FirstTab.getLocalActivityManager().startActivity("CitiesAct", new         Intent(Inicio.this,Platos.class).addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP).putExtra("platos", "Entradas")).getDecorView();
                    FirstTab.group_FirstTab.replaceView(view); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:36:18.757

如果您已经实现了一个标签栏，那么您就有一个 Activity——我们称之为 MyTabActivity——它扩展了 TabActivity。在`OnCreate(Bundle)`此 Activity 的方法中，您首先通过在 XML 中检索 TabHost 视图来设置您的标签栏：

```
TabHost tabHost = (TabHost) findViewById(R.id.tabhost); 
```

要动态处理选项卡选择，您可以将对 TabHost 的引用保留为静态变量：

```
public static final TabHost tabHost;
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.tabActivityLayout);
    tabHost = (TabHost) findViewById(R.id.tabhost);
    // ..... 
} 
```

然后，您可以从选项卡活动之一访问您的 TabHost，并将当前选项卡设置如下：

```
MyTabActivity.tabHost.setCurrentTabByTag("the tag you affected to this activity"); 
```

或者

```
MyTabActivity.tabHost.setCurrentTabByTag("the id you may have affected to it"); 
```

编辑：当影响标签到 TabHost 时，您会影响标签，如下所示：

```
TabHost.TabSpec tabSpec = tabHost.newTabSpec("The Tag").setIndicator(tabView).setContent(intent);
tabHost.addTab(tabSpec); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T20:48:44.000

您应该使用片段在许多活动之间共享部分 UI。

# .net - 本地静态字典使 Visual Basic 编译器崩溃

> ID：11478115
> 
> 赞同：1
> 
> 时间：2012-07-13T20:46:40.313
> 
> 标签：.net, vb.net, visual-studio-2005

以下代码立即使 VS2005 中的 Visual Basic 编译器崩溃（至少，对于我的环境：Windows 7）：

```
Public Module foo
    Public Function FUNC() As System.Int32
        Static dict As Generic.Dictionary(Of Int32, Of String)
        Return 0
    End Function
End Module 
```

具体来说，在完成定义“dict”（静态、本地字典）的行后。现在，我学会了对在编译器中声明错误持怀疑态度（尤其是对于像上面这样简单的一组代码），所以我很好奇为什么会发生这种情况。显然，不优雅的崩溃是 VS2005 中的一个限制，但是由于声明静态通用字典的潜在问题而发生崩溃吗？如，这是坏/非法的VB吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T20:58:13.517

刚刚找到答案。字典定义应该是 Generic.Dictionary(Of X, Y) 而不是 (Of X, Of Y)。

# c# - WPF 找不到在其他程序集中定义的控件类型

> ID：11478116
> 
> 赞同：0
> 
> 时间：2012-07-13T20:46:41.250
> 
> 标签：c#, .net, wpf, dependencies

我正在.NET 3.5 中使用 WPF 构建一个 GUI 应用程序框架。

我的主应用程序几乎没有依赖项。它的工作之一是加载外部程序集（插件）并从它们请求窗口和控件。

那部分工作正常。

当插件使用 WPF 框架中未定义的控件时会出现问题。例如，我有一个引用 WPF 工具包并使用`DatePicker`. 当主应用程序读取 XAML 文件并看到`DatePicker`时，它会抛出一个`XAMLParseException`，说明

> 找不到类型“Microsoft.Windows.Controls.DatePicker”。编译时使用的程序集可能与加载时使用的程序集不同，并且类型丢失。

对我来说很明显为什么会抛出这个异常，并且在主应用程序中添加对 WPF Toolkit 的引用可以解决问题。但是我无法在主应用程序中为插件使用的每个控件添加引用，因为我不知道这些控件可能是什么。

我还要补充一点，主应用程序使用`Assembly.LoadFrom`.

**现在的问题：**

我是否需要让插件将它们的依赖项复制到主应用程序的目录中，然后再加载它们？我还有哪些其他选择？.NET 4 中是否以某种方式解决了这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T20:54:57.597

不一定是好方法，但[ILMerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)可能对您有用。在寻找那个链接时，我看到了对[这篇文章](http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx)的引用，它也可能有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T08:17:53.390

您是否尝试将 WPF Toolkit dll 与插件放在一起？另一种选择是向 GAC 注册

# user-interface - 是否可以使用 Google Apps 脚本装饰 Google 日历或 GMail 用户界面？

> ID：11478117
> 
> 赞同：2
> 
> 时间：2012-07-13T20:46:44.853
> 
> 标签：user-interface, google-apps-script

当我听说 Google Apps Script 时，我认为除其他外，它允许您像 Labs 扩展一样在现有的 Google Apps 中添加或更改 UI 元素。这只是一个误解，还是可以对 Google 日历或 GMail 进行添加/更改？我正在考虑更改 Google 日历中的创建/编辑事件窗口，以支持“位置”字段中的自动完成，利用用户联系人中的地址。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:02:00.153

目前无法使用 Apps 脚本执行此操作。但是，您可以在 Google 电子表格中创建自定义菜单：[https ://developers.google.com/apps-script/class_spreadsheet#addMenu](https://developers.google.com/apps-script/class_spreadsheet#addMenu)

# oop - 电晕sdk。刚从 corona 和 lua 开始，想知道类/实例

> ID：11478120
> 
> 赞同：-1
> 
> 时间：2012-07-13T20:46:57.223
> 
> 标签：oop, class, lua, instantiation, coronasdk

我刚开始学习电晕和lua，我的第一个项目是制作一个小骰子游戏，我刚刚开始！这是骰子对象...

```
 --declare table + metatable

    local dice = {}

    local dice_mt = {__index = dice}

    --CONSTRUCTOR 

    function dice.new(ypos, xpos) 

    local newdice = {xpos = xpos, ypos = ypos,dicetext = display.newText("X", 50*xpos , 50*ypos , nil, 50)} 

    --dicetext = display.newText(facevalue, 50*xpos , 50*ypos , nil, 50)

    return setmetatable(newdice, dice_mt) 
    end

    --rolldice function

    function dice:rolldice()

    self.dicetext.text = math.random(0,6) 

    end

    return dice 
```

游戏是有一个可以滚动的 25 个骰子的网格（上面有 rolldice 功能）这是我的 main.lua

```
 display.setStatusBar(display.HiddenStatusBar)

    local diceclass = require ("dice")

    for i = 1, 5, 1 do

    local die = diceclass.new(i,i)

    i = i+1

    end

    die:rolldice() 
```

我正在尝试以编程方式生成骰子网格（atm 我只是在对角线上生成 5 个骰子（只是文本）。到目前为止很好，但我的问题是运行 rolldice 函数。它在只有 1 个骰子但当有更多时不是。我猜问题是我有所有这些类的实例具有相同的名称。有没有办法在我的 for 循环中创建它们时以编程方式给它们不同的名称？或者有没有有更好的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:03:13.700

`local`变量如此命名是因为它们在定义它们的范围内是*本地的。*`die`在`for`循环中定义。因此，一旦您离开`for`循环，它就会停止存在。

如果要创建`die`对象数组，则需要创建一个可在循环*外*访问的数组，然后将`die`对象添加到该数组中。

此外，`i = i+1`这会适得其反，因为 Lua 知道如何自己增加循环。此外，它可能会导致未定义的行为。

# c - 如何使用带有未知参数的“打印”宏

> ID：11478121
> 
> 赞同：-1
> 
> 时间：2012-07-13T20:47:00.180
> 
> 标签：c

这段代码不起作用，但当我把`print(7)`它工作正常时：

```
#include<stdio.h>
#define print(i) printf("%"#i"c",ch);

int main(void) 
{
    char ch ='*';
    int N;
    scanf("%d",&N);

    if (N%2 == 0)
    {
            print(N); // print(7);
    }
    else
    {

    }
} 
```

这是编译输出

```
 gcc draw.c -o draw
 draw.c: In function ‘main’:
 draw.c:11: warning: unknown conversion type character ‘N’ in format 
```

如何让代码适用于用户插入的输入。请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:34:20.703

问题是`#`操作符是预处理器的一部分。它不理解运行时值。

该`printf`函数识别一种`*`语法，该语法告诉它接受`int`指定字段宽度的参数，而不是将宽度作为格式字符串中的常量。

例如，此函数可以替换您的宏。请注意，我已经制作`ch`了一个参数；我认为这样更清楚。

```
int print(int n, char ch) {
    return printf("%*c", n, ch);
} 
```

就个人而言，我可能不会为此使用函数或宏。我`printf`直接打电话：

```
printf("%*c", n, '*'); 
```

# twitter - Twitter 分享框 url 参数不会显示

> ID：11478130
> 
> 赞同：0
> 
> 时间：2012-07-13T20:47:49.580
> 
> 标签：twitter, query-string, tweets

我正在尝试使用这行 php.ini 动态生成我自己的自定义推文按钮。

```
echo "<li><a href=\"javascript:\" onclick=\"javascript:
popitup('https://twitter.com/share?text=Check%20out%20{$items[$i]
['name']}%20at%20&url=cmplt.st/item/{$items[$i]
['item_id']}&via=cmpltst&counturl=completeset.us/items/{$items[$i]['item_id']}')\"
class=\"twitter\">T</a></li>"; 
```

问题是 URL 参数未显示在共享框中。我试图让共享框显示链接到的`Check out {item name} at cmplt.st/item/{item'item_id}`位置，但它只显示。如何让 url 实际显示在推文中？ `cmplt.st/item/{item'item_id}``completeset.us/items/{item_id}``Check out {item name} at`

编辑：

这是弹出功能。它所做的一切都是在单独的窗口中弹出共享框。

```
//Function to pop up a new window
function popitup(url) {
   newwindow=window.open(url,'name','height=300,width=500');
   if (window.focus) {newwindow.focus()}
   return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:09:30.710

URL 没有显示的问题很简单，就是我前面没有 http://。出于某种原因，Twitter 鄙视裸域。我相信他们用来解析 URL 的代码无法识别前面没有 http(s):// 的地址。我发现每当我遇到 twitter 问题时，检查 URL 是一个很好的起点。

# c - c语言 - 通过函数验证用户输入

> ID：11478132
> 
> 赞同：0
> 
> 时间：2012-07-13T20:47:52.170
> 
> 标签：c

我需要使用单独的函数验证用户输入。例如，编程要求在 functionA 中输入，而验证代码应该在 FunctionB 中……我知道所有用于验证的 if 和 while 语句，但我不知道如何为此使用两个单独的函数……这是示例跑..

```
#include <stdio.h>

void get_input (int * inp);
double valid_input (void);

main ()
{
    get_input (&inp);
    valid_input ();
}

void get_input (int *inp)
{
    printf("enter something");
    scanf("%d", &inp);
}

double valid_input ()
{
    // what to put here ?
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T20:57:41.813

在这种情况下，您可能希望将其保留在一个函数中，因为返回的值`scanf`决定了用户输入是否有效。

此外，您不应该将参数的地址传递给 scanf，它已经是一个指向 int 的指针。

考虑像这样重写你的函数：

```
int get_input (int *inp);

// main function is here

// returns 1 if input was valid
// see documentation for scanf for possible return values
// http://www.cplusplus.com/reference/clibrary/cstdio/scanf/
int get_input (int *inp)
{
    printf("enter something: ");
    return scanf("%d", inp); 
} 
```

然后您可以使用函数的返回值来确定它是否成功，如下所示：

```
int value;
if (get_input(&value) == 1)
{
    // input was valid
}
else
{
    // function returned an error state
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:12:43.103

我不完全确定您正在寻找什么验证。如果您只是为了验证输入了您要查找的字符类型，Wug 的答案很接近。

如果您正在寻找另一个进行验证的函数，这可以为您提供一个起点：

```
#include <stdio.h>

int get_input (int *integerINput, char *characterInput);
void valid_input (int inp);

main()
{
    int integerInput;
    char charInput[2];

    // man scanf reports that scanf returns the # of items
    //      successfully mapped and assigned.
    //      gcc 4.1.2 treats it this way.
    if (get_input (&integerInput) < 2)
    {
        printf ("Not enough characters entered.\n");
        return;
    }

    valid_input (integerInput);
}

int get_input (int *integerInput, char *characterInput)
{
    int inputCharsFound = 0;

    printf ("Enter an integer: ");

    inputCharsFound += scanf ("%d", inp);

    printf ("Enter a character: ");

    // The first scanf leaves the newline in the input buffer
    //    and it has to be accounted for here.
    inputCharsFound += scanf ("\n%c", characterInput);

    printf ("Number of characters found = %d\n", inputCharsFound);

    return inputCharsFound;
}

void valid_input (int inp)
{
    if (inp > 5)
        printf ("You entered a value greater than 5\n");
    else
        printf ("You entered a value less than 5\n");
} 
```

**编辑** HasanZ 在下面的评论中询问了有关如何处理多个变量的更多详细信息。我已更新代码以读取另一个输入字符。

我将由您来确定如何最好地接受适当的输入并验证该输入，因为您已经笼统地询问了如何在单独的函数中进行验证。

我还会[在这里](https://stackoverflow.com/questions/768704/great-c-tutorial)查看有关 C 编程的更多信息。

# vb.net - Visual Studio 2010 - 在项目设置中使用编辑器 FileNameEditor

> ID：11478135
> 
> 赞同：0
> 
> 时间：2012-07-13T20:48:04.103
> 
> 标签：vb.net, visual-studio-2010

我有很多路径可以在我的项目中使用。当您使用 Appication Settings 时，您可以将 Settings 对象`PropertyGrid`与代码一起提供给 a：`PropertyGrid1.SelectedObject = My.Settings()`。

我读到你可以提供一个对象（在这种情况下是一个自定义对象，而不是`My.Settings`这个*元*信息：

```
<Editor(GetType(System.Windows.Forms.Design.FileNameEditor), _
        GetType(System.Drawing.Design.UITypeEditor))> 
```

为了应用打开文件浏览器的编辑器，当您使用`PropertyGrid`. 那太好了，而且有效。

是否有可能在 VS2010 UI 中执行此类操作以与应用程序设置一起使用？

我的意思是，我意识到将属性的类型设置为`System.Windows.Forms.Design.FileNameEditor`将设置其类型而不是其编辑器，这很简单。我也尝试设置`System.Windows.Forms.Design.FileNameEditor`为该属性的提供者，但没有运气。

我已经打开了文件`Settings.Designer.vb`，我已经手动添加了这一行：

```
<Editor(GetType(System.Windows.Forms.Design.FileNameEditor), _
        GetType(System.Drawing.Design.UITypeEditor))> 
```

到我想显示文件选择器和工作的属性。问题是文件是自动生成的，不应该被编辑。

如何使用 Visual Studio 2010 的适当过程重复该行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T12:29:48.353

Just read the application settings into your own class and assign that class to the propertygrid. I took this edited somewhat from one of my projects:

```
Call MyFilenameClass
 <Editor(GetType(System.Windows.Forms.Design.FileNameEditor), GetType(System.Drawing.Design.UITypeEditor)), _
  Browsable(True), _
  DefaultValue(""), _
  Category("File"), DisplayName("Filename"), Description("Select the file.")> _
  Public Property MyFileName As String = My.Settings.MyFilename
End Class 
```

So, when the class is created, MyFilename will have the value of My.Settings.MyFilename. In your Form_Closing you will need to put your value back into the Application setting and save it:

```
My.Settings.MyFilename = "class name in here".MyFilename
My.Settings.Save 
```

# c++ - 没有看到包含的头文件

> ID：11478139
> 
> 赞同：0
> 
> 时间：2012-07-13T20:48:31.970
> 
> 标签：c++, header

编辑：新文件。我在访问 Form1 类中的公共函数时遇到问题。当我尝试使用它时找不到标识符。表格1：

```
#pragma once

#include "OpenGL.h"
#include "serialcom.h"
#include "calculations.h"

namespace GUI_1 {

    using namespace System;
    using namespace System::ComponentModel;
    using namespace System::Collections;
    using namespace System::Windows::Forms;
    using namespace System::Data;
    using namespace System::Drawing;
    using namespace OpenGLForm;

    /// <summary>
    /// Summary for Form1
    /// </summary>

    public ref class Form1 : public System::Windows::Forms::Form
    {
    public:
        Form1(void)
        {
            InitializeComponent();
            OpenGL = gcnew COpenGL(this->panel4, this->label16, 785, 530);
        }
        void changelabel2(float num)
        {
            label2 -> Text = " " + num;
        }
    protected: ... 
```

OpenGL.h：

```
#include "stdafx.h"

#ifndef opengl
#define opengl

#pragma comment(lib, "opengl32.lib")
#pragma comment(lib, "glu32.lib")

#include <windows.h>
#include <GL/gl.h>
#include <GL/glu.h>
#include <GL/glut.h>
#include <math.h>

// Declare globals
...

using namespace System::Windows::Forms;

namespace OpenGLForm 
{
    public ref class COpenGL: public System::Windows::Forms::NativeWindow
    {
    public:

        COpenGL(System::Windows::Forms::Panel ^ parentForm, System::Windows::Forms::Label ^ lbl, GLsizei iWidth, GLsizei iHeight)
        {
            CreateParams^ cp = gcnew CreateParams;

            c_p_v v1, v2;
            changelabel2(189); 
... 
```

所以这不起作用（上面，在“changelabel2”中）。也许是因为我没有使用类名？

这是我的主要内容：

```
#include "stdafx.h"
#include <string.h>
#include <iostream>
#include <stdio.h>
#include < vcclr.h >
#include < stdio.h >
#include < stdlib.h >
#include < vcclr.h >    
#include "Form1.h"
#include "calculations.h"
#include "serialcom.h"

using namespace GUI_1;

[STAThreadAttribute]
int main(array<System::String ^> ^args)
{
    // Enabling Windows XP visual effects before any controls are created
    Application::EnableVisualStyles();
    Application::SetCompatibleTextRenderingDefault(false); 

    // Create the main window and run it
    Form1^ form = gcnew Form1();
    Application::Run(form);

    return 0;
} 
```

调用 form.changelabel2 也不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:04:21.160

看起来您在 OpenGL.h 和 Form1.h 之间存在循环依赖关系

`#include "Form1.h"`如果可以，请尝试删除，或将其转换为前向声明，例如`class Form1;`

此外，在头文件中使用时要小心，`using namespace`因为它会污染随后包含的任何文件的名称空间。

# extjs - 防止网格更新/刷新时 ExtJS 网格中的图像“闪烁”

> ID：11478140
> 
> 赞同：0
> 
> 时间：2012-07-13T20:48:35.387
> 
> 标签：extjs, extjs4

我使用返回 HTML 标记的列渲染器在 ExtJS 网格中显示图像。问题是每次更新网格时图像都会“闪烁”（即消失并重新出现）。有没有办法防止这种情况？这是我正在做的一个简化示例：

```
Ext.create('Ext.grid.Panel', {
  title: 'My Grid',
  store: myStore
  columns: [
    {
      header: 'Image', 
      dataIndex: 'imgUrl',
      renderer: function(imgUrl, meta, record) {

        // Add a mouse-over / tooltip that shows the name
        meta.tdAttr = 'data-qtip="' + Ext.String.htmlEncode(record.getName()) + '"';

        return '<img src="' + imgUrl + '">';
      }
    }
  ]
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:23:50.020

我发现使用 CSS 背景图像而不是`<img>`标签可以解决问题（仅使用 Chrome 测试）。例子：

```
Ext.create('Ext.grid.Panel', {
  title: 'My Grid',
  store: myStore
  columns: [
    {
      header: 'Image', 
      dataIndex: 'imgUrl',

      width: 16, // The width of the background-image

      renderer: function(imgUrl, meta, record) {

        // Add a mouse-over / tooltip that shows the name
        meta.tdAttr = 'data-qtip="' + Ext.String.htmlEncode(record.getName()) + '"';

        meta.tdAttr += 'style="background-image: url(\'' + imgUrl + '\'); background-repeat: no-repeat;"';
      }
    }
  ]
}); 
```

# c# - 在我的控制器中获取复选框列表的 html Id

> ID：11478143
> 
> 赞同：0
> 
> 时间：2012-07-13T20:48:50.253
> 
> 标签：c#, asp.net-mvc

如果我有这个 html 复选框列表代码，如何在我的 post 操作方法中的 mvc 中获取该复选框列表的 ID？因为字符串 [] dias 我只是通过示例获得值（“lunes”“martes”......等）

（使用此示例制作我的复选框列表 =>[示例](https://stackoverflow.com/questions/6217747/checkboxlist-in-asp-net-mvc)）

```
[HttpPost]
        public ActionResult Editar(cliente cliente, string[] dias)
        {
         } 
```

html

```
<input id="1" type="checkbox" value="Lunes" name="dias">
Lunes
<input id="2" type="checkbox" value="Martes" name="dias">
Martes
<input id="3" type="checkbox" value="Miercoles" name="dias">
Miercoles
<input id="4" type="checkbox" value="Jueves" name="dias">
Jueves
<input id="5" type="checkbox" value="Viernes" name="dias">
Viernes
<input id="6" type="checkbox" value="Sabado" name="dias" checked="checked">
Sabado
<input id="" type="checkbox" value="Domingo" name="dias">
Domingo 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T09:48:57.310

你拿不到`id`. `id`当您提交表单时，该属性永远不会发送到服务器。这就是 HTML 的工作原理。仅`value`发送。但是复选框有点不同，因为只有选中的复选框的**属性**`value`被发送到服务器。

 **因此，只需`value`为此目的使用该属性：

```
<input id="1" type="checkbox" value="1" name="dias">
Lunes
<input id="2" type="checkbox" value="2" name="dias">
Martes
<input id="3" type="checkbox" value="3" name="dias">
Miercoles
<input id="4" type="checkbox" value="4" name="dias">
Jueves
<input id="5" type="checkbox" value="5" name="dias">
Viernes
<input id="6" type="checkbox" value="6" name="dias" checked="checked">
Sabado
<input id="" type="checkbox" value="" name="dias">
Domingo 
```

现在在您的`string[] dias`参数中，您将获得所选 ID 的列表。然后，如果您需要获取相应的名称，请在给定此 ID 的情况下查询它们所在的数据存储。**

# c# - 使用 Linq2Sql 的 T-SQL 语句

> ID：11478144
> 
> 赞同：1
> 
> 时间：2012-07-13T20:48:56.617
> 
> 标签：c#, linq-to-sql

我尝试在 Linq2SQL 中转换以下 SQL Select 语句：

```
SELECT stoptimes.stopid,
       trips.tripid,
       stoptimes.sequence
FROM   trips
       INNER JOIN stoptimes
               ON stoptimes.tripid = trips.tripid
WHERE  ( trips.routeid = '3' )
       AND ( trips.endplace = 'END001' )
ORDER  BY stoptimes.sequence DESC 
```

它运行良好，但使用 linq2sql，以下语句出现异常：

```
var first = (from tableTrip in db.Trips
             join tableStopTimes in db.StopTimes on tableTrip.TripId equals tableStopTimes.TripId
             where tableTrip.RouteId == 3 && tableTrip.EndPlace == "TAEND"
             select new
             {
                 tableStopTimes.StopId,
                 tableStopTimes.Radius,
                 tableStopTimes.PlaceName,
                 tableStopTimes.Place,
                 tableStopTimes.Sequence
             }).OrderByDescending(X => X.Sequence).First(); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T20:58:58.180

错误“序列不包含元素”是您调用 First() 的集合的结果，其中没有任何内容。

您可以改为调用[FirstOrDefault](http://msdn.microsoft.com/en-us/library/bb340482.aspx)来避免此问题。

编辑：

我相信在您创建的匿名类型的情况下，默认值为空。

# python - 带有线程的随机python模块加载失败

> ID：11478146
> 
> 赞同：1
> 
> 时间：2012-07-13T20:49:10.110
> 
> 标签：python, django, google-app-engine

我正在尝试调试 python 导入语句随机失败的错误，而其他时候它们运行干净。

这是我看到的例外的一个例子。有时我会看到这个，有时我会在不同的模块中看到另一个，尽管它似乎总是出现在 4 个模块之一中。

```
ERROR:root:/home/user/projecteat/django/contrib/auth/management/__init__.py:25:     RuntimeWarning: Parent module 'django.contrib.auth.management' not found while handling absolute import
from django.contrib.contenttypes.models import ContentType 
```

由于随机性，我几乎可以肯定这是一个线程问题，但我不明白为什么会出现导入错误，所以我不确定在调试中要寻找什么。如果不同的线程试图加载相同的模块，这可能是由文件系统争用引起的吗？

我正在尝试让 Django 1.4 的 LiveServerTestCase 在 Google App Engine 的开发服务器上运行。主线程运行 django 的测试框架。当它加载一个基于 LiveServerTestCase 的测试类时，它会生成一个子线程来启动 App Engine dev_appserver，它是一个本地网络服务器。主线程继续运行测试，使用 Selenium 驱动程序发出 HTTP 请求，这些请求由子线程上的 dev_appserver 处理。

在拆除测试用例类之前，测试框架可能会在基于 LiveServerTestCase 的类中运行一些测试。在拆卸时，子线程结束。

看起来异常发生在子（HTTP 服务器）线程中，主要是在单个测试用例类中的测试之间。

App Engine LiveServerTestCase 类的代码在这里：[https ://github.com/dragonx/djangoappengine/blob/django-1.4/test.py](https://github.com/dragonx/djangoappengine/blob/django-1.4/test.py)

提供此问题所需的所有调试信息非常困难。我主要是在寻找关于为什么 python 导入语句会给出 RuntimeWarning 错误的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T13:15:41.220

我对自己的问题有部分答案。发生的事情是我有两个线程正在运行。

线程 1 正在处理 HTTP 请求的 dev_appserver (dev_appserver_main) 内部运行主要内部函数。

线程 2 正在运行基于 Selenium 的测试用例。该线程将向浏览器发送命令以执行某些操作（然后间接生成 HTTP 请求并重新进入线程 1）。然后，它要么向 Selenium 发出更多请求以检查状态，要么进行数据存储查询以检查结果。

我*认为*问题在于，在处理每个 HTTP 请求时，线程 1 (dev_appserver) 会更改环境，从而无法访问某些文件夹（app.yaml 中排除的文件夹以及不属于 appengine 的环境）。如果此时线程 2 恰好运行了一些代码，如果某些导入位于这些文件夹中，则它们可能无法加载。

# java - 在视口组件上使用 JScrollPane 鼠标侦听器

> ID：11478147
> 
> 赞同：2
> 
> 时间：2012-07-13T20:49:23.207
> 
> 标签：java, swing

我有一个`JScrollPane`可以将其**viewportView**设置为一系列不同面板的。每当单击其视口中的任何其他组件时，我都想获取 JScrollPane 组件。如果我将 a 添加`MouseListener`到 JScrollPane，它会在我直接单击窗格边框时接收我的鼠标事件，但在我单击组件时不会接收。

添加侦听器并最终找到封闭的滚动窗格的正确方法是什么？我不一定会提前知道我在视口中显示的面板上的所有组件——只是它们将位于 JPanel 的某个子类上。

```
import java.awt.event.MouseEvent;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.event.MouseInputAdapter;

import net.miginfocom.swing.MigLayout;

public class TestScrollPane extends MouseInputAdapter{
    public void mouseEntered(MouseEvent arg0) {System.out.println("Entered " + arg0.getComponent());}
    public void mouseExited(MouseEvent arg0) {System.out.println("Exited " + arg0.getComponent());}
    public void mousePressed(MouseEvent arg0) {System.out.println("Pressed " + arg0.getComponent());}
    public void mouseReleased(MouseEvent arg0) {System.out.println("Released " + arg0.getComponent());}

    public static void main(String[] args){
        JFrame frame = new JFrame();
        frame.setLayout(new MigLayout());
        frame.setSize(400, 400);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        TestPane pane1 = new TestPane("Scroll Pane 1");
        TestPane pane2 = new TestPane("Scroll Pane 2");
        frame.add(pane1, "push,grow");
        frame.add(pane2, "push, grow");
        TestMouseListener listener = new TestMouseListener();
        pane1.addMouseListener(listener);
        pane1.addMouseMotionListener(listener);
        pane2.addMouseListener(listener);
        pane2.addMouseMotionListener(listener);
        frame.setVisible(true);
    }
}

class TestPanel2 extends JPanel {
    String name;
    TestPanel2(String name){ 
        this.name = name;
        setLayout(new MigLayout());
        JTextArea area = new JTextArea();
        area.append(name);
        add(area, "push, grow");
    }
    public String toString(){ return name; }
}
class TestPane extends JScrollPane {
    String name;
    TestPane(String name){ 
        this.name = name; 
        TestPanel2 panel = new TestPanel2(name + " panel");
        setViewportView(panel);
    }
    public String toString(){ return name; }
} 
```

在这个例子中，我得到了鼠标进入和退出事件，但我只能通过单击文本区域周围的边框来获取鼠标单击事件。即使我更改 TestPane 类以将侦听器添加到它的 viewportView 面板，我也无法判断 textArea 中发生了什么。

```
class TestPane extends JScrollPane {
    String name;
    TestPane(String name){ 
        this.name = name; 
        TestPanel2 panel = new TestPanel2(name + " panel");
        TestMouseListener listener = new TestMouseListener();
        panel.addMouseListener(listener);
        panel.addMouseMotionListener(listener);
        setViewportView(panel);
    }
    public String toString(){ return name; }
} 
```

不过，我无法知道 JPanel 上的内容，因此我无法更深入地手动添加侦听器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:43:31.357

另一种可能的方法是使用 AWTEventListener，然后冒泡父树以查看您感兴趣的组件是否已被按下或持有已被按下的子组件。例如：

```
import java.awt.AWTEvent;
import java.awt.Component;
import java.awt.FlowLayout;
import java.awt.Toolkit;
import java.awt.event.AWTEventListener;
import java.awt.event.MouseEvent;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.event.MouseInputAdapter;

// import net.miginfocom.swing.MigLayout;

public class TestScrollPane extends MouseInputAdapter {
   public void mouseEntered(MouseEvent arg0) {
      System.out.println("Entered " + arg0.getComponent());
   }

   public void mouseExited(MouseEvent arg0) {
      System.out.println("Exited " + arg0.getComponent());
   }

   public void mousePressed(MouseEvent arg0) {
      System.out.println("Pressed " + arg0.getComponent());
   }

   public void mouseReleased(MouseEvent arg0) {
      System.out.println("Released " + arg0.getComponent());
   }

   public static void main(String[] args) {
      JFrame frame = new JFrame();
      // frame.setLayout(new MigLayout());
      frame.getContentPane().setLayout(new FlowLayout());
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      TestPane pane1 = new TestPane("Scroll Pane 1");
      TestPane pane2 = new TestPane("Scroll Pane 2");
      frame.add(pane1, "push,grow");
      frame.add(pane2, "push, grow");
      // !! TestMouseListener listener = new TestMouseListener();
      TestScrollPane listener = new TestScrollPane();
      pane1.addMouseListener(listener);
      pane1.addMouseMotionListener(listener);
      pane2.addMouseListener(listener);
      pane2.addMouseMotionListener(listener);
      frame.pack();
      frame.setVisible(true);

      Toolkit.getDefaultToolkit().addAWTEventListener(
            listener.createAWTWindowListener(), AWTEvent.MOUSE_EVENT_MASK);

   }

   private AWTEventListener createAWTWindowListener() {
      AWTEventListener awt1 = new AWTEventListener() {

         @Override
         public void eventDispatched(AWTEvent e) {
            if (MouseEvent.MOUSE_PRESSED == e.getID()) {
               MouseEvent event = (MouseEvent) e;
               Component comp = event.getComponent();

               if (comp != null) {
                  String scrollPanelName = recursivelyCheckForScrollPanel(comp);
                  if (scrollPanelName != null) {
                     System.out.println("TestPane pressed. Name: " + scrollPanelName);
                  } else {
                     System.out.println("TestPane not pressed");
                  }
               }
            }
         }

         private String recursivelyCheckForScrollPanel(Component comp) {
            if (comp instanceof TestPane) {
               return comp.toString();
            } else {
               comp = comp.getParent();
               if (comp != null) {
                  return recursivelyCheckForScrollPanel(comp);
               }
            }
            return null;
         }
      };
      return awt1;
   }
}

class TestPanel2 extends JPanel {
   String name;

   TestPanel2(String name) {
      this.name = name;
      // setLayout(new MigLayout());
      JTextArea area = new JTextArea(5, 20);
      area.append(name);
      add(area, "push, grow");
   }

   public String toString() {
      return name;
   }
}

class TestPane extends JScrollPane {
   String name;

   TestPane(String name) {
      this.name = name;
      TestPanel2 panel = new TestPanel2(name + " panel");
      setViewportView(panel);
   }

   public String toString() {
      return name;
   }
} 
```

注意：有关此问题的更多信息，请参阅[此问题](https://stackoverflow.com/questions/8586098/global-event-listeners-with-awteventlistener-how-to-pull-mouseevents-from-it)以及 StanislovL 和 mkorbel 的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:33:34.657

您应该将鼠标侦听器添加到 JScrollPane 的视图而不是滚动窗格本身，因为滚动窗格仅包含角和滚动条。

```
yourJScrollPane.getViewport().getView().addMouseListener(yourMouseListener); 
```

此代码段会将您的鼠标侦听器添加到 JScrollPane 的一个视口组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:34:57.433

您将遇到的问题是，如果面板包含也有鼠标侦听器的内容，您将永远不会收到这些事件的通知（鼠标事件往往被链中较高的那些消耗）

您可以使用 addNotify，类似于 JTable 的工作方式。然后，您将遍历父链，直到您可以找到所需的组件。

当然，这假设您不打算使用鼠标侦听器...

# java - 没有找到仅适用于某些手机的 sqlite 表

> ID：11478149
> 
> 赞同：0
> 
> 时间：2012-07-13T20:49:26.747
> 
> 标签：java, android, sqlite

我正面临一个非常严重的问题。

我正在使用以下代码

```
String queryString = "SELECT * FROM TFMetro";
        Cursor resultSet =  mDb.rawQuery(queryString, null); 
```

游标返回表 TFMetro。该应用程序在我测试过的手机中完美运行。主要是，`droid x, moto cliq mb200`

我的客户有 HTC Hero 和 tab2

然而，他正在崩溃

```
 try{
          metroLocations = mDbHelper.getAllMetroLocations();
          }catch (Exception e) {
              int duration = Toast.LENGTH_SHORT;
              Toast toast = Toast.makeText(this, e.getMessage(), duration);
              toast.show();
        }
          mDbHelper.close(); 
```

吐司显示`no such table:TFMATERO: while compling select*from TFmetro`

知道为什么它可以在我的手机上正常工作而不是在那里。?

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T20:53:39.160

如果使用预先创建的数据库，*可能*是由于找不到数据库造成的：因为 SQLite 会愉快地创建一个新的*空*数据库（没有任何用户表），这将导致观察到的异常..

*如果*加载了正确的数据库，我怀疑该命令在任何设备上都会失败。

# php - 将可变数量的变量从 PHP 表单保存到数据库中

> ID：11478151
> 
> 赞同：0
> 
> 时间：2012-07-13T20:49:35.900
> 
> 标签：php

总之，我允许我的用户创建我需要保存答案的问题。他们可以根据需要创建尽可能少或尽可能多的问题。我的困境是如何保存这些变量并检索它们并将它们显示给用户。

当我将表单输出给用户时，我有以下 PHP 代码（我将问题存储在不同的表中，以及适用于不同表的答案）：

```
$qryquestion = "Select * from feedback_questions order by question_display ASC";
$resultquestion = mysql_query($qryquestion);
$i=1;
while($resultsetquestion = mysql_fetch_array($resultquestion)){
if ($i%2==0){
    echo '<tr bgcolor="#FFFFFF" id="row'.$i.'">';
} else {
    echo '<tr id="row'.$i.'">';
}
echo '<td align="center"><b>'.$resultsetquestion['question_value'].'</b></td>';
echo '<td align="center"><div style="text-align:center;"><input type="radio" name="rating_value_'.$resultsetquestion['question_id'].'" id="rating_value_'.$resultsetquestion['question_id'].'" value="'.$resultsetratings['rating_id'].'"></td>';
} 
```

我正在考虑将它们保存在数据库中，如下所示：

```
user_id question_id answer_id feedback_id
1 1 5 1
1 2 5 1
1 3 1 1
2 1 2 2

```

提交表单时，如何从 $_POST 的角度保存这些变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:40:17.673

由于您使用的是 PHP，因此处理任意数量的问题的最简单方法是在 POST 后将您的输入转换为 PHP 数组，如此[处](http://us2.php.net/manual/en/faq.html.php#faq.html.arrays)所述。可以在[此处](http://www.johnrockefeller.net/html-input-forms-sending-in-an-array-in-php/)找到一个 PHP 实现的示例。一旦您在 PHP 数组中实际获得了输入数据，您就可以将它们添加到数据库中。您的数据库布局看起来足够合适，尽管您可能会在同一个表中实际包含问题和答案，以节省连接。

# c++ - 如何使用命名空间中的变量

> ID：11478152
> 
> 赞同：11
> 
> 时间：2012-07-13T20:49:38.337
> 
> 标签：c++, static, namespaces

我想我对命名空间和/或静态变量有一个根本的误解。但是我已经尝试过这个测试代码（手工输入，请原谅拼写错误）

测试.h：

```
namespace test{
   static int testNum=5;
   void setNum(int value);
} 
```

主.cpp：

```
#include <test.h>

int test::setNum(int value){
   testNum=value;
}

int main(){
    test::setNum(9);
    cout<<test::testNum;
} 
```

当我运行它时，我得到的值是 5，而不是我预期的 9。似乎我有两个 testNum 变量实例，但这似乎与 static 应该做的完全相反。我猜我错误地假设这些功能与它们的 java equivilants 相同......

如果我从我的 testNum 声明中删除静态，我还会收到一个错误，指出 testNum 被多次声明，有人可以解释为什么会这样吗？

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-13T21:12:35.487

首先，您的误解与命名空间**无关**，它只是关于`static`. 对于这个答案的其余部分，我将仅引用它，`testNum`因为它在命名空间中的事实是无关紧要的。

我还假设您有另一个文件，可能名为`test.cpp`，其中还包含`test.h`并定义了该`setNum`函数。

当声明命名空间范围内的变量或函数（即不是类成员或函数本地）时，`static`这意味着实体的名称在该文件的内部。形式上它具有“内部链接”，这意味着它不能通过名称引用或链接到其他文件（可以通过指针间接引用或将其作为参数传递给另一个函数。）这意味着如果有几个文件定义`static int testNum`然后每个文件都有自己的内部变量，名称与`testNum`其他文件不同（实际上一个文件可能有`static int testnum`，另一个可能有`static double testnum`，另一个文件`static char* testNum`，它们都是不同的，并且对于每个文件都是内部的。）如果你在 header 中放置这样的定义，然后*包含 header 的每个文件都有自己的`testNum`*.

因此，`static`在标题中的变量上，您*在*每个`testNum`包含`test.h`. 这意味着如果您在一个文件中设置`testNum`并在另一个文件中调用一个函数，该函数使用`testNum`它指的是一个**不同**的变量，该变量恰好具有相同的名称。

因此，`static`在标头中声明非常量变量几乎总是错误的。

如果没有`static`，您将`testNum`在包含 的每个文件中定义变量`test.h`，这是不允许的：每个实体必须在您的程序中定义一次且仅一次。解决这个问题的方法是在头文件中*声明*变量，但不*定义*它，你可以通过告诉编译器变量是`extern`：

```
extern int testNum;  // N.B. no "= 1" here 
```

这告诉编译器有一个名为“外部链接”的变量`testNum`，所以当代码引用`testNum`它时，它总是意味着相同的变量（不是带有内部 linakge 的某个名称，它是每个文件中的不同实体。）在声明一个`extern`变量之后，它是您有责任确保在程序中的某处提供了一个确切的定义，因此您只需在**一个**文件中（即不在包含在多个文件中的头文件中）定义它：

```
int testNum = 1; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-13T20:58:09.503

`static`at namespace scope 用词不当，不应使用。这意味着声明为静态的实体具有内部名称绑定；换句话说，其他翻译单元中的相同名称将引用不同的实体，并且在变量定义的情况下，每个翻译单元中将有一个单独的变量实例。它对寿命没有影响。（在命名空间范围内声明或定义的*所有*变量都具有静态生命周期。）

`static`在命名空间范围内也已弃用。不要使用它。

关于在标头中声明变量：在其前面加上 `extern`，而不是`static`。如果声明了变量`extern`，并且没有初始化，则声明不是定义。当然，在这种情况下，您必须在某处（在单个源文件中）提供定义。类似于以下内容：

```
extern int testNum = 5;
int testNum = 5;
int testNum;          //  implicitly initialized with 0. 
```

编辑：

稍微澄清一下：生命周期和名称绑定之间存在一些混淆：

*   对象具有生命周期（自动、静态或动态——或临时或异常），并且
*   名称绑定到实体；如果名称被声明为变量，则实体是对象。

不要*将*关键字`static`与静态生命周期混淆。（函数可以是`static`，但函数在 C++ 中没有定义的生命周期；它们就在那里。）

关于这些的规则不是很正交。基本上，关于寿命：

*   在命名空间范围内声明的所有变量始终具有静态生命周期，
*   在本地范围内声明的变量具有自动生命周期*，除非*它们被声明`static`，并且
*   在类范围内声明的变量具有包含它们的类对象的生命周期，除非它们被声明`static`。关于生命。

具有静态生命周期的对象在之前的某个时间出现`main`，并一直存在到您从`main`.

关于名称绑定：

*   在命名空间范围内声明的变量具有外部名称绑定，除非它们被声明`static`，在这种情况下，它们具有内部名称绑定（但`static`不推荐使用这种用法），或者如果它们是 `const`，并且未声明`extern`，
*   在类范围内声明的变量具有外部名称绑定，即使它们已声明`static`，并且
*   在块范围内声明的变量没有绑定。

最后，还有一个声明是否是定义的问题。如果它是定义，则分配内存并（或可能）初始化对象。如果它不是定义，它只是告诉编译器在声明中声明的实体（对象）在其他地方有一个定义。一般来说，变量声明是一个定义*，除非*它被声明`extern`并且没有 *初始*值设定项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T21:00:04.890

您可能希望在发布代码之前确定您的代码确实存在问题；）

我复制/粘贴并修复了您的拼写错误，并手动进行了包括：

```
#include <iostream>
using namespace std;

namespace test{
   static int testNum=5;
   void setNum(int value);
}

void test::setNum(int value){
   testNum=value;
}

int main(){
    test::setNum(9);
    cout<<test::testNum;
} 
```

结果：

```
$ ./a.out 
9 
```

你没有说的是你的程序中还有什么。如果您不仅有 main.cpp，还包含您的 test.h，那么每个 .cpp 文件都将拥有自己的 testNum 副本。如果您希望他们共享，那么您需要除一个以外的所有内容将其标记为`extern`。

# mysql - group_concat 使用 HAVING x like '%%' 时返回空，但不使用 WHERE x like '%%'

> ID：11478158
> 
> 赞同：0
> 
> 时间：2012-07-13T20:50:08.040
> 
> 标签：mysql

在下面的示例查询中，我正在提取与关键字匹配的所有文本并按年月拆分结果。我更喜欢搜索“文本”——所有字符串的连接版本，而不是只针对每个带有 WHERE 子句的字段，但 HAVING 不返回任何数据：

```
SELECT 
date_format(created_date, '%Y-%m') as yr_mo,
count(id),
group_concat(coalesce(title,''),coalesce(story,'') SEPARATOR ' ') as text
from input_form
where dupe = 0 /*and story like '%flood%'*/
group by yr_mo
having text like '%flood%'
order by yr_mo 
```

以下是当我取消注释 /** 和 '%flood%' **/ 之类的故事并删除 HAVING 子句时返回的内容：

```
yr_mo   count(id)   text
2011-04 2   Floods Roads in my  community one time proved to b...
2011-05 21  THE TRUSTED LADY.   It was during my usual visits ...
2011-06 22  HEAVY RAINFALL On our village we were affected wit...
2011-07 52  FEED THE CHILDREN PROGRAMME(1) The world food prog...
2011-08 29  I was saved and helped to prosperI am one of the v...
2011-09 15  FLOODS In the past three months the country have f...
2011-10 19  FLOODFlood is a very bad disaster at the same time...
2011-11 9   RESPONDING TO DISASASTERUNICEF landed over relief ...
2011-12 3   EARLY PREVENTION OF FLOODShaving sensed the likeli...
2012-01 44  HUNGER STRIKE             In Wataalamu village the...
2012-04 8   THE FALLEN BRIDGEThe Kambu bridge along the Mombas...
2012-05 7   Increasing earth's natural environment awarenessAf...
2012-06 4   A misery solvedRecently 10 people died in my commu...
2012-07 21  Lsot HopesWhen the Agricultural Farmers Society ca... 
```

我试过用 coalesce(story,'') 避免空值，但结果是一样的。

编辑#1：我发现了一个更长更混乱的查询，并为我提供了我想要的：

```
SELECT 
date_format(created_date, '%Y-%m') as yr_mo,
count(if( ( story like '%hunger%' OR title like '%hunger%' ) and (story_location_city like '%nairobi%' OR story_location_neighborhood like '%nairobi%'),id,null)) as 'hunger',
count(if( ( story like '%poverty%' OR title like '%poverty%' ) and (story_location_city like '%nairobi%' OR story_location_neighborhood like '%nairobi%'),id,null)) as 'poverty',
count(if( ( story like '%school%' OR title like '%school%' ) and (story_location_city like '%nairobi%' OR story_location_neighborhood like '%nairobi%'),id,null)) as 'school',
count(id) as total
from input_form
where dupe = 0
group by yr_mo
order by yr_mo 
```

如果必须，我可以搜索 if() 语句中的每个字段，它会提供特定的结果。没有更有效的方法来做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T20:55:45.760

[`GROUP_CONCAT`将其输出截断为（默认情况下） 1024 characters](http://dev.mysql.com/doc/refman/5.6/en/group-by-functions.html#function_group-concat)，因此该`HAVING`子句要求字符串`flood`出现在连接文本的前 1024 个字符内，而该`WHERE`子句仅要求它*出现*在`input_form.story`.

即使不是为了截断，我认为`GROUP_CONCAT`+`HAVING`也不会是您真正想要的，因为这将包括具有*任何*匹配记录的任何月份的*所有记录。*例如，如果 2012 年 4 月有 20 条记录，但只有 10 条包含，那么+方法将（如果不用于截断）表示 2012 年 4 月有 20 条匹配记录，并将包含所有这些记录中的文本。*`flood``GROUP_CONCAT``HAVING`*

# css - 将 Div TOP 位置设置为浏览器宽度的百分比（按宽度定义高度位置）

> ID：11478163
> 
> 赞同：1
> 
> 时间：2012-07-13T20:50:32.260
> 
> 标签：css, html, position, width, percentage

我假设我需要为此使用 Javascript，但也许有一个我不知道的 CSS 技巧。

我有一个基于方形背景图像的网页。理想情况下，用户总是将浏览器设置为正方形，但我知道这不会发生。

因为图像是正方形的，如果图像设置为以 100% 填充浏览器，则宽度始终与页面“底部”的位置相同。

因此，要动态水平定位元素（以便页面可以调整大小但仍保持其结构），所述元素的顶部位置是宽度的百分比。

换句话说，如果我有一个应该始终位于距离图像顶部 85% 的水平条，则顶部位置可以定义为宽度的 85%（顶部：85% [浏览器宽度]）。如果您简单地将水平条的顶部定义为 85% (top:85%;)，则水平条的位置将随浏览器窗口的高度而变化（而如果您将其设置为宽度的 85%，则它正好是我想要的地方）。

如前所述，使用 Javascript 可能很容易做到这一点，但我不懂 Javascript。我假设 CSS 中没有一个函数可以通过计算宽度百分比来允许定位，但这将是理想的。

任何帮助是极大的赞赏！提前致谢。

=======================================

[![](../Images/8db8f59e2b761f46f65d8352676d94b8.png)](https://i.stack.imgur.com/Suj5N.jpg)
[（来源：[人仔网](http://renboy.com/images/squareWeb.jpg)）]

不幸的是，我是新用户，界面不允许我发布照片。

页面是方形的（一个大的方形图像）。有一个水平导航栏，其顶部应位于距图像顶部 85% 的位置（如果浏览器打开到与图像完全相同的大小和尺寸（正方形），它将被定义为 (top:85%;)） .

但是，如果有人将浏览器的底部向下拖动（以制作一个高矩形），则 85% 将不是我想要的图像上方的位置。但是，85% 的宽度总是在正确的位置（因为图像总是填充 100% 的宽度）。因此，如果我可以将水平位置定义为浏览器*宽度*的 85% （而不是高度），那么无论浏览器打开到什么尺寸，导航栏都将是我想要的位置。提前感谢任何可能的解决方案。

================== 做更多的研究，似乎答案可能在于 Jquery（使用 position 或者可能是 outerWidth 或者可能像 var winWidth = $(window). width();)，但我没有使用 Java/Javascript 的经验。有什么帮助吗？同样，我想将持有水平导航栏的 div 的位置设置为浏览器窗口宽度的 85%。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T16:57:40.103

[http://jsfiddle.net/f7RMA/](http://jsfiddle.net/f7RMA/)

```
<div class="box">
  <img src="http://renboy.com/images/squareWeb.jpg">
  <div class="bar"></div>
</div> 
```

CSS：

```
.box {
    position: absolute;
    z-index: -1;
    top: 0;
    left: 0;
    width: 100%;
}

.box img {
    display: block;
    width: 100%;
}

.box .bar {
    position: absolute;
    width: 100%;
    height: 10%;
    top: 85%;
} 
```

WTF 发生：`.box`设置为 100% 宽度。里面的图像也设置为100%。非蹩脚浏览器中的图像在仅调整一侧大小时会保持其纵横比。`.box`想要完全包含图像，所以它的高度将设置为图像的高度。因为`.box`是绝对定位的，所以您可以将其`.bar`放在里面`.box`并根据需要垂直定位，因为`.box`现在有一个明确定义的高度。

# r - plyr 相当于使用 mapply 完成的语句

> ID：11478167
> 
> 赞同：1
> 
> 时间：2012-07-13T20:50:45.177
> 
> 标签：r, plyr

我猜 mlply 应该在这里用于相当于我在 mapply 中所做的事情，但我无法弄清楚如何。我真的很想更好地了解 plyr 包。

```
df <- data.frame(start=as.Date(c("2012-01-01","2012-02-02")),end=as.Date(c("2012-01-04","2012-02-08")))
l <- mapply(function(x,y) seq(x,y,by="day"),df$start, df$end) 
```

提前致谢，--JT

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T20:59:39.133

如果您需要根据数据框中的变量名称来命名函数参数，我认为会有很大的不同：

```
mlply(df,function(start,end){seq(start,end,by = "day")}) 
```

# django - 使用 @csrf_exempt 并在同一视图中创建 CSRF 令牌

> ID：11478169
> 
> 赞同：1
> 
> 时间：2012-07-13T20:50:54.510
> 
> 标签：django, python-2.7, django-csrf

我期待`POST`来自第 3 方服务器。我知道我需要使用`@csrf_exempt`装饰器来允许来自第 3 方服务器的帖子。我在 Ubuntu 12.04 上使用 Django 1.4 和 Python 2.7。

现在，我的视图将生成一个未绑定的表单，该表单将包含供用户填充的字段以及包含原始信息的隐藏字段`POST`。因此，第一个`POST`将启动第二个`POST`。

第二个`POST`将从我的服务器发送到我服务器上的另一个视图。我试图弄清楚如何`CSRF`为我的表单生成令牌。

我正在尝试完全按照我在[文档](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/?from=olddocs#how-to-use-it)中阅读的内容进行操作。

我的views.py代码：

```
from django.core.context_processors import csrf
from django.shortcuts import render_to_response
from gateway_interface.post_handling import PostHandling

@csrf_exempt
def requestNewPaymentInfo(request):

    c = {}
    c.update(csrf(request))

    # Gather information posted
    if (request.method == "POST"):
        # Create the initialization dictionary based on POST values
        postHandling = PostHandling()
        post_dict = postHandling.createDictionary(request)

        # Create the form
        form = addPaymentForm(initial = post_dict)

        return render_to_response('requestNewPaymentInfo.html', { 'form' : form }, c) 
```

你现在在模板方面做什么？！？同样，从文档中我认为我应该执行以下操作：

```
<form action="/addPayment/" method="post">
   {% csrf_token %}
</form> 
```

我通过`POST`从 3rd 方服务器进行测试来测试这一点。有时我会看到完全生成的表单似乎是一个有效的`CSRF`令牌。

有时我会看到如下所示的失败：

```
Django Version: 1.4
Python Version: 2.7.3
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'gateway_interface')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/views/decorators/csrf.py" in wrapped_view
  77\.         return view_func(*args, **kwargs)
File "/home/tokeniz/tokeniz/gateway_interface/views.py" in requestNewPaymentInfo
  64\.         return render_to_response('requestNewPaymentInfo.html', { 'form' : form }, c)
File "/usr/local/lib/python2.7/dist-packages/django/shortcuts/__init__.py" in render_to_response
  20\.     return HttpResponse(loader.render_to_string(*args, **kwargs), **httpresponse_kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/template/loader.py" in render_to_string
  178\.         context_instance.pop()

Exception Type: TypeError at /requestNewPaymentInfo/
Exception Value: pop expected at least 1 arguments, got 0 
```

然后我最终会得到这个错误：

```
Forbidden (403)
CSRF verification failed. Request aborted. 
```

一旦我收到`CSRF verification failed`错误，我将继续收到此错误，直到我清除 cookie 并重新开始。

谁能告诉我我做错了什么？我可以看到它与我如何生成`CSRF`令牌有关。根据文档中的内容，我不明白该过程是如何工作的。`c`在我看来是什么？我正在填充信息并传递给`render_to_response`. 好的，但是如何在模板中使用它？

我的模板应该是这样的：

```
<form action="/addPayment/" method="post">
   {% c.csrf_token %}
</form> 
```

如果不是，为什么？Django 怎么知道这`c`包含`CSRF`令牌？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T00:16:24.783

为了解决您的问题，让我可以澄清一些事情。

简而言之，Django 的模板系统使用两个数据：*上下文*和*模板*。

当您在模板文件中放置一个要显示的变量时`{{ foo }}`，django 将在相应的*上下文实例*中`dict`查找该变量的值。

现在`render_to_response`，您作为第二个参数 a 传递给它的`dict`内容本质上是您想要放入模板上下文中的数据，因此您可以使用它。第三个参数是一个`Context`实例，而不是数据本身，当您需要自定义事物时它会很有用。

好的，让我们看看你的例子，

```
return render_to_response('requestNewPaymentInfo.html', { 'form' : form }, c) 
```

在这里，您在阅读文档示例时犯了一个错误，您将`c`其作为上下文*实例*，而不是上下文*数据*，因此您的令牌甚至没有进入模板，并且您在 django 期望 Context 对象的地方遇到了所有那些奇怪的错误，但只有得到了字典。

所以要修复，你只需要在模板数据中传递 csrf 令牌：

```
c.update({'form': form})
return render_to_response('requestNewPaymentInfo.html', c) 
```

在模板内部：

```
{% csrf_token %} 
```

我建议[为程序员阅读模板系统解释](https://docs.djangoproject.com/en/1.4/ref/templates/api/)，它写得很好。

# ios - 如何在 Objective-C 中将数组从一个类转移到另一个类？

> ID：11478170
> 
> 赞同：0
> 
> 时间：2012-07-13T20:51:03.450
> 
> 标签：ios, objective-c, arrays, cocos2d-iphone

正如人们可能期望的那样，我是 Objective-C 和 Cocoa2d 的新手，所以这可能很明显，但我似乎无法让它以一种有意义的方式工作。

我要做的是制作一个包含 10 个成员的数组（稍后将添加更多），其中包含 [0,1,2,3] 整数，稍后我希望这些数字用于级别选择屏幕，其中0 表示关卡已锁定（未完成），数字 >0 表示星数（三分之二），表示关卡已完成，在关卡结束时我想更改数组以反映关卡完成。出于测试目的，我用“随机整数”（0-3）填充数组（in `LevelSelection.m`）：

```
NSMutableArray *LevelCompArray = [NSMutableArray arrayWithCapacity:10];
        for(int i = 0; i<10; i++){
            int x= (arc4random() % (4));
            [LevelCompArray addObject:[NSNumber numberWithInteger:x]];
        } 
```

我没有分配也没有初始化数组，但它似乎在函数本身内工作，`-(id) init`尽管我相信这是我问题的根源。

我的问题很简单，我如何将这个数组（以及我将在游戏进行时创建的其他数据）从一个类传输到另一个类（例如 from `LevelSelection.m`to `LevelCompleted.m`）和从一个函数到另一个函数（例如`-(id) init`and `-(void) launchLevel`）。我是否有一个所有必需​​类都可以访问的数据集中文件？如果是这样的话，所有关于“.plist”的话题是什么？如果不是，我是否通过方法将数据传输到目标类/方法？我怎么做？

非常感谢任何帮助，将我转移到教程也将非常有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T20:59:44.117

你应该使用数组的属性。像这样：首先你需要在 secondviewcontroller.h 中创建数组，像这样：

```
 NSMutableArray *LevelCompArray;
    @property (nonatomic, retain) NSMutableArray *LevelCompArray; 
```

然后在secondviewcontroller.m中合成：

```
@synthesize LevelCompArray; 
```

然后，例如，您想在 FirstViewController 中的按钮被触摸时传递 Array。在其操作中，您可以将其设置为获取第二个视图控制器的实例，如下所示：

```
secondViewController.LevelCompArray = someArray; 
```

实际上它是在视图控制器之间传递数据，有关更多信息，请查看此链接： [在视图控制器之间传递数据](https://stackoverflow.com/questions/5210535/passing-data-between-view-controllers)

希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T21:07:04.780

正如您所说，一种方法是在每个人的文件中都有一堆全局变量`#import`。您不会使用`.plist`文件；相反，它`.m`就像您的所有其他源代码一样。

您还可以将信息传递给任何需要它的对象的构造函数。例如，您可以执行类似`[[LevelSelection alloc] initWithCompletionArray:LevelCompArray]`. 然后，为了确保每个对象在所述数组中都有正确的信息，请使用通知。

```
-(id) initWithStuff:(Stuff *s) {
    if(self = [super init]) {
        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(doStuff:)
                                                     name:@"LEVEL_COMPLETED"
                                                   object:anObject];
    } 
```

然后在`doStuff:`（需要一个`NSNotification*`）中，您将有一些逻辑来处理发生的任何事情，使用通知的对象。

# django - 如何在同一页面上使用多个应用程序而不是所有页面

> ID：11478174
> 
> 赞同：0
> 
> 时间：2012-07-13T20:51:11.123
> 
> 标签：django, django-models, django-templates

所以我有标准的 django 教程民意调查应用程序，我制作了一个小博客应用程序。有没有一种简单的方法可以向一些博客文章添加投票，但不是全部。

我发现了这个：

```
from django.models.polls import polls
from django.models.blogs import posts

def my_view(request):
        return render_to_response("template_name", {
                "poll_list" : polls.get_list(),
                "post_list" : posts.get_list(),
        } 
```

但是我如何在模板中选择我想要的投票，如果我将它添加到模板中，它不会出现在每个帖子中吗？我觉得我严重地过度思考或思考不足。任何建议或链接将不胜感激。谢谢。

```
models.py #for the blog app
class Post(models.Model):
    title = models.CharField(max_length=60)
    description = models.TextField()
    body = models.TextField()
    created = models.DateTimeField(auto_now_add=True)

    def display_mySafeField(self):
        return mark_safe(self.body)

    def __unicode__(self):
        return self.title

views.py # for blog class
def post(request, pk):
    """Single post with comments and a comment form."""
    post = Post.objects.get(pk=int  (pk))
    comments = Comment.objects.filter(post=post)
    d = dict(post=post, comments=comments, form=CommentForm(), user=request.user,
             months=mkmonth_lst())
    d.update(csrf(request))
    return render_to_response("post.html", d) 
```

我想在帖子中添加投票，但不是全部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:09:00.997

添加一些内容来指示哪个民意调查与哪个模型相关联。您可以使用`ForeignKey`, `ManyToManyField`, `GenericForeignKey`,`OneToOneField`等，然后使用该指标来获取与 post/s 关联的 poll/s 。

# file - 不写入文件 Scala

> ID：11478177
> 
> 赞同：0
> 
> 时间：2012-07-13T20:51:17.963
> 
> 标签：file, scala, io

我有以下代码，它应该一次写入一个文件，直到它到达 ^EOF。

```
import java.io.PrintWriter
import java.io.File
object WF {
  def writeline(file: String)(delim: String): Unit = {
    val writer = new PrintWriter(new File(file))
    val line = Console.readLine(delim)
    if (line != "^EOF") {
      writer.write(line + "\n")
      writer.flush()
    }
    else {
      sys.exit()
    }
  }
}
var counter = 0
val filename = Console.readLine("Enter a file: ")
while (true) {
  counter += 1
  WF.writeline(filename)(counter.toString + ": ")
} 
```

出于某种原因，在控制台上，一切看起来都很好，但是，当我真正读取文件时，什么都没有写入！我的程序有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:20:08.263

每次创建新`PrintWriter`文件时，都会清除现有文件。使用类似 a 的东西[`FileWriter`](http://docs.oracle.com/javase/6/docs/api/java/io/FileWriter.html#FileWriter%28java.lang.String,%20boolean%29)，它允许您指定要打开文件以进行附加：

```
val writer = new PrintWriter(new FileWriter(new File(file), true)) 
```

这应该可行，尽管这里的逻辑非常混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:19:48.963

改为使用`val writer = new FileWriter(new File(file), true)`。第二个参数告诉 FileWriter 追加到文件中。请参阅[http://docs.oracle.com/javase/6/docs/api/java/io/FileWriter.html](http://docs.oracle.com/javase/6/docs/api/java/io/FileWriter.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T00:51:28.043

我猜问题是你忘记关闭作者了。

# django - Django 1.4：将 UserProfile+User 创建为原子操作、角色和管理员集成

> ID：11478179
> 
> 赞同：0
> 
> 时间：2012-07-13T20:51:22.280
> 
> 标签：django, django-admin, python-2.7, roles, user-profile

我正在构建我的第一个真正的 django 应用程序，它具有不同的用户角色，并且正常的“创建用户配置文件的用户信号”方法不足。你们能帮帮我吗？

为了提供更多背景信息，以下是从功能角度来看的要求：

*   新用户只能从管理员添加，并且将由非技术人员完成，因此我需要一个直观且简单的用户创建流程。
*   每个用户都有一个具有不同需求和领域的角色（经理、员工、销售员等）。
*   用户列表需要同时显示用户信息和角色/个人资料信息（登录名、电子邮件、姓名和个人资料上的额外信息）

初步方法：

因此，有了这个，我采用了推荐的方法，即创建一个链接到用户的 UserProfile 1 对 1 对象，为 UserProfile 提供一个设置角色的选择字段（在调用 get_profile 时了解我正在处理的内容很有用() ) 并将 UserProfile 子类化为 ManagerUserProfile、EmployeeUserProfile 等。

问题 ：

这可以满足我在前端（管理员之外）的需求，但是在创建用户时设置信号以创建用户配置文件是没有意义的，因为我不知道应该仅根据用户信息创建哪种用户配置文件。

我的目标是一种创建特定用户的原子方式，同时它是相应的 EmployeeUserProfile/ManagerUserProfile，并具有简洁的管理表示。

我的一些想法：

*   隐藏 UserAdmin 和 User Profile 管理员，为 EmployeeUserProfile/Manager/etc 创建 AdminModels 并内联 User 模型。这样，创建用户的人只会看到一个带有相应字段的“新经理”链接。但是他们可以在没有用户的情况下创建 UserProfile 吗？我怎样才能使这个原子？我如何防止删除用户或确保他们在允许保存配置文件之前提供所有必需的信息？-> 这种方法的问题：我似乎无法内联用户，因为它没有对 UserProfile 的 PK（反之亦然）。

*   同样，隐藏 UserAdmin，公开子类配置文件 Admins，并反转信号。创建配置文件后，创建相应的用户。但为此，我需要能够从配置文件管理表单中提供用户字段（用户名、密码、电子邮件等）。

建议？

它是我的第一个应用程序，也许有一个巧妙的方法，但我还没有找到它。

感谢您抽时间阅读。干杯，泽塔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T00:03:33.747

I would suggest that you create a custom form, custom admin view and use that for creating users in one request, with the exact logic you need. You can get an idea of how it's done by looking at django's own custom user creation process [here](https://github.com/django/django/blob/master/django/contrib/auth/admin.py#L89).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T15:15:02.700

我终于找到了一种方法来实现我所需要的。它可能不是最干净的，并且可以接受建议，但它可能会帮助遇到类似问题的人。

由于我只需要从管理员创建，我专注于此并构建以下内容。

表格.py

```
class RequiredInlineFormSet(BaseInlineFormSet):
    """
    Generates an inline formset that is required
    """

    def _construct_form(self, i, **kwargs):
        """
        Override the method to change the form attribute empty_permitted
        """
        form = super(RequiredInlineFormSet, self)._construct_form(i, **kwargs)
        form.empty_permitted = False
        self.can_delete = False
        return form 
```

models.py（我没有使用信号在用户创建时自动创建配置文件）

```
class UserProfile(models.Model):
    # This field is required.
    user = models.OneToOneField(User)

    # Other fields here
    [.......]

    USER_TYPES = (
       ('manager', 'Manager'),
       ('employee', 'Employee'),
    )

    user_type = models.CharField(blank=True, max_length=10, choices=USER_TYPES)

    def __unicode__(self):
        return self.user.username

class EmployeeProfile(UserProfile):
    [...]

    def __init__(self, *args, **kwargs):
        super(EmployeeProfile, self).__init__(*args, **kwargs)
        self.user_type = 'employee'

class ManagerProfile(UserProfile):
    [...]

    def __init__(self, *args, **kwargs):
        super(ManagerProfile, self).__init__(*args, **kwargs)
        self.user_type = 'manager'

class Manager(User):
    class Meta:
        proxy = True
        #app_label = 'auth'
        verbose_name = 'manager'
        verbose_name_plural = 'managers'

    def save(self, *args, **kwargs):
        self.is_staff = True
        super(Manager, self).save(*args, **kwargs) # Call the "real" save() method.
        g = Group.objects.get(name='Managers') 
        g.user_set.add(self)

class Employee(User):
    class Meta:
        proxy = True
        #app_label = 'auth'
        verbose_name = 'employee'
        verbose_name_plural = 'employees'

    def save(self, *args, **kwargs):
        self.is_staff = False
        super(Employee, self).save(*args, **kwargs) # Call the "real" save() method.
        g = Group.objects.get(name='Employees') 
        g.user_set.add(self) 
```

管理员.py

```
class ManagerProfileAdmin(admin.StackedInline):
    model = ManagerProfile
    max_num = 1
    extra = 1
    formset = RequiredInlineFormSet

class EmployeeProfileAdmin(admin.StackedInline):
    model = EmployeeProfile
    max_num = 1
    extra = 1
    formset = RequiredInlineFormSet

class ManagerAdmin(UserAdmin):
    """
    Options for the admin interface
    """
    inlines = [ManagerProfileAdmin]

    def queryset(self, request):
        qs = super(UserAdmin, self).queryset(request)
        qs = qs.filter(Q(userprofile__user_type='manager'))

        return qs

class EmployeeAdmin(UserAdmin):
    """
    Options for the admin interface
    """
    inlines = [EmployeeProfileAdmin]

    def queryset(self, request):
        qs = super(UserAdmin, self).queryset(request)
        qs = qs.filter(Q(userprofile__user_type='employee'))

        return qs

admin.site.unregister(User)
admin.site.register(Manager, ManagerAdmin)
admin.site.register(Employee, EmployeeAdmin) 
```

# c# - TFS 如何获取测试的测试参数

> ID：11478182
> 
> 赞同：0
> 
> 时间：2012-07-13T20:51:51.770
> 
> 标签：c#, tfs-sdk

我将在一个特定的测试计划下检查所有测试用例，并且对于每个测试用例我想打印参数名称和值。

```
foreach(var param in test.TestParameter)
{

} 
```

问题是 item.Value 为空。item.Name 返回参数名称。有谁知道如何获取参数的值？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T15:56:56.880

测试参数值存储在 TestCase 对象的 TestSuiteEntry 属性中。你可以通过调用它`TestSuiteEntry.TestCase.DefaultTable.Rows[0].ItemArray`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-05-20T09:11:13.177

使用此代码，您可以获得测试用例的所有参数作为`DataRow[]`

```
TfsTeamProjectCollection tfs = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(new Uri("TFS_URL"));
ITestManagementTeamProject project = tfs.GetService<ITestManagementService>().GetTeamProject("ProjectName");
var testCase = project.TestCases.Find(1234);
var testData = testCase.Data.Tables[0];
this._dataSource = testData.Select(); 
```

如果要获取带属性的参数，可以在GitHub上查看我的仓库点击[这里](https://github.com/DotNetWebAppDeveloper/DevOps-Test-Automation "DevOps-测试-自动化")！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-14T04:35:24.683

因为我把头撞在墙上以在 powershell 中解决这个问题，所以我想我会与大家分享：

```
$ProjectName = "foo"
$TfsServerUrl = "http://tfsserverurl:8080/tfs/bar"
$testPlanName = "testplanname"

#===================================================
#     Settings
#===================================================

Write-Host "Input parameters: "
$ParamObject = @{
 'ProjectName' = $ProjectName;
 'TfsServerUrl' = $TfsServerUrl;
 'testPlanName' = $testPlanName;
}
$ParamObject | Format-Table

#===================================================
#    Main Script Body
#===================================================

  #load assemblies
    [void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.TeamFoundation.Client")
    [void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.TeamFoundation.WorkItemTracking.Client")
    [void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.TeamFoundation.TestManagement.Common")
    [void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.TeamFoundation.TestManagement.Client")
    #get TFS structure, project
 $tfs = new-object Microsoft.TeamFoundation.Client.TfsTeamProjectCollection([Microsoft.TeamFoundation.Client.TfsTeamProjectCollection]::GetFullyQualifiedUriForName($tfsServerUrl));
 $tms = $tfs.GetService([Microsoft.TeamFoundation.TestManagement.Client.ITestManagementService]);
 $project = [Microsoft.TeamFoundation.TestManagement.Client.ITestManagementTeamProject]$tms.GetTeamProject($ProjectName);
 #powershell bug workaround, $project.TestPlans property is not available
 $testPlansProperty = [Microsoft.TeamFoundation.TestManagement.Client.ITestManagementTeamProject].GetProperty("TestPlans").GetGetMethod();
 $testPlans = $testPlansProperty.Invoke($project, "instance,public", $null, $null, $null);
#   List all Test Plans
 foreach($p in $testPlans.Query("Select * From TestPlan"))
 {
  "Plan - {0} : {1}" -f $p.Id, $p.Name
 }
 $currentPlan = $testPlans.Query("Select * From TestPlan Where planName = '{0}'" -f $testPlanName)
 $plan = $currentPlan | where {$_.Name -eq $testPlanName}

 $testCases = $plan.RootSuite.AllTestCases

 foreach($testCase in $testCases)
 {
  write-host ""
  write-host "-----------"
  write-host "START - Test Case"  $testCase.Id
   write-host "Parameters:"

$testCase.TestSuiteEntry.TestCase.DefaultTable  
  write-host "-----------"
} 
```

# iphone - iOS 加密以安全地使用网络数据

> ID：11478185
> 
> 赞同：0
> 
> 时间：2012-07-13T20:52:18.720
> 
> 标签：iphone, ios, security, ssl

我正在开发一个非常简单的应用程序，它的重要部分是内容，它由多年来收集的大量信息组成。我想以一种很好的方式对其进行格式化以向用户展示。

当用户下载应用程序并首次加载时，它会转到服务器以将整个数据库导入手机。然后，他可以看到重要的项目，并对它们进行排序/过滤。为了避免有人拿走我的数据库，我将使用 SSL 连接。我知道如果他们愿意，他们可以使用该应用程序来逐个查看每条内容，但对此无能为力。

问题是：我有云中的数据（我的）。我可以使用 SSL 连接安全地下载它（有什么其他方法可以确保传输安全吗？）。当我在这里得到它时，我会将它保存在一个数据库中（Core Data 是显而易见的选择）。

如何保护内部数据库中的数据，所以如果应用程序被黑客入侵，有人无法访问数据库？我会把它放在钥匙串中，但它是一个相当大的数据库，它并不*那么*重要。（这不是明智的信息，只是我不希望任何人大量获取的信息。）

我可以做的另一件事是永远不要在设备中存储任何东西，并且让用户总是调用云，但我认为这太耗时了。并让他选择将​​他们最喜欢的选择保存到设备中。但这太耗时了，而且存在同步问题。

这是我查找的关于类似问题的参考，但没有回答我要回答的部分： [如何加密 iPhone 上传和下载信息？](https://stackoverflow.com/questions/10507994/how-to-encrypt-iphone-upload-and-download-of-info)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:05:24.393

基本上，唯一的选择是使用 SqlCipher。当然，您必须自己将其移植到 iPhone 上（除非我上次查看后有人发布了移植）。但这不是一项不可逾越的任务。

当然，即使使用 SqlCipher，您也面临着以某种方式存储密钥的挑战。没有真正安全的方法可以做到这一点——你必须使用某种形式的“默默无闻的安全”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:13:55.907

为什么不在代码中存储一些私钥信息，然后当你想下载数据库时，只需让它用密钥查询服务器？这样您就无需担心下载部分的 SSL 或加密。关于存储它，我同意 Hot Licks，SqlCipher 似乎是最好的也是唯一的选择。但是请注意加密，因为您必须向苹果申报并获得各种出口许可证（http://stackoverflow.com/questions/2135081/does-my-application-contain-encryption）。

希望这可以帮助，

乔纳森

# character-encoding - 辛普森一家的这个 mojibake/krakozyabry 说了什么？

> ID：11478186
> 
> 赞同：6
> 
> 时间：2012-07-13T20:52:29.127
> 
> 标签：character-encoding, mojibake

*在辛普森一家*的第 12 季第 7 集“The Great Money Caper”中，我注意到几年前俄罗斯宇宙飞船上的“胡言乱语”标志。今天随机，我决定搜索并查看是否有人解码它们但找不到任何结果。

![两名俄罗斯人在宇宙飞船上争吵的情节截图。 可以看到墙上有两个显示乱码的迹象。](../Images/6aa095c0378f228c12198245002b46c2.png)

我怀疑是 KOI8-R 显示为 Latin-1 或 Windows-1252。我可以抓取的图像不是很清晰。

如 Python 3 代码解释器交互所示，我对 mojibake 有两种解释：

```
>>> 'Ï‹ÏËÏÁ ¿Ä ÄÏÍ.†.'.encode('windows-1252').decode('koi8_r')
'о▀окоа ©д дом.├.'
>>> 'Ï<ÏËÏÁ ¿Ä ÄÏÍ.×.'.encode('latin1').decode('koi8_r')
'о<окоа ©д дом.в.' 
```

查看维基百科上的代码图表，我无法弄清楚“<”-like 和“+”-like 符号是什么。我考虑过暴力破解并将其与某种拼写检查字典匹配，但我宁愿先获得一些帮助。

原文或意思还能恢复吗？还是真的是胡言乱语？

（如果有人知道它在说什么，我很感激，但我想看看是否有可能通过一些代码来解决这个问题。）

编辑：一个天真的脚本：

```
codec_list = ['ascii', 'big5', 'big5hkscs', 'cp037', 'cp424', 'cp437',
'cp500', 'cp720', 'cp737', 'cp775', 'cp850', 'cp852', 'cp855', 'cp856',
'cp857', 'cp858', 'cp860', 'cp861', 'cp862', 'cp863', 'cp864', 'cp865',
'cp866', 'cp869', 'cp874', 'cp875', 'cp932', 'cp949', 'cp950', 'cp1006',
'cp1026', 'cp1140', 'cp1250', 'cp1251', 'cp1252', 'cp1253', 'cp1254',
'cp1255', 'cp1256', 'cp1257', 'cp1258', 'euc_jp', 'euc_jis_2004',
'euc_jisx0213', 'euc_kr', 'gb2312', 'gbk', 'gb18030', 'hz', 'iso2022_jp',
'iso2022_jp_1', 'iso2022_jp_2', 'iso2022_jp_2004', 'iso2022_jp_3',
'iso2022_jp_ext', 'iso2022_kr', 'latin_1', 'iso8859_2', 'iso8859_3',
'iso8859_4', 'iso8859_5', 'iso8859_6', 'iso8859_7', 'iso8859_8',
'iso8859_9', 'iso8859_10', 'iso8859_13', 'iso8859_14', 'iso8859_15',
'iso8859_16', 'johab', 'koi8_r', 'koi8_u', 'mac_cyrillic', 'mac_greek',
'mac_iceland', 'mac_latin2', 'mac_roman', 'mac_turkish', 'ptcp154',
'shift_jis', 'shift_jis_2004', 'shift_jisx0213', 'utf_32', 'utf_32_be',
'utf_32_le', 'utf_16', 'utf_16_be', 'utf_16_le', 'utf_7', 'utf_8',
'utf_8_sig',]

source_str_list = ['Ï‹ÏËÏÁ ¿Ä ÄÏÍ.†.', 'Ï<ÏËÏÁ ¿Ä ÄÏÍ.×.']

for mangled_codec in codec_list:
    for correct_codec in codec_list:
        decoded_str_list = []

        for s in source_str_list:
            try:
                decoded_str_list.append(s.encode(mangled_codec
                    ).decode(correct_codec))
            except (UnicodeEncodeError, UnicodeDecodeError):
                continue

        if decoded_str_list:
            print(mangled_codec, correct_codec, decoded_str_list) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-05T21:33:57.823

# c# - 除非启动 GUI，否则不会执行 main 中的代码（双用途 winform）

> ID：11478189
> 
> 赞同：-1
> 
> 时间：2012-07-13T20:52:45.467
> 
> 标签：c#, .net, winforms

我有一个 winform 应用程序，我们试图在没有启动 GUI 的情况下在我们的自动化系统中运行。不幸的是，当我从命令行调用它时，没有执行任何逻辑。下面是`Main()`

```
 /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {            
        if (!ValidateCommandLineArgs())
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new TestResultForm());
        }
        else
        {
            HeadlessExecution();
            return;
        }
    } 
```

`ValidateCommandLineArgs`只需检查是否`cmdline=true`已传递给应用程序，如果没有，则 GUI 会正常启动。当我在 VS2010 中调试（在项目属性文件中设置命令行参数）时，一切都按我的预期工作。但是，当我从命令行（具有相同 arg 的 VS 外部）调用它时，将`HeadlessExecution()`被忽略。它肯定是在读取 arg 并进入 else 语句（没有启动 GUI，如果你没有传递任何东西或 pass `cmdline=false`），之后我不知道会发生什么，但没有调用核心逻辑by`HeadlessExecution()`正在被执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:05:00.140

你说的当然是不可能的。它不能进入​​ else 语句，也不能执行那里找到的代码。当我的代码开始做不可能的事情时，我开始剥离代码，直到它达到我的预期。这有助于定位问题区域。或者我开始添加`Trace.WriteLine`调用以执行某些代码部分。[您可以在没有调试器的情况下使用DebugView 之](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)类的东西查看跟踪输出。

您可能会看一下[这个线程](https://stackoverflow.com/a/11058118/351385)，尤其是我的回答，因为我怀疑您对“不工作”的定义可能与控制台输出有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T05:30:36.287

只需将可见性设置为隐藏并让它在不可见的情况下运行

# c - 将代码从 PIC18F2480 移植到 PIC18F2680 微控制器

> ID：11478192
> 
> 赞同：0
> 
> 时间：2012-07-13T20:52:55.143
> 
> 标签：c, microcontroller, pic, mplab

我在 MPLAB 中为 18F2480 处理器编写了引导加载程序代码。我目前的项目需要我将微控制器升级到 18F2680。

（两个芯片的主要区别是2480有16K程序存储器/768B RAM/256B EEPROM，而2680芯片有64K程序存储器/3K RAM和1K EEPROM。）

我已将所选设备更改为“PIC18f2680”，并将 2480 头文件替换为 18f2680.h 文件。我在使用我通常用来更新 2480 固件的程序与 2680 通信时遇到问题。（我无法提供有关此软件的详细信息，因为它是专有的。）

我只是想知道将代码从 2480 迁移到 2680 是否存在任何已知问题/并发症。

FWIW，我已经成功地将 2480 替换为具有 32K 程序存储器、1536 RAM 字节和 256B EEPROM 的 2580。代码工作正常，我所要做的就是替换头文件并在 MPLAB 中选择不同的设备。是否与 24/2580 和 2680 的 EEPROM 大小不同有关？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T15:58:09.523

PIC 18f2480 有一个 32 字节的编程块（数据表第 7.5 章）。PIC 18F2680 有一个 64 字节的编程块（数据表第 6.5 章）。

因此需要更改引导加载程序以使用不同的块大小。

# json - 仅从链接数据构建力有向图

> ID：11478197
> 
> 赞同：8
> 
> 时间：2012-07-13T20:53:04.293
> 
> 标签：json, d3.js, force-layout

我对 d3.js 有点陌生，但我玩得很开心。到目前为止，我已经实现了一个与许多示例和教程非常接近的力导向图。

**直接关注**

像许多示例一样，我有一个这样的 JSON 结构：

```
{"nodes": ["node1", "node2",  ... ],
 "links": [{source: 0, target: 1, "field1": 5, ...}, ... ]} 
```

但是，我认为像这样构建我的数据源会更容易：

```
{"links": [
    {source: "node1", target: "node2", "field1": 5, ...},
    {source: "node2", target: "node4", "field1": 1, ...},
    {source: "node3", target: "node4", "field1": 8, ...}
]} 
```

不是在我的图中显式定义节点，而是在链接结构中隐式定义它们。

**原因**

我想列出该项目的最终目标，以防有人有一些我不知道的特定示例代码或惯用的方法。

该项目的目标最终将是一个实时更新的图表。后端正在开发中，可能会进行一些更改和修订。

目前，我想象每 X 秒拉下一个更新的 JSON 提要，并使用新信息更新该图的结构。拉取的提要仅包含图的更新结构，因此脚本需要维护所有已拉取的节点和链接，并在必要时添加任何新的节点和链接。

**谢谢！**

如果以前有人问过这个问题，我很抱歉。我做了一些搜索，没有找到任何东西。如果我错过了，请随意侮辱和斥责我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T20:30:45.983

我已经在示例“[基于 D3 的力有向径向图](http://bl.ocks.org/2879486)”中做到了这一点。我这样做是因为我想了解数据是如何在内部使用的，独立于 JSON 和 CSV 等结构，这些结构以后总是可以分层的。

无论如何，我希望这个例子对你有所帮助。

我最好的，

坦率

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T03:02:10.917

我不得不这样做几次。我发现的最简单的方法是简单地计算基于链接列表的节点集，然后将其转换为数组供力图使用：

```
var links = [ .... ];
var nodeMap = {};
links.forEach(function(d, i) { 
    nodeMap[d.source] = true;
    nodeMap[d.target] = true;
});

var nodes = [];
for (key in nodeMap)
    nodes.push(key);

d3.layout.force()
         .nodes(nodes)
         .links(links); 
```

# javascript - 基于用户输入数字的Javascript计算代码

> ID：11478201
> 
> 赞同：0
> 
> 时间：2012-07-13T20:53:19.063
> 
> 标签：javascript, html

我正在尝试创建一个 JavaScript 租赁计算器，用户将在其中输入输入（购买价格），并根据输入的金额进行计算（进一步我将添加一个范围以高于和低于一定百分比计算出来的数字）。

这是我的 javascript 中的一个示例：

```
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
function aplusb(form) {

a=eval(Calc.num1.value)

if (a < 1000)
  {
  b= 0.05372
  c=a * b
  Calc.Input.value = c
  Calc.Input2.value = c - (c * 0.15)
  Calc.Input3.value = c + (c * 0.15))
  }
else if (1001 < a < 2000)
  {
  b= 0.04875
  c=a * b
  Calc.Input.value = c
  Calc.Input2.value = c - (c * 0.15)
  Calc.Input3.value = c + (c * 0.15))
  }
else
  {
  b= 0.04689
  c=a * b
  Calc.Input.value = c
  Calc.Input2.value = c - (c * 0.15)
  Calc.Input3.value = c + (c * 0.15))
  }
}

</script> 
```

和我用来调用脚本的 html

```
<form name="Calc" action="--WEBBOT-SELF--" method="POST">
<p>

Enter Purchase Price:
<input type="text" name="num1" size="12" tabindex="1">

<br> Calculation: <input type="text" name="Input" size="17" tabindex="4">

Range
<input type="text" name="Input2" size="17" tabindex="4">
<input type="text" name="Input3" size="17" tabindex="4">

</p>
<input type="button" name="sum"  value="Calculate" OnClick="aplusb(this.form)" tabindex="3">
</form> 
```

如果它只是对任何数字进行相同的计算，该脚本就可以正常工作，但是一旦我添加“if”命令，之后它就不起作用了。基本上会有一组大约 10 个 if else 命令。任何帮助将非常感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:03:32.513

我可能错了，但我认为这在 JavaScript 中无效

```
else if (1001 < a < 2000) 
```

我认为应该是

```
else if (a > 1001 && a < 2000) 
```

如果我错了，请有人纠正我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:09:50.063

您的主要问题是缺少分号和带有 double )) 的行，例如：

```
Calc.Input3.value = c + (c * 0.15)) 
```

固定：

```
Calc.Input3.value = c + (c * 0.15); 
```

这是一个固定版本：http: [//jsbin.com/atelen/edit#preview](http://jsbin.com/atelen/edit#preview)

# javascript - 动画播放状态行不起作用并禁用另一个功能？

> ID：11478202
> 
> 赞同：0
> 
> 时间：2012-07-13T20:53:25.573
> 
> 标签：javascript, html, css, css-animations

警告：我是菜鸟。我的 J/S 中有这两个功能：

```
function please()
{
    document.getElementById("test3").innerHTML = "mercy";
}

function displayAnimation()
{

    document.getElementById('myfirst').style.animation-play-state = 'running';
    document.getElementById('myfirst').style.-moz-animation-play-state = 'running';
    document.getElementById('myfirst').style.-webkit-animation-play-state = 'running';

} 
```

据我所知，他们没有任何互动。但是当我在 displayAnimation() 中有 3 行时， please() 不起作用，即使我的其他 J/S 函数可以工作。

除此之外，当我激活 displayAnimation() 时，动画不会从“暂停”变为“运行”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:02:50.307

如果您仔细查看样式属性，您会发现它们的语法无效（JavaScript 语法）

由 a 分隔的多个单词属性的命名约定`-`是 first-second --> `firstSecond`eg

```
style.animationPlayState 
```

对于供应商前缀 -prefix-other -->`PrefixOther` 例如

```
style.MozAnimationPlayState 
```

# c# - 如何将 WCF 样式格式的日期字符串（即“/Date(1342210377000)/”）转换为 c# DateTime？

> ID：11478210
> 
> 赞同：3
> 
> 时间：2012-07-13T20:54:17.273
> 
> 标签：c#, json, wcf, datetime, datacontractserializer

ajax 请求以 WCF 格式发送日期值？它是一个转换为字符串的 javascript 日期对象，WCF 可以使用 DataContractSerializer 反序列化。

```
"/Date(1342210377000)/" 
```

客户端曾经将此数据发送到 WCF 服务，但现在将其发送到 asp.net mvc 控制器。有谁知道我如何在不执行 string.replace 操作的情况下将该字符串反序列化为 ac# DateTime？我可以利用现有的 .NET 序列化程序吗？我查看了使用 DataContractSerializer，但它的 readobject 方法需要一个流或 xmlreader。我无法弄清楚如何将 modelbindercontext.valueprovider 值转换为序列化程序可以使用的流对象。如果有人知道我如何正确转换该字符串，我很想学习如何。感谢您提供任何提示、技巧、代码、链接等...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T21:10:21.517

您可以使用 将`DataContractJsonSerializer`其转换为`DateTime`值：

```
var str = "\"/Date(1342210377000)/\"";
var dcjs = new DataContractJsonSerializer(typeof(DateTime));
var ms = new MemoryStream(Encoding.UTF8.GetBytes(str));
var dt = dcjs.ReadObject(ms);
Console.WriteLine(dt); 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-07-13T21:08:47.647

```
DateTime.ToUniversalTime() 
```

例如，这会为您提供“YYYY-MM-DD hh:mm:ss”的输出格式，而不是让您的 C# 代码执行您想要的格式化部分。

# c# - .NET JITter 是否对数学表达式中的基元进行优化？

> ID：11478216
> 
> 赞同：0
> 
> 时间：2012-07-13T20:54:49.157
> 
> 标签：c#, optimization, jit

我有一些 C# 代码执行一些涉及原始数据类型的计算，例如：

```
public sealed class Calculation
{
    private readonly int a, b, c;

    public Calculation(int _a, int _b, int _c)
    {
        this.a = _a; this.b = _b; this.c = _c;
    }

    public int DoCalculation(int rfactor, int lfactor)
    {
        return (a / rfactor) + (b / lfactor) + ((a/b)*(rfactor+lfactor));
    }
} 
```

如果 {a,b,c} 是编译时常量，则 DoCalculation(...) 方法中的表达式可以在 CIL 级别进行极大优化。我想知道 JITer 是否会优化 DoCalculation(...) 方法，类似于给出“只读”提示的编译时间常数优化。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:09:26.887

不，因为变量不是常量。它们的值在 jitting 时是未知的。只读并不会改变它们的运行时值未知并且实例之间可能不同的事实。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T21:20:04.563

您的示例不是一个很好的示例，但是是的，这种优化肯定会发生。在不止一个级别上，C# 编译器首先获得了机会。它将用文字值评估简单的表达式并用结果替换它们。还有它可以在编译时检测溢出的方式。

抖动优化器也会这样做，通常是*内联*方法的结果。但这不会发生在您的 DoCalculation() 方法中，因为它太复杂而无法进行内联。但是一个微不足道的，比如：

```
 public static int DoCalculation(int a, int b) {
        return a * b;
    } 
```

肯定会被内联和优化。像 Console.WriteLine(Calculation.DoCalculation(4, 5)) 生成：

```
00000003  call        5927D408 
00000008  mov         ecx,eax 
0000000a  mov         edx,14h                      // <=== here
0000000f  mov         eax,dword ptr [ecx] 
00000011  mov         eax,dword ptr [eax+38h] 
00000014  call        dword ptr [eax+14h] 
```

请注意结果 4 * 5 = 20 = 0x14 是如何预先计算的。

在优化器放弃之前，该方法何时可以被内联以及表达式的参与程度没有硬性规定。这可能会发生变化，并且取决于抖动的类型（x86 vs x64 vs ARM）。

如果此代码位于您的关键路径深处，并且探查器告诉您它负责 80+% 的执行时间（不要跳过探查器！）那么值得您花时间修改该方法并查看你得到什么。调试发布模式构建并确保允许优化器运行。工具 + 选项，调试，常规，取消勾选“在模块加载时抑制 JIT 优化”选项。

微小的变化可以产生很大的影响，当您通过看似微不足道的编辑将代码速度提高一倍时，感觉非常好。或者不是，经过一天的尝试，你一无所获，没有保证。但是你肯定会对什么样的代码运行良好产生一种“感觉”，一种*非常*有价值的经验和洞察力。

# cuda - CUDA：未指定的启动失败

> ID：11478218
> 
> 赞同：-1
> 
> 时间：2012-07-13T20:54:55.303
> 
> 标签：cuda, complex-data-types

我正在使用 CUDA-GDB 来找出我的内核执行的问题。它总是会输出；Cuda 错误：内核执行：未指定的启动失败。这可能是任何人可能遇到的最严重的错误，因为没有任何迹象表明发生了什么！

回到 CUDA-GDB……当我使用调试器时，它会到达内核并输出；断点1，MYKERNEL（__cuda_0 = 0x200300000，__cuda_1 = 0x200400000，__cuda_2 = 320，__cuda_3 = 7872，__cuda_4 = 0xe805c0，__cuda_5 = 0xea05e0，__cuda_6 = 0x96dfa0，__cuda_7 = 0x955680，__cuda_8 = 0.056646065580379823，__cuda_9 = -0.0045986640087569072，__cuda_10 = 0.125， __cuda_11=18.598229033761132, __cuda_12=0.00048828125, __cuda_13=5.9604644775390625e-08) 在 myFunction.cu:60

然后我会输入：下一个。

输出; __device_stub__Z31chisquared_LogLikelihood_KernelPdS_iiP12tagCOMPLEX16S1_S1_S_dddddd () 中的 0x00007ffff7f7a790 来自 /home/alex/master/opt/lscsoft/lalinference/lib/liblalinference.so.3

该部分中值得注意的部分是它有一个 typedef 数据类型的标签。COMPLEX16 定义为：typedef double complex COMPLEX16

然后我会输入：下一个。输出; 单步执行直到从函数*Z84* _device_stub__Z31chisquared_LogLikelihood_KernelPdS_iiP12tagCOMPLEX16S1_S1_S_ddddddPdS_iiP12tagCOMPLEX16S1_S1_S_dddddd@plt 退出，该函数没有行号信息。0x00007ffff7f79560 在?? () 来自 /home/alex/master/opt/lscsoft/lalinference/lib/liblalinference.so.3

输入下一个...输出；找不到当前函数的边界

键入 continue... Cuda 错误：内核执行：未指定的启动失败。

这是我在没有调试的情况下得到的错误。我已经看到了一些类似的论坛主题，其中调试器无法找到当前函数的边界，可能是因为库以某种方式未链接或类似的东西？这 ？？据说是因为调试器由于某种原因而在某个地方是shell，而不是在任何函数中。

我相信问题更深层次在于我的代码中有这些有趣的数据类型。COMPLEX16 REAL8

这是我的内核...

```
__global__ void chisquared_LogLikelihood_Kernel(REAL8 *d_temp, double *d_sum, int lower, int dataSize,
        COMPLEX16 *freqModelhPlus_Data,
        COMPLEX16 *freqModelhCross_Data,
        COMPLEX16 *freqData_Data,
        REAL8 *oneSidedNoisePowerSpectrum_Data,
        double FplusScaled,
        double FcrossScaled,
        double deltaF,
        double twopit,
        double deltaT,
        double TwoDeltaToverN)
{
    int idx = blockIdx.x * blockDim.x + threadIdx.x;

    __shared__ REAL8 ssum[MAX_THREADS];

    if (idx < dataSize)
    {
        idx += lower; //accounts for the shift that was made in the original loop

        memset(ssum, 0, MAX_THREADS * sizeof(*ssum));

        int tid = threadIdx.x;
        int bid = blockIdx.x;

        REAL8 plainTemplateReal = FplusScaled * freqModelhPlus_Data[idx].re
            + freqModelhCross_Data[idx].re;
        REAL8 plainTemplateImag = FplusScaled * freqModelhPlus_Data[idx].im
            + freqModelhCross_Data[idx].im;
        /* do time-shifting...             */
        /* (also un-do 1/deltaT scaling): */
        double f = ((double) idx) * deltaF;

        /* real & imag parts of  exp(-2*pi*i*f*deltaT): */
        double re = cos(twopit * f);
        double im = - sin(twopit * f);

        REAL8 templateReal = (plainTemplateReal*re - plainTemplateImag*im) / deltaT;
        REAL8 templateImag = (plainTemplateReal*im + plainTemplateImag*re) / deltaT;
        double dataReal     = freqData_Data[idx].re / deltaT;
        double dataImag     = freqData_Data[idx].im / deltaT;
        /* compute squared difference & 'chi-squared': */
        double diffRe       = dataReal - templateReal;         // Difference in real parts...
        double diffIm       = dataImag - templateImag;         // ...and imaginary parts, and...
        double diffSquared  = diffRe*diffRe + diffIm*diffIm ;  // ...squared difference of the 2 complex figures.

        //d_temp[idx - lower] = ((TwoDeltaToverN * diffSquared) / oneSidedNoisePowerSpectrum_Data[idx]);

        //ssum[tid] = ((TwoDeltaToverN * diffSquared) / oneSidedNoisePowerSpectrum_Data[idx]);

        /*****   REDUCTION    *****/

        //__syncthreads(); //all the temps should have data before we add them up

        //for (int i = blockDim.x / 2; i > 0; i >>= 1) { /* per block */
        //  if (tid < i)
        //     ssum[tid] += ssum[tid + i];

        //  __syncthreads();
        //}

        //d_sum[bid] = ssum[0];

    }
} 
```

当我不调试时（-g -G 未包含在命令中），只有在我不包含以 d_temp[idx - lower] 和 ssum[tid] 开头的行时，内核才能正常运行。我只做了 d_temp 以确保它不是共享内存错误，运行良好。我还尝试使用 ssum[tid] = 20.0 和其他各种数字类型运行，以确保它不是那种问题，也运行良好。当我使用其中任何一个运行时，内核会以上面的 cuda 错误退出。

请问我是否有不清楚或令人困惑的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T03:59:03.227

我的问题在这里缺乏背景。假设可能是我在内核执行之前为所有涉及的指针完成了 cudaMalloc 和其他类似的初步工作。然而，我只对 d_temp 和 d_sum 做了这件事（我做了很多开关，几乎没有意识到我在做其他四个指针）。一旦我为所需的数据执行了 cudaMalloc 和 cudaMemcpy，那么一切都运行得很好。

感谢您的洞察力。

# jquery - 下移 Jquery

> ID：11478221
> 
> 赞同：1
> 
> 时间：2012-07-13T20:54:57.510
> 
> 标签：jquery, position

我在我的网站上添加了一些脚本：http: [//cargocollective.com/btatest](http://cargocollective.com/btatest)

但是，我很想将其向下移动 40 像素。

我试图将它包装在一个 div 中，但无济于事。

这是脚本：

```
<script type="text/javascript">
        // The social div 
    var $socialDiv,
        // The social div's height 
        socialDivHeight = 500,
        currentSocialDivHeight = socialDivHeight;

    $(document).ready(function() {
        $socialDiv = $('.social');
        $socialDiv.css({
            'background-image': 'url(http://fearthegrizzly.com/productions/theacrobat/web3.jpg)',
            'background-repeat': 'no-repeat',
            'background-attachment': 'fixed',
            'background-size' : '110% 100%',
            'height' : socialDivHeight + 'px',
            'margin-left' : '-50%',
            'margin-right' : '-50%',

        });
    });

    $(window).scroll(function() { 
        //Get scroll position of window 
        var windowScroll = $(this).scrollTop(); 

        var newSocialDivHeight = Math.max(0, socialDivHeight - windowScroll);

        if (Math.abs(newSocialDivHeight - currentSocialDivHeight) < 1)
            return;

        $socialDiv.css({
            'opacity' : 1 - windowScroll / 400
        });

        currentSocialDivHeight = newSocialDivHeight;
    });
</script> 
```

任何帮助，将不胜感激。

谢谢

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:02:44.160

将`margin-top`属性添加到您的 Class Name **.social** CSS 设置中，如下所示：

```
$socialDiv.css({
            'background-image': 'url(http://fearthegrizzly.com/productions/theacrobat/web3.jpg)',
            'background-repeat': 'no-repeat',
            'background-attachment': 'fixed',
            'background-size' : '110% 100%',
            'height' : socialDivHeight + 'px',
            'margin-left' : '-50%',
            'margin-right' : '-50%',
            'margin-top': '40px'
        }); 
```

# ios - iPhone / iPad 开发：可以在“应用程序之外”进行编码吗？

> ID：11478222
> 
> 赞同：-3
> 
> 时间：2012-07-13T20:55:01.517
> 
> 标签：ios

对于那些发现我的标题不够精确的人，请提前道歉。如果有人找到更好的方式为帖子命名，请成为我的客人：）我的想法是，我是通过想法和项目学习的人。不是通过书本。我通过自己想要实现的东西自学了 PHP、HTML、CSS、JQuery... 随便... 所以现在我有了一个 iPhone/Ipad 应用程序的想法。我知道我必须深入研究 Objective-C。但在这样做之前，我想知道是否可以在“应用程序之外”构建。我的意思是，例如，当您在 iphone 中突出显示来自 safari 的文本时，您会得到一个带有“副本”字样的气泡。例如，是否有可能有一个名为“whatever”的第二个选择，它将突出显示的文本发送到我开发的应用程序。我不想知道该怎么做。如果可能的话，我会自己弄清楚。我只是想知道这是否可能？先感谢您。干杯。马克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T20:59:38.337

您想要的听起来像是系统范围的插件，并且可以通过越狱设备和使用 MobileSubstrate 来实现。但是，AppStore 应用程序无法从中受益。

# android - 强制操作栏显示搜索视图

> ID：11478227
> 
> 赞同：22
> 
> 时间：2012-07-13T20:55:15.137
> 
> 标签：android, android-actionbar, android-3.0-honeycomb, android-4.0-ice-cream-sandwich

我可以通过这样的操作来扩展搜索视图

```
<item android:id="@+id/menu_search"
          android:title="Search"
          android:showAsAction="never|collapseActionView"
          android:actionViewClass="android.widget.SearchView" /> 
```

但我有一个 3 选项卡活动，我希望 SearchView 始终被扩展我该怎么做？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-07-26T16:25:29.383

两个步骤是必要的。

首先，您必须确保您的搜索菜单项始终显示为一个操作，并且永远不会移动到溢出菜单中。要实现这一点，请将搜索菜单项的`showAsAction`属性设置为`always`：

```
<item
    android:id="@+id/menu_search"
    android:title="Search"
    android:showAsAction="always"
    android:actionViewClass="android.widget.SearchView" /> 
```

其次，确保动作视图默认不以图标化（即折叠）模式显示。要`setIconifiedByDefault(false)`在您的搜索视图实例上执行此调用：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.my_activity, menu);

    MenuItem searchViewItem = menu.findItem(R.id.menu_search);
    SearchView searchView = (SearchView) searchViewItem.getActionView();
    [...]
    searchView.setIconifiedByDefault(false);

    return true;
} 
```

那应该这样做。

# android - Android：存储字符串对的好方法

> ID：11478228
> 
> 赞同：2
> 
> 时间：2012-07-13T20:55:25.200
> 
> 标签：android, hashmap

我有一个 Activity，它首先需要在 HashMap 的帮助下根据输入确定输出。我在里面存放了 25 双。

问题是 HashMap 每次活动开始时都会初始化。这让我想到了存储这些对的最佳方式——它们应该在“外部资源”中，还是其他一些解决方案——以使对持久化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:12:41.963

将哈希图中的数据放入一些持久存储中可能不会帮助您在创建活动时绕过初始化哈希图。如果您的应用程序经常使用此活动，则可能更值得将 Hashmap 作为字段存储在 Application 类中，然后通过应用程序上下文从任何活动访问。

```
 SampleApplication extends Application{
        private HashMap<String,String> mMap = null;

        public void onCreate(){
            //initialize your hashmap here
            ...
        }

        public getHashMap{
            return this.mMap;
        }
     } 
```

要从项目中的任何活动中获取地图，只需使用以下代码：

```
 HashMap<String,String> map = ((SampleApplication)getApplicationContext()).getHashMap(); 
```

如果您仍需要持久存储数据，您可以选择[此处](http://developer.android.com/guide/topics/data/data-storage.html)列出的五种方法之一。HashMap 确实实现了 Serializable，所以如果是我，我可能会使用 SharedPreferences。

**如果您使用的字符串永远不会改变，那么编辑**Mert 的答案非常好，只需使用字符串资源即可。但是，如果您需要进行大量操作，那么集合的便利性可能仍然使我的回答中的方法值得。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T20:59:41.777

这取决于如何使用您的字符串..

如果全部固定且永久，您可以将它们存储在 String XML 上。

如果您只使用应用程序运行，您可以创建一个类并存储在 ApplicationContext 中。

您可以保留文件/sqlite db 或用户设置。

# css - 在 IE 中滚动时条纹重复背景闪烁

> ID：11478229
> 
> 赞同：4
> 
> 时间：2012-07-13T20:55:25.677
> 
> 标签：css, internet-explorer, background-image

尝试上下滚动此页面并观看下面的图片。您可能会注意到图像闪烁。（不要使用滚轮，因为这可能会滚动大量离散量并且您不会看到效果。）

![条纹](../Images/8e817335948542be163a18b0848f202d.png)

为了避免在使用条纹背景时出现这种效果，您可以在 CSS 中添加以下内容：

`background-attachment: fixed;`

这会导致背景保持固定，因此当用户滚动页面时它不会出现闪烁。这在 Chrome 和 Firefox ( [demo](http://jsfiddle.net/AuGcs/) ) 中运行良好，**但在 IE 中不行。**IE8 及更高版本应该支持背景附件功能，为什么这不起作用？更重要的是，如何消除 IE 中的闪烁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:44:21.187

您可以将其仅提供给 IE9（在 IE8 中，它似乎不适用于伪元素，因此对于 IE7-8 支持，将其设置为 elmeent 本身）或将其用于所有浏览器，但实际上将其放入`fixed`元素中（或者在这种情况下，一个伪元素）为我解决了闪烁（[**见小提琴**](http://jsfiddle.net/AuGcs/8/)）：

```
.background:after {  
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url(http://www.commentnation.com/hotlinks/diagonal_pin_stripes_background_gray_on_white.gif);
    background-attachment: fixed;
    z-index: -1;
} 
```

**对于 IE7-8**（[**见小提琴**](http://jsfiddle.net/AuGcs/10/)）：

```
.background {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url(http://www.commentnation.com/hotlinks/diagonal_pin_stripes_background_gray_on_white.gif);
    background-attachment: fixed;
    z-index: -1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-06T10:55:01.713

我建议你添加

```
<script>
if(navigator.userAgent.match(/Trident\/7\./)) {
  document.body.addEventListener("mousewheel", function() {
    event.preventDefault();
    var wd = event.wheelDelta;
    var csp = window.pageYOffset;
    window.scrollTo(0, csp - wd);
  });
}
</script> 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-07-13T21:49:45.627

我建议你添加

```
background-repeat: no-repeat; 
```

如果您还没有，请到 css 并调整背景位置。这可能有助于闪烁。还要确保您使用正确的 DOCTYPE 来支持后台附件。

# java - 如何使用 Java Timer 处理多个重复任务？

> ID：11478231
> 
> 赞同：-2
> 
> 时间：2012-07-13T20:55:31.683
> 
> 标签：java, timer

我希望我的 java 应用程序首先使用 java Timer 类运行重复任务 A，然后是 B，然后是 C。

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:33:36.110

使用**ScheduledThreadPoolExecutor**是更好的选择。如果您使用的是 JDK1.5+，它会更准确、更好地处理异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:06:39.540

你可以试试这个方法。使用适当的异常处理对其进行扩展，以确保始终安排下一个任务。

```
static final Timer t = new Timer();
static final long delay = 1000;
public static void main(String[] args) {
  t.schedule(new A(), delay);
}
static class A extends TimerTask { public void run() {
    // do stuff;
    t.schedule(new B(), delay);
} }
static class B extends TimerTask { public void run() {
    // do stuff;
    t.schedule(new C(), delay);
} }
static class C extends TimerTask { public void run() {
    // do stuff;
    t.schedule(new A(), delay);
} } 
```

# c# - 在 mvvm 的 Content Control 中更改用户控件

> ID：11478238
> 
> 赞同：1
> 
> 时间：2012-07-13T20:55:58.933
> 
> 标签：c#, wpf, mvvm

在主窗口中，我引用了两个用户控件：

```
<Window x:Class="MediaNet.View.MainWindow.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mainVM="clr-namespace:MediaNet.ViewModel.MainWindow"
        xmlns:musicV="clr-namespace:MediaNet.View.MusicWindow"
xmlns:videoV="clr-namespace:MediaNet.View.VideoWindow"
         Title="MainWindow" Height="350" Width="525">
    <Window.DataContext>
        <mainVM:MainWindowViewModel />
    </Window.DataContext>
    <Window.Resources>
        <musicV:MusicWindow x:Key="musicView" />
        <videoV:VideoWindow x:Key="videoView" />
    </Window.Resources> 
```

和内容控制：

```
<WrapPanel Width="362">
    <ContentControl Content="" />
</WrapPanel> 
```

我还有两个按钮来更改用户控件：

```
<Button Content="{Binding MenuNameMusic}"  Command="{Binding Path=ShowMusicMenuCommand}">
                <Button.RenderTransform>
                    <RotateTransform CenterY="0" CenterX="0" Angle="0" />
                </Button.RenderTransform>
            </Button>
            <Button Content="{Binding MenuNameVideo}"  Command="{Binding Path=ShowMusicMenuCommand}">
                <Button.RenderTransform>
                    <RotateTransform CenterY="0" CenterX="0" Angle="0" />
                </Button.RenderTransform>
            </Button> 
```

我应该如何在 MainWindow 的视图模型中更改 Content Control 的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T17:24:46.907

```
<WrapPanel>
        <ContentControl Content="{Binding Content}"/>
    </WrapPanel>

  public string Content
    {
        get { 
               return _content;
            }
        set { 
                _content = value;
                NotifyChange("Content"); 
            }

    }
    public ICommand ButtonCommand
    {
        get 
        {
            Content = "your content that you want to bind";
            return somecommandObject;
        }
    } 
```

我希望这将有所帮助。

# android - 漏洞百出的Android开发工具

> ID：11478243
> 
> 赞同：3
> 
> 时间：2012-07-13T20:56:08.407
> 
> 标签：android, eclipse, android-layout, adt

几天前，我的 Eclipse (3.7.2) 更新了 ADT (20.0.0)。在那之后，开发 GUI 变得非常痛苦，但是下面的一些问题之前就已经存在了。

这是经常发生但并非每次都发生的问题列表：

1.  当我滚动属性窗口时，我突然向后滚动。无论我重试多少次，它都不会停止。使用鼠标滚轮或滚动条会产生相同的结果。它总是滚动回相同的位置（就像某处缓存了某个属性）
2.  当我以 xml 格式打开布局并将鼠标悬停在一行文本上时，它会消失并在上方、下方出现几行。
3.  当我在设计器中打开设计 xml 时，它不会生成预览。在我关闭此文件并再次打开它（有时多次）后，它通常会出现在最后。（xml中没有错误）
4.  在设计器窗口顶部有几个图标（设置方向、更改边距等），它们往往像迪斯科一样闪烁。

这个一直出现：

1.  （仅在设计器中）对于高度和宽度，我只能设置 fill_parent 或 wrap_content 值。不可能设置像 0dip 这样的数值。

你有同样的问题吗？它们中的任何一个都可以修复吗？

PS我正在使用寡妇7

# session - ASP.NET Web API 会话还是什么？

> ID：11478244
> 
> 赞同：69
> 
> 时间：2012-07-13T20:56:17.260
> 
> 标签：session, asp.net-web-api

我需要在会话（或 ASP.NET Web API 中的任何内容）中存储一些信息，我需要在每个 API 请求中检索这些信息。我们将有一个 api IIS 网站，并通过主机头添加多个网站绑定。当任何请求进入时，例如 api.xyz.com，将检查主机标头并将该网站信息存储在会话中，这些信息将在调用数据库时在每个后续 api 请求中使用。

我知道 ASP.NET Web API 中不支持会话。有没有其他方法可以处理这种情况？我可以在哪里存储可以在每个后续请求中检索的信息？

谢谢。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2013-02-23T08:35:03.050

在 Global.asax 添加

```
public override void Init()
{
    this.PostAuthenticateRequest += MvcApplication_PostAuthenticateRequest;
    base.Init();
}

void MvcApplication_PostAuthenticateRequest(object sender, EventArgs e)
{
    System.Web.HttpContext.Current.SetSessionStateBehavior(
        SessionStateBehavior.Required);
} 
```

试一试 ;）

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2012-07-13T22:09:55.217

好吧，REST 的设计是无状态的。通过添加会话（或任何其他类型的），您将使其成为有状态的，并破坏了拥有 RESTful API 的任何目的。

RESTful 服务的整体理念是，*每个资源都可以使用通用语法唯一地寻址以用于超媒体链接*，并且*每个 HTTP 请求本身应该携带足够的信息，以便其接收者对其进行处理，以与 HTTP 的无状态特性完全一致”* .

因此，无论您在这里尝试使用 Web API 做什么，如果您希望拥有一个 RESTful API，很可能应该重新架构。

话虽如此，如果您仍然愿意走这条路，有一种将会话添加到 Web API 的 hacky 方法，它已由 Imran 发布在这里[http://forums.asp.net/t/1780385.aspx/ 1](http://forums.asp.net/t/1780385.aspx/1)

代码（虽然我不会真的推荐）：

```
public class MyHttpControllerHandler
  : HttpControllerHandler, IRequiresSessionState
{
    public MyHttpControllerHandler(RouteData routeData): base(routeData)
    { }
}

public class MyHttpControllerRouteHandler : HttpControllerRouteHandler
{
    protected override IHttpHandler GetHttpHandler(RequestContext requestContext)
    {
        return new MyHttpControllerHandler(requestContext.RouteData);
    }
}

public class ValuesController : ApiController
{
   public string GET(string input)
   {
       var session = HttpContext.Current.Session;
       if (session != null)
       {
           if (session["Time"] == null)
           {
               session["Time"] = DateTime.Now;
           }
           return "Session Time: " + session["Time"] + input;
       }
       return "Session is not availabe" + input;
    }
} 
```

然后将 HttpControllerHandler 添加到您的 API 路由中：

```
route.RouteHandler = new MyHttpControllerRouteHandler(); 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2014-09-22T12:40:30.290

在 WebApi 2 中，您可以将其添加到**global.asax**

```
protected void Application_PostAuthorizeRequest() 
{
    System.Web.HttpContext.Current.SetSessionStateBehavior(System.Web.SessionState.SessionStateBehavior.Required);
} 
```

然后您可以通过以下方式访问会话：

```
HttpContext.Current.Session 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-05T19:10:47.693

如果数据足够小并且不存在安全问题，您可以使用 cookie。相同的基于 HttpContext.Current 的方法应该可以工作。

请求和响应 HTTP 标头也可用于在服务调用之间传递信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-18T20:38:17.240

现在在 2017 年使用 ASP.Net Core，您可以按照此处的说明进行操作。

Microsoft.AspNetCore.Session 包提供用于管理会话状态的中间件。

启动.cs

```
public void ConfigureServices(IServiceCollection services)
{
  // Adds a default in-memory implementation of IDistributedCache.
    services.AddDistributedMemoryCache();

    services.AddSession(options =>
    {
        // Set a short timeout for easy testing.
        options.IdleTimeout = TimeSpan.FromSeconds(10);
        options.Cookie.HttpOnly = true;
    });
}

public void Configure(IApplicationBuilder app, IHostingEnvironment env)
{
    app.UseSession();
} 
```

来自文档： [ASP.NET Core 中的会话和应用程序状态简介](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/app-state)

已经在一个工作项目上测试过

# matlab - 如何从 MATLAB 的 GUI 中找到调用外部函数？

> ID：11478245
> 
> 赞同：0
> 
> 时间：2012-07-13T20:56:17.200
> 
> 标签：matlab, user-interface

我有一个外部函数（myfun.m），它将生成 4 张图像。我想在 GUI 中使用文本框为函数提供输入参数（例如原始图片的名称），但我不知道如何在我的 GUI 中运行 myfun.m。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:14:25.110

首先，我建议为您的函数的每个输入使用不同的文本框。例如，如果您的函数要求 4 个输入，我将有四个文本框。这将避免用户以某种方式格式化其文本输入的痛苦，以及将长文本字符串解析为多个输入时的痛苦。

其次，如果您的函数在 MATLAB 的路径内，那么您可以直接从 GUI 调用它，就像调用任何 MATLAB 的内置函数一样。您可能想要制作一个具有回调来执行该功能的按钮。

这个函数的回调应该看起来的方式是 l

# javascript - 从浏览器打开文件时出现奇怪的 Javascript/vbscript 行为

> ID：11478246
> 
> 赞同：3
> 
> 时间：2012-07-13T20:56:18.313
> 
> 标签：javascript, file, vbscript

我最近必须使用的旧 Web 应用程序出现问题。有一个包含以下内容的输入元素：

```
onClick="javascript:Run('**SomeFilePath.mdb**');" 
```

这应该做的是打开用户各自的 .mdb 文件。

首先，在任何地方都没有定义 javascript Run 函数。我在网上搜索，因为我认为它可能是一个旧的内置 javascript，但我找不到任何东西。

其次，有一个 vbscript Run() 函数，它实现了源代码中定义的所描述的行为，但据我所知，除了通过 ajax 之外，javascript 不能调用它，正如你所看到的那样正在发生。

奇怪的是这适用于某些用户！

如果有人能解释为什么我会感激它！

**编辑：**我正在处理的唯一浏览器是 IE。我知道有一种 active-x 方式来打开文件，这就是我上面提到的 vbscript Run() 函数正在使用的方式。

***更新：***所以经过更多的调查/研究，看起来当 IE 找不到 javascript Run() 函数时，它默认为 IS 定义的 vbscript Run() 函数。但是，这只发生在某些版本的 IE 上。任何人都可以确认这种行为吗？

研究链接：

> > [评论指的是 IE 如何默认使用脚本](https://stackoverflow.com/questions/1039341/calling-vbscript-from-javascript "提到 IE 中的默认设置的评论")
> > 
> > [有关在同一页面中使用两种脚本类型的 Msdn 文章](http://msdn.microsoft.com/en-us/library/aa260861%28v=vs.60%29.aspx#vbnjscrpt_working)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T10:44:00.187

是的，您可以从 javascript 运行 vbscript，反之亦然，有时当一种语言不支持另一种语言时，我会这样做。您可以在脚本中指明默认语言，以防您没有像 .

您也可以在调用函数时指定它，例如 vbscript:functionname("..") 或 javascript:functionname("..")

正如您所注意到的，在某些情况下，浏览器会因为使用错误的语言搜索/执行函数而感到困惑并且找不到函数。我想这种行为也会受到版本的影响，但肯定会受到脚本中逻辑流动的顺序的影响，如果浏览器首先执行 javascript，他倾向于在这种语言中走得更远，以防有疑问。所以要避开这个

1.  除非真的有必要，否则不要将两者混合，用 javascript 翻译你的 vbscript 函数）
2.  尝试始终使用 javascript，vbscript 不太擅长处理 DOM 等
3.  如果它们混合在一起，请在调用函数时指定正确的脚本语言
4.  打开脚本标签时，还要给出正确的语言，例如或

因此，具体来说，要解决您的问题，请将 vbsripts 函数转换为 javascript，如果不可能，请调用您的函数`onClick="vbscript:Run('**SomeFilePath.mdb**')"`

# c# - 位移c#这里发生了什么？

> ID：11478248
> 
> 赞同：2
> 
> 时间：2012-07-13T20:56:20.177
> 
> 标签：c#, endianness

所以我很好奇，这里到底发生了什么？

```
static void SetUInt16 (byte [] bytes, int offset, ushort val)
{
    bytes [offset] = (byte) ((val & 0x0ff00) >> 8);
    bytes [offset + 1] = (byte) (val & 0x0ff);
} 
```

基本上，这段代码中的想法是将一个 16 位 int 设置为特定位置的字节缓冲区，但问题是我正在尝试使用它来模拟它

```
using(var ms = new MemoryStream())
using(var w = new BinaryWriter(ms))
{
    w.Write((ushort)1);
} 
```

我期待阅读`1`，但我得到了`256`. 这是字节顺序问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T20:59:50.190

该代码以大端顺序写入一个 16 位整数。首先写入高字节。与 BinaryWriter 所做的不同，它以 little-endian 顺序写入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T20:59:57.260

当你解码数据时，你期望 1 时得到 256 吗？[BinaryWriter.Write](http://msdn.microsoft.com/en-us/library/8sh9zw1e.aspx)使用小端编码，您的 SetUInt16 方法使用大端编码。

# php - 调用未定义方法时不调用关闭回调

> ID：11478249
> 
> 赞同：3
> 
> 时间：2012-07-13T20:56:38.360
> 
> 标签：php

考虑以下两个 PHP (5.4) 脚本。为什么只在执行脚本 A 时调用回调`register_shutdown_function`，而不是在执行脚本 B 时调用？

**脚本 A**

```
set_error_handler(function() {
    throw new Exception();
});
register_shutdown_function(function() {
    echo "shutdown handler invoked\n";
});

undefined();
// "shutdown handler invoked" IS displayed 
```

**脚本 B**

```
set_error_handler(function() {
    throw new Exception();
});
register_shutdown_function(function() {
    echo "shutdown handler invoked\n";
});

$undefined->undefined();
// "shutdown handler invoked" IS NOT displayed 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T03:00:19.927

这是一个错误——如果注册的可调用对象[`set_error_handler`](http://php.net/set-error-handler)抛出异常，将不会调用关闭函数。

在这种特殊情况下，会发生以下事件链：

1.  触发非致命错误（未定义变量：未定义）
2.  调用用户错误处理程序
3.  抛出异常
4.  触发致命错误（在非对象上调用成员函数 undefined()）
5.  由于存在异常，未调用关闭函数

[https://bugs.php.net/61767](https://bugs.php.net/61767)（带有补丁！）和[https://bugs.php.net/60909](https://bugs.php.net/60909)的现有错误报告有更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T09:09:03.483

这是我发现的。

register_shutdown_function 在退出时被调用。

$未定义->未定义（）；触发 E_NOTICE 错误，因为 $undefined 未定义为通过 set_error_handler 的变量。如果你调用 throw new Exception，php 出于某种原因在退出时不会触发 register_shutdown_function 处理程序只是崩溃，如果你想抛出异常，也许你可以直接调用你的异常函数。

如果你创建了一个虚拟类并定义了 $undefined，但没有创建一个名为 undefined 的成员函数，它的行为方式与调用 undefined() 的方式相同，如下所示

不明确的（）; 触发 E_ERROR 立即退出触发 shutdown_function 处理程序

除了使用错误处理程序来捕获不同类型的错误之外，您还可以在关闭函数中执行此操作：

```
function shutdown_function_handler(){
    if ($error = error_get_last()){
        switch ($error['type']){
            case E_ERROR:
            case E_USER_ERROR:
            case E_CORE_ERROR:
            case E_COMPILE_ERROR:
                echo " ERRROR:".$error['message'];
        }
    }
} 
```

# .net - 通过 ODBC 从 C# 读取 Netezza 数据库表在 Windows 7 中不起作用

> ID：11478252
> 
> 赞同：1
> 
> 时间：2012-07-13T20:56:51.013
> 
> 标签：.net, registry, odbc, 64-bit, netezza

为什么 .NET 不能通过已安装的 {NetezzaSQL} 驱动程序连接到我的 Netezza 机器？64 位应用程序也无法通过此 ODBC 连接进行连接。为什么会这样？我已经在控制面板中建立了用户和系统 Netezza ODBC 连接，当我单击“测试连接”时两者都可以正常工作？我在注册表中看到了值，但是当我遍历注册表驱动程序时，.NET 看不到“NetezzaSQL”。根据 Netezza 的说法，他们没有 64 位 ODBC 驱动程序。他们提供的驱动程序应该适用于 32 位和 64 位应用程序。这可能是 Windows 7 的权限问题吗？

```
static void CreateNetezzaTableObjectFolders()
{
    //string activeDir = @"C:\Source\EDW\dw-objects\trunk";

    OdbcConnection conn = new OdbcConnection();
    conn.ConnectionString = "Driver={NetezzaSQL};servername=10.1.170.18;port=5480;database=DEV_SANDBOX; username=mac;password=secret;";

    OdbcDataReader rdr = null;

    try
    {
        conn.Open();
        System.Data.Odbc.OdbcCommand cmd = new System.Data.Odbc.OdbcCommand("SELECT OBJECT_NAME FROM QA_ETL..STG_OBJECTS", conn);
        rdr = cmd.ExecuteReader();
        while (rdr.Read())
        {
            Console.WriteLine(rdr[0]);
            // Create Folder
            //string objectName = rdr[0].ToString();
            //string newPath = System.IO.Path.Combine(activeDir, objectName);
            //System.IO.Directory.CreateDirectory(newPath);
        }
    }
    finally
    {
        // close the reader
        if (rdr != null)
        {
            rdr.Close();
        }

        // close the connection
        if (conn != null)
        {
            conn.Close();
        }
    }
} 
```

**在新选项卡中打开以查看 ODBC 的注册表设置并放大：**

![在此处输入图像描述](../Images/7cc4fcd41a53fc90a1ad51a1639cc729.png)

==============================

# 2012 年 7 月 13 日下午 4:56 更新：

显然，驱动程序名称位于大括号内。当我以编程方式获取驱动程序列表时，我看不到驱动程序。如何在 Windows 用户界面中添加到此列表？但是，我确实在控制面板 > 管理工具 > ODBC 驱动程序下查看已安装的 Netezza 驱动程序。

这是一些验证我正在解释的代码：

```
public static void GetSystemDriverList()
{
    //List<string> names = new List<string>();
    // get system dsn's
    Microsoft.Win32.RegistryKey reg = (Microsoft.Win32.Registry.LocalMachine).OpenSubKey("Software");
    if (reg != null)
    {
        reg = reg.OpenSubKey("ODBC");
        if (reg != null)
        {
            reg = reg.OpenSubKey("ODBCINST.INI");
            if (reg != null)
            {

                reg = reg.OpenSubKey("ODBC Drivers");
                if (reg != null)
                {
                    // Get all DSN entries defined in DSN_LOC_IN_REGISTRY.
                    foreach (string sName in reg.GetValueNames())
                    {
                        Console.WriteLine(sName);
                        //names.Add(sName);
                    }
                }
                try
                {
                    reg.Close();
                }
                catch { /* ignore this exception if we couldn't close */ }
            }
        }
    }

    Console.ReadLine();
} 
```

![在此处输入图像描述](../Images/2d02b41a3bc81e23c96b3069f520bbe4.png)

这是我在使用用户 ODBC 连接时从 Windows 7 框中的 Microsoft Access 2007 得到的连接错误。系统一不可见。

错误：“ODBC--调用失败。[Microsoft][ODBC Driver Manager] 指定的 DSN 包含驱动程序和应用程序之间的体系结构不匹配 (#0)”

![在此处输入图像描述](../Images/94b85e283960c8b839d51d51826feae3.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:54:56.753

Microsoft 从未重命名过他们的“system32”文件夹，因此 system32 确实拥有所有 64 位驱动程序。SysWow64 文件夹包含所有 32 位驱动程序。默认情况下，在 Visual Studio 2010 中创建的 .NET 项目将具有 x86 的“目标平台”。我刚刚将其更改为 x64，我的连接使我的 64 位 NetezzaSQL 驱动程序适用于 .NET。

只要意识到您可以通过运行 C:\Windows\system32\ 文件夹中的“odbcad32.exe”文件来启动控制面板 > 管理工具下的 ODBC（数据源）对话框（这是对话框的 64 位版本）构建 64 位驱动程序），或在 C:\Windows\SysWow64\ 文件夹中（这是用于构建 32 位驱动程序的对话框的 32 位/x86 版本）。是的，这些文件夹被颠倒了，因为微软的这种方式很奇怪。

此外，注册表中有两个不同的文件夹可以构建。原来上面的列表（在我的黑色屏幕截图中）来自 Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ODBC\ 列表，因为这些是 32 位驱动程序。我安装的 dll，“nzodbcsetup.exe”，显然是作为 64 位驱动程序安装的。我不确定如何在 64 位 Windows 上将其作为 32 位驱动程序安装，因此我将 .NET 项目中的“目标平台”从默认的 x86 更改为 x64。必须有一种方法将其安装为 32 位驱动程序，因为当我在 32 位 Windows XP 机器上安装它时，驱动程序运行良好。

奇怪的是，Netezza 的 OLE 驱动程序是分开的。它们有一个 32 位和一个 64 位 dll exe 文件（适用于版本 6.0.3）。“nzoledbsetup.exe”（~82MB x86）和“nzoledbsetup64.exe”（~102MB x64）。但是 ODBC 只有一个，显然两者兼而有之。我尝试在 SysWOW6432Node 中手动构建一个 32 位驱动程序（在运行 > regedit 下）并指向驱动程序文件和设置文件（在 system32 文件夹中，但我收到了一个错误。请评论 Windows 中是否有一种方法可以自动安装为32位，不是64位。

# http - Spring Integration HTTP入站适配器方法名称？

> ID：11478260
> 
> 赞同：0
> 
> 时间：2012-07-13T20:57:25.420
> 
> 标签：http, spring-integration

是否可以将方法名称映射到带有 int-http:inbound-gateway 的标头？例如：

```
<int-http:inbound-gateway request-channel="requests" reply-channel="replies"
    supported-moethds="GET,PUT"
    path="/user">
    <int-http:header name="requestMethod" expression="#requestMethod"/>
</int-http:inbound-gateway>

<!-- ... -->

<int:header-value-router input-channel="requests" header-name="requestMethod>
    <int:mapping value="GET" channel="getUserRequests"/>
    <int:mapping value="PUT" channel="addUserRequests"/>
</int:header-value-router> 
```

此外，我看到了使用 #requestParams 的示例，但 2.1 的 javadoc 提到了 #queryParameters，我在官方文档页面中没有看到其中任何一个的文档。你们知道一个很好的资源，它不仅描述了 SpEL 如何解析表达式，还描述了哪些字段可用于它？我只能说我有标题、有效负载、#pathVariables，也许还有#requestParams 或#queryParams，以及我在当前上下文中定义的任何其他@beans。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:34:41.327

该方法始终映射到标头

```
... http_requestMethod=POST ...

Message<?> message = messageBuilder
    .setHeader(org.springframework.integration.http.HttpHeaders.REQUEST_URL, request.getURI().toString())
    .setHeader(org.springframework.integration.http.HttpHeaders.REQUEST_METHOD, request.getMethod().toString())
    .setHeader(org.springframework.integration.http.HttpHeaders.USER_PRINCIPAL, servletRequest.getUserPrincipal())
    .build(); 
```

javadoc 是错误的。两个附加变量是#requestParams 和#pathVariables。

# html - 在 IE7 中的单行上正确对齐两个 div

> ID：11478264
> 
> 赞同：1
> 
> 时间：2012-07-13T20:57:48.780
> 
> 标签：html, css, internet-explorer-7

我正在尝试在 html 中复制类似于 windows 窗体工具栏的内容。我已经创建了一个我目前正在使用的示例。看起来不错，但是当我将它加载到 IE7 中时，按钮最终会转到下一行。

我能想到的唯一另一种方法是使用具有两列的表格并在第二列中对齐文本。有人有什么建议吗？

[http://jsfiddle.net/nyEw7/](http://jsfiddle.net/nyEw7/)

好像这个问题已经被问过了。我正在寻找 IE7 的解决方法。

[在单行填充空间中显示两个 div - CSS](https://stackoverflow.com/questions/10191228/display-two-divs-in-a-single-line-filling-space-css)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:00:18.517

使用浮动：左/右。这是一个更新的jsfiddle：

[http://jsfiddle.net/nyEw7/1/](http://jsfiddle.net/nyEw7/1/)

# c# - 无法让 Jquery DateTimePicker 在 mvc4 中显示

> ID：11478266
> 
> 赞同：1
> 
> 时间：2012-07-13T20:57:58.687
> 
> 标签：c#, jquery, asp.net-mvc, datetimepicker

这是我的脚本

```
<script type="text/javascript">
$(document).ready(function () {
   // alert("jquery working fine, still no display..");
    $(".datepicker").datetimepicker({
        showAnim: 'slideDown',
        dateFormat: 'dd/mm/yyyy'
    });
});
</script>

 <input type="text" class="datepicker" /> 
```

实际的 Datepicker 效果很好，firebug 显示了这个脚本、jqueryUI、timepicker-addon.js、slider.js 和 datepicker.js，jquery 正在选择文本框。

但唉，仍然没有显示日期时间选择器

我尝试过使用 id's/classes，重新排列脚本的加载顺序。我会说插件只是铺位，但很多人似乎对它没有任何问题。有谁知道我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T09:31:15.833

以下代码对我来说非常好：

```
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <input type="text" class="datepicker" />

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/jquery-ui.min.js"></script>
    <script type="text/javascript" src="http://trentrichardson.com/examples/timepicker/jquery-ui-timepicker-addon.js"></script>
    <script type="text/javascript">
        $('.datepicker').datetimepicker({
            showAnim: 'slideDown',
            dateFormat: 'dd/mm/yy'        
        });
    </script>
</body>
</html> 
```

[在此现场演示](http://jsfiddle.net/DfqCH/)中可以看到以下结果：

![在此处输入图像描述](../Images/ca543ae23194898b3d3590b044ebcd13.png)

所以我想您的脚本包含内容以及它们的顺序一定有问题。不幸的是，由于您没有显示您的代码，因此很难说更多。

# haskell - 不知道从哪里开始使用可变向量

> ID：11478268
> 
> 赞同：8
> 
> 时间：2012-07-13T20:58:07.610
> 
> 标签：haskell

我试图在 Haskell 中使用 Data.Vector.* 包做这样的事情，我真的不知道从哪里开始。我是 Haskell 的新手，对某些核心概念了解甚少（但我已经到了那里）。

我正在尝试做的事情可以用以下C代码大致表达：

```
float *arrA = /* initialized to array of length n */;
float *arrB = /* initialized to array of length n */;
for (i = 1; i < n; i++) {
  for (j = 0; j < n - i; j++) {
    arrB[j] = someFn(i, j, arrA[j], arrB[j+1])
  }
  float *p = arrA;
  arrA = arrB;
  arrB = p;
}
return arrA[0]; 
```

注意事项：

*   出于性能原因重用数组，但我需要其中两个以避免践踏下一次迭代所需的值
*   数组被交换
*   内循环的上限随着外循环的每次迭代而变化

您可能提供的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-14T03:20:33.447

**这是一个愚蠢的任务**

将 C 直接翻译成 Haskell 是相当愚蠢的。我以前做过付费，但进展并不顺利或迅速。最好用目标语言以惯用的方式描述任务并实现它。通过提供算法的英文描述，您更有可能获得高质量的答案。

**请发布可编译代码**

当您发布问题时，请确保它可以编译！

**学习 Haskell 而不是如何在 Haskell 中编写 C**

不同语言的处理方式可能会有很大差异，尤其是当您跨越诸如从命令式到函数式，或从可变到不可变，或从严格到惰性，或隐式转换为显式或手动管理的内存到垃圾收集的鸿沟时。你正在跨越所有这些鸿沟。

如果您的任务是学习 Haskell，那么您的起点就错了。如果您的任务是在 Haskell 中学习可变向量/数组，那么您需要了解更多的基础知识以了解其中的细微差别。如果你的任务是嘲笑 Haskell 对数组的支持很差，那么在 Roman 出现并制作 Vector 包之前，你会很轻松地度过它——这就是我的说法：不要只看 Haskell`Array`的外观在`Vector`s。

**好的好的，有什么解决办法？**

我们将把`Vector`包用于我们的数组，将`ST`monad 用于可变操作（你的第一个要点）：

```
import qualified Data.Vector.Unboxed.Mutable as M
import qualified Data.Vector.Unboxed as V
import Control.Monad.ST
import Control.Monad 
```

您的 main 函数接受两个向量并返回一个浮点数。我们首先使用获取对数组的可变引用，`thaw`并使用简单的折叠来允许我们翻转数组引用。

```
someFunc :: V.Vector Float -> V.Vector Float -> Float
someFunc arrA arrB = runST $ do
        -- Obtain mutable copies of the arrays
        mA <- V.thaw arrA 
        mB <- V.thaw arrB
        (mA', mB') <- foldM op (mA, mB) [1..n-1] -- for(i = 1 ; i < n; i++)
        M.read mA' 0
 where
 n = min (V.length arrA) (V.length arrB) 
```

内部 for 循环包含在`op`. 它只是从数组中执行一些简单的读取并写入一个新值。它必须在一个元组中返回两个数组；每次迭代都会翻转元组以获得可变指针的相同语义（您的第二点）：

```
 op (mA, mB) i = do
        forM_ [0..n-i-1] $ \j -> do
                v1 <- M.read mA j
                v2 <- M.read mB (j+1)
                M.write mB j (someFn i j v1 v2)
        return (mB, mA) 
```

与您的第三点一致，内循环边界会根据外循环而变化。

这样我们就可以编译一个可运行的程序，我们将包括 main：

```
someFn i j f1 f2 = f1 + fromIntegral i + fromIntegral j - f2

main = print $ someFunc (V.fromList [1..10]) (V.fromList [0..9]) 
```

这仅用于教育目的。我没有对此进行测试，它在道德上应该与您的 C 相同，但可能会在循环中偏离一个或有其他微不足道的差异。

# macros - Common Lisp：定义 setf 扩展器时最小化代码重复的方法

> ID：11478273
> 
> 赞同：0
> 
> 时间：2012-07-13T20:58:44.443
> 
> 标签：macros, common-lisp

从这个关于 setf 扩展器的问题触发：[在 Common Lisp 中定义 setf-expanders](https://stackoverflow.com/questions/11457071/defining-setf-expanders-in-common-lisp)

在为用户定义的 getter 编写 setf 扩展器时，我通常发现 getter 和 setter 中存在代码重复，就如何检索属性而言。例如：

```
CL-USER>
(defun new-car (lst)
  (car lst))
NEW-CAR
CL-USER> 
(defun (setf new-car) (new-value lst)
  (setf (car lst) new-value))
(SETF NEW-CAR)
CL-USER> 
(defparameter *lst* (list 5 4 3))
*LST*
CL-USER> 
*lst*
(5 4 3)
CL-USER> 
(setf (new-car *lst*) 3)
3
CL-USER> 
*lst*
(3 4 3)
CL-USER> 
```

请注意 (car lst) 表单，即已经定义了 setf 扩展器的实际访问器，是如何在两个 defun 中的。这一直让我有些恼火。能够在第一个 defun 上说，'嘿，我正在定义一个作为 getter 的 defun，但我也希望它有一个典型的 setf 扩展器'，这将是很好的。

通用 lisp 标准有什么方法可以表达这一点吗？有没有其他人担心这个问题，并定义了一个宏来做到这一点？

需要明确的是，我在这里想要的是一种定义 getter 和典型 setter 的方法，其中 getter 编译为已经具有 setter 的常见 lisp 形式（例如，（car lst））只在编码。

我也明白有时你不想这样做，b/c setter 需要在设置值之前执行一些副作用。或者它是一个实际上设置多个值的抽象，或者其他什么。这个问题在那种情况下不太相关。我在这里谈论的是 setter 做标准的事情，只是设置 getter 的地方的情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T05:41:51.620

使用宏可以实现您想要的。

```
(defmacro define-place (name lambda-list sexp)
  (let ((value-var (gensym)))
    `(progn
       (defun ,name ,lambda-list
         ,sexp)

       (defun (setf ,name) (,value-var ,@lambda-list)
         (setf ,sexp ,value-var)))))

(define-place new-chr (list)
  (car list)) 
```

更多关于宏的信息可以在 Peter Seibel 的书[Practical Common Lisp](http://www.gigamonkeys.com/book/macros-defining-your-own.html)中找到。Paul Graham 的“ANSI Common Lisp”一书的第 10 章是另一个参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-01-10T22:27:06.097

> *请注意 (car lst) 表单，即已经定义了 setf 扩展器的实际访问器，是如何在两个 defun 中的。*

但这只是在宏观扩张之前显然是正确的。在您的设置器中，`(car lst)`表单是分配的目标。它将扩展为其他内容，例如对类似于以下内容的某些内部函数的调用`rplaca`：

您可以手动执行类似的操作：

```
(defun new-car (lst)
  (car lst))

(defun (setf new-car) (new-value lst)
  (rplaca lst new-value)
  new-value) 
```

瞧；您不再有重复调用`car`；getter 调用`car`和 setter调用`rplaca`。

请注意，我们必须手动返回`new-value`，因为`rplaca`返回`lst`。

你会发现在许多 Lisps 中，内置的`setf`扩展器 for`car`使用了一个替代函数（可能是命名`sys:rplaca`的，或者随之而来的变体），它返回分配的值。

在 Common Lisp 中定义新类型的地方时，我们通常最小化代码重复的方法是使用[`define-setf-expander`](http://www.lispworks.com/documentation/HyperSpec/Body/m_defi_3.htm).

使用这个宏，我们将一个新的地点符号与两个项目相关联：

*   一个宏 lambda 列表，它定义了该地点的语法。
*   一段代码，计算并返回[五条](http://www.lispworks.com/documentation/HyperSpec/Body/05_aab.htm)信息，作为五个返回值。这些统称为“`setf`膨胀”。

位置变异宏像`setf`使用宏 lambda 列表来解构位置语法并调用计算这五个部分的代码体。然后使用这五个部分来生成位置访问/更新代码。

不过请注意，`setf`扩展的最后两项是*store form*和*access form*。我们无法摆脱这种二元性。如果我们`setf`为类似地方定义扩展`car`，我们的访问表单将调用`car`并且存储表单将基于`rplaca`，确保返回新值，就像在上面的两个函数中一样。

但是，可能存在可以在访问和存储之间共享重要内部计算的地方。

假设我们定义`my-cadar`而不是`my-car`：

```
(defun new-cadar (lst)
  (cadar lst))

(defun (setf new-cadar) (new-value lst)
  (rplaca (cdar lst) new-value)
  new-value) 
```

请注意，如果我们这样做 (incf (my-cadar place))，则会浪费重复遍历列表结构，因为`cadar`调用它以获取旧值，然后`cdar`再次调用以计算存储新值的单元格。

通过使用更难和更低级别的`define-setf-expander`接口，我们可以拥有它，以便`cdar`在访问表单和存储表单之间共享计算。也就是说，`(incf (my-cadar x))`将计算`(cadr x)`一次并将其存储到临时变量`#:c`中。然后更新将通过访问`(car #:c)`、添加 1 并将其存储在 中来进行`(rplaca #:c ...)`。

这看起来像：

```
(define-setf-expander my-cadar (cell)
  (let ((cell-temp (gensym))
        (new-val-temp (gensym)))
    (values (list cell-temp)       ;; these syms
            (list `(cdar ,cell))   ;; get bound to these forms
            (list new-val-temp)    ;; these vars receive the values of access form
            ;; this form stores the new value(s) into the place:
            `(progn (rplaca ,cell-temp ,new-val-temp) ,new-val-temp)
            ;; this form retrieves the current value(s):
            `(car ,cell-temp)))) 
```

测试：

```
[1]> (macroexpand '(incf (my-cadar x)))
(LET* ((#:G3318 (CDAR X)) (#:G3319 (+ (CAR #:G3318) 1)))
 (PROGN (RPLACA #:G3318 #:G3319) #:G3319)) ;
T 
```

`#:G3318`来自`cell-temp`，并且`#:G3319`是`new-val-temp`gensym。

但是，请注意，上面只定义了`setf`扩展。有了以上，我们**只能**`my-cadar`作为一个地方使用。如果我们尝试将它作为函数调用，它就会丢失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T07:05:45.447

根据 Mark 的方法、Rainer 关于[macro-function](https://stackoverflow.com/questions/7072980/how-do-you-compile-macros-in-a-lisp-compiler)的帖子和 Amalloy 关于[transparent macrolet](https://stackoverflow.com/questions/7240947/is-a-transparent-macrolet-possible)的帖子，我想出了这个：

```
(defmacro with-setters (&body body)
  `(macrolet ((defun-mod (name args &body body)
                `(,@(funcall (macro-function 'defun)
                             `(defun ,name ,args ,@body) nil))))
     (macrolet ((defun (name args &body body)
                  `(progn
                     (defun-mod ,name ,args ,@body)
                     (defun-mod (setf ,name) (new-val ,@args)
                                (setf ,@body new-val)))))
       (progn
         ,@body)))) 
```

要使用：

```
Clozure Common Lisp Version 1.8-r15286M  (DarwinX8664)  Port: 4005  Pid: 41757
; SWANK 2012-03-06
CL-USER>
(with-setters
 (defun new-car (lst)
    (car lst))
 (defun new-first (lst)
    (first lst)))
(SETF NEW-FIRST)
CL-USER>
(defparameter *t* (list 5 4 3))
*T*
CL-USER>
(new-car *t*)
5
CL-USER>
(new-first *t*)
5
CL-USER>
(setf (new-first *t*) 3)
3
CL-USER>
(new-first *t*)
3
CL-USER>
*t*
(3 4 3)
CL-USER>
(setf (new-car *t*) 9)
9
CL-USER>
*t*
(9 4 3) 
```

在生产代码中使用这个宏之前，这里可能应该注意一些变量捕获问题。

# objective-c - CoreData 持久存储出错

> ID：11478283
> 
> 赞同：-1
> 
> 时间：2012-07-13T20:59:10.183
> 
> 标签：objective-c, core-data, nsmanagedobjectcontext, nspersistentstore

我正在使用基于 CoreData 的应用程序，并且有一个 AppDelegate 类，该类本质上是在启动应用程序时编写的。

单击按钮后，我将 ArrayController(Section1) 传递给子类并对其进行解析以存储 TableView Cell 值。

```
- (IBAction)saveSect1:(NSButton *)sender {

DataMiner *data = [[DataMiner alloc] init];
[data parseArrayController:Section1 tag:0];

}

-(void)parseArrayController:(NSArrayController *)myController tag:(NSInteger)arrayTag {

switch (arrayTag) {
    case 0:

        context = appDelegate().self.managedObjectContext;

        for (NSMutableDictionary *mydict in myController.arrangedObjects) {

            NSNumberFormatter *format = [[NSNumberFormatter alloc] init];
            NSNumber *code = [format numberFromString:[mydict objectForKey:@"diagCode"]];
            [format release];

            Section_1 *section = nil;

            section = [NSEntityDescription insertNewObjectForEntityForName:@"Section_1"   inManagedObjectContext:context];

            section.diagCode = code;
            section.diagDescr = [mydict objectForKey:@"diagDescr"];                            
            section.sectId = [NSNumber numberWithDouble:1];
            section.subSectId = [NSNumber numberWithDouble:1.1];

        }

        NSLog(@"%@", context.registeredObjects);

        [Section_1 release];

        break;

    default:
        break;
} 
```

最初它运行良好，但是，现在我收到此错误：

**用于打开持久存储的托管对象模型版本与用于创建持久存储的版本不兼容。**

有没有人遇到过这个错误？有什么建议么？谢谢。

```
- (NSManagedObjectModel *)managedObjectModel
{
if (__managedObjectModel) {
    return __managedObjectModel;
}

NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"CoreData_test"        withExtension:@"momd"];
__managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];
return __managedObjectModel;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:03:52.813

您的表模型已更改。您可以删除旧数据库（从设备/模拟器中删除已安装的应用程序）。更改代码中的路径或进行数据库迁移。

通常在开发中我只是删除旧的安装。（在模拟器中重置内容和设置）如果您需要保留填充的数据，那么您将需要执行迁移。

每当您更改表时，您都需要这样做。

# asp-classic - 我的插入存储过程有效，但我收到此错误 ADODB.Recordset error '800a0e78'

> ID：11478284
> 
> 赞同：0
> 
> 时间：2012-07-13T20:59:17.290
> 
> 标签：asp-classic, ado

该站点在帮助解决许多未知问题方面非常有用。谢谢你。现在我有一个未知数，我无法找到答案。

错误是：

> ADODB.Recordset 错误“800a0e78”
> 
> 对象关闭时不允许操作。

我在用着：

*   ASP 经典
*   微软 SQL 服务器 2000

在 ASP 中有`<textarea>`一个“表单”来插入注释，当插入注释并按下提交按钮时，存储过程将注释插入注释表 datetimestamp 并添加登录用户。这正是它要做的事情。此外，在 ASP 中，还有一个`<table>`用注释、日期时间戳和登录用户填充其他先前条目。这也正是在做它应该做的事情。

上面提到的错误发生在按下提交按钮时，当错误页面出现时点击浏览器的返回按钮，然后刷新页面`<textarea>`被清除并注意，日期时间和登录用户显示在`<table>`

ASP 经典页面：

```
Dim rsAccountNote

<form name="Accountnote" method="post" action="/admin/xt_Accountnote.asp">

    <td>
    <b>Add Note:</b><br />
    <textarea type="text" name="notes" value="" rows="7" cols="43" style="resize: none;"></textarea><br />
    <input type="submit" value="Add new note"/>
</td>

<table>

<tr>    

    <td>
    <b>Read Notes:</b>
    </td>

</tr>

        <%

        set rsAccountNote = DBConn.Execute("SELECT AccountNotes, LogonUser_Id, dtAccountNotedatetime FROM AccountNotes WHERE AccountId = " & rsAccount("AccountId"))

        rsAccountNote.Sort="dtAccountNotedatetime DESC" 

        Do While Not rsAccountNote.EOF

        %>          

<tr>

    <td>
    Added &nbsp;<%=rsAccountNote("dtAccountNotedatetime")%> &nbsp;by &nbsp;<%=rsAccountNote("LogonUser_Id")%>
    </td>

</tr>

<tr>

    <td>
    <b>Note:&nbsp;</b> <%=rsAccountNote("AccountNotes")%>
    </td>

    </tr>

        <%

        rsAccountNote.MoveNext  

        Loop    

        Set rsAccountNote = Nothing

        %>

</tr>

    </td>
</tr>
</table>
</form> 
```

* * *

ASP 经典 xt_page：

```
<%

Dim rsAccount
Dim iAccount
Dim LogonUser_id
Dim AccountNotes

sSQL = "exec spApp_UpdateAccountNotes " & _
    "@iAccount = " & Trim(Request("Account_id")) & ", " & _
    "@AccountNotes = " & prepString(Request("AccountNotes")) & ", " & _
    "@LogonUser_id = " & prepString(Request("Logon_User"))
Call resultQuery(DBConn, rsAccount, sSQL, "", true)

    Response.Redirect("/Account_admin/accountinfo.asp?account_id=" & Trim(Request("account_id")))

%> 
```

* * *

存储过程：

```
CREATE PROCEDURE spApp_UpdateAccountNotes
    (
    @iAccount int,
    @LogonUser_id varchar (50),
    @AccountNotes varchar(5000)
    )
AS

    SET NOCOUNT ON

    insert AccountNotes
        (
        AccountId,
        LogonUser_Id,
        AccountNotes
        )
    values
        (
        @iAccount,
        @LogonUser_Id,
        @AccountNotes
        )
GO 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T20:37:59.177

尝试使用 Command 对象将 SP 作为参数化查询执行。这解决了您的代码容易受到 SQL 注入攻击的更严重的问题。

事实上，您的第一页也容易受到攻击，您也应该在那里使用命令对象。

可能您问题的真正根源是`resultQuery`尝试从 SP 生成记录集并对其执行某些操作，该记录集不返回结果集，它只是一个插入。在这种情况下，也许`resultQuery`只是不适合打电话。一个 ADODB Command 对象`Execute`就足够了。

# mysql - SQL 条件连接挑战

> ID：11478287
> 
> 赞同：0
> 
> 时间：2012-07-13T20:59:27.220
> 
> 标签：mysql, sql, join, conditional

我在 mysql 数据库中有 2 个表存储和共享。我试图避免使用 IN 子句。请参阅下文了解更多详情

```
select id, user_id from stores where user_id =7;
+----+---------+
| id | user_id |
+----+---------+
| 36 |       7 |
| 37 |       7 |

select stores_id,share_id from shares where share_id=7;
+-----------+----------+
| stores_id | share_id |
+-----------+----------+
|        15 |        7 |
|        38 |        7 | 
```

现在我运行这个

```
SELECT stores.id
FROM   stores
WHERE  user_id = 7
UNION
(SELECT stores.id
 FROM   stores
 WHERE  id IN (SELECT stores_id
               FROM   shares
               WHERE  share_id = 7)); 
```

要获得以下结果：

```
+----+
| id |
+----+
| 36 |
| 37 |
| 15 |
| 38 |
+----+ 
```

**问题** 如何重写查询，以便不使用 **IN**关键字。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:03:32.060

您可以使用`EXISTS`：

```
WHERE EXISTS
       ( SELECT 1
           FROM shares
          WHERE share_id = 7
            AND stores_id = stores.id
       ) 
```

或`JOIN`：

```
JOIN shares
  ON shares.stores_id = stores.id
 AND shares.share_id = 7 
```

（请注意，`JOIN`可能会返回某些商店的多个副本，但因为`UNION`这`SELECT DISTINCT`实际上不会影响您的最终结果集。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:01:57.947

这可以帮助您：

```
select stores.id from stores where user_id = 7  
UNION  
select s1.id from stores s1 
       inner join shares s2 
       on s2.share_id = 7 
       and s1.id = s2.stores_id; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:06:50.503

如果你只需要身份证，这会很好......

```
SELECT stores.id
FROM   stores
WHERE  user_id = 7

UNION

SELECT stores_id as id
FROM   shares
WHERE  share_id = 7 
```

但是，如果您需要来自 stores 表中其他列的一些数据，则 INNER JOIN 或 EXISTS 将是您最好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T21:07:12.037

左连接应该完成您正在寻找的内容：

```
select distinct stores.id 
from stores 
left join shares on stores.id = shares.stores_id
where stores.user_id = 7 
or shares.share_id = 7 
```

# php - 如何将样式（css + html）与php隔离

> ID：11478290
> 
> 赞同：3
> 
> 时间：2012-07-13T20:59:39.787
> 
> 标签：css, html, php, 样式, php, html, css, include, styles

我如何将样式（[css](/questions/tagged/css "显示标记为“css”的问题") + [html](/questions/tagged/html "显示标记为“html”的问题")）与 [php](/questions/tagged/php "显示标记为“php”的问题")隔离开来，比如在 php 文件中只放入一些行，包括整个 [样式](/questions/tagged/style "显示标记为“风格”的问题")或主题。

前任：

```
echo 
    eval_template("header") .
    eval_template("body") .
    eval_template("footer") 
```

所以将来我可以在不接触 php 文件的情况下改变整个风格 **有什么想法吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:13:33.807

有很多方法可以做到这一点......

这是一个关于纯 PHP 模板的教程 [http://www.phpro.org/tutorials/Introduction-to-PHP-templating.html](http://www.phpro.org/tutorials/Introduction-to-PHP-templating.html)

您还可以查看那里的许多模板引擎。树枝就是其中之一：[http ://twig.sensiolabs.org/](http://twig.sensiolabs.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-03T17:58:26.710

你可以使用很多模板引擎来做到这一点，我更喜欢使用与 symfony2 框架集成的 twig。

Twig 很棒，因为它非常易于使用且非常灵活，您可以使用继承来创建一个通用布局，该布局可以使用特殊标签在某些部分进行扩展和覆盖。这是我在 Symfony 网站上找到的指南，但对于理解 twig 背后的逻辑非常有用：http: [//symfony.com/doc/current/book/templating.html](http://symfony.com/doc/current/book/templating.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:59:04.920

就个人而言，我喜欢手动完成。

PHP 不应该同时返回 css 和 html 代码，甚至更好的是，它根本不应该返回客户端代码，而是返回对特定部分的依赖关系。您永远不想修改包含许多不同内容的文件。

为了将 css+html 与 php 代码分开，我通常做的是使用 include("..."); 完成的层次结构；和 include_once("...")。例如：include_once("header.php") > include("menu.php") > html 语义，css 类根据当前上下文正确初始化。

然后你在 header.php 中导入你的 css / js 外部脚本，这样你就不必修改整个东西，除非一切都发生了变化，或者你有一个完整的功能要添加到网站上。网站的每个部分都可以这样做。

希望这会有所帮助，对我来说，它极大地减少了调试时间，因为所有重要的事情只需要完成一次，然后在它的顶部，您可以根据需要分开。

# python - Python：上传文件后抓取数据

> ID：11478296
> 
> 赞同：0
> 
> 时间：2012-07-13T20:59:48.923
> 
> 标签：python, post, file-upload, request, urllib

我正在尝试根据上传到文件的文件上传提取站点的响应。网站有以下形式。

```
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
  </head>
  <body>
     <form method="POST" action="http://somewebsite.com/imgdigest" enctype="multipart/form-data">
        quality:<input type="text" name="quality" value="2"><br>
        category:<input type="text" name="category" value="1"><br>
        debug:<input type="text" name="debug" value="1"><br>
        image:<input type="file" name="image"><br>
        <input type="submit" value="Submit">
     </form>
  </body>
</html> 
```

我想要做的是上传文件，提交表单并提取响应。

我首先看一个例子，我想我成功地完成了上传工作。因为当我运行它时，我没有收到任何错误。

```
import urllib2_file
import urllib2
import request
import lxml.html as lh

data = {'name': 'image',
        'file':  open('/user/mydir/21T03NAPE7L._AA75_.jpg')
       }
urllib2.urlopen('http://localhost/imgdigestertest.html', data) 
```

不幸的是，我没有在这里提出请求来获得回复。我不知道我应该如何做出回应。一旦我得到响应，我应该能够使用一些我很舒服的模式匹配来提取数据。

**根据提供的答案尝试了以下代码：**

```
import requests

url = 'http://somesite.com:61235/imgdigest'
files = {'file': ('21e1LOPiuyL._SL160_AA115_.jpg', 
                  open('/usr/local/21e1LOPiuyL._SL160_AA115_.jpg', 'rb'))}
other_fields = {"quality": "2",
                "category": "1",
                "debug": "0"
               }
headers={'content-type': 'text/html; charset=ISO-8859-1'}

response = requests.post(url, data=other_fields, files=files, headers=headers)

print response.text 
```

现在我收到以下错误：它告诉我一些图像文件没有正确附加。我们必须指定文件类型吗？

```
Image::Image(...): bufSize = 0\.  Can not load image data. Image size = 0\.   DigestServiceProvider.hpp::Handle(...) | 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:23:21.670

使用请求库（`pip install requests`如果您使用 pip）。

对于他们的示例，请参见此处： [http ://docs.python-requests.org/en/latest/user/quickstart/#post-a-multipart-encoded-file](http://docs.python-requests.org/en/latest/user/quickstart/#post-a-multipart-encoded-file)

要自定义它看起来像你的：

```
import requests
url = 'http://localhost:8080/test_meth'
files = {'file': ('21T03NAPE7L._AA75_.jpg', 
                  open('./text.data', 'rb'))}
other_fields = {"quality": "2",
                "category": "1",
                "debug": "1"
               }
response = requests.post(url, data=other_fields, files=files)
print response.text 
```

在我的本地系统上， text.data 包含以下内容：

```
Data in a test file. 
```

我用cherrypy（pip install cherrypy）写了一个server.py来测试我上面给出的客户端。这是 server.py 的源代码：

```
import cherrypy
class Hello(object):
    def test_meth(self, category, debug, quality, file):
        print "Form values:", category, debug, quality
        print "File name:", file.filename
        print "File data:", file.file.read()
        return "More stuff."
    test_meth.exposed = True
cherrypy.quickstart(Hello()) 
```

当我运行上面的 client.py 时，它会打印：

```
More stuff. 
```

正如您在 server.py 示例中看到的那样，返回的是什么。

同时，服务器说：

```
Form values: 1 1 2
File name: 21T03NAPE7L._AA75_.jpg
File data: Data in a test file.

127.0.0.1 - - [14/Jul/2012:00:00:35] "POST /test_meth HTTP/1.1" 200 11 "" "python-requests/0.13.3 CPython/2.7.3 Linux/3.2.0-26-generic" 
```

因此，您可以看到客户端正在发布代码中描述的文件名和指定本地文件的文件内容。

需要指出的一点是，在这篇文章的开头，我说过要使用 requests 库。不要与您在原始问题中导入的 urllib 请求混淆。

# database - 管理网页的查看次数

> ID：11478304
> 
> 赞同：1
> 
> 时间：2012-07-13T21:00:05.840
> 
> 标签：database

我正在创建一个显示单个新闻项目的 jsp 页面，就像此 StackOverflow 页面上的单个问题一样。我需要将视图计数存储在数据库中。

我可以通过这种方式简单地增加数据库中的视图计数：

```
`UPDATE table SET views=views+1 WHERE newsId=4458;` 
```

但是，如果一个用户一次又一次地点击该页面，比如说 50 次……在这种情况下，我的查看次数将不代表该网站的唯一访问者。我怎样才能避免这种情况？

我想要 StackOverflow 的视图计数系统之类的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:25:08.767

一个解决方案可能是你创建一个新表（让我们说它称为视图），每次有人访问你的网站时，你检查他的 ip 是否是已经在该新闻项目的表格中。

```
Select count(*) AS count FROM views WHERE newsid=1234 AND ipaddress=123.456.125 
```

如果 count 等于 0 你这样插入

```
INSERT INTO views('newsid', 'ipaddress') VALUES(1234, 123.146.125) 
```

现在，当您要获取观看次数时：

```
Select count(*) AS count FROM views WHERE newsid=1234 
```

您可以通过在表视图中添加另一个名为“count”和“lastviewed”（键入日期时间）的列来增强这一点。假设如果日期不匹配，您允许再次计算每个 ip。这样，您将获得非常准确的观看次数:)

要获取新的观看次数，您只需使用 SUM

```
Select SUM(count) AS count WHERE newsid=1234 
```

祝你好运 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-11T11:23:05.623

您可能想在[此处](https://stackoverflow.com/questions/22723828/storing-view-counts-in-database-table)参考 spencer7593 的答案，他基本上建议同时拥有 (1) 视图计数列，用于快速生成您的网页和 (2) 单独的视图表，该表记录与每个视图相关的用户 ID 和时间戳，用于为了分析。

我建议在确定是否应增加查看计数列时，也可以使用此查看表来查询是否在最后一天（或一周）内对具有特定内容的特定用户进行了查看。通过检查某个项目的视图是否仅在最后一天（或一周）发生，数据库查询应该会大大降低成本，同时仍然保护您的视图计数的完整性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:24:40.507

我说在 Javscript 中使用计数器。在正文 onclick 上增加变量。例如：

```
<script language=”javascript”&gt;
function pageCounter()
{
var counter = 0;
counter = counter++;

}
</script>

<body onclick = “pageCounter()”&gt; 
```

您可以使用 onclose 更新值。

# php - 来自 php 的 MySql 远程连接

> ID：11478305
> 
> 赞同：1
> 
> 时间：2012-07-13T21:00:07.123
> 
> 标签：php, mysql

我已经允许远程连接到 mysql。我可以从另一台机器的控制台成功连接。

我在另一台服务器上有一些 php 文件，但我无法从 php 连接到同一个 mysql 数据库。

这就是我这样做的方式：

```
mysql_pconnect("theipaddress","username","password")
               or die("Unable to connect to db server"); 
```

现在请记住，我使用的凭据与我在控制台中成功使用的凭据相同。我什至尝试将端口放在 ip 之后，但没有任何乐趣。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:09:54.257

您必须在 MySQL 中有一个允许从 %（任何主机）连接的用户（有关详细信息，请参阅手册）。

你安装了selinux吗？也许 selinux 不允许 apache 进行远程连接？如果是，请键入：

```
setsebool -P httpd_can_network_connect=1 
```

# c - 在我的 Mac 上制作 C 启动器

> ID：11478306
> 
> 赞同：-2
> 
> 时间：2012-07-13T21:00:08.207
> 
> 标签：c, macos, terminal

我想为我制作的 ac 程序制作一个启动器，并希望它在终端中运行。我该怎么做？我什至没有丝毫的想法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:04:15.170

只需创建一个文本文件，将其保存到桌面，例如`my_C_program.command`（注意`.command`后缀），然后在文本文件中您可以放置​​您喜欢的任何终端命令，例如

```
# run my_C_program
my_C_program arg1 arg2 
```

注意：保存`.command`文件后，您需要确保它是可执行的：

```
$ chmod +x ~/Desktop/my_C_program.command 
```

这将在桌面上为您提供一个可双击的图标，该图标通过命令行`my_C_program`运行。`my_C_program`（这假设`my_C_program`在您的某处`PATH`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:26:50.060

*   双击您的程序
*   你会要求一个程序来打开你的程序（听起来很奇怪，我知道）
*   搜索“终端”并选择它

就是这样！现在，当您双击它时，您的程序应该会打开。

# asp.net - 如何在asp Button的Text属性中有html

> ID：11478307
> 
> 赞同：28
> 
> 时间：2012-07-13T21:00:08.690
> 
> 标签：asp.net

我正在尝试`<i>`为 asp 按钮包含一个 for Text 属性，但它只是将 html 呈现为文本......

```
<asp:Button runat="server" ID="modify" ToolTip="Modify" CssClass="btn btn-mini" OnClick="modify_Onclick" Text='<i class="icon-edit"></i>' /> 
```

我得想太多了……

**编辑：** 我正在使用 twitter 引导框架。这就是`<i>`标签的原因。这是一个例子：http: [//twitter.github.com/bootstrap/base-css.html#icons](http://twitter.github.com/bootstrap/base-css.html#icons)

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-11T19:12:47.627

您可以使用`<asp:LinkButton`. Bootstrap 像输入类型提交按钮 (asp:Button) 一样呈现锚标记 (asp:LinkBut​​ton)。

```
<asp:LinkButton runat="server" ID="modify" ToolTip="Modify" CssClass="btn btn-mini" OnClick="modify_Onclick" Text='<i class="icon-edit"></i>' /> 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-07-14T17:00:54.910

我最终做的是使用一个 html 按钮，`runat=server`并将其`<i>`放入其中。

```
<button runat="server" id="modify" class="btn btn-mini" title="Modify" onserverclick="modify_Onclick">
    <i class="icon-edit"></i>
</button> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-06-27T07:54:44.967

你会这样做

```
 <button runat="server" id="btnRun" onserverclick="functionName" class="btn btn-mini" title="Search">
    <i class="icon-camera-retro"></i> Search
    </button> 
```

看看这个例子（但是，如果你使用的是 sitefinity CMS，这将不起作用） [asp 按钮内的字体真棒](https://stackoverflow.com/questions/15064005/font-awesome-inside-asp-button)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-11-12T09:44:24.510

您可以利用`<label>`标签的`for`属性。基本上任何点击`<label>`也会触发一个 id 与`<label>`'`for`属性相同的 html 元素的点击事件

例如：

```
<label for="modify"><i class="icon-edit"></i></label>
<asp:Button style="display:none;" runat="server" ID="modify" ToolTip="Modify" CssClass="btn btn-mini" OnClick="modify_Onclick" Text='' /> 
```

单击`<label>`此处的元素（也单击`<i>`元素），将触发`<asp:button>`'click 事件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-30T11:05:22.643

如果您将按钮更改为：

```
<asp:LinkButton /> 
```

它在 text 属性中工作得很好。我不相信在功能上会有任何损失。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-13T21:22:44.437

如果它呈现为 a `<input type="submit">`，则您无法将 HTML 显示为标签。它将呈现为文字字符串。

看这个例子：http: [//jsfiddle.net/vkNuX/](http://jsfiddle.net/vkNuX/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-13T21:30:56.003

您可能会做一些事情，在其中呈现一个包含“i”标签的 html 链接（如果您查看您提供的链接的来源，这就是他们所做的），然后使用 ClientScriptManager 在单击时将其回发。 GetPostBackEventReference() 以获取对回发脚本的引用。 [http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.getpostbackeventreference.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.getpostbackeventreference.aspx)

例如：

```
<a class="btn btn-mini" href="javascript:<% ClientScriptManager.GetPostBackEventReference()%>"><i class="icon-refresh"></i> Refresh</a> 
```

这只是我的想法，所以你可能需要稍微调整一下。然后，您可以将其滚动到您自己的自定义 asp.net 控件中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-06T14:40:39.543

我试图在客户端的一个按钮内呈现 html，我不希望它被使用`runat="server"`，所以我所做的是使用 javascript：

```
document.getElementById('button_<%= this.id %>').innerHtml = '<i class="fa fa-edit"></i>'; 
```

# php - PHP/Javascript：使用 cookie 记住表单/表单字段的状态

> ID：11478311
> 
> 赞同：1
> 
> 时间：2012-07-13T21:00:21.067
> 
> 标签：php, javascript, html, forms, cookies

在[这个](https://stackoverflow.com/questions/11474563/javascripthow-to-dynamically-add-text-inputs-form-fields-to-a-html-form)问题中，我发现了如何动态添加表单字段。

现在，如何设置 cookie 来记住生成的表单字段的数量及其内容？

例如。第一次访问，用户输入：

```
Input one
Input two
Input three 
```

然后他/她再次访问该页面。有 3 个表单域，包含输入 1、输入 2 和输入 3。

这可能使用服务器/客户端解决方案吗？

非常感谢，

哈雷

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:17:24.110

假设输入文本字段类是“textfield1” -

此代码段将在修改值时将数据捕获到 cookie 中

```
 $(".textfield1").change(function() {
       $.cookie("textfield1", $(".textfield1").val(), {expires: 7});
  }); 
```

此代码段将读取 cookie 数据并在页面加载时填充该字段 -

```
 $(".textfield1").val( $.cookie("textfield1") ); 
```

将这两个片段放入 $(document).ready(function(){ }); 你很高兴！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:20:14.590

有一个有用的 jquery 插件“ [Jquery Populate](http://www.keyframesandcode.com/resources/javascript/jQuery/demos/populate-demo.html) ”，您可以将您的 json 存储在 cookie/session 中并使用它来填写您的表单。

# asp.net-mvc-3 - 将连接数据分配给视图模型的实体的 linq

> ID：11478315
> 
> 赞同：0
> 
> 时间：2012-07-13T21:00:40.243
> 
> 标签：asp.net-mvc-3, linq-to-entities, entity-framework-4.1

这是一个将数据分配给视图模型的 linq 查询。它工作得很好。

```
var data = (from C in db.CaseComplaints
                    where C.CasesID == caseid
                    select C.ComplaintCode).ToList().Select(x => new CaseComplaintsViewModel()
                        {
                            ComplaintCode = x.ComplaintCodeName,
                            ComplaintType = x.ComplaintType
                        }).ToList(); 
```

这是尝试执行连接并将数据分配给视图模型的代码。这没用。代码编辑器告诉我 x 没有 BranchName 的方法或定义

```
var data = (from branch in db.Branches
                    join customer in db.Customers 
                    on branch.BranchID equals customer.BranchID
                    where customer.BranchID == bid
                    select branch.BranchName).ToList().Select(x => new CaseResponsibleBranchViewModel()
                        {
                            BranchName = x.BranchName
                        }); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:04:20.057

您已经选择了 BranchName，我想它是一个字符串，所以 x 没有 BranchName 属性：

```
var data = (from branch in db.Branches
                    join customer in db.Customers 
                    on branch.BranchID equals customer.BranchID
                    where customer.BranchID == bid
                    select branch.BranchName).ToList().Select(x => new CaseResponsibleBranchViewModel()
                        {
                            BranchName = x
                        }); 
```

# ruby-on-rails - 错误：不兼容的字符编码：UTF-8 和 ASCII-8BIT

> ID：11478316
> 
> 赞同：7
> 
> 时间：2012-07-13T21:00:41.093
> 
> 标签：ruby-on-rails, oracle, utf-8

我得到了错误`incompatible character encodings: UTF-8 and ASCII-8BIT`，当视图在数据库中找到一些字符时，如：ñ、á、é 等。

我的环境是：

*   导轨：3.2.5
*   红宝石：1.9.4p194
*   数据库：Oracle 10g (10.2.0.1.0)

我可以使用 Toad 将这些字符保存在数据库中。

我试图在我的观点的第一行写这个：

```
<% # encoding: utf-8 %> 
```

在`enviroment.erb`

```
Encoding.default_external = Encoding::UTF_8
Encoding.default_internal = Encoding::UTF_8 
```

但没有什么能解决这个问题。

请，有人可以给出一些建议来解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-24T14:39:02.777

我有同样的问题，经过几个小时的猴子补丁搜索后我解决了它。

```
 module ActiveSupport #:nodoc:
      class SafeBuffer < String

        def safe_concat(value)
          value = force_utf8_encoding(value)
          raise SafeConcatError unless html_safe?
          original_concat(value)
        end

        def concat(value)
          value = force_utf8_encoding(value)
          if !html_safe? || value.html_safe?
            super(value)
          else
            super(ERB::Util.h(value))
          end
        end

        alias << concat

        private

        def force_utf8_encoding(value)
          self.force_encoding('UTF-8').html_safe unless self.encoding.name == 'UTF-8'
          value = (value).force_encoding('UTF-8').html_safe unless value.nil? || value.encoding.name == 'UTF-8'
          value
        end
      end
    end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T20:27:07.857

在文件`boot.rb`中，我添加了这一行：

```
ENV['NLS_LANG'] = 'AMERICAN_AMERICA.UTF8' 
```

这让我解决了我的问题。

# jquery - Noobie jquery class Q：内部函数调用

> ID：11478318
> 
> 赞同：2
> 
> 时间：2012-07-13T21:01:03.523
> 
> 标签：jquery

我在 this.hide(); 线上有一个断点。它可以在萤火虫中适当地找到，但永远不会通过隐藏：函数（）。我假设我正在犯一个非常令人尴尬的 noobie 语法错误。有人可以告诉我打这个内部电话的正确方法吗？

谢谢！

```
var myDialog = myControl.extend( { 
    //init  

    show : function() {
        if (this.isModal) {
            this.overlay.unbind("click");
        } else {
            this.overlay.click(function(e) {
                this.hide();
            });
        }
    },

    hide : function() {
        this.overlay.hide();
        this.dialog.fadeOut(300);
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:06:31.583

您很可能没有在 this.overlay.click() 处理程序中的预期上下文中操作。在 this.hide() 上放置一个断点并检查“this”对象。我敢打赌，这不是你所期望的！

您将希望在该调用之前缓存“this”，例如：

```
show : function() {
    var context = this;
    if (this.isModal) {
        this.overlay.unbind("click");
    } else {
        this.overlay.click(function(e) {
            context.hide();
    });
}, 
```

Javascript 上下文/范围是一个棘手的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T21:08:13.993

因为您的`this.hide();`行在点击事件中，`this`实际上是指被点击的元素。

# spring-mvc - Spring 3：使 web 应用程序接受 null 参数作为 multipartfile 参数

> ID：11478320
> 
> 赞同：2
> 
> 时间：2012-07-13T21:01:18.460
> 
> 标签：spring-mvc, exchangewebservices, multipartform-data

目前，当表单中的文件参数为`null`或为空时，Web 应用程序会抛出错误。我什至检查了文件为空但似乎不起作用的情况。有谁知道如何检查表单中的文件名字段为空并且不会在网络应用程序中引发错误的情况？

我正在为控制器使用以下代码。如您所见，我接受一个多部分文件参数，即表单中上传的文件。

```
@RequestMapping(value="/attachment", method=RequestMethod.POST)
public String sendAttachment(@RequestHeader("Authorization") String authHeader,                @RequestParam("to") String to,@RequestParam("cc") String cc,@RequestParam("bcc") String     bcc,@RequestParam("subject") String subject,@RequestParam("body") String body,   @RequestParam("file") MultipartFile  file,@RequestParam("filename") String  filename) {

. . .

//here i check if the file is empty...if not empty, then only attach it in the      message. 

if(!file.isEmpty())
{
    msg.getAttachments().addFileAttachment(filename,file.getBytes());
}

. . . 
```

我用来调用这个 Web 服务的 php 文件如下：

以下是使用空文件参数发送到 Web 服务的表单发布参数

```
$params = array(
            'to' => null,
            'cc' => null,

            'bcc' => "sanjaygir@gmail.com",
            'subject' => "hola sanjayg",
            'body' => "just testing message service",           

            'filename'=> "",
            'file'=>""
        ); 
```

我也尝试过使用null：

```
$params = array(
            'to' => null,
            'cc' => null,

            'bcc' => "sanjaygir@gmail.com",
            'subject' => "hola sanjayg",
            'body' => "just testing message service",           

            'filename'=> null,
            'file'=>null
        ); 
```

它仍然在服务器中引发 500 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-23T23:39:00.847

尝试更改`@RequestParam("file") MultipartFile file`为`@RequestParam(value = "file", required=false) MultipartFile file`

# javascript - 在 iOS UIWebView 中评估 JavaScript 时出现“SyntaxError: Unexpected EOF”

> ID：11478324
> 
> 赞同：12
> 
> 时间：2012-07-13T21:01:52.843
> 
> 标签：javascript, ios, json, uiwebview, xamarin.ios

尝试将一些 JSON 传递给 a 时，我在 JavaScript 中不断收到此错误`UIWebView`：

> 语法错误：意外的 EOF

没有可用的行号或文件名，`window.onerror`但我已经检查了所有引用的文件，它们很好。

我正在使用[`EvaluateJavaScript`](https://stackoverflow.com/a/5407039/458193)相当于 ObjC 的 MonoTouch 方法[`stringByEvaluatingJavaScriptFromString:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIWebView_Class/Reference/Reference.html#//apple_ref/occ/instm/UIWebView/stringByEvaluatingJavaScriptFromString:)：

```
webView.EvaluateJavascript(
    "Viewer.init($('#page'), " + json.ToString() + ");"
); 
```

它在“简单”的 JSON 输入上工作得很好，但在较大的对象上会中断。
会出什么问题？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-04-02T12:09:01.650

在将 NSString 传递给 UIWebView 之前，请务必转义换行符以及单/双引号：

```
NSString *html = @"<div id='my-div'>Hello there</div>";

html = [html stringByReplacingOccurrencesOfString:@"\'" withString:@"\\\'"];
html = [html stringByReplacingOccurrencesOfString:@"\"" withString:@"\\\""];
html = [html stringByReplacingOccurrencesOfString:@"\n" withString:@"\\n"];
html = [html stringByReplacingOccurrencesOfString:@"\r" withString:@""];

NSString *javaScript = [NSString stringWithFormat:@"injectSomeHtml('%@');", html];
[_webView stringByEvaluatingJavaScriptFromString:javaScript]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-13T21:01:52.843

显然，我忘了[在 JSON 中转义换行符](https://stackoverflow.com/a/42073/458193)，因此为 UIWebView 创建了一个“意外的 EOF”。

# java - Java：比较 int 时 == 运算符如何工作？

> ID：11478326
> 
> 赞同：5
> 
> 时间：2012-07-13T21:01:54.800
> 
> 标签：java

鉴于此 Java 代码：

```
int fst = 5;
int snd = 6;

if(fst == snd)
    do something; 
```

我想知道 Java 将如何比较这种情况下的相等性。它会使用 XOR 操作来检查相等性吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T21:03:56.453

您是在问“这会变成什么本机机器代码？”？如果是这样，答案是“依赖于实现”。

但是，如果您想知道使用了什么[JVM 字节码](http://en.wikipedia.org/wiki/Java_bytecode_instruction_listings)，只需查看生成的 .class 文件（例如使用[javap](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javap.html)反汇编它）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T21:12:22.210

如果您询问 JVM，请使用该`javap`程序。

```
public class A {

    public static void main(String[] args) {

        int a = 5;
        System.out.println(5 == a);

    }

} 
```

下面是拆解：

```
public class A {
  public A();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: iconst_5
       1: istore_1
       2: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;
       5: iconst_5
       6: iload_1
       7: if_icmpne     14
      10: iconst_1
      11: goto          15
      14: iconst_0
      15: invokevirtual #3                  // Method java/io/PrintStream.println:(Z)V
      18: return
} 
```

在这种情况下，它稍微优化了分支并使用了`if_icmpne`. 在大多数情况下，它将使用`if_icmpne`or `if_icmpeq`。

`if_icmpeq`：`if ints are equal, branch to instruction at branchoffset (signed short constructed from unsigned bytes branchbyte1 << 8 + branchbyte2)`

`if_icmpn`：`if ints are not equal, branch to instruction at branchoffset (signed short constructed from unsigned bytes branchbyte1 << 8 + branchbyte2)`

# configuration - 使用 System.setProperty() 覆盖 Hadoop 最终属性

> ID：11478334
> 
> 赞同：0
> 
> 时间：2012-07-13T21:02:32.640
> 
> 标签：configuration, hadoop

系统管理员可以将某些属性定义为最终属性，这样客户端守护程序就不会覆盖它们。

但是，使用`System.setProperty()`方法设置的属性优先于使用 Hadoop 的配置 API 设置的属性，在这种情况下，客户端守护进程是否无法通过调用来设置最终属性来覆盖它`System.setProperty()`？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:06:42.027

请注意，虽然可以根据系统属性定义配置属性，但除非使用配置属性重新定义系统属性，否则它们无法通过配置 API 访问

在内部，hadoop 系统将仅通过 Configuration 接口访问配置属性。如果用户无法通过配置界面修改配置属性（如果管理员将属性定义为最终属性，他将无法修改），系统将看不到用户在系统属性中所做的修改

# facebook - Facebook JS SDK - 访问令牌无法发布操作

> ID：11478347
> 
> 赞同：0
> 
> 时间：2012-07-13T21:03:34.443
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

当我使用下面的代码时没有任何反应，我无法理解为什么会这样

```
function graphStreamPublish(){
var passString = '?[OBJECT]=http://entrancesuccess.net&access_token=' + accesstoken;

 FB.api('/me/[APPNAMESPACE]:[ACTION]' + passString,'post', 
            function(response) {
                showLoader(false);

                if (!response || response.error) {
                    alert('Error occured');
                } else {
                    alert('Post ID: ' + response.id);
                }
            });
        } 
```

但是，当我只是简单地将访问令牌（YTWYDGFXVVZG456AVGAFV45HGCZXHGFACGFCGFXDG546FXGFXJGFXGFXGXFJXGFXG）复制粘贴到变量“passString”中时，一切正常，并且操作会在 facebook 上的用户活动中发布。

例子：

```
 function graphStreamPublish(){
var passString = '?[OBJECT]=http://entrancesuccess.net&access_token=YTWYDGFXVVZG456AVGAFV45HGCZXHGFACGFCGFXDG546FXGFXJGFXGFXGXFJXGFXG'; 
```

其余代码如下（如果需要）：

```
window.fbAsyncInit = function() {
            FB.init({ appId: 'XXXXXXXXXXXXX', //change the appId to your appId
                status: true, 
                cookie: true,
                xfbml: true,
                oauth: true});

           showLoader(true);

           function updateButton(response) {
                button       =   document.getElementById('fb-auth');
                userInfo     =   document.getElementById('user-info');

                if (response.authResponse) {
                    //user is already logged in and connected
                    FB.api('/me', function(info) {
                        login(response, info);
                    });

                    button.onclick = function() {
                        FB.logout(function(response) {
                            logout(response);
                        });
                    };
                } else {
                    //user is not connected to your app or logged out
                    button.innerHTML = 'Login';
                    button.onclick = function() {
                        showLoader(true);
                        FB.login(function(response) {
                            if (response.authResponse) {
                                FB.api('/me', function(info) {
                                    login(response, info);
                                });    
                            } else {
                                //user cancelled login or did not grant authorization
                                showLoader(false);
                            }
                        }, {scope:'publish_stream,public_action'});     
                    }
                }
            }

            // run once with current status and whenever the status changes
            FB.getLoginStatus(updateButton);
            FB.Event.subscribe('auth.statusChange', updateButton);  
        };
        (function() {
            var e = document.createElement('script'); e.async = true;
            e.src = document.location.protocol 
                + '//connect.facebook.net/en_US/all.js';
            document.getElementById('fb-root').appendChild(e);
        }());

        function login(response, info){
            if (response.authResponse) {
                 var accessToken                                 =            response.authResponse.accessToken;

                userInfo.innerHTML                             = '<img src="https://graph.facebook.com/' + info.id + '/picture">' + info.name
                                                                 + "<br /> Your Access Token: " + accessToken;
                button.innerHTML                               = 'Logout';
                showLoader(false);
                document.getElementById('other').style.display = "block";
            }
        }

        function logout(response){
            userInfo.innerHTML                             =   "";
            document.getElementById('debug').innerHTML     =   "";
            document.getElementById('other').style.display =   "none";
            showLoader(false);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T12:02:06.067

我想说`accesstoken`你的函数中没有变量`graphStreamPublish`。

您`var`在 function 中使用关键字`login`，这使其成为*局部*变量 - 因此，一旦该函数完成，它的内容就会被丢弃。

您可以在没有 的情况下进行分配`var`，那么它将是一个*全局*变量，并且`graphStreamPublish`应该能够访问它。

但通常你根本不需要显式传递访问令牌，因为 JS SDK 完全能够在后台自行传递它，而不需要你自己主动传递它。

# ruby-on-rails - 未发布表单时的参数哈希

> ID：11478350
> 
> 赞同：0
> 
> 时间：2012-07-13T21:03:49.970
> 
> 标签：ruby-on-rails, params

当我执行常规 GET 并且我的参数中没有任何内容时，参数哈希的状态是什么？空白的 ？无？还有什么？

因为我有一个控制器，我希望只有当参数“有东西”时才执行指令。我试过了！params.nil？, !params.blank?

这些都不起作用，因此我继续输入 if 块，并得到一个 nil 错误......

帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:18:30.587

听起来您想使用 !params.empty？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:19:05.603

当你的 get 中没有传递任何参数时，唯一可以确定的是你的参数哈希中有一个`controller`和一个`action`键。现在，如果您不向我显示您正在获取的 URL，我无法告诉您 params 哈希中还有什么，但其中肯定有一个`action`和一个`controller`键。您可以随时调用 a`puts(params.inspect)`来查看到底发生了什么，或者使用[pry gem](https://github.com/pry/pry/)进行调试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T13:22:57.900

为什么不测试您正在寻找的东西，如果它不存在，哈希值将为零。

```
if params[:something].nil?
  ..
else
  .. 
```

# git - git cvsexportcommit pserver 失败

> ID：11478353
> 
> 赞同：0
> 
> 时间：2012-07-13T21:04:06.630
> 
> 标签：git, cvs, git-cvs

我正在使用 git 和我试图遵循的 cvs 存储库

[如何将修订历史从 mercurial 或 git 导出到 cvs？](https://stackoverflow.com/questions/584522/how-to-export-revision-history-from-mercurial-or-git-to-cvs/586225#586225)

除了我使用 -d pserver 而不是 -w local cvs repo

我已经完成了 git cvsimport ，这似乎很好。我现在正在尝试将单个测试更改导出回 csv 存储库，但它失败了

我尝试了以下命令，结果如下

命令：

```
export $GIT_DIR=~/project/.git
git cvsexportcommit -d :pserver:username:password@someserver/cvsrepo -u -p -c ORIG_HEAD HEAD

Did not find COMMITID in the parents for the commit! at /usr/lib/git-cvsexportcommit line 125. 
```

命令：

```
export $GIT_DIR=~/project/.git
git cvsexportcommit -d :pserver:username:password@someserver/cvsrepo -u -p -c COMMITID

checking if patch will apply
cvs update: cannot open CVS/Entries for reading: No such file or directory
cvs [update aborted]: no repository
cvs -d :pserver:username:password@someserver/cvsrepo update /path/file.java: 256 at /usr/lib/git-core/git-vcxexportcommit line 436. 
```

注意：我也尝试将 GIT_DIR 向上或向下移动一个级别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:08:49.063

不幸`git cvsexportcommit`的是，需要存在由参数指定的实际 CVS 检出`-w`。这是因为它只是发出必要的`cvs commit`命令而不直接与 CVS 服务器交互。

# mysql - 会话 <> 扫描：获取所有尚未执行的扫描

> ID：11478361
> 
> 赞同：1
> 
> 时间：2012-07-13T21:04:37.300
> 
> 标签：mysql, sql

我有一个复杂的域结构：

```
User:        id, name, email
Team:        id, name
UserTeam:    id, user_id, team_id
Session:     id, data
UserSession: id, user_id, session_id
TeamSession: id, team_id, session_id
Scan:        id, user_id, session_id, test_data 
```

我可以邀请用户参加“会议”。用户可以进行会话（创建一个`UserSession`），如果完成，结果将存储在`Scan`. 我还可以邀请一个完整的团队，这样`TeamSession`就创建了一个，并且为每个团队成员`UserSession`制作了一个。

现在我想执行查询：给我所有尚未执行的扫描（这样我就可以记住用户进行一次）。对于这种情况，我想选择**所有用户会话**并加入**扫描**id 所在的扫描`NULL`。我认为这是从连接表中找出一行的方法还没有出现。

这是我的查询：

```
SELECT us.id as userSessionId,
       sc.id as scanId,
       s.id as sessionId,
       u.id, u.name

FROM usersessions us
     LEFT JOIN sessions s ON us.session_id = s.id
     LEFT JOIN scans sc   ON us.session_id = sc.session_id
     LEFT JOIN users u    ON us.user_id = u.id

WHERE sc.id IS NULL

GROUP BY us.id 
```

但是，它不起作用：当至少有一个用户尚未执行扫描时，没有返回任何内容。如果我删除该`WHERE`子句以查看数据是什么，我会得到这个：

```
userSessionId  scanId  sessionId  id  name
45             45      39         39  John
46             45      39         40  Jane
47             45      39         41  Tom
48             45      39         42  Mark 
```

在这种情况下，所有人都在同一个组中并获得了一个会话（#39）。他们的用户 ID 和用户会话 ID 是正确的。Mark 没有进行扫描。约翰确实扫描了#45（对于简来说是#46，汤姆是#47）。

如果我添加 where 子句`WHERE sc.user_id=u.id`，我会得到正确的三个结果（扫描 #45、#46 和 #47），但是 Mark 丢失了。那是我最后想要抓住的唯一一个！如果您将其更改为两个子句`WHERE sc.user_id=u.id AND sc.id IS NULL`，则它（显然现在）不再返回任何内容。

获取所有未连接到扫描的用户会话的查询是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:57:39.453

消除`GROUP BY`查询中的子句。如果没有 Aggregate 函数，它是无效的，但是在 MySQL 中，它不会抛出错误并且会返回“随机”行。用于`ORDER BY`对答案进行排序。

```
SELECT us.id as userSessionId,
       sc.id as scanId,
       s.id as sessionId,
       u.id, u.name

FROM usersessions us
     LEFT JOIN sessions s ON us.session_id = s.id
     LEFT JOIN users u    ON us.user_id = u.id

WHERE us.session_id IS NULL

ORDER BY us.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T22:30:29.710

你可以试试这个解决方案。如果它适合您，我将编辑我的帖子以添加解释：

```
SELECT
    a.id AS userSessionId,
    b.id AS scanId,
    a.session_id AS sessionId,
    a.user_id,
    c.name
FROM
(
    SELECT a.*
    FROM usersessions a
    LEFT JOIN scans b ON a.user_id = b.user_id AND a.session_id = b.session_id
    WHERE b.id IS NULL
) a
INNER JOIN
(
    SELECT id, session_id
    FROM scans
    GROUP BY id, session_id
) b ON a.session_id = b.session_id
INNER JOIN
    users c ON a.user_id = c.id 
```

* * *

我假设您的数据看起来像这样：

```
usersessions:
id  |  uid  |  session_id
-------------------------
45  |   39  |   39
46  |   40  |   39
47  |   41  |   39
48  |   42  |   39

scans:
id  |  uid  |  session_id
-------------------------
45  |  39   |  39
45  |  40   |  39
45  |  41   |  39 
```

在这种情况下，您应该最终得到：

```
userSessionId  |  scanId  |  sessionId  |  user_id  |  name
-----------------------------------------------------------
48             |  45      |  39         |  42       |  Mark 
```

让我知道您的扫描表是否允许看起来像：

```
scans:
id  |  uid  |  session_id
-------------------------
45  |  39   |  39
45  |  40   |  39
45  |  41   |  39
46  |  39   |  39
46  |  40   |  39
46  |  41   |  39
46  |  42   |  39 
```

^ 在这种情况下，我的查询将不起作用，并且需要重写（我知道如何）。

# c# - Visual Studio 正在加载错误的源文件以进行调试

> ID：11478362
> 
> 赞同：3
> 
> 时间：2012-07-13T21:04:39.017
> 
> 标签：c#, .net, visual-studio-2010

这个真的很奇怪。我有一个正在尝试调试的应用程序。由于某种原因，当发生错误时，它会中断调试器但加载错误的文件。它正在我的解决方案中查看一个完全独立的项目中的文件。有什么想法吗？

# sql-server - SSAS 2008 和 Excel 2010 神秘

> ID：11478364
> 
> 赞同：0
> 
> 时间：2012-07-13T21:04:42.347
> 
> 标签：sql-server, ssas, olap, dimensions

我有 MS SQL 2008 R2 企业版。我也有 Microsoft Excel 2010。

我创建了一个包含 1 个维度的多维数据集 - 折扣卡的数量和年月日

我还创建了一个带有“数量”度量的立方体

然后我通过 Excel 连接到多维数据集，并用我的维度“DiscountCard”创建一个列。此维度包含 55000 个成员。

但 ！一旦我过滤了这个维度（例如排除折扣卡 #2344 ），我就有了一个奇迹。我只能看到 3844 个成员（其他成员被削减）。

我该怎么办才能看到我所有的其他成员？

提前致谢。

# git - 仅在 Git 扩展上手动合并

> ID：11478365
> 
> 赞同：3
> 
> 时间：2012-07-13T21:04:43.037
> 
> 标签：git, merge, git-pull, git-extensions

我对 Git 很陌生，我使用 Git 扩展。每当我拉动时，Git 都会使用[KDiff3](http://kdiff3.sourceforge.net/)自动合并，并且仅在遇到冲突时才请求帮助。但是，我对自动合并功能不太满意，因为我看到合并的文件有一些没有报告的冲突。我想在 Git Extensions 中禁用自动合并。我希望 Git 能够让我在每次拉取时手动合并文件。

由于我对 Git 很陌生，如果您要求我更改一些 .git 文件，请务必提及文件最可能的物理位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:33:09.023

放入一个[`.gitattributes`文件](http://git-scm.com/docs/gitattributes)：

```
* -merge 
```

那将“ `unset`”自动合并。

您可以选择：

*   提交该文件（克隆您的仓库的每个人都必须处理手动合并）
*   或将该指令放入`$GIT_DIR/info/attributes`文件中（仅在您的存储库中本地）

请注意，`kdiff3`可以通过`merge.tool`配置更改。

# jquery - 使用“+=variable”不能作为 jQuery.animate 目标值？

> ID：11478369
> 
> 赞同：1
> 
> 时间：2012-07-13T21:04:59.990
> 
> 标签：jquery, css

我正在使用 jQuery 创建一个滑动图片库，当给定一个数值时，“left”css 属性可以正常工作，但是当给定一个变量时，它什么也不做。这是我的代码：

```
$(document).mousemove(function(e) {
    var gall = document.getElementById("Gallery");
    var gallOffset = $("div#GalleryHold").offset();
    var offsetX = e.pageX - gallOffset.left;
    var left = gall.style.posLeft;
    var pos = offsetX;
    if (mouseIsOver == true) {
        $('#status').html(offsetX + " " + left + " " + mouseIsOver);
        if (offsetX < 400 && left < 0) {
            $("div#Gallery").stop().animate({
                left: '+=pos'
            }, 600);
        }
        if (offsetX > 600 && left > -1100) {
            $("div#Gallery").stop().animate({
                left: '-=pos'
            }, 600);
        }
    }
    else if (mouseIsOver == false) {
        $('#status').html(offsetX + " " + left + " " + mouseIsOver);
    }
});​ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T21:07:44.673

`'+=pos'`是一个常量字符串。

您可能想要`'+=' + pos`，这将评估为类似的字符串`'+=50'`

# ruby-on-rails - Rails 控制台坏了

> ID：11478370
> 
> 赞同：1
> 
> 时间：2012-07-13T21:05:15.637
> 
> 标签：ruby-on-rails, rails-console

我今天发现我在 Rails 上的 ruby​​ 控制台不再工作。（我不经常在控制台外工作，所以不确定何时或如何发生）。我想获得有关其他人是否遇到此问题的反馈，以及我是否应该重新安装 ruby​​、rails 或任何其他程序或配置。

当我进入

```
$ rails console 
```

它让我进入看起来像控制台的地方，但是我输入的任何内容都会返回 NoMethodError，其中未定义的方法是我实际输入的拼写错误。

例如，当我输入

```
irb(main):001:0>  editor = Editor.new(name: "bob") 
```

我得到回应

```
NoMethodError: undefined method 'oews' for main:Object
    from (irb):8
    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.6/lib/rails/commands/console.rb:47:in 'start'
    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.6/lib/rails/commands/console.rb:8:in 'start'
    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.6/lib/rails/commands.rb:41:in <top (required)>'
    from script/rails:6:in 'require'
    from script/rails:6:in '<main>' 
```

这似乎是对“新”方法的误解。此外，上面引用的 railties-3.2.6 文件夹似乎是空的。

这发生在我的 SQlite3 和 PG 环境中。

关于可能导致这种情况的任何见解？如果可能，我想尽量减少重新安装的次数。

我目前正在运行 ruby​​ 1.9.3 和 rails 3.2.6

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:42:49.347

检查您是否在应用程序的目录中。如果您使用的是 Mac 或 linux，请使用 cd 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T01:55:31.957

问题的原因仍然不清楚。

重新启动似乎已经解决了它。对不起，应该在发布问题之前这样做。

# .htaccess - 使用帮助程序在 codeigniter 中强制 SSL

> ID：11478371
> 
> 赞同：0
> 
> 时间：2012-07-13T21:05:18.020
> 
> 标签：.htaccess, codeigniter, ssl

我正在尝试对我的购物车应用程序采用 ssl 路由解决方案，以便某些页面被“强制”为 https:// 页面和 visa-verse。通过研究，我遇到了许多解决方案，这些解决方案涉及在帮助程序、钩子或控制器中使用代码。我已经尝试了其中的一些解决方案，并且在每个解决方案中，切换到 https:// 页面时都会出现重定向错误。

这是我尝试过的最后一个版本（在这里找到：http: [//nigel.mcbryde.com.au/2009/03/working-with-ssl-in-codeigniter](http://nigel.mcbryde.com.au/2009/03/working-with-ssl-in-codeigniter)）：

在 application/helper 中创建一个名为 ssl_helper.php 的文件

```
if (!function_exists('force_ssl'))
{
    function force_ssl()
    {
        $CI =& get_instance();
        $CI->config->config['base_url'] =
                 str_replace('http://', 'https://',
                 $CI->config->config['base_url']);
        if ($_SERVER['SERVER_PORT'] != 443)
        {
            redirect($CI->uri->uri_string());
        }
    }
}

function remove_ssl()
{
    $CI =& get_instance();
    $CI->config->config['base_url'] =
                  str_replace('https://', 'http://',
                  $CI->config->config['base_url']);
    if ($_SERVER['SERVER_PORT'] != 80)
    {
        redirect($CI->uri->uri_string());
    }
} 
```

加载帮助程序，然后在任何需要 ssl 的控制器的构造函数中，只需插入：

```
force_ssl(); 
```

在您不想放置 ssl 的每个控制器中：

```
if (function_exists('force_ssl')) remove_ssl(); 
```

如上所述，在使用它时，我陷入了重定向循环并出现错误（尽管 URL 应具有 https://）。我的问题可能出在我的 .htaccess 文件中吗？这是我的 .htaccess 文件：

```
<IfModule mod_rewrite.c>
   RewriteEngine On
   RewriteBase /store
   RewriteCond $1 !^(index.php\.php|resources|robots\.txt)
   RewriteCond %{REQUEST_FILENAME} !-d
   RewriteCond %{REQUEST_FILENAME} !-f
   RewriteRule ^(.*)$ index.php?/$1 [QSA,L]
</IfModule> 
```

我已经在这工作了一个多星期了！有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-11T15:06:27.703

如果您使用 force_ssl 函数，这是重定向循环的解决方案。

```
function check_ssl()
{
    $CI =& get_instance();
    $class = $CI->router->fetch_class();       
    $ssl = array('Register', 'SignIn', 'Recover');        
    if(in_array($class, $ssl))
    {
        force_ssl();
    }
    else
    {
        unforce_ssl();
    }
}
function force_ssl()
{        
    $CI =& get_instance();
    $CI->config->set_item('base_url', str_replace('http://', 'https://', config_item('base_url'))); 
    if ($_SERVER['SERVER_PORT'] != 443) // it will loop if you change it to !==
    {
        redirect($CI->uri->uri_string());
    }
}
function unforce_ssl()
{
    $CI =& get_instance();
    $CI->config->set_item('base_url', str_replace('https://', 'http://', config_item('base_url')));
    if ($_SERVER['SERVER_PORT'] != 80) // it will loop if you change it to !==
    {
        redirect($CI->uri->uri_string());
    }   
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T22:15:43.200

我在这里回答了一个类似的问题[：https://stackoverflow.com/questions/1500527/how-to-use-ssl-with-codeigniter/1500558#1500558](https://stackoverflow.com/questions/1500527/how-to-use-ssl-with-codeigniter/1500558#1500558)

但是，简而言之：

```
<IfModule mod_rewrite.c>
   RewriteEngine On
   RedirectPermanent /sslfolder https://www.yoursite.com/sslfolder
</IfModule> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-15T06:25:30.343

大家好，通过在配置中设置 base_url 来检查答案，它将自动在 http 和 https 之间切换

[在没有帮助的情况下强制使用 ssl](https://stackoverflow.com/questions/11483312/force-ssl-in-codeigniter/11489869#11489869)

# android - 将计数器从一个 Activity 传递到另一个

> ID：11478374
> 
> 赞同：0
> 
> 时间：2012-07-13T21:05:25.267
> 
> 标签：android, bundle, android-activity

我有一个类`Voice`，它扩展`Activity`并包含一个计数器。当用户回答正确时，计数器通过`counter++;`

```
public class Voice  extends Activity implements OnClickListener{
    ListView lv;
    static final int check = 111;
    int counter_score;
    TextView txView;
    MediaPlayer ourSong;
    ImageView display;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.letter_a);
        initialize();
    }

    private void initialize() {
        lv = (ListView)findViewById(R.id.lvVoiceReturn);
        Button b = (Button)findViewById(R.id.imageButtonSelector);
        txView = (TextView)findViewById(R.id.counter);
        b.setOnClickListener(this);
        counter_score=0;
    } 
```

该分数被捆绑并传递给字符串“您的分数为 1”中的下一个活动“什么”。

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == check && resultCode == RESULT_OK) {
        ArrayList<String> results = data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);
        lv.setAdapter( new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, results));

        if(results.contains("hey") || results.contains("a") || results.contains("ay")) {
            //toast referenced to xml the after 400ms
            counter_score++;
            txView.setText("Your Score is" + " " + counter_score);

            AlertDialog dialogBuilder = new AlertDialog.Builder(this).create();
            dialogBuilder.setTitle("AWSOME");
            dialogBuilder.setMessage("¡Your current score is" + counter_score);
            dialogBuilder.setIcon(R.drawable.ic_mark);
            dialogBuilder.show();

            ourSong = MediaPlayer.create(Voice.this, R.raw.rightsound2);
            ourSong.start();
            Thread timer = new Thread() {
                public void run(){
                try {
                    sleep(2500);
                }catch (InterruptedException e){
                    e.printStackTrace();
                } finally {
                    String score = txView.getText().toString();
                    Bundle keeper = new Bundle();
                    keeper.putString("key", score);
                    Intent putScore = new Intent(Voice.this, What.class);
                    putScore.putExtras(keeper);
                    startActivity(putScore);
                }
            }
        };

        timer.start();
    }
} 
```

下一个`Activity`, `What`, 得到这个`Bundle`并使用它很好地显示它`setText(gotScore)`

```
public class What  extends Activity implements OnClickListener {
    ListView lv;
    static final int check = 111;
    private int counter_score;
    TextView txView;
    MediaPlayer ourSong;
    ImageView display;
    String gotScore;

    String classes[] = {"What", "Pagina", "What", "example3", "example4", "example5", 
                        "example6"};

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.letter_b);
        initialize();
        Bundle gotKeeper = getIntent().getExtras();
        gotScore = gotKeeper.getString("key");
        txView.setText(gotScore);
    }

    private void initialize() {
        // TODO Auto-generated method stub
        lv = (ListView)findViewById(R.id.lvVoiceReturn);
        Button b = (Button)findViewById(R.id.imageButtonSelector);
        txView = (TextView)findViewById(R.id.counter);
        b.setOnClickListener(this); 
```

..这是事情变糟的时候:(

关于`What`我还有一个与柜台相关的问题。当用户正确回答时，计数器会添加一个过孔`counter++;`，并且确实如此。但是，它将更改`txview` `string`为“您的分数为 1”。我无法将它添加到从字符串中上一个活动传递的计数器结果中，以便计数器`What`读取“你的分数是 2”。这将传递给 中的下一个活动`Bundle keeper`，该活动保存总分。

我已经阅读了一些关于传递`int`verses a的教程`string`，但是他们使用的一些代码`getInt`无法识别。我难住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:19:14.597

~~如果您创建一个“全局”类以在不同的活动之间共享，并使用它来保持使用的变量“同步”？~~

例如 - Globals.java：

```
public class Globals {

  public int counter_score; 

} 
```

~~然后使用引用该变量`Globals.counter_score`~~

当然，您也可以将该共享类用于其他变量和函数 - 例如常见操作。

# 更新

正如评论者指出的那样，这种方法并不是特别好 - 我忘记了代码只是简单地引用，并且不会自行“生存”以保留其他活动的信息（感谢您在那个问题上纠正我，我还在学习中……）

但是，可以更好地工作的方法是在您启动第二个活动时在意图中传递 counter_score 变量的当前状态 - 例如：

```
IntentToLaunchTheOtherActivity( counter_score ); 
```

如果之后发生更改，则可能会将变量传递回先前的活动......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T21:18:46.973

我得到它的工作。本质上，我需要 TJ Third 建议转换`keeper.putString("key", counter_score);`为的内容`keeper.putInt("key", counter_score);`，我还需要将接收到的捆绑包转换为“什么”活动中的 int。在“什么”活动中，我重命名了`int counter_score;`和`int gotKeeper;`（这是 String gotKeeper），而不是调用 counter_score =0; 现在传递的包是一个 int，我叫 counter_score = gotKeeper; 在初始化（）下；所以计数器分数等于上一个活动“语音”生成的结果。

现在当用户正确回答时，counter++；将一个添加到现有的 counter_score 并将其捆绑并将其发送到下一个活动，然后冲洗重复。

```
static final int check = 111;
    int counter_score;
    TextView txView;
    MediaPlayer ourSong;
    ImageView display;
    int gotKeeper;

    String classes[] = {"What", "Pagina", "What", "example3", "example4", "example5", 
    "example6"};

@Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.letter_b);
        initialize();
        Bundle gotKeeper = getIntent().getExtras();
        gotKeeper = gotScore.getInt("key");
        counter_score = gotKeeper; 
```

再次感谢大家的建议和见解。对新手的巨大帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:31:13.007

您捆绑并传递给 What 活动的不是计数器，而是字符串“您的分数为 1”。如果您想在下一个活动中增加该数字，那么您应该只发送整数值并在那里构造您需要的任何字符串。

> 我已经阅读了一些关于传递 int 与字符串的 tuts..但是他们使用的一些代码（如 getInt）无法识别..任何人都被我难住了..

我不太确定我知道 getInt() 无法识别您的意思。无论如何，在将计数器从一项活动传递到另一项活动时，让事情变得更容易。如果它是一个 int 并且您计划在接收活动中像 int 一样进行操作，则将其作为 int 添加到包中。例如：

```
 Bundle keeper = new Bundle();
    keeper.putInt("key", counter_score); 
```

并使用以下命令从捆绑包中检索它：

```
 Bundle gotKeeper = getIntent().getExtras();
    int score = gotKeeper.getInt("key"); 
```

# mysql - 根据条件更新查询

> ID：11478375
> 
> 赞同：6
> 
> 时间：2012-07-13T21:05:32.120
> 
> 标签：mysql, sql, conditional-statements

我想做以下事情。根据另一个字段的值更新一个字段，例如

```
update table set if(fielda=1){fieldb=2 fieldc=3}else{fieldd=2 fielde=3} 
```

我知道这不是有效的 mysql，但它是我描述问题的最佳方式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T21:15:20.830

```
update table set
b = case when a = 1 then 2 else b end,
c = case when a = 1 then 3 else c end,
d = case when a = 1 then d else 2 end,
e = case when a = 1 then e else 3 end 
```

## 编辑

根据你的评论试试这个：

```
update table set
datefield_a = case when field_a = 1 then now() else datefield_a end,
datefield_b = case when field_a <> 1 then now() else datefield_b end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T21:16:01.193

我认为这种语法将达到您试图指定的结果。

```
UPDATE mytable
   SET fieldb = CASE WHEN fielda = 1 THEN 2 ELSE fieldb END
     , fieldc = CASE WHEN fielda = 1 THEN 3 ELSE fieldc END
     , fieldd = CASE WHEN fielda = 1 THEN fieldd ELSE 2 END
     , fielde = CASE WHEN fielda = 1 THEN fielde ELSE 3 END 
```

这里的“技巧”是我们正在更新所有四列，但在某些“情况”中，我们将列的当前值分配回列，导致列值没有真正的变化。（一旦你开始思考这个想法，就很容易了。）

使用 MySQL，我们确实有一个方便的 IF 函数（在大多数其他 RDBMS 中不可用），我们可以使用它来简化它，并实现相同的目标：

```
UPDATE mytable
   SET fieldb = IF(fielda = 1, 2, fieldb)
     , fieldc = IF(fielda = 1, 3, fieldc)
     , fieldd = IF(fielda = 1, fieldd, 2)
     , fielde = IF(fielda = 1, fielde, 3) 
```

痛苦是您仍然必须多次重复相同的条件测试。

对表进行一次扫描（就像这些语句所做的那样），一口气完成所有这些分配将比分解它并使用多个语句零碎地进行分配更快（并且更有效）。

# hosting - 我有一台windows pc，我可以用LAMP 开发吗？

> ID：11478376
> 
> 赞同：1
> 
> 时间：2012-07-13T21:05:35.530
> 
> 标签：hosting, wamp, lamp, web-hosting, cloud-hosting

我有一台运行 Windows 的电脑，但我想使用 linux 服务器。在我租用服务器空间之前，我有没有办法在我的电脑上开发我的网站？同样重要的是要注意我没有Linux经验。我应该坚持使用 wamp 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:10:07.250

除非您在您的 PHP 应用程序中专门**且有意地**使用 .NET 功能，否则只要您包含所有相同的 PHP 插件，使用[WAMP](http://en.wikipedia.org/wiki/WAMP)开发的应用程序就可以在[LAMP](http://en.wikipedia.org/wiki/LAMP_%28software_bundle%29)服务器上正常工作。

PHP 独立于 Linux 或 Windows。99.9% 的时间您必须有**意识地**使用主机操作系统的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:51:30.633

是的。我以前开发和维护过这样的网站。我的开发环境是 WAMP，服务器是 LAMP 共享服务器。在您的站点使用相当基本的库并且它们都可用于 windows/linux 之前，这应该不是问题。

然而，正如其他人所提到的，让开发环境尽可能接近生产环境更为明智。这样你就不会遇到任何意外。嘿，这并不难，而且不涉及任何成本：

*   您可以使用双启动将 linux 作为其他操作系统。
*   根据您的机器，您可以只安装[VirtualBox](https://www.virtualbox.org/)并安装 Linux VM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:10:31.790

您应该在虚拟机中尝试 ubuntu，有很多编写良好的指南可以帮助您启动和运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T21:13:48.290

为获得最佳性能，请使用 coLinux。安装像ubuntu这样的linux发行版（对初学者来说更容易），你应该没问题。

# java - 在 Netbeans/REST 中给出错误的 POST 方法

> ID：11478379
> 
> 赞同：1
> 
> 时间：2012-07-13T21:05:45.617
> 
> 标签：java, rest, netbeans

我正在尝试使用 REST 在 netbeans/java 中构建 POST 方法。由于某种原因，此代码在调用时不断返回错误，有什么想法吗？

```
@POST
@Path("findByImage")
public String findByImage() {
    return "hello";
} 
```

它返回错误：

类型异常报告

信息

描述服务器遇到一个内部错误 () 阻止它完成这个请求。

例外

```
javax.ws.rs.WebApplicationException: java.lang.IllegalArgumentException: Error parsing media type ', application/xml'
note The full stack traces of the exception and its root causes are available in the GlassFish Server Open Source Edition 3.1.2 logs. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T11:05:03.460

如果您发送带有错误“Content-Type”标头（“应用程序/xml”）的 POST 请求，则会收到此错误。例如，我可以使用下一个命令重现它：

```
curl -i -X POST -H "Content-Type: , application/xml" http://localhost:8080/jsfDemo/resources/testing/findByImage 
```

# ruby-on-rails - Ruby On Rails：将 collection_select 值存储到数组中

> ID：11478380
> 
> 赞同：1
> 
> 时间：2012-07-13T21:05:45.767
> 
> 标签：ruby-on-rails, select

我有一个包含多个 collect_select 字段的表单，我希望能够将选定的值存储到数组或哈希中。

例如：

```
<%= f.collection_select(:package_ids, Package.all, :id, :concatTitle, {:prompt => true}) %>
<%= f.collection_select(:package_ids, Package.all, :id, :concatTitle, {:prompt => true}) %>  
<%= f.collection_select(:package_ids, Package.all, :id, :concatTitle, {:prompt => true}) %> 
```

我希望将所有选定的 id 存储到同一个字段中`:package_ids`。这样做的正确语法是什么？

# c# - 合并多个配置文件

> ID：11478381
> 
> 赞同：2
> 
> 时间：2012-07-13T21:05:47.043
> 
> 标签：c#, asp.net, asp.net-mvc, web-config

我的 C:\Configs 目录中有以下配置文件

1.  应用程序环境配置
2.  应用程序.dev.config
3.  app.production.config

**app.environment.config**仅包含此*开发*，可以根据我想在运行时与主 App.config 合并的配置文件从开发更改为生产。如何使这种合并发生，即从 app.dev.config 或 app.production.config 合并，基于从*dev*中挑选的值。示例代码将不胜感激。

我采用这种方法是因为我们有很多开发人员在同一个项目上工作，我不希望任何人互相踩踏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:12:00.913

您可以使用名为 SlowCheetah 的扩展程序[http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5/](http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5/)

请查看 Scott Hanselmans 的博客如何使用 SlowCheetah 进行转换[http://www.hanselman.com/blog/SlowCheetahWebconfigTransformationSyntaxNowGeneralizedForAnyXMLConfigurationFile.aspx](http://www.hanselman.com/blog/SlowCheetahWebconfigTransformationSyntaxNowGeneralizedForAnyXMLConfigurationFile.aspx)

# html - IE 单选按钮忽略边距=0

> ID：11478383
> 
> 赞同：2
> 
> 时间：2012-07-13T21:06:07.707
> 
> 标签：html, internet-explorer, firefox, radio-button

我试图让`radio`按钮在**IE**和**Firefox**中看起来一样。

我有以下示例：

```
<head>
<style media="screen" type="text/css">    
    html, body, div, form {
        margin: 0;
        padding: 0;
    }
    input{
        margin: 0;
        padding: 0;    
    }
</style>
</head>

<body>
<span style="font-family:Arial; color:#000000; font-size:8pt;">
    <input type="radio" name="blah" value="7">MyWord<br>
</span>
</body> 
```

在**IE**中，该`radio`按钮**在边距应位于的位置有一个额外的空白区域`0`**。所以应该非常接近的文本`radio`不是。

我知道如果我使用该`DOCTYPE`语句它可以工作，但由于其他问题，我不能使用它。

有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T04:39:11.083

将单选按钮元素的宽度设置为足够小的值：

```
<input type="radio" name="blah" value="7" style="width: 13px"> 
```

您看到的间距既不是填充也不是边距，而是单选按钮渲染的一部分（如果您在 IE 中按 F12，然后在“HTML”下找到元素并查看布局描述 - 元素，则可以看到）。

似乎浏览器通常将单选按钮和复选框实现为 13 × 13 像素（总尺寸），除了 Quirks 模式下的 IE，它使用 20 × 20，除非在 CSS 中另外设置尺寸。

# php - 如何在 php 中重命名带有日期时间戳的文本文件？

> ID：11478389
> 
> 赞同：0
> 
> 时间：2012-07-13T21:06:32.103
> 
> 标签：php

我是 php 和一般编程的新手，所以请原谅我对这一点的无知。我正在尝试重命名使用日期时间戳创建的文本文件，但似乎无法正确处理。在有人提交数据后，我正在将信息写入文本文件，这很有效，但我需要使每个文本文件都是唯一的，所以我需要一个唯一的命名约定。我什至尝试使用条目的名字，但我也无法让它工作。这是我到目前为止所拥有的：

```
<?php
$FirstName = $_POST["fname"].PHP_EOL;
$LastName = $_POST["lname"].PHP_EOL;
$Address = $_POST["address"].PHP_EOL; 
$City = $_POST["city"].PHP_EOL; 
$State = $_POST["st"].PHP_EOL; 
$Zip = $_POST["zip"].PHP_EOL; 
$Tel = $_POST["tel"].PHP_EOL; 

$AddressFile = "Address_Entries.txt";
$ourFileHandle = fopen($AddressFile, "a") or die("can't open file");

$date = new DateTime();
echo $date->format('Y-m-d H:i:sP') . "\n";

fwrite($ourFileHandle, $FirstName);
fwrite($ourFileHandle, $LastName);
fwrite($ourFileHandle, $Address);
fwrite($ourFileHandle, $City);
fwrite($ourFileHandle, $State);
fwrite($ourFileHandle, $Zip);
fwrite($ourFileHandle, $Tel);
fclose($ourFileHandle);
echo "<p>File has been writtten to successfully!</p>";

rename("C:/xampp/security/htdocs/testes/Address_Entries.txt", $FirstName);
?> 
```

任何帮助表示赞赏。谢谢！

*   一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:07:54.610

如果您需要一个唯一的 ID 来命名文件，请尝试[`uniqid()`](http://php.net/uniqid)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:11:16.860

在 Windows 中，您必须使用正确的路径：

```
rename("C:\\xampp\\security\\htdocs\\testes\\Address_Entries.txt", "C:\\xampp\\security\\htdocs\\testes\\$FirstName.txt"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:12:28.137

这将使用时间戳重命名文件。但是一个独特的命名约定，这很有可能是唯一的，但不是唯一的。如果有人要在同一时间发帖……名字相同……你会有重复的文件。

现在机会大吗？不。

```
<?php
$file = '/tmp/this-is-temp-file.txt';
$firstName = 'BeepBeep';
$timestamp = time();
rename($file, '/path/to/new/file/'.$firstName.'-'.$timestamp.'.txt');
?> 
```

可能尝试合并一个 uniqid() 函数。我认为它不再是唯一的，因为它使用 time() （我认为）......但最好用唯一的计数器填充它（比如数据库中的 ID）

这假设：a）您可以访问完整路径 b）PHP 可以访问该文件！您可能能够写入文件，但可能没有足够的权限来移动、删除、重命名、编辑..

# wpf - 从 xaml 引用 xaml 资源对象

> ID：11478397
> 
> 赞同：0
> 
> 时间：2012-07-13T21:07:10.107
> 
> 标签：wpf, xaml, object, reference, resources

```
 <Application.Resources>  
    <local:DataModel x:Key="Model" x:Name="ModelName" />  
    <local:Communicator x:Key="Comm1" Model="{x:Reference ModelName}" />  
  </Application.Resources>  

public class Communicator  
{          
    public DataModel model = null;  

    public DataModel Model  
    {  
        get { return model; }  
        set { model = value; }  
    }  
    // .........  
} 
```

我想将对象引用传递给另一个对象的属性或构造函数。但它不工作？有没有人有任何想法这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:09:29.903

`StaticResource`与`x:Key`. _

```
 Model="{StaticResource Model}" 
```

资源中的名称通常没有那么有用。

# java - 带有文本和图像的 ListView - 如果不存在图像，我可以更改 XML（或参数）吗？

> ID：11478401
> 
> 赞同：0
> 
> 时间：2012-07-13T21:07:32.753
> 
> 标签：java, android, xml, listview

我在 listView 中有一个文章列表，左侧是文本，右侧是图像。如果文章没有图片，我希望文本是全角的（而不是 60dp 的 marginRight）。

我的 noob-java 思维过程是：我已经在循环并检查是否有图像......（如果有，我会更改显示的图像）在该循环中，我可以以某种方式使用 java 来更改 XML我的视图添加或删除 imageView 并添加或删除边距？

我用来重复和更改图像的代码：

```
 ImageLoader imageLoader = ImageLoader.getInstance();

    imageLoader.displayImage("", viewHolder.thumbView); //clears previous one
    if(article.filepath != null && article.filepath.length() != 0) {
        imageLoader.displayImage(
            "http://img.mysite.com/processes/resize.php?image=" + article.filepath + "&size=100&quality=70",
            viewHolder.thumbView
            );
    } 
```

我的“article_entry_list_adapter.xml”：

```
<?xml version="1.0" encoding="utf-8"?>

<!-- Layout for individual news entries in a list -->
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:padding="10dp" >

<!-- Title of the news entry -->
<TextView
    android:id="@+id/article_title"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginRight="60dp"
    android:textSize="13sp"
    android:textStyle="bold"
    android:textColor="@drawable/list_title_selector" android:typeface="serif"/>

<!-- Subtitle contains author and date -->
<TextView
    android:id="@+id/article_subtitle"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginRight="60dp"
    android:layout_alignLeft="@id/article_title"
    android:layout_below="@id/article_title" 
    android:textSize="11sp"
    android:textColor="@drawable/list_subtitle_selector" />

<com.sltrib.views.WebImageView
    android:id="@+id/article_thumbnail"
    android:layout_width="50dp"
    android:layout_height="50dp"
    android:adjustViewBounds="true"
    android:layout_alignParentRight="true"
    android:background="@color/super_light_gray"
    android:padding="1dp"
    android:scaleType="centerCrop" android:cropToPadding="true"/>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:28:23.837

我建议将您的 xml 布局更改为以下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:padding="10dp" >

<!-- Title of the news entry -->

<com.sltrib.views.WebImageView
    android:id="@+id/article_thumbnail"
    android:layout_width="50dp"
    android:layout_height="50dp"
    android:layout_alignParentRight="true"
    android:adjustViewBounds="true"
    android:background="@color/super_light_gray"
    android:cropToPadding="true"
    android:padding="1dp"
    android:scaleType="centerCrop"
    />

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginRight="5dip"
    android:layout_toLeftOf="@id/article_thumbnail"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/article_title"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Titol"
        android:textColor="@drawable/list_title_selector"
        android:textSize="13sp"
        android:textStyle="bold"
        android:typeface="serif" />

    <TextView
        android:id="@+id/article_subtitle"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Subtitol"
        android:textColor="@drawable/list_subtitle_selector"
        android:textSize="11sp" />

</LinearLayout> 
```

然后，当没有图像时，只需将`WebImageView`可见性设置为`GONE`，文本将采用父级的宽度。

用你的例子：

```
viewHolder.thumbView.setVisibility(View.VISIBLE); //to show the image
viewHolder.thumbView.setVisibility(View.GONE); //to hide the image 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:11:20.210

就在循环 article_thumbnail 的 setVisiblity(VIEW.Gone) 时。

```
TextView textView = (TextView) findViewById(R.id.textView1);

    LinearLayout.LayoutParams llp = new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
    llp.setMargins(50, 0, 0, 0); // llp.setMargins(left, top, right, bottom);
    textView.setLayoutParams(llp); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:11:29.013

您可以更改 viewGroup（将 imageView 的可见性设置为 GONE 并以编程方式添加边距）或选择膨胀另一个 xml。如你所愿 =)

# r - ggplot：一种颜色/类的多行

> ID：11478402
> 
> 赞同：7
> 
> 时间：2012-07-13T21:07:40.997
> 
> 标签：r, ggplot2

我正在尝试将多条线绘制为 ggplot2 中单个“类”的一部分。我可以绘制如下内容：

![包含 5 个类别的图像](../Images/0cd78ab08e9ea71f2d984f67ee2a281a.png)

但我的问题是我想将 n1、n2 和 n3 显示为一个类（图例中每个类都有一个灰色细线）。

我的问题是，如果我在数据框中创建一个新因子以便对它们进行分组，我最终会绘制从 n1 末尾（右上角）到 n2 开头（左下角）的加法连接，这会添加一条对角线我的图表：

![一类图](../Images/756c16685e953c5b93e26438f424a3d6.png)

这更接近我想要的，但有额外的对角线。如果重要，我将使用 ROCR 计算这些，然后从结果`performance`对象中提取 x 和 y 点以生成这些线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:33:41.280

这是一种方法，但我认为您不会非常喜欢它：

```
d1 <- data.frame(x = 1:10,
                 y = rep(1:2,each = 5),
                 grp = factor(rep(letters[1:2],each = 5),levels = letters[1:3]))
d1 <- rbind(d1,data.frame(x = 1:2,y = c(NA,NA),grp = c('c','c')))

d2 <- data.frame(x = 1:15,
                 y = rep(3:5,each = 5),
                 grp = rep(1:3,each = 5))   

ggplot() + 
    geom_line(data = d1,aes(x = x,y = y,group = grp,colour = grp)) + 
    geom_line(data = d2,aes(x = x,y = y,group = grp),colour = "blue") 
```

![在此处输入图像描述](../Images/7ddfe685fa8334d0b081c38bd030a1f3.png)

请注意，您的解决方案不适用于其他类型的数据。碰巧，您要合并到图例中同一类别的三行中的每一行都在基本相同的位置开始和结束。如果不是这种情况，您最终会得到不需要的连接线。

上面的方法会更普遍，但正如你所看到的那样尴尬。如果有的话，那就更不方便了。

这种问题已经出现过很多次，可能是我忘记了一个更简单的解决方案。但总的来说，请记住，为了换取**ggplot2**让您不必手动构建每个图例，与基本图形相比，您（经常，但并非总是）牺牲了一些灵活性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:18:12.813

尝试绘制此图时，我已将`rbind`ROCR 对象中的项目直接放入 data.frame 中。`performance`我意识到我可以通过颠倒中间类数据的顺序来缩短从右上角到左下角的行程。IE

```
n1 <- getPerformance(test1)
n2 <- getPerformance(test2)
n3 <- getPerformance(test3) 
```

将创建三个看起来像的数据框

```
 type x           y
1   n1 0 0.000000000
2   n1 0 0.003448276
3   n1 0 0.006896552
4   n1 0 0.010344828
5   n1 0 0.013793103
6   n1 0 0.017241379
...
26565   n1 0.9999619 1
26566   n1 1.0000000 1 
```

这里的问题是，当我将 n1 绑定到 n2 时，我会将 n1 的点 (1,1) 连接到 n2 的点 (0,0) - 创建对角线。

在我的情况下，一个（草率的）解决方案是仅仅颠倒每隔一行的顺序，这样就没有对角线了。

```
n2_rev <- n2[nrow(n2):1,]
ns <- rbind(n1,n2_rev,n3) 
```

所以现在这条线来回走动，而不是始终在同一位置开始和结束，创建以下图表：

![想要的图表](../Images/988d8726866a7fc5f21d7a1f4cfd78ac.png)

尽管如此，我认为有一种更通用的方法来处理这个问题。有没有一种好方法可以在 ggplot2 图中添加一条线，例如`lines()`base R 的函数？

# database - 良好的数据库设计 - 存储时间戳的位置

> ID：11478407
> 
> 赞同：1
> 
> 时间：2012-07-13T21:07:58.837
> 
> 标签：database, timestamp

我想知道在数据库中存储时间戳的最佳或最有效方法在哪里？

我在想也许我可以为它创建自己的表 - 但是给它自己的调用似乎有点低效。

基本上，整个数据库现在只需要一个时间戳（尽管以后可能需要扩展）来判断它是否正在解析它已经拥有的数据。

最好的方法是什么（最有效，不要试图含糊其辞，如果这是一个争论点）

基本上，如果您需要存储一个且仅一个日期，最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T22:26:43.083

您可以创建一个只有一列和一行的表。这很正常，但请确保此类表不会像蒲公英一样开始出现在您的数据库中。

对你的方案要非常小心“判断它是否正在解析它已经拥有的数据”。最好为数据使用一些 ID，这些 ID 不依赖于所有数据库客户端或数据的其他生产者是否具有同步时钟、该时间是否永远不会向后调整、相同数据是否存在于多个不兼容的修订版中、哪些时区所有组件都在运行，所涉及的任何时钟的分辨率和精度是多少。

# java - 迷宫递归解决StackOverflow错误

> ID：11478409
> 
> 赞同：4
> 
> 时间：2012-07-13T21:08:09.743
> 
> 标签：java, algorithm, maze

我正在尝试使用递归解决迷宫。它被宣布`Cell [][] maze`。

```
public class Cell {
    private Wall left;
    private Wall right;
    private Wall up;
    private Wall down;
    private boolean end;

    // Setters and getters not shown
} 
```

如果单元格的某侧没有`Wall`，则它具有 value `null`，否则它引用一个`Wall`对象。`Wall`引用是一致的：与单个墙相邻的两个单元格都使用适当的字段引用它。如果缺少一堵墙，则两个相邻单元格都有相应的`null`条目。这是搜索：

```
public boolean solveMaze(Cell[][] maze, int i, int j) {

    if (maze[i][j].isEnd()){
        System.out.println(maze[i][j].toString());
        return true;
    }
    if (maze[i][j].getDown() == null) {
        return solveMaze(maze, i, j + 1); 
    }
    if (maze[i][j].getUp() == null) {
        return solveMaze(maze, i, j - 1) ;
    }
    if (maze[i][j].getLeft() == null) {
        return solveMaze(maze, i - 1, j);
    }
    if (maze[i][j].getRight() == null) {
        return solveMaze(maze, i + 1, j) ;  
    }
    return false;
} 
```

我收到一个`Stack Overflow`错误。我的递归停止条件有什么问题？

**更新：**

在您高度赞赏的帮助下，我解决了这个问题：这是完美无缺的正确解决方案：

```
public boolean solveMaze(Cell[][] maze, int i, int j){

    if (maze[i][j].isEnd()){
        System.out.println("Maze Exit :["+i+","+j+"]" );
        return true;
    }

    if (maze[i][j].isVisited()){
        return false;
    }

    maze[i][j].setVisited(true);

    if ((maze[i][j].getButtom() == null) ){
        if (solveMaze(maze,i,j+1)==true)
            return true;
    }

    if ((maze[i][j].getUp() == null) ){
    if ( solveMaze(maze,i,j-1) ==true )
        return true;
    }

    if ((maze[i][j].getLeft() == null)){
        if (solveMaze(maze,i-1,j))
            return true;
    }

    if ((maze[i][j].getRight() == null)){
        if (solveMaze(maze,i+1,j)) 
            return true;
    }

    maze[i][j].setVisited(false);
    return false;
} 
```

将来可能对任何机构都有帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T21:14:40.333

如果迷宫有一个循环，求解器可以永远围绕这个循环运行，这将导致您看到的堆栈溢出。您需要一种方法来确定您何时看到一个已经看过的迷宫广场。在这种情况下，您应该立即回溯。

这可以通过将`visited`每个单元格中的布尔标志初始设置为 false 然后为您搜索的每个方格设置为 true 来完成，或者您可以维护一个单独`Set`的`(i,j)`已搜索对，最初为空。

注意：您对`i`and的使用`j`是非常规的。如果其他人使用常规用法编写迷宫阅读代码，这可能会导致问题。在数学中，`i`通常用于行号和`j`列。使用此约定，您的墙壁测试与您的增量和减量不一致。例如，缺少底墙将需要您增加`i`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-13T21:11:38.213

在我看来，您似乎在求解器方法中绕圈子。
我建议您熟悉[广度优先搜索](http://en.wikipedia.org/wiki/Breadth-first_search)，它通常用于不太大的状态搜索问题。

如果你有一些关于如何搜索迷宫的“知识”，一种启发式方法，那么你也可以看看[A-Star Search](http://en.wikipedia.org/wiki/A%2a_search_algorithm)

* * *

BFS 在您的情况下可以做的如下：（顺便说一句，请善待并使用适当的构造器、获取器和设置器）

```
public class Cell {
    public int x;
    public int y;
    public Cell parent;

    @Override
    public boolean equals(Object obj) {
        // TODO Override equals so it only incudes x and y coorinates, and not parent
        return true;
    }

    @Override
    public int hashCode() {
        // TODO Override hash code as well
        return 0;
    }
} 
```

* * *

```
public Cell seachFor(Cell start, Cell finish) {
    Queue<Cell> open = new LinkedList<>();
    Set<Cell> closed = new HashSet<>();

    open.add(start);

    while (!open.isEmpty()) {
        Cell current = open.poll();
        if (current.equals(finish)) {
            return current;
        }

        closed.add(current);

        for (Cell neighbour : getNeighbours(current)) {
            if (!closed.contains(neighbour)) {
                open.add(neighbour);
            }
        }
    }

    return null;

} 
```

* * *

```
private List<Cell> getNeighbours(Cell current) {
    /* TODO Set the neighbour's "parent"
     * Return valid adjacent neighbour cells
     */
    return null;
} 
```

* * *

```
public Deque<Cell> pathfinder(Cell start) {
    Deque<Cell> path = new ArrayDeque<>();
    path.push(start);

    Cell current = start;

    while (current.parent != null) {
        current = current.parent;
        path.push(current);
    }

    return path;
} 
```

* * *

```
public static void main(String[] args) {
    Cell start = maze.getStart();
    Cell finish = maze.getFinish();
    Deque<Cell> path = pathFinder(searchFor(start, finish))
    while (!path.isEmpty()) {
        Cell current = path.pop();
        maze.moveTo(current);
    }
} 
```

* * *

请注意，这是一个模拟代码，您需要在它工作之前对其进行改进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T21:15:16.400

您的代码中没有任何内容可以检测您以前去过的地方。如果您的迷宫包含任何您可以绕一圈或循环回到您以前去过的地方而无需回溯的任何通道，它将继续无限地沿着同一条路径递归。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T21:17:04.613

您在堆栈上分配的内存不足。也就是在给定时间超出 JVM 资源的情况下，您的递归倍增太快。

您可以增加内存，然后终止此方法的所有其他迭代，或更改您的算法。更改堆栈大小将是一个糟糕的解决方案，但即使您的代码有缺陷[如何在 Eclipse 中增加堆栈大小，](https://stackoverflow.com/questions/2127217/java-stack-overflow-error-how-to-increase-the-stack-size-in-eclipse)它也可能会起作用我建议您标记您已经访问过的区域

迷宫是`Cell[][] maze`

```
 public class Cell{
    boolean visited = false;
    Wall left;
    Wall right;
    Wall up;
    Wall bottom;
    boolean end;

    //Settters and Getters
    } 
```

每次点击时将访问变量设置为true，然后将代码更改为

```
public boolean solveMaze(Cell[][] maze, int i, int j){
        if (maze[i][j].isEnd()){
            System.out.println(maze[i][j].toString());
            return true;
        }
        if (maze[i][j].getButton() == null)&&(maze[i][j].visited==false)){
            return solveMaze(maze,i,j+1); 
        }

        if (maze[i][j].getUp() == null){
        return solveMaze(maze,i,j-1) ;
        }
        // ect 
```

除非您自己解决问题，否则我不会实施它可能能够重复相同问题的答案，但您可能无法使用类似策略对类似问题提出新的答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-13T21:18:57.133

首先，您向下走，直到到达一堵墙。然后，一个向上 - 然后再次向下。一个向上，一个向下 - 直到 java 检测到这很愚蠢并以 StackOverFlowError 停止；）

# php - 返回浏览器时未找到 AJAX、PHP 复制的文件

> ID：11478411
> 
> 赞同：0
> 
> 时间：2012-07-13T21:08:22.150
> 
> 标签：php, jquery, ajax, file-not-found

我正在使用“jQuery AJAX PHP”进行一些“.jpg”文件复制（每个文件大约 330kb）。我将文件复制到新的目录位置。

当我返回 HTML 并使用 jQuery 将 IMG 标记添加到 Table 元素时，我复制的一些文件显示为 Not Found 并出现 404 错误，但它们在那里。

我想知道这是不是速度错误。我试图通过读取文件被复制到的目录来减慢 PHP 的返回速度，但这似乎没有帮助。

我是否认为这是一个速度问题，是否有人知道如何克服这个问题，因为只有通过显示复制的文件，我才能确定它已被复制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:12:30.120

有时我在不加载图像时遇到同样的问题。如果您打算使用 jQuery，我建议您将脚本（加载图像）放入

```
$(document).ready(function() {
    // put all your jQuery goodness in here.  
 }); 
```

事实上，当您想要显示或使用它进行操作时，您的 DOM 对象还没有准备好。

别忘了打电话

```
<script type="text/javascript"
 src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script> 
```

在 HTML 的头部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:19:40.617

在尝试了这里建议的各种选项和其他一些选项后，我进行了研究，我决定尝试将图像的显示放在与 AJAX/PHP 不同的函数中。换句话说，我没有在 AJAX 调用的结果函数中处理图像，而是将成功函数的结果传递给另一个函数。

这似乎治愈了我未找到的显示。

这可能是一个巧合，还有其他事情发生，因为我对 DOM 的流程知识非常贫乏。

# javascript - 在 Parse 中滚动您自己的独特电子邮件检查

> ID：11478420
> 
> 赞同：1
> 
> 时间：2012-07-13T21:09:19.493
> 
> 标签：javascript, backbone.js, parse-platform

推出我自己独特的电子邮件检查方法。使用 .equalTo 和 .find 即使数据库中没有任何内容，我仍然可以成功。如果找不到匹配项，我需要它出错。有任何想法吗？

```
 // Check if email is already in use
  var query = new Parse.Query(Email);
  query.equalTo("email", email);
  query.find({
    success: function(results) {
      self.$(".signup-form .error").html("Email already in use.").show();

      this.$(".signup-form button").removeAttr("disabled");
    },
    error: function(error) {
      if (error.code === Parse.Error.OBJECT_NOT_FOUND) {
        alert("Perfect, could not find this email!");

        Parse.User.signUp(username, password, { ACL: new Parse.ACL() }, {
          // ... signUp method here ...
        });
      } else if (error.code === Parse.Error.CONNECTION_FAILED) {
        alert("Uh oh, we couldn't even connect to the Parse servers!");
      }
    }
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:41:56.613

即使没有找到符合您条件的对象，find 方法也会成功返回。您可以检查 results 是否有任何对象（如果没有收到电子邮件，则不应该），但您可能正在寻找的是[.first() 方法](https://www.parse.com/docs/js_guide/#queries-constraints)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:05:23.693

此外，您是否考虑过在 Parse 中使用实际的[User 类？](https://parse.com/docs/js_guide#users)这将自动强制执行电子邮件唯一性，并为您提供许多更重要的功能，例如安全密码存储、（可选）电子邮件验证、密码重置 API、访问控制和社交集成。

# java - 在多个输出中播放音频

> ID：11478426
> 
> 赞同：0
> 
> 时间：2012-07-13T21:09:48.340
> 
> 标签：java, audio

我需要在不同的音频输出中播放音乐。例如，我有两首音乐：music1 和 music2，它们必须在不同的扬声器中以不同的线程播放。假设我有不止一个能够播放声音的音频设备：

我找到了这个方法（[这里](http://www.javazoom.net/jlgui/api.html)- 它是 BasicPlayer）：

```
protected void createLine() throws LineUnavailableException
{
    log.info("Create Line");
    if (m_line == null)
    {
        AudioFormat sourceFormat = m_audioInputStream.getFormat();
        log.info("Create Line : Source format : " + sourceFormat.toString());
        int nSampleSizeInBits = sourceFormat.getSampleSizeInBits();
        if (nSampleSizeInBits <= 0) nSampleSizeInBits = 16;
        if ((sourceFormat.getEncoding() == AudioFormat.Encoding.ULAW) || (sourceFormat.getEncoding() == AudioFormat.Encoding.ALAW)) nSampleSizeInBits = 16;
        if (nSampleSizeInBits != 8) nSampleSizeInBits = 16;
        AudioFormat targetFormat = new AudioFormat(AudioFormat.Encoding.PCM_SIGNED, sourceFormat.getSampleRate(), nSampleSizeInBits, sourceFormat.getChannels(), sourceFormat.getChannels() * (nSampleSizeInBits / 8), sourceFormat.getSampleRate(), false);
        log.info("Create Line : Target format: " + targetFormat);
        // Keep a reference on encoded stream to progress notification.
        m_encodedaudioInputStream = m_audioInputStream;
        try
        {
            // Get total length in bytes of the encoded stream.
            encodedLength = m_encodedaudioInputStream.available();
        }
        catch (IOException e)
        {
            log.error("Cannot get m_encodedaudioInputStream.available()", e);
        }
        // Create decoded stream.
        m_audioInputStream = AudioSystem.getAudioInputStream(targetFormat, m_audioInputStream);
        AudioFormat audioFormat = m_audioInputStream.getFormat();
        DataLine.Info info = new DataLine.Info(SourceDataLine.class, audioFormat, AudioSystem.NOT_SPECIFIED);
        Mixer mixer = getMixer(m_mixerName);
        if (mixer != null)
        {
            log.info("Mixer : "+mixer.getMixerInfo().toString());
            m_line = (SourceDataLine) mixer.getLine(info);
        }
        else 
        {
            m_line = (SourceDataLine) AudioSystem.getLine(info);
            m_mixerName = null;
        }
        log.info("Line : " + m_line.toString());
        log.debug("Line Info : " + m_line.getLineInfo().toString());
        log.debug("Line AudioFormat: " + m_line.getFormat().toString());
    }
} 
```

通过一点调试，我发现混音器始终为空。这是为什么？调音台不应该是通过目标线路输出声音的设备吗？这个程序总是在我电脑上设置的默认设备中播放，我该怎么做才能改变呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T16:47:40.083

实际上，我刚刚开始为我自己的一个项目使用 Java Sound API，但据我了解，Mixer 只是一个接口，而不是一个对象。这可以解释你的问题的一部分。

# java - Java 正则表达式帮助：捕获键值对

> ID：11478437
> 
> 赞同：4
> 
> 时间：2012-07-13T21:10:43.830
> 
> 标签：java, regex, parsing

我正在尝试从具有以下形式的字符串中捕获键值对：

```
a0=d235 a1=2314 com1="abcd" com2="a b c d" 
```

使用[这篇文章的](https://stackoverflow.com/questions/168171/regular-expression-for-parsing-name-value-pairs)帮助，我能够编写以下捕获键值对的正则表达式：

```
Pattern.compile("(\\w*)=(\"[^\"]*\"|[^\\s]*)"); 
```

问题是该模式中的第二组也捕获了引号，如下所示：

```
a0=d235
a1=2314
com1="abcd"
com2="a b c d" 
```

如何排除引号？我想要这样的东西：

```
a0=d235
a1=2314
com1=abcd
com2=a b c d 
```

**编辑：**

根据是否有引号，可以通过捕获不同组中的值来实现上述目的。我正在为解析器编写此代码，因此出于性能原因，我试图提出一个可以返回同一组号中的值的正则表达式。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T21:34:27.427

这个怎么样？这个想法是将最后一组分成两组。

```
Pattern p = Pattern.compile("(\\w+)=\"([^\"]+)\"|([^\\s]+)");

String test = "a0=d235 a1=2314 com1=\"abcd\" com2=\"a b c d\"";
Matcher m = p.matcher(test);

while(m.find()){
    System.out.print(m.group(1));
    System.out.print("=");
    System.out.print(m.group(2) == null ? m.group(3):m.group(2));
    System.out.println();
} 
```

**更新**

这是针对更新问题的新解决方案。这个正则表达式应用了积极的前瞻和后瞻来确保有一个引用而不实际解析它。这样，上面的第 2 组和第 3 组可以放在同一个组中（下面的第 2 组）。返回组 0 时无法排除引号。

```
Pattern p = Pattern.compile("(\\w+)=\"*((?<=\")[^\"]+(?=\")|([^\\s]+))\"*");

String test = "a0=d235 a1=2314 com1=\"abcd\" com2=\"a b c d\"";
Matcher m = p.matcher(test);

while(m.find()){
    print m.group(1);
    print "="
    println m.group(2);
} 
```

输出

```
a0=d235
a1=2314
com1=abcd
com2=a b c d 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:28:20.080

使用此正则表达式`(\w+)=(("(.+?)")|(.+?)(?=\s|$))`键和值包含在正则表达式组中

# javascript - 在没有 jQuery UI 主题的对话框中插入 HTML 表格

> ID：11478438
> 
> 赞同：0
> 
> 时间：2012-07-13T21:10:45.160
> 
> 标签：javascript, jquery, html, jquery-ui

我有一个 HTML 表格，它使用自定义样式表进行了非常特殊的格式化。想法是使用 jQuery UI 对话框，以便在单击链接时显示此表。

但是，当表格显示在对话框中时，我已经完成了这项工作，jQuery UI 的样式表会覆盖我的表格自定义样式表（这是正常功能）。本质上，我想将对话框用作保存自定义表的“容器”。我无法找到适当的解决方法来完成此操作。

有没有办法在 jQuery UI 对话框中显示表格 - 或任何其他元素 - 并保持其原始格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:23:00.367

您可以将自定义表格加载到 iframe 中......

但一个不那么难看的解决方案是让 CSS 的优先级高于 JQuery UI CSS 的优先级。这可以通过更具体或用 !important 指示符覆盖它来获得。

您还可以从 JQuery UI 样式表中删除相关样式。

如果它们是内联样式，我发现唯一可行的方法是使用 javascript 重新分配 css 或在 JQuery UI 执行后使用 javascript 删除内联样式，或修改 JQuery UI 本身。

# javascript - 模态窗口改为警报

> ID：11478441
> 
> 赞同：2
> 
> 时间：2012-07-13T21:11:14.493
> 
> 标签：javascript, jquery

我需要修改这个脚本，以便在允许的字符数结束时，用户可以看到一个模态警告窗口，而不是警告窗口，该窗口在 N 秒后消失。在这种情况下，光标应该冻结在适当的位置，并且无法进一步输入。提前感谢您的建议。

这是我的代码：

```
<!DOCTYPE html>
<html lang="en">
<head>
<title>Textbox</title>
<script type="text/javascript" src="http://ajax.googleapis.com/
ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function()
{
$("#contentbox").keyup(function()
{
var box=$(this).val();
var main = box.length *100;
var value= (main / 145);
var count= 145 - box.length;

if(box.length <= 145)
{
$('#count').html(count);
$('#bar').animate(
{
"width": value+'%',
}, 1);
}
else
{
alert(' Stop! ');
}
return false;
});

});
</script>
<style>
#barbox
{
float:right!; 
height:14px; 
background-color:#FFFFFF; 
width:100px; 
border:solid 2px #000; 
margin-right:3px;
margin-bottom:10px;
overflow: inherit;
}
#bar
{
background-color:#ff0000;
width:0px;
height:14px;
}
#count
{
float:right; margin-right:8px; 
font-family:'Georgia', Times New Roman, Times, serif; 
font-size:16px; 
font-weight:bold; 
color:#333;
}
#contentbox
{
width:450px; height:50px;
border:solid 2px #006699;
font-family:Arial, Helvetica, sans-serif;
font-size:14px;
}
</style>
    </head>
    <body>
<div>
<div id="count">145</div>
<div id="barbox"><div id="bar"></div></div>
</div>
<textarea id="contentbox"></textarea>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:16:10.277

您可以使用 jQuery 库创建一个模态对话框：http: [//jqueryui.com/demos/dialog/#modal](http://jqueryui.com/demos/dialog/#modal)

这是使用您的代码的示例：http: [//jsfiddle.net/ZZsTS/](http://jsfiddle.net/ZZsTS/)

**JS**

```
$( "#dialog-modal" ).dialog({
  height: 140,
  modal: true,
  autoOpen: false,
  //set a timeout of 3 secs to close it again, when opened
  open: function(event, ui) {
    setTimeout("$('#dialog-modal').dialog('close')", 3000);
  },
  //when closing, make the textarea readonly
  close : function(){
    $('textarea').attr('readonly', 'readonly');
  }
}); 
```

**打开对话框**

```
$('#dialog-modal').dialog('open'); 
```

**HTML**

```
<textarea></textarea>

<div id="dialog-modal" title="Basic modal dialog">
  <p>Stop !</p>
</div> 
```

# php - 从另一个函数内的开关函数返回变量

> ID：11478449
> 
> 赞同：0
> 
> 时间：2012-07-13T21:11:58.657
> 
> 标签：php, switch-statement

我有这个基本功能`getdetails()`，我简化了代码，很容易理解我需要什么。我希望能够回显（或使用）函数`title`或`lname`函数之外的值`getdetails`。任何帮助将不胜感激

```
function getdetails ($var){
    $title = "Hello World";
    $lname = "John Doe";
    switch ($var)
    {
        case "title":return $title; break;
        case "lastname":return $lname; break;
    }
}

echo "title is: ".$title; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:13:53.523

`getdetails`返回一个值。要获得该值，请将其分配给如下变量：

```
$title = getdetails('title'); 
```

然后您可以将其用作任何其他变量

```
echo "title is: " . $title; 
```

# html - 选择 optgroup 标题作为选项

> ID：11478450
> 
> 赞同：0
> 
> 时间：2012-07-13T21:11:59.793
> 
> 标签：html, css, drop-down-menu, webkit, hierarchy

我在下拉列表中有一个像这样组织的数据树（但还有更多选项）：

```
 pizza
   pizza.mediterranean
   pizza.veggie
   pizza.meatlover
 drinks
   drinks.soda
     drinks.soda.pepsi
     drinks.soda.coke
   drinks.beer
   drinks.water 
```

我希望较大的类别（比萨饼、饮料）显示为 optgroup，但我希望能够在下拉列表中选择 optgroup 作为选项。我在多个地方阅读过的是 optgroups 仅用于分组，不能选择。

因为我还想要不止一级的缩进，让下拉菜单看起来尽可能接近上面的例子——也许 optgroups 不是要走的路，而是一个 css 解决方案。在 Firefox 中，我可以通过向选项添加样式并使它们变为粗体和/或具有左填充来做我想做的事情，但似乎在 webkit 中，我可以在下拉列表中更改选项的唯一属性是它们的颜色。

有谁知道我如何在 webkit (chrome/safari) 和 firefox 中使用 optgroups、css 或其他任何东西来实现这种效果 --- (我现在并不关心 IE)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:15:05.067

您可能只想使用低技术：

```
<select>
<option>Root</option>
<option>&nbsp;&nbsp;Second level</option>
<option>&nbsp;&nbsp;&nbsp;&nbsp;Third level</option>
</select> 
```

您正在达到使用真实选择所能做的极限。从概念上讲，这些选择小部件是由操作系统绘制的（尽管一些浏览器 - Firefox - 有自己的实现），因此样式选项是有限的。

有很多不错的选择替代品。我最熟悉的是 jqueryui 的[autocomplete](http://jqueryui.com/demos/autocomplete/)。它既快速又灵活，您可以随意设置选项的样式。可以想象其他使用 jquery 或其他工具包的本土解决方案 - 或普通的 'ol javascript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T06:28:25.293

使用一组单选按钮（或复选框，如果要允许多个选择）而不是一个`select`元素，您可以像任何其他内容一样组织和设置样式，例如使用缩进和粗体。不过，它不会充当下拉菜单，但这实际上可以提高可用性和可访问性。

# uitableview - 从网上阅读.plist

> ID：11478452
> 
> 赞同：0
> 
> 时间：2012-07-13T21:12:14.520
> 
> 标签：uitableview, plist, nsurlconnection

我遵循了本教程：[http ://www.iphonedevcentral.com/hello-uitableview/](http://www.iphonedevcentral.com/hello-uitableview/)

我已经让它工作得很好，但我不太清楚如何通过在线访问他们包含的 plist 来使其工作。

他们的 plist 位于：[http ://www.iphonedevcentral.com/wp-content/uploads/2009/07/TestData.plist](http://www.iphonedevcentral.com/wp-content/uploads/2009/07/TestData.plist)

他们教程的源代码在这里：[http ://www.iphonedevcentral.com/wp-content/uploads/2009/07/MyDVDLibrary01.zip](http://www.iphonedevcentral.com/wp-content/uploads/2009/07/MyDVDLibrary01.zip)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-16T09:07:12.217

就我所见，该练习中对文件的调用指的是内部资源：

```
libraryContent = [[NSArray alloc] initWithContentsOfFile:[[NSBundle mainBundle] 
                                                              pathForResource:libraryPlist ofType:@"plist"]]; 
```

为了让它工作，您需要从服务器下载 TestData.plist 文件并将其复制到您的 Xcode 项目中。如果要从服务器加载文件，则必须使用以下内容更改这些行：

```
libraryContent = [[NSArray alloc] initWithContentsOfURL:[NSURL URLWithString:@"http://www.iphonedevcentral.com/wp-content/uploads/2009/07/TestData.plist"]]; 
```

# redirect - 时间间隔后页面重定向

> ID：11478454
> 
> 赞同：1
> 
> 时间：2012-07-13T21:12:24.567
> 
> 标签：redirect, time, intervals

朋友点击按钮。链接#1 在新窗口中弹出。查看链接#1 10 秒后，它会在同一窗口中重定向到链接#2。它查看 Link #2 10 秒，然后重定向到 Link #3，重复。我该怎么做呢...？

我很难弄清楚这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:19:36.267

将此添加到Link#1 页面的**头部：**

```
<meta http-equiv="refresh" content="10;url=http://address-ofLinnk#2-page"> 
```

10 秒后，它将转发到您指定的 url。

# vim - Vim 缓冲区面包屑插件

> ID：11478456
> 
> 赞同：4
> 
> 时间：2012-07-13T21:12:28.493
> 
> 标签：vim

Vim 中是否有任何插件可以让您按顺序浏览已打开的缓冲区列表？`Ctrl-6`为两个文件做这件事，但我想要做更多的事情。例如，如果我按顺序打开缓冲区 a、b、c、d，我想键入一些内容以返回到 c、返回到 b、再次转发到 c，等等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T21:13:24.273

这可以通过内置的 vim 命令获得：`bprevious`and `bnext`, or `bp`and `bn`。

使用您的示例，打开文件，然后键入以使用*c*`:bp`转到缓冲区，然后您在缓冲区*b*中，然后返回缓冲区*c*。*`:bp`*`:bn`**

 ***也很方便：输入 eg`:b1`转到缓冲区 1（如果存在），然后`:b myFile.txt`转到包含文件名的缓冲区`myFile.txt`。

`bprevious`并`bnext`始终遵循缓冲区列表的顺序。您可以使用命令观察此排序`:ls`。请注意，每个缓冲区都分配了一个递增的数字。*无论*您在多少个窗口和/或标签之间移动，`bprevious`都`bnext`将遵循此顺序。

 *例如，如果您已按照示例打开*a, b, c, d*，并且您有两个拆分窗口，第一个带有缓冲区*a*，第二个带有缓冲区*b*，`bnext`则第一个窗口中的 a 会将您放入缓冲区*b*中，并且第二个窗口中的a`bnext`会将您放入缓冲区*c*中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T14:17:07.817

[我找到了一个简单的插件，可以在这个问题](https://stackoverflow.com/questions/3706958/vim-navigating-to-previous-and-next-buffers-in-edit-history)中做我想要的。

[vim-bufsurf](https://github.com/ton/vim-bufsurf)****

# ruby-on-rails - Rails 虚拟属性未更新

> ID：11478464
> 
> 赞同：0
> 
> 时间：2012-07-13T21:13:08.820
> 
> 标签：ruby-on-rails, ruby, model, attributes, virtual

我有一个模型“标签”，它链接到特定主题的 dbpedia 文章。我想创建一个虚拟属性，它将使用这个 dbpedia URI 来生成一个维基百科 URI。这大概是这个类的样子：

```
class Tag < ActiveRecord::Base

  # Validation
  validates_presence_of :dbpedia_uri, :label

  #Virtual Attribute
  def wikipedia_uri
    "#{dbpedia_uri}".gsub("dbpedia.org/resource", "wikipedia.org/wiki")    
  end

end 
```

当我进入控制台并尝试检查 Tag.all[1].wikipedia_uri 时，我收到以下错误：

```
NoMethodError: undefined method `wikipedia_uri' for #<Tag:0xa0c79ac> 
```

此外，我还有第二个模型（映射），它具有可以工作的虚拟属性，但是当我更改它们时，我仍然得到旧值。所以当代码是：

```
 def thumbnail_uri
    "#{map_base_uri}/thumbnails/#{identifier}.jpg"
  end 
```

Map.all[1].thumbnail_uri 返回类似：“http://WEBSITE/maps/thumbnails/g3201b.ct002662.jpg”

当我将代码更改为：

```
def thumbnail_uri
   "test"
end 
```

我仍然得到输出：“http://WEBSITE/maps/thumbnails/g3201b.ct002662.jpg”

我已经尝试重新加载我的 Rails 控制台，但它似乎仍然没有更新虚拟属性。关于可能导致此问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:21:29.937

想通了这个问题。我愚蠢地在一个目录中运行我的控制台以获取重复的文件备份集，因此备份中的所有方法和变量都在控制台中可用，但我对当前代码的更改并没有影响它

# symfony - Symfony2：放置业务逻辑的最佳位置

> ID：11478465
> 
> 赞同：4
> 
> 时间：2012-07-13T21:13:12.600
> 
> 标签：symfony

我读到一个好的做法有实体灯，只有 getter 和 setter。但是，例如，我有一些具有某些逻辑的自定义方法。

```
public function calculatePrice(){

  /*
 Here I have to do many math operations 
 including access to other repositories to get 
 specific data (taxes, comissions, ect) from others entities
*/

} 
```

将这种“更复杂的方法”放在哪里做：

```
//in controller
$product->calculatePrice()  

//in twig templates
{{ product.calculatePrice }} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-13T22:42:42.783

我喜欢将与实体相关的业务逻辑放在服务类中。IMO，实体存储库应仅负责查询数据库以获取实体组的多个项目，或非常具体的“findBy”方法（例如：获取所有`Messages`属于`User`where `isRead = 0`）。

很多时候，您会发现自己使用多个服务类来处理特定的业务逻辑块——将所有这些都保存在服务层中而不是硬塞到存储库中更容易（也更简洁）。

将服务用于业务逻辑将导致代码更加模块化。如果您的`Product`实体和 repo 不包含任何业务逻辑（通常每个应用程序都非常具体），您可以更轻松地在其他项目中重用这些类，而无需进行大量清理。

# maven-2 - Maven：尝试为单元测试创 建内存转储

> ID：11478467
> 
> 赞同：2
> 
> 时间：2012-07-13T21:13:16.740
> 
> 标签：maven-2

我很难为产生内存不足错误的单元测试创​​建内存转储。

我的 MAVEN_OPTS 包含以下内容：

```
-Xmx1024m -XX:-HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=C:\Temp 
```

但是，当我使用“mvn install”从命令行运行单元测试时，当 OutOfMemoryError 发生时，我没有得到任何这样的内存转储。

如何获得内存转储？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T21:20:54.007

默认情况下， Maven（`surefire-plugin`准确地说）会创建新的 JVM 来运行测试。`MAVEN_OPTS`变量由运行 maven 的 JVM 本身使用，但不用于分叉测试 JVM。要更改该 JVM 的设置，请使用以下代码片段：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <!-- ... -->
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <configuration>
                    <argLine>-Xmx1024m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=C:\Temp</argLine>
                </configuration>
            </plugin>
            <!-- ... -->
        </plugins>
    </build>

</project> 
```

# php - PHP 最近浏览的产品

> ID：11478470
> 
> 赞同：1
> 
> 时间：2012-07-13T21:13:35.550
> 
> 标签：php, session, cookies

为最近查看的产品编写代码的最佳方式是什么？我使用数据库来创建动态页面，并认为我可以将 ID 号存储在会话或 cookie 中，并从数据库中提取图像和标题。虽然，我不知道这是否可行。我只希望它显示查看的最后 5 个项目而不显示任何重复项。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:21:54.937

如果用户已登录，您可以创建一个名为“userViews”的表，提供用户 ID 和查看的产品 ID。然后，您可以在 productID 上使用“SELECT DISTINCT”选择查询。这将选择唯一值。（检查[http://www.w3schools.com/sql/sql_distinct.asp](http://www.w3schools.com/sql/sql_distinct.asp)）

如果用户未登录，我建议您也这样做，但不要使用用户 ID，而是尝试从用户那里找到独特的东西。您可以尝试使用随机（唯一）数字设置 cookie 或会话并将其链接到数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T21:25:53.353

传统的方法是存储在 cookie 中。如果您可以加密 cookie，请这样做。

请记住，用户可以修改 cookie。#1 规则是永远不要相信用户输入。总而言之，请务必在显示之前**验证**信息，否则您将向攻击世界敞开大门。

将ID存储在数组中？用“，”或“。”分隔。-- 不要创建 100 个不同的 cookie 来存储 ID。

您也可以使用 SQL 来存储视图……但为什么要使用不需要的 sql 查询呢？SQL 用于长期存储。会话和 cookie 用于当前操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-04T07:45:13.530

您可以通过 3 种方式显示最近查看的产品。（也许其他方式，但主要使用这三种方式）。

1.  基于IP
2.  存储最近在 Cookie 中查看的内容
3.  会话 ID

**基于IP**

这不是一个好主意，因为有可能两个人使用同一个路由器，而没有看到产品的人会看到另一个人最近的视图。（您可以使用基于 IP 来展示您所在地区的其他人。等等）。

**基于 Cookie**

通过使用 cookie，您 100% 确定您正在向访问您网站的人显示最近的产品，但并非所有用户/访问者都启用了 cookie，如果您没有正确加密，cookie 也可以轻松编辑和安全风险。

**会话 ID**

您可以为访问者生成一个随机`user_id`数，并将此信息存储在数据库中，如下所示：

```
start_session();
if(!$_SESSION['user_id']){
$_SESSION['user_id'] = rand(1, 1000000);
mysql_query('INSERT INTO products_recent (user_id) VALUES ('.$_SESSION['userid'].')');
} 
```

此外，您可以选择/更新用户产品视图并向该用户显示。

如果需要，您可以轻松地每 24 小时清理一次数据库，或者您可以将这些数据用于分析目的。

**最后 - 注册用户**

如果注册用户查看您的产品，我强烈建议保存在数据库中，并在他/她每次访问您的商店时显示这些最近查看的产品。

谢谢，

# google-apps-script - 查找文本（多次）并突出显示

> ID：11478471
> 
> 赞同：7
> 
> 时间：2012-07-13T21:13:42.773
> 
> 标签：google-apps-script

我想在谷歌文档中找到一个单词的所有实例并突出显示它们（或评论——任何让它突出的东西）。我创建了以下函数，但它只找到单词的第一次出现（在本例中为“the”）。任何关于如何找到该词的所有实例的想法将不胜感激！

```
function findWordsAndHighlight() {
var doc = DocumentApp.openById(Id);
var text = doc.editAsText();
//find word "the"
var result = text.findText("the");
//change background color to yellow
result.getElement().asText().setBackgroundColor(result.getStartOffset(),                result.getEndOffsetInclusive(), "#FFFF00");
}; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-10-17T07:05:52.117

我知道这是一个老歌，但这是我在 Google Script 中为文本添加效果的方法。下面的示例专门用于为文档中特定字符串的所有出现添加突出显示。

```
function highlightText(findMe) {
    var body = DocumentApp.getActiveDocument().getBody();
    var foundElement = body.findText(findMe);

    while (foundElement != null) {
        // Get the text object from the element
        var foundText = foundElement.getElement().asText();

        // Where in the Element is the found text?
        var start = foundElement.getStartOffset();
        var end = foundElement.getEndOffsetInclusive();

        // Change the background color to yellow
        foundText.setBackgroundColor(start, end, "#FCFC00");

        // Find the next match
        foundElement = body.findText(findMe, foundElement);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T01:19:48.430

好的，链接你的代码可以像这样完成：

```
function findWordsAndHighlight() {
var doc = DocumentApp.openById("DocID");
var text = doc.editAsText();
var search = "searchTerm";
var index = -1;
var color ="#2577ba";
var textLength = search.length-1;

while(true)
 {
   index = text.getText().indexOf(search,index+1);
   if(index == -1)
     break;
   else text.setForegroundColor(index, index+textLength,color );
 }

}; 
```

我还有一个疑问。这段代码很好用，但为什么我必须使用 search.length-1？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-04T18:12:07.243

随着文档绑定脚本的引入，现在可以制作从自定义菜单调用的文本突出显示功能。

此脚本是根据[此答案](https://stackoverflow.com/questions/15581090/how-to-find-a-word-in-a-document-and-insert-a-url/16922406#16922406)中的脚本修改的，可以从 UI（不带参数）或脚本调用。

```
/**
 * Find all matches of target text in current document, and highlight them.
 *
 * @param {String} target     (Optional) The text or regex to search for. 
 *                            See Body.findText() for details.
 * @param {String} background (Optional) The desired highlight color.
 *                            A default orange is provided.
 */
function highlightText(target,background) {
  // If no search parameter was provided, ask for one
  if (arguments.length == 0) {
    var ui = DocumentApp.getUi();
    var result = ui.prompt('Text Highlighter',
      'Enter text to highlight:', ui.ButtonSet.OK_CANCEL);
    // Exit if user hit Cancel.
    if (result.getSelectedButton() !== ui.Button.OK) return;
    // else
    target = result.getResponseText();
  }
  var background = background || '#F3E2A9';  // default color is light orangish.
  var doc = DocumentApp.getActiveDocument();
  var bodyElement = DocumentApp.getActiveDocument().getBody();
  var searchResult = bodyElement.findText(target);

  while (searchResult !== null) {
    var thisElement = searchResult.getElement();
    var thisElementText = thisElement.asText();

    //Logger.log(url);
    thisElementText.setBackgroundColor(searchResult.getStartOffset(), searchResult.getEndOffsetInclusive(),background);

    // search for next match
    searchResult = bodyElement.findText(target, searchResult);
  }
}

/**
 * Create custom menu when document is opened.
 */
function onOpen() {
  DocumentApp.getUi().createMenu('Custom')
      .addItem('Text Highlighter', 'highlightText')

      .addToUi();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T06:40:13.273

好吧，简单的javascript就足够了，

```
var search = searchtext;
var index = -1;

while(true)
 {
   index = text.indexOf(search,index+1);

   if(index == -1)
     break;
   else
     /** do the required operation **/
 } 
```

希望这可以帮助！

# javascript - 使用 javascript，将日期字符串与夏令时进行比较

> ID：11478477
> 
> 赞同：1
> 
> 时间：2012-07-13T21:14:06.160
> 
> 标签：javascript, function, date

我的目标是创建一个时区转换器，它将比较来自 pdf 表单的两个不同日期字段输入，以决定将哪个数组发送到填充下拉列表的函数。一个数组具有 DST 的 UTC 偏移量，而另一个数组具有 UTC 偏移量而不考虑 DST。我首先尝试编写一个条件语句，将日期与静态日期进行对比，但这必须每年进行修改。有没有办法利用 javascript 来简化这个过程？理想情况下，我想要一个自我调整的代码，但每年进行一次调整并不是世界末日。最初的想法包括这个一般的想法（伪代码）：

```
if(11 Mar 2012 < date < 04 Nov 2012){
CountryCode = CountryCodeDST}
else{
CountryCode = CountryCode} 
```

这是具有该功能的数组。有任何想法吗？指导？这是我第一次接触 javascript，希望这个问题有意义并且可以帮助其他人和我自己。

```
var CountryCode = new Array(
"CST",
"EST",
"MST",
"MST-Arizona");

var UTCoffset = new Array(
"GMT+0600", 
"GMT+0500",
"GMT+0700", 
"GMT+0700");

var CountryCodeDST = new Array(
"CST",
"EST",
"MST",
"MST-Arizona");

var UTCoffsetDST = new Array(
"GMT+0500", 
"GMT+0400",
"GMT+0600", 
"GMT+0700");

function TZ_Populate(dropdownField)
{
for (var i=0; i < CountryCode.length; i++)
dropdownField.addItem(CountryCode[i]);
}

function TZ_ReadOut(TZ_Alias, UTC_Alias)
{
for (var i = 0; i < CountryCode.length; i++)            
{
if (CountryCode[i] == TZ_Alias)                     
    {
    UTC_Alias.rawValue = UTCoffset[i];                  
    break;                                      
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:22:45.747

```
if(11 Mar 2012 < date < 04 Nov 2012){
CountryCode = CountryCodeDST}
else{
CountryCode = CountryCode} 
```

这在 Javascript 中实际上非常简单，因为在幕后 Javascript 将日期表示为整数（特别是自纪元点以来的毫秒数）。结果，您可以编写几乎与您所拥有的代码相同的代码，并让它真正工作：

```
var Mar11_2012 = new Date('3/11/2012');
var Nov04_2012 = new Date('11/4/2012')
if(Mar11_2012 < date && date < Nov04_2012){
CountryCode = CountryCodeDST}
else{
CountryCode = CountryCode} 
```

# python - 我们是否在每个函数中都使用 try,except ？

> ID：11478484
> 
> 赞同：5
> 
> 时间：2012-07-13T21:14:42.630
> 
> 标签：python, exception

我们是否应该始终将我们编写的每个函数都用一个 `try...except` 块括起来？我问这个是因为有时我们在一个函数中 raise `Exception`，而调用这个函数的调用者没有异常

```
def caller():
   stdout, stderr = callee(....)

def callee():
   ....
    if stderr:
       raise StandardError(....) 
```

然后我们的应用程序崩溃。在这个明显的例子中，我很想用`try..except`.

但是我已经阅读了很多 Python 代码，但他们并没有一直这样做`try..block`。

* * *

```
def cmd(cmdl):
    try:
        pid = Popen(cmdl, stdout=PIPE, stderr=PIPE)
    except Exception, e:
        raise e
    stdout, stderr = pid.communicate()
    if pid.returncode != 0:
        raise StandardError(stderr)
    return (stdout, stderr)

def addandremove(*args,**kwargs):
    target = kwargs.get('local', os.getcwd())
    f = kwargs.get('file', None)
    vcs = kwargs.get('vcs', 'hg')

    if vcs is "hg":
        try:
            stdout, stderr = cmd(['hg', 'addremove', '--similarity 95'])
        except StandardError, e:
            // do some recovery
        except Exception, e:
            // do something meaningful
    return True 
```

真正困扰我的是：

如果有第三个函数`addandremove()`在其中一个语句中调用，我们是否也用 try..except 块包围调用？如果这个第三个函数有 3 行，并且每个函数调用自己都有一个 try-except 怎么办？我很抱歉建立这个。但这是我不明白的问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-13T21:52:15.250

顾名思义，例外是在特殊情况下——实际上不应该发生的事情

..因为它们可能不应该发生，在大多数情况下，你可以忽略它们。这是一件好事。

除了特定的例外，有时您*会这样做*，例如，如果我这样做：

```
urllib2.urlopen("http://example.com") 
```

在这种情况下，预期“无法联系服务器”错误是合理的，因此您可能会这样做：

```
try:
    urllib2.urlopen("http://example.com")
except urllib2.URLError:
    # code to handle the error, maybe retry the server,
    # report the error in a helpful way to the user etc 
```

然而，试图捕捉每一个可能的错误是徒劳的——有无数的事情可能会出错。作为一个奇怪的例子，如果一个模块修改`urllib2`并删除了`urlopen`属性会怎么样——没有理智的理由去期待它`NameError`，并且没有理智的方法可以处理这样的错误，因此您只需让异常向上传播

让您的代码退出并带有回溯是一件好事 - 它使您可以轻松查看问题的根源，以及导致问题的原因（基于异常及其消息），并修复问题的原因，或处理异常正确的位置...

简而言之，*只有当*你可以对它们做一些有用的事情时才处理异常。如果不是这样，试图处理所有无数可能的错误只会让你的代码更容易出错并且更难修复

* * *

在您提供的示例中，try/except 块什么都不做——它们只是重新引发异常，所以它与更整洁的相同：

```
def cmd(cmdl):
    pid = Popen(cmdl, stdout=PIPE, stderr=PIPE)
    stdout, stderr = pid.communicate()
    if pid.returncode != 0:
        raise StandardError(stderr)
    return (stdout, stderr)

# Note: Better to use actual args instead of * and **,
# gives better error handling and docs from help()
def addandremove(fname, local = None, vcs = 'hg'):
    if target is None:
       target = os.getcwd() 

    if vcs is "hg":
        stdout, stderr = cmd(['hg', 'addremove', '--similarity 95'])
    return True 
```

关于我可能期望的唯一与异常处理相关的事情是在找不到“hg”命令时进行处理，由此产生的异常并不是特别具有描述性。所以对于图书馆，我会做这样的事情：

```
class CommandNotFound(Exception): pass

def cmd(cmdl):
    try:
        pid = Popen(cmdl, stdout=PIPE, stderr=PIPE)
    except OSError, e:
        if e.errno == 2:
            raise CommandNotFound("The command %r could not be found" % cmdl)
        else:
            # Unexpected error-number in OSError,
            # so a bare "raise" statement will reraise the error
            raise

    stdout, stderr = pid.communicate()
    if pid.returncode != 0:
        raise StandardError(stderr)
    return (stdout, stderr) 
```

这只是将可能令人困惑的“OSError”异常包装在更清晰的“CommandNotFound”中。

重读这个问题，我怀疑你可能误解了 Python 异常是如何工作的（“和调用这个函数的调用者没有异常”位，所以希望澄清一下：

调用者函数不需要任何关于子函数可能引发的异常的知识。您可以调用该`cmd()`函数并希望它正常工作。

假设您的代码在一个`mystuff`模块中，并且其他人想要使用它，他们可能会这样做：

```
import mystuff

mystuff.addandremove("myfile.txt") 
```

或者，如果用户没有`hg`安装，也许他们想给出一个很好的错误消息并退出：

```
import mystuff

try:
    mystuff.addandremove("myfile.txt")
except mystuff.CommandNotFound:
    print "You don't appear to have the 'hg' command installed"
    print "You can install it with by... etc..."
    myprogram.quit("blahblahblah") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-13T21:22:36.220

`try`/`except`子句只有在您知道如何处理引发的错误时才真正有用。采取以下程序：

```
while True:
    n=raw_input("Input a number>")
    try:
       n=float(n)
       break
    except ValueError:
       print ("That wasn't a number!")  #Try again. 
```

但是，您可能具有如下功能：

```
def mult_2_numbers(x,y):
    return x*y 
```

并且用户可以尝试将其用作：

```
my_new_list=mult_2_numbers([7,3],[8,7]) 
```

用户**可以**将其放在 try/except 块中，但随后`my_new_list`不会被定义，并且可能稍后会引发异常（可能是 NameError）。在这种情况下，您会更难调试，因为回溯中的行号/信息指向一段不是真正问题的代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-13T21:16:36.800

您应该使用 try catch 块，以便您可以专门定位异常的来源。你可以把这些块放在你想要的任何地方，但除非它们产生某种有用的信息，否则没有必要添加它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T22:37:32.983

对于自省类型工具和“异常”处理，您的编码团队需要做出几个编程决策。

使用异常处理的一个好地方是使用操作系统调用，例如文件操作。推理是，例如，一个文件的访问权限可能会受到客户端应用程序的访问限制。该访问限制通常是操作系统管理任务，而不是 Python 应用程序功能。因此，在您的应用程序无法控制的情况下，异常将是一个很好的用途。

您可以将上一段的异常应用更改为更广泛，从某种意义上说，将异常用于您的团队代码无法控制的事物，例如所有“设备”或操作系统资源（如操作系统计时器、符号链接、网络连接） ， ETC。

另一个常见的用例是，当您使用一个库或包时，该库或包被设计为通过大量异常，并且该包希望您为此捕获或编码。有些包旨在尽可能少地抛出异常，并期望您根据返回值进行编码。那么你的例外应该很少见。

一些编码团队使用异常作为记录应用程序中“事件”的边缘案例的一种方式。

我发现在考虑是否使用异常时，我要么通过没有大量的 try/except 来编程以最大限度地减少失败，要么让调用例程期望有效的返回值或期望无效的返回值。或者我为失败编程。也就是说，我通过函数对预期的失败进行编程，我使用了很多 try/except 块。考虑为“预期”失败进行编程，例如使用 TCP；数据包没有到达那里，甚至没有按顺序到达，但是通过使用发送/读取重试等使用 TCP 进行异常处理。

就我个人而言，我在尽可能小的块大小周围使用 try-except 块，通常是一行代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T21:26:04.060

由你决定; 主要例外的角色包括（引自[这本](http://books.google.bg/books?id=1HxWGezDZcgC&pg=PA828&lpg=PA828&dq=Python%20exceptions%20Event%20notification&source=bl&ots=LjIfYKc6s1&sig=_f0cCQvcfyOynx1iOOOU9Yqain8&hl=bg&sa=X&ei=6ZAAUNvSHo3V4QSZ5eC8CA&sqi=2&ved=0CGIQ6AEwBA#v=onepage&q=Python%20exceptions%20Event%20notification&f=false)精彩的书）：

*   错误处理
*   活动通知
*   特殊情况处理
*   终止行动
*   异常控制流

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-13T21:32:55.993

当您知道错误是什么时，请使用 try/except 进行调试。否则，您不必对每个函数都使用 try/except。

# c# - 在 VisualStudio 调试器退出时执行代码

> ID：11478490
> 
> 赞同：16
> 
> 时间：2012-07-13T21:15:05.840
> 
> 标签：c#, .net, .net-4.0, dispose, finalizer

我曾假设在终止调试时（例如通过点击停止按钮或点击 Shift+F5），任何实现终结器的类`IDisposable`都将被处理掉。

我有一些实现`IDisposable`. 当应用程序从调试器退出（或在生产中崩溃）时，我想（尝试）做一些事情。现在，`Dispose()`似乎没有被调用，也没有终结器`~MyClass(){}`

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T23:02:43.260

要正常停止 Windows 服务，您应该将代码放入 Stop 方法中。

[http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.stop.aspx](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.stop.aspx)

一般来说，粗鲁的线程中止和粗鲁的应用程序域卸载不会运行“正常”终结器 - 您可以在这篇 MSDN 文章中获得更多详细信息。

[https://web-beta.archive.org/web/20150423173148/https://msdn.microsoft.com/en-us/magazine/cc163716.aspx](https://web-beta.archive.org/web/20150423173148/https://msdn.microsoft.com/en-us/magazine/cc163716.aspx)

> 到目前为止，我只是简单地讨论了线程中止是运行时在线程上抛出 ThreadAbortException 的结果。通常，这将导致线程终止。但是，线程可以处理线程中止，防止它终止线程。为了解决这个问题，运行时提供了一个更强大的操作，恰当地命名为粗鲁的线程中止。粗鲁的线程中止导致线程停止执行。发生这种情况时，CLR 不保证线程上的任何回退代码都会运行（除非代码在 CER 中执行）。粗鲁，确实。
> 
> 类似地，虽然典型的应用程序域卸载将优雅地中止域中的所有线程，但粗鲁的应用程序域卸载将粗鲁地中止域中的所有线程，并且不保证与该域中的对象关联的正常终结器将运行。SQL Server 2005 是一个 CLR 主机，它利用粗鲁的线程中止和粗鲁的应用程序域卸载作为其升级策略的一部分。当发生异步异常时，资源分配失败将升级为线程中止。并且当线程中止发生时，如果它没有在 SQL Server 设置的时间跨度内完成，它将被升级为粗鲁的线程中止。同样，如果应用程序域卸载操作未在 SQL Server 设置的时间跨度内完成，它将升级为粗鲁的应用程序域卸载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:19:10.783

好吧，CLR 没有就您的对象何时被收集或处置做出任何承诺。

您可以尝试显式调用垃圾收集器，但我认为这不是推荐的方法。

最好的办法是在块`IDisposable`内使用您的对象。 只有这样，您才能保证它们何时会被处理掉。`using`

# list - Apex - Salesforce - 地图

> ID：11478493
> 
> 赞同：0
> 
> 时间：2012-07-13T21:15:23.017
> 
> 标签：list, map, salesforce, apex-code

**大家好**

我有一个关于 Apex 地图的小问题。我有一张地图`map <String, list <Account>>`。我正在尝试执行以下操作 -

**需要做什么**：我将一个键传递给字符串变量，然后将该字符串传递给 Map.get() 方法以获取该键的值。在这里，它没有给我正确的答案。即使我使用 System.Debug() 打印出地图，它也会以非常不同的方式打印出地图！

```
String Id = 'Some Id that is the key in the map';
List <Account> testList = Map.get(Id); 
```

这没有给我相应的值，我不知道为什么！

**但**

当我输入下面的代码时，这些值会被完美地打印出来。

```
for(String s : Map.keySet()){
   List <Account> TestList = Map.get(s);
   System.Debug('TestList' + TestList);
} 
```

测试列表实际上打印出它应该打印出的内容，即它打印出每个键的值，当我打印地图时它没有按预期打印出。

**预期内容**：我想将密钥传递给 Map.get() 方法以检索结果，但在我的情况下显然没有发生。

任何形式的帮助都非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:40:38.263

我能想到的只有两件事是：

*   是个案问题。要验证，请将您的密钥转换为大写：

> theMap.put(stringKey.toUpperCase(), theAccountList);

*   通过使用 Id 作为变量名（本身就是一种类型），你会得到奇怪的结果

正如其他人已经在这里提到的那样，请发布实际的代码段，以便我们可以进一步帮助或关闭此问题。

谢谢

# php - Where子句mysql查询中的未知列

> ID：11478496
> 
> 赞同：0
> 
> 时间：2012-07-13T21:15:44.673
> 
> 标签：php, mysql

我的查询是`$query = "SELECT * FROM cartmatch WHERE CARTNO=$cart4";`，我收到一个错误，上面写着“'where 子句'中的未知列'M833'”。你知道，cart4=M833。

::EDIT:: 出于某种原因，没有显示任何内容。这是页面上的代码。

```
<?php
$cart1 = rawurldecode($_GET["path"]);
list( , , , , , $cart2) = explode ("\\", $cart1);
$cart3 = $cart2;
list($cart4) = explode (" ", $cart3);

$con = mysql_connect("SERVER","USERNAME","PASSWORD");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("cartmatch", $con);

$result = mysql_query("SELECT * FROM cartmatch WHERE CARTNO='$cart4'");

while($row = mysql_fetch_array($result))
  {
echo '<form enctype="multipart/form-data" action="album.php" method="POST">Please enter press save.<br><br><input name="ID" type="hidden" value=';
echo $_GET["ID"];
echo ' ><input name="enabled" type="hidden" value=';
echo $_GET["enabled"];
echo ' ><input name="artist" type="hidden" value=';
echo $_GET["artist"];
echo ' ><input name="title" type="hidden" value="';
echo $_GET["title"];
echo '" >Name:<br/><input name="album" type="text" autofocus="autofocus" value="';
echo $row['ALBUM'];
echo '" ><input type="submit" name="edit" value="Save"></form>';
  }

mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:16:58.200

将查询更改为：

```
"SELECT * FROM cartmatch WHERE CARTNO='$cart4'" 
```

和改变

```
list($cart4) = explode (" ", $cart3); 
```

至

```
list($cart4) = explode ("+", $cart3); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:17:41.070

将 WHERE 部分更改为

```
CARTNO='$cart4' 
```

# c++ - openCV 程序编译但运行时崩溃

> ID：11478501
> 
> 赞同：0
> 
> 时间：2012-07-13T21:16:24.083
> 
> 标签：c++, visual-studio-2008, windows-7, opencv

我刚开始在 Windows 7 上的 Visual Studio 2008 中使用 openCV（版本 2.4.1）。我按照中所述进行了安装和“hello world”程序

[http://opencv.willowgarage.com/wiki/VisualC%2B%2B](http://opencv.willowgarage.com/wiki/VisualC%2B%2B)

和

[如何在 win32 上安装 OpenCV 2.0](https://stackoverflow.com/questions/2179222/how-to-install-opencv-2-0-on-win32)

多亏了这些指令，我的程序编译得很好，没有任何错误。但是当我第一次运行它时，我得到了文件 opencv_core241d.dll 和 tbb_debug.dll 丢失的错误。所以很明显有些东西没有设置正确，但是按照第一个链接中的说明，我将这些文件复制到了 exe 所在的同一个文件夹中，第三次运行它，现在我得到了关于 libgcc_s_dw2-1.dll 丢失的弹出窗口。我在我的电脑上进行了搜索，没有这样的 dll 可用。

我在网上对此进行了研究，并没有在网上看到任何关于此类问题的真正解决方案。我的猜测是缺少openCV的多个dll；没有正确安装，但我不知道到底发生了什么。

任何帮助都是迫切需要的，我的头发和头皮都会非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T11:31:39.307

请按照以下步骤进行尝试。

1.  将 OpenCV 2.4.x 提取到您的主分区中（我假设`C\{opencvdir}`）

2.  添加`C\{opencvdir}\build\x86\vc9\bin`到环境变量的`path`变量中。并重新启动计算机（这些设置适用于 32 位 (x86) Windows 版本和 Visual Studio 2008 (VC9)）。

3.  现在创建一个新的 Visual Studio 项目并添加您的示例 OpenCV 代码。

4.  转到项目属性 -> 配置属性 -> C/C++ -> 常规 -> 附加目录并添加：

    ```
    "C\{opencvdir}\include";
    "C\{opencvdir}\include\opencv";
    "C\{opencvdir}\include\opencv2" 
    ```

5.  转到项目属性 -> 配置属性 -> 链接器 -> 输入 -> 附加依赖项并添加：

    ```
    "C\{opencvdir}\build\x86\vc9\lib\opencv_core240.lib";
    "C\{opencvdir}\build\x86\vc9\lib\opencv_highgui240.lib";
    "C\{opencvdir}\build\x86\vc9\lib\opencv_imgproc240.lib";
    "C\{opencvdir}\build\x86\vc9\lib\opencv_video240.lib" 
    ```

    （这些库用于基本应用程序。根据您的应用程序需要添加更多库）。

6.  现在运行你的项目。

PS 我的建议是使用带有 OpenCV 2.3.x 或更高版本的 Visual Studio 2010。

# android - Android TextView 和 9 补丁布局不正确

> ID：11478502
> 
> 赞同：1
> 
> 时间：2012-07-13T21:16:30.807
> 
> 标签：android, background, textview, nine-patch

我有一个垂直线性布局，我想为文本视图添加背景。我正在使用我为按钮完成的 9 补丁没问题。我的 9 补丁图形是正确的，但这是在布局中显示时得到的。这些数字应该是均匀分布的。如果我没有将 9 补丁放在那里，则布局显示正常（一个字段被推到视野之外）。这里发生了什么？我不想硬编码文本视图的高度，因此我使用 9Patch。

![坏9补丁！](../Images/4fb6f87b7f67d934e6ae3be2a2baad8d.png)

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/rl_DisplayGraph"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <LinearLayout
        android:id="@+id/rl_DisplayFeatures"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:orientation="vertical" >

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingTop="5dp"
            android:text="1"
            android:textColor="@color/orange1"
            android:textSize="20dip" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingTop="5dp"
            android:text="2"
            android:textColor="@color/orange1"
            android:textSize="20dip" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingTop="5dp"
            android:text="6"
            android:textColor="@color/orange1"
            android:textSize="20dip" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingTop="5dp"
            android:text="3"
            android:textColor="@color/orange1"
            android:textSize="20dip" 
        />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingTop="5dp"
            android:background="@drawable/back_graphtab"
            android:text="4"
            android:textColor="@color/orange1"
            android:textSize="20dip" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingTop="5dp"
            android:text="5"
            android:textColor="@color/orange1"
            android:textSize="20dip" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingTop="5dp"
            android:text="7"
            android:textColor="@color/orange1"
            android:textSize="20dip" 
            android:longClickable="true"/>

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingTop="5dp"
            android:text="8"
            android:textColor="@color/orange1"
            android:textSize="20dip" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingTop="5dp"
            android:text="9"
            android:textColor="@color/orange1"
            android:textSize="20dip" />
    </LinearLayout>

    <!--More layouts here but cut short for brevity ->

</RelativeLayout> 
```

![9补丁图像](../Images/a2436fce702c03c558397bc18d6c67a6.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:54:27.600

您的初始 9-patch 尺寸大于您希望按钮的最小尺寸。

![例子](../Images/b2429fa251b5819474568adcfd7b4a7a.png)

尝试类似附件的东西；在不消除您需要的信息的情况下将其减小到尽可能小的大小。

# asp.net-mvc-3 - 通过不显眼的验证支持每个字段/规则的两个不同的验证消息

> ID：11478505
> 
> 赞同：2
> 
> 时间：2012-07-13T21:16:37.197
> 
> 标签：asp.net-mvc-3, validation, unobtrusive-validation

我们正在使用 Fluent Validation 构建一个 ASP.NET MVC3 网站，并支持不显眼的验证。我们的 UX 团队询问我们是否可以支持两个单独的消息进行验证，每个字段和每个规则：一个显示在字段旁边，另一个显示在摘要中。

例如：

> 请解决以下问题：
> - 请提供名字
> - 请提供出生日期
> 
> 名字：__________________ <名字是必需的>
> 出生日期：__________________ <出生日期是必需的>

请注意，字段级和摘要级验证消息是不同的。

我的第一个选择是扩展内置验证以允许第二条消息，但我认为这并不容易实现，因为所有内容都硬连接到仅支持一个 ErrorMessage的[ModelError中。](http://msdn.microsoft.com/en-us/library/system.web.mvc.modelerror%28v=vs.108%29)

所以我唯一能想到的另一件事就是通过将两条消息组合成一个字符串来破解它（是的，这个解决方案有味道），并修改助手/jquery以解析其中的两条消息（但我[遇到了问题](https://stackoverflow.com/questions/11478035/parse-attributes-from-mvchtmlstring)也这样做）。

该解决方案需要与客户端不显眼的验证（使用`data-`属性）以及服务器端一起使用。

我很想听听另一种方法来做到这一点。

**更新**

这是我的看法

```
@using (Html.BeginForm())
{
    @Html.ValidationSummary()
    <p>
        @Html.EditorFor(m => m.UserName)
        @Html.ValidationMessageFor(m => m.UserName)
    </p>
    <p>
        @Html.EditorFor(m => m.BirthDate)
        @Html.ValidationMessageFor(m => m.BirthDate)
    </p>    
    <input type="submit" />
} 
```

这是它呈现的内容：

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link href="/Content/Site.css" rel="stylesheet" type="text/css" />
    <script src="/Scripts/jquery-1.5.1.js" type="text/javascript"></script>
    <script src="/Scripts/jquery.validate.js" type="text/javascript"></script>
    <script src="/Scripts/jquery.validate.unobtrusive.js" type="text/javascript"></script>
</head>
<body>
    <form action="/" method="post">
    <div class="validation-summary-valid" data-valmsg-summary="true">
        <ul>
            <li style="display: none"></li>
        </ul>
    </div>
    <p>
        <input class="text-box single-line" data-val="true" id="UserName" 
               name="UserName" type="text" value="" 
               data-val-required="The User name field is required." />
        <span class="field-validation-valid" 
              data-valmsg-for="UserName" data-valmsg-replace="true">
        </span>
    </p>
    <p>
        <input class="text-box single-line" data-val="true" id="BirthDate" 
               name="BirthDate" type="text" value="" 
               data-val-required="The Date of birth field is required." />
        <span class="field-validation-valid" data-valmsg-for="BirthDate" 
              data-valmsg-replace="true">
        </span>
    </p>
    <input type="submit" />
    </form>
</body>
</html> 
```

# jquery - jQuery 工具和 jquery.ui.ufd-0.6

> ID：11478508
> 
> 赞同：0
> 
> 时间：2012-07-13T21:16:54.753
> 
> 标签：jquery, jquery-ui, jquery-tools

我正在开发一个网站，我添加了 jquery 工具来使用它的日期选择器，最近我想改变选择元素的外观，我找到了 jquery.ui.ufd 插件。正如它的名字所读的那样，它取决于 jquery ui，但即使我添加了 jquery ui，我仍然会收到此错误：jQuery.widget is not a function。我的猜测是我不能同时使用 jquery 工具和 jquery ui。我想知道是否有任何解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T00:09:35.247

没有示例代码，很难说，但是 jquery 和 jqueryui 可以很好地相互配合。对于外观，您可能需要考虑[Themeroller](http://jqueryui.com/themeroller/)，这是为 jqueryui 设计的另一个功能。

# java - 小程序不会从服务器上运行

> ID：11478511
> 
> 赞同：0
> 
> 时间：2012-07-13T21:17:11.177
> 
> 标签：java, eclipse, applet, publish

我已经以 java applet 的形式创建了一个 java 游戏，现在我正试图将 applet 发布到 facebook。为此，我通过在 Zymic 上注册了一个帐户，将我的游戏免费放到了网络服务器上。我的问题是游戏没有运行它应该从服务器运行的方式。游戏开始创建玩家和一些背景，然后运行游戏循环的几次迭代，然后关闭。我几乎 100% 确定我在 Web 服务器上拥有所有文件，因为我基本上只是将整个根目录文件夹复制到 Web 服务器上（我的所有小程序文件都在我计算机上的一个文件中）。该小程序在我的计算机上运行完全正常，如果有任何不同，我使用 Eclipse 编写和测试小程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T17:50:44.033

按照以下说明启用 Java 控制台：

[http://www.java.com/en/download/help/javaconsole.xml](http://www.java.com/en/download/help/javaconsole.xml)

当您的 Applet 运行时，它会引发各种安全异常。Applet 在沙箱中运行，并且默认情况下受限于它们可以执行的操作：例如，未签名的 Applet 无法连接到下载它的远程服务器之外的远程服务器。

[http://docs.oracle.com/javase/tutorial/deployment/applet/security.html](http://docs.oracle.com/javase/tutorial/deployment/applet/security.html)

从控制台堆栈跟踪中，您可能正在尝试从某个远程 URL 加载图像。

```
Exception in thread "AWT-EventQueue-2" java.lang.SecurityException
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkConnect(Unknown Source)
    at sun.plugin2.applet.SecurityManagerHelper.checkConnectHelper(Unknown Source)
    at sun.plugin2.applet.AWTAppletSecurityManager.checkConnect(Unknown Source)
    at sun.awt.image.URLImageSource.checkSecurity(Unknown Source)
    at sun.awt.image.ImageRepresentation.imageComplete(Unknown Source)
    at sun.awt.image.InputStreamImageSource.errorConsumer(Unknown Source)
    at sun.awt.image.InputStreamImageSource.errorAllConsumers(Unknown Source)
    at sun.awt.image.InputStreamImageSource.badDecoder(Unknown Source)
    at sun.awt.image.InputStreamImageSource.doFetch(Unknown Source)
    at sun.awt.image.ImageFetcher.fetchloop(Unknown Source)
    at sun.awt.image.ImageFetcher.run(Unknown Source) 
```

# jquery - SharePoint ListData.svc“包含”字符串筛选运算符

> ID：11478513
> 
> 赞同：3
> 
> 时间：2012-07-13T21:17:14.317
> 
> 标签：jquery, sharepoint

我正在使用 getJSON 从 SharePoint 中检索列表项，如下所示：

> [站点 url]/_vti_bin/listdata.svc/Keywords?filter= **startswith** (Title,'r')

我想改变它来检索这个：

> [站点 url]/_vti_bin/listdata.svc/Keywords?filter=**包含**（标题，'r'）

失败了。ListData.svc 是否有“包含”运算符？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-14T21:11:10.347

好的语法是：

```
 [site url]/_vti_bin/listdata.svc/Keywords?$filter=substringof('r',Title) 
```

所有运营商都在这里列出：http: [//msdn.microsoft.com/en-us/library/cc907912.aspx](http://msdn.microsoft.com/en-us/library/cc907912.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T13:18:42.067

由于 ListData.svc 遵循 OData 协议，您可以尝试`[substringof](http://www.odata.org/media/30002/OData%20URL%20Conventions.html#url5.1.2)`. 我自己从未尝试过，但它应该可以工作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-09-01T11:33:10.303

是的，我在查询中使用了它，我必须检查并查找`notesField`包含单词的位置`'Download'`，因此我使用了以下 REST URL：

> _api/web/lists/getbytitle('SecureSystemData')/items?$select=SNotes&$filter=substringof('Download',SNotes)

第二个参数是字段名，即内部列名。

谢谢。

# matlab - 特征

> ID：11478520
> 
> 赞同：0
> 
> 时间：2012-07-13T21:17:46.183
> 
> 标签：matlab, math, pde

我希望能够模拟特征曲线（线）上的双曲线方程。我将从一个基本的开始。u_{t}+2u_{x}=u^{2}，初始数据为 u(x,0)=cos(x)。解为 u(x,t)=cos(x-2t)/(1-t*cos(x-2t))，其中特征曲线为 x=2*t+x_{0}。所以解决方案是根据特征（特征方法）定义的。

```
x=zeros(10,5);
u=zeros(10,5);
x0=linspace(0,10,10);
t=linspace(0,5,5);
for i=1:length(x0)
    for j=1:length(t)
        x(i,j)=2*t(j)+x0(i);
        if t(j)*cos(x(i,j)-2*t(j))==1
            u(i,j)=0;
        else
            u(i,j)=cos(x(i,j)-2*t(j))/(1-t(j)*cos(x(i,j)-2*t(j)));
        end
    end
end 
```

如果有人能看到我的错误，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:52:24.167

我不确定这是否能解决您的问题，但您正在使用和索引访问`t`矩阵的元素。例如：`i``j`

```
 (1-t(i)*cos(x(i)-2*t(j)) 
```

由于`i`可以采用超出`t`数组范围的值，因此您可能会混淆索引。至少您可能会因访问`t`超出其范围的元素而出错。很难说，因为您没有指定错误。我只是指出一个潜在的问题。

在我看来，您应该使用`i`来访问元素`x0`和`j`访问元素，`t`因为它们在您在循环中指定的限制范围内。也许

```
for i=1:length(x0)
    for j=1:length(t)
        x(i,j)=2*t(j)+x0(i);
        if t(j)*cos(x(i)-2*t(j))==1
            u(i,j)=0;
        else
            u(i,j)=cos(x(i)-2*t(j))/(1-t(j)*cos(x(i)-2*t(j)));
        end
    end
end 
```

就是你要找的。

# java - 在合成中调整合成的大小

> ID：11478523
> 
> 赞同：1
> 
> 时间：2012-07-13T21:18:16.733
> 
> 标签：java, eclipse, eclipse-plugin, swt

我正在尝试构建一个 Eclipse 插件视图，其中我有一个视图，顶部有一个输入栏，底部有一个 TableViewer。目前我正在尝试在一个较大的复合材料中构建 2 个单独的复合材料，但我很难控制每个单独复合材料的大小。这是一些代码：

```
public void createPartControl(Composite parent) {

        FillLayout parentLayout = new FillLayout(SWT.VERTICAL);
        parent.setLayout(parentLayout);

        Composite composite = new Composite(parent, SWT.BORDER);
        composite.setLayout(new FillLayout());
        viewer = new TableViewer(composite, SWT.MULTI | SWT.H_SCROLL | SWT.V_SCROLL);

        Composite composite2 = new Composite(parent, SWT.BORDER);

        GridLayout gridLayout = new GridLayout();
        composite2.setLayout(gridLayout); 

        GridData expGridData = new GridData();
        expGridData.horizontalAlignment = GridData.FILL;
        expGridData.grabExcessHorizontalSpace = true;
        expGridData.grabExcessVerticalSpace = true;
        Label expLabel = new Label(composite2, SWT.NONE);
        expLabel.setText("Express");
        Text exp = new Text(composite2, SWT.BORDER);
        exp.setLayoutData(expGridData); 
} 
```

我正在尝试缩小复合材料 2，同时增加复合材料 1 的大小，这两者都位于父复合材料中。我试过查看 FillLayout 的方法以及复合材料本身，但我没有找到任何有效的方法。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T13:27:55.013

试试这个:)

```
public void createPartControl(Composite parent) {
    GridData parentData = new GridData(SWT.FILL, SWT.FILL, true, true);
    parent.setLayout(new GridLayout(1, true));
    parent.setLayoutData(parentData);

    Composite searchMenu = new Composite(parent, SWT.BORDER);
    searchMenu.setLayout(new GridLayout(2, false));
    searchMenu.setLayoutData(new GridData(GridData.FILL, GridData.FILL, true, false));

    Text searchText = new Text(searchMenu, SWT.NONE);
    searchText.setLayoutData(new GridData(SWT.FILL, GridData.CENTER, true, false));
    searchText.setText("search text here");

    Button searchButton = new Button(searchMenu, SWT.PUSH);
    searchButton.setText("Search");

    Composite tableViewerComposite = new Composite(parent, SWT.BORDER);
    tableViewerComposite.setLayout(new GridLayout(1, true));
    tableViewerComposite.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));

    TableViewer tableViewer = new TableViewer(tableViewerComposite);
    TableViewerColumn column = new TableViewerColumn(tableViewer, SWT.NONE);
    column.getColumn().setWidth(200);
    column.setLabelProvider(new ColumnLabelProvider(){

        @Override
        public String getText(Object element) {
            return element != null ? element.toString() : "null";
        }});

    tableViewer.getControl().setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));
    tableViewer.setContentProvider(ArrayContentProvider.getInstance());
    tableViewer.setInput(new String[]{"one", "two", "three"});

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:03:49.193

引用FillLayout的JavaDoc的第一句话：

> FillLayout 是最简单的布局类。它将控件布置在单行或单列中，迫使它们具有相同的大小。

因此，当您使用该布局时，您无法控制复合和复合2 的大小。

您可以尝试使用 GridLayout，并在 Composite2 的 GridData 上设置 heightHint。

但是 IMO 在 SWT 中布局的最佳选择是[Miglayout](http://www.miglayout.com/) - 一旦你得到它，它就非常强大，不需要健谈的代码，而且实际上是可读的。由于您也可以将它用于 Swing，因此您只需学习一次。尝试一下。

# java - java应用程序和jax-ws web服务之间的线程间通信

> ID：11478524
> 
> 赞同：1
> 
> 时间：2012-07-13T21:18:22.703
> 
> 标签：java, multithreading, web-services, jax-ws

我的 jax-ws Web 服务（在被客户端请求命中后）向后端遗留平台（通过套接字）发送请求，然后等待 20 秒以等待响应。

在发出该请求之前，它会使用其唯一的事务号更新表。

一个单独的侦听器线程（独立的 java 应用程序）正在该套接字上等待响应，每个响应都将包含事务号，以识别与其关联的请求（先前发送的）。

这个独立的 Java 应用程序如何与 Web 服务中等待其响应已经到来的线程进行通信，并且它可以继续其处理。

目前我认为侦听器线程可以更新表（基于事务号）以指示响应已到达。Web 服务线程可以在数据库中保持轮询（每 2 秒检查一次）响应是否到达。

在这种情况下，我正在寻找一些推送通知而不是轮询。当它的响应到达时，如何通知我的 Web 服务线程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:06:09.517

假设服务请求并发出套接字请求的线程和接收套接字响应的线程都在同一个 jvm 中：
您可以使用标准的 Java 等待/通知模式。
[http://docs.oracle.com/javase/tutorial/essential/concurrency/guardmeth.html](http://docs.oracle.com/javase/tutorial/essential/concurrency/guardmeth.html)。

基本上，您的请求/套接字线程将在单例（或类似）映射中创建一个对象（“锁定”对象），键是您的唯一事务号。然后该线程将等待该对象。这会阻塞该线程，直到另一个线程对该事务 id 的锁定对象发出通知。
请注意，锁定对象可以只是一个对象。
您还可以在等待上设置超时以避免永远等待。

然后，您的其他线程将获取事务 id 的锁定对象并对其进行通知。然后这会解除对第一个线程的阻塞。
如果第二个线程没有为它的事务 id 找到锁对象，那么就出了问题，你必须记录一个错误或类似的东西。

Ps 因为地图是共享资源，您可能需要 ConcurrentHashMap。否则，您可能会遇到多个线程同时更新它的问题。

# visual-studio-2010 - VC++ DLL - 防止逆向工程和试用期到期

> ID：11478527
> 
> 赞同：3
> 
> 时间：2012-07-13T21:18:45.970
> 
> 标签：visual-studio-2010, visual-c++, license-key

我有一个用于我的知识产权的小型软件程序。我在 VC++ 中将它作为 Visual Studio 2010 DLL 项目编写。

我想保护 DLL 的代码。保护 DLL 中的逻辑免受逆向工程。
在 DLL 中放置一个到期期限，就像将在 1 个月内到期的试用期一样。

我在这里最好的选择是什么？试用期结束后我应该使用什么无法破解或逆向工程？我以前从来没有这样做过，所以基本上我在这里一无所知。

任何帮助表示赞赏！
谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T15:52:20.130

安全性是一个标量——安全性越高越好，但要付出代价。在这种情况下，您有两种选择：

1.  推出您自己的解决方案（混淆、加密等）。成本是您设计、测试、修复和支持它的劳动力。其他成本是您的客户是否会因为您给他们制造问题而感到恼火（因为您的实施存在缺陷，因为您缺乏经验、缺乏精力投入、缺乏用例测试等等）。

2.  购买商业“挂锁”。[我们公司生产](http://www.wibusystemsusa.com)，其他公司也生产。成本是门外的现金（不必太多，根据您选择的解决方案可能非常实惠）。商业产品应该使保护 dll 和创建试用版变得异常快速和简单。

好处是您不必将精力花在您不太了解的事情上（向专家寻求专门的解决方案），并且如果有需要解决的问题，您会感到窒息。您也可以购买比您自己制作的更好的安全性。

如果您的 dll 很有价值，请花费一些资源来妥善保护它。如果你有昂贵的珠宝，你会把它放在雪茄盒还是保险箱里？如果不是很值钱，就别管保险箱了，床底下的雪茄盒就够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:25:08.960

> 试用期结束后我应该使用什么无法破解或逆向工程？

没有什么是不能破解的。[请在这里](https://stackoverflow.com/questions/11364357/using-getenv-with-respect-to-security/11364905#11364905)阅读我的回答。作为一名逆向工程师，我完全同意 Adam Rosenfield 对您的问题的评论。这是一场军备竞赛，不多不少。让您的软件酷炫有趣，实际上有人可能会花时间破解最耗时的保护方案。

> 我以前从来没有这样做过，所以基本上我在这里一无所知。

这使事情变得更糟，因为这意味着您甚至无法很好地判断哪个解决方案可能有机会，而哪个没有机会。问题是，你只能阻止“饼干”这么多。但是更有趣的问题*是，如果您的保护没有被破解*，它是否是好的，或者您的软件是否可能如此无趣以至于没有人努力破解它。再次，阅读我关于相关主题的[链接答案。](https://stackoverflow.com/questions/11364357/using-getenv-with-respect-to-security/11364905#11364905)

要点：我质疑这种保护机制的动机。防止知识产权“盗窃”的最佳试用版是功能受限试用版，而不是时间限制试用版。

让我从链接的答案中引用自己：

> 大多数情况下的普遍问题是，一方面您信任用户（因为您向他们销售产品），但另一方面您不信任他们（因为您试图以某种方式保护您的软件）。当您以这种方式看待它时，您会发现它实际上是多么徒劳。

# java - 有没有办法存储许多 JID？

> ID：11478528
> 
> 赞同：0
> 
> 时间：2012-07-13T21:18:47.857
> 
> 标签：java, eclipse, google-app-engine

我的聊天机器人有大约 100 个客户的电子邮件 ID。我可以制作一个 JID 数组或 smthng 来存储许多电子邮件吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T00:17:01.390

您可以将它们存储在[App Engine Datastore](https://developers.google.com/appengine/docs/java/datastore/)中；您可以按如下方式为您的用户创建实体（您只需为每个用户执行一次）：

```
DatastoreService datastore = DatastoreServiceFactory.getDatastoreService();
Entity allowedUser = new Entity("AllowedUser");
allowedUser.setProperty("JID", "[[ user's JID ]]");
datastore.put(allowedUser); 
```

然后，在您的代码中，您可以通过检查用户的 JID 是否在数据存储区中来查看是否允许用户访问：

```
Query q = new Query("AllowedUser");
q.setFilter(new FilterPredicate("JID", Query.FilterOperator.EQUAL, "[[ user JID to check ]]");
PreparedQuery pq = datastore.prepare(q);
if (pq.countEntities(FetchOptions.Builder.withLimit(1)) > 0) {
    // user is allowed
} else {
    // user is not allowed
} 
```

在这里，我们执行查询以从具有给定 JID 的数据存储中获取所有用户。我们还将结果的数量限制为不超过 1 个，因为我们只关心它是否存在（无论如何不应有多个具有相同 ID 的结果）。然后我们看看查询的结果是否有多个结果；如果是这样，那么用户必须在表中并且他们可以访问。如果他们不是，那么他们不会。

请注意，您还可以从管理控制台中的数据存储查看器中添加实体，因此如果您没有太多实体，那么使用该路径可能会比第一个代码片段更容易。

# c++ - STL 如何使用非线性数据结构实现反向迭代器解引用？

> ID：11478529
> 
> 赞同：1
> 
> 时间：2012-07-13T21:18:52.210
> 
> 标签：c++, c, oop

在没有指针字面意义的情况下使用指向。用一粒盐来看待下一段。

实现反向迭代器很容易，使 rbegin() == end() 和 rend() == begin() 具有线性数据结构，因为您可以将反向访问映射到迭代器指向之前的元素（ rbegin() 指向 end()，但访问 end()-1，例如）。但是在处理树或者在我的情况下是哈希表时，我应该如何处理这个映射？我目前正在使用“OneAfterTheLast”标志来标记转发迭代会话的结束，并且我正在考虑手动实现反向迭代器逻辑并添加一个“OneBeforeTheFirst”标志。这是一个好的设计吗？

此外，在找不到密钥的情况下，find() 方法应该返回一个“OneAfterTheLast”-ed 迭代器，还是我的检查方法应该检查两个标志（OneAfterTheEnd 和 OneBeforeTheFirst）？

这是我的公共接口，仅供参考，仍然没有反向迭代器方法。容器类和迭代器类都是不透明的。

```
typedef PWError (*PWDictCallback)(const char *key, const char *val, void *extra);
PWError pwdictCreate(PWDict **dictRef, PWDictImplementationId id, size_t elements);
PWError pwdictCreateWithImplementation(PWDict **dictRef, const PWDictImplementation* impl, size_t elements);
void pwdictDestroy(PWDict *dict);
unsigned int pwdictSize(const PWDict *dict);
unsigned long pwdictSizeInBytes(const PWDict *dict);
PWError pwdictGet(const PWDict *dict, const char *key, char *output, size_t size);
PWError pwdictSet(PWDict *dict, const char *key, const char *value);
PWError pwdictRemove(PWDict *dict, const char *key);
PWError pwdictIteratorCreate(PWDictIterator **itRef, PWDict *dict);
PWError pwdictIteratorBegin(PWDictIterator *it);
int pwdictIteratorIsEnd(PWDictIterator *it);
void pwdictIteratorDestroy(PWDictIterator *it);
PWError pwdictFind(PWDictIterator *it, const char *key);
const char *pwdictIteratorGetKey(const PWDictIterator *it);
const char *pwdictIteratorGetValue(const PWDictIterator *it);
PWError pwdictIteratorSetValue(PWDictIterator *it, const char *value);
PWError pwdictIteratorRemove(PWDictIterator *it);
PWError pwdictIteratorNext(PWDictIterator *it);
PWError pwdictClear(PWDict *dict);
PWError pwdictAdd(PWDict *dict, const PWDict *from);
int pwdictIsEqual(const PWDict *d1, const PWDict *d2);
PWError pwdictForeach(PWDict *dict, PWDictCallback cb, void *extra);
void pwdictPrint(const PWDict *dict, int logLevel); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:32:15.363

`std::reverse_iterator`通过持有一个普通的迭代器但（从概念上）返回`*(i-1)`取消引用来做到这一点。你也可以这样做——或者直接使用`std::reverse_iterator`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T00:06:35.257

从 C++03 标准：

> 反向迭代器与其对应的迭代器 i 之间的基本关系由恒等式建立：`&*(reverse_iterator(i)) == &*(i - 1)`。
> 
> 这种映射是由以下事实决定的：虽然数组末尾总是有一个指针，但数组开头之前可能没有有效指针。

（第二句从 C++11 标准中删除）

反向迭代器的典型实现方式是在内部有一个容器的普通迭代器，它指向反向迭代器逻辑引用的项目*之后的元素。*这样，内部迭代器（可以使用 获得`reverse_iterator::base()`）总是指向容器内或容器的末端。所以它总是有效的。取消引用反向迭代器时，您只需减少基数（如果您有双向迭代器，可以这样做）并取消引用它。

我假设您的界面中有一个有效的双向迭代器，因为您提到这是您的要求的一部分。所以，我假设有一个`pwdictIteratorPrev()`功能。此外，反向迭代器功能需要临时操作私有迭代器，因此我还假设还有一些功能，例如复制迭代器的能力和比较迭代器的能力。

所以这些功能（无论是否在公共接口中）都应该可用。我相信它们可能很容易写成：

```
int pwdictIteratorIsEqual(PWDictIterator* it1, PWDictIterator* it2);
PWError pwdictIteratorCopy(PWDictIterator* dst, PWDictIterator const* src);
PWError pwdictIteratorEnd(PWDictIterator* it); 
```

您的反向迭代器可能如下所示（未显示错误处理）：

```
struct PWDictRIterator {
    PWDictIterator* base;
    PwDict* dict;
};

typdef struct PWDictRIterator PWDictRIterator;

PWError pwdictRIteratorCreate(PWDictRIterator **ritRef, PWDict *dict)
{
    PWError err;

    PWDictRIterator* riter = malloc(sizeof(PWDictRIterator));  // or however you want to allocate

    if (riter) {
        riter->dict = dict;
        err = pwdictIteratorCreate( &riter->base, dict);
    }

    return err;
}

PWError pwdictRIteratorBegin(PWDictRIterator *rit)
{
    return pwdictIteratorEnd(rit->base);
}

int pwdictRIteratorIsEnd(PWDictRIterator *rit)
{
    PWDictIterator* begin;

    PWError err;
    err = pwdictIteratorCreate( &begin, rit->dict);
    err = pwdictIteratorBegin(&begin);

    // there needs to be some way to do the following somehow - 
    //  I assume a plain old pointer compare won't do the trick
    int is_end = pwdictIteratorIsEqual( rit->base, begin);

    pwdictIteratorDestroy(begin);

    return is_end;
}

const char* pwdictRIteratorGetKey(onst PWDictRIterator *rit)
{
    // remember - to 'derefernce' a reverse iterator, we have to
    //  decrement the base first

    PWDictIterator* tmp;

    // all error handling elided...
    PWError err;
    err = pwdictIteratorCreate( &tmp, rit->dict);

    // we need a temporary iterator, so the base can stay the same
    //  I assume that some sort of copy operation can be created
    //  for iterators - it might not need to be part of the public interface
    err = pwdictIteratorCopy(tmp,rit->base);   

    err = pwdictIteratorPrev(tmp);

    const char* result = pwdictIteratorGetKey(tmp);

    pwdictIteratorDestroy(tmp);

    return result;
}

PWError pwdictRIteratorNext(PWDictRIterator *rit)
{
    return pwdictIteratorPrev(rit->base);
}

PWError pwdictRIteratorPrev(PWDictRIterator *rit)
{
    return pwdictIteratorNext(rit->base);
}

// further functions are basically variations on the above theme... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T21:26:12.807

为了与 C++ 中随处使用的迭代器模式保持一致，您的 rbegin() 应该创建一个指向最后一个元素（end() 之前的那个）的迭代器，并且您的 rend() 应该创建一个指向该元素之前的迭代器 -开始（begin() 之前的一个）。

这允许您使用与典型迭代器 for 循环相同的逻辑：

```
for ([iterator type] i = something.rbegin(); i != rend(); ++i) 
```

你的问题不是很清楚。考虑整理一下。我什至不确定我回答了你问的问题

# android - 保存按钮 - 图片编码

> ID：11478532
> 
> 赞同：0
> 
> 时间：2012-07-13T21:18:57.523
> 
> 标签：android, image, save

我的应用程序中有一个 ImageView，我还有一个按钮，上面写着“单击此处保存图片”。按钮应该做什么应该是不言自明的。它应该将 ImageView 保存在他们 SD 卡的新文件夹中。我到处寻找什么代码可以实现这一点。我发现了一些相似的，但它们对我不起作用。如果有人可以帮助我了解我需要做什么，或者如果他们知道哪些代码可以工作，那将对我有很大帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:40:42.627

这是您可以用来完成工作的工作流程：

1.  单击按钮后，您会触发 onClick(View) （通过 XML 就可以了）
2.  onClick(View) 必须[从 ImageView 中获取位图](https://stackoverflow.com/questions/4715044/android-how-to-convert-whole-imageview-to-bitmap)
3.  此外，一旦你有了位图，[你必须把它保存到 SDCARD](https://stackoverflow.com/questions/649154/android-bitmap-save-to-location)

希望能有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:40:52.900

基本上，您需要`Bitmap`从图像数据中获取结果，然后将其写入`Bitmap`文件。根据您对放置在`ImageView`...中的内容的访问级别

如果你有 raw `Bitmap`，你就完成了。

如果图像在资源中，则用于`BitmapFactory.decodeResource()`获取一个

如果你有一个`Drawable`内容，把它画成一个新的，`Bitmap`像这样：

```
Bitmap bmp = Bitmap.createBitmap(drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight(), Config.ARGB_8888);
Canvas canvas = new Canvas(bmp); 
drawable.setBounds(0, 0, canvas.getWidth(), canvas.getHeight());
drawable.draw(canvas); 
```

如果您无权访问图像内容，请使用`ImageView.getDrawingCache()`获取`Bitmap`可见内容。你需要调用`setDrawingCacheEnabled()`它才能工作。

* * *

Once you have a `Bitmap`, just use the `compress()` method to write that image out to a file as a JPG or PNG.

# html - CSS大纲只出现在元素的底部？

> ID：11478533
> 
> 赞同：1
> 
> 时间：2012-07-13T21:19:03.187
> 
> 标签：html, css

为什么在下面的示例中，红色轮廓仅出现在底部？我已经做了一些更改，但问题仍然存在。看看：http: [//jsfiddle.net/ny48t/3/](http://jsfiddle.net/ny48t/3/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T21:23:17.277

Outline 被绘制到由 Margin 定义的内部矩形的**外部**。在这种情况下，这也在元素可以呈现的可见空间**之外并且“不在页面”。**

添加一个边距（例如，5px），轮廓的剩余部分将变得可见。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-13T21:21:03.183

因为其他三个面都在窗外。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-13T21:23:26.923

您需要在它周围留出一个边距，以便可以看到其余的边框。否则浏览器窗口会将其关闭。

```
margin: 5px; 
```

# javascript - 使用 JSON 输出排行榜

> ID：11478538
> 
> 赞同：0
> 
> 时间：2012-07-13T21:19:12.687
> 
> 标签：javascript, json

我正在使用 Scoreoid 平台来实现排行榜。以下是我的 JSON 响应：

```
[{
    "Player": {
        "username": "TestPlayer",
        "email": "",
        "first_name": "",
        "last_name": "",
        "platform": ""
    },
    "Score": {
        "score": "23",
        "created": "2012-07-13 22:06:46",
        "difficulty": "0",
        "platform": ""
    }
}] 
```

尝试将此 JSON 格式化为 DIV，使用此（其中也包含我的调用）：

```
$(document).ready(function(){
            $.post('scoreoid_proxy.php', {action:'curl_request', method:'getScores', response:'JSON'},
            function(data) {
            $.each(data.Player, function(i,Player){
                content = '<p>' + Player.username + '</p>';
                content += '<br/>';
                $(content).appendTo("#response");
                });
            });
        }); 
```

但是，我收到以下错误：

```
object is undefined
length = object.length, 
```

任何帮助将不胜感激，我敢肯定这是我缺少的一些简单的东西。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:20:36.570

`data`是一个数组（对象）。

```
$.each(data, function(i, v){
    var Player = v.Player;
    var content = '<p>' + Player.username + '</p><br/>'
    $("#response").append(content);
}); 
```

**编辑**：您需要告诉 jQuery 这是 JSON，并且它需要解析它。这可以通过添加`'json'`作为参数来完成`$.post`（在回调之后）。

```
$.post('scoreoid_proxy.php', {
    action: 'curl_request',
    method: 'getScores',
    response: 'JSON'
}, function (data) {
    $.each(data, function (i, v) {
        var Player = v.Player;
        var content = '<p>' + Player.username + '</p><br/>'
        $("#response").append(content);
    });
}, 'json'); 
```

# android - 如何让 Android SurfaceView 成为 4:3？

> ID：11478539
> 
> 赞同：0
> 
> 时间：2012-07-13T21:19:16.883
> 
> 标签：android, surfaceview

我正在使用 Android 的 SurfaceView 显示来自相机的实时预览。我正在使用相对布局，并且表面视图上的预览似乎被拉长了。如何强制表面视图以 4:3 显示预览？

# python - 如何动态调用模块外的函数？

> ID：11478541
> 
> 赞同：0
> 
> 时间：2012-07-13T21:19:30.120
> 
> 标签：python

如何动态调用（a）模块内的函数？

例如：

```
class Class1(object):
    pass

class Class2(object):
    pass

# here I want to either instantiate object dynamically or dynamically pass 
# a Class1 or Class2 object to some other method/class inside this module code 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:24:20.887

你的意思是这样的？

```
>>> class Class1(object):
...     pass
... 
>>> class Class2(object):
...     pass
... 
>>> def foo(cls):
...     print cls
... 
>>> import random
>>> classes = {'Class1': Class1, 'Class2': Class2}
>>> dynamic_class = classes['Class%d' % random.randint(1, 2)]
>>> foo(dynamic_class())
<__main__.Class1 object at 0x10b44ab50> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T21:22:08.223

我假设您的意思是您想按名称访问这些类。

如果您想要的类在同一个模块中，请尝试`globals()[classname]()`实例化该类。如果它在另一个模块中，请尝试`vars(module)[classname]()`或`getattr(module, classname)()`。

(`classname`是一个包含类名的字符串；`module`是对模块的引用，而不是字符串。)

# javascript - 计算表单中的嵌套字段集

> ID：11478545
> 
> 赞同：1
> 
> 时间：2012-07-13T21:20:00.930
> 
> 标签：javascript, jquery, ruby-on-rails, nested-forms

在 Rails 中，有没有办法计算已添加到表单中的嵌套字段的数量？

我目前有一个允许用户添加或删除嵌套属性的表单。

[Railscast http://railscasts.com/episodes/196-nested-model-form-revised](http://railscasts.com/episodes/196-nested-model-form-revised)中的代码基本相同，只是根据我的要求（不同的控制器和模型名称）略有改变。

我想要做的是计算表单中当前嵌套属性集的数量。有没有办法在 Rails 中做到这一点，或者我会更好地使用 jQuery？

我需要能够访问视图中的值。

非常感谢任何帮助。如果您需要查看代码，请告诉我。

```
jQuery ->
  $('form').on 'click', '.remove_fields', (event) ->
    count--
    $(this).prev('input[type=hidden]').val('1')
    $(this).closest('.panel').hide()
    $('#price').text(count)
    event.preventDefault()

  $('form').on 'click', '.add_fields', (event) ->
    count++
    $('#price').text(count)
    time = new Date().getTime()
    regexp = new RegExp($(this).data('id'), 'g')
    $(this).before($(this).data('fields').replace(regexp, time))
    event.preventDefault() 
```

在视图中，出于测试目的，我将 count 变量设置为 1。我认为这需要在页面加载之前设置，因为它可能是最后加载 javascript，因此不显示初始计数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:11:10.257

如果您有一个要显示 count 变量的元素，例如，您可以在 count 更新后立即`<div id="count"></div>`写入click 函数。`$('#count').html(count)`

更新：对于初始计数（在用户单击添加/删除按钮之前），将计数包含在 erb 页面模板中

```
<div id="count"><%= @initial_count %></div> 
```

# javascript - 通过 jquery click 播放 mediaelement.js 音频

> ID：11478550
> 
> 赞同：1
> 
> 时间：2012-07-13T21:20:22.373
> 
> 标签：javascript, jquery, mediaelement.js

不知道为什么会发生这种情况或如何解决它。我正在尝试通过单击带有类的 div 来触发声音`.button`

```
$('.button').click(function(){
    $('audio')[0].player.play();
}); 
```

对除 Firefox 之外的所有东西都适用。

```
$('.button').click(function(){
    $('audio')[0].play();
}); 
```

没有`.player`Works 在除 iOS 之外的所有东西上都很棒！

不知道我能在这里做什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T05:10:00.770

我知道这是一个老问题，但如果有人还没有，我找到了这个问题的答案！

使用以下（适用于 IOS 和 FF）

```
$('audio').mediaelementplayer({
 success: function(media, domElement, player) {
   $('.play').on('click', function() {
     media.play();
   });
   $('.pause').on('click', function() {
     media.pause();
   });
 }
}); 
```

这将使用一个按钮或任何带有“播放”类的东西，而另一个带有“暂停”类的按钮可以从播放器外部使用或任何你想要的东西。希望这可以帮助！

# git - FETCH_HEAD 引用在“git fetch”之后没有正确更新

> ID：11478558
> 
> 赞同：9
> 
> 时间：2012-07-13T21:20:59.097
> 
> 标签：git, fetch

我有一个从远程存储库中提取的本地存储库。运行`git pull`以及`git fetch; git merge FETCH_HEAD`用于执行完全相同的操作，正如以下[描述`git pull`](http://git-scm.com/docs/git-pull)所预期的那样：

> 描述
> 
> 将来自远程存储库的更改合并到当前分支中。在其默认模式下，git pull 是 git fetch 后跟 git merge FETCH_HEAD 的简写。

目前，出乎意料`git fetch`的是，运行停止`FETCH_HEAD`正确更新引用。`FETCH_HEAD`现在被困在一个旧的提交上。运行`git fetch`会将所有更改下载到远程跟踪的分支，但 FETCH_HEAD 保持不变，无论它在哪个分支中运行。

```
# currently in branchone
> git fetch

# branchone is up to date since...
> git rev-parse branchone
593539e8a98ba5980d4b645db3b0f506bb9b6a2c

# ...its in the same commit as the remote branch
> git rev-parse origin/branchone
593539e8a98ba5980d4b645db3b0f506bb9b6a2c

# however FETCH_HEAD shows something different
> git rev-parse FETCH_HEAD
37301df96597ac037f8e7e846fea6fc7df77bea5 
```

`git pull`仍然执行正确的任务。然而，运行`git fetch; git merge FETCH_HEAD`会做一些不同的事情，因为`FETCH_HEAD`指向不正确的提交。

是否有任何设置或问题可能会`git fetch`影响行为？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T23:45:58.240

不带任何选项运行`git fetch`将获取遥控器中的所有引用并将它们写入`.git/FETCH_HEAD`文件。文件的内容通常看起来像这样：

```
37301df96597ac037f8e7e846fea6fc7df77bea5 branch 'master' of github.com:user/repo
593539e8a98ba5980d4b645db3b0f506bb9b6a2c not-for-merge branch 'branchOne' of github.com:user/repo 
```

当您在`.git`目录下有这样的文件时，您可以将其用作参考，只要该文件中的第一件事是 40 个字符的十六进制数字，或者实际上与现有提交匹配的更短的十六进制数字。

```
# This file can be used as a reference
> cat .git/MAGIC_HEAD
deadbeefdeadbeefdeadbeefdeadbeefdeadbeef lorem ipsum
the rest does not really matter
refrigerator

# And thus it will be interpreted by many git commands like this
> git rev-parse MAGIC_HEAD
deadbeefdeadbeefdeadbeefdeadbeefdeadbeef 
```

知道了这一点，我们可以看到，在运行后`git fetch`，引用`FETCH_HEAD`将解析为第一行中发生的任何事情

```
# Assuming the already mentioned contents of .git/FETCH_HEAD
> git rev-parse FETCH_HEAD
37301df96597ac037f8e7e846fea6fc7df77bea5 
```

似乎`.git/FETCH_HEAD`不保证内容的顺序首先包含当前分支的引用。

通过在不同的存储库中尝试它，似乎在某些情况下第一行始终是当前分支，因此`git fetch; git merge FETCH_HEAD`可以按预期工作。然而，在其他存储库中，内容的`.git/FETCH_HEAD`顺序会有所不同，并且第一行通常是对不同分支的远程提交的引用，从而使`FETCH_HEAD`引用不正确。

为什么它的行为不同对我来说是个谜。

作为一种解决方案， if`git fetch remote_name branch_name`仅获取此特定分支，并且仅该单行将出现在 的内容中`.git/FETCH_HEAD`，从而使`FETCH_HEAD`引用始终正确。

```
# Will only fetch branchone
> git fetch origin branchone

# FETCH_HEAD will contain only a single line
> cat .git/FETCH_HEAD
593539e8a98ba5980d4b645db3b0f506bb9b6a2c branch 'branchOne' of github.com:user/repo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T11:36:46.037

试着强迫你的头指向已经完成的最新提交/推送。

在您的 GIT 存储库中使用它：

```
git reset --hard HEAD@{1} 
```

希望这可以解决您的问题，使其达到以前可以正常工作的程度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-29T03:06:15.397

运行后`git fetch`（不带参数），如果当前本地分支（即）是跟踪分支，`FETCH_HEAD`则仅包含对合并有效的引用（即未标记为非合并） 。`HEAD`

解决方案是使当前分支成为跟踪分支（请参阅[如何使现有 Git 分支跟踪远程分支？](https://stackoverflow.com/questions/520650/how-do-you-make-an-existing-git-branch-track-a-remote-branch)）或指定要获取的远程和分支（即`git fetch origin branch`

# html - 删除 Internet Explorer 中的图像图标

> ID：11478564
> 
> 赞同：0
> 
> 时间：2012-07-13T21:21:44.083
> 
> 标签：html, css, internet-explorer

我正在使用 CSS 样式“订阅”，并在提交按钮中使用。这在所有浏览器中看起来都不错，期望 ie 。在即有一个重叠的图像。如何删除它？ [http://postimage.org/image/o5stss847/](http://postimage.org/image/o5stss847/)

```
<input class="button" id="subscribe" type="image" /></center> 
```

# html - 建议浏览器提前换行？

> ID：11478570
> 
> 赞同：3
> 
> 时间：2012-07-13T21:22:16.393
> 
> 标签：html, css

所以，我有一个`<p>`元素，里面有一些文本和`text-align: center`. 如果文本超出了给定的宽度，它将开始换行到下一行。这有时会在底部留下一个字。如果需要换行，有没有办法让浏览器尝试将行平均分成两半？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T06:30:36.837

您可以在最后两个单词之前使用不间断空格而不是普通空格，或者通常在应该出现在同一行的任何连续单词之间使用。例如，

```
<p>This does <em>not</em> leave a single word hanging at the&nbsp;bottom.</p> 
```

# c - 结构中的结构

> ID：11478572
> 
> 赞同：0
> 
> 时间：2012-07-13T21:22:30.340
> 
> 标签：c, memory

任何人都可以帮助我使用以下代码吗？程序运行正常。

这些是我的问题：

1.  为什么点运算符在c中工作？
2.  `s1`当我只为一个结构分配足够的内存时，为什么我能够访问堆栈结构（即）两次？怎么变成数组了？
3.  谁能解释一下这里的内存是如何分配的？

编码：

```
#include <stdio.h>
#include <conio.h>
#include <stdlib.h>

typedef struct
{    
    struct mynode
    {
        int val;
        struct mynode *next;    
    } node;        
} stack;

int main()
{
    stack *s1;
    s1=(stack*)malloc(sizeof(stack));

    s1[0].node.val=10;
    s1[1].node.val=20;
    printf("%d",s1[1].node.val);

    getch();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T21:27:56.177

1.  我不明白你的意思。点运算符访问结构的成员，这就是它的作用。
2.  你不能，你在做违法的事情。C 没有阻止你做坏事的机制，尽管如果你做了“足够”的坏事，你的程序就会崩溃。你在这里很幸运。它没有变成一个数组，你只是把它当作一个数组来对待。编译器无法判断它是指向一个元素还是多个（数组）的指针，因此它允许您将任何指针视为数组。由你来确保这是一件有效的事情。
3.  马洛克。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T02:03:26.380

1) C 中的点运算符只是一种允许您访问结构成员的语言结构。您正在使用它来访问结构的成员，所以它是完全合法的。它没有理由不工作。

在 C# 中，您也可以使用“.”。调用对象内部的函数。也就是说，如果你在 C# 中有以下类

```
public class foo()
{
  public void print_hello()
  {
    Console.Writeline("Hello,World");
  }  

 } 
```

您可以通过以下方式使用它：

```
foo object1 = new foo();
foo.print_hello(); 
```

2)

线

```
 stack *s1 
```

将 s1 声明为指向结构 stat 的指针。但这还没有结束。您可以使用它来指向多个内存区域，每个区域都包含一个堆栈结构。

当你声明一个数组（例如一个 int 数组）时，你可以用传统的方式来做。

```
int  integersArray [10]; 
```

（这样程序会自动分配内存，您不必担心）。您也可以使用指针。在这种情况下，您可以按如下方式声明您的数组。

```
 int * integersArray; 
```

这可以是指向一个或多个内存段的指针，具体取决于您如何分配它。请注意，上面的代码与上一个不同，它不分配内存，它只是声明了一个指向结构的指针。您需要通过以下方式显式分配内存

```
 integersArray = malloc(10*sizeOf(int)); 
```

Wich 将分配足够的内存来容纳 10 倍于 int 的大小。即 10 个整数。在这两种情况下，您都可以使用 integersArray 作为普通数组和代码

```
printf("%d",integersArray[0]); 
```

作品。在第二种情况下，您可以通过递增或递减指针来移动数组。通过做

```
integersArray++ 
```

您正在将指针移动到下一个内存部分。如果您执行 integersArray+=11; ，鉴于您的数组有 10 个位置，您现在处于无效的内存段中，并且任何事情都可能发生（如果您最终进入受保护的内存段，您的程序，如上面的评论中所指出的将被终止）。

@Alex：分割。只要他的随机指针取消引用（偶然）落在他的内存段内，C 就不会抱怨，他会收到恰好位于该内存位置的任何垃圾。一旦他到达他的段之外，内核很可能会杀死他的进程。– jforberg 1 小时前

您的程序基本上在做同样的事情，但使用 s1 代替。

3）这部分代码

```
s1=(stack*)malloc(sizeof(stack)); 
```

正在分配内存，足以容纳一种堆栈类型的结构。一般来说，要为 n 个元素分配内存，你会这样做

```
yourPointer = malloc(n*sizeof(structure)); 
```

那么，当您尝试像这样访问您的结构时，为什么您的程序可以正常工作？

```
 s1[1].node.val=20;
    printf("%d",s1[1].node.val); 
```

我最好的猜测是您很幸运能够访问有效内存。但这可能并非总是如此。我建议您在处理动态内存时要非常小心。

注意：即使上述内容足够清楚，我也强烈建议您查看 K&R 的书，这会更清楚地解释它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:57:33.733

这段代码比你写的更深入。我会让你开始设置它，但我建议你在 C 中查找主题“链接列表”，因为它根本不像堆栈。

下面是一些结构代码，可帮助您开始实现。这适用于您的情况，但如果您想继续，您可能需要创建一个初始化程序和一个 addNode 函数。这是一个链接，您可以了解有关链接列表的更多信息：http: [//www.codeproject.com/Articles/24684/How-to-create-Linked-list-using-CC](http://www.codeproject.com/Articles/24684/How-to-create-Linked-list-using-C-C)

```
#include "stdlib.h"
#include "stdio.h"
typedef struct _node_ {
    int val;
    struct _node_ * next;
}mynode;

typedef struct _linkedlist_ {
    mynode * node;
}linkedlist;

int main() {
linkedlist * s1 = (linkedlist*) malloc(sizeof(linkedlist));
s1->node = malloc(sizeof(mynode));
s1->node->next = malloc(sizeof(mynode));
s1->node->val = 10;
s1->node->next->val = 20;
printf("%d",s1->node->next->val);
free(s1->node->next);
free(s1->node);
free(s1);
//getch(); //don't know what this is for
return 0; 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T21:35:11.277

使用此代码，您只有一个 struct alocated ：

`s1=(stack*)malloc(sizeof(stack));`

对于两个位置尝试：

`s1=(stack*)malloc(sizeof(stack) * 2);`

# c# - 更改路由值会中断表单提交...MVC3

> ID：11478574
> 
> 赞同：0
> 
> 时间：2012-07-13T21:22:39.347
> 
> 标签：c#, asp.net-mvc-3

我在 global.asax 中更改了路由，因此如果手动输入查询字符串，则该值将保留在地址栏中：

```
 routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Account", action = "LogOn", id = UrlParameter.Optional}   
        );
        routes.MapRoute(
            "OrderId", // Route name
            "{controller}/{action}/{db}", // URL with parameters
            new { controller = "Account", action = "LogOn", db = UrlParameter.Optional}                   ); 
```

我在这里有 2 个值，因为 id 参数在整个应用程序中使用，例如：

```
 public ActionResult AddNote(string id) 
```

db 参数是为了防止用户想要连接到不同的数据库并通过查询字符串输入并在出现问题时保留在 url 中，例如错误的用户名/密码。

```
 thesite.com/?db=somedb 
```

该应用程序像以前一样工作，除了没有像这样指定操作的表单：

```
 @using (Html.BeginForm()) 
```

此表单将呈现给客户端

```
 <form method="post" action="/UserTasks/NewOrder/Index"> 
```

永远不会调用操作“/UserTasks/NewOrder/Index”。没有错误或任何东西。我原来的 global.asax 看起来像这样，表单会按预期发回服务器：

```
 routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id= UrlParameter.Optional }
        ); 
```

Home/Index 操作除了重定向到 Account/LogOn 之外什么也没做，这就是为什么我消除了 Home/Index 调用并直接转到 Account/Logon 的主页。

我需要在 global.asax 中进行哪些更改，以便我所有没有显式输入操作的表单都会像以前一样触发 ASP.Net MVC 提供给它的默认操作？谢谢

# algorithm - 类似于背包算法的算法（但不是真的）

> ID：11478577
> 
> 赞同：0
> 
> 时间：2012-07-13T21:22:55.440
> 
> 标签：algorithm, set, knapsack-problem

我有一组大小为 n 的数字（假设 n > 100）。

我也有一个硬限制 x。

我想要的是从我的集合中获取可变数量的元素并找到这些元素的组合，以便在相加时总和为 <= x，但尽可能接近 x。

显然我不想采用蛮力方法，有没有一种有效的算法可以解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:28:03.897

这似乎非常适合常用的伪多项式背包算法，可以在您已经拥有的文本中进行讨论，或者在[本 PDF的第 41 页提供](http://www2.informatik.hu-berlin.de/alcox/lehre/lvws1011/coalg/knapsack.pdf)

# php - php xpath 返回整个 html

> ID：11478578
> 
> 赞同：2
> 
> 时间：2012-07-13T21:22:56.413
> 
> 标签：php, html, xpath, curl, screen-scraping

为什么这会返回整个 html 文档，而不仅仅是来自包含“H+R+E”的节点的值？

html示例：

```
<tr class="linesAlt1">
        <td>04:10 PM</td><td style="width:53%;">3055&nbsp;Over</td><td style="width:22%;">3&nbsp;H+R+E&nbsp;&nbsp;+146</td>
    </tr> 
```

我想得到`"3&nbsp;H+R+E&nbsp;&nbsp;+146"`。但这会转储所有 html。

```
<?php

$url = 'http://www.pinnaclesports.com/ContestCategory/MLB+Propositions/July+13~2C~+2012/Lines.aspx';
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
$html = curl_exec($ch);
curl_close($ch);

$doc = new DOMDocument();
$doc->loadHTML($html);
$xpath = new DOMXPath($doc);

foreach ($xpath->query("//table/tr/td[contains(., 'H+R+E')]") as $textNode){
  echo $textNode->nodeValue."\n";
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T04:30:21.293

`curl_exec`默认情况下打印到`STDOUT`，这就是您所看到的。换句话说，您没有在该循环中捕获任何输出`$html`（或在该循环中打印任何内容）。首先，您需要重定向输出：

```
curl_setopt($ch, CURLOPT_FILE, fopen('php://stdout', 'w'));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
curl_setopt($ch, CURLOPT_URL, $url);
$html = curl_exec($ch); 
```

解决该问题后，我查看了提供的 URL 的来源，但在其中的任何地方都找不到该文本`H+R+E`。它有一张桌子，但没有那个内容。你正在寻找不存在的东西。

要证明它现在可以正确检索文件，请尝试以下完整示例：

```
$url = 'http://www.pinnaclesports.com/ContestCategory/MLB+Propositions/July+13~2C~+2012/Lines.aspx';
$ch = curl_init();
curl_setopt($ch, CURLOPT_FILE, fopen('php://stdout', 'w'));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
curl_setopt($ch, CURLOPT_URL, $url);
$html = curl_exec($ch); 
curl_close($ch);

$doc = new DOMDocument();
$doc->loadHTML($html);
$xpath = new DOMXPath($doc);

foreach ($xpath->query("//table") as $table){
      echo "[" . $table->nodeValue . "\n";
} 
```

...产生以下输出（`loadHTML`省略警告）：

```
[
                    客户编号：

                    密码：

```

有关设置 cURL 选项的更多信息：

*   [http://php.net/manual/en/function.curl-setopt.php](http://php.net/manual/en/function.curl-setopt.php)
*   [http://php.net/manual/en/function.curl-setopt-array.php](http://php.net/manual/en/function.curl-setopt-array.php)

# oracle - Oracle 9 中的运算符优先级

> ID：11478584
> 
> 赞同：2
> 
> 时间：2012-07-13T21:23:19.903
> 
> 标签：oracle

有谁知道 Oracle 9 和 Oracle 10 之间的运算符优先级是否有一些重大变化？

与 10 相比，AND / OR 在 9 中的处理方式似乎有所不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T00:21:06.430

9I 和 10G 的 AND 都具有比 OR 更高的优先级（根据这些 URL）

此 URL 确实列出了 PL/SQL 编译器评估中的一些更改，但这些更改与 AND 或 OR 无关：http: [//oraclefunda.wordpress.com/2008/06/18/plsql-enhancements-in-oracle-数据库-10g/](http://oraclefunda.wordpress.com/2008/06/18/plsql-enhancements-in-oracle-database-10g/)

参考文献（AND 和 OR 评估）：

10G：

[http://www.di.unipi.it/~ghelli/didattica/bdldoc/B19306_01/appdev.102/b14261/expression_definition.htm](http://www.di.unipi.it/~ghelli/didattica/bdldoc/B19306_01/appdev.102/b14261/expression_definition.htm)

PL/SQL 当 PL/SQL 计算布尔表达式时，NOT 具有最高优先级，AND 具有次高优先级，而 OR 具有最低优先级。但是，您可以使用括号来覆盖默认的运算符优先级。

9I： [http](http://docs.oracle.com/cd/B10501_01/appdev.920/a96624/02_funds.htm#3860) : //docs.oracle.com/cd/B10501_01/appdev.920/a96624/02_funds.htm#3860 最高：**、+、-、*、/、+、-、||、=、< , >, <=, >=, <>, !=, ~=, ^=, IS NULL, LIKE, BETWEEN, IN, NOT, AND, OR

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T00:01:40.387

[根据手册， 9i](http://docs.oracle.com/cd/B10501_01/server.920/a96540/conditions2a.htm#1033288)和[10g](http://docs.oracle.com/cd/B19306_01/server.102/b14200/conditions001.htm#i1034834)中的条件优先级没有区别。（假设你的意思是条件，而不是操作符。对于操作符来说，故事是一样的，除了 10g 有一个新的操作符，`connect_by_root`.）

这是优先级，从高到低排列：

```
SQL operators are evaluated before SQL conditions
=, !=, <, >, <=, >=,
IS [NOT] NULL, LIKE, [NOT] BETWEEN, [NOT] IN, EXISTS, IS OF type
NOT
AND
OR 
```

正如@Rajesh Chamarthi 所提到的，改变它会导致各种各样的问题，而且我从来没有遇到过版本之间的优先级差异。

但是，如果有一些特定的错误，或者一些罕见的模棱两可的陈述被区别对待，我不会感到惊讶。

# sencha-touch-2 - 在 Sencha Touch 2 中裁剪图像（选择区域）？就像 Jcrop

> ID：11478592
> 
> 赞同：1
> 
> 时间：2012-07-13T21:24:32.493
> 
> 标签：sencha-touch-2, jcrop

这正是我需要的，并且可以在移动 Safari 中使用：http: [//deepliquid.com/content/Jcrop_Manual.html](http://deepliquid.com/content/Jcrop_Manual.html)

我需要在 Sencha Touch 2 中执行此操作

我可以从头开始或基于 Jcrop 推出自己的项目，但我的项目预算可能不支持这么多时间。所以，我想最快的方法是将 jQuery 添加到 ST2 项目中，然后将插件的使用破解到 ST2 视图之一中。

所以我的问题是，我应该如何加载 jQuery——现在我已经让 ST2 按需加载我的 JS 文件（它们不在 index.html 中）。

或者

你能给我指出 Jcrop 的 ST2 替代品吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T10:59:33.303

**你能给我指出 Jcrop 的 ST2 替代品吗？**

据我所知，目前没有 ST2 替代品。我目前正在研究一个，但可能需要数周时间才能完成。

**我应该如何加载 jQuery**

我认为没有办法只加载您需要的 jQuery 部分，所以只需添加类似这样的内容添加 index.html 文件的末尾：

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T07:45:53.823

您可以拥有开发所需的框架。只有 JS 文件正确引导每个框架。

我目前在我的金融业务开发中使用 Sencha Touch 2 和 JQuery mobile。

我希望这有帮助。:)

# c# - 如何将上午/下午添加到日期时间

> ID：11478594
> 
> 赞同：1
> 
> 时间：2012-07-13T21:24:40.343
> 
> 标签：c#, asp.net, asp.net-mvc

在我的应用程序中，我有以下字段：日期选择器、小时下拉列表、分钟下拉列表和上午/下午下拉列表。

在我的控制器中，我试图将这些字段联系在一起并创建一个这样的 DateTime 值（5/18/2012 2:45 PM）：

```
var datex = new DateTime(model.Scheduled.Value.Year, model.Scheduled.Value.Month, model.Scheduled.Value.Day, model.ScheduledHour, model.ScheduledMinute, 0); 
```

在上面，如何包含用户在 UI 上选择的 AM/PM 值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:28:56.457

你可以做类似的事情

```
model.ScheduledHour + (model.AmPm == "AM" ? 0 : 12); 
```

# c# - 用程序资源中的文件覆盖文件

> ID：11478595
> 
> 赞同：0
> 
> 时间：2012-07-13T21:24:42.107
> 
> 标签：c#, file, resources, overwrite, visual-c#-express-2010

我在从应用程序资源中的另一个文件覆盖文件内容时遇到问题。我尝试使用`File.WriteAllBytes(path, Properties.Resources.MyResource)`，但它没有用。我知道文件在那里，它永远不会不存在。我需要做的只是将资源复制到指定的路径。我应该起作用的功能：

```
public void Swap(bool v) {
        byte[] file = Properties.Resources.Resource;
        if (v) {
            file = Properties.Resources.Resource;
        } else {
            file = Properties.Resources.Backup;
        }
        stateBox.IsChecked = v;
        string path = Process.GetProcessesByName("Process")[0].Modules[0].FileName.Replace("Process.exe", "") + "File.txt";
        MessageBox.Show(path);
        File.Create(path);
        File.WriteAllBytes(path, file);
    } 
```

# android - 如何让隐藏的软键盘在 WebView 中显示备份？

> ID：11478596
> 
> 赞同：0
> 
> 时间：2012-07-13T21:24:45.410
> 
> 标签：android, webview, keyboard, android-edittext

当用户按下 go 按钮导航到某个 URL 时，键盘被隐藏以离开。但是当有人按下 webview 中的输入字段时，它仍然消失了。我如何让它回来呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:08:45.957

您无法在 WebView 输入字段中控制键盘。但是您可以更改键盘的布局/视图。在键盘中，我们有数字、字符、符号等选项。

# codeigniter - 在 CodeIgniter Web 应用程序的不同页面上使用 RequireJS 和 Backbone

> ID：11478600
> 
> 赞同：5
> 
> 时间：2012-07-13T21:25:09.267
> 
> 标签：codeigniter, backbone.js, requirejs

我正在用 CodeIgniter 在后面和 Backbone/RequireJS 在前面构建一个 Web 应用程序。因此，它不是一个单页 Web 应用程序，而是仍然将 CI 用于许多控制器操作，并使用 Backbone 用于不同时间的各种视图。我有这样的 RequireJS/Backbone 设置：

```
<script type="text/javascript" data-main="main" src="require.js"></script> 
```

main.js 看起来像：

```
require.config({
  paths: {
           jquery: "https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min",
           underscore: "libs/underscore",
           backbone: "libs/backbone",
           //Lots of other stuff
          },
  shim: {
           backbone: {
              deps: ["underscore", "jquery"],
          }
          // lots of other stuff
  }
  });

require(['views/app'], function(AppView){
    var app_view = new AppView;
}); 
```

Main.js 加载到我的主模板中，即每个页面上，然后加载整个站点/应用程序中常见的一堆视图 - 标题、导航等。

但是在不同的页面上，除了常见的视图之外，我还想加载不同的视图。因此，例如，在一个名为“发布”的页面上——它本身几乎是一个应用程序——我这样做：

```
<script type="text/javascript" src="publish.js"></script> 
```

在 main.js 之后加载，如下所示：

```
//publish.js
 require(['views/publishview], function(PublishView){
 var publishView = new PublishView;
 }); 
```

基本上，它有一半的时间有效，而另一半（当我刷新时）我在所有东西上都得到 404。

那么有没有一种简洁的方法可以将我的基本需求配置用于所有内容，但在不同的时间也需要不同的部分？如果整个事情是一个 SPA，这似乎很容易做到，但对我来说，应用程序的很大一部分仍然使用 CodeIgniter。

很抱歉没有更好地表达这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:12:19.343

不确定这是否是正确的方法，但我会怎么做：

模板 (php)

```
<script type="text/javascript">
var myApp = {};
myApp.section = '<?= $section ?>'; //for exambple 'someSection'
</script>
<script type="text/javascript" data-main="main" src="require.js"></script> 
```

然后，使用类似的东西：

(main.js)

```
var requires = {
someSection: {files: ['views/app'], handler: function(AppView){
    var app_view = new AppView;
}}
};

var myRequire = requires[myApp.section] || null;
if(myRequire) require(myRequire.files, myRequire.handler); 
```

或者...使用 window.location.pathname 值代替 myApp.section

# cucumber - 有没有办法在 Cucumber After 钩子中的异常消息中添加一些东西？

> ID：11478603
> 
> 赞同：1
> 
> 时间：2012-07-13T21:25:34.757
> 
> 标签：cucumber

这将输出异常消息：

```
After {|scenario| p scenario.exception.message} 
```

我想在那里添加一些文本，如下所示：

```
After {|scenario| scenario.exception.message << "extra data"} 
```

但当然，这是行不通的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T12:35:08.513

看起来这样做的方法是创建自定义 Cucumber 格式化程序。像这样的东西：

```
require 'cucumber/formatter/junit'

module Cucumber::Formatter
  class Custom < Junit
    def format_exception(exception)
      (["extra data"] + ["#{exception.message} (#{exception.class})"] + exception.backtrace).join("\n")
    end
  end
end 
```

然后使用自定义格式化程序运行功能：

```
$ cucumber --format Cucumber::Formatter::Custom --out reports 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T23:43:35.230

如果你写：

```
After do |scenario|
  p scenario.exception.message
end 
```

并在控制台中运行 Cucumber，您将看到它在执行 After 钩子之前将自己的异常消息打印到控制台。

因此，据我了解，您无法更改 Cucumber 的异常消息，因为它已经打印到输出中。

作为一种解决方法，您可以提出自己的异常：

```
After do |scenario|
  raise 'my message'
end 
```

它将出现在 Cucumber 的输出中

# java - 循环中添加到集合中的对象何时会被垃圾收集？

> ID：11478612
> 
> 赞同：1
> 
> 时间：2012-07-13T21:26:35.270
> 
> 标签：java, garbage-collection

在下面的代码中

```
List<SomeObject> someObjectList = new ArrayList<SomeObject>();

do {

    SomeObject someObject = new SomeObject();

    someObjectList.add(someObject);

} while(some condition is met); 
```

**我的问题**

1.  someObject 什么时候会被抓取？
2.  我在这里泄漏内存吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:27:41.200

> someObject 什么时候会被抓取？

`someObject` 当它不再可达时将被 GCed。在提供的简单示例中，当发生以下任一情况时，可能会发生这种情况：

*   `someObjectList`不再可达
*   `someObject`被移除`someObjectList`（从而使其不再可达）

> 我在这里泄漏内存吗？

据我所知，您的代码中没有任何迹象表明内存泄漏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T21:29:30.873

`someObject`在您的循环退出之前不会被 GC 处理。这是否是内存泄漏还有待解释。如果您希望它在仍在迭代时被释放，那么您正在泄漏。如果不是，那么你不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:31:46.797

`someObject`是一个局部变量，永远不会被垃圾收集。这`someObject`是堆栈或寄存器中的“东西”。局部变量本身不是 java 对象。

`someObject`暂时持有对 的实例的引用`SomeObject`。并且该引用存储在数组列表内的数组中。

`SomeObject`在没有其他对象持有对该实例的引用之后，该实例将被垃圾收集一段时间。

# java - jbyte* 作为 JNI 中本机 C++ 方法的 ByteBuffer

> ID：11478613
> 
> 赞同：1
> 
> 时间：2012-07-13T21:26:36.153
> 
> 标签：java, c++, macos, java-native-interface, bytebuffer

这是本机 C++ 方法。

```
JNIEXPORT jboolean JNICALL Java_xpnp_XpNamedPipe_readBytes
(JNIEnv* pEnv, jclass cls, jlong pipeHandle, jbyteArray readBufferJava, jint bytestoread, jint timeoutMsecs){

    jbyte* readBuffer = NULL;
    try {
        readBuffer = pEnv->GetByteArrayElements(readBufferJava, NULL);
        if (readBuffer == NULL) {
            throw std::bad_alloc();
        }
        int retval = XPNP_readBytes ((XPNP_PipeHandle)pipeHandle, (char*)readBuffer, bytestoread, timeoutMsecs);

        std::cout<<"this is what I read: " << readBuffer << "\n";
        std::flush(std::cout);

        return (retval <= 0) ? 0 : retval;
    }catch (std::exception& except) {
        // setErrorInfo(except.what());
    }
    return 0;
} 
```

此方法打印`readBuffer`从 call 读取的正确文本`XPNP_readBytes`，但将全零数组传递给 Java！知道为什么会这样吗？我在传递指针或将其转换为 Java 时做错了什么？

这是 Java 文件中本地 C++ 方法的声明。

```
private static native boolean readBytes(long pipeHandle, byte[] buffer, int bytesToRead, int timeoutMsecs); 
```

这是我调用本机方法的地方。

```
boolean b = readBytes(namedPipeHandle, buffer, bytesToRead, timeoutMsecs);
String a = new String(buffer); 
```

我在调用后读到的`buffer`都是 0，即使它在本机代码中打印了正确的文本！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:41:48.993

抬头看`ReleaseByteArrayElements`。

# c++ - IOS 文件路径空间在传递给库方法时被拆分

> ID：11478616
> 
> 赞同：0
> 
> 时间：2012-07-13T21:26:56.987
> 
> 标签：c++, objective-c, ios, unix

我已经获得了一个静态库来使用它接受参数作为空格分隔的字符。

**库中的方法**

```
int saveFile(char* param); 
```

我将文档文件路径传递给它以保存到

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
std::string str = [documentsDirectory cStringUsingEncoding:[NSString defaultCStringEncoding]];
const char * filePath = str.c_str();
char pa[1024];
pa[0] = 0;
strcat(pa, filePath);
saveFile(pa); 
```

我的问题是 IOS 文件路径中有空格，这会导致库在这些位置拆分路径。我尝试用“\”转义空格，当然，在这种情况下，将路径放在引号中不起作用。例如下面...

```
/Users/bigbadowl/Library/Application Support/iPhone Simulator/5.1/Applications/649D2EEB-8C88-42C7-9A74-21629570B1D0/Documents 
```

将被拆分为

```
/Users/bigbadowl/Library/Application
Support/iPhone
Simulator/5.1/Applications/649D2EEB-8C88-42C7-9A74-21629570B1D0/Documents 
```

任何想法，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:36:41.623

一种解决方案是将原始字符串中的空格替换为不太可能使用的字符（例如`#`），执行库操作，然后将该字符的所有出现恢复为空格。类似于以下内容：

```
// ...
std::replace(str .begin(), str .end(), ' ', '#');  // Replace spaces with #
const char * filePath = str.c_str();
char pa[1024] = {0};
strcat(pa, str.c_str());
std::replace(str .begin(), str .end(), '#', ' ');  // Replace # with spaces
// ... 
```

当然，如果原始字符串包含此字符，您将不会获得所需的行为。你总是可以测试这个并选择另一个字符，所以这应该不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T22:51:35.907

我认为这只会是模拟器的问题。如果您无法更改 saveFile，那么您可能需要查看是否可以欺骗模拟器。

作为测试，看看你是否可以`/Users/bigbadowl/Library/Application Support/iPhone Simulator`在`/Users/bigbadowl/`named中创建一个符号链接`iphonesim`。然后替换`Library/Application Support/iPhone Simulator`为`iphonesim`.

你最终会`/Users/bigbadowl/iphonesim/5.1/Applications/649D2EEB-8C88-42C7-9A74-21629570B1D0/Documents`得到没有空格的路径。看看是否`saveFile()`可以使用它。

祝你好运。

# php - 基于 Flash/HTML5 的视频播放器，可在播放文件后删除临时文件

> ID：11478620
> 
> 赞同：0
> 
> 时间：2012-07-13T21:27:47.570
> 
> 标签：php, flash, html, caching, video-streaming

我正在为我的学生制作视频文件，并通过 Dropbox 与他们分享这些文件。我要做的是，防止非法复制这些文件。换句话说，我的服务是有偿的，目前一个人可以付费，然后免费与其他人分享。所以我想制作我的文件，以便只有付费的人才能查看这些文件。没有别人了

我正在尝试找到安全的基于 HTML5 或 Flash 的网络视频播放器（用于基于 php 的网站），它不会缓存视频或在播放后删除。原因是，要防止源视频文件下载。有没有为此目的的免费插件？有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T21:55:27.343

只需使用 Youtube 的[私人视频](http://support.google.com/youtube/bin/answer.py?hl=en&answer=157177)功能。它将阻止所有未经授权的下载/观看视频的方式：没有下载器或在线下载服务会下载私人视频。执行以下操作：

1.  创建 youtube 帐户（如果您有帐户，请登录）
2.  将您的视频上传到您的 Youtube 频道
3.  将上传的视频设为私有
4.  邀请他人观看此视频

只有受邀的人才能看到它（在你的情况下是你的学生）。

![在此处输入图像描述](../Images/c40fa5071939fe53d8b73564364a5026.png)

# c# - MVC 中的 UI 与业务逻辑

> ID：11478621
> 
> 赞同：0
> 
> 时间：2012-07-13T21:27:48.423
> 
> 标签：c#, asp.net-mvc

所以MVC被拆分成

*   模型
*   看法
*   控制器层

我以为在准备好很多页面后我已经掌握了每一层的作用，但我仍然对一个领域感到困惑，那就是模型或控制器中是否应该有东西。

我知道数据存储类应该放在控制器中 我知道 UI 修改器（即拉出正确的模型）应该放在控制器中

但是模型修饰符呢。因此，例如，如果我们采用软件购物车方法，假设有人单击结帐按钮，填写他们的付款详细信息并且所有内容都已批准，则回发恰好可以处理此问题。

回发对象需要

1.  在数据库表中添加一个条目，表示允许 X 用户下载 Y 软件
2.  向用户发送收据
3.  记录购买

通常（在非 MVC 上）方法我会创建一个类来处理软件表的访问生成，它会调用 EF 来存储信息。我会有一个二级课程来发送通知，还有一个三级课程来记录信息。

我是否应该在 MVC 中仍然拥有这些类，如果是，它们将是作为控制器还是模型的类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:38:59.967

您在上面定义的所有三个点都构成了应用程序模型的一部分；控制器应该只处理模型和呈现给用户的 UI 表示（视图）之间的编排。

坚持 SOLID 原则，我们绝对同意我们正在处理（至少）三个独立的组件：

1.  持久化用户 x 下载软件 y 的数据
2.  开具收据
3.  日志记录

您可以通过多种方式来组织架构和组件来执行此操作。一种方法是拥有一个依赖于这三个组件的应用程序特定组件/服务，并使用它们来执行列出的操作。然后控制器只依赖这个组件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T21:55:52.267

要更详细地扩展[Russ 的出色答案](https://stackoverflow.com/a/11478738/304832)，请考虑以下几点：

```
public class CheckoutController
{
    private readonly ICommandHandler<CheckoutCommand> _checkoutHandler;

    public CheckoutController(ICommandHandler<CheckoutCommand> checkoutHandler)
    {
        _checkoutHandler = checkoutHandler;
    }

    [HttpPost]
    public virtual ActionResult Post(CheckoutViewModel viewModel)
    {
        if (!ModelState.IsValid) return View(viewModel);
        var command = Mapper.Map<CheckoutCommand>(viewModel);
        _checkoutHandler.Handle(command);
        return RedirectToAction("Complete");
    }

    public virtual ActionResult Complete()
    {
        return View();
    }
} 
```

控制器根本没有做任何生意。它为用户提供控制流。现在，考虑将这个依赖注入到控制器中：

```
public class DomainCheckoutCommandHandler : ICommandHandler<CheckoutCommand>
{
    private readonly IEntityDataStorage _repos;
    private readonly IEmailSender _email;
    private readonly ILogger _log;

    public DomainCheckoutCommandHandler(IEntityDataStorage repos, 
        IEmailSender email, ILogger log)
    {
        _repos = repos;
        _email = email;
        _log = log;
    }

    public void Handle(CheckoutCommand command)
    {
        // use _repos to Add an entry to a database table
        // use _email to issue the receipt
        // use _log to log the purchase
    }
} 
```

[在这](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=91) [三篇](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=92) [文章](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=93)中有一些关于像这样使用接口 + DI 的重要信息。

最好的部分是您可以将所有其他代码——接口、域类和其他接口实现——完全移到 MVC 项目之外。这样，MVC 项目中的任何事情都不会做任何业务。它只是委托给由您的业务层或其他类库实现的接口。

# node.js - 为什么这个简单的 node.js 代码会冻结？

> ID：11478628
> 
> 赞同：0
> 
> 时间：2012-07-13T21:28:20.690
> 
> 标签：node.js, asynchronous, redis, express

这是示例 node.js 代码的扩展：

```
var express = require('express');
var application = express.createServer();

var redis = require("redis"),
    client = redis.createClient();

client.on("error", function (err) {
    console.log("Error " + err);
});

client.set("test key", "TEST KEY VALUE", redis.print);

application.get('/', function(request, response) {
        client.get('test key', function(err, value) {
            client.quit();
            response.send('The value of "test key" is: ' + value);
        });
});

application.listen(2455); 
```

服务器启动正常，但在访问时，页面加载了一段时间，最终出错 - “未收到数据”。

我有 redis 运行，密钥保存得很好，我也可以通过 client.get() 在节点的 repl 中很好地访问它们。

我想我缺少一些关于异步程序如何工作的理论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:01:01.590

我不认为 Redis/redis 库需要你明确地终止客户端连接。即使这样做，您也需要确保在退出客户端之前已调用和处理成功或错误回调。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T18:35:28.283

您可能会收到错误，并且因为您没有在 res.send 之前检查*err变量，所以您的应用程序不会返回任何内容。*尝试添加如下内容： `if(err) throw err;` 在 client.get 之后并检查 STDOUT

# php - PHP - 跨类使用 PDO 连接

> ID：11478632
> 
> 赞同：1
> 
> 时间：2012-07-13T21:28:32.023
> 
> 标签：php, oop, pdo

[编辑/更新]

请允许我解释一下情况。我有三个文件：

下面是 db.class.php。调用时，它在构造函数中连接到数据库，并在析构函数中关闭连接。如果您注意到 query() 方法，那么它现在只是一个静态 INSERT，因为这就是我被卡住的地方。

```
<?php
//
// Class: db.class.php
// Desc: Connects to a database and runs PDO queries via MySQL
// Settings:
error_reporting(E_ALL);
////////////////////////////////////////////////////////////
class Db
{
    # Class properties
    private $DBH; // Database Handle
    private $STH; // Statement Handle

    # Func: __construct()
    # Desc: Connects to DB
    public function __construct()
    {
        // Connection information
        $host   = 'localhost';
        $dbname = 'removed';
        $user   = 'removed';
        $pass   = 'removed';

        // Attempt DB connection
        try
        {
            $this->DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);
            $this->DBH->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
            echo 'Successfully connected to the database!';
        }
        catch(PDOException $e)
        {
            echo $e->getMessage();
        }
    }

    # Func: query(sql statement)
    # Desc: Sends a query to the DB
    public function query($sql_statement)
    {
        $sql = array(':color' => $sql_statement);
        $this->STH = $this->DBH->prepare("INSERT INTO color_table (color) value ( :color )");
        $this->STH->execute($sql);
    }

    # Func: __destruct()
    # Desc: Disconnects from the DB
    public function __destruct()
    {
        // Disconnect from DB
        $this->DBH = null;
        echo 'Successfully disconnected from the database!';
    }
}
?> 
```

下面是colors.class.php。目前，它只有一个插入功能。我要做的基本上是从 db.class.php 中提取我在 query() 函数中的内容并将其放入 insertColor() 函数中，并传递整个 SQL 语句，无论它是插入、删除、或更新到 query() 函数。

```
<?php
//
// Class: colors.class.php
// Desc: Provides methods to create a query to insert,
//       update, or delete a color from the database.
////////////////////////////////////////////////////////////
class Colors
{
    # Class properties
    protected $db;

    # Func: __construct()
    # Desc: Passes the Db object so we can send queries
    public function __construct(Db $db)
    {
        $this->db = $db;
    }

    # Func: insertColor()
    # Desc: Sends an INSERT querystring
    public function insertColor($color)
    {
        $this->db->query($color);
        echo 'Inserted color:' . $color;
    }
}
?> 
```

下面我们有colors.php，上面的所有内容都被实例化和实现。所以在这里我将传递我真正想要插入数据库的颜色。

```
<?php
Require('db.class.php');
Require('colors.class.php');

$db = new Db;
$colors = new Colors($db);
$colors->insertColor('TestColor'); // Passing the color here to be put into an insert statement

?> 
```

我基本上被卡住的地方是我试图让 colors.class.php 创建一个 PDO 语句，然后在它们准备好运行时将其传递给 db.class.php query() 方法。现在，PDO 语句只是在 query() 方法中定义，但我试图避免这种情况。本质上，我想从 query() 方法中提取我所拥有的内容，并将其拆分为 Colors 类中的三个方法，一个用于插入、更新和删除。

但是，我对 OOP 编程相当陌生，并且对所有语法都有问题，我也不知道这是否是一个好方法。非常感谢任何帮助，如果需要更多详细信息或信息，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:32:28.253

是的，因为`$db`是方法内部的局部变量。将其作为参数传递：

```
class Colors
{
  protected $db;

  public function __construct(Db $db = null)
  {
    $this->db = $db;
  }

  public function insertColor()
  {
    if ($this->db != null)
    {
      $this->db->query();
    }
  }
} 
```

并且`query`是一种方法，因此您必须添加括号：`$db->query()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T22:22:22.427

我会从您的类文件中删除数据库的包含和初始化，并将其放入其中`colors.php`。然后将`$db`作为参数传递给构造函数：

```
<?php
Require('db.class.php');
Require('colors.class.php');

$db = new Db;

$colors = new Colors($db);
$colors->insertColor();
?> 
```

我还将删除构造函数中的默认值，因为`Colors`如果没有数据库，您的类将无法工作：

```
public function __construct(Db $db)    // constructor Colors class 
```

最后，我会研究类的[自动加载](http://php.net/manual/en/language.oop5.autoload.php)，这样您就不必手动要求它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:32:46.627

更改`$db->query;`为`$db->query();`

此外，需要将 $db 声明为全局变量才能像这样访问它。可能要考虑将其设为私有财产`Colors`

# jquery - 如何防止固定页脚覆盖 JQuery Mobile 页面的内容？

> ID：11478639
> 
> 赞同：1
> 
> 时间：2012-07-13T21:28:59.200
> 
> 标签：jquery, css, jquery-mobile, footer

我有一个 JQuery Mobile 应用程序，但我有自己的复杂页脚 div，无论如何它都位于页面底部（位置：固定），并且不受 JQM 控制（它不是 data-role="footer"，而是在它自己的 div 部分，所以我只有一个用于整个应用程序）

问题是如果它足够长，这个页脚会覆盖内容的最后几行。

我认为解决方案是以某种方式添加页脚大小的填充，以便滚动条可以正常工作以显示内容的最后几行。

所以对于这个例子，我有一个 n 行长的内容。当我滚动到底部时，我想在页脚上方看到这个文件的最后几行。相反，我看不到最后几行，因为它们被页脚覆盖。

欲望：

```
 - - - - - - - - - - - - - - - - - - -
|                                     |
|    Header                           |
|                                     |
 - - - - - - - - - - - - - - - - - - - 
Content Line n-3
Content Line n-2
Content Line n-1
Content Line n
 - - - - - - - - - - - - - - - - - - - 
|                                      |
|  Footer                              | 
```

但我得到

```
 - - - - - - - - - - - - - - - - - - -
|                                     |
|    Header                           |
|                                     |
 - - - - - - - - - - - - - - - - - - - 
Content Line n-6
Content Line n-5
Content Line n-4
Content Line n-3
 - - - - - - - - - - - - - - - - - - - 
|                                      |
|  Footer                              | 
```

**更新：**

多亏了这些回应，它使我走上了正确的道路。

我将以下内容添加到我的 .css 文件中：

```
.ui-content
{
    margin-bottom: 251px; /* The height of the footer */
} 
```

这样做的问题是如果页脚高度发生变化（不同的字体，或者添加了一行），那么这不会自动更新。我想我可以做一些 Javascript 来解决这个问题。

**更新 2：**

我通过实现以下内容使其动态化：

```
.bind('pageinit', function () {
    $(".ui-content").css('margin-bottom', $('#footer').height());
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:49:01.570

因为我假设您的页脚位于内容上方的图层中，所以它们不能专门为彼此腾出空间，所以我建议您在内容末尾的页脚形状上放置一些填充物。正如 MrOBrian 所说，这可以通过将您的内容放在一个`<div margin-bottom=footer height>`、使用`<br />`、创建一个页脚形状`<div>`或您找到的许多其他选项中来完成。

# jquery - 提交表单Jquery时验证字段

> ID：11478640
> 
> 赞同：1
> 
> 时间：2012-07-13T21:29:07.143
> 
> 标签：jquery, validation

我对 Jquery 真的很陌生，但想学习它。我在整个网络上都完成了教程，但现在我想在提交表单之前对其进行验证，但我找不到一个简单的例子。

我有一个表格：

```
<form id="testform">
<input name="test" type="input">
<input type="submit" value="TEST">
</form> 
```

我有这个功能：

```
$(document).ready(function() {
        $('#testform').submit(function(){

            $.get('test.php', $(this).serialize(), function(data){
                $('#test').html(data);
            });             
            return false;
        });
    }); 
```

现在我想要的很简单，让它的名称字段RED的背景颜色为空。请解释如何做到这一点！

* * *

看了你的回答，好像不行。当点击提交按钮时，什么都没有发生，只有表单被清除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:31:41.510

试试这个：

```
$('#testform').submit(function(e) {
      if ($('input[name=test]').val() == "") { // if the input is empty
           $('input[name=test]').css('background-color','red')
           return false
      } else {
         $.get('test.php', $(this).serialize(), function(data){
              $('#test').html(data);
         });             
      }
      return false
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:47:33.127

作为一个 jquery 新手，我会在这里说几件事：

首先，如果您只是要验证几件小事，您绝对应该编写自己的代码。它会比使用插件轻得多（可能......）

但是，如果您要进行大量验证，则可能需要查看 jquery 验证插件（例如[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)），因为它们可以让生活变得更轻松。

（另外，我相信你已经知道这一点，但不要忘记服务器端验证，因为客户端可能会失败！）

快乐编码！

# java - java - 在eclipse中链接文本资源

> ID：11478645
> 
> 赞同：0
> 
> 时间：2012-07-13T21:29:38.780
> 
> 标签：java, eclipse, resources

我想解析一个名为“hops.txt”的文本文件，该文件位于
主项目文件夹中名为“res”的文件夹中。

运行以下代码时：

```
package parsing;

import java.io.InputStream;

public class ParseTest {
public static void main(String[] args) {
    ParseTest pt = new ParseTest();
    pt.foo();
}
public void foo()
{
    InputStream is= this.getClass().getClassLoader().getResourceAsStream("hops.txt");
    System.out.println(is);
    is= this.getClass().getResourceAsStream("hops.txt");
    System.out.println(is);
}
} 
```

我收到以下输出：
null
null

我究竟做错了什么？谢谢！

![项目布局](../Images/ac4e43cb7b52a3390573a1edb1619b95.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:39:27.817

假定路径参数`getResourceAsStream`是相对于您的项目根目录的。由于此文本文件位于项目中的文件夹中，因此您必须在资源路径中包含文件夹名称。

```
this.getClass().getResourceAsStream("/res/hops.txt"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T06:57:52.757

通过删除文件夹 res 并将所有文件放在“src”文件夹下名为“res”的包下解决了该问题。
之后使用代码：

```
InputStream is= this.getClass().getResourceAsStream("/res/hops.txt"); 
```

它奏效了。

# javascript - Asp.net WebMethod - 返回字符串 [] 并使用 JavaScript 解析它

> ID：11478646
> 
> 赞同：1
> 
> 时间：2012-07-13T21:29:38.437
> 
> 标签：javascript, asp.net, ajax

我需要在代码隐藏处从 MyMethod 返回一个字符串数组。但是我是否在 aspx 页面上使用它来解析它`javascript`？

```
[WebMethod]
public static string[] MyMethod(){
   return new[] {"fdsf", "gfdgdfgf"};
}

..........
function myFunction() {
            $.ajax({ ......
                    success: function (msg) {
                                //how do I parse msg?
                                }
            });
        }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:36:10.593

首先，确保您已将您的类标记`[ScriptService]`为允许通过 AJAX 调用它。就像是：

```
[ScriptService] //<-- Important
public class WebService : System.Web.Services.WebService
{
   [ScriptMethod] //<-- WebMethod is fine here too
   public string[] MyMethod()
   {
      return new[] {"fdsf", "gfdgdfgf"};
   }
} 
```

[然后您可以直接使用 jQuery](http://encosia.com/using-jquery-to-consume-aspnet-json-web-services/)读取结果，因为无需*解析*任何内容：

```
$(document).ready(function() {
  $.ajax({
    type: "POST",
    url: "WebService.asmx/MyMethod",
    data: "{}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
      // msg.d will be your array with 2 strings
    }
  });
}); 
```

另一种方法是仅包含对以下内容的引用：

```
<script src="WebService.asmx/js" type="text/javascript"></script> 
```

这将生成代理类以允许您直接调用 Web 方法。例如：

```
WebService.MyMethod(onComplete, onError); 
```

该`onComplete`函数将接收一个带有 Web 服务调用结果的参数，在您的情况下是一个包​​含 2 个字符串的 Javascript 数组。在我看来，这是一个比使用 jQuery 并担心 URL 和 HTTP 有效负载更简单的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:41:40.783

像这样使用 jQuery 迭代器迭代 msg 结果中的字符串。

```
function myFunction() {
    $.ajax({ ......
        success: function (msg) {
            $.each(msg, function(index, value) {
                alert(value);
            });
        }
    });
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:46:10.847

响应`object`将包含一个名为的对象，该对象`d`包装从您的 WebMethod 返回的值。像这样访问它：

```
function myFunction() {
    $.ajax({ ......
        success: function (msg) {
            //how do I parse msg?
            alert(msg.d); //alerts "fdsf", "gfdgdfgf"
        }
    });
}; 
```

请参阅此[问题](https://stackoverflow.com/q/830112/1289454)以获取解释。

# amazon-s3 - 使用 Amazon Webservices 接收、存储、传递和删除“文件”

> ID：11478648
> 
> 赞同：0
> 
> 时间：2012-07-13T21:30:22.213
> 
> 标签：amazon-s3, amazon-ec2, amazon-web-services, amazon-ebs

我在 Amazon EC2 上安装了 Tomcat7 服务器。我的一个 Servlet 收到一个“文件”作为多部分帖子。我需要将此文件存储在目录结构中，稍后该文件将由另一个 servlet 检索并发送到客户端并从 Amazon Web Services 中删除。

**我的问题** 我应该在哪里以及如何存储这些文件以及我应该如何使用 Servlet 创建目录结构。

我在看

1.  以最快的速度访问文件。
2.  只要不发送给客户端，就需要存储文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T13:19:35.267

你真的有两个选择：

1-将内容存储在您的本地实例存储中（对于您的实例存储，我强烈推荐 EBS 而不是实例存储（请参阅[此问题](https://stackoverflow.com/questions/3630506/benefits-of-ebs-vs-instance-store-and-vice-versa)了解背景信息）。存储和检索文件会更快，并且您可以随时重新在需要时扩展您的实例。

2-将您的文件存储在 S3。存储/检索时间会更慢，但您可以获得“自动”可扩展性、加密、增强的耐用性和可用性（无需付出努力）以及通过直接链接公开文件的可能性，而无需通过您的Web应用程序。除此之外，由于文件不在特定的 EC2 实例中，您可以通过添加新实例来扩展您的 Web 应用程序，同时将文件集中在 S3 上。

我的建议是 S3，即使您在交付文件时可能会损失一些速度。设置两个环境并进行一些测试。它可能会帮助您做出决定。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:19:01.787

+1 @Viccari 的回答。它很好地涵盖了选项。

但是，由于您的要求，我不同意使用 S3 的结论，`Quickest possible access to the file`并且`Store of the file is need as long as it is not send to the client.`

S3 明显比基于 EBS 的存储慢。由于您要为单个客户端存储给定文件，直到检索一次，您不需要 S3 提供的可伸缩性。事实上，将存储在 S3 中的数据复制到其他可用区可能需要相当长的时间。

如果您存储的数据将被多次提供服务，那么 S3 将是一个更合理的选择（只要它的性能足以满足您的需要）。对于该用例（*不适*用于您的用例），我还将[Cloud Front](http://aws.amazon.com/cloudfront/)放在 S3 之上。

# image-processing - Photoshop / InDesign CS5 Script：图像大小转换错误是使用了太多内存？

> ID：11478651
> 
> 赞同：1
> 
> 时间：2012-07-13T21:30:46.280
> 
> 标签：image-processing, error-handling, photoshop, adobe-indesign, extendscript

我有一个脚本试图：

> *   扫描 InDesign 文档中的所有图像
> *   `BridgeTalk`  通过对象将所有图像发送到 Photoshop  
> *   将所有图像的大小调整为 600px 宽度（在数学上保持纵横比）
> *   将所有图像从 Photoshop 导出到新文件夹

似乎我可能需要以编程方式调整每张图像的 DPI，因为在调整一张图像大小之前 Photoshop 就崩溃了。该错误表明此脚本使临时内存过载，我认为它与图像质量和/或大小有关...这是错误消息：

> 发生一般 Photoshop 错误。此功能在此版本的 Photoshop 中可能不可用。
> 第 1 行中的错误：
> 由于暂存盘已满，无法完成命令。

* * *

这是转换图像大小的相关代码：

```
function resaveInPS(imagePaths, imagesFolder)
{
    /*
     * NOTE:  no single-line comments are allowed in this function, because it is not read line-by-line by BridgeTalk, but as a single String;
     *        only multi-line comments will work, because they are terminated at each end
     */

    BridgeTalk.bringToFront("photoshop"); /* switch view from InDesign to Photoshop */

    app.displayDialogs = DialogModes.NO; /* Photoshop statement, prevents status alerts from interrupting */

    var imagePath = "";
    var fileName = "";
    var largerImage = "";

    for(var i = 0; i < imagePaths.length; i++)
    {
        imagePath = imagePaths[i].fullName;
        fileName = imagePaths[i].name;
        largerImage = fileName.substr(0, fileName.length - 4); /* getting rid of the file extension:  Photoshop will handle the file extension */

        var photoshopDoc = "";
        photoshopDoc = app.open(new File(imagePath) );

        var currentWidth = photoshopDoc.width; /* in inches */
        var currentHeight = photoshopDoc.height; /* in inches */

        currentWidth.convert("px"); /* now in pixels */
        currentHeight.convert("px"); /* now in pixels */

        var newWidth = 600; /* defining the desired exported image width here */
        var ratio = newWidth / currentWidth;
        var newHeight = ratio * currentHeight; /* maintaining aspect ratio of the resized image's height here */

        alert("The currentHeight is " + currentHeight + ".\n\nThe ratio is " + ratio + ".\n\nThe newHeight is " + newHeight + ".");

        photoshopDoc.resizeImage(newHeight, newWidth); /* (height, width) */
        photoshopDoc.resizeCanvas(newHeight, newWidth); /* (height, width) */

        var saveOptions = new TiffSaveOptions(); /* handling the file extension here */
        photoshopDoc.saveAs(new File(imagesFolder + "/" + largerImage), saveOptions); /* saving the new image in the folder here, with the file extension */
        photoshopDoc.close(SaveOptions.DONOTSAVECHANGES); /* close the Photoshop document without saving */
        app.purge(PurgeTarget.ALLCACHES); /* clears the clipboard, history, and undo cache in Photoshop; Note: does NOT delete the temporary files! */

    } /* end of for loop */

    app.displayDialogs = DialogModes.ALL; /* resume normal dialogs after saving the file and closing the document */
    app.purge(PurgeTarget.ALLCACHES); /* clears the clipboard, history and undo cache in Photoshop; Note:  does NOT delete the temporary files! */

} // end of function ResaveInPS 
```

**注意**  ——我对该语句的使用  `app.purge(PurgeTarget.ALLCACHES)`  似乎没有太大影响，因为错误仍在发生......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:10:30.560

所以，我错误地假设类型强制将适用于单位值，但当然它不会因为“像素”不是默认的 Javascript 类型。

*如果不*应用  `new UnitValue`  to   `var ratio`，则将 ratio 强制转换为类型  `Number`  （尽管  使用“像素”单元类型实例化）`currentWidth`  ***。***此外，  它`var newWidth`  仍然是一种类型  `Number`。

* * *

这是更正后的代码，从该行开始  `var currentWidth`  并以 结尾  `resizeCanvas` ：

```
 var currentWidth = photoshopDoc.width; /* in inches */
        var currentHeight = photoshopDoc.height; /* in inches */

        currentWidth.convert("px"); /* now in pixels */
        currentHeight.convert("px"); /* now in pixels */

        var newWidth = new UnitValue(600, "px"); /* defining the desired exported image width here */
        var ratio = new UnitValue(newWidth / currentWidth, "px");
        var newHeight = new UnitValue(ratio * currentHeight, "px"); /* maintaining aspect ratio of the resized image's height here */

        /*alert("The currentHeight is " + currentHeight + ".\n\nThe ratio is " + ratio + ".\n\nThe newHeight is " + newHeight + ".");*/

        photoshopDoc.resizeImage(newWidth, newHeight); /* (width, height) */
        photoshopDoc.resizeCanvas(newWidth, newHeight); /* (width, height) */ 
```

另外，我得到了方法的参数  `resizeImage`  并  `resizeCanvas`  倒退了！这是两者的正确顺序：   `(width, height)`。

* * *

-- 感谢@Mark 为我指明了正确的方向。

# c# - 在 C# 中，如何通过串行端口通过 Kermit 进行通信？

> ID：11478652
> 
> 赞同：5
> 
> 时间：2012-07-13T21:30:50.230
> 
> 标签：c#, serial-port, serial-communication, kermit

我即将开始一个项目，我必须通过串行端口与医疗设备通信（从中提取数据）。该设备的文档说它通过 Kermit 协议进行通信。自从我想到 Kermit 已经 10 年了。我使用它已有 20 年了。有没有这方面的图书馆？如果我自己滚动，会涉及什么？

我正在使用 .NET 4.0 C# 进行开发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:44:07.733

我发现了一个[类似的问题](https://stackoverflow.com/questions/345027/free-modem-serial-communications-library-or-scriptable-app-with-zmodem-kermit)

~~我没有发现 C# Kermit 绑定的痕迹，而且我相信没有，因为该语言还很年轻~~

一个不错的选择可能是选择您最喜欢的 C++ 实现并~~用~~P/Invoke**包装它**

[更新] 可能有人未刻录 Kermit：[https ://www.adontec.com/super_net_faq.htm](https://www.adontec.com/super_net_faq.htm)

# asp.net-mvc-3 - MVC 3 razor - 使用 2 个日期选择器创建报告以绑定模型中的数据

> ID：11478655
> 
> 赞同：0
> 
> 时间：2012-07-13T21:31:11.040
> 
> 标签：asp.net-mvc-3, jquery-ui, razor, datepicker, postback

我创建了一个工作 MVC 页面，它带回了一组显示特定报告的数据（按支出金额排列的顶级客户）。我正在尝试添加两个 jQuery datepicker 文本框，允许用户通过开始和结束日期绑定该报告。它目前正在工作，因为我有一个绑定了 jQuery click 事件的 HTML 锚标记，它启动了一个处理程序。处理程序将开始/结束日期扔给我的控制器中的 HttpPost ActionResult 方法，并获取更新的数据集。

问题是当我尝试将数据返回到视图（而不是返回 Content("true")）时，没有返回任何数据，并且处理程序给了我我的 OnFailure 消息。是否可以通过这种方式将数据传递给视图，或者我是否需要使用 Html.BeginForm 类型的方法重新编写它？

非常感谢！

这是代码：（在我看来）

```
<script type="text/javascript">
$(document).ready(function () {
    $(".datepicker").datepicker();

    $('#submit').click(function () {
        SetDateHandler($('#startdate').val(), $('#enddate').val(), "company");
    });

    function SetDateHandler(bounddate1, bounddate2, datetype) {
        $.ajax({
            //url: '/Projects/TestArray',
            url: '@Url.RouteUrl("SetBoundingDate")',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            success: OnComplete,
            data: JSON.stringify({ startdate: bounddate1, enddate:bounddate2, type: datetype }),
            traditional: true,
            type: "POST",
            error: OnFail
        });

        return false;
    }
    function OnComplete(result) {
        //indow.location.href = window.location.href;
        alert("yay!");
        return true;
    }
    function OnFail(result) {
        alert('Request Failed');
        return false;
    }

});
</script>

<h2>Top Companies by Total Price for Won Quotes</h2>

<div style="float:right; width: 350px; margin: 15px;">
    <span style="float:right; margin-right: 50px;">Start Date: <input class="datepicker" id="startdate" /></span>
    <br />
    <span style="float:right; margin-right: 50px;">End Date: <input class="datepicker" id="enddate" /></span>
    <br />
    <a href="#" id="submit">Submit</a>
</div> 
```

自定义路由：routes.MapRoute(name: "SetBoundingDate", url: "AjaxSetBoundingDate", 默认值: new { controller = "Reports", action = "SetBoundingDates" } );

在我的报告控制器中：

```
[HttpPost]
public ActionResult SetBoundingDates(String startdate, String enddate, String type)
{
    Schedule.Models.Reports.TopCompaniesModel Companies = new Models.Reports.TopCompaniesModel();

    ActionResult view;

    if (type == "company")
    {
        view = TopCompaniesReport(startdate, enddate);
    }
    else
    {
        view = TopContactsReport(startdate, enddate);
    }
    //return View(view);
    return Content("true");
} 
```

再一次，如果你已经读到这里，我会在正确填充视图的情况下到达我的 Controller 方法的底部，但是当我尝试返回 View 时，它会出错，如果我返回 Content(“true”)，它可以工作但什么也没有页面上的变化。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:35:07.620

再次感谢弗莱姆试图提供帮助。我的方法是错误的，我最终发现我需要切换到剃刀回发方法。实际上，这种方式也容易得多。

这是我的做法：

```
 <div style="float:right; width: 550px; margin: 15px;">
        @using (Html.BeginForm(ViewContext.RouteData.GetRequiredString("action"), "Reports", FormMethod.Post, new { id = "TheForm" }))
        {
             <span style="float:right;">

                    <div style="margin-right: 50px;float:right;">Start Date: <input class="datepicker" name="startdate" id="startdate" /></div>
                    <div style="margin-right: 50px;float:right; margin-top: 5px; clear: both;">End Date: <input class="datepicker" name="enddate" id="enddate" /></div>

                    <input id="submit" name="submit" type="submit" value="Update" style="margin-top: 10px; clear: both;float:right;" />

             </span>
             <span style="float: left;">
                @Html.DropDownList("DateDdl", (SelectList)ViewBag.DateDropDown)
             </span>           

        }
    </div> 
```

实际上我更喜欢这种方式，因为如您所见，我将当前控制器名称传递给它以回发。通过这种方式，我将此功能放入共享的局部视图中，我可以在报告区域内的任何视图上重复使用该视图。

希望这对其他人有帮助！

# html - 如何生成与 Rails 应用程序的 html 文件匹配的资产？

> ID：11478657
> 
> 赞同：2
> 
> 时间：2012-07-13T21:31:31.257
> 
> 标签：html, css, ruby-on-rails, ruby, erb

我通过在控制器中使用 render_to_string 创建了一个 html 文件，并使用 send_data 将 html 文件发送给用户。这很好用，我返回的文件与我在浏览器中右键单击并查看页面源时看到的 html 相匹配。但是，在我的 html 文件中有指向我的 app/assets 文件夹中不存在的 css 文件和 .js 文件的链接。

例如，在 html 文件中有一个指向 application.css 的链接，但在 app/assets 文件夹中只有 application.css.scss。或者另一个例子；lightbox.css.erb 而不是 lightbox.css。

此外，html 中的某些路径是错误的，例如图像位于 app/assets/images 中，但 html 正在查找 app/assets。路径不是问题，因为我可以使用 nokogiri 编辑生成的 html，但我很好奇它们为什么不同。

这几乎正​​是我想要做的[轨道：模拟“将页面另存为”行为](https://stackoverflow.com/questions/1080565/rails-emulate-save-page-as-behaviour)

除了我以不同的方式获取我的 html 并且无论出于何种原因我找不到我正在寻找的资产。正如我之前指出的那样，html 看起来是有效的，打开文件将显示 html 中的文本，但在我更改链接路径之前不会显示任何图像或资产。

根据我的阅读，rails 会将 scss 转换为 css 并将 erb 文件呈现为 js 或 html。不过，我在我的目录中的任何地方都找不到这些文件。如何生成我需要的文件，以便独立于 rails 应用程序显示我的静态 html 文件？

我正在使用带有 jruby 1.6.7（ruby 1.9.2）的 Rails 3.2.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:34:15.930

在将 rails 应用程序部署到生产模式之前，您的所有资产（css、javascript 和图像）通常都经过预编译并放置在公共目录中，这是您的 rails 渲染的 html 页面查找资产的地方。

在开发模式下，通常不会进行这种预编译，但如果需要，可以进行。要生成编译的资产，您可以运行`rake assets:precompile`. 这将编译您的资产，“指纹”它们并将它们放置在公共文件夹中。“指纹”意味着它将根据资产的文件内容生成哈希并将哈希放在资产的文件名中，这有助于仅通过读取文件名来确定资产的内容是否/何时发生更改。

运行此命令后，您可以将资产复制或移动到新目录（在您的 rails 应用程序之外），您可以在其中独立于 rails 应用程序提供 html 页面和这些资产。您还可以从公共目录中删除已编译的资产，因为这些资产在开发模式中通常不是很有用。

对于一些背景，我会阅读有关[Asset Pipeline](http://guides.rubyonrails.org/asset_pipeline.html#what-is-the-asset-pipeline)的信息。

# r - 是否有与 SAS PWENCODE 类似的 R 功能？

> ID：11478660
> 
> 赞同：3
> 
> 时间：2012-07-13T21:31:36.147
> 
> 标签：r, password-encryption

我正在尝试将当前在 R 代码中硬编码的密码移动到磁盘上的“加密”/编码文件中。

我想以与 SAS PWENCODE 过程类似的方式进行操作（http://support.sas.com/documentation/cdl/en/proc/63079/HTML/default/viewer.htm#n0ii0upf9h4a67n1bcwcesmo4zms.htm，ODBC[密码](http://support.sas.com/documentation/cdl/en/proc/63079/HTML/default/viewer.htm#n0ii0upf9h4a67n1bcwcesmo4zms.htm)[安全在 SAS 中](https://stackoverflow.com/questions/8157160/odbc-password-security-in-sas)）。

R中有类似的东西吗？对于需要定期运行的代码，您使用什么方法在 R 中存储密码，而无需以键入密码的形式进行人工干预？

编辑：忘了提：唯一和我相似的是 RCurl::base64() 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-24T13:33:48.573

我在下面的博客文章中概述了我在 Windows 上实现此目的的方法：

[http://www.gilfillan.space/2016/04/21/Using-PowerShell-and-DPAPI-to-securely-mask-passwords-in-R-scripts/](http://www.gilfillan.space/2016/04/21/Using-PowerShell-and-DPAPI-to-securely-mask-passwords-in-R-scripts/)

本质上...

1.  确保您已[启用 PowerShell 执行](https://stackoverflow.com/a/4038991/3827849 "堆栈溢出")。

2.  将以下文本保存到名为 EncryptPassword.ps1 的文件中：

    ```
    # Create directory user profile if it doesn't already exist.
    $passwordDir = "$($env:USERPROFILE)\DPAPI\passwords\$($env:computername)"
    New-Item -ItemType Directory -Force -Path $passwordDir

    # Prompt for password to encrypt
    $account = Read-Host "Please enter a label for the text to encrypt.  This will be how you refer to the password in R.  eg. MYDB_MYUSER
    $SecurePassword = Read-Host -AsSecureString  "Enter password" | convertfrom-securestring | out-file "$($passwordDir)\$($account).txt"

    # Check output and press any key to exit
    Write-Host "Press any key to continue..."
    $x = $host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown") 
    ```

3.  执行上面的脚本（右键单击 > 使用 PowerShell 运行），为密码提供一个有意义的名称，然后输入密码。您现在可以通过检查 %USERPROFILE%/DPAPI/passwords/[PC NAME]/[PASSWORD IDENTIFIER.txt] 中的文件来验证密码是否已加密

4.  [现在从 R 中运行以下代码](https://stat.ethz.ch/R-manual/R-devel/library/base/html/source.html)（我将此函数保存在一个 R 脚本中，该脚本在每个脚本的开头提供。

    ```
    getEncryptedPassword <- function(credential_label, credential_path) {
      # if path not supplied, use %USER_PROFILE%\DPAPI\passwords\computername\credential_label.txt as default
      if (missing(credential_path)) {
        credential_path <- paste(Sys.getenv("USERPROFILE"), '\\DPAPI\\passwords\\', Sys.info()["nodename"], '\\', credential_label, '.txt', sep="")
      }
      # construct command
      command <- paste('powershell -command "$PlainPassword = Get-Content ', credential_path, '; $SecurePassword = ConvertTo-SecureString $PlainPassword; $BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($SecurePassword); $UnsecurePassword = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR); echo $UnsecurePassword"', sep='')
      # execute powershell and return command
      return(system(command, intern=TRUE))
    } 
    ```

5.  现在，当您需要在 R 中提供密码时，您可以运行以下命令，而不是硬编码/提示输入密码：

    ```
    getEncryptedPassword("[PASSWORD IDENTIFIER]") 
    ```

    例如，不要运行 ROracle 命令：

    ```
    dbConnect(driver, "MYUSER", "MY PASSWORD", dbname="MYDB") 
    ```

    您可以改为运行它（我在第 3 步中提供的标识符是“MYUSER_MYDB”：

    ```
    dbConnect(driver, "MYUSER", getEncryptedPassword("MYUSER_MYDB"), dbname="MYDB") 
    ```

6.  您可以根据需要重复步骤 3 的密码，并在步骤 5 中使用正确的标识符简单地调用它们。

# http - 使用 WebRequestHandler 的 ServerCertificateValidationCallback 时出现 MissingMethodException？

> ID：11478665
> 
> 赞同：1
> 
> 时间：2012-07-13T21:31:57.083
> 
> 标签：http, asp.net-web-api

我正在尝试使用新的 System.Net.Http 位来构建一个简单的 HTTP 客户端来与基于 HTTP 的 API 对话。我用 Nuget (Microsoft.AspNet.WebApi.Client.4.0.20505.0) 安装了这些位。

我需要接受一些自签名证书，所以我试图设置 WebRequestHandler 类的 ServerCertificateValidationCallback 属性。这是说明我遇到的问题的两行测试：

```
 [Test]
    public void CanRunDummyTest() {
        var handler = new WebRequestHandler();
        handler.ServerCertificateValidationCallback = (sender, certificate, chain, errors) => true;
    } 
```

但它抛出：

```
CanRunDummyTest : FailedSystem.MissingMethodException : 
Method not found: 'Void System.Net.Http.WebRequestHandler.set_ServerCertificateValidationCallback(System.Net.Security.RemoteCertificateValidationCallback)'
at AxlTests.RawAxlTests.CanRunDummyTest() 
```

好像没有实现类的Set属性？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:41:20.943

`MissingMethodException`'通常发生在针对经历了*破坏性 ABI 更改*（向前或向后）的同一类型编译和执行时..

..我希望这就是这里发生的事情。

根据[WebRequestHandler.ServerCertificateValidationCallback 属性](http://msdn.microsoft.com/en-us/library/system.net.http.webrequesthandler.servercertificatevalidationcallback%28v=vs.110%29.aspx)，该属性*仅*“在 .NET 4.5 中受支持”，因此使用 .NET 4.0 版本将**大放异彩！**

构建时，请确保 .NET 4.0（或适用）是（希望）获得编译时错误的目标。

# mysql - PHP/MySQL - 转义字符串的最佳使用和实践

> ID：11478669
> 
> 赞同：8
> 
> 时间：2012-07-13T21:32:05.273
> 
> 标签：mysql, string, escaping

> **可能重复：**
> [在 PHP 中防止 SQL 注入的最佳方法](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)

进行查询时转义字符串的最佳方法是什么？mysql_real_escape_string() 看起来不错，但我不完全知道如何正确使用它。

这段代码能正确完成这项工作吗？

```
<?php
   /* Let's say that the user types "'#""#''"\{(})#&/\€ in a textfield */
   $newStr = mysql_real_escape_string($str);
   $query = "INSERT INTO table username VALUES ($str)";
   mysql_query($query);
?> 
```

编辑：

现在我有这个代码：

```
 $email = $_POST['email'];
    $displayName = $_POST['displayName'];
    $pass = $_POST['pass1'];

    $email = mysqli_real_escape_string($link, $email);
    $displayName = mysqli_real_escape_string($link, $displayName);
    $pass = mysqli_real_escape_string($link, $pass);

    $insert = "INSERT INTO profiles (email, displayName, password)
    VALUES ('$email', '$displayName', md5('$pass'))";
    mysqli_query($link, $insert)
    or die(mysqli_error($link)); 
```

但我收到此错误：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ' *!"#!#^!"#!"* #!"#^''''''附近使用正确的语法

如果用户输入：'**!"#!#^!"#!"*#!"#^''''

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T21:35:25.540

最好的方法是根本不转义字符串，而是使用参数化查询，它会在幕后为您完成。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-13T21:35:28.050

像这样使用`mysql_real_escape_string`会起作用，但你需要：

*   在值周围添加引号。
*   使用结果`$newStr`，而不是原始值`$str`。
*   将表名更改为不是保留关键字的名称。
*   在列列表周围添加括号。

试试这个：

```
$query = "INSERT INTO yourtable (username) VALUES ('$newStr')"; 
```

我还建议您检查结果，`mysql_query($query)`如果有错误，您可以检查错误消息：

```
if (!mysql_query($query))
{
    trigger_error(mysql_error());
} 
```

您还应该考虑使用 MySQL 的较新接口之一。旧`mysql_*`功能已[弃用](http://news.php.net/php.internals/53799)，不应在新代码中使用。

# ruby - 检查字符串是否包含“http://”和“.jpg”

> ID：11478672
> 
> 赞同：3
> 
> 时间：2012-07-13T21:32:15.847
> 
> 标签：ruby, ruby-on-rails-3

我是 Ruby 和 Rails 的新手，如果这是一个简单的问题，请原谅我。我试图检查用户何时在我的表单中传入 IMG url，它是一个有效的 url。这是我的代码：

```
if params[:url].include? 'http://' && (params[:url].include? '.jpg' || params[:url].include? '.png') 
```

这返回和错误。这甚至是最好的方法吗？我应该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-13T21:42:37.130

```
if my_str =~ %r{\Ahttps?://.+\.(?:jpe?g|png)\z}i 
```

正则表达式解释：

*   `%r{...}`— 类似于 的正则表达式文字`/.../`，但允许`/`在内部使用而无需转义
*   `\A`— 字符串的开头（`^`只是行的开头）
*   `http` — 文字文本
*   `s?` — 可选地后跟一个“s”（允许 https://）
*   `://`- 文字文本（以防止类似的东西`http-whee.jpg`）
*   `.+` — 一个或多个字符（不是换行符）
*   `\.` - 一个字面句号（确保这是我们正在查看的扩展名）
*   `(?:aaa|bbb)`— 允许`aaa`或`bbb`在此处，但不捕获结果
*   `jpe?g`— “jpg”或“jpeg”
*   `png`— 文字文本
*   `\z`— 字符串的结尾（`$`只是行尾）
*   `i`— 使匹配不区分大小写（允许`.JPG`和`.jpg`）

但是，您也许可以摆脱这个（更具可读性）的版本：

```
allowed_extensions = %w[.jpg .jpeg .png]
if my_str.start_with?('http://') &&
   allowed_extensions.any?{ |ext| my_str.end_with?(ext) } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T08:36:47.043

@Phrogz 的答案更好，我只是用一些 ruby​​ 库尝试过这个。

```
require 'uri'

extensions = %w( .jpg .jpeg .png )
schemes = %w( http https )
string = params[:url]

if (schemes.include?URI.parse(string).scheme) && (extensions.include?File.extname(string))

end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-11T17:40:56.497

虽然正则表达式会缩短代码，但我宁愿不要在一个模式中进行这样的检查。这是一个自我记录/维护的事情。单个正则表达式更快，但如果所需的协议或图像类型增加，该模式将变得越来越笨拙。

这是我要做的：

```
str[%r{^http://}i] && str[/\.(?:jpe?g|png)$/] 
```

# bash - 如何显示 zsh 函数定义（如 bash “type myfunc”）？

> ID：11478673
> 
> 赞同：83
> 
> 时间：2012-07-13T21:32:24.010
> 
> 标签：bash, function, zsh, definition

如何在 zsh 中显示函数的定义？`type foo`没有给出定义。

在 bash 中：

```
bash$ function foo() { echo hello; }

bash$ foo
hello

bash$ type foo
foo is a function
foo () 
{ 
    echo hello
} 
```

在 zsh 中：

```
zsh$ function foo() { echo hello; }

zsh$ foo
hello

zsh$ type foo
foo is a shell function 
```

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-07-13T21:36:36.720

zsh 习惯用法是`whence`，`-f`标志打印函数定义：

```
zsh$ whence -f foo
foo () {
    echo hello
}
zsh$ 
```

在 zsh 中，`type`定义为等价于`whence -v`，因此您可以继续使用`type`，但您需要使用`-f`参数：

```
zsh$ type -f foo
foo () {
    echo hello
}
zsh$ 
```

最后，在 zsh`which`中定义为等效于- 以*类似 csh 的*格式`whence -c`打印结果，因此将产生相同的结果。*`which foo`*

 *`man zshbuiltins`对于这一切。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-07-13T21:38:55.673

我一直只是用`which`这个。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-11-13T14:49:06.820

**tl;博士**

```
declare -f foo  # works in zsh and bash

typeset -f foo  # works in zsh, bash, and ksh 
```

如果您不介意或不喜欢在输出中包含给定名称存在的*所有命令形式：*^(谢谢，[Raine Revere](https://stackoverflow.com/users/480608/raine-revere)。)

```
type -af  # zsh only (works differently in bash and ksh) 
```

* * *

`type -f`//在这种情况下是次优的`whence -f`，`which`因为它们的目的是报告恰好由该名称定义的具有最高优先级的命令形式-*而**不是*专门将操作数作为*函数*报告。

 **也就是说，实际上这意味着只有同名的*别名*优先（技术上也是一个*shell 关键字*，尽管为 shell 关键字命名函数可能是个坏主意）。

请注意，`zsh`默认情况下会在脚本中扩展别名（如`ksh`，但不是`bash`），即使您先关闭别名扩展，//`type -f`仍会*首先*报告别名。`whence -f``which`

 *在`zsh`中，该`-f`选项仅在 中的查找中*包含*shell 函数`zsh`，因此 - 除非`-a`也用于列出*所有*命令形式 - 给定名称的别名将作为唯一输出打印。

在`bash`and`ksh`中，`type -f`实际上从查找中*排除了函数；*`whence`中不存在`bash`，并且`ksh`其中不打印函数*定义*；`which`不是内置的`ksh`and `bash`，根据定义，外部实用程序不能打印 shell 函数。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-05-21T15:12:54.483

如果你不太确定你在找什么，你可以只输入

```
functions 
```

它将向您显示所有已定义的功能。

请注意，有时它们很多，因此您可能希望通过管道传输到寻呼机程序：

```
functions | less 
```

要取消定义函数，请使用

```
unfunction functionname 
```****

# c# - C# Com E_NOINTERFACE 查询接口

> ID：11478677
> 
> 赞同：1
> 
> 时间：2012-07-13T21:32:38.970
> 
> 标签：c#, com

我很抱歉，但我不得不再问一次。我从数周和数月以来一直在寻找解决方案。问题是仅通过调用几个方法 InvalidCast Exception E_NOINTERFACE 实现了一个 COM 接口，它告诉我必须实现 IUnknown。那么我该怎么做呢？

我几乎尝试了一切......目前我有这样的东西

```
[ComImport,
 Guid("279AFA85-4981-11CE-A521-0020AF0BE560"),
 InterfaceType(ComInterfaceType.InterfaceIsIUnknown),
 System.Security.SuppressUnmanagedCodeSecurity]

public interface IDirectSoundBuffer : IUnknown
{ 
```

...

```
[ComImport]
[Guid("00000000-0000-0000-C000-000000000046")]
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IUnknown
{
    void QueryInterface([In] ref Guid giid, [Out, MarshalAs(UnmanagedType.IUnknown, IidParameterIndex = 0)] out object ppvObject);
    [PreserveSig]
    uint AddRef();
    [PreserveSig]
    uint Release();
} 
```

我真的不知道我还能尝试更多。我在许多不同的论坛上都有一个讨论这个话题的话题，但 noboboy 什么都知道 :(( 请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:35:24.477

这只是一个猜测（因为它已经有一段时间了）：

不要`IUnkown`在 C# 互操作代码中声明和继承您的接口。[Com Callable Wrapper](http://msdn.microsoft.com/en-us/library/f07c8z1c.aspx)将为您实现它。

# facebook - dropbox.com 是否有来自 facebook 的特殊权限来完成共享功能？

> ID：11478680
> 
> 赞同：2
> 
> 时间：2012-07-13T21:32:40.697
> 
> 标签：facebook, api, dropbox, sharing

我正在尝试完成一项与 dropbox.com 完全相同的共享功能

我已经尝试了很多方法来让应用程序以相同的方式工作，但我还没有通过 FB api 找到解决方案。

我的问题需要一个简单的是或否的答案，但请随时详细说明。

dropbox.com 是否有一些来自 Facebook 的特殊权限，可以让他们实现与 Facebook 好友分享的功能？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T03:21:10.707

不幸的是，“发送消息”功能仅供特定合作伙伴使用。

发现[这篇文章](https://developers.facebook.com/blog/post/291/)从前一段时间仍然适用……“虽然我们目前不允许应用程序通过此 API 发送消息，但我们一直在考虑通过 Facebook 平台提供的新功能。”

几个选项...

*   这是一个不同的 UX，不能在移动设备上使用，但如果你在桌面上，你可以使用[Send Dialog](https://developers.facebook.com/docs/reference/dialogs/send/)。

*   否则，我能想到的最接近的就是 Facebook 聊天 API，但这可能取决于你想要做什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-26T12:38:04.130

没有什么像“发送消息”这样的能力只为特定的合作伙伴保留。

在 Dropbox 中，他们使用他们的 Facebook 电子邮件地址（例如，用户名@facebook.com）向特定用户发送电子邮件

您可以在您的 facebook 常规帐户设置中看到此电子邮件地址。你可以在它下面看到这个注释，上面写着：

“您的 Facebook 电子邮件基于您的公开用户名。发送到该地址的电子邮件会转到 Facebook 消息。”

您只需要检索用户的电子邮件 ID 和他们朋友的用户名....

并且您也可以发送附件......！

# css - 使用 CSS 在 IE9 中垂直居中元素

> ID：11478682
> 
> 赞同：3
> 
> 时间：2012-07-13T21:32:47.927
> 
> 标签：css, internet-explorer-9, margin, vertical-alignment

我试图使用以下代码通过 CSS 将 a 居中，但它仅适用于 Chrome，不适用于 IE9 和 Firefox 13.0.1 `<div>`。`<div>`以下是我的 HTML 文件：

```
<!DOCTYPE HTML>
<html>
<head>
    <link type="text/css" rel="stylesheet" href="test.css">
    <title>test</title>
</head>
<body>
    <div class="container">
        <div class="center">abc</div>
    </div>
</body>
</html> 
```

以下是我的 CSS 文件：

```
.container{
    position: relative;
    border: 1px solid black;
    width: 600px;
    height: 400px;
    position: relative;
}

.center {
    border: 1px solid blue;
    width: 300px;
    height: 200px;
    position: absolute;
    margin-left: 50%;
    margin-top: 50%;
    top: -100px;
    left: -150px;
} 
```

我发现了另一个更简单的问题。如果我把`top: -100px`上面的CSS文件中的代码去掉，inner div的下边框应该正好覆盖了outer div的下边框，因为inner div的高度是200px，outer div的高度是400px，然后把inner div设置为`margin-top: 50%`. 两个 div 的底部边框应该在一起，但它们不是。

我还发现这`margin-top:50%`取决于外部 div 的宽度。如果宽度较长，则`margin-top: 50%`会使内部 div 进一步下降。太奇怪了。有谁知道原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:38:27.130

当使用百分比作为边距时，百分比总是相对于包含元素（[source](https://developer.mozilla.org/en/CSS/margin)）的宽度。

交换你的`margin-top`for`top`和`margin-left`for `left`，它应该可以正常工作：

```
.container{
    position: relative;
    border: 1px solid black;
    width: 600px;
    height: 400px;
}

.center {
    border: 1px solid blue;
    width: 300px;
    height: 200px;
    position: absolute;
    left: 50%;
    top: 50%;
    margin-top: -100px;
    margin-left: -150px;
} 
```

[http://jsfiddle.net/rcnWy/1/](http://jsfiddle.net/rcnWy/1/)

# jquery - MVC FormCollection 性能速度

> ID：11478685
> 
> 赞同：0
> 
> 时间：2012-07-13T21:33:09.670
> 
> 标签：jquery, asp.net-mvc-3

我正在处理具有动态生成标记的页面。因此，我不知道表单上有哪些可用字段。因此，POST 方法不是创建视图模型，而是使用 FormCollection。一旦收到 POST，程序就会快速运行。

我的问题：单击表单上的 SUBMIT 大约需要 10 - 15 秒才能在控制器中 POST 操作的第一行遇到断点。在我的场景中，表单上有 800 个输入字段。只为 800 个字段创建 FormCollection 真的需要这么长时间吗？有什么方法可以简化流程或缩短响应时间？

编辑：

IE 分析器表明大部分时间都花在了 JQuery CSS 选择器上。如果我删除所有 CSS，页面会很快运行。为什么 CSS 选择器在回发到服务器之前运行？我可以禁用它吗？

编辑 2：分析器现在显示在 JQuery 1.6.4.min.js 中花费的时间，函数是“k”。我认为这只是一个内部变量查找。我还发现从输入字段中删除“大小”和“最大长度”属性会使页面快速响应（万岁）......除了......我需要那些用于客户端验证。我仍在尝试寻找一种方法来提高速度，或者删除属性并保留一些方法来限制客户端字段的输入长度。

编辑 3：我研究了 jquery-1.6.4.min.js 并找到了函数 k。根据编辑 2，添加/删除 'maxlength' 和 'size' 属性会产生重大影响（33K ms 而不是 3k ms）。但是，函数 K 不应该做太多......因为那些不是 nodetype===1 并且第一个 IF 应该失败，在下一行返回函数。

```
function k(a,c,d)
    {
        if(d===b&&a.nodeType===1)
        {
            var e="data-"+c.replace(j,"-$1").toLowerCase();
            d=a.getAttribute(e);
            if(typeof d=="string")
            {
                try
                {
                    d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNaN(d)?i.test(d)?f.parseJSON(d):d:parseFloat(d)
                }
                catch(g){}
                f.data(a,c,d)
            }
            else 
                d=b
        }
        return d
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T16:45:10.137

我刚刚创建了一个包含 1000 个字段的表单，控制器可以在我提交后不到一秒的时间内访问每个字段。

这就是我创建字段的方式：

```
<script language="javascript" type="text/javascript">
$(document).ready(function () {
    for (var i = 0; i < 1000; i++) {
    $('<input/>').attr({ type: 'text', id: 'test'+i, name: 'test'+i,value:'test '+i }).appendTo('#fields');
    }
    });
</script> 
```

这是行动：

```
 public ActionResult TestFields()
    {
        for (int i = 0; i < 1000; i++)
        {
            if (Request.Form[i] != string.Format("test{0}", i))
            {
                throw new Exception("bad value received");
            }
        }
            return View();
    } 
```

用表单值填充 FormCollection 似乎不是问题。我在本地网络上有短值和测试。如果您的值较长且网络速度较慢，则可能是问题所在。如果每个值都是 1KB，则需要发送 800KB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:56:43.523

从 Mystere Man 的评论中，结果证明客户端正在验证，这个链接解决了这个问题： [http ://forums.asp.net/t/1523883.aspx/1/10?Disabling+client+side+validation+在+提交+按钮+](http://forums.asp.net/t/1523883.aspx/1/10?Disabling+client+side+validation+on+submit+button+)

基本上，我禁用了提交按钮上的验证。这允许 'maxlength' 和 'size' 属性在用户键入时起作用，但会阻止 POST 上的任何客户端验证。这种行为似乎很好，因为服务器将在处理输入时再次验证。POST 的平均时间从 33 秒变为 2 秒。

也在这里： [禁用 MVC 3“取消”提交按钮中的客户端验证](https://stackoverflow.com/questions/5363624/disable-client-side-validation-in-mvc-3-cancel-submit-button)

# python - 在 python 中通过 USB 流式传输数据/使用 python 模拟 USB 驱动器？

> ID：11478690
> 
> 赞同：0
> 
> 时间：2012-07-13T21:33:52.403
> 
> 标签：python, streaming, usb, emulation

我想知道以下是否可行：我想通过双面 USB 电缆将我的计算机连接到另一台计算机或一些消费电子产品（如 ps3 或 xbox 之类的）。我想在第一台计算机上运行一个程序，该程序将通过 USB 电缆运行恒定的数据流，以欺骗第二台计算机相信它是一个 USB 闪存驱动器，并且它可以从中读取数据。第一台计算机可以将数据流相应地更改为应该在模拟闪存驱动器上的文件。

本质上，我想在计算机上使用一个程序来模仿另一个设备中的 USB 硬件。

我不知道我的措辞是否正确，但这可能吗？

图表：

| 我的电脑运行这个程序 | >-----模拟USB数据流-----> | 目标 |

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:42:26.577

这在没有特殊硬件的情况下是不可能的，因为 USB 不支持对等网络。使用 Firewire (IEEE-1394) 可能会做得更好，它至少可以通过适当的驱动程序用于 TCP/IP。

# javascript - 从对象方法内的数组运行console.log

> ID：11478693
> 
> 赞同：0
> 
> 时间：2012-07-13T21:34:00.797
> 
> 标签：javascript, arrays, function, methods

我今天刚刚在学校学习对象，我知道可以从对象内部运行一个函数，但该函数实际上称为方法，我的方法有一个数组，我喜欢在控制台中获取特定的目标。通过更改全局变量来记录。这可以做到吗？我得到的只是在最后一个 console.log -> ing at " + worker.getLocation.myLocation); 处未定义，所以实际上我正在尝试更改全局变量 var myLocation = 0 以输出不同的 myLocation 内部获取位置方法。

```
var myLocation = 0

var worker = {
    realName:       "Willson",
    title:          "Assistant Maintenance Supervisor",
    maintenance:    true,
    vehicals:       ["2008 Dodge Caliber SRT-4", "2012 Jeep Wrangler Unlimited"      ],
    getLocation:    function () { 
        myLocation [0] = "Villas at Sunrise Mountain";
        myLocation [1] = "Reno Villas"; 
        myLocation [2] = "lost"; 
        myLocation [3] = "back home";
    }
};

console.log(worker.realName + " is a " + worker.title + " and drives a " + worker.vehicals[1] + " to work."); 

var destination = {
    property: ["Villas at Sunrise Mountain", "Reno Villas", "lost", "back home"]
};

console.log ("He sold his " + worker.vehicals[0] + "." + " Today he is working at " + worker.getLocation.myLocation); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:37:13.147

```
var myLocation = 0

var worker = {
    realName:       "Willson",
    title:          "Assistant Maintenance Supervisor",
    maintenance:    true,
    vehicals:       ["2008 Dodge Caliber SRT-4", "2012 Jeep Wrangler Unlimited"      ],
    getLocation:    function () { 
        var myLocationss = [];
        myLocationss [0] = "Villas at Sunrise Mountain";
        myLocationss [1] = "Reno Villas"; 
        myLocationss [2] = "lost"; 
        myLocationss [3] = "back home";

        return myLocations[myLocation];

    }
};

console.log(worker.realName + " is a " + worker.title + " and drives a " + worker.vehicals[1] + " to work."); 

var destination = {
    property: ["Villas at Sunrise Mountain", "Reno Villas", "lost", "back home"]
};

console.log ("He sold his " + worker.vehicals[0] + "." + " Today he is working at " + worker.getLocation()); 
```

# log4j - 没有前导零的 Log4Net 日期和时间（转换模式）

> ID：11478706
> 
> 赞同：2
> 
> 时间：2012-07-13T21:34:57.330
> 
> 标签：log4j, log4net

有谁知道如何指定日期格式，以便日志中不会出现前导零？我知道这听起来很挑剔，但另一个过程正在阅读我的日志，似乎不喜欢前导零。

我在用：

```
<appender name="UdpAppender" type="log4net.Appender.UdpAppender">
    <filter type="log4net.Filter.LoggerMatchFilter">
        <loggerToMatch value="NamespaceName.ClassName" />
    </filter>     
    <filter type="log4net.Filter.DenyAllFilter" />   
    <param name="RemoteAddress" value="192.168.1.123" />
    <param name="RemotePort" value="514" />
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date{MM/dd/yyyy hh:mm:ss tt} %message %newline" />
    </layout>
</appender> 
```

我明白了：

2012 年 7 月 10 日上午 9:20:39 ...

如果可能的话，我想得到：

2012 年 7 月 10 日上午 9:20:39

我尝试简单地使用： %date{M/dd/yyyy h:mm:ss tt} 但它没有用（当需要两个字符时也似乎很奇怪）

2012 年 7 月 15 日编辑：

我还没有回到办公室，所以我还没有检查 UDP 错误，但如果其他人想要扩展一个 appender 只是为了添加一个属性来传递到你的应用程序中：

```
public class SyslogAppender : UdpAppender
{
    public string UpdateIp { get; set; }

    // ReSharper disable RedundantOverridenMember
    override protected void Append(LoggingEvent loggingEvent)
    {
        base.Append(loggingEvent);

    }
    // ReSharper restore RedundantOverridenMember

}

<appender name="UdpAppender" type="Namespace.Log4Net.SyslogAppender">
    <filter type="log4net.Filter.LoggerMatchFilter">
        <loggerToMatch value="Namespace.LogGenFileReparser" />
    </filter>  
    <filter type="log4net.Filter.LoggerMatchFilter">
        <loggerToMatch value="Namespace.Log4Net.SyslogAppender" />
    </filter>       
    <filter type="log4net.Filter.DenyAllFilter" />   
    <param name="RemoteAddress" value="192.168.73.133" />
    <param name="RemotePort" value="514" />
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date{M/dd/yyyy h:mm:ss tt} %message %newline" />
    </layout>
    <param name="UpdateIp" value="false" />
</appender> 
```

我在调用配置之前检查了新参数：

```
 var log4FileConfigFile = XDocument.Parse(File.ReadAllText("log4net.config"));
        var firstOrDefault = log4FileConfigFile.Descendants("log4net").Descendants("appender").
            Select(appender => appender.Attributes().
                FirstOrDefault(attrib => attrib.Name == "name" && attrib.Value == "UdpAppender")).
                    FirstOrDefault(check => null != check);

        if (firstOrDefault != null)
            if (firstOrDefault.Document != null)
            {
                var xAttribute2 = firstOrDefault.Document.Descendants("param").
                    Attributes().FirstOrDefault(attrib => attrib.Value == "UpdateIp");

                if (xAttribute2 != null && xAttribute2.Value.ToLower().Equals("true"))
                {
                    var xAttribute = firstOrDefault.Document.Descendants("param").
                        Attributes().FirstOrDefault(attrib => attrib.Value == "RemoteAddress");
                    if (xAttribute != null)
                        xAttribute.NextAttribute.SetValue(
                            IPAddresses.GetLocalIp().ToString());
                }
            }

    XmlConfigurator.Configure(... 
```

编辑 2012 年 7 月 17 日

我没有其他 log4net 错误（使用 UDP appender）。问题出在接收器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T12:42:40.657

对我有用，但我正在登录文件。

您确定无论您使用的是什么视图，日志都不会重新格式化输出吗？

# file - 如何在 Unix 中查找和替换文件中的行？

> ID：11478711
> 
> 赞同：0
> 
> 时间：2012-07-13T21:35:45.847
> 
> 标签：file, unix, replace

例如，我的文件中有这一行（注意 = 之后的数字每次都不同）：

```
abcd=1234 
```

我需要将其更改为：

```
abcd=9999 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:39:32.660

尝试`sed -i.backup -e 's/abcd=.*/abcd=9999/' filename.txt`

示例在`filename.txt`

```
abcd=123
abcd=15652 
```

按预期输出：

```
abcd=9999
abcd=9999 
```

注意：有人告诉我这是 GNU sed，它显然有一些扩展，使其与普通的 sed 不同。我不知道这一点，也无法验证这一点。如果有人有非 gnu 解决方案，请随时对其进行编辑。

# linux - 确定 bash 函数的定义位置

> ID：11478712
> 
> 赞同：1
> 
> 时间：2012-07-13T21:35:48.403
> 
> 标签：linux, bash, shell, scripting, sh

我在专有服务器上；我对此一无所知。我们经常使用一个 bash 函数来描述服务器，但如果我编写一个使用该函数的 bash 脚本，它将无法工作。

所以我想在脚本中加载原始源文件。除了“蛮力”搜索方法之外，还有其他方法可以确定源文件的位置吗？如果我这样做，`type -a thefunction`我可以看到定义，但看不到它的来源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:57:46.043

这些信息不容易获得。启动一个启用调试（set -x）的交互式登录 shell 可能会有所帮助。这将向您详细展示源流程。

```
bash -ilx 
```

当我像这样启动 bash shell 时，我看到如下内容：

```
+++ . /etc/bash_completion.d/dd
++++ have dd
++++ unset -v have
++++ PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/sbin:/usr/sbin:/usr/local/sbin 
```

这向我展示了当 . /etc/bash_completion/dd 已获取，PATH 已修改（或可能重新设置为相同的值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:59:04.847

查看[http://wiki.bash-hackers.org/scripting/debuggingtips/的“让 xtrace 更有用”部分](http://wiki.bash-hackers.org/scripting/debuggingtips/)

我尝试在我的脚本顶部附近添加以下内容，看起来它为函数调用提供了文件名/行号。

```
set -x
export PS4='+(${BASH_SOURCE}:${LINENO}): ${FUNCNAME[0]:+${FUNCNAME[0]}(): }' 
```

我在带有 bash 4.1.2 的 CentOS 6.2 主机上进行了测试

# python - 将 OFTInteger 转换为 Decimal 时出现 Django 错误

> ID：11478714
> 
> 赞同：1
> 
> 时间：2012-07-13T21:36:07.693
> 
> 标签：python, django, python-2.7, postgresql-9.1, geos

我正在使用以下数据库构建一个包含地理数据的数据库：PostgreSQL 9.1、Django 1.3.1、psycopg2 2.4.5 并使用库 GEOS 3.3.0、PostGIS 1.5.4 和 ProJ 4.7.0。

我有一个命令将形状文件加载到数据库中，并进行了一些优化以使形状更简单。

为了保持模型简单，我将只放置有问题的字段：

```
class Circonscription(models.Model):
    shape = models.GeometryField()
    simple_shape = models.GeometryField()
    centroid = models.PointField(null=True) 
```

当我想从形状文件创建一个时，我这样做：

```
Circonscription.objects.create(
            id_cep=feature['id_cep'],
            co_cep=feature['co_cep'],
            nm_cep=feature['nm_cep'],
            nmtri_cep=feature['nmtri_cep'],
            dh_maj=feature['dh_maj'],
            shape=geometry.wkt,
            simple_shape=simple_geometry.wkt,
            centroid=geometry.geos.centroid) 
```

现在当我运行我的命令时，它失败并出现以下错误：

```
File "/home/pg/Projets/python/myproject/circonscriptions/management/commands/loadshapefiles.py", line 174, in add_boundaries_for_layer
centroid=geometry.geos.centroid)
File "/home/pg/.virtualenvs/myproject/local/lib/python2.7/site-packages/django/db/models/manager.py", line 138, in create
    return self.get_query_set().create(**kwargs)
  File "/home/pg/.virtualenvs/myproject/local/lib/python2.7/site-packages/django/db/models/query.py", line 360, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/pg/.virtualenvs/myproject/local/lib/python2.7/site-packages/django/db/models/base.py", line 460, in save
    self.save_base(using=using, force_insert=force_insert, force_update=force_update)
  File "/home/pg/.virtualenvs/myproject/local/lib/python2.7/site-packages/django/db/models/base.py", line 543, in save_base
    for f in meta.local_fields if not isinstance(f, AutoField)]
  File "/home/pg/.virtualenvs/myproject/local/lib/python2.7/site-packages/django/db/models/fields/subclassing.py", line 28, in inner
    return func(*args, **kwargs)
  File "/home/pg/.virtualenvs/myproject/local/lib/python2.7/site-packages/django/db/models/fields/__init__.py", line 786, in get_db_prep_save
    return connection.ops.value_to_db_decimal(self.to_python(value),
  File "/home/pg/.virtualenvs/myproject/local/lib/python2.7/site-packages/django/db/models/fields/__init__.py", line 761, in to_python
    return decimal.Decimal(value)
  File "/usr/lib/python2.7/decimal.py", line 658, in __new__
    raise TypeError("Cannot convert %r to Decimal" % value)
TypeError: Cannot convert <django.contrib.gis.gdal.field.OFTInteger object at 0x2458b50> to Decimal 
```

有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:24:15.110

它以某种方式与值的编码有关，然后另一个错误是关于[这个问题](https://stackoverflow.com/a/7682460/1524663)的，最终解决了它。在将值传递给模型进行保存之前，请务必将它们转换为正确的编码 (utf-8)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T09:52:46.787

Decimal 需要一个字符串，但您正在为它提供一个 OTFInteger，您需要在过程中的某处将其转换为字符串

# objective-c - NSMutableArray 的对象在 removeAllObjects 后没有调用 dealloc 方法

> ID：11478715
> 
> 赞同：4
> 
> 时间：2012-07-13T21:36:08.047
> 
> 标签：objective-c, ios, nsmutablearray, automatic-ref-counting

我试图让 dealloc 方法在一些存储/存储在可变数组中的项目上运行，但似乎无法找到实现它的方法。

我在一个更大的 ARC 项目中工作时遇到了这个问题，并在这篇文章中找到了答案：[将对象设置为 nil 时不会调用 dealloc 方法](https://stackoverflow.com/questions/11174860/dealloc-method-is-not-invoked-when-set-an-object-to-nil)。在阅读了那个答案之后，我觉得我理解了 ARC 应该如何处理有问题的代码（如下），但是在一个非常简单的测试项目中运行它之后，我得到了相同的结果。

在主视图控制器中，我初始化了一个可变数组（一个强属性）并向其中添加了一些其他视图控制器。然后我删除所有对象：

```
- (void)viewDidLoad{
    [super viewDidLoad];

    containerArray = [[NSMutableArray alloc]init];
    for(int i = 0; i < 10; i++){

        //item +1 (item at +1)
        Item *item = [[Item alloc]initWithNibName:nil bundle:nil];

        //item +1 (item at +2)
        [containerArray addObject:item];

        //ARC should release item -1 (item at +1...I think)
    }

    //removeAllObjects should release each item -1 (item(s) at 0)
    [containerArray removeAllObjects];
    //dealloc should be called...
} 
```

在项目视图控制器中：

```
-(void)dealloc{
    NSLog(@"item dealloc");
} 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:53:02.393

阅读您的代码 3 次后，我看不出您的方法有任何缺陷。我认为一切都是正确的，`dealloc`当您从数组中删除所有对象时，应该调用 10 次。

然后我决定尝试代码，我发现......我们都是对的 :) 代码是完美的。当我运行它时，我得到了10 次*项目 dealloc*输出。

*   你真的确定你正在一个`ARC`项目中尝试它吗？
*   是`dealloc`里面的`Item`类吗？

还有一些其他的事情你做的不对，但是代码和参数是正确的。

# silverlight - System.Net.CredentialCache.DefaultCredentials 来自受信任的 Silverlight 应用程序？

> ID：11478719
> 
> 赞同：0
> 
> 时间：2012-07-13T21:36:22.080
> 
> 标签：silverlight, elevated-privileges

从这里，[Silverlight Out-of-Browser 应用程序能否调用 .NET DLL？](https://stackoverflow.com/questions/4740832/can-silverlight-out-of-browser-app-call-net-dlls)，可以从 Silverlight 调用完整的 .NET 代码，只要该应用程序是受信任的并且您正在访问的是 ComVisible。

遗憾的是 System.Net.CredentialCache 不是 ComVisible。

反正有没有得到相同的信息？

# php - 使用 PHP/Smarty 模板的文件路径

> ID：11478721
> 
> 赞同：0
> 
> 时间：2012-07-13T21:36:52.757
> 
> 标签：php, smarty, filepath

我有一个使用 SMARTy 模板（我没有创建）在 PHP 中完成的网站。以下代码在 view_video.tpl 中用于生成一个按钮，该按钮带有附加到 onclick 操作的函数。

```
<div class="user-button" id="user-button-up">
    <a href="javascript:void();" onclick="video_description_toggle()">
        <img height="16" width="16" src="images/user-arrow.jpg">
    </a>
</div>
<div class="user-button" id="user-button-down" style="display:none;">
    <a href="javascript:void();" onclick="video_description_toggle()">
        <img height="16" width="16" src="images/user-arrow-down.jpg">
    </a>
</div> 
```

我注意到这些按钮没有显示在页面上，所以我通过 Pingdom (tools.pingdom.com) 运行页面，它分解了页面的每个元素以及加载时间等。在页面结果中，这两个图像（user-arrow.jpg 和 user-arrow-down.jpg）显示的文件路径为：sitename.com/video/41137/images/
其他图像都没有这个不正确的文件路径，只有这两个。

当我从浏览器查看页面源时，它显示：

```
<div class="user-button" id="user-button-up">
    <a href="javascript:void();" onclick="video_description_toggle()">
        <img height="16" width="16" src="images/user-arrow.jpg">
    </a>
</div>

<div class="user-button" id="user-button-down" style="display:none;">
    <a href="javascript:void();" onclick="video_description_toggle()">
        <img height="16" width="16" src="images/user-arrow-down.jpg">
    </a>
</div> 
```

在 video/ 目录中只有视频，没有带有数字的文件夹（或其中包含图像目录）......我相信这对于任何有 PHP 使用模板经验的人来说应该很容易（那不是我......但是） .

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T02:05:30.617

img 中的路径与显示的 url 相关，而不是模板的存储位置，因此如果您在 sitename.com/video/41137/ 中，它将在此处查找 images 文件夹，除非您添加斜杠或“.. /../" 在“图像”之前

# cakephp - 修改 aro_aco 条目？

> ID：11478722
> 
> 赞同：0
> 
> 时间：2012-07-13T21:36:58.060
> 
> 标签：cakephp

我正在使用 CakePHPs ACL 来处理用户权限。

当用户创建一个帖子时，比如说*Post*，我会自动为该帖子创建一个 ACO，并*允许*用户访问它。

但是，如果我想稍后更改用户以便不同的用户“接管”帖子的所有权，我会在 ACL 中做什么？

是否有可用于删除行和添加新关系的删除/删除 ACL 功能？

我考虑过在旧用户上使用*拒绝*，然后在新用户上*允许所有*，但如果父组在结构中同时具有允许/拒绝，那将是一团糟。

除了使用手动 sql 查询之外，还有其他选择吗？

# android - Android - 以编程方式按键

> ID：11478724
> 
> 赞同：1
> 
> 时间：2012-07-13T21:37:06.100
> 
> 标签：android, android-softkeyboard

我正在开发一个使用 w 软键盘的 android 应用程序

我想要做的是以编程方式按下键盘上的一个键

如何实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:43:19.443

`Activity.dispatchKeyEvent(KeyEvent)`在这种情况下是你的朋友。:)

# php - 带有 MySQL 的 PHP 页面未显示/工作

> ID：11478727
> 
> 赞同：0
> 
> 时间：2012-07-13T21:37:39.097
> 
> 标签：php, mysql

以下代码不起作用，因为页面什么都不显示，我不确定为什么。它从 URL 中获取一些信息，然后从数据库中获取最终专辑名称。这是代码：

```
<?php
$cart1 = rawurldecode($_GET["path"]);
list( , , , , , $cart2) = explode ("\\", $cart1);
$cart3 = $cart2;
list($cart4) = explode (" ", $cart3);

$con = mysql_connect("SERVER","USER","PASS");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("cartmatch", $con);

$result = mysql_query("SELECT * FROM cartmatch WHERE CARTNO='$cart4'");

while($row = mysql_fetch_array($result))
  {
echo '<form enctype="multipart/form-data" action="albumgo.php" method="POST"><input name="ID" type="hidden" value=';
echo $_GET["ID"];
echo ' ><input name="enabled" type="hidden" value=';
echo $_GET["enabled"];
echo ' ><input name="artist" type="hidden" value=';
echo $_GET["artist"];
echo ' ><input name="title" type="hidden" value="';
echo $_GET["title"];
echo '" >Name:<br/><input name="album" type="text" autofocus="autofocus" value="';
echo $row['ALBUM'];
echo '" ><input type="submit" name="edit" value="Save"></form>';
  }

mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:42:32.437

试着把下面的代码放到你的脚本里看看有没有错误。

```
ini_set('display_errors', 1);
ini_set('log_errors', 1);
ini_set('error_log', dirname(__FILE__) . '/error_log.txt');
error_reporting(E_ALL); 
```

可能存在数据库连接错误或阻止 PHP 显示其余内容的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:54:49.147

```
list($cart4) = explode (" ", $cart3); 
```

本来应该

```
list($cart4) = explode ("+", $cart3); 
```

# f# - 在 IIS7.5 上部署 WebSharper 2.4 站点

> ID：11478728
> 
> 赞同：1
> 
> 时间：2012-07-13T21:38:21.850
> 
> 标签：f#, iis-7.5, websharper

我从 Visual Studio 2012 创建了一个 websharper sitelet 项目，我称之为 SiteletTest。

我编译了这个项目。

然后我将 SiteletTest/Web 复制到 inetpub/wwwroot。

然后我去`localhost/SiteletTest`，但在每种情况下我都会得到 http 404。`localhost/SiteletTest/Home``localhost/SiteletTest/home`

如果我去`localhost/Main.html`然后我得到一个页面，所以去这个目录似乎工作，但 websharper 似乎没有工作。

我的 web.config 在下面，我不知道还能做什么。我已经将应用程序池设置为使用 .net 4：

```
<configuration>
 <system.web>
  <compilation debug="true" targetFramework="4.5" />
  <authentication mode="Forms" />
  <pages>
   <controls>
    <add tagPrefix="WebSharper" namespace="IntelliFactory.WebSharper.Web" assembly="IntelliFactory.WebSharper.Web" />
    <add tagPrefix="ws" namespace="Website" assembly="Website" />
   </controls>
  </pages>
  <httpModules>
   <add name="WebSharper.Remoting" type="IntelliFactory.WebSharper.Web.RpcModule, IntelliFactory.WebSharper.Web" />
   <add name="WebSharper.Sitelets" type="IntelliFactory.WebSharper.Sitelets.HttpModule, IntelliFactory.WebSharper.Sitelets" />
  </httpModules>
 </system.web>
 <system.webServer>
  <validation validateIntegratedModeConfiguration="false" />
  <modules>
   <add name="WebSharper.Remoting" type="IntelliFactory.WebSharper.Web.RpcModule, IntelliFactory.WebSharper.Web" />
   <add name="WebSharper.Sitelets" type="IntelliFactory.WebSharper.Sitelets.HttpModule, IntelliFactory.WebSharper.Sitelets" />
  </modules>
 </system.webServer>
 <runtime>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
   <dependentAssembly>
    <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
    <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="3.0.0.0" />
   </dependentAssembly>
  </assemblyBinding>
  <assemblyBinding appliesTo="v4.0.30319" xmlns="urn:schemas-microsoft-com:asm.v1">
   <dependentAssembly>
    <assemblyIdentity name="FSharp.Core" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
    <bindingRedirect oldVersion="2.0.0.0" newVersion="4.3.0.0" />
   </dependentAssembly>
  </assemblyBinding>
 </runtime>
</configuration> 
```

在我知道这是否可以满足我的需求之前，我不会为许可证付费，那么，**我该如何让它发挥作用**？

我不想复制站点代码，但这里有一些片段：

```
 type Action =
        | Home
        | Contact
        | Protected
        | Login of option<Action>
        | Logout
        | Echo of string 
```

和另一个片段：

```
module Pages =

    /// The home page.
    let HomePage : Content<Action> =
        Skin.WithTemplate "Home" <| fun ctx ->
            [
                H1 [Text "Welcome to our site!"]
                "Let us know how we can contact you" => ctx.Link Action.Contact
             ] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:19:30.160

我很确定你错过了三件事中的一件：

1-您的站点/路由器未定义......像这样：

```
type Site() =
    interface IWebsite<Action> with
        member x.Sitelet =
            Sitelet.Infer
            <|  function
                | Home -> Pages.HomePage
                ...
        member x.Actions = [] 
```

这会将每个行动案例映射到正确的页面。有很多方法可以定义它，但上面的 Sitelet.Infer 将简单地按名称映射路线。

2-您没有指定网站程序集属性......像这样：

```
[<assembly : Website(typeof<Site>)>]
do () 
```

我认为这告诉 ASP.NET 将上述 Sitelet 作为您的站点加载。

3- 第三个选项是从 C# Web 项目中的 Default.aspx 页面自动加载客户端 JavaScript 控件。如果您使用 Web 应用程序 (ASP.NET) 模板，您将看到一个示例……但我认为您无法以完全 REST 的方式控制 URL 路径。

# r - 创建带有总计行的表格摘要

> ID：11478736
> 
> 赞同：4
> 
> 时间：2012-07-13T21:38:45.743
> 
> 标签：r, aggregate

是否有一个优雅的单线（使用任何 R 包）来完成以下任务？

```
tab <- aggregate(. ~ Species, dat=iris, mean)
total <- data.frame(Species='Overall', t(colMeans(iris[,-5])))
rbind(tab, total) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T23:18:13.703

包裹`tables`

```
library(tables)
tabular( (Species + 1) ~ All(iris)*(mean),data=iris)
> tabular( (Species + 1) ~ All(iris)*(mean),data=iris)

            Sepal.Length Sepal.Width Petal.Length Petal.Width
 Species    mean         mean        mean         mean       
 setosa     5.006        3.428       1.462        0.246      
 versicolor 5.936        2.770       4.260        1.326      
 virginica  6.588        2.974       5.552        2.026      
 All        5.843        3.057       3.758        1.199 
```

但我作弊并复制了帮助文件中的示例；）感谢 Duncan Murdoch。

或在`sqldf`

```
library(sqldf) 
```

库（sqldf）

```
sqldf(" 
   select Species, 
       avg(Sepal_Length) `Sepal.Length`,
       avg(Sepal_Width) `Sepal.Width`,
       avg(Petal_Length) `Petal.Length`,
       avg(Petal_Width) `Petal.Width` 
    from iris 
    group by Species 
union all 
    select 'All', 
       avg(Sepal_Length) `Sepal.Length`,
       avg(Sepal_Width) `Sepal.Width`, 
       avg(Petal_Length) `Petal.Length`,
       avg(Petal_Width) `Petal.Width` 
    from iris"
) 
```

可以写得更紧凑一点：

```
variables <- "avg(Sepal_Length) `Sepal.Length`,
    avg(Sepal_Width) `Sepal.Width`,
    avg(Petal_Length) `Petal.Length`,
    avg(Petal_Width) `Petal.Width`"

fn$sqldf(" select Species, $variables from iris group by Species 
    union all select 'All', $variables from iris") 
```

给予

```
 Species Sepal.Length Sepal.Width Petal.Length Petal.Width
1     setosa     5.006000    3.428000        1.462    0.246000
2 versicolor     5.936000    2.770000        4.260    1.326000
3  virginica     6.588000    2.974000        5.552    2.026000
4        All     5.843333    3.057333        3.758    1.199333 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T21:57:31.003

包`reshape2`在这里可能有点花哨，分为两个步骤：

```
library(reshape2)
iris.m <- melt(iris, id.vars = "Species")
dcast(Species ~ variable, data = iris.m, fun.aggregate = mean, margins = "Species")
#-----
     Species Sepal.Length Sepal.Width Petal.Length Petal.Width
1     setosa     5.006000    3.428000        1.462    0.246000
2 versicolor     5.936000    2.770000        4.260    1.326000
3  virginica     6.588000    2.974000        5.552    2.026000
4      (all)     5.843333    3.057333        3.758    1.199333 
```

请参阅 ?dcast 上的 margins 参数的详细信息

# objective-c - 共享 UITableViewDelegate

> ID：11478740
> 
> 赞同：6
> 
> 时间：2012-07-13T21:39:24.953
> 
> 标签：objective-c, ios, cocoa-touch, cocoa

我正在编写 UITableView 的一个子类，我希望我的子类在将它们传递给“真实”委托之前自己处理一些 UITableViewDelegate 方法，并转发我的子类未实现的所有 UITableViewDelegate 方法。

在子类中，我有一个私有财产：

```
@property (nonatomic, assign) id <UITableViewDelegate> trueDelegate; 
```

它拥有所有未实现的方法都应该转发给的“真正的委托”。在我设置的两个初始化方法中

```
self.delegate = self; 
```

我像这样覆盖 - (void)setDelegate:(id)

```
-(void)setDelegate:(id<UITableViewDelegate>)delegate {
    if (delegate != self) {
        _trueDelegate = delegate;
    } else {
        [super setDelegate:self];
    }
} 
```

然后我覆盖这些来处理消息转发

```
-(NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector {
    NSMethodSignature *sig;
    sig = [[self.delegate class] instanceMethodSignatureForSelector:aSelector];
    if (sig == nil) {
        sig = [NSMethodSignature signatureWithObjCTypes:"@^v^c"];
    }
    return sig;
}

- (void)forwardInvocation:(NSInvocation *)anInvocation {
    SEL selector = anInvocation.selector;
    if ([self respondsToSelector:selector]) {
        [anInvocation invokeWithTarget:self];
    } else {
        [anInvocation invokeWithTarget:_trueDelegate];
    }
} 
```

问题是未实现的委托方法永远不会在 tableview 上被调用，因此它们没有机会被转发到 _trueDelegate 对象。

我试着在这里检查它们：

```
- (BOOL)respondsToSelector:(SEL)aSelector {

} 
```

但是 UITableViewDelegate 方法永远不会调用该方法，尽管它可以很好地捕获其他方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-13T23:57:09.387

为了提高性能，`UITableView`一旦设置了委托，就会检查并记住哪些委托方法可用。您首先设置委托`self`，然后设置`trueDelegate`. 因此，在委托被设置时`UITableView`，`trueDelegate`总是返回。`nil``-respondsToSelector:``NO`

要解决此问题，请在设置后设置委托`trueDelegate`。此外，您可以简化转发代码。删除除属性之外的所有代码并将其替换为：

```
- (void)setDelegate:(id <UITableViewDelegate>)delegate
{
    if (delegate == self) return;

    self.trueDelegate = delegate;
    [super setDelegate:self];
}

- (BOOL)respondsToSelector:(SEL)aSelector
{
    if ([super respondsToSelector:aSelector]) return YES;

    return [self.trueDelegate respondsToSelector:aSelector];
}

- (id)forwardingTargetForSelector:(SEL)aSelector
{
    return self.trueDelegate;
} 
```

# html - 使用 Rails 的 Haml：将表格列变成链接

> ID：11478743
> 
> 赞同：1
> 
> 时间：2012-07-13T21:39:57.997
> 
> 标签：html, ruby-on-rails, haml

我正在创建一个这样的haml表：

```
%tbody
  - @records.each do |br|
    %tr
      %td.name
        = br.full_name
      %td.address
        = br.address 
```

我想创建一个从整个`tr`页面到另一个页面的链接。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T10:17:58.653

`<a>`因为在标签内嵌套任何块级元素都是非法的。我会用 jQuery 来做。

```
%tr{"data-link" => url_for(:action => 'show', :id => br.id)}
  %td.name
    = br.full_name
  %td.address
    = br.address 
```

然后，在表格的最后：

```
:javascript
  $("tr[data-link]").click(function() {
    window.location = this.data("link")
  }) 
```

您还应该包括一个将鼠标光标更改为指针的样式表。

```
:stylesheet
  #yourtable tr
    cursor: pointer; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:49:00.697

您应该能够将该行作为一个块传递给`link_to`：

```
link_to(url, html_options = {}) do
  #row
end 
```

编辑：

```
- link_to(url, html_options = {}) do
  %tr
    %td.name
      = br.full_name
    %td.address
      = br.address 
```

由 OP 编辑​​：这最终起作用了：

```
 %tr
    %td.name
      = link_to(br.full_name, html_options = {:action => 'show', :id => br.id}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-31T14:25:52.403

这是我在 Rails 4.0.2 中的做法。我的控制器的名字是`order`.

为您的表格分配一个 id，以便您以后可以通过 CSS 识别它；我用了 id `orders`。

对于包含数据单元格的每个表格行，将“data-link”属性与链接的值一起添加到它（在我的例子中，它看起来像`/orders/1`等等）。

```
app/views/orders/index.html.haml 
```

* * *

```
%table#orders
  %tr
    %th ...
    .
    .
    .
  - @orders.each do |order|
    %tr{"data-link" => order_path(order)}
      %td= ...
      .
      .
      . 
```

在您的 JavaScript 文件（或此处所示的 CoffeeScript 文件）中，为具有“data-link”属性及其各自“data-link”值的表行创建链接。

```
app/assets/javascripts/order.js.coffee 
```

* * *

```
$ ->
  $("tr[data-link]").click ->
    window.location = @dataset.link 
```

在控制器的样式表中，将光标悬停在行上时将光标变为指针，以指示它们是可点击的。

```
app/assets/stylesheets/order.css.scss 
```

* * *

```
#orders tr[data-link] {
  cursor: pointer;
} 
```

# c# - Linq 问题查询两个数据集合

> ID：11478744
> 
> 赞同：0
> 
> 时间：2012-07-13T21:39:59.857
> 
> 标签：c#, asp.net, linq

这是我正在使用的代码：

```
 Collection<WorkOrderLabor> workOrder = new Collection<WorkOrderLabor>();
        Collection<ServiceItem> serviceItems = new Collection<ServiceItem>();

        serviceItems  = from si in serviceItems
                        join cw in workOrder on si.ServiceKey equals cw.Key
                        select new { si };

        foreach (ServiceItem item in serviceItems)
            ctrl.Items.Add(...); 
```

我收到此错误：

```
Cannot implicitly convert type 'System.Collections.Generic.IEnumerable<AnonymousType#1>' to 'System.Collections.ObjectModel.Collection<ServiceItem>' 
```

我相信这有望成为一个简单的解决方案，但我无法弄清楚。这背后的逻辑是我需要根据传递给此方法的键来查找工作订单，然后获取工作订单具有的所有服务项目并遍历它们以将它们放入组合框中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T21:42:12.773

应该只是

```
Collection<WorkOrderLabor> workOrder = new Collection<WorkOrderLabor>();
Collection<ServiceItem> serviceItems = new Collection<ServiceItem>();

var filteredItems = from si in serviceItems
                    join cw in workOrder on si.ServiceKey equals cw.Key
                    select si;

foreach (ServiceItem item in filteredItems)
    ctrl.Items.Add(...); 
```

您不想`IEnumerable<>`从 LINQ 表达式返回一个匿名类型，而是返回一个`IEnumerable<ServiceItem>`

# python - 使用 boto 库，我可以避免授予 S3 中基本存储桶的列表权限吗？

> ID：11478752
> 
> 赞同：3
> 
> 时间：2012-07-13T21:40:50.133
> 
> 标签：python, amazon-s3, amazon-web-services, boto

我目前有一个 IAM 角色，其政策如下：

```
{
  "Version":"2008-10-17",
  "Statement": [
  {
    "Effect":"Allow",
    "Action":["s3:ListBucket"],
    "Resource":[
      "arn:aws:s3:::blah.example.com"
    ]
  },
  {
    "Effect":"Allow",
    "Action":["s3:GetObject", "s3:GetObjectAcl", "s3:ListBucket", "s3:PutObject", "s3:PutObjectAcl", "s3:DeleteObject"],
    "Resource":[
      "arn:aws:s3:::blah.example.com/prefix/"
    ]
  }
  ]
} 
```

Boto 似乎要求存储桶的根目录上存在 ListBucket 权限才能执行 get_bucket 调用。如果我删除 Statement 数组中的第一个哈希， get_bucket('blah.example.com') 将失败。这是错误文本：

```
*** S3ResponseError: S3ResponseError: 403 Forbidden
<?xml 版本="1.0" 编码="UTF-8"?>
<Error><Code>AccessDenied</Code><Message>Access Denied</Message><RequestId>xxxx</RequestId><HostId>yyyy</HostId></Error>

```

有没有办法在仍然使用 boto 的同时将存储桶列表限制为某个前缀（例如“prefix/”）？

**更新**

为了让一切正常工作，我使用了以下策略：

```
{
  "Version":"2008-10-17",
  "Statement": [
  {
    "Effect":"Allow",
    "Action":["s3:ListBucket"],
    "Resource":[
      "arn:aws:s3:::blah.example.com"
    ],
    "Condition":{
      "StringLike":{
         "s3:prefix":"prefix/*"
      }
    }
  },
  {
    "Effect":"Allow",
    "Action":["s3:GetObject", "s3:GetObjectAcl", "s3:PutObject", "s3:PutObjectAcl", "s3:DeleteObject"],
    "Resource":[
      "arn:aws:s3:::blah.example.com/prefix/*"
    ]
  }
  ]
} 
```

您仍然必须使用该方法的`validate=False`参数`get_bucket`，但它允许在前缀中列出。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T21:47:01.270

默认情况下，boto 尝试通过对存储桶执行 LIST 操作来验证存储桶的存在，并要求零结果。如果您希望它跳过此验证步骤，只需像这样调用它：

```
>>> import boto
>>> s3 = boto.connect_s3()
>>> bucket = s3.get_bucket('mybucket', validate=False) 
```

这应该跳过 LIST 操作。

# ruby-on-rails-3 - Heroku 运行 rake db：重置错误

> ID：11478754
> 
> 赞同：1
> 
> 时间：2012-07-13T21:41:09.557
> 
> 标签：ruby-on-rails-3, heroku

我正在尝试重置我的 Heroku 数据库。我收到以下错误：

```
** Invoke environment 
** Execute db:abort_if_pending_migrations
rake aborted!
uninitialized constant Object::State
/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/ext/module.rb:36:in `const_missing'
/app/db/seeds.rb:9:in `<top (required)>'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/engine.rb:520:in `load'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/engine.rb:520:in `load_seed'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib 
```

seed.rb 的第 9 行是 State.create(name: 'Alaska', abbrev: 'AK' ); 模型已定义。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T08:27:55.373

`rake db:reset task`不支持。Heroku 应用无权删除和创建数据库。请改用该`heroku pg:reset`命令。

# web-services - 将 Web 服务公开为无状态会话 bean 的任何线程安全优势？

> ID：11478756
> 
> 赞同：3
> 
> 时间：2012-07-13T21:41:28.363
> 
> 标签：web-services, jakarta-ee, annotations, jax-ws, stateless-session-bean

将 Web 服务公开为无状态会话 bean 是否有任何与线程安全相关的好处？
（如果我错了，请纠正我）但我认为 Web 服务不是线程安全的，并且像 Servlet 一样，只有一个 Web 服务类的实例是由服务器创建的（不是每个请求一个实例）。

我不知道它们是否是从无状态 bean 的 bean 池中分配的 - 由应用程序服务器分配。我正在尝试查找是否将 @Stateless 注释与已使用 @WebService 注释注释的 Web 服务一起使用，这将强制应用服务器开始为每个传入请求从池中分配它们。这样我就确定我将为每个传入请求创建一个单独的实例？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-15T18:05:24.593

**介绍**

Web 服务端点使用的实例数取决于您使用的框架。

如果您使用简单的端点（即带有 Apache CXF 或 Spring webservices 的 JAX-WS），您将拥有一个用于所有线程/请求的服务实例（如您所说，Servlets）。因此，根据定义，这种服务是无状态的。但是如果你需要为服务添加一些状态，你可以这样做，但要由开发人员来确保服务线程安全。

当您使用 EJB 时，您拥有更大的灵活性：如果您使用无状态 bean，您将拥有一个实例池来管理所有请求（如果您的 poolSize=1，您将获得与 Apache CXF 相同的行为）。同样，您可以向无状态 bean 添加一些状态，但使其线程安全更加困难，因为您需要管理一个实例池。但是如果你需要一个状态，你可以使用一个有状态的 bean 来拥有一个框架，让你在线程安全方面的工作更轻松。

**关于服务状态的一些提示**

如果您不在服务中保留状态，则您的 Web 服务是线程安全的。换句话说，如果定义为线程安全，则无状态服务。

如果您需要一些应该由所有线程/请求共享的状态，您可以向无状态服务（JAX-WS 或具有 poolSize=1 的无状态会话 bean）添加一些状态，但您需要使其线程安全，添加 sycn 块（请不要同步您的`@WebMethod`）。**重要提示：**理论上（和实践中），您永远不应该向无状态会话 bean 添加状态，因为池可以在“想要”时销毁/创建实例。

如果您需要保留仅由当前线程/请求使用的状态，您可以使用`ThreadLocal`变量将一些状态添加到无状态服务，或者更轻松地使用有状态会话 bean。

**现在终于回答你的问题了**

1.  当且仅当您使它们成为线程安全时，无状态会话 bean 才是线程安全的：它们不应该有状态 :-)
2.  经典 Web 服务和无状态会话 bean Web 服务之间的唯一区别是第一个将具有单个实例，而第二个将使用实例池。如果您的 poolSize=1 您会得到相同的效果，但理论上，池可以在“想要”时破坏您的实例。

希望有帮助，

# linux - 哪个发行版用于学习 linux（工作视角）？

> ID：11478758
> 
> 赞同：1
> 
> 时间：2012-07-13T21:41:38.567
> 
> 标签：linux, ubuntu, rhel, distro

用于学习 linux 的发行版（从工作的角度来看）。大多数软件公司使用哪个发行版？我想知道是选择 RHEL 还是 Ubuntu 或其他任何一个。什么是最好的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:44:09.713

我真的不认为这与您对 Linux 环境和可用工具的舒适程度（以及了解*可用*工具以及如何使用它们）一样重要。

自 1990 年代初以来，我一直在使用 Unix/Linux，但我仍然遇到一些我不知道的东西。该操作系统的*主要*优势之一是可用的工具范围广泛，并且有时通过组合它们来完成任务的灵活性。

一旦您在 Linux 环境中适应了，对给定发行版的调整就会很小。您可能会注意到更改默认 shell 比更改发行版更多：)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T02:23:11.270

只要您对主要的 linux 实用程序（例如 find/grep/sed/awk 和 bash）感到满意，就应该没问题。但是大多数主要发行版都基于 RPM 或 debs，了解这两种打包机制将是一件大事帮助。作为系统管理员相关的工作，每天都需要防火墙、RAID 和文件权限等概念。

# opencv - 离线视频中的人脸识别

> ID：11478763
> 
> 赞同：1
> 
> 时间：2012-07-13T21:41:48.960
> 
> 标签：opencv, face-recognition

我正在寻找识别多个 mp4 文件中的人脸的工具。我偶然发现了 opencv 库，但我希望有人可能已经编写了一些示例代码，我可以查看这些代码或将我指向其他一些工具。

任务如下：我有一组大约 600 人，有很多训练图像。我想知道这些人是否出现在我的几十个 mp4 视频中（通常，每个视频中出现大约 50-100 个）。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:11:02.323

我建议您使用 Python 和 openCV，而不是对扫描 mp4 文件和使用 openCV 库来查找您的面孔进行小型研究。从这里你只需要数数。如果你谷歌它，你会找到它。希望它对你有所帮助。

# java - EclipseLink 继承查询：避免加入

> ID：11478764
> 
> 赞同：0
> 
> 时间：2012-07-13T21:41:56.037
> 
> 标签：java, inheritance, eclipselink

现在，在一个简短的示例中，如果我有两个实体`Person`并且`Applicant`我想编写一个查询来获取我的数据库中的所有申请人，我最终会通过以下设置获得引用的查询。我正在使用 Single_Table_Inheritance 策略（仅供参考）

```
public class Person {

    @ManyToOne(fetch = FetchType.LAZY) 
    @JoinColumn(name = "schoolID")
    private School school;
} 
```

引用另一个实体的 Teacher 对象。

```
public class Applicant extends Person {

  @OneToMany(targetEntity = ApplicantSchool.class, cascade = { javax.persistence.CascadeType.PERSIST, javax.persistence.CascadeType.REMOVE }, mappedBy = "applicant")
    private Set<ApplicantSchool> schools = new HashSet<ApplicantSchool>();
} 
```

在Person中跳转并尝试查询学校关系的查询尝试

```
 public List<Applicant> getAllApplicants(){

        EntityManager entityManager = factory.createEntityManager();
        @SuppressWarnings("unchecked")
        List<Applicant> applicants = entityManager.createQuery("Select a from Applicant a LEFT JOIN FETCH a.schools WHERE a.active = :active ")
        .setParameter("active", true).setHint("eclipselink.refresh", "true")
        .getResultList();
        //List<Applicant> applicants =  Applicant.findAllApplicants();
        System.out.println("The long query getting applicants");
        entityManager.close();
        return applicants;  
    } 
```

如果我尝试将查询更改为使用嵌套连接，则会收到一条错误消息，提示无法识别关系。我试图这样查询：

```
entityManager.createQuery("Select a from Applicant a LEFT JOIN FETCH a.schools WHERE LEFT JOIN FETCH a.person.school a.active = :active ") 
```

**更新**

删除关键字“left join fetch”后，我的新查询：

```
List<Applicant> applicants = entityManager.createQuery("Select a from Applicant a WHERE a.active = :active ")
        .setParameter("active", true)
        .getResultList(); 
```

我同意它首先创建的唯一查询是这个

```
SELECT personID, TYPE, DATEADDED, FIRSTNAME, LASTNAME, MIDDLENAME, ACTIVE, BIRTHDAY, EMAILADDRESS, ETHNICITY, GENDER, HISPANIC, IMAGEPATH, MARITAL, NATIVELANGUAGE, PRIMARYTELEPHONE, RELIGIOUSAFFILIATION, SECONDARYTELEPHONE, version, addressID, schoolID, MAJOR FROM PERSON WHERE ((ACTIVE = ?) AND (TYPE = ?))
    bind => [true, AP] 
```

返回此堆栈跟踪并创建以下 sql 选择：

```
[EL Fine]: sql: 2012-07-13 17:25:52.297--ServerSession(1529073996)--Connection(726700617)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT schoolID, ACTIVE, ADMISSIONSEMAILADDRESS, ADMISSIONSPHONE, CODE, description, HELPGENERALEMAILADDRESS, NAME, PRIMARYPHONE, version, addressID FROM SCHOOL WHERE (schoolID = ?)
    bind => [1]
[EL Fine]: sql: 2012-07-13 17:25:52.305--ServerSession(1529073996)--Connection(1615948530)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT id, ACTIVE, CODE, DESCRIPTION, NAME, version, SCHOOLDEPARTMENT_schoolID FROM DEPARTMENT WHERE (SCHOOLDEPARTMENT_schoolID = ?)
    bind => [1]
[EL Fine]: sql: 2012-07-13 17:25:52.308--ServerSession(1529073996)--Connection(893810654)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT programID, ACTIVE, CODE, description, NAME, PROGRAMTYPE, REQUIREDCREDITS, version, SCHOOL_schoolID FROM PROGRAM WHERE (SCHOOL_schoolID = ?)
    bind => [1]
[EL Fine]: sql: 2012-07-13 17:25:52.31--ServerSession(1529073996)--Connection(399107363)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT personID, TYPE, DATEADDED, FIRSTNAME, LASTNAME, MIDDLENAME, ACTIVE, BIRTHDAY, EMAILADDRESS, ETHNICITY, GENDER, HISPANIC, IMAGEPATH, MARITAL, NATIVELANGUAGE, PRIMARYTELEPHONE, RELIGIOUSAFFILIATION, SECONDARYTELEPHONE, version, addressID, schoolID, MAJOR, studentId FROM PERSON WHERE (schoolID = ?)
    bind => [1]
[EL Fine]: sql: 2012-07-13 17:25:52.314--ServerSession(1529073996)--Connection(464642021)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT registrationId, SEMESTERTYPE, version, YEAR, semesterCourseId, personID FROM REGISTRATION WHERE (personID = ?)
    bind => [501]
[EL Fine]: sql: 2012-07-13 17:25:52.322--ServerSession(1529073996)--Connection(395757277)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT registrationId, SEMESTERTYPE, version, YEAR, semesterCourseId, personID FROM REGISTRATION WHERE (personID = ?)
    bind => [552]
[EL Fine]: sql: 2012-07-13 17:25:52.327--ServerSession(1529073996)--Connection(328677993)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT registrationId, SEMESTERTYPE, version, YEAR, semesterCourseId, personID FROM REGISTRATION WHERE (personID = ?)
    bind => [602]
[EL Fine]: sql: 2012-07-13 17:25:52.358--ServerSession(1529073996)--Connection(873312397)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT addressID, CITY, COUNTRY, STATE_US, STREETADDRESS, STREETADDRESS2, version, ZIPCODE FROM ADDRESS WHERE (addressID = ?)
    bind => [2]
[EL Fine]: sql: 2012-07-13 17:25:52.365--ServerSession(1529073996)--Connection(509650638)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT applicantSchoolID, CREDITSCOMPLETED, FROMMONTH, FROMYEAR, GPA, NAME, SCHOOLTYPE, TOMONTH, TOYEAR, version, APPLICANT_personID FROM APPLICANTSCHOOL WHERE (APPLICANT_personID = ?)
    bind => [151]
[EL Fine]: sql: 2012-07-13 17:25:52.385--ServerSession(1529073996)--Connection(17334753)--Thread(Thread["http-bio-8080"-exec-18,5,main])--SELECT applicantSchoolID, CREDITSCOMPLETED, FROMMONTH, FROMYEAR, GPA, NAME, SCHOOLTYPE, TOMONTH, TOYEAR, version, APPLICANT_personID FROM APPLICANTSCHOOL WHERE (APPLICANT_personID = ?)
    bind => [51] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:10:43.810

您不能在 JPA 中嵌套连接，但在查询申请人时不需要这样做。
JPQL“从申请人中选择一个 LEFT JOIN FETCH a.schools LEFT JOIN FETCH a.school where a.active = :active ”应该可以工作，因为申请人是一个人，因此有学校关系。仅当申请人与人有关系并且您需要获取加入人和学校时才可以嵌套。

如果是这种情况，EclipseLink 允许通过此处描述的查询提示进行批量读取或连接：http: [//wiki.eclipse.org/EclipseLink/Examples/JPA/QueryOptimization](http://wiki.eclipse.org/EclipseLink/Examples/JPA/QueryOptimization)

您还可以使用此处描述的 EclipseLink 注释在映射级别指定批处理/获取连接：http: [//www.eclipse.org/eclipselink/documentation/2.4/jpa/extensions/a_batchfetch.htm#CHDCCIDA](http://www.eclipse.org/eclipselink/documentation/2.4/jpa/extensions/a_batchfetch.htm#CHDCCIDA) 和 [http://www。 eclipse.org/eclipselink/documentation/2.4/jpa/extensions/a_joinfetch.htm#CEGFFHHA](http://www.eclipse.org/eclipselink/documentation/2.4/jpa/extensions/a_joinfetch.htm#CEGFFHHA)

批量读取将产生 2 个查询，而 fetch joins 产生 1 个。

对于上述查询，您还可以使用：

```
em.createQuery("Select a from Applicant a WHERE a.active = :active ")
         .setParameter("active", true)
         .setQueryHint("eclipselink.left-join-fetch", "a.schools");
         .setQueryHint("eclipselink.left-join-fetch", "a.school");
         .getResultList(); 
```

# xsd - 在 XSD 文件中，对给定元素使用两个订单指示器是否合法？

> ID：11478766
> 
> 赞同：1
> 
> 时间：2012-07-13T21:41:59.080
> 
> 标签：xsd

我正在为以下 XML 结构创建 XSD：

```
<BaseNode>
  <ParentNode1>
    <childnode/>
  </ParentNode1>
  <ParentNode2>
    <childnode/>
  </ParentNode2>
  <ParentNodeA>
    <childnode/>
  </ParentNodeA>
  <ParentNodeB>
    <childnode/>
  </ParentNodeB>
</BaseNode> 
```

其中：ParentNodes 1 和 2 必须按顺序出现，A 和 B 是可选的（如果存在，每个只会出现一次），但如果存在，则必须出现在 1 和 2 之后。

我“认为”会起作用的是以下内容，但它有效吗？（具体来说，同时存在序列和所有订单指标）

```
<xs:element name="BaseNode">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="ParentNode1">
        ....
      </xs:element>
      <xs:element name="ParentNode2">
        ....
      </xs:element>
    </xs:sequence>
    <xs:all>
      <xs:element name="ParentNodeA">
        ....
      </xs:element>
      <xs:element name="ParentNodeB">
        ....
      </xs:element>
    </xs:all>
  </xs:comlexType>
</xs:element> 
```

我找不到任何参考（在 w3schools.com 或其他地方）来复合使用订单指标，并且没有现成的验证器。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:34:37.360

[我在http://www.w3.org/TR/xmlschema-0/#groups](http://www.w3.org/TR/xmlschema-0/#groups)找到了答案

> XML Schema 规定 all 组必须作为唯一的子项出现在内容模型的顶部。

链接中提供的示例。

# html - webkit浮动在调整大小时闪烁

> ID：11478767
> 
> 赞同：1
> 
> 时间：2012-07-13T21:42:01.247
> 
> 标签：html, css, webkit, css-float, flicker

我正在尝试在 HTML 和 CSS 中创建一个 2d 网格，其中调整窗口大小会将元素重新排列到适当的行。只需将固定宽度的 div 向左浮动即可达到效果，但我想添加动态边距以最小化屏幕右侧的空白。

我的问题是当通过javascript添加动态边距（b / t div）时，当调整浏览器窗口的大小时，div会出现闪烁（即在行之间快速来回切换）（仅在宽度**减小**时发生）。

该错误出现在 webkit（chrome 和 safari）中，但不在 Firefox 中。如果它只是一个 webkit 错误，有没有办法绕过它？

可以在 jsfiddle 或常规网页上看到一个示例：

[http://jsfiddle.net/RAZHA/3/](http://jsfiddle.net/RAZHA/3/)

[http://alec.thewinograds.com/float_flicker_example.html](http://alec.thewinograds.com/float_flicker_example.html)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T17:58:42.357

```
 $(box).css("margin-left", (marginSide * .5) - MARGIN_REDUCTION); 
```

在我看来，这是一个 JS 问题；只减少边距，而不是两者。

[http://jsfiddle.net/RAZHA/3/](http://jsfiddle.net/RAZHA/3/)

# javascript - CSS 区域的实现方法

> ID：11478769
> 
> 赞同：0
> 
> 时间：2012-07-13T21:42:10.553
> 
> 标签：javascript, html, dom, css

我在玩 CSS 区域：[http ://www.w3.org/TR/2012/WD-css3-regions-20120503/](http://www.w3.org/TR/2012/WD-css3-regions-20120503/)

```
document.webkitGetFlowByName("myFlow")
=> WebKitNamedFlow 
```

但是，所有 JavaScript API/方法都不起作用。这可能是一个幼稚的问题，但我对使用提议的 JavaScript API 真的很感兴趣。关于如何实施它的任何想法？此演示页面重点介绍了我喜欢使用的命名流的特定方法：http: [//html5-demos.appspot.com/static/html5-therealbleedingedge/template/index.html#13](http://html5-demos.appspot.com/static/html5-therealbleedingedge/template/index.html#13)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-15T17:13:43.683

CSS Regions 的开发仍在进行中。

最新的更新目前仅在[WebKit nightly builds](http://nightly.webkit.org/)中可用。如果您使用的是 Google Chrome，请注意 CSS 区域需要手动启用。在地址栏中输入“about://flags”，启用 CSS Regions 标志并重新启动浏览器。

谷歌浏览器有一些特性，但由于谷歌的 Webkit 分叉计划，大多数都处于中间状态。

您可以运行[CSS 区域功能检测测试](http://adobe.github.com/web-platform/utilities/css-regions-feature-testing/)并查看在您的环境中运行的内容。

目前 CSS Regions 仍在开发中，一些功能将在未来几周内略有变化。

[CSS Regions 示例](http://adobe.github.com/web-platform/samples/css-regions/)可以帮助您试验这些功能。这些示例都有望与最新的 Webkit nightly build 一起使用。

# iphone - 在我的第一个应用程序中修复内存泄漏

> ID：11478771
> 
> 赞同：0
> 
> 时间：2012-07-13T21:42:12.647
> 
> 标签：iphone, xcode4

Stack Overflow 的人们我需要你的帮助。我即将向 App Store 发布我的第一个应用程序，我需要帮助解决我的应用程序存在的内存泄漏问题。它是一个简单的基于视图的应用程序，具有多个视图、iAd 和带有声音的按钮（该应用程序是一个简单的音板）。我需要我应该放什么的例子和一张图片

分析器消息：`Potential Leak of an Object allocated on Line 135 and stored into 'soundFileURLRef'`

```
-(IBAction)sound25 {
    CFBundleRef mainBundle = CFBundleGetMainBundle();
    CFURLRef soundFileURLRef;
    soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"BELLMACH", CFSTR ("wav"), NULL);

    UInt32 soundID;
    AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
    AudioServicesPlaySystemSound(soundID);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T22:13:39.747

的[文档`CFBundleCopyResourceURL`](https://developer.apple.com/library/mac/#documentation/CoreFOundation/Reference/CFBundleRef/Reference/reference.html)说它遵循[“创建规则”](https://developer.apple.com/library/mac/documentation/CoreFOundation/Conceptual/CFMemoryMgmt/Concepts/Ownership.html#//apple_ref/doc/uid/20001148-103029)，这反过来基本上说任何名称中带有“创建”或“复制”的函数都会返回一个保留对象。在您使用完它之前，您拥有该对象的所有权 - 因此，`CFRelease`当您不再使用该对象时，您有责任调用该对象。大概是在你用它来创建和播放系统声音之后，所以你可以添加

```
CFRelease(soundFileURLRef); 
```

在该方法结束时并没问题，假设您不坚持或不需要`soundFileURLRef`其他任何地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T22:13:55.827

由于名称“CFBundleCopyResourceURL”包含单词“Copy”，因此它遵循“创建规则”并且您“拥有”该对象并负责在完成后释放它。

# javascript - 计算具有特定类的元素数量，然后添加对它们进行编号的 ID

> ID：11478777
> 
> 赞同：0
> 
> 时间：2012-07-13T21:42:41.607
> 
> 标签：javascript, jquery, function, dynamic, each

我对此很陌生，只是试图拼凑其他帖子的片段。

我不确定如何计算页面上的元素数量，然后添加一个类以用数字区分它们。

```
<script type="text/javascript">
$(document).ready(function(){
    $('.item').each(function (e) { $(this).addClass('count' + e); });
});
</script>

<div class="item"></div>
<div class="item"></div>
<div class="item"></div> 
```

输出到：

```
<div class="item count1"></div>
<div class="item count2"></div>
<div class="item count3"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:45:45.923

尝试这个

```
$('div.item').each(function(i,n){ $(n).addClass('count' + (i + 1));}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:49:02.617

```
$('.item').addClass(function(i){
    return "count" + (i + 1);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T21:50:02.323

如果你只是改变，你所拥有的就很好：

```
$(this).addClass('count' + e); 
```

至

```
$(this).addClass('count' + (e + 1)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T21:45:17.617

尝试这个：

```
$('.item').each(function (i, e) { $(e).addClass('count' + i); }); 
```

# google-apps-script - 需要 Google App 脚本每隔几天自动从电子表格中删除行

> ID：11478781
> 
> 赞同：0
> 
> 时间：2012-07-13T21:43:10.083
> 
> 标签：google-apps-script

我正在寻找一种每隔几天自动从谷歌电子表格中删除过时行的方法。我为电子表格中的每一行存储了时间戳。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T01:52:34.097

[您可以从此答案](https://stackoverflow.com/a/17078362/1677912)调整清理功能，并使其作为定时触发器运行。

# c# - 按索引列表在 Linq-To-Sql 中排序

> ID：11478782
> 
> 赞同：0
> 
> 时间：2012-07-13T21:43:12.673
> 
> 标签：c#, linq-to-sql

我在我的网站中实现了一个使用`Linq-To-Sql`. 引擎的输出是一个列表`Result`。
为了提高安全性和性能，我在`CachedResult`我的数据库中添加了一个表。它有这些列：
`ID`, `Date`, `Output`
Where`Output`是一个字符串，它表示一个列表，`integers`其中的`ID`s 是另一个表的。
使用该`Where`方法，我能够从数据库中提取这些元素。问题是他们的顺序是基于他们在表格中的顺序，而不是`integers`我的字符串中的顺序。
因此，我以这种方式添加了`OrderBy`该方法：
`db.Uploads.Where(upl => W.Contains(upl.UploadID)).OrderBy(pp => W.IndexOf(pp.UploadID));` `W`这是`integers`（从数据库中提取的）的列表。
问题是它抛出了一个异常，说`Linq-To-Sql translator`无法将该`List.IndexOf`方法转换为适当的 SQL 查询。

我想知道我这样做是否正确并且有解决方案，或者我完全错了，我必须寻求另一种方式？（即制作另一个与 有关系的表`CachedResults`）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:57:47.597

您可以在排序之前将结果实现为列表，以便它使用 Linq-To-Objects 而不是 Linq-To-Sql 进行排序：

```
db.Uploads
  .Where(upl => W.Contains(upl.UploadID))
  .ToList()
  .OrderBy(pp => W.IndexOf(pp.UploadID)); 
```

但是，这不是很有效。由于该`IndexOf`方法是 O(n) 操作，因此排序将是 O(n ² ) 操作。

`CachedResultItems`另一种解决方案是为每个缓存结果的整数添加另一个表，其中包含以下字段：

```
ID       int
Ouptut   int
Position int 
```

您可以在表中保存这些记录（对于表中的 ID 42 ），而不是`5,7,12,26,81`在表中存储字符串：`CachedResult``CachedResultItems``CachedResult`

```
ID   Output  Position
---- ------- ---------
42   5       1
42   7       2
42   12      3
42   26      4
42   81      5 
```

然后您可以连接这两个表，并对结果进行排序`Position`。

这也比第一次获得一个结果、将字符串拆分为一个列表并在查询中使用该列表要快，因为它是一个单一的查询，并且它可以更有效地使用索引。

# c++ - C++“三角形”（而不是菱形）继承

> ID：11478783
> 
> 赞同：1
> 
> 时间：2012-07-13T21:43:14.033
> 
> 标签：c++, design-patterns, generic-programming, virtual-inheritance

（我在这里搜索并阅读了 Diamond-and virtual-inheritance questions，但找不到答案。我的想法是这种情况有点不寻常，我愿意接受我的要求有些偏离的想法。关于另一方面，我认为这应该以“不错”的方式可行。）

情况及要求：

我有一个我无法控制且无法更改的 C++ 类库。它定义了一个`Window`类。该类`Window`有一个受保护的成员（例如：）`handle`，不能以其他方式访问，派生类打算使用该成员。`Window`定义了数百个（嗯，非常多的......）方法，我不想通过委托（比如在装饰器中）重新实现这些方法。

我想向 中添加功能`Window`，以便派生类（我写的；说`LogWindow`）自动具有。此类功能的一个示例是能够将窗口彼此对齐。为了实现这一点，我需要访问`Window`受保护的`handle`成员。

对于我的实际目的，这已经足够了，解决方案很简单：派生`SnappableWindow`自`Window`，并派生所有我的`Window`派生类（`LogWindow`在本例中）从`SnappableWindow`。

然而，我*真正*想要的，更漂亮的恕我直言，是：

1.  将这种“Snappable”功能作为独立代码片段的能力，我可以选择“插入”任何其他`Window`派生类，也可以不选择。
2.  将这一概念扩展到其他功能的能力，例如最小化窗口的能力。所以我可以有一个`Window`- 派生类，有或没有“Snappable”能力，有或没有“Minimizable”能力。
3.  “SnappableWindow”和“MinimizableWindow”的实现都需要访问受保护`Window`的`handle`成员。
4.  我希望“Snappable”和“Minimizable”成为实际类声明的一部分，这样我的实际类（`LogWindow`）“是一个”窗口，“是一个”SnappableWindow，并且“是一个”MinimizableWindow。

...现在是问题：

我知道如何通过声明`SnappableWindow`and`MinimizableWindow`而*不是*从它们的构造函数中`Window`获取 a来执行此操作`handle`，然后`LogWindow`从`Window`and 的任意组合派生`SnappableWindow`和派生`MinimizableWindow`。

编辑：在调用了init()之后，在 LogWindow 的构造函数中途`handle`被初始化。（而不是像我之前所说的那样，通过构造函数的一半）。`Window``Window``Window`

*但是*，由于`handle`仅`LogWindow`在 's 的构造函数中初始化（在它调用`Window`'s之后`init()`），我不能将 is 传递给`SnappableWindow`并`MinimizableWindow`作为`LogWindow`'s 的构造函数初始化列表的一部分。相反，我必须`init()`在两者上显式调用一些方法，并将其传递给`handle`. 而这，在我的每个`Window`派生类中。( `LogWindow`, `SearchWindow`,`PreferencesWindow`等)

我正在寻找一种能够执行以下操作的方法：

> 类 LogWindow：公共窗口、公共 SnappableWindow、公共 MinimizableWindow

...并且不必在内部实现任何其他内容`LogWindow`。我已经摆弄虚拟继承，但不能完全想出解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:13:37.013

虚拟继承应该能够处理这个：

```
class SnappableWindow: virtual public Window

class MinimizableWindow: virtual public Window

class LogWindow: virtual public Window, public SnappableWindow, public MinimizableWindow 
```

请注意，三角形只是钻石的特例！

```
Window
|  \  \---------------\
|   \                  \
|    SnappableWindow    MinimizableWindow
|   /                  /
|  /    /-------------/
LogWindow 
```

编辑：这是一个完整的例子：

```
#include <iostream>
int get_handle() { static int handle = 0; return ++handle; }
struct Window {
    int handle;
    Window() : handle(get_handle()) { }
};
struct SnappableWindow: virtual public Window {
    SnappableWindow() { std::cout << "Snap! " << handle << std::endl; }
};
struct MinimizableWindow: virtual public Window {
    MinimizableWindow() { std::cout << "Mm! " << handle << std::endl; }
};
struct LogWindow: virtual public Window, public SnappableWindow, public MinimizableWindow {
    LogWindow() { std::cout << "Log! " << handle << std::endl; }
};
int main() {
    LogWindow lw;
    std::cout << "lw: " << lw.handle << std::endl;
} 
```

输出：

```
Snap! 1
Mm! 1
Log! 1
lw: 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T01:33:59.900

您可以为此使用特征，但不幸的是它们无法访问受保护的成员。如果您创建一个公开受保护成员的中间类，则可以这样做。看看是否有意义：

```
struct Window {
protected:
    int handle;
};
struct BaseWindow : public Window {
    int get_handle() { return handle; }
};
template <class TWindow>
struct Snappable {
    Snappable() { std::cout << "Snappable " << self()->get_handle() << std::endl; }
private:
    TWindow *const self() {
        return static_cast<TWindow*>(this);
    }
};
template <class TWindow>
struct Minimizable {
    Minimizable() { std::cout << "Minimizable " << self()->get_handle() << std::endl; }
private:
    TWindow *const self() {
        return static_cast<TWindow*>(this);
    }
};
struct LogWindow: public BaseWindow, public Snappable<LogWindow>, public Minimizable<LogWindow> {
}; 
```

[在这里](http://www.artima.com/articles/dci_vision.html)寻找一种使用特征的有趣的建筑风格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:50:34.207

这实际上有点令人困惑......如果句柄被初始化为构造函数的一部分，那么它在构造函数完成后在初始化列表中`Window`可用：`Window`

```
class Window {
protected:
   int handle;
   Window() { handle = 5; }
};
struct Snappable {
   int hdl;
   Snappable( int handle ) : handle(handle) {}
};
struct MyWindow : Window, Snappable {       // Order matters here!
   MyWindow() : Window(), Snappable( handle ) {}
};
int main() {
   MyWindow w;
   std::cout << w.hdl << std::endl;         // 5
} 
```

重要的是要注意基本构造函数的执行顺序是类定义中声明的顺序，而不是初始化列表中的顺序。

话虽如此，这是否是一个好的设计是一个不同的问题。

# type-conversion - OpenCL 将 uint4 转换为 unsigned int

> ID：11478789
> 
> 赞同：0
> 
> 时间：2012-07-13T21:43:39.793
> 
> 标签：type-conversion, opencl

如何将 uint4 类型转换为 unsigned int ？我正在使用 readimageui() 读取内核中的图像。这将返回 uint4 类型。

在主机代码中，当将结果读回目标缓冲区时，我尝试使用类型为 cl_uint4 的缓冲区，但没有成功。

# .net - 如何不需要特定版本的程序集

> ID：11478791
> 
> 赞同：4
> 
> 时间：2012-07-13T21:43:45.240
> 
> 标签：.net, version, .net-assembly

我有一个正在处理的项目，它引用了一个引用程序集的程序集，如下所示：

```
Me
 |- A
 |  |- B v1.4.2
 |
 |- B v1.5 
```

A 不需要`1.4.2`特别引用，只要大于`1.4`或等于。在`A`的引用属性中，B 说“特定版本 = False”，但是当我使用 运行`Me`时`B v1.5`，我会`FileLoadException`寻找`B v1.4.2`. 但是，`B v1.5`目前，我如何让 CLR 关心的更少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:56:57.257

尽管绑定重定向是这里的方法，但有时这是不可能的 - 即如果您在另一个 EXE 中加载插件。我们采用的一个实际解决方案是挂钩`AppDomain.CurrentDomain.AssemblyResolve`事件，监听到 myassembly1.4.2.dll 的失败绑定（例如），然后显式返回调用返回的程序集`System.Reflection.Assembly.LoadFrom("c:\assemblies\myassembly.1.5.0.dll")`。绑定重定向更好，但有时并不实用。

# javascript - 使用 Apps 脚本向 Google 文档添加元素

> ID：11478793
> 
> 赞同：2
> 
> 时间：2012-07-13T21:43:56.127
> 
> 标签：javascript, html, google-apps-script, google-docs

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T22:15:00.670

使用段落类的工作解决方案，

```
var par1a = doc.appendParagraph("Please ");
var link = doc.appendParagraph("Contact me ").setLinkUrl("mailto:me@me.com");
link.merge();
var par1b = doc.appendParagraph("if you have any questions.");
par1b.merge(); 
```

# java - 如何从java中的字符串创建键/值映射（更复杂）

> ID：11478797
> 
> 赞同：0
> 
> 时间：2012-07-13T21:44:11.837
> 
> 标签：java, regex, string-matching

我有一个像

`"SimpleKey1: word1\. SimpleKey2Word1 SimpleKey2Word2: word word word, word word. word word. CompoundKey3 / CompoundKey3: word word word, word. Key3: word. CompoundKey4Word1 CompoundKey4Word2 / CompoundKey4Word3 CompoundKey4Word4: word words, words word-word (word 18 word 100 ). CompoundKey5 / CompoundKey5: word word."`

我需要解析该字符串以获得键/值映射，例如：

```
SimpleKey1: word1\. 
SimpleKey2Word1 SimpleKey2Word2: word word word, word word. word word. 
CompoundKey3 / CompoundKey3: word word word, word. 
CompoundKey4Word1 CompoundKey4Word2 / CompoundKey4Word3 CompoundKey4Word4: word words,    words word-word (word 18 word 100 ).  
CompoundKey5 / CompoundKey5: word word. 
```

请注意，键可以包含斜杠字符 (/)，值可以包含特殊字符。

我不知道应该使用什么正则表达式。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:54:33.020

```
String data = "SimpleKey1: word1\. SimpleKey2Word1 SimpleKey2Word2: word "
            + "word word, word word. word word. CompoundKey3 / CompoundKey3: "
            + "word word word, word. Key3: word. CompoundKey4Word1 "
            + "CompoundKey4Word2 / CompoundKey4Word3 CompoundKey4Word4: word "
            + "words, words word-word (word 18 word 100 ). CompoundKey5 / "
            + "CompoundKey5: word word.";
Pattern p=Pattern.compile("([\\w\\s/]+):(.*?)(?=$|([\\w\\s/]+):)");
Matcher m=p.matcher(data);
while(m.find())
    System.out.println(m.group().trim()); 
```

输出：

```
SimpleKey1: word1.
SimpleKey2Word1 SimpleKey2Word2: word word word, word word. word word.
CompoundKey3 / CompoundKey3: word word word, word.
Key3: word.
CompoundKey4Word1 CompoundKey4Word2 / CompoundKey4Word3 CompoundKey4Word4: word words, words word-word (word 18 word 100 ).
CompoundKey5 / CompoundKey5: word word. 
```

如果你想获得密钥使用`m.group(1)`。为了价值，您可以`m.group(2)`使用

```
while(m.find()){
    System.out.println("key=>"+m.group(1));
    System.out.println("value=>"+m.group(2));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:50:34.320

试试这个正则表达式`(.+?)(?=\.\s*(([A-Z])|($)))`

# python - Django：表示经过时间的最佳字段类型是什么？

> ID：11478798
> 
> 赞同：1
> 
> 时间：2012-07-13T21:44:21.897
> 
> 标签：python, django, datetime

我需要节省用户完成某些任务所花费的时间。

例如，假设您必须回答几个考试问题。如果您从上午 10:00 开始并在上午 11:00 完成，我想存储您完成它所花费的时间。在这种情况下，它将是 1 小时或 60 分钟，或 3600 秒。

在那之后，我想以一种漂亮的方式展示它。假设某件事花费了 527 秒，我想显示：8'47。所以我需要一些模板标签来完成这项工作。

我当然见过`TimeField`，但它使用的是 datetime.time，我认为它不适合这种情况。

我还仅使用`IntegerField`存储秒数进行了分析（该详细程度还可以）。但也许你们知道更好的选择。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:47:48.427

存储秒的完整字段可能最适合存储持续时间（然后很容易将其插入 a `timedelta`）。当然，如果您认为将来可能要存储几分之一秒，则可能要考虑将其设为浮点字段。

您也可以继承`IntegerField`或`FloatField`制作一个版本，自动将内容转换为`timedelta`自动...[或使用某人已经创建的](http://djangosnippets.org/snippets/1060/)版本。

# css - 线性渐变提前结束

> ID：11478800
> 
> 赞同：0
> 
> 时间：2012-07-13T21:44:33.833
> 
> 标签：css, webkit, linear-gradients

我有这个线性渐变，我不知道为什么它不能“工作”。

它应该以浅灰色开始并以浅灰色结束，但大约 80% 时，它全是白色，带有一条显着的白线。任何人都可以看到有什么问题吗？

我的 CSS 在这里：

```
background: white -webkit-linear-gradient(left, #efefef 0%,#f7f7f7 58%,#ffffff 100%);
background: white linear-gradient(left, #efefef 0%,#f7f7f7 58%,#ffffff 100%); 
```

谢谢

编辑：我正在使用 chrome 来测试渐变...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:49:36.743

您将默认颜色设置为白色，使用透明...

```
background: transparent -webkit-linear-gradient(left, #efefef 0%,#f7f7f7 58%,#ffffff 100%);
background: transparent linear-gradient(left, #efefef 0%,#f7f7f7 58%,#ffffff 100%); 
```

@JPuge 看看这里以简化 CSS 渐变[http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

# sql - SQLite在where子句中的前一个选择值

> ID：11478803
> 
> 赞同：2
> 
> 时间：2012-07-13T21:44:42.207
> 
> 标签：sql, excel, sqlite, odbc

序言（你可以跳过这个，这只是我的理由）

我创建了一个使用 sqlite 作为其数据库后端的应用程序，并且该模式在一般应用程序使用期间工作（和执行）非常好。

现在我正在尝试为它构建一个报告系统，并且我已经构建了一个 excel xll，它从一个未命名的 DSN 创建查询表。因此，我只能在 sql 中完成所有报告（即我不能以编程方式执行任何操作）。这对除了一个查询之外的所有内容都非常有效......

/// 跳过这里....

我的数据库包含一个特征列表，其中包含一个 id、距离和一个指示该特征是否为标记的指示符。id 不一定与距离的顺序相同（id 为 10 的要素可能有距离 100，而 id 为 11 的要素可能有距离 90）。

所以这个项目基本上看起来像：

```
Feature { int id, int distance, bool is_marker } 
```

我想做的是找到下一个和上一个特征也是标记。

/// 编辑

我的第一次尝试使用：

```
select 
*          /* I want all the data from this feature */
(select MAX(f2.distance) - f1.distance 
    from feature as f2
    where f2.is_marker && f2.distance < f1.distance) /* and the distance to the previous marker */
from feature as f2 
```

第二次尝试（这一次有效，对于 100,000 个功能来说，WAAAY 的时间太长了，大约需要 9 天......）：

```
select
*,          /* I want all the data from this feature */
(select f1.distance - MAX(f2.distance)
    from feature as f2
    where f2.distance AND f2.distance< f1.distance) /* and the distance to the previous marker */
from feature as f1 
```

这个查询确实返回了我想要的，并且对小型数据库执行得很好，但我也必须支持更大的数据库。

（有些数据库的特征少于 1000 个，但我现在正在研究的那个有 >90,000 个特征。查询 1000 个特征需要 <1s，但查询 90,000 个特征需要 20 小时。这是因为它没有线性增长导致性能下降 80 倍：20*60*60/(90,000/1000) = 8000)

后端数据库使用 sqlite，我使用 sqliteodbc 连接器连接 excel。

如果我要在代码中执行此操作，我会这样做：

```
var features = featureRepository.GetAll();
var featuresWithMarkerDistance = new List<FeatureWithMarkerDistance>();
var previousMarker = null;
for(var index = 0; index < features.Length; index++) {
    var currentFeature = features[index];
    featuresWithMarkerDistance.Add(
        new FeaturesWithMarkerDistance(currentFeature, 
            feature.distance - previousMarker.distance));
    if(feature.is_marker) {
        previousMarker = feature;
    }
}

// FeatureWithMarkerDistance { int id, int distance, bool is_marker, int marker_distance } 
```

// 编辑：

这是一个具体的例子：

```
(The underlying table)
feature_id is_marker distance
1          false     100
2          false     90
3          false     101
4          true      50
5          false     5
6          true      85
7          false     150
8          false     75 
```

（有距离指数）

我想要的结果：

```
feature_id is_marker distance distance_to_closest_previous_marker
1          false     100      15
2          false     90       5
3          false     101      16
4          true      50       null
5          false     5        null
6          true      85       35
7          false     150      65
8          false     75       25 
```

因此，如果我要获取 feature_id 1 的前一个标记，则 feature_id 1 的距离是 100，最近的标记是距离 85 处的 feature_id 6。要获得到最近的前一个标记的距离，我取 (100 - 85) = 15。我需要为要包含在报告中的每个功能获取此值。（这必须在单个 sql 查询中完成，因为我正在使用带有 excel 的 odbc 连接器）。上面的查询确实获取了我想要的内容，但它的性能非常糟糕，因为在 where 子句中它必须在整个数据库中搜索每个功能。

我想做的是：（除非有更高效的方式）

```
 select *          
    /* I want all the data from this feature */ 
    /* previous  = */ (select MAX(f2.distance) - f1.distance 
        from feature as f2
        where f2.is_marker && f2.distance >= previous && f2.distance < f1.distance) 
    /* and the distance to the previous marker */
    from feature as f2 
```

所以基本理论是我会存储前一个标记值，并且在我寻找下一个标记时只查看该值及之后的值。

对最初的混乱感到抱歉（我忘了把 MAX() 放在原来的位置）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:41:22.970

不知道 SQLite，但做这样的事情（我查了语法，发现 LEFT JOIN 和 EXISTS，但不是 NOT EXISTS）？

```
select f2.*, f2.distance - f1.distance
from feature f2
left join feature f1 on f1.is_marker
                    and f2.distance > f1.distance
                    and not exists(select 1 from feature f1b
                                   where f1b.is_marker
                                     and f2.distance > f1b.distance
                                     and f1.distance < f1b.distance)
where f2.is_marker 
```

我对性能一无所知，但希望 (is_marker, distance) 上的索引可能是有利的（您必须测试在索引中包含 is_marker 是否有用，除此之外取决于 SQLite，它可能还取决于具有 is_marker = true 的列的百分比）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T23:35:33.207

这些例子真的很有帮助。干得好。

```
SELECT F2.feature_id, F2.is_marker, F2.distance, 
       F2.distance - (SELECT F1.distance FROM features F1
                      WHERE F1.is_marker<>0 
                        AND F1.distance<F2.distance
                      ORDER BY F1.distance DESC
                      LIMIT 1) AS "distance_to_closest_previous_marker"
FROM features F2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-03T14:07:02.000

我使用了 SQLite3 shell，并尝试了您的查询

```
SELECT *, 
       (SELECT MIN(feature.distance-distance) FROM feature AS f
               WHERE is_marker AND distance<feature.distance) 
       FROM feature; 
```

它在 5000 条记录中表现相当不错。也许你的弱点是 sqliteobdc？如果它确实仍然很慢，并且假设您几乎没有真正的 is_marker，您可以创建一个表，其中距离 is_marker 为真的特征只有距离：

```
CREATE TEMP TABLE markers_distance (distance);
CREATE UNIQUE INDEX markers_idx ON markers_distance (distance);
INSERT OR IGNORE INTO markers_distance 
       SELECT distance FROM feature WHERE is_marker; 
```

现在您对 markers_distance 的查询应该更快：

```
SELECT *, 
       (SELECT MIN(feature.distance-distance) FROM markers_distance
               WHERE distance<feature.distance) 
       FROM feature; 
```

# android - 设置图像视图绝对位置

> ID：11478805
> 
> 赞同：0
> 
> 时间：2012-07-13T21:45:03.803
> 
> 标签：android, facebook, android-layout, android-intent

我正在尝试在我的应用程序中手动设置图像视图位置，代码当前正在运行，但所有 facebook 图像都显示在右上角并且彼此重叠。

我无权访问任何适配器，这是在 Facebook SDK 中，任何人都可以发现以下代码的任何问题：

我的 XML：

显示照片.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/DisplayPhotosLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
</RelativeLayout> 
```

这是由以下设置的：

```
fbManager = new FBLoginManager(this, R.layout.displayphotos, "-------", permissions); 
```

然后我使用以下内容显示图像（工作但都在同一位置）

```
int Row = 0;
    int RowCount = 0;
    int imageWidth = (int)getWindowManager().getDefaultDisplay().getWidth() / 3;

    for(int _i = 0; _i < _noOfPhotos; _i++)
    {
        ImageView imageView = new ImageView(getApplicationContext());
        imageView.setImageResource(R.drawable.no_image);

        RelativeLayout.LayoutParams rl = new RelativeLayout.LayoutParams(imageWidth, imageWidth);
        rl.setMargins(imageWidth * _i, imageWidth * Row, 0,0);

        RowCount = RowCount + 1;

        if(RowCount == 3){Row = Row + 1;RowCount = 0;}

        UrlImageViewHelper.setUrlDrawable(imageView, _userGallery.get(_i).getPicture());

        addContentView(imageView, rl);

        System.out.println(imageWidth * _i + " top: " + imageWidth * Row);

        _imageViewArray.add(imageView);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T02:49:25.567

我认为你需要一个表格布局，[http://developer.android.com/guide/topics/ui/layout/grid.html](http://developer.android.com/guide/topics/ui/layout/grid.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T18:37:55.563

我找到了一个技巧，可以将图像视图放置在相对布局内的绝对位置 xy 处。以下代码将 imageview 的 CENTER 放置在 x,y 处，甚至在相对布局边界之外。

```
 /*
     * relativelayout allow out-of-boudaries only along the alignment side.
     * if aligned to left then you can have a negative x and overlap the
     * left side, if aligned to right you can overlap the right
     * 
     * let's put the image CENTERED on x,y
     * 
     * If we are on the left side of the container 
     *      |  (x<dx/2) |<---imgDx-->|
     *      |           |____________|
     *      |
     *      |      x 
     *      |<---------------->                  |
     *      |<----------> x-imgDx/2              |
     *      |____________________________________|
     * 
     * if we goes past the half of the container
     *                        <---imgDx-->       |
     *      |                |____________|      |
     *      |           x                        |
     *      |<--------------------->             |
     *      |                             <----->| dx-(x+imgDx/2) 
     *      |____________________________________|
     */
    public void setBitmapPosition(ImageView iv, int x, int y) {
        String log = "";
        RelativeLayout rl = (RelativeLayout) iv.getParent();

        // get bitmap size
        int imgDx = iv.getLayoutParams().width;
        int imgDy = iv.getLayoutParams().height;
        // get container size
        int dx = rl.getWidth();
        int dy = rl.getHeight();

        log = log + " XY:" + new Integer(x).toString() + ","
                + new Integer(y).toString();

        RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(
                imgDx, imgDy);
        iv.setLayoutParams(lp);

        log = log + " imgXY:" + new Integer(imgDx).toString() + ","
                + new Integer(imgDy).toString();

        log = log + " winXY:" + new Integer(dx).toString() + ","
                + new Integer(dy).toString();

        if (x <= (dx / 2)) {
            // i'm on the left side of the view so let's align to left
            lp.addRule(RelativeLayout.ALIGN_PARENT_LEFT,
                    RelativeLayout.TRUE);
            lp.leftMargin = x - imgDx / 2;
            log = log + " LEFT:" + new Integer(lp.leftMargin).toString();
        } else {
            // align to right. we are past the middle
            lp.addRule(RelativeLayout.ALIGN_PARENT_RIGHT,
                    RelativeLayout.TRUE);
            lp.rightMargin = dx - (x + imgDx / 2);
            log = log + " RIGHT:" + new Integer(lp.rightMargin).toString();
        }

        if (y <= (dy / 2)) {
            // align to top
            lp.addRule(RelativeLayout.ALIGN_PARENT_TOP, RelativeLayout.TRUE);
            lp.topMargin = y - imgDy / 2;
            log = log + " TOP:" + new Integer(lp.topMargin).toString();

        } else {
            // align to bottom
            lp.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM,
                    RelativeLayout.TRUE);
            lp.bottomMargin = dy - (y + imgDy / 2);
            log = log + " BOTTOM:"
                    + new Integer(lp.bottomMargin).toString();
        }

        iv.setLayoutParams(lp);

        Log.i("PARAM", log);
    } 
```

# jsp - request.getParameter 防止 XSS：最佳实践是什么？

> ID：11478813
> 
> 赞同：4
> 
> 时间：2012-07-13T21:46:31.057
> 
> 标签：jsp, tomcat, xss

我继承了一个包含 1000 多个 JSP 文件的大型代码库，其中充满了 XSS 漏洞。

代码充满

```
<%= request.getParameter("theparam")%> 
```

和

```
out.println("some stuff before"+request.getParameter("theparam")+"and some other stuff"); 
```

和

```
String myVar = request.getParameter("theparam");
out.println(myVar); 
```

我想保护所有文件，而不必单独检查所有文件。

我最好的方法是什么？

*   对所有源文件执行“request.getParameter("xx")" 到 "StringEscapeUtils.escapeHtml(request.getParameter("xx")) 的“全部替换”？

*   我可以以某种方式覆盖函数'request.getParameter'，因此它默认为 stringescapeutils.escapehtml(request.getParameter("")); ?

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:50:33.750

我并不是说这是最好的方法，而是：

> 我可以以某种方式覆盖函数'request.getParameter'，因此它默认为 stringescapeutils.escapehtml(request.getParameter("")); ?

使用 servlet 过滤器和包装 HTTP servlet 请求很容易实现。[如何向 HttpServletRequest 添加验证逻辑中](https://www.owasp.org/index.php/How_to_add_validation_logic_to_HttpServletRequest)描述了这种方法。

然而，最全面的方法是在显示时转义，最好只在 JSP 中。太糟糕了，您还在 servlet 中生成 HTML。请参阅：[Java 5 HTML 转义以防止 XSS](https://stackoverflow.com/questions/2333586)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-22T10:49:59.303

您可以执行以下操作

```
<%@ page import="org.apache.commons.lang.StringEscapeUtils" %>
String str=request.getParameter("urlParam");
String safeOuput = StringEscapeUtils.escapeXml(str); 
```

希望这可以帮助您解决问题...

# java - Android-Query - 随机 SSLExceptions

> ID：11478814
> 
> 赞同：4
> 
> 时间：2012-07-13T21:46:31.103
> 
> 标签：java, android, httpclient, android-query, sslexception

我正在使用 Android-Query 进行 HTTP 调用，并且不断收到随机 SSLExceptions，如下所示：

```
AQuery(7746): javax.net.ssl.SSLException: Read error: ssl=0x19d3c0: I/O error during system call, Connection reset by peer
AQuery(7746):   at org.apache.harmony.xnet.provider.jsse.NativeCrypto.SSL_read(Native Method)
AQuery(7746):   at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl$SSLInputStream.read(OpenSSLSocketImpl.java:801)
AQuery(7746):   at org.apache.http.impl.io.AbstractSessionInputBuffer.fillBuffer(AbstractSessionInputBuffer.java:103)
AQuery(7746):   at org.apache.http.impl.io.AbstractSessionInputBuffer.readLine(AbstractSessionInputBuffer.java:191)
AQuery(7746):   at org.apache.http.impl.conn.DefaultResponseParser.parseHead(DefaultResponseParser.java:82)
AQuery(7746):   at org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:174)
AQuery(7746):   at org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:180)
AQuery(7746):   at org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:235)
AQuery(7746):   at org.apache.http.impl.conn.AbstractClientConnAdapter.receiveResponseHeader(AbstractClientConnAdapter.java:259)
AQuery(7746):   at org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:279)
AQuery(7746):   at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:121)
AQuery(7746):   at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:428)
AQuery(7746):   at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
AQuery(7746):   at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
AQuery(7746):   at com.androidquery.callback.AbstractAjaxCallback.httpDo(AbstractAjaxCallback.java:1328)
AQuery(7746):   at com.androidquery.callback.AbstractAjaxCallback.httpGet(AbstractAjaxCallback.java:1207)
AQuery(7746):   at com.androidquery.callback.AbstractAjaxCallback.network(AbstractAjaxCallback.java:1133)
AQuery(7746):   at com.androidquery.callback.AbstractAjaxCallback.networkWork(AbstractAjaxCallback.java:986)
AQuery(7746):   at com.androidquery.callback.AbstractAjaxCallback.backgroundWork(AbstractAjaxCallback.java:933)
AQuery(7746):   at com.androidquery.callback.AbstractAjaxCallback.run(AbstractAjaxCallback.java:894)
AQuery(7746):   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1081)
AQuery(7746):   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:574)
AQuery(7746):   at java.lang.Thread.run(Thread.java:1020) 
```

它们的出现似乎没有韵律或原因。它们发生在我打电话的时间的 1/6 中。

这是我使用 Android-Query ( `$`) 的方式：

// 应用程序创建：

```
public void onCreate()
{
  AQUtility.setExceptionHandler( new UncaughtExceptionHandler() {
    public void uncaughtException( Thread thread, Throwable ex )
    {
      ex.printStackTrace();
    }
  } );

  AQUtility.setDebug( true );

  AjaxCallback.setTransformer( new JsonTransformer() );

  //set the max number of concurrent network connections, default is 4
  AjaxCallback.setNetworkLimit( 8 );

  //set the max number of icons (image width <= 50) to be cached in memory, default is 20
  BitmapAjaxCallback.setIconCacheLimit( 20 );

  //set the max number of images (image width > 50) to be cached in memory, default is 20
  BitmapAjaxCallback.setCacheLimit( 40 );

  //set the max size of an image to be cached in memory, default is 1600 pixels (ie. 400x400)
  BitmapAjaxCallback.setPixelLimit( 480 * 480 );

  //set the max size of the memory cache, default is 1M pixels (4MB) (2---)
  BitmapAjaxCallback.setMaxPixelLimit( 4000000 );

  super.onCreate();
} 
```

// 用法 // 注意：uri = // 07-13 17:26:08.040: W/AQuery(7746): 获取: [https://site.com/me/ticker/](https://site.com/me/ticker/)

```
$.auth( Security.getAuth( this ) ).ajax( uri, BaseModelListRequest.class, this, "loadAdapterObjectsCallback" );

public void loadAdapterObjectsCallback( String uri, BaseModelListRequest requestData, AjaxStatus status )
{
  setProgressBarIndeterminateVisibility( false );
  setSupportProgressBarIndeterminateVisibility( false );

  if( requestData != null && status.getCode() == 200 )
  {
     // stuff 
  }
} 
```

// 这里是 GETAUTH：

```
public static synchronized BasicHandle getAuth( Context context )
{
  return new BasicHandle( "user", "pass" );
} 
```

// 和 JSONTRANSFORMER（使用 jaxson 来编组 json）：

```
public class JsonTransformer implements Transformer
{
  public < T > T transform( String url, Class< T > type, String encoding, byte[] data, AjaxStatus status )
  {
    ObjectMapper mapper = new ObjectMapper();

    try
    {
      return mapper.readValue( new String( data ), type );
    }
    catch( Exception e )
    {
      return null;
    }
  }
} 
```

**编辑：**这发生在 2.X 和 3.X 上，使用 SSL。禁用 SSL (https -> http) 使其工作。

这是 SSL 的另一个例外：

```
07-13 22:03:41.454: W/AQuery(2517): javax.net.ssl.SSLException: Not trusted server certificate
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.startHandshake(OpenSSLSocketImpl.java:360)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.http.conn.ssl.AbstractVerifier.verify(AbstractVerifier.java:92)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(SSLSocketFactory.java:321)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:140)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:348)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
07-13 22:03:41.454: W/AQuery(2517):     at com.androidquery.callback.AbstractAjaxCallback.httpDo(AbstractAjaxCallback.java:1328)
07-13 22:03:41.454: W/AQuery(2517):     at com.androidquery.callback.AbstractAjaxCallback.httpGet(AbstractAjaxCallback.java:1207)
07-13 22:03:41.454: W/AQuery(2517):     at com.androidquery.callback.AbstractAjaxCallback.network(AbstractAjaxCallback.java:1133)
07-13 22:03:41.454: W/AQuery(2517):     at com.androidquery.callback.AbstractAjaxCallback.networkWork(AbstractAjaxCallback.java:986)
07-13 22:03:41.454: W/AQuery(2517):     at com.androidquery.callback.AbstractAjaxCallback.backgroundWork(AbstractAjaxCallback.java:933)
07-13 22:03:41.454: W/AQuery(2517):     at com.androidquery.callback.AbstractAjaxCallback.run(AbstractAjaxCallback.java:894)
07-13 22:03:41.454: W/AQuery(2517):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
07-13 22:03:41.454: W/AQuery(2517):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
07-13 22:03:41.454: W/AQuery(2517):     at java.lang.Thread.run(Thread.java:1096)
07-13 22:03:41.454: W/AQuery(2517): Caused by: java.security.cert.CertificateException: java.security.cert.CertPathValidatorException: TrustAnchor for CertPath not found.
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.harmony.xnet.provider.jsse.TrustManagerImpl.checkServerTrusted(TrustManagerImpl.java:168)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.startHandshake(OpenSSLSocketImpl.java:355)
07-13 22:03:41.454: W/AQuery(2517):     ... 17 more
07-13 22:03:41.454: W/AQuery(2517): Caused by: java.security.cert.CertPathValidatorException: TrustAnchor for CertPath not found.
07-13 22:03:41.454: W/AQuery(2517):     at org.bouncycastle.jce.provider.PKIXCertPathValidatorSpi.engineValidate(PKIXCertPathValidatorSpi.java:149)
07-13 22:03:41.454: W/AQuery(2517):     at java.security.cert.CertPathValidator.validate(CertPathValidator.java:211)
07-13 22:03:41.454: W/AQuery(2517):     at org.apache.harmony.xnet.provider.jsse.TrustManagerImpl.checkServerTrusted(TrustManagerImpl.java:164)
07-13 22:03:41.454: W/AQuery(2517):     ... 18 more 
```

**编辑2：**

进一步检查发现错误发生在 Android 2.3.x 设备上。删除协议（即 SSL）中的“s”使一切正常。

我以前在 RestTemplate (Spring-Android) 上遇到过这个问题，并按照这篇文章的建议进行了修复：[Android 上的自签名 SSL 接受](https://stackoverflow.com/questions/1217141/self-signed-ssl-acceptance-android)

但是，我以相同的方式将源代码修改为 Android-Query，但并没有解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:05:26.983

[这个问题已经在这里](https://stackoverflow.com/questions/11021551/intermittent-connection-reset-by-peer-errors-in-android-connecting-to-net-rest)和[这里](https://stackoverflow.com/questions/8472556/android-https-exception-connection-reset-by-peer)问过几次了。此异常似乎是服务器重置连接的结果。我认为除了优雅地处理异常并继续前进之外，您在应用程序代码中无能为力。如果服务器在您的控制之下，则值得检查日志和配置以查看导致连接重置的原因。您也许可以在那里最小化或解决问题。

# collections - 将数组数组转换为模型的主干集合

> ID：11478815
> 
> 赞同：2
> 
> 时间：2012-07-13T21:46:35.183
> 
> 标签：collections, backbone.js, coffeescript, models

新的 Backbone 和下划线 js 在这里。

我有一个要转换为模型集合的数组数组。

所以就像

```
{ {1, 2, 3, 4}, {5, 6, 7, 8}} 
```

第二级数组是主干模型的内容。现在，我有

```
collection.reset(_.map(results, (indvidualResults) -> new model(individualResults)) 
```

当我执行 console.log(collection.pop) 时，这不起作用，我打印出一个函数。我认为这是因为我正在使用一组数组（但我可能是错的）。如何将第二个数组转换为模型，然后将其放入集合中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-14T01:30:48.133

Reshape your raw data to look more like:

```
[{ first: 1, second: 2, third: 3, fourth: 4 }, { first: 5, second: 6, third: 7, fourth: 8}] 
```

Assuming you have a model and collection defined something like:

```
var Model = Backbone.Model.extend({});
var Collection = Backbone.Collection.extend({
    model: Model
}); 
```

Then just pass the array of attribute hashes into the reset method:

```
var results = [{ first: 1, second: 2, third: 3, fourth: 4 }, { first: 5, second: 6, third: 7, fourth: 8}];
var collection = new Collection();
collection.reset(results);
var model = collection.pop();
console.log(JSON.stringify(model.toJSON()); 
```

# java - JSP form:checkbox 变成 ac:foreach

> ID：11478816
> 
> 赞同：2
> 
> 时间：2012-07-13T21:46:47.330
> 
> 标签：java, spring, jsp, jakarta-ee, taglib

这个论坛的很多帖子都提到了类似的问题；但是没有人有特定的解决方案，我感谢您在这方面帮助我：

我正在使用 spring 开发一个 web 应用程序，我不知道我应该在 c:foreach 内部的 form:checkbox 标记的路径中放什么，这是我的代码：

```
<c:forEach items="${persons}" var="person" varStatus="i">
    <tr>
        <td><c:out value="${person.firstName}" /></td>
        <td><c:out value="${person.lastName}" /></td> 
        <td><form:checkbox path="person.rights" value="Download"/>Download </td>
        <td><form:checkbox path="person.rights" value="Delete"/>Delete </td>
    </tr>
</c:forEach> 
```

' `rights`' 是在 spring 文档中定义的字符串列表，它像其他属性一样具有 getter 和 setter，我的复选框在`c:foreach`标签之外工作，但是当将它们包含到此标签中时会生成此异常：

```
org.springframework.beans.NotReadablePropertyException: Invalid property 'person' of bean class [java.util.ArrayList]: Bean property 'person' is not readable or has an invalid getter method: Does the return type of the getter match the parameter type of the setter? 
```

你知道问题是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T19:54:11.317

这个问题在大多数地方都奇怪地没有记录。这是我在下面发布的链接的摘录。要点是我们需要一个静态占位符，它映射到类型而不是 bean 的值。所以 ${} 里面的任何东西都行不通。为此，在使用`<c:forEach>`带有 s[ring 形式 tld 的 JSTL 循环运算符的特定情况下，我们应该使用运算符的`varStatus`属性在每次迭代中引用类型信息`<c:forEach>`，就像数组的索引一样，因此引用可迭代集合的内部属性使用`.`可通过支持表单的最外层 bean 访问的集合变量。

例如：

```
<c:forEach items="${teamslist_session.teams}" var="team" varStatus="teamsLoop">
<form:input path="teams[${teamsLoop.index}].name"/>
</c:forEach> 
```

在哪里：

*   `teamList_session`是支持表单的 bean
*   `teams`是bean的集合，我们需要在属性中设置其`path`属性
*   `var`是对`teams`集合中每个成员的引用
*   `teamsLoop`是迭代索引，它在下面的行中用于引用say，`i`th元素的bean的属性称为`name`

更多信息请参考以下链接： [论坛讨论 - 见上一篇文章](http://forum.springsource.org/archive/index.php/t-85869.html) [链接1中提供的链接供参考](http://blog.vergiss-blackjack.de/2010/04/iterating-over-nested-objects-in-a-spring-form/)

# android - Wakeful IntentService 在睡眠模式下的通知工作不完整

> ID：11478824
> 
> 赞同：1
> 
> 时间：2012-07-13T21:47:50.250
> 
> 标签：android, notifications, commonsware-cwac

我已经为测试模式设置了 1 分钟的 AlarmManager。它向 OnAlarmReceiver 发送广播。OnAlarmReceiver 启动 sendWakefulWork(context, TaskService); 在 doWakefulWork() 方法中的 TaskService 中，我发送了触发通知的OrderedBroadcast。这很好用^出现带有声音和振动的通知。但仅当手机处于活动模式时。当手机处于睡眠模式（屏幕关闭）时，通知期间只有振动和闪光工作。睡眠模式下没有通知声音，只有振动。有时它会发出声音，但只是有时会发出声音，例如每小时发出 1 次声音，但它应该每分钟发出声音。此外，当手机连接到计算机时，它在睡眠模式下每分钟都会发出声音，但是当我从计算机上拔下手机时，它只会开始振动。当我打开屏幕时，一切都变得正常：通知播放声音+振动。

所以我不知道我的代码或手机是否有问题（HTC Desire Android 2.2）

我已经尝试了很多方法来修复它：

*   默认和自定义声音
*   notification.audioStreamType = AudioManager.STREAM_SYSTEM 等
*   带闪光灯和不带闪光灯
*   有振动和无振动

没有。只有声音在睡眠模式下消失，振动完美。

```
public class OnBootReceiver extends BroadcastReceiver {

public static void setAlarm(Context ctxt) {

           AlarmManager mgr = (AlarmManager) ctxt.getSystemService(Context.ALARM_SERVICE);
   mgr.setRepeating(AlarmManager.RTC_WAKEUP,
           System.currentTimeMillis()+1000,
           1*60*1000,
           getPendingIntent(ctxt));
}

public static void cancelAlarm(Context ctxt) {
   AlarmManager mgr = (AlarmManager) ctxt.getSystemService(Context.ALARM_SERVICE);
   mgr.cancel(getPendingIntent(ctxt));
}

private static PendingIntent getPendingIntent(Context ctxt) {
   Intent i=new Intent(ctxt, OnAlarmReceiver.class);
   return PendingIntent.getBroadcast(ctxt, 0, i, PendingIntent.FLAG_CANCEL_CURRENT);
}

@Override
public void onReceive(Context ctxt, Intent intent) {
   setAlarm(ctxt);
}
} 
```

我在 TaskService 类中的 doWakefulWork 方法：

```
protected void doWakefulWork(Intent intent) {
Intent mIntent = new Intent(EXERCISE_EVENT);
   mIntent.putExtra(StringUtils.PARAM_NEXT_TASK_TIME, nextStringTime);
   mIntent.putExtra(StringUtils.PARAM_TASK_NUMBER, taskNumber);

   sendOrderedBroadcast(mIntent, null);
} 
```

这是我的 NotificationBrodcastReceiver ：

```
public class NotificationBrodcastReceiver extends android.content.BroadcastReceiver {

public void onReceive(Context ctx, Intent intent) {

           String ns = Context.NOTIFICATION_SERVICE;
           NotificationManager mNotificationManager = (NotificationManager) ctx.getSystemService(ns);

           int icon = R.drawable.notif_icon;
           CharSequence tickerText = ctx.getResources().getString(R.string.notification_ticker);
           long when = System.currentTimeMillis();

           Notification notification = new Notification(icon, tickerText, when);
           notification.flags |= Notification.FLAG_AUTO_CANCEL;

           notification.defaults |= Notification.DEFAULT_SOUND;
           notification.defaults |= Notification.DEFAULT_VIBRATE;

           Intent notificationIntent = new Intent(ctx, MainActivity.class);
           PendingIntent contentIntent = PendingIntent.getActivity(ctx, 0, notificationIntent, 0);
           notification.setLatestEventInfo(ctx, "contentTitle", "contentText", contentIntent);
           mNotificationManager.notify(NOTIFICATION_ID, notification);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T10:13:18.520

您正在使用有序广播来提高您的`Notification`. 据推测，您这样做是因为如果活动在前台并且`BroadcastReceiver`对此广播具有更高的优先级，您希望活动来处理请求。

这种模式适用于非清醒情况。然而，一旦`doWakefulWork()`结束，没有什么可以让设备保持清醒，因此设备会重新进入睡眠状态。您的命令`Broadcast`是异步发生的，因此它的工作将在`doWakefulWork()`结束后发生，因此您`Notification`可能根本不会发生。如果`Notification`部分发生，正如您所描述的，我个人认为这种行为是 Android 中的一个错误（它应该拥有自己的`WakeLock`用于播放铃声的目的），但完全有可能您`BroadcastReceiver`根本无法控制完全没有，因为设备在广播发送之前就睡着了。

保持`WakeLock`两秒钟的解决方法会增加成功的几率，但这也不能保证。确保您有机会筹集到的唯一有保证的方法`Notification`是：

1.  在`doWakefulWork()`, 或

2.  保持 a`WakeLock`直到广播完成并`Notification`引发。

我会考虑`WakefulIntentService`在未来为框架添加额外的特性来更好地处理你的场景，因为你想要做的似乎是合理的，并且有一个通用的模式实现会很好。但是，您正在尝试做的事情绝对超出了当前所做的事情的范围`WakefulIntentService`。

# iphone - iOS - 将 UILabel 从界面构建器连接到代码

> ID：11478825
> 
> 赞同：0
> 
> 时间：2012-07-13T21:48:10.410
> 
> 标签：iphone, ios

我想在 UILabel 上设置一个自定义字体，我已经想出了如何做到这一点。我的问题是如何访问通过代码中的拖放界面构建器创建的 UILabel？

我试过 ctrl + 单击 UILabel 并将其拖到文件的所有者，但它不会让我。我还尝试打开助手编辑器并将 UILabel 直接连接到相应的 .h 文件，但这也不起作用。如何以编程方式访问 UILabel？我知道这应该很容易。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:56:25.513

```
// YourController.h

@interface YourController : UIViewController
@property (weak, nonatomic) IBOutlet UILabel *theLabel; 
@end

// YourController.m

@implementation
@synthesize theLabel; 
///....
@end 
```

现在使用`IBOutlet`代码中的标记，您应该能够**从文件所有者拖动到**IB 中的标签（而不是相反）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:53:25.683

假设您将 UILabel 添加到 .xib 文件中。ctrl 单击 UILabel 并将其拖到您的 .h 文件中。您必须输入某些信息，包括标签的名称。使用您从 .m 文件中输入的标签名称来访问它。

通过 ctrl+click 并将 UILabel 从 .xib 拖动到 .h，您基本上会将 UILabel 添加为属性。它会自动在 .m 文件中添加它的实现，所以你会很高兴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:54:54.317

如果你想在任何时候修改 UILabel，你需要在 .h 文件和你打算修改它的 .m 文件中声明它。

当你声明它应该大致像：

```
@interface MyObject { 

UILabel *_testLabel;

}

@property (nonatomic, strong) IBOutlet UILabel *testLabel 
```

那你当然会做，

```
@synthesize testObeject = _testLabel; 
```

在您的 .m 文件中。完成此操作后，您可以按照之前尝试的方式将实际变量链接到 .xib 文件中的物理标签。

# asp.net-mvc - 在 ASP.NET MVC 中清除会话

> ID：11478826
> 
> 赞同：0
> 
> 时间：2012-07-13T21:48:17.307
> 
> 标签：asp.net-mvc, filter, onactionexecuting

Session_Start 调用和 ActionFilterAttribute 中的 OnActionExecuting 之间的 Session 会发生什么。

出于某种原因，当我设置这样的东西时：

```
protected void Session_Start(object sender, EventArgs e)
{
    Session["GoToBuyPage"] = true;
} 
```

并尝试在 ActionFilterAttribute 中访问它：

```
public override void OnActionExecuting(ActionExecutingContext filterContext)
{
    bool goToPage = (bool)Session["GoToBuyPage"]; 
```

它始终为空。任何想法为什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-14T09:46:13.567

没有`Session`属性`ActionFilterAttribute`。所以我什至不知道你的代码是如何编译的。以下对我来说非常好：

动作过滤器：

```
public class FooAttribute: ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        bool goToPage = (bool)filterContext.HttpContext.Session["GoToBuyPage"];
        filterContext.Result = new ContentResult
        {
            Content = goToPage.ToString()
        };
    }
} 
```

控制器：

```
public class HomeController : Controller
{
    [Foo]
    public ActionResult Index()
    {
        return View();
    }
} 
```

`Session_Start`：

```
protected void Session_Start(object sender, EventArgs e)
{
    Session["GoToBuyPage"] = true;
} 
```

# jquery - 与 .on() 一起使用时，防止效果在 jQuery mouseenter/leave 中运行两次

> ID：11478827
> 
> 赞同：0
> 
> 时间：2012-07-13T21:48:26.623
> 
> 标签：jquery

我有一个下拉框，可以使用以下内容：

```
$(document).on("mouseenter mouseleave", "#dropdown", function(event){

    if (event.type == 'mouseenter')
        $('#dropdown ul.children').slideDown(1000);
     else
        $('#dropdown ul.children').slideUp(1000);

    //stop();?
}); 
```

但是，如果您将鼠标移出并快速移动，那么您可以在另一个事件完成之前运行另一个事件，我如何确保当前 on 在下一次开始之前完成？

如果我使用`.stop()`，则可以将鼠标悬停并将鼠标移开和移开，它只会从头开始重新启动动画，使其看起来很生涩？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:50:37.340

试试这个：

```
$(document).on("mouseenter mouseleave", "#dropdown", function(event){

    if (event.type == 'mouseenter')
        $('#dropdown ul.children').stop(true, true).slideDown(1000);
     else
        $('#dropdown ul.children').stop(true, true).slideUp(1000);

}); 
```

[见 jQuery`.stop()`](http://api.jquery.com/stop/)

### [演示](http://jsfiddle.net/MSmFW/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:55:33.707

您需要设置一个标志类来表示下拉菜单正在动画。像这样的东西：

```
$(document).on("mouseenter mouseleave", "#dropdown", function(event){

    if (event.type == 'mouseenter')
    {
        $('#dropdown ul.children').addClass("animating");
        $('#dropdown ul.children').slideDown(1000);
        $('#dropdown ul.children').removeClass("animating");
    }
    else
    {
        if ($("#dropdown:not(.animating)")
        {
           $('#dropdown ul.children').slideUp(1000);
        }
         else
        {
           return false;
        }
    }
}); 
```

或类似的东西，具体取决于您要为滑动边缘情况建立的规则。

# ios5 - 如何在 iOS 中将白皮肤的脸变成黑皮肤的脸？

> ID：11478833
> 
> 赞同：0
> 
> 时间：2012-07-13T21:49:21.970
> 
> 标签：ios5, uiimage, uicolor, skin, argb

我需要将白皮肤的脸变成黑皮肤的脸......例如美国白脸到非洲脸（即色调）......

我通过数字色度计选择像素的颜色值，它为深色皮肤提供 RGB 值 [red=101,green=63 和 blue=43]，对于白色皮肤，它提供 RGB 值 [red=253,green= 210 和蓝色=176]...

然后我在我的代码中设置该值它给出了错误的结果......

这是我的代码...

```
 -(UIImage*)customBlackFilterOriginal
{
    CGImageRef imgSource=self.duplicateImage.image.CGImage;
    CFDataRef m_DataRef1 = CGDataProviderCopyData(CGImageGetDataProvider(imgSource)); 
    UInt8 *dataOriginal=(UInt8 *)CFDataGetBytePtr(m_DataRef1);
    double lengthSource=CFDataGetLength(m_DataRef1);
    NSLog(@"length::%f",lengthSource);
    int redPixel;
    int greenPixel;
    int bluePixel;

    for(int index=0;index<lengthSource;index+=4)
    {

        dataOriginal[index]=dataOriginal[index];
        dataOriginal[index+1]= 101;
        dataOriginal[index+2]= 63;
        dataOriginal[index+3]=43;      

    } 

    NSUInteger width =CGImageGetWidth(imgSource);
    size_t height=CGImageGetHeight(imgSource);
    size_t bitsPerComponent=CGImageGetBitsPerComponent(imgSource);
    size_t bitsPerPixel=CGImageGetBitsPerPixel(imgSource);
    size_t bytesPerRow=CGImageGetBytesPerRow(imgSource);

    NSLog(@"the w:%u H:%lu",width,height);

    CGColorSpaceRef colorspace=CGImageGetColorSpace(imgSource);
    CGBitmapInfo bitmapInfo=CGImageGetBitmapInfo(imgSource);
    CFDataRef newData=CFDataCreate(NULL,dataOriginal,lengthSource);
    CGDataProviderRef provider=CGDataProviderCreateWithCFData(newData);
    CGImageRef newImg=CGImageCreate(width,height,bitsPerComponent,bitsPerPixel,bytesPerRow,colorspace,bitmapInfo,provider,NULL,true,kCGRenderingIntentDefault);

    return [UIImage imageWithCGImage:newImg];

} 
```

请分享关于上述颜色变化的任何想法....我在代码中犯了什么错误？..

![在此处输入图像描述](../Images/494b15a79c1bd343685175d99fa4f68e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T22:37:06.090

我不是 iPhone 程序员，所以我无法测试任何东西，但你的代码中有些东西很奇怪：

**像素大小** 读取数据时，您似乎假设您有一张 32 位 ARGB 图片，您是否验证过这种情况？

**CFDataGetBytePtr** 根据文档，`Returns a read-only pointer to the bytes of a CFData object.`你确定你不是在寻找`CFDataGetBytes`哪个`Copies the byte contents of a CFData object to an external buffer.`在这种情况下你必须分配你的缓冲区来包含`width * height * bpp`。获得此副本后，您可以随意操作它来创建新图片。

**像素选择** 根据您的问题，我似乎了解您想将肤色从白色更改为黑色。您当前的代码遍历每个像素以更改其颜色。您应该评估像素颜色与您要查找的内容之间的“距离”，如果它低于某个阈值，请对其进行处理。在[HSV](http://en.wikipedia.org/wiki/HSL_and_HSV)中执行操作可能比处理 RGB 颜色更容易。

# php - Wordpress 索引的上一个帖子页面显示与索引相同的帖子

> ID：11478842
> 
> 赞同：-1
> 
> 时间：2012-07-13T21:50:12.533
> 
> 标签：php, wordpress

我的主页上的旧/新帖子链接指向第 2,3 页等...但是这些页面显示与主页完全相同的 6 个帖子。这可能是什么原因造成的？我的代码如下
来自我的 index.php

```
<?php if (function_exists('page_navi')) { // if experimental feature is active ?>

    <?php page_navi(); // use the page navi function ?>

<?php } else { // if it is disabled, display regular wp prev & next links ?>
           <nav class="wp-prev-next">
                <div class="navigation>
                    <?php next_posts_link(_e('&laquo; Older Entries', 'bonestheme')) ?>
                    <?php previous_posts_link(_e('Newer Entries &raquo;', 'bonestheme')) ?>
                </div>
           </nav>
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T23:39:17.357

我认为您不应该`_e()`在内部使用`next_posts_link`or `previous_posts_link`，[**_e()**](http://codex.wordpress.org/Function_Reference/_e)被用于`echo`翻译结果，`next_posts_link`并且`previous_posts_link`接受两个参数（可选）但`_e()`不返回任何内容，而是打印/回显。它应该是

```
<?php next_posts_link(); ?> 
```

或者

```
<?php next_posts_link('Older Entries »', 0); ?> 
```

和一样`previous_posts_link`。

**参考：** [**next_posts_link**](http://codex.wordpress.org/Function_Reference/next_posts_link)和[**previous_posts_link**](http://codex.wordpress.org/Function_Reference/previous_posts_link)和[**_e()**](http://codex.wordpress.org/Function_Reference/_e)。

# php - preg 在 PHP 中使用部分模式替换完整的单词

> ID：11478843
> 
> 赞同：0
> 
> 时间：2012-07-13T21:50:19.567
> 
> 标签：php, preg-replace

我`preg_replace($oldWords, $newWords, $string);`用来替换单词数组。

我希望替换所有以`foo`into开头的`hello`单词，以及所有以`bar`into开头的单词`world`

即`foo123`应该改成`hello`，`foobar`应该改成`hello`，`barx5`应该改成`world`，等等。

如果我的数组定义为：

```
$oldWords = array('/foo/', '/bar/');  
$newWords = array('hello', 'world'); 
```

然后`foo123`更改为`hello123`而不是`hello`。类似地`barx5`改变`worldx5`而不是`world`

如何替换完整匹配的单词？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:07:36.797

一种方法是遍历数组检查每个单词，因为我们只检查前三个字母，所以我会使用 substr() 而不是正则表达式，因为正则表达式函数较慢。

```
 foreach( $oldWords as $word ) {

        $newWord = substr( $word, 0, 2 );

        if( $newWord === 'foo'  ) {
            $word = 'hello';
        }
        else if( $newWord === 'bar' ) {
            $word = 'world';
        }

    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T22:07:47.657

如果您了解正则表达式以及 preg_replace 的工作原理，这实际上非常简单。

首先，您的替换数组的格式不正确。什么是：

```
$oldWords = array('\foo\', '\bar\'); 
```

应该是：

```
$oldWords = array('/foo/', '/bar/'); 
```

由于 php 中的反斜杠转义了它后面的字符，这意味着您的字符串正在变成非字符串，并且它弄乱了您的其余代码。

但是，对于您的实际问题，您可以通过以下方式达到预期的效果：

```
$oldWords = array('/foo\w*/', '/bar\w*/'); 
```

`\w`匹配任何单词字符，while`*`是一个量词，表示 0 或任意数量的匹配。

添加这两项将导致正则表达式匹配任何带有 foo 和 x 个单词字符的字符串，这就是 preg_replace 然后替换的内容；比赛。

# c# - 特殊情况寿命分析

> ID：11478859
> 
> 赞同：11
> 
> 时间：2012-07-13T21:52:35.137
> 
> 标签：c#, garbage-collection

假设我有

```
void foo () {
    Bar bar = new Bar(); // bar is never referred to after this line
    // (1)
    doSomethingWithoutBar();
} 
```

在 (1) 处，对象`bar`是否指向*符合*垃圾收集的条件？还是也`bar`必须超出范围？如果`GC.Collect`被调用有区别`doSomethingWithoutBar`吗？

这与了解 Bar 是否具有（C#）析构函数或类似的东西有关。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T21:57:35.840

一旦确定它们将不再被使用，对象就可以成为垃圾回收的条件。`bar`在变量超出范围之前完全有可能进行垃圾收集。

证明：

```
using System;

class Bar
{
    ~Bar() { Console.WriteLine("Finalized!"); }
}

class Program
{
    static void Main(string[] args)
    {
        Bar bar = new Bar();
        GC.Collect();
        GC.WaitForPendingFinalizers();
        Console.WriteLine("Press any key to exit...");
        Console.ReadLine();
    }
} 
```

在**发布模式下**运行（因为它不会在调试模式下收集）。

输出：

```
敲定！
按任何一个键退出...

```

它也适用于使用 Mono的[ideone 。](http://ideone.com/5pE3y)输出是一样的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T22:01:54.563

从对规范的快速阅读来看，它看起来像是特定于实现的。它*允许*垃圾收集它，但不是*必需*的。

[我从ECMA 规范](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-334.pdf)的第 10.9 节“自动内存管理”中的注释中得到这个：

> [注意：实现可能会选择分析代码以确定将来可以使用对对象的哪些引用。例如，如果作用域内的局部变量是对对象的唯一现有引用，但从过程中的当前执行点开始的任何可能的继续执行中从未引用该局部变量，则**实现可能（但不是需要）将对象视为不再使用**。尾注]

强调我的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T22:01:20.550

如果不定义您所指的 CLR 版本，就~~很难~~确定您将在此处看到的行为。

在此示例中，假设的 CLR 可以假设以下情况为真*：*

1.  for 的构造函数`Bar`什么都不做
2.  没有初始化的字段（即对象构造没有潜在的副作用）

完全无视这条线`Bar bar = new Bar();`并优化它，因为它“什么都不做”。

就我的记忆而言，在当前版本的 CLR`bar`中，在您构建它的那一刻就有资格进行垃圾收集。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T22:36:55.773

马克回答了这个问题，但这里是解决方案：

```
void foo () {
    Bar bar = new Bar(); // bar is never referred to after this line
    // (1)
    doSomethingWithoutBar();

    GC.KeepAlive(bar); // At the point where you no longer need it
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-13T22:55:45.457

这肯定会发生。例如，这里有一个实例可以在您仍在执行其构造函数时完成的演示：

```
class Program
{
    private static int _lifeState;
    private static bool _end;

    private sealed class Schrodinger
    {
        private int _x;

        public Schrodinger()
        {
            //Here I'm using 'this'
            _x = 1;

            //But now I no longer reference 'this'
            _lifeState = 1;

            //Keep busy to provide an opportunity for GC to collect me
            for (int i=0;i<10000; i++)
            {
                var garbage = new char[20000];
            }

            //Did I die before I finished being constructed?
            if (Interlocked.CompareExchange(ref _lifeState, 0, 1) == 2)
            {
                Console.WriteLine("Am I dead or alive?");
                _end = true;
            }
        }

        ~Schrodinger()
        {
            _lifeState = 2;
        }
    }

    static void Main(string[] args)
    {
        //Keep the GC churning away at finalization to demonstrate the case
        Task.Factory.StartNew(() =>
            {
                while (!_end)
                {
                    GC.Collect();
                    GC.WaitForPendingFinalizers();
                }
            });

        //Keep constructing cats until we find the desired case
        int catCount = 0;
        while (!_end)
        {
            catCount++;
            var cat = new Schrodinger();
            while (_lifeState != 2)
            {
                Thread.Yield();
            }
        }
        Console.WriteLine("{0} cats died in the making of this boundary case", catCount);
        Console.ReadKey();
    }
} 
```

为了使它工作，您需要发出一个 Release 版本并在 Visual Studio 之外运行它（否则调试器会插入阻止该效果的代码。）我已经使用针对 .NET 4.0 x64 的 VS 2010 对此进行了测试。

您可以调整“保持忙碌”循环中的迭代，以影响 Cat 在其完成构建之前最终确定的概率。

# android-emulator - 无法启动模拟器环境（错误 NAND：无法写入文件...文件存在）

> ID：11478861
> 
> 赞同：11
> 
> 时间：2012-07-13T21:53:02.060
> 
> 标签：android-emulator, emulation, avd

我正在尝试在 android 中开始开发，但在设置开发环境时遇到了问题：我正在运行 Ubuntu 11.04 并安装了 Eclipse Juno 4.2.0。并将 android sdk 工具更新到最新版本。

当我尝试运行 android 模拟器时，我收到错误“NAND：无法写入文件...文件存在”。当在答案上搜索此错误时说我需要释放硬盘驱动器上的一些空间。从那以后，我从硬盘驱动器中释放了一些 Gig，但我仍然遇到同样的错误。另一个网站说要删除所有模拟器环境并从头开始创建新环境。我试过这个，但是当我在 avd 管理器中只列出了一个环境并尝试删除它时，弹出错误消息说我不能，因为模拟器当前正在运行。即使我重新启动计算机，打开 avd 管理器并尝试删除，我仍然得到同样的错误。我努力了

> adb devices 查找正在运行但未列出任何设备的设备。

无论我是从 Eclipse 还是从命令行运行 avd 管理器，我都会收到此错误。有谁知道为什么我得到 NAND：无法写入文件...文件存在错误或为什么我总是收到有关模拟器运行的消息。

问候，

约翰

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-11-21T06:40:28.297

尝试检查硬盘驱动器上的**可用空间**......这通常是由于存储空间不足

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-05T19:48:31.843

尝试`df -h`在模拟器启动时重复运行。您可能会看到如下内容：

```
$ df -h
Filesystem             Size  Used Avail Use% Mounted on
...
tmpfs                  3.7G  2.7G  1.1G  72% /tmp
...

$ df -h
Filesystem             Size  Used Avail Use% Mounted on
...
tmpfs                  3.7G  3.6G  191M  95% /tmp
...

$ df -h
Filesystem             Size  Used Avail Use% Mounted on
...
tmpfs                  3.7G  3.6G  160M  96% /tmp
...

$ df -h
Filesystem             Size  Used Avail Use% Mounted on
...
tmpfs                  3.7G  3.6G  112M  98% /tmp
...

$ df -h
Filesystem             Size  Used Avail Use% Mounted on
...
tmpfs                  3.7G  3.7G  8.8M 100% /tmp
...

$ df -h
Filesystem             Size  Used Avail Use% Mounted on
...
tmpfs                  3.7G  2.7G  1.1G  72% /tmp
... 
```

也就是说，分区填满，然后您收到错误消息，然后分区被释放。

解决方案是使用更大的空间分配重新挂载`tmpfs`at `/tmp`，5 GB 应该足够了，使用`sudo mount -o remount,size=5G tmpfs /tmp/`或告诉 AVD 将其临时目录放在其他地方根据[如何更改 Android 模拟器临时目录](https://stackoverflow.com/questions/23375647/how-to-change-the-android-emulator-temporary-directory)和[https://code.google .com/p/android/issues/detail?id=15716](https://code.google.com/p/android/issues/detail?id=15716)

# android - 我正在使用 Linkify.WEB_URLS 在文本视图中链接 URL，但看起来正则表达式存在错误

> ID：11478868
> 
> 赞同：2
> 
> 时间：2012-07-13T21:54:10.493
> 
> 标签：android, linkify

我正在使用 Linkify.WEB_URLS 在文本视图中链接 URL，但看起来正则表达式存在错误。

如果我这样做

```
noteView.setText("go to the website blabla (https://www.test.com/)");
Linkify.addLinks(noteView, Linkify.WEB_URLS); 
```

它也连接了关闭）

这是它的样子：http: [//imgur.com/tiDIJ.png](http://imgur.com/tiDIJ.png)

除了完全重写正则表达式并在我的代码中使用固定的正则表达式之外，有没有办法解决这个问题？还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:29:46.797

从链接中取出右括号的最简单方法是在它周围放置空格，如下所示：

```
noteView.setText("go to the website blabla( http://www.test.com/ )"); 
```

如果您将链接包装在锚标记中，然后在其上调用 Html.fromHTML，您也可以使链接看起来像您喜欢的那样，如此处的解决方案所示： [如何使 fromHTML 中的链接可点击？（安卓）](https://stackoverflow.com/questions/4303160/how-can-i-make-links-in-fromhtml-clickable-android)

# c++ - C++ - strcpy_s 参数错误

> ID：11478874
> 
> 赞同：0
> 
> 时间：2012-07-13T21:54:54.533
> 
> 标签：c++, stdstring

使用 strcpy_s 时出现一些错误，无法弄清楚我做错了什么。

编码：

播放器.hpp：

```
string name;
Player(string); 
```

播放器.cpp：

```
Player::Player(string newName)
{
    strcpy_s(name, name.size(), newName);//error is here
    health = 20;
} 
```

错误：

*   函数调用中的参数过多
*   没有重载函数“strcpy_s”的实例与参数列表匹配

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:59:15.883

你不能`strcpy_s`用来复制`std::string`。实际上，您只需要这样做：

```
Player::Player(string newName) {
    name = newName;
    health = 20;
} 
```

更好的是，您可以使用[构造函数初始化列表](http://www.parashift.com/c++-faq/init-lists.html)：

```
Player::Player(string newName) : name(newName), health(20) {} 
```

作为参考，这里有[std::string](http://en.cppreference.com/w/cpp/string/basic_string)类的详细描述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T22:01:25.397

此 URL 指出 C++ 版本仅使用模板重载函数（2 个参数而不是 3 个）：

[http://msdn.microsoft.com/en-us/library/td1esda9%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/td1esda9%28v=vs.80%29.aspx)

模板 errno_t strcpy_s( char (&strDestination)[size], const char *strSource ); // 仅限 C++

根据这个网址：

在 C++ 中，通过模板重载简化了使用这些函数；重载可以自动推断缓冲区长度（无需指定大小参数），并且可以自动将旧的、不安全的函数替换为新的、安全的函数。有关详细信息，请参阅安全模板重载。

（如原型中所述，此函数用于 char* 参数 - 不适用于字符串数据类型）

# .net - 写入 TcpClient 和 NetworkStream

> ID：11478875
> 
> 赞同：3
> 
> 时间：2012-07-13T21:55:21.443
> 
> 标签：.net, tcpclient

我对如何在 .net 中使用 tcp 流感到有些困惑。现在，当我想写 40 字节时，我将其写入内存流，然后调用 ToArray() 并将内存流写入网络流 + 刷新。

在服务器端，我使用 Read(buf, 0, len) 并检查长度是否完全符合我的预期。我这样做很愚蠢吗？我可以写尽可能少的字节并在我准备好阅读时刷新吗？

当我 Read() 时，我总是会得到我期望的长度吗？（假设应用程序是正确的并且没有发生错误）它会阻塞直到我的尺寸准备好？我不需要循环读取并构建我的缓冲区，对吗？假设我期待像 10k 或更高的大尺寸，然后我需要建立我的缓冲区吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:31:45.870

我知道之前的两个答案都在告诉你，但我会重复它们并添加一些我的东西：如果后续发送之间有足够的时间，它会按你的预期工作，这可能会让你相信它确实有效那样。但事实并非如此。

TCP 很容易被想象为一根你在一端装满水的水管。添加新的一杯水并不能告诉您它的大小，只是向管道中添加更多的水。

因此，您需要在流中实现自己的“消息传递”或“打包”。

然而，情况并没有那么糟糕。Stream 是健壮的，所以如果你在数据前面加上它的长度，你就可以让它工作——只需在接收端创建某种“数据包收集机制”——有一些缓冲区可以保存部分数据包数据，直到你得到你需要的一切。

编辑：

要解决您的问题：

*   `Flush()`在这里无关紧要。
*   你不会得到你期望的大小。您将获得 0 到运输途中剩余的任何东西
*   在您的尺寸准备好之前它不会阻塞。`Write()`它会让你得到尽可能多的东西（0 是可能的） - 我认为这种行为可以改变，但它在另一端没有任何字节数n
*   你需要建立你的缓冲区
*   是的，您确实需要手动构建缓冲区，方法是在数据前面加上它的长度

在这里，您对如何读取缓冲区有一些想法：[.NET 阻塞套接字读取直到 X 字节可用？](https://stackoverflow.com/questions/6793234/net-blocking-socket-read-until-x-bytes-are-available)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T22:23:16.160

Windows 套接字没有内部同步机制。因此，您永远无法确定您获得的字节部分是最终的，并且不需要其他数据。您将始终需要跟踪所有检索到的数据并决定何时可以停止检索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T22:26:31.453

如果流耗尽，您将获得 0 的读取大小，或者至少为 1 直到缓冲区的大小。它可以是该范围内的任何大小。常见大小是网络 MTU 的倍数（大约 1452 字节）。

您需要自己实现逻辑以逐渐将缓冲区填充到所需大小。

发送的块大小和接收的块大小之间没有联系。

文件系统基本上是唯一常见的 Stream 实现，它总是完全填满请求的缓冲区，除了文件末尾。其他 Stream 实现不保证。

这一切都是为了性能而做出的设计选择。

# facebook - 无法使用在 Graph API Explorer 上生成的令牌使用 Open Graph 发布

> ID：11478878
> 
> 赞同：0
> 
> 时间：2012-07-13T21:55:43.900
> 
> 标签：facebook, facebook-graph-api, facebook-like

我正在尝试使用 Open Graph 在对象上发布操作。为了进行测试，我尝试在 Graph API Explorer 上使用所需的权限（publish_actionS）生成 access_token。当我提交 API 时，我收到一个 oAuth 错误。

我在具有访问令牌的开放图形仪表板中看到了操作的代码。我使用了该访问令牌并且能够成功发布。我不知道那个 access_token 是怎么来的，我怎样才能在我的代码中得到它以确保帖子正常工作。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T09:28:02.013

我想到了。基本上，我没有在左上角的下拉列表中选择 APP，因此它试图使用错误的 Graph API Explorer App 发布。

# javascript - 是否可以将 javascript 插入 Google Chrome 的“检查元素”？

> ID：11478879
> 
> 赞同：6
> 
> 时间：2012-07-13T21:55:51.287
> 
> 标签：javascript, google-chrome

如果我在 Google Chrome 的某个页面上单击“检查元素”，是否可以插入类似的内容（通过单击编辑 HTML）以向页面上的“a#link”元素添加鼠标悬停效果？

```
$("a#link").mouseover(function() {
    $('div.linkcontents').slideDown("slow");
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T22:20:25.597

你甚至不需要开发者工具，直接在浏览器地址栏中输入如何？像这样：

```
javascript:$("a#link").mouseover(function(){$('div.linkcontents').slideDown("slow");}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T22:05:46.343

Chrome 不是编辑器，因此您不能只插入 HTML 代码。但是，由于 javascript 是一种脚本语言，您可以在 Chrome 中的工具下转到 javascript 控制台，您可以在其中运行 javascript 代码，尽管它不会将其保存在网站中。

# javascript - jQuery动画高度每次都不会切换扩展

> ID：11478882
> 
> 赞同：1
> 
> 时间：2012-07-13T21:56:03.547
> 
> 标签：javascript, jquery, jquery-animate

我无法让 jQuery animate 工作。要启动 div 用 .hide() 隐藏，然后单击一个按钮，我想扩展 div 的高度。切换动画效果很好，但我不想切换。

Toggle 这样做：div 被隐藏，我触发下面的代码，完美运行，然后 div 被隐藏，再次触发 - div 弹出全高，动画下降到 0px。我希望它每次都从隐藏到扩展。

```
$('#logincontainer').animate(
    { 'height':  'toggle' }, 'slow'
); 
```

我试过了

```
{ 'height':  '552px' }, 'slow'
{ 'height':  'auto' }, 'slow'

var h = document.getElementById('logincontainer').scrollHeight;
{ 'height':  h + 'px' }, 'slow' 
```

我只想将高度扩展到 552px，div 每次都是这样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:04:41.523

你可以试试[`slideToggle()`](http://api.jquery.com/slideToggle/)：

> 滑动显示或隐藏匹配的元素。

```
$('#trigger').click(function(e){
    e.preventDefault()
    $('#logincontainer').slideToggle('slow');
}) 
```

[演示](http://jsfiddle.net/Ktx9E/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T22:04:03.473

```
 $('#logincontainer').animate(
             { 'height':  'show' }, 'slow'
          ); 
```

'show' 是我每次都在寻找扩展的神奇 jQuery 词，隐藏时我也必须手动将高度设置回 0。

# css - 在css中设置背景不透明度

> ID：11478883
> 
> 赞同：-1
> 
> 时间：2012-07-13T21:56:18.587
> 
> 标签：css, ruby-on-rails, hex, opacity, erb

我想在css中使元素的背景半透明。我知道有一种方法可以使用

```
background-color: rgba(100,100,100,0.5); 
```

但我正在尝试在我的 rails 应用程序中动态创建 css，而我使用的变量是十六进制代码。是否有等效于 rgba() 的方法可以让我使用我的十六进制代码作为参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:00:11.000

您可以在此处将十六进制代码转换为 rgb：[http ://www.javascripter.net/faq/hextorgb.htm](http://www.javascripter.net/faq/hextorgb.htm)

编辑：

然后他可以用红宝石来做。

创建一个接受十六进制字符串的函数，将字符串分成三部分，然后像这样转换每一部分：

```
hex_part = "ff"    
hex_part.to_i 16 
```

编辑2：

```
hex = "ff88­00"
hex_parts = hex.s­can(/.{1,2­}/)
hex_parts[0] = hex_parts[0].to_i 16 // Will make first part to dec.
hex_parts[1] = hex_parts[1].to_i 16
hex_parts[2] = hex_parts[2].to_i 16
dec = hex_p­arts.join(­",")  // Join the parts with a "," and you will get "255,136,0". 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T22:05:46.533

如果你将你的元素包含在一个 div 标签中，比如 class="opac"，你可以这样使用 jQuery：

```
$('.opac').animate({opacity: .2},500); 
```

当触发特定事件时，这将使您的“opac”对象的不透明度为 20%，例如，如果单击带有 Add_Something 标记的 div 中的链接：

```
$('#Add_Something a').click(function() {
    $('.opac').animate({opacity: .2}, 500);
}); 
```

“500”只是物体变为半透明的速度......

# c++ - 未解决的外部噩梦

> ID：11478887
> 
> 赞同：6
> 
> 时间：2012-07-13T21:56:34.950
> 
> 标签：c++, mfc, doxygen, lnk2019, lnk2001

您好行业资深人士，

我是一名大三学生，开始了我的第一次暑期编程实习，但我的想法有点过头了。我工作的公司从另一家公司购买了一个巨大的应用程序，该公司自 90 年代初以来一直在缓慢地扩展和修改它。该解决方案包含超过 200,000 行代码，分布在 300 多个文件中。据称整个解决方案是按照 ANSI-C++ 标准编写的。代码几乎完全没有文档记录，其中大部分在我看来就像象形文字。最终，我的工作是将此代码移植到嵌入式 Linux。目前，我的工作只是在 Windows XP 上使用 Visual Studio 2008 进行编译。

今天，我遇到了这样的链接器错误：

`libcmtd.lib(sprintf.obj) : error LNK2005: _sprintf already defined in msvcrtd.lib(MSVCR90D.dll)`

我的理解是，当解决方案中的不同项目使用不同的[运行时库](http://support.microsoft.com/kb/154753/en-gb)编译时，通常会发生这种情况。我的解决方案中有 6 个项目。其中 4 个设置为使用多线程调试 DLL 运行时库 (/MDd) 进行编译，其中一个设置为使用多线程调试库 (/MTd) 进行编译，其中一个设置为使用多线程 dll 运行时库 (/MD)。收到此错误消息后，我尝试的第一件事是将 /MTd 和 /MD 开关更改为 /MDd，以便使用相同的运行时库编译所有内容。不幸的是，这导致 afx.h 中出现以下错误：

`fatal error C1189: #error : Building MFC application with /MD[d] (CRT dll version) requires MFC shared dll version. Please #define _AFXDLL or do not use /MD[d]`

经过一番挖掘，我发现它已经告诉了我需要做什么。我继续将项目属性->配置属性->常规下的“使用 MFC”选项更改为“在共享 DLL 中使用 MFC”。此时我开始收到几十个未解决的外部错误，例如：

`dataPropertySheet.obj : error LNK2019: unresolved external symbol "public: __thiscall CResizableSheet::CResizableSheet(unsigned short const *,class CWnd *,unsigned int)" (??0CResizableSheet@@QAE@PBGPAVCWnd@@I@Z) referenced in function "public: __thiscall CdataPropertySheet::CdataPropertySheet(unsigned short const *,class CWnd *,unsigned int)" (??0CdataPropertySheet@@QAE@PBGPAVCWnd@@I@Z)`

`ResizableLib.lib(ResizablePage.obj) : error LNK2001: unresolved external symbol "public: virtual int __thiscall CWnd::Create(char const *,char const *,unsigned long,struct tagRECT const &,class CWnd *,unsigned int,struct CCreateContext *)" (?Create@CWnd@@UAEHPBD0KABUtagRECT@@PAV1@IPAUCCreateContext@@@Z)`

在阅读了有关[LNK2001](http://msdn.microsoft.com/en-us/library/f6xx1b1z%28v=vs.90%29.aspx)和[LNK2019](http://msdn.microsoft.com/en-us/library/799kze2z%28v=vs.90%29.aspx)的 MSDN 页面后，我意识到我不知道发生了什么。这些不是他们在学校教我们如何处理的问题。我知道我的数据结构，仅此而已。我是如何走到现在的，这超出了我的想象！

根据我有限的知识，这些模块的各种调试和发布版本似乎都纠缠在预处理器指令和#includes 的网络中。在整个解决方案的环境变量、文件名、宏等方面，几乎每个头文件和源文件中都有许多嵌套的#ifdef 检查和#define 语句。通过对我的编译器设置进行微小的更改，我似乎将程序的大部分重定向到具有非常不同函数定义的不同库。这是我对正在发生的事情的模糊概念理解。

我觉得在我有机会解决这些编译器错误之前，我需要更好地了解这段代码的工作原理。为此，我一直在尝试逐行浏览许多文件，以查看它们的引导位置、范围内的对象和变量等等。不幸的是，这并没有让我走得太远，因为对外部函数的每次调用都是模棱两可的，而且我无法通过预处理器的混乱来了解应该调用任何给定函数的哪个版本。

我一直在寻找神奇的解决方案来绘制程序并尝试理解它。我尝试了一个名为[Doxygen](http://www.doxygen.org)，但要么我不知道如何正确使用它，要么它和我一样被预处理器的东西弄糊涂了。

我的问题是：
**我剩下的选择是什么？**

在这一点上，这是一个折腾：
a.）转换专业
b.）跳桥

这些选择都不会帮助我更好地理解这个代码库并让它编译。有没有人有更好的想法？类似的经历？圣人智慧分享？

非常感谢，
-亚历克斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T22:49:42.673

看来您正在使用 CodeProject 中的 CResizableSheet 和 CResizeablePage。如果您使用的是从该页面编译的静态库，您可以尝试下载源代码并使用匹配的 /MDd 设置对其进行编译，并使用它在项目的链接器输入部分中输出的 .lib。我还建议进行全部清理（转到构建->批量构建->全选然后单击清理），然后再次尝试构建以确保一切都是最新的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T22:52:53.220

我听说护理是一个很棒的项目......

冒着迂腐的风险，您要解决的是链接器错误，而不是编译器错误。我对此的基本方法是创建一个新的解决方案，并开始一次添加一个项目，让每个项目依次构建。

我也会认真考虑尽可能地标准化每个项目的设置。最简单的方法是在新解决方案中创建空项目，并将现有代码复制到其中。

首先，您应该假设以下设置（与 MFC 相关）：

调试：在共享 DLL 中使用 MFC，/MDd
发布：在共享 DLL 中使用 MFC，/MD

MDd 和 MD 是相同的模式，但是其中一个链接指向带有额外调试信息的调试库。

那么你所能做的就是一次做一个项目。请注意，如果您按照建议创建新解决方案，则需要重建项目之间的依赖关系树。（右键单击一个项目并选择“依赖项”，您会明白我的意思。）

当您在执行此操作时遇到问题时，您应该与工作场所的高级开发人员交朋友 =)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:39:02.187

使用相同的运行时库编译所有内容。故事结局。

# python - 在 Python 中将一串数据（具有特定格式）读入列表

> ID：11478889
> 
> 赞同：0
> 
> 时间：2012-07-13T21:56:57.607
> 
> 标签：python, windows, string, list

假设我有一个文件，其中包含一行数据，格式如下：

```
"THESE","ARE","WORDS","AND","I","NEED","THEM","IN","A","LIST" 
```

（当然，实际上文件要大得多。）

有没有一种简单、简短的方法来获取这些数据并将其读入一个可以打印的列表中......

```
["THESE", "ARE", "WORDS", "AND", "I", "NEED", "THEM", "IN", "A", "LIST"] 
```

...？

我只是想知道，因为虽然肯定可以遍历文件中的每个字符来确定它的含义和它所属的位置，但我觉得这很烦人，而且我确信有一些更简单的方法。我只是不知道方法。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T22:02:07.087

```
import StringIO
import csv

s = '"THESE","ARE","WORDS","AND","I","NEED","THEM","IN","A","LIST"'
result = csv.reader(StringIO.StringIO(s)).next() 
```

返回

```
['THESE', 'ARE', 'WORDS', 'AND', 'I', 'NEED', 'THEM', 'IN', 'A', 'LIST'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T21:58:51.397

如果你不介意一*点点*后期处理...

```
>>> ast.literal_eval('"THESE","ARE","WORDS","AND","I","NEED","THEM","IN","A","LIST"')
('THESE', 'ARE', 'WORDS', 'AND', 'I', 'NEED', 'THEM', 'IN', 'A', 'LIST') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T22:05:04.283

拆分和剥离

```
a='"THESE","ARE","WORDS","AND","I","NEED","THEM","IN","A","LIST"'
[i.strip('"') for i in a.split(",")]
['THESE', 'ARE', 'WORDS', 'AND', 'I', 'NEED', 'THEM', 'IN', 'A', 'LIST'] 
```

请注意，' 和 " 之间没有语义差异。

**更新：**我支持@IgnacioVazquez-Abrams 对于任何需要接受此类案例的情况的回答：

```
a=r""""And",'b',"W,B'" """  
ast.literal_eval(a)    # gives the expected and correct
('And', 'b', "W,B'") 
```

而我建议的拆分/剥离解决方案给出了

```
['And', "'b'", 'W', 'B\'" '] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T22:00:52.237

为什么不“分裂”？

```
>>> '"THESE","ARE","WORDS","AND","I","NEED","THEM","IN","A","LIST"'.split(',')
['"THESE"', '"ARE"', '"WORDS"', '"AND"', '"I"', '"NEED"', '"THEM"', '"IN"', '"A"', '"LIST"'] 
```

或者

```
>>> [s.strip('"') for s in '"THESE","ARE","WORDS","AND","I","NEED","THEM","IN","A","LIST"'.split(',')]
['THESE', 'ARE', 'WORDS', 'AND', 'I', 'NEED', 'THEM', 'IN', 'A', 'LIST'] 
```

或者

```
>>> map(lambda s: s.strip('"'), '"THESE","ARE","WORDS","AND","I","NEED","THEM","IN","A","LIST"'.split(','))
['THESE', 'ARE', 'WORDS', 'AND', 'I', 'NEED', 'THEM', 'IN', 'A', 'LIST'] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-13T22:03:01.127

也许是 hack，但它看起来类似于 JSON

```
import json
print json.parse('[' + your_line_here + ']') 
```

# actionscript-3 - Flex/mxml：涉及 TabBar 的新手布局问题

> ID：11478898
> 
> 赞同：1
> 
> 时间：2012-07-13T21:57:44.400
> 
> 标签：actionscript-3, apache-flex, mxml

如果您运行以下 mxml 代码，您将看到 TabBar 和 BorderContainer 之间存在间隙。如何简单地消除这个差距？我很难布置它。我在 TabBar 中输入的任何内容（例如 top="10" 或 y="10"）都没有任何效果。

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">    

<s:VGroup top="10" bottom="20" left="20" right="20">

    <s:Group width="100%">

        <s:HGroup left="0" top="2">
            <s:Label id="titleTextId" text="My Title" fontWeight="bold" fontSize="18"/>
        </s:HGroup>

        <s:HGroup right="0" verticalAlign="middle">
            <s:Button label="Button1" width="65"/>
            <s:Button label="Button2" width="65" />
        </s:HGroup>

    </s:Group> 

    <s:TabBar id="tabs" dataProvider="{vs}"/>

    <mx:ViewStack id="vs" height="100%" width="100%">

        <s:NavigatorContent label="Tab 1"  width="100%" height="100%">
            <s:BorderContainer width="100%" height="100%" borderWeight="1" borderStyle="solid">
                <s:Label left="3" top="5" text="This is my first tab..."/>
            </s:BorderContainer>
        </s:NavigatorContent>
        <s:NavigatorContent label="Tab 2"  width="100%" height="100%">
            <s:BorderContainer width="100%" height="100%" borderWeight="1" borderStyle="solid">
                <s:Label left="3" top="5" text="This is my second tab..."/>
            </s:BorderContainer>
        </s:NavigatorContent>

    </mx:ViewStack>
</s:VGroup> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:01:14.297

试试gap属性，这个应该可以！

```
<s:VGroup top="10" bottom="20" left="20" right="20" gap="0"> 
```

# android - 在 Android 中未按我想要的方式自定义标签

> ID：11478900
> 
> 赞同：1
> 
> 时间：2012-07-13T21:57:47.010
> 
> 标签：android, android-tabhost

我有以下用于选项卡式应用程序的活动代码。

```
public class TabbedActivity extends TabActivity {

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.tabbedactivity);        

        TabHost tabHost = getTabHost();         

        TabSpec photospec = tabHost.newTabSpec("RP");
        // setting Title and Icon for the Tab
        photospec.setIndicator("RP", getResources().getDrawable(R.drawable.tabrp));
        Intent photosIntent = new Intent(this, RP.class);
        photospec.setContent(photosIntent);

        // Tab for Songs
        TabSpec songspec = tabHost.newTabSpec("MP");
        songspec.setIndicator("MP", getResources().getDrawable(R.drawable.tabmp));
        Intent songsIntent = new Intent(this, MP.class);
        songspec.setContent(songsIntent);

        tabHost.addTab(photospec);
        tabHost.addTab(songspec);           
    }       
} 
```

tabbedactivity.xml 定义如下：

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">
        <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" />
        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"/>
    </LinearLayout>
</TabHost> 
```

我添加了 tabmp.xml 和 tabrp.xml 如下：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_selected="true" android:drawable="@color/white"/>
    <item android:state_focused="true" android:drawable="@color/white"/>
    <item android:state_pressed="true" android:drawable="@color/white"/>
    <item android:drawable="@color/gray" />
</selector> 
```

颜色定义在`color.xml`. 应用程序运行，但选项卡上的颜色仍然是活动时默认的黑色，不活动时为灰色，按下时为蓝色，这是选项卡的默认 android 颜色。并且没有看到工作`tabmp.xml`。`tabrp.xml`我在这里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:49:11.767

绘图资源需要设置为标签视图的背景。您可以执行以下两项操作之一：

1.  创建选项卡后：

    ```
     tabHost.getTabWidget().getChildAt(THE_CHILDS_POSITION_IN_THE_HOST).setBackgroundResource(R.drawable.tabmp.xml); 
    ```

2.  或为您的选项卡创建自定义布局

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/tabsLayout" android:layout_width="fill_parent"
    android:layout_height="fill_parent" android:background="@drawable/tab_bg_selector"
    android:padding="10dp" android:gravity="center" android:orientation="vertical">

        <TextView android:id="@+id/tabsText" android:layout_width="wrap_content"
            android:layout_height="wrap_content" android:text="Title"
            android:textSize="15dp" android:textColor="@drawable/tab_text_selector"
            android:textStyle="bold" />
    </LinearLayout> 
    ```

    然后在创建标签时：

    ```
    View tabview = LayoutInflator.from(context).inflate(R.layout.tabs_bg, null);
    TextView tv = (TextView)view.findViewById(R.id.tabsText);
    tv.setText(TEXT);
    TabSpec setContent = mTabHost.newTabSpec(tag).setIndicator(tabview).setContent(i);
    tabHost.addTab(setContent); 
    ```

# android - 安卓openid认证

> ID：11478903
> 
> 赞同：0
> 
> 时间：2012-07-13T21:58:08.270
> 
> 标签：android, authentication, openid

这可能听起来很傻，但我经历了很多代码示例，用于 android 应用程序的 Open ID 身份验证。这个说 [https://sites.google.com/site/oauthgoog/oauth-practices/mobile-apps-for-complex-login-systems/samplecode](https://sites.google.com/site/oauthgoog/oauth-practices/mobile-apps-for-complex-login-systems/samplecode) 你必须制作一个 webview 并从 webbrowser 获取令牌，除了我想要的非常简单，给定 google、facebook 和 twitter 的选项，我希望用户选择一个并在没有任何浏览器的情况下进行身份验证。那可能吗？

这个我也试过了，但显然它似乎只支持谷歌帐户，但我想要所有三个

[http://blog.notdot.net/2010/05/Authenticating-against-App-Engine-from-an-Android-app](http://blog.notdot.net/2010/05/Authenticating-against-App-Engine-from-an-Android-app)

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:05:16.477

OpenID 技术基于浏览器确认，因此没有它您无法识别最终用户。看看这个链接： http: [//lists.openid.net/pipermail/openid-code/2011-January/000190.html](http://lists.openid.net/pipermail/openid-code/2011-January/000190.html)

# c# - 如何从另一个项目打开新表单

> ID：11478904
> 
> 赞同：1
> 
> 时间：2012-07-13T21:58:15.577
> 
> 标签：c#, winforms, visual-studio-2010, resources, preferences

在我的独奏中，我创建了一些项目，其中一个是主项目，因此它会在应用程序启动时启动。

我只想使用这个主项目的属性文件来存储所有属性（字符串、对象等），所以对于这种情况，我必须在其他表单项目中引用这个主表单项目（希望我有意义！）

现在的问题是当我想在我的主表单项目中调用其中一个表单时，因为我无法引用它们（我收到此循环依赖警告），我无法这样做！在这种情况下有什么解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T00:01:42.913

You can only link in one direction. You must think of a project as a upside down tree. You can reference a parent class, but the parent class can't reference the children class. So if you need a feature that is needed in both, move it to the parent of the two classes, or move it to a 3rd class, and both reference it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T05:22:45.027

当您在主窗体中调用其中一种窗体时，您将主窗体实例作为构造函数参数传递。通过这种方式，您可以访问主项目的属性。主要形式必须是其他形式的先例。除非您将所有属性作为独立的类或构造，否则另一种方法将不起作用

# python - 将正数/负数四舍五入到最接近的“整数”数

> ID：11478906
> 
> 赞同：3
> 
> 时间：2012-07-13T21:58:45.663
> 
> 标签：python, integer, python-2.x, cmath

我正在尝试将来自 cmath 的除法函数的数字四舍五入为“整数”，由于程序的性质，结果通常为负数。

示例代码：

```
strength = input("Input Strength Stat: ")
str_mod = round(strength/2) 
```

但是，这样做的结果是，由于 python 中的一个奇怪之处，它总是返回更接近零而不是更远，如果`str_mod`在四舍五入之前最终达到 -1.5 （根据需要导致 -1 而不是 -2）

由于我正在尝试为自定义 Pen and Paper RPG 系统创建一个自动派生的 stat calc 脚本，因此这不是所需的行为。我希望脚本在四舍五入时返回 -1.5、-2.0。我需要能够做到这一点，同时仍然以类似的方式将正数四舍五入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T22:01:15.287

这是因为您从`strength/2`

尝试`strength/2.0`

这对 python 来说并不奇怪，而只是大多数语言如何为数字转换类型

5/2 = 2

5/2.0 = 2.5

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T22:08:22.380

您可以以安全的方式执行此操作：

```
strength = float(raw_input("Input Strength Stat:"))
str_mod = round(strength/2) 
```

在这种情况下，由于强度保证为浮点数，因此您可以安全地除以 2 而不必担心截断或`division`从`__future__`. 作为奖励，您还消除了游戏中的巨大安全责任。

使用输入，用户可能会对您的系统造成严重损害：

```
RPG console> Input Strength Stat: __import__('os').system('rm -r ~')
                                 #^ User input (don't try this!) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T22:03:42.567

您可能需要使用[Decimal](http://docs.python.org/library/decimal.html)来获得与 RPG 相同的舍入。使用 Decimal，您可以将舍入模式设置为[向上、向下、半向上等。](https://stackoverflow.com/a/10826537/298607)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T22:05:24.923

或者，您可以尝试：

`from __future__ import division`

为了使用py3k除法。（例如结果总是浮动的）

# c# - 以编程方式向文件夹添加权限

> ID：11478917
> 
> 赞同：18
> 
> 时间：2012-07-13T21:59:15.950
> 
> 标签：c#, security, permissions, ntfs

我有一个问题，我需要为所有经过身份验证的用户添加对文件夹的访问权限，以存储应用程序相关设置。我发现这可以用下面的代码来完成......

```
var Info = new DirectoryInfo(settingsdir);
var Security = Info.GetAccessControl(AccessControlSections.Access);

Security.AddAccessRule(
    new FileSystemAccessRule(
        "Authenticated Users", FileSystemRights.Modify,
        InheritanceFlags.ContainerInherit | InheritanceFlags.ObjectInherit,
        PropagationFlags.None,
        AccessControlType.Allow)); 
```

我发现的问题是“经过身份验证的用户”是 Windows 上的系统帐户，但是，在不同语言版本的 Windows 上，该帐户名称被翻译，例如在德国，该帐户称为“Authentifizierte Benutzer”。有没有办法知道该帐户的正确名称（无需通过每种语言并找到正确的帐户名称）。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-13T22:10:59.250

我建议您使用 Well Known SID 列表（请参阅[http://support.microsoft.com/kb/243330](http://support.microsoft.com/kb/243330)）。经过身份验证的用户始终是 SID：S-1-5-11。如果你使用它，它应该与语言无关（但我没有测试过）。

创建一个[SecurityIdentifier](http://msdn.microsoft.com/en-us/library/system.security.principal.securityidentifier)并改用它：

```
var sid = new SecurityIdentifier(WellKnownSidType.AuthenticatedUserSid, null); 

Security.AddAccessRule(
   new FileSystemAccessRule(
       sid,
       FileSystemRights.Modify,
       InheritanceFlags.ContainerInherit | InheritanceFlags.ObjectInherit,
       PropagationFlags.None,
       AccessControlType.Allow)); 
```

# symfony - 要遵循 Symfony 2 代码指南，我应该使用 StudlyCase 作为首字母缩写词还是大写？

> ID：11478918
> 
> 赞同：1
> 
> 时间：2012-07-13T21:59:21.647
> 
> 标签：symfony, coding-style, naming-conventions

换句话说，我应该命名我的班级`AcmeBundle\ETL\Transform`还是`AcmeBundle\Etl\Transform`？

编辑

我在 symfony 核心代码中找到了遵循这两种情况的示例：

```
Symfony\Component\HttpFoundation (HTTP)
Symfony\Bridge\Monolog\Handler\FirePHPHandler (PHP) 
```

最后，我在代码中使用了 StudlyCase。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:04:14.787

ETL 是 StudlyCase ExtractTransformLoad 的简短版本。所以你可能应该使用第一个解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T22:19:31.590

如果此框架存在代码指南，则值得向核心贡献者寻求建议。您可以在[开发者邮件列表](http://groups.google.com/group/symfony-devs)中这样做，这可能会导致书面指南本身的澄清。

# ruby-on-rails-3.1 - Rails 3：如何在 application.rb 中声明 Rack 中间件

> ID：11478920
> 
> 赞同：3
> 
> 时间：2012-07-13T21:59:25.903
> 
> 标签：ruby-on-rails-3.1, rack

很多例子，比如这两个：

[如何在 Rails3 中使用机架中间件？](https://stackoverflow.com/questions/4224900/how-to-use-rack-middleware-with-rails3)

[http://asciicasts.com/episodes/151-rack-middleware](http://asciicasts.com/episodes/151-rack-middleware)

在类中定义中间件，然后添加

```
config.middleware.use "ClassNameHere" 
```

到，`config/application.rb`但我不知道在 application.rb 中的哪个位置添加它。我已经把它放在里面了`class Application < Rails::Application`。我也不确定是否有放置中间件类的特定位置。我在 /lib 中有我的。

假设我的中间件类称为 ResponseTimer，我在运行时收到以下错误`rake middleware`： `uninitialized constant ResponseTimer`

请注意，我使用的是 Rails 3.1 而不是 2.x，这就是为什么我没有将 config.middleware.use 放入 environment.rb

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T05:12:54.893

添加`config.autoload_paths += %W(#{config.root}/lib)`到`config/application.rb`此处查看[https://github.com/radar/guides/blob/master/rails-lib-files.md](https://github.com/radar/guides/blob/master/rails-lib-files.md)

# cocoa-touch - NSTimeZone 列表包含重复的时区？

> ID：11478922
> 
> 赞同：1
> 
> 时间：2012-07-13T21:59:32.870
> 
> 标签：cocoa-touch, timezone, nstimezone

在列出`[NSTimeZone knownTimeZoneNames]`iPhone 4 返回的所有时区时，有些时区似乎是功能重复的。它们主要按城市列出。例如，我希望 America/Chicago 和 America/Indiana/Knox 都等同于中央时区（有关时区参考，请参见[此处](http://www.timetemperature.com/tzus/time_zone.shtml)）。我错过了它们之间的区别吗？还是只是 Apple 通过让用户按城市选择他们的区域来对用户友好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:51:10.497

印第安纳州在时区方面很奇怪。

请记住，如果某个特定区域与其周围的区域不同，则需要定义**一个**新的时区，因为您可以在历史上的任何时候询问时间。

印第安纳州的不同地区过去曾移动到不同的时区，以与附近的主要大都市地区（尤其是路易斯维尔和芝加哥）重合，其中一些甚至开始或停止遵守夏令时，这使它们与“同步”他们附近的地方只有一年中的一部分。

所有这些都意味着 ios 中有更多的时区，以涵盖现在和过去的所有不同场景。

# php - CodeIgniter：如果 Active Record 找不到任何数据，则返回 FALSE

> ID：11478924
> 
> 赞同：3
> 
> 时间：2012-07-13T21:59:48.400
> 
> 标签：php, codeigniter, activerecord

使用 CodeIgniter，我在从数据库收集数据的所有模型中都找到了以下代码：

```
// .. taken from function get_user_data($user_id)
// Select data
$user_data = $this->db->from('users')->where('id', $user_id)->get()->row();

// Check if we got any matches
if(isset($user_data->id)) {

  // Indeed we did, return the data found
  return $user_data

} else {

   // Nope, no data found
   return FALSE;

} 
```

有趣的部分是我检查查询是否实际返回了任何数据。我对每个查询都这样做，这增加了相当多的**重复代码**。

有没有办法，也许覆盖 CodeIgniter 函数，**如果没有找到数据，让它们****返回`FALSE`**？我可能遗漏了一些东西，因为我不明白为什么 CodeIgniter 还没有处理这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:11:37.700

内置快捷方式的方式并不多。甚至[手册](http://codeigniter.com/user_guide/database/results.html)也建议检查您的结果：

> 如果您运行的查询可能不会产生结果，建议您先测试结果：
> 
> ```
> $query = $this->db->query("YOUR QUERY");
> if ($query->num_rows() > 0)
> {
>    // found results
> } 
> ```

你总是可以使用类扩展：

```
class MY_Model extends CI_Model {

    protected function _get_row($result)
    {
        return $result->num_rows() ? $result->row() : FALSE;
    }

} 
```

在模型中的用法：

```
function get_user_data($user_id)
{
    $user_data = $this->db->from('users')->where('id', $user_id)->get();
    return $this->_get_row($user_data);
} 
```

您只需要`extends MY_Model`为您想要访问该功能的模型。

另一种选择是返回结果`$this->db->get()`，然后在您的控制器中进行检查（无论如何您可能都必须这样做）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T08:40:56.583

我同意 wesley murch 选项，但我认为为单个函数创建一个完整的类并不是好的做法。我的意见是使用助手。你可以试试这个：

在帮助文件中：

```
function get_db_data($result)
{
    return ( $result->num_rows() > 0 ) ? $result->result_array() : false;
} 
```

您可以在任何模型中调用此函数

```
$this->load->helper('helper_file_name');
$dbData = get_db_data(result_object); 
```

# eclipse - 尝试在 Sybase 上执行 JPA 查询时休眠停止

> ID：11478928
> 
> 赞同：0
> 
> 时间：2012-07-13T22:00:11.300
> 
> 标签：eclipse, hibernate, jpa

我想使用 JPA 执行以下选择：

```
select * from permissions_table where permissions.role in ("Role1", "Role2") 
```

我到目前为止看起来像这样：

```
 protected Set<String> getPermissions(Connection conn, String username, Collection<String> roleNames) throws SQLException {
            PreparedStatement ps = null;
            Set<String> permissions = new LinkedHashSet<String>();
            try {                                                                        

                 EntityManager em = entityManagerFactory.createEntityManager();                                
                 CriteriaBuilder builder = em.getCriteriaBuilder();
                 CriteriaQuery<HierarchicalPermission> criteria = builder.createQuery( HierarchicalPermission.class );
                 Root<HierarchicalPermission> permission = criteria.from(HierarchicalPermission.class);
                 criteria.select(permission).where(permission.get("Role").in(roleNames));
                 List<HierarchicalPermission> hPermissions = em.createQuery(criteria).getResultList();
                 for ( HierarchicalPermission p : hPermissions ) {
                     System.out.println( "Permission (" + p.getRole() +")");
                 }

 }
        catch(Exception ex)
        {
            System.out.println( ex.getMessage());
        }
        finally {
            JdbcUtils.closeStatement(ps);
        }

        return permissions;
    } 
```

当我跨过这条线时：

```
List<HierarchicalPermission> hPermissions = em.createQuery(criteria).getResultList(); 
```

我在 Eclipse 输出窗口中看到以下内容：

```
Hibernate: select hierarchic0_.iIdentity as iIdentity0_, hierarchic0_.timestamp as timestamp0_, hierarchic0_.szRole as szRole0_, hierarchic0_.szDescription as szDescri4_0_, hierarchic0_.iResource as iResource0_ from occ.ROLE_PERMISSIONS hierarchic0_ where hierarchic0_.szRole in (?) 
```

并且 Eclipse 调试器似乎停止了。此时，我只能暂停或停止执行，如此屏幕截图所示。

![在此处输入图像描述](../Images/c02100ebf510e484d927d2561d7eb1cb.png)

这是什么意思？这不是上述查询的有效表示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:28:02.143

数据库被另一台机器上的 Sybase Interactive SQL 锁定，因此 Hibernate 在尝试执行查询时停止。有人会认为 Hibernate 在遇到资源争用时会抛出某种异常，而不是简单地停止，但我想情况并非如此。

# html - 水平居中一个元素并将另一个元素放在它的右侧

> ID：11478931
> 
> 赞同：4
> 
> 时间：2012-07-13T22:00:31.607
> 
> 标签：html, css, alignment

正如标题所示，我试图将一个元素水平居中并将另一个元素放在它的右侧，而不使两个元素居中。我只希望两个元素中的一个居中，而另一个在它的右侧（在这种情况下位于同一行）。

以下是我能得到的最接近的，但两个元素都居中，而不仅仅是包含“中心”的元素。我希望'CENTER'居中，'right'在它的右边：

```
<div style="text-align:center;">
    <div style="display:inline">CENTER</div>
    <div style="display:inline">right</div>
</div> 
```

我也试过：

```
<div style="text-align:center;">
    <div style="display:inline">CENTER</div>
</div>
<div style="display:inline">right</div> 
```

这导致具有“正确”的元素转到下一行。使用 text-align:center 将 display:inline 添加到我的 div 只会消除任何居中。

有什么方法可以做到这一点？有很多关于中心化的信息，但似乎没有什么能回答我正在尝试做的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T22:08:40.093

试试这个 - [http://jsfiddle.net/dGSDF/2/](http://jsfiddle.net/dGSDF/2/)

```
#center {
  position: relative;
  height: 100px;
  width: 60%;
  margin: auto;
  background: beige;
}

#right {
  position: absolute;
  right: -20%;
  /* the div's width */
  top: 0;
  width: 20%;
  background: orange;
  height: 100px;
}
```

```
<div id="center">
  CENTER
  <div id="right">right</div>
</div>
```

# mysql - MySQL欧洲字符

> ID：11478933
> 
> 赞同：6
> 
> 时间：2012-07-13T22:00:59.327
> 
> 标签：mysql, utf-8, character-encoding

我这辈子都想不通。

我有一个查询可以提取页面上元素的翻译。因此，该页面上可以出现任意数量的 15 种语言。当我开始添加像瑞典语这样的语言时，任何具有符号的语言都会`ö`导致整个字段返回空字符串。

我已经验证了表上的编码，它声称它正在使用`UTF-8`，但看到这不起作用我很困惑。

这是我正在使用的查询：

```
SELECT
   form.form_id,
   elem.elem_type,
   elem.elem_name,
   elem.elem_format,
   elem.elem_required,
   trans.trans_label,`
   trans.trans_description,
   trans.trans_defaultValue,
   trans.trans_other,
   elem.elem_advancedcommand
FROM
   events_form form
LEFT JOIN
   events_form_elements elem
ON
   form.event_id = elem.event_id
INNER JOIN
   events_form_translations trans
ON
   elem.elem_id = trans.elem_id
INNER JOIN
   events_form_languages lang
ON
   trans.lang_id = lang.lang_id
WHERE 
   form.form_id = '{$formid}' AND lang.language = '{$language}'
ORDER BY
   elem.elem_sortorder 
```

现在我尝试做类似的事情：

`CONVERT(CAST(trans.trans_description as BINARY) USING latin1) as trans_description,`

强制它隐藏编码，但这根本不会产生结果。

在我得到结果后，它立即被 json_encoded 并返回给用户（Ajax 请求）。我不认为这是 json_encode 做一个`print_r`输出数组会产生同样的问题。

另外.. 最后，我正在构建的系统正在使用 xPDO，所以我也不太确定这是否是问题所在。

编辑：似乎 PHP 正在返回一个正确的值或至少一个值，例如这里是一个`print_r`转储：

```
[trans_label] => Ditt f�rnamn?
[trans_description] => 
[trans_defaultValue] => First Name 
```

因此，似乎当我的 json_encode 触及该字符串时，它会将字符串变为空。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T16:21:03.017

您的 PDO 连接字符串应指定编码。例如：

```
mysql:host=localhost;port=3306;dbname=test;charset=utf8 
```

这控制了*数据库驱动程序*在返回结果时将使用的编码，以及驱动程序假定您的查询所在的编码。如果您不指定它，将使用默认编码。通常默认为`latin1`.

您可以通过在 PHP 中打印数据的十六进制表示来确认这一点[`bin2hex`](http://php.net/manual/en/function.bin2hex.php)： förnamn 中的 ö 被返回为`f6`. 如果文本以 UTF-8 编码，您将获得`c3b6`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T16:35:40.603

您对网页的编码只字未提。
您的页面部分是否有该行`<head>`强制编码为 UTF-8？

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-22T10:11:12.480

我在将字母编码为我的母语*冰岛语*时遇到了问题，但我找到了所有*utf8*字母的相互解决方案。

> right after **mysql_select_db** and before **mysql_query** insert the following:

```
 mysql_query("SET character_set_connection=utf8, 
 character_set_results=utf8, 
 character_set_client=utf8", $con); 
```

Where $con is the connection to mysql

Happy coding..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T07:52:21.420

由于数据类型不兼容，转换后您的答案为空。但是在页面上显示欧洲或阿拉伯字符非常简单。我对阿拉伯语也有同样的问题，但经过几次实验后，它现在可以正常工作了。

如果要在页面上显示那些欧洲字符（jsp、php、html），首先将页面编码设置为 UTF-8，例如：-

> pageEncoding="utf-8"

而且您还需要对 utf-8 字符的数据库连接类进行一些更改

使用下面的代码： -

> jdbc:mysql:your_ipaddress":3306/"+db+"?requireSSL=false&useUnicode=true&characterEncoding=UTF-8

希望它会帮助你。

# requirejs - 需要.js + SignalR

> ID：11478946
> 
> 赞同：5
> 
> 时间：2012-07-13T22:02:00.910
> 
> 标签：requirejs, signalr

在过去的几天里，我一直在使用 Require.JS 和 SignalR，我注意到当我加载我的网站时，有时 SignalR/Hubs 似乎在 jquery 之前加载，尽管我的 require.js 配置似乎是正确的。

这是我的配置：

```
require.config({
    paths: {
        jQuery: 'libs/jquery/jquery',
        Underscore: 'libs/underscore/underscore',
        Backbone: 'libs/backbone/backbone',
        Marionette: 'libs/backbone/backbone.marionette'
    }
});

require([
        'app',
        'order!libs/jquery/jquery-min',
        'order!libs/jQueryUI/jquery-ui-1.8.11.min',
        'order!libs/jqGrid/grid.locale-en',
        'order!libs/jqGrid/jquery.jqGrid.min',
        'order!libs/underscore/underscore-min',
        'order!libs/backbone/backbone-min',
        'order!Marionette',
        'order!libs/jquery.signalR-0.5.1',
        'order!noext!signalr/hubs'
    ], function (app) {
        app.initialize();        
    }); 
```

当这失败时，我在集线器文件的第 16 行收到错误消息。它说`uncaught TypeError: Cannot read property 'signalR' of undefined`。

升级到 V2 并修改了我的配置。

```
var fRequire = require.config({
    paths: {
        jQuery: 'libs/jquery/jquery',
        Underscore: 'libs/underscore/underscore',
        Backbone: 'libs/backbone/backbone',
        Marionette: 'libs/backbone/backbone.marionette',
        sigr: 'libs/jquery.signalR-0.5.1'
    },
    shims: {        
        "libs/jquery.signalR-0.5.1": {
            deps: ["jQuery"]
        },
        "libs/jqGrid/jquery.jqGrid.min": {
            deps: ["jQuery"]
        },
        "libs/jquery/jquery-ui-1.8.19.min": {
            deps: ["jQuery"]
        },
        "libs/jqGrid/grid.locale-en": {
            deps: ["jQuery"]
        },
        "noext!signalr/hubs": {
            deps: ["sigr"]
        }
    }
});

fRequire([
    'app'
], function (app) {
    app.initialize();
}); 
```

现在需要在错误的位置查找 jquery、下划线等...尽管我具体告诉它在哪里查找。也许这与我在使用 v1 配置 require 时遵循旧教程有关。

[http://backbonetutorials.com/organizing-backbone-using-modules/](http://backbonetutorials.com/organizing-backbone-using-modules/)

最后更新：

这是我的工作配置。希望它能帮助像我这样的新手通过这个问题。

```
require.config({
    baseUrl: '/js',
    paths: {
        "jquery": 'libs/jquery/jquery-min',
        "underscore": 'libs/underscore/underscore-min',
        "backbone": 'libs/backbone/backbone-min',
        "marionette": 'libs/backbone/backbone.marionette',
        "sigr": 'libs/jquery.signalR-0.5.1'
    },
    shims: {
        "backbone": {
            deps: ["underscore", "jquery"],
            exports: "Backbone"
        },
        "underscore": {
            deps: ["jquery"]
        },
        "marionette": {
            deps: ["backbone", "jquery"]
        },
        "sigr": {
            deps: ["jquery"]
        },
        "libs/jqGrid/jquery.jqGrid.min": {
            deps: ["jquery"]
        },
        "libs/jquery/jquery-ui-1.8.19.min": {
            deps: ["jquery"]
        },
        "libs/jqGrid/grid.locale-en": {
            deps: ["jquery"]
        },
        "noext!signalr/hubs": {
            deps: ["sigr"]
        }
    }
});

// for future ref, I loaded jquery here because app.js references sigr which requires it.
// without enabling it before the module is loaded sigr would complain jquery was not enabled.
require([
    'libs/domReady',
    'app',
    'jquery'
], function (domReady, app, $) {
    domReady(function () {
        app.initialize();
    });
}); 
```

我必须在函数中加载 jquery（domready、app、$）。如果不这样做，将导致信号器报告无法找到它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T22:13:02.137

如果您使用的是 requirejs 2.x，则可以使用“shims”配置属性。您可以在此处指定不符合 AMD 标准的文件之间的依赖关系，例如 jquery、jqueryui 等。

以您的配置为例：

```
require.config({ 
   paths: { 
      jQuery: 'libs/jquery/jquery', 
      Underscore: 'libs/underscore/underscore', 
      Backbone: 'libs/backbone/backbone', 
      Marionette: 'libs/backbone/backbone.marionette' 
   },
   // specify depedencies
   shim: {
      "libs/jquery.signalR-0.5.1" : {
           deps: ["jQuery"]
       },
       "libs/jqGrid/jquery.jqGrid.min" : {
           deps: ["jQuery"] 
       }
   }
}); 
```

此外，在“shims”中配置依赖项消除了“order！”的使用。插入。

**提示：**使用“paths”为您的系统使用的 api 设置一个友好的名称，因此当该 api 的新版本发布时，您只需更改“paths”即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T02:27:25.770

只是为了跟进所提供的答案以及为什么您仍然必须预先包含 jQuery ... require 的配置设置是“shim”，而不是“shims”。如果没有正确拼写配置设置，Require 将无法识别和预加载指定的依赖项。我最近对此感到震惊并发布了相关信息：http: [//mikeycooper.blogspot.com/2013/01/requirejs-20-dependencies-seemingly.html](http://mikeycooper.blogspot.com/2013/01/requirejs-20-dependencies-seemingly.html)

# android - 仅索尼 SmartWatch 小部件还是小部件和控制扩展？

> ID：11478947
> 
> 赞同：0
> 
> 时间：2012-07-13T22:02:01.610
> 
> 标签：android, sony, sony-smartwatch

作为免费 SmartWatch 促销活动的一部分，我从 Sony 买了一块手表，并为它发布了一个应用程序。它称为 SoundCheck，可通过 Google Play 市场上的 LiveWare 管理器找到。一位客户最近发送了电子邮件寻求支持。他们安装了 Sound Check，但没有在手表上看到它，因为安装时默认情况下未启用小部件。有没有办法在安装应用程序时以编程方式启用小部件？如果小部件默认启用而不是强制他们通过 LiveWare 管理器导航以查找设置，这对用户来说可能会很好。这对于像 Sound Check 这样没有控制扩展的“仅小部件”应用程序非常有帮助。

本周我创建了我的 SmartWatch 应用程序的专业版，以实际更改小部件显示的值。是否可以从小部件扩展中打开控件扩展？这是用例。短按浏览小部件的不同屏幕。我想使用小部件上的长按事件类型来打开控件扩展中的“编辑”功能。这可能吗？

提前感谢您对这些问题的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T07:25:55.307

如何以编程方式启用小部件的问题仍然悬而未决。这是从小部件打开控件的代码。这个答案有帮助： [我应该如何从程序代码启动 SmartWatch Extension？](https://stackoverflow.com/questions/10971674)

```
if (type == Widget.Intents.EVENT_TYPE_SHORT_TAP) {
    updateWidget();
} else {
    //this code will launch the control and allow the user to change volume settings?
    Intent intent = new Intent(Control.Intents.CONTROL_START_REQUEST_INTENT);
    intent.putExtra(Control.Intents.EXTRA_AEA_PACKAGE_NAME, "com.mezcode.soundcheckpro");
    intent.setPackage(mHostAppPackageName);
    mContext.sendBroadcast(intent, Registration.HOSTAPP_PERMISSION);
} 
```

# android - Android ListView 适配器在点击时显示最后一项

> ID：11478951
> 
> 赞同：1
> 
> 时间：2012-07-13T22:02:11.553
> 
> 标签：android, android-listview

我的 ListView 适配器有问题，一切都通过 json 解析到列表视图中就好了，但是当我单击 ListView 时，它总是向我显示 ListView 中最后解析的 json 的结果。

这是我的第一堂课，叫做 Jobs：

```
 public class Jobs extends ListActivity {

// JSON Node names
private static final String jobs = "jobs";
private static final String job = "job";
private static final String pays = "pays";
private static final String ready_at = "ready_at";
private static final String due_by = "due_by";
private static final String customer_reference = "customer_reference";
private static final String pieces = "pieces";
private static final String weight = "weight";
private static final String pickup_name = "pickup_name";
private static final String pickup_addr1 = "pickup_addr1";
private static final String pickup_city = "pickup_city";
private static final String pickup_state = "pickup_state";
private static final String pickup_zip_postal = "pickup_zip_postal";
private static final String deliver_name = "deliver_name";
private static final String deliver_addr1 = "deliver_addr1";
private static final String deliver_city = "deliver_city";
private static final String deliver_state = "deliver_state";
private static final String deliver_zip_postal = "deliver_zip_postal";
private static final String signature_required = "signature_required";
private static final String pickup_to_see = "pickup_to_see";
private static final String pickup_room = "pickup_room";
private static final String pickup_phone = "pickup_phone";
private static final String deliver_to_see = "deliver_to_see";
private static final String deliver_room = "deliver_room";
private static final String pickup_special_instr = "pickup_special_instr";
private static final String deliver_special_instr = "deliver_special_instr";
private static final String deliver_phone = "deliver_phone";

String JOB, PAYS, READY_AT, DUE_BY, CUSTOMER_REFERENCE, PIECES, WEIGHT, PICKUP_NAME, PICKUP_ADDR1, PICKUP_CITY, PICKUP_STATE,
        PICKUP_ZIP_POSTAL, DELIVER_NAME, DELIVER_ADDR1, DELIVER_CITY, DELIVER_STATE, DELIVER_ZIP_POSTAL, SIGNATURE_REQUIRED,
        PICKUP_TO_SEE, PICKUP_ROOM, PICKUP_PHONE, DELIVER_TO_SEE, DELIVER_ROOM, PICKUP_SPECIAL_INSTR, DELIVER_SPECIAL_INSTR,
        DELIVER_PHONE;

// Strings
String username, password, firstName, lastName, lastLatitudeUpdate, dvrcheckin, dvrScheduleToWork, dvrStartTime, jobs_assigned;
int checkedin, Minute, Hour, Minutedvr, Hourdvr, status;

Vibrator vib;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.jobs);
    vib = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);

    new ParseJobs().execute();

    TextView assigned = (TextView) findViewById(R.id.assigned);

    if (jobs_assigned.matches("0")){
    assigned.setText("You have no jobs assigned");
    } else {
        assigned.setVisibility(View.GONE);
    }

    // selecting single ListView item
    ListView lv = getListView();

    // Launching new screen on Selecting Single ListItem
    lv.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long ide) {

            vib.vibrate(40);

            // Starting new intent
            Intent in = new Intent(getApplicationContext(),
                    SingleMenuItemActivity.class);
            in.putExtra(pays, PAYS);
            in.putExtra(job, JOB);
            in.putExtra(ready_at, READY_AT);
            in.putExtra(due_by, DUE_BY);
            in.putExtra(customer_reference, CUSTOMER_REFERENCE);
            in.putExtra(pieces, PIECES);
            in.putExtra(weight, WEIGHT);
            in.putExtra(pickup_name, PICKUP_NAME);
            in.putExtra(pickup_addr1, PICKUP_ADDR1);
            in.putExtra(pickup_city, PICKUP_CITY);
            in.putExtra(pickup_state, PICKUP_STATE);
            in.putExtra(pickup_zip_postal, PICKUP_ZIP_POSTAL);
            in.putExtra(deliver_name, DELIVER_NAME);
            in.putExtra(deliver_addr1, DELIVER_ADDR1);
            in.putExtra(deliver_city, DELIVER_CITY);
            in.putExtra(deliver_state, DELIVER_STATE);
            in.putExtra(deliver_zip_postal, DELIVER_ZIP_POSTAL);
            in.putExtra(signature_required, SIGNATURE_REQUIRED);
            in.putExtra(pickup_to_see, PICKUP_TO_SEE);
            in.putExtra(pickup_room, PICKUP_ROOM);
            in.putExtra(pickup_phone, PICKUP_PHONE);
            in.putExtra(deliver_to_see, DELIVER_TO_SEE);
            in.putExtra(deliver_room, DELIVER_ROOM);
            in.putExtra(pickup_special_instr, PICKUP_SPECIAL_INSTR);
            in.putExtra(deliver_special_instr, DELIVER_SPECIAL_INSTR);
            in.putExtra(deliver_phone, DELIVER_PHONE);

            startActivity(in);
            Jobs.this.overridePendingTransition(R.anim.fadein, R.anim.fadeout);

        }
    });
}

public class ParseJobs extends AsyncTask<Void, Void, Void> {

    // Hashmap for ListView
    ArrayList<HashMap<String, String>> contactList = new ArrayList<HashMap<String, String>>();

    // contacts JSONArray
    JSONArray JOBS;

    ProgressDialog VerifyDriver;

    @Override
    protected void onPreExecute() {

        VerifyDriver = ProgressDialog.show(Jobs.this, "Getting Your Jobs", "Loading Data... Please Wait...");
        WindowManager.LayoutParams lp = VerifyDriver.getWindow().getAttributes();
        VerifyDriver.getWindow().addFlags(WindowManager.LayoutParams.FLAG_DIM_BEHIND);
        lp.dimAmount = .65f;
        VerifyDriver.getWindow().setAttributes(lp);

        Intent i = getIntent();
        username = i.getExtras().getString("uid");
        password = i.getExtras().getString("pwd");
        firstName = i.getExtras().getString("firstName");
        lastName = i.getExtras().getString("lastName");
        lastLatitudeUpdate = i.getExtras().getString("lastLatitudeUpdate");
        Minute = i.getExtras().getInt("Minute");
        Hour = i.getExtras().getInt("Hour");
        dvrcheckin = i.getExtras().getString("check-in");
        Hourdvr = i.getExtras().getInt("Hourdvr");
        Minutedvr = i.getExtras().getInt("Minutedvr");
        status = i.getExtras().getInt("status");
        dvrScheduleToWork = i.getExtras().getString("dvrScheduleToWork");
        dvrStartTime = i.getExtras().getString("dvrStartTime");
        jobs_assigned = i.getExtras().getString("jobs_assigned");
    }

    @Override
    protected Void doInBackground(Void... params) {

        // getting JSON string from URL
        JSONObject json = JSONfunction.getJSONfromURL("http://www.jetdelivery.com/mobile/api/getresourcestatus/?type=json&uid=" + (username) + "&pwd=" + (password));

        try {
            // Getting Array of Contacts
            JOBS = json.getJSONArray(jobs);

            // looping through All Contacts
            for (int i1 = 0; i1 < JOBS.length(); i1++) {
                JSONObject c = JOBS.getJSONObject(i1);

                // Storing each json item in variable
                JOB = c.getString(job);
                PAYS = c.getString(pays);
                READY_AT = c.getString(ready_at);
                DUE_BY = c.getString(due_by);
                DELIVER_PHONE = c.getString(deliver_phone);
                PIECES = c.getString(pieces);
                WEIGHT = c.getString(weight);
                PICKUP_NAME = c.getString(pickup_name);
                PICKUP_ADDR1 = c.getString(pickup_addr1);
                PICKUP_CITY = c.getString(pickup_city);
                PICKUP_STATE = c.getString(pickup_state);
                PICKUP_ZIP_POSTAL = c.getString(pickup_zip_postal);
                DELIVER_NAME = c.getString(deliver_name);
                DELIVER_ADDR1 = c.getString(deliver_addr1);
                DELIVER_CITY = c.getString(deliver_city);
                DELIVER_STATE = c.getString(deliver_state);
                DELIVER_ZIP_POSTAL = c.getString(deliver_zip_postal);
                SIGNATURE_REQUIRED = c.getString(signature_required);
                PICKUP_TO_SEE = c.getString(pickup_to_see);
                PICKUP_ROOM = c.getString(pickup_room);
                PICKUP_PHONE = c.getString(pickup_phone);
                DELIVER_TO_SEE = c.getString(deliver_to_see);
                DELIVER_ROOM = c.getString(deliver_room);
                PICKUP_SPECIAL_INSTR = c.getString(pickup_special_instr);
                DELIVER_SPECIAL_INSTR = c.getString(deliver_special_instr);
                CUSTOMER_REFERENCE = c.getString(customer_reference);

                // creating new HashMap
                HashMap<String, String> map = new HashMap<String, String>();

                // adding each child node to HashMap key => value
                map.put(job, JOB);
                map.put(pays, PAYS);
                map.put(ready_at, READY_AT);
                // map.put(weight, mobile);

                // adding HashList to ArrayList
                contactList.add(map);
            }
        } catch (JSONException e) {
            e.printStackTrace();
        }
        return null;
    }

    @Override
    protected void onPostExecute(Void result) {
        super.onPostExecute(result);

        WindowManager.LayoutParams params = getWindow().getAttributes();
        Jobs.this.getWindow().addFlags(WindowManager.LayoutParams.FLAG_DIM_BEHIND);
        params.x = 0;
        params.height = 520;
        params.width = 480;
        params.y = 200;
        params.dimAmount = .70f;
        Jobs.this.getWindow().setAttributes(params);

        /** Updating parsed JSON data into ListView */
        ListAdapter adapter = new SimpleAdapter(Jobs.this, contactList, R.layout.list_item, new String[] { job, pays, ready_at }, new int[] { R.id.job1, R.id.pays1, R.id.ready_at1 });
        setListAdapter(adapter);

        VerifyDriver.dismiss();

    }
}

@Override
protected void onResume() {
    super.onResume();
    Jobs.this.overridePendingTransition(R.anim.fadein, R.anim.fadeout);
}

@Override
protected void onPause() {
    super.onPause();
    Jobs.this.overridePendingTransition(R.anim.fadein, R.anim.fadeout);

}

@Override
public void onBackPressed() {
    vib.vibrate(40);

    // Send username and password strings into screen1 class
    Intent i = new Intent(Jobs.this, screen1.class);
    i.putExtra("uid", username);
    i.putExtra("pwd", password);
    i.putExtra("Minute", Minute);
    i.putExtra("Hour", Hour);
    i.putExtra("firstName", firstName);
    i.putExtra("lastName", lastName);
    i.putExtra("check-in", dvrcheckin);
    i.putExtra("Hourdvr", Hourdvr);
    i.putExtra("Minutedvr", Minutedvr);
    i.putExtra("status", status);
    i.putExtra("lastLatitudeUpdate", lastLatitudeUpdate);
    i.putExtra("dvrScheduleToWork", dvrScheduleToWork);
    i.putExtra("dvrStartTime", dvrStartTime);
    i.putExtra("jobs_assigned", jobs_assigned);
    Jobs.this.finish();
    startActivity(i);
    Jobs.this.overridePendingTransition(R.anim.fadein, R.anim.fadeout);

}

@Override
protected void onRestart() {
    super.onRestart();
    Intent i = new Intent(this, AgentPortalActivity.class);
    startActivity(i);
    Jobs.this.overridePendingTransition(R.anim.fadein, R.anim.fadeout);

}
} 
```

这是我的第二类，当您单击 ListView 时，它仅显示有关该作业的更多信息：

```
 public class SingleMenuItemActivity extends Activity {

// JSON Node names

private static final String job = "job";
private static final String pays = "pays";
private static final String ready_at = "ready_at";
private static final String due_by = "due_by";
private static final String customer_reference = "customer_reference";
private static final String pieces = "pieces";
private static final String weight = "weight";
private static final String pickup_name = "pickup_name";
private static final String pickup_addr1 = "pickup_addr1";
private static final String pickup_city = "pickup_city";
private static final String pickup_state = "pickup_state";
private static final String pickup_zip_postal = "pickup_zip_postal";
private static final String deliver_name = "deliver_name";
private static final String deliver_addr1 = "deliver_addr1";
private static final String deliver_city = "deliver_city";
private static final String deliver_state = "deliver_state";
private static final String deliver_zip_postal = "deliver_zip_postal";
private static final String signature_required = "signature_required";
private static final String pickup_to_see = "pickup_to_see";
private static final String pickup_room = "pickup_room";
private static final String pickup_phone = "pickup_phone";
private static final String deliver_to_see = "deliver_to_see";
private static final String deliver_room = "deliver_room";
private static final String pickup_special_instr = "pickup_special_instr";
private static final String deliver_special_instr = "deliver_special_instr";
private static final String deliver_phone = "deliver_phone";

String JOB, PAYS, READY_AT, DUE_BY, CUSTOMER_REFERENCE, PIECES, WEIGHT, SIGNATURE_REQUIRED, // General Job Information
PICKUP_NAME,PICKUP_TO_SEE, PICKUP_ROOM, PICKUP_ADDR1, PICKUP_CITY, PICKUP_STATE, PICKUP_ZIP_POSTAL, PICKUP_PHONE, PICKUP_SPECIAL_INSTR, // Pickup Job Information
DELIVER_NAME, DELIVER_ADDR1, DELIVER_CITY, DELIVER_STATE, DELIVER_ZIP_POSTAL, DELIVER_TO_SEE, DELIVER_ROOM,  DELIVER_SPECIAL_INSTR, DELIVER_PHONE,  // Deliver Job Information

username, password, firstName, lastName, lastLatitudeUpdate, dvrcheckin, dvrScheduleToWork, dvrStartTime, jobs_assigned; // Original Strings Passed through from main Activity
int checkedin, Minute, Hour, Minutedvr, Hourdvr, status;    // Integers Passed through from main Activity

Vibrator vib;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.single_menu_item_activity);
    vib = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);

    Get_Intents();

    ////////////////////////////////////////////////////////
    ////////        Initializing all TextViews      ////////
    ////////////////////////////////////////////////////////
    TextView trackno = (TextView) findViewById(R.id.trackno);
    TextView readyAT = (TextView) findViewById(R.id.readyAT);
    TextView jobpays = (TextView) findViewById(R.id.jobpays);
    TextView pcs = (TextView) findViewById(R.id.pcs);
    TextView weightt = (TextView) findViewById(R.id.weightt);
    TextView custref = (TextView) findViewById(R.id.custref);
    TextView dueby = (TextView) findViewById(R.id.dueby);
    TextView sigreq = (TextView) findViewById(R.id.sigreq);

    ///////////////     PickUp TextViews    //////////////////////
    TextView puname = (TextView) findViewById(R.id.puname);
    TextView puaddress = (TextView) findViewById(R.id.puaddress);
    TextView puroom = (TextView) findViewById(R.id.puroom);
    TextView pusee = (TextView) findViewById(R.id.pusee);
    TextView puphone = (TextView) findViewById(R.id.puphone);
    TextView puinstructions = (TextView) findViewById(R.id.puinstructions);

    //////////////      Deliver TextViews       ///////////////////
    TextView delname = (TextView) findViewById(R.id.delname);
    TextView deladdress = (TextView) findViewById(R.id.deladdress);
    TextView delroom = (TextView) findViewById(R.id.delroom);
    TextView delsee = (TextView) findViewById(R.id.delsee);
    TextView delphone = (TextView) findViewById(R.id.delphone);
    TextView delinstructions = (TextView) findViewById(R.id.delinstructions);

    /////////////       Miscellaneous TextViews     /////////////////
    TextView origin = (TextView) findViewById(R.id.origin);
    TextView destination = (TextView) findViewById(R.id.destination);
    origin.setText(Html.fromHtml("<i><u>ORIGIN</u></i> "));
    destination.setText(Html.fromHtml("<i><u>DESTINATION</u></i> "));

    /////////////////////////////////
    // Setting String to TextViews //
    /////////////////////////////////
    trackno.setText(JOB);
    readyAT.setText(READY_AT);
    jobpays.setText(PAYS);
    pcs.setText(PIECES);
    weightt.setText((WEIGHT) + " Lbs");
    custref.setText(CUSTOMER_REFERENCE);
    dueby.setText(DUE_BY);

    ///////// Pickup Info ///////////
    puname.setText(PICKUP_NAME);
    puaddress.setText((PICKUP_ADDR1) + "\n" + (PICKUP_CITY) + " " + (PICKUP_STATE) + " " + (PICKUP_ZIP_POSTAL));
    puroom.setText(PICKUP_ROOM);
    pusee.setText(PICKUP_TO_SEE);
    puphone.setText(PICKUP_PHONE);
    puinstructions.setText(PICKUP_SPECIAL_INSTR);

    ///////// Deliver Info //////////
    delname.setText(DELIVER_NAME);
    deladdress.setText((DELIVER_ADDR1) + "\n" + (DELIVER_CITY) + " " + (DELIVER_STATE) + " " + (DELIVER_ZIP_POSTAL));
    delroom.setText(DELIVER_ROOM);
    delsee.setText(DELIVER_TO_SEE);
    delphone.setText(DELIVER_PHONE);
    delinstructions.setText(DELIVER_SPECIAL_INSTR);

    ////   Fixing String To Display  ////
    //// Yes or No Instead of Y or N ////
    if (SIGNATURE_REQUIRED.matches("Y")){ 
        sigreq.setText("Yes");
    }
    if (SIGNATURE_REQUIRED.matches("N")){   
        sigreq.setText("No");       
    }

    Accept_Job_Button_Instructions();
    Deny_Job_Button_Instructions();

}

private void Deny_Job_Button_Instructions() {
    ///////////////// Deny Button ///////////////////////////////
    Button deny = (Button) findViewById(R.id.deny);
    deny.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View arg0) {

            vib.vibrate(40);
            startActivity(new Intent(SingleMenuItemActivity.this, JobDenied.class));    //SingleMenuItemActivity.this.finish();
            overridePendingTransition(R.anim.fadein, R.anim.fadeout);           
        }           
    });
}

private void Accept_Job_Button_Instructions() {
    ///////////////// Accept Button //////////////////////////////
    Button accept = (Button) findViewById(R.id.accept);
    accept.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            vib.vibrate(40);
        }       
    }); 
}

// First Initialize upon Starting Activity //
private void Get_Intents() {
    // getting intent data
    Intent in = getIntent();

    // Get JSON values from previous intent
    PAYS = in.getStringExtra(pays);
    JOB = in.getStringExtra(job);
    READY_AT = in.getStringExtra(ready_at);
    DUE_BY = in.getStringExtra(due_by);
    CUSTOMER_REFERENCE = in.getStringExtra(customer_reference);
    PIECES = in.getStringExtra(pieces); 
    WEIGHT = in.getStringExtra(weight); 
    SIGNATURE_REQUIRED = in.getStringExtra(signature_required);

    // PickUp Info
    PICKUP_NAME = in.getStringExtra(pickup_name);
    PICKUP_ADDR1 = in.getStringExtra(pickup_addr1);
    PICKUP_CITY = in.getStringExtra(pickup_city);
    PICKUP_STATE = in.getStringExtra(pickup_state);
    PICKUP_ZIP_POSTAL = in.getStringExtra(pickup_zip_postal);
    PICKUP_TO_SEE = in.getStringExtra(pickup_to_see);
    PICKUP_ROOM = in.getStringExtra(pickup_room);
    PICKUP_PHONE = in.getStringExtra(pickup_phone);
    PICKUP_SPECIAL_INSTR = in.getStringExtra(pickup_special_instr);

    //Deliver Info
    DELIVER_NAME = in.getStringExtra(deliver_name);
    DELIVER_ADDR1 = in.getStringExtra(deliver_addr1);
    DELIVER_CITY = in.getStringExtra(deliver_city); 
    DELIVER_STATE = in.getStringExtra(deliver_state);
    DELIVER_ZIP_POSTAL = in.getStringExtra(deliver_zip_postal); 
    DELIVER_TO_SEE = in.getStringExtra(deliver_to_see); 
    DELIVER_ROOM = in.getStringExtra(deliver_room);
    DELIVER_PHONE = in.getStringExtra(deliver_phone);
    DELIVER_SPECIAL_INSTR = in.getStringExtra(deliver_special_instr);

}

@Override
protected void onResume() {
    super.onResume();
    overridePendingTransition(R.anim.fadein, R.anim.fadeout);
}

@Override
protected void onPause() {
    super.onPause();

    overridePendingTransition(R.anim.fadein, R.anim.fadeout);
}

@Override
public void onBackPressed() {

    Intent i = new Intent(SingleMenuItemActivity.this, AgentPortalActivity.class);
    startActivity(i); 
    SingleMenuItemActivity.this.finish();
    overridePendingTransition(R.anim.fadein, R.anim.fadeout);   
}

@Override
protected void onRestart() {
    super.onRestart();
    Intent i = new Intent(this, AgentPortalActivity.class);
    startActivity(i);
    overridePendingTransition(R.anim.fadein, R.anim.fadeout);
    }
} 
```

这里有一些图片可以帮助更好地解释这种情况。 ![工作活动](../Images/0d630cca62aedd23c8c5f9141dcc907c.png)

例如，我点击了 Job no。1642554 在 ListView 中，它会将我发送到下一个活动，但正如您所见，作业编号完全关闭（带有 1642769 的第二张图像实际上是 ListView 中的最后一个作业，并且将始终向我显示最后一个 Listview）

有什么建议么？

以下是我遵循 skUDA 建议后的日志：

```
07-17 08:37:17.158: W/dalvikvm(12096): threadid=1: thread exiting with uncaught exception (group=0x40015578)
 07-17 08:37:17.162: E/AndroidRuntime(12096): FATAL EXCEPTION: main
 07-17 08:37:17.162: E/AndroidRuntime(12096): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.jetdelivery.mobile/com.jetdelivery.mobile.SingleMenuItemActivity}: java.lang.NullPointerException
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at android.app.ActivityThread.access$1500(ActivityThread.java:117)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at android.os.Handler.dispatchMessage(Handler.java:99)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at android.os.Looper.loop(Looper.java:130)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at android.app.ActivityThread.main(ActivityThread.java:3687)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at java.lang.reflect.Method.invokeNative(Native Method)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at java.lang.reflect.Method.invoke(Method.java:507)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at dalvik.system.NativeStart.main(Native Method)
 07-17 08:37:17.162: E/AndroidRuntime(12096): Caused by: java.lang.NullPointerException
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at com.jetdelivery.mobile.SingleMenuItemActivity.onCreate(SingleMenuItemActivity.java:146)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
 07-17 08:37:17.162: E/AndroidRuntime(12096):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
  07-17 08:37:17.162: E/AndroidRuntime(12096): 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:19:23.693

问题是您发送到意图中的字符串（JOB、PAYS、READY_AT、DUE_BY 等）被设置为最后一个，因为那是创建的最后一个视图。尝试

```
Object j = lv.getAdapter().getItem(position); 
```

（其中对象是您的项目的任何数据类型）在您的 onItemClickListener 中，并从那里获取字符串值。

编辑：更详细的细分。

在进一步审查您的代码后，我看到了一个易于实施的解决方案。在您的 doInBackground 方法中，您将每个字符串设置为从 JSONArray 获得的任何内容。由于您通过意图发送这些字符串，因此您最终会得到下载和映射的最后一个作业。我的建议：采用 JSONArray JOBS 并将其声明为 Jobs 类中的字段变量。在这里，您的内部异步类和整个 Jobs 类都可以访问它。现在，将您的 onItemClickListener 更改为：

```
lv.setOnItemClickListener(new OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> parent, View view,
            int position, long ide) {

        vib.vibrate(40);

        // Starting new intent
        try {
        Intent in = new Intent(getApplicationContext(),
                SingleMenuItemActivity.class);
        in.putExtra("jobInfo", JOBS.getJSONObject(position).toString());

        startActivity(in);
        Jobs.this.overridePendingTransition(R.anim.fadein, R.anim.fadeout);
        } catch (Exception e) {
            e.printStackTrace();
        }

    }
}); 
```

BlaineOmega 在质疑您为什么要在意图中添加如此多的额外数据时是正确的。由于您正在使用 JSONObjects，因此只需将 JSONString 发送到您的下一个活动。然后创建一个全局 JSONObject 并在你的 onCreate 中初始化它，如下所示：

```
myJsonJob = new JSONObject(getIntent().getStringExtra("jobInfo")); 
```

现在您可以使用 JSONObject 方法直接访问您的数据，而不是从意图中获取数据并将其存储在字符串变量中，然后使用这些字符串变量设置您的文本视图。（顺便说一句，您几乎可以删除整个字符串变量步骤 no不管你怎么做

```
myTextView.setText(intent.getStringExtra("nameOfString")) 
```

就像，在您的代码中，它将是：

```
trackno.setText(in.getStringExtra(job)). 
```

而不是将字符串分配给变量然后用变量设置它。它减少了内存使用和中间人的额外成本。）

那应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T22:17:41.493

看起来您的`onItemClickListener`. 您输入的意图是发送到显示您的信息的活动 ( `SingleMenuItemActivity`)。在该`onItemClick()`方法中，将位置传递给它。该位置是用户在您的 ListView 中选择的索引。您似乎只是在传递它恰好存储在字符串中的任何值。

# java - SQlite 打印数据库信息

> ID：11478954
> 
> 赞同：0
> 
> 时间：2012-07-13T22:02:49.687
> 
> 标签：java, android, database, sqlite

我刚刚创建了我的第一个数据库，但似乎我以一种奇怪的方式完成了它我创建了一个 adapter.java 和一个如下所示的 activity.java 我想知道如何将数据库信息打印在屏幕上我的尝试失败了。

这是我的活动 Java

```
package com.course.ucas;

import android.app.Activity;
import android.os.Bundle;

public class DatabaseActivity extends Activity {
/** Called when the activity is first created. */

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

DBAdapter db = new DBAdapter(this);
db.open();
long id;
id = db.insertTitle(
"UNIVERSITY OF ABERDEEN","Computer Science",310,84,0,"BBB","");
id = db.insertTitle(
"UNIVERSITY OF ABERTAY DUNDEE","Computer Science",300,0,70,"CCC","N/A");
id = db.insertTitle(
"ABERYSTWYTH UNIVERSITY","Computer Science",270,79,70,"BBC","N/A");
id = db.insertTitle(
"ANGLIA RUSKIN UNIVERSITY","Computer Science",220,69,50,"CCC","N/A");
id = db.insertTitle(
"ASTON UNIVERSITY","Computer Science",330,91,80,"BBB","N/A");
id = db.insertTitle(
"BANGOR UNIVERSITY","Computer Science",260,86,0,"CCC","N/A");
id = db.insertTitle(
"UNIVERSITY OF BATH","Computer Science",440,91,100,"AAA","A*AB");
id = db.insertTitle(
"UNIVERSITY OF BEDFORDSHIRE","Computer Science",120,74,50,"CCD","N/A");
id = db.insertTitle(
"UNIVERSITY OF BIRMINGHAM","Computer Science",400,76,90,"AAB","N/A");
id = db.insertTitle(
"BIRMINGHAM CITY UNIVERSITY","Computer Science",240,68,70,"BCC","N/A");
id = db.insertTitle(
"THE UNIVERSITY OF BOLTON","Computer Science",0,78,0,"CCC","N/A");
id = db.insertTitle(
"UNIVERSITY OF BRADFORD","Computer Science",180,72,50,"CCC","N/A");
id = db.insertTitle(
"UNIVERSITY OF BRIGHTON","Computer Science",270,80,69,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF BRISTOL","Computer Science",480,96,95,"AAA","N/A");
id = db.insertTitle(
"THE UNIVERSITY OF BUCKINGHAM","Computer Science",0,0,0,"BBC","N/A");
id = db.insertTitle(
"BUCKINGHAMSHIRE NEW UNIVERSITY","Computer Science",150,61,55,"CCD","N/A");
id = db.insertTitle(
"UNIVERSITY OF CAMBRIDGE","Computer Science",580,95,100,"A*AA","N/A");
id = db.insertTitle(
"CANTERBURY CHRIST CHURCH UNIVERSITY","Computer Science",170,81,45,"CCC","N/A");
id = db.insertTitle(
"CARDIFF UNIVERSITY","Computer Science",360,79,82,"ABB","N/A");
id = db.insertTitle(
"CARDIFF METROPOLITAN UNIVERSITY","Computer Science",200,93,55,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF CENTRAL LANCASHIRE","Computer Science",240,75,74,"CCC","BBC");
id = db.insertTitle(
"UNIVERSITY OF CHESTER","Computer Science",240,86,75,"CCC","N/A");
id = db.insertTitle(
"THE CITY UNIVERSITY","Computer Science",320,65,73,"AAA","N/A");
id = db.insertTitle(
"COVENTRY UNIVERSITY","Computer Science",230,67,65,"BBC","N/A");
id = db.insertTitle(
"THE UNIVERSITY OF CUMBRIA","Computer Science",0,0,0,"CCC","N/A");
id = db.insertTitle(
"DE MONTFORT UNIVERSITY","Computer Science",230,80,58,"AAA","N/A");
id = db.insertTitle(
"UNIVERSITY OF DERBY","Computer Science",260,73,70,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF DUNDEE","Computer Science",336,96,85,"BBB","N/A");
id = db.insertTitle(
"DURHAM UNIVERSITY","Computer Science",440,81,100,"AAA","N/A");
id = db.insertTitle(
"UNIVERSITY OF EAST ANGLIA","Computer Science",320,89,55,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF EAST LONDON","Computer Science",205,74,39,"CDD","N/A");
id = db.insertTitle(
"UNIVERSITY OF EDINBURGH","Computer Science",428,90,85,"AAA","ABB");
id = db.insertTitle(
"EDINBURGH NAPIER UNIVERSITY","Computer Science",260,83,58,"CCD","N/A");
id = db.insertTitle(
"UNIVERSITY OF ESSEX","Computer Science",315,84,75,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF EXETER","Computer Science",0,86,95,"ABB","N/A");
id = db.insertTitle(
"UNIVERSITY OF GLAMORGAN / PRIFYSGOL MORGANNWG","Computer Science",280,69,52,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF GLASGOW","Computer Science",384,98,90,"ABB","N/A");
id = db.insertTitle(
"GLASGOW CALEDONIAN UNIVERSITY","Computer Science",258,80,51,"CC","N/A");
id = db.insertTitle(
"UNIVERSITY OF GLOUCESTERSHIRE","Computer Science",220,73,71,"CCC","N/A");
id = db.insertTitle(
"GLYNDWR UNIVERSITY","Computer Science",200,75,70,"CCC","N/A");
id = db.insertTitle(
"GOLDSMITHS' COLLEGE","Computer Science",220,83,70,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF GREENWICH","Computer Science",180,89,54,"BBC","N/A");
id = db.insertTitle(
"HERIOT-WATT UNIVERSITY","Computer Science",288,77,90,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF HERTFORDSHIRE","Computer Science",180,80,62,"CDD","N/A");
id = db.insertTitle(
"UNIVERSITY OF THE HIGHLANDS AND ISLANDS","Computer Science",0,0,0,"D","N/A");
id = db.insertTitle(
"UNIVERSITY OF HUDDERSFIELD","Computer Science",240,63,84,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF HULL","Computer Science",240,83,95,"BBC","N/A");
id = db.insertTitle(
"IMPERIAL COLLEGE, LONDON","Computer Science",510,84,98,"AAA","N/A");
id = db.insertTitle(
"KEELE UNIVERSITY","Computer Science",260,74,0,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF KENT","Computer Science",310,80,90,"BBB","N/A");
id = db.insertTitle(
"KING'S COLLEGE LONDON","Computer Science",370,82,90,"AAB","N/A");
id = db.insertTitle(
"KINGSTON UNIVERSITY","Computer Science",200,73,68,"BBC","N/A");
id = db.insertTitle(
"LANCASTER UNIVERSITY","Computer Science",380,81,80,"ABB","N/A");
id = db.insertTitle(
"UNIVERSITY OF LEEDS","Computer Science",370,69,90,"AAA","N/A");
id = db.insertTitle(
"LEEDS METROPOLITAN UNIVERSITY","Computer Science",180,71,57,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF LEICESTER","Computer Science",330,92,80,"ABB","N/A");
id = db.insertTitle(
"UNIVERSITY OF LIVERPOOL","Computer Science",360,89,80,"AAB","ABB");
id = db.insertTitle(
"LIVERPOOL HOPE UNIVERSITY","Computer Science",280,78,40,"ABB","N/A");
id = db.insertTitle(
"UNIVERSITY COLLEGE LONDON","Computer Science",430,87,90,"A*AA","N/A");
id = db.insertTitle(
"LONDON METROPOLITAN UNIVERSITY","Computer Science",140,73,55,"ABB","N/A");
id = db.insertTitle(
"LOUGHBOROUGH UNIVERSITY","Computer Science",340,88,88,"ABB","N/A");
id = db.insertTitle(
"THE UNIVERSITY OF MANCHESTER","Computer Science",400,82,83,"AAB","N/A");
id = db.insertTitle(
"THE MANCHESTER METROPOLITAN UNIVERSITY","Computer Science",220,67,66,"CCC","N/A");
id = db.insertTitle(
"MIDDLESEX UNIVERSITY","Computer Science",140,73,50,"CDD","N/A");
id = db.insertTitle(
"NEWCASTLE UNIVERSITY","Computer Science",350,88,90,"ABB","N/A");
id = db.insertTitle(
"THE UNIVERSITY OF NORTHAMPTON","Computer Science",200,75,60,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF NORTHUMBRIA","Computer Science",240,80,77,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF NOTTINGHAM","Computer Science",360,82,90,"BBB","N/A");
id = db.insertTitle(
"NOTTINGHAM TRENT UNIVERSITY","Computer Science",260,69,68,"BBC","N/A");
id = db.insertTitle(
"OXFORD UNIVERSITY","Computer Science",520,0,90,"AAA","N/A");
id = db.insertTitle(
"OXFORD BROOKES UNIVERSITY","Computer Science",260,85,85,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF PLYMOUTH","Computer Science",260,76,75,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF PORTSMOUTH","Computer Science",240,81,72,"BBC","N/A");
id = db.insertTitle(
"QUEEN'S UNIVERSITY BELFAST","Computer Science",320,84,84,"BBB","N/A");
id = db.insertTitle(
"QUEEN MARY, UNIVERSITY OF LONDON","Computer Science",300,88,65,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF READING","Computer Science",350,79,95,"ABB","N/A");
id = db.insertTitle(
"THE ROBERT GORDON UNIVERSITY","Computer Science",240,79,80,"CCC","N/A");
id = db.insertTitle(
"ROYAL HOLLOWAY, UNIVERSITY OF LONDON","Computer Science",320,82,0,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF SALFORD","Computer Science",240,89,75,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF SHEFFIELD","Computer Science",390,83,95,"ABB","N/A");
id = db.insertTitle(
"SHEFFIELD HALLAM UNIVERSITY","Computer Science",240,73,73,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF SOUTHAMPTON","Computer Science",450,92,95,"AAA","N/A");
id = db.insertTitle(
"SOUTHAMPTON SOLENT UNIVERSITY","Computer Science",240,68,85,"CDD","N/A");
id = db.insertTitle(
"STAFFORDSHIRE UNIVERSITY","Computer Science",240,70,78,"CDD","N/A");
id = db.insertTitle(
"UNIVERSITY OF ST ANDREWS","Computer Science",458,90,0,"AAB","N/A");
id = db.insertTitle(
"UNIVERSITY OF STIRLING","Computer Science",255,100,65,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF STRATHCLYDE","Computer Science",333,97,90,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF SUNDERLAND","Computer Science",225,59,70,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF SURREY","Computer Science",380,89,90,"AAB","N/A");
id = db.insertTitle(
"UNIVERSITY OF SUSSEX","Computer Science",360,84,85,"ABB","BBB");
id = db.insertTitle(
"SWANSEA UNIVERSITY","Computer Science",280,82,75,"ABB","N/A");
id = db.insertTitle(
"TEESSIDE UNIVERSITY","Computer Science",260,78,64,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF ULSTER","Computer Science",237,73,63,"BBB","N/A");
id = db.insertTitle(
"UNIVERSITY OF WALES: TRINITY SAINT DAVID","Computer Science",0,77,0,"CDD","N/A");
id = db.insertTitle(
"UNIVERSITY OF WALES, NEWPORT","Computer Science",230,81,50,"CDD","N/A");
id = db.insertTitle(
"UNIVERSITY OF WARWICK","Computer Science",480,87,100,"AAB","N/A");
id = db.insertTitle(
"UNIVERSITY OF THE WEST OF ENGLAND, BRISTOL","Computer Science",240,74,84,"BBB","N/A");
id = db.insertTitle(
"THE UNIVERSITY OF WEST LONDON","Computer Science",0,37,0,"CDD","N/A");
id = db.insertTitle(
"THE UNIVERSITY OF WESTMINSTER","Computer Science",180,54,63,"CCC","AA");
id = db.insertTitle(
"UNIVERSITY OF THE WEST OF SCOTLAND","Computer Science",238,69,52,"BBC","N/A");
id = db.insertTitle(
"UNIVERSITY OF WOLVERHAMPTON","Computer Science",150,70,61,"CCD","N/A");
id = db.insertTitle(
"UNIVERSITY OF WORCESTER","Computer Science",210,65,55,"CCC","N/A");
id = db.insertTitle(
"UNIVERSITY OF YORK","Computer Science",460,91,100,"AAA","N/A");

   db.close();

}

} 
```

这是我的数据库适配器

```
package com.course.ucas;

import android.app.Activity;
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class DBAdapter {
public static final String KEY_ROWID = "_id";
public static final String KEY_UNIVERSITY = "University";
public static final String KEY_COURSE = "Course";   
public static final String KEY_UCAS = "UCAS";
public static final String KEY_SATISFACTION = "Student_Satisfaction";
public static final String KEY_EMPLOYED = "Employed";
public static final String KEY_OFFER = "Offer";
public static final String KEY_OTHER = "Other";
private static final String TAG = "DBAdapter";
private static final String DATABASE_NAME = "UCAS";
private static final String DATABASE_TABLE ="computer";
private static final int DATABASE_VERSION = 1;
private static final String DATABASE_CREATE =
"create table titles (_id integer primary key autoincrement, "
+ "University text not null, Course text not null, UCAS int not null, "
+ "Student Satisfaction int not null, Employed int not null, Offer text not null, Other text not null);";
private final Context context;
private DatabaseHelper DBHelper;
private SQLiteDatabase db;
public DBAdapter(Context ctx)
{
this.context = ctx;
DBHelper = new DatabaseHelper(context);
}
private static class DatabaseHelper extends SQLiteOpenHelper
{
DatabaseHelper(Context context)
{
super(context, DATABASE_NAME, null, DATABASE_VERSION);
}
@Override
public void onCreate(SQLiteDatabase db)
{
db.execSQL(DATABASE_CREATE);
}
@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion,
int newVersion)
{
Log.w(TAG, "Upgrading database from version " + oldVersion
+ " to "
+ newVersion + ", which will destroy all old data");
db.execSQL("DROP TABLE IF EXISTS titles");
onCreate(db);
}
}
public DBAdapter open() throws SQLException
{
db = DBHelper.getWritableDatabase();
return this;
}
//---closes the database---
public void close()
{
DBHelper.close();
}
//---insert a title into the database---
public long insertTitle(String university, String other, int i, int j,int k, String UCAS, String employed)
{
ContentValues initialValues = new ContentValues();
initialValues.put(KEY_UNIVERSITY, university);
initialValues.put(KEY_COURSE, j);
initialValues.put(KEY_UCAS , UCAS);
initialValues.put(KEY_SATISFACTION, k);
initialValues.put(KEY_EMPLOYED , employed);
initialValues.put(KEY_OFFER , i);
initialValues.put(KEY_OTHER , other);
return db.insert(DATABASE_TABLE, null, initialValues);
}
//---deletes a particular title---
public boolean deleteTitle(long rowId)
{
return db.delete(DATABASE_TABLE, KEY_ROWID +
"=" + rowId, null) > 0;
}
//---retrieves all the titles---
public Cursor getAllTitles()
{
return db.query(DATABASE_TABLE, new String[] {
KEY_ROWID,
KEY_UNIVERSITY,
KEY_COURSE,
KEY_UCAS ,
KEY_SATISFACTION,
KEY_EMPLOYED,
KEY_OFFER,
KEY_OTHER,
},
null,
null,
null,
null,
null);
}
//---retrieves a particular title---
public Cursor getTitle(long rowId) throws SQLException
{
Cursor mCursor =
db.query(true, DATABASE_TABLE, new String[] {
KEY_ROWID,
KEY_UNIVERSITY,
KEY_COURSE,
KEY_UCAS,
KEY_SATISFACTION,
KEY_EMPLOYED,
KEY_OFFER,
KEY_OTHER,
},
KEY_ROWID + "=" + rowId,
null,
null,
null,
null,
null);
if (mCursor != null) {
mCursor.moveToFirst();
}
return mCursor;
}
//---updates a title---
public boolean updateTitle(long rowID, String university, String other, int i, int j,int k, String UCAS, String employed)
{
ContentValues args = new ContentValues();
args.put(KEY_UNIVERSITY, university);
args.put(KEY_COURSE, i);
args.put(KEY_UCAS , UCAS);
args.put(KEY_SATISFACTION, j);
args.put(KEY_EMPLOYED , employed);
args.put(KEY_OFFER , k);
args.put(KEY_OTHER , other);
return db.update(DATABASE_TABLE, args,
KEY_ROWID + "=" + rowID, null) > 0;
}

} 
```

有谁知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:20:56.503

好吧，首先你的适配器代码必须是正确的。您仍在尝试从您从未创建的表中插入和查询。

您需要将 DATABASE_TABLE 字符串更改为“titles”**或**将 DATABASE_CREATE 字符串更改为使用“computer”而不是“titles”。

一旦你解决了，你需要一个光标来提取数据，然后你可以手动使用光标来获取数据或将其提供给 ListView。

我建议去开发者网站阅读数据库、游标和 ListBiews。实际上，我建议总体上阅读 Android。

# sql - 你如何在sql中的一行中按列排序？

> ID：11478956
> 
> 赞同：0
> 
> 时间：2012-07-13T22:03:00.440
> 
> 标签：sql, sqlite

假设我有一张看起来像这样的桌子

```
ATT A | ATT B
-------------
A     | B
D     | C
E     | F
H     | G 
```

相反，我想要一个看起来像这样的表：

```
ATT A | ATT B
-------------
A     | B
C     | D
E     | F
G     | H 
```

我该怎么做呢？我正在使用 SQLite。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T23:06:41.013

SQL Server 有一个`case .. end`表达式，您可以在 SQL 语句中使用内联表达式。我认为 SQLite 使用相同的语法。这可以满足您在 SQL Server 中的要求：

```
create table #temp (AttA char(1), AttB char(1))

insert into #temp valueS ('A', 'B'), ('D', 'C'), ('E', 'F'), ('H', 'G')

select * from #temp

select case when AttA < AttB then AttA else AttB end as AttA,
       case when AttB > AttA then AttB else AttA end as AttB
from   #temp

drop table #temp 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T07:36:01.467

假设列具有相同的类型并且您只有 2 列要重新排序，您可以依赖 min/max 函数。使用 sqlite，当提供多个参数时，这些函数不会聚合来自多行的数据。

```
create table mytable( ATTA char, ATTB char );
insert into mytable values ('A', 'B');
insert into mytable values ('D', 'C');
insert into mytable values ('E', 'F');
insert into mytable values ('H', 'G') ;

select min(ATTA,ATTB),max(ATTA,ATTB) from mytable order by 1,2 ;
A|B
C|D
E|F
G|H 
```

min/max 函数对列中的值重新排序。order by 子句对行重新排序。我认为它不能推广到超过 2 列，除非通过编写一个用户定义的 C 函数从 sqlite 调用。

# c++ - 如何在本机活动中创建 OpenGL ES 2 上下文？

> ID：11478957
> 
> 赞同：10
> 
> 时间：2012-07-13T22:03:02.287
> 
> 标签：c++, opengl-es, android-ndk, egl

在我的一生中，我找不到任何适用于 OpenGL ES 2 的纯 Android NDK 示例。包含的`native-activity`示例项目构建了一个 ES 1 上下文。是否有任何示例程序演示了在纯 C++ 中创建 ES 2 上下文？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-13T23:13:41.777

创建 OpenGL ES 2 上下文应该与创建 OpenGL ES 1 大致相同。基于 NDK 中的“native-activity”示例，您只需将其添加到传递给的属性列表中`eglChooseConfig`：

```
const EGLint attribs[] =
{
    EGL_RENDERABLE_TYPE, EGL_OPENGL_ES2_BIT,
    ...
    EGL_NONE
}; 
```

这应该确保您的配置与 ES2 兼容。

然后将此属性列表传递给`eglCreateContext`：

```
EGLint AttribList[] = 
{
    EGL_CONTEXT_CLIENT_VERSION, 2,
    EGL_NONE
}; 
```

用这样的电话：

```
context = eglCreateContext(display, config, NULL, AttribList); 
```

# scala - Scala AKKA Actor 的错误消息

> ID：11478960
> 
> 赞同：7
> 
> 时间：2012-07-13T22:03:09.560
> 
> 标签：scala, akka

这是我的代码：

```
class testActor extends Actor   {
    var test = "test2"
    def receive = {
            case "test" ⇒
                    "works"
    }
} 

def test = Action {
    var test = "test"
    val system = ActorSystem("MySystem")
    val myActor = system.actorOf(Props[testActor.testActor], name = "testActor")

    test = Await.result(myActor ? "test", Duration(1, TimeUnit.SECONDS))
} 
```

我收到这条线的错误：

```
test = Await.result(myActor ? "test", Duration(1, TimeUnit.SECONDS)) 
```

错误是：

找不到参数超时的隐式值：akka.util.Timeout

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-13T22:20:31.103

添加类似的东西`implicit val timeout = Timeout(5 seconds)`。见[http://doc.akka.io/docs/akka/2.0.1/scala/futures.html](http://doc.akka.io/docs/akka/2.0.1/scala/futures.html)

顺便说一句，你还需要改变

```
def receive = {
        case "test" ⇒ sender ! "works"
} 
```

和

```
test = Await.result(myActor ? "test", timeout.duration).asInstanceOf[String] 
```

# c++ - typedef 名称可以用于声明或定义构造函数吗？

> ID：11478962
> 
> 赞同：15
> 
> 时间：2012-07-13T22:03:20.883
> 
> 标签：c++, language-lawyer

### 标准语：

[class.ctor] 12.1/1 说

> 特殊的声明符语法用于声明或定义构造函数。语法使用：
> 
>     — 一个可选的*decl-specifier-seq*，其中每个*decl-specifier*是*函数说明符*或**constexpr**，
> 
>     — 构造函数的类名，以及
> 
>     — 参数列表
> 
> 以该顺序。

[class.name] 9.1/4 说

> 命名类类型或其 cv 限定版本的*typedef-name (7.1.3) 也是**class-name*。如果在需要类名的地方使用命名 cv 限定类类型的*typedef* - *name* ，则忽略 cv 限定符。*typedef-name*不应用作 *class-head*中的*标识符*。

 ***[expr.prim.general] 5.1.1/8 还说

> 在使用*class-name* :: *class-name*的地方，并且两个 class-name 引用同一个类，此符号命名构造函数（12.1）。

* * *

### 应用：

在我看来，这似乎是说应该允许使用 typedef 名称声明构造函数（尽管 12.1/1 不使用斜体*class-name*）。

例如，给定：

```
struct Foo;
typedef Foo Bar; 
```

然后

```
struct Foo { Bar() {} }; // defines Foo's constructor. - 1 
```

或者改为给出

```
struct Foo;
struct Foo { Foo() };
typedef Foo Bar; 
```

然后

```
Foo::Bar() {}; // defines Foo's constructor - 2 
```

或者

```
Bar::Bar() {}; // defines Foo's constructor - 3 
```

或者

```
Bar::Foo() {}; // defines Foo's constructor - 4 
```

这些都应该是合法的。但是似乎没有人接受定义 2 或 3，MSVC 接受 1，MSVC、clang 和 gcc 都接受 4。

我的分析是否正确，所有这些编译器都错了吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-13T22:15:21.527

[工作草案 N3337（2012 年 2 月）第](http://open-std.org/JTC1/SC22/WG21/docs/papers/2012/n3337.pdf)12.1/3 条规定

> *typedef-name*不应用作构造函数声明的*declarator-id*中的*类名。*

 *这排除了（1）。

§12.1/1 似乎对声明和定义都使用了“声明”一词：

> 特殊的声明符语法用于声明或定义构造函数。[…] 在这样的声明中，[…]

（没有明确提到“定义”）。我认为这是否适用于类外定义或仅适用于内联定义有点不清楚。如果它适用于所有类型的定义，这也将排除（2）和（3）。(4) 在任何情况下都应该是合法的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-09T07:29:06.220

令人讨厌的是，它似乎在 Microsoft C 中有效，但在我使用的其他编译器中无效。特别是在模板中需要时。也许我不知道这样做的“标准兼容方式”，但它在模板中真的很有用。

```
template<class T, class T1, ... /* messy, verbose */ >
class MyTemplate {
protected:
    typedef MyTemplate<T,T1, ... /* messy, verbose */ > SimplerName;

    // declare a constructor
    SimplerName(int arg) { ... }
};
class SubClass
    : public MyTemplate<x,y....>
{
public:
    SubClass(int arg) : SimplerName(arg) { ... }
}. 
```

也许另一个问题这在 GCC、Clang 等中不起作用，有没有办法在其他编译器中做到这一点？****

# javascript - Javascript：在 IE 上使用 .map() 时遇到问题

> ID：11478963
> 
> 赞同：1
> 
> 时间：2012-07-13T22:03:24.590
> 
> 标签：javascript, jquery, internet-explorer, map

此代码在 Chrome、FFX 等上运行良好。它采用文本区域的内容并将不同数组项中的所有行分开（新行由空数组项表示）。在 IE 上测试它时，它会引发错误。代码：

这是tregex 的值和调用：

```
var tregex = /\n|([^\r\n.!?]+([.!?]+|$))/gim;

var source = $('#text').val().match(tregex).map($.trim); 
```

由于**.map()**（仅限 IE） ，代码会抛出此错误消息

> 用户代理：Mozilla/4.0（兼容；MSIE 8.0；Windows NT 5.1；Trident/4.0；.NET CLR 2.0.50727；.NET CLR 3.0.4506.2152；.NET CLR 3.5.30729）时间戳：2012 年 7 月 13 日星期五 21：世界标准时间 52:48
> 
> 消息：对象不支持此属性或方法行：128 字符：6 代码：0 URI： http: [//mydomain.com/src/common.js](http://mydomain.com/src/common.js)

为什么？有什么方法可以在 IE7+ 上支持它？（这是在 IE8 上测试的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:06:57.287

IE 是一个糟糕的浏览器，因此没有内置的地图功能（至少在 IE7-8 中没有）。由于您试图在正则表达式匹配的结果上调用 map（而不是在 jQuery 结果对象上调用它），所以您可以使用的唯一 map 是内置的 map（IE 没有）。

然而，有许多库可以为您模拟地图，包括 jQuery、Underscore 和 Mochikit。

这是一个如何使用 jQuery 来做你想做的事情的例子：

```
$.map($('#text').val().match(tregex), $.trim); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T22:15:44.723

我相信您的代码可能会意外地在 FF 和 Chrome 中运行。你的意思是使用`jQuery.map`？您正在使用`Array.map`9 之前的 IE 不支持的。

考虑以下作为替代。

```
var source = $.map($('#text').val().match(tregex), $.trim); 
```

这使用 jQuery 的 map 实现来循环并进行修剪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T22:06:11.680

我相当肯定`Array.map()`只添加在 IE9 中。您应该手动循环遍历数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T22:10:48.907

您可以通过为其添加[垫片](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/map)来添加支持：

```
// Production steps of ECMA-262, Edition 5, 15.4.4.19
// Reference: http://es5.github.com/#x15.4.4.19
if (!Array.prototype.map) {
  Array.prototype.map = function(callback, thisArg) {

    var T, A, k;

    if (this == null) {
      throw new TypeError(" this is null or not defined");
    }

    // 1\. Let O be the result of calling ToObject passing the |this| value as the argument.
    var O = Object(this);

    // 2\. Let lenValue be the result of calling the Get internal method of O with the argument "length".
    // 3\. Let len be ToUint32(lenValue).
    var len = O.length >>> 0;

    // 4\. If IsCallable(callback) is false, throw a TypeError exception.
    // See: http://es5.github.com/#x9.11
    if ({}.toString.call(callback) != "[object Function]") {
      throw new TypeError(callback + " is not a function");
    }

    // 5\. If thisArg was supplied, let T be thisArg; else let T be undefined.
    if (thisArg) {
      T = thisArg;
    }

    // 6\. Let A be a new array created as if by the expression new Array(len) where Array is
    // the standard built-in constructor with that name and len is the value of len.
    A = new Array(len);

    // 7\. Let k be 0
    k = 0;

    // 8\. Repeat, while k < len
    while(k < len) {

      var kValue, mappedValue;

      // a. Let Pk be ToString(k).
      //   This is implicit for LHS operands of the in operator
      // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.
      //   This step can be combined with c
      // c. If kPresent is true, then
      if (k in O) {

        // i. Let kValue be the result of calling the Get internal method of O with argument Pk.
        kValue = O[ k ];

        // ii. Let mappedValue be the result of calling the Call internal method of callback
        // with T as the this value and argument list containing kValue, k, and O.
        mappedValue = callback.call(T, kValue, k, O);

        // iii. Call the DefineOwnProperty internal method of A with arguments
        // Pk, Property Descriptor {Value: mappedValue, Writable: true, Enumerable: true, Configurable: true},
        // and false.

        // In browsers that support Object.defineProperty, use the following:
        // Object.defineProperty(A, Pk, { value: mappedValue, writable: true, enumerable: true, configurable: true });

        // For best browser support, use the following:
        A[ k ] = mappedValue;
      }
      // d. Increase k by 1.
      k++;
    }

    // 9\. return A
    return A;
  };      
} 
```

您还可以在[IE7-8](https://github.com/kriskowal/es5-shim/)中包含添加的 es5shim`.map`和所有其他缺少的数组方法以及其他商品，例如`Function#bind`

# c# - 在 C# 中实现可更新的记录集

> ID：11478964
> 
> 赞同：4
> 
> 时间：2012-07-13T22:03:35.027
> 
> 标签：c#, sql, sql-server, ado.net, recordset

在 C# 中实现可更新记录集需要什么？想想什么可用于 Sql CE，但可以为 Sql Server 等其他工具实现。记录集类是否基本上实现了 99% 的功能，并且只需要一些修补来添加它，或者这会是一项艰巨的任务吗？也许使用 Mono 的一些代码并对其进行扩展？

仅供参考，.net 1.1 的早期测试版之一（如果我的版本正确的话）确实实现了这一点，但后来由于害怕滥用而被删除。有效的担忧，但在某些情况下肯定会很方便。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T19:26:17.787

没有可用于模拟通过*实时连接*生成和更新的*可滚动游标的组件。*并且出于一些非常好的理由，这些理由远没有被滥用。其中最重要的一点是它对SQL Server 上的资源的使用**非常糟糕。**

 ***是的，`SqlDataReader`确实提供了查询的*快进*和*只读*版本。此外，阅读器一次只检索一行，并在整个时间内保持连接打开。这允许您获取非常大的结果集并将资源留在 SQL Server 上，而且您可以非常快速地完成此操作。

但是，可以很容易地模拟将***实时反馈反馈到 SQL Server 的过程。***为此，我将推荐[Dapper](http://code.google.com/p/dapper-dot-net/)，原因有两个：

1.  它的性能是无与伦比的。
2.  它重量***很***轻，易于使用。

### 让我们先保持简单...

首先让我们从一个非常简单的例子开始，假设我有一个表：

```
CREATE TABLE Foo (
    ID INT PRIMARY KEY IDENTITY(1, 1),
    Field1 FLOAT,
    Field2 VARCHAR(50)
) 
```

所以现在让我们从 中获取一些数据`Foo`，但在此之前我们需要一个简单的模型将其放入：

```
public class Foo
{
    public int ID { get; set; }
    public float Field1 { get; set; }
    public string Field2 { get; set; }
} 
```

现在我们只需要获取一些数据：

```
using Dapper;

...

public void ReadFoo()
{
    IDbConnection conn = new SqlConnection("[some connection string]");
    conn.Open();
    var list = conn.Query<Foo>("SELECT * FROM Foo");

    // and now you have a list of Foo objects you can iterate against
} 
```

### 现在让我们更新数据吧？

好的，现在我们知道如何使用 Dapper***获取***数据，让我们看看如何模拟**实时**流到数据库，是吗？所以首先让我们构建一个基类：

```
public class DapperModelBase
{
    public abstract string PKField { get; }

    protected void OnPropertyValueChanged(string propertyName, object val)
    {
        var sql = string.Format("update {0} set {1} = @value where {2} = @id",
            this.GetType().Name,
            propertyName,
            this.PKField);

        IDbConnection conn = new SqlConnection("[some connection string]");
        conn.Execute(sql, new
            {
                value = val,
                id = this.GetType().GetProperty(this.PKField).GetValue(this, null)
            });
    }
} 
```

所以现在我们需要修改`Foo`类只是一个小插曲：

```
public class Foo
{
    // implement the abstract property
    public string PKField { get { return "ID"; } }
    public int ID { get; set; }

    private float _field1;
    public float Field1
    {
        get { return _field1; }
        set
        {
            _field1 = value;
            OnPropertyValueChanged("Field1", value);
        }
    }

    private string _field2;
    public string Field2
    {
        get { return _field2; }
        set
        {
            _field2 = value;
            OnPropertyValueChanged("Field2", value);
        }
    }
} 
```

因此，现在当我们在迭代时更新可编辑属性时，我们会发回命令以使其成为*实时*提要：

```
// and now you have a list of Foo objects you can iterate against
foreach (var foo in list)
{
    ...
    ...
    foo.Field1 = 123f; // sends an update
    ...
    ...
    foo.Field2 = "Hello World!" // sends an update
} 
```

现在，让我们更进一步，假设您返回的结果集是***巨大的***，当我说我的意思是***100 的 MB 时。***好吧，Dapper 也可以处理这个问题，只需更改从以下位置获取数据的行：

```
var list = conn.Query<Foo>("SELECT * FROM Foo"); 
```

至：

```
var list = conn.Query<Foo>("SELECT * FROM Foo", buffered: false); 
```

但没有其他改变！***

# php - 高性能展示跟踪

> ID：11478966
> 
> 赞同：4
> 
> 时间：2012-07-13T22:03:46.813
> 
> 标签：php, solr, redis, gearman

基本上，我想跟踪的一些指标的一部分是某些对象在我们的营销平台上获得的展示量。如果您想象我们展示了很多对象，我们希望在每次提供对象时进行跟踪。

每个对象都通过单个网关/接口返回给客户端。因此，如果您想象一个请求进入一个带有一些搜索条件的页面，然后搜索请求被代理到我们的 Solr 索引。

然后我们得到 10 个结果。

这 10 个结果中的每一个都应该被视为一个印象。

我正在努力寻找一个令人难以置信的快速和准确的实现。

关于如何做到这一点的任何建议？你可以投入任意数量的技术。我们目前使用的是 Gearman、PHP、Ruby、Solr、Redis、Mysql、APC 和 Memcache。

最终所有的印象最终都应该保存到 mysql 上，我可以每小时做一次。但我不确定如何在不影响实际搜索请求的加载时间的情况下快速将印象存储在内存中。

# 想法（我刚刚添加了选项 4 和 5）

1.  一旦结果返回给客户端，客户端就会在我们的平台上请求一个 base64 编码的 URI，该 URI 包含它们所服务的所有对象的 ID。然后将此对象传递给 gearman，然后将计数保存到 redis。每小时一次，redis 被刷新，并且计数是 mysql 中每个对象的增量。

2.  从 Solr 返回结果后，循环并直接保存到 Redis。（尚未对此进行速度基准测试）。每隔一小时重复一次对 mysql 的刷新。

3.  从 Solr 返回项目后，将单个作业中的所有 ID 发送给 gearman，然后将其提交给 Redis..

4.  **新想法**由于返回的项目数量最多约为 20，我可以设置一个 X-Application-Objects 标头，其中包含返回的 ID 的 base64 标头。然后，这些 ID（在标头中）可以被 nginx 剥离，并使用自定义 LUA nginx 模块，我可以将 ID 从 nginx 直接写入 Redis。不过，这可能有点矫枉过正。这样做的好处是我可以告诉 nginx 在写入 redis 时立即返回响应对象。

5.  **新思路**用于`fastcgi_finish_request()`将请求刷新回 nginx，然后将结果插入 Redis。

6.  还有其他建议吗？

## 编辑回答问题：

这些数据的可靠性并不重要。只要是最好的猜测。我不希望看到 30% 的展示次数下降。但我会允许 10% -/+ 的精度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T15:43:22.070

我认为您的两个最佳选择是：

1.  使用 increment 命令我 redis 在你拉 dis 时增加计数器。使用 Id 作为键并在 Redis 中递增。Redis 每秒可以轻松处理数十万个增量，因此速度应该足够快，不会对客户端产生任何明显的影响。如果 PHP 语言绑定支持它，您甚至可以对每个请求进行管道传输。我认为确实如此。

2.  使用 redis 作为普通缓存。在此选项中，您只需使用 Redis 列表并执行包含由例如分隔的 ID 的字符串的 rpush。一个逗号。您可以使用一天中的小时作为键。然后，您可以有一个单独的进程通过抓取前一个小时并按您想要的方式将其按摩到 MySQL 中来将其拉出。我希望您在密钥上设置一个过期时间，您可以在一段时间后将它们清除，或者只是通过后处理过程删除密钥。

如果你有非常高的 redis 流量，或者只是想卸载它并获得它的备份作为奖励，你也可以使用读取从属来导出到 MySQL。如果这样做，您可以将主 redis 实例设置为不刷新到磁盘，从而提高写入性能。

有关更广泛地使用 redis 的功能进行此类跟踪的一些其他选项，请参阅[此答案](https://stackoverflow.com/questions/11441293/incrementing-hundreds-of-counters-at-once-redis-or-mongodb/11456332#11456332 "这个答案")您还可以避免 MySQL 部分并从 redis 中提取数据，从而使整个系统更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T02:08:30.583

我会执行 #2 之类的操作，然后将数据交给您可以更新 Redis 计数器的最快队列。我对 Gearman 不是很熟悉，但我敢打赌这很慢。如果您的 Redis 客户端支持异步写入，我会使用它，或者将它放在单独线程的队列中。您不想在等待更新计数器时减慢响应速度。

# php - 从表单和复选框更新 sql 数据

> ID：11478967
> 
> 赞同：0
> 
> 时间：2012-07-13T22:03:49.167
> 
> 标签：php, html, sql

我创建了一个更新 sql 列中数据的表单，到目前为止一切都很好。我遇到的问题是我想用复选框选择要更新的列。所以我想将两个文件归类为电影，我只需选中复选框并在表单中写入电影。

但它不仅如此。每列都已连接到一个复选框，但我将此复选框与删除查询一起使用，因此我可以删除多行。

所以我的问题更像是，如何将这两个功能与“一个”复选框结合起来。

这是我的一些代码。

这是我的带有 sql 输出和删除按钮的表

```
<?php  
$files = mysql_query("SELECT * FROM files WHERE `user_name` = '{$_SESSION['username']}' ORDER BY `file_time` DESC LIMIT $start, $per_page")
    or die(mysql_error()); 
    ?>
<table id="table-3">
 <thead>
        <tr>
            <th scope="col">Upload User</th>
            <th scope="col">Filename</th>
            <th scope="col">Upload date</th>
             <th scope="col">IP adress</th>
             <th scope="col">Category</th>
            <th scope="col">Delete</th>
        </tr>
    </thead>
<?php
while (($row = mysql_fetch_assoc( $files )) !==false)
{ 
echo "<tr>"; 
echo "<td>".$row['user_name'] . "</td> ";
?>
<td class="download"> <a href="download.php?file_id=<?php echo $row ['file_id']; ?>"> <?php echo $row['file_name']; ?></a></td>
<?php echo "<td>".$row['file_time'] . "</td> "; ?>
<?php echo "<td>".$row['file_ip'] . "</td> "; ?>
<?php echo "<td>".$row['category'] . "</td> "; ?>
<td>

<form action="delete.php" method="post">
<input type="checkbox" name="done[]" id="<?php echo $row['file_id'] ?>" value="<?php echo $row['file_id'] ?>">

</td>

<?php 
}
    echo "</tr>";
    echo "</table>"; 
 ?>
<input type ="submit" value ="Delete">
</form> 
```

此表格是具有更新功能的表格

```
 <form action="function.php" method="post">
category: <input type="text" name="category" />
<input type="submit" />
</form> 
```

和function.php

```
include('core/inc/init.inc.php');

    if(isset($_POST['category'])){
    $category = $_POST['category'];
    mysql_query("UPDATE files SET category='$category'
    /*WHERE category='genom' */ ");

    header("Location: profile.php?uid=" . $_SESSION['uid']);
    }else{
    header("Location: profile.php?uid=" . $_SESSION['uid']);
    }; 
```

如何结合这两个功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:13:13.000

您可以在同一个表单中有多个提交按钮。所以你可以做这样的事情：

```
<?php  
    $files = mysql_query("SELECT * FROM files WHERE `user_name` = '{$_SESSION['username']}' ORDER BY `file_time` DESC LIMIT $start, $per_page")
    or die(mysql_error()); 
?>
<form action="updateordelete.php" method="post">
    <table id="table-3">
        <thead>
            <tr>
                <th scope="col">Upload User</th>
                <th scope="col">Filename</th>
                <th scope="col">Upload date</th>
                <th scope="col">IP adress</th>
                <th scope="col">Category</th>
                <th scope="col">Delete</th>
            </tr>
        </thead>
        <?php
        while (($row = mysql_fetch_assoc( $files )) !==false)
        {
        ?>
        <tr>
            <td> <?php echo $row['user_name']; ?></td>
            <td class="download"> <a href="download.php?file_id=<?php echo $row ['file_id']; ?>"> <?php echo $row['file_name']; ?></a></td>
            <td><input type="text" name="file_time[<?php echo $row ['file_id']; ?>]" value="<?php echo $row['file_time']; ?>" /></td>
            <td><input type="text" name="file_ip[<?php echo $row ['file_id']; ?>]" value="<?php echo $row['file_ip']; ?>" /></td>
            <td><input type="text" name="file_category[<?php echo $row ['file_id']; ?>]" value="<?php echo $row['category']; ?>" /></td>
            <td><input type="checkbox" name="done[]" id="<?php echo $row['file_id'] ?>" value="<?php echo $row['file_id'] ?>"></td>
        </tr>
        <?php } ?>
    </table>
    <input type ="submit" name="submittype" value = "Update">
    <input type ="submit" name="submittype" value = "Delete">
</form> 
```

然后，在 updateordelete.php 中：

```
if($_POST['submittype']=="Delete"){
   (do delete code...)
}elseif($_POST['submittype']=="Update"){
   (do update code...)
} 
```

对于每个值，您可以使用 $_POST['file_category'] 访问它们。例如：

```
$file_categories=$_POST['file_category'];
foreach($_POST['done'] as $file_id){
    echo $file_categories[$file_id];
} 
```

# hudson - Jenkins/Hudson 上传到 Testflight

> ID：11478976
> 
> 赞同：3
> 
> 时间：2012-07-13T22:04:35.813
> 
> 标签：hudson, jenkins, hudson-plugins, jenkins-plugins

我有一份 jenkins 工作，使用 xcode 来构建我的 ipa 文件。这一切都很好。现在我只是将营销版本设置为`${BUILD_ID}`，技术版本设置为`${BUILD_NUMBER}`. 我还指定了发布配置，并且我的工作设置为将 ipa 文件存档为构建后操作。我相信这些设置组合会导致我生成的 IPA 文件如下所示：

```
Target-Configuration-BUILD_NUMBER.ipa 
```

因此，如果我的目标被命名为 BillyBob 并且这是第 23 次成功构建，我生成的 .ipa 文件是：`BillyBob-Release-23.ipa`

我想设置一个作业或构建后操作，以便在成功构建时将我的文件上传到 testflight。

我不知道将 testflight API 的文件参数设置为什么，以便它始终找到最新的构建文件，我认为没有可用的通配符，或者如果有我不知道如何设置它.

最初，当我没有将技术版本设置为构建的一部分时，我只是将它指向`-1.0.ipa`它正在创建的文件的版本，并且可以很好地上传。

我尝试过使用 jenkins 的 testflight 插件和 curl shell 脚本命令。

我还要指出，我不是 iOS 开发人员，我只是试图通过设置自动构建来帮助该项目，所以我对如何生成该文件的猜测可能还很遥远。

***更新所以看起来这个当前的开放问题是我正在寻找的 [詹金斯问题部分](https://issues.jenkins-ci.org/browse/JENKINS-13929?page=com.atlassian.jira.plugin.system.issuetabpanels%3achangehistory-tabpanel)

现在，我只是让我的工作指定一个输出路径，它是我上传到 testflight 工作的工作区。

它看起来像在 Testflight 应用程序中，如果您没有为 IPA 文件指定任何内容，它会在该作业的工作区目录中查找一个。因此，我可能还可以向 testflight 插件发出请求，以允许您在 IPA 设置中指定路径并让它在该路径中找到当前不起作用的 .ipa 文件。

如果我更擅长编写脚本，我可能还可以在 shell 命令中使用 curl 命令上传到 testflight 来处理它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T06:18:39.590

在 Jenkins 中将这些字段留空为我修复了它。

> 如果您未指定 ipa/dsym 文件，则会在工作区中自动搜索它们。

如您所见：

```
https://wiki.jenkins-ci.org/display/JENKINS/Testflight+Plugin
Version 1.3.1 (Jan 12 2012)
* Default IPA upload 
```

# vb.net - vbnet mdi子控件+选项卡

> ID：11478978
> 
> 赞同：0
> 
> 时间：2012-07-13T22:04:42.430
> 
> 标签：vb.net, shortcut, mdi, mdichild

我在 mdiParent 中有几个孩子，我知道可以使用 Control+Tab 快捷方式在孩子之间进行更改，但问题是：

如果你在表格A并且你使用快捷方式，你会进入表格B，但是当你再次使用快捷方式时，你会进入表格C。它不会回到我一开始的表格A，似乎唯一的返回的方法是使用 Control+Shift+Tab 快捷方式，但是当您打开更多 mdichilds 时，它会变得有点混乱。

```
1 formA > Control+Tab > formB
2 formB > Control+Tab > formC
2 formB > Control+Shitft+Tab > formA 
```

我想知道是否有办法恢复到我原来的形式，例如使用 Alt+Tab 更改窗口时。

此外，当您使用 Control+Tab 进行更改时，是否有任何方法可以显示一个带有已打开子项列表的小弹出窗口。

# objective-c - 核心数据：从获取的结果中获取随机行

> ID：11478980
> 
> 赞同：0
> 
> 时间：2012-07-13T22:04:47.147
> 
> 标签：objective-c, core-data, count

我正在寻找一种内存有效的方法来从获取结果集中只获取一行。这必须是随机的。

我想使用`[context countForFetchRequest:fetch error:nil];`并获得一个介于 0 和那个之间的 int 随机值，然后将 offset + 限制为 1 个结果。但我找不到它是否没有为它计数的每个项目分配内存。

“计数”是轻量级操作吗？还是需要先在上下文中实例化对象才能对它们进行计数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:18:17.347

[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html#//apple_ref/doc/uid/TP30001182-SW5)有些不清楚，但它包含“给定获取请求将返回的对象数”这一短语。此外，Core Data 倾向于使事情变得`count`非常轻量 - 例如，实体实例允许您调用`count`以找出一对多关系结束时的对象数量，而无需实例化所有这些对象或触发该错误。我会说去吧，但你自己分析一下——不要过早地优化！

# mongodb-.net-driver - 在对集合进行一定数量的插入后，与远程主机 MongoDB 的连接中断

> ID：11478983
> 
> 赞同：1
> 
> 时间：2012-07-13T22:05:07.217
> 
> 标签：mongodb-.net-driver

我将 Mongo DB v2.1.2 托管在远程服务器上。插入 58070 条记录后，我更频繁地收到以下消息异常消息 =“向服务器发送请求时发生传输级错误。（提供者：TCP 提供者，错误：0 - 远程强制关闭现有连接主机。）”我没有用完远程服务器上的 DB 文件夹中的内存。一次插入的数量是否有任何限制。我还为各种 Mongo 异常提供了准备，因此它不是 mongo 异常，只是远程连接断开。当我重新运行时，连接会在同一条记录上断开。当我把它放在我的本地 mongo 实例上时，它没有问题。
可能的原因是什么？

# mysql - 为什么不建议在 SQL 中使用“LIKE”？

> ID：11478995
> 
> 赞同：0
> 
> 时间：2012-07-13T22:06:46.553
> 
> 标签：mysql, sql

最近有人告诉我，不建议在 SQL 中使用“LIKE”关键字。这是真的？如果是，为什么？如果是真的，还有其他选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T22:17:19.367

原因主要是性能。然而，另一方面，LIKE 是标准 SQL，应该适用于所有数据库。因为 LIKE 必须解析模式字符串，所以它比在较长的字符串中查找子字符串（使用 charindex 或 instr 或您的数据库最喜欢的函数）效率要低一些。然而，处理器是如此之快，以至于现在这几乎没有什么不同，除了可能是最大的查询。

LIKE 的一个注意事项是在 join 语句中（替代方案也是如此）。通常，数据库引擎不会在连接中为 LIKE 使用索引。因此，如果您可以用一种对索引更友好的方式来表达 join 子句，那么您可能会看到性能的大幅提升。

顺便说一句，我是一个使用 SQL 语言的老手，并且倾向于避免亲自使用它。然而，这不是一个应该传承的习惯，因为已经没有什么基础可以避免了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T22:24:26.423

特别是在 MySQL 中（因为它有一个 MySQL 标记，我猜这就是你正在使用的），当在具有索引的列上使用 LIKE 时，你应该小心不要在你匹配的字符串前面放一个 % 如果你不'不必，因为它会扼杀使用Index进行高效查找的可能性，否则使用LIKE是没有问题的。例如

坏的：

```
col_with_index LIKE '%someText' 
```

好的：

```
col_with_index LIKE 'someText%' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:21:35.710

没有正当理由不使用like！！！

唯一的例外是您可以使用 EQUAL(=) 运算符来获得相同的结果（my_column LIKE 'XYZ'）。

如果您需要使用 LIKE 任何其他替代方法来实现相同的结果，则应该会导致相同（甚至更多）的性能问题！

因此，在这些情况下，请考虑是否需要使用 like，然后毫不犹豫地使用它。

# r - 在 R 中提取归一化特征向量

> ID：11478997
> 
> 赞同：2
> 
> 时间：2012-07-13T22:06:53.660
> 
> 标签：r

我有以下代码：

```
test <- ca.jo(x, type='trace', ecdet='const', K=2) 
```

当我写摘要（测试）时，会发生：

特征向量，归一化到第一列：（这些是协整关系）

```
 gld.l2     gdx.l2
    gld.l2  1.000000  1.0000000
    gdx.l2 -1.488325 -0.1993057 
```

我怎样才能调用这些归一化的特征向量？

当我在写作

```
slot(test, "Vorg") 
```

我只得到以下数据

```
 gld.l2       gdx.l2
    gld.l2 -0.01346063 -0.012380092
    gdx.l2  0.02003378  0.002467422 
```

但我想调用标准化的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T22:15:12.473

```
data(denmark)
sjd <- denmark[, c("LRM", "LRY", "IBO", "IDE")]
sjd.vecm <- ca.jo(sjd, ecdet = "const", type="eigen", K=2, spec="longrun",
                  season=4)
sm <- summary(sjd.vecm)
sm@V
            LRM.l2     LRY.l2     IBO.l2     IDE.l2   constant
LRM.l2    1.000000  1.0000000  1.0000000   1.000000  1.0000000
LRY.l2   -1.032949 -1.3681031 -3.2266580  -1.883625 -0.6336946
IBO.l2    5.206919  0.2429825  0.5382847  24.399487  1.6965828
IDE.l2   -4.215879  6.8411103 -5.6473903 -14.298037 -1.8951589
constant -6.059932 -4.2708474  7.8963696  -2.263224 -8.0330127 
```

你可能想检查`str(sm)`更多。