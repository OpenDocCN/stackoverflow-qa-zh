# StackOverflow 问答 11261000-11261999

# android - 如何设置适用于 Android 的 Google Cloud Messaging？

> ID：11261000
> 
> 赞同：11
> 
> 时间：2012-06-29T11:30:51.937
> 
> 标签：android, push-notification, google-cloud-messaging

我正在尝试`Google Cloud Messaging for Android (GCM)`按照[演示来实现](http://developer.android.com/guide/google/gcm/demo.html)

但我无法执行一些命令，如`$ ant war`, `$ android update project --name GCMDemo -p . --target android-16`。

我正在使用`wamp server`并针对 Android 8+

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T18:36:17.587

如果要执行`$ant war`命令：

1.  首先，您需要在您的计算机上下载并安装[Apache Ant 。](http://ant.apache.org/)
2.  然后你应该像[这里](http://ant.apache.org/manual/index.html)描述的那样配置你的 PATH 和 JAVA_HOME 变量（进入“安装 Apache Ant”部分）。
3.  只有在那之后，您才能`ant war`在 Windows 命令行（提示符）中执行命令。之后将创建`ant war`命令文件。`.war`
4.  例如，您可以在 Tomcat 服务器上部署和运行您的`.war`文件。（创建 Java EE 项目，然后下载并安装 tomcat 服务器，配置路径，并在 tomcat 服务器上运行您的项目...）

# google-docs-api - Google Doc 重复条目同步问题

> ID：11261001
> 
> 赞同：1
> 
> 时间：2012-06-29T11:30:53.033
> 
> 标签：google-docs-api

我正在开发将用户 Google 文档同步到本地数据库的 c++ 桌面应用程序。

应用程序通过发送 HTTP 请求（使用 curl 发送 HTTP 请求）将 Google 文档和电子表格检索到本地请求 [https://docs.google.com/feeds/default/private/full](https://docs.google.com/feeds/default/private/full)

在这里，我们将每个 Google 文档 resource_id 和其他元信息保留在数据库中以供下次同步使用。

完成初始同步后，从下一次同步开始发送以下 HTTP 请求以获取唯一更新的资源

[https://docs.google.com/feeds/default/private/full?updated-min=Value](https://docs.google.com/feeds/default/private/full?updated-min=Value) 这里 updated-min 是以前的 XML updated-min 值

此处在处理标识 Google 文档的资源时，会根据之前保存的 Google 文档“resource-id”值更新或不更新。

如果当前和以前的“resource_id”（从数据库中检索）相同，则认为更新为新的。因为根据 Google Doc API，“resource_id”是 Google 文档的唯一标识符。

实际上响应应该只包含在“updated-min”时间之后修改的新/更新资源。

这个逻辑直到现在（差不多一年）都运行良好，现在突然在我们的数据库中看到同一个 Google 文档的重复条目。（注意到它在 Google Drive 推出后开始出现）。

此外，同一 Google 文档的所有重复条目都有不同的资源 ID，因此我们将每个条目都视为新条目导致相同 Google 文档的重复条目。

“resource_id”是识别资源唯一性的正确属性。

你能帮我们解决这个问题吗

问候 Subbi Reddy

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T23:36:29.247

该字段`resource_id`是唯一标识存储在 Google 文档中的文件的正确字段，但是，您应该使用更改提要来同步数据，而不是依赖于`updated-min`值：

[https://developers.google.com/google-apps/documents-list/#detecting_changes_to_resources](https://developers.google.com/google-apps/documents-list/#detecting_changes_to_resources)

此外，最近发布的 Drive API 第 2 版实现了相同的功能，我建议更新您的应用以使用它而不是 Documents List API：

[https://developers.google.com/drive/manage-changes](https://developers.google.com/drive/manage-changes)

# linq-to-sql - 如何使用文本框 c# asp.net linq 到 sql 的值在 onece 更新 gridview 中的列

> ID：11261003
> 
> 赞同：0
> 
> 时间：2012-06-29T11:31:05.943
> 
> 标签：linq-to-sql, gridview

我有一个从 linq 到 sql 查询的 gridview，我想用文本框中的值更新这个 gridview 的列。在这个 gridview 中有一些有折扣的产品，我在 linq to sql 查询中选择了一些产品，然后我想更改他们的折扣。我在文本框中插入新的折扣，然后按“保存更改”按钮，我想用新的折扣更新产品的折扣。我的代码：

```
 protected void btnDisplay_Click(object sender, ImageClickEventArgs e)
    {
        OrdersDataContext contex = new OrdersDataContext();

        var query2 = from d in contex.Discounts
                     join r in contex.Registrations on d.id_reg equals r.id
                     join pr in contex.Products on d.id_prod equals pr.id
                     join p in contex.pTs on pr.pId equals p.id
                     join dim in contex.dimTs on p.dimId equals dim.id
                     join t in contex.typeTs on dim.typeId equals t.id
                     join c in contex.codeTs on t.codeId equals c.id
                     where (r.fullname == txtCompName.Text && r.password == txtpass.Text && c.code == TextBox1.Text && t.type == TextBox2.Text && dim.dimension == TextBox3.Text) 
                     select new
                     {
                         CompanyName = r.fullname,
                         Article = pr.article,
                         Description = pr.description,
                         Price = pr.price,
                         Discount = d.discounts
                     };

       GridViewDiscounts.DataSource = query2.ToList();
       GridViewDiscounts.DataBind();

    }

    protected void btnSave_Click(object sender, ImageClickEventArgs e)
    {
        OrdersDataContext contex = new OrdersDataContext();

        if (GridViewDiscounts.Rows.Count != 0)
        {
            foreach (GridViewRow row in GridViewDiscounts.Rows)
            {
               //here is my problem!!!!
            }
        }

        ClearDetails();
        string Msg = "<script>alert('Data updated successfully!');</script>";
        ScriptManager.RegisterClientScriptBlock(this, typeof(Page), "alert", Msg, false);
    }

} 
```

}

任何人都可以帮助我吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T10:59:03.027

我解决了，这是答案：

```
protected void btnSave_Click(object sender, ImageClickEventArgs e)
{
    OrdersDataContext contex = new OrdersDataContext();
    var query = from d in contex.Discounts
    join r in contex.Registrations on d.id_reg equals r.id
    join pr in contex.Products on d.id_prod equals pr.id
    join p in contex.pTs on pr.pId equals p.id
    join dim in contex.dimTs on p.dimId equals dim.id
    join t in contex.typeTs on dim.typeId equals t.id
    join c in contex.codeTs on t.codeId equals c.id
    where (r.fullname == txtCompName.Text && r.password == txtpass.Text && c.code == TextBox1.Text && t.type == TextBox2.Text && dim.dimension == TextBox3.Text)
    select new
    {
        prodId = d.id_prod,
        regId = d.id_reg,
        discount = d.discounts
    };
    foreach (var data in query)
    {
        TextBox4.Text = String.Join(Environment.NewLine, data.prodId);
        TextBox5.Text = String.Join(Environment.NewLine, data.regId);
        Discount dis = contex.Discounts.Single(d => d.id_prod == Int32.Parse(TextBox4.Text) && d.id_reg == Int32.Parse(TextBox5.Text));
        dis.discounts = txtnewdiscount.Text;
    }
    contex.SubmitChanges();
    RefreshGrid();
    string Msg = "<script>alert('Data updated successfully!');</script>";
    ScriptManager.RegisterClientScriptBlock(this, typeof(Page), "alert", Msg, false);
} 
```

# c# - 如何在 DataGrid 控件中加载表格？

> ID：11261006
> 
> 赞同：1
> 
> 时间：2012-06-29T11:31:16.583
> 
> 标签：c#, wpf, linq-to-sql

当我尝试将表格加载到 DataGrid 控件中时，它显示以下错误

> 无法将类型“TRAINING.Employee”隐式转换为“System.Collections.IEnumerable”。存在显式转换（您是否缺少演员表？）。

下面的代码我写的

```
MyDatatBaseDataContext MyDB = new MyDatatBaseDataContext();
Employee Add = new Employee();
Add.EmpID = 5039;
Add.Age = 25;
Add.Address = "West Street";
MyDB.Employees.InsertOnSubmit(Add);
MyDB.SubmitChanges();

grd_1.ItemsSource =Add; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:37:09.423

我认为您应该将网格绑定到员工列表，如下所示：

```
List<Employee> lst = new List<Employee>();
Emplyee emp1 = new Employee();
lst.Add(emp1);
grid.ItemsSource = lst; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T11:39:26.557

该`ItemsSource`属性需要是`IEnumerable`某种类型。

因此，如果您将代码的结尾更改为...

```
IEnumerable<Employee> adds = new [] { Add };
grd_1.ItemsSource = adds; 
```

这可能会有所帮助，但您是否真的想使用网格来显示一个员工，每个属性都有一个列？您真的想要每个属性的名称值对网格吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T11:42:57.353

可能你只需要设置

```
grd_1.ItemsSource = MyDB.Employees; 
```

因为您的[`Table<TEntity>`](http://msdn.microsoft.com/en-us/library/bb358844.aspx)员工是`IEnumerable`. 我不确定添加的项目是否会立即显示，但我认为最迟它会在 SubmitChanges 之后显示。

# jquery - 对象对象没有方法

> ID：11261009
> 
> 赞同：4
> 
> 时间：2012-06-29T11:31:34.117
> 
> 标签：jquery, nomethoderror

这里有一个疯狂的问题。

不能真正粘贴代码，所以这更像是一个理论问题

我首先包含了 jquery，然后是我所有的 jquery 插件

所有插件都加载为每个内部的一个已删除的 console.log 以显示它已链接。

但是在每个插件尝试使用它时它都会返回

```
Uncaught TypeError: Object [object Object] has no method 'PLUGIN FUNCTION' 
```

理论上会发生什么

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-02T15:25:30.263

正确答案似乎是...

我不知何故调用了 jQuery 两次，所以 jQuery 的第二次启动正在卸载所有以前加载的插件。

# java - 与 ListSelectionListener 相关

> ID：11261015
> 
> 赞同：1
> 
> 时间：2012-06-29T11:32:09.933
> 
> 标签：java, swing, jtable, listselectionlistener

我使用 ListSelectionListener 来监听 JTable 的选择，以执行与表中所选项目相关的其他任务。但是为什么下面的代码在开始时在一个选择中执行了两次，而在更新该表之后又执行了多次？

```
 public void valueChanged(ListSelectionEvent e) 
    System.out.println(tablelist.getSelectedIndex());       
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:46:45.160

因为ListSelectionModel[接口中的](http://docs.oracle.com/javase/7/docs/api/javax/swing/ListSelectionModel.html)[ListSelectionListene](http://docs.oracle.com/javase/tutorial/uiswing/events/listselectionlistener.html) r总是触发两个事件

```
int firstIndex = e.getFirstIndex();
int lastIndex = e.getLastIndex(); 
```

[Oracle 教程](http://docs.oracle.com/javase/tutorial/uiswing/events/listselectionlistener.html)中的所有内容

# python - python list中如何实现数据搜索

> ID：11261017
> 
> 赞同：1
> 
> 时间：2012-06-29T11:32:14.707
> 
> 标签：python, python-2.7

我是 python 的新手，我需要一些指导。遍历以下列表的最佳方法是什么。

```
[('admincases', 'test_case_6'), ('admincases', 'test_case_8'),('admincases1', 'test_case_8'),('admincases1', 'test_case_9'),('admincases1', 'test_case_10')] 
```

首先，我想获得所有 admincases 的唯一值，例如：

```
['admincases', 'admincases1'] 
```

然后遍历上述案例，我应该得到指定案例的测试列表：

```
'admincase'
  ['test_case_6', 'test_case_8']
'admincase1'
  ['test_case_8', 'test_case_9', 'test_case_10'] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:36:10.027

使用[默认字典](http://docs.python.org/release/2.5.2/lib/defaultdict-examples.html)

```
>>> from collections import defaultdict
>>> d = defaultdict(list)
>>> l = [('admincases', 'test_case_6'), ('admincases', 'test_case_8'),('admincases1', 'test_case_8'),('admincases1', 'test_case_9'),('admincases1', 'test_case_10')]
>>> for k,v in l:
...    d[k].append(v)
... 
>>> d['admincases']
['test_case_6', 'test_case_8'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T11:35:52.957

```
>>> itertools.groupby(L, key=operator.itemgetter(0))
<itertools.groupby object at 0x7fb79740aa48>
>>> list(itertools.groupby(L, key=operator.itemgetter(0)))
[('admincases', <itertools._grouper object at 0x7fb797405a10>), ('admincases1', <itertools._grouper object at 0x7fb797405a50>)]
>>> [(x[0], list(x[1])) for x in itertools.groupby(L, key=operator.itemgetter(0))]
[('admincases', [('admincases', 'test_case_6'), ('admincases', 'test_case_8')]), ('admincases1', [('admincases1', 'test_case_8'), ('admincases1', 'test_case_9'), ('admincases1', 'test_case_10')])] 
```

不过，请确保您的输入首先按键排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T11:34:09.230

```
>>> lis= [('admincases', 'test_case_6'), ('admincases', 'test_case_8'),('admincases1', 'test_case_8'),('admincases1', 'test_case_9'),('admincases1', 'test_case_10')]

>>> lis1=list({x[0] for x in lis}) #returns ['admincases', 'admincases1']

>>> dic={y:[x[1] for x in lis if x[0]==y]for y in lis1}
>>> dic
{'admincases': ['test_case_6', 'test_case_8'], 'admincases1': ['test_case_8', 'test_case_9', 'test_case_10']} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T11:57:41.890

这是@BurhanKhalid 解决方案的另一种方法，使用`dict.setdefault`而不是`defaultdict`. 我更喜欢`defaultdict`，但如果默认值不需要很长时间来构建，这显然会更快。

```
>>> L = [('admincases', 'test_case_6'), ('admincases', 'test_case_8'),('admincases1', 'test_case_8'),('admincases1', 'test_case_9'),('admincases1', 'test_case_10')]
>>> D = {}
>>> for k,v in L:
        D.setdefault(k,[]).append(v)

>>> D['admincases']
['test_case_6', 'test_case_8'] 
```

# certificate - 如何通过多行主题行查找证书或在命令行中

> ID：11261018
> 
> 赞同：0
> 
> 时间：2012-06-29T11:32:19.773
> 
> 标签：certificate, x509certificate

我曾经为某些命令行工具（例如`certmgr.exe`或`FindPrivateKey.exe`等）提供证书名称。

`certmgr -del -r LocalMachine -s TrustedPeople -c -n "CN=localhost"` 我这种情况下的主题只有一个喜欢`"CN=localhost"`。

现在的问题是我得到了一个多行主题的证书。

![在此处输入图像描述](../Images/10c58614e9a587c0582f678fe5068ba6.png)

如何在命令行中给出那个长的多行主题名称

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T11:37:28.017

主题不是多行的。它根本不是一个字符串。主题是具有多个字段的复杂结构。出于演示目的，将此结构呈现为字符串。通常接受主题作为字符串的工具会解析用逗号分隔的字段，例如。`"CN=XXX, OU=YYY ZZZ, C=US"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-07T14:42:01.100

主题是字段值对的集合，例如 CN、Country、State 等。

当 cmd 提示您插入时，您可以运行此命令将其一个接一个地插入

> openssl req -x509 -nodes -days 365 -newkey rsa:1024 -keyout mycert.pem -out mycert.pem

否则，要直接将其插入命令行，而不必每次都在提示符下输入，您可以运行此命令

> openssl req -x509 -nodes -days 365 -subj "/C=CA/ST=ON/L=Toronto/CN=www.thetechdown.blogspot.ca" -newkey rsa:1024 -keyout mycert.pem -out mycert.pem

# performance - SQL Server 2008 R2 镜像性能

> ID：11261019
> 
> 赞同：1
> 
> 时间：2012-06-29T11:32:21.453
> 
> 标签：performance, sql-server-2008-r2, sql-server-2012, database-mirroring

我们在生产和故障转移服务器上有一个 SQL Server 2008 R2。不设置为集群。大约有 30 个数据库消耗大约 70GB 磁盘空间。数据库文件以稳定的速度增长，大约每月 5GB。

两台服务器都有 48GB RAM，其中大部分专用于 SQL Server。

计划在生产服务器和故障转移服务器之间设置镜像。

镜像是否存在我们应该注意的性能问题？这会减慢生产服务器上的查询响应时间吗？

与 SQL Server 2012 类似的问题。在 SQL Server 2012 上镜像（通过 Always On）性能有什么经验吗？

谢谢阿比

# java - 包含键（列表 键）和获取（列表 key ) 对 Map 数据结构的操作

> ID：11261020
> 
> 赞同：0
> 
> 时间：2012-06-29T11:32:24.263
> 
> 标签：java

在我目前的项目中，我用 Java 实现了以下数据结构。

```
Map<List<String>, Set<Subscriber>> regionSubscriber 
= new Hashtable<List<String>, Set<Subscriber>>(); 
```

我想对上述数据结构实现以下操作。

1）检查该映射中是否存在密钥（类似于`containsKey(Key)`）。2) 获取带键列表的集合（类似于`get(key)`）。

我尝试过使用 Map 的默认功能，例如`containskey(Key)`和`get(Key)`。但是，它们不起作用，因为这里的键是列表（不是单个对象）。

你能就这些行动的实施给我建议吗？让我知道如果您需要更多详细信息以便清楚起见。

* * *

更新：我编写了以下 equals() 和 hashCode() 函数。请检查这些功能。他们不工作。对这些功能的任何更正。

```
public boolean equals(Object obj){
        boolean booleanFlag = false;
        List<String> regionID = (List<String>) obj;
        for(int i=0; i< regionID.size() ; i++) {
            if ( regionID.get(i).equals(this.regionIDs.get(i)) ){
                booleanFlag = true;             
            } else {
                booleanFlag = false;
            }           
        }       
        return booleanFlag;     
    }

@Override
    public int hashCode() {
        int hashValue = 0;
        for(int i=0; i< regionIDs.size(); i++) {
            hashValue = hashValue + regionIDs.get(i).hashCode();
        }               
            return hashValue;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T11:41:06.203

列表将用作键，但您必须知道您需要提供完全匹配。即，您需要提供等于()、具有相同hashCode() 并且顺序相同的列表元素。

注意：一旦密钥被用作密钥，您就无法更改密钥。例如，您不能将 List 添加为键，然后对其进行更改并期望 Map 仍然可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T11:40:37.083

为了让 containsKey 和 get 函数在 Map 上正常工作，用作键的对象的类需要实现 hashCode 和 equals 方法。

您需要做的是对您用作键的 List 类型进行子类化，例如：

```
public class MyList extends ArrayList() {
    //constructors

    public boolean equals(Object obj) {
        // a good equals implementation
    }

    public int hashCode() {
        // a good hashcode implementation
    }
} 
```

有关如何实现 equals 和 hashCode 方法以使我们工作的信息，您可以在以下链接下找到一些信息： [在 Java 中覆盖 equals 和 hashCode 时应该考虑哪些问题？](https://stackoverflow.com/questions/27581/overriding-equals-and-hashcode-in-java)

# iphone - 在 UILabel 调整大小后强制文本截断

> ID：11261025
> 
> 赞同：0
> 
> 时间：2012-06-29T11:33:28.357
> 
> 标签：iphone, objective-c, uilabel

我有`UILabel`它可以在应用程序运行时具有各种宽度。其中的文本`UILable`可能比其`UILabel`本身更宽，因此文本有时会被截断。

问题是文本在`UILabel`调整大小后没有被重新截断，所以它要么比 the 宽，要么更`UILabel`窄。

如何强制`UILabel`重新截断文本以使其完美契合？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T11:45:44.347

对不起，我的代码中的其他地方实际上有一个错误，所以问题现在已经结束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:40:30.140

要使 UILabel 框架与您可以使用的文本匹配：

```
[myLabel sizeToFit]; 
```

但是 UILabel 可能对于它的容器视图（控制器的视图或子视图）来说太大了，在这种情况下，您可能需要计算文本大小并相应地调整标签大小

```
CGSize labelSize = [messageText sizeWithFont:myLabel.font constrainedToSize:CGSizeMake(myLabel.frame.size.width, MAXFLOAT) lineBreakMode:myLabel.lineBreakMode]; 
```

要使用它，您需要将标签的 numberOfLines 设置为 0；

# .net - 我怎样才能为这个 c# 代码获得更好的运行时间？

> ID：11261026
> 
> 赞同：0
> 
> 时间：2012-06-29T11:33:36.317
> 
> 标签：.net, windows-phone-7, biginteger

我在 C# 中使用 BigInteger 实现进行一些计算，但 windows phone 中的性能不如要求的好。

探查器检测到大部分时间都被此函数占用。有什么线索吗？

这是针对 windows phone 7 的，我无法原生改进它。

```
 private const long IMASK = 0xffffffffL;

    /**
     * returns x = x - y - we assume x is >= y
     */
    private static int[] Subtract(
        int     xStart,
        int[]   x,
        int     yStart,
        int[]   y)
    {

        Debug.Assert(yStart < y.Length);
        Debug.Assert(x.Length - xStart >= y.Length - yStart);

        int iT = x.Length;
        int iV = y.Length;
        long m;
        int borrow = 0;

        do
        {
            m = (x[--iT] & IMASK) - (y[--iV] & IMASK) + borrow;
            x[iT] = (int)m;

            //              borrow = (m < 0) ? -1 : 0;
            borrow = (int)(m >> 63);
        }
        while (iV > yStart);

        if (borrow != 0)
        {
            while (--x[--iT] == -1)
            {
            }
        }

        return x;
    } 
```

# android - Android倒计时问题

> ID：11261032
> 
> 赞同：-1
> 
> 时间：2012-06-29T11:34:00.587
> 
> 标签：android

我一直在研究实时代码，并借助我在互联网上找到的一些代码，我设法找到了一些可行的东西。

我从数据库中获取日期并将其拆分并放入毫秒内，这就是我找到的代码接管的地方。

现在剩下的都很完美，除了那些日子，它似乎总是 30 多天，但还剩下多少天？？

这是代码：

```
 GregorianCalendar endDate = new GregorianCalendar(Integer.parseInt(separated[0]), Integer.parseInt(separated[1]),  Integer.parseInt(separated[2]), Integer.parseInt(Time[0]), Integer.parseInt(Time[1]), 00);
    GregorianCalendar startDate = new GregorianCalendar(year, month, day, hours, minutes, seconds);

    long diffInMs = endDate.getTimeInMillis() - startDate.getTimeInMillis();

    new CountDownTimer(diffInMs, 1000) {

         public void onTick(long millisUntilFinished) { 
             int seconds = (int)(millisUntilFinished / 1000) % 60 ;
             int minutes = (int)((millisUntilFinished / (1000*60)) % 60);
             int hours = (int)((millisUntilFinished / (1000*60*60)) % 24);
             int days = (int)((millisUntilFinished / (1000*60*60*24)) % 365);
             //int years = (int)(millisUntilFinished / 1000*60*60*24*365);

             ArrayList<String> timeArray = new ArrayList<String>();

    //               if(years > 0)   
    //                   timeArray.add(String.valueOf(years)   + "y");

             if(days > 0)    
                 timeArray.add(String.valueOf(days) + "d");

             if(hours>0)   
                 timeArray.add(String.valueOf(hours) + "h");

             if(minutes>0) 
                 timeArray.add(String.valueOf(minutes) + "min");

             if(seconds>0) 
                 timeArray.add(String.valueOf(seconds) + "sec");

             String time = "";
             for (int i = 0; i < timeArray.size(); i++) 
             {
                 time = time + timeArray.get(i);
                 if (i != timeArray.size() - 1)
                     time = time + ", ";
             }

             if (time == "")
               time = "0 sec";

             Countdown.setText("Database Lock: " + time );

         } 
```

现在我不明白为什么日子会出错？

关于什么可能是错的任何想法？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:49:47.860

如果你的意思是花几天、一小时、几分钟、一秒的时间，这就是代码对我有用。

```
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;

public class DateDiff{ 

  public static void main(String[] args){

  Date date = null;
  Date date1 = new Date();
  System.out.println(date1.toString());

  try { 
  String str_date="Tue, 25 Jun 2012 05:43:27";
  DateFormat formatter ;
  //Date date ;
  formatter = new SimpleDateFormat("EEE,dd MMM yy HH:mm:ss");
  date = (Date)formatter.parse(str_date); 
  System.out.println("Today is " +date );
  } catch (ParseException e)
   {

     System.out.println("Exception :"+e); 

  } 

  long diff = date1.getTime() - date.getTime();
  long seconds = diff / 1000;
  long minutes = seconds / 60;
  long hours = minutes / 60;
  long days = hours / 24;

       System.out.println("Time in seconds: " + seconds
      + " seconds.");
       System.out.println("Time in minutes: " + minutes
     + " minutes.");
       System.out.println("Time in hours: " + hours
     + " hours.");
       System.out.println("Time in days: " +days
     + " days.");

  }
} 
```

# python - 在 Python 中创建没有变量“x in”（例如范围）的生成器表达式或列表推导

> ID：11261033
> 
> 赞同：10
> 
> 时间：2012-06-29T11:34:09.250
> 
> 标签：python, list-comprehension, generator-expression

在 Python 中，有没有办法在没有“x in”变量的情况下编写这个列表理解（因为它完全未使用）？同样适用于生成器表达式。我怀疑这种情况经常出现，但我偶然发现了几次并且很想知道。

这是一个例子：

```
week_array = ['']*7
four_weeks = [week_array[:] for x in range(4)] 
```

（也许，有没有更优雅的方式来构建它？）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-29T11:45:08.703

我不相信，而且对`x`. 以这种方式未使用某个值的常见做法是使用下划线作为自由变量，例如：

```
[week_array[:] for _ in range(4)] 
```

但这只不过是一种约定，表示自由变量未使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T11:43:18.850

不可以。两个构造都*必须*有一个迭代器，即使它的值未被使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T11:54:06.293

```
week_array = ['']*7
four_weeks = map(list, [week_array]*4) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T12:05:26.213

这与其他答案类似，因为我使用地图，但我所做的使用您正在使用的相同功能。

```
four_weeks = map(lambda i: week_array[:], range(4)) 
```

此外，与使用 example 相比的主要优点`_`是它可能已经被使用（`_`被 gettext 经常使用）并且它将其值更改为迭代器中的最后一项。看这个例子：

```
[x for x in range(4)]
assert x == 3, 'x should be equal to 3' 
```

# objective-c - 如何在 Xcode 中使用 LDAP 连接到 MS Active Directory

> ID：11261037
> 
> 赞同：1
> 
> 时间：2012-06-29T11:34:18.123
> 
> 标签：objective-c, xcode, active-directory, ldap

我需要连接到 Microsoft Active Directory 以检索有关组成员身份的用户详细信息。我有 LDAP 路径，并且在 C sharp 中做过很多次。但现在我需要了解如何在 Xcode 中执行此操作。

有几个与从 AD 检索数据有关的问题，但我还没有设法找到一个解释如何首先连接 int 的问题。因此，非常感谢您的任何建议/代码示例。

# php - 新程序员的挑战问题

> ID：11261038
> 
> 赞同：1
> 
> 时间：2012-06-29T11:34:19.400
> 
> 标签：php, php-5.3

因此，我正在培训某人在 PHP、MySQL、HTML 等方面的工作，并且想知道是否有人知道任何好的入门级挑战让他完成 PHP。我已经让他做了很多，但我开始没有想法了。他以前没有编程经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:57:53.923

计算年龄 - 考虑 1970 年之前的日期，闰年，如果生日在当年已经过去，生日在未来，日期格式。

以他创建的类为基础，并扩展它们以做其他事情。

输出多维数组的内容——递归。

打开一个文本文件并提取数据 - 内存管理，最长执行时间。

从两个表中获取不匹配的记录。左连接 ... x 为空

从查询中构建数据网格 - 剩余单元格时的跨度

重复的 Ajax 请求。检查数据库以查看 X 是否已保存/更新。（2 个用户打勾或聊天室）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T11:36:40.170

留言簿怎么样？图片库？小型CMS？简易商店？一个博客？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T11:42:58.727

我会亲自去一个电子商务网站。他们很难做好，所以这将是一个真正的挑战。

完成所有工作，完全订购和所有玉米作业等，以保持价格和特别优惠等。

真的很简单：

*   做一个 cronjob
*   了解如何从 PHP 调用系统命令
*   了解 CLI

# cordova - 无法解码 base64 未捕获错误 - HTML 画布元素到 sd 卡

> ID：11261041
> 
> 赞同：0
> 
> 时间：2012-06-29T11:34:27.680
> 
> 标签：cordova, canvas, base64, android-sdcard, filewriter

我正在尝试在设备的 SD 卡上存储一个签名（在 canvas 元素上绘制）。我正在使用 eclipse + phonegap（版本 1.7.0）。

我遇到了以下链接-

[https://groups.google.com/forum/?fromgroups#!topic/phonegap/I23hrgFOgN8](https://groups.google.com/forum/?fromgroups#!topic/phonegap/I23hrgFOgN8)

我尝试了以下代码 -

```
var canvas = document.getElementById("can");
var writer = new FileWriter("/mnt/sdcard/sign.png");
ctxt = canvas.getContext("2d");
var img = canvas.toDataURL();
var img64 = canvas.toDataURL("image/png").replace(/data:image\/png;base64,/, '');
var img = atob(img64);
navigator.notification.alert(img64);
writer.write(img64); 
```

但我遇到以下错误 - 未捕获的错误：无法解码 base64（在我使用 atob 的行）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T15:57:16.603

那么 toDataUrl 只是 Android 版本 4 上的一个存根，所以它实际上没有做任何事情。所以“img64”的值可能是空的，为了让mattes变得更糟，你仍然可以使用PhoneGap FileWriter编写二进制数据。所以你需要想出一种不同的方法来做到这一点。

但是，我确实知道有人成功地将[Android 的 Signature Capture](http://www.binarysolutions.biz/p/signature-capture-for-android.html)集成到他们的 PhoneGap 应用程序中，并将其称为意图。所以这就是我要走的路线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T13:09:09.787

似乎不能直接：

[从 Base64 字符串转换为 PNG 文件](https://stackoverflow.com/questions/9840742/convert-from-base64-string-to-png-file)

检查这个库，它[在 javascript 中进行本地 base64 解码](http://blog.danguer.com/2011/10/24/base64-binary-decoding-in-javascript/)的转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T11:18:50.860

正如西蒙所说，这在版本 4 下的 Android 上是不可能的。您的其余代码可能是正确的，尽管我没有机会对其进行测试。

想到的一个想法是逐个像素地读取画布像素，然后自己创建一个二进制文件。[这个库](http://www.nihilogic.dk/labs/canvas2image/)有一个内置的函数来将画布转换为 BMP。从那里您可以将其保存为文件，就像您之前尝试使用 PNG 一样。

同样，这只是一些头脑风暴，我没有测试任何东西，我个人也会采用 Simon 提出的解决方案，因为它更容易并且很可能也更稳定。

# common-lisp - 如何将本地项目添加到quicklisp配置的asdf

> ID：11261045
> 
> 赞同：9
> 
> 时间：2012-06-29T11:34:34.910
> 
> 标签：common-lisp, asdf, quicklisp

我想通过 asdf 将本地项目添加到已知项目中，但由于 asdf 是由 quicklisp 安装和配置的，并且`*central-registry*`指向“#P/home/user/quicklisp/quicklisp/”，其中包含 .lisp 文件. 我不知道该怎么做，因为[手册](http://common-lisp.net/project/asdf/asdf/Configuring-ASDF.html)解释了指向目录的符号链接可以做到这一点，但我不想在 quicklisp 里面乱七八糟。（不过，它确实可以用作修补程序！）

因此：如何将本地项目添加到由quicklisp安装和配置的asdf（不是QUICKLISP）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-29T16:31:49.977

如果您使用 Quicklisp，您可以使用 `~/quicklisp/local-projects/`在其他目录之前扫描的专用目录。要使用它，只需将您的项目或符号链接。

```
(quickproject:make-project "~/quicklisp/local-projects/my-new-website/"
  :depends-on '(restas parenscrit cl-who))

(quickproject:make-project "~/src/lisp/my-cool-gui/"
  :depends-on '(qt))

$ ln -s ~/src/lisp/my-cool-gui ~/quicklisp/local-projects/my-cool-gui 
```

但是，如果您真的想按照[文档](http://common-lisp.net/project/asdf/asdf.html#Configuring-ASDF)`ASDF`中的说明 进行配置。

例如，您可以这样说：

```
(:directory "~/src/lisp/my-project-XYZ/") 
```

在你`~/.config/common-lisp/source-registry.conf.d/my-asdf.conf`添加一个目录，或者

```
(:tree "~/src/lisp/") 
```

如果要扫描所有子目录。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-29T13:27:33.140

因为`asdf:*central-registry*`不仅仅是一条路径，它是路径名列表。你可以简单地做： `(push "/path-to-your-project/" asdf:*central-registry*)`。如果您使用 SBCL，您可以将此行添加到 ~/.sbclrc。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-30T17:57:33.840

ASDF 手册在[第 3 节](http://common-lisp.net/project/asdf/asdf.html#Configuring-ASDF)中有：

> 从 ASDF 2 开始，配置 ASDF 在何处找到您的系统的首选方法是源注册工具，在本手册的单独章节中有详细描述。请参阅[控制 ASDF 在何处搜索系统](http://common-lisp.net/project/asdf/asdf.html#Controlling-where-ASDF-searches-for-systems)。

[控制 ASDF 搜索系统](http://common-lisp.net/project/asdf/asdf.html#Controlling-where-ASDF-searches-for-systems)的位置中的第 7 项 是

> 如果源注册表存在，将从系统配置目录 /etc/common-lisp/source-registry.conf.d/ 进行配置。

这个位置在 Debian 中可用，并且是我使用的。默认情况下，Debian 将下载的 CL 库的源代码放在`/usr/share/common-lisp/source`. 但是，我不知道（尽管我试图找出）这个位置是如何被 ASDF 知道的。因此，您可以将带有路径名的文件添加到此位置，以使 ASDF 知道这些路径名。我添加了一个文件`/etc/common-lisp/source-registry.conf.d/04-local.conf`，包含

(:tree #p"/usr/local/share/common-lisp/source/")

现在我可以将本地下载的 CL 库的源放入其中`/usr/local/share/common-lisp/source/`，它们将对 ASDL 可见。`:tree`语法在 [配置 ASDF 以查找您的系统](http://common-lisp.net/project/asdf/asdf.html#Configuring-ASDF-to-find-your-systems)中进行了描述。

asdf:*central-registry* 现在已贬值。请参阅[第 3.2 小节：配置 ASDF 以查找您的系统 - 旧式](http://common-lisp.net/project/asdf/asdf.html#Configuring-ASDF)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-08-29T08:32:18.327

放

```
(push "~/your/local/lisp/projects/folder/" ql:*local-project-directories*) 
```

您`.sbclrc`可以在没有符号链接或移动文件夹的情况下快速加载您的项目。

我知道你问过 asdf，但是当你实际使用 quicklisp 时，我认为你不想弄乱 asdf。

# php - PHP：为客户端创建唯一标识符（独立于时间、cookie 和 IP 号）

> ID：11261048
> 
> 赞同：1
> 
> 时间：2012-06-29T11:34:52.033
> 
> 标签：php, http

我正在考虑一种禁止用户的方法 * 为来自用户的多个变量（如浏览器和版本等）创建哈希值，并将它们添加到存储被禁止用户列表或此类值的表中。我在这里找到了 http 变量列表[http://www.php.net/manual/en/reserved.variables.server.php](http://www.php.net/manual/en/reserved.variables.server.php) 但我想你可能有这方面的经验。我计划在必要时使用它来禁止人们访问该网站，并且更新 IP 号码和删除 cookie 不应帮助该人获得访问权限。

我可以使用哪些变量来为客户端生成标识符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:13:27.893

这只是为了提供信息，因为我要谈论的是特定于平台和配置的，但这里有一些技术可以唯一地识别用户：

*   [使用 Javascript 获取客户端 CPU ID](http://codingresource.blogspot.fr/2010/01/get-client-cpu-id-with-javascript.html)（在 IE 中，使用 ActiveX 和较差的安全配置）
*   [Flash 接口 MachineToken](http://help.adobe.com/en_US/flashaccess/2.0/javadocs/com/adobe/flashaccess/sdk/cert/MachineToken.html)（Adobe Flash 个性化服务）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:03:03.950

通过组合*足够的*数据，您可以减少误报。这里有更多好的信息 - [https://softwareengineering.stackexchange.com/questions/122372/is-browser-fingerprinting-a-viable-technique-for-identifying-anonymous-users](https://softwareengineering.stackexchange.com/questions/122372/is-browser-fingerprinting-a-viable-technique-for-identifying-anonymous-users)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T11:55:56.227

问题是您永远无法创建一个真正唯一的标识符，您将只是一些间接数据指出谁*可能*是罪魁祸首。没有好的方法可以做到这一点，因为大多数唯一数据是客户端提供的数据。

不过，并不是所有的希望都落空了，通过结合大量不同的数据，如*geoip*、*会话*、*用户代理*和*访问时间*，您可能会获得足够的数据来识别**可能的**禁令破坏者，但您永远不会有足够的数据来真正识别用户；特别是如果该用户知道如何清除 cookie 并更改其用户代理。

# c++ - 从 C++ STL 集合中获取泛型 key_type

> ID：11261052
> 
> 赞同：2
> 
> 时间：2012-06-29T11:35:17.000
> 
> 标签：c++, templates, stl, map, set

我想出了以下代码，它演示了一种在 STL 集合上进行通用迭代并获取键值的技术，而不管键是如何存储的。

上下文是我正在重构两个函数，它们都在两个集合上运行相同的功能：一个是 a `set<int>`，另一个是 a`map<int, int>`所以在第一种情况下我想采取行动`*it`，在第二种情况下`it->first`（其中`it`是 const_iterator. )

重要的是，我想这样做，因为集合非常大，我不想简单地`set`从`map`just 创建一个，所以我只能处理一种特定类型。

```
#include <map>
#include <set>
#include <iostream>

using namespace std;

// General case for obtaining from, say, a set.
template< typename T >
const typename T::key_type getKey( const typename T::const_iterator& it )
{
    return *it;
}

// Specific case for a map<int,int>
template<>
const map<int, int>::key_type getKey< map<int, int> >( const map<int, int>::const_iterator& it )
{
    return it->first;
}

template< typename T >
void dumpOut( T& coll )
{
    for ( typename T::const_iterator it = coll.begin(); it != coll.end(); ++it )
    {
        const typename T::key_type& a = getKey<T>(it);
        cout << a << endl;
    }
}

int main()
{
    set<int> s1;
    s1.insert(10);
    s1.insert(15);
    s1.insert(20);

    dumpOut< set<int> >( s1 );

    map<int, int> m1;
    m1.insert( pair<int, int>(11, -1) );
    m1.insert( pair<int, int>(16, -1) );
    m1.insert( pair<int, int>(21, -1) );

    dumpOut< map<int, int> >( m1 );

    return 0;
} 
```

我的问题是：是否有可能使专门的案例更通用一点，因为无论关键和价值实际上是什么，`map<int,int>`这种方法显然都适用于一般情况。`map`

任何指针（没有双关语）都会很有用。请注意，我不能使用 C++11 解决方案，尽管我对从学术角度使用它的解决方案感兴趣。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:44:30.470

您在这里有一个 C++ 语言问题 - 不允许对函数进行部分特化。所以不能这么简单：

```
// Specific case for a map<int,***>
template<typename Value_, typename Comp_, typename Alloc_>
const typename map<int, Value_, Comp_, Alloc_>::key_type getKey< map<int, Value_, Comp_, Alloc_> >( const typename map<int, Value_, Comp_, Alloc_>::const_iterator& it )
{
    return it->first;
} 
```

幸运的是，类的部分特化是允许的——所以改成这样：

```
// work - for let say - sets
template <class Type_>
struct Key { 
   Key(typename Type_::const_iterator it) : value(*it) {}
   typename Type_::key_type value;
};

// work - for map<***>
template <class Key_, class Value_, class Comp_, class Alloc_>
struct Key<map<Key_, Value_,Comp_,Alloc_> > { 
   typedef map<Key_, Value_,Comp_,Alloc_> Type_;
   Key(typename Type_::const_iterator it) : value(it->first) {}
   typename Type_::key_type value;
};

template< typename T >
const typename T::key_type getKey( const typename T::const_iterator& it )
{
    return Key<T>(it).value;
} 
```

我在那里复制了您更改的示例：http: [//ideone.com/tE2aC](http://ideone.com/tE2aC)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T11:59:27.683

您需要定义一个可以在外部定义的 Traits。您还希望它尝试提取 key_type（如果存在），如果不存在则属于默认情况（默认情况下可以稍后专门化）。这需要 SFINAE 和模板魔法的快照：

```
//// This is a SFINAE context enabler. If T is defined R is returned
template<class T, class R=void> struct enable_if_type
{
   typedef R type;
};

//// Default case is undefined as you want to get an error if you try to get a key_type from something that has none
template<class T, class Enable=void> struct key_type_of;

//// If T::key_type is a valid expression, extract it
template<class T>
struct key_type_of< T
                  , typename enable_if_type< typename T::key_type>::type
                  >
{
  typedef typename T::key_type type;
}; 
```

现在任何具有 key_type typedef 的类型都将使用它，其他类型不会编译但您可以使用 key_type_of 的特化来为其提供成功匹配。

例子：

[http://ideone.com/3PxJm](http://ideone.com/3PxJm)

完成此操作后，您实际上可以使用它来获取 key_type。要以独立于容器的方式提取密钥本身，您可以创建一个外部 key_of 函数，您可以将其泛化为广泛的集合类型。

# c# - 在父类型导航属性上使用扩展

> ID：11261053
> 
> 赞同：2
> 
> 时间：2012-06-29T11:35:20.357
> 
> 标签：c#, wcf, wcf-data-services

我的实体定义如下（省略细节）：

```
public class Order : Cart, IEntity
{

} 
```

基类 Cart 有一个 Navigation Property Order Items：

```
public List<Item> Items { get; set; } 
```

使用 Odata 协议如何使用扩展语句访问父类型项目属性？当我执行以下查询时

```
https://localhost/ECommerceOData.svc/Order?$expand=Items 
```

我得到错误

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<error xmlns="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
    <code></code>
    <message xml:lang="en-GB">Error processing request stream. The property name 'Items' specified for type 'Bsi.Cloud.eCommerce.Model.Context.Order' is not valid.</message>
</error> 
```

还将`DBContext`Order 公开为`DBSet`. Odata 服务公开了 Order 实体：

```
config.SetEntitySetAccessRule("Order", EntitySetRights.AllRead); 
```

# magento - Magento 安装程序中的“使用自定义权限”是什么？

> ID：11261056
> 
> 赞同：1
> 
> 时间：2012-06-29T11:35:34.020
> 
> 标签：magento

Magento 安装程序中“使用自定义权限”复选框的含义是什么？版本 1.7.0.0

![在此处输入图像描述](../Images/0f47c631af53c6234ba5c55d521880df.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:34:18.590

这是一种下载模式，它允许您继续使用自定义权限。您可以将其设置`config.ini`为`mkdir_mode`和`chmod_file_mode`。例如：

```
mkdir_mode=0777
chmod_mode=0666 
```

上述值是默认值。

Magento CE 下载器文件中的以下代码段`./downloader/Maged/Model/Config.php`指定了可能的配置值：

```
$configParams = array(
    'protocol',
    'preferred_state',
    'use_custom_permissions_mode',
    'mkdir_mode',
    'chmod_file_mode',
    'magento_root',
    'downloader_path',
    'root_channel_uri',
    'root_channel',
    'ftp',
); 
```

如您所见，`root_channel`是否存在，如果您打开`config.ini`文件，您应该看到它已经设置为`community`或根据您的 magento 安装类型可以是`pro`，`enterprise`AFAIK

只需将其设置为`No`即可体验最佳效果。

# sql - 为什么我从这个查询中得到错误的输出？

> ID：11261057
> 
> 赞同：1
> 
> 时间：2012-06-29T11:35:43.597
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我试图在 ms sql server 中对结果进行分页，但在获得正确的结果时遇到了一些麻烦。我想达到与 mysql:s LIMIT 相同的结果，我正在尝试使用这个模型来做到这一点：

```
SELECT * FROM (
    SELECT TOP x * FROM (
        SELECT TOP y fields
        FROM table
        WHERE conditions
        ORDER BY table.field  ASC) as foo
    ORDER by field DESC) as bar
ORDER by field ASC 
```

来自：http: [//josephlindsay.com/archives/2005/05/27/paging-results-in-ms-sql-server/](http://josephlindsay.com/archives/2005/05/27/paging-results-in-ms-sql-server/)

列出前 30 行的原始查询如下：

```
SELECT TOP 30 pt.[BSNR], t.ID, pt.RESDATUMTID, pt.LAND1, pt.HPL1, pt.ANKDATUMTID, pt.LAND2, pt.HPL2
  FROM [statistik2].[dbo].[ttrip] AS t
  JOIN [statistik2].[dbo].[tparttrip] AS pt 
  ON t.ID = pt.TRIP_ID
  WHERE t.DBKRDAT > '2012-06-27'
  ORDER BY pt.BSNR DESC, t.ID, pt.RESDATUMTID 
```

我的尝试是：

```
SELECT * FROM (
    SELECT TOP 10 * FROM (
        SELECT TOP 30 pt.ID AS PTID, pt.[BSNR], t.ID, pt.RESDATUMTID, pt.LAND1, pt.HPL1, pt.ANKDATUMTID, pt.LAND2, pt.HPL2
        FROM [statistik2].[dbo].[ttrip] AS t
        JOIN [statistik2].[dbo].[tparttrip] AS pt
        ON t.ID = pt.TRIP_ID
        WHERE t.DBKRDAT > '2012-06-27'
        ORDER BY pt.BSNR DESC, t.ID DESC, pt.RESDATUMTID
    ) as pttt
    ORDER BY pttt.PTID DESC) AS ptttt
ORDER BY ptttt.PTID 
```

查询的输出： http: [//speedy.sh/5NQeq/sqloutput.txt](http://speedy.sh/5NQeq/sqloutput.txt)

有人可以解释我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T11:58:47.060

您可以使用 ROW_NUMBER() 来获得运行计数 - 这使得分页更容易......例如

（注意：这适用于 SQL 2005 及更高版本 - SQL 2000 不支持 row_number() 函数）

假设一个表有一列“名称”：

```
SELECT * FROM 
(
    SELECT ROW_NUMBER() OVER (ORDER BY Name) as RunningVal, * FROM Names
) as Running 
WHERE RunningVal BETWEEN 5 AND 10 
```

老实说，整个三重排序有点老派：P

在您的情况下，它将类似于：

```
SELECT * FROM (
    SELECT TOP 30 
        ROW_NUMBER() OVER (ORDER BY pt.BSNR DESC, t.ID DESC, pt.RESDATUMTID) as RunningVal, 
        pt.ID AS PTID, 
        pt.[BSNR], 
        t.ID, 
        pt.RESDATUMTID, 
        pt.LAND1, 
        pt.HPL1, 
        pt.ANKDATUMTID, 
        pt.LAND2, 
        pt.HPL2 
    FROM [statistik2].[dbo].[ttrip] AS t 
    JOIN [statistik2].[dbo].[tparttrip] AS pt 
    ON t.ID = pt.TRIP_ID 
    WHERE t.DBKRDAT > '2012-06-27' 
    ORDER BY pt.BSNR DESC, t.ID DESC, pt.RESDATUMTID
    ) as Running 
WHERE RunningVal BETWEEN 1 AND 10 
```

事实上，您甚至可以摆脱内部 TOP 并使用：

```
SELECT * FROM (
    SELECT     
        ROW_NUMBER() OVER (ORDER BY pt.BSNR DESC, t.ID DESC, pt.RESDATUMTID) as RunningVal, 
        pt.ID AS PTID, 
        pt.[BSNR], 
        t.ID, 
        pt.RESDATUMTID, 
        pt.LAND1, 
        pt.HPL1, 
        pt.ANKDATUMTID, 
        pt.LAND2, 
        pt.HPL2 
    FROM [statistik2].[dbo].[ttrip] AS t 
    JOIN [statistik2].[dbo].[tparttrip] AS pt 
    ON t.ID = pt.TRIP_ID 
    WHERE t.DBKRDAT > '2012-06-27' 
    ORDER BY pt.BSNR DESC, t.ID DESC, pt.RESDATUMTID
    ) as Running 
WHERE RunningVal BETWEEN @x AND @y 
```

其中@x 是下限，@y 是上限（BETWEEN 包括在内，ROW_NUMBER() 从 1 开始，因此 x = 1 和 y = 10 将为您提供记录 1-10）

**编辑：**不确定当您在 LIMIT 中指定一个超出范围的 OFFSET 时 MySql 会发生什么（据我所知，官方文档似乎没有提到这个），但如果您指定 @ x = 100 和 @y = 110 并且表中只有 50 条记录，您将不会得到任何结果

Edit2：添加了一个 SQL 小提琴链接，如果你想摆弄它！

[http://sqlfiddle.com/#!3/57808/3](http://sqlfiddle.com/#!3/57808/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T11:58:08.993

注意示例查询。

最里面的子查询按 . 对结果进行排序`field ASC`。这是所有页面的主要顺序。最里面的子查询`y`按该顺序获取最上面的行。

中间层子查询*颠倒*顺序并*从前一个结果*`x`中获取顶部行，从而有效地获取整个数据集顶部行的底部行。*`x``y`*

 *主查询只是重新建立行的主要顺序。

你也应该这样做。您最里面的查询对这样的行进行排序：

```
ORDER BY pt.BSNR DESC, t.ID DESC, pt.RESDATUMTID 
```

如果这是您的主行顺序，那么您应该在中间层子查询中使用它的反转版本，即像这样：

```
ORDER BY pt.BSNR ASC, t.ID ASC, pt.RESDATUMTID DESC 
```

在主查询中如何对行进行排序可能并不重要，但我会按照示例再次反转顺序，使其与最里面的查询匹配。*

# mysql - 将结果分组到每小时存储桶中的 SQL 查询

> ID：11261060
> 
> 赞同：0
> 
> 时间：2012-06-29T11:35:59.020
> 
> 标签：mysql, sql

我有一个非常简单的 MySQL 表

```
Name  |  Time  |  Count
James |  11:00 |  10
Simon |  11:00 |  5
James |  11:30 |  4
Oliver|  11:30 |  2
James |  12:00 |  1
etc. 
```

我想创建一个 MySQL 查询，它将每个人的 Count 相加并输出最后 1 小时值、最后 3 小时值、最后 6 小时值、最后 12 小时值和最后 24 小时值。

例如，如果现在是 12:59，上表将输出：

```
Name  |  Last-1  |  Last-3  | Last-6
James |  1       |  15      | 15
Simon |  0       |  5       | 5
Oliver|  0       |  2       | 2 
```

是否可以在单个查询中执行此操作？到目前为止，我有：

```
SELECT name, HOUR( NOW( ) ) - HOUR( time ) AS lasthours, SUM( count ) AS c
FROM table
GROUP BY name, lasthours
HAVING lasthours =0
ORDER BY c DESC 
```

这给了我过去一个小时，但我如何获得额外的列？

非常感谢任何帮助。

**编辑：**

接受的答案需要稍微调整一下，结果如下：

```
SELECT  name , 
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=0,  count , 0 ) ) AS  `Last hour` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=3,  count , 0 ) ) AS  `Last 3 hours` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=6,  count , 0 ) ) AS  `Last 6 hours` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=12,  count , 0 ) ) AS  `Last 12 hours` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=24,  count , 0 ) ) AS  `Last 24 hours` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=48,  count , 0 ) ) AS  `Last 2 days` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=72,  count , 0 ) ) AS  `Last 3 days` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=96,  count , 0 ) ) AS  `Last 4 days` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=120,  count , 0 ) ) AS  `Last 5 days` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=144,  count , 0 ) ) AS  `Last 6 days` ,
        SUM( IF( HOUR( TIMEDIFF( NOW( ) ,  time ) ) <=168,  count , 0 ) ) AS  `Last week`
FROM  table
GROUP BY  name
ORDER BY `Last hour` DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T11:40:38.803

```
SELECT   `name`,
         SUM(IF(HOUR(TIMEDIFF(CURTIME(), `Time`)) <= 1, `Count`, 0)) AS `Last-1`,
         SUM(IF(HOUR(TIMEDIFF(CURTIME(), `Time`)) <= 3, `Count`, 0)) AS `Last-3`,
         SUM(IF(HOUR(TIMEDIFF(CURTIME(), `Time`)) <= 6, `Count`, 0)) AS `Last-6`
FROM     `table`
GROUP BY `name` 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/809d3/1/0)上查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T11:41:11.240

试试这个

```
Select Name,Sum(Case When Hour(Now)-Hour(Time) <= 1 Then Count Else 0 End) As Last1,
Sum(Case When Hour(Now)-Hour(Time) Between 2 AND 3 Then Count Else 0 End) As Last3,
Sum(Case When Hour(Now)-Hour(Time) Between 4 And 6 Then Count Else 0 End) As Last6
From name
Order By 
```

# haskell - （从 gi t 构建 cabal-install）为什么模块 `Distribution.Compat.Exception' 不导出 `SomeException'

> ID：11261063
> 
> 赞同：0
> 
> 时间：2012-06-29T11:36:10.073
> 
> 标签：haskell, cabal, cabal-install

我正在尝试使用较新的 cabal 编译 hackport（这里是来源：[https](https://github.com/Nensha/hackport) ://github.com/Nensha/hackport ），但总是得到相同的错误：

```
[61 of 91] Compiling Distribution.Client.Types ( cabal/cabal-install/Distribution/Client/Types.hs, dist/build/hackport/hackport-tmp/Distribution/Client/Types.o )

cabal/cabal-install/Distribution/Client/Types.hs:33:12:
    Module
    `Distribution.Compat.Exception'
    does not export
    `SomeException' 
```

根据 Distribution.Compat.Exception 必须没有任何问题，并且必须来自基础但失败。那么问题是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:11:35.307

你的问题是

```
Hs-Source-Dirs:       ., cabal/cabal, cabal/cabal-install 
```

有两个模块`Distribution.Compat.Exception`。一下`cabal/cabal`一下`cabal/cabal-install`。后者出口`SomeException`，前者不出口。但是编译器从库中选择了一个`Cabal`，但没有。也许重新排序该`Hs-Source-Dirs`字段中的目录将是一种解决方法。

通常，在编译时`cabal-install`，库的源目录`Cabal`不可用，因此`Distribution.Compat.Exception`获取的是来自`cabal-install`.

# .net - 操作无效。从 SQL Server 读取时连接已关闭错误

> ID：11261065
> 
> 赞同：3
> 
> 时间：2012-06-29T11:36:31.883
> 
> 标签：.net, sql-server-2008, linq-to-sql

我喜欢使用 Linq to SQL 从数据库中读取数据。但是在这个方法中抛出异常

```
 public string[] readFromAbbrevationsPerson()
{
    string[] resultAbbrevationsPerson = new string[10000];

    DataClassesDataContext db = new DataClassesDataContext("NERMacedonianConnectionString");

    var query = from abb in db.abbrevationsPersons
                select abb.abbrevationsPerson1;
    int i = 0;

    foreach (string noun in query)
        resultAbbrevationsPerson[i++] = noun;

    return resultAbbrevationsPerson;
} 
```

在 foreach 语句中。异常是 Invalid operation 连接关闭。我在 VS 2010 中对服务器进行了刷新，并在 SQL Management Studio 中进行了刷新。我检查了服务器的状态是否正在运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T23:13:12.733

您需要将完整的连接字符串传递给 for 的构造函数`DataClassesDataContext(string connection)`，除非您创建了自己的构造函数，该构造函数只接受您输入的值。这种情况下的异常对于确定原因不是很有帮助。

# algorithm - 随机序列的最大连续子序列和的期望

> ID：11261066
> 
> 赞同：1
> 
> 时间：2012-06-29T11:36:35.347
> 
> 标签：algorithm, programming-pearls

这是 Programming Pearls 第 2 版（第 8.7 章）中的一个问题：

> 考虑一个实数序列，它的元素是从 range 中均匀抽取的`[-1, 1]`，预期的最大连续子序列总和是多少？（如果所有元素都是负数，则最大和为`0`。）

假设序列的长度为`N`，是否存在预期最大子序列总和的封闭形式`f(N)`？我尝试做一些模拟，但没有找到任何线索。

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:06:27.547

这类似于一维中的[布朗运动](https://en.wikipedia.org/wiki/Brownian_motion)，但步长的分布不寻常。对于大 N 它近似于[维纳过程](http://mathworld.wolfram.com/WienerProcess.html)。

（不确定其中任何一个是否很有帮助，但如果您不了解这些连接，它可能会提供额外的查看位置）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:35:37.193

执行多次模拟并保存所有结果。将它们放入[直方图](http://en.wikipedia.org/wiki/Histogram)中，您会看到某些值具有更频繁出现的属性。由于随机性，您必须执行大量测试，以便您的直方图变得更加可靠（即使那样我也不确定结果的公平性）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T03:23:02.513

[这个问题在Quora](http://www.quora.com)也有提交。链接在[这里](http://www.quora.com/What-is-the-expected-value-of-the-sum-of-the-maximum-sum-subvector-if-the-arrays-elements-are-random-real-numbers-chosen-uniformly-from-1-1#)

其中一个回复是关于模拟的：

以下是一些小案例的确切答案，由 Mathematica 提供。不幸的是，在这些之后计算变得非常慢。

```
In[1]:= f[n_] := Expectation[Max[0, Max[Table[Sum[x[k], {k, i, j}], {i, n}, {j, i, n}]]], Distributed[Table[x[i], {i, n}], UniformDistribution[Table[{-1, 1}, {n}]]]]

In[2]:= Table[f[n], {n, 5}]

Out[2]= {1/4, 1/2, 23/32, 291/320, 4141/3840} 
```

# php - 复选框值未出现

> ID：11261068
> 
> 赞同：-1
> 
> 时间：2012-06-29T11:36:54.457
> 
> 标签：php

> **可能重复：**
> [通过复选框错误选择多行时出错未定义索引：复选框](https://stackoverflow.com/questions/11260181/error-in-selecting-multiple-rows-by-checkbox-error-undefined-index-checkbox)

我要通过复选框选择多行，但复选框值不带变量 $del_id 始终为空..为什么会这样？请帮助我

```
 <td><input type="hidden" name="id" id="id" value="<?php echo $row["file_serial_id"]; ?>" /><input type="checkbox" name="checkbox[]" id="checkbox[]"  value="<?php echo $row['file_serial_id']?>" /></td>
 if(isset($_POST['send_btn']) and $_POST['send_btn']=="Send"){
    $checkbox = isset($_POST['checkbox']) ? $_POST['checkbox'] : 0; 
     $checkbox = $_POST['checkbox']; //from name="checkbox[]"
            $countCheck = count($_POST['checkbox']);
    for($i=0;$i<$countCheck;$i++){
        $del_id = $checkbox[$i];
        $sql2 = "UPDATE retained_file_mst SET mark_to_dispose=1 WHERE file_serial_id='$del_id'";
        $result2 = mysql_query($sql2,$conn);
        }
// if successful redirect to delete_multiple.php
if($result2){
echo "success";
}else{
    echo "error";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T11:41:55.897

尝试：

```
if( (isset($_POST['checkbox'])) && (is_array($_POST['checkbox'])) )
{
    while(list($key,$value)=each($_POST['checkbox'])) 
    {
        $sql="UPDATE retained_file_mst SET mark_to_dispose=1 WHERE file_serial_id='".mysql_real_escape_string($value)."'";
        mysql_query($sql,$conn);
    }
} 
```

# php - cURL cookiejar 行用#HttpOnly_ 注释掉了？

> ID：11261069
> 
> 赞同：11
> 
> 时间：2012-06-29T11:37:03.147
> 
> 标签：php, curl

我正在尝试使用 cURL 从同一域上的不同页面登录到 PunBB 论坛。

登录时，cURL 被执行，它的初始响应是论坛的“成功登录”页面。但是，当单击该论坛中的任何链接时，没有设置任何 cookie，并且我已注销。

经过一番调查后，我的 cookiejar 文件提到了登录所需的 cookie。如果我在浏览器中手动创建此 cookie 及其值，我将成功登录并且一切正常。所以存储的cookie值是正确的。

然而，在 cookiejar 中包含我的 cookie 名称/值的行被注释掉了。

第一个问题：为什么？第二：如何防止这种行为？

这是我的饼干罐：

```
# Netscape HTTP Cookie File
# http://curl.haxx.se/rfc/cookie_spec.html
# This file was generated by libcurl! Edit at your own risk.

www.example.com FALSE   /   FALSE   0   PHPSESSID   3d7oe6vt3blv3vs3ea94nljcs7
#HttpOnly_www.example.com   FALSE   /   FALSE   1340974408  forum_cookie_e19209 MnwyYWQ4OGViNDI2NjE5MWEwMGZiNGZkNDFmZDY5ZDZhYjM5OTA5NDVjfDEzNDA5NzQ0MDh8OTU0NTExOGZhNWNlNGY5OGMzZDk3MmE0NDlmMWRjNzM3ZjI1NzMxOA%3D%3D 
```

这是我的 curl 电话：

```
function forumLogin() {
    $loginFields = array('req_username' => $_REQUEST['username']
                        ,'req_password' => $_REQUEST['password']
                        ,'form_sent' => "1"
                    ); //and so on
    $login = getUrl('http://www.example.com/manager/forum/login.php', 'post', $loginFields);
   return $login;
}

function getUrl($url, $method='', $vars='') 
{
  $ch = curl_init();
  if ($method == 'post') {
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $vars);
  }
  curl_setopt($ch, CURLOPT_URL, $url);
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 0);
  curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
  curl_setopt($ch, CURLOPT_COOKIEJAR, 'cookies.txt');
  curl_setopt($ch, CURLOPT_COOKIEFILE, 'cookies.txt');
    $buffer = curl_exec($ch);
  curl_close($ch);
  return $buffer;
}

// successful login so reset fail count and update key values
if(isset($_SESSION['mgrValidated'])) {
    $sql = "update $dbase.`".$table_prefix."user_attributes` SET failedlogincount=0, logincount=logincount+1, lastlogin=thislogin, thislogin=".time().", sessionid='$currentsessionid' where internalKey=$internalKey";
    $rs = mysql_query($sql);
    var_dump( forumLogin() );
}
exit; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-29T13:37:55.750

一行上的#Httponly_ 前缀不是注释。这是一个神奇的字符串，可以告诉浏览器/客户端所讨论的 cookie 是[httponly](https://www.owasp.org/index.php/HttpOnly)的。curl 会理解并相应地处理它。

我不了解有关单击事物的部分，因为我看不出这与您的 curl 使用程序有何关联或相关性。

# visual-studio-2008 - 未解析的外部符号vftable c ++

> ID：11261072
> 
> 赞同：2
> 
> 时间：2012-06-29T11:37:07.533
> 
> 标签：visual-studio-2008, visual-c++, mfc, vtk

我在我的 MFC + vtk 项目中使用了 Visual Studio 2008。我收到如下链接错误：

> vtkPBFEAView.obj : 警告 LNK4217: 本地定义符号 ?DrawDC@vtkMFCWindow@@QAEXPAVCDC@@@Z (public: void __thiscall vtkMFCWindow::DrawDC(class CDC *)) 在函数“受保护：虚拟 void __thiscall CvtkPBFEAView::OnDraw(类 CDC *)" (?OnDraw@CvtkPBFEAView@@MAEXPAVCDC@@@Z)
> 
> 1>vtkMDIView.obj : 警告 LNK4049: 本地定义符号 ?DrawDC@vtkMFCWindow@@QAEXPAVCDC@@@Z (public: void __thiscall vtkMFCWindow::DrawDC(class CDC *)) 导入 1>vtkPBFEAView.obj : 警告 LNK4217: 本地定义符号 ??0vtkMFCWindow@@QAE@PAVCWnd@@@Z (public: __thiscall vtkMFCWindow::vtkMFCWindow(class CWnd *)) 导入函数“public: void __thiscall vtkPBFEAViewImpl::initialize(class CWnd *)” (?initialize@vtkPBFEAViewImpl @@QAEXPAVCWnd@@@Z)
> 
> 1>vtkMDIView.obj : 警告 LNK4049: 本地定义符号 ??0vtkMFCWindow@@QAE@PAVCWnd@@@Z (public: __thiscall vtkMFCWindow::vtkMFCWindow(class CWnd *)) 导入 1>vtkPBFEAView.obj : 警告 LNK4217: 本地定义符号 ??1vtkMFCWindow@@UAE@XZ (public: virtual __thiscall vtkMFCWindow::~vtkMFCWindow(void)) 导入函数“public: virtual void * __thiscall vtkMFCWindow::`标量删除析构函数'(unsigned int)” (??_GvtkMFCWindow @@UAEPAXI@Z)
> 
> 1>vtkMDIView.obj : 警告 LNK4217: 本地定义符号 ??1vtkMFCWindow@@UAE@XZ (public: virtual __thiscall vtkMFCWindow::~vtkMFCWindow(void)) 导入函数“public: void __thiscall vtkMDIViewImpl::adjust_contours(int,double ,double)" (?adjust_contours@vtkMDIViewImpl@@QAEXHNN@Z)
> 
> 1>vtkMFCWindow.obj：错误 LNK2019：无法解析的外部符号“_ *declspec(dllimport) const vtkMFCWindow::`vftable'”(* _imp_??_7vtkMFCWindow@@6B@) 在函数“public: __thiscall vtkMFCWindow::vtkMFCWindow(class CWnd *)" (??0vtkMFCWindow@@QAE@PAVCWnd@@@Z)

谁能解释我这个错误的原因？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T06:12:01.730

最后我找到了问题的答案。就是 vtkMFCWindow 配置了 /MD 选项，而我的主项目配置了 /MTd 选项。因此我得到了错误。一旦我删除了 **__declspec( dllexport )**行并且它运行良好。谢谢您的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-18T17:36:09.930

对于其他可能找到此解决方案并对其 DLL 函数不再导出以供客户端应用程序使用感到不安的人：

MSVC 的 DLL 模板提供以下样板：

```
#ifdef DLLNAME_EXPORTS
  #define DLLNAME_API __declspec(dllexport)
#else
  #define DLLNAME_API __declspec(dllimport)
#endif 
```

如果您忘记在项目设置中定义 DLLNAME_EXPORTS，您将收到此消息。如果您重命名这些#defines，就会发生这种情况

# google-app-engine - 合并bulkloader中的多个列

> ID：11261081
> 
> 赞同：0
> 
> 时间：2012-06-29T11:37:34.533
> 
> 标签：google-app-engine, bulkloader

我正在使用应用程序引擎`bulkloader`将 CSV 文件导入我的数据存储区。我有许多列要合并为一个列，例如它们都是 URL，但并非所有列都提供，并且有一个取代顺序，例如：

```
url_main
url_temp
url_test 
```

我想说：“好的，如果`url_main`存在，使用它，否则用户`url_test`然后使用`url_temp`”

因此，是否可以创建一个自定义导入转换来引用列并根据条件将它们合并为一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T14:19:58.793

好的，所以在阅读[https://developers.google.com/appengine/docs/python/tools/uploadingdata#Configuring_the_Bulk_Loader](https://developers.google.com/appengine/docs/python/tools/uploadingdata#Configuring_the_Bulk_Loader)之后，我了解到`import_transform`这可以使用自定义函数。

考虑到这一点，这为我指出了正确的方法：

> ... 一个带有关键字参数 bulkload_state 的双参数函数，返回时包含有关实体的有用信息：bulkload_state.current_entity，这是正在处理的当前实体；bulkload_state.current_dictionary，当前导出字典...

所以，我创建了一个处理两个变量的函数，一个是`value`当前实体的，第二个是`bulkload_state`允许我获取当前行的，如下所示：

```
def check_url(value, bulkload_state):
    row = bulkload_state.current_dictionary
    fields = [ 'Final URL', 'URL', 'Temporary URL' ]

    for field in fields:
        if field in row:
            return row[ field ]

    return None 
```

所有这一切都是抓取当前行 ( `bulkload_state.current_dictionary`)，然后检查存在哪些 URL 字段，否则它只是返回`None`。

在我的`bulkloader.yaml`我只是通过设置来调用这个函数：

```
- property: business_url
  external_name: URL
  import_transform: bulkloader_helper.check_url 
```

注意：`external_name`没关系，只要它存在，因为我实际上没有使用它，我正在使用多个列。

简单！

# php - 从另一个 PHP 函数调用 PHP 函数的逻辑错误

> ID：11261083
> 
> 赞同：3
> 
> 时间：2012-06-29T11:37:49.720
> 
> 标签：php, function, logic

我们有一个“gotItem”函数，如果在“on_hand”值为“1”的项目上运行，它也应该调用“outItem”函数。出于某种原因，“gotItem”函数正在调用“outItem”函数，无论“on_hand”值是“1”还是“0”。任何想法为什么？代码如下

```
function gotItem( $user_item_id, $user_id ) 
{
   $user_item = $this->getUserItem( $user_id, $user_item_id );
   if ( ( ! is_null( $user_item ) ) && ( $user_item['on_hand'] = '1' ) )
   $this->outItem( $user_item_id, $user_id ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:39:25.267

`=`用于赋值`==`用于检查

```
 function gotItem( $user_item_id, $user_id ) {
    $user_item = $this->getUserItem( $user_id, $user_item_id );
    if ( ( ! is_null( $user_item ) ) && ( $user_item['on_hand'] == '1' ) )
    $this->outItem( $user_item_id, $user_id ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T11:40:57.070

你的比较是错误的：

```
$user_item['on_hand'] = '1' 
```

应该：

```
$user_item['on_hand'] == '1' 
```

由于分配，第一个将永远是真实的。遗憾的是，这是一个非常常见的错误，但您可以将条件写为：

```
'1' = $user_item['on_hand'] 
```

这将导致错误，因为您不能使用文字作为左手表达式。代码中有问题的直接迹象:)

# c# - 设置 wpf 列表框中复选框项目的前景文本颜色

> ID：11261084
> 
> 赞同：1
> 
> 时间：2012-06-29T11:37:51.633
> 
> 标签：c#, wpf, xaml, checkbox, listbox

我有几个包含数据库数据的列表。列表框用作图表的过滤器，列表框的外观应根据在其他列表框中选择的内容而改变。

这是我正在尝试做的一个简化示例：

```
Class Region
{
public int RegionID { get; set; }
public string RegionName { get; set; }
}

Class Country
{
public int CountryID { get; set; }
public string CountryName { get; set; }
public int RegionID { get; set; }
}

private void fillListBoxes()
{
List<Region> allRegions = getRegions();
lstRegionsFilter.ItemsSource = allRegions;
} 
```

一个国家显然属于一个地区，我也有例如港口，然后位于一个国家等。

所有列表框项目都是这样定义的复选框：

```
<ListBox Name="lstRegionsFilter">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <CheckBox Content="{Binding Path=RegionName}"
                      Tag="{Binding Path=RegionID}" 
                      Click="CheckBox_Click"/>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

当单击任何列表框中的项目时，它们将被添加到过滤器列表中，该过滤器将过滤显示图表的数据。例如，如果在 Regions 下选择了“Europe”，那么所有属于欧洲的国家/地区都应该在国家/地区的列表框中以不同的颜色显示，例如蓝色。

因此，在代码中，我想遍历国家列表框中的**复选框**并将其前景色设置为取决于显示/标记到该复选框的值是否是属于所选区域的国家/地区，因此通常在 foreach 循环中。但是列表框中的项目是区域类型的，那么我如何访问底层复选框？这应该是我知道的非常基本的东西，但它让我发疯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:52:32.237

尝试这个：

```
public class Region : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    private bool isChecked;

    private void OnPropertyChaned(string property)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(property));
    }

    public int RegionID { get; set; }
    public string RegionName { get; set; }

    public bool IsChecked
    {
        get { return isChecked; }
        set
        {
            if (isChecked != value)
            {
                isChecked = value;
                OnPropertyChaned("IsChecked");
            }
        }
    }
}

public class Country : INotifyPropertyChanged
{
    private readonly Region parentRegion;

    public event PropertyChangedEventHandler PropertyChanged;

    private void OnPropertyChanged(string property)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(property));
    }

    public Country(Region parent)
    {
        parentRegion = parent;
        parentRegion.PropertyChanged += ParentChanged;
    }

    private void ParentChanged(object sender, PropertyChangedEventArgs e)
    {
        if(e.PropertyName.Equals("IsChecked"))
        {
            OnPropertyChanged("IsParentChecked");
        }
    }

    public int CountryID { get; set; }
    public string CountryName { get; set; }
    public int RegionID { get { return parentRegion.RegionID; }}
    public bool IsParentChecked
    {
        get { return parentRegion.IsChecked; }
    }
} 
```

和xml：

这是针对地区的：

```
<ListBox Name="lstRegionsFilter">
<ListBox.ItemTemplate>
    <DataTemplate>
        <CheckBox Content="{Binding Path=RegionName}"
                  Tag="{Binding Path=RegionID}"
                  IsChecked="{Binding Path=IsChecked}"
                  Click="CheckBox_Click"/>
    </DataTemplate>
</ListBox.ItemTemplate>
</ListBox> 
```

这是给国家的

```
<ListBox Name="lstCountriesFilter">
<ListBox.ItemTemplate>
    <DataTemplate>
        <CheckBox ...
                  Foreground={Binding IsParentChecked, Converter={StaticResource boolToBrushConverter}"/>
                  ...
                  />
    </DataTemplate>
</ListBox.ItemTemplate>
</ListBox> 
```

**笔记：**

*   您需要实现 Converter 类（请参见[此处](http://wpftutorial.net/ValueConverters.html)）
*   将转换器作为 StaticResouce 添加到 xaml

如果区域 IsChecked 属性发生更改（来自 ui 或来自代码隐藏），则 Country Checkboxes 前景色将自动更改，因此不需要循环。

我没试过，可能你会发现错误，但我想展示“哲学”

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:49:54.490

如果我猜对了，您的计划是如果选择了该地区，则在其地区颜色中突出显示一个国家/地区？Rq 1：您不必遍历复选框即可知道选择了哪个区域：这是绑定的目的，即绑定集合本身的值将受到影响。
Rq2 ：如果您更改代码中的值，则必须在您的区域类中实现 INotifyPropertyChanged 才能更新 UI。
怎么做 ？
1\. 有 RegionId --> Boolean 的静态字典。
2\. 每当一个 RegionId 被选中/取消选中时，更新该字典并引发一个静态事件“SelectionDictionnaryUpdated”。
3\. 现在在 Country 类中添加通知属性“IsOwnerRegionSelected”。它会在字典中查看是否选择了相应的区域。
4\. 在您​​的 Country 类中添加属性“CountryRegionColor”。它将根据 RegionId 返回颜色，例如 RegionId -> Color 静态字典。
5\. 在 DataTemplate 中添加一个触发器和一个 DataTrigger，它将根据 IsOwnerRegionSelected 值在白色和 CountryRegionColor 之间切换颜色。
6\. 在一个国家的构造函数中，向 SelectionDictionnaryUpdated 添加一个处理程序，该处理程序将 NotifyPropertyChanged 放在“IsOwnerRegionSelected”上。

而已 ！

1.  您可以使用非共享字典（每个国家/地区都有一个 RegionId --> 您在构造函数中注入的布尔字典属性）
2.  您可以通过使用 'CurrentCoulor': 通知属性来使事情变得更简单，该属性将返回白色或 CountryRegionColor，具体取决于它是否被选中。只需将列表的背景绑定到该属性，并在您捕获 SelectionDictionnaryUpdated 时更改 notifyCurrentCoulor。

# git - “~（END）”在终端中显示是什么意思？

> ID：11261088
> 
> 赞同：47
> 
> 时间：2012-06-29T11:38:18.030
> 
> 标签：git, terminal

我正在运行 gitimmersion.com 实验室，每次运行： git hist --all 命令时，它似乎都会破坏终端并抛出这个：

> ~
> ~
> ~
> ~
> (完)

而且我无法再输入任何命令。所以我最终关闭了那个终端窗口并重新开始。

任何人都知道为什么会发生这种情况以及如何解决它？

谢谢！

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-06-29T11:47:22.440

Git 默认将长输出通过管道传输到所谓的分页器中，这样可以在输出不适合屏幕的情况下更轻松地查看输出。这些`~`字符表示这些行不在原始输出中，但它正在显示它们，以便您可以向下滚动到底部（即最后一行输出可以到屏幕顶部）。

您通常可以使用箭头键向上或向下滚动，并可以按 退出`q`。

* * *

或者，如果您不希望在寻呼机中输出，请尝试以下操作：

```
$ git --no-pager hist --all 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T12:07:45.353

摘自`git help config`

> ```
>  core.pager
>        The command that git will use to paginate output. Can be overridden with the GIT_PAGER environment variable.
>        Note that git sets the LESS environment variable to FRSX if it is unset when it runs the pager. One can
>        change these settings by setting the LESS variable to some other value. Alternately, these settings can be
>        overridden on a project or global basis by setting the core.pager option. Setting core.pager has no affect
>        on the LESS environment variable behaviour above, so if you want to override git’s default settings this
>        way, you need to be explicit. For example, to disable the S option in a backward compatible manner, set
>        core.pager to less -+$LESS -FRX. This will be passed to the shell by git, which will translate the final
>        command to LESS=FRSX less -+FRSX -FRX. 
> ```

完全跳过寻呼机：

```
git config --global core.pager cat 
```

`-F`标志 to`less`很好，因为它告诉如果`less`它适合一页，则不要分页输出。

# java - JAVA中使用XML b/w两个系统的数据exahange的最佳加解密算法

> ID：11261092
> 
> 赞同：2
> 
> 时间：2012-06-29T11:38:48.467
> 
> 标签：java, encryption

我的要求是找到用于保护通过网络使用 XML 发送的数据的最佳算法。这是要在第三方之间交换的重要数据。

我知道这些天已经过时的DES。MD5 作为另一种选择出现，但这不允许解密取回数据（如果我错了，请纠正我）

我们还需要哪些其他选项来完成上述任务？哪种方式是最好和最标准的？

试用了AES，它使用公共密钥进行加密和解密。我探索的另一个选项是 RSA，它有两个公钥和私钥，用于加密和解密。

无法决定以上两种更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T11:46:26.097

您可以使用高级加密标准 (AES)。[AES和DES的区别](http://searchsecurity.techtarget.com/answer/The-differences-between-AES-and-DES)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:43:06.110

有一个 W3C 标准，称为[XML 加密语法和处理](http://www.w3.org/TR/xmlenc-core/)，它使用像 DES/3DES-CBC 对称密钥密码这样的密码。

# android - 如何将图像从 sd 卡添加到 html

> ID：11261096
> 
> 赞同：0
> 
> 时间：2012-06-29T11:39:21.420
> 
> 标签：android

我有一个 html 文件。我将其显示为 webview。我试图从 sd 添加图像，但我不能。这是我使用的代码：

```
<tr height="21" style='height:15.75pt'>
    <td height="21" class="xl71" style='height:15.75pt'>&nbsp;</td>
    <td class="borderLeft">&nbsp;</td>
    <td>&nbsp;</td>
    <td>
    <![if !vml]>
      <span style='mso-ignore:vglayout;add
  position:absolute;z-index:20;margin-left:24px;margin-top:3px;width:73px;
  height:144px'><img src="/sdcard/SurucuImza.jpg" alt="" width="168" height="120"       v:shapes="Picture_x0020_421" /></span>
      <![endif]>
      <span
  style='mso-ignore:vglayout2'>
        <table cellpadding="0" cellspacing="0">
          <tr> 
```

我在这里使用了路径：

```
<img src="/sdcard/SurucuImza.jpg" alt="" width="168" height="120" v:shapes="Picture_x0020_421" /> 
```

但它没有用。我无法显示图像。你有什么主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T11:44:55.463

尝试作为

```
 String base = Environment.getExternalStorageDirectory().getAbsolutePath().toString();
    String imagePath = "file:/"+ base + "/SurucuImza.jpg";
    String strimg="<img src=\""+ imagePath + "\" alt=\"\" width=\"168\" height=\"120\" v:shapes=\Picture_x0020_421\" />"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:46:54.260

尝试使用“file://mnt/sdcard/SurucuImza.jpg”。您可能需要允许使用此行进行访问： mWebView.getSettings().setAllowFileAccess(true);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T11:48:22.367

我要做的第一件事......是将图像复制到您的工作目录中。如果你不这样做，当你取出你的 SD 卡时……你可以和你的照片说再见了。

如果这是不可能的，只需将完整路径放入该位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-11T06:06:11.083

利用

```
src="file:///" + Environment.getExternalStorageDirectory() + "your_image_folder_name/SurucuImza.jpg" 
```

而不是

```
src="/sdcard/SurucuImza.jpg" 
```

**注意：首先授予清单的权限..**

```
android.permission.WRITE_EXTERNAL_STORAGE 
android.permission.READ_EXTERNAL_STORAGE 
```

# iphone - ios获取媒体库中项目的播放次数

> ID：11261100
> 
> 赞同：7
> 
> 时间：2012-06-29T11:39:32.397
> 
> 标签：iphone, objective-c, ios

我目前正在尝试对用户的音乐收藏进行分类，并且让用户播放最多的歌曲/艺术​​家的能力将极大地改善应用程序中的用户体验。是否有可能获得播放次数？我将如何去做

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-02T13:01:04.087

MPMediaItem 有方法：

```
- (id) valueForProperty: (NSString *) property 
```

此方法返回您想要相应值的媒体属性键。可能的值之一是 MPMediaItemPropertyPlayCount：

> 用户播放媒体项目的次数。Value 是一个表示 NSUInteger 数据类型的 NSNumber 对象。

[您可以在此处](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPMediaItem_ClassReference/Reference/Reference.html#//apple_ref/doc/constant_group/General_Media_Item_Property_Keys)和[此处](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPMediaEntity_ClassReference/Reference/Reference.html#//apple_ref/occ/instm/MPMediaEntity/valueForProperty:)查看文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-03T14:44:15.400

如果您想找到用户播放次数最多的曲目，您可以：

1.  将所有媒体项目（即`[[MPMediaQuery songsQuery] items]`）及其属性存储在数据库（即核心数据）中，使用 NSFetchRequest 获取它们并使用[NSSortDescriptor](http://developer.apple.com/library/mac/#documentation/cocoa/reference/CoreDataFramework/Classes/NSFetchRequest_Class/NSFetchRequest.html)对结果进行[排序](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSSortDescriptor_Class/Reference/Reference.html)。

2.  ...或使用`[[MPMediaQuery songsQuery] items]`和[排序](https://stackoverflow.com/questions/805547/how-to-sort-an-nsmutablearray-with-custom-objects-in-it)`MPMediaItemPropertyPlayCount`属性上的结果。

选项 (1) 可能是最好的，特别是如果您希望对音乐收藏进行分类（我猜 (2) 在性能方面也可能更差）。

在 SO上也[有一个类似的答案](https://stackoverflow.com/questions/7570969/getting-the-most-played-track-out-of-the-ipod-libray-mpmediaquery)来帮助回答您的问题。

[查看 Apple 文档](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPMediaItem_ClassReference/Reference/Reference.html)以获取有关 MPMediaQueries 的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T23:49:25.887

如果你使用 Core Data，他们有很多方法供你使用。看看这个：http: [//developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/cdProgrammingGuide.html](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/cdProgrammingGuide.html)

# javascript - node.js 中的“if (somefunction())”是否阻塞？

> ID：11261102
> 
> 赞同：1
> 
> 时间：2012-06-29T11:39:33.880
> 
> 标签：javascript, node.js

```
test = function(x){   
    if ( some conditions ) { return true; }
    else { return false; }
}

if (test(y)) {document.write("You have done this before!")​}​;​

console.log("Checked!"); 
```

目的是检查用户过去是否执行过某些操作。这些只是模拟代码，并不能真正反映我实际在做什么。

**问题：**

我对 node.js 比较陌生，所以如果这听起来微不足道，请原谅我。假设 test(y) 为真。我可以确定console.log会在document.write之后执行吗？即使 test(y) 需要很长时间才能运行？

换句话说，我需要“if (test(y))...”来阻止。我知道将函数作为参数传递，例如 setInterval(test(y),100); 可以是异步的和非阻塞的。但是“如果（测试（y））......”呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T11:42:14.970

NodeJS 同时具有同步（阻塞）和异步（非阻塞）功能。*（更准确地说：函数*本身*总是“阻塞”的，但是它们中的一整类开始一些稍后会完成然后立即返回的东西，而不是等待事情完成。这就是我所说的“非阻塞”。）*

大多数情况下的默认设置是异步的（当他们开始的事情完成时，他们接受他们调用的回调）；同步的名称往往以 . 结尾`Sync`。

例如，[`exists`](http://nodejs.org/api/fs.html#fs_fs_exists_path_callback)它是异步的（非阻塞），它没有返回值，而是在完成时调用回调。[`existsSync`](http://nodejs.org/api/fs.html#fs_fs_existssync_path)是同步的（阻塞）；它*返回*结果而不是回调。

如果`test`是你自己的函数，并且它只调用同步函数，那么它是同步的：

```
function test(x) { // Obviously a nonsense example, as it just replicates `existsSync`
    if (existsSync(x)) {
        // The file exists
        return true;
    }
    return false;
}

// This works
if (test("foo.txt")) {
    // ...
} 
```

如果它调用一个异步函数，它是异步的，因此它不能通过可以通过以下方式测试的返回值返回结果`if`：

```
// WRONG, always returns `undefined`
function test(x) {
    var retVal;

    exists(x, function(flag) {
        retVal = flag;
    });

    return retVal;
} 
```

相反，您必须提供回调：

```
function test(x, callback) {

    exists(x, function(flag) {
        callback(flag);
    });
}

// This works
test("foo.txt", function(flag) {
    if (flag) {
        // ...
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:45:16.307

是的，这段代码是同步执行和“阻塞”的。但是每次脚本运行时都会执行 console.log，因为您只在 if 语句中省略了 document.write。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T08:18:00.363

阻塞/非阻塞术语在这里有点混乱，我会说**“Node.JS 中的所有函数都是阻塞的，节点标准库中的所有 IO 都是非阻塞的，除非函数名称中的 Sync 后缀明确指出”。**

# php - PHP批处理文件重命名

> ID：11261103
> 
> 赞同：1
> 
> 时间：2012-06-29T11:39:35.370
> 
> 标签：php, regex, file-rename

我有一堆像这样命名的文件......

```
full-file(1).jpg
full-file(10).jpg
full-file(11).jpg
full-file(12).jpg
full-file(2).jpg
etc... 
```

我试图找出使用 PHP 重命名所有这些文件的最有效方法，以便它们像这样重命名......

```
full-file0001.jpg
full-file0010.jpg
full-file0011.jpg
full-file0012.jpg
full-file0002.jpg 
```

我已经从文件夹中读取所有文件并循环浏览它们，但不确定删除括号并使数字为 4 位且前导 0 的最佳方法。

```
$image_files = get_files($thumbpath);
foreach($image_files as $index=>$file) {
    echo $file;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T11:48:10.430

使用正则表达式获取数字，然后使用零填充它`sprintf()`：

```
$image_files = get_files($thumbpath);
foreach($image_files as $index=>$file) {
  // Capture \d+ into $matches[1]
  preg_match('/\((\d+)\)/', $file, $matches);
  // Pad it with %04d in sprintf()
  $newfile = sprintf("full-file%04d.jpg", $matches[1]);
} 
```

例子：

```
php > $file = 'full-file(12).jpg';
php > preg_match('/\((\d+)\)/', $file, $matches);
php > $newfile = sprintf("full-file%04d.jpg", $matches[1]);
php > echo $newfile;
// full-file0012.jpg 
```

### 更新（更灵活的文件名）：

为了取悦反对者，我只能假设想要更灵活的文件名，扩展正则表达式：

```
$image_files = get_files($thumbpath);
foreach($image_files as $index=>$file) {
  preg_match('/([^(]+)\((\d+)\)(.+)/', $file, $matches);
  $newfile = sprintf("%s%04d%s", $matches[1], $matches[2], $matches[3]);

  // And rename the file
  if (!rename($file, $newfile)) {
    echo "Could not rename $file.\n";
  }
  else echo "Successfully renamed $file to $newfile\n";
} 
```

该模式首先匹配，直到第一个的所有内容都匹配`(`，`([^(]+)`然后是数字 via `(\d+)`，剩下的所有内容都是 via `(.*)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T13:31:38.140

还没看到有人推荐[`sscanf()`](http://php.net/sscanf)。

```
<?php

$files = array(
  "full-file(1).jpg",
  "full-file(10).jpg",
  "full-file(11).jpg",
  "full-file(12).jpg",
  "full-file(2).jpg",
);

foreach ($files as $file) {
  $n = sscanf($file, "full-file(%d).jpg");
  printf("full-file%04d.jpg\n", $n[0]);
} 
```

返回：

```
full-file0001.jpg
full-file0010.jpg
full-file0011.jpg
full-file0012.jpg
full-file0002.jpg 
```

当然，这仅在“完整文件”是文件的实际名称时才有效。sscanf() 不是正则表达式解析器，它只是使用 printf() 样式的格式字符串提取数据……尽管它确实做了一些比[http://php.net/sscanf](http://php.net/sscanf)中记录的更高级的格式识别。如果需要处理其他文件名，可以扩展格式字符串：

```
<?php

$files = array(
  "this-file(1).jpg",
  "full-file(10).jpg",
  "foo(11).jpg",
  "blarg(12).jpg",
  "full-file(2).jpg",
);

foreach ($files as $file) {
  $n = sscanf($file, "%[a-z-](%d).jpg");
  printf("%s%04d.jpg\n", $n[0], $n[1]);
} 
```

返回：

```
this-file0001.jpg
full-file0010.jpg
foo0011.jpg
blarg0012.jpg
full-file0002.jpg 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T11:49:45.393

您可以混合使用 REGEXP（删除括号）和字符串填充（强制四位数字）。

注意我使用替换回调在一个地方执行这两项操作。

```
$files = array(
    'full-file(1).jpg',
    'full-file(10).jpg',
    'full-file(11).jpg',
    'full-file(12).jpg',
    'full-file(2).jpg'
);

function pr_callback($match) {
    return str_pad($match[1], 4, '0', STR_PAD_LEFT);
}
foreach($files as $file)
    echo preg_replace_callback('/\((\d+)\)/', pr_callback, $file).'<br />'; 
```

输出：

full-file0001.jpg
full-file0010.jpg
full-file0011.jpg
full-file0012.jpg
full-file0002.jpg

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T12:08:46.463

*使用代码：*

```
preg_match('/^(.*?)\((\d+)\)(.*)$/', $name, $m);
$name = sprintf("%s%04d%s", $m[1], $m[2], $m[3]); 
```

*[在这里](http://ideone.com/BA94q)查看并测试它。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-29T11:47:13.830

您将需要[str-pad()](http://php.net/manual/en/function.str-pad.php)。样品很快...

**编辑 1**：使用`str_pad`和的解决方案`preg_replace_callback`。
**OBS**：仅在 php5.3+ 中的匿名函数。

```
foreach ($image_files as $file)
{
    $o = preg_replace_callback(
            "|\((\d+)\)|", function($matches)
            {
                $r = str_pad($matches[1], 4, '0', STR_PAD_LEFT);
                return $r;
            }
            , $file);

    echo $o . "\n";
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-29T12:00:33.183

假设您的文件实际上并未称为**完整文件**（0000）。**.jpg**：

```
<?php 
$arr = array('full-file(1).jpg',
             'full-file(10).jpg',
             'full-file(11).png',
             'full-file(12).jpg',
             'full-file(2).gif',
             'abc(12345).jpg',
             'def(99).jpg',
             'xzy-file(100).jpg');

function format_filename($matches){
  return $matches[1].sprintf("%04d",$matches[3]).'.'.$matches[5];
}
function process_array(&$value){
    $value = preg_replace_callback('/^(.*?)(\()(\d+)(\)).(jpg|png|gif)/','format_filename',$value);
}

array_walk($arr,'process_array');

print_r($arr);
/*
Array
(
    [0] => full-file0001.jpg
    [1] => full-file0010.jpg
    [2] => full-file0011.png
    [3] => full-file0012.jpg
    [4] => full-file0002.gif
    [5] => abc12345.jpg
    [6] => def0099.jpg
    [7] => xzy-file0100.jpg
)
*/
?> 
```

# javascript - 如何通过创建事件的javascript中定义的处理程序来处理事件？

> ID：11261104
> 
> 赞同：0
> 
> 时间：2012-06-29T11:39:38.873
> 
> 标签：javascript, jquery, events, dynamic, handler

我打开一个包含 myApp.js 的 html 页面，如下所示：

```
<html>
<body>
......
<div id="dynamicForm"></div>
......
<script type="text/javascript" src="myPath/myApp.js"></script>
......
</body>
</html> 
```

然后我想在这个html页面（“#dynamicForm”）上动态加载myApp.js中定义的表单，myApp.js有一些这样的行：

```
.....
//load the form on the html page
$('#dynamicForm').html(createDynamicForm()).show();         
.....
//the function creating the form
function createDynamicForm(){
  var jqForm=$('<form id="dynamicFormId">'
  ......
  + '<button id="btn">OK</button>'
  + '</form>');
  $('body').append(jqForm);
  return jqForm;
}
.....
//click the button on the form to trigger the alert box
("#btn").click(function(){
    alert("you click the button");
}); 
```

我可以在html页面上加载表单，但是当我在这个动态加载的表单上单击“确定”按钮时，没有弹出警报，显然这是因为myApp.js在动态表单之前加载了html页面创建后，“click”事件无法由创建表单的 myApp.js 中定义的处理程序处理。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:40:24.480

当您尝试`#btn`动态时，您需要一个委托事件处理程序，为此您应该使用**[`.on()`](http://api.jquery.com/on)**.

```
$('body').on('click', '#btn', function(){
    alert("you click the button");
}); 
```

`.on()`委托事件的语法看起来：

```
$(staticElement).on( eventName, target, handlerFunction ); 
```

这里，`staticElement`指向在页面加载时属于 DOM 的元素，即不是动态的。

# jsp - 如何将值从 displaytag 传递到新窗口并显示它？

> ID：11261105
> 
> 赞同：0
> 
> 时间：2012-06-29T11:39:49.117
> 
> 标签：jsp, struts, displaytag

我努力了

```
<display:table name="jobTrackerCol" pagesize="20" sort="list" id="data" requestURI="" class="tablelist">   
            <display:column title="Request Id" sortable="true" ><%-- property="request_id" > --%>   
            <a href=# onClick="popupSmallWindow('${data.query}');">${data.request_id}</a>   
            </display:column>   
</display:table> 
```

javascript

```
function popupSmallWindow(query){   
    //window.location="http://www.continue.com";    
    myString = query.replace(/[\r\n]/g, "<br />");    

    alert(myString);   
} 
```

${data.query} 中的值是长 sql 查询。

当我单击链接时，我想在警报或新窗口中显示该查询。请指导我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:47:31.980

首先，您需要对查询进行 JavaScript 转义。确实，如果您查询的是

```
select a.id from a where a.name = 'doe' 
```

生成的 HTML 代码将是：

```
onClick="popupSmallWindow('select a.id from a where a.name = 'doe'');" 
```

这显然会导致问题，因为由于未转义的单引号，JS代码将无效。

您可以使用 apache commons-lang [StringEscapeUtils.escapeECMAScript()](http://commons.apache.org/lang/api/org/apache/commons/lang3/StringEscapeUtils.html#escapeEcmaScript%28java.lang.String%29)来做到这一点。

现在，警告框不显示 HTML。因此，如果要在警报框中显示它，则不能转换`\r\n`为。`<br/>`保持原样，警报框将很好地显示查询。

如果你想要 HTML 支持，你可以使用 jQuery UI 的[对话框](http://jqueryui.com/demos/dialog/)来显示你的 SQL 查询。如果这样做，则需要替换`\r\n`为`<br/>`。但是您可以在 Java 中执行此操作，并将查询放置在 jquery UI 对话框将用作其对话框内容的隐藏 div 中。

# iphone - 通过传递目标c中的变量将字符串附加到文件名

> ID：11261109
> 
> 赞同：0
> 
> 时间：2012-06-29T11:40:04.947
> 
> 标签：iphone, objective-c, cocos2d-iphone, nsstring

```
NSString *devicetype;       

if((UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)){  
devicetype = @"ipad";  
}else{    
devicetype = @"iphone";  
} 
```

* * *

我有两张图片

背景_IPAD.PNG

和

背景_IPHONE.PNG

现在我想使用这个字符串

```
BackGround = [CCSprite spriteWithFile:[NSString StringWithFormat:@"background_%@.png",DEVICETYPE]]; 
```

这可能吗？如果没有，那么有没有更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T11:42:42.933

是的，您可以使用它，但是您可以将图像的名称更改为以下内容

```
Image~ipad.png 
Image~iphone.png 
```

现在，当您加载图像时

```
//on the iPhone and iPad use the same image name
//image named will select the image automatically
UIImage *image = [UIImage imageNamed:"Image"]; 
```

它将根据您当前的设备自动选择图像

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:48:44.963

是的，它有效。我已经测试并成功运行。

# qt - 将 QToolButton 附加到父 QWidget 的右下角

> ID：11261111
> 
> 赞同：1
> 
> 时间：2012-06-29T11:40:14.097
> 
> 标签：qt, pyqt

我面临这个问题，作为一个 Qt 菜鸟我​​无法解决它。

基本上，我实例化了 a`QToolButton`并将其作为`QTreeWidget`. 这`QTreeWidget`是在垂直布局中，当我尝试更改使用中工具按钮的位置时，`QTreeWidget`它`QTreeWidget.size()`给了我非常意想不到和错误的结果。

谁能帮我这个？将深深感谢您的帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T05:12:03.723

您还没有发布任何实际操作的示例，但这里是如何将按钮附加到树小部件的右下角：

*编辑：看到你想在树上合成小部件后，我已经替换了我的答案*

## 使用事件过滤器

```
from PyQt4 import QtCore, QtGui

class Widget(QtGui.QWidget):

    def __init__(self, parent=None):
        super(Widget, self).__init__(parent)
        self.resize(640,480)

        self.layout = QtGui.QVBoxLayout(self)
        self.layout.setSpacing(0)

        self.tree = QtGui.QTreeWidget(self)
        self.tree.installEventFilter(self)
        self.layout.addWidget(self.tree)

        self.button = QtGui.QToolButton(self.tree)
        self.button.setText("FOO")
        self.button.setMinimumSize(100, 30)

    def eventFilter(self, obj, event):
        if obj is self.tree and event.type() == event.Resize:
            self.alignTreeButton()       
        return False

    def alignTreeButton(self):
        padding = QtCore.QSize(5,5) # optional
        newSize = self.tree.size() - self.button.size() - padding
        self.button.move(newSize.width(), newSize.height())          

if __name__ == "__main__":
    app = QtGui.QApplication([])
    w = Widget()
    w.show()
    w.raise_()
    app.exec_() 
```

该按钮只是树的父级，我们在树上安装事件过滤器以捕获调整大小事件。调整树的大小后，我们获取它的大小，减去按钮的大小，然后移动按钮。

## 使用组合

我相信实际上将 QTreeWidget 子类化，将其与 QToolButton 作为成员组合，然后在`resizeEvent()`本地重载以处理调整大小会更有效。首先，这使得 TreeWidget 的行为处理本地化，这样更干净。此外，我相信它可以减少 EventFilter 将添加到您的主窗口的开销。eventFiler 将是一个可调用多次的 python 可调用对象，因为它处理对象的每个事件。而 TreeWidget 的本地 resizeEvent() 仅在调整大小期间调用。

```
class Widget(QtGui.QWidget):

    def __init__(self, parent=None):
        super(Widget, self).__init__(parent)
        self.resize(640,480)

        self.layout = QtGui.QVBoxLayout(self)
        self.layout.setSpacing(0)

        self.tree = TreeWidget(self)
        self.layout.addWidget(self.tree)     

class TreeWidget(QtGui.QTreeWidget):

    def __init__(self, *args, **kwargs):
        super(TreeWidget, self).__init__(*args, **kwargs)
        self.button = QtGui.QToolButton(self)
        self.button.setText("FOO")
        self.button.setMinimumSize(100, 30)

    def resizeEvent(self, event):
        super(TreeWidget, self).resizeEvent(event)
        self.alignTreeButton()

    def alignTreeButton(self):
        padding = QtCore.QSize(5,5) # optional
        newSize = self.size() - self.button.size() - padding
        self.button.move(newSize.width(), newSize.height()) 
```

# c# - 使用相同类型参数关闭时，如何检查类型是否可分配给打开的泛型类型？

> ID：11261112
> 
> 赞同：2
> 
> 时间：2012-06-29T11:40:19.787
> 
> 标签：c#, generics, reflection

如果传递的类型可分配给（派生自）开放（无界）泛型类型的闭包，我需要一个返回 true 的方法。该方法应按以下方式工作：

```
OpenGenericIsAssignableFrom(typeof(ICollection<>), typeof(IList<String>)) 
```

应该返回真。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:59:59.633

为什么不简单地关闭开放的泛型类型，看看它是否可以从封闭的类型中获取？问题是用相同的参数关闭它可能无效，所以你需要抓住它

```
private static bool OpenGenericIsAssignableFrom(
    Type openGenericType, 
    Type typeToCheck)
{
    if (!openGenericType.IsGenericType || typeToCheck == null) return false;

    if(typeToCheck.IsGenericType)
    {
        var typeArgs = typeToCheck.GetGenericArguments();
        if (typeArgs.Length == openGenericType.GetGenericArguments().Length)
        {
            try
            {
              var closed = openGenericType.MakeGenericType(typeArgs);
              return closed.IsAssignableFrom(typeToCheck);
            }
            catch
            {
              //violated type contraints
              return false
            }
        }
    }
    else 
    {
        return OpenGenericIsAssignableFrom(openGenericType, typeToCheck.BaseType) 
              || typeToCheck.GetInterfaces()
                    .Any(i=> OpenGenericIsAssignableFrom(openGenericType,i));
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T11:46:40.723

扩展[检查类是否派生自泛型类](https://stackoverflow.com/questions/457676/check-if-a-class-is-derived-from-a-generic-class)，这是一个可能的解决方案：

```
 private static bool OpenGenericIsAssignableFrom1(Type openGenericType, Type typeToCheck)
        {
            return typeToCheck != null && typeToCheck != typeof(Object) && // Terminate recursion
                ((typeToCheck.IsGenericType && (typeToCheck.GetGenericTypeDefinition() == openGenericType)) || // typeToCheck is as closure of openGenericType
                OpenGenericIsAssignableFrom(openGenericType, typeToCheck.BaseType) || // typeToCheck is the subclass of a closure of openGenericType
                typeToCheck.GetInterfaces().Any(interfaceType => OpenGenericIsAssignableFrom(openGenericType, interfaceType))); // typeToCheck inherits from an interface which is the closure of openGenericType
        } 
```

# jquery - 在剑道组合框中动态添加项目

> ID：11261113
> 
> 赞同：9
> 
> 时间：2012-06-29T11:40:22.527
> 
> 标签：jquery, html, css, combobox, kendo-ui

如果你们中的任何人都使用过 kendo ui，请告诉我如何在 kendo 组合框中动态添加新项目。

我试过在谷歌和任何地方搜索，我的结论是剑道没有这样的功能。

供参考 - [JSBIN](http://jsbin.com/ebutaw/2/edit#source)

剑道链接 -[这里](http://demos.kendoui.com/web/combobox/index.html)

提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-29T14:12:52.083

您可能知道，有两种方法可以创建组合框（选择和输入）。我无法使用 select 动态添加新项目（如您的示例）。但是，使用输入和数据绑定很简单。

```
$("#comboBox").data("kendoComboBox").dataSource.add({ text: "Five", value: "5" }); 
```

[JSBIN 示例 1](http://jsbin.com/ebutaw/3/edit#source)。 [JSBIN 示例 2](http://jsbin.com/ebutaw/4/edit)。

# .net - 带有查询字符串的 WCF 发布

> ID：11261119
> 
> 赞同：3
> 
> 时间：2012-06-29T11:40:45.737
> 
> 标签：.net, wcf, operationcontract, webinvoke

我目前正在开发一个 Windows 服务托管的 WCF 服务。其中一种方法有一个 URI，该 URI 被设置为接收来自支付提供商的回调。这是接口契约...

```
 [OperationContract]
    [WebInvoke(UriTemplate = "3DSecureCallback?TrxId={id}", Method = "POST", BodyStyle = WebMessageBodyStyle.Bare)]
    void ThreeDSecureCallBack(string id, Stream body); 
```

我遇到的这个问题是第 3 方提供商发布到我们的服务。我必须为它提供一个回调 url。所以我们可以核对付款，我们提供一个带有查询字符串参数的 URL，其中包含交易 ID。

在此服务的开发过程中，回调已经成功。（这是在添加 Steam 参数之前）

但是，我们现在处于需要解析发布数据的阶段。这就是将第二个“Stream”参数添加到方法签名的地方。

我得到的问题是我收到以下异常......

```
For request in operation ThreeDSecureCallBack to be a stream the operation must have a single parameter whose type is Stream. 
```

通过去掉 id 参数，只有流，我们可以得到 post 数据。这在实践中不起作用，因为我还需要查询字符串参数。

任何人都可以建议如何解决这个问题吗？我真的很茫然。

提前致谢，

大卫

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T13:20:09.140

您可以访问查询字符串“id”值，如下所示

`WebOperationContext.Current.IncomingRequest.UriTemplateMatch.QueryParameters["id"]`

现在您的流类型方法只能有一个参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-14T21:39:05.150

唤醒一个旧线程，但认为记录另一种方法会有所帮助。

将 WeInvoke 方法的 BodyStyle 更改为 Wrapped 将解决您未在 UriTemplate 上指定的任何参数被假定来自请求正文的问题。

唯一的缺点是您还必须包装您的帖子数据......并且使用内置数据类型作为额外参数，或者定义您自己的合适的 DataContract。

例子：

```
[DataContract]
public class PostInfo
{
  [DataMember]
  public string Info1;
  [DataMember]
  public string Info2;
}

[OperationContract]
[WebInvoke(UriTemplate = "3DSecureCallback?TrxId={id}", Method = "POST", BodyStyle = WebMessageBodyStyle.Wrapped)]
void ThreeDSecureCallBack(string id, PostInfo body); 
```

来源： [msdn 论坛](https://social.msdn.microsoft.com/Forums/vstudio/en-US/e2d074aa-c3a6-4e78-bd88-0b9d24b561d1/how-to-declare-post-parameters-in-wcf-rest-contract?forum=wcf)

# c++ - 如何从集合中删除一个指定的指针*？

> ID：11261121
> 
> 赞同：-1
> 
> 时间：2012-06-29T11:40:48.447
> 
> 标签：c++, stl

如果我有`set<Pointer*>`，`Pointer*`是指向自定义类的指针，`set`来自标准库。如何从指定的一组中删除`Pointer*`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:50:05.480

使用 set<>::erase 函数。这是我编写的一些代码来演示：

```
#include <set>
#include <cassert>

int main()
{
    int *a = new int(1);
    int *b = new int(2);

    std::set<int*> s;
    s.insert(a);
    s.insert(b);

    s.erase(b);

    assert(s.find(a) != s.end());
    assert(s.find(b) == s.end());

    delete a;
    delete b;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T11:45:35.277

来自[SGI 的 STL 文档](http://www.sgi.com/tech/stl/set.html)：

```
size_type erase(const key_type& k)  Associative Container   Erases the element whose key is k. 
```

`std::set`不管包含指针或任何其他类型的事实，这都会从集合中删除一个元素。如果你的指针指向一个动态分配的对象/数组，你必须记住在从集合中删除它之后`delete`/ `delete[]`it （这不应该是一个问题，因为你已经有了指针）

# javascript - 如何在 Wicket 中为 TinyMCE 设置 content_css？

> ID：11261122
> 
> 赞同：1
> 
> 时间：2012-06-29T11:40:50.663
> 
> 标签：javascript, tinymce, wicket, wicketstuff

我对 wicket 有点陌生，正在尝试为 tinymce 编辑器设置 content_css。但无法弄清楚如何通过`CssResourceReference`. 我只想引用我们常规检票口标记 ( `<link href="c/lw.css" ...>`) 中的样式表，以便 tinymce 中的预览看起来正确。在代码中：

```
TinyMCESettings s = new TinyMCESettings(TinyMCESettings.Theme.advanced);
s.setContentCss(????); 
```

进入`setContentCss`什么？无论我尝试什么

```
CssResourceReference css = new CssResourceReference(this.class, "lw.css"); 
```

指向一些奇怪的东西，`wicket/resource/wicket.contrib.tinymce...`但从不指向我们样式表的实际位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:18:01.830

答案可能有点晚了，但考虑到“c/lw.css”在 html 中有效，您应该在资源参考中写下相同的内容：

```
CssResourceReference css = new CssResourceReference(this.class, "c/lw.css"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:46:49.790

您可能想看看这个 SO 问题：[Styling text for textarea Wicket](https://stackoverflow.com/questions/8787197/styling-text-for-textarea-wicket)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-23T13:22:53.813

可以通过这种方式添加应该设置 TinyMCE 编辑器样式的 css 样式表（css 文件应该与 java 类放在同一个包中）：

```
TextArea ta = new TextArea("ta");
TinyMCESettings settings = new TinyMCESettings(TinyMCESettings.Theme.advanced);
ResourceReference cssRef = new CssResourceReference(this.getClass(), "tinymce.css");
settings.setContentCss(cssRef);
ta.add(new TinyMceBehavior(settings)); 
```

* * *

**完整示例：**

爪哇

```
public class TinyMCEPage extends WebPage {

    public TinyMCEPage() {
        TextArea ta = new TextArea("ta");

        TinyMCESettings settings = new TinyMCESettings(TinyMCESettings.Theme.advanced);
        ResourceReference cssRef = new CssResourceReference(this.getClass(), "tinymce.css");
        settings.setContentCss(cssRef);

        ta.add(new TinyMceBehavior(settings));
        add(ta);
    }
} 
```

HTML

```
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Title</title>
<link rel="stylesheet" href="style.css" type="text/css" />
</head>
<body>
    <textarea wicket:id="ta" id="ta" name="ta"></textarea>
</body>
</html> 
```

要设置 TinyMCE 编辑器的宽度和高度等样式，请使用 textarea 的 id（应在文件“style.css”中指定 - 设置 html 页面样式的文件）：

```
#ta {
    width: 800px;
    height: 600px;
} 
```

要设置 TinyMCE 编辑器的输入区域的样式，例如字体大小、颜色等，请使用资源文件（在本示例文件中为“tinymce.css”）和 css 选择器主体：

```
body {
    font-size: 14px;
    background-color: #ffeedd;
    border: 1px solid #333;
} 
```

此示例已使用：wicket.version 6.17.0 和 wicketstuff-tinymce 版本 6.16.0 进行了测试。

# sql - RDBMS 中的传递依赖有什么问题？

> ID：11261129
> 
> 赞同：1
> 
> 时间：2012-06-29T11:41:28.217
> 
> 标签：sql, database, normalization

我在 Wikipedia 上研究[Wikipedia](http://en.wikipedia.org/wiki/Third_normal_form)中有关 Database Normalization 2NF 的文章时，遇到了最后一个示例，关于锦标赛获胜者。那里说，因为表中有传递依赖，它不在 2NF 中，需要进一步优化（比如将其拆分为更多表）以将其恢复到 3NF 并消除数据损坏的机会。谁能告诉我什么样的“腐败”会蔓延到“显示同一个人在不同的记录上显示不同的出生日期”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:55:53.940

想象一下，一旦你插入了这一行：

```
 Indiana Invitational   1998    Al Fredrickson  21 July 1975 
```

然后你插入这个（比如说，错误地）：

```
 Des Moines Masters     1999    Al Fredrickson  20 June 1985 
```

如您所见，同一个人在此表中有 2 个不同的生日。维基百科文章说的是生日取决于人，这不是主键。这意味着这个人可以重复，如果你不注意，它的依赖属性（例如出生日期）可能会改变。

您应该做的是创建另一个以人名作为主要属性的表，并将其相关数据移动到该表（例如人的出生日期）。这样，您将避免冗余`(name, birthday)`元组并防止可能的损坏（以及节省内存）。

# android - 在 Android 中使用 XML 解析器从服务器读取和解析 PDF 文件

> ID：11261138
> 
> 赞同：0
> 
> 时间：2012-06-29T11:42:19.813
> 
> 标签：android

如何从Android中的服务器读取和解析解析器内的PDF文件URL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:05:25.480

我不太明白你想说什么。也许情况是您有一个 PDF 文件，并且 PDF 中有一些内部 URL，您正试图通过 XML 解析来访问它们？

如果是这种情况，我认为您不能这样做，因为首先 PDF 文件类似于“压缩签名”表单，您无法访问内容（与 .txt 文件不同）。而且我很确定您不能使用 XML 解析来解析 PDF 文件。

另一种解决方案是搜索和下载一些用于处理 PDF 文件的第三方应用程序。

# jquery - JQuery - 直接孩子的直接孩子

> ID：11261146
> 
> 赞同：2
> 
> 时间：2012-06-29T11:42:51.737
> 
> 标签：jquery, jquery-selectors

谁能帮我。我有一个表格，其中一个单元格中包含一个嵌套表格。我想附加“你好世界！” 到外部表格每一行的第一个单元格（所以在下面的 html 中，我只想附加到单元格 1a 和 2a）。我尝试了以下方法：

```
$("div > table > tr > td:first-child").append(' Hello World!'); 
```

在下面的 html 上：

```
<div class="divClass">

    <table class="tableClass" border="1px">
        <tr>
            <td>1a</td>
            <td>1b</td>
          </tr>
     <tr>
            <td>2a</td>
            <td>2b
              <table border="1px"><tr><td>nested table cell</td></tr></table>

            </td>
    </tr>
    </table>

</div>​ 
```

但它不起作用。（[-http://jsfiddle.net/NickyW/x3bqf/](http://jsfiddle.net/NickyW/x3bqf/)）

有什么建议么？

谢谢，

缺口

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T11:48:51.930

```
$("div > table > tbody > tr > td:first-child").append(' Hello World!'); 
```

您只需要使用`tbody`它，因为它是通过浏览器添加到表中的。这个比较靠谱。

**[演示](http://jsfiddle.net/x3bqf/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:56:12.657

很简单，只需要添加tbody，不需要引用div，请使用类引用。

```
 $(function () {

        $(".tableClass > tbody > tr > td:first-child").append(' Hello World!');

    }); 
```

[解决方案](http://jsfiddle.net/x3bqf/6/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-29T11:47:34.673

追加是什么意思？您想将单元格的值设置为 Hello world 吗？

然后你应该用 $(..).html('Hello World');

如果您想将其附加到 1a 例如：

试试 $(..).html($(..).html()+"Hello World");

# c# - 是否有在后台线程上初始化对象的通用模式？

> ID：11261147
> 
> 赞同：5
> 
> 时间：2012-06-29T11:42:53.020
> 
> 标签：c#, .net, multithreading, background, parallel-processing

我有一个需要很长时间才能初始化的对象。因此，我能够在应用程序启动时开始初始化。任何后续调用类上的方法，我们都需要有一个延迟机制来等待类完成初始化。

我有几个潜在的解决方案，但我对其中任何一个都不完全满意。第一个在 while 循环中使用 Task.Delay，第二个使用 SemaphoreSlim 但涉及一些不必要的阻塞。我觉得这一定是一个相当普遍的要求，有人可以就如何最好地管理这个问题提供一些建议吗？

哦，顺便说一句，这是一个 Metro 应用程序，所以我们的 API 有限

这是伪代码：

```
public class ExposeSomeInterestingItems
{
    private InitialisationState _initialised;
    private readonly SemaphoreSlim _waiter = 
        new SemaphoreSlim(0);

    public async Task StartInitialize()
    {
        if (_initialised == InitialisationState.Initialised)
        {
            throw new InvalidOperationException(
                "Attempted to initialise ActiveTrackDown" +
                "loads when it is already initialized");
        }

        _initialised = 
            InitialisationState.StartedInitialisation;

        new TaskFactory().StartNew(async () =>
        {
            // This takes some time to load
            this._interestingItems = 
                InterestingItemsLoader.LoadItems();
            _waiter.Release();
            _initialised = InitialisationState.Initialised;
        });
    }

    public InterestingItem GetItem(string id)
    {
        DelayUntilLoaded();
        DelayUntilLoadedAlternative();
    }

    private async Task DelayUntilLoaded()
    {
        if (_initialised == InitialisationState.NotInitialised)
        {
            throw new InvalidOperationException("Error " +
                "occurred attempting to access details on " +
                "ActiveTrackDownloads before calling initialise");
        }

        while (true)
        {
            if (_initialised == InitialisationState.Initialised)
            {
                return;
            }

            await Task.Delay(300);
        }
    }

    private async Task DelayUntilLoadedAlternative()
    {
        if (_initialised == InitialisationState.NotInitialised)
        {
            throw new InvalidOperationException(
                "Error occurred attempting to access details " + 
                "on ActiveTrackDownloads before calling initialise");
        }

        try
        {
            await _waiter.WaitAsync();
        }
        finally
        {
            _waiter.Release();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:54:38.333

你可以使用`Task<T>`这个。这将为您处理所有同步，并允许您阻塞直到值可用：

```
private static Task<HeavyObject> heavyObjectInitializer;

// Call this method during application initialization
public static void Bootstrap()
{
    heavyObjectInitializer = new Task<HeavyObject>(() =>
    {
        // creation of heavy object here
        return new HeavyObject();
    });

    // Start running the initialization right now on a 
    // background thread. We don't have to wait on this.
    heavyObjectInitializer.Start();
}

// Call this method whenever you need to use the object.
public static HeavyObject GetHeavyObject()
{
    // Get the initialized object, or block untill this 
    // instance gets available.
    return heavyObjectInitializer.Result;  
} 
```

或者，您还可以查询对象是否可用：

```
public static bool IsHeavyObjectAvailable
{
    get { return heavyObjectInitializer.IsCompleted; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T14:02:31.910

我认为更好的设计是异步工厂，其中*调用*代码`await`创建对象，然后接收常规对象实例。

[从 Stephen Toub 那里](http://blogs.msdn.com/b/pfxteam/archive/2011/01/15/10116210.aspx)偷窃：

```
public class AsyncLazy<T> : Lazy<Task<T>> 
{ 
  public AsyncLazy(Func<T> valueFactory) : 
      base(() => Task.Run(valueFactory)) { }

  public AsyncLazy(Func<Task<T>> taskFactory) : 
      base(() => Task.Run(taskFactory)) { } 

  public TaskAwaiter<T> GetAwaiter() { return Value.GetAwaiter(); } 
}

public static class ExposeSomeInterestingItemsFactory
{
  public static AsyncLazy<ExposeSomeInterestingItems> Instance
  {
    get { return _instance; }
  }

  private static readonly AsyncLazy<ExposeSomeInterestingItems> _instance =
      new AsyncLazy<ExposeSomeInterestingItems>(() => new ExposeSomeInterestingItems());

  public static void StartInitialization()
  {
    var unused = Instance.Value;
  }
}

public class ExposeSomeInterestingItems
{
  public ExposeSomeInterestingItems()
  {
    // This takes some time to load
    this._interestingItems = InterestingItemsLoader.LoadItems();
  }

  public InterestingItem GetItem(string id)
  {
    // Regular logic. No "delays".
  }
}

...

var exposeSomeInterestingItems = await ExposeSomeInterestingItemsFactory.Instance;
var item = exposeSomeInterestingItems.GetItem("id"); 
```

这样，您就可以很好地保持单一职责原则：

*   `AsyncLazy<T>`与`Task<T>`（`Lazy<T>`因此仅在需要时才异步创建实例）。
*   `ExposeSomeInterestingItemsFactory`包含构造逻辑。
*   `ExposeSomeInterestingItems`只关心暴露有趣的项目，而不必用异步延迟污染其所有成员。

此外，此解决方案始终是异步的（无阻塞），这很好（特别是对于 Metro 应用程序）。

**2012 年 9 月14 日更新：**我已将这段代码清理干净，并[在我的博客上](http://nitoprograms.blogspot.com/2012/08/asynchronous-lazy-initialization.html)发表了评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T11:58:02.453

将方法调用放入完成初始化后处理的队列中。仅在尚未初始化时才将方法放入队列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T12:10:52.920

您可以迁移到应用程序处于不同状态的事件驱动架构。

最初，应用程序进入**启动**状态。在这种状态下`HeavyObject`是使用后台任务创建的。初始化完成后会触发一个事件。（您不必使用实际的 .NET `event`。您可以使用回调或类似的东西，像 Reactive Extensions 这样的框架允许您组合事件序列。）

当所有初始化事件都触发后，您将进入应用程序的**Started**状态。对于 UI 应用程序，这可以修改 UI 以启用一些以前禁用的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T12:20:06.167

检查这个[原型模式](http://en.wikipedia.org/wiki/Prototype_pattern)。也许它可以帮助你

您只需要创建一次对象并在需要另一个对象时克隆它。

# java - install4j 打包的应用程序需要管理员访问权限才能访问 Windows 7 上的磁盘

> ID：11261150
> 
> 赞同：2
> 
> 时间：2012-06-29T11:42:59.267
> 
> 标签：java, installation, install4j

我们正在使用 install4j 为 Windows 打包 Java 7 应用程序。我们遇到的问题是，在我的 Windows 7 计算机上，我需要以管理员身份运行已安装的应用程序才能正常工作。它在需要访问磁盘的地方失败。如果我以管理员身份运行它，那么它工作正常。

有没有解决的办法？我使用了与 install4j 和访问磁盘一起打包的其他应用程序，我不需要以管理员身份运行，所以我怀疑我想要的是可能的。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:50:24.967

它是一个什么样的应用程序？通常所有应用程序都将安装在`C:\Program Files`文件夹中。并且可能 install4j 会尝试将您的应用程序安装到该`C:\Program Files`文件夹​​中。

普通用户（不是管理员）无权更改此目录，也不会在那里创建新文件夹。

是否需要安装应用程序，或者只需将其包装在 exe 文件中即可启动？

如果安装是强制性的，即您需要系统文件夹，访问系统 dll，则需要管理员权限，这是合乎逻辑的。

如果您可以省略安装并使用可移植的 exe 文件，则为 java 应用程序使用 exe-wrapper。例如 - [JSmooth](http://jsmooth.sourceforge.net/)

# eclipse - Aptana Studio 3 + App Engine Python + 无法解析 memcache 的某些方法

> ID：11261161
> 
> 赞同：4
> 
> 时间：2012-06-29T11:43:33.530
> 
> 标签：eclipse, google-app-engine, memcached, aptana

我正在使用 Aptana Studio 3，并且在访问任何 App Engine Api 库（例如 urlfetch）时都没有问题。

但是，今天我遇到了一个奇怪的 Aptana 问题，或者我错过了一些配置：

```
from google.appengine.api import memcache 
```

aptana 解析 memcache 导入。但是当我试图访问 memcache 方法时，自动辅助显示最多**只有 7 个方法**，而 memcache 应该有很长的方法列表。

我已经验证了 memcache 实际上是通过以下方式导入到 Aptana 的：

1.  上传到 GAE 服务器，尽管错误突出显示，memcache 仍然有效。
2.  我打开了memcache文件，方法都在那里。

但是，Aptana Studio 3：

1.  未能解决重要方法 --> 获取、设置、添加等。

    ![缺少 memcache.get](../Images/99603df459f17d3004417dcc546fd369.png)

2.  但是，这 7 种方法都解决了 --> create_rpc, setup_client, _add_name_space, _decode_value, _is_pair, _key_string, _validate_encode_value

3.  即使是解决的 7 个方法，也只有 2 个是公共的，而其他 5 个是私有的。

4.  我打开大纲视图查看 memcache python 文件中列出的所有方法，并意识到尽管代码都在那里（get、set 等），但仅显示相同的 7 个方法

这是我试图解决的问题：

1.  我从项目 Python 路径配置中删除了所有外部库导入，然后读回了 App Engine 文件夹。
2.  值得注意的变化只有 1，现在大纲视图显示了 Memcache python 文件中的所有正确方法。
3.  但是，尽管大纲视图显示正确，但方法仍未解决。相同的 7 个方法是唯一解决的方法。

虽然它在 GAE 中运行良好，但无法在不断突出显示内存缓存方法错误的 IDE 上运行。

有人可以就此提出建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T16:11:34.587

解决方案非常简单。

1.  优先添加完整的模块名称“xxx”到强制内置 -> pydev - 解释器 - Python。
2.  重新启动 Eclipse，重建或强制从项目 -> pydev -> python 路径恢复内部信息 - 这取决于 eclipse 和配置尝试首先工作或组合。

在这篇文章中查看它的图片[http://viblogrock.wordpress.com/2011/01/01/pydev%E3%81%A7gae%E3%81%AEmemcache%E3%81%8C%E3%82%A8%E3 %83%A9%E3%83%BC%E3%81%AB%E3%81%AA%E3%82%8B%E4%BB%B6/](http://viblogrock.wordpress.com/2011/01/01/pydev%E3%81%A7gae%E3%81%AEmemcache%E3%81%8C%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%AA%E3%82%8B%E4%BB%B6/)

![在此处输入图像描述](../Images/42870ea5f2da34a7b28c9cc7ae0e0fd1.png)

给出答案接受！

# java - 使用 SSHj 进行 SSH 端口转发

> ID：11261162
> 
> 赞同：3
> 
> 时间：2012-06-29T11:43:35.200
> 
> 标签：java, ssh, port, forwarding, sshj

我正在尝试创建一个隧道以使用支持 SSH 的防火墙后面的服务。我想要一个完整的 java 解决方案，但我似乎无法让它工作。我找到了这个[github 片段](https://github.com/shikhar/sshj/blob/master/src/main/java/examples/RemotePF.java "github截图")，并在此基础上创建了以下代码来保持后台线程为我提供隧道：

```
// property on surrounding class
// static final SSHClient sshclient = new SSHClient();

Thread thread = new Thread(new Runnable() {

    @Override
    public void run() {
        try {
            String host = "10.0.3.96";
            sshclient.useCompression();
            sshclient.addHostKeyVerifier("30:68:2a:20:21:9f:c8:e8:ac:b4:a7:fc:2d:a7:d0:26");
            sshclient.connect(host);
            sshclient.authPassword("messy", "messy");
            if (!sshclient.isAuthenticated()) {
                throw new RuntimeException(String.format("Unable to authenticate against '%s'", host));
            }
            Forward forward = new Forward(8111);
            InetSocketAddress addr = new InetSocketAddress("google.com", 80);
            SocketForwardingConnectListener listener = new SocketForwardingConnectListener(addr);

            sshclient.getRemotePortForwarder().bind(forward, listener);
            sshclient.getTransport().setHeartbeatInterval(30);

            HttpURLConnection con = (HttpURLConnection) new URL("http://localhost:8111").openConnection();
            con.setRequestMethod("GET");
            BufferedReader reader = new BufferedReader(new InputStreamReader(con.getInputStream()));
            String line = null;
            while( (line = reader.readLine()) != null) {
                System.out.println(line);
            }

            sshclient.getTransport().join();

        } catch (IOException e) {
            e.printStackTrace();
        }

        try {
            if (sshclient != null && sshclient.isConnected()) {
                sshclient.disconnect();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
});
thread.setDaemon(true);
thread.start(); 
```

问题是，如果我连接到像“10.0.3.96”这样的远程 SSH 服务器，它就不起作用。如果我在本地主机上使用本地 SSH 服务器，它将起作用。运气好的话，我一直在通过不同的配置并尝试调试，但我无法掌握 SSHj 包内部发生的情况。

现在它不必是 SSHj 解决方案，但这是首选，因为代码的其他部分已完全实现并使用 SSHj，我不想在一个项目中混合两个 SSH 包。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T19:42:36.313

尝试这样的事情。它接受要连接的服务器列表。它将每个中间连接隧道连接到最后一个服务器。我没有使用超过 2 台服务器进行测试，但它应该可以工作。这个答案改编自 overthere 项目并用 groovy 编写。你应该只需要导入来让它在 groovyconsole 中工作。

```
@Grab(group='net.schmizz', module='sshj', version='0.8.1')
@Grab(group='org.bouncycastle', module='bcprov-jdk16', version='1.46')

//the sequence of hosts that the connections will be made through
def hosts = ["server1", "server2"]
//the starting port for local port forwarding
def startPort = 2222
//username for connecting to all servers
def username = 'user'
def pw = 'pass'

//--------------------------------------------------------------------------//

final TunnelPortManager PORT_MANAGER = new TunnelPortManager()

//list of all active port forwarders
List<PortForwarder> portForwarders = []

Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());

/**
 *  Established the actual port forwarder 
 */
class PortForwarder extends Thread implements Closeable {
    private final SSHClient sshClient;
    private final InetSocketAddress remoteAddress;
    private final ServerSocket localSocket;
    private CountDownLatch latch = new CountDownLatch(1);

    public PortForwarder(SSHClient sshClient, InetSocketAddress remoteAddress, ServerSocket localSocket) {
        this.sshClient = sshClient;
        this.remoteAddress = remoteAddress;
        this.localSocket = localSocket;
    }

    private static String buildName(InetSocketAddress remoteAddress, Integer localPort) {
        return "SSH local port forward thread [${localPort}:${remoteAddress.toString()}]"
    }

    @Override
    public void run() {
        LocalPortForwarder.Parameters params = new LocalPortForwarder.Parameters("127.0.0.1", localSocket.getLocalPort(),
                remoteAddress.getHostName(), remoteAddress.getPort());
        LocalPortForwarder forwarder = sshClient.newLocalPortForwarder(params, localSocket);
        try {
            latch.countDown();
            forwarder.listen();
        } catch (IOException ignore) {/* OK. */}
    }

    @Override
    public void close() throws IOException {
        localSocket.close();
        try {
            this.join();
        } catch (InterruptedException e) {/* OK.*/}
    }
}

/**
 *  Will hand out local ports available for port forwarding
 */
class TunnelPortManager {
    final int MAX_PORT = 65536

    Set<Integer> portsHandedOut = new HashSet()

    ServerSocket leaseNewPort(Integer startFrom) {
        for (int port = startFrom; port < MAX_PORT; port++) {
            if (isLeased(port)) {
                continue;
            }

            ServerSocket socket = tryBind(port);
            if (socket != null) {
                portsHandedOut.add(port);
                println "handing out port ${port} for local binding"
                return socket;
            }
        }
        throw new IllegalStateException("Could not find a single free port in the range [${startFrom}-${MAX_PORT}]...");
    }

    synchronized void returnPort(ServerSocket socket) {
        portsHandedOut.remove(socket.getLocalPort());
    }

    private boolean isLeased(int port) {
        return portsHandedOut.contains(port);
    }

    protected ServerSocket tryBind(int localPort) {
        try {
            ServerSocket ss = new ServerSocket();
            ss.setReuseAddress(true);
            ss.bind(new InetSocketAddress("localhost", localPort));
            return ss;
        } catch (IOException e) {
            return null;
        }
    }
}

PortForwarder startForwarder(PortForwarder forwarderThread) {
    forwarderThread.start();
    try {
        forwarderThread.latch.await();
    } catch (InterruptedException e) {
        Thread.currentThread().interrupt();
    }
    return forwarderThread;
}

SSHClient getSSHClient(username, pw, String hostname, int port=22){
    SSHClient client = new SSHClient()
    client.addHostKeyVerifier(new PromiscuousVerifier())
    client.connect(hostname, port)
    client.authPassword(username, pw)
    return client
}

int hostCount = hosts.size()
String hostname = hosts[0]

SSHClient client = getSSHClient(username, pw, hostname)
println "making initial connection to ${hostname}"

Session session

//create port forwards up until the final
for (int i=1; i<hostCount; i++){
    hostname = hosts[i]
    println "creating connection to ${hostname}"
    ServerSocket ss = PORT_MANAGER.leaseNewPort(startPort)
    InetSocketAddress remoteAddress = new InetSocketAddress(hostname, 22)

    PortForwarder forwarderThread = new PortForwarder(client, remoteAddress, ss)
    forwarderThread = startForwarder(forwarderThread)
    session = client.startSession()

    println "adding port forward from local port ${ss.getLocalPort()} to ${remoteAddress.toString()}"
    portForwarders.add(forwarderThread)

    client = getSSHClient(username, pw, "127.0.0.1", ss.getLocalPort())
}

session = client.startSession()

//shut down the running jboss using the script
Command cmd = session.exec("hostname")
String response = IOUtils.readFully(cmd.getInputStream()).toString()
cmd.join(5, TimeUnit.SECONDS)
println "response -> ${response}"

portForwarders.each { pf ->
    pf.close()
}

session.close()
client.disconnect() 
```

# c++ - C++（和数学）：三角函数的快速逼近

> ID：11261170
> 
> 赞同：15
> 
> 时间：2012-06-29T11:44:17.713
> 
> 标签：c++, performance, trigonometry

我知道这是一个反复出现的问题，但我还没有真正找到有用的答案。我基本上是在寻找`acos`C++ 中函数的快速近似值，我想知道我是否可以显着击败标准函数。

但是你们中的一些人可能对我的具体问题有见解：我正在编写一个我需要非常快的科学程序。主要算法的复杂性归结为计算以下表达式（多次使用不同的参数）：

```
sin( acos(t_1) + acos(t_2) + ... + acos(t_n) ) 
```

其中`t_i`是已知的实数（双）数，并且`n`非常小（例如小于 6）。我需要至少 1e-10 的精度。我目前正在使用标准`sin`和`acos`C++ 函数。

你认为我能以某种方式显着提高速度吗？对于那些了解一些数学的人，您认为扩展该正弦以获得代数表达式`t_i`（仅涉及平方根）是否明智？

谢谢你的回答。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T08:24:39.773

下面的代码提供了简单的实现`sin()`，`acos()`应该满足您的准确性要求并且您可能想尝试一下。请注意，您平台上的数学库实现很可能针对该平台的特定硬件功能进行了高度调整，并且可能还以汇编形式编码以实现最高效率，因此不太可能提供不满足硬件细节的简单编译 C 代码更高的性能，即使精度要求从全双精度有所放宽。正如 Viktor Latypov 指出的那样，寻找不需要昂贵调用超越数学函数的算法替代方案也可能是值得的。

在下面的代码中，我尝试使用简单、可移植的结构。如果您的编译器支持该`rint()`函数 [由 C99 和 C++11 指定]，您可能希望使用它而不是`my_rint()`. 在某些平台上，调用`floor()`可能很昂贵，因为它需要动态更改机器状态。函数`my_rint()`、`sin_core()`、`cos_core()`和`asin_core()`想要内联以获得最佳性能。您的编译器可能会在高优化级别自动执行此操作（例如，使用 编译时`-O3`），或者您可以为这些函数添加适当的内联属性，例如 inline 或 __inline ，具体取决于您的工具链。

对您的平台一无所知，我选择了简单的多项式近似，使用 Estrin 方案和 Horner 方案对其进行评估。有关这些评估方案的描述，请参见 Wikipedia：

[http://en.wikipedia.org/wiki/Estrin%27s_scheme](http://en.wikipedia.org/wiki/Estrin%27s_scheme) , [http://en.wikipedia.org/wiki/Horner_scheme](http://en.wikipedia.org/wiki/Horner_scheme)

近似值本身属于 minimax 类型，并且是使用 Remez 算法为该答案自定义生成的：

[http://en.wikipedia.org/wiki/Minimax_approximation_algorithm，http://en.wikipedia.org/wiki/Remez_algorithm](http://en.wikipedia.org/wiki/Minimax_approximation_algorithm) _ [_](http://en.wikipedia.org/wiki/Remez_algorithm)

参数缩减中使用的恒等式在`acos()`注释中注明，因为`sin()`我使用了 Cody/Waite 风格的参数缩减，如下书中所述：

WJ Cody, W. Waite，基本功能软件手册。普伦蒂斯大厅，1980

评论中提到的误差范围是近似的，并没有经过严格的测试或证明。

```
/* not quite rint(), i.e. results not properly rounded to nearest-or-even */
double my_rint (double x)
{
  double t = floor (fabs(x) + 0.5);
  return (x < 0.0) ? -t : t;
}

/* minimax approximation to cos on [-pi/4, pi/4] with rel. err. ~= 7.5e-13 */
double cos_core (double x)
{
  double x8, x4, x2;
  x2 = x * x;
  x4 = x2 * x2;
  x8 = x4 * x4;
  /* evaluate polynomial using Estrin's scheme */
  return (-2.7236370439787708e-7 * x2 + 2.4799852696610628e-5) * x8 +
         (-1.3888885054799695e-3 * x2 + 4.1666666636943683e-2) * x4 +
         (-4.9999999999963024e-1 * x2 + 1.0000000000000000e+0);
}

/* minimax approximation to sin on [-pi/4, pi/4] with rel. err. ~= 5.5e-12 */
double sin_core (double x)
{
  double x4, x2, t;
  x2 = x * x;
  x4 = x2 * x2;
  /* evaluate polynomial using a mix of Estrin's and Horner's scheme */
  return ((2.7181216275479732e-6 * x2 - 1.9839312269456257e-4) * x4 + 
          (8.3333293048425631e-3 * x2 - 1.6666666640797048e-1)) * x2 * x + x;
}

/* minimax approximation to arcsin on [0, 0.5625] with rel. err. ~= 1.5e-11 */
double asin_core (double x)
{
  double x8, x4, x2;
  x2 = x * x;
  x4 = x2 * x2;
  x8 = x4 * x4;
  /* evaluate polynomial using a mix of Estrin's and Horner's scheme */
  return (((4.5334220547132049e-2 * x2 - 1.1226216762576600e-2) * x4 +
           (2.6334281471361822e-2 * x2 + 2.0596336163223834e-2)) * x8 +
          (3.0582043602875735e-2 * x2 + 4.4630538556294605e-2) * x4 +
          (7.5000364034134126e-2 * x2 + 1.6666666300567365e-1)) * x2 * x + x; 
}

/* relative error < 7e-12 on [-50000, 50000] */
double my_sin (double x)
{
  double q, t;
  int quadrant;
  /* Cody-Waite style argument reduction */
  q = my_rint (x * 6.3661977236758138e-1);
  quadrant = (int)q;
  t = x - q * 1.5707963267923333e+00;
  t = t - q * 2.5633441515945189e-12;
  if (quadrant & 1) {
    t = cos_core(t);
  } else {
    t = sin_core(t);
  }
  return (quadrant & 2) ? -t : t;
}

/* relative error < 2e-11 on [-1, 1] */
double my_acos (double x)
{
  double xa, t;
  xa = fabs (x);
  /* arcsin(x) = pi/2 - 2 * arcsin (sqrt ((1-x) / 2)) 
   * arccos(x) = pi/2 - arcsin(x)
   * arccos(x) = 2 * arcsin (sqrt ((1-x) / 2))
   */
  if (xa > 0.5625) {
    t = 2.0 * asin_core (sqrt (0.5 * (1.0 - xa)));
  } else {
    t = 1.5707963267948966 - asin_core (xa);
  }
  /* arccos (-x) = pi - arccos(x) */
  return (x < 0.0) ? (3.1415926535897932 - t) : t;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T12:42:16.910

```
sin( acos(t1) + acos(t2) + ... + acos(tn) ) 
```

boils down to the calculation of

```
sin( acos(x) ) and cos(acos(x))=x 
```

because

```
sin(a+b) = cos(a)sin(b)+sin(a)cos(b). 
```

The first thing is

```
sin( acos(x) )  = sqrt(1-x*x) 
```

Taylor series expansion for the sqrt reduces the problem to polynomial calculations.

To clarify, here's the expansion to n=2, n=3:

```
sin( acos(t1) + acos(t2) ) = sin(acos(t1))cos(acos(t2)) + sin(acos(t2))cos(acos(t1) = sqrt(1-t1*t1) * t2 + sqrt(1-t2*t2) * t1

cos( acos(t2) + acos(t3) ) = cos(acos(t2)) cos(acos(t3)) - sin(acos(t2))sin(acos(t3)) = t2*t3 - sqrt(1-t2*t2)*sqrt(1-t3*t3)

sin( acos(t1) + acos(t2) + acos(t3)) = 
sin(acos(t1))cos(acos(t2) + acos(t3)) + sin(acos(t2)+acos(t3) )cos(acos(t1)=
sqrt(1-t1*t1) * (t2*t3 - sqrt(1-t2*t2)*sqrt(1-t3*t3)) + (sqrt(1-t2*t2) * t3 + sqrt(1-t3*t3) * t2 ) * t1 
```

and so on.

The sqrt() for x in (-1,1) can be computed using

```
x_0 is some approximation, say, zero

x_(n+1) = 0.5 * (x_n + S/x_n)  where S is the argument. 
```

EDIT: I mean the "Babylonian method", see [Wikipedia's article](http://en.wikipedia.org/wiki/Methods_of_computing_square_roots#Babylonian_method) for details. You will need not more than 5-6 iterations to achieve 1e-10 with x in (0,1).

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T11:49:04.130

正如 Jonas Wielicki 在评论中提到的那样，您无法做出太多精确的权衡。

您最好的选择是尝试使用函数的处理器内在函数（如果您的编译器还没有这样做）并使用一些数学来减少必要的计算量。

同样非常重要的是将所有内容保持在 CPU 友好的格式中，确保很少有缓存未命中等。

如果您正在计算大量函数，例如`acos`迁移到 GPU 是您的选择吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-29T12:10:37.933

您可以尝试创建查找表，并使用它们而不是标准的 c++ 函数，看看您是否看到任何性能提升。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-29T11:50:15.067

通过将内存和数据流与内核对齐，可以获得显着的收益。大多数情况下，这会使通过重新创建数学函数获得的收益相形见绌。想想如何改进内核操作员的内存访问。

通过使用缓冲技术可以改进内存访问。这取决于您的硬件平台。如果您在 DSP 上运行它，您可以将数据 DMA 到 L2 缓存并安排指令，以便乘法器单元被完全占用。

如果您在通用 CPU 上，您可以做的大多数事情就是使用对齐的数据，通过预取来提供缓存行。如果你有嵌套循环，那么最里面的循环应该来回循环（即向前迭代然后向后迭代），以便使用缓存行等。

您还可以考虑使用多核并行计算的方法。如果您可以使用 GPU，这可以显着提高性能（尽管精度较低）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-05T14:42:39.543

除了其他人所说的，这里有一些速度优化的技术：

## 轮廓

找出代码中大部分时间都花在了哪里。只有优化该区域才能获得最大的利益。

## 展开循环

处理器不喜欢执行路径中的分支、跳转或更改。通常，处理器必须重新加载指令流水线，这会占用可用于计算的时间。这包括函数调用。

该技术是在循环中放置更多“组”操作并减少迭代次数。

## 将变量声明为寄存器

经常使用的变量应该声明为`register`. 尽管 SO 的许多成员都表示编译器忽略了这个建议，但我发现并非如此。最坏的情况，你浪费了一些时间打字。

## 保持密集计算简短而简单

许多处理器在其指令流水线中有足够的空间来容纳小循环`for`。这减少了重新加载指令流水线所花费的时间。

将您的大计算循环分配到许多小循环中。

## 在数组和矩阵的小部分上执行工作

许多处理器都有一个数据缓存，它是非常接近处理器的超高速内存。处理器喜欢从处理器外的内存中加载一次数据缓存。更多的负载需要时间来进行计算。在网上搜索“面向数据的设计缓存”。

## 考虑并行处理器术语

更改您的计算设计，以便它们可以轻松适应多个处理器。许多 CPU 具有多个可以并行执行指令的内核。一些处理器有足够的智能来自动将指令委托给它们的多个内核。

一些编译器可以优化代码以进行并行处理（查找编译器的编译器选项）。为并行处理设计代码将使编译器更容易进行这种优化。

## 分析函数的汇编列表

打印出你的函数的汇编语言列表。更改函数的设计以匹配汇编语言的设计或帮助编译器生成更优化的汇编语言。

如果您确实需要更高的效率，请优化汇编语言并将其作为内联汇编代码或作为单独的模块放入。我一般更喜欢后者。

## 例子

在您的情况下，取泰勒展开式的前 10 个项，分别计算它们并放入单个变量中：

```
double term1, term2, term3, term4;
double n, n1, n2, n3, n4;
n = 1.0;
for (i = 0; i < 100; ++i)
{
  n1 = n + 2;
  n2 = n + 4;
  n3 = n + 6;
  n4 = n + 8;

  term1 = 4.0/n;
  term2 = 4.0/n1;
  term3 = 4.0/n2;
  term4 = 4.0/n3; 
```

然后总结你的所有条款：

```
 result = term1 - term2 + term3 - term4;
  // Or try sorting by operation, if possible:
  // result = term1 + term3;
  // result -= term2 + term4;

  n = n4 + 2;
  } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-02T09:16:35.177

让我们首先考虑两个术语：

`cos(a+b) = cos(a)*cos(b) - sin(a)*sin(b)`

或者`cos(a+b) = cos(a)*cos(b) - sqrt(1-cos(a)*cos(a))*sqrt(1-cos(b)*cos(b))`

将 cos 带到 RHS

`a+b = acos( cos(a)*cos(b) - sqrt(1-cos(a)*cos(a))*sqrt(1-cos(b)*cos(b)) )`... 1

这里 cos(a) = t_1 和 cos(b) = t_2 a = acos(t_1) 和 b = acos(t_2)

通过代入等式（1），我们得到

`acos(t_1) + acos(t_2) = acos(t_1*t_2 - sqrt(1 - t_1*t_1) * sqrt(1 - t_2*t_2))`

在这里您可以看到您已将两个 acos 合二为一。因此，您可以递归地将所有 acos 配对并形成二叉树。最后，您将得到一个形式`sin(acos(x))`为等于的表达式`sqrt(1 - x*x)`。

这将提高时间复杂度。

但是，我不确定计算 sqrt() 的复杂性。

# c# - 并非所有 dll 都出现在发布文件夹中 - 因此：“无法加载文件或程序集或其依赖项之一”

> ID：11261172
> 
> 赞同：0
> 
> 时间：2012-06-29T11:44:28.680
> 
> 标签：c#, visual-studio-2010, c#-4.0

我有一个问题，当我将应用程序的发布文件夹移动到目标服务器并运行应用程序时，它显示“无法加载文件或程序集或其依赖项之一”。我想我知道它来自哪里，但我不知道如何解决它。

在我的程序中，我使用 4 个外部 dll AntiXSSLibrary、HtmlSanitizationLibrary、MySql.Data 和 MySql.Data.Entity。当我在 Visual c# 2010 express 中“添加引用”并构建解决方案时，我只能在 bin/release 文件夹中看到 2 个 dll——AntiXSSLibrary 和 HtmlSanitizationLibrary（以及它们的 xml）。MySQL dll 没有出现在那里 - 其中之一是异常错误消息中显示的 dll - 我不知道为什么它也不将它们复制到那里。顺便说一句，如果我自己复制它们并没有帮助..

在我的电脑上——程序是在哪里构建的——它运行正常。

谢谢你的帮助。

**编辑**

引起我注意的另一件事是堆栈的最后一行“at ... Program.Main ... IN C:\Users\AAA\Documents\Visual Studio 2010 .....\Program.cs 第 12 行”

为什么它试图访问我在 prod 服务器中的构建位置 + cs 文件并从不同位置运行 exe..？您可以在图片中看到孔的东西： ![在此处输入图像描述](../Images/58fec1aaab7a1e04748cc0769dc35c3b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T16:08:53.210

AntiXSSLibrary 和 HtmlSanitizationLibrary 构建为 .net 2.0，mysql 为 4.0。因为我在 4.0 中没有 AntiXSSLibrary 和 HtmlSanitizationLibrary，所以我已经安装了 mysql 2.0 版本。这解决了问题。

# r - 典型公式槽

> ID：11261173
> 
> 赞同：0
> 
> 时间：2012-06-29T11:44:36.770
> 
> 标签：r, oop, s4

我正在尝试使用类型公式的插槽。但公式不是基本数据类型。我该怎么做才能创建一个插槽来存储公式之类的对象。还是有意禁止将一般 S3 对象存储为插槽？如果有意使用 S4 类型的插槽，如何将 S3 类公式转换为 S4 类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:01:03.730

似乎对我有用：

```
setClass("form", representation(f="formula"))
myForm <- new("form",f=y~x)
myForm
An object of class "form"
Slot "f":
y ~ x

class(myForm@f)
[1] "formula" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T01:46:40.130

如果您在调用`new`. 支持 S4 类作为插槽。

```
setClass(Class = "B", representation = representation(var1 = "character"))
setClass(Class = "A", representation = representation(var1 = "B"))
b<-new("B",var1="b")
a<-new("A",var1=b) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T13:25:22.923

我想使用类似的机制

```
 class B{
    int varb=0;
 }

 class A{
     B classvar;
     A(B var) classvar=var;
 }

 b=new B();
 a=new A(b); 
```

目前我是这样做的

```
 setClass(Class = "A",
     representation = representation(var1 = "list")
     )

  setClass(Class = "B",
     representation = representation(var1 = "character")
     )
  b<-new("B","b")
  a<-new("A",list(b)) 
```

像类变量一样保存 S4 对象。

# java - java对象强制转换

> ID：11261174
> 
> 赞同：-2
> 
> 时间：2012-06-29T11:44:38.127
> 
> 标签：java, object, casting, javabeans

公共无效测试（对象 obj）{

```
 //Here i have to set the values of the obj using its setter . 
    } 
```

可以使用两个对象作为参数调用测试。EG：test(standalone) 和 test(webapp)，其中standalone 和 webapp 是 bean。

```
public class standalone{
      int version;
   //setter and getter
}

public class Webapp{
     String version;
   //setter and getter
} 
```

此测试方法必须根据参数对象设置值。例如：如果我将独立作为参数传递。独立的 setter 方法 shd 被调用。如何做到这一点？

注意：不使用接口。这个怎么做？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:47:14.107

```
public static void setVersion(Object obj, int v) throws Exception {
  for (Method m : obj.getClass().getMethods()) {
    final Class<?>[] t = m.getParameterTypes();
    if (m.getName().equals("setVersion") && t.length == 1)
      m.invoke(obj, t[0] == String.class? String.valueOf(v) : v);
      break;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:58:47.980

我认为最好在这种情况下使用继承，因为（据我所知）独立和 WebApp 都是应用程序。

因此，您可以定义一个顶级“应用程序”并且 StandaloneApp 和 WebApp 都对其进行扩展，因为可以定义**“是一个”关系。**

骨架代码：

```
define class Application
define class StandaloneApp extends Application, implements method setVersion(int)
define class WebApp extends Application, implements method setVersion(int)

define test method, which accepts "Application" obj in the arguments 
```

您也可以应用上面介绍的任何界面解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:08:26.847

你可以简单地这样做：

```
interface SetVersion{
    void setVersion(int version);
}
class Standalone implements SetVersion{}
class WebApp implements SetVersion{}
public void test(SetVersion version){
      version.setVersion(1);
    } 
```

或者最简单的方法是使用`.instanceOf`

```
if(obj.instanceOf(Standalone)){

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T11:46:49.167

以最简单的方式，您可以这样做：

```
public void test(Object obj) {

    if( obj instanceof Standalone ) {
        ((Standalone)obj).setVersion(1);
    } else if (obj instanceof WebApp ) {
        ((WebApp)obj).setVersion(1);
    }

} 
```

尽量避免使用反射来实现这一点，因为它会使重构任务变得非常困难。将类名与字符串进行比较也是如此。

**如果你想要更优雅的东西，你可以这样做：**

```
public class abstract AbstractEnv {
    int version = 0;
    // setters and getters
}

public class Standalone extends AbstractEnv{
}

public class Webapp extends AbstractEnv{
} 
```

使用这种方法，您可以像这样配置它：

```
public void test(AbstractEnv obj) {

    obj.setVersion(1);

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T11:47:53.413

你的两个类都应该实现一个接口，比如`VersionSettable`. 其中声明了方法`setVersion(int version)`。

```
public class standalone implements VersionSettable {
      int version;
   //setter and getter
}

public class Webapp implements VersionSettable {
      int version;
   //setter and getter
}

interface VersionSettable {
    setVersion(int version);
} 
```

然后您可以将您的测试方法更改为：

```
public void test(VersionSettable obj){
   obj.setVersion(17);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-29T11:51:16.293

您可以让 StandAlone 和 WebApp 都实现一个接口，例如

```
interface VersionSettable {
    void setVersion(int version);
}

public class Standalone implements VersionSettable{
      int version;
   //setter and getter
}

public class Webapp implements VersionSettable{
      int version;
   //setter and getter
}

public void test(VersionSettable versionSettable){
   versionSettable.setVersion(42);
} 
```

# javascript - 关于 Javascripts Prototype 的几个问题

> ID：11261175
> 
> 赞同：3
> 
> 时间：2012-06-29T11:44:45.407
> 
> 标签：javascript, prototype

我从经典的 OOP 背景来到 Javascript，并且在理解原型方面遇到了麻烦。

给定下面的代码示例：

1.  我将如何在 foo 中调用/执行 bar？
2.  为什么要使用“特权”功能而不是将其放在原型上？
3.  这可能在 Q1 中得到了回答，但是 bar1 和 bar2 可以互相调用吗？

    ```
    function foo()
        {
           this.property = "I'm a property";

           this.privileged = function()
           {
              // do stuff
           }
        }

        foo.prototype.bar = function()
        {
           // do stuff
        }

        foo.prototype.bar2 = function()
        {
           // stuff
        } 
    ```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:21:31.950

直到今天，还有很多关于这件事的 FUD。

1）。简单用法：

```
var xxx = new foo();  // Create instance of object.
xxx.privileged();  // Calls the internal closure.
xxx.bar();  // First looks for internals, then looks to the prototype object. 
```

2）。这基本上创建了一个只能在实例上修改的闭包。根本不是私有的（因为任何东西都可以通过对象实例与之对话），而是一个函数的单独副本，其中对象的每个实例都获得该函数的一个新副本。您可以更改函数本身，但不能全局更改它。我不是这种创造事物的方法的忠实粉丝。

3）。是的：

```
foo.prototype.bar = function(){
    this.bar2();
}

foo.prototype.bar2 = function(){
    this.bar();
}
// Although... NEVER do both.  You'll wind up in a circular chain. 
```

为了启迪，我给你做了一个小提琴，它应该有助于展示事情是如何被调用的：http: [//jsfiddle.net/7Y5QK/](http://jsfiddle.net/7Y5QK/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T12:35:14.403

1）首先是克莱德·洛博（Clyde Lobo）的回答：

```
var f = new foo();
f.bar(); 
```

2）在（特权）上写一个函数`consturctor`，每个实例都会创建一个新的，如果在 上定义一个方法`prototype`，每个实例共享相同`prototype`的方法：

```
var f1 = new foo(), // instance 1
    f2 = new foo(); // instance 2

f1.privileged === f2\. privileged // -> false , every instance has different function
f1.bar === f2.bar // -> true, every instance share the some function 
```

3）你可以调用this.bar()` `bar2`，`bar' by`代码如下：

```
function foo() {
   this.property = "I'm a property";

   this.privileged = function() {
      // do stuff
   };
}

foo.prototype.bar = function() { // defined a method bar
    alert('bar called');
    this.bar2(); // call bar2
};

foo.prototype.bar2 = function() { // defined a method bar2
    alert('bar2 called');
};

var f = new foo();
f.bar(); // alert 'bar called' and 'bar2 called'
f.bar2(); // alert 'bar2 called' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T11:53:17.853

1.  您可以通过 do 在 foo 中执行 bar ，`this.bar();` 但仅当您使用`new foo();`并拥有一个继承自`foo`. 否则，如果您只是调用`foo();`,`this`将指向全局对象。

2.  本质上是一样的，只是您在函数内部为继承对象提供的属性和方法可以访问您传递给的任何参数`foo`。

3.  是的，他们可以互相调用，因为函数是“提升的”。他们可以访问最近的外部范围内的所有变量和对象，以及它们的功能上下文。

您的代码中实际上存在语法错误。你在哪里分配原型，你没有创建一个函数。你的意思是：

```
foo.prototype.bar = function() { /* ... */ }; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T12:06:10.390

1.你可以创建一个foo的实例

`var f = new foo();`

然后打电话`f.bar()`给`f.bar2()`

大卫已经解释了第 2 点和第 3 点

# mysql - MySQL 回填缺失的数据，其中记录具有一个公共字段

> ID：11261183
> 
> 赞同：1
> 
> 时间：2012-06-29T11:45:19.180
> 
> 标签：mysql, database

我想找到一种方法来填充从有数据的记录到没有电子邮件匹配的记录中的缺失数据。

我有一张桌子，上面有姓名、地​​址、城市、州、邮编和电子邮件。像这样

```
kim,,,55555,kim@domain.com
kim,Longmont,CO,55555,kim@domain.com
kim,,,,kim@domain.com 
```

我想要做的是删除重复项而不丢失相关数据。所以我想用那里的数据回填每条记录，然后删除重复项。并不总是有一张像第二张那样包含所有细节的唱片。有时可能没有包含所有数据的任何记录。

理想情况下，我希望得到以下结果，因此每条记录都有尽可能多的可用字段。如果一个字段有 2 个或更多不同的记录，我可以从第一个开始填写。

我希望这是一个公平的解释

```
kim,Longmont,CO,55555,kim@domain.com
kim,Longmont,CO,55555,kim@domain.com
kim,Longmont,CO,55555,kim@domain.com 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:39:52.453

你没有提供任何代码，所以我必须即兴发挥。我有两个表 t1 和 t2，其中 t2 是 t1 的完全副本（您可以尝试创建表的副本或使用自联接，我不确定它是否适用）。这个对我有用：

```
update t2,t1 set t2.first_name=
case when t2.first_name='' 
then t1.first_name 
else t2.first_name end 
where t2.actor_id=t1.actor_id 
and t1.first_name!=''; 
```

我是为一个名为 first_name 的列做的。修改查询并将其应用于您的表。所以你有2个选择：

1.  添加其他表并进行一个大查询。
2.  对要更改的每一列多次应用相同的查询 1...

这是我的例子

```
mysql> select * from t2 limit 10;
+----------+------------+--------------+---------------------+
| actor_id | first_name | last_name    | last_update         |
+----------+------------+--------------+---------------------+
|        1 |            | GUINESS      | 2012-06-29 08:36:22 |
|        2 |            | WAHLBERG     | 2012-06-29 08:36:22 |
|        3 |            | CHASE        | 2012-06-29 08:36:22 |
|        4 |            | DAVIS        | 2012-06-29 08:36:22 |
|        5 |            | LOLLOBRIGIDA | 2012-06-29 08:36:22 |
|        6 |            | NICHOLSON    | 2012-06-29 08:36:22 |
|        7 |            | MOSTEL       | 2012-06-29 08:36:22 |
|        8 |            | JOHANSSON    | 2012-06-29 08:36:22 |
|        9 |            | SWANK        | 2012-06-29 08:36:22 |
|       10 | CHRISTIAN  | GABLE        | 2006-02-15 04:34:33 |
+----------+------------+--------------+---------------------+
10 rows in set (0.00 sec)

mysql> select * from t1 order by actor_id limit 10;
+----------+------------+--------------+---------------------+
| actor_id | first_name | last_name    | last_update         |
+----------+------------+--------------+---------------------+
|        1 | PENELOPE   | GUINESS      | 2006-02-15 04:34:33 |
|        1 | a          |              | 0000-00-00 00:00:00 |
|        2 | NICK       | WAHLBERG     | 2006-02-15 04:34:33 |
|        3 | ED         | CHASE        | 2006-02-15 04:34:33 |
|        4 | JENNIFER   | DAVIS        | 2006-02-15 04:34:33 |
|        5 | JOHNNY     | LOLLOBRIGIDA | 2006-02-15 04:34:33 |
|        6 | BETTE      | NICHOLSON    | 2006-02-15 04:34:33 |
|        7 | GRACE      | MOSTEL       | 2006-02-15 04:34:33 |
|        8 | MATTHEW    | JOHANSSON    | 2006-02-15 04:34:33 |
|        9 | JOE        | SWANK        | 2006-02-15 04:34:33 |
+----------+------------+--------------+---------------------+
10 rows in set (0.00 sec)

mysql> update t2,t1 set t2.first_name=case when t2.first_name='' then t1.first_name else t2.first_name end where t2.actor_id=t1.actor_id and t1.first_name!='';
Query OK, 9 rows affected (0.03 sec)
Rows matched: 200  Changed: 9  Warnings: 0

mysql> select * from t2 limit 10;
+----------+------------+--------------+---------------------+
| actor_id | first_name | last_name    | last_update         |
+----------+------------+--------------+---------------------+
|        1 | PENELOPE   | GUINESS      | 2012-06-29 08:37:34 |
|        2 | NICK       | WAHLBERG     | 2012-06-29 08:37:34 |
|        3 | ED         | CHASE        | 2012-06-29 08:37:34 |
|        4 | JENNIFER   | DAVIS        | 2012-06-29 08:37:34 |
|        5 | JOHNNY     | LOLLOBRIGIDA | 2012-06-29 08:37:34 |
|        6 | BETTE      | NICHOLSON    | 2012-06-29 08:37:34 |
|        7 | GRACE      | MOSTEL       | 2012-06-29 08:37:34 |
|        8 | MATTHEW    | JOHANSSON    | 2012-06-29 08:37:34 |
|        9 | JOE        | SWANK        | 2012-06-29 08:37:34 |
|       10 | CHRISTIAN  | GABLE        | 2006-02-15 04:34:33 |
+----------+------------+--------------+---------------------+
10 rows in set (0.00 sec) 
```

# javascript - Salesforce 中的自定义按钮覆盖

> ID：11261190
> 
> 赞同：0
> 
> 时间：2012-06-29T11:45:45.013
> 
> 标签：javascript, salesforce, visualforce

我想在 Salesforce 中创建自定义按钮覆盖。我想覆盖删除按钮，而不是删除，我只希望它更改记录类型。

我的自定义对象是`Absence__c`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:05:29.293

尝试这个：

您只需**编辑****页面布局**，**删除**“*删除*”按钮，然后创建一个名为“删除”的**自定义按钮**，将 javascript 设置为按钮的行为。最后将该按钮添加到页面布局中。

这是自定义按钮的示例代码：

```
{!REQUIRESCRIPT("/soap/ajax/15.0/connection.js")}

var AbsenceUpdate = new sforce.SObject("Absence__c");

AbsenceUpdate.Id='{! Absence__c.Id  }';
AbsenceUpdate.RecordTypeId = '{new record type id}';

if(AbsenceUpdate!=null)
{
    try
    {
     updateOpp = sforce.connection.update([AbsenceUpdate]);
      window.location.reload();
    }
    catch(e)
    {
        alert('error : ' + e);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T06:54:47.200

我认为您最好的选择是控制器扩展和现有删除按钮的覆盖。

```
<apex:Page action="changeRTRedirect"
    standardController="Absence__c" extensions="DeleteOverrideExtension">
</apex:page>

public class DeleteOverrideExtension {
    private SObject record;

    public DeleteOverrideExtension(ApexPages.StandardController controller) {
        record = controller.getRecord();
    }

    public PageReference changeRTRedirect() {
        record.RecordTypeId = '[YOUR NEW RT ID]';
        update record;
        //where do you want to send users now, maybe the Absence__c tab?
        return Page.MyPageHere;
    }
} 
```

# php - 模数运算符运行第一个，然后每第三个项目

> ID：11261192
> 
> 赞同：5
> 
> 时间：2012-06-29T11:46:02.377
> 
> 标签：php, modulo, modulus

所以我需要它在第一个循环上运行，然后在每个第三个循环上运行

```
if ($k % 3 || $k==1 ) { echo '<div class="modcontainer">'; } 
```

对我来说似乎很简单，但我不了解模数

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T11:47:34.147

Modulus 返回余数，而不是布尔值。

此代码将解析`true`为`1, 3, 6, 9, ...`

```
if (($k % 3 == 0) || $k==1 ) { echo '<div class="modcontainer">'; } 
```

此代码将解析`true`为`1, 4, 7, 10, ...`

```
if ($k % 3 == 1) { echo '<div class="modcontainer">'; } 
```

# android - 在android中显示网络错误

> ID：11261193
> 
> 赞同：3
> 
> 时间：2012-06-29T11:46:06.873
> 
> 标签：android, offline-caching, event-listener

我已经用 webview 创建了应用程序。如果我做了任何动作并且网络断开了，我想显示一个警报。我尝试了以下方法，

在 oncreate 方法中添加了这个。

```
public class AndroidNetTestActivity extends Activity {

    public static WebView webview;
    private Handler mHandler = new Handler();       
    private boolean isConnected = true;
    final String offlineMessageHtml = "Net is disconnected";
    final String timeoutMessageHtml = "Connection timed out";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        webview=(WebView)findViewById(R.id.webview);
        webview.getSettings().setJavaScriptEnabled(true); 
        webview.loadUrl("file:///android_asset/www/index.htm");      
        webview.addJavascriptInterface(new MyJavaScriptInterface(), "Android");
        isConnected=isNetworkAvailable();
        webview.setNetworkAvailable(isConnected);
        webview.setWebViewClient(new WebViewClient() {
            @Override
            public boolean shouldOverrideUrlLoading(WebView view, String url) {
                isConnected=isNetworkAvailable();
                if (isConnected) {
                    // return false to let the WebView handle the URL
                    return false;
                } else {
                    // show the proper "not connected" message
                    view.loadData(offlineMessageHtml, "text/html", "utf-8");
                    // return true if the host application wants to leave the current 
                    // WebView and handle the url itself
                    return true;
                }
            }
            @Override
            public void onReceivedError (WebView view, int errorCode, 
                String description, String failingUrl) {
                if (errorCode == ERROR_TIMEOUT) {
                    view.stopLoading();  // may not be needed
                    view.loadData(timeoutMessageHtml, "text/html", "utf-8");
                }
            }
        });
        webview.setWebChromeClient(new WebChromeClient());        
    }

    final class MyJavaScriptInterface
    {
        public void ProcessJavaScript(final String scriptname, final String args)
            {             
                mHandler.post(new Runnable()
                    {
                        public void run()
                            {
                                //ToDo
                            }
                    });
            }
    }  

    public boolean isNetworkAvailable() {
           Context context = getApplicationContext();
           ConnectivityManager connectivity = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
           if (connectivity == null) {
              //boitealerte(this.getString(R.string.alert),"getSystemService rend null");
           } else {
              NetworkInfo[] info = connectivity.getAllNetworkInfo();
              if (info != null) {
                 for (int i = 0; i < info.length; i++) {
                    if (info[i].getState() == NetworkInfo.State.CONNECTED) {
                       return true;
                    }
                 }
              }
           }
           return false;
        }
} 
```

如果我单击登录按钮，如果网络不可用，它应该显示一条错误消息。

但它不工作。请检查我的代码并告诉我我做错了什么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:00:17.480

你可以像这样检查互联网连接

```
 boolean check=checkConnection();

    if(check==true){
Toast.makeText(
                    this,
                    "Internet is Connected",
                    Toast.LENGTH_LONG).show();
    }

    else{

Toast.makeText(
                    this,
                    "Failed to connect to internet.",
                    Toast.LENGTH_LONG).show();
    }

and here is  a method of checkConnection

  protected boolean checkConnection(){ 
        ConnectivityManager conMan = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);

        NetworkInfo networkInfo = conMan.getActiveNetworkInfo();

        final boolean connected = networkInfo != null
                && networkInfo.isAvailable()
                && networkInfo.isConnected();

        if ( !connected) {
            Toast.makeText(
                    this,
                    "Failed to connect to internet.",
                    Toast.LENGTH_LONG).show();
            return false;
        }
        return true;
    } 
```

只是这样做它对我有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:56:44.327

好的...我更新了您的代码。看看

```
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.graphics.Bitmap;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.os.Bundle;
import android.os.Handler;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.Toast;

public class AndroidNetTestActivity extends Activity {

    public static WebView webview;
    private Handler mHandler = new Handler();       
    private boolean isConnected = true;
    final String offlineMessageHtml = "Net is disconnected";
    final String timeoutMessageHtml = "Connection timed out";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.full_screen_image_layout);

        webview=(WebView)findViewById(R.id.webview);
        webview.getSettings().setJavaScriptEnabled(true); 
        webview.loadUrl("http://www.google.com");      
        webview.addJavascriptInterface(new MyJavaScriptInterface(), "Android");
        isConnected=isNetworkAvailable();
        webview.setNetworkAvailable(isConnected);
        webview.setWebViewClient(new WebViewClient() {
            /* (non-Javadoc)
            * @see android.webkit.WebViewClient#onPageStarted(android.webkit.WebView, java.lang.String, android.graphics.Bitmap)
            */
            @Override
            public void onPageStarted(WebView view, String url, Bitmap favicon) {
                System.out.println("page loading started");
                // TODO Auto-generated method stub
                if(!isNetworkAvailable2())
                {
                    showInfoMessageDialog("network not available");
                    System.out.println("network not available");
                    return;
                }
                else System.out.println("network available");

                super.onPageStarted(view, url, favicon);

            }

            @Override
            public boolean shouldOverrideUrlLoading(WebView view, String url) {
                isConnected=isNetworkAvailable2();
                if (isConnected) {
                    // return false to let the WebView handle the URL
                    return false;
                } else {
                    // show the proper "not connected" message
                // view.loadData(offlineMessageHtml, "text/html", "utf-8");
                    // return true if the host application wants to leave the current 
                    // WebView and handle the url itself
                    return true;
                }
            }
            @Override
            public void onReceivedError (WebView view, int errorCode, 
                String description, String failingUrl) {
                if (errorCode == ERROR_TIMEOUT) {
                    view.stopLoading();  // may not be needed
                // view.loadData(timeoutMessageHtml, "text/html", "utf-8");
                }
            }
        });
        //webview.setWebChromeClient(new WebChromeClient());        
    }

    final class MyJavaScriptInterface
    {
        public void ProcessJavaScript(final String scriptname, final String args)
            {             
                mHandler.post(new Runnable()
                    {
                        public void run()
                            {
                                //ToDo
                            }
                    });
            }
    }  

    private void showInfoMessageDialog(String meaasge)
    {
        AlertDialog alertDialog = new AlertDialog.Builder(
                AndroidNetTestActivity.this).create();
        alertDialog.setTitle("Connectivity");
        alertDialog.setMessage(meaasge);
        alertDialog.setButton("OK",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog,
                            int which) {
                        dialog.cancel();
                    }
                });
        //alertDialog.setIcon(R.drawable.error);
        alertDialog.show();
    }

    private boolean isNetworkAvailable2()
    {
        System.out.println("isNetworkAvailable2 called");
        NetworkInfo info = (NetworkInfo) ((ConnectivityManager) getApplicationContext()
                .getSystemService(Context.CONNECTIVITY_SERVICE))
                .getActiveNetworkInfo();

        if (info == null || !info.isAvailable() || !info.isConnected())
            return false;
        else return true;
    }

    public boolean isNetworkAvailable() {
        Context context = getApplicationContext();
        ConnectivityManager connectivity = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
        if (connectivity == null) {
            //boitealerte(this.getString(R.string.alert),"getSystemService rend null");
        } else {
            NetworkInfo[] info = connectivity.getAllNetworkInfo();
            if (info != null) {
                for (int i = 0; i < info.length; i++) {
                    if (info[i].getState() == NetworkInfo.State.CONNECTED) {
                    return true;
                    }
                }
            }
        }
        return false;
        }
} 
```

# mysql - 根据国家/地区计算找到的总结果

> ID：11261194
> 
> 赞同：2
> 
> 时间：2012-06-29T11:46:13.477
> 
> 标签：mysql

我有一个查询，它显示测试数据库中多个表的列。输出是来自世界各地的酒店及其相应的信息。我的搜索条件很简单；没有空白字段，我希望他们的电话号码不以 + 号开头。

它可以工作，但它会显示所有条目（就像它应该显示的那样）但是是否可以只显示找到的项目总数，例如，每个国家/地区？例如它在中国显示 5000 行，在意大利显示 3458 行，在加拿大显示 2050 行等。是否可以只显示找到的总数？5000：中国 3458：意大利 2050：加拿大等

我已经尝试过 COUNT 和 HAVING，但到目前为止它还没有为我工作。我还在这里查找了一些主题，但仍然没有成功。这是我的查询：

```
SELECT 
hotel.id HotelID, 
hotel.name Hotel_Name, 
hotel.tel_area Area_Number,
hotel.tel Phone_Number,
city.name City,
region.name Region,
country.name Country,
country.id CountryID,
country.continent Continent,
hotel.web Website

FROM mydata.hotel      as hotel
JOIN mydata.city       as city     ON hotel.city = city.id
JOIN mydata.region     as region   ON region.id = city.region
JOIN mydata.country    as country  ON country.id = region.country

where hotel.tel not like ''
and accos.tel not like '+%'

order by country.name 
```

有人建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T11:50:33.047

```
SELECT 
country.name Country,
COUNT(*)
FROM mydata.hotel      as hotel
JOIN mydata.city       as city     ON hotel.city = city.id
JOIN mydata.region     as region   ON region.id = city.region
JOIN mydata.country    as country  ON country.id = region.country

where hotel.tel not like ''
and accos.tel not like '+%'
GROUP BY Country
/*an ORDER BY is not really needed in this case, in MySQL GROUP BY contains an implicit ORDER BY*/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:58:32.873

我的 SQL 有点生疏了，但是…… GROUP BY 呢？

我发现的语法是：

```
SELECT column_name, aggregate_function(column_name)

FROM table_name

WHERE column_name operator value

GROUP BY column_name 
```

或者，在[本页](http://www.tizag.com/mysqlTutorial/mysqlgroupby.php/)的末尾，他们用外行术语进行了解释。

我希望这有帮助！

# java - java子类的private final字段可以在超级构造函数完成之前初始化吗？

> ID：11261197
> 
> 赞同：2
> 
> 时间：2012-06-29T11:46:34.047
> 
> 标签：java, null, super, construction

我有一对看起来像这样的课程；

```
public abstract class Class1 {

//...

    public Class1() {
        //...
        function2();
        //...
    }

    protected abstract void function2();

}

public class Class2 implements Class1 {

    private final OnSomethingListener mOnSomethingListener = new OnSomethingListener() {
        @Override
        onSomething() {
            doThatOtherThing();
        }
    }

    protected void function2() {
        //uses mOnSomethingListener
        //however mOnSomethingListener is null when this function is called from super()
        //...
    }

    public Class2() {
        super();
    }
} 
```

我假设侦听器为空，因为我正在有效地引用它`super()`并且它尚未实例化。但是，我想成功，`final`因为，嗯，确实如此。我可以让这个字段（监听器）及时初始化而不把它放在超类中（永远不会使用监听器）吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T11:54:31.727

您的设计是“泄漏`this`问题”的一个实例，并且是 Java 中的反模式。您永远不应该从构造函数中调用可公开覆盖的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T11:50:29.100

简短的回答 - 不。超类的构造函数、字段初始化器和实例初始化器总是在子类之前调用​​。

[调用顺序在 JLS 的第 8.8.7.1 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.8.7.1)中正式定义。总结相关的最后部分（`S`超类和`C`子类在哪里）：

> 在确定 i 相对于 S（如果有的话）的直接封闭实例之后，超类构造函数调用语句的求值通过从左到右对构造函数的参数求值来进行，就像在普通方法调用中一样；然后调用构造函数。
> 
> 最后，如果超类构造函数调用语句正常完成，则执行 C 的所有实例变量初始化器和 C 的所有实例初始化器。如果一个实例初始化器或实例变量初始化器 I 在文本上在另一个实例初始化器或实例变量初始化器 J 之前，那么 I 在 J 之前执行。

因此，当超类构造函数运行时，子类及其所有字段都完全未初始化。出于这个原因，从构造函数调用重写的方法是不好的做法。您实际上是在让对对象的引用从其构造函数中“转义”，这意味着所有构造保证都已关闭（包括诸如最终字段更改值之类的事情）。

从构造函数调用*抽象*方法几乎总是错误的做法。根据子类中方法的实现，在某些情况下您可能会侥幸逃脱（即，如果该方法根本不依赖于任何状态），但它几乎肯定会导致难以调试的失败在某一点。

例如，您是否期望以下之间存在差异：

```
protected String function2() {
    return "foo";
} 
```

和

```
private final String foo = "foo";

protected String function2() {
    return foo;
} 
```

分析这样的问题很困难，因为它们打破了课堂运作的思维模式。最好完全避免这种情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T11:51:00.053

超类总是在子类之前初始化。只能先初始化子类的静态字段。

您可以从超类调用重写的方法，然后访问未初始化的字段。这被认为是不好的做法。

# android - 增加广播意图接收器的速率

> ID：11261198
> 
> 赞同：0
> 
> 时间：2012-06-29T11:46:37.910
> 
> 标签：android, android-intent

我正在为 Intent.ACTION_BATTERY_CHANGED 使用广播接收器。我在我的应用程序中收到此意图的速率是每 5 秒。但我想尽快提高这个速度。

我不知道这是否可能。如果可能，请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T11:55:03.670

我不认为这是可能的。原因实际上在于类名，它是一个接收器。当您注册接收器时，它有一个公开的方法，只要系统检测到 ACTION_BATTERY_CHANGED 意图，就会调用该方法。您收到此消息的速率完全取决于系统广播事件的速率。

# matlab - 如何在 MATLAB GUI 中动态添加编辑框？

> ID：11261205
> 
> 赞同：0
> 
> 时间：2012-06-29T11:47:00.507
> 
> 标签：matlab, user-interface, matlab-guide, editbox

我使用 inputdlg 函数来显示一个对话框，用户在其中写了几个编辑框。盒子的数量取决于变量的值，所以我可以有 3 或 11 个盒子，但我想出了如何根据这个变量的值更新对话框中的盒子数量。

现在我想用 GUI（而不是简单的对话框）做同样的事情，因为我想通过使用 uicontrol 在其中添加一些功能（如静态文本）。（我不得不这样做，因为无法提取 inputdlg 显示的对话框的句柄）。当您使用 GUIDE 执行此操作时，您必须指定您有多少个盒子，但我不能给出固定数量的盒子，它是可变的。

综上所述，我想动态增加 GUI 中编辑框的数量。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:32:59.647

假设你想使用`uicontrol`.

帮助非常全面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T18:16:01.177

最好的办法是拥有一个通用函数，您可以使用必要的参数调用该函数来定义您希望创建的对象。

类似这样的东西：

```
function CreateEditBox ( various parameters/necessary handles )
     set( objectHandle, 'Property', value ) 
     % and more for whatever it is you need to define.
end 
```

# django - 在 views.py 中使用 Django 模型表单时出错

> ID：11261206
> 
> 赞同：2
> 
> 时间：2012-06-29T11:47:02.363
> 
> 标签：django, django-models, django-forms, django-views

在我的models.py

```
 class Alert(models.Model):

    user = models.CharField(max_length=30, blank=True)
    a = models.IntegerField(blank=True)
    def __unicode__(self):
        return "'%s' at %s" % (self.user) 
```

在我的 forms.py 中：

```
 class AlertForm(forms.ModelForm):
    class Meta:
        model=Alert
        fields = ('a','user')
        widgets = {
            'user': forms.HiddenInput()
        }

AlertCountFormset = modelformset_factory(Alert,
                                        form = AlertForm) 
```

在我的views.py中：

```
def profile_setting(request, slug):
if request.method == 'GET':
    form = AlertForm(request.POST)
    if form.is_valid():
        alert_form = form.save(commit=False)
        alert_form.user = request.user.username
        alert_form.save() # Here i am getting the error
        return HttpResponseRedirect('/user/list')

extra_context = {
    'form': AlertForm()
}
return direct_to_template(request,'users/profile_setting.html',
                          extra_context) 
```

我正在尝试填写 Django 模型表单，但我正在关注`error`我发表评论的位置：

```
events_alertcount.a may not be NULL 
```

这是什么？即使将它放在它`null=True`的字段中也会`a`显示相同的错误。是不是我的有什么问题`forms.py or models.py`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:53:48.757

这也在数据库级别上强制执行。在您的数据库中设置您的“a”列以允许该字段为 NULL。这应该解决它。HTH。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T11:56:39.120

试试这个：

```
a = models.IntegerField(blank=True, null=True) 
```

你应该再次调用syncdb

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-30T21:13:45.097

定义模型字段时，该`blank`选项与验证相关，这意味着如果设置`blank`为 true，则如果该字段未填写，则验证不会失败。

> `blank`与验证相关。如果字段具有`blank=True`，则 Django 管理站点上的验证将允许输入空值。如果一个字段有`blank=False`，该字段将是必需的。

但是，如果验证没有失败并且您保存了模型，则该字段将持久保存到数据库中。`null`现在，除非您将`null`选项设置为 true，否则字段不能在数据库中。

> `null`纯粹与数据库相关，而空白与验证相关。

话虽如此，您可以通过将 null 选项添加到以下内容来修复错误`Alert.a`：

```
a = models.IntegerField(blank=True, null=True) 
```

现在，如果您已经运行了该`syncdb`命令，则需要删除您的表，然后重新运行`syncdb`以获取此更改。如果此数据库是生产数据库并且您不能这样做，请查看[django-south](http://south.aeracode.org/)以了解如何迁移您的模式和数据。

# python - Django：检查图像是否存在于某个特定的 url

> ID：11261210
> 
> 赞同：6
> 
> 时间：2012-06-29T11:47:14.157
> 
> 标签：python, django, image, file

只是想知道有什么方法可以在 Django 中检查 url 是否链接到有效图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T14:18:52.320

使用[requests](http://docs.python-requests.org/)和[PIL](http://www.pythonware.com/products/pil/)来验证它实际上是一个有效的图像：

```
>>> import requests
>>> from PIL import Image
>>> from StringIO import StringIO
>>> r = requests.get('http://cdn.sstatic.net/stackoverflow/img/sprites.png')
>>> im = Image.open(StringIO(r.content))
>>> im
<PIL.PngImagePlugin.PngImageFile image mode=RGBA size=238x1073 at 0x2845EA8> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T12:57:13.607

使用[urllib2](http://docs.python.org/library/urllib2.html)进行检查的简单方法。

```
>>> import urllib2
>>> url = 'https://www.google.com.pk/images/srpr/logo3w.png'
>>> try:
...   f = urllib2.urlopen(urllib2.Request(url))
...   imageFound = True
... except:
...   imageFound = False
...
>>> imageFound
True 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T13:13:53.123

这是一个故障保护方法。首先，解析 url 以获取域和其余部分。

```
>>> from urllib.parse import urlparse
>>> url = 'http://example.com/random/folder/path.html'
>>> parse_object = urlparse(url)
>>> parse_object.netloc
'example.com'
>>> parse_object.path
'/random/folder/path.html'
>>> parse_object.scheme
'http' 
```

现在，使用上面的信息来获取内容类型。使用`parse_object.netloc`sstatic.net`parse_object.path`代替，用硬编码路径代替。

```
>>> import httplib
>>> conn = httplib.HTTPConnection("sstatic.net")
>>> conn.request("HEAD", "/stackoverflow/img/favicon.ico")
>>> res = conn.getresponse()
>>> print res.getheaders()
[('content-length', '1150'), ('x-powered-by', 'ASP.NET'), ('accept-ranges', 'bytes'),         ('last-modified', 'Mon, 02 Aug 2010 06:04:04 GMT'), ('etag', '"2187d82832cb1:0"'), ('cache-control', 'max-age=604800'), ('date', 'Sun, 12 Sep 2010 13:39:26 GMT'), ('content-type', 'image/x-icon')] 
```

这告诉您它是 1150 字节的图像（图像/* mime-type）。足够的信息让您决定是否要获取完整的资源。

**编辑**

对于缩短的 url，比如`http://goo.gl/IwruD`指向 的`http://ubuntu.icafebusiness.com/images/ubuntugui2.jpg`，在你得到的响应中，有一个额外的参数叫做`'location'`.

这就是我所说的：

```
>>> import httplib
>>> conn = httplib.HTTPConnection("goo.gl")
>>> conn.request("HEAD", "/IwruD")
>>> res = conn.getresponse()
>>> print res.getheaders()
[('x-xss-protection', '1; mode=block'),
 ('x-content-type-options', 'nosniff'),
 ('transfer-encoding', 'chunked'),
 ('age', '64'),
 ('expires', 'Mon, 01 Jan 1990 00:00:00 GMT'),
 ('server', 'GSE'),
 ('location', 'http://ubuntu.icafebusiness.com/images/ubuntugui2.jpg'),
 ('pragma', 'no-cache'),
 ('cache-control', 'no-cache, no-store, max-age=0, must-revalidate'),
 ('date', 'Sat, 30 Jun 2012 08:52:15 GMT'),
 ('x-frame-options', 'SAMEORIGIN'),
 ('content-type', 'text/html; charset=UTF-8')] 
```

在直接网址中，您找不到它。

```
>>> import httplib
>>> conn = httplib.HTTPConnection("ubuntu.icafebusiness.com")
>>> conn.request("HEAD", "/images/ubuntugui2.jpg")
>>> res = conn.getresponse()
>>> print res.getheaders()
[('content-length', '78603'), ('accept-ranges', 'bytes'), ('server', 'Apache'), ('last-modified', 'Sat, 16 Aug 2008 01:36:17 GMT'), ('etag', '"1fb8277-1330b-45489c3ad2640"'), ('date', 'Sat, 30 Jun 2012 08:55:46 GMT'), ('content-type', 'image/jpeg')] 
```

您可以使用简单的代码查找：

```
>>> r = res.getheaders()
>>> redirected = False
>>> for e in r:
>>>     if(e[0] == 'location'):
>>>         redirected = e
>>>
>>> if(redirected != False):
>>>     print redirected[1]
'http://ubuntu.icafebusiness.com/images/ubuntugui2.jpg' 
```

# javascript - 只有第一个常见问题元素在点击时展开 - jquery

> ID：11261211
> 
> 赞同：0
> 
> 时间：2012-06-29T11:47:14.650
> 
> 标签：javascript, jquery, accordion

我正在尝试创建一个常见问题解答列表。首次单击时答案显示正常，但我希望能够单击另一个问题并让该答案展开并关闭另一个。这是javascript：

```
$(document).ready(function() {
// hide all the answers
$('.faq li div').hide();
$('.faq li').click(function(){
var question = $(this);
var answer = $(this).find('div');
// if the faq isn't active
if(!$('.faq li').hasClass('active')) {
      answer.slideDown();
      $(this).siblings('div').slideUp();
      question.addClass('active');
}
else { 
     answer.slideUp();
     question.removeClass('active');
}

 });

}); 
```

CSS：

```
ul.faq {
list-style:none;
cursor:pointer;
z-index:1;

}

ul.faq li h3 {
background:#0A5C75 url(../images/faq-inactive.png) right no-repeat;
color:#fff;
padding:20px 50px 20px 10px;
margin-bottom:10px;
border:1px solid #fff;
}
ul.faq li.active h3 {
background:#0A5C75 url(../images/faq-active.png) right no-repeat;

}
ul.faq li div {
background:#FFFFFF;
margin:0px 10px 10px 10px;
padding:20px;
overflow:hidden;
/* added fixed width to stop the jerkyness*/
width:522px;
position:relative;
top:-10px;
box-shadow: inset 0px 4px 4px 0px rgba(63, 70, 76, 0.15), 0px 4px 4px rgba(63, 70, 76, 0.15);
} 
```

和 HTML

```
<ul class="faq">
        <li>
            <h3>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut arcu magna, sodales vel dignissim pharetra, adipiscing sed orci?</a></h3>
            <div>Vivamus rutrum arcu sit amet dolor pulvinar dictum. Etiam porttitor leo eget velit volutpat quis ultricies urna ornare. Quisque ac ultrices est. Ut lobortis malesuada justo, sed blandit sapien bibendum et. Donec vel ante eu orci pellentesque dictum. Phasellus molestie egestas du</div>
        </li>
        <li>
             <h3>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut arcu magna, sodales vel dignissim pharetra, adipiscing sed orci?</a></h3>
             <div>This is the answer to question 2</div></li>
         <li>
             <h3>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut arcu magna, sodales vel dignissim pharetra, adipiscing sed orci?</a></h3>
             <div>This is the answer to question 3</div>
         </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:09:59.580

我认为我可以对您的代码进行一些改进并产生行为，并将代码缩短一点。

请注意，我跳过了使用您的活动课程，以展示如何实现它。

这是我在 FF13 和 Chrome 中测试[的 tinker.io 演示](https://tinker.io/7ca38/1)

```
$('.faq li div').hide();
$('.faq li').click(function(event) {

    var clickedQuestion = event.target;
    var answer = $(clickedQuestion).siblings('div');

    if($('ul.faq').find('div').is(':visible')){
        $('ul.faq').find('div').slideUp();      
    }
    answer.slideDown();

 }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:43:52.090

如果元素已经可见，我喜欢你不向上滑动元素。

也许将 .hide 移动到 css "display:none" 中，等待 dom 加载以隐藏它们是没有意义的。

```
$(document).ready(function() {
  $('.faq li').click(function(event){
    $(this).find('div').not(":visible").slideDown();
    $('.faq li div:visible').not($(this).find('div')).slideUp();
  });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T11:55:14.127

**工作演示** [http://jsfiddle.net/e3Bec/](http://jsfiddle.net/e3Bec/) **或** [http://jsfiddle.net/XGJXM/](http://jsfiddle.net/XGJXM/)

你的代码很好，唯一的事情是使用 ==>`if (!$(this).hasClass('active')) {` **而不是** `if(!$('.faq li').hasClass('active')) {` `:)` **在**你的第一次条件检查中你不需要这个`question.addClass('active');`

休息代码应该有帮助，`:)`

**代码**

```
$(document).ready(function() {
    // hide all the answers
    $('.faq li div').hide();
    $('.faq li').click(function() {
        $('div').slideUp();
        var question = $(this);
        var answer = $(this).find('div');
        // if the faq isn't active
        if (!$(this).hasClass('active')) {
            answer.slideDown();
            $(this).siblings('div').slideUp();
            //question.addClass('active');

        }
        else {        
            answer.slideUp();
            question.removeClass('active');
        }

    });

});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T11:49:43.233

为什么不使用手风琴。[http://jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/)

# c# - 如何实现存储库 FindAll() 方法？

> ID：11261212
> 
> 赞同：0
> 
> 时间：2012-06-29T11:47:15.133
> 
> 标签：c#, .net, design-patterns, linq-to-sql, domain-driven-design

我有以下存储库模式。要求是“查找所有者姓名为 Lijo 的所有帐户”。所以，我需要编写一个 FindAll 函数。这个函数怎么写？

约束是：

1) 客户端“BankAccountService”不应使用“DBML_Project”中的类。

2）我们不应该使用 GetAll 方法来检索完整的帐户列表，然后进行过滤。

注意：我在处理多态性问题时遇到了这个问题[：ORM 实体是域实体还是数据实体？](https://stackoverflow.com/questions/11257484/polymorphism-is-orm-entity-a-domain-entity-or-data-entity)

**代码**

```
namespace ApplicationService_Bank
{
public class BankAccountService
{
    RepositoryLayer.ILijosBankRepository accountRepository = new RepositoryLayer.LijosSimpleBankRepository();

    public void FreezeAllAccountsForUser(string userName)
    {
        //Should not use assembly 'DBML_Project'.

        IEnumerable<DomainEntitiesForBank.IBankAccount> accountsForUserWithNameLIJO = null;
        //accountsForUserWithNameLIJO = accountRepository.FindAll(p => p.BankUser.Name == "Lijo");
    }

}

}

namespace RepositoryLayer
{
public interface ILijosBankRepository
{
    List<DomainEntitiesForBank.IBankAccount> GetAll();
    IEnumerable<DBML_Project.BankAccount> FindAll(System.Func<DBML_Project.BankAccount, bool> predicate);
    void SubmitChanges();
        }

public class LijosSimpleBankRepository : ILijosBankRepository
{

    private IBankAccountFactory bankFactory = new MySimpleBankAccountFactory();
    public System.Data.Linq.DataContext Context
    {
        get;
        set;
    }

    public virtual List<DomainEntitiesForBank.IBankAccount> GetAll()
    {

        List<DBML_Project.BankAccount> allItems = Context.GetTable<DBML_Project.BankAccount>().ToList();
        List<DomainEntitiesForBank.IBankAccount> bankAccounts = new List<DomainEntitiesForBank.IBankAccount>();
        foreach (DBML_Project.BankAccount acc in allItems)
        {
            DomainEntitiesForBank.IBankAccount theAccount = bankFactory.CreateAccount(acc.AccountType, acc.BankAccountID, acc.Status, acc.OpenedDate, acc.AccountOwnerID);
            bankAccounts.Add(theAccount);
        }
        return bankAccounts;
    }

    public IEnumerable<DBML_Project.BankAccount> FindAll(System.Func<DBML_Project.BankAccount, bool> predicate)
    {
        //Where
        var results = Context.GetTable<DBML_Project.BankAccount>().Where(predicate);
        return results;
    }

    public virtual void SubmitChanges()
    {
        Context.SubmitChanges();
    }

}

} 
```

阅读：

1.  [返回 IEnumerable<T> 与 IQueryable<T>](https://stackoverflow.com/questions/2876616/returning-ienumerablet-vs-iqueryablet/2876655#2876655)

2.  [如何设计存储库模式以便以后轻松切换到另一个 ORM？](https://stackoverflow.com/questions/1507286/how-to-design-repository-pattern-to-be-easy-switch-to-another-orm-later?rq=1)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T12:30:45.267

一种简单的方法是手动构建查询：

```
public class SearchCriteria
{
    public string Name { get; set; }
    // ...more
}

public IEnumerable<Entity> FindAll(SearchCriteria criteria)
{
    IQueryable<Entity> entities = _datasource.Entities; // replace with your L2S equivalent

    if (criteria.Name != null)
        entities = entities.Where(e => e.Name == criteria.Name);

    // ...more

    return entities;
} 
```

如果您不想直接返回生成的对象，请在返回之前映射到其他对象：

```
return Map(entities); // IEnumerable<CustomObject> Map(IEnumerable<Entity> entities) 
```

# hibernate - 错误在 Spring-Hibernate 中发现了多行具有给定标识符的行

> ID：11261213
> 
> 赞同：1
> 
> 时间：2012-06-29T11:47:18.603
> 
> 标签：hibernate, spring-mvc, hibernate-criteria

如何从子表中检索所有记录，其中我在子表中给出了多对一，在父表中给出了一对多。喜欢，

我的父类有类似的映射..

```
@OneToMany(mappedBy = "accountMaster")
private Set<AccountsData> pinAccounts; 
```

在我的孩子身上，我有..

```
@ManyToOne(cascade = CascadeType.ALL)
@JoinColumn(name = "mId")
private MasterData accountMaster; 
```

当我尝试以下代码时，我得到了错误`More than one row with the given identifier was found`

我的代码是..

```
Criteria myCriteria = sessionFactory.getCurrentSession().createCriteria(AccountsData.class)
                .add(Restrictions.eq("IsDeleted", false));
        return myCriteria.list(); 
```

我想从子表中获取所有条目。但它显示了那个错误。我怎样才能做到？

提前致谢..

# iphone - 如何比较当前和手动 NSDate

> ID：11261215
> 
> 赞同：0
> 
> 时间：2012-06-29T11:47:25.627
> 
> 标签：iphone, objective-c, ios, nsdate

有一个功能，其中指定 NSDate 选项手动放置。如何防止使用时间参数小于当前时间的函数执行？我试过这个

```
if ([currentDate timeIntervalSinceDate: myTime] < 0) 
```

但不幸的是，有时它不起作用提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:49:04.223

另一种选择是将日期转换为 timeIntervals 使用`timeIntervalSince1970`

```
int interval1 = [date1 timeIntervalSince1970];
int interval2 = [date2 timeIntervalSince1970];

if(interval1 > interval2) //etc... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T11:53:24.190

听起来您想将当前日期与自定义日期进行比较。更具体地说，如果当前日期发生**在**myTime 之后，则条件应该为真。

```
if ([[NSDate date] compare: myTime] == NSOrderedDescending) {
    NSLog(@"Current date is later than myTime");        
} 
```

相反，您将检查与`NSOrderedAscending`.

# python - Python：线程在通过串口接收到 0f 字节后关闭

> ID：11261240
> 
> 赞同：0
> 
> 时间：2012-06-29T11:49:06.763
> 
> 标签：python, multithreading, tcp, serial-port

我正在制作与收银机通信的程序，当我在上面测试打印机（打印从 0 到 100 的数字）时，我注意到每次我得到这个字节（十六进制的 0f）时，我的线程要么阻塞要么关闭。我的项目由2个程序组成，一个用于与收银机和tcp通信，另一个只是坐在tcp端口（稍后将添加DB）所以这是4线程程序：

```
#!/usr/bin/env python

import thread

import crcmod
import Queue
import serial
import socket
import time
#portovi
TCP_IP = '127.0.0.1'
TCP_PORT=5007

v =0
lockSerial = thread.allocate_lock()
lockTcp = thread.allocate_lock()
lockPrn = thread.allocate_lock()
serialBuff = []
tcpBuff = []
prnBuff = []
prnReady=1
stx = chr(0x02)
etx = chr(0x03)
ack = chr(0x06)
nack = chr(0x15)
prnCmd = ('PB','PD','PF','P'+chr(0xc2))
crc8 = crcmod.mkCrcFun(0x131, 0x00)

ser = serial.Serial( 0 , baudrate=19200, bytesize=8, parity='N', stopbits=2, timeout=None, xonxoff=0, rtscts=0, writeTimeout=None, dsrdtr=None)
ser.open()
ser.sendBreak()
sl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sl.bind((TCP_IP, TCP_PORT))
sl.listen(1)

connl, addr = sl.accept()

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.bind((TCP_IP, TCP_PORT+1))
s.listen(1)

conn, addr = s.accept()
def toHex(s):
    lst = []
    for ch in s:
        hv = hex(ord(ch)).replace('0x', '')
        if len(hv) == 1:
            hv = '0'+hv
        lst.append(hv)

    return reduce(lambda x,y:x+y, lst)
#hex2bit
def hex2bit(string):    
    novi = bin(int(string, 16))[2:]
    if len(novi)<8:
        pom=8-len(novi)
        while pom!=0:
            novi = str(0)+novi
            pom=pom-1
    return novi
def serialRecv():
    messageSerRec = ''
    global prnReady
    while 1:

        byte = ser.read()#shuts down here
        if not toHex(byte)=='0f':#even if I change it it shuts down
            if byte == ack:
                print 'ACK'
            elif byte == nack:
                print 'NACK'
            else:
                if byte == stx:
                    messageSerRec = ''
                elif byte == etx:
                    messageSerRecFin = messageSerRec[:-2]
                    chSum = int ('0x%s'%messageSerRec[-2:],0)
                    if chSum == crc8(messageSerRecFin):
                        lockSerial.acquire()
                        serialBuff.append(messageSerRecFin)
                        print "Serial Recv: ", messageSerRecFin
                        lockSerial.release()
                        ser.write(ack)
                        prnReady = 1
                    else: ser.write(nack)
                else: messageSerRec = messageSerRec+byte
        time.sleep(0.01)

def tcpSend(): 
    while 1:
        if serialBuff:
            lockSerial.acquire()
            conn.send(serialBuff[0])
            print "Tcp Send: ", serialBuff[0]
            serialBuff.remove(serialBuff[0])
            lockSerial.release()
    time.sleep(0.01)

def tcpRecv():
    pom=""    
    while 1:
        messageTcpRec = connl.recv(25)
        i=0
        if len(messageTcpRec)>0:
            while i<len(messageTcpRec):
                if not messageTcpRec[i]==';':
                    pom=pom+messageTcpRec[i]
                else:
                    prnBuff.append(pom)
                    pom=""
                i=i+1
            print prnBuff
        #if not messageTcpRec=="":
        #    print "Tcp Recv: ", messageTcpRec
        #    if messageTcpRec[:2] in prnCmd:
        #        lockPrn.acquire()
        #        prnBuff.append(messageTcpRec)
        #        lockPrn.release()
        #    elif tcpBuff:
        #        lockTcp.acquire()
        #        tcpBuff.append(messageTcpRec)
        #        lockTcp.release()
    time.sleep(0.01)

def serialSend():
    global prnReady
    while 1:
        #print "prnRdy=", prnReady
        if tcpBuff:
            print "tcpBuff:", tcpBuff[0]
            lockTcp.acquire()
            ser.write(stx+tcpBuff[0]+hex(crc8(tcpBuff[0]))[-2:].upper()+etx)
            print "Serial Send: ", (tcpBuff[0])
            tcpBuff.remove(tcpBuff[0])
            lockTcp.release()
        if prnBuff:
            if prnReady == 1:
                lockPrn.acquire()
                ser.write(stx+prnBuff[0]+hex(crc8(prnBuff[0]))[-2:].upper()+etx)
                print "Serial Send(prn): ", (prnBuff[0])
                prnBuff.remove(prnBuff[0])
                lockPrn.release()
                prnReady = 0
        time.sleep(0.01)

thread.start_new_thread(serialRecv,())
thread.start_new_thread(tcpSend,())
thread.start_new_thread(tcpRecv,())
thread.start_new_thread(serialSend,())
while 1:pass
s.close() 
```

因此，线程 serialRecv 在收到该字节时关闭，我在过去 2-3 天一直试图解决这个问题，但找不到解决方案。

# matlab - Matlab：两个矩阵之间的唯一值

> ID：11261241
> 
> 赞同：1
> 
> 时间：2012-06-29T11:49:15.720
> 
> 标签：matlab, matrix

我有2个矩阵：

```
 T3(:,:,1) =

 0     0     0     0     1     0     0     0     0
 0     0     0     0     2     0     0     0     0
 0     0     0     0     3     0     0     0     0
 0     1     0     1     4     2     0     4     0
 0     3     0     2     6     3     0     5     0
 2     4     2     5     7     5     4     6     5
 4     5     5     7     8     8     5     7     6
 5     6     6     8     9     9     8     9     8

 T3(:,:,2) =

 2     1     1     1     1     1     1     1     1
 3     3     2     2     2     2     2     2     2
 4     4     4     3     3     3     3     3     3
 5     5     5     5     4     4     4     4     4
 6     6     6     6     6     5     5     5     5
 7     7     7     7     7     7     6     6     6
 8     8     8     8     8     8     8     7     7
 9     9     9     9     9     9     9     9     8 
```

如何使 T3(:,:,1) 中的值在 T3(:,:,2) 中变为零？

例如，在 T3(:,:,1) 的第一列中，值为 2,4,5。我希望 T3(:,:,2) 的第一列将值 2,4,5 设为零。

```
 T3(:,:,2) =

 0     0     1     0     0     1     1     1     1
 3     0     0     0     0     0     2     2     2
 0     0     4     3     0     0     3     3     3
 0     0     0     0     0     4     0     0     4
 6     0     0     6     0     0     0     0     0
 7     7     7     0     0     7     6     0     0
 8     8     8     0     0     0     0     0     7
 9     9     9     9     0     0     9     0     0 
```

我想知道是否有办法使用 setdiff 或 unique 来做到这一点。

```
for y=1:H-1
     for z=1:H-1
         for h=1:H
             for d=1:D-1
                 if T3(y,h,d+1) == T3(z,h,d)
                    T3(y,h,d+1)=0;
                 end
             end
         end
     end
end 
```

我可以将其作为一个循环来执行，其中 H = 列数 (9) 和 D = 维度数 (2)。一定会有更好的办法 ：）？

非常感谢你们。

# json - 用户界面对话框上的 ASP.NET MVC 客户端验证？

> ID：11261242
> 
> 赞同：0
> 
> 时间：2012-06-29T11:49:17.590
> 
> 标签：json, jquery-ui, validation, asp.net-mvc-4

剃刀：

```
@Html.TextBoxFor(kod => kod.Name)
@Html.ValidationMessage("Name","Client Error Message") 
```

控制器：

```
[HttpPost]
    public JsonResult JsonAddCustomer(Customers customer, string returnUrl)
    {
        if (customer.Name.Trim().Length == 0)
        {
            ModelState.AddModelError("Name", "Server Error Message");
        }

        //Eğer hata yoksa veri tabanına kayıt yapılıyor.
        if (ModelState.IsValid)
        {
            try
            {
                CusOpp.InsertCustomer(customer);
                return Json(new { success = true, redirect = returnUrl });
            }
            catch (Exception e)
            {
                ModelState.AddModelError("", "Error");
            }
        }

        return Json(new { errors = GetErrorsFromModelState() });
    } 
```

我想写验证错误信息。我像上面那样做了，但`@Html.ValidationMessage("Name","Client Error Message")`不起作用。事实上，我已经在期待它了。

我想显示这个语句的结果：`@Html.ValidationMessageFor(m => m.name)`，但我不能使用它，因为我使用了实体数据模型。

我应该将`[Required]`语句添加到数据模型类还是我这样做的任何方式。抱歉解释不好。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:02:11.723

在这种情况下，您应该返回 PartialViews 而不是 JSON。只有在成功的情况下才能返回 JSON：

```
[HttpPost]
public ActionResult JsonAddCustomer(Customers customer, string returnUrl)
{
    // Warning: the following line is something horrible => 
    // please decorate your view model with data annotations or use
    // FluentValidation.NET to validate it. 
    // Never write such code in a controller action.
    if (customer.Name.Trim().Length == 0)
    {
        ModelState.AddModelError("Name", "Server Error Message");
    }

    //Eğer hata yoksa veri tabanına kayıt yapılıyor.
    if (ModelState.IsValid)
    {
        try
        {
            CusOpp.InsertCustomer(customer);
            return Json(new { success = true, redirect = returnUrl });
        }
        catch (Exception e)
        {
            ModelState.AddModelError("", "Error");
        }
    }

    return PartialView(customer);
} 
```

现在在 AJAX 请求的成功回调中，您可以测试 POST 操作是否成功：

```
success: function(result) {
    if (result.redirect) {
        // we are in the success case => redirect
        window.location.href = result.redirect; 
    } else {
        // a partial view with the errors was returned => we must refresh the DOM
        $('#some_container').html(result);

        // TODO: if you are using unobtrusive client side validation here's 
        // the place to call the $.validator.unobtrusive.parse("form"); method in order 
        // to register the unobtrusive validators on the newly added contents
    }
} 
```

这是一篇[类似的文章](https://stackoverflow.com/a/8922646/29407)，您也可以阅读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:09:20.587

您在模型上带有必需注释的想法是一个好方法。您可以在必需注释上设置错误消息。

```
[Required(ErrorMessage = "Please enter a name")] 
```

并在您的操作中删除您的 if ..this：

```
if (customer.Name.Trim().Length == 0)
        {
            ModelState.AddModelError("Name", "Server Error Message");
        } 
```

**ModelState.IsValid**将在客户端和服务器端为您完成这项工作。

并在您的视图中使用您的**@Html.ValidationMessageFor(m => m.name)**

# wcf - WCF：具有 PrincipalPermissions 的自定义 RoleProvider：似乎没有受到打击/如何调试它？

> ID：11261244
> 
> 赞同：0
> 
> 时间：2012-06-29T11:49:32.893
> 
> 标签：wcf, authorization, roleprovider, principalpermission

我有一个继承 RoleProvider 的自定义角色提供程序。在网络应用程序中，这可以正常工作，没有问题。

但是，我也在 WCF 服务中使用它，并且在进入它时遇到了很大的问题。以至于我怀疑它根本没有被击中。如果我完全打开任何主体权限，我会被拒绝访问，并且堆栈跟踪完全没有帮助。甚至 WCF 跟踪也对确定发生了什么非常有帮助。

我知道 TennisRoleProvider 使用它的默认构造函数并通过测试验证了它的方法。这似乎是一个集成问题。

所以片段...

编辑：我已经将角色提供者移动到服务程序集中，因为阅读了一些关于需要涉及 GAK 和密钥（需要完全信任运行）的内容。我走了那条路，但事情仍然没有奏效，所以决定简单地将东西移到服务项目中以简化。仍然没有喜悦。

```
<roleManager defaultProvider="TennisRoleProvider"
             enabled="true"
             >
  <providers>
    <clear/>
    <add name="TennisRoleProvider"
         type="Tennis.Security.TennisRoleProvider, Tennis.Security" />
  </providers>
</roleManager>

   <bindings>
     <wsHttpBinding>
        <binding name="wsHttpUserName">
          <security mode="TransportWithMessageCredential">
            <message clientCredentialType="UserName"/>
            <transport clientCredentialType="None"/>
          </security>
        </binding>
     </wsHttpBinding>
   <bindings/>

    <behavior name="RoleBehavior">
       <serviceCredentials>
         <serviceCertificate findValue="john-pc"
                      storeLocation="LocalMachine"
                      storeName="My"
                      x509FindType="FindBySubjectName"/>
       <userNameAuthentication userNamePasswordValidationMode="Custom" 
customUserNamePasswordValidatorType="Tennis.Components.TennisUserValidator, Tennis.Components"/>
      </serviceCredentials>

      <serviceAuthorization principalPermissionMode="UseAspNetRoles" 
                            roleProviderName="TennisRoleProvider">
      </serviceAuthorization>

      <serviceMetadata httpsGetEnabled="true"/>
      <serviceDebug includeExceptionDetailInFaults="true"/>
      <errorHandler />
    </behavior>

   <services>
      <service name="Tennis.Service.Services"
               behaviorConfiguration="RoleBehavior">
          <endpoint address="Family"
                 binding="wsHttpBinding"
                 bindingConfiguration="wsHttpUserName"
                 contract="Tennis.Service.Contracts.IFamilyAdmin"
                  />
      </service>
    </services> 
```

然后在服务方法上我有以下内容（Roles.Family admin 是一个字符串）

```
[PrincipalPermission(SecurityAction.Demand, Name = Roles.FamilyAdmin)]
public VoidResult<SuccessEnum> UpdateFamily(Family family)
{

} 
```

所以有两个问题...... 1）我做错了什么？2) 我怎样才能进入 WCF 以确定到底出了什么问题？

干杯

日志中错误的堆栈跟踪如下注意其中的权限与我上面使用的权限不同（Namley 'authorized' 而不是 'FamilyAdmin'。但实际上这些值匹配并且用户拥有正确的权限。

```
<E2ETraceEvent xmlns="http://schemas.microsoft.com/2004/06/E2ETraceEvent">
<System xmlns="http://schemas.microsoft.com/2004/06/windows/eventlog/system">
<EventID>131076</EventID>
<Type>3</Type>
<SubType Name="Warning">0</SubType>
<Level>4</Level>
<TimeCreated SystemTime="2012-06-29T12:45:30.2469191Z" />
<Source Name="System.ServiceModel" />
<Correlation ActivityID="{6e59b4f4-d59b-42eb-ad8e-4d5853f72900}" />
<Execution ProcessName="w3wp" ProcessID="9388" ThreadID="18" />
<Channel />
<Computer>JOHNN-PC</Computer>
</System>
<ApplicationData>
<TraceData>
<DataItem>
<TraceRecord xmlns="http://schemas.microsoft.com/2004/10/E2ETraceEvent/TraceRecord" Severity="Warning">
<TraceIdentifier>http://msdn.microsoft.com/en-GB/library/System.ServiceModel.Diagnostics.TraceHandledException.aspx</TraceIdentifier>
<Description>Handling an exception.</Description>
<AppDomain>/LM/W3SVC/2/ROOT/Tennis-1-129854474506679191</AppDomain>
<Exception>
<ExceptionType>System.Security.SecurityException, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ExceptionType>
<Message>Request for principal permission failed.</Message>
<StackTrace>
at System.Security.Permissions.PrincipalPermission.ThrowSecurityException()
at System.Security.Permissions.PrincipalPermission.Demand()
at System.Security.PermissionSet.DemandNonCAS()
at Nomical.Tennis.Service.Services.GetBookingsForUser(DateTime start, DateTime end) in c:\tfs\Tennis\TennisSolution\TennisCourts\Services.svc.cs:line 388
at SyncInvokeGetBookingsForUser(Object , Object[] , Object[] )
at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]&amp; outputs)
</StackTrace>
<ExceptionString>System.Security.SecurityException: Request for principal permission failed.
   at System.Security.Permissions.PrincipalPermission.ThrowSecurityException()
   at System.Security.Permissions.PrincipalPermission.Demand()
   at System.Security.PermissionSet.DemandNonCAS()
   at Tennis.Service.Services.GetBookingsForUser(DateTime start, DateTime end) in c:\tfs\Tennis\TennisSolution\TennisCourts\Services.svc.cs:line 388
   at SyncInvokeGetBookingsForUser(Object , Object[] , Object[] )
   at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]&amp; outputs)
The action that failed was:
Demand
The type of the first permission that failed was:
System.Security.Permissions.PrincipalPermission
The first permission that failed was:
&lt;IPermission class="System.Security.Permissions.PrincipalPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
version="1"&gt;
&lt;Identity Authenticated="true"
ID="Authorised"/&gt;
&lt;/IPermission&gt;

The demand was for:
&lt;IPermission class="System.Security.Permissions.PrincipalPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
version="1"&gt;
&lt;Identity Authenticated="true"
ID="Authorised"/&gt;
&lt;/IPermission&gt;

The assembly or AppDomain that failed was:
mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ExceptionString>
</Exception>
</TraceRecord>
</DataItem>
</TraceData>
</ApplicationData>
</E2ETraceEvent> 
```

编辑：根据下面的答案，我在构造函数中添加了几行代码——虽然它们没有实现任何目标，但鼓励我询问线程静态类。

编辑：给出一个关于日志更新日志的问题，以表明它确实来自日志 - 或者我很困惑；）

TennisRoleProvider 在其非公共成员中被它引用 - 此外，当我覆盖 Name 以使其返回某些内容时，我会认识到这是由它返回的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T15:29:45.873

问题是我在程序集/应用程序域中使用安全性。

我需要让所有东西都可信并签名才能正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:38:41.313

在您的角色提供者之一中设置一个断点。如果您的 WCF 服务是自托管的，请启动主机，或者如果您在 IIS 下拥有它，则只需访问其 *svc 文件。从 Visual Studio 转到调试，单击附加到进程并从列表 w3wp.exe 中选择您的工作进程（如果您看不到它，请选中“显示所有用户的进程”和“全部显示进程”复选框会话”。现在您可以附加到您的 WCF 服务执行过程。最后要做的事情是，从您的客户端调用您的服务的一个测试方法，看看您的断点是否被命中。

如果这不起作用，那么只需在您的服务级别启用跟踪并检查跟踪日志文件中的任何可疑信息。

# java - Java中如何实现重入？

> ID：11261246
> 
> 赞同：4
> 
> 时间：2012-06-29T11:49:40.333
> 
> 标签：java, concurrency

当同一个线程试图获取它已经拥有 的*锁时，实际上会发生什么？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:21:04.747

我猜你的问题是关于`synchronized`块/修饰符的语义。请参阅[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.1)。如果您的问题是关于特定实现的方式，那么您需要指定您想到的确切实现。但这是一种很好理解的技术，我看不出有什么理由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:15:40.040

引用自[http://download.java.net/jdk7/archive/b123/docs/api/java/util/concurrent/locks/ReentrantLock.html](http://download.java.net/jdk7/archive/b123/docs/api/java/util/concurrent/locks/ReentrantLock.html)

> 一种可重入互斥锁，其基本行为和语义与使用同步方法和语句访问的隐式 >monitor 锁相同，但具有扩展的 > 功能。
> 
> ReentrantLock 由上次成功锁定但尚未解锁的线程拥有。>当锁不被另一个线程拥有时，调用锁的线程将返回，成功获取锁。如果当前线程已经>拥有锁，该方法将立即返回。这可以使用方法 isHeldByCurrentThread() 和 getHoldCount() 来检查。

我同意 GrepCode 解释得很好

# android - android中具有多个getView的CustomAdapter

> ID：11261252
> 
> 赞同：0
> 
> 时间：2012-06-29T11:50:04.443
> 
> 标签：android, android-view, android-adapter

我有一个活动，我在其中显示媒体文件列表，即视频、音频、图像和动画。单击列表项时（截至目前的图像），活动必须在网格视图中显示本地资产文件夹中的所有图像。为此，我使用单个适配器并在我的 getView() 函数中有一个开关盒。根据构造函数中设置的选项，将执行切换案例。它适用于 ListView 显示，但我无法在网格视图中显示图像列表。任何帮助将不胜感激。提前致谢。这是我的代码：

```
 package com.bookshelf;
    import java.io.File;
    import java.io.FilenameFilter;
    import java.io.IOException;
    import java.util.ArrayList;
    import android.app.Activity;
    import android.app.AlertDialog;
    import android.content.Context;
    import android.content.DialogInterface;
    import android.content.DialogInterface.OnClickListener;
    import android.content.res.AssetManager;
    import android.graphics.Bitmap;
    import android.graphics.BitmapFactory;
    import android.media.ThumbnailUtils;
    import android.os.Bundle;
    import android.provider.MediaStore;
    import android.view.LayoutInflater;
    import android.view.View;
    import android.view.ViewGroup;
    import android.widget.AdapterView;
    import android.widget.AdapterView.OnItemClickListener;
    import android.widget.BaseAdapter;
    import android.widget.Gallery;
    import android.widget.GridView;
    import android.widget.ImageView;
    import android.widget.ListAdapter;
    import android.widget.ListView;
    import android.widget.TextView;
    import android.widget.Toast;
    public class MediaGalaryListActivity extends Activity implements
    OnItemClickListener {

private ArrayList<String> mGalary = new ArrayList<String>();
private Bitmap mBitArray[];
private Gallery mMediaGallery;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.mediagalary);
    mGalary.add("Videos");
    mGalary.add("Audios");
    mGalary.add("Images");
    mGalary.add("Animation");
    ListView lv = (ListView) findViewById(R.id.mediaGal);
    mMediaGallery = (Gallery) findViewById(R.id.mediaGallery);

    lv.setAdapter(new MediaGalaryAdapter(this, mGalary, 1));
    lv.setOnItemClickListener(this);
}

class MediaGalaryAdapter extends BaseAdapter {

    private ArrayList<String> mGal = new ArrayList<String>();
    private Bitmap[] mImgArray;
    private Context context;
    private LayoutInflater mInflate;
    private int mAdapterOpt;

    public MediaGalaryAdapter(Context ctx, ArrayList<String> gal,
            int adapOpt) {
        context = ctx;
        mGal = gal;
        mAdapterOpt = adapOpt;
        mInflate = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    public MediaGalaryAdapter(Context ctx, Bitmap[] imgArray, int adapOpt) {
        context = ctx;
        mImgArray = imgArray;
        mInflate = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        mAdapterOpt = adapOpt;
    }

    public int getCount() {
        int size = 0;
        switch (mAdapterOpt) {
        case 1:
            size = mGal.size();
            break;
        case 2:
            size = mImgArray.length;
            break;
        }
        return size;
    }

    public Object getItem(int position) {
        return null;
    }

    public long getItemId(int position) {
        return 0;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        switch (mAdapterOpt) {
        case 1:
            convertView = mInflate.inflate(R.layout.medialayout, null);
            TextView tv = (TextView) convertView.findViewById(R.id.text);

            tv.setText(mGal.get(position));
            break;
        case 2:
            ImageView imgView;

            convertView = mInflate.inflate(R.layout.image_gallery, null);

            imgView = new ImageView(context);
            imgView.setImageBitmap(mImgArray[position]);
            imgView.setScaleType(ImageView.ScaleType.CENTER_CROP);

            imgView.setLayoutParams(new GridView.LayoutParams(100, 100));
            imgView.setPadding(8, 8, 8, 8);

            break;
        }

        return convertView;
    }
}

// For filtering the filename with extensions
class FileNamFilter implements FilenameFilter {
    private String mFileExtn;

    public FileNamFilter(String extn) {
        mFileExtn = "." + extn;
    }

    public boolean accept(File dir, String filename) {
        return filename.endsWith(mFileExtn);
    }
}

public void onItemClick(AdapterView<?> parent, View view, int pos, long id) {
    String mediaType = mGalary.get(pos);

    String list[] = null;
    AssetManager assetManager = getAssets();
    try {
        list = assetManager.list("Immersive");
        mBitArray = new Bitmap[list.length];

        System.out.println("Length of list ="+list.length);

        for (int i = 0, idx = 0; i < list.length; i++) 
        {

            if (list[i].endsWith(".png") || list[i].endsWith(".gif")
                    || list[i].endsWith(".jpeg")
                    || list[i].endsWith(".jpg"))
            {
                mBitArray[idx++] = BitmapFactory.decodeStream(assetManager
                        .open("Immersive/" + list[i]));
                System.out.println("Image at position "+i+" is "+list[i]);
            }
            ;

        }
        mMediaGallery
                .setAdapter(new MediaGalaryAdapter(this, mBitArray, 2));
    } catch (IOException e) {
        e.printStackTrace();
    }

    AlertDialog.Builder build = new AlertDialog.Builder(this);
    build.setTitle("InProgress....");
    // build.setIcon(android.R.drawable.)
    build.setMessage(mediaType + " is Inprogress...");
    build.setPositiveButton("Ok", new OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {
            // finish();
        }
    });
    AlertDialog alert = build.create();
    alert.show();
    // Toast.makeText(getApplicationContext(), mediaType, 30).show();
}

class MediaGalary {
    private ImageView mImage;
    private TextView mName;

    public MediaGalary(ImageView img, TextView strName) {
        mImage = img;
        mName = strName;
    }

    public ImageView getmImage() {
        return mImage;
    }

    public void setmImage(ImageView mImage) {
        this.mImage = mImage;
    }

    public TextView getmName() {
        return mName;
    }

    public void setmName(TextView mName) {
        this.mName = mName;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T05:13:14.240

设备中的每个应用程序都将由 DVM 分配一定数量的内存。您正在出现内存不足错误，因为您的应用程序超出了 dvm 分配给您的应用程序的内存。例如在 froyo 中，为应用程序分配的内存为 16Mb。如果您的应用程序超过 16Mb，则会出现内存不足错误。解决方案是您必须压缩您在应用程序中使用的图像，并且您必须清除所有正在使用的集合。完成工作后，尝试清除您正在使用的所有集合。您可以使用堆工具在 ddms 中检查您的应用程序消耗了多少内存。希望这对您有所帮助。

# ruby-on-rails - 找不到 gem "multi_json" 的兼容版本：

> ID：11261254
> 
> 赞同：4
> 
> 时间：2012-06-29T11:50:07.750
> 
> 标签：ruby-on-rails, salesforce

我尝试运行服务器，但这个结果总是出现在我面前

```
could not find compatible versions for gem "multi_json":
  In Gemfile:
    rails (= 3.2.6) ruby depends on
      multi_json (~> 1.0) ruby 
```

我有 rails 3.2.6 我尝试使用捆绑更新但结果相同

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T13:58:16.940

加入`gem "multi_json"`Gemfile

删除 Gemfile.lock 文件

然后运行`bundle install`

这帮助我克服了上述错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:38:15.843

在你的包中找到 multi_json 的最低兼容版本。就我而言，它是 1.3.0，所以我将以下内容添加到我的 Gemfile

`gem "multi_json", "~> 1.3.0"`

然后运行

`bundle update multi_json`

这将从冲突版本中解锁 multi_json 并根据最低兼容版本安装您的包。

# c# - 使用 C++ 在 C# 位图上绘图

> ID：11261256
> 
> 赞同：5
> 
> 时间：2012-06-29T11:50:14.733
> 
> 标签：c#, c++, bitmap, drawing, gdi

我有一个第 3 方 dll（纯 C++），它在 HDC 上绘制了一些行。我想在 C# 位图或表单上有这些行。

我试图给 C++ 一个 HBITMAP 或 Graphics.FromImage(bitmap) 的 HDC，但上述方法都不适合我。

使用 MFC TestApp，使用以下代码一切正常

```
HWND handle = pStatic->GetSafeHwnd();
CDC* dc = pStatic->GetDC();

Draw(dc); 
```

我的问题是：我必须做什么/使用上述 Draw(HDC) 方法在位图或表单上绘图？

我希望你能帮助我。提前致谢，

帕特里克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T14:15:08.573

要在 C# 位图上绘图，请使用以下代码：

```
 Graphics gr = Graphics.FromImage(MyBitmap);
        IntPtr hdc = gr.GetHdc();
        YourCPPDrawFunction(hdc);
        gr.ReleaseHdc(hdc); 
```

**YourCPPDrawFunction**的一个示例是：

```
 void YourCPPDrawFunction(HDC hDc)
    {
        SelectObject(hDc, GetStockObject(BLACK_PEN));
        Rectangle(hDc, 10, 10, 20, 20);
    } 
```

要直接在表单表面上绘制，请使用以下代码：

```
 protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);
        IntPtr hdc = e.Graphics.GetHdc();
        YourCPPDrawFunction(hdc);
        e.Graphics.ReleaseHdc(hdc);
    } 
```

完成绘图后不要忘记调用 Graphics.ReleaseHdc() ，否则您将看不到绘图的结果。

# search - 无法在 iPhone 上使用阿拉伯语键盘搜索波斯语文本

> ID：11261258
> 
> 赞同：2
> 
> 时间：2012-06-29T11:50:22.800
> 
> 标签：search, unicode, arabic, persian, farsi

我最近为 iphone 开发了一本书，并在这个应用程序中实现了搜索功能。但在真正的 iphone 上测试该应用程序后，我想知道它无法找到所有搜索词。（在我的 Mac 上使用波斯语键盘）

例如，它找不到包含“ی”字符的单词，因为搜索词包含从 iphone 阿拉伯语键盘插入的“ي”字符！

我的文字很多，我找不到所有这些相似的字符！

有什么方法可以将我的波斯语文本转换为阿拉伯语文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:29:09.590

您可能需要规范化文本或使用对各种阿拉伯字母形式（首字母、中字母、尾韵、孤立字母）不敏感或对变音符号不敏感的搜索例程。

特别是 'ي' 是 U+064A 'ARABIC LETTER YEH' 而 'ی' 是 U+FBFC 'ARABIC LETTER FARSI YEH ISOLATED FORM'。

您可能会查看方法 `localizedCaseInsensitiveCompare:`或各种搜索选项，例如 to `NSDiacriticInsensitiveSearch`。

这是一篇讨论这个问题的博客文章，虽然它实际上并没有说明如何解决这个问题：[http ://www.siao2.com/2006/02/14/531572.aspx](http://www.siao2.com/2006/02/14/531572.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T18:37:29.203

我用这种方法解决了这个问题：

```
- (NSString *)correctSearchTermCharcters:(NSString *)searchTerm
{
    return [searchTerm stringByReplacingOccurrencesOfString:@"ي" withString:@"ی"];
} 
```

如果需要，您可以替换更多字符。

# html - 滚动容器内的 CSS 位置元素“固定”

> ID：11261270
> 
> 赞同：41
> 
> 时间：2012-06-29T11:51:08.840
> 
> 标签：html, css, position

我想知道是否有人找到了解决方案？

我正在寻找一种将元素附加到滚动容器顶部的解决方案

HTML：

```
<div class="container">
  <div class="header">title</div>
  <div class="element">......</div>
  ... (about 10-20 elements) ...
  <div class="element">......</div> 
</div> 
```

所有“元素”都有`position:relative`，

该容器具有以下 CSS：

```
.container {
  position:relative;
  width:200px;
  height:400px;
  overflow-y:scroll;
} 
```

我希望标题保持在容器的顶部，与其滚动位置和下方滚动的元素无关。

到目前为止的CSS：

```
.header {
  position:absolute; /* scrolling out of view :-( */
  z-index:2;
  background-color:#fff;
}
.element{
  position: relative;
} 
```

所有元素都是块元素，我无法将标题移出容器。jquery 在这一点上是没有选择的。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-06-27T06:48:46.717

我认为您的解决方案通过`position:sticky`. 好像是这样`position:fixed`，但尊重他父母的相对位置。

不幸的是，这是一个实验性功能，仅在 Chromium 中受支持。您可以在[此测试页面](http://html5-demos.appspot.com/static/css/sticky.html)中查看更多详细信息。

我想到的纯 css 解决方案是对标记稍作改动。您只能为“元素”设置容器，如下所示：

```
<div class="cont_elements">
      <div class="element">......</div>
      .....
</div> 
```

并给这个内部容器溢出。现在，您的标题位于顶部。

[这是一个工作演示](http://jsfiddle.net/S65wj/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-11-01T18:02:29.670

这是我想出的解决方案`position: sticky`（不幸的是没有 IE）：

[https://codepen.io/waterplea/pen/JjjMXzR](https://codepen.io/waterplea/pen/JjjMXzR)

这个想法是在滚动容器的顶部有一个 0 高度的粘性容器，所以它会粘住但不会推动下面的任何内容，然后将你的东西绝对放置在其中。这样你有宽度但没有高度，所以你只能从顶部定位一些东西，就像我在我的例子中对按钮所做的那样。

**编辑**：找到一种方法使其具有 100% 的高度，而不是使用浮动推送下面的内容。更新了代码笔。`calc(100% - 1px)`由于 Firefox 中的这个错误而不得不使用： [https ://bugzilla.mozilla.org/show_bug.cgi?id=1612561](https://bugzilla.mozilla.org/show_bug.cgi?id=1612561)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-29T13:15:29.130

这种情况下的解决方案是在滚动元素之外弹出标题：

```
<div class="header">title</div>
<div class="container">
    <div class="element">......</div>
    <div class="element">......</div>
</div> 
```

虽然如果可能的话，你可能应该有更好的语义元素（只是在这里猜测）：

```
<h3>title</h3>
<ul>
    <li>......</li>
    <li>......</li>
</ul> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-29T13:16:17.703

jQuery UI 添加了一个[position()](http://jqueryui.com/demos/position/)实用方法就是为了这个目的，让你的生活更轻松。

```
$( "#someElement" ).position({
    of:  //Element to position against,
    my:  //which position on the element being positioned,
    at:  //which position on the target element eg: horizontal/vertical,
    offset:  // left-top values to the calculated position, eg. "50 50"
}); 
```

绝对帮助了我。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-06-23T13:45:23.210

用容器包裹要滚动的元素：`height: 100%; overflow: scroll`.

将滚动容器和标题放在另一个具有固定高度的容器中。

然后`position: absolute`是外部容器内的标题。

```
.scroll-container {
  height: 100%;
  overflow-y: scroll;
}

.outer-container {
  position: relative;
  width: 200px;
  height: 200px;
}

.header {
  position: absolute; /* relative to outer container */
  background-color: pink;
  width: 100%;
  z-index: 2;
}

.element {
  position: relative;
  background-color: gold;
}
```

```
<div class="outer-container">
  <div class="header">title</div>
  <div class="scroll-container">
    <div class="element">......</div>
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div>
    <div class="element">......</div>
    <div class="element">......</div>
    <div class="element">......</div>
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div> 
    <div class="element">......</div>
    <div class="element">......</div>
    <div class="element">......</div>
  </div>
</div>
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-25T18:35:07.790

对于这种解决方案，您将找到的最佳答案来自此链接[如何在特定高度后固定滚动 div 并在到达其他 div 后停止？](https://stackoverflow.com/questions/29626397/how-to-fixed-scroll-div-after-certain-height-and-stop-after-reach-other-div/29626943) 我希望这可以节省一些人在谷歌上搜索的时间

```
 var navWrap = $('#navWrap'),
        nav = $('nav'),
        startPosition = navWrap.offset().top,
        stopPosition = $('#stopHere').offset().top - nav.outerHeight();

    $(document).scroll(function () {
        //stick nav to top of page
        var y = $(this).scrollTop()

        if (y > startPosition) {
            nav.addClass('sticky');
            if (y > stopPosition) {
                nav.css('top', stopPosition - y);
            } else {
                nav.css('top', 0);
            }
        } else {
            nav.removeClass('sticky');
        } 
    });
```

```
body {
    height:1600px;
    margin:0;
}
#navWrap {
    height:70px
}
nav {
    height: 70px;
    background:gray;
}
.sticky {
    position: fixed;
    top:0;
}

h1 {
    margin: 0;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit morb​​,o vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
<div id="navWrap">
    <nav>
         <h1>I stick to the top when you scroll down and unstick when you scroll up to my original position</h1>
    </nav>
</div>

<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit​​, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit morb​​,o vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
<br>
<div id="stopHere">
<h3 style="color:red">I want it stop fixed scrolling here. If I'm back to scrolling up, It will follow also to original position.</h3>
</div>
<br>
<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit morb​​,o vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit​​, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit morb​​,o vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit​​, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit morb​​,o vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-26T23:01:38.170

使用粘性。绝对有效！

父容器：

```
position:relative; 
```

子容器：

```
position: sticky; // fixed on the page 
```

# c++ - 从 SDL_Surface 到 QPixmap 的高效转换

> ID：11261275
> 
> 赞同：3
> 
> 时间：2012-06-29T11:51:37.263
> 
> 标签：c++, qt, sdl

我需要提取像素信息并填充要在我的 Qt 程序中使用的 QPixmap。

我目前正在分两步执行此操作。

*   SDL_Surface 到 Windows .bmp 使用`SDL_SaveBMP()`
*   .bmp 到 QImage
*   QImage 到 QPixmap

我将中间 .bmp 存储在内存中。但总的来说，我对这种方法并不满意，因为它涉及与 .bmp 相关的文件格式转换开销

有更好的建议吗？

**编辑：**分享最终的工作代码，来自 jrok 的答案加上尝试像素格式

```
SDL_Surface *screen = ... /* Whatever surface you want to copy from */
SDL_Surface *surface = SDL_CreateRGBSurface(SDL_SWSURFACE,
                       screen->w, screen->h,
                       24, rmask, gmask, bmask, amask);
SDL_BlitSurface(screen,NULL, surface,NULL);
QImage img(static_cast<uchar*>(surface->pixels),
                       surface->w, surface->h, QImage::Format_RGB888); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:36:30.850

[`QImage`构造函数](http://qt-project.org/doc/qt-4.8/qimage.html#QImage-5)之一获取原始图像数据。您可以`pixels`从 SDL_Surface 结构中传递它的指针：

```
SDL_Surface* surf = /* get surface */

QImage img(static_cast<uchar*>(surf->pixels), surf->w, surf->h, QImage::Format_RGB32); 
```

最后一个参数将取决于 SDL_Surface 的[SDL_PixelFormat](http://wiki.libsdl.org/moin.cgi/SDL_PixelFormat)。

然后你可以简单地`QPixmap`从`QImage`：

```
QPixmap = QPixmap::fromImage(img); 
```

[QPixmap::fromImage() 参考](http://qt-project.org/doc/qt-5.0/qpixmap.html#fromImage)

# javascript - 使用 MicrosoftMVCJqueryValidation.js 禁用 ASP.NET MVC 中禁用输入控件的客户端验证

> ID：11261276
> 
> 赞同：0
> 
> 时间：2012-06-29T11:51:39.037
> 
> 标签：javascript, jquery, validation, asp.net-mvc-2, client-side-validation

我正在使用 MicrosoftMVCJqueryValidation.js 并希望禁用对禁用输入控件的客户端验证。

或者有什么方法可以使用javascript启用/禁用客户端验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T06:02:48.507

您可以在禁用表单元素时删除不显眼的验证元数据，并在启用时再次添加它。这个[关于](https://stackoverflow.com/questions/7389652/disable-required-validation-by-javascript)stackoverflow的问题会有所帮助。

# jquery - 如何使用 jQuery 将“平面图像”站起来像弹出书一样站立

> ID：11261279
> 
> 赞同：1
> 
> 时间：2012-06-29T11:51:50.910
> 
> 标签：jquery, html, animation, css

我想用jQuery站起来一个平面图像，就好像它平放在桌子上一样，然后在页面加载时垂直站起来，就像一本弹出书......

有谁知道任何资源可以帮助我或有解决方案的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:03:08.893

您可以使用[http://ricostacruz.com/jquery.transit/](http://ricostacruz.com/jquery.transit/) (->3D ROTATION->Rotate X)

以下适用于 Chrome 20 [http://jsfiddle.net/t9Dty/](http://jsfiddle.net/t9Dty/)

HTML：

```
<div class="rotate">
  Hello World
</div>

<a href="#">run it</a> 
```

CSS：

```
body{
  padding: 50px;
}

.rotate{
  width: 100px;
    height: 200px;
    border:1px solid #000;
    -webkit-box-shadow: 0px 0px 10px 2px #000000;
    background: #eee; 
    -webkit-transform: rotateX(90deg)
} 
```

JS：

```
//set transform origin to y bottom
$('.rotate').css({ transformOrigin: '50% 100%' });

$('a').click(function(){
  $('.rotate').transition({ rotateX: '0deg', perspective: '100px' });
});
​ 
```

# javascript - 从父模型继承主干属性

> ID：11261282
> 
> 赞同：1
> 
> 时间：2012-06-29T11:52:06.797
> 
> 标签：javascript, inheritance, backbone.js

如果我有这个模型：

```
var myParentModel = Backbone.Model.extend({
   defaults:{ parent1: null,
              parent2: null}
)}; 
```

我有另一个模型：

```
var myModel = myParentModel.extend({
   defaults: {child1: null,
              child2: null}
)}; 
```

如果我实例化一个新的 myModel：

```
var mymodel = new myModel({child1: 'mychild1'}); 
```

在 attributes 属性中我只设置了默认的 child2 属性，如何实现继承父模型的 parents 属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T17:54:25.833

在 github 中有一篇关于这个问题的[有趣帖子](https://github.com/documentcloud/backbone/issues/476)，我实施的解决方案是这样的：

```
myModel.prototype.defaults = 
    _.extend({
        child1: null,
                child2: null
    }, myParentModel.prototype.defaults, 
       myModel.prototype.defaults); 
```

使用下划线函数：extend，我们有了一个新的对象，默认带有父子原型，这是一个很好的多重继承解决方案

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T22:56:04.240

我使用了这个，此时如果您在同一范围内，则不需要使用原型：

```
var abstractDefaults = {
  parent1 : '',
  parent2 : ''
};
var MyParentModel = Backbone.Model.extend({
   defaults: abstractDefaults 
});
var MyModel = Backbone.Model.extend({
   defaults: _.extend( abstractDefaults, {
     child1 : '',
     child2 : ''
   } ) 
}); 
console.log(new MyModel().toJSON()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-18T10:21:49.710

我真的建议使用函数来扩展默认属性，如下所示：

```
var MyParentModel = Backbone.Model.extend({
    defaults: {
        parent1 : '',
        parent2 : ''
    }
});
var MyModel = MyParentModel.extend({
    defaults: function() {
        return _.extend(
            {
                child1 : '',
                child2 : ''
            },
            MyParentModel.prototype.defaults
        );
    }
}); 
```

The reason is that you will avoid some troubles with a shared reference to the new default attributes between your different instances of the `MyModel` object

To make it clearer, if your default attributes contains array and if you instantiate your `MyModel` more than once, the attributes which contains the array will be shared between each instances. Using a function to declare your default attributes will avoid it.

I hope I'm clear enough.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-05T12:40:26.820

You can also use ES6 destructuring

```
const MyParentModel = Backbone.Model.extend({
  defaults: {
    parent1 : '',
    parent2 : ''
  }
});

const MyModel = MyParentModel.extend({
  defaults: {
    child1: '',
    child2: '',
    ...MyParentModel.prototype.defaults
  }
}); 
```

# php - 开放基础目录跨域

> ID：11261284
> 
> 赞同：0
> 
> 时间：2012-06-29T11:52:21.470
> 
> 标签：php, iis, include, fastcgi, open-basedir

只需`open_basedir`将指令设置为：

`C:\Inetpub\vhosts\domain.net\subdomains\beta\httpdocs\;C:\Inetpub\vhosts\domain.net\httpdocs\`

但是，当我尝试从一个主机名到另一个主机名时，打开的基本目录不起作用。这是我正在设置的：

`C:\Inetpub\vhosts\domainOne.net\httpdocs\;C:\Inetpub\vhosts\domainTwo.net\httpdocs\`

我知道使用 FastCGI 和 PHP 实现这一点非常具有挑战性，但肯定有一个简单的解决方法吗？

我曾尝试在其他站点文件夹上向当前站点的用户授予权限，但这没有奏效。

返回的错误（如预期）如下：

> 警告：include(): open_basedir 限制生效。文件（C:\Inetpub\vhosts\domainOne.net\httpdocs_snippets_global\paths.php）不在允许的路径内：（C:\Inetpub\vhosts\domainTwo.com\httpdocs\;C:\Inetpub\vhosts \domainOne.net\httpdocs）在 C:\Inetpub\vhosts\domainTwo.com\httpdocs\index.php 第 3 行警告：包括（C:\Inetpub\vhosts\domainOne.net\httpdocs_snippets_global\paths.php）：失败打开流：第 3 行的 C:\Inetpub\vhosts\domainTwo.com\httpdocs\index.php 中不允许操作

**所以我的问题是，如何在运行 IIS 7、Plesk 11 和 PHP 5.3 作为 FastCGI 应用程序运行的 Windows Server 上打开跨域的基本目录？**

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:27:26.273

所有排序，开放的基本目录设置确实是正确的。

我在为用户添加权限方面是正确的，我只是添加了错误的用户！

**很简单，如果您遇到这种情况，假设这是您遇到的问题，只需确保相关网站的用户也对包含目录的文件夹和文件具有权限。**

# coldfusion - CFBuilder 2插入结束标签不起作用

> ID：11261287
> 
> 赞同：6
> 
> 时间：2012-06-29T11:52:38.833
> 
> 标签：coldfusion, coldfusionbuilder

我正在使用 CFBuilder 2（免费版），插入结束标签功能似乎不起作用。

这是我的设置：- ![](../Images/46aad09a88ebc403adb5b638d0218a1f.png)

现在，如果我输入一个新的开始标签，例如`<cfscript>`我永远不会得到结束标签。我是否误解了它应该做什么或者我应该改变一些其他设置？

这在 cfeclipse 中运行良好，因此非常令人沮丧。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T12:19:53.387

检查“打字”偏好页面。有一个设置叫做：“自动关闭标签”。您可能已将此设置为“从不”。尝试将其设置为“输入开始标签的'>'时”。见附图：

![示例](../Images/db6193bddbc744f7d6360087fe9be626.png)

# jquery - jQuery Slider 不停歇

> ID：11261290
> 
> 赞同：1
> 
> 时间：2012-06-29T11:52:55.173
> 
> 标签：jquery, css

我正在使用切片图像制作一个 jQuery 滑块，看起来像一个 looong 滑动横幅：

**示例：http: [//jsfiddle.net/pG8kt/66/](http://jsfiddle.net/pG8kt/66/)**

我遇到的两个问题：

1) 序列中的第三张图片加载太晚

2）它在幻灯片之间停止 - 但我也不想要它

任何想法为什么？谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T11:58:36.370

[http://jsfiddle.net/pG8kt/76/](http://jsfiddle.net/pG8kt/76/)

```
var showing = 0, // current img
    imgs = [], // all imgs
    $img = $("#gallery img"), // jQuery DOM object
    imgWidth = $img.outerWidth(), // img width assuming every img has same
    $slider = $("#slider"),
    $title = $("#title");

imgs = $img.toArray();
  // Variable to store number of images
var numberOf = imgs.length;
  // set slider width so floated elements line up
$slider.width(numberOf*imgWidth);

  // Recursive next image function
var nextImage = function() {
    var $nextImg = $(imgs[showing++ % numberOf]);
      // Add next image (only use increment once!)
    $slider.append($nextImg);
      // Show image title
    $title
        .html($nextImg.attr("title"))
        .attr("href", $nextImg.attr("src"));        
      // Animate the slider
    $slider.animate({
        left: '-='+imgWidth
    }, 8000, 'linear', function() {
          // Reset CSS
        $slider.css("left", 0);            
          // Call animationg function again
        nextImage();
    });  
}        
  // Call next image for the first time
nextImage(); 
```

更新了所有东西......

# c# - 在 msxsl 标记内的外部文件中引用 C# 代码

> ID：11261294
> 
> 赞同：4
> 
> 时间：2012-06-29T11:53:21.133
> 
> 标签：c#, xslt, msxsl

我正在使用一个由许多复杂的 XSL 转换组成的系统，每个转换都适用于大型 XML 文件。在将 XML 文件传递​​到我们的数据库之前，专有程序会在每个 XML 文件上编译 XSLT。

XSL 转换几乎总是涉及`<msxsl>`标签中的 C# 函数，其中许多在多个文件之间重复，代码是手动复制的。我正在尝试实现一个系统，其中函数的通用存储库存储在一个文件中，然后在被`<msxsl>`标签读取之前加载到 XSLT 文件中。

我的问题是我一直无法找到`<msxsl>`从外部文件加载代码的方法。这是我的意思的一个例子：

带有硬编码函数的变换：

```
...

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
            xmlns:msxsl="urn:schemas-microsoft-com:xslt"
            xmlns:cs="urn:my-scripts-csharp">

...

<msxsl:script language="C#" implements-prefix="cs">
  <![CDATA[
    public string emphasise(string input) {
      return input+"!";
    }
  ]]>
</msxsl:script>

... 
```

虽然我希望从外部加载函数：

```
...

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
            xmlns:msxsl="urn:schemas-microsoft-com:xslt"
            xmlns:cs="urn:my-scripts-csharp">
...

<msxsl:script language="C#" implements-prefix="cs">
  <--- file loaded here --->
</msxsl:script>

... 
```

源文件类似于：

```
<![CDATA[
  public string emphasise(string input) {
    return input+"!";
  }
]]> 
```

这可能吗？这些函数通常很复杂（与此示例不同）并且无法使用 XSLT 代码重现。是否会读取外部文件中的关键字，还是必须将它们与标签一起包含在外部文件`namespace`中？`using``<msxsl:using>`

我对`<msxsl>`标签的使用很陌生，如果我误解了一些基本的东西，请告诉我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T12:40:24.527

**I. Here is how to do it**:

> File: C:\temp\delete\c#script.xsl

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:msxsl="urn:schemas-microsoft-com:xslt"
 xmlns:cs="urn:my-scripts-csharp">  
    <msxsl:script language="C#" implements-prefix="cs">
    <![CDATA[
     public string emphasise(string input)
     {
      return input+"!";
      }
      ]]></msxsl:script>
</xsl:stylesheet> 
```

**Your transformation**:

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:msxsl="urn:schemas-microsoft-com:xslt"
 xmlns:cs="urn:my-scripts-csharp">

 <xsl:include href="C:\temp\delete\c#script.xsl"/>

 <xsl:template match="/">
  <xsl:value-of select="cs:emphasise('Hello')"/>
 </xsl:template>
</xsl:stylesheet> 
```

**When this transformation is performed (on any XML document), the wanted result is produced:**

```
Hello! 
```

**Warning**: Using inline scripts like these is known to cause memory fragmentation if the transformation is repeated many times and this can lead to memory leaks.

**I strongly recommend *not* to use inline scripts at all**. A better, more efficient and safe approach is to have all necessary extension functions in an extension object -- read about the **[`XsltArgumentList`](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xsltargumentlist.aspx)** class and its **[`AddExtensionObject()`](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xsltargumentlist.addextensionobject.aspx)** method.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T12:35:38.397

您可以使用以下方式引用外部程序集中的代码：http: [//msdn.microsoft.com/en-us/library/ms256188.aspx](http://msdn.microsoft.com/en-us/library/ms256188.aspx) - 这可以提供一种将代码移动到外部位置的方法

# javascript - 删除数组中的重复项，为什么此代码不起作用

> ID：11261296
> 
> 赞同：-6
> 
> 时间：2012-06-29T11:53:25.027
> 
> 标签：javascript

嗨我写了下面的代码

```
function unique(th){
   var obj = {};
   for(var i = 0, n = th.length; i < n ; i++){
       obj[th[i]] = th[i];
   }    
   obj.length = n ;
   return Array.prototype.slice.call(obj);
} 
```

但是，这给了我不需要的输出。请帮我纠正这个问题。[这](http://jsfiddle.net/NSjnY/)是小提琴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:54:58.337

我不知道你的逻辑是什么，所以我构建了一个稍微不同的工作函数，试图让它尽可能清晰：

```
function unique(th){
   var yetseen = {};
   var newarray = [];
   for(var i = 0, n = th.length;  i < n ; i++){
       var val = th[i];
       if (!yetseen[val]) {
           yetseen[val] = true;
           newarray.push(val);
       }
   }    
   return newarray;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:13:22.867

# 使用[Underscore.js](http://underscorejs.org/)

它是一个包含大量用于操作数组的函数的库。

## [_.uniq](http://underscorejs.org/#uniq)

> _.uniq(array, [isSorted], [iterator]) 别名：unique 生成数组的无重复版本，使用 === 来测试对象是否相等。如果您事先知道数组已排序，则为 isSorted 传递 true 将运行更快的算法。如果要基于转换计算唯一项，请传递迭代器函数。

## [例子](http://jsfiddle.net/mJ73d/)

`alert(_.uniq([2,2,1,4,5,6,2,9,1,1,6,3,2,1,9,6,4], false)​);​ //yields 2,1,4,5,6,9,3`

# c# - GetWeekOfYear 与实体框架

> ID：11261297
> 
> 赞同：4
> 
> 时间：2012-06-29T11:53:30.973
> 
> 标签：c#, asp.net, entity-framework

我的表中有一个名为 的列，`Date`我需要将此日期`WeekOfTheYear`与`DateTime.Now`'s进行比较`WeekOfTheYear`，

如果我这样付出，

```
var cal = CultureInfo.CurrentCulture.Calendar;

int week = cal.GetWeekOfYear(DateTime.Now, CalendarWeekRule.FirstDay, DayOfWeek.Sunday); 
```

我要`26`到这里了。同样，在我的实体框架中，我需要比较本周的数据，为此我尝试过，

```
entities.WorkingDays.Where(a => 
             cal.GetWeekOfYear(a.DATE,CalendarWeekRule.FirstDay,DayOfWeek.Sunday)
             == cal.GetWeekOfYear(DateTime.Now, CalendarWeekRule.FirstDay,
                                                 DayOfWeek.Sunday) 
```

当我像这样运行查询时，出现类似错误，

> “LINQ to Entities 无法识别方法 'Int32 GetWeekOfYear (System.DateTime, System.Globalization.CalendarWeekRule, System.DayOfWeek)' 方法，并且此方法无法转换为存储表达式。”

我如何在这里获取每周的数据，任何人都可以在这里帮助我....提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:06:14.527

首先调用 .ToList()。像这样：

```
entities.WorkingDays.ToList().Where(a => 
             cal.GetWeekOfYear(a.DATE,CalendarWeekRule.FirstDay,DayOfWeek.Sunday)
             == cal.GetWeekOfYear(DateTime.Now, CalendarWeekRule.FirstDay,
                                                 DayOfWeek.Sunday) 
```

有关重复问题，请参阅[此](https://stackoverflow.com/questions/3316615/linq-to-entities-does-not-recognize-the-method-int32)帖子。基本上，在使用 GetWeekOfYear 函数之前，数据需要在内存中。

正如评论中所指出的，这确实将整个“WorkingDays”表带入内存，因此从数据库中获取的数据多于所需数据。有时这比使用存储过程更可取，有时则不是，这取决于基于您的应用程序/数据库架构的数据量和其他因素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T12:40:23.773

您可能可以使用一年中的某一天并将其除以 7 在两个实例上，并获得足够的结果？

```
Date.DayOfYear / 7 
```

# c# - LINQ - 获取最大数量以插入新记录

> ID：11261298
> 
> 赞同：0
> 
> 时间：2012-06-29T11:53:34.783
> 
> 标签：c#, .net, linq

我想我把自己绑在这个结上，我认为有更好的方法来做到这一点。

我使用 LINQ 向表中插入一条新记录，此时我输入的只是一个字段 Case_number，关键字段是一个自动生成的 int。

每条记录都包含一个区域编号以及案例编号，并且由于合并了多个数据库（不是我做的！）我可以拥有区域 1、case_no 1、case_no 2、区域 2 case_no 1、case_no2 等。

所以我需要做的是获得最大 case_no 区域 = 我传入的内容。这可以在一个公共空间中完成吗，比如（我知道这是不正确的）：

```
 ASB_DataDataContext iC = new ASB_DataDataContext();
    Input iInput = new Input();
    iInput.Case_No = Max of case no where area = 1
    iC.Inputs.InsertOnSubmit(iInput);
    iC.SubmitChanges(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:01:04.563

```
iInput.Case_No = iC.Inputs.Max(x => Case_No) 
```

并且

```
iInput.Case_No = iC.Inputs
                   .Where(area == 1)
                   .Max(x => x.Case_No) 
```

# objective-c - iPhone：图像水平画廊

> ID：11261302
> 
> 赞同：0
> 
> 时间：2012-06-29T11:54:10.710
> 
> 标签：objective-c, ios4, uiscrollview, uiimage

我正在尝试在填充真实数据之前创建示例库。

```
 float xAxis = 0;
    float mostHeight = self.galleryView.bounds.size.height;
    for (int i = 0; i < 5; i++) {

        //getImage from url
        UIImage* myImage = [UIImage imageWithData: 
                            [NSData dataWithContentsOfURL: 
                             [NSURL URLWithString: @"http://4.bp.blogspot.com/-M9k3fhlUwmE/TdYgxL97xMI/AAAAAAAAAY8/_r45zbAm1p0/s1600/CARTOON_Cat-full.jpg"]]];
        myImage = [[MyMath sharedMySingleton] imageWithImage:myImage convertToSize:CGSizeMake(mostHeight - 10, mostHeight - 10)];
        //set image
        UIImageView *rview= [[UIImageView alloc] initWithImage:myImage];
        /*adding the view to your scrollview*/
        [self.galleryView addSubview:rview];
        xAxis += myImage.size.width + 20;
    }
    //set scrolling area
    self.galleryView.contentSize = CGSizeMake(xAxis, mostHeight); 
```

galleryView 是来自 xib 的 UIScrollView。在这里，我试图将 5 张相同的图片填充到图库，但它只填充了一张和之后的空格（因为 xAxis 编号）。我做错了什么？

PS我是iPhone sdk的新手，所以不要评判我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:55:40.207

你从来没有为`UIImageView`. 您需要将( ) 的`x`坐标偏移图像视图的宽度 + 填充。`origin``frame``frame.origin.x`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T11:55:46.000

您忘记使用 xAxis 的 x-Offset 为您的 imageView 设置框架。

# android - 看不到我的 AsyncTask 启动和服务

> ID：11261303
> 
> 赞同：0
> 
> 时间：2012-06-29T11:54:13.507
> 
> 标签：android, service, android-asynctask

我写了一些代码来启动服务 `AsyncTask`，我可以在调试模式下看到服务已启动。

在后台启动服务的代码`AsyncTask`如下，

```
protected String doInBackground(String... params) {
//starts service number activite
MyResultReceiver resultReceiver = new MyResultReceiver(null);
Intent  intent = new Intent(context, MyService.class);
intent.putExtra("receiver", resultReceiver);
context.startService(intent); 
```

服务是：

```
 public class MyService extends Service{

    ResultReceiver resultReceiver;

       @Override
     public int onStartCommand(Intent intent, int flags, int startId) {

       //resultReceiver = intent.getParcelableExtra("receiver");

        resultReceiver = intent.getParcelableExtra("receiver");
        Bundle data = new Bundle();
          data.putString("key",getActivityUrl() );
       resultReceiver.send(2, data);

       resultReceiver.send(2,null);
     return START_STICKY;
     }

        @Override
          public IBinder onBind(Intent intent) {
          return null;
             }

     public String getActivityUrl() {
   String str = null;   
       try{

URL url = null;
        try {
            url = new URL("http://www.google.com");
        } catch (MalformedURLException ex) {
            Logger.getLogger(MyService.class.getName()).log(Level.SEVERE, null, ex);
        }

        // Read all the text returned by the server
        BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));

        while ((str = in.readLine()) != null) {
            // str is one line of text; readLine() strips the newline character(s)
        }
                //all is ok

        in.close();

     }       catch (IOException ex) {
        Logger.getLogger(MyService.class.getName()).log(Level.SEVERE, null, ex);
    }finally{ stopSelf();
     }

    //resultReceiver.send(100,null);

    return str;
} 
```

}

另一个问题：我怎样才能发送一个 String 而不仅仅是一个 int with `resultReceiver.send`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:07:33.287

> 如何使用 resultReceiver.send 发送字符串而不仅仅是 int？

只需创建`Bundle`并放入`String`.

```
Bundle data = new Bundle();
data.putString("key", data);
resultReceiver.send(2, someData); 
```

**注意：**只有确定，方法的第一个参数`send()`想象**方法**的结果代码`onReceiveResult`。

# maven - 部署到 Nexus

> ID：11261304
> 
> 赞同：1
> 
> 时间：2012-06-29T11:54:13.890
> 
> 标签：maven, deployment, nexus

我正在尝试将工件部署到 nexus。当我尝试使用本地机器时，它运行良好。但是当我通过在另一台机器上安装 nexus 来尝试相同的设置时。它正在抛出错误。

![在此处输入图像描述](../Images/fb5710f10d4b43d09268253d432dae2b.png)

我已经 `<server> with <id>, <username> and <password>`在 settings.xml中配置了，`<id>`在 pom.xml 中也提到了相同的内容。

Nexus 机器接受 80 和 8080 端口。我需要启用任何其他端口吗？我重置了部署用户密码并在 settings.xml 中使用了相同的密码。请帮助我如何解决这个问题。谢谢。

编辑：这是我第一次尝试设置和部署 Nexus。我可以从 Nexus 下载依赖项。唯一的问题是我无法部署

设置.xml

```
<servers>
    <server>
      <id>releases</id>
      <username>deployment</username>
      <password>deployment</password>
    </server>
     <server>
      <id>snapshots</id>
      <username>deployment</username>
      <password>deployment</password>
    </server>
  </servers> 
```

pom.xml

```
<distributionManagement>

                     <repository>
                       <id>releases</id>
                       <name>releases</name>
                       <url>http://ie22dtvm60013:8080/nexus/content/repositories/releases/</url>
                     </repository>

                     <snapshotRepository>
                       <id>snapshots</id>
                       <name>Internal Snapshots</name>
                       <url>http://ie22dtvm60013:8080/nexus/content/repositories/snapshots/</url>
                     </snapshotRepository>
</distributionManagement> 
```

我检查了 Nexus 中的“系统提要”，它显示“部署”用户已通过身份验证。但我仍然无法部署。 ![在此处输入图像描述](../Images/147c13368d4a967e6d5b1543c7ae9582.png)

![在此处输入图像描述](../Images/f12a5397d0dc41306f895cc1af62609e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T04:42:50.930

问题可能是 ipv6 已激活。如果路由器提供，Maven 使用 ipv6，但通常网络尚未完全配置为使用它。

尝试为部署命令的 Maven 调用设置 -Djava.net.preferIPv4Stack=true。

# visual-studio-2010 - Nuget - 在构建期间看不到允许 nuget 下载丢失的包

> ID：11261310
> 
> 赞同：62
> 
> 时间：2012-06-29T11:54:40.553
> 
> 标签：visual-studio-2010, visual-studio, nuget

我收到一条消息，内容如下：

> 错误 1 ​​默认情况下禁用包还原。要给予同意，请打开 Visual Studio 选项对话框，单击包管理器节点并选中“允许 NuGet 在构建期间下载丢失的包”。您还可以通过将环境变量“EnableNuGetPackageRestore”设置为“true”来表示同意。

当我转到工具 -> 选项时，我看不到包管理器，在下面我看到包源和最近的包。我没有看到任何地方可以设置允许 Nuget 在构建期间下载丢失的包。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-06-29T15:23:20.033

NuGet 包管理器 1.8 中添加了在 UI 中给予同意的选项。它是工具-> 选项-> 包管理器-> 常规下的第三项：“包还原：允许 NuGet 在构建期间下载丢失的包”。

请确保 NuGet 在工具->扩展管理器中是最新的。

`EnableNuGetPackageRestore`或者，您可以通过将Environment 变量设置为 来表示同意`true`。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-08-07T13:49:11.800

我发现我需要额外的几个步骤来下载包

1.  选中允许 NuGet 在构建期间下载丢失的包

    ![](../Images/5e237ddf3afb591305e04e13b4c77940.png)

2.  选中始终在项目和解决方案中显示解决方案

    ![](../Images/ada1905b1290844ff747b79e1242b97d.png)

3.  右键单击解决方案并启用 NuGet 包还原

    ![](../Images/ced58aa47ed3641c56dc0e25e112dd72.png)

4.  打开管理 NuGet 包并单击还原

    ![](../Images/a0d79f765ae3650cac77a7a3181e5a6a.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-10T09:18:31.307

我似乎没有工具->选项下的“包管理器”节点[这是在 Visual Studio 2013 中:-)]。为了获得该节点，我浏览到工具 -> 扩展和更新并搜索 nuget。安装“NuGet for Visual Studio 2013”​​让我获得了节点和允许包还原的选项！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-17T15:21:55.960

我正在使用 Visual Studio 2010 和 NuGet 2.0。

有人签入了一个将 NuGet 用于各种包的解决方案。当我检查解决方案并构建它时，我得到了同样的错误。更重要的是，当我从“工具”->“选项”窗口查看 NuGet 包管理器时，“包还原”已经选中了相应的复选框。

我尝试单击清除包缓存按钮。之后，一切都正确构建。

![在此处输入图像描述](../Images/46c07b68b6cd28537e16e35146138c6c.png)

# java - 双重检查锁定 - 它在地球上的 Java 中有效吗？

> ID：11261320
> 
> 赞同：0
> 
> 时间：2012-06-29T11:55:27.383
> 
> 标签：java, multithreading, singleton

全部：

这是著名的文章：

[“双重检查锁定被破坏”声明](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)

它声明该模式在 Java 中不起作用。它进一步说，接近尾声，新的 JVM 可以通过使用 volatile 使该模式工作。

但是，在另一篇文章中：[Memory Barriers and JVM Concurrency](http://www.infoq.com/articles/memory_barriers_jvm_concurrency)

它说关键字“同步”会生成内存屏障完整围栏。那么谁是对的呢？该模式在地球上的 Java 中是否有效？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:23:32.927

基本上有 3 种方法可以修复双重检查锁定：

*   确保变量被声明为**volatile**（从 Java 5 开始工作）；

*   只是一开始**就不要理会它**：只需使用同步，不要试图用花哨的容易出错的——而且可能毫无意义的——“避免”它的手段来搞乱；

*   让**类加载器**为你做同步。

我在[这里发布了示例代码](http://www.javamex.com/tutorials/double_checked_locking_fixing.shtml)。

**但是：**双重检查锁定确实是一种过时的范例，如果它确实在 Java 中有用的话。正如我所看到的，它基本上是由 C 程序员转入 Java 的，他们没有完全意识到 JVM 有效地有一种更有效（和正确！）的方式来处理内置于类加载器中的问题，并且对同步的优化是通常最好在 JVM 级别制作。

我见过很多人用这种“模式”弄乱他们的代码。我认为我从未见过任何实际数据表明它有任何好处。

另外：如果您确实有一个遇到同步问题的大型应用程序，那么 Java 存在的全部*理由*之一就是它具有丰富的并发库。看看如何重新设计应用程序以使用它们……如果分析数据证明它是必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T11:59:30.070

这取决于您使用的 java 版本。这已在 java 5 及更高版本中修复。

检查[http://en.wikipedia.org/wiki/Double-checked_locking#Usage_in_Java](http://en.wikipedia.org/wiki/Double-checked_locking#Usage_in_Java)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T21:02:53.390

他们都是对的，并且 DCL 从 Java 5 开始就可以正常工作。

如果您希望您的程序在给定完全相同的输入的情况下每次都产生完全相同的输出，并且您正在使用 DCL，那么您可能需要认真重新考虑您在做什么。很多事情取决于谁先拿到锁——你掷了很多骰子。不适合会计应用程序。

如果您的程序涉及球在墙壁和彼此之间反弹，那么 DCL 可能很有意义。它确实有效。即使没有争用，同步也必须比非同步慢一点，那么如果一个简单的`if`可以阻止它，为什么要这样做呢？如果在需要的对象已经存在时有 100 个线程堆积在一个同步语句上，那肯定会慢很多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-16T07:46:30.823

生成内存屏障全栅栏的关键字“同步”并不意味着 DCL 可以正常工作。我们以下面的代码为例：

```
public static Runnable getInstance()
    {
        if (null == instance)    //1
        {
            synchronized (Runnable.class)
            {
                if (null == instance)
                {
                    instance = new Runnable(); //2
                }
            }
        }

        return instance;
    } 
```

我们知道 JVM 在构造对象时会遵循很多步骤。我们在这里关注两个重要步骤：首先，JVM malloc 为这个对象分配内存。此对象中的成员变量的值现在具有默认值。其次，JVM调用方法并将用户指定的值分配给成员变量。

这意味着线程 A 可能会在代码 1 中（在代码 1 和代码 2 的中间）获得一个部分构造的实例。虽然“synchronized”会生成内存屏障全栅栏，但在代码 1 和代码 2 中没有[发生之前的](https://docs.oracle.com/javase/specs/jls/se9/jls9.pdf)保证。内存屏障栅栏在同步代码块期间生效。代码 1 在同步代码块之外。

# r - 在 R 中聚合数据

> ID：11261325
> 
> 赞同：5
> 
> 时间：2012-06-29T11:55:49.757
> 
> 标签：r, aggregate

我正在寻找一个关于如何`aggregate`在 R 中使用和计算均值的简单示例。

说，我有以下数据框：

```
A      B
100    85
200    95
300    110
400    105 
```

我想用以下结果计算某些范围的平均值：

```
RANGE         MEAN
100-200       90
300-400       107.5 
```

我将如何去做，`cast()`或者`aggregate()`？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-29T12:10:12.353

假设您的数据框名为“x”：

```
aggregate(x$B, list(cut(x$A, breaks=c(0, 200, 400))), mean)
#     Group.1     x
# 1   (0,200]  90.0
# 2 (200,400] 107.5 
```

* * *

使用“data.table”，您可以执行以下操作：

```
library(data.table)
as.data.table(x)[, .(RANGE = mean(B)), by = .(MEAN = cut(A, c(0, 200, 400)))]
#         MEAN RANGE
# 1:   (0,200]  90.0
# 2: (200,400] 107.5 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T12:07:01.403

这是一个基本的`aggregate`用法示例。

```
> foo = data.frame(A=c(100,200,300,400),B=c(85,95,110,105))
> aggregate(foo$B,by=list(foo$A<250),FUN=mean)
  Group.1     B
1   FALSE 107.5
2    TRUE  90.0
> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T12:11:34.233

或与`cut`and相同`tapply`

```
 foo <- data.frame(A=c(100,200,300,400),B=c(85,95,110,105))
 tapply(foo$B, cut(foo$A, breaks=seq(0, 400, 200)), mean)
  (0,200] (200,400] 
     90.0     107.5 
```

# c# - C# 泛型没有按预期工作

> ID：11261343
> 
> 赞同：2
> 
> 时间：2012-06-29T11:56:49.727
> 
> 标签：c#, generics

我们在使用泛型时遇到了问题。我们有一个通用键值对的通用集合，其定义如下

```
public class KeyValueTemplate<K, V> : IGetIdentifier<K>
{
//...
}

public class KeyValueListTemplate<K, V> : ObservableCollection<KeyValueTemplate<K, V>>
{
//....
}

public class KeyValueStringListTemplate : KeyValueListTemplate<string,string> { } 
```

我们在代码中使用它如下

```
public class test
{

   public KeyValueStringListTemplate SetValuesList{get;set;}
   public ObservableCollection<IGetIdentifier<string>> GetList()
   {
     return SetValuesList;
   }

} 
```

编译器不接受这一点。错误是

```
Cannot convert type 'KeyValueStringListTemplate' to 'System.Collections.ObjectModel.ObservableCollection<IGetIdentifier<string>> 
```

为什么？？这两种类型对我来说都是一样的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:01:37.223

这条线

```
public class KeyValueListTemplate<K, V> : ObservableCollection<KeyValueTemplate<K, V>> 
```

定义了一个新类型，`KeyValueListTemplate`即 的子类型`ObservableCollection`，因此它们是*不同的类型*。`KeyValueListTemplate`可以安全地转换为`ObservableCollection`，因为它具有`ObservableCollection`'s 功能的超集（根据 Liskov 替换原则），但相反的转换是不安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:13:30.207

它是[泛型中的协方差](http://msdn.microsoft.com/en-us/library/ee207183.aspx)问题，在 .net 4 之前没有暴露给 c#/vb.net。
虽然你可以这样做似乎微不足道：

```
IEnumerable<string> strings = new List<string>();
// An object that is instantiated with a more derived type argument 
// is assigned to an object instantiated with a less derived type argument. 
// Assignment compatibility is preserved. 
IEnumerable<object> objects = strings; 
```

这是您的代码在底线所做的事情，它不支持.net 4
我链接到的文章解释了如何实现它以及它是如何工作的。

# eclipse - 核心修改

> ID：11261349
> 
> 赞同：1
> 
> 时间：2012-06-29T11:57:19.227
> 
> 标签：eclipse, eclipse-emf

我有一个 Ecore 模型保存到文件中。我想要做的是修改 Ecore 模型（添加元素、超类型、属性、删除属性......）

但我不想手工做，我想要一个脚本/M2M 转换。

你会使用什么语言，工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T07:26:34.033

您想要的是将您的 Ecore 模型转换为另一个 Ecore 模型。您应该看看[Eclipse Foundation](http://www.eclipse.org/projects/project.php?id=modeling.mmt)的模型转换项目。我会在这些项目中推荐[ATL](http://www.eclipse.org/atl/)，因为它很容易满足您的需求（您似乎不需要非常复杂的转换）。如果您需要一个非常简单的转换，我建议您直接在 Java 中进行，因为它可能更容易将它集成到您​​的工作流程中。

全面披露：我在为 ATL 做出贡献的公司之一工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T10:02:37.967

由于您正在编写模型到模型的转换，因此您应该使用 Java，因为在您需要的各种导航、迭代和细粒度访问方面，没有什么比 Java 更好的了。但是，如果您想从模型生成代码，我建议您使用其中一种模板语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T08:52:24.487

请问你能更准确吗？

我知道你想修改你的源模型，但是我想你想根据一些规则来做。真的吗？你能举例说明这些规则吗？

也就是说，我建议您从[Epsilon](http://www.eclipse.org/epsilon/)开始。它是一种强大的语言，允许您定义各种模型到模型和模型到文本的转换。

# asp.net - Request.ServerVariables["LOCAL_ADDR"] 返回 "::1"

> ID：11261350
> 
> 赞同：4
> 
> 时间：2012-06-29T11:57:28.057
> 
> 标签：asp.net

我需要获取服务器的 IP 地址，以便可以将其与键/值字符串集合一起发送到支付网关提供商。

我正在运行 localhost，并且`Request.ServerVariables["LOCAL_ADDR"]`正在返回`::1`

我收到的验证错误是从 Sage Pay 返回的：

> ClientIPAddress 格式无效。不应包含前导零，并且仅包含 0 到 255 范围内的值。

为什么会这样，以及如何获取要发送的有效 IP 地址？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T11:59:07.990

在本地网络适配器上禁用 IPv6。::1 表示 IPv6 中的“本地主机”。然后你会得到正常的 IPv4 127.0.0.1

无论如何 ::1 是一个 *VALID* IP 地址..

更多关于 LOCALHOST 定义：[http ://en.wikipedia.org/wiki/Localhost](http://en.wikipedia.org/wiki/Localhost)

> 对于**IPv4**通信，计算机系统的虚拟环回接口通常分配有地址**127.0.0.1**，子网掩码为 255.0.0.0。根据使用的特定操作系统（特别是在 Linux 和 Microsoft Windows 中）和安装的路由机制，这会在本地系统的路由表中填充一个条目，以便发往 127.0.0.0/8 块中任何地址的数据包将内部路由到网络环回设备。
> 
> 另一方面，在**IPv6中，环回路由前缀 ::1/128 仅包含一个地址****::1**（完整表示为 0:0:0:0:0:0:0:1，地址为最低有效位，否则为零）被明确定义为环回地址，[6] 尽管主机管理员可以根据需要将其他地址分配给环回接口。

# php - Internet Explorer 不适用于基于 php 生成的选择选项值的 JavaScript 函数

> ID：11261351
> 
> 赞同：1
> 
> 时间：2012-06-29T11:57:29.970
> 
> 标签：php, javascript, jquery, internet-explorer, select

我有一个基于 php 生成的选择选项值的 JavaScript 函数的 Internet Explorer 问题。我搜索了一下，我认为问题与那些相似

[在IE中设置选择框的innerHtml](https://stackoverflow.com/questions/6121507/problem-with-setting-innerhtml-of-a-selection-box-in-ie)

[Internet Explorer 未在链选择上显示 <option> 值](https://stackoverflow.com/questions/11062269/internet-explorer-not-showing-option-value-on-chain-select)。

我根据这些解决方案尝试了不同的方法，但没有成功。我的应用程序是这样工作的：

*   我的 HTML 文件中有一个嵌套选择：

    ```
    <div id="selectCountry" class="infobox_map">
        <p align="center"><b>Selection relating to Country:</b></p>
        <div id="country-navigation">
            <select id="first-choice" size="1" style="width: 234px" onclick="zoomToCountry(value); fillCountryInfo(value)"> 
                <option selected value="base">Choose a Country</option>
                <option value="Bolivia">Bolivia</option>
                <option value="India">India</option>
                <option value="Switzerland">Switzerland</option>            
                <option value="Tanzania">United Republic of Tanzania</option>
            </select>   
        </div>
        <div id="project_navigation">                 
            <select id="second-choice" size="1" style="width: 234px" onclick="zoomToProject(value)">
                <option selected value="base">Select a project</option>
                <option>Projects</option>
            </select>                   
        </div>  
    </div> 
    ```

关联的 JavaScript 函数如下所示：

```
 $(function() {

        $("#first-choice").change(function() {
            $("#factbook").load("factbook.php?choice=" + $("#first-choice").val());
            $("#second-choice").load("select_country.php?choice=" + $("#first-choice").val());
        });

        $("#first-choice-proj").change(function() {
            $("#second-choice-proj").load("select_project.php?choice_proj=" + $("#first-choice-proj").val());
        });         
    }); 
```

所以我有两个选择。当第一个选择（国家）完成后，我使用 PHP 连接到数据库并生成第二个选择（项目）。这工作正常，但另一个 JavaScript 函数（“zoomToProject()”）使用生成的值

```
<select id="second-choice" size="1" style="width: 234px" onclick="zoomToProject(value)"> 
```

不工作！该应用程序在 Firefox、Chrome 和 IE 9 中运行良好，但 IE 8 失败，因为该函数没有获得所需的参数“值”。

有没有人对此有建议或想法？

干杯，D. Stroeer

好的，感谢您的快速回复！我正在使用 jquery-1.3.2。这是“zoomToProject()”函数的代码：

```
function zoomToProject(value) {
xval = wfs_climate.getFeaturesByAttribute('name', value);
yval = wfs_climate.getFeaturesByAttribute('name', value);   
xcoord = xval[0].geometry.x;
ycoord = yval[0].geometry.y;        
map.setCenter(new OpenLayers.LonLat(xcoord,ycoord), 10); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T20:01:48.787

我知道您想使用 load 函数，但是将 ajax 与 json 一起使用是我的动态，如下所示：

索引.html：

```
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Populating select box with ajax data</title>
    <script
      src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js">
    </script>
    <script>
      $(function()
      {
        $.get('get_country_codes.php', function(codes)
        {
          var select = $('#country_codes');

          for (var i = 0; i < codes.length; i++)
          {
            var code = codes[i];
            var option = $('<option/>');

            option.val(code.id);
            option.text(code.text);

            select.append(option);
          }
        }, 'json');
      });
    </script>
  </head>
  <body>
    <select id="country_codes"></select>  
  </body>
</html> 
```

get_country_codes.php：

```
<?
    $arr = array();

    $obj = new StdClass();
    $obj->id = 213;
    $obj->text = "Algeria";
    $arr[] = $obj;

    $obj = new StdClass();
    $obj->id = 46;
    $obj->text = "Sweden";
    $arr[] = $obj;

    echo json_encode($arr);
?> 
```

也许你的问题会随着这样的解决方案而消失。

# ruby-on-rails-3 - has_many :through 导致错误：HasManyThroughSourceAssociationMacroError

> ID：11261353
> 
> 赞同：3
> 
> 时间：2012-06-29T11:57:34.640
> 
> 标签：ruby-on-rails-3, associations

我需要将学生（用户）分配给班级（studentclasses）

我使用 3 个表有一个简单的多对多关系：

**学生班**（课程详情）

**用户** （用户...学生信息）

**studentclass_users**（包含**user_id**和**studentclass_id**的联接表）

我正在使用 has_many :through，我的模型如下所示：

**学生类.rb**

```
class Studentclass < ActiveRecord::Base
  has_many :studentclass_users
  has_many :users, :through => :studentclass_users
end 
```

**用户.rb**

```
class User < ActiveRecord::Base

    ...more here...

    has_many :studentclass_users
    has_many :studentclasses, :through => :studentclass_users
end 
```

**studentclass_users.rb**

```
class StudentclassUsers < ActiveRecord::Base
  belongs_to :studentclass
  belongs_to :user
end 
```

出于测试目的，我只是在我的学生类新视图中使用了一个隐藏字段，以在创建类时添加用户 ID，如下所示：

**_new.html.erb**

```
<%= hidden_field_tag "studentclass[user_ids][]", 29%> 
```

在我的学生类控制器中：

**studentclasses_controller.rb**

```
def new
  @studentclass = Studentclass.new
end 

def create
  @studentclass = Studentclass.new(params[:studentclass])
  @studentclass.save!
end 
```

我的参数回来了：

> 参数：{"utf8"=>"✓", "authenticity_token"=>"MjBTf4rtcyo8inADrSxPZB3vLOKtlZRVFlQJJzfCqWs=", "studentclass"=>{"class_title"=>"hjhkj", "user_ids"=>["29"]}, "提交"=>"保存"}

这看起来不错，但我收到以下错误：

> NameError（未初始化的常量 ActiveRecord::HasManyThroughSourceAssociationMacroError）：

我认为这可能是简单的命名？任何帮助，将不胜感激

# android - pdfViewer 不加载 pdf 中的图像

> ID：11261355
> 
> 赞同：0
> 
> 时间：2012-06-29T11:57:37.213
> 
> 标签：android, pdf, cmyk

我的应用程序没有在 pdf 中加载图像，并且每次在 pdf 中加载包含图像的页面时都会出错。

这是 LogCat：

```
06-29 11:07:29.900: E/APV.PDFRenderer(468): image with unsupported colorspace ColorSpace[CMYK]
06-29 11:07:29.900: E/APV.PDFRenderer(468): java.lang.UnsupportedOperationException: image with unsupported colorspace ColorSpace[CMYK]
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at com.sun.pdfview.PDFImage.parseData(PDFImage.java:319)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at com.sun.pdfview.PDFImage.getImage(PDFImage.java:225)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at com.sun.pdfview.PDFRenderer.drawImage(PDFRenderer.java:374)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at com.sun.pdfview.PDFImageCmd.execute(PDFPage.java:654)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at com.sun.pdfview.PDFRenderer.iterate(PDFRenderer.java:674)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at com.sun.pdfview.BaseWatchable.run(BaseWatchable.java:101)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at com.sun.pdfview.BaseWatchable.execute(BaseWatchable.java:263)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at com.sun.pdfview.BaseWatchable.go(BaseWatchable.java:197)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at com.sun.pdfview.PDFPage.getImage(PDFPage.java:237)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at net.sf.andpdf.pdfviewer.PdfViewerActivity.showPage(PdfViewerActivity.java:790)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at net.sf.andpdf.pdfviewer.PdfViewerActivity.access$12(PdfViewerActivity.java:769)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at net.sf.andpdf.pdfviewer.PdfViewerActivity$3.run(PdfViewerActivity.java:259)
06-29 11:07:29.900: E/APV.PDFRenderer(468):     at java.lang.Thread.run(Thread.java:1096) 
```

这个代码：

第一个.java

```
package android.pdf.reader;

import java.io.File;
import java.io.FilenameFilter;

import net.sf.andpdf.pdfviewer.PdfViewerActivity;
import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.os.Environment;
import android.util.Log;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class First extends ListActivity {
    String LOGTAG="";
    String[] pdflist;
    File[] imagelist;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
//        setContentView(R.layout.main);

        File images = Environment.getExternalStorageDirectory();
        imagelist = images.listFiles(new FilenameFilter() {
            public boolean accept(File dir, String name) {
                return ((name.endsWith(".pdf")));
            }
        });
        pdflist = new String[imagelist.length];
        for (int i = 0; i < imagelist.length; i++) {
            Log.e(LOGTAG,imagelist[i].getName());
            pdflist[i] = imagelist[i].getName();
        }
        this.setListAdapter(new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_1, pdflist));
    }

    protected void onListItemClick(ListView l, View v, int position, long id) {
        super.onListItemClick(l, v, position, id);
        String path = imagelist[(int) id].getAbsolutePath();
        Log.d(LOGTAG,path);
        openPdfIntent(path);
    }

    private void openPdfIntent(String path) {
        try {
            final Intent intent = new Intent(First.this,Second.class);
            intent.putExtra(PdfViewerActivity.EXTRA_PDFFILENAME, path);
            startActivity(intent);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

二.java

```
package android.pdf.reader;

import net.sf.andpdf.pdfviewer.PdfViewerActivity;
import android.os.Bundle;

public class Second extends PdfViewerActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
    }

    public int getPreviousPageImageResource() {
        return R.drawable.left_arrow;
    }

    public int getNextPageImageResource() {
        return R.drawable.right_arrow;
    }

    public int getZoomInImageResource() {
        return R.drawable.zoom_in;
    }

    public int getZoomOutImageResource() {
        return R.drawable.zoom_out;
    }

    public int getPdfPasswordLayoutResource() {
        return R.layout.pdf_file_password;
    }

    public int getPdfPageNumberResource() {
        return R.layout.dialog_pagenumber;
    }

    public int getPdfPasswordEditField() {
        return R.id.etPassword;
    }

    public int getPdfPasswordOkButton() {
        return R.id.btOK;
    }

    public int getPdfPasswordExitButton() {
        return R.id.btExit;
    }

    public int getPdfPageNumberEditField() {
        return R.id.pagenum_edit;
    }
} 
```

显现

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="android.pdf.reader"
    android:versionCode="1"
    android:versionName="1.0" >

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".First"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".Second"
            android:label="@string/app_name" >
        </activity>
    </application>
    <uses-sdk android:minSdkVersion="8" />
</manifest> 
```

有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:21:02.347

PDF 文件中的图像采用 CMYK 格式，您正尝试以不同的颜色空间（可能是 RGB）读取它们。

您的日志说不支持 CMYK，但 pdfViewer 中有一个名为 CMYKColorSpace 的类，所以也许这会有所帮助。

如果您发布代码，我可能会为您提供更多帮助。

编辑：

我正在阅读的文档实际上是原始库 com.sun.pdfview （我的错！）

andpdf的[文档](http://andpdf.sourceforge.net/#Documentation)指出：

“该项目是来自 SUN 的使用 AWT 的 pdf-renderer 的一个端口。太糟糕了，Android 不支持 AWT，所以首先要做的是将 AWT-Objects 映射到 Android-Graphic-Objects”。

如果您点击链接，您将看到 Image 和 ColorSpace 尚未映射。所以 CMYK 还不支持。

# zend-framework - Zend：我应该从模块外访问哪个类/控制器？

> ID：11261357
> 
> 赞同：0
> 
> 时间：2012-06-29T11:57:45.697
> 
> 标签：zend-framework, module

我有一个正在运行的应用程序并添加了我的第一个模块。一切正常。现在我想在现有应用程序中使用我的模块。

我有以下文件夹：

```
application
- classes
- configs
- controllers
- ....
- modules
   - discount
     - configs
     - controllers
     - layouts
     - models
     - plugins
     - views
- ....
- views 
```

在应用程序/类下的现有类中，我想使用一些属于该模块的功能。

现在我的问题：1）我应该在哪里存储我想从外部访问的这些功能？2）我如何从外部访问这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:23:45.883

我假设您的模块已经在您的应用程序中注册，例如在 中`application/configs/application.ini`，如下所示：

```
resources.frontController.moduleDirectory = APPLICATION_PATH "/modules" 
```

之后，属于您的模块的文件可以在您喜欢的任何地方访问，因为它们现在是您的应用程序的一部分。因此，例如，`application/controllers/IndexController.php`您可以简单地执行以下操作：

```
$myModel = new Discount_Model_MyModel(); 
```

# linq - 如何在 LINQ 中按顺序分组？

> ID：11261363
> 
> 赞同：1
> 
> 时间：2012-06-29T11:58:10.613
> 
> 标签：linq, c#-4.0, linq-to-objects

给定序列：

```
["1","A","B","C","2","F","K","L","5","6","P","I","E"] 
```

数字代表我标识为标题的项目，而字母代表我标识为数据的项目。我想将它们关联到这样的组中。

```
1:A,B,C    
2:F,K,L    
5:    
6:P,I,E 
```

我可以使用枚举器上的 foreach 或 while 循环轻松实现这一点，但是有没有一种 LINQ 的方法来实现这一点？这是我的领域中反复出现的模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T12:34:32.217

这是 LINQ 的解决方案。虽然有点复杂。可能有一些技巧的空间。它看起来并不那么糟糕，但是使用 foreach 循环可以提高可读性。

```
int lastHeaderIndex = default(int);
Dictionary<string, IEnumerable<string>> groupedItems =
    items.Select((text, index) =>
                 {
                     int number;
                     if (int.TryParse(text, out number))
                     {
                         lastHeaderIndex = index;
                     }
                     return new { HeaderIndex = lastHeaderIndex, Value = text };
                 })
          .GroupBy(item => item.HeaderIndex)
          .ToDictionary(item => item.FirstOrDefault().Value,
                        item => item.Skip(1).Select(arg => arg.Value)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T12:02:58.413

`foreach`循环`int.TryParse`应该有帮助。来自 LINQ 的“GroupBy”在这里没有多大帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T12:52:58.207

您可以使用折叠：

```
var aggr = new List<Tuple<Int,List<String>>>();
var res = sequence.Aggregate(aggr, (d, x) => {
    int i;
    if (Int32.TryParse(x, out i)) {
        var newDict = d.Add(new Tuple(i, new List<string>()));
        return newDict;
    } 
    else {
        var newDict = d[d.Count - 1].Item2.Add(x);
        return newDict;
    }
}).ToDictionary(x => x.Item1, x => x.Item2); 
```

However, this doesn't look so nice, since there's lacking support for immutable values. Also, I couldn't test this right now.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-18T23:32:24.540

Since this a common pattern in your domain, consider streaming the results instead of gathering them all into a large in-memory object.

```
public static IEnumerable<IList<string>> SplitOnToken(IEnumerable<string> input, Func<string,bool> isSplitToken)
{
    var set = new List<string>();
    foreach(var item in input)
    {
        if (isSplitToken(item) && set.Any())
        {
            yield return set;
            set = new List<string>();
        }
        set.Add(item);
    }
    if (set.Any())
    {
        yield return set;
    }
} 
```

Sample usage:

```
var sequence = new[] { "1", "A", "B", "C", "2", "F", "K", "L", "5", "6", "P", "I", "E" };
var groups = SplitOnToken(sequence, x => Char.IsDigit(x[0]));

foreach (var @group in groups)
{
    Console.WriteLine("{0}: {1}", @group[0], String.Join(" ", @group.Skip(1).ToArray()));
} 
```

output:

```
1: A B C
2: F K L
5: 
6: P I E 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-04T22:15:21.600

Here's what I ended up using. Pretty much the same structure as phg's answer.

Basically, it is an aggregate function that maintains a Tuple containing: 1: the accummulated data. 2: state of the parser.

The aggregating function does an if-else to check if currently examined item is a group header or a regular item. Based on this, it updates the datastore (last part of the tuple) and/or changes the parser state (first part of the tuple).

In my case, the parser state is the currently active list (that upcoming items shall be inserted into).

```
var sequence = new[]{ "1","A","B","C","2","F","K","L","5","6","P","I","E"};
var aggr = Tuple.Create(new List<string>(), new Dictionary<int,List<string>>());
var res = sequence.Aggregate(aggr, (d, x) => {
    int i;
    if (Int32.TryParse(x, out i))
    {
        var newList = new List<string>();
        d.Item2.Add(i,newList);
        return Tuple.Create(newList,d.Item2);
    } else
    {
        d.Item1.Add(x);
        return d;
    }
},d=>d.Item2); 
```

# asp.net - 如何在 asp.net 中划分脚本和样式？

> ID：11261368
> 
> 赞同：1
> 
> 时间：2012-06-29T11:58:44.887
> 
> 标签：asp.net, html, mobile

我想根据用户代理（移动，即chrome-ff）划分我的样式和脚本。如何控制和允许包含与否？

也许对于 ie 我可以使用 < !--[if IE] > ，但是其他人呢？有人建议我plz，thx

```
 <head runat="server" id="head">
    <%--Only mobile--%>
      <link href="Styles/CommonMobile.css" rel="stylesheet" type="text/css"/>
      <link href="Styles/SiteMobile.css" rel="stylesheet" type="text/css"/>
      <script src="Scripts/CommonMobile.js" type="text/javascript"></script>
      <script src="Scripts/SiteMobile.js" type="text/javascript"></script>

    <%--All but IE --%>
      <link href="Styles/GeneralView.css" rel="stylesheet" type="text/css" />
      <script src="Scripts/GeneralView.js" type="text/javascript"></script>

    <%--Only IE --%>
      <link href="Styles/IE.css" rel="stylesheet" type="text/css" />
      <script src="Scripts/IE.js" type="text/javascript"></script>

   <%--Always--%>
      <link href="Styles/Common.css" rel="stylesheet" type="text/css" />
      <script src="Scripts/Common.js" type="text/javascript"></script>
</head> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:17:19.160

一个不错的方法是用文字扭曲它们，然后在后面的代码上打开或不打开它。我说 Literal 是因为它是少数可以在标题内运行且不留下额外代码的控件之一。

所以我这样做

```
 <asp:Literal runat="server" ID="OnlyIE" EnableViewState="false" Visible="false">
       <link href="Styles/IE.css" rel="stylesheet" type="text/css" />
      <script src="Scripts/IE.js" type="text/javascript"></script>
 </asp:Literal> 
```

和

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Request.Browser.Browser == "IE")
    {
        OnlyIE.Visible = true;
    }
} 
```

[*] 测试和工作。

另一种方法是再次使用`Request.Browser.Browser`并在 Literal 中再次完全呈现 css 和 javascript，或者使用 Controls.Add 更难创建控件，但所有这些都比这更多的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:18:54.280

您也可以从服务器端代码注册 javascript 和 css。

像下面

```
string source  = "mobile" // set your source over here i.e. mobile , IE , etc

if (source == "mobile")
{

  if (!Page.ClientScript.IsClientScriptIncludeRegistered(this.GetType(), "Common"))
  {
    Page.ClientScript.RegisterClientScriptInclude(this.GetType(), "Common", this.Page.ResolveClientUrl("~/Scripts/Common.js"));
  }
  if (!Page.ClientScript.IsClientScriptIncludeRegistered(this.GetType(), "Common"))
  {
     Page.ClientScript.RegisterClientScriptInclude(this.GetType(), "CommonCss", this.Page.ResolveClientUrl("~/Styles/Common.css"));
  }
} 
```

希望这会帮助你..快乐的编码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T12:25:41.357

一种更可靠的浏览器检测方法。

```
var browser="";    
var isOpera = !!(window.opera && window.opera.version); // Opera 8.0+
 if(isOpera){
 string="opera"
 } 
var isFirefox = testCSS('MozBoxSizing');  // FF 0.8+
 if(isFirefox ){
 string="firefox"
 }               
var isSafari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0;
        // At least Safari 3+: "[object HTMLElementConstructor]"
 if(isSafari ){
 string="safari"
 }
var isChrome = !isSafari && testCSS('WebkitTransform');  // Chrome 1+
 if(isChrome ){
 string="chrome"
 }
var isIE = /*@cc_on!@*/false || testCSS('msTransform');  // At least IE6
 if(isIE){
 string="IE"
 }
 if(browser==""){
 browser="mobile";
 } 

var ss = document.createElement("link");
ss.type = "text/css";
ss.rel = "stylesheet";
if(browser=="IE"){
ss.href = "Styles/"+browser+".css";
}
else{
ss.href = "Styles/GeneralView.css";
}
if(browser=="mobile"){
ss.href = ss.href = "Styles/GeneralView.css";
var ss2 = document.createElement("link");
ss2.type = "text/css";
ss2.rel = "stylesheet";
ss2.href = var ss = document.createElement("link");
ss.type = "text/css";
ss.rel = "stylesheet";
ss.href = "style.css";
document.getElementsByTagName("head")[0].appendChild(ss);
}
document.getElementsByTagName("head")[0].appendChild(ss2);

    }
Similarly with javascript files. 
```

# ios5 - 如何在 IOS 5.0 中创建 UIPageViewController？

> ID：11261371
> 
> 赞同：0
> 
> 时间：2012-06-29T11:58:47.760
> 
> 标签：ios5, uipageviewcontroller

我是 IOS 开发新手，想在 IOS 5 中创建 UIPageViewController。请指导我！提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T11:50:24.297

XCode -> 文件 -> 新建.. 项目 -> iOS/应用程序 -> 基于页面的应用程序。

# ruby-on-rails - Rails3：使用 to_param 的嵌套 Restful 路由被反转

> ID：11261373
> 
> 赞同：1
> 
> 时间：2012-06-29T11:58:50.173
> 
> 标签：ruby-on-rails, ruby-on-rails-3

# # 解释上下文

```
puts "I am learning Rails, building a simple forum application."
puts "I am pretty satisfied to where I got so far but routes... "
puts "...still figuring them out."
puts "Been 2 days trying all sorts of things."
puts "This is where I am now, and something is not working as expected."
puts "Any help/pointers would be appreciated! :)" 
```

# # 配置/路由.rb

```
scope "/helpcenter" do
  resources :cat, :controller => "forums", :as => :forums do
    resources :topics , :controller => "forum_topics", :as => :topics
    resources :posts, :controller => "forum_posts", :as => :posts
  end
end

match "/helpcenter" => "forums#index", :as => :forums 
```

# # app/models/forum.rb

```
class Forum < ActiveRecord::Base
  def to_param
    "#{id}-#{name.parameterize}"
  end
end 
```

# # 应用程序/模型/forum_topic.rb

```
class ForumTopic < ActiveRecord::Base
  def to_param
    "#{id}-#{name.parameterize}"
  end
end 
```

# # 应用程序/控制器/论坛/show.hmtl.erb

```
link_to @forum_topic.name, forum_topic_path(@forum_topic)
# OR
link_to @forum_topic.name, @forum_topic 
```

# # link_to 正在生成什么：

```
"/helpcenter/cat/1-first-topic/topics/1-first-forum" 
```

# # 我期望看到的（因为主题应该在论坛中）：

```
"/helpcenter/cat/1-first-forum/topics/1-first-topic" 
```

# ＃ 我究竟做错了什么？

```
puts "Thanks!" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:31:02.003

主要路径应该是：

```
forum_topic_path(@forum, @topic)  
forum_topics_path(@forum) 
```

你传入的参数（@forum_topic）

```
link_to @forum_topic.name, forum_topic_path(@forum_topic) 
```

有一个 :id 与之关联 (1)，因此它将显示 id=1 的论坛。您还应该传递主题 ID

```
forum_topic_path(@forum, @topic) 
```

很惊讶你没有得到 id 的错误——我猜它推断出两个资源的 :id 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:35:09.783

嗨，我认为您想生成一个指向特殊论坛的特殊主题的链接。

因此，当您生成链接时，您需要 2 个 ID（ - 或 2 个实例，一个用于论坛，一个用于主题）。

```
link_to @forum_topic.name, forum_topic_path(@forum, @forum_topic) 
```

# c# - 使用c#在区分大小写的字典中不区分大小写地搜索

> ID：11261375
> 
> 赞同：1
> 
> 时间：2012-06-29T11:58:54.157
> 
> 标签：c#, dictionary

我有一本区分大小写的字典（非常大）。我想使用忽略大小写（不区分大小写）来搜索这本字典的键。我不想使用 foreach 遍历这个字典并比较每个值，因为字典包含太多数据。

有没有更好（最有效）的方法来使用 C# 来做到这一点？我想要一些建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:04:50.233

因此，如果我理解正确，您想要一个保存字符串的字典，但以不区分大小写的方式散列，这样无论大小写如何，您仍然可以在 O(1) 摊销时间内搜索？

我看到它的方式你需要在使用[这个构造函数](http://msdn.microsoft.com/en-us/library/ms132072.aspx)`IEqualityComparer`创建时传递一个自定义，并且在实现处理字符串时，就好像它们都是大写或小写一样，并且哈希码相同（即返回字符串的哈希码转为大写）。`Dictionary``IEqualityComparer`

例如：

```
class MyComparer : IEqualityComparer<string>
{
    public bool Equals(string x, string y)
    {
        return x.ToUpper() == y.ToUpper();
    }

    public int GetHashCode(string obj)
    {
        return obj.ToUpper().GetHashCode();
    }
}

...

Dictionary<String, String> dict = new Dictionary<string, string>(new MyComparer()); 
```

现在实际上您的字典通常会保存字符串，但是在搜索或添加时，它会将它们视为全部大写，因此“AbcD”与“aBCd”（都为“ABCD”）相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T18:08:57.613

Tudor 的答案很好，我想通过建议您使用 `StringComparer.CurrentCultureIgnoreCase`而不是创建自己的比较器类来补充它（特别是如果预期结果相同）。

例子 ：

```
Dictionary<string, string> openWith = 
                  new Dictionary<string, string>( 
                      StringComparer.CurrentCultureIgnoreCase); 
```

* * *

来源：http: [//msdn.microsoft.com/en-us/library/ms132072.aspx](http://msdn.microsoft.com/en-us/library/ms132072.aspx)

# vim - 通过 putty 连接时，virtualbox 上的 vim 启动速度很慢

> ID：11261387
> 
> 赞同：1
> 
> 时间：2012-06-29T11:59:39.067
> 
> 标签：vim, ssh, virtualbox, putty

我在 virtualbox 上运行 freebsd（在 freebsd 中安装了 virtualbox-ose-additions）。
在 vbox 控制台窗口中，vim 启动非常快（瞬间）。
但是当从主机通过腻子连接时，vim 需要大约 6-7 秒才能启动。
来自 putty 的连接是通过 ssh 身份验证进行的。主机到 vbox 的连接是 NAT+portforwarding。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T07:32:34.237

`X11 Forwarding`当我在 Putty 中打开但没有运行 X 服务器时，这发生在我身上（在（我假设）Windows 中使用 Putty 时总是如此，除非你正在运行像 Cygwin 或 Xming 这样的特定软件来拥有本地 X服务器）。

`DISPLAY`或者，当您使用 ssh 而非使用控制台时，您的 shell 启动脚本可能会错误地设置环境变量。

# ms-access - 使用默认表单值保存记录

> ID：11261389
> 
> 赞同：0
> 
> 时间：2012-06-29T11:59:49.010
> 
> 标签：ms-access

我有一个带有子表单控件的表单。主表单中的字段已计算出默认值（1 为 =Date()，另一个为 DLast()）。人们应该能够更改这些字段，但在大多数情况下，默认值是正确的，因此用户可以直接跳到子表单。子表单与主表单中的记录相连，如果用户不触摸任何主表单控件，他们就无法将记录添加到子表单。他们被迫重新键入主要表单记录之一的默认值才能继续。

我的想法是将其添加到主表单模块中：

```
Private Sub Form_Open(Cancel As Integer)
    DoCmd.RunCommand acCmdSaveRecord
End Sub 
```

它应该使用默认值创建一条记录，我应该添加一些内容来询问用户是否要在退出表单时保存或删除更改。但它不起作用。不创建记录，必须“触及”默认值才能创建记录。

PS更改它以`Form_Load`破坏表格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:07:25.740

使用代码将日期写入控件，而不是使用日期的默认值。只要控件绑定到字段，这将强制创建记录。

```
Private Sub Form_Current()
    If Me.NewRecord Then
        Me.ADate = Date
    End If
End Sub 
```

# windows - 在本地主机上安装和配置 james 服务器

> ID：11261394
> 
> 赞同：2
> 
> 时间：2012-06-29T12:00:21.000
> 
> 标签：windows, apache, email, james

我尝试了谷歌、youtube 以获得某种演示或说明..但找不到任何..我尝试浏览 james 服务器的网站，我还尝试了一些关于 ibm [http://www.ibm.com/developerworks/的文章java/库/j-james1/index.html](http://www.ibm.com/developerworks/java/library/j-james1/index.html)

但一切都是徒劳的..我对这些东西很陌生，我正在尝试在我的机器上托管一个邮件服务器来使用php代码发送邮件..我下载了一个稳定版本的詹姆斯源包

[http://james.apache.org/download.cgi#Apache_James_2.3.2_is_the_stable_version](http://james.apache.org/download.cgi#Apache_James_2.3.2_is_the_stable_version)

我找到的说明告诉我重定向到 james/bin 并运行一个名为 run.bat 的文件

但是当我运行它时，我得到的只是

使用 phoenix home 使用 phoenix tmpdir 使用 java home

然后关闭 sown phoenix 4.2

我在 Windows 7 上安装它

有人可以帮我解决这个问题吗..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-29T14:16:15.597

根据描述的症状，我想您下载了错误的版本（就像[james-xxx-src.zip](http://apache-mirror.telesys.org.ua//james/server/apache-james-2.3.2-src.zip)一样）。
在您的情况下（Windows 7），您需要其他一个**james-binary-xxxzip**
[james-binary-xxxzip](http://apache-mirror.telesys.org.ua//james/server/apache-james-2.3.2.zip)具有相同的简单安装。只需解压任意目录下的文件即可。启动 [INSTALLDIR]\bin\run.bat

# javascript - 将旭日形图放在馅饼上时，d3 中的部分缺失

> ID：11261395
> 
> 赞同：1
> 
> 时间：2012-06-29T12:00:21.723
> 
> 标签：javascript, d3.js, pie-chart, sunburst-diagram

（首先发布在谷歌组但没有回应，所以假设我应该在这里发布）。

我试图在馅饼（黄色和白色部分）上放置一个旭日形（彩色弧线）。

这是一个显示问题的 js fiddle，缺少初始的绿色段：

[http://jsfiddle.net/qyCkB/1/](http://jsfiddle.net/qyCkB/1/)：

![在此处输入图像描述](../Images/28de70e0f573047a0c392965467a101a.png)

和一个没有正确显示所有段的饼图的 js fiddle：

[http://jsfiddle.net/X3sRy/1/](http://jsfiddle.net/X3sRy/1/)

![在此处输入图像描述](../Images/84f7a3310bcb555f4d3fdb7ea61bea10.png)

在此行上创建节点变量后，我检查了它：

```
 var nodes = partition.nodes({'values': data}); 
```

并且两个示例中的值似乎相同。

在检查 DOM 时，它只是没有绘制旭日形的前几段。

这应该可行还是不能将两种不同的布局放在一起？有没有更好的方法来实现同样的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:08:27.437

您的第二个数据连接与第一个数据连接发生冲突。您的第一个数据连接在“g.arc”上，因此您应该添加具有“arc”类（而不是“clock_arc”）的 G 元素。您的第二个数据连接在“路径”上，它无意中选择了您之前添加的路径元素。由于您的第二个数据连接与先前添加的元素匹配，因此您没有输入饼图的所有预期元素。

您需要**从饼图路径元素中消除旭日形路径元素的歧义**。您可以这样做的一种方法是按类而不是元素类型进行选择，因此第二个数据连接变为“.pie”而不是“路径”。像这样的东西：

```
var gClock = svg.selectAll(".clock")
    .data(clockData)
  .enter().append("g")
    .attr("class", "clock");

var pathClock = gClock.append("path");

var pathPie = svg.selectAll(".pie")
    .data(pieData)
  .enter().append("path")
    .attr("class", "pie"); 
```

如果您还没有阅读这些教程，我还建议您阅读：[Thinking with Joins](http://bost.ocks.org/mike/join/)、[Nested Selections](http://bost.ocks.org/mike/nest/)、[Object Constancy](http://bost.ocks.org/mike/constancy/)。

# php - 如何使不推荐使用的函数在 PHP 的最新版本中工作？

> ID：11261396
> 
> 赞同：0
> 
> 时间：2012-06-29T12:00:22.903
> 
> 标签：php, deprecated, php4

如何使不推荐使用的函数在 PHP 的最新版本中工作？我不想在每个页面中更改它的替代功能，这在我拥有的维护项目中是极不可能的。因此，请让我知道是否有办法使已弃用的功能正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T12:03:24.650

如果您真的无法更改您拥有的代码，那么为与已弃用函数具有相同规范的新函数创建包装器怎么样？因此，换句话说，您创建了一个新函数，该函数调用已弃用的函数，但接收旧函数的参数。可能工作...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T12:02:03.373

您必须修复它们以使用替换已弃用 API 的相应 API。不推荐使用的 API 已被弃用是有原因的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T12:09:15.927

不推荐使用的函数是有原因的。您应该将 PHP 的发行版保持在较旧的版本，或者升级和更新标记为已弃用的函数。您应该做正确的事并将您的函数更新为较新版本的 PHP 中使用的函数。PHP4 在 2008 年停止了开发，这意味着你真的应该在很久以前就升级了。

如果您使用的是 Linux，[Regexxer](http://regexxer.sourceforge.net/)可能有助于一次性更新所有文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-29T12:10:54.863

正确的做法是修复您的代码。PHP4 已于 4 年前终止，不再受支持。我确信 PHP4 中存在大量永远无法修复的危险错误。

您现在所处的情况称为[技术债务](http://martinfowler.com/bliki/TechnicalDebt.html)。你迟早需要[偿还债务。](http://www.codinghorror.com/blog/2009/02/paying-down-your-technical-debt.html)

您可以通过自己重新实现旧功能来增加您的技术债务，但这将使代码在未来更难维护。一旦修复了不推荐使用的代码，您现在在代码库中所做的一切可能都需要从头开始重新实现。因此，您可以选择继续向已弃用的代码添加功能（并增加债务）或将代码引入 2012 年并在继续添加任何新内容之前完全偿还您的债务。

编写代码并不困难或耗时。您应该能够找到简化的方法来修复已弃用的代码。*我敢肯定，如果您只*专注于此，您和您的团队可能会在几天内解决大部分或所有已弃用的代码。相比之下，考虑在类似意大利面条的代码库中实现即使是最简单的功能也需要多少时间。

# r - 用于转换数据框列类型的函数

> ID：11261399
> 
> 赞同：4
> 
> 时间：2012-06-29T12:00:40.440
> 
> 标签：r, function, type-conversion

R 通常以“错误”格式理解数据框列，或者您只需将列类从因子更改为字符即可对其进行修改。我以前一直在以下列方式更改列类：

```
set.seed(1)

df <- data.frame(x = 1:10,
y = rep(1:2, 5),
k = rnorm(10, 5,2),
z = rep(c(2010, 2012, 2011, 2010, 1999), 2),
j = c(rep(c("a", "b", "c"), 3), "d"))

x <- c("y", "z")

for(i in 1:length(x)){
df[,x[i]] <- factor(df[,x[i]])} 
```

回到数字：

```
x <- 1:5

for(i in 1:length(x)){
df[,x[i]] <- as.numeric(as.character(df[,x[i]]))} # Character cannot become numeric 
```

我突然想到，也许有更好的方法来做到这一点。我发现[了这个问题](https://stackoverflow.com/questions/7680959/convert-type-of-multiple-columns-of-a-dataframe-at-once)，这几乎正是我所需要的：

```
convert.magic <- function(obj,types){
out <- lapply(1:length(obj),FUN = function(i){FUN1 <- 
switch(types[i],
character = as.character,
numeric = as.numeric,
factor = as.factor); FUN1(obj[,i])})
names(out) <- colnames(obj)
as.data.frame(out)
} 
```

但是，对于此函数，必须为每一列指定向量类型：

```
convert.magic(df, rep("factor",5))

convert.magic(df, c("character", "factor"))
# Error in FUN(1:5[[1L]], ...) : could not find function "FUN1" 
```

有人可以帮我重建这个函数，让它与列名和数字一起工作吗？恐怕这对我来说太先进了……

```
x <- c("y", "z")
convert.magic(df, "character", x) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T14:13:40.130

```
df <- data.frame(x = 1:10,
                 y = rep(1:2, 5),
                 k = rnorm(10, 5,2),
                 z = rep(c(2010, 2012, 2011, 2010, 1999), 2),
                 j = c(rep(c("a", "b", "c"), 3), "d"))

convert.magic <- function(obj, type){
  FUN1 <- switch(type,
                 character = as.character,
                 numeric = as.numeric,
                 factor = as.factor)
  out <- lapply(obj, FUN1)
  as.data.frame(out)
}

str(df)
str(convert.magic(df, "character"))
str(convert.magic(df, "factor"))
df[, c("x", "y")] <- convert.magic(df[, c("x", "y")], "factor") 
```

# java - 我如何确保我导入到 cacert 的证书（myAppCertificate.crt）已经存在于 cacert 文件中？

> ID：11261400
> 
> 赞同：1
> 
> 时间：2012-06-29T12:00:52.267
> 
> 标签：java, ssl, https, ssl-certificate

我如何确保我导入到 cacert 的证书（myAppCertificate.crt）已经存在于 cacert 文件中？有关信息，我正在导入证书

keytool -import -alias myAppca -file myAppCertificate.crt -keystore cacerts -v

出于测试目的，我尝试在 cacert 文件中再次添加已经存在的证书，但它没有给我任何异常/警告证书已经存在。**有没有办法在实际导入之前确认证书是否已经存在？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T12:10:12.613

如果您使用`keytool -list -keystore cacerts`，您将获得所有带有指纹的证书的列表。（如果你使用 Java 6 的 keytool，你会看到 MD5 指纹，如果你使用 Java 7 的版本，你会得到 SHA-1 指纹，更好。）

如果您使用`keytool -printcert -file myAppCertificate.crt`，您应该会看到证书指纹（包括 MD5 和 SHA-1）。

如果您从该证书获得的值在列表中，则您的证书已经在密钥库中。

（有关什么是指纹的更多详细信息，请参阅[此问题](https://security.stackexchange.com/q/14330/2435)。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:11:11.023

您可以使用 keytool **list**选项查看密钥库中的所有证书： keytool -list -v -keystore keystorefile

# php - 在 CodeIgniter 中使用 PostgreSQL 数据库时出现空白页

> ID：11261407
> 
> 赞同：0
> 
> 时间：2012-06-29T12:01:17.167
> 
> 标签：php, codeigniter, postgresql

我正在开发一个使用 CodeIgniter 作为框架和 PostgreSQL 作为数据库的 PHP 应用程序。在`\application\config\database.php`我有以下配置：

```
$db['default']['hostname'] = 'localhost';
$db['default']['username'] = '<myusername>';
$db['default']['password'] = '<mypassword>';
$db['default']['database'] = 'heatmap';
$db['default']['dbdriver'] = 'postgre';
$db['default']['dbprefix'] = '';
$db['default']['pconnect'] = TRUE;
$db['default']['db_debug'] = TRUE;
$db['default']['cache_on'] = FALSE;
$db['default']['cachedir'] = '';
$db['default']['char_set'] = 'utf8';
$db['default']['dbcollat'] = 'utf8_general_ci';
$db['default']['swap_pre'] = '';
$db['default']['autoinit'] = TRUE;
$db['default']['stricton'] = FALSE; 
```

当我尝试加载我的`http://localhost/heatmap/`页面时，我只得到一个空白页面。什么都没有显示，页面源也是空的。没有抛出错误。我只是想加载 CodeIgniter 附带的默认页面。我确实用谷歌搜索了这个问题，但我发现的相关问题都没有解决我的问题。我的`Postgres`版本是`9.1`，`PHP`是`5.3.8`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T21:17:41.650

我只能说是什么帮助了我。我刚刚意识到我的系统中没有 php-postgre 驱动程序（Debian）安装 php5-pgsql 对我有用。在此之后我不得不设置

```
$db['default']['db_debug'] = FALSE; 
```

现在一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-05T16:12:22.873

检查 php.ini：extension=php_pgsql.dll

检查 httpd.conf: LoadFile "C:/Program Files/PostgreSQL/9.3/bin/libpq.dll"

重启阿帕奇。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:46:31.763

您确定问题是由您的数据库（配置）引起的吗？默认控制器不与数据库交互，默认不加载数据库类。

如果您确实使用自己加载了数据库类，`$this->load->database();`则将其删除并查看是否显示默认页面。

我还建议打开`error_reporting()`，这样您就可以查看日志并查看发生了什么。可以在[此处](http://codeigniter.com/user_guide/general/errors.html)找到有关该主题的更多信息。

# c# - 自动生成的序列图

> ID：11261409
> 
> 赞同：2
> 
> 时间：2012-06-29T12:01:24.373
> 
> 标签：c#, sequence-diagram, static-code-analysis, cobol.net

在 Ndepend 中，我们可以获得非常好的依赖关系图，显示调用了哪些方法。

我们无法做的是查看调用方法的顺序。例如，方法 A 调用方法 X 和方法 Y。那么我们希望在图中看到方法 X 在方法 Y 之前被调用。

有谁知道这是否可以使用 NDepend 或任何其他工具？

我们正在分析的代码是 C# 和 Cobol.net（Ndepend 不分析 Cobol.Net 代码，但它确实分析了从 Cobol.net 代码生成的 IL 代码）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:32:47.680

Visual Studio 2010 Ultimate 可以生成序列图：http: [//msdn.microsoft.com/en-us/library/ee317485.aspx](http://msdn.microsoft.com/en-us/library/ee317485.aspx)

# blackberry - 黑莓 ConnectionFactory 超时

> ID：11261410
> 
> 赞同：2
> 
> 时间：2012-06-29T12:01:24.480
> 
> 标签：blackberry, timeout, connection

我升级了现有应用程序，在新版本中我**需要 OS 5** - 原因之一是我想使用**ConnectionFactory**通过 HTTP/HTTPS 与我们的服务器进行通信，而无需添加所有使用 BES、BIS、Direct 的 URL 参数TCP、Wifi等。

**ConnectionFactory**现在配置为选择通过首选类型连接到我们的服务的最佳方式。

我的连接代码如下所示：

```
ConnectionFactory connectionFactory = new ConnectionFactory();
BisBOptions bisOptions = new BisBOptions(BIS_SECRET);
connectionFactory.setTransportTypeOptions(TransportInfo.TRANSPORT_BIS_B, bisOptions);
connectionFactory.setConnectionMode(ConnectionFactory.ACCESS_READ_WRITE);
connectionFactory.setEndToEndDesired(true);
connectionFactory.setPreferredTransportTypes(new int[] { TransportInfo.TRANSPORT_BIS_B, TransportInfo.TRANSPORT_MDS,
TransportInfo.TRANSPORT_TCP_WIFI, TransportInfo.TRANSPORT_TCP_CELLULAR });
ConnectionDescriptor connectionDescriptor = connectionFactory.getConnection("https://myserver.com/serviceurl");
try {
  HttpConnection con = (HttpConnection) connectionDescriptor.getConnection();
  byte[] bytes = parameter.toString().getBytes(UTF_8);
  con.setRequestProperty(CONTENT_LENGTH, String.valueOf(bytes.length));
  os = con.openOutputStream();
  os.write(bytes);
  os.flush();
  int responseCode = con.getResponseCode();
  if (responseCode == 401) {
    throw new InvalidCredentialsException("Invalid credentials");
  } else if (responseCode != 200 && responseCode != 500) {
    EventLogger.logEvent(RTSID, ("Response code " + responseCode + " " + con
          .getResponseMessage()).getBytes(), EventLogger.ERROR);
    EventLogger.logEvent(RTSID, bytes, EventLogger.ERROR);
    throw new IOException("Invalid request");
  }
  is = con.openInputStream();
  if (is != null) {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    int c = 0;
    try {
      c = is.read();
    } catch (Exception ex) {
      c = -1;
    }
    while (c >= 0) {
      baos.write(c);
      try {
        c = is.read();
      } catch (Exception ex) {
        c = -1;
      }
    }
    String response = new String(baos.toByteArray(), UTF_8);
    try {
      JSONObject jsonObject;
      if (response.startsWith("[")) {
        jsonObject = new JSONObject();
        jsonObject.put(ARRAY, new JSONArray(response));
      } else {
        jsonObject = new JSONObject(response);
      }
      if (responseCode == 500) {
        throw new Exception(jsonObject.getString("message"));
      }
      return jsonObject;
    } catch (JSONException e) {
      EventLogger.logEvent(RTSID, ("Exception occured: " + e.toString()).getBytes(),
      EventLogger.ERROR);
    }
  }
} finally {
  if (is != null) {
    try {
      is.close();
    } catch (Exception e) {
    }
  }
  if (os != null) {
    try {
      os.close();
    } catch (Exception e) {
    }
  }
  if (con != null) {
    try {
      con.close();
    } catch (Exception e) {
    }
  }
} 
```

我的问题是，当我手动将连接参数添加到我的 URL 时，它的效果并不好。我在服务器日志中收到错误，看起来客户端在某种超时后关闭了连接。

以下是一些日志示例：

```
93.186.30.120 - - [28/Jun/2012:15:50:08 +0200] "POST /service/methodX HTTP/1.1" 400 145 "-" "myapp VendorID/301" 10012567 
93.186.22.118 - - [28/Jun/2012:16:30:56 +0200] "POST /service/methodY HTTP/1.1" 400 145 "-" "myapp VendorID/137" 10012435
74.82.68.35 - - [28/Jun/2012:16:53:23 +0200] "POST /service/methodZ HTTP/1.1" 400 145 "-" "myapp BlackBerry9650/6.0.0.524 VendorID/105" 10012644 
```

IP 地址来自**RIM Networks** - 所以这些是来自**BIS的连接**

这些连接从服务器获得状态代码**400（错误请求）**

行尾的大数字（例如 10012644）显示了**请求**在服务器上处理的时间（以微秒为单位）：10012644 = 大约 10 秒

RIM 服务器是否添加了**10 秒**的连接超时？这似乎很短！

这个问题很难重现——以前有没有人经历过这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:38:36.263

我找到了原因。问题是由 Apache 模块 mod_reqtimeout 的默认配置引起的：

```
<IfModule reqtimeout_module>

# mod_reqtimeout limits the time waiting on the client to prevent an
# attacker from causing a denial of service by opening many connections
# but not sending requests. This file tries to give a sensible default
# configuration, but it may be necessary to tune the timeout values to
# the actual situation. Note that it is also possible to configure
# mod_reqtimeout per virtual host.

# Wait max 20 seconds for the first byte of the request line+headers
# From then, require a minimum data rate of 500 bytes/s, but don't
# wait longer than 40 seconds in total.
# Note: Lower timeouts may make sense on non-ssl virtual hosts but can
# cause problem with ssl enabled virtual hosts: This timeout includes
# the time a browser may need to fetch the CRL for the certificate. If
# the CRL server is not reachable, it may take more than 10 seconds
# until the browser gives up.
RequestReadTimeout header=20-40,minrate=500

# Wait max 10 seconds for the first byte of the request body (if any)
# From then, require a minimum data rate of 500 bytes/s
RequestReadTimeout body=10,minrate=500

</IfModule> 
```

我猜黑莓客户端受到的打击更大，因为通过 RIM BIS 基础设施发送请求正文需要更长的时间。

将该值设置为 100 秒并监视客户端是否仍然受到影响。

# jquery - JQuery Mobile 滚动视图适合屏幕高度

> ID：11261423
> 
> 赞同：1
> 
> 时间：2012-06-29T12:02:53.347
> 
> 标签：jquery, css, jquery-mobile

我想`scrollview`适应`JQuery Mobile`屏幕高度。

我想要三行项目，当页面调整大小时，项目的高度应该自动更改。

这是我的`scrollview container`CSS代码：

```
 .threeByThree {
        border: solid 0px black;
        background-color: #ccc;
        overflow: hidden;
        width: 100%;
        height: 80%;
        padding-top:10px;
        padding-left:10px;
    } 
```

这是里面元素的css代码`scrollview`：

```
 .square {
        width: 200px;
        height: 30%;
        border: solid 0px #333;
        text-align: center;
        line-height: 100px;
        font-size: 20px;
        margin: 10px 10px 10px 10px;
    } 
```

页面和内容元素也是这个css代码：`height:100%`。

我的完整页面代码在[这里](http://pastie.org/4171015)。

但它不能正常工作。当我更改浏览器的高度（通过调整浏览器大小）时，有时会出现滚动条，并且元素的大小未正确调整...

问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:33:42.907

您正在使用 Jquery Mobile 不再支持的滚动视图。尝试以下任何方法：

[Overthrow](http://filamentgroup.github.com/Overthrow/) - 应该是 Scrollview
[JQM iscrollview](https://github.com/watusi/jquery-mobile-iscrollview)的后续- 另一种选择

# java - 排序数据问题

> ID：11261425
> 
> 赞同：-2
> 
> 时间：2012-06-29T12:02:54.930
> 
> 标签：java, android

我正在开发一个应用程序，在其中我从服务器获取数据并显示在地图中。但是在将其显示在地图的气球上之前，我只是按一个字段名称对数据进行了排序，名称是“目的地”，并且有一些方法是 ..GOTOSORT....

现在的问题是我得到`s`了长度为 1 的变量，for 循环只运行了 1 次，但是有 42 个数据来自 web 服务，所以请检查它并告诉我有什么问题

```
private void GOTOSORT() {

        Log.i(TAG, " SORT ");
        Map<Float, Integer> map = new TreeMap<Float, Integer>();

        for (int i = 0; i < lng_timeStamp.length; ++i) {
            map.put((float) lng_timeStamp[i], i);
        }
        Collection<Integer> indices = map.values();
        System.out.println("indices" + indices);
        Integer s[] = (Integer[]) indices.toArray(new Integer[0]);

        Log.i(TAG, "s.length"+s.length);
        for (int i = 0, n = s.length; i < n; i++) {
            System.out.println(s[i]);

            int_sort_MyhourGetTime[i] = int_MyhourGetTime[s[i]];
            int_sort_MyMinGetTime[i] = int_MyMinGetTime[s[i]];
            lng_sor_timeStamp[i] = lng_timeStamp[s[i]];
            arr_sort_ServiceNumber[i] = arr_ServiceNumber[s[i]];
            arr_sort_Destination[i] = arr_Destination[s[i]];

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:20:29.970

如果你想对你的列表进行排序，你应该按照 Java 的比较器[Follow here](http://javarevisited.blogspot.in/2011/06/comparator-and-comparable-in-java.html) 它将以任何顺序返回给你一个排序的列表。

祝一切顺利 ！！:)

# linux - 如何获取完整的目标 IP 地址 (xxxx/x) netstat 命令？

> ID：11261435
> 
> 赞同：0
> 
> 时间：2012-06-29T12:03:32.080
> 
> 标签：linux, networking, ip

下面是带有`-n`&`-r`选项的 netstat 命令的输出，其中目标字段显示压缩地址 (127.1/16)。我想知道 netstat 命令是否有任何方法或选项可以显示整个目标 IP (127.1.0.0/16) 而不是 (127.1/16) ？

```
#netstat -r -n
Destination        Gateway            Flags     Refs     Use    Mtu    Interface
127.0.0.1          127.0.0.1          UH        110   296172    33212  lo0
127.1/16           link#7             UC          2        0        -  vlan10 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:09:53.330

但是该命令没有显示 127.1.0.0/8，而是显示 127.1/16，这意味着整个 127.1.xx 范围。

阅读网络掩码：[http ://en.wikipedia.org/wiki/Subnetwork#IPv4_subnetting](http://en.wikipedia.org/wiki/Subnetwork#IPv4_subnetting)

并在这里对它们进行试验，以获得更好的理解：http: [//jodies.de/ipcalc](http://jodies.de/ipcalc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T17:52:49.270

您可能需要考虑仅使用 netstat 的替代方案。“netstat -r”给出与“route”相同的输出。如果您想查看通过特定设备/接口的路由，您还可以尝试“ip route show”或“ip route show dev”。您可能还对“routel”返回的输出感兴趣。

# visual-studio-2010 - Visual Studio 2010 中的随机编译错误

> ID：11261436
> 
> 赞同：0
> 
> 时间：2012-06-29T12:03:33.277
> 
> 标签：visual-studio-2010, random, compiler-errors

我正在开发一个 ASP.NET 项目，一切顺利。

但是现在我遇到了错误，但是代码中的一切都很好。

我按 F6 编译所有解决方案，但到处都是错误。但是代码一切正常（继续阅读，你会明白的）。然后我尝试再次编译它，再次，再次，再次......在一个完全随机的时刻，我成功了。

然后我尝试在浏览器中查看页面。编译错误！再次编译，成功。刷新页面，编译错误！再次刷新页面，成功！

而且我没有更改代码中的任何内容。

然后我可以继续正常编程，但是当我关闭VS并再次打开它时，这个问题又来了。

我尝试的其他事情：删除 bin 文件夹并再次编译，重建解决方案，单独构建每个项目......没有任何效果。

Visual Studio 正在“当他想要的时候”编译。

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:34:38.383

问题解决了！我创建了一个同名“Mensagem”的处理程序，有时编译器会尝试先编译处理程序，有时会先编译 Mensagem 类。

我刚刚更改了处理程序名称，现在可以了。

令人难以置信的是，这些小错误如何会导致头疼。

我观察到的另一件事是，我有很多课程，但只有一个课程返回错误错误。

主要错误是：

“无法将类型 'Entidades.Mensagem' 隐式转换为 'Mensagem'”

“Mensagem”类位于命名空间“Entidades”中，在“使用”部分中引用。当我尝试对其进行编码时，一切正常，但是在编译时，我得到了错误。

它只是这个类。

# python - Python - 添加动态调试记录器样式的行号和时间函数

> ID：11261438
> 
> 赞同：1
> 
> 时间：2012-06-29T12:04:01.443
> 
> 标签：python, alias

以下函数报告发生运行时异常时我想从其他函数中调用的“当前”行号（和时间）。

可以理解，返回的行号总是与 gTime() 函数本身中 getframeinfo 的位置相关，即它是静态的。

每当我需要 line.num/time 数据时，我只需要 gTime() 功能，*而无需将（长）gTime 代码直接添加*到主代码主体中需要它的每个位置。我猜想某种**命令序列别名**是我真正想要替换的 gTime() 函数中的代码 - 但找不到任何解决我的问题的方法。

标准的“记录器”模块在我的多线程应用程序中无法可靠地工作，所以我求助于手动解决方案。

```
from inspect import currentframe, getframeinfo
from datetime import datetime

def gTime():
    position = "%s [%s] - " % (str(datetime.now().strftime("%Y-%m-%d %H:%M:%S.%f").rstrip('0')),getframeinfo(currentframe()).lineno)
    return position 

print gTime() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:10:32.737

如果你不能使用`logging`，我建议尽可能多地使用它的内部结构，或者至少向它们学习；见[http://hg.python.org/cpython/file/tip/Lib/logging/__init__.py](http://hg.python.org/cpython/file/tip/Lib/logging/__init__.py)。

特别是，`logging.currentframe`可用于获取封闭框架：

```
from inspect import getframeinfo
from logging import currentframe
from datetime import datetime

def callingFrame():
    return getframeinfo(currentframe())

def gTime():
    position = "%s [%s] - " % (str(datetime.now().strftime("%Y-%m-%d %H:%M:%S.%f").rstrip('0')), callingFrame().lineno)
    return position 

print gTime() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:35:50.363

“标准的‘记录器’模块在我的多线程应用程序中无法可靠地工作，所以我求助于手动解决方案。”

文件[不同意](http://docs.python.org/library/logging.html#thread-safety)

> 日志模块旨在实现线程安全，无需其客户端完成任何特殊工作。它通过使用线程锁来实现这一点；有一个锁可以序列化对模块共享数据的访问，每个处理程序还创建一个锁来序列化对其底层 I/O 的访问。

为什么它不能可靠地工作？

# sql - TSQL 将行追加到变量

> ID：11261442
> 
> 赞同：0
> 
> 时间：2012-06-29T12:04:18.337
> 
> 标签：sql, sql-server, tsql

我`varchar`在 T-SQL 中声明一个变量

```
declare @var varchar(max); 
```

我有一个返回多个值的选择查询。如：

```
Select name from table where ... 
```

我想将每一行附加到这个变量。例如我的查询返回：

```
name
----------
 Joe
 Jack
 William
 Avarel 
```

我希望我`@var`是这样的：`JoeJackWilliamAvarel`

我该怎么做？我正在写这个查询，但它给了我错误：

```
Set @var = (Select name from table where ...) 
```

错误是：

> 子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T12:05:35.273

```
SELECT
  @var = @var + name
FROM
  table
WHERE
  ...
ORDER BY
  ... 
```

但请确保 @var 不*以*NULL 开头。 `@set @var = ''`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T12:08:48.460

您可以使用[`COALESCE`](http://msdn.microsoft.com/en-us/library/ms190349.aspx)：

```
DECLARE @var VARCHAR(MAX);
SELECT @var = COALESCE(@var+ ' ', '') +  name
FROM  table
WHERE ....
ORDER BY name 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T12:14:57.103

以下查询可以用作子查询或单独使用。

```
SET @var = (SELECT name + ' ' 
            FROM   mytable 
            Where ...
            FOR xml path ('')) 
```

# java - 具有显式类型构造函数的泛型类

> ID：11261444
> 
> 赞同：4
> 
> 时间：2012-06-29T12:04:40.787
> 
> 标签：java, generics

是否可以使用一个明确定义其类类型的构造函数来编写泛型类？

这是我的尝试：

```
import javax.swing.JComponent;
import javax.swing.JLabel;

public class ComponentWrapper<T extends JComponent> {

    private T component;

    public ComponentWrapper(String title) {
        this(new JLabel(title));  // <-- compilation error
    }

    public ComponentWrapper(T component) {
        this.component = component;
    }

    public T getComponent() {
        return component;
    }

    public static void main(String[] args) {
        JButton button = new ComponentWrapper<JButton>(new JButton()).getComponent();
        // now I would like to getComponent without need to cast it to JLabel explicitly
        JLabel label = new ComponentWrapper<JLabel>("title").getComponent();
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T12:09:23.257

你可以投它：

```
public ComponentWrapper(String title) {
    this((T) new JLabel(title));
} 
```

这是由于通用信息无法用于某些情况。例如：

```
new ComponentWrapper() // has 2 constructors (one with String and one with Object since Generics are not definied). 
```

类本身无法预测这种使用，在这种情况下，考虑最坏的情况（没有通用信息）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T12:25:32.650

您当前的代码很容易导致无效状态（例如`ComponentWrapper<SomeComponentThatIsNotAJLabel>`，包装 a `JLabel`），这可能是编译器阻止您的原因。在这种情况下，您应该使用静态方法：

```
public static ComponentWrapper<JLabel> wrapLabel(final String title) {
    return new ComponentWrapper<JLabel>(new JLabel(title));
} 
```

这在许多方面会更安全。

# security - 二维码安全

> ID：11261445
> 
> 赞同：5
> 
> 时间：2012-06-29T12:04:42.127
> 
> 标签：security, qr-code

我已经阅读了很多关于二维码以及二维码本身如何导致严重安全风险的信息。但是我没有遇到的一件事是以下。

在以下场景中：我有一个显示我的一些数据的二维码让我们说： - 姓名 - 地址 - 我被允许做的事情的列表

我扫描我的代码以查看其内容，将一些内容添加到我被允许做的事情列表中并重新打印二维码。第二天我来上班，扫描我的代码，然后可以做我添加到代码中的额外事情。

我的问题是：我怎样才能阻止这种情况发生。请注意，无法检查我的数据是否与数据库数据一致。

更多信息：

我将 phonegap 与 Sencha Touch 2 结合使用来创建我的二维码阅读器。
它是专为 Android 4.0 设备设计的 Android 应用程序。
二维码每年提供一次。
如果有人扫描他去年的二维码，那将无法正常工作。
请注意：理论上，如果他更改他能够进入的代码日期，这正是我想要阻止的。
一些员工可以访问读取代码的应用程序。
应用程序没有任何方法可以验证 QR 码上的数据，因此它必须是仅使用 QR 码上的数据的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T12:31:50.897

使用私钥对二维码数据进行签名。读者需要公钥来验证二维码，但公钥不需要保密。

如果您使用 ECDSA Secp256K1 密钥，签名只会在 QR 码数据中添加大约 68 个字节。

在二维码中也包括发行日期。读者需要一个本地时钟来检查二维码是否太旧。如果阅读器没有时钟，您至少可以跟踪您所见过的最新有效代码。在该日期之前一年以上发布的任何代码肯定是无效的。

BouncyCastle 和 OpenSSL 都包含您需要的代码的实现。

如果代码阅读器/验证器可以包含生成假二维码所需的所有信息，那么您可以使用 HMAC 而不是 ECDSA。这更简单，一个 HMAC 可以小到 16 字节并且仍然可以完成工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-29T13:56:02.317

如果您意识到二维码只是对纯文本进行编码，这一切就更容易推理了。如果您只是处理文本文件或打印在墙上的文本，那么您的方案不安全——二维码不会改变这一点。二维码没有安全机制。

扭转局面——除了二维码之外，任何可用于保护您的方案的方法都可能在这里应用。您正在寻找的是数字签名，与用于证明 SSL 证书有效且电子邮件来自声称的发件人的相同类型的公钥/私钥方案相同。您的用户需要提供的数据必须经过您的签名，才能知道他们没有篡改这些数据。

您可以在 QR 码中放入任何您想要的内容，包括表示已签名文档的 Base-64 编码字节。没有读者会知道如何处理它；您必须编写一个自定义应用程序来扫描，然后知道对其进行解码并采取相应措施。

我确实认为构思一个涉及将用户引导到您安全控制的网站的方案要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:08:33.600

如果您无法进行任何比较，我不知道您如何确保安全。也许所有信息都可以用密钥散列？那么你不能在没有密钥的情况下重新打印你的代码

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2017-08-09T01:50:05.120

QR 码只不过是将文本编码为 2D 图像。所以加密不是二维码的责任。但是您总是可以生成一个简单的验证码，例如 MD5 或 Base64，它是由唯一的 id 加上日期创建的。取决于您想要什么样的保护，您可以拒绝或禁用带有错误验证码的代码。

# php - PHP - 在视频上传期间提取帧

> ID：11261448
> 
> 赞同：3
> 
> 时间：2012-06-29T12:04:54.633
> 
> 标签：php, javascript, image, frame

我很难找到这是否可能（在任何地方都找不到信息）。是否可以在视频上传期间提取帧（缩略图）？如果可以提取用户端，则使用 jscript 提取也是一种选择。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-03-16T20:57:14.257

自这个问题发布以来快进快五年了，现在答案是**肯定**的！

**[现场演示](https://jsfiddle.net/rodrigo_silveira/tq1u07tz/1/)**

# 如何使用 JavaScript 在视频上传期间提取帧

在显示代码之前，这是我们要做的：

1.  在将上传视频的输入元素上设置一个事件处理程序
2.  当从文件系统中选择一个文件时，使用该`URL`对象创建一个指向本地视频文件的 url。
3.  将该 URL 加载到`video`元素中。
4.  `canvas`当视频加载到内存中时，在对象上绘制一个框架。
5.  现在将画布上渲染的帧导出到一个`image`元素中（或者选择将该图像作为数据 url 发送到您的服务器）。

* * *

```
<input type="file" id="upload"/>
<img id="thumbnail"/>

<script>
var input = document.getElementById('upload');
var img = document.getElementById('thumbnail');

input.addEventListener('change', function(event){
    var file = this.files[0];
    var url = URL.createObjectURL(file);

    var video = document.createElement('video');
    video.src = url;

    var snapshot = function(){
        var canvas = document.createElement('canvas');
        var ctx = canvas.getContext('2d');

        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        img.src = canvas.toDataURL('image/png');

        video.removeEventListener('canplay', snapshot);
    };

    video.addEventListener('canplay', snapshot);
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:40:32.947

我不认为在 php 中有一个很好的方法来做到这一点。（[https://stackoverflow.com/a/1309425/1488032](https://stackoverflow.com/a/1309425/1488032)）

如果它不仅仅是您租用的一些网络空间，而且有权在服务器上安装和运行其他软件，我建议使用 ffmpeg 之类的东西，并使用**system()**、**passthru()**或**exec()**从 php 中调用它来提取您想要的内容，然后再次在 php 中进行其余处理。

我正在运行一个依赖于嵌入在 xhtml 中的 svg 图像的浏览器游戏，但某些浏览器（尤其是移动浏览器）不支持完整的 svg 语法。在这种情况下，我使用这样的**system()调用使用 imagemagick 的****转换**二进制文件进行 svg 到 png 的转换，并将结果显示在我的页面上。

```
system("echo '$svgString' | convert svg:- png:- | base64"); 
```

我想你必须退回到类似的东西。

以下是使用 ffmpeg 提取帧的一些信息： [http ://ubuntuforums.org/showthread.php?t=1141293](http://ubuntuforums.org/showthread.php?t=1141293)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:50:35.563

Javascript：没有。

上传期间：没有。

上传后，是的。

“Dev”在评论中提供了正确的链接，但您应该将视频保存到您的服务器，然后运行 ​​ffMpeg 来抓取图像。您可以在此处下载 ffMPEG：http://ffmpeg.org/download.html [（](http://ffmpeg.org/download.html)如果您对自己构建没有信心，请获取所需的构建 - 有 Linux 和 Windows 构建）。

文档在这里： http: [//ffmpeg.org/ffmpeg.html但是在](http://ffmpeg.org/ffmpeg.html)[http://linuxers.org/tutorial/how-extract-images-video-using-ffmpeg](http://linuxers.org/tutorial/how-extract-images-video-using-ffmpeg)有一个更容易阅读的教程来获取一个图片。

注意：有一个 PHP 扩展名为“phpFFMPEG”，但我建议你不要使用它。只需通过 PHP 中的“exec()”运行所需的命令。检查错误返回值，因为每个 CPU 内核只能运行一次 ffMPEG，因此如果同时尝试两次，它可能会失败 - 将操作排队或在失败时重试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T16:16:54.093

首先，您需要选择一个程序来提取框架。ffmpeg 通常用于此目的。无论您选择什么，它都需要能够处理部分文件内容。

php脚本直到整个文件上传完成后才开始执行，但是php最近有了一个功能，可以在文件上传期间执行*不同*的php脚本，并且能够获取上传脚本数据（文件名是事情你感兴趣）。 [http://php.net/manual/en/session.upload-progress.php](http://php.net/manual/en/session.upload-progress.php)

然后，基本上调用外部程序从监控脚本中提取帧，使用上传处理脚本中上传的临时文件名。

总结：将文件上传到`upload.php`. `monitor.php`将获取正在上传的临时文件名`upload.php`，并提取框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-31T01:55:02.720

基本上，我采用了此线程中提供的 rodrigo-silveira 答案并对其进行了修改以供我使用，现在该解决方案就像一个魅力。即使我试图上传用户希望上传的视频的视频缩略图/海报，并将视频和缩略图保存在文件夹中。另外，我不想使用ffmpeg。

这是我所做的：在名为“upload.php”的上传文件中，我有以下代码，对上面的rodrigo-silveira的解决方案稍作修改：

上传.php：

```
<input type="file" id="upload"/>
<img id="thumbnail"/>

<form action="action_page.php" method="post" target="_blank">
<input type="hidden" id="mytext" name="mytext" >
<input type="submit" value="Submit">
</form>
```

```
<script>
var input = document.getElementById('upload');
var img = document.getElementById('thumbnail');

input.addEventListener('change', function(event){
    var file = this.files[0];
    var url = URL.createObjectURL(file);

    var video = document.createElement('video');
    video.src = url;

    var snapshot = function(){
        var canvas = document.createElement('canvas');
        var ctx = canvas.getContext('2d');
		canvas.width = 350;
		canvas.height = 250;
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        img.src = canvas.toDataURL('image/png');
		document.getElementById("mytext").value = img.src;
        video.removeEventListener('canplay', snapshot);
    };

    video.addEventListener('canplay', snapshot);
});
</script>
```

上面的 HTML 部分和 JavaScript 都在 upload.php 的 body 标记中。

现在进入 action_page.php 文件：

```
<?php
$data = $_POST['mytext'];
$file = "photos/file".time().".png";
$uri = substr($data,strpos($data, ",") + 1);
file_put_contents($file, base64_decode($uri));
?> 
```

将两个 PHP 文件保存在同一个文件夹中，并在该文件夹中创建另一个名为“photos”的文件夹。您在 upload.php 页面中选择的视频中的视频缩略图/海报图像将作为 png 文件保存在“照片”文件夹中。（注意：此解决方案不上传视频，只上传视频缩略图。但从这里开始就很简单了。）

# backbone.js - Backbone general router vs. separate routing files?

> ID：11261449
> 
> 赞同：0
> 
> 时间：2012-06-29T12:04:54.797
> 
> 标签：backbone.js, requirejs

I found that most tutorials use one big router. For example: [https://github.com/thomasdavis/backboneboilerplate/blob/gh-pages/js/router.js](https://github.com/thomasdavis/backboneboilerplate/blob/gh-pages/js/router.js)

Wouldn't it be better to separate the routes (controllers) into separate files?

If yes how can I combine this with requirejs?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:28:57.217

I think this is a question of preference. If you're doing a ginormous application with gazillion routes, then dividing your routers up is sensible. For small applications having just one big router is just fine.

If you decide to have multiple routers, make sure you don't have conflicting routes, so there won't be any unexpected behavior or errors.

So with requireJS: I think the best way would be to define each router in it's own file like this

```
define([blaa, blaa], function(Blaa, Blaa) {

  var SubRouter1 = Backbone.Router.extend({

    // work your routing magic here, remember to make no conflicting routes

  });

  return SubRouter1;
}); 
```

When you have all your desired routers set up you can bundle them up in the `app.js`

```
define([...,'subrouter1', 'subrouter2', ... , 'subrouterN', ...],
function(..., SubRouter1, SubRouter2, ... , SubRouterN, ...) {

  // work your app magic here

  initialize: function() { // or wherever you start your application
    subrouter1 = new SubRouter1();
    subrouter2 = new SubRouter2();
    ...
    ...
    subrouterN = new SubRouterN();
    Backbone.history.start(); // remember to start the history 
  },

  // maybe work some more magic?
}); 
```

I've never done this myself, but I don't see why it wouldn't work if you keep the routes from conflicting. Hopefully this clears stuff for you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T08:53:58.490

check [Backbone.js "fat router" design conundrum](https://stackoverflow.com/questions/14185909/backbone-js-fat-router-design-conundrum) out : you can find @jakee answer there and some more options

# iphone - Drawrect 与 CGBitmapContext 太慢了

> ID：11261450
> 
> 赞同：5
> 
> 时间：2012-06-29T12:05:21.397
> 
> 标签：iphone, objective-c, ios, ipad, drawrect

所以我有一个基本的绘图应用程序可以让我画线。我绘制到屏幕外位图，然后将图像呈现在`drawRect`. 它可以工作，但是太慢了，在你用手指绘制后大约半秒更新。我从本教程[http://www.youtube.com/watch?v=UfWeMIL-Nu8&feature=relmfu](http://www.youtube.com/watch?v=UfWeMIL-Nu8&feature=relmfu)中获取了代码并对其进行了改编 ，正如您在评论中看到的那样，人们也说它太慢了，但那家伙没有t 回应。

那么我怎样才能加快速度呢？或者有更好的方法吗？任何指针将不胜感激。

这是我的`DrawView.m`.

```
-(id)initWithCoder:(NSCoder *)aDecoder {
     if ((self=[super initWithCoder:aDecoder])) {
         [self setUpBuffer];
     }

     return self;
}

-(void)setUpBuffer {
     CGContextRelease(offscreenBuffer);

     CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

     offscreenBuffer = CGBitmapContextCreate(NULL, self.bounds.size.width, self.bounds.size.height, 8, self.bounds.size.width*4, colorSpace, kCGImageAlphaPremultipliedLast);
     CGColorSpaceRelease(colorSpace);

     CGContextTranslateCTM(offscreenBuffer, 0, self.bounds.size.height);
     CGContextScaleCTM(offscreenBuffer, 1.0, -1.0);
}

-(void)drawToBuffer:(CGPoint)coordA :(CGPoint)coordB :(UIColor *)penColor :(int)thickness {

     CGContextBeginPath(offscreenBuffer);
     CGContextMoveToPoint(offscreenBuffer, coordA.x,coordA.y);
     CGContextAddLineToPoint(offscreenBuffer, coordB.x,coordB.y);
     CGContextSetLineWidth(offscreenBuffer, thickness);
     CGContextSetLineCap(offscreenBuffer, kCGLineCapRound);
     CGContextSetStrokeColorWithColor(offscreenBuffer, [penColor CGColor]);
     CGContextStrokePath(offscreenBuffer);

}

- (void)drawRect:(CGRect)rect {
    CGImageRef cgImage = CGBitmapContextCreateImage(offscreenBuffer);
    UIImage *image =[[UIImage alloc] initWithCGImage:cgImage];
    CGImageRelease(cgImage);
    [image drawInRect:self.bounds];

} 
```

在模拟器上完美运行，但不是设备，我想这与处理器速度有关。

我正在使用ARC。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T13:50:57.297

我试图修复您的代码，但是由于您似乎只发布了其中的一半，因此我无法使其正常工作（复制+粘贴代码会导致很多错误，更不用说开始对其进行性能调整了）。

但是，您可以使用一些技巧来极大地提高性能。

第一个，可能也是最引人注目的，是-setNeedsDisplayInRect：而不是-setNeedsDisplay。这意味着它只重绘改变的小矩形。对于具有 1024*768*4 像素的 iPad 3 来说，工作量很大。将每帧的大小减少到大约 20*20 或更少将*大大*提高性能。

```
CGRect rect;
rect.origin.x = minimum(coordA.x, coordB.x) - (thickness * 0.5);
rect.size.width = (maximum(coordA.x, coordB.x) + (thickness * 0.5)) - rect.origin.x;
rect.origin.y = minimum(coordA.y, coordB.y) - (thickness * 0.5);
rect.size.height = (maximum(coordA.y, coordB.y) + (thickness * 0.5)) - rect.origin.y;
[self setNeedsDisplayInRect:rect]; 
```

您可以进行的另一项重大改进是仅绘制当前触摸的 CGPath（您可以这样做）。但是，然后您在绘图矩形中绘制该保存/缓存的图像。所以，再一次，它在每一帧都被重绘。更好的方法是让绘图视图透明，然后在其后面使用 UIImageView。UIImageView 是在 iOS 上显示图像的最佳方式。

```
- DrawView (1 finger)
   -drawRect:
- BackgroundView (the image of the old touches)
   -self.image 
```

然后，绘制视图本身只会绘制当前触摸每次都更改的部分。当用户抬起手指时，您可以将其缓存到 UIImage，将其绘制在当前背景/缓存 UIImageView 的图像上并将 imageView.image 设置为新图像。

组合图像时的最后一点涉及将 2 个全屏图像绘制到屏幕外的 CGContext 中，因此如果在主线程上完成会导致延迟，而这应该在后台线程中完成，然后将结果推送回主线程。

```
* touch starts *
- DrawView : draw current touch
* touch ends *
- 'background thread' : combine backgroundView.image and DrawView.drawRect
    * thread finished *
    send resulting UIImage to main queue and set backgroundView.image to it;
    Clear DrawView's current path that is now in the cache; 
```

所有这些结合起来可以制作一个非常流畅的 60fps 绘图应用程序。然而，视图的更新速度并没有我们想要的那么快，因此在快速移动图形时绘制的图形看起来参差不齐。这可以通过使用 UIBezierPath 而不是 CGPath 来改进。

```
CGPoint lastPoint = [touch previousLocationInView:self];
CGPoint mid = midPoint(currentPoint, lastPoint);
-[UIBezierPath addQuadCurveToPoint:mid controlPoint:lastPoint]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-02T08:41:47.813

它之所以慢是因为每一帧你都在创建一个位图并试图绘制它。

您要求更好的方法吗？您是否查看过[iOS 上绘图应用程序的 Apple 示例代码](http://developer.apple.com/library/ios/#samplecode/GLPaint/Introduction/Intro.html)？如果你不喜欢这样，那么你总是可以使用[cocos2d](http://www.cocos2d-iphone.org/)，它提供了一个 CCRenderTexture 类（和示例代码）。

目前，您正在使用一种您已经知道效率不高的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-03T22:41:26.863

使用这种方法，我想您应该考虑将后台线程用于图像渲染的所有艰苦工作，而将主线程仅用于 UI 更新，即

```
__block UIImage *__imageBuffer = nil;

- (UIImage *)drawSomeImage
{
    UIGraphicsBeginImageContext(self.bounds);

    // draw image with CoreGraphics

    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();

    return image;
}

- (void)updateUI
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

        // prepare image on background thread

        __imageBuffer = [self drawSomeImage];

        dispatch_async(dispatch_get_main_queue(), ^{

            // calling drawRect with prepared image

            [self setNeedsDisplay];

        });
    });
}

- (void)drawRect
{
    // draw image buffer on current context

    [__imageBuffer drawInRect:self.bounds];
} 
```

我省略了一些细节以使优化更加清晰。切换到`UIImageView`. 这样，您可以摆脱至关重要的方法并在图像准备好时`- (void)drawDect`更新图像属性。`UIImageView`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T09:55:21.847

那么我认为你需要改变你的逻辑。借助此链接 [http://devmag.org.za/2011/04/05/bzier-curves-a-tutorial/](http://devmag.org.za/2011/04/05/bzier-curves-a-tutorial/) ，您可能会得到一些非常好的想法，如果您认为您没有时间理解，那么您可以直接访问此代码[https://github.com/levinunnink/Smooth-Line-View](https://github.com/levinunnink/Smooth-Line-View) :) 我希望这会对您有很大帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T13:37:43.400

使用 CgLayer 缓存路径，阅读文档，它最适合优化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T19:08:00.620

无论您建议的方法是什么，效率都太低了，因为每次移动手指时都创建图像是不合适的。

如果它只是您需要绘制的路径，则将 a`CGMutablePathref`作为成员变量，并在 draw rect 中使用`CGPath`函数移动到指定点。

更重要的是，在刷新视图时，调用`setNeedsDisplayInRect`只传递您需要绘制的区域。希望它对你有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-06T07:52:28.830

我做了完全一样的事情。查看 AppStore 上的 Pixelate 应用程序。为了绘图，我在代码中使用了瓷砖。毕竟，当您触摸屏幕并绘制一些东西时，您需要重新绘制整个图像，这是一个非常繁重的操作。如果你喜欢 Pixelate 的移动方式，我是这样做的：

1）在 nxm 瓷砖中分割我的图像。这样我就可以更改这些值并获得更大/更小的图块。在最坏的情况下（用户点击 4 个图块的交叉点），您必须重新绘制这 4 个图块。不是整个图像。

2）制作一个 3 维矩阵，我在其中存储每个图块的像素信息。`matrix[0][0][0]`第一个图块的第一个像素的红色值（每个像素都有一个 RGB 或 RGBA 值，具体取决于您使用的是 png 还是 jpg）也是如此。

3）获取用户按下的位置并计算需要修改的图块。

4）修改矩阵中的值，更新需要更新的瓦片。

注意：这肯定不是最好的选择。这只是一个替代方案。我提到它是因为我认为它与您现在所拥有的很接近。它在 iPhone 3GS 上对我有用。如果您的目标是 >= iPhone 4 ，那么您应该没问题。

问候，

乔治

# java - 是否可以重新绑定已经绑定的套接字？

> ID：11261465
> 
> 赞同：2
> 
> 时间：2012-06-29T12:06:11.833
> 
> 标签：java, sockets, networking

这就是我想要做的：

```
+--------+                          +--------+
|        |                          |        |
| Server |---+                  +---| Client |
|        |   |                  |   |        |
+--------+   |                  |   +--------+
             |                  |
+--------+   |   +--------+     |   +--------+
|        |   |   |        |     |   |        |
| Server |---+---+  Proxy +-----+---+ Client |
|        |   |   |        |     |   |        |
+--------+   |   +--------+     |   +--------+
             |                  |
+--------+   |                  |   +--------+
|        |   |                  |   |        |
| Server |---+                  +---| Client |
|        |                          |        |
+--------+                          +--------+ 
```

服务器将连接到代理服务器，然后客户端将连接代理服务器并请求重定向到连接的服务器之一。例如，Client1 想要重定向到 Server3。我的问题是，一旦连接了客户端，我想将它反弹到另一个服务器。一旦绑定了套接字，您将无法对其进行反弹。有没有办法解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:24:30.040

鉴于套接字 API 的假设，您是正确的，连接保持绑定直到它关闭。

你的两个选择是

1.  在客户端和服务器中编写元协议以具有虚拟连接，该连接使用多个套接字来模拟跨越多个服务器的持久连接（硬）
2.  有一个智能代理来终止客户端套接字并根据需要连接到服务器，并假装它不存在到其他端点（根据您的代理服务，难度较小或已经为您完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T12:35:03.713

我会一直使用代理 <-> 客户端连接。如果需要连接另一台服务器，只需关闭 Proxy <-> Server1 连接，然后再创建一个 Proxy <-> Server2。这样，客户端不必断开连接，重新连接到另一台服务器将是无缝的。

# google-chrome - 图例中的项目顺序错误（谷歌浏览器问题）

> ID：11261466
> 
> 赞同：0
> 
> 时间：2012-06-29T12:06:12.807
> 
> 标签：google-chrome, highcharts

当我使用 Google Chrome 浏览器并且有 10 件以上的物品时，我在传说中的物品顺序有问题。在所有其他浏览器中，项目以适当的顺序显示，但在 Chrome 中 - 不是。

版本：Highcharts JS v2.1.6 (2011-07-08) Chrome 版本：19.0.1084.56 和 20.0.1132.47

图表如下所示：

![在此处输入图像描述](../Images/cd9501d4e162cc969a5c8c5b46fdd06e.png)

请看以下代码：

```
<html>
<head>
    <script type="text/javascript" src="jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="highcharts.js"></script>
</head>
<body>
<script type="text/javascript">
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'chart',
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
            },
            plotOptions: {
                pie: {
                    size: '80%',
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: false,
                        color: '#000000',
                        connectorColor: '#000000',
                        distance: 10                
                    },
                showInLegend: true
                }
            },
            legend: {
                itemWidth: 100
            },
            series: [{
                type: 'pie',
                data: [
                            ['label1', 10],        
                            ['label2', 20],
                            ['label3', 30],
                            ['label4', 40],
                            ['label5', 155.89],
                            ['label6', 50],
                            ['label7', 60],
                            ['label8', 70],
                            ['label9', 80],
                            ['label10', 90],
                            ['label11', 65.70],
                            ['label12', 100],
                    ]
                }]
            });
        });

</script>
<div id="chart" style="width: 460px; height: 290px; margin: 0 auto">

    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:08:01.187

解决方案：将 highcharts 库更新到 2.2.5。

# c# - 为什么在一个 Combo 中更改 SelectedItem 会更改所有其他 Combo？

> ID：11261468
> 
> 赞同：9
> 
> 时间：2012-06-29T12:06:26.677
> 
> 标签：c#, winforms, combobox

我以这种方式填充了组合框

```
foreach (Control c in this.Controls)
{
     if (c is ComboBox)
     {
         (c as ComboBox).DataSource = DataSet1.Tables[0];
         (c as ComboBox).DisplayMember = "Articles";
     }
} 
```

但是，问题是当我在一个 Combo 中更改 SelectedItem 时 - 它在所有其他 Combo 中都发生了变化？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-29T12:14:30.020

将它们分别绑定到 DataSet1.Table[0] 的单独实例。

IE）

```
foreach (Control c in this.Controls)
{
    if (c is ComboBox)
    {
        DataTable dtTemp = DataSet1.Tables[0].Copy();
        (c as ComboBox).DataSource = dtTemp 
        (c as ComboBox).DisplayMember = "Articles";
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-29T20:33:02.010

更好的方法是使用[DataView](http://msdn.microsoft.com/en-us/library/system.data.dataview.aspx)来避免重复数据。另外，如果可以避免的话，不要多次施放。

```
foreach (Control c in this.Controls)
{
    ComboBox comboBox = c as ComboBox;

    if (comboBox != null)
    {        
        comboBox.DataSource = new DataView(DataSet1.Tables[0]);
        comboBox.DisplayMember = "Articles";
    }
} 
```

**编辑**

我刚刚意识到你可以用 LINQ 更干净地做到这一点

```
foreach (ComboBox comboBox in this.Controls.OfType<ComboBox>())
{
    comboBox.DataSource = new DataView(DataSet1.Tables[0]);
    comboBox.DisplayMember = "Articles";
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-09T13:59:49.413

我遇到了同样的问题，但我正在使用泛型。我已经使用组合框的绑定上下文来摆脱它。（当您不知道绑定列表的大小时非常有用 - 在您的情况下它是 5 个项目）

在下面的代码中，DisplayBindItem 只是一个具有 Key 和 Value 的类。

```
 List<DisplayBindItem> cust = (from x in _db.m01_customers
            where x.m01_customer_type == CustomerType.Member.GetHashCode()
            select new DisplayBindItem
            {
                Key = x.m01_id.ToString(),
                Value = x.m01_customer_name
            }).ToList();

    cmbApprover1.BindingContext = new BindingContext();
    cmbApprover1.DataSource = cust;
    cmbApprover1.DisplayMember = "Value";
    cmbApprover1.ValueMember = "Key";

    //This does the trick :)
    cmbApprover2.BindingContext = new BindingContext();
    cmbApprover2.DataSource = cust ;
    cmbApprover2.DisplayMember = "Value";
    cmbApprover2.ValueMember = "Key"; 
```

该类供您参考。

```
 public class DisplayBindItem
    {
        private string key = string.Empty;

    public string Key
    {
        get { return key; }
        set { key = value; }
    }
    private string value = string.Empty;

    public string Value
    {
        get { return this.value; }
        set { this.value = value; }
    }

    public DisplayBindItem(string k, string val)
    {
        this.key = k;
        this.value = val;
    }

    public DisplayBindItem()
    { }
} 
```

如果这解决了您的问题，请标记为答案。

# liferay - 如何仅为超级用户角色禁用控制面板的“我的帐户”Portlet

> ID：11261469
> 
> 赞同：1
> 
> 时间：2012-06-29T12:06:26.347
> 
> 标签：liferay, role

我想为角色或我的自定义用户禁用（删除访问） `Control Panel > My Account`portlet 。`Power-user`

它应该显示为`Administrator`角色。是否有任何门户属性或其他配置？

还是我们需要通过编码来实现某些目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T15:30:54.903

我不确定其他答案中的程序是否有效。我对 6.0.6 版本表示怀疑。

另一种方法是从 Liferay 中删除 My Accounts portlet。为此，请`liferay-portlet.xml`在其中打开文件`<Liferay>/webapps/ROOT/WEB-INF/`并删除带有 portlet-name 2 的 portlet 条目。

注意：如果您这样做：任何用户都无法查看此 Portlet。但是管理员可以查看用户 portlet，并且可以在该位置更改他们的帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T14:44:22.193

为此，我建议您执行以下操作：

1) 进入控制面板
2) 转到“门户”部分下的“角色”
3) 转到高级用户角色（或您要更改的任何其他角色）的“操作”->“定义权限”
4)单击要从该角色中删除的所有权限旁边的“删除”。

在 portal-ext.properties 中更改它们将为所有用户更改它们，因此这是您最好的方法。

# java - 自定义 ArrayList 搜索问题？

> ID：11261472
> 
> 赞同：1
> 
> 时间：2012-06-29T12:06:45.333
> 
> 标签：java, android, list, arraylist

我创建了一个如下所示的数据结构

```
public class LogList {
    public int _id;
    public boolean Checked;
    public LogList(int name, boolean status) {
        this._id = name;
        this.Checked = status;
    }
    public LogList(int name) {
        this._id = name;
    }
    public LogList() {
    }
    public int get_id() {
        return _id;
    }
    public void set_id(int _id) {
        this._id = _id;
    }
    public boolean isChecked() {
        return Checked;
    }
    public void setChecked(boolean checked) {
        Checked = checked;
    }
} 
```

现在我已经使用这个数据结构创建了一个 ArrayList

```
loglist = new ArrayList<LogList>(); 
```

现在我正在向它添加项目

```
l = new 
LogList(Integer.parseInt(mCursor.getString(mCursor.getColumnIndex("_id"))),false);                          
loglist.add(l); 
```

现在我想在**ArrayList**中的 Checked 字段的当前值中搜索相应的**_id**字段我怎么能找到它

我使用它返回**-1**作为索引。

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    mCursor.moveToPosition(position);
    View Lv = null;
    try {
    if (convertView == null) {
    LayoutInflater vi = (LayoutInflater) mContext
        .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    convertView = vi.inflate(R.layout.loglist, parent, false);
    Lv = convertView;
    } else {
    Lv = (TableRow) convertView;
    _id = (TextView) Lv.findViewById(R.id.txt_id);
    _title = (TextView) Lv.findViewById(R.id.txt_title);
    _sym = (TextView) Lv.findViewById(R.id.txt_sym);
    _amt = (TextView) Lv.findViewById(R.id.txt_amt);
        _date = (TextView) Lv.findViewById(R.id.txt_date);
    _time = (TextView) Lv.findViewById(R.id.txt_time);
    _remarks = (TextView) Lv.findViewById(R.id.txt_remark);
    _sym.setText("Rs.");
         chk = (CheckBox) Lv.findViewById(R.id.chk);
    _id.setText(mCursor.getString(mCursor.getColumnIndex("_id")));
    _title.setText(mCursor.getString(mCursor
        .getColumnIndex("Title")));
    _amt.setText(mCursor.getString(mCursor.getColumnIndex("Amt")));
    _date.setText(mCursor.getString(mCursor.getColumnIndex("Date")));
    _time.setText(mCursor.getString(mCursor.getColumnIndex("Time")));
    _remarks.setText(mCursor.getString(mCursor
            .getColumnIndex("remark")));
    boolean status = true;

/// this snippet is used to search item in list

    LogList ll = new LogList();
    ll._id = Integer.parseInt(mCursor.getString(mCursor
        .getColumnIndex("_id")));
    int index = myList.indexOf(ll);
    LogList myLogList = new LogList();
    myLogList = myList.get(index);
    if (myLogList.isChecked()) {
        status = true;
    } else {
            status = false;
    }
                chk.setChecked(status);
    }
    } catch (Exception ex) {
            ex.printStackTrace();
    }
return Lv;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:24:45.497

> ArrayList 的 indexOf 方法不适用于自定义对象，除非它们覆盖

`public boolean equals(Object obj)`

**您必须在 LogList 中覆盖 equals ，然后只有 ArrayList 会返回正确的索引。**

因此，将您的代码更改为以下。

```
public class LogList {
    public int _id;
    public boolean Checked;

    public LogList(int name, boolean status) {
        this._id = name;
        this.Checked = status;
    }

    public LogList(int name) {
        this._id = name;
    }

    public LogList() {
    }

    public int get_id() {
        return _id;
    }

    public void set_id(int _id) {
        this._id = _id;
    }

    public boolean isChecked() {
        return Checked;
    }

    public void setChecked(boolean checked) {
        Checked = checked;
    }

    @Override
    public boolean equals(Object obj) {
        if (this._id == ((LogList) obj)._id)
            return true;
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:10:02.203

我想你忘了`mCursor.moveToFirst();`

```
LogList ll = new LogList();
mCursor.moveToFirst(); <<<add here...
ll._id = Integer.parseInt(mCursor.getString(mCursor.getColumnIndex("_id"))); 
```

# iphone - 在 uitableviewcell 中拉出更多单元格

> ID：11261473
> 
> 赞同：0
> 
> 时间：2012-06-29T12:06:45.993
> 
> 标签：iphone, uitableview, xcode4.2, ios5

我创建了基于导航的应用程序。在我的带有更多部分的表格视图中，我想在一个已经有 4 个单元格的部分中拉出更多单元格，最后一个单元格在**我单击**在该部分的最后一个单元格中添加更多单元格后添加动作单元格，例如**加载更多单元格**，我想拉另外 4 个单元格，但我希望再次拉出该部分中的相同单元格。即**重复的 4 个单元格将与已经存在的单元格相同**。我为此研究了很多样本​​，对我来说没有一个是清楚的。任何人都可以解释一下我可以拉相同类型的细胞吗？提前致谢。

# java - 为什么 Guava 的 TypeToken .getRawType() 返回 Class而不是 Class

> ID：11261476
> 
> 赞同：10
> 
> 时间：2012-06-29T12:06:53.510
> 
> 标签：java, generics, guava

来自 Effective Java Second Edition，第 28 条：“不要使用通配符类型作为返回类型。与其为您的用户提供额外的灵活性，不如强制他们在客户端代码中使用通配符类型。”

```
public final Class<? super T> getRawType() 
```

我刚刚开始掌握通用通配符，以了解我正在编写的一段代码中最后一个未经检查的强制转换警告，但我不明白为什么 getRawType() 返回通配符类型。

```
class Base<T>{}
class Child<T> extends Base<T>{}

public <C> void test (TypeToken<? extends Base<C>> token) {
    Class<? extends Base<C>> rawType = (Class<? extends Base<C>>) token.getRawType();
} 
```

我必须转换 token.getRawType() 因为它返回一个

```
Class<? super ? extends Base<C>> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T18:40:06.290

如果您有 a`TypeToken<ArrayList<String>>`并且想要获得`Class<ArrayList>`（即*原始*类型）怎么办。如果它返回`Class<T>`，那么它会返回`Class<ArrayList<String>>`，这不是`Class<ArrayList>`你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:57:12.517

如果“token”的泛型类型是 Type 类（即如果 S 在

```
TypeToken<S> 
```

是一个 java.lang.reflect.Type 类），然后 TypeToken.getRawType() 将返回与 S 关联的原始类型。它应该是一个 Class 对象，是 S 的父对象。

[请参阅TypeToken](http://code.google.com/p/google-gson/source/browse/trunk/src/main/java/com/google/gson/reflect/TypeToken.java?r=2)的源代码。

在某些情况下（例如有多个边界），实现的策略将不起作用并且具有原始类型是可以的：原始类型将是 Object.class

参见例如[MoreTypes](http://code.google.com/p/google-guice/source/browse/core/src/com/google/inject/internal/MoreTypes.java?r=dfee9fd5f78c5f1f769713b603e4e92a0b7b01e3)：

```
public static Class<?> getRawType(Type type) {
...
} else if (type instanceof TypeVariable) {
  // we could use the variable's bounds, but that'll won't work if there are multiple.
  // having a raw type that's more general than necessary is okay  
  return Object.class;

} else {
...
} 
```

# wcf - Silverlight 4 应用程序和 Web 应用程序的单点登录

> ID：11261477
> 
> 赞同：0
> 
> 时间：2012-06-29T12:06:54.630
> 
> 标签：wcf, silverlight

我有 2 个不同的应用程序，一个在 Silverlight 中，另一个是 Web 应用程序。

我需要两者的单点登录。

场景就像：任何用户登录到 Silverlight 应用程序，然后该应用程序中有一个菜单可以在登录模式下打开另一个 Web 应用程序。

两个应用程序都有不同的数据库，但两者的用户名和密码相同。

我正在为 silverlight 应用程序使用 WCF 服务。

有人可以提出解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:17:16.613

我假设您正在使用 ASP.NET 和 Forms/其他身份验证，并且 Silverlight 应用程序来自同一个 Web 服务器。

首先看一下这个链接和来自 Visual Studio 的 Silverlight Business 应用程序模板：http://msdn.microsoft.com/en-us/library/ee942449(v=VS.91).aspx

更手动的方法可能包括编写 WCF 服务，该服务在成功登录时返回或设置您在会话中存储的“UserToken”。

```
// the wcf service needs these attributes
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
[ServiceBehavior(InstanceContextMode = InstanceContextMode.PerSession)]

// a manual approach: successful login, create a webservice method to call from Silverlight to set the authentication
HttpContext.Current.Session.Add("currentUserToken", userToken);
FormsAuthentication.SetAuthCookie(this.EmailAddressUserControl1.EmailAddressTextBox.Text, false); 
```

Forms Authentication 将负责将您从 ASP.Net 请求中注销，但您必须自己处理一个服务请求的会话超时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:12:36.883

在我看来，您应该使用一个数据库来为每个登录的用户保留当前会话的令牌。在这种情况下，您登录的位置并不重要，您将从该数据库获取登录令牌。

# c# - 未处理的异常：System.Runtime.InteropServices.COMException (0x80080005)：

> ID：11261478
> 
> 赞同：0
> 
> 时间：2012-06-29T12:06:59.047
> 
> 标签：c#, condor

我做了打开 ms word 的 c# 代码，它运行正确。我想在 condor 环境中运行这个程序，但我遇到了一个错误，说..

```
Unhandled Exception: System.Runtime.InteropServices.COMException (0x80080005): Retrieving the COM class factory for component with CLSID {000209FF-0000-0000-C000-000000000046} failed due to the following error: 80080005.
   at Console_try.Program.open_document(String pwd, String file_name)
   at Console_try.Program.Generate_small(String pwd, Int32 pos, Int32 siz, String file_name)
   at Console_try.Program.Generate_small(String pwd, Int32 pos, Int32 siz, String file_name)
   at Console_try.Program.Generate_small(String pwd, Int32 pos, Int32 siz, String file_name)
   at Console_try.Program.Main(String[] args). 
```

我认为这个错误属于 MS Visual Studio C#。

# php - 访问其他域中的文件

> ID：11261479
> 
> 赞同：0
> 
> 时间：2012-06-29T12:07:00.873
> 
> 标签：php, apache, file, cpanel, whm

很简单，我有：

`domain1.com` `domain2.com`

在**cPanel/WHM 专用服务器上设置**

我想从 to 访问图像`domain1.com`，`domain2.com`但不使用完整的 http 路由

而不是这个

`<img src="http://www.domain1.com/files/image1.jpg" />`

我想做这个：

`<img src="../../domain1/public_html/files/image1.jpg" />`

**我该怎么做呢？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:20:58.157

可以做到……但前提是两个域都在同一台服务器上。

在 Linux/BSD（或任何 *nix）服务器上，您可以设置在 domain2 www 目录中创建符号链接到 domain1 中的实际目录。

如果您使用 Apache，则可以使用 .htaccess 透明地重定向请求。但这有点困难，并且可能不适用于所有 Apache 安装。

通过这两种解决方案，您最终会得到使 domain1 看起来像 domain2 的子目录的 URL。例如：

```
<img src="/domain1/files/image1.jpg" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:18:32.707

创建指向文件目录的符号链接。

```
ln -s path-to-actual-folder name-of-link 
```

要确认，请执行以下操作：

```
ls -ld name-of-link 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:08:30.927

图像的`src`属性需要**公共**HTTP 地址，而不是磁盘上的物理文件位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T12:10:58.630

这是做不到的。您必须为图像源提供 http 路径。像文档这样的图像源中的文件位置地址 `/path/to/file/in/the/system` 永远不会起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T12:11:06.207

*除非您使用 Apache 配置仅*通向该映像目录的虚拟主机，否则这是不可能的。正如格雷格所说，该标签需要一个公共网址。

# php - 有没有办法在 PHP 5.4 旁边运行 PHP 5.3

> ID：11261485
> 
> 赞同：3
> 
> 时间：2012-06-29T12:07:29.773
> 
> 标签：php, apache, ubuntu, windows-7, xampp

有没有办法在 PHP 5.4 下运行 PHP 5.3？我希望它在 apache 下同时运行。我想在 Windows 7（使用 Xampp）和 Ubuntu 12.04 上这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:17:57.257

你能用这个链接检查一下。这里他们说关于运行多个 PHP 实例。不知道它是否适用于Windows。你能检查一下吗。

[PHP 多个](http://wiki.gentoo.org/wiki/PHP)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T15:23:17.820

您可以使用 CGI 在 Apache 上运行 PHP，并通过更改 CGI 可执行文件的路径并重新启动 Apache 在版本之间切换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T15:14:40.843

可以安装多个版本的 PHP。使用 IIS，从一个交换到另一个是相当容易的，而且在 Apache 中也应该可以做到这一点。但是我不知道一个网络服务器如何同时支持多个实例。

希望这些链接会有所帮助：

[如何在](http://blog.servergrove.com/2011/08/22/how-to-setup-multiple-php-versions-on-apache/)
[运行多个 Apache 实例的 Apache 上设置多个 PHP 版本](http://wiki.apache.org/httpd/RunningMultipleApacheInstances)

# objective-c - 将 NSMutableArray 从一个视图控制器传递到另一个视图控制器中的函数

> ID：11261486
> 
> 赞同：0
> 
> 时间：2012-06-29T12:07:30.357
> 
> 标签：objective-c, ios, nsmutablearray, nsarray

我在这里阅读了关于在两个视图控制器之间传递数据的几个问题，并看到了建议的不同方式。我的问题如下：

我有一个在工具栏中有一个搜索栏的视图控制器（我们称之为“A”）。没有其他的。然后我有另一个视图控制器（“B”），当用户在搜索栏中搜索时按下键盘上的搜索按钮时，它负责显示弹出视图。这一切都有效。用户输入文本，按下搜索按钮，弹出框就会显示出来。伟大的。

现在我还没有在弹出表视图中显示任何搜索结果，并试图将 a 作为参数传递 `NSMutableArray`给 B 中的函数：

单位：

```
@property (nonatomic, retain) NSMutableArray *searchResults; 
```

在 Bm 中：

```
 @synthesize searchResults;

     -(void)setSearchResults:(NSMutableArray *)resultArray{
         [self.searchResults removeAllObjects];
         [self.searchResults addObjectsFromArray:resultArray];
     } 
```

在啊：

```
#import "B.h"
@property(nonatomic, retain) B *viewControllerObjectB; 
```

在上午：

```
@synthesize viewControllerObjectB;

 //The searchResultsArray is passed on from another function
-(void)communicateWithB:(NSMutableArray *)searchResultsArray{

    //I initialize the viewControllerObjectB in here

    NSMutableArray *temp = [[NSMutableArray alloc] initWithArray:searchResultsArray];
    [viewControllerObjectB setSearchResults:temp];
} 
```

现在这一切都有效，除了我没有将 temp 的内容传递到 Bm 中的函数中，我是空的（nil）。这是我的问题。

我对 iOS 还很陌生，因此我们将不胜感激。

编辑：忘了提到我正在使用ARC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:35:32.593

你没有初始化你的数组（这就是它为零的原因）。所以在 alloc 方法中你应该：

```
- (id)init {
    self = [super init];

     if (self) {
          self.searchResults = [NSMutableArray arrayWithCapacity:10];
     }
} 
```

我还在您的代码中发现了 2 个问题：

```
@synthesize searchResults;

     -(void)setSearchResults:(NSMutableArray *)resultArray{
         //PROPERTY LOGIC IS RETAIN, SO YOU NEED TO RELEASE/RETAIN WHEN YOU OVERRIDE A SETTER
         if (searchResults != resultArray) {
              [searchResults release];
              searchResults = [resultArray retain];
         }
     }

-(void)communicateWithB:(NSMutableArray *)searchResultsArray{

    //I initialize the viewControllerObjectB in here
    //MEM. LEAK ON TEMP
    NSMutableArray *temp = [[[NSMutableArray alloc] initWithArray:searchResultsArray] autorelease];
    [viewControllerObjectB setSearchResults:temp];
} 
```

# c - 如何在一行中初始化一个复杂的 C 结构？

> ID：11261487
> 
> 赞同：4
> 
> 时间：2012-06-29T12:07:31.137
> 
> 标签：c, arrays, struct, initialization

我有一个结构：

```
typedef struct stock {
  const char* key1p2;    // stock code
  const char* key2p2;    // short desc
  const char* desc1;     // description
  const char* prod_grp;  // product group
  const char dp_inqty;   // decimal places in quantity
  const long salprc_u;   // VAT excl price
  const long salprc_e;   // VAT includive price
  const long b_each;     // quantity in stock
  const long b_alloc;    // allocated qty
  const char* smsgr_id;  // subgroup
  const char** barcodes; // barcodes
} stock_t; 
```

我想在每个股票结构的一行代码中初始化这个结构的实例数组。

我试过了：

```
stock_t data_stock[] = {
    { "0001", "Soup",  "Tomato Soup",     "71", 0, 100, 120, 10, 0, "",   {"12345", "23456", NULL} },
    { "0002", "Melon", "Melon and Ham",   "71", 0, 200, 240, 10, 0, "",   {"34567", "45678", NULL} },
    ...
    { NULL,   NULL,    NULL,              NULL, 0,   0,   0,  0, 0, NULL, NULL         }
}; 
```

但它失败了：

```
data.c:26:74: warning: incompatible pointer types initializing 'const char **' with an expression of type 'char [6]'
      [-Wincompatible-pointer-types]
  { "0001", "Soup",  "Tomato Soup",     "71", 0, 100, 120, 10, 0, "",   {"12345", "23456", NULL} },
                                                                         ^~~~~~~ 
```

有问题的是条形码字段，因为它是 char**。

（那是铿锵声，但 GCC 报告了类似的错误，但帮助不大。）

就好像编译器忽略了“12345”之前的大括号。

我可以使用以下方法解决该问题：

```
const char *barcodes0001[] = {"12345", "23456", NULL};

stock_t data_stock[] = {
  { "0001", "Soup",  "Tomato Soup",     "71", 0, 100, 120, 10, 0, "",   barcodes0001 }, 
```

这个问题的原因是 char *[] 和 char **之间的不同，还是有更微妙的东西。（也许您可以初始化结构数组，但不能初始化数组结构。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T12:11:20.507

并不是编译器*忽略*了您的大括号，而是您的大括号忽略了语言的语法规则。:)

该字段`barcode`是单个指针（指向指针，但这不是重点）。您需要提供一个有效的指针值，而您提供的大括号内容不匹配。

你也不能这样做：

```
struct foo {
  int a, b;
};

struct foo *pointer_to_foo = &{ 1, 2 }; /* Not valid code. */ 
```

这在逻辑上与您尝试做的事情相同。或者，删除`struct`，您也不能这样做：

```
int *pointer_to_a = &12; /* Not valid code. */ 
```

您分解`barcode`数据的解决方案就是这样做的方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T12:26:33.060

为了避免必须声明一个命名的虚拟变量，您可以使用*复合文字*

```
stock_t data_stock[] = {
    { "0001", "Soup",  "Tomato Soup",     "71", 0, 100, 120, 10, 0, "",   (const char*[]){"12345", "23456", NULL} },
    { "0002", "Melon", "Melon and Ham",   "71", 0, 200, 240, 10, 0, "",   (const char*[]){"34567", "45678", NULL} },
    ...
    { NULL,   NULL,    NULL,              NULL, 0,   0,   0,  0, 0, NULL, NULL         }
}; 
```

这是一种定义局部临时变量的方法，其语法`(type){ initializers }`自 c99 以来可用（clang 和 gcc 有它们）。

*编辑：*这些复合文字的生命周期与您的变量相同，`data_stock`所以我想这没关系。无论如何，我认为您应该将大部分字段也标记为`const`，例如`const char*const key1p2;`

此外，如果您使用*指定的初始化程序*，它会更 容易阅读

```
{ .keyp1 = "0001", ... } 
```

# php - PHP 包含文件使 JSON 数据无效

> ID：11261489
> 
> 赞同：0
> 
> 时间：2012-06-29T12:07:33.367
> 
> 标签：php, json

我对 php 开发相对较新，但对一般的 Web 开发并不陌生。

我有以下 php 文件：

```
<?php
class dialogResult{

    var $Message;
    var $Title;
    var $Height;
    var $GenericData;

     function __construct(){
        $this->Height = 10;
    }
}

   header("Cache-Control: no-cache", true);
   header("Content-type: application/json; charset=utf-8", true);
   $dr = new dialogResult();
   $dr->Message = "A Test Message encoded";
   $dr->Height = 10;
   $dr->GenericData = "Empty";
   $dr->Title = "My Message";
   echo(json_encode($dr));
?> 
```

这会按预期返回 JSON 数据，但是如果我将类移动到单独的文件并添加 include、include_once、require 或 require_once，则会返回无效的 JSON 数据。谁能告诉我为什么会这样？

它不必只是移动这个类，如果我有任何包含的文件，它会使数据无效。

谢谢，

基思

这是包含类，我也尝试过删除？>

```
<?php

class dialogResult{

    var $Message;
    var $Title;
    var $Height;
    var $GenericData;

     function __construct(){
        $this->Height = 10;
    }
} 
```

任何地方都没有前导或尾随空格。这是返回的“无效”JSON：

```
{"Message":"A Test Message encoded","Title":"My Message","Height":10,"GenericData":"Empty"} 
```

如果我尝试使用 JSONLint 解析它，这会给我一个“意外令牌”。当然，如果我手动将它输入到 JSONLint 那就没问题了。我想有一些我无法识别/看到出现在 JSON 中的字符，但不知道如何找到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:20:00.303

即使 Martin 和 navnav 注释也是正确的，但空格通常不会像二进制格式（例如 GIF、JPEG 等）那样使 Json 格式无效。

因此，您的问题可能是[BOM 标头](http://en.wikipedia.org/wiki/Byte_order_mark)，一个 2/3 字节的标头，许多编辑器没有显示，或者更糟糕的是，在文件开头添加。

编辑

删除 BOM 的一种可能方法是使用[phpstorm 之](https://www.jetbrains.com/phpstorm/download/)类的 IDE ，它具有二进制安全编辑器，能够检测和删除 BOM。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T12:11:48.147

可能是您在包含的文件中的屏幕上回显/打印某些内容。

JSON 不适用于其他内容。

还有您的`?>`标签 - 该标签后是否有任何换行符/空格？如果是这样，那就是你的问题。删除它们。事实上，如果该文件只包含 PHP 代码，请`?>`完全删除该标签，因为它不需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:12:25.837

如果在 [?php 和 ?] 之前有任何空白字符，请检查您的班级。这会触发提供给浏览器的内容，并会创建一个 HTTP Header cannot be created 警告，这会给出错误的 JSON。

检查你的脚本——你要包括这个的那个——也。

对于许多 Web 开发人员来说，不使用 ?> 已成为某种“最佳实践”，正是出于这个原因。

无效数据的外观如何？

# asp.net - 正则表达式正则表达式验证器

> ID：11261492
> 
> 赞同：0
> 
> 时间：2012-06-29T12:07:53.670
> 
> 标签：asp.net, regex, reg-expressionvalidator

抱歉，如果这已经得到解答，但我在这里找不到。我知道它可能，但对正则表达式的了解非常有限。我有一个`ASP.NET`项目，我想检查一个值的前两个字符是否以`GY`, `BT`,开头`JE`，如果是则触发验证失败。

我现在在我的 RegularExpressionValidator 中拥有的是：

```
/^(?i)[GY]{2}|^(?i)[BT]{2}|^(?i)[JE]{2}/ 
```

任何帮助将不胜感激。

谢谢乔恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:11:11.970

这应该可以解决问题

```
string strRegex = @"/^(?i)[GY]{2}|^(?i)[BT]{2}|^(?i)[JE]{2}/";

Regex re = new Regex(strRegex);
if (re.IsMatch(inputString))
    return (true);
else
    return (false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:11:59.097

请记住，这`[]`是一个范围，并且没有规定字符应该出现的顺序。所以：

`[GY]{2}`不仅会匹配所需的“GY”，还会匹配“GG”或“YY”。试试这个：

```
/^(GY|BT|JE)/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:12:04.747

简单的任务 - 使用正则表达式`^(GY|BT|JE)`或`^(?:GY|BT|JE)`

```
<script  runat="server">
  sub submit(sender As Object, e As EventArgs) 
    if Page.IsValid then 
      lbl.Text="OK"
    else 
      lbl.Text="NOT OK"
    end if
  end sub
</script>

<!DOCTYPE html>
<html>
  <body>
    <form runat="server">Enter text here:
      <asp:TextBox id="txtbox1" runat="server" />
      <br /><br />
      <asp:Button text="Submit" OnClick="submit" runat="server" />
      <br /><br />
      <asp:Label id="lbl" runat="server" />
      <br />
      <asp:RegularExpressionValidator 
        ControlToValidate="txtbox1"
        ValidationExpression="^(GY|BT|JE)"
        EnableClientScript="false"
        ErrorMessage="Error"
        runat="server" />
    </form>
  </body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T12:18:49.213

我不确定我是否理解正确，但我猜你的表达方式是：

```
/^(GY|BT|JE)/ 
```

这将匹配以 GY 或 BT 或 JE 开头的所有值。

另一方面，如果您希望允许所有不以 BY 或 BT 或 JE 开头的字符串，这将是

```
/^(?<!(GY|BT|JE)).*/ 
```

# python - Python - 快速删除此列表中的重复项？

> ID：11261493
> 
> 赞同：5
> 
> 时间：2012-06-29T12:08:15.917
> 
> 标签：python, list

你知道，要翻列表：

```
a = ["hello", "hello", "hi", "hi", "hey"] 
```

进入列表：

```
b = ["hello", "hi", "hey"] 
```

你只需这样做：

```
b = list(set(a)) 
```

这是快速和pythonic。

但是如果我需要打开这个列表怎么办：

```
a = [["hello", "hi"], ["hello", "hi"], ["how", "what"], ["hello", "hi"], 
     ["how", "what"]] 
```

到：

```
b = [["hello", "hi"], ["how", "what"]] 
```

pythonic的方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-29T12:09:18.670

```
>>> a = [["hello", "hi"], ["hello", "hi"], ["how", "what"], ["hello", "hi"], ["how", "what"]]
>>> set(map(tuple, a))
set([('how', 'what'), ('hello', 'hi')]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:19:31.193

只是另一种不太好的方法（尽管它适用于不可散列的对象，只要它们是可订购的）

```
>>> from itertools import groupby
>>> a = [["hello", "hi"], ["hello", "hi"], ["how", "what"], ["hello", "hi"], ["how", "what"]]
>>> [k for k, g in groupby(sorted(a))]
[['hello', 'hi'], ['how', 'what']] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:28:49.847

如果需要保留原始订单并且您拥有 Python 2.7+

```
>>> from collections import OrderedDict
>>> a = [["hello", "hi"], ["hello", "hi"], ["how", "what"], ["hello", "hi"], ["how", "what"]]
>>> list(OrderedDict.fromkeys(map(tuple, a)))
[('hello', 'hi'), ('how', 'what')] 
```

# php - 与 PHP 的 unixodb 连接失败

> ID：11261494
> 
> 赞同：2
> 
> 时间：2012-06-29T12:08:20.147
> 
> 标签：php, unixodbc, isql

我已经用 unixODBC 安装了 freetds，当我测试与 isql 的连接时，它工作得很好，但是当我尝试与 php 建立连接时，我得到一个 S1000 错误。

我的配置详细信息是我的 freetds.conf 中有一个 DSN

```
[MYDSN]
host = 192.168.30.233
port = 1433
tds version = 8.0
client charset = UTF-8 
```

我的 odbc.ini 文件有

```
[MYDSN]
Driver = FreeTDS
Descrioption = conn unixodbc with FreeTDS
tds version = 8.0
Server = 192.168.30.233
Port = 1433
Database = mydb
client charset = UTF-8 
```

我的 odbcinst 文件有

```
[FreeTDS]
Description = MSSQL Driver
Driver = /usr/lib64/libtdsodbc.so
UsageCount = 1 
```

我使用[本教程](http://www.opusinteractive.com/blogs/Connect-CentOS-5.5-64bit-to-a-Microsoft-SQL-Server-database-using-unixODBC-and-FreeTDS/1068.html)进行安装，并使用 odbcinst 安装了驱动程序。

为了与 php 连接，我使用 DSN 连接，并尝试使用 odbc_connect 和 mssql_connect。

```
odbc_connect("MYDSN",$this->user,$this->password)

mssql_pconnect( "MYDSN",$this->user,$this->password) 
```

我还尝试使用以下代码使用 PDO

```
new \PDO ("dblib:host=MYDSN;dbname=mydb;",$this->user,$this->password); 
```

使用 isql 一切正常。

我正在使用 Microsoft SQL Server 2008。

有谁知道可能导致此问题的原因。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T21:06:57.517

这通常意味着您缺少 php odbc，因此请安装它

```
sudo apt-get install php5-odbc 
```

# php - owncloud 添加自己的文件存储

> ID：11261496
> 
> 赞同：1
> 
> 时间：2012-06-29T12:08:26.897
> 
> 标签：php, owncloud

我正在尝试将 owncloud 连接到我的 cms 中。但是我遇到了文件存储安装的问题。有没有人有关于如何在 OwnCloud 应用程序中创建自己的文件存储的示例。

我目前在一个自定义的活动应用程序中有以下代码（不同的部分允许登录 CMS 用户登录，这很有效）：

```
class OC_Filestorage_HYN extends OC_Filestorage_Local {
    public function __construct($arguments) {
        global $SiteVisitor,$MultiSite;
        if( $SiteVisitor -> loggedin() && $SiteVisitor -> get_right( "owner" ) && defined("HYN_MS_DIR") && is_dir(HYN_MS_DIR) ) {
            $this -> datadir = HYN_MS_DIR;
        }
        return false;

    }
    public function mkdir($path){
        return false;
    }
    public function rmdir($path){
        return false;
    }
}

OC_Filesystem::clearMounts();
/**
*   @param 1: Class to handle Filestorage requests
*   @param 2: array of options
*   @param 3: mountpoint eg how to enter this storage in the view
*/
OC_Filesystem::mount( "OC_Filestorage_HYN" , array() , "/" ); 
```

# cocoa - NSBitmapImageRep 中的亚像素抗锯齿

> ID：11261501
> 
> 赞同：1
> 
> 时间：2012-06-29T12:08:46.770
> 
> 标签：cocoa, quartz-graphics, nsbitmapimagerep

有没有办法在`NSBitMapImageRep`亚像素抗锯齿中绘制文本？文本绘制在不透明的白色背景上，我尝试使用该`CGContextSetShouldSmoothFonts`功能，但这似乎没有帮助。

```
NSBitmapImageRep *bm = [[NSBitmapImageRep alloc] initWithBitmapDataPlanes:NULL pixelsWide:300 pixelsHigh:300 bitsPerSample:8 samplesPerPixel:4 hasAlpha:YES isPlanar:NO colorSpaceName:NSCalibratedRGBColorSpace bytesPerRow:0 bitsPerPixel:0];
[NSGraphicsContext setCurrentContext:[NSGraphicsContext graphicsContextWithBitmapImageRep:bm]];
[[NSColor whiteColor] set];
NSRectFill(NSMakeRect(0, 0, 300, 300));
CGContextRef ctx = NSGraphicsContext.currentContext.graphicsPort;
CGContextSetShouldSmoothFonts(ctx, true);
[@"Example" drawAtPoint:NSZeroPoint withAttributes:nil];
[[bm TIFFRepresentation] writeToFile:[@"~/Desktop/bitmap.tiff" stringByExpandingTildeInPath] atomically:NO]; 
```

`NSImage`当我在using中绘制时，我可以使文本平滑工作`-[NSImage lockFocus]`，但是在 Retina 显示器上运行它时这并不可靠。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:16:26.407

我最终使用这个替代代码来获得文本平滑：

```
CGColorSpaceRef cs = CGColorSpaceCreateWithName(kCGColorSpaceGenericRGB);
CGContextRef c = CGBitmapContextCreate(NULL, 300, 300, 8, 300 * 4, cs, kCGImageAlphaPremultipliedFirst | kCGBitmapByteOrder32Little);
[NSGraphicsContext setCurrentContext:[NSGraphicsContext graphicsContextWithGraphicsPort:c flipped:NO]];
[[NSColor whiteColor] set];
NSRectFill(NSMakeRect(0, 0, 300, 300));
[@"Example" drawAtPoint:NSZeroPoint withAttributes:nil];
CGImageRef cgImage = CGBitmapContextCreateImage(c);
NSImage *im = [[NSImage alloc] initWithCGImage:cgImage size:NSZeroSize];
[[im TIFFRepresentation] writeToFile:[@"~/Desktop/cgImage.tiff" stringByExpandingTildeInPath] atomically:NO];
CGImageRelease(cgImage);
CGColorSpaceRelease(cs);
CGContextRelease(c); 
```

# java - BlueCove、笔记本电脑和带蓝牙功能的 Android 平板电脑

> ID：11261507
> 
> 赞同：8
> 
> 时间：2012-06-29T12:09:01.147
> 
> 标签：java, android, bluetooth, bluecove

我正在尝试通过一个简单的应用程序来了解使用蓝牙的基础知识。我还想要一个笔记本电脑应用程序，这样我就可以简单地调试蓝牙通信。下面的代码是我尝试将笔记本电脑作为客户端（使用 BlueCove 2.1.0）和平板电脑作为服务器（Android 2.2）的尝试。

据我了解，这应该按书面说明工作，并且笔记本电脑正在使用平板电脑及其提供的服务。但是，该行`"StreamConnection conn = (StreamConnection) Connector.open(url, Connector.READ_WRITE);"`每次都返回 null。

任何想法是怎么回事？这是代码的输出：

> Winsock 上的 BlueCove 版本 2.1.0
> 地址：68A3C44A5265
> 名称：WS1497
> 开始设备查询...
> 设备发现：2013E061D922
> 设备发现：00242BFE7375
> INQUIRY_COMPLETED
> 设备查询已完成。
> 服务查询开始。
> 来自：Galaxy Tab
> 服务搜索完成 - 代码：1
> 来自：WS1190
> 服务搜索完成 - 代码：4
> 蓝牙设备：
> 1\. 2013E061D922 (Galaxy Tab)
> 2\. 00242BFE7375 (WS1190)
> btspp://2013E061D922:20;authenticate=false;encrypt =false;master=false ----=null
> 线程“main”中的异常 java.lang.NullPointerException
> 在 MainClass.main(MainClass.java:104)
> BlueCove 堆栈关闭完成

这是我正在使用的代码：

笔记本电脑代码：

```
import java.io.DataInputStream;
import java.io.IOException;
import java.util.Vector;

import javax.bluetooth.DeviceClass;
import javax.bluetooth.DiscoveryAgent;
import javax.bluetooth.DiscoveryListener;
import javax.bluetooth.LocalDevice;
import javax.bluetooth.RemoteDevice;
import javax.bluetooth.ServiceRecord;
import javax.bluetooth.UUID;
import javax.microedition.io.Connector;
import javax.microedition.io.StreamConnection;

public class MainClass implements DiscoveryListener {

// object used for waiting
private static Object lock = new Object();

// vector containing the devices discovered
private static Vector<RemoteDevice> vecDevices = new Vector<RemoteDevice>();
private static Vector<String> vecServices = new Vector<String>();

// main method of the application
public static void main(String[] args) throws IOException {

    // create an instance of this class
    MainClass bluetoothDeviceDiscovery = new MainClass();

    // display local device address and name
    LocalDevice localDevice = LocalDevice.getLocalDevice();

    System.out.println("Address: " + localDevice.getBluetoothAddress());
    System.out.println("Name: " + localDevice.getFriendlyName());

    // find devices
    DiscoveryAgent agent = localDevice.getDiscoveryAgent();

    System.out.println("Starting device inquiry...");
    agent.startInquiry(DiscoveryAgent.GIAC, bluetoothDeviceDiscovery);

    try {
        synchronized (lock) {
            lock.wait();
        }
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    System.out.println("Device Inquiry Completed. ");
    System.out.println("Service Inquiry Started. ");

    UUID uuids[] = new UUID[1];
    uuids[0] = new UUID("fa87c0d0afac11de8a390800200c9a66", false);

    for (RemoteDevice rd : vecDevices) {
        System.out.println("From: " + rd.getFriendlyName(false));
        agent.searchServices(null, uuids, rd, bluetoothDeviceDiscovery);
        try {
            synchronized (lock) {
                lock.wait();
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    // print all devices in vecDevices
    int deviceCount = vecDevices.size();

    if (deviceCount <= 0) {
        System.out.println("No Devices Found .");
    } else {
        // print bluetooth device addresses and names in the format [ No.
        // address (name) ]
        System.out.println("Bluetooth Devices: ");
        for (int i = 0; i < deviceCount; i++) {
            RemoteDevice remoteDevice = (RemoteDevice) vecDevices
                    .elementAt(i);
            System.out.println((i + 1) + ". "
                    + remoteDevice.getBluetoothAddress() + " ("
                    + remoteDevice.getFriendlyName(false) + ")");
        }
    }

    // System.out.println("SR: " + sr.toString());
    for (String url : vecServices) {
        try {
            String url = sr
                    .getConnectionURL(
                            ServiceRecord.NOAUTHENTICATE_NOENCRYPT, false);
            StreamConnection conn = (StreamConnection) Connector.open(url, Connector.READ_WRITE);
            System.out.println(url + " ----=" + conn);
            DataInputStream din = new DataInputStream(
                    conn.openDataInputStream());
            synchronized (lock) {
                try {
                    lock.wait(10);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
            while (din.available() != 0) {
                System.out.print(din.readChar());
            }
            System.out.println();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

}// end main

// methods of DiscoveryListener

/**
 * This call back method will be called for each discovered bluetooth
 * devices.
 */
public void deviceDiscovered(RemoteDevice btDevice, DeviceClass cod) {
    System.out.println("Device discovered: "
            + btDevice.getBluetoothAddress());
    // add the device to the vector
    if (!vecDevices.contains(btDevice)) {
        vecDevices.addElement(btDevice);
    }
}

// no need to implement this method since services are not being discovered
public void servicesDiscovered(int transID, ServiceRecord[] servRecord) {
    for (ServiceRecord sr : servRecord) {
        vecServices.add(sr.getConnectionURL(ServiceRecord.NOAUTHENTICATE_NOENCRYPT, false));
    }
}

// no need to implement this method since services are not being discovered
public void serviceSearchCompleted(int transID, int respCode) {
    System.out.println("Service search completed - code: " + respCode);
    synchronized (lock) {
        lock.notify();
    }
}

/**
 * This callback method will be called when the device discovery is
 * completed.
 */
public void inquiryCompleted(int discType) {
    switch (discType) {
    case DiscoveryListener.INQUIRY_COMPLETED:
        System.out.println("INQUIRY_COMPLETED");
        break;

    case DiscoveryListener.INQUIRY_TERMINATED:
        System.out.println("INQUIRY_TERMINATED");
        break;

    case DiscoveryListener.INQUIRY_ERROR:
        System.out.println("INQUIRY_ERROR");
        break;

    default:
        System.out.println("Unknown Response Code");
        break;
    }
    synchronized (lock) {
        lock.notify();
    }
}// end method
}// end class 
```

安卓：

```
package com.mira.Bluetooth;

import java.io.IOException;

import java.util.UUID;

import android.app.Activity;

import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.bluetooth.BluetoothServerSocket;
import android.bluetooth.BluetoothSocket;

import android.os.Bundle;

import android.util.Log;

public class BluetoothAndroidActivity extends Activity implements Runnable {
    BluetoothServerSocket bss;
    Thread t;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        BluetoothAdapter bta = BluetoothAdapter.getDefaultAdapter();

        for (BluetoothDevice btd : bta.getBondedDevices()) {
            Log.i("Bluetooth Device Found",
                  btd.toString() + "; " + btd.getName());
        }

        try {
            bss =
bta.listenUsingRfcommWithServiceRecord("BluetoothChat", UUID.fromString("fa87c0d0-afac-11de-8a39-0800200c9a66"));
            t = new Thread(this);
            t.start();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    @Override
    public void run() {
        // TODO Auto-generated method stub
        boolean bContinue = true;
        while (bContinue) {
            try {
                Thread.sleep(100);
            } catch (Exception e) {

            }

            try {
                System.out.println("Listening for connection");
                BluetoothSocket bs = bss.accept();
                System.out.println("Connection received");
                bs.getOutputStream().write("Hello BlueTooth World".getBytes());
                bs.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                bContinue = false;
            }
        }
    }

    /*
 * (non-Javadoc)
 *
 * @see android.app.Activity#onDestroy()
 */

    @Override
    protected void onStop() {
        try {
            System.out.println("Killing ServerSocket");
            bss.close();
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        super.onStop();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T20:22:00.217

这是一个老问题，所以我不知道是否有人还在寻找答案，但无论如何这里有一个...... :)。您询问的行返回 null 因为`url`是 null。试试这个 UUID 而不是你代码中的那个：`0000110100001000800000805f9b34fb`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T23:11:42.583

经过很长时间的更新 - 事实证明，蓝牙要求 UUID 采用“0000xxxx00001000800000805f9b34fb”的形式，这确实引出了一个问题，即为什么不只使用 16 位标识符而不是 128 位 UUID，但没关系。

我不知道 BlueCove 是否可以在我的笔记本电脑上使用它，但我最近在我的笔记本电脑上使用 Linux 和“Bluez”进行的实验表明，这种形式的任何 UUID 都可以使用。Android 可能应该将其作为某种注释包含在他们的文档中。

# android - 使用 sherlockactionbar 时出现 classNotFound 异常

> ID：11261508
> 
> 赞同：0
> 
> 时间：2012-06-29T12:09:11.323
> 
> 标签：android, classnotfoundexception

我一直在尝试在我的应用程序中使用 sherlockActionBar，但尝试在 ny ics 设备或 2.3 模拟器上运行它时出现异常。

这是 Tabs_ICS.java 代码

```
 package com.karriapps.tehilim;

import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentTransaction;

import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.ActionBar.Tab;
import com.actionbarsherlock.app.SherlockActivity;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuInflater;
import com.actionbarsherlock.view.MenuItem;

public class Tabs_ICS extends SherlockActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.main_ics);

        ActionBar ab = getSupportActionBar();
        ab.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

        ActionBar.Tab mainTab = ab.newTab().setText(R.string.quick).setTabListener(new mListener(new QuickAccessIcs()));
        ab.addTab(mainTab, true);

        ActionBar.Tab booksTab = ab.newTab().setText(R.string.chap).setTabListener(new mListener(new Books_ICS()));
        ab.addTab(booksTab);

        ActionBar.Tab weekTab = ab.newTab().setText(R.string.week).setTabListener(new mListener(new Week_ICS()));
        ab.addTab(weekTab);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {

        MenuInflater in = getSupportMenuInflater();
        in.inflate(R.menu.main_menu, menu);

        return super.onCreateOptionsMenu(menu);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {

        startActivity(new Intent(Tabs_ICS.this, Preferences.class));

        return super.onOptionsItemSelected(item);
    }
}

class mListener implements ActionBar.TabListener
{
    private Fragment fragment;
    public mListener(Fragment fragment)
    {
        this.fragment = fragment;
    }

    @Override
    public void onTabSelected(Tab tab,
            FragmentTransaction ft) {
        ft.replace(R.id.fragment_container, fragment);
    }

    @Override
    public void onTabUnselected(Tab tab,
            FragmentTransaction ft) {

        ft.remove(fragment);
    }

    @Override
    public void onTabReselected(Tab tab,
            FragmentTransaction ft) {
    }

} 
```

我在这里做错了什么？先感谢您

# applescript - Applescript：在Finder中打开一个文件夹

> ID：11261516
> 
> 赞同：17
> 
> 时间：2012-06-29T12:09:26.133
> 
> 标签：applescript, directory, finder

我正在尝试使用 AppleScript 在 Finder 中打开一个文件夹。以下是我的代码。我希望文件夹`WorkSpace`在 Finder 中打开，但它会打开父文件夹`/Volumes/MyMacDrive/Mani`并突出显示该`WorkSpace`文件夹。我想要`WorkSpace`文件夹的内容，但我得到的只是它的父文件夹的内容。我在这里想念什么..？

```
property the_path : "/Volumes/MyMacDrive/Mani/WorkSpace/"
set the_folder to (POSIX file the_path) as alias
tell application "Finder"
    activate
    if window 1 exists then
        set target of window 1 to the_folder
    else
        reveal the_folder
    end if
end tell 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-19T10:05:12.107

据我搜索，似乎没有办法打开文件夹，而只是在 AppleScript 中突出显示文件夹。所以我用过：

```
do shell script "open /Volumes/MyMacDrive/Mani/WorkSpace/" 
```

它对我来说很好，但如果我错了，请更新我。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-09-26T16:42:48.067

它实际上比看起来更简单：

```
tell application "Finder" to open ("/Volumes/MyMacDrive/Mani/WorkSpace/" as POSIX file) 
```

或使用冒号给出 AppleScript 路径：

```
tell application "Finder" to open "MyMacDrive:Mani:WorkSpace" 
```

这样你就有了一个打开的窗口

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-29T12:20:31.000

尝试：

```
if front Finder window exists then
    set target of front Finder window to the_folder
else
    open the_folder
end if 
```

编辑以合并 jackjr300 的更正。Finder 窗口是要使用的正确类。

# batch-file - 批量复制脚本递归

> ID：11261517
> 
> 赞同：0
> 
> 时间：2012-06-29T12:09:33.200
> 
> 标签：batch-file, copy

我有以下代码，可以将文件静默复制到我的 USB 驱动器：

```
@echo off 
:: variables 
/min 
SET odrive=%odrive:~0,2% 
set backupcmd=xcopy /s /c /d /e /h /i /r /y 
echo off 
%backupcmd% "C:\*.pdf" "%drive%\all\"
@echo off 
cls 
```

我想扩展它，复制文件夹结构 c:\ 递归中的所有 pdf 文件。有什么建议么？

我也想使用一些模式，如`*test.pdf`, `test*.pdf`。也许正则表达式是正确的方法，但我不知道该怎么做..

感谢您的支持！:) Windows 不是我的朋友 .. :-/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:59:43.157

我不完全确定您要做什么，但是如果您想从 C:\ 复制所有 pdf 文件，那么这应该可以

```
for /r C:\ %%x in (*.pdf) do xcopy %%x "%drive%\all" 
```

# ruby-on-rails - 如何从控制器渲染不同的视图

> ID：11261518
> 
> 赞同：2
> 
> 时间：2012-06-29T12:09:40.607
> 
> 标签：ruby-on-rails

有点菜鸟问题；）：

我的控制器中有 2 个操作 - *index*和*own*。在*index*中，我列出了所有帖子，并且我只生成了已登录用户的帖子*。*控制器非常相似，但视图是相同的，我假设可以在这两个控制器之间共享。

在自己的控制器中，我放了这样的东西：

```
respond_to do |format|
  format.html { render :action => "index" }
  format.json { render json: @ads }
end 
```

并添加到路线：

```
match "/ads/own" => 'ads#own', :via => :get 
```

有没有更好的解决方案来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:19:13.270

你可以这样做：

```
def index
  ....
end

def own
  ....
  render :index    
end 
```

一切（所有变量）都会直接传递给自己的索引视图。如果您想要 :json 组件，请添加：

```
class SomeController < ApplicationController
  respond_to :html, :json 
```

并将“respond_with @posts”作为每个操作的最后一项。

# javascript - chrome 撤消“阻止此页面创建其他对话框”的操作

> ID：11261519
> 
> 赞同：122
> 
> 时间：2012-06-29T12:09:41.437
> 
> 标签：javascript, google-chrome, alert

我有时发现我需要重新启用警报以进行调试。当然我可以关闭标签并重新加载它但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2014-03-20T20:28:30.440

关闭您禁用警报的页面的选项卡。在新选项卡中重新打开页面。该设置仅适用于会话，因此一旦新会话在新选项卡中开始，警报将重新启用。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-06-29T12:14:14.243

不，但你真的应该使用`console.log()`而不是`alert()`调试。

在 Chrome 中，它甚至具有能够打印出整个对象（不仅仅是`toString()`）的优势。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2016-03-25T12:39:08.390

所以正确答案是：是的，有更好的方法。

右键单击选项卡并选择“复制”，然后根据需要关闭原始选项卡。

在副本中重新启用警报。

重复选项卡似乎重新创建了原始选项卡的运行状态，因此您可以继续原处。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-01-03T23:22:59.603

2更多解决方案我没有运气，当没有选项卡关闭+重新打开另一个选项卡中的页面，也不会关闭Chrome（和浏览器）中的所有选项卡，然后重新启动它不起作用：

1) 我通过关闭选项卡、强制关闭 Chrome 和重新启动浏览器而不恢复选项卡将其修复在我的机器上（注意：在运行 CentOS Linux 的计算机上）。

2) 我的老板（也在 CentOS 上）有同样的问题（警报是我公司 Javascript 调试过程的重要组成部分，原因有很多，例如遗留问题），但我的第一种方法对他不起作用。但是，我设法通过以下过程为他解决了这个问题：

*   a) 创建一个名为 FixChrome.sh 的空文本文件，然后粘贴以下 bash 脚本：

    ```
    #! /bin/bash
    cd ~/.config/google-chrome/Default     //adjust for your Chrome install location
    rm Preferences
    rm 'Current Session'
    rm 'Current Tabs'
    rm 'Last Session'
    rm 'Last Tabs' 
    ```

*   b) 关闭 Chrome，然后打开终端并运行脚本 (bash FixChrome.sh)。

这对他有用。缺点是您会丢失当前和上一个会话中的所有选项卡，但如果这对您很重要，这是值得的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-04-29T22:35:04.317

打开具有相同链接的新窗口或选项卡.. PREVENT 选项仅在每个会话中持续..

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-02-24T21:57:41.620

如果您希望为您设置为阻止对话框显示的页面重新激活对话框。

Chrome：选择设置，将打开 chrome 的 google 页面，其中包含您对 chrome 的所有设置。

在最底部，转到高级设置，在高级设置的底部，您可以单击重置浏览器设置...这将使对话框按原样出现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-10T06:50:07.283

如果 JS 脚本中有太多警报，似乎有一个进程会抑制所有 console.log 消息。如果您尝试调试脚本，那将是一个问题。我一直在 Chrome 和 Brave 上运行脚本，突然 console.log 消息停止了。然而，对于 Firefox，所有的 console.log 消息仍然出现......完全相同的脚本。问题是没有选中或取消选中警告、错误和调试消息。

我对此感到茫然……是Windows阻止了“站点”吗？我尝试清除缓存重置 Chrome 中的所有设置，但问题仍然存在。我想我可以尝试重新安装两个浏览器。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2016-10-24T19:52:16.153

***关闭硬件加速似乎是影响弹出窗口和对话框的设置。***

当我需要对某事做出“是”或“否”时，Chrome 会不断隐藏对话框窗口，当我需要在书签面板中重命名文件夹时也是如此。经过几周的这样做。我在“设置”中禁用了所有 Chrome 助手，此外在 Windows 10 中，我关闭了“窗口捕捉”。它已经将弹出窗口和对话框放回视口中。

发生此错误时，我可以通过在单击选项卡关闭 X 按钮之前先按 Enter 来关闭选项卡。浏览器有一个隐藏的警报框，需要用户响应。

关闭并重新打开硬件加速，终止 Chrome 进程并关闭和返回所有其他助手已经为我修复了它......它必须在 chrome 本身中，因为我刚刚进入 Mac 中的 Chrome 窗口，它现在有停止了问题，没有任何干预。我猜想打开/关闭/打开 chrome 设置会导致它重新定位对话框。我现在无法让浏览器重复错误...

# android - 为什么 android:installLocation="internalOnly" 不起作用？

> ID：11261520
> 
> 赞同：1
> 
> 时间：2012-06-29T12:09:43.350
> 
> 标签：android

在我的清单文件中，我`installLocation="internalOnly"`在清单标签和清单的上部给出了以下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.flexsin.classified"
android:versionCode="1"
android:versionName="1.0" 
android:installLocation="internalOnly" >

<uses-sdk android:minSdkVersion="8" />

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

<application
    android:debuggable="true"
    android:icon="@drawable/logo_new_icon"
    android:label="@string/app_name" 
  >
    <activity
        android:name=".SplashActivity"
        android:label="@string/app_name"
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

我发送了一封带有 APK 的邮件，当我单击安装按钮时，它显示“无法下载附件，因为 SD 卡丢失或未安装”。我的问题是为什么当我希望我的 apk 安装在手机内存上时它会显示此消息。

```
Phone mem available space=50Mb
Phone model: Samsung GT-S5570 
```

PS：设备没有SD卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:34:00.583

> 我的问题是为什么它显示此消息

因为您的 SD 卡丢失或未安装。

> 当我希望我的 apk 安装在手机内存上时

您的电子邮件客户端正在尝试下载您的附件。您的电子邮件客户端想要将该附件下载到 SD 卡。您可以说出这一点，因为**这正是错误消息告诉您的内容**。如果您尝试下载 PDF 文件附件、LOLcat 图像附件或任何其他类型的附件，您将收到相同的消息。

> 设备没有 SD 卡

然后我建议您添加一个，或找到其他`ant`不涉及电子邮件附件的应用程序安装方式（例如，通过 USB 电缆和 Eclipse 或 ）。

# php - MongoDB 更新嵌套数组

> ID：11261521
> 
> 赞同：1
> 
> 时间：2012-06-29T12:09:43.957
> 
> 标签：php, javascript, mongodb

我在 mongodb 中有一个简单的结构，带有嵌套数组。如何更新搜索值？我见过使用这样的数字的例子：

```
invited.0.used: true 
```

但这不是我要搜索的内容，因为我不知道这个元素在我的列表中的哪个位置，所以我如何将用于 true 的数组更新为 key 为 84026702 的位置？如果我有 100 个数组受邀如何更新密钥为 43938432 的位置怎么办？

```
{
    "_id" : ObjectId("4fed972f61d69aa004000000"),
    "name" : "mezo",
    "invited" : [
            {
                    "key" : 40928710,
                    "used" : false
            },
            {
                    "key" : 84026702,
                    "used" : false
            }
    ]
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T12:15:53.340

```
update({ invited.key : 84026702 }, { invited.$.used : true }); 
```

这基本上可以满足您的需求并且应该可以很好地工作。查看 mongodb 中的位置运算符：[http ://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator](http://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator)

或在 PHP 中（如您的问题已标记），您可以执行以下操作：

```
$mongo->collection->update(array('invited.key' => 84026702), array('invited.$.used' => true)); 
```

# javascript - 查找哪个类触发了模糊

> ID：11261523
> 
> 赞同：0
> 
> 时间：2012-06-29T12:09:54.807
> 
> 标签：javascript, jquery

我使用以下函数执行验证：

```
//Validation
$('.sValidate').bind('blur', function() {
    if (!$(this).val()) {
        $(this).removeClass('short_input');
        $(this).addClass('short_input_negative');
        return false;
    }
}); 
```

我的大部分输入类都是`short_input`. 但其中一些也被命名为`long_input`.
我怎么知道`input`触发了的类`blur`，删除它然后添加`long_input_negative`？

```
<input type="text" id="loginname" name="loginname" class="short_input sValidate" value="JDoe"> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T12:12:04.203

您可以使用**[`.hasClass()`](http://api.jquery.com/hasClass)**方法进行类检测：

```
$('.sValidate').bind('blur',function(){
    if (!$(this).val()){
        if( $(this).hasClass('long_input') ) {
            $(this)
                  .removeClass('short_input');
                  .addClass('short_input_negative');
        }

        if( $(this).hasClass('short_input') ) {
            $(this)
                 .removeClass('long_input');
                 .addClass('long_input_negative');
        }
    }
}); 
```

来自 jQuery 文档**`.hasClass()`**

> 确定是否为任何匹配的元素分配了给定的类。

另一种方法是使用**[`.is()`](http://api.jquery.com/is)**

```
$('.sValidate').bind('blur',function(){
    if (!$(this).val()){
        if( $(this).is('.long_input') ) {
            // do something of long_input
        }

        if( $(this).is('.short_input') ) {
           // do something of short_input
        }
    }
}); 
```

来自 jQuery 文档**`.is()`**

> 根据选择器、元素或 jQuery 对象检查当前匹配的元素集，如果这些元素中至少有一个与给定参数匹配，则返回 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:51:01.840

如果有一些值，则此行`!$(this).val()`返回。`false`所以条件永远不会执行。

这样做： -

```
$('.sValidate').bind('blur',function(){
    if ($(this).val().length > 0){
        if ($(this).hasClass('short_input')) {
            $(this).removeClass('short_input');
            $(this).addClass('short_input_negative');
        }
        if ($(this).hasClass('long_input')) {
            $(this).removeClass('long_input');
            $(this).addClass('long_input_negative');
        }
    }
});​ 
```

参考**[现场演示](http://jsfiddle.net/SivaCharan/2dxyW/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:20:14.530

虽然@thecodeparadox 已经回答了您最初的问题，但我想指出»您做错了«™ - 不知道您的课程实际上做了什么。我猜这`foo_negative`门课应该把颜色改成红色或类似的东西。

```
.short_input {
  width: 50px;
}

.long_input {
  width: 100px;
}

.negative {
  color: red;
} 
```

现在，您可以保留`short_input`和`long_input`类并简单地添加/删除`negative`类来改变您的样式。如果您不知道这一点，请查看[MDN CSS](https://developer.mozilla.org/en/CSS/)。

# asp.net - ASP.NET 网络表单的 Nancy 路由

> ID：11261524
> 
> 赞同：4
> 
> 时间：2012-06-29T12:09:58.880
> 
> 标签：asp.net, webforms, nancy

我一直在尝试在我的 webforms 项目中实现 Nancy。我已阅读本指南： [https ://github.com/NancyFx/Nancy/wiki/Hosting-nancy-with-asp.net](https://github.com/NancyFx/Nancy/wiki/Hosting-nancy-with-asp.net)

我已将此添加到我的配置中：

```
<system.webServer>
    <handlers>
        <add name="Nancy" verb="*" type="Nancy.Hosting.Aspnet.NancyHttpRequestHandler" path="nancy/*" />
    </handler>
</system.webServer> 
```

我创建了一个“/nancy”文件夹，其中包含一个 web.config 文件：

```
<?xml version="1.0"?>
<configuration>
    <system.web>
        <httpHandlers>
        <add verb="*" type="Nancy.Hosting.Aspnet.NancyHttpRequestHandler" path="*"/>
     </httpHandlers>
    </system.web>
</configuration> 
```

我有以下 C# 代码：

```
public class TestApi : Nancy.NancyModule
{
    public TestApi()
        : base("/nancy")
    {
        Get["/ok"] = parameters =>
                            {
                                return "Ok";
                            };
    }
} 
```

这在访问 '/nancy/ok' 时有效但是当我将我的 'Get["/ok"]' 更改为 'Get["/ok/ok"]' 并访问 '/nancy/ok/ok' 我得到 404未找到（小巨魔图像和所有）

编辑* 如果我把它留在 'Get["/ok"]' 并访问 /ok/ok/ok 我会得到 "Ok" 回来......

任何想法为什么我不能制定更具体的路线？

问候疯子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T04:03:41.410

我刚刚在测试中尝试过这个，我的路线没有问题。这是我的测试：

```
[TestFixture]
public class ScratchNancy
{
    [Test]
    public void RootTest()
    {
        var defaultNancyBootstrapper = new DefaultNancyBootstrapper();
        var browser = new Browser(defaultNancyBootstrapper);

        var result = browser.Get("/nancy/ok/ok", with => with.HttpRequest());

        Assert.AreEqual("It works!", result.Body.AsString());
    }

    public class RootModule : NancyModule
    {
        public RootModule() : base("/nancy")
        {
            Get["/ok/ok"] = p =>
                {
                    return Response.AsText("It works!");
                };
        }            
    }
} 
```

@TheCodeJunkie 提供的链接是帮助 Nancy 取得成功的绝佳资源。又来了：[https ://github.com/NancyFx/Nancy/wiki/Hosting-nancy-with-asp.net](https://github.com/NancyFx/Nancy/wiki/Hosting-nancy-with-asp.net)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T04:48:11.303

你记得在你的根 web.config 中添加这个吗？

```
 <system.web>
    <httpHandlers>
      <add verb="*" type="Nancy.Hosting.Aspnet.NancyHttpRequestHandler" path="nancy/*" />
    </httpHandlers>
  </system.web> 
```

这部分在你的 nancy 文件夹 web.config 中？

```
<httpHandlers>
  <add path="*" type="Nancy.Hosting.Aspnet.NancyHttpRequestHandler" verb="*"/>
</httpHandlers> 
```

如果您的问题仍然存在，这里有一些不太优雅的解决方案：

*   如果您想要**/nancy/ok/ok**，请在您的 webconfig 中添加另一行：

    ```
    <add verb="*" type="Nancy.Hosting.Aspnet.NancyHttpRequestHandler" path="nancy/*/*"> 
    ```

*   如果您想要**/nancy/ok/ok/ok**，请添加另一行：

    ```
    <add verb="*" type="Nancy.Hosting.Aspnet.NancyHttpRequestHandler" path="nancy/*/*/*"> 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-15T14:40:48.497

根据您想要在 url 下运行 Nancy 的路线判断`/nancy`，因此 Nancy 处理下的任何 url 而根上定义的任何其他内容将继续在 ASP.Net Web 窗体下工作。

如果是这种情况，问题是您需要将处理程序包装在`<location>`标签中：

```
<location path="nancy">
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
    <httpHandlers>
      <add verb="*" type="Nancy.Hosting.Aspnet.NancyHttpRequestHandler" path="*"/>
    </httpHandlers>
  </system.web>

  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <validation validateIntegratedModeConfiguration="false"/>
    <handlers>
      <add name="Nancy" verb="*" type="Nancy.Hosting.Aspnet.NancyHttpRequestHandler" path="*"/>
    </handlers>
  </system.webServer>
</location> 
```

这允许Nancy 处理在该位置下调用的**所有请求**（由 定义）。`path="*"``/nancy`

此信息可在**将 Nancy 添加到现有站点下链接到的链接中找到**

[https://github.com/NancyFx/Nancy/wiki/Hosting-nancy-with-asp.net#adding-nancy-to-an-existing-site](https://github.com/NancyFx/Nancy/wiki/Hosting-nancy-with-asp.net#adding-nancy-to-an-existing-site)

^ 直接链接到特定标题。

# android - 使用 soundpool 获取声音

> ID：11261526
> 
> 赞同：0
> 
> 时间：2012-06-29T12:10:02.090
> 
> 标签：android

我是 android 开发的新手，正在尝试开发一个简单的应用程序，其中一个按钮用于播放声音。我正在尝试使用 SoundPool 并发现每个教程都提供了在创建 soundpool 对象后要添加的这样的代码：

```
soundPool.setOnLoadCompleteListener(new OnLoadCompleteListener() {
            @Override
            public void onLoadComplete(SoundPool soundPool, int sampleId,
                    int status) {
                loaded = true;
            }
        }); 
```

但是当我尝试在eclipse中使用这段代码时，它说

类型为 new SoundPool.OnLoadCompleteListener(){} 的方法 onLoadComplete(SoundPool, int, int) 必须覆盖超类方法。并建议删除@override 符号。如果没有这种方法应该会发生这种情况？？为什么我会收到此错误？

当我把 soundID = soundPool.load(this, R.raw.mysound, 1);

在上面的代码之后，eclipse 说 SoundPool 类型中的方法 load(Context, int, int) 不适用于参数 (new View.OnClickListener(){}, int, int)

这是我的全部代码： public class FirstActivity extends Activity { /** 在首次创建活动时调用。*/

```
private SoundPool soundPool;
int soundID;
boolean loaded = false;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button bPlay = (Button) findViewById(R.id.bPlay);
    final TextView aRing = (TextView)findViewById(R.id.tAlarmRinging);

    bPlay.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            aRing.setVisibility(View.VISIBLE);

            soundPool.setOnLoadCompleteListener(new OnLoadCompleteListener() {
                @Override
                public void onLoadComplete(SoundPool soundPool, int sampleId,
                        int status) {
                    loaded = true;
                }
            });
            soundID = soundPool.load(this, R.raw.mysound, 1);
        }

        });
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:23:17.400

您应该尝试将项目合规级别设置为 java 1.7 或类似的东西。

右键单击项目，转到 Properties->Java Compiler->选中 Enable project specific settings->然后选择最高的编译器合规级别。

如果这不起作用，则右键单击项目，AndroidTools->修复项目属性。

# jquery - 通过 AJAX 加载另一个 HTML 然后替换自身的 HTML 文件

> ID：11261532
> 
> 赞同：2
> 
> 时间：2012-06-29T12:10:15.890
> 
> 标签：jquery, html, ajax

我想让一个简单的 HTML 文件充当第二个 HTML 文件的引导程序（将使用 AJAX 加载，然后使用 javascript 处理），它将完全取代第一个。

### 引导程序.htm

1.  使用 AJAX 加载 content.htm（jQuery 适合这项工作）
2.  使用 javascript 修改内容（需要各种自定义过滤器/修改）
3.  用新修改的内容替换自己

我预计这可能不是 100% 可能，因为替换 doctype 可能很难，但我希望替换所有正文内容和所有头部内容（也许只是 HTML 的所有内容？）

有人对如何解决这个问题有任何建议吗？

## 编辑：我试图直接做我真正想做的事......

```
$.get("content.htm", function(d) {
  console.log(d);
  return $(document).html(d); 
```

但这不起作用，并且给我留下了一个空文档 });

## 编辑：迄今为止最好的解决方案（仍然是概念性的）

*   `bootstrap.htm`加载，并且非常小心地只创建一个全局变量（比如说`bs`）
*   `bootstrap.htm`然后加载`content.htm`文件，并进一步处理它
*   `bootstrap.htm`用处理的标签`html`的内容替换标签内容`content.htm``html`
*   `bootstrap.htm`然后搜索新内容，并执行任何内联 javascript，注意不要执行已经执行的代码
*   `bootstrap.htm`删除它的全局变量（虽然在这个阶段没有什么意义，当大部分导入的代码已经运行时）

这仍然不允许更改 DOCTYPE，并且导入代码的执行似乎有点不可靠，但这是我迄今为止最好的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:16:02.687

你当然可以。你有没有尝试过？提示：

```
$('body').load( url,[data],[callback] ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:27:39.620

我认为主要的警告是针对未执行的 JavaScript 代码。如果您正在加载“纯”HTML，我认为其他用户（以及您预见到的）建议的方法会很好，前提是不会更改 docype 和 HEAD。

另请参阅：[调用从 Ajax 响应返回的 JavaScript 函数](https://stackoverflow.com/questions/510779/calling-a-javascript-function-returned-from-a-ajax-response)

# django - Django v1.4，无法创建我的自定义管理器

> ID：11261536
> 
> 赞同：0
> 
> 时间：2012-06-29T12:10:33.840
> 
> 标签：django

我有这个代码：

```
class InactiveSolutionsManager(models.Manager):
def get_query_set(self):
    return super(InactiveSolutionsManager, self).get_query_set().filter( state == self.model.SOLUTION_STATE_INACTIVE ) 
```

我的任何模型都是：

```
class Solution(models.Model):
    SOLUTION_STATE_INACTIVE = 5
    SOLUTION_STATE_CHOICES = (
        (5, 'Inactive'))

    state = models.IntegerField( choices = SOLUTION_STATE_CHOICES)

    objects = models.Manager()
    inactive  = InactiveSolutionsManager() 
```

当我调用 Solution.inactive.all() 时出现错误：未定义全局名称“状态”。

这个自定义管理器代码是 django 中众所周知的模式，但由于某种原因，它对我不起作用。任何想法 ？

# c# - 如何隐藏文件中的信息？

> ID：11261538
> 
> 赞同：-7
> 
> 时间：2012-06-29T12:10:42.453
> 
> 标签：c#, file

是否可以在文件中的某处隐藏信息？例如，我需要为每个文件保存一个 GUID 以使其唯一。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:14:38.460

我自己没有尝试过，但您可以尝试使用[NTFS 备用数据流 - .NET](https://stackoverflow.com/questions/604960/ntfs-alternate-data-streams-net)

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:15:39.140

如果您想将加密数据写入文本文件，那么此 MSDN 文章将逐步说明如何操作：http: [//support.microsoft.com/kb/307010](http://support.microsoft.com/kb/307010)

# php - 查询 mysql 数据库时 PHP Char 导致 null

ID：11261545

赞同：0

时间：2012-06-29T12:11:06.190

标签：php, mysql

# javascript - 如何用Phonegap实现蓝牙通信？

> ID：11261547
> 
> 赞同：24
> 
> 时间：2012-06-29T12:11:09.160
> 
> 标签：javascript, html, bluetooth

我打算用 HTML/JAVASCRIPT/jQuery 编写一个界面来控制电子设备。通信必须通过蓝牙（已经存在控制设备的指令集，并且设备已经支持蓝牙），并且这个接口应该可以通过Phonegap移植到Android应用程序......

所以我很想得到一些关于如何使用 HTML 或 JAVASCRIPT 建立蓝牙通信，并通过 Phonegap 移植它的建议……教程、书籍或任何类型的提示都会受到热烈欢迎！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-13T14:43:16.543

快速回答：您必须编写自己的 cordova/phonagap 插件。

更长的答案：

在 cordova/phonegap 中建立 HTML 和本机电话 API 之间的通信的唯一方法是使用 Phonegap 插件 API。插件 API 充当手机和浏览器 JS 之间的桥梁。

您必须为目标平台和 JS 编写本机代码。

最棘手的部分是在 JS 站点上统一处理来自不同移动平台的不同原生 API。对于单个目标平台，复杂性是可以管理的。

Phonegap 有一个 github 页面，其中几乎所有可用的插件都是开源的。您可以将它们用作示例。也有一些教程可用。

# c++ - 使用 ffmpeg 解码 h264 rtsp 并分离 AVCodecContext

> ID：11261551
> 
> 赞同：6
> 
> 时间：2012-06-29T12:11:13.960
> 
> 标签：c++, ffmpeg, h.264, rtsp

我需要一些有关解码 rtsp 视频流的帮助。我从 AXIS IP-camera 得到它。我为此使用 ffmpeg 库。需要单独创建 AVCodecContext，而不是从 AVFormatContext->streams[...]->codec；

所以我创建了 AVCodec、AVCOdecContext 并尝试初始化它们。

```
AVCodec *codec=avcodec_find_decoder(codec_id);
if(!codec)
{
    qDebug()<<"FFMPEG failed to create codec"<<codec_id;
    return false; //-->
}

AVCodecContext *context=avcodec_alloc_context3(codec);
if(!context)
{
    qDebug()<<"FFMPEG failed to allocate codec context";
    return false; //-->
}
avcodec_open2(context, codec, NULL); 
```

然后在应用程序的主循环中，我获取帧数据并尝试解码：

```
_preallocatedFrame = avcodec_alloc_frame();
avcodec_decode_video2(_context, _preallocatedFrame, &got_picture, &_packet); 
```

在这里，我在控制台中收到很多消息：

```
[h264 @ 1f177720] decode_slice_header error
[h264 @ 1f177720] no frame!
[h264 @ 1f177720] non-existing PPS 0 referenced
[h264 @ 1f177720] decode_slice_header error
[h264 @ 1f177720] no frame!
[h264 @ 1f177720] non-existing PPS 0 referenced
[h264 @ 1f177720] decode_slice_header error
[h264 @ 1f177720] no frame!
[h264 @ 1f177720] non-existing PPS 0 referenced
[h264 @ 1f177720] decode_slice_header error
[h264 @ 1f177720] no frame!
[h264 @ 1f177720] non-existing PPS 0 referenced
[h264 @ 1f177720] decode_slice_header error
[h264 @ 1f177720] no frame!
[h264 @ 1f177720] non-existing PPS 0 referenced
[h264 @ 1f177720] decode_slice_header error
[h264 @ 1f177720] no frame! 
```

你能给我一些建议吗，如何初始化 AVCodecContext 或其他东西来正确地做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T18:50:28.713

你需要做更多的工作。如果要解码 h.264 流，则需要向解码器传递“sps pps”数据。可以在 rtp 流本身上找到此数据，[请参阅](https://stackoverflow.com/questions/9618369/h-264-over-rtp-identify-sps-and-pps-frames)

或在 SDP 中的 rtsp 协商中。在您成功地向解码器提供此数据后，解码应该可以工作。

# android - 如何使用 xml pull parser 从服务器读取 android 中的 pdf

> ID：11261553
> 
> 赞同：-1
> 
> 时间：2012-06-29T12:11:28.253
> 
> 标签：android

如何使用 xml pull 解析器从服务器读取 pdf 文件并以 pdf 格式查看内容...这是 xml 文件

```
<id>1</id>
        <class>Std-1</class>
        <subject>English</subject>
        <releasedate>2012-02-22T13:56:28Z</releasedate>
        <image>http://msnapi.cricbuzz.com/flags/team_12_100.png</image>
    <downloadurl>http://www.poemhunter.com/i/ebooks/pdf/henrik_wergeland_2012_6.pdf</downloadurl>

</std> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:18:03.363

收到 XML 数据后，对其进行解析以检索 PDF 的 URL。

建立 http 连接以下载 PDF。下载后，您可以通过 2 种不同的方式打开它。

1.  让系统来处理它，以便任何处理该 mime 类型的应用程序都可以打开它，但这意味着您假设有一个 PDF 阅读器。
2.  务实地使用 PDF 库来阅读 PDF。

[这个 SO Post 有一些 PDF 库的链接。](https://stackoverflow.com/questions/2456344/display-pdf-within-app-on-android)

[这个参考了另一个](https://stackoverflow.com/questions/2456344/display-pdf-within-app-on-android)

# forms - struts2（freemarker）中的预选选项

> ID：11261558
> 
> 赞同：0
> 
> 时间：2012-06-29T12:11:44.590
> 
> 标签：forms, select, struts2, tags, freemarker

我无法让我的 freemarker struts2 选择标签显示与对象相关的选项列表的默认值。

在我的行动中，我有：

```
private List<CodeLabel> modifRoomTypeOpt; 
```

在里面我有对象 CodeLabel 的值，比如 S:Single, D:Double,...

```
<@s.select id="123123"
  name="roomModif[2].type"
  value="${modifiedRoom.type}"
  list="modifRoomTypeOpt" listKey="code" listValue="label"/> 
```

在生成的 html 中，我可以看到具有值 S、D、T、... 和标签 Single、Double、... 的选项，因此完成了对我的 CodeLabel 对象的迭代。但在我的选择中，第一个选项始终是预先选择的。我检查了 ${modifiedRoom.type} 的值及其“D”。为什么没有预先选择值为 D 的选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T11:31:29.337

有趣的，

我做了一些调查和代码调试，发现*value*属性被评估为 OGNL 变量。这意味着 Struts2 在堆栈中查找与您放入*value*属性中的字符串匹配的变量。

然后在内部将评估结果作为*nameValue*放入属性列表中。

所以我惊讶地发现，使用属性*nameValue*而不是*value*是一个很好的解决方法，可以让 select 元素预先选择一个给定的值。

在你的情况下：

```
<@s.select id="123123"
name="roomModif[2].type"
nameValue="${modifiedRoom.type}"
list="modifRoomTypeOpt" listKey="code" listValue="label"/> 
```

或者也：

```
<@s.select id="123123"
name="roomModif[2].type"
nameValue=modifiedRoom.type
list="modifRoomTypeOpt" listKey="code" listValue="label"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T08:28:41.773

要设置默认值，您需要设置 select 标签的 value 属性，例如：

```
<@s.select id="123123"
name="roomModif[2].type"
value="${modifiedRoom.type}"
list="modifRoomTypeOpt" listKey="code" listValue="label"
value="modifRoomTypeOpt.get(1)"   /> 
```

该代码尚未经过测试，但我相信它应该可以工作。供参考使用[http://struts.apache.org/2.0.12/docs/select.html](http://struts.apache.org/2.0.12/docs/select.html)

如果要在选择元素上设置默认标题，请使用 headerKey 和 headerValue 属性。

# iphone - 尝试重新购买时未调用 SKPaymentTransactionStateRestored

> ID：11261566
> 
> 赞同：2
> 
> 时间：2012-06-29T12:12:16.087
> 
> 标签：iphone, ios, ios4, in-app-purchase

我正在实施应用程序购买（SONGS-non consumable - content delivery from my server）。

当我尝试购买已经购买的商品时，我从未收到**SKPaymentTransactionStateRestored**委托方法被调用。

我总是收到**SKPaymentTransactionStatePurchased**通知。但是 Apple 的警报是“**您已经购买了这个项目，点击确定下载**”但根本没有调用**SKPaymentTransactionStateRestored 。**

在这个场景中，这个 SKPaymentTransactionStateRestored 不会被调用吗？或者这是一个预期的行为。

请告诉我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T00:20:16.237

对于非消耗性 IAP 恢复，我也看到了这一点。我认为这是一个沙盒问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T13:18:37.263

`SKPaymentTransactionStateRestored`仅在您致电后发出`restoreCompletedTransactions`。

由于您提到“您已经购买”消息，这意味着您没有调用此方法，而是使用标准购买流程。`SKPaymentTransactionStatePurchased`在这种情况下，预计会得到。

# iphone - 如何测试 iPhone 项目？

> ID：11261585
> 
> 赞同：1
> 
> 时间：2012-06-29T12:13:30.240
> 
> 标签：iphone, unit-testing

我是 iPhone 新手。任何人都可以一步一步地告诉iphone单元。我试过[这个](http://developer.apple.com/library/ios/#DOCUMENTATION/DeveloperTools/Conceptual/UnitTesting/02-Setting_Up_Unit_Tests_in_a_Project/setting_up.html#//apple_ref/doc/uid/TP40002143-CH3-SW1)。但我有一些错误，比如

```
Undefined symbols for architecture i386:
  "_CLLocationCoordinate2DMake", referenced from:
      -[FileManager setLatitude:andLongitude:] in FileApiManager.o 
```

我希望我在之前的步骤中犯了一些错误。任何人都可以告诉我如何配置测试项目的便捷方法或逐步过程吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:00:44.853

看起来您缺少库引用，但从错误消息中我无法告诉您是哪一个。您是否使用任何自定义库进行测试/开发？您是否正确包含它们？

Project Overview -> Build Phases -> Link Binary With Libraries 是你可以去检查的地方。仔细检查并确保按照 Yannick 的建议包含 CLLocation 和 CoreLocation。

# iphone - iOS，没有关闭按钮的警报？

> ID：11261587
> 
> 赞同：5
> 
> 时间：2012-06-29T12:13:39.237
> 
> 标签：iphone, ios

我想显示一个没有按钮的警报窗口，这意味着用户不能自己关闭它，只有我的代码可以关闭警报。如何实施？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-29T12:14:57.653

```
UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"Hello World!"
                                                  message:@"This is sample message."
                                                 delegate:self
                                        cancelButtonTitle:nil
                                        otherButtonTitles:nil];
message.tag = 123;
[message show];
[message release] 
```

用它来发出警报，没有按钮

要关闭警报视图，请使用类似于此的一些逻辑

```
UIAlertView *alert = (UIAlertView)[[self.view viewWithTag:123]
[alert dismissWithClickedButtonIndex:0 animated:TRUE]; 
```

# c# - XPath 没有拾取 dd 标签

> ID：11261589
> 
> 赞同：1
> 
> 时间：2012-06-29T12:13:42.190
> 
> 标签：c#, xpath, html-agility-pack

我正在构建一个应用程序来从网站中提取新闻项目，但是无法让它找到带有 dd 标签的节点

关于我哪里出错的任何想法？

HTML

```
<h1>INFO: New Prices</h1>
<dl class='table'>
    <dt>Department:</dt><dd>Sales</dd>
    <dt>Start Date:</dt><dd>28/06/2012</dd>
    <dt>End Date:</dt><dd>20/07/2012</dd>
    <dt>Approved Date:</dt><dd>Jun 28 2012  3:11PM</dd>
</dl> 
```

C# 代码

```
public void CollectNewsItem(UInt64 aSID)
{
    String URL = WebReader.storyLink + "?SID=" + aSID;

    HtmlWeb hw = new HtmlWeb();
    HtmlDocument document = hw.Load(URL);

    HtmlNode n = document.DocumentNode.SelectSingleNode("//h1");

    Console.WriteLine("Title: " + n.InnerText);

    HtmlNodeCollection nodes = document.DocumentNode.SelectNodes("//dd");

    foreach (HtmlNode node in nodes)
    {
        Console.WriteLine(node.InnerText);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T03:33:41.327

在使用 HtmlAgilityPack 时，我更喜欢使用 LINQ。在这种情况下，您的选择将如下所示：

```
IEnumerable<HtmlNode> nodes = document.DocumentNode.Descendants("dd"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:21:00.303

这是根据此线程的正确方法：

[如何解析这些标签？](http://htmlagilitypack.codeplex.com/discussions/251811)

为确保它正常工作，请执行以下操作：

```
var node = document.DocumentNode.SelectSingleNode("//[dt='Department:']"); 
```

`dt`它至少应该拿起第一个。如果不是，那么您的 HTML 标记一定有问题，解析器会感到困惑！:)

另一件事要尝试...将 HTML 复制/粘贴到一个简单的 HTML 文件中并提供您的代码。

替换这一行（单引号之间的表格）：

```
<dl class='table'> 
```

用这个（双引号之间的表）：

```
<dl class="table"> 
```

如果上述方法仍然不起作用，请尝试在关闭每个`<\dt>`标签之前删除冒号 ( : )。这样做是为了找出导致问题的原因。

# asp.net-mvc - MVC 剃刀 @foreach

> ID：11261590
> 
> 赞同：91
> 
> 时间：2012-06-29T12:14:00.490
> 
> 标签：asp.net-mvc, razor

我听说在视图中使用 @foreach 是不行的。意思是，视图中不应该有任何逻辑。@foreach 的逻辑应该在哪里的最佳实践是什么？

```
 @foreach.. 
```

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2012-06-29T12:17:13.657

> @foreach 的逻辑应该在哪里的最佳实践是什么？

无处可去，只是摆脱它。您可以使用编辑器或显示模板。

例如：

```
@foreach (var item in Model.Foos)
{
    <div>@item.Bar</div>
} 
```

完全可以用显示模板代替：

```
@Html.DisplayFor(x => x.Foos) 
```

然后您将定义相应的显示模板（如果您不喜欢[默认的](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-3-default-templates.html/)）。因此，您将定义一个可重用的模板`~/Views/Shared/DisplayTemplates/Foo.cshtml`，该模板将由框架自动为 Foos 集合 ( `IEnumerable<Foo> Foos { get; set; }`) 的每个元素呈现：

```
@model Foo
<div>@Model.Bar</div> 
```

显然，完全相同的约定适用于编辑器模板，如果您想显示一些允许您编辑视图模型的输入字段，而不是仅将其显示为只读，则应使用这些约定。

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2012-06-29T12:23:19.230

当人们说不要在视图中放置逻辑时，他们通常指的是业务逻辑，而不是渲染逻辑。以我的拙见，我认为在视图中使用 @foreach 非常好。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-06-29T12:21:39.173

我在`@foreach`发送包含实体列表的实体时使用（例如，在 1 个视图中显示 2 个网格）

例如，如果我将包含`Foo1(List<Foo1>)`和的实体 Foo 作为模型发送`Foo2(List<Foo2>)`

我可以参考第一个列表：

```
@foreach (var item in Model.Foo.Foo1)
{
    @Html.DisplayFor(modelItem=> item.fooName)
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-06-29T12:29:38.960

对于我在剃刀视图中使用 foreach 的情况，回复@DarinDimitrov。

```
<li><label for="category">Category</label>
        <select id="category">
            <option value="0">All</option>
            @foreach(Category c in Model.Categories)
            {
                <option title="@c.Description" value="@c.CategoryID">@c.Name</option>
            }
        </select>
</li> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-09-05T11:07:05.357

[使用重载指示模板时，答案](https://stackoverflow.com/a/11261629/4419939)将不起作用`@Html.DisplayFor(x => x.Foos, "YourTemplateName)`。

似乎是这样设计的，[看这个案例](https://stackoverflow.com/a/8002146/4419939)。此外，框架给出的异常（关于类型不符合预期）非常误导并在第一次尝试时愚弄了我（感谢@CodeCaster）

在这种情况下**，您必须**使用`@foreach`

```
@foreach (var item in Model.Foos)
{
    @Html.DisplayFor(x => item, "FooTemplate")
} 
```

# java - Java找不到主类

> ID：11261593
> 
> 赞同：1
> 
> 时间：2012-06-29T12:14:25.313
> 
> 标签：java

我有一个简短的问题，我用 java 写了这个。旧代码：

```
 class apples{
        public static void main(String args[]){
            System.out.println("hello Youtube");
        }
    } 
```

新代码

```
public class apples{
        public static void main(String args[]){
            System.out.println("hello Youtube");
        }
    } 
```

Eclipse 给我这个错误：

*错误：无法找到或加载主类苹果*

我究竟做错了什么？我正在观看来自 bucky 的本教程：[Youtube](http://www.youtube.com/watch?v=SHIT5VkNrCg&feature=bf_prev&list=PLFE2CE09D83EE3E28)

*第二个问题：*

在教程中有类似自动完成的东西。如何在 Eclipse 中打开它？

**修复：打开文件而不是类感谢大家的帮助！**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T12:15:18.400

必须有一个`public`类才能让 JVM 识别 main 方法。

另外，尝试使用包声明。你可以有一些简单的东西，比如`package com.foo.examples;`.

对于您的第二个问题：在 Eclipse 中默认打开自动完成功能。事实上，我不知道如何关闭它！

只需在各个地方使用快捷键`Ctrl`+`Space`看看会发生什么。您还可以输入一个类，`System`然后输入一个点，然后查看类的可见静态方法的所有自动完成条目`System`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:27:00.687

对于第二个问题：

通过自动完成，您可能是指“内容辅助”

您可以通过以下方式配置它：

```
Preferences>Java>Editor>Content Assist 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:30:01.520

最好使用包并将主要方法声明为公共的，但不是必需的。你在第 3 行犯了一个错误——它应该以 semi 结尾：

```
System.out.println("hello Youtube"); 
```

对于第 2 季度，在您键入代码时，自动完成案例与控制空间热键（默认情况下）一起出现。

UPD：抱歉，您必须将 main 方法声明为 public，但不必将类公开

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-05T07:26:15.750

该方法必须声明为 public 和 static，它不能返回任何值，并且它必须接受一个 String 数组作为参数。方法声明具有以下形式：

```
public static void main(String[] args)
{
    //Your code here
    System.exit(0); //Ending the program and return the given code (0 here)
} 
```

对不起第二个问题。

# ms-access - 计算通过更改标签标题发送的电子邮件

> ID：11261597
> 
> 赞同：1
> 
> 时间：2012-06-29T12:14:46.893
> 
> 标签：ms-access, vba, ms-access-2007

我的表格中有一个标签。我希望这个标签随着电子邮件的发送而动态变化。标签上的标题必须为 140 中的 1，依此类推。

我在我的里面有这个代码`Do .... Loop`：

```
emailTotal = "SELECT COUNT(EMail) FROM ( SELECT DISTINCT EMail FROM Names)" 
```

我在这里遇到类型不匹配，不明白为什么。

有用的信息：`Dim emailTotal as integer`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:38:17.570

你需要的是：

```
Dim rs As DAO.Recordset
sSQL = "SELECT COUNT(EMail) As ECount FROM ( SELECT DISTINCT EMail FROM Names)"
Set rs = CurrentDB.OpenRecordset (sSQL)

EmailTotal = rs!ECount 
```

但是您可以使用 DCount 或 DlookUp 和保存的查询进行简化。

# java - Selenium abotring 与“UnreachableBrowserException/Address already in use”发生在一台计算机上

> ID：11261602
> 
> 赞同：7
> 
> 时间：2012-06-29T12:15:01.087
> 
> 标签：java, firefox, selenium, webdriver

我有一个 java webdriver 驱动的 selenium 执行，它在列表上循环以将不同的信息输入到文本框中并使用 FirefoxDriver 发送它。

在一台计算机上，非常可重现，在第 10 次或第 11 次迭代之后， `findElement(By.id("mi4"))`调用`UnreachableBrowserException`.

```
Jun 29, 2012 1:52:02 PM org.apache.http.impl.client.DefaultRequestDirector tryConnect
Information: I/O exception (java.net.BindException) caught when connecting to the target host: Address already in use: connect
Jun 29, 2012 1:52:02 PM org.apache.http.impl.client.DefaultRequestDirector tryConnect
Information: Retrying connect
Jun 29, 2012 1:52:02 PM org.apache.http.impl.client.DefaultRequestDirector tryConnect
Information: I/O exception (java.net.BindException) caught when connecting to the target host: Address already in use: connect
...
Exception in thread "main" org.openqa.selenium.remote.UnreachableBrowserException: Error communicating with the remote browser. It may have died.
Build info: version: '2.24.1', revision: '17205', time: '2012-06-19 15:28:49'
System info: os.name: 'Windows XP', os.arch: 'x86', os.version: '5.1', java.version: '1.7.0_04'
Driver info: driver.version: RemoteWebDriver
   at org.openqa.selenium.remote.RemoteWebDriver.execute(RemoteWebDriver.java:467)
   at org.openqa.selenium.remote.RemoteWebDriver.findElement(RemoteWebDriver.java:242)
Caused by: java.net.BindException: Address already in use: connect
   at java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method)
   at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)
   at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)
   at org.openqa.selenium.remote.HttpCommandExecutor.fallBackExecute(HttpCommandExecutor.java:337)
   at org.openqa.selenium.remote.HttpCommandExecutor.execute(HttpCommandExecutor.java:297)
   at org.openqa.selenium.firefox.internal.NewProfileExtensionConnection.execute(NewProfileExtensionConnection.java:136) 
```

没有第三方程序监听任何端口。但是，我使用了 FirefoxDriver 的两个实例，这意味着两个 Firefox 实例/Windows 并行打开，这在 Win7 机器上运行没有任何问题，所描述的问题发生在 Windows XP 机器上。

我使用带有 selenium 2.24.1 的 Firefox 13。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T15:37:39.513

听起来您的临时端口用完了，因为您一遍又一遍地迭代。在 Windows XP 中，临时 TCP 端口的默认最大数量为 5000。[尝试根据此处](http://support.microsoft.com/kb/q196271)的 Microsoft 知识库文章中的解决方案增加限制。重新启动机器。这个解决方案对我有用。

# javascript - 使用模块模式时如何使用 JSDoc 记录子命名空间

> ID：11261603
> 
> 赞同：2
> 
> 时间：2012-06-29T12:15:08.597
> 
> 标签：javascript, jsdoc

我正在尝试使用 jsdoc-toolkit 在特定模块模式内记录函数，其中命名空间是在模块外部定义的。附加到它的函数位于立即调用函数中。我从工具输出中得到的是：

**警告：试图将 isObject 记录为未记录符号 CORE 的成员。**

这是代码的简化版本：

```
/**
 * @namespace The framework's top namespace
 * */
var FX = {
  /**
   * @namespace The core framework functions
   */
  core: {
  }
};

(function( CORE, GLOBAL ) {

    'use strict';

    var _isObject;

    CORE.isObject = _isObject = function( object ) {

        if (null === object || (void 0) === object) {
            return false
        }

        return true;

    };

    return CORE;

})(this.FX.core, this); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T13:22:08.970

您可以尝试使用该`@memberOf`标签，它允许您记录您认为对象的“父级”或容器是什么。

```
/** 
 * @memberOf FX.core 
 */
CORE.isObject = _isObject = function( object ) {
    // ...
};
// ... 
```

语法：`@memberOf parentNamepath`, parentNamepath 是包含对象的名称路径。

# c# - C# UserControl 键盘快捷键

> ID：11261606
> 
> 赞同：1
> 
> 时间：2012-06-29T12:15:22.380
> 
> 标签：c#, user-controls, keyboard-shortcuts

我创建了一个具有多个文本框、组合框等的用户控件。用户控件托管在普通表单上。我想为文本框、组合框分配键盘快捷键。因此，当同时按下 Ctrl + F 时，焦点将放在其中一个文本框上。我尝试使用 OnPreviewKeyDown 检查键，然后在用户控件上触发 key down 方法。调试器甚至没有点击表单上的 OnPreviewKeyDown 方法。我已在表单上启用 keyPreview 为真。我在下面提供了一些我的实验。

谁能指出我哪里出错了？我无法相信这样的事情是如此困难。我一定错过了一些简单的东西。谢谢

```
protected override void OnPreviewKeyDown(PreviewKeyDownEventArgs e)
    {
        Keys k = e.KeyCode;

        UserControl1.UserControl_KeyPress(k);
    }

    public void UserControl_KeyPress(object sender, KeyPressEventArgs e)
    {
        if (e.KeyChar == 'F')
            tbxHostName.Focus();

        switch (e.KeyCode)
        {
            case Keys.F:
                this.cmbxProtocol.Focus();
                break;
            case Keys.H:
                this.tbxHostName.Focus();
                break;
            default:
                break;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:23:52.450

我建议尝试[KeyDown Event](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keydown.aspx)。它接受一个[KeyEventArgs](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.aspx)参数，其中包括一个专门用于 Ctrl 键 ( [KeyEventArgs.Control](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.control.aspx) ) 的布尔值。

在您的情况下，您会将[KeyCode](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.keycode.aspx)属性与[Keys.F](http://msdn.microsoft.com/en-us/library/system.windows.forms.keys.aspx)进行比较以查看是否`F`被按下，并检查是否`Control`为真。例如：

```
public void UserControl_KeyDown(object sender, KeyEventArgs e) 
{ 
    if (e.Control)
    {
        switch (e.KeyCode) 
        { 
            case Keys.F: 
                this.cmbxProtocol.Focus(); 
                break; 
            // Other cases ...
            default: 
                break; 
        }
    }
} 
```

或者，如果你真的想坚持你的`KeyPress`事件，你可以检查静态[Control.ModifierKeys](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.modifierkeys.aspx)属性的值，看看是否按下了 Ctrl 键，如下所示：

```
if( (Control.ModifierKeys & Keys.Control) == Keys.Control )
{
    //...
} 
```

# php - 将变量从 php 传递到 javascript（安全）

> ID：11261607
> 
> 赞同：3
> 
> 时间：2012-06-29T12:15:23.830
> 
> 标签：php, javascript

我一直在为这类问题苦苦挣扎，似乎找不到任何信息或示例代码来在 PHP 和 JavaScript 之间传输一些数据。我看到了很多方法来做到这一点，但并不安全。我的意思是，当您在系统之间传输一些可变数据时，它会在加载时直接显示在页面的视图源窗口中。真正需要的是一种传输数据的方法，但要安静且安全，以便在页面加载时不会出现在用户端。

简而言之，有没有办法做到这一点，可能怎么做？

我已经尝试过，使用 XML 文件传输数据，也可以使用 JSON 传输数据，直接使用 echo + 或在 ?> php 中的缩写之后。但是到目前为止我使用的每一种方式，在加载时都会显示在页面的源代码中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:32:05.900

由于 JavaScript 和网络的性质，您所要求的实际上是不可能的。有一些方法可以混淆数据，并将其隐藏在只能请求一次的 xhttp / ajax 请求中。但是为了将数据发送到客户端，客户端必须能够读取它，这意味着知道自己在做什么的用户（即安装了 FireBug 并且可以编写 JavaScript）总是可以对其进行解码并看到它。

如果我是你，我会看一些简单形式的编码或加密 JSON（并通过 ajax/xhttp 通过 HTTPS 请求数据），这会让大多数人望而却步，但精通技术的人仍然能够找到解密的方法内容。但是，如果内容需要 100% 安全 - 来自所有人，甚至是实际使用该站点的用户 - 那么您根本不想将该数据发送给客户端。

*基本上它归结为您实际发送的数据是什么？如果是需要客户端上的数据来执行特定计算的问题，请问自己 - 是否可以仅将涉及的用户输入从 JavaScript 发送回 PHP（通过 ajax/xhttp），然后让 PHP 返回答案. 这样，PHP 只需要访问您的敏感数据。*

# jquery - appending a form element until comma is pressed

> ID：11261615
> 
> 赞同：2
> 
> 时间：2012-06-29T12:15:56.930
> 
> 标签：jquery, html

I have a form to which I am appending form elements on the click event. I want to append options to a drop down(select options) which is created dynamically as the user types the input.

The user input is saved in a variable as he types using the keyup event in the following manner:

```
$("#options_"+id).keyup(function(){

        var val_options = $('#options_'+id).val(); //user input is stored in the variable val_options

        var options = val_options.split(','); //input is exploded with a comma       

        var len = options.length;

            for(var i =0;i<len;i++)
            {                   

                var drop_options = "<option id='option_'"+i+">"+options[i]+"</option>";
                $("#select_"+id).append(drop_options);                  
            }

    }); 
```

Now the tags created dynamically are appended to the tag having that particular id.

The problem I am facing here is that when the user types a single character, it gets appended as an option in the drop down menu. I only want it to append when the user presses the comma (,) key.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:24:07.810

Try something like this:

```
$("#options_"+id).keyup(function(event){
    if (event.which !== 188) { // 188 is the keycode for ','
        return; // Do nothing.
    }

    var $this = $(this),
        val_options = $this.val(),
        options = val_options.split(','),
        $dropdown = $("#select_"+id);

    $dropdown.empty();

    for(var i =0;i<options.length-1;i++) {
        $dropdown.append(
            "<option id='option_'"+i+">"+options[i]+"</option>"
        );                  
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T12:24:31.917

```
$("#options_" + id).keyup(function(e) {

    var val_options = $(this).val(); // getting input values
        options = val_options.split(','); // getting all values as array

    // checking for comma
    if (val_optons.indexOf(',') >= 0 ) {

        // if comma found then start append
        var options = val_options.split(',');
        var drop_options = ''; // take an empty string

        // looping over all values with
        // input fields separated by comma

        for (var i = 0; i < options.length; i++) {

            // making string of all options
            drop_options += "<option id='option_'" + i + ">" + options[i] + "</option>";
        }

        // append all option to select
        // here .html() will remove all previous
        // options and append newly 

        $("#select_" + id).html(drop_options);

    }
}); 
```

**[DEMO](http://jsfiddle.net/QStkd/531/)**

Calling `.append()` within loop cause slower performance, so try to avoid that.

# iphone - 到 UIView 帧缩放动画

> ID：11261618
> 
> 赞同：3
> 
> 时间：2012-06-29T12:16:02.753
> 
> 标签：iphone, ios, ipad, uianimation

我正在尝试添加一个带有过渡样式缩放动画的 UIView，如下所示：

```
 ^
     |
 <---.--->
     |
     v 
```

视图从一个小框架 (centerParent.x, centerParent.y,20, 20) 开始，然后更改为 (centerParent.x, centerParent.y,300, 300)。

但是当我改变框架时，我必须从视图的位置（0.0）开始改变它，而不是因为它的中心点。有谁知道该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T13:01:15.380

使用您当前使用的方法（不使用转换，而只是调整视图大小），您只需要重置视图的原点或中心）。最简单的是中心：

```
 view.frame = CGRectMake(0, 0, 20, 20);
    CGPoint center = view.center;
    [UIView animateWithDuration: 1.0f animations:^{
        view.frame = CGRectMake(0, 0, 300, 300);
        view.center = center;
    }]; 
```

您还可以通过移动从 x 和 y 减去 1/2 大小变化的差异来重置原点，但这更多的是数学：

```
view.frame = CGRectMake(0, 0, 20, 20);
    CGPoint origin = view.frame.origin.
    [UIView animateWithDuration: 1.0f animations:^{
        origin.x -= (300 - 20) / 2;
        origin.y -= (300 - 20) / 2;
        view.frame = CGRectMake(origin.x, origin.y, 300, 300);
    }]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:37:24.073

要缩小视图，同时保持它自己的中心很容易，但您需要使用变换。这是一个代码。只需添加并连接一个视图，将其命名为 zoomerView。

在这个例子中，我只是将这个添加到主视图中，触摸结束。

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    CGPoint center = zoomerView.center;
    [UIView animateWithDuration:1 animations:^{
        zoomerView.transform = CGAffineTransformScale(zoomerView.transform, 1.2, 1.2);
    }];
} 
```

希望这可以帮助你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:40:21.387

试试这个

```
[UIView animateWithDuration:secs delay:1.0 options:option
                     animations:^{
                         yourview.transform = CGAffineTransformScale(view.transform, 100.0, 100.0);
                     }
                     completion:nil]; 
```

# node.js - 字符串比较失败

> ID：11261619
> 
> 赞同：3
> 
> 时间：2012-06-29T12:16:11.060
> 
> 标签：node.js, tcp, comparison

我已经构建了一个简单的 TCP 服务器，需要将客户端输入与存储在变量中的硬编码字符串进行比较。

但是，`data == username`总是失败。

为什么？我能做些什么呢？

这个例子：

```
var authenticateClient = function(client) {
    client.write("Enter your username:");
    var username = "eleeist";
    client.on("data", function(data) {
        if (data == username) {
            client.write("username success");
        } else {
            client.write("username failure");
        }
    });
}

var net = require("net");
var server = net.createServer(function(client) {
    console.log("Server has started.");
    client.on("connect", function() {
        console.log("Client has connected.");
        client.write("Hello!");
        authenticateClient(client);
    });
    client.on("end", function() {
        console.log("Client has disconnected.");
    });
}).listen(8124); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T13:07:44.577

我已经使用客户端实现更新了您的代码。它会起作用的。
在“数据”事件中，回调将具有 Buffer 类的实例。所以你必须先转换为字符串。

```
var HOST = 'localhost';
var PORT = '8124';

var authenticateClient = function(client) {
    client.write("Enter your username:");
    var username = "eleeist";
    client.on("data", function(data) {
        console.log('data as buffer: ',data);
        data= data.toString('utf-8').trim();
        console.log('data as string: ', data);
        if (data == username) {
            client.write("username success");
        } else {
            client.write("username failure");
        }
    });
}

var net = require("net");
var server = net.createServer(function(client) {
    console.log("Server has started.");
    client.on("connect", function() {
        console.log("Client has connected.");
        client.write("Hello!");
        authenticateClient(client);
    });
    client.on("end", function() {
        console.log("Client has disconnected.");
    });
}).listen(PORT);

//CLIENT
console.log('creating client');
var client = new net.Socket();
client.connect (PORT, HOST, function() {
    console.log('CONNECTED TO: ' + HOST + ':' + PORT);
    client.write('eleeist\n');       
});
client.on('data', function(data) {
  console.log('DATA: ' + data);
  // Close the client socket completely
  //    client.destroy();
});

client.on('error', function(exception){ console.log('Exception:' , exception); });
client.on('timeout', function() {  console.log("timeout!"); });
client.on('close', function() { console.log('Connection closed');  }); 
```

# user-interface - 如何创建像文本填充这样的拆分 Office 功能区按钮

> ID：11261620
> 
> 赞同：2
> 
> 时间：2012-06-29T12:16:28.110
> 
> 标签：user-interface, vsto, ms-office, ribbon

我想在 Microsoft Office 中创建一个功能区按钮，以重现例如“文本填充”按钮的行为。它分为两个区域，左侧（红色）将执行默认/最后操作，右侧（蓝色）提供附加功能。

![文本填充](../Images/56952f54a5e31f5e5ae28b366702fd45.png)

我得到的最接近的是使用 a`splitButton`和`button`a `menu`。但是这里有一个带有默认操作文本的大按钮，只有一个带有三角形的小区域用于访问下拉菜单。以下是功能区代码和生成的按钮：

```
<splitButton id="SplitButton1" size="normal" >
  <button id="MenuButton1" imageMso="TextFillColorPicker" label="Text Fill" />
  <menu id="Menu1" label="Label1" itemSize="normal" showLabel="true">
    <button id="MenuButton2" label="Label2" />
  </menu>
</splitButton> 
```

![在此处输入图像描述](../Images/c5ae86333e3b6f6f7e31ac477af8efeb.png)

出于可用性原因，我想将（视觉）焦点完全放在下拉部分上，如图所示。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T09:12:28.563

由于自定义限制，我认为不可能做你想做的事......但你可以尝试定义一个盒子而不是一个 splitButton：

```
<box id="BoxSplit" boxStyle="horizontal">
  <button id="MenuButton1" imageMso="TextFillColorPicker" />
  <menu id="Menu1" label="Text Fill" itemSize="normal" showLabel="true">
    <button id="MenuButton2" label="Label2" />
  </menu>
</box> 
```

这将为您提供以下结果：

![带按钮和菜单的框，悬停按钮](../Images/6a4b16e2eb8718e5c4f9c36fff9cbed7.png)

![带按钮和菜单的框，悬停按钮](../Images/f5b4f562e0de1acbec4266ffdf31eac0.png)

如您所见，现在的问题是菜单和按钮没有一起突出显示。我希望这对你来说是可以接受的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T06:54:37.117

我认为 ControlSize 属性只有 2 个选项，常规或大。所以只需使用常规尺寸，并将图像添加到您的拆分按钮。

有关详细信息，请参阅此 API：http:
[//msdn.microsoft.com/en-us/library/microsoft.office.tools.ribbon.ribbonsplitbutton.controlsize](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.ribbon.ribbonsplitbutton.controlsize)

带有功能区 XML 的自定义 UI 示例

```
<splitButton id="splitButton"> 
     <button id="splitButton__btn" imageMso="AlignLeft" label="SplitButton" onAction="splitButton_Click" /> 
     <menu id="splitButton__mnu"> 
     <button id="btnAlignLeft" imageMso="AlignLeft" onAction="btnAlign_Click" label="Left" /> 
      </menu> 
</splitButton> 
```

MSDN 上的功能区 XML
[http://msdn.microsoft.com/en-us/library/aa942866.aspx](http://msdn.microsoft.com/en-us/library/aa942866.aspx)
[http://msdn.microsoft.com/en-us/library/gg327872](http://msdn.microsoft.com/en-us/library/gg327872)

也许您可能想尝试`<MenuSection>`标记

```
<MenuSection
 DisplayMode=["Default" | "Small" | "Medium"  | "Large"  | "Text"  | "Menu"  | "Menu16"  | "Menu32"  | "Thin"]
 Id="String"
 MaxHeight="String"
 Scrollable="true"
 Sequence="Integer"
 Title="String">
 [<Controls /> | <Gallery />]
</MenuSection> 
```

似乎您可以定义不同类型的显示模式。

[http://msdn.microsoft.com/en-us/library/gg334378.aspx](http://msdn.microsoft.com/en-us/library/gg334378.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-22T14:54:46.730

如果您需要完全复制功能区中的原始按钮，您可以使用以下代码：

```
<control idMso="FontColorPicker" imageMso="FontColorPicker"/> 
```

（我四处寻找这个，我找不到任何信息，所以我想有一天它可能对某人有用）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-13T14:24:41.390

声明 splitButton 时，将 size 属性设置为“small”

# java - 摇摆组合框

> ID：11261621
> 
> 赞同：0
> 
> 时间：2012-06-29T12:16:34.590
> 
> 标签：java, swing, jdbc, jcombobox, itemlistener

我正在做的是，我正在创建动态下拉列表（jcombobox）。我面临第二个组合框的问题。每当我从 list1 中选择一个名称时，秒。列表显示其名称acc。首先列出没关系，但是当我再次从 list1 中选择不同的名称时，list2 继续显示以前的数据和新数据...我使用函数 removeallitems() 仍然无法从 list2 中删除以前的数据

```
public void itemStateChanged(ItemEvent e) {
  if (e.getSource() == combo) {
    statename = (String)combo.getSelectedItem();
    try {
      ResultSet rs2 =s.executeQuery("select distinct district_name from district_master where state_code=(select state_code from state_master where state_name='"+statename+"') order by district_name ");
      while(rs2.next()) {  
        districtlist.add(rs2.getString(1));
      }
      list_district  = new String [districtlist.size()];
      districtlist.toArray(list_district);
    } catch(Exception f) {
      f.printStackTrace();
      System.out.println(f);
    }
    combo1.setEnabled(true);
    combo1.removeAllItems();
    for (int i = 0; i < list_district.length; i++) {
      combo1.removeItem(list_district[i]);
      combo1.addItem(list_district[i]);
    }
  }
} 
```

我只给出了我面临问题的程序的一部分......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T12:19:29.050

每次运行查询时，您都不会清除您的地区列表。这意味着每次查询时，您都会将先前查询的项目添加到列表中。

尝试这样做。

```
districtlist.clear();
while(rs2.next())
{
    districtlist.add(rs2.getString(1));

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:21:58.740

在你的`while`循环之前，你应该清除你的项目列表：

```
districtlist.clear();
while(rs2.next()){
  //...
} 
```

# c# - C#中的整数转换

> ID：11261622
> 
> 赞同：14
> 
> 时间：2012-06-29T12:16:40.483
> 
> 标签：c#, int

```
 string[] strArray = new string[10] { "21.65", "30.90", "20.42", "10.00", "14.87", "72.19", "36.00", "45.11", "18.66", "22.22" };
        float temp = 0.0f;
        Int32 resConvert = 0;
        Int32 resCast = 0;
        for (int i = 0; i < strArray.Length; i++)
        {
            float.TryParse(strArray[i], out temp);
            resConvert = Convert.ToInt32(temp * 100);
            resCast = (Int32)(temp * 100);
            Console.WriteLine("Convert: " + resConvert + " ExplCast: " + resCast);
        } 
```

答：

```
 Convert: 2165 ExplCast: 2164   // ??
   Convert: 3090 ExplCast: 3089   // ??
   Convert: 2042 ExplCast: 2042
   Convert: 1000 ExplCast: 1000
   Convert: 1487 ExplCast: 1486   //??
   Convert: 7219 ExplCast: 7219
   Convert: 3600 ExplCast: 3600
   Convert: 4511 ExplCast: 4511
   Convert: 1866 ExplCast: 1865   //??
   Convert: 2222 ExplCast: 2221   //?? 
```

为什么在执行 Explicit Cast 时值有时会有所不同，但并非总是如此。任何原因 ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T12:25:06.033

举一个例子，`float`格式中的 21.65 实际上由一个数字表示，例如 21.6499999。将`Convert.ToInt32`数字四舍五入到最接近的整数，得到 21.65，而显式转换`(Int32)`只是截断（向零舍入），所以你得到 21.64。

如果您希望浮点数在计算机中以与打印出来相同的方式表示，请使用or`decimal`代替。`float``double`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T12:24:20.190

`Convert.ToInt32` [四舍五入到最接近的整数](http://msdn.microsoft.com/en-us/library/303w38b8.aspx)，直接转换只是截断数字。

因此，如果您由于浮点不精确而具有值`2165.99999whatever`而不是`2165.0`，则直接强制转换会在浮​​点之后截断所有值，而`Convert.ToInt32`四舍五入到最接近的整数。

示例：
`22.22f * 100.0f`结果类似于`2221.99993133544921875`.
所以`Convert.ToInt32`会将其**向上**舍入到预期值`2222`，而演员会将其截断为`2221`.

`45.11f * 100.0f`另一方面，结果是 about `4511.00006103515625`，
它**向下舍**`Convert.ToInt32`入，结果是，与直接铸造时的结果相同。**`4511`**

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T12:32:15.047

继Botz3000 answer之后，MSDN的相关部分：

[Convert.ToInt32 方法（单个）](http://msdn.microsoft.com/en-us/library/303w38b8)

> 返回值 类型：System.Int32 值，四舍五入到最接近的 32 位有符号整数。如果 value 在两个整数的中间，则返回偶数；即4.5转换为4，5.5转换为6。

[显式数值转换表](http://msdn.microsoft.com/en-us/library/aa288039%28v=vs.71%29.aspx)

> • 当您从双精度或浮点值转换为整数类型时，该值将向零舍入到最接近的整数值。如果生成的整数值超出目标值的范围，则结果取决于溢出检查上下文。在已检查的上下文中，会引发 OverflowException，而在未检查的上下文中，结果是目标类型的未指定值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T12:24:46.453

我想你会发现问题是由浮点精度不准确引起的，特别是使用`float`. 您会发现使用`decimal`. 关于十进制和双精度（和浮点）之间的区别有一个非常好的答案：[十进制与双精度！- 我应该使用哪一个以及何时使用？](https://stackoverflow.com/questions/1165761/decimal-vs-double-which-one-should-i-use-and-when)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-29T12:36:13.360

调用 Convert.ToInt32 就像调用：

`(int) Math.Round(floatValue, 0);`

直接投射就像调用

`(int) Math.Floor(float);`

Floor 总是给你一个小于或等于你在参数中提供的值的值。浮点表示不是“精确的”。所以 21.65 可能表示为 21.649999 或类似的，因为没有足够的精度。

所以：21.65 *100 = 2164.9999 地板这个值应该给你一个小于或等于 2164.9 的整数......即：2164

另一方面，四舍五入 2164.99 会给你： 2165

你可以在这里看到效果：

```
Console.WriteLine(Math.Round(21.65f*100));  //2165
Console.WriteLine(Math.Floor(21.65f*100));  //2164 
```

使用双精度而不是浮点数（更精确，但仍然不是无限的）：

```
Console.WriteLine(Math.Round(21.65d*100));  //2165
Console.WriteLine(Math.Floor(21.65d*100));  //2165 
```**

# haskell - 没有 -XScopedTypeVariables 的重构

> ID：11261625
> 
> 赞同：2
> 
> 时间：2012-06-29T12:16:48.250
> 
> 标签：haskell

我有一个函数（在模块中），它返回`IO (Maybe a)`a 是`Serialize`.

在我的主程序中，我将其称为如下：

```
 msg <- fun token
 print msg 
```

并得到错误

```
Ambiguous type variable `a0' in the constraints:
      (Data.Serialize.Serialize a0) arising from a use of `foo'
                                    at test_00.hs:13:15-19
      (Show a0) arising from a use of `print' at test_00.hs:17:9-13
    Probable fix: add a type signature that fixes these type variable(s) 
```

我确切地知道问题出在哪里，我可以使用 -XScopedTypeVariables 修复它，并对我调用库函数的方式进行一些更改，如下所示：

```
(msg :: Maybe String) <- cwPop token
print msg 
```

但是，我宁愿避免使用 ScopedTypeVariables 并想知道在哪里可以测试 msg 是否是 show 类的成员然后打印它。如果不做别的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T12:22:36.400

`<-`您可以为不带扩展名的右侧的表达式提供类型签名，

```
msg <- fun token :: IO (Maybe String)
print msg 
```

（我已经做了缩进，因此`print`不再`msg`是争论`fun`，你的缩进似乎被打破了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T03:19:00.563

另一种可能：

```
msg <- fun token
print (msg :: Maybe String) 
```

（这里没有动态类型，尽管它看起来像 - 我们只需要让类型检查器获得更多信息，风格如何）

# wordpress - Techprocess 支付网关 Wordpress 插件

> ID：11261627
> 
> 赞同：-1
> 
> 时间：2012-06-29T12:17:09.893
> 
> 标签：wordpress, payment-gateway

嗨，伙计们，我有 TechProcess 支付网关 PHP 文件，请任何人帮助我创建 wordpress 插件或为我创建插件，我准备为我付款

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T05:01:47.607

我知道一位来自印度的供应商可以在这方面为您提供帮助， [http](http://fifthdimensiontech.com) ://fifthdimensiontech.com 他们已经在 worpress 和 woocommerce 上集成了机器人技术流程和 ccavenue。您可以在他们的网站上找到联系信息。希望能帮助到你 ：）

# php - Yii 如何在执行之前显示呈现的查询

> ID：11261628
> 
> 赞同：0
> 
> 时间：2012-06-29T12:17:10.880
> 
> 标签：php, mysql, yii

在 Yii 中，如何在执行之前显示呈现的查询。

```
$sql="SELECT * from users WHERE user_id = :user_id";
    $command=Yii::app()->db->createCommand($sql);
    // replace the placeholder ":user_id" with the actual username value
    $command->bindParam(":user_id",$user_id,PDO::PARAM_INT);
    echo "<br/>".$command->getText(); 
```

我想打印绑定参数中包含的查询，例如 user_id = 1 然后

```
SELECT * from users WHERE user_id = 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:59:33.810

虽然在执行之前不可能看到带有绑定参数的准备好的查询，但当然可以在日志中检查它。您只需要启用 MySQL 的所谓“general_query_log”；有几种方法可以做到这一点，我想最简单的方法是......

```
SET GLOBAL general_log = 'ON'; 
```

...在 MySQL 外壳中。然后你可以试试你的查询；它将按原样记录`mysql.general_log`，因此您可以使用类似...的内容进行检查

```
SELECT * FROM mysql.general_log; 
```

不要忘记在不再需要时禁用日志记录：

```
SET GLOBAL general_log = 'OFF'; 
```

这里有[更多](http://dev.mysql.com/doc/refman/5.5/en/query-log.html)关于它的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:45:14.540

Yii 工作在 PDO 和各种类之上。并使用[PDOStatement](http://www.php.net/manual/en/class.pdostatement.php "http://www.php.net/manual/en/class.pdostatement.php")和[`bindParam`](http://www.php.net/manual/en/pdostatement.bindparam.php "http://www.php.net/manual/en/pdostatement.bindparam.php")：

> 与 PDOStatement::bindValue() 不同，该变量被绑定为引用，并且只会在调用 PDOStatement::execute() 时进行评估。

所以在执行之前你将无法看到它。

# lua - 为什么lua脚本会阻塞redis-server？

> ID：11261631
> 
> 赞同：1
> 
> 时间：2012-06-29T12:17:21.923
> 
> 标签：lua, redis

我有一个简单的 Lua 脚本：

```
while ( i < 500000 ) do
    redis.call("zadd", 'test1', i, i)
    redis.call( "expire", 'test1', 600 )
    i = i + 1
end

local res = redis.call("zrange", "test1", 0, 500000 )

for k,a in pairs(res) do
    redis.call("zadd", 'test2',k,a)
end 
```

为什么这个脚本会阻塞 Redis 服务器？如果我在另一个控制台命令中运行，例如：set test 1，结果：

```
 BUSY Redis is busy running a script. You can only call SCRIPT KILL or SHUTDOWN NOSAVE. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T12:19:18.613

Redis 是单线程的。每个命令都会阻止它。`EVAL`也是一个命令，因此它会阻塞 redis。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-11T07:04:46.280

这就是为什么我们在 Mail.Ru 和 myMail 使用 Tarantool NoSQL 数据库而不是我们也尝试使用的 Redis。在 Tarantool 中，每个命令都在单独的光纤中执行，不会阻塞另一个。Lua 脚本也是如此——它们不会互相阻塞。

# eclipse - Eclipse 的 IBM Clearcase 插件安装问题

> ID：11261634
> 
> 赞同：9
> 
> 时间：2012-06-29T12:17:35.153
> 
> 标签：eclipse, eclipse-plugin, clearcase, eclipse-cdt, eclipse-juno

我正在尝试按照Eclipse Juno CDT上的[IBM 站点上的说明安装 IBM Rational ClearCase SCM Adapter (For Eclipse)，版本 7.6.0.0。](http://www-01.ibm.com/support/docview.wss?uid=swg24025674)

我将`Install New Software`>`Add`与以下 URL 一起使用。

[http://www3.software.ibm.com/ibmdl/pub/software/rationalsdp/clearcase/60/update/windows/](http://www3.software.ibm.com/ibmdl/pub/software/rationalsdp/clearcase/60/update/windows/)

安装失败并显示以下消息

> 无法完成安装，因为找不到一项或多项所需项目。当前安装的软件：Rational ClearCase MVFS Support 7.6.0.v201105111445 (com.ibm.rational.clearcase.ccrefresh.feature.group 7.6.0.v201105111445) 缺少要求：Rational ClearCase Refresh Provider For MVFS Support 7.6.0.v201105111445 (com .ibm.rational.clearcase.ccrefresh 7.6.0.v201105111445) 需要 'bundle org.eclipse.update.core 0.0.0' 但找不到无法满足依赖关系：来自：Rational ClearCase MVFS Support 7.6.0.v201105111445 ( com.ibm.rational.clearcase.ccrefresh.feature.group 7.6.0.v201105111445）收件人：com.ibm.rational.clearcase.ccrefresh [7.6.0.v201105111445]

我的问题是：这是不支持 Eclipse Platform 4.X 的插件的问题吗？还是我的安装有问题？

作为记录，相同插件的安装与 Eclipse Indigo CDT 一起正常工作。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-08T10:29:21.610

我设法使用[Eclipse Help Site](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/porting/removals.html#updateManager)的提示解决了这个问题。

这不是插件的真正问题，而是从 Juno 中删除旧的 Eclipse 更新管理器 API 的问题。我所做的是下载一个较旧的 Update Manager jar，将其放入插件文件夹中，然后他们再次尝试安装。现在它起作用了。

（一个可能的下载位置 - [Grepcode](http://repository.grepcode.com/java/eclipse.org/3.4.2/plugins/org.eclipse.update.core_3.2.202.R34x_v20081128.jar)）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-29T15:11:52.690

如果您想在 Eclipse Juno 或更高版本 (Kepler) 中使用 Clearcase 插件，可以使用[Open Source ClearCase 插件](http://sourceforge.net/projects/eclipse-ccase/)（不是来自 IBM）。

如果您是 64 位用户，Erez A. Korn 的解决方法似乎不起作用，因此您必须使用另一个插件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T13:02:38.080

是的，这是一个“Eclipse4.0 支持”问题，因为[IBM 插件支持的官方 Eclipse 版本都是 3.x](http://www-01.ibm.com/support/docview.wss?uid=swg21256383)。

请注意，这不是唯一遭受此安装错误消息的插件：[TeamCity 插件也会收到相同类型的错误](http://devnet.jetbrains.net/thread/434882)。（参见[TW-20759](http://youtrack.jetbrains.com/issue/TW-20759)）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T13:30:31.103

ClearCase 版本 8 附带的 ClearTeam Explorer 对 Juno 应该没有问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-14T18:43:36.453

org.eclipse.update.core JAR 可以从 IMShared\plugins 目录复制到 eclipse 实例的插件目录以解决问题。

# jpeg - 使用 Google Docs List API 获取图片

> ID：11261639
> 
> 赞同：0
> 
> 时间：2012-06-29T12:18:10.050
> 
> 标签：jpeg, google-docs-api, google-drive-api

我正在使用 Google Docs List API 来获取 .doc、.txt 甚至电子表格等文档。现在我也想获取任何类型的上传文件，比如 .jpeg 图像。我尝试了与文档相同的方法，但没有成功。

有人有过这个问题的经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T10:09:04.120

GDocs List API 适用于从集合中获取它们列表的任何类型的文件。只需将 API 用于提要，无需指定要获取的文件类型。这是我的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T12:47:41.623

Google Docs List API 只能检索 Google 格式的文档。如果要检索 jpeg 图像，可能需要尝试 Google Drive API。

# php - 来自另一个函数内部的 mysql_fetch_array 结果不起作用

> ID：11261641
> 
> 赞同：-4
> 
> 时间：2012-06-29T12:18:13.237
> 
> 标签：php, mysql, sql, database

我这里有两个文件，在让 mysql_fetch_array 工作时遇到了一些问题。我认为这是因为它是从另一个函数调用的？

show_results.php：

```
include "sql_functions.php";

function content_humanResAll (){
    q_humanResAll();
    while($row = mysql_fetch_array($q_humanResAll_result)){
            ... 
```

sql_functions.php：

```
include "db_connect.php"; //connect to db

// Query for human resources
function q_humanResAll() {

    $q_humanResAll = "SELECT * FROM human_resources LIMIT 0, 30";
    $q_humanResAll_result = mysql_query($q_humanResAll) or die("could not query MySql");
    $q_humanResAll_numRows = mysql_num_rows($q_humanResAll_result);
    //return $q_humanResAll_result// tried this also, didn't work.
} 
```

为什么我会收到错误“mysql_fetch_array() 期望参数 1 是资源，给定 null”？

顺便说一句，show_results.php 包含在 index.php 中。所以它包括很多，但它不应该是一个问题，对吧？

我也尝试过将函数 q_humanResAll() 中的变量设为全局变量，但也没有用。

如果您需要更多输入，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:20:34.133

您没有在 content_humanResAll 中定义 $q_humanResAll_result。所以你需要把它从另一个函数传回来，像这样：

```
function q_humanResAll() {
    $q_humanResAll = "SELECT * FROM human_resources LIMIT 0, 30";
    $q_humanResAll_result = mysql_query($q_humanResAll) or die("could not query MySql");
    $q_humanResAll_numRows = mysql_num_rows($q_humanResAll_result);
    return $q_humanResAll_result;
}

function content_humanResAll (){
    $q_humanResAll_result = q_humanResAll();
    while($row = mysql_fetch_array($q_humanResAll_result)){
            ... 
```

# blackberry - 文件下载无法在 BlackBerry 上的非 WiFi 网络上运行

> ID：11261644
> 
> 赞同：2
> 
> 时间：2012-06-29T12:18:25.470
> 
> 标签：blackberry, download, blackberry-eclipse-plugin

我正在尝试使用以下代码下载 zip 文件；

```
HttpConnection httpConn = null;
InputStream inStream = null;
int responseCode = 0;

String connParams = "  ;interface=wifi;deviceside=true;";
httpConn = (HttpConnection) Connector.open(src + connParams);

responseCode = httpConn.getResponseCode();
if (responseCode != HttpConnection.HTTP_OK) {
    throw new IOException("Response: " + responseCode);
}

// Other relevant code 
```

这样，在使用时`interface=wifi;deviceside=true;`，它的工作正常。这意味着我必须依赖 WiFi 网络。但我想使用 2G/3G 链接下载文件。为此，我在删除`interface=wifi;`连接参数后尝试了相同的代码。但它抛出`IOException: tunnel failed`异常。

请指导我如何使其在非 WiFi 网络上工作。

我正在以下环境中开发；

*   黑莓 JDE Eclipse 插件 1.5.0
*   黑莓操作系统 4.5
*   带有 3G 卡的黑莓 Bold

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T05:18:17.900

在 BlackBerry 4.5 上，您仍然需要担心在连接字符串的末尾正确添加后缀。

```
interface=wifi;deviceside=true; 
```

如果您只想使用 Wi-Fi 连接，则它是一个有效的连接字符串后缀。有关支持 BlackBerry 支持的许多其他类型*传输*的更多信息，您可以查看我对[这个类似堆栈溢出问题](https://stackoverflow.com/questions/11068959/get-suffix-string-for-blackberry-connection-on-4-6-1)的 (2) 答案。在一个答案中，我将您指向黑莓网站上的链接。

在另一个答案中，我发布了一些示例代码，其中包含用于选择传输的算法，并为该传输创建连接字符串后缀。有关正确后缀的示例，请参见`getWifiConnection()`、`getBesConnection()`、等方法。`getSimConnection()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T13:51:46.350

好吧，我之前也遇到过这个问题，我决定做一些处理来知道最好的连接类型，这是我使用的代码：

[http://www.localytics.com/blog/2009/how-to-reliably-establish-a-network-connection-on-any-blackberry-device/](http://www.localytics.com/blog/2009/how-to-reliably-establish-a-network-connection-on-any-blackberry-device/)

# css - Chrome 和 IE 中的下拉子菜单宽度问题

> ID：11261646
> 
> 赞同：0
> 
> 时间：2012-06-29T12:18:33.313
> 
> 标签：css

我在我的drupal 7站点中使用下拉导航菜单，将鼠标悬停在每个父项列表上的正确子菜单下，但是某些子菜单的宽度比其他子菜单大，因此我`"width: -moz-max-content; position: relative;"`在css中用于firefox，这样所有子菜单的宽度都与内容最多的那个相同。这仅适用于 firfox，但不适用于 IE 和 chrome，请告诉我是否有一些替代的 css 属性/方法供 IE 和 chrome 处理此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:23:49.230

很明显，`-moz-max-content`它只适用于 Firefox，因为它以`-moz`.

对于 Chrome，您必须使用：`-webkit-max-content` 对于 Opera：`-o-max-content` 对于 IE（它应该可以工作）：`max-content`或者`-max-content`（`-ms-max-content`我无法测试它，因为我使用的是 Linux）

# ssl - 将 SSL 负载与 curl 客户端分离

> ID：11261651
> 
> 赞同：1
> 
> 时间：2012-06-29T12:18:56.320
> 
> 标签：ssl, proxy

我有一个同步器进程，它对 Twitter、Facebook 等进行 curl HTTPS 调用，为我们的用户收集数据并更新数据库（存储在本地文件系统中）。在同一系统上运行着一个 HTTP 服务器，它查询这个数据库并在请求时将结果返回给用户。

问题是 sycer 进程由于调用 Twitter、Facebook 等 API 时发生 SSL 协商而消耗了过多的 CPU/IO。这使用户体验有点慢。所以我希望这个 SSL 协商发生在另一个运行 HTTP 服务器的系统上。而且我不能将同步器进程带到外面，因为它需要本地文件系统访问来更新数据库。

所以我正在考虑构建一种代理服务器。同步器进程将对代理服务器进行 HTTP 调用。代理服务器将对 Twitter、Facebook 等进行 HTTPS 调用，并将结果返回给同步器进程。

是否有任何软件为此而存在？如果已经存在某些东西，我不想重新发明轮子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:47:41.093

如果满足以下条件，[Stunnel几乎完全按照您的要求执行。](http://www.stunnel.org/)

*   每个服务都必须运行一个 stunnel 实例（从 inetd 或在独立的类似守护进程的模式下）。
*   运行 cURL 的系统必须手动将目标服务的主机名解析为运行 stunnel 的主机的 IP 地址（例如`/etc/hosts`）才能使用它。

我以类似的方式使用 stunnel 连接到使用 SSL 和支持 SSL 的客户端的 IRC 服务器。它就像一种魅力，需要注意的重要一点是 3.x 和更新版本之间的不兼容。如果您正在计划一个新系统，您可能应该使用新系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T05:45:59.233

我最终使用 nodejs 编写了一个简单的代理服务器。需要调用 HTTPS api 的客户端会将 JSON 格式的所有详细信息传递给此代理服务器。该代理服务器将依次调用 HTTPS api 并将结果返回给客户端。

# php - PHP MYSQL 反面选择

> ID：11261652
> 
> 赞同：1
> 
> 时间：2012-06-29T12:19:06.940
> 
> 标签：php, mysql

```
$line = @mysql_query("SELECT * FROM clips, userclips 
WHERE userclips.userid='$id' AND 
userclips.clipid=clips.id ORDER BY clips.title"); 
```

它返回与特定用户关联的所有剪辑。但是，我很难编写一个完全相反的查询；选择与该用户无关的所有剪辑。

我试过这个：

```
$line = @mysql_query("SELECT DISTINCT * FROM clips, userclips 
WHERE userclips.userid!='$id' AND userclips.clipid=clips.id ORDER BY clips.title"); 
```

确实会返回与该用户无关的剪辑，但它会丢失与任何用户无关的剪辑。

如果可以的话请帮忙 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:24:08.300

```
 $line = @mysql_query("SELECT DISTINCT * FROM clips WHERE clips.id 
 NOT IN (SELECT clipid FROM userclips WHERE userid='$id') ORDER BY clips.title"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:25:41.847

返回与特定用户无关的所有剪辑和用户信息，其 id 已传递

```
SELECT * FROM clips, userclips 
WHERE userclips.userid!='$id'
ORDER BY clips.title 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:24:30.203

我将使用 not in 进行此类查询

```
Select * 
From clips 
Where id NOT IN  (SELECT clips.id 
                  FROM clips, userclips 
                  WHERE userclips.userid = '$id' 
                    AND userclips.clipid = clips.id 
                  ORDER BY clips.title) 
```

# wcf - 将环境变量传递给 WCF 服务实例

> ID：11261654
> 
> 赞同：3
> 
> 时间：2012-06-29T12:19:12.793
> 
> 标签：wcf, parameters, instance

我有一个在不同环境中运行的 WCF 服务。运行哪个环境是配置文件中的应用程序设置。

最近我开始用单元测试覆盖项目，并遇到了改变环境变量的问题。我不想每次都手动更改它，所以我必须以某种方式传递这个环境来服务。

我用下一个代码注册服务：

```
 Host = new WebServiceHost(typeof(Service), new Uri("http://localhost:1111/"));
 Host.AddServiceEndpoint(typeof(IService), new BasicHttpBinding(), ""); 
```

在不改变服务行为的情况下，类的实例是由默认构造函数按需创建的。而且我不想改变服务行为。

目前我使用静态变量来传递这个环境。有没有更好的方法将环境传递给类的实例？

谢谢。

# python - 元组可读性：[0,0] vs (0,0)

> ID：11261662
> 
> 赞同：21
> 
> 时间：2012-06-29T12:19:21.103
> 
> 标签：python, tuples, readability

我使用 Python 已经有好几次了，我发现了“pythonic”的编码方式。我在代码中使用了很多元组，其中大多数是极坐标或笛卡尔位置。

我发现自己在写这个：

```
window.set_pos([18,8]) 
```

而不是这个：

```
window.set_pos((18,8)) 
```

摆脱我发现难以阅读的双括号。

似乎 python 正在自动进行从列表到元组的类型转换，因为我的代码可以正常工作。

但这是一种编码的好方法吗？你有任何我可以用来编写可读代码的演示技巧吗？

预先感谢您提供的肯定有启发性的答案。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-29T12:46:49.580

我会谨慎地决定避开元组以支持无处不在的列表。你用过[dis](http://docs.python.org/library/dis.html)模块吗？当你创建一个列表和创建一个元组时，观察 Python 在字节码级别做什么：

```
>>> def f():
...     x = [1,2,3,4,5,6,7]
...     return x
... 
>>> def g():
...     x = (1,2,3,4,5,6,7)
...     return x
... 
>>> import dis
>>> dis.dis(f)
  2           0 LOAD_CONST               1 (1)
              3 LOAD_CONST               2 (2)
              6 LOAD_CONST               3 (3)
              9 LOAD_CONST               4 (4)
             12 LOAD_CONST               5 (5)
             15 LOAD_CONST               6 (6)
             18 LOAD_CONST               7 (7)
             21 BUILD_LIST               7
             24 STORE_FAST               0 (x)

  3          27 LOAD_FAST                0 (x)
             30 RETURN_VALUE     
>>>
>>>   
>>> dis.dis(g)
  2           0 LOAD_CONST               8 ((1, 2, 3, 4, 5, 6, 7))
              3 STORE_FAST               0 (x)

  3           6 LOAD_FAST                0 (x)
              9 RETURN_VALUE 
```

尽管它在 GUI 应用程序中可能永远不会成为问题（就像您的示例那样），但出于性能原因，您可能希望在代码中的任何地方都小心谨慎。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-29T12:27:05.210

你说

> 似乎python正在自动进行从列表到元组的类型转换

这是值得怀疑的。由于列表和元组都是[序列类型](http://docs.python.org/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange)，它们都实现了许多相同的行为，并且您使用的任何 GUI 库都必须不需要任何仅列表行为。

在许多情况下这样做*可能*没问题，但请注意，列表确实比元组占用更多空间：

```
>>> sys.getsizeof((1, 2))
72
>>> sys.getsizeof([1, 2])
88 
```

并且在某些方面可能比元组慢：

```
>>> lst, tup = [1, 2], (1, 2)
>>> def unpack(x):
...     a, b = x
...     
>>> %timeit unpack(tup)
10000000 loops, best of 3: 163 ns per loop
>>> %timeit unpack(lst)
10000000 loops, best of 3: 172 ns per loop 
```

这些都是*非常*小的差异，直到您达到更大的规模（例如*数十亿*次调用）才有意义，因此权衡可能是值得的。

不过，我不经常看到人们这样做。这似乎是一个很好的可读性技巧，但在某些情况下可能会产生意想不到的后果。例如，如果您传递一个您打算稍后再次使用的列表，那么您必须小心不要在函数内部修改它。最后，正如[JF Sebastian](https://stackoverflow.com/a/11262694/577088)正确指出的那样，元组和列表的含义往往*略有*不同。以非常规的方式使用它们可能会否定您寻求的可读性提升。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-29T13:28:20.480

我严重怀疑元组与列表在您的情况下会在性能上产生显着差异。除非您的分析器这么说，否则不要进行微优化。可读性是一个优先事项。

`list`并且`tuple`都是[序列类型](http://docs.python.org/dev/glossary.html#term-sequence)。

*语义*元组可能更可取（请参阅[元组有结构，列表有顺序](https://stackoverflow.com/a/626871/4279)）。位置是具有 x、y 属性的单个对象。

*在这种情况下，视觉*列表可能更容易阅读。

无论你选择什么，只要*保持一致*。

检查是否`window`支持以下内容：

```
window.pos = 18, 8 
```

实现它的一种可能方法是创建`pos`a[属性](http://docs.python.org/library/functions.html#property)并绑定 `set_pos()`为 setter。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-29T12:24:40.420

IMO 使用`(18,8)`over的唯一优点`[18,8]`是元组对象是不可变的，您可以确保它不会在传递的函数内部更改，而`[18,8]`可以轻松更改。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-29T12:26:03.230

Python 不会进行任何从列表到元组的自动转换，除非 set_pos 方法明确地这样做。tuple 和 list 具有非常相似的协议，因此它们在该协议中往往可以互换。您仍然可能会破坏事情，特别是因为元组是可以散列的不可变的，而列表不是。

要回答你的问题，只需写

```
window.set_pos( (18,18) ) 
```

适当的空间用编码风格创造奇迹。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-29T12:22:45.183

如果你想强调你的参数是一个元组这一事实，你可以明确地转换它：

```
window.set_pot(tuple([18, 18])) 
```

# python - PyQt：QMutexLocker 未在异常时释放

> ID：11261663
> 
> 赞同：5
> 
> 时间：2012-06-29T12:19:21.630
> 
> 标签：python, pyqt

我有以下代码：

```
def query(self,query):
  lock = QMutexLocker(self.mutex)
  reply = self.conn.query(query)
  if (re.search("error", reply) != None):
    raise GeneralError("Query error")

  #more code...  
  return reply 
```

现在，如果抛出异常，锁似乎没有被删除，导致互斥锁没有被释放。我当然可以到处做“del lock”，但这会带走 qmutexlocker 的全部意义。这与 Python 垃圾收集有关吗？如果是这样，那一定意味着 QMutexLocker 在 Python 中根本不可用？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-30T03:35:28.190

您没有正确使用 QMutexLocker。像上下文管理器一样使用它：

```
from PyQt4.QtCore import QMutex, QMutexLocker

def bad_lock(aLock):
    locker = QMutexLocker(aLock)
    print "Locked"
    raise RuntimeError("Test exception")

    return "Should not get here"

def good_lock(aLock):
    with QMutexLocker(aLock):
        print "Locked"
        raise RuntimeError("Test exception")

    return "Should not get here"

lock = QMutex()

bad_lock(lock)
print lock.tryLock()
# False

lock.unlock()

good_lock(lock)
print lock.tryLock()
# True 
```

在测试中，您在第一个示例中看到，锁返回仍处于锁定状态。第二，当引发异常时，上下文管理器在离开函数之前释放锁。

当在 C++ 中使用时，我确信 QMutexLocker 会做它应该做的事情，只要作用域结束就会解锁。但是在 Python 中，正如您所发现的，不应该依赖垃圾收集器来进行解锁。通过语句的上下文管理器`with`非常适合这一点。您可以通过此类的 C++ 示例显示它只是在函数顶部创建它的方式来判断。而 python 版本同时具有 an`__enter__`和`__exit__`方法。

最后，`with`上下文允许您将关键代码块包装在锁中以限制需要到位的锁的数量，因此您可以执行以下操作：

```
def good_lock(aLock):

    # do a bunch of stuff here
    ...

    # critical section
    with QMutexLocker(aLock):
        # do critical stuff here
        ...

    # do other stuff here
    ...

    return True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:48:15.647

如果您希望在引发异常之前释放互斥锁，请释放它：

```
def query(self, query):
    lock = QMutexLocker(self.mutex)
    reply = self.conn.query(query)
    if re.search("error", reply):
        lock.unlock()
        raise GeneralError("Query error") 
```

如果您希望在`lock`超出范围时立即释放它，那么您对解释器的期望过高。既然您确切地知道何时以及为什么应该释放锁，那就去做吧。

作为一般规则 - Python 或其他地方 - 您应该始终将互斥锁绑定到尽可能小的操作。我假设您知道任何查询实际上都需要保护，并且在调用`self.conn.query`.

**添加以回应评论**：

这是一个公平的观点，“一定意味着 QMutexLocker 根本不可用”，我确实错过了。我假设您指的是[PySide.QtCore.QMutexLocker](http://www.pyside.org/docs/pyside/PySide/QtCore/QMutexLocker.html#PySide.QtCore.QMutexLocker)这不太可能声称：

> 现在，当 PySide.QtCore.QMutexLocker 对象被销毁时，互斥锁总是会被解锁（当函数返回时，因为 locker 是一个自动变量）。

这不太可能，因为`auto`Python 中没有变量存储类之类的东西。我怀疑这将在进一步调查后证明是“让我们包装一个 C++ 库并假设范围语义工作”。如果这个猜测是正确的，你可能会使用[with 语句](http://www.python.org/dev/peps/pep-0343/)来更好地保证可靠的解锁。

# .net - 捕获 SOAP 异常 .NET

> ID：11261668
> 
> 赞同：0
> 
> 时间：2012-06-29T12:19:57.443
> 
> 标签：.net, exception, soap

我想如何正确捕获肥皂异常。我只能将其作为 system.net.webexception（错误 500 HTTP）捕获，但不能作为soapheaderexception 或soap 异常捕获。

我目前的代码是：

```
Try
       'Code

Catch soapExcpHeader As System.Web.Services.Protocols.SoapHeaderException
            'Can't catch here
            Dim error_desc As String = soapExcpHeader.Detail.OuterXml
            Throw New System.Web.Services.Protocols.SoapHeaderException()
Catch soapExcp As System.Web.Services.Protocols.SoapException
            'Can't catch here
            Dim error_desc As String = soapExcp.Detail.OuterXml
            Throw New System.Web.Services.Protocols.SoapException
Catch webExcp As System.Net.WebException
             'Here I catch
            Console.WriteLine(webExcp.ToString())
            Throw webExcp
Catch ex as Exception
             'Other types of exceptions
             Throw ex
End Try 
```

一如既往地感谢您的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:00:58.660

尝试查看您的异常的 GetType() 属性的值是多少，如果您的 catch 块没有在 System.Web.Services.Protocols.SoapHeaderException 上停止，这意味着您的异常不会继承它。

# java - 将缓冲区图像的特定部分复制到另一个缓冲区图像中

> ID：11261672
> 
> 赞同：6
> 
> 时间：2012-06-29T12:20:14.183
> 
> 标签：java, copy, bufferedimage, raster

我有一个大缓冲区图像。

我想用第一个缓冲区的数据创建另一个缓冲区图像

我试着做`raster`一个`buffer.getData(new Rectangle(x,y,width,height))`

接着`buffer2.setData(raster)`

但由于数据由 x,y 而不是 0,0 转换的原因。例如，如果我在原始 x,y 处有一个像素，我仍将在新像素中的 x,y 处拥有它而不是 0,0因为 x,y 是矩形的平移位置。

那么有没有办法正确翻译光栅或者是否有更好的解决方案来复制图像？

编辑：我也设法做到了`getGraphics().drawImage()`。有一种方法可以通过定义它们的角来定义 2 个矩形。但是下面的方法更好，因为它不会透支。

Edit2：似乎子图像已连接到原始图像，是否有另一种方法可以使用实际原始的剪切数据和尺寸创建缓冲图像？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-29T12:31:46.683

Java子图像应该适合你..试试；

```
imageTwo = imageOne.getSubimage(x, y, width, height); 
```

希望能帮助到你 ：-）

# java - 通过 ant 将参数传递给 java

> ID：11261675
> 
> 赞同：5
> 
> 时间：2012-06-29T12:20:20.473
> 
> 标签：java, ant

我想将命令行参数传递给通过假蚂蚁调用的 java 程序（我们在 perl 中有自己的 ant 脚本，有时会调用实际的 ant）。所以我想做的是像这样调用我的程序：

> `./ant program_name arg1 arg2`

现在我的程序有一个 ant 目标，但我没有从命令行传递参数，而是将它们硬编码到构建文件中，如下所示：

> `<arg line="arg1 arg2"/>`

关于如何在构建文件中使用变量并从命令行参数加载它们然后在我的 java 程序中使用它们的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:22:58.583

最简单的方法可能是让您的脚本通过`-D`.

然后，您的 ant 构建文件可以使用这些来设置可以在`<arg>`标签中设置的 ant 属性（或直接引用，尽管我更喜欢设置 ant 属性，但这可能比任何技术原因更不习惯）。

# android - android中有没有类似web.config的东西？

> ID：11261676
> 
> 赞同：0
> 
> 时间：2012-06-29T12:20:21.380
> 
> 标签：android, eclipse

就像我们在 asp.net 和其他文件中有一个 web.config 文件一样，我们在那里放置了几个设置来读取值并一次又一次地使用它们。我想知道我是否可以在 android 应用程序中做同样的事情。例如，我有一个库项目，其中几乎没有要设置的服务器详细信息等参数。并且所有这些参数对于每个应用程序都是不同的。所以我把它们写在某个地方并阅读运行时间的详细信息。

希望我已经正确解释了我的问题。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:22:16.117

您可以利用资产文件夹或原始文件夹。将您的配置文件放在那里。然后在应用程序中，您可以将[`AssetManager`](http://developer.android.com/reference/android/content/res/AssetManager.html)其用于资产文件夹或`context.getResources()`原始文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:23:32.350

我从未使用过 ASP.NET，也不知道 web.config 是什么。也许[**SharedPreferences**](http://developer.android.com/reference/android/content/SharedPreferences.html)是您正在寻找的。

开发者指南：http: [//developer.android.com/guide/topics/data/data-storage.html#pref](http://developer.android.com/guide/topics/data/data-storage.html#pref)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:32:57.697

您可以拥有一个包含一些在实际项目中覆盖的静态字段的类。

图书馆项目：

```
public class ApplicationSettings {
    public static String SERVER_IP = null;
}

public class ClassThatUsesTheSettings {
    public void connect() {
        if ( ApplicationSettings.SERVER_IP == null ) {
            // No IP set by implementing project
        } else {
            // Use the settings for something smart
        }
    }
} 
```

实施项目（可能在`Application.onCreate()`）

```
ApplicationSettings.SERVER_IP = "192.168.0.1"; 
```

# rpc - 部落 RPC 接口

> ID：11261677
> 
> 赞同：1
> 
> 时间：2012-06-29T12:20:22.617
> 
> 标签：rpc, horde

一段时间以来，我一直在尝试通过 RPC 从 Horde (Kronolith) 读取和写入日历。

我正在使用以下示例：[http ://wiki.horde.org/WSDLHowTo](http://wiki.horde.org/WSDLHowTo)

问题是，我没有得到服务器的任何响应（我尝试了 2 台完全不同的服务器，我有一个帐户）。无论我选择哪种方法（例如`horde_listAPIs`或`calendar_list`，都在`rpc.php?wsdl`文件中列出），我总是得到一个空白答案。看起来我可以成功连接到两者（如果我输入错误的用户名和/或密码，我会收到登录错误）。我无法连接到[部落主页上的演示服务器](http://demo.horde.org/)

有没有人有 RPC Horde 连接的工作示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-03T18:11:25.373

为什么不在部落的 kronolith 中使用 gmail 作为“后端”？

我看到您已经修复了它，但仅适用于通过以下方式浏览的用户：

如果您需要 Horde RPC 使用的工作示例，请参阅 [http://www.ralf-lang.de/2012/02/18/distributed-applications-with-horde-4/](http://www.ralf-lang.de/2012/02/18/distributed-applications-with-horde-4/)

# plone - 在 plone.app.registry 中存储字符串对

> ID：11261682
> 
> 赞同：1
> 
> 时间：2012-06-29T12:20:43.913
> 
> 标签：plone, zope.interface

我需要在存储情侣的 Plone 控制面板中构建一个配置面板，并且我想在 Plone 3 上使用 plone.app.registry。

* * *

如果我将自己限制在用户界面上，那么定义一个自动构建的模式接口非常简单：

```
class IMyPair(Interface):
value = schema.TextLine(title=u"value", required=True)
title = schema.TextLine(title=u"title", required=False)

class MyPair(object):
    implements(IMyPair)
    def __init__(self, value='', title=''):
    self.value = value
    self.title = title

class IMyConfigPanel(Interface):

    entry = schema.List(
        title=_(u'Foo'),
        value_type=schema.Object(IMyPair, title=u"entry"),
        required=True
    ) 
```

我们使用这是一个项目，将portal_properties 中的情侣作为单个字符串（带有分隔符）存储。

* * *

使用这种方法（使用“value_type=schema.Object”）和 plone.app.registry 我得到一个异常，因为 IObjectField 没有定义 IPersistent 适配器。

在深入并疯狂提供我自己的适配器之前：有一种更简单的方法可以满足我的问题的初始需求吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:00:32.547

您可能应该重新阅读 plone.(app.)registry 文档，尤其是“持久字段”的 plone.registry 文档。

并非所有 zope.schema 类型都受支持，对于其中一些类型，您需要使用 plone.registry.field 中的持久变体。一般来说，任何不是 Python 中原始类型（int、unicode、float 等）的东西都需要特殊处理。这是一个经过深思熟虑的设计选择，即使提供了某些设置的加载项后来从文件系统中删除，也可以保持注册表正常工作。

`plone.registry.field.Tuple`在基本文档和 plone.app.registry 文档中的 GenericSetup 示例中都有使用示例。

# vb.net - 引用 Ashx Web 服务 - 使用 Web 与服务参考？

> ID：11261683
> 
> 赞同：1
> 
> 时间：2012-06-29T12:20:53.110
> 
> 标签：vb.net, web-services

我正在尝试向 VB.NET 表单项目添加服务引用。当我尝试创建对 Web 服务的引用时，出现以下错误：

“在 ServiceModel 客户端配置部分中找不到引用合同‘ApplicationName.Application Web Service’的默认端点元素。这可能是因为找不到您的应用程序的配置文件，或者因为在客户元素。”

我对此进行了研究，发现我可能在 app.config 文件中缺少 System.Model 元素。这个对吗？这个元素应该自动生成吗？

我发现这里描述的错误：http: [//www.socalmp.com/blog/template_permalink.asp?id=122](http://www.socalmp.com/blog/template_permalink.asp?id=122)

* ***2012 年 6 月 29 日格林威治标准时间 21:30 更新**** 我设法通过添加 Web 引用而不是服务引用来使其工作。我了解 Web 引用和服务引用之间的基本区别，即 Web 引用是 wsdl.exe 的包装，而服务引用是 svcutil.exe 的包装。因此，如果您添加 ASHX Web 服务，那么您是否必须添加 Web 引用，反之亦然？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:26:38.510

你的问题错过了一些重要的信息。

例如，您是否在本地主机上移植了相同的内容并且是 WCF 服务？

您可以在浏览器中测试 URL 吗？

您能否提供更多详细信息？

您可以查看[基本步骤](http://www.evagoras.com/2011/02/09/creating-and-consuming-a-web-service-using-visual-studio-net/)以了解如何使用 visual studion .net 创建和使用 Web 服务。

# jquery - plupload 仅在 wordpress 插件中使用 html5

> ID：11261690
> 
> 赞同：3
> 
> 时间：2012-06-29T12:21:15.763
> 
> 标签：jquery, wordpress, plugins, plupload

寻求在 wordpress 插件中使用 plupload 的帮助（前端，而不是管理员）。

我已经全部使用 html5，但是如果浏览器不支持 html5（即 IE），那么理论上它应该切换到 flash、silverlight 等，但事实并非如此。我曾尝试将 Flash 放入运行时，但它只是无法初始化（大概是因为浏览器正在尝试使用 html5 并且失败），过了一会儿出现错误 -500。

也许很重要，但是 JS 在上传表单显示在 AJAX 的返回后运行。但正如我所说，一切都与 html5 一起工作，但切换到 flash 等并没有发生。

所以我认为问题在于为什么它不回退到闪存等。

一些代码片段后跟文件引用。

我正在加载 plupload 脚本，如下所示：

```
wp_enqueue_script('plupload-all'); 
```

HTML 表单是：

```
echo '<div class="uploader" id="symposium_activity_uploader" style="display:none">';
  echo '<a id="pickfiles" href="#">Attach an image</a>';
  echo '<div id="progressbar"></div>';
echo '</div>';
echo '<div id="symposium_filelist" class="cb"></div>'; 
```

DOM 包含 HTML 表单时运行的 JS 是：

```
// Settings ////////////////////////////////////////////////
var uploader = new plupload.Uploader({
    runtimes : 'html5,flash,silverlight,gears,html4', 
    flash_swf_url : '/wp-includes/js/plupload/plupload.flash.swf',
    silverlight_xap_url : '/wp-includes/js/plupload/plupload.silverlight.xap',
    browse_button : 'pickfiles', 
    max_file_size : '1mb', 
    urlstream_upload : true, 
    multipart : true,
    multi_selection: false, 
    resize : {width : 300, height : 300, quality : 90}, 
    container : 'symposium_activity_uploader', 
    url : '/wp-content/plugins/wp-symposium/ajax/dothisnext.php', 
    filters : [ {title : "Image files", extensions : "jpg,gif,png"} ] 
});

uploader.bind('Init', function(up, params) {
    jQuery('#symposium_filelist').html("<div>Current runtime: " + params.runtime + "</div>");
    jQuery('#symposium_activity_uploader').show();
});

// Init ////////////////////////////////////////////////////
uploader.init(); 

// Selected Files //////////////////////////////////////////
uploader.bind('FilesAdded', function(up, files) {
    jQuery.each(files, function(i, file) {
        jQuery('#symposium_filelist').append('<div class="addedFile" id="' + file.id + '">' + file.name + '</div>');
    });
    up.refresh(); 
    uploader.start();
});

// Error Alert /////////////////////////////////////////////
uploader.bind('Error', function(up, err) {
    alert("Error: " + err.code + ", Message: " + err.message + (err.file ? ", File: " + err.file.name : "") + "");
    up.refresh(); 
});

// Progress bar ////////////////////////////////////////////
uploader.bind('UploadProgress', function(up, file) {
    var progressBarValue = up.total.percent;
    jQuery('#progressbar').fadeIn().progressbar({
        value: progressBarValue
    });
    jQuery('#progressbar .ui-progressbar-value').html('<span class="progressTooltip">' + up.total.percent + '%</span>');
});

// Close window after upload ///////////////////////////////
uploader.bind('UploadComplete', function() {
    jQuery('.uploader').fadeOut('slow');
}); 
```

flash_swf_url 和 silverlight_xap_url 的路径已经过手动验证。

我没有发布接收上传图片的代码，因为它正在工作，并且在上面被称为 dothisnext.php。

总而言之，我的问题是，当 html5 工作时，运行时不会切换到不支持 html5 的浏览器的 flash、silverlight 等。我错过了重要的一步吗？

# android - 将文本保留在 TextView 中，drawableLeft 居中

> ID：11261692
> 
> 赞同：59
> 
> 时间：2012-06-29T12:21:17.947
> 
> 标签：android, textview

在我的应用程序中，我有一个标题栏，它由一个以 fill_parent 作为宽度的文本视图组成，它具有特定的背景颜色和一些居中的文本。现在我想在标题栏的左侧添加一个drawable，所以我设置了drawableLeft，果然显示了文本和图像。然而，这里的问题是文本不再正确居中，例如，当添加可绘制对象时，文本会向右移动一点，如下面的屏幕截图所示：

![没有可绘制的](../Images/c878906265a9b004affa323032ddcae2.png)
![可绘制](../Images/52ffe31e2f0a6a4fa83d50a991863964.png)

无论如何我可以正确地居中文本并在不使用其他布局项（例如LinearLayout）的情况下将drawable定位在上面吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-08T03:50:19.273

虽然很脆弱，但您可以通过在可绘制对象上设置***负***填充来避免使用包装器布局：

```
<TextView
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_centerHorizontal="true"
    android:drawableLeft="@drawable/icon"
    android:drawablePadding="-20sp"
    android:text="blah blah blah" /> 
```

您必须将填充调整为可绘制的宽度，但您只剩下一个 TextView 而不是额外的 LinearLayout 等。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-07-12T09:24:18.487

您可以将 TextView 的父级设置为宽度为 match_parent 的 RelativeLayout。

```
<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent">

<TextView
        android:id="@+id/edit_location_text_view"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@id/add_location_text_view"
        android:gravity="start|center_vertical"
        android:layout_centerHorizontal="true"
        android:drawableStart="@android:drawable/ic_menu_edit"
        android:text="Edit Location" />

</RelativeLayout> 
```

[![这就是结果的样子。](../Images/4780dd1187126842adbdab359b84d038.png)](https://i.stack.imgur.com/a9W1P.jpg)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-07-15T11:42:43.400

我遇到过类似的问题。通过使用单个`TextView`with `layout_width="wrap_content"`和`layout_gravity="center"`参数解决它：

```
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:drawableLeft="@drawable/some_drawable"
    android:text="some text"
    android:layout_gravity="center"
    android:gravity="center"
    /> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-09-26T12:22:31.690

尝试以下操作：

```
<TextView
    android:id="@+id/textView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"
    android:padding="10dp"
    android:textAlignment="center" /> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-06-29T17:07:20.903

您可以使用`android:gravity="center_vertical"`使文本与图像垂直居中。或者它可以在 textView 中使用`android:gravity="center"`.

```
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:drawableLeft="@drawable/icon"
    android:text="Your text here" />
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-29T12:51:35.550

用这种方式

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/White"
     >

  <RelativeLayout
       android:id="@+id/rlheader"
       android:layout_width="fill_parent"
       android:layout_height="50dp"
       android:layout_alignParentTop="true"
       android:background="@color/HeaderColor"

        >

        <TextView

           android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           android:layout_centerHorizontal="true"
           android:layout_centerVertical="true"
           android:text="Header_Title"
            />

        <ImageView
           android:id="@+id/ivSetting"
           android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           android:layout_alignParentLeft="true"
           android:layout_centerVertical="true"
           android:layout_marginLeft="10dp"
           android:src="@drawable/setting" />

    </RelativeLayout>

</RelativeLayout> 
```

它看起来像我的演示项目的这张快照

![标题图片](../Images/b3a1f3d098764575424dd3851316799a.png)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-10-17T10:52:37.467

那对我有用。

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:orientation="horizontal">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:drawableLeft="@drawable/trusted"
        android:gravity="center"
        android:text="@string/trusted"/>

</LinearLayout> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-05-12T11:51:32.090

我遇到了同样的问题，我在 Textview 中进行了一些小改动解决了它，

```
<TextView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:drawableLeft="@drawable/search_red"
    android:text="your text goes here"
    /> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-10-30T10:39:16.033

```
> This line is important ->> android:gravity="start|center_vertical

 <LinearLayout
            android:layout_width="match_parent"
            android:layout_margin="@dimen/marginplus2"
            android:layout_height="wrap_content">

            <TextView
                android:layout_width="0dp"
                android:layout_weight="1"
                android:text="@string/like"
                android:gravity="start|center_vertical"
                android:drawablePadding="@dimen/marginplus1"
                android:drawableLeft="@drawable/ic_like"
                android:layout_height="wrap_content" />

            <TextView
                android:layout_width="0dp"
                android:layout_weight="1.5"
                android:text="@string/comments"
                android:drawablePadding="@dimen/marginplus1"
                android:gravity="start|center_vertical"
                android:drawableLeft="@drawable/ic_comment"
                android:layout_height="wrap_content" />
            <TextView
                android:layout_width="0dp"
                android:layout_weight="1"
                android:text="@string/share"
                android:drawablePadding="@dimen/marginplus1"
                android:gravity="start|center_vertical"
                android:drawableLeft="@drawable/ic_share"
                android:layout_height="wrap_content" />

        </LinearLayout> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-10-19T07:00:49.863

drawable 是 TextView 的一部分，因此如果您的文本高度小于 drawable 的高度，则 textview 的高度将是 drawable 的高度。

您可以将 TextView 的重力属性设置为 center_vertical，因此文本将位于中心。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-08-16T20:57:02.217

一个简单的解决方案是在 textview 的另一侧使用相同大小的透明图像。在我的示例中，我复制了我的实际 vector_image 并将颜色更改为透明。

```
<TextView
        android:id="@+id/name"
        style="@style/TextStyle"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:drawableEnd="@drawable/ic_vector_caret_down_green"
        android:drawableStart="@drawable/ic_vector_space_18"
        android:gravity="center"
        android:padding="12dp"
        android:textColor="@color/green"/> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-12-07T07:25:43.727

接受的答案对我不起作用，如果 TextView 宽度与父级匹配我使用 FrameLayout 完成它会失败。

```
 <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="50dp"
        android:layout_marginTop="10dp"
        android:background="#000">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:drawableStart="@drawable/ic_circle_check_white"
            android:drawablePadding="10dp"
            android:text="Header"
            android:textColor="#fff"
            android:textSize="14sp"/>

    </FrameLayout> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-06-29T12:43:35.977

你可以这样设置你的标题

```
<RelativeLayout
             android:id="@+id/linearLayout1"
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:background="@drawable/head" >

             <ImageView
                 android:id="@+id/cat"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content"

                 android:layout_marginLeft="5dp"
                 android:onClick="onClick"
                 android:layout_marginTop="10dp"
                 android:src="@drawable/btn_back_" />

         <RelativeLayout
             android:id="@+id/linearLayout1"
             android:layout_width="fill_parent"
             android:layout_height="wrap_content"
             android:gravity="center" >

           <TextView
 android:id="@+id/TvTitle"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 android:text=""
 android:layout_marginLeft="10dp"
 android:layout_marginRight="10dp"
 android:textColor="#000000" 

 android:textSize="20sp"/>
             </RelativeLayout>

         </RelativeLayout> 
```

只需根据您的需要提供 Textview 的高度，图像源

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-02-09T11:18:42.437

```
<TextView
    android:id="@+id/distance"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"
    android:drawableLeft="@drawable/distance"
    android:drawablePadding="10dp"
    android:padding="10dp"
    android:textAlignment="center"
    android:textColor="#ffffff"
    android:textSize="20sp" /> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-06-25T07:08:14.670

如果以上解决方案都不适合您？然后尝试以下答案

设计的示例屏幕截图。 [![在此处输入图像描述](../Images/db293c8ff747c5134f8663b2f1509706.png)](https://i.stack.imgur.com/zKbN0.png)

对于上图，请在下面找到代码。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <android.support.v7.widget.CardView
        android:id="@+id/my_card"
        android:layout_width="match_parent"
        android:layout_height="wrap_content">

        <LinearLayout
            android:id="@+id/bb"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:divider="@color/gray"
            android:orientation="horizontal"
            android:weightSum="2">

            <TextView
                android:id="@+id/filter_tv"
                style="?android:attr/buttonBarButtonStyle"
                android:layout_width="wrap_content"
                android:layout_height="?attr/actionBarSize"
                android:layout_gravity="center_horizontal"
                android:layout_weight="1"
                android:drawableLeft="@drawable/ic_baseline_filter_list"
                android:gravity="center|fill_horizontal"
                android:paddingLeft="60dp"
                android:text="Filter"
                android:textAllCaps="false"
                android:textStyle="normal" />

            <View
                android:layout_width="1dp"
                android:layout_height="match_parent"
                android:layout_below="@+id/bb"
                android:background="@color/gray" />

            <TextView
                android:id="@+id/sort_tv"
                style="?android:attr/buttonBarButtonStyle"
                android:layout_width="wrap_content"
                android:layout_height="?attr/actionBarSize"
                android:layout_gravity="center|center_horizontal"
                android:layout_weight="1"
                android:drawableLeft="@drawable/ic_baseline_sort"
                android:drawablePadding="20dp"
                android:gravity="center|fill_horizontal"
                android:paddingLeft="40dp"
                android:text="Sort"
                android:textAllCaps="false" />

        </LinearLayout>
    </android.support.v7.widget.CardView>

    <View
        android:layout_width="match_parent"
        android:layout_height="0.9dp"
        android:layout_below="@+id/my_card"
        android:background="@color/gray" />
</RelativeLayout> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-08-17T05:43:15.937

最好的方法是使用 ConstraintLayout，使 textview 位于布局的中心，宽度为 warp_content（现在不要使用 0dp），以便可绘制对象跟随文本。

```
<TextView
    android:id="@+id/tv_test"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="test"
    android:drawableLeft="@drawable/you_drawable"
    android:drawablePadding="5dp"
    app:layout_constraintLeft_toLeftOf="parent"
    app:layout_constraintRight_toRightOf="parent"
    /> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-11-05T08:13:42.803

尝试流动：

```
public class DrawableCenterTextView extends AppCompatTextView {

    public DrawableCenterTextView(Context context, AttributeSet attrs,
                                  int defStyle) {
        super(context, attrs, defStyle);
    }

    public DrawableCenterTextView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public DrawableCenterTextView(Context context) {
        super(context);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        // We want the icon and/or text grouped together and centered as a group.
        // We need to accommodate any existing padding
        final float buttonContentWidth = getWidth() - getPaddingLeft() - getPaddingRight();

        float textWidth = 0f;
        final Layout layout = getLayout();
        if (layout != null) {
            for (int i = 0; i < layout.getLineCount(); i++) {
                textWidth = Math.max(textWidth, layout.getLineRight(i));
            }
        }

        // Compute left drawable width, if any
        Drawable[] drawables = getCompoundDrawables();
        Drawable drawableLeft = drawables[0];

        int drawableWidth = (drawableLeft != null) ? drawableLeft.getIntrinsicWidth() : 0;

        // We only count the drawable padding if there is both an icon and text
        int drawablePadding = ((textWidth > 0) && (drawableLeft != null)) ? getCompoundDrawablePadding() : 0;

        // Adjust contents to center
        float bodyWidth = textWidth + drawableWidth + drawablePadding;
        int translate = (int) ((buttonContentWidth - bodyWidth));
        if (translate != 0)
            setPadding(translate, 0, translate, 0);
        super.onDraw(canvas);
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-05-12T14:05:41.983

没有太多的测试，另一种方式

```
 class CenterDrawableToggleButton @JvmOverloads constructor(
        context: Context, attrs: AttributeSet? = null, defStyleAttr: Int = 0
    ) : AppCompatToggleButton(context, attrs, defStyleAttr) {

        private val centerMatrix = Matrix()

        override fun onDraw(canvas: Canvas?) {
            canvas?.save()?:return
            centerMatrix.reset()
            centerMatrix.postTranslate(width / 2F - (getDrawWidth() / 2), 0F)
            canvas.concat(centerMatrix)
            super.onDraw(canvas)
            canvas.restore()
        }

        private fun getDrawWidth(): Float {
            return paint.measureText(text.toString()) + compoundPaddingRight + compoundPaddingLeft
        }
    } 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-06-04T14:49:15.003

将您的 TextView 包装在 LinearLayout 中。然后设置`android:gravity="center_horizontal"`为您的 LinearLayout..

```
<LinearLayout
        android:layout_width="0dp"
        android:gravity="center_horizontal"
        android:layout_height="wrap_content"
        android:orientation="horizontal">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:drawableStart="@drawable/your_drawable"
            android:drawablePadding="5dp"
            android:ellipsize="end"
            android:maxLines="1"
            android:textAlignment="center"
            android:textColor="@color/ic_text_color"
            android:textSize="15sp"
            tools:text="Your Text.." />

    </LinearLayout> 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2015-08-07T03:13:48.983

就这么简单。。试试吧。。

```
 <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="center|left"
                android:drawableLeft="@drawable/icon"
                android:text="something something" /> 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2018-06-05T14:55:45.940

移除 DrawableLeft 并使用容器 FrameLayout。

```
<FrameLayout
     android:id="@+id/container"
     android:layout_width="match_parent"
     android:layout_height="wrap_content" >

     <ImageView
         android:id="@+id/image"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:layout_marginLeft="5dp"
         android:layout_gravity="center_vertical"
         android:src="@drawable/image" />

     <TextView
        android:id="@+id/text"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Text"
        android:layout_gravity="center" />
</FrameLayout> 
```

* * *

## 回答 #22

> 赞同：-18
> 
> 时间：2012-06-29T12:55:42.297

获得它的最简单方法是：

```
<RelativeLayout
         android:id="@+id/linearLayout1"
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:background="@drawable/head" >

         <ImageView
             android:id="@+id/cat"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:layout_marginLeft="5dp"
             android:onClick="onClick"
             android:layout_marginTop="10dp"
             android:layout_alignParentLeft="true"
             android:src="@drawable/btn_back_d" />

       <TextView
            android:id="@+id/TvTitle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:text=""
            android:layout_centerHorizontal="true" 
            android:textColor="#000000" 
            android:textSize="20sp"/> 
```

在哪里

*   ImageView 将 alignParentLeft 设置为 true 并且
*   TextView 的 centerHorizo​​ntal 设置为 true

# c# - 字符串到货币格式，没有句点（或逗号）

> ID：11261694
> 
> 赞同：5
> 
> 时间：2012-06-29T12:21:26.217
> 
> 标签：c#, string

给定值 = 2 或 4.00
以下语句输出

```
value = Convert.ToDecimal(value).ToString("C2"); 
```

价值 = 2.00 美元或 4.00 美元

如果我有 value = 1000 那么输出将是`$1,000.00`但我需要`$1000.00`.

我不喜欢“$”和值的字符串连接。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T12:23:25.280

```
var stringValue = Convert.ToDecimal(value).ToString("$0.00"); 
```

正如下面@James 所指出的，这会将货币硬编码为格式。使用格式`C2`将使用系统货币格式。这可以针对系统进行更改（例如，在 Windows 7 中 - 开始 - 控制面板 - 更改显示语言 - 附加设置 - 货币 - 数字分组）并允许`C2`在该特定系统上运行时显示不带逗号的货币值。

**编辑**

感谢@James 使用当前的文化。我对他的回答的唯一修改是克隆当前`NumberFormat`，以便在删除`CurrencyGroupSeparator`.

```
var formatInfo = (NumberFormatInfo)CultureInfo.CurrentCulture.NumberFormat.Clone();
formatInfo.CurrencyGroupSeparator = string.Empty;

var stringValue = Convert.ToDecimal(value).ToString("C", formatInfo); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T12:34:55.320

您应该使用`NumberFormat`该类来指定您需要的格式类型`ToString`，`IFormatProvider`例如

```
var formatInfo = (System.Globalization.NumberFormatInfo)CultureInfo.CurrentCulture.NumberFormat.Clone();
formatInfo.CurrencyGroupSeparator = ""; // remove the group separator
Console.WriteLine(2.ToString("C", formatInfo));
Console.WriteLine(4.ToString("C", formatInfo));
Console.WriteLine(1000.ToString("C", formatInfo)); 
```

这将使您的数字格式与您使用的任何文化保持一致。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T12:52:32.230

```
public static class MyExtensions
{
    public static string GetMoney(this decimal value, bool displayCurrency = false, bool displayPeriods = true)
    {
        string ret = string.Format("{0:C}", value).Substring(displayCurrency ? 0 : 1);
        if (!displayPeriods)
        {
            ret = ret.Replace(",", string.Empty);
        }
        return ret;
    }
} 
```

要使用此扩展方法：

```
decimal test = 40023.2345M;
string myValue = test.GetMoney(displayCurrency:true, displayPeriods:false);` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-13T05:37:54.643

将整数值转换为 $0.00 格式

整数值 = 1000；字符串 abc = Convert.ToDecimal(Value).ToString("$0.00"); 输出将是 $1000.00

# android - android在没有麦克风的情况下录制音频

> ID：11261697
> 
> 赞同：1
> 
> 时间：2012-06-29T12:21:37.920
> 
> 标签：android, android-audiomanager

**我只**需要录制我使用 AudioRecord 和 MediaRecorder 的应用程序音频**，**但**它们**录制 + 麦克风声音

```
 AudioManager audioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
    audioManager.setMicrophoneMute(true); 
```

此代码不会使麦克风静音

该怎么办？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:28:41.220

尝试设置`MediaRecorder.AudioSource`.

[阅读更多关于它的 Android 文档](http://developer.android.com/reference/android/media/MediaRecorder.AudioSource.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-29T12:42:53.370

```
public class AudioRecordTest extends Activity {
    private static final String LOG_TAG = "AudioRecordTest";
    private static String mFileName = null;

    private RecordButton mRecordButton = null;
    private MediaRecorder mRecorder = null;

    private PlayButton mPlayButton = null;
    private MediaPlayer mPlayer = null;

    private void onRecord(boolean start) {
        if (start) {
            startRecording();
        } else {
            stopRecording();
        }
    }

    private void onPlay(boolean start) {
        if (start) {
            startPlaying();
        } else {
            stopPlaying();
        }
    }

    private void startPlaying() {
        mPlayer = new MediaPlayer();
        try {
            mPlayer.setDataSource(mFileName);
            mPlayer.prepare();
            mPlayer.start();
        } catch (IOException e) {
            Log.e(LOG_TAG, "prepare() failed");
        }
    }

    private void stopPlaying() {
        mPlayer.release();
        mPlayer = null;
    }

    private void startRecording() {
        player.start();

        AudioManager audioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
        audioManager.setMicrophoneMute(true);

        mRecorder = new MediaRecorder();
        mRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
        mRecorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
        mRecorder.setOutputFile(mFileName);
        mRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);

        try {
            mRecorder.prepare();
        } catch (IOException e) {
            Log.e(LOG_TAG, "prepare() failed");
        }

        mRecorder.start();
    }

    private void stopRecording() {
        player.stop();
        mRecorder.stop();
        mRecorder.release();
        mRecorder = null;
    }

    class RecordButton extends Button {
        boolean mStartRecording = true;

        OnClickListener clicker = new OnClickListener() {
            public void onClick(View v) {
                onRecord(mStartRecording);
                if (mStartRecording) {
                    setText("Stop recording");
                } else {
                    setText("Start recording");
                }
                mStartRecording = !mStartRecording;
            }
        };

        public RecordButton(Context ctx) {
            super(ctx);
            setText("Start recording");
            setOnClickListener(clicker);
        }
    }

    class PlayButton extends Button {
        boolean mStartPlaying = true;

        OnClickListener clicker = new OnClickListener() {
            public void onClick(View v) {
                onPlay(mStartPlaying);
                if (mStartPlaying) {
                    setText("Stop playing");
                } else {
                    setText("Start playing");
                }
                mStartPlaying = !mStartPlaying;
            }
        };

        public PlayButton(Context ctx) {
            super(ctx);
            setText("Start playing");
            setOnClickListener(clicker);
        }
    }

    public AudioRecordTest() {
        mFileName = Environment.getExternalStorageDirectory().getAbsolutePath();
        mFileName += "/audiorecordtest.3gp";
    }

    MediaPlayer player;

    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);

        player = MediaPlayer.create(this, R.raw.vava);
        player.setLooping(false);
        try {
            player.prepare();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        LinearLayout ll = new LinearLayout(this);
        mRecordButton = new RecordButton(this);
        ll.addView(mRecordButton, new LinearLayout.LayoutParams(
                ViewGroup.LayoutParams.WRAP_CONTENT,
                ViewGroup.LayoutParams.WRAP_CONTENT, 0));
        mPlayButton = new PlayButton(this);
        ll.addView(mPlayButton, new LinearLayout.LayoutParams(
                ViewGroup.LayoutParams.WRAP_CONTENT,
                ViewGroup.LayoutParams.WRAP_CONTENT, 0));
        setContentView(ll);
    }

    @Override
    public void onPause() {
        super.onPause();
        if (mRecorder != null) {
            mRecorder.release();
            mRecorder = null;
        }

        if (mPlayer != null) {
            mPlayer.release();
            mPlayer = null;
        }
    }
} 
```

这是我用来录制音频的代码

# c# - 修改从 XSD 架构生成的代码

> ID：11261699
> 
> 赞同：0
> 
> 时间：2012-06-29T12:21:46.107
> 
> 标签：c#, .net, xml, xsd, xsd2code

我有大约 5 个 XML 调用要在 C# 中实现。我使用 Xsd2Code 自动生成代码，我对结果非常满意。但是，我的问题是所有 XML 调用都具有相同的请求响应 TypeName，如下所示：

XML 调用 - 1：

```
<Request Method="AvailabilityRetrievalRQ">
....
</Request>

<Response Method="AvailabilityRetrievalRS">
....
</Response> 
```

XML 调用 - 2：

```
<Request Method="RateRetrievalRQ">
.....
</Request>

<Response Method="RateRetrievalRS">
....
</Response> 
```

因此，所有 5 个 XML 调用都生成了 10 个类 - 5 个名为“Request”，5 个名为“Response”。现在，我知道我总是可以将 XmlType 中的 TypeName 指定为 Request，并重命名类。我已经这样做了。我的问题是更改自动生成的代码是否好。它只是重命名类。我不需要更改任何其他内容。我想到的另一个解决方案是为每个请求-响应对提供不同的 C# 命名空间。但我对此有一种不好的感觉，似乎更像是一种解决方法。

在您看来，理想的解决方案是什么？

另一个疑问是我对内部 XML 节点有同样的问题。在每个 XML 调用中，它们具有相同的名称，但功能不同，因此结构也不同。例如，

XML 调用 - 1

```
<Request Method="AvailabilityRetrievalRQ">
   <Room ID="XXX" />
   .....
</Request> 
```

XML 调用 - 2

```
<Request Method="RateRetrievalRQ">
   <Room ID="XXX" ProductID="YYY" />
   ....
</Request> 
```

现在，我决定不尝试去掉通用类来减少代码冗余。我更喜欢将 XSD 模式与自动生成的类进行映射，并且只是重命名了类以避免任何冲突。例如，上述示例的类似 Room 类将是：

XML 调用 - 1

```
public partial class AvailabilityRetrievalRQ_Room { } 
```

XML 调用 - 2

```
public partial class RateRetrievalRQ_Room { } 
```

我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T11:09:27.543

我决定重命名这些类，以便代码在使用它们时变得可读。命名空间的方法似乎还不够好，也不适合。如果我需要从模式中重新生成类，我将承受再次这样做的痛苦。

# blackberry-10 - 将 Qbytearray 转换为图像黑莓 10 级联

> ID：11261708
> 
> 赞同：0
> 
> 时间：2012-06-29T12:22:49.820
> 
> 标签：blackberry-10

如何将 Qbytearray 转换为图像，以便在 imageView 中显示。任何示例代码都会很有用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T13:15:41.923

QImage 有一个构造函数，它接受一个`uchar* data`. 我假设缓冲区存储在 QByteArray 中，因此尝试使用字节数组中的数据使用适当的构造函数构造 QImage。如果您的 QImage 有效，那么从现在开始就很容易了：

```
QImage swapped = originalImageFromBuffer.rgbSwapped();

PixelBufferData pbd(RGBX /* or RGBA_PRE, depends on the buffer format*/, swapped.width(), swapped.height(), swapped.width(), (void*)swapped.constBits());

myImageFrame->setImage(pbd); 
```

# css - 谷歌翻译带有 CSS 样式的单个字符的单词

> ID：11261711
> 
> 赞同：2
> 
> 时间：2012-06-29T12:23:15.120
> 
> 标签：css, character, html, google-translate

在一个正在进行的网站开发项目中，我使用 html span 标签和 css 将某个可见文本区域中的所有“o”字符设置为红色，如下所示：

```
Questi<span class="redcharacter">o</span>n.
.redcharacter { color: red; } 
```

问题是当我使用我添加到网站的谷歌网站翻译器时，span 标签会破坏单词并且谷歌翻译单独的部分而不是整个单词（“Questi”作为一个单词，“o”作为一个单词，和“n”作为一个词）。

**我的问题是：** *有没有办法让“谷歌网站翻译器”翻译整个单词，仍然让我为单个字符设置样式？*

到目前为止我已经尝试过（没有运气）：

1.  寻找其他样式化单个字符的方法。
2.  寻找一种“挂钩”到某些谷歌翻译 javascript 函数的方法，以便我可以在翻译之前删除 span 标签。只要文本的翻译本身有效，在翻译的页面中不设置单个字符的样式是可以接受的。

提前感谢您，并感谢您提供了这个令人惊叹的网站，它最近对我帮助很大！

编辑：这是我用来在我的页面上包含“Google 网站翻译器”的代码：

```
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script>function googleTranslateElementInit() {
new google.translate.TranslateElement({pageLanguage: 'en', autoDisplay: false}, 'google_translate_element');}</script>
<div id="google_translate_element"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T13:41:51.920

您可以使用 JavaScript 的 innerHTML 属性来获取文本区域内的文本，然后将所有出现的 of 替换为`<span class="redcharacter">o</span>`仅字母 o。然后将该文本发送出去进行翻译。

```
function translate(){
    text = document.getElementById('myTxtArea').innerHTML;
    parsedText = text.replace("<span class="redcharacter">o</span>","o");
    // send parsedText to Google Translate...
    // do something with what is returned
} 
```

类似的东西。

**编辑：** 根据新的细节；我的第一个建议是在 Google 上寻找发送和接收单词及其翻译的不同方式。一个给你一些自由的人。查看代码，看起来他们将来自 translate.google.com 的框的副本植入到您的页面中。

如果这不起作用，请点击[源代码](//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit)的链接并将那里的代码复制到您自己的文件中。修改该代码（这有点令人困惑）并将其放入您的站点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T15:06:30.133

由于`:nth-letter()`尚不可用（但我听说它即将推出），我将使用客户端脚本将所有 o 的颜色染成红色，并确保在翻译完成后触发它。

它可能会闪烁，但是如果没有额外的标记（这会破坏翻译器），就无法使用 css 来定位单个字符。

这是一个超级粗略的[谣言网站](http://www.bram.us/2012/04/13/css-nth-letter/)供参考:)

# javascript - chrome 扩展：在 DOM 对象中获取当前标签页的特定部分并将其显示在 popup.html 或新的 html 页面中？

> ID：11261715
> 
> 赞同：2
> 
> 时间：2012-06-29T12:23:25.880
> 
> 标签：javascript, html, dom, google-chrome-extension

有什么方法可以让我在脚本中将任何 DOM 对象转换为 HTML 页面？

假设我有这样的 dom 对象： content script.js

```
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
  if (request.method == "fromPopup") {
     console.log("got Request from Popup");   
     var myDivObj = document.getElementById("definition");
   //sendResponse({data: "from Content Script to Popup"});
   if ( myDivObj ) {
     sendResponse({data:myDivObj});
     }
     else{
     sendResponse({data:"Empty or No Tag"});
     }
      console.log("sent Response1");   
  } else {
    sendResponse({}); // snub them.
    console.log("sent Response2");   
  }
}); 
```

这是我的 popup.html

```
<body>
  <Div>Searching..</Div>
  <Div id="output">Response??</Div>
  <script>
  console.log("Pop UP Clicked");
 chrome.tabs.getSelected(null, function(tab) {
  chrome.tabs.sendRequest(tab.id, {method: "fromPopup", tabid: tab.id}, function(response) {

    console.log("got Response from Content Script");   
    document.getElementById("output").innerHTML=response.data;
  });
});
  </script>

</body> 
```

我知道我们只能将 JSON 类型的数据发送到 popup.html 页面。对吗？

如果是的话，我有什么方法可以用我收集的 DOM 对象（ myDivObj ）创建 HTML 页面。

任何替代解决方案..？

简而言之，我只想获取 DOM 对象中当前标签页的特定部分，并将其显示在 popup.html 或单独的 html 页面中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T09:12:52.400

使用. 这将返回可用于重新构造 HTML 的字符串。`sendResponse({data:myDivObj**[.outerHTML](https://developer.mozilla.org/en/DOM/element.outerHTML)**});`

笔记：

*   动态添加的事件侦听器和属性会丢失，除非使用属性/内容修改方法 ( `setAttribute('key','value')`/ `.innerHTML=...'`.
*   由于样式表，该元素可能看起来不同。

**警告**：不要盲目地从任意页面注入代码。否则，您将在扩展中打开一个安全漏洞：弹出窗口中的所有脚本都可以完全访问所有允许的扩展 API。

# android - 使用 Asp.Net 的 GCM 推送通知

> ID：11261718
> 
> 赞同：17
> 
> 时间：2012-06-29T12:23:33.357
> 
> 标签：android, asp.net, push-notification, google-cloud-messaging

您可能已经看到，Google 正在迁移其推送通知系统。

[http://developer.android.com/guide/google/gcm/c2dm.html](http://developer.android.com/guide/google/gcm/c2dm.html)

是否有任何示例或指南可用于使用 Asp.Net 应用程序实现 Google Cloud Messaging (GCM)？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-25T13:39:22.897

我有一段代码对我来说运行良好并且可能会有所帮助，我对其进行了测试......

```
void send(string regId)
{
    var applicationID = "xxxxxxxx";

    var SENDER_ID = "xxxxx";
    var value = txtMsg.Text;
    WebRequest tRequest;
    tRequest = WebRequest.Create("https://android.googleapis.com/gcm/send");
    tRequest.Method = "post";
    tRequest.ContentType = " application/x-www-form-urlencoded;charset=UTF-8";
    tRequest.Headers.Add(string.Format("Authorization: key={0}", applicationID));

    tRequest.Headers.Add(string.Format("Sender: id={0}", SENDER_ID));

    // string postData = "{ 'registration_id': [ '" + regId + "' ], 'data': {'message': '" + txtMsg.Text + "'}}";
    string postData = "collapse_key=score_update&time_to_live=108&delay_while_idle=1&data.message=" + value + "&data.time=" + System.DateTime.Now.ToString() + "&registration_id=" + regId + "";
    Console.WriteLine(postData);
    Byte[] byteArray = Encoding.UTF8.GetBytes(postData);
    tRequest.ContentLength = byteArray.Length;

    Stream dataStream = tRequest.GetRequestStream();
    dataStream.Write(byteArray, 0, byteArray.Length);
    dataStream.Close();

    WebResponse tResponse = tRequest.GetResponse();

    dataStream = tResponse.GetResponseStream();

    StreamReader tReader = new StreamReader(dataStream);

    String sResponseFromServer = tReader.ReadToEnd();

    lblStat.Text = sResponseFromServer;
    tReader.Close();
    dataStream.Close();
    tResponse.Close();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-06T01:20:22.237

这是c#中的代码

```
 WebRequest tRequest;
        tRequest = WebRequest.Create("https://android.googleapis.com/gcm/send");
        tRequest.Method = "post";
        tRequest.ContentType = "application/x-www-form-urlencoded";
        tRequest.Headers.Add(string.Format("Authorization: key={0}", GoogleAppID));
String collaspeKey = Guid.NewGuid().ToString("n");
String postData=string.Format("registration_id={0}&data.payload={1}&collapse_key={2}", DeviceID, "Pickup Message" + DateTime.Now.ToString(), collaspeKey);
Byte[] byteArray = Encoding.UTF8.GetBytes(postData);
tRequest.ContentLength = byteArray.Length;

Stream dataStream = tRequest.GetRequestStream();
dataStream.Write(byteArray, 0, byteArray.Length);
dataStream.Close();

WebResponse tResponse = tRequest.GetResponse();

dataStream = tResponse.GetResponseStream();

StreamReader tReader = new StreamReader(dataStream);

String sResponseFromServer = tReader.ReadToEnd();

tReader.Close();
dataStream.Close();
tResponse.Close(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T12:49:24.113

前段时间我一直在玩 C2DM 来发送推送通知。我根据此页面上提到的更改更改了我的代码：http: [//developer.android.com/guide/google/gcm/c2dm.html#server](http://developer.android.com/guide/google/gcm/c2dm.html#server)以用于 GCM 服务：

```
Private Sub btnPush_Click(sender As Object, e As System.EventArgs) Handles btnPush.Click
    lblResponse.Text = SendNotification(AIzaSyB-1uEai2WiUapxCs2Q0GZYzPu7Udno5aA)
End Sub 
```

我的发送通知功能：

```
Private Function SendNotification(ByVal authstring As String) As String
    ServicePointManager.ServerCertificateValidationCallback = Function(sender As Object, certificate As X509Certificate, chain As X509Chain, sslPolicyErrors As SslPolicyErrors) True
    Dim request As WebRequest = WebRequest.Create("https://android.googleapis.com/gcm/send")
    request.Method = "POST"
    request.ContentType = "application/x-www-form-urlencoded"
    request.Headers.Add(String.Format("Authorization: key={0}", authstring))
    Dim collaspeKey As String = Guid.NewGuid().ToString("n")
    Dim postData As String = String.Format("registration_id={0}&data.payload={1}&collapse_key={2}", deviceList.SelectedValue, txtPayload.Text, collaspeKey)
    Dim byteArray As Byte() = Encoding.UTF8.GetBytes(postData)
    request.ContentLength = byteArray.Length
    Dim dataStream As Stream = request.GetRequestStream()
    dataStream.Write(byteArray, 0, byteArray.Length)
    dataStream.Close()
    Dim response As WebResponse = request.GetResponse()
    dataStream = response.GetResponseStream()
    Dim reader As New StreamReader(dataStream)
    Dim responseFromServer As String = reader.ReadToEnd()
    reader.Close()
    dataStream.Close()
    response.Close()

    Return responseFromServer
End Function 
```

GCM 似乎不需要您通过 Google 进行身份验证来获取身份验证密钥（与 C2DM 的情况一样）。相反，您需要一个传递给 SendNotification 函数的 API 密钥。此页面应该可以帮助您设置 API 密钥：http: [//developer.android.com/guide/google/gcm/gs.html](http://developer.android.com/guide/google/gcm/gs.html)

为了以防万一，我的网络表单的代码如下：

```
<form id="form1" runat="server">
<div>
    <asp:DropDownList ID="deviceList" runat="server">
        <asp:ListItem Value="device-id-goes-here">Eclipse AVD</asp:ListItem>
        <asp:ListItem Value="device-id-goes-here">My Phone 1</asp:ListItem>
        <asp:ListItem Value="device-id-goes-here">My Phone 2</asp:ListItem>
    </asp:DropDownList>
    <br /><br />
    <asp:TextBox ID="txtPayload" runat="server" Width="480px"></asp:TextBox>
    <br /><br />
    <asp:Button ID="btnPush" runat="server" Text="Push" />
    <asp:Label ID="lblResponse" runat="server" Text=""></asp:Label>
</div>
</form> 
```

至于创建您的 Android 应用程序以接收推送通知，请查看此链接：http: [//developer.android.com/guide/google/gcm/gs.html#android-app](http://developer.android.com/guide/google/gcm/gs.html#android-app)

不要忘记导入 System.Net、System.IO、System.Security.Cryptography.X509Certificates 和 System.Net.Security。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-02T14:43:07.110

**JSON方式**

user1551788 答案工作正常，但是我喜欢用 JSON 来做，我认为这是更好的做法，而不是在一行中插入所有内容。

内部类 'jsonObj' 与文档要求的相同，请在[此处检查您可以提出的不同请求](https://developers.google.com/cloud-messaging/http)

简要说明：

**to**：要发送到的手机，在此处插入您从手机收到的registrationId。 **delay_while_idle**通过使用 delay_while_idle 标志，一旦设备变为活动状态，就会发送通知。（失锁，当用户真正使用手机时）。

**data**：`data`使用自定义键/值对设置以将额外的有效负载传递给客户端应用程序。所以，如果你喜欢包含另一个对象的 json 字符串，你可以放入任何你想要的变量，只要它不超过 4 KB。

一些我没用过的也可用。

**collapse_key**：如果设置，同名的通知`collapse_key`应该覆盖旧通知（发送通知时手机端的良好实现计量器，在 GCM 服务器上，当通知挂起时它将覆盖）。

**time_to_live**：直截了当，通知将保持多长时间，目前不支持 IOS。

其他一些，请参阅文档。

内部类，因为我不需要我的类之外的那个对象，这更适合命名为“数据”，可以是任何东西。

```
private void SendPostsToGCM(jsonObj jsonObj)
    {            
        string senderId = "your project number (google)";
        string apiKey = "your apiKey, found on console";

        WebRequest tRequest;
        tRequest = WebRequest.Create("https://android.googleapis.com/gcm/send");
        tRequest.Method = "post";

        tRequest.ContentType = "application/json";
        tRequest.Headers.Add(string.Format("Authorization: key={0}", apiKey));
        tRequest.Headers.Add(string.Format("Sender: id={0}", senderId));

        string jsonPostData = Newtonsoft.Json.JsonConvert.SerializeObject(jsonObj); //download Newtonsoft NuGet package

        Byte[] byteArray = Encoding.UTF8.GetBytes(jsonPostData);
        tRequest.ContentLength = byteArray.Length;

        Stream dataStream = tRequest.GetRequestStream();
        dataStream.Write(byteArray, 0, byteArray.Length);
        dataStream.Close();
        WebResponse tResponse = tRequest.GetResponse();
        dataStream = tResponse.GetResponseStream();
        StreamReader tReader = new StreamReader(dataStream);
        String sResponseFromServer = tReader.ReadToEnd();

        string response = sResponseFromServer;
        tReader.Close();
        dataStream.Close();
        tResponse.Close();
    }

    internal class jsonObj
    {
        public bool delay_while_idle { get; set; }
        public data data { get; set; }
        public string to { get; set; }
    }

    internal class data
    {
        public int Id { get; set; }
        public string text { get; set; }
    } 
```

要使用，只需：

```
 //some filtering to select some posts or whatever.
    jsonObj jsonPostData = new jsonObj()
    {
        delay_while_idle = true,
        to = registrationGCMid,
        data = new data()
        {
            Id = post.id,
            text = post.text,
        }
    };
SendPostsToGCM(jsonPostData); 
```

我注意到另一个很大的区别，谷歌服务返回一个包含有用信息的 json 字符串，它告诉有多少成功和多少失败，等等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T15:01:17.723

Nikunj Ganatra，您可以查看此链接以了解您的错误类型，也许您的应用程序 ID 错误或其他详细信息可能不正确.. [http://developer.android.com/guide/google/gcm/gcm.html#最佳](http://developer.android.com/guide/google/gcm/gcm.html#top)

> **响应/描述**
> 
> 200 消息已成功处理。响应正文将包含有关消息状态的更多详细信息，但其格式将取决于请求是 JSON 还是纯文本。有关更多详细信息，请参阅解释成功响应。
> 
> 400 仅适用于 JSON 请求。表示请求无法解析为 JSON，或者它包含无效字段（例如，在需要数字的地方传递字符串）。响应中描述了确切的失败原因，并且应该在重试请求之前解决问题。
> 
> 401 验证发件人帐户时出错。
> 
> 500 尝试处理请求时 GCM 服务器出现内部错误。
> 
> 503 表示服务器暂时不可用（即由于超时等原因）。发件人必须稍后重试，遵守响应中包含的任何 Retry-After 标头。应用程序服务器必须实现指数退避。GCM 服务器处理请求的时间过长。

我刚刚纠正了它。

# java - 如何确保 Java 游戏一开始就接受键盘输入？

> ID：11261723
> 
> 赞同：-3
> 
> 时间：2012-06-29T12:24:01.597
> 
> 标签：java, click

我正在使用 Java 创建一个图形游戏，每次我想运行它时，我都需要在游戏中单击鼠标才能启用所有移动。如果我在不先单击鼠标的情况下尝试移动，则没有任何效果。我怎样才能解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:05:07.083

尝试在您的窗口上调用 requestFocus()

# javascript - 制作一个根据时间更改其行结构的表

> ID：11261742
> 
> 赞同：0
> 
> 时间：2012-06-29T12:25:22.737
> 
> 标签：javascript, html

我正在尝试制作一个时间表，该表将根据当前时间删除某些行。

例子;

（默认表）

> 第一次骑行：1.15
> 
> 第二次骑行：1.45
> 
> 第三次骑行：2.42

假设它是 1.16，所以它变成了这个；

（所需表）

> 第二次骑行：1.45
> 
> 第三次骑行：2.42

我怎样才能实现这个功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:35:51.003

你不能用`HTML`.

但是，您可以在*服务器端*（通过服务器端脚本，如`PHP`、`ASP`、`perl`、 `python`或您选择的任何其他脚本）或在*客户端*通过以下方式执行此操作`JavaScript`：

例如（为了方便和更短的代码，这里我`Javascript`使用[`jQuery`库）：](http://www.jquery.com)

```
<script type="text/javascript">
$(document).ready(function(){

    var now = new Date(); // create date object
    var h = now.getHours(); // get current hour
    var m = now.getMinutes(); // get current minute

    // if  the time is past 13:15 , hide first row of table with id 'mytable'
    if(h>13 || h>12 && m>15) {
       $('table#mytable tr:first').hide();
    } 
});
</script> 
```

# r - 列名作为从数据框中打印特定列的参数

> ID：11261744
> 
> 赞同：0
> 
> 时间：2012-06-29T12:25:34.650
> 
> 标签：r

我有一个如下所示的数据框。我需要根据区域从数据框中提取 AveElapsed 或 Runtime

```
 >avg_data
    region  SN      value   AveElapsed      Runtime
    beta    1       32      1372            943.668
    alpha   2       44      1408            966.495
    beta    3       55      1384            951.091
    beta    4       60      1390            954.929
    atp     5       22      1442            924.381 
```

我需要根据参数取“AveElapsed”列或“Runtime”列。

下面的命令工作正常。但我怎么能

```
 >avg_data[avg_data$region =="beta", "AveElapsed"]
    [1] 1372 1408 1384 1390 1442 
```

但是当我使用函数时

```
 newfun(z, h)
    {
            avg_data[avg_data$region == z, h]
    } 
```

当我调用这个函数

```
 newfun(beta, AveElapsed) 
```

我收到这样的错误..请指教。

```
 Error in "[.data.frame"(avg_data, avg_data$region == z, h) :
             object "beta" not found 
```

另外，当我尝试如下使用时，它不起作用..

```
 M=AveElapsed
    avg_data[avg_data$region == "beta", M] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:28:19.437

那是因为对象`beta`不存在。

试试这个：

```
newfun("beta", "AveElapsed") 
```

这传递了一个包含字符串“beta”的字符对象，而不是一个名为 beta 的（不存在的）对象的内容。正如@BenBarnes 指出的那样，“AveElapsed”也是如此。

# c - 调用 read() 返回 0 但缓冲区发生了变化，调用 fread() 读取相同的偏移量时没有发生

> ID：11261749
> 
> 赞同：1
> 
> 时间：2012-06-29T12:25:49.643
> 
> 标签：c, fread, fseek

如果我通过像这样调用 read() 来读取文件：

```
unsigned char buf[512];
memset(buf, 0, sizeof(unsigned char) * 512);
int fd;
int readcount;
int offset = 10315001; /* file size is 14315504 */

fd = open("myfile", O_RDONLY);
lseek(fd, offset, SEEK_SET);
readcount = read(fd, (void*)buf, 8);
close(fd); 
```

read() 返回 0，但“buf”的内存已更改（不再为 0）。如果我尝试使用 fread() 读取相同的偏移量和相同的文件，如下所示：

```
FILE* file;
file = fopen("myfile", "r");
fseek(file, offset, SEEK_SET);
readcount = fread((void*)buf, 8, 1, file);
fclose(file); 
```

fread() 也返回 0，但 buf 和以前一样。

如果 read() 失败，为什么它会改变“buf”的内存空间？还是我犯了一些错误？

感谢帮助 ： ）

**编辑：每次我运行上面的代码时， read() 以*相同的方式*更改“buf” -> 从 0 到*相同的值*。所以改变的“buf”可能不是*随机值*？**

**编辑2：偏移参数是有效的（感谢twalberg），如果我读取另一个有效的偏移量，read（）和fread（）都会成功，“buf”的结果是一样的。当 read() 失败时，有什么方法可以找出问题所在？当 read() 返回 0 时，errno 为“无错误”。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:29:21.023

未成功调用`read()`或成功的零字节后缓冲区的内容`read()`是未定义的。

可能发生的事情是它分配了一个内部（可能是内核端）缓冲区用于临时存储（其中充满了不同的垃圾）并将缓冲区复制到您的缓冲区中，但实际上并没有写入它的缓冲区。

由于您只需要在成功读取后检查缓冲区，因此这无关紧要。如果您在该缓冲区中有重要数据，请将其移出那里，然后再将其传递给可能会擦除该数据的函数！

**编辑：**代码可能看起来像这样。想象一下`kernel_read()`从文件描述符中读取的系统调用，它需要一个分配在内核地址空间而不是进程地址空间中的缓冲区（因为内核会做一些看起来很奇怪的事情。）

```
extern __kernel void *kernel_malloc(size_t size);
extern void kernel_copy_from_kernel_to_userland(void *dest, __kernel void *src, size_t size);
extern void kernel_free(__kernel void *address);

extern int kernel_is_valid_fd(int fd);
extern ssize_t kernel_read(int fd, __kernel void *kbuf, size_t count);

ssize_t read(int fd, void *buf, size_t count) {
    ssize_t result = -1;

    if (0 == kernel_is_valid_fd(fd)) {
        __kernel void *kernelbuf = kernel_malloc(count);
        if (kernelbuf) {
            result = kernel_read(fd, kernelbuf, count);
            kernel_copy_from_kernel_to_userland(buf, kernelbuf, count);
            kernel_free(kernelbuf);
        } else {
            errno = ENOMEM;
        }
    } else {
        errno = EINVAL;
    }

    return result;
} 
```

这是一个*思想实验*，不是任何出货操作系统的真正实现，但也许它可以帮助您理解为什么您可能会看到您所看到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T06:22:38.077

我想我已经发现这里发生了什么。该文件是二进制文件，但我使用文本模式（O_RDONLY）读取（）它。

偏移量 10315001 的值为 0x1a，当 read() 和 fread() 函数在文本模式下遇到 0x1a 时，它们都将返回 0，**但不同的是，read() 仍然会以二进制模式写入 buf，而 fread( ) 不会这样做。**

# c# - 通过 updown 的大小创建一个全局可用数组

> ID：11261750
> 
> 赞同：0
> 
> 时间：2012-06-29T12:25:55.133
> 
> 标签：c#, arrays, visual-studio-2010

我正在尝试创建一个名为“系列”的静态全局数组。但是其中的字符串数量应该取决于 nummericUpDown 计数器。我尝试了很多变化，导致很多错误变化。我的代码看起来像这样，靠近我的代码顶部：

```
public partial class Form1 : Form
{
    static string[] series; 
```

因此，在我将数组设为全局之后，我想设置它的大小。由于nummericUpDown可以上下，我先擦除数组（导致错误）后来我想用{“M1”，“M2”，“M3”......等等}我应该如何编写这段代码它会起作用吗？

```
private void numericUpDown1_ValueChanged_1(object sender, EventArgs e)
    {
        if (numericUpDown1.Value < 1) { numericUpDown1.Value = 1; }
        int i;
        series[0] = "x";

        if (series.Length > 0) { Array.Clear(series, 0, series.Length); }
        for (i = 0; i < numericUpDown1.Value; i++) { series[i] = "M" + i.ToString(); }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:37:41.373

您只需要将您的系列变量设置为正确大小的新数组。这样做将清除之前数组中的所有先前值。

```
if (series.Length > 0) { series = new string[numericUpDown1.Value]; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:40:12.360

A`List<string>`将是一个更好的主意。但是如果你真的必须使用一个数组：

我建议您最初将数组定义为： static string[] series = new string[0];

然后，如果向上/向下变化：

```
Array.Resize(ref series, newSize); 
```

这将允许重新调整现有阵列的大小。但是请注意，如果大小减小，您将丢失数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:56:42.527

嗨，现在像这样重写它并且它有效，谢谢你的回答！

```
private void numericUpDown1_ValueChanged_1(object sender, EventArgs e)
{       if (numericUpDown1.Value < 1) { numericUpDown1.Value = 1; }
        series = new string[Convert.ToInt16(numericUpDown1.Value)]; 
        int j=series.Length;
        for (int i = 0; i < j; i++) { series[i] = "M" + i.ToString(); }
} 
```

# sql - 如何仅通过电子邮件发送带有数据的报告，而不是在为空时发送报告 - Report Builder 3.0

> ID：11261752
> 
> 赞同：0
> 
> 时间：2012-06-29T12:25:57.357
> 
> 标签：sql, sql-server, sql-server-2008, reporting-services

我不是这些报告的设计者，所以请耐心等待这个问题。我们的 DBA 已根据我编写的 SQL 查询为结果设置了带有 Excel 附件的自动电子邮件。电子邮件每天都会发送，无论其中是否包含数据。如果报告中有数据，我希望报告仅通过电子邮件发送。Report Builder 3.0 中是否有此条件的设置？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T13:25:04.243

您可以检查 excel 文档的大小并在电子邮件服务器上对其进行过滤，然后从电子邮件中自动将其删除。我的意思是，真实报告的大小应该完全不同。

# jquery - window.location.hash 在 pagecreate 事件中返回空字符串

> ID：11261759
> 
> 赞同：0
> 
> 时间：2012-06-29T12:26:34.273
> 
> 标签：jquery, jquery-mobile

我有一个包含内部页面链接的页面，请在下面找到代码。

```
<body> 
    <div id="serviceDetailsPage" data-role="page">

        <div data-role="header" data-position="fixed" data-tap-toggle="false" data-theme="e">
        </div>

        <div data-role="content">

           <a class="loadAudio" data-role="button" data-mini="true" data-inline="true" href="#testPage">test</a>

        </div>      

        <div data-role="footer" class="footerLinks" data-position="fixed"> 
        </div> 
    </div>

    <div id="testPage" data-role="page">

        <div data-role="header" data-position="fixed" data-tap-toggle="false" data-theme="e">
        </div>

        <div data-role="content">

           testPage

        </div>      

        <div data-role="footer" class="footerLinks" data-position="fixed"> 
        </div> 
    </div>

    <script>
    $('#testPage').live('pagecreate',function(){
        console.log(window.location.hash);//returns an empty string
       console.log(window.location.href);//returns old URL
    });
    </script>

    </body> 
```

当页面加载时，URL 是

```
../MyApp/index.html 
```

单击链接后，URL 更改为

```
../MyApp/index.html#testPage 
```

当我使用 window.location.href 时，我得到了旧的 URL，我想我会得到更新的 URL。window.location.hash 返回一个空字符串。这是因为我在页面的错误事件中调用它们吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T01:39:30.640

当您尚未导航到新 url 时（测试页是在导航到之前创建的），您获得了旧 url，因为您正在 pagecreate 处进行检查。如果您改为在 pageshow 进行检查，那么您的两种方法都会得到正确的值（但不同的字符串）。您也可以使用 $.mobile.activePage.attr("id")：

```
$( document ).delegate('#testPage', 'pageshow',function(){
   console.log(window.location.hash);
   console.log(window.location.href);
   console.log($.mobile.activePage.attr("id"));
});​ 
```

（我也使用了 .delegate 而不是 .live）

# java - OpenTypeSelectionDialog 无法解析为类型

> ID：11261761
> 
> 赞同：0
> 
> 时间：2012-06-29T12:26:37.223
> 
> 标签：java, eclipse, swt

当我尝试在我的代码中使用 OpenTypeSelectionDialog 时，为什么会收到此错误“OpenTypeSelectionDialog 无法解析为类型”？

这是代码：

```
 Shell sParent = JavaPlugin.getActiveWorkbenchShell();
 SelectionDialog dialog = new OpenTypeSelectionDialog(sParent, true,
          PlatformUI.getWorkbench().getProgressService(),null, IJavaSearchConstants.TYPE); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:48:30.573

您应该在项目的依赖项选项卡中打开您的 plugin.xml 文件并添加 org.eclipse.jdt.ui 作为插件依赖项，然后组织导入，您应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:36:05.367

当编译器无法找到包含指定 Java 类的代码的文件/类时，您会收到此错误。有很多地方可以包含类型，1.您是否导入了您遇到错误的类型。2\. 您也可能指定了错误的位置（可能是拼写错误） 3\. 您可能想检查包含缺失类型的库是否未包含在类路径中。

检查您是否能够找到类文件？

# video - 将新的自定义原子/盒子插入 MP4 容器格式文件

> ID：11261764
> 
> 赞同：1
> 
> 时间：2012-06-29T12:26:47.193
> 
> 标签：video, data-structures, mp4

我想知道是否有人可以建议我将我自己的对象添加到 MP4 容器结构中。

例如，我发现一个像我们使用的文件一样的典型文件具有以下 'atoms' / 'boxes' ：

*   类型
*   莫夫
*   数据

我想在 ftyp 对象和 moov 对象之间添加我自己的小型自定义对象。

所以对象将显示为：

*   类型
*   哈希
*   莫夫
*   数据

这将是一个仅包含唯一哈希的小对象。

**这里的问题是 - 所有的玩家都会忽略我添加的这个新对象 - 它与播放无关，但用于在内部跟踪我们的文件。**

我想添加一个单独的对象，因为这将在提供文件时即时完成（cgi/php），因此在提供其余文件之前，很容易在文件开头附近插入一个新对象它通过http。

我使用 WMV 文件做了类似的事情，所有我能找到的播放器都会忽略他们无法识别的对象。我想知道 MP4 文件的情况是否相同。玩家是否会忽略他们不期望的对象，我想这应该是玩家的默认行为，因为它是可扩展的容器格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-21T06:41:23.803

“请注意，在某些规范中，框被称为原子。请注意，不鼓励引入新的原子类型；一般而言，如果可能，应使用文件格式的其他可扩展性特征”——文本格式 ISO/IEC 14496-12:2005

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:14:10.160

根据 mpeg 标准文档，所有未知的原子类型都应该被给定的应用程序忽略。所以你实际上可以安全地添加你的跟踪原子。但是，您的 atom 名称中不应包含任何小写字母，因为它们是标准保留的。例如，您的原子名称不能使用“sams”，但可以使用“SAMS”

# php - 使用 JSON + PHP + Google Maps API V2 生成具有多个标记的地图

> ID：11261767
> 
> 赞同：0
> 
> 时间：2012-06-29T12:26:53.787
> 
> 标签：php, ajax, json, google-maps

我正在使用 Google Maps API V2（我知道，但我正在编辑当前代码，因此必须使用 V2）。我所有的标记都指向正确的位置，但只有一个问题让我差点拉扯我的头发。

问题是只有一个所有标记都正确显示，但信息窗口只有一个内容。即信息窗口没有被更新。它们弹出正确，但它们都有相同的信息。

我在其他一些论坛上看到过这个问题并尝试了解决方案，但无济于事。

以下是从我的 php 脚本中获取 json 编码的 PHP 字符串然后循环它以在谷歌地图上显示标记的代码。

```
function showAddress(address) {

var response=$.ajax({
      type: "POST",
      url: "<?php echo WEBROOT; ?>/index/ajaxMaps",
      data: {address : escape(address)},
      cache: false,
      async:false,
      dataType: "json",
      success: function (html) {           

          for(i in html){

              if (geocoder) {
                  geocoder.getLatLng(
                    unescape(html[i].businessAddress),
                    function(point) {
                      if(!point) {

                        //alert(address + " not found");

                      } else {

                        map.setCenter(point, 11);

                          string='<div style="height:100px; background:green; color:white; padding:5px; border-radius:0.5em; width:auto"><strong>Company name : </strong>'+ html[i].businessName;
                          string+='<br/><strong>Adress : </strong>'+ html[i].businessAddress;
                          string+='<br/><strong>Website : </strong>'+'<a style="color:white !important" href="'+html[i].businessWebsite+'" >'+'Visit our website'+'</a></div>';

                        var marker = createMarker(point, string);

                        map.addOverlay(marker);

                        //map.addMapType(G_PHYSICAL_MAP);

                        map.addControl(new GLargeMapControl());

                        // As this is user-generated content, we display it as
                        // text rather than HTML to reduce XSS vulnerabilities.

                        marker.openInfoWindowHtml(string);

                        //$('.map_enlarged').trigger('click');
                      }
                    }
                  );
                }

            }           

      }

    });

 $('.map_enlarged').trigger('click'); 
```

}

现在添加标记的功能：

```
function createMarker(point,html) {

    // Create our "tiny" marker icon
   var blueIcon = new GIcon(G_DEFAULT_ICON);
   blueIcon.image = "<?php echo WEBROOT; ?>images/marker.png";

    // Set up our GMarkerOptions object
    markerOptions = { icon:blueIcon };

    var marker = new GMarker(point,markerOptions);

    GEvent.addListener(marker, "click", function() {
    marker.openInfoWindowHtml(html);

  });

  return marker;
} 
```

我知道变量名“**字符串**”没有被更新。但我不明白为什么。我已将其追溯到循环，但看不出它不应该更新的原因。

请记住，我已经挖掘了足够多的上述代码，如果可以的话，请指出我的代码中的错误。提供其他链接可能没有任何用处，因为我可能已经看过它们。

我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:51:38.933

您需要在“i”上使用另一个函数闭包（关闭地理编码器的输入参数）。

这个[例子](http://www.geocodezip.com/example_geomulti_bad3_xml.asp)解决了这个问题，但没有解决查询限制问题（你真的不应该对大量地址进行即时地理编码，离线地理编码并存储结果坐标）。

# vim - 如何用vim中的扩展选项卡替换

> ID：11261770
> 
> 赞同：1
> 
> 时间：2012-06-29T12:27:05.370
> 
> 标签：vim

我没有问题，我只是好奇。

这是我的 .vimrc 的一部分。

```
set tabstop=4
set shiftwidth=4
set expandtab 
```

我想在文本中全部替换`notab`为 `<-here is a tab`

所以命令应该是：

```
:%s/notab/^I<-here is a tab/ 
```

这给了我真正的标签，所以为了用需要调用的 4 个空格替换它 `:retab`

单次调用结果相同（直接加4个空格）：

`:%s/notab/ <-here is a tab/`

但是不方便，第一个版本在文本中包含真正的制表符，需要重新制表符，第二个版本取决于定义为一个制表符的空格数。

有什么通用的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T13:45:09.590

我认为这应该完全符合您的要求：

```
:%s/notab/\=repeat(" ", &tabstop)/ge 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:20:55.847

如果将@sehe 的答案`notab`放在行首（当 (col-1) % &tabstop == 0 时，但使用变量 &tabstop 时，这保证仅在 col==1 时发生）效果很好。如果您`%s/notab/\t/ge | retab`不满意（即您的变体使用条形符号加入一行）（也许，因为已经有标签不被重新标记，我没有看到任何其他原因）也不用@sehe的回答你必须使用更复杂的代码：

```
function ToExpTab(pat)
    for lnr in range(1, line('$'))
        let line=''
        let chunks=split(getline(lnr), a:pat, 1)
        if len(chunks)<=1
            continue
        endif
        for chunk in chunks[:-2]
            let line.=chunk
            let line.=repeat(' ', &tabstop-(strdisplaywidth(line))%&tabstop)
        endfor
        let line.=chunks[-1]
        call setline(lnr, line)
    endfor
endfunction
call ToExpTab('notab') 
```

# ssis - 创建作业后 gpg.exe 未解密 ssis 包中的文件

> ID：11261773
> 
> 赞同：1
> 
> 时间：2012-06-29T12:27:14.297
> 
> 标签：ssis, jobs

我在 SSIS 包的控制流中插入了一个执行进程任务，它从文件夹中获取加密文件并使用 gpg.exe 解密文件。我已将密钥和密码传递给执行过程任务的表达式。在直接运行包时，它会成功执行并解密文件。但是，当我在该包的 sql server 2005 中创建一个作业并执行该作业时，它显示成功执行但没有一个文件被转换。

工作中存在任何问题或任何其他安全问题的建议。我花了很多时间在谷歌上搜索它，但找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T10:56:33.570

最后我找到了解决方案，包或作业中没有错误。这只是一个不允许执行包含可执行文件的作业的安全问题。我做了什么，我在 sql server 配置管理器>>SQL server 代理中添加了当前用户详细信息。而不是内置帐户检查此帐户并输入当前帐户详细信息。

# android - 使用 Android 4.1 钥匙串

> ID：11261774
> 
> 赞同：3
> 
> 时间：2012-06-29T12:27:14.893
> 
> 标签：android, security, android-4.2-jelly-bean

我正在使用 Android 4.1 钥匙串，以下代码在 4.0 下运行良好，但现在给了我一个 Nullpointer 异常（密码无法读取某些内部属性）

```
privateKey = KeyChain.getPrivateKey(context,mAlias);
byte[] data = // some biary data
Cipher rsasinger = javax.crypto.Cipher.getInstance("RSA/ECB/PKCS1PADDING");
rsasinger.init(Cipher.ENCRYPT_MODE, privkey);

byte[] signed_bytes = rsasinger.doFinal(data); 
```

我将 KeyChain 中的私钥处理为不透明的，只需将其与 java 安全 Api 一起使用。我需要以不同的方式使用 KeyChain API 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T22:49:01.620

经过进一步调试并与 Google 工程师联系（谢谢！）后发现，Android 注册了不同的 JAVA Crypto 提供程序，并且只有 OpenSSL 提供程序能够使用密钥库中的 PrivateKey。

但是通过一些技巧和使用`/system/lib/ssl/engines/libkeystore.so`它应该可以解决这个问题。

请参阅[http://code.google.com/p/ics-openvpn/source/browse/jni/jbcrypto.cpp和](http://code.google.com/p/ics-openvpn/source/browse/jni/jbcrypto.cpp)[http://code.google.com/p/ics-openvpn/source/browse/src](http://code.google.com/p/ics-openvpn/source/browse/src/de/blinkt/openvpn/OpenVpnManagementThread.java#446)中的 proccessSignJellyBean [/de/blinkt/openvpn/OpenVpnManagementThread.java#446](http://code.google.com/p/ics-openvpn/source/browse/src/de/blinkt/openvpn/OpenVpnManagementThread.java#446)我的解决方案。

# ios - iCarousel 多个笔尖

> ID：11261778
> 
> 赞同：1
> 
> 时间：2012-06-29T12:27:33.140
> 
> 标签：ios, xcode, uiview, nib, icarousel

我一直在搞乱 iCarousel（链接：[https](https://github.com/nicklockwood/iCarousel) ://github.com/nicklockwood/iCarousel ）有一段时间了，有一件事我无法理解。

它将 2 个或更多笔尖装入一个旋转木马。这是为轮播中的所有项目加载相同笔尖的当前代码：

```
- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view
{
if (!view)
{
    //load new item view instance from nib
    //control events are bound to view controller in nib file
    view = [[[NSBundle mainBundle] loadNibNamed:@"ItemView" owner:self options:nil] lastObject];

       }
return view;
} 
```

它是 iCarousel 中 ControlsDemo 的标准代码。

我是否正确地说可以将一个简单的 If 语句应用于上面的代码，以便为每个项目使用不同的 nib 填充轮播？

或者我是否必须在一开始就加载一组 nib 文件，然后在上面的方法中引用它们？

还是有完全不同的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:12:39.163

这个问题非常简单，我把它复杂化了。

这是我添加到上述示例中以修复它的代码：

```
- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view
{
    if (index == 0) {
        view = [[[NSBundle mainBundle] loadNibNamed:@"nib1" owner:self options:nil] lastObject];
    } else {
        view = [[[NSBundle mainBundle] loadNibNamed:@"nib2" owner:self options:nil] lastObject];
    }
    return view;
} 
```

# jquery - 更改 z-index 并获得滚动条

> ID：11261781
> 
> 赞同：0
> 
> 时间：2012-06-29T12:27:58.193
> 
> 标签：jquery, html, css

我尝试了很多东西，首先在 css 中使用 jquery，但我无法让 z-index 正确。文本应该越过它右侧的图像而不是它下面的图像。如果我检查源中的 z-index，那么它是正确的，但文本仍然在后面。

```
$(document).ready(function() {

    var entries = $('.entrie').length;

    $('.entrie').each(function(index){
        //console.log(index);
        var newIndex = entries-index;
        console.log(newIndex);
        $(this).css('z-index', newIndex);
    });

}); 
```

这是一个jsfiddle：

[http://jsfiddle.net/EJMqG/](http://jsfiddle.net/EJMqG/)

第二（不太重要），当我把窗口做得很小，然后文字就在图像下面，我该如何防止这种情况发生？我只想要滚动条变小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:54:27.520

添加“位置：绝对；” 在entrieInfo 类和“位置：相对；” 在entrieImage 类中。

演示：http: [//jsfiddle.net/cX8Fy/1/](http://jsfiddle.net/cX8Fy/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:55:52.610

将您正在应用 z-index 的两个元素都提供给`position:relative;`. z-index 不适用于没有位置的任何东西。

# php - 仅在条件等于 true 时显示链接

> ID：11261784
> 
> 赞同：1
> 
> 时间：2012-06-29T12:28:21.233
> 
> 标签：php, if-statement

我希望链接仅在`$data['block']`等于 1、3 或 4 时出现。如果它等于 2 或 5，则不会出现。

```
<td style="font-size:18px;color:#f0cb01;">
    <a href="kickcodes.php?id='.$data["block"].'">Reason Codes</a>
</td> 
```

编辑

```
while ($data = mysql_fetch_array($query)) {

echo '
<tr style="background-color:#576c11;">
    <td style="font-size:18px; color:#f0cb01;">'.$data["keyword"].'</td>
    <td style="font-size:18px;color:#f0cb01;">'.$data["block"].'</td>
    <td style="font-size:18px;color:#f0cb01;">'.$data["phone"].'</td>
    <td style="font-size:18px;color:#f0cb01;">'.$data["Reason"].'</td>
    <td style="font-size:18px;color:#f0cb01;"><a href="kickcodes.php?id='.$data  ["block"].'">Kickcodes</a></td>'

    echo '<td style="font-size:18px;color:#f0cb01;">'; 
if( $data['block'] == 1 || $data['block'] == 3 || $data['block'] == 4)  
{ 
echo '<a href="kickcodes.php?id='.$data["block"].'">Reason Codes</a>'; 
} else  
{ 
echo '<span>Reason Codes</span>'; // Or echo nothing 
} 
echo '</td>'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T12:32:58.957

这将起作用：

```
<td style="font-size:18px;color:#f0cb01;">
 <?php if (in_array($data["block"], array(1,3,4)){?>
    <a href="kickcodes.php?id='.$data["block"].'">Reason Codes</a>
<?php}?>
</td> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:32:15.023

```
 echo '<td style="font-size:18px;color:#f0cb01;">';
 if ($data['block'] == 1 || $data['block'] == 3 || $data['block'] == 4) {
    echo '<a href="kickcodes.php?id='.$data["block"].'">Reason Codes</a>';
 }
 echo '</td>'; 
```

如果您使用单词而不是数字，您可以这样做：

```
echo '<td style="font-size:18px;color:#f0cb01;">';

if ($data['block'] == 'block 1' || $data['block'] == 'block 3' || $data['block'] == 'block 4') {
  echo '<a href="kickcodes.php?id='.$data["block"].'">Reason Codes</a>';
}
echo '</td>'; 
```

希望这可以帮助 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T12:32:19.893

只需将您希望链接发生的条件放在`if`语句中：

```
echo '<td style="font-size:18px;color:#f0cb01;">';
if( $data['block'] == 1 || $data['block'] == 3 || $data['block'] == 4) 
{
    echo '<a href="kickcodes.php?id='.$data["block"].'">Reason Codes</a>';
} else 
{
    echo '<span>Reason Codes</span>'; // Or echo nothing
}
echo '</td>'; 
```

在表格中省略标签是没有意义的`<td>`，这就是我将它放在`if`语句之外的原因。

```
while ($data = mysql_fetch_array($query)) {

echo '
<tr style="background-color:#576c11;">
    <td style="font-size:18px; color:#f0cb01;">'.$data["keyword"].'</td>
    <td style="font-size:18px;color:#f0cb01;">'.$data["block"].'</td>
    <td style="font-size:18px;color:#f0cb01;">'.$data["phone"].'</td>
    <td style="font-size:18px;color:#f0cb01;">'.$data["Reason"].'</td>
    <td style="font-size:18px;color:#f0cb01;"><a href="kickcodes.php?id='.$data  ["block"].'">Kickcodes</a></td>';

    echo '<td style="font-size:18px;color:#f0cb01;">'; 
    if( $data['block'] == 1 || $data['block'] == 3 || $data['block'] == 4)  
    { 
        echo '<a href="kickcodes.php?id='.$data["block"].'">Reason Codes</a>';     
    } 
    else  
    { 
       echo '<span>Reason Codes</span>'; // Or echo nothing 
    } 
    echo '</td>'; 
```

# powershell - Powershell & Plink - 格式化命令

> ID：11261785
> 
> 赞同：0
> 
> 时间：2012-06-29T12:28:29.457
> 
> 标签：powershell, powershell-2.0

我正在尝试从 powershell 脚本中推送一些命令来 plink。

我让它工作，除非文件名中有空格。

```
$entry.name = "File with a space.txt"

$SSH_Source = "/share/USBDisk1"

$Files = $SSH_Source+$entry.Name 
```

当我按下`$Files`plink 时，它会在文件名中的空格后截断。

我需要它用单引号像这样输出，以便 plink 正常工作。

```
/share/USBDisk1/'File with a space.txt' 
```

预先感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T15:01:28.390

你不想做类似的事情：

```
$entryname = "File with a space.txt"
$SSH_Source = "/share/USBDisk1"
$Files = '"' + $SSH_Source + '/' + $entryname + '"'
$Files 
```

您想要完整路径周围的引号，例如：

```
"/share/USBDisk1/File with a space.txt" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:31:45.903

像这样？

```
$entry.name = "'File with a space.txt'" 
```

# php - 阻止用户查找链接

> ID：11261794
> 
> 赞同：0
> 
> 时间：2012-06-29T12:29:20.840
> 
> 标签：php, html, hyperlink, html5-video

我有一个视频存储在我的服务器上。

我不希望人们在找到链接后能够链接到该视频（查看源代码）。

处理这种情况的最佳方法是什么？

谢谢，丹尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:30:43.470

不要将其存储在您的网络根目录中。将其保存在您的 Web 根目录之外，并通过 PHP 文件引用它。该文件将对用户进行身份验证，以验证您是否希望他们能够观看视频并允许他们观看。否则它将阻止视频加载或加载错误消息。

HTML：

```
<a href="video.php">Watch the video</a> 
```

示例 PHP (video.php)：

```
<?php
    if (!isset($_SESSION['authenticated']))
    {
        exit;
    }
    $file = '/path/to/file/outside/www/secret.avi';

    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename=' . basename($file));
    header('Content-Transfer-Encoding: binary');
    header('Expires: 0');
    header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
    header('Pragma: public');
    header('Content-Length: ' . filesize($file));
    ob_clean();
    flush();
    readfile($file);
    exit;
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T12:33:29.440

您可能没有正确表达您的问题，但我认为您正在寻找的是防止热链接，请将其添加到您的 .htaccess

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?yourdomain.com/.*$ [NC]
RewriteRule \.(avi|mp4)$ - [F] 
```

一种更有效的方法是使用一次性链接：

*   请求托管视频的页面。
*   生成随机字符串并将其存储在会话中并将其附加到链接`video.php?id=10&token=9283y540983y45
*   使用 John Conde 的方法来限制直接访问并允许通过 .php 文件进行访问。
*   在 PHP 文件中，通过与会话中的字符串进行比较来检查 URL 中的令牌是否正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T12:43:56.890

如果您不想（或不能）使用身份验证，另一种方法是以某种方式*加密链接，这是约翰在他的回答中所建议的。*如果您的链接每小时都会更改，那么共享将很困难。

如果您使用当前小时（和当天）的 md5 哈希值，则任何发现的链接在大约两个小时后都将无法使用。为什么是两个？因为你应该处理12:59:59生成链接的情况，所以当客户端的浏览器尝试访问资源时，链接是无效的。为防止出现这种情况，您应该检查*前一*小时是否与 url 匹配，如果当前时间不匹配。

如果在 URL 中使用哈希太难，您可能需要该参数 - 并使用类似于 John 在他的回答中显示的代码。

*因此，场景如下所示*：

客户端获取页面。您的服务器需要在那里放置视频的链接。它检查它是否是`2012-06-29 14:55:30`，将该日期视为`2012-06-29T14:5_:__`计算哈希，并提供如下 URL：`href="/videos/736453273dh367d52gs82/movie.mpg"`

客户端的浏览器会下载资源，因此您的服务器会收到对该 URL 的请求，其中包含这些奇怪的数字。您的服务器检查时间，发现它是`2012-06-29 14:55:31`. 清除最后三位数字（因为我认为一个小时可能太多了），并从`2012-06-29T14:5_:__`. 它与客户端提供的 URL 是否匹配？是的。然后提供文件。

如果 URL 不匹配，则服务器将时间减一，因此它尝试编码`2012-06-29T14:4_:__`- 如果也不匹配，则返回错误代码。

因此，您的链接只能工作约 20 分钟。您可以决定什么时间范围适合您的需求。但请记住 - 任何获得该链接的人都可以在此期间使用它。还要小心生成该散列的内容 - 如果这只是时间，您可能会冒着该方案被猜测的风险。使用一些随机*盐*，但请记住，*生成*URL 的页面和*检查*URL 的页面必须相同。

# image - 当鼠标悬停在另一个对话框上时，试图在对话框中隐藏图像

> ID：11261796
> 
> 赞同：0
> 
> 时间：2012-06-29T12:29:29.473
> 
> 标签：image, jquery-ui, dialog, mouseevent

我很快意识到在对话框中编码 jquery 并没有遵循与父 DOC 完全相同的语法。这就是为什么我的代码有 .live("mouseover"... 而不是 .mouseover(... 并且解决这个问题需要很长时间。我有两个并排的图像缩小到它们全尺寸的 40% 以适应 ajax -显示在对话框中的源表单。每个都有一个 id，当光标移过它时，我的代码会愉快地单独扩展每个图像。我想在发生这种情况时隐藏另一个并在鼠标移出时恢复现状，因此表单不是t 搞砸了 mouseout 让我保持现状，但 mouseover 并没有隐藏其他图像。

```
 $('#cadovr').live('mouseover', function() {
    $(this).css('position', 'relative').height("100%").width("100%");
    $('#cadet').hide();
    }).live('mouseout',function() { 
    $(this).css('position', 'relative').height( "40%").width("40%");
    $('#cadet').show();
});
$('#cadet').live('mouseover', function() {
    $(this).css('position', 'relative').height("100%").width("100%");
    $('#cadovr').hide();
    }).live('mouseout',function() { 
    $(this).css('position', 'relative').height( "40%").width("40%");
    $('#cadovr').show();
}); 
```

有人知道为什么我必须在对话框中使用 .live 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:37:59.363

而不是`mouseover`尝试使用`mouseenter`

我见过这个工作，以为我不知道为什么。

至于`.live`， Rab Nawaz 已经解释得很好。

# asp.net - ASP.Net mvc2 ModelStateDictionary Isvalid 使用 Moq 模拟

> ID：11261802
> 
> 赞同：2
> 
> 时间：2012-06-29T12:29:47.377
> 
> 标签：asp.net, unit-testing, asp.net-mvc-2, moq

我是新手使用起订量。我正在为 ASP.Net MVC2 项目创建一些单元测试用例。在其中一个控制器中，我有一个代码，

if(ModelState.IsValid){ ...... ...... }

我试图以这种方式在我的测试方法中模拟它..

```
var modelState = new Mock<ModelStateDictionary>();
modelState.Setup(x => x.IsValid).Returns(true); 
```

但问题是我一直运行测试方法 `ModelState.Isvalid`返回false。问题是我只能处理我的测试项目。我无权对我的 ASP.Net mvc2 项目进行任何更改。你们中有人有这样做的想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:46:07.707

您可以做的是向 中添加模型错误`ModelState`，如下所示：

```
var controller = new YourController();
controller.ModelState.AddModelError("An error"); 
```

这两行`IsValid`应该是假的。

# ruby-on-rails - Rails 3，@font-face 无法使用 Firefox 进行生产

> ID：11261805
> 
> 赞同：23
> 
> 时间：2012-06-29T12:29:56.170
> 
> 标签：ruby-on-rails, fonts, font-face, asset-pipeline, font-awesome

我在 rails 3 应用程序中使用[font-awesome](http://fortawesome.github.com/Font-Awesome/)，在开发模式下一切正常，但是当我推送到 Heroku 时，Firefox 无法呈现图标，相反，我看到了这个：

![在此处输入图像描述](../Images/7ab449661432a1c4a610c8e61702b2e6.png)

*   Chrome 在开发和生产中呈现良好的图标
*   这只会影响 FireFox（虽然我没有尝试过 IE）
*   该应用程序在[这里](https://pure-sunset-9274.herokuapp.com)，如果有人能确认这不仅发生在我的机器上（帮助我排除本地主机缓存问题），我将不胜感激。
*   所有资产，包括字体和样式表，都使用[asset_sync](https://github.com/rumblelabs/asset_sync) gem 托管在S3 上。

**这是我所做的：**

在 font-awesome.css.scss 的顶部添加了以下内容：**

```
// font-awesome.css.scss
@font-face {
  font-family: 'FontAwesome';
  src: font-url("fontawesome-webfont.eot");
  src: font-url("fontawesome-webfont.eot?#iefix") format("eot"),
       font-url("fontawesome-webfont.woff") format("woff"),
       font-url("fontawesome-webfont.ttf") format("truetype"),
       font-url("fontawesome-webfont.svg#FontAwesome") format("svg");
  font-weight: normal;
  font-style: normal;
} 
```

然后我把它放在 application.rb 中：

```
# application.rb
config.assets.paths << Rails.root.join("app", "assets", "fonts")
config.assets.precompile += %w( .svg .eot .woff .ttf ) 
```

最后，我将所有 4 个字体文件放在`app/assets/fonts`.

我真的很想知道我在这里做错了什么。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-05-13T20:46:40.013

这是我在 AWS 管理控制台中添加到我的存储桶以配置这个交叉事物的配置：

登录 AWS -> AWS 管理控制台 -> S3 -> 找到您的存储桶 -> 推送属性按钮（出于某种原因在纸上放大镜） -> 右侧的 Clic 权限 -> “编辑 CORS 配置”

```
<CORSConfiguration>
    <CORSRule>
        <AllowedOrigin>*</AllowedOrigin>
        <AllowedMethod>GET</AllowedMethod>
        <MaxAgeSeconds>3000</MaxAgeSeconds>
        <AllowedHeader>Content-*</AllowedHeader>
        <AllowedHeader>Host</AllowedHeader>
    </CORSRule>
</CORSConfiguration> 
```

经过两个小时的研究...... :-(

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-29T23:33:27.200

我解决了我的问题。

从[这篇文章中](http://blog.fallingmanstudios.net/post/14281163243/firefox-font-face-in-rails-with-asset-subdomains#notes)，我了解到：

> 除非设置了某些特定的标头，否则 Firefox 会拒绝所有跨站点字体请求：
> 
> [即访问控制允许来源]

而且，从[这篇文章](http://motoole.com/2011/10/19/hosting-font-face-fonts-on-s3.html)：

> 可悲的是，现在 S3 不允许您指定为您的对象提供服务的 Access-Control-Allow-Origin 标头

所以你有几个选择：

1.  从应用程序的公共文件夹中提供字体，而不是从 S3
2.  从 Rackspace 提供字体，您**可以**在其中设置标题
3.  将字体作为[Base64 字符串嵌入](http://geoff.evason.name/2010/05/03/cross-domain-workaround-for-font-face-and-firefox/)

我选择了第一个选项，因为这将是一个低流量站点，但这里有一篇很好的文章，介绍了如何[从 Rackspace 提供字体](http://www.bryandragon.com/articles/rails-asset-pipeline-cdns-and-serving-cross-domain-fonts)，同时从 S3 提供所有其他资产。

* * *

**更新：**

亚马逊[昨天宣布](http://aws.amazon.com/about-aws/whats-new/2012/08/31/amazon-s3-announces-cross-origin-resource-sharing-CORS-support/)，他们现在支持跨域资源共享 (CORS)，因此不再需要上面发布的解决方案。他们的[开发者指南](http://docs.amazonwebservices.com/AmazonS3/latest/dev/cors.html)解释了更多。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-02T16:08:44.333

Amazon S3 现在支持 CORS，您不再需要在 CSS 中嵌入 BASE64 字体（它会为您节省一些带宽：）

[http://aws.amazon.com/about-aws/whats-new/2012/08/31/amazon-s3-announces-cross-origin-resource-sharing-CORS-support/](http://aws.amazon.com/about-aws/whats-new/2012/08/31/amazon-s3-announces-cross-origin-resource-sharing-CORS-support/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-08T05:39:12.633

You can also use some rack middleware to serve the fonts directly with the required access-control headers to cloudfront.

```
# config/environment/production.rb

  # Rack Headers
  # Set HTTP Headers on static assets

  config.assets.header_rules = {
    :global => {'Cache-Control' => 'public, max-age=31536000'},
    :fonts  => {'Access-Control-Allow-Origin' => '*'}
  }
  require 'rack_headers'
  config.middleware.insert_before '::ActionDispatch::Static', '::Rack::Headers'

-----

# lib/rack_headers.rb

require 'rack/utils'

module Rack
  class Headers

    def initialize(app, options={})
      @app = app

      default_path = Rails.application.config.assets.prefix || '/assets'
      @asset_path = options.fetch(:path, default_path)

      default_rules = Rails.application.config.assets.header_rules || {}
      @rules = options.fetch(:header_rules, default_rules)
    end

    def call(env)
      dup._call(env)
    end

    def _call(env)
      status, @headers, response = @app.call(env)
      @path = ::Rack::Utils.unescape(env['PATH_INFO'])

      if @path.start_with?(@asset_path)
        set_headers
      end

      [status, @headers, response]
    end

    def set_headers
      @rules.each do |rule, headers|
        case rule
        when :global # Global
          set_header(headers)
        when :fonts  # Fonts Shortcut
          set_header(headers) if @path.match %r{\.(?:ttf|otf|eot|woff|svg)\z}
        when Array   # Extension/Extensions
          extensions = rule.join('|')
          set_header(result) if @path.match %r{\.(#{extensions})\z}
        when String  # Folder
          set_header(result) if
            (@path.start_with? rule || @path.start_with?('/' + rule))
        when Regexp  # Flexible Regexp
          set_header(result) if @path.match rule
        else
        end
      end
    end

    def set_header(headers)
      headers.each { |field, content| @headers[field] = content }
    end
  end
end

----- 
```

This solution uses rules for setting different headers on every file based on rules. The rules are described here: [https://github.com/thomasklemm/butler#providing-rules-for-setting-http-headers](https://github.com/thomasklemm/butler#providing-rules-for-setting-http-headers). Basically you can do anything with Regexps, but there are shortcuts for file endings, folders, web fonts and global headers.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-14T22:38:20.823

只需在 s3 中添加整个存储桶的标头即可。

[http://aws.typepad.com/aws/2012/08/amazon-s3-cross-origin-resource-sharing.html](http://aws.typepad.com/aws/2012/08/amazon-s3-cross-origin-resource-sharing.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-13T12:35:43.073

您可以使用以下站点对字体进行 Base64 编码。尝试使用 FontSquirel 但它不允许您加密版权/购买的字体。

[http://base64fonts.com/convert.php](http://base64fonts.com/convert.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-06T15:24:06.330

此线程有更新。似乎无法通过将 cors.xml 文件上传到存储桶来设置 CORS。现在你必须点击它；）。这个线程在寻找解决方案时为我节省了一些时间，但另一方面，我在上传和更改 cors.xml 文件时浪费了一些时间。

当前的解决方案是单击存储桶的属性 > 权限 > 然后单击添加 CORS 配置

# bnd - 嵌入除类型包之外的依赖项

> ID：11261806
> 
> 赞同：2
> 
> 时间：2012-06-29T12:29:56.467
> 
> 标签：bnd, maven-bundle-plugin

在 POM 父级中，我定义了构建捆绑包的所有通用规则。在*嵌入依赖*指令中，我想写：

```
<Embed-Dependency>*;scope=compile|runtime;artifactId=!my-api;type=!bundle</Embed-Dependency> 
```

“嵌入所有具有编译或运行时范围的依赖项，除了 my-api 工件和捆绑类型的依赖项。”

它适用于*范围*和*artifactId*约束，但**type!=bundle**似乎不起作用。

所有这些都是为了避免必须指定*提供*的范围来捆绑依赖项。

任何想法 ？

谢谢

# .net - 在 MSBuild 中获取“参考程序集”路径

> ID：11261813
> 
> 赞同：4
> 
> 时间：2012-06-29T12:30:23.920
> 
> 标签：.net, msbuild

我正在更新一个与 .NET 4.5 兼容的版本，我需要做的更改之一是[更新我调用 ilmerge](http://www.mattwrock.com/post/2012/02/29/What-you-should-know-about-running-ILMerge-on-Net-45-Beta-assemblies-targeting-Net-40.aspx)的方式。

从上面的链接，这基本上意味着改变：

```
/targetplatform:"v4,C:\windows\Microsoft.NET\Framework\v4.0.30319" 
```

到：

```
/targetplatform:"v4,C:\Program Files\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0" 
```

在我的 MSBuild AfterBuild 目标中，我使用 生成前者`$(MSBuildToolsPath)`，如下所示：

```
/targetplatform:v4,$(MSBuildToolsPath) 
```

将其转换为所需`/targetplatform:"v4,C:\Program Files\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0"`路径的最佳方法是什么，以便它可以在 x64、x86 或任何可以安装的异常位置上运行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T20:18:29.870

在您的目标中添加 GetReferenceAssemblyPaths 任务。让它将输出保存到项目名称或属性，并用这个新属性替换 $(msbuildtoolsPath)。您还可以添加条件检查以确定需要传递给 ILMerge 的内容。

```
<GetReferenceAssemblyPaths BypassFrameworkInstallChecks="False" TargetFrameworkMoniker=".NETFramework,Version=v4.0">
    <Output TaskParameter="FullFrameworkReferenceAssemblyPaths" PropertyName="path" />
</GetReferenceAssemblyPaths> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:52:50.760

如果您可以找到包含信息（或您需要的信息的重要元素）的注册表项，那么我会使用`$(Registry:<key name>[@<value name>])`语法来获取它。

[http://blogs.msdn.com/b/msbuild/archive/2007/05/04/new-registry-syntax-in-msbuild-v3-5.aspx](http://blogs.msdn.com/b/msbuild/archive/2007/05/04/new-registry-syntax-in-msbuild-v3-5.aspx)

# c - a+++++b 和 a++ + ++b 的区别

> ID：11261814
> 
> 赞同：9
> 
> 时间：2012-06-29T12:30:25.687
> 
> 标签：c

> **可能重复：**
> [为什么 a+++++b 在 C 中不起作用？](https://stackoverflow.com/questions/5341202/why-doesnt-ab-work-in-c)
> [3 c 中两个变量之间的加号](https://stackoverflow.com/questions/7233317/3-plus-between-two-variables-in-c)

我尝试搜索此内容，但找不到任何结果。

代码`c=a+++++b`无法编译（gcc），而 for`c=a++ + ++b`则编译成功。`c=a+++ ++b`也有效。`c=a++ +++b`失败。

为什么空格在这里会产生如此大的差异？还是我错过了 C 的一个重要概念？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T12:37:06.447

因为`++`是一个记号，解析器的解释`a+++++b`与 相同`a ++ ++ + b`，与`a ++ + ++ b`!不同。

# ios - 特殊的 UIlabel 设计

> ID：11261817
> 
> 赞同：0
> 
> 时间：2012-06-29T12:30:46.807
> 
> 标签：ios, user-interface, uilabel

我正在开发一个 iOS 应用程序，我想为`UILabel`这个图像设置样式。[图片 http://img4.hostingpics.net/thumbs/mini_388558Capturedcran20120629142330.png](http://img4.hostingpics.net/thumbs/mini_388558Capturedcran20120629142330.png)

是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T14:28:21.433

一种解决方案可能是将 UILabel 添加为包装器 UIView 的子视图

```
// Using ARC

// Set Wrapper
CGRect wrapperFrame = CGRectMake(0, 0, 320, 80);
UIView *specialLabel = [[UIView alloc] initWithFrame:wrapperFrame];
[specialLabel setBackgroundColor:[UIColor blackColor]];

// Set Content
CGFloat padding = 10;
CGRect contentFrame = CGRectInset(wrapperFrame, padding, padding);
UILabel *contentLabel = [[UILabel alloc] initWithFrame:contentFrame];
[contentLabel setBackgroundColor:[UIColor greenColor]];

// Append content to wrapper
[specialLabel addSubview:contentLabel]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:36:05.477

`UILabel`一个解决方案是像往常一样创建一个，然后`UIView`在`UILabel`. 您实际上可以根据文本字体的大小计算应该放置的位置。

# ruby-on-rails - 无法让嵌套模块工作

> ID：11261819
> 
> 赞同：2
> 
> 时间：2012-06-29T12:30:55.183
> 
> 标签：ruby-on-rails

我正在尝试为要共享的模型创建一些通用范围，所以我创建了这个：

```
lib
|_ scopes
   |_ scope.rb
   |_ bars.rb 
```

* * *

```
# lib/scopes/scope.rb
module Scope
end 
```

* * *

```
# lib/scopes/bars.rb
module Scope
  module Bars
    def self.included(base)
      base.class_eval{
        scope :somescope, lambda{ where(:foo => :bar) }
      }
    end
  end
end 
```

现在当我把它放在一个模型中时：

```
include Scope::Bars 
```

它抛出一个错误：**Expected c:/sites/app_name/lib/scopes/bars.rb to define Bars**

出于某种奇怪的原因，当我只使用 rails 控制台而不是 WEBrick 服务器进行测试时，不会发生这种情况。

如果我不使用子模型，它也可以完美地工作，比如：`include Bars`会工作得很好。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T13:53:27.750

以下结构

```
lib
|_ scopes
   |_ scope.rb
   |_ bars.rb 
```

期望您将顶级模块定义为`Scopes`，而不是`Scope`。将文件夹重命名`scopes`为`scope`或将模块更改为

```
# lib/scopes/bars.rb
module Scopes
  module Bars
    def self.included(base)
      base.class_eval do
        scope :somescope, lambda { where(:foo => :bar) }
      end
    end
  end
end 
```

# php - 如何将 PHP 网站作为包部署在 IIS 上？

> ID：11261822
> 
> 赞同：0
> 
> 时间：2012-06-29T12:31:12.877
> 
> 标签：php, iis, deployment, package

如果我的问题已经出现在其他帖子中，请见谅。

我正在编写一个`PHP`网站`MySQL`并将其发布在 IIS 上。使我能够做到这一点的方法是启用 CGI 扩展`IIS`并将源`PHP`文件复制到“inetpub”文件夹下的文件夹中。

这是问题。如果我不想将我的`PHP`文件（显然包括我的代码）复制到“inetpub”文件夹中，有没有办法制作我的文件的包`PHP`文件？例如，`Tomcat`服务器执行“.war”包文件。是否有我可以将我的`PHP`页面放入其中并在 IIS 上部署并在 IIS 上发布的包文件类型？

如果没有办法实现这一点，我该怎么做才能防止将`PHP`文件复制并粘贴到“inetpub”文件夹中？

谢谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:38:03.777

你可以看看 Web Deploy。它不像 WAR 那样紧凑地打包文件，但它是“官方方式”：

[http://www.iis.net/download/WebDeploy](http://www.iis.net/download/WebDeploy)

# matlab - 将 Matlab 图导出为 PNG？

> ID：11261823
> 
> 赞同：12
> 
> 时间：2012-06-29T12:31:27.027
> 
> 标签：matlab, graphics, png, export

我需要自动将 Matlab 中的数字导出到 PNG。我的图的大小为 600x200 像素：

```
hFig = figure(1); 
set(hFig, 'Color', [1 1 1]); % backgroundcolor white
set(hFig, 'Position', [500 500 600 200]) % size 600x200 
```

我试过了

```
print -dpng image.png 
```

但 image.png 大于 600x200 像素。使用“保存”按钮从图形窗口 GUI 手动导出图形效果很好，我想自动/从脚本中执行此操作。感谢您的任何提示！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-29T12:47:57.403

我也知道数字保存的问题永远不会与屏幕上的相同。

有`saveas`可能对您有用的命令-但也为我改变了一些分辨率。

我知道的唯一方法是像这样仔细设置每个方面：

```
set(gcf,'PaperUnits','inches','PaperSize',[2,6],'PaperPosition',[0 0 2 6])
print('-dpng','-r100','test') 
```

（因此纸张尺寸为 2x6 英寸并以 100dpi 打印，PaperPosition 很重要，否则您将有一些额外的边框。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T19:36:54.373

我从 MATLAB 生成 png 图的首选方法是[MATLAB 文件交换](http://www.mathworks.com/matlabcentral/fileexchange/23629)`export_fig`处提供的实用程序。

这是一个例子：

```
set(gcf, 'Position', [100 100 500 500], 'Color', 'w')

x=0:0.01:10;
plot(x, sin(x))
set(gca, 'FontSize', 20, 'FontName', 'Arial')

export_fig 'strip-diff-far-forward.png' -painters -nocrop 
```

这将创建一个 500 x 500 像素、20 像素字体的 png。我敢肯定，它在内部做的事情与 bdecaf 的答案相同，但它已经全部封装在一个函数中，并且还具有许多其他功能。

缺点是如果您使用 -painters 渲染器（我认为它看起来最好），您将需要安装 ghostscript。如果您不想弄乱它，可以更改`-painters`为`-opengl`

**现在编辑** 正确设置图形大小！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-11T18:18:37.720

Amro 答案完美运行，生成图形后，设置`PaperPositionMode`为`auto`，打印尺寸将与屏幕尺寸相同。

```
set(gcf, 'PaperPositionMode','auto')   
print('-dpng','test.png') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T13:48:36.847

根据 bdecaf 的回答：

```
set(gcf,'PaperUnits','inches','PaperSize',[600/96,200/96],'PaperPosition',[0 0 600/96 200/96])
print('-dpng','-r96','test') 
```

96是我系统的dpi。这给了我与保存功能完全相同的输出。对于 Windows，dpi 通常为 96，有时为 120。只需根据您的系统进行调整即可。请注意，在投影仪上，DPI 可能再次与您的系统不同，特别是如果您的系统具有 120 DPI！我认为对于投影仪来说，96 DPI 通常应该是一个相当安全的选择。如果您需要帮助找出系统的 DPI 设置，请使用 Google。这个答案是 99,9% 基于 bdecaf 和 Florian，所以我将选择 bdecaf 的答案作为正确的答案。

编辑：600 = 像素水平图像大小，200 = 像素垂直图像大小

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T13:15:49.000

尝试：

```
set(hFig, 'PaperPositionMode','auto')   %# WYSIWYG
print -dpng -r0 image.png               %# at screen resolution 
```

这告诉它生成与屏幕上显示的大小相同的图像。

# objective-c - 如何将两个 CCAction 应用于两个不同的 CCSprite 并在一个 CCLayer 上同时运行它们？

> ID：11261834
> 
> 赞同：0
> 
> 时间：2012-06-29T12:32:14.327
> 
> 标签：objective-c, xcode, cocos2d-iphone, ccsprite

其实问题就在标题里。无论如何，我想重复一遍：
**问题：**如何将两个不同的 CCAction 应用于两个不同的 CCSprite 并在一个 CCLayer 上同时运行它们？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:50:37.507

CCLayer 与此无关。您只需一个接一个地发送带有操作的 runAction 消息，以使操作同时开始运行：

```
id action1 = [CCFadeOut actionWithDuration:1];
[sprite1 runAction:action1];

id action2 = [CCFadeIn actionWithDuration:1];
[sprite2 runAction:action2]; 
```

# css - CSS 跨浏览器问题，在 IE9 中 div 不会填充容器，在 Firefox 中溢出

> ID：11261842
> 
> 赞同：2
> 
> 时间：2012-06-29T12:32:34.457
> 
> 标签：css, cross-browser, position, css-tables

我正在处理一张表格，该表格的单元格需要降低不透明度的背景，并且顶部的文本不受背景影响。单元格中的内容是动态的。

[http://jsfiddle.net/6zszm/3/](http://jsfiddle.net/6zszm/3/)

在 IE9 中（未在其他 IE 版本中测试过）背景在 span 内容处被裁剪。在 Firefox 中，背景运行狂野并溢出到右下角。在 chrome 中，这就像一个魅力。

一些类似的问题并没有完全涵盖它： [如何使 <div> 填充 <td> 高度](https://stackoverflow.com/questions/3542090/how-to-make-div-fill-td-height) 有人建议 td 的高度为 1px - 这对我不起作用，没有任何改变。我也宁愿不使用 JS 来解决这个问题。

另一个相关的问题： IE9 中的[CSS 绝对定位错误](https://stackoverflow.com/questions/7126673/css-absolute-positioning-bug-with-ie9) 奇怪的是在 IE9 中，它*在*兼容模式下工作，但并非没有。

 `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T14:35:28.920

**这看起来确实是不可能**的——除非你专门定义了每个单元格的宽度和高度，这样就违背了使用表格的目的。

可能的解决方案...

## RGBA

假设您要使用背景颜色，`background-color: rgba(200,200,200,0.5)`如果失败，您始终可以使用回退到纯色。所有顶级浏览器都支持 RGBA，但它不适用于 IE8 及以下版本……

## 透明PNG

显而易见的简单方法是回退到使用透明 PNG，但这取决于您使用的颜色是预定义的并且相当严格。

## 使用 -moz-element

另一个让 FireFox 工作的*疯狂*解决方案（如果您使用背景图像而不是颜色）将使用该`background: moz-element()`功能。在这里，您可以在页面上创建您可能需要的每种不同不透明度的隐藏元素，并通过 id 将它们作为背景引用。例如：

`<div id="image1" style="background: url(image1.jpg); opacity: 0.5;"></div>`

然后在您希望背景出现的元素上引用它：

`<td style="background: -moz-element(#image1);"></td>`

但是，我不保证这种方法，它相当不雅且特定于浏览器。Tbh 我很惊讶地发现这个问题确实无法使用普通的绝对和相对技巧来解决（尤其是在 FF 中）。

## 不要我们的表

**到目前为止，更多浏览器支持的解决方案**是放弃使用表并使用良好的旧 div 和浮点数重新创建表结构。此解决方案的唯一问题是您必须再次定义大多数宽度和高度，并且您将无法实现垂直单元格对齐，除非您回退到像[FlexBox](http://www.w3.org/TR/css3-flexbox/)这样更具实验性的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:52:35.340

您可以尝试使用 CSS 框架，例如 LESS 或 Blueprint。大多数框架都有背景代码，可以让你的样式在所有浏览器中看起来都一样，即使通常需要调整。`

# android - 如何从手机中获取选项

> ID：11261843
> 
> 赞同：0
> 
> 时间：2012-06-29T12:32:35.710
> 
> 标签：android, options

来自南欧的问候，

我正在尝试制作一个应用程序，需要从移动设备中获取一些选项，例如语言、移动设备的容量（内存 ram、cpu）和一些输入调用......但问题是我什至不知道什么名字会收到这种android上的功能所以我希望你明白我的意思，也许能帮助我。

谢谢和最好的问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:37:41.067

如果我了解您正在寻找：http: [//developer.android.com/reference/android/provider/Settings.System.html](http://developer.android.com/reference/android/provider/Settings.System.html)

你可以通过使用这个类来获得手机上很多东西的配置。

# java - Java中的methodName(Params...params)是什么意思

> ID：11261850
> 
> 赞同：0
> 
> 时间：2012-06-29T12:33:34.103
> 
> 标签：java

> **可能重复：**
> [当您使用 object... 作为参数时，它叫什么？](https://stackoverflow.com/questions/1397895/what-is-it-called-when-you-use-object-as-a-parameter)

我在 Java 中经常看到这种模式。我的问题是，什么是`...`for，它叫什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:34:58.753

它被称为“可变参数”：

[http://docs.oracle.com/javase/1.5.0/docs/guide/language/varargs.html](http://docs.oracle.com/javase/1.5.0/docs/guide/language/varargs.html)

它是 Java 1.5+ 的一个特性，并且已经存在了将近十年。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:37:09.773

好的...

（参数...参数）

“...” 表示**参数的可变长度**。

此外，doInBackground 是一种在非 ui 线程中执行进程密集型工作的方法，存在于`SwingWorker class Java`和 中`AsyncTask<> in Android`。

# .net - 编辑我的文本文件以仅显示最高值？

> ID：11261852
> 
> 赞同：0
> 
> 时间：2012-06-29T12:33:40.873
> 
> 标签：.net, vb.net, vb.net-2010

我使用以下编码根据列中的值小于文本框中的值来编辑我的文本文件。

```
Dim intValue As Integer
        Dim intMaxValue As Integer = Integer.Parse(textbox1.Text)

        Dim strSourceFile As String = IO.Path.Combine("G:\test.txt")
        Dim OutPutFile As String = IO.Path.Combine("G:\test2.txt")

        Dim strLines() As String = IO.File.ReadAllLines(strSourceFile)
        Dim strFiltered As New System.Text.StringBuilder
        Dim strTemp() As String

        For Each strLine In strLines
            If strLine.Trim.Length <> 0 Then
                strTemp = strLine.Split(" "c)
                If Trim(strTemp(0)) = "USER" AndAlso Trim(strTemp(2)) = "1" Then
                    strLine = strTemp(8).Trim & " " & strTemp(16).Trim
                    If Integer.TryParse(strLine.Split(" "c)(1), intValue) Then
                        If intValue <= intMaxValue Then
                            strFiltered.Append(strLine & Environment.NewLine)
                        End If
                    End If
                End If
            End If

        Next

        IO.File.WriteAllText(OutPutFile, strFiltered.ToString) 
```

现在上述编码完美运行，输出如下所示：-

```
String1 100
String1 256
String1 500
String2 100
String2 256
String3 876
String3 345
String3 643
String3 102
String4 100
String4 084
String5 492
String5 178
String6 873
String6 156
String6 786 
```

我希望的是添加额外的编码，所以我只想要显示最高数字的字符串，所以上面看起来像

```
String1 500
String2 256
String3 876
String4 100
String5 492
String6 873 
```

是否可以添加最后一点编码？

**更新**

我不想检查最高数字并删除其他字段，而是希望检查第 1 列中的每个匹配字段并检查最高数字，如果它大于 textbox1 中的字段，则删除第 1 列中该匹配字段的所有行。如果最高数字低于 textbox1 中的字段，然后保留该行但删除其他第 1 列匹配的字段。所以例如

```
String1 100
String1 256
String1 500
String2 100
String2 256
String3 876
String3 345
String3 643
String3 102
String4 100
String4 084
String5 492
String5 178
String6 873
String6 156
String6 786 
```

所以如果 textbox1 有 550 那么你应该有

```
String1 500
String2 256
String4 100
String5 492 
```

**更新 2**

textbox1 中的值为

```
1341273599 
```

当我只过滤列以显示第 1 列和第 2 列时，我得到以下信息。

```
S00048 1428142557
S00048 1428141809
S00048 1338805621
S00048 1310295931
S00048 1309086124
S00048 1432203954
S00048 1431686625
S00048 1428142556
S00048 1431686626
S00048 1334743408
S00042 1324204635
S00040 1313659927
S00037 1308388943
S00033 1303118141
S00032 1391422317
S00032 1391422304
S00032 1298024019
S00032 1391422303
S00032 1391422316 
```

因此，当我运行实际编码时，我得到以下信息

```
S00048 1338805621
S00042 1324204635
S00040 1313659927
S00037 1308388943
S00033 1303118141
S00032 1298024019 
```

您可能会看到最终结果不正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T12:43:22.447

您可以使用 Dictionary 来保存值：

```
 Dim FilteredDictionary as new Dictionary(string, integer)

    Dim intValue As Integer
    Dim intMaxValue As Integer = Integer.Parse(textbox1.Text)

    Dim strSourceFile As String = IO.Path.Combine("G:\test.txt")
    Dim OutPutFile As String = IO.Path.Combine("G:\test2.txt")

    Dim strLines() As String = IO.File.ReadAllLines(strSourceFile)
    Dim strFiltered As New System.Text.StringBuilder
    Dim strTemp() As String

    Dim lastIntValue as integer = 0
    For Each strLine In strLines
        If strLine.Trim.Length <> 0 Then
            strTemp = strLine.Split(" "c)
            If Trim(strTemp(0)) = "USER" AndAlso Trim(strTemp(2)) = "1" Then
                strLine = strTemp(8).Trim & " " & strTemp(16).Trim
                If Integer.TryParse(strLine.Split(" "c)(1), intValue) Then
                      If intValue = 0 Then
                        intValue=lastIntValue
                      Else
                        lastIntValue=intValue
                      End If
                      If FilteredDictionary.ContainsKey(strTemp(8).Trim) then
                        If intValue > FilteredDictionary(strTemp(8).Trim) then
                          FilteredDictionary(strTemp(8).Trim) = intValue
                        End If
                      Else
                        FilteredDictionary.Add(strTemp(8).Trim, intValue)
                      End If
                        'strFiltered.Append(strLine & Environment.NewLine)

                End If
            End If
        End If
    Next

    'Modifed stringbuilder to only add those items that are less than or equal to
    'a given value in Textbox1\.  Note that if Textbox1 is not an integer,
    'it will throw an error.  You could use Integer.TryParse instead.
    For Each item As String in FilteredDictionary.Keys.ToList
       If FilteredDictionary(item) <= Convert.ToInt32(Textbox1.Text)
         strFiltered.AppendLine(item & " " & FilteredDictionary(item))
       EndIf
    Next
    IO.File.WriteAllText(OutPutFile, strFiltered.ToString) 
```

# perl - 有没有比 Perl 的 Data::Dumper 更简洁的替代方法？

> ID：11261854
> 
> 赞同：2
> 
> 时间：2012-06-29T12:33:47.913
> 
> 标签：perl, data-dumper

我正在尝试打印一些解析树，并且`Data::Dumper`对此非常冗长，例如打印：

```
{
  'A' => {
    'ID' => 'y'
  },
  'OP' => '=',
  'B' => {
    'NUM' => '5'
  }
}, 
```

而不是让我们说：

```
{
  'A' => {'ID' => 'y'},
  'OP' => '=',
  'B' => {'NUM' => '5'}
}, 
```

而且它非常难以阅读，因为它需要大量的行。

是否有任何 Perl 库可以`Data::Dumper`做除了更简洁之外的功能，还是我需要自己编写？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-29T12:57:33.760

你想要[`Data::Dump`](https://metacpan.org/module/Data::Dump#HISTORY)：

> **历史**
> 
> 该`Data::Dump`模块源于对 Sarathy 的 in-most-cases-excellent 的挫败感`Data::Dumper`。基本思想和一些代码与 Sarathy 的模块共享。该`Data::Dump`模块提供了比`Data::Dumper`.

[`Data::Printer`](https://metacpan.org/module/Data::Printer)是具有彩色输出的更现代的替代方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T12:59:23.263

你的意思是除了[Data::Dumper::Concise](http://p3rl.org/Data%3a%3aDumper%3a%3aConcise)吗？:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:40:05.257

If using [`$Data::Dumper::Indent`](http://p3rl.org/Data%3a%3aDumper#Configuration-Variables-or-Methods) is not enough, you may like to try JSON or YAML module families, if you only need data to be human-readable (i.e. for debugging). Their format is close enough to Perl's own to read easily and they have many formatting options.

# javascript - 取消按钮 AutoPostBack - OnClientClick 实现的细节

> ID：11261855
> 
> 赞同：0
> 
> 时间：2012-06-29T12:33:51.157
> 
> 标签：javascript, asp.net, submit

当使用标准的 asp:Button 组件时，必须使用以下技术来取消自动回发（或有条件地进行回发）：

*   通过 Button.OnClientClick 属性指定客户端操作；

*   实现一个返回布尔值的逻辑，该值指示是否应该执行回发。

以下不会取消回发（尽管“OnClientClickHandler”方法返回“false”）：

```
<asp:Button ID="btn" runat="server" OnClientClick="OnClientClickHandler();" />

function OnClientClickHandler() {
    return false;
} 
```

以下实现可以：

```
<asp:Button ID="btn" runat="server" OnClientClick="return OnClientClickHandler();" /> 
```

看起来这种行为是由 JavaScript 代码范围的细节引起的。无论如何，我对这个场景的低级实现细节很感兴趣。

为什么第一个实现（在“OnClientClickHandler”方法调用之前没有“return”运算符）不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:36:42.370

来自 MSDN

> 使用 OnClientClick 属性指定在引发 Button 控件的 Click 事件时执行的其他客户端脚本。除了控件的预定义客户端脚本之外，您为此属性指定的脚本还呈现在 Button 控件的 OnClick 属性中。

它还提到了这样[的 SubmitBehaviour](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.usesubmitbehavior)

> 使用 UseSubmitBehavior 属性来指定 Button 控件是使用客户端浏览器的提交机制还是 ASP.NET 回发机制。默认情况下，此属性的值为 true，导致 Button 控件使用浏览器的提交机制。如果指定 false，则 ASP.NET 页面框架将客户端脚本添加到页面以将表单发布到服务器。

```
<asp:Button ID="btn" runat="server" OnClientClick="return OnClientClickHandler();" UseSubmitBehavior="false" /> 
```

试试这样

```
function CancelPostBack()
{
  return false;
} 
```

c#代码。在 PageLoad 事件中。

```
btn.Attributes.Add("onclick","return CancelPostBack();"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:45:03.507

您需要添加的原因`return`是因为从事件处理程序返回 false 是取消默认行为的方式（在这种情况下，提交表单）。

另一种方法是执行`event.prefentDefault()`

`OnClientClick="OnClientClickHandler();"`相当于

```
function onclick(){
    OnClientClickHandler();
} 
```

而`OnClientClick="return OnClientClickHandler();"`将相当于

```
function onclick(){
    return OnClientClickHandler();
} 
```

你看得到差别吗？在第一种情况下，您只是在执行函数，但什么也不返回。

# performance - 创建不带PK的Oracle分区表

> ID：11261859
> 
> 赞同：0
> 
> 时间：2012-06-29T12:34:24.243
> 
> 标签：performance, oracle, partitioning

我们有一个巨大的表，现在有 1.44 亿行可用，并且每天增加 100 万行。

我想在 Oracle 11G 服务器上创建一个分区表，但我不知道这些技术。所以我有两个问题：

1.  是否可以从没有 PK 的表创建分区表？
2.  您对创建像大记录这样的分区表有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:56:22.920

1.  是的，但请记住，分区键必须是 PK 的一部分

2.  避免全局索引

3.  选择正确的分区键 - 为将来的某种维护做好准备（切断最旧或不必要的分区，将它们放在单独的表空间中......等）

有太多的事情要考虑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T13:51:51.050

> “表上有几个非唯一索引。但是，性能真的很糟糕！只是简单的计数功能在 5 分钟后返回结果。”

分区不一定是性能增强器。分区键将允许某些查询从分区修剪中受益，即那些在 WHERE 子句中驱动分区键的查询。如果 WHERE 子句违反分区键的粒度，其他查询可能会执行得更差，

很难给出具体的建议，因为你发布的细节太模糊了。但这里有一些其他可能的加快大表查询速度的方法：

*   索引压缩
*   并行查询
*   更好的，可能是复合的，索引。

# wordpress - WordPress菜单奇怪的问题

> ID：11261860
> 
> 赞同：0
> 
> 时间：2012-06-29T12:34:29.773
> 
> 标签：wordpress

在自定义 wordpress 菜单时，我遇到了严重的问题。

```
$setup = array( 'menu' => '', 'container' => 'div', 'container_class' => 'menu', 'container_id' => 'menu', 'menu_class' => 'menu', 'menu_id' => 'menu',
    'echo' => true, 'fallback_cb' => 'wp_page_menu', 'before' => '', 'after' => '', 'link_before' => '', 'link_after' => '', 'items_wrap' => '<ul id="%1$s">%3$s</ul>',
    'depth' => 0, 'walker' => '', 'theme_location' => '','theme_location' => 'primary' );

wp_nav_menu($setup); 
```

问题：您可以在我设置`menu_id`为“菜单”的代码中看到。或者`'menu_id' => 'menu'`

但它没有应用，只有 menu_class 应用了 id 不适用于菜单容器。但为什么？？？？请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:04:38.783

如果您尝试应用 css 样式，请检查任何样式属性前面是否有 !important 关键字。

# java - 声明主方法同步

> ID：11261865
> 
> 赞同：4
> 
> 时间：2012-06-29T12:34:49.953
> 
> 标签：java, multithreading, concurrency

我看到一个 Java 示例，它有一个标记为同步的主方法，调用另一个静态同步方法。效果是，基本上，只有在 main 方法返回后，另一个方法才在单独的线程上运行。

这样的结构有什么实用功能？

```
public class SynchronisedMain {

    public static synchronized void main(String[] args) throws InterruptedException {
        new Thread(new Runnable() {
            @Override
            public void run() {
                thingy();               
            }
        }).start();
        System.out.println("Kickstarted thingy thread.");
        TimeUnit.MILLISECONDS.sleep(1000);
    }

    public static synchronized void thingy() {
        System.out.println("Thingy!");
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T12:38:32.310

它可能作为临时的“应用程序关闭处理程序”很有用，在应用程序完全完成之前执行一些清理任务。不过也挺做作的...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T12:42:17.830

没有什么说 main 函数只能用作程序的入口点。由于是静态的，其他类没有理由不能调用`SynchronisizedMain.main()`. 同步可防止多个实例同时执行，这可能是可取的。

# java - 同步块问题？

> ID：11261873
> 
> 赞同：0
> 
> 时间：2012-06-29T12:35:11.847
> 
> 标签：java, multithreading, synchronization

嗨，我有一个具有多种方法的类，其中我需要在所有方法中使用同步块，如下所示：

```
public class Test2 {
    private Object mutex=new Object();
    private OtherClass obj=new OtherClass();

    public void method1(){
        //do some stuff
        synchronized (mutex) {
            obj.//some method
            //do some stuff
        }
        //do other stuff
    }

    public void method2(){
        //do some stuff
        synchronized (mutex) {
            obj.//some method
            //do some stuff
        }
        //do other stuff
    }

    public void method3(){
        //do some stuff
        synchronized (mutex) {
            obj.//some method
            //do some stuff
        }
        //do other stuff
    }

    public void method4(){
        //do some stuff
        synchronized (mutex) {

            obj.//some method
            //do some stuff
        }
        //do other stuff
    }
} 
```

我正在使用互斥锁来同步块，所以如果`method1`正在使用会发生什么，另一个`method2`同步块等待直到流从`method1`.

我不希望这种情况发生，那我该怎么办？我知道因为我对所有方法都使用互斥锁，所以它会锁定`method2`同步块。我想知道我应该怎么做才能删除它？我应该为每个要使用的方法创建成员变量，还是有另一种解决方法？

**我希望另一个线程只有在调用相同的方法时才等待。就像两个线程类 mehod1 一样，所以第二个线程应该等待。但如果第二个线程调用 method2 它不应该等待。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:42:36.413

您应该在 method2 方法中使用另一个 mutext。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T12:42:49.623

从您的评论来看，我假设您想要按方法同步而不是按对象同步。在这种情况下，最简单的方法是为每个方法声明一个单独的监视器对象，即`mutex1`,`mutex2`等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T12:48:56.037

`mutex`如果要实现此目的并与它们同步，则必须为每个方法调用使用不同的监视器对象（在您的代码中）。如果你有很多方法，你可以使用某种集合来保存你的互斥对象：

```
public class Test2 {
    private Object[] mutexes=new Object[2];
    private OtherClass obj=new OtherClass();

    private synchronized Object getMutex(int i) {
        if(mutexes[i] == null) {
            mutexes[i] = new Object();
        }
        return mutexes[i];
    }

    public void method1(){
        //do some stuff
        synchronized (getMutex(1)) {
           //do some stuff
        }
        //do other stuff
    }

    public void method2(){
        //do some stuff
        synchronized (getMutex(2)) {
            //do some stuff
        }
        //do other stuff
    }
} 
```

请注意，如果您基于每个方法进行同步，但每个方法都`obj`从块访问相同的对象（在您的情况下）`synchronized`，那么对该特定对象的访问仍然不是线程安全的。

另一种选择是在构造函数中初始化所有互斥锁，而不是在方法中按需创建它们`getMutex()`：

```
public Test() {
    for(int i = 0; i < mutexes.length()) {
        mutexes[i] = new Object();
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-29T12:43:12.960

只需为每种方法使用不同的监视器。

```
public class Test2 {
    private Object mutex1 = new Object(), mutex2 = new Object();
    private OtherClass obj=new OtherClass();

    public void method1() {
        //do some stuff
        synchronized (mutex1) {
            obj.//some method
            //do some stuff
        }
        //do other stuff
    }

    public void method2() {
        //do some stuff
        synchronized (mutex2) {
            obj.//some method
            //do some stuff
        }
        //do other stuff
    }
} 
```

如果你有很多方法，你也可以将它们打包成一个数组。

# css - 转义 progid 中的特殊字符：DXImageTransform.Microsoft.AlphaImageLoader

> ID：11261878
> 
> 赞同：1
> 
> 时间：2012-06-29T12:35:19.833
> 
> 标签：css, internet-explorer

我在过滤器中发现了非常奇怪的动作：progid:DXImageTransform.Microsoft.AlphaImageLoader

```
<style>
 .some{ width: 16px; height: 16px;
   filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src="C:/Users/usr7/Desktop/(x86)/close.png", sizingMethod='scale');
 }
</style>

<div class='some'>
 hello
</div> 
```

如果 AlphaImageLoader' src 的大括号字符是 ( ) ，它在 ie8 和 ie9 上不起作用。有什么方法可以转义大括号字符吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T18:17:38.710

您应该能够对 CSS 字符串标记内的特殊字符使用转义，即将括号符号替换为`\29`和`\28`（相应地表示左括号和右括号）。

### 具体例子

```
src="C:/Users/usr7/Desktop/\29x86\28/close.png" 
```

### 参考

*   [CSS 标记化](http://www.w3.org/TR/CSS21/syndata.html#tokenization)
*   [CSS中的转义字符](http://www.w3.org/TR/CSS21/syndata.html#escaped-characters)

# iphone - 通用 Ad-Hoc 版本确实安装在 ipad 上，但不安装在 iphone 上

> ID：11261880
> 
> 赞同：0
> 
> 时间：2012-06-29T12:35:35.403
> 
> 标签：iphone, objective-c, ios, ipad, adhoc

当我为我们的客户构建我的最后一个临时版本时，我遇到了一个奇怪的问题。该应用程序是一个通用应用程序。部署目标是 ios 4.3。ad-hoc 可以完美地安装在客户的 ipad 上，但不能安装在他的 iphone 上。我用我们的iphone测试了它，我们遇到了同样的问题。

临时安装在 ipad 上，但不在 iphone 上。

*   所有设备都列在配置文件中。
*   配置文件有效，证书也有效。
*   权利被停用。

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:38:22.560

您是否尝试再次在手机上重新安装配置文件？在我的 ad-hoc 发行版中，几乎发现配置文件有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T14:06:50.787

尝试从管理器中删除配置文件，从门户再次下载并安装它。

# php - 如何获取 WordPress 帖子特色图片 URL

> ID：11261883
> 
> 赞同：160
> 
> 时间：2012-06-29T12:35:40.377
> 
> 标签：php, wordpress, post

我正在使用此功能来获取特色图片：

```
<a href="#" rel="prettyPhoto">
    <?php the_post_thumbnail('thumbnail'); ?>
</a> 
```

现在我想通过点击我需要一个特色图片 URL 的锚标签来获取完整的特色图片

```
<a href="here" rel="prettyPhoto"> 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：346
> 
> 时间：2012-06-29T12:39:30.437

检查下面的代码，让我知道它是否适合您。

```
<?php if (has_post_thumbnail( $post->ID ) ): ?>
  <?php $image = wp_get_attachment_image_src( get_post_thumbnail_id( $post->ID ), 'single-post-thumbnail' ); ?>
  <div id="custom-bg" style="background-image: url('<?php echo $image[0]; ?>')">

  </div>
<?php endif; ?> 
```

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2012-06-29T17:39:01.570

如果您只想要源，而不是包含其他信息的数组：

```
<?php $url = wp_get_attachment_url( get_post_thumbnail_id($post->ID), 'thumbnail' ); ?>
<img src="<?php echo $url ?>" /> 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-07-22T10:51:50.093

```
// Try it inside loop.  
<?php
$feat_image = wp_get_attachment_url( get_post_thumbnail_id($post->ID) );
echo $feat_image;
?> 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2014-05-07T17:18:23.213

简单的方法！

```
 <?php 
     wp_get_attachment_url(get_post_thumbnail_id(get_the_ID()))
 ?> 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2016-03-04T03:27:15.383

这对我来说非常有用：

```
<?php echo get_the_post_thumbnail_url($post_id, 'thumbnail'); ?> 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-09-19T15:53:52.787

我认为这是最简单的解决方案和更新的解决方案：

```
<?php the_post_thumbnail('single-post-thumbnail'); ?> 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-03-04T05:11:49.953

这是最简单的答案：

```
<?php
    $img = get_the_post_thumbnail_url($postID, 'post-thumbnail');
?> 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-03-31T13:53:50.850

你可以试试这个：

```
<?php 
    $feat_image = wp_get_attachment_url(get_post_thumbnail_id($post->ID)); 
    echo $feat_image; 
?> 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-02-05T13:53:43.423

试试这个

```
<?php 
    echo get_the_post_thumbnail($post_id, 'thumbnail', array('class' => 'alignleft')); 
?> 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2020-02-06T19:55:52.410

我搜索了很多，一无所获，直到我得到这个：

`<?php echo get_the_post_thumbnail_url( null, 'full' ); ?>`

它只是为您提供不带整个`<img>`标签的完整图像 URL。

希望能帮到你。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-05-13T15:10:29.160

您还可以按如下方式获取图像附件的 URL。它工作正常。

```
if (has_post_thumbnail()) {
    $image = wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), 'medium'); 
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-03-24T14:06:49.793

您也可以像这样从 post_meta 获取它：

```
echo get_post_meta($post->ID, 'featured_image', true); 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-01-20T16:13:16.893

你可以试试这个。

```
<?php
   $image_url = wp_get_attachment_url( get_post_thumbnail_id($post->ID) );
?>
<a href="<?php echo $image_url; ?>" rel="prettyPhoto"> 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-12-06T06:34:37.727

你会试试这个

```
<?php $url = wp_get_attachment_url(get_post_thumbnail_id($post->ID), 'full'); ?> // Here you can manage your image size like medium, thumbnail, or custom size
    <img src="<?php echo $url ?>" 
/> 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-03-21T06:46:41.420

```
<?php
    if (has_post_thumbnail( $post->ID ) ):
        $image = wp_get_attachment_image_src( get_post_thumbnail_id( $post->ID ), 'single-post-thumbnail' );
?>
        <img src="<?php echo $image[0]; ?>">  
<?php endif; ?> 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-10-29T23:59:22.173

如果帖子是一张图片，并且我们已经知道图片是什么，则可以轻松获取缩略图 URL：

```
echo pathinfo($image->guid, PATHINFO_DIRNAME); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-05-08T09:35:15.857

You can also get the URL for image attachments as follows:

```
<?php
    "<div><a href=".get_permalink(id).">".wp_get_attachment_url(304, array(50,50), 1)."</a></div>";
?> 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-11-16T11:49:25.330

`wp_get_attachment_url`您可以通过函数获取特定大小的图像 src 。

```
<?php 
    $url = wp_get_attachment_url( get_post_thumbnail_id($post->ID), 'full' ); 
?>
<img src="<?php echo $url ?>" /> 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-01-04T12:18:47.677

利用：

```
<?php 
    $image_src = wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), 'thumbnail_size');

    $feature_image_url = $image_src[0]; 
?> 
```

您可以根据需要的大小更改`thumbnail_size`值。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-02-23T08:44:28.143

如果您想从帖子缩略图中获取完整的图像大小，您可以使用此代码。

```
$img_url = wp_get_attachment_image_url(get_post_thumbnail_id(get_the_ID()), 'full');
<img src="<?PHP echo $img_url?> "> 
```

在这里， get_the_ID() 是帖子 ID。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-02-24T10:00:33.600

只需在循环内编写`<?php the_post_thumbnail_url(); ?>`如下所示：-

```
$args=array('post_type' => 'your_custom_post_type_slug','order' => 'DESC','posts_per_page'=> -1) ;
$the_qyery= new WP_Query($args);

if ($the_qyery->have_posts()) :
    while ( $the_qyery->have_posts() ) : $the_qyery->the_post();?>

<div class="col col_4_of_12">
    <div class="article_standard_view">
        <article class="item">
            <div class="item_header">
                <a href="<?php the_permalink(); ?>"><img src="<?php the_post_thumbnail_url(); ?>" alt="Post"></a>
            </div>

        </article>
    </div>
</div>            
<?php endwhile; endif; ?> 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2017-03-05T13:17:58.753

```
<img src="<?php echo get_post_meta($post->ID, "mabp_thumbnail_url", true); ?>" alt="<?php the_title(); ?>" width ="100%" height ="" /> 
```

# php - 查看 MySQL 数据库前端中的条目的权限

> ID：11261885
> 
> 赞同：0
> 
> 时间：2012-06-29T12:35:49.720
> 
> 标签：php, mysql, permissions

我有一个用于 MySQL 数据库的 PHP/HTML/Javascript 驱动的前端，它为我们的办公室存档不同的文件/论文（一种用于物理文书工作的电子索引）。

用户希望能够对这些条目中的每一个拥有权限；例如，人力资源投诉需要被索引，但不应被数据库的所有用户查看。

用户层次结构是两层的。每个用户都是一个或多个分发列表（类似于电子邮件列表）的成员。当一个文件被索引时，用户选择其他人的权限：例如，他/她可以为示例 HR 投诉选择以下内容：

```
List           |      Permission
`````````````````````````````````
HR Dept        |      Read/Write

Board Members  |      Read

John Smith     |      Read/Write
Mary Smith     |      Read 
```

并且应该对其他人不可见。现在我尝试了几件事来实现这一点，最近的是一个关系表，它涉及以下内容：

```
User 1->Many DistributionList // Assoc the user to some lists
Permission 1->Many DistributionList  //Indicates level of permission that the list has
Permission 1->Many User //Indicates level of permission for each user 
```

然而，权限表包含每个文件的每个权限的一行，给定几千个文件和约 50-60 个列表/用户，这意味着几十万个条目。由于该索引不会经常刷新（可能刷新超过 50 年的文件），因此该数字可能会飙升。更不用说查询有些复杂，并且只需要几百个文件就需要相当长的时间（SQL 请求约 1 秒）。

有没有更有效的方法来创建这种基于用户的东西？是否可以让 SQL 本身的用户拥有这些权限并让连接处理这些事情？

**tl;dr：使用 PHP、Javascript、HTML 和 PHPMyAdmin 对 MySQL 中的条目设置读/写/不可见权限的最佳方法是什么？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:51:10.683

如果组不多（最多 64 个），您可以为每个文件使用一组权限（1 个额外的列）。 [http://dev.mysql.com/doc/refman/5.0/en/set.html](http://dev.mysql.com/doc/refman/5.0/en/set.html)

因此，每个文件都可以有一列表示它属于哪些组，可以随着系统的增长而扩展。

如果你想超过 64，你也可以添加第二列，但这需要更复杂的查询（保持部门分开会有所帮助，HRgroups，Boardgroups 等）

您还可以为特定用户添加例外或创建另一个组。但是正如您所说，每个文件/用户有一个关联条目是您将获得的最好的。

# java - OnClickListener 看不到最终变量的范围

> ID：11261888
> 
> 赞同：0
> 
> 时间：2012-06-29T12:35:51.903
> 
> 标签：java

我是初学者，我正在尝试构建一个计算器。我有个问题。

我这样写答案：

```
ans += Double.parseDouble(etResult.getText().toString());
outTest.setText("The answer is " + ans); 
```

这是在 OnClickListenter 中。问题是我必须与我在项目开始时定义的双重 ans 沟通，如果我想与双重沟通，我需要他是最终的，但如果他是最终的，我不能在 OnClickListener 中改变他.

谁能帮助我并告诉我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T12:43:25.163

使用通常的技巧：而不是`double ans = 0`声明`final double[] ans = {0}`，然后您将能够`ans[0] += ...`在处理程序代码中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T07:12:27.223

您可以按如下方式编写代码

```
public class TestActivity extends Activity {
/** Called when the activity is first created. */
Double dbl;
Button btn;
EditText et;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    btn = (Button) findViewById(R.id.button1);
    et = (EditText) findViewById(R.id.editText1);
    btn.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            dbl = Double.parseDouble(et.getText().toString());
            Log.e("double", "" + dbl);
        }
    });
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T07:17:00.157

试试看

```
public class TestActivity extends Activity {
/** Called when the activity is first created. */
Double dbl;
Button btn;
EditText et1, et2;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    btn = (Button) findViewById(R.id.button1);
    et1 = (EditText) findViewById(R.id.editText1);
    et2 = (EditText) findViewById(R.id.editText2);
    btn.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            dbl = Double.parseDouble(et1.getText().toString());
            et2.setText(dbl.toString());
        }
    });
}
} 
```

# java - 如果我的表是多对多关系，我可以在单个表中添加所有索引吗？

> ID：11261889
> 
> 赞同：0
> 
> 时间：2012-06-29T12:35:58.830
> 
> 标签：java, mysql, database, jakarta-ee, mysqldump

示例：-我有 3 个表产品、分支和员工。它们是多对多关系。所以我可以将新表中的所有主键添加为外键以进行引用吗？而不是创建 3 个不同的表。意味着组合product_branch、product_employee 和 branch_employee。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:38:19.490

这种关系可能有意义——也可能没有。

例如，这可能并不能避免仅在员工和分支机构之间建立其他规范化关系的需要。

# javascript - 如何在其他 div 点击时设置/更改输入值？

> ID：11261890
> 
> 赞同：0
> 
> 时间：2012-06-29T12:36:00.237
> 
> 标签：javascript, jquery

如何在其他 div 点击时设置/更改输入值？输入类型被隐藏。有可能的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T12:36:57.663

```
$('#your_div').on('click', function() {
  $('#hidden_input').val('some_val');
}); 
```

这里`your_div`指向`id`你的`div`，`hidden_input`是`id`隐藏域的。您可以为它们使用任何有效的**[jQuery 选择器](http://api.jquery.com/category/selectors)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:39:16.010

```
$("#target").click(function() {
  $('#hiddedID').val('Some Value');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:40:02.517

```
$('#div_to_click').click(function(){
  $('#hidden_input').val('input_value');
}); 
```

希望能帮助到你 ：-）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T12:40:53.840

**工作演示** [http://jsfiddle.net/aqrvA/5/](http://jsfiddle.net/aqrvA/5/) **或** [http://jsfiddle.net/aqrvA/1/](http://jsfiddle.net/aqrvA/1/)

接口：[http ://api.jquery.com/val/](http://api.jquery.com/val/)

希望这可以帮助

**代码**

```
$("#iron").click(function() {
    alert("Before Change ==> " + $("#hulk").val());
    $("#hulk").val("IRONMAN");

    alert("After Change ==> " + $("#hulk").val());
});​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T12:41:58.113

没问题：

```
$(document).ready(function() {
    $('#div').click( function() {
        $('#input').val('value');
    });
}); 
```

请记住，您可以处理`hidden`或`display: none`像它们一样可见的元素。

# ruby-on-rails - 自动完成字段中的 ActionController::RoutingError 未初始化常量（rails）

> ID：11261891
> 
> 赞同：0
> 
> 时间：2012-06-29T12:36:02.340
> 
> 标签：ruby-on-rails, autocomplete, routing

这是我的路线：

```
match '/goods_ins/autocomplete/autocomplete_supplier_suppliername', :controller => 'goods_ins'

match '/goods_ins/autocomplete/autocomplete_partcode_partcode', :controller => 'goods_ins'

get 'autocomplete_partcode_partcode', :controller => 'goods_ins'

get 'autocomplete_supplier_suppliername', :controller => 'goods_ins' 
```

这是我的自动完成字段：

```
<div class="field">
<%= f.label "Supplier Name" %><br />
<%=f.autocomplete_field :suppliername, :autocomplete => autocomplete_supplier_suppliername_path %>
</div> 
```

当我在该字段中输入内容时，我在终端中收到此错误：

ActionController::RoutingError（未初始化的常量 GoodsIns）：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:25:59.187

你有 GoodsIns 控制器和模型吗？该路线正在寻找 GoodsIn 模型的控制器。该错误似乎表明这是未定义的？

如果您可以提供有关您正在尝试做的事情的更多信息，那就太好了！

# ruby-on-rails - 解析 xlsx 和 xls Excel 文件的单个 Ruby Gem？

> ID：11261895
> 
> 赞同：2
> 
> 时间：2012-06-29T12:36:07.520
> 
> 标签：ruby-on-rails, xls, xlsx

我对那里的宝石有点沮丧。似乎每个人都做好一件事，但没有做好其他事情。

roo 解析 xlsx 和 xls 但它似乎无法正确读取某些字段，并且在我需要的每种情况下都无法正常工作。

电子表格 gem 不解析 xlsx

rubyXL 不解析 xls 文件

还有其他建议吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T13:14:49.653

如果您对两者提供的单独结果感到满意，我会将 ruby​​XL gem 和电子表格 gem 结合起来。

# asp.net-mvc - 不满足路由时抛出 404 错误

> ID：11261900
> 
> 赞同：1
> 
> 时间：2012-06-29T12:36:29.127
> 
> 标签：asp.net-mvc, asp.net-mvc-3

使用默认路由

```
 routes.MapRoute(
      "Admin",                                              // Route name
      "Admin/{action}",                           // URL with parameters
      new { controller = "Admin", action = "Index" }  // Parameter defaults
  ); 
```

我们的应用程序的许多路由（大约 90%）都在工作，所以这很好。

现在当用户进入时`/logon/strangeroute`，MVC offcourse 会抛出一个错误，因为`strangeroute`我的`logoncontroller`.

使用中的捕获所有异常处理程序`global.asax.cs`，我无法找到路由错误（我称之为路由错误）和另一个错误（在代码的其余部分中抛出）之间的区别。

我想区分 betweek 错误的类型，因为当路由出现错误时，它大部分时间是 404 错误，我想将用户重定向到 404 页面而不是正常的、通用的错误页面。

一种方法是为所有页面创建所有路由并关闭现有的默认路由并实现一个包罗万象的路由，但我不希望为每个 url 创建单独的路由。

还有另一种方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:39:13.873

测试您捕获的[异常是否是](http://msdn.microsoft.com/en-us/library/system.exception.aspx)[HttpException](http://msdn.microsoft.com/en-us/library/system.web.httpexception.aspx)，如果是，则对其使用[GetHttpCode](http://msdn.microsoft.com/en-us/library/system.web.httpexception.gethttpcode.aspx)方法查看是否为 404。

# android - TextView Ellipsize (...) 不工作

> ID：11261904
> 
> 赞同：34
> 
> 时间：2012-06-29T12:36:39.397
> 
> 标签：android, android-layout, android-linearlayout, textview

当`TextView`文本长于`TextView`. 我不知道为什么——但我不明白。

我已经围绕着类似的 StackOverflow 问题展开了思考，但我最终没有解决方案。也许有人有一些有用的提示。

```
<LinearLayout 
    android:layout_height="wrap_content" 
    android:layout_width="fill_parent"
    android:orientation="vertical">

    <TextView 
        android:textStyle="bold" 
        android:text="Full Name" 
        android:layout_height="wrap_content" 
        android:textSize="16sp"
        android:layout_width="wrap_content" 
        android:id="@+id/lName"
        android:layout_gravity="center_vertical" 
        android:maxLines="1"
        android:ellipsize="end"/>
</LinearLayout> 
```

`LinearLayout`上面嵌套在 2 个 other中`LinearLayouts`。也许知道这一点很重要。我也已经尝试过属性“ `singleLine`”，但有人说它已被弃用，无论如何它都不起作用。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-06-29T12:43:50.863

在样式文件中添加以下样式（通常为`styles.xml`）：

```
<style name="autoscroll">
    <item name="android:singleLine">true</item>
    <item name="android:ellipsize">marquee</item>
    <item name="android:marqueeRepeatLimit">marquee_forever</item>
    <item name="android:focusable">true</item>
    <item name="android:focusableInTouchMode">true</item>
    <item name="android:scrollHorizontally">true</item>
</style> 
```

然后将样式添加`@style/autoscroll`到您的`TextView`：

```
<TextView android:id="@+id/lName"
      style="@style/autoscroll" /> 
```

当您需要这种方式时，您可以轻松地重用您的自动滚动功能。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-06-29T13:02:01.083

在你的 xml 中为 TextView 添加这个：

```
 android:maxWidth="200dp" 
        android:maxLines="1" 
```

作为

```
 android:singleLine="true" 
```

已弃用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-29T13:10:37.860

```
android:id="@+id/lName" android:layout_width="150dp"
    android:layout_height="wrap_content"
    android:ellipsize="end"
    android:singleLine="true"
    android:text="Avinljhakjhsajkhakjshda"
    android:textSize="16sp" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-01-05T01:16:52.987

当我的文本是可选择的时，省略号没有出现。我需要禁用可选文本（这是默认设置）：

```
android:layout_width="0dp" (match constraint)
android:layout_height="wrap_content"
android:ellipsize="end"
android:maxLines="1"
android:textIsSelectable="false" 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-08-04T23:22:36.130

[`'android:ems'`](https://stackoverflow.com/questions/10275348/what-is-androidems-attribute-in-edit-text)除非将属性与属性一起`android:ellipsize`添加，否则这对我不起作用

```
android:ellipsize="end"
android:singleLine="true"
android:ems="8" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-25T14:14:58.503

它适用，`singleLine="true"`但现在不推荐使用此属性，请改用**ellipsize**`scrollHorizontally="true"`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-21T11:13:36.613

使用此代码它肯定会工作。

```
<TextView
    android:id="@+id/sAddress"
    android:layout_width="200dp"
    android:layout_height="wrap_content"
    android:maxLines="1"
    android:ellipsize="end"
    android:text="Adress"
    android:textSize="14sp"/> 
```

# php - 正则表达式匹配变量

> ID：11261908
> 
> 赞同：0
> 
> 时间：2012-06-29T12:36:59.500
> 
> 标签：php, regex

我真的一点也不卡在这里，因为我不擅长正则表达式，..我认为它真的很棘手，所以我正在寻求帮助:)

我的问题

```
foo = "bar"
$bar = foo
foo()
$foo = bar;
bar = foo() {}
$foo = array(); 
```

应该匹配：

```
foo = "bar" -> match foo not bar
$bar = foo -> match foo not bar
foo() -> no match
$foo = bar; -> match bar not foo
bar = foo() {} -> match bar not foo
$foo = array(); -> no match 
```

它应该匹配所有没有引号且不以 $ 开头或以 ( 结尾的单词 A-Za-z0-9_

非常感谢您的每一个帮助！

**编辑：**

一个小例子来更好地解释我试图实现的目标：

```
<?php
/**
 * little script to explain better what im trying to achieve
 */
echo "\nSay Hi :P\n=========\n\n";

$reply = null;

while ("exit" != $reply) {

  // command
  echo "> ";

  // get input
  $reply = trim( fgets(STDIN) );

  // last char
  $last = substr( $reply, -1 );

  // add semicolon if missing
  if ( $last != ";" && $last != "}" ) {
    $reply .= ";";
  }

  /*
   * awesome regex that should add $ chars to words
   * to make using this more comfortable!
   */

  // output buffer
  ob_start();
  eval( $reply );
  echo $out = ob_get_clean();

  // add break
  if ( strlen( $out ) > 0 ) {
    echo "\n";
  }
}

echo "\n\nBye Bye! :D\n\n";
?> 
```

问候马里奥

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T12:57:32.730

此表达式实际上与您的示例匹配。[见这里](http://refiddle.com/2gx)。

```
/(?<![$'"])\b([a-z_]+)\b(?!['"(])/i 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T13:03:44.257

您将很难尝试使用正则表达式解析编程语言。当您开始获得更复杂的表达式时，正则表达式将变得不够用。

尽管如此，这是一个匹配您所有示例的正则表达式：

```
(?<![^\s])\w+(?![^;\s]) 
```

您可以扩展它以满足您的需求。

# php - 通过批处理 api 将窗口 csv 关联到 drupal 节点

> ID：11261909
> 
> 赞同：2
> 
> 时间：2012-06-29T12:37:00.907
> 
> 标签：php, drupal, csv, drupal-batch

我有一个附属窗口 CSV，它有近 1 个 lac 行，我想将它保存为节点，我尝试使用批处理 API。

但我仍然收到php超时错误..请帮助

```
function MODULE_aw_batch(){  
  $operations = array();
  $csv = file_directory_path().'/aw/datafeed_134642.csv';
  $file = fopen($csv, 'r');
  while (($data = fgetcsv($file)) !== FALSE) {
      $operations[] = array('MODULE_aw_op', array($data));
  }
  $batch = array(
    'title' => t('Generating feeds'), // Title to display while running.
    'operations' => $operations,
    'finished' => 'MODULE_aw_finished', // Last function to call.
    'init_message' => t('Importing...it may take 4-5 hours'),
    'progress_message' => t('Processed @current out of @total.'),
    'error_message' => t('Import feeds has encountered an error.'),
  );
  batch_set($batch);
  batch_process('admin/content/node/overview');
} 
```

# 更新（已解决）

而不是一次读取整个 csv 文件，而是将 csv 拆分为每个进程读取 5 行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T11:05:32.650

找到了解决方案

**批量申报**

```
function MODULENAME_batch(){
    $operations[] = array('MODULENAME_op', array()); 
    $batch = array(
        'title' => t('Importing events'),
        'operations' => $operations,
        'finished' => 'MODULENAME_finished',
        'init_message' => t('MESSAGE HERE'),
        'progress_message' => 'MESSAGE HERE',
        'error_message' => t('MESSAGE HERE'),
    );
    batch_set($batch);
    batch_process('admin/content/node/overview');// redirect to this page
}

function MODULENAME_aw_op(&$context) {      
    if (!isset($context['sandbox']['offset'])) {
        $context['sandbox']['offset'] = 0;
        $context['sandbox']['records'] = 0;
    }

    $filename =file_directory_path().'/aw/datafeed_134642.csv'; // csv file

    $fp = fopen($filename, 'r');

    if ( $fp === FALSE ) {
    // Failed to open file
        watchdog('MODULENAME', 'Failed to open ' . $filename);
        $context['finished'] = TRUE;
        return;
    }

    $ret = fseek($fp, $context['sandbox']['offset']);

    if ( $ret != 0 ) {
    // Failed to seek
        watchdog('MODULENAME', 'Failed to seek to ' . $context['sandbox']['offset']);
        $context['finished'] = TRUE;
        return;
    }

    $limit = 5;  // Maximum number of rows to process at a time
    $done = FALSE;

    for ( $i = 0; $i < $limit; $i++ ) {
        $line = fgetcsv($fp);
        if ( $line === FALSE ) {
            $done = TRUE;
            // No more records to process
            break;
        }
        else {          
            $context['sandbox']['records']++;
            $context['sandbox']['offset'] = ftell($fp);
            $record = $context['sandbox']['records'];
            // Do something with the data

        }
    }

    $eof = feof($fp);

    if ( $eof )  {
        $context['success'] = TRUE;
    }
    $context['message'] = "processed " . $context['sandbox']['records'] . " records";

    $context['finished'] = ( $eof || $done ) ? 1 : 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T14:05:35.503

您是否尝试过 Drupal 提要模块？它非常适合 CSV 导入。 [http://drupal.org/project/feeds/](http://drupal.org/project/feeds/)

# spring - 如何绕过 Grails 异常处理以使用 Spring Oauth2？

> ID：11261914
> 
> 赞同：3
> 
> 时间：2012-06-29T12:37:17.473
> 
> 标签：spring, grails, spring-security, oauth-2.0

我正在尝试将基于 Oauth for Spring Security 的 Oauth2 客户端从普通 Java/Spring 移植到 Grails，但遇到了问题。问题的症结似乎在于 Spring Oauth 客户端实现的设计依赖于这样一个假设，即从 Oauth2RestTemplate 抛出的异常将被 OAuth2ClientContextFilter 的 catch 块捕获，从而允许过滤器发出重定向响应（向宣誓提供者发送授权请求）。

这在普通的 Java/Spring 中运行良好，但在 Grails 中，GrailsDispatcherServlet 被配置为通过 HandlerExceptionResolvers 处理所有异常。因此，在 Oauth2RestTemplate 中抛出的异常（在 Grails 控制器中调用）被 GrailsExceptionResolver 捕获，并且不会被 OAuth2ClientContextFilter 看到，从而破坏了所需的重定向行为。

我发现的所有关于定制 Grails 异常处理的讨论似乎都假设定制的目的是将异常映射到 HTTP 错误代码或错误页面视图。但是有什么方法可以告诉 Grails 简单地允许一个特定的异常通过未处理的流，以便它可以被 servlet 过滤器捕获？或者是否可以插入一个重新抛出异常而不是返回 ModelAndView 的自定义 HandlerExceptionResolver（正如对 HandlerExceptionResolver 的标准期望）？还是有其他更好的方法可以让 Oauth for Spring Security 客户端在 Grails 中工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-11T14:04:05.060

我认为您可以通过定义自定义异常解析器来声明`exceptionHandler`。`resources.groovy`这个自定义异常解析器可以（可选地）覆盖 GrailsExceptionResolver

```
exceptionHandler(MyExceptionResolver) {
    exceptionMappings = ['java.lang.Exception': '/error']
}

class MyExceptionResolver extends GrailsExceptionResolver {
     @Override
     ModelAndView resolveException(HttpServletRequest request, HttpServletResponse response, 
      Object    handler, Exception ex) {
     //your custom code
     return super.resolveException(request, response, handler, ex)
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T15:32:58.273

这就是我最终想出的。不确定这是否是最好的解决方案，但它似乎有效：

1.  创建一个新的 MyDispatcherServlet.groovy：

    ```
    package org.example.com

    import org.codehaus.groovy.grails.web.servlet.GrailsDispatcherServlet
    import javax.servlet.http.HttpServletRequest
    import javax.servlet.http.HttpServletResponse
    import org.springframework.web.servlet.ModelAndView
    import org.springframework.security.oauth2.client.UserRedirectRequiredException

    class MyDispatcherServlet extends GrailsDispatcherServlet {

        @Override
        protected ModelAndView processHandlerException(HttpServletRequest request, 
          HttpServletResponse response, Object handler, Exception ex) throws Exception {
            def e = ex
            while (e) {
                if (e instanceof UserRedirectRequiredException) {
                    throw ex
                }
                e = e.cause
             }
             return super.processHandlerException(request, response, handler, ex)                                     
         }
    } 
    ```

2.  运行*grails install-templates*并修改 web.xml 以使用 MyDispatcherServlet 而不是默认的 GrailsDispatcherServlet

结果是 MyDispatcherServlet 将重新抛出一个包含 UserRedirectRequiredException 的异常，以便它可以被 OAuth2ClientContextFilter 捕获，但其他异常将像以前一样由 GrailsExceptionResolver 传递和处理。

# javascript - 是否有适用于 iOS 和 Android 浏览器的性能指南？

> ID：11261917
> 
> 赞同：1
> 
> 时间：2012-06-29T12:37:25.153
> 
> 标签：javascript, android, html, ios, css

作为一名网络开发人员，我还必须考虑 Android 和 iOS 网络浏览器。这些浏览器的渲染引擎以及功能和内存的不足带来了很多复杂性。

所以我想知道，是否有针对这些浏览器的性能调整（HTML/CSS/Javascript）的综合指南？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:20:01.737

我还没有找到专注于移动开发的实际指南。然而，我的编码实践是做你为桌面浏览器做的所有事情，并尝试在以下方面付出额外的努力：

*   通过使用 CDN、ETag、适当的到期日期等，最大限度地利用缓存。
*   尽量减少回流/重绘，它们是 CPU 密集型的
*   积极优化图像以最小化下载大小。
*   最小化服务器往返次数并包括 JS/CSS，因为大多数手机都用于 3G/4G 和其他无线网络。它们往往比有线宽带（cable/dsl）具有更高的延迟。
*   不要使用动画 gif、3d 变换等。

这是一些阅读材料：[https ://developers.google.com/speed/docs/best-practices/rules_intro](https://developers.google.com/speed/docs/best-practices/rules_intro)

# javascript - 使用 .net 使用 jquery ajax 从客户端上传文件

> ID：11261918
> 
> 赞同：1
> 
> 时间：2012-06-29T12:37:36.837
> 
> 标签：javascript, .net, ajax, jquery, asp.net-ajax

我需要使用 jquery ajax 函数将文件从客户端上传到不同的服务器位置，而不是将其发送到我的应用程序 Web 服务器，这是为了避免匿名/病毒上传到应用程序 Web 服务器。

我搜索了很多站点，但所有示例都是在 php 中完成的，而不是在 .net 2.0 中。

非常感谢你们中的任何人能给我一个领导或解决方案。

非常感谢阿难

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T15:39:03.910

可以针对网络服务进行此上传。使用 WCF 并将文件流式传输到服务器的示例。 [http://msdn.microsoft.com/en-us/library/ms789010.aspx](http://msdn.microsoft.com/en-us/library/ms789010.aspx)

也可以使用带有附件的 SOAP 消息：http: [//www.w3.org/TR/SOAP-attachments](http://www.w3.org/TR/SOAP-attachments)

# java - 所有对最短路径 Udaya Kumar Redd 算法

> ID：11261919
> 
> 赞同：1
> 
> 时间：2012-06-29T12:37:37.447
> 
> 标签：java, algorithm, graph, shortest-path

使用以下论文第 4 页上的算法，我正在尝试计算所有对的最短路径矩阵。

[http://www.waset.org/journals/ijcms/v3/v3-5-43.pdf](http://www.waset.org/journals/ijcms/v3/v3-5-43.pdf)

我对（算法的）第 7 行和第 8 行以及随后的第 11 和 12 行感到困惑，因为将 s1 分配给 j 的值并使用这两者，第 8 行的比较对我来说似乎模棱两可。我想知道我是否读错了缩进。我是算法新手，所以请耐心等待。

```
 while(flag != false){
        for(int i=0; i<n;i++){
            aMin = Integer.MAX_VALUE;
            bMin = Integer.MAX_VALUE;

            for(int j=0; j<n;j++){
                // Line 7 of the algorithm
                if((distanceMatrix[i][j] < aMin) && (j != i) && (BR[i][j] == false)){
                    aMin = distanceMatrix[i][j];
                    BR[i][j] = true;
                    a[i] = j;
                    int s1 = j; // End of line 7
                    // Line 8 of the algorithm
                    if(distanceMatrix[i][j] < distanceMatrix[i][s1])
                        BR[i][s1] = false; // End of line 8
                }

            }

            for(int j=0; j<n; j++){
                // Line 11 of the algorithm
                if((distanceMatrix[i][j] < bMin) && (j != i) && (j != a[i]) && (BR[i][j] == false)){
                    bMin = distanceMatrix[i][j];
                    BR[i][j] = true;
                    b[i] = j;
                    int s2 = j; // end of line 11

                    // Line 12 of the algorithm
                    if(distanceMatrix[i][j] < distanceMatrix[i][s2])
                        BR[i][s2] = false; // end of line 12
                }
            }
        }

        for(int i=0; i <n; i++){
            for(int j=0; j<n; j++){
                int t1 = distanceMatrix[i][a[i]] + distanceMatrix[a[i]][j];
                int t2 = distanceMatrix[i][b[i]] + distanceMatrix[b[i]][j];
                distanceMatrix[i][j] = Math.min(distanceMatrix[i][j], Math.min(t1,t2));
                distanceMatrix[j][i] = distanceMatrix[i][j];
            }
        }

        flag = true;
        for(int i=0; i<n;i++){
            // Line 19 of the algorithm
            for(int j=0; j<n; j++){
                temp[i][j] = distanceMatrix[i][j]; // end of line 19
                // Line 20 of the algorithm
                if (distanceMatrix[i][j] == temp[i][j])
                    flag  = false; // end of line 20
            }
        }
    } 
```

此外，我通过查看算法中的第 19 行和第 20 行了解到，它会陷入循环，因为 flag 将始终为真。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T14:25:12.173

我认为应该是这样的：

```
4) for i ← 1 to n do amin← ∞ ; bmin ← ∞
5)   for j ← 1 to n do
6)     if D[i, j] < amin and j = i and BR[i, j] = 0 then
7)       amin ← D[i, j] ; BR[i, j] ← 1 ; a[i] ← j ; s1 ← j
8)     if D[i, j] < D[i, s1] then BR[i, s1] ← 0 
```

如您所见，`s1`可能并不总是这样`j`：但它总是`<= j`如此。

所以第二个`if`不在第一个里面。否则，这是没有意义的，因为`s1 == j`总是你不能拥有`D[i, j] < D[i, j]`.

# clojure - 关系数据库语言和逻辑编程有多相似？

> ID：11261926
> 
> 赞同：10
> 
> 时间：2012-06-29T12:38:10.787
> 
> 标签：clojure, prolog, relational-database, clojure-core.logic

关系数据库语言和 clojure`sql`等逻辑编程语言在基本概念和实现方面有何异同？两者可以互换吗？`prolog``core.logic`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T20:44:19.413

[Datalog](http://en.wikipedia.org/wiki/Datalog)查询语言捕获了相似性。[这](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.21.6960)是逻辑和数据库之间连接的动机和更好的解释。这段摘录应该解决你的问题：

> 然而，将 Prolog 和关系数据库结合起来显示出一些不协调。Prolog 中的事实和规则按总顺序组织，Prolog 程序的语义取决于此顺序。相反，数据库中的关系被认为是无序的元组集合，查询的结果独立于任何物理顺序。Prolog 程序的处理是面向元组的，而关系数据库是面向集合的。Prolog 提供了诸如剪切谓词之类的过程功能，以允许程序员控制推理过程。Prolog 程序的求值顺序是预先确定的，而关系演算中的表达式纯粹是 **声明性的**并且实际评估留给查询处理器，它可以重新排列查询以进行优化。查询的优化对于关系数据库的成功至关重要。Prolog 引擎的过程性质将优化的负担留给了程序员。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T12:44:46.037

一个重要的区别是[SQL 只是图灵完备](https://stackoverflow.com/questions/900055/is-sql-or-even-tsql-turing-complete)的，其中包含一些非常疯狂的技巧，这些技巧在 ANSI SQL 99 之前是不可能的[。Prolog 是图灵完备](http://en.wikipedia.org/wiki/Prolog#Turing_completeness)的，因此是一种通用编程语言。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-01T05:31:08.480

尽管 SQL 和 Prolog 都展示了一阶逻辑概念，但都不是[谓词演算](http://en.wikipedia.org/wiki/First-order_logic)的完整实现。

Prolog 和其他逻辑编程语言严重依赖递归，无论是用于定义数据结构还是用于谓词。

SQL 本身不允许递归，并且在引入存储过程时限制了此类调用的嵌套深度。例如。SQL Server 2000 到 2012[最多允许 32 个嵌套调用](http://msdn.microsoft.com/en-us/library/ms187371.aspx)。

在关系数据库中，“关系”被具体化为表（或更灵活地，作为视图）。Prolog 最相似的方面是[动态事实库](http://cs.union.edu/~striegnk/learn-prolog-now/html/node94.html)，它在某些实现（SWI、Amzi）中允许为性能建立索引，非常类似于为 SQL 中的性能建立关系表的索引。

尽管 SQL RDBMS 旨在有效地处理比 Prolog 实现通常需要的大量数据集，但 Prolog 至少可用于对系统设计的数据库和流程方面进行原型设计。

请参阅[此处查看 2005 年的一篇论文](http://home.agh.edu.pl/~wojnicki/phd/node72.html)，该论文探讨了使用 Prolog 推理扩展关系数据库。

# iphone - 如何将发布数据和图像文件发送到服务器 Xcode

> ID：11261928
> 
> 赞同：10
> 
> 时间：2012-06-29T12:38:12.563
> 
> 标签：iphone, objective-c

如何通过相同的 http post 请求将一些文本信息（文本字符串）和图像文件上传到服务器。我自己上传了图像，但无法使用文本。谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-29T13:01:18.553

使用此代码上传图片和文本标签

```
NSData *imageData = UIImageJPEGRepresentation("yourImage",0.2);     //change Image to NSData

if (imageData != nil)
{
    filenames = [NSString stringWithFormat:@"TextLabel"];      //set name here
        NSLog(@"%@", filenames);
    NSString *urlString = @"http://xxxxxxx/yyyyy.php";

    NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:[NSURL URLWithString:urlString]];
        [request setHTTPMethod:@"POST"];

        NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
        NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

    NSMutableData *body = [NSMutableData data];

    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"filenames\"\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[filenames dataUsingEncoding:NSUTF8StringEncoding]];

    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];    
    [body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"userfile\"; filename=\".jpg\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];

        [body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[NSData dataWithData:imageData]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    // setting the body of the post to the reqeust
    [request setHTTPBody:body];
    // now lets make the connection to the web
    NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
    NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];
    NSLog(returnString);
    NSLog(@"finish");
} 
```

在 php 端使用此代码

```
$myparam = $_POST['userfile'];     //getting image Here
$mytextLabel= $_POST['filenames']   //getting textLabe Here
echo $myparam;
echo $mytextLabel; 
$target_path = "uploads/";
$target_path = $target_path . basename( $_FILES['myfile']['name']);  

if(move_uploaded_file($_FILES['myfile']['tmp_name'], $target_path)) {
    echo "The file ". basename( $_FILES['myfile']['name']) . " has been uploaded";
} else {
    echo "There was an error uploading the file, please try again!";
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T09:49:35.990

只需在单击按钮上添加以下方法：

```
-(void) uploadImage
{
    prodNam = txtProdName.text;
    UIImage * img = [UIImage imageNamed:@"SRT2.jpg"];
    NSData *imageData = UIImageJPEGRepresentation(img,0.2);     //change Image to NSData

    if (imageData != nil)

    {
        NSString * filenames = [NSString stringWithFormat:@"TextLabel"];
        NSLog(@"%@", filenames);

        NSString *urlString = @"http://dev9.edisbest.com/upload_image.php";

        NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init] ;
        [request setURL:[NSURL URLWithString:urlString]];
        [request setHTTPMethod:@"POST"];

        NSString *boundary = @"---------------------------14737809831466499882746641449";
        NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
        [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

        NSMutableData *body = [NSMutableData data];
        [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
        [body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"filenames\"\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
        [body appendData:[filenames dataUsingEncoding:NSUTF8StringEncoding]];
        [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
        [body appendData:[@"Content-Disposition: form-data; name=\"userfile\"; filename=\"TestEdreamzIpad.jpg\"\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
        [body appendData:[@"Content-Type: application/octet-stream\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
        [body appendData:[NSData dataWithData:imageData]];
        [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
        [request setHTTPBody:body];
        NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
        NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];
        NSLog(@"Response : %@",returnString);

        if([returnString isEqualToString:@"Success ! The file has been uploaded"])
        {
            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Success" message:@"Image Saved Successfully" delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil];

            [alert show];
        }
    NSLog(@"Finish");
    }
} 
```

您可以将任何图像放在 xcode 本地层次结构的“SRT2.jpg”位置。

一切顺利...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-08T07:12:50.680

只需用户[SVHttp 请求](https://github.com/TransitApp/SVHTTPRequest)将文件上传到服务器。

在参数中发送 imageFile 和其他东西：

```
NSMutableDictionary *data = [[NSMutableDictionary alloc] init];
    [data setObject:imageData forKey:@"image"];
    [data setObject:@"saveimage" forKey:@"action"];
    [data setObject:userId forKey:@"userid"];
    [data setObject:@"png" forKey:@"type"]; 
```

并提出请求：

```
SVHTTPClient *request = [SVHTTPClient sharedClient];

    [request setBasicAuthWithUsername:nil password:nil];
    [request setSendParametersAsJSON:NO];

    [request POST:[NSString stringWithFormat:@"http://bylyngo.com/getapi/?action=saveimage&userid=%@&type=png",userId]
       parameters:data
         progress:^(float progress) {

             NSLog(@"Uploading (%.0f%%)", progress*100);

         }]; 
```

你甚至会得到进步。

:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-08T04:50:58.213

我的网络服务就是这个，它运行良好！

```
<?php

$fp = fopen("./trace.txt", "w"); //creates a file to trace your data
fwrite($fp,"get \n");
fwrite($fp, print_r($_GET, true));
fwrite($fp,"POST \n");
fwrite($fp, print_r($_POST, true));//displays the POST 
fwrite($fp,"FILES \n");
fwrite($fp,print_r($_FILES,true));//display the FILES 
fclose($fp);

$myparam = $_POST["userfile"];
$mytextLabel = $_POST['filenames'];
echo $myparam;
echo $mytextLabel;

$uploadDir = 'uploads/'; //you must create this directory
$uploadDir = $uploadDir.basename($_FILES['myfile']['name']); //saves the picture inside that folder

$file = basename($_FILES['uploaded']['name']);
//$uploadedFile = $uploadDir.$file;
//move_uploaded_file($_FILES['uploaded']['tpm_name']);

if(move_uploaded_file($_FILES['myfile']['tpm_name'],$uploadDir)){
echo "the file ".basename($_FILES['myfile']['name'])." has been uploaded" ;
}else{

echo "error";
} 

?> 
```

# oracle - 使用 oracle 触发器审计 50 列

> ID：11261929
> 
> 赞同：4
> 
> 时间：2012-06-29T12:38:16.463
> 
> 标签：oracle, triggers, oracle11g

我需要创建一个用于审计表的`trigger`in 。`oracle 11g`

我有一张`50 columns`需要的桌子`audited`。

*   对于`every new insert`表格，我需要输入一个条目`audit table (1 row)`。
*   对于`every update`，假设我更新`1st 2nd column`，那么它将在审计中创建两条记录 `old value and new value`。

*审计表的结构将是*

```
 id        NOT NULL
 attribute NOT NULL
 OLD VALUE NOT NULL
 NEW VALUE NOT NULL
 cre_date  NOT NULL
 upd_date  NULL
 cre_time  NOT NULL
 upd_time  NULL 
```

在这种情况下`insert`，只有主键（主表）即需要填充和`id` 等于，在更新的情况下，假设 colA 和 colB 正在更新，那么都需要填充。在这种情况下，将创建两条记录第一条记录的属性和对应的值，对于`cre_date and cre_time``attribute``*``colA``old and new``colB`

现在我的审计解决方案是`not very optimized`，我创建了一个`row level trigger`，它将检查该表的每 50 列是否`changed`基于其`new and old value`（if -else），并将填充审计表。我对我的解决方案不满意，这就是我在这里发帖的原因。我在下面的链接中看到的另一个解决方案：

`http://stackoverflow.com/questions/1421645/oracle-excluding-updates-of-one-column-for-firing-a-trigger`

这在我的情况下不起作用，我为此做了一个 POC，如下所示：

```
create table temp12(id number);

create or replace trigger my_trigger
after update or insert on temp12
for each row
declare
  TYPE tab_col_nt IS table of varchar2(30);

  v_tab_col_nt tab_col_nt;

begin
 v_tab_col_nt := tab_col_nt('id','name');

   for r in v_tab_col_nt.first..v_tab_col_nt.last
   loop
      if updating(r) then
         insert into data_table values(1,'i am updating'||r);
      else
      insert into data_table values(2,'i am inserting'||r);
      end if;
   end loop;

 end; 
```

如果更新它正在调用其他部分，我不知道为什么。这可以通过`compound trigger`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T14:37:22.407

总是被调用的直接问题`else`是因为您`r`直接使用索引变量，而不是查找相关的列名：

```
for r in v_tab_col_nt.first..v_tab_col_nt.last
loop
    if updating(v_tab_col_nt(r)) then
        insert into data_table values(1,'i am updating '||v_tab_col_nt(r));
    else
        insert into data_table values(2,'i am inserting '||v_tab_col_nt(r));
    end if;
end loop; 
```

你也只`id`在你的表创建中显示一列，所以什么时候`r`是`2`，它总是说它正在插入`name`，从不更新。更重要的是，如果您确实有一个`name`列并且只更新给定的列，则`id`此代码将`id`在未更改时显示为插入。您需要将插入/更新拆分为单独的块：

```
if updating then
    for r in v_tab_col_nt.first..v_tab_col_nt.last loop
        if updating(v_tab_col_nt(r)) then
            insert into data_table values(1,'i am updating '||v_tab_col_nt(r));
        end if;
    end loop;
else /* inserting */
    for r in v_tab_col_nt.first..v_tab_col_nt.last loop
        insert into data_table values(2,'i am inserting '||v_tab_col_nt(r));
    end loop;
end if; 
```

`name`即使该列不存在，这仍然会说它正在插入，但我认为这是一个错误，而且我猜`user_tab_columns`如果您真的想尝试使其动态化，无论如何您都会尝试填充名称列表。

* * *

我同意（至少其中一些）其他人的观点，即您可能最好使用一个审计表来获取整行的副本，而不是单个列。您的反对意见似乎是单独列出更改的列的复杂性。当您需要逐列数据时，您仍然可以通过对审计表进行反透视，通过一些工作来获得此信息。例如：

```
create table temp12(id number, col1 number, col2 number, col3 number);
create table temp12_audit(id number, col1 number, col2 number, col3 number,
    action char(1), when timestamp);

create or replace trigger temp12_trig
before update or insert on temp12
for each row
declare
    l_action char(1);
begin
    if inserting then
        l_action := 'I';
    else
        l_action := 'U';
    end if;

    insert into temp12_audit(id, col1, col2, col3, action, when)
    values (:new.id, :new.col1, :new.col2, :new.col3, l_action, systimestamp);
end;
/

insert into temp12(id, col1, col2, col3) values (123, 1, 2, 3);
insert into temp12(id, col1, col2, col3) values (456, 4, 5, 6);
update temp12 set col1 = 9, col2 = 8 where id = 123;
update temp12 set col1 = 7, col3 = 9 where id = 456;
update temp12 set col3 = 7 where id = 123;

select * from temp12_audit order by when;

        ID       COL1       COL2       COL3 A WHEN
---------- ---------- ---------- ---------- - -------------------------
       123          1          2          3 I 29/06/2012 15:07:47.349
       456          4          5          6 I 29/06/2012 15:07:47.357
       123          9          8          3 U 29/06/2012 15:07:47.366
       456          7          5          9 U 29/06/2012 15:07:47.369
       123          9          8          7 U 29/06/2012 15:07:47.371 
```

因此，对于所采取的每项操作，您都有一个审核行，两个插入和三个更新。但是您希望查看更改的每一列的单独数据。

```
select distinct id, when,
    case
        when action = 'I' then 'Record inserted'
        when prev_value is null and value is not null
            then col || ' set to ' || value
        when prev_value is not null and value is null
            then col || ' set to null'
        else col || ' changed from ' || prev_value || ' to ' || value
    end as change
from (
    select *
    from (
        select id,
            col1, lag(col1) over (partition by id order by when) as prev_col1,
            col2, lag(col2) over (partition by id order by when) as prev_col2,
            col3, lag(col3) over (partition by id order by when) as prev_col3,
            action, when
        from temp12_audit
    )
    unpivot ((value, prev_value) for col in (
        (col1, prev_col1) as 'col1',
        (col2, prev_col2) as 'col2',
        (col3, prev_col3) as 'col3')
    )
)
where value != prev_value
    or (value is null and prev_value is not null)
    or (value is not null and prev_value is null)
order by when, id;

        ID WHEN                      CHANGE
---------- ------------------------- -------------------------
       123 29/06/2012 15:07:47.349   Record inserted
       456 29/06/2012 15:07:47.357   Record inserted
       123 29/06/2012 15:07:47.366   col1 changed from 1 to 9
       123 29/06/2012 15:07:47.366   col2 changed from 2 to 8
       456 29/06/2012 15:07:47.369   col1 changed from 4 to 7
       456 29/06/2012 15:07:47.369   col3 changed from 6 to 9
       123 29/06/2012 15:07:47.371   col3 changed from 3 to 7 
```

5 条审计记录变成了 7 条更新；三个更新语句显示修改的五列。如果你会经常使用它，你可能会考虑把它变成一个视图。

所以让我们稍微分解一下。核心是这个内部选择，它用于[`lag()`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions082.htm#i1327527)从该行的上一个审计记录中获取该行的上一个值`id`：

```
 select id,
            col1, lag(col1) over (partition by id order by when) as prev_col1,
            col2, lag(col2) over (partition by id order by when) as prev_col2,
            col3, lag(col3) over (partition by id order by when) as prev_col3,
            action, when
        from temp12_audit 
```

这为我们提供了一个临时视图，其中包含所有审计表列以及随后用于[`unpivot()`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10002.htm#CHDIBEFI)操作的滞后列，您可以使用它，因为您已将问题标记为 11g：

```
 select *
    from (
        ...
    )
    unpivot ((value, prev_value) for col in (
        (col1, prev_col1) as 'col1',
        (col2, prev_col2) as 'col2',
        (col3, prev_col3) as 'col3')
    ) 
```

现在我们有一个包含`id, action, when, col, value, prev_value`列的临时视图；在这种情况下，因为我只有三列，它的行数是审计表中的三倍。最后，外部选择过滤器仅包含值已更改的行，即 where `value != prev_value`（允许空值）。

```
select
    ...
from (
    ...
)
where value != prev_value
    or (value is null and prev_value is not null)
    or (value is not null and prev_value is null) 
```

我`case`过去只是打印一些东西，但当然你可以对数据做任何你想做的事情。之所以`distinct`需要，是因为`insert`审计表中的条目也被转换为非透视视图中的三行，并且我在第一个子句中为所有三行显示相同的文本`case`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T12:50:54.773

为什么不让生活更轻松，并在更新任何列中的任何数据时插入整行。因此，主表上的任何更新（或通常删除）都会首先将原始行复制到审计表中。因此，您的审计表将具有与主表相同的布局，但具有额外的几个跟踪字段，例如：

```
create or replace trigger my_tab_tr
before update or delete
on my_tab
referencing new as new and old as old
for each row
declare
  l_type varchar2(3);
begin
  if (updating) then
    l_type = 'UPD';
  else
    l_type = 'DEL';
  end if;

insert into my_tab_audit(
 col1,
 col2,
 audit_type,
 audit_date) 
values (
 :old.col1,
 :old.col2,
 l_type,
 sysdate
);
end; 
```

根据需要向审计表添加其他列，这只是一个典型示例

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T13:55:59.897

我看到逐个字段审计的唯一方法是检查每个字段 :OLD 和 :NEW 值，并将适当的记录写入审计表。您可以通过在触发器中设置一个子例程来半自动化此操作，您可以将适当的值传递给该子例程，但是我相信您必须以一种或另一种方式为每个单独的字段编写代码。除非其他人有一种出色的方法来使用某种我不知道的反射 API 来做到这一点（并且“我不知道的东西”每天都适用于更多的东西，或者看起来是这样 :-)。

是审计单个字段还是审计整行（我通常称之为“历史”表）的选择取决于您打算如何使用数据。在这种情况下，如果需要报告个别领域的变化，我同意逐个领域的审计似乎更合适。在其他情况下（例如，对于任何给定日期，数据提取必须是可重现的）逐行审计或“历史表”方法更适合。

无论审计级别如何（逐字段或逐行），都需要仔细编写比较逻辑以处理 NULL/NOT NULL 情况，这样您就不会因为比较`:OLD.FIELD1 = :NEW.FIELD1`其中之一而被咬伤值（或两者）为 NULL，并且最终没有采取适当的操作，因为 NULL 不等于任何东西，甚至它本身。不要问我怎么知道... :-)

只是出于好奇，当 INSERT 发生时，将在单行中为 OLD_VALUE 和 NEW_VALUE 放入什么？

分享和享受。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-03T13:04:02.307

一个**非常**非正统的解决方案：（仅当您有权访问系统表时，至少要有 SELECT 权限）

1.  你知道你的桌子的名字。标识表所有者的 ID。通过用户（=所有者）的名称在 SYS.USER$ 中查找它。

2.  通过 OWNER#（=所有者 ID）和 NAME（=表名）在 SYS.OBJ$ 中查找表的对象 ID（= OBJ#）。

3.  通过 OBJ# 在 SYS.COL$ 中查找组成表的列。您将找到所有列、它们的 ID (COL#) 和名称 (NAME)。

4.  编写一个带有在这些列集上移动的游标的 UPDATE 触发器。您只需编写一次循环的核心。

5.  最后：我不提供代码，因为详细信息可能因 Oracle 版本而异。

这是真正的动态 SQL 编程。我碰巧在相当大的企业系统上使用它（团队领导不知道它）并且它有效。它快速可靠。缺点：{特权；可运输性；负责任的人考虑不好}。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-29T12:44:44.383

我喜欢这样做的方式：

1.  创建与现有原始表平行的审计表。
2.  向此审计表添加时间戳和用户列。
3.  每当插入或更新原始表时，只需插入审计表即可。
4.  audi 表应该有一个触发器来设置时间戳和用户值 - 所有其他值都作为新值出现。

然后你可以随时查询谁做了什么，什么时候做的。

# c# - 如何在客户端检索 Telerik RadGrid 的 SelectedID

> ID：11261936
> 
> 赞同：0
> 
> 时间：2012-06-29T12:38:41.703
> 
> 标签：c#, asp.net, telerik, client-side, radgrid

如何在不使用 OnRowSelected 事件的情况下在客户端检索 Telerik RadGrid 的 SelectedID？
所以让我们看看我的场景：
我的网格属性是这样的：

```
 <telerik:RadGrid ID="RadGrid1" runat="server" GridLines="None" DataSourceID="SqlDataSource1" AllowPaging="True" AutoGenerateColumns="False" CellSpacing="0" 
      Width="660px" onitemdatabound="RadGrid1_ItemDataBound">
                    <ClientSettings Selecting-AllowRowSelect="true">
                        <Selecting AllowRowSelect="True"></Selecting>
                        <ClientEvents OnRowSelected="OnRowSelected" />
                    </ClientSettings>
... 
```

和目标栏：

```
 <telerik:GridTemplateColumn FilterControlAltText="Filter TemplateColumn_Q column"
      HeaderText="Q" UniqueName="TemplateColumn_Q">
            <ItemTemplate>
                   <asp:Label ID="lblQInsideGrd" runat="server" Font-Size="11px" Text='<%# GetQ(Eval("Q")) %>'></asp:Label>
             </ItemTemplate>
  </telerik:GridTemplateColumn> 
```

我在后面的代码中填写此列，如下所示：

```
protected string GetQ(object Q)
{
    if (Q.ToString().Length < 10)
    {
        return Q.ToString();
    }
    else
    {
        string Q_str = Q.ToString();
        Q_str = Q_str.Substring(0, 10) + "<span style='font-size:9px;color:red;'><a href='#' class='QClick'> (Full View...)</a></span>";
        return Q_str;
    } 
```

如您所见，我想在客户端检索该锚点的相关**ID**字段并在警报中显示该 ID 的每一列中都有一个锚点。
对于服务器端，我们可以使用该锚点的 CommandName 属性。
同样对于客户端，当我们单击每一行时，我们可以使用 OnRowSelected 事件来检索该 ID。
但在我的情况下，单击这些锚点不会选择整行来触发 OnRowSelected。
那我该怎么办呢？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T12:54:01.443

```
var radGrid = $find('<%= RadGrid1.ClientID %>');
var selectedItems = radGrid.get_masterTableView().get_selectedItems()
... 
```

这个给你 ：）

# c++ - directory_iterator file_iter 重命名文件夹中的文件

> ID：11261939
> 
> 赞同：0
> 
> 时间：2012-06-29T12:39:06.573
> 
> 标签：c++, file-rename, boost-filesystem

我想重命名目录中的文件。目录中有 52 个文件夹。每个文件夹都有不同的名称，每个文件夹中有大约 40 个文件。我想提取特定文件夹的名称，并将该名称附加到该特定文件夹中的文件名。当每个文件夹中只有 31 个或更少的文件时，它运行良好。但是，每当特定文件夹中的文件数量超过 31 个时，我编写的重命名算法就会失败。我无法弄清楚为什么当有更多文件时它会崩溃。如果你明白为什么，请告诉我......！我附上代码：

```
int main( int argc, char** argv ){
directory_iterator end_iter;
directory_iterator file_itr;

string inputName;
string checkName;
inputName.assign(argv[1]);

if (is_directory(inputName))
{

    for (directory_iterator dir_itr(inputName); dir_itr != end_iter; ++dir_itr)
    {
        if (is_directory(*dir_itr))
        {
            for (directory_iterator file_itr(*dir_itr); file_itr != end_iter; ++file_itr)
            {
                string folderName(dir_itr->path().filename().string());
                if (is_regular_file(*file_itr)) 
                {
                    std::string fileType = file_itr->path().extension().string();
                    std::transform(fileType.begin(), fileType.end(), fileType.begin(), (int(*)(int))std::toupper);
                    if (fileType == ".JPG" || fileType == ".JPEG" || fileType == ".JPG" || fileType == ".PGM") 
                    {
                        string filename(file_itr->path().string());
                        string pathName(file_itr->path().parent_path().string());
                        string oldName(file_itr->path().filename().string());

                        cout << folderName << endl;
                        folderName += "_";
                        folderName += oldName;

                        string newPathName = pathName + "\\" + folderName;
                        cout << pathName <<"\\"<< folderName << endl;

                        //RENAMING function
                        rename(file_itr->path(), path(newPathName.c_str()));

                    }
                }
            }
        }
    } 
```

} }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T13:41:14.047

重命名目录列表中的文件很可能会`directory_iterator`混淆 Boost 的实现。

从文档：

> **警告**：如果在为目录构建 directory_iterator 之后从目录中删除或添加文件或子目录，则未指定迭代器的后续递增是否会导致迭代器的值为已删除或添加了目录条目。

我建议分两个阶段尝试。在第一阶段，使用您现在拥有的代码来构建一个`vector<pair<string, string> >`而不是重命名文件。然后，一旦您扫描了目录，只需遍历执行实际重命名的列表即可。

# javascript - 使用 YQL 进行跨域 ajax 请求

> ID：11261945
> 
> 赞同：0
> 
> 时间：2012-06-29T12:39:25.963
> 
> 标签：javascript, arrays, json, yql

我正在学习 javascript，并且正在尝试使用一些 json 文件。我是一个完整的初学者，我尝试过很多不同的方式，但现在我想使用 YQL 从另一台服务器请求一个 json 文件，但我不明白如何。例如，如果我有一个像这样的 json：

```
http://m.airpim.com/json/public/search?q=daniele&k=&e=1 
```

使用 YQL 我将其转换为：

```
http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20json%20where%20url%3D'http%3A%2F%2Fm.airpim.com%2Fjson%2Fpublic%2Fsearch%3Fq%3Ddaniele%26k%3D%26e%3D1'&format=json&callback= 
```

但问题是我不知道该放什么，比如回调。这个想法是将json中的“卡片”保存在一个数组中，但我不明白该怎么做，因为我真的不明白javascript中的回调是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:54:56.353

看看这个：http: [//james.padolsey.com/javascript/cross-domain-requests-with-jquery/](http://james.padolsey.com/javascript/cross-domain-requests-with-jquery/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:51:54.370

JavaScript 回调只是一个函数。URL 中的回调参数应该传递一个函数名，服务器将返回一些封装在对命名函数的调用中的 JSON。

例如定义一个函数`myfunc`：

```
function myfunc(json){
    console.log(json);
    } 
```

然后调用`http://query.yahooapis.com/...callback=myfunc`并在返回响应时，`myfunc`将执行并传递 JSON 对象。

# prestashop - Prestashop - give user ability to upload custom image for product

> ID：11261953
> 
> 赞同：0
> 
> 时间：2012-06-29T12:40:11.893
> 
> 标签：prestashop

How can this be achieved in Prestashop version 1.4.7?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-02T03:25:26.937

我知道它有点晚，但这是我的答案，转到目录选项下的产品页面并选择编辑产品，然后单击自定义并选择文件类型或文本类型以直接从 prestashop 上传图像及其描述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T06:46:08.037

您必须为产品添加个性化。在 BO 编辑产品中，选择第 6 个选项卡（个性化、​​自定义 - 我不知道它的英文版本如何 - 我有波兰语版本），然后添加一个字段文件类型并单击更新。然后给这个字段名称，选择这个字段是必需的并保存所有。我认为这应该足够了

# spring - Hibernate：我可以举个例子来说明如何关联这些表吗？

> ID：11261955
> 
> 赞同：-2
> 
> 时间：2012-06-29T12:40:12.917
> 
> 标签：spring, hibernate, hql

我有四张桌子。其中三个是具有一个键的表，它们通过第四个表相互关联。

`Movie.id`, `Rater.id`, 和`Rating.id`都是表中的外键`MRR`。

如果重要，我将`Rater`和`Movie`FK 的组合指定为唯一的。

我知道有两种方法可以做到这一点：

1.  使用 HQL
2.  使用限制

我正在使用弹簧。这是我认识的两个。有人可以提供一个简单的例子，如何从某个地方选择所有评论`Rater.id`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:53:08.463

我猜“所有评论”是指所有评级。还假设 MRR 是某种连接器实体，连接评级、评级者和电影。在这种情况下：

```
SELECT mrr.rating FROM MRR mrr WHERE mrr.rater.id=:raterId 
```

# python - mysql 和 sqlalchemy with_lockmode('update') 它是如何工作的？

> ID：11261956
> 
> 赞同：2
> 
> 时间：2012-06-29T12:40:19.783
> 
> 标签：python, mysql, sqlalchemy

```
cities = DBSession.query(City).filter(City.big=='Y').options(joinedload(City.hash)).limit(1)

t0 = time.time()
keyword_statuses = DBSession.query(KeywordStatus).filter(KeywordStatus.status==0).options(joinedload(KeywordStatus.keyword)).with_lockmode("update").limit(1)

for kw_status in keyword_statuses:
    kw_status.status = 1
    DBSession.commit() 

t0 = time.time()
w = SWorker(threads_no=1, network_server='http://192.168.1.242:8180/', keywords=keyword_statuses, cities=cities, saver=MySqlRawSave(DBSession), loglevel='debug')

w.work()

print 'finished' 
```

上面的代码使用 select for update 从表中选择关键字状态。它锁定该行，直到该行被更新。

如您所见，我更新了行并提交了更改。

```
kw_status.status = 1
DBSession.commit() 
```

之后，我创建了一个 SWorker 对象，该对象将任务放入队列并创建了许多处理队列的线程（为了简单起见，这里只有一个）。

工人在完成处理后更新

```
kw_status.status = 2
DBSession.commit() 
```

此时我得到一个例外

```
(1205, 'Lock wait timeout exceeded; try restarting transaction') 'UPDATE g_search_keyword_status SET status=%s WHERE g_search_keyword_status.keyword_id = %s' (2, 10000001L) 
```

所以似乎该行被锁定。但是在我开始工作之前，我已经将状态更新为 1 并且我已经提交了更改，因此应该解锁该行。

我也使用 scoped_session

```
DBSession = scoped_session(
    sessionmaker(
    autoflush=True,
    autocommit=False,
    bind=engine
    )
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T13:44:54.343

问题是延迟加载。注意

```
keyword_statuses =  DBSession.query(KeywordStatus).filter(KeywordStatus.status==0).options(joinedload(KeywordStatus.keyword)).with_lockmode("update").limit(1)

for kw_status in keyword_statuses:
    kw_status.status = 1
DBSession.commit() 
```

上面的代码不会将结果加载到内存中，而是仅在实际需要时加载。

在我的 SWorker 中，我循环遍历 keywordStatus.keyword 对象，因此表锁定了 foreach thread 。

当我使用 all() 将结果加载到内存时问题解决了

```
keyword_statuses =  DBSession.query(KeywordStatus).filter(KeywordStatus.status==0).options(joinedload(KeywordStatus.keyword)).with_lockmode("update").limit(1).all() 
```

# vba - How can i print an array which having more than 255 characters? (VBA word)

> ID：11261957
> 
> 赞同：-1
> 
> 时间：2012-06-29T12:40:20.530
> 
> 标签：vba, ms-word

I declared array() as string and had array() with values of 282 characters

> When there is a conflict between the heart and the brain, let the heart be followed.. A man of intellect can turn into a devil, but never a man of heart. Everything can be sacrificed for truth, but truth can't be sacrificed for anything. There is no misery where there is no want.

I tried to print it in another page using typetext option it prints only 255char only up to this

> When there is a conflict between the heart and the brain, let the heart be followed.. A man of intellect can turn into a devil, but never a man of heart. Everything can be sacrificed for truth, but truth can't be sacrificed for anything. There is no mis

Any suggestion regarding this, How do i get it with the actual range?

```
Sub Sortingauthor()
Dim TheInput As String
Dim Authorreference() As String
Dim SortedAuthorreference() As Variant
Dim i As Integer
Dim ReferenceCount As Integer
Dim References(1000) As String

ReferenceCount = InputBox("Enter the Number of References", "No. of References")

ReDim Authorreference(1 To ReferenceCount)
ReDim SortedAuthorreference(1 To ReferenceCount)

Selection.HomeKey unit:=wdStory
With Selection.Find
    .text = "^pReferences^p": 
    .Replacement.text = vbnullstring:  
    .Forward = True: 
    .Wrap =      wdFindContinue: 
    .Format = False:  
    .MatchCase = False: 
    .MatchWholeWord = True: 
    .MatchWildcards = False:        
    .MatchSoundsLike = False: 
    .MatchAllWordForms = False
End With
Selection.Find.Execute
Selection.MoveRight unit:=wdCharacter, count:=1

For i = 1 To ReferenceCount
    Selection.MoveDown unit:=wdParagraph, count:=1, Extend:=wdExtend
    Authorreference(i) = Selection.Range.text
    Selection.MoveRight unit:=wdCharacter, count:=1
Next i

WordBasic.sortarray Authorreference()

For i = 1 To (UBound(Authorreference()))
    SortedAuthorreference(i) = Authorreference(i)
    MsgBox (SortedAuthorreference(i))
Next i

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T09:02:12.640

> 数组值在排序前正确打印。但是在使用 wordbasic.sortarray 命令进行排序后。自打印以来，它最多只能扩展 255 个字符。如果我们想对超过 255 个字符的数组进行有效排序，我们必须使用快速排序或冒泡排序。

# ruby - Ruby 从范围创建一个特定的数组

> ID：11261959
> 
> 赞同：6
> 
> 时间：2012-06-29T12:40:21.857
> 
> 标签：ruby

我想知道如何使用 ruby​​ 中的范围生成以下数组

```
["00","00","01","01","02", "02", ...... "10", "10"] 
```

我想将每个元素重复两次，这就是我正在寻找答案的部分。我可以生成如下的单个元素

```
("00".."10").to_a 
```

我知道我可以使用循环等来做到这一点，但我正在寻找更简单的一行代码

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T12:47:35.240

使用[Array#zip](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-zip)和[Array#flatten](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-flatten)：

```
a = ("00".."10").to_a
a.zip(a).flatten
# ["00", "00", "01", "01", "02", "02", "03", "03", "04", "04", "05", "05", "06", "06", "07", "07", "08", "08", "09", "09", "10", "10"] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-29T12:59:06.100

```
("00".."10").flat_map { |x| [x, x] }
#=> ["00", "00", "01", "01", ..., "10", "10"] 
```

# c# - 处理两个 DateTimePicker 太容易出错？

> ID：11261964
> 
> 赞同：0
> 
> 时间：2012-06-29T12:40:33.093
> 
> 标签：c#

所以经常，我希望用户选择开始日期和结束日期。但仅选择日期是不够的，我们还必须更改数据。

默认情况下，`DateTimePicker.Value`就像

```
Value 1: 2012-01-01 10:12:09
Value 2: 2012-01-02 10:12:09 
```

当用户选择两个日期时，很明显他的意思是

```
Value 1: 2012-01-01 00:00:00
Value 2: 2012-01-02 23:59:59 
```

我经常忘记做不直观的事情

```
DateTime start = dateTimePicker1.Value.Date;
DateTime finish = dateTimePicker2.Value.Date.AddDays(1).AddSeconds(-1); 
```

您找到了哪些更有效的处理方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:53:53.977

如果你经常使用`DateTimePicker`像这样的对象，你可以创建两个小的自定义类：a`StartDateTimePicker`和 an `EndDateTimePicker`。每个类都将派生自`DateTimePicker`，并且仅在[OnValueChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.onvaluechanged.aspx)事件上有一个布尔值和一个 EventHandler。该事件将用于在设置后调整值，而布尔值将用于实现[Balking Pattern](http://en.wikipedia.org/wiki/Balking_pattern)。这是一个示例`StartDateTimePicker`：

```
public class StartDateTimePicker : DateTimePicker
{
    bool handling = false;

    // Note: 
    public StartDateTimePicker()
        : base()
    {
        // This could be simplified to a lambda expression
        this.ValueChanged += new EventHandler(StartDateTimePicker_ValueChanged);
    }

    void StartDateTimePicker_ValueChanged(object sender, EventArgs e)
    {
        // If the value is being changed by this event, don't change it again
        if (handling)
        {
            return;
        }
        try
        {
            handling = true;
            // Add your DateTime adjustment logic here:
            Value = Value.Date;
        }
        finally
        {
            handling = false;
        }
    }
} 
```

然后，您只需使用这些来代替您的普通`DateTimePicker`对象，您就不必再担心确保日期被适当地调整了。

It would cost you the time to write the `EndDateTimePicker` class (the above is already a fully functional `StartDateTimePicker`), but it would make things easier down the road as you use these in more places.

# c# - DateTime editor template not rendering date in correct format

> ID：11261965
> 
> 赞同：2
> 
> 时间：2012-06-29T12:40:32.790
> 
> 标签：c#, jquery, asp.net-mvc-3, spark-view-engine

I have a page with a datetime input on it, along with the customary JQuery datepicker, and an editor template for "Date" which formats the date in the text box and the date that is passed into the view and adds the required clases etc.

When I call the page from the default action (which takes a nullable datetime for passing the date into), I get a populated date and it formats correctly (in this case `dd/mm/yyyy`). When I call the page with a datetime, it builds the date correctly in the action, but the page renders the date as `"mm/dd/yyy hh:mm:ss"`, rather than the desired format. The url I'm calling the action with is `<url>?reportDate=06%2F13%2F2012%2000%3A00%3A00`, which is rendered from an html helper action link, passing in the model date as the parameter, and the action can translate this to the correct date. If I try to call the page with `<url>?reportDate=13%2F06%2F2012` (the format I want to display the date as), the action takes it as a null parameter being passed, the page displays the date correctly, but a validation exception is thrown - `The value '13/06/2012' is invalid.`

I'm in the UK, I've got my globalization in the web.config set to `en-GB`, but for some reason it's validating against the US version of the date by the looks of it.

Model:

```
public class ReportModel
{
    [Required]
    DataType(DataType.Date)]
    public DateTime ReportDate { get; set; }
    public string Message { get; set; }

    //More code here
} 
```

Template (in Shared\EditorTemplates\Date.spark and using SparkViewEngine):

```
<viewdata model="DateTime" />
${Html.TextBox("", string.Format("{0:d}", Model.ToShortDateString()), new { id = "", @class = "datepicker" })} 
```

View:

```
<p>
    <label for="ProcessDate">
        Date
        <small>
            <span class="error">${Html.ValidationMessageFor(m => m.ReportDate)}</span>
        </small>
    </label>
    ${Html.EditorFor(m => m.ReportDate, "Date")}
</p> 
```

Action:

```
public ActionResult StatementsReport(DateTime? reportDate)
{
    if (!reportDate.HasValue)
        reportDate = DateTime.Now;

    var report = new ReportModel { ReportDate = reportDate.Value.Date };
    return View("Statements/GenerateReport", report);
} 
```

If I need to provide more detail, please let me know.

Any help greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:43:09.613

默认模型绑定器在解析时使用带有 GET 请求的 InvariantCulture 和用于 POST 请求的线程区域性。这基本上意味着如果您`reportDate`在 GET 请求中传递您的操作参数（作为查询字符串参数），您必须使用 InvariantCulture 对其进行格式化。理想情况下使用：

```
some_url?reportDate=yyyy-MM-dd 
```

如果您要发送 POST 请求（也就是提交包含输入字段的表单），那么必须根据您的应用程序文化格式化日期，因为这是模型绑定器将使用的。

查看以下说明这一点的[博客文章。](http://weblogs.asp.net/melvynharbour/archive/2008/11/21/mvc-modelbinder-and-localization.aspx)

# html - how to center mutiple img altogether on the screen without the last pics being centered but on the left

> ID：11261968
> 
> 赞同：0
> 
> 时间：2012-06-29T12:40:36.100
> 
> 标签：html, responsive-design

i have some trouble finding a way to show some thumbs in the middle of the screen, especially if one resizes the window (-> responsive design).

A couple a images are displayed in the next line but then centerd...which is not a surprise at all...but how can i have the center effect (in regard to have the images displayed always in the center) But have the last images float left so that they have an equal beginning with the above line?) ![enter image description here](../Images/b2718f9e16e017da325fc2ddc9c935d7.png)

My HTML code so far looks like this (**see also he fiddle** : [http://jsfiddle.net/Zw9Ug/](http://jsfiddle.net/Zw9Ug/))

```
<!doctype html>  
<html lang="de">  
    <head>  
        <meta charset="utf-8">  
        <title>Template Gallery </title>  
        <meta name="description" content="This is the content">  
    </head>  
    <body>
        <div id="wrapper">
            <div id="inner">
                <div id ="gallery_container">
                    <!-- // TODO - hurry -->
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />
                    <img src="http://www.hdg.de/uploads/pics/pic270-0_01.jpg" alt="" title="" />

                </div>
            </div>
        </div>

    </body>  
</html> 
```

css:

```
#wrapper{
    margin:0px auto;
    width:90%;
    text-align: center;
}
#inner{
    margin-left: auto;
    margin-right: auto;

}
#gallery_container{
    width:auto;
    float:left;
}
#gallery_container img{
    min-height:90px;
    max-height:170px;
}
body {
    background-color: grey;
} 
```

Thanks a lot!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:10:58.543

根据您的实际需要，您可以添加以下内容：

```
#gallery_container img{
   float: left;
} 
```

但是，边框与最左/最右图像之间的空间将不一样。

或者，如果您确实想达到这种效果，您可以添加：

```
#wrapper{
    text-align: justify;
} 
```

但是现在图像之间的间距并不完全相同。

# c++ - How good is OpenCV GPU library for matrix operations?

> ID：11261969
> 
> 赞同：7
> 
> 时间：2012-06-29T12:40:44.777
> 
> 标签：c++, opencv, cuda, gpu, thrust

I'm using OpenCV for an application in computer vision. I'd like to accelerate some matrix operations (matrices are fairly large) on GPU and want to avoid coding directly in CUDA C, if possible. OpenCV 2.4.1 has a number of GPU accelerated functions. How well do they perform in your experience? Am I better off using another library (e.g. Thrust) instead?

**EDIT** Sample application: [Calculate squared Euclidean distance matrix on GPU](https://stackoverflow.com/q/11196748/1121420). Currently, my GPU accelerated (and vectorized) implementation in Matlab using the Parallel Computing Toolbox (PCT) is about 5-10 times faster than my C++ implementation with OpenCV.

Matlab implementation:

```
function K = sqEuclideanDist(P_cpu,Q_cpu)
% Vectorized method to compute pairwise squared Euclidean distance on GPU
% Returns K(i,j) = (P(i,:) - Q(j,:))'*(P(i,:) - Q(j,:))

P_gpu = gpuArray(P_cpu);
Q_gpu = gpuArray(Q_cpu);

[nP, d] = size(P_gpu);
[nQ, d] = size(Q_gpu);

pmag = sum(P_gpu .* P_gpu, 2);
qmag = sum(Q_gpu .* Q_gpu, 2);

% note that K is on GPU
K = ones(nP,1)*qmag' + pmag*ones(1,nQ) - 2*P_gpu*Q_gpu';

end 
```

**UPDATE** Here's another Matlab implementation that accomplishes the same (thanks to [https://stackoverflow.com/a/7774323/1121420](https://stackoverflow.com/a/7774323/1121420)). But it runs only on CPU because `bsxfun` is not supported by PCT. Still looking for C++ alternative though.

```
function K = sqEuclideanDist(P_cpu,Q_cpu)
% Returns K(i,j) = (P(i,:) - Q(j,:))'*(P(i,:) - Q(j,:))
% Runs on CPU only.

K = bsxfun(@plus,sum(p.^2,2),sum(q.^2,2)') - 2*(p*q');

end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T13:57:07.207

我发现[ArrayFire](http://accelereyes.com/arrayfire)速度更快，并且已经开始使用它而不是 OpenCV 中的 GPU 内核进行图像处理。以下是我发现的[一些基准测试](http://mcclanahoochie.com/blog/2011/10/gpu-convolution-opencv-gpu-and-libjacket-part-2/)，将 ArrayFire（曾经位于名为 LibJacket 的不同接口）与 OpenCV 进行比较，并且在我的基准测试中也确实如此，ArrayFire 比 OpenCV 中的 GPU 函数快 2-4 倍。据我所知，NVIDIA 没有在 OpenCV 中编写 GPU 内核，而是将其外包给了某人，这可能就是它们如此缓慢的原因。由于我只使用 1 个 GPU，我可以免费使用 ArrayFire。

**鉴于@Alex 发布的新 MATLAB 代码，更新：** 我在我的系统上运行了此代码的基准测试。我知道 Parallel Computing Toolbox gpuArray 比 CPU 慢，但 Jacket 和 ArrayFire 却很糟糕。硬件规格为：

```
Intel(R) Xeon(R) CPU X5660  @ 2.80GHz
NVIDIA Tesla M2090 
```

使用 Parallel Computing Toolbox gpuArray（完全预热）的 CPU 与 GPU 的结果。 **CPU 比 PCT gpuArray 快**：

```
>> tic; sqEuclideanDist(gpuArray(rand(1581,3)),gpuArray(rand(189,3))); toc;
Elapsed time is 0.006859 seconds.
>> tic; sqEuclideanDist(rand(1581,3),rand(189,3)); toc;
Elapsed time is 0.005712 seconds. 
```

使用 Jacket（完全预热）的 CPU 与 GPU 的结果。 **Jacket 以 3.7 倍击败 PCT gpuArray，以 3 倍击败 CPU**

```
>> tic; sqEuclideanDist(gdouble(rand(1581,3)),gdouble(rand(189,3))); toc;
Elapsed time is 0.001876 seconds. 
```

这是修改后的代码，可以让您轻松运行所有内容：

```
function K = sqEuclideanDist(P,Q)
% Vectorized method to compute pairwise squared Euclidean distance on GPU
% Returns K(i,j) = (P(i,:) - Q(j,:))'*(P(i,:) - Q(j,:))

[nP, d] = size(P);
[nQ, d] = size(Q);

pmag = sum(P .* P, 2);
qmag = sum(Q .* Q, 2);

K = ones(nP,1)*qmag' + pmag*ones(1,nQ) - 2*P*Q';

end 
```

Jacket 确实支持 GPU 上的 BSXFUN，它确实在一定程度上提高了速度：

```
>> tic; sqEuclideanDist(gdouble(rand(1581,3)),gdouble(rand(189,3))); toc;
Elapsed time is 0.001420 seconds. 
```

请注意，此处使用的尺寸非常小，因此大多数尝试在这些小尺寸上运行的 CUDA 代码可能表现不佳。这就是为什么我喜欢使用 AccelerEyes 的东西，因为这些家伙已经优化了 GPU，不像 PCT gpuArray、Thrust、OpenCV，每一个我过去都尝试过。

这是 ArrayFire Free C++ 结果：

```
Time:  0.0003577 seconds
Speedups:  19.2X faster than PCT gpuArray, 16X faster than the CPU, 5.2X faster
than Jacket in MATLAB original version, 4X faster than Jacket in MATLAB using
BSXFUN 
```

这是我为此编写的 ArrayFire 代码：

```
static array SqEuclideanDist(array P, array Q)
{
    // 0 based indexing
    array pmag = sum(P * P, 1);
    array qmag = sum(Q * Q, 1);

    int np = P.dims(0);
    int nq = Q.dims(0);

    array K = tile(qmag.T(), np, 1) + tile(pmag, 1, nq) - 2 * matmul(P, Q.T());
    return K;
}

int main(int argc, char **argv)
{
    double *P_cpu = new double[1581 * 3];
    double *Q_cpu = new double[189 * 3];

    array P = array(1581, 3, P_cpu);
    array Q = array(189 , 3, Q_cpu);
    af::sync();

    int iter = 1000;

    timer::tic();
    for (int i = 0; i < iter; i++) {
        array K = SqEuclideanDist(P, Q);
        af::eval(K);
    }

    af::sync();
    printf("Time taken: %2.4lfms\n", (1000 * timer::toc()) / iter);

    delete[] P_cpu;
    delete[] Q_cpu;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T12:51:34.467

它们是由 NVidia 贡献的，因此在 CUDA 兼容卡上具有良好的性能。实际性能取决于卡本身和您使用的功能。

根据我的经验，只有 cvRotate 和 cvResize 比普通的 Intel cpu 具有更好的性能。（注：我只对图像相关的功能感兴趣）

# android - Why Intent twice the same activity in OnTouch method?

> ID：11261970
> 
> 赞同：0
> 
> 时间：2012-06-29T12:40:45.223
> 
> 标签：android, android-intent, fragment

When I touch the screen, the OnTouch method is called twice. So the Intent of the new activity in the method "showdetails" load the activity with the view associated twice also. Why? I just need one...

```
public class DeptFragment extends Fragment implements OnTouchListener {

Context mContext = getActivity();
ImageView cacheImage,targetImage; 
ListView List;
ArrayList<String> tabDepartement;
ArrayList<String> tabCommunes;
int codeDepartementCrt;
Departement DepartementCrt;
List<Commune> listCommuneCrt;
Bundle nomBundle;

public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    super.onCreateView(inflater, container, savedInstanceState) ;
    return inflater.inflate(R.layout.dept_fragment, container, false);
}

@Override
public void onActivityCreated(Bundle savedState) {
    super.onActivityCreated(savedState);
    mContext=getActivity();
    View mView = getView();

    targetImage = (ImageView) mView.findViewById(R.id.targetDeptImage);

    targetImage.setOnTouchListener(this); 

}

public boolean onTouch(View v, MotionEvent event) {
    View mView = getView();

    ImageView imageView = (ImageView) mView.findViewById(R.id.cacheDeptImage);

    Bitmap bitmap = ((BitmapDrawable)imageView.getDrawable()).getBitmap();
    int pixel = bitmap.getPixel((int) event.getX(),(int) event.getY());

    int redValue = Color.red(pixel);
    int blueValue = Color.blue(pixel);
    int greenValue = Color.green(pixel);

    showDetails(redValue,greenValue,blueValue);

    return true; 
```

}

```
/**
 * Helper function to show the details of a selected item, by starting a
 * whole new activity in which it is displayed.
 */
void showDetails(int red, int green, int blue) {

    DepartementCrt=rechercherDepartement(red,green,blue);

    if (DepartementCrt != null) {

                Intent intent = new Intent();
                intent.setClass(getActivity(), DeptDetailActivity.class);
                intent.putExtra("code", DepartementCrt.Code);
                startActivity(intent);
    }
}

private Departement rechercherDepartement(int redValue, int greenValue, int blueValue) {
    DepartementRepository departementRepository=new DepartementRepository(mContext);
    Departement departement;

    departementRepository.Open();
    departement= departementRepository.rechercherDepartement(redValue, greenValue, blueValue);
    departementRepository.Close();

    return departement;
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:47:09.300

针对不同的事件类型调用 on touch 方法。

其中一些是：

*   MotionEvent.ACTION_DOWN
*   MotionEvent.ACTION_UP
*   MotionEvent.ACTION_MOVE

也许您应该考虑使用这样的开关来评估事件：

```
public boolean onTouch(View v, MotionEvent me) {

        int action = me.getAction();

        switch( action ) {
        case MotionEvent.ACTION_DOWN:

            break;
        case MotionEvent.ACTION_UP:

            break;
        case MotionEvent.ACTION_MOVE:

            break;
        default:

        }
 } 
```

最后，如果您只想评估视图上的点击操作，您应该使用 View.onClickListener 接口。

```
myView.setOnClickListener(new OnClickListener() {

    public void onClick(View v) {
        //do stuff
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T12:47:45.203

也许您正在快速连续地触摸图像。一旦您第一次检测到触摸，您应该设置一个标志并切换它。

将您的代码更改为以下。

```
Boolean consumeTouch = true;

    public boolean onTouch(View v, MotionEvent event) {

        if (consumeTouch) {

            consumeTouch = false;

            View mView = getView();

            ImageView imageView = (ImageView) mView
                    .findViewById(R.id.cacheDeptImage);

            Bitmap bitmap = ((BitmapDrawable) imageView.getDrawable())
                    .getBitmap();
            int pixel = bitmap.getPixel((int) event.getX(), (int) event.getY());

            int redValue = Color.red(pixel);
            int blueValue = Color.blue(pixel);
            int greenValue = Color.green(pixel);

            showDetails(redValue, greenValue, blueValue);

            return true;
        }
        return false;

    } 
```

# criteria - Criteria count + sub query

> ID：11261971
> 
> 赞同：0
> 
> 时间：2012-06-29T12:40:47.227
> 
> 标签：criteria

I am trying to implement something like:

> Select thread from Thread where(Select Sum(thread.emails) from Thread) is equals to ?

How could I imolement it with Criteria + JPA?

Thanks in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:54:27.523

CriteriaBuilder 中有一个 size() 方法来定义集合的大小。

```
CriteriaBuilder cb = em.getCriteriaBuilder(); //em is EntityManager
CriteriaQuery<Thread> cq = cb.createQuery(Thread.class);

Root<Thread> root = cq.from(Thread.class);
Expression<Collection<String>> emails = root.get("emails");
cq.where(cb.equal(cb.size(emails), PARAM)); 
```

# sql - How to update a column value in one database table using another database table as a reference with SQL

> ID：11261973
> 
> 赞同：1
> 
> 时间：2012-06-29T12:40:58.537
> 
> 标签：sql, sql-server, tsql, sql-update

I have one SQL server database which was created using Import/Export Wizard from an Access Database. I then have another SQL database which is based upon the Access database but has a slightly different schema. I am trying to get the data from the simple Access based database into the more complex SQL server schema database. The Access database simply stored the Country as text in Contact table and in my new schema the Contact table has a CountryId which links to the Country table. I've tried to write the SQL to do this:

```
UDPATE SQLVersion.dbo.Contact
SET CountryId = (SELECT LookupCountry.Id
                 FROM SQLVersion.dbo.Country as LookupCountry, AccessDBVersion.dbo.tblContact as AccessContact
                 WHERE LookupCountry.Name = AccessContact.Country); 
```

This doesn't work because:

> Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.

I can understand why this error is thrown but I don't know how to form the correct SQL that will allow it to update each row with the value found from the lookup. Can anyone help please?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T12:45:12.383

看起来你错过了`Contact`和之间的关系`tblContact`。假设它们由 链接`name`，您可以以更清晰的方式重写查询，例如：

```
update  c
set     countryId = lc.Id
from    SQLVersion.dbo.Contact c
join    AccessDBVersion.dbo.tblContact ac
on      ac.Name = c.Name
join    SQLVersion.dbo.Country lc
on      lc.Name = ac.Country 
```

# haskell - haskell中完整的缩进规则集

> ID：11261974
> 
> 赞同：9
> 
> 时间：2012-06-29T12:41:16.253
> 
> 标签：haskell, coding-style

从哪里可以获得完整的 Haskell 代码编写缩进规则集？

与我的以下问题类似的过去 SO 问题导致我提出上述问题。错误消息背后的原因是什么：`parse error on input 'something'`？

我得到的错误信息：

> baby.hs:103:2：输入“myList”时解析错误（此行错误）

我正在尝试编译的代码：

```
myList = ["aeroplane", "Aeroplane", "AeRoPlAne", "helicopter", "HELICOPTER", "Zebra"]
quicksort :: (Ord a) => [a] -> [a]  
quicksort [] = []  
quicksort (x:xs) =
let smallerSorted = quicksort [a | a <- xs, a <= x]  
biggerSorted = quicksort [a | a <- xs, a > x]  
in smallerSorted ++ [x] ++ biggerSorted 
```

优化编辑：

我将问题中的代码转移到新的 .hs 文件并尝试编译它。仍然存在类似的错误消息。详情如下：

> 错误
> quickSort.hs：5:62：输入“=”时解析错误失败，加载模块：无。（0.02 秒，0 字节）
> 
> 代码快速排序 :: (Ord a) => [a] -> [a]
> quicksort [] = [] quicksort (x:xs) = let smallSorted = quicksort [a | a <- xs, a <= x]
> 大排序 = 快速排序 [a | a <- xs, a > x]
> in smallSorted ++ [x] ++ largeSorted
> myList = ["aeroplane", "Aeroplane", "AeRoPlAne", "helicopter", "HELICOPTER", "Zebra", "America"]

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T12:51:24.573

至少对于标准 Haskell（没有语言扩展），布局规则[在 Haskell 2010 报告的第 10.3 节中进行了解释。](http://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-17800010.3)

根据您的口味，该报告可能有点正式。Haskell 的各种教程和教科书对布局规则有一些更非正式的解释，例如[Haskell Wikibook。](http://en.wikibooks.org/wiki/Haskell/Indentation)

在您的特定情况下，错误消息指向第 103 行，但您只粘贴了几行。我可以看到至少 let-in 结构的缩进被破坏了。您应该编写如下内容：

```
xs = ["aeroplane", "Aeroplane", "AeRoPlAne", "helicopter", "HELICOPTER", "Zebra"]
quicksort :: (Ord a) => [a] -> [a]
quicksort [] = []
quicksort (x:xs) = let smallerSorted = quicksort [a | a <- xs, a <= x]
                       biggerSorted = quicksort [a | a <- xs, a > x]
                   in smallerSorted ++ [x] ++ biggerSorted 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T07:59:51.233

如果我理解正确，避免此问题的最简单方法是编写单个`do`，`let`如下所示：

```
fName = do
  expression1 = ...
  exp2 ...

fName param = let
  exp1 = ...
  exp2 = ...
  exp3 = ...
  in ...        -- can be indented more if you want 
```

这里的要点是，`exp1`在每个新行中，第一个缩进很容易发现和维护。

* * *

这是我学习表中的复制/粘贴。这不是很多，但可能会帮助某人。如果有人发现任何错误/错误，请纠正我。

> 制表符或空格表示 BLOCK，例如 {com1; com2} 在 C++ 中
> 
> 越位规则：在源文件的开头，第一个顶级声明或定义可以从任何列开始。每个后续的顶级声明必须具有相同的缩进！
> 
> LET IN, WHERE 记住它看到的下一个标记的缩进。如果空行或缩进更靠右，则继续上一行。如果缩进相同，这是同一块中新项目的开始。
> 
> win tab 4 spc, unix tab 8 个空格 用空格代替 tab ！！！

```
line1... 
   continue line 1 -- as long it doesn't start at same indent as line1
   3spaces would indicate block with line 1!
   line4 same block
   same indent is same line1 block
   all indents for BLOCK must be same.

line8...    -- is new block and end of line1 block
   positon of first column in block is start

line 1
 cont line1
  cont line 1
   cont line 1
    block1  -- would be cont line 1
    block1  --  if not for this block1 at same indent

Bad way:
do
  action0
  if condition
  then action1
  else action2
  action3

Good way:
do
  action0
  if condition
    then action1
    else action2
  action3 
```

# forms - Symfony2 选择：给定“标量”、“数组”类型的预期参数

> ID：11261976
> 
> 赞同：1
> 
> 时间：2012-06-29T12:41:36.567
> 
> 标签：forms, security, symfony

我正在制作一个带有选择列表的表格。这是我的 FormType 的内容（仅作为测试）：

```
$builder->add('regionUser');
$builder->add('roles' ,'choice' ,array('choices' => array(
        "ROLE_ADMIN" => "ROLE_ADMIN",
            "ROLE_USER" => "ROLE_USER",
        ),
        'required'  => true,
        'multiple' => false,
)); 
```

当我执行此操作时，我收到以下错误：

> 给定“标量”、“数组”类型的预期参数

出了什么问题？如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T17:14:56.050

有3个解决方案：

1.  使用多项选择字段来显示角色字段。多项选择返回一个数组。

2.  在您的表单中，不要显示“角色”字段。仅在您的构建表单中放置一个新字段“角色”，而不是在您的实体中。（如果需要，您可以使用角色层次结构自动填充它）。在 onSuccess 方法中，获取“角色”来为您的用户设置角色。

> $user->addRole($role);

1.  创建用户类时，不要使用 FOSUserBundle 中的 UserInterface。复制它并更改方法的原型。

> // FOSUserBundle/用户接口
> 
> 函数setRoles（数组$角色）；
> 
> ```
> // YourUserBundle/UserInterface 
> function setRoles($roles); 
> ```
> 
> 并更改您的用户类中的方法
> 
> ```
> // FOSUserBundle/UserInterface 
> public function setRoles(array $roles) 
> { 
>         $this->roles = array(); 
>         foreach ($roles as $role) { 
>             $this->addRole($role); 
>         } 
> } 
> 
> // YourUserBundle/UserInterface 
> public function setRoles($roles) 
> { 
>         if (is_string()) { 
>             $this->addRole($roles); 
>         } else { 
>             $this->roles = array(); 
>             foreach ($roles as $role) { 
>                 $this->addRole($role); 
>             } 
>         } 
> } 
> ```

您可以在此处找到更多信息：[https ://groups.google.com/group/symfony2/browse_thread/thread/3dd0d26bcaae4f82/4e091567abe764f9](https://groups.google.com/group/symfony2/browse_thread/thread/3dd0d26bcaae4f82/4e091567abe764f9)

[http://blog.aelius.fr/blog/2011/11/allow-user-to-choose-role-at-registration-in-symfony2-fosuserbundle-2/](http://blog.aelius.fr/blog/2011/11/allow-user-to-choose-role-at-registration-in-symfony2-fosuserbundle-2/)

[https://github.com/FriendsOfSymfony/FOSUserBundle](https://github.com/FriendsOfSymfony/FOSUserBundle)

# bugzilla - 使用 java 在 bugzilla 中创建错误

> ID：11261981
> 
> 赞同：0
> 
> 时间：2012-06-29T12:42:05.213
> 
> 标签：bugzilla

我正在尝试使用 java 代码连接 bugzilla。我使用了此网站[http://www.dreamincode.net/forums/topic/208362-bugzilla-webservice-api/](http://www.dreamincode.net/forums/topic/208362-bugzilla-webservice-api/)中显示的示例。使用 User.login 方法，它返回 {id=1} 作为登录凭据。但是在创建错误时，它显示“线程中的异常”“主”org.apache.xmlrpc.XmlRpcException：需要登录“异常。任何人都可以帮助我了解如何创建错误并从 bugzilla 获取错误。

谢谢，希玛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T09:46:35.160

检查这个库：

[J2Bugzilla：Java Bugzilla API](http://code.google.com/p/j2bugzilla/)

# python - django - TypeError: coercing to Unicode

> ID：11261986
> 
> 赞同：4
> 
> 时间：2012-06-29T12:42:22.980
> 
> 标签：python, django

I'm getting **TypeError: coercing to Unicode: need string or buffer, int found**

This is my models.py:

```
class FollowingModel(models.Model):
    user = models.ForeignKey(User)
    person = models.IntegerField(max_length=20, blank=False)

    def __unicode__(self):
            return self.person 
```

When I retrieve the values from the **FollowingModel** in my views like this

```
g = FollowingModel.objects.all()
g[0] -----> I'm getting that error 
```

I tried changing the `def __unicode__(self):` as

```
def __unicode__(self):
    return str(self.person) 
```

But no use, still I'm getting the same error. Could anyone guide me?

Thanks!

**UPDATE**

```
>>>g = FollowingModel.objects.all()
>>>g

Traceback (most recent call last):
File "<console>", line 1, in <module>
File "/usr/local/lib/python2.7/dist-packages/django/db/models/query.py", line 72, in __repr__
return repr(data)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/base.py", line 370, in __repr__
u = unicode(self)
TypeError: coercing to Unicode: need string or buffer, int found 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T12:49:02.313

该[`__unicode__`方法应该返回 unicode](http://docs.python.org/reference/datamodel.html#object.__unicode__)：

```
def __unicode__(self):
    return unicode(self.person) 
```

# typo3 - TYPO3 - HTML RTE 前端渲染不工作

> ID：11261988
> 
> 赞同：0
> 
> 时间：2012-06-29T12:42:32.610
> 
> 标签：typo3, typoscript, html-rendering

我有最新版本的 TYPO3，我在 RTE 中输入的数据在前端（站点内）没有正确呈现。

因此，例如`<p>asdf</p>`将显示在前端。

我用谷歌搜索并尝试了一些 RTE 默认配置更改，但效果不佳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T10:33:29.050

Please try with some basic testing first.

1.  Create a new site on root level (directly below the globe). Create one content element with all text and styles you want to test.
2.  Create a new Typoscript template for this site and put the following in the setup section:

    page = PAGE
    page.10 < styles.content.get

Make sure to include `CSS Styled content` inside the static template section.

Now watch your page page in frontend. Does it work?

Otherwise try step 0\. and create a new (admin) backend user first.

Most likely you have either a strange transformation rule inside your RTE config in backend (`UserTS` or `PageTS`) or you have some kind of `htmlspecialchar` definition for your frontend rendering.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T00:12:08.340

请发布以下基本 Typo3 配置设置和/或告诉我们您是否使用了这些设置：

您是从较旧的 Typo3 版本升级的吗？可能是缺少某些配置。

Typo3后端中的根模板或站点模板，当您单击“模板”最左侧的菜单时，您可以创建或编辑一个

如果您选择“为新站点创建模板”按钮，则会自动创建最基本的 Typo3 Typoscript *

```
# Default PAGE object:
page = PAGE
page.10 = TEXT
page.10.value = HELLO WORLD! 
```

您是否测试过这样的 TS（= Typoscript）？**测试它并告诉我们它是否有效！** 这对你有用吗？

*   （Typo3 自己的配置语言——既是祝福也是诅咒——可以如此简单也如此痛苦——我读过的最可笑的描述，你可以在 hatypo3.blogspot.de “意大利面条代码节”上找到）

不要错过包含“CSS 样式内容”（它的形式是“编辑整个模板 -> 包含”）但是如果您没有包含此内容，通常不会在前端显示网站内容。

另一种方法是将基本 TS 配置包含在一个或多个单独的文件中。要使文件正常工作，您必须在 BE 的站点模板中通过此代码段引用它们

```
 <INCLUDE_TYPOSCRIPT: source="FILE: yourfile">   
   # BTW I saw that it is common to place the file in a dir like 
   /fileadmin/ts/yourtyposcriptfile.ts 
```

所以给我们这个信息或要求更多，如果我错过了什么。

# eclipse - Eclipse Sonar 插件 - 从分析中排除测试源

> ID：11261989
> 
> 赞同：0
> 
> 时间：2012-06-29T12:42:33.960
> 
> 标签：eclipse, maven, sonarqube

在运行本地分析时，eclipse 是否有可能从声纳分析中排除 maven 项目的测试源？

测试代码使用比生产代码更多的硬编码值。所以有很多警告，说应该使用常量。但是在许多情况下，在测试源中总是使用常量是多余的。我不想删除该规则，因为这是生产代码所必需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:56:20.790

此外，我会说测试代码应该与生产代码具有相同的质量，因为它会测试生产代码，所以如果我合乎逻辑，我会说测试代码必须具有比生产代码更好的质量。

我不确定，但根据 sonar 的文档，有一些称为[“质量配置文件”](http://www.sonarsource.org/using-quality-profiles-in-sonar/)的东西应该可以处理您的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T07:00:42.573

声纳有一个开放的改进，可以添加我想要的功能。见[http://jira.codehaus.org/browse/SONAR-2760](http://jira.codehaus.org/browse/SONAR-2760)

**编辑：**
从 Sonar 3.5 开始，上述改进已经实施并且可用。

# mysql - 全文搜索 - 关键字到关键字（输入字段>数据库列）

> ID：11261990
> 
> 赞同：1
> 
> 时间：2012-06-29T12:42:35.023
> 
> 标签：mysql, pdo, full-text-search

谁能帮我得到我想要的代码？
我有一个输入字段，其中将写入多个关键字。
例子：

```
opel corsa car 
```

我的数据库中有标签条目，用逗号分隔：

```
1\. opel, corsa
2\. car, opel
3\. juice
4\. car 
```

我想要做的是，实现全文搜索，但基于关键字到关键字搜索，这意味着我想列出包含任何关键字的所有结果。但是，我想将这些搜索词修剪 2 个字母，以防有人搜索 corsoa 或 corsae 而不是 corsa。

到目前为止我得到的是：

```
$input = $_GET["tag"];
$input = mb_strtolower($input,'UTF-8');
$tag = explode(" ", $input);
$tagCheck = '(tags LIKE "%'.implode('%") OR (tags LIKE "%', $tag).'%")'; 
```

并在查询

```
$dbq = $dbco->prepare("SELECT name FROM table WHERE ".$tagCheck." HAVING MAX(price) < 50000"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:37:01.483

我建议您更改您的数据库设计（如果可以的话）。

尝试创建一个关系数据库以提高性能，同时使查询“更简单”。

在您的查询中尝试使用 MySQL 的函数 find_in_set。

```
SELECT ... WHERE FIND_IN_SET('1', field) 
```

例子：

```
mysql> select * from fruits;
+-------------------------------+
| fruit                         |
+-------------------------------+
| banana, apple, orange, grapes |
+-------------------------------+
1 row in set (0.00 sec)

mysql> select * from fruits where find_in_set(' apple',fruit);
+-------------------------------+
| fruit                         |
+-------------------------------+
| banana, apple, orange, grapes |
+-------------------------------+
1 row in set (0.00 sec) 
```

编辑：

如果您的表是 MyISAM 或 Innodb（使用 MySQL V.5.6.+），您可以创建文本索引并使用 like 进行查询

在你的选择中，使用这个

```
 SELECT ... WHERE tads like ('%text%') 
```

使用 %（通配符）