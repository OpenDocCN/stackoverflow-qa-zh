# StackOverflow 问答 000752000-000752999

# java - 事后实现接口

> ID：752001
> 
> 赞同：5
> 
> 时间：2009-04-15T14:37:28.157
> 
> 标签：java, design-patterns, oop, interface

我认为，以下不能在 Java 中完成。但我很乐意学习如何实现类似的东西。

假设我们有一个 C 类，它已经在编译代码中使用。（我们既不能更改该代码也不能更改 C 的原始定义）。

进一步假设有一些有趣的代码可以重复使用，只要 C 实现接口 I。事实上，派生 D 或多或少是微不足道的，它只是 C + 接口方法的实现。

然而，似乎没有办法，一旦我有了一个 C，就说：我希望你成为一个 D，也就是一个实现 I 的 C。

（旁注：我认为如果 D 是 C 并且与 C 的唯一区别是添加的方法，则应该允许强制转换 (D)c，其中 c 的运行时类型是 C。这应该是安全的，不是吗？）

怎样才能解决这场灾难？

（我知道工厂设计模式，但这似乎不是一个解决方案。因为，一旦我们设法在以前是 C 的所有地方创建 D，其他人会发现另一个接口 J 有用并派生 E 扩展 C 实现 J。但是 E 和 D 是不兼容的，因为它们都向 C 添加了一组不同的方法。因此，虽然我们总是可以在期望 C 的地方传递 E，但我们不能在期望 D 的地方传递 E。相反，现在，我们需要一个新的类 F 扩展 C 实现 I,J。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T14:44:33.770

难道你不能使用一个委托类，即一个新的类，它包装了一个“C类”的实例，但也实现了“接口I”？

```
public class D implements I {

    private C c;

    public D (C _c) {
        this.c = _c;
    }

    public void method_from_class_C() {
        c.method_from_class_C();
    }
    // repeat ad-nauseum for all of class C's public methods
    ...

    public void method_from_interface_I() {
        // does stuff
    }
    // and do the same for all of interface I's methods too
} 
```

然后，如果您需要调用通常采用类型参数的函数，`I`只需执行以下操作：

```
result = some_function(new D(c)); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T14:45:52.160

如果您需要兼容的只是接口，那么看看[动态代理类](http://docs.oracle.com/javase/8/docs/api/java/lang/reflect/Proxy.html)没问题，它基本上是您在运行时在 java 中实现接口的方式。

如果您需要与类类似的运行时兼容性，我建议您查看 cglib 或 javaassist 开源库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T14:47:10.817

如果你（可以）管理`ClassLoader`加载你的类，`C`那么你可以尝试使用字节码检测来做一些类加载时间的恶作剧，以使类实现接口。

当然，在构建时也可以这样做。这种方式甚至可能更容易（因为您不需要访问 ClassLoader）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T15:26:28.617

> （旁注：我认为如果 D 是 C 并且与 C 的唯一区别是添加的方法，则应该允许强制转换 (D)c，其中 c 的运行时类型是 C。这应该是安全的，不是吗？）

一点也不。如果您可以进行此强制转换，那么您可以编译尝试调用此对象上的“添加方法”之一的代码，该方法将在运行时失败，因为该方法在 C 中不存在。

我认为您在想象演员会检测到 C 中“缺少”的方法并将它们自动委托给 D。我怀疑这是否可行，尽管我无法谈论语言设计的含义。

在我看来，您的问题的解决方案是：

定义类 D，它扩展了 C 并实现了 I
定义了一个构造函数 D(C c)，它本质上将给定 C 对象的状态克隆到一个新的 D 对象中。
D 对象可以传递给您现有的代码，因为它是 C，它可以传递给需要 I 的代码，因为它是 I

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T14:51:21.383

我相信你想要的可以通过使用[`java.lang.reflect.Proxy`](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Proxy.html); 事实上，我为当前的项目做了类似的事情。然而，这是一项相当多的工作，并且由此产生的“混合对象”可能会暴露出奇怪的行为（因为对它们的方法调用被路由到不同的具体对象，当这些方法尝试相互调用时会出现问题）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T04:48:13.633

我认为你不能这样做，因为 Java 是严格类型的。我相信它可以在 Ruby 和 Python 等语言中使用 mixins 来完成。

至于 Java，它绝对是 Adapter 设计模式的一个很好的用法（它之前已经被提议为“包装器”对象）。

# sql - Hibernate：更新到其他表的总和

> ID：752002
> 
> 赞同：1
> 
> 时间：2009-04-15T14:37:41.057
> 
> 标签：sql, mysql, hibernate, hql

我正在尝试将此查询从 MySQL 复制到 HQL： *UPDATE users u, mines m SET u.mana = u.mana + COALESCE((SELECT SUM(m.mana_rate) FROM mines m WHERE m.user_id = u.id) , 0)*

只需在 HQL 中执行此操作： *update User u set u.mana = u.mana + (select coalesce(sum(m.manaRate), 0) from Mine m where m.userId = u.id)*

给出以下错误： *线程“main”中的异常 org.hibernate.hql.ast.QuerySyntaxException：意外的 AST 节点：查询 [update mm.user.User u set u.mana = u.mana + (select coalesce(sum(m. manaRate), 0) 来自 mm.map.buildings.mines.Mine m 其中 m.userId = u.id)]*

我是 Hibernate 的新手，所以我真的不知道从哪里开始，以及错误的含义。如果不可能，我可以在 Hibernate 中编写本机 MySQL 查询吗？

编辑：问题似乎出在“u.mana = u.mana +”，因为当我只是做 u.mana = (select... 查询工作得很好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T14:49:11.903

您可以在 hibernate 中编写本机查询，更多信息请参见[此处](http://www.hibernate.org/hib_docs/entitymanager/reference/en/html/query_native.html)。有点确定您的查询有什么问题。

# c++ - 获取 winhttp.h 的推荐方法是什么？

> ID：752006
> 
> 赞同：10
> 
> 时间：2009-04-15T14:38:02.553
> 
> 标签：c++, windows, proxy, sdk, winhttp

我们的应用程序将 libcurl 用于 HTTP，并且我们想要访问 Internet Explorer 的代理设置。较早的 Stack Overflow 问题[建议我们使用`WinHttpGetIEProxyConfigForCurrentUser`and`WinHttpGetProxyForUrl`](https://stackoverflow.com/questions/202547/how-do-i-find-out-the-browsers-proxy-settings)。

不幸的是，`winhttp.h`无论是 Visual C++ 2005 还是 Visual Studio 2008，我们的副本中似乎都没有包含标头。显然，[可以下载更新的 Platform SDK 并将其安装在 Visual C++ 2005](http://bbulkow.blogspot.com/2006/04/winhttp-and-visual-studio-2005-howto.html)中，但这是一个非常痛苦的过程，而且它没有不一定适用于较新版本的 Visual Studio。

从 C++ 访问 WinHTTP 5.1 API 是否有良好的、受良好支持的方法？还是我们应该避免使用这些 API？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-15T14:56:11.713

从 C++ 访问 WinHTTP 5.1 API 的最佳且受良好支持的方法是通过 Windows SDK（Platform SDK 的新名称）并使用您提到的那些 API。

您链接到的文章表明安装 SDK 很困难 - 好消息是它是 2006 年的一篇旧文章，现在事情要容易得多。只需执行以下操作：

1.  [从这里](http://www.microsoft.com/downloads/details.aspx?FamilyId=F26B1AA4-741A-433A-9BE5-FA919850BDBF&displaylang=en)下载最新的 SDK ISO 映像- 不要担心它被称为“SDK for Windows Server 2008”，它也适用于 Server 2003、XP 和 Vista。
2.  刻录到 DVD
3.  运行 DVD 上的 setup.exe，选择完全安装并让它运行 1/2 小时左右。
4.  安装后，转到开始 -> 程序 -> Microsoft Windows SDK -> Visual Studio 注册 ->**将 Windows SDK 与 Visual Studio 2005 集成**

甚至可能会在安装过程中提示您运行集成工具 - 我安装它已经有一段时间了，所以我记不清了。

然后，Visual C++ 编译器将能够在适当的文件夹中找到 winhttp.h 和 winhttp.lib。

**更新**像往常一样，事情从来没有像他们应该的那样简单。EMK 指出，Windows SDK 配置工具无法与 Visual Studio 2008（任何版本）一起正常工作，并在安装 Visual Studio 2008 SP1 后崩溃。[此处](http://social.msdn.microsoft.com/forums/en-US/windowssdk/thread/62b7d1a6-5210-4f1e-8fc5-a06193edce22/)和[此处](http://social.msdn.microsoft.com/Forums/en-US/windowssdk/thread/7d0eafe5-477b-40cc-85a1-cd6296c6b745)报告了详细信息和解决方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-04-14T08:37:01.967

如果有人看到这篇文章并对获得 winhttp 可以安装的最小组件感到好奇，安装 Microsoft Windows Core SDK > Build Environment > Build Environment (x86 32-bit) 对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T22:36:05.617

您绝对不需要整个 SDK 只需下载正确的部分，请参阅 MSDN 进行选择。

# sql-server - SQL Server 2005 xp_cmdshell

> ID：752008
> 
> 赞同：0
> 
> 时间：2009-04-15T14:38:11.710
> 
> 标签：sql-server, sql-server-2005

以下代码在 Sql server 中直接执行时可以正常工作：

```
DECLARE @cmd sysname
set @cmd = 'dir "C:\A_Projects"'
EXEC master..xp_cmdshell @cmd 
```

但是当我尝试按如下方式创建存储过程时：

```
create procedure zz
 (@cmdin varchar(255))
EXEC master..xp_cmdshell @cmdin 
```

我收到一条消息

> '关键字'EXEC'附近的语法不正确。

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T15:09:42.040

```
create procedure zz (@cmdin varchar(255))
AS --missed this
EXEC master..xp_cmdshell @cmdin 
```

# iphone - 从 iPhone 应用程序连接到 Facebook 并发布到用户的墙上

> ID：752009
> 
> 赞同：-1
> 
> 时间：2009-04-15T14:38:16.250
> 
> 标签：iphone, facebook

1.  在您的 iPhone 应用程序环境中能够连接到 Facebook。

2.  然后将评论和所选照片发布到您的 Facebook 新闻源：

    > [评论：“嘿，伙计们，看看我的照片！] [照片：图片附加到评论]

3.  用户点击“post on wall”，在用户的 Facebook 新闻提要上，将出现：

    > [“大家好，看看我的照片！” ] + [ 照片.jpeg ]

4.  然后在他们的 Facebook 新闻提要下方自动生成指向 iTunes 商店和 App 网站的链接：

    > [“大家好，看看我的照片！” ] + [ photo.jpeg ] “在**‘网站链接’**上创建的照片-**在 Itunes 上可用”**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T14:48:43.167

您需要 iPhone 版 Facebook Connect（开始）

[http://wiki.developers.facebook.com/index.php/Facebook_Connect_for_iPhone](http://wiki.developers.facebook.com/index.php/Facebook_Connect_for_iPhone)

我怀疑 Facebook 是否有能力链接到您自己的应用程序（就像 Twitter 一样），您可以硬编码链接并附加到每条评论。你应该先检查 FB T's & C's。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-22T01:02:52.680

这是一个很好的教程，你可以下载源代码：

[http://www.raywenderlich.com/77/how-to-post-on-facebook-with-your-iphone-app](http://www.raywenderlich.com/77/how-to-post-on-facebook-with-your-iphone-app)

但是你必须链接到已经在线的照片，上传自己的照片并不是那么容易。

# asp.net - Visual Studio Team Suite：如何以编程方式进行网络测试？

> ID：752016
> 
> 赞同：2
> 
> 时间：2009-04-15T14:39:33.423
> 
> 标签：asp.net, testing, visual-studio-2005, web-testing

再会，

我是 Visual Studio 2005 Team Suite Web 测试的新手。这是我想要实现的行动。

在网页上，我有一个从简单数据库表填充的下拉列表。在我的测试中，我想单击动态填充的下拉列表的每个项目，并在回发后检查页面上是否可见标签，这取决于下拉列表中的选定项目。

但是，由于下拉列表是动态生成的，我不能简单地“记录”并手动单击下拉列表的每个项目，因此我必须编写测试代码。

我很确定这很容易实现，所以我想知道是否有一个很好的免费网络测试教程可供我使用。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:43:32.163

你提问。

> 但是，由于下拉列表是动态生成的，我不能简单地“记录”并手动单击下拉列表的每个项目，因此我必须编写测试代码。

在我看来，您需要在测试中添加“数据绑定”。

请通读这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms243142(VS.80).aspx)。

HTH。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:38:03.500

只要它是相当标准的网络表单回发，您就可以使用 NUnitAsp：

[http://nunitasp.sourceforge.net/](http://nunitasp.sourceforge.net/)

这是一篇不错的文章： [ServerSide NUnitASP](http://www.theserverside.net/tt/articles/showarticle.tss?id=TestingASP)

NUnitAsp 不再真正活跃或不再受支持，但对于简单的表单测试它仍然足够好。

# sql - 一对多关系的约束

> ID：752023
> 
> 赞同：4
> 
> 时间：2009-04-15T14:41:16.727
> 
> 标签：sql, sql-server, database-design, constraints

我们有两个具有一对多关系的表。我们希望强制执行一个约束，即给定父记录至少存在一个子记录。

这可能吗？

如果不是，您是否会将架构更改得更复杂一些以支持这样的约束？如果是这样，你会怎么做？

编辑：我正在使用 SQL Server 2005

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T14:42:54.430

从模式的角度来看，这样的约束是不可能的，因为您遇到了“鸡或蛋”类型的场景。在这种情况下，当我插入父表时，我必须在子表中有一行，但在父表中有一行之前，我不能在子表中有一行。

这是更好地执行客户端的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:55:13.153

如果您的后端支持可延迟的约束，这是可能的，就像 PostgreSQL 一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T14:57:44.503

一个简单的不可为空的列怎么样？

```
Create Table ParentTable
(
ParentID
ChildID not null,
Primary Key (ParentID), 
Foreign Key (ChildID ) references Childtable (ChildID));
) 
```

如果您的业务逻辑允许并且您具有可以从数据库中查询每个新父记录的默认值，那么您可以`before insert trigger`在父表上使用 a 来填充不可为空的子列。

```
CREATE or REPLACE TRIGGER trigger_name
BEFORE INSERT
    ON ParentTable
    FOR EACH ROW 
BEGIN

    -- ( insert new row into ChildTable )
    -- update childID column in ParentTable 

END; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-31T22:24:55.977

这实际上并不是“在客户端更好地执行”，因为在某些数据库实现中执行它是不切实际的。实际上，该作业确实属于数据库，并且至少以下一种解决方法应该有效。

最终，您想要的是将父母限制在孩子身上。这保证了一个孩子的存在。不幸的是，这会导致鸡蛋问题，因为孩子必须指向同一个父母，从而导致约束冲突。

在系统的其余部分没有明显副作用的情况下解决问题需要两种能力之一——SQL Server 中没有这两种能力。

1) 延迟约束验证——这会导致在事务结束时验证约束。通常它们发生在语句的末尾。这是鸡蛋问题的根源，因为它阻止您插入第一个子行或父行，因为缺少另一个，这解决了它。

2) 您可以使用 CTE 插入第一个子项，其中 CTE 挂起插入父项的语句（反之亦然）。这会在同一语句中插入两行，从而产生类似于延迟约束验证的效果。

3）如果没有任何一个，您别无选择，只能在其中一个引用中允许空值，这样您就可以在不进行依赖检查的情况下插入该行。然后您必须返回并使用对第二行的引用来更新 null。如果您使用这种技术，您需要小心使系统的其余部分通过一个视图来引用父表，该视图在子引用列中隐藏所有带有 null 的行。

**在任何情况下，您对子项的删除**都同样复杂，因为您无法删除证明至少存在一个的子项，除非您首先更新父项以指向不会被删除的子项。

当您要删除最后一个子项时，您必须抛出错误或同时删除父项。如果您不首先将父指针设置为 null（或延迟验证），则会自动发生错误。如果您确实推迟（或将子指针设置为空），则可以删除子元素，然后也可以删除父元素。

我多年来一直在研究这个问题，我观察了每个版本的 SQL Server 以缓解这个问题，因为它很常见。

**请**一旦有人有实用的解决方案，请发布！

PS您需要在从父级引用您的子证明行时使用复合键，或者使用触发器以确保提供证明的子行实际上认为该行是其父行。

PPS 尽管如果您在同一个事务中同时执行插入和更新，那么系统的其余部分绝对不应该看到 null ，但这依赖于可能失败的行为。约束的重点是确保逻辑故障不会使您的数据库处于无效状态。通过使用隐藏空值的视图保护表，任何非法行都将不可见。显然，您的插入逻辑必须考虑到这样的行可能存在的可能性，但无论如何它都需要内部知识，并且不需要知道其他任何信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-22T18:27:40.357

我遇到了这个问题，并在 Oracle rel.11.2.4 中实施了一个解决方案。

1.  为了确保每个孩子都有一个父母，我将一个典型的外键约束从孩子的 FK 应用到父母的 PK。——这里没有魔法
2.  为了确保每个父母至少有一个孩子，我做了以下工作：

创建一个接受父 PK 的函数，并返回该 PK 的 COUNT 个子节点。-- 我确保 NO_DATA_FOUND 异常返回 0。

在父表上创建一个虚拟列`CHILD_COUNT`，计算到函数结果。

`CHILD_COUNT`使用以下条件在虚拟列上创建可延迟的 CHECK 约束`CHILD_COUNT > 0`

它的工作原理如下：

*   如果插入了父行并且尚不存在子行。然后如果提交了该行，则`CHILD_COUNT > 0`CHECK 约束失败并且事务回滚。
*   如果在同一个事务中插入了父行，并插入了相应的子行；然后在发出 a 时满足所有完整性约束`COMMIT`。
*   如果插入对应于现有父行的子行，则`CHILD_COUNT`重新计算虚拟列`COMMIT`并且不会发生完整性违规。
*   父行的任何删除都必须级联到子行，否则在提交删除事务时，孤立的子行将违反 FOREIGN KEY 约束。（照常）
*   对子行的任何删除都必须为每个父行留下至少一个子行，否则`CHILD_COUNT`在事务提交时将违反检查约束。

`CHECK constraints`注意：如果 Oracle在 rel.11.2.4允许基于用户功能，我将不需要虚拟列。

# sql - 加入 MSSQL 2000 中的表值函数？

> ID：752028
> 
> 赞同：0
> 
> 时间：2009-04-15T14:42:05.680
> 
> 标签：sql, function

我有一张全名的桌子。我有一个函数，它接收所述名称，对其进行解析，并返回一个带有第一个、中间、最后一个和后缀的表。我有一个`bad`（编辑：是“超保守”）DBA，他不会将开发服务器升级到与生产服务器相同的版本，所以我不能只使用 APPLY 并完成它：

```
insert into blah (name, firstName, middleName, lastName, suffix)
select a.name, b.firstName, b.middleName, b.lastName, b.suffix
from employees a CROSS APPLY dbo.parseName(a.name) b 
```

请帮忙，否则我将被迫编写如下代码：

```
insert into blah (name, firstName, middleName, lastName, suffix)
select 
    name, dbo.getNamePart(name, 'f') as firstName, 
    dbo.getNamePart(name, 'm') as middleName, 
    dbo.getNamePart(name, 'l') as lastName, 
    dbo.getNamePart(name, 's') as suffix 
from employees r 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T14:45:53.127

听起来“dev”和“live”使用不同的版本？不在您的开发/生产服务器上使用相同的产品是一种**责任**。“保守”的 DBA 应该希望它们匹配......

我不清楚-您是在*编写*“返回带有第一个、中间、最后一个和后缀的表”的函数，还是在*使用*它。如果您正在*使用*它，您应该能够`SELECT`从 UDF 或`JOIN`到它等等。IIRC，您只需像使用表一样为 UDF 设置别名：

```
...
from dbo.myTableUdf(...) x
inner join SomeTable y on x.id = y.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T18:48:54.777

如果 UDF 不处理来自其他表的数据，您将能够加入它。也就是说，你可以这样写：

```
select name, b.EXPANSION
  from employees a
  join dbo.parseName('John Smith') b
    on a.CODE = b.CODE 
```

但仅仅是因为 myFunc 没有引用 tb1 中的任何字段。这就是创建 APPLY 的目的。

在我看来，你有三个选择：

1.  您的插入语句，每个字段有一个函数引用
2.  结果集上的光标，因此可以一次调用一行
3.  找到一种让开发环境与生产环境同步的方法，包括获得更好的 DBA。

# asp.net - ASP.NET MVC 的必备知识

> ID：752035
> 
> 赞同：25
> 
> 时间：2009-04-15T14:43:58.077
> 
> 标签：asp.net, asp.net-mvc, .net-3.5

在尝试学习 ASP.NET 的奥秘感到沮丧之后，我决定尝试 ASP.NET MVC。

我在 C# 2.0 方面拥有丰富的经验，除了 ASP.NET 之外，我几乎可以做所有事情（WinForms、Windows 服务、远程处理……）。我编写 PHP 的时间比编写 .NET 的时间还要长。有了所有这些经验，我认为我已经为 ASP.NET MVC 做好了准备。我现在看到我正在同时学习以下内容并且有点困难：

*   一般的 MVC 模式
*   ASP.NET
*   ASP.NET MVC
*   .NET 3.5。

我目前大约完成了[NerdDinner](http://www.codeplex.com/nerddinner)免费书籍章节的 1/2。我并没有完全迷失，但我确实觉得我没有像我想的那样追赶（因为我一次学习了 4 件事——有时不清楚哪个技能来自哪个抽象层）。

对于 ASP.NET MVC，您会推荐哪些必备知识？我上面列出的任何/所有？其他的？或者也许我只是很慢，大多数人会很好地做我所做的。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-15T14:51:53.660

我成为 ASP.Net 开发人员只有 3 年了。我从朋友那里得到了一个项目，并决定使用 ASP.Net MVC 来开发它来学习这些新东西。我必须承认我一开始也感到迷茫，但后来我在 ASP.Net/MVC 网站上看到了一些非常有趣的文章。底部是 7 次迭代，它可以让您非常详细地了解您正在做的事情。

我使用了他们在那里的 Products 示例，并将其应用于我自己的项目。经过所有的迭代，我现在觉得我有一个很好的基础来开始学习更高级的 MVC 实现。(JQuery 插件/Ajax/...)

[http://www.asp.net/learn/mvc/](http://www.asp.net/learn/mvc/)

我认为对 ASP.Net 的一些基本了解是基本要求。如果你有这个，你应该能够通过一点点动力来度过这个难关。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-15T15:27:20.687

“一般的 MVC 模式” - 不需要但很有用。ASP.NET - 也没有必要。

.NET 3.5 - 是的。它将成为你的工作工具，你应该掌握它。

对多层架构的理解非常有用，因为此时您必须首先考虑如何组织您的应用程序，而不是直接使用 WebForms 中的控件进行黑客攻击。

你也不会回避 HTML/CSS 的知识，也许是 JavaScript。

只是不要害怕。一步一步做，你就会得到它。只是不要读太多。练习它。

在这里可以找到许多非常有用的教程：[ASP.NET MVC 教程](http://haacked.com)

还可以阅读 ASP.NET MVC“父母”的博客：

[http://haacked.com](http://haacked.com)

[http://weblogs.asp.net/scottgu/default.aspx](http://weblogs.asp.net/scottgu/default.aspx)

[http://www.hanselman.com/](http://www.hanselman.com/)

[http://stephenwalther.com/blog/Default.aspx](http://stephenwalther.com/blog/Default.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-16T20:12:45.857

我有类似的背景。我从一开始就使用.Net/C#，但所有系统相关，没有网络经验。大约 8 个月前，我决定要学习 Web，并认为 ASP.NET MVC 对我来说似乎是正确的选择。我不觉得我缺乏 ASP.NET 经验是一个太大的障碍。我使用了[http://www.asp.net/mvc/](http://www.asp.net/mvc/)网站作为我学习的中心。所有的视频都很好，还有教程和所有示例项目。我已经下载了其中的大部分并且已经足够熟悉，以至于当我无法弄清楚某些事情时，我会去下载一个具有类似要求的项目并查看它是如何编码的。由于不懂网络技术，我还订购了有关 HTML、CSS、JAVA 脚本、AJAX 和 Jquery 的书籍。对我来说，最好的学习方式是开发一个项目，让它成为我所做的。新 MVC 书籍的大多数作者也拥有包含大量有用信息的博客。当我开始学习 MVC 时，MVC 书籍还没有出版，但我相信现在已经有一些不错的书籍，或者很快就会面世。

我很享受新的体验并学到了很多东西，我认为新技术很棒。祝你好运！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-06T01:48:02.187

我建议买一本关于 ASP.NET MVC 的书，并通过书中的示例进行操作。不要太担心 MVC 设计模式的历史，或者它 1979 年起源于 Xerox PARC。我不会费心阅读更多关于实际 MVC 模式的内容，而不是 MSDN 上的这篇简单文章：[Cutting Edge: ASP.NET Presentation Patterns](http://msdn.microsoft.com/en-us/magazine/dd252940.aspx?pr=blog)

我最近完成了 Steve Sanderson 的 Pro ASP.NET MVC 框架，我可以推荐它。它有一个多章示例应用程序，可让您快速开始使用 ASP.NET MVC，然后有 10 个左右的后续章节深入介绍了相关主题（控制器、视图、安全性等）。本书重点关注单元测试和依赖注入，还涵盖了使用 LINQ to SQL 的基本对象关系映射。还有一些章节介绍了 jQuery 与 ASP.NET MVC 的集成以及如何利用传统 WebForms 应用程序中的框架组件（授权、成员资格、角色、个性化、缓存等）。

[Steve's Blog](http://blog.codeville.net/2009/04/29/now-published-pro-aspnet-mvc-framework-apress/)上有许多正面评价，这也是获取更多 ASP.NET 信息的良好来源。Amazon.com 对这本书有一些[正面评价](https://rads.stackoverflow.com/amzn/click/com/1430210079)（我需要在空闲时间添加我的评论）。您还可以在 Google 图书中[试阅部分图书。](http://books.google.com/books?id=Xb3a1xTSfZgC&printsec=frontcover&source=gbs_summary_r&cad=0)

* * *

现在或即将推出的其他一些书籍是：

[Wrox：开始 ASP.NET MVC 1.0](http://www.wrox.com/WileyCDA/WroxTitle/productCd-047043399X.html) --- 作者 [Keyvan Nayyeri](http://nayyeri.net/)和[Simone Chiaretta](http://codeclimber.net.nz/Default.aspx)都是活跃的 ASP.NET MVC 博主。[这里](http://p2p.wrox.com/book-beginning-asp-net-mvc-1-0-isbn-978-0-470-43399-7/74180-free-chapter-9-testing-asp-net-mvc-applications-preview.html)有一个关于测试的示例章节可供下载。我读过它应该在 2009 年 6 月末上市？

[Manning: ASP.NET MVC in Action](http://www.manning.com/palermo/) --- 这本书由[Ben Scheirman](http://flux88.com/)、[Jeffrey Palermo](http://jeffreypalermo.com/)和[Jimmy Bogard 编写](http://jimmybogard.lostechies.com)。他们都有涵盖 ASP.NET MVC 相关主题的有趣博客。如果我没听错的话，这本书应该会在 2009 年 8 月出版。你可以在这里预订这本书（MEAP = Manning Early Access Program）[，](http://www.manning.com/palermo/)并可以访问前 11 章（我认为是未经编辑或编辑松散的）。补充本书的[CodeCampServer](http://code.google.com/p/codecampserver/)参考应用程序非常丰富，涵盖了使用 nHibernate (ORM)、Castle Windsor (DI / IoC)、DDD、单元、集成和回归测试。

[Wrox：专业的 ASP.NET MVC 1.0](http://www.wrox.com/WileyCDA/WroxTitle/Professional-ASP-NET-MVC-1-0.productCd-0470384611.html) --- 这是不久前发布的[NerdDinner](http://haacked.com/archive/2009/03/10/chapter-one-pro-aspnetmvc.aspx)示例应用程序和阅读器附带的书。它由一些非常聪明的 Microsoft 人员撰写：[Rob Conery](http://blog.wekeroad.com/)、[Scott Guthrie](http://weblogs.asp.net/scottgu/)、[Scott Hanselmann](http://www.hanselman.com/blog/)和[Phil Haaaaaaaaaaaack](http://haacked.com/)，他们掌握了有关为什么使用该框架做出某些决定的内部信息。现在有空。

[Packt: ASP.NET MVC 1.0 Quickly](http://www.packtpub.com/asp-net-model-view-controller-1-0-quickly/book) --- 作者[Maarten Balliauw](http://blog.maartenballiauw.be/)有一个非常好的博客，讨论了各种 ASP.NET MVC 问题，包括[测试](http://blog.maartenballiauw.be/post/2008/03/19/ASPNET-MVC-Testing-issues-Q-and-A.aspx)。现在有空。

[Sams: ASP.NET MVC Framework Unleashed](http://www.informit.com/store/product.aspx?isbn=0672329980) --- 作者 Stephen Walther 从 ASP.NET 早期 1.0 时代开始就负责编写许多流行的 ASP.NET Unleashed 书籍，现在他正在写一本关于 ASP.NET MVC 的书。您可以查看他的[博客](http://stephenwalther.com/blog/default.aspx)以获取即将出版的书籍和其他 ASP.NET MVC 相关文章中的示例内容。 [亚马逊](https://rads.stackoverflow.com/amzn/click/com/0672329980)称这本书将于 2009 年 7 月上市。

[Wrox：ASP.NET MVC 网站编程问题设计解决方案--- 这似乎是](http://www.wrox.com/WileyCDA/WroxTitle/productCd-0470410957.html)[Wrox：ASP.NET 2.0 网站编程：问题设计解决方案](http://www.wrox.com/WileyCDA/WroxTitle/ASP-NET-2-0-Website-Programming-Problem-Design-Solution.productCd-0764584642.html) 一书的后续，欢迎作者[Marco Bellinaso 回归](http://msdn.microsoft.com/en-us/magazine/cc300843.aspx)，并介绍了两位新作者项目[Nick Berardi](http://www.coderjournal.com/)和[Al Katawazi](http://codingsmarter.com/)。本书的示例应用程序是[Beerhouse CMS](http://thebeerhouse.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=27519)，可在 CodePlex 上下载。这本书的网站说它将在 2009 年 6 月发行。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-15T15:04:56.373

这是 Martin Fowler 的一个很好的[介绍](http://martinfowler.com/eaaDev/uiArchs.html)。他详细讨论了 GUI 架构。

开始阅读有关以下主题的一些材料，它们将真正帮助您适应任何 MVC。以下是您可以在线查找的一些主题：

*   路由。
*   MVC 模式。
*   控制器和操作。
*   映射参数。
*   行动结果。
*   错误处理。
*   动作过滤。
*   将数据传递给视图。
*   HTML 助手。
*   查看渲染可扩展性。
*   将 jQuery 与 ASP.NET MVC 一起使用。
*   视图、控制器和模型的最佳实践技巧。
*   MVC 反模式。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-16T17:16:54.830

我认为一旦人们想到 MVC 使用路由将请求直接定向到类（使用模型进行连接和显示视图）而不是显示“实际”页面，Web 应用程序中的 MVC 概念真的更清楚地呈现自己。排除了“概念困难”之后，考虑这些属性并决定 MVC 是否适合特定应用程序会容易得多。

编辑——话虽如此，如果我是 ASP.NET 的新手，我可能会先处理表单版本，并在进入 MVC 之前很好地理解该系统的事件、回发和方法，因为 ASP.NET MVC 是真正在该系统之上处理。

编辑 2 - 我想我在完成编辑之前被否决了 :-(

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-06T01:55:16.247

如果您还不了解 Webforms，那么现在就坚持只学习 MVC，这样您就不会迷惑自己。Webforms 是一个有用的知识，而且由于您已经了解 Winforms，所以以后学习它应该不会太难。

MVC 和 Webforms 都在 ASP.NET 下工作，因此您在使用 MVC 时学到的很多东西都将延续到 Webforms。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-16T17:21:53.163

在学习 ASP.NET MVC 之前，我会先花一些时间在 ASP.NET 上。请记住，ASP.NET MVC 基于 ASP.NET。传统 ASP.NET 中的某些内容不会与 MVC 模型（用户控件，（ASCX 和 ASPX 文件））一起使用，但仍然了解这些内容是件好事。如果您想专注于 MVC，请先学习 ASP.NET，但不要花时间研究常用控件或数据绑定。

当你在做 ASP.NET MVC 时，ASP.NET 的其余部分（HttpModules、HttpHandlers、web.config 文件、成员资格提供程序等）仍然有用，我想说可能是真正使用 ASP.NET 的先决条件MVC 很好。

也就是说，与 ASP.NET MVC 相比，ASP.NET 的工作量要多得多。一些雇主正在寻找了解 MVC 的人，但他们主要这样做是因为他们正在寻找对学习新事物充满热情的人。我对 ASP.NET MVC 的担忧是我看不到如何将它与传统的 ASP.NET 应用程序集成。现实情况是，大多数工作都涉及使用现有代码库，而不是从头开始。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-16T17:43:40.817

从不同的角度处理 Asp.Net MVC 可能会有所帮助：阅读*Agile Web Development With Rails*这本书，跟随（使用 Rails 实现），并尝试在 ASP.Net MVC 中实现与该书中类似范围的项目.

您将很快掌握 Rails（每晚大约花费几个小时的一两个星期），并且对 Rails 约定的解释将引导您进入一种与 Asp.Net MVC 方式非常接近的思维方式。它可能会帮助您了解 MVC 的动机，并且您肯定会对 Asp.net MVC 中的“应该”如何工作有意见。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-15T15:49:57.000

我从一开始就一直在关注 ASP.Net MVC，我不得不说，我喜欢它。结合 Unity（或其他 DI 框架），它就可以很好地运行。无论如何，我一直喜欢某种关注点分离原则，并且喜欢 ASP.Net 而不是 PHP（和经典的 ASP）。不过，我并不总是喜欢 ASP.Net 的控制模式。MVC 更适合。使用 Json() 和 PartialView() 返回类型，与 jQuery.getJSON() 和 $("#mydiv").load() 交互在服务器端非常简化。在遵循 SOLID 设计原则时，它也能很好地工作......

它确实有助于对 HTML 和 JavaScript（AJAX、DHTML）有更多的交互点有一个扎实的理解。它也有助于从 MVC 模式的角度进行思考，或者不考虑让控制器和数据变得混乱。

我不太关心的一件事是缺乏内置的皮肤系统，用于网络应用程序上的多个皮肤。我已经解决了这个问题，并且拥有源代码真的很有帮助。我想说，正如其他人所建议的那样，关注 [Phil Haack](http://haacked.com)、 [Scott Guthrie](http://weblogs.asp.net/scottgu)和 [Scott Hanselman](http://hanselman.com/)的博客（并回读） 。他们都有重要的信息。除此之外，正如也提到的，[ASP.Net MVC 网站](http://asp.net/mvc)上的演示非常好。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-12-08T10:17:54.700

以前的所有帖子都很酷:) 但我想添加我自己的观点。如果没有一些基础的 asp.net 运行时机制，您就无法编写出好的应用程序。您可以从基本级别的 dino esposito 书（他有两本关于 asp.net 2.0 - 基础和高级级别的书）中获得此信息 - 有一章是关于处理传入请求的 - 你只能阅读这一章。

如果您知道什么是 httpapplication、httpruntime、request、response 等，请跳过我的回答。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-09-21T07:51:35.437

除了其他人推荐的书外，我建议以下两本书：

*   [Spring in Action](https://rads.stackoverflow.com/amzn/click/com/1933988134)：它不是 ASP.NET MVC，它是关于 Spring，但基础相似，而且写得非常好。
*   [Pro ASP.NET MVC 2 Framework](https://rads.stackoverflow.com/amzn/click/com/1430228865)：它以一种易于理解的方式解释了这些概念，并有助于将 DI 引入 ASP.NET MVC。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-01-10T06:00:10.050

ASP.Net MVC 的首要和基本的事情是路由概念。先好好学习一下。您还可以通过 System.Web.Routing 命名空间了解更多关于此的想法。路由只是告诉 IIS 存在对特定扩展的请求，然后重定向到此处理程序。

接下来是“约定优于配置”。对于 MVC，您需要具有特定的文件夹结构，例如 Controller、Model 和 Views。这里没有什么神秘的了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-12-08T20:22:49.700

我在 Ruby on Rails 工作的短暂时间里知道，回到 ASP.NET 并使用 MVC 很容易将我从 RoR 学到的知识应用到 ASP.NET MVC。说实话，ASP.NET MVC 实际上只是关于 VC 部分，而不是关于模型，因为 ASP.NET 不必非常基于 REST，而 RoR 实际上强制执行它。

我发现的问题是试图让人们在第一次从 ASP.NET 本身学习 MVC 时学习它的正确约定。就像其他人提到的那样，学习真正的 MVC 平台（在本例中为 RoR）可能是一个好主意，因为尝试将您对 ASP.NET 的了解应用于 MVC 架构。开始使用 RoR 的一个好地方是[http://railsforzombies.org/](http://railsforzombies.org/) 它也很有趣，并且会为您提供在理想的 REST MVC 场景中真正去哪里的基础知识。之后，将您所知道的应用到 MVC for ASP.NET。

# c# - 为活动预订系统建议类名

> ID：752040
> 
> 赞同：1
> 
> 时间：2009-04-15T14:44:57.857
> 
> 标签：c#, naming

我正在用 C# 编写一个 Event Booking 系统，这让我非常烦恼，因为“event”和“delegate”是保留字。“Delegate”我已更改为“Attendee”，但我想不出 Event 类（及其实例）的替代名称。我想出的最好的作品是“正在发生”，这对我来说有点 1970 年代的味道。另外，这些类将通过客户 API 公开，因此我必须使用专业术语。

任何建议将不胜感激。

编辑：困扰我的主要是实例和参数的命名：

```
public Booking CreateBooking(Event event, Person person); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T14:47:32.250

如果你真的想使用 C# 保留字，你可以在它前面加上'@'。

例如

```
public class @class
{
  ...
} 
```

谨慎使用...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T14:47:50.407

我会选择Event。类型名称区分大小写，因此事件和事件之间存在区别。这是（以我的拙见）对问题的最不混乱和最清晰的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T14:47:58.910

我个人只会使用`Event`. 这并不经常作为*类型*名称出现。一种选择*可能*是`Meeting`，但这取决于您正在谈论的事件类型。

事件确实*是*这里业务领域中的正确名称，通常用于日历。

如果你有经常性事件，你也会有例外。它们很有趣——是`EventException`经常性事件的例外，还是因为例外而未能做某事？

不过，这些都不能*触及*时区的乐趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T14:47:58.940

但是，事件是关键字，而不是事件（区分大小写）。为什么不使用事件？这似乎是这项工作的最佳名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T14:48:52.527

C# 区分大小写，为什么不使用“Event”（大写 E）呢？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T14:51:02.180

[thesaurus.reference.com 上的活动](http://thesaurus.reference.com/the?q=event)

或者考虑使用`Event`and `@event`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T15:00:12.627

您总是可以通过在您的课程前加上“C”（代表班级）来回退到老式命名

CEvent,CDelegate,CMyClass

# windows - 适用于 Windows 的最佳白名单 http 代理？

> ID：752047
> 
> 赞同：2
> 
> 时间：2009-04-15T14:46:20.023
> 
> 标签：windows, http, proxy, whitelist

我想在我的工作机器上设置一个 http 代理（没有管理员权限，WinXP），只允许访问 URL 白名单。什么是最简单的解决方案？如果可能的话，我更喜欢开源软件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T15:10:37.670

[Squid](http://www.squid-cache.org/)似乎是事实上的代理。此链接描述了如何在 Windows 盒子上进行设置：[http ://www.ausgamers.com/features/read/2638752](http://www.ausgamers.com/features/read/2638752)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T02:17:43.787

为什么不在 IE 中使用 Content Advisor？您可以提供已批准站点的列表，其他任何内容都会被阻止。还是您想要像真正的代理这样的直通功能？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T23:30:42.780

每次调用 javascript 函数时，内容顾问都会请求授权。至少这是我现在的经验，经过几个小时的谷歌搜索，我就是这样来到这里的。

但是，您是对的，如果白名单中的网站没有大量使用 javascript，我建议先尝试该选项，因为（而且我是一名 IT 人员），设置 Content Advisor 比设置代理更容易 FAAAAAAAAR服务器。谷歌“noaccess.rat”，你会看到文章告诉你如何使用白名单方法设置 IE。

然而，话虽如此，您必须充分意识到即使不知道密码也可以轻松禁用 Content Advisor。我的一位用户很快就做到了。你也可以在谷歌上找到这个。

亚历克斯

# sql - Access 中的 SQL 帮助 – 寻找数据的缺失

> ID：752048
> 
> 赞同：2
> 
> 时间：2009-04-15T14:46:25.233
> 
> 标签：sql, ms-access, derived-table

我试图找到最快的方法来查找父表中没有子表中某些记录的所有记录。例如，我希望查询返回没有男孩或根本没有孩子的所有家庭记录。

## 示例 1

这是非常缓慢的：

SELECT * FROM Families
WHERE Families.FamilyID NOT IN(SELECT FamilyID FROM Children WHERE Children.Gender="m")

## 示例 2

这更快：

SELECT * FROM Families
WHERE NOT EXISTS(SELECT * FROM Children WHERE Children.Gender="m" AND Children.FamilyID = Families.FamilyID)

## 示例 3

这是最快的，但我担心投资它，因为我找不到任何文档。我什至不知道它叫什么。由于缺少更好的术语，我们一直将其称为“匿名查询”。

SELECT * FROM Families
LEFT JOIN
**[SELECT * FROM Children WHERE Gender="m"]。**AS AliasChildren ON Families.FamilyID=AliasChildren.FamilyID
WHERE AliasChildren.FamilyID 为 NULL

所以我的问题是：

1.  在示例 3 中这个东西叫什么？
2.  是不是将来会支持的Access的“主流”功能？
3.  我在哪里可以找到它的文档（一旦我知道它叫什么，这可能会更容易）？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T15:00:00.020

示例 3 称为派生表，但您可以将查询简化为：

```
SELECT * FROM Families
LEFT JOIN
Children ON Families.FamilyID = Children.FamilyID AND Children.Gender="m"
WHERE Children.FamilyID IS NULL 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T14:51:28.293

**在示例 3 中这个东西叫什么？**
它被称为“派生表”

**是不是将来会支持的Access的“主流”功能？**
据我所知，它是 ANSI SQL 的标准特性，并且非常常用。

**我在哪里可以找到它的文档（一旦我知道它叫什么，这可能会更容易）？** 这是一篇关于他们的[博客文章](http://techahead.wordpress.com/2007/10/01/sql-derived-tables/)

无论如何，米奇提出的问题是你最好的选择：

```
SELECT *   
FROM Families   
LEFT JOIN Children  
  ON (Families.FamilyID = Children.FamilyID) AND (Children.Gender="m")  
WHERE (Children.FamilyID IS NULL) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T14:55:38.597

我想你也可以尝试这样的事情：

SELECT * FROM Families WHERE Families.FamilyID IN (SELECT Children.FamilyID FROM Children WHERE Children.Gender<>'m' GROUP BY Children.FamilyID)

# c# - LINQ - 加入多个列表

> ID：752051
> 
> 赞同：2
> 
> 时间：2009-04-15T14:47:01.783
> 
> 标签：c#, linq

我在[这里](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)查看了 101 个 Linq 示例，但在该列表中我看不到任何类似的东西。如果我在那里没有看到相关示例，请链接到它。

如果我有这 3 个课程：

```
class Student { int id; string name }
class Course { int id, string name }
class Enrolment { int studentId; int courseId; } 
```

如何使用 LINQ 获取学生注册的课程列表？（假设我有所有三个类的 IList）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T14:50:22.260

怎么样：

```
IEnumerable<Course> FindCoursesForStudent(Student student)
{
    return from enrolment in Enrolments 
           where enrolment.studentId == student.id
           join course in Courses
              on enrolment.courseId equals course.id
           select course;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-21T10:26:14.477

不是一个明确的答案，但可能隐含地有助于构建您的系统。

您是否考虑过像这样更丰富的域模型：

```
class Student { int id; string name; IEnumerable<Enrolment> enrolments }
class Course { int id, string name; }
class Enrolment { Student student; Course course; } 
```

?

Student 类可以有一个 GetEnroledCourses() 方法，如下所示：

```
public IEnumerable<Course> GetEnroledCourses()
{
   return enrolements.Select(enrolement => enrolement.Course).ToList().AsReadonly();
} 
```

在某些情况下，仅与数据库进行一对一映射的模型就足够了，但是如果您有复杂的业务逻辑，例如[“贫血的域模型”](http://martinfowler.com/bliki/AnemicDomainModel.html)可能会咬您一口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T14:50:45.907

```
var courses = (from course in courseList 
    join enr in enrolmentList on enr.courseId equals course.id 
    where enr.studentId = <student id variable> 
    select course); 
```

# asp.net - 是否可以从浏览器中获取收藏夹列表？

> ID：752060
> 
> 赞同：0
> 
> 时间：2009-04-15T14:48:14.853
> 
> 标签：asp.net, asp.net-2.0

是否可以使用 asp.net 读取用户的收藏夹列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T14:52:58.570

这将侵犯访问者的隐私。你需要一个他们在本地安装的浏览器组件来做这样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:55:09.953

ASP.NET 在技术上是一种服务器端技术......它确实允许您输出 html 和 javascript，但更简洁地说，您的问题应该是：

“是否可以通过 javascript 读取用户的收藏夹（书签）？”

因为您需要一个客户端脚本来执行此操作。

不幸的是，对你来说，这个问题的答案是否定的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T14:56:58.810

上帝，我希望不会。如果是这样，他们需要立即解决这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T15:02:05.927

我不这么认为，ASP.net 在服务器端而不是在客户端，所以我确定没有插件就不可能做到这一点（我什至不确定你是否可以使用 javascript 来做到这一点），在一些社交网络提供的 firefox 上具体插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T15:05:25.890

可能吗？是的。

是否有可能无需用户接受组件安装？不。

是否可以只使用 ASP.NET 而不在客户端上运行代码？不。

您必须创建在浏览器中运行的诸如 ActiveX 组件或 Java 小程序之类的东西。该组件必须检查不同的浏览器和每个浏览器的不同版本，才能知道收藏夹的存储位置。一些浏览器可能会以几乎无法读取它们的方式存储它们。

# sql-server - LINQ 和存储过程之间的性能差异

> ID：752064
> 
> 赞同：16
> 
> 时间：2009-04-15T14:49:11.747
> 
> 标签：sql-server, linq, stored-procedures

### 有关的

> [LINQ-to-SQL 与存储过程？](https://stackoverflow.com/questions/14530/linq-to-sql-vs-stored-procedures)

我已经听到很多关于预编译存储过程的优点的讨论。但是，LINQ 和存储过程在选择、插入、更新、删除方面的实际性能差异是什么？有没有人进行过任何测试，看看是否有任何重大差异。我也很好奇更多的交易是否会产生影响。

我的猜测是 LINQ 语句在第一个事务之后被缓存，性能可能几乎相同。想法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-15T15:01:35.383

LINQ 的性能应该接近，但我不同意上面的说法，即 LINQ 更快，它不可能更快，但它可能同样快，所有其他条件都相同。

我认为不同之处在于，一个知道如何优化并使用存储过程的优秀 SQL 开发人员总是会在性能上略有优势。如果你的 SQL 不强，让 Linq 帮你解决，你的表现很可能会被接受。如果你是一个强大的 SQL 开发人员，如果你的应用程序需要它，可以使用存储过程来挤出一点额外的性能。

如果您编写糟糕的 SQL 来编写一些执行速度比 Linq 慢的存储过程，那当然是可能的，但是如果您知道自己在做什么，那么存储过程和 Datareader 就无可匹敌。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-21T05:35:20.893

与 LINQ 查询相比，存储过程更快，它们可以充分利用 SQL 功能。下次执行存储过程时，数据库使用缓存的执行计划来执行该存储过程。而每次都编译 LINQ 查询。因此，与存储过程相比，LINQ 查询需要更多的执行时间。

与 LINQ 相比，存储过程是编写复杂查询的最佳方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T14:54:24.357

LINQ 查询也可以（并且应该）预编译。我没有任何基准可以与您分享，但我认为每个人都应该阅读[这篇文章](http://aspguy.wordpress.com/2008/08/15/speed-up-linq-to-sql-with-compiled-linq-queries/)以供参考以了解如何做到这一点。我特别有兴趣看到预编译的 LINQ 查询与 SPROCS 的一些比较。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-15T14:58:04.190

除了当您有大量数据并且您需要一些数据库调整时 LINQ 可能会降级之外，没有太大区别。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T14:53:52.640

除了生成器可能无法以最佳方式优化查询之外，LINQ2SQL 查询的执行方式与任何其他即席参数化 SQL 查询的执行方式没有任何不同。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T15:36:58.683

普遍的看法是即席 sql 查询比存储过程执行得更好。然而，这是错误的：

> SQL Server 2000 和 SQL Server 7.0 版对语句处理进行了许多更改，将存储过程的许多性能优势扩展到所有 SQL 语句。SQL Server 2000 和 SQL Server 7.0 在创建存储过程时不保存部分编译的计划。存储过程在执行时编译，就像任何其他 Transact-SQL 语句一样。SQL Server 2000 和 SQL Server 7.0 在过程缓存中保留所有 SQL 语句的执行计划，而不仅仅是存储过程执行计划。
> 
> -- [SqlServer 的在线书籍](http://msdn.microsoft.com/en-us/library/aa174792.aspx)

鉴于上述情况以及 LINQ 生成即席查询的事实，我的结论是存储过程和 LINQ 之间没有性能差异。而且我也倾向于相信 SQL Server 在查询性能方面不会倒退。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-21T16:24:17.457

Linq 应该用于在 sql 或 oracle 中创建的视图之上的业务逻辑层。Linq 帮助您为业务逻辑插入另一层，其维护由编码人员或非 sql 人员负责。它的性能肯定不如 sql 因为它没有预编译，你可以在 sps 中执行很多不同的事情。但是您绝对可以添加编程细节并使用 Linq 将业务逻辑与核心 sql 表和数据库对象隔离开来。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T14:53:04.420

请参阅[LINQ-to-SQL vs 存储过程](https://stackoverflow.com/questions/14530/linq-to-sql-vs-stored-procedures)以获得帮助 - 我认为该帖子包含大部分信息。你需要。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T15:32:53.547

除非您试图从应用程序中获取每一毫秒，否则可能需要根据您希望开发人员了解的内容和可维护性来确定是使用存储过程还是使用 LINQ。

存储过程会很快，但是当您积极开发应用程序时，您可能会发现 LINQ 的易用性可能是一个积极的方面，因为您可以非常快速地更改查询和从 LINQ 创建的匿名类型。

一旦你完成了应用程序的编写并且你知道你需要什么，并开始考虑优化它，那么你可以看看其他技术，如果你有很好的单元测试，那么你应该能够比较不同的技术并确定哪个解决方案是最好的。

您可能会发现 .NET 3.5 与数据库交互的各种方式的比较很有用。 [http://toomanylayers.blogspot.com/2009/01/entity-framework-and-linq-to-sql.html](http://toomanylayers.blogspot.com/2009/01/entity-framework-and-linq-to-sql.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-10-05T00:03:24.463

我不认为我希望在编译代码中拥有我的数据库层。它应该是一个单独的层而不是合并。在我开发和使用敏捷的过程中，我不断地改变数据库设计，而且这个过程进行得非常快。在 SQL Server 中添加列、删除列或创建新表就像在 Excel 中输入一样简单。在数据库级别对表进行规范化或反规范化也非常快。现在使用 Linq，我每次更改数据库时都必须更改对象表示，或者忍受它不能真正反映数据的存储方式。这是很多额外的工作。

我听说 Linq 实体可以保护您的应用程序免受数据库更改的影响，但这没有意义。数据库设计和应用程序设计需要齐头并进。如果我规范化几个表或对数据库进行其他一些重新设计，我不希望 Linq 对象模型不再反映实际的数据库设计。

那么调整视图或存储过程的优势呢？您可以直接在数据库级别执行此操作，而无需重新编译代码并将其发布到生产环境中。如果我有一个显示来自多个表的数据的视图，并且我决定更改数据库设计，那么我所要做的就是更改该视图。我所有的代码都保持不变。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2010-08-18T13:45:57.083

考虑一个具有一百万个条目的数据库表，连接到另一个具有一百万个条目的表...您是否真的认为在网络服务器上执行此操作（无论是在 LINQ 还是 ad-hoc SQL 中）会比让 SQL Server 在数据库上做这件事？

对于简单的查询，LINQ显然更好，因为它会预编译，给你类型检查等优势。然而，对于任何需要做的密集的数据库操作，报表构建，批量数据分析，存储过程将胜出把手放下。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2012-01-31T11:37:17.643

`<script>alert("hello") </script>`我认为在网络服务器上执行此操作（无论是在 LINQ 还是 ad-hoc SQL 中）会比让 SQL Server 在数据库上执行此操作更快或更有效？

对于简单的查询，LINQ显然更好，因为它会预编译，给你类型检查等优势。然而，对于任何需要做的密集的数据库操作，报表构建，批量数据分析，存储过程将胜出放下手

# iphone - 从包含 img 标签的 iPhone 应用程序发送电子邮件

> ID：752107
> 
> 赞同：0
> 
> 时间：2009-04-15T14:59:04.640
> 
> 标签：iphone

我正在尝试从我的本机应用程序将用户发送到邮件应用程序。我想在邮件正文中嵌入一个标签。我知道这是可能的，因为“LOL Cats”应用程序可以做到这一点。我一直在尝试但没有成功：

```
 NSString *url1 = [NSString stringWithFormat:@"mailto:email@email.com?subject=Check%20Out%20This%20Faux%20Screen&body=<img%20src=\"http://www.sample.com/FauxFoneServer/screenShot/getScreenByID?cur=%@\"/>The%20awesome%20person%20who%20sent%20you%20this%20email%20thinks%20you%20should%20visit%20http://www.fauxscreen.com"
                         ,[ScreenShotsAppDelegate sharedDelegate].viewController.curImage.imageID];
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:url1]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T16:21:10.903

调用 openURL 时会发生什么？

您可以尝试对引号 (%22)、小于 (%3C) 和大于 (%3E) 字符进行编码。

# c# - 如何获取 IE 凭据以在我的代码中使用？

> ID：752108
> 
> 赞同：2
> 
> 时间：2009-04-15T14:59:05.793
> 
> 标签：c#, screen-scraping, webrequest

我目前正在使用[SpicIE](http://code.msdn.microsoft.com/SpicIE)开发一个 IE 插件。

这个插件执行一些类似于 MSDN 上发布的示例的网络抓取：

```
WebRequest request = WebRequest.Create ("http://www.contoso.com/default.html");

request.Credentials = CredentialCache.DefaultCredentials;

HttpWebResponse response = (HttpWebResponse)request.GetResponse ();

Stream dataStream = response.GetResponseStream ();

StreamReader reader = new StreamReader (dataStream);

string responseFromServer = reader.ReadToEnd ();

reader.Close ();
dataStream.Close ();
response.Close (); 
```

但是，当我运行此代码时，我收到以下错误消息：

> 远程服务器返回错误：(407) 需要代理身份验证。

我目前正在代理服务器后面工作，并使用**NetworkCredential**类手动提供我的网络凭据

```
request.Credentials = new System.Net.NetworkCredential("name", "password", "domain"); 
```

但我仍然收到同样的错误。

即使我的问题解决了，我也知道该插件的某些用户将在代理服务器后面。

**我想知道如何获取 IE 凭据并在我的代码中使用它来将其分配给 request.Credentials**。

也许是这样的：

```
request.Credentials = IE.DefaultCredentials; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T15:03:04.070

您正在设置*站点*的凭据，但您需要*代理*的凭据。

设置[`request.Proxy.Credentials`](http://msdn.microsoft.com/en-us/library/system.net.iwebproxy.credentials.aspx)。

（另外，使用`using`响应/流/阅读器的语句而不是手动关闭它们，否则当抛出异常时它们会泄漏。）

编辑：例如，要使用代理的默认凭据：

```
request.Proxy.Credentials = CredentialCache.DefaultCredentials; 
```

# asp.net - ASP.net Delphi 动态图像按钮 onclick 事件

> ID：752119
> 
> 赞同：1
> 
> 时间：2009-04-15T15:01:29.690
> 
> 标签：asp.net, delphi, dynamic, click, imagebutton

我在使用旧的 delphi.net 应用程序时遇到了一些麻烦。

我需要在页面上的特定位置显示一些缩略图，并且当用户单击图像时显示图像。

图像相当小，所以我没有为缩略图生成而烦恼。

问题是我无法让 onclick 事件正常工作。

这是我的代码：（这是在 page_load 事件中）

```
filer := Directory.GetFiles(dirstr,soegestr);
for f in filer do
begin
   img := ImageButton.Create;
   img.ImageUrl := f;
   img.Width := 30;
   img.Height := 50;
   img.Style.Add('margin-right','10px');
   include(img.Click, FragtbrevsBilledeClick);
   PanelBilleder.Controls.Add(img);
end; 
```

包括什么也不做。onclick 事件只是触发回发。

FragtbrevsClick 定义如下：

```
procedure TWebForm1.FragtbrevsBilledeClick(Sender: TObject;
   e: ImageClickEventArgs);
begin
  Response.Redirect((sender as ImageButton).ImageUrl);
end; 
```

在 fragtbrevs 点击中设置断点永远不会被击中。

我不是一个规范的网络开发人员，所以也欢迎使用其他方法来解决问题！:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-10T23:31:23.477

您需要做的就是设置 ImageButton 的 PostBackURL 属性（以及您喜欢的任何其他属性）。不需要 Click 事件处理程序。单击该按钮时，它将自动重定向到 PostBackURL 位置。这应该足够了，因为您没有在 FragtbrevsBilledeClick 事件处理程序中执行任何其他操作。

# java - java Swing 用 Wacom 数位板调试头疼

> ID：752121
> 
> 赞同：4
> 
> 时间：2009-04-15T15:01:49.593
> 
> 标签：java, swing, wacom, pen-tablet

几年来，我在几个 Java 应用程序中遇到了 Java Swing + 我的 Wacom Graphire 数位板的问题，现在我自己也遇到了。

我在单击鼠标时使用数位板来解决手腕问题，它在 Windows 下运行良好，除非我使用 Java 应用程序。在 Java 应用程序中，单击笔无法正常工作。（通常问题只出现在文件选择对话框或树形控件上。）数位板还附带一个无线鼠标，可与同一个数位板配合使用，单击即可正常工作。

我不知道问题出在 WACOM 驱动程序中还是在 Windows 的 Java Swing 运行时中，或者两者兼而有之。有没有人遇到过这个？我想向 WACOM 提交错误报告，但我不知道该告诉他们什么。

我已经能够在我自己的应用程序中重现这一点，该应用程序有一个 JEditorPane 和一个我添加了 HyperlinkListener 的 HTML 文档。我每次用鼠标单击都会收到 HyperlinkEvent.ACTIVATED 事件，但每次用笔单击时我都不会收到 HyperlinkEvent.ACTIVATED 事件。

笔和鼠标之间的一个很大区别是，当您单击鼠标上的按钮时，很容易在没有鼠标移动的情况下引起按钮单击。在数位板上很难做到这一点，这似乎与缺少 HyperlinkEvent.ACTIVATED 事件有关——如果我在点击数位板时非常小心不要移动笔位置，我想我可以激活事件。

有什么建议可以尝试，以便我可以向 WACOM 提供有关此错误的一些有用信息？无法将我的笔用于 Java 应用程序真的很令人沮丧，特别是因为笔可以在“常规”Windows（非 Java）应用程序中正常工作。

通常我不会在这里问这个问题，但我想从**程序员的**角度找出可能发生的事情，以便我可以提交一份好的错误报告。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T15:15:08.267

您应该做的是添加一个`mouseListener`并查看它何时注册一个`mouseClicked()`, `mousePressed()`,`mouseReleased()`事件。我不确定秋千是否将平板笔读取为鼠标。但是，它应该让您对实际发生的事情有所了解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T15:39:37.680

我尝试了曼哈顿博士的建议，它就像一个魅力。我正确地得到了 mousePressed/mouseReleased 事件；mouseClicked 事件总是发生在数位板鼠标上，但 mouseClicked 事件不会发生在笔上，除非我设法让笔保持静止。即使是 1 像素的移动也足以让它失败。我想我应该为此责怪Java：没有办法为可接受的移动指定“点击半径”。

```
package com.example.bugs;

import java.awt.Dimension;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;

import javax.swing.JFrame;

public class WacomMouseClickBug {
    public static void main(String[] args) {
        JFrame jframe = new JFrame();

        jframe.addMouseListener(new MouseListener(){
            @Override public void mouseClicked(MouseEvent event) {
                System.out.println("mouseClicked: "+event);
            }
            @Override public void mouseEntered(MouseEvent event) {}
            @Override public void mouseExited(MouseEvent event) {}
            @Override public void mousePressed(MouseEvent event) {
                System.out.println("mousePressed: "+event);
            }
            @Override public void mouseReleased(MouseEvent event) {
                System.out.println("mouseReleased: "+event);                
            }           
        });

        jframe.setPreferredSize(new Dimension(400,400));        
        jframe.pack();
        jframe.setLocationRelativeTo(null);
        jframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        jframe.setVisible(true);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T15:17:33.723

我想你自己已经得到了答案：移动笔会导致其他事件，而不是简单的单击，也许可能是拖放式事件。我不确定这是 Java/Swing 还是 Wacom 问题，可能是平板电脑没有将点击注册为拖动事件，或者可能是 Swing 错误地解释了事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-20T18:38:52.213

多年前我向 Sun 报告了这个错误。它仍然没有修复。任何体面的 ui 框架都将允许在按下和释放之间进行一些移动以生成点击事件。在高 dpi 显示器上最大移动 1 像素简直是荒谬的。这不仅是 wacom 数位板的问题，即老年人在单击时也难以保持鼠标不动。

# sql - 从 multilpe 表和数据库中查询数据的最佳方法是什么？

> ID：752123
> 
> 赞同：2
> 
> 时间：2009-04-15T15:02:06.210
> 
> 标签：sql, sql-server, sql-server-2000

我有 5 个代表该国不同地区的数据库。在每个数据库中，有几百个表，每个表有 10,000-2,000,000 条事务记录。每个表都代表相应地区的客户。这些表中的每一个都具有相同的架构。

我想查询所有表，就好像它们是一张表一样。我能想到的唯一方法是创建一个合并所有表的视图，然后针对它运行我的查询。但是，客户表会一直变化（随着我们获得和失去客户），所以我必须更改我的视图的查询以包含新表（或删除不再使用的表）。

有没有更好的办法？

## 编辑

作为对评论的回应，（我也将其发布为对答案的回应）：

在大多数情况下，我不会删除任何表格，它们将保留用于历史目的。正如我在对一个回复的评论中发布的那样，这个想法是为了减少小客户（一个只有 10,000 条记录）查询他们自己的历史记录的时间。大约有 1000 名客户，平均每件有 1,000,000 行（并且还在增长）。如果我将所有记录添加到一个表中，我将在该表中拥有近十亿条记录。我还以为我在为未来做计划，因为当我们有 5000 名客户时，我们没有一张巨大的桌子来保存所有交易记录（这可能是我的想法的错误）。那么，像我这样划分记录是不是更好呢？我应该把它们全部捣碎成一张桌子吗？客户 ID 上的索引是否会防止延迟查询较小客户的数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T15:05:10.523

我认为您的设计可能会损坏。为什么不使用包含区域和客户列的单个表？

如果我是你，我会考虑重构为一个表，并且如果有必要（例如为了反向兼容性），我会使用视图来提供与之前表中相同的信息。

* * *

编辑以回答对此帖子的 OP 评论：

只要您使用正确的索引，一张包含 10 000 000 000 行的表就可以了。数据库服务器是为应对这种容量而构建的。

**性能绝对不是将一个这样的表拆分成数千个较小的表的正当理由！**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T15:08:36.753

同意布兰，

这是一个疯狂的数据库架构设计。您为什么不使用（或更改为）单个规范化结构，该结构具有按区域过滤的列以及将区域数据库中的每个表分开的任何条件。

在该结构中，您会遇到一些非常大（约 500 个表）的联合视图，当新表出现在系统中时，您必须定期动态地重新生成这些视图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T15:08:47.613

**如果有几百个表**并且**每个表都具有相同的模式**，那么这个系统的架构看起来需要一种截然不同的方法

 **为什么要添加或删除表格？在任何正常情况下都不应该发生这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T15:21:24.383

2 个解决方案 1\. 编写一个存储过程，通过解析 5 个数据库中的所有表名来为您构建视图，并使用联合构建视图，就像您手动完成一样。

2.  创建一个包含一个表的新数据库，并在每个示例中每晚导入该表中所有表的所有记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T15:32:42.673

听起来你被困在多租户和单租户数据库 shema 之间。具体来说，您将其存储为“轻量级”多租户（单独的表与单独的数据库），但将其作为单租户进行查询，一个查询来统治它们。

在短期内，让您的数据访问层动态选择要查询的表，而不是将所有内容合并在一起以进行一个超级查询。

从长远来看，选择一种方法并坚持下去。一个数据库和一个表或多个数据库。

这里有一些关于这个主题的帖子。

[为每个客户使用单一数据库有什么优势？](https://stackoverflow.com/questions/13348/what-are-the-advantages-of-using-a-single-database-for-each-client)

[http://msdn.microsoft.com/en-us/library/aa479086.aspx](http://msdn.microsoft.com/en-us/library/aa479086.aspx)

# c# - 基本 LinqToSql 问题：为什么不能编译？

> ID：752135
> 
> 赞同：4
> 
> 时间：2009-04-15T15:05:12.020
> 
> 标签：c#, linq-to-sql

最近，我通过工作中的一个糟糕的项目向自己介绍了 LinqToSQL。我很好奇为什么会这样：

```
var territories = db.Territories.Where(t => t.PendingUserCount > 0); 
```

但这会导致编译错误：

```
var territories = db.Territories;
if (someCondition)
    territories = territories.Where(t => t.PendingUserCount > 0);
// Cannot implicitly convert 'System.Linq.IQueryable<Territory> to System.Data.Linq.Table<Territory> 
```

我也试过打电话`db.Territories.ToList()`，但无济于事。

我敢肯定这只是对 Linq 工作方式的误解，但如果有人能帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T15:07:47.427

db.Territories 返回一个表对象。因此，“var”将是 System.Data.Linq.Table 类型。稍后您尝试（基于某些条件）将 System.Linq.IQueryable 类型的内容分配给变量。由于 .NET 是强类型的，因此编译器会引发错误。

var 类型的变量将在第一次被分配时被分配一个类型。这就是我试图记住自己的方式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T15:09:14.523

对于这种类型的累积`Where`，你需要告诉编译器使用`IQueryable<T>`：

```
IQueryable<Territory> territories = db.Territories;
if (someCondition)
    territories = territories.Where(t => t.PendingUserCount > 0);
... etc 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-15T15:17:03.067

选择：

```
var territories = db.Territories.AsQueryable();
if (someCondition)
    territories = territories.Where(t => t.PendingUserCount > 0); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-15T15:11:30.197

改成这个

```
var territories = db.Territories; 
```

到

```
IQueryable territories = db.Territories.Where(t => t.PendingUserCount > 0); 
```

原因是通过调用 db.Territories，您可以取回所有数据，并将其返回到 linq.table 对象中。Db.Territores.where(... 将返回一个 IQueryable 对象。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T15:10:05.207

关于“var”的一个可能令人困惑的事情是它的类型是在编译时确定的，所以你不能为它分配一系列不同的类型。有动态语言经验的人，比如 Python，起初有时会对此感到困惑。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T15:08:50.187

您最初`var territories`输入为 a `System.Data.Linq.Table<Territory>`，然后您尝试将`Where`子句（类型为`System.Linq.IQueryable<Territory>`）的结果分配给它。

请记住，编译器`var`在分配时推断 a 的类型，因此一旦分配，类型就无法更改。

尝试这样的事情：

```
System.Linq.IQueryable<Territory> territories;
if (someCondition)
    territories = db.Territories.Where(t => t.PendingUserCount > 0); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T15:08:25.227

因为您已将“var”键入为 Table `<Territory`>，然后尝试将其重新分配为 IQueryable `<Territory`>。

这相当于说

```
 var i = 0

  i = "a string"; 
```

编辑：澄清一下，与动态类型的脚本语言不同，var 在编译时而不是运行时是隐式强类型的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T15:08:58.313

您需要像其他人建议的那样使用 IQueryable 类型：

这个 linq 查询也可能有效：

```
var query = from territories in db.Territories
            where territories.SomeProperty == SomeCondition
            where territories.PendingUserCount > 0
            select territories; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T15:09:55.207

声明 var 后，您不能将其重新分配给不同的类型。因此，您的 var 声明已经将其输入到 System.Data.Linq.Table。

这是一次火灾。

# sql-server - SSIS - 查找父项的代理键

> ID：752140
> 
> 赞同：0
> 
> 时间：2009-04-15T15:07:41.703
> 
> 标签：sql-server, ssis

我的源数据库中有一个自引用的表

|企业ID|...|父ID|

此表在 DW 中建模为 |SurrogateID|BusinessID|ParentID|

第一个问题是，DW 中的 ParentID 应该引用代理 id 还是业务 id。我的想法是它应该引用代理ID。

然后我的问题出现了，在我的 SSIS 数据流任务中，如何查找父级的代理键？

如果我先插入 ParentID 为空的所有行，然后插入不为空的行，我解决了部分问题。

但我仍然必须查找可能引用也是孩子的父母的行。

即我必须确保首先将父母加载到数据库中才能使用查找转换。

我是否必须使用排序输入来解决 for-each ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T16:18:52.500

我在这种情况下使用的一个技巧是加载没有 ParentID 的行。然后，我使用另一个数据流根据源数据和加载的数据创建更新脚本，然后使用 SQL 任务运行创建的更新脚本。它不会因优雅而获奖，但它确实有效。

# javascript - Wordpress 自定义插件（如何调用多个 javascript 文件）

> ID：752142
> 
> 赞同：1
> 
> 时间：2009-04-15T15:08:00.860
> 
> 标签：javascript, wordpress

我决定尝试创建一个插件，使用 Wordpress 插件生成器调用几个 javascript 文件和一个 css 文件。它有点工作 - 它正在调用其中一个 javascript 文件，而不是另外两个。

我正在使用 wp_enqueue_script 函数，但可能是错误的。任何帮助将不胜感激！

```
<?php

/*
Plugin Name: Tab Header Code
Plugin URI: [insert the plugin uri here]
Description: Inserts appropriate javascript and css libraries for tabs
Author: Jesse Wallace
Version: 0.1
Author URI: http://www.enticent.com
Generated At: www.wp-fun.co.uk;
*/ 

if (!class_exists('tabstyles')) {
    class tabstyles {

    /**
    * PHP 4 Compatible Constructor
    */

    function tabstyles(){$this->__construct();}

    /**
    * PHP 5 Constructor
    */      

    function __construct(){
    add_action("init", array(&amp;$this,"add_script1"));
    add_action("init", array(&amp;$this,"add_script2"));
    add_action("init", array(&amp;$this,"add_script3"));
    add_action("wp_head", array(&amp;$this,"add_css"));
    }

    /**
    * Tells WordPress to load the scripts
    */

    function add_script1(){
    wp_enqueue_script('tab_header_code_script1', '/wp-content/plugins/tab-header-code/js/tabview-min.js', NULL , 0.1);
    }

    function add_script2(){
    wp_enqueue_script('tab_header_code_script2', '/wp-content/plugins/tab-header-code/js/element-min.js', NULL , 0.1);
    }

    function add_script3(){
    wp_enqueue_script('tab_header_code_script3', '/wp-content/plugins/tab-header-code/js/yahoo-dom-event.js', NULL , 0.1);
    }

    /**
    * Adds a link to the stylesheet to the header
    */

    function add_css(){
    echo '<link rel="stylesheet" href="'.get_bloginfo('wpurl').'/wp-content/plugins/tab-header-code/css/tabstyle.css" type="text/css" media="screen"  />';
    }
}
}

//instantiate the class
if (class_exists('tabstyles')) {
    $tabstyles = new tabstyles();
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T05:01:53.373

wp_enqueue_script 是正确的做法。您可以执行 Scott 建议的相同操作，但 wp_enqueue_script 的目的是避免冲突，这是 WP 自动处理的。

你是在前端还是后端加载这个？

如果是后端，我强烈建议您将 JS 文件限制为仅在插件页面上加载，您可以这样做：

```
add_action('admin_menu', 'add_pages');

function add_pages() {
    $my_plugin_page = add_menu_page('Plugin Name', 'Plugin Name',  8,__FILE__, 'invoice_overview',"images/plugin_icon.png");

    // This is the trick, notice the "$my_plugin_page" being tacked on the end of admin_print_scripts
    add_action( "admin_print_scripts-$my_plugin_page", 'admin_head');

}

function admin_head() {
    global $path_to_your_files;

    // You may notice array('jquery') at the end, that means jQuery is required to make that particular file function, and WP will include it automatically
    wp_enqueue_script('jquery.whatever',$path_to_your_files . "/js/jquery.whatever.js", array('jquery'));
    wp_enqueue_script('jquery.autocomplete',$path_to_your_files . "/js/jquery.autocomplete.js", array('jquery'));
    wp_enqueue_script('your_custom_file',$path_to_your_files . "/js/your_custom_file.js", array('jquery'));

} 
```

对于前端而言，将您的 JS 文件隔离到特定页面更加困难。插入 js 文件的正确方法是类似的，除了我通常将它们加载到 init 中，就像你做的那样。

还有一件事，在你的 PHP 代码中使用 __construct 时要小心，因为它在 PHP4 中不起作用，如果你打算分发你的插件，请记住有些人仍在使用 PHP4。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T18:36:29.190

我认为正确的方法应该是这样的：

```
<?php

if (!class_exists('tabstyles')) {
    class tabstyles {

        /**
        * PHP 4 Compatible Constructor
        */

        function tabstyles(){$this->__construct();}

        /**
        * PHP 5 Constructor
        */              

        function __construct(){
            add_action("init", array(&$this,"on_init"));
        }

        /**
        * Tells WordPress to load the scripts
        */

        function on_init(){
            // scripts
            wp_enqueue_script('tab-view-min', get_bloginfo('wpurl').'/wp-content/plugins/tab-header-code/js/tabview-min.js');
            wp_enqueue_script('element-min', get_bloginfo('wpurl').'/wp-content/plugins/tab-header-code/js/element-min.js');
            wp_enqueue_script('yahoo-dom-event', get_bloginfo('wpurl').'/wp-content/plugins/tab-header-code/js/yahoo-dom-event.js');

            //css
            wp_enqueue_style('tabstyle', get_bloginfo('wpurl').'/wp-content/plugins/tab-header-code/css/tabstyle.css');

        }

    }
}

//instantiate the class
if (class_exists('tabstyles')) {
    $tabstyles = new tabstyles();
} 
```

?>

我更像是一个主题开发者而不是插件开发者，但我认为你可以从一个回调中将所有内容加入队列。

干杯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T18:20:35.880

为什么不使用

```
add_action('wp_head', 'insert_head'); 
```

然后有一个 insert_js 功能

```
function insert_head() {
    ?>
    <script type="text/javascript" src="<?php bloginfo('wpurl') ?>/wp-content/plugins/tab-header-code/js/tabview-min.js"></script>
    <script type="text/javascript" src="<?php bloginfo('wpurl') ?>/wp-content/plugins/tab-header-code/js/element-min.js"></script>
    <script type="text/javascript" src="<?php bloginfo('wpurl') ?>/wp-content/plugins/tab-header-code/js/yahoo-dom-event.js"></script>
    <link type="text/css" src="<?php bloginfo('wpurl') ?>/wp-content/plugins/tab-header-code/css/tabstyle.csss"></link>
    <?php
} 
```

# c# - 在 C# 中使用自定义千位分隔符

> ID：752145
> 
> 赞同：40
> 
> 时间：2009-04-15T15:08:29.627
> 
> 标签：c#, formatting, text-formatting

我试图在显示字符串时不使用 ',' 字符作为千位分隔符，而是使用空格。我想我需要定义一种自定义文化，但我似乎没有做对。任何指针？

例如：将 1000000 显示为 1 000 000 而不是 1,000,000

（不，`String.Replace()`不是我想使用的解决方案：P）

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-04-15T15:12:00.663

我建议你找到一个[`NumberFormatInfo`](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.aspx)最接近你想要的（即它与千位分隔符分开），调用[`Clone()`](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.clone.aspx)它然后设置[`NumberGroupSeparator`](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.numbergroupseparator.aspx)属性。（如果您要使用货币格式来格式化数字，您需要[`CurrencyGroupSeparator`](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.currencygroupseparator.aspx)改为/也进行更改。）将其用作调用`string.Format`etc 的格式信息，您应该没问题。例如：

```
using System;
using System.Globalization;

class Test
{
    static void Main()
    {
        NumberFormatInfo nfi = (NumberFormatInfo)
            CultureInfo.InvariantCulture.NumberFormat.Clone();
        nfi.NumberGroupSeparator = " ";

        Console.WriteLine(12345.ToString("n", nfi)); // 12 345.00
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-15T15:12:08.913

使用不同的千位分隔符创建您自己的[NumberFormatInfo （导数）。](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo(VS.71).aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-01-24T13:14:35.263

Jon Skeet one 有一个稍微简单的版本：

```
using System;
using System.Globalization;

class Test
{
    static void Main()
    {
        NumberFormatInfo nfi = new NumberFormatInfo {NumberGroupSeparator = " ", NumberDecimalDigits = 0};

        Console.WriteLine(12345678.ToString("n", nfi)); // 12 345 678
    }
} 
```

并且可以跳过“nfi”初始化并将其作为参数直接放入 ToString() 方法中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-15T15:18:55.763

最简单的方法...

```
num.ToString("### ### ### ### ##0.00") 
```

# .net - dll 的 FileVersion 和 ProductVersion 有什么区别？

> ID：752162
> 
> 赞同：47
> 
> 时间：2009-04-15T15:11:08.793
> 
> 标签：.net, versioning

dll 的 FileVersion 和 ProductVersion 有什么区别？

特别是在运行时，一个用于强绑定，另一个用于提供信息？

我想手动设置一组，另一组自动递增（通过我们的 CI 构建过程）

编辑：理查德回答了我在原始问题中错过的部分。它是我想要手动控制的程序集版本（随着界面更改而增加），而它是文件版本，我希望我的 CI 系统在每次构建时自动增加。谢谢。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-15T15:34:11.857

文件作为更大项目的一部分分发。具有单独构建版本 x 的文件可能会作为项目版本 y 的一部分分发。

详细说明：产品版本 1.1 的 A.exe 附带文件 B.dll 和 C.dll。所有这些都从匹配的产品和文件版本开始。然后有人在产品中发现了一个严重的错误。开发人员查看了它，并发布了仅更新 B.dll 的修复程序。现在产品版本可能也会更新到 1.1.1 以解决小问题。B.dll 的文件版本也将是 1.1.1。但是 A.exe 和 C.dll 没有改变，所以它们的文件版本可能仍然是 1.1。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-04-15T15:21:49.093

两者都不用于强绑定（完整/强名称的版本方面来自`AssemblyVersion`属性）。

文件版本（来自 AssemblyFileVersion 属性）和产品版本（来自 AssemblyInformationalVersion 属性）都对版本资源有贡献（如资源管理器的文件属性中所示）。

除了显示/诊断目的之外，唯一真正的用途是安装程序验证文件应该被替换。

附录：为什么这些会有所不同？答：由于版本控制要求。保持程序集版本相同意味着更新版本（具有更高文件版本）将绑定而不更改。这对序列化（例如持久化工作流）有很大影响。

如果所讨论的程序集不只是一个产品的一部分（例如，可重用的第三方库），文件和产品版本可能会有所不同，如果只是在单个应用程序中使用，似乎没有理由不保持它们相同。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-02-25T08:14:46.940

这两者之间还有一个区别：在文件版本中，您只能在版本部分中使用等于或大于 0 的整数。

在产品版本中，您可以使用任何文本，如果它不会解析为数字，则会产生警告，但根据 msdn 的警告是无害的。

现在为什么你不仅在版本中使用数字？
好吧，根据语义版本控制（semver.org），版本看起来像这样：[Major].[Minor].[Patch] 并且在补丁中你可以使用：

*   dash 之后的预发布元数据，例如 1.2.1-beta
*   在加之后构建元数据，例如来自 git 1.2.1+f0f0f0f 的短哈希

# c++ - 在 C++ 中将实用程序 DLL 拆分为更小的组件

> ID：752166
> 
> 赞同：3
> 
> 时间：2009-04-15T15:11:53.783
> 
> 标签：c++, dll, mfc

我们有一个 DLL 形式的核心库，供多个客户端应用程序使用。它变得有些臃肿，一些应用程序只需要这个 DLL 提供的功能的一小部分。所以现在我们正在考虑将这个庞然大物分成更小的组件。

我的问题是：谁能推荐一条将这个臃肿的 DLL 分成一组模块的路径，这些模块具有一些相互依赖关系，但不一定需要所有其他模块？

以下是我看到的选项，但我希望有人可以提供其他可能性：

1.  创建一个“核心” dll 和几个使用核心和可能其他卫星 DLL 的“卫星” dll。
2.  将臃肿的 DLL 的内容细分为主 DLL 使用的静态库（以保持相同的功能），但不想使用臃肿版本的应用程序可以将他们需要的静态库组装到自己的 dll 中或应用程序本身.

我不愿提及这一点，但我认为注意该应用程序使用 MFC 可能很重要。

谢谢你的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:21:26.880

与您的问题有些相关的是这个问题，关于将一个非常大的 C 模块拆分为较小的模块。

[您如何将单元测试引入大型的遗留 (C/C++) 代码库？](https://stackoverflow.com/questions/748503/how-do-you-introduce-unit-testing-into-a-large-legacy-c-c-codebase)

您的问题似乎与将一些大块代码分解成一个更模块化的系统的更大问题有关。上面的链接绝对是推荐阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:43:18.090

如果没有所有细节，这有点难以帮助，但这是我在你的情况下会做的

*   提供您发布的 whate3ver 的静态和 dll 版本 - 用于 MT 和单线程。
*   尝试从不同的客户端收集哪些项目应该组合在一起以提供合理的分割 - 没有依赖层。

拥有一个“核心”模块听起来是个好主意——并确保你没有太多级别的依赖——你可能希望保持简单。

练习后你可能会发现，一个大的dll实际上是合理的。

另一个考虑因素是维护多个 DLL 以及静态库和 DLL 将极大地增加维护的复杂性。

你是要每次都同时发布它们，还是要混合搭配？在这里要小心 - 并且知道您可能会创建测试问题

如果没有人抱怨 DLL 的大小，那么您可能要考虑保持原样。

# iphone - 转换 OpenGL 应用程序以使其在 iPhone 上运行

> ID：752175
> 
> 赞同：1
> 
> 时间：2009-04-15T15:14:02.077
> 
> 标签：iphone, cocoa-touch, opengl

我正在尝试转换一个 openGL 应用程序以使其适用于 iPhone。我几乎完成了一切。但一无所获并坚持这部分。谁能告诉我以下转换部分一切正常。

```
for(int y=0;y<wet->h-1;y++)
{
    glDrawElements(GL_TRIANGLE_STRIP, wet->w, GL_UNSIGNED_BYTE,tex);
    glDrawElements(GL_TRIANGLE_STRIP, wet->w, GL_UNSIGNED_BYTE,col);
    glDrawElements(GL_TRIANGLE_STRIP, wet->w, GL_UNSIGNED_BYTE,vert);

    glDrawElements(GL_TRIANGLE_STRIP, wet->w, GL_UNSIGNED_BYTE, &tex[i+wet->w]);
    glDrawElements(GL_TRIANGLE_STRIP, wet->w, GL_UNSIGNED_BYTE, &col[i+wet->w]);
    glDrawElements(GL_TRIANGLE_STRIP, wet->w, GL_UNSIGNED_BYTE, &vert[i+wet->w]);
} 
```

代替：

```
for(int y=0;y<wet->h-1;y++)
{
    glBegin(GL_TRIANGLE_STRIP);
    for(int x=0;x<wet->w;x++)
    {
        glArrayElement(i);
        glArrayElement(i+wet->w);
        i++;
    }
    glEnd();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T16:50:42.407

如果您说出您遇到的问题，这可能会很有用。

您似乎没有`i`在新循环中增加。一点点`i += wet->w`，或者使用`y * wet->w`代替`i`怎么样？

# javascript - 启动新窗口，将结果返回到父页面上的文本框

> ID：752178
> 
> 赞同：1
> 
> 时间：2009-04-15T15:14:27.753
> 
> 标签：javascript, browser

我想启动新窗口，将结果返回到父页面上的文本框。我显然可以控制这两个页面，因此我可以添加任何可能需要的 javascript 等。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T15:18:25.437

在父窗口上运行一个函数，或者使用弹出窗口中的代码与它通信`window.opener`

# apache-flex - 如何判断 E4X 表达式是否匹配？

> ID：752181
> 
> 赞同：1
> 
> 时间：2009-04-15T15:16:20.120
> 
> 标签：apache-flex, actionscript-3, e4x

我正在尝试访问 XMLList 项并将其转换为 XML 对象。

我正在使用这个表达式：

```
masonicXML.item.(@style_number == styleNum) 
```

例如，如果有匹配，则一切正常，但如果没有匹配，那么当我尝试将其转换为 XML 时会出现错误，说明它必须格式正确。因此，在将表达式转换为 XML 之前，我需要确保表达式得到匹配。我尝试将其设置为 XMLList 变量并检查它是否为 text() 属性，如下所示：

```
var defaultItem:XMLList = DataModel.instance.masonicXML.item.(@style_number == styleNum);
                    if(defaultItem.text())
                    {
                        DataModel.instance.selectedItem = XML(defaultItem);
                    } 
```

但如果没有匹配，它仍然会给我一个错误。如果有匹配，它工作正常。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T13:24:24.807

根据我的经验，检查结果的最简单方法是获取列表的第 0 个元素并查看它是否为`null`.

这是您的代码示例，并进行了一些调整。请注意，我已将`defaultItem`from的类型更改`XMLList`为`XML`，并将其分配给列表的第 0 个元素。

```
var defaultItem:XML = 
    DataModel.instance.masonicXML.item.(@style_number == styleNum)[0];
if( defaultItem != null ) 
{
    DataModel.instance.selectedItem = defaultItem;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T15:21:16.333

好的，我可以使用它：

```
if(String(defaultItem.@style_number).length) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T22:08:23.227

Matt 的 null 检查是一个很好的解决方案。（除非 XMLList 中有可能包含 null 项。可能不会，但我还没有验证这一点。）

您还可以检查 XMLList 的长度而不将其转换为字符串：

```
if (defaultItem.@style_number.length() > 0) 
```

String 和 Array 的区别在于 XMLList`length()`是方法而不是属性。

# .net - 如何在我的 LINQ Where 子句中搜索集合的集合？

> ID：752182
> 
> 赞同：1
> 
> 时间：2009-04-15T15:16:39.420
> 
> 标签：.net, vb.net, linq, entity-framework, lambda

我有以下 ADO.NET Entity Framework 实体数据模型：

![ADO.NET 实体数据模型](https://i.stack.imgur.com/4lEIL.gif)

我想找到所有具有给定 ID 的服务和给定状态的关键字的保单持有人。

此 LINQ 不起作用：

```
Dim ServicesId As Integer = ...
Dim KeywordStatus As Integer = ...

Dim FoundPolicyholders = From p As Policyholder In db.PolicyholderSet.Include("Keywords").Include("Services") _
                         Where p.Services.Id = ServicesId _
                         And p.Keywords.Status = KeywordStatus _
                         Select p 
```

Where 子句无法以这种方式搜索 p.Services 和 p.Keywords EntityCollections。

> “Id”不是“System.Data.Objects.DataClasses.EntityCollection(Of ....Service)”的成员。

什么是正确的 LINQ 语法来做我想做的事？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T15:22:00.373

```
db.PolicyholderSet.Where(ph =>
   ph.Services.Any(s => s.Id == someId) &&
   ph.Keywords.Any(kw => kw.Status == someStatus)) 
```

为什么您的查询不起作用？因为`p.Services`and`p.Keywords`是一个`Service`和一个`Keyword`集合 - 它们没有属性`Id`，`Status`因此您不能使用`p.Services.Id`or `p.Keywords.Status`。

视觉基础…

```
Dim FoundPolicyholders = From p As Policyholder In db.PolicyholderSet.Include("Keywords").Include("Services") _
                         Where p.Services.Any(Function(s) s.Id = ServicesId) _
                         And p.Keywords.Any(Function(k) k.Status = KeywordStatus) _
                         Select p 
```

# java - 如何链接到一个包，但只能在运行时根据包的存在/可用性选择性地执行一个操作？

> ID：752183
> 
> 赞同：0
> 
> 时间：2009-04-15T15:16:45.457
> 
> 标签：java, user-interface, accessibility

从跨应用程序/applet java 可访问性服务的角度来看，您将如何链接到一个包，但只能在运行时根据包的存在/可用性（已加载）选择性地执行操作？

我想我在这里感兴趣的是一种解决[阶级认同危机的方法](http://www.ibm.com/developerworks/java/library/j-dyn0429/)但不是两个应用程序共享对象之间的问题，而是在类加载器的更高级别加载的服务。似乎反射是要走的路，但我不确定如何或是否可以以这种方式实现派生类。我需要添加从特定可选类派生的特定侦听器，我可以使用小程序类加载器加载侦听器，但内部仍然失败。假设您想添加一个 JInternalFrameListener，但不保证 Swing 可用，使用反射您可以找到添加侦听器的方法，但是如果找不到任何相关类，您如何创建并让框架侦听器工作因为在基类加载器中找不到它们！我是否需要创建一个线程并将 setContextClassLoader 用于知道摆动的类加载器，以便我可以可靠地加载类？只是试图在我现有的线程上设置类加载器似乎不起作用。

***问题的早期描述*** *对不起，我不太确定要问什么或如何说清楚，所以它有点啰嗦。*

假设一个类使用另一个类的某些功能，但另一个类可能并不总是可用 - 如果这是一个 JNLP 应用程序，则假设从 JNLP 查找网站。

在某个阶段，我认为简单地针对 JNLP 进行编译将意味着除非 JNLP 可用，否则我的类将不会加载，因此为了识别这个可选部分，我只是简单地将它包裹`try{} catch( NoClassDefFoundError )`起来。

后来发生了一些变化（可能是更改 jdk 或 ?? 我不记得了），似乎我也应该使用`try{} catch( ClassNotFoundException )`.

现在我想将这个想法扩展到其他可选功能，但它似乎并不能始终如一地工作。

假设我想添加一些功能以在 JRE1.6 运行时中使用与在 JRE1.3 中运行的相同的 jar 和类来执行更高级的操作，或者说我想处理特定 gui 工具包中的一些控件，这些控件可能并不总是像 SWT 或 oracle.forms 一样使用。

有什么方法可以更可靠地做到这一点吗？导致异常并捕获它以一直忽略它似乎是错误的。

当前的问题归结为能够针对 oracle.forms 进行编译，但是安装在 ext 中的可访问性组件无法访问 oracle.forms 类，即使已经创建了 oracle.forms 包中的对象。如果我将 frmall.jar 扔到 ext 目录中进行测试，那么可访问性组件会工作到由于同一包的不同版本而导致整个批次变得脆弱的程度。

我似乎陷入了类加载器不是正确的问题（？？）的问题上。我如何找到合适的？

编辑：到目前为止的答案有点有趣，但并没有让我到达我想去的地方。

对于 gui 组件，我目前以工厂的形式编译，例如...

```
import oracle.forms.ui.*;
import java.awt.*;
static public IComponentNode newNode( INode parent, Component component ) {
  System.out.println( component.getClass().toString() );
  try{
  if( component instanceof FormDesktopContainer )
     ... does stuff here like return new FormDesktopNode( parent, (FormDesktopContainer) component )
  } catch ( NoClassDefFoundError a ) {
    System.out.println( a.getMessage() ); 
  } 
```

它打印出来`class oracle.forms.ui.FormDesktopContainer`，然后在使用 NoClassDefFound 调用 instanceof 时抛出异常，从而打印出来`oracle/forms/ui/FormDesktopContainer`

**那么它怎么会有一个类的实例却找不到呢？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:23:59.463

这个怎么样？凌乱，但它应该工作：

```
public boolean exists(String className){

  try {
      Class.forName(className);
      return true;
      }
  catch (ClassNotFoundException){
      return false;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:23:31.897

您可以通过调用来检查课程的可用性

```
ClassLoader.getSystemClassLoader().loadClass("my.package.MyClass") 
```

如果它抛出 ClassNotFoundException，则它不可用。如果你得到 Class 对象，它就是。然后，您可以根据该类是否可用来选择行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-30T02:15:07.703

getSystemClass 加载器对此没有用处，因为根据给定窗口所在的小程序，可以与多个可能的类加载器进行交互。在更基类加载器上加载的可访问性组件看不到小程序特定的类。

与对象进行交互，反射完成了这项工作，尽管它确实增加了很多需要维护的东西。

```
// statically linking would be
return component.getText();

// dynamically is
try {
  return (String)component.getClass().getMethod("getText", new Class [] {}).invoke(component, new Object [] {});
} catch (Throwable e) {
  e.printStackTrace();
} 
```

更棘手的一点是在编写从一个不可直接访问的接口派生的类时，使用代理服务可以实现这一点，为代理服务提供小程序特定的类加载器和接口的动态加载类。

```
public void addListener(Container parent) {
  if (parent == null) { return; }
  if ("oracle.forms".equals(parent.getClass().getName())) {
    // Using the class loader of the provided object in the applet
    // get the "class" of the interface you want to implement
    Class desktopListenerClass = Class.forName( "oracle.DesktopListener"
         , true, parent.getClass().getClassLoader());

    // Ask the proxy to create an instance of the class, 
    // providing your implementation through the InvocationHandler::invoke
    Object desktopListener = Proxy.newProxyInstance(
         parent.getClass().getClassLoader()
         , new Class[] { desktopListenerClass }, new InvocationHandler() {

      public Object invoke(Object proxy, Method method, Object[] args) 
        throws Throwable {
        if ("functionName".equals(method.getName())) {
          // do stuff
        }
        return null;
      }
    });

    // do something with your new object
    Method addDesktopListener = parent.getClass().getMethod("");
    addDesktopListener.invoke(parent, desktopListener);
  }
} 
```

示例缩减以显示一般方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T15:31:33.017

我建议根据您的最低目标编译大部分代码。将使用特定可选库的代码明确分开，但取决于您的大部分代码。一次动态加载使用可选库的代码。主类应该做一些检查在其静态初始化器中是否存在所需的库/版本。

对于 JNLP，您的 JNLP 主类静态加载 JNLP 相关代码。

（请注意，试图从正常链接的代码中捕获与类加载相关的异常是不可靠的。）

# c# - 如何使用 SQLSERVER SMO 查找本地实例？

> ID：752184
> 
> 赞同：0
> 
> 时间：2009-04-15T15:17:01.680
> 
> 标签：c#, sql-server

有没有办法找出安装在单个物理机上的本地实例。

设想：

假设我在同一台机器上安装了 sqlserevr2005 和 sqlexpress。有没有办法使用 SMO 找到这些实例。

我已经在不同位置安装了两个实例的数据文件。

如何一次找到这些数据文件的位置

输出应该是这样的：

## Sql实例：

```
 sqlravikiran
 sqlravikiran\express 
```

## 文件：

D:\datafiles\master.mdf(sqlserver) f:\datafiles\master.mdf(sqlexpress)

这个怎么做

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:25:54.623

这是[MSDNMAG 中的一篇不错的文章，](http://msdn.microsoft.com/en-us/magazine/cc163409.aspx)这里[是 MSDN 上的介绍页面](http://msdn.microsoft.com/en-us/library/ms162202(SQL.90).aspx)。

但请尝试更新和改进您的问题，而不是发布一个新的且略有不同的问题。

# spring - SessionAware 不注入会话对象

> ID：752186
> 
> 赞同：3
> 
> 时间：2009-04-15T15:17:30.010
> 
> 标签：spring, session, dependency-injection, struts2, struts

在这里，我再次提出了一个 s2 的问题，我是它的初学者，并且在查找示例时遇到了一些麻烦。

我正在构建一个依赖于登录的菜单服务，当用户在起始页输入时给出。登录后，我通过执行以下操作将用户对象存储到会话中：

```
@Override
public String intercept(ActionInvocation invocation) throws Exception {
....

// verifica se o parametro do CPF veio no get e tenta logar o usuario
if (!StringUtils.isBlank(request.getParameter(USER_CPF_REQUEST))) {

if ( doLogin(request, session) ) {
   return Action.SUCCESS;
} 
```

然后是 doLogin 方法

```
Usuario usuario = getServico().buscar( Long.valueOf(cpf) );
//Caso o usuário exista, guarda na session
if (usuario != null){
    session.setAttribute(USER_HANDLE, usuario);
    return true;
} 
```

现在问题来了，我通过 ApplicationContext.xml 上的以下 xml 片段在 MenuAction 上注入了一个 MenuBean

```
<bean id="menuService" class="br.com.autenticis.renacon.ejb.MenuBean" />

    <bean id="menuAction" scope="prototype" class="br.com.autenticis.renacon.actions.MenuAction">
        <constructor-arg ref="menuService" />
    </bean> 
```

menuAction 声明如下：

```
public class MenuAction extends ActionSupport implements Preparable, SessionAware 
```

通过这样做，我需要使用私有成员实现会话集

```
private Map<String, Object> session;
....
@Override
public void setSession(Map<String, Object> session) {
   this.session = session;
} 
```

所有方法的失败部分如下，会话对象在调试时为空：

```
 public String execute() {
            if ( session.containsKey( LoginInterceptor.USER_HANDLE) ){
                Usuario u = (Usuario) session.get( LoginInterceptor.USER_HANDLE);
                setMenu( servico.getMenuPerfil( u.getPerfil() ) );
                return Action.SUCCESS;
            }

            return input();
        } 
```

有谁知道为什么？或如何实施？查看上面的代码，我需要登录用户的“Perfil”，如果会话包含用户对象的密钥我得到它，然后使用 perfil 通过 setter 填充菜单并返回 SUCESS，否则它'将返回 INPUT，这将导致登录屏幕。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T20:00:29.207

经过我们的一些尝试，我设法发现了错误。这不在程序中，而是在 struts.xml 中，我为应用程序编写了一个自定义堆栈：

```
<!-- stack seguro --> 
<!-- 
<interceptor-stack name="defaultLoginStack"> 
<interceptor-ref name="logger" /> 
<interceptor-ref name="params" /> 
<interceptor-ref name="login" /> 
<interceptor-ref name="prepare" /> 
<interceptor-ref name="chain" /> 
<interceptor-ref name="modelDriven" /> 
<interceptor-ref name="modelDriven" /> 
<interceptor-ref name="fileUpload" /> 
<interceptor-ref name="staticParams" /> 
<interceptor-ref name="params" /> 
<interceptor-ref name="conversionError" /> 
<interceptor-ref name="validation" /> 
<interceptor-ref name="workflow" /> 
</interceptor-stack> 
--> 
```

并且有点忘记包含与会话相关的项目，将 defaultLoginStack 更改为

```
<interceptor-stack name="defaultLoginStack"> 
<interceptor-ref name="login" /> 
<interceptor-ref name="defaultStack" /> 
</interceptor-stack> 
```

我现在可以正确使用会话注入。

# c# - LINQ to SQL - 没有可用的添加方法

> ID：752191
> 
> 赞同：25
> 
> 时间：2009-04-15T15:19:09.320
> 
> 标签：c#, linq-to-sql, insert

我创建了一个 LINQ to SQL 数据上下文，其中包含一个数据表。我试图简单地在该表中插入一条新记录。我遇到的问题是 LINQ 没有提供 Add 方法来传递新记录。我见过无数有 Add 方法的例子，但我似乎无法理解。我完全错过了什么还是其他什么？

```
using (praetoriaTestDataContext db = new praetoriaTestDataContext())
{
    PageHit hit = new PageHit();
    hit.DateViewed = DateTime.Now;
    hit.Page = "test";

    db.PageHits.Add(hit); //Add method is not available!
    db.SubmitChanges();
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-15T15:21:56.737

Table 的 Add 和 Remove 方法已重命名为 InsertOnSubmit 和 DeleteOnSubmit。

```
db.PageHits.InsertOnSubmit(hit); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T15:21:21.560

使用 LINQ-to-SQL，您想要`PageHits.`[`InsertOnSubmit`](http://msdn.microsoft.com/en-us/library/bb763516.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-15T13:18:33.383

我有一个类似的问题，但 InsertOnSubmit 也没有出现。结果发现我缺少对 System.Data.LINQ 程序集的引用。

# linux - Linux MMAP 内部结构

> ID：752192
> 
> 赞同：24
> 
> 时间：2009-04-15T15:20:11.547
> 
> 标签：linux, posix, mmap

我有几个关于`mmap`Linux 系统中的实现的问题，这些问题似乎没有太多记录：

使用 将文件映射到内存`mmap`时，您将如何处理预取此类文件中的数据？

即当您从映射区域读取数据时会发生什么？该数据是否已移至 L1/L2 缓存？它是直接从磁盘缓存中读取的吗？`prefetchnta`和类似的 ASM 指令是否适用于`mmap`ed 区域？

实际`mmap`调用的开销是多少？它是相对于映射数据的数量还是常数？

希望有人对此有所了解。提前致谢。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-15T15:34:08.987

mmap 基本上是对虚拟内存子系统的编程访问。

例如，当您拥有 1G 文件并对其进行 mmap 映射时，您会得到一个指向“整个”文件的指针，就好像它在内存中一样。

但是，在这个阶段，除了为 VM 中的文件保留页面的实际映射操作之外，什么都没有发生。（当然，文件越大，映射操作的时间越长。）

为了开始从文件中读取数据，您只需通过 mmap 调用中返回的指针访问它。

如果您希望“预加载”文件的某些部分，只需访问您要预加载的区域。确保您访问了所有要加载的页面，因为 VM 只会加载您访问的页面。例如，假设在您的 1G 文件中，您有一个 10MB 的“索引”区域，您想在其中映射。最简单的方法是“遍历您的索引”或您拥有的任何数据结构，让 VM 页面根据需要在数据中。或者，如果您“知道”它是文件的“前 10MB”，并且您的 VM 的页面大小是 4K，那么您可以将 mmap 指针转换为 char 指针，然后遍历页。

```
void load_mmap(char *mmapPtr) {
    // We'll load 10MB of data from mmap
    int offset = 0;
    for(int offset = 0; offset < 10 * 1024 * 1024; offset += 4 * 1024) {
        char *p = mmapPtr + offset;
        // deref pointer to force mmap load
        char c = *p;
    }
} 
```

至于 L1 和 L2 缓存，mmap 与此无关，这完全与您如何访问数据有关。

由于您使用的是底层 VM 系统，因此任何在 mmap'd 块中寻址数据的东西都可以工作（从汇编中）。

如果您不更改任何 mmap 数据，VM 将在需要新页面时自动清除旧页面。如果您确实更改了它们，那么 VM 将为您写回这些页面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T19:16:36.860

这与 CPU 缓存无关；它将它映射到虚拟地址空间，如果它随后被访问，或者被 mlock() 锁定，那么它将物理地带入内存。它在什么 CPU 缓存中或不在什么缓存中，你真的无法控制（至少，不是通过 mmap）。

通常需要触摸页面才能使其被映射，但如果您执行 mlock 或 mlockall，则会产生相同的效果（这些通常是特权）。

就开销而言，我真的不知道，你必须测量它。我的猜测是，不加载页面的 mmap() 或多或少是一个恒定的时间操作，但是随着页面的增加，将页面引入需要更长的时间。

最近版本的 Linux 还支持一个标志 MAP_POPULATE，它指示 mmap 立即加载页面（大概只有在可能的情况下）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T09:48:44.013

回答 Ravi Phulsundar 先生的问题：

只要权限设置正确，多个进程可以映射同一个文件。查看 mmap 手册页只需传递`MAP_SHARED`标志（如果您需要映射一个非常大的文件，请使用 mmap2 代替）：

[地图](http://linux.die.net/man/2/mmap)

> MAP_SHARED
> 
> 与映射此对象的所有其他进程共享此映射。存储到区域相当于写入文件。在调用 msync(2) 或 munmap(2) 之前，该文件实际上可能不会被更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-17T01:35:07.653

你使用 MAP_SHARED

# javascript - 使用 AJAX 添加输入？

> ID：752194
> 
> 赞同：0
> 
> 时间：2009-04-15T15:20:32.390
> 
> 标签：javascript, ajax

AJAX 或 JS 中有没有办法在单击按钮时添加更多输入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:29:30.887

简而言之，是的，您可以在单击按钮时添加更多输入。

例如，在 jQuery 中，你可以有这样的东西，其中 buttonID 是按钮的 id 属性，而 formID 是表单的 id 属性：

```
$("buttonID").click(function() {
    //add new inputs here, something like:
    $("formID").append('<input type="text" id="newInput" name="newInput" />');
}); 
```

您还可以先隐藏其他输入，然后根据需要单击“取消隐藏”它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:22:28.983

进一步的输入？通过将事件侦听器添加到侦听单击的按钮，在用户单击按钮时运行所需的任何 JavaScript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T15:41:39.950

一旦用户点击按钮，如果你有一个事件监听器，你可以改变他们输入的内容，你可以做任何你想做的事情。

不过，我不确定您所说的“进一步输入”是什么意思。如果您正在发送数据，那么您可以附加任何您想要的内容，例如，我经常附加时间戳以帮助防止缓存问题。

# asp.net - 动态控制创建

> ID：752196
> 
> 赞同：0
> 
> 时间：2009-04-15T15:21:11.483
> 
> 标签：asp.net

我阅读了有关在 ASP.NET 中创建动态控件的这段文字：

> ...当使用动态控件时，您必须记住它们只会在下一次回发之前存在。ASP.NET 不会重新创建动态添加的控件。如果需要多次重新创建控件，则应在 Page.Load 事件处理程序中执行控件创建。这还有一个额外的好处，就是允许您在动态控件中使用视图状态。即使视图状态通常在 Page.Load 事件之前恢复，如果您在 Page.Load 事件的处理程序中创建一个控件， **ASP.NET 将应用它在 Page.Load 事件处理程序结束后拥有的任何视图状态信息。这个过程是自动的**...

我想在示例中尝试以声明方式创建一个按钮 -

```
<asp:Button ID="Button1" runat="server" Text="Button" 
             onclick="Button1_Click"  /> 
```

并在代码 5 复选框后面动态显示 -

```
protected void Page_Load(object sender, EventArgs e)
{
  for (int i = 0; i <= 5; i++)
    {
      var chBox = new HtmlInputCheckBox();
      Controls.Add(chBox);
    }

} 
```

但是当我检查一些复选框并点击按钮时，回发后所有复选框状态都被删除。这意味着 ASP.NET 不会自动管理动态控件的视图状态？我试图为每个复选框和整个页面启用视图状态，但它不起作用。有人可以解释一下：1.为什么会这样？2.如何避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:24:14.407

发生这种情况的原因是，为了让 ASP.NET 恢复 POST 值，这些控件需要在加载之前成为页面的一部分。为了完成这项工作，您需要（如果可能）创建页面的 OnInit 控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T15:32:47.163

您必须为每个动态控件设置一个 ID，以便它们可以在回发之间同步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:04:24.420

可以在 Page_Init 上创建控件。

```
protected void Page_Init(object sender, EventArguments e)
{
  //Generate the checkboxes dynamically here.
  CheckBox c;
  for (int i = 0; i < 5; i++) {
    c = new CheckBox();
    c.ID = "Checkbox" + i.ToString();

    divContainer.Controls.Add(c); //create a div with runat="Server" attribute or use an asp:Panel, etc. container controls.
  }
} 
```

之后，再次尝试单击该按钮，该状态将始终保持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T00:54:38.000

据我了解 - 无论在 OnInit 或 OnLoad 中创建控件的位置（但有些书籍在 onLoad 中建议）， *问题在于将它们放置在哪里*- 如果您通过 Controls.Add 放置 - 它会将它们放置在`<form></form>`回发之外控制的状态。在内部创建占位符`<form></form>` 并向该占位符添加动态控件后，一切都开始正常工作。

# session - 网络浏览器是否应该在退出时删除所有“会话”（到期 = 0）cookie？

> ID：752197
> 
> 赞同：4
> 
> 时间：2009-04-15T15:21:14.040
> 
> 标签：session, cookies, browser

我读到的关于 cookie 的所有内容都表明，将 cookie 的到期时间设置为零应该使其成为“会话”cookie，然后浏览器将在退出时将其删除。

[http://www.cookiecentral.com/faq/](http://www.cookiecentral.com/faq/)说：

> “......通常会话是浏览器打开的时间长度......”

[http://php.net/manual/en/function.setcookie.php](http://php.net/manual/en/function.setcookie.php)说：

> “如果设置为 0 或省略，则 cookie 将在会话结束时（浏览器关闭时）过期。”

然而，在**Firefox (3.0.8)**中的一些实验表明：

*   设置为会话*和*安全的 cookie 在退出时被删除
*   仅设置为会话的 cookie在退出时**不会**被删除

Opera (9.64) 的行为与我预期的一样，无论是否设置为安全，都会在退出时删除会话 cookie。

我希望能够在我正在开发的网络应用程序中依赖它（将安全 cookie 和不安全 cookie 作为“登录”标志并让它们一起过期，无论是实时还是 0一个会话），但似乎即使它在标准中，浏览器也不够一致，无法依赖它：/

这是浏览器中的错误、预期行为和/或会话 cookie 的实际生命周期没有在标准中真正定义吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T15:28:36.863

**您永远不应该依赖客户端功能。**

您正在处理的功能通常是在客户端存储会话 ID 和服务器端的真实用户信息（其 ID、他是否登录、他的个人信息等）。

还要记住 cookie 会在每个请求中发送，因此您在 cookie 中存储的越少越好。

# javascript - 将jquery代码存储在外部文件和目录结构中？

> ID：752198
> 
> 赞同：3
> 
> 时间：2009-04-15T15:21:14.167
> 
> 标签：javascript, jquery, structure, external, include

任何人都可以确认存储 jquery 代码的最佳方法吗？最初我将所有内容都插入到文档的 HEAD 中，但我看到越来越多的代码跨页面使用，

使用扩展名为 .JS 的包含文件的最佳方式是 .. 吗？

在这方面还有什么或更好的吗？

如果是这种情况，存储我的 .js 文件的最佳位置是什么。

我的根

/css /脚本

等等... /scripts 是我的 jquery 文件所在的位置...但是我应该对我的 .js 文件使用相同的文件吗？

有人对目录结构有一些建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T15:25:14.030

您应该在 .js 文件中存储尽可能多的代码，因为这将允许浏览器只下载一次并在所有请求中重复使用。

如果您将代码直接作为纯文本包含在 HEAD 部分中，您将强制在每个请求中下载该代码，从而减慢页面传输速度。

您存储文件的目录实际上取决于您...我使用`/css`and `/js`，但`/scripts`在许多情况下也使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:25:51.317

在页面上插入 JavaScript 的位置取决于您要执行的操作。为了速度，有一些[参数可以在页面末尾链接您的 JavaScript，以便浏览器可以在尝试解析/执行任何 JavaScript 之前加载页面。](http://wonko.com/post/remote_javascript_includes_without_the_performance_penalty_part)当然，如果您需要在页面加载之前执行 JavaScript，则需要放入文档的头部。这完全取决于您和您的需求。

.js 是 JavaScript 文件的标准扩展名，因此最好继续使用它。链接到您的 JavaScript 文件而不是将它们直接放在页面上是个好主意，这样用户的浏览器就可以缓存 JavaScript 文件。

将脚本存储在哪里取决于您，但将所有 jQuery 文件存储在 /scripts 目录中似乎是个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T15:26:56.163

它不需要太复杂。是的，当然可以使用 JS 扩展存储，但也建议将 Javascript 与第三方库分开。

这就是您所需要的一切：

```
.
./js/jquery/jquery.js
./js/yourfiles.js 
```

或者，将您的文件放在您的公司名称下：

```
./js/companyname/yourfiles.js 
```

正如其他人所说：尽可能将您的 JS 放在文件末尾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-27T19:19:27.323

Seb 是正确的，但要添加一件事，请尝试将所有 JS 和 CSS 文件分别压缩为一个。

无论文件是否被缓存，对于每个单独的文件，仍然会向服务器发出往返请求，以检查它是否已更新。当有许多 JS 和 CSS 文件时，这会降低用户的体验。

# perl - 如何使用 Perl 计算大型 CSV 文件中的行数？

> ID：752202
> 
> 赞同：3
> 
> 时间：2009-04-15T15:21:24.697
> 
> 标签：perl, csv, large-data-volumes

我必须在工作中的 Windows 环境中使用 Perl，并且我需要能够找出大型 csv 文件包含的行数（大约 1.4Gb）。知道如何以最少的资源浪费做到这一点吗？

谢谢

PS 这必须在 Perl 脚本中完成，我们不允许在系统上安装任何新模块。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-15T15:27:17.770

你的意思是行还是行？一个单元格可能包含换行符，它会在文件中添加行，但不会添加行。如果您保证没有单元格包含新行，那么只需使用[Perl FAQ](http://search.cpan.org/~nwclark/perl-5.8.9/pod/perlfaq5.pod#How_do_I_count_the_number_of_lines_in_a_file?___)中的技术。否则，您将需要一个合适的 CSV 解析器，例如[Text::xSV](http://search.cpan.org/~tilly/Text-xSV-0.18/lib/Text/xSV.pm)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-15T15:24:45.360

是的，不要使用 perl。

而是使用简单的实用程序来计算行数；**wc.exe**

它是从 unix 原件移植的一套***Windows 实用程序的一部分。***

[http://unxutils.sourceforge.net/](http://unxutils.sourceforge.net/)

例如;

```
PS D:\> wc test.pl
     12      26     271 test.pl
PS D:\> 
```

其中 12 == 行数，26 == 字数，271 == 字符数。

如果你真的必须使用 perl；

```
D:\>perl -lne "END{print $.;}" < test.pl
12 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T15:28:45.880

```
perl -lne "END { print $. }" myfile.csv 
```

这一次只读取一行，所以它不会浪费任何内存，除非每一行都非常长。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-15T17:29:22.360

这个单行处理行内的新行：

1.  考虑带有奇数个引号的行。
2.  考虑到双引号是在字段中表示引号的一种方式。
3.  它使用了*令人敬畏*的触发器运算符。

    ```
    perl -ne 'BEGIN{$re=qr/^[^"]*(?:"[^"]*"[^"]*)*?"[^"]*$/;}END{print"Count: $t\n";}$t++ unless /$re/../$re/' 
    ```

考虑：

*   `wc`不会工作。计数行很棒，但不是 CSV 行
*   您*应该*安装 - 或争取安装 -[`Text::CSV`](http://search.cpan.org/perldoc?Text::CSV)或一些类似的标准包以进行正确处理。
*   尽管如此，这可能会让你到达那里。

* * *

**编辑：**我没想到这是窗户：

```
perl -ne "BEGIN{$re=qr/^[^\"]*(?:\"[^\"]*\"[^\"]*)*?\"[^\"]*$/;}END{print qq/Count: $t\n/;};$t++ unless $pq and $pq = /$re/../$re/;" 
```

*奇怪的是，The Broken OS 的 shell 解释`&&`为 OS 条件执行，我无法改变它的想法！！*如果我逃脱了它，它就会以这种方式传递给 perl。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T15:31:26.170

支持 edg 的回答，另一种选择是安装[cygwin](http://www.cygwin.com)以在 Windows 上获取 wc 和一堆其他方便的实用程序。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-16T09:21:46.517

我很白痴，在脚本中执行此操作的简单方法是：

```
open $extract, "<${extractFileName}" or die ("Cannot read row count of $extractFileName");
$rowCount=0;    
while (<$extract>)
{
    $rowCount=$rowCount+1;
}

close($extract); 
```

# c - BASE24 教程或学习资料

> ID：752203
> 
> 赞同：2
> 
> 时间：2009-04-15T15:21:26.583
> 
> 标签：c, cobol

有人知道我在哪里可以找到与 Base24 相关的教程或材料吗？我指的是[ACI](http://www.aciworldwide.com/ "ACI")的 Base24 产品。我的理解是他们使用一种叫做“TAL”的编程语言，它与 Cobol 和 C 有相似之处。

我在网上搜索过，我只找到了 Base24 开发人员的工作机会，但几乎没有任何学习资源。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:26:54.433

我搜索了**base24 编程**，第二次点击是[http://2020ok.com/books/13/a-guide-to-using-aci-worldwide-s-base24-es-on-z-os-34513.htm](http://2020ok.com/books/13/a-guide-to-using-aci-worldwide-s-base24-es-on-z-os-34513.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T19:57:16.373

TAL 代表“事务应用程序语言”，由 HP 提供支持。

[这里](http://docs.hp.com/en/526371-001/526371-001.pdf)有程序员指南[，这里](http://docs.hp.com/en/096254/096254.pdf)有参考手册。

# apache-flex - Adobe Air 是否具有不受限制的文件系统访问权限？

> ID：752207
> 
> 赞同：2
> 
> 时间：2009-04-15T15:21:39.733
> 
> 标签：apache-flex, actionscript, file, file-io, air

我找到了几个示例和文档，这些示例和文档显示了如何在系统上读取和写入文件，但都显示了用户干预或在用户配置文件目录中读取/写入文件。我想做几件事：

1.  监视系统和其他应用程序日志文件的更改，然后在发生更改时自动加载这些文件
2.  应用程序启动时重新加载以前打开的文件
3.  将文件写入日志目录，该目录可能不会存在于与应用程序相同的路径中。

在我非常快速的搜索中，似乎有一个安全模型限制了 AIR 应用程序对文件系统的访问，因此文件只能读取或写入用户通过文件系统对话框选择的目录，或者文件可以写在用户配置文件或空中应用程序目录中。

Adobe Air 应用程序是否可以不受限制地访问文件系统？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T12:14:24.917

AIR 具有与当前用户完全相同的文件系统访问权限。如果您是计算机上的管理员，则 AIR 具有对所有文件的完全访问权限。如果您是受限用户，则 AIR 具有受限访问权限。

需要注意的一件事是，如果您从 AIR 应用程序的主目录加载 swf:s，它将在应用程序沙箱中运行。如果您从外部读取它，它将在文件沙箱中执行，这与从 Web 加载基本相同。

您的清单上的一些评论：

**1 监视系统和其他应用程序日志文件的更改，然后在发生更改时自动加载这些文件**

据我所知，AIR 无法监控文件系统。您必须定期进行轮询。

**2 应用程序启动时重新加载以前打开的文件**

将此信息保存在文件或 SQLite 中，并在应用程序启动时检查它。

**3 将文件写入日志目录，该目录可能与应用程序不在同一路径中。**

要记住的主要事情是使用 AIR 中的文件路径抽象而不是操作系统特定的路径，例如 c:/

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:29:43.053

我会说你的答案取决于平台。我确信 Adob​​e Air 不会在 OS X 上自动获得 root 访问权限，因此在启动 AIR 应用程序的任何所有者都没有访问文件的正确权限的情况下，它将无法读取、写入和执行。简而言之，您可能拥有计算机上运行的任何其他程序可能拥有由同一用户安装的相同权限。

更多信息在这里：

[http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118666ade46-7f05.html#WS5b3ccc516d4fbf351e63e3d118666ade46-7e35](http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118666ade46-7f05.html#WS5b3ccc516d4fbf351e63e3d118666ade46-7e35)

# php - PHP 守护进程/worker 环境

> ID：752214
> 
> 赞同：15
> 
> 时间：2009-04-15T15:22:10.827
> 
> 标签：php, parallel-processing, daemon, rabbitmq, process-control

问题：我想实现几个 php-worker 进程，它们在 MQ 服务器队列上侦听异步作业。现在的问题是，简单地将这些进程作为服务器上的守护进程运行并不能真正让我对实例进行任何级别的控制（负载、状态、锁定）......除了转储 ps -aux 之外。因此，我正在寻找某种运行时环境，可以让我在系统（进程）级别或更高层（某种 Java 风格的应用服务器）上监视和控制实例

任何指针？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-15T15:31:25.797

这是一些可能有用的代码。

```
<?
define('WANT_PROCESSORS', 5);
define('PROCESSOR_EXECUTABLE', '/path/to/your/processor');
set_time_limit(0);
$cycles = 0;
$run = true;
$reload = false;
declare(ticks = 30);

function signal_handler($signal) {
    switch($signal) {
    case SIGTERM :
        global $run;
        $run = false;
        break;
    case SIGHUP  :
        global $reload;
        $reload = true;
        break;
    }   
}

pcntl_signal(SIGTERM, 'signal_handler');
pcntl_signal(SIGHUP, 'signal_handler');

function spawn_processor() {
    $pid = pcntl_fork();
    if($pid) {
        global $processors;
        $processors[] = $pid;
    } else {
        if(posix_setsid() == -1)
            die("Forked process could not detach from terminal\n");
        fclose(stdin);
        fclose(stdout);
        fclose(stderr);
        pcntl_exec(PROCESSOR_EXECUTABLE);
        die('Failed to fork ' . PROCESSOR_EXECUTABLE . "\n");
    }
}

function spawn_processors() {
    global $processors;
    if($processors)
        kill_processors();
    $processors = array();
    for($ix = 0; $ix < WANT_PROCESSORS; $ix++)
        spawn_processor();
}

function kill_processors() {
    global $processors;
    foreach($processors as $processor)
        posix_kill($processor, SIGTERM);
    foreach($processors as $processor)
        pcntl_waitpid($processor);
    unset($processors);
}

function check_processors() {
    global $processors;
    $valid = array();
    foreach($processors as $processor) {
        pcntl_waitpid($processor, $status, WNOHANG);
        if(posix_getsid($processor))
            $valid[] = $processor;
    }
    $processors = $valid;
    if(count($processors) > WANT_PROCESSORS) {
        for($ix = count($processors) - 1; $ix >= WANT_PROCESSORS; $ix--)
            posix_kill($processors[$ix], SIGTERM);
        for($ix = count($processors) - 1; $ix >= WANT_PROCESSORS; $ix--)
            pcntl_waitpid($processors[$ix]);
    } elseif(count($processors) < WANT_PROCESSORS) {
        for($ix = count($processors); $ix < WANT_PROCESSORS; $ix++)
            spawn_processor();
    }
}

spawn_processors();

while($run) {
    $cycles++;
    if($reload) {
        $reload = false;
        kill_processors();
        spawn_processors();
    } else {
        check_processors();
    }
    usleep(150000);
}
kill_processors();
pcntl_wait();
?> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T18:56:52.087

听起来您已经在 *nix 系统上启动并运行了一个 MQ，只是想要一种管理工作人员的方法。

一个非常简单的方法是使用 GNU screen。要启动 10 个工作人员，您可以使用：

```
#!/bin/sh
for x in `seq 1 10` ; do
screen -dmS worker_$x php /path/to/script.php worker$x
end 
```

这将使用名为 worker_1、2、3 等的屏幕在后台启动 10 个工作人员。

您可以通过运行 screen -r worker_ 重新连接到屏幕，并使用 screen -list 列出正在运行的工作人员。

有关更多信息，本指南可能会有所帮助： [http ://www.kuro5hin.org/story/2004/3/9/16838/14935](http://www.kuro5hin.org/story/2004/3/9/16838/14935)

也试试：

*   屏幕——帮助
*   人屏
*   或[谷歌](http://www.google.com/search?q=introduction%20to%20gnu%20screen)。

对于生产服务器，我通常建议使用正常的系统启动脚本，但多年来我一直在从启动脚本运行屏幕命令，没有任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-05T03:55:06.493

PHP 的 pcntl 插件类型服务器守护进程

[http://dev.pedemont.com/sonic/](http://dev.pedemont.com/sonic/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T15:33:00.143

你真的需要它持续运行吗？

如果您只想根据请求生成新进程，则可以将其注册为 xinetd 中的服务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-18T08:19:06.380

Bellow 是我们对@chaos answer 的工作实现。处理信号的代码被删除，因为这个脚本通常只有几毫秒。

此外，在代码中，我们添加了 2 个函数来在调用之间保存 pid：restore_processors_state() 和 save_processors_state()。我们在`redis`那里使用过，但您可以决定对文件使用实现。

我们使用 cron 每分钟运行一次这个脚本。Cron 检查所有进程是否还活着。如果不是 - 它重新运行它们然后死亡。如果我们想杀死现有的进程，那么我们只需使用参数运行这个脚本`kill`：`php script.php kill`。

无需将脚本注入 init.d 即可运行工作程序的非常方便的方法。

```
<?php

include_once dirname( __FILE__ ) . '/path/to/bootstrap.php';

define('WANT_PROCESSORS', 5);
define('PROCESSOR_EXECUTABLE', '' . dirname(__FILE__) . '/path/to/worker.php');
set_time_limit(0);

$run = true;
$reload = false;
declare(ticks = 30);

function restore_processors_state()
{
    global $processors;

    $redis = Zend_Registry::get('redis');
    $pids = $redis->hget('worker_procs', 'pids');

    if( !$pids )
    {
        $processors = array();
    }
    else
    {
        $processors = json_decode($pids, true);
    }
}

function save_processors_state()
{
    global $processors;

    $redis = Zend_Registry::get('redis');
    $redis->hset('worker_procs', 'pids', json_encode($processors));
}

function spawn_processor() {
    $pid = pcntl_fork();
    if($pid) {
        global $processors;
        $processors[] = $pid;
    } else {
        if(posix_setsid() == -1)
            die("Forked process could not detach from terminal\n");
        fclose(STDIN);
        fclose(STDOUT);
        fclose(STDERR);
        pcntl_exec('/usr/bin/php', array(PROCESSOR_EXECUTABLE));
        die('Failed to fork ' . PROCESSOR_EXECUTABLE . "\n");
    }
}

function spawn_processors() {
    restore_processors_state();

    check_processors();

    save_processors_state();
}

function kill_processors() {
    global $processors;
    foreach($processors as $processor)
        posix_kill($processor, SIGTERM);
    foreach($processors as $processor)
        pcntl_waitpid($processor, $trash);
    unset($processors);
}

function check_processors() {
    global $processors;
    $valid = array();
    foreach($processors as $processor) {
        pcntl_waitpid($processor, $status, WNOHANG);
        if(posix_getsid($processor))
            $valid[] = $processor;
    }
    $processors = $valid;
    if(count($processors) > WANT_PROCESSORS) {
        for($ix = count($processors) - 1; $ix >= WANT_PROCESSORS; $ix--)
            posix_kill($processors[$ix], SIGTERM);
        for($ix = count($processors) - 1; $ix >= WANT_PROCESSORS; $ix--)
            pcntl_waitpid($processors[$ix], $trash);
    }
    elseif(count($processors) < WANT_PROCESSORS) {
        for($ix = count($processors); $ix < WANT_PROCESSORS; $ix++)
            spawn_processor();
    }
}

if( isset($argv) && count($argv) > 1 ) {
    if( $argv[1] == 'kill' ) {
        restore_processors_state();
        kill_processors();
        save_processors_state();

        exit(0);
    }
}

spawn_processors(); 
```

# jquery - 带有 JSON 数组的 Jquery - 转换为 Javascript 数组

> ID：752222
> 
> 赞同：2
> 
> 时间：2009-04-15T15:24:42.147
> 
> 标签：jquery, arrays, json, xml

我有来自 asp.net webservice 的以下 XML 输出：

```
<ArrayOfArrayOfString>
    <ArrayOfString>
        <string>1710</string>
        <string>1711</string>
        <string>1712</string>
        <string>1713</string>
    </ArrayOfString>
    <ArrayOfString>
        <string>Teleszkóp 350mm gázas</string>
        <string>Teleszkóp 150mm olaj</string>
        <string>Teleszkóp 260mm olaj sárga</string>
        <string>Teleszkóp 260mm első</string>
    </ArrayOfString>
</ArrayOfArrayOfString> 
```

我正在使用 JQuery 的 $Ajax 从服务器获取它，它工作正常。它已转换为 JSON 对象，但如何将其转换回 Javascript 数组？

*更新*：问题是，如果用 eval() 解析，这个 Array-in-Array 只会变成一个字符串！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T15:30:31.587

这不是 JSON 对象：它是 xml。JSON 本质上*是*javascript，看起来更像这样：

> [[“1710”、“1711”、“1712”、“1713”]、[“Teleszkóp 350mm gázas”、“Teleszkóp 150mm olaj”、“Teleszkóp 260mm olaj sárga”、“Teleszkóp 260mm első”]]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T15:30:03.270

我假设您的数据正在返回并由 jQuery 自动解析并放入 XML 文档中。这是将 XML 对象展平为数组的一种方法：

```
 my parsedData = [];  
   $('result', data).each(function() {
      parsedData.push(  
         { name: $('name', this).text(),
           addr: $('addr', this).text(),
           city: $('city', this).text(),
           state: $('state', this).text(),
           zip: $('zip', this).text()
      }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T15:34:05.257

```
var array = eval(json.d); 
```

其中array是javascript数组，json是json对象，json.d是json字符串。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T16:08:11.307

好吧，这是我编写的用于将 XML 对象转换为本机 JavaScript 对象（包括数组）的代码。你只需要打电话

```
Object.fromXML(yourXMLObject) 
```

你会得到一个原生 JavaScript 对象，它的 JSON 等价物是这样的：

```
{
  ArrayOfString:
  [
    {string: ['1710', '1711', '1712', '1713']},
    {string: ['Teleszkóp 350mm gázas', 'Teleszkóp 150mm olaj', 'Teleszkóp 260mm olaj sárga', 'Teleszkóp 260mm első']}
  ]
} 
```

该函数的源代码如下。

```
/**
 * Tries to convert a given XML data to a native JavaScript object by traversing the DOM tree.
 * If a string is given, it first tries to create an XMLDomElement from the given string.
 * 
 * @param {XMLDomElement|String} source The XML string or the XMLDomElement prefreably which containts the necessary data for the object.
 * @param {Boolean} [includeRoot] Whether the "required" main container node should be a part of the resultant object or not.
 * @return {Object} The native JavaScript object which is contructed from the given XML data or false if any error occured.
 */
Object.fromXML=function(source, includeRoot)
{
    if (typeof source=='string')
    {
        try
        {
            if (window.DOMParser)
                source=(new DOMParser()).parseFromString(source, "application/xml");
            else if (window.ActiveXObject)
            {
                var xmlObject=new ActiveXObject("Microsoft.XMLDOM");
                xmlObject.async=false;
                xmlObject.loadXML(source);
                source=xmlObject;
                xmlObject=undefined;
            }
            else
                throw new Error("Cannot find an XML parser!");
        }
        catch(error)
        {
            return false;
        }
    }
    var result={};
    if (source.nodeType==9)
        source=source.firstChild;
    if (!includeRoot)
        source=source.firstChild;

    while (source) 
    {
        if (source.childNodes.length) 
        {
            if (source.tagName in result) 
            {
                if (result[source.tagName].constructor != Array) 
                    result[source.tagName] = [result[source.tagName]];
                result[source.tagName].push(Object.fromXML(source));
            }
            else 
                result[source.tagName] = Object.fromXML(source);
        }
        else if (source.tagName)
            result[source.tagName] = source.nodeValue;
        else
            result = source.nodeValue;
        source = source.nextSibling;
    }

    return result;
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T16:44:54.887

如果你明确告诉 jQuery 你期望返回一个 XML 文档（使用[`dataType`option](http://docs.jquery.com/Ajax/jQuery.ajax)），或者如果你没有指定数据类型并且服务器仍然正确地将它作为 XML 发送（在这种情况下，jQuery 会猜测并给你`responseXML`而不是`responseText`），你应该能够在你的成功回调函数中使用以下内容从 XML 中提取一个字符串数组，其中`data`是一个 XML 文档：

```
$(data).find("ArrayOfString").map(function()
{
    return $(this).find('string').map(function()
    {
        return $(this).text();
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T15:32:02.703

如果它是[JSON](http://www.json.org/)，你不需要转换任何东西......例如：

```
var jsonString = ".....";
var converted = eval(jsonString); 
```

JSON 表示 JavaScript 对象表示法，因此 JSON 格式的任何内容都可以直接在 JavaScript 中使用。

你所拥有的是 XML。您应该检查它并手动转换为 JavaScript。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-11T15:56:20.220

您的问题似乎与它的标题不太匹配，但读了几次后，我认为答案是（在 javascript 中）：

```
var JSONstring = '{"something":"like this"}';
var newArray = JSON.parse(JSONstring); 
```

适用于 Firefox 15.0.1

jQuery的方式是：

```
 newArray = $.parseJSON(JSONstring); 
```

# .net - 如何查看 .NET 库中的类代码？

> ID：752228
> 
> 赞同：1
> 
> 时间：2009-04-15T15:25:54.437
> 
> 标签：.net, visual-studio-2008, class

我想看看 .NET 库中一些类的代码。我通过使用智能感知来查找功能，并且只需阅读当我选择不同项目时出现的工具提示。

一个例子是 Contains 方法，您可以在数组上使用它来搜索给定的字符串。我只是在练习学习时偶然发现了这一点。我假设这是一个简单的方法，它只是遍历数组并检查每个元素的字符串。

如果我想看看这段代码，或者 .NET 中任何其他类的代码，我会怎么做？我有 Visual Studio 2008。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T15:27:10.547

使用[.NET 反射器](http://www.red-gate.com/products/reflector/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:29:33.163

反射[器](http://www.red-gate.com/products/reflector/)（为了易于使用和通用应用程序）或[微软的符号服务器](http://weblogs.asp.net/scottgu/archive/2007/10/03/releasing-the-source-code-for-the-net-framework-libraries.aspx)用于真实的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T15:27:35.897

反射器是要走的路。

.NET Framework 3.5 BCL 源代码可通过调试符号（参考许可证）获得。

SSCLI（转子）和 Mono 源代码也可以相关。

# c# - 在带有事件的动态类型上实现接口

> ID：752232
> 
> 赞同：1
> 
> 时间：2009-04-15T15:26:50.097
> 
> 标签：c#, reflection, il

我正在接受一个接口，循环遍历 .GetEvents() 返回数组并尝试在我的动态类型上实现该事件。当我尝试调用 TypeBuilder.CreateType() 时，我遇到了这个可爱的错误：

“来自程序集的类型的应用程序方法正在覆盖已被覆盖的方法。”

如果我注释掉尝试实现接口方法的 typeBuilder.DefineMethodOverride 调用，那么当我尝试订阅事件时，我会收到错误消息：

“方法或操作未实现。”

这是我尝试将检测到的事件添加到发出类型的方法。快速说明一下，我还有其他代码定义了类型并添加了在接口上实现这些方法的方法，所有这些代码都可以正常工作。在我尝试将事件添加到组合中之前，我没有遇到任何问题。

```
protected static void AddEvent(EventInfo interfaceEvent, TypeBuilder proxyBuilder)
    {
        // Event methods attributes
        MethodAttributes eventMethodAttr = MethodAttributes.Public | MethodAttributes.HideBySig | MethodAttributes.Virtual | MethodAttributes.NewSlot | MethodAttributes.Final | MethodAttributes.SpecialName;
        MethodImplAttributes eventMethodImpAtr = MethodImplAttributes.Managed | MethodImplAttributes.Synchronized;

        string qualifiedEventName = string.Format("{0}.{1}", typeof(T).Name, interfaceEvent.Name);
        string addMethodName = string.Format("add_{0}", interfaceEvent.Name);
        string remMethodName = string.Format("remove_{0}", interfaceEvent.Name);

        FieldBuilder eFieldBuilder = proxyBuilder.DefineField(qualifiedEventName,
            interfaceEvent.EventHandlerType, FieldAttributes.Public);

        EventBuilder eBuilder = proxyBuilder.DefineEvent(qualifiedEventName, EventAttributes.None, interfaceEvent.EventHandlerType);

        // ADD method
        MethodBuilder addMethodBuilder = proxyBuilder.DefineMethod(addMethodName,
            eventMethodAttr, null, new Type[] { interfaceEvent.EventHandlerType });

        addMethodBuilder.SetImplementationFlags(eventMethodImpAtr);

        // We need the 'Combine' method from the Delegate type
        MethodInfo combineInfo = typeof(Delegate).GetMethod("Combine", new Type[] { typeof(Delegate), typeof(Delegate) });

        // Code generation
        ILGenerator ilgen = addMethodBuilder.GetILGenerator();
        ilgen.Emit(OpCodes.Ldarg_0);
        ilgen.Emit(OpCodes.Ldarg_0);
        ilgen.Emit(OpCodes.Ldfld, eFieldBuilder);
        ilgen.Emit(OpCodes.Ldarg_1);                    
        ilgen.Emit(OpCodes.Call, combineInfo);            
        ilgen.Emit(OpCodes.Castclass, interfaceEvent.EventHandlerType);    
        ilgen.Emit(OpCodes.Stfld, eFieldBuilder);  
        ilgen.Emit(OpCodes.Ret);

        // REMOVE method
        MethodBuilder removeMethodBuilder = proxyBuilder.DefineMethod(remMethodName,
            eventMethodAttr, null, new Type[] { interfaceEvent.EventHandlerType });
        removeMethodBuilder.SetImplementationFlags(eventMethodImpAtr);

        MethodInfo removeInfo = typeof(Delegate).GetMethod("Remove", new Type[] { typeof(Delegate), typeof(Delegate) });

        // Code generation
        ilgen = removeMethodBuilder.GetILGenerator();
        ilgen.Emit(OpCodes.Ldarg_0);
        ilgen.Emit(OpCodes.Ldarg_0);
        ilgen.Emit(OpCodes.Ldfld, eFieldBuilder);    
        ilgen.Emit(OpCodes.Ldarg_1);                 
        ilgen.Emit(OpCodes.Call, removeInfo);            
        ilgen.Emit(OpCodes.Castclass, interfaceEvent.EventHandlerType);   
        ilgen.Emit(OpCodes.Stfld, eFieldBuilder);  
        ilgen.Emit(OpCodes.Ret);

        // Finally, setting the AddOn and RemoveOn methods for our event
        eBuilder.SetAddOnMethod(addMethodBuilder);
        eBuilder.SetRemoveOnMethod(removeMethodBuilder);

        // Implement the method from the interface
        proxyBuilder.DefineMethodOverride(addMethodBuilder, typeof(T).GetMethod("add_" + interfaceEvent.Name));

        // Implement the method from the interface
        proxyBuilder.DefineMethodOverride(removeMethodBuilder, typeof(T).GetMethod("remove_" + interfaceEvent.Name));

    } 
```

谷歌对此的帮助为零（搜索“正在覆盖已被覆盖的方法”只会返回很多水晶报表主题），而我整个上午都在为此苦苦挣扎。任何帮助将*不胜*感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T16:07:00.593

没关系。当我遍历接口的方法来实现它们时，我也意外地实现了添加/删除。

在我的循环中用这个修复它：`if(method.IsSpecialName) continue;`

# ruby-on-rails - 在 Rails 中存储/检索历史数据的技术

> ID：752240
> 
> 赞同：1
> 
> 时间：2009-04-15T15:27:59.360
> 
> 标签：ruby-on-rails, database, database-design

我正在寻找一些关于在事件发生时保存一些（不同）记录的快照的想法，例如用户从我的应用程序中获取文档，以便以后可以重新生成该文档。你推荐什么策略？我应该使用与具有当前值的表相同的表还是使用历史表？你知道任何可以帮助我完成任务的插件吗？请分享您的想法和解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T11:32:18.163

有几个插件可以做到这一点。

```
Acts_audited 
```

作为已审核的行为为所有可审核对象创建一个表，并且不需要更改现有表。您可以在每次更改时输入更改，并将更改存储为备注字段中的哈希值，即更改类型 (CRUD)。只需在应用程序控制器中使用一条语句指定要审核的模型，就可以很容易地进行设置。回滚取决于您，但信息就在那里。因为存储的信息只是构建整个对象的更改，因此可能由于后续更改而变得困难。

```
Acts_as_versioned 
```

设置起来有点复杂 - 您需要为每个要版本化的对象创建一个单独的表，并且您必须将版本 ID 添加到现有表中。回滚是非常容易的。github 上有一些分支提供了自上一个版本以来的更改哈希，因此您可以轻松突出显示差异（这是我使用的）。我的猜测是这是最流行的解决方案。

我没有经验的：acts_as_revisable。下次我需要版本控制时，我可能会试一试，因为它看起来更复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T15:38:39.553

我曾经这样做过一次。我们创建了一个新表，它的结构与我们要记录的表非常相似，每当我们需要记录一些东西时，我们都会做类似的事情：

```
attr = object_to_log.attributes
# Remove things like created_at, updated_at, other unneeded columns
log = MyLogger.new(attrs)
log.save 
```

不过，很有可能有插件/宝石可以做这样的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T17:30:09.550

我用过[`acts_as_versioned`](http://github.com/technoweenie/acts_as_versioned/tree/master)这样的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-14T15:32:51.873

OP 已经一岁了，但我想我会在其中添加[vestal_versions](http://github.com/laserlemon/vestal_versions)。它使用单个表来跟踪每个版本的序列化哈希。通过遍历更改记录，可以将模型恢复到任何时间点。

从这篇文章开始，似乎是社区的最爱......

# sharepoint - WebPart 安全性

> ID：752241
> 
> 赞同：3
> 
> 时间：2009-04-15T15:28:01.200
> 
> 标签：sharepoint, sharepoint-2007, web-parts

确保只有正确的用户才能在 Sharepoint 2007 中看到 Web 部件的最佳做法是什么？

已经向我建议了安全组和受众。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T16:30:23.640

这取决于您是在谈论 Web 部件的呈现还是从 Web 部件库添加 Web 部件。让我解释一下这两种情况：

1) 在 MOSS 2007 中，您确实可以使用受众来针对给定 Web 部件页面上的 Web 部件呈现。这正是 Web 部件上的 Audience 属性的设计目的。但是，对于 WSS 3.0 部署，这是不可能的，因为受众是 MOSS 的东西。

2) 在 Web 部件库中隐藏 Web 部件也是可能的，即如果您不希望所有具有设计权限的用户都能够在库中添加任何 WP。使用 WP 库中 .dwp / .webpart 文件的项目权限来限制访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T20:48:19.263

尽管受众不是安全机制，但对于 webpart 可见性，效果是相同的。Webpart 的问题是其他人可以将该 Webpart 添加到另一个页面，如果您没有在画廊中为 Webpart 设置保护，那么您无法控制其受众，正如 Lars 提到的那样。正如他还提到的，只有当您使用 MOSS 而不仅仅是 WSS 时，观众才可用。

另一个安全步骤是将逻辑放置在 Web 部件中以防止未经授权的使用。如果真的是安全问题，我会选择这种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:38:15.370

就最佳实践而言，这取决于。如果您使用受众群体，请先使用它们。这允许对内容可访问性进行集中管理。如果没有，项目权限可能是下一个最好的事情。之后，您必须在 webpart 本身的 Render() 中对其进行管理（坏主意）。

# grails - 在 grails 插件中将 mime 映射添加到 web.xml 的正确语法

> ID：752244
> 
> 赞同：2
> 
> 时间：2009-04-15T15:29:06.270
> 
> 标签：grails, groovy, grails-plugin

我正在尝试向 web.xml 添加一个 mime-mapping 元素。

我目前最好的刺是：

```
def doWithWebDescriptor = { xml ->
    xml + {
        'mime-mapping' {
            'extension'("htc")
            'mime-type'("text/x-component")
        }
    }
} 
```

我知道代码正在运行，因为上面实际上输出了一个无效的 web.xml。以下似乎更合乎逻辑，但实际上没有任何效果：

```
def doWithWebDescriptor = { xml ->
    xml.'mime-mapping' + {
            'extension'("htc")
            'mime-type'("text/x-component")
        }
} 
```

编辑：我正在使用 grails 1.0.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-05-01T00:02:52.077

我相信您现在可以通过将`mime-mapping`元素直接添加到 web.xml 模板来完成同样的事情，`src/templates/war/web.xml`如下所示：

```
<mime-mapping> 
    <extension>htc</extension>
    <mime-type>text/x-component</mime-type> 
</mime-mapping> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T14:23:51.507

尝试

```
def doWithWebDescriptor = { xml ->
    xml << {
        'mime-mapping' {
            'extension'("htc")
            'mime-type'("text/x-component")
        }
    }
} 
```

（注意，`leftShift`而不是`plus`）。

或者，如果您想确保将新元素插入到 XML 中的特定位置，您可以获取子元素，然后插入您的元素，然后使用`plus`运算符添加您的元素。例如，我使用以下代码添加新的 servlet 映射：

```
def servletMappings = xml.'servlet-mapping'
servletMappings[servletMappings.size() - 1] + {
    'servlet-mapping' {
        'servlet-name'("myServlet")
        'url-pattern'("/myURL")
    }
} 
```

如果您想进一步深入研究，请查看`groovy.util.slurpersupport.NodeChild`（`xml`参数属于该类型）及其超类`groovy.util.slurpersupport.GPathResult`。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T17:58:39.390

嗯，我能找到的唯一东西是必须设置的配置属性才能正确访问请求中的 mime 类型：

```
grails.mime.file.extensions = true 
```

尝试确保将其设置为 true，然后使用有效的代码再次尝试？

# php - PHP 查询失败

> ID：752260
> 
> 赞同：-4
> 
> 时间：2009-04-15T15:32:31.627
> 
> 标签：php, mysql

```
<?php
if(isset($_POST['upload']) && $_FILES['userfile']['size'] > 0)
{
$dbhost = 'localhost';
$dbuser = 'zuk1_boo';
$dbpass = 'lols';
$dbname = 'zuk1_boo';

$conn = mysql_connect($dbhost, $dbuser, $dbpass) or die ('Error connecting to mysql');

$name = $_POST['name'];
$iq = $_POST['iq'];

$nuname = str_replace(" ", "-", $name);
$nuname = $nuname.".gif";
$path = "img/$nuname";

move_uploaded_file($_FILES['userfile']['tmp_name'],$path);

$query = "INSERT INTO celebs (celeb,path1,iqq) VALUES ('$name','$path','$iq')";

mysql_query($query) or die('q fail');

mysql_close($conn);

echo "<br>File $fileName uploaded<br>";
}
?>

<form method="post" enctype="multipart/form-data">
<table width="350" border="0" cellpadding="1" cellspacing="1" class="box">
<tr>
<tr><td><input name="name" type="text" value="name"></td></tr>
<tr><td><input name="iq" type="text" value="iq"></td></tr>
<td width="246">
<input type="hidden" name="MAX_FILE_SIZE" value="2000000">
<input name="userfile" type="file" id="userfile">
</td>
<td width="80"><input name="upload" type="submit" class="box" id="upload" value=" Upload "></td>
</tr>
</table>
</form> 
```

请记住，有一个带有自动增量的 ID 行，但即使我将它添加到查询中，它仍然无法工作。

不管我用这个查询做什么，它都不会工作，我已经三次检查了 sql 详细信息，它们都很好，即使它看起来连接正常。我已经在查询中使用了字段名称，它们应该没问题，但它不起作用！5 美元 Paypal 给任何可以帮助我的人，老实说，我很沮丧，这是不真实的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-15T15:33:56.867

```
mysql_query($query) or die('q fail'); 
```

将此替换为

```
mysql_query($query) or die(mysql_error()); 
```

告诉我们你得到了什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T15:45:27.710

好吧，既然您已经解决了实际问题，我认为最好指出您有大量的[SQL 注入](http://en.wikipedia.org/wiki/Sql_injection)漏洞。

修复的理想方法是切换到使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)函数并使用参数化查询，但最快的修复是更改这些行：

```
$name = $_POST['name'];
$iq = $_POST['iq']; 
```

到

```
$name = mysql_real_escape_string($_POST['name']);
$iq = mysql_real_escape_string($_POST['iq']); 
```

您现在拥有的代码公开将非常不安全。

# svn - svn cms 的多个组件和模板的正确方法

> ID：752264
> 
> 赞同：1
> 
> 时间：2009-04-15T15:32:57.133
> 
> 标签：svn, content-management-system, joomla

我是svn的初学者。我知道创建存储库、检查、更新、创建分支等基本知识，但是在使用各种 cms 时，我在为存储库定义结构时遇到了一些困难。

假设我正在为 cms 创建很多组件和模板，例如 Joomla!。这些组件将在许多不同的门户中使用，可能彼此相关或不相关，并且模板也可能在运行中适应其他项目。

最好的方法是什么 - 创建一个名为“Joomla Projects”的存储库，以及其中的所有组件（因为有些模块非常简单，一个文件夹中有 4 个 php 文件），还是为每个组件创建一个存储库？

我不知道我是否让自己清楚，这是我第一次来这里。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T16:35:53.800

您可以在阅读[SVN Book](http://svnbook.red-bean.com/)中的[“规划您的存储库组织”](http://svnbook.red-bean.com/nightly/en/svn.reposadmin.planning.html#svn.reposadmin.projects.chooselayout)主题后自行决定。

这真的取决于你的需求。既然您说许多项目将共享许多小组件（即它们紧密相关），我认为您最好有一个带有单独`branches`/ `tags`/`trunk`文件夹的存储库：

```
components/
  component_1/
    trunk/
    tags/
    branches/
  component_2/
    trunk/
    tags/
    branches/
  ...
project_1/
  trunk/
  tags/
  branches/
project_2/
  trunk/
  tags/
  branches/
... 
```

这使得每个组件都有可能为不同的项目（如果需要）拥有不同的分支。

[SVN externals](http://svnbook.red-bean.com/nightly/en/svn.advanced.externals.html)在您的情况下也可能有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T15:37:50.100

我会用项目映射存储库。所以我会把所有东西都保存在同一个存储库中，我会做这样的事情：

```
vendor/
tags/
branches/
trunk/ 
      component1/
      component2/
      singleFileComponent1 
```

也许有一个相关组件的公共目录。

# c# - 如何从 XDocument 获取 XML 节点

> ID：752271
> 
> 赞同：35
> 
> 时间：2009-04-15T15:34:13.620
> 
> 标签：c#, .net, linq, linq-to-xml

如何使用 LINQ 从 XDocument 获取 XML 元素？

假设我有一个名为 XMLDoc 的 XDocument，如下所示：

```
<Contacts>
       <Node>
           <ID>123</ID>
           <Name>ABC</Name>
       </Node>
       <Node>
           <ID>124</ID>
           <Name>DEF</Name>
       </Node>
</Contacts>

XElement Contacts = from xml2 in XMLDoc.Elements("Contacts").Elements("Node")
                    where xml2.Element("ID").Value == variable
                    select xml2; 
```

但我收到错误“对象引用不设置.....”

如何使用 LINQ 从 XML 文件中获取特定节点？我想更新该节点中的一些值？

怎么可能？？？？

提前致谢.........

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2010-05-28T14:31:05.927

**测试.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<Contacts>
  <Node>
    <ID>123</ID>
    <Name>ABC</Name>
  </Node>
  <Node>
    <ID>124</ID>
    <Name>DEF</Name>
  </Node>
</Contacts> 
```

**选择单个节点：**

```
XDocument XMLDoc = XDocument.Load("test.xml");
string id = "123"; // id to be selected

XElement Contact = (from xml2 in XMLDoc.Descendants("Node")
                    where xml2.Element("ID").Value == id
                    select xml2).FirstOrDefault();

Console.WriteLine(Contact.ToString()); 
```

**删除单个节点：**

```
XDocument XMLDoc = XDocument.Load("test.xml");
string id = "123";

var Contact = (from xml2 in XMLDoc.Descendants("Node")
               where xml2.Element("ID").Value == id
               select xml2).FirstOrDefault();

Contact.Remove();
XMLDoc.Save("test.xml"); 
```

**添加新节点：**

```
XDocument XMLDoc = XDocument.Load("test.xml");

XElement newNode = new XElement("Node",
    new XElement("ID", "500"),
    new XElement("Name", "Whatever")
);

XMLDoc.Element("Contacts").Add(newNode);
XMLDoc.Save("test.xml"); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-15T16:01:25.177

.Elements 操作返回一个 XElements 列表 - 但您真正想要的是一个 SINGLE 元素。添加这个：

```
XElement Contacts = (from xml2 in XMLDoc.Elements("Contacts").Elements("Node")
                    where xml2.Element("ID").Value == variable
                    select xml2).FirstOrDefault(); 
```

这样，您告诉 LINQ 从您选择的 XElements 列表中为您提供第一个（或 NULL，如果不存在）。

马克

# c# - 加密我的框架和代码

> ID：752276
> 
> 赞同：1
> 
> 时间：2009-04-15T15:36:37.390
> 
> 标签：c#, asp.net, encryption

我正在创建自己的 CMS 框架，因为我拥有的许多客户都有相同的要求，例如新闻模块、时事通讯模块等。

现在我做得很好，唯一困扰我的是，如果客户想从我的服务器上移动，他会要求我把他的文件交给他，当然如果我这样做了，他会接受它的新人将看到我所有的代码，使用它并从 i 中受益，这对我来说太糟糕了，以至于我将所有时间都花在创建我的系统上，任何人都可以轻松看到代码，而且他会看到我系统的所有逻辑，他可以很容易地知道我网站的其他客户是如何工作的，这对我来说是一个威胁，最后我正在使用我为他们的许可证付费的第三方控件，我不希望他把它当作黄金盘子。

现在解决这个问题的最好方法是什么？我认为它正在加密，但我该怎么做以及它的效率如何？

-我应该将bin文件夹中的所有CS文件和Dll合并到一个Dll并加密它，我该怎么做？

我非常感谢在这件事上的所有帮助，因为这对我来说真的很重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:42:25.380

你应该读这个

[最佳 .NET 混淆工具/策略](https://stackoverflow.com/questions/2525/best-net-obfuscation-tools-strategy)

[混淆的效果如何？](https://stackoverflow.com/questions/551892/how-effective-is-obfuscation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T19:21:51.153

以我的经验，这很少值得付出努力。许多提供此类库的公司都不会费心混淆他们的代码（Telerik 等）。

特别是考虑到您正在编写的内容（CMS 无处不在），您可能会从花时间实现使您的产品/实施具有竞争优势并使公司看到您能够编写的软件具有价值的功能中获得更多收益，而不是代码本身。

最后，您要确保*您*是使软件为公司工作的关键因素，而不是您提供给他们的 DLL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T15:40:57.147

您需要预编译您的网站并混淆 dll。Visual Studio 附带了类似 Dotfuscator Community Edition 的东西。你可以试一试。

当然，HTML 输出、CSS 声明、数据库结构和存储过程代码不能加密。

但是，您可以尝试压缩 CSS，这也会降低其对人类的可读性。

在这里查看：[在整个 ASP.NET 应用程序中将 CSS 定义打乱到人类不可读状态的最佳方法](https://stackoverflow.com/questions/558877/the-best-approach-to-scramble-css-definitions-to-a-human-unreadable-state-through)

另一个想法是在您的 HTML 中使用一个框架，并将大部分网站页面放入其中。这样，在“查看源代码”时将不可见。

或者只是明确说明您将所做的一切作为服务提供，而不提供您工作的源代码。我不知何故怀疑销售人员是否愿意将他们的资源提供给任何提出要求的人。

# mysql - 无法将字符串插入 MySQL 文本列

> ID：752277
> 
> 赞同：3
> 
> 时间：2009-04-15T15:36:55.687
> 
> 标签：mysql, syntax, text, insert

出于某种原因，当我写入“文本”类型的列时，我的查询搞砸了。这是一个例子：

```
Describe messages;

Field         Type          Null  Key  Default  Extra
id            int(11)       NO    PRI  NULL     auto_increment
title         varchar(255)  YES        NULL 
body          text          YES        NULL 
to            text          YES        NULL 
content_type  varchar(255)  YES        NULL 
is_sms        tinyint(1)    YES        NULL 
user_id       int(11)       YES        NULL 
created_at    datetime      YES        NULL 
updated_at    datetime      YES        NULL 
```

然后我尝试插入：

```
INSERT INTO messages (id,title,body,to) VALUES ('1','Test Message','This is a test message. This is a test message. This is a test message. This is a test message.', 'an email' ); 
```

由于某种原因，这会导致一般的 MySQL 语法错误。如果我删除“to”列并且它是查询中的相应值，则查询工作正常。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T15:38:21.643

'to' 是 MySQL 中的保留关键字。您需要重命名列。

[http://dev.mysql.com/doc/refman/5.1/en/reserved-words.html](http://dev.mysql.com/doc/refman/5.1/en/reserved-words.html)

但是，如果您引用保留字，则允许它们作为标识符。

[http://dev.mysql.com/doc/refman/5.1/en/identifiers.html](http://dev.mysql.com/doc/refman/5.1/en/identifiers.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T15:40:21.857

试试这个

```
INSERT INTO messages (`id`,`title`,`body`,`to`) 
   VALUES ('1','Test Message','This is a test message. 
   This is a test message. This is a test message. This is a test message.', 
   'an email' ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T15:39:38.053

```
INSERT
INTO     messages (id,title,body,`to`)
VALUES   ('1','Test Message','This is a test message. This is a test message. This is a test message. This is a test message.', 'an email' ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T15:42:36.220

我相信如果你用这样的反引号包围“to”：

```
INSERT INTO messages (id,title,body,`to`) VALUES ('1','Test Message','This is a test message. This is a test message. This is a test message. This is a test message.', 'an email' ); 
```

它会起作用的——反正对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-16T13:02:28.440

使用 MySQL 中未定义的变量；例如：不使用'to'，'not'，'join' ...

INSERT INTO messages (id,title,body,test) VALUES ('1','Test Message','这是一条测试消息。这是一条测试消息。这是一条测试消息。这是一条测试消息。', '一封电邮' ）;

# java - Java中不可变对象的缺点？

> ID：752280
> 
> 赞同：35
> 
> 时间：2009-04-15T15:37:03.207
> 
> 标签：java, immutability

Java 中不可变对象的优势似乎很明显：

*   一致状态
*   自动线程安全
*   简单

您可以通过使用私有最终字段和构造函数注入来支持不变性。

但是，在 Java 中偏爱不可变对象有什么缺点呢？

IE

*   与 ORM 或 Web 演示工具不兼容？
*   不灵活的设计？
*   实施复杂性？

是否可以设计一个主要使用不可变对象的大规模系统（深度对象图）？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-15T16:25:17.413

> 但是，在 Java 中偏爱不可变对象有什么缺点呢？与 ORM 或 Web 演示工具不兼容？

基于反射的框架因不可变对象而变得复杂，因为它们**需要**构造函数注入：

*   Java 中没有默认参数，这迫使我们总是提供所有必要的依赖项
*   构造函数覆盖可能很混乱
*   构造函数参数名称通常不能通过反射获得，这迫使我们依赖参数顺序进行依赖解析

> 实施复杂性？

创建不可变对象仍然是一项无聊的任务；编译器应该注意实现细节，就像在[groovy中一样](http://groovy.codehaus.org/Immutable+AST+Macro)

> 是否可以设计一个主要使用不可变对象的大规模系统（深度对象图）？

绝对是的；不可变对象为其他对象提供了很好的构建块（它们有利于组合），因为当您可以依赖其不可变组件时，维护复杂对象的不变量会容易得多。对我来说唯一真正的缺点是创建许多临时对象（例如[String concat 在过去是一个问题](https://web.archive.org/web/20080324114426/http://java.sun.com/developer/JDCTechTips/2002/tt0305.html)）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-15T15:42:48.047

有了不变性，任何时候你需要修改数据，你都需要创建一个新对象。这可能很昂贵。

想象一下，需要修改消耗几兆内存的对象中的一位：您需要实例化一个全新的对象、分配内存等。如果您需要多次这样做，可变性就变得非常有吸引力。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T16:26:48.703

如果你追求可变性，那么你会发现，每当你需要调用一个你不想让对象改变的方法，或者你需要返回一个属于内部状态的对象时，你都需要进行防御复制。

如果您真的查看使用可变对象的程序，您会发现它们很容易通过修改来“攻击”：

*   传递给构造函数的对象
*   传递给方法的对象
*   从方法返回的对象。

这个问题不会经常出现，因为大多数程序不会更改数据（它们实际上是不可变的，因为它们永远不会改变）。

我个人将我可能做的每一件事都做好了。我可能将 90%-95% 的所有变量（参数、本地、实例、静态、异常等）标记为最终变量。在某些情况下它必须是可变的，但绝大多数情况下它不是。

我认为这可能取决于你的注意力。如果您正在为第三方编写库以供使用，那么您会比如果您正在编写只有您（或您的团队）将维护的应用程序考虑得更多。

我发现你可以为系统的大部分使用不可变对象编写大型应用程序，而不会带来太多痛苦。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-12T17:42:27.143

从根本上说，在现实世界中，与许多特定身份相关的状态会发生变化。如果我问“乔的别克现在的位置”是什么，今天它可能是西雅图的一个位置，明天它可能是洛斯阿拉莫斯的一个位置。可以定义和创建一个`GeographicLocation`对象，其值将始终表示 Joe's Buick 在某个特定时刻所处的位置，并且永远不会改变——如果今天它表示西雅图的一个地点，那么它将一直如此。然而，这样的物体将没有作为“乔的别克的当前位置”的持续身份。

也可以定义事物，以便有一个`VehicleLocation`连接到 Joe's Buick 的对象，使得该对象始终表示“Joe's Buick 的当前位置”。即使汽车四处移动，这样的对象也可以保留其作为“乔的别克车的当前位置”的身份，但不会代表一个恒定的地理位置。如果考虑到 Joe 将他的别克车卖给 Bob 并购买了一辆福特汽车的场景，那么定义“身份”可能会很棘手——对象应该跟踪“乔的福特汽车的当前位置”还是“鲍勃的别克汽车的当前位置”——但在在许多情况下，可以通过使用保证对象身份的某些方面永远不会改变的数据模型来避免此类问题。

一个对象的所有内容都不可能是不可变的。如果一个对象是不可变的，那么它就不能有一个不可变的身份来封装超出其当前状态的任何内容。然而，如果一个对象是可变的，它可以具有一个不可变的身份，其意义超越了它的当前状态。在许多情况下，拥有不可变身份比拥有不可变状态更有用，在这种情况下，可变对象几乎是必不可少的。虽然在某些情况下可以通过拥有一个不可变对象来“模拟”可变对象，该对象将搜索不可变对象的最新版本以查找可能在一个版本和下一个版本之间“更改”的信息，但这种方法通常是效率极低。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T15:45:26.603

你几乎回答了你自己的问题。我不相信 JavaBean 规范提到了关于不变性的任何内容，但 JavaBean 是许多 Java 框架的基础。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T15:48:57.063

对于习惯于命令式编程风格的人来说，不可变类型的概念有些不常见。但是，在许多情况下，不变性具有很大的优势，您已经命名了最重要的那些。

有很好的方法来实现不可变的平衡树、队列、堆栈、出队和其他数据结构。事实上，许多现代编程语言/框架仅支持不可变字符串，因为它们具有优势，有时还支持其他对象。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T16:21:39.137

对于不可变对象，如果需要更改值，则必须将其替换为新实例。根据对象的生命周期，用不同的实例替换它可能会增加永久（长期）垃圾收集时间。如果对象在内存中保留足够长的时间以放置在终身代中，这将变得更加关键。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-15T16:57:38.647

Java 中的问题是必须处理所有这些对象，其中类看起来像：

```
class Mutable {
    State1 f1;
    MoreState f2;
    void doSomething() {  // mutate the state, but don't document it }
    void doSomethingElse()  /// mutate the state heavily, do not mention in doc
} 
```

（注意缺少的 Cloneable 接口）。

如今，垃圾收集器的问题已经不是那么大了。虚拟机对短命的对象很满意。

编译器/JIT 技术的进步迟早将有可能优化中间临时对象的创建。例如：

```
BigInteger  three =, two =, i1 = ...;
BigInteger  i2 = i1.mul(three).div(two); 
```

JIT 可能会注意到中间对象 i1.mul(three) 可用于最终结果，并调用可用于可变累加器的 div 方法的变体。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-08-31T02:07:24.930

请参阅[函数式 Java](http://functionaljava.org/)以获得对您问题的全面回答。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T15:49:37.983

与其他所有设计模式一样，不可变性只应在需要时使用。你举了线程安全的例子：在一个高度线程化的应用程序中，你可以更喜欢不变性而不是自己让它成为线程安全的额外费用。但是，如果您的设计要求对象是可变的，请不要仅仅因为“这是一种设计模式”而使它们不可变。

至于你的图，你可以选择让你的节点不可变，让另一个类来处理它们之间的连接，或者你可以创建一个可变节点来处理它自己的子节点并具有一个不可变的值类。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-15T15:51:19.710

在 Java 中使用不可变对象的最大成本可能是未来的开发人员不会期待它或习惯于这种风格。期望大量记录或观察大量对象随着时间的推移产生可变对等点。

话虽如此，我能想到的避免不可变对象的唯一真正技术原因是 GC 流失。对于大多数应用程序，我不认为这是避免它们的令人信服的理由。

我用大约 90% 的不可变对象做过的最重要的事情是一个玩具式的解释器，所以它当然可以完成复杂的 Java 项目。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-05-29T09:08:01.323

在不可变数据中，您不会设置两次...请参阅 haskell 和 scala vals（以及 clojure of cource）...

例如..对于数据结构..像树一样，当您对树执行写操作时，实际上您是在不可变树之外添加元素..完成后..树和分支重新组合在一个新树..所以像这样你可以非常安全地执行并发读写..

在传统模型中，您必须锁定一个值，因为它可以随时重置..所以..您最终会遇到线程非常热的区域..因为它们无论如何都会按顺序执行..

使用不可变数据，您不会多次设置..它是一种全新的编程方式..您最终可能会使用更多的内存..但是并行化是自然而无痛的..

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-09-22T14:18:03.697

与任何工具一样，您必须知道何时使用它，何时不使用它。

就像 Tehblanx 指出的那样，如果你想改变一个持有不可变对象的变量的状态，你必须创建一个新对象，这可能会很昂贵，尤其是当对象又大又复杂的时候。绝对正确，但这仅仅意味着您必须明智地决定哪些对象应该是可变的，哪些应该是不可变的。如果有人说所有对象都应该是不可变的，那简直就是胡说八道。

我倾向于说表示单个逻辑“事实”的对象应该是不可变的，而表示多个事实的对象应该是可变的。比如，整数或字符串应该是不可变的。包含姓名、地址、当前金额、上次购买日期等的“客户”对象应该是可变的。当然，我可以立即想到这样一条一般规则的一百个例外。我一直在做的一个例外是，当我有一个作为包装器存在的类时，在某些情况下原语是不合法的（例如在集合中）保存原语，但我需要不断更新它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-11-10T03:04:55.217

在 Java 中，一个方法不能返回多个对象，例如`return a, b, c`. 返回一个对象数组会使代码看起来很难看。在这种情况下，我必须将可变对象传递给方法并让它改变这些对象的状态。但是，我不知道返回多个对象是否是代码异味。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-08-05T18:46:18.967

答案是否定的。没有任何好的理由是可变的。

您确实遇到了许多需要可变对象才能使用它们的框架（或框架版本）的问题（Spring 我正朝着您的方向发展）。当您与他们一起工作并浏览代码时，您会愤怒地握紧拳头，因为您需要将肮脏的可变性引入本来可以很容易避免的辉煌代码块中。

我确信存在有限的极端情况（可能比任何事情都更假设），其中对象创建和收集的开销是不可接受的。但我敦促提出这个论点的人看看像 scala 这样的语言，其中包含的集合在默认情况下是不可变的，然后看看基于该概念构建的大量性能关键应用程序。

这当然是夸张。实际上，您应该首先考虑不变性，看看它是否会给您带来任何**可衡量**的问题，如果确实会引入可变性，但请确保您可以证明它可以解决您的问题。否则，您只是无益地承担了责任。在这样做时，我认为您会发现很难提出“实施复杂性”和“不灵活”的客观案例。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-12-22T16:43:05.543

不可变对象的一些实现具有更新不可变对象的事务性方法。类似于数据库如何提供安全的提交和回滚。但与这里的许多答案形成鲜明对比。不可变对象永远不会改变。一个典型的操作是。

```
B = append(A,C) 
```

B 是一个新对象。就像 A 和 C 一样。没有对 A 或 C 进行任何修改。在内部，红黑树实现使这种语义足够快，可以使用。

缺点是它不如使操作到位那么快。但这只是比较系统的一个部分。在评估可能的缺点时，我们需要将系统视为一个整体。而且我个人对整个影响并不清楚。尽管我怀疑不变性最终会胜出。

I know some experts contend there is contention at the top level of the red black tree. And that has a negative effect in throught-put.

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-04-15T20:11:08.383

我对不可变数据结构的最大担忧是如何保存/重构它们。也就是说，如果一个类有最终字段，我不能实例化它*然后*设置它的字段。

# xml - 为什么不能通过 DBLink 发送 Oracle XMLType？

> ID：752284
> 
> 赞同：0
> 
> 时间：2009-04-15T15:37:25.860
> 
> 标签：xml, database, oracle, plsql, dblink

我有一些调用远程过程以发送 XMLType 的 PLSQL 代码。不过，它所做的是将 XMLType 分成多个 varchar2(4000) 参数，这些参数是该过程接受的。远程过程通过 DBLink 调用。

**为什么必须拆分 XMLType？此限制是否适用于最近的数据库版本 (10g)？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T09:43:02.317

因为 sys.xmltype 是用户定义的类型。

您可能会收到 PLS-00453 - 对象表或用户定义的远程操作不允许。

它可能适用于所有数据库版本（包括 10g 和 11g）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T14:23:41.450

在大多数情况下，Oracle 不支持处理通过数据库链接发送用户定义的类型或 LOB。XMLType 可以存储为 LOB 或 UDT，并且可能以相同的方式在内存中处理，因此它不起作用是可以理解的。

[这个问题](https://stackoverflow.com/questions/642035/oracle-sql-types-over-dblink)讨论了一般问题，并有一些可能的解决方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T01:30:03.943

这是 Oracle 长期存在的（也是愚蠢的）问题。

超过一定大小的 LOBS 不会成功传输，您必须将大数据分块成更小的块，然后再重新组合它们。

我不敢相信 Oracle 可以不修复这个问题，我从 Oracle 8 开始就已经意识到这个问题，但最近的版本可能已经修复了这个错误。

# deployment - 数据库迁移：使用构建脚本管理还是在应用启动时自动迁移？

> ID：752298
> 
> 赞同：3
> 
> 时间：2009-04-15T15:42:03.227
> 
> 标签：deployment, build-process, database-migration

我正在为新的 Web 应用程序开发部署系统，我想知道管理数据库迁移过程中的最佳点在哪里（如何进行迁移的问题完全是另一个问题）。

似乎有两种方法可以去：

1.  使用可以从命令行手动运行或作为自动部署/构建过程的一部分的迁移脚本
2.  在应用程序启动时运行迁移（我使用的是 ASP.NET，所以这可以很容易地完成，而不会导致长时间运行的用户请求）

有没有人对这些方法有任何建议/见解/经验？还有其他建议吗？

我明白为什么#1 可能更有吸引力——它让我可以完全控制数据库的更新时间。但是，我非常喜欢 #2，因为它允许我在部署之间快速迭代并减少手动过程。#2 也可以在我的开发机器上使用，以允许更快的迭代。嗯，开始认为拥有两者可能是一件好事......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:56:07.700

我们有一个拥有约 100 个客户端的销售团队系统，我们在应用程序启动时更新数据库（确实，我们是一个桌面应用程序。）我喜欢这种方法，如果我们有不确定的起点（客户端数据库是新的还是仅更新到版本 xyz？）。

但在服务器端，我更喜欢您的#1 选项：我们在虚拟机上创建一个 SQL 查询文件（基于原始数据库的副本），并针对真实服务器运行此查询。

所以恕我直言：

*   **断开连接的客户端：**启动、迭代脚本
*   **服务器：**根据实际和真实数据库在VM上创建的查询

所以我也对这个问题很感兴趣，并找到了一些（一半）框架作为[RikMigrations](http://www.rikware.com/RikMigrations.html)。经过一番谷歌搜索后，有一个关于数据库版本控制/迁移框架的良好起点：[.NET 数据库迁移工具综述](http://flux88.com/blog/net-database-migration-tool-roundup/)。不一定是文档，但团队博客可能很有趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:52:58.207

我更喜欢选项#1，因为它看起来更灵活。代替在每个应用程序启动时实际执行迁移，我想我会验证数据库模式（版本号？）是否与代码匹配，如果不匹配，则抛出有关数据库模式不匹配的警告或错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T19:29:25.843

如果应用程序必须在客户的机器上运行而不是在启动时迁移可以防止大量支持呼叫 - 假设您可以在没有用户干预的情况下进行无缝迁移（我希望您通常不会运行您的 Web 应用程序并获得修改数据库的权限）。

如果应用程序始终在您的控制下运行，则自动迁移不是问题 - 但仍然是一个很好的功能，特别是如果您希望最大限度地减少停机时间和手动部署步骤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T19:19:55.413

出于多种原因，我更喜欢选项＃1。首先，集成测试通常需要您的数据库架构是最新的，并且启动一个网站来升级架构将是一个巨大的浪费时间。其次，您不能在站点运行时更改数据库架构（例如，添加几个索引以加快速度）。

至于生产方面，在事务 MSI 样式安装中升级数据库比在每次应用程序启动时尝试升级要好得多，因为您可能最终得到不同步的数据库应用程序版本。

如果您正在寻找迁移框架，请查看[Wizardby](http://code.google.com/p/octalforty-wizardby/)。

# jquery - jQuery 动画

> ID：752300
> 
> 赞同：0
> 
> 时间：2009-04-15T15:42:30.637
> 
> 标签：jquery, jquery-animate, html, background-color

我在单击事件处理程序中有一些 JQuery 代码用于更新页面上跨度控件的值的复选框，然后将跨度标记的背景颜色设置为黄色，然后在大约一秒钟内淡化回白色以引起注意跨度值已更改的用户。问题在于，如果用户反复单击复选框，则动画会反复出现用户单击多少次。如果动画已经在进行中，任何人都知道如何防止出现 JQuery 动画。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:51:44.357

只需在动画对象上调用 stop() 即可：

```
 $('#button').click( function() {
  $('#animatedSpan').stop().animate( { } );
 }); 
```

# c# - 使用 recordType 的对象更新 Linq2Sql 中的记录

> ID：752303
> 
> 赞同：2
> 
> 时间：2009-04-15T15:42:48.373
> 
> 标签：c#, .net, linq-to-sql

以下简化代码不起作用（因为它将检索到的对象引用设置为参数），但它显示了我想要做什么

```
 public bool updateEvent(clubEvent newEvent)
    {
        TNightCon tCon = new TNightCon();
        clubEvent cEv = (from cEvent in tCon.clubEvents
                         where cEvent.EventID == newEvent.EventID
                         select cEvent).First();

        // Won't work, but do I have to set all the fields manually?
        cEv = newEvent;
        tCon.SubmitChanges();
        return true;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T16:08:25.690

或者，或者，

```
 tCon.ClubEvents.DeleteOnSubmit(cEv);
  tCon.CLubEvents.InsertOnSubmit(newEvent);
  tCon.SubmitChanges(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T17:04:52.233

您无需检索当前对象即可执行您需要执行的操作。如果 Id 相同，您需要做的就是将新对象附加到您的上下文中。然后技巧变成让 Linq2SQL 将对象视为“脏”。Timothy Khouri 有[一篇博客文章](http://www.singingeels.com/Blogs/Nullable/2009/01/09/How_to_Make_LINQ_to_SQL_Check_for_Changes_After_Attach_or_AttachAll.aspx)详细介绍了在上下文中使用 Refresh 方法的有用技术。这就是它的样子。

```
 public bool updateEvent(clubEvent newEvent)
    {
        tCon.clubEvents.Attach(newEvent);
        tCon.Refresh(RefreshMode.KeepCurrentValues, settings)
        tCon.SubmitChanges();
        return true;
    } 
```

# python - 将列表拆分为较小的列表（分成两半）

> ID：752308
> 
> 赞同：195
> 
> 时间：2009-04-15T15:44:40.023
> 
> 标签：python, list, split

我正在寻找一种轻松将 python 列表分成两半的方法。

所以如果我有一个数组：

```
A = [0,1,2,3,4,5] 
```

我将能够得到：

```
B = [0,1,2]

C = [3,4,5] 
```

* * *

## 回答 #1

> 赞同：293
> 
> 时间：2009-04-15T15:49:42.240

```
A = [1,2,3,4,5,6]
B = A[:len(A)//2]
C = A[len(A)//2:] 
```

如果你想要一个功能：

```
def split_list(a_list):
    half = len(a_list)//2
    return a_list[:half], a_list[half:]

A = [1,2,3,4,5,6]
B, C = split_list(A) 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2009-04-15T16:30:41.957

更通用的解决方案（您可以指定所需的零件数量，而不仅仅是“分成两半”）：

```
def split_list(alist, wanted_parts=1):
    length = len(alist)
    return [ alist[i*length // wanted_parts: (i+1)*length // wanted_parts] 
             for i in range(wanted_parts) ]

A = [0,1,2,3,4,5,6,7,8,9]

print split_list(A, wanted_parts=1)
print split_list(A, wanted_parts=2)
print split_list(A, wanted_parts=8) 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2010-02-07T02:30:56.317

```
f = lambda A, n=3: [A[i:i+n] for i in range(0, len(A), n)]
f(A) 
```

`n`- 结果数组的预定义长度

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2014-04-18T06:54:33.170

```
def split(arr, size):
     arrs = []
     while len(arr) > size:
         pice = arr[:size]
         arrs.append(pice)
         arr   = arr[size:]
     arrs.append(arr)
     return arrs 
```

测试：

```
x=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
print(split(x, 5)) 
```

结果：

```
[[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13]] 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2011-06-13T09:11:54.880

如果你不关心订单...

```
def split(list):  
    return list[::2], list[1::2] 
```

`list[::2]`从第 0 个元素开始获取列表中的每个第二个元素。
`list[1::2]`从第一个元素开始获取列表中的每个第二个元素。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-04-15T16:28:30.667

使用[列表切片](http://docs.python.org/tutorial/introduction.html#lists)。语法基本上是`my_list[start_index:end_index]`

```
>>> i = [0,1,2,3,4,5]
>>> i[:3] # same as i[0:3] - grabs from first to third index (0->2)
[0, 1, 2]
>>> i[3:] # same as i[3:len(i)] - grabs from fourth index to end
[3, 4, 5] 
```

要获取列表的前半部分，请从第一个索引切片到`len(i)//2`（`//`整数除法在哪里 - 所以`3//2 will give the floored result of`1 `, instead of the invalid list index of`1.5`）：

```
>>> i[:len(i)//2]
[0, 1, 2] 
```

..并交换周围的值以获得下半部分：

```
>>> i[len(i)//2:]
[3, 4, 5] 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-04-15T15:50:08.947

`B,C=A[:len(A)/2],A[len(A)/2:]`

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2012-07-20T07:17:29.403

这是一个常见的解决方案，将 arr 拆分为 count 部分

```
def split(arr, count):
     return [arr[i::count] for i in range(count)] 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-04-15T15:49:40.807

```
def splitter(A):
    B = A[0:len(A)//2]
    C = A[len(A)//2:]

 return (B,C) 
```

我测试过，在 python 3 中强制 int 除法需要双斜杠。我原来的帖子是正确的，尽管由于某种原因，所见即所得在 Opera 中中断了。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2018-12-30T09:10:44.623

如果您有一个大列表，最好使用**itertools**并编写一个函数来根据需要生成每个部分：

```
from itertools import islice

def make_chunks(data, SIZE):
    it = iter(data)
    # use `xragne` if you are in python 2.7:
    for i in range(0, len(data), SIZE):
        yield [k for k in islice(it, SIZE)] 
```

您可以像这样使用它：

```
A = [0, 1, 2, 3, 4, 5, 6]

size = len(A) // 2

for sample in make_chunks(A, size):
    print(sample) 
```

输出是：

```
[0, 1, 2]
[3, 4, 5]
[6] 
```

感谢[@thefourtheye](https://stackoverflow.com/a/22878842/4731038)和[@Bede Constantinides](https://stackoverflow.com/a/22878842/4731038)

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2011-04-21T21:44:10.557

对于将数组拆分为更小的 size 数组的更一般化的情况，有一个官方的 Python 收据`n`。

```
from itertools import izip_longest
def grouper(n, iterable, fillvalue=None):
    "Collect data into fixed-length chunks or blocks"
    # grouper(3, 'ABCDEFG', 'x') --> ABC DEF Gxx
    args = [iter(iterable)] * n
    return izip_longest(fillvalue=fillvalue, *args) 
```

此代码片段来自[python itertools 文档页面](http://docs.python.org/library/itertools.html)。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2014-05-27T17:17:30.603

这与其他解决方案类似，但速度更快。

```
# Usage: split_half([1,2,3,4,5]) Result: ([1, 2], [3, 4, 5])

def split_half(a):
    half = len(a) >> 1
    return a[:half], a[half:] 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-02-26T19:22:29.990

10 年后.. 我想 - 为什么不添加另一个：

```
arr = 'Some random string' * 10; n = 4
print([arr[e:e+n] for e in range(0,len(arr),n)]) 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-04-15T19:03:34.037

虽然上面的答案或多或少是正确的，但如果你的数组的大小不能被 2 整除，你可能会遇到麻烦，因为`a / 2`，a 是奇怪的，是 python 3.0 中的浮点数，如果你在早期版本中`from __future__ import division`在脚本的开头指定。无论如何，您最好进行整数除法，即`a // 2`，以获得代码的“前向”兼容性。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-10-05T20:43:02.223

```
#for python 3
    A = [0,1,2,3,4,5]
    l = len(A)/2
    B = A[:int(l)]
    C = A[int(l):] 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-08-02T04:24:25.720

来自@ChristopheD 的提示

```
def line_split(N, K=1):
    length = len(N)
    return [N[i*length/K:(i+1)*length/K] for i in range(K)]

A = [0,1,2,3,4,5,6,7,8,9]
print line_split(A,1)
print line_split(A,2) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-05-28T05:04:23.200

2020 年对这个问题的另一种看法……这是对这个问题的概括。我将“将列表分成两半”解释为..（即只有两个列表，并且在出现奇数的情况下不会溢出到第三个数组等）。例如，如果数组长度为 19，使用 // 运算符除以 2 得到 9，我们最终将得到两个长度为 9 的数组和一个长度为 1 的数组（第三个）（所以总共三个数组）。如果我们想要一个始终提供两个数组的通用解决方案，我会假设我们对长度不相等的结果双数组感到满意（一个会比另一个长）。并且假设可以混合顺序（在这种情况下交替）。

```
"""
arrayinput --> is an array of length N that you wish to split 2 times
"""
ctr = 1 # lets initialize a counter

holder_1 = []
holder_2 = []

for i in range(len(arrayinput)): 

    if ctr == 1 :
        holder_1.append(arrayinput[i])
    elif ctr == 2: 
        holder_2.append(arrayinput[i])

    ctr += 1 

    if ctr > 2 : # if it exceeds 2 then we reset 
        ctr = 1 
```

这个概念适用于你想要的任何数量的列表分区（你必须根据你想要的列表部分调整代码）。并且解释起来相当简单。为了加快速度，您甚至可以在 cython / C / C++ 中编写这个循环来加快速度。再说一次，我在相对较小的列表上尝试了这段代码 ~ 10,000 行，它在几分之一秒内完成。

只是我的两分钱。

谢谢！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-04-26T06:22:25.617

通用解决方案将列表拆分为 n 部分并进行参数验证：

```
def sp(l,n):
    # split list l into n parts 
    if l: 
        p = len(l) if n < 1 else len(l) // n   # no split
        p = p if p > 0 else 1                  # split down to elements
        for i in range(0, len(l), p):
            yield l[i:i+p]
    else:
        yield [] # empty list split returns empty list 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-10-22T17:04:37.533

```
from itertools import islice 

Input = [2, 5, 3, 4, 8, 9, 1] 
small_list_length = [1, 2, 3, 1] 

Input1 = iter(Input) 

Result = [list(islice(Input1, elem)) for elem in small_list_length] 

print("Input list :", Input) 

print("Split length list: ", small_list_length) 

print("List after splitting", Result) 
```

# c++ - 确保 C++ 双精度为 64 位

> ID：752309
> 
> 赞同：24
> 
> 时间：2009-04-15T15:44:52.550
> 
> 标签：c++, types, precision, compiler-construction, ieee-754

在我的 C++ 程序中，我需要从外部字节序列中提取一个 64 位浮点数。有什么方法可以确保在编译时双精度为 64 位？我应该使用其他类型来存储数据吗？

编辑：如果您正在阅读本文并*实际上*正在寻找一种方法来确保以 IEEE 754 格式存储，请查看下面的 Adam Rosenfield 的答案。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-15T18:17:14.070

在 C99 中，您可以检查是否`__STDC_IEC_559__`定义了预处理器符号。如果是，那么您可以保证 a`double`是一个 8 字节的值，用 IEEE 754（也称为 IEC 60559）格式表示。请参阅 C99 标准，附件 F。不过，我不确定此符号在 C++ 中是否可用。

```
#ifndef __STDC_IEC_559__
#error "Requires IEEE 754 floating point!"
#endif 
```

或者，您可以检查预定义的常量`__DBL_DIG__`（应为 15）、`__DBL_MANT_DIG__`（应为 53）、`__DBL_MAX_10_EXP__`（应为 308）、`__DBL_MAX_EXP__`（应为 1024）、`__DBL_MIN_10_EXP__`（应为 -307）和`__DBL_MIN_EXP__`（应为 -1021）。这些应该适用于所有类型的 C 和 C++。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-15T18:07:56.120

对其他答案的改进（假设 char 是 8 位，标准不保证这一点..）。会是这样的：

```
char a[sizeof(double) * CHAR_BIT == 64]; 
```

或者

```
BOOST_STATIC_ASSERT(sizeof(double) * CHAR_BIT == 64); 
```

`<limits.h>`您可以在或中找到定义的 CHAR_BIT `<climits>`。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-17T14:38:45.730

检查`std::numeric_limits< double >::is_iec559`您是否需要知道您的 C++ 实现是否支持标准双精度。这不仅保证了总位数为 64，还保证了 double 内所有字段的大小和位置。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-15T15:51:32.033

我认为您不应关注双精度的“原始大小”（通常是 80 位，而不是 64 位），而应关注其精度。

感谢 numeric_limits::digits10 这相当容易。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-15T15:48:07.657

没有boost的解决方案是像这样定义数组

```
char a[ 8 == sizeof(double) ]; 
```

如果双精度不是 64 位，那么代码将如下所示

```
char a[0]; 
```

这是一个编译时错误。只需在此说明附近添加适当的注释即可。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-15T15:48:34.210

您可以使用[Boost 静态断言](http://www.boost.org/doc/libs/1_38_0/doc/html/boost_staticassert.html)来执行此操作。查看在[命名空间范围内使用](http://www.boost.org/doc/libs/1_38_0/doc/html/boost_staticassert.html#boost_staticassert.namespace)示例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T18:13:17.857

有关类似问题和称为 CCASSERT 的非增强编译时断言，请参阅[此帖子。](http://bytes.com/groups/c/220022-if-sizeof)

# asp.net - tinymce 和 Jquery UI 对话框运行良好

> ID：752313
> 
> 赞同：0
> 
> 时间：2009-04-15T15:45:56.867
> 
> 标签：asp.net, jquery, asp.net-mvc, jquery-ui, tinymce

我在使用 Jquery UI Dialog 和 TinyMCE 时遇到了一些问题。
将数据传递到文本区域适用于 UI Dialog 和 Jquery。
因此，像这样在文本区域中设置数据可以正常工作：

```
 $("#MessageDialog #messageDto_Body").val(messagedata.Body);
        $("#MessageDialog").dialog("open"); 
```

当我将 tinyMCE 编辑器附加到文本区域时，它会正确添加编辑器（并且没有 UI 窗口，文本区域的内容会被保留）：

```
tinyMCE.execCommand('mceAddControl', false, 'messageDto.Body'); 
```

使用 UI 对话框，该区域是空的。

从我所见，tinyMCE 可以隐藏真实的文本区域并添加一个新区域。我也尝试过直接设置内容但没有运气：

```
 tinyMCE.activeEditor.setContent(messagedata.Body, {format : 'bbcode'}); 
```

有什么建议吗？

更新：用 jqModal 替换 Jquery UI 对话框，一切正常。我认为问题可能不依赖于 TinyMce，而是依赖于 Jquery UI 对话框

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-27T18:57:11.300

也许 jQuery [TinyMCE 插件](http://tinymce.moxiecode.com/examples/example_23.php)会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T16:11:39.210

tinyMCE 隐藏 textarea 并使用附加 '_' + 元素类型的 textarea 的 ID 添加多个元素。要访问 iframe 的内容，请尝试这样的操作。

```
$("#content_ifr").contents().find("body").html(messagedata.Body); 
```

其中#content 是您的文本区域的ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-19T13:21:15.797

`$('#myTextBox').tinymce(...`在打开对话框后，我通过使用 TinyMCE jQuery 插件初始化编辑器解决了这个问题。关闭并重新打开对话框似乎不会导致 jQ UI 1.8.16 出现问题。

# php - 使用 JQuery/PHP 的跨域 Ajax 请求

> ID：752319
> 
> 赞同：4
> 
> 时间：2009-04-15T15:48:20.233
> 
> 标签：php, javascript, jquery, ajax

帮忙的话，如果可以的话——

情况：

[http://foobar.com](http://foobar.com)包含一个远程托管的 javacript 文件 ( [http://boobar.com/stuff.js](http://boobar.com/stuff.js) )。

目标是从 foobar.com 上的远程托管 php 脚本中获取警报

我在 stuff.js 中尝试了以下代码：

```
$.ajax({
  type: "GET",
  url: "http://www.boobar.com/script.php?callback=?",
  dataType: 'jsonp',
  success: function(result) { alert(result); }
}); 
```

没运气。

```
$.getJSON("http://www.boobar.com/script.php?jsonp=?",
  function(data) { alert(data); }
); 
```

也没有运气。

在 php 方面，我尝试了以下两种方法：

```
return json_encode(array(0 => 'test'));

echo json_encode(array(0 => 'test')); 
```

在 Firefox 中，我收到一个安全错误。我了解它认为我违反了安全模型。但是，根据 jquery 文档，我应该能够做到这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T16:00:53.523

该错误似乎是[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)的一项安全功能：为简化起见，您只能对原始服务器 ( `http://foobar.com`) 上的内容发出 AJAX 请求。解决此问题的一种方法是在原始服务器上制作一个简单的外观，例如：

```
 <?php
 // this file resides at http://foobar.com/getstuff.php
 echo file_get_contents('http://www.boobar.com/script.php?callback=?'
          . $possibly_some_other_GET_parameters );
 ?> 
```

然后，您可以从 foobar.com 发出 AJAX 请求`http://foobar.com/getstuff.php`（这反过来会*从您的 Web 服务器*发出HTTP GET 请求`boobar.com`并将其发送回浏览器）。

对于浏览器，请求会发送到源服务器，并被允许（浏览器无法知道响应来自幕后的其他地方）。

注意事项：

*   foob​​ar.com 上的 PHP 配置必须`allow_url_fopen`设置为“1”。尽管这是默认设置，但某些服务器已禁用它。
*   对 www.boobar.com 的请求是从 foobar.com**服务器**发出的，而不是从浏览器发出的。这意味着不会将任何 cookie 或用户身份验证数据发送到 www.boobar.com，无论您在请求 URL (" `$possibly_some_other_GET_parameters`") 中输入什么。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T18:19:33.147

您可以使用脚本标签和 json 从另一台服务器异步获取数据：

```
<script type="text/javascript" src="http://somesite.com/path/to/page/"></script> 
```

您可以使用它来动态加载远程 javascript（通过创建一个新的脚本元素并设置 src 属性，然后加载到 DOM 中），这可以设置一个变量。但是，您需要真正**信任**远程站点，因为 JS 将在*没有任何前提条件*的情况下进行评估。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T18:29:23.073

有一种方法称为`window.name transport`或`window.name method`使用一般浏览器错误（不确定这实际上是否是错误）。您通过 iFrame 发出请求，加载的页面将您需要的信息放入自身 JavaScript 窗口对象的“名称”属性中。

此方法使用“blank.htm”，因为它首先导航到目标页面，然后返回到 blank.htm 页面以克服“同源策略”限制。

[Dojo 已经实现了这一点，您可以在此处](http://www.sitepen.com/blog/2008/07/22/windowname-transport/)找到更详细的说明。

此外，我在我编写的库中实现了一个基于此方法的跨域 XMLHttpRequest 对象，可以在[此处](http://jslib-test.amplio-vita.net/JSLib/js/aV.main.ajax.js)找到。

You may not be able to use the library since it will need 1 or 2 additional libraries which can be found [here](http://jslib-test.amplio-vita.net/JSLib/js).

If you need further help in implementing it in your style, I'll try to do my best.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T14:12:49.573

So what I ended up doing, since it was just a GET - no data need to be retrieved - I used JQuery to create a hidden iframe with the URL including the variables I wanted to pass set as the source. Worked like a charm. To all who provded feedback - Thanks!

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-11T01:45:46.197

How about this !! Using a php proxy.

Cross-Domain AJAX calls using PHP [http://www.phpfour.com/blog/2008/03/cross-domain-ajax-using-php/](http://www.phpfour.com/blog/2008/03/cross-domain-ajax-using-php/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-09T18:59:26.723

jQuery .ajax also has a setting 'crossDomain'.

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

```
crossDomain (default: false for same-domain requests, true for cross-domain requests)
Type: Boolean
If you wish to force a crossDomain request (such as JSONP) on the same domain, set the value of crossDomain to true. This allows, for example, server-side redirection to another domain. (version added: 1.5)

```

# visual-studio-2008 - 比较两种方法的文本

> ID：752320
> 
> 赞同：3
> 
> 时间：2009-04-15T15:48:22.307
> 
> 标签：visual-studio-2008, diff

有没有可以区分两种方法的工具？我正在处理一些遗留代码，这些代码有几个 100-200 行方法，其中包含大量重复，我想将重复抽象出来。能够区分这两种方法将是一个巨大的帮助。万一这很重要，我正在使用 .NET 和 Visual Studio 2008。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-17T09:11:23.323

我将[WinMerge](http://winmerge.org/)与[ClipboardDiff](http://visualstudiogallery.msdn.microsoft.com/a7519ab0-6029-49f3-9243-a74d1718a5bb)结合使用。然后，您可以在剪贴板内容和突出显示的内容之间进行比较，而无需保存任何文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:51:16.747

我已经使用[WinMerge](http://winmerge.org/)来解决这个问题。

我将这些方法复制到 WinMerge 中的新文档中，然后在那里处理它，直到我剪掉多余的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T15:58:06.153

我推荐 Simian：[http ://www.harukizaemon.com/simian/](http://www.harukizaemon.com/simian/)

*编辑添加新链接。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T16:05:35.433

不知道这对您是否实用，但（不出所料）emacs 可以对两个文件中的区域执行此操作，既可以逐行比较，也可以逐字比较。

如果有兴趣，请查找 emacs ediff（它还进行文件/缓冲区比较、文件与祖先文件、补丁、3 个文件比较和合并......非常全面）。我认为我在任何其他编程编辑器中都没有见过如此好的差异/合并系统。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T15:51:05.263

我为此使用了 checkstyle，但它是用于 java 的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T15:58:06.573

Visual Studio 2008 Team Edition 包含文档比较功能。因此，根据您运行的版本，您可能只需要右键单击解决方案资源管理器并选择“比较”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T15:58:53.780

subversion GUI 客户端[Tortoise](http://tortoisesvn.tigris.org/)可以制作两个文本文件（或本例中的代码文件）的差异，只需将两种方法复制到不同的 txt 文件中，选择它们，右键单击并从乌龟菜单中选择差异。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T16:01:05.647

[Sourcegear 的 Diffmerge](http://sourcegear.com/diffmerge/)非常好用且免费。您需要将代码切割成不同的文件，以便可以一边/一边比较它们。您可以使用此（以及大多数类似的实用程序）一次比较三个文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-17T00:19:24.033

您可以使用[Diffuse 之](http://diffuse.sourceforge.net/)类的工具。只需将文件拖放到任一窗格中，从一种方法中选择一行，右键单击另一个窗格中对应的行，然后选择“对齐到选择”。您甚至可以双击然后开始直接在 Diffuse 中重构代码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-06T22:14:08.647

这是一个基于网络的工具，可以很好地进行比较。只是用它来比较几个正在一起重构的类似方法。

[http://www.text-compare.com/](http://www.text-compare.com/)

# c# - 在 C# 中安排任务的最佳方式

> ID：752326
> 
> 赞同：2
> 
> 时间：2009-04-15T15:49:31.947
> 
> 标签：c#, .net

我正在开发一个需要能够在不同时间安排各种异步任务的 C# 程序。我需要一个每秒激活一次以检查要执行的任务并消耗尽可能少的资源的解决方案。它还需要很好地扩展到大量任务。哪个更好用，或者有没有？

1) 使用经过 1 秒时间的 System.Timers.Timer 对象来触发执行任务的事件，或者

2) 使用一个单独的线程，该线程休眠 1 秒，然后在唤醒时执行任务，或者

3）完全不同的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T15:52:21.500

`System.Threading.Timer`非常轻巧。您可以为每个任务创建一个单独的计时器，以便计时器在任务应该执行时到期。

在内部，我相信系统将跟踪下一个到期的计时器，因此它只需要在任何给定时间监视一个计时器（[来源/类似问题](https://stackoverflow.com/questions/31581/how-scalable-is-system-threading-timer)）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T15:50:48.387

尝试查看[Quartz.Net](http://quartznet.sourceforge.net/)以满足您的日程安排需求。我觉得还不错。

# php - 在 php 中创建会话的最安全方法

> ID：752332
> 
> 赞同：2
> 
> 时间：2009-04-15T15:50:02.723
> 
> 标签：php, session, session-variables

我在一个网站上工作，想创建用户登录和会话。检查会话是否存在（如cookie或会话变量检查）的最安全方法是什么，或者在php中使用会话有什么更好的主意？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T16:23:54.997

> `session_id()`返回当前会话的会话 ID，如果没有当前会话（不存在当前会话 ID），则返回空字符串 ("")。
> 
> [http://de.php.net/manual/en/function.session-id.php](http://de.php.net/manual/en/function.session-id.php)

但这只是告诉您会话是否处于活动状态。

大多数时候，我只是`session_start();`在每个脚本的开头调用（即使用户没有登录）。登录时，我`$_SESSION['user']`使用用户 ID 或用户对象进行设置。注销时，我只是`unset($_SESSION['user']);`。通过检查`empty($_SESSION['user'])`我可以检查是否有人仍然登录。如果您在会话中的其他位置存储与用户相关的信息，请不要这样做，否则下一个登录的人可能会得到他不应该看到的信息（在这种情况下使用`session_destroy();`）。

但安全吗？只需通过 GET/POST url 重写（仅限 cookie）停用 session-id 传播，因此它们最终不会出现在可以缓存或分发给其他人的 URL 中（在这种情况下，会话劫持是可能的）。您可以通过`session.use_only_cookies`在 php.ini 中进行设置来做到这一点。

如果您在不受信任和/或配置错误的共享服务器上托管，则可能存在其他安全问题 - 它可能导致同一台机器上的其他人读取您的会话数据。在这种情况下，您可以通过重写会话处理程序将会话数据存储在数据库中。只需在 intertubes 上搜索`session handler mysql`，我确信有足够的现成解决方案。并且不要在会话中存储密码等敏感信息，每次需要比较时最好进行查询。

除此之外...使用 ssl/https 进行登录和用户管理，因此不会传输明文密码。仅在数据库中存储带盐的 pw 哈希。不要让任何人看到密码（意思是：永远不要将它们打印到 html 或电子邮件中）。不要对用户可以看到的 id 使用 auto_increment 值（因此，猜测）。好的，这已经超出了问题的范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:53:41.170

这里有一些关于会话安全的教程

*   [PHP 安全指南：会话](http://phpsec.org/projects/guide/4.html)
*   [PHP 会话安全注意事项](http://www.sitepoint.com/blogs/2004/03/03/notes-on-php-session-security/)
*   [PHP 会话安全 - php|works 2004](http://talks.php.net/show/phpworks2004-php-session-security)（旧但仍然很有趣）
*   [PHP 会话安全 (PDF)](http://segfaultlabs.com/files/pdf/php-session-security.pdf)

# c# - 布尔类型

> ID：752335
> 
> 赞同：2
> 
> 时间：2009-04-15T15:50:28.043
> 
> 标签：c#, language-agnostic, coding-style, boolean

在代码审查期间，我发现我们的 C# 代码的许多地方如下所示：

```
if(IsValid()) {
     return true;
}
else {
     return false;
} 
```

甚至“更好”：

```
return (IsValid()? true : false); 
```

我一直想知道为什么不直接写这样的代码：

```
return IsValid(); 
```

这就是我编写此代码的方式。我不是在质疑开发人员的技能，而是在尝试深入了解开发人员的灵魂。为什么开发人员喜欢更复杂的代码而不是更简单直观的代码？或者可能是因为很难接受布尔类型作为一等公民？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-15T15:52:03.327

我认为`return IsValid();`是完全有效且可读的代码。

顺便说一句，我肯定会打任何写 ( `IsValid() ? true : false`) 的人的脸。这是不必要的复杂。

PS。这就是`svn blame`设计的目的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T16:00:06.710

是的，你应该按照你说的去做。这些人正在做这些过于冗长的事情，因为他们最初是这样学习的，也许是在 CS 101 中，他们从来没有想过要走出*他们所知道的工作*空间，看看是否有更好、更简单的方法。

这确实说明了他们的能力。优秀的程序员需要多一点深思熟虑，少一些拘谨。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T15:55:42.930

前两个例子的原因完全是人为的：

*   无知
*   缺乏对代码的智力参与
*   代码被重构，但只进行了一半

没有理由不（我知道这是一个双重否定）去`return IsValid();`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-15T15:59:24.620

如果你心不在焉，很容易从中重构一些代码：

```
private bool ConsiderTheOstrich()
{
    /* do ostrich things */

    if(someCondition && unpredictableThing == 5)
        return true;
    else
    {
        // log something
        return false;
    }
} 
```

对此：

```
private void IsValid() { return (someCondition && unpredictableThing == 5); }

/* ... */

private void ConsiderTheOstrich()
{
    /* do ostrich things */

    if(IsValid())
        return true;
    else
        return false; // ostrichlogger logs it for us now
} 
```

没有注意到简洁的额外机会。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T16:44:02.563

***调试***时，第一种情况更容易。当您单步执行您的源代码时，更容易找出返回值是什么，而无需打开`immediate window`或运行`IsValid();`只是为了查看返回值。

对于第一种和第二种情况，开发人员可能***不知道***他/她可以简单地做

> 返回 IsValid();

最后，由于公司政策，开发人员可能被迫使用第一种或第二种语法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T15:52:26.260

我也会说“return IsValid();” 我认为你这样做是 100% 正确的

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T15:53:04.200

`return IsValid();`是要走的路。更少的代码，更简洁——冠军的选择

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T16:00:03.853

我什至有时会看到我维护的一些遗留代码：

```
bool retValue;
if (IsValid()) 
{
    retValue = true;
}
else 
{
    retValue = false;
}

return retValue; 
```

一些程序员是按角色付费的吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T16:00:59.233

是的，`return IsValid();`如果您拥有的唯一代码如上所示，那当然是最佳选择。

我猜想发挥作用的是您的功能还在做什么？其余代码可能会更清楚地说明为什么开发人员会在 IsValid() 周围放置 if 语句。

毕竟，如果它只是返回 IsValid() 那么为什么调用代码不直接检查 IsValid() 而不是使用这个包装方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T16:48:31.477

**分心**

我知道它以前在我的代码中发生过，我可以追溯到我在编码时被打断或不注意的时候（我完全责怪 SO！）

**无知**

不知道更好的方法来做到这一点。我们理所当然地认为所有程序员都有逻辑思维，但事实并非如此。一些编码人员纯粹是按照他们以前见过的模式进行的：

```
If (integerA == integerB) { //do special stuff }

//Given integer equality; boolean equality ought to look the same...
If (isValid() == true ) { //do special stuff } 
```

**势头**

这就是某人一直这样做的方式，因此这就是他们继续这样做的方式。

# php - 限制 PHP 脚本的建议/技巧

> ID：752337
> 
> 赞同：7
> 
> 时间：2009-04-15T15:50:55.250
> 
> 标签：php, cron, lamp, wamp

我有一个定期（每小时）运行脚本的计划任务。该脚本与数据库和文件系统进行了一些繁重的交互，并且通常需要几分钟才能运行。问题是，脚本运行时服务器的 cpu 使用率达到峰值并减慢正常操作。有没有办法限制这个过程，让它花费更长的时间但不消耗太多的资源？

我查看了 PHP 的不同配置选项，但似乎没有任何适合我的需要。

将 php.ini 中的 memory_limit 设置为较低的值会导致我的数据对象很容易溢出。

我看过类似的帖子，人们建议在脚本中的某些点使用 sleep() ，但这并不能阻止脚本对服务器的刺激。

最佳解决方案是通过某种方式告诉 Lamp（在本例中为 Wamp）堆栈仅使用 10% 的最大 cpu 利用率。我根本不关心运行时间，如果这意味着每秒节省 cpu 周期，我宁愿花费更长的时间。我的替代解决方案是设置一个具有数据库复制功能的不同服务器，这样 cron 就可以在不减慢其他所有速度的情况下运行。

环境：Windows Server 2k3、Apache 2.2.11、PHP 5.2.9、MySQL 5.1

我很感激对这种情况的任何见解。

**编辑：**我很欣赏所有答案，即使是 *nix 特定的答案。在我的情况下，改变托管环境还为时过早。无论操作系统如何，希望这个问题都能帮助其他人。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T16:02:39.307

这是一个棘手的问题。如果您通过命令行运行 PHP 脚本，您可以将进程的调度优先级设置为低（`start /low php.exe myscript.php`我相信）。如果您的 PHP 脚本本身实际上正在执行大部分消耗 CPU 的处理，那么这可能会起作用。但是，您说您正在执行一些繁重的数据库和文件系统交互，此解决方案将无济于事。看起来对于 INSERT 和 UPDATE 查询有一个 MySQL 提示“LOW_PRIORITY”可以帮助你，但我没有尝试过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T01:27:11.977

在**UNIX** (LAMP) 中，我设法通过在继续循环之前检查服务器的负载来解决问题

```
function get_server_load($windows = 0) {
    $os = strtolower(PHP_OS);
    if(strpos($os, "win") === false) {
        if(file_exists("/proc/loadavg")) {
         $load = file_get_contents("/proc/loadavg");
         $load = explode(' ', $load);
         return $load;
        }
        elseif(function_exists("shell_exec")) {
         $load = explode(' ', `uptime`);
         return $load;
        }
        else {
         return "";
        }
    }
}

for(... ... ...){
    $data = get_server_load(); 
    if($data[0] < 0.2){
     // continue
    }else{
        sleep(1);
    }
} 
```

这个功能也应该在 Windows 上工作，但我不能保证。在 linux 上，它会返回一个数组，其中包含最后 1 分钟、5 分钟和 15 分钟的负载

此外，考虑以较低的优先级启动脚本（如果通过 CLI）（在 Linux 中，使用“nice”）

您还可以在继续循环之前使用其他值，例如 Apache 活动进程的数量（如果您在 httpd.conf 中启用了 mod_status，您可以解析页面 127.0.0.1/server_status?auto），或者 MySQL 情况（活动连接?)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T16:00:23.417

[您可以将 Windows 中的进程设置为较低的优先级。](http://www.itworld.com/nls_windows_lowpriority060814)我不确定该进程是如何启动的，但是如果您将进程设置为低优先级，那么如果您将优先级设置为非常低，那么任何想要 CPU 资源的东西都会得到它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T16:07:49.827

您可以更改您的 cron 条目以使用[nice](http://manpages.courier-mta.org/htmlman1/nice.1.html)启动您的脚本吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T16:09:51.490

**使用服务器为客户提供服务和分析数据**并不是一个好主意。****

 **因此，如果您正在寻找最终解决方案，请对您的应用程序进行一些重新设计，并将数据分析从前端和实时数据库卸载到另一个专门用于此任务的系统。

即使您可以成功地限制分析器，它也会占用宝贵的资源，否则可以为用户提供服务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T04:55:51.903

也许您的脚本只是试图一次做太多事情。如果每小时跑三趟，它会不会做得更少？

另一种解决方案可能是设置一个额外的服务器来运行这种“后端”处理。如果它没有在数据库中增加过多的负载，而只是在 Web 服务器中，这将特别有效。

另一种看待的方法是，它的工作是否可以朝不同的方向划分。这些类型的脚本通常有一些大的 SQL 语句，这些语句生成的结果用于生成大量的小 SQL 语句。如果后者可以放在某处，则可以在稍后的步骤中针对数据库运行它们。这种方法还可以让您使用无缓冲查询来获取预处理数据，这可以显着减少 PHP 代码的内存消耗。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T16:20:59.297

我有一堆脚本，我使用 nice 以类似的方式从 cron 运行：

0 * * * * 不错 -n19 php myscript.php

这不会帮助 RAM 利用率（只有改变脚本的编写方式才能做到这一点），但它只使用本来空闲的 CPU。

编辑：没有看到这个问题涉及 Windows 环境，对不起......把这个留给任何有同样问题的 *nix 用户..

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-15T15:59:39.097

这可能是一个困难的改变，但值得将您的数据结构重构为迭代器。此外，如果您的代码中有循环引用，请提供一个类似 clearReferences() 的方法来取消设置这些对象。顺便说一句，这是在 PHP 5.3 中解决的问题。

因此，如果您有：

```
class Row
{
    protected $_table;

    public function __construct($table)
    {
        $this->_table = $table;
    }
}

class Table
{
    protected $_row;

    public function __construct()
    {
        $this->_row = new Row($this);
    }
} 
```

向 Row 类添加 clearReferences() 方法：

```
class Row
{
    public function clearReferences()
    {
        $this->_table = null;
    }
} 
```

这就是我暂时能想到的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T16:00:56.863

如果您将它（Apache）作为服务运行，您可以在 Win 控制中心 /services 中更改优先级设置。无论如何，您的 CPU 使用率都会飙升，但调度程序会首选其他程序。还尝试将数据库/服务器放在与您的应用程序不同的高清上。

# .net - 配置字体有多重要，真的吗？

> ID：752344
> 
> 赞同：17
> 
> 时间：2009-04-15T15:51:43.610
> 
> 标签：.net, fonts, garbage-collection, gdi+, finalizer

我知道最好的做法是在任何实现 IDisposable 的对象上调用 Dispose，尤其是包装有限资源（如文件句柄、套接字、GDI 句柄等）的对象。

但是我遇到了一个情况，我有一个有字体的对象，我必须通过几层对象来探测 IDisposable，并查看很多用法，以确保我总是处理字体。我想知道它是否值得复杂。

如果 Font 包装了 HFONT，那将是一回事，因为 GDI 资源是系统全局的。但是 Font 不包装 GDI 句柄；它是 GDI+，它是一个完全独立的系统，据我所知，它是本地进程，而不是像 GDI 那样的系统全局。与 Image 不同，Font 永远不会占用文件系统资源（无论如何我都知道）。

所以我的问题是：让字体收集垃圾的真正成本是多少？

我知道我会对终结者造成一点打击，但如果“泄漏”字体的数量很少（比如六个），那么老实说，这种打击不会引起注意。除了终结器之外，这似乎与分配一个中等大小的数组并让 GC 清理它没有太大区别——它只是内存。

让字体获得 GCed 是否有我不知道的成本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T15:57:05.173

问题是垃圾收集仅在内存压力存在时发生。通常，非托管句柄比内存更受限制，因此您可能会在 GC 发生之前用完句柄，从而导致错误。

但是对于一两个`Font`实例，它不会过度伤害你。

一个更大的问题是一些对象是共享的，不应该（或不能）过早地处置......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T15:58:00.833

简单的回答：如果只是几个，那么没有。如果它很多，那么是的。如果您的应用程序已经对垃圾收集器施加压力，那么可以。我会使用 perfmon 查看周围的对象数量，以及提升到更高代的数量，然后再决定。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-15T16:52:58.843

为什么不做完就扔掉？仅仅因为我们有清道夫，并不意味着我们应该到处乱扔垃圾。但是，在给出的示例中，如果对象的生命周期需要字体，则在该对象的 dispose 中处置该字体。有很多事情也可以简化我的代码，但这并不能证明这些更改是合理的——有时有些事情你应该做，即使这很痛苦。

自己收拾东西总是一个好主意。当您不再需要某物时，请丢弃它。这样，您就可以避免令人讨厌的竞争条件、内存不足异常、绘图故障以及冗长的处理器密集型垃圾收集。

我发现如果您不再需要一次性物品，最好将其丢弃，除非有正当理由不这样做（例如您不拥有该物品）。追查问题的根本原因比预先编写防御性代码更难。

关于字体，[MSDN 说](http://msdn.microsoft.com/en-us/library/system.drawing.font.dispose.aspx)：

> 在发布对字体的最后引用之前，请始终调用 Dispose。否则，在垃圾收集器调用 Font 对象的 Finalize 方法之前，它正在使用的资源不会被释放。

它没有说明资源是什么，但它们明确声明应该隐含地完成这一事实增加了调用 Dispose 的重要性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-16T18:24:23.730

*处理任何东西*有多重要，真的吗？恕我直言，当您开始提出此类问题时，听起来您的代码中存在设计问题。你应该总是处理你不再需要的东西——这叫做负责任的编程。

您的问题的可能解决方案：

*   请勿传递诸如`Fonts`. **在一个地方（一个类）实现字体使用逻辑**，将字体添加为该类的字段并`IDisposable`为该类实现。

*   **实现一个字体缓存类**——而不是在整个代码中使用运算符创建新`Font`对象，而是`new`使用这个类来获得所需的`Font`. 如果可能，该类可以具有重用现有字体的逻辑。或者将最后 10 种字体保留在内存中，并丢弃其他字体。为缓存实现`IDisposable`，它将在您的应用程序的生命周期中调用一次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T17:23:08.663

终结器专门内置在类中，因为清理是必要的。无论您有大量或少量的对象要清理，清理它们都是一个好习惯。

GC 是为了拥有自己的伪思维而构建的。通过正确处理你的对象，你允许 GC 做它应该做的事情。

但是，如果您正在创建大量字体对象并处理所有字体对象，则每隔一段时间在适当的代（可能是第 0 代）调用 GC 以根据类型自行启动 GC 清理可能是有益的您正在大量实例化的其他对象。您的目标应该是让您知道您不会使用很长时间的物品不会被提升为老一代。这使 GC 的工作保持精简和平均。

只要用你最好的判断，你会没事的。但是，作为您的正常做法，确实要使用终结器处理任何对象。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-02-20T00:11:46.243

我至少运行了一个使用 .NET 运行时的其他应用程序。我不断收到 OutOfMemoryExceptions。最好让您的应用程序正常运行，以便其他应用程序在无法获得足够资源时不会抛出异常。

# python - 这里有人尝试过使用 iSeries Python 端口吗？

> ID：752349
> 
> 赞同：9
> 
> 时间：2009-04-15T15:52:06.183
> 
> 标签：python, ibm-midrange

我找到了[http://www.iseriespython.com/](http://www.iseriespython.com/)，这是 iSeries 的 Python 版本，显然包括一些系统特定的数据访问类。我很想尝试一下，但必须在工作中获得批准才能这样做。我的问题是：

端口是否运行良好，或者与标准 Python 实现相比，解释器可以处理的内容是否存在限制？

iSeries 数据库访问层是否工作良好，从表定义创建可用对象？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-25T05:35:36.143

从我目前看到的情况来看，它工作得很好。请注意，我使用的是 iSeries Python 2.3.3。字符串本身就是 EBCDIC 的事实可能是个问题。这绝对是许多第三方软件包无法按原样运行的原因之一，即使它们是纯 Python。（在某些情况下，可以对它们进行调整和调整，以便明智地使用编码和解码。）据说 2.5 原生使用 ASCII，这在原则上会提高兼容性，但我无法对此进行测试，因为我太 -旧版本的 OS/400。

部分是因为 EBCDIC，部分是因为 OS/400 和 QSYS 文件系统既不是类 Unix 也不是类 Windows，有些标准库没有实现或实现不完善。这对你的影响有多严重取决于你想要做什么。

从好的方面来说，特定于 iSeries 的功能运行良好。处理物理文件和流文件非常容易。从 Python 调用 CL 或 RPG 程序相当轻松。总的来说，我发现 iSeries Python 非常有用且非常值得。

**更新（2012 年）：** 自从提出这个问题以来，iSeries Python 已经做了大量工作。 [版本 2.7](http://sourceforge.net/projects/iseriespython/)现在可用，这意味着它是最新的 2.x 版本。论坛的一些参与者相当活跃并提供了惊人的支持。其中一个已经让 Django 在 i 上工作。正如预期的那样，迁移到原生 ASCII 字符串解决了很多 EBCDIC 问题，并大大提高了与第三方包的兼容性。我热情地向 V5R3 或更高版本的任何人推荐 iSeries Python 2.7。（对于那些使用早期版本操作系统的人，我仍然强烈推荐 iSeries Python 2.3.3。）

**更新（2021 年）：**不幸的是，iSeriesPython 不再维护，旧网站和论坛已不复存在。您仍然可以从其 SourceForge 存储库中获取该软件，对于那些停留在旧版本（7.2 之前）操作系统的人来说，它仍然是一个非常有用且有价值的资产。对于使用 7.2 或更高版本的用户，IBM 提供了用于 PASE 的 Python，它应该被视为在中端平台上运行 Python 的首选方式。这个版本的 Python 是[IBM i 上不断发展的开源软件生态系统的](https://ibmi-oss-docs.readthedocs.io/en/latest/yum/README.html)一部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T18:13:31.053

听起来它会按预期工作。不过，对其他库的支持可能非常有限。

Timothy Prickett 在本文中谈到了 iSeries 的一些 Python 端口：

[http://www.itjungle.com/tfh/tfh041706-story02.html](http://www.itjungle.com/tfh/tfh041706-story02.html)

此外，Python 邮件档案中也出现了一些讨论：

[http://mail.python.org/pipermail/python-list/2004-January/245276.html](http://mail.python.org/pipermail/python-list/2004-January/245276.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-06-29T10:47:07.017

iSeriesPython 运行良好。我们从 2005 年（或更早）开始在我们的开发和生产环境中将它用作实用语言，用于生成 COBOL 源代码、生成 PCML 接口、发送 SMS、验证/纠正某些数据……等等。使用 iSeriesPython，您可以以 2 种方式访问​​ iSeries 数据库：使用 File400 和/或 db2 模块。您可以执行 OS/400 命令并且可以使用 QSYS.LIB 成员和 IFS 流文件。恕我直言，iSeries Python 是非常强大的工具，比 iSeries 附带的 REXX 更好。试试看！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-31T12:31:20.333

大约 3 年前，我获得了在一个盒子上安装 iSeries Python 的许可。我发现它的工作原理和宣传的差不多。我联系了开发人员，他非常善于回答问题。但是，在我考虑在生产中使用它之前，我不得不就支持合同与开发人员联系。那真的不是他的演出，所以他拒绝了，我们放弃了这个想法。我发现的主要限制是它在其他平台上落后于 Python 的几个版本。

我在 iSeries 上使用 Jython 也有很好的经验。iSeries 完全支持 Java。从理论上讲，您可以在 iSeries 上的 RPG 中执行的所有操作都可以在 Java 中执行，这意味着您可以在 Jython 中执行。1999 年或 2000 年，我通过 JPython（Jython 的旧名称）和 smtplib.py 从 AS/400（iSeries 的旧名称）发送电子邮件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T21:08:52.833

另一个可以查看的地方是邮件列表[MIDRANGE-L或在](http://lists.midrange.com/listinfo/midrange-l)[midrange.com](http://archive.midrange.com/midrange-l/index.htm)的档案中搜索该列表。我知道他们已经谈过这件事了。

# java - 在 Applet 中加载 ActiveX 对象

> ID：752352
> 
> 赞同：1
> 
> 时间：2009-04-15T15:52:30.893
> 
> 标签：java, activex, applet, cross-browser

我有一个 Web 应用程序，它处理从专用麦克风接收到的事件和音频。音频由在网页中运行的 Java 小程序处理，但其他事件（麦克风连接、麦克风断开、麦克风按钮按下）由 ActiveX 对象处理。

ActiveX 对象捕获这些事件并调用 JavaScript 代码来处理它们

```
<!-- Load the ActiveX control -->
<object id="PhilipsSpeechMikeCtrl" width="0" height="0" tabindex="-1"
    classid="CLSID:AAA44754-CC81-4692-91AF-7064E58EB22A"
    standby="Loading Philips SpeechMike component..."
    type="application/x-oleobject">
</object>

<script type="text/javascript">
    // This is Microsofts javascript way of trapping ActiveX object events.

    function PhilipsSpeechMikeCtrl::SPMEventDeviceConnected(deviceID) {
        // Call JavaScript code to handle the microphone connected event
    }

    function PhilipsSpeechMikeCtrl::SPMEventDeviceDisconnected(deviceID) {
        // Call JavaScript code to handle the microphone disconnected event
    }

    function PhilipsSpeechMikeCtrl::SPMEventButton(deviceID, eventId) {
        // Call JavaScript code to handle the microphone button pressed event
    }
</script> 
```

当然，这种方法的一个问题是它完全依赖于 IE。我更愿意在小程序中加载 ActiveX 对象，在那里捕获事件并在小程序或从小程序调用的 JavaScript 代码中处理事件。这应该使我能够在任何支持小程序的浏览器中运行该应用程序。

我不完全确定如何实施我上面提出的解决方案，有什么建议吗？

**更新：**我意识到我上面提出的解决方案仍然依赖于 IE，这很好。我的直接目标是支持 Windows 上的所有浏览器。

有人建议我可以使用 JNI（或 JNA）来访问 ActiveX 对象下的 DLL，而不是使用 ActiveX。但是，我实际上并不想调用 DLL 中的函数，我希望 DLL 调用我，即注册一个事件处理程序。

谢谢，唐

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T18:36:54.440

ActiveX are not supported by an another browser than IE, so there is no way for your application to support all browsers, even on Windows only. An attempt (plugin) to port ActiveX under Firefox 1 was made, but wasn't really useful so as far as I know, there is today no "emulation" solution to your question. Sorry... (see [here](http://support.mozilla.com/en-US/kb/ActiveX) for Mozilla comments)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T17:57:19.673

[JACOB](http://danadler.com/jacob/)应该让您从 Java 调用 COM。看起来它也支持事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T20:18:11.640

你大概可以直接访问activeX组件中的dll，这样你就可以编写一个调用native函数的jni包装器，然后构建一个签名的applet，可以获得使用jni的权限。

检查这个：

[http://www.raditha.com/java/jni/](http://www.raditha.com/java/jni/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-18T11:39:11.287

啊。您可以随心所欲，但可能不得不避开 Javascript 而是利用 VBScript。它是关于在两个组件之间发送“事件”的能力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-21T08:23:37.877

您可以使用 JavaScript 直接调用小程序中的公共方法或访问公共变量。JavaScript 将嵌入的小程序视为一个对象。在applet 标签中给applet 一个名字id。

考虑下面的例子，applet 有一个方法 public void myMethodInMyApplet();

HTML 页面看起来像：

```
<APPLET CODE="MyApplet.class" 
   width=200 height=200 
   name=counter ID=counter>
</APPLET>

<script type="text/javascript">
    // This is Microsofts javascript way of trapping ActiveX object events.

    function PhilipsSpeechMikeCtrl::SPMEventDeviceConnected(deviceID) {
document.applets[0].myMethodInMyApplet();   
 }
 </script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T15:56:45.230

考虑到 Java 小程序是在客户端执行的，那不还是依赖于 Windows 甚至 IE 吗？就是想...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T20:57:16.680

如果您希望它们以 JavaScript 结束，您显然必须将事件传递两次。

有一个版本的 SWT 可以在 applet 中使用，并且可以嵌入 ActiveX 控件。还有像 Coroutine 这样的商业库也可以做到这一点（并且 jar 体积更小）。有人在这里提到了JACOB，这将是另一种选择。

因此，使用这些组件中的任何一个来包装您的 ActiveX 控件。当注册事件发生时，这些库将调用 Java 方法。

要将事件从 Java 传递到 JavaScript，您可以使用所有主流浏览器都支持的 netscape.javascript.JSObject 类。

如果你有 COM 组件的源代码，重写它以使用 JNI 可能是个好主意，因为 COM 包装器会占用大量资源（这在小程序中尤其重要），而且很可能还有一些开销COM 互操作的 COM 组件内部。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T12:01:58.413

activexobjects 是否总是访问像 activex.microsoft.com 这样的 acivex 网站

# sql-server - SQL Server 2008：加载非托管库的 CLR 存储过程的崩溃安全性如何

> ID：752357
> 
> 赞同：4
> 
> 时间：2009-04-15T15:53:17.333
> 
> 标签：sql-server, sql-server-2008, stored-procedures, sqlclr

我们在 SQL Server **2000**中有一个常规的（即非扩展的）存储过程，它调用一个外部 exe。反过来，该 exe 加载来自 SDK 的 .dll 并从中调用一些过程（即 Init、DoStuff、Shutdown）。

我们拥有这个外部 exe 的唯一原因是因为我们不想创建一个会调用 .dll 的扩展存储过程。我们认为，如果 dll 崩溃（不太可能发生但仍然如此），那么 SQL Server 进程也会崩溃，这不是我们想要的。使用外部 exe，只有该 exe 会崩溃。

现在，我们正在升级到 SQL Server **2008**并考虑创建一个调用该事物的 CLR 存储过程，从而摆脱 exe。当然，这个 SP 会被标记为 UNSAFE。因此的问题是，与扩展的 SP 方法相比，这样做是否安全（更安全、足够安全等）？

我在 BOL 上找到的唯一相关的事情是：

> 指定 UNSAFE 允许程序集中的代码对 SQL Server 进程空间执行非法操作，因此可能会损害 SQL Server 的稳健性和可伸缩性

，但我不确定它是否回答了我的问题，因为我不是追求“鲁棒性和可扩展性”，而是追求稳定性和保持事物正常运行。

PS：我们想要摆脱 exe，因为它在管理 SP 权限时会造成不便（你知道，如果你调用包含 xp_cmdshell 的 SP，这些东西会突然适用于你）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-04T13:20:38.453

由于此代码最初用于扩展存储过程，因此听起来像是非托管代码。非托管代码中的错误很容易使您的进程崩溃。

CLR 集成比扩展存储过程更强大，但代码仍在进程中运行，因此错误可能会导致 SQL Server 崩溃或损坏。（相比之下，理论上，SAFE CLR 例程不会损坏 SQL Server，尽管它可能会导致问题降低服务器的可用性，而不会完全关闭 SQL Server。）

基本上，在这种情况下不使 SQL Server 崩溃的唯一方法是：

1.  避免使用会崩溃的功能。
2.  修复错误代码。
3.  在单独的进程中运行代码（启动可执行文件、调用 Windows 服务、调用 Web 服务等）。您可以编写一个托管的 .NET DLL 来执行此交互。最有可能的是，您仍然需要加载它 UNSAFE，但是——如果它写得正确——实际上它可能是相当安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-08T07:06:22.740

> 因此的问题是，与扩展的 SP 方法相比，这样做是否安全（更安全、足够安全等）？

一般是的。我的意思是，如果您正在向操作系统进程发起攻击，那么您正在向操作系统进程发起攻击。我看不出使用扩展存储过程 API 来做到这一点必然比 SQLCLR API 更安全，尤其是当可能崩溃的是位于数据库之外的操作系统进程时。

当然，我不确定 XP API，因为我没有使用过它，但我确实知道以下内容：

*   XP API 已被弃用，建议所有可以使用其中任何一种技术完成的新项目都应在 SQLCLR 中完成。
*   SQLCLR 确实允许比其他两个更细化的权限，包括进行模拟的能力（如果执行 SQLCLR 对象的登录名是 Windows 登录名）。
*   SQLCLR API 由数据库和程序集所有者（即`AUTHORIZATION`子句指定的用户）在进程/内存方面分开。因此，您可以在一个数据库中的程序集出现问题，而不会影响其他数据库中的 SQLCLR 对象（如果另一个用户拥有程序集，甚至在同一个数据库中，尽管实际上这可能很少发生，因为大多数人只是使用默认值`dbo`)。

> 我不确定它是否回答了我的问题，因为我不是在追求“稳健性和可扩展性”，而是在追求稳定性和保持事物正常运行。

当然，当 Assembly 设置为时，您可以在 SQLCLR 中执行以下操作`UNSAFE`：

*   可能写入注册表（取决于授予运行 SQL Server 进程的登录身份帐户的访问权限，或者如果启用了模拟并且它是 Windows 登录，则执行 SQLCLR 功能的登录）。
*   可能写入文件系统
*   可能与系统上运行的进程交互
*   与执行来自同一程序集的其他 SQL Server SPID（即会话）共享内存（意味着该数据库中由该用户拥有的特定程序集）。这可能是人们最难以理解的，因为当您习惯于控制台应用程序和 Windows 应用程序拥有自己的单独内存空间时，这是出乎意料的，但是在这里，因为它是每个所有者每个数据库每个程序集的单个 AppDomain，执行该代码的所有会话都共享所有`static`变量。很多代码都是假设 AppDomain 是私有的，因此在静态变量中存储值是有效的，因为它会缓存值，但是在 SQLCLR 中，如果两个进程正在覆盖彼此的值并读取另一个进程，则可能会出现意外行为会话的价值。
*   潜在的内存泄漏。主机保护属性试图阻止您使用可以执行此操作的内置 .NET 功能，例如`TimeZoneInfo`用于在 TimeZoneID 之间转换时间，但主机保护属性不会在程序集上强制执行`UNSAFE`。
*   在执行 UNSAFE / FullTrust 代码（协作多任务与抢占）时，运行 SQLCLR 方法的线程*可能会以不同方式处理。*我以为我读过 UNSAFE 线程的管理方式不同，但不确定我在哪里读到它并正在寻找源代码。

但是以上都说了，如果你调用的是外部EXE，它有自己的AppDomain。

所以，你可以做的是：

1.  继续使用 SQLCLR 包装器调用 EXE 以`Process.Start()`. 这为您提供了进程/内存分离*以及*更轻松地控制对单个存储过程的权限的能力，该存储过程只会调用此 EXE 并且没有人可以更改它（至少在不更改 SQLCLR 代码并重新安装程序集的情况下不能更改）。

2.  在同一台机器上安装 SQL Server Express 的实例，在那里加载 SQLCLR 对象，并在两个方向（从当前 SQL Server 实例到新的 SQL Server Express 实例）创建链接服务器，以便您可以在它们之间轻松通信。这将允许您隔离 SQLCLR 执行并使其远离主 SQL Server 进程。

Of course, *that* all being said, how much of a concern is this really? Meaning, how likely is it that a process fully crashes and takes down everything with it? Sure, it's not impossible, but usually a crash would take down just the AppDomain and not the CLR host itself. I would think it far more likely that code that doesn't crash but is written poorly and consumes too much memory and/or CPU would be the problem people run into.

# asp.net - ASP.NET - 有条件地链接 CSS 文件

> ID：752359
> 
> 赞同：4
> 
> 时间：2009-04-15T15:54:22.543
> 
> 标签：asp.net, css

我想根据用户的会员角色有条件地链接 CSS 文件。管理员应该链接我的 admin.css 文件，而其他人（其他角色和匿名用户）应该显示我的 global.css 文件。这可以做到吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T15:56:54.877

试试[这个](http://www.aspdotnetfaq.com/Faq/How-to-Programmatically-add-CSS-Stylesheet-file-to-Asp-Net-page.aspx)：

```
protected void Page_Init(object sender, EventArgs e)
{
    HtmlLink css = new HtmlLink();
    // add conditional logic to add correct css file        
    css.Href = "css/fancyforms.css"; 
    css.Attributes["rel"] = "stylesheet";
    css.Attributes["type"] = "text/css";
    css.Attributes["media"] = "all";
    Page.Header.Controls.Add(css);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T16:13:40.810

如果您希望基于角色启用/禁用/显示/隐藏控件，这只不过是“默默无闻的安全性”，因为关闭样式或将浏览器设置为特定的 css 文件以覆盖实际提供的内容很容易显示所有那是秘密。

另一个问题是缓存。一些浏览器，比如 Opera/Firefox 很乐意缓存所有可缓存的内容，因此用户必须单击“重新加载页面”。您可能可以禁用缓存，但随后您的 css 将被重新下载，从而不必要地消耗流量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T15:58:25.170

如果将页面的 head 元素设置为在服务器端运行，则可以在用户处于特定角色时将新的 HtmlGenericControl 注入表示链接的标题中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T15:56:35.330

您可以根据角色创建主题 - AdminTheme（将包含 admin.css）和 GlobalTheme（将包含 global.css），或者您可以在为其赋予 runat="Server" 属性后动态地将`<link>`元素写入标签中`<head>`.

然后，您可以根据角色在 PreInit 或 Init 事件中动态设置页面的主题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T15:56:38.510

当然，当您输出该`<head>`部分时，使用 if 语句检查具有其“用户级别”的会话变量，然后输出相应的`<link>`标记（或`@import`行，取决于您喜欢如何使用 CSS）。

# installation - 如何在 umbraco 上安装扩展拉丁语 A 和 B

> ID：752366
> 
> 赞同：0
> 
> 时间：2009-04-15T15:56:18.077
> 
> 标签：installation, umbraco

我必须在 umbraco 上安装扩展的拉丁语 A 和 B，但不知道如何。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:57:50.740

[http://forum.umbraco.org/](http://forum.umbraco.org/)

# html - IE6全屏div

> ID：752367
> 
> 赞同：4
> 
> 时间：2009-04-15T15:56:24.503
> 
> 标签：html, css, internet-explorer-6

基本上，出于各种原因，我必须在我的页面上呈现全屏 div。现在这在非 IE 浏览器中相对简单（绝对定位，上/左/右/下为 0 像素），也可以在 IE7 上轻松完成（通过一些调整）但是我无法让它在 IE6 上运行。

奇怪的是，我可以让它在怪癖模式下工作，但是当我打开标准合规模式时，div 不会水平填充屏幕。不幸的是，我需要页面上其他元素的标准合规模式。

这是我的CSS：

```
div#myId
{
    background-color: #3070cf;
    position: absolute;
    top: 0px;
    bottom: 0px;
    left: 0px;
    right: 0px;
    width: 100%; /* Removing width or height doesn't help either */
    height: 100%;
} 
```

我的演示页面基本上是一个符合标准的 XHTML，具有适当的 DOCTYPE，其正文中只有一个 div (id="myId")。

现在我知道绝对定位通常不是一个好主意，但正如我所说，在这种情况下我真的需要它。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-15T15:57:58.603

你也试过设置这个吗？

```
html, body{
  height: 100%;
  width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T16:10:24.563

通过首先赋予身体以下风格，我已经能够完成这样的壮举：

```
body
{
   height: 100%;
   width: 100%;
} 
```

然后，可以给出完整大小的 div：

```
div#myId
{
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%
} 
```

这似乎适用于大多数主要浏览器。还要注意，IE 将始终在页面右侧创建一个禁用的滚动条。如果你不想要这个，你可以添加以下内容：

```
html
{
  overflow: auto;
} 
```

# regex - 小写正则表达式 URL

> ID：752368
> 
> 赞同：0
> 
> 时间：2009-04-15T15:56:35.157
> 
> 标签：regex

有人可以写一个可以匹配的正则表达式：

*   只能包含字母的小写 URL `a-z`，
*   `0-9`数字和`-`,
*   `http://`（不需要https），
*   `www.`
*   *没有*`default.aspx`？_ _

这是 RegEx 必须匹配的 URL：

`http://www.somedomain.net/news/148/some-text-to-act-as-news-title.aspx`

或者

`http://subdomain.somedomain.net/news/148/some-text-to-act-as-news-title.aspx`（没有`www.`）。

这是我的尝试：`[a-z0-9]{1,}-*`。仅匹配单个单词、单词 with`-`和 numbers。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T16:12:36.023

```
^http://[a-z0-9.-]+\.[a-z0-9]+(/(?!.*default\.aspx)[a-z0-9./-]+)?$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T16:24:03.610

具有前瞻性断言的解决方案：

```
^http://[a-z0-9-.]+(?:(?!/default\.aspx)/[a-z0-9-.]+)*$ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T16:06:44.213

```
^http://((?!default\.aspx)[a-z0-9\-\./])*$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T16:07:09.563

您应该使用本机语言排除具有大写字母和 default.aspx 的网址。但如果你想要所有东西，但帽子会这样做。

```
[a-z/- 0-9]* 
```

# python - 在 if 语句中依赖条件评估顺序是否安全？

> ID：752373
> 
> 赞同：83
> 
> 时间：2009-04-15T15:57:19.040
> 
> 标签：python, if-statement

`my_var`当可以为无时使用以下格式是不好的做法吗？

```
if my_var and 'something' in my_var:
    #do something 
```

*问题是`'something' in my_var`如果 my_var 为 None 会抛出 TypeError。*

或者我应该使用：

```
if my_var:
    if 'something' in my_var:
        #do something 
```

或者

```
try:
    if 'something' in my_var:
        #do something
except TypeError:
    pass 
```

换个说法，以上哪一项是 Python 中的最佳实践（如果有的话）？

欢迎替代品！

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-04-15T15:59:25.493

取决于条件的顺序（[此处为 Python 参考](http://docs.python.org/library/stdtypes.html#boolean-operations-and-or-not)）是安全的，特别是因为您指出的问题 - 能够短路可能导致一系列条件出现问题的评估非常有用。

大多数语言都会出现这种代码：

```
IF exists(variable) AND variable.doSomething()
    THEN ... 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-04-15T16:08:21.837

是的，它是安全的，它在语言参考中明确且非常明确地定义：

> 表达式`x and y`首先计算 `x`; 如果`x`是`false`，则返回其值；否则，`y`评估并返回结果值。
> 
> 表达式`x or y`首先计算 `x`; 如果`x`为真，则返回其值；否则，`y`评估并返回结果值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-01T11:37:32.227

我可能在这里有点迂腐，但我想说最好的答案是

```
if my_var is not None and 'something' in my_var:
    #do something 
```

区别在于显式检查`None`，而不是隐式转换`my_var`为`True`or `False`。

虽然我确信在您的情况下区别并不重要，但在更一般的情况下，变量很可能不是`None`但仍评估为`False`，例如整数值`0`或空列表。

因此，与大多数其他发帖人声称它是安全的相反，我想说只要你是明确的，它就是安全的。如果您不相信，请考虑这个非常做作的课程：

```
class Contrived(object):
    def __contains__(self, s):
        return True
    def __nonzero__(self):
        return False

my_var = Contrived()
if 'something' in my_var:
    print "Yes the condition is true"
if my_var and 'something' in my_var:
    print "But this statement won't get reached."
if my_var is not None and 'something' in my_var:
    print "Whereas this one will." 
```

是的，我知道这不是一个现实的例子，但是在实际代码中确实会发生变化，尤其是在`None`用于指示默认函数参数时。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-05T13:31:51.000

没那么简单。作为一个 C# 伙计，我非常习惯于做类似的事情：

```
if(x != null && ! string.isnullorempty(x.Name))
{
   //do something
} 
```

以上效果很好，并且按预期进行了评估。然而，在 VB.Net 中，以下会产生您意想不到的结果：

```
If Not x Is Nothing **And** Not String.IsNullOrEmpty(x.Name) Then

   'do something

End If 
```

以上会产生异常。正确的语法应该是

```
If Not x Is Nothing **AndAlso** Not String.IsNullOrEmpty(x.Name) Then

   'do something

End If 
```

请注意非常细微的区别。这让我困惑了大约 10 分钟（太长了），这就是为什么 C#（和其他）花花公子在用其他语言编码时需要非常小心的原因。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T16:00:04.103

我会使用 try/except，但这取决于您对变量的了解。

如果您期望该变量大部分时间都存在，那么 try/except 是较少的操作。如果您希望变量在大多数情况下为 None，那么 IF 语句将减少操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T15:59:43.543

这是非常安全的，我一直这样做。

# sql - Oracle：如何为所有开发人员启用闪回“as of”查询？

> ID：752382
> 
> 赞同：3
> 
> 时间：2009-04-15T15:58:12.393
> 
> 标签：sql, oracle

如何为我的 Oracle 实例上的所有开发人员启用闪回查询？

闪回查询在特定时间执行，以便

```
select * from mytable as of timestamp(sysdate-1); 
```

将显示截至 24 小时前的表格内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T15:58:41.533

```
grant execute on dbms_flashback to public;
grant flashback any table to public; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T07:35:54.620

您可以对自己的表使用闪回查询，而无需任何权限。如果您希望其他用户对您的表使用闪回查询，您需要向这些用户授予选择和闪回权限。

如果您想查看截至 24 小时前的数据，您需要有足够大小的撤消表空间并正确设置撤消保留。

[也看到这个](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14251/adfns_flashback.htm)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-10T22:22:06.390

[http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_flashb.htm#BGBJEJGF](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_flashb.htm#BGBJEJGF)

# regex - 正则表达式替换

> ID：752384
> 
> 赞同：0
> 
> 时间：2009-04-15T15:58:34.293
> 
> 标签：regex

我知道在正则表达式方面需要一些帮助我在解决这个问题时不是很聪明，但我会到达那里。

我的问题：

我需要从字符串中删除横幅尺寸，

横幅尺寸可以是 486X60 或 49 X 120

如何使用正则表达式将其替换为空白？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T16:01:22.213

```
s/\d+\s*[Xx]\s*\d+// 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T16:05:54.090

基本思想是这样的

```
1位或多位数字
一个空格（可选）
X
另一个空格（可选）
1位或多位数字

```

确切的语法取决于您使用的语言，但它看起来像

```
s/\d+[ ]?X[ ]?\d+// 
```

或者，如果您想确保 X 两边都有空格或根本没有空格，您可以将这两种情况分开：

```
s/(\d+ X \d+)|(\d+X\d+)// 
```

这将完全涵盖您提到的两个示例案例。如果您想在 X 周围允许任何数量的空格，或者允许 X 为小写，那么 Chaos 的解决方案涵盖了这一点。

# jquery - 点击切换 ul - 点击其他地方隐藏 ul

> ID：752386
> 
> 赞同：2
> 
> 时间：2009-04-15T15:58:51.500
> 
> 标签：jquery

大家好-我在工作任务中尝试 jquery 的第二天，有点卡住了。

我有一个无序列表的链接..在一个无序列表的链接中

单击`<li class="headlink">`时，我希望`<li class="headlink">`的孩子`<ul>`变得可见。

点击离开（文件上的任何地方），我希望孩子`<ul>`消失。

默认情况下，孩子`<ul>`在样式表中设置为隐藏。

html

```
<ul id="cssdropdown">
    <li><a href="#">A</a></li>
    <li class="headlink">
        <a href="#">B</a>
        <ul>
            <li><a href="#">1</a></li>
            <li><a href="#">2</a></li>
        </ul>
    </li>
    <li><a href="#">C</a></li>
</ul> 
```

jQuery

```
<script type="text/javascript">

    $(document).ready(function(){
        $('#cssdropdown li.headlink').click(
            function() { $('ul', this).toggle("slow"); });
    });

    $(document).ready(function(){
        $('body').click(function() { 
            $('li ul:visible').hide("slow") } ) } );

</script> 
```

问题 - 当我点击 a 时`<li class="headlink">`，我得到了 yoyo 效果，其中显示了子 UL - 然后隐藏了自己。

任何建议非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T16:05:26.993

您应该防止事件传播回正文：

```
$(document).ready(function(){
    $('#cssdropdown li.headlink').click(function(event) {
      $('ul', this).toggle("slow");
      event.stopPropagation();
    });
}); 
```

并隐藏当前未清项目：

```
$(document).ready(function(){
    $('#cssdropdown li.headlink').click(function(event) {
      $(this).siblings(".headlink").hide("slow");
      $('ul', this).toggle("slow");
      event.stopPropagation();
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T16:05:42.030

这将解决“溜溜球”效果的问题：（取消传播）

```
$(document).ready(function(){
    $('#cssdropdown li.headlink').click(
        function(event) { 
          $('ul', this).toggle("slow"); 
          event.stopPropagation()
      });
}); 
```

# javascript - javascript方法中的美元符号

> ID：752394
> 
> 赞同：3
> 
> 时间：2009-04-15T15:59:48.317
> 
> 标签：javascript, syntax

有人可以在这里解释美元符号的用法吗？

```
var updateProgressDiv = $get('updateProgressDiv'); 
```

向下滚动到功能.. [http://mattberseth.com/blog/2007/05/ajaxnet_example_using_an_updat.html](http://mattberseth.com/blog/2007/05/ajaxnet_example_using_an_updat.html)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T16:00:50.577

它只是函数名的一部分——JavaScript 标识符中允许使用 $，因此 ($get) 是完整的函数名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T16:07:59.170

这是 asp.net ajax 快捷方式：
$get Shortcut Method
提供 Sys.UI.DomElement 类的 getElementById 方法的快捷方式。该成员是静态的，可以在不创建类实例的情况下调用。

[查看更多信息](http://www.asp.net/ajax/documentation/live/ClientReference/Global/GetShortCutMethod.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:02:38.170

$get 是用于获取元素的 jQuery 语法。它与 C# 无关。

# google-app-engine - 谷歌应用引擎 JRE 类“黑名单”

> ID：752399
> 
> 赞同：10
> 
> 时间：2009-04-15T16:00:44.697
> 
> 标签：google-app-engine, java

Google App Engine有一个“ [JRE 类白名单](http://code.google.com/appengine/docs/java/jrewhitelist.html)”。

我真正想要的是“黑名单”——换句话说，不能在 GAE 上运行的 Java API。这样的清单存在吗？是否有任何开发人员在 GAE 上遇到 Java API 问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T16:30:46.963

似乎他们采取了更多的白名单方法：[http](http://code.google.com/appengine/docs/java/jrewhitelist.html) ://code.google.com/appengine/docs/java/jrewhitelist.html 。

这里还有关于沙盒的更多详细信息（它可以访问哪些文件等等）：[http ://code.google.com/appengine/docs/java/runtime.html#The_Sandbox](http://code.google.com/appengine/docs/java/runtime.html#The_Sandbox)

这些限制似乎非常直观（例如限制文件系统访问、没有 JNI 等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-01T11:57:27.970

我在我的 GAE 项目中使用 Servlet，但它不在白名单中，即使它可以正常工作。事实上，谷歌提到了如何使用 Servlet 但它不在白名单中

> 导入 javax.servlet.http.*；

这里提到：

[http://code.google.com/appengine/docs/java/runtime.html](http://code.google.com/appengine/docs/java/runtime.html)

但不包括在这里：

[http://code.google.com/appengine/docs/java/jrewhitelist.html](http://code.google.com/appengine/docs/java/jrewhitelist.html)

我喜欢 GAE（因为免费配额），但文档一团糟。

我使用 IntelliJ，当导入不在白名单中时，它会标记为错误。但是，可以禁用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T00:45:54.770

我在 Google I/O 上获得了一张宣传这项服务的卡片：

[雷特 AppEngine 兼容性分析器](http://www.ltech.com/cloud/google-app-engine/java-compatibility-analyzer)

听起来它可能对你有用。我没试过，如果你试过，请回来评论。谢谢！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-23T09:38:06.353

当我遇到此查询时，我正在寻找一些东西，因此想在 GAE（Google App Engine）的黑白名单上分享详细信息，以便任何遇到此类问题的人都可以正确解决。细节 ：-

**appengine-agentruntime.jar**有两个实例变量：-

```
private static Agent agent      
private static Set<String> blackList 
```

我们从 agent & agent = 获得黑名单`AppEngineDevAgent.getAgent()`。所以如果我们检查**b) appengine-agent.jar**我们可以发现代理是`Class<?> implClass = agentImplLoader.loadClass("com.google.appengine.tools.development.agent.impl.AgentImpl");`

然后转到 AgentImpl 类，即**c) appengine-agentimpl.jar**，我们可以看到黑名单变量在类加载时通过静态初始化填充，它引用白名单来过滤允许的类。

```
static {
            initBlackList();
        }

    public static Set<String> getBlackList() {
        return blackList;
    }

    private static boolean isBlackListed(String className) {
        Set<String> whiteList = WhiteList.getWhiteList();
        return (!whiteList.contains(className))
                && (!className.startsWith("com.sun.xml.internal.bind."));
    } 
```

最后可以检查**d) appengine-tools-sdk-1.8.3.jar**以获取所有 WhiteList 类的列表。

**结论：** *作为一种技巧，为了使用不属于此 WhiteList 的任何 JRE 类，需要使用 WhiteList 或 BlackList*。如果您解压缩**appengine-agentruntime.jar**库并将拒绝方法的内容注释为

```
public static void reject(String className) {
    /*throw new NoClassDefFoundError(className + " is a restricted class. Please see the Google " + " App Engine developer's guide for more details.");*/
  } 
```

然后再次将其 jar 并在您的项目中使用。希望它有所帮助。

## -------------------------------------------------- --------------------------

a) **appengine-agentruntime.jar** :- 它包含实际的**运行时**类，该类会为不属于上述白名单的类抛出异常（来自**拒绝方法）。**

```
package com.google.appengine.tools.development.agent.runtime;

import com.google.appengine.tools.development.agent.AppEngineDevAgent;
import com.google.appengine.tools.development.agent.impl.Agent;
import com.google.apphosting.utils.clearcast.ClearCast;
//REMOVED OTHER IMPORTS TO KEEP IT SHORT

public class Runtime {

    private static Agent agent = (Agent) ClearCast.cast(
            AppEngineDevAgent.getAgent(), Agent.class);

    private static Set<String> blackList = agent.getBlackList();

    public static ClassLoader checkParentClassLoader(ClassLoader loader) {
        ClassLoader systemLoader = ClassLoader.getSystemClassLoader();
        return (loader != null) && (loader != systemLoader) ? loader
                : Runtime.class.getClassLoader();
    }

    public static void recordClassLoader(ClassLoader loader) {
        agent.recordAppClassLoader(loader);
    }

    public static void reject(String className) {
        throw new NoClassDefFoundError(className
                + " is a restricted class. Please see the Google "
                + " App Engine developer's guide for more details.");
    }

    private static boolean isBlackListed(Class klass) {
        String className = klass.getName().replace('.', '/');
        return blackList.contains(className);
    }

    // REMOVED OTHER METHODS TO KEEP IT SHORT
} 
```

b) **appengine-agent.jar** :-

```
package com.google.appengine.tools.development.agent;

import com.google.apphosting.utils.clearcast.ClearCast;
//REMOVED OTHER IMPORTS TO KEEP IT SHORT

public class AppEngineDevAgent {
    private static final String AGENT_IMPL = "com.google.appengine.tools.development.agent.impl.AgentImpl";
    private static final String AGENT_IMPL_JAR = "appengine-agentimpl.jar";
    private static final Logger logger = Logger.getLogger(AppEngineDevAgent.class.getName());
    private static Object impl;

    public static void premain(String agentArgs, Instrumentation inst) {
        URL agentImplLib = findAgentImplLib();
        URLClassLoader agentImplLoader = new URLClassLoader(
                new URL[] { agentImplLib }) {
            protected PermissionCollection getPermissions(CodeSource codesource) {
                PermissionCollection perms = super.getPermissions(codesource);
                perms.add(new AllPermission());
                return perms;
            }
        };
        try {
            Class<?> implClass = agentImplLoader
                    .loadClass("com.google.appengine.tools.development.agent.impl.AgentImpl");
            impl = ((AgentImplStruct) ClearCast.staticCast(implClass,
                    AgentImplStruct.class)).getInstance();
            AgentImplStruct agentImplStruct = (AgentImplStruct) ClearCast.cast(
                    impl, AgentImplStruct.class);
            agentImplStruct.run(inst);
        } catch (Exception e) {
            logger.log(
                    Level.SEVERE,
                    "Unable to load the App Engine dev agent. Security restrictions will not be completely emulated.",
                    e);
        }
    }

    public static Object getAgent() {
        return impl;
    }

    //REMOVED OTHER METHODS TO KEEP IT SHORT
} 
```

c) **appengine-agentimpl.jar** :-

```
package com.google.appengine.tools.development.agent.impl;

import com.google.apphosting.runtime.security.WhiteList;
//REMOVED OTHER IMPORTS TO KEEP IT SHORT

public class BlackList {
    private static final Logger logger = Logger.getLogger(BlackList.class.getName());
    private static Set<String> blackList = new HashSet();

    static {
        initBlackList();
    }

    public static Set<String> getBlackList() {
        return blackList;
    }

    private static boolean isBlackListed(String className) {
        Set<String> whiteList = WhiteList.getWhiteList();
        return (!whiteList.contains(className))
                && (!className.startsWith("com.sun.xml.internal.bind."));
    }

    private static void initBlackList() {
        Set<File> jreJars = getCurrentJreJars();
        for (File f : jreJars) {
            JarFile jarFile = null;
            try {
                jarFile = new JarFile(f);
            } catch (IOException e) {
                logger.log(
                        Level.SEVERE,
                        "Unable to read a jre library while constructing the blacklist. Security restrictions may not be entirely emulated. "
                                + f.getAbsolutePath());
            }
            continue;

            Enumeration<JarEntry> entries = jarFile.entries();
            while (entries.hasMoreElements()) {
                JarEntry entry = (JarEntry) entries.nextElement();
                String entryName = entry.getName();
                if (entryName.endsWith(".class")) {
                    String className = entryName.replace('/', '.').substring(0,
                            entryName.length() - ".class".length());
                    if (isBlackListed(className)) {
                        blackList.add(className.replace('.', '/'));
                    }
                }
            }
        }
        blackList = Collections.unmodifiableSet(blackList);
    }

    private static Set<File> getCurrentJreJars() {
        return getJreJars(System.getProperty("java.home"));
    }

    //REMOVED OTHER METHODS TO KEEP IT SHORT
} 
```

d) **appengine-tools-sdk-1.8.3.jar** :- 它有一个名为**WhiteList**的类，其中包括所有允许的 JRE 类。

```
package com.google.apphosting.runtime.security;

import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;

public class WhiteList {
    private static Set<String> whiteList = new HashSet(
            Arrays.asList(new String[] {
                    "java.beans.Transient",
                    "java.lang.BootstrapMethodError",
                    "java.lang.Character$UnicodeScript",
                    "java.lang.ClassValue",
                    "java.lang.SafeVarargs",

                    //Removed other classes to keep this article short

                    "java.net.URLClassLoader",
                    "java.security.SecureClassLoader",
                    "sun.net.spi.nameservice.NameService" }));

    public static Set<String> getWhiteList() {
        return whiteList;
    }
} 
```

# c - 关于 C 中的字符指针

> ID：752401
> 
> 赞同：4
> 
> 时间：2009-04-15T16:00:50.403
> 
> 标签：c, arrays, pointers

考虑这个定义：

```
char *pmessage = "now is the time"; 
```

如我所见， pmessage 将指向内存中包含这些字符的连续区域，`'\0'`最后是 a 。所以我从中得出，只要我在这个区域的限制内，我就可以使用指针算法来访问这个字符串中的单个字符。

那么为什么他们说（K&R）修改单个字符是未定义的？
此外，为什么当我运行以下代码时，会出现“分段错误”？

```
*(pmessage + 1) = 'K'; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-15T16:05:22.267

C 中的字符串文字不可修改。字符串文字是在程序的源代码中定义的字符串。编译器会经常将字符串文字存储在已编译二进制文件的只读部分中，因此您的 pmessage 指针实际上位于您无法修改的该区域。可以使用上述语法修改存在于可修改内存中的缓冲区中的字符串。

尝试这样的事情。

```
const char* pmessage = "now is the time";

// Create a new buffer that is on the stack and copy the literal into it.
char buffer[64];
strcpy(buffer, pmessage);

// We can now modify this buffer
buffer[1] = 'K'; 
```

如果您只想要一个可以修改的字符串，则可以避免使用具有以下语法的字符串文字。

```
char pmessage[] = "now is the time"; 
```

此方法直接将字符串创建为堆栈上的数组，并且可以就地修改。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-15T16:07:15.693

字符串是常量，不能修改。如果你想修改它，你可以这样做：

```
char pmessage[] = "now is the time"; 
```

这会初始化一个字符数组（包括 \0），而不是创建一个指向字符串常量的指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T01:12:28.580

pmessage 的字面值进入代码，并且在大多数情况下它们被放置在代码内存中。哪个是**只读的**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T16:04:30.863

您可以使用指针算法从字符串文字中读取，但不能写入。C 标准禁止修改字符串文字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T16:05:08.257

“字符串”文字是在只读内存中定义的，因此您不应该修改它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T16:18:30.440

当你写： char *pmessage = "现在是时候";

编译器将其视为您编写的：

```
 const char internalstring[] = "now is the time";
 char *pmessage = internalstring; 
```

您无法修改字符串的原因是因为如果您要编写：

```
 char *pmessage1 = "now is the time";
 char *pmessage2 = "now is the time"; 
```

编译器会将其视为您编写的：

```
 const char internalstring[] = "now is the time";
 char *pmessage1 = internalstring;
 char *pmessage2 = internalstring; 
```

所以，如果你要改变一个，你会改变两个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-16T08:54:26.147

如果您定义形式的文字：

```
char* message = "hello world"; 
```

编译器会将字符视为常量，并可能将它们放入只读存储器中。

因此，建议使用 const 关键字，以便任何更改文字的尝试都将阻止程序编译：

```
const char* message = "hello world"; 
```

* * *

我猜想文字上的 const 没有作为语言的一部分强制执行的原因只是为了向后兼容不存在 const 关键字的 C 的预标准版本。有人知道更好吗？

# fortran - 从 gfortran 读取 .dbf 文件的最简单方法是什么

> ID：752408
> 
> 赞同：0
> 
> 时间：2009-04-15T16:01:18.797
> 
> 标签：fortran, dbf, gfortran

我正在使用 gfortran，我需要编写一个从与 ESRI Shapefile 关联的 .dbf 文件中读取记录的函数。我应该能够阅读的文件可从互联网[http://diss.rm.ingv.it/diss/DISS_3.0.4.shp.zip](http://diss.rm.ingv.it/diss/DISS_3.0.4.shp.zip)

该`file`命令对文件格式的意见是：

```
$ file GGSources_polyline.dbf
GGSources_polyline.dbf: \012- DBase 3 data file\012-  (119 records) 
```

感谢您的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T15:34:49.740

[我在这里](http://www.clicketyclick.dk/databases/xbase/format/dbf.html)找到了文件格式的粗略描述。看起来整个过程中变量类型和大小的组合相当多，这会使事情变得有些复杂。我不知道使用 Fortran 尝试读取这些数据是否是最好的选择，但如果你必须，这里有一些提示：

*   打开文件以直接访问未格式化的 I/O。未格式化意味着您可以直接从文件中读取字节，直接访问不会向记录添加任何填充。
*   将记录长度设置为字段之间的最小公共长度
*   使用该`transfer()`函数将内存中的位置解释为特定类型。这将允许您将文件中的二进制数据读取到类型变量中，`integer`然后分配给 a`real`而无需进行类型转换。

我现在处于类似的情况，试图读取一个结构与 dBase 文件非常相似的文件（即不同大小的标题指向不同类型的文件区域），最终使用 Python 和 Numpy 读取文件。读取包括`seek`ing 到文件中的某个位置，读取一堆字节，然后使用`numpy.fromstring`选项将其转换为`real*4`, `real*8`,`integer*8`等。您可以完成这项工作，但您可能希望保持选项打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-20T01:48:24.003

Your best bet is to conver the dbf file into something else, using e.g. the [OGR tools](http://gdal.osgeo.org/), available in most linux distributions. You can just convert the contents of the dbf file into a CSV file using ogr2ogr:

```
ogr2ogr -f "CSV" output.csv FaultScarps_polyline.shp FaultScarps_polyline 
```

(note that you need to include the layername, which for Shapefiles, is identical to the shapefile's name). The first 3 lines of the CSV look like this:

```
IDSOURCE,IDSCARP,SOURCENAME,FAULTSCARP,LENGHT,HEIGHT,AVGVOFFSET,MAXVOFFSET,VOFFSETTYP,AVGHOFFSET,MAXHOFFSET,HOFFSETTYP,AGE,NOEVENTS,LENGHTQ,HEIGHTQ,VOFFSETQ,HOFFSETQ,AGEQ,NOEVENTSQ,LENGHTN,HEIGHTN,VOFFSETN,HOFFSETN,AGEN,NOEVENTSN,REFERENCE
ITGG001,          1,Ovindoli-Pezza,Ovindoli-Pezza Fault Piano Pezza,  4.40, 18.00,   9.750,  16.000,          1,   0.000,   0.000,3,             10.000000000000000,3,1,0,1,1,1,1,Based on topographic observations.,Max height in late Pleistocene-Holocene fluvioglacial deposits.,Based on geological survey and refers to late Pleistocene-Holocene deposits.,Based on geological survey.,Based on geological observations.,Refers to Holocene and based on paleoseismology.,Pantosti et al. [1996].
ITGG001,          2,Ovindoli-Pezza,Ovindoli-Pezza  Fault Campo Porcaro,  8.60,  0.00,   8.700,  12.000,          1,   3.045,   4.025,1,             18.000000000000000,3,1,0,1,1,1,1,Based on topographic observations.,,Max offset observed  in the late Pleistocene-Holocene fluvioglacial and moraine deposits.,"Calculated as 35 % of the vertical component, on the basis of literature data.",Based on geological observations.,Refers to Holocene and based on paleoseismology.,Pantosti et al. [1996] 
```

An alternative would be to access the Shapefile using OGR (or [Shapelib](http://shapelib.maptools.org/)) and doing the processing in C, returning it to the main Fortran program.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-07T12:19:30.293

FortranGIS 包具有与 shapelib 库的 Fortran 绑定，允许直接从 Fortran 程序编码/解码 shapefile 和关联的 dbf 文件：

[http://fortrangis.berlios.de/](http://fortrangis.berlios.de/)后来搬到了[https://github.com/ARPA-SIMC/fortrangis](https://github.com/ARPA-SIMC/fortrangis)

它适用于 gfortran 4.1.2 或更高版本（F2003 ISO_C_BINDING 模块）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-04T15:37:15.320

除非您的编译器有一些扩展，否则您可能很难在 Fortran 中读取不是从 Fortran 写入语句写入的二进制未格式化文件。Fortran 二进制未格式化文件具有记录开始和记录结束标记。这些标记通常是以字节为单位的记录长度。因此运行时系统会尝试将文件中的字符解释为记录标记并感到困惑。

转换为 csv ascii 并从 Fortran 读取将起作用。如果您要尝试读取其他文件类型，那么编写一些 C 函数来连接 CI/O 库应该允许您直接读取文件。

# javascript - $('*').index(currentElement) 会给出一个唯一的数字吗？

> ID：752416
> 
> 赞同：1
> 
> 时间：2009-04-15T16:02:27.903
> 
> 标签：javascript, jquery, html, dom

$('*').index(currentElement) 会给出一个唯一的数字吗？
我问是因为我无法理解[JQuery 文档中的 index 方法](http://docs.jquery.com/Core/index)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T16:08:23.600

“是的”。（只要索引的上下文始终是整个 DOM，我应该对此进行限定）否则，正如其他答案所述，答案是否定的。

它将为您提供所有 DOM 元素中元素的索引。如果 DOM 发生变化，它将不再有效。

需要这样一个索引的原因必须*非常*不寻常，我强烈怀疑有更好的方法来完成你想要完成的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T16:09:31.350

是的，它将返回您可以在 jQuery 集合中找到元素的索引 - 例如

```
var allElements = $("*");
var index = allElements.index(someElement);

if(allEmenets[index] == someElement){
  alert("Found it!");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T16:08:42.493

index 方法将搜索当前元素的索引。我可以用代码更好地解释它：

```
 <div id='div0'></div>
 <div id='div1'></div>
 <span id='span0'></span>
 <div id='div2'></div>  

 $('div').index( $('#div0')[0] ); //index is 0 as it is the first of all divs
 $('*').index( $('#div0')[0] ); //index is 0 as it is the first of all elements
 $('span').index( $('#span0')[0] ); //index is 0 as it is the first of all spans
 $('*').index( $('#span0')[0] ); //index is 2 as it is the third of all elements 
```

# c# - 如何在 .NET 对象的序列化过程中创建两个 XML 元素？

> ID：752419
> 
> 赞同：1
> 
> 时间：2009-04-15T16:03:15.983
> 
> 标签：c#, .net, xml, serialization

我有一个具有最大值和最小值两个属性的类。它看起来像这样（ish）：

```
public class Configuration
{
  public int Max { get; set; }
  public int Min { get; set; }
} 
```

当我序列化这个时，我得到类似的东西：

```
<Configuration>
  <Max>10</Max>
  <Min>0</Min>
</Configuration> 
```

但是，我需要一个像这样的额外元素：

```
<Configuration>
  <Bounds>
    <Max>10</Max>
    <Min>0</Min>
  </Bounds>
</Configuration> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T16:05:53.077

为此，您还需要在对象模型中引入一个额外的层。`XmlSerializer`喜欢将 xml （大致）直接映射到对象：

```
[Serializable]
public class Configuration {
    public Bounds Bounds { get; set; }
}
[Serializable]
public class Bounds {
    public int Min {get;set;}
    public int Max {get;set;}
} 
```

唯一的其他选择是实施，但除非您**绝对**别无选择`IXmlSerializable`，否则您真的不想这样做。

 **# jquery - jquery自动调整网络界面？

> ID：752423
> 
> 赞同：0
> 
> 时间：2009-04-15T16:04:37.150
> 
> 标签：jquery, layout, user-interface, autosize

我一直在使用 jquery 进行设计并使用 jquery UI 小部件.. 但一直在设计 1024 x 768 ...

是否有任何技巧或插件（最好与 jquery UI 一起使用）来自动调整我的界面元素的大小......

这样，当有人以更高的分辨率查看它时，它看起来就不会那么小了..

有人对此有任何提示吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T16:16:49.040

不幸的是，我没有机会过多地使用 jQuery，但是 ExtJS 有一个很好的[布局](http://extjs.com/deploy/dev/examples/layout-browser/layout-browser.html)概念，可以完美地工作（我只提到这个原因，我相信你正在寻找类似这些布局的东西，但对于 jQuery）。在 jQuery 网站上环顾四周，可能有一些插件可以帮助您实现您正在寻找的东西：

[Flexify](http://plugins.jquery.com/project/Flexify) - 这听起来像您正在寻找的东西，让您可以制作占用浏览器可用空间的流畅界面。

[Columizer](http://plugins.jquery.com/project/Columnizer) - 这使您可以创建随浏览器调整大小的报纸栏样式布局

jQuery 布局类别中的[所有插件](http://plugins.jquery.com/project/Plugins/category/51)

希望对您有所帮助，有一天我必须花更多时间在 jQuery ><

# reporting-services - SQL 报告

> ID：752432
> 
> 赞同：1
> 
> 时间：2009-04-15T16:06:32.340
> 
> 标签：reporting-services

我有一个显示每月数据的图表报告，我想通过单击上个月和下个月来显示上个月和下个月的数据。

如何通过单击上个月和下个月在图表中显示数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T21:43:15.497

向报告中添加参数以指定月份。在 RDL 中为此报告创建两个文本项，用于上一个和下一个。为这两个项目配置“跳转到”项，以使用从当前报告中的月份值推导出的月份的正确值调用同一报告。它将是月 - 1 为 prev 和 month + 1 为下一个。简而言之，您将为上一个、下一个和当前月份调用相同的报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T21:52:47.267

不确定您所处的环境，但您可以使用以下 SQL 来获取下一个/前几个月（使用 oracle）。将此作为构建查询的起点。

下一个按钮：从 dual 中选择 to_char(sysdate,'MM')+1

上一个按钮：从 dual 中选择 to_char(sysdate,'MM')11

获得请求的月份后，构建剩余的结果集。

# image-processing - DirectX 和 OpenCV

> ID：752433
> 
> 赞同：2
> 
> 时间：2009-04-15T16:06:33.060
> 
> 标签：image-processing, opencv, iplimage

所以我已经编写了一个程序，它可以从网络摄像头捕获图像，并将其放入一个名为 pBuffer 的向量中。我可以轻松访问每个像素的 RGB 像素信息，只需通过

`pBuffer[i]=R;pBuffer[i+1]=G;Buffer[i+2]=B.`

这里没问题。

下一步现在是创建一个 IplImage* img，并用 pBuffer 的信息填充它……某种 SetPixel。

网上有一个SetPixel函数，即：

```
(((uchar*)(image­>imageData + image­>widthStep*(y))))[x * image­>nChannels + channel] = (uchar)value; 
```

其中值是 pBuffer 信息，x 和 y 是像素坐标。但是我根本无法使用它。有任何想法吗？？我正在使用 C++。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T04:47:22.747

What you are trying to do you can do like this (assuming width and height are the image dimensions):

```
CvSize size;
size.height = height;
size.width = width;
IplImage* ipl_image_p = cvCreateImage(size, IPL_DEPTH_8U, 3);

for (int y = 0; y < height; ++y)
    for (int x = 0; x < width; ++x)
        for (int channel = 0; channel < 3; ++channel)
            *(ipl_image_p->imageData + ipl_image_p->widthStep * y + x * ipl_image_p->nChannels + channel) = pBuffer[x*y*3+channel]; 
```

However, you don't have to copy the data. You can also use your image data by IplImage (assuming pBuffer is of type char*, otherwise you need possibly to cast it):

```
CvSize size;
size.height = height ;
size.width = width;
IplImage* ipl_image_p = cvCreateImageHeader(size, IPL_DEPTH_8U, 3);
ipl_image_p->imageData = pBuffer;
ipl_image_p->imageDataOrigin = ipl_image_p->imageData; 
```

# mysql - 使用 Visio 生成 MySQL DDL

> ID：752434
> 
> 赞同：3
> 
> 时间：2009-04-15T16:06:35.523
> 
> 标签：mysql, visio, ddl

我有一个在 MS Visio 中创建的数据库模型图，我想将其导出到 DDL 文件以创建 MySQL 数据库。我已经安装了 MySQL ODBC 驱动程序，我可以成功地使用它来生成 DDL 文件，但我还是有一些问题。

Visio 在表名周围加上引号，这些表名也是保留字（如用户）。这是不行的，因为 MySQL 为此目的使用了反引号 (`) 而不是引号 (")。

MySQL ODBC 驱动程序还将 BLOB 数据类型更改为 LONGVARBINARY，因此在创建数据库时不能直接与 MySQL 一起使用。

有没有人有任何建议如何处理这两个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-05T08:16:29.177

除了编辑它？不。

您可以考虑使用[MySQL Workbench](http://wb.mysql.com/)。如果您在设计模式下创建所有内容，它与 visio 非常相似。此外，使用付费版本，您还可以生成 pdf 文档以供分发（或将该 PDF 放入 visio 中的流程图等），或者您可以创建一个插件，在输出时生成有效的 visio 文件，因为工作台是可通过插件完全扩展。

# xml - 编辑 Word 文档

> ID：752438
> 
> 赞同：1
> 
> 时间：2009-04-15T16:07:13.353
> 
> 标签：xml, sharepoint, ms-word

是否可以在 SharePoint 上托管的 Word 文档中编辑和插入条目？

我需要根据谁对文档进行最后一次更改来填写审阅者表。

我知道我会使用事件接收器来执行此操作，但我如何以交互方式与 word 文档进行交互？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T17:50:18.457

您希望使用 SPListItem 的 CreatedBy 或 ModifiedBy 值和 OpenXml API 来执行此操作，因此您不必使用 WSS/MOSS 服务器上的 Word 对象模型。

要获取用户信息，您需要这样做。

```
//get the SPWeb reference for web
SPFile updatedFile= web.GetFile(fileUrl);
SPUser author = updatedFile.Author; //or updatedFile.ModifiedBy for modifier 
```

获得作者后，要更新 Word 文档，您可以参考此[SharePoint 和 OpenXml](http://wiki.threewill.com/display/enterprise/SharePoint+and+Open+XML) wiki 页面以获得一些帮助。这是基于[Eric White 的博客](http://blogs.msdn.com/ericwhite/)（和其他人）使用 Open Xml 编写的。我强烈建议您阅读他的博客并查看[PowerTools for OpenXml Codeplex](http://www.codeplex.com/PowerTools)项目以获取一些肯定会有所帮助的代码。

另请参阅[OpenXmlDeveloper](http://openxmldeveloper.org/default.aspx)和[Open XML Developer 门户](http://msdn.microsoft.com/en-us/office/aa905545.aspx)了解更多信息

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T17:07:53.147

您可以使用[SPDocumentLibrary](http://msdn.microsoft.com/en-us/library/dd587216(office.11).aspx)类和*GetItemsInFolder*方法返回一个 SPListItemCollection。

从那里您可以将项目转换为 Word 对象并通过[word 对象模型对其进行操作](http://msdn.microsoft.com/en-us/library/kw65a0we(VS.80).aspx)

# .net - 如何以符合标准的方式在 .NET 中序列化 DateTime 对象

> ID：752446
> 
> 赞同：7
> 
> 时间：2009-04-15T16:08:20.247
> 
> 标签：.net, datetime, standards-compliance

我的目标是使用 .NET DateTime 对象（在 C# 中），并以符合标准的方式将其序列化为字符串并从字符串中解析（用于 XML）。我想到的具体标准是表示日期和时间的 ISO 8601 标准。

我想要一个易于使用的解决方案（最好每种方法调用一个方法），它将转换为格式的连接版本和从格式的连接版本转换。我还想保留本地时区信息。

这是我想要获得的那种字符串的示例：

2009-04-15T10:55:03.0174-05:00

我的目标 .NET 版本是 3.5。

几年前，我实际上找到了解决此问题的方法，其中涉及自定义格式和 DateTime.ToString(string) 方法。令我惊讶的是，不存在更简单的符合标准的解决方案。使用自定义格式字符串以符合标准的方式进行序列化和解析对我来说有点异味。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-15T16:11:23.640

`XmlConvert.ToString()`幸运的是，有`XmlConvert.ToDateTime()`它处理这种格式：

```
string s = XmlConvert.ToString(DateTime.Now,
     XmlDateTimeSerializationMode.Local);
DateTime dt = XmlConvert.ToDateTime(s,
     XmlDateTimeSerializationMode.Local); 
```

（选择合适的序列化模式）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T16:13:50.483

dateobj.ToString("s") 将为您提供符合 ISO 8601 的字符串表示，然后可以使用 DateTime.Parse() 对其进行反序列化

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T16:12:54.167

在过去的几年里，.NET 在这方面似乎有了一些改进。[System.Xml.XmlConvert](http://msdn.microsoft.com/en-us/library/system.xml.xmlconvert.aspx)对象似乎旨在解决出现在此上下文中的一整类需求。以下函数似乎专门设计用于以灵活且符合标准的方式处理 DateTime 对象的转换。

```
XmlConvert.ToDateTime(string, System.Xml.XmlDateTimeSerializationMode)

XmlConvert.ToString(DateTime, System.Xml.XmlDateTimeSerializationMode) 
```

在您想要保留原始时区信息的情况下，以下枚举成员似乎特别有用：

```
System.Xml.XmlDateTimeSerializationMode.RoundtripKind 
```

以下是 MSDN 上功能文档的链接：

[XmlConvert.ToDateTime（字符串，System.Xml.XmlDateTimeSerializationMode）](http://msdn.microsoft.com/en-us/library/ms162342.aspx)

[XmlConvert.ToString（日期时间，System.Xml.XmlDateTimeSerializationMode）](http://msdn.microsoft.com/en-us/library/ms162344.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T16:13:09.393

试试这个：

```
System.Xml.XmlConvert.ToString(TimeStamp, System.Xml.XmlDateTimeSerializationMode.Utc)) 
```

# c# - 在 Windows 中保存临时文件的正确位置？

> ID：752455
> 
> 赞同：47
> 
> 时间：2009-04-15T16:09:35.767
> 
> 标签：c#, windows

我有一个文件需要写入临时位置，Windows 中最好的位置是什么？这个文件不需要移动，因为我需要阅读它几次并在我关闭程序时处理它。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-15T16:13:28.923

采用

```
Path.GetTempPath(); 
```

或者

```
Path.GetTempFileName(); 
```

正如评论员所指出的，GetTempFileName() 不是线程安全的 - 但您可以根据 GUID 构造唯一的文件名。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-15T16:18:22.640

其他人在这方面打败了我

```
System.IO.Path.GetTempPath() 
```

但您也可以查看应用程序数据文件夹。这将使您能够更好地控制您的文件，例如可以为所有用户共享 1 个文件或为每个用户共享 1 个文件。

```
Application.CommonAppDataPath
Application.UserAppDataPath 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-15T16:14:36.113

`GetTempPath()`使用来自`System.IO.Path`（参见[MSDN](http://msdn.microsoft.com/en-us/library/system.io.path.gettemppath.aspx)）的 Windows API 函数

```
using System.IO

...

myTempPath = Path.GetTempPath(); 
```

您应该知道文件系统可能会在程序执行期间发生变化。临时路径可能会更改（不太可能，已授予），或者您的临时文件可能已被用户移动或删除。

准备好每次访问它时检查它的存在，并在没有优雅地找到它时处理它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T00:20:49.580

如果您需要您的应用程序写入临时位置并以部分信任的方式工作，则需要查看[IsolatedStorage](http://msdn.microsoft.com/en-us/library/bdts8hk0.aspx "隔离存储")。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-20T00:58:26.400

如果您想参考临时位置构建自己的自定义临时文件名，我使用类似这样的东西来剥离 PATH 并应用我自己的文件名......

```
string wsPDFfile = Path.GetTempPath() + wsStudentID + "_" + Path.GetFileNameWithoutExtension(Path.GetTempFileName()) + ".pdf"; 
```

# .net - 异步记录到数据库.Net

> ID：752456
> 
> 赞同：6
> 
> 时间：2009-04-15T16:09:46.203
> 
> 标签：.net, logging, asynchronous

我想知道人们使用什么来登录.net。我们这里有 log4net，但我希望异步执行它并使用一个不错的查看器访问数据库。

流行的选择是什么？

问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T07:57:27.807

试试**[logFaces](http://www.moonlit-software.com)**，它是集中式日志服务器、聚合器和查看器，与 log4net UDP appender 配合得很好。

**披露**：我是该产品的作者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T18:01:51.080

Log4Net 将日志消息同步传递给 appender，但 appender 可以[根据 this](http://www.mail-archive.com/log4net-user@logging.apache.org/msg02168.html)异步执行。SqlServerAppender 有一个 bufferSize 属性，用于控制在将日志事件写入数据库之前在缓冲区中收集多少日志事件。如果这不能满足您的需求，您可以编写自己的附加程序。[这篇文章](http://www.l4ndash.com/Log4NetMailArchive/tabid/70/forumid/1/postid/15068/view/topic/Default.aspx)中的回复似乎给出了一个工作示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T18:06:38.433

我强烈建议研究[NLOG](http://www.nlog-project.org/)。它非常灵活并且异步记录。您可以将其配置为记录到特定文件或数据库。但是，您需要构建自己的日志查看器。

我们虔诚地使用 NLOG，对它非常满意。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T18:06:52.473

当我们这样做时，我们只是简单地写入一个简单的内部队列并让一个线程进行实际的写入。这样，我们正在记录的代码受到的影响最小，并且简单的队列和线程管理使我们保持最新状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T16:15:37.873

我们只是在出错时登录到数据库，因为我们是一个频繁使用的 OLTP 系统。

如果数据库出现故障，则系统已停机：电话红热时的异步日志记录是多余的......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T16:47:27.780

我看到有人使用 Microsoft Enterprise Library 日志记录工具与 MSMQ 结合来实现异步日志记录。对观众没有帮助。

# c - C中的Socket编程，需要示例代码和教程

> ID：752460
> 
> 赞同：0
> 
> 时间：2009-04-15T16:10:33.253
> 
> 标签：c, sockets, winsock

我想在 C 中进行套接字编程。客户端和服务器正在交换消息。我有示例代码，但我想要一些用于套接字编程 C 的详细链接和教程，以便我可以编写有效且无错误的代码。我将使用 WinSock 库而不是 Linux。有什么帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T16:15:51.007

我认为对这个问题的标准回答是：

[http://beej.us/guide/bgnet/](http://beej.us/guide/bgnet/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T16:20:18.220

如果找到这本书 -[有效的 TCP/IP 编程](https://rads.stackoverflow.com/amzn/click/com/0201615894)

（虽然有些旧版本）在过去的某个时候非常有启发性。

W. Richard Stevens 所著的《UNIX 网络编程》一书是学习和理解这一切工作原理的绝佳资源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T16:23:54.513

请参阅基本示例、[完整的客户端代码](http://msdn.microsoft.com/en-us/library/ms737591(VS.85).aspx)和[完整的服务器代码](http://msdn.microsoft.com/en-us/library/ms737593(VS.85).aspx)。[Winsock Reference](http://msdn.microsoft.com/en-us/library/ms741416(VS.85).aspx)的所有原始和必要部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T16:18:10.580

安装[Windows® Server 2003 R2 Platform SDK Full 下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=484269e2-3b89-47e3-8eb7-1f2be6d7123a&displaylang=en&Hash=u%2bzUH17Zc0vZu8EJqdC%2fshgwWjcKxjvCbGrY9s8HGBt1BbTJ3k2pH47JCcEBT%2fAdBdoU9hPf3S3W5aQlwec9ig%3d%3d)这个有很多示例。

# text - 使用大量替换对在文本文件中执行大量替换

> ID：752461
> 
> 赞同：4
> 
> 时间：2009-04-15T16:10:37.480
> 
> 标签：text, sed, large-files, replace

鉴于：

*   包含数百万行的文件`a.txt`（例如，每行一个句子）（2.6 GB！
*   `b.txt`包含 830k 行的文件`[word1] [word2]`

问题：

如何在巨大的文本文件中为每个 830k 元组（w1，w2）中的每一个执行最有效的 word1 替换 word2？

像 sed、perl、python 等天真的方法需要数周时间才能完成。是否有（可能基于并行化的）方法来执行替换负载？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T16:22:34.317

我会用 python 来做，但如果你得到正确的算法，任何其他语言都可以做这个工作。整个技巧是将单词对（文件 b.txt）保存在内存中，并一次性浏览大文件。由于 I/O 操作比从 RAM 读取慢得多，因此这种方法的性能将是 O(file1) + O(file2)

在伪代码中：

```
myMap = {}
for line in fileB:
  myMap[1st word of line] = 2nd word of line

for line in fileA
  for word in line
    if myMap contains word
      replace word with myMap[word] 
```

我想这是你能得到的最快的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T16:14:57.577

将文件拆分成更小的块。您可能会占用大量内存空间，除了在内存或磁盘上移动位之外什么都不做。

这类似于连接/替换字符串数组而不是单个字符串的速度要快得多。

它的唯一技巧是确保您在文件中放置中断的位置不是一个很好的匹配，这是相对微不足道的。事实上，如果你可以通过行来做到这一点，那就更好了，不需要检查匹配项。

我也觉得奇怪的是它需要 PERL 数周。有一些轶事证据表明它可以在不到一个小时的时间内处理完：

*   [http://www.wellho.net/forum/Perl-Programming/replace-text-in-a-large-text-file.html](http://www.wellho.net/forum/Perl-Programming/replace-text-in-a-large-text-file.html)
*   [http://muharem.wordpress.com/2008/04/30/text-filtering-with-erlang/](http://muharem.wordpress.com/2008/04/30/text-filtering-with-erlang/)

事实上，他们在第二个链接中谈到 1gb 文件需要 2 分钟。

而且我不会怀疑替换操作应该比文件的复制操作花费更长的时间，毕竟，它只是拾取文件的块并在移动它们时替换一些位。它应该能够以接近复制它们的速度动态替换它们（因为它们已经在内存中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:19:15.710

按单词对查找/替换对列表进行排序以查找 [word1]

然后通读文件，将每一行拆分为单词，并在要替换的单词列表中查找每个单词（使用像二进制搜索这样的高效方法）。

应该是可以实现的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T16:27:39.513

我同意 idrosid 的回答，即仅将这些对加载到内存中，然后通过文件流式传输。如果您确实拥有大量数据（大量 Gb）并且您没有机器资源来按您希望的速度执行此操作，那么 Amazon 的新 Elastic Hadoop 服务将是一个很好的解决方案。一旦你有了一个适用于小文件的简单可执行文件，使用 Hadoop 的 Map Reduce 框架将其扩展到海量数据将非常简单。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-15T16:14:24.180

我会用 SQL 来做。

创建一个包含两列（dataline、sequence）的表，并将a.txt放入其中（每行一行）

然后创建第二个表，同样有两列（word1 和 word2）并将 b.txt 读入其中（同样，每个表行一行）

生成基于table2更新table1的update语句

运行sql语句

完成后，将第一个表读回文件中

# regex - 正则表达式中的逻辑

> ID：752463
> 
> 赞同：2
> 
> 时间：2009-04-15T16:11:21.300
> 
> 标签：regex, logic

我正在整理一些正则表达式来处理将传入链接从旧站点重定向到新站点上的等效页面。我希望我可以在正则表达式中处理以下情况，所以我不必在后端进行：

传入链接：/reservations/inn_details.asp?num=717

重定向链接：/reservations/property-detail.aspx?pid=00717

可以看到，原来的查询字符串值 717 需要在重定向链接中为 00717。规则是这些 ID 在重定向的 URL 中都需要有五个字符长。

所以我的问题是：是否可以在正则表达式中计算出查询字符串值有多少个字符，然后添加足够多的前导 0 以等于五个字符？

我可以做四个单独的正则表达式来覆盖值是 1、2、3 或 4 位长的情况，但是一举处理这一切会更酷！

谢谢，B。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T16:14:29.420

不幸的是，这不是你可以单独使用正则表达式处理的事情。在我看来，最简单的解决方法是更改​​ property-detail.aspx 以进行零填充。

我的意思是，只需将正则表达式重定向到“/reservations/property-detail.aspx?pid=717”，并让 aspx 文件在 pid 前面添加必要的零，然后再开始获取数据。无论如何都必须有一些代码来清理该输入（或者至少我希望如此），因此可以轻松地将其添加到该部分中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T16:35:05.017

如果你想使用 mod_rewrite，有一种方法可以做到：

```
RewriteCond %{QUERY_STRING} ^(([^&]*&)*)num=(\d+)(.*)
RewriteCond 0000%3 ^0+(\d{5})$
RewriteRule ^/reservations/inn_details\.asp$ /reservations/property-detail.aspx?pid=%1 [L,R=301] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:16:13.627

不知道在某些随机正则表达式实现中可能是什么，但至少对于真正的正则表达式，不。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T16:18:10.863

您还没有解释您调用正则表达式的通用语言。然而，大多数语言都提供了使用正则表达式来匹配和替换文本的工具。匹配字符串的数字部分，然后使用您的语言的特性用前导零填充数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T16:40:04.053

`[?&]num=(\d+)`将为您获得价值。但是正则表达式不实现逻辑，只实现模式识别。您的语言或工具集需要提供一种分析和处理它的方法。

例如在 perl 中，你可以：

```
s/([?&])num=(\d+)/sprintf( "%spid=%5.5d", $1, $2 )/e; 
```

但这当然只是解决了您的转换问题之一。

# javascript - 防止子 iframe “跳出框架”

> ID：752465
> 
> 赞同：15
> 
> 时间：2009-04-15T16:11:32.627
> 
> 标签：javascript, iframe

我正在做一些简单的网络集成工作，这些工作是通过使用 iframe 来完成的。我的主窗口有一些 javascript 与我的服务器交互以将 iframe 重定向到所需的 URL。遗憾的是，其中一个目标页面内部包含以下代码：

```
if (top.location != location) {
    top.location.href = document.location.href ;
} 
```

该脚本因跨站点脚本限制而终止，并阻止该页面正确呈现。我无法修改该页面的来源（我正在与之集成的第 3 方）。

我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-12-27T06:54:41.970

这是我的第一篇文章，所以如果它不起作用，请不要垃圾我，但这个修复似乎在 IE 中对我有用。将 security="restricted" 添加到您的框架中。

例子：

```
<iframe id="frame_id" name="frame_name" security="restricted" src="page.html">  
</iframe> 
```

编辑：我找到了更好的解决方案。这不会阻止脚本，也不需要 javascript。尝试使用沙盒=“...”

*   allow-forms 允许表单提交
*   allow-popups 允许弹出窗口
*   allow-pointer-lock 允许指针锁定
*   allow-same-origin 允许文档保持其来源
*   allow-scripts 允许 JavaScript 执行，也允许特性自动触发
*   allow-top-navigation 允许文档通过导航顶层窗口跳出框架

**顶部导航是您想要阻止的，因此将其排除在外，这样就不会被允许。任何遗漏的都会被阻止**

前任。

```
<iframe sandbox="allow-same-origin allow-scripts allow-popups allow-forms" src="http://www.example.com"></iframe> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-18T14:50:50.900

有一种技术可以禁用帧破坏代码，[如较新的 SO 问题中所述](https://stackoverflow.com/questions/958997/frame-buster-buster-buster-code-needed)：

> 事实证明，**您的帧破坏代码可以被破坏**，[如下所示](http://coderrr.wordpress.com/2009/02/13/preventing-frame-busting-and-click-jacking-ui-redressing/)：
> 
> ```
> <script type="text/javascript">
>     var prevent_bust = 0  
>     window.onbeforeunload = function() { prevent_bust++ }  
>     setInterval(function() {  
>       if (prevent_bust > 0) {  
>         prevent_bust -= 2  
>         window.top.location = 'http://server-which-responds-with-204.com'  
>       }  
>     }, 1)  
> </script> 
> ```
> 
> 此代码执行以下操作：
> 
> *   每次浏览器尝试通过`window.onbeforeonload`事件处理程序离开当前页面时，计数器都会递增
> *   通过 设置每毫秒触发一次的计时器，`setInterval()`如果它看到计数器增加，则将当前位置更改为攻击者控制的服务器
> *   该服务器提供带有 HTTP 状态代码**204**的页面，这不会导致浏览器在任何地方导航

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-11-06T19:48:03.903

一个有效的问题，我希望更多的人认真对待，而不是仅仅用蹩脚的评论来回应那些“尊重”那些材料被链接的人的意愿，有时是无意的。

尊重流量怎么样，那个框架破坏 javascript 窃取？

出于这个原因，在网络礼仪术语中，框架破坏脚本实际上是一个很大的禁忌。

使用框架或 iframe 有许多真正的、无辜的原因，对于代码，尤其是 url，被合法或非法地插入到该框架集中的页面中，这不仅非常容易，而且非常普遍，这会导致故意或以其他方式将流量转移到另一个相当粗鲁地破坏框架集并窃取流量的页面。

网站管理员使用的正确网络礼节方法，不希望他的材料显示在框架集中，无论是有意还是无意，是制作重定向脚本到首页，显示一条消息通知请求页面的冲浪者不打算在框架中查看，如果他们希望查看该页面，那么他们可以在一个 url 上查看它，然后链接，以在新选项卡或浏览器页面中打开，这不会不要打破框架集，窃取原始网站的流量，从而允许冲浪者自己选择他们真正希望冲浪的地方。

我希望更多的站长尊重这样的网络礼仪。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-01-05T04:27:45.053

经过大量搜索，我开发了一个简单的技巧。我在自己的站点中创建了一个虚拟页面，该页面需要 i 框架。然后我在虚拟页面中有一个 i 框架，它要求网站打破框架。它突破了第一帧，但由于虚拟页面在我的网站上，它整齐地留在首页的框架中。中提琴

# delegates - 是否有可能扩展 System.Delegate？

> ID：752466
> 
> 赞同：3
> 
> 时间：2009-04-15T16:11:34.997
> 
> 标签：delegates, cil

在 C# 中不能从 System.Delegate 或 System.MulticastDelegate 继承。只要您声明标准的“运行时管理”方法，就完全可以在 MSIL 中执行此操作。但是，每次我向类型添加“cil 管理”方法时，我都会得到：

**System.TypeLoadException：运行时实现的委托方法的非法定义。**

是否可以扩展 Delegate/MulticastDelegate？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T16:13:22.730

不是使用您自己的自定义代码，在 C# 中。从 C# 3.0 规范的第 10.1.4 节：

> 类类型的直接基类不能是以下任何类型：`System.Array`、`System.Delegate`、 `System.MulticastDelegate`、`System.Enum`或`System.ValueType`。此外，泛型类声明不能 `System.Attribute`用作直接或间接基类。

但是，每次创建委托类型时，它都会自动派生自`MulticastDelegate`.

从[ECMA-335](http://www.ecma-international.org/publications/standards/Ecma-335.htm)，第 8.9.3 节：

> 虽然在大多数情况下，委托似乎只是另一种用户定义的类，但它们受到严格控制。方法的实现由 VES 提供，而不是用户代码。可以在委托类型上定义的唯一附加成员是静态或实例方法。

这听起来像是在禁止构造函数。我个人会使用普通类型的静态方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T18:57:44.753

您可能有兴趣查看 Rick Strahl 的以下[帖子](http://www.west-wind.com/weblog/posts/653034.aspx)，其中他比较了动态委托创建的不同方法。

# c# - 响应过滤器中的 URL 重写

> ID：752473
> 
> 赞同：1
> 
> 时间：2009-04-15T16:13:19.453
> 
> 标签：c#, asp.net

我们正在尝试重写外部代理服务器的响应中的一些 URL。我们注意到响应在通过响应过滤器时被分解。然后我们使用正则表达式来定位 URL 并重写它们。我们遇到的问题是它被分解的方式（不完全确定它是如何被分割的），我们有一个 URL 在块之间被切成两半，所以我们的正则表达式没有在无论是块，它都没有被重写。

前任。

Chunk1 结束

```
"...<body><a href="http://myserver.local/"> 
```

Chunk2 的开始

```
"path/file.aspx">Some link</a>..." 
```

所以我们的正则表达式不会将链接作为有效的 URL。我们尝试将我们的响应汇集到一个 StringBuilder 中，以确保我们在尝试重写 URL 之前拥有整个响应，但这会导致视图状态被破坏。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T19:14:16.270

您的超链接是如何生成的？如果您使用 ASP.Net 链接控件来生成 URL；您可以使用自定义链接控件对链接控件进行子类化。这个新的链接控制，在检测到代理后，会即时重写你的链接；因此，在生成 HTML 之前，链接会根据需要进行更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T16:23:14.953

在我使用的 Java 平台上（对不起，不熟悉 asp.net）我们使用实用程序方法编写我们的 URL。这样，url 重写可以挂钩到该方法并重写整个 url。

优点是它可以非常有效地完成。缺点是你永远不能只在 HTML 中放置一个裸露的 url，你总是必须使用 helper 方法。但是，对于 J2EE，这被认为是一种正常的最佳实践，因此在我们的例子中开销并不大。

为了实现重写，我们有一个过滤器，它包装了 http 响应并覆盖了 encodeURL 方法。我不确定.net 是否有类似的概念。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:38:17.180

如果性能很关键，您可能希望使用自己的[DFA 扫描器](http://en.wikipedia.org/wiki/Deterministic_finite-state_machine)实现。

例如，创建所需表的工具是[GOLD 解析系统](http://www.devincook.com/goldparser/)（只需跳过 LALR 内容，它会根据 DFA 扫描程序找到的标记处理语法）。

# crystal-reports - Crystal Report 绑定到类型数据集从相关表添加列时引发错误

> ID：752474
> 
> 赞同：0
> 
> 时间：2009-04-15T16:13:20.313
> 
> 标签：crystal-reports

我正在使用 Crystal Reports 2008 设计报表，并使用 Crystal Reports 2008 运行时在 Web 应用程序中执行它们。我创建了一个简单的类型化 DataSet，它有两个表 TestTable1 和 TestTable2。每个都有几列，如 Id、Text1 和 Text2。我创建了一个测试报告，它使用这个 Typed DataSet 作为它的 DataSource。如果我仅从表 TestTable1 或 TestTable2 之一添加列，则可以使用此代码轻松执行报告。

```
 report = new ReportDocument();
        report.Load(Server.MapPath("bin/testreport.rpt"));

        var ds = GetData();

        report.SetDataSource(ds);

        CrystalReportViewer1.ReportSource = report;
        CrystalReportViewer1.RefreshReport(); 
```

问题是当我从另一个表中添加一列时，我收到了这条消息。

“文件 C:\Windows\TEMP\testreport {94​​AF2363-CA61-4944-B63E-C0E6E0391C9A}.rpt 中的错误：无法提交请求以进行后台处理。”

如果我只有一个表中的列，它工作得很好，但是从第二个表中添加任何列都会产生这个错误。

有任何想法吗？我在数据集中尝试了有关系和没有关系。我还尝试了一个无类型的数据集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T13:45:30.387

安装水晶报表 2008 SP0。

这不是错误 SP0 ......这是正确的零。去搞清楚。当然，棘手的部分是能够找到它。这是[链接](https://websmp230.sap-ag.de/sap(bD1lbiZjPTAwMQ==)/bc/bsp/spn/bobj_download/main.htm)。查看我的[博客条目](http://blog.randallsutton.net/post/Crystal-Report-Bound-to-a-Type-Dataset-Throws-error-when-add-column-from-related-table.aspx)以获取有关选择哪些选项的更多信息。（我仍然不能使用 img 标签发帖）

# c++ - 我是否正确初始化了我的 C++ 引用变量？

> ID：752479
> 
> 赞同：19
> 
> 时间：2009-04-15T16:13:59.220
> 
> 标签：c++, pointers, reference, initialization

我试过用谷歌搜索这个问题，但我找不到任何我认为相关的东西。所以我一定是在寻找错误的东西；尽管如此，我会很感激一些建议......

```
Foobar &foobar = *new Foobar(someArg, anotherArg); 
```

是我一个人还是看起来很臭？

我了解该`new`关键字是为与指针一起使用而设计的（因此）：

```
Foobar *foobar = new Foobar(someArg, anotherArg); 
```

但是，如果您不需要该实例上的指针，而是想使用引用呢？或者，是不是你不需要显式初始化它（很像局部变量）；如果是这种情况，如果我想用参数初始化怎么办？

以下不起作用（除非我做错了什么）：

```
// the last argument is of type: int
Foobar &foobar(someArg, anotherArg); 
```

...给出编译器错误：

> 初始化表达式列表被视为复合表达式 从“int”类型的临时变量中“Foobar&”类型的非常量引用的无效初始化</p>

而且这似乎也不起作用：

```
Foobar &foobar = Foobar(someArg, anotherArg); 
```

...给出编译器错误：

> 错误：从“Foobar”类型的临时变量中“Foobar&”类型的非常量引用的初始化无效</p>

### 更新1：

请记住，我正在返回这个值，所以我不想使用局部变量；我想在堆上使用一个值，而不是堆栈：

```
Foobar &helloWorld()
{
    Foobar &foobar = *new Foobar(someArg, anotherArg);
    foobar.HelloWorld();
    return foobar;
} 
```

我应该只使用指针，还是完全有效？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T16:17:10.070

为什么你认为你需要使用 new 和 references 呢？为什么不：

```
Foobar foobar(someArg, anotherArg); 
```

对于您的函数 - 返回一个值：

```
Foobar helloWorld()
{
    Foobar foobar(someArg, anotherArg);
    foobar.HelloWorld();
    return foobar;
} 
```

或指针：

```
Foobar * helloWorld()
{
    Foobar * foobar = new Foobar(someArg, anotherArg);
    foobar->HelloWorld();
    return foobar;
} 
```

如果你这样做 - 调用者负责在某个时候删除分配的对象。

从非成员函数返回是一个通常不能合理使用引用的地方，因为您想要引用的东西通常不再存在。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T16:21:24.537

对，就是臭！

如果您“新建”某些内容，请将其分配给指针（或智能指针类型），因为需要再次删除它以避免内存泄漏。引用通常不被认为是您需要再次删除的东西，因此如果其他人看到该代码（将新的对象分配给引用），很可能会使他们感到困惑。

你可以做...

```
const Foobar &foobar = Foobar(someArg, anotherArg); 
```

...如果您真的想要参考。请注意，一旦 foobar 超出范围，它所引用的临时对象就会消失。但是，当您可以直截了当地写出以下内容时，写出来的意义并不大：

```
Foobar foobar(someArg, anotherArg); 
```

您可能实际上并不需要参考......它们通常（但不是专门）用于方法参数的类型。这样你就可以传递一些看起来像对象的东西，但只有指针的大小，并且方法可以修改它。引入该参考主要是为了让您编写一个复制构造函数（我不会在这里解释！）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T16:18:44.980

C++ 中的引用确实没有人们期望的那么强大，我认为混淆来自那些习惯于 Java 和 C# 等没有指针并且具有可以重新分配和使用的引用的语言的人。

C++ 中的引用通常最好用作变量的别名，因此您可以简化参数传递和返回值等事情。在极少数情况下，您会尝试以第一行的方式获取参考。所以通常你不需要做你想做的事情:)

第二行当然是正确的，您可以从返回引用的函数中执行诸如 return *foobar 之类的操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T16:29:15.127

你写的对。但是请记住，通过 delete &refVar; 来释放 ptr 很奇怪。（它可能被误认为不是由 new 创建的变量）。

您应该查看 GotW 以了解在[http://www.gotw.ca/gotw/](http://www.gotw.ca/gotw/)周围传播的良好做法我不记得它是哪一课（不止一个），但通读它比任何人意识到的更有价值（陷阱将是少一个惊喜）

您应该尝试编写从不使用指针的代码。我这样做了，但是当我需要一个 BaseObj 容器时，我就卡住了。没有办法解决这个问题。通常我使用 STL 容器并在堆栈上拥有大多数变量 { MyClass myVar; ... } 或作为成员并根据需要传递它。

一旦您开始传递引用而不是指针并使用 stl 容器而不是 new 容器，它就很容易删除指针。请注意，我从不使用 auto_ptr。vector、string、deque、list 和 map 应该可以满足您的大部分需求。还有其他容器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T16:18:07.260

不，你明白了。一个 foo& “指向”实际对象，所以如果你真的想要一个 foo 引用，你必须取消引用 foo 指针。

不过，@Neil 有一个观点——从语法上讲，这就是你得到你想要的东西的方式，但你为什么想要它呢？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T16:40:07.597

我建议使用智能指针。您需要管理所有权，而参考不会为您做到这一点。事实上，它会让调用者模糊，根本就存在任何所有权问题。正如 Scott Langham 在评论中提到的那样， std::auto_ptr 会起作用。使用来自 Boost 或 TR1 的 shared_ptr 可能是一个更好的主意。

```
boost::shared_ptr<Foobar> helloWorld()
{
    boost::shared_ptr<Foobar> foobar(new Foobar(someArg, anotherArg));
    foobar->HelloWorld();
    return foobar;
} 
```

# python - 我可以在 Windows32 上免费将 numpy 和 scipy 编译为鸡蛋吗？

> ID：752482
> 
> 赞同：1
> 
> 时间：2009-04-15T16:14:35.457
> 
> 标签：python, windows, numpy, scipy

我被要求提供 Numpy 和 Scipy 作为 python 鸡蛋文件。不幸的是，Numpy 和 Scipy 没有为 Win32 平台以 .egg 形式发布他们的产品的官方版本——这意味着如果我想要鸡蛋，那么我必须自己编译它们。

目前我的雇主提供 Visual Studio.Net 2003，它不会编译 1.1.1 之后的任何 Numpy 版本——随后发布的每个版本都不能用 VS2003 编译。

我真正想要的是我可以使用的其他一些编译器，也许是免费的，但是作为一个免费的限时试用版......我可以用它来编译鸡蛋。有没有人知道我可以在不支付任何费用的情况下获得和使用另一个编译器，并且肯定会在 Windows 上编译 Numpy？

**请仅在您知道它会编译 Numpy 的事实时提出建议——不要猜测！**

谢谢

备注：我在一个对法律事务非常敏感的组织工作，所以我所做的一切都必须完全合法。我必须按照许可条款做所有事情，并且会接受审计。

我的环境：

*   视窗 32
*   标准 C Python 2.4.4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T16:24:41.907

[尝试使用MinGW32](http://www.mingw.org/)编译整个 Python 堆栈。 这是一个 GCC-Win32 开发环境，可用于构建 Python 和各种软件。您可能必须用它编译整个 Python 发行版。 [这](http://uucode.com/texts/python-mingw/python-mingw.html)是使用 MinGW 编译 Python 的指南。请注意，您可能还必须提供使用 MinGW32 编译的 python 发行版。

如果重新编译 Python 发行版不受欢迎，我相信 Python 2.4 是使用 VS2003 编译的。您可能会因为将 Scipy 和 Numpy 向后移植到 VS2003 或花钱请顾问来做这件事而受困。我会挖掘相关的邮件列表或联系维护人员并了解所需的工作量。

另一种选择是将 Python 的版本升级到更新的版本，但您可能必须对应用程序进行回归测试并将 Visual Studio 的版本升级到 2005 或 2008。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T16:27:43.880

你可以试试[GCC for Windows](http://gcc.gnu.org/install/specific.html#windows)。GCC 是最常用于在 Linux 上编译 Numpy/Scipy（或其他任何东西）的编译器，因此它也应该在 Windows 上工作似乎是合理的。（虽然我自己从未尝试过）

当然，它是根据 GPL 分发的，所以不应该有任何法律障碍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:27:58.560

如果您只需要编译器，它是 .NET 框架的一部分。

例如，您可以在以下位置找到 3.5 框架（用于 Visual Studio 2008）：

```
"C:\Windows\Microsoft.NET\Framework\v3.5" 
```

# inversion-of-control - 您如何将此功能修改为 IOC？

> ID：752485
> 
> 赞同：0
> 
> 时间：2009-04-15T16:14:39.530
> 
> 标签：inversion-of-control

我有一个简单的功能，只是想知道如何将我的编码风格转换为 IOC。

```
public User GetUserByID(int userID)
{
   DataProvider dp = new DataProvider();

   return dp.GetUserByID(userID);
} 
```

我的数据提供者是简单的 ADO.net，它打开一个连接，调用存储过程并返回用户对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T17:03:26.277

这是您通常使用 IoC 执行此操作的方式：

```
public interface IDataProvider
{
   User GetUserByID(int userID);
}

...

class Client
{
   // Client gets the IDataProvider as a mandatory constructor parameter
   public Client (IDataProvider dataProvider)
   {
      this.dataProvider = dataProvider;
   }

   public User GetUserByID(int userID)
   {
      return dataProvider.GetUserById (userID);
   }

   private IDataProvider dataProvider;
}

...

void Main()
{
   // create IoC container of your choice...
   IoCContainer container = new IoCContainer();
   // ... and then configure it (from a config. file or programmatically)
   container.Configure ();

   // create the Client instance using the container
   // note that the container takes care of creating appropriate IDataProvider 
   // for you
   Client client = container.GetService<Client>();
   User user = client.GetUserByID ("john doe");
} 
```

您的示例的唯一问题是您的客户端类的方法并没有真正为代码添加任何价值 - 它只是将调用转发给数据提供者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T16:22:14.970

与其在方法中显式创建 DataProvider 的实例，不如将其作为参数传递给方法。在您的方法之外，您可以创建一个工厂类来创建 DataProvider 的实例或使用像 Unity 这样的 IOC 容器。

# c++ - 从不同的进程通过套接字 (UDP) 回复客户端

> ID：752492
> 
> 赞同：0
> 
> 时间：2009-04-15T16:16:19.867
> 
> 标签：c++, c, sockets, udp

我有一个服务器，而不是一个“命令处理程序”进程。它通过 UDP 接收消息，并通过其发布的 API（无论该进程采用何种 IPC 机制）与该进程通信，从而将要做的工作委托给不同的进程。我们的系统有几个合作流程。然后，该 API 调用的结果会从命令处理程序进程发送回客户端。

一个命令是控制从另一个进程生成到客户端的数据流（“连接”消息）。

这应该工作吗？我将客户端的 IP 地址和端口号发送到另一个进程，该进程创建一个新套接字，并执行发送...我已经跟踪了代码，一切看起来都很好，但是客户端仍然被阻止接收...我知道如果我从命令处理程序发送到，它会得到响应，但不是来自新套接字。

这是一些示例代码：

```
#define LEN 10000
char buffer[LEN];
int sfd, nsfd, bread, addrsize;
struct sockaddr_in addr;
addrsize = sizeof (struct sockaddr_in);
server.sin_family = AF_INET;
server.sin_port = htons(5200);
server.sin_addr.s_addr = INADDR_ANY;
sfd = socket (AF_INET, SOCK_DGRAM, IPPROTO_UDP);
bind (sfd, (struct sockaddr*)&server, addrsize);
bread = recvfrom(sfd, buffer, LEN, 0, &addr, &addrsize);

/* send IP address and port number through the API to another process */
/* in that other process, I do something like this...addr has the IP
 * address and port in it from above: */

nsfd = socket (AF_INET, SOCK_DGRAM, IPROTO_UDP);
sendto(nsfd, buff, bread, 0, &addr, sizeof(addr)); 
```

所以请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T16:35:09.403

您应该测试错误返回，例如

```
if((nsfd = socket (AF_INET, SOCK_DGRAM, IPROTO_UDP)) < 0} {
    perror("at socket open");
    // I'd call exit here, probably
}
if(sendto(nsfd, buff, bread, 0, &addr, sizeof(addr) < 0){
    perror("At sendto");
} 
```

[这里](http://www.abc.se/~m6695/udp.html)有一个很好的教程示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-18T13:59:48.000

您的客户端（或介于两者之间的防火墙）可能会因为接收来自与发送请求不同的源端口的响应而感到困惑（因为操作系统只会为新套接字选择一个随机源端口）。

解决此问题的一种方法是在服务器中使用 SO_REUSEADDR 套接字选项，并在发送回复时显式绑定到正确的端口。但这也会产生不受欢迎的副作用，即 UDP 请求可能会被重定向到其他进程之一而不是服务器。

另一种选择（如果您使用的是 Unix/Linux）是通过 unix 域套接字（通过 sendmsg 和辅助数据）将服务器套接字传递给其他进程。

# wcf - 重启后wcf证书密钥集不存在问题

> ID：752499
> 
> 赞同：2
> 
> 时间：2009-04-15T16:17:20.147
> 
> 标签：wcf, certificate, reboot

一个 VS 解决方案中有两个项目：客户端（wpf 应用程序）和 wcf 服务库。
我在服务器端使用消息安全和自定义 AspNetMembershipPrivider 来验证用户名并通过。
由于我没有使用 Windows 安全性，我不得不在服务器上使用证书来建立安全的 chanell，我做了什么：
- 打开我的本地 IIS 管理器并添加了名为我的开发机器的自签名证书。
- 检查此证书是否出现在个人证书下的证书管理单元中
- 将 wcf .config 配置为指向该证书。
- 在 VS 中启动了我的客户端应用程序（并且 VS 还为我的 wcf lib 启动了 wcfhost 应用程序）
一切都很好，wcfhost 工作正常，我的服务工作正常，直到我重新启动。重新启动后 wcfhost 表示抱怨：

```
证书“CN=xxx”必须有一个私钥
的密钥交换。该进程必须具有私有访问权限
钥匙。--->
System.Security.Cryptography.CryptographicException：密钥集不存在

```

唯一有帮助的是重新创建我的证书，直到重新启动。正如我上面所说，我的服务在我的用户帐户（本地管理员）下运行，所以我认为我的 c:\Users\xxx\AppData\Roaming\Microsoft\Crypto\RSA\ 文件的权限不是问题。

我使用 iis 管理器创建证书而不是 makeert 等的原因是因为我想确保一切都将在我拥有的共享 osting 帐户上运行（托管面板中有创建自签名证书的选项）。

有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T14:27:54.933

根据我的经验，证书非常困难（我相信其他人已经通过它）。看到你已经让它工作了，你似乎就快到了，所以我的建议围绕着以不同的方式设置证书：

*   使用 SelfSSL.exe - 作为[IIS6.0 资源工具包](http://support.microsoft.com/kb/840671)的一部分提供，使用以下命令：***SelfSSL.exe /T /N:CN=localhost /V:999 /Q***（您可以将 localhost 替换为服务器名）。这将创建证书并将其安装在 IIS 中，有效期为 999 天。
*   使用 winHttpCertCfg - [Microsoft](http://www.microsoft.com/downloads/details.aspx?familyid=c42e27ac-3409-40e9-8667-c748e422833f&displaylang=en)提供的以下命令：***winHTTPCertCfg.exe -g -c local_machine\my -s localhost -a SERVICEACCOUNT***（相应地替换 localhost 和 SERVICEACCOUNT）为您运行它的服务帐户提供对证书私有的访问权限钥匙。

让我知道你是否有运气！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T23:03:34.950

我解决了这个问题。
我在打开 UAC 的开发盒上运行 Vista。大约一周前，我改变了启动 Visual Studio 的方式，显然我没有注意到我在没有“以管理员身份运行”选项的情况下开始使用 VS。这就是为什么 VS 推出的 WcfHost 也拥有有限的权利。我的错，我很少重新启动 VS，通常的做法是让 VS 运行一两个星期，例如 unreal3 同时午餐。

顺便说一句，任何人都可以说我对具有消息安全性的共享主机（IIS7）上的证书的访问权限有问题吗？或者我应该以运输安全为目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-21T01:00:30.827

以管理员身份运行将压倒证书上的保护，这是有效的。但解决方案是将运行服务器的用户名授予证书。在管理单元中，右键单击证书并执行所有任务 -> 管理私钥 -> 添加组或用户名。对于 IIS，将位置更改为本地计算机，用户名为“IIS AppPool/xxxxx”，其中 xxxxx 是要使用证书的应用程序正在其中运行的 IIS 应用程序池的名称。如果你做对了，“检查”按钮会告诉你。我也在 IIS Express 中摸索过它，但不记得我做了什么！我必须启动 IIS Express，在任务管理器中找到它，然后使用详细信息列查看它的用户名。希望这可以帮助。为我工作。

# java - 使用不同的数据多次运行相同的 JUnit 测试用例

> ID：752521
> 
> 赞同：78
> 
> 时间：2009-04-15T16:21:35.143
> 
> 标签：java, junit

有没有办法告诉 JUnit 在继续下一个测试用例之前使用不同的数据连续多次运行特定的测试用例？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-04-15T16:34:02.087

看看[junit 4.4理论](http://junit.sourceforge.net/doc/ReleaseNotes4.4.html)：

```
import org.junit.Test;
import org.junit.experimental.theories.*;
import org.junit.runner.RunWith;

@RunWith(Theories.class)
public class PrimeTest {

    @Theory
    public void isPrime(int candidate) {
          // called with candidate=1, candidate=2, etc etc  
    }

    public static @DataPoints int[] candidates = {1, 2, 3, 4, 5};
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-15T16:26:19.877

这听起来像是参数化测试的完美候选者。

但是，基本上，参数化测试允许您对不同的数据运行相同的测试集。

这里有一些关于它的好博客文章：

*   [编写参数化的 JUnit 测试](http://ourcraft.wordpress.com/2008/08/27/writing-a-parameterized-junit-test/)
*   [使用 JUnit 4.0 进行单元测试](http://java-x.blogspot.com/2007/01/unit-testing-with-junit-40.html)。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-12-05T17:40:45.457

最近我开始了[zohhak](https://github.com/piotrturski/zohhak)项目。它可以让你写：

```
@TestWith({
   "25 USD, 7",
   "38 GBP, 2",
   "null,   0"
})
public void testMethod(Money money, int anotherParameter) {
   ...
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-06-22T20:36:27.047

一种更好的方法（允许您拥有多个测试方法）是将 JUnit 与 JUnitParams 一起使用：

```
import junitparams.Parameters;
import org.junit.Test;

@RunWith(JUnitParamsRunner.class)
Public class TestClass() {

    @Test
    @Parameters(method = "generateTestData")
    public void test1(int value, String text, MyObject myObject) {
        ... Test Code ...
    }

    .... Other @Test methods ....

    Object[] generateTestData() {
        MyObject objectA1 = new MyObject();
        MyObject objectA2 = new MyObject();
        MyObject objectA3 = new MyObject();

        return $(
            $(400, "First test text.", objectA1),
            $(402, "Second test text.", objectA2),
            $(403, "Third test text.", objectA3)
        );
    }
} 
```

[您可以在此处](https://mvnrepository.com/artifact/pl.pragmatists/JUnitParams/1.0.5)获取 junitparams 项目。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-04-08T11:40:08.177

这是我写的一篇文章，其中显示了使用代码示例重复运行测试的几种方法：

[重复运行 JUnit 测试](http://codehowtos.blogspot.com/2011/04/run-junit-test-repeatedly.html)

您可以使用@Parametrized 跑步者，或使用帖子中包含的特殊跑步者

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-15T16:26:18.097

我总是只创建一个基于参数执行测试的辅助方法，然后从 JUnit 测试方法中调用该方法。通常这意味着一个 JUnit 测试方法实际上会执行大量测试，但这对我来说不是问题。如果您想要多种测试方法，每个不同的调用一个，我建议生成测试类。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-11-23T21:21:31.840

如果你已经`@RunWith`在你的测试类中使用了 a ，你可能需要看看[这个](https://stackoverflow.com/questions/27745691/how-to-combine-runwith-with-runwithparameterized-class)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-11-10T13:36:29.893

在 JUnit 5 中，您可以使用`@ParameterizedTest`and`@ValueSource`来获取一个方法，该方法使用不同的输入值多次调用。

```
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.ValueSource;

public class PrimeTest {
    @ParameterizedTest
    @ValueSource(ints = {1, 2, 3, 4, 5})
    public void isPrime(int candidate) {
        // called with candidate=1, candidate=2, etc.
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-27T15:23:32.010

如果您不想或不能使用自定义跑步者（例如，您已经在使用其他跑步者，例如 Robolectric 跑步者），您可以试试这个[DataSet Rule](https://github.com/mikinw/DataSet)。

# ruby-on-rails - 在 Rails 中持久化 memcache 会话

> ID：752523
> 
> 赞同：4
> 
> 时间：2009-04-15T16:21:39.480
> 
> 标签：ruby-on-rails, session, memcached

是否可以在 Rails 中同时使用两种会话类型？Memcached 是为了加快读取速度，还是说 SQL 是为了持久化？

我讨厌在重新启动时丢失所有会话的想法。

下面提到的 MemcacheDB 看起来很有希望，但其想法是将所有写入都写入磁盘，如果可能，所有读取都来自内存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-14T18:50:04.610

Redis FTW ( [http://code.google.com/p/redis/](http://code.google.com/p/redis/) )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T14:46:21.180

看看[MongoDB](http://www.mongodb.org/display/DOCS/Home)。它使用内存映射文件，因此速度非常快，并且应该在与 MemCached 相当的水平上执行，但也会持久存储您的数据。

MongoDB 是一个无模式的数据库，它应该支持您正在寻找的所有内容，并证明了对这些数据做任何您喜欢的事情的灵活性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T16:31:01.550

对于持久性，您可以使用 MemcacheDB 而不是 SQL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-14T18:53:19.983

查看[缓存货币](http://github.com/nkallen/cache-money#readme)。它是一个通读、通写缓存，可以附加到大多数 rails 模型并将结果存储在 memcache 中......

> 通读：像 User.find(:all, :conditions => ...) 这样的查询将首先在 Memcached 中查找，然后在数据库中查找该查询的结果。如果缓存未命中，它将填充缓存。
> 
> 直写：在创建、更新和删除对象时，所有缓存都会自动保持最新和一致。

我在几个项目中使用它，它按描述工作，似乎正是你想要的。许多环境的重大胜利。

# bash - 在没有源命令的情况下将 bash 脚本作为源运行

> ID：752525
> 
> 赞同：23
> 
> 时间：2009-04-15T16:22:30.197
> 
> 标签：bash, dot-source

有什么方法可以将脚本标记为“作为源运行”，这样您就不必添加`source`或“。” 每次都命令它？即，如果我编写一个名为“sup”的脚本，我想将其称为

```
sup Argument 
```

而不是

```
source sup Argument 
```

或者

```
. sup Argument 
```

基本上，我试图`cd`在脚本中使用。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-15T17:37:22.997

Bash 在它之前分叉并启动一个 subshel​​l 方式，或者你的内核甚至考虑它应该在那里做什么。这不是您可以“撤消”的事情。所以不，这是不可能的。

谢天谢地。

改为查看`bash`函数：

```
sup() {
    ...
} 
```

把它放在你的`~/.bashrc`.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-15T16:31:35.120

在运行 shell 时，有两种方法可以调用 shell 脚本：

*   **执行**脚本会产生一个新进程，脚本正在其中运行。这是通过键入脚本名称来完成的，如果它是可执行的并且以

    ```
    #!/bin/bash
    ```

    行，或直接调用

    ```
    /bin/bash mycmd.sh
    ```

*   **获取**脚本在其父外壳（即您正在输入命令的外壳）内运行它。这是通过键入

    ```
    source mycmd.sh
    ```

    或者

    ```
    . mycmd.sh
    ```

因此，没有来源的 shell 脚本中的 cd*永远不会*传播到其父 shell，因为这会违反进程隔离。

如果您只对*cd*感兴趣，则可以使用 cd "shortcuts" 摆脱脚本...查看 bash doc，位于 CDPATH env var。

否则，您可以使用别名来键入单个命令，而不是 source 或 .：

```
alias mycmd="source mycmd.sh" 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-15T16:26:07.770

为其创建别名：

```
alias sup=". ~/bin/sup" 
```

或者沿着这些路线。

另请参阅：[为什么 cd 在 bash shell 脚本中不起作用？](https://stackoverflow.com/questions/255414/why-doesnt-cd-work-in-a-bash-shell-script/255526)

* * *

通过反例回答评论：在 Solaris 10 上进行 Korn Shell 实验表明我可以做到：

```
$ pwd
/work1/jleffler
$ echo "cd /work5/atria" > $HOME/bin/yyy
$ alias yyy=". ~/bin/yyy"
$ yyy
$ pwd
/work5/atria
$ 
```

在 Solaris 10 上对 Bash (3.00.16) 进行的实验也显示了相同的行为。

* * *

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-03-24T10:41:49.913

如果在调用时对脚本进行子外壳，则无法在当前环境中获取脚本。

但是，您可以**检查脚本是否有来源**，如果没有，则强制脚本终止：

```
if [ -z "$PS1" ] ; then
    echo "This script must be sourced. Use \"source <script>\" instead."
    exit
fi 
```

同样，您可以**强制脚本不作为来源，**而是改为子外壳（保留当前的外壳环境）：

```
if [ "$PS1" ] ; then
    echo "This script cannot be sourced. Use \"./<script>\" instead."
    return
fi 
```

这两个版本都可以作为要点：请参阅[请来源](https://gist.github.com/timlegrand/d67d502be82be7983ff1)和[不要来源](https://gist.github.com/timlegrand/a6911f653d5a785b57cd)。

# asp.net - 我发现使用会话对象（.net）是一种邪恶的做法，我是不是太苛刻了？

> ID：752548
> 
> 赞同：3
> 
> 时间：2009-04-15T16:27:30.340
> 
> 标签：asp.net, session

询问您对会话对象的意见，我从不使用它（只是被迫在工作中使用），因为它在扩展服务器时存在问题。我意识到您可以退出 proc 并让 sql server 管理会话，但我只是不喜欢这种想法。

我宁愿围绕这个问题建立一个更好的数据库设计，而不是仅仅在会话中抛出一些东西来保存数据库调用。

我一个人在这个吗？我应该重新考虑我对会议的立场吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T16:33:44.367

我觉得你的立场有些极端。在我的书中，明智地使用会话绝对是可以的——例如，我在会话中存储了一些首选项（过滤器的可见性等），因为它们与会话相关联，而不是跨会话持续存在。它当然可以被滥用，但我反对的是滥用，而不是使用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-15T16:37:53.827

以我的经验，这完全取决于您正在处理的场景：

*   **高流量/Web Farm/分布式应用**。会话对象*通常*是一件坏事。您必须将信息集中在某处（共享内存、数据库、其他），然后对其进行写入/读取性能损失。也就是说，如果没有某种会话状态系统，那么您可以通过所述应用程序实现很多目标。使用 cookie 通常是退出条款 - 只需注意敏感信息。

*   **其他一切**。使用会话，它们非常方便。

“这取决于”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-15T16:31:40.393

我认为在某些情况下将数据放入 Session 是有用的，但也很容易像任何其他功能一样偷懒和滥用它。所以，我说，在适当的地方使用它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-15T16:38:28.647

我发现（不恰当地）使用 ___________ 是一种邪恶的做法。就像我认为吃太多________是一种邪恶的做法一样。

一切都有它的位置。一切都可能被滥用。知道什么时候用什么工具，什么时候切换，是工匠大师的标志。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T16:31:31.003

你是，但只是一点点。你是绝对正确的——在中间件中维护会话状态意味着随着系统变得越来越大，应用程序和网络中的复杂性。

另一方面，相对较少的应用程序实际上会变得如此之大以至于多服务器可伸缩性成为问题，因此根据项目的不同，它可能会增加较少的复杂性。

不过，在被证明是无辜的之前，我肯定会认为它有罪。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T16:39:10.797

会话用于存储临时变量，因此除非您需要长时间存储这些数据，否则我不明白为什么您需要在数据库中设计专门的表来避免使用会话。至于缩放，请查看[Microsoft Velocity](http://msdn.microsoft.com/en-us/data/cc655792.aspx)（目前在 CTP 中）。我相信会话是一件好事。但我遵循的原则是，即使是好的东西，如果不适度使用，也会变成坏东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T16:35:55.920

在 ASP.NET Web 应用程序中使用 Session 状态本身并没有错，只要您谨慎使用它并注意良好的设计原则。例如，在会话状态中缓存大对象然后使用 SQL Server 管理会话状态是没有意义的；您将从数据库中读取/写入大量数据，这首先会破坏缓存它的目标！但是，使用会话状态在页面之间存储一些原语对我来说似乎没问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-15T16:36:37.137

您应该重新考虑使用会话的目的，而不是完全决定是否使用它。

有很多方法可以存储来自 cookie、查询字符串以及会话对象的基于“会话”的信息。

会话可能会被过度使用......很多......只是因为人们可能会糟糕地使用它，但并不会使它变得糟糕。

你想要你的用户对象吗？你只想要一个 UserId 吗？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-15T17:01:27.497

我觉得你太苛刻了。有些人对会话对象所做的事情并不总是一个好主意，但该技术本身并没有错。

缓存是在适当情况下很好地使用会话对象。例如，缓存存储在数据库中的用户特定数据，除了该用户的操作之外不会经常更改。这会导致 Web 服务器上的内存损失，以换取 DB 服务器上的更少命中。我很高兴做出这种权衡，因为与多台 SQL 服务器相比，扩展到多台 Web 服务器更简单、更便宜。

我的一般经验法则是仅将会话用于缓存情况。也就是说，如果在没有用户干预的情况下会话过期后代码无法轻松地重新加载，我不会去那里。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T20:32:13.293

伙计，这是我的想法，我可能是错的

- 如果您有要共享的数据，则使用静态类，我对此有过惊人的体验，而且它们的效率要高得多。

- 使用 Profile 它是强类型，但你首先必须优化它，否则它会杀死你的网站，这是关于 [http://msmvps.com/blogs/omar/archive/2006/08/17/optimize的非常好的文章-asp-net-2-0-profile-provider-before-you-go-live.aspx](http://msmvps.com/blogs/omar/archive/2006/08/17/optimize-asp-net-2-0-profile-provider-before-you-go-live.aspx)。

还有一件事是，我从这个伟大的家伙那里学到了一个很棒的技巧来清除匿名个人资料。

[http://leedumond.com/blog/managing-anonymous-users-for-better-site-performance/](http://leedumond.com/blog/managing-anonymous-users-for-better-site-performance/)

*   还有很多其他方式来存储用户数据，这个链接真的很丰富 [http://steveorr.net/articles/PassData.aspx](http://steveorr.net/articles/PassData.aspx)

*   如果您的站点很小，那么会话真的很好。

希望这可以帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-28T06:40:43.493

会话在几个方面是邪恶的。一，它让你觉得你可以轻松地在其中存储任何类型的对象，但是当你尝试在多个服务器上扩展它时，就像......对不起，你必须让你存储的所有对象都可以序列化. 如果您不想使所有内容都可序列化（或不能），那么每当您重建应用程序或回收网络应用程序时，您就会陷入进程内会话状态并丢失会话。最后，它在打开时添加的每个请求都会产生开销，并且通常缺乏对任何预打包的开箱即用解决方案的控制。

从一开始就使用定制的高效解决方案几乎会更好。我使用它的次数越多，我就意识到 Session 有点太方便了，就它似乎提供的东西而言……但有合法的用途。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-15T16:33:18.533

使用数据库的自制会话处理与存储在数据库中的会话状态之间究竟有什么区别？

如果您需要服务器上有状态的东西，使用会话（当然只有一些小的可序列化对象）对我来说似乎不是那么糟糕......

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-15T17:07:18.700

使用 Session 的最佳方式可能是使用它们来缓存会话数据。通过这种方式，您仍然可以将它们 InProc 保留在具有会话关联的服务器场环境中，这样您就可以获得性能优势。但是，如果您丢失了会话，您可以通过查询数据库再次获得它。

会话作为具有会话范围的全局变量的机制**是**邪恶的。

# apache-flex - Flex/air 或谷歌齿轮或其他

> ID：752556
> 
> 赞同：0
> 
> 时间：2009-04-15T16:28:48.747
> 
> 标签：apache-flex, air, google-gears

我正在开始一个新项目，它分为两部分：一个 php 应用程序和一个桌面应用程序，它将使用来自 php 应用程序的信息。
桌面应用程序需要满足以下要求：

*   易于安装
*   易于启动
*   允许离线数据查看
*   允许与 php 应用程序同步。

哪种解决方案更好 Flex/air 或 google gears 或其他？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T16:36:27.450

Google gears 将允许离线数据查看，但要创建一个独立的桌面应用程序，您需要 AIR 或类似的东西（您可以将 Gears 与 ie. GWT 结合使用并使用 AIR 运行，或使用 Flex）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T12:29:25.997

Adobe AIR 满足所有条件，当然，如果您也想提供基于 Web 的界面，您将通过在 Flex 中构建来享受大量代码重用。我目前正在为我的 Flex/Air/Php 开发使用 Zend 框架，它做得很好——我建议这样做。

杰米。

# ruby-on-rails - 为什么 Rails 助手不是更面向对象的？

> ID：752572
> 
> 赞同：4
> 
> 时间：2009-04-15T16:32:34.883
> 
> 标签：ruby-on-rails, oop, helpers

例如，为什么日期助手是这样写的：

```
time_ago_in_words(@from_time) 
```

而不是这样：

```
@from_time.time_ago_in_words 
```

这是一个明显的设计错误/不一致吗？还是有什么原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T17:39:05.253

助手是视图对象上的方法，而不是它们正在显示的对象上的方法。这在 OO 意义上是有意义的，因为视图以特定格式显示数据，因此它负责将模型转换为该格式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T16:50:37.633

好问题！

大多数助手用于选择日期/时间。

[http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html)

我猜想写它的人想要几个 util 方法，因此将 time_ago_in_words 和 distance_of_time_in_words 添加到他们的助手中。

由于 time_ago_in_words 和 distance_of_time_in_words 以演示为重点（即您可能希望将其本地化），因此开发人员可能认为助手对他们来说不是一个坏地方。

# xml - 为什么我必须为 libcl.2 使用 LD_PRELOAD 才能在 HP/UX 上使用 XML::LibXML::Common？

> ID：752573
> 
> 赞同：2
> 
> 时间：2009-04-15T16:32:49.347
> 
> 标签：xml, perl, unix, shared-libraries, preloader

仅在 HP 平台上强制执行 LD_PRELOAD，而不在其他 unix 风格（AIX、Linux 和 Solaris）上强制执行。

我在所有 Unix 风格上构建了 Perl 模块[XML::LibXML::Common](http://search.cpan.org/dist/XML-LibXML-Common) 。我必须专门为 HP 平台上的 libcl.2 库执行 LD_PRELOAD。而在其他 unix 平台上则不需要这样的东西。

这是操作系统行为还是 HP 加载器/编译器中真正缺少的东西？

我正在运行一个 perl 脚本，它只是创建一个“XML::LibXML::SAX”的新对象

```
use XML::LibXML::SAX;
$x = XML::LibXML::SAX->new(); 
```

它抱怨

> 无法为模块 XML::LibXML::Common 加载“site_perl/5.8.8/PA-RISC2.0-thread-multi/auto/XML/LibXML/Common/Common.sl”：执行格式错误

当我为 libcl.2 执行 LD_PRELOAD 时，错误消失了，Perl 是为多线程支持而构建的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T06:32:45.210

我想你是在问为什么你必须使用它。如果您正在运行 Perl 多线程，则您正在调用的库之一是在 libc 之前加载的，它可能是单线程的。作为其依赖处理的一部分，它试图在您的环境中加载多线程库。通过使用 LD_PRELOAD 我认为您正在使用库插入原理来强制该库在加载不安全库之前加载。插入的概念是一个复杂的概念，您可能会从以下[链接](http://developers.sun.com/solaris/articles/lib_interposers.html)中获得一些好处：

**摘抄：**

> 要使用库插入，您需要创建一个特殊的共享库并设置 LD_PRELOAD 环境变量。设置 LD_PRELOAD 后，动态链接器在搜索共享库时将优先使用指定的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T16:51:24.590

您的问题不清楚...为什么必须使用 LD_PRELOAD？

是不是因为 HP-UX 使用 SHLIB_PATH 而不是 LD_LIBRARY_PATH，所以您设置了错误的环境变量？

它在其他平台上也有其他拼写 - Solaris 和 Linux 恰好共享相同的一组 env。瓦尔斯。MacOS X 使用 DYLIB_LIBRARY_PATH；我相信 AIX 使用使用 LIBPATH。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T20:58:08.733

虽然这是一个古老的主题，但我现在在 HP-UX 上看到了类似的东西。在我的例子中，它不是 Perl，但是在构建 Python 的 sqlite3 绑定时，/usr/lib/libcl.2 的动态加载失败了。

我已经使用 --with-libs='-lcl' 运行了配置脚本。尽管将其链接到二进制文件和使用 LD_PRELOAD 并不相同，但在加载 /usr/lib/libcl.2 时两者都会发生变化。既然它解决了我的问题，那就试试吧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T06:24:11.503

我不确定这是否相关，但可能是。HP-UX 包含的 Perl 不是标准 Perl，而是 ActiveState Perl 的副本——以及可能包含的任何奇怪之处。如果您发现 Perl 在 HP-UX 上的行为与其他所有环境不同，请检查 ActiveState Perl 是否有问题。

# c# - C#“使用”语句何时最有用？

> ID：752581
> 
> 赞同：15
> 
> 时间：2009-04-15T16:35:05.627
> 
> 标签：c#, using-statement

因此，当退出 using 块时，using 语句会自动调用正在“使用”的对象上的 dispose 方法，对吗？

但是什么时候这是必要的/有益的？

例如，假设你有这个方法：

```
public void DoSomething()
{
    using (Font font1 = new Font("Arial", 10.0f))
    {
        // Draw some text here
    }
} 
```

由于对象是在方法中创建的，因此是否需要在此处使用 using 语句？当方法退出时，Font 对象不会被丢弃吗？

或者 Dispose 方法是否在方法退出后的另一个时间运行？

例如，如果方法是这样的：

```
public void DoSomething()
{
    Font font1 = new Font("Arial", 10.0f);

    // Draw some text here
}

// Is everything disposed or cleared after the method has finished running? 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-15T16:37:15.607

'using' 语句在处理非托管对象时最有用，例如数据库连接。

这样，无论代码块中发生什么，连接都会被关闭和处理。

有关更多讨论，请参阅 CodeProject 上的这篇文章：http: [//www.codeproject.com/KB/cs/tinguusingstatement.aspx](http://www.codeproject.com/KB/cs/tinguusingstatement.aspx)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-15T16:39:59.953

如果没有`using`（或手动调用`Dispose()`），对象最终将被处理掉，只是不是在确定的时间。也就是说，它可以在两天内立即发生，或者（在某些情况下）永远不会发生。

对于诸如网络连接之类的事情，您希望连接在完成后关闭，而不是“无论何时”，否则它将在占用套接字时闲置。

此外，对于诸如互斥锁之类的东西，您不希望“随时”释放它们，否则可能会导致死锁。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-15T17:02:21.257

这：

```
public void DoSomething()
{
    using (Font font1 = new Font("Arial", 10.0f))
    {
        // Draw some text here
    }
} 
```

直接映射到这个：

```
public void DoSomething()
{
    {
        Font font1;
        try
        {
            font1 = new Font("Arial", 10.0f);
            // Draw some text here
        }
        finally
        {
            IDisposable disp = font1 as IDisposable;
            if (disp != null) disp.Dispose();
        }
    }
} 
```

注意 finally 块：即使发生异常，对象也会被释放。还要注意额外的匿名范围块：这意味着不仅对象被释放，而且它也超出了范围。

另一件重要的事情是保证立即进行处置。这是*确定性*的。如果没有 using 语句或类似构造，对象在方法结束时仍会超出范围，然后最终可以被收集。理想情况下，该资源将被销毁，以便系统可以回收。但是“最终”可能暂时不会发生，“理想情况下”和“将”是非常不同的事情。

因此，*“最终”并不总是足够好。*数据库连接、套接字、信号量/互斥体和（在这种情况下）GDI 资源等资源通常受到严重限制，需要立即清理。using 语句将确保发生这种情况。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-15T16:41:57.000

using 构造强制执行*确定性*处置——即资源的释放。在上面的示例中，是的，如果您不使用“使用”语句，则对象将被释放，但前提是已实现推荐的一次性模式（即，从类终结器中释放资源，如果适用*）*对于有问题的类（在您的示例中为 Font 类）。需要注意的是，using 结构只能用于实现`IDisposable`接口的对象。正是该接口在对象上的存在允许使用“调用”该`Dispose`方法。

此外，只有当垃圾收集器决定收集超出范围的 Font 对象时，才会释放底层资源。.Net 编程（以及大多数带有垃圾收集器的语言）中的一个关键概念是，仅仅因为一个对象超出范围并不意味着它已完成/释放/销毁等。相反，垃圾收集器将执行清理 -在它确定的时间向上 - 不是在对象超出范围时立即向上。

最后，using 语句“烘焙”了一个 try/finally 结构，以确保无论包含的代码是否引发异常都会调用 Dispose。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T16:37:35.013

当需要释放资源并实现 IDisposable 接口时，“Using”就会发挥作用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-15T16:39:52.247

这是 using 真正的作用（基于您的示例）

```
Font font1 = new Font(...);
try
{
    // code that uses font...
}
finally
{
    if (font1 != null)
        font1.Dispose();
} 
```

因此，您无需担心导致变量未释放的异常。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-15T16:48:58.387

> 当方法退出时，Font 对象不会被丢弃吗？

不，它将变得未被引用，因此有资格进行垃圾收集。除非其他东西（例如，保存在另一个数据结构中的引用）保持引用。

> 或者 Dispose 方法是否在方法退出后的另一个时间运行？

是的，在一个没有分配太多内存的过程中，在方法退出后可能需要相当长的时间。

垃圾收集本质上是异步和惰性的，因此如果内存不太有限，它是确保释放内存的好方法；但几乎所有其他资源都很差。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-15T17:08:17.607

这对我来说似乎很简单。

如果一个类实现了 IDisposable，那么它几乎是*要求*您在完成后立即对您创建的任何实例调用 Dispose。这是我建议应该使用的模式，*无论何时*创建这样的实例：

```
using (var instanceName = new DisposableClass())
{
    // Your code here
} 
```

它很简单，很干净，它适用于除了 WCF 代理类之外的所有东西，这些代理类被破坏了。对于那些，请参阅[http://www.iserviceorientated.com/blog/post/Indisposable+-+WCF+Gotcha+1.aspx](http://www.iserviceoriented.com/blog/post/Indisposable+-+WCF+Gotcha+1.aspx)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T16:38:48.347

当您希望在对象上确定地调用清理代码并且不考虑异常（因为`using`语句实际上只是 a `try/finally`）时，它们在任何情况下都很有用。

大多数情况下，它们用于清理非托管资源，但您可以随意使用它们。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T16:41:55.627

它是 try-catch-finally 块和对 Dispose 方法的调用之上的纯语法糖。它甚至不必定义词法范围，因为您可以将其交给实例变量。基本上，它使您的代码更简洁，更易于维护。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-15T16:42:21.380

Dispose 在退出 using 语句时被调用，因为它是由该构造显式调用的。当变量超出范围（退出方法）时，不会显式调用 dispose 方法。

您可能观察到的行为看起来是这样的，通常实现 IDisposable 的东西也会在类析构函数中调用 Dispose 方法，并且可以在变量超出范围后立即调用析构函数，但不能保证。析构函数由垃圾收集器调用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-15T16:43:43.813

我喜欢这样使用它们：

```
 static public void AddSampleData(String name)
    {
        String CreateScript = GetScript(String.Format("SampleData_{0}", name));
        using (IDbConnection MyConnection = GetConnection())
        {
            MyConnection.Open();
            IDbCommand MyCommand = MyConnection.CreateCommand();
            foreach (String SqlScriptLine in CreateScript.Split(';'))
            {
                String CleanedString = SqlScriptLine.Replace(";", "").Trim();
                if (CleanedString.Length == 0)
                    continue;

                MyCommand.CommandText = CleanedString;
                int Result = MyCommand.ExecuteNonQuery();
            }
        }
    } 
```

它们适用于您不想将错误检查代码仅清理并将错误传递下来的情况。替代方法如下所示：

```
 static public void AddSampleData(String name)
    {
        String CreateScript = GetScript(String.Format("SampleData_{0}", name));

        IDbConnection MyConnection = null;
        try
        {
            IDbConnection MyConnection = GetConnection();
            MyConnection.Open();
            IDbCommand MyCommand = MyConnection.CreateCommand();
            foreach (String SqlScriptLine in CreateScript.Split(';'))
            {
                String CleanedString = SqlScriptLine.Replace(";", "").Trim();
                if (CleanedString.Length == 0)
                    continue;

                MyCommand.CommandText = CleanedString;
                int Result = MyCommand.ExecuteNonQuery();
            }
        }
        finally
        {
            if (MyConnection != null
                && MyConnection.State == ConnectionState.Open)
                MyConnection.Close();
        }
    } 
```

坦率地说，哪种方法更容易阅读？与表格相同：

```
 public void ChangeConfig()
    {
        using (ConfigForm MyForm = new ConfigForm())
        {
            DialogResult ConfigResult = MyForm.ShowDialog();
            if (ConfigResult == DialogResult.OK)
                SaveConfig();
        }

        ConfigForm MyForm = new ConfigForm();
        DialogResult ConfigResult = MyForm.ShowDialog();
        MyForm.Dispose();
        if (ConfigResult == DialogResult.OK)
            SaveConfig();
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-15T16:50:49.987

关于确定性与非确定性以及幕后`using`工作如何正确的所有答案。

但是要选择您的特定示例，请不要忘记几乎*所有*System.Drawing（GDI+ 包装器）对象也包含对非托管内存的引用，因此在广泛使用这些对象而不正确处理它们时可能会遇到麻烦（哪里`using`是最简单的方法）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-15T18:38:12.663

我在这里问了一个非常相似的问题：

[必须在 C# 中手动清理的资源？](https://stackoverflow.com/questions/117135/resources-that-have-to-be-manually-cleaned-up-in-c)

我得到了一个很好的建议，形式如下：

> 一般来说，如果某个东西有一个 Dispose 方法，你应该在用完它后调用它，或者，如果可以的话，将它包装在 using 语句中。

# c++ - Win32 应用程序在最小化窗口动画时暂停

> ID：752593
> 
> 赞同：2
> 
> 时间：2009-04-15T16:37:25.043
> 
> 标签：c++, windows, animation, window, windows-xp

第一次在这里海报。

我正在 Windows XP SP2 上用 C++ (MSVC) 编写一个多线程流音频应用程序。

我遇到的问题是，在最小化/恢复任务栏上的任何应用程序时，我的应用程序中的所有线程都在窗口动画处于活动状态时被挂起。这会影响我，因为每次最小化或恢复窗口时，它都会导致我的应用程序中的音频出现断断续续的情况。

在窗口/系统属性/高级/性能“视觉效果，处理器调度，...”/设置/自定义选项卡中取消选中标题为“最小化最大化时动画窗口”的复选框似乎可以解决此问题。

将我的进程的优先级调整为“高”和“实时”没有帮助。

任何人都可以帮助阐明这个话题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T16:50:52.470

这些动画，或在拖动窗口时绘制窗口（这应该会产生类似的问题）用 WM_PAINT 消息淹没窗口消息提示，并导致窗口中的每个小部件/控件重新绘制自身。这会使计算机及其上运行的所有线程和进程完全陷入瘫痪。

两种可能的解决方案：

*   冻结窗口，即在调整窗口大小/最小化/被拖动时丢弃任何 WM_PAINT 消息。您也可以通过使用某种标志 (lockRedraw) 或类似的方式来做到这一点。

    *   更改优先级对您没有帮助，甚至可能会增加问题，尽管我对 wxp 的调度策略一无所知。

编辑：忘记了实际的第二个解决方案：

*   为您的音频使用更大的缓冲区。如果您可以一口气将半秒或整秒的缓冲区传递给声卡，那么在多线程环境中您绝对应该是安全的

重新编辑：我忽略了你说的*任何*窗口。只有使用更大缓冲区的解决方案 2 可能会有所帮助。声音缓冲区通常会被扔到硬件上的某个缓冲区中，一旦它们在那里，应该没问题。

我想到了另一种可能性：这些动画带有声音。检查您为最大化/最小化设置了哪种声音。将其关闭并重试

如果问题仍然存在，则可能是由于显卡驱动程序不佳。如果没有，请查看您的声音（可能是 directSound？不知道）设置是否正常。也许您可以编写一些资源冲突。（不在硬件管理器中，而是在您访问声音设备的方式中。）

# javascript - Visual Studio 代码格式化程序

> ID：752600
> 
> 赞同：6
> 
> 时间：2009-04-15T16:39:01.187
> 
> 标签：javascript, visual-studio-2008, formatting

我正在使用 Visual Studio 2008 在 C# 和 JavaScript（AJAXy 的东西）中工作。

这是我的问题——我喜欢 Eclipse，尤其是格式化的代码 (Ctrl-Shift-F)。相比之下，Visual Studio 的 Ctrl-k、Ctrl-d 真的很糟糕，尤其是对于 javascript。

有没有办法让 VS 表现得像我想念的 IDE？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T16:50:09.600

进入工具 | 选项 | 文本编辑器并根据您的喜好编辑语言特定设置。Ctrl-K、Ctrl-D 支持这些设置，因此您可以使代码格式化程序按照您想要的方式工作。您可以更改大量选项（括号定位、间距、缩进等）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T16:47:19.887

我使用出色的[Resharper 插件](http://www.jetbrains.com/resharper/)来格式化我的 C# 代码。许多设置需要更改以根据您的喜好格式化您的代码。甚至可以使用 Resharper 制定一种编码标准，供所有程序员使用。

至于键绑定，可以在您的选项中更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-02T15:33:25.430

这是visual studio的一个解决方法：我只是将扩展名重命名为.css，在文档内右键单击并选择“格式化文档”并将其重命名为.js，格式很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T16:46:25.053

转到选项 > 环境 > 键盘，找到命令 Edit.FormatDocument 并将其绑定到 ctrl + shift + f

编辑：误读，您可以在选项>文本编辑器>（文档类型）中配置VS格式。

不知道你是否能像eclipse一样得到它，但这就是你设置偏好的地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T16:48:36.233

我没有尝试过，但[Resharper](http://www.jetbrains.com/resharper/)有很多与格式和编码相关的好东西。也许你可以在那里找到有用的东西，你也可能会开始喜欢 VS。

注意：VS2005 上的 Resharper 有点迟钝。

# python - Python 表达式文档中的“切片”

> ID：752602
> 
> 赞同：23
> 
> 时间：2009-04-15T16:39:42.870
> 
> 标签：python, syntax

我不理解 Python 文档的以下部分：

[http://docs.python.org/reference/expressions.html#slicings](http://docs.python.org/reference/expressions.html#slicings)

这是指列表切片（`x=[1,2,3,4]; x[0:2]`）..？特别是提到省略号的部分..

```
slice_item       ::=  expression | proper_slice | ellipsis 
```

> 作为表达式的切片项的转换就是该表达式。省略号切片项的转换是内置的省略号对象。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-15T19:12:07.183

[省略号](http://docs.python.org/dev/library/constants.html#Ellipsis)主要由[数字 python](http://numpy.org/)扩展使用，它添加了多维数组类型。由于有多个维度，[切片](http://numpy.scipy.org/)变得比仅仅一个开始和停止索引更复杂；能够在多个维度上切片也很有用。例如，给定一个 4x4 数组，左上角区域将由切片 "[:2,:2]" 定义

```
>>> a
array([[ 1,  2,  3,  4],
       [ 5,  6,  7,  8],
       [ 9, 10, 11, 12],
       [13, 14, 15, 16]])

>>> a[:2,:2]  # top left
array([[1, 2],
       [5, 6]]) 
```

省略号在这里用于指示未指定的其余数组维度的占位符。可以将其视为指示未指定维度的完整切片 [:]，因此对于 3d 数组，与 4d`a[...,0]`相同。`a[:,:,0]``a[:,:,:,0]`

请注意，虽然有一个内置的 Ellipsis 对象，但实际的 Ellipsis 文字 (...) 在 python2 中的切片语法之外不可用。这就是“省略号切片项的转换是内置的省略号对象”的意思。IE。“ `a[...]`”实际上是“”的糖`a[Ellipsis]`。在 python3 中，`...`表示 Ellipsis 任何地方，所以你可以写：

```
>>> ...
Ellipsis 
```

如果你不使用 numpy，你几乎可以忽略所有提到的省略号。没有任何内置类型使用它，所以您真正需要关心的是列表传递一个包含“ `start`”、“ `stop`”和“ `step`”成员的切片对象。IE：

```
l[start:stop:step]   # proper_slice syntax from the docs you quote. 
```

相当于调用：

```
l.__getitem__(slice(start, stop, step)) 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-04-15T17:42:17.260

定义简单的测试类，只打印正在传递的内容：

```
>>> class TestGetitem(object):
...   def __getitem__(self, item):
...     print type(item), item
... 
>>> t = TestGetitem() 
```

表达式示例：

```
>>> t[1]
<type 'int'> 1
>>> t[3-2]
<type 'int'> 1
>>> t['test']
<type 'str'> test
>>> t[t]
<class '__main__.TestGetitem'> <__main__.TestGetitem object at 0xb7e9bc4c> 
```

切片示例：

```
>>> t[1:2]
<type 'slice'> slice(1, 2, None)
>>> t[1:'this':t]
<type 'slice'> slice(1, 'this', <__main__.TestGetitem object at 0xb7e9bc4c>) 
```

省略号示例：

```
>>> t[...]
<type 'ellipsis'> Ellipsis 
```

带有省略号和切片的元组：

```
>>> t[...,1:]
<type 'tuple'> (Ellipsis, slice(1, None, None)) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-15T16:56:45.077

发生的事情是这样的。请参阅[http://docs.python.org/reference/datamodel.html#types](http://docs.python.org/reference/datamodel.html#types)和[http://docs.python.org/library/functions.html#slice](http://docs.python.org/library/functions.html#slice)

> 当使用扩展切片语法时，切片对象用于表示切片。这是一个使用两个冒号的切片，或多个用逗号分隔的切片或省略号，例如 a[i:j:step]、a[i:j, k:l] 或 a[..., i:j] . 它们也是由内置的 slice() 函数创建的。
> 
> 特殊只读属性：start为下界；stop 是上限；step 是步长值；如果省略，每个都是 None 。这些属性可以是任何类型。

```
x=[1,2,3,4]
x[0:2] 
```

"0:2" 被转换为一个`Slice`以 0 开始，以 2 为结束，以 None 为步进的对象。

该`Slice`对象提供给您定义的类`x`的`__getitem__`方法。

```
>>> class MyClass( object ):
    def __getitem__( self, key ):
        print type(key), key

>>> x=MyClass()
>>> x[0:2]
<type 'slice'> slice(0, 2, None) 
```

但是，对于内置列表类，`__getslice__`必须重写一个特殊方法。

```
class MyList( list ):
    def __getslice__( self, i, j=None, k=None ):
        # decode various parts of the slice values 
```

省略号是提供给多维切片的特殊“忽略此维度”语法。

另请参阅[http://docs.python.org/library/itertools.html#itertools.islice](http://docs.python.org/library/itertools.html#itertools.islice)了解更多信息。

# visual-studio-2008 - 调试 WCF 异常导致 CommunicationException

> ID：752633
> 
> 赞同：1
> 
> 时间：2009-04-15T16:45:59.330
> 
> 标签：visual-studio-2008, wcf, debugging

我在我们的 WCF 服务中介绍了 FaultException 的使用。

为了测试这一点，我在服务器上创建了以下函数：

```
public void ThrowException()
    {
        try
        {
            throw new ApplicationException("This is a test exception");
        }
        catch (ApplicationException ex)
        {
            throw new FaultException<ApplicationException>(ex, "Test reason");

        }
    } 
```

向前跳过一步。如果我运行它，它工作正常。

但是，如果我使用调试器 (VS2008)，并允许代码在 catch 块中中断（通过启用异常中断或单步执行），我的客户端会生成一个 CommunicationException。

调查这个我发现了这个论坛帖子： [http ://social.msdn.microsoft.com/forums/en-US/wcf/thread/d1ae669f-9a62-4628-86c1-c15ff4068843/](http://social.msdn.microsoft.com/forums/en-US/wcf/thread/d1ae669f-9a62-4628-86c1-c15ff4068843/)

问题：为什么我看到这种行为，只有在调试时（我假设其他人没有）？以及如何避免这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T09:16:07.747

我不会将此称为修复/解决方案，但我有一个非常适合我的情况的解决方法。

正如我所说，我刚刚开始 WCF 异常处理，并且我意识到[IErrorHandler](http://www.neovolve.com/post/2008/04/07/implementing-ierrorhandler.aspx "错误处理程序")是一种更好的方法来处理我的异常，而不是方法级别的 try/catch。

当调试器跳过 ProvideFault 的实现时，调试器不会查看异常，因此不会导致 CommunicationException。

这目前有效，但我仍然想要一个真正的解决方案，因为可能存在我想提供特定异常的情况，这些异常将通过 ProvideFault 原封不动地传递。

# ruby-on-rails - 测试 Rails REST XML API 的最佳方法？

> ID：752636
> 
> 赞同：12
> 
> 时间：2009-04-15T16:46:17.643
> 
> 标签：ruby-on-rails, xml, testing, rest

我想在我的 Rails 站点上测试 REST api。使用 rails 测试框架最简单/最好的方法是什么？我只是在做标准的足智多谋的东西，所以我特别想知道，因为这是如此糟糕的标准，是否有任何自动的方法来测试这些东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-03-09T21:42:57.207

我为此推出了自己的解决方案，并认为它会有所帮助。我编写了一个模块，它使用[json](http://flori.github.com/json/doc/index.html)、[cream](http://curb.rubyforge.org/)和[可寻址](https://github.com/sporkmonger/addressable/tree/)gem 向 localhost:3000 发送 GET、PUT、POST 和 DELETE 请求。它可以请求 XML（如原始问题所要求的）或 json。它将响应正文作为哈希返回。它主要是对遏制 gem 的包装，我认为它具有可怕的语法。

请注意，我会自动加载我的`api_key`. 这可以通过传递`:api_key => false`或破坏使用来禁用`api_key => "wrong"`。您可能希望将其省略或修改以适合您的身份验证方案。

这是模块：

```
module ApiTesting
  # requres the json, curb, and addressable gems

  require "addressable/uri"

  def api_call(path, verb, query_hash={}, options={})
    options.reverse_merge! :api_key => "abc1234", :format => "xml"
    query_hash.reverse_merge!({:api_key => options["api_key"]}) if options[:api_key]
    query = to_query_string(query_hash)
    full_path = "http://localhost:3000/#{path}.#{options[:format]}?#{query}"
    response = case verb
      when :get
        Curl::Easy.perform(full_path)
      when :post
        Curl::Easy.http_post("http://localhost:3000/#{path}.#{options[:format]}", query)
      when :put
        Curl::Easy.http_put(full_path, nil)
      when :delete
        Curl::Easy.http_delete(full_path)
    end
    case options[:format]
      when "xml"
        Hash.from_xml(response.body_str)
      when "json"
        JSON.parse(response.body_str)
    end
  end

  private

  def to_query_string(val)
    uri = Addressable::URI.new
    uri.query_values = val
    uri.query
  end

end
```

以下是一些简单的示例： 使用 GET 请求资源属性：

```
 api_call("calls/41", :get)
```

使用 POST 创建资源：

```
 api_call("people", :post, {:person => {:first => "Robert", :last => "Smith" } })
```

使用 PUT 更新资源：

```
 api_call("people/21", :put, {:person => { :first => "Bob" } })
```

使用 DELETE 删除资源：

```
 api_call("calls/41", :delete)
```

关闭 api_key 的自动插入：

```
 api_call("calls/41", :get, {}, {:api_key => false})
```

使用错误的 api_key：

```
 api_call("calls/41", :get, {}, {:api_key => "wrong"})
```

用作 json（默认为 xml）：

```
 api_call("calls/41", :get, {}, {:format => "json"})
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-07T08:40:12.960

我会推荐使用黄瓜。Cucumber 模拟浏览器，您可以验证它得到的结果。这适用于 XML 请求以及 JSON 和普通的旧 HTML。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-12T21:09:11.997

这不是自动化的，但它非常适合查看您的 API 正在做什么。

[http://hurl.r09.railsrumble.com/](http://hurl.r09.railsrumble.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-16T09:49:43.493

我们使用 RESTClient 一个 Firefox 插件来访问和测试 REST 服务。

[https://addons.mozilla.org/en-US/firefox/addon/9780](https://addons.mozilla.org/en-US/firefox/addon/9780)

我们已经在我的团队中使用它几个月了，我认为没有它我们就无法完成我们的工作。它非常容易启动和运行并且使用友好。

如果您从 Sourceforge 获得最新版本，甚至还有 Oauth 支持，这是我在任何其他 REST 客户端中找不到的。

[http://sourceforge.net/projects/restclient/develop](http://sourceforge.net/projects/restclient/develop)

使用 Firefox 插件的众多优势之一是它是跨平台的。即使我们使用不同的操作系统（Mac、Linux、Windows），我们也会为团队的所有成员使用相同的工具（RESTclient）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-21T13:56:40.170

你可以试试`curl`

用于`--form-string`将表单数据传递给服务器

(1)

```
curl --form-string "book_key=BOOK1234" --form-string "author=Gandhi"  -X PUT 'http://localhost:3000/api/show_all_books_of_a_particular_author?params1=value1&param2=value2' 
```

在控制器中，您将获得`params['book_key']=BOOK1234`和`params["author"]="Gandhi"`

采用`-F "document=@test.doc;type=application/msword;"`

(2)

```
curl -F "document=@my_experiments_with_truth.pdf;type=application/pdf;" --form-string "author=Gandhi" --form-string "email=joe@mymail.com"  -X PUT 'http://localhost:3000/api/submit_a_pdf_book?params1=value1&param2=value2' 
```

在控制器中，您将获得`params['email]="joe@mymail.com"`and`params["author"]="Gandhi"`和`params["document"] = "File(object)"`。这仅`test.doc`在当前目录中有效。不要忘记传递`mime-type`，因为服务器可能会接受它，`"application octet-stream"`并且需要编写代码来单独处理它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-12T07:56:13.710

如果您正在考虑测试您手动创建的 API - 您可能想试试这个！似乎运作良好！

**[REST 客户端 - 简单地测试 REST API](http://www.bitlasoft.com/tools/rest_client/)**

你不能用这个来做自动化测试！

# c# - 在客户端操作树

> ID：752639
> 
> 赞同：1
> 
> 时间：2009-04-15T16:46:32.103
> 
> 标签：c#, asp.net, javascript, tree

我将有一个显示树视图的页面。用户可以添加和删除节点：当用户单击节点时，会弹出一个表单，用户将在其中输入数据，然后将这些数据保存到数据库中，然后弹出脚本带有 id（来自数据库）。此 id 需要传递给父页面，并且树需要在 CLIENT 上更新。

当用户完成修改树时，他们将单击保存按钮，树将保存在数据库中。

我正在使用 asp.net 网络表单，c#。

我应该如何去实现这些目标？在我看来，我不需要使用 ajax，因为树修改是在客户端完成的。诀窍是让弹出窗口返回一个 id（来自服务器到父页面）。我应该使用来自 jQuery 的 TreeView 控件还是简单的树插件？（请记住，我需要将父页面提交到服务器并将树中的数据保存到数据库中）。

在我看来，我唯一的选择是 jQuery 树。但是我们可以在提交时访问 aspx 页面吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T20:36:50.600

伙计，我不知道为什么 Ajax 不能帮助你，但在那种情况下是 jQuery，然后获取你想要的控件的内部 html，然后执行 foreach 获取 Tree 节点并将它们保存在集合中，然后将它们提交给 DB通过一些网络服务方法，您可以实现您想要的。

但是再次使用 AJAX，我认为它更简单，你不会丢失任何东西。

很抱歉没有提供样品。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T16:50:39.943

如果您在子窗口中将数据保存到数据库中，只需让它在父窗口关闭时回发，这将强制树从数据库中重新加载，显示新插入的数据。

# c# - 在 .NET 中获取当前总 CPU 负载的最简单方法是什么？

> ID：752643
> 
> 赞同：0
> 
> 时间：2009-04-15T16:47:25.957
> 
> 标签：c#, .net, windows

我找到了这个答案，但它远不是我可以在现有应用程序中使用的简单代码片段。

[控制 CPU 利用率](https://stackoverflow.com/questions/261089/controlling-cpu-utilization)

现在必须有更好的方法来使用 .NET 3.5 做到这一点。有没有办法轮询所有线程的总 CPU 负载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T17:14:20.430

性能计数器几乎就是它。性能计数器可用于获取从 CPU 到网络流量的所有诊断数据。

如果您转到开始 -> 控制面板 -> 管理工具 -> 性能，可以看到 C# 中的许多计数器正在运行。它甚至可以制作漂亮的图表。:)

# iis - 关闭特定浏览器的 IIS 6 HttpCompression

> ID：752645
> 
> 赞同：2
> 
> 时间：2009-04-15T16:47:48.310
> 
> 标签：iis, browser, iis-6, silverlight-2.0, http-compression

我遇到了 IE6（惊喜）和使用 IIS6 的 HTTP 压缩的问题。我真的不想关闭该站点的 HTTP 压缩。有没有办法告诉 IIS6 不压缩对特定浏览器版本的响应？IE7 工作正常。

编辑：我的问题实际上来自使用 WCF 服务的 Silverlight 2。启用压缩后，IE6 上的 Silverlight 2 似乎无法正常工作。这是silverlight.net 上讨论的[链接。](http://silverlight.net/themes/silverlight/forums/thread.aspx?ThreadID=42908&AspxAutoDetectCookieSupport=1)

谢谢迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T21:59:37.453

不是内置的，我知道，但你通常不想这样做。如果这样做，则必须将“Vary”响应标头设置为包含“User-Agent”，这会降低代理缓存的功效，并且会混淆 IE 自己的本地缓存。

我向 IE6 提供压缩内容没有任何问题（诚然来自 Apache，但我不认为 IIS 的实现有很大不同）。您看到的实际问题是什么？

我记得最后一个遇到 gzip/deflate 问题的浏览器（但仍然通过 Accept 标头表示它需要它）是 Netscape 4，它在看到压缩样式表时会弄脏自己。但值得庆幸的是，这个浏览器不再为任何人所关注。

# dynamic-data - 动态数据 Web 应用程序：如何更改默认过滤器以使其显示超过 10 行？

> ID：752651
> 
> 赞同：5
> 
> 时间：2009-04-15T16:48:36.063
> 
> 标签：dynamic-data, asp.net-3.5

## **动态数据网络应用**

**如何更改默认过滤器以使其显示超过 10 行？**

我最近创建了一个动态数据网站来帮助管理我的商业智能数据仓库的几十个查找表，但我在操作模板时遇到了麻烦。我想让详细信息页面中显示的默认行数超过 10 行。尽管我找到了允许我更改过滤器下拉列表的数据网格部分，但我似乎仍然找不到强制数据网格仅显示 10 行的代码。如何更改动态数据网站标准模板中数据网格显示的默认行数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T07:45:48.350

如果您打开 ~/DynamicData/Content 文件夹，您将找到寻呼机，请参见**GridViewPager.ascx** 您可以对其进行编辑，因为这是所有网格视图上使用的寻呼机，在代码隐藏中，您将在顶部看到此字段

您可以更改页面中每页的行数，也可以在后面的代码中设置默认值。

```
protected void Page_Load(object sender, EventArgs e)
{
    Control c = Parent;
    while (c != null)
    {
        if (c is GridView)
        {
            _gridView = (GridView)c;
            break;
        }
        c = c.Parent;
    }
    ***_gridView.PageSize = 20;***
} 
```

在 BOLD ITALIC 中添加行以设置初始页面大小并在列表框中更改页面大小值编辑页面自身：

```
<asp:DropDownList ID="DropDownListPageSize" runat="server" 
    AutoPostBack="true" 
    CssClass="droplist" 
    onselectedindexchanged="DropDownListPageSize_SelectedIndexChanged">
    <asp:ListItem Value="5" />
    <asp:ListItem Value="10" />
    <asp:ListItem Value="15" />
    <asp:ListItem Value="20" />
</asp:DropDownList> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T17:52:21.883

它在 gridview 控件中 (~\DynamicData\PageTemplates\List.aspx)

```
<asp:Gridview PageSize="20" runat="server" ID="GridView"> 
```

我不记得默认情况下它是否带有任何 PageSize 属性，但如果没有，您可以添加它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-30T05:06:46.137

Wizzard的帖子为我做到了！

**我补充说：**

```
if (!IsPostBack)
        {
            _gridView.PageSize = 100;
        } 
```

所以选择器仍然可以工作。

# sql - 在 MS SQL 中舍入 0.05 或 0.00

> ID：752655
> 
> 赞同：0
> 
> 时间：2009-04-15T16:49:11.117
> 
> 标签：sql, sql-server, tsql, user-defined-functions

您好，我来自波斯尼亚和黑塞哥维那，在我们县，最小的钞票是 0.05，现在政府推动我们将重试价格四舍五入为 0.05 或 0.00。因此，我想创建 SQL Scalar Valued Function 来四舍五入给定值的价格。是否有一些内置解决方案，以便我可以节省查询资源。谢谢你的建议最好的问候

从评论编辑：

*   0,1,2,3,4 归零
*   5,6,7,8,9 归零+1

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T16:54:27.217

没有内置任何东西 - 但它很容易创建：

编辑：适应您的特殊舍入需求:-)

```
create function dbo.RoundToFiveOrZero(@inputValue MONEY)
returns MONEY
as begin
  return FLOOR((@inputValue + 0.05) * 20.0) / 20.0
end 
```

使用 DECIMAL 或 MONEY 数据类型 - 最适合您的。

像这样使用它：

```
select 
    dbo.RoundToFiveOrZero(1.51),
    dbo.RoundToFiveOrZero(1.53),
    dbo.RoundToFiveOrZero(7.33),
    dbo.RoundToFiveOrZero(7.37),
    dbo.RoundToFiveOrZero(7.39) 
```

结果是 1.50、1.50、7.30、7.40、7.40。

马克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T16:55:29.727

感谢 marc_s，我更改为 money 数据类型。

[float vs decimal vs money 数据类型文章和流程图](http://sqlcat.com/technicalnotes/archive/2008/09/25/the-many-benefits-of-money-data-type.aspx)

```
ALTER FUNCTION dbo.ufnRound (@number money)
RETURNS money
AS
BEGIN
    RETURN FLOOR(@number*20) / 20
END
GO
SELECT dbo.ufnRound (1.22), dbo.ufnRound (1.23), dbo.ufnRound (1.27), dbo.ufnRound (1.28)

-- gives    1.2    1.2   1.25   1.25 
```

# java - java使用不同的JDK版本构建：相同的工件？

> ID：752657
> 
> 赞同：1
> 
> 时间：2009-04-15T16:49:28.667
> 
> 标签：java

这是我的场景：

*   工作站 A：Sun JDK 1.6
*   工作站 B：Sun JDK 1.5

我使用 Ant 1.7 在 A 和 B 上构建

```
<javac srcdir="${foo}" destdir="${bar}" source="1.5" target="1.5">
  <include name="**/*.java"/>
  <exclude name="**/test/**/*.java"/>
</javac> 
```

然而**.class**文件在 A 和 B 上的大小不同，更不用说 CRC。应该是这样吗？还是我错过了一些明显的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T16:53:27.063

是的，应该是这样的。即使针对同一个 VM，不同的编译器也可能发出不同的字节码。只要生成的程序运行正确，JLS 就不会准确规定如何将源代码编译为字节码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T16:53:27.423

虽然您可以显式设置`source="1.5"`and `target="1.5"`，但这并**不能控制**您正在运行的 javac 编译器的 JDK 版本。

`JAVA_HOME`因此，在/指向 JDK 1.6的工作站上`PATH`，您拥有基于 1.6 javac 构建的类文件，该类文件应该与 1.5 JRE 兼容。

但是，`source="1.5"`and`target="1.5"`仅指定语法/语言功能的兼容性；`source="1.5"`如果您依赖某些仅在 1.6 JRE 中可用的类，那么在使用`target="1.5"`1.6 javac时，您不会在此处收到任何编译器警告。

要解决最后一点，您需要告诉`<javac>`Ant 任务使用不同的`bootclasspath`.

# c++ - 返回 C++ 引用变量的做法是邪恶的吗？

> ID：752658
> 
> 赞同：380
> 
> 时间：2009-04-15T16:49:49.757
> 
> 标签：c++, reference, c++-faq

我认为这有点主观；我不确定意见是否一致（我已经看到很多返回引用的代码片段）。

根据[我刚刚问过的对这个问题的评论，关于初始化引用](https://stackoverflow.com/questions/752479/am-i-initializing-my-c-reference-variables-correctly)，返回引用可能是邪恶的，因为[据我了解]它更容易错过删除它，这可能导致内存泄漏。

这让我很担心，因为我已经遵循了一些例子（除非我在想象事情）并且在很多地方都这样做了......我误解了吗？是邪恶的吗？如果是这样，到底有多邪恶？

我觉得由于我的指针和引用混杂在一起，再加上我是 C++ 新手，以及对何时使用什么的完全困惑，我的应用程序一定是内存泄漏地狱......

此外，我了解使用智能/共享指针通常被认为是避免内存泄漏的最佳方法。

* * *

## 回答 #1

> 赞同：460
> 
> 时间：2009-04-15T16:58:31.873

一般来说，返回一个引用是完全正常的，并且一直在发生。

如果你的意思是：

```
int& getInt() {
    int i;
    return i;  // DON'T DO THIS.
} 
```

那是各种邪恶。分配的堆栈`i`将消失，您什么都没有提及。这也是邪恶的：

```
int& getInt() {
    int* i = new int;
    return *i;  // DON'T DO THIS.
} 
```

因为现在客户最终不得不做奇怪的事情：

```
int& myInt = getInt(); // note the &, we cannot lose this reference!
delete &myInt;         // must delete...totally weird and  evil

int oops = getInt(); 
delete &oops; // undefined behavior, we're wrongly deleting a copy, not the original 
```

请注意，右值引用仍然只是引用，因此所有邪恶的应用程序都保持不变。

如果要分配超出函数范围的内容，请使用智能指针（或通常是容器）：

```
std::unique_ptr<int> getInt() {
    return std::make_unique<int>(0);
} 
```

现在客户端存储了一个智能指针：

```
std::unique_ptr<int> x = getInt(); 
```

引用也可以访问您知道生命周期在更高级别上保持开放的事物，例如：

```
struct immutableint {
    immutableint(int i) : i_(i) {}

    const int& get() const { return i_; }
private:
    int i_;
}; 
```

在这里，我们知道返回引用是可以的，`i_`因为调用我们的任何东西都管理着类实例的生命周期，所以`i_`至少会活那么久。

当然，只要：

```
int getInt() {
   return 0;
} 
```

如果生命周期应该由调用者决定，而您只是在计算值。

摘要：如果对象的生命周期在调用后不会结束，则可以返回引用。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-04-15T16:52:34.180

不，不，不，一千次不。

邪恶的是引用动态分配的对象并丢失原始指针。当你`new`一个对象你承担了一个有保证的义务`delete`。

但是看看，例如`operator<<`：*必须*返回一个引用，或者

```
cout << "foo" << "bar" << "bletch" << endl ; 
```

不会工作。

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2009-04-15T19:39:29.100

您应该返回对不会立即消失的现有对象的引用，并且您不打算在其中进行任何所有权转让。

永远不要返回对局部变量或类似变量的引用，因为它不会被引用。

您可以返回对独立于函数的引用，您不希望调用函数负责删除。这是典型`operator[]`功能的情况。

如果您正在创建某些东西，您应该返回一个值或一个指针（常规或智能）。您可以自由地返回一个值，因为它会进入调用函数中的变量或表达式。永远不要返回指向局部变量的指针，因为它会消失。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2016-04-22T12:53:55.000

我发现答案不令人满意，所以我会加两分钱。

让我们分析以下案例：

# 错误使用

```
int& getInt()
{
    int x = 4;
    return x;
} 
```

这显然是错误

```
int& x = getInt(); // will refer to garbage 
```

# 与静态变量一起使用

```
int& getInt()
{
   static int x = 4;
   return x;
} 
```

这是正确的，因为静态变量在程序的整个生命周期中都存在。

```
int& x = getInt(); // valid reference, x = 4 
```

这在实现单例模式时也很常见

```
class Singleton
{
    public:
        static Singleton& instance()
        {
            static Singleton instance;
            return instance;
        };

        void printHello()
        {
             printf("Hello");
        };

}; 
```

用法：

```
 Singleton& my_sing = Singleton::instance(); // Valid Singleton instance
 my_sing.printHello();  // "Hello" 
```

# 运营商

标准库容器严重依赖于返回引用的运算符的使用，例如

```
T & operator*(); 
```

可用于以下

```
std::vector<int> x = {1, 2, 3}; // create vector with 3 elements
std::vector<int>::iterator iter = x.begin(); // iterator points to first element (1)
*iter = 2; // modify first element, x = {2, 2, 3} now 
```

# 快速访问内部数据

有时 & 可用于快速访问内部数据

```
Class Container
{
    private:
        std::vector<int> m_data;

    public:
        std::vector<int>& data()
        {
             return m_data;
        }
} 
```

用法：

```
Container cont;
cont.data().push_back(1); // appends element to std::vector<int>
cont.data()[0] // 1 
```

但是，这可能会导致以下陷阱：

```
Container* cont = new Container;
std::vector<int>& cont_data = cont->data();
cont_data.push_back(1);
delete cont; // This is bad, because we still have a dangling reference to its internal data!
cont_data[0]; // dangling reference! 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-04-15T16:51:23.153

这不是邪恶的。就像 C++ 中的许多东西一样，如果正确使用它是很好的，但是在使用它时应该注意许多陷阱（比如返回对局部变量的引用）。

用它可以实现很多好处（比如 map[name] = "hello world"）

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-04-15T19:28:54.150

> “返回参考是邪恶的，因为 [据我所知] 很容易错过删除它”

不对。返回引用并不意味着所有权语义。也就是说，仅仅因为你这样做：

```
Value& v = thing->getTheValue(); 
```

...并不意味着您现在拥有 v 所指的内存；

然而，这是一个可怕的代码：

```
int& getTheValue()
{
   return *new int;
} 
```

如果您正在做这样的事情是因为[“您不需要该实例上的指针”，](https://stackoverflow.com/questions/752479/am-i-initializing-my-c-reference-variables-correctly)那么：1）如果您需要引用，只需取消引用指针，2）您最终将需要指针，因为您必须匹配new 带有一个删除，你需要一个指针来调用删除。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-15T16:59:00.030

有两种情况：

*   const reference——好主意，有时，特别是对于重对象或代理类，编译器优化

*   非常量引用——坏主意，有时会破坏封装

两者都有相同的问题——可能指向被破坏的对象......

我建议在许多需要返回引用/指针的情况下使用智能指针。

另外，请注意以下事项：

*有一条正式规则 - C++ 标准（如果您有兴趣，第 13.3.3.1.4 节）规定临时只能绑定到 const 引用 - 如果您尝试使用非 const 引用，编译器必须将其标记为一个错误。*

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-15T16:55:47.263

它不仅不邪恶，而且有时是必不可少的。例如，如果不使用引用返回值，就不可能实现 std::vector 的 [] 运算符。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-07-21T22:35:32.850

**除了接受的答案：**

> ```
> struct immutableint {
>     immutableint(int i) : i_(i) {}
> 
>     const int& get() const { return i_; }
> private:
>     int i_;
> }; 
> ```

我认为这个例子**不好**，如果可能的话应该避免。为什么？很容易得到一个**悬空的引用**。

用一个例子来说明这一点：

```
struct Foo
{
    Foo(int i = 42) : boo_(i) {}
    immutableint boo()
    {
        return boo_;
    }  
private:
    immutableint boo_;
}; 
```

进入危险区：

```
Foo foo;
const int& dangling = foo.boo().get(); // dangling reference! 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-11-20T18:55:47.467

返回引用通常用于C++中大对象的运算符重载，因为返回值需要复制操作。（在运算符重载中，我们通常不使用指针作为返回值）

但是返回引用可能会导致内存分配问题。因为对结果的引用会作为对返回值的引用传出函数，所以返回值不能是自动变量。

如果你想使用返回引用，你可以使用静态对象的缓冲区。例如

```
const max_tmp=5; 
Obj& get_tmp()
{
 static int buf=0;
 static Obj Buf[max_tmp];
  if(buf==max_tmp) buf=0;
  return Buf[buf++];
}
Obj& operator+(const Obj& o1, const Obj& o1)
{
 Obj& res=get_tmp();
 // +operation
  return res;
 } 
```

这样，您可以安全地使用返回引用。

但是你总是可以在函数中使用指针而不是引用来返回值。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-29T02:35:35.503

我认为使用引用作为函数的返回值比使用指针作为函数的返回值更直接。其次，使用返回值所引用的静态变量总是安全的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-10-05T07:51:37.167

最好的办法是创建对象并将其作为引用/指针参数传递给分配此变量的函数。

在函数中分配对象并将其作为引用或指针返回（但指针更安全）是个坏主意，因为在函数块末尾释放内存。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2017-03-14T01:46:56.917

```
 Class Set {
    int *ptr;
    int size;

    public: 
    Set(){
     size =0;
         }

     Set(int size) {
      this->size = size;
      ptr = new int [size];
     }

    int& getPtr(int i) {
     return ptr[i];  // bad practice 
     }
  }; 
```

getPtr 函数可以在删除甚至是空对象后访问动态内存。这可能导致错误的访问异常。相反，应该在返回之前实现 getter 和 setter 并验证大小。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-04-15T19:52:47.680

应该从 C++ 中删除作为左值的函数（又名，返回非常量引用）。这非常不直观。Scott Meyers 想要一个具有这种行为的 min() 。

```
min(a,b) = 0;  // What??? 
```

这并不是真正的改进

```
setmin (a, b, 0); 
```

后者甚至更有意义。

我意识到作为左值的函数对于 C++ 风格的流很重要，但值得指出的是，C++ 风格的流很糟糕。我不是唯一一个这样想的人......我记得 Alexandrescu 有一篇关于如何做得更好的大文章，我相信 boost 也试图创建一种更好的类型安全 I/O 方法。

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2009-04-15T20:53:40.483

我遇到了一个真正的问题，它确实是邪恶的。本质上，开发人员返回了对向量中对象的引用。那太糟糕了！！！

我在一月写的全部细节：http: [//developer-resource.blogspot.com/2009/01/pros-and-cons-of-reuring-references.html](http://developer-resource.blogspot.com/2009/01/pros-and-cons-of-returing-references.html)

* * *

## 回答 #16

> 赞同：-16
> 
> 时间：2013-07-23T05:59:38.793

关于可怕的代码：

```
int& getTheValue()
{
   return *new int;
} 
```

所以，确实，内存指针在返回后丢失了。但是如果你像这样使用 shared_ptr ：

```
int& getTheValue()
{
   std::shared_ptr<int> p(new int);
   return *p->get();
} 
```

返回后内存不会丢失，分配后将被释放。

# sql - 如何在不使用联接的情况下重写查询

> ID：752673
> 
> 赞同：2
> 
> 时间：2009-04-15T16:52:52.743
> 
> 标签：sql, inner-join

我想知道如果没有使用连接，这个查询将如何编写。我一直试图找出连接不可行或无法使用（不可用）的情况。

```
SELECT
    *
FROM
(
    table1
INNER JOIN
    table2
ON
    table1.id = table2.id
)
INNER JOIN
    table3
ON
(
    table1.id2 = table3.id2
)
AND
(
    table1.id3 = table3.id3
)
WHERE
    table1.id = 1 
```

我不能使用连接的原因是应用程序使用 HQL 而不是标准 SQL，并且 HQL 使得连接非常难以执行。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-15T16:55:07.560

如果不以一种或另一种方式连接它们，就不可能从两个不同的表中提取数据。您正在使用 JOIN 语句，但您可以通过将其放在 where 子句中来实现相同的目的，例如：

```
SELECT * FROM table1, table2 WHERE table1.id = table2.id AND ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T16:55:23.643

您可以在应用程序中进行选择并进行连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T18:00:55.937

如果连接不受限制，请远离 SQL 数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T17:01:50.930

如果只选择 1 个值，通常子查询可能比连接更容易

```
SELECT e.Name, e.HireDate, (select SUM(CheckAmount) from EmployeeCheck where EmployeeID = e.ID) 
FROM Employee e 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T17:02:26.513

不是纯粹主义者，但关系数据库和数据规范化的核心概念是联接。如果没有这个，几乎没有理由使用关系数据库来存储数据。索引可以快速有效地实现这一点。

旧方法是使用主表和事务表。回到黑暗时代。

但是，您可以使用游标来执行连接将执行的过滤。游标的作用类似于针对表的数组，而不是执行基于连接的过滤器，并且会得到相同的结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T17:03:04.217

如果需要，您可以使用相关子查询来执行此操作，但连接更好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T18:23:38.313

如果您的休眠映射文件中有关联映射，休眠不会阻止您进行连接。参见，例如：[http ://www.jumpingbean.co.za/blogs/mark/hibernate_hql_inner_join_on_clause](http://www.jumpingbean.co.za/blogs/mark/hibernate_hql_inner_join_on_clause)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-04-15T17:00:13.133

没有连接的 SQL...

```
SELECT * FROM table1
SELECT * FROM table2
SELECT * FROM table3 
```

但这对你没有帮助。

问题是，你想要的输出是什么，你有什么理由不想加入？

如果您想要来自关系数据库中多个表的数据，那么您将加入数据。正如 James Black 建议的那样，也许这是您需要在应用程序中执行的操作。

如果您可以进一步了解情况，我们可能会提供进一步的帮助。

# sharepoint - 更改文档库 Web 部件的“拒绝访问...”文本字符串

> ID：752676
> 
> 赞同：1
> 
> 时间：2009-04-15T16:53:04.133
> 
> 标签：sharepoint, web-parts

我有一个 MOSS 发布站点和一个拥有自己独特权限的文档库。

在站点主页 (default.aspx) 上，我有一个显示文档列表的文档库 Web 部件。如果用户无权查看文档，则 Web 部件当前显示消息

“拒绝访问。您无权执行此操作或访问此资源。”

有没有办法将此消息更改为更友好的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T18:15:12.000

我不确定我是否会大惊小怪地编辑现有的 .aspx 文件并使用自定义错误消息来代替：

[http://blogs.msdn.com/ketaanhs/archive/2009/03/16/moss-sharepoint-2007-custom-error-page-and-access-denied-page.aspx](http://blogs.msdn.com/ketaanhs/archive/2009/03/16/moss-sharepoint-2007-custom-error-page-and-access-denied-page.aspx)

简短的版本是您使用自定义 httpmodule 并进行一些 web.config 更改以确保模块已加载并在错误时调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-04T09:41:47.850

如果继承不起作用，您还可以使用 jQuery 查找错误消息并将其替换为友好的内容。

[在这个问题](https://stackoverflow.com/questions/488194/deploy-jquery-using-a-sharepoint-feature-or-physical-files)中有关于在 SharePoint 中设置 jQuery 的信息。

# visual-studio-2008 - 您可以浮动 Visual Studio 2008 选项卡吗？

> ID：752692
> 
> 赞同：2
> 
> 时间：2009-04-15T16:56:33.047
> 
> 标签：visual-studio-2008

我无法弄清楚这一点，但我很好奇您是否可以浮动 VS 2008 文档选项卡。很多时候，我想在两个不同的屏幕上查看 2 个文档，可能是 aspx 文件和 cs 文件，但我不能将一个文件拖到另一个屏幕上，所以我只能来回切换。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T17:00:50.777

Visual Studio 2008 不支持浮动文档窗口，但 Visual Studio 2010~~支持~~。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T17:00:12.320

您可以创建水平和垂直选项卡组（从窗口菜单）。

或者，您可以放弃选项卡式文档方法并使用 MDI（工具->选项）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-26T10:03:16.207

我的方法是创建一个垂直选项卡式组，最大化 VS 窗口，然后调整其大小以填充两个屏幕，让我在任一屏幕上都可以看到一个文件。

# javascript - 在 Eclipse 中调试 IE6 JavaScript

> ID：752696
> 
> 赞同：0
> 
> 时间：2009-04-15T16:58:00.813
> 
> 标签：javascript, eclipse, debugging, internet-explorer-6

我正在寻找一个 Eclipse 插件，它可以让我调试在 IE6 中运行的 JavaScript。理想情况下，我希望能够将调试器附加到正在运行的 IE6 实例，但如果我必须从 Eclipse 中启动 IE6，我可以接受。

谢谢，唐

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T17:05:19.890

我认为[Apanta](http://www.aptana.com/)做了一些[JS IE 调试](http://www.aptana.com/docs/index.php/Installing_the_IE_debugger)，但我认为你需要专业版...

最棒的是它[可以插入 Eclpise](http://www.aptana.com/docs/index.php/Plugging_Aptana_into_an_existing_Eclipse_configuration)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T17:07:26.500

为什么要在 Eclipse 中执行此操作？

您可以在 IE 中执行此操作，我没有尝试过，但它看起来很有用： http: [//www.debugbar.com/? langage=en](http://www.debugbar.com/?langage=en)

我用 VS2005 进行 IE6 调试（很痛苦）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T17:26:07.767

我发现[CompanionJS](http://www.my-debugbar.com/wiki/CompanionJS/HomePage)非常有效。它的 Javascript 控制台看起来很像 Firebug。

# red5 - 如何在服务器上将 mpeg 转换为 flv？

> ID：752701
> 
> 赞同：0
> 
> 时间：2009-04-15T16:58:43.853
> 
> 标签：red5

需要在我的 Red5 服务器上将视频转换为 flv。这方面的任何帮助都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T17:07:02.647

我在我的 Ubuntu 机器上使用 ffmpeg，效果很好。

svn checkout svn://svn.ffmpeg.org/ffmpeg/trunk ffmpeg

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-22T13:36:03.123

要创建静态文件，请使用 ffmpeg（在 Ubuntu 上也称为 avconv）：

```
ffmpeg -i /pathto/inputfile.xxx /pathto/outputfile.flv
```

其中“xxx”是输入文件的扩展名，例如 .avi、.mp4 等。

要使用 RED5 从输入流（例如来自捕获设备）创建实时输出流以进行实时广播，请在管道中使用 ffmpeg，如下所示：

```
输入流 > - | ffmpeg -f xxx -i -f flv rtmp://your.red5.server:1935/live/mybroadcast

```

其中 xxx 是您对输入流的视频格式的最佳猜测。根据格式，例如 'rawvideo' - 您可能需要一些额外的转换选项和/或单独处理音频流（第二个 -i 选项）。

要接收 RED5 广播，请将浏览器的 flash 播放器连接到与 ffmpeg 的输出相同的路径，这与 RED5 流的输入相同，与 RED5 流的输出相同（是的，rtmp 非常那样有效）：

```
rtmp://your.red5.server:1935/live/mybroadcast
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-04T15:44:26.800

我建议使用 Xuggler ( [http://www.xuggle.com](http://www.xuggle.com) ) 来完成这项工作，这是一个可以添加到 Red5 应用程序的示例方法：

```
 public void convert(String sourceFilePath, String destinationFilePath) {
        //assumes the following: sourceFilePath is input file and destinationFilePath is output file
        IMediaReader reader = ToolFactory.makeReader(sourceFilePath);
        IMediaWriter writer = ToolFactory.makeWriter(destinationFilePath, reader);
        writer.open();
        writer.setForceInterleave(true);
        IContainerFormat outFormat = IContainerFormat.make();
        outFormat.setOutputFormat("flv", destinationFilePath, null);
        IContainer container = writer.getContainer();
        container.open(args[1], IContainer.Type.WRITE, outFormat);
        writer.addVideoStream(0, 0, ICodec.findEncodingCodecByName("flv"), 320, 240);
        writer.addAudioStream(1, 0, ICodec.findEncodingCodecByName("libmp3lame"), 2, 44100);
        reader.addListener(writer);
        while (reader.readPacket() == null);
    } 
```

您提到“mpeg”，但此代码块将转换 FFMpeg 和 Xuggler 支持的任何媒体类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T17:07:03.553

[Dan Fernandez](http://blogs.msdn.com/danielfe/)在 Coding4Fun 上创建了一个项目，它使用 FFMPEG 将 flv 转换为 mpeg，反之亦然。

这是他创建的名为[InnerTube的项目](http://www.codeplex.com/InnerTube)

[这是一个站点的链接，该站点详细说明了FFMPEG](http://www.webologist.co.uk/2008/03/converting-mpg-to-flv-using-ffmpeg.html)的命令行参数。

# jquery - JQuery上的静态变量问题

> ID：752713
> 
> 赞同：0
> 
> 时间：2009-04-15T17:02:25.047
> 
> 标签：jquery, variables, global

```
if(i==0){
      $(document).ready(function(){
        $("div#rozet").hover(function(){
          $(this).hide("fast");
          $(this).animate(
                      { top:'+45px', left:'+500px'},
                      {duration: 1}
                      );        
         $(this).show("slow");           
         $(this).stopall();
        });
i=1;
}
if(i==1){
        $("div#rozet").hover(function(){
          $(this).hide("fast");
          $(this).animate(
                      { top:'-85px', left:'+500px'},
                      {duration: 1}
                      );        
         $(this).show("slow");           
         $(this).stopall();
        });
    });
i=0;
} 
```

对不起，我会一点英语。无论如何我要开始了：D

我想用队列来做这个功能。但我总是 0。我知道我正在这样做。那我该怎么办：D

我可以采用css的变量吗？(div#rozet).top 的变量，我可以在 if 上使用它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T19:14:39.660

我在哪里被声明和设置？

但是，你有你的 if (i == 0)

在 $(document).ready(function(){ 之前

这是一个问题。$(document).ready() 是一个事件处理程序，因此 $(document).ready() 中的代码被调用，尽管 i 等于。

您必须重新编写代码，以便

```
$(document).ready(function(){
  if (i == 0) {
    ...
  }
  if (i == 1) {
    ...
  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T19:36:41.587

您需要使用 else if。如果您正在调用运行这两个 if 的函数，如果 i == 0 则两者都将运行。您可以通过在每个函数中放置警报来检查它。当 i 为 0 时，第一个 if 语句为真并完成工作，并将 i 设置为 1，然后第二个 if 运行它现在也为真，因为最后一个 if 将 i 设置为 1。

```
i = 0;
jQuery("#subheader").click(function () {
  if (i == 0) {
    alert ("i was 0");
    i = 1;
  }
  else if (i == 1) {
    alert ("i was 1");
    i = 0;
  }
}); 
```

这是我使用 Firebug 创建的最终结果。如果你有[Firebug](http://getfirebug.com/)，你可以在这个页面的控制台中运行它。运行后，您可以单击包含答案数量和排序选项的行。我想这大致就是你要找的。

# ruby - 如何使用 define_method 创建类方法？

> ID：752717
> 
> 赞同：113
> 
> 时间：2009-04-15T17:03:04.857
> 
> 标签：ruby, metaprogramming, class-method

如果您尝试以元编程方式创建类方法，这很有用：

```
def self.create_methods(method_name)
    # To create instance methods:
    define_method method_name do
      ...
    end

    # To create class methods that refer to the args on create_methods:
    ???
end 
```

我要遵循的答案...

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2010-11-08T17:26:00.010

我认为在 Ruby 1.9 中你可以这样做：

```
class A
  define_singleton_method :loudly do |message|
    puts message.upcase
  end
end

A.loudly "my message"

# >> MY MESSAGE 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-04-15T17:21:10.757

我更喜欢使用 send 来调用 define_method，我也喜欢创建一个元类方法来访问元类：

```
class Object
  def metaclass
    class << self
      self
    end
  end
end

class MyClass
  # Defines MyClass.my_method
  self.metaclass.send(:define_method, :my_method) do
    ...
  end
end 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-08T13:39:00.877

这是 Ruby 1.8+ 中最简单的方法：

```
class A
  class << self
    def method_name
      ...
    end
  end
end 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-11-19T06:47:42.083

如果您想从关注点动态定义类方法，请在 Rails 中使用：

```
module Concerns::Testable
  extend ActiveSupport::Concern

  included do 
    singleton_class.instance_eval do
      define_method(:test) do
        puts 'test'
      end
    end
  end
end 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-15T17:06:55.317

源自：[Jay](http://blog.jayfields.com/2007/10/ruby-defining-class-methods.html)和[Why](http://whytheluckystiff.net/articles/seeingMetaclassesClearly.html)，他们也提供了使这个更漂亮的方法。

```
self.create_class_method(method_name)
  (class << self; self; end).instance_eval do
    define_method method_name do
      ...
    end
  end
end 
```

* * *

***更新***：来自以下 VR 的贡献；一种更简洁的方法（只要您只以这种方式定义一种方法），它仍然是独立的：

```
self.create_class_method(method_name)
  (class << self; self; end).send(:define_method, method_name) do
    ...
  end
end 
```

但请注意，使用 send() 访问像 define_method() 这样的私有方法不一定是个好主意（我的理解是它在 Ruby 1.9 中将消失）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-12-13T21:55:46.160

你也可以在不依赖define_method的情况下做这样的事情：

```
A.class_eval do
  def self.class_method_name(param)
    puts param
  end
end

A.class_method_name("hello") # outputs "hello" and returns nil 
```

# c# - C# - 帮助自定义 DatagridView 单元格选项

> ID：752723
> 
> 赞同：4
> 
> 时间：2009-04-15T17:03:28.787
> 
> 标签：c#, .net, winforms, datagridview

我正在尝试自定义 DataGridView 单元格以包含组合框和文本字段。到目前为止，myCell 类派生自 DataGridViewTextBoxCell 类。我的班级有一个 Combobox 作为私人成员，但我不确定如何呈现它。我正在覆盖 Pain 方法，但我不知道如何绘制组合框。我将其位置设置为单元格的原点，并将其大小设置为等于 cellBounds 大小。我知道，如果我在表单上创建一个组合框，我将不得不将它添加到我的表单控件列表中，以便它会被绘制，但在这种情况下，我真的不知道该怎么做。

注意：我没有使用任何类型的 sql db。

理想情况下，我会在单元格的上半部分显示一个组合框，在单元格的下半部分显示一个文本框，用户可以在运行时更改文本。

有谁知道实现这一目标的最佳方法？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T17:08:08.853

我会尝试从 IDataGridViewEditingControl 和一个自定义 UserControl 派生，它具有您的要求（TextBox 和 ComboBox）。
但是检查一下，如果 ComboBox 本身还不够。根据 DropDownStyle，您的用户已经可以更改 ComboBox 的内容。

# java - 在 maven 2 的命令行上设置插件的属性

> ID：752724
> 
> 赞同：32
> 
> 时间：2009-04-15T17:03:36.917
> 
> 标签：java, maven-2, command-line

在 maven 2.x 中，如何在命令行而不是在 pom 或 settings.xml 中该插件的 <configuration> 中设置插件的属性？

例如，如果我正在使用`mvn dependency:copy-dependencies`（[参见此处](http://maven.apache.org/plugins/maven-dependency-plugin/copy-dependencies-mojo.html)）如何设置 useRepositoryLayout 属性而不触及 pom 或我的 settings.xml？

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-15T17:09:00.240

在 copy-dependencies mojo docs（我什至链接到它）中，答案就在我面前。该属性的文档包括您可以引用它的表达式。

> useRepositoryLayout：将每个工件放置在与默认存储库相同的目录布局中。示例：/outputDirectory/junit/junit/3.8.1/junit-3.8.1.jar
> 
> ```
> * Type: boolean
> * Since: 2.0-alpha-2
> * Required: No
> * Expression: ${mdep.useRepositoryLayout}
> * Default: false 
> ```

要从命令行设置此属性，您需要运行

```
mvn -Dmdep.useRepositoryLayout=true <goals go here> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-10-05T19:53:55.310

将属性定义为任意属性……而不是标准的 Maven 道具，例如版本。在我的例子中，我定义了一个新的属性 build.version：

```
<properties> build.version=unknown </properties> 
```

我使用该属性：

```
<warName>${build.version}</warName> 
```

我定义属性：

```
mvn -P prod -Dbuild.version=app_name-branch_name-build_number package 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-15T19:06:15.887

通常，您使用与 java 系统属性相同的语法来设置 maven 属性。您是否尝试过以下行？

```
mvn -DuseRepositoryLayout=true dependency:copy-dependencies 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-22T19:28:20.217

这里的其他答案我不清楚。我是这样理解的：

如果插件代码使用系统属性作为其参数，那么您可以在命令行上定义该值。

您可以通过 3 种不同的方式在插件代码中完成此操作：

```
@parameter expression="${aSystemProperty}" 
@parameter default-value="${anExpression}"
@parameter property="aSystemProperty" 
```

如果在插件代码中为特定属性使用了这些方法的任何一种或组合，那么您可以在命令行上为插件参数指定一个值。上面的代码取自[这里的 Maven 文档](https://maven.apache.org/developers/mojo-api-specification.html)。

如果您使用带有上述代码的插件，则可以使用以下命令为您的属性指定一个值：

```
mvn -DaSystemProperty=my-value <goal-here> 
```

# javascript - 包括将 HTML 文档呈现到另一个 HTML 文档中

> ID：752726
> 
> 赞同：7
> 
> 时间：2009-04-15T17:03:48.070
> 
> 标签：javascript, jquery, html, css

我有一个字符串代表一个独立的（和有效的 XHTML 1.0 Strict）HTML 文档，类似于

```
var html = "<?xml ... <!DOCTYPE ... <html><head><style>...</style></head>
                  <body><table>...</table></body></html>"; 
```

该 HTML 文档的主体包含一个表格，其 CSS 样式在 HTML 文档的头部描述。

我还有另一个 HTML 文档的 DOM 树。如何将具有正确样式（如 HTML 字符串中所述）的表格的 DOM 树包含到此 DOM 树中？

我对基于 jQuery 的解决方案特别感兴趣。

**编辑**：更具体地说，我正在谈论的 HTML 字符串的示例嵌入到[这个 XML-document](http://attempto.ifi.uzh.ch/ws/ape/apews.perl?text=Every+man+is+a+human.&cdrshtml=on)中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-23T10:28:24.487

我可能错过了这一点，但为什么不将字符串加载到 IFRAME 中进行渲染 - 这解决了我拥有两个单独的 DOM 树和两组单独的 CSS 规则的所有问题。

此代码将执行此操作：

```
$(function() {
        var $frame = $('<iframe style="width:200px; height:100px; border: 0px;">');
        $('body').html( $frame );
        setTimeout( function() {
                var doc = $frame[0].contentWindow.document;
                var $body = $('body',doc);
                $body.html(your_html);
        }, 1 );
}); 
```

（我从这里提出：[将 html 放入 iframe（使用 javascript）](https://stackoverflow.com/questions/620881)）

然后，如果您担心 IFRAME 的大小，可以将其设置为：

```
$frame[0].style.height = $frame[0].contentWindow.document.body.offsetHeight + 'px';
$frame[0].style.width = $frame[0].contentWindow.document.body.offsetWidth + 'px'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T21:13:12.667

在同一页面上拥有两个完整的 DOM 树是没有意义的，因此您需要提取出您想要的内容并只使用它。

将字符串转换为 jQuery 对象并解析出您需要的内容，如下所示：

```
var html = "<html><head><style>...</style></head>
            <body><table>...</table></body></html>";

// Not sure if you are a trying to merge to DOMs together or just
// trying to place what you want on the page so, I'm going to go
// with the former as it may be more tricky.
var other_html = "<html><head><style>...</style></head>
                   <body><!-- some stuff --></body></html>";

var jq_html = $(html);
var jq_other_html = $(other_html);

var style = jq_html.find('head').find('style');
var table_and_stuff = jq_html.find('body').html();

jq_other_html.find('head').append(style).end().append(table_and_stuff); 
```

那应该就可以了。将 CSS 插入页面后，浏览器应该会自动识别它。

**注意：**
对于仅添加新样式而不覆盖当前样式的新 CSS 样式表，您必须将*表单*添加到 head 标签之前，而不是*附加*它。因此，最后一行需要改为：

```
jq_other_html.find('head').prepend(style).end().append(table_and_stuff); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T21:09:47.793

我宁愿做一个新的答案，而不是改进我的其他答案，因为我基本上需要重新编写它以适应你想要的方式，而旧的答案可能会因为其他原因帮助人们......

因此，在从您链接到的 XML 中提取 HTML 字符串后，您可以像这样继续使用它：

```
// First we'll extract out the parts of the HTML-string that we need.
var jq_html = $(html_from_xml);
var style = jq_html.find('head').find('style').html();
var style_string = style.toString();
var table_and_stuff = jq_html.find('body').html();

// If you want to place it into the existing page's DOM,
// we need to place it inside a new DIV with a known ID...
$('body').append('<div id="new_stuff"></div>');
$('#new_stuff').html(table_and_stuff);

// Now, we need to re-write the styles so that they only
// affect the content of the 'new_stuff' DIV:
styles_array = style_string.split('}');
var new_styles = '';
$.each(styles_array,function(i) { 
    if(i<(styles_array.length-1)) { 
        new_styles += "#new_stuff "+styles_array[i]+"}"; 
    }
})
$('head').append('<style type="text/css">'+new_styles+'</style>'); 
```

那真的应该这样做。诀窍是 CSS 将为案例选择最具体的样式。因此，如果您`<td>`在“newstuff” div 内部有一个，它将从新样式表中获取样式。如果您有一个`<td>`“新闻”div 之外的内容，它将采用旧样式。

我希望这能解决你的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T11:11:37.083

将其插入内联框架。

使用[我之前提出的问题](https://stackoverflow.com/questions/620881)，我有一个这样的解决方案：

首先，有一个 iframe，有一些 id

```
<iframe id="preview" src="/empty.html"></iframe> 
```

然后样式它：

```
iframe#preview
{
    margin: 30px 10px;
    width: 90%;
    height: 800px;
} 
```

这是一个将 html 文本插入该框架的函数（使用 jquery）

```
function preview( html )
{
    var doc = $("#preview")[0].contentWindow.document
    var body = $('body',doc)
    body.html( html );    
} 
```

我用它成功地呈现了 html 的内容，包括它可能包含的任何嵌入式 css。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T21:05:21.957

这是我的代码，可以按照您的描述进行操作。需要注意的两件事

1.  由于某种原因 find() 在我从 jquery 对象获得的“on-the-fly” dom 上不起作用，可能有人可以找出我在那里做错了什么
2.  出于说明目的，我已将此新 dom 附加到“body”元素。您可以轻松地将其附加到您的第二个 dom

* * *

```
 var insertStr = "your string here";

   var newDom = $(insertStr); // getting [meta style table.drs]

   // I had to use the array as newDom.find would not work for me which I was expecting would work
   var styleText = $(newDom[1]).text();
   var tableElm = $(newDom[2]);
   $(newDom[2]).appendTo('body');

   var selectors = styleText.split(/{[\s\w\.\(\)':;"#%=/-]*}/);

   var styles = styleText.match(/{[\s\w\.\(\)':;"#%=/-]*}/g);

   for ( var i =0; i < styles.length; i++ ) {
       var style = styles[i];

       style = style.replace("{","");

   style = style.replace("}","");

   if ( selectors[i].indexOf("table.drs") > -1 ) { // identify top-level elm
       // apply to self
       tableElm.attr('style',style);

   } else {

       // apply to its children
       tableElm.find(selectors[i]).attr('style',style);

   } 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T16:06:33.383

这是一些测试代码，演示了我将如何做到这一点。代码从传递的 HTML 中提取`<style>`元素并向所有选择器添加自定义 ID，然后将 HTML 注入`<div>`具有该 ID 的 a。这样，HTML 传递的所有 CSS 将仅适用于注入的表：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    var html = '<?xml version="1.0" encoding="UTF-8"?>\n\
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n\
    <html xmlns="http://www.w3.org/1999/xhtml">\n\
    <head>\n\
    <title></title>\n\
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>\n\
    <style type="text/css">\n\
    div.dom { background-color: #ace; margin-bottom: 0.5em } table.drs { font-family: monospace; padding: 0.4em 0.4em 0.4em 0.4em; border: 1px solid black; margin-bottom: 2em; background-color: #eee; border-collapse: collapse }\n\
    td { vertical-align: top; padding: 0.3em 0.3em 0.3em 0.3em; border: 1px solid black }\n\
    td.op { vertical-align: middle; font-size: 110%; border: none }\n\
    </style>\n\
    </head>\n\
    <body><table class="drs"><tr><td><div class="dom">[]</div></td></tr></table></body>\n\
    </html>';

    var style = html.match(/<style([^>]*)>([^<]*)<\/style>/);
    var modifiedStyle = style[2].replace(/\s*(} |^|\n)\s*([^{]+)/g, " $1 #inserthere $2");

    $(document).find('head').prepend("<style" + style[1] + ">" + modifiedStyle + "</style");
    $("#inserthere").append($(html).children());
    });
</script>
</head>
<body>
<div id="inserthere">
</div>
</body>
</html> 
```

显然，您必须根据自己的情况进行修改，但这是一个起点。

# user-interface - 有谁知道最常见错误消息的开源列表？

> ID：752727
> 
> 赞同：2
> 
> 时间：2009-04-15T17:03:56.307
> 
> 标签：user-interface, open-source

有谁知道最常见错误消息的开源列表？

我提出这个问题的动机，虽然我擅长编写代码，但英语不是我的母语。

而且，这样的列表（有点像网络上的所有免费图标）将缩短我开发的最后阶段，而且我认为好的（和有趣的）错误消息是好的 UI 的一部分。

还有一个动机，我可能会得到一些关于我应该检查和忘记的事情的想法。

常见场景：

*   没有授权
*   更多信息
*   缺少详细信息
*   不匹配的用户/通行证

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T17:38:29.750

根据我的经验，只有两种错误消息：特定于您正在开发的应用程序的错误消息，以及由您的应用程序所依赖的 API 生成的错误消息。

第一种类型你几乎总是需要自己写。第二种取决于您是否想向用户展示它。有些措辞很简单，您可以将其传递给用户，但在大多数情况下，API 生成的错误消息是针对开发人员的，只会让最终用户感到困惑。

例如，大多数操作系统都有“找不到文件”错误消息或类似信息。假设您尝试打开的文件是由用户选择的，那么将这个错误从操作系统直接传递给用户是有意义的。虽然“除以零”错误对用户没有帮助，除非您的应用程序执行用户直接输入的计算。在大多数情况下，此错误意味着编程错误。

对于应用程序特定的错误。错误消息仅在它发生的上下文中有用。这就是您找不到通用错误消息集合的原因。通用错误消息通常不会为用户提供足够的信息来知道如何响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T23:45:29.497

通用错误消息通常不是很有用，因为它们不会 1) 建议用户如何修复事物，2) 帮助开发人员修复错误。因此，如果您想编写好的错误消息，请决定是为用户还是为开发人员编写它们，并使其尽可能具体。

“糟糕，错误！[取消] [确定]”没有用。“file.c 第 33 行中的数据完整性测试失败。使用备份版本。请将此错误报告给开发人员”更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T00:29:17.317

我不知道任何与您要求的完全一样的东西；通用错误消息的存储库。如果您需要系统错误的错误消息，您应该查看`errno.h`; 这些错误中的每一个都有一个简短的描述（例如，检查[规范`errno.h`](http://www.opengroup.org/onlinepubs/000095399/basedefs/errno.h.html)，或者可能是[Linux 版本](http://www.gelato.unsw.edu.au/lxr/source/include/asm-generic/errno.h)）。

另一种选择是查看现有开源软件的翻译项目。例如，查看[Translation Product](http://translationproject.org/html/welcome.html)的[`.pot`文件](http://translationproject.org/POT-files/gphoto2-2.4.5.pot)或[Ubuntu 翻译项目](https://translations.launchpad.net/ubuntu)；这将为您提供许多错误消息和其他字符串以供您选择示例。另一个优点是，如果您需要澄清某些事情，您可以查看翻译成[您的母语](http://translationproject.org/PO-files/he/diffutils-2.8.7.he.po)的翻译，以用作某种罗塞塔石碑（尽管您似乎英语说和写得很好，可以在这里发帖，所以我'不确定你是否需要那个）。

# c - 为什么这种显式转换的结果与隐式转换的结果不同？

> ID：752738
> 
> 赞同：12
> 
> 时间：2009-04-15T17:06:38.453
> 
> 标签：c, type-conversion, casting

为什么这种显式转换的结果与隐式转换的结果不同？

```
#include <stdio.h>

double  a;
double  b;
double  c;

long    d;

double    e;

int main() {
    a = 1.0;
    b = 2.0;
    c = .1;

    d = (b - a + c) / c;
    printf("%li\n", d);        //    10

    e = (b - a + c) / c;
    d = (long) e;
    printf("%li\n", d);        //    11
    } 
```

如果我这样做 d = (long) ((b - a + c) / c); 我也得到了 10。为什么分配给双倍会有所不同？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-15T17:11:56.460

我怀疑区别在于从 80 位浮点值到 long 的转换与从 80 位浮点值到 64 位的转换*然后再到*long 的转换。

（出现 80 位的原因是这是用于实际算术的典型精度，以及浮点寄存器的宽度。）

假设 80 位结果类似于 10.9999999999999999 - 从它到 long 的转换产生 10。但是，最接近 80 位值的 64 位浮点值实际上是 11.0，所以两阶段转换最终产生11.

编辑：为了给这个更多的重量......

这是一个使用任意精度算术进行相同计算的 Java 程序。请注意，它将最接近 0.1 的双精度值转换为 BigDecimal - 该值为 0.1000000000000000055511151231257827021181583404541015625。（换句话说，计算的确切结果无论如何*都不*是11。）

```
import java.math.*;

public class Test
{
    public static void main(String[] args)
    {
        BigDecimal c = new BigDecimal(0.1d);        
        BigDecimal a = new BigDecimal(1d);
        BigDecimal b = new BigDecimal(2d);

        BigDecimal result = b.subtract(a)
                             .add(c)
                             .divide(c, 40, RoundingMode.FLOOR);
        System.out.println(result);
    }
} 
```

结果如下：

```
10.9999999999999994448884876874217606030632 
```

换句话说，这对大约 40 位十进制数字是正确的（比 64 位或 80 位浮点数可以处理的多）。

现在，让我们考虑一下这个数字在二进制中的样子。我没有任何工具可以轻松进行转换，但我们可以再次使用 Java 来提供帮助。假设一个标准化的数字，“10”部分最终使用三位（11 比 1 = 1011）。剩下 60 位尾数用于扩展精度（80 位）和 48 位用于双精度（64 位）。

那么，每个精度中最接近 11 的数字是多少？同样，让我们​​使用 Java：

```
import java.math.*;

public class Test
{
    public static void main(String[] args)
    {
        BigDecimal half = new BigDecimal("0.5");        
        BigDecimal eleven = new BigDecimal(11);

        System.out.println(eleven.subtract(half.pow(60)));
        System.out.println(eleven.subtract(half.pow(48)));        
    }
} 
```

结果：

```
10.999999999999999999132638262011596452794037759304046630859375
10.999999999999996447286321199499070644378662109375 
```

所以，我们得到的三个数字是：

```
Correct value: 10.999999999999999444888487687421760603063...
11-2^(-60): 10.999999999999999999132638262011596452794037759304046630859375
11-2^(-48): 10.999999999999996447286321199499070644378662109375 
```

现在为每个精度计算出最接近正确值的值 - 对于扩展精度，它小于 11。将这些值中的每一个四舍五入为 long，最后分别得到 10 和 11。

希望这是足以说服怀疑者的证据；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T18:26:55.500

我在运行 gcc 4.3.2 的 32 位 x86 linux 系统上也得到了 10 和 11。

相关的 C/asm 在这里：

```
26:foo.c         ****     d = (b - a + c) / c;                                               
  42                            .loc 1 26 0
  43 0031 DD050000              fldl    b
  43      0000
  44 0037 DD050000              fldl    a
  44      0000
  45 003d DEE9                  fsubrp  %st, %st(1)
  46 003f DD050000              fldl    c
  46      0000
  47 0045 DEC1                  faddp   %st, %st(1)
  48 0047 DD050000              fldl    c
  48      0000
  49 004d DEF9                  fdivrp  %st, %st(1)
  50 004f D97DFA                fnstcw  -6(%ebp)
  51 0052 0FB745FA              movzwl  -6(%ebp), %eax
  52 0056 B40C                  movb    $12, %ah
  53 0058 668945F8              movw    %ax, -8(%ebp)
  54 005c D96DF8                fldcw   -8(%ebp)
  55 005f DB5DF4                fistpl  -12(%ebp)
  56 0062 D96DFA                fldcw   -6(%ebp)
  57 0065 8B45F4                movl    -12(%ebp), %eax
  58 0068 A3000000              movl    %eax, d
  58      00
  27:foo.c         ****
  28:foo.c         ****     printf("%li\n", d);                                                
  59                            .loc 1 28 0
  60 006d A1000000              movl    d, %eax
  60      00
  61 0072 89442404              movl    %eax, 4(%esp)
  62 0076 C7042400              movl    $.LC3, (%esp)
  62      000000
  63 007d E8FCFFFF              call    printf
  63      FF
  29:foo.c         ****     //    10                                                           
  30:foo.c         ****
  31:foo.c         ****     e = (b - a + c) / c;                                               
  64                            .loc 1 31 0
  65 0082 DD050000              fldl    b
  65      0000
  66 0088 DD050000              fldl    a
  66      0000
  67 008e DEE9                  fsubrp  %st, %st(1)
  68 0090 DD050000              fldl    c
  68      0000
  69 0096 DEC1                  faddp   %st, %st(1)
  70 0098 DD050000              fldl    c
  70      0000
  71 009e DEF9                  fdivrp  %st, %st(1)
  72 00a0 DD1D0000              fstpl   e
  72      0000
  32:foo.c         ****
  33:foo.c         ****     d = (long) e;                                                      
  73                            .loc 1 33 0
  74 00a6 DD050000              fldl    e
  74      0000
  75 00ac D97DFA                fnstcw  -6(%ebp)
  76 00af 0FB745FA              movzwl  -6(%ebp), %eax
  77 00b3 B40C                  movb    $12, %ah
  78 00b5 668945F8              movw    %ax, -8(%ebp)
  79 00b9 D96DF8                fldcw   -8(%ebp)
  80 00bc DB5DF4                fistpl  -12(%ebp)
  81 00bf D96DFA                fldcw   -6(%ebp)
  82 00c2 8B45F4                movl    -12(%ebp), %eax
  83 00c5 A3000000              movl    %eax, d
  83      00 
```

答案留给感兴趣的读者作为练习。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T17:19:41.683

codepad.org (gcc 4.1.2) 反转了您的示例的结果，而在我的本地系统 (gcc 4.3.2) 上，两种情况下我都得到 11。这向我表明这是一个浮点问题。或者，它理论上可以截断 (b - a + c)，在整数上下文中将计算为 (2 - 1 + 0) / .1，即 10，而在浮点上下文中 (2.0 - 1.0 + 0.1) ) / .1 = 1.1 / .1 = 11。不过那会很奇怪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T17:16:48.413

在 Linux 上直接复制/粘贴和编译都给了我 11。添加`d = (long) ((b - a + c) / c);`也会给出 11。OpenBSD 也是如此。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T17:39:16.127

[这里有一堆关于浮点问题的细节和一篇非常好的文章。](http://docs.sun.com/source/806-3568/ncg_goldberg.html) 但基本上，并非所有浮点值都可以用一定数量的位（32 位或 64 位或其他）表示。这是一个深奥的主题，但我喜欢它，因为它让我想起了[卡汉教授](http://www.cs.berkeley.edu/~wkahan/ieee754status/754story.html)。:)

# language-agnostic - 使用大量静态方法是一件坏事吗？

> ID：752758
> 
> 赞同：118
> 
> 时间：2009-04-15T17:12:37.707
> 
> 标签：language-agnostic, static-methods

当该类不需要跟踪内部状态时，我倾向于将类中的所有方法声明为静态。例如，如果我需要将 A 转换为 B 并且不依赖于可能会发生变化的某些内部状态 C，我会创建一个静态转换。如果有一个我希望能够调整的内部状态 C，那么我添加一个构造函数来设置 C 并且不使用静态转换。

我阅读了各种关于不要过度使用静态方法的建议（包括关于 StackOverflow 的建议），但我仍然无法理解上面的经验法则有什么问题。

这是一个合理的方法吗？

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2009-04-15T17:22:30.753

常见的静态方法有两种：

*   “安全”的静态方法将始终为相同的输入提供相同的输出。它不修改任何全局变量，也不调用任何类的任何“不安全”静态方法。从本质上讲，您正在使用一种有限的函数式编程——不要害怕这些，它们很好。
*   “不安全”的静态方法会改变全局状态，或代理到全局对象，或其他一些不可测试的行为。这些是对过程编程的回归，如果可能的话，应该重构。

“不安全”的静态有一些常见的用法——例如，在单例模式中——但请注意，尽管你给它们起任何漂亮的名字，但你只是在改变全局变量。在使用不安全的静态变量之前请仔细考虑。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-15T17:16:41.720

没有任何内部状态的对象是可疑的东西。

通常，对象封装状态和行为。只封装行为的对象是奇怪的。**有时它是Lightweight**或**Flyweight**的一个例子。

其他时候，它是用对象语言完成的程序设计。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-15T18:30:09.920

这实际上只是约翰米利金出色答案的后续行动。

* * *

尽管将无状态方法（几乎是函数）设为静态是安全的，但有时会导致难以修改的耦合。考虑你有一个这样的静态方法：

```
public class StaticClassVersionOne {
    public static void doSomeFunkyThing(int arg);
} 
```

你称之为：

```
StaticClassVersionOne.doSomeFunkyThing(42); 
```

这一切都很好，而且非常方便，直到您遇到必须修改静态方法的行为并发现您与`StaticClassVersionOne`. 可能您可以修改代码，这会很好，但如果有其他调用者依赖于旧行为，则需要在方法体中考虑它们。在某些情况下，如果方法体试图平衡所有这些行为，它可能会变得非常丑陋或无法维护。如果您拆分方法，您可能必须在几个地方修改代码以考虑到它，或者调用新类。

但是考虑一下如果你已经创建了一个接口来提供方法，并将它提供给调用者，现在当行为必须改变时，可以创建一个新的类来实现这个接口，它更干净、更容易测试、更易于维护，而是将其提供给调用者。在这种情况下，调用类不需要更改甚至重新编译，并且更改是本地化的。

这可能是，也可能不是，但我认为值得考虑。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-15T17:15:13.533

这似乎是一种合理的做法。您不想使用太多静态类/方法的原因是您最终会远离面向对象的编程，而更多地进入结构化编程领域。

在您只是将 A 转换为 B 的情况下，假设我们所做的只是将文本转换为

```
"hello" =>(transform)=> "<b>Hello!</b>" 
```

那么静态方法就有意义了。

但是，如果您经常在对象上调用这些静态方法并且它对于许多调用来说往往是唯一的（例如，您使用它的方式取决于输入），或者它是对象固有行为的一部分，它会明智的做法是让它成为对象的一部分并保持它的状态。一种方法是将其实现为接口。

```
class Interface{
    method toHtml(){
        return transformed string (e.g. "<b>Hello!</b>")
    }

    method toConsole(){
        return transformed string (e.g. "printf Hello!")
    }
}

class Object implements Interface {
    mystring = "hello"

    //the implementations of the interface would yield the necessary 
    //functionality, and it is reusable across the board since it 
    //is an interface so... you can make it specific to the object

   method toHtml()
   method toConsole()
} 
```

编辑：使用静态方法的一个很好的例子是 Asp.Net MVC 或 Ruby 中的 html 辅助方法。它们创建的 html 元素与对象的行为无关，因此是静态的。

编辑 2：将函数式编程更改为结构化编程（出于某种原因，我感到困惑），托斯滕指出这一点。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-15T17:19:05.957

另一种选择是将它们作为非静态方法添加到原始对象上：

即，改变：

```
public class BarUtil {
    public static Foo transform(Bar toFoo) { ... }
} 
```

进入

```
public class Bar {
    ...
    public Foo transform() { ...}
} 
```

但是在许多情况下这是不可能的（例如，从 XSD/WSDL/等生成常规类代码），或者它会使类变得很长，并且转换方法对于复杂对象来说通常是一个真正的痛苦，而你只想要它们在他们自己单独的班级中。所以是的，我在实用程序类中有静态方法。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-15T18:58:50.507

只要在正确的地方使用静态类就可以了。

即：“叶”方法的方法（它们不修改状态，它们只是以某种方式转换输入）。Path.Combine 就是一个很好的例子。这些类型的东西很有用，并且使语法更简洁。

我遇到的静力学**问题**很多：

首先，如果您有静态类，则依赖项是隐藏的。考虑以下：

```
public static class ResourceLoader
{
    public static void Init(string _rootPath) { ... etc. }
    public static void GetResource(string _resourceName)  { ... etc. }
    public static void Quit() { ... etc. }
}

public static class TextureManager
{
    private static Dictionary<string, Texture> m_textures;

    public static Init(IEnumerable<GraphicsFormat> _formats) 
    {
        m_textures = new Dictionary<string, Texture>();

        foreach(var graphicsFormat in _formats)
        {
              // do something to create loading classes for all 
              // supported formats or some other contrived example!
        }
    }

    public static Texture GetTexture(string _path) 
    {
        if(m_textures.ContainsKey(_path))
            return m_textures[_path];

        // How do we know that ResourceLoader is valid at this point?
        var texture = ResourceLoader.LoadResource(_path);
        m_textures.Add(_path, texture);
        return texture; 
    }

    public static Quit() { ... cleanup code }       
} 
```

查看 TextureManager，您无法通过查看构造函数来判断必须执行哪些初始化步骤。您必须深入研究该类以找到它的依赖关系并以正确的顺序初始化事物。在这种情况下，它需要在运行之前初始化 ResourceLoader。现在扩大这种依赖关系的噩梦，您可能会猜到会发生什么。想象一下，试图在没有明确的初始化顺序的情况下维护代码。将此与使用实例的依赖注入进行对比——在这种情况下，如果不满足依赖关系，代码甚至不会**编译！**

此外，如果你使用修改状态的静态，它就像一个纸牌屋。您永远不知道谁可以访问什么，并且设计往往类似于意大利面条怪物。

最后，同样重要的是，使用静态将程序与特定实现联系起来。静态代码是可测试性设计的对立面。测试充满静态的代码是一场噩梦。静态调用永远不能被替换为测试替身（除非您使用专门设计用于模拟静态类型的测试框架），因此静态系统会使使用它的所有内容都成为即时集成测试。

简而言之，静态对于某些东西和小工具或一次性代码来说是很好的，我不会阻止它们的使用。然而，除此之外，它们对于可维护性、良好的设计和易于测试来说是一场血腥的噩梦。

这是一篇关于问题的好文章：http: [//gamearchitect.net/2008/09/13/an-anatomy-of-despair-managers-and-contexts/](http://gamearchitect.net/2008/09/13/an-anatomy-of-despair-managers-and-contexts/)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-15T17:21:27.467

警告您远离静态方法的原因是使用它们会丧失对象的优势之一。对象用于数据封装。这可以防止发生意外的副作用，从而避免错误。静态方法没有封装数据*，因此无法获得此好处。

也就是说，如果您不使用内部数据，它们可以很好地使用并且执行速度稍快。不过，请确保您没有触及其中的全局数据。

*   一些语言还具有允许封装数据和静态方法的类级变量。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-15T17:21:37.560

我最近重构了一个应用程序以删除/修改一些最初作为静态类实现的类。随着时间的推移，这些类获得了很多，人们只是不断地将新函数标记为静态，因为从来没有一个实例浮动。

所以，我的回答是静态类本质上并不坏，但现在开始创建实例可能更容易，然后必须稍后重构。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-15T18:50:58.560

我认为这是一种设计气味。如果您发现自己主要使用静态方法，那么您可能没有很好的 OO 设计。这不一定是坏事，但就像所有的气味一样，它会让我停下来重新评估。它暗示您可能能够做出更好的 OO 设计，或者您应该转向另一个方向并针对这个问题完全避免 OO。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-09-10T12:55:31.853

好吧，当然没有灵丹妙药。静态类适用于小实用程序/帮助程序。但是使用静态方法进行业务逻辑编程肯定是邪恶的。考虑以下代码

```
 public class BusinessService
   {

        public Guid CreateItem(Item newItem, Guid userID, Guid ownerID)
        {
            var newItemId = itemsRepository.Create(createItem, userID, ownerID);
            **var searchItem = ItemsProcessor.SplitItem(newItem);**
            searchRepository.Add(searchItem);
            return newItemId;
        }
    } 
```

你会看到一个静态方法调用`ItemsProcessor.SplitItem(newItem);`它的气味原因

*   您没有声明明确的依赖关系，如果您不深入研究代码，您可能会忽略类和静态方法容器之间的耦合
*   您无法将其与（大多数测试工具不模拟静态类）`BusinessService`隔离开来进行测试，这使得单元测试变得不可能。`ItemsProcessor`没有单元测试 == 低质量

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-15T17:53:14.253

我曾经在一个有一堆静态方法的类和一个单例之间来回切换。两者都解决了问题，但可以更容易地用多个替换单例。（程序员似乎总是如此确定，只会有 1 个东西，我发现自己错了很多次，以至于完全放弃了静态方法，除非在一些非常有限的情况下）。

无论如何，单例使您能够稍后将某些内容传递给工厂以获取不同的实例，并且无需重构即可更改整个程序的行为。将全局静态方法类更改为具有不同“支持”数据或稍微不同的行为（子类）的东西是一个主要的痛苦。

静态方法没有类似的优势。

所以，是的，他们很糟糕。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-15T17:16:58.117

只要没有内部状态发挥作用，就可以了。请注意，通常静态方法应该是线程安全的，因此如果您使用辅助数据结构，请以线程安全的方式使用它们。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-15T17:23:46.337

如果你知道你*永远*不需要使用 C 的内部状态，那很好。但是，如果将来发生变化，您需要使该方法成为非静态方法。如果一开始是非静态的，那么如果你不需要它，你可以忽略内部状态。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-09-20T10:41:31.673

如果它是一种实用方法，最好将其设为静态。Guava 和 Apache Commons 就是建立在这个原则之上的。

我对此的看法纯粹是务实的。如果是您的应用程序代码，静态方法通常不是最好的选择。静态方法有严重的单元测试限制——它们不容易被模拟：你不能将模拟的静态功能注入到其他测试中。您通常也不能将功能注入静态方法。

所以在我的应用程序逻辑中，我通常有小的静态实用程序类方法调用。IE

```
static cutNotNull(String s, int length){
  return s == null ? null : s.substring(0, length);
} 
```

好处之一是我不测试这些方法:-)

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2017-04-21T13:19:10.313

即使对于无状态代码，静态方法通常也是一个糟糕的选择。而是使用这些方法创建一个单例类，该类被实例化一次并注入到那些想要使用这些方法的类中。这样的类更容易模拟和测试。它们更加面向对象。您可以在需要时用代理包装它们。静态使 OO 变得更加困难，我认为几乎没有理由在所有情况下都使用它们。不是100%，但几乎全部。

# nhibernate - 我可以在 NHibernate 中替换对 Activator.CreateInstance() 的调用吗？

> ID：752761
> 
> 赞同：1
> 
> 时间：2009-04-15T17:12:58.017
> 
> 标签：nhibernate, structuremap

有没有办法替换 NHibernate 2.0.1GA 中使用的对 Activator.CreateInstance() 的调用来构造实体？理想情况下，我想用 StructureMap.ObjectFactory.GetInstance() 替换它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T18:44:58.327

使用构造函数注入不能轻易做到这一点。NHibernate 内部可能需要创建一个从您的域类继承的代理对象，并在其中散布延迟加载代码等，因此，据我所知，没有简单的选项可以覆盖您的对象的构造。

但是，您*可以*通过编写一个拦截器来相当容易地使用 NHibernate 进行依赖注入，该拦截器将通过属性设置器注入为您构建对象。这里有一个例子[。](http://devlicio.us/blogs/billy_mccafferty/archive/2007/02/05/inject-di-container-into-domain-objects-with-nhibernate.aspx)该示例使用 Windsor 作为 DI 容器，但您当然可以使用 StructureMap 做同样的事情 -[这里是 StructureMap 的相关文档](http://structuremap.sourceforge.net/ConstructorAndSetterInjection.htm)- 查找“将 Setter 注入应用到现有对象（BuildUp）”部分。

警告：将依赖项注入域模型通常被视为设计问题的征兆，许多人避免这样做，因此在开始编码之前确保这确实是您想要做的！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T22:43:11.483

看看[Fabio Maulo](http://fabiomaulo.blogspot.com/2008/11/entities-behavior-injection.html)（现任 NHibernate 首席开发人员）的这篇文章，他在几个月前解决了这个问题。该代码适用于 NHibernate 2.1，但我认为可以通过删除 IProxyFactoryFactory 部分将其反向移植到 2.0.1GA。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T19:01:59.737

您可以通过实现 IInterceptor 并使用 Objectfactory.BuildUp 在 onload 方法中进行注入来进行 setterinjetion。这很容易实现，setter 注入可能不是你想要的。

您可以通过实现自己的 IBytecodeProvider 和 ReflectionOptimizer 来进行构造函数注入。这有点难做，但有可能！

我不建议在实体中注入东西。在 99.9% 的情况下，这将导致糟糕的设计并使您的设计中的分层变得不可能。也许您面临 0.01% 的情况，认为这是正确的做法。这是你经常做的事情，就像输入 goto 语句一样。

# c++ - 让所有 setter 函数返回对 c++ 中对象的引用是否很好？

> ID：752762
> 
> 赞同：11
> 
> 时间：2009-04-15T17:13:02.463
> 
> 标签：c++, reference, return-type

让所有 setter 函数返回对 c++ 中对象的引用是否很好？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-15T17:16:11.427

如果需要在对象上设置很多东西，这是一个足够可用的模式。

```
 class Foo
 {
      int x, y, z;
 public:
      Foo &SetX(int x_) { x = x_;  return *this; }
      Foo &SetY(int y_) { y = y_;  return *this; }
      Foo &SetZ(int z_) { z = z_;  return *this; }
 };

 int main()
 {
      Foo foo;
      foo.SetX(1).SetY(2).SetZ(3);
 } 
```

此模式替换了一个采用三个整数的构造函数：

```
 int main()
 {
      Foo foo(1, 2, 3); // Less self-explanatory than the above version.
 } 
```

如果您有许多并不总是需要设置的值，这将很有用。

作为参考，此类技术的更完整示例在 C++ FAQ Lite 中称为“[命名参数惯用语”。](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.18)

当然，如果您将其用于命名参数，您可能需要查看[boost::parameter](http://www.boost.org/doc/libs/1_38_0/libs/parameter/doc/html/index.html)。或者你可能不会...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-15T17:18:19.050

`this`如果您想将 setter 函数调用链接在一起，您可以返回一个引用，如下所示：

```
obj.SetCount(10).SetName("Bob").SetColor(0x223344).SetWidth(35); 
```

我个人认为代码比替代代码更难阅读：

```
obj.SetCount(10);
obj.SetName("Bob");
obj.SetColor(0x223344);
obj.SetWidth(35); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T17:29:13.530

这种风格的典型目的是用于对象构造。

```
Person* pPerson = &(new Person())->setAge(34).setId(55).setName("Jack"); 
```

代替

```
Person* pPerson = new Person( 34, 55, "Jack" ); 
```

如果使用第二种更传统的样式，可能会忘记传递给构造函数的第一个值是年龄还是 id？这也可能导致基于某些属性的有效性的多个构造函数。

使用第一种样式可能会忘记设置一些对象属性，并且可能会导致对象未“完全”构造的错误。（稍后会添加一个类属性，但并非所有构造位置都已更新以调用所需的设置器。）

随着代码的发展，我真的很喜欢这样一个事实，即在更改构造函数的签名时，我可以使用编译器来帮助我找到创建对象的所有位置。所以出于这个原因，我更喜欢使用常规的 C++ 构造函数而不是这种风格。

这种模式可能适用于根据与许多数据库应用程序中使用的规则类似的规则随时间维护其数据模型的应用程序：

*   您可以将字段/属性添加到默认为 NULL 的表/类中。（因此升级现有数据只需要在数据库中添加一个新的 NULL 列。）
*   未更改的代码在添加了此 NULL 字段后仍应正常工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T17:17:02.827

不是所有的 setter，但其中一些可以返回对 object 的引用以很有用。

有点儿

```
a.SetValues(object)(2)(3)(5)("Hello")(1.4); 
```

我很久以前用它来构建处理所有转义问题和其他事情的 SQL 表达式构建器。

```
SqlBuilder builder;

builder.select( column1 )( column2 )( column3 ).
    where( "=" )( column1, value1 )
                ( column2, value2 ).
    where( ">" )( column3, 100 ).
    from( table1 )( "table2" )( "table3" ); 
```

我无法在 10 分钟内复制资源。所以实施是在幕后。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T17:24:47.160

如果您的动机与链接有关（例如 Brian Ensink 的建议），我将提供两条评论：

1\. 如果你发现自己经常同时设置很多东西，那可能意味着你应该生成一个`struct`or`class`来保存所有这些设置，以便它们可以同时传递。下一步可能是使用它`struct`或`class`对象本身......但由于您使用的是 getter 和 setter，因此如何在内部表示它的决定无论如何对类的用户都是透明的，所以这个决定将涉及更多类比什么都复杂。

2\. setter 的一种替代方法是创建一个新对象，对其进行更改并返回它。这在大多数类型中既低效又不合适，尤其是可变类型。然而，尽管它在许多语言的字符串类中使用，但人们有时会忘记它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-15T17:26:59.183

此技术用于[命名参数 Idiom](https://isocpp.org/wiki/faq/ctors#named-parameter-idiom)中。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-15T19:48:51.807

IMO setter 是一种代码气味，通常表明以下两种情况之一：

**用鼹鼠山造山**

如果你有这样的课程：

```
class Gizmo
{
public:
  void setA(int a) { a_ = a; }
  int getA() const { return a_; }

  void setB(const std::string & b) { v_ = b; }
  std::string getB() const { return b_; }
private:
  std::string b_;
  int a_;
}; 
```

...而且这些值真的就是这么简单，那为什么不把数据成员公开呢？：

```
class Gizmo
{
public:
  std::string b_;
  int a_;
}; 
```

...简单得多，***如果数据如此简单，***您将一无所获。

另一种可能性是你可能是

**把山变成鼹鼠山**

很多时候数据并不那么简单：也许您必须更改多个值，进行一些计算，通知其他对象；谁知道呢。但是，如果数据足够重要以至于您确实需要 setter 和 getter，那么它也不够重要以至于需要错误处理。所以在这些情况下，你的 getter 和 setter 应该返回某种错误代码或做其他事情来表明发生了不好的事情。

如果您像这样将调用链接在一起：

```
A.doA().doB().doC(); 
```

...并且 doA() 失败了，你真的想调用 doB() 和 doC() 吗？我对此表示怀疑。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T17:15:41.473

我不这么认为。通常，您认为“setter”对象就是这样做的。

此外，如果你只是设置对象，你没有指向它的指针吗？

# maven-2 - Maven - 码头 - org.apache.maven.lifecycle.LifecycleExecutionException：失败

> ID：752767
> 
> 赞同：0
> 
> 时间：2009-04-15T17:14:34.503
> 
> 标签：maven-2, jetty

我该怎么做才能启动服务器？

这是我在终端输入的命令：

mvn码头：运行

这是结果：

```
[INFO] Starting jetty 6.1.9 ...
2009-04-15 18:16:00.829::INFO:  jetty-6.1.9
2009-04-15 18:16:03.748::INFO:  No Transaction manager found - if your webapp requires one, please configure one.
1487 [main] INFO com.opensymphony.xwork2.config.providers.XmlConfigurationProvider - Parsing configuration file [struts-default.xml]
2104 [main] INFO com.opensymphony.xwork2.config.providers.XmlConfigurationProvider - Parsing configuration file [struts-plugin.xml]
2350 [main] INFO com.opensymphony.xwork2.config.providers.XmlConfigurationProvider - Parsing configuration file [struts.xml]
2009-04-15 18:16:10.252::WARN:  failed SelectChannelConnector@0.0.0.0:8080
java.net.BindException: Address already in use
    at sun.nio.ch.Net.bind(Native Method)
    at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:119)
    at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:59)
    at org.mortbay.jetty.nio.SelectChannelConnector.open(SelectChannelConnector.java:205)
    at org.mortbay.jetty.nio.SelectChannelConnector.doStart(SelectChannelConnector.java:304)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.Server.doStart(Server.java:233)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.plugin.Jetty6PluginServer.start(Jetty6PluginServer.java:132)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:357)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:293)
    at org.mortbay.jetty.plugin.AbstractJettyRunMojo.execute(AbstractJettyRunMojo.java:203)
    at org.mortbay.jetty.plugin.Jetty6RunMojo.execute(Jetty6RunMojo.java:184)
    at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:453)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:559)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeStandaloneGoal(DefaultLifecycleExecutor.java:513)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:483)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:331)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:292)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:142)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:336)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:129)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:301)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)
    at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)
    at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)
    at org.codehaus.classworlds.Launcher.main(Launcher.java:375)
2009-04-15 18:16:10.256::WARN:  failed Server@166aab6
java.net.BindException: Address already in use
    at sun.nio.ch.Net.bind(Native Method)
    at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:119)
    at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:59)
    at org.mortbay.jetty.nio.SelectChannelConnector.open(SelectChannelConnector.java:205)
    at org.mortbay.jetty.nio.SelectChannelConnector.doStart(SelectChannelConnector.java:304)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.Server.doStart(Server.java:233)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.plugin.Jetty6PluginServer.start(Jetty6PluginServer.java:132)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:357)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:293)
    at org.mortbay.jetty.plugin.AbstractJettyRunMojo.execute(AbstractJettyRunMojo.java:203)
    at org.mortbay.jetty.plugin.Jetty6RunMojo.execute(Jetty6RunMojo.java:184)
    at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:453)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:559)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeStandaloneGoal(DefaultLifecycleExecutor.java:513)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:483)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:331)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:292)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:142)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:336)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:129)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:301)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)
    at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)
    at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)
    at org.codehaus.classworlds.Launcher.main(Launcher.java:375)
[INFO] Jetty server exiting.
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] Failure

Embedded error: Address already in use
[INFO] ------------------------------------------------------------------------
[INFO] Trace
org.apache.maven.lifecycle.LifecycleExecutionException: Failure
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:584)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeStandaloneGoal(DefaultLifecycleExecutor.java:513)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:483)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:331)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:292)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:142)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:336)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:129)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:301)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)
    at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)
    at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)
    at org.codehaus.classworlds.Launcher.main(Launcher.java:375)
Caused by: org.apache.maven.plugin.MojoExecutionException: Failure
    at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:370)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:293)
    at org.mortbay.jetty.plugin.AbstractJettyRunMojo.execute(AbstractJettyRunMojo.java:203)
    at org.mortbay.jetty.plugin.Jetty6RunMojo.execute(Jetty6RunMojo.java:184)
    at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:453)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:559)
    ... 16 more
Caused by: java.net.BindException: Address already in use
    at sun.nio.ch.Net.bind(Native Method)
    at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:119)
    at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:59)
    at org.mortbay.jetty.nio.SelectChannelConnector.open(SelectChannelConnector.java:205)
    at org.mortbay.jetty.nio.SelectChannelConnector.doStart(SelectChannelConnector.java:304)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.Server.doStart(Server.java:233)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.plugin.Jetty6PluginServer.start(Jetty6PluginServer.java:132)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:357)
    ... 21 more
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 27 seconds
[INFO] Finished at: Wed Apr 15 18:16:10 BST 2009
[INFO] Final Memory: 12M/254M
[INFO] ------------------------------------------------------------------------
2009-04-15 18:16:11.952::INFO:  Shutdown hook executing
2009-04-15 18:16:11.546::INFO:  Shutdown hook complete 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T12:32:23.983

我知道这是一个老问题，但我的回答可能会对那里的人有所帮助。我在集成测试期间在运行 Jenkins 的机器上启动 webapp 时遇到了这个问题。事实证明，有人将 Sonar 添加到该机器上，并且运行 Sonar 的 Jetty 实例使用与我的 webapp 相同的停止端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T17:19:14.100

编辑：由于对问题进行了足够的编辑以指示“端口已在使用中”；我还有另一个建议；maven-jetty-plugin 的最后几个版本一直存在与您开始使用的端口相关的各种错误（即使在您启动 maven jettty:run 之前它没有被使用）

版本 6.1.12 和 6.1.14 在 windows 上有这个，我也相信我在 ubuntu 上体验过 6.1.11 版本。我目前在 ubuntu 和 windows 上运行 6.1.15 版都很好。我还没有尝试过最新版本（6.1.16），但是您应该考虑将 maven-plugin 的版本上下调整几个版本，看看问题是否消失。您只需要更改插件的版本。

旧帖子：大多数情况下发生这种情况是因为 pom.xml 的 maven-jetty 插件部分中的一些配置错误。尝试恢复到与文档页面上的示例非常相似的内容。我也相信一些旧版本的插件/码头也发生过这种情况，所以请确保您使用的是最新版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T17:22:38.930

看起来端口（8080）已被另一个进程使用

> 原因：java.net.BindException：地址已在 sun.nio.ch.Net.bind(Native

# security - 像 .NET Compact Framework 或 Windows Mobile 可用的 DPAPI 之类的东西吗？

> ID：752770
> 
> 赞同：1
> 
> 时间：2009-04-15T17:15:14.750
> 
> 标签：security, windows-mobile, compact-framework, mobile

我需要一种方法来保护移动设备上的私钥。

我知道在“编写安全代码”一章“保护秘密数据”中说“Windows CE”不能在安全环境中使用。但这本书现在已经有很多年了，2003 年。

现在还是这样吗？告诉我不是这样的。今天必须有一种方法来保护私钥。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T23:53:38.383

DPAPI 包含在一组 Win32 函数[CryptProtectData](http://msdn.microsoft.com/en-us/library/aa922939.aspx)和[CryptUnprotectData](http://msdn.microsoft.com/en-us/library/aa925037.aspx)中。这些功能在 Windows CE 和 Windows Mobile 平台上可用（见链接），虽然我不知道他们在哪个版本上添加了支持。

DPAPI 的 .NET 包装器是System.Security.Cryptography 命名空间（程序集 System.Security.dll）中的[ProtectedData类。](http://msdn.microsoft.com/en-us/library/system.security.cryptography.protecteddata.aspx)但是，我认为 .NET Compact Framework 尚未实现这一点，因此如果使用 .NET，则必须使用 P/Invoke。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T05:48:21.120

如果用户可以访问设备，那么您不能 100% 安全地存储密钥。您可以提高栏杆，但不能将其移除。

您必须外部化对密钥的访问，例如用户输入用户名和/或密码或通过另一种方法（例如通过网络连接的非对称加密）发送到设备。这是 Windows Mobile 程序员的安全建议。

您在设备上存储密钥的任何方式都可以进行逆向工程。这包括使用 CryptProtectData 和 CryptUnprotectData API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T20:46:48.170

使用标准加密算法有什么问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T01:57:34.677

[http://www.windowsfordevices.com/news/NS5217487259.html?kc=rss](http://www.windowsfordevices.com/news/NS5217487259.html?kc=rss)

网络广播涵盖 Windows Mobile 程序员的安全性

这看起来会很好。

# open-source - 在非开源 Web 应用程序中使用 Joomla 的外观是否违法？

> ID：752772
> 
> 赞同：1
> 
> 时间：2009-04-15T17:15:45.060
> 
> 标签：open-source, licensing

我正在 ASP.NET 中开发一个专有（非开源）Web 应用程序，并且我想使用 Joomla 的外观（图像、控件分发等）。这是非法的吗？我这样做违反了许可证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T17:30:38.833

我会腾出一些时间[开始阅读](http://www.gnu.org/copyleft/gpl.html)。祝你好运！

编辑：如果我记得的话，Joomla 是在 GPL 下获得许可的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T17:43:43.590

外观版权[复杂](http://blog.pastie.org/2008/05/copyright---des.html)。你应该总是就这样的事情咨询律师，但我认为如果你使用 Joomla 作为你自己编写的设计的灵感，你就没有什么可担心的了。如果您要批发复制它或使用他们的图形文件，您将处于不稳定的状态。

一般来说，我相信图形文件比样式表具有更强的版权保护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T17:47:39.947

除非 Joomla 中的图像是在 Creative Common 许可下发布的，否则我会避免使用它们。

如果你想模仿外观和感觉，我认为你应该没问题。（注意：我不是律师，所以我可能错了）

# iphone - 无法将 OpenGL 代码移植到 iPhone 的 OpenGL ES

> ID：752780
> 
> 赞同：1
> 
> 时间：2009-04-15T17:17:08.600
> 
> 标签：iphone, opengl, opengl-es

这是我正在使用的示例代码。此代码在 OpenGL 中。我想将它移植到 OpenGL ES。`glArrayElement()`OpenGL ES 不支持。相反，建议使用`glDrawElements()`, `glDrawArrays()`。我无法转换它。你能帮我转换一下代码吗？

```
glTexCoordPointer(2,GL_FLOAT,sizeof(struct texcoord),tex);
glColorPointer(4,GL_UNSIGNED_BYTE,4,col);
glNormalPointer(GL_FLOAT,sizeof(vector),wet->n);
glVertexPointer(2,GL_FLOAT,sizeof(struct vertexcoord),vert);
glEnableClientState(GL_TEXTURE_COORD_ARRAY);
glEnableClientState(GL_COLOR_ARRAY);
glEnableClientState(GL_NORMAL_ARRAY);
glEnableClientState(GL_VERTEX_ARRAY);
glLockArraysEXT(0,wet->w*wet->h);
i=0;
for(int y=0;y<wet->h-1;y++)
{
    glBegin(GL_TRIANGLE_STRIP);
    for(int x=0;x<wet->w;x++)
    {
        glArrayElement(i);
        glArrayElement(i+wet->w);
        i++;
    }
    glEnd();
}
glUnlockArraysEXT(); 
```

还有一个问题是我们`glEnable(GL_TEXTURE_RECTANGLE_EXT)`在 OpenGL ES 中是否有任何替代品。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T08:33:40.797

从 glLockArrays 下来的所有东西都可以摆脱。只需将所有内容替换为 glDrawArrays 即可。

# javascript - 用于处理书签的 url 锚点的 Javascript

> ID：752790
> 
> 赞同：2
> 
> 时间：2009-04-15T17:20:05.440
> 
> 标签：javascript, url, anchor

我想使用 url 的锚点部分（在 # 之后），以便我的页面可以有 ajax/dhtml 但仍然能够让书签正常工作。我想知道是否有人可以帮助我开始为此编写一些javascript代码。我正在使用 jQuery，但如果解决方案是通用的，那也没关系。

对于我的页面，我可以有如下设置：“a”可以是 10-50 之间的数字 “b”是 0 或 1 “c”是 0 或 1 等等...

我想要一些关于编写优化的 javascript 代码的技巧，这些代码既可以解析也可以设置 #a=23&b=0&c=1

另外，我想让我的 url 尽可能短，所以如果“a”的默认值为 23，在上面的示例中，a=23 将被省略。

是否有一个图书馆已经完成了所有这些工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T18:51:22.617

看看**jQuery 历史插件**： http: [//www.mikage.to/jquery/jquery_history.html](http://www.mikage.to/jquery/jquery_history.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T19:10:00.090

我正在开发一个稍微好一点的历史模块，它会自动将哈希信息转换为原生 JavaScript 对象。它是事件驱动的，这意味着它会在哈希更改时触发分配的事件。尽管 Firefox 保留了“哈希历史”，但 IE 并没有，因此您需要使用隐藏的 iframe 来保存哈希信息。

您可以在这里查看源代码：http: [//jslib-test.amplio-vita.net/JSLib/js/aV.main.history.js](http://jslib-test.amplio-vita.net/JSLib/js/aV.main.history.js)

“queryString to Object converter”函数在“Object.fromQueryString”名称下的文件[http://jslib-test.amplio-vita.net/JSLib/js/aV.ext.object.js中。](http://jslib-test.amplio-vita.net/JSLib/js/aV.ext.object.js)

如果您需要，请随时询问更多信息。

# c# - .NET 中的 Finalize 和 Dispose 方法有什么意义？（回答前见详情）

> ID：752792
> 
> 赞同：4
> 
> 时间：2009-04-15T17:20:08.593
> 
> 标签：c#, .net

我需要在对象的拆卸过程中清理资源，但我总是发现***Dispose***、***Finalize***和析构函数方法之间的区别有点令人困惑。

我发现这篇很棒的文章简明扼要地描述了它们之间的区别，我将不得不保存以备将来参考：
[“析构函数、处置和终结方法之间的区别”- Sanjay Saini](http://sanjaysainitech.blogspot.com/2007/06/difference-between-destructor-dispose.html) [http://sanjaysainitech.blogspot.com/2007/ 06/difference-between-destructor-dispose.html](http://sanjaysainitech.blogspot.com/2007/06/difference-between-destructor-dispose.html)

我想在这里问的基本问题是这个。

> 如果一种语言提供析构函数（例如 C# [驳斥]），那么***Dispose***和 ***Finalize***会为等式添加什么值？

我只是一个习惯于在析构函数中做所有事情的老派方式的脾气暴躁的人，还是我缺少一些只有通过将对象的拆解分成三个部分才能实现的东西？

**更新：**
正如一些回复中所指出的，C# 实际上没有析构函数。考虑到这一点，这个问题在这一点上可能没有实际意义。当我在上面引用的文章中读到 C# 实际上有一个单独的解构函数（显然是一个错误）时，它让我陷入了一个循环，我开始想知道如果你有一个最终的析构函数来包装所有内容，那么 Dispose 和 Finalize 的意义何在. 我想在像 C# 这样的 GC 语言中，为对象提供 denemount 的单个析构函数的概念没有多大意义。

很抱歉对你们中的一些人投了反对票，但是有几个人没有仔细阅读这个问题，并认为我在问 Dispose 和 Finalize 之间的区别，这真的不是重点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T17:26:24.427

那篇博文的作者有点糊涂了……

在 C# 中，没有“析构函数”之类的东西。只有终结器和 IDisposable。

~ClassName() 方法不称为“析构函数”。它被称为终结器。

Dispose 的存在是为了从代码中释放资源，而终结器的存在是为了从 GC 中调用。很多时候，终结器调用 Dispose() 方法，但[“Dispose 模式”](http://msdn.microsoft.com/en-us/library/fs2xkftw.aspx)将您设置为仅处理来自终结器的非托管资源。

你看，当终结器被调用时，你在不同的线程上，你拥有的任何托管对象都不一定有效。正因为如此，如果你从终结器调用 Dispose()，你真的应该调用 Dispose(false)，它告诉“Dispose Pattern”只释放非托管资源。

此外，[“Dispose Pattern”](http://msdn.microsoft.com/en-us/library/fs2xkftw.aspx)建议当 Dispose(true) 被调用时，您应该抑制该对象上的终结器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T17:27:23.613

只有托管对象可以自动完成。如果你想提供非托管对象的*隐式*处理，可以使用终结器。如果您想向对象的调用者提供对处置的*显式*控制，您可以允许他们调用 Dispose。

[我喜欢这篇文章](http://msdn.microsoft.com/en-us/library/b1yfkh5e(VS.71).aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T17:30:09.487

很难回答这个问题，因为您已经链接到解释差异的文章。

但无论如何，让我试试吧。

使用垃圾收集，您可以进行非确定性的内存管理，并且由于 GC 将运行您的终结器，因此您可以进行有保证但非确定性的资源管理。

这很好，因为你知道事情会被清理干净。

然而，这很糟糕，因为你不知道它什么时候会发生。

例如，如果您打开一个文件并在打开文件时将其锁定，那么不知道该文件何时可以稍后再次打开是不好的，但保证在某个时候它会被关闭是好的。

Dispose 和 IDisposable 通过添加确定性资源管理来解决这个问题。您可以选择何时处理资源、关闭文件、网络连接、数据库连接等等。这是您的选择，您通常会在不再需要该资源时将其丢弃。因此，当您不再需要该文件时，您可以处置保持它打开的对象。该对象将在内存中停留一段时间（非确定性内存管理），但是当您这样说时，文件将被关闭，准备好立即再次打开。

因此，您获得了资源的确定性处理，并将其与非确定性内存管理相结合，您将获得两全其美。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T17:27:53.923

在 C# ( ) 中看起来像析构函数的东西`~Foo()`实际上只是拼写“Finalize”的另一种方式。

也许事后看来，语法的选择并不是最好的，因为`~Foo()`C# 与 C++ 有很大不同`~Foo()`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T21:33:16.860

很抱歉回答我自己的问题，但我认为我从各种来源收集了一些答案，其中一些答案是对我的问题的简明答案，解决了过渡到 GC 平台时对象生命周期的差异。

* * *

**非 GC 对象生命周期：**

**初始化：**发生在将第一个引用添加到对象时调用的构造函数中。

**清理：**在最后一个引用对象的变量超出范围或显式设置为空/空/另一个对象时调用的析构函数中发生。

* * *

**GC 对象生命周期：**

**初始化：**发生在将第一个引用添加到对象时调用的构造函数中。

**清理（​​第一遍）：**发生在 Dispose 方法中，必须由客户端显式调用或在 Using 语句的末尾隐式调用。这种清理专门用于释放必须立即释放而不是等待 GC 的资源。

**清理（​​Final Pass）：**发生在 GC 时间表上调用的 Finalize 方法中，可以延迟。如果实现了 finalize 方法，则除非之前已在对象上调用过 GC.SuppressFinalize（通常在 dispose 方法中）以将其标记为已清理，否则将调用它。

* * *

我做对了吗？如果我在这里遗漏了什么，请随时编辑。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T17:22:45.620

c# 不提供析构函数，所以你的问题有点没有实际意义？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T17:25:28.797

我不确定析构函数和终结器之间的推理，但是 Dispose 存在以便您可以在垃圾收集器到达对象之前释放资源（这可能永远不会！）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-15T17:30:27.413

等待终结器运行以释放资源的问题在于它没有以可预测的确定性方式运行。当 GC 准备好销毁对象时调用终结器，这可以在您的应用程序中随时发生。

这就是为什么你有处置。它允许您在已知时间点确定性地释放资源，确保资源将被释放。否则你无法控制终结器何时运行。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-15T17:54:31.660

Finalize 无法访问托管对象，因此托管对象应在 Dispose 中处理。这两者之间的区别在于您应该将 Dispose 用于托管，而将 Finalize 用于非托管。您的析构函数应该调用您的 Dispose，以便您正确清除内存。看看以下文章：

[代码项目 - IDisposable：关于资源释放Gil Fink - 内存泄漏和 IDisposable 模式，](http://blogs.microsoft.co.il/blogs/gilf/archive/2008/04/29/memory-leak-idisposable-pattern.aspx)[你的母亲从未告诉过你](http://www.codeproject.com/KB/dotnet/idisposable.aspx)

# c++ - C++ 应该消除头文件吗？

> ID：752793
> 
> 赞同：74
> 
> 时间：2009-04-15T17:20:21.213
> 
> 标签：c++, header-files

许多语言，例如 Java、C#，并没有将声明与实现分开。C# 有一个分部类的概念，但实现和声明仍然保留在同一个文件中。

为什么 C++ 没有相同的模型？有头文件更实用吗？

我指的是当前和即将发布的 C++ 标准版本。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-04-15T17:23:17.850

**向后兼容性**- 头文件不会被消除，因为它会破坏向后兼容性。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-15T17:23:39.427

头文件允许独立编译。您不需要访问甚至不需要实现文件来编译文件。这可以使分布式构建更容易。

这也使 SDK 更容易完成。您可以只提供标题和一些库。当然，还有其他语言使用的方法。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-04-15T19:17:05.177

甚至[Bjarne Stroustrup](http://en.wikipedia.org/wiki/Bjarne_Stroustrup)也将头文件称为杂物。

但是如果没有包含必要元数据（如 Java 类文件或 .Net PE 文件）的标准二进制格式，我看不到任何实现该功能的方法。剥离的 ELF 或 a.out 二进制文件没有您需要提取的大量信息。而且我认为这些信息从未存储在 Windows XCOFF 文件中。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-04-15T17:37:17.270

我经常在 C# 和 C++ 之间切换，而 C# 中缺少头文件是我最大的烦恼之一。我可以查看一个头文件并了解我需要了解的关于一个类的所有信息——它的成员函数被称为什么、它们的调用语法等——而无需浏览实现该类的代码页面。

是的，我知道部分类和#regions，但它不一样。部分类实际上使问题变得更糟，因为类定义分布在多个文件中。就#regions 而言，它们似乎从未以我目前正在做的事情的方式扩展，所以我必须花时间扩展这些小优点，直到我得到正确的视图。

也许如果 Visual Studio 的智能感知对 C++ 工作得更好，我就没有令人信服的理由不得不如此频繁地引用 .h 文件，但即使在 VS2008 中，C++ 的智能感知也无法触及 C#

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-04-15T17:43:30.330

C 旨在使编写编译器变得容易。它基于这一原则做了很多事情。指针的存在只是为了使编写编译器更容易，头文件也是如此。继承到 C++ 的许多东西都是基于与这些特性的兼容性，这些特性使编译器编写更容易。

这其实是个好主意。在创建 C 时，C 和 Unix 是一对。C 移植 Unix，Unix 运行 C。这样，C 和 Unix 可以迅速从一个平台传播到另一个平台，而基于汇编的操作系统必须完全重写才能移植。

在一个文件中指定接口并在另一个文件中指定实现的概念根本不是一个坏主意，但这不是 C 头文件的含义。它们只是一种限制编译器必须通过您的源代码进行的传递次数的方法，并允许对文件之间的契约进行一些有限的抽象，以便它们可以通信。

这些项目、指针、头文件等......实际上并没有比其他系统提供任何优势。通过在编译器上投入更多精力，您可以像编译指向完全相同的对象代码的指针一样轻松地编译引用对象。这就是 C++ 现在所做的。

C 是一种伟大而简单的语言。它的功能集非常有限，您可以轻松编写编译器。移植它通常是微不足道的！我并不是要说它是一种糟糕的语言或其他任何东西，只是 C 在创建它时的主要目标可能会在语言中留下一些现在或多或少不必要的残余物，但为了兼容性将被保留。

* * *

似乎有些人并不真正相信 C 是为移植 Unix 而编写的，所以在这里：（[来自](http://www.bell-labs.com/history/unix/btoc.html)）

> UNIX 的第一个版本是用汇编语言编写的，但 Thompson 的意图是它将用高级语言编写。
> 
> Thompson 于 1971 年首次尝试在 PDP-7 上使用 Fortran，但第一天就放弃了。然后他写了一种非常简单的语言，他称之为 B，并在 PDP-7 上继续使用。它奏效了，但也出现了问题。首先，由于实现是被解释的，它总是会很慢。其次，基于面向字的 BCPL 的 B 的基本概念不适用于新的 PDP-11 等面向字节的机器。
> 
> Ritchie 使用 PDP-11 为 B 添加类型，有一段时间被称为 NB 的“New B”，然后他开始为它编写编译器。“因此，C 的第一阶段实际上是这两个阶段，首先是从 B 的一些语言更改，实际上是在语法上没有太大变化的情况下添加类型结构；然后进行编译器，”Ritchie 说。
> 
> “第二阶段较慢，”他谈到用 C 重写 UNIX 时说。Thompson 于 1972 年夏天开始，但有两个问题：弄清楚如何运行基本的协同程序，即如何将控制从一个进程切换到其他; 以及获得正确数据结构的困难，因为 C 的原始版本没有结构。
> 
> “这些事情的结合导致肯在整个夏天都放弃了，”里奇说。“在这一年中，我添加了结构，并且可能使编译器代码更好——更好的代码——所以在接下来的夏天，那是我们齐心协力并实际上用 C 语言重做整个操作系统的时候。”

* * *

这是我的意思的一个完美的例子。从评论：

> 指针的存在只是为了让编写编译器更容易？不，指针的存在是因为它们是对间接概念的最简单的抽象。——亚当·罗森菲尔德（一小时前）

你说的对。为了实现间接，指针是实现的最简单的抽象。它们绝不是最容易理解或使用的。数组要容易得多。

问题？要像指针一样高效地实现数组，您几乎必须在编译器中添加大量代码。

他们没有理由不能在没有指针的情况下设计 C，而是使用如下代码：

```
int i=0;
while(src[++i])
    dest[i]=src[i]; 
```

需要付出很多努力（在编译器部分）才能排除显式 i+src 和 i+dest 添加并使其创建与以下代码相同的代码：

```
while(*(dest++) = *(src++))
    ; 
```

事后分解出变量“i”是困难的。新的编译器可以做到这一点，但在当时这是不可能的，而且运行在糟糕硬件上的操作系统几乎不需要像这样的优化。

现在很少有系统需要这种优化（我在最慢的平台之一上工作——有线电视机顶盒，我们的大部分东西都是用 Java 编写的），在极少数情况下你可能需要它，新的 C 编译器应该足够聪明，可以自己进行这种转换。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-04-16T04:35:36.907

在[The Design and Evolution of C++](http://en.wikipedia.org/wiki/The_Design_and_Evolution_of_C%2B%2B)中，Stroustrup 又给出了一个理由……

同一个头文件可以有两个或多个实现文件，可以由多个程序员同时处理，而不需要源代码控制系统。

这些天来这可能看起来很奇怪，但我想这是 C++ 发明时的一个重要问题。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2009-04-15T19:06:26.450

如果你想要没有头文件的 C++，那么我有个好消息要告诉你。

它已经存在并被称为 D ( [http://www.digitalmars.com/d/index.html](http://www.digitalmars.com/d/index.html) )

从技术上讲，D 似乎比 C++ 好很多，但目前它还不够主流，无法在许多应用程序中使用。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-04-15T17:49:23.390

C++ 的目标之一是成为 C 的超集，如果它不支持头文件，就很难做到这一点。而且，通过扩展，如果您希望删除头文件，您不妨考虑完全删除 CPP（预处理器，而不是 plus-plus）；C# 和 Java 都没有在它们的标准中指定宏预处理器（但应该注意，在某些情况下，它们甚至可以与这些语言一起使用）。

由于现在设计了 C++，因此您需要原型（就像在 C 中一样）来静态检查任何引用外部函数和类的编译代码。如果没有头文件，您必须在使用它们之前输入这些类定义和函数声明。为了让 C++ 不使用头文件，您必须在语言中添加一个支持 Java`import`关键字之类的功能。那将是一个重大的补充和改变；回答你是否可行的问题：我不这么认为——一点也不。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-07-13T17:49:11.927

很多人都意识到头文件的缺点，并且有想法将更强大的模块系统引入 C++。您可能想看看Daveed Vandevoorde 的[Modules in C++ (Revision 5)](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2316.pdf)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-15T20:15:16.283

好吧，由于向后兼容性，C++ 本身不应该消除头文件。但是，我确实认为它们总体上是一个愚蠢的想法。如果要分发闭源库，可以自动提取此信息。如果您想了解如何在不查看实现的情况下使用类，这就是文档生成器的用途，它们的工作要好得多。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-07-13T17:03:50.440

在实现文件的单独组件中定义类接口是有价值的。

它可以用接口来完成，但如果你走这条路，那么你就隐含地说类在将实现与契约分离方面存在缺陷。

Modula 2 有正确的想法，定义模块和实现模块。 [http://www.modula2.org/reference/modules.php](http://www.modula2.org/reference/modules.php)

Java/C# 的答案是相同的隐式实现（尽管是面向对象的。）

头文件很杂乱，因为头文件表达了实现细节（例如私有变量）。

在转向 Java 和 C# 时，我发现如果一种语言需要 IDE 支持来开发（这样公共类接口可以在类浏览器中导航），那么这可能是一种声明，即代码本身并不能作为特别可读。

我发现接口与实现细节的混合非常可怕。

至关重要的是，缺乏将公共类签名记录在独立于实现的简明注释文件中的能力，这表明语言设计是为了方便作者而编写的，而不是为了方便维护。好吧，我现在正在谈论 Java 和 C#。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-09-11T10:18:59.200

这种分离的一个优点是很容易只查看界面，**而不**需要**高级编辑器**。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-15T19:25:25.500

如果你想知道这永远不会发生的原因：它会破坏几乎所有现有的 C++ 软件。如果您查看 C++ 委员会的一些设计文档，他们会查看各种替代方案，看看它会破坏多少代码。

将 switch 语句更改为智能的东西会容易得多。那只会破坏一点代码。它仍然不会发生。

为新想法编辑：

C++ 和 Java 之间使得 C++ 头文件成为必要的区别在于 C++ 对象不一定是指针。在 Java 中，所有类实例都由指针引用，尽管看起来并非如此。C++ 在堆和栈上分配了对象。这意味着 C++ 需要一种方法来了解对象的大小以及数据成员在内存中的位置。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-16T02:48:20.847

没有头文件就没有语言。这是一个神话。

查看 Java 的任何专有库分发（我没有 C# 经验可言，但我希望它是相同的）。他们没有给你完整的源文件；他们只是给你一个文件，其中每个方法的实现都是空白的（`{}`或`{return null;}`类似的），以及他们可以隐藏的所有东西。除了标题之外，你不能称之为任何东西。

然而，没有技术原因，为什么 C 或 C++ 编译器可以计算一个适当标记的文件中的所有内容，`extern`除非该文件是直接编译的。然而，编译的成本将是巨大的，因为 C 和 C++ 解析速度都不是很快，这是一个非常重要的考虑因素。任何更复杂的合并标头和源代码的方法都会很快遇到技术问题，例如编译器需要知道对象的布局。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-08-23T19:49:22.883

头文件是语言的一个组成部分。没有头文件，所有的静态库、动态库，几乎任何预编译的库都变得毫无用处。头文件还可以更轻松地记录所有内容，并且可以查看库/文件的 API，而无需查看每一位代码。

它们还使组织程序变得更容易。是的，您必须不断地从源代码切换到标头，但它们还允许您在实现中定义内部和私有 API。例如：

我的来源.h：

```
extern int my_library_entry_point(int api_to_use, ...); 
```

我的来源.c：

```
int private_function_that_CANNOT_be_public();

int my_library_entry_point(int api_to_use, ...){
  // [...] Do stuff
}

int private_function_that_CANNOT_be_public() {

} 
```

如果你`#include <MySource.h>`，那么你得到`my_library_entry_point`。

如果你`#include <MySource.c>`，那么你*也*得到`private_function_that_CANNOT_be_public`。

如果你有一个函数来获取密码列表，或者一个实现你的加密算法的函数，或者一个会暴露操作系统内部的函数，或者一个覆盖权限的函数，你就会明白这可能是一件非常糟糕的事情，等等

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-07-13T16:13:30.607

哦是的！

在 Java 和 C# 编码之后，每个类都有 2 个文件真的很烦人。所以我在想如何在不破坏现有代码的情况下合并它们。

事实上，这真的很容易。只需将定义（实现）放在#ifdef 部分中，然后在编译器命令行上添加定义来编译该文件。就是这样。

这是一个例子：

```
/* File ClassA.cpp */

#ifndef _ClassA_
#define _ClassA_

#include "ClassB.cpp"
#include "InterfaceC.cpp"

class ClassA : public InterfaceC
{
public:
    ClassA(void);
    virtual ~ClassA(void);

    virtual void methodC();

private:
    ClassB b;
};

#endif

#ifdef compiling_ClassA

ClassA::ClassA(void)
{
}

ClassA::~ClassA(void)
{
}

void ClassA::methodC()
{
}

#endif 
```

在命令行上，编译该文件

```
-D compiling_ClassA 
```

其他需要包含 ClassA 的文件就可以了

```
#include "ClassA.cpp" 
```

当然，在命令行上添加定义可以很容易地通过宏扩展（Visual Studio 编译器）或自动变量（gnu make）添加，并对定义名称使用相同的命名法。

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2010-07-22T16:38:35.193

我仍然不明白一些陈述的意义。API和实现分离是一件非常好的事情，但是头文件不是API。那里有私人领域。如果您添加或删除私有字段，您会更改实现而不是 API。

# c# - 在不打开 Word 的情况下使用 Interop DLL 打开 Word 文档？

> ID：752794
> 
> 赞同：2
> 
> 时间：2009-04-15T17:20:22.587
> 
> 标签：c#, interop, automation, ms-word, ms-office

我编写了一个自动化测试，它遍历大量 Word 文档并在单个 Word 实例中单独打开它们。我的问题是.. 我可以在没有 ApplicationClass 实例的情况下执行 OpenDocument() 吗？

我想做的是在没有打开可见的 Word 实例的情况下运行我的测试。可能的？看起来应该是这样。ApplicationClass 有一个名为“Visible”的属性，Document 类也有。当我将一个或另一个切换为 false 时，我得到 Null 对象引用异常。有没有人这样做过？

谢谢尼克...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T17:24:27.520

没有 Word 实例：不，不可能

隐藏/不可见的 Word 实例：应该可以工作，也可能取决于其他因素，例如版本、服务包、安装的宏等。

替代解决方案：使用实现此功能的第 3 方组件。[Aspose](http://www.aspose.com/)有一些例如。

# php - Do proxied assets get cached?

> ID：752799
> 
> 赞同：1
> 
> 时间：2009-04-15T17:21:40.040
> 
> 标签：php, caching

I have an application and in order to get the images to load into the app I had to use a proxy. So the urls for the images are not .jpg they are .php?var=value They seem to load much slower even after they have already loaded once, I don't really know how it works, but I am thinking that the proxied images are not being cached. Am I correct?

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T19:28:12.263

IE (and maybe other browsers) doesn't cache URLs with any kind of ?query=string&foo=bar [if there are no caching headers in the response](http://msdn.microsoft.com/en-us/library/aa905731.aspx#ie_introfiddler2_topic4). You have to explicitly set the Cache-Control and Expires headers for these to be cached.

* * *

In PHP, the way to set headers is this:

```
// can be cached by browser, and also by intermediate caches (i.e. by everybody)
header('Cache-Control: public');

// is fresh (doesn't have to be re-checked) until that date
header('Expires: Fri, 17 Apr 2009 23:50:00 GMT'); 
```

Caveat: you need to send headers before content, unless you use output buffering.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T17:28:17.667

Your PHP-file might have declared a no-cache flag, or a low expiry time. Try opening both urls in a viewer which shows the full http headers.

Every proxy has its own settings how to deal with caching and different file types. A JPG is often seen as a static file, so it's safe to cache it. PHP files however are seen as dynamic scripts, who produce a different output every time. But this completely depends on your proxy's configuration.

# .net - 为什么我的收藏决定从 0 而不是 1 开始？

> ID：752801
> 
> 赞同：2
> 
> 时间：2009-04-15T17:21:58.633
> 
> 标签：.net, visual-studio-2008, multithreading, debugging, service

我遇到了一个问题，即在服务的线程上运行时无法正确访问对象集合。我可以在 VS2008 中很好地运行我的单元测试，但是当我将调试器附加到服务时，我可以清楚地看到它不是从基于 1 的索引开始，而是从基于 0 的索引开始。我已经尝试了我能想到的一切来隔离它，唯一的区别是它在服务中，而不是作为命令行应用程序运行。

当我调试该功能时，我还会收到一条“属性评估失败”消息，而在我的单元测试中运行它时却没有。

请指教。

[编辑]

我知道数组通常从 0 开始。我一直假设这一点，但今天我发现了这个错误并确定即使我认为它从 0 开始，调试器显示它从 1 开始。当我遍历集合时它在 VS 中获得了正确的值，但在服务中却没有。

[编辑]

我正在使用 Microsoft.VisualBasic.Collection，因为我可以对它设置密钥。也可以使用字典对象，但它现在是这样设置的，这就是我的 BLL 基类和其他众多函数读取它的方式，因此最好不要更改它。

[解决方案]

我使用字典和 Generic.KeyValuePair(Of String, Object) 重构了我的代码，这样我就不必重写访问键的代码。现在应该可以正常工作了，因为它不能以与 collecitons 对象相同的方式处理集合。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T17:37:37.660

默认情况下，.NET 语言从数组索引 0 开始，除非您明确指定 VB.NET 从 1 开始。

我不相信有一种方法可以在 VB 程序集之外强制执行此数组约定，因此，当它们通过 Windows 远程处理或 Web 服务时，它们将恢复为基于 0 的索引约定。

为了您的理智，我建议您重构所有代码以改用 0 索引的集合和数组。

**更新**

根据您的评论，您说您使用了 Microsoft.VisualBasic.Collection 对象。Microsoft.VisualBasic.Collection 对象使用 1 作为其起始索引。使用 ArrayList 对象，或者更好的是通用 List 对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T17:36:55.820

.NET Framework 中的所有集合都从 0 开始，数组也是如此。总是。

根据您的评论，您正在使用一些特殊的 Visual Basic 集合类型。我建议你改掉这个习惯，因为我相信这种类型是为了与 VB6 互操作。

# c# - 单击超链接字段时获取网格视图的索引

> ID：752806
> 
> 赞同：2
> 
> 时间：2009-04-15T17:22:35.577
> 
> 标签：c#, asp.net, gridview, coding-style, detailsview

我有一个正在开发的网络应用程序（使用 C# 的 ASP.NET 2.0）。在其中，我有一个网格视图，页面上有一个超链接字段（My_Page.aspx）。单击超链接字段时，它会在同一页面上显示详细信息。

```
<asp:HyperLinkField DataNavigateUrlFields="ID" 
                    DataNavigateUrlFormatString="My_Page.aspx?id={0}"
                    DataTextField="NAME" 
                    HeaderText="Item1" 
                    SortExpression="NAME" /> 
```

我想知道如何找到单击超链接的行的索引，因为我想更改其样式，以便用户知道单击了哪一行。

或者

当用户单击 gridview 中的超链接时，我将如何更改它的样式。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T17:26:51.757

在您的示例中，单击的超链接的“索引”或更确切地说是“id”将在 Request.QueryString["id"]

您可以将查询字符串中的 ID 与您在 RowDataBound 事件中绑定到的行的 ID 进行比较。

或者，您可以在 aspx 中使用 <%# DataBinder.Eval %> 根据 ID 字段和查询字符串设置样式。

编辑：代码示例，尝试将其添加到您的代码后面。

```
 protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            if(Request.QueryString["id"] != null &&
                Request.QueryString["id"] == DataBinder.Eval(e.Row.DataItem, "id").ToString())
            {
                e.Row.Style.Add("font-weight", "bold");
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-19T18:56:25.503

这是一个示例，当您在所选节点的 Gridview 子项上选择一行时，会显示在同一 gridview 中：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        LocationIDHiddenField.Value = Request.QueryString["LocationID"];
    }
    if (LocationIDHiddenField.Value != null && LocationIDHiddenField.Value != string.Empty)
        LoadLocationParents();
}

private void LoadLocationParents()
{
    long locationID = Convert.ToInt64(LocationIDHiddenField.Value);
    bool IsCurrent = true;
    HyperLink parent;        
    Label seperator;
    do
    {
        Basic.Location.LocationProperties location = Basic.Location.LocationLoader.GetLocationProperties(locationID);
        parent = new HyperLink();
        seperator = new Label();
        if (!IsCurrent)  
            parent.NavigateUrl = string.Format("LOCATIONLOV.aspx?LocationID={0}", location.LocationID);
        IsCurrent = false;
        parent.Text = location.LocationTitle;
        seperator.Text = "  >  ";
        ParentsPanel.Controls.AddAt(0, parent);
        ParentsPanel.Controls.AddAt(0, seperator);
        locationID = location.ParentID;     
    }
    while (locationID != 0);
    parent = new HyperLink();
    parent.NavigateUrl = "LOCATIONLOV.aspx";
    parent.Text = "upper nodes";
    ParentsPanel.Controls.AddAt(0, parent);
} 
```

网格视图

```
<asp:GridView ID="ChildsGridView" runat="server" AutoGenerateColumns="False" DataKeyNames="LocationID"
                        DataSourceID="ChildsObjectDataSource" Width="570px" AllowPaging="True">
                        <Columns>
                            <asp:TemplateField>
                                <HeaderTemplate>
                                    &nbsp;
                                </HeaderTemplate>
                                <ItemStyle Width="20px" />
                                <ItemTemplate>
                                    <a onclick="if ('<%# Eval("ChildCount") %>' == 'False') return false;" href='<%# Eval("LocationID", "LOCATIONLOV.aspx?LocationID={0}") %>' ><asp:Image  ID="GridLocationLov" runat="server" ToolTip="Expand" SkinID="LOVChilds" /></a> 
                                </ItemTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderText="Title" SortExpression="LocationTitleType">
                                <ItemTemplate>
                                    <span class="LOVSelectText" onclick="LOCATIONID = '<%# Eval("LocationID") %>'; LOCATIONTITLE = <%= ConfirmTextBox.ClientID %>.value = '<%# Eval("LocationTitle") %>';ChangeSelectedRow(this);">
                                        <%# Eval("LocationTitleType")%>
                                    </span>
                                </ItemTemplate>
                                <HeaderTemplate>
                                    <asp:Label ID="GridHeadLabel" runat="server" OnLoad="GridHeadLabel_Load"></asp:Label>
                                </HeaderTemplate>
                            </asp:TemplateField>
                        </Columns>
                        <EmptyDataTemplate>
                         NO CHild
                        </EmptyDataTemplate>
                    </asp:GridView> 
```

数据源

```
<asp:ObjectDataSource ID="ChildsObjectDataSource" runat="server" OldValuesParameterFormatString="original_{0}"
    SelectMethod="Retrive" TypeName="BASIC.LOCATIONLOV.LOCATIONLOVLoader">
    <SelectParameters>
        <asp:ControlParameter ControlID="LocationIDHiddenField" Name="ParentID" PropertyName="Value"
            Type="Int64" />
        <asp:Parameter DefaultValue="LocationTitle" Name="SortExpression" Type="String" />
    </SelectParameters>
</asp:ObjectDataSource>
<asp:HiddenField ID="LocationIDHiddenField" runat="server" /> 
```

JavaScript

```
function ChangeSelectedRow(sender)
{
    if (SelectedRow != null)
        SelectedRow.style.backgroundColor = OriginalColor;
    SelectedRow = sender.parentElement.parentElement;
    OriginalColor = SelectedRow.style.backgroundColor;
    SelectedRow.style.backgroundColor = 'red';
} 
```

# objective-c - Rounding numbers in Objective-C

> ID：752817
> 
> 赞同：76
> 
> 时间：2009-04-15T17:25:33.227
> 
> 标签：objective-c, cocoa, macos, formatting, rounding

I'm trying to do some number rounding and conversion to a string to enhance the output in an Objective-C program.

I have a float value that I'd like to round to the nearest .5 and then use it to set the text on a label.

For example:

1.4 would be a string of: 1.5

1.2 would be a string of: 1

0.2 would be a string of: 0

I've spent a while looking on Google for an answer but, being a noob with Objective-C, I'm not sure what to search for! So, I'd really appreciate a pointer in the right direction!

Thanks, Ash

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-04-15T22:06:46.593

Thanks for the pointers everyone, I've managed to come up with a solution:

```
float roundedValue = round(2.0f * number) / 2.0f;
NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
[formatter setMaximumFractionDigits:1];
[formatter setRoundingMode: NSNumberFormatterRoundDown];

NSString *numberString = [formatter stringFromNumber:[NSNumber numberWithFloat:roundedValue]];
[formatter release]; 
```

The above works for the test cases I threw at it, but if anyone knows a better way to do this I'd be interested to hear it!

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2013-09-18T09:08:06.817

```
float floatVal = 1.23456; 
```

**Rounding**

```
int roundedVal = lroundf(floatVal); 

NSLog(@"%d",roundedVal); 
```

**Rounding Up**

```
int roundedUpVal = ceil(floatVal); 

NSLog(@"%d",roundedUpVal); 
```

**Rounding Down**

```
int roundedDownVal = floor(floatVal);

NSLog(@"%d",roundedDownVal); 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-04-15T18:48:13.950

```
NSString *numberString = [NSString stringWithFormat:@"%f", round(2.0f * number) / 2.0f]; 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-07-21T09:48:01.827

Use lroundf() to round a float to integer and then convert the integer to a string.

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-06-16T06:02:02.740

```
NSString *numberString = [NSString stringWithFormat:@"%d",lroundf(number)]; 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-15T17:53:40.447

I'd recommend looking into using [NSNumberFormatter](http://developer.apple.com/documentation/Cocoa/Conceptual/DataFormatting/Articles/dfNumberFormatting10_4.html#//apple_ref/doc/uid/TP40002368 "NSNumberFormatter").

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-02-27T09:03:57.227

a simple way:

```
float theFloat = 1.23456;
int rounded = roundf(theFloat); NSLog(@"%d",rounded);
int roundedUp = ceil(theFloat); NSLog(@"%d",roundedUp);
int roundedDown = floor(theFloat); NSLog(@"%d",roundedDown);
// Note: int can be replaced by float 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-02-06T11:37:19.557

```
NSString *intNumberString = [NSString stringWithFormat:@"%d", (int)floatNumber]; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-12-17T08:31:38.193

Following Technique worked for me in a financial application.

```
 NSString *dd=[NSString stringWithFormat:@"%0.2f",monthlyPaymentCalculated];

        monthlyPaymentCalculated=[dd doubleValue];

self.monthlyPaymentCritical=monthlyPaymentCalculated; 
```

what is did is first is rounded it with %0.2f and stored it in NSString then i simply converted it again into double and result was good for my calculation.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-08-05T10:00:20.057

With these functions you can round to any value.. If you use p=2, you get even numbers.

```
float RoundTo(float x, float p)
{
  float y = 1/p;
  return int((x+(1/(y+y)))*y)/y;
}

float RoundUp(float x, float p)
{
  float y = 1/p;
  return int((x+(1/y))*y)/y;
}

float RoundDown(float x, float p)
{
  float y = 1/p;
  return int(x*y)/y;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-04-15T10:43:43.747

I needed to be able to round to a specific digit (not necessarily to whole integers). I made a `NSNumber` category (based off [Ash's answer](https://stackoverflow.com/a/753928/347339)) and added the following method to it:

```
- (NSString *)stringByRounding:(NSNumberFormatterRoundingMode)roundingMode
      toPositionRightOfDecimal:(NSUInteger)position
{
    NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
    [formatter setMaximumFractionDigits:position];
    [formatter setRoundingMode:roundingMode];
    NSString *numberString = [formatter stringFromNumber:self];
    return numberString;
} 
```

Which allows me to use it like so:

```
[aNumber stringByRounding:NSNumberFormatterRoundUp toPositionRightOfDecimal:2]; 
```

I can use it to round to integers by passing in `0` as the second parameter:

```
[aNumber stringByRounding:NSNumberFormatterRoundPlain toPositionRightOfDecimal:0]; 
```

# macos - find 缺少选项 -printf，现在怎么办？

> ID：752818
> 
> 赞同：64
> 
> 时间：2009-04-15T17:25:43.507
> 
> 标签：macos, find, printf

我还没有找到 Mac 的 find 没有选项 -printf 的原因。苹果通常决定去掉与其他命令不正交的选项？

**在没有 coreutils的情况**下，如何在 Mac 中达到与以下命令相同的结果？****

 **```
find . -printf "%i \n"         // command in Ubuntu 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-04-15T17:41:15.670

并不是 Apple 删除了选项，而是 OS X 的 UNIX 基础大多（迂回地）从 FreeBSD 派生，其中许多部分可以追溯到最初的 UNIX……而不是 GNU 实用程序，后者是用添加了许多功能。

在这种情况下，[FreeBSD`find(1)`](http://www.freebsd.org/cgi/man.cgi?query=find&section=1)不支持`-printf`，所以我也不希望 OS X 支持。相反，这应该适用于 BSD-ish 系统：

```
find . -print0 | xargs -0 stat -f '%i ' 
```

但是，它会在 GNU-userland 系统上失败，因为你会在其中编写，`xargs -0 -r stat -c '%i '`因为行为不同。`xargs(1)``stat(1)`

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2015-08-30T05:39:58.573

MAC OS X find binary 不支持 -printf 命令。`brew install findutils`在你的 Mac 上安装。此安装`gfind`带有`-printf`选项。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-04-15T18:17:47.987

嗯，[ehemient](https://stackoverflow.com/questions/752818/why-does-macs-find-not-have-the-option-printf/752893#752893)和[bendin](https://stackoverflow.com/questions/752818/why-does-macs-find-not-have-the-option-printf/752905#752905)确定了原因。

我要补充一点，如果你需要的话，没有什么能阻止你安装 GNU find （来自[findutils ）。](http://www.gnu.org/software/findutils/findutils.html)如果你使用[fink](http://www.finkproject.org/)有一个[`findutils`包](http://pdb.finkproject.org/pdb/browse.php?summary=findutils)。[MacPorts](http://www.macports.org/)也[有](http://trac.macports.org/browser/trunk/dports/sysutils/findutils/Portfile)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-08-06T15:58:06.550

或者，你可以只是

```
find . -type f -exec stat -f "%z %N" {} \; 
```

当然，这不是你在 linux 上做同样事情的方式，但适用于 MacOS

```
find . -type f -exec stat -c "%s %N" {} \; 
```

在 linux 上产生类似（不一样，但接近）的输出。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-15T17:44:30.810

Ubuntu 附带了[GNU 版本的 find](http://www.gnu.org/software/findutils/)，它比 Mac OS X 的 find 具有更多功能，后者是[BSD](http://www.bsd.org/)血统。

事实上，大多数 Ubuntu 的用户级实用程序都来自 GNU 项目。（因此您有时会听到基于 Linux 的系统被称为“GNU/Linux”。）

# database - 对于 Postgres (Windows)，有没有像 TOAD 一样好的东西？

> ID：752820
> 
> 赞同：27
> 
> 时间：2009-04-15T17:25:47.017
> 
> 标签：database, postgresql, toad

我只是在为 Postgres 寻找像 TOAD 这样的管理工具。有人用过好的吗？

编辑 - 我主要在数据本身内工作，并且数据库已经有成熟的模型/设计。我最常使用编辑窗口（好吧，无论如何，在 TOAD for Oracle 中。）

据我所知，Toad 只存在于：Oracle、MS SQL、DB2 和 MySQL ......

--JS

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T17:28:58.727

多个平台不存在 TOAD 吗？

到目前为止，我正在使用满足我需求的 pgAdmin III。

[http://www.pgadmin.org/](http://www.pgadmin.org/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-15T17:56:35.713

不确定特定数据库版本的 TOAD 是否与 Data Modeler 的 TOAD 有任何不同，但似乎[TOAD Data Modeler](http://www.toadsoft.com/toaddm/toad_data_modeler.htm)支持 PostgreSQL 以及其他一些版本。

如果您正在寻找类似 SQL Server Management Studio 的东西，但对于 Postgres，[EMS SQL Manager](http://sqlmanager.net/products/postgresql/manager)或[Lightning Admin](http://www.lightningadmin.com/)怎么样？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-04-16T07:08:27.083

请参阅 wiki：[http ://wiki.postgresql.org/wiki/Community_Guide_to_PostgreSQL_GUI_Tools](http://wiki.postgresql.org/wiki/Community_Guide_to_PostgreSQL_GUI_Tools)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-28T16:40:41.667

[TOra](http://torasql.com/about)有一些不错的功能，应该很像 TOAD。此外，它完全是 GPL，因此您可以自己更改代码。

顺便说一句：Toad 不是开源软件，现在只是试用软件（必须每 120 天重新安装一次）。TOra 是开源的，所以你没有这些问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T19:41:55.803

我已经相当广泛和成功地使用了[Navicat ，但只在 Mac 上使用。](http://pgsql.navicat.com/ "Navicat")它有一个 Windows 实现，据我所知，它比 Mac 实现功能更丰富。

我遇到了奇怪的数据输入问题，但是，如果您不进行数据建模，那对您来说可能不是问题

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-11-01T01:17:37.320

因为不需要编辑数据库设计，我建议使用[SQL Workbench/J](http://www.sql-workbench.net/)。它是Java应用程序。您可以使用 GUI 模式（我更喜欢）和控制台模式（如果您喜欢类似 psql 的命令控制台）。我使用这个应用程序比 pgAdmin III 或 pgAdmin 4 多得多，因为它可以帮助我轻松监控数据库活动、部署新版本的数据库应用程序等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T19:42:53.163

Navicat for PostgreSQL 对我来说非常好用。我为团队一般使用设置了 phppgAdmin，它非常有价值

# delphi - 在 Windows XP 中使用 Indy 10 发送带有内嵌图像的电子邮件时出现“SMTP 传入数据超时”

> ID：752822
> 
> 赞同：1
> 
> 时间：2009-04-15T17:26:04.350
> 
> 标签：delphi, email, windows-xp, smtp, indy

当我尝试在 Windows XP 中发送带有内联图像的电子邮件时收到错误“SMTP 传入数据超时”，我正在使用 Indy 10 的 tiburon 分支和以下代码发送带有内联图像的电子邮件：

```
 MB := TIdMessageBuilderHtml.Create;
    try
      MB.PlainText.Assign(Text);
      MB.Html.Assign(FHTML);
      MB.HtmlFiles.Add('c:\Path\to\My\Image.jpg');
      MB.FillMessage(IdMessage);
    finally
      MB.Free;
    end;

  if not IdSMTP.Connected then
    IdSMTP.Connect;
  IdSMTP.Send(IdMessage); 
```

它只是发生在 Windows XP 中，在 Windows Vista 中，电子邮件和内联图像发送得很好。

显然它没有向服务器发送任何内容，它似乎在发送之前卡住了图像。

这是调用堆栈：

```
 IdReplySMTP        497   +1 TIdReplySMTP.RaiseReplyError
 IdTCPConnection    574   +1 TIdTCPConnection.RaiseExceptionForLastCmdResult
 IdTCPConnection    724  +10 TIdTCPConnection.CheckResponse
 IdTCPConnection    563   +2 TIdTCPConnection.GetResponse
 IdTCPConnection    583   +4 TIdTCPConnection.SendCmd
 IdTCPConnection    696   +4 TIdTCPConnection.SendCmd
 IdSMTP             377   +2 TIdSMTP.DisconnectNotifyPeer
 IdTCPConnection    517   +5 TIdTCPConnection.Disconnect
 IdSMTP             476   +2 TIdSMTP.Disconnect
 IdTCPConnection    828   +2 TIdTCPConnection.Disconnect
 Email              130  +11 TEmail.Destroy
 System            9806   +1 TObject.Free
 EnviarEmail        322  +38 TFormEnviarEmail.Enviar
 System           12106  +38 @HandleFinally
                             RtlUnwind
 System           11589  +83 @HandleAnyException
                             KiUserExceptionDispatcher
                             RtlAppendUnicodeToString
 IdMessageClient    873   +4 EncodeAttachment
 IdMessageClient   1213 +252 TIdMessageClient.SendBody
 IdMessageClient   1244 +283 TIdMessageClient.SendBody
 IdMessageClient   1269  +12 TIdMessageClient.SendMsg
 IdSMTPBase         251   +6 TIdSMTPBase.SendNoPipelining
 IdSMTPBase         436   +4 TIdSMTPBase.InternalSend
 IdSMTPBase         457   +1 TIdSMTPBase.Send
 IdSMTP             415   +6 TIdSMTP.Send
 IdSMTPBase         449   +6 TIdSMTPBase.Send 
```

关于导致它的原因以及如何解决问题的任何线索？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T17:32:31.870

您是否确认您可以使用真正的邮件客户端发送相同的邮件，最好是一个简单便携且不集成到系统内部的邮件客户端，例如 Mozilla Thunderbird 或 Opera 包含的邮件客户端？那里可能有防病毒/反垃圾邮件/反任何系统干扰 - 其中许多透明地拦截传出的 25/TCP 并对数据进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T17:40:48.167

如果编码不是原因，而是读取超时，您可以使用 ReadTimeOut 属性增加它：

IdSMTP1.ReadTimeOut := 20000;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T19:06:40.067

问题解决了。

我正在解析一个 HTML 文件以加载图像并将它们附加到电子邮件中，但在 Windows XP 中，路径是：

```
C:\Documents And Settings\User\Desktop\.... 
```

在 html 文件中，这个路径是

```
C:\Documents%20And%20Settings\User\Desktop\.... 
```

因此，内部引发了 File not Found 异常并停止了进程，直到超时，而 Indy 并没有引发它。

在 Windows XP 机器上运行的进程中附加远程调试器后，我在第一次尝试时遇到了异常。

我认为印地“吞没”例外是不正确的，但那是另一段历史了。

# c++ - 在 Borland C++ Builder 4 中使用 .NET DLL 时遇到问题

> ID：752828
> 
> 赞同：1
> 
> 时间：2009-04-15T17:27:01.023
> 
> 标签：c++, interop, c++builder

我在 C# .NET 2.0 中创建了一个 COM 可调用 DLL，并使用 .NET regasm 工具从程序集中创建了一个 TLB。

在 Borland C++ Builder 4.0 中，我转到 Project->Import Type Library-> 并在那里找到我的 DLL 类型库，然后单击“Ok”将其导入。

BCB 创建一个 HardwareCheck_TLB.cpp & HardwareCheck_TLB.h 文件。

在项目的 cpp 文件中，我想使用放在顶部的 DLL：#include "HardwareCheck_TLB.h"。

然后在代码中，如果我尝试在代码中声明该类型的对象： IHardwareCheck hc = new IHardwareCheck();

我收到以下编译器错误：[C++ 错误] Unit1.cpp(22): E2352 无法创建抽象类“IHardwareCheck”的实例。[C++ 错误] Unit1.cpp(22): E2353 类 'IHardwareCheck' 是抽象的，因为 '__stdcall IHardwareCheck::IsExpress(wchar_t * *,TOLEBOOL *) = 0'。

任何人有任何想法如何摆脱这个错误？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T21:18:11.597

无法使用 new 创建 COM 类。您需要使用 CoCreateInstance 系统调用（参见 MSDN）或 Borland 提供的一些包装器（例如 zer0_ring 提到的包装器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T18:59:31.453

它应该生成一些您可以执行的 TCoClassCreatorT<> 类型

```
CoHardwareCheck::Create(&hc) 
```

您可能需要查看 Borland 随其产品分发的 tlibimp.exe。我以前用那个程序经历过这个，但从来没有能够生成 Co 类，也许你会有更好的运气。

# asp.net-mvc - 在 IIS 6 上托管 ASP.NET MVC 时是否会失去功能？如果是这样，是什么？

> ID：752830
> 
> 赞同：5
> 
> 时间：2009-04-15T17:27:16.390
> 
> 标签：asp.net-mvc, iis, iis-7, iis-6

作为一个开发团队，我们希望切换到 asp.net MVC，我听说过有关 IIS 6 无法支持所有 MVC 功能的传言。这是真的？IIS 7 与 IIS 6 是否支持任何官方功能集？我们应该完全避免在 IIS6 上运行它吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T17:36:47.990

您不会丢失 ASP.Net MVC 的任何功能；但是，您有两种选择之一。您可以在您的 URL 上定义一个扩展，这将允许您设置映射。例如：

> www.example.com/books/computer/list

可能变成：

> www.example.com/books.mvc/computer/list

只要映射到 ASP.Net，就可以使用任何想要的扩展。我目前正在使用 .aspx，这意味着我可以避免更改 IIS 配置而牺牲具有无扩展名的 URL。

提到的另一个选项是使用通配符映射。它的作用是将所有请求路由到 ASP.Net。甚至请求静态内容，例如图像。这确实会对您想要衡量的性能产生负面影响。我相信有一些方法可以解决这个问题，例如将所有内容放在您关闭通配符映射的特定虚拟目录中，但我还没有完全探索该选项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T17:29:49.257

我认为 IIS6 的问题是您可以通过在 IIS 配置中添加通配符 ISAPI 映射轻松实现的无扩展 URL。

所以不行。虽然我喜欢 IIS7 集成模式并强烈推荐使用它，但您不会失去使用它的功能。我在 Windows Server 2003/IIS6 上部署了几个 ASP.NET MVC 1.0 项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-24T06:19:33.043

网址重写可以帮助您解决问题。我已经实现了允许在任何 IIS 版本上部署 MVC 应用程序的解决方案，即使使用虚拟主机也是如此。 [http://www.codeproject.com/KB/aspnet/iis-aspnet-url-rewriting.aspx](http://www.codeproject.com/KB/aspnet/iis-aspnet-url-rewriting.aspx)

# windows - 将 32 位应用程序安装到 C:\Program Files\ 而不是 C:\Program Files(x86)\ 会有什么负面影响？

> ID：752844
> 
> 赞同：1
> 
> 时间：2009-04-15T17:29:21.317
> 
> 标签：windows, 64-bit, 32-bit

*将旧版 32 位应用程序安装到C:\Program Files*而不是*C:\Program Files(x86)*会有什么负面影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-26T16:43:40.680

根据您的应用程序的功能，它可能会导致问题。

例如，如果您的应用程序查询 Program Files 文件夹，WOW 仿真层将返回 Program Files (x86)。因此，如果您试图查找与安装位置相关的内容，您将失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T17:34:08.700

没有任何。我相信这两个文件夹仅用于组织目的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T17:34:35.810

我不认为这很重要。您可以从桌面、外部驱动器等运行 64 位，就像运行 32 位应用程序一样。我认为差异纯粹是为了组织。

或者说您正在开发 32 位和 64 位版本的应用程序，您可以安装它们并通过将它们放在单独的 Program Files 文件夹中并排运行它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T17:36:22.827

没有任何。我一直这样做，从未遇到任何不良影响。我相信这纯粹是组织性的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T17:34:10.070

如果您要安装的应用程序没有 64 位并行版本，则可能没有。

如果它有并且您决定安装它，默认情况下（如果它使用相同的文件夹名称）它将覆盖现有的 32 位应用程序。

# jquery - 切换/切换 div (jQuery)

> ID：752847
> 
> 赞同：19
> 
> 时间：2009-04-15T17:29:41.657
> 
> 标签：jquery, html, switch-statement, toggle

我希望完成一个相当简单的任务（我希望！）

我有两个 div 标签和一个锚标签，如下所示：

```
<a href="javascript:void(0);">forgot password?</a>
<div id="login-form"></div>
<div id="recover-password" style="display:none;"></div> 
```

我希望使用锚标签在两个 div 标签之间切换，隐藏一个并显示另一个，反之亦然。

如何以最好的方式做到这一点？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-15T17:44:22.857

由于一个 div 最初是隐藏的，您可以简单地为两个 div调用[toggle ：](http://docs.jquery.com/Effects/toggle)

```
<a href="javascript:void(0);" id="forgot-password">forgot password?</a>
<div id="login-form">login form</div>

<div id="recover-password" style="display:none;">recover password</div>

<script type="text/javascript">
$(function(){
  $('#forgot-password').click(function(){
     $('#login-form').toggle();
     $('#recover-password').toggle(); 
  });
});
</script> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T17:45:37.453

我想你想要这个：

```
$('#recover-password').show(); 
```

或者

```
$('#recover-password').toggle(); 
```

jQuery 使这成为可能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T17:53:19.200

用这个：

```
<script type="text/javascript" language="javascript">
    $("#toggle").click(function() { $("#login-form, #recover-password").toggle(); });
</script> 
```

您的 HTML 应如下所示：

```
<a id="toggle" href="javascript:void(0);">forgot password?</a>
<div id="login-form"></div>
<div id="recover-password" style="display:none;"></div> 
```

嘿，好吧！一条线！我 <3 jQuery。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-30T09:45:15.287

这就是我`div`同时切换两个 s 的方式：

```
$('#login-form, #recover-password').toggle(); 
```

有用！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T17:42:25.933

您可以编写一个简单的 jQuery 插件来执行此操作。该插件看起来像：

```
(function($) {
    $.fn.expandcollapse = function() {
        return this.each(function() {
            obj = $(this);
            switch (obj.css("display")) {
                case "block":
                    displayValue = "none";
                    break;

                case "none":
                default:
                    displayValue = "block";
            }

            obj.css("display", displayValue);
        });
    };
} (jQuery)); 
```

然后将插件连接到锚标记的点击事件：

```
$(document).ready(function() {
    $("#mylink").click(function() {
        $("div").expandcollapse();
    });
}); 
```

如果您将每个 div 的初始“显示”属性分别设置为“阻止”和“无”，则它们应该在单击链接时切换为显示/隐藏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-14T17:49:54.407

我认为这有效：

```
$(document).ready(function(){

    // Hide (collapse) the toggle containers on load
    $(".toggle_container").hide();

    // Switch the "Open" and "Close" state per click then 
    // slide up/down (depending on open/close state)
    $("h2.trigger").click(function(){
        $(this).toggleClass("active").next().slideToggle("slow");
        return false; // Prevent the browser jump to the link anchor
    });
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-23T10:02:09.277

试试这个：[http ://www.webtrickss.com/javascript/jquery-slidetoggle-signup-form-and-login-form/](http://www.webtrickss.com/javascript/jquery-slidetoggle-signup-form-and-login-form/)

َََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََََ

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-17T18:07:04.957

我使用这种方式对多个块执行此操作，而无需使用新的 JavaScript 代码：

```
<a href="#" data-toggle="thatblock">Show/Hide Content</a>

<div id="thatblock" style="display: none">
  Here is some description that will appear when we click on the button
</div> 
```

然后是所有此类情况的 JavaScript 部分：

```
$(function() {
  $('*[data-toggle]').click(function() {
    $('#'+$(this).attr('data-toggle')).toggle();
    return false;
  });
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-10-18T07:14:44.873

```
function toggling_fields_contact_bank(class_name) {
    jQuery("." + class_name).animate({
        height: 'toggle'
    });
} 
```

# hibernate - 尝试在我的 build.xml 中运行休眠工具时，为什么会出现错误“只能从 URI 中找到 antlib URI，而不是 URI”

> ID：752851
> 
> 赞同：3
> 
> 时间：2009-04-15T17:30:10.113
> 
> 标签：hibernate, jpa, ant, hibernate-tools

我正在尝试在 ant 构建中运行休眠工具以从我的 JPA 注释生成 ddl。Ant 死在 taskdef 标签上。我尝试过使用 ant 1.7、1.6.5 和 1.6 无济于事。我在eclipse和外面都试过了。我已经尝试在 hibernate-tools 路径中包含所有 hbn jar，而不是。请注意，我的构建文件基于这篇文章：

[Hibernate JPA 到 DDL 命令行工具](https://stackoverflow.com/questions/281890/hibernate-jpa-to-ddl-command-line-tools)

我在 Ubuntu 8 上运行带有 WTP 3.0.1 和 MyEclipse 7.1 的 eclipse 3.4。

构建.xml：

```
<project name="generateddl" default="generate-ddl">

<path id="hibernate-tools">
    <pathelement location="../libraries/hibernate-tools/hibernate-tools.jar" />
    <pathelement location="../libraries/hibernate-tools/bsh-2.0b1.jar" />
    <pathelement location="../libraries/hibernate-tools/freemarker.jar" />
    <pathelement location="../libraries/jtds/jtds-1.2.2.jar" />
    <pathelement location="../libraries/hibernate-tools/jtidy-r8-20060801.jar" />

</path>

<taskdef classname="org.hibernate.tool.ant.HibernateToolTask" classpathref="hibernate-tools"/>

<target name="generate-ddl" description="Export schema to DDL file"> 
<!-- compile model classes before running hibernatetool -->

    <!-- task definition; project.class.path contains all necessary libs 
    <taskdef name="hibernatetool" classname="org.hibernate.tool.ant.HibernateToolTask" classpathref="project.class.path" />
    -->

    <hibernatetool destdir="sql"> 

        <!-- check that directory exists -->
        <jpaconfiguration persistenceunit="default" />

        <classpath>

            <dirset dir="WebRoot/WEB-INF/classes">
                <include name="**/*"/>
            </dirset>
        </classpath>

        <hbm2ddl outputfilename="schemaexport.sql" format="true" export="false" drop="true" />
    </hibernatetool>
</target> 
```

```
Error message (ant -v):

    Apache Ant version 1.7.0 compiled on December 13 2006
Buildfile: /home/joe/workspace/bento/ant-generate-ddl.xml
parsing buildfile /home/joe/workspace/bento/ant-generate-ddl.xml with URI = file:/home/joe/workspace/bento/ant-generate-ddl.xml
Project base dir set to: /home/joe/workspace/bento
[antlib:org.apache.tools.ant] Could not load definitions from resource org/apache/tools/ant/antlib.xml. It could not be found.

BUILD FAILED
/home/joe/workspace/bento/ant-generate-ddl.xml:12: Only antlib URIs can be located from the URI alone,not the URI 
    at org.apache.tools.ant.taskdefs.Definer.execute(Definer.java:216)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:357)
    at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:140)
    at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.parseBuildFile(InternalAntRunner.java:191)
    at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.run(InternalAntRunner.java:400)
    at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.main(InternalAntRunner.java:137)

Total time: 195 milliseconds 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T07:03:45.397

根据[`typedef`任务文档](http://ant.apache.org/manual/Tasks/typedef.html)（[`taskdef`任务](http://ant.apache.org/manual/Tasks/taskdef.html)是其中的一种形式），`name`如果您没有指定“文件或资源类型属性”，则该属性是必需的。

我不确定修复它是否会解决您的问题，但如果您能消除它成为潜在原因，那就太好了。

# security - 允许用户嵌入视频的主要安全问题

> ID：752859
> 
> 赞同：1
> 
> 时间：2009-04-15T17:31:58.843
> 
> 标签：security, defensive-programming

我希望允许用户在开发中自由地在应用程序中嵌入视频，但不想将应用程序暴露给恶意使用。

考虑到这一点，允许用户嵌入来自外部资源（如 YouTube、Vimeo 等）的视频的主要安全问题是什么（XSS 等）。可以通过哪些方式使用这些漏洞？在接受/显示嵌入视频之前，你们建议应用哪种清理方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T17:38:03.527

好吧，一旦您允许 Flash 应用程序出现在您的网站上，它就可以在客户端上执行您无法控制的任意数量的事情，特别是因为您可以使用 Flash 执行 JavaScript（有限制）。最好是使用白名单，并且只允许用户从您信任的地方嵌入视频。

# html - 出现在我的 ASP 页面中的 PostInfo 元标记是什么？

> ID：752861
> 
> 赞同：1
> 
> 时间：2009-04-15T17:32:25.770
> 
> 标签：html, asp-classic

我有一个看起来像这样的标签：

```
<meta name="postinfo" content="/scripts/postinfo.asp"> 
```

这出现在我的 default.asp 中的经典 ASP 应用程序中。

它是什么，我可以删除它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T17:37:42.700

这是 Microsoft Posting Acceptor 使用的元标记。[您可以在此自述文件](http://www.prof2000.pt/users/softwareservidor/ntoptionpacknt4/pareadme.htm)中找到更多信息。希望这可以帮助！

# c# - 使用内部调制解调器在 2 个远程系统之间传输文件

> ID：752864
> 
> 赞同：-1
> 
> 时间：2009-04-15T17:33:42.100
> 
> 标签：c#, c++, modem, file-transfer

**我的要求是编写一个应用程序来使用内部调制解调器将文件从远程机器发送到另一台机器。两个系统都通过 VPN 或互联网连接。**

基本上我们有两个系统都有内部拨号调制解调器。这两个系统通过 VPN 或 Internet 连接。

一个系统应该向另一个系统发送文件 (XML)。

我被赋予了使用 C++ 或 C# 的自由。或者有没有其他语言我们可以轻松做到这一点？

我怎样才能完成这项任务？我们需要客户端/服务器类型的应用程序还是只需要接收端的应用程序？

是否有任何内置技术可用于使用调制解调器进行此类文件传输？

由于我没有编程的观点，我的问题可能不清楚！我试图将最大信息放在我的要求上，但如果我不清楚，请问我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T17:37:39.347

如果您通过 VPN 连接，则有许多现有程序可用于在彼此之间传输文件。最著名的是FTP。有许多免费提供的 FTP 或 SFTP 包。

您正在使用调制解调器这一事实并不重要。只是它们在同一个网络中或在 Internet 上可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T18:34:20.770

时间久了，记忆模糊了：

那里有调制解调器库。找到一个并使用它。无需重新发明低级软件。我似乎记得使用了 Dialogic 的产品（至少我认为那是公司）。它运作良好。我快速搜索了一下，有 50 家公司使用这个名字，但我确实看到了一些提到 C、C++ 和 C# 库的公司。如果你做一点研究，你会发现你需要什么。

您将需要学习如何启动调制解调器之间的通信。几乎所有调制解调器都使用 Hayes 调制解调器 AT 命令集。

调制解调器很慢：所以在发送数据之前选择一种压缩算法。zlib 是业界的最爱。

您选择的调制解调器库应提供多种机制来进行您所询问的纯数据传输。选择最适合您的数据的一种。

# visual-studio-2008 - 打开项目属性时 Visual Studio 2008 崩溃

> ID：752885
> 
> 赞同：12
> 
> 时间：2009-04-15T17:39:25.223
> 
> 标签：visual-studio-2008, crash

我有一个在 Visual Studio 2008 中开发的多项目 .NET 应用程序。如果我尝试打开我的一个项目的项目属性（更改设置或发布），Visual Studio 会立即关闭。没有提示向 Microsoft 发送报告，并且在事件查看器中记录了两个连续错误：

*   .NET 运行时版本 2.0.50727.3053 - 致命的执行引擎错误 (7A035E00) (80131506)
*   .NET 运行时版本 2.0.50727.3053 - 致命的执行引擎错误 (7A2E0F92) (0)

如果我删除解决方案中的所有文件`.user`，`.suo`我可以再次发布和访问项目属性。但是，该错误会随着时间的推移而返回。这似乎表明`.suo`或`.user`文件被 Visual Studio 损坏了。有没有其他人遇到过这个问题或知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T17:42:38.507

关闭所有加载项，然后重试。使用工具-> 插件管理器。

如果这没有帮助，请`devenv /safemode`从 Visual Studio 命令提示符窗口使用“安全模式”运行 VS。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-04-10T18:12:49.880

我删除了项目文件夹中具有以下扩展名的文件（我不知道哪个重要...）-> suo，user，cachefile

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T17:42:25.323

看起来像是影响加载项的 CLR 中的错​​误（请参阅[此处](http://social.msdn.microsoft.com/Forums/en-US/vssetup/thread/cb73c8d6-077f-4220-aaf8-463039ee1d5f/)）。您是否正在运行任何加载项，是否已将 Visual Studio 和 .NET 框架更新到最新的服务包？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-21T14:06:32.003

我不知道问题的真正原因，但我可以通过***File -> Source Control -> Refresh status修复它***

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-15T16:45:11.487

当我尝试打开项目属性时，VS2008 会消失。最后通过对解决方案进行清理来解决它。当治愈（至少在我的情况下）如此简单（-:)时，许多小时的挫败感被浪费了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-01T08:02:46.880

打开项目属性时会导致 Visual Studio 崩溃。我发现清理和 ++not** 重建解决方案可靠地工作。我没有附加组件，但对 WPF 进行了编程，并且在 WPF/vs 方面遇到了很多问题，不想合作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-03T20:37:50.117

我今天遇到了类似的问题，通过卸载 Visual Studio 2008 的 Power Commands 解决了。如果您安装了这个，我建议删除它并重试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-16T22:54:30.333

我有完全相同的问题。每次我打开项目属性或资源文件（.resx）时，vs2008 都会停止响应，任务管理器会将 cpu 利用率显示为 100%。我通过删除解决方案文件夹中的 .suo 文件解决了这个问题，并从源代码管理中获取了一个新副本，然后从 VS2008 命令提示符中输入了 "devenv /resetskippkgs" 。这重新启动了 VS2008，我可以打开我的资源文件以及项目属性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-14T05:47:00.013

是的，我经历过很多次。如果我删除所有视图私有文件（我们在这里使用 ClearCase），包括 .suo 和 .user，问题就会消失。

# asp-classic - 如何引用 Windows 内置的 PDF IFilter (dll) 接口以通过经典 ASP 提取 pdf 文档的文本和属性

> ID：752886
> 
> 赞同：0
> 
> 时间：2009-04-15T17:39:27.063
> 
> 标签：asp-classic, ifilter, pdf-parsing

我想提取 PDF 文件的文本和属性（作者、标题等）。

我需要在经典的 ASP 环境中从 pdf 文件中提取和解析文本。我阅读了另一篇关于使用随 Adob​​e Acrobat 9 安装的 PDF iFilter 驱动程序的文章，该驱动程序可以通过 COM 引用。

这可能吗？如果是这样，我该如何开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T17:51:01.047

如果您知道 COM 类名或 clsid，您应该能够使用 Server.CreateObject() 来获取实例。然后，您应该能够在其上调用[IFilter](http://msdn.microsoft.com/en-us/library/ms691105.aspx) 方法。

# java - 如何使用通用访问卡连接到 HTTPS 服务器

> ID：752890
> 
> 赞同：9
> 
> 时间：2009-04-15T17:40:40.697
> 
> 标签：java, security, jaas, cac

我需要编写一个 java 程序来连接到 HTTPS 服务器（DoD 网站）。该网站需要 CAC（DoD 通用访问卡）身份验证。如果您通过浏览器访问此站点，请先插入您的 CAC，然后输入 PIN。

我需要在 java 中以编程方式完成身份验证过程（有点像浏览器）。如何从 CAC 检索信息？我一直在谷歌搜索并阅读 Java PKCS#11 参考指南。似乎 Sun PKCS#11 Provider 可以做到，但您需要本机 PKCS#11 令牌实现。

我对吗？以前有人做过吗？任何建议或意见将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T18:46:35.593

首先，您需要安装 PKCS #11 支持。这是您的读卡器可能附带的一些本机代码，它提供了一个提供 PKCS #11 接口的 .dll（或 .so）。系统上的其他软件，如 Mozilla 产品和 Sun 的 PKCS #11 提供程序，使用这个库。（Microsoft 产品通常使用不同的接口“CAPI”。）

然后，按照[PKCS #11 参考指南中的说明，](http://java.sun.com/j2se/1.5.0/docs/guide/security/p11guide.html)设置`SunPKCS11`提供程序。我必须在我的设置中提供的唯一属性是已安装的本机“库”的位置，以及此提供程序的“名称”后缀。“name”属性附加到“SunPKCS11-”，因此如果您指定“CAC”作为名称，您可以`Provider`使用`Security.getProvider("SunPKCS11-CAC")`.

然后，您可以使用标准 JSSE 系统属性`javax.net.ssl.keyStore`（值为`"NONE"`）和`javax.net.ssl.keyStoreType`（值为`"PKCS11"`）让 JSSE 访问 CAC 上的密钥材料。您无需设置密码属性，因为本机代码应在需要时提示用户输入 PIN。

需要注意的是，只有用户的“最终实体”证书可从 CAC 获得。为了构建可信链，大多数服务器都希望客户端发送任何中间证书。解决这个问题是可能的，但很复杂，因为它涉及实现您自己的`javax.net.ssl.X509KeyManager`. 如果您正在使用的服务器需要完整的链，请发布后续问题。

# delphi - 如何隐藏 TRibbon 页面？

> ID：752902
> 
> 赞同：2
> 
> 时间：2009-04-15T17:43:45.960
> 
> 标签：delphi, delphi-2009, vcl, ribbon

我正在使用 delphi 2009 的 TRibbon 组件。根据应用程序状态，某些页面不相关。如何隐藏 TRibbon 页面？

RibbonPage1.Visible:=false 并没有真正隐藏页面......

微软的规范可能不允许这样做吗？

谢谢你的帮助！mp

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T08:28:30.827

我不认为您可以隐藏各个功能区页面，但您可以隐藏或禁用每个[页面](http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/delphivclwin32/Ribbon_TRibbonGroup.html)上的各个功能区组。

```
RibbonGroup1.Enabled := false; 
RibbonGroup2.Visible := false; 
```

Microsoft Office 禁用与当前状态无关的任何组。查看文档中的这些文章以获得更多帮助。

*   [创建使用功能区控件的应用程序](http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/devwin32/win32_ribboncontrols_xml.html)
*   [向功能区添加命令](http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/devwin32/win32_ribboncontrols2_xml.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-24T12:50:58.763

你目前不能这样做。需要支持可见性的是选项卡（而不是页面），而它们根本不需要。

如果您尝试自己操作选项卡，您会发现代码非常依赖于维护页面和选项卡之间的链接，以至于破坏您的页面。我不认为有一个好的解决方法。

[在Quality Central](http://qc.embarcadero.com/wc/qcmain.aspx)中将其注册为错误。支持“上下文”感知选项卡/页面绝对是应该支持的。我想很多其他人会投票给它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-19T19:29:23.863

事实上，这是唯一一个被那个 borland 废话正确处理的隐藏/显示的事情。

MainRibbon.RemoveTab('TabName');

我现在正在搜索如何隐藏组和个人操作。Visible = false 不行，尝试将您的表单调整为更小并且处于折叠状态的所有内容仍然存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-21T13:12:52.817

也许，试试这个：RibbonPage1.Free;

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-15T15:58:40.707

试试这个：（德尔福XE6）

```
MainRibbon.Tabs[RibbonPage.Index].Visible := FALSE; 
```

然后你可以让它再次可见

```
MainRibbon.Tabs[RibbonPage.Index].Visible := TRUE; 
```

# javascript - 将 iframe 粘贴到底部

> ID：752903
> 
> 赞同：1
> 
> 时间：2009-04-15T17:44:21.607
> 
> 标签：javascript, jquery, iframe

我有一个 iframe，其中包含一个不断更新的页面（基本上是一个记录器类型的东西）。有没有办法（通过 JS/jQuery 或其他方式）强制 iframe 即使在它展开时也粘在该内页的底部？

我基本上想模仿日志查看器在更新时可能会粘在日志文件尾部的方式。我已经在这里找到了一个类似的问题，但是该解决方案似乎在 iframe 上下文中不起作用（[类似问题](https://stackoverflow.com/questions/13362/scrolling-overflowed-divs-with-javascript)）。

**更新：**澄清一下，我不希望页面底部有 iframe。我希望 iframe 中的内容*保持*滚动到底部。iframe 具有固定的高度，在页面加载后，额外的行被添加到该内页，我想强制 iframe 始终显示该内页的底部。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T17:53:52.833

仅使用 CSS 即可实现

```
iframe{
   position: absolute;
   left: 0;
   bottom: 0;
} 
```

这将使 iframe 相对于正文定位，并且始终显示在底部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T19:24:58.340

iframe 是否保持刷新并添加内容.. 还是保持连接打开？如果它没有保持连接打开... document.scrollTo() 是您正在寻找的 javascript 方法.. 如果您使用 ajax 附加信息.. 做一个滚动到数字*非常*大的地方 0xFFFFFF 应该可以工作.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T18:00:03.567

也许`overflow:hidden`也在那里添加

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-20T11:18:13.610

页面底部的 iframe 仅在 HTML 中没有滚动条时有效，但随着 Y 轴的增加，它不会在页面底部移动。

# .net - WPF MVVM + UserControl 与后面的代码

> ID：752906
> 
> 赞同：0
> 
> 时间：2009-04-15T17:44:39.127
> 
> 标签：.net, wpf, mvvm, user-controls

出于某种原因，我在 MVVM WPF 应用程序中通过我的 ViewModel 绑定自定义用户控件时遇到问题。基本控件是一个带有三个文本框的日期输入表单。我正在使用用户控件的代码隐藏来捕获 textchange 事件以及一些操作。出于某种原因，向属性添加绑定永远不会触发。

用户控件的 XAML：

```
<UserControl x:Class="MYLibray.DateBox"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Height="300" Width="800">
<StackPanel>

    <Border CornerRadius="10" Height="200" BorderBrush="Gray" Background="Gray">
    <StackPanel Orientation="Horizontal" OpacityMask="{x:Null}" HorizontalAlignment="Center">
    <TextBox Name="txtMonth" Height="100" Width="90" BorderThickness="0,0,0,5" Background="{x:Null}" Text="" FontSize="72" TextChanged="TextChanged">
        <TextBox.BorderBrush>
            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                <GradientStop Color="#FF000000" Offset="0"/>
                <GradientStop Color="#FF000000" Offset="1"/>
            </LinearGradientBrush>
        </TextBox.BorderBrush>
    </TextBox>
            <TextBlock Text="/" FontSize="72" Height="100" Width="50" />
            <TextBox x:Name="txtDay" Height="100" Width="90" Background="{x:Null}" BorderThickness="0,0,0,5" VerticalAlignment="Stretch" FontSize="72" TextChanged="TextChanged">
                <TextBox.BorderBrush>
                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                        <GradientStop Color="#FF000000" Offset="0"/>
                        <GradientStop Color="#FF000000" Offset="1"/>
                    </LinearGradientBrush>
                </TextBox.BorderBrush>
            </TextBox>
            <TextBlock Text="/19" FontSize="72" Height="100" Width="Auto" />
            <TextBox x:Name="txtYear" Height="100" Width="90" Background="{x:Null}" BorderThickness="0,0,0,5"  FontSize="72" TextChanged="TextChanged">
                <TextBox.BorderBrush>
                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                        <GradientStop Color="#FF000000" Offset="0"/>
                        <GradientStop Color="#FF000000" Offset="1"/>
                    </LinearGradientBrush>
                </TextBox.BorderBrush>
            </TextBox>
    </StackPanel>
    </Border>

</StackPanel> 
```

代码隐藏：

```
public partial class DateBox : UserControl 
```

{

```
 private string _date = "";
  public static DependencyProperty TextProperty = DependencyProperty.RegisterAttached("DateText", typeof(string), typeof(DateBox), new PropertyMetadata(TextPropertyChanged));
  public static DependencyProperty EnabledProperty = DependencyProperty.RegisterAttached("Enabled", typeof(bool), typeof(DateBox), null);

  public DateBox()
  {                                 
     InitializeComponent();
     this.DataContext = this;
     txtMonth.Focus();
  }

  public bool Enabled
  {
     get
     {
        return (bool)GetValue(DateBox.EnabledProperty);
     }
     set
     {
        SetValue(DateBox.EnabledProperty, value);

        txtDay.IsEnabled = value;
        txtMonth.IsEnabled = value;
        txtYear.IsEnabled = value;
     }
  }

  public string DateText
  {
     get
     {
        return (string)this.GetValue(TextProperty);
     }
     set
     {
        this.SetValue(TextProperty, value);
     }
  }

  static void TextPropertyChanged(DependencyObject property,DependencyPropertyChangedEventArgs args)
  {
     ((DateBox)property).OnTextPropertyChanged((object)args.NewValue);
  }

  private void OnTextPropertyChanged(object newValue)
  {
     _date = newValue.ToString();
     this.UpdateLayout();
     DateTime d;
     if (DateTime.TryParse(_date, out d))
     {
        txtDay.Text = d.Day.ToString();
        txtMonth.Text = d.Month.ToString();
        txtYear.Text = (d.Year - 1900).ToString();
     }
     else
     {
        txtDay.Text = "";
        txtMonth.Text = "";
        txtYear.Text = "";
     }

     DateText = d.ToShortDateString();
  }

  bool AreAllValidNumericChars(string str)
  {
     bool ret = true;
     if (str == System.Globalization.NumberFormatInfo.CurrentInfo.PositiveSign)
     {
        return ret;
     }
     int l = str.Length;
     for (int i = 0; i < l; i++)
     {
        char ch = str[i];
        ret &= Char.IsDigit(ch);
     }

     return ret;
  }

  private void TextChanged(object sender, TextChangedEventArgs e)
  {

     TextBox txt = (TextBox)sender;

     switch (txt.Name)
     {
        case "txtMonth":
           if (txt.Text.Length == 1)
           {
              if (Convert.ToInt32(txt.Text) > 1)
              {
                 string value = txt.Text;
                 txt.Text = "0" + value;
                 txtDay.Focus();
              }
           }
           if (txt.Text.Length == 2)
           {
              txtDay.Focus();
           }
           break;
        case "txtDay":
           if (txt.Text.Length == 1)
           {
              if (Convert.ToInt32(txt.Text) > 3)
              {
                 string value = txt.Text;
                 txt.Text = "0" + value;
                 txtYear.Focus();
              }
           }
           if (txt.Text.Length == 2)
           {
              txtYear.Focus();
           }
           break;

        case "txtYear":
           if (txt.Text.Length == 2)
           {
              DateTime d;
              string datestring = txtMonth.Text + "/" + txtDay.Text + "/19" + txtYear.Text;
              if (DateTime.TryParse(datestring,out d))
              {
                 DateText = d.ToShortDateString();
              }
           }
           break;
        default:
           break;
     }
  } 
```

}

当我像这样在 DataTemplate 中创建用户控件时：

```
<uc:DateBox DateText="{Binding BirthDate}" /> 
```

我的 ViewModel 中的 BirthDate 的获取和设置永远不会设置。VM 上的 BirthDate 是一个字符串。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T18:12:00.900

检查`DataContext`控件和父级的。

要帮助调试绑定，请查看[Bea Stollnitz 的博客](http://www.beacosta.com/blog/?p=52)

基本上，将其添加`xmlns`到您的控件中

```
xmlns:diagnostics="clr-namespace:System.Diagnostics;assembly=WindowsBase" 
```

然后将此添加到您的`Binding`（s）

```
{Binding ....    , diagnostics:PresentationTraceSources.TraceLevel=High } 
```

# c - 在 C 中释放内存

> ID：752910
> 
> 赞同：0
> 
> 时间：2009-04-15T17:46:24.287
> 
> 标签：c, pointers, memory-leaks

我对这个小程序有问题：

***更新（根据一些要求，我在这里包含了所有内容，以便清楚我在做什么。抱歉它太长了）：*** **Student.h 文件：**

```
typedef struct Student {
  char *name;
  int age;
  char *major;
    char *toString;
} *Student;

extern Student newStudent(char *name, int age, char *major); 
```

**Student.c 文件：** c

```
har *studentToString(Student s);
static void error(char *s) {
  fprintf(stderr,"%s:%d %s\n",__FILE__,__LINE__,s);
  exit(1);
}

extern Student newStudent(char *name, int age, char *major) {
  Student s;
    if (!(s=(Student)malloc(sizeof(*s)))){
    error("out of memory");
    }
  s->name=name;
  s->age=age;
  s->major=major;
    s->toString = studentToString(s);
  return s;
}

char *studentToString(Student s) {
  const int size=3;
  char age[size+1];
  snprintf(age,size,"%d",s->age);

  char *line=newString();
  line=catString(line,"<");
  line=catString(line,s->name);
  line=catString(line," ");
  line=catString(line,age);
  line=catString(line," ");
  line=catString(line,s->major);
  line=catString(line,">");
  return line;
} 
```

**学生.c 文件：**

```
static void error(char *s) {
  fprintf(stderr,"%s:%d %s\n",__FILE__,__LINE__,s);
  exit(1);
}

static StudentList alloc(StudentList students, Student student) {

  StudentList p;
    if (!(p=(StudentList)malloc(sizeof(*p)))){
    error("out of memory");}
  p->student=student;
  p->students=students;
  return p;
}

extern Students newStudents() {
  Students p;
    if (!(p=(Students)malloc(sizeof(*p)))){
    error("out of memory");
    }
  p->cursor=0;
  p->students=0;
  return p;
}

extern void addStudent(Students students, Student student) {
  StudentList p=students->students;
  if (!p) {
    students->students=alloc(0,student);

    return;
  }
while (p->students)
     p=p->students;
  p->students=alloc(0,student); 
    }    

extern void initStudent(Students students) {
  students->cursor=students->students;
}

extern Student currStudent(Students students) {
  StudentList cursor=students->cursor;
  if (!cursor)
    return 0;
  return cursor->student;
}

extern void nextStudent(Students students) {
  students->cursor=students->cursor->students;
} 
```

**我的主要方法：**

```
int main() {
  Students students=newStudents();
  addStudent(students,newStudent("Julie",22,"CS"));
  addStudent(students,newStudent("Trevor",32,"EE"));

  for (initStudent(students);
       currStudent(students);
       nextStudent(students)) {
      char *line=currStudent(students)->toString;
    printf("%s\n",line);
      free(currStudent(students));
    free(line);
  }

    free(students->students);
    free(students);
  return 0;
} 
```

我正在使用 valgrind 来检查内存泄漏，它弹出以下错误：

```
8 bytes in 1 blocks are definitely lost in loss record 1 of 1
==9520==    at 0x40054E5: malloc (vg_replace_malloc.c:149)
==9520==    by 0x8048908: alloc (Students.c:13)
==9520==    by 0x80489EB: addStudent (Students.c:42)
==9520==    by 0x804882E: main (StudentList.c:10) 
```

我知道我需要在**alloc**函数中释放为 p 分配的内存，但是我应该在哪里调用 free(p)？还是我做错了什么？请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T17:59:19.760

问题是当你完成 a`Student`或 a`StudentList`并且不再需要它时你会做什么。这就是你应该调用`free()`该结构中所有分配的东西的地方。

可能您需要一个`freeStudents`遍历学生列表并释放其中所有`Student`s 和所有`StudentList`项目的函数。然后，只要您想删除学生列表，就调用该函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T19:33:33.420

抱歉，这是切题的，但是您确实可以做很多事情来使您的代码更具可读性。

您创建一个结构，然后将其类型重新定义为指向它的指针。哎呀，这只是在可维护性方面自找麻烦。隐藏指针是指针的事实通常是一个坏主意，因为当人们看到这样的事情时：

```
Students newStudents()
{
  Students p;
  // ...
  return p;
} 
```

约定迫使我们假设您正在返回一个在堆栈上分配的结构，这显然是不正确的。（编辑：不一定是“明显不正确”，而是一个浪费的副本。）

当你添加你的 malloc 时，事情变得更加棘手......

```
Students p;
if (!(p=(Students)malloc(sizeof(*p))))
{
  error("out of memory");
} 
```

一方面，如前所述，人们假设没有 *，Students 是堆栈上的完整结构。这将使任何看到“sizeof(*p)”的人都重复一遍。你在做什么并不明显。

虽然将赋值和比较压缩到一个 if 语句中是完全有效的 C 和 C++，但它通常不是最易读的解决方案。大有改善：

```
Students* newStudents ()
{
  Students* p = (Students*) malloc (sizeof (Students));
  if (p == NULL)
  {
     // ...
  }
  // ...
  return p;
} 
```

人们乐于指出在 C 中强制转换 malloc 的返回值不是必需的，但在 C++ 中却是这样。

至于你的泄漏，嗯...... valgrind 没有报告你的 catString 使用情况，但它仍然很粗略，因为你隐藏了内存使用情况。使用 snprintf 是创建所需字符串的更好、更惯用的方法。

valgrind 正在报告泄漏：看起来您只是在释放列表中的第一个“学生”节点。您需要遍历它并将它们全部释放，可能是这样的：

```
Students p = students;
while (p)
{
  Students next = p->students;
  free (p);
  p = next;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T17:53:35.407

我认为你在alloc中有问题。

如果你想要一个指针，它应该是

```
StudentList *p;
p = (StudentList*)malloc(sizeof(StudentList)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T18:13:44.330

你真的需要定义你的类型是什么。您能否编辑您的帖子以包含**Student**、**StudentList**和**Students**的定义？

还，

```
StudentList p;
p = (StudentList) malloc(sizeof(*p); 
```

除非**StudentList**是指针的 typedef，否则我不确定它是如何编译的。

我们还有一行：

```
StudentList p=students->students 
```

将 p 定义为**Student**。那么 Student 也必须是指针的 typedef。

* * *

另外，我认为最终您的问题是，当您尝试在链接列表中插入学生时，您最终会丢失任何现有列表。您可以尝试将 3 个学生插入列表中，然后尝试打印该列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T17:58:05.693

如果我使用 malloc()，我永远不会将 sizeof 与变量一起使用。你应该使用`malloc(n * sizeof(StudentList))`. 照这样说...

你有一些主要的担忧。首先，您没有告诉我们 Student 和 StudentList 的具体定义是什么。在某些情况下，当我认为你的意思是 NULL 时，你会传递 0——当你的意思是 NULL 时，永远不要使用 0。如果 malloc() 失败——意思是，它返回 NULL——那么你就不会在结果上调用 free()。永远，永远免费的 NULL。

您应该只释放 (a) 成功分配的内存块，以及 (b) 当您不再需要它时。这似乎没有进入您的代码。

还有其他问题（当您初始化 p 时，您假设 addStudent 中的学生非 NULL），但它们并没有完全解决您关于使用 free() 的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T17:58:55.130

这是在做什么：

```
if (!(p=(StudentList)malloc(sizeof(*p)))){
    free(p); 
```

那么，如果`p`不能分配，释放呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T18:02:57.677

我假设 StudentList 被定义为某种指向 Student 的指针。在这种情况下，你的 alloc 函数中的这一行是一个问题。 `p=(StudentList)malloc(sizeof(*p))`

您试图在分配指针之前取消引用它，这并不好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T18:09:05.637

当您不再需要使用已分配的对象时，您应该释放内存。

`StudentList`和是什么`Student`？在我看来，您的数据结构构造不正确。为什么要`StudentList`存储指向另一个的指针`StudentList`？您可能应该创建一个`StudentList`using`malloc`并使用您的函数返回指向该指针的指针`newStudents`，而不是返回一个新的 StudentList 结构和旧的 in 的副本`addStudent`，只需修改您最初创建的结构。

所以它会是这样的：

```
StudentList *newStudentList() {
    //malloc a new StudentList and return the pointer
}
void freeStudentList(StudentList *list) {
    //free the list pointer and all its child resources (i.e. the students in the list)
}
Student *newStudent(const char *name, etc) {
    //malloc a new Student and return the pointer
}
void addStudentToList(StudentList *list, Student *student) {
    //modify the StudentList which has been passed in by adding the student to it.
} 
```

如果您不打算单独使用它们，则可以将 newStudent 合并到 addStudent 中，如果您也打算单独执行这些操作，则可能需要一个 freeStudent 和 removeStudentFromList 函数`freeStudentList`。您应该查看 Google 以获取 C 中动态数据结构的示例（[这](http://www.cs.cf.ac.uk/Dave/C/node11.html)是 Google 上的第一个结果，但还有很多其他结果）。

# cocoa-touch - 在可可中使用不同线程时访问不同控制器中的对象

> ID：752911
> 
> 赞同：0
> 
> 时间：2009-04-15T17:46:33.117
> 
> 标签：cocoa-touch, multithreading, controller, nsxmlparser

我正在使用可可 NSXmlParser 提取 xml。由于这个过程很可能在我的视图加载之前不会完成，我想将它移动到一个辅助线程，就像我在许多示例中看​​到的那样，包括苹果网站上的地震 XML 示例。

我的申请流程如下。我有一个表格视图，可以单击其中的单元格以访问另一个由 nsxmlparser 填充的表格视图。

如果您在应用程序委托中执行逻辑，我知道这就是您填充对象的方式：

```
[(id)[[UIApplication neare] delegate] performSelectorOnMainThread:@selector(addToBusStopList:) withObject:busStop waitUntilDone:YES]; 
```

但是如果你像我一样在表格视图控制器中工作，你怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-27T00:12:32.897

当解析器完成时，你不能告诉 tableview 更新自己：

```
[tableView reloadData]; 
```

# vb6 - 调用 Com+ 应用程序时出现一个或多个参数无效错误

> ID：752915
> 
> 赞同：2
> 
> 时间：2009-04-15T17:48:25.873
> 
> 标签：vb6, com+

我有 vb6 / com+ 应用程序，它在今天早些时候工作了几周。据有权访问的每个人都没有对服务器进行任何操作。当我尝试调用服务器上的 com+ 组件时，出现以下错误：

错误代码 -2147024809 一个或多个参数无效。

如果我切换到不同的 com+ 服务器，一切正常。

我已经尝试重新启动 com+ 包、重新启动 IIS 并重新创建包，但这些都没有奏效。

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T12:48:50.177

我敢打赌你已经安装了这个并且你的服务器已经失败了。也有这个问题。Grrr MS Sec 更新 Grrr。

[http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/fd24c76b-a8d7-4033-8e31-6dbe236d92f7.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/fd24c76b-a8d7-4033-8e31-6dbe236d92f7.mspx?mfr=true)

# django - 对基于 Django 的项目中的 A/B 测试有什么想法吗？

> ID：752919
> 
> 赞同：60
> 
> 时间：2009-04-15T17:50:30.627
> 
> 标签：django, testing, ab-testing

我们刚刚开始为基于 Django 的项目进行 A/B 测试。我能否获得有关此 A/B 测试的最佳实践或有用见解的一些信息。

理想情况下，每个新的测试页面都将通过一个参数来区分（就像 Gmail 一样）。mysite.com/?ui=2 应该给出一个不同的页面。因此，对于每个视图，我都需要编写一个装饰器来根据“ui”参数值加载不同的模板。而且我不想在装饰器中硬编码任何模板名称。那么 urls.py url 模式将如何呢？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-05-15T15:48:06.523

在深入研究代码之前退后一步并抽象 A/B 测试试图做什么是很有用的。我们到底需要什么来进行测试？

*   有条件的目标
*   满足目标条件的至少两条不同的路径
*   用于将观众发送到其中一条路径的系统
*   记录测试结果的系统

考虑到这一点，让我们考虑实施。

**目标**

当我们考虑网络上的目标时，通常是指用户到达某个页面或完成特定操作，例如成功注册为用户或进入结帐页面。

在 Django 中，我们可以通过几种方式对其进行建模——也许在视图中天真地在达到目标时调用函数：

```
 def checkout(request):
        a_b_goal_complete(request)
        ... 
```

但这无济于事，因为我们必须在需要的任何地方添加该代码——另外，如果我们使用任何可插入的应用程序，我们不想编辑它们的代码来添加我们的 A/B 测试。

我们如何在不直接编辑视图代码的情况下引入 A/B 目标？中间件呢？

```
 class ABMiddleware:
      def process_request(self, request):
          if a_b_goal_conditions_met(request):
            a_b_goal_complete(request) 
```

这将使我们能够在网站的任何地方跟踪 A/B 目标。

我们如何知道目标的条件已经满足？为了便于实施，我建议我们知道当用户到达特定 URL 路径时，目标已经满足其条件。作为奖励，我们可以在不弄脏视图的情况下测量这一点。回到我们注册用户的例子，我们可以说当用户到达 URL 路径时这个目标已经实现：

*/注册完成*

所以我们定义`a_b_goal_conditions_met`：

```
 a_b_goal_conditions_met(request):
       return request.path == "/registration/complete": 
```

**路径**

当考虑 Django 中的路径时，很自然地会想到使用不同模板的想法。是否还有其他方法还有待探索。在 A/B 测试中，您可以在两个页面之间做出微小的差异并衡量结果。因此，最佳实践应该是定义一个单一的基本路径模板，所有通往目标的路径都应从该模板扩展。

应该如何渲染这些模板？装饰器可能是一个好的开始——在 Django 中最好的做法是在`template_name`视图中包含一个参数，装饰器可以在运行时更改此参数。

```
 @a_b
    def registration(request, extra_context=None, template_name="reg/reg.html"):
       ... 
```

你可以看到这个装饰器要么自省被包装的函数并修改`template_name`参数，要么从某个地方（如模型）查找正确的模板。如果我们不想将装饰器添加到每个函数中，我们可以将其作为 ABMiddleware 的一部分来实现：

```
 class ABMiddleware:
       ...
       def process_view(self, request, view_func, view_args, view_kwargs):
         if should_do_a_b_test(...) and "template_name" in view_kwargs:
           # Modify the template name to one of our Path templates
           view_kwargs["template_name"] = get_a_b_path_for_view(view_func)
           response = view_func(view_args, view_kwargs)
           return response 
```

我们还需要添加一些方法来跟踪哪些视图正在运行 A/B 测试等。

**用于将观众发送到路径的系统**

理论上这很容易，但是有很多不同的实现，所以不清楚哪一个是最好的。我们知道一个好的系统应该在路径上均匀地划分用户 - 必须使用一些哈希方法 - 也许你可以使用 memcache 计数器的模数除以路径的数量 - 也许有更好的方法。

**记录测试结果的系统**

我们需要记录有多少用户走上了哪条路径——当用户达到目标时，我们还需要访问这些信息（我们需要能够说出他们走哪条路径来满足目标条件）——我们'将使用某种模型来记录数据，并使用 Django 会话或 Cookie 来保存路径信息，直到用户满足目标条件。

**结束的想法**

我已经给出了很多在 Django 中实现 A/B 测试的伪代码——以上绝不是一个完整的解决方案，而是为在 Django 中创建一个可重用的 A/B 测试框架的良好开端。

作为参考，您可能想在 GitHub 上查看 Paul Mar 的七分钟 A/B - 它是上述的 ROR 版本！ [http://github.com/paulmars/seven_minute_abs/tree/master](http://github.com/paulmars/seven_minute_abs/tree/master)

* * *

**更新**

在对 Google 网站优化器的进一步思考和调查中，很明显上述逻辑存在巨大漏洞。通过使用不同的模板来表示路径，您会破坏视图上的所有缓存（或者如果视图被缓存，它将始终提供相同的路径！）。相反，我不使用路径，而是窃取 GWO 术语并使用以下思想`Combinations`- 这是模板更改的一个特定部分 - 例如，更改`<h1>`站点的标签。

该解决方案将涉及将呈现为 JavaScript 的模板标签。当页面在浏览器中加载时，JavaScript 向您的服务器发出请求，该请求获取可能的组合之一。

这样，您可以在保留缓存的同时测试每个页面的多个组合！

* * *

**更新**

模板切换仍有空间——比如你引入了一个全新的主页并想测试它与旧主页的性能——你仍然想使用模板切换技术。要记住的是，您必须想办法在 X 个页面的缓存版本之间进行切换。为此，您需要覆盖标准缓存中间件，以查看它们是否是在请求的 URL 上运行的 A/B 测试。然后它可以选择正确的缓存版本来显示！！！

* * *

**更新**

使用上面描述的想法，我实现了一个用于基本 A/B 测试 Django 的可插拔应用程序。你可以从 Github 上下载它：

[http://github.com/johnboxall/django-ab/tree/master](http://github.com/johnboxall/django-ab/tree/master)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-15T20:36:02.553

如果您使用建议的 GET 参数 ( `?ui=2`)，那么您根本不必触摸urls.py。你的装饰师可以检查`request.GET['ui']`并找到它需要的东西。

为了避免硬编码模板名称，也许您可​​以包装视图函数的返回值？除了返回 render_to_response 的输出，您可以返回一个元组`(template_name, context)`并让装饰器修改模板名称。这样的事情怎么样？**警告：我尚未测试此代码**

```
def ab_test(view):
    def wrapped_view(request, *args, **kwargs):
        template_name, context = view(request, *args, **kwargs)
        if 'ui' in request.GET:
             template_name = '%s_%s' % (template_name, request.GET['ui'])
             # ie, 'folder/template.html' becomes 'folder/template.html_2'
        return render_to_response(template_name, context)
    return wrapped_view 
```

这是一个非常基本的示例，但我希望它能够传达这个想法。您可以修改有关响应的其他一些内容，例如向模板上下文添加信息。您可以使用这些上下文变量与您的站点分析集成，例如 Google Analytics。

作为奖励，如果您决定停止使用 GET 参数并移动到基于 cookie 等的东西，您可以在未来重构这个装饰器。

**更新**如果您已经编写了很多视图，并且不想全部修改它们，则可以编写自己的`render_to_response`.

```
def render_to_response(template_list, dictionary, context_instance, mimetype):
    return (template_list, dictionary, context_instance, mimetype)

def ab_test(view):
    from django.shortcuts import render_to_response as old_render_to_response
    def wrapped_view(request, *args, **kwargs):
        template_name, context, context_instance, mimetype = view(request, *args, **kwargs)
        if 'ui' in request.GET:
             template_name = '%s_%s' % (template_name, request.GET['ui'])
             # ie, 'folder/template.html' becomes 'folder/template.html_2'
        return old_render_to_response(template_name, context, context_instance=context_instance, mimetype=mimetype)
    return wrapped_view

@ab_test
def my_legacy_view(request, param):
     return render_to_response('mytemplate.html', {'param': param}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T23:26:21.677

贾斯汀的回答是对的……我建议你投票给那个，因为他是第一个。如果您有多个视图需要此 A/B 调整，他的方法特别有用。

但是请注意，如果您只有少数视图，则不需要装饰器或更改 urls.py。如果您将 urls.py 文件保持原样...

```
(r'^foo/', my.view.here), 
```

...您可以使用 request.GET 来确定请求的视图变体：

```
def here(request):
    variant = request.GET.get('ui', some_default) 
```

如果您想避免为单个 A/B/C/etc 视图硬编码模板名称，只需在模板命名方案中使它们成为约定（正如 Justin 的方法也推荐的那样）：

```
def here(request):
    variant = request.GET.get('ui', some_default)
    template_name = 'heretemplates/page%s.html' % variant
    try:
        return render_to_response(template_name)
    except TemplateDoesNotExist:
        return render_to_response('oops.html') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-20T11:25:39.493

基于 Justin Voss 的代码：

```
def ab_test(force = None):
    def _ab_test(view):
        def wrapped_view(request, *args, **kwargs):
            request, template_name, cont = view(request, *args, **kwargs)
            if 'ui' in request.GET:
                request.session['ui'] = request.GET['ui']
            if 'ui' in request.session:
                cont['ui'] = request.session['ui']
            else:
                if force is None:
                    cont['ui'] = '0'
                else:
                    return redirect_to(request, force)
            return direct_to_template(request, template_name, extra_context = cont)
        return wrapped_view
    return _ab_test 
```

使用代码的示例函数：

```
@ab_test()
def index1(request):
    return (request,'website/index.html', locals())

@ab_test('?ui=33')
def index2(request):
    return (request,'website/index.html', locals()) 
```

这里发生了什么： 1\. 传递的 UI 参数存储在 session 变量中 2\. 每次加载相同的模板，但是一个上下文变量 {{ui}} 存储了 UI id（您可以使用它来修改模板） 3.如果用户在没有 ?ui=xx 的情况下进入页面，那么在 index2 的情况下，他将被重定向到 '?ui=33'，在 index1 的情况下，UI 变量设置为 0。

我使用 3 从主页重定向到 Google 网站优化器，然后使用适当的 ?ui 参数重定向回主页。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-15T09:59:23.033

您还可以使用 Google Optimize 进行 A/B 测试。为此，您必须将 Google Analytics 添加到您的网站，然后当您创建 Google Optimize 实验时，每个用户都会获得一个带有不同实验变体的 cookie（根据每个变体的权重）。然后，您可以从 cookie 中提取变体并显示应用程序的各种版本。您可以使用以下代码段来提取变体：

```
ga_exp = self.request.COOKIES.get("_gaexp")

parts = ga_exp.split(".")
experiments_part = ".".join(parts[2:])
experiments = experiments_part.split("!")
for experiment_str in experiments:
    experiment_parts = experiment_str.split(".")
    experiment_id = experiment_parts[0]
    variation_id = int(experiment_parts[2])
    experiment_variations[experiment_id] = variation_id 
```

但是有一个 django 包可以很好地与 Google Optimize 集成：[https](https://github.com/adinhodovic/django-google-optimize/) ://github.com/adinhodovic/django-google-optimize/ 。

这是一篇关于如何使用该软件包以及 Google Optimize 如何工作的博客文章：[https](https://hodovi.cc/blog/django-b-testing-google-optimize/) ://hodovi.cc/blog/django-b-testing-google-optimize/ 。

# ruby-on-rails - validates_associated 和 validates_presence_of 在 rspec 中不能按预期工作？

> ID：752921
> 
> 赞同：6
> 
> 时间：2009-04-15T17:51:06.130
> 
> 标签：ruby-on-rails, ruby

我有一个用户模型和一个友谊模型。

```
class Friendship < ActiveRecord::Base
  belongs_to :sender, :class_name=>'User', :foreign_key=>'sender_id'
  belongs_to :receiver, :class_name=>'User', :foreign_key=>'receiver_id'

  validates_presence_of :receiver_id, :sender_id
  validates_associated :receiver, :sender
end

class User < ActiveRecord::Base
  has_many :sent_friendships, :class_name => "Friendship", :foreign_key => "sender_id", :dependent => :destroy
  has_many :received_friendships, :class_name => "Friendship", :foreign_key => "receiver_id", :dependent => :destroy
end 
```

我的 rspec 测试之一是

```
describe Friendship do

  before(:each) do
    @valid_attributes = {
      :sender_id => 1,
      :receiver_id => 2,
      :accepted_at => nil
    }
  end

  it "should not be valid with non-existant receiver_id" do
    f = Friendship.new(@valid_attributes)
    f.receiver_id = 99999
    f.should_not be_valid
  end
end 
```

测试不应该是有效的，因为没有用户 ID 为 9999 的用户。但是测试说友谊模型是有效的。

为什么是鬼？

***编辑：***

但是我想像提到的那样进行测试->而不直接分配发件人。这不可能吗？？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T20:32:46.523

如果您希望您的模型以这种方式工作，请更改以下内容：

```
validates_presence_of :receiver_id, :sender_id 
```

对此：

```
validates_presence_of :receiver, :sender 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T18:05:56.593

Rails 文档`validates_associtated`说明如下：

> 注意：如果尚未分配关联，则此验证不会失败。如果要确保关联既存在又保证有效，还需要使用 validates_presence_of。

您尚未分配关联。如下修改您的测试，它应该通过：

```
it "should not be valid with non-existant receiver_id" do
  f = Friendship.new(@valid_attributes)
  f.receiver_id = 99999
  f.receiver = nil  # Note this line
  f.should_not be_valid
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T01:19:09.050

还有一个旧插件可以做到这一点`validates_existence_of`......

[http://blog.hasmanythrough.com/2007/7/14/validate-your-existence](http://blog.hasmanythrough.com/2007/7/14/validate-your-existence)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T18:53:44.497

嗯..

在我在 rails lighthouse 中仅找到此博客条目和 wont-fix-ticket 之后：

[带有解决方案的博客条目](https://rails.lighthouseapp.com/projects/8994/tickets/500-validates_associated-fails-when-associated-id-is-incorrect)

[灯塔不会修复票](http://blog.hasmanythrough.com/2007/7/14/validate-your-existence)

我切换到我自己的解决方案：

```
class Friendship < ActiveRecord::Base
  belongs_to :sender, :class_name=>'User', :foreign_key=>'sender_id'
  belongs_to :receiver, :class_name=>'User', :foreign_key=>'receiver_id'

  validates_presence_of :receiver_id, :sender_id

  validate :sender_exists
  validate :receiver_exists

  protected
  def sender_exists
    errors.add("sender_id", "not existant") unless User.exists?(self.sender_id)
  end  
end 
```

# c# - ASP MVC 重定向而不更改 URL（路由）

> ID：752922
> 
> 赞同：6
> 
> 时间：2009-04-15T17:51:55.270
> 
> 标签：c#, asp.net, asp.net-mvc, url-routing

目标：我希望能够输入 URL：www.mysite.com/NewYork 或 www.mysite.com/name-of-business

根据我想在不更改 URL 的情况下路由到不同操作的字符串。

到目前为止，我有：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.MapRoute(
        "UrlRouter", // Route name 
        "{query}", // URL with parameters 
        new { controller = "Routing", action = "TestRouting" } // Parameter defaults
    );
} 
```

在控制器中我有：

```
public ActionResult TestRouting(string query)
{
    if (query == "NewYork")
        return RedirectToAction("Index", "Availability");    // <--------- not sure
    else if (query == "name-of-business")
        return Redirect("nameofbusines.aspx?id=2731");       // <--------- not sure
    else
        return RedirectToAction("TestTabs", "Test");         // <--------- not sure
} 
```

我几乎已经尝试了所有在不更改 URL 的情况下重定向/转移到页面的方法，但是我尝试的所有方法都会更改 URL 或给我一个错误。

基本上我正在寻找 server.transfer 的等价物，我可以在其中保留 URL，但将信息发送到操作并让它显示其结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T18:11:36.363

我和尼克一起做这个，虽然我认为你可以只使用常规视图而不是做部分视图。如果它们不在与控制器对应的视图中，您可能需要将它们实现为共享视图（因为它只会在关联和共享视图中查找）。

```
public ActionResult TestRouting(string query)
{
    if (query == "NewYork")
    {
        var model = ...somehow get "New York" model
        return View("Index", model );
    }
    else if (query == "name-of-business")
    {
        var model = ...get "nameofbusiness" model
        return View("Details", model );
    }
    else
    {
        return View("TestTabs");
    }
} 
```

然后，每个视图将采用模型的特定实例并使用模型呈现其内容。URL 不会改变。

任何时候使用 RedirectResult，实际上都会向浏览器发送 HTTP 重定向，这将强制 URL 更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-06-22T10:58:16.447

我不确定您是否尝试过这种方式，或者这种方式是否有任何缺点..

将 global.asax 文件添加到您的项目中。在其中添加以下方法：

```
void Application_BeginRequest(object sender, EventArgs e)
{
    // Handles all incoming requests
    string strURLrequested = Context.Request.Url.ToString();
    GetURLToRedirect objUrlToRedirect = new GetURLToRedirect(strURLrequested); 
    Context.RewritePath(objUrlToRedirect.RedirectURL);
} 
```

GetURLToRedirect 可以是一个具有根据输入的 URL 查找实际 URL 的逻辑的类。[RedirectURL] 属性将设置为 url 以重定向到工作表下方。

希望有帮助...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-29T12:08:50.757

您可以像这样更改控制器：

```
public ActionResult TestRouting(string query)
{
    string controller,action;

    if (query == "NewYork")
    {
        controller = "Availability";
        action = "Index";
    }
    else
    {
        controller = "Test";
        action = "TestTabs";
    }

    ViewBag.controller = controller;
    ViewBag.action = action;

    return View();
} 
```

然后你可以像这样在你的视图中使用这些 ViewBags：

```
@{
    Layout = null;
    Html.RenderAction(ViewBag.action, ViewBag.controller);
} 
```

而已。你可以通过使用一个类和一些函数来改进这个例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T17:57:09.110

你是说你想去“www.mysite.com/NewYork”然后“真的”去“其他地方”，但不理会网址吗？也许您想要做的是使用部分视图来实现这一点？这样，您的基本页面将被路由到，然后在该页面内部进行条件测试以显示不同的局部视图？我已经在我的应用程序中完成了该操作，用于查看网格的只读版本或可编辑的网格。它工作得非常好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T18:13:24.237

我不确定您可以对重定向到 .aspx 页面做些什么，但您应该能够将其替换为`RedirectToAction(...)s`以下内容：

```
public ActionResult TestRouting(string query)
{
    if (query == "NewYork") 
    {
        var controller = new AvailabilityController();        
        return controller.Index();
    }
    else if (query == "name-of-business")
        return Redirect("nameofbusines.aspx?id=2731");       <--------- not sure
    else 
    {
        var controller = new TestController();        
        return controller.TestTabs();
    }

} 
```

# javascript - Jquery/MooTools/Prototype 是否消除了对 GWT 的需求？

> ID：752932
> 
> 赞同：5
> 
> 时间：2009-04-15T17:54:02.270
> 
> 标签：javascript, jquery, ajax, gwt, rich-internet-application

我不再听到太多关于 GWT 的消息了。

当它第一次问世时，它似乎在某些 RIA 圈子里都风靡一时。

但最近我的印象是，GWT 的受欢迎程度有所下降，因为 Jquery/MooTools/Prototype 等解决方案提供了一种更简单的方法来解决相同的问题。

这是准确的还是 GWT 解决了不同类型的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T17:59:55.487

嗯，有点。

GWT 的最终产品最终类似于其他 JS 框架提供的东西 - 一种 JavaScript 解决方案，在大多数情况下，它抽象出所有浏览器和 DOM 的不一致性，因此您可以专注于 Real Work™。

但是，GWT 和 JS 框架之间存在显着差异——使用 GWT 编写代码的程序员正在编写 Java，然后将其编译成 JavaScript。

所以它真正归结为：因为现在存在伟大的 JS 框架，剩下多少知道 Java 但不知道 JavaScript 的 Web 开发人员？因此，不知道 jQuery 或 MooTools 什么的？

对我来说，这个问题的答案是：不多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T18:17:53.290

GWT 和 javascript 库有两种不同的用途。GWT 从 java 代码生成 web 应用程序，javascript 库可以用作 web 应用程序中的组件。因为 javascript 库可用于许多不同类型的 Web 应用程序项目（ASP.NET、Ruby on Rails 等），它们可能比 GWT 拥有更多的受众，但 GWT 的功能并不是 javascript 库完全取代它们自己的东西. 根据需要，两者都对各自的受众非常有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T08:04:54.617

GWT of course is for folks who like to code using Java. If you are not a Java geek, you will not have passion for it, nor will be able to appreciate it. It has completely eliminated the needs to learn one *new* framework. All you need to know is Java, that's it. js frameworks as someone already pointed out can be used across platforms (.NET, Java, Ruby), but I am not sure if this statement is actually true.

# c# - 监视 Windows 应用程序的（网络）资源利用率和性能

> ID：752934
> 
> 赞同：5
> 
> 时间：2009-04-15T17:54:36.077
> 
> 标签：c#, .net, performance, networking, resources

我正在构建一个基于客户端-服务器的解决方案；客户端是桌面应用程序，服务器是 Web 应用程序。

基本上，我需要监控客户端的性能和资源利用率，这是一个基于 .NET 2.0 的 Windows 桌面应用程序。

**我需要监控**的最重要的事情是客户端使用的网络资源，即从客户端流出到服务器的数据的大小是多少，客户端从服务器下载的数据的大小是多少。

除此之外，一般性能监控也会有所帮助。

请指导。

***编辑：有些人建议使用 perfmon，但 perfmon 系统范围内显示的值不是吗？我只需要单个应用程序的这些基于网络的统计信息......单个桌面应用程序发送和接收的字节数。***

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T12:57:34.707

网络监控的标准工具是[Wireshark](http://www.wireshark.org)。它允许您非常灵活地过滤网络流量。不过，这对您的应用程序来说可能有点过头了。如果您使用的是纯 .NET，我建议您将性能日志记录添加到服务器端的网络类中 - 如果您使用的是 .Net 库类，则从它们继承您自己的类，这些类在发送和接收数据时添加统计信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T18:11:03.557

您也可以使用任务管理器来执行此操作。转到进程选项卡，然后查看->“选择列”。检查“I/O 读取字节”和“I/O 写入字节”。然后在进程列表中找到您的程序，您可以观察累积值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T09:58:09.593

看看这篇文章： http: [//www.codeproject.com/KB/IP/apptraffwatcher.aspx](http://www.codeproject.com/KB/IP/apptraffwatcher.aspx)

您也许可以拆开源代码，并获取您需要测量下载/上传应用程序进程 ID 的内容。

看起来他使用这个库来获取有关流量的信息：http: [//www.codeproject.com/KB/IP/trafficwatcher.aspx](http://www.codeproject.com/KB/IP/trafficwatcher.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T12:42:36.457

我尝试了 perfmon，但我也无法查看我们的网络流量。但我能够在 Visual Studio 2005 Team 套件中的 Performance Explorer 中使用。

如果您有团队版 Visual Studio，您可以在桌面应用程序上设置采样/仪器。然后进入会话的选项。选择事件 -> Windows 内核跟踪 -> 网络。运行您的应用程序并让 Visual Studio 记录数据。然后保存报告。（我喜欢微软的这个“功能”）转到命令提示符，导航到 C:\Program Files\Microsoft Visual Studio 8\Team Tools\Performance Tools 并运行“vsperfreport /CALLTRACE (filename).vsp” 这将产生一个csv 文件包含桌面应用程序发送/接收/大小/端口等的所有网络数据包。

我知道这是一个冗长的解决方案，但我只是在我的 .Net 2.0 应用程序上尝试了它，它捕获了我们与 Oracle Identity Manager 和 Oracle 数据库的所有通信。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T13:06:16.083

您需要将监控分为两部分：

*   系统如何与服务器交互（执行的调用次数）
*   网络流量（任何呼叫的交换数据大小）

第一部分（根据我的经验）经常被忽视，但它非常重要，因为获取新连接通常比数据流量本身要昂贵得多。

您没有告诉我们有关您正在使用的连接之王的任何信息（低级 tcpip 调用、Web 服务、WCF 或其他），但我的建议是：

*   找到一种方法来确定您的应用程序调用服务器的次数
*   找出任何单个呼叫在数据交换方面的成本

如何监控这些值很大程度上取决于所涉及的技术，因为有些非常简单（例如，如果您使用 Web 服务，设置[Fiddler](http://www.fiddler2.com/fiddler2/)来监控调用并检查监控结果非常简单），例如其他你需要使用像[Wireshark](http://www.wireshark.org/)或[MS Network Monitor](http://www.microsoft.com/Downloads/details.aspx?FamilyID=f4db40af-1e08-4a21-a26b-ec2f4dc4190d&displaylang=en)这样的低级流量分析器，并学习如何根据服务器的 IP 地址、使用的端口和其他参数过滤流量。

如果您澄清您的应用程序架构，我可以尝试更具体。

问候马西莫

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T13:36:36.287

如果您使用的是 HTTP 请求，您的帖子并不清楚。您指出服务器是一个 Web 应用程序，这暗示（可能是不正确的）我可能正在使用 HTTP 协议从服务器发送/接收数据到客户端。

如果是这样，一个可能有用的工具是[Fiddler](http://www.fiddler2.com/fiddler2/)。该工具将监视进出工作站的所有 HTTP 流量，并且它可以（我相信）监视特定的会话和应用程序。好的部分是您可以查看单个请求并查看这些请求的统计信息，包括输入/​​输出字节、往返时间和其他有用的信息。

如果您不是基于 HTTP 的，那么此工具将无济于事。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-29T01:46:48.917

我很惊讶没有人建议使用 SysInternals（现为 Microsoft）Process Explorer (technet.microsoft.com/en-us/sysinternals/bb896653.aspx)。如果您右键单击有问题的可执行文件并左键单击属性，它将弹出一个对话框。然后切换到性能选项卡，您可以监控可执行文件的 I/O。Performance Graph 选项卡将显示随时间绘制的 CPU 使用率和 I/O 字节历史记录。这是一个很酷的免费工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T18:08:07.150

您想查看 perfmon（或者在管理工具中从开始菜单中称为性能监视器）。

在其默认图形视图中打开它，添加一个计数器，选择网络接口，然后选择每秒字节数（或类似的计数器），单击确定，你就完成了。

您可以尝试使用其他网络计数器，因为它们有很多，其中一个将完全按照您的意愿行事。您还可以将 perfmon 日志保存到文件中并在之后查看它们 - 您将看到完整的图表，并且可以“放大”部分。或者，您可以仅使用原始数字保存日志样式文件。

这是一个通过 perfmon 作为管理工具的[快速指南，一旦您了解了这一点，剩下的就很容易了。](http://adminfoo.net/2007/04/windows-perfmon-top-ten-counters.html)

在 Vista 中，您不能再添加单独的计数器，您可以添加分组在一个对象下的整个计数器集 - 因此对于我的示例，您将添加网络接口对象，然后您会在图表上看到所有单独的计数器单击确定后。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T18:11:09.500

如果您希望将其内置到您的客户端代码库中，而不是使用外部工具，您可以使用[性能计数器](http://msdn.microsoft.com/en-us/library/aa373083(VS.85).aspx)来访问性能监视器、任务管理器等报告的大多数其他内容。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-12T17:46:31.670

您应该查看 ACE Analyst 以了解此用例 - 将其视为 Wireshark 数据包捕获之上的超级智能层。您需要查看数据包以了解在网络上运行的应用程序行为的真实性质。

# asp.net - 在 asp.net UserControl 中的控件上设置 DataSource？

> ID：752935
> 
> 赞同：5
> 
> 时间：2009-04-15T17:54:44.437
> 
> 标签：asp.net, user-controls, datasource

我创建了我的第一个 asp.net UserControl，我将在整个应用程序的多个地方使用它。它包含一个 FormView 来显示 DataTable 中记录的字段。

一切似乎都很好，除了，我不知道如何在 UserControl 内的 FormView 上设置 DataSource。我想在代码隐藏的方法中设置 DataSource。

我从智能感知中看到 UserControl 没有 DataSource 属性，但它确实有一个 DataBind 方法。我可以想象，可能需要在 UserControl 中的多个控件上设置不同的 DataSource，因此必须有一些方法可以深入到 UserControl，但我无法弄清楚。

这是aspx代码：

```
<%@ Register src="Controls/JobDetail.ascx" tagname="JobDetail" tagprefix="uc1" %>

 ...
 <uc1:JobDetail ID="UserControlJobDetail" runat="server" />
 ... 
```

这是尝试设置数据源的方法：

```
public void BindJobRecord(string SelectedJobNo)
{
    UserControlJobDetail.DataSource = LMDataClass.GetJob(SelectedJobNo);
    UserControlJobDetail.DataBind();
} 
```

这是用户控件：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="JobDetail.ascx.cs" Inherits="DwgDatabase.JobDetail" %>

<asp:FormView ID="fvJobDetail" runat="server" DataKeyNames="job_num">
  <ItemTemplate>
   <div style="float: left; border-width: 1px;" class="LabelStyle TextBoxStyle" >
    <table>
      <tr>
       <td><asp:label runat="server" ID="lblJobNo" Text='Job No' /></td>
       <td><asp:TextBox runat="server" ID="txtJobNo" Text='<%# Eval("job_num") %>' /></td>
      </tr>
      <tr>
       <td><asp:label runat="server" ID="Label2" Text='Customer' /></td>
       <td><asp:TextBox runat="server" ID="txtCustNo" Text='<%# Eval("cust_num") %>' /></td>
      </tr>
      <tr>
        <td><asp:label runat="server" ID="Label3" Text='Quote No' /></td>
        <td><asp:TextBox runat="server" ID="txtQuoteNo" Text='<%# DataBinder.Eval(Container.DataItem, "quote_no", "{0:00000;;.}") %>' /></td>
       </tr>
       <tr>
        <td><asp:label runat="server" ID="Label4" Text='Po No.' /></td>
        <td><asp:TextBox runat="server" ID="TextBox4" Text='<%# Eval("p_o_num") %>' /></td>
       </tr>
    </table>        
    </div>
</ItemTemplate>               
</asp:FormView> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T18:05:42.977

在用户控件上创建一个属性 DataSource，如下所示：

```
public object DataSource
{
  get
  {
    return this.fvJobDetail.DataSource;
  }
  set
  {
    this.fvJobDetail.DataSource = value;
  }
} 
```

对 DataBind() 方法执行相同的操作。

# php - 无法使用 PHP 从 SQL Server 存储过程中检索输出参数

> ID：752937
> 
> 赞同：0
> 
> 时间：2009-04-15T17:55:22.157
> 
> 标签：php, sql-server, linux, parameters

我正在执行一个 SQL Server 存储过程，它应该返回一个输出参数 (ErrCode) 以及一个结果集。

我使用以下代码从 PHP 调用该过程，但到目前为止无法检索输出参数：

```
$stmt = mssql_init("addFaculty", $this->db);

mssql_bind($stmt, "@FacultyID", $FacultyID, SQLCHAR);
...imagine other parameters here...
mssql_bind($stmt, "@ErrCode", &$ErrCode, SQLINT1, TRUE, FALSE, 1);

$result = mssql_execute($stmt);

echo $ErrCode 
```

$ErrCode 总是回显为 0，即使它应该返回“1”或“2”。但是，当我在 SQL Server Studio 中执行该过程时，“消息”选项卡将正确显示“1”或“2”。

在进行研究时，我发现了一个建议，指出您必须首先使用`mssql_next_result()`才能访问输出参数。我试过了，但它只是返回了一个 PHP

> “警告：mssql_next_result()：提供的参数不是有效的 MS SQL_result 资源”

我还在[此线程](https://stackoverflow.com/questions/480991/mssql-stored-procecure-output-params-in-php)中找到了对类似问题的引用，但没有看到真正的解决方案。

就像那个线程中的人一样，我正在使用带有 PHP5 和 MS SQL Server 2005 的 Linux (CentOS)。

有人对此有什么建议吗？我在之前的项目中也遇到过这样的问题，最后，我只是放弃了使用输出参数（而是在 PHP 中进行了所有的错误检查），因为我无法弄清楚。很高兴找到答案:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T18:39:04.630

编辑：

你试过[ADODB](http://adodb.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-12T11:33:47.817

查看我关于这个问题的帖子，我使用了从 Zend_Db_Table_Abstract 扩展的类。我不使用纯 PHP，仍然使用相应的框架。看起来很好并且运行良好，我什至也得到了结果集！希望能帮助到你：

[通过 Zend Framework 执行 MSSQL 存储过程](https://stackoverflow.com/questions/3732571/execute-mssql-stored-procedure-via-zend-framework/6663423#6663423)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T18:09:52.967

我不是 PHP 人，但我认为[这](http://msdn.microsoft.com/en-us/library/cc626303(SQL.90).aspx)会有所帮助。

它说：

> 请注意，在检索输出或输入/输出参数时，必须先使用存储过程返回的所有结果，然后才能访问返回的参数值。

# sql-server - 用于生成模式文本的 SQL 命令（类似于 CreateTo 或 AlterTo）

> ID：752941
> 
> 赞同：2
> 
> 时间：2009-04-15T17:56:12.420
> 
> 标签：sql-server, sql-server-2005, schema

SQL Server 2005。是否有一个 sql 查询将返回一个包含与您在执行右键单击表 -> 脚本表为 -> 从 SQL Server 管理中创建到（或更改到）时找到的相同类型的架构信息的文本字段工作室 ？

我正在寻找一种描述整个表格的单一/平面格式，包括约束、索引等。

我知道：

```
sp_help table_name 
```

但这并没有提供我正在寻找的单一平面格式。理想情况下，它将采用可编写脚本的格式，例如可以针对服务器执行的 AlterTo 结果。

这是针对每晚记录表模式以签入版本控制 (SVN) 的计划流程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T18:54:37.897

并不真地。表定义是列、约束等的集合。

有一个名为[ScriptDB4SVN](http://www.codeproject.com/KB/database/ScriptDB4Svn.aspx)的 SVN 插件可能会有所帮助。我没有亲自使用过，我是在道听途说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T21:24:17.463

再次在网上搜索这个问题的答案，并遇到了[这个](https://stackoverflow.com/questions/21547/in-mssql-how-do-i-generate-a-create-table-statement-for-a-given-table)SO 问题。它不能准确捕获与 SQL Management Studios Create-to 相同的所有数据，但足以满足我的目的（为版本控制目的编写数据库结构脚本）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T02:01:00.340

SQL Server 中没有这样的命令。这主要是因为脚本工具实际上是在 SMO 中，而不是在 SQL Server 本身中。有许多免费的控制台命令行工具可以做到这一点，您可以通过 xp_CmdShell 调用它们。

但是，如果您真的想从 T-SQL 执行此操作，那么您将需要一个脚本或存储过程来枚举所有表属性、列、列数据类型、默认值、可空性等，然后将其重新组合成一个创建表脚本。这是一项**艰巨**的任务。这就是坏消息。好消息是有人 (Lowell Izaguirre) 已经完成了这项工作，并将其发布在 SQLServerCentral.Com的这篇文章 ( [http://www.sqlservercentral.com/scripts/Miscellaneous/30730/ ) 中。](http://www.sqlservercentral.com/scripts/Miscellaneous/30730/)

享受。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T18:14:25.793

并非如此 - 您可以使用 C#（或 VB.NET）和 SMO（SQL 管理对象）编写数据库对象（表和所有）的脚本，或者您可以使用 SQL 获取表的列列表：

```
SELECT * FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'Your Table Name here' 
```

但我不知道 SQL 本身有什么简单的方法可以为数据库对象创建 Create/Alter 脚本，抱歉。

马克

# c# - 使用正则表达式查找第 n 次出现的字符时的性能问题

> ID：752946
> 
> 赞同：0
> 
> 时间：2009-04-15T17:57:48.797
> 
> 标签：c#, .net, regex

我有一个正则表达式来查找`nth`字符串中某个字符的出现，这是代码：

```
 public static int NthIndexOf(this string target, string value, int n)
    {
        Match m = Regex.Match(target, "((" + value + ").*?){" + n + "}");

        if (m.Success)
        {
            return m.Groups[2].Captures[n - 1].Index;
        }
        else
        {
             return -1;
        }
    } 
```

现在，我在这个字符串中有 1594 个条目，包含 1593 个分号。如果我写：

```
tempstring.NthIndexOf(";", 1593) 
```

答案会立即正确地返回。如果我给它任何超过 1594 的东西，它就会挂起。有谁知道如何解决这一问题？

### 测试用例

```
 string holder = "test;test2;test3";
        string test = "";
        for (int i = 0; i < 600; i++)
        {
            test += holder;
        }
        int index = test.NthIndexOf(";", 2000); 
```

这需要很长时间。将600改为6，速度非常快。使 2000 到 1700，它也非常快。

为什么我的正则表达式这么慢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T18:08:33.547

如果您真的只是在寻找字符重复而不是字符串重复，那么您应该能够用简单的方法替换您的方法，例如

```
public static int NthIndexOf(this string target, char testChar, int n)
{
   int count = 0;

   for(int i=0; i<target.Length; i++)
   {
      if(target[i] == testChar)
      {
         count++;
         if(count == n) return i;  
      }
   }

   return -1;
} 
```

并使用它。它应该有更少的限制。

至于为什么您的原始正则表达式变慢，这就是我的怀疑：

*   对于您的快速案例，它可以正常工作，因为它可以在第一次通过时找到匹配项（每个组都匹配一个字符）
*   对于缓慢的情况是因为它找不到匹配项（并且永远找不到匹配项，因为没有足够的分号来满足正则表达式），但它递归地尝试所有可能的方式来分解字符串（即一个非常大的操作）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T18:10:27.083

尝试使用更独特和更有效的正则表达式：

```
"^(?:[^" + value + "]*" + value + "){" + (n - 1) + "}([^" + value + "]*) 
```

这将为 构建以下正则表达式`tempstring.NthIndexOf(";", 1593)`：

```
^(?:[^;]*;){1592}([^;]*) 
```

但这仅适用于单个字符作为分隔符。

另一种方法是遍历每个字符并计算您要查找的字符的出现次数。

# asp.net - Visual Studio 原生支持哪种 JavaScript 框架？

> ID：752947
> 
> 赞同：1
> 
> 时间：2009-04-15T17:57:54.977
> 
> 标签：asp.net, javascript

是 jQuery 吗？有没有办法集成对优秀 ExtJS 或 YUI 库的支持？

关于 Visual Studio 2010 是否会支持另一个 JS 框架的任何消息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T18:09:13.840

我只看到微软会支持 JQuery。但这与 Visual Studio 和 IIS 的关系不大，更多的是与 Microsoft 支持实践有关。JQuery 将随 Visual Studio 2010、Microsoft AJAX 框架和 ASP.Net MVC 框架（现在发生）一起提供。

但是你可以使用任何你想要的 JavaScript 库，如果你有正确的服务包，你也应该对 Visual Studio 2008 有一点智能。

我还没有从其他 JavaScript 库中看到的一个“额外”JQuery 是他们的库的一个版本，其中包含 Visual Studio 注释，提供更好的智能指令。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T18:00:43.173

你可以使用任何你喜欢的 JavaScript 框架。JQuery 与.Net 一起打包，但它不是您唯一的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T20:42:58.760

如果您有想要使用的框架的文档或调试版本，[VS 2008 将为您提供引用的 JS 库的 IntelliSense](http://weblogs.asp.net/scottgu/archive/2007/06/21/vs-2008-javascript-intellisense.aspx)。

如果您安装了[额外的 IntelliSense 修补程序](http://blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to-enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx) [KB958502](http://code.msdn.microsoft.com/KB958502/Release/ProjectReleases.aspx?ReleaseId=1736)，您可以利用 VS 自动在您引用的缩小版本旁边查找名为 .vsdoc.js 或 .debug.js 的文档化 JS 文件的副本。

展望未来，VS 2010 将对 JavaScript 提供更多支持，从使用中计算出参数类型等。

Microsoft 已经开始提供对 jQuery 的**支持**——这与 VS 支持 JavaScript 框架不同——这意味着你可以打电话给 MS 并说你的网站不能使用 jQuery，他们会帮助你修复它（作为标准支持事件，就像您在 VS 本身、IIS 甚至 Word 中发现问题时一样）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T20:44:04.623

是的，你可以使用任何你想要的框架，但要小心框架冲突为您节省大量时间。

[http://groups.google.com/group/jquery-en/browse_thread/thread/3dabd31a8ab60505?pli=1](http://groups.google.com/group/jquery-en/browse_thread/thread/3dabd31a8ab60505?pli=1)

[http://forum.mootools.net/viewtopic.php?pid=26204](http://forum.mootools.net/viewtopic.php?pid=26204)

# flash - flash MenuBar 组件错误

> ID：752949
> 
> 赞同：0
> 
> 时间：2009-04-15T17:58:13.947
> 
> 标签：flash, actionscript, menubar

更新菜单栏组件的数据提供程序时，菜单项的状态无法更新，直到用户与菜单交互（将鼠标悬停在菜单上、单击菜单等）。例如，一个禁用的项目保持启用状态，直到用户将鼠标滑过它。有没有办法在修改数据提供者 XML 后强制菜单“刷新”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-12T21:29:45.467

刚刚经历了完全一样的事情。要发生此问题，您必须在更新之前在菜单上选择了某些内容`dataProvider`。此选择索引在内部成员上徘徊`oldIndex`并导致 menubar 错误`mouseOverHandler`。我通过在更改后清除选择来修复它`dataProvider`：

```
menu.dataProvider = newProvider;
appMenu.selectedIndex = -1; 
```

祝你好运。

# jquery - 拉 - 使用 jQuery

> ID：752955
> 
> 赞同：0
> 
> 时间：2009-04-15T17:59:01.540
> 
> 标签：jquery

我正在尝试创建一个对象，用户可以在其中单击并拖动以产生拉动的效果。知道我将如何使用 jQuery 做到这一点吗？拉下一个隐藏在屏幕外的容器。我会使用拖动吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T18:25:06.360

如果听起来您正在尝试复制与此类似的内容：

*   [http://lab.oneiros.ru/jquery/sidebar/](http://lab.oneiros.ru/jquery/sidebar/)

否则，是的，我会使用一个延伸到屏幕外的 div 并使用拖放来“拉”东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T19:09:42.883

在 JQuery UI 中有一个可以使用的 Draggable 库。
[http://jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)

但是“屏幕外”部分可能是一个挂断。不知道您所说的“屏幕外”是什么意思。

# .net - localhost和127.0.0.1不一样？

> ID：752960
> 
> 赞同：2
> 
> 时间：2009-04-15T17:59:22.053
> 
> 标签：.net, sockets

我有一个在 2 个进程之间传递数据的套接字应用程序。它可以在同一台计算机上运行 2 个进程的多台计算机上正常工作。我办公室的一个人访问了一个政府办公室，他们在那里对她的笔记本电脑进行了一些未知的更改，以便她可以访问他们的网络。当她离开时，该应用程序不再工作。

如果她尝试 telnet 到侦听器应用程序，如果她尝试连接到计算机名称或 127.0.0.1，她可以连接，但连接到 localhost 不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-15T18:01:28.960

检查位于此处的主机文件：C:\WINDOWS\system32\drivers\etc

该文件将 localhost 转换为 127.0.0.1

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T18:06:08.013

也许 %systemroot%\system32\drivers\etc\hosts 中的 localhost 映射指向 IPv6 地址，而程序不支持 IPv6。

hosts 文件中的条目是否如下所示：

> 127.0.0.1 本地主机

还是这样？

> ::1 本地主机

请去开始，运行，然后输入：

> 记事本 %systemroot%\system32\drivers\etc\hosts

去检查。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T18:00:57.730

检查主机文件？

等待; 你的意思是当她远程登录到本地主机时它可以工作，或者当她远程登录到她的 IP 时它可以工作？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T18:22:25.760

万一这恰好是 *nix 系统，您可以在此处找到主机文件：

> `/etc/hosts`

# mysql - Visual Studio 和 MySQL

> ID：752970
> 
> 赞同：0
> 
> 时间：2009-04-15T18:02:11.907
> 
> 标签：mysql, visual-studio

我一直在使用 Microsoft Visual Web Developer 2008 Express Edition。最初，我制作了一个带有 MySQL 后端的网站。然后我发现了 .Net Web 身份验证，并尽可能地转移到 MS Access，并进行了一些修改，使 Web 身份验证工作（但不是所有功能）。对于我网站的未来版本，我转向 MS SQL，因为它支持 .Net Web 身份验证的所有功能。但是，我的主机不支持 MS SQL，我的主机支持 MS Access 和 MySQL。

如果我获得 Visual Studio 2008 Standard，它与 MySQL 有更好的集成，是否支持 Web 身份验证和使用开发环境更改数据库的所有功能？是否有第三方工具或修改可以使事情达到该集成级别？

或者，我是否必须转移到支持 MS SQL 的主机？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T18:04:02.370

[你可以试试 MySQL 的 .NET 连接器，虽然它只是一个开发版本](http://www.mysql.com/products/connector/net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T18:19:56.530

我们在这里运行一个 .NET 环境，但使用 MySQL 作为我们的后端（尽管我们的软件是应用程序，而不是 Web 应用程序）。

MySql Net 连接器*基本上*是 .NET 中 System.Data 命名空间的 MySQL 版本（除了 MySql 前缀外，具有几乎相同的功能/命名）。因此，据我在使用它时所见，您可以通过这些名称空间执行的任何操作，都可以通过连接器执行。

至于IDE集成，我不知道。我使用[MySql Administrator](http://dev.mysql.com/downloads/gui-tools/5.0.html)和[SQLYog](http://webyog.com/en/downloads.php)来管理/使用数据库。

# logic - 如何在 Coq 中编写 ∀x ( P(x) 和 Q(x) )？

> ID：752973
> 
> 赞同：2
> 
> 时间：2009-04-15T18:03:22.107
> 
> 标签：logic, predicate, proof, coq

我正在尝试 Coq，但我不完全确定我在做什么。是：

```
Theorem new_theorem : forall x, P:Prop /\ Q:Prop 
```

相当于：

```
∀x ( P(x) and Q(x) ) 
```

编辑：我认为他们是。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T06:12:12.307

你有语法问题吗？

```
$ coqtop
Welcome to Coq 8.1pl3 (Dec. 2007)

Coq < Section Test.

Coq < Variable X:Set.
X is assumed

Coq < Variables P Q:X -> Prop.
P is assumed
Q is assumed

Coq < Theorem forall_test: forall x:X, P(x) /\ Q(x).
1 subgoal

  X : Set
  P : X -> Prop
  Q : X -> Prop
  ============================
   forall x : X, P x /\ Q x

forall_test < 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-02T14:12:51.683

好吧，回答你的问题：

```
Section test.

  Variable A : Type.           (* assume some universe A *)
  Variable P Q : A -> Prop.    (* and two predicates over A, P and Q *)

  Goal forall x, P x /\ Q x.   (* Ax, ( P(x) and Q(x) ) *)

End test. 
```

# python - 如何在 Python 中使用 unicode

> ID：752998
> 
> 赞同：15
> 
> 时间：2009-04-15T18:11:45.783
> 
> 标签：python, string, unicode, replace, unicode-string

我正在尝试从字符串中清除所有 HTML，因此最终输出是一个文本文件。我对各种“转换器”进行了一些研究，并开始倾向于为实体和符号创建自己的字典并在字符串上运行替换。我正在考虑这一点，因为我想自动化这个过程，并且底层 html 的质量存在很多可变性。为了开始比较我的解决方案和替代方案之一的速度，例如 pyparsing，我决定使用字符串方法 replace 测试 \xa0 的替换。我得到一个

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xa0 in position 0: ordinal not in range(128) 
```

实际的代码行是

```
s=unicodestring.replace('\xa0','') 
```

无论如何 - 我决定我需要在它前面加上一个 r 所以我运行了这行代码：

```
s=unicodestring.replace(r'\xa0','') 
```

它运行没有错误，但是当我查看 s 的一部分时，我看到 \xaO 仍然存在

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-15T18:22:48.240

也许你应该做

```
s=unicodestring.replace(u'\xa0',u'') 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T20:33:03.137

```
s=unicodestring.replace('\xa0','') 
```

..正在尝试创建 unicode 字符`\xa0`，该字符在 ASCII 字符串中无效（Python 3.x 之前的默认字符串类型）

`r'\xa0'`没有出错的原因是因为在原始字符串中，转义序列无效。它没有尝试将字符串编码`\xa0`为 un​​icode 字符，而是将字符串视为“文字反斜杠”、“文字 x”等。

以下是相同的：

```
>>> r'\xa0'
'\\xa0'
>>> '\\xa0'
'\\xa0' 
```

这是 Python v3 中解决的问题，因为默认字符串类型是 unicode，所以你可以这样做。

```
>>> '\xa0'
'\xa0' 
```

> 我正在尝试从字符串中清除所有 HTML，因此最终输出是一个文本文件

为此，我强烈推荐[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)。编写一个 HTML 清理工具很困难（考虑到大多数 HTML 是多么可怕），而 BeautifulSoup 在解析 HTML 和处理 Unicode 方面做得很好。

```
>>> from BeautifulSoup import BeautifulSoup
>>> soup = BeautifulSoup("<html><body><h1>Hi</h1></body></html>")
>>> print soup.prettify()
<html>
 <body>
  <h1>
   Hi
  </h1>
 </body>
</html> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T18:17:29.280

查看[codecs](http://docs.python.org/library/codecs.html)标准库，特别是 Codec 基类中提供的**encode**和**decode**方法。

[这里](http://boodebr.org/main/python/all-about-python-and-unicode)还有一篇很好的文章将所有内容放在一起。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-13T13:19:28.447

而不是这个，最好使用标准的python特性。

例如：

```
string = unicode('Hello, \xa0World', 'utf-8', 'replace') 
```

或者

```
string = unicode('Hello, \xa0World', 'utf-8', 'ignore') 
```

where `replace` will replace `\xa0` to `\\xa0`.

But if `\xa0` is really not meaningful for you and you want to remove it then use `ignore`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T18:18:02.027

只是关于 HTML 清理的说明。这是非常非常困难的，因为

```
<
body
> 
```

是编写 HTML 的有效方式。仅供参考。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T18:18:07.657

您可以通过以下方式将其转换为 unicode：

```
print u'Hello, \xa0World'  # print Hello,  World 
```

# java - 如何在 Java 中处理同时按键？

> ID：752999
> 
> 赞同：18
> 
> 时间：2009-04-15T18:11:47.797
> 
> 标签：java, events, keyboard

如何在 Java 中处理同时按键？

我正在尝试编写游戏并且需要一次处理多个按键。

当我按住一个键（假设向前）然后按住另一个键（例如，向左转）时，会检测到新键，但不再检测到旧按键。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-15T18:30:17.207

一种方法是跟踪自己当前关闭的密钥。

当您收到 keyPressed 事件时，将新键添加到列表中；当您收到 keyReleased 事件时，从列表中删除该密钥。

然后在您的游戏循环中，您可以根据键列表中的内容执行操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-18T12:25:03.573

下面是一个代码示例，说明如何在按下 CTRL+Z 时执行操作：

```
import java.awt.*;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
class p4 extends Frame implements KeyListener
{
    int i=17;
    int j=90;
    boolean s1=false;
    boolean s2=false;

    public p4()
    {
        Frame f=new Frame("Pad");

        f.setSize(400,400);
        f.setLayout(null);
        Label l=new Label();
        l.setBounds(34,34,88,88);
        f.add(l);

        f.setVisible(true);
        f.addKeyListener(this);
    }

    public static void main(String arg[]){
        new p4();
    }

    public void keyReleased(KeyEvent e) {
        //System.out.println("re"+e.getKeyChar());

        if(i==e.getKeyCode())
        {
            s1=false;
        }

        if(j==e.getKeyCode())
        {
            s2=false;
        }
    }

    public void keyTyped(KeyEvent e) {
        //System.out.println("Ty");
    }

    /** Handle the key pressed event from the text field. */
    public void keyPressed(KeyEvent e) {
        System.out.println("pre"+e.getKeyCode());

        if(i==e.getKeyCode())
        {
            s1=true;
        }

        if(j==e.getKeyCode())
        {
            s2=true;
        }

        if(s1==true && s2==true)
        {
            System.out.println("EXIT NOW");
            System.exit(0);
        }
    }

    /** Handle the key released event from the text field. */

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T18:33:54.250

一般来说，您所描述的可以使用[**bitmasks**](http://en.wikipedia.org/wiki/Mask_(computing))来实现。********