# StackOverflow 问答 000486000-000486999

# c# - 首先是逻辑，然后是 WCF 安全？

> ID：486000
> 
> 赞同：5
> 
> 时间：2009-01-28T00:40:54.513
> 
> 标签：c#, xml, wcf, security, wcf-binding

我正在开发一个 WCF 服务，该服务将通过 net.tcp 与客户端应用程序的 n 个实例进行通信（由我办公室的另一位程序员开发）。

目前我正在使用 net.tcp 没有任何安全性，因为我觉得在这个阶段设置它是没有必要的，至少在我们接近推出之前不需要。

在开发 WCF 应用程序的过程中，使用没有安全性的标准绑定（在我的例子中是 net.tcp）有什么害处，那么一旦业务逻辑完成，实现所有的安全性要求？我需要注意哪些在实施安全性后可能无法正常工作的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T02:12:02.677

虽然您的整体设计应该从一开始就考虑安全性，但我认为将您的组件与任何特定的安全策略结合起来并不是一个好主意。您可能非常希望以非安全方式或跨提供不同安全选项的不同协议使用某些组件。

所以我的回答是肯定的和否定的。是的，您需要从一开始就考虑它，但不，您不应该将组件与您的安全需求结合起来。

也就是说，既然您知道您将使用 net.tcp，您应该知道默认情况下此绑定的传输安全性已打开。

有关更多信息，请参阅 Juval Lowy 出色的[Programming WCF Services](https://rads.stackoverflow.com/amzn/click/com/0596521308)第 10 章。Lowy 在他的 ServiceModelEx 库（在书中详细讨论）提供了一个非常好的框架，您可以在创建组件后插入该框架。即使它不是您正在寻找的东西，您也可以对其进行定制以满足您的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T00:43:22.980

应该从一开始就考虑安全性，而不是在最后添加。

为您的安全制定一个计划，并在您进行时实施，而不是在最后实施。

参考：Microsoft .NET：为企业构建应用程序

[http://www.amazon.com/Microsoft®-NET-Architecting-Applications-PRO-Developer/dp/073562609X](http://www.amazon.com/Microsoft) _

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T14:39:26.227

你有两个选择，从一开始就烤，或者在最后打上它。一般来说，我会说它在结冰时确实不起作用，所以你必须把你的蛋糕弄得一团糟才能把它放进去。

However, the way I see your question is you already know you need to do something to solve a security issue, you just have not decided what to do. In that case I would agree with Terry that you should then design around an abstraction that allows you to plugin the eventual solution.

If I were you I would probably do a threat model and use it to consider the inputs and risks presented by your service. This will help you decide what you should do eventually and if your abstraction covers all bases.

# asp.net - 在开发过程中加快 .net 程序集加载时间

> ID：486002
> 
> 赞同：4
> 
> 时间：2009-01-28T00:42:22.123
> 
> 标签：asp.net

我正在开发一个大型（100 个程序集）asp.net 应用程序，在开发过程中，重新编译后加载第一页可能需要几分钟。

有人告诉我，大部分延迟来自于对程序集进行 JIT，并且这种延迟与程序集的数量（但不是大小）成正比。我还没有测量过这个。

我们正在努力进行架构更改以改善这种情况（组合程序集、解耦应用程序），但我想知道是否有任何快速修复可以通过，例如，在开发中更改 IIS 设置或在构建后组合 DLL。

我们正在使用 .net 3.5。

对我有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T00:48:47.057

查看预编译应用程序以删除 JIT。

[恩根](http://msdn.microsoft.com/en-us/magazine/cc163808.aspx)

预编译您不处理的程序集，创建不构建您不处理的程序集的自定义构建配置，然后只有您需要的程序集将 JIT。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T00:53:08.670

我参与了一个与您类似的项目，其中包含大量组件。我采用的一种策略是只加载我目前正在进行的开发所需的程序集。

另一种可能性是将所有程序集与构建后操作合并。微软有一个名为[ILMerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)的漂亮工具。它将多个程序集合并为一个。您可以编写一个后期构建脚本来将这些程序集合并在一起。

您还可以通过合并您未更改的程序集并将它们添加为参考来更进一步。

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T23:28:37.427

*害羞的*

这是我应该早点尝试的解决方案：禁用病毒防护将初始加载时间从大约一分钟减少到不到 8 秒。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T00:54:44.033

您可以查看 NGEN 对您的程序集进行编译，但如果您想在构建后加快*开发*时间，那么 NGEN 对您的帮助并不大。JIT 代码所花费的时间都将在 NGEN 中提前完成，因为您必须为所有内容创建本机指令以进行测试。如果有的话，NGEN'ing 你的代码会在前面变慢。

# java - 使用 Spring JdbcTemplate 构建数据层

> ID：486011
> 
> 赞同：4
> 
> 时间：2009-01-28T00:46:29.433
> 
> 标签：java, spring, jdbc

您是否知道任何描述使用 Spring 的 JdbcTemplate 类构建数据访问层的资源？我正在寻找超出 Spring 框架文档中描述的基础知识的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T01:05:38.787

如果不是在线文档，也许书籍会有所帮助。“Spring in Action”、“Pro Spring”、“Spring Recipes” - 任君挑选。不过，我不确定您要寻找多少细节。我怕你会失望。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T04:11:11.937

我不太确定您正在寻找什么，但我基本上创建了一个具有 SimpleJDBCTemplate 作为属性的 DAO 类。它是通过依赖注入设置的。DAO 的公共方法抽象了与 SimpleJDBCTemplate 的交互。

# .net - 如何阻止窗口调整大小和移动窗口？

> ID：486015
> 
> 赞同：0
> 
> 时间：2009-01-28T00:47:19.743
> 
> 标签：.net, .net-3.5

当我尝试将窗口（用鼠标）移动到屏幕上方以隐藏标题栏时，窗口会将其移回。如果我尝试将窗口调整为大于屏幕空间，窗口将调整其大小以“适应”屏幕分辨率。如果 Windows 不喜欢大小或位置，它似乎正在发送 wm_move 消息。有没有办法防止这种情况？

看来我可以调用 setwindowpos 并将窗口放置在我想要的任何位置，无论我想要什么大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T01:04:11.083

在 Win32 领域，您将处理`WM_MOVING`, `WM_SIZING`，并将`WM_WINDOWPOSCHANGING`它们变成空操作。您可能还想处理`WM_ENTERSIZEMOVE`and `WM_EXITSIZEMOVE`。

除非您自己编写应用程序，否则这实际上很烦人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T00:56:03.050

什么操作系统？XP、Vista？

在 XP 中，您似乎可以使用鼠标将标题栏从屏幕上移出 90%。您也可以尝试右键单击标题栏并选择移动。然后将鼠标移到屏幕底部并移开，并使用键盘上的向上箭头将其移出。虽然不是很方便。

编辑：第二，虽然带有箭头的移动方法不起作用，因为一旦你按下回车键，它就会重置它。

也许尝试程序网格移动。我知道您可以创建自定义布局，但我不确定您是否可以将其设置在屏幕之外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T00:59:07.147

如果您试图隐藏标题栏（称为非客户区），那么您应该能够捕获 NC_PAINT 消息并防止它们被处理......有一堆 NC_ 消息控制非客户区的显示窗口的客户区。

# user-interface - MDI还有地方吗？

> ID：486020
> 
> 赞同：6
> 
> 时间：2009-01-28T00:49:42.140
> 
> 标签：user-interface, mdi

尽管 MDI 被[认为是有害](http://pixelcentric.net/article-art=docs.html)的，但一些应用程序（甚至是 MS Office、Adobe 应用程序）仍然以纯粹的形式使用它，或者将其作为与选项卡式/IDE 式界面的混合体使用。

**MDI 接口是否仍然适用于某些应用程序？**

我正在考虑一个应用程序，其中一个通常一次处理多个文档，并且经常希望有多个文档一边查看或在它们之间复制/粘贴。

一个例子是[Origin](http://www.originlab.com/)，其中一个项目中有多个工作表和图形窗口；选项卡式或类似 IDE 的界面会因大量来回切换而更加不方便。

在mac上，一个应用程序有多个顶级窗口来解决这个问题是很自然和方便的，如果不使用MDI，Windows中的首选方式是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-28T04:07:05.720

MDI的缺点如下：

*   它通常需要用户学习和理解一组更复杂的窗口关系。

*   许多简单的操作可能需要一个两步过程。例如，将期望的窗口带到前台可能需要用户首先将容器窗口向前移动，然后再将容器窗口中的右侧主窗口向前移动。调整窗口大小或最大化窗口可能意味着首先调整容器窗口，然后调整其中的主窗口。

*   如果打开了多个容器窗口，用户可能会忘记哪个具有所需的主窗口，需要进行繁琐的搜索。

*   用户很容易对最大化、图标化、分层和关闭窗口的双重方式感到困惑。例如，他们可能会关闭整个应用程序而不是容器窗口中的一个窗口。或者他们可能会“丢失”一个窗口，因为他们在容器窗口中将其图标化而没有意识到这一点。

*   用户受限于他或她的窗口可以采用的尺寸和位置。假设我想同时查看一个应用程序的 3 个窗口和另一个应用程序的 1 个窗口。使用 SDI，我可以让每个窗口占据屏幕的一个象限，但使用 MDI 无法做到这一点。如果我想让 MDI 中的一个窗口大而另一个窗口小怎么办？我必须使容器窗口变大以容纳大窗口（它遮挡其他应用程序的窗口），但是在看孩子时会浪费空间。

请注意，所有这些缺点也适用于选项卡式文档界面 (TDI)，选项卡式界面还有一个缺点，即用户无法并排查看同一容器窗口中的两个文档。选项卡还会在您的窗口中添加混乱并消耗空间。但是，总体 TDI 的问题往往比 MDI 少，因此它们可能更适合特殊情况（继续阅读）

综上所述，很难想到任何情况下都可以使用 MDI。它并不比 SDI 更好，同时增加了更多的复杂性和导航开销，并且与其他应用程序的窗口配合不佳。

应用程序没有理由不能拥有多个顶级 SDI 窗口。即使使用像 Origin 这样的应用程序，只要项目在每个窗口中都得到很好的识别，我也没有看到项目分布在多个 SDI 窗口中的问题。SDI 还允许不同类型的窗口（例如，图形与工作表）具有不同的菜单和工具栏，而不是根据活动窗口隐藏或禁用项目（前者令人困惑，后者浪费空间）。

SDI 为您的用户提供了比 MDI 或 TDI 更大的灵活性。用户可以重叠或最大化窗口，并将任务栏/停靠栏用作事实上的选项卡界面。用户可以选择调整窗口大小和重新定位窗口，以便一次查看多个窗口。每个窗口都可以独立调整大小以优化屏幕空间。无论 MDI 或 TDI 有什么优势，您都可以增强 SDI 以使其也具有这些优势（例如，提供一个缩略图菜单，使窗口之间的切换比使用任务栏更快，并且与选择选项卡相当，或者提供一个图标化所有一键打开应用程序的窗口）。

除非您有令人信服的理由使用 TDI，否则请使用 SDI 以实现这种灵活性。令人信服的原因包括以下的一些子集：

*   每个选项卡都用于不相关的高阶任务，用户不会频繁地在选项卡之间切换或跨选项卡比较信息。

*   您正在与非常低端的用户一起工作，他们对任务栏/停靠栏和多个窗口一无所知或感到困惑，并且不知道如何调整窗口大小（对于此类用户来说，引人注目的选项卡图像似乎比任务栏更好）。

*   您预计通常会有大量选项卡（例如，4 个或更多），并且您可以以比操作系统更有效的方式控制它们的显示，如果它们是任务栏/停靠栏上的 SDI 窗口（例如，关于订单和标签）。

*   使用 SDI，您会遇到用户将非活动窗口的工具栏或调色板与活动窗口混淆的问题。

*   选项卡的数量是固定的并且永久打开（例如，当每个选项卡是同一数据对象的不同组件时）。用户不必为尝试区分关闭选项卡和关闭整个窗口而烦恼；找出要导航到的窗口不是问题，因为所有窗口都有相同的选项卡。

*   实际上只有一种方法可以正确安排任务数据，用户之间或他们实际使用应用程序的目的没有差异。您最好使用选项卡和主-详细信息窗格的组合为用户设置它，而不是依靠用户来正确排列和调整 SDI 窗口的大小。

总之，考虑到您的用户能力、应用程序复杂性和任务结构，如果您的应用程序能够比用户/操作系统更好地管理内容显示，则使用 TDI，否则使用 SDI。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T00:59:29.640

老式的 MDI（在哪里切换文档，你必须通过 Windows 菜单）很烦人。较新的 MDI（如 Opera 和 Mozilla 中的选项卡）使文档之间的切换非常容易，并且似乎已被很好地接受。如果您在没有 MDI 的情况下打开多个文档，它们也不会弄乱您的任务栏。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-28T01:07:34.367

请注意，您使用的示例（MS Office 和 Adob​​e 应用程序）是**大型程序**并且具有**很多功能**。用户将处理该程序，*并且*在程序的大部分生命周期中只处理该程序。

较新版本的 MS Office (2007) 和 Adob​​e Photoshop (CS4) 分别使用多个窗口和选项卡。

请注意，在 Windows 7 中，MDI 可能会更加不受欢迎，因为 Microsoft 的 API 提供了额外的选项卡功能（尽管您不需要严格使用选项卡 - MDI 窗口可以工作，但对用户来说会比平时更混乱）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-07-24T04:28:03.103

MDI 的主要优点是当您想要同时跟踪两个或多个窗口时，这些窗口需要组合在一起。例如，一个窗口中有一个正在运行的进程，但您需要在另一个窗口上工作，MDI 将是最理想的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T01:06:09.097

我同意 slavy13（旧 MDI = 坏，新 MDI = 好得多）。但不要使用 Microsoft Excel 之类的程序作为模型。哎呀！无论您打开了多少电子表格（这可能是也可能不是您的偏好），您的桌面上都会有一个窗口。但是您打开的每个文档都会有一个任务栏图标。同样，您的 Alt+Tab 窗口对于您打开的每个文档都有一个图标。另外，其中还有一个附加图标，仅用于“Excel”，可将您带到恰好是“当前”的任何文档。所以，是的，像 Mozilla 一样做你的 MDI。或者至少让您的用户可以选择切换到更简洁的风格。

为了更简洁地回答你的问题，我觉得答案是肯定的，MDI 在某些情况下仍然是合适的。但是，在所有事情中，适度是关键。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T00:56:41.830

看来，多个顶级窗口是要走的路。至于是否应该有一个全局应用程序实例或每个文档一个，我认为取决于您。它对用户不可见。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T00:57:33.233

MDI 只有一个好处：

由于一次运行多个实例的高昂成本，使用大量资源的程序（例如 Adob​​e Photoshop）通常具有 MDI。

但是你不应该一开始就开发消耗大量资源的程序。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-09-05T00:00:39.150

如果大量屏幕空间将用于在许多窗口之间共享的内容，我可以看到 MDI 的一个优势。将此类材料放在封闭窗口的顶部或侧面可能比在每个 SDI 窗口中重复出现或出现在与 SDI 窗口完全分开的窗口中更合乎逻辑。例如，一个聊天程序可能有一个状态窗格和一个控制窗格。让它们在视觉上与聊天窗口相关联可能比将它们作为独立窗口更好。

# c# - C# 中的优化技术

> ID：486021
> 
> 赞同：12
> 
> 时间：2009-01-28T00:50:43.573
> 
> 标签：c#, .net, optimization

我想知道现在人们经常使用什么样的优化技术。我见过人们一直在用字典和所有东西做缓存。速度交易空间是唯一的出路吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-10T06:03:46.167

我会在下面建议

**1.知道什么时候使用StringBuilder**

您之前一定听说过`StringBuilder`对象在将字符串附加在一起时比普通字符串类型要快得多。

`The thing is StringBuilder is faster mostly with big strings. This means if you have a loop that will add to a single string for many iterations then a StringBuilder class is definitely much faster than a string type. However if you just want to append something to a string a single time then a StringBuilder class is overkill. A simple string type variable in this case improves on resources use and readability of the C# source code.`

只需在 StringBuilder 对象和字符串类型之间正确选择，您就可以优化您的代码。

**2\. 比较不区分大小写的字符串**

在应用程序中，有时需要比较两个字符串变量，忽略大小写。诱人且传统的方法是将两个字符串都转换为全部小写或全部大写，然后比较它们，如下所示：

`str1.ToLower() == str2.ToLower()`

然而，重复调用函数 ToLower() 是性能的瓶颈。通过使用内置的 string.Compare() 函数，您可以提高应用程序的速度。

要检查两个字符串是否相等，忽略大小写如下所示：

`string.Compare(str1, str2, true) == 0 //Ignoring cases`

C# string.Compare 函数在两个字符串相等时返回一个等于 0 的整数。

**3.使用string.Empty**

这与其说是性能改进，不如说是可读性改进，但它仍然算作代码优化。尝试替换以下行：

`if (str == "")`

和：

`if (str == string.Empty)`

这只是更好的编程实践，对性能没有负面影响。

请注意，有一种流行的做法是检查字符串的长度是否为 0 比将其与空字符串进行比较要快。虽然这可能是真的，一旦它不再是显着的性能改进。而是坚持使用 string.Empty。

**4\. 将 ArrayList 替换为 List<>**

当在同一个列表中存储多种类型的对象时，ArrayList 很有用。但是，如果您在一个 ArrayList 中保留相同类型的变量，则可以通过使用 List<> 对象来提高性能。

采用以下 ArrayList：

```
ArrayList intList = new ArrayList();
intList.add(10);
return (int)intList[0] + 20; 
```

请注意，它仅包含整数。使用 List<> 类要好得多。要将其转换为类型化列表，只需更改变量类型：

```
List<int> intList = new List<int>(); 

intList.add(10)

return intList[0] + 20; 
```

无需使用 List<> 强制转换类型。对于整数等原始数据类型，性能提升尤其显着。

**5\. 使用 && 和 || 运营商**

在构建 if 语句时，只需确保使用双与符号 (&&) 和/或双或符号 (||)，（在 Visual Basic 中它们是 AndAlso 和 OrElse）。

If 语句使用 & 和 | 必须检查语句的每个部分，然后应用“and”或“or”。另一方面，&& 和 || 一次一个地检查语句，并在满足或不满足条件时立即停止。

执行更少的代码始终是一种性能优势，但它也可以避免运行时错误，请考虑以下 C# 代码：

```
if (object1 != null && object1.runMethod()) 
```

如果object1 为null，使用&& 运算符，object1.runMethod() 将不会执行。如果 && 运算符被 & 替换，即使 object1 已知为 null，object1.runMethod() 也会运行，从而导致异常。

**6\. 智能试接**

Try-Catch 语句旨在捕获超出程序员控制范围的异常，例如连接到 Web 或设备。使用 try 语句来保持代码“简单”而不是使用 if 语句来避免容易出错的调用会使代码变得非常慢。重构您的源代码以减少需要的 try 语句。

**7\. 更换部门**

当涉及到除法运算时，C# 相对较慢。一种替代方法是用乘法移位操作替换除法，以进一步优化 C#。文章详细解释了如何进行转换。

[参考](http://social.msdn.microsoft.com/Forums/vstudio/en-US/ca778312-d62f-4528-8610-abb6a65f918a/way-for-c-code-optimization?forum=csharpgeneral)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T02:25:52.790

真的是关于你在算法中的选择。通常没有优化的“灵丹妙药”。

例如，使用 a`StringBuilder`而不是串联可以使您的代码显着加快，但需要权衡取舍。如果您不连接大量字符串，则初始化所需的内存和时间`StringBuilder`比仅使用常规连接更糟糕。整个框架中有很多这样的例子，比如你在问题中提到的字典缓存。

您可以在一天中真正*学习*并应用于编码的唯一一般优化是装箱/拆箱（堆与堆栈）对性能的影响。为此，您需要了解它的含义以及如何避免或减少这样做的需要。

Microsoft 的 MSDN 文档有 2 篇关于性能的文章，它们提供了许多很好的通用技术（它们实际上只是同一篇文章的不同版本）。

*   [http://msdn.microsoft.com/en-us/library/ms173196.aspx](http://msdn.microsoft.com/en-us/library/ms173196.aspx)
*   [http://msdn.microsoft.com/en-us/library/ms173196(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms173196(VS.80).aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T02:13:10.710

算法也经常出现问题，通常是在循环内完成一些昂贵的事情时。通常，您要做的第一件事是分析您的应用程序，它会告诉您应用程序中最慢的部分。通常，您如何加快应用程序的速度取决于您的发现。例如，如果您的应用程序模仿文件系统，则可能是您正在递归调用数据库以向上遍历树（例如）。您可以通过将这些递归调用更改为一个扁平化的数据库调用来优化这种情况，该调用在一次调用中返回所有数据。

再一次，答案是，一如既往，“视情况而定”。但是，可以在[Rico Mariani 的博客](http://blogs.msdn.com/ricom/default.aspx)中找到更多示例和建议（回顾几年，因为他的重点已经转移）：

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T01:40:11.947

取决于很多事情，真的。

例如，当内存成为问题并且正在创建大量临时对象时，我倾向于使用对象池。（拥有垃圾收集器并不是不处理内存分配的理由）。如果速度很重要，那么我可能会使用不安全的指针来处理数组。

无论哪种方式，如果您发现自己在 ac#/.net 应用程序中的优化技术上苦苦挣扎，您可能选择了错误的语言/平台。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T04:28:20.483

我会推荐 Bill Wagner 的 Effective C#（[第一版](https://rads.stackoverflow.com/amzn/click/com/0321245660)和[第二版](https://rads.stackoverflow.com/amzn/click/com/0321485890)）。他介绍了许多语言结构和技术，并解释了哪些更快以及为什么。他还谈到了许多最佳实践。

然而，与使用任何类型的语言/优化技术相比，优化算法通常会给您带来更好的结果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T02:02:58.250

一般来说，请确保您了解不同算法的时间复杂度，并使用这些知识来明智地选择您的实现。

特别是对于 .NET，本文详细介绍了优化部署到 CLR 的代码（尽管它也与 Java 或任何其他现代平台相关），并且是我读过的最好的指南之一：

[http://msdn.microsoft.com/en-us/library/ms973852.aspx](http://msdn.microsoft.com/en-us/library/ms973852.aspx)

将这篇文章提炼成一句话：没有什么比对象的内存占用更能影响 .NET 应用程序（使用合理的算法）的速度了。要非常小心，尽量减少内存消耗。

# vim - 关闭 Vim 中的拆分窗口而不调整其他窗口的大小

> ID：486027
> 
> 赞同：35
> 
> 时间：2009-01-28T00:51:50.187
> 
> 标签：vim, window, split

如果我打开了一个 Vim 窗口，其中有 2 个拆分（总共 3 个缓冲区可见）并且我调整了每个拆分的视口，然后我关闭一个缓冲区，其他两个缓冲区的视口会自动调整大小。

当我关闭缓冲区时，有没有办法维持或至少更好地扩展拆分？

```
1) Vim window with three splits, custom size:
  +---+-------+---+
  |   |       |   |
  | 1 |   2   | 3 |
  |   |       |   |
  +---+-------+---+
2) Close buffer 3, splits are resized to "best fit":
  +-------+-------+
  |       |       |
  |   1   |   2   |
  |       |       |
  +-------+-------+
3) I want it to stay like this, resize only adjacent buffer:
  +---+-----------+
  |   |           |
  | 1 |     2     |
  |   |           |
  +---+-----------+ 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-01-28T01:00:28.530

```
set noea 
```

换句话说：

```
set noequalalways 
```

请参阅Vim 文档中的[equalalways](http://vimdoc.sourceforge.net/htmldoc/options.html#'equalalways')。

# visual-studio - 将 ASP.NET 2.0 部署到 IIs7

> ID：486031
> 
> 赞同：1
> 
> 时间：2009-01-28T00:53:08.640
> 
> 标签：visual-studio, iis

如何将我的 ASP.NET 网站部署到 IIS7？我正在使用 Visual Studio 2005。我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T00:59:13.963

我倾向于采取更多的手动方法，但 Visual Studio 中内置了一个 Web 发布功能，它应该可以帮助您进行操作。

这是您可以阅读的一些内容：http: [//www.codeproject.com/KB/aspnet/VSDeploy.aspx](http://www.codeproject.com/KB/aspnet/VSDeploy.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T01:36:52.890

这是一些初步步骤，比其他一些选项要手动一些，但它们是我喜欢的：

1.  获得对安装 IIS7 的服务器的访问权限。如果您没有在服务器上安装 IIS7，请安装它。如果您无法访问此服务器，则需要让该服务器的管理员设置 IIS7。

2.  在 IIS 中创建您要部署到的网站，或让服务器管理员创建一个空网站供您在其上运行您的网站。

3.  使用 Visual Studio 中的“发布”功能构建站点的可部署版本。这就是您将在 IIS7 上安装的内容。

4.  将网站复制粘贴到安装 IIS7 的服务器上。您需要将其放置在可以设置为站点主目录的目录中。

5.  如果您有权访问服务器并具有管理 IIS7 的权限，请将站点的主目录设置为指向您复制文件的目录。

6.  启用该网站，您应该一切顺利！

**注意：** 这些说明假设如下：

a）您对如何配置 IIS7 有一些基本知识（或者至少可以访问这样做的人）

b) 如果未安装 IIS7，您对如何安装 IIS7 有一些基本知识（或可以访问安装的人）

c) 你有一些从 Visual Studio 发布网站的基本知识

如果您需要关于这 3 个注意事项的更多说明，您可能希望查阅 IIS7 和 Visual Studio 的参考资料。

# data-structures - 中序树遍历：哪个定义是正确的？

> ID：486039
> 
> 赞同：22
> 
> 时间：2009-01-28T00:56:27.260
> 
> 标签：data-structures, binary-tree, tree-traversal

**我有以下来自我不久前参加的关于二叉树**（不是 BST）的中序遍历（他们也称之为 pancaking）的学术课程的文本：

*中序树遍历*

> 在树的外面画一条线。从根的左侧开始，然后绕过树的外部，最终到达根的右侧。尽可能靠近树，但不要越过树。（把树——它的分支和节点——想象成一个坚固的屏障。）节点的顺序是这条线在它们下面经过的顺序。如果您不确定何时走到节点“下方”，请记住“向左”的节点总是先出现。

这是使用的示例（与下面的树略有不同）

![树 1](https://farm4.static.flickr.com/3661/3624141531_094985f47e_o.png)

然而，当我在谷歌上搜索时，我得到了一个相互矛盾的定义。例如[维基百科示例](http://en.wikipedia.org/wiki/Tree_traversal)：

![树定义](https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Sorted_binary_tree.svg/250px-Sorted_binary_tree.svg.png)

> 中序遍历序列：A、B、C、D、E、F、G、H、I（leftchild、rootnode、right node）

但根据（我对）定义#1的理解，这应该是

> A、B、D、C、E、F、G、I、H

**谁能澄清哪个定义是正确的？**它们可能都描述了不同的遍历方法，但碰巧使用了相同的名称。我无法相信同行评审的学术文本是错误的，但不能确定。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-28T01:04:07.480

在我对绘图的错误尝试中，这里的顺序显示了应该如何选择它们。 ![替代文字](https://web.archive.org/web/20140926210320/http://imagebin.antiyes.com/images/0590294001233104834_3.jpg)

几乎选择了正在绘制的线正上方的节点。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-28T01:52:43.230

忘记定义，应用算法要容易得多：

```
void inOrderPrint(Node root)
{
  if (root.left != null) inOrderPrint(root.left);
  print(root.name);
  if (root.right != null) inOrderPrint(root.right);
} 
```

只有三行。重新排列前后订单的顺序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T01:04:01.783

如果您仔细阅读，您会看到第一个“定义”说从根的*左侧*开始，并且节点的顺序由您*在*它们下方经过的时间决定。所以`B`不是第一个节点，因为你在去的路上从左边经过它*，*`A`然后先经过*下面* `A`，然后再往上经过。因此，似乎两个定义都给出了相同的结果。 *`B`*

 ** * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-05T00:12:50.043

我个人觉得[这个讲座](http://www.youtube.com/watch?v=evwGnROlB58#t=46m45s)很有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T01:17:36.750

两种定义都给出相同的结果。不要被第一个例子中的*字母*所迷惑——看看路径上的数字。第二个例子确实使用字母来表示路径 - 也许这就是让你失望的原因。

例如，在您的示例顺序中显示您认为第二棵树将如何使用第一棵树的算法进行遍历，您将“D”放在“B”之后，但您不应该这样做，因为仍有一个左侧子节点D 可用（这就是为什么第一项说“这条线在它们 **下面经过的顺序”。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-04T00:48:03.583

我认为第一个以 为根的`a`二叉树是一个构造不正确的二叉树。

尝试实现树的所有左侧都小于根，树的所有右侧大于或等于根。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-22T11:19:15.323

这可能会迟到，但它可能对以后的任何人都有用..您只需要忽略虚拟或空节点，例如节点 G 有一个左空节点..考虑到这个空节点将使一切正常..

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-19T12:47:44.137

正确的遍历将是：叶节点（不是根节点）尽可能左

## 左根右

## AB 空

## CDE

## 空FG

## 嗨空

F 是根还是左，我不确定

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-28T01:38:19.780

> 但根据（我对）定义#1的理解，这应该是
> 
> ```
> A, B, D, C, E, F, G, I, H 
> ```

不幸的是，您的理解是错误的。

每当您到达一个节点时，您必须先下降到一个可用的左节点，然后再查看当前节点，然后再查看可用的右节点。当您在 C 之前选择 D 时，您没有先下降到左侧节点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-03T18:42:21.437

嘿，根据我在wiki中提到的正确顺序遍历的顺序是left-root-right。

直到 A、B、C、D、E、F 我想你已经明白了。现在在根 F 之后，下一个节点是 G，它没有左节点而是右节点，因此根据规则 (left-root-right)，它的 null-g-right。现在 I 是 G 的右节点，但我有一个左节点，因此遍历将是 GHI。这是对的。

希望这可以帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-05-18T03:18:04.143

对于内联树遍历，您必须记住遍历的顺序是左节点右。对于上图，您在读取左侧的任何叶（子）节点之前读取父节点时会发生错误。

正确的遍历将是：叶节点（A）尽可能向左，返回父节点（B），向右移动，但由于 D 在其左侧有一个子节点，因此您再次向下移动（C），向后移动到 C 的父节点（D），到 D 的右子节点（E），反向返回根节点（F），移动到右叶节点（G），移动到 G 的叶节点，但是因为它有一个左叶节点，所以移动到那里（H） ，返回父级（I）。

当我将节点列在括号中时，上面的遍历会读取节点。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-01-23T14:56:37.313

包数据结构；

公共类 BinaryTreeTraversal {

```
public static Node<Integer> node;

public static Node<Integer> sortedArrayToBST(int arr[], int start, int end) {
    if (start > end)
        return null;

    int mid = start + (end - start) / 2;
    Node<Integer> node = new Node<Integer>();
    node.setValue(arr[mid]);

    node.left = sortedArrayToBST(arr, start, mid - 1);
    node.right = sortedArrayToBST(arr, mid + 1, end);
    return node;
}

public static void main(String[] args) {

    int[] test = new int[] { 1, 2, 3, 4, 5, 6, 7 };
    Node<Integer> node = sortedArrayToBST(test, 0, test.length - 1);

    System.out.println("preOrderTraversal >> ");

    preOrderTraversal(node);

    System.out.println("");

    System.out.println("inOrderTraversal >> ");

    inOrderTraversal(node);

    System.out.println("");

    System.out.println("postOrderTraversal >> ");

    postOrderTraversal(node);

}

public static void preOrderTraversal(Node<Integer> node) {

    if (node != null) {

        System.out.print(" " + node.toString());
        preOrderTraversal(node.left);
        preOrderTraversal(node.right);
    }

}

public static void inOrderTraversal(Node<Integer> node) {

    if (node != null) {

        inOrderTraversal(node.left);
        System.out.print(" " + node.toString());
        inOrderTraversal(node.right);
    }

}

public static void postOrderTraversal(Node<Integer> node) {

    if (node != null) {

        postOrderTraversal(node.left);

        postOrderTraversal(node.right);

        System.out.print(" " + node.toString());
    }

} 
```

}

包数据结构；

公共类节点{

```
E value = null;
Node<E> left;
Node<E> right;

public E getValue() {
    return value;
}

public void setValue(E value) {
    this.value = value;
}

public Node<E> getLeft() {
    return left;
}

public void setLeft(Node<E> left) {
    this.left = left;
}

public Node<E> getRight() {
    return right;
}

public void setRight(Node<E> right) {
    this.right = right;
}

@Override
public String toString() {
    return " " +value;
} 
```

}

preOrderTraversal >> 4 2 1 3 6 5 7 inOrderTraversal >> 1 2 3 4 5 6 7 postOrderTraversal >> 1 3 2 5 7 6 4

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-11-10T09:54:30.470

```
void
inorder (NODE root)
{
  if (root != NULL)
    {
      inorder (root->llink);
      printf ("%d\t", root->info);
      inorder (root->rlink);
    }
} 
```

这是递归定义中序遍历最简单的方法，只需在主函数中调用该函数即可得到给定二叉树的中序遍历。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2014-02-25T17:35:26.143

预购是正确的，订单是nt

# string - 加权搜索算法来查找类似的联系人

> ID：486055
> 
> 赞同：0
> 
> 时间：2009-01-28T00:59:37.877
> 
> 标签：string, algorithm, comparison, street-address

我需要编写一个算法，根据用户输入的姓名和地址返回与联系人最接近的匹配项。这两者都令人不安，因为输入公司名称和地址的方法有很多，例如：

```
Company A, 123 Any Street Suite 200, Anytown, AK 99012
Comp. A, 123 Any St., Suite 200, Anytown, AK 99012
CA, 123 Any Street Ste 200, Anytown, AK 99012 
```

我已经研究过在名称上进行 Levenshtein 距离，但这似乎不是一个很好的工具，因为他们可以缩写名称。我正在寻找与尽可能多的信息相匹配的东西。

我最初的尝试是首先通过邮政编码的前 5 位限制结果，然后尝试根据其他信息过滤到一个，但必须有一个更标准的方法来完成这项工作。我在 .NET 中工作，但会查看您可以提供的任何代码，以了解如何完成此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T01:04:17.807

我现在不知道这是如何完成的，但所有主要的快递公司（FedEx、USPS、UPS）似乎都有办法将您输入的地址与他们的数据库进行匹配，并将其转换为规范化的形式。正如我在多个网站上看到的那样（想到亚马逊），我假设此功能有一个 API，但我不知道在哪里寻找它以及它是否适合您的目的。

不过只是一个想法。

**编辑：**我找到了[USPS API](http://www.usps.com/webtools/address.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-12T23:26:22.883

我通过地址规范化、Metaphone 和 Levenshtein 距离的组合解决了这个问题。您需要将姓名与地址分开，因为它们具有不同的特征。以下是您需要执行的步骤：

1) 使用邮政编码（前六个字符）缩小匹配范围。基本上，您需要计算两个字符串的 Levenshtein 距离，并选择距离最多为 1 或 2 的字符串。如果您确实需要加快搜索速度，您可以预先计算一个邮政编码表及其“Levenshtein 邻居”。

[http://en.wikipedia.org/wiki/Levenshtein_distance](http://en.wikipedia.org/wiki/Levenshtein_distance)

2) 使用来自 USPS 的官方前缀和后缀缩写列表将所有地址缩写转换为标准格式。这将有助于确保下一步的结果更加统一：

[https://www.usps.com/send/official-abbreviations.htm](https://www.usps.com/send/official-abbreviations.htm)

3) 使用 Methaphone 算法将地址转换为短代码。这将摆脱最常见的拼写错误。只需确保您的实现可以消除所有非单词字符，完整传递数字并处理多个单词（确保每个单词由单个空格分隔）：

[http://en.wikipedia.org/wiki/Metaphone](http://en.wikipedia.org/wiki/Metaphone)

4) 一旦您获得了使用 Levenshtein 距离比较地址字符串的 Methaphone 结果。通过将结果除以较长字符串中的字符数来计算更改分数的百分比。

5) 重复步骤 3 和 4，但现在使用名称而不是地址。

6) 使用以下公式计算每个条目的得分：（地址权重 * 地址得分）+（姓名权重 * 姓名得分）。根据更重要的因素选择您的权重。我会以 0.9 作为地址（因为地址更具体）和 0.1 作为名称开始，但权重可能取决于您的应用程序。选择得分最低的条目。如果分数太高（比如超过 0.15，您可以声明没有匹配项）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T04:01:01.833

这就是我会做的。我不知道算法，所以我只使用有意义的。

我假设此人会提供姓名、街道地址、城市名称、州名和邮政编码。

如果邮政编码以 9 个数字提供，或者有连字符，我会将其删除为 5 个数字。我将在数据库中搜索具有该邮政编码的所有地址。[查询 1] 然后我会将状态字母与数据库中的字母进行比较。如果它不匹配，那么我会告诉用户。城市名称也是如此。

据我了解，街道名称不是数字，只有街道上的房子有数字。此外，门牌号通常在开头，除非它是门牌号或套房号。

所以我会做正则表达式来搜索数字和旁边的下一个空格或逗号。然后找到第一个没有句点（。）或以逗号结尾的单词的位置。我有部分街道名称，因此我可以与之前获取的行进行比较，或者我将更改查询以使用街道名称 LIKE %streetName%。

我猜数据库有一个街区的房子的开始号码和结束号码。我会检查该街道行，以查看提供的街道号码是否在该街道上。到目前为止，您将知道要显示的正确数据，并且可以在不同的表中查找与该门牌号相关联的名称。我不知道你为什么要比较它。如果您想查找未提供地址的人，则仅用于名称比较。您可以在此处查找比较字符串方式[类似的字符串算法](https://stackoverflow.com/questions/451884/similar-string-algorithm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T01:09:37.937

我认为首先基于邮政编码进行过滤是最简单的，因为发现它是相当明确的。从那里你可能可以提取城市和街道。我不确定您将如何查找名称，但如果您已经有一个（名称，地址）对的数据库是可行的，那么它似乎与地址匹配。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T01:10:54.377

邓白氏就是这样做的。他们收费，因为这真的很难。没有“标准”解决方案。在像 D&B 这样的服务或推出自己的服务之间，这主要是一个痛苦的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T02:13:21.693

首先，我可能会进行单词索引搜索。这将意味着两个阶段：

离线阶段：通过关键字生成所有地址的索引。例如，“公司”、“A”和“123”都将成为您上面提供的地址的关键字。你可以做一些词干提取，这意味着对于像“street”这样的词，你还要在它的索引中添加一个词“st”。

在线阶段：用户给你一个搜索查询。将搜索查询分解为所有关键字，并在数据库中找到每个关键字的所有可能匹配项。统计每个地址上匹配关键字的数量。然后按匹配关键字的数量对结果进行排序。如果没有太多匹配，这应该能够很快完成，因为它只是几个排序列表合并和递增，最后是排序。

鉴于您知道问题的领域，您可以专门使用有关该领域的知识的算法 - 例如前面提到的邮政编码过滤。

也只是为了让我能够为您提供更好的答案，您是否使用 SQL 数据库？我问是因为我这样做的方式是将关键字索引存储在 SQL 数据库中，然后按关键字搜索的 SQL 查询变得非常容易，因为数据库完成了所有工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T02:17:54.787

也许与其仅将 Levenshtein 用作名称，不如将其与联系人的整个字符串表示形式一起使用时会很有用。例如，您的第一个示例到第二个示例的距离是 7，到第三个示例的距离是 9。考虑到字符串的长度为 54、50 和 45，这似乎是一个相对有用且非常简单的相似性度量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-05T19:26:01.790

如果您可以可靠地确定每个地址的一般结构（也许通过其他答案中的建议），您最好的选择是通过 USPS 认证运行数据（意思是：结果可靠、准确并符合联邦标准）地址验证服务。

@RyanDelucchi，这*是*一个有趣的问题，但只有在你解决了它之后。因此，@SteveBering，我建议将您的联系人列表提交给[列表处理服务](https://www.smartystreets.com/Products/CASS-Certified-Scrubbing/)，该服务将根据 USPS 指南根据地址标记重复项。

由于我在地址验证领域工作，我建议 SmartyStreets（我工作），因为它会为您的特定需求提供最大的价值——但是，有一些 CASS 认证的供应商会做基本类似的事情。

# visual-studio - 如何避免安装 Microsoft Visual Studio 2008 Team System Database Edition 以便能够在集中构建服务器上构建 DBPro 项目？

> ID：486056
> 
> 赞同：2
> 
> 时间：2009-01-28T01:00:24.803
> 
> 标签：visual-studio, visual-studio-2008, teamcity

我的解决方案中有一个 DBPro (DataDude) 项目，用于管理和版本化我的应用程序的数据库模式。我使用 TeamCity 4.0 进行持续集成。

为了能够构建 .dbproj，必须安装 MSBuild 任务及其各自的程序集，并安装其他 .dbschema 和 .xsd 依赖项。最简单的解决方案是在构建服务器上安装 VS2008 TS: Database Edition ..**这是我想避免的。**在 VSTSDB 安装的一些丢失的 XSD 文件构建失败后，我已经开始将文件一个一个地放置到位。

有没有人找到避免安装 VSTSDB 的简单方法？一个社区制作的“redist”安装程序，将正确的文件放在正确的位置并将正确的程序集放入 GAC？这个话题很难谷歌，所以我希望利用堆栈溢出知识库:)

我知道 Deploy 文件夹和 vsdbcmd.exe，但我想构建（和部署）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T03:31:01.347

不，不是根据Gert Drapers的这篇[文章](http://social.msdn.microsoft.com/Forums/en-US/vstsdb/thread/15ee69c1-27a7-43b1-a0c6-3adf0d772c28/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T13:54:19.193

问题是您是否能够使用命令行构建数据库（例如带有一些参数的 devenv.exe）？如果是这样，我认为安装开发环境并通过构建服务器上的 MSBuild 中的命令行任务执行没有问题。我在我管理的项目中为 MSI 安装程序做同样的事情。

# database - ArcGIS 中日期的默认值

> ID：486059
> 
> 赞同：2
> 
> 时间：2009-01-28T01:00:45.410
> 
> 标签：database, gis, arcgis

在 Microsoft SQL 中，我可以使用 GETDATE() 函数作为 DATETIME 字段的默认值。我希望能够为 ArcGIS 地理数据库中的日期字段做同样的事情。这是可能的，还是我仅限于文字值？

我的地理数据库使用的是 ArcSDE 9.1。具有定义属性的要素类是版本化的。

谢谢，

骆驼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T01:30:02.030

ArcGIS 通常利用外部数据库引擎，因此除非您谈论的是单个 shapefile，否则您的数据将存储在 Access、SQL Server 或 Oracle 中。除非您有 ArcSDE，否则它可能是 Access。您可以直接在数据库中定义数据并在其中分配默认值，然后从地图创作工具链接到表。

**编辑**在您最后发表评论后，我咨询了我的一位更精通 GIS 的朋友，她提供了以下内容

> 他们必须在数据库中定义表及其默认值，然后通过公共字段将表连接到要素类。重要的是不要将日期字段连接到要素类，在这种情况下，要素类将保留要素类中设置的值并忽略表值。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T00:27:11.353

我最终与 Esri 支持人员讨论了这个问题。他们确认版本化表不继承原始表的默认值（好吧，无论如何在 SQL Server 中）。

关于在表和要素类之间创建连接：

*   数据导出到形状文件并复制到 PocketPC 设备
*   数据输入是通过 ArcPad 应用程序
*   形状文件已同步并重新导入 SDE

所以基本上，DATETIME 默认值必须在导出/导入过程中存活下来。我没有测试这是否可能。最后，我以编程方式在 PocketPC 上插入了默认值。

# .net - 你用 ASP.NET MVC Action 方法做了什么聪明的事

> ID：486063
> 
> 赞同：24
> 
> 时间：2009-01-28T01:02:31.180
> 
> 标签：.net, asp.net-mvc, actionmethod

ASP.NET MVC 控制器操作方法主要用于处理“业务”操作，但它可以用于更多。

我认为看看人们创造了哪些创造性的、有用的东西可能对其他人实用或有用的行为会很有趣。

这是我的贡献：

**Javascript 文件连接器 -[减少 http 请求的数量：](http://developer.yahoo.com/performance/rules.html#num_http)**

```
 [OutputCache(Duration = 5 * 60, VaryByParam="")]  // DONT USE "None" here *
    public ContentResult RenderJavascript(){

        StringBuilder js = new StringBuilder();
        StringWriter sw = new StringWriter(js);

        // load all my javascript files
        js.AppendLine(File.ReadAllText(Request.MapPath("~/Scripts/jquery.hoverIntent.minified.js")));
        js.AppendLine(File.ReadAllText(Request.MapPath("~/Scripts/jquery.corner.js")));
        js.AppendLine(File.ReadAllText(Request.MapPath("~/Scripts/rollingrazor.js")));

        return new ContentResult()
        {
            Content = js.ToString(),
            ContentType = "application/x-javascript"
        };
    } 
```

映射到它的路线：

```
 // javascript
  routes.MapRoute(
     "js-route",
     "dynamic/js",
     new { controller = "Application", action = "RenderJavascript" }
  ); 
```

从您的母版页中引用它：

```
 <script type="text/javascript" src="/dynamic/js"></script> 
```

请注意，我已经为输出设置了缓存，因此如果您要更改 JS 并刷新页面，您可能需要禁用缓存！

我只是需要回来弄清楚如何压缩它。

`*`您不应该使用 VaryByParam="None" ，因为这会导致发送 Vary 标头，从而[导致浏览器返回并检查新版本](https://stackoverflow.com/questions/376851/expire-output-cache-asp-net-mvc#486072)。如果您真的需要更改您的 js 内容，那么您的用户将不得不等待 5 分钟！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-28T01:06:58.487

[HTTP 301 重定向](http://www.stum.de/2008/10/22/permanentredirectresult/)算不算聪明？

```
public class PermanentRedirectResult : ActionResult
{
    public string Url { get; set; }

    public PermanentRedirectResult(string url)
    {
        if (string.IsNullOrEmpty(url))
        {
            throw new ArgumentException("url is null or empty", "url");
        }
        this.Url = url;
    } 

    public override void ExecuteResult(ControllerContext context)
    {
        if (context == null)
        {
            throw new ArgumentNullException("context");
        }
        context.HttpContext.Response.StatusCode = 301;
        context.HttpContext.Response.RedirectLocation = Url;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T21:13:04.983

通过电子邮件确认查看结果：

```
public abstract class ViewResultWithConfirmationEmail: ViewResult
{
    protected readonly string toAddress;

    protected ViewResultWithConfirmationEmail(string toAddress)
    {
        this.toAddress = toAddress;
    }

    protected abstract MailMessage CreateEmail(ControllerContext context);

    protected override void ExecuteResult(ControllerContext context)
    {
        MailMessage message = CreateEmail(context);
        var smtpClient = new SmtpClient();
        smtpClient.Send(message);

        base.ExecuteResult(context);
    }
} 
```

这里省略了一些实现细节，但我可以使用它来实现一个`RegistrationSuccessResult`类，例如，在成功的用户注册后发送带有适当文本的电子邮件消息。

我选择在子类 ViewResult 中而不是在操作方法本身中发送消息的原因是为了更容易分离我的单元测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-24T16:56:56.220

[less](http://lesscss.org/index.html)的部分实现，一个 css 语法扩展器

它实际上只支持常量和他们所谓的 mixins，[源代码在这里](http://github.com/kentaromiura/less-for-C-/tree/master/)。

在[这篇文章](http://blogs.ugidotnet.org/MVPWannabe/archive/2009/06/18/lesser-less-per-c-e-asp.net-mvc.aspx)中，我解释了如何在 mvc 中使用它（这篇文章是意大利语的，但只需查看源代码）：

你可以看看 [这里的结果](http://borntobegeek.com/less.mvc/get/test1.css)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T21:59:50.437

实际上，不是“动作”方法，而是实现基于路由的 RPC 实现的自定义[控制器。](http://code.google.com/p/protobuf-net/source/browse/trunk/demo-rpc-server-mvc/Helpers/ProtoController.cs)它从路由数据中识别合约和方法，并将调用传递给服务器端服务实现。非常有效（是的，有正当理由我不只是使用 WCF 或 SOAP）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-09T12:26:34.157

不确定你们中有多少人在使用区域，但是在区域中进行视图更改时非常需要 XCopy 脚本。区域编译到父项目中，但仅在编译时（而不是在保存时），因此为了保持开发敏捷性，您需要运行 XCopy。

# c - 将字符串数组作为参数传递给 C 中的函数

> ID：486075
> 
> 赞同：14
> 
> 时间：2009-01-28T01:06:34.603
> 
> 标签：c, arrays, pointers, parameters, segmentation-fault

我想要一个简单的函数，它接收一个字符串并在解析后返回一个字符串数组。所以，这是我的函数签名：

```
int parse(const char *foo, char **sep_foo, int *sep_foo_qty) {
    int i;
    char *token;
    ...
    strcpy(sep_foo[i], token); /* sf here */
    ...
} 
```

然后我这样称呼它：

```
char sep_foo[MAX_QTY][MAX_STRING_LENGTH];
char foo[MAX_STRING_LENGTH];
int sep_foo_qty, error;

...

error = parse(foo, sep_foo, &sep_foo_qyt);

... 
```

这样我在编译期间会收到警告：

```
warning: passing argument 2 of 'parse' from incompatible pointer type 
```

然后在标有 /* sf here */ 的行中执行期间出现分段错误

我的 C 代码有什么问题？

提前致谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-28T01:13:04.217

警告是完全正确的。您的函数需要一个指针数组。你给它一个数组数组。

预期的：

```
sep_foo：
 +-----+ +-----+
 |char**|--> 0: |char*|-->"string1"
 +-----+ +-----+
             1: |char*|-->"string2"
                +-----+
*sep_foo_qty-1: |... |
                +-----+

```

您提供的内容：

```
           sep_foo：
           +--------------------------------+
        0：| 字符[MAX_STRING_LENGTH] |
           +--------------------------------+
        1：| 字符[MAX_STRING_LENGTH] |
           +--------------------------------+
MAX_QTY-1：| ... |
           +--------------------------------+

```

具有类型元素的数组`X`可以“衰减”为指向-`X`或的指针`X*`。但是`X`在该转换中不允许更改 的值。只允许进行*一次*衰减操作。你需要它发生两次。在您的情况下，`X`是 array-of- `MAX_STRING_LENGTH`-chars。该函数希望`X`成为指向字符的指针。由于它们不一样，编译器会警告您。我有点惊讶这只是一个警告，因为编译器允许发生的事情不会带来任何好处。

在您的函数中，您可以编写以下代码：

```
char* y = NULL;
*sep_foo = y; 
```

那是法律代码，因为`sep_foo`是 a `char**`，所以`*sep_foo`是 a `char*`，所以是`y`；你可以分配他们。但是，对于您尝试做的事情，*实际上*`*sep_foo`不会是; 它将指向一个字符数组。实际上，您的代码将尝试执行此操作：*`char*`*

 *```
char destination[MAX_STRING_LENGTH];
char* y = NULL;
destination = y; 
```

您不能将指针分配给数组，因此编译器会警告该调用不好。

有两种方法可以解决这个问题：

*   更改您`sep_foo`在调用方声明和分配的方式，使其与函数期望接收的内容相匹配：

    ```
    char** sep_foo = calloc(MAX_QTY, sizeof(char*));
    for (int i = 0; i < MAX_QTY; ++i)
      sep_foo[i] = malloc(MAX_STRING_LENGTH); 
    ```

    或者，等效地

    ```
    char* sep_foo[MAX_QTY];
    for (int i = 0; i < MAX_QTY; ++i)
      sep_foo[i] = malloc(MAX_STRING_LENGTH); 
    ```

*   更改函数的原型以接受你真正给它的东西：

    ```
    int parse(const char *foo, char sep_foo[MAX_QTY][MAX_STRING_LENGTH], int *sep_foo_qty); 
    ```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-28T01:13:39.580

参数 2 应该是

```
char sep_foo[][MAX_STRING_LENGTH] 
```

为了澄清，您将指针传递给 parse() 并将其视为指向指针的指针。C 中的多维数组不是指针数组。它是由数组变量指向的单个内存块。您不能取消引用它两次。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T01:18:27.777

`sep_foo`被定义为数组的数组。换句话说，当你使用 时`sep_foo`，它指向顺序内存的开始。这是一个模型：

```
(assume MAX_STRING_LENGTH = 16, MAX_QTY = 2)
sep_foo       = &&0000
sep_foo[0]    =  &0000
sep_foo[0][0] = *&0000 = 12
sep_foo[0][8] = *&0008 = 74
sep_foo[1]    =  &0010
sep_foo[1][0] = *&0010 = 12

0000  12 34 56 78  9A BC DE F0  74 10 25 89  63 AC DB FE
0010  12 34 56 78  9A BC DE F0  74 10 25 89  63 AC DB FE 
```

但是，您的函数需要一个指针数组（实际上是指向指针的指针）。这是这样建模的：

```
sep_foo_arg       =   &&0000
sep_foo_arg[0]    =  *&&0000 = &0010
sep_foo_arg[0][0] =  *&*&0000 = 12
sep_foo_arg[0][8] = *(&*&0000 + 8) = 74
sep_foo_arg[1]    =  *&&0002 = &0020
sep_foo_arg[1][0] = *&*&0000 = 12

0000  0010 0020  xxxx xxxx  xxxx xxxx  xxxx xxxx

0010  12 34 56 78  9A BC DE F0  74 10 25 89  63 AC DB FE
0020  12 34 56 78  9A BC DE F0  74 10 25 89  63 AC DB FE 
```

是的......我的解释可能有点令人困惑......

无论如何，您可以通过告诉您的函数如何处理指向的指针来解决此问题。特别是，您可能希望将其视为一个数组（一个内存序列）：

```
int parse(const char *foo, char (*sep_foo)[MAX_STRING_LENGTH], int *sep_foo_qty); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-28T01:11:52.940

如果那是您的确切代码，那么我猜测段错误是因为您没有为`char* token`解析函数内部分配内存，然后在 strcpy.xml 中使用它。

# c++ - 如何调用带参数的外部程序？

> ID：486087
> 
> 赞同：32
> 
> 时间：2009-01-28T01:09:59.043
> 
> 标签：c++, c, winapi, external-application

我想在我的代码中调用一个 Windows 程序，并在代码本身中确定参数。

我不想调用外部函数或方法，而是调用 WinXP 环境中的实际 .exe 或批处理/脚本文件。

C 或 C++ 将是首选语言，但如果使用任何其他语言更容易做到这一点，请告诉我（ASM、C#、Python 等）。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-28T03:42:15.413

当您调用 CreateProcess()、System() 等时，请确保将文件名字符串（包括命令程序文件名）双引号，以防文件名和/或完全限定路径有空格，否则部分文件名路径的名称将由命令解释器作为单独的参数进行解析。

```
system("\"d:some path\\program.exe\" \"d:\\other path\\file name.ext\""); 
```

对于 Windows，建议使用 CreateProcess()。它的设置更混乱，但您可以更好地控制进程的启动方式（如 Greg Hewgill 所述）。为了快速和肮脏，您还可以使用 WinExec()。（system() 可移植到 UNIX）。

启动批处理文件时，您可能需要使用 cmd.exe（或 command.com）启动。

```
WinExec("cmd \"d:some path\\program.bat\" \"d:\\other path\\file name.ext\"",SW_SHOW_MINIMIZED); 
```

（或者`SW_SHOW_NORMAL`如果您希望显示命令窗口）。

Windows 应该在系统 PATH 中找到 command.com 或 cmd.exe，因此 in 不需要完全限定，但如果您想确定可以使用[`CSIDL_SYSTEM`](http://msdn.microsoft.com/en-us/library/bb762494.aspx)（不要简单地使用 C:\Windows \system32\cmd.exe）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-28T01:24:30.340

C++ 示例：

```
char temp[512];
sprintf(temp, "command -%s -%s", parameter1, parameter2);
system((char *)temp); 
```

C# 示例：

```
 private static void RunCommandExample()
    {
        // Don't forget using System.Diagnostics
        Process myProcess = new Process();

        try
        {
            myProcess.StartInfo.FileName = "executabletorun.exe";

            //Do not receive an event when the process exits.
            myProcess.EnableRaisingEvents = false;

            // Parameters
            myProcess.StartInfo.Arguments = "/user testuser /otherparam ok";

            // Modify the following to hide / show the window
            myProcess.StartInfo.CreateNoWindow = false;
            myProcess.StartInfo.UseShellExecute = true;
            myProcess.StartInfo.WindowStyle = ProcessWindowStyle.Maximized;

            myProcess.Start();

        }
        catch (Exception e)
        {
            // Handle error here
        }
    } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-28T01:12:22.080

我认为您正在寻找 Windows API 中的[CreateProcess](http://msdn.microsoft.com/en-us/library/ms682425(VS.85).aspx)函数。实际上有一系列相关的电话，但这会让你开始。这很容易。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-28T01:19:27.200

最简单的方法之一是使用`system()`运行时库函数。它将单个字符串作为参数（比`CreateProcess`! 少得多的参数）并像在命令行上键入一样执行它。`system()`还会在返回之前自动等待进程完成。

还有一些限制：

*   您对已启动进程的标准输入和标准输出的控制较少
*   当另一个进程正在运行时，你不能做任何其他事情（比如决定杀死它）
*   您无法获取其他进程的句柄以便以任何方式查询它

运行时库还提供了一系列`exec*`函数（`execl`、`execlp`、`execle`、`execv`、`execvp`或多或少），这些函数源自 Unix 传统，并提供对进程的更多控制。

在最低级别，在 Win32 上，所有进程都由该`CreateProcess`函数启动，这为您提供了最大的灵活性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-25T16:42:19.617

简单的 c++ 示例（搜索了几个网站后找到）

```
#include <bits/stdc++.h>
#include <cassert>
#include <exception>
#include <iostream>

int main (const int argc, const char **argv) {
try {
    assert (argc == 2);
    const std::string filename = (const std::string) argv [1];
    const std::string begin = "g++-7 " + filename;
    const std::string end = " -Wall -Werror -Wfatal-errors -O3 -std=c++14 -o a.elf -L/usr/lib/x86_64-linux-gnu";
    const std::string command = begin + end;
    std::cout << "Compiling file using " << command << '\n';

    assert (std::system ((const char *) command.c_str ()) == 0);
    std::cout << "Running file a.elf" << '\n';
    assert (std::system ((const char *) "./a.elf") == 0);

    return 0; }
catch (std::exception const& e) { std::cerr << e.what () << '\n'; std::terminate (); }
catch (...) { std::cerr << "Found an unknown exception." << '\n'; std::terminate (); } } 
```

# c++ - 内部类可以访问私有变量吗？

> ID：486099
> 
> 赞同：134
> 
> 时间：2009-01-28T01:15:07.487
> 
> 标签：c++, inner-classes

```
class Outer {

    class Inner {
    public:
        Inner() {}
        void func() ;
    };

private:
    static const char* const MYCONST;
    int var;
};

void Outer::Inner::func() {
    var = 1;
}

const char* const Outer::MYCONST = "myconst"; 
```

当我使用类 Outer::Inner' 编译时出现此错误，没有名为 `var' 的成员

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2009-01-28T01:33:02.867

内部类是定义它的类的朋友。
所以，是的；类型对象可以访问类型对象`Outer::Inner`的成员变量。`var``Outer`

`Outer::Inner`但与 Java 不同的是，类型对象和父类对象之间没有关联。您必须手动建立父子关系。

```
#include <string>
#include <iostream>

class Outer
{
    class Inner
    {
        public:
            Inner(Outer& x): parent(x) {}
            void func()
            {
                std::string a = "myconst1";
                std::cout << parent.var << std::endl;

                if (a == MYCONST)
                {   std::cout << "string same" << std::endl;
                }
                else
                {   std::cout << "string not same" << std::endl;
                }
            }
        private:
            Outer&  parent;
    };

    public:
        Outer()
            :i(*this)
            ,var(4)
        {}
        Outer(Outer& other)
            :i(other)
            ,var(22)
        {}
        void func()
        {
            i.func();
        }
    private:
        static const char* const MYCONST;
        Inner i;
        int var;
};

const char* const Outer::MYCONST = "myconst";

int main()
{

    Outer           o1;
    Outer           o2(o1);
    o1.func();
    o2.func();
} 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-01-28T01:34:12.723

内部类可以访问外部类的所有成员，但它没有对父类实例的隐式引用（与 Java 的一些奇怪之处不同）。因此，如果您将对外部类的引用传递给内部类，它可以引用外部类实例中的任何内容。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-28T01:18:41.257

任何属于 Outer*一部分*的东西都应该可以访问 Outer 的所有成员，无论是公共的还是私人的。

编辑：你的编译器是正确的，var 不是 Inner 的成员。但是如果你有一个指向 Outer 实例的引用或指针，它就可以访问它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-10-10T04:12:12.023

首先，您试图访问`var`C++ 中不允许的类之外的非静态成员。

马克的回答是正确的。

> 任何属于 Outer 一部分的东西都应该可以访问 Outer 的所有成员，无论是公共的还是私人的。

所以你可以做两件事，要么声明`var`为`static`或使用外部类实例的引用来访问'var'（因为[朋友类或函数](https://pencilprogrammer.com/cpp-tutorials/friend-function-and-class/)也需要引用来访问私有数据）。

**静态变量**

更改`var`为`static`如果您不想`var`与类的实例相关联。

```
#include <iostream>

class Outer {

private:
    static const char* const MYCONST;
    static int var;

public:
   class Inner {
    public:
        Inner() {
          Outer::var = 1;
        }
        void func() ;
    };
};

int Outer::var = 0;

void Outer::Inner::func() {
    std::cout << "var: "<< Outer::var;
}

int main() {
  Outer outer;
  Outer::Inner inner;
  inner.func();

} 
```

输出变量：1

**非静态变量**

对象的引用是访问任何非静态成员变量的必要条件。

```
#include <iostream>

class Outer {

private:
    static const char* const MYCONST;
    int var;

public:
   class Inner {
    public:
        Inner(Outer &outer) {
          outer.var = 1;
        }
        void func(const Outer &outer) ;
    };
};

void Outer::Inner::func(const Outer &outer) {
    std::cout << "var: "<< outer.var;
}

int main() {
  Outer outer;
  Outer::Inner inner(outer);
  inner.func(outer);

} 
```

输出变量：1

*编辑 - 外部链接是指向我的博客的链接。*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-20T15:08:11.153

var 不是内部类的成员。

要访问 var，应使用指向外部类实例的指针或引用。例如，如果内部类是外部类的朋友，则 pOuter->var 将起作用，或者，如果严格遵循 C++ 标准，则 var 是公共的。

一些编译器将内部类视为外部类的朋友，但有些可能不会。[有关IBM 编译器，](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/cplr061.htm)请参阅此文档：

“嵌套类在另一个类的范围内声明。嵌套类的名称对其封闭类是本地的。除非您使用显式指针、引用或对象名称，否则嵌套类中的声明只能使用可见结构，包括封闭类和全局变量中的类型名称、静态成员和枚举数。

嵌套类的成员函数遵循常规访问规则，并且对其封闭类的成员没有特殊的访问权限。封闭类的成员函数对嵌套类的成员没有特殊的访问权限。”

# latex - 在新环境中重新定义命令

> ID：486104
> 
> 赞同：14
> 
> 时间：2009-01-28T01:16:34.023
> 
> 标签：latex, tex

两个问题：

1.  LaTeX 是否允许（重新）定义 a 中的命令`\newenvironment`？我试过使用`\renewcommand`,`\newcommand`和*之前*`\def`的声明，但无济于事。

**   `\item`在创建新的列表环境时如何重新定义？* 

 *`\newenvironment`我使用while 使用另一个令牌而不是for each从头开始​​创建了一种新型列表环境，`\item`但我真的很想通过使用`\list`和重新定义`\item`.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T20:31:23.743

也许为时已晚，但它可能对其他人有用

```
\newenvironment{coolitemize}{%
\let\olditem\item% 
\renewcommand\item[2][]{\olditem \textbf{##1}\\[0.3\baselineskip]##2}%
\begin{itemize}}{\end{itemize}%
} 
```

并使用它

```
\begin{coolitemize}
\item[Title of my first item] Text of my 1st item.
\item[Second one] And some text here.
\end{coolitemize} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-28T04:41:27.650

当然; 如果不查看您的代码，很难知道出了什么问题。作为对您的两个问题的回答，看看这是否有帮助：

```
\documentclass{article}
\begin{document}
\newenvironment{myitemize}{%
  \begin{list}{}{}% whatever you want the list to be
  \let\olditem\item
  \renewcommand\item{\olditem ITEM: }
}{%
  \end{list}
}  
\begin{myitemize}
\item one \item two
\end{myitemize}
\end{document} 
```

# c# - 为什么 CSharpOptParse UsageBuilder 仅在 NUnit 测试中使用时由于 XPathException 而失败？

> ID：486119
> 
> 赞同：0
> 
> 时间：2009-01-28T01:22:39.267
> 
> 标签：c#, xslt, nunit, csharpoptparse

这个问题的根本原因是什么？CSharpOptParse、XslTransform.Transform(...) 还是 NUnit？如果这个问题无法修复，我可以使用其他什么等效的库来代替它，这是积极支持的？

我正在使用[CSharpOptParse](http://sourceforge.net/projects/csharpoptparse)的 1.0.1 版本，它最后一次修改是在 2005 年 2 月。

我有以下类（当然为本示例进行了简化）与 CSharpOptParse 一起使用：

```
public enum CommandType
{
   Usage
}

public class Options
{
   [OptDef(OptValType.Flag)]
   [LongOptionName("help")]
   [Description("Displays this help")]
   public bool Help { get; set; }

   public CommandType CommandType
   {
      get { return CommandType.Usage; }
   }
} 
```

这是一些复制问题的单元测试代码：

```
TextWriter output = Console.Out;

Options options = new Options { Help = true };
Parser p = ParserFactory.BuildParser(options);
p.Parse();

output.WriteLine("Usage: Console [--a]");
UsageBuilder builder = new UsageBuilder();
builder.BeginSection("Arguments:"); 
builder.AddOptions(p.GetOptionDefinitions()); //could the issue be created here?
builder.EndSection();
builder.ToText(output, OptStyle.Unix, true); //The problem occurs here 
```

我是否有可能通过没有使用正确的部分设置 UsageBuilder 来导致问题？可能这可能会导致 xslt 文件出现问题？？？

当我运行该代码时，出现以下异常：

```
 System.Xml.XPath.XPathException : Function 'ext:FormatText()' has failed.
    ----> System.Reflection.TargetInvocationException : Exception has been thrown by the target of an invocation.
      ----> System.ArgumentOutOfRangeException : Index was out of range. Must be non-negative and less than the size of the collection.
    Parameter name: startIndex
       at MS.Internal.Xml.XPath.FunctionQuery.Evaluate(XPathNodeIterator nodeIterator)
       at System.Xml.Xsl.XsltOld.Processor.ValueOf(ActionFrame context, Int32 key)
       at System.Xml.Xsl.XsltOld.ValueOfAction.Execute(Processor processor, ActionFrame frame)
       at System.Xml.Xsl.XsltOld.ActionFrame.Execute(Processor processor)
       at System.Xml.Xsl.XsltOld.Processor.Execute()
       at System.Xml.Xsl.XsltOld.Processor.Execute(TextWriter writer)
       at System.Xml.Xsl.XslTransform.Transform(XPathNavigator input, XsltArgumentList args, TextWriter output, XmlResolver resolver)
       at System.Xml.Xsl.XslTransform.Transform(IXPathNavigable input, XsltArgumentList args, TextWriter output, XmlResolver resolver)
       at CommandLine.OptParse.UsageBuilder.ToText(TextWriter writer, OptStyle optStyle, Boolean includeDefaultValues, Int32 maxColumns)
--TargetInvocationException
    at System.RuntimeMethodHandle._InvokeMethodFast(Object target, Object[] arguments, SignatureStruct& sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner)
    at System.RuntimeMethodHandle.InvokeMethodFast(Object target, Object[] arguments, Signature sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner)
    at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)
    at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
    at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)
    at System.Xml.Xsl.XsltOld.XsltCompileContext.FuncExtension.Invoke(XsltContext xsltContext, Object[] args, XPathNavigator docContext)
    at MS.Internal.Xml.XPath.FunctionQuery.Evaluate(XPathNodeIterator nodeIterator)
    --ArgumentOutOfRangeException
    at System.String.LastIndexOfAny(Char[] anyOf, Int32 startIndex, Int32 count) 
```

我不知道是什么导致了这个问题....最奇怪的部分是它只发生在我的 NUnit 测试中。当通过“Console.exe --help”调用此代码时，它运行良好，没有异常。我看不出 CSharpOptParse 有什么问题，所以这可能是 .NET 的 XslTransform 类或 NUnit 中的问题吗？

有没有其他人遇到过这个问题？有人对如何追踪问题或切换到更好的图书馆有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-12-29T22:11:01.340

我知道这是一个老问题。但..

导致异常的原因是该`ToText()`方法尝试确定控制台的宽度，并且当您写入任何不是真正的控制台时它会失败。

修复很简单：设置固定宽度。

将对 ToText 的调用更改为：

```
try
{
    usage.ToText(Console.Out, OptStyle.Unix, true);
}
catch
{
    usage.ToText(Console.Out, OptStyle.Unix, true, 90);
} 
```

现在，如果正常调用失败，它将尝试故障安全调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T02:00:23.997

为什么不将调试器附加到 NUnit，打开 First-Chance 异常，然后找出发生了什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-08T17:18:52.217

我遇到了同样的问题，似乎已经解决了（不确定这样做会导致什么问题，但一切似乎都正常）。

寻找：

```
public TextTransformHelper(int maxColumns)
        {
            _maxColumns = maxColumns;

            if (_maxColumns == -1)
            {
                // try to determine console width
                string os = Environment.GetEnvironmentVariable("OS");

                if (os != null && os.StartsWith("Win"))
                {
                    ConsoleUtils.ConsoleHelper ch = new ConsoleUtils.ConsoleHelper();
                    _maxColumns = ch.GetScreenInfo().Size.X;
                }
            }
        } 
```

然后将其修改为以下内容：

```
public TextTransformHelper(int maxColumns)
    {
        _maxColumns = maxColumns;

        if (_maxColumns == -1)
        {
            // try to determine console width
            string os = Environment.GetEnvironmentVariable("OS");

            if (os != null && os.StartsWith("Win"))
            {
                ConsoleUtils.ConsoleHelper ch = new ConsoleUtils.ConsoleHelper();
                _maxColumns = ch.GetScreenInfo().Size.X;
                if(_maxColumns == 0) //added
                    _maxColumns = -1; //added
            }
        }
    } 
```

它爆炸的原因是因为在 FormatText 函数中，它具有以下 if 语句，如果未定义列宽或为 -1，则该语句应该被命中。对我来说，该函数将始终返回 0，这将导致下面的 if 语句不被命中，然后导致“ArgumentOutOfRange”异常。这是在 Windows Server 2008 上：

```
if (_maxColumns == -1)
                {
                    output.Append((first) ? indentStr : handingIndentStr);
                    output.Append(line);
                    output.Append(Environment.NewLine);
                    first = false;
                    continue;
                } 
```

我能够通过查看“ext:FormatText”失败错误然后在所有 FormatText 函数（xslt 正在调用 C# 函数）上设置断点来调试它，然后查看异常并进一步调试。

我希望这有帮助。

约翰·雷内迈尔

# php - Zend 框架中的通用、包罗万象的操作……可以做到吗？

> ID：486143
> 
> 赞同：4
> 
> 时间：2009-01-28T01:36:13.437
> 
> 标签：php, zend-framework, zend-framework-mvc

这种情况是由于有人想在他们的网站中创建自己的“页面”而不必创建相应的操作。

所以说他们有一个像 mysite.com/index/books 这样的 URL... 他们希望能够创建 mysite.com/index/booksmore 或 mysite.com/index/pancakes 但不必在索引控制器中创建任何操作. 他们（可以做简单 html 的非技术人员）基本上想要创建一个简单的静态页面，而无需使用操作。

就像索引控制器中会有一些通用操作来处理对不存在操作的请求。你如何做到这一点，甚至有可能吗？

**编辑：**使用 __call 的一个问题是缺少视图文件。缺少动作变得没有意义，但现在您必须处理丢失的视图文件。如果找不到异常，框架将抛出​​异常（尽管如果有办法让它重定向到丢失的视图文件上的 404 __call 是可行的。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-01-24T22:22:17.513

使用魔术`__call`方法可以正常工作，您所要做的就是检查视图文件是否存在，如果不存在则抛出正确的异常（或执行其他操作）。

```
public function __call($methodName, $params)
{
    // An action method is called
    if ('Action' == substr($methodName, -6)) {
        $action = substr($methodName, 0, -6);

        // We want to render scripts in the index directory, right?
        $script = 'index/' . $action . '.' . $this->viewSuffix;

        // Script file does not exist, throw exception that will render /error/error.phtml in 404 context
        if (false === $this->view->getScriptPath($script)) {
            require_once 'Zend/Controller/Action/Exception.php';
            throw new Zend_Controller_Action_Exception(
                sprintf('Page "%s" does not exist.', $action), 404);
        }

        $this->renderScript($script);
    }

    // no action is called? Let the parent __call handle things.
    else {
        parent::__call($methodName, $params);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T02:13:15.937

你必须玩路由器 [http://framework.zend.com/manual/en/zend.controller.router.html](http://framework.zend.com/manual/en/zend.controller.router.html)

我认为您可以指定一个通配符来捕获特定模块上的每个操作（默认为减少 url）并定义一个操作来处​​理根据 url 呈现视图（甚至调用的操作）

```
new Zend_Controller_Router_Route('index/*', 
array('controller' => 'index', 'action' => 'custom', 'module'=>'index') 
```

在您的 customAction 函数中，只需检索参数并显示正确的块。我还没有尝试过，所以你可能需要稍微破解一下代码

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T19:08:52.260

如果您想使用 gabriel1836 的 _call() 方法，您应该能够禁用布局和视图，然后呈现您想要的任何内容。

```
$this->_helper->layout()->disableLayout();
$this->_helper->viewRenderer->setNoRender(true); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-31T04:49:34.047

我需要让现有的模块/控制器/操作在 Zend Framework 应用程序中正常工作，然后有一个包罗万象的路由，将任何未知的内容发送到 PageController，它可以从数据库表中挑选用户指定的 url 并显示页面。我不想在用户指定的 url 前面有一个控制器名称。我希望 /my/custom/url 而不是 /page/my/custom/url 通过 PageController。所以上述解决方案都不适合我。

我最终扩展了 Zend_Controller_Router_Route_Module: 使用几乎所有的默认行为，并且只是稍微调整了控制器名称，所以如果控制器文件存在，我们照常路由到它。如果它不存在，那么 url 一定是一个奇怪的自定义 URL，所以它被发送到 PageController，整个 url 作为参数保持不变。

```
class UDC_Controller_Router_Route_Catchall extends Zend_Controller_Router_Route_Module
{
    private $_catchallController = 'page';
    private $_catchallAction     = 'index';
    private $_paramName          = 'name';

    //-------------------------------------------------------------------------
    /*! \brief takes most of the default behaviour from Zend_Controller_Router_Route_Module
        with the following changes:
        - if the path includes a valid module, then use it
        - if the path includes a valid controller (file_exists) then use that
            - otherwise use the catchall
    */
    public function match($path, $partial = false)
    {
        $this->_setRequestKeys();

        $values = array();
        $params = array();

        if (!$partial) {
            $path = trim($path, self::URI_DELIMITER);
        } else {
            $matchedPath = $path;
        }

        if ($path != '') {
            $path = explode(self::URI_DELIMITER, $path);

            if ($this->_dispatcher && $this->_dispatcher->isValidModule($path[0])) {
                $values[$this->_moduleKey] = array_shift($path);
                $this->_moduleValid = true;
            }

            if (count($path) && !empty($path[0])) {
                $module = $this->_moduleValid ? $values[$this->_moduleKey] : $this->_defaults[$this->_moduleKey];
                $file = $this->_dispatcher->getControllerDirectory( $module ) . '/' . $this->_dispatcher->formatControllerName( $path[0] ) . '.php'; 
                if (file_exists( $file ))
                {
                    $values[$this->_controllerKey] = array_shift($path);
                }
                else
                {
                    $values[$this->_controllerKey] = $this->_catchallController;
                    $values[$this->_actionKey] = $this->_catchallAction;
                    $params[$this->_paramName] = join( self::URI_DELIMITER, $path );
                    $path = array();
                }
            }

            if (count($path) && !empty($path[0])) {
                $values[$this->_actionKey] = array_shift($path);
            }

            if ($numSegs = count($path)) {
                for ($i = 0; $i < $numSegs; $i = $i + 2) {
                    $key = urldecode($path[$i]);
                    $val = isset($path[$i + 1]) ? urldecode($path[$i + 1]) : null;
                    $params[$key] = (isset($params[$key]) ? (array_merge((array) $params[$key], array($val))): $val);
                }
            }
        }

        if ($partial) {
            $this->setMatchedPath($matchedPath);
        }

        $this->_values = $values + $params;

        return $this->_values + $this->_defaults;
    }
} 
```

所以我的 MemberController 可以作为 /member/login、/member/preferences 等正常工作，并且可以随意添加其他控制器。仍然需要 ErrorController：它捕获现有控制器上的无效操作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-24T20:36:50.323

我通过重写 dispatch 方法并处理找不到操作时抛出的异常来实现一个包罗万象的方法：

```
public function dispatch($action)
{
    try {
        parent::dispatch($action);
    }
    catch (Zend_Controller_Action_Exception $e) {
        $uristub = $this->getRequest()->getActionName();
        $this->getRequest()->setActionName('index');
        $this->getRequest()->setParam('uristub', $uristub);
        parent::dispatch('indexAction');
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T02:01:49.623

你可以使用神奇的[__call()](http://us3.php.net/manual/en/language.oop5.overloading.php#language.oop5.overloading.methods)函数。例如：

```
public function __call($name, $arguments) 
{
     // Render Simple HTML View
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T02:18:53.350

stunti 的建议是我这样做的方式。我的特定解决方案如下（这使用您指定的任何控制器的 indexAction()。在我的情况下，每个操作都使用 indexAction 并根据 url 从数据库中提取内容）：

1.  获取路由器的实例（一切都在您的引导文件中，顺便说一句）：

    $router = $frontController->getRouter();

2.  创建自定义路由：

    $router->addRoute('controllername', new Zend_Controller_Router_Route('controllername/*', array('controller'=>'controllername')));

3.  将新路由传递给前端控制器：

    $frontController->setRouter($router);

我没有使用 gabriel 的 __call 方法（只要您不需要视图文件，它确实适用于缺少的方法），因为这仍然会引发有关缺少相应视图文件的错误。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-08T20:57:20.860

为了将来参考，基于 gabriel1836 和 ejunker 的想法，我挖掘了一个更切中要害的选项（并支持 MVC 范式）。此外，阅读“使用专门的视图”比“不使用任何视图”更有意义。

```
 // 1\. Catch & process overloaded actions.
public function __call($name, $arguments)
{
    // 2\. Provide an appropriate renderer.
    $this->_helper->viewRenderer->setRender('overload');
    // 3\. Bonus: give your view script a clue about what "action" was requested.
    $this->view->action = $this->getFrontController()->getRequest()->getActionName();
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-26T14:44:33.857

@Steve 如上所述-您的解决方案对我来说听起来很理想，但我不确定您是如何在引导程序中实现它的？

# performance - PostgreSQL 临时表

> ID：486154
> 
> 赞同：86
> 
> 时间：2009-01-28T01:40:11.493
> 
> 标签：performance, postgresql, optimization, temp-tables

我需要执行 250 万次查询。此查询生成一些我需要的行，`AVG(column)`然后使用它`AVG`从低于平均值的所有值中过滤表。然后我需要将`INSERT`这些过滤后的结果放到一个表格中。

以合理的效率做这样的事情的唯一方法似乎是`TEMPORARY TABLE`为每个 query-postmaster python-thread 创建一个。我只是希望这些`TEMPORARY TABLE`s 不会（根本）保存在硬盘驱动器中，并且会保留在内存（RAM）中，当然，除非它们的工作内存不足。

我想知道 TEMPORARY TABLE 是否会导致磁盘写入（这会干扰 INSERTS，即整个过程缓慢）

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2009-02-17T05:48:31.833

请注意，在 Postgres 中，临时表的默认行为是它们不会被自动删除，并且数据在提交时被持久化。见[`ON COMMIT`](http://www.postgresql.org/docs/current/interactive/sql-createtable.html)。

但是，临时表[在数据库会话结束时被删除](http://www.postgresql.org/docs/current/interactive/sql-createtable.html#AEN67422)：

> 临时表在会话结束时自动删除，或者在当前事务结束时自动删除。

您必须考虑多个因素：

*   如果您确实想`DROP`在事务结束时显式创建临时表，请使用`CREATE TEMPORARY TABLE ... ON COMMIT DROP`语法创建它。
*   **在存在连接池的情况下**，一个数据库会话可能跨越多个客户端会话；为避免冲突`CREATE`，您应该删除临时表 - 在返回池连接之前（例如，通过在事务中执行所有操作并使用`ON COMMIT DROP`创建语法），*或*根据需要（通过在任何`CREATE TEMPORARY TABLE`语句之前使用一个对应的`DROP TABLE IF EXISTS`，它的优点是也可以在外部事务中工作，例如，如果连接用于自动提交模式。）
*   当临时表在使用中时，在溢出到磁盘之前有多少可以放入内存？请参阅中的[`temp_buffers`](http://www.postgresql.org/docs/current/interactive/runtime-config-resource.html#RUNTIME-CONFIG-RESOURCE-MEMORY)选项`postgresql.conf`
*   经常使用临时表时我还应该担心什么？删除临时表后建议使用真空，以清除目录中的任何死元组。`auto_vacuum`使用默认设置 ( )时，Postgres 将每 3 分钟左右自动为您清理一次。

此外，与您的问题无关（但可能与您的项目有关）：请记住，如果您必须在填充临时表*后*对其运行查询，那么创建适当的索引并发出`ANALYZE`on是个好主意插入完成*后*有问题的临时表。默认情况下，基于成本的优化器会假设新创建的临时表有大约 1000 行，如果临时表实际上包含数百万行，这可能会导致性能不佳。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-28T06:19:04.597

临时表只提供一种保证——它们在会话结束时被删除。对于一个小表，您可能会将大部分数据放在后备存储中。对于大型表，我保证数据会定期刷新到磁盘，因为数据库引擎需要更多工作空间来处理其他请求。

编辑：如果您绝对需要仅 RAM 的临时表，您可以在 RAM 磁盘上为您的数据库创建一个表空间（/dev/shm 有效）。这会减少磁盘 IO 的数量，但请注意，目前在没有物理磁盘写入的情况下无法做到这一点；创建临时表时，数据库引擎会将表列表刷新到稳定存储。

# visual-studio - 最佳实践：IDE 代码配色方案和字体

> ID：486158
> 
> 赞同：9
> 
> 时间：2009-01-28T01:40:52.803
> 
> 标签：visual-studio, color-scheme

我正在阅读[http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)并注意到用于在 Visual Studio 中说明他们的代码。

长时间后，白色背景开始伤害我的眼睛，但我发现黑色也很粗糙。

有没有人有该配色方案的导出版本，或者在 leiu 中，愿意分享他们的配色方案，以便为每天在 Visual Studio 中花费大约 15 小时的开发人员找到？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T01:47:18.920

我不确定哪种配色方案是最好的——这在很大程度上取决于您的个人喜好。但是请查看以下页面以了解一些方案

*   [工作室风格](https://studiostyl.es/)
*   [http://www.hanselman.com/blog/](http://www.hanselman.com/blog/VisualStudioProgrammerThemesGallery.aspx)
*   [你的 IDE 热还是不热？](http://blog.codinghorror.com/is-your-ide-hot-or-not/)
*   [Visual Studio 主题生成器](http://www.frickinsweet.com/tools/Theme.mvc.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T02:03:09.513

[尝试从此页面](http://www.hanselman.com/blog/VisualStudioProgrammerThemesGallery.aspx)中的“Ruby Blue” 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T02:08:06.600

[曾本](http://slinky.imukuppi.org/zenburnpage/)

哦，还有 Jeff Atwood [Zenburn VS2005的 VS2005 端口](http://www.codinghorror.com/blog/archives/000682.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T02:08:21.313

Consolas 字体对我来说非常好用。它是为开发人员设计的。 [http://www.microsoft.com/downloads/details.aspx?familyid=22e69ae4-7e40-4807-8a86-b3d36fab68d3&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=22e69ae4-7e40-4807-8a86-b3d36fab68d3&displaylang=en)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-03T13:42:04.123

专为 Coding 设计的好字体：http: [//input.fontbureau.com/](http://input.fontbureau.com/)

# jquery - 使用 jQuery 的 CSS 伪类

> ID：486159
> 
> 赞同：2
> 
> 时间：2009-01-28T01:40:58.963
> 
> 标签：jquery, css, pseudo-class

我刚刚学了一点 jQuery，并试图用它来实现简单的变色效果。假设我有两个`<div`>，#foo 和#bar。#foo 有很多 URL，并定义了以下 CSS：

```
#foo a {color: blue; border-bottom: 1px dashed blue}
#foo a:hover {color: black; border-bottom: 1px solid black} 
```

现在我想在用户单击#bar时更改#foo中链接（a：link）的颜色，但保持a：hover颜色不变，所以我这样编写函数：

```
//...
$("#bar").click(function () {
  $("#foo a").css("color", "red");
});
//... 
```

问题是，虽然这个函数确实将所有链接变为红色，但 a:hover 颜色丢失了，即当用户将光标移到链接上时，它们将保持红色，而不是像我预期的那样变黑。

由于我看到 jQuery 所做的是将内联样式放入`<a`#foo 中的 >s 中，使它们成为`<a style="color:red;" href="..."`>，我想这将覆盖 :hover 伪类。由于任何人都没有实现伪类的内联样式 attr，所以我怀疑我是否能得到我想要的效果......

仍然，是否有任何解决方案不需要我写类似的东西

```
$("#foo a").hover(
    function(){ $(this).css("color", "black");},
    function(){ $(this).css("color", "blue");}
) 
```

?

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-05-12T16:17:47.297

摘自[Setting CSS Pseudo Class Rules From Javascript](https://stackoverflow.com/questions/311052/setting-css-pseudo-class-rules-from-javascript)

实际上，您可以在悬停时更改类的值，或者使用 :after 或任何您想要使用 javascript 的伪类：

```
$(document).ready(function()
{
    var left = (($('.selected').width() - 7) / 2) + 'px';
    document.styleSheets[1].insertRule('.selected:after { left: ' + left + '; }', 0);
    document.styleSheets[0].cssRules[0].style.left = left;
}); 
```

我希望这对任何人都有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T01:54:34.630

!important 似乎使 css 属性比内联样式更强大，至少在 Firefox 中是这样。尝试将您的样式更改为以下内容：

```
#foo a:hover { color: black !important; } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-10T12:20:12.310

AFAIK，jQuery 不能设置伪类。但是，还有另一种方法：

[http://www.4pmp.com/2009/11/dynamic-css-pseudo-class-styles-with-jquery/](http://www.4pmp.com/2009/11/dynamic-css-pseudo-class-styles-with-jquery/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T01:56:06.143

当您将鼠标悬停在链接上时，也许您可​​以删除添加的类，如下所示：

```
$('#bar').click(function() {
  $('#foo a').css('color', 'red');
});
$('#foo').hover() {
  $'#foo a').removeCss('color', 'red');
}); 
```

[编辑]：您可能首先需要添加一个 IF 语句来查看该类是否存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-08T19:56:28.947

使用 Javascript 执行此操作的另一种讨厌的方法是清空容器元素并再次使用内容填充它并再次设置单击事件。这会破坏所有状态和事件，因此必须重新设置它们，但对于不包含大量数据的简单事物，它可以工作！

我将它用于使用 :hover 类的导航菜单。

```
$('#page_nav ul').click(clearNavMenu_Hover);

function clearNavMenu_Hover() {
    var tmpStore=$('#page_nav').html();
    $('#page_nav').empty();
    $('#page_nav').html(tmpStore);
    $('#page_nav ul').click(clearNavMenu_Hover);
} 
```

# java - jdbc本身是否与mysql兼容

> ID：486168
> 
> 赞同：0
> 
> 时间：2009-01-28T01:43:07.883
> 
> 标签：java, mysql, jdbc

我想知道 jdbc 本身是否与 mysql 兼容，还是我必须安装一些额外的东西？有人告诉我它不兼容，我必须使用不同的数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T01:44:30.003

确实如此。

您必须使用正确的 mysql jdbc 驱动程序，仅此而已！

一些有用的链接：

有点旧但仍然有帮助：

[将 JDBC 与 MySQL 一起使用，入门](http://www.developer.com/java/data/article.php/3417381)

官方参考：

[官方 JDBC 驱动程序](http://dev.mysql.com/downloads/connector/j/5.1.html)

[JDBC 参考](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html)

您必须查看您的特定版本。

毕竟 MySQL 现在属于 Sun Microsystems

[从 Java 中使用 MySQL](http://dev.mysql.com/usingmysql/java/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T23:38:07.543

JDBC 是 Java/数据库交互的**规范**。作为规范，它几乎与每个数据库兼容。但是，您需要为您的数据库编写符合 JDBC 的驱动程序。谷歌搜索“jdbc driver {databasevendor}”应该让你找到正确的轨道。

# php - PHP：抑制函数内的输出？

> ID：486181
> 
> 赞同：35
> 
> 时间：2009-01-28T01:47:21.900
> 
> 标签：php, function, output-buffering

抑制函数可能产生的任何输出的最简单方法是什么？说我有这个：

```
function testFunc() {
    echo 'Testing';
    return true;
} 
```

我想调用 testFunc() 并在页面中不显示“测试”的情况下获取其返回值。*假设这*将在输出其他内容的其他代码的上下文中，是否有这样做的好方法？也许弄乱了输出缓冲区？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-01-28T01:54:12.947

是的，弄乱[输出缓冲区](http://php.net/outcontrol)正是答案。只需在调用将输出的方法之前将其打开（不是函数本身，而是在调用它的位置，您可以将其包裹在整个脚本或脚本流中，但您可以通过仅使其尽可能“紧密”将它包装在方法的调用上）：

```
function foo() {
  echo "Flush!";
  return true;
}

ob_start();
$a = foo();
ob_end_clean(); 
```

并且不生成任何输出。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-28T01:52:43.263

干得好：

```
ob_start();
testFunc();
ob_end_clean(); 
```

“ob”代表“输出缓冲”，请查看此处的手册页：[http ://www.php.net/outcontrol](http://www.php.net/outcontrol)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T01:56:31.117

是的，您在利用 PHP 的输出缓冲函数方面是正确的，即 ob_start 和 ob_end_clean（在 php.net 上查找它们）：

```
<?php
  function testFunc() {
    echo 'Testing';
    return true;
  }

    ob_start();
    $output = testFunc();
    ob_end_clean();

    echo $output;
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T01:54:26.363

对代码应用一些条件不是那么简单吗？

我的意思是如果变量=测试然后输出，否则不？

对于结果直接输出到浏览器（如 EVAL）的函数，您可以在 ob_start 中捕获结果。

# javascript - 超越难倒；IE 中的奇怪 JQuery 循环行为

> ID：486184
> 
> 赞同：1
> 
> 时间：2009-01-28T01:49:39.197
> 
> 标签：javascript, jquery, ruby-on-rails, internet-explorer

我正在使用[JQuery Cycle Plugin](http://malsup.com/jquery/cycle/)来尝试淡入/淡出幻灯片放映的图像。我能够让它在 Firefox 和 Safari 中运行，但是，当我在 Internet Explorer 中查看时，我看到了非常意外的行为。

在 Internet Explorer 中，循环按预期进行，但某些图像未显示。它们只是显示一个红色的 X。可以在此处查看示例站点：

[http://913solutions.com/richmond-va/siding](http://913solutions.com/richmond-va/siding)

第一张图片不会在 IE 中显示，但会在 Firefox 和 Safari 中显示。这几乎就像 IE 在服务器上根本找不到图像一样。直接上图：

[http://913solutions.com/images/siding/siding1-350px.jpg](http://913solutions.com/images/siding/siding1-350px.jpg)

我完全迷失在这里。谁能验证我的情况？有没有人见过这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T01:59:51.937

它没有在 chrome 中显示，这让我认为它是损坏的 jpg，我在 notepad++ 中打开它并注意到一堆 xml/非二进制数据，它可能只是评论或其他东西，但我不知道，也许该信息会帮助解决问题。

xml 的开头如下所示：

```
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>com.apple.print.PageFormat.PMHorizontalRes</key>
    <dict>
        <key>com.apple.print.ticket.creator</key>
        <string>com.apple.jobticket</string> 
```

看起来这里有更多关于它的信息：

[http://osdir.com/ml/video.image-magick.user/2002-09/msg00477.html](http://osdir.com/ml/video.image-magick.user/2002-09/msg00477.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T04:03:28.663

检查您的图像是否为 72 像素/英寸。

通常，如果您从打印作品中创建 jpg，它们的分辨率为 300 像素/英寸，即使它们的尺寸正确……它们可能无法在所有浏览器中正确显示。

# android - 在任何移动平台上从前置摄像头捕获视频

> ID：486194
> 
> 赞同：2
> 
> 时间：2009-01-28T01:52:56.180
> 
> 标签：android, mobile, camera, java-me, windows-mobile

我正在进行一个针对手机（更像是掌上电脑）的项目。我找不到在任何平台上（可靠地）访问前置摄像头的方法（我尝试过 Android、J2ME 和 Windows Mobile），更不用说从所述摄像头捕获视频了。

谁能提供有关如何在 Windows Mobile、Symbian/J2ME 或任何其他平台上实现这一点的任何见解？

**编辑**：我试过搜索[API 文档](http://msdn.microsoft.com/en-us/library/bb158743.aspx)，但没有提到前置摄像头。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T12:30:31.373

我在 J2ME 和 Symbian (S60) 中都这样做了。对于 Symbian 示例，请查看此[示例](http://www.forum.nokia.com/info/sw.nokia.com/id/9fd0e9a7-bb4b-489d-84ac-b19b4ae93369/S60_Platform_Camera_Example_with_AutoFocus_Support.html)（您可能需要注册到诺基亚论坛），为了使用前置摄像头，只需使用摄像头索引 1 进行初始化（索引 0 是后置摄像头）：

```
m_pCamera = CCamera::NewL(*this, 1) 
```

尽管使用 CCamera::CamerasAvailable() 确保设备确实有前置摄像头（如果它有前置摄像头和后置摄像头，则该调用将返回 2）。

对于 J2ME，请查看 SDN 中的此[示例](http://developers.sun.com/mobility/midp/articles/picture/)，而不是像这样初始化默认摄像头（后置摄像头）：

```
mPlayer = Manager.createPlayer("capture://video"); 
```

您只需要初始化前置摄像头：

```
mPlayer = Manager.createPlayer("capture://devcam1"); 
```

享受！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T02:05:04.907

大约一年前，我对此进行了一些修改，Windows Mobile 为静态和视频提供了[相机捕捉 API](http://msdn.microsoft.com/en-us/library/bb158743.aspx)。所有示例都随移动 SDK 方便地提供。

**编辑：**我知道它说的是移动 6.0，但它也可用于移动 5.0

# java - 遍历二维 Java 数组

> ID：486197
> 
> 赞同：2
> 
> 时间：2009-01-28T01:53:40.047
> 
> 标签：java, arrays, iterator

```
public static List<Vertex<Integer>> petersenGraph() {
    List<Vertex<Integer>> v = new ArrayList<Vertex<Integer>>();

    for (int i = 0; i < 10; i++) {
        v.add(new Vertex<Integer>(i));
    }

    int[][] edges =
    {{0,1}, {1,0}, {1,2}, {2,1}, {2,3}, {3,2}, {3,4}, {4,3}, {4,0}, {0,4},
    {5,6}, {6,5}, {6,7}, {7,6}, {7,8}, {8,7}, {8,9}, {9,8}, {9,5}, {5,9},
    {5,0}, {0,5}, {6,2}, {2,6}, {7,4}, {4,7}, {8,1}, {1,8}, {9,3}, {3,9}};

    for (int[] e : edges)
        v.get(e[0]).successors().add(v.get(e[1]));

    return v;
} 
```

我了解所有内容，直到有 for which 迭代边缘。那里到底发生了什么？

`e[0]`编辑：为什么使用and访问它们`e[1]`？是`e[0]`第一个数字和`e[1]`第二个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T02:01:11.450

啊，太丑了。

edge 是一个二维数组，所以它是一个 int 数组的数组。在实际定义中，它是一对数组。

(int[] e: edges) 的行只是意味着在每次迭代中， e 将成为不同的整数数组，因此在每次迭代中它是不同的对。

然后，e[0] 代表该对中的第一项，而 e[1] 代表另一个。所以第一个坐标用于查找一个顶点，然后发生了一些事情，第二个坐标被添加进来。没有看到顶点或不知道算法，它是不清楚的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T01:56:56.920

多维数组`edges`实际上是“数组的数组”。该`for`语句一次提取一个元素`edges`，每个元素`edges`都是一个`int[]`.

所以第一次通过循环时， e 将是`{0, 1}`。将是第二次`{1, 0}`。将是第三次`{1, 2}`。等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T17:30:10.407

它创建的图表上的维基百科页面是[http://en.wikipedia.org/wiki/Petersen_graph](http://en.wikipedia.org/wiki/Petersen_graph)。

从外观上看，图中的边由 Vertex.successors 集合表示，**edges**数组用于构造图，使用第一个索引作为每个边的*from*节点，第二个索引作为*to*节点。

这也可以解释为什么每一对都跟着它的对立面，例如 {0,1}, {1,0}，因为彼得森图是无向的，所以节点之间的连接必须在两个方向上表示。

# delphi - 更新 Delphi 2009 默认安装的 Indy 10 的正确方法是什么？

> ID：486210
> 
> 赞同：6
> 
> 时间：2009-01-28T01:58:35.497
> 
> 标签：delphi, delphi-2009, indy

由于 Indy 现在已内置到 Delphi 2009 的安装过程中......是否有适当的方法来“删除”它，以便可以从 SVN 存储库升级到最新版本？据我所知，没有自动删除它的选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T02:29:57.290

Indy的*dcu*文件与其他 Delphi 单元分开存储。要停止使用它们，只需从搜索路径、库路径等中删除该目录，然后从浏览路径中删除源文件。

您可以像删除任何其他设计时包一样删除设计时包。从 IDE 配置中删除它们，然后删除*bpl*和*dcp*文件。（如果您只是删除文件，下次启动 IDE 时可能会出错，因为它不会找到预期的文件。）

一旦 Indy 组件不再出现在工具面板上，包不再出现在包列表中，并且编译引用 Indy 单元的项目失败并出现“找不到使用的单元”错误，您就可以开始安装了最新版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T07:29:58.230

正如 Rob 已经说过的：只需从 Delphi 的配置中删除目录即可。但是需要一个额外的步骤：每次更新后，确保它们没有被再次添加！一些 Delphi 2007 更新显然做到了这一点，我错过了很长一段时间，直到我偶然发现了一个我认为已经修复的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T08:05:26.863

我没有使用 Delphi 2009，但在旧版本的 Delphi 中，安装 Indy 组件是可选的。因此，您可以尝试启动 Delphi 2009 的设置，看看是否有“添加/删除功能”或类似选项的选项，并使用它来删除 Indy。

此外，您可以自定义应在项目中加载哪些包，因此您可以简单地取消选择 Indy 10 并在每个项目的基础上从 SVN 添加一个（您也可以为项目配置默认配置）。

PS。印地岩石！:-)

# css - UL 清单样式不适用

> ID：486211
> 
> 赞同：56
> 
> 时间：2009-01-28T01:58:39.367
> 
> 标签：css, list, yui-grids

我有一个样式表，无论出于何种原因，它都不会将 list-style-type 应用于 UL 元素。我正在使用 YUI 的 Grid CSS 和他们的 reset-fonts-grid.css 文件，我知道作为 CSS 重置的一部分将其剥离。

调用 YUI 后，我调用了网站的样式表，其中有一个 UL 块：

```
ul {list-style-type: disc;} 
```

我也尝试通过列表样式设置它，但得到相同的结果。我知道上面的 CSS 块正在被读取，就好像我添加了填充或边距之类的东西，它们确实被应用了。样式类型没有出现在 Firefox 或 IE 中。

我应用于 UL 的唯一其他 CSS 是在 #nav div 中，但 CSS 不涉及 list-style-type，它使用 YUI 提供的重置，YUI 和站点样式表是仅有的两个 CSS被调用的工作表。

我在网站的管理端也有 FCKEditor，该编辑器确实显示了项目符号样式，所以我知道它必须是 FCKEditor 没有过滤的 CSS 的东西。

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2009-05-13T07:12:42.547

您需要在 CSS 中包含以下内容：

`li { display: list-item; }`

这会触发 Firefox 显示光盘。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2010-08-09T20:54:25.243

如果您使用的 reset.css 使所有边距为空，您还可以提供左边距：这意味着：

```
li {
list-style: disc outside none;
display: list-item;
margin-left: 1em;
} 
```

假设您在重置**后**应用此 css ，它应该可以工作！

马修·里考

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-01-28T02:29:26.700

如果我没记错的话，您应该将此规则应用于 li，而不是 ul。

```
ul li {list-style-type: disc;} 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2012-11-20T20:57:00.487

> 我遇到了这个问题，结果发现我在 ul 上没有任何填充，这阻止了光盘可见。

保证金也与此混淆

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2012-05-15T19:30:50.877

此问题是由在父类`li` `display`中设置的属性引起的。`block`覆盖`list-item`解决了问题。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2011-02-01T08:40:05.980

确保没有`overflow: hidden`应用“li”。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-08-23T18:35:56.883

我的`reset.css`是`margin: 0, padding: 0`。经过几个小时的查找和故障排除后，这有效：

```
li {
    list-style: disc outside none;
    margin-left: 1em;
}

ul {
    margin: 1em;
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-04-25T10:56:09.090

我遇到了这个问题，结果发现我在 ul 上没有任何填充，这阻止了光盘可见。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-28T02:07:01.767

*   您是否尝试过使用 !important 遵循规则？
*   FireBug 显示哪个样式表对元素具有最后控制权？
*   这是生活在其他人可以观看的地方吗？

### 更新

> 我相当有信心提供代码示例将帮助您更快地获得解决方案。如果您可以在某处上传此问题的示例，或提供标记以便我们可以在本地主机上对其进行测试，那么您将有更好的机会获得一些有价值的输入。
> 
> 问题的问题在于它们会导致其他人相信提出问题的人有足够的知识来提出问题。在编程中并非总是如此。可能有一些你错过的东西，或者不小心漏掉了。如果其他人没有看到你的代码，他们就不得不假设你什么都没有错过，也没有忽略任何东西。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-28T02:26:55.363

我所能想到的就是事后有什么东西压倒了它。

您*首先*包括重置样式，对吗？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-07-12T11:11:23.053

在 IE 中，我只使用一个类“normal_ol”来设置 ol 列表的样式，并进行了一些修改，如下所示：

**之前的代码：** ol.normal_ol { float:left; 填充：0 0 0 25px；边距：0；width:500px;} ol.normal_ol li{ font:normal 13px/20px Arial; 颜色：#4D4E53；向左飘浮; 宽度：100%；}

**修改代码：** ol.normal_ol { float:left; 填充：0 0 0 25px；margin:0;} ol.normal_ol li{ 字体:normal 13px/20px Arial; 颜色：#4D4E53；}

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-28T12:46:15.737

事实证明，YUI 的重置 CSS 从“ul li”而不是“ul”中删除了列表样式，这就是为什么在“ul”中设置它从来没有奏效。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-08T03:35:09.743

你所要做的就是将这个类添加到你的 CSS 中。

```
.ul-no-style { list-style: none; padding: 0; margin: 0; } 
```

**包括设置为 0 的内边距和边距。**

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-10-30T10:27:26.823

确保您没有在`li`标签中设置显示属性，在我的情况下，由于某种原因`display: flex`，我的标签上有一个属性。`li`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-02-01T15:57:32.867

请使用内联 CSS

```
<li style="disply:list-item">my li content </li> 
```

# delphi - 为什么 Indy 9 包含在 Delphi 2009 中？使用安全吗？

> ID：486217
> 
> 赞同：6
> 
> 时间：2009-01-28T02:00:46.630
> 
> 标签：delphi, delphi-2009, indy

为什么会有 Indy9 文件夹（C:\Program Files\CodeGear\RAD Studio\6.0\source\Indy 的默认安装文件夹包含“Indy9”和“Indy10”的子目录） 为什么两个版本都安装了？什么在使用 Indy9？我不认为它已经在 2009 年更新了……Indy9 现在可以安全地与 Delphi 2009 一起使用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T15:57:18.930

有一个已[打开的 QC 报告](http://qc.codegear.com/wc/qcmain.aspx?d=66207)与此相关，但它仅对 QC 管理员可见。

“开放”的状态通常意味着它被接受这是一个错误，而不是设计。

[Remy Lebeau](https://stackoverflow.com/users/61334/remy-lebeau) - Indy 开发人员之一 - [说](https://forums.codegear.com/thread.jspa?messageID=16637)：

> 2009 安装程序附带 Indy 9 源代码，但在安装过程中不可选择。文档中有一条说明，如果需要，可以手动安装 Indy 9。但请记住，Indy 9 尚未更新为实际支持 2009。目前，我不确定是否会支持。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T02:06:56.400

Indy9 是为了兼容性。Indy10 中有一些重大更改（您针对 Indy9 编写的代码可能无法在 Indy10 下编译），因此您可以选择继续使用 Indy9（我认为安装程序会提示并询问您要使用什么 Indy - 至少确实如此与 D2007）。

更新：好的，一些人正确地评论说 Indy9 不能与 D2009 一起编译（因为新的 Unicode 支持），所以我想我不知道它为什么会存在。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-01T20:19:49.057

Indy 9（从 2007 版本开始）有一些更改，因此它将在 Delphi 2009 下编译（一些 String 到 AnsiString 的更改），但根据我的测试它不起作用。它尝试连接，但没有连接。如果您愿意，我可以为您提供为 Unicode 支持添加的更改，但我认为它们还不够。

我真的无法回答为什么。我可以推测一些原因，但我没有任何内幕消息。

使用安全吗？YMMV。Indy 有很多东西，所以可能有一些部分适合您的项目。即使是使用 TIdTCPClient 进行的简单测试，每次都会导致 Socket Error #11004。TIdHTTP 相同。好像我以前尝试过 MD5，但它只是垃圾，但我不确定那个。

回答：***它被错误地包含（假设），并且使用不安全（基于有限的测试）。***

这很不幸，因为 Indy 10 也有问题，而且我有一些使用 Indy 9 的旧版应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-31T19:26:46.497

我猜，它在源代码树中，并被安装程序自动包含在内。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T18:59:41.467

请记住，除非您告诉 Delphi 重新编译它们，否则不会使用源文件。如果您没有企业版，您甚至不会拥有这些文件夹。

# delphi - Delphi 2009 和 Synapse - 经过测试并准备好支持 Unicode？

> ID：486230
> 
> 赞同：4
> 
> 时间：2009-01-28T02:06:13.500
> 
> 标签：delphi, delphi-2009, synapse

Synapse 是否已准备好用于 Delphi 2009 生产应用程序？他们的网站看起来好像有一段时间没有更新了： [http](http://www.ararat.cz/synapse/doku.php) ://www.ararat.cz/synapse/doku.php 项目死了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T16:22:09.523

我一直在使用 SVN 存储库中的最新版本，在使用 Delphi 2009 编译的商业应用程序中没有任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T08:11:26.260

D2009 支持未发布，但您可以直接从[svn 存储库](http://sourceforge.net/mailarchive/forum.php?thread_name=4A0D26D2-46D3-4747-90F7-7FCD054F1CE0%40emailaya.com&forum_name=synalist-public)下载，如果您浏览那里的代码，您会看到 D2009 兼容性的更改

[http://synalist.svn.sourceforge.net/viewvc/synalist/trunk/](http://synalist.svn.sourceforge.net/viewvc/synalist/trunk/)

# javascript - jquery互斥点击

> ID：486237
> 
> 赞同：0
> 
> 时间：2009-01-28T02:08:10.593
> 
> 标签：javascript, jquery

我有 3 个 div，每个 div 有 2 个可能的图像标签（活动或非活动）。如果单击一个 div 以激活其他 div，则必须将其设置为非活动。如何使用 img 标签完成此操作，如果用户禁用了 javascript 会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T03:20:49.060

你的意思是这样的吗？

```
<div class="block" id="block1">
    <img src='inactive_block1.jpg'>
</div>

<div class="block" id="block2">
    <img src='inactive_block2.jpg'>
</div>

<div class="block" id="block3">
    <img src='inactive_block3.jpg'>
</div> 
```

使用像[jQuery](http://www.jquery.com)这样的库，javascript 看起来像：

```
$(function() {
    $('.block').click(function() {
       $('#block1').find('img').attr('src', 'inactive_block1.jpg');
       $('#block2').find('img').attr('src', 'inactive_block2.jpg');
       $('#block3').find('img').attr('src', 'inactive_block3.jpg');
       $(this).find('img').attr('src', 'active_' + $(this).attr('id') + '.jpg');
    });
}); 
```

有了上面，如果你有, 和 ,你`inactive_block1.jpg`应该得到`inactive_block2.jpg`你想要的。`inactive_block3.jpg``active_block1.jpg``active_block2.jpg``active_block3.jpg`

禁用 javascript 后备是否值得取决于您，这主要取决于您是否希望大量受众禁用 javascript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T02:19:05.813

如果用户禁用了 JavaScript，则您无法使用基于 JavaScript 的方法来处理动态修改页面。您唯一的其他选择是创建功能的“已弃用”版本，每次单击后都需要页面请求。

我建议研究如何从 DOM 中的元素中动态添加/删除类，这就是我解决这个问题的方法。您可以轻松地为单击时“活动”的所有元素执行 jQuery 选择，并在它们上设置“禁用”类，这样您实际上就可以屏蔽除您单击的元素之外的所有内容。

那有意义吗？

# css - CSS margin-bottom 折叠了 - 但为什么呢？

> ID：486244
> 
> 赞同：0
> 
> 时间：2009-01-28T02:12:43.410
> 
> 标签：css, margin

我有这个简单的 xhtml：

```
<?xml version="1.0" encoding="UTF-8"?>    
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" style="height: 100%;">
<head>
</head>
<body style="height: 100%;">
  <div style="height: 100%; overflow: auto; background-color: #00f;">
    <div style="height: 400px; margin-bottom: 2000px; background-color: #f00;"></div>
  </div>
</body>
</html> 
```

它显示了两个矩形 - 但较低的（蓝色）一个不显示 2000px 边距。它只有窗户那么高。为什么？或者更重要的是，我如何让它展示出来？我可以在这两者之间添加一些像“aaa”这样的虚拟文本，`</div>` `</div>`但我认为这不是正确的做法。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T02:21:06.527

如果您希望 400px div 下方有 2000px 的蓝色，请进行以下更改：

*将包含 div 的高度更改为其内容的高度 + 2000px 空间。*

```
<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" style="height: 100%;">

<head> </head>

<body style="height: 100%;">

  <div style="height: 2400px; overflow: auto; background-color: #00f;">

    <div style="height: 400px; background-color: #f00;">
    </div>

  </div>

</body>

</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T02:41:29.357

删除您`height: 100%`的`<body>`：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" style="height: 100%;">
<head>
</head>
<body>
  <div style="height: 100%; overflow: auto; background-color: #00f;">
    <div style="height: 400px; margin-bottom: 2000px; background-color: #f00;"></div>
  </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T02:45:48.053

去掉`height`蓝色背景 div 中的声明。

```
<?xml version="1.0" encoding="UTF-8"?>    
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" style="height: 100%;">
<head>
</head>
<body style="height: 100%;">
  <div style="background-color: #00f;overflow:auto">
    <div style="height: 400px; margin-bottom: 2000px; background-color: #f00;"></div>
      </div>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T02:49:51.277

这是因为您在包含 div 上设置了高度。边距不是内容，因此它们不会触发溢出。您可以在最里面的 div 周围添加另一个 div，并给它一个 1px 的填充，或者，正如其他人建议的那样，您可以调整现有的包含 div。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T02:59:24.423

lotusvskoi：谢谢，但是身体滚动，而不是外部 div。

恩达什：是的！就是这个！非常感谢，也谢谢你的解释。用 padding: 1px 将最里面的 div 包裹在另一个 div 中效果很好！

最终版本，用于存档：

 `````
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" style="height: 100%;">
<head>
<style>
</style>
</head>
<body style="height: 100%;">
<div style="height: 100%; overflow: auto; background-color: #00f;">
<div style="padding-bottom: 1px;">
<div style="height: 400px; margin-bottom: 2000px; background-color: #f00;">
</div>
</div>
</div>
</body>
</html> 
````  `# c++ - 类设计建议 - C++

> ID：486252
> 
> 赞同：0
> 
> 时间：2009-01-28T02:18:08.577
> 
> 标签：c++, virtual-functions

**背景**

我正在开发一个语音转换器程序，它将英语文本转换为等效的区域语言文本。区域语言的字符将多于英文字母，并且区域语言字体使用字体中的几乎所有位置 (1-255)。

我的程序支持不同的字体，我创建了一个字体类，它有方法可以访问字符。这个类将有 255 个方法，每个方法代表每个字符。所有这些都被标记为*虚拟*，以便新字体可以覆盖必要的字符方法。

这个字体类中的方法很简单。所有方法都是单行的。例子是

```
string StandardFont::consonant1(){
    return "a";
}

string StandardFont::consonant2(){
    return "b";
}

.. 
```

**问题**

1.  单个类中的 255 个虚函数会产生任何性能问题吗？我知道*vtable*的东西，但我不确定它在这种情况下有多大的影响。
2.  任何人都可以为这门课推荐一个替代设计吗？主要设计目标是允许派生类覆盖必要的方法。我曾考虑将字符添加到*地图*或*矢量*等容器中，并提供获取字符的方法。但是由于我将有 255 个项目并且经常使用这个类，所以我认为每次我必须循环容器来获取角色，这又是一个问题。

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T02:22:48.880

我建议您使用非 ASCII（区域）字符的标准编码。

标准编码称为“unicode”，例如[http://www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)

无论如何：回答你的问题......

> 单个类中的 255 个虚函数会产生任何性能问题吗？

一句话：不，不会。

> 但是由于我将有 255 个项目并且经常使用这个类，我认为每次我必须循环容器来获取角色，这又是一个问题。

使用长度为 256 的向量或定长数组，您不需要循环……而是可以直接索引，例如：

```
const char* translations[256] = {
 "a",
 "bee",
 "c!",
 ...etc...
};

const char* translate(char c)
{
  //use the character as an index into the array
  int index = c;
  //use the translation array (using indexing, not looping)
  const char* result = translations[index];
  return result;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T02:23:46.430

255 个虚函数通常不会导致性能问题（除非您的类的每个实例都有一个很大的 VTable，这将非常轻微地影响缓存）。

但是，255 个虚拟功能通常会导致维护噩梦。

如果我正确理解您的描述，那么您需要的是：

1) 创建一个以区域语言表示字符的类，可能带有返回图像或任何您需要的方法。

2) Create 是表示字符集的类的层次结构。

3) 字符集的每个实例都将维护从位置到字符类实例的映射。

4）有一个获取索引并返回对象的函数。

这种设计的一个好处是您可以使用一些相同的字形（例如，对于数字）拥有多个字符集。

说了这么多，为什么不使用 Unicode 和 16 位字符？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T02:25:58.157

我认为使用单一方法而不是 255 方法来访问字符会更干净。我想到了索引/下标。

您能否说明如何使用这些类？由于语言和字母不同，我觉得你会以相同的方式引用多个字母很奇怪。从各个角度来看，字母都是任意的。它们在不同的语言中将是不同的且不相关的。

Unicode 的目标是为您的问题提供解决方案。你考虑过使用它吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T02:26:35.660

解决您的速度问题，拥有 255 个虚拟方法不会导致任何特定的性能损失，尽管通常的建议适用：如果您不确定它将如何执行，找出它的唯一方法是对其进行基准测试。

话虽如此，很可能有更好的方法来解决这个问题。如果您提供有关此字体类应该做什么的更多详细信息，将会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T02:57:54.583

为什么不只有一个 255 个字符的向量？

每个“字体”只是在数组中安装不同的字符？甚至是 Character 类？

或者你可以使用地图或其他东西

255方法绝对不是要走的路。

# sql - 检查表中是否存在行的最有效方法是什么？

> ID：486270
> 
> 赞同：5
> 
> 时间：2009-01-28T02:27:26.717
> 
> 标签：sql, mysql, performance

假设我想检查 MySQL 表中的记录是否存在。我会运行一个查询，检查返回的行数。如果 0 行执行此操作，否则执行此操作。

```
SELECT * FROM table WHERE id=5
SELECT id FROM table WHERE id=5 
```

这两个查询之间有什么区别吗？是花在返回每一列上的努力，还是花在过滤掉我们不关心的列上的努力？

```
SELECT COUNT(*) FROM table WHERE id=5 
```

是一个全新的问题。服务器会抓取所有值然后计算这些值（比平常更难），还是它不会费心抓取任何东西而每次找到匹配项时都增加一个变量（比平常更容易）？

我想我对 MySQL 的工作原理做了很多错误的假设，但这就是问题的核心！我哪里错了？教育我，堆栈溢出！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T02:32:59.327

优化器非常聪明（通常）。他们通常只抓住他们需要的东西，所以我会选择：

```
SELECT COUNT(1) FROM mytable WHERE id = 5 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T03:52:49.620

最明确的方式是

SELECT WHEN EXISTS (SELECT 1 FROM table WHERE id = 5) THEN 1 ELSE 0 END

如果在 id 上（或以 id 开头）有索引，它只会以最高效率搜索索引中它可以找到具有该值的第一个条目。它不会读取记录。

如果您 SELECT COUNT(*) （或 COUNT 其他任何内容），它将在相同情况下计算索引条目，但不读取记录。

如果您选择 *，它将读取所有记录。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T02:34:53.007

如果您只想检查记录的存在，请通过附加 LIMIT 1 将结果限制为最多一行。

```
SELECT id FROM table WHERE id=5 LIMIT 1 
```

这肯定会确保返回或处理的行不超过一行。根据我的经验，检查行是否存在的 LIMIT 1（或 TOP 1，取决于数据库）在大型表的性能方面有很大的不同。

编辑：我想我误读了你的问题，但如果有任何帮助，我还是会把我的答案留在这里。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T03:37:15.237

我会认为这

```
SELECT null FROM table WHERE id = 5 LIMIT 1; 
```

会比这更快

```
SELECT 1 FROM table WHERE id = 5 LIMIT 1; 
```

但计时器显示获胜者是“SELECT 1”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T02:36:54.250

对于前两个查询，大多数人通常会说，始终准确指定您需要的内容，其余的保留。努力并非都是特定的，因为带宽可能用于返回您甚至不会做任何事情的数据。

至于前面的答案将适用于您的结果集，除非您正在处理支持受影响行的语言。这有时可以在获取数据以收集有关上次查询中返回的行数的信息时起作用。您需要查看界面文档以了解如何获取该信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T16:31:34.580

您的 3 个查询之间的差异取决于您构建索引的方式。仅返回主键可能会更快，因为 MySQL 会将您的索引保存在内存中，而不必访问磁盘。添加`LIMIT 1`也是一个很好的技巧，它将在早期的 5.0.x 分支和更早的分支中显着加速优化器。

尝试`EXPLAIN SELECT id FROM table WHERE id=5`检查 Extras 列中是否存在`USING INDEX`. 如果它在那里，那么您的查询直接来自索引，并且会更快。

# javascript - dragover 鼠标事件包含使用 javascript 的 XUL 应用程序中的文件信息

> ID：486271
> 
> 赞同：0
> 
> 时间：2009-01-28T02:28:35.890
> 
> 标签：javascript, xul, xulrunner

我正在编写一个使用 JavaScript 进行编码的 XUL 应用程序。我希望能够将文件拖到此应用程序中的控件上，并在拖放时显示它们。

这看起来几乎和[这里](https://developer.mozilla.org/En/DragDrop/Dragging_and_Dropping_Multiple_Items)的教程完全一样，但是当我在调试器中插入拖放事件处理程序时，事件的 dataTransfer 成员不存在！

我应该怎么做？

谢谢，内森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T02:46:29.957

这些[功能](https://developer.mozilla.org/En/DragDrop/Drag_and_Drop)是在[Firefox 3.1](http://www.mozilla.com/en-US/firefox/all-beta.html)和[XULRunner 1.9.1](http://starkravingfinkle.org/blog/2009/01/unofficial-xulrunner-191-builds/)中添加的，因此请确保您使用的是正确的版本。请注意，这些构建仍处于测试阶段。

用于拖放的旧 API 在[这里](https://developer.mozilla.org/en/Drag_and_Drop)。

# c - Linux中的非阻塞挂载

> ID：486272
> 
> 赞同：4
> 
> 时间：2009-01-28T02:29:03.407
> 
> 标签：c, linux, mount

`mount(2)`我在单线程进程中使用 Linux 的功能。但是像 CD-ROM 这样的设备的安装可能需要一段时间（我见过的最糟糕的是 40 秒！），因为它会考虑一点，启动磁盘，然后才会安装文件系统。这可能会在相当长的时间内阻止进程处理其他事件。

我似乎找不到以非阻塞方式挂载文件系统的方法。**有没有办法在没有多线程或分叉的情况下异步挂载文件系统？**

知道操作是否完成对我来说不是问题，因为我已经在同一个线程中阅读了内核 uevents。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-28T02:34:26.890

不，没有启动另一个线程或`fork()`ing，你必须等待`mount()`返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T02:50:10.947

如果您想以单线程方式执行此操作，您可以手动执行 mount 命令并将其置于后台并使用 select() 或其他方式轮询完成。然而，这很骇人听闻，与在程序中分叉和调用 mount() 并没有太大区别。

另外值得注意的是，我经历过 mount() 阻塞整个进程（和相关线程），所以对于真正的异步行为，分叉可能是要走的路。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T08:23:06.313

您可以让安装过程在后台运行。运行类似的东西：

```
system("mount -a "); 
```

做

```
system("mount -a &"); 
```

这将使安装在后台为您完成。

但是仔细看了一下，这个方案不是用C接口而是用系统接口

# c# - 在 C# 中实现功能

> ID：486283
> 
> 赞同：1
> 
> 时间：2009-01-28T02:35:51.083
> 
> 标签：c#, c#-3.0, functional-programming

我知道在 C# 3.0 中，您可以使用 Linq 和 lambda 表达式以及所有这些东西来做一些函数式编程魔术。但是，真的有可能在 C# 中实现完全“纯”功能吗？“纯”是指拥有纯的方法（总是为相同的输入提供相同的输出）并且完全没有副作用。我们如何绕过 C# 中甚至没有不可变整数类型这一事实？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T02:41:58.530

如果您想以纯粹的功能方式编程，没有什么能阻止您。

另一方面，如果您有一些程序，则没有可以翻转的魔术标志来强制程序以纯函数方式运行。

对于整数（不可变）

*   如果使用 int 作为参数，则按值传递。任何更改都不会传播给调用者。
*   如果您在方法内的闭包中使用在一个方法的范围内声明的 int，则该 int 变量是共享的。在这种情况下，必须保证不修改 int（程序员强制执行），或者干脆不以这种方式使用 int。

如果你真的需要一个不可变的 int，你见过`readonly`关键字吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T02:39:02.670

你看过F#吗？它似乎更符合您所谈论的内容。C# 在设计时并没有考虑到函数式编程，因此不会真正为您提供通常与函数式语言相关的任何好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T02:42:46.250

不幸的是，没有 - C# 不是一种纯粹的函数式语言，它也不打算成为。发生的事情是，C# 团队已经看到向语言添加某些功能样式的构造和语法有好处。

在其他地方可以更好地找到功能纯度（Lisp 衍生产品，如 Common Lisp 和 Scheme 是很好的起点）。

# iphone - 为了重新排列 UITableView 行，我必须实施哪些方法？

> ID：486289
> 
> 赞同：6
> 
> 时间：2009-01-28T02:37:45.200
> 
> 标签：iphone, objective-c, cocoa-touch, uitableview

对于使用称为行的字符串的 NSMutableArray 的简单示例，我必须在表控制器中实现什么才能移动 tableView 行并将更改反映在我的数组中？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-28T02:45:44.543

在这里，我们进行繁重的工作。

```
 - (void)tableView:(UITableView *)tableView 
moveRowAtIndexPath:(NSIndexPath *)fromIndexPath 
       toIndexPath:(NSIndexPath *)toIndexPath 
{
    NSLog(@"move from:%d to:%d", fromIndexPath.row, toIndexPath.row);
    // fetch the object at the row being moved
    NSString *r = [rows objectAtIndex:fromIndexPath.row]; 

    // remove the original from the data structure
    [rows removeObjectAtIndex:fromIndexPath.row];

    // insert the object at the target row
    [rows insertObject:r atIndex:toIndexPath.row];
    NSLog(@"result of move :\n%@", [self rows]);
} 
```

由于这是一个基本示例，因此让所有行都可移动。

```
- (BOOL)tableView:(UITableView *)tableView 
canMoveRowAtIndexPath:(NSIndexPath *)indexPath {
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-07-18T21:20:04.650

以上都行不通。在原始发布的代码中，tableview 将崩溃，因为它删除了仍在使用的数据，即使在更正之后，由于 table 执行“重新排列”的方式，数组也不会包含正确的数据。

exchangeObjectAtIndex:withObjectAtIndex: 不适用于根据 tableview 如何实现自己的重新排列来重新排列数组

为什么？因为当用户选择一个表格单元格来重新排列它时，该单元格不会与他们将其移动到的单元格交换。他们选择的单元格被插入到新的行索引处，然后原始单元格被删除。至少在用户看来是这样的。

解决方案：由于 tableview 实现重新排列的方式，我们需要执行检查以确保添加和删除正确的行。我放在一起的这段代码很简单，对我来说很完美。

以原始贴出的代码数据为例：

```
 - (void)tableView:(UITableView *)tableView 
moveRowAtIndexPath:(NSIndexPath *)fromIndexPath 
       toIndexPath:(NSIndexPath *)toIndexPath 
{
    NSLog(@"move from:%d to:%d", fromIndexPath.row, toIndexPath.row);
    // fetch the object at the row being moved
    NSString *r = [rows objectAtIndex:fromIndexPath.row]; 

        // checks to make sure we add and remove the right rows
    if (fromIndexPath.row > toIndexPath.row) {

        // insert the object at the target row
        [rows insertObject:r atIndex:toIndexPath.row];

        // remove the original from the data structure
        [rows removeObjectAtIndex:(fromIndexPath.row + 1)];
    }
    else if (fromIndexPath.row < toIndexPath.row) {

        // insert the object at the target row
        [rows insertObject:r atIndex:(toIndexPath.row + 1)];

        // remove the original from the data structure
        [rows removeObjectAtIndex:(fromIndexPath.row)];

    }

} 
```

如果你花点时间看看在重新排列期间 tableview 发生了什么，你就会明白为什么我们在我们做的地方添加 1。

我对 xcode 很陌生，所以我知道可能有一种更简单的方法可以做到这一点，或者代码可能可以简化......只是想尽我所能提供帮助，因为我花了几个小时才弄清楚这一点出去。希望这可以节省一些时间！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-10-28T12:41:53.873

根据 Apple 的文档和我自己的经验，这是一些运行良好的简单代码：

```
NSObject *tempObj = [[self.rows objectAtIndex:fromIndexPath.row] retain];
[self.rows removeObjectAtIndex:fromIndexPath.row];
[self.rows insertObject:tempObj atIndex:toIndexPath.row];
[tempObj release]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T02:50:33.677

`NSMutableArray`有一个方法叫做`exchangeObjectAtIndex:withObjectAtIndex:`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T07:19:56.080

在打破我的头脑反对一个简单的实现之后发现了这个讨论......迈克尔伯丁解决方案对我来说是最好的，苹果的方式，只记得在使用 ARC 时删除保留和释放。所以，一个更简洁的解决方案

```
NSObject *tempObj = [self.rows objectAtIndex:fromIndexPath.row];
[self.rows removeObjectAtIndex:fromIndexPath.row];
[self.rows insertObject:tempObj atIndex:toIndexPath.row]; 
```

# wpf - 使用 ESC 键隐藏网格

> ID：486290
> 
> 赞同：0
> 
> 时间：2009-01-28T02:38:40.377
> 
> 标签：wpf, grid, escaping, key, esc-key

我是 WPF 的新手。我的窗口上有 15 个网格，我有一个小菜单，我可以在上面单击并选择要显示或隐藏的网格。一次只有一个网格。当我点击 . 时，我希望该网格隐藏（淡出）`Esc`。我已经有了所有的动画，我只需要知道现在什么网格是可见的（活动的）。

我不知道如何获得对我的窗口的当前最高控制权。

我的解决方案是`KeyDown`在我的 Window 上触发事件时：

```
private void Window_KeyDown(object sender, System.Windows.Input.KeyEventArgs e)
    {
        if (e.Key == System.Windows.Input.Key.Escape)
        {
            //check all grids for IsVisible and on the one that is true make 
            BeginStoryboard((Storyboard)this.FindResource("theVisibleOne_Hide"));
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T08:04:48.720

通过活动，我认为这意味着具有键盘焦点的那个。如果是这样，以下将返回当前具有键盘输入焦点的控件：

```
System.Windows.Input.Keyboard.FocusedElement 
```

你可以像这样使用它：

```
if (e.Key == System.Windows.Input.Key.Escape)
{
    //check all grids for IsVisible and on the one that is true make 
    var selected = Keyboard.FocusedElement as Grid;
    if (selected == null) return; 

    selected.BeginStoryboard((Storyboard)this.FindResource("HideGrid"));
} 
```

一种更加解耦的方法是创建一个静态附加依赖属性。它可以像这样使用（未经测试）：

```
<Grid local:Extensions.HideOnEscape="True" .... /> 
```

一个非常粗略的实现如下所示：

```
public class Extensions
{
    public static readonly DependencyProperty HideOnEscapeProperty = 
       DependencyProperty.RegisterAttached(
           "HideOnEscape", 
           typeof(bool), 
           typeof(Extensions), 
           new UIPropertyMetadata(false, HideOnExtensions_Set));

    public static void SetHideOnEscape(DependencyObject obj, bool value)
    {
        obj.SetValue(HideOnEscapeProperty, value);
    }

    public static bool GetHideOnEscape(DependencyObject obj)
    {
        return (bool)obj.GetValue(HideOnEscapeProperty);
    }

    private static void HideOnExtensions_Set(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var grid = d as Grid;
        if (grid != null)
        {
            grid.KeyUp += Grid_KeyUp;
        }
    }

    private static void Grid_KeyUp(object sender, KeyEventArgs e)
    {
        // Check for escape key...
        var grid = sender as Grid;
        // Build animation in code, or assume a resource exists (grid.FindResource())
        // Apply animation to grid
    }
} 
```

这将消除在代码隐藏中包含代码的需要。

# windows - 访问远程服务器以执行计算任务的最简单方法

> ID：486298
> 
> 赞同：3
> 
> 时间：2009-01-28T02:43:05.203
> 
> 标签：windows, linux, cloud

我正在从事一些学术研究项目，涉及使用 Python 从网络上抓取大型数据集。在我的学术机构的 Linux 服务器上工作很不方便，因为 (1) 我没有超级用户访问权限，这意味着我依赖 IT 人员来安装我的软件包，以及 (2) 我的磁盘配额有些有限（我会理想情况下需要约 10 GB）。对我来说，获得解决这些问题的机器的最简单方法是什么？我不需要强大的处理能力；我只需要访问一台 24/7 运行的相当快的机器，这样我的程序就可以连续运行，最重要的是，运行、使用和维护非常简单，因为我有一些非 CS 人员在工作这个项目和我一起。Linux 会更好，但我也会考虑 Windows。

我知道亚马逊网络服务，但想知道是否有更适合我的特定需求的东西。

顺便说一句，如果我能获得对这台机器的某种远程桌面访问，那将是一个巨大的好处，这样我就不仅限于使用 SSH 和 SFTP。

建议？

编辑：我不能使用 VirtualBox 或 Virtual PC，因为我需要该程序全天候运行，并且我需要经常关闭我的笔记本电脑等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T03:00:08.290

如果您*确实*想坚持在 CS 部门的机器上运行，请使用[virtualenv](http://pypi.python.org/pypi/virtualenv)来解决您的软件包安装问题。如果磁盘空间有问题，您可以使用[S3](http://aws.amazon.com/s3)（也许还有 FUSE）以极其便宜的方式存储大量数据。

但是，如果这不是您真正想要的，我可以非常推荐[Slicehost](http://www.slicehost.com/)。他们为您提供了一个[虚拟专用服务器](http://en.wikipedia.org/wiki/Virtual_private_server)- 因此您可以完全控制安装的内容、用户、管理员等。

原则上，它非常类似于 EC2（我更喜欢将其用于“真实”服务器），但具有友好的界面、出色的客户服务，并且针对像您这样的小型项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T14:57:44.487

将 x11vnc 与 ssh 一起使用。'sudo apt-get install x11vnc' 在你的远程服务器上。

一旦你有了它，你就可以通过 vnc 访问你的远程服务器，但最棒的是你可以像这样通过 ssh 隧道 vnc：

ssh -X -C -L 5900:localhost:5900 远程主机 x11vnc -localhost -display :0

有关更多详细信息，请参阅 x11vnc 联机帮助页。

或者，只需在您的 linux 发行版上设置远程桌面（实际上是 vnc）。大多数发行版都带有一个 GUI 来配置远程桌面访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T02:53:34.857

如果您有一台可以使用的 linux 机器，那么`SSH -X`将允许您启动 GUI 程序。它不是远程桌面，但它很接近。

```
ssh -X whoever@whatever.com
firefox 
```

然后砰。桌面上会弹出一个 Firefox 窗口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T03:33:30.390

[**我对TekTonic 虚拟专用服务器**](http://tektonic.net/vps.php)非常满意。这是一个虚拟化环境，但您拥有完全的 root 访问权限来安装您需要的任何软件包。我不确定你的 CPU 和内存限制是什么，但如果它们不是太广泛，那么这应该很适合你。我不知道您是否能够启用远程桌面，因为我从未尝试过，但可以安装必要的软件包。

计划范围从 15 美元/月到 100 美元/月，15 美元/月计划配备 294MB RAM、13GB 磁盘空间和 2.6GHz 最大 CPU 速度。我在这个计划上运行了很长一段时间，最终以双倍的磁盘/cpu/mem 提升到了一个新的水平，我对此非常满意。自 2003 年以来，我一直与他们在一起，但尚未找到以这些价格提供同等计划的任何人。

# caching - 多服务器缓存

> ID：486300
> 
> 赞同：0
> 
> 时间：2009-01-28T02:44:58.150
> 
> 标签：caching, couchdb, xmpp

我正在构建一个涉及多个服务器的应用程序。（4台服务器，每台都有一个数据库和一个网络服务器。1个主数据库和3个从属服务器+一个负载均衡器）

有几种方法可以启用缓存。现在它相当简单而且根本没有效率。所有缓存都在所有服务器之间的 NFS 分区共享上完成。NFS 是架构中的瓶颈。

1.  我有几个想法实现缓存。它可以在服务器级别（本地文件系统）上完成，但问题是当所有服务器上的内容已更新时使缓存文件无效：它可以通过具有小的缓存寿命来完成（效率不高，因为缓存将尽快刷新，应该是大部分时间）
2.  它也可以通过消息传递系统（例如 XMPP）来完成，其中每个服务器相互通信。负责缓存失效的服务器向所有其他服务器发送请求，让他们知道缓存已失效。延迟可能更大（每个人都需要更多时间才能知道缓存已失效），但我的应用程序不需要原子缓存失效。
3.  第三种方法是使用云系统来存储缓存（如 CouchDB），但我不知道这个的性能。它比使用 SQL 数据库更快吗？

我计划使用 Zend Framework，但我认为它并不相关（除了其他框架中可能存在一些包来处理 XMPP、CouchDB）

要求：持久缓存（如果服务器重新启动，缓存不应丢失，以避免在重新创建缓存时关闭服务器）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T02:47:34.820

[http://www.danga.com/memcached/](http://www.danga.com/memcached/)

Memcached 涵盖了您提出的大部分需求——基于消息的读取、提交和失效。高可用性和高速度，但原子可靠性非常低（牺牲性能）。

（此外，memcached 为 YouTube、Wikipedia、Facebook 之类的东西提供支持，所以我认为，有时间、金钱和才能认真评估许多分布式缓存选项的组织可以选择 memcached！）

*编辑（回应评论）* 缓存的想法是与您的后备存储相比，它是相对短暂的。如果您需要长期保留缓存数据，我建议您查看 (a) 非规范化数据层以获得更高的性能，或者 (b) 添加一个中间层数据库服务器，以直接键存储大量数据 -值对表，或与之接近的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-24T11:50:10.600

为了保护 memcached 作为缓存存储，如果您想要高性能且服务器重启影响低，为什么不只拥有 4 个 memcached 服务器呢？还是8？每次“重新启动”对数据库服务器的影响都会相应减少。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T10:40:05.090

我想我找到了一个比较好的解决方案。

我使用 Zend_Cache 在本地存储每个缓存文件。我创建了一个基于 nanoserver 的小型守护进程，它也在本地管理缓存文件。当一台服务器在本地创建/修改/删除缓存文件时，它会通过执行相同操作的守护进程向所有服务器发送相同的操作。

这意味着我同时拥有本地缓存​​文件和远程操作。可能并不完美，但现在应该可以工作。CouchDB 太慢，NFS 不够可靠。

# web-services - Win32 Delphi WebService为什么要添加IWSDLPublish接口

> ID：486304
> 
> 赞同：1
> 
> 时间：2009-01-28T02:47:14.993
> 
> 标签：web-services, delphi

我使用 Delphi 2009 创建了一个简单的 CGI 应用程序，它发布了一个 Web 服务。当我将 Web 浏览器指向应用程序时，我可以看到我的 Web 服务界面和另一个界面：IWSDLPublish。

为什么这个接口会添加到我的 Web 服务中？
我需要吗？
可以不发布这个接口吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T04:09:02.333

这就是用于显示界面的 WSDL 的内容。如果您删除 WSDLPublish 组件，它应该不再发布该接口。

# iphone - 如何使用 iPhone SDK 创建 Cocoa touch 模板？

> ID：486307
> 
> 赞同：1
> 
> 时间：2009-01-28T02:47:31.390
> 
> 标签：iphone, cocoa-touch, xcode

我下载了免费的 iphone sdk。现在，当我尝试创建一个新项目时，我无法选择创建可可触摸模板。我只能选择创建 Mac OS X 模板。有谁知道为什么会发生这种情况以及如何解决？

编辑：如果你开始然后重新开始下载会损坏下载的材料吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T04:55:26.093

确保您满足 iphone sdk 的最低要求。我猜您可能使用的是基于 PowerPC 的 Mac，它不受（官方）支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T13:10:48.217

看来您下载的不正确。您的模板应该已准备就绪。重新下载应该可以解决问题。（我知道，这是一个拖累）

不过，“休息室”说明了一点。您在基于英特尔的 Mac 上运行 SDK？这是一个要求，运行 Mac OS X v10.5.5 或更高版本也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T02:50:16.860

你确定你下载了整个 iPhone SDK，而不仅仅是 Xcode 更新？对于维修，我认为您正在重新安装您的工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-14T23:40:40.100

如果您将应用程序安装在不同的位置，请确保更新停靠图标以指向您认为需要的版本。

# c++ - 如何检查服务器和客户端是否处于相同的并发模型中？

> ID：486313
> 
> 赞同：0
> 
> 时间：2009-01-28T02:49:40.993
> 
> 标签：c++, visual-studio-2008, com

并发模型可以是**单元线程**或多**线程**

**问题：**

*   如何确保客户端和服务器**都**在**同一个**并发模型中运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T03:13:56.063

如果你需要知道，你的设计有问题：客户端和服务器需要太多关于彼此内部的信息。客户端-服务器的部分意义在于将两者解耦。

也就是说，有一个注册表值 ThreadingModel 。还有[一篇关于这些东西的 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms809971.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T05:54:47.030

有时你*需要*知道。两个简单的例子：

*   代理/存根对的性能影响是一个问题
*   您需要传递“不可编组”的数据或对象

所以，答案——如果你确实需要知道：

服务器和客户端的设计和实现必须支持相同或兼容的模型。这些场景中的任何一种都可以：

*   两者都应该是 MTA，或者
*   两者都应该是 STA，或者
*   服务器应该是“Both”（支持任一）
*   服务器应该是“自由线程的”（但在这种情况下，与两者相比，这不会给你带来任何额外的东西）

# php - 即使使用 NULLS 也使用 while() 显示

> ID：486331
> 
> 赞同：0
> 
> 时间：2009-01-28T02:58:00.527
> 
> 标签：php, mysql

我有一张桌子，我正在使用 PHP 和 while(); 显示它的内容。我在表中有大约三个字段是 NULL 但可以更改，但我希望它们仍然显示我表中的所有结果。

但是，它只显示每个字段中包含数据的记录。任何人我怎么能显示它？我得到了桌子的计数，它给了我 2，但只显示一个。

```
<h3>Viewing All Updates</h3>
<h4>Below are all active updates for COTC</h4>
<table>
    <thead>
        <tr>
                <th>Site Name</th>
                <th>Page</th>
                <th>Flag</th>
                <th>Date Sent</th>
                <th>View</th>
        </tr>
    </thead>
    <tbody>
        <?php
    $sql    = "SELECT sname,page_name,date_submitted,u_id,clients.c_id,flag,completed FROM updates INNER JOIN clients ON updates.c_id = clients.c_id INNER JOIN pages ON updates.page = pages.p_id ORDER BY date_submitted DESC";
    $query  = mysql_query($sql) or die(mysql_error());
    while($row = mysql_fetch_array($query)){
        $completed = $row['completed'];
        if($completed == 1){
                print '<tr class="quiet">'; 
        }else{
                print '<tr>'; 
        }
                print '<td>'.$row['sname'].'</td>'; 
                print '<td>'.$row['page_name'].'</td>'; 
                print '<td>'.$row['flag'].'</td>';
                print '<td>'.$row['date_submitted'].'</td>';
                print '<td class="center"><a href="?c=displayupdate&id='.$row['u_id'].'" title="View update for '.$row['sname'].'" id="'.$row['u_id'].'"><img src="images/page_edit.png" alt="Edit entry!" /></a></td>';
        print '</tr>';
    }
?>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T03:31:50.490

您的 PHP 正在正确打印返回的每一行。我相信您的问题出在查询中。

```
SELECT sname,page_name,date_submitted,u_id,clients.c_id,flag,completed 
FROM updates INNER JOIN clients ON updates.c_id = clients.c_id 
             INNER JOIN pages ON updates.page = pages.p_id
ORDER BY date_submitted DESC 
```

`updates`此查询仅在具有匹配的 in`clients`和匹配的in 时才会返回一行`pages`。如果您希望`clients`or`pages`联接是可选的（`updates`具有`c_id`or `page`of的行`NULL`仍将返回），请将它们从`INNER JOIN`s 更改为`LEFT JOIN`s。

# css - 划分长列表 标签到列？

> ID：486349
> 
> 赞同：16
> 
> 时间：2009-01-28T03:09:31.813
> 
> 标签：css

我有一个大约 30 个`<li>`列表`<ul>`。有什么方法可以使用 CSS 将它们分成三列，每列十个？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-28T03:28:17.000

在 CSS3 中这是[可能的](http://www.quirksmode.org/css/multicolumn.html)。

```
#columns {
  -moz-column-count: 3;
  -moz-column-gap: 20px;
  -webkit-column-count: 3;
  -webkit-column-gap: 20px;
  column-count: 3;
  column-gap: 20px;
} 
```

HTML：

```
<div id="columns">
  <ul>
... lots of lis ...
  </ul>
</div> 
```

当列表项超过容器的高度时，它们将溢出到下一列。

也许对于较旧的浏览器，您可以使用 JavaScript，因为这似乎比关键功能更美观。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-28T03:17:52.933

我通常将宽度设置为 28% 并将其浮动到左侧：

```
ul li {
   width: 28%;
   margin: .5em 2%;
   float:left;
} 
```

这样做的缺点是项目填充如下：

```
- - -
- - -
- 
```

不喜欢：

```
- - -
- -
- - 
```

如果你想要垂直填充的列，你需要 3 个 <ul>s。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-05T07:14:37.010

以下内容是为移动友好而量身定制的。

```
div.a {
  background-color: #ffffff;
  border: 2px solid;
  margin: 0;
  overflow: auto;
  padding: 1%;
  text-align: left;
  word-wrap: break-word;
}
ul.a {
  list-style-type: none;
  margin: 0;
  padding: 0;
}
li.spacea {
  float: left;
  width: 2%;
}
li.thirda {
  color: #ff00ff;
  float: left;
  width: 32%;
}
li.thirdb {
  color: #ffff00;
  float: left;
  width: 32%;
}
li.thirdc {
  color: #00ffff;
  float: left;
  width: 32%;
}
```

```
<div class="a">
  <ul class="a">
    <li class="thirda">
      The quick brown fox jumped over the lazy dog.
    </li>
    <li class="spacea">
      &nbsp;
    </li>
    <li class="thirdb">
      The quick brown fox jumped over the lazy dog.
    </li>
    <li class="spacea">
      &nbsp;
    </li>
    <li class="thirdc">
      The quick brown fox jumped over the lazy dog.
    </li>
  </ul>
</div>
```

# performance - 了解用户——性能王牌看起来吗？

> ID：486352
> 
> 赞同：2
> 
> 时间：2009-01-28T03:13:04.083
> 
> 标签：performance, user-interface

在我看来，每当涉及 GUI（图形用户界面）时，界面的外观几乎总是胜过应用程序的性能。

这是普遍现象吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-28T03:17:05.667

足够糟糕的外观胜过任何水平的良好性能。

足够糟糕的表现胜过任何水平的美貌。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-28T03:43:08.750

这归结为目标受众的心理和应用程序的架构。如果 GUI 反应迅速并且以对用户（与开发人员相反）直观的方式布局，那么底层可能不需要表现得那么好。然而，如果用户想要从数据库中获取数据，而他们在数据加载时被挂起，他们的感受就会大不相同。仅作为示例比较 2 个 Web 应用程序：

*   应用程序 1*感觉*反应灵敏，但在幕后所需的时间比表面上显示的要长——它使用 AJAX 与 Web 服务对话。Web 服务不是最快的，但一切都发生在回调（异步）上，因此在填充字段时不会阻止用户。它不会妨碍他们的工作流程。在网络性能恶化背景性能的糟糕日子里，这肯定是显而易见的，但用户活动并没有比正常情况进一步受到阻碍。

*   应用程序 2 并没有那么敏感。一切都发生在回发上，没有 AJAX 或 Web 服务，在美好的一天页面加载相当快。当然，在每次回发时，用户的工作流程都会在他们等待页面重新加载时受到阻碍。在糟糕的一天，网络性能会导致性能明显下降，进一步阻碍用户使用。

应用程序一收到投诉的可能性要小得多，因为即使字段加载速度不快，用户也不会被阻止。用户可以输入数据并继续前进。一切都是异步处理的。当然，在后台，Web Service 进程实际上可能比整个页面刷新要慢，但用户不会太在意。

从数千小时编写软件并直接与我的用户互动——通常是那些不一定像你平均 10 岁的孩子那样懂计算机的人，我已经注意到这些点是获得这样的观众接受的关键 [写自用户视角]：

1.  **它必须按照我的意愿去做：** 不要只是阅读规范并期望您的代码完全符合纸上所说的内容。真正阅读纸上所说的内容，并理解用户的*意思*。设计到单词的潜在含义，而不是纸上墨水的黑白。如果你不明白我的意思，来和我谈谈，我会解释直到你明白为止。如果你提供的软件错过了我的全部观点，我会比你的问题更不高兴。如果我通过真正尝试理解我而感觉到你在我身边，我会感觉更快乐。

2.  **它必须帮助我的工作流程而不是阻碍它：**如果我所要做的只是按一个按钮来完成之前需要一个小时才能完成的事情，那就太好了，但如果它让我的计算机冻结 20 分钟，则需要完成任务，我不会是一个快乐的露营者。

3.  **使用起来必须直观：**这意味着我不想为了弄清楚如何使用它而不得不翻阅您*没有提供给我的文档。*我也不想要一个 20 分钟的解释，说我会在你走出门后 3 分钟忘记。设计软件，使我 10 岁的孩子可以像编程 PVR 一样容易地理解它。这意味着我应该以一种对*我来说*是合乎逻辑的方式与它进行交互，因为我每天都会使用它。*功能*是否正确无所谓，如果我不知道如何使用它，我不会使用它，更不用说付费了。

4.  **它必须是响应式的：**我不想单击一个按钮，然后等待 10 秒钟以加载列表，然后从该列表中选择一个项目，然后等待另一个屏幕加载，然后我才能选择要完成的操作在那个项目上，然后需要 5 分钟才能完成。找到一种快速加载数据的方法——如果你不能快速加载数据以响应我的操作，那么想办法让数据*感觉*加载速度很快——也许可以提前在后台加载数据，然后只显示我需要显示的内容以响应我的操作......我的意思是，我不在乎*你*做什么，只是让它*看起来*好像它正在快速完成。

5.  **它必须是健壮的：**我扔给它什么都没关系，它应该接受它并继续前进。如果我做错了什么或在某个字段中输入了不正确的内容，请告诉我 - 用简单的英语！！我不关心缓冲区溢出或尝试打开文件时在第 479 行抛出的 IOExceptions。*只需处理它并用我*理解的语言告诉我我做错了什么。

6.  **给我文件：**好吧，我知道我不会读它，而且我更有可能拿起电话给你打电话，而不是记住当你把它给我时我把它放在哪里。但是知道它在那里让我感到温暖和模糊。这表明您足够关心该软件 - 而*我*足够关心编写说明，当您不可用时，我可以参考非工作时间。

7.  **价格：**这完全取决于您的受众，但根据我的经验，如果您满足上述所有要点，价格往往不像表面上看起来那么令人担忧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T03:17:43.717

尽管“你不能以封面来判断一本书”，但人们经常使用软件。我不知道我是否会说这是“普遍的”，但肯定很普遍。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T03:18:25.133

我什至不认为这是一个*真实*的现象。我不在乎“外观和感觉”有多活泼，如果需要一秒钟来回显按键，那么 UI 体验就会很糟糕。如果需要很长时间重新绘制页面以进行小的更改，那么 UI 将会很糟糕。

现在，只要应用程序的响应时间小于某个数量，那么外观和感觉将是满意度的很大一部分。

查看 Jakob Neilsen 关于这方面的一些书籍。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T03:25:18.863

这不是一个错误的二分法吗？如果应用程序的外观和感觉不干净、组织良好且有效，那么您就没有高性能的应用程序。不管它可能有多快。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T03:24:06.883

我发现最好的组合是一个快速且易于使用的 GUI。这并不一定意味着您的应用程序必须具有出色的性能，但是让 GUI 冻结在您身上就是死亡之吻。iPhone 的 Safari 在这方面做得很好——即使渲染引擎跟不上你，你也可以继续在屏幕上滚动。是的，没有内容的孵化标记很难看，但至少用户知道他在控制之中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T04:26:08.583

我认为这取决于用户。我在一家中型公司的 IT 部门工作，为该公司的员工构建基于 Web 的软件。用户范围从人力资源、制造、研发、销售、财务到为 CEO 提出申请。这些部门中的每个不同部门和用户似乎对高质量应用程序都有不同的标准。

例如，人力资源部门通常处理大量文本数据。他们花费大量时间将内容输入到员工信息、权利、招聘等表单中。这些类型的用户可能会为此目的选择应用程序的外观和感觉，他们想要一个易于浏览和直观的美观设计。

另一方面，像财务这样的部门可能会偏爱其报告工具的性能。我有一些使用大型 SQL 表的经验，这些表具有复杂的查询，需要花费大量时间来执行。每天多次运行此类报告的用户很快就会厌倦等待，并且很乐意失去一点界面直观性，以换取可以花在其他任务上的时间。

所以，我想说你不能做出一个笼统的陈述，比如“所有用户都喜欢快速的应用程序”或“所有用户都喜欢漂亮的应用程序”。这实际上取决于用户的偏好、他们的工作要求和应用程序的目的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T14:45:38.970

平衡就是一切。

UI 需要看起来像其他应用程序一样受人尊敬、专业和流畅，以便用户有共同的体验，因此学习曲线很少。除非特别要求，否则它不应该有不必要的口哨声和铃声。

性能至少应该是可以忍受的。如果你在一个项目中有额外的时间，我会花时间加快它，除非用户特别要求 UI 增强。很多时候，口哨声和铃声会影响性能，因为某些 UI 增强功能需要额外的 CPU 时间，有时还会增加应用程序的尴尬。乍一看，其中一些应用程序看起来很酷，但长期可用性受到 NEATO 因素的影响。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-21T16:45:59.053

对用户来说重要的是使用该程序很有趣。该程序不仅应该能够做我想做的事情，而且使用该程序必须感觉良好。在用户不理解或无法预见的时刻让用户等待并不有趣。崩溃和犯错也不好玩。
但是看起来不错并通过外观帮助我完成任务并让我快速工作并且没有工作流程中断很有趣。

程序员通常认为速度慢且使用大量内存的程序很糟糕，他们会根据内存使用情况和处理器的使用情况来衡量所有软件。但是你们中的大多数用户不会启动 top 或 windows 任务管理器并查看他们将使用它的程序的占用空间，如果使用该程序感觉良好，并且运行该程序的计算机的其余部分，他们将跌倒好到。

我经常读到的一件事是使用尽可能多的 CPU 来让用户在最短的时间内完成任务。这是高性能吗？你的程序非常快。但是目前计算机非常慢，并且切换到电子邮件程序，因为我知道这项任务将花费时间是一件很痛苦的事情。所以有时你可能想释放一些资源来改善程序的感觉。即使这会减慢您自己的程序。

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2009-01-28T03:20:19.827

最重要的是**价格、功能、兼容性和可靠性**。

外观和性能都是**相对****不重要**的，在实践中它们都无法“胜过”任何事情：

*   **兼容性**：例如，在现实世界中我使用 MS Word，不是因为它快速或漂亮，而是因为它与使用它的其他所有人兼容。

*   **功能**：当我想在法国预订火车时，我使用[http://www.voyages-sncf.com/](http://www.voyages-sncf.com/)不是因为它快速或漂亮（甚至非常可靠），而是因为它具有必要的功能。

*   **可靠性**：如果一个应用程序崩溃了，那么我可能不会再使用它了，不管它崩溃的速度有多快，或者它在崩溃之前看起来有多好。

*   **价格**：等等（不多说了）。

# emacs - 用于 Haskell 等静态强类型语言和 Common LIsp 等动态（强）语言

> ID：486360
> 
> 赞同：9
> 
> 时间：2009-01-28T03:17:29.317
> 
> 标签：emacs, dynamic, haskell, static, lisp

我正在使用 Lisp 方言，但也学习了一些 Haskell。它们有一些相似之处，但在 Common Lisp 中的主要区别似乎是您不必为每个函数、参数等定义类型，而在 Haskell 中则需要。此外，Haskell 主要是一种编译语言。运行编译器以生成可执行文件。

我的问题是，在不同的应用程序或用途中，像 Haskell 这样的语言可能比像 Common Lisp 这样更动态的语言更有意义。例如，似乎 Lisp 可以用于更多的底层编程，例如构建网站或 GUI，其中 Haskell 可以用于更需要编译时间检查的地方，例如构建 TCP/IP 服务器或代码解析器。

流行的 Lisp 应用程序：Emacs

流行的 Haskell 应用程序：PUGS Darcs

你同意吗，有没有这方面的研究？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-28T04:54:46.890

编程语言是用来思考的工具。如果你愿意努力工作，你可以用任何语言表达任何程序。一种编程语言相对于另一种编程语言的主要价值在于它为您以不同方式思考问题提供了多少支持。

例如，Haskell 是一种强调根据类型来思考问题的语言。如果有一种方便的方法可以用 Haskell 的数据类型来表达您的问题，您可能会发现它是一种方便的语言来编写您的程序。

Common Lisp 的优势（众多）在于其动态特性和同音性（即 Lisp 程序很容易作为 Lisp 数据表示和操作）—— Lisp 是一种“可编程编程语言”。例如，如果您的程序最容易用一种新的特定领域语言表达，那么 Lisp 可以很容易地做到这一点。如果您的问题描述处理的数据类型指定不明确或可能随着开发的进行而改变，那么 Lisp（和其他动态语言）非常适合。

语言选择通常与任何事物一样是一种审美决定。如果您的项目要求不会出于兼容性、依赖性或性能原因将您限制为特定语言，那么您不妨选择您感觉最好的语言。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T03:31:19.257

您正在打开多罐非常蠕动的蠕虫。首先，整个强类型语言和弱类型语言都可以。其次，函数式语言与命令式语言可以。

（实际上，我很好奇：“lisp 方言”是指 Clojure 吗？因为它在很大程度上是功能性的，并且在某些方面更接近 Haskell。）

可以，然后呢。首先，您几乎*可以*用几乎任何普通语言编写几乎任何程序，只需付出或多或少的努力。强类型的据称优点是可以在编译时检测到一大类错误。另一方面，类型较少的语言更容易编写代码。Common Lisp 很有趣，因为它是一种动态语言，可以声明和使用更强的类型，这为 CL 编译器提供了如何优化的提示。（哦，真正的 Common Lisp 通常是用编译器实现的，让您可以选择编译或坚持使用解释代码。）

有许多关于比较无类型、弱类型和强类型语言的研究。这些研究总是要么说其中一个更好，要么说没有明显的差异。然而，研究之间几乎没有达成*一致*。

可能有一些明显优势的最大领域是处理数学问题的复杂规范。在这些情况下（加密算法就是一个例子），像 Haskell 这样的函数式语言具有优势，因为它更容易验证 Haskell 代码和底层算法之间的对应关系。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T04:33:08.727

我主要是从 Common Lisp 的角度来的，据我所知，Common Lisp 适用于*任何*应用程序。

是的，默认是动态类型（即在运行时进行类型检测），但您可以声明类型以进行优化（作为其他读者的旁注：CL 是强类型；不要将弱/强与静态/动态混淆！） .

我可以想象 Haskell 可能更适合在航空电子领域替代 Ada，因为它至少在编译时强制进行所有类型检查。

对于 TCP/IP 服务器或代码解析器，我不认为 CL 不应该像 Haskell 那样有用——恰恰相反，但到目前为止，我与 Haskell 的联系还很短暂。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T09:55:27.873

Haskell 是一种纯函数式语言。虽然它确实允许命令式构造（使用 monad），但它通常会迫使程序员以一种完全不同的方式思考问题，使用更面向数学的方法。例如，您不能将另一个值重新分配给变量。

据称，这降低了犯某些类型错误的可能性。此外，用 Haskell 编写的程序往往比用典型编程语言编写的程序更短、更简洁。Haskell 还大量使用非严格的惰性求值，理论上这可以允许编译器进行原本不可能的优化（以及无副作用范式）。

既然你问了，我相信 Haskell 的打字系统非常好用。它不仅可以捕获常见错误，而且还可以使代码更简洁（！），并且可以有效地替换常见 OO 语言中的面向对象结构。

一些 Haskell 开发工具包，如 GHC，也具有交互环境。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T16:04:19.937

我发现动态类型的最佳用途是当您依赖于您无法控制的事物时，它也可以动态使用。例如从 XML 文档中获取信息，我们可以这样做：

```
var volume = parseXML("mydoc.xml").speaker.volume() 
```

不使用鸭子类型会导致这样的事情：

```
var volume = parseXML("mydoc.xml").getAttrib["speaker"].getAttrib["volume"].ToString() 
```

另一方面，Haskell 的好处是安全。例如，您可以使用类型确保[华氏度和摄氏度数不会无意混合](http://necrobious.blogspot.com/2009/03/fun-example-of-haskells-newtype.html)。除此之外，我发现静态类型语言有更好的 IDE。

# php - 在 INSERT 之后设置其他行的状态

> ID：486372
> 
> 赞同：0
> 
> 时间：2009-01-28T03:22:12.630
> 
> 标签：php, sql

嘿，我有一个名为 STATUS 的字段，它是 1 显示或 0 隐藏。我的代码如下。我正在使用带有 jQ​​uery 的就地编辑器。每次更新时，它都会创建一个我想要的新 ROW，但我只希望新的 STATUS = 1，其他的为 0。关于我将如何做到这一点的任何想法？

```
<?php
    include "../../inc/config.inc.php";
    $temp  = explode("_", $_REQUEST['element_id'] );
    $field = $temp[0];
    $id    = $temp[1];
    $textboxval = stripslashes(mysql_real_escape_string(preg_replace('/[\$]/',"",$_REQUEST["update_value"])));      
    $query      = "INSERT INTO notes ($field,status,date,c_id) VALUES ('$textboxval','1',NOW(),'$id')";
    mysql_query($query);
    echo($_REQUEST['update_value']);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T03:33:35.710

我不确定您的意思-您是否要使除新条目之外的所有条目的状态= 0？如果是这样，只需在插入之前发出更新：

```
UPDATE notes SET status = 0 
```

但是，我还应该注意，您需要担心潜在的 SQL 注入。*通过在应用“mysql 真正的转义字符串”后*去除斜杠，您可能会允许某人在您的 SQL 语句中放入将执行任意 SQL 语句的文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T03:42:26.207

像这样，对不起之前的帖子，我第一次看错了然后又回去了：

```
<?php
    include "../../inc/config.inc.php";
    $temp  = explode("_", $_REQUEST['element_id'] );
    $field = $temp[0];
    $id    = $temp[1];
    $textboxval = mysql_real_escape_stringstripslashes((preg_replace('/[\$]/',"",$_REQUEST["update_value"]))); 
    // set older entries to 0 - to not show but show in history
    $hide_notes      = "UPDATE notes SET status = 0";
    mysql_query($hide_notes);

    // add new entry with status of 1 to show only latest note
    $query      = "INSERT INTO notes ($field,status,date,c_id) VALUES ('$textboxval','1',NOW(),'$id')";
    mysql_query($query);
    echo($_REQUEST['update_value']);
?> 
```

我刚刚遇到了一个问题，我没有设置我的桌子不允许我一次展示多个客户，我将有很多客户，我的计划不好哈

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T03:52:10.557

您真的想获取新生成的行的 ID，然后触发一个 UPDATE ，其中 ID*不是*新行的所有行，例如

```
UPDATE notes SET status = 0 WHERE id != $newly_generated_id 
```

如果表中的 ID 列使用 AUTO_INCREMENT，您可以通过“SELECT LAST_INSERT_ID()”获取其 ID，然后在 UPDATE 语句中使用该语句中的返回值。

伪代码：

```
$insert = mysql_query("INSERT INTO ..."); 
$last_id = mysql_query("SELECT LAST_INSERT_ID()"); 
$update = mysql_quqery("UPDATE notes SET status = 0 WHERE id != $last_id"); 
```

这种方法的唯一警告是，您可能有一个短暂的时刻，其中 2 行的状态 = 1（插入和更新之间的时间）。我会将所有这些都包装在一个事务中，以使整个单元更具原子性。

# ruby-on-rails - Ruby on rails 西班牙语国际化

> ID：486374
> 
> 赞同：5
> 
> 时间：2009-01-28T03:23:30.270
> 
> 标签：ruby-on-rails, internationalization

我正在使用 ruby​​ on rails 创建一个快速应用程序，经过大量搭建和验证后，我对 RoR 中嵌入的一些功能感到非常满意……但我住在墨西哥，我的所有用户都会喜欢申请当然是西班牙语。所以，我注意到有很多用英语编写实际文本的函数，例如 time_ago_in_words 以及脚手架和验证产生的所有错误。

在我自己实际做这些事情之前（例如我会在 php 中），我想知道是否有某种语言文件我可以编辑（甚至下载一个西班牙语文件）。毕竟，我正在阅读的书籍和学习这个新框架的教程（和网络广播）都是英文的（并且没有包含这个问题）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T03:55:57.617

在这里你可以找到一个很好的[示例应用程序](http://github.com/karmi/rails_i18n_demo_app/tree/master)，它演示了 Rails 中 i18n（国际化功能）的一些基础知识。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-28T03:29:20.493

本指南包含有关国际化的最新工作。一个相当不错的参考： http: [//guides.rails.info/i18n.html](http://guides.rails.info/i18n.html)

# windows-7 - windows 7上的windows批处理文件问题

> ID：486380
> 
> 赞同：4
> 
> 时间：2009-01-28T03:25:24.167
> 
> 标签：windows-7, batch-file

我有一个批处理文件来编译和链接我的所有代码。它包含以下内容：

```
@echo off
nasm -f aout -o start.o start.asm
gcc -Wall -O -fstrength-reduce -fomit-frame-pointer -finline-functions -nostdinc -fno-builtin -I./include -c -o main.o main.c
gcc -Wall -O -fstrength-reduce -fomit-frame-pointer -finline-functions -nostdinc -fno-builtin -I./include -c -o scrn.o scrn.c
ld -T link.ld -o kernel.bin start.o main.o scrn.o
pause 
```

问题是，当我运行它时，它只是将所有这些作为文本打印出来。这绝对是一个批处理文件。它以 .bat 文件结尾，在 notepad++ 中，@echo off 和 pause 的语法被突出显示，无需手动设置。这是Windows 7的错误吗？还是我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T15:52:15.797

您是从命令行运行还是通过在资源管理器中双击运行？

也许您将“*编辑*”操作设置为默认值？

尝试右键单击并选择*Open*。

编辑：也许你的线路终结器搞砸了。Windows 需要 CRLF。

在记事本++中：

*   单击查看->显示行尾。
*   如果它们不是 CRLF，请单击“格式”->“转换为 Windows 格式”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T15:35:52.117

 **安装 Windows 7**的更简单示例**
使用[cygwin](http://www.cygwin.com/)获取 gcc**

 **我使用了以下批处理脚本：

```
PATH = %PATH%;C:\cygwin\bin;
gcc test.c 
```

在以下 c 文件中：

```
main() {
        printf("hello, world");
} 
```

它编译得很好。

**我的结论**
Windows 7 批处理脚本的工作方式与以前版本的 Windows 非常相似。

**简单的可能会绊倒你的东西**
Windows 上默认没有安装 gcc，我建议[cygwin](http://www.cygwin.com/)或[mingw](http://www.mingw.org/)
gcc 在安装 gcc 后默认不在 PATH 上，你可以将它添加到系统的环境变量或添加到你的批处理脚本（使用类似于我刚刚使用的批处理脚本的第一行的东西）。

# java - JUnit 产生奇怪的 AssertionFailedError

> ID：486381
> 
> 赞同：0
> 
> 时间：2009-01-28T03:25:33.107
> 
> 标签：java, testing, junit

我目前正在使用 JUnit 4.4 和 Java 1.6.x。在最近的代码修复之后，我们开始在我对方法的 JUnit 测试中得到这个 AssertionFailedError：

*UtilityTest.testParseDate(4t)：2001 年 1 月 15 日星期一 09:26:07 PST 预期：“2001 年 1 月 15 日星期一 09:26:07 PST”，但是：“2001 年 1 月 15 日星期一 09:26:07 PST”*

*junit.framework.AssertionFailedError: UtilityTest.testParseDate(4t): Mon Jan 15 09:26:07 PST 2001 预期：但是是：在 UtilityTest.testParseDate(未知来源)*

可以看到，预期的和实际的看起来一模一样，经过多次代码检查，我们没有发现代码中有明显的错误。使用实际数据进行的测试也产生了正确的（预期的）结果。

以前有没有人在 JUnit 中看到过这种行为，如果有，你找到原因和/或修复了吗？

我自己在 Java 和 JUnit 的早期版本中也看到过同样的情况：发生时总是有些随机，通常唯一“有效”的修复方法是从头开始重新输入代码块。很奇怪，但这是消除此错误的唯一方法。这次我试图在行为中找出更“具体”的东西。

谢谢，

-理查德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T03:30:53.830

您可以发布 UtilityTest.testParseDate() 的代码吗？

您是在日期值上使用*assertEquals()*还是以其他方式比较它们？如果是这样，您能否断言毫秒时间戳相等而不是日期本身？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T03:51:56.877

测试代码为：

```
Calendar cal = Calendar.getInstance();
Date today = new Date();
cal.set(2001, 0, 15, 9, 26, 07);  // Jan 15 2001, 09:26:07
// format 4 = ddd mmm dd hh:mm:ss TTT yyyy (with gettime)
assertEquals("UtilityTest.testParseDate(4t): Mon Jan 15 09:26:07 PST 2001", cal.getTime(),  Utility.parseDate("Mon Jan 15 09:26:07 PST 2001", today, true)); 
```

这是 parseDate 的样子（只是方法签名，因为代码很长）：

```
public static Date parseDate(String date, Date today, boolean gettime) { 
```

我认为您可能拥有它-即使它不显示毫秒，它们也会有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T18:05:38.713

That was it - the milliseconds were off. A judicious application of `cal.clear()` fixed the problem.

# c - C 标准库的更安全替代方案

> ID：486383
> 
> 赞同：17
> 
> 时间：2009-01-28T03:26:18.440
> 
> 标签：c, low-level

C 标准库在 I/O 安全方面出了名的差。许多函数都有缓冲区溢出（`gets`, `scanf`），或者如果没有给出正确的参数（`scanf`）会破坏内存，等等。每隔一段时间，我就会遇到一个有进取心的黑客，他编写了自己的库，但没有这些缺陷。

你见过的最好的图书馆是什么？你有没有在生产代码中使用过它们，如果有的话，这不仅仅是业余项目吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T14:43:08.200

我使用**GLib**库，它有很多很好的标准和非标准函数。

见[https://developer.gnome.org/glib/stable/](https://developer.gnome.org/glib/stable/)

也许你坠入爱河...... :)

例如：

[https://developer.gnome.org/glib/stable/glib-String-Utility-Functions.html#g-strdup-printf](https://developer.gnome.org/glib/stable/glib-String-Utility-Functions.html#g-strdup-printf)

解释说**g_strdup_printf**是：

> 类似于标准 C sprintf() 函数，但更安全，因为它计算所需的最大空间并分配内存来保存结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T03:34:28.923

这并没有真正回答您关于使用最安全**库**的问题，但是您提到的大多数易受缓冲区溢出影响的函数都有更安全的版本，这些版本将缓冲区长度作为参数，以防止标准时打开的安全漏洞使用的方法。

除非您放宽了警告级别，否则在使用不推荐使用的方法时通常会收到编译器警告，建议您改用更安全的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T12:37:18.140

我相信[Apache Portable Runtime (apr)](http://apr.apache.org/)库比标准 C 库更安全。我将它用作 apache 模块的一部分，但也用于独立进程。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T03:33:21.220

对于 Windows，有一个[“安全”的 C/C++ 库](http://msdn.microsoft.com/en-us/magazine/cc163794.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T14:54:01.983

你总是可以自由地实现你喜欢的任何库并使用它——困难的部分是确保它在你需要你的软件工作的平台上可用。您还可以在适当的情况下使用标准函数周围的包装器。

Whether it is really a good idea is somewhat debatable, but there is TR24731 published by the C standard committee - for a safer set of C functions. There's definitely some good stuff in there. See this question: [Do you use the TR 24731 Safe Functions in your C code?](https://stackoverflow.com/questions/372980/do-you-use-the-tr-24731-safe-functions-in-your-c-code), which includes links to the technical report.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-28T03:34:35.227

也许要问的第一个问题是您是否真的需要纯 C 语言？（也许像 .net 或 java 这样的语言是一种选择 - 然后例如缓冲区溢出不再是一个真正的问题）

如果不能选择其他高级语言，另一种选择可能是用 C++ 编写项目的一部分。然后，如果您真的需要 C，您可以拥有一个封装 C++ 代码的 C 接口。

因为如果您添加 C++ 标准库内置的所有高级功能 - 您的 C 代码在大多数情况下只会稍微快一些（并且包含比现有和经过测试的框架更多的错误）。

# c# - 是否可以将事件处理程序放在与调用者不同的线程上？

> ID：486393
> 
> 赞同：10
> 
> 时间：2009-01-28T03:32:04.403
> 
> 标签：c#, multithreading, events, delegates

假设我有一个名为 Tasking 的组件（我无法修改），它公开了一个方法“DoTask”，该方法执行一些可能冗长的计算并通过事件 TaskCompleted 返回结果。通常这是在用户获得结果后关闭的窗口形式中调用的。

在我的特定场景中，我需要将一些数据（数据库记录）与 TaskCompleted 返回的数据相关联，并使用它来更新数据库记录。

我调查了使用 AutoResetEvent 来通知事件何时被处理。问题是 AutoResetEvent.WaitOne() 将阻塞并且永远不会调用事件处理程序。通常 AutoResetEvents 被称为是一个单独的线程，所以我猜这意味着事件处理程序与调用的方法位于同一线程上。

本质上，我想通过阻塞将异步调用（结果通过事件返回）转换为同步调用（即从另一个类调用 DoSyncTask），直到事件被处理并且结果放置在事件处理程序都可以访问的位置以及调用启动异步调用的方法的方法。

```
public class SyncTask
{
    TaskCompletedEventArgs data;
    AutoResetEvent taskDone;

public SyncTask()
{
    taskDone = new AutoResetEvent(false);
}

public string DoSyncTask(int latitude, int longitude)
{
    Task t = new Task();
    t.Completed = new TaskCompletedEventHandler(TaskCompleted);
    t.DoTask(latitude, longitude);
    taskDone.WaitOne(); // but something more like Application.DoEvents(); in WinForms.
    taskDone.Reset();
    return data.Street;
}

private void TaskCompleted(object sender, TaskCompletedEventArgs e)
{
    data = e;
    taskDone.Set(); //or some other mechanism to signal to DoSyncTask that the work is complete.
}
}

In a Windows App the following works correctly.

public class SyncTask
{
    TaskCompletedEventArgs data;

public SyncTask()
{
    taskDone = new AutoResetEvent(false);
}

public string DoSyncTask(int latitude, int longitude)
{
    Task t = new Task();
    t.Completed = new TaskCompletedEventHandler(TaskCompleted);
    t.DoTask(latitude, longitude);
    while (data == null) Application.DoEvents();

    return data.Street;
}

private void TaskCompleted(object sender, TaskCompletedEventArgs e)
{
    data = e;
}
} 
```

我只需要在不调用 Application.Run 且 ApplicationContext 对象不可用的窗口服务中复制该行为。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T10:13:44.350

我最近在线程上进行异步调用和事件并将它们返回到主线程时遇到了一些麻烦。

我使用[SynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext_members.aspx)来跟踪事情。下面的（伪）代码显示了目前对我有用的内容。

```
SynchronizationContext context;

void start()
{
    //First store the current context
    //to call back to it later
    context = SynchronizationContext.Current; 

    //Start a thread and make it call
    //the async method, for example: 
    Proxy.BeginCodeLookup(aVariable, 
                    new AsyncCallback(LookupResult), 
                    AsyncState);
    //Now continue with what you were doing 
    //and let the lookup finish
}

void LookupResult(IAsyncResult result)
{
    //when the async function is finished
    //this method is called. It's on
    //the same thread as the the caller,
    //BeginCodeLookup in this case.
    result.AsyncWaitHandle.WaitOne();
    var LookupResult= Proxy.EndCodeLookup(result);
    //The SynchronizationContext.Send method
    //performs a callback to the thread of the 
    //context, in this case the main thread
    context.Send(new SendOrPostCallback(OnLookupCompleted),
                 result.AsyncState);                         
}

void OnLookupCompleted(object state)
{
    //now this code will be executed on the 
    //main thread.
} 
```

我希望这会有所帮助，因为它为我解决了问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T05:00:51.603

也许您可以让 DoSyncTask 启动一个计时器对象，以某个适当的时间间隔检查数据变量的值。一旦数据有一个值，您就可以触发另一个事件来告诉您数据现在有一个值（当然还要关闭计时器）。

相当丑陋的黑客，但它可以工作......理论上。

抱歉，这是我能想到的最好的半睡半醒。该睡了...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T21:54:27.590

我为异步同步问题制定了一个解决方案，至少使用所有 .NET 类。

[http://geekswithblogs.net/rgray/archive/2009/01/29/turning-an-asynchronous-call-into-a-synchronous-call.aspx](http://geekswithblogs.net/rgray/archive/2009/01/29/turning-an-asynchronous-call-into-a-synchronous-call.aspx)

它仍然不适用于 COM。我怀疑是因为 STA 线程。由承载 COM OCX 的 .NET 组件引发的事件从未由我的工作线程处理，因此我在 WaitOne() 上遇到了死锁。

不过，其他人可能会欣赏该解决方案:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T00:04:29.493

在我重新阅读之后，我对 Scott W 答案的评论似乎有点神秘。所以让我更明确一点：

```
while( !done )
{
    taskDone.WaitOne( 200 );
    Application.DoEvents();
} 
```

WaitOne( 200 ) 将使其每秒将控制权返回给您的 UI 线程 5 次（您可以根据需要进行调整）。DoEvents() 调用将刷新 windows 事件队列（处理所有 windows 事件处理的队列，如绘画等）。向您的班级添加两个成员（在本示例中一个布尔标志“完成”，在您的示例中一个返回数据“street”）。

这是完成你想做的最简单的方法。（我自己的应用程序中有非常相似的代码，所以我知道它有效）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T05:01:46.487

如果 Task 是一个 WinForms 组件，它可能会非常了解线程问题并在主线程上调用事件处理程序——这似乎就是您所看到的。

因此，它可能依赖于消息泵的发生或其他事情。Application.Run 具有适用于非 GUI 应用程序的重载。您可能会考虑让一个线程启动和抽水，看看是否能解决问题。

我还建议使用 Reflector 查看组件的源代码，以了解它在做什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-09T20:26:38.330

你的代码几乎是正确的......我刚刚改变了

```
t.DoTask(latitude, longitude); 
```

为了

```
new Thread(() => t.DoTask(latitude, longitude)).Start(); 
```

`TaskCompleted`将在同一个线程中`DoTask`执行。这应该有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T05:22:20.233

你几乎明白了。您需要 DoTask 方法在不同的线程上运行，以便 WaitOne 调用不会阻止工作的完成。像这样的东西：

```
Action<int, int> doTaskAction = t.DoTask;
doTaskAction.BeginInvoke(latitude, longitude, cb => doTaskAction.EndInvoke(cb), null);
taskDone.WaitOne(); 
```

# ruby-on-rails - 特定控制器的不同日志文件

> ID：486400
> 
> 赞同：1
> 
> 时间：2009-01-28T03:33:52.090
> 
> 标签：ruby-on-rails, logging

我目前有一个控制器，如果我想在单独的日志文件中跟踪日志记录，例如：tracker.log。我目前每天大约有 100,000 次点击，我想将日志与所有其他控制器分开，以便我可以轻松调试这些控制器以及跟踪器。

我找不到 Rails::Initializer 的任何东西，它会专门为控制器扩展。

我知道这将是这样的：

```
config.log_path = 'log/tracker.log'

```

尽管您不能在加载中重新运行 Rails 初始化程序，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T03:37:19.230

AFAIK rails 不能同时维护两个单独的日志文件。我建议您自己登录有问题的控制器。

在类似的情况下，我使用过[log4r](http://log4r.sourceforge.net/)。这很[容易](http://log4r.sourceforge.net/manual.html#outofbox)上手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T03:49:32.513

您只需要创建自己的 Logger 类实例（Rails 使用它来生成日志文件）并将 File 实例作为参数传递给它。

# memcached - Memcached 和 Velocity

> ID：486403
> 
> 赞同：4
> 
> 时间：2009-01-28T03:36:08.607
> 
> 标签：memcached, appfabric

[在阅读了 Scott Hanselman 对这个问题](https://stackoverflow.com/questions/479400/one-cache-for-various-applications)的回答后，我正在研究使用 Memcached 或 Velocity 在服务器集群上进行分布式缓存。有人知道使用 Velocity 进行缓存的 Microsoft 网站吗？如果 Microsoft 不使用它，那么是否有人知道任何相对流行的网站正在使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T03:42:24.507

任何实质性网站在产品的 CTP 上上线（生产中）都是非常愚蠢的（***编辑 -****评论中的好点 - 这不是硬性规则......有例外，例如 stackoverflow*）。Velocity 目前处于 CTP2 中，这对于构建概念验证和规划产品发布很有帮助，但仅此而已。一旦它成为受支持的产品，我相信我们会看到大量使用。关注 Velocity 产品团队博客 ( [http://blogs.msdn.com/velocity/](http://blogs.msdn.com/velocity/) ) 了解详细信息。

就 memcached 与 Velocity 而言，它们有一些重叠但最终不同的目的。Memcached*不*可靠。这在文档和作者中都清楚地说明了。它的目的是速度极快、运行成本低且易于管理。另一方面，Velocity 对正式的企业软件人群来说更为熟悉。它很复杂，具有强大的 API，更适合更正式的数据环境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T03:43:54.613

在 Win32 上本机不支持 memcached。有一个项目旨在将 memcached 移植到 Win32

[http://jehiah.cz/projects/memcached-win32/](http://jehiah.cz/projects/memcached-win32/)

虽然他们取得了成功，但他们落后于主要发布线的几个版本（此时为点版本）。因此，如果您使用的是 Win32，我认为您最好的选择是 Velocity。

因此，虽然我没有回答您的问题（哪些网站使用 Velocity），但我认为您最好使用 Velocity 而不是 memcached。

# asp.net-mvc - 可以覆盖页面的 ValidateRequest 设置吗？

> ID：486408
> 
> 赞同：31
> 
> 时间：2009-01-28T03:40:58.893
> 
> 标签：asp.net-mvc

我有一个 ASP.NET MVC 表单，它可能（通常会）提交一个响应，该响应会触发“从客户端检测到潜在危险的 Request.Form 值”错误。

为了解决这个问题，我在页面指令中放置了一个 ValidateRequest="false"。

唯一的问题：我仍然收到错误！

现在，一切都很好，直到我今天早上更新到 ASP.NET MVC RC，并且（根据自述文件），在 Views web.config 中放置了以下内容：

```
<pages validateRequest="false" 
       pageParserFilterType="System.Web.Mvc.ViewTypeParserFilter, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
       pageBaseType="System.Web.Mvc.ViewPage, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
       userControlBaseType="System.Web.Mvc.ViewUserControl, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
    <controls>
        <add assembly="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" namespace="System.Web.Mvc" tagPrefix="mvc" />
    </controls>
</pages> 
```

那么，所有页面的 validateRequest 都应该为 false，对吗？我错过了什么？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-01-28T06:17:38.343

在 MVC 中，验证发生在控制器级别，而不是页面级别。要了解为什么会这样，请考虑在执行控制器操作时，我们不知道将选择哪个视图来呈现。（事实上​​，控制器操作甚至可能根本不渲染视图！它可能会在客户端打开文件下载提示。）此外，如果用户向服务器提交恶意输入，则在渲染视图时为时已晚，对此无能为力。控制器已经将危险输入提交到数据库。

相反，请使用属性 [ValidateInput(false)] 来装饰控制器或操作。这将导致我们禁止对该控制器或操作的请求验证。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-08-20T14:54:26.780

必须使用属性 [ValidateInput(false)] 装饰控制器或操作，并将 requestValidationMode="2.0" 添加到 web.config 文件：示例：

控制器：

```
 [ValidateInput(false)]
    public class MensajesController : Controller
    {
        //or in an action
        [ValidateInput(false)]
        [HttpPost]
        public ActionResult Create(FormCollection collection)
        {
        }
    } 
```

配置文件：

```
 <configuration>
        <system.web>
           <httpRuntime requestValidationMode="2.0"/>
        </system.web>
    </configuration> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-22T04:38:29.467

我们有一个基础控制器，我们的控制器继承自该控制器，允许我们全局禁用内部 ASP.NET 请求验证：

```
 protected override void Initialize(RequestContext requestContext)
    {
        // no client input will be checked on any controllers
        ValidateRequest = false;
        base.Initialize(requestContext);
    } 
```

只需确保**验证来自客户端的所有输入**！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-12T04:28:02.373

我在使用带有 .NET 4.0 的 ASP.NET MVC 3 和 Windows Azure 访问控制服务 v2 时遇到了类似的问题，我会收到错误消息：

```
System.Web.HttpRequestValidationException: A potentially dangerous Request.Form value was detected from the client (wresult="<t:RequestSecurityTo..."). 
```

并发现比关闭验证更好的解决方案是实现自定义 RequestValidator，如本文所述：

[http://social.technet.microsoft.com/wiki/contents/articles/windows-identity-foundation-wif-a-potentially-dangerous-request-form-value-was-detected-from-the-client-wresult- quot-lt-t-requestsecurityto-quot.aspx](http://social.technet.microsoft.com/wiki/contents/articles/windows-identity-foundation-wif-a-potentially-dangerous-request-form-value-was-detected-from-the-client-wresult-quot-lt-t-requestsecurityto-quot.aspx)

```
public class SampleRequestValidator : RequestValidator
{
    protected override bool IsValidRequestString( HttpContext context, string value, RequestValidationSource requestValidationSource, string collectionKey, out int validationFailureIndex )
    {
        validationFailureIndex = 0;
        if ( requestValidationSource == RequestValidationSource.Form && collectionKey.Equals( WSFederationConstants.Parameters.Result, StringComparison.Ordinal ) )
        {
            SignInResponseMessage message = WSFederationMessage.CreateFromFormPost( context.Request ) as SignInResponseMessage;
            if ( message != null )
            {
                return true;
            }
        }
        return base.IsValidRequestString( context, value, requestValidationSource, collectionKey, out validationFailureIndex );
    }
} 
```

我比关闭验证更进一步的唯一原因是，当我在 Windows Azure 平台培训工具包中遵循本教程时，我已经看到它在没有关闭验证的情况下工作：

[http://msdn.microsoft.com/en-us/WAZPlatformTrainingCourse_IntroToACSLabsV2](http://msdn.microsoft.com/en-us/WAZPlatformTrainingCourse_IntroToACSLabsV2)

无论如何，希望这对某人有用，并且可能会提供一种更精细的方法来解决这个问题。需要注意的是，如果你实现了自定义的 RequestValidator，requestValidationMode="2.0" 不是必需的。

# javascript - 有什么方法可以防止“取消选择”突出显示的文本？

> ID：486414
> 
> 赞同：13
> 
> 时间：2009-01-28T03:44:04.100
> 
> 标签：javascript, html, css, html-select

突出显示此网页上的一些文本，然后基本上单击文档上的任意位置。您的选择将消失。

当用户通过 CSS 或 Javascript 点击特定元素时，有没有办法防止这种行为？

例如：

```
var element = document.getElementById("foo");
foo.onclick = function(e){
   //some magic here that prevents deselection from occuring
} 
```

或者

```
foo.style.preventDeselect = "true"; 
```

编辑：也许我可以存储选择，然后在“鼠标单击”后恢复选择？有没有办法*存储*选择，然后*重新选择*它？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T04:26:15.543

onmousedown 中的“return false”和“e.preventDefault()”适用于 FF 和 Safari，但不适用于 IE。据我所知，IE 的唯一解决方案是抛出错误。

这适用于所有浏览器（但在 IE 中会导致错误，因为 preventDefault 不是一种方法）：

```
//clicking the 'test' element will not deselect text.
var test = document.getElementById("test");
test.onmousedown = function(e){
  e = e || window.event;
  e.preventDefault();
} 
```

如果可能的话，我仍然希望在 IE 中无错误地执行此操作

感谢 Paolo Bergantino 的“onmousedown”提示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T03:56:01.313

这适用于我在 Firefox 上，虽然没有尝试过 IE。`foo.style.preventDeselect = "true";`选择文本后尝试单击该行。使用`mousedown`事件。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<script>
$(document).ready(function() {
    $('#test').mousedown(function() {
        return false;
    });
});
</script>
<body>

Highlight some text on this webpage, then click basically anywhere on the document. Your selection will disappear.<br><Br>

Is there a way to prevent this behavior when the user clicks on a specific element, either by CSS or Javascript?<br><Br>

E.g.:<br><Br>

var element = document.getElementById("foo");<br>
foo.onclick = function(e){<br>
   //some magic here that prevents deselection from occuring<br>
}<br><Br>

or<br><Br>

<span id='test'>foo.style.preventDeselect = "true";</span><br><Br>

Thanks!<br><Br>

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T03:54:46.807

这种行为虽然在现代浏览器中大多是通用的，但特定于浏览器/实现，并且几乎与 CSS 或 Javascript 完全无关。特别要注意的是，Firefox 为整个页面和文本框的内容维护单独的选择状态，而 IE 不这样做。更糟糕的是，考虑具有单独的鼠标和键盘选择界面的文本模式浏览器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T05:26:08.323

关于什么

```
if(e.preventDefault) 
    e.preventDefault();
else
    e.returnValue = false; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-14T14:09:18.757

以防万一有人检查出来，我遇到了类似的问题。我需要在通过单击工具栏按钮（与背景图像的跨度）触发的一段选定文本上运行一些 javascript。我通过将跨度更改为具有“javascript:void(0)”href 的锚点来解决我的问题。这阻止了我选择的文本被取消选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-21T22:19:36.767

我想出如何做到这一点的最好方法是，对于 IE，您需要在“onselectstart”上设置一个侦听器。对于 Mozilla 和其他浏览器，您可以在“mousedown”上进行操作。**仅当您不在站点的任何其他部分使用“mousedown”时，这才有效！**

片段：YUI 方式：FF 浏览器：

*   YAHOO.util.Event.addListener(window, 'mousedown', function(evt) { YAHOO.util.Event.preventDefault(evt); });

    IE 浏览器：在 IE 中，您不能在窗口上设置此侦听器，因为在 IE 中它不起作用。最好的办法是在你的 body 元素上设置一个类元素，然后引用它，并将侦听器应用于该元素对象。

*   // 按类获取元素并赋值给**var bar** YAHOO.util.Event.addListener(bar, 'selectstart', function(evt) { YAHOO.util.Event.preventDefault(evt); });

如果您想以简单的方式做到这一点，那就做

*   window.onMouseDown = function() {return false;}

或者对于 IE

*   body.onSelectStart = function() {return false;}

希望这可以帮助。

# winforms - Infragistics UltraCalendarCombo 似乎在吸毒

> ID：486416
> 
> 赞同：2
> 
> 时间：2009-01-28T03:44:49.323
> 
> 标签：winforms, infragistics

我有一个 UltraCalendarCombo 日历控件，我需要禁用一组日期（基本上是周末和公共假期）。

我遍历该月的日期列表并将所有相应的日期设置为禁用，这使当前月份看起来不错，但是当我单击控件上的下个月按钮并尝试访问现在过去的一个月 + 3 或 4它跳回到这个月。

有谁知道这个控件在吸烟，我在哪里可以买到一些？

```
 DateTimeCollection badDates = getMeSomeBadDatesmonth, year);

            foreach (DateTime date in badDates)
            {
                myForm.CalendarInfo.DaysOfMonth[date.Day].Enabled = false;
            } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T04:19:45.523

一段时间以来，他们的控制一直在走下坡路。我想知道他们都在那边抽什么烟。自 2004 年版的 Net Advantage（我非常喜欢）以来，我一直在使用他们的控件，但我已经放弃在任何新开发中使用它们。功能的膨胀破坏了功能的作用，文档简直太可怕了:(

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T21:54:50.273

排序后，DaysOfMonth 集合适用于所有月份的特定日期（按数字）。例如，DaysOfMonth[10] 适用于一年中每个月的十号。

所以我需要使用：

```
Infragistics.Win.UltraWinSchedule.Day theDay = _form.ValueDateCalInfo.GetDay(date, true);
if (theDay != null) theDay.Enabled = false; 
```

# css - X 之于 CSS 就像 GWT 之于 Javascript；X是什么？

> ID：486418
> 
> 赞同：4
> 
> 时间：2009-01-28T03:47:51.953
> 
> 标签：css, gwt

是否有一种结构化语言以合理的方式声明样式，然后可以将其呈现为特定于浏览器的 css 文件，类似于 GWT 对 Javascript 所做的事情？

理想情况下，它应该是一种支持变量的语言，处理浏览器的怪癖和差异（例如 filter:alpha vs opacity），为常见任务（如居中）提供直观的语法，并为功能较弱的浏览器提供一种表达回退的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T03:59:02.900

[Sass](http://haml.hamptoncatlin.com/docs/rdoc)，就像在 Haml 和 Sass 中一样，有一些你正在寻找的东西。它有变量、数学和其他好东西。

官方版本是基于 Ruby 的，但也有 PHP 和 Python 等其他语言的版本。

它可能不会做你提到的一切，但值得一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T03:59:24.520

GWT 动态生成代码的能力及其强大的“延迟绑定”功能绝对可以应用于样式表并允许 CSS 的构建时优化。

现在，根据样式，“GWT 方式”是包含您需要的所有样式，并通过使用“依赖样式名称”来应用它们。但这肯定会导致在不需要的地方包含无用的 CSS。

我知道至少有一次尝试在构建时优化 CSS。这将涉及将多个单独的样式表合并为一个，并删除所有非必要的空白（缩小）。我认为这也可能允许您使用 deffrred 绑定从根本上“优化”不需要的 CSS（例如：浏览器特定样式）。

[样式注入器](http://code.google.com/p/google-web-toolkit-incubator/wiki/StyleInjector)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-09T22:50:55.723

（再次）回答我自己的问题：[Less](http://lesscss.org/ "LESS - 更精简的 CSS")似乎是迄今为止最有趣的项目之一。CSS 扩展支持变量、mixin（复杂变量）、嵌套规则和简单算术。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T06:11:59.993

您可能想尝试[HSS](http://ncannasse.fr/projects/hss)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-31T03:31:32.527

感谢您的意见！Sass 和 HSS 在范围上看起来非常相似：简单和块变量、嵌套块、单行注释。HSS 具有作为 CSS 超集的优势。

StyleInjector 看起来更有野心和有趣。通过利用 GWT 的延迟绑定功能并引入 CSS 语法扩展（如条件），这种方法不仅可以轻松定义特定于浏览器的样式，还可以轻松定义特定于语言环境的样式。还能够直接引用其他 GWT 资源，并通过删除和合并选择器自动最小化样式非常酷。我一定会密切关注这个项目。

# c# - 将现有的代码片段转换为使用 Array.ForEach

> ID：486420
> 
> 赞同：0
> 
> 时间：2009-01-28T03:49:10.033
> 
> 标签：c#, c#-3.0, functional-programming, lambda

我们知道，如果您有：

```
var aa = new [] { 1, 2, 3, 4, 5 };
for (int i = 0; i < aa.length; ++i)
{
    aa[i] = aa[i] + 1;
} 
```

是真的

```
var aa = new [] { 1, 2, 3, 4, 5 };
Arrary.ForEach(aa, a => a + 1); 
```

但是，如果我有这个怎么办：

```
var aa = new [] { 1, 2, 3, 4, 5 };
var ab = new [] { 1, 2, 3, 4, 5 };
for (int i = 0; i < aa.length; ++i)
{
    aa[i] = ab[i] + 1;
} 
```

我可以将其转换为仅使用一个 Array.ForEach 吗？或者，如果你想让所有的函数式编程变得疯狂，你会怎么做？笨重的 for 循环看起来很丑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T06:32:49.657

怎么样：

```
aa = ab.ConvertAll(x => x+1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T04:02:35.340

它不漂亮，但这会起作用（使用返回元素索引的 Select() 重载）：

```
var aa = new[] { 1, 2, 3, 4, 5 };
var ab = new[] { 1, 2, 3, 4, 5 };

Array.ForEach(
    aa.Select((x, i) => i).ToArray(),
    i => aa[i] = ab[i] + 1); 
```

恕我直言，在这种情况下，一个简单的“for”循环更容易理解。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T04:10:27.663

另一种类似的方法：

```
Enumerable.Range(0, ab.Length).Select(i => aa[i] = ab[i] + 1);
// Will not work if aa.Length != ab.Length 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T03:57:41.387

这不会很快，但它可能会起作用

```
var aa = new [] { 1, 2, 3, 4, 5 };
var ab = new [] { 1, 2, 3, 4, 5 };
Array.ForEach(aa, new Action(a => ab[Array.IndexOf(a)] + 1)); 
```

不幸的是，这不适用于具有重复元素的数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-21T15:51:13.687

```
var aa = new[] { 1, 2, 3, 4, 5 };
var ab = new[] { 1, 2, 3, 4, 5 };

var index = 0;
Array.ForEach(aa, a => { aa[index] = ab[index] + 1; index++; }); 
```

这行不通吗？它的 1 个 Array.ForEach 与索引器保持在 Array.ForEach 之外。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-03T04:46:38.893

不是直接的答案，但您需要 ForEach2，它迭代两个序列/数组。不幸的是，这不包含在 BCL 中，因此您必须添加它。

但是，如果您尝试在 C# 中执行功能，那么无论如何您可能都会有一个帮助程序库，所以这没什么大不了的。

# c++ - 在哪里可以找到 MSCVR80.DLL v8.0.50727.3053？

> ID：486435
> 
> 赞同：1
> 
> 时间：2009-01-28T04:00:52.363
> 
> 标签：c++, visual-studio-2005, dll

我从我们的一位客户那里得到了一个错误，并认为问题出在**MSVCR80.DLL v8.0.50727.3053** - 我无法在任何地方找到下载的版本，但是[谷歌搜索](http://google.com/search?q=MSVCR80.DLL+8.0.50727.3053)出现了大量其他崩溃报告。

我系统上的最新版本（以及此处的其他版本）是 8.0.50727.1433，[Microsoft Visual C++ 2005 SP1 Redistributable Package (x86)](http://www.microsoft.com/downloads/details.aspx?familyid=200b2fd9-ae1a-4a14-984d-389c36f85647&displaylang=en)只有 8.0.5027.762 版本（目前与我们使用的合并模块相同）

是否有获取此更新的“官方”链接？它是否与任何其他 Microsoft 产品捆绑在一起？

**编辑：**请不要通过电子邮件发送给我，我正在寻找 SxS 安装。

**EDIT2：**该死，这毕竟不是问题:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T04:40:47.417

MSDN 论坛上的一个帖子[指出了答案](http://social.msdn.microsoft.com/Forums/en-US/windowsworkflowfoundation/thread/5d57e3b1-80c0-43c2-8eab-0b7c4fe168e2/)：msvcr80.dll 版本 8.0.50727.3053 包含在[.NET Framework 3.5 SP1中](http://www.microsoft.com/downloads/details.aspx?familyid=ab99342f-5d1a-413d-8319-81da479ab0d7&displaylang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T04:14:36.767

您应该能够使用 Microsoft 的 DLL 帮助数据库[http://support.microsoft.com/dllhelp/来回答这个问题](http://support.microsoft.com/dllhelp/)

不幸的是，当我尝试它时，我只得到 msvcr80.dll 的两个答案，而应该有几十个不同的版本：我不知道为什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-01T14:29:51.373

尝试使用“C:\Program Files\Common Files\Merge Modules”中的合并模块。

# .net - 是否有任何支持 .NET Compact Framework 的模拟库

> ID：486448
> 
> 赞同：3
> 
> 时间：2009-01-28T04:12:30.733
> 
> 标签：.net, unit-testing, compact-framework, mocking

我只是想知道是否有人找到了可以与 .NET 紧凑框架一起使用的模拟库。

我试过最小起订量，但它似乎不起作用，我做了一个快速的谷歌搜索，但找不到任何有用的东西。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T13:57:48.620

这个[问题的答案](https://stackoverflow.com/questions/122198/automated-test-framework-windows-ce)也可能有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T05:26:10.727

不幸的是，.Net CF 不支持 IL 发射或编译（通过 CSharpCodeProvider 等）。更好的模拟框架使用 IL emit，较旧的框架使用 CSharpCodeProvider——两者都不在 CF 中。

我敢说不可能编写 CF 模拟框架（除非有人将 Cecil 移植到 CF 并使用它在存储卡上创建程序集，然后动态加载它们）。

# code-signing - 如何验证已签名的 DLL 是否已由我签名？

> ID：486449
> 
> 赞同：5
> 
> 时间：2009-01-28T04:12:41.937
> 
> 标签：code-signing

我创建了一个自生成的证书来签署一个 DLL。当我将此 DLL 加载到我的 C++ 应用程序中时，我可以使用 WinVerifyTrust api 验证代码签名证书是否有效。

但我无法找到一种方法来检测 DLL 是否已由我的一个证书签名。即使使用 CryptQueryObject api，我也找不到任何有用的信息。

有谁知道如何做到这一点？还是有可能发生？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T04:49:35.450

[CryptVerifyCertificateSignature](http://msdn.microsoft.com/en-us/library/aa380912(VS.85).aspx)不是您想要的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T02:48:53.320

*如果您使用您的私钥*签署证书，则只能使用您的公钥对其进行*验证*。这就是公钥密码学的工作原理。如果您可以使用公钥来验证签名，那么您就知道**必须**使用相应的私钥对其进行签名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:30:48.430

如果您需要的版本也适用于比 Bill Zeller 向您展示的 Windows 的早期版本，您可以使用以下内容：

1.  `CryptQueryObject`与_`CERT_QUERY_OBJECT_FILE`
2.  在您从上一次通话中收到的电话上使用`CryptMsgGetParam`with`CMSG_SIGNER_CERT_INFO_PARAM``HCRYPTMSG`
3.  现在用于`CertCompareIntegerBlob`将您已知的（证书）序列号（或循环中的数字）与文件中的序列号进行比较

如果任何已知的序列号匹配，您就完成了。如果所有比较都失败，那不是你的证书。

**注意：**在文件属性对话框中查看证书的序列号时，与`PCERT_INFO`您`CERT_INFO::SerialNumber`从`CryptMsgGetParam`. 因此，请确保在比较之前将您自己的序列号颠倒或颠倒存储。

**另请注意：**您仍然需要将证书安装为受信任的，以便`WinVerifyTrust`（上面未提及）认为代码签名完全受信任。我刚刚描述了有关如何找出使用的是您自己的证书的部分。

# sql - 限制从 Oracle 中的 SQL 查询返回的记录

> ID：486452
> 
> 赞同：5
> 
> 时间：2009-01-28T04:15:40.773
> 
> 标签：sql, oracle

我负责每隔 x 秒检查一次 Oracle DB 表以查看是否有新数据要处理的应用程序之一（其他实时应用程序正在填充它）。

我们的新客户端业务流程强制我们实时在同一时间（例如 10 000 条）填充此表，但每天只有几次。下次我的应用程序检查是否有任何要处理的内容时，它会遇到 10 000 条记录并尝试处理它。

它的设计不是很好，只是规模不够好。快速修复将限制应用程序从 Oracle 获得的记录数量，下次它将选择另外 50 个（或其他）等。

如何在 Oracle SQL 中限制返回记录的数量？订单很重要！

```
 select * 
    from cool_table where date >= to_date('200901010000', 'YYYYMMDDhh24mi') 
order by seq_nr, entry_dts; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-28T04:47:44.220

```
select * from
(select c.* from cool_table c
   where date >= to_date('200901010000', 'YYYYMMDDhh24mi') 
   order by seq_nr, entry_dts)
where rownum < 50 
```

您需要确保在 rownum 过滤之前完成排序（否则它将占用它找到的前 50 行，然后对它们进行排序）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-23T11:44:42.920

从 Oracle 12c 开始，它最终支持标准 ANSI[`fetch first n rows`](https://docs.oracle.com/database/121/SQLRF/statements_10002.htm#BABHFGAA)选项：

```
select * 
from cool_table where date >= to_date('200901010000', 'YYYYMMDDhh24mi') 
order by seq_nr, entry_dts
fetch first 50 rows only; 
```

这可以与分页的偏移量结合使用：

```
select * 
from cool_table where date >= to_date('200901010000', 'YYYYMMDDhh24mi') 
order by seq_nr, entry_dts
offset 50 rows 
fetch first 50 rows only; 
```

# c++ - 关于函数范围的基本 C++ 问题

> ID：486454
> 
> 赞同：1
> 
> 时间：2009-01-28T04:17:08.620
> 
> 标签：c++, function, scope

我刚开始学习 C++，所以你必须忍受我的无知。有没有办法声明函数，以便可以在使用它们的函数之前引用它们而无需编写它们。我正在使用一个 cpp 文件（不是我的决定）并且我的函数会调用它们自己，因此实际上并没有正确的顺序来放置它们。在使用它们之前有什么方法可以#define 函数或类似的东西？或者也许是一种使用范围运算符标记它们的方法，而不需要它们实际上是一个类的一部分？

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T04:22:56.097

您可以在实现它们之前编写函数**原型。**函数原型命名一个函数、它的返回类型和它的参数类型。唯一需要在函数调用之上的是原型。这是一个例子：

```
// prototype
int your_function(int an_argument);

// ...
// here you can write functions that call your_function()
// ...

// implementation of your_function()
int your_function(int an_argument) {
    return an_argument + 1;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T04:23:40.650

我认为您指的是**函数原型**。

这是您在**头文件**中定义函数原型的地方，但在**源 (.cpp) 文件**中定义实现。

需要引用函数的源代码只包含头文件，它为编译器提供了足够的信息，以将函数调用与您正在调用的函数的参数和返回值相关联。

只有在链接阶段，函数“符号”才会针对源文件解析——如果此时函数**实现**不存在，您将得到一个未解析的符号。

这是一个例子：

库头文件 - library.h

```
// This defines a prototype (or signature) of the function
void libFunction(int a); 
```

库源 (.cpp) 文件 - library.cpp

```
// This defines the implementation (or internals) of the function
void libFunction(int a)
{
   // Function does something here...
} 
```

客户端代码

```
#include "library.h"
void applicationFunction()
{
   // This function call gets resolved against the symbol at the linking stage
   libFunction();
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T04:34:04.170

你需要的是一个函数*声明*（又名*原型*）。声明是没有主体的函数的返回类型、名称和参数列表。这些通常在头文件中，但并非必须如此。这是一个例子：

```
#include< stdio >
using namespace std;

void bar( int x );  // declaration
void foo( int x );  // declaration

int main() {
    foo( 42 );      // use after declaration and before definition
    return 0;
}

void foo( int x ) { // definition
    bar( x );       // use after declaration and before definition
}

void bar( int x ) { // definition
    cout << x;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T04:23:09.060

是的。将函数的签名放在文件顶部或头文件 (.h) 中。

所以：

```
void OtherFunc(int a);

void SomeFunc()
{
    OtherFunc(123);
}

void OtherFunc(int a)
{
    ...
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T04:23:52.257

类成员函数在定义类接口的头文件中声明。此头文件应包含在包含实现的 CPP 文件的顶部或附近。因此，在 CPP 文件中定义成员函数的顺序无关紧要，因为所有声明都已包含在内。

根据您的问题，我想您正在考虑编写免费函数。您可以使用相同的技术来声明自由函数；但是，我警告不要使用太多的免费功能。

# c# - 如何在 C# 中序列化异常对象？

> ID：486460
> 
> 赞同：76
> 
> 时间：2009-01-28T04:20:25.320
> 
> 标签：c#, .net, exception, serialization

我正在尝试在 C# 中序列化一个异常对象。但是，这似乎是不可能的，因为 Exception 类未标记为[`[Serializable]`](https://msdn.microsoft.com/en-us/library/system.serializableattribute)。有没有办法解决这个问题？

如果在应用程序的执行过程中出现问题，我想知道发生的异常。

我的第一个反应是序列化它。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-01-28T04:29:37.737

**使用[Serializable()]**属性创建自定义异常类。这是取自[MSDN](http://msdn.microsoft.com/en-us/library/ms173163.aspx)的示例：

```
[Serializable()]
public class InvalidDepartmentException : System.Exception
{
    public InvalidDepartmentException() { }
    public InvalidDepartmentException(string message) : base(message) { }
    public InvalidDepartmentException(string message, System.Exception inner) : base(message, inner) { }

    // Constructor needed for serialization 
    // when exception propagates from a remoting server to the client.
    protected InvalidDepartmentException(System.Runtime.Serialization.SerializationInfo info,
        System.Runtime.Serialization.StreamingContext context) : base(info, context) { }
} 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-01-28T05:49:42.910

我之前所做的是创建一个自定义错误类。这封装了有关异常的所有相关信息，并且是 XML 可序列化的。

```
[Serializable]
public class Error
{
    public DateTime TimeStamp { get; set; }
    public string Message { get; set; }
    public string StackTrace { get; set; }

    public Error()
    {
        this.TimeStamp = DateTime.Now;
    }

    public Error(string Message) : this()
    {
        this.Message = Message;
    }

    public Error(System.Exception ex) : this(ex.Message)
    {
        this.StackTrace = ex.StackTrace;
    }

    public override string ToString()
    {
        return this.Message + this.StackTrace;
    }
} 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-01-28T04:30:29.450

**Exception 类*被*标记为 Serializable 并实现 ISerializable。**请参阅 MSDN：http: [//msdn.microsoft.com/en-us/library/system.exception.aspx](http://msdn.microsoft.com/en-us/library/system.exception.aspx)

如果您尝试使用 序列化为 XML `XmlSerializer`，您将在任何实现的成员上遇到错误`IDictionary`。这是 XmlSerializer 的一个限制，但该类肯定是可序列化的。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-04-09T15:53:25.780

mson 写道：“我不确定你为什么要序列化异常......”

我序列化异常以通过 Web 服务将异常冒泡到可以反序列化的调用对象，然后重新抛出、记录或以其他方式处理它。

我这样做了。我只是创建了一个可序列化的包装类，它用可序列化的替代品（KeyValuePair 数组）替换 IDictionary

```
/// <summary>
/// A wrapper class for serializing exceptions.
/// </summary>
[Serializable] [DesignerCategory( "code" )] [XmlType( AnonymousType = true, Namespace = "http://something" )] [XmlRootAttribute( Namespace = "http://something", IsNullable = false )] public class SerializableException
{
    #region Members
    private KeyValuePair<object, object>[] _Data; //This is the reason this class exists. Turning an IDictionary into a serializable object
    private string _HelpLink = string.Empty;
    private SerializableException _InnerException;
    private string _Message = string.Empty;
    private string _Source = string.Empty;
    private string _StackTrace = string.Empty;
    #endregion

    #region Constructors
    public SerializableException()
    {
    }

    public SerializableException( Exception exception ) : this()
    {
        setValues( exception );
    }
    #endregion

    #region Properties
    public string HelpLink { get { return _HelpLink; } set { _HelpLink = value; } }
    public string Message { get { return _Message; } set { _Message = value; } }
    public string Source { get { return _Source; } set { _Source = value; } }
    public string StackTrace { get { return _StackTrace; } set { _StackTrace = value; } }
    public SerializableException InnerException { get { return _InnerException; } set { _InnerException = value; } } // Allow null to be returned, so serialization doesn't cascade until an out of memory exception occurs
    public KeyValuePair<object, object>[] Data { get { return _Data ?? new KeyValuePair<object, object>[0]; } set { _Data = value; } }
    #endregion

    #region Private Methods
    private void setValues( Exception exception )
    {
        if ( null != exception )
        {
            _HelpLink = exception.HelpLink ?? string.Empty;
            _Message = exception.Message ?? string.Empty;
            _Source = exception.Source ?? string.Empty;
            _StackTrace = exception.StackTrace ?? string.Empty;
            setData( exception.Data );
            _InnerException = new SerializableException( exception.InnerException );
        }
    }

    private void setData( ICollection collection )
    {
        _Data = new KeyValuePair<object, object>[0];

        if ( null != collection )
            collection.CopyTo( _Data, 0 );
    }
    #endregion
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-01-28T04:29:27.347

如果您尝试序列化日志的异常，最好执行 .ToString()，然后将其序列化到您的日志中。

但[这里](http://web.archive.org/web/20160308011357/http://winterdom.com/2007/01/makeexceptionclassesserializable)有一篇关于如何做到这一点以及为什么这样做的文章。基本上，您需要在您的异常上实现 ISerializable。如果是系统异常，我相信他们已经实现了该接口。如果是其他人的异常，您也许可以将其子类化以实现 ISerializable 接口。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-03-15T14:42:30.020

这是一个非常有用的类，用于将`Exception`对象序列化为`XElement`（是的，LINQ）对象：

[http://seattlesoftware.wordpress.com/2008/08/22/serializing-exceptions-to-xml/](http://seattlesoftware.wordpress.com/2008/08/22/serializing-exceptions-to-xml/)

为完整性而包含的代码：

```
using System;
using System.Collections;
using System.Linq;
using System.Xml.Linq;

public class ExceptionXElement : XElement
{
    public ExceptionXElement(Exception exception)
        : this(exception, false)
    { ; }

    public ExceptionXElement(Exception exception, bool omitStackTrace)
        : base(new Func<XElement>(() =>
        {
            // Validate arguments
            if (exception == null)
            {
                throw new ArgumentNullException("exception");
            }

            // The root element is the Exception's type
            XElement root = new XElement(exception.GetType().ToString());
            if (exception.Message != null)
            {
                root.Add(new XElement("Message", exception.Message));
            }

            // StackTrace can be null, e.g.:
            // new ExceptionAsXml(new Exception())
            if (!omitStackTrace && exception.StackTrace != null)
            {
                vroot.Add(
                    new XElement("StackTrace",
                    from frame in exception.StackTrace.Split('\n')
                    let prettierFrame = frame.Substring(6).Trim()
                    select new XElement("Frame", prettierFrame))
                );
            }

            // Data is never null; it's empty if there is no data
            if (exception.Data.Count > 0)
            {
                root.Add(
                    new XElement("Data",
                        from entry in exception.Data.Cast<DictionaryEntry>()
                        let key = entry.Key.ToString()
                        let value = (entry.Value == null) ? "null" : entry.Value.ToString()
                        select new XElement(key, value))
                );
            }

            // Add the InnerException if it exists
            if (exception.InnerException != null)
            {
                root.Add(new ExceptionXElement(exception.InnerException, omitStackTrace));
            }
            return root;
        })())
    { ; }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-06-05T08:53:03.667

创建一个`protected`这样的构造函数（你也应该标记你的`Exception`类`[Serializable]`）：

```
protected MyException(System.Runtime.Serialization.SerializationInfo info,
    System.Runtime.Serialization.StreamingContext context):base(info,context)
{
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-02-03T12:08:22.523

我遇到了一个类似的问题，我需要记录`Exception`我的应用程序中抛出的细节，但是，它包含一个不可序列化的成员，因此无法序列化。

作为一种解决方法，`.ToString()`方法被调用，`Exception`它返回`string`包含`Exception`.

```
string bar;

if (foo is Exception exception)
{
   bar = exception.ToString();
} 
```

来源： [`Exception.ToString`方法](https://docs.microsoft.com/en-us/dotnet/api/system.exception.tostring?view=net-5.0#System_Exception_ToString)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-10-11T19:27:43.577

这是一个旧线程，但值得另一个答案。

@mson 想知道为什么有人想要序列化异常。这是我们这样做的原因：

我们有一个 Prism/MVVM 应用程序，在 Silverlight 和 WPF 中都有视图，在 WCF 服务中有数据模型。我们希望确保数据访问和更新不会出错。如果出现错误，我们希望立即知道，并让用户知道某事可能已经失败。我们的应用程序将弹出一个窗口，通知用户可能出现的错误。然后将实际异常通过电子邮件发送给我们，并存储在 SpiceWorks 中以供跟踪。如果错误发生在 WCF 服务上，我们希望*将完整的异常*返回给客户端，以便可以进行此过程。

这是我提出的可以由 WPF 和 Silverlight 客户端处理的解决方案。下面的方法在每个层中多个应用程序使用的方法的“通用”类库中。

***字节数组很容易从 WCF 服务序列化。几乎任何对象都可以转换为字节数组。***

我从两个简单的方法开始，Object2Bytes 和 Bytes2Object。这些将任何对象转换为字节数组并返回。NetDataContractSerializer 来自 Windows 版本的 System.Runtime.Serialization 命名空间。

```
Public Function Object2Bytes(ByVal value As Object) As Byte()
    Dim bytes As Byte()
    Using ms As New MemoryStream
        Dim ndcs As New NetDataContractSerializer()
        ndcs.Serialize(ms, value)
        bytes = ms.ToArray
    End Using
    Return bytes
End Function

Public Function Bytes2Object(ByVal bytes As Byte()) As Object
    Using ms As New MemoryStream(bytes)
        Dim ndcs As New NetDataContractSerializer
        Return ndcs.Deserialize(ms)
    End Using
End Function 
```

最初，我们会将所有结果作为对象返回。如果从服务返回的对象是一个字节数组，那么我们就知道这是一个异常。然后我们会调用“Bytes2Object”并抛出异常进行处理。

此代码的问题在于，它与 Silverlight 不兼容。因此，对于我们的新应用程序，我保留了难以序列化对象的旧方法，并为异常创建了一对新方法。DataContractSerializer 也来自 System.Runtime.Serialization 命名空间，但它存在于 Windows 和 Silverlight 版本中。

```
Public Function ExceptionToByteArray(obj As Object) As Byte()
    If obj Is Nothing Then Return Nothing
    Using ms As New MemoryStream
        Dim dcs As New DataContractSerializer(GetType(Exception))
        dcs.WriteObject(ms, obj)
        Return ms.ToArray
    End Using
End Function

Public Function ByteArrayToException(bytes As Byte()) As Exception
    If bytes Is Nothing OrElse bytes.Length = 0 Then
        Return Nothing
    End If
    Using ms As New MemoryStream
        Dim dcs As New DataContractSerializer(GetType(Exception))
        ms.Write(bytes, 0, bytes.Length)
        Return CType(dcs.ReadObject(ms), Exception)
    End Using
End Function 
```

当没有发生错误时，WCF 服务返回 1。如果发生错误，它会将异常传递给调用“ExceptionToByteArray”的方法，然后从当前时间生成一个唯一的整数。它使用该整数作为键来缓存字节数组 60 秒。然后 WCF 服务将键值返回给客户端。

当客户端看到它返回一个非 1 的整数时，它会使用该键值调用服务的“GetException”方法。该服务从缓存中获取字节数组并将其发送回客户端。客户端调用“ByteArrayToException”并如上所述处理异常。60 秒是客户端向服务请求异常的充足时间。不到一分钟，服务器的 MemoryCache 就被清空了。

我认为这比创建自定义异常类更容易。我希望这对以后的人有所帮助。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-01-28T04:26:12.767

我不确定你为什么要序列化异常......

如果我确实想做你指定的事情，我会创建一个实现 ISerializable 的自定义 Exception 类。您可以选择使其成为 Exception 的子级，或者您可以让它成为一个完全自定义的类，它只具有并执行您需要的内容。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2019-04-02T21:45:02.753

```
[Serializable]
public class CustomException: Exception
{
    public CustomException: ( Exception exception ) : base(exception.Message)
    {             
        Data.Add("StackTrace",exception.StackTrace);
    }      
} 
```

要序列化您的自定义异常：

```
JsonConvert.SerializeObject(customException); 
```

# performance - 填充多边形：缠绕规则与奇数规则的性能

> ID：486464
> 
> 赞同：3
> 
> 时间：2009-01-28T04:22:32.197
> 
> 标签：performance, algorithm, xlib, raster

对于复杂的多边形（即：自相交），绕组或奇偶填充规则之间的选择会影响多边形的填充方式。

但是对于不相交的多边形，绕组或奇偶填充规则之间是否存在任何性能差异。我知道这将是特定于实现的，但哪种算法对非复杂多边形更有效。

一个后续问题是这些算法中的每一个的复杂性是多少（即 O(what?) ）。我想知道是否值得去掉多边形中的一些点（主要是重复的或在同一条线上的点）以提高性能。

PS：如果这很重要，我正在使用 xlib

PPS：我可以确认问题与硬件无关，因为使用不同的显卡不会改变性能

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T08:17:24.703

今天，X 的大多数实现都使用图形卡的 2D 硬件，因此两者之间的差异可能可以忽略不计。

由于这是一个性能问题，但我的答案正确的可能性约为 10%（在性能方面，您有 90% 的机会在没有测量的情况下出错）。如果你想确定，没有办法，只能写一个小的性能测试，自己看看。

[x11perf](http://www.xfree86.org/4.3.0/x11perf.1.html)可能会有所帮助。

您可以在此处找到硬件独立多边形填充的算法：[http ://cvsweb.xfree86.org/cvsweb/xc/programs/Xserver/mi/mipolygen.c?rev=HEAD](http://cvsweb.xfree86.org/cvsweb/xc/programs/Xserver/mi/mipolygen.c?rev=HEAD)

如果你确定你的多边形是凸的，那么第二个版本会更快：[http ://cvsweb.xfree86.org/cvsweb/xc/programs/Xserver/mi/mipolycon.c?rev=HEAD](http://cvsweb.xfree86.org/cvsweb/xc/programs/Xserver/mi/mipolycon.c?rev=HEAD)

第二个版本忽略了填充规则（不适用于凸多边形）。关于算法的评论：[http ://cvsweb.xfree86.org/cvsweb/xc/programs/Xserver/mi/mipoly.h?rev=HEAD](http://cvsweb.xfree86.org/cvsweb/xc/programs/Xserver/mi/mipoly.h?rev=HEAD)

The algorithm works this way: It calculates the outline, then creates span objects (which are just a x,y coordinate and a width) between the edges. If you use the EvenOdd rule, more span objects will be created if there are intersections. If there are none (for example, when the polygon is convex), then you will not notice a runtime difference because the filling rule amounts to a boolean variable in the main loop of the miFillPolygon (i.e. most of the code is the same for both fill rules).

Trying to improve performance by optimizing the outline of the polygon will not buy you much in the common case except if you know that your polygons contain a very high number of unnecessary points (say, you can get rid of half the number of points in the common case). Optimizing a polygon with < 10 points will probably cost more than it achieves.

But again: This are all based on gut feeling or the knowledge of an old article. If you want to know if bugs in your gfx card driver mess with the result, you have to get your hands dirty and write a test which measures how long each case takes. There is no way to tell the runtime of any complex algorithm by simply looking at it because of external factors: Speed of the memory allocation routines, amount of free memory (when does swapping start), number of CPU cores you can use, how many other processes will fight you for the CPU, clipping of the final polygon on the screen, implementation details and optimizations, bugs, etc.

# logic - 您将如何在 Verilog 或 VHDL 中实现这种数字逻辑？

> ID：486471
> 
> 赞同：1
> 
> 时间：2009-01-28T04:25:04.000
> 
> 标签：logic, hardware, vhdl, verilog

我发布了[另一个 stackoverflow 问题的](https://stackoverflow.com/questions/480405/finding-the-next-in-round-robin-scheduling-by-bit-twiddling)[答案](https://stackoverflow.com/questions/480405/finding-the-next-in-round-robin-scheduling-by-bit-twiddling#486480)，该问题需要在 Verilog 或 VHDL 中实现一些数字逻辑，以便可以将其编程到 FPGA 中。

**您将如何用 Verilog、VHDL 或任何其他硬件描述语言实现以下逻辑图？**

编号的框表示字段中的位。每个字段都有*K*位，*电流*和*掩码*的位将由计算机系统提供（使用锁存寄存器或等效物）。*接下来*的位将被读回同一计算机系统。

[替代文字 http://img145.imageshack.us/img145/5125/bitshifterlogicdiagramkn7.jpg](http://img145.imageshack.us/img145/5125/bitshifterlogicdiagramkn7.jpg)

另请参阅：[this stackoverflow question](https://stackoverflow.com/questions/486473/how-would-you-handle-a-special-case-in-this-digital-logic-system)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T18:56:26.317

像这样的东西？

```
module scheduler
 #( parameter K = 10 )
  (
   input wire [K:1] current,
   input wire [K:1] mask,
   output reg [K:1] next
   );

   reg [K:1] a;
   reg [K:1] b;

   //'[i+1]' busses that wrap.
   // eg, for a 4-bit bus...
   // a[i]:        a[4],a[3],a[2],a[1] (obviously...)
   // a_wrap[i]:   a[1],a[4],a[3],a[2] 
   wire [K:1] mask_wrap    = { mask[1],mask[K:2] };
   wire [K:1] a_wrap       = { a[1], a[K:2] };
   wire [K:1] current_wrap = { current[1], current[K:2] };

   integer i;
   always @( * ) begin
      for( i=1; i<=K; i=i+1 ) begin
         a[i] = ~current_wrap[i] && b[i];
         b[i] = a_wrap[i] || mask_wrap[i];
         next[i] = ~a[i] && mask_wrap[i];
      end
   end

endmodule 
```

（免责声明：棉绒但不是模拟的）

# hardware - 您将如何处理此数字逻辑系统中的特殊情况？

> ID：486473
> 
> 赞同：2
> 
> 时间：2009-01-28T04:25:38.650
> 
> 标签：hardware, boolean-logic, digital-logic

我发布了这个数字逻辑图作为[另一个 stackoverflow 问题](https://stackoverflow.com/questions/480405/finding-the-next-in-round-robin-scheduling-by-bit-twiddling)的[答案](https://stackoverflow.com/questions/480405/finding-the-next-in-round-robin-scheduling-by-bit-twiddling#486480)。它描述了一个逻辑系统，该系统将以 Verilog 或 VHDL 编码并最终在 FPGA 中实现。

[替代文字 http://img145.imageshack.us/img145/5125/bitshifterlogicdiagramkn7.jpg](http://img145.imageshack.us/img145/5125/bitshifterlogicdiagramkn7.jpg)

图中的编号框表示字段中的位。每个字段都有*K*位，*电流*和*掩码*的位将由计算机系统提供（使用锁存寄存器或等效物）。*接下来*的位将被读回同一计算机系统。

只要*掩码字段中至少设置了一位，并且**当前*位字段中恰好设置了一位，我发布的解决方案就可以工作。这个想法是，在计算机系统执行了某些任务（调度操作，在原始问题中）之后，*下一个*位域将成为*当前位域。*

所以，我的问题是： 你将如何修改这个系统，以便它正确处理***当前*****位字段全为零（未设置位）****的特殊情况？****就目前而言，如果current*中的所有位都为零，则输出也将为零，无论*掩码*中的位设置为什么。*

 *理想情况下，如果*当前全为零，则**掩码*中的最低设置位应设置在*next*中。该系统还应保持可扩展至任意数量的位 (K)，而无需添加成倍增加的逻辑门。最初问题的精神是想出一个可以直接实现任意位数的解决方案。

另请参阅：[this stackoverflow question](https://stackoverflow.com/questions/486471/how-would-you-implement-this-digital-logic-in-verilog-or-vhdl)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T06:10:27.517

对我来说，我会告诉 FPGA 的用户，他们必须在输入时将其中一个位设置为 1。

但是，如果这不是您的首选解决方案，那么最初将所有 Current 输入预先馈送到一个大 NOR 门的想法有什么问题（这样只有当所有输入都为假时输出才为真）。除了 Current[1] 在进入它的 AND 门之前与我们的 NOR 门的输出进行 OR'ed 之外，所有 Current 线也继续通过它们的 AND 门

那样的话，如果所有 Currents 都是假的，那么 Current[1] 将是真的进入 AND 门。

请记住，我了解布尔代数，但我从未在原始硬件上工作过——我猜你需要将所有输入信号缓冲到与门中以确保正确的时序，但我怀疑你会比一世。

保留下图以防 SO 修复其代码/预块 - 最新的 SO 更新似乎已将它们塞满（使它们成比例，而不是固定宽度的字体）。无论如何，eJames的图形图更好。

这是我的图表，比你的稍微不优雅:-)：

```
 `+-------------------+
               |                   |
               |     +----         |
Current[1]-----+------\   \        |
                       |NOR|o--+   |
Current[2-k]---+------/   /    |   |
               |     +----     |   |
               |              +\   /+
               |              | \_/ |
             +---+            |  OR |
              \ /Buffer        \   /
               +                ---
               |                 |
             +---+             +---+
             |2-k|             | 1 |    <- These signals feed 
             +---+             +---+       into your AND gates.` 
```

# `python - Python搁置模块问题`

 `> ID：486490
> 
> 赞同：7
> 
> 时间：2009-01-28T04:32:14.097
> 
> 标签：python, shelve

Python shelve 模块是否有任何内置保护措施来确保两个进程不会同时写入文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T06:38:26.510

shelve模块使用底层数据库包（例如 dbm、[gdbm](http://docs.python.org/library/gdbm.html#module-gdbm)或 bsddb）。

[*限制*段落](http://docs.python.org/library/shelve.html#restrictions)说（我的重点）：

> 搁置模块**不支持对搁置对象的并发读/写访问**。（多个同时读取访问是安全的。）当一个程序有一个架子可供写入时，任何其他程序都不应该打开它来读取或写入。可以使用 Unix 文件锁定来解决这个问题，但这在 Unix 版本之间有所不同，并且需要了解所使用的数据库实现。

结论：它取决于操作系统和底层数据库。为了保持可移植性，不要建立在并发之上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-27T11:31:56.997

根据最佳答案，将多个作家搁置是不安全的。我让货架更安全的方法是编写一个包装器，负责打开和访问货架元素。包装器代码如下所示：

```
def open(self, mode=READONLY):
    if mode is READWRITE:
        lockfilemode = "a" 
        lockmode = LOCK_EX
        shelve_mode = 'c'
    else:
        lockfilemode = "r"
        lockmode = LOCK_SH
        shelve_mode = 'r'
    self.lockfd = open(shelvefile+".lck", lockfilemode)
    fcntl.flock(self.lockfd.fileno(), lockmode | LOCK_NB)
    self.shelve = shelve.open(shelvefile, flag=shelve_mode, protocol=pickle.HIGHEST_PROTOCOL))
def close(self):
    self.shelve.close()
    fcntl.flock(self.lockfd.fileno(), LOCK_UN)
    lockfd.close() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-15T15:42:54.513

对于任何感兴趣的人，我已经将[Ivo 的方法](https://stackoverflow.com/questions/486490/python-shelve-module-question/7915260#7915260)实现为上下文管理器：

```
from contextlib import contextmanager, closing
from fcntl import flock, LOCK_SH, LOCK_EX, LOCK_UN
import shelve

@contextmanager
def locking(lock_path, lock_mode):
    with open(lock_path, 'w') as lock:
        flock(lock.fileno(), lock_mode) # block until lock is acquired
        try:
            yield
        finally:
            flock(lock.fileno(), LOCK_UN) # release

class DBManager(object):
    def __init__(self, db_path):
        self.db_path = db_path

    def read(self):
        with locking("%s.lock" % self.db_path, LOCK_SH):
            with closing(shelve.open(self.db_path, "c", 2)) as db:
                return dict(db)

    def cas(self, old_db, new_db):
        with locking("%s.lock" % self.db_path, LOCK_EX):
            with closing(shelve.open(self.db_path, "c", 2)) as db:
                if old_db != dict(db):
                    return False
                db.clear()
                db.update(new_db)
                return True 
```

# java - 当文件确实存在时抛出 FileNotFoundException

> ID：486494
> 
> 赞同：3
> 
> 时间：2009-01-28T04:37:15.600
> 
> 标签：java, jvm, io, filenotfoundexception, smb

我正面临这个奇怪的问题。

我正在尝试将位于另一台机器中的文件作为共享资源读取：

```
\\remote-machine\dir\MyFileHere.txt 
```

当我运行一个独立的应用程序（一个 16 行的 java 文件）时，一切都很好。但是，当我尝试从服务器“引擎”（这是一个应用程序引擎，非常类似于可以运行 Java 程序的 Java EE 应用程序服务器）使用相同的类和相同的方法读取相同的文件时，“FileNotFoundException”被抛出。

我虽然我会获得某种权限，所以我将资源映射为驱动器：K:\

重新运行我的java文件，读取，很好。

在“引擎”-> FileNotFoundException 中重新运行我的 java 文件。

当我将文件复制到本地机器（ C:\MyFileHere.txt ）时，不会引发异常。

**问题**

什么可能导致此 FileNotFoundExcecption？

我正在使用 Java 1.5

据我所知，引擎几乎透明地使用了 java。

有人遇到过类似的事情吗？

附加问题？解决此问题的好方法是什么？我开始考虑为这些文件提供服务并通过http读取它们的tomcat安装，但我认为这太过分了，这就是为什么首先使用SMB协议不是吗？而且可能我无论如何都无法打开套接字。

安全管理器是否可能是原因（我以前从未使用过，但我知道它存在）

如果是这种情况，是否会抛出 SecurityException ？

非常感谢。

**编辑**

解决了。谢谢史蒂夫·W。

事实证明，这个引擎是用 ZeroG 的“LaunchAnywhere”启动的。因此，将创建一个 .exe，然后将运行具有指定应用程序的 JVM。

这个应用程序本身就是 Launcher。当它启动引擎时，以某种方式（我不知道为什么或如何）拥有 JVM 进程的用户是 SYSTEM。正如史蒂夫指出的那样，该用户没有网络访问权限，因此无法从共享资源或映射驱动器中读取。

解决方法（当我向制造商报告时）是创建一个 .cmd 文件来手动启动引擎。由于它将手动启动，因此用户确实可以访问网络。

我使用 SysInternals 的“Process Explorer”来准确了解用于运行引擎应用程序的命令行。

真是一团糟！

感谢那些发布答案的人。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T04:43:52.653

共享资源是否受用户名和密码保护？如果是这样，您的应用程序引擎是否以该用户身份运行？如果您的应用程序引擎作为 Windows 服务运行，则 Windows 服务不能作为“本地系统帐户”运行。此帐户无法访问网络。您必须将服务配置为以有权访问共享驱动器的用户身份运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T05:03:09.587

仔细检查文件是否真的被称为“MyFileHere.txt”而不是“MyFileHere.txt.txt”如果您隐藏文件的扩展名，这是一个容易错过的错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T06:28:06.577

您是否检查了服务器上的事件日志以查看它是否被拒绝？可能是程序在与您想象的不同的用户帐户下运行。

我不熟悉Java，但我知道我编写的一些程序必须允许网络服务访问资源。

实际上，我看到您现在已将答案标记为正确答案。哦，这和我的回答一样 :) 酷！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T06:38:44.730

我曾经遇到过类似的问题。我认为这与java解析远程文件URI的方式有关。尝试以下方法，看看它是否有效：

File:////remote-machine/dir/MyFileHere.txt

我使用以下示例来验证我的盒子中共享文件夹中是否存在文件并工作：

```
public static void main(String[] args) throws URISyntaxException{
    URI uri = new URI(args[0]); //args[0] = File:////remote-machine/dir/MyFileHere.txt
    File f = new File(uri);
    System.out.print(String.format("File %1$s Exists? %2$s", args[0],f.exists()));
} 
```

# html - CSS 样式菜单标记的最佳实践是什么？

> ID：486499
> 
> 赞同：5
> 
> 时间：2009-01-28T04:41:24.483
> 
> 标签：html, css, menu

所以，我已经“收集”CSS 菜单有一段时间了（另一个术语是“借用”，另一个是“公然抄袭”），向他们学习并可能重用我自己的一些轻率项目。

作为一个老式的 HTML 纯粹主义者，我喜欢 styled `<ul>`s 和`<ol>`s 的想法，更好的菜单和选项卡界面倾向于使用这种方法，出于可访问性或语义健全性或任何原因。我主要喜欢这种方法，因为它使我的 HTML 源代码保持整洁。

现在，我实际上重构了我的 CSS 菜单集合以适应一种“主”标记模式，我从最灵活的示例中推断出来，例如 CSS Zen Garden。它看起来像这样：

```
<div class="menustyle">
<ul>
    <li class="current"><a href="#" title="Page 1"><span>Home</span></a></li>
    <li><a href="#" title="Page 2"><span>Toys</span></a></li>
    <li><a href="#" title="Page 3"><span>About Us</span></a></li>
    <li><a href="#" title="Page 4"><span>Contact</span></a></li>
</ul>
</div>

<span class="clearit" /><br /> 
```

（末尾的“clearit”跨度用于`clear:both`在需要它的菜单之后设置）

无论如何，我已经在许多网站上看到了这个标记的变体，一些带有额外的封闭`<div>`，一些使用不同的词 than `current`，一些将`current`类附加到`<a>`标签而不是`<li>`，还有一些省略了内部`<span>`。每个人似乎都有自己的方式来做菜单标记，只是有点不同。

无论如何，在修改了*很多*菜单之后，以上是我想出的，但我试图弄清楚是否有一个实际建立的最佳实践。我想在某个时候建立一个简单的 CSS 菜单铸造厂，在继续之前获得一些关于标记的输入会很好。

**编辑：**问题**不**在于 Javascript 菜单。我*知道*那里有出色的脚本菜单，它们允许您拥有子菜单、更高级的动画和悬停时间、快捷键、阴影和其他一切。但是 90% 的菜单*不需要这些功能*，使用 CSS 来设置样式和悬停效果会更好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T04:45:09.157

除了去掉跨度标签，我认为它很好。

没有理由让它们因为您的设置您可以根据需要设置文本样式

```
li a {/*styles*/} 
```

您还应该能够删除

```
<span class="clearit" /><br /> 
```

节也是如此。如果您试图仅将 ul 浮动在 div 内，则不妨废弃 div。如果您出于其他原因需要清除，您可以执行

```
<br clear="all"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T20:20:36.863

您可以使用`clearfix`UL 类（而不是清算跨度）：

```
.clearfix:after {content:".";display:block;height:0;clear:both;visibility:hidden}
.clearfix {display:inline-block}
/* Hide from IE Mac \*/
.clearfix {display:block}
/* End hide from IE Mac */
* html .clearfix {height:1px} 
```

现在，您的菜单将如下所示：

```
<div class="menustyle">
<ul class="clearfix">
..... 
```

当然，您可以将这些属性直接添加到 UL 以避免任何 html 代码的更改 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T05:03:58.930

CSS 菜单在 2005 年很麻烦。所有的跨浏览器兼容性、IE javascript 修复文件等等。专门回答您的问题：它们今天与三年前没有什么不同，因为 IE7 不支持 :hover on non-links 并且仍然需要支持 IE6。

这些天只需下载 jQuery，安装[Superfish](http://users.tpg.com.au/j_birch/plugins/superfish/)插件并包含以下代码：

```
$(function() {
  $("ul.menu").superfish();
}); 
```

并做了。甚至适用于 IE6（功能较少）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T09:57:19.243

如果您对子菜单感兴趣，那么我建议您查看 YUI 库。它为您提供了一个跨浏览器兼容的标记子菜单。

[http://developer.yahoo.com/yui/examples/menu/index.html](http://developer.yahoo.com/yui/examples/menu/index.html)

# visual-studio-2005 - 预览 SSRS 报告时出现“rsInvalidImageReference”警告

> ID：486503
> 
> 赞同：1
> 
> 时间：2009-01-28T04:42:50.547
> 
> 标签：visual-studio-2005, reporting-services, report

在 SSRS 报告中：

我使用表达式指定页脚的背景图像，以便第一页上的图像与其他页面不同。

图像存储为项目的一部分，并且显示正确，但是我收到此警告

```
Build complete -- 0 errors, 0 warnings

[rsInvalidImageReference] The Value for the page ‘footer’ is invalid. 

Details: Invalid URI: The format of the URI could not be determined.

Preview complete -- 0 errors, 1 warnings 
```

任何人都知道是什么导致了这个警告，我应该如何摆脱它？

**编辑：是否可以这样做，并避免使用绝对路径？**我需要在项目中使用相对路径，因为我无法控制将其推广到哪里。

* * *

我用来为 Footer/BackgroundImage/Value 属性选择图像的表达式是：

```
= IIf(Globals!PageNumber.Equals(1), "image1.png", "image2.png") 
```

此外，我尝试将 BackgroundImage Source 和 MIMEType 设置为 external 和 image/png，它似乎没有什么区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T04:52:32.963

使其成为绝对 URL 而不是相对 URL。例如，而不是 image2.png 返回[http://myhost.com/image2.png](http://myhost.com/image2.png)或 file://C:/test/myimage.png

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T12:53:03.570

我使用嵌入式图像并在某些地方使用表达式来确定它们如何显示并且从未遇到过问题。

*   **您是否通过Report > Embedded Images > New Image**将图像添加到报告中？
*   然后当您将**图像控件**添加到报表时，选择**Embedded Image** ?

# c++ - 模板参数阴影在 VS2005 中是如何工作的？

> ID：486508
> 
> 赞同：4
> 
> 时间：2009-01-28T04:44:45.520
> 
> 标签：c++, templates, gcc, visual-studio-2005

在 GCC 中，这段代码不会编译，因为 T 被遮住了，但是在 VS2005 中它编译时没有警告，那么 VS 编译器所做的假设是什么？

```
template<typename T>
class Foo
{
    template<typename T>
    void Bar(const T& bar)
    {
      ...
    }
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T05:52:59.097

经过 3 个月的搜索，找到了正确的答案 :) 它`14.6.1/4`符合标准：

> 不应在其范围内重新声明模板参数（包括嵌套范围）。模板参数的名称不得与模板名称相同。
> 
> 例子：
> 
> ```
> template<class T, int i> class Y {
>     int T;
>     // error: template-parameter redeclared
>     void f() {
>         char T;
>         // error: template-parameter redeclared
>     }
> };
> 
> template<class X> class X; // error: template-parameter redeclared 
> ```

如果 Microsoft 编译器让它编译时没有错误甚至警告，则它不符合要求。我不知道是什么驱使它允许它不呻吟。您可以尝试高警告级别。

# http - 错误代码：502 代理错误。ISA 服务器拒绝了指定的统一资源定位符 (URL)。(12202)

> ID：486517
> 
> 赞同：0
> 
> 时间：2009-01-28T04:49:07.587
> 
> 标签：http, proxy, isaserver

在访问文档时，我在某些机器上遇到了错误，但在某些机器上却没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-10-27T08:07:13.303

打开`ISA server2006`并创建角色并允许网络内部允许内部和外部。

重新启动isa服务，它会正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T06:02:15.333

您问题中的更多信息可能会有所帮助，但在快速谷歌之后，我发现[这个论坛](http://forums.isaserver.org/fb.aspx?m=2002054360)可能会回答您的问题（似乎有一个可能有帮助的修补程序）。

# c# - 我应该使用最小起订量来测试是否调用了方法吗？

> ID：486526
> 
> 赞同：0
> 
> 时间：2009-01-28T04:57:27.523
> 
> 标签：c#, .net, unit-testing, tdd, mocking

我有一些看起来像这样的测试代码：

```
[Test]
public void RunTableInfoCommandShouldCallTableINfoWithName()
{
   string expectedcommand = "TableInfo(TestTable,1)";

   Table.RunTableInfoCommand(mockmapinfo.Object,
                            "TestTable",
                             TableInfoEnum.TAB_INFO_NAME); //This is just an enum for 1.

   mockmapinfo.Verify(m => m.Evaluate(expectedcommand));
 } 
```

我是否应该使用模拟对象创建测试只是为了查看模拟使用的预期命令是否在 RunTableInfoCommand 中调用

或者我应该只是有一个测试来检查 RunTableInfoCommand 的输出并在那里使用模拟，因为这将测试是否也进行了调用。

RunTableInfoCommand 返回一个字符串，如您所见，我在这里没有使用它，因为我只想看看是否调用了 TableInfo 命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T14:11:06.713

我认为你不应该测试你正在调用的函数是否被调用。你应该假设它会。

您可能最好做的是测试行为。例如，设置一个测试，该测试具有调用 RunTableInfoCommand 作为其预期行为的一部分的函数。

然后检查结果是否符合您的预期。

例如

```
[Test]
public void GetTableName()
{   
    string expectedName = "TableInfo(TestTable,1)"; 
    Assert.AreEqual(testTable.GetTableName(mockmapinfo.Object) = expectedName); 
} 
```

在此示例中，GetTableName 实际上是调用 RunTableInfoCommand 的函数。因此，您正在测试对象的接口或行为。

希望这可以帮助。

# c# - 设计的 XAML 无法加载，因为无法创建自定义对象

> ID：486529
> 
> 赞同：1
> 
> 时间：2009-01-28T04:59:51.620
> 
> 标签：c#, xaml

我有一个在我的应用程序中使用的 XAML 表单，并且我已经将 Frame 类子类化以创建我自己的类，并编辑了接口以指定我自己的内容类（因为我需要访问内容的属性以进行数据绑定）。

然后问题出现在设计器中，编译器说它无法创建我的控件的实例 - 我试图对有问题的属性位进行一些设计器检查，但这也不起作用。

如何让控件显示？在运行时工作正常...

XAML：

```
<Grid Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2">
 <views:PageFrame Name="Content_MainPage" Frame.NavigationUIVisibility="Hidden"/>                    
</Grid> 
```

CS：

```
 public new BaseView Content 
    {
        get
        {
            if (DesignerProperties.GetIsInDesignMode(this))
            {
                return new BaseView();
            }
            else
            {
                return (BaseView)base.Content;
            }
        }
        set
        {
            if (DesignerProperties.GetIsInDesignMode(this))
            {
                base.Content = new BaseView();
                FrameTitle = "design mode";
            }
            else
            {
                base.Content = value;
                FrameTitle = value.Title;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T01:48:36.390

我在创建自己的 Panel 类时遇到了类似的问题。

您的 PageFrame 类是否定义在 XAML 所在的同一程序集中？

我发现我可以让它工作的唯一方法是将我的“PageFrame”类移动到一个新的程序集中。从记忆中我认为我什至必须提前构建该程序集，以便可以通过文件引用（而不是项目引用）来引用该程序集。

我讨厌这个解决方案，所以我希望你能找到一个更干净的解决方案:)

你有没有安装VS2008 SP1？我曾希望 MS 能修复这个错误。我还没有尝试删除我的解决方法来检查...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T01:58:28.507

它在同一个程序集中——是的，我也安装了 VS2008 SP1。从 vs 的角度来看，删除上述属性并不是说它可以正常工作，但从我的角度来看显然不是！

我会试一试 - 谢谢安东尼。

# php - 如何在 Magento 中制作“标签”页面 SEO？

> ID：486538
> 
> 赞同：0
> 
> 时间：2009-01-28T05:06:17.177
> 
> 标签：php, content-management-system, url-rewriting, magento, e-commerce

在 magento 中，我启用了 SEO url 重写，它工作正常 - 除了：

*   标签（显示为 site/tag/product/list/tagId/1/）
*   评论（显示为，例如站点/评论/产品/列表/id/1/）
*   RSS 提要（显示为 site/rss/catalog/category/cid/3/sid/1/）

为什么这不是SEO？这个问题的解决方案是什么。我更关心我的标签。请帮忙

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-16T20:42:38.717

查看[http://www.magentocommerce.com/extension/2282/search-engine-friendly-product-tag-urls](http://www.magentocommerce.com/extension/2282/search-engine-friendly-product-tag-urls)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-28T08:06:45.520

据我所知，标签、评论和 RSS 不可能是 SEO。

只有 CMS，目录是 SEo'd 但对于每一个，您都可以在配置中更改它（url 标识符）

您应该打开一个功能请求或编写您自己的类来执行此操作。

我不知道 Magento 的核心代码（仅够用它构建小东西）所以也许我错了。

# asp.net-mvc - ASP.NET MVC RC - 使用代码隐藏创建 MVC 用户控件

> ID：486541
> 
> 赞同：3
> 
> 时间：2009-01-28T05:08:08.483
> 
> 标签：asp.net-mvc, code-behind

试图在候选版本中创建一个 MVC 用户控件，但我看不到使用代码隐藏文件创建一个。MVC 视图页面也是如此。

在 Beta 中创建视图会产生代码隐藏……我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T05:32:47.483

背后的代码有点违背 MVC 框架的目的。功能应该与视图分开，MVC 团队认为页面背后的代码违背了这种意识形态，因此将其删除。

您可以创建自定义帮助方法来创建您的控件。另外我不确定 MVC 是否有视图组件（单轨/城堡），但这也可能是一个选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T05:45:13.840

来自[ScottGu 的博客文章](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)：

*没有代码隐藏文件的视图根据反馈，我们已将视图模板更改为默认情况下没有代码隐藏文件。此更改有助于加强 MVC 应用程序中视图的用途（旨在纯粹用于渲染并且不包含任何非渲染相关代码），并且对于大多数人来说消除了项目中未使用的文件。RC 版本现在添加了 C# 和 VB 语法支持，用于从使用泛型的基类继承视图模板。例如，下面我们将其与 Edit.aspx 视图模板一起使用——其“inherits”属性派生自 ViewPage 类型：

不使用代码隐藏文件的一个好处是，当您将视图模板文件添加到项目中时，您现在可以立即在视图模板文件中获得智能感知。对于以前的构建，您必须在创建视图后立即进行构建/编译，以便在其中获取代码智能感知。RC 使添加和立即编辑视图的工作流程免编译且更加无缝。

重要提示：如果您要升级使用早期版本创建的 ASP.NET MVC 项目，请确保遵循发行说明中的​​步骤 - \Views 目录下的 web.config 文件需要使用一些设置进行更新，以便上述基于泛型的语法可以工作。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T07:08:02.387

[我在这里](https://stackoverflow.com/questions/680448/asp-net-mvc-how-to-add-a-code-behind-page-to-a-partial-view)回答了这个问题：

**如何将代码隐藏页面添加到部分视图**

似乎这并不是特别棘手，而且非常可行这个答案适用于部分“ViewUserControl”，但同样适用

行。

第一：添加一个带有.cs约定的Class文件（即view.ascx.cs）

第二：添加“使用System.Web.Mvc；” 到班级

第三：将类更改为从“ViewUserControl<>”继承

第四：将以下内容添加到视图的标题中：

```
CodeBehind="View.ascx.cs" Inherits="Project.Views.Shared.View" 
```

第五：将文件复制出解决方案并拖回以将两者重新关联在一起

注意：要使用普通 MVC 视图，您只需要从“ViewPage”继承类

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T05:42:57.650

ASP.Net-mvc 的整个想法是摆脱代码隐藏文件......这就是为什么 asp web 控件并不重要，大多数都不起作用。但是随着摆脱代码背后的变化带来了不同的编程风格..这个想法是代码隐藏文件是邪恶的：

[http://stevesmithblog.com/blog/codebehind-files-in-asp-net-mvc-are-evil/](http://stevesmithblog.com/blog/codebehind-files-in-asp-net-mvc-are-evil/)

整个想法是确保人们记住他们使用的是 asp.Net-mvc 而不是 asp.et 网页。看看这个链接，它解释得更好一点：

[http://blog.lozanotek.com/archive/2008/10/20/Visual_Studio_Templates_for_MVC_Views_without_Codebehind_Files.aspx](http://blog.lozanotek.com/archive/2008/10/20/Visual_Studio_Templates_for_MVC_Views_without_Codebehind_Files.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T05:25:29.057

我认为[本教程](http://msdn.microsoft.com/en-us/magazine/cc337884.aspx)就是您要问的..但不确定您想要什么..

# asp.net-mvc - ASP MVC.net 中是否存在 ARDatabind 的 LINQ 等效项？

> ID：486551
> 
> 赞同：2
> 
> 时间：2009-01-28T05:21:05.883
> 
> 标签：asp.net-mvc, linq, activerecord, castle-monorail

是否有任何属性可以放在一个动作的参数上，该动作告诉 LINQ 加载特定实体，并且只对改变了[活动记录/单轨](http://www.castleproject.org/)的值进行数据绑定（请参阅[ARDataBinding](http://www.castleproject.org/monorail/documentation/v1rc2/integration/ar.html)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T05:28:17.663

您可以使用 TryUpdateModel 和 UpdateModel 方法使用表单集合中的值更新模型对象，如下所示：

```
public ActionResult Update(int id, FormCollection form)
{
    Item myItem = _ItemRepository.Get(id);

    TryUpdateModel(myItem, "Item", form);

    // Processing
} 
```

那是你追求的那种东西吗？

编辑：注意，如果你有严格的参照完整性，我在使用实体框架时遇到了这个问题。但是有一些方法可以绕过它，只指定更新表单中发布的字段，或者编写自己的模型更新程序。

# c++ - 比较两个不同的枚举时是否有正确的方法来避免警告？

> ID：486555
> 
> 赞同：5
> 
> 时间：2009-01-28T05:23:27.487
> 
> 标签：c++, templates, gcc, enums

当比较来自不同来源的枚举时，例如以下代码中的枚举，GCC 会发出警告。有没有办法在没有 c-style casts 的情况下避免这些警告？

```
struct Enumerator
{
    enum { VALUE = 5 };
};

template<int V>
struct TemplatedEnumerator
{
    enum { VALUE = V };
};

if(Enumerator::VALUE == TemplatedEnumerator<5>::VALUE)
{
  ...
} 
```

GCC 会发出以下类型的警告：

```
GCC: warning: comparison between 'enum ...' and 'enum ...' 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T05:28:11.160

我相信您可以提供自己的比较运算符，但您必须先命名枚举：

```
struct Enumerator
{
    enum Values { VALUE = 5 };
};

template<int V>
struct TemplatedEnumerator
{
    enum Values { VALUE = V };
};

template <int V>
bool operator==(Enumerator::Values lhs, typename TemplatedEnumerator<V>::Values rhs)
{
    return static_cast<int>(lhs) == static_cast<int>(rhs);
}

template <int V>
bool operator==(typename TemplatedEnumerator<V>::Values rhs, Enumerator::Values lhs)
{
    return static_cast<int>(lhs) == static_cast<int>(rhs);
} 
```

有趣的是，Visual Studio 实际上并没有警告比较两种枚举器类型，而是警告`if`语句中的常量值 - 就像你这样做一样：

```
if (true) {...} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T06:07:10.097

如果有 N 个枚举，是否不需要 N * (N - 1) 个比较运算符？这最终可能会很多。

您不能只使用枚举到整数的隐式转换并执行以下操作：

```
bool equals(int lhs, int rhs)
{
  return lhs == rhs;
} 
```

然后你可以在你的代码中这样做：

```
if(equals(Enumerator::VALUE, TemplatedEnumerator<5>::VALUE))
{
  ...
} 
```

此外，您可以查看[enum-int cast: operator 或 function](https://stackoverflow.com/questions/367819/enum-int-casting-operator-or-function)。公认的答案说您不应该使用隐式转换，但是像 equals 这样正确命名的函数应该使代码非常可读和可维护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T09:33:39.930

不要这样做。

存在警告是因为您首先不应该混淆不同的枚举。

对于常量，您可以使用 const 声明。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T05:39:09.670

```
#include <iostream>
using namespace std;

struct Enumerator 
{
  enum {value = 5 };
};

template<int v>
struct TemplatedEnumerator
{ 
  enum {value = v};
};

int main(void)
{
  if (static_cast<int>(Enumerator::value) ==
    static_cast<int>(TemplatedEnumerator<5>::value))
    cout << "Yoh\n";
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T18:49:58.873

在你的情况下简单的答案：不要使用 an `enum`，使用 inline-defined `static const int`：

```
struct Enumerator
{
    static int const VALUE = 5;
};

template<int V>
struct TemplatedEnumerator
{
    static int const VALUE = V;
}; 
```

在这种特殊情况下，这是等效的，过去几年的所有编译器都应该这样对待它（我知道所有主要编译器都这样做）。

另请参阅：[静态 const 成员值与成员枚举：哪种方法更好？为什么？](https://stackoverflow.com/questions/204983#205000)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T09:38:33.837

你错过了明显的答案。不，不要使用 c 风格的演员表。使用 C++ 风格的强制转换：

```
if(static_cast<int>(Enumerator::VALUE) == static_cast<int>(TemplatedEnumerator<5>::VALUE))
{

} 
```

完全安全，完全可以接受。两个枚举不是相同的类型，因此如果您的代码中有任何可疑之处，则不是强制转换，而是尝试比较两种不同的类型。但只要你这样做，演员表将是我首选的方式。是的，您可以定义一个比较运算符，但是强制转换清楚地表明您正在比较两种技术上不相关的类型。

# c++ - Win32 ListView 中的可变高度项

> ID：486562
> 
> 赞同：1
> 
> 时间：2009-01-28T05:26:54.093
> 
> 标签：c++, c, user-interface, winapi

是否可以在 Win32 ListView 中有可变大小（所有者绘制）项目，如果是，如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:22:22.070

您可能可以使用具有 LBS_OWNERDRAWVARIABLE 样式的列表框来支持具有可变高度的项目。然后 Listbox 将为每个项目发送 WM_MEASUREITEM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T07:29:31.443

查看[WM_MEASUREITEM](http://msdn.microsoft.com/en-us/library/bb775925%28VS.85%29.aspx)

# html - 溢出：末尾的隐藏点

> ID：486563
> 
> 赞同：296
> 
> 时间：2009-01-28T05:27:34.123
> 
> 标签：html, css

假设我有一个字符串“**我喜欢大屁股，我不能说谎**”，我用 切割它`overflow:hidden`，所以它显示如下：

> 我喜欢大屁股，但我不能

切断文字。是否可以这样显示：

> 我喜欢大屁股，我不能...

使用 CSS？

* * *

## 回答 #1

> 赞同：418
> 
> 时间：2009-01-28T05:29:32.000

您可以使用[文本溢出：省略号；](https://developer.mozilla.org/en-US/docs/CSS/text-overflow)[根据 caniuse](http://caniuse.com/#feat=text-overflow)的说法，所有主要浏览器都支持它。

这是关于 jsbin[的演示。](http://jsbin.com/eduten/2)

```
.cut-text { 
  text-overflow: ellipsis;
  overflow: hidden; 
  width: 160px; 
  height: 1.2em; 
  white-space: nowrap;
}
```

```
<div class="cut-text">
I like big butts and I can not lie.
</div>
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2015-03-30T12:16:19.480

检查以下代码段以解决您的问题

```
div{
  width : 100px;
  overflow:hidden;
  display:inline-block;
  text-overflow: ellipsis;
  white-space: nowrap;
}
```

```
<div>
    The Alsos Mission was an Allied unit formed to investigate Axis scientific developments, especially nuclear, chemical and biological weapons, as part of the Manhattan Project during World War II. Colonel Boris Pash, a former Manhattan P
</div>
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2018-05-28T06:10:21.243

如果您想将行数限制为最多 3 行，并且在三行之后会出现点，请尝试此操作。如果我们想增加线条，只需更改 -webkit-line-clamp 值并给出 div 大小的宽度。

```
div {
   display: -webkit-box;
   -webkit-line-clamp: 3;
   -webkit-box-orient: vertical;
   overflow: hidden;
   text-overflow: ellipsis;
} 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2019-01-15T12:25:19.687

希望对您有所帮助：

```
.text-with-dots {
    display: block;
    max-width: 98%;
    white-space: nowrap;
    overflow: hidden !important;
    text-overflow: ellipsis;
}
```

```
<div class='text-with-dots'>Some texts here Some texts here Some texts here Some texts here Some texts here Some texts here </div>
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-01-28T05:29:31.373

是的，通过[`text-overflow`](http://www.quirksmode.org/css/textoverflow.html)CSS 3 中的属性。警告：浏览器尚未普遍支持它。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2018-09-06T02:09:58.900

在**[bootstrap 4](https://getbootstrap.com/docs/4.0/utilities/text/#text-wrapping-and-overflow)**中，您可以添加一个`.text-truncate`类来用省略号截断文本。

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

<!-- Inline level -->
<span class="d-inline-block text-truncate" style="max-width: 190px;">
  I like big butts and I cannot lie
</span>
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2019-09-04T10:55:56.473

**在加载时隐藏文本并在悬停时显示**

```
.hide-text {
  width: 70px;
  display: inline-block;
  white-space: nowrap;
  overflow: hidden !important;
  text-overflow: ellipsis;
}

span:hover {
   white-space: unset;
   text-overflow: unset;
}
```

```
<span class="hide-text"> How to hide text by dots and show text on hover</span>
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2019-11-12T06:55:13.267

```
<!DOCTYPE html>
<html>
<head>
<style>
.cardDetaileclips{
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 3; /* after 3 line show ... */
    -webkit-box-orient: vertical;
}
</style>
</head>
<body>
<div style="width:100px;">
  <div class="cardDetaileclips">
    My Name is Manoj and pleasure to help you.
  </div>
</div> 
</body>
</html> 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-04-21T09:24:28.387

```
<style>
    .dots
    {
        display: inline-block;
        width: 325px;
        white-space: nowrap;
        overflow: hidden !important;
        text-overflow: ellipsis;
    }

    .dot
    {
        display: inline-block;
        width: 185px;
        white-space: nowrap;
        overflow: hidden !important;
        text-overflow: ellipsis;
    }
</style> 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-01-15T11:32:50.747

大多数解决方案在这里使用静态宽度。但有时由于某些原因它可能是错误的。

示例：我有很多列的表。它们中的大多数都很窄（静态宽度）。但主列应尽可能宽（取决于屏幕大小）。

HTML：

```
<table style="width: 100%">
  <tr>
    <td style="width: 60px;">narrow</td>
    <td>
      <span class="cutwrap" data-cutwrap="dynamic column can have really long text which can be wrapped on two rows, but we just need not wrapped texts using as much space as possible">
        dynamic column can have really long text which can be wrapped on two rows
        but we just need not wrapped texts using as much space as possible
      </span>
    </td>
  </tr>
</table> 
```

CSS：

```
.cutwrap {
  position: relative;
  overflow: hidden;
  display: block;
  width: 100%;
  height: 18px;
  white-space: normal;
  color: transparent !important;
}
.cutwrap::selection {
  color: transparent !important;
}
.cutwrap:before {
  content: attr(data-cutwrap);
  position: absolute;
  left: 0;
  right: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  color: #333;
}
/* different styles for links */
a.cutwrap:before {
  text-decoration: underline;
  color: #05c;
} 
```

# api - 显式 API 方法与通用的基于参数的 API 方法

> ID：486567
> 
> 赞同：3
> 
> 时间：2009-01-28T05:28:48.350
> 
> 标签：api, usability

在定义客户可访问的 API 时，以下之间的首选行业实践是什么：

**a)**定义一组**显式**API 方法，每个方法都有一个非常狭窄和特定的目的，例如：

```
SetUserName    <name>
SetUserAge     <age>
SetUserAddress <address> 
```

**b)**定义一组更**通用**的基于参数的 API 方法，例如：

```
SetUserAttribute <attribute>

enum attribute {
    name,
    age,
    address
} 
```

**我的意见：**

*赞成（一）*

对于基于布尔值的方法（例如 EnableFoo），我肯定会支持选项 (a)，因为其意图更加清晰，将来需要扩展的可能性较小，并且它使代码更具可读性。

例如，一个名为 EnableDisableFoo 的方法接受一个布尔参数来指示是启用还是禁用，这将不是很清楚，也没有凝聚力的目的。

这是有多种选择的地方，问题变得更加复杂。

*赞成(b)*

选项 (b) 是在 API 中提供可扩展性的好方法，但会牺牲可用性。使用选项 (a)，API 方法名称本身提供了足够的信息来指示它正在做什么。使用选项 (b)，用户必须查找方法名称和要使用的适当枚举/参数。理论上，从可用性的角度来看，这会使选项 (b) 变得更糟——但也许使用较少的方法是一件好事，所以即使这也不完全正确。

*其他想法*

有必要在可用性和可扩展性之间取得良好的平衡，而且它们之间经常存在矛盾。但我想有一种更客观的方法来分析这一点，而不是依赖 API 设计者的意见。

有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T05:42:15.530

我个人赞成（a），因为我们的目标是使“静态”代码尽可能准确和可靠。

通过使用广义形式，我们引入了运行时错误的风险。例如，我可以设置一个年龄类型的属性，其值实际上是一个字符串，等等。

这与定义和使用枚举或显式类型而不是在旧 C 风格中使用和返回 int 的论点非常相似，因为您可以获得更高级别的保证。

虽然我同意 (b) 允许可扩展性，但我还没有看到太多 API 需要对完全不同类型的属性进行这种可扩展性。(b) 的唯一常见用途是在多态代码中，该函数在技术上可以接受任何东西，包括扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T05:47:07.830

另一个考虑因素是您是否要设置所有属性并同时设置它们。例如，当您想向打印机发送内容时，可能需要设置几十个参数（横向或纵向；份数；页面大小；分辨率等）。你可以定义一个函数，而不是定义一个需要调用几十次的API，它以a`struct`为参数，其中`struct`包含几十个字段，调用者`struct`在空闲时初始化，然后传递`struct`在单个函数调用中进入 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T06:45:32.377

我认为这取决于您正在编写的代码。如果你写的东西总是在一起的（即，如果你要使用/更改年龄总是与名字一起），那么选择 b，否则 a 很好。

但是不要试图过度做（a），因为那样你只会写更多的行并且完成的工作会少很多。好主意，如果你为你写的代码量付费:)

# html - 可滚动div内的冻结表头

> ID：486576
> 
> 赞同：8
> 
> 时间：2009-01-28T05:37:01.047
> 
> 标签：html, asp.net, scroll, html-table

我有三个div。页眉、中心和页脚。中央 div (gridview) 中有一个表格，它几乎总是比外部 div 长。所以我让这个 div 可以垂直滚动。问题是：如何使表格标题在 div 向下滚动后可见？我本可以使用单独的 div 或表格完成此标题并使其固定，但表格中列的宽度并不总是相同 - 所以我不知道如何保持标题中列的宽度。有什么线索吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-10-07T19:19:17.477

我刚刚组装了一个 jQuery 插件，它完全可以满足您的需求。它的体积非常小，而且很容易实现。

所需要的只是一个具有thead 和tbody 的表。

您可以将该表包装在具有类名的 DIV 中，并且该表将始终调整大小以适合该 div。因此，例如，如果您的 div 与浏览器窗口一起缩放，那么表格也会随之缩放。滚动时标题将被固定。页脚将被固定（如果您启用页脚）。您还可以选择在页脚中克隆页眉并将其修复。此外，如果您的浏览器窗口太小并且无法容纳所有列...它也会水平滚动（标题也是）。

您只需将 DIV 的类名传递给插件，如下所示： $('.myDiv').fixedHeaderTable({footer: true, footerId: 'myFooterId'}); 插件将完成剩下的工作。FooterID 是页面上包含页脚标记的元素。如果您想将分页作为页脚，则使用此选项。

如果页面上有多个表格，它也适用于您希望拥有固定标题的每个表格。

在这里查看：http: [//fixedheadertable.mmalek.com/](http://fixedheadertable.mmalek.com/)

请记住它仍然是“测试版”，所以我每天都在添加新功能和错误修复。

支持的浏览器：IE6、IE7、IE8、FireFox、Safari、Chrome

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-01-07T23:39:16.783

解决方案真的很简单。您需要 3 个 DIV：一个通用容器（在我的“外部”类的情况下）、一个表容器（在我的“内部”类的情况下）和一个 DIV，您可以在其中使用 jQuery 或 javaScript 克隆现有表（在我的类“标题”的情况下）。

解决方案使用CSS和几行jQuery代码，将“inner”的HTML克隆为“header”并设置其宽度和高度。支持固定和可变列宽。通过 IE8、Firefox 9、Safari 和 Google Chrome 测试。

这是一个示例代码：

```
 $(document).ready(function() {
    		$('.header').html( $('.inner').html() );
    		$('.header').css('width', $('.inner table').outerWidth() );
    		$('.header').css('height', $('.inner table thead').outerHeight() );
    	});
```

```
table {
  width:100%;
}
th {
  border-top:1px solid #999;
  text-align:left;
}
td, th {
  border-bottom:1px solid #999;
  background-color:#EEE;
}
.outer {
  position:relative;
  width:500px;
}
.inner {
  height:150px;
  overflow:auto;
}
.header {
  position:absolute;
  top:0;
  left:0;
  overflow:hidden;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<body>
<div class="outer">
  <div class="inner">
    <table cellspacing="0" cellpadding="0">
      <thead>
        <tr>
          <th>a</th>
          <th>b</th>
          <th>c</th>
          <th>d</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>1</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>2</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>3</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>4</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>5</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>6</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>7</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>8</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>9</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>10</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>11</td><td>b</td><td>c</td><td>d</td></tr>
        <tr><td>12</td><td>b</td><td>c</td><td>d</td></tr>
      </tbody>
    </table>
  </div>

  <div class="header">
  </div>

</div>
</body>
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-31T05:10:31.093

这是使用javascript的基本解决方案：

```
function position(table) {
    table.rows[0].style.position="absolute";
    table.rows[0].style.top="0px";
    table.style.marginTop = table.rows[0].clientHeight/1.2;
    var widths = Array();
    for(var i = 0; i < table.rows[0].cells.length; i++) {
        widths[i] = max(table.rows[0].cells[i].clientWidth, table.rows[1].cells[i].clientWidth);
    }
    for(var row = 0; row < table.rows.length; row++) {
        for(var col = 0; col < widths.length; col ++) {
            table.rows[row].cells[col].style.width = widths[col] + "px";
        }
    }
}

function max(num1, num2) { return (num1 > num2) ? num1 : num2; } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T05:39:47.377

您必须将标题放在可滚动的 div 之外。div 中的所有内容都会滚动。

**编辑**

关于宽度，如果您选择单独的标题，我可以看到一些解决方案：

*   假设这是动态内容，则根据字符串的长度生成“固定”宽度。显然要根据 EM 指定，并留出一定的误差余地。
*   使用 JavaScript。
*   使用固定宽度的列。

我实际上并没有尝试过第一个，它可能有点过于复杂了。如果您迫切需要这种效果，可以尝试一下。

我还应该提到，可能已经有带有表格小部件的 javascript 库可以做到这一点。看看他们，看看他们是如何做到的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T05:59:53.513

您需要放置一个表，其中包含有关数据表的标题。您可以使用 table-layout:fixed 来保持列宽。JavaScript 可用于匹配列宽。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-31T12:47:27.910

这是一个很好的解决方案（主要是 CSS），它使用固定宽度的列：[http ://www.imaputz.com/cssStuff/bulletVersion.html](http://www.imaputz.com/cssStuff/bulletVersion.html)

当单元格内容的宽度大于固定宽度时，这里有一些 jQuery 代码来修复单元格宽度：

```
<script
  src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"
  type="text/javascript"></script>
<script>
$(function() {
  $('div.tableContainer').each(function() { // for each table
    var div = $(this);
    var widths = [];
    var changed = false;
    $('table>*>tr', div).each(function(tr_i) {
      $(this).children().each(function(i) {
        var w = $(this).width();
        if (w > widths[i]) {
            widths[i] = w;
            changed = true;
        }
      });
    }).each(function(tr_i) {
      if (changed)
      $(this).children().each(function(i) {
        var width = widths[i];
        // add some width for scrollbar
        if (tr_i == 0 && changed && i == widths.length-1) width += 16;
        // insert a div to ensure width
        $(this).append('<div style="width:'+width+'px; height:0px">&nbsp;</div>');
      });
    });
    div.width(div.children('table').width()).css('overflow-x', 'hidden');
  });
});
</script> 
```

使用非严格 DTD 时，IE 中的输出有点偏离。如果您不能使用标准模式，请调整 CSS 中的宽度。

请注意，jQuery 代码在末尾增加了表格宽度，并禁用了水平滚动条。你可能想要也可能不想要。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-04T11:07:59.403

你可以试试 jQuery 插件[Stupid Fixed Header](http://jackysee.googlepages.com/fixedheaders.html)。该技术基本相同：克隆一个标题并将其放在表格层的顶部。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-04T12:17:50.027

您真正想要做的是使`<tbody>`数据表可滚动，因此`<thead>`and`<tfoot>`将保持自然固定。

虽然这对 FF 等人来说是微不足道的：

```
tbody
{
    height: 100px; /* or whatever */
    overflow: auto;
    overflow-y: auto;
    overflow-x: hidden;
} 
```

IE 通常与 tbody 存在*严重*而复杂的问题。它可以用表达式来解决，但它不是微不足道的，并且是特定于设计的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-28T06:02:28.953

我没有对此进行测试，但也许您可以生成两次表格，一次在标题中，一次在滚动 div 中。然后在标题中，使除标题行以外的所有行不可见。也许使用“显示：无”或将它们的高度设置为零。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-04T11:37:20.657

如果您正在寻找全面的跨浏览器实现，请查看 YUI 数据表。我相信这是通过创建另一个具有匹配列宽的表来完成的。

似乎需要一些技巧来修复列宽。如果我没记错的话，Firefox 需要存在 <col/> 标签。

无论如何，YUI 数据表（50k 行）中使用了许多技巧。建议您查看它并决定您想自己走多远。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-04T11:49:03.767

该解决方案在 Firefox 和其他 Gecko 浏览器中使用 CSS，在 IE 中使用 CSS 表达式。

[http://home.tampabay.rr.com/bmerkey/examples/nonscroll-table-header.html](http://home.tampabay.rr.com/bmerkey/examples/nonscroll-table-header.html)

页眉和页脚不会在 Opera 或 Safari/Chrome 中保持固定，但整个表格是可滚动的，因此它是可用的。请注意，在作者的示例中，列被赋予了百分比宽度，但它们可以被删除。

如果您想尝试 Opera/Safari/Chrome 支持，请查看 tbody display:block 并从那里开始。

# c++ - 动态多态性和动态内存分配

> ID：486581
> 
> 赞同：2
> 
> 时间：2009-01-28T05:41:57.730
> 
> 标签：c++

是否总是需要从堆中分配内存以促进动态多态性？到目前为止，我遇到的所有示例都指向相同。在实时编程中通常会避免动态内存分配。那么，使用堆栈进行动态多态性有什么缺点，如下面的代码所示。

```
class Base
{
    public:
        virtual void Display()= 0;
};

class Derived:public Base
{
    public:
        void Display()
        {
            cout << "In derived" << endl;
        }
};

int main()
{
    Base*   base;
    Derived derived1;

    base = &derived1;
    base->Foo();       
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T05:47:52.477

一个更好的例子是：

```
void func(Base &base);

int main()
{
    Derived derived;

    func(derived);

    return 0;
} 
```

多态性的使用不必在堆栈上创建对象的位置附近。

这些天我们的很多单元测试代码看起来大致如下：

```
void test()
{
    MockObject mockObj;
    RealObject objectToBeTested(mockObj);

    // Do tests
} 
```

这与多态密切相关，但会在堆栈上创建对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T07:24:39.020

正如您在问题中指出的那样，如果您想使用多态性，则不必使用*堆*。但你往往别无选择。人为的小例子：

```
void doSomething(int what) {
    // figure out which implementation to create
    Base * b;
    if(doA) {
        b = new ConcreteA; // 1a
    } else if(doB) {
        b = new ConcreteB; // 1b
    }
    ...
    b->...; // 2
} 
```

您不能使用堆栈，因为在您知道要做什么的那一刻，1a 和 1b，当再次离开该范围时，您从堆栈中获得的每个存储都将被回收。您必须使用堆，因为您需要一些持续该本地范围的存储。

一些库宣传他们不能使用堆，但仍然表现出多态性。他们通常通过放置新来做到这一点：

```
void doSomething(int what) {
    // allocate form *the stack*, outside the if blocks, so this
    // storage lasts until the function returns
    char buffer[MAX(sizeof (ConcreteA), sizeof(ConcreteB))];
    if(doA) {
        new (buffer) ConcreteA; // 1a
    } else if(doB) {
        new (buffer) ConcreteB; // 1b
    }
    Base *b = static_cast<Base*>(static_cast<void*>(buffer));
    b->...; // 2
} 
```

1a 和 1b 中的新调用现在使用在堆栈上创建的缓冲区作为创建对象的存储。因此，不再需要堆内存分配。这种分配形式的主要缺点是，目前在 C++ 中无法判断缓冲区是否针对 ConcreteA 和 ConcreteB 类型正确对齐。因此，数组可能在 2 字节边界上对齐，但对象需要在 4 字节边界上创建，当您尝试将这些对象创建到该缓冲区时会导致未定义的行为。

Boost.Function 是那些使用这种放置新方法来创建多态类型对象而不使用使用小缓冲区的堆分配的库之一（因此，它所做的称为*小缓冲区优化*）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T05:49:54.267

我认为这完全没问题。唯一可能的缺点是在堆栈上创建的对象的范围有限，但这不一定与多态性有关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T05:54:34.477

使用堆栈没有问题。

当您使用堆栈时，您通常会确切地知道它是什么类型的对象......所以方法不需要是虚拟的，它是无害但不必要的，例如：

```
Derived derived;
derived.Foo(); 
```

但是，可以将对象（存在于堆栈中）传递给接受超类实例作为参数的子例程（在这种情况下，它是子类的事实很有用/使用）：

```
void foo(Base* base)
{
  ...
}

void test()
{
  Derived derived;
  foo(&derived);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T06:10:00.030

对于您展示的简单案例，使用堆栈就可以了。动态多态性与静态多态性的一个实时问题是增加了通过间接方法调用的时间。这是每个方法调用的额外内存访问。

您需要更多地解释您在分析其他因素时所做的工作，例如堆栈帧是否保证在物理内存中、共享、实例数、实例的生命周期

# .net - 类似于 Progress AppServers 的产品

> ID：486595
> 
> 赞同：0
> 
> 时间：2009-01-28T05:51:14.310
> 
> 标签：.net, progress-4gl

我在 Progress ABL 中工作并使用我们所谓的 AppServers。应用程序服务器，可以与进度数据库对话并在服务器上运行业务逻辑然后将响应发送回客户端的进程。

它们有 4 种模式，但我最习惯于 state-reset，它是一个应用服务器，在整个连接过程中保留状态，而 state-free，是一种即发即弃模式。

该产品具有高度专有性，可与 .net 等其他客户端兼容。

我的问题是，是否有任何纯.NET 的解决方案可以做同样的事情。我不是在谈论做 ASP.net 或 Web 服务，因为它们解决了不同的问题。我想要一些可以运行代码的东西，这些代码可以连接到数据库并回传响应，而无需编写我自己的系统。

在 AppServer 上运行代码的示例。

将变量 handleToAppServer 定义为句柄 no-undo。将变量 charResponse 定义为字符不可撤消。

在服务器 hAppServer 上运行“AppServerProcedure.p”（输出 charResponse）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T00:06:13.663

我是一名长期的 ABL 开发人员，我认为这是一个很好的问题。我也使用 C#，我喜欢并尊重这两个平台。但是，我从来没有真正理解过 C# 开发人员会如何做 OP 所描述的并且在 P4GL 中看起来如此简单。

p.marino 的上述回复假定您可以使用 SP 做您想做的事情。当然，这种情况经常发生，但我们 ABL 开发人员习惯于做的事情远远超出了 SQL 所能达到的范围。

那么，如果我想用 C# 编写业务逻辑并让它远程执行，而不是作为 SQL SP，我有什么选择？.NET 远程处理、Web 服务或 .NET 企业服务？我不认为其中任何一个都像 ABL AppServers 那样简单，而且除了 WS 之外，它们似乎都没有很大的吸引力。

（以免我听起来像个 P4GL 粉丝，他们的 GUI 完全崩溃，他们的工具令人作呕，而且许可费用相当高昂。我会用 C# 编写 GUI 或 Swing over P4GL。但是远程业务逻辑......我不太确定）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:40:58.013

Progress 应用服务器就像用于逻辑的 db 和 ui 中性容器。它们独立运行，而不是作为 Oracle 的一部分或 SQL Server 的一部分或其他任何东西运行，并且它们不关心客户端是 .NET、Java、WS 还是绿屏。他们不需要数据库连接，但如果这对他们来说是适当的事情，他们可以连接。

最初的提问者似乎并不想要大多数这些功能，并且从事情的声音来看，可能会对选择的数据库中的存储过程感到满意。

There is one other feature that might matter to the original question -- the real reason why Progress programmers like app servers is probably because it gives them a single programming language to work with. If you start using stored procedures you will need use a different language than the one that you code your UI in. And each target db will have its own language and quirks thereof to work through.

(Progress triggers run on the client, not inside the context of the server. So they aren't very stored procedure like.)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T12:35:07.167

老实说，我不确定我理解实际问题是什么。

如果您担心客户端应用程序能够连接到单独的数据库服务器，这实际上是常态，而不是例外。只需使用任何 JDBC/ODBC 桥，您就可以在客户端上执行您的代码，而只需将数据移入和移出网络。

如果您希望您的*逻辑*在远程服务器上执行（您在命名 AppServer 上调用过程的示例建议使用后者），那么基础是相同的，即使用 ODBC 连接到数据库服务器，并移动您的大部分存储过程的逻辑。

（我认为您正在寻找的内容在大多数现代 RDBMS 中称为“存储过程”：即完全在数据库服务器本身上运行的完整代码单元，无论是函数还是过程。它们可以由客户端远程调用，但使用数据库服务器上的内存和计算资源）。

在使用 DB 时，这又是一个非常标准的架构选择。Progress ABL/4GL 有一个混合范式模型，可能会使您的观点有些混乱（如果没记错的话，APPServer 是作为某种无头“超级客户端”运行的进程，并且没有“存储过程”的概念，即代码在数据库本身*内部*运行，除了可能的触发器）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-16T07:35:39.660

Answering for future reference:

Yes, now there is. In OpenEdge 11.5 (released in December 2014) the "Pacific AppServer" was included as an alternative to the classic appserver. It's based on Apache Tomcat and is more lightweight than the old one.

See these for more information:

[Complete set of 11.5 documentation](https://community.progress.com/community_groups/openedge_general/w/openedgegeneral/2352.openedge-11-5-product-documentation.aspx)

[Introducing PAS for OpenEdge (PDF)](http://documentation.progress.com/output/OpenEdge115/pdfs/pasoe/pasoe_introduction.pdf)

# eclipse - 用户体验设计师是否需要编程知识？

> ID：486598
> 
> 赞同：6
> 
> 时间：2009-01-28T05:53:11.170
> 
> 标签：eclipse, user-interface

我们团队中有一位没有编程背景的用户体验设计师。预计他将在 Eclipse 中设计屏幕作为开发环境。他的（有效的）抱怨是，每次他设计一个特定的屏幕并将其交给开发时——他们都会告诉他在技术上使用 SWT 或 GEF 什么是不可能的。所以，他希望我教他 SWT/GEF 的基础知识，这样他就可以做出明智的决定，甚至可以在提出设计建议之前在 eclipse 中尝试某些东西（而不是使用 Photoshop）以节省时间。

我个人的信念是，设计不应该受到技术可能性的限制，理论上，设计师梦想的一切（至少是实际的事情）在技术上都应该是可能的——尽管有变通办法或一点点黑客。

所以，我的问题是——你认为编程知识对于用户界面设计有多重要？如果是的话，你如何去教一个完全没有编程经验的人在各种平台上的图形框架？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T06:04:01.883

原则上，我同意你的看法。要成为熟练的 UI 和工作流程设计师，编程知识不是必需的。但是，了解所使用技术的能力和局限性可以帮助 UI 设计师更有效地与编程人员合作。

编程知识可以提供帮助的地方是，如果开发人员在吹口哨说某些事情可以做时不能做，那么对正在使用的工具的一些知识可以帮助反驳这一点。如果开发人员正确地认为某事无法完成，那么工具知识可以帮助 UI 设计人员找到满足设计目标且可实现的适当解决方案。

有了适当合作的开发人员，UI 设计人员将需要很少（如果有的话）关于正在使用的特定 GUI 工具的知识。

我一直在开发人员方面，我被要求做一些不可能或不切实际的事情。我一直与设计师合作，寻找一个满足设计目标的快乐中间人。有时，我认为不可能的事情实际上是可能的。有时我们不得不以不同的方式做事。有些事情不得不推迟，因为“可能，但需要付出太多努力”。（比如一个基于 SWT 的应用程序变成了一个 Windows 任务栏。绝对有可能，但对于所讨论的项目来说是不切实际的，因为它需要本机代码。）

最重要的是双方都意识到他们在同一个团队中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T06:05:40.600

这很重要..

不知道：

1.  一般技术
2.  您选择投入时间来生产最终产品的技术

将导致每个人完全浪费时间..

即使是最终用户也需要了解一下使用我们制造的任何产品所采用的技术。驾驶汽车的人总是需要知道如何加油并了解汽车的基本知识以及什么它可以做到，软件以类似的方式工作。

这就像问一个不知道汽车（今天的汽车）需要轮子来绘制下一个发布模型的人。

让他们更加了解这项技术的方法是：

1.  向他/她展示与您应该制作的产品相似的产品
2.  向他/她展示您可能考虑使用的构建块的独立实现

但是无论如何……这并不意味着你应该扼杀他们的创造力……让他们抽离他们的梦想，只是让他们一点点意识到现实的需要，以便在这一生中完成一些事情

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T05:57:09.523

在我看来，它不如常识重要。

它当然有帮助。但是，如果设计人员要求一些可以完成的事情（因为其他一些应用程序使用它），那么开发负责人至少应该提出一个解决方法。

编程知识可能没有，但肯定是对所选平台的限制。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T06:06:51.440

> 所以，我的问题是——你认为编程知识对于用户界面设计有多重要？

我认为需要具备平台标准用户界面的基本知识（文本字段、组合框、单选按钮等）。从开发人员的角度来看，优秀的设计人员应该熟悉这些 GUI 组件的功能和限制。所以我想一些基本的编程知识会很有用。

> 我个人的信念是，设计不应该受到技术可能性的限制，理论上，设计师梦想的一切（至少是实际的事情）在技术上都应该是可能的——尽管有变通办法或一点点黑客。

我认为这里有一些重要的条件——每个操作系统都有关于什么是好的 GUI 设计的指导方针，你遵循它们对你的产品是有益的，因为用户对他或她应该如何与应用程序交互有一定的心理模型平台。（话虽如此，打破某些设计惯例可能有充分的理由，例如在游戏、专门的图形/音乐应用程序中。）

> 你如何去教一个完全没有编程经验的人在各种平台上的图形框架？

每个工具包都提供了一大堆小示例程序来演示不同组件的使用——这可能是熟悉它们的良好第一步。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-28T06:44:47.043

我认为最好提前学习，但如果你的 UI 设计师被迫在飞行中学习，请确保每次他被拒绝时，都解释了为什么不能做某事，而不是直接拒绝。这将使他不会像其他情况下那样感到沮丧，因为他至少能够为他能做什么和不能做什么形成一些逻辑框架。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-28T06:01:27.630

这完全取决于您的工具。

**编辑：**我的意思是有为设计师设计的工具和为程序员设计的工具。Eclipse，因为它不是设计工具。Photoshop 是。Flash 可能，Flex 没有。我不需要 Flash 设计人员进行编程，但 Flex 设计人员确实需要进行编程。

至于告诉他们你所依赖的工具的局限性，真正优秀的创意设计师会接受这些限制并做出令人难以置信的工作，平庸的设计师会认为这些限制是障碍，不再有创造力，只是害怕地遵守规则。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T06:39:55.913

我认为设计师应该了解他使用的工具所提供的功能和限制，并且他应该了解这些人正在制作的当前项目的限制和截止日期。

他还应该了解显示屏幕 UI 的后台处理，所有这些只有在他具备一些基本的编程知识时才会出现。

他不必涉足 OOP 的深度、学习 SQL、了解反射的复杂性或任何类似的花哨的东西。他只需要很好地了解他的平台，我认为这甚至是设计师的要求。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-28T09:25:59.307

“设计”的核心是找到一种在约束范围内达到预期结果的方法。如果您对影响目标的部分约束不做任何事情，那么您就无法设计。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-28T10:21:13.237

我已经考虑过，根据之前给出的答案，我得出了一些结论：

在给定平台上进行设计时，必须初步了解什么是可能的以及什么是限制。这意味着图形设计师应该注意以下几点：

*   该平台上的基本设计指南
*   该平台上提供的标准 UI 工具包/小部件（例如：文本框、下拉列表等）
*   在给定平台上不可能（或太麻烦）的事情（例如：在 Eclipse 中淡出背景时创建半透明模式对话框）

这种知识量可能不需要设计师涉足编程。

第二个层次是设计师试图创建新的小部件或（有意地）违反给定平台的设定标准。例如，如果设计包含图形或需要描述特殊关系或文本、图形和图像的独特组合，而这些都不受任何标准工具集的隐式支持。在这种情况下，设计者应该意识到给定平台的技术可能性和限制。在这种情况下，我认为设计人员应该能够编写一些代码并尝试一些事情来确定可能发生的事情。

# java - 如何解决 Facelets 和 Spring Web Flow 中的刷新问题？

> ID：486607
> 
> 赞同：1
> 
> 时间：2009-01-28T05:59:41.563
> 
> 标签：java, facelets, spring-webflow

对于我的特定项目，我使用 Facelets (1.1.14)、MyFaces (1.2.3) 和 Spring Web Flow (2.0.3)。我的 IDE 是 JDeveloper 10.1.3.3。我的浏览器是 IE6（工作要求）。

好吧...今天遇到了一个非常奇怪的问题。通常，当我使用 Facelets 时，我可以对我的 xhtml 文件进行任何我想要的更改，刷新我的浏览器窗口，然后立即查看更改。我将 Facelets development 设置为 true，Facelets refresh period 设置为 1。

直到今天下午，我对这个项目的 Facelets 刷新没有任何问题。但是，就在今天下午，我开始发现刷新页面时没有出现对 css 样式和类的更改。然后我开始看到其他页面元素的类似问题。在某些情况下，这些更改永远不会出现。在其他时候，我可以在一段时间后刷新页面并且更改已经反映。

我的 Facelets 页面刷新发生了什么？就好像它们都粘了一样。我习惯于在页面刷新时立即更改而不会出现复杂情况。有没有人遇到过这个？有什么解决方案或建议吗？

*编辑*

这个问题与 Spring Web Flow 有关。我的页面之一是纯 Facelets，它会立即反映刷新时的变化。我的其他 xhtml 页面在我的流程定义中作为视图状态被调用，并显示上述症状。尽管如此，他们在一两天前工作得很好......

*编辑*

好的，我已经能够隔离症状，但我仍然不知道它的原因。

似乎每当我有一个 facelets xhtml 文件呈现为流的视图状态并具有一个 h:form 元素时，当我更改页面上的 JSF 元素并刷新我的浏览器时，我就会出现奇怪的行为。这包括不显示其样式或样式类的更改。

对常规 HTML 元素的更改（例如更改输入元素的样式）似乎可以正常工作。将 h:form 更改为常规 HTML 表单允许在页面刷新时立即更改，甚至在 JSF 元素上也是如此。当我在不执行流程（仅使用 Facelets）时查看页面时，我从未遇到任何问题，即使使用 h:form 也是如此。

请告诉我有人以前遇到过这种情况，并有一些解决方案。任何人？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-04T16:00:44.127

如果您的 中有条目`facelets.REFRESH_PERIOD -1`，`web.xml`这就是导致问题的原因。只需通过删除此条目进行交叉检查即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T03:38:47.550

我不确定这是否适用于 Web Flow，但我知道使用 Spring MVC，您可以选择让控制器实现 LastModified 接口，该接口允许 Spring 向浏览器发送“Last-Modified”HTTP 标头。

Servlet 通常不设置此 HTTP 标头值，导致浏览器每次都请求文件的新副本，但是，如果设置了“Last-Modified”标头，浏览器知道如果它没有检索 URL 的内容'自上次检索页面以来未修改。

我怀疑您的 Web Flow“控制器”（请原谅我滥用术语，我不熟悉 Web Flow）正在设置“Last-Modified”标题，而您的常规 Facelets 页面没有。

对于它的价值，我认为设置 Last-Modified 通常是一个好主意，除非您的页面是动态的。

# iphone - 如何在 cocos2d 中使用动画？

> ID：486609
> 
> 赞同：16
> 
> 时间：2009-01-28T06:01:14.260
> 
> 标签：iphone, objective-c, cocoa-touch, animation, cocos2d-iphone

我正在尝试为 iPhone 开发轮盘游戏。如何动画（旋转）轮盘？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-07-26T18:51:53.010

在 Cocos2D 中很简单：

```
[sprite runAction:[RotateBy actionWithDuration:dur angle:360]]; 
```

转一圈或

```
id action = [RepeatForever actionWithAction: [RotateBy actionWithDuration:dur angle:360]];
[sprite runAction:action]; 
```

和

```
[sprite stopAction:action]; 
```

如果您需要连续旋转。

不要忘记确保精灵 transformAnchor 设置为图像的中心。我想应该会出现下一个问题——如何让它顺利停止；）

有关操作的更多信息：http: [//lethain.com/entry/2008/oct/03/notes-on-cocos2d-iphone-development](http://lethain.com/entry/2008/oct/03/notes-on-cocos2d-iphone-development/)（它适用于旧版本，因此它使用已弃用的“do”而不是“runAction”）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-29T22:08:07.047

我不知道如何在 cocos2d 中做到这一点（甚至是什么），但你可以使用 Core Animation 和 CALayers 或 UIViews 来做到这一点。可能最简单的方法是创建一个包含轮盘图像的 UIImageView 并为其设置动画。

为此，首先通过使用轮盘赌图像初始化 UIImageView 来设置它。当您希望轮子旋转时，请使用以下代码：

```
CATransform3D rotationTransform = CATransform3DMakeRotation(1.0f * M_PI, 0, 0, 1.0);

CABasicAnimation* rotationAnimation;
rotationAnimation = [CABasicAnimation animationWithKeyPath:@"transform"];

rotationAnimation.toValue = [NSValue valueWithCATransform3D:rotationTransform];
rotationAnimation.duration = 0.25f;
rotationAnimation.cumulative = YES;
rotationAnimation.repeatCount = 10; 

[rotatingImage.layer addAnimation:rotationAnimation forKey:@"rotationAnimation"]; 
```

假设rotatingImage 是你的UIImageView。

在此示例中，轮子将旋转 5 次，每次旋转需要 0.5 秒。旋转被分成两半，因为核心动画将进入下一个最接近的状态，所以在动画想要向另一个方向旋转之前，你最多可以旋转半个旋转。也就是说，这里的 pi 弧度（180 度）旋转了半圈，但如果你使用 (1.5f * pi) 作为旋转角度，它只会旋转四分之一圈。同样，如果您使用 (0.999f * pi)，圆将以顺时针方式旋转。

你会想要实现你的轮子的加速和减速，在这个例子中，CAKeyframeAnimation 将取代 CABasicAnimation。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-09-14T19:41:10.090

您可以将视图旋转一定数量的弧度，无论它是小于完整旋转还是完整旋转的多个倍数，而无需将旋转拆分为多个部分。例如，以下代码将每秒旋转一次视图，持续指定的秒数。您可以轻松地对其进行修改，以通过一定数量的旋转或一定数量的弧度来旋转视图。

```
- (void) runSpinAnimationWithDuration:(CGFloat) duration;
{
    CABasicAnimation* rotationAnimation;
    rotationAnimation = [CABasicAnimation animationWithKeyPath:@"transform.rotation.z"];
    rotationAnimation.toValue = [NSNumber numberWithFloat: M_PI * 2.0 /* full rotation*/ * rotations * duration ];
    rotationAnimation.duration = duration;
    rotationAnimation.cumulative = YES;
    rotationAnimation.repeatCount = 1.0; 
    rotationAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseOut];

    [myView.layer addAnimation:rotationAnimation forKey:@"rotationAnimation"];
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-07T01:20:00.320

有几种方法可以做到这一点。

如果您有轮子的逐帧动画，请查看 AtlasDemo（cocos2d 发行版的一部分）。

否则，看看 Sprite 的 RotateBy: 方法。

# c# - 从 OnTextChanged 内部编辑 TextBlock.Inlines 时出现 InvalidOperationException

> ID：486615
> 
> 赞同：1
> 
> 时间：2009-01-28T06:05:32.550
> 
> 标签：c#, wpf

我在以下代码中随机出现 InvalidOperationException，有什么好的方法来解决它？

```
public class ParsedTextBlock : TextBlock
{
    static ParsedTextBlock() {
        TextProperty.OverrideMetadata(typeof(ParsedTextBlock),
            new FrameworkPropertyMetadata("No Text Set",
                FrameworkPropertyMetadataOptions.AffectsMeasure | FrameworkPropertyMetadataOptions.AffectsRender,
                OnTextChanged)
            );
    }

    private static void OnTextChanged(DependencyObject obj, DependencyPropertyChangedEventArgs args)
    {
        ParsedTextBlock control = (ParsedTextBlock)obj;
        control.Inlines.Clear();
        control.Inlines.Add(new Run("test " + args.NewValue as string))
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-28T02:29:28.513

我认为从文本更改事件中更改文本不是一个好主意。这将导致事件递归触发并最终产生堆栈溢出......多么讽刺:)

# subdomain - 什么时候应该使用“www”子域？

> ID：486621
> 
> 赞同：156
> 
> 时间：2009-01-28T06:07:43.107
> 
> 标签：subdomain

在过去几年浏览互联网时，我看到越来越多的页面摆脱了“www”子域。

是否有充分的理由使用或不使用“www”子域？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2009-01-28T07:25:13.823

有很多很好的理由来包含它，其中最好的是： [Yahoo Performance Best Practices](http://developer.yahoo.com/performance/rules.html#cookie_free)

由于 cookie 的点规则，如果您没有“www.” 那么您就不能像 *.example.com 那样设置两点 cookie 或跨子域 cookie。有两个相关的影响。

首先，这意味着您向其提供 cookie 的任何用户都将通过与域匹配的请求将这些 cookie 发回。因此，即使您有一个子域 images.example.com，example.com cookie 也将始终与对该域的请求一起发送。如果您将 www.example.com 设为权威名称，这会产生不存在的开销。当然，您可以使用 CDN，但这取决于您的资源。

此外，您将无法设置跨子域 cookie。这似乎很明显，但这意味着允许经过身份验证的用户在您的子域之间移动更多的是技术挑战。

所以问自己一些问题。我设置 cookie 吗？我是否关心潜在的不必要的带宽支出？经过身份验证的用户会跨越子域吗？如果您真的担心给用户带来不便，您可以随时配置您的服务器以自动处理 www/no www 事情。

见[dropwww](https://dropwww.com/why)和[yes-www](https://www.yes-www.org/)。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-01-28T06:10:08.343

就在问了这个问题之后，我来到了[no-www](http://no-www.org/)页面，上面写着：

> ...简而言之，使用 www 子域是多余的，而且沟通起来很耗时。没有它，互联网、媒体和社会都会变得更好。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-01-28T06:19:56.420

从域名获取，同时使用 www.domainname.com 和普通的 domainname.com 否则你只是将你的流量丢给浏览器搜索引擎（DNS 错误）

实际上，令人惊讶的是有多少域，尤其是在前 100 名中，正确解析为 www.domainname.com 而不是 domainname.com

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-08T21:20:01.407

使用 www 子域的原因有很多！

编写 URL 时，手写和键入“www.stackoverflow.com”比“ [http://stackoverflow.com](http://stackoverflow.com) ”更容易。大多数文本编辑器、电子邮件客户端、文字处理器和所见即所得控件将自动识别上述两者并创建超链接。只输入“stackoverflow.com”不会产生超链接，毕竟它只是一个域名。谁说那里有网络服务？谁说对该域的引用是对其 Web 服务的引用？

你更愿意写/输入/说什么......“www。” （4 个字符）或“http://”（7 个字符）？？

“万维网。” 是一种既定的简写方式，用于明确传达主题是 Web 地址，而不是另一个网络服务的 URL。

当口头传达一个网址时，应该从上下文中清楚它是一个网址，所以说“www”是多余的。服务器应配置为返回 HTTP 301（永久移动）响应，将所有对 @.stackoverflow.com（域的根）的请求转发到 www 子域。

根据我的经验，认为应该省略 WWW 的人往往是不了解 Web 和 Internet 之间的区别并且可以互换使用这些术语的人，就像它们是同义词一样。Web 只是众多网络服务之一。

如果您想摆脱 www，为什么不将您的 HTTP 服务器也更改为使用不同的端口，TCP 端口 80 昨天太棒了。让我们将其更改为端口 1234，YAY 现在人们不得不说并输入“ [http： //stackoverflow.com:1234](http://stackoverflow.com:1234) " (八位 tee tee pee 冒号斜杠 slash stackoverflow dot com 冒号一二三四) 但至少我们不必说“www”吧？

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-08T23:02:32.020

包含或不包含它没有很大的优势，也没有一种客观上最好的策略。“no-www.org”是一堆愚蠢的旧教条，试图将自己呈现为确定的事实。

如果“拥有许多不同服务并且不想将裸域名专用于作为 Web 服务器的大型组织”场景不适用于您（实际上很少适用），您选择的地址是很大程度上是文化问题。您是否习惯于在广告材料上看到一个简单的“example.org”域，他们会立即将其识别为没有额外的“www”或“http://”的网址吗？例如，在日本，您会因为选择非 www 版本而获得有趣的外观。

但是，无论您选择哪种方式，都要保持一致。使 www 和非 www 版本都可访问，但使*其中一个*具有确定性，始终链接到该版本，并使另一个重定向到它（永久，状态代码 301）。让两个主机名都直接响应对 SEO 不利，并且提供*任何解析到您的服务器的旧*主机名会使您面临 DNS 重新绑定攻击。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-08T22:46:39.827

有几个原因，这里有一些：

**1) 这个人是故意这样想要的**

人们将 DNS 用于许多事情，而不仅仅是网络。他们可能需要一些其他对他们更重要的服务的主要 dns 名称。

**2) 配置错误的 dns 服务器**

如果有人在您的 dns 服务器上查找 www，则您的 DNS 服务器将需要解析它。

**3) 错误配置的网络服务器**

Web 服务器可以托管许多不同的网站。它通过 Host 标头区分您想要的站点。您需要指定要用于您的网站的主机名。

**4) 网站优化**

最好不要同时处理这两个，而是转发一个带有永久移动的 http 状态代码的。这样两个地址就不会竞争入站链接排名。

**5) 饼干**

避免浏览器未发回 cookie 的问题。这也可以通过永久移动的 http 状态码来解决。

**6) 客户端浏览器缓存**

如果您向 www 发出请求而另一个没有请求，则 Web 浏览器可能不会缓存图像。这也可以通过永久移动的 http 状态码来解决。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-28T09:14:59.517

正如 jdangel 指出的那样，在某些 cookie 情况下，www 是一种很好的做法，但我相信还有另一个理由使用 www。

关心和保护我们的用户不是我们的责任吗？正如大多数人所期望的那样，如果不为其编程，您将给他们带来不那么完美的体验。

对我来说，仅仅因为理论上不需要设置 DNS 条目，这似乎有点自大。携带 DNS 条目并通过重定向等没有开销，它们可以重定向到非 www dns 地址。

认真不要让潜在访问者出现不必要的“未找到站点”错误，从而损失宝贵的流量。

此外，在仅限 Windows 的网络中，您可能能够设置 Windows DNS 服务器以避免以下问题，但我认为您不能在 Mac 和 Windows 的混合环境中。如果 mac 对 windows DNS 进行 DNS 查询，mydomain.com 将返回所有可用的名称服务器，而不是 web 服务器。因此，如果您在浏览器中键入 mydomain.com，您的浏览器将查询名称服务器而不是网络服务器，在这种情况下，您需要一个子域（例如 www.mydomain.com ）来指向特定的网络服务器。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-02-10T21:41:19.973

除了关于 cookie 的负载优化之外，使用子域还有一个与 DNS 相关的原因`www`。您不能对裸域使用**CNAME 。**在[yes-www.org 上](http://www.yes-www.org/why-use-www/)它说：

> 当使用**Heroku**或**Akamai**等提供商托管您的网站时，提供商希望能够更新 DNS 记录，以防需要将流量从故障服务器重定向到健康服务器。这是使用 DNS **CNAME**记录设置的，裸域不能有 CNAME 记录。
> 仅当您的站点变得足够大以至于需要使用此类服务​​进行高度冗余托管时，这才是一个问题。

# paypal - Paypal 定期订阅问题

> ID：486626
> 
> 赞同：8
> 
> 时间：2009-01-28T06:10:02.447
> 
> 标签：paypal, paypal-subscriptions

当有人开始定期订阅时，我会传递`custom`包含我系统上用户的用户 ID 的变量。付款后，我收到两个 IPN，subscr_signup 和 subscr_payment。两者都有自定义变量，可以让我识别用户。

但是，对于未来的定期付款，IPN 是否会继续传递自定义变量？我应该依赖 subscr_id 而不是自定义吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T07:44:01.400

[我从这个页面](http://www.pdncommunity.com/pdn/board/message?board.id=ipn&thread.id=7215)找到了答案。是的，自定义变量将始终在每个连续的 IPN 帖子中按原样传递。

引用：

> 自定义通过注册和支付 IPN 帖子传回，并通过连续的 IPN 帖子传回。在第一个支付 IPN 中传回的变量不会在连续的支付 IPN 中复制。唯一可区分的因素是注册或第一期付款是否有不同的价格。

# asp.net - 在使用 asp.net 进行登录身份验证时需要帮助

> ID：486629
> 
> 赞同：1
> 
> 时间：2009-01-28T06:10:53.583
> 
> 标签：asp.net, authentication, login, 3-tier

我能够验证登录页面的简单方法。如何在 3 层架构中进行身份验证？请有人向我发送 DAL、BAL 和 GUI 层中应该包含什么的代码？这是我的简单代码：

网络配置：

```
<authentication mode="form">
    <form loginurl="Login.aspx">
         <credential password Format="clear">
          <user name="abcd" password="1234">
        </credential>
      </authentication>
     </form>
   <authorization>
     <deny users="?">
   </authorization> 
```

登录.aspx.cs：

```
 sqlconnection con=new sqlconnection("server=localhost;database=dbname;uid=;pwd=;Trusted_Connection=true");
sqldataAdapter da=new sqldataAdapter("select * from Login where UserName='"+TextBox1.Text+"' and Password='"+TextBox2.Text+"'",con);
Dataset ds=new Dataset();
da.Fill(ds);

if(ds.Tables[0].rows.Count>0)
{
   if(FormAuthentication.Authenticate("abcd","1234")
   {
        FormAuthentication.RedirectFromLoginPage(TextBox1.Text,false);
        Response.write("Logged in");
    }
    else
    {
        Response.write("Unautherised User");
    }

   Response.Redirect("welcome.aspx");
}
else
{
  Response.write("Sorry Invalid UserName or Password");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T06:50:55.110

一般来说，您至少应该有以下课程：

*   在 DAL 中，您应该有一个用于处理数据库连接的类
*   在 BAl 中，您应该有一个代表每个用户实例的类。这个类应该有一个名为 login() 的方法，所有的身份验证和授权都在其中进行。
*   表示用户界面的 Web 表单。

此外，为了防止 SQL 注入，永远不要连接查询字符串。改用参数。

以下是一些示例类：

```
namespace DAL
{
    public class ConnectionManager
    {
        public static SqlConnection GetConnection() {
            SqlConnection cn = new SqlConnection("server=localhost;database=dbname;uid=;pwd=;Trusted_Connection=true");
            cn.Open();
            return cn;
        }
    }
}

namespace BAL
{
    public class User
    {
        public string UserName { get; set; }
        public string Password { private get; set; }

        public bool Login() {
            return Login(this.UserName, this.Password);
        }

        public bool Login(string user, string password) {
            bool success=false;
            using (SqlConnection cn = ConnectionManager.GetConnection())
            {
                string sql = "select count(*) from Login where UserName=@user and Password=@password";
                using (SqlCommand command = new SqlCommand(sql, cn))
                {
                    command.Parameters["@user"].Value = user;
                    command.Parameters["@password"].Value = password;
                    success = (int)command.ExecuteScalar() > 0;
                }
                cn.Close();
            }
            return success;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T07:33:08.940

有点不知所措，为什么要重新发明轮子？ASP.NET Membership 提供程序为您完成这一切，如果您需要大量修改其行为，它的开源、易于阅读、理解和更改。它可以轻松地与您自己的 n 层架构集成——我们一直在这样做。

# asp.net - 根据所选页面显示不同的标题

> ID：486630
> 
> 赞同：0
> 
> 时间：2009-01-28T06:11:29.620
> 
> 标签：asp.net, master-pages

我有一个 asp.net 网站，在主要水平导航上有 5 个项目（主页、产品、新闻、关于、联系方式）。

该站点使用母版页，该母版页使用以下方法将页面拆分为页眉、正文和页脚

我希望能够显示不同的标题（包括不同的颜色和图像），具体取决于选择了 5 个导航项中的哪一个。

谁能告诉我在不膨胀页面下载的情况下实现这一目标的最佳方法？

我知道asp.net、html、css、javascript 和vb 的方式，但我不是专家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T06:19:12.507

我可能会创建一个他们都会使用的基本 CSS 类，然后在 app_themes 目录中创建 5 个不同的主题（如果没有，则创建一个），每个导航选项一个；在那里，您可以使用更具体的选项覆盖基本 CSS 来更改背景图像/颜色。如果您使用的是 Asp:Images（而不是使用 CSS 的背景图像），您还可以在每个主题中使用 .theme 文件更改源。这样，您只需下载相关文件。您必须更改 Page_Init 上的 Page.Theme。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T06:36:46.810

您是否正在尝试实现菜单？...

我能想到的一种可能的策略是为标题制作一个用户控件，然后根据该模式在 HTML 中呈现设计。

这样，您仍然可以利用不同的标头，并且可以进行灵活的设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T06:39:32.280

根据选择的页面在标题中创建条件语句。

# jquery - JQuery UI 手风琴故障

> ID：486638
> 
> 赞同：2
> 
> 时间：2009-01-28T06:16:52.853
> 
> 标签：jquery, jquery-ui, safari, accordion

我正在使用 JQuery UI 1.6rc5 并且在使用手风琴小部件时遇到了一些麻烦。这是我正在使用的代码。

```
<script>
$(document).ready(function(){
    $('#find-panel').accordion({
        header:"h3",
        autoHeight:true,
        alwaysOpen: false,
    }); 
});
</script>

<div id="find-panel" class="ui-accordion" style="width:450px;">
    <div class="ui-accordion-group">
        <h3 class="ui-accordion-header">
            <a href = "#">
            I know a Material
            </a>
        </h3>
        <div class="ui-accordion-content">
                <p>Enter a part number</p>
        </div>
    </div>

    <div class="ui-accordion-group">
        <h3 class="ui-accordion-header">
            <a href="#">
                I know a Tag
            </a>
        </h3>
        <div class="ui-accordion-content">
            <p>Enter a tag name</p>
        </div>
    </div>

    <div class="ui-accordion-group">
        <h3 class="ui-accordion-header">
            <a href="#">
                I know an Issue
            </a>
        </h3>
        <div class="ui-accordion-content">
            <p> Enter an issue id number</p>
        </div>
    </div>  
</div> 
```

我遇到的问题是此代码在 Safari 中无法正常工作。具体来说，div.ui-accordion-content 标记中的内容无法正确呈现。如果我在样式中指定高度，safri 工作正常。

我已经能够在 FF 中测试它上面的确切代码，并且工作正常。有没有其他人在 Safari 上看到过这个问题，你是如何解决的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T06:22:47.447

好吧，当我在你的示例中的最后一个对象属性之后在对象中留下一个额外的逗号时，Safari 总是让我窒息（之后`alwaysOpen: false`）

```
$('#find-panel').accordion({
    header:"h3",
    autoHeight:true,
    alwaysOpen: false,
}); 
```

# browser - 音频/视频流到移动浏览器

> ID：486648
> 
> 赞同：1
> 
> 时间：2009-01-28T06:22:06.323
> 
> 标签：browser, mobile, streaming, wap

我正在开发一个 WAP/移动网站，允许用户通过他们的移动浏览器流式传输音频/视频（尽管优先级是音频）..

对于音乐，我将传输 mp3 文件，对于视频，我将传输 flv 和 3gp 文件（但主要是 3gp）。

谁能推荐解决方案（即使用什么和/或指向正确的方向）以将音频/视频流式传输到移动浏览器？

AFAIK，大多数 3G 设备和 flash lite 都支持 RTSP（可能通过 Darwin Streaming Server？）。（使用 flash lite 作为播放器会不会是一个好主意，因为用户需要在他们的移动设备上安装 flash lite？我对 flash 不太熟悉。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T17:59:06.513

大多数手机都支持通过RTSP进行视频流，最便宜的方法是Darwin Stream Server，它集成了Real Video player

至于手机支持有限的Flash lite，所以我不建议使用它。

我唯一要补充的是，如果没有无线运营商支持，将数据流式传输到手机对最终用户来说可能非常昂贵，因此请确保最终用户了解潜在的数据费用

# c++ - 使用c++访问Internet Explorer

> ID：486653
> 
> 赞同：4
> 
> 时间：2009-01-28T06:24:31.390
> 
> 标签：c++

正如主题所说，我想知道是否有工具或教程可以帮助我访问 IE，进入某个 URL，在该网站上执行一些操作。所以我会有一个程序来为我做这件事，而不是每次都自己做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T00:59:10.967

you should really rephrase your question.. you said what you want to do is login to hotmail programatically, check the pidgin code, they do it.

Documentation found [here](http://pidgin.sourcearchive.com/documentation/2.2.1/msn_8c-source.html) , [here](http://pidgin.sourcearchive.com/documentation/2.4.3/notify_8h_0c209891a7a9dab3bc059b63fc3e9560.html#0c209891a7a9dab3bc059b63fc3e9560) and you can I think navigate through the code and tutorials at will until you have your understanding of how the pidgin contributors did it.

You can find the main page for pidgin [here](http://www.pidgin.im/)

Code sample to get you started:

```
00362 static void
00363 msn_show_hotmail_inbox(PurplePluginAction *action)
00364 {
00365       PurpleConnection *gc;
00366       MsnSession *session;
00367 
00368       gc = (PurpleConnection *) action->context;
00369       session = gc->proto_data;
00370 
00371       if (session->passport_info.file == NULL)
00372       {
00373             purple_notify_error(gc, NULL,
00374                                       _("This Hotmail account may not be active."), NULL);
00375             return;
00376       }
00377 
00378       purple_notify_uri(gc, session->passport_info.file);
00379 }

00652 void *
00653 purple_notify_uri(void *handle, const char *uri)
00654 {
00655       PurpleNotifyUiOps *ops;
00656 
00657       g_return_val_if_fail(uri != NULL, NULL);
00658 
00659       ops = purple_notify_get_ui_ops();
00660 
00661       if (ops != NULL && ops->notify_uri != NULL) {
00662 
00663             void *ui_handle = ops->notify_uri(uri);
00664 
00665             if (ui_handle != NULL) {
00666 
00667                   PurpleNotifyInfo *info = g_new0(PurpleNotifyInfo, 1);
00668                   info->type = PURPLE_NOTIFY_URI;
00669                   info->handle = handle;
00670                   info->ui_handle = ui_handle;
00671 
00672                   handles = g_list_append(handles, info);
00673 
00674                   return info->ui_handle;
00675             }
00676       }
00677 
00678       return NULL;
00679 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T06:32:27.240

[这](http://www.codeproject.com/KB/cpp/IEC2.aspx)是一个使用 C++ 实现 Internet Explorer 自动化的项目

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T01:24:22.617

为什么不在[dapper](http://www.dapper.net/)中在两分钟内制作一个提要？显然有些人也已经[这样做了](http://www.dapper.net/dapp-search.php?keyword=hotmail&transformer=&x=0&y=0)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T20:43:42.513

不知道有什么工具。

我使用嵌入式浏览器来处理这些事情。可以连接到正在运行的 IE 实例。请参阅 [连接到正在运行的 IE 实例](http://www.codeproject.com/KB/shell/AutomateShellWindow.aspx) 一旦获得 IWebBrowser2 的实例，编码是相同的。

```
1.获取文档接口
     pWebBrowser->Document->QueryInterface(
          IID_IHTMLDocument2,(LPVOID*)&Doc);
 2.获取Document上的所有元素
     Doc->get_all(&Elements);
 3.枚举元素
     元素->get_length(&ulLen);
     for_each
        Elements->item(item, index, &ppvElement);
 4\. 确定需要什么元素。
     * 按类名
     * 按 ID 等。这里我使用了类名
       ppvElement->get_className (&bstrElement);
 5.为用户/密码插入文本
    ppvElement->put_innerText(wsUreser_or_Psswd)
 6\. 找到登录按钮并单击它。
    ppvElement->点击（）；您的结果可能会有所不同。

--

迈克尔

            回答 #5

赞同：0

时间：2009-01-28T06:31:57.787

与其使用 IE 来做这些事情，不如为您选择的语言寻找合适的[屏幕抓取](http://en.wikipedia.org/wiki/Screen_scraping)库。您可以 google 和搜索 Stack Overflow 以找到许多这样的库。从这里，您将使用您的语言的 Web API 将数据发送到服务器。

        scala - scala 有没有办法从任何 Map 转换为 java.util.Map？

ID：486665

赞同：7

时间：2009-01-28T06:32:09.563

标签：scala, scala-java-interop

我使用了很多 scala 映射，有时我想将它们作为映射传递给需要 java.util.Map 的遗留 java api（而且我不在乎它是否会丢弃任何更改）。

            回答 #1

赞同：7

时间：2009-12-07T05:14:26.130

我发现一个优秀的图书馆在这方面做得更好：

[http://github.com/jorgeortiz85/scala-javautils](http://github.com/jorgeortiz85/scala-javautils)

（坏名字，很棒的图书馆）。您根据您想要的方向显式调用 .asJava 或 .asScala。没有惊喜。

            回答 #2

赞同：2

时间：2009-01-28T13:58:17.510

Scala 为 Java 集合提供了包装器，因此它们可以用作 Scala 集合，但不能反过来。话虽如此，编写自己的包装器可能并不难，我相信它对社区很有用。这个问题经常出现。

            回答 #3

赞同：1

时间：2009-12-07T09:07:22.200

这个[问题和答案](https://stackoverflow.com/questions/1519838/java-scala-interop-transparent-list-and-map-conversion)讨论了这个确切的问题和可能的解决方案。它建议不要进行透明转换，因为它们可能会产生非常奇怪的副作用。它提倡使用[scala-javautils](http://github.com/jorgeortiz85/scala-javautils)代替。我已经在一个大型项目中使用它们几个月了，发现它们非常可靠且易于使用。

        build-process - 如何使构建（java）尽可能“独立于CM”？（CM=配置管理器）

ID：486668

赞同：1

时间：2009-01-28T06:33:15.007

标签：build-process, build-automation, simplify

我一直在考虑制作我处理的项目构建之一，尽可能“独立”于我（CM）。我的意思不仅仅是通过脚本/工具实现自动化——尽管它肯定包括它。这是一个非常混乱的项目，因此“完全”自动化是不现实的。

这是我的目标：

任何人都应该能够进行构建（通过一些自动化和一些文档/指南） - 例如 - 新手 CM，甚至是没有 CM 经验的开发人员。

我的第一个想法是通过以下方式实现这一目标：

1.  确定构建请求过程（通过构建表单捕获构建所需的所有详细信息，这样就不会因为它在某人的脑海中而落入裂缝）

2.  简化构建步骤，以便可以在简单的文档中将它们捕获为一系列命令 - 训练有素的猴子应该能够与构建一起运行（嗯..不是侮辱而是 - 你明白了:-)）

3.  充分利用该工具的功能（阅读 ANT、SVN），以便提前发现潜在问题，并有助于在出现故障/问题时提供更好的警报。

4.  每次我提到几天休假时，项目经理都可以自由地生病或偶尔休假，而不会惊慌失措。:-)

我很高兴有一些想法和想法可以帮助我朝这个方向发展。谢谢大家！

            回答 #1

赞同：2

时间：2009-01-28T13:00:51.323

在[Urbancode](http://www.anthillpro.com)，我们将此称为“Bob the Builder”反模式。好消息是鲍勃（你）想要摆脱困境。当构建人员无法去度假或生病时，如果不停止部分过程，则确实存在不可接受的问题。如果我是一个赌徒，当您开始将流程简化到“受过训练的猴子”级别时，您会想知道为什么您要花时间做这些死记硬背的东西，而实际上您很聪明并且实际上可能正在某处的价值。

我们书中“Bob the Builder”综合症的症状：

1.  所有对构建或某种类型的构建的请求都通过个人或小团队进行。
    2.  对于开发人员来说，对这些构建请求的响应速度非常慢。如果构建团队正在吃午饭，他们会等上几个小时。
    3.  Bob 或 Bobs 团队花费大量时间做死记硬背的任务。
    4.  Bobs 回家一天、去吃午饭、去度假或生病会阻碍团队完成工作的能力。

我们告诉我们的[AnthillPro](http://www.anthillpro.com)客户将所有这些东西推到他们的自动化中。拥有两种使用不同机器、不同内部版本号等的构建类型应该不是问题。

第一步是简化流程。尽可能多地消除复杂性，以便您可以进入“训练有素的猴子”过程。一旦你有东西接近那个，用电脑代替猴子就很容易了。

我会给出更具体的建议，但除了混乱之外，我认为您没有告诉我们复杂性来自何处。有时在这种情况下，您需要攻击混乱和不良做法。您是否正在执行“源代码中的此基线以及这两个文件和这三个文件”的构建？这会很棘手，并且可能需要循环中的 CMer。想办法禁止它。将其替换为“创建一个分支，并对该分支进行特定更改”使得该猴子可以构建构建。

您应该能够将这些更改视为高风险。即使你很好，你也会有糟糕的日子，并希望尽可能地排除人为错误。同时，如果您希望更快地响应开发人员和自助服务（大概是开发和管理人员想要的），则需要使某些事情变得可自动化/可猴子化。

在此期间，拥有更好的形式可能会很好，并且使用好你的工具总是很好，但我会非常积极地解决“训练有素的猴子”问题。任何受过训练的猴子（或计算机）无法完成的事情都应该成为退出流程的候选者。一旦你把它降到“训练有素的猴子”状态，让你的构建自动化到位，这样你和开发人员都不需要成为猴子。这会将您的角色从“Bob the Builder”更改为“Bob the Build System Owner”。

            回答 #2

赞同：1

时间：2009-01-28T06:57:37.780

简化构建步骤，以便可以在简单的文档中将它们捕获为一系列命令 - 训练有素的猴子应该能够与构建一起运行（嗯..不是侮辱而是 - 你明白了:-)）

如果这是可能的，那么应该可以通过脚本一步运行构建（可能是 ant、bash、maven 或任何脚本）。这应该是目标，所以基本上任何人都可以进行构建。

            回答 #3

赞同：0

时间：2009-01-28T16:27:18.193

开发构建过程的目标应该是：

1.  从任何地方的空目录开始（如果你愿意的话，可以用白板）
2.  确保安装了非常小的基本工具（对我来说通常是 Java + Maven + SVN 命令行客户端）
3.  从您的 SVN/CVS/...中检出一个*目录*
4.  启动单个命令（这意味着没有 25 个参数的命令）
5.  等待（可能很长一段时间）
6.  拥有完整的构建

如果你不能这样做，那么你的构建过程仍然不够好。

如果你认为你不能实现它，那么详细描述你需要做的除了那个列表之外的哪些动作是图灵完备的机器无法做到的。

通常没有这样的点。这只是缺少的工具/诀窍/动机。我个人发现这样做比描述为什么不能这样做更容易。

祝你好运。

        c# - 为什么 C# 设计器生成的代码（如 Form1.designer.cs）会对 Subversion 造成严重破坏？

ID：486670

赞同：19

时间：2009-01-28T06:33:55.067

标签：c#, visual-studio, svn, version-control, windows-forms-designer

我的工作室最近从 SourceSafe 切换到 Subversion，使我们摆脱了自动锁定。这导致了表单的并发编辑，这很棒。但是当多个开发人员提交他们的更改时，设计人员创建的代码文件（所有名为 的文件`TheFormName.designer.cs`）会引起冲突，很难解决。

据我所知，这是因为每当用户修改它时，设计器生成的代码都会被大量重新排列，无论实际的改变有多么小。

*   如何让这些冲突更容易解决？
*   有没有办法告诉设计者少修改代码？
*   经验丰富的 C# 团队如何处理表单的并发修改？

            回答 #1

赞同：10

时间：2009-01-28T07:20:16.923

以下是一些可以尝试的事情：

*   使事情更加模块化。使用用户控件等组件将表单拆分为多个较小的物理文件。
*   使用 MVP 等表示层设计模式将代码移出视图并移入标准 POCO 类。
*   最新版本的 SVN 允许您使用硬锁 - 使用它来避免复杂的合并场景。

希望有帮助。

            回答 #2

赞同：3

时间：2009-01-31T18:10:22.313

我很确定这个问题没有灵丹妙药，因为设计师踩遍了designer.cs。

我所能建议的就是尽量减少设计师的使用。就我个人而言，我只挂钩代码中的事件，并且只使用设计器进行初始化和定位。因此，理解变更集的差异并不难（“哦，有人添加了一个按钮”，“哦，有人稍微改变了它的外观”）。

            回答 #3

赞同：3

时间：2012-10-23T17:16:00.750

是的，设计师的随意重新排列确实很烦人。Microsoft 是否使用自己的工具？Microsoft 是否会查看他们检查到版本控制的内容？它令人难以置信。

我们团队的“解决方案”是在编辑完 Designer 文件后手动编辑它们，将内容放回原来的位置，这样基于文本的差异就可以阅读，从而可以合理地合并并发更改。幸运的是，Visual Studio 的大部分重新排列都是简单的，所以这是可行的。

遗憾的是，我们发现此步骤对于验证正确性是必要的——我们发现了 Designer 默默删除所需内容的情况，从而导致代码损坏。因此，必须完成此步骤才能解决潜伏在内部的任何破坏数据的错误。叹。

由于微软在修复其错误方面的记录很差，唯一的解决方案可能是改进[Mono 的 WinForms Designer](http://www.mono-project.com/WinForms_Designer)，以便为黄金时间做好准备。

            回答 #4

赞同：2

时间：2009-02-01T03:06:37.880

我不熟悉 C# 或 Windows 窗体设计器，但查看一些`designer.cs`我可以在网上找到的文件，它们的结构并不特别复杂。
它的哪些部分正在重新安排？`InitializeComponent()`我想这主要是混乱的方法中的属性顺序？
如果是这种情况，您也许可以编写一个简单的脚本，按字母顺序重新排序这些行，比如说（尤其是如果您从未手动编辑这些文件），并将其用作 Subversion 中的[预提交挂钩脚本](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.create.html#svn.reposadmin.create.hooks)。
嗯，对……从头开始。该部分底部的大红色框表示您不应该修改挂钩脚本中的事务。但是您可能能够找到另一种方法来在`designer.cs`文件被更改和被提交之间的某个地方运行该脚本。
编辑：
实际上，鉴于 scraimer 对此的评论：

完全破解，但在最坏的情况下，就在合并之前，我可以对两个文件进行排序，并使合并简单地逐行处理......

你不能让Subversion设置一个外部合并程序吗？我一直在使用[KDiff3](http://kdiff3.sourceforge.net/)，它可以[在执行 diffs 或 merges 之前运行预处理器命令](http://kdiff3.sourceforge.net/doc/preprocessors.html)，因此您可以自动化该过程。

            回答 #5

赞同：0

时间：2009-02-01T20:20:23.330

我知道在使用诸如颠覆之类的合并样式源代码控制系统时真正避免此问题的唯一方法是手动编写表单代码而不使用设计器。显然，这并不好，因为手动编码这些表单可能需要一段时间。

发生这种情况的原因是控件属性由设计器按照它们在窗体上的放置顺序进行序列化。剪切和粘贴可以影响此顺序以及移动控件以使其具有新的父级（例如将控件移动到面板上，而该控件以前直接位于窗体上）。

我在一个大型项目中遇到了这个问题，不得不采用一种相当丑陋的方法 - 将 Designer.cs 文件与签入目标修订版进行比较，并使用合并工具手动合并它们。这并不理想，但这是我看到它与 svn 或其他合并样式源代码控制工具一致工作的唯一方法。

正如其他人所指出的那样，另一种选择是使用带有源代码控制的锁定方法，但这也带来了令人不快的副作用。

        writing - 关于如何最好地向外国观众展示节目

ID：486680

赞同：4

时间：2009-01-28T06:40:58.093

标签：writing

我现在正在写一部小说，虽然编程不会受到太多关注，但我确实想至少让读者明白一个角色的编码背景可能会导致他们成为这样的人各种各样的东西。

所以，我的问题是：你认为以读者在不被吓跑的情况下获得一点理解的方式来谈论艺术的最佳方式是什么？我应该在这里和那里放弃“听起来很聪明”的关键字吗？包括一些实际代码？欢迎所有建议...

            回答 #1

赞同：2

时间：2009-01-28T08:46:14.147

谈论情绪，谈论程序员在工作时的感受。谈论他怀疑的时刻，他的骄傲时刻。

谈谈他与经理、同事、朋友和家人的关系。

如果您希望读者对您的角色产生同理心，请谈论程序员生活方式中普遍存在的东西，而不是具体的东西。

与小说无关，但却是讲故事的绝佳基础：看看Robert McKee 的[Story](https://rads.stackoverflow.com/amzn/click/com/0060391685)。

            回答 #2

赞同：1

时间：2009-01-28T17:10:56.340

我读过[龙纹身的女孩](http://en.wikipedia.org/wiki/The_Girl_with_the_Dragon_Tattoo)，现在我正在读[玩火的女孩（](http://en.wikipedia.org/wiki/The_Girl_Who_Played_with_Fire)[斯蒂格·拉尔森](http://en.wikipedia.org/wiki/Stieg_Larsson)的三部曲）。

主角是 Salander，一个 26 岁的女孩，擅长黑客攻击。作者在解释她如何实现这一点的细节方面做得非常好——保持简单，并解释了对角色和主要情节的连锁反应。

阅读技术术语可能真的很无聊（并且令人困惑），但如果术语很简单并且它直接影响到*从腐败公司骗取 30 亿美元*的角色，那么它是一个很好的阅读。

            回答 #3

赞同：1

时间：2009-01-28T06:51:11.867

编程就像解决一个拼图，其中的图片总是在变化，而棋子的数量是随机的。这就是编程，在过去，程序员曾经是天才，因为需要有创造力和创造力。提供令人难以置信的解决方案..

软件工程正在使编程的定义在日常工作中变得可行（可预测、可管理）。

程序员工作的演变为我们提供了一些工具，这些工具可以最大限度地减少基本任务所需的天才数量，以便我们可以将同样的天才集中在几年前无法想象的任务上。

编程的未来正在想出一些不可思议的方法来做今天不可能的美妙事情。

            回答 #4

赞同：1

时间：2009-01-28T09:28:56.133

软件开发的独特之处在于结果很快就会被看到，结果也可以很快被复制。这就是为什么软件开发人员可以通过几次击键来改变重要的事情（希望变得更好）。你应该展示几个简单的正面例子，说明开发人员如何将他所从事的项目中的某些东西改得更好，而其他人会立即认识到这一点。我认为这可以在没有智能关键字的情况下完成，除了大多数人已经知道的关键字（如服务器、程序、网页）。

            回答 #5

赞同：0

时间：2009-01-28T07:50:40.200

让不是程序员的角色之一与程序员互动。程序员将不得不向外行解释有关该问题的一些信息。这个解释可以

*   设置一个未来的故事点，在那里被解释的事情将变得重要或有用。
*   做一些程序员的性格发展
*   可能本身就很有趣

祝你好运！

            回答 #6

赞同：0

时间：2009-01-28T08:22:53.147

1.  将编程与任何现实世界的活动联系起来，例如“唱歌、跳舞、烹饪、钓鱼”等。

2.  一旦你选择了那个，（例如，烹饪），你可以继续比较烹饪和编程所涉及的活动。

3.  要进行烹饪（编码），您需要知道要烹饪什么（软件要求）。然后你需要用具（工具），你需要花时间做饭（开发时间），你需要通知等待食物的人发生了什么事（状态更新），品尝一次食物以确保盐，香料等是正确（测试），您需要以良好的方式安排食物（包装，文档），服务（交付），接受反馈并改进:)

        sql - 找出何时进行数据库备份

ID：486685

赞同：2

时间：2009-01-28T06:42:52.367

标签：sql, sql-server, database, restore

伙计们，

假设您收到一个断开连接的 SQL Server 数据库（2005 或 2008）备份，并将其还原到 SQL Server 实例。

有没有办法，是否有系统目录或其他东西，可以找出该特定数据库上最后一次写入操作的时间？我希望能够找出特定数据库备份的日期 - 不幸的是，这并没有真正被明确记录在任何地方，并且检查所有数十个数据表的最高日期/时间戳也不是一个真正的选择……

有任何想法吗？当然 - 我可以查看 *.bak 文件的日期/时间戳 - 但我可以从 SQL Server (Management Studio) 中更准确地找到吗？

谢谢！马克

            回答 #1

赞同：2

时间：2009-01-28T10:38:15.963

如果您有权访问最初运行备份的 SQL Server 实例，您应该能够查询`msdb`：

```
SELECT backup_set_id, backup_start_date, backup_finish_date
FROM  msdb.dbo.backupset  
WHERE database_name = 'MyDBname' AND type = 'D' 
```

有几个与备份集相关的表：

*   backupfile -- 每个备份的数据文件或日志文件包含一行
*   backupmediafamily -- 每个媒体系列包含一行
*   backupmediaset -- 每个备份媒体集包含一行
*   backupset -- 每个备份集包含一行

通过查询这些表，您可以确定上次备份发生的时间、发生的备份类型以及文件写入的位置。

            回答 #2

赞同：1

时间：2009-05-20T17:04:31.983

您可以尝试`RESTORE HEADERONLY`使用您的备份文件，如此[处所述](http://msdn.microsoft.com/en-us/library/aa238455(SQL.80).aspx)

这应该会给你你正在寻找的信息。

            回答 #3

赞同：1

时间：2009-08-01T11:34:08.987

有点晚了，但应该是你想要的。

对数据库的每次写入都是日志文件中的一个条目。其中有一个 LSN。这必须至少存储在备份中以进行日志恢复。

那么，如何将 LSN 与日期时间匹配？

```
SELECT TOP 5 [End Time] AS BringFirst, *
FROM ::fn_dblog (NULL, NULL)
WHERE [End Time] IS NOT NULL
ORDER BY BringFirst DESC 
```

我以前从未使用过它（只是对此答案有所了解）。一些写入很可能是备份本身的一部分，但您应该能够通过一些探索来区分它们。

            回答 #4

赞同：0

时间：2009-01-28T10:26:21.370

据我所知，在主数据库中存在一个日志表，其中每次写入都存储有详细信息。但我不确定您是否需要启用日志机制 - 以便默认情况下不记录并且您必须启用它。例如，在 Oracle 中，存在一个可以查询的系统数据库表 Log。

如果不是这种情况 - 您仍然可以为自己编写一个触发器并将其应用于所需的每个表/列并自己进行日志记录。

        mbunit - MbUnit - 在 TestFixtureTearDown 中获取测试失败/成功结果

ID：486696

赞同：2

时间：2009-01-28T06:47:46.880

标签：mbunit

我正在使用 MbUnit 进行一些集成测试。在 TestFixtureSetUp 中，我创建了一个新的数据库实例（使用 GUID 作为数据库名称）。在拆解中，我将其删除。

但是，如果测试失败，我想让数据库保持活动状态（这样我可以调查）。有没有办法从我的 TestFixtureTearDown 判断测试是通过还是失败？

在代码中它看起来像：

```
[TestFixtureTearDown]
public void Stop()
{
    if (/* All tests passed */)
    {
       Database.Dispose();
    }
} 
```

            回答 #1

赞同：5

时间：2009-01-28T20:28:09.627

在 MbUnit v3 中，您使用：TestContext.Current.Outcome.Status == TestStatus.Passed

请注意，在 MbUnit v3 中，[TestFixtureSetUp] 被重命名为 [FixtureSetUp]。

        javascript - ActionScript/JavaScript 中的短路运算符在哪里？

ID：486697

赞同：1

时间：2009-01-28T06:48:11.917

标签：javascript, actionscript, operators, short-circuiting

像 VB 有运算符[AndAlso](http://msdn.microsoft.com/en-us/library/cb8x3kfz(VS.80).aspx)和[OrElse](http://msdn.microsoft.com/en-us/library/ea1sssb2(VS.71).aspx)，它们执行**短路**逻辑连接，在 JS / AS 中哪里可以找到等效的运算符？

            回答 #1

赞同：2

时间：2009-01-28T06:55:38.113

正常的 && 和 || 运营商进行短路评估。

            回答 #2

赞同：1

时间：2009-01-28T06:58:06.437

据我所知，JS 和 AS 默认使用短路。

默认值可能是一个很好的例子：

```
var value = input || false;  // defaults: non-zero `input` or `false` 
```

三元是另一个——只执行需要的块：

```
return typeof(value) == 'string' ? value.substr(0, 2) : ''; 
```

        javascript - 为什么在执行过程中动态修改 JavaScript 函数的代码是一件坏事？

ID：486702

赞同：1

时间：2009-01-28T06:52:35.247

标签：javascript, dynamic, function

几天前，我问了一个关于在外部脚本执行过程中动态修改函数代码的问题，我被告知完全忘记这个概念。我不确定我明白为什么会这样。让我举个例子：

```
<script>
var display = function(msg)
 {
alert(msg);
 }

// Now, at the moment, the display() function
// is receiving a single parameter and alerting
// it to the user. I'm now going to use eval()
// to modify the display() function.

eval('display = ' + display.toString().replace('alert(', 'document.write('));

// Now, the display() function writes its parameter
// to the document as opposed to alerting it.
</script> 
```

我意识到这是一个相当微不足道的例子，但肯定有一些用途可以从能够动态修改函数中派生出来，这本身就非常有用。

            回答 #1

赞同：8

时间：2009-01-28T07:08:19.070

尽管这可能会满足您的需求，但从现在起 6 个月后，您（或维护您的代码的人）将会“WTF？！”

如果您的用例是根据某些条件发出警报或写入，为什么不编写两个不同的函数呢？或者让您的函数采用另一个决定输出模式的参数。或者传入一个函数作为执行实际输出的参数。有些东西，你知道，在理智的一面多*一点。*;-)

            回答 #2

赞同：5

时间：2009-01-28T07:05:54.800

在某些情况下，改变函数的行为可能很有用，但有更好的方法来做到这一点。在您的示例中，您可以通过将函数作为参数传递（类似于策略模式）来创建以不同方式处理输出的函数的新实例：

```
function makeDisplay(displayStrategy) {
    return function(msg) {
        // I'm assuming you would do some additional processing here...

        displayStrategy(msg);
    }
}

var display = makeDisplay(alert);

// now modify display to use document.write
display = makeDisplay(function(msg) { document.write(msg); }); 
```

            回答 #3

赞同：0

时间：2009-01-28T06:58:20.073

好吧，使用`eval`可能是一个安全问题，但实时修改功能是可以的。无论如何，你还能怎么做记忆？

虽然想一想，改变方法签名不是一个好主意，但其他人不会知道如何调用这个函数，因为它取决于执行顺序，通常不容易跟踪。

            回答 #4

赞同：0

时间：2014-02-05T14:24:11.050

我发现自己需要在没有特定供应商 javascript 的源代码的情况下执行此操作；所以这可能是一个合法的用例。我同意，如果您有其他选择，最好以更有条理的方式进行，将原始功能编辑为更灵活。

        javascript - 可以使用 Javascript 刷新浏览器窗口吗？

ID：486706

赞同：5

时间：2009-01-28T06:54:30.300

标签：javascript, firefox, browser

就像许多程序在**任务栏/扩展坞上****闪烁**窗口以提醒用户切换到程序一样， 是否可以使用 Javascript刷新**浏览器窗口？***（也欢迎使用仅限 FireFox 的脚本）*

这对于有大量**实时**活动的基于网络的聊天/论坛/社区软件很有用。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-28T07:00:15.403

在这一点上，似乎只有弹出一个警报对话框才能解决问题......我觉得这似乎有点太侵入性了，特别是考虑到你试图使用它。但是，您可以修改 document.title 以吸引用户的注意力，而不是让它闪烁，方法是在站点名称前添加一些信号（可能是字符串“NEW！”），然后使用间隔不断将其更改为“”，然后会产生一个很好的“闪烁”错觉。

简单的例子：

```
<html>
<head>
<title>Chat System</title>
<script>
var timer, old_t = document.title, blink_amount = 5, cur_b = 0;
function notify()
 {
cur_b = 0;
timer = setInterval(function()
 {
if (cur_b < blink_amount * 2)
 {
cur_b++;
document.title = (document.title.indexOf('NEW! ') != -1) ? old_t : 'NEW! ' + old_t;
 }
else
 {
clearInterval(timer);
 }
 }, 600);
 }

notify();

// From here, it's just a matter of calling the
// notify() function whenever you detect a new message.
</script>
</head>
<body>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-23T11:34:29.413

@Hexagon Theory：你为什么要重写整个 head 元素只是为了改变 head 中一个元素的值？您的解决方案在多个级别上都非常低效。

```
<html>
<head>
<link rel="icon" href="on.png" type="image/png" id="changeMe" />
<script type="text/javascript" src="flash.js"></script>
</head>
<body>
</body>
</html> 
```

flash.js：

```
function Flasher(speed) {
  var elem = document.getElementById('changeMe');

  this.timer = setTimeout(function() {
    elem.href = elem.href ==  'on.png' ? 'off.png' : 'on.png';
  }, speed);

  this.stop = function() { clearTimeout(this.timer); }
}

/* sample usage
 *
 * var flasher = new Flasher(1000);
 * flasher.stop();
 */ 
```

它不一定是一个类，但它有助于保持全局命名空间的清洁。这是未经测试的，但如果由于某种原因简单地更改 href 不起作用，请克隆链接节点，更改 href 并用克隆的链接替换旧链接。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-08T15:10:12.483

嘿，这个问题的另一个有趣的解决方案刚刚击中了我。为什么不通过让图标在浏览器中闪烁来*真正*吸引用户的注意力呢？例如，您可以制作两个图标（在下面的示例中为**on.png**和**off.png**）并反复交换它们以真正吸引用户的眼球。以下是一个简单的实现；请记住，您*需要*远程引用此脚本或将其放在页面正文中，因为它使用一种重复**替换**`<head>`标记内容的方法。不过，试一试；我更喜欢它的简单性。

page.html：

```
<html>
<head>
<link rel="icon" href="on.png" type="image/png" />
<script type="text/javascript" src="flash.js"></script>
</head>
<body>
</body>
</html> 
```

flash.js：

```
var timer, speed = 175;
function flash()
 {
head_html = document.getElementsByTagName('head')[0].innerHTML;
if (head_html.indexOf('href="on.png"') != -1)
document.getElementsByTagName('head')[0].innerHTML = head_html.replace('on.png', 'off.png');
else
document.getElementsByTagName('head')[0].innerHTML = head_html.replace('off.png', 'on.png');
timer = setTimeout('flash()', speed);
 }

function kill_flash() {clearTimeout(timer);}

flash(); 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-08-05T21:17:09.487

我刚刚为 Firefox 发现了[window.getAttention()](https://developer.mozilla.org/en/DOM/window.getAttention)，但它仅在插件调用它时才有效。

*   **Windows** , 窗口的任务栏按钮闪烁

*   **Linux**，一些窗口管理器闪烁任务栏按钮，另一些则立即聚焦窗口

*   **Macintosh**，桌面右上角的图标闪烁

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T07:03:15.787

Window.Focus() 应该在 Windows 上执行此操作，但不确定在其他平台上。如果窗口被最小化，您可能会发现它会将窗口带到前台，这将非常烦人:)

# php - 在 PHP 中使用类有哪些有用的方法？

> ID：486714
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T06:58:19.417
> 
>         
> 
> 标签：php, class

我已经学会了如何在 PHP 中使用类，但到目前为止，我只真正为它们找到了一个有用的应用程序。我创建了一个用户类来执行与我的 Web 应用程序中的用户相关的各种任务，例如输出头像、显示消息数量等。

除了这个例子之外，还有哪些其他有用的方法可以在实际意义上利用类？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T07:02:46.990

我一直使用数据库类。

这里有几个例子：

[http://www.massless.org/_tests/phpdb/](http://www.massless.org/_tests/phpdb/)

[http://slaout.linux62.org/php/index.html](http://slaout.linux62.org/php/index.html)

[http://www.tonymarston.net/php-mysql/databaseobjects.html](http://www.tonymarston.net/php-mysql/databaseobjects.html)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T07:12:19.467

阅读其他人的代码并了解他们如何将事物分成类是一个非常好的主意。查看一些[PEAR](http://pear.php.net)模块或框架（[Zend](http://framework.zend.com)、[Symfony](http://www.symfony-project.org)、Cake）。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T18:55:20.437

任何时候你可以定义一个“做事”的“事物”，你就有了一个定义对象的候选者。两个来自 PHP 标准库的具体示例立即浮现在脑海：

*   许多数据库模块使用对象进行连接、查询和结果。

*   DateTime 类使用输入和输出格式、时区转换和日期算术封装了时间的通用概念。

问题是，面向对象编程是一个伟大的想法——你可以以面向对象的方式解决几乎任何编程问题。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T07:05:24.737

我已经构建了一个实用程序类，它使[`mail()`](http://php.net/manual/en/function.mail.php)函数的使用人性化，我经常使用它。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T07:16:06.293

通过使用类（例如上面提到的 PEAR 包，其他），您可以利用已经编写和测试的代码来执行常见任务。

也可以帮助您不要重新发明轮子。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-29T01:56:03.363

我强烈建议学习[设计模式][1]。他们中的许多人都很好地利用了类并解决了常见的编程问题。特别是工厂和抽象工厂模式是一个很好的起点。

还有一本名为[PHP Hacks](http://oreilly.com/catalog/9780596101398/)的优秀书籍，其中有一章是关于在 PHP 中实现许多不同的模式，所以你可能想看看。

此外，探索 PHP 中的一些内置对象，了解它们是如何工作的并获得更多想法：

*   PDO

*   数组对象

*   简单XML元素

*   目录迭代器

    [1]：[http://en.wikipedia.org/wiki/Design_pattern_(computer_science)](http://en.wikipedia.org/wiki/Design_pattern_(computer_science)) “设计模式”

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-30T00:12:20.930

> 我创建了一个用户类来执行与我的 Web 应用程序中的用户相关的各种任务，例如输出头像、显示消息数量等。

查看[http://en.wikipedia.org/wiki/Cohesion_(computer_science)](http://en.wikipedia.org/wiki/Cohesion_(computer_science))

你的例子听起来像逻辑凝聚力。

以功能凝聚力为目标。每个类都执行特定的任务，并使类尽可能**通用**，您会发现可以一遍又一遍地重用它们。

Symfony 的 sfParameterHolder 就是一个很好的例子：

[http://www.symfony-project.org/book/1_2/02-Exploring-Symfony-s-Code#chapter_02_sub_parameter_holders](http://www.symfony-project.org/book/1_2/02-Exploring-Symfony-s-Code#chapter_02_sub_parameter_holders)

Symfony 使用它来保存视图模板的变量（在 MVC 中），将请求参数存储在 Web 请求对象（它本身是一个代表所有请求参数的类，尽职尽责地去除反斜杠等），在 sfUser 类中存储所有参数最终进入 $_SESSION 等。

下载 Symfony 的“沙盒”，进入 /lib/symfony/ 文件夹并从中学习。它很复杂，但恕我直言，代码非常干净。

[http://www.symfony-project.org/installation](http://www.symfony-project.org/installation)

Zend 也不错，但是包含文件的数量可能会很大，而且我个人不喜欢它们的命名约定，尤其是使用下划线前缀。

# ruby-on-rails - Rails 路由

> ID：486716
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T06:58:22.303
> 
>         
> 
> 标签：ruby-on-rails, yui, rails-routing

我在 Rails 上建立了一个新门户，可以这样访问：[https ://xyz.com](https://xyz.com)

这样做的问题是：1.) 它有 2 个选项卡——“ShipmentInfo”、“Aging Shipments Dashboard”都使用实现

```
<li> tags and YUI library’s tabview.
    <ul class="yui-nav">
        <li id="tab1" class="selected"><a href="#tab1">Shipment Info</a></li>
        <li id="tab2"><a href="#tab2">Aging Shipments Dashboard</a></li>
    </ul> 
```

2.) 当我点击“Aging Shipments Dashboard”选项卡时 – url 应该是 – [https://xyz.com/#tab2](https://xyz.com/#tab2)但你只能看到[https://xyz.com](https://xyz.com)。我认为这是因为 Tabs 的客户端实现。

3.) 在我单击该选项卡中的“当前摘要”按钮后，我得到了相应的结果，但不是向我显示设置为“Aging Shipments Dashboard”的活动选项卡，而是始终设置为“ShipmentInfo”选项卡。

如何将 activeTab 设置为将结果获取到已发出请求的相应选项卡？所有表单请求都使用 GET 方法。

或者有没有一种方法可以让我在 routes.rb 中明确提及，基于 activeTab 应该设置为“Aging Shipments Dashboard”的参数？

谢谢，拉贾。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T07:56:12.640

据我所知，无论 YUI 将其转换`ul`为一组选项卡所做的任何事情，都可能`href`与`li`. 我认为您应该验证生成标签的使用语法。

继续前进，`href`链接仅指向当前页面中的锚点。这意味着客户端（浏览器）不必发送 HTTP 请求来重新获取当前页面。*我不*认为现代浏览器会这样做。我怀疑他们发送 URL 的锚部分（ 之后的部分`#`），因为 HTTP 服务器不关心该信息。

这相当于，当用户单击选项卡时，您的 rails 应用程序永远不会收到通知，并且永远不会获得 URL 之后的部分`#`。所以你不能在路由表中放置任何关于它的规则。

编辑：我忘了告诉你真正应该发生什么。

1.  根据您的描述，YUI（或其他一些 javascript 代码）应附加到`li`看起来像选项卡的 onClick 上。

2.  当用户单击选项卡时，它会读取 URL，并以某种方式判断要显示为选项卡内容的 content-tag。例如，这可能是一个`div`包含第二个选项卡内容的 a，它可能有一个`id`of`tab2`或其他东西。

3.  然后它使当前选项卡的内容不可见。通常使用 CSS`display`属性完成，将其设置为`display: none`.

4.  最后，被点击的选项卡的内容是可见的。这将使用`display: block`或类似的东西来完成。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-29T07:25:21.360

是的。您可能已经在您的 routes.rb 文件的末尾有这些行：

map.connect ':controller/:action/:id' map.connect ':controller/:action/:id.:format'

将它们更改为：

map.connect '#:controller' map.connect ':controller/:action/:id' map.connect ':controller/:action/:id.:format'

通过这种方式，您可以在 rails 应用程序中将这两个变量定义为不同的控制器。您也可以执行与两个操作相同的操作，但这是您的决定。

# vb6 - 为什么短路不是 VB 中的默认行为？

> ID：486722
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-01-28T07:03:22.310
> 
>         
> 
> 标签：vb6, operators, language-design, short-circuiting

VB 有运算符[AndAlso](http://msdn.microsoft.com/en-us/library/cb8x3kfz(VS.80).aspx)和[OrElse](http://msdn.microsoft.com/en-us/library/ea1sssb2(VS.71).aspx)，它们执行**短路**逻辑连接。

为什么这不是**And**和**Or**表达式的默认行为，因为短路在每种情况下都很有用。

奇怪的是，这与**&&**和**||**的大多数语言**相反。**进行短路。

 ***** * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-01-28T07:09:44.293

因为 VB 团队必须保持与旧代码（和程序员！）的向后兼容性

如果短路是默认行为，则编译器会错误地解释**按位运算。**

Panopticon Central[的AndAlso和OrElse民谣](http://www.panopticoncentral.net/2003/08/18/the-ballad-of-andalso-and-orelse/)

> 我们的第一个想法是**逻辑运算比位运算更常见**，所以我们应该让 And 和 Or 成为逻辑运算符，并添加新的按位运算符 BitAnd、BitOr、BitXor 和 BitNot（最后两个是为了完整性）。然而，在其中一个测试版中，很明显这是一个非常糟糕的主意。**忘记新运算符存在**并使用 And的 VB 用户，当他指的是 BitAnd 和 Or 当他指的是 BitOr 时，他会得到编译但产生“坏”结果的代码。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T07:14:07.280

我并不认为短路在每种情况下都有用。我只在需要时使用它。例如，在检查两个不同且未连接的变量时，不需要：

```
 If x > y And y > z Then

  End If 
```

正如 Paul Vick 的文章所说明的（参见上面 Ken Browning 提供的链接），短路有用的完美场景是首先检查对象是否存在，然后评估其属性之一。

```
 If x IsNot Nothing AndAlso x.Someproperty > 0 Then

  End If 
```

因此，在我看来，这两种语法选项都是非常需要的。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T13:40:10.260

显式短路确保首先评估左操作数。

在 VB 以外的某些语言中，逻辑运算符可能会执行隐式短路，但可能会首先计算右运算符（例如取决于逻辑运算符左侧和右侧表达式的复杂性）。

# sql-server - 使用只读列查看

> ID：486724
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T07:04:52.570
> 
>         
> 
> 标签：sql-server

您好我想设计一个查询，其中列不可更新，但其余列是。

我怎样才能做到这一点？

问候

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2016-09-16T08:02:56.627

我知道这是一个老问题，但我在搜索档案时遇到了它，并且（我认为）有一个更好的解决方案。原始海报此时可能不在乎，但它可能会帮助其他人研究同样的问题。

如果您在视图中定义了某个操作的结果想要使其成为只读的字段，它会自动不可更新，这比创建和维护触发器要少得多。

就我而言，我有一个 aux 表的连接，我想在其中显示连接字段，但不允许任何人更改它，因为它会更改所有连接记录，而不仅仅是正在编辑的记录。该字段是一个简单的文本，名为 Pristup。我所做的只是将视图中的字段定义为：

LTrim(Pristup) Pristup

这保持相同的名称，但无论权限如何，内容都不能更改。简单，彻底有效。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T07:09:43.293

好吧，我认为您需要在视图上使用 INSTEAD OF 触发器，以便不会直接更新基表。

这是一篇解释它们的文章。  [文章](http://msdn.microsoft.com/en-us/library/aa224818(SQL.80).aspx)

另一个例子。示例代码如下所示。  [第二条](http://msdn.microsoft.com/en-us/magazine/cc164047.aspx)

**示例**
（当然，您需要修改它以适合您的视图。）

```
CREATE TRIGGER tr_Employees_U on Employees FOR UPDATE AS
    IF UPDATE(lastname)
    BEGIN
        RAISERROR ('cannot change lastname', 16, 1)
        ROLLBACK TRAN
        RETURN
    END
GO 
```

使用触发器：

1）他们尝试更新该列的错误

2）只是不要更新该列

那么你应该被设置。

# regex - 帮助正则表达式模式

> ID：486730
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-01-28T07:07:39.960
> 
>         
> 
> 标签：regex

我需要一些关于正则表达式的帮助。

1.  我有一个模式 AB.* ，这个模式应该匹配 AB.CD AB.CDX (AB.whatever) 之类的字符串。等等..但它不应该匹配 AB,AB.CD.CD ,AB.CD 之类的字符串. AB.CD.CD 即，如果它在字符串中遇到第二个点。这是什么正则表达式？

2.  我有一个模式 AB.** ，这个模式应该匹配 AB,AB.CD.CD, AB.CD 之类的字符串。AB.CD.CD 但不是 AB.CD 、AB.CDX、AB.whatever 之类的字符串，这是什么正则表达式？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T07:10:48.737

看起来你有 glob 而不是正则表达式。点匹配任何字符，* 使前一个元素匹配任何 0 次以上。

1）`AB\.[^.]*`
转义第一个点，使其匹配文字点，然后匹配点以外的任何字符，任意次数。

2)`"^(AB)|(AB\.[^.]*\.[^.]*$"`
这匹配`AB`或`AB`后跟`.<stuff>.<stuff>`

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T07:17:03.653

[http://www.regular-expressions.info/](http://www.regular-expressions.info/)包含许多有用的信息，可用于学习正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T07:24:05.417

如果您的正则表达式引擎支持负前瞻，您可以尝试以下操作：

```
^AB\.[^.]+$
^AB(?!\.[^.]+$) 
```

（或者

```
^AB\.[^.]*$
^AB(?!\.[^.]*$) 
```

如果你想允许 AB。)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T07:24:26.243

我发现您的问题并不完全清楚；如果我弄错了，请在此处发表评论（如果您无法添加评论，请编辑您的问题），但我认为您正在寻找的是：

1) 匹配字符串“AB.AnyTextHereWithoutDots”，但不匹配“AB”或“AB.foo”。ETC

如果是这样，匹配的正则表达式将是：

```
"^AB\.[^.]*$" 
```

2) 匹配 "AB" 或 "AB.something.something" 没有或两个或多个点

如果是这样，匹配的正则表达式将类似于：

```
"^AB(\..*\..*)?$" or "'^AB\(\..*\..*\)\?" (depending on the nature of your regex engine) 
```

正如[Douglas 建议](https://stackoverflow.com/questions/486730/help-with-regex-patterns#486735)的那样，与 glob 匹配可能会更容易。

正如[spdenne 建议](https://stackoverflow.com/questions/486730/help-with-regex-patterns#486746)的那样，找到一个好的正则表达式参考。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T07:34:36.833

我在vim中试过这个。这是示例数据：

```
AB.CD
AB.CDX
AB.whatever
AB
AB.CD.CD
AB.CD.
AB.CD.CD 
```

这是我的正则表达式

1.  这会捕获以 AB 开头的所有行，然后需要一个文字点，然后过滤掉所有具有第二个点的行。

    ^AB\.[^.]*$

2.  这将捕获所有只是 AB 的行（管道之前的部分）或以 AB 开头的行，后跟两个文字点（用反斜杠转义）

    ^AB$\|^AB\.. *\..* $

# iphone - 你能帮我理解可可/objective-c 中的保留计数吗？

> ID：486748
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-28T07:18:41.123
> 
>         
> 
> 标签：iphone, objective-c, cocoa, memory-management

```
> .h file:
NSString *myString;
@property (nonatomic, retain) NSString *myString;

> .m file:
self.myString = [[NSString alloc] init]; 
```

如果我没记错的话，我最终会得到一个保留计数为 +2 的 NSString 实例。对？

我很好奇，因为 Apple 的 Location 示例使用了“self”。用于初始化。为什么？我检查了一下，它确实显示保留计数为 +2。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-01-28T07:45:40.897

要回答您的第一个问题：

是的，保留计数将是两个。

* * *

回答你的第二个问题：

使用原因：

```
self.myString = x; 
```

这相当于：

```
[self setMyString:x]; 
```

以便正确执行所有属性处理代码。这包括 KVO 通知，以及在传入时自动保留 x 的代码。

如果您要简单地设置：

```
myString = x; 
```

在 .m 文件中，您将绕过所有隐藏的属性设置代码，只需将 myString 成员变量设置为指向 x 的指针。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T07:34:51.077

穆斯塔法：是的，你是对的。（该属性应声明为`copy`, not `retain`，但这是另一回事。）

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-29T05:07:26.550

在您的修改 1 中，您将实例变量直接设置为自动释放的对象。这意味着在事件循环结束时，您`locationManager`将被释放，在这种情况下，您将获得对现在未使用的内存块的引用。

您的修改 2 在我看来是正确的，您开始的示例代码也是如此。

# .net - 比较两个 .NET Array 对象

> ID：486749
> 
>         
> 
> 赞同：25
> 
>         
> 
> 时间：2009-01-28T07:19:09.470
> 
>         
> 
> 标签：.net, arrays

我正在尝试比较两个 .NET 数组。这是一个比较字节数组的明显实现：

```
bool AreEqual(byte[] a, byte[] b){
    if(a.Length != b.Length)
        return false;
    for(int i = 0; i < a.Length; i++)
        if(a[i] != b[i])
            return false;

    return true;
} 
```

可以在[此处](http://blogs.msdn.com/kathykam/archive/2006/03/08/array-equals.aspx)（通过 Google）看到更精细的方法。

1.  比较两个 .NET 数组的最简单方法是什么（使用更少的代码但可读）？

2.  比较两个 .NET 数组的最有效方法是什么？

* * *

## 回答 #1

> 赞同：48
> 
>             
> 
> 时间：2009-01-28T07:31:52.110

您可以使用[SequenceEqual](http://msdn.microsoft.com/en-us/library/bb348567.aspx)：

```
string[] a = { "1", "2", "3" };
string[] b = { "1", "2", "3" };

bool areEqual = a.SequenceEqual(b); // true

string[] c = { "1", "2", "5" };
areEqual = a.SequenceEqual(c);      // false 
```

* * *

## 回答 #2

> 赞同：18
> 
>             
> 
> 时间：2009-01-28T07:36:40.480

凯西的方法对我来说似乎是一个很好的方法。我个人允许明确指定比较器：

```
bool AreEqual<T>(T[] a, T[] b)
{
    return AreEqual(a, b, EqualityComparer<T>.Default);
}

bool AreEqual<T>(T[] a, T[] b, IEqualityComparer<T> comparer)
{
    // Handle identity comparison, including comparing nulls
    if (a == b)
    {
        return true;
    }

    if (a == null || b == null)
    {
        return false;
    }

    if(a.Length != b.Length)
    {
        return false;
    }

    for(int i = 0; i < a.Length; i++)
    {
        if(!comparer.Equals(a[i], b[i]))
        {
            return false;
        }
    }
    return true;
} 
```

CMS 提到的 SequenceEqual 很好，但由于它的普遍性，`IEnumerable<T>`如果长度不相等，我认为它不能“早出”。（它可能会检查实现 IList 的两个序列，直接检查 Count 。）你可以再概括一点，使用`IList<T>`

```
bool AreEqual<T>(IList<T> a, IList<T> b, IEqualityComparer<T> comparer)
{
    if(a.Count != b.Count)
    {
        return false;
    }
    for(int i = 0; i < a.Count; i++)
    {
        if(!comparer.Equals(a[i], b[i]))
        {
            return false;
        }
    }
    return true;
} 
```

直接数组版本可能是最有效的 - 添加通用性和抽象性通常会影响性能，尽管它是否*重要*取决于您的应用程序。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2011-10-11T15:50:42.637

随着 .NET 4 的出现，您可以使用 .NET 数组的显式实现接口 IStructuralEquatable 提供的方法 Equals()。那么代码可能看起来像这样（我重写了 CMS 的示例）：

```
string[] a = { "1", "2", "3" };
string[] b = { "1", "2", "3" };
bool result = ((IStructuralEquatable)a).Equals(b, StructuralComparisons.StructuralEqualityComparer);
// result evaluates to true. 
```

（IStructuralEquatable 也在元组中实现（也是 .NET 4 中的新功能）。）

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T07:41:40.577

也许是这样的？

```
static bool AreEqual<T>(T[] a, T[] b) 
{
    bool areEqual = false ;
    T[] result = a.Intersect(b.AsEnumerable()).ToArray();
    areEqual = (result.Length == a.Length) && (result.Length == b.Length);
    return areEqual;
} 
```

不过，我不确定这对性能的影响。

编辑

考虑到乔恩建议的修订版：

```
 static bool AreEqual<T>(T[] a, T[] b) 
    {
        return a.SequenceEqual(b);
    } 
```

# php - 具有不同表示的 MVC

> ID：486752
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-28T07:20:11.980
> 
>         
> 
> 标签：php, model-view-controller, zend-framework

我有一个带有 Web 演示的 Web 应用程序的控制器构建。但现在我需要创建这个应用程序的 iphone（手机）版本。

基本上这是一个带有评论的博客应用程序。在常规版本中，注释与条目同时加载。但是在移动应用程序上，我想根据要求加载评论。你如何做到这一点。

*   1 个控制器 2 个视图：2 个不同的操作（每个视图一个）。但是我可以有很多相似但不完全一样的actino。路由将是一个问题

*   2 个控制器每个控制器 1 个视图：1 个管理常规版本，另一个管理移动版本。

我对其他想法持开放态度。顺便说一句，我使用 Zend 框架。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:26:08.180

我认为“RESTful”的方法是使用相同的 URI（所以相同的控制器/动作），并检测（从会话或通过查看用户代理标头）是否要呈现完整版本或手机版。

所以你只有一个控制器/动作，看起来像这样：

```
class BlogController {
    function ShowPost() {
        if (IsMobile) { 
            View("PostWithComments_Mobile");
        } else {
            View("PostWithComments");
        }
    }
} 
```

根据您对框架的控制程度（我不知道 PHP 和 Zend），您可能能够根据是否存在移动版本和用户代理自动将其切换到不同的视图。

快速的 Google 搜索会产生许多用于检测移动浏览器的示例。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T11:02:06.743

I would suggest outputting views in XML then using respective XSL file to transform them into full or stripped-down HTML depending on the targeted screen size. I am sure you can post-process view returned from controller in ZF. Just checked XML+XSL transformation on my friend's iPhone and it works perfectly.

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-29T01:13:24.073

You should define a [ContextSwitch action helper](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelpers.contextswitch). You'd also need a way to recognize requests made from iPhone platforms.

# asp.net-mvc - 在 ASP.NET MVC 中使用 Fiddler 调试 AJAX

> ID：486754
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-28T07:20:47.110
> 
>         
> 
> 标签：asp.net-mvc, ajax

我正在使用 Fiddler 调试我的 MVC 应用程序并查看所有 HTTP 请求。

该应用程序正在运行`http://localhost:51234/mvc`

任何尝试将 Fiddler 用于托管在 localhost 上的网站的人都知道存在问题 - 如果您直接点击此链接，Windows 将不会通过代理转发 localhost 流量。[您可以通过多种方式](http://www.fiddlertool.com/Fiddler/help/hookup.asp#Q-LocalTraffic)解决此问题，例如我首选的使用 URL 的方式`http://ipv4.fiddler:51234/aboutus/contact`。这很好用。

问题是我开始使用 AJAX：

```
 <% using (Html.BeginForm()) { %> 
```

如果您查看生成的源代码，它实际上已经生成了这个：

> `<form
>   action="http://localhost:51234/aboutus/contact"
>   method="post"
>   onsubmit="Sys.Mvc.AsyncForm.handleSubmit(this, new Sys.UI.DomEvent(event), {
>   insertionMode:
>   Sys.Mvc.InsertionMode.replace,
>   onFailure:
>   Function.createDelegate(this,
>   submitComments_failure), onSuccess:
>   Function.createDelegate(this,
>   submitComments_success) });">`

哎呀！

它生成`localhost`而不是`ipv4.fiddler:51234`. 所以当然当我运行 AJAX 查询时，提琴手看不到它。

理论上使用机器名称应该可以，但是如果您尝试直接点击机器名称，WebDev.WebServer 将不会响应`http://win-538lf:51234/aboutus/contact`

> [提琴手] 与 win-538lf 的连接失败。异常文本：无法建立连接，因为目标机器主动拒绝它 fe80::81fc:8f0f:457a:27df%12:51234

有解决方法吗？

是否可以配置 WebDev.WebServer 以响应机器名称？还是我必须创建一个虚拟目录或[假主机](http://en.wikipedia.org/wiki/Hosts_file)？我宁愿不这样做，但我想这没什么大不了的。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T10:35:10.133

所以事实证明，如果你使用这个重载：

```
using (Ajax.BeginForm(new AjaxOptions() 
```

您会生成此代码（“中断”的代码）：

```
<form action="http://localhost:51234/aboutus/contact" method="post" 
```

但如果您这样做并包含操作名称：

```
using (Ajax.BeginForm("Contact", new AjaxOptions() 
```

你得到这个代码生成：

```
<form action="Contact" method="post" 
```

所以我现在很好，但欢迎任何其他解决方案。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:09:17.043

您是否尝试过 Firefox 的 Firebug 扩展？它可以显示 Ajax 请求和响应。我已经将它与 ASP.NET Ajax 一起使用。不确定 MVC Ajax。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:30:53.693

您可以编写一个**HTTPModule**，它使用**响应过滤器**来操作 HTML 输出，替换所有“localhost:51234”字符串。

HttpResponse 类有一个非常有用的属性：

```
public Stream Filter {get; set;} 
```

MSDN 对此属性提供了有用的描述：

> “获取或设置一个包装过滤器对象，用于在传输之前修改 HTTP 实体主体。”

这是一篇不错的文章，它提供了一些背景知识：[使用 .NET HttpModules 和响应过滤实现 IIS 应用程序过滤器（第 3 页）](http://www.devx.com/vb2themax/Article/19901/0/page/3)

> 如对象浏览器中所述，Filter 获取或设置一个包装过滤器对象，用于在传输之前修改 HTTP 实体主体。这正是我们需要做的，以便对 HttpHandler 的 HTML 输出进行修改。Filter 属性声明为 System.IO.Stream 类型。为了将我们自己的类分配给这个过滤器属性，我们需要将我们的类定义为继承自 System.IO.Stream：

```
public class PageFilter : System.IO.Stream 
```

> 我们现在有一个 Stream 类 PageFilter，可以将其分配给 Response.Filter 属性。通过将 PageFilter 附加到 Response.Filter 属性，PageFilter 将在数据写入响应缓冲区时在关键时刻得到通知。最重要的事件当然是写操作。调用此方法时，您将有机会在将数据写入响应缓冲区时对其进行修改。（我将它与 'Response.Buffer = true' 结合起来，以便我的 PageFilter 在单个方法调用中接收完整的响应流。）：

```
public override void Write(byte[] buffer, int offset, int count) 
```

> 在 HttpModule 中，在请求开始时（我在 OnBeginRequest 中执行此操作）只需通过将新实例分配给 Response.Filter 来附加 HTTP 响应过滤器：

```
httpCtx.Response.Filter = 
   new PageFilter(httpCtx.Response.Filter) 
```

* * *

This other article显示了一个完整的**工作示例实现**：

[http://aspnetresources.com/articles/HttpFilters.aspx](http://aspnetresources.com/articles/HttpFilters.aspx)

*我希望这有帮助！*

# php - 如何使用 PHP 动态生成 XML 文件？

> ID：486757
> 
>         
> 
> 赞同：251
> 
>         
> 
> 时间：2009-01-28T07:22:42.003
> 
>         
> 
> 标签：php, xml

我必须在运行时动态生成一个 xml 文件。请帮助我使用 PHP 动态生成以下 XML 文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<xml>
 <track>
     <path>song1.mp3</path>
     <title>Track 1 - Track Title</title>
 </track>
 <track>
     <path>song2.mp3</path>
     <title>Track 2 - Track Title</title>
 </track>
 <track>
     <path>song3.mp3</path>
     <title>Track 3 - Track Title</title>
 </track>
 <track>
     <path>song4.mp3</path>
     <title>Track 4 - Track Title</title>
 </track>
 <track>
     <path>song5.mp3</path>
     <title>Track 5 - Track Title</title>
 </track>
 <track>
     <path>song6.mp3</path>
     <title>Track 6 - Track Title</title>
 </track>
 <track>
     <path>song7.mp3</path>
     <title>Track 7 - Track Title</title>
 </track>
 <track>
     <path>song8.mp3</path>
     <title>Track 8 - Track Title</title>
 </track> 
```

* * *

## 回答 #1

> 赞同：370
> 
>             
> 
> 时间：2009-01-28T11:20:02.633

我会使用[SimpleXMLElement](http://php.net/simplexml)。

```
<?php

$xml = new SimpleXMLElement('<xml/>');

for ($i = 1; $i <= 8; ++$i) {
    $track = $xml->addChild('track');
    $track->addChild('path', "song$i.mp3");
    $track->addChild('title', "Track $i - Track Title");
}

Header('Content-type: text/xml');
print($xml->asXML());

?> 
```

`$xml->asXML()`也可以将文件名作为参数保存到该文件

* * *

## 回答 #2

> 赞同：189
> 
>             
> 
> 时间：2009-01-28T13:33:48.167

要在 PHP 中创建 XML 文档，您应该实例化一个 DOMDocument 类，创建子节点并将这些节点附加到文档树的正确分支中。

作为参考，您可以阅读[http://it.php.net/manual/en/book.dom.php](http://it.php.net/manual/en/book.dom.php)

现在我们将快速浏览下面的代码。

*   在第 2 行，我们创建了一个空的 xml 文档（只需指定 xml 版本（1.0）和编码（utf8））

*   现在我们需要填充 xml 树：

    *   我们必须创建一个 xmlnode（第 5 行）

    *   我们必须将它附加到正确的位置。我们正在创建根，因此我们将其直接附加到 domdocument。

    *   注意 create element 将元素追加到节点并返回插入的节点，我们保存这个引用以将轨道节点追加到根节点（顺便称为xml）。

这些是基础，您可以在一行中创建和附加一个节点（例如第 13 行），您可以使用 dom api 做很多其他事情。它是由你决定。

```
<?php    
    /* create a dom document with encoding utf8 */
    $domtree = new DOMDocument('1.0', 'UTF-8');

    /* create the root element of the xml tree */
    $xmlRoot = $domtree->createElement("xml");
    /* append it to the document created */
    $xmlRoot = $domtree->appendChild($xmlRoot);

    /* you should enclose the following lines in a cicle */
    $currentTrack = $domtree->createElement("track");
    $currentTrack = $xmlRoot->appendChild($currentTrack);
    $currentTrack->appendChild($domtree->createElement('path','song1.mp3'));
    $currentTrack->appendChild($domtree->createElement('title','title of song1.mp3'));

    $currentTrack = $domtree->createElement("track");
    $currentTrack = $xmlRoot->appendChild($currentTrack);
    $currentTrack->appendChild($domtree->createElement('path','song2.mp3'));
    $currentTrack->appendChild($domtree->createElement('title','title of song2.mp3'));

    /* get the xml printed */
    echo $domtree->saveXML();
?> 
```

编辑：只是另一个提示：使用 xml 文档（dom 文档或 simplexml 文档）而不是打印 xml 的主要优点是 xmltree 可以使用 xpath 查询进行搜索

* * *

## 回答 #3

> 赞同：27
> 
>             
> 
> 时间：2009-01-28T07:40:43.497

一个容易破坏的方法是：

```
<?php
// Send the headers
header('Content-type: text/xml');
header('Pragma: public');
header('Cache-control: private');
header('Expires: -1');
echo "<?xml version=\"1.0\" encoding=\"utf-8\"?>";

echo '<xml>';

// echo some dynamically generated content here
/*
<track>
    <path>song_path</path>
    <title>track_number - track_title</title>
</track>
*/

echo '</xml>';

?> 
```

将其保存为 .php

* * *

## 回答 #4

> 赞同：16
> 
>             
> 
> 时间：2015-12-11T04:10:46.577

使用[**FluidXML**](https://github.com/servo-php/fluidxml)，您可以非常轻松地生成 XML。

```
$tracks = fluidxml('xml');

$tracks->times(8, function ($i) {
    $this->add([
        'track' => [
            'path'  => "song{$i}.mp3",
            'title' => "Track {$i} - Track Title"
        ]
    ]);

}); 
```

[https://github.com/servo-php/fluidxml](https://github.com/servo-php/fluidxml)

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2009-01-28T07:48:19.940

看看[Tiny But Strong](http://www.tinybutstrong.com)模板系统。它通常用于模板化 HTML，但有一个适用于 XML 文件的扩展。我广泛使用它来创建报告，其中我可以有一个代码文件和两个模板文件 - htm 和 xml - 然后用户可以选择是将报告发送到屏幕还是电子表格。

另一个优点是您不必从头开始编写 xml 代码，在某些情况下，我一直想要导出非常大的复杂电子表格，而不必编写所有导出代码，只需将现有的电子表格保存在xml 并在需要数据输出的代码标签中替换。这是一种快速且非常有效的工作方式。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2021-01-23T01:49:11.207

希望这段代码可以帮助你。简单简单的解决方案

```
$dom = new DOMDocument();
$dom->encoding = 'utf-8';
$dom->xmlVersion = '1.0';
$dom->formatOutput = true;
$xml_file_name = './movies_list.xml'; //You can give your path to save file.
$root = $dom->createElement('Movies');
    $movie_node = $dom->createElement('movie');
    $attr_movie_id = new DOMAttr('movie_id', '5467');
    $movie_node->setAttributeNode($attr_movie_id);

        $child_node_title = $dom->createElement('Title', 'The Campaign');
        $movie_node->appendChild($child_node_title);

        $child_node_year = $dom->createElement('Year', 2012);
        $movie_node->appendChild($child_node_year);

        $child_node_genre = $dom->createElement('Genre', 'The Campaign');
        $movie_node->appendChild($child_node_genre);

        $child_node_ratings = $dom->createElement('Ratings', 6.2);
        $movie_node->appendChild($child_node_ratings);
    $root->appendChild($movie_node);
$dom->appendChild($root);
$dom->save($xml_file_name); 
```

有关更多信息，请访问以获取详细信息：[https ://www.guru99.com/php-and-xml.html](https://www.guru99.com/php-and-xml.html)

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2020-09-15T20:06:22.460

我看到了 DOM 和 SimpleXML 的示例，但没有看到 XMLWriter 的示例。

请记住，根据我所做的测试，DOM 和 SimpleXML 几乎都比 XMLWriter 慢两倍，对于较大的文件，您应该考虑使用后者。

这是一个完整的工作示例，清晰简单，符合要求，用 XMLWriter 编写（我相信它会帮助其他用户）：

```
// array with the key / value pairs of the information to be added (can be an array with the data fetched from db as well)
$songs = [
    'song1.mp3' => 'Track 1 - Track Title',
    'song2.mp3' => 'Track 2 - Track Title',
    'song3.mp3' => 'Track 3 - Track Title',
    'song4.mp3' => 'Track 4 - Track Title',
    'song5.mp3' => 'Track 5 - Track Title',
    'song6.mp3' => 'Track 6 - Track Title',
    'song7.mp3' => 'Track 7 - Track Title',
    'song8.mp3' => 'Track 8 - Track Title',
];

$xml = new XMLWriter();
$xml->openURI('songs.xml');
$xml->setIndent(true);
$xml->setIndentString('    ');
$xml->startDocument('1.0', 'UTF-8');
    $xml->startElement('xml');
            foreach($songs as $song => $track){
                $xml->startElement('track');
                    $xml->writeElement('path', $song);
                    $xml->writeElement('title', $track);
                $xml->endElement();
            }
    $xml->endElement();
$xml->endDocument();
$xml->flush();
unset($xml); 
```

* * *

## 回答 #8

> 赞同：-15
> 
>             
> 
> 时间：2012-12-04T09:08:44.813

```
$query=mysql_query("select * from tablename")or die(mysql_error()); 
$xml="<libraray>\n\t\t";
while($data=mysql_fetch_array($query))
{

    $xml .="<mail_address>\n\t\t";
    $xml .= "<id>".$data['id']."</id>\n\t\t";
    $xml .= "<email>".$data['email_address']."</email>\n\t\t";
    $xml .= "<verify_code>".$data['verify']."</verify_code>\n\t\t";
    $xml .= "<status>".$data['status']."</status>\n\t\t";
    $xml.="</mail_address>\n\t";
}
$xml.="</libraray>\n\r";
$xmlobj=new SimpleXMLElement($xml);
$xmlobj->asXML("text.xml"); 
```

它很简单，只需连接您的数据库，它将在您的项目文件夹中创建 test.xml 文件

# wpf - WPF Dispatcher 是多线程问题的解决方案吗？

> ID：486758
> 
>         
> 
> 赞同：19
> 
>         
> 
> 时间：2009-01-28T07:23:11.130
> 
>         
> 
> 标签：wpf, multithreading, dispatcher

我对在我的代码中使用 lock 有一种非常不好的感觉，但是现在 WindowBase 的 Dispatcher 存在，我想在任何地方使用它。

例如，我使用一个多线程单例 WCF 服务，它在 PRISM 的 EventAggregator 上发布事件，有效负载是不可变的（它只是数据），并且每个带有调度程序的线程都可以优雅地检索事件，而不会在自己的调度程序中出现死锁。（不仅是 UI 线程，还有数据库调用线程、服务调用线程、日志线程或其他调用慢的线程，因为我不想冻结 UI）。

但是我的问题是这个 Dispatcher 是与 WPF 耦合的，所以当我到处使用它时我感到有点内疚，我觉得这个 Dispatcher 不是为我的用例而创建的。

它是否存在另一个不与 WPF 耦合的 Dispatcher 实现？还是可以滥用它？

谢谢，

**更新**

Paul Stovell 给我的解决方案是创建一个接口 IDispatcher，以及一个用于 Wpf Dispatcher 的适配器，这样会更容易测试！这个解决方案对我有好处，因为我重构了我的测试，我现在可以在我的测试中使用 SynchronousDispatcherAdapter（多亏了它，我不必在我的测试中使用 WPF 的 Dispatcher）。

使用 Dispatcher 而不是 BackgroundWorker 是有意义的，因为我使用的是多发布者/订阅者模式（使用 PRISM），并且感谢 Dispatcher，每个事件处理程序都在订阅事件的线程上调用。这意味着多线程问题可能发生的唯一点是我的事件的有效负载（我让他不可变）。

我的不同线程之间不直接通信，它们只能发布和订阅事件。因此，数据库调用、日志调用、服务调用、UI 调用在不同的线程上运行并且彼此不知道（它们只知道他们订阅和发布的事件）。

当我从我的 UI 对存储库进行一些调用时，后台工作人员将是有意义的。

但我希望找到一个不使用 BackgroundWorker 的设计，因为我更喜欢使用这种订阅者/发布者模式（我认为它使我的代码更具可读性）

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-01-28T07:46:59.053

使用 Dispatcher（或 BackgroundWorker）的主要问题是很难测试，除非您的测试工具实际上有一个 UI 线程。

## 解决方案 1

使用[SynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx)。它提供了在 UI 线程上调用的相同能力，并在 Windows 或 WPF 中工作。测试它[也是可能的](http://blogs.msdn.com/jaredpar/archive/2008/08/25/simple-class-for-tests-involving-a-synchronizationcontext.aspx)。

## 解决方案 2

将调度程序视为另一种服务。当您使用 PRISM 时，您会熟悉服务和 IOC。以下是如何使用此类服务​​：

```
// Not a UI component
public class MyDomainService : IMyDomainService
{
   private readonly IDispatcher _dispatcher;

   public MyDomainService(IDispatcher dispatcher) 
   {
      _dispatcher = dispatcher;
   }

   private void GotResultFromBackgroundThread()
   {
       _dispatcher.Dispatch(() => DoStuffOnForegroundThread());
   }
} 
```

这允许您在不同的实现中替换您的平台/测试。

这是[IDispatcher](http://www.codeplex.com/bindablelinq/SourceControl/changeset/view/25046#293215)的一个示例，一个[WPF 实现](http://www.codeplex.com/bindablelinq/SourceControl/changeset/view/25046#293214)和一个[测试实现](http://www.codeplex.com/bindablelinq/SourceControl/changeset/view/25046#299606)。您可以像任何其他服务一样将它们注册到您的 IOC 容器中，并且它们可用于 UI 和其他服务。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T07:38:49.490

是的，不是的..它是一个渲染的东西..本身不是一个线程的东西..

Dispatcher 按优先级选择工作项并运行每个工作项直至完成。每个 UI 线程必须至少有一个 Dispatcher，并且每个 Dispatcher 只能在一个线程中执行工作项。根据这个来自微软的[链接。](http://msdn.microsoft.com/en-us/library/ms741870.aspx#threading_overview)

您仍然必须自己处理您自己启动的任何线程。

检查[这个](http://msdn.microsoft.com/en-us/library/hkasytyf.aspx)以获取有关信息：使用基于事件的异步模式进行多线程编程

就我个人而言，我使用[Background Worker](http://msdn2.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)来满足我的线程需求。

[最佳实践在这里](http://msdn2.microsoft.com/en-us/library/1c9txz50.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2020-09-11T23:48:13.337

我要彻底解决这个问题，但这听起来是个坏主意。您的意思是，您需要一个队列让您的发布者为其订阅者转储项目。Dispatcher 的核心只是一个美化的队列，周围有很多开销。开销专门用于保护对您未使用的 UI 资源的访问。这表明使用它是错误的。

建议 SynchronizationContext 的人走上了一条好路。这完成了您想要的（安全地将数据编组到另一个线程），而无需将您束缚于 UI 概念。您可以编写一个扩展方法，将您的事件编组到事件的每个订阅者请求的 SynchronizationContext（它可以通过将订阅委托的目标转换为 ISynchronizeInvoke 来获得。该转换的结果将让您知道它是否需要编组，并且可以自动为您完成。

更好的是只使用具有适当锁定语义的队列。锁的开销不太可能成为问题，如果是，您对 Dispatcher 的使用将比简单的锁更具破坏性。在这种情况下，越简单越好。他们的关键是只保留锁定以从队列中添加/删除项目。您的订阅者应该执行他们在锁定之外所做的任何工作。

# c# - 如何释放内存（用户控制）

> ID：486784
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-28T07:38:24.127
> 
>         
> 
> 标签：c#, wpf

我正在使用 WPF。

在运行时动态添加用户控件后，如何处置该用户控件。因为用户控件没有 Dispose 方法。我不想等到垃圾收集器运行。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-28T07:50:57.300

即使您能够处理它，也不会释放内存。Dispose 不是关于释放内存——它是关于释放非内存资源（例如 GDI 句柄）。我假设如果该类没有实现 IDisposable，它就没有任何非内存资源可以释放。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T08:17:15.593

我认为你的设计有缺陷。如果您仍然对某些内容有引用，那么无论如何您都不应该尝试释放内存。一旦某些东西实际上不再存在（不再对其进行进一步引用），它实际上就是可用的内存，下次您需要一些没有 GC 就无法提供的内存时，它将变得空闲 [1] 并且可用。

你的设计不是在浪费内存，它只是在**搅动**内存。这本身可能有问题，但不会浪费内存。**如果您的设计在不再需要控件后**保留对控件的引用，这会浪费内存，但是您不能通过“删除”它们来“创可贴”解决问题。您需要以一种难以控制其生命周期的方式解决将这些控制权传递给整个地方的根本原因。

[1] 禁止在此处不适用的终结器

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T07:40:52.747

您是否有不想等待 GC 的理由？如果您从它的父级中删除控件，因此没有对它的引用，那么 GC 会吃掉它，无需手动处理它。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T07:51:49.870

谢谢史蒂夫。

首先，我经常在我的应用程序上添加许多 UsrCtr 元素。因此，如果不立即删除它们，将浪费大量内存。

实际上我在几个地方使用 ForEach 循环来迭代应用程序（WinForm）上的所有元素，所以这个循环仍然显示 UserCtrs（在删除 UserCtr 作为 chld 之后）

此外，我还通过自定义事件和委托将 UserCtrs 的引用传递到我项目中的其他几个地方。因此，如果将其添加到主窗体上的一个位置，则用户控件的引用仍然可能存在于项目中的其他位置。

# c++ - boost::interprocess 中 win32 文件锁定的模拟是什么？

> ID：486797
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-28T07:46:51.347
> 
>         
> 
> 标签：c++, multithreading, boost, ipc

我应该使用什么同步机制来独占访问boost中的文本文件？该文件可能仅由一个进程的线程访问。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-12-02T17:05:16.650

文件锁定 API 通常用于进程间锁定。如果您在单个进程中，则[Boost.Thread 包](http://www.boost.org/doc/libs/release/libs/thread/)中适合您需要的所有内容都可以。应该使用[Boost.Interprocess](http://www.boost.org/doc/libs/release/libs/interprocess/)的外部进程。您可能想从 Boost.Interprocess 阅读以下警告：

```
注意：同步限制

```

如果您打算像命名互斥锁一样使用文件锁，请小心，因为可移植文件锁具有同步限制，主要是因为不同的实现（POSIX、Windows）提供不同的保证。进程间文件锁有以下限制：

*   如果 a`file_lock`同步来自同一进程的两个线程，则未指定。

*   一个进程是否可以使用`file_lock`指向同一个文件的两个对象是未指定的。

第一个限制主要来自 POSIX，因为文件句柄是每个进程的属性，而不是每个线程的属性。这意味着如果一个线程使用一个`file_lock`对象来锁定一个文件，其他线程将看到该文件被锁定。另一方面，Windows 文件锁定机制提供线程同步保证，因此试图锁定已锁定文件的线程会阻塞。

第二个限制来自文件锁定同步状态与 Windows 中的单个文件描述符相关联的事实。这意味着如果创建了两个指向同一个文件的 file_lock 对象，则不能保证同步。在 POSIX 中，当一个描述符被关闭时，当使用两个文件描述符来锁定一个文件时，调用进程设置的所有文件锁都会被清除。

总而言之，如果您打算在进程中使用文件锁定，请使用以下限制：

*   `file_lock`对于每个文件，每个进程使用一个对象。

*   使用相同的线程来锁定和解锁文件。

*   如果您在对该文件使用文件锁的同时使用 std::fstream/native 文件句柄写入文件，请在释放文件的所有锁之前不要关闭该文件。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T07:54:48.460

我想它是[acquire_file_lock](http://www.boost.org/doc/libs/1_36_0/boost/interprocess/detail/os_file_functions.hpp)

```
inline bool acquire_file_lock(file_handle_t hnd)
{
   struct ::flock lock;
   lock.l_type    = F_WRLCK;
   lock.l_whence  = SEEK_SET;
   lock.l_start   = 0;
   lock.l_len     = 0;
   return -1 != ::fcntl(hnd, F_SETLKW, &lock);
} 
```

它与[lock 的非增强实现](http://beej.us/guide/bgipc/output/html/singlepage/bgipc.html)一致。

```
 struct flock fl = {F_WRLCK, SEEK_SET,   0,      0,     0 };
    int fd;

    fl.l_pid = getpid();

    if (argc > 1) 
        fl.l_type = F_RDLCK;

    if ((fd = open("lockdemo.c", O_RDWR)) == -1) {
        perror("open");
        exit(1);
    }

    printf("Press <RETURN> to try to get lock: ");
    getchar();
    printf("Trying to get lock...");

    if (fcntl(fd, F_SETLKW, &fl) == -1) {
        perror("fcntl");
        exit(1);
    }

    printf("got lock\n");
    printf("Press <RETURN> to 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T07:59:24.427

如果您确定只能从一个进程访问它，那么在线程本地存储中使用文件句柄的读写锁可能是一种解决方案。这将模拟上述情况，只有一个作者，但有几个读者。

# gis - 我在哪里可以获得加利福尼亚的 x、y、z 坐标以使用等高线图？

> ID：486807
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T07:51:41.697
> 
>         
> 
> 标签：gis, plot, modeling

我想通过等高线图制作加利福尼亚的地图。但是，我不知道如何获得必要的 x、y 和 z 坐标。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T07:58:13.930

您咨询过[加利福尼亚的地理空间信息办公室](http://gio.resources.ca.gov/)吗？还有[geodata.gov](http://geodata.gov/)，它链接到一堆高程数据集，包括[USGS National Elevation Dataset](http://ned.usgs.gov/)。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2013-02-14T18:24:02.593

GDAL 库 (www.gdal.org) 有许多有用的命令来处理这些类型的数据。大多数高程数据格式，例如可通过国家地图服务器获得的那些： 
   [http](http://nationalmap.gov/viewer.html) ://nationalmap.gov/viewer.html
可由 GDAL 读取。命令 gdal2xyz.py 可以读取这些光栅化文件并写入 X、Y、Z 三元组。或者您可以直接跳到使用 gdal_contour 渲染轮廓线。优秀的跨平台 GIS 软件 Quantum GIS (www.qgis.org) 对于处理地理空间数据也非常有用，并且包括对 GDAL 大部分功能的菜单驱动访问。

# c# - 属性或注释（CLR 或 Java）的酷用法？

> ID：486815
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-01-28T07:56:59.860
> 
>         
> 
> 标签：c#, java, attributes, annotations

您已经完成或听说过哪些 CLR/C# 代码中的自定义属性很酷的应用程序？标准属性的有趣新用途也可以！

**编辑：**由于 Java 的注解似乎与 CLR 的属性相同，因此使用 Java 注解也是有效的。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-01-28T08:04:58.470

*   [postsharp](http://www.postsharp.org/)，它使用属性注入代码（AOP）？

*   [`[TypeDescriptionProvider]`](http://msdn.microsoft.com/en-us/library/system.componentmodel.typedescriptionproviderattribute.aspx)可用于提供自定义运行时属性模型 - 完全不同的属性，或者[更快的属性](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)

还有一些经常被忽视的核心：

*   [`[TypeForwardedTo]`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.typeforwardedtoattribute.aspx)- 用于在组件之间移动类型而无需重新构建

*   [`[PrincipalPermission]`](http://msdn.microsoft.com/en-us/library/system.security.permissions.principalpermissionattribute.aspx)- 用于自动对成员强制执行安全性

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-01-28T08:06:39.280

虽然不是严格意义上的 C#，但我发现 Java 注释（= C# 属性）用于标记学生作业的一个有趣用途。每学期我都会给学生编程一个打标机器人，结果发现一年级的学生由于某种原因似乎不能准确地遵循指令，这当然导致打标机器人出现故障。所以我要做的是通过他们的代码，找到所有不符合规范的方法并修复它们。然后我在每个错误的方法上都添加了注释（=attribute），告诉标记机器人将它们标记下来。这可能是我认为最简单直接的方法。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T08:59:34.977

查看[xUnit](http://www.codeplex.com/xunit)并了解如何使用属性来标记单元测试的预期行为以及将数据馈送到测试中。属性的使用方式比 MSTest 或 NUnit 更有意义。

从[Samples\TestMethodExtensibility\Example.cs](http://www.codeplex.com/xunit/SourceControl/changeset/view/28028#120751)：

```
public class Example
{
    static int val;

    [RepeatTest(5, Timeout=250)]
    public void RepeatingTestMethod()
    {
        Thread.Sleep(100);
        Assert.Equal(2, 2);

        if (val == 0)
        {
            val++;
            Thread.Sleep(1000);
        }
    }
} 
```

从[test.xunit.extensions\DataTheories\TheoryAttributeTests.cs](http://www.codeplex.com/xunit/SourceControl/changeset/view/28028#362431)：

```
internal class TestMethodCommandClass
{
    public static IEnumerable<object[]> EmptyData
    {
        get { return new object[0][]; }
    }

    public static IEnumerable<object[]> NullData
    {
        get { return null; }
    }

    public static IEnumerable<object[]> TheoryDataProperty
    {
        get { yield return new object[] { 2 }; }
    }

    [Theory, PropertyData("EmptyData")]
    public void EmptyDataTheory() { }

    [Theory, PropertyData("NullData")]
    public void NullDataTheory() { }

    [Theory, OleDbData(
        @"Provider=Microsoft.Jet.OleDb.4.0; Data Source=DataTheories\UnitTestData.xls; Extended Properties=Excel 8.0",
        "SELECT x, y, z FROM Data")]
    public void TestViaOleDb(double x,
                             string y,
                             string z) { }

    [Theory, PropertyData("TheoryDataProperty")]
    public void TestViaProperty(int x) { }

    [Theory, ExcelData(@"DataTheories\UnitTestData.xls", "SELECT x, y, z FROM Data")]
    public void TestViaXls(double x,
                           string y,
                           string z) { }

} 
```

详情见：

[http://www.codeplex.com/xunit](http://www.codeplex.com/xunit)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T16:39:37.183

nunit 当然

属性的使用被肯特贝克引以为豪：

*NUnit 2.0 是惯用设计的一个很好的例子。大多数移植 xUnit 的人只是音译 Smalltalk 或 Java 版本。这也是我们最初对 NUnit 所做的。这个新版本是 NUnit，因为它本来是在 C# 中完成的。* 

来源：[http ://www.nunit.org/](http://www.nunit.org/)

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:12:23.667

我有一个案例，我想将接口的实际实现也呈现为数据。这当然可以通过反射来完成，但是通过在我想作为数据公开的成员上使用特定属性，我可以封装执行此操作所需的工作。

最终结果是我创建了我的实现，装饰了所需的成员，然后我可以通过代码和数据查询成员，而无需在每种情况下都执行反射代码。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:25:35.810

有时，我使用属性来装饰类或方法，并使用反射来获取“属性”数据。

可能有点难以解释，但我使用属性的最后一件事是在一个数据库中有几个实体的系统中。

每个实体都有某种“代码”，每个实体也可以有一些解释规则。

在我的项目中，我有一个实体类，它表示数据库中存在的一个实体，并且我还有一组“规则”类。一个规则类包含给定实体的解释逻辑。

为了将某个“规则”（解释）“链接”到我的实体的特定实例，我创建了一个自定义属性。  

我用这个属性装饰我的“规则”类，并通过这个属性，我定义了哪个实体这是一个规则。然后，当我从数据库加载实体时，我将正确的规则注入到该实体中。

一些代码让事情变得清晰：

```
public class MyEntity
{
    public string Code
    {
       get;
       private set;
    }

    public bool IsValidFor( ... )
    {
        IRule rule = RuleRegistry.GetRuleFor(this);

        if( rule.IsValid() ) ...
    }

}

[RuleAttrib("100")]
public class MyRule : IRule
{
    public bool IsValid()
    {
    }
} 
```

这只是一个小例子，但我想你会明白的。

MyRule 类的 RuleAttrib 属性表示，这是一个应该应用于具有代码“100”的 MyClass 实例的规则。

RuleRegistry 实例能够为当前实体检索正确的 IRule（使用反射）。

我结合 Postsharp 使用属性的另一个例子是“锁定”系统的实现：http:
 [//fgheysels.blogspot.com/2008/08/locking-system-with-aspect-orientation.html](http://fgheysels.blogspot.com/2008/08/locking-system-with-aspect-oriented.html)

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:51:16.663

我们使用自定义 java 注解来标记某些方法的特殊用途，主要针对开发人员：

*   `@ScriptingAPI`-- 标记作为我们脚本 API 的一部分公开的代码（警告开发人员更改可能会影响公共 API）

*   `@Transaction`-- 在数据库外观上标记正在启动/提交事务的方法（我们有一个尊重此注释的专用事务处理程序类）

*   `@NeedsAttentionToSupportFoo`-- 如果我们知道功能 Foo 是我们需要在不久的将来解决的要求，我们使用注释来标记我们需要触摸以支持它的代码，即当我们遇到一段代码时我们认为“啊，这需要更改以支持 Foo”，我们对其进行注释。如果 Foo 的实现被推迟或永远不会发生，删除注释比恢复散布在代码中的过早优化更容易。

[此 java 专家时事通讯](http://www.javaspecialists.eu/archive/Issue167.html)介绍了自定义注释的另一个很好的示例用法：在所有子类中强制执行公共无参数构造函数。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-05-04T07:58:18.270

Castle 的[ActiveRecord](http://www.castleproject.org/activerecord/index.html)使用属性。它隐藏了 NHibernate 的一些设置复杂性，通过使用属性来装饰您的模型对象，这些属性指示应该持久化到数据库的类和字段（以及如何持久化）。验证组件中还使用属性将基于模型的验证添加到 ActiveRecord 和[Monorail](http://www.castleproject.org/monorail/index.html)堆栈中。

# c# - C#：如何向自定义类添加析构函数？

> ID：486823
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-28T08:01:06.373
> 
>         
> 
> 标签：c#

如何将析构函数添加到用 C# 制作的自定义类中，以便在不再需要时将其销毁？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-01-28T08:03:02.267

读[这个](http://msdn.microsoft.com/en-us/library/system.object.finalize(VS.71).aspx)。

但是您可能会考虑实现 IDisposable，它通常会提供更优雅的解决方案。去[这里](http://www.devx.com/dotnet/Article/33167)了解更多信息。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-01-28T08:05:04.617

不要使用析构函数。请改用 Dispose() 和 Finalize()。

这是一篇关于这个主题的非常好的文章：[When and How to Use Dispose and Finalize in C#](http://www.devx.com/dotnet/Article/33167 "    在 C# 中何时以及如何使用 Dispose 和 Finalize")

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:37:04.023

析构函数不用于销毁对象，而是用于在销毁对象时清理使用的资源。析构函数通常用于清理任何非托管资源，例如在使用 Interop/p/invoke 时。

```
class Person
{
    // Destructor
    ~Person()
    {
        // Cleanup resources that the object used here.
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:53:07.593

真的要小心！！！您应该尽量避免在 C# 中使用析构函数。

当您的代码是：

```
 class Person
{
    // Destructor
    ~Person()
    {
        // Clean-up resources that the object used here.
    }
} 

```

编译器正在为您生成此代码：

```
 class Person
{
    // Destructor
    public override void Finalize()
    {
        // your clean up
        base.Finalize();

    }
} 

```

如您所见，您只是在实现 Finalize 方法。在 .Net 平台中，Finalize 方法的错误实现可能会使您的应用程序发生内存泄漏，如果正确实现，并且具有 Finalize 方法实现的对象需要 2 次 GC 调用才能释放。

如果你来自 C++，你应该完全忘记析构函数的想法，你不需要它们，GC 应该照顾你的普通类。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:05:00.483

这是一个例子：

```
class Car
{
    ~Car()  // destructor
    {
        // cleanup statements...
    }
} 
```

[有关MSDN](http://msdn.microsoft.com/en-us/library/66x5fx1b.aspx)的更多信息。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-03-19T02:09:50.243

〜类名（）{}

# javascript - 添加
在 IE 6 中

> ID：486825
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T08:01:54.953
> 
>         
> 
> 标签：javascript, internet-explorer-6

我用 JavaScript 编写了以下代码，以便从打开器窗口向选择列表中添加一个新选项：

```
function updateSelectList()
{
    var field = opener.document.objectdata.ticketPersonId;
    if (true && opener && field)
    {
        var val = document.createElement('option');
        var title = document.objectdata.titleId.options[document.objectdata.titleId.selectedIndex].text;
        val.text =  title + ' ' + document.objectdata.firstName.value + ' ' + document.objectdata.lastName.value + ':' + document.objectdata.username.value;    
        val.value = null;

        val.selected = true;
        field.add(val, null);
    }
} 
```

在 Firefox、Google Chrome 等中都可以正常工作，但在 IE 6 中不行 :-( 请告知我如何在 IE 6 中也能做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:23:29.777

这是我的片段：

```
if (oldopt!=null || !horus.brokenDOM)
  select.add(newopt, oldopt);
else
  newopt=options[options.length]=new Option(newopt.text, newopt.value, false, false); 
```

的定义`horus.brokenDOM`留给读者:)

`Option`IIRC，我在使用IE 的上下文中使用预定义的对象（通常从另一个选择框中拉出）时遇到了一些困难，因此就地创建了对象。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:30:37.220

```
function updateSelectList()
{
    var field = opener.<%= updatelist %>;
    if (<%= called %> && opener && field)
    {
        var val = opener.document.createElement('option');
        var title = document.objectdata.titleId.options[document.objectdata.titleId.selectedIndex].text;
        val.text =  title + ' ' + document.objectdata.firstName.value + ' ' + document.objectdata.lastName.value + ':' + document.objectdata.username.value;    
        val.value = <%= thePerson != null ? thePerson.getId() : null %>;
        val.selected = true;
        try
        {
            field.add(val, null);
        }
        catch(error)
        {
            field.add(val, 0);
        }
    }
} 
```

这接缝工作。什么使命！

# c# - 如何练习像 C# 这样的语言？

> ID：486838
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-28T08:07:18.373
> 
>         
> 
> 标签：c#, programming-languages

这些天我学习了 C# 的一些基本用法。我认为由于 C# 经常用于应用程序编程，我们应该以工程的方式来练习该语言，而不是解决一些算法问题。但是，如果我在工作中找不到与该语言相关的任何项目，那么练习 C# 的最佳方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-28T16:08:23.847

您还可以查看[AntMe](http://www.antme.net)，它是您用 C# 编写的对蚂蚁的模拟。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T16:14:37.577

我在练习中使用了一些东西——诚然，它们比面向业务的更注重算法，但面对现实吧，如果你整天都这样做，面向业务的东西会变得乏味：

*   Code Golf on SO - 查看以下所有具有出色迷你任务的标签

    *   [代码高尔夫](https://stackoverflow.com/questions/tagged/code-golf) 

    *   [高尔夫球](https://stackoverflow.com/questions/tagged/golf) 

    *   [算法](https://stackoverflow.com/questions/tagged/algorithm)

    *   [语言无关](https://stackoverflow.com/questions/tagged/language-agnostic)

*   Project Euler - 可在[http://projecteuler.net/找到](http://projecteuler.net/)

*   查看有关 SO 的其他问题，为您提供编程任务的想法 - 可以在此处找到一个很好的开始[替代 FizzBu​​zz 问题](https://stackoverflow.com/questions/117812/alternate-fizzbuzz-questions)

*   尝试找出此处出现的问题的答案，否则您不会知道答案。

对于编程的业务方面的实践，请尝试了解大多数企业在软件方面想要什么，那就是帮助他们完成日常工作的软件。这可能归结为为用户（即您）执行特定任务的软件，也可能是允许存储、检索和报告业务数据的软件。

*   创建一个项目，允许您使用各种模式存储和检索数据，注意每个模式的性能差异 - 即 DataSet 与 DataAdapter 与 DataReader 与 LINQ-to-SQL 和存储过程与 TableDirect 与 QueryStrings。从数据库中存储和检索数据的方法只有这么多。

*   从互联网上获取一个演示数据库——比如 AdventureWorks 或臭名昭著的 Northwind，然后自己编写报告以各种格式显示数据。

我经常发现我使用的在网上找到的实用软件并不能很好地解决它。当然，其中一些具有一些不错的功能，但不可避免地总会缺少*一些东西。*因此，我四处浏览并找到了一堆实用程序，涵盖了我认为其中一个应该做的所有事情，采用所有最好/最有用的部分，并[记下我喜欢每个工具的事情]我自己编写。最好的方法是始终思考：“我想如何使用它”而不是“如果我这样编程，我必须如何使用它”。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T08:33:13.640

我认为您可以尝试从个人小型公用事业开始。比如写一个文件备份器、个人asp.net博客站点、密码提醒、时间跟踪器等。

该产品将由您使用，因此您会遇到异常或性能问题，因此您将学习更多..

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T16:04:47.147

我听说编写自己的博客引擎是近来流行的练习。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:14:43.960

找到一个你感兴趣的使用这项技术的开源项目，并尝试为它做出贡献。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:48:41.660

我总是带着游戏去。想一个新游戏，或者重新做一个旧游戏。我几乎总是从熄灯开始。就像java中的[这个](http://www.whitman.edu/mathematics/lights_out/)。从简单开始并在此基础上进行扩展。我使用游戏来学习语言的方方面面。他们也很适合练习设计模式。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:13:59.623

我总是有同样的问题，要找到一个可以使用新语言实现的项目并不容易。

为什么不尝试在 C# 中再次实现您曾经用另一种语言实现的项目？

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:15:14.160

如果您找不到自己的工作来应用您的编码技能，只需加入一个开源项目 - 您会发现它是一种宝贵的现实生活中的编码经验，并且让您的工作受到他人的批评。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:16:07.777

想想一些非常大的东西，然后复制它。自己设计，然后努力完成......一次学习它:)

# multithreading - 等效于 MSVC/Windows 中的“pthread_rwlock_timedrdlock()”和“pthread_rwlock_timedwrlock()”

> ID：486842
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T08:09:37.260
> 
>         
> 
> 标签：multithreading, posix, pthreads, visual-c++

在 Windows（MSVC）中遵循 POSIX 定时读取器/写入器锁的等价物是什么？

*   pthread_rwlock_timedrdlock()

*   pthread_rwlock_timedwrlock()

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-07-01T15:04:20.557

看一下[pthreads-win32](http://sourceware.org/pthreads-win32/)，它使用 Win32 API 实现了这两个函数（以及 pthread 的其余部分）。它对这些功能的实现应该足以让您入门。或者您可以直接使用它来代替本机 Win32 线程和同步原语。

# c# - 使用 MemoryStream 写出 XML

> ID：486843
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-01-28T08:10:24.980
> 
>         
> 
> 标签：c#, xml, memorystream

我注意到将数据写入 XML 文件的两种不同方法（为简洁起见，省略了错误处理）。

第一种方法是构建 XML 文档，然后简单地将 XML 保存到文件中：

```
using (XmlWriter writer = XmlWriter.Create(fileName))
{
    writer.WriteStartDocument(true);
    writer.WriteStartElement("parentelement");
    writer.WriteEndElement();
    writer.WriteEndDocument();
} 
```

第二种方法是创建一个 MemoryStream，然后将 MemoryStream 保存到一个文件中：

```
XmlWriterSettings settings = new XmlWriterSettings();
settings.Indent = true;
MemoryStream ms = new MemoryStream();
using (XmlWriter writer = XmlWriter.Create(ms, settings))
{
    writer.WriteStartDocument(true);
    writer.WriteStartElement("parentelement");
    writer.WriteEndElement();
    writer.WriteEndDocument();
}

using (FileStream fs = File.Open(fileName, FileMode.Create, FileAccess.Write))
{
    ms.WriteTo(fs);
    ms.Dispose();
} 
```

我猜想使用 MemoryStream 的逻辑是确保在尝试保存文件之前可以构建 XML 文件。当您将条目添加到 XML 文件中时，MemoryStream 方法是否会提供原子写入事件和/或防止写入问题？

谁能解释这是否真的有必要，或者只是一种在我的项目中添加不必要的代码行的矫枉过正的方式？

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-01-28T08:21:21.747

在这种情况下，`MemoryStream`版本是浪费的。`MemoryStream`如果您想执行`Stream`类似的工作，但不想要实际文件，这很有用。如果您**正在**写入文件，则只需写入文件即可。这避免了在内存中缓冲所有数据的需要。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-11-01T16:17:38.273

确实，内存流方法对于简单的操作来说是浪费的，但它对于将 xml 保存为加密文件、压缩文件等情况非常有用。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T08:23:40.400

这是矫枉过正和浪费。

两种关键方法基于

1.  直到最后，您才知道文档的完整结构。

2.  当您“创建”文档的各个部分时，您知道它们是文档这一部分的最终形式。

第一个需要创建文档的内存模型（为其设计了 DOM 模型）。完成后，只需直接写入文件流即可。

第二个允许您节省大量内存和复杂性，并且只需使用可以直接指向结束流（在本例中为文件流）的[XmlWriter 。](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)

在任何阶段都没有必要使用 MemoryStream

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T10:43:32.443

如果您（出于某种原因）想要确保 XmlWriter 成功（即否则文件可能会被截断，但在大多数情况下，这将是由于 - 如前所述 - 不是关闭标签），您可以使用临时文件流，fx 类似的东西对此：

```
public class TempFileStream : FileStream
{

    public TempFileStream(Action<string> onClose)
        : base(Path.GetTempFileName(), FileMode.OpenOrCreate, FileAccess.ReadWrite)
    {
        this.CloseDelegate = onClose;
    }

    protected Action<string> CloseDelegate 
    {
        get;
        set;
    }

    public override void Close()
    {
        base.Close();
        if (File.Exists(this.Name))
        {
            this.CloseDelegate(this.Name);
        }
    }

} 
```

使用的像：

```
XmlWriterSettings settings = new XmlWriterSettings();
settings.Indent = true;

using (TempFileStream tfs = new TempFileStream(f => File.Move(f, filename))
using (XmlWriter writer = XmlWriter.Create(tfs, settings))
{
    writer.WriteStartDocument(true);
    writer.WriteStartElement("parentelement");
    writer.WriteEndElement();
    writer.WriteEndDocument();
} 
```

这不会消耗大量内存（当然，它仅在生成的 XML 很大时才有意义/更有意义）

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2010-02-01T22:54:08.003

我认为如果在 Web 应用程序或 Web 服务中创建文档，使用内存流会很有用。文件位置可能与可能正在运行相同处理的另一个进程冲突，这可能会导致无效结果。在内存流中，处理应该是分开的。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:15:49.433

您不必使用 MemoryStream 来使用 XmlWriter。XmlWriter 可以直接写入文件；您可以使用 XmlWriter.Create 方法的另一个重载，它将文件名作为参数，或者您也可以写入 XmlTextWriter 或 FileStream，而不是写入 MemoryStream。

所以，你的第二个代码片段可以写成：

```
using( FileStream fs = ... )
{
    XmlWriter writer = XmlWriter.Create (fs);
} 
```

AFAIK，XmlWriter 不会保护您免于创建格式不正确的 Xml。

# excel - excel 2003 VBA：找不到宏

> ID：486854
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-01-28T08:16:59.727
> 
>         
> 
> 标签：excel, vba

通过 OnTime 方法调用函数时，我一直收到错误，我尝试了[这里](https://stackoverflow.com/questions/211715/how-to-make-a-macro-which-executes-periodically-in-excel)写的内容（甚至最后发表了评论），但我一直收到错误：

> 未找到宏 'I:\myFolder\test.xls'!MacroName

`MacroName`从脚本中的任何位置调用该函数时，它都可以正常工作。

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T13:33:00.103

我很确定您的问题是代码不在标准模块中，而是在 ThisWorkbook 模块中...我不知道为什么，但代码需要在标准模块中才能工作，尽管您可能想要尝试将 OnTime 方法调用更改为“ThisWorkbook.Subname”

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:27:03.700

您是否按照[此 Microsoft 技术说明](http://support.microsoft.com/kb/262876)的建议检查了“**宏观级别的安全性**” ？

> 在工具菜单上，指向宏，然后单击安全性。在“安全级别”选项卡上，将您的设置更改为“中”或“低”。
> 
> 注意：您需要的设置因您的情况而异。Excel 中的默认值为中。

* * *

现在，当涉及到[MacroName 的代码时](https://stackoverflow.com/questions/211715)，**您只能将事件过程放在 ThisWorkbook 模块**（即 Macro_Name）中。

其他程序必须进入普通模块。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T09:21:52.450

错误消息中显示的路径是否与包含宏的工作簿的位置匹配？

可能是别的东西，但是每当显示路径时，我都会怀疑我已经从不同的位置加载了一些东西，而 Excel 仍在（正确地，因为它不知道你移动了文件）在寻找宏原来的位置。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T09:31:06.973

是的，路径匹配。这是我的第一个宏，所以我重新编码它:)

奇怪的是，现在它可以工作了，但只有当 MacroName 被放置在一个新的模块中时。

这怎么解释？

# asp.net - ASP.NET Response.Redirect 向浏览器显示 CDATA

> ID：486859
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-28T08:20:08.737
> 
>         
> 
> 标签：asp.net, cdata

我最近将一个 Web 应用程序移到了一个新服务器上，每个 response.redirect 最终都只是将 CDATA 显示给浏览器。表单确实回发了，进行了更改，但浏览器并没有最终加载新页面，只是显示了 CDATA。  

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:51:53.120

来自 asp.net 的 HTTP 重定向通常使用 HTTP 标头而不是任何 HTML 输出进行。您是否尝试过询问 HTTP 标头以确定返回的内容？

以下工具可以提供帮助：

[http ://web-sniffer.net/](http://web-sniffer.net/)

CDATA 是一个 XML 元素，因此我不希望这是服务器的唯一输出。您可以尝试在此处粘贴完整的输出供我们查看吗？

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T21:04:13.860

是的，这让我感到困惑......例如，这是唯一的回应：它也发生在所有浏览器中......

# java - 如何在 Web 服务调用期间拦截 xml 响应和请求？

> ID：486864
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-28T08:23:11.993
> 
>         
> 
> 标签：java, jaxb, jax-ws

我想知道是否有一些巧妙的方法来拦截在 java webservice 方法调用期间发送的 xml 请求和响应中给出的 xml？我不想将这些 xml 打印到标准输出，而是在一些字符串中“捕获”它们。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-01-28T08:30:47.267

是的，通常你使用像[soapUI](http://www.soapui.org/)这样的肥皂代理。只需将您的 Web 服务客户端指向代理，并将代理指向实际服务。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T23:24:25.497

Fiddler 或 SoapUI 将让您查看甚至更改路由中的请求/响应。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:31:58.697

是的，您可以使用数据包嗅探器查看流量中的内容。

我从来没有走到那一步。

我使用的是一个非常简单的自制协议，它读取所有输入，打印并重新发送所有信息。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:52:21.887

[监视 HTTP、TCP 等的工具。Web 服务流量](https://stackoverflow.com/questions/120022/tool-to-monitor-http-tcp-etc-web-service-traffic)
可能很有用。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T09:26:17.607

如果您可以在提供 Web 服务的服务器上部署 servlet，您可能会考虑编写和部署一个简单的过滤器。您可以使用它来记录入站和出站流量。

# c# - 我怎样才能得到这个 XML 结构

> ID：486867
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T08:24:10.057
> 
>         
> 
> 标签：c#, .net, xml, web-services, asmx

我有一个 Web 服务，其输入对象类似于以下内容。

```
public class MyInput
{
    [System.Xml.Serialization.XmlArrayItem("Demographic")]
    public DemographicsInfo[] Demographics {get; set;}
} 
```

像这样定义 DemographicsInfo 类。

```
public class DemographicsInfo
{
    [System.Xml.Serialization.XmlAttributeAttribute()]
    public string Name { get; set; }
    public string Value { get; set; }
} 
```

现在这会生成一个这样的 XML 结构。

```
<Demographics>
    <Demographic Name="String">
        <value>string</value>
    </Demographic>
    <Demographic Name="String">
        <value>string</value>
    </Demographic>
</Demographics> 
```

我需要把它放进去

```
<Demographics>
    <Demographic Name="String">string</Demographic>
    <Demographic Name="String">string</Demographic>
</Demographics> 
```

在我的一生中，我似乎找不到合适的属性来应用来获得这种格式。有人有建议吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-28T08:29:29.547

如果你知道你想要的结构，最简单的选择是从 xml 中返回；将 xml 写入文件（`foo.xml`在我的情况下），然后（在命令行）：

```
xsd foo.xml
xsd foo.xsd /classes 
```

然后看看`foo.cs`怎么做；事实证明，您只需用 标记值`[System.Xml.Serialization.XmlTextAttribute()]`。

这是 xsd 输出：

```
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System.Xml.Serialization;

// 
// This source code was auto-generated by xsd, Version=2.0.50727.3038.
// 

/// <remarks/>
[System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true)]
[System.Xml.Serialization.XmlRootAttribute(Namespace="", IsNullable=false)]
public partial class Demographics {

    private DemographicsDemographic[] itemsField;

    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute("Demographic", Form=System.Xml.Schema.XmlSchemaForm.Unqualified, IsNullable=true)]
    public DemographicsDemographic[] Items {
        get {
            return this.itemsField;
        }
        set {
            this.itemsField = value;
        }
    }
}

/// <remarks/>
[System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true)]
public partial class DemographicsDemographic {

    private string nameField;

    private string valueField;

    /// <remarks/>
    [System.Xml.Serialization.XmlAttributeAttribute()]
    public string Name {
        get {
            return this.nameField;
        }
        set {
            this.nameField = value;
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlTextAttribute()]
    public string Value {
        get {
            return this.valueField;
        }
        set {
            this.valueField = value;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T08:32:18.447

看看 Marc 有什么，但我猜 Visual Studio 2005 和 2008 之间的区别。

我需要将以下内容添加到“Value”元素的声明中。

```
[System.Xml.Serialization.XmlText()]
public string Value { get; set; } 
```

它看起来像它的作品！

# perl - 使用 Perl 拉伸、调整大小或缩略图

> ID：486874
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-01-28T08:26:23.203
> 
>         
> 
> 标签：perl, thumbnails

如何使用 Perl 脚本拉伸或调整图像（任何格式）？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-28T08:47:26.700

我推荐 Image::Imlib2... 如果你可以在你的机器上安装 imlib2

参见文档：[Image::Imlib2](http://search.cpan.org/dist/Image-Imlib2/lib/Image/Imlib2.pm)

```
use Image::Imlib2;

# load image from file
my $image = Image::Imlib2->load("in.png");

# get some info if you want
my $width  = $image->width;
my $height = $image->height;

# scale the image down to $x and $y
# you can set $x or $y to zero and it will maintain aspect ratio
my $image2 = $image->create_scaled_image($x,$y);

# save thumbnail to file
$image2->save("out.png"); 
```

您可能还对[Image::Imlib2::Thumbnail 感兴趣](http://search.cpan.org/dist/Image-Imlib2-Thumbnail/lib/Image/Imlib2/Thumbnail.pm)，如果您无法安装 imlib2，请查看[Image::Magick](http://search.cpan.org/dist/PerlMagick/Magick.pm)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T08:33:28.460

您可以使用[Image::Resize](http://kobesearch.cpan.org/htdocs/Image-Resize/Image/Resize.html)。

# javascript - 测试对象是否是javascript中的jQuery对象的正确/正确方法是什么？

> ID：486881
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-01-28T08:28:57.533
> 
>         
> 
> 标签：javascript, jquery, scripting

我正在编写一个 javascript 函数，并且以“紧凑”的 javascript 设计方式，参数的类型/长度会改变函数的行为。一种可能的参数类型是 jQuery 对象，我想要非常特殊的逻辑。

测试对象是否是 jQuery 实例的最佳方法是什么？

* * *

## 回答 #1

> 赞同：20
> 
>             
> 
> 时间：2009-01-28T09:50:21.347

取决于 jQuery 的内部工作原理，但我会选择

```
obj instanceof jQuery 
```

这是最“JavaScript 方式”的做法。请记住，在窗口/框架边界之间传递对象时它将失败！

托马拉克的建议

```
'jquery' in obj 
```

在这种情况下应该仍然可以工作，因此如果您希望进行多窗口数据交换，则应该使用它。我不建议将其作为通用解决方案，因为仅查找名为的属性`'jquery'`并不是很可靠。

如果是原语，`in`运算符也会抛出错误。`obj`如果不希望出现这种行为，您可以考虑使用以下测试之一：

```
obj && obj.jquery
'jquery' in Object(obj) 
```

我发现第二个更有吸引力，但第一个可能会更快。

检查

```
Object(obj).hasOwnProperty('jquery') 
```

将失败，因为 jQuery 对象仅从其原型继承属性。

我也不鼓励`constructor`在 JavaScript 中使用该属性进行类型检查——它可能对 jQuery 可靠地工作，但正如`constructor`构造函数在实例化时所指向的对象的`prototype`属性一样，有很多方法可以解决这样的问题测试...

* * *

作为旁注：

jQuery 本身会检查`obj && obj.jquery`. 它甚至不使用`instanceof`一次。相反，它使用了`typeof`、duck-typing 和`toString.call()`类型检查的组合，这应该可以在`instanceof`失败的地方工作。

此外，`hasOwnProperty()`也从未使用过。我不确定这说明了 jQuery 库的代码质量；）

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-01-28T08:33:44.403

以下之一：

```
obj instanceof jQuery
obj && obj.constructor == jQuery
obj && obj.jquery 
```

[推荐使用](http://markmail.org/message/62a7ximsf7txfhb3)instanceof 

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2011-02-21T20:56:40.747

使用 this 而不是 instanceof 来测试 jQuery 对象。

```
/**
 * @see http://ajaxian.com/archives/working-aroung-the-instanceof-memory-leak
 * @return Boolean True if object is of type jQuery, false otherwise
 */
function isjQuery(obj) {
    return obj && obj.hasOwnProperty && obj instanceof jQuery;
} 
```

# com - 从 Outlook pst 文件释放内存时出现问题

> ID：486883
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T08:29:43.930
> 
>         
> 
> 标签：com, outlook, object

我正在开发一个访问 Outlook 个人文件夹的 win 应用程序。在内部，它将个人文件夹安装在 Outlook 实例上并处理邮件，然后卸载 pst。卸载 pst 后，我​​删除了该文件。

现在的问题是，即使在卸载 pst 并释放内存后，当我尝试删除 pst 时，我得到一个异常，即某些进程正在使用此文件，因此无法删除它。这个过程就是前景。我正在使用以下代码来卸载和释放内存：

```
 _application.Session.RemoveStore(_personalFolder);
 while (System.Runtime.InteropServices.Marshal.ReleaseComObject(_personalFolder) >= 0) ;
 _personalFolder = null; 
```

我检查了很多次，似乎释放内存需要一些时间，并且没有明确的时间。谁能帮我删除文件？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-30T09:38:36.967

查看[KB234228（“OL97：现在可配置 Outlook .pst 文件锁定释放间隔”）](http://support.microsoft.com/kb/234228)。它是关于 Outlook 97 的，但我猜它仍然有效。

我想[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)不会帮助你，因为没有“排他锁释放”事件。

因此，也许您可​​以创建一个工作线程，不断尝试删除您放入队列中的所有 .pst 文件。这样，您的应用程序 UI 至少可以不间断地运行。

[ProcMon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)之类的工具确实能够查看应用程序的文件句柄。也许您可以进行 API 调用，允许您为 Oulook 流程执行此操作（我猜，这是另一个 SO 问题的好材料）。这样您就不必轮询文件系统，并且可以在锁定消失时更快地采取行动。

如果您敢，您甚至可以尝试立即关闭有问题的文件句柄，从而完全无需轮询/等待。

# xcode - Xcode / GCC 链接问题：文件不是必需的架构

> ID：486885
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-01-28T08:30:01.493
> 
>         
> 
> 标签：xcode, macos, gcc, g++, linker

我正在尝试将包含 boost 1.37 和 wxwidgets 的 Windows 项目移植到 Mac。它编译正常，但链接器给我一个 libz.1.dylib 的“文件不是架构 ppc 所需的架构”错误，并且与其他一些库的警告相同的消息。我还收到 libz.1.dylib 的“重复 dylib”警告。

链接器输出如下所示：

使用配置“Debug”构建项目“Gemsweeper Mac”的目标“Gemsweeper Mac”</p>

检查依赖关系

```
Ld "/Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac/build/Debug/Gemsweeper Mac.app/Contents/MacOS/Gemsweeper Mac" normal i386
    cd "/Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac"
    setenv MACOSX_DEPLOYMENT_TARGET 10.4
    /Developer/usr/bin/g++-4.0 -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk "-L/Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac/build/Debug" -L/Developer/SDKs/MacOSX10.4u.sdk/usr/local/lib -L/opt/local/lib "-F/Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac/build/Debug" -F/Users/adriangrigore/Library/Frameworks -F/Developer/SDKs/MacOSX10.4u.sdk/Library/Frameworks -filelist "/Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac/build/Gemsweeper Mac.build/Debug/Gemsweeper Mac.build/Objects-normal/i386/Gemsweeper Mac.LinkFileList" -mmacosx-version-min=10.4 -L/opt/local/lib -L/Users/adriangrigore/wxwidgets-manual/wxMac-2.8.9/lib /opt/local/lib/libboost_system-mt.a /opt/local/lib/libboost_program_options-mt.a /opt/local/lib/libboost_thread-mt.a -arch ppc -arch i386 -framework IOKit -framework Carbon -framework Cocoa -framework System -framework QuickTime -framework OpenGL -framework AGL /Users/adriangrigore/wxwidgets-manual/wxMac-2.8.9/lib/libwx_mac-2.8.a -framework WebKit -lwxexpat-2.8 -lwxtiff-2.8 -lwxjpeg-2.8 -lwxpng-2.8 -lz -lpthread -liconv -framework SDL -framework Cocoa -o "/Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac/build/Debug/Gemsweeper Mac.app/Contents/MacOS/Gemsweeper Mac"
ld warning: in /Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac/build/Gemsweeper Mac.build/Debug/Gemsweeper Mac.build/Objects-normal/i386/main.o, file is not of required architecture
ld warning: in /Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac/build/Gemsweeper Mac.build/Debug/Gemsweeper Mac.build/Objects-normal/i386/variousfunctions-xcode.o, file is not of required architecture
ld warning: in /Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac/build/Gemsweeper Mac.build/Debug/Gemsweeper Mac.build/Objects-normal/i386/ParticleLayers.o, file is not of required architecture
ld warning: in /Users/adriangrigore/Documents/Gemsweeper Mac/Gemsweeper MacOS/Gemsweeper Mac/build/Gemsweeper Mac.build/Debug/Gemsweeper Mac.build/Objects-normal/i386/SDLMain.o, file is not of required architecture
ld warning: in /opt/local/lib/libboost_system-mt.a, file is not of required architecture
ld warning: in /opt/local/lib/libboost_program_options-mt.a, file is not of required architecture
ld warning: in /opt/local/lib/libboost_thread-mt.a, file is not of required architecture
ld warning: in /opt/local/lib/libz.dylib, file is not of required architecture
ld warning: in /opt/local/lib/libiconv.dylib, file is not of required architecture
ld: in /opt/local/lib/libz.1.dylib, file is not of required architecture for architecture ppc
collect2: ld returned 1 exit status
ld warning: duplicate dylib /opt/local/lib/libz.1.dylib
ld warning: duplicate dylib /opt/local/lib/libiconv.2.dylib 
```

我对 Mac 平台很陌生，因此将不胜感激任何帮助！

谢谢，

阿德里安

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T08:36:12.263

听起来您需要为 Mac 重新下载或重建 boost。无论 dylib 是什么，您都需要这样做。简单来说，你真的只需要重新安装库。

有了boost，你就不需要重新下载整个东西了，源本身是多平台的，只是二进制文件（库等）会随着平台的变化而变化。您可能已经下载了所有源代码，因此您只需要从源代码重建库。[http://www.boost.org/doc/libs/1_37_0/more/getting_started/unix-variants.html](http://www.boost.org/doc/libs/1_37_0/more/getting_started/unix-variants.html)为您提供了一些有关使用 bjam 构建 boost 的信息。我知道在 Windows 上他们已经预编译了二进制文件，但我在 Mac 的 boost 网站上看不到任何相关内容。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T08:44:44.773

从您收到的消息来看，大部分 Gemsweeper Mac 和 libboost 都是仅使用 ppc 作为架构编译的。您应该配置 Xcode 以生成通用二进制文件，并可能通过 MacPorts 重新编译 libboost。最近的 MacPorts 有一个“通用”目标可以提供帮助，但如果你不打算在 ppc 上运行它，你只需重新编译它。

您似乎还需要重新编译 zlib 和 libiconv。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T14:22:14.577

使用 sudo port xxx install +universal 卸载并重新安装 zlib 和 libiconv（以及十几个其他依赖库）有帮助。感谢您的快速回复！:-)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2013-01-29T17:56:16.507

您需要针对本机架构，而不是两个..“通用”架构。

这涉及将 xcode 设置为“构建机器的本机架构”、“仅构建活动架构”和“有效架构”，具体取决于您的 xcode 版本。但清除所有可能的架构变体。

那是因为使用默认值的提升`./b2 install`只会获得本机架构。

尝试重新安装boost`./b2 install toolset=intel`

一个可能的（且未尝试过的）解决方案是两次构建提升。

英特尔`./b2  install --prefix=/usr/local/x64 toolset=intel`

本国的`./b2 install --prefix=/usr/local/ppc`

# javascript - 使用 JavaScript 向 URL 添加参数

> ID：486896
> 
>         
> 
> 赞同：398
> 
>         
> 
> 时间：2009-01-28T08:33:12.457
> 
>         
> 
> 标签：javascript, url, parsing, parameters, query-string

在使用 AJAX 调用的 Web 应用程序中，我需要提交一个请求，但在 URL 的末尾添加一个参数，例如：

原网址：

> [http://server/myapp.php?id=10](http://server/myapp.php?id=10)

结果网址：

> [http://server/myapp.php?id=10](http://server/myapp.php?id=10) **&enabled=true**

寻找一个 JavaScript 函数来解析 URL 并查看每个参数，然后添加新参数或更新值（如果已存在）。

* * *

## 回答 #1

> 赞同：500
> 
>             
> 
> 时间：2017-05-24T14:12:24.287

您可以使用以下之一：

*   [https://developer.mozilla.org/en-US/docs/Web/API/URL](https://developer.mozilla.org/en-US/docs/Web/API/URL)

*   [https://developer.mozilla.org/en/docs/Web/API/URLSearchParams](https://developer.mozilla.org/en/docs/Web/API/URLSearchParams)

例子：

```
var url = new URL("http://foo.bar/?x=1&y=2");

// If your expected result is "http://foo.bar/?x=1&y=2&x=42"
url.searchParams.append('x', 42);

// If your expected result is "http://foo.bar/?x=42&y=2"
url.searchParams.set('x', 42); 
```

* * *

## 回答 #2

> 赞同：232
> 
>             
> 
> 时间：2009-01-28T09:50:48.897

您需要调整的基本实现如下所示：

```
function insertParam(key, value) {
    key = encodeURIComponent(key);
    value = encodeURIComponent(value);

    // kvp looks like ['key1=value1', 'key2=value2', ...]
    var kvp = document.location.search.substr(1).split('&');
    let i=0;

    for(; i<kvp.length; i++){
        if (kvp[i].startsWith(key + '=')) {
            let pair = kvp[i].split('=');
            pair[1] = value;
            kvp[i] = pair.join('=');
            break;
        }
    }

    if(i >= kvp.length){
        kvp[kvp.length] = [key,value].join('=');
    }

    // can return this or...
    let params = kvp.join('&');

    // reload page with new params
    document.location.search = params;
} 
```

这大约是基于正则表达式或搜索的解决方案的两倍，但这完全取决于查询字符串的长度和任何匹配的索引

* * *

我为完成而进行基准测试的慢正则表达式方法（大约慢了 150%）

```
function insertParam2(key,value)
{
    key = encodeURIComponent(key); value = encodeURIComponent(value);

    var s = document.location.search;
    var kvp = key+"="+value;

    var r = new RegExp("(&|\\?)"+key+"=[^\&]*");

    s = s.replace(r,"$1"+kvp);

    if(!RegExp.$1) {s += (s.length>0 ? '&' : '?') + kvp;};

    //again, do what you will here
    document.location.search = s;
} 
```

* * *

## 回答 #3

> 赞同：147
> 
>             
> 
> 时间：2019-07-08T10:34:10.457

```
const urlParams = new URLSearchParams(window.location.search);

urlParams.set('order', 'date');

window.location.search = urlParams; 
```

.set 第一个参数是键，第二个是值。

* * *

## 回答 #4

> 赞同：66
> 
>             
> 
> 时间：2009-12-16T21:36:29.880

谢谢大家的贡献。我使用**了 anakata**代码并进行了修改，以包括 url 中根本没有查询字符串的情况。希望这会有所帮助。

```
function insertParam(key, value) {
        key = escape(key); value = escape(value);

        var kvp = document.location.search.substr(1).split('&');
        if (kvp == '') {
            document.location.search = '?' + key + '=' + value;
        }
        else {

            var i = kvp.length; var x; while (i--) {
                x = kvp[i].split('=');

                if (x[0] == key) {
                    x[1] = value;
                    kvp[i] = x.join('=');
                    break;
                }
            }

            if (i < 0) { kvp[kvp.length] = [key, value].join('='); }

            //this will reload the page, it's likely better to store this until finished
            document.location.search = kvp.join('&');
        }
    } 
```

* * *

## 回答 #5

> 赞同：66
> 
>             
> 
> 时间：2011-01-26T23:05:45.047

这是非常简单的解决方案。它不控制参数的存在，也不改变现有值。它将您的参数添加到 end，因此您可以在后端代码中获取最新值。

```
function addParameterToURL(param){
    _url = location.href;
    _url += (_url.split('?')[1] ? '&':'?') + param;
    return _url;
} 
```

* * *

## 回答 #6

> 赞同：35
> 
>             
> 
> 时间：2010-04-13T13:45:50.550

这是一个大大简化的版本，权衡易读性和更少的代码行而不是微优化的性能（实际上，我们谈论的是几毫秒的差异......由于它的性质（在当前文档的位置上运行） ），这很可能会在页面上运行一次）。

```
/**
* Add a URL parameter (or changing it if it already exists)
* @param {search} string  this is typically document.location.search
* @param {key}    string  the key to set
* @param {val}    string  value 
*/
var addUrlParam = function(search, key, val){
  var newParam = key + '=' + val,
      params = '?' + newParam;

  // If the "search" string exists, then build params from it
  if (search) {
    // Try to replace an existance instance
    params = search.replace(new RegExp('([?&])' + key + '[^&]*'), '$1' + newParam);

    // If nothing was replaced, then add the new param to the end
    if (params === search) {
      params += '&' + newParam;
    }
  }

  return params;
}; 
```

然后你会像这样使用它：

```
document.location.pathname + addUrlParam(document.location.search, 'foo', 'bar'); 
```

* * *

## 回答 #7

> 赞同：24
> 
>             
> 
> 时间：2021-05-23T21:32:47.510

类中有一个内置函数`URL`，您可以使用它来轻松处理查询字符串键/值参数：

```
const url = new URL(window.location.href);
// url.searchParams has several function, we just use `set` function
// to set a value, if you just want to append without replacing value
// let use `append` function

url.searchParams.set('key', 'value');

console.log(url.search) // <== '?key=value'

// if window.location.href has already some qs params this `set` function
// modify or append key/value in it 
```

有关更多信息[`searchParams functions`](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams)。

`URL`IE不支持，请检查[兼容性](https://caniuse.com/url)

* * *

## 回答 #8

> 赞同：22
> 
>             
> 
> 时间：2013-01-22T23:29:10.253

```
/**
* Add a URL parameter 
* @param {string} url 
* @param {string} param the key to set
* @param {string} value 
*/
var addParam = function(url, param, value) {
   param = encodeURIComponent(param);
   var a = document.createElement('a');
   param += (value ? "=" + encodeURIComponent(value) : ""); 
   a.href = url;
   a.search += (a.search ? "&" : "") + param;
   return a.href;
}

/**
* Add a URL parameter (or modify if already exists)
* @param {string} url 
* @param {string} param the key to set
* @param {string} value 
*/
var addOrReplaceParam = function(url, param, value) {
   param = encodeURIComponent(param);
   var r = "([&?]|&amp;)" + param + "\\b(?:=(?:[^&#]*))*";
   var a = document.createElement('a');
   var regex = new RegExp(r);
   var str = param + (value ? "=" + encodeURIComponent(value) : ""); 
   a.href = url;
   var q = a.search.replace(regex, "$1"+str);
   if (q === a.search) {
      a.search += (a.search ? "&" : "") + str;
   } else {
      a.search = q;
   }
   return a.href;
}

url = "http://www.example.com#hashme";
newurl = addParam(url, "ciao", "1");
alert(newurl);
```

**请注意，参数应在附加到查询字符串之前进行编码。**

[http://jsfiddle.net/48z7z4kx/](http://jsfiddle.net/48z7z4kx/)

* * *

## 回答 #9

> 赞同：20
> 
>             
> 
> 时间：2009-01-28T10:11:28.920

我有一个这样做的“类”，它是：

```
function QS(){
    this.qs = {};
    var s = location.search.replace( /^\?|#.*$/g, '' );
    if( s ) {
        var qsParts = s.split('&');
        var i, nv;
        for (i = 0; i < qsParts.length; i++) {
            nv = qsParts[i].split('=');
            this.qs[nv[0]] = nv[1];
        }
    }
}

QS.prototype.add = function( name, value ) {
    if( arguments.length == 1 && arguments[0].constructor == Object ) {
        this.addMany( arguments[0] );
        return;
    }
    this.qs[name] = value;
}

QS.prototype.addMany = function( newValues ) {
    for( nv in newValues ) {
        this.qs[nv] = newValues[nv];
    }
}

QS.prototype.remove = function( name ) {
    if( arguments.length == 1 && arguments[0].constructor == Array ) {
        this.removeMany( arguments[0] );
        return;
    }
    delete this.qs[name];
}

QS.prototype.removeMany = function( deleteNames ) {
    var i;
    for( i = 0; i < deleteNames.length; i++ ) {
        delete this.qs[deleteNames[i]];
    }
}

QS.prototype.getQueryString = function() {
    var nv, q = [];
    for( nv in this.qs ) {
        q[q.length] = nv+'='+this.qs[nv];
    }
    return q.join( '&' );
}

QS.prototype.toString = QS.prototype.getQueryString;

//examples
//instantiation
var qs = new QS;
alert( qs );

//add a sinle name/value
qs.add( 'new', 'true' );
alert( qs );

//add multiple key/values
qs.add( { x: 'X', y: 'Y' } );
alert( qs );

//remove single key
qs.remove( 'new' )
alert( qs );

//remove multiple keys
qs.remove( ['x', 'bogus'] )
alert( qs ); 
```

我已经重写了 toString 方法，因此不需要调用 QS::getQueryString，您可以使用 QS::toString，或者，正如我在示例中所做的那样，只依赖被强制转换为字符串的对象。

* * *

## 回答 #10

> 赞同：12
> 
>             
> 
> 时间：2016-03-17T17:54:32.673

如果你有一个带有 url 的字符串，你想用一个参数来装饰，你可以试试这个：

```
urlstring += ( urlstring.match( /[\?]/g ) ? '&' : '?' ) + 'param=value'; 
```

这意味着***什么？***将是参数的前缀，但如果你已经有了***？***in `urlstring`, than ***&***将是前缀。

`encodeURI( paramvariable )`如果您没有硬编码参数，我也建议您这样做，但它在`paramvariable`; 或者如果你有有趣的角色。

有关该函数的用法，请参阅[javascript URL 编码。](https://stackoverflow.com/questions/332872/encode-url-in-javascript)`encodeURI`

* * *

## 回答 #11

> 赞同：9
> 
>             
> 
> 时间：2017-08-01T01:39:59.727

这是添加查询参数的简单方法：

```
const query = new URLSearchParams(window.location.search);
query.append("enabled", "true"); 
```

[仅此](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams)而已。

请注意[支持规格](https://caniuse.com/#feat=urlsearchparams)。

* * *

## 回答 #12

> 赞同：8
> 
>             
> 
> 时间：2015-04-16T21:54:08.890

有时我们`?`在最后的 URL 中看到，我发现了一些生成结果为`file.php?&foo=bar`. 我想出了我自己的解决方案，完全按照我的意愿工作！

```
location.origin + location.pathname + location.search + (location.search=='' ? '?' : '&') + 'lang=ar' 
```

注意：**location.origin**在 IE 中不起作用，[这里是它的修复](http://tosbourn.com/a-fix-for-window-location-origin-in-internet-explorer)。

* * *

## 回答 #13

> 赞同：7
> 
>             
> 
> 时间：2016-05-26T11:28:40.237

以下功能将帮助您在 URL 中添加、更新和删除参数。

//例子1和

```
var myURL = '/search';

myURL = updateUrl(myURL,'location','california');
console.log('added location...' + myURL);
//added location.../search?location=california

myURL = updateUrl(myURL,'location','new york');
console.log('updated location...' + myURL);
//updated location.../search?location=new%20york

myURL = updateUrl(myURL,'location');
console.log('removed location...' + myURL);
//removed location.../search 
```

//例子2

```
var myURL = '/search?category=mobile';

myURL = updateUrl(myURL,'location','california');
console.log('added location...' + myURL);
//added location.../search?category=mobile&location=california

myURL = updateUrl(myURL,'location','new york');
console.log('updated location...' + myURL);
//updated location.../search?category=mobile&location=new%20york

myURL = updateUrl(myURL,'location');
console.log('removed location...' + myURL);
//removed location.../search?category=mobile 
```

//例子3

```
var myURL = '/search?location=texas';

myURL = updateUrl(myURL,'location','california');
console.log('added location...' + myURL);
//added location.../search?location=california

myURL = updateUrl(myURL,'location','new york');
console.log('updated location...' + myURL);
//updated location.../search?location=new%20york

myURL = updateUrl(myURL,'location');
console.log('removed location...' + myURL);
//removed location.../search 
```

//例子4

```
var myURL = '/search?category=mobile&location=texas';

myURL = updateUrl(myURL,'location','california');
console.log('added location...' + myURL);
//added location.../search?category=mobile&location=california

myURL = updateUrl(myURL,'location','new york');
console.log('updated location...' + myURL);
//updated location.../search?category=mobile&location=new%20york

myURL = updateUrl(myURL,'location');
console.log('removed location...' + myURL);
//removed location.../search?category=mobile 
```

//例子5

```
var myURL = 'https://example.com/search?location=texas#fragment';

myURL = updateUrl(myURL,'location','california');
console.log('added location...' + myURL);
//added location.../search?location=california#fragment

myURL = updateUrl(myURL,'location','new york');
console.log('updated location...' + myURL);
//updated location.../search?location=new%20york#fragment

myURL = updateUrl(myURL,'location');
console.log('removed location...' + myURL);
//removed location.../search#fragment 
```

这是功能。

```
function updateUrl(url,key,value){
      if(value!==undefined){
        value = encodeURI(value);
      }
      var hashIndex = url.indexOf("#")|0;
      if (hashIndex === -1) hashIndex = url.length|0;
      var urls = url.substring(0, hashIndex).split('?');
      var baseUrl = urls[0];
      var parameters = '';
      var outPara = {};
      if(urls.length>1){
          parameters = urls[1];
      }
      if(parameters!==''){
        parameters = parameters.split('&');
        for(k in parameters){
          var keyVal = parameters[k];
          keyVal = keyVal.split('=');
          var ekey = keyVal[0];
          var evalue = '';
          if(keyVal.length>1){
              evalue = keyVal[1];
          }
          outPara[ekey] = evalue;
        }
      }

      if(value!==undefined){
        outPara[key] = value;
      }else{
        delete outPara[key];
      }
      parameters = [];
      for(var k in outPara){
        parameters.push(k + '=' + outPara[k]);
      }

      var finalUrl = baseUrl;

      if(parameters.length>0){
        finalUrl += '?' + parameters.join('&'); 
      }

      return finalUrl + url.substring(hashIndex); 
  } 
```

* * *

## 回答 #14

> 赞同：6
> 
>             
> 
> 时间：2009-01-28T10:04:09.027

这是我自己的尝试，但我会使用 annakata 的答案，因为它看起来更干净：

```
function AddUrlParameter(sourceUrl, parameterName, parameterValue, replaceDuplicates)
{
    if ((sourceUrl == null) || (sourceUrl.length == 0)) sourceUrl = document.location.href;
    var urlParts = sourceUrl.split("?");
    var newQueryString = "";
    if (urlParts.length > 1)
    {
        var parameters = urlParts[1].split("&");
        for (var i=0; (i < parameters.length); i++)
        {
            var parameterParts = parameters[i].split("=");
            if (!(replaceDuplicates && parameterParts[0] == parameterName))
            {
                if (newQueryString == "")
                    newQueryString = "?";
                else
                    newQueryString += "&";
                newQueryString += parameterParts[0] + "=" + parameterParts[1];
            }
        }
    }
    if (newQueryString == "")
        newQueryString = "?";
    else
        newQueryString += "&";
    newQueryString += parameterName + "=" + parameterValue;

    return urlParts[0] + newQueryString;
} 
```

另外，我在 stackoverflow 上的另一篇文章中找到了这个 jQuery 插件，如果你需要更多的灵活性，你可以使用它：
 http: [//plugins.jquery.com/project/query-object](http://plugins.jquery.com/project/query-object)

我认为代码将是（尚未测试）：

```
return $.query.parse(sourceUrl).set(parameterName, parameterValue).toString(); 
```

* * *

## 回答 #15

> 赞同：6
> 
>             
> 
> 时间：2013-05-23T19:23:06.703

查看[https://github.com/derek-watson/jsUri](https://github.com/derek-watson/jsUri)

javascript 中的 Uri 和查询字符串操作。

这个项目包含了 Steven Levithan 的优秀 parseUri 正则表达式库。您可以安全地解析各种形状和大小的 URL，无论它们是无效的还是可怕的。

* * *

## 回答 #16

> 赞同：6
> 
>             
> 
> 时间：2019-10-20T08:52:06.340

试试这个。

```
// uses the URL class
function setParam(key, value) {
            let url = new URL(window.document.location);
            let params = new URLSearchParams(url.search.slice(1));

            if (params.has(key)) {
                params.set(key, value);
            }else {
                params.append(key, value);
            }
        } 
```

* * *

## 回答 #17

> 赞同：5
> 
>             
> 
> 时间：2019-03-11T07:46:54.880

添加到@Vianney 的答案[https://stackoverflow.com/a/44160941/6609678](https://stackoverflow.com/a/44160941/6609678)

我们可以**在node中导入Built-in URL模块**如下

```
const { URL } = require('url'); 
```

**例子：** 

```
Terminal $ node
> const { URL } = require('url');
undefined
> let url = new URL('', 'http://localhost:1989/v3/orders');
undefined
> url.href
'http://localhost:1989/v3/orders'
> let fetchAll=true, timePeriod = 30, b2b=false;
undefined
> url.href
'http://localhost:1989/v3/orders'
>  url.searchParams.append('fetchAll', fetchAll);
undefined
>  url.searchParams.append('timePeriod', timePeriod);
undefined
>  url.searchParams.append('b2b', b2b);
undefined
> url.href
'http://localhost:1989/v3/orders?fetchAll=true&timePeriod=30&b2b=false'
> url.toString()
'http://localhost:1989/v3/orders?fetchAll=true&timePeriod=30&b2b=false' 
```

**有用的链接：**

[https://developer.mozilla.org/en-US/docs/Web/API/URL](https://developer.mozilla.org/en-US/docs/Web/API/URL) 
[https://developer.mozilla.org/en/docs/Web/API/URLSearchParams](https://developer.mozilla.org/en/docs/Web/API/URLSearchParams)

* * *

## 回答 #18

> 赞同：5
> 
>             
> 
> 时间：2020-07-15T13:55:31.580

它处理这样的 URL：

*   空的

*   没有任何参数

*   已经有一些参数

*   末尾有`?`，但同时没有任何参数

它不处理这样的 URL：

*   带有片段标识符（即哈希，#）

*   如果 URL 已经有必需的查询参数（那么会有重复）

工作于：

*   铬 32+

*   火狐 26+

*   Safari 7.1+

```
function appendQueryParameter(url, name, value) {
    if (url.length === 0) {
        return;
    }

    let rawURL = url;

    // URL with `?` at the end and without query parameters
    // leads to incorrect result.
    if (rawURL.charAt(rawURL.length - 1) === "?") {
        rawURL = rawURL.slice(0, rawURL.length - 1);
    }

    const parsedURL = new URL(rawURL);
    let parameters = parsedURL.search;

    parameters += (parameters.length === 0) ? "?" : "&";
    parameters = (parameters + name + "=" + value);

    return (parsedURL.origin + parsedURL.pathname + parameters);
} 
```

**带有 ES6 模板字符串的版本。**

工作于：

*   铬 41+

*   火狐 32+

*   Safari 9.1+

```
function appendQueryParameter(url, name, value) {
    if (url.length === 0) {
        return;
    }

    let rawURL = url;

    // URL with `?` at the end and without query parameters
    // leads to incorrect result.
    if (rawURL.charAt(rawURL.length - 1) === "?") {
        rawURL = rawURL.slice(0, rawURL.length - 1);
    }

    const parsedURL = new URL(rawURL);
    let parameters = parsedURL.search;

    parameters += (parameters.length === 0) ? "?" : "&";
    parameters = `${parameters}${name}=${value}`;

    return `${parsedURL.origin}${parsedURL.pathname}${parameters}`;
} 
```

* * *

## 回答 #19

> 赞同：4
> 
>             
> 
> 时间：2021-11-20T20:35:42.330

此解决方案使用更新的搜索参数更新窗口的当前 URL，而无需实际重新加载页面。这种方法在 PWA/SPA 上下文中很有用。

```
function setURLSearchParam(key, value) {
  const url = new URL(window.location.href);
  url.searchParams.set(key, value);
  window.history.pushState({ path: url.href }, '', url.href);
} 
```

* * *

## 回答 #20

> 赞同：3
> 
>             
> 
> 时间：2018-05-28T19:42:28.097

[Vianney Bajart 的回答](https://stackoverflow.com/a/44160941/7627752)是正确的；但是，只有当您拥有包含端口、主机、路径和查询的完整 URL 时， [URL](https://developer.mozilla.org/en-US/docs/Web/API/URL)才会起作用：

```
new URL('http://server/myapp.php?id=10&enabled=true') 
```

并且[URLSearchParams](https://developer.mozilla.org/fr/docs/Web/API/URLSearchParams)仅在您仅传递查询字符串时才有效：

```
new URLSearchParams('?id=10&enabled=true') 
```

如果您有一个不完整或相对的 URL 并且不关心基本 URL，您可以只拆分`?`以获取查询字符串并稍后加入，如下所示：

```
function setUrlParams(url, key, value) {
  url = url.split('?');
  usp = new URLSearchParams(url[1]);
  usp.set(key, value);
  url[1] = usp.toString();
  return url.join('?');
}

let url = 'myapp.php?id=10';
url = setUrlParams(url, 'enabled', true);  // url = 'myapp.php?id=10&enabled=true'
url = setUrlParams(url, 'id', 11);         // url = 'myapp.php?id=11&enabled=true' 
```

与 Internet Explorer 不兼容。

* * *

## 回答 #21

> 赞同：2
> 
>             
> 
> 时间：2011-08-31T10:33:25.330

我喜欢 Mehmet Fatih Yıldız 的回答，即使他没有回答整个问题。

在与他的回答相同的行中，我使用以下代码：

“它不控制参数的存在，也不会改变现有值。它将您的参数添加到末尾”

```
 /** add a parameter at the end of the URL. Manage '?'/'&', but not the existing parameters.
   *  does escape the value (but not the key)
   */
  function addParameterToURL(_url,_key,_value){
      var param = _key+'='+escape(_value);

      var sep = '&';
      if (_url.indexOf('?') < 0) {
        sep = '?';
      } else {
        var lastChar=_url.slice(-1);
        if (lastChar == '&') sep='';
        if (lastChar == '?') sep='';
      }
      _url += sep + param;

      return _url;
  } 
```

和测试仪：

```
 /*
  function addParameterToURL_TESTER_sub(_url,key,value){
    //log(_url);
    log(addParameterToURL(_url,key,value));
  }

  function addParameterToURL_TESTER(){
    log('-------------------');
    var _url ='www.google.com';
    addParameterToURL_TESTER_sub(_url,'key','value');
    addParameterToURL_TESTER_sub(_url,'key','Text Value');
    _url ='www.google.com?';
    addParameterToURL_TESTER_sub(_url,'key','value');
    _url ='www.google.com?A=B';
    addParameterToURL_TESTER_sub(_url,'key','value');
    _url ='www.google.com?A=B&';
    addParameterToURL_TESTER_sub(_url,'key','value');
    _url ='www.google.com?A=1&B=2';
    addParameterToURL_TESTER_sub(_url,'key','value');

  }//*/ 
```

* * *

## 回答 #22

> 赞同：2
> 
>             
> 
> 时间：2013-07-02T20:33:08.247

我会使用[这个](https://github.com/Mikhus/jsurl)小而完整的库来处理 js 中的 url：

[https://github.com/Mikhus/jsurl](https://github.com/Mikhus/jsurl)

* * *

## 回答 #23

> 赞同：2
> 
>             
> 
> 时间：2015-07-06T21:57:14.263

当涉及到像 Node.js 这样的服务器端的一些基本 url 参数添加或更新时，这就是我使用的。

咖啡脚本：

```
###
    @method addUrlParam Adds parameter to a given url. If the parameter already exists in the url is being replaced.
    @param {string} url
    @param {string} key Parameter's key
    @param {string} value Parameter's value
    @returns {string} new url containing the parameter
###
addUrlParam = (url, key, value) ->
    newParam = key+"="+value
    result = url.replace(new RegExp('(&|\\?)' + key + '=[^\&|#]*'), '$1' + newParam)
    if result is url
        result = if url.indexOf('?') != -1 then url.split('?')[0] + '?' + newParam + '&' + url.split('?')[1]
    else if url.indexOf('#') != -1 then url.split('#')[0] + '?' + newParam + '#' + url.split('#')[1]
    else url + '?' + newParam
    return result
```

JavaScript：

```
function addUrlParam(url, key, value) {
    var newParam = key+"="+value;
    var result = url.replace(new RegExp("(&|\\?)"+key+"=[^\&|#]*"), '$1' + newParam);
    if (result === url) { 
        result = (url.indexOf("?") != -1 ? url.split("?")[0]+"?"+newParam+"&"+url.split("?")[1] 
           : (url.indexOf("#") != -1 ? url.split("#")[0]+"?"+newParam+"#"+ url.split("#")[1] 
              : url+'?'+newParam));
    }
    return result;
}

var url = "http://www.example.com?foo=bar&ciao=3&doom=5#hashme";
result1.innerHTML = addUrlParam(url, "ciao", "1");
```

```
<p id="result1"></p>
```

* * *

## 回答 #24

> 赞同：2
> 
>             
> 
> 时间：2017-07-13T10:17:53.823

最简单的解决方案，无论您是否已经有标签都可以使用，并自动将其删除，因此它不会继续添加相同的标签，玩得开心

```
function changeURL(tag)
{
if(window.location.href.indexOf("?") > -1) {
    if(window.location.href.indexOf("&"+tag) > -1){

        var url = window.location.href.replace("&"+tag,"")+"&"+tag;
    }
    else
    {
        var url = window.location.href+"&"+tag;
    }
}else{
    if(window.location.href.indexOf("?"+tag) > -1){

        var url = window.location.href.replace("?"+tag,"")+"?"+tag;
    }
    else
    {
        var url = window.location.href+"?"+tag;
    }
}
  window.location = url;
} 
```

然后

```
changeURL("i=updated"); 
```

* * *

## 回答 #25

> 赞同：1
> 
>             
> 
> 时间：2013-02-21T19:42:59.050

如果您在链接或其他地方弄乱了网址，您可能还必须考虑哈希。这是一个相当简单易懂的解决方案。可能不是*最快*的  ，因为它使用了正则表达式……但在 99.999% 的情况下，差异真的无关紧要！

```
function addQueryParam( url, key, val ){
    var parts = url.match(/([^?#]+)(\?[^#]*)?(\#.*)?/);
    var url = parts[1];
    var qs = parts[2] || '';
    var hash = parts[3] || '';

    if ( !qs ) {
        return url + '?' + key + '=' + encodeURIComponent( val ) + hash;
    } else {
        var qs_parts = qs.substr(1).split("&");
        var i;
        for (i=0;i<qs_parts.length;i++) {
            var qs_pair = qs_parts[i].split("=");
            if ( qs_pair[0] == key ){
                qs_parts[ i ] = key + '=' + encodeURIComponent( val );
                break;
            }
        }
        if ( i == qs_parts.length ){
            qs_parts.push( key + '=' + encodeURIComponent( val ) );
        }
        return url + '?' + qs_parts.join('&') + hash;
    }
} 
```

* * *

## 回答 #26

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T12:07:52.583

好的，这里我比较两个函数，一个是我自己做的（regExp），另一个是（an​​nakata）做的。

拆分数组：

```
function insertParam(key, value)
{
    key = escape(key); value = escape(value);

    var kvp = document.location.search.substr(1).split('&');

    var i=kvp.length; var x; while(i--) 
    {
        x = kvp[i].split('=');

        if (x[0]==key)
        {
                x[1] = value;
                kvp[i] = x.join('=');
                break;
        }
    }

    if(i<0) {kvp[kvp.length] = [key,value].join('=');}

    //this will reload the page, it's likely better to store this until finished
    return "&"+kvp.join('&'); 
} 
```

正则表达式方法：

```
function addParameter(param, value)
{
    var regexp = new RegExp("(\\?|\\&)" + param + "\\=([^\\&]*)(\\&|$)");
    if (regexp.test(document.location.search)) 
        return (document.location.search.toString().replace(regexp, function(a, b, c, d)
        {
                return (b + param + "=" + value + d);
        }));
    else 
        return document.location.search+ param + "=" + value;
} 
```

测试案例：

```
time1=(new Date).getTime();
for (var i=0;i<10000;i++)
{
addParameter("test","test");
}
time2=(new Date).getTime();
for (var i=0;i<10000;i++)
{
insertParam("test","test");
}

time3=(new Date).getTime();

console.log((time2-time1)+" "+(time3-time2)); 
```

似乎即使使用最简单的解决方案（当正则表达式仅使用测试并且不输入 .replace 函数时）它仍然比拆分慢......嗯。正则表达式有点慢但是......呃......

* * *

## 回答 #27

> 赞同：0
> 
>             
> 
> 时间：2014-06-18T18:13:34.863

这就是我所做的。使用我的 editParams() 函数，您可以添加、删除或更改任何参数，然后使用内置的 replaceState() 函数更新 URL：

```
window.history.replaceState('object or string', 'Title', 'page.html' + editParams('enable', 'true'));

// background functions below:

// add/change/remove URL parameter
// use a value of false to remove parameter
// returns a url-style string
function editParams (key, value) {
  key = encodeURI(key);

  var params = getSearchParameters();

  if (Object.keys(params).length === 0) {
    if (value !== false)
      return '?' + key + '=' + encodeURI(value);
    else
      return '';
  }

  if (value !== false)
    params[key] = encodeURI(value);
  else
    delete params[key];

  if (Object.keys(params).length === 0)
    return '';

  return '?' + $.map(params, function (value, key) {
    return key + '=' + value;
  }).join('&');
}

// Get object/associative array of URL parameters
function getSearchParameters () {
  var prmstr = window.location.search.substr(1);
  return prmstr !== null && prmstr !== "" ? transformToAssocArray(prmstr) : {};
}

// convert parameters from url-style string to associative array
function transformToAssocArray (prmstr) {
  var params = {},
      prmarr = prmstr.split("&");

  for (var i = 0; i < prmarr.length; i++) {
    var tmparr = prmarr[i].split("=");
    params[tmparr[0]] = tmparr[1];
  }
  return params;
} 
```

* * *

## 回答 #28

> 赞同：0
> 
>             
> 
> 时间：2017-01-20T16:47:40.980

尽我所能告诉以上答案都没有解决查询字符串包含参数的情况，这些参数本身就是一个数组，因此会出现不止一次，例如：

```
http://example.com?sizes[]=a&sizes[]=b 
```

以下函数是我写的 update `document.location.search`。它将一个键/值对数组的数组作为参数，它将返回后者的修订版本，您可以随心所欲地做任何事情。我这样使用它：

```
var newParams = [
    ['test','123'],
    ['best','456'],
    ['sizes[]','XXL']
];
var newUrl = document.location.pathname + insertParams(newParams);
history.replaceState('', '', newUrl); 
```

如果当前网址是：

`http://example.com/index.php?test=replaceme&sizes[]=XL`

这会让你

`http://example.com/index.php?test=123&sizes[]=XL&sizes[]=XXL&best=456`

**功能**

```
function insertParams(params) {
    var result;
    var ii = params.length;
    var queryString = document.location.search.substr(1);
    var kvps = queryString ? queryString.split('&') : [];
    var kvp;
    var skipParams = [];
    var i = kvps.length;
    while (i--) {
        kvp = kvps[i].split('=');
        if (kvp[0].slice(-2) != '[]') {
            var ii = params.length;
            while (ii--) {
                if (params[ii][0] == kvp[0]) {
                    kvp[1] = params[ii][1];
                    kvps[i] = kvp.join('=');
                    skipParams.push(ii);
                }
            }
        }
    }
    var ii = params.length;
    while (ii--) {
        if (skipParams.indexOf(ii) === -1) {
            kvps.push(params[ii].join('='));
        }
    }
    result = kvps.length ? '?' + kvps.join('&') : '';
    return result;
} 
```

* * *

## 回答 #29

> 赞同：0
> 
>             
> 
> 时间：2017-08-27T17:34:39.727

**试试**

正则表达式，这么慢，于是：

```
var SetParamUrl = function(_k, _v) {// replace and add new parameters

    let arrParams = window.location.search !== '' ? decodeURIComponent(window.location.search.substr(1)).split('&').map(_v => _v.split('=')) : Array();
    let index = arrParams.findIndex((_v) => _v[0] === _k); 
    index = index !== -1 ? index : arrParams.length;
    _v === null ? arrParams = arrParams.filter((_v, _i) => _i != index) : arrParams[index] = [_k, _v];
    let _search = encodeURIComponent(arrParams.map(_v => _v.join('=')).join('&'));

    let newurl = window.location.protocol + "//" + window.location.host + window.location.pathname + (arrParams.length > 0 ? '?' +  _search : ''); 

    // window.location = newurl; //reload 

    if (history.pushState) { // without reload  
        window.history.pushState({path:newurl}, null, newurl);
    }

};

var GetParamUrl = function(_k) {// get parameter by key

    let sPageURL = decodeURIComponent(window.location.search.substr(1)),
        sURLVariables = sPageURL.split('&').map(_v => _v.split('='));
    let _result = sURLVariables.find(_v => _v[0] === _k);
    return _result[1];

}; 
```

**例子：**

```
 // https://some.com/some_path
        GetParamUrl('cat');//undefined
        SetParamUrl('cat', "strData");// https://some.com/some_path?cat=strData
        GetParamUrl('cat');//strData
        SetParamUrl('sotr', "strDataSort");// https://some.com/some_path?cat=strData&sotr=strDataSort
        GetParamUrl('sotr');//strDataSort
        SetParamUrl('cat', "strDataTwo");// https://some.com/some_path?cat=strDataTwo&sotr=strDataSort
        GetParamUrl('cat');//strDataTwo
        //remove param
        SetParamUrl('cat', null);// https://some.com/some_path?sotr=strDataSort 
```

* * *

## 回答 #30

> 赞同：0
> 
>             
> 
> 时间：2018-02-02T11:14:10.423

借助 JS 中的新成就，可以将查询参数添加到 URL：

```
var protocol = window.location.protocol,
    host = '//' + window.location.host,
    path = window.location.pathname,
    query = window.location.search;

var newUrl = protocol + host + path + query + (query ? '&' : '?') + 'param=1';

window.history.pushState({path:newUrl}, '' , newUrl); 
```

也看到这种可能性[Moziila URLSearchParams.append()](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams/append)

* * *

## 回答 #31

> 赞同：0
> 
>             
> 
> 时间：2018-03-24T12:48:22.443

这适用于所有现代浏览器。

```
function insertParam(key,value) {
      if (history.pushState) {
          var newurl = window.location.protocol + "//" + window.location.host + window.location.pathname + '?' +key+'='+value;
          window.history.pushState({path:newurl},'',newurl);
      }
    } 
```

* * *

## 回答 #32

> 赞同：0
> 
>             
> 
> 时间：2019-07-10T07:05:58.307

重置所有查询字符串

```
var params = { params1:"val1", params2:"val2" };
let str = jQuery.param(params);

let uri = window.location.href.toString();
if (uri.indexOf("?") > 0)
   uri = uri.substring(0, uri.indexOf("?"));

console.log(uri+"?"+str);
//window.location.href = uri+"?"+str;
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
```

* * *

## 回答 #33

> 赞同：0
> 
>             
> 
> 时间：2022-01-05T19:57:34.530

以下：

*   合并重复的查询字符串参数

*   适用于绝对和相对 URL

*   在浏览器和节点中工作

```
/**
 * Adds query params to existing URLs (inc merging duplicates)
 * @param {string} url - src URL to modify
 * @param {object} params - key/value object of params to add
 * @returns {string} modified URL
 */
function addQueryParamsToUrl(url, params) {

    // if URL is relative, we'll need to add a fake base
    var fakeBase = !url.startsWith('http') ? 'http://fake-base.com' : undefined;
    var modifiedUrl = new URL(url || '', fakeBase);

    // add/update params
    Object.keys(params).forEach(function(key) {
        if (modifiedUrl.searchParams.has(key)) {
            modifiedUrl.searchParams.set(key, params[key]);
        }
        else {
            modifiedUrl.searchParams.append(key, params[key]);
        }
    });

    // return as string (remove fake base if present)
    return modifiedUrl.toString().replace(fakeBase, '');
} 
```

例子：

```
// returns /guides?tag=api
addQueryParamsToUrl('/guides?tag=hardware', { tag:'api' })

// returns https://orcascan.com/guides?tag=api
addQueryParamsToUrl('https://orcascan.com/guides?tag=hardware', { tag: 'api' }) 
```

* * *

## 回答 #34

> 赞同：0
> 
>             
> 
> 时间：2022-03-06T03:44:42.260

```
const params = new URLSearchParams(window.location.search);

params.delete(key)
window.history.replaceState({}, "", decodeURIComponent(`${window.location.pathname}?${params}`)); 
```

* * *

## 回答 #35

> 赞同：-2
> 
>             
> 
> 时间：2012-09-26T20:10:22.140

```
var MyApp = new Class();

MyApp.extend({
    utility: {
        queryStringHelper: function (url) {
            var originalUrl = url;
            var newUrl = url;
            var finalUrl;
            var insertParam = function (key, value) {
                key = escape(key);
                value = escape(value);

                //The previous post had the substr strat from 1 in stead of 0!!!
                var kvp = newUrl.substr(0).split('&');

                var i = kvp.length;
                var x;
                while (i--) {
                    x = kvp[i].split('=');

                    if (x[0] == key) {
                        x[1] = value;
                        kvp[i] = x.join('=');
                        break;
                    }
                }

                if (i < 0) {
                    kvp[kvp.length] = [key, value].join('=');
                }

                finalUrl = kvp.join('&');

                return finalUrl;
            };

            this.insertParameterToQueryString = insertParam;

            this.insertParams = function (keyValues) {
                for (var keyValue in keyValues[0]) {
                    var key = keyValue;
                    var value = keyValues[0][keyValue];
                    newUrl = insertParam(key, value);
                }
                return newUrl;
            };

            return this;
        }
    }
}); 
```

# graphics - 显卡上的 XNA

> ID：486907
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T08:39:00.103
> 
>         
> 
> 标签：graphics, xna

如何使用 XNA 在显卡上编程图形？

（如何将工作负载转移到显卡上）

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-28T09:06:50.827

以非常简化的方式解释：

所有的图形都是由显卡自动绘制的。XNA 中没有软件渲染器模式。

XNA 的设置方式将大多数几何图形传输到显卡顶点缓冲区对象。然后，图形卡将固定的管线近似或着色器应用于数据并显示在屏幕上。

简而言之：如果您想在图形卡上对数据进行操作。使用顶点和像素着色器。

编辑：

您还应该深入研究图形管道的细节，以更好地了解图形卡的工作原理。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-28T10:14:55.510

[http://www.riemers.net](http://www.riemers.net)是一个了解 XNA 和一般图形编程的好站点。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T08:43:24.243

您是否尝试过通过 DirectX 做一些像素着色器？NVIDIA 有[编程指南](http://developer.nvidia.com/object/gpu_programming_guide.html)。您可能还想查看[GP GPU](http://www.gpgpu.org)。

# c# - XElement 的子级

> ID：486912
> 
>         
> 
> 赞同：67
> 
>         
> 
> 时间：2009-01-28T08:42:23.887
> 
>         
> 
> 标签：c#, xml, linq-to-xml, xelement

如何只获取 XElement 的子级？

我目前正在使用 XElement.Descendants() 函数，它返回所有级别的 XElement，而不仅仅是子节点。

我真正想要的是一个只有孩子的 IEnumerable。

* * *

## 回答 #1

> 赞同：107
> 
>             
> 
> 时间：2009-01-28T10:00:45.133

[一个XElement](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.aspx)的直接子元素可以通过调用[`Element()`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xcontainer.element.aspx)or[`Elements()`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.elements.aspx)函数来访问。使用带有名称的重载来访问特定元素，或者不使用重载来访问所有子元素。

还有类似的方法[`Attribute()`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.attribute.aspx)，[`Attributes()`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.attributes.aspx)您可能会觉得有用。

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2009-01-28T08:46:24.580

XElement.Nodes() 应该可以得到你想要的。

如果您只想要 XElement 子节点，那么您可能需要限制它（取决于您的 XML）：

```
XElement.Nodes().OfType<XElement>() 
```

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-01-28T08:46:00.323

[XElement.Nodes](http://msdn.microsoft.com/en-us/library/system.xml.linq.xcontainer.nodes.aspx)

# c# - C#：是否应该将泛型类中的嵌套类视为泛型？

> ID：486917
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-01-28T08:44:19.483
> 
>         
> 
> 标签：c#, generics, reflection

```
namespace GenericsTest
{
    public class AGenericClass<T>
    {
        public class NestedNonGenericClass
        {
        }
    }
} 
```

在上面的例子中，应该`NestedNonGenericClass`被认为是一个泛型类吗？

反射API说它是一个泛型类，甚至把包含类的模板参数作为嵌套类的模板参数交给我。

```
Type nestedClass = typeof(AGenericClass<int>.NestedNonGenericClass);
Console.Out.WriteLine("IsGeneric: {0}\tHasGenericArguments: {1}", 
   nestedClass.IsGenericType, nestedClass.GetGenericArguments().Length > 0); 
```

这打印出来：

> IsGeneric: True HasGenericArguments: True

我不完全同意这种行为。即使编译器为 生成泛型类型`NestedNonGenericClass`，我也想知道它是否是泛型，因为它是这样声明的，还是因为它的容器是泛型的。

所以，我的问题是：

首先，您认为可以考虑嵌套类泛型，因为它的容器是泛型的吗？为什么/为什么不？

其次，您是否碰巧知道其他一些 API 可以帮助我仅识别被声明为泛型的类？

PS：我在泛型的 ECMA 规范中找不到与此相关的任何内容（或者我可能只是掩盖了它）。

- 编辑 - 

为了添加更多上下文，我正在开发一种代码生成器。我正在使用反射 API 来确定一个类型是否是泛型的。

我遇到了一个问题`Dictionary<TKey, TValue>.KeyCollection`。

对于`KeyCollection`，反射 API 说它是通用的并将其交给我`TKey`并`TValue`在容器中声明。所以，生成器最终生成`Dictionary<TKey, TValue>.KeyCollection<Tkey, TValue>`

我可以解决这个问题的唯一方法是将嵌套类的模板参数与容器的模板参数匹配并消除所有匹配的参数。但我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-01-28T08:46:57.467

简而言之，是的 - 类型从包含它的任何类型继承类型参数：这是诸如`List<T>.Enumerator`和许多其他场景等的关键 - 它们共享`T`来自外部类（不仅仅是 any `T`）是至关重要的。

ECMA 参考文献是§25.1：

> 嵌套在泛型类声明或泛型结构声明（第 25.2 节）内的任何类本身就是泛型类声明，因为应提供包含类型的类型参数以创建构造类型。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-01-28T08:51:46.630

是的，您的嵌套类绝对是泛型的，因为 T 绑定到嵌套类的任何实例范围内的类型（这称为**封闭泛型）。**

```
using System;
using System.Collections.Generic;

public class AGenericClass<T> {
    public class NestedNonGenericClass {
        public void DoSomething() {
            Console.WriteLine("typeof(T) == " + typeof(T));
        }
    }
}

public class MyClass {
    public static void Main()   {
        var c = new AGenericClass<int>.NestedNonGenericClass();
        var d = new AGenericClass<DateTime>.NestedNonGenericClass();
        c.DoSomething();
        d.DoSomething();
        Console.ReadKey(false); 
    }

} 
```

根据泛型类型的关闭方式，相同的`DoSomething()`方法会产生不同的输出 - 所以是的，内部类肯定表现出泛型行为。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T08:49:10.723

如果您不打算在 NestedNonGenericClass 中使用 T ，则可以将其放在类之外并使其私有..那么它就不是通用的....

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T09:03:11.460

我选择理解它的方式是，当您使用泛型类型时，C# 会生成该类型的所有内容。真的，如果我要想象如果我使用上面示例中的 AGenericClass 和 AGenericClass 会生成什么，你最终会得到嵌套类的两个副本：

```
public class AGenericClass<int>
{
    public class NestedNonGenericClass
    {
    }
}

public class AGenericClass<float>
{
    public class NestedNonGenericClass
    {
    }
} 
```

因此，我会将嵌套类视为泛型类，因为它有两个版本，一个称为 AGenericClass<int>.NestedNonGenericClass，另一个称为 AGenericClass<float>.NestedNonGenericClass。真的，就像您明确指定嵌套类也是泛型一样。如果您希望嵌套类适应泛型类型，此行为可能非常有用。

但是，我发现我不能再像在普通类上那样使用嵌套类，这很烦人。对不起，我不记得确切的例子了，但我知道一旦我不得不将一个类移出泛型，以便我可以从代码中的其他地方按预期使用它。它违背了我一直用于嵌套类的通常模式，所以我不喜欢它，但这是唯一的方法。因此，如果您不同意这样做的方式，我可以理解，但老实说，我认为这样做的方式是最清晰的方式。我的意思是，您和编译器都非常清楚，如果您将嵌套类移到外部并将其作为常规类使用，您不希望编译器将其生成为泛型。我不认为他们可以改进这一点。

# database - 数据库模式设计 - 提高归档能力的技巧？

> ID：486919
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-28T08:44:49.827
> 
>         
> 
> 标签：database, database-design, schema, archive

我正在数据库中设计一个表，它将存储来自应用程序的日志条目。有几件事让我比平时更多地考虑这个设计。

*   然而，系统将在运行时使用这些日志条目来做出决定，因此它们需要相对快速地访问。

*   他们还有一个问题是他们会很多（我估计每月增加 1250 万）。

*   我最多不需要超过过去 30 到 45 天的时间来进行决策处理。

*   对于支持和法律问题，我需要将所有这些保留超过 45 天，可能至少 2 年。

*   表设计相当简单，所有简单类型（没有 blob 或任何东西），在可能的情况下将使用数据库引擎放入默认数据，最多一个外键。

*   如果有任何不同，数据库将是 Microsoft SQL Server 2005。

我在想的是让它们写入实时表/数据库，然后使用 ETL 解决方案将“旧”条目移动到存档表/数据库 - 它很大并且在较慢的硬件上。

我的问题是您是否知道数据库/表设计的任何提示、技巧或建议，以确保它尽可能好地工作？另外，如果您认为这是一个坏主意，请告诉我，您认为更好的主意是什么。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T09:36:28.083

一些数据库提供“分区”（例如 Oracle）。分区就像一个视图，它将具有相同定义的多个表收集到一个中。您可以定义将新数据分类到不同表中的标准（例如，月份或一年中的一周 %6）。

从用户的角度来看，这只是一张桌子。从数据库 PoV 来看，它是几个独立的表，因此您可以高效地对它们运行全表命令（如截断、删除、从表中删除（无条件）、加载/转储等）。

如果你不能有一个分区，你会得到与视图类似的效果。在这种情况下，您可以在单个视图中收集多个表并重新定义该视图，例如，每月一次以从其余表中“释放”一个包含旧数据的表。现在，您可以高效地归档此表，清除它并在完成大工作后再次将其附加到视图中。这应该对提高性能有很大帮助。

[编辑] SQL server 2005 及更高版本（企业版）支持分区。感谢[米奇小麦](https://stackoverflow.com/users/16076/mitch-wheat)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T10:06:46.790

大表速度很快，使用 ETL 从大表中提取基于日期的数据然后删除旧行是一个很大的性能开销。对此的答案是使用多个表 - 根据您的数据可能每月 1 个表。当然，您需要一些逻辑来在查询中生成表名。

我同意使用触发器来填充“CurrentMonthAudit”表，在月底，您可以将该表重命名为 MonthAuditYYYYMM。使用 ETL 将旧表从您的主服务器移出将很容易，并且您的每个表都将是可管理的。相信我，这比尝试管理大约 2.5 亿行的单个表要好得多。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T10:17:22.260

你的第一个好决定是让一切尽可能简单。

我对您的简单只写事务日志文件模式很幸运，其中记录只是按时间顺序排列。然后，您有几个选项可用于切换过时的数据。只要您牢记简单，即使每月拥有不同的表也是可管理的查询方式。如果您有任何类型的复制在运行，您的复制表可以展开并用作存档。然后在每个月的第一天从一张新的空桌子开始。

通常我对做这样的事情的关系设计后果感到不寒而栗，但我发现只写按时间顺序排列的日志表是通常设计模式的一个例外，因为你在这里处理的原因。

但远离触发器。越远越好。最简单的解决方案是您在此处讨论的那种类型的主表，具有简单、健壮且经过时间验证的复制机制。

（顺便说一句 - 如果设计得当，大桌子不会很​​快变慢 - 它们会变慢。）

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T12:21:45.380

如果您不需要搜索最近的日志记录，还有另一种选择：根本不使用数据库。相反，将日志信息写入文件并每晚轮换文件名。写入文件后，您可以启动后台作业将数据直接导入存档数据库。

数据库并不总是最好的选择，尤其是对于日志文件 :)

# parsing - LR1 解析器和 Epsilon

> ID：486920
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-28T08:45:10.433
> 
>         
> 
> 标签：parsing, compiler-theory, lr1

我试图了解 LR1 解析器是如何工作的，但我遇到了一个奇怪的问题：如果语法包含 Epsilons 怎么办？例如：如果我有语法：

```
S -> A
A -> a A | B
B -> a 
```

很清楚如何开始：

```
S -> .A
A -> .a A 
A -> .B 
```

... 等等

但我不知道如何为这样的语法做：

```
S -> A
A -> a A a | \epsilon 
```

这样做是否正确：

```
S -> .A
A -> .a A a
( A -> .\epsilon ) 
```

然后让这个状态在 DFA 中接受？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-28T12:44:15.303

是的，完全正确（将 epsilon 视为空白空间，两侧的点没有两个位置）。

在 LR(0) 自动机中，您可以使状态接受并归约为 A。但是，由于`A->a A a`产生，会有移位/归约冲突。

`a`在 LR(1) 自动机中，您将使用前瞻（ -> shift，`FOLLOW(A)`-> reduce 中的任何内容）确定是移位还是减少

见[维基百科文章](http://en.wikipedia.org/wiki/LR_parser)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2021-02-04T12:28:37.053

您可以使用此站点来计算：
 [https ://cyberzhg.github.io/toolbox/lr1](https://cyberzhg.github.io/toolbox/lr1)

查看结果：

[![在此处输入图像描述](https://i.stack.imgur.com/b36Zx.png)](https://i.stack.imgur.com/b36Zx.png)

# asp.net - ASP.Net - 多个动态图像。由于 Http 请求过多导致的性能问题

> ID：486924
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-28T08:46:16.563
> 
>         
> 
> 标签：asp.net, performance, image, httphandler

我使用 HttpHandler 在 ASP.Net Web 应用程序中动态提供图像。我遇到了性能问题（Firfox/Firebug/YSlow 报告 HttpRequest 太多）

在某些情况下，我每页有 50-100 张图像。3 个树视图（业务单位/类别/对象），每个节点都有自己的图像；）

每个项目的图像 url 都是这样动态设置的......

SomeImage.ImageUrl = "/image.axd?ImageId={0}";

注意：我只知道在运行时需要哪些图像。

附加：图像位于服务器文件系统、资源文件和数据库中 - 用户可以上传自己的图像以与我的系统对象相关联，ImageHandler 将动态确定每个图像位置）

在 web.config 中，httphandler 已配置并按预期工作...添加 verb="GET" path="image.axd" type="Vision.OnsightManager.ImageHandler"

在 HttpHandler 中，原始图像字节被返回以响应每个图像请求。所以在图像处理程序的 WriteResponse() 方法中，图像字节被返回，就像这样......

context.Response.BinaryWrite(字节);

所有图像都正确显示，但应用程序在显示许多图像时出现预期的性能问题......

问题：

除了减少图像数量 ;) 之外，您还推荐什么方法来最小化为每个图像生成的所有 HttpRequest？也许组合成一个 Http 请求？

我已经阅读了关于将多个 css 请求组合成一个请求、使用图像映射（带有偏移的单个组合图像）等的文章，但似乎没有一个适合我的特定场景？

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-28T09:24:59.607

减少服务器对重复请求的压力的一种方法是使用页面可缓存性。

在 HttpHandler 中的 Response.Write 之前添加：

```
// Set for how long you want the image to be cached.
context.Response.Cache.SetExpires(DateTime.Now.AddDays(1)); 
context.Response.Cache.SetCacheability(HttpCacheability.Public);
context.Response.Cache.SetValidUntilExpires(true);
context.Response.Cache.VaryByParams["ImageId"] = true; 
```

这将使服务器缓存结果（取决于 ImageId 参数），但这当然只会有助于对同一图像的重复请求，而不是第一个，因此这取决于实际问题出在哪里。

在不太了解您的应用程序的情况下，听起来您必须更改几件事才能找到更好的解决方案...

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T08:59:36.427

这听起来不是处理图像的好方法。在第一种情况下，您应该通过将图像作为真实图像放在服务器上而不是通过 ASP 页面获取它们来为您的服务器节省一些痛苦。

然后，您将内容到期时间设置为将来的某个阶段。这至少会使后续请求更简单。

我也会尝试对图像进行一些合理化。即使您有三个树视图，您也可能会找到许多共同的元素。

最后，虽然这需要一些工作来实现，但您可以组合图像服务器端，因此您只返回一个图像的树，如果您这样做，我会确保您将结果缓存在某处，因为它会将负载放在服务器上在它生成的同时。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T09:00:15.130

您可以尝试在您的 asp.net 配置文件中增加工作线程的数量。

更多信息可以在这里找到：

[http :](http://williablog.net/williablog/post/2008/12/02/Increase-ASPNET-Scalability-Instantly.aspx) 
[//williablog.net/williablog/post/2008/12/02/Increase-ASPNET-Scalability-Instantly.aspx http://msdn.microsoft.com/en-us/library/ ms187024.aspx](http://msdn.microsoft.com/en-us/library/ms187024.aspx)

我还要补充一点，HTTP 标准将与单个服务器的同时连接数限制为每个客户端只有 2 个连接。IE 当然强制执行此限制，但我相信 Firefox 将自身限制为 4。恐怕这些限制是客户端可配置的（您无法从服务器端更改它们）。

# c# - 如何从 WPF KeyDown 事件中获取正常字符？

> ID：486927
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-01-28T08:47:04.207
> 
>         
> 
> 标签：c#, wpf, events, keyboard

`e.Key`我想要由WPF`KeyDown`事件的属性传递的 ASCII 字符。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2020-03-24T10:03:55.610

您可以使用 TextInput 事件而不是 KeyDown 吗？TextCompositionEventArgs 类允许您直接检索通过 e.text 属性输入的文本

```
private void UserControl_TextInput(
    object sender, 
    System.Windows.Input.TextCompositionEventArgs e)
{
     var t = e.Text;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-28T09:05:57.367

不幸的是，没有简单的方法可以做到这一点。有 2 种解决方法，但它们在某些情况下都会失败。

第一个是将其转换为字符串：

```
TestLabel.Content = e.Key.ToString(); 
```

这将为您提供 CapsLock 和 Shift 等内容，但是，对于字母数字键，当时它无法告诉您 shift 等的状态，因此您必须弄清楚这一点你自己。

第二种选择是使用 TextInput 事件，其中 e.Text 将包含实际输入的文本。这将为您提供字母数字键的正确字符，但不会为您提供控制字符。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T09:40:28.903

从您的简洁问题来看，我假设您需要一种方法来获取按下的键的 ASCII 值。这应该工作

```
private void txtAttrName_KeyDown(object sender, KeyEventArgs e)
        {
            Console.WriteLine(e.Key.ToString());
            char parsedCharacter = ' ';
            if (Char.TryParse(e.Key.ToString(), out parsedCharacter))
            {
                Console.WriteLine((int) parsedCharacter);
            }
        } 
```

例如，如果您按 Ctrl + S，您会看到以下输出。

```
LeftCtrl
S
83 
```

* * *

## 回答 #4

> 赞同：-4
> 
>             
> 
> 时间：2011-03-24T21:52:56.200

```
System.Enum.ToObject(e.Key.GetType(), (byte)e.Key).ToString(); 
```

# java - 在 Windows XP 中使用 JNDI 获取用户的组名

> ID：486938
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-28T08:52:29.997
> 
>         
> 
> 标签：java, windows, windows-xp, jndi

我听说过——我不确定它是来自可靠的来源还是来自实际做过的人——JNDI 可用于在 Windows 中访问用户的组名。我正在使用*Windows XP*。我不确定它是如何工作的，但听起来 Windows 使用活动目录来管理组（有人可以确认吗？）并且 JNDI 可能能够访问它来检索用户的组名。当我说“组”时，我指的是计算机上的组。像“管理员”或“用户”。

有谁知道如何做到这一点？有人做过吗？这是一件容易的事吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-02T12:49:15.893

You can use JNDI as the API to access LDAP, where user/group information are frequently stored.

I'd try and provide you with more details, but I'm really not an expert in this. Instead, I'd recommend you have a look at how Tomcat does this by looking at its JNDIRealm:
[http://tomcat.apache.org/tomcat-5.5-doc/realm-howto.html#JNDIRealm](http://tomcat.apache.org/tomcat-5.5-doc/realm-howto.html#JNDIRealm)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-02T12:22:19.177

You can try to do that via WMI as well. [It seems not quite easy](http://forums.sun.com/thread.jspa?threadID=5116320&tstart=15), and certainly it will require a handy help from your sysadmin.

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-29T14:06:01.967

我对它可能需要做什么有一个想法，但还没有测试我的理论。

Active Directory 支持以 LDAP 方式访问，因此也许您可以使用有关 JNDI 和 LDAP 的教程来访问 Active Directory。

[Active Directory](http://en.wikipedia.org/wiki/Active_Directory)的维基百科页面提到它是网络管理员可以用来在网络上传播更新的东西，也许这就是您的（可靠的）来源所指的组。如果它也适用于 Microsoft Windows 的常规版本，如 XP，那么它应该很容易设置。

# reporting-services - 报告服务虚拟目录

> ID：486940
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-28T08:54:49.667
> 
>         
> 
> 标签：reporting-services

我有 iis7 我已经使用商业智能工作室构建了报告，但我无法部署报告。它给出了“你没有连接到服务器”的错误，但我只在我的管理员帐户中安装了报告服务

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T09:56:45.533

您可以使用浏览器登录管理网站：[http://localhost/reports](http://localhost/reports) ???

# windows - 在 Windows XP 中获取用户的组名 - 使用任何可能的方式

> ID：486942
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-28T08:56:18.993
> 
>         
> 
> 标签：windows, windows-xp

我已经发布了关于如何在 JNDI 中执行此操作的类似问题，但在这篇文章中，我想知道如何使用 ANY INTERFACE 来执行此操作。  

我希望能够检索用户的组名。当我说“组”时，我指的是计算机上的组。像“管理员”或“用户”。

我可以通过命令行、应用程序、dll 或某种界面来完成吗？

有谁知道如何做到这一点？有人做过吗？这是一件容易的事吗？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-28T09:01:14.520

从命令行：

```
net user <username> 
```

或者如果他们在域上

```
net user <username> /domain 
```

底部是 2 个部分，本地组成员资格和全球组成员资格。

注意：一个用户可能有很多组（在我的工作中总共有 8 个！）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T09:05:48.630

这是VB中的一个示例（应该可以直接转换为另一种语言）：

```
Dim User as IADsUser
Dim Group as IADsGroup
Dim UserDomain as String
Dim UserName as String

UserDomain = "Target_User_Domain"
UserName = "Target_User_Name"
Set User = GetObject("WinNT://" & UserDomain & "/" & UserName & ",user")

For Each Group in User.Groups
   Debug.Print Group.NameNext 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T09:18:07.887

如果您想找出当前登录用户所属的组，您可以使用

```
System.Security.Principal.WindowsIdentity.GetCurrent().Groups 
```

**更新**

如果你想获得所有可用的组，**我认为**你必须使用 Windows API。但是为了检查当前用户是否在特定组中，您可以使用以下代码。

```
WindowsIdentity currentUser = WindowsIdentity.GetCurrent();
WindowsPrincipal principal = new WindowsPrincipal(currentUser);
bool isInGroup = principal.IsInRole("{Group Name}"); 
```

如果要检查内置 Windows 组，可以在 IsInRole 方法中使用 WindowsBuiltInRole 枚举。

# .net - 自定义 IQueryable

> ID：486947
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-28T08:58:32.077
> 
>         
> 
> 标签：.net, linq-to-sql, iqueryable

我正在尝试自定义应用程序的实体，以使它们具有引用加载它们的 DataContext 的属性。

我认为最好的方法是以某种方式创建一个实现 IQueryable 的类并在其 GetEnumerator 方法中设置实体 datacontext 属性。

我的问题是，如何在我的 IQueryable 实现中使用 Linq to SQL 使用的提供程序和表达式，这样我就不必自己实现它们了？

顺便说一句：对于我的场景，还有其他方法吗？

看看下面的代码：

```
public partial class Product: IEntityBase  
{ 

    public Product() 
    { 
        _DataContext = new SampleDataContext(); 
    } 

    private long _Id;  
    [Column(Storage="_Id", AutoSync=AutoSync.OnInsert, DbType="BigInt NOT NULL IDENTITY", IsPrimaryKey=true, IsDbGenerated=true)]  
    public long Id  
    {  
         get{ return _Id; }  
         set{ _Id = value; }  
    }  

    private string _Name;  
    [Column(Storage="_Name", DbType="NVarChar(MAX) NOT NULL", CanBeNull=false  
    public string Name  
    {  
        get{ return _Name; }  
        set{ _Name = value; }  
    }  

    private SampleDataContext _DataContext;  

    //This is the property extending the Product class and should be set when this class is being returned 
    //by IQueryable<T>.GetEnumerator() 
    public SampleDataContext DataContext  
    {  
        get{ return _Name; }  
        set{ _Name = value; }  
    }  

    public MyQueryable<Product> GetProducts() 
    { 
        MyQueryable<Product> result = from p in context.Products 
                                      where {Some Conditions 1} 
                                      select p; 
        result.DataContext = _DataContext; 
        return result; 
    } 

    public void SomeMethod() 
    { 
        //This query will not actually set the DataCotnext property. 
        //And the generated sql query is something like:  
        //SELECT * FROM Products WHERE {Some Conditions 1} AND {Some Conditions 2} 
        var products = GetProducts().Where( {Some Conditions 2} ); 

        //Now that the GetEnumerator() is called the DataContext property of the products 
        //will be set. 
        foreach( var item in products ) 
        { 
            item.Name = "Test Name"; 
            item.DataContext.SubmitChanges(); 
        } 
    } 
}  

public MyQueryable<T>: IQueryable<T> 
    where T: class, IEntityBase 
{ 
    // 
    //Implementation of IQueryable which is my question 
   // 

   public IEnumerator<T> GetEnumerator() 
   { 
       foreach( var item in Provider.GetEnumerator<T>() ) 
       { 
            item.DataContext = this.DataContext; 
            yield return item; 
       } 
   } 

   public SampleDataContext DataContext{ get; set; } 
} 

public interface IEntityBase 
{ 
    SampleDataContext DataContext{ get; set; }; 
} 
```

**更新**

我自己找到了答案。这是显示我如何做到这一点的示例代码。

```
public MyQueryable<T, TContext>: IQueryable<T> 
    where T: class, IEntityBase 
    where TContext: DataContext, new()
{ 

   public MyQueryable<T>(TContext context, IQueryable<T> baseIQueryable)
   {
        if( baseIQueryable == null )
            throw new ArgumentNullException("baseIQueryable");

        this.Provider = baseIQueryable.Provider;            
        this.Expression = baseIQueryable.Expression;

        this.DataContext = context;
   }

   public IEnumerator<T> GetEnumerator()
   {
       var enumerator = Provider.Execute<IEnumerable<T>>(Expression);
       foreach( var item in enumerator )
       {
           item.DataContext = this.DataContext ?? new TContext();
           yield return item;
       }
   }

   IEnumerator IEnumerable.GetEnumerator()
   {
       var enumerator = Provider.Execute<IEnumerable>(Expression);
       foreach( var item in enumerator )
       {
           ((IEntityBase<TContext>)item).DataContext = this.DataContext;
           yield return item;
       }
   } 

   //
   //Other implementations...
   //
   public SampleDataContext DataContext{ get; set; } 
} 

public partial class Product: IEntityBase
{
    public MyQueryable<Product> GetProducts() 
    { 
        var result = from p in context.Products 
                     where {Some Conditions 1} 
                     select p; 
        return new MyQueryable<typeof(Product), DataContext>(this.DataContext, result);
    }         
} 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T09:08:19.327

我想不出一个简单的方法来做到这一点。您不能在不破坏可组合性的情况下注入 LINQ-to-SQL 管道的中间。最简单的方法是通过 LINQ-to-Objects 作为最后一步：

```
public IEnumerable<Product> GetProducts() 
{ 
    IQueryable<Product> result = from p in context.Products 
                                  where {Some Conditions 1} 
                                  select p; 
    return result.AsEnumerable().Select( x => {
       x.SomeProp = context;
       return x;
    });
} 
```

但请注意，这破坏了可组合性——下游的一切都是 LINQ-to-Objects。

由于您的实体有一个通用的基类/接口，因此可以将其包装在扩展方法中以实现非常相似的行为（但更好地重用）：

```
 return result.AssociateWith(context); 
```

有类似的东西：

```
public static IEnumerable<T> AssociateWith<T>(
        this IEnumerable<T> source,
        DataContext context)
    where T : IEntityBase
{
    foreach(T item in source)
    {
        item.DataContext = context;
        yield return item;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-04T14:45:23.957

Wayward Weblog 有一个很好[的使用 IQueryable](http://blogs.msdn.com/mattwar/pages/linq-links.aspx)和相关[工具包](http://www.codeplex.com/IQToolkit)的教程。看起来您找到了适合您的解决方案。

我不确定你为什么要这样做，除非你试图让 LINQ to SQL 实体遵循[Active Record](http://martinfowler.com/eaaCatalog/activeRecord.html)模式。如果这是您的目标，我建议您在基础上添加静态 GetById、Query、Insert、Update 和 Delete 方法，并使用扩展方法将这些方法添加到实体中。在每个内部，您可以创建一个新的数据上下文，并在您准备好执行操作时将实体附加到该上下文。

DataContext 遵循[工作单元模式](http://www.martinfowler.com/eaaCatalog/unitOfWork.html)，因此，当您完成您执行的操作时，它应该[只在短时间内保持活动状态。](http://weblogs.asp.net/stephenwalther/archive/2008/08/19/asp-net-mvc-tip-34-dispose-of-your-datacontext-or-don-t.aspx)

# java - .NET 中的 LinkedHashMap

> ID：486948
> 
>         
> 
> 赞同：25
> 
>         
> 
> 时间：2009-01-28T08:58:39.003
> 
>         
> 
> 标签：java, .net, .net-3.5, linkedhashmap

`java.util.LinkedHashMap`我想知道.NET 中是否有对应物？（即，如果我访问一个元素，这些元素会自动（重新）排序。（布尔 accessOrder））。

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-01-28T09:28:00.893

只是为了向读者澄清一点：LinkedHashMap 仅在使用特定的构造函数重载构建时才会如此。通常，元素按插入顺序进行维护。（这对我来说有点奇怪，但没关系。）

我不相信.NET 中有任何这样的类。使用元素的链表和从键到链表节点的字典来构建一个并不难。然后访问将包括获取链表节点，将其移动到头部，并返回值。

如果您愿意，我很乐意在今晚或明天实施它 - 尽管可能没有完整的单元测试等。（全面测试集合是一项耗时的工作！）

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-01-28T09:27:30.210

一些谷歌搜索似乎表明没有内置的 C# 等效于 LinkedHashMap，但有一些第三方选项可用。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-06-05T15:05:13.917

[这是我在论坛](http://www.pcreview.co.uk/forums/thread-2134948.php)上找到的 C# 实现：

它没有记录，但确实有一些测试。然而，它不是通用的。至少这是我猜的。

@Jon：如果您能快速实施，我也将不胜感激。我认为 LinkedList 之上的 Dictionary 会是最好的，但[我听说](http://en.csharp-online.net/CSharp_Generics_Recipes%E2%80%94Implementing_a_Linked_List)LinkedList 存在垃圾收集问题，这会减慢速度。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2014-05-09T19:28:25.673

我使用 System.Collections.Specialized.OrderedDictionary 作为 LinkedHashMap 的替代品。它对我有用。OrderedDictionary 有什么我遗漏的吗（是的，它不是通用的，但它适用于 .Net 2 或更高版本）？

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2016-04-07T11:27:40.920

Nhibernate 有一个 NHibernate.Util.LinkedHashMap 实现。

如果您的代码中已经有它，就像我一样，它会很方便

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2021-10-25T15:20:43.780

我知道这是一个老话题，但是有一个很棒的开源项目可以`LinkedHashMap`在 .NET [C5中实现](https://www.nuget.org/packages/C5)

这是[LinkedHashMap](https://github.com/sestoft/C5/blob/master/C5/LinkedLists/HashedLinkedList.cs)源代码。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2020-04-21T02:48:02.800

由于 C# 中仍然没有 LinkedHashMap，而我需要这个功能，所以我在最新的 net core (3.1) 上实现了一个。[https://github.com/idlerboris/LinkedHashMap/blob/master/CustomCollections/CustomCollections/LinkedHashMap.cs](https://github.com/idlerboris/LinkedHashMap/blob/master/CustomCollections/CustomCollections/LinkedHashMap.cs)。它包含基本测试，看起来不错，但请随时贡献/报告问题。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2022-02-22T22:44:18.680

游戏已经很晚了，但我在 C# 中将 LinkedHashMap (Java) 等效实现为 LinkedDictionary，如下所示：

```
 public class LinkedDictionary<K, V> : IDictionary<K, V>, ICollection<KeyValuePair<K, V>>, IEnumerable<KeyValuePair<K, V>>
    {

    private List<K> list = new List<K>();
    private Dictionary<K, V> dictionary = new Dictionary<K, V>();

    public LinkedDictionary()
    {

    }

    public V this[K key] {
        get {
            return this.dictionary[key];
        }
        set {
            this.dictionary[key] = value;
            if (!this.list.Contains(key))
            {
                this.list.Add(key);
            }
        }
    }

    public int Count => this.dictionary.Count;

    public bool IsReadOnly => false;

    ICollection<K> IDictionary<K, V>.Keys => this.list;

    ICollection<V> IDictionary<K, V>.Values
    {
        get
        {
            List<V> values = new List<V>(this.dictionary.Count);
            foreach(K key in this.list)
            {
                V value = default(V);
                this.dictionary.TryGetValue(key, out value);
                values.Add(value);
            }
            return values;
        }
    }

    public void Add(KeyValuePair<K, V> item)
    {
        this.dictionary.Add(item.Key, item.Value);
        if (!this.list.Contains(item.Key))
        {
            this.list.Add(item.Key);
        }
    }

    public void Add(K key, V value)
    {
        this.dictionary.Add(key, value);
        if (!this.list.Contains(key))
        {
            this.list.Add(key);
        }
    }

    public void Clear()
    {
        this.dictionary.Clear();
        this.list.Clear();
    }

    public bool Contains(KeyValuePair<K, V> item)
    {
        return this.dictionary.Contains(item);
    }

    public bool ContainsKey(K key)
    {
        return this.dictionary.ContainsKey(key);
    }

    public void CopyTo(KeyValuePair<K, V>[] array, int arrayIndex)
    {
        throw new NotImplementedException();
    }

    public bool Remove(KeyValuePair<K, V> item)
    {
        if (this.Contains(item)){
            this.list.Remove(item.Key);
            return this.dictionary.Remove(item.Key);
        } else
        {
            return false;
        }
    }

    public bool Remove(K key)
    {
        if (this.dictionary.ContainsKey(key))
        {
            this.list.Remove(key);
            return this.dictionary.Remove(key);
        }
        else
        {
            return false;
        }
    }

     public bool TryGetValue(K key, [MaybeNullWhen(false)] out V value)
    {
        return this.dictionary.TryGetValue(key, out value);
    }

    public V Get(K key)
    {
        V value = default(V);
        this.dictionary.TryGetValue(key, out value);
        return value;
    }

    public IEnumerator<KeyValuePair<K, V>> GetEnumerator()
    {
        foreach (K key in this.list){
            V value = default(V);
            this.dictionary.TryGetValue(key, out value);
            yield return new KeyValuePair<K, V>(key, value);
        }
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }

    private class LinkedDictionaryIterator<K, V> : IEnumerator<V>
    {

        private int i;
        private readonly Dictionary<K, V> dictionary;
        private readonly List<K> list;

        public LinkedDictionaryIterator(Dictionary<K, V> dictionary, List<K> list)
        {
            this.dictionary = dictionary;
            this.list = list;
            this.i = 0;
        }

        public void Dispose()
        {

        }

        public bool MoveNext()
        {
            return this.i < this.dictionary.Count;
        }

        public void Reset()
        {
            this.i = 0;
        }

        public KeyValuePair<K, V> Current
        {
            get
            {
                int ii = this.i;
                ++this.i;
                V value = default(V);
                K key = this.list[ii];
                this.dictionary.TryGetValue(key, out value);
                return new KeyValuePair<K, V>(key, value);
            }
        }

        V IEnumerator<V>.Current
        {
            get
            {
                int ii = this.i;
                ++this.i;
                V value = default(V);
                K key = this.list[ii];
                this.dictionary.TryGetValue(key, out value);
                return value;
            }
        }

        object IEnumerator.Current
        {
            get
            {
                return Current;
            }
        }
    } 
```

还有一个简单的 UnitTest，我将它与 Dictionary 进行比较

```
 class UnitTest_LinkedDictionary
    {
        [Test]
        public void Test00()
        {
            LinkedDictionary<string, int> d = new LinkedDictionary<string, int>();

            d.Add("1", 1);
            d.Add("2", 2);
            d.Add("3", 3);
            d.Remove("2");
            d.Add("4", 4);

            d.Select(i => $"{i.Key}: {i.Value}").ToList().ForEach(Console.WriteLine);

        }

        [Test]
        public void Test01()
        {
            Dictionary<string, int> d = new Dictionary<string, int>();

            d.Add("1", 1);
            d.Add("2", 2);
            d.Add("3", 3);
            d.Remove("2");
            d.Add("4", 4);

            d.Select(i => $"{i.Key} :{i.Value}").ToList().ForEach(Console.WriteLine);

        }

    } 
```

由于它基于字典和列表，它至少增加了列表访问和字典访问的时间复杂度。

# perl - $_ 比 Perl 的 foreach 中的命名变量更有效吗？

> ID：486949
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-01-28T08:58:55.943
> 
>         
> 
> 标签：perl, variables, loops, performance

我是 Perl 的新手，我想知道以下哪个循环更有效：

```
my @numbers = (1,3,5,7,9);
foreach my $current (@numbers){
    print "$current\n";
} 
```

或者

```
my @numbers = (1,3,5,7,9);
foreach (@numbers){
    print "$_\n";
} 
```

我想知道这一点是为了知道 $_ 的使用是否更有效，因为它被放置在寄存器中，因为它是常用的还是不常用的。我已经编写了一些代码，我正在尝试清理它，我发现我使用第一个循环比第二个循环更频繁。

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-01-28T09:04:44.903

您是否发现使用这些循环的代码部分存在性能问题？如果没有，您想选择更具可读性和可维护性的版本。速度上的任何差异都可能可以忽略不计，尤其是与系统的其他部分相比。始终首先为可维护性编写代码，然后是配置文件，然后是性能代码

> “过早的优化是万恶之源”[1]

[1] 克努斯，唐纳德。带有 go 语句的结构化编程，ACM 期刊计算调查，第 6 卷，第 4 期，1974 年 12 月。第 268 页。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-01-28T09:46:36.130

即使知道*过早的优化是万恶之源*

```
{
  local $\ = "\n";
  print foreach @numbers;
} 
```

但有些期望可能是错误的。测试有点奇怪，因为输出会产生一些奇怪的副作用，而且顺序很重要。

```
#!/usr/bin/env perl
use strict;
use warnings;
use Benchmark qw(:all :hireswallclock);

use constant Numbers => 10000;

my @numbers = (1 .. Numbers);

sub no_out (&) {
    local *STDOUT;
    open STDOUT, '>', '/dev/null';
    my $result  = shift()->();
    close STDOUT;
    return $result;
};

my %tests = (
    loop1 => sub {
        foreach my $current (@numbers) {
            print "$current\n";
        }
    },
    loop2 => sub {
        foreach (@numbers) {
            print "$_\n";
        }

    },
    loop3 => sub {
        local $\ = "\n";
        print foreach @numbers;
        }
);

sub permutations {
    return [
        map {
            my $a = $_;
            my @f = grep {$a ne $_} @_;
            map { [$a, @$_] } @{ permutations( @f ) }
            } @_
        ]
        if @_;
    return [[]];
}

foreach my $p ( @{ permutations( keys %tests ) } ) {
    my $result = {
        map {
            $_ => no_out { sleep 1; countit( 2, $tests{$_} ) }
            } @$p
    };

    cmpthese($result);
} 
```

可以预期 loop2 应该比 loop1 快

```
 Rate loop2 loop1 loop3
loop2 322/s    --   -2%  -34%
loop1 328/s    2%    --  -33%
loop3 486/s   51%   48%    --
       Rate loop2 loop1 loop3
loop2 322/s    --   -0%  -34%
loop1 323/s    0%    --  -34%
loop3 486/s   51%   50%    --
       Rate loop2 loop1 loop3
loop2 323/s    --   -0%  -33%
loop1 324/s    0%    --  -33%
loop3 484/s   50%   49%    --
       Rate loop2 loop1 loop3
loop2 317/s    --   -3%  -35%
loop1 328/s    3%    --  -33%
loop3 488/s   54%   49%    --
       Rate loop2 loop1 loop3
loop2 323/s    --   -2%  -34%
loop1 329/s    2%    --  -33%
loop3 489/s   51%   49%    --
       Rate loop2 loop1 loop3
loop2 325/s    --   -1%  -33%
loop1 329/s    1%    --  -32%
loop3 488/s   50%   48%    -- 
```

有时我一直观察到`loop1`比大约快 15%-20%，`loop2`但我无法确定原因。

我观察到为 loop1 和 loop2 生成了字节码，并且在创建`my`变量时只有一个不同。这个变量内部没有分配也没有复制，因此这个操作非常便宜。我认为差异仅来自`"$_\n"`不便宜的构造。这些循环应该非常相似

```
for (@numbers) {
  ...
}

for my $a (@numbers) {
  ...
} 
```

但是这个循环更昂贵

```
for (@numbers) {
  my $a = $_;
  ...
} 
```

并且

```
print "$a\n"; 
```

比贵

```
print $a, "\n"; 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-01-28T09:03:45.280

你可以看看[这个教程](http://docstore.mik.ua/orelly/linux/cgi/ch17_01.htm)，还有一章“Benchmark Your Code”你可以用来比较这两种方法。

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2009-01-28T09:55:25.753

基准：

```
use Benchmark qw(timethese cmpthese);

my $iterations = 500000;     

cmpthese( $iterations,
  {
    'Loop 1' => 'my @numbers = (1,3,5,7,9);
    foreach my $current (@numbers)
    {
      print "$current\n";
    }', 

    'Loop 2' => 'my @numbers = (1,3,5,7,9);
    foreach (@numbers)
    {
      print "$_\n";
    }'
  }
); 
```

输出：

```
 Rate     Loop 2 Loop 1
Loop 2  23375/s     --    -1%
Loop 1  23546/s     1%     -- 
```

我已经运行了几次，结果各不相同。我认为可以肯定地说没有太大区别。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T13:56:54.017

> 我对使用 $_ 而不是打印的一般想法更感兴趣......

附带说明一下，如果您想开始学习要避免哪些习惯用法以及为什么要避免使用， *Perl Best Practices是一个不错的选择。*我不同意他写的所有东西，但他大多数时候都在现场。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-08-11T16:26:10.613

通过“ ”运行这两个选项`perl -MO=Concise,-terse,-src test.pl`，得到这两个 OpTree：

**`for my $n (@num){ ... }`**

```
LISTOP (0x9c08ea0) 离开 [1]
    OP (0x9bad5e8) 输入
# 5: 我的@num = 1..9;
    COP (0x9b89668) 下一个状态
    BINOP (0x9b86210) 分配 [4]
        UNOP (0x9bacfa0) 空 [142]
            OP (0x9b905e0) 推送标记
            UNOP (0x9bad5c8) rv2av
                SVOP (0x9bacf80) 常量 [5] AV (0x9bd81b0)
        UNOP (0x9b895c0) 空 [142]
            OP (0x9bd95f8) 推送标记
            OP (0x9b4b020) padav [1]
# 6: 对于我的 $n (@num){
    COP (0x9bd12a0) 下一个状态
    BINOP (0x9c08b48) 离开循环
        循环 (0x9b1e820) 输入 [6]
            操作 (0x9b1e808) 空 [3]
            UNOP (0x9bd1188) 空 [142]
                OP (0x9bb5ab0) 推送标记
                OP (0x9b8c278) padav [1]
        UNOP (0x9bdc290) 空
            LOGOP (0x9bdc2b0) 和
                操作 (0x9b1e458) 迭代
                LISTOP (0x9b859b8)
# 7: 说 $n;
                    COP (0x9be4f18) 下一个状态
                    LISTOP (0x9b277c0) 说
                        OP (0x9c0edd0) 推送标记
                        OP (0x9bda658) padsv [6] # <===
                    OP (0x9b8a2f8) 取消堆栈

```

**`for(@num){ ... }`**

```
LISTOP (0x8cdbea0) 离开 [1]
    OP (0x8c805e8) 输入
# 5: 我的@num = 1..9;
    COP (0x8c5c668) 下一个状态
    BINOP (0x8c59210) 分配 [4]
        UNOP (0x8c7ffa0) 空 [142]
            OP (0x8ccc1f0) 推送标记
            UNOP (0x8c805c8) rv2av
                SVOP (0x8c7ff80) 常量 [7] AV (0x8cab1b0)
        UNOP (0x8c5c5c0) 空 [142]
            OP (0x8cac5f8) 推送标记
            OP (0x8c5f278) padav [1]
# 6: for (@num){
    COP (0x8cb7f18) 下一个状态
    BINOP (0x8ce1de8) 离开循环
        循环 (0x8bf1820) 输入器
            操作 (0x8bf1458) 空 [3]
            UNOP (0x8caf2b0) 空 [142]
                OP (0x8bf1808) 推送标记
                OP (0x8c88ab0) padav [1]
            PADOP (0x8ca4188) gv GV (0x8bd7810) *_ # <===
        UNOP (0x8cdbb48) 空
            LOGOP (0x8caf290) 和
                操作 (0x8ce1dd0) 迭代
                LISTOP (0x8c62aa8) 行序列
# 7: 说 $_;
                    COP (0x8cade88) 下一个状态
                    LISTOP (0x8bf12d0) 说
                        OP (0x8cad658) 推送标记
                        UNOP (0x8c589b8) null [15] # <===
                            PADOP (0x8bfa7c0) gvsv GV (0x8bd7810) *_ # <===
                    OP (0x8bf9a10) 取消堆栈

```

我添加了“ `<===`”来标记两者之间的差异。

`for(@num){...}`如果您注意到“ ”版本实际上有更多操作。

因此，如果有的话，“ `for(@num){...}`”版本可能比“ `for my $n (@num){...}`”版本慢。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T09:17:21.070

Using`$_`是一个 Perl 习惯用法，它向经验丰富的程序员表明使用了“当前上下文”。此外，许多函数`$_`默认作为参数，从而使代码更简洁。

有些人也可能只是争辩说，“它很难写，应该很难读”。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T09:05:46.727

我不知道，但是……首先你在循环的第二个版本中保存一个变量赋值。我可以想象，由于 $_ 经常使用，它应该以某种方式进行优化。您可以尝试分析它，一个非常好的 Perl 分析器是Tim Bunce 编写的[NYTProf 2 。](http://search.cpan.org/~timb/Devel-NYTProf-2.07/lib/Devel/NYTProf.pm)

那么，这些小东西真的值得优化吗？我不认为循环会有所作为。我建议您使用分析器来衡量您的性能并确定真正的瓶颈。通常，速度问题位于运行 90% 时间的 10% 代码中（也许不会是 10-90，但这是“著名”比率：P）。

# java - 如何处理陈旧的连接？

> ID：486964
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-28T09:05:17.820
> 
>         
> 
> 标签：java, hibernate, exception, web-applications, db2

我们是一个 J2EE 应用程序，在 Websphere 6.1 上使用 Struts-EJB-Hibernate 和 Mainframe/DB2 后端，最近已转移到生产环境。  

**当用户第一次登录应用程序时，我们会收到过时的连接异常**，或者有时会间歇性地发生此异常。

在第二次尝试用户能够登录到应用程序。我得到的确切错误信息是

```
empcom.ibm.websphere.ce.cm.StaleConnectionException: 
Execution failed due to a distribution protocol error that caused deallocation of the conversation.  
The command requested could not be completed because of a permanent error condition detected at the target system.  
DB2ConnectionCorrelator: AC100B80.A260.090107181206 
```

**我在 webshere 设置中启用`PRETEST`了选项，**并将间隔设置为 60 秒，但我仍然遇到这个问题..

请分享您的观点并帮助我

如果你需要，我可以给你更多细节。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-25T12:32:06.380

早上第一次登录我们的一个生产系统时，我们遇到了同样的问题。解决方案是将连接池的最小大小设置为零。

将最小大小设置为大于零（例如，一）的值，当检测到超时连接无效时，将从池中删除它们，但其中一些（在上面的示例中，最后一个）保留在池中（如果最小大小为 1，则一个连接保留在池中，即使它还不是有效连接）。

下次应用程序请求连接时，将提供无效的连接，从而导致异常。

将最小大小设置为零，所有无效连接都从池中删除，因此提供给应用程序的连接不可能是无效的（因为，如果它是有效的，它会留在池中，如果不是，从池中删除）。

使用预测试可能是一种有效的替代方法，但需要付出额外的努力，因为每次将连接提供给应用程序时，都会进行测试。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-29T06:30:43.123

我得到了这个答案

使用预测试旧连接和新连接我们可以解决这个问题.. 预测试查询应该是一个基本查询（从 .. 中选择 sysdate），它可以随时运行..

并且时间间隔应该是最大的，因此应用程序服务器不会得到开销

# ms-access - 当我从另一个进程读取 Access 数据库时，为什么它不是最新的？

> ID：486970
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-28T09:07:12.027
> 
>         
> 
> 标签：ms-access, vb6, ado, jet

在我的应用程序中，我做了以下事情：

1.  使用 Jet/ADO 和 VB6 打开 Access 数据库 (.mdb)

2.  用新数据清除并重新填充表格

3.  关闭数据库

4.  启动另一个处理新数据的进程。

问题是*有时*第二个进程找不到新数据。有时表只是空的，有时 RecordCount > 0，但 EOF 为真，我不能执行 MoveFirst 或 MoveNext。简而言之：各种奇怪的东西。

我目前的解决方法是在关闭数据库和启动第二个进程之间添加延迟。

*   这里发生了什么？

*   我能做点什么吗？（除了使用不同的数据库）

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-01-28T10:06:56.197

只是一个猜测，但我可能是因为 Jet 引擎具有读取缓存和延迟写入功能：

[如何在 Jet 4.0 和 ADO 2.1 中实现多用户自定义计数器](http://support.microsoft.com/kb/240317/en-us)

“Microsoft Jet 有一个读取缓存，每 PageTimeout 毫秒更新一次（默认为 5000ms = 5 秒）。它还有一个惰性写入机制，该机制在一个单独的线程上运行到主处理，因此异步将更改写入磁盘。这两个机制有助于提高性能，但在某些需要高并发的情况下，它们可能会产生问题。”

该文章建议使用 Jet 的 RefreshCache 方法并将 Jet OLEDB:Transaction Commit Mode 设置为 1 毫秒（ADO 优于 Jet 的 DAO 的一个优点是您可以更改此设置而无需更改注册表中的值）。

PS你应该考虑编辑Access数据库（.mdb）来提及'Jet'并使用'Jet'标签，否则你会得到某个SO用户的评论，他对这些事情很挑剔:)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T10:21:28.353

此[Microsoft 知识库文章](http://support.microsoft.com/kb/200300)解释了如何执行此操作。

这是示例代码的摘录。该代码使用来自一个进程的两个连接，因此您需要将阅读部分拉入第二个进程。

1.  写入者必须在写入数据之前使用 ADO 的 Connection.BeginTrans 启动事务。

2.  编写者必须进行数据库更新，然后提交事务（使用 ADO 的 Connection.CommitTrans）。

3.  读取器在尝试读取数据之前必须调用 JRO.JetEngine.RefreshCache 传入它的连接。

请注意，通过向您的 VB 项目添加对 Microsoft Jet And Replication Objects 2.1 Library 的引用来包含 JRO.JetEngine。

```
 Sub SyncReadDemo()
    Dim conn1 As New ADODB.Connection
    Dim conn2 As New ADODB.Connection
    Dim rs As New ADODB.recordset
    Dim JRO As New JRO.JetEngine
    Dim strConnect As String
    Dim i As Long

  ' Set up our connection string (requires a database named c:\db1.mdb).
    strConnect = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:\db1.mdb"

    ' Open connection 1 and drop and re-create test table.
    conn1.CursorLocation = adUseServer
    conn1.Open strConnect
    On Error Resume Next
    conn1.Execute "drop table tmpTest", , _
        adExecuteNoRecords + adCmdText
    On Error GoTo 0
    conn1.Execute "create table tmpTest (id long)", , _
        adExecuteNoRecords + adCmdText

    ' Close connection 1 to flush the creation of table tmpTest. 
    conn1.Close

    ' Now open connection 1 and connection 2.
    conn1.Open strConnect
    conn2.Open strConnect

    ' Insert 10 records using connection 1.
    ' Note we must perform all writes inside of a transaction.
    conn1.BeginTrans
    For i = 1 To 10
        conn1.Execute "insert into tmpTest (id) values (1)", , _
            adExecuteNoRecords + adCmdText
    Next i
    conn1.CommitTrans

    ' Refresh cache for reader connection.
    JRO.RefreshCache conn2
    Set rs = conn2.Execute("select * from tmpTest", , adCmdText)

    ' Count records in our table (should be 10).
    i = 0
    While Not rs.EOF
        i = i + 1
        rs.MoveNext
    Wend
    rs.Close

    MsgBox "Read " & i & " records using different connections."

    conn1.Close
    conn2.Close

End Sub 
```

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2009-01-28T09:17:53.160

由于第一个进程是唯一打开 MDB 的进程，因此将内容写回文件可能有点懒惰。即使在您结束进程之后，在操作系统写回未完成的页面时也可能会出现延迟，这可能在进程发出已完成的信号后发生。

我的建议是，停止使用 Access，改用 SQL Server 2008 Express。

# .net - 使用 XLINQ 解析 XHTML 文件的库

> ID：486975
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-28T09:09:46.547
> 
>         
> 
> 标签：.net, xml, linq, xhtml, linq-to-xml

当我意识到我需要为大约 50 个 XHTML 页面创建一个索引时，这些页面将来可能会被添加/删除/重命名/移动，我想“没问题——我将使用 LINQ to XML 编写一个快速索引生成器，因为XHTML 绝对算作 XML”。

当然，当我尝试运行它时，我发现 XLINQ 会阻塞像   这样的 XHTML 实体。我通过使用以下算法解决了这个问题：

1.  将 XHTML 文件读入字符串。

2.  在该字符串上使用正则表达式搜索和替换将一个部分添加到定义所有相关实体的 DOCTYPE 中（因为我只关心我读取的文件中的“标题”属性，而我的输出文件现在不使用任何实体，它只是将它们全部设置为空白，但我稍后可能会添加实际值）。

3.  将结果解析为 XDocument。

要保存文件，我会做相反的事情：

1.  将 XDocument 保存为字符串。

2.  去掉实体定义。

3.  保存到文件。

我的问题是，有没有我可以使用的库（尤其是内置的 .Net 库）将 XHTML 文件读入 XDocuments？我编写的代码已经完成了它的目的（生成当前索引并测试生成器程序的其余部分），如果其他人已经编写并测试了相同的东西，我真的不想花时间测试它。

非常感谢你们的时间，

Ria。

**编辑：**非常感谢；这行得通！当我保存 XHTML 时，我仍然需要做一些字符串处理（猜想这个库并不是真的为此而设计的:)）而且我不得不稍微摆弄一下 Agility Pack 的源代码，以让它停止不加选择地粘贴 CDATA 部分围绕每个样式属性的内部（即使已经存在一个），但这就是开源的重点，对吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-28T11:39:48.023

这可能会有所帮助：[LINQ 和 Lambda，第 3 部分：Html Agility Pack to LINQ to XML Converter](http://vijay.screamingpens.com/archive/2008/05/26/linq-amp-lambda-part-3-html-agility-pack-to-linq.aspx)

# sharepoint - 如何在 Microsoft Search Server 2008 中创建用于索引重量级格式的预处理应用程序？

> ID：486977
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-28T09:12:35.310
> 
>         
> 
> 标签：sharepoint, search, ifilter

我需要为 Microsoft Search Server 2008 开发一个 IFilter，它执行长时间的计算以提取文本。从一个文件中提取文本可能需要 5 秒到 12 小时。

这样做的一个想法是[创建一个预处理应用程序](https://stackoverflow.com/questions/464443/how-to-implement-an-ifilter-for-indexing-heavyweight-formats#482042)。

我如何设计这样的应用程序？具体来说： - 如何将 Search Server 爬虫连接到我的应用程序？- 提取完成后如何将提取的文本输入搜索服务器？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T20:13:10.060

首先，您需要对 IFilter 本身进行编码。

[这篇文章非常好](http://www.codeproject.com/KB/cs/IFilter.aspx)，它也引用了一些好文章。
[IFilter.org](http://www.ifilter.org/)
也可以看[这组文章](http://technet.microsoft.com/en-us/library/bb266451(VS.85).aspx)

接下来是如何预处理的问题。我能想到的最简单的方法是创建一个[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)来启动文档的预处理。

预处理器可以解析文档中的文本并将其存储在某处。

“某处”成为下一个问题，这主要是一种商业决策。如果可以添加文档的目录，我会在每个文件夹中添加一个索引目录，因为文档被解析并在其中存储一个文件，例如 [OriginalFilenameSansExtemsion]_index.txt。

如果这不可行，请在每个驱动器上创建一个索引文件夹并根据需要镜像目录结构。归根结底，您只需要 IFilter 能够根据被索引文件的文件名来确定在哪里查找带有预处理内容的文本文档。

当 IFilter 运行时，会调用 Init。发生这种情况时，只需加载文本文档并在调用 GetChunk、GetText 和 GetValue 函数时返回其内容。    

该解决方案最终会导致预处理器和 IFilter 之间存在隐式依赖关系，因为它们都将存储自己的“查找”索引文档的方式。

应该可以将索引文档的位置存储在某个共享配置位置。

**更新**
**如何在 Search Server 下调用 IFilter 方法？** 
创建后，IFilter 必须安装在索引服务器上（即必须注册相关的 dll）。使用[本文](http://blogs.msdn.com/ifilter/archive/2006/11/20/registering-third-party-ifilters-in-wss-moss-2007.aspx)作为指南，作为实施的一部分，您将为过滤器提供一个唯一的 guid，以用于其 CLSID。注册过程将与此类似，只是使用不同的扩展名和 guid。

> 第 1 步：COM 注册
> 
>   
>   
> 
> 1.添加注册表项：HKEY_CLASSES_ROOT\CLSID\ ThreadingModel : Both
> 
>   
>   
> 
> 第 2 步：向操作系统注册过滤器
> 
>   
>   
> 
> 向操作系统注册过滤器扩展映射有 4 个步骤：
> 
>   
>   
> 
> 1.  HKEY_CLASSES_ROOT\<.ext>（默认）-->
> 
> 2.  HKEY_CLASSES_ROOT\（默认）-->
> 
> 3.  HKEY_CLASSES_ROOT\\PersistentHandler(默认) -->
> 
> 4.  HKEY_CLASSES_ROOT\\PersistentHandler\PersistentAddinsRegistered\IID_IFilter\（默认）-->  
> 
>   
>   
> 
> 现在我们都准备好使用 WSS（Windows Sharepoint 服务）或 MOSS（Microsoft Office Sharepoint Server）来注册我们的产品了。
> 
>   
>   
> 
> 第 3 步：使用 MOSS 注册过滤器扩展
> 
>   
>   
> 
> 1.  将过滤器扩展添加到已爬网的文件类型：开始 -> 程序 -> Microsoft Office Server -> SharePoint 3.0 管理中心 -> -> 搜索设置 -> 文件类型 -> 新文件类型（在此处添加扩展名）
>     
>     
> 
> 2.  添加以下注册表项：
>     
>     
>       
>       
>     
>     [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office Server\12.0\Search\Applications\\Gather\Portal_Content\Extensions\ExtensionList]
>           
>     
>     
>       
>       
>     
>     [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office Server\12.0\Search\Setup\Filters.ext] 默认 =（未设置值）扩展名 = FileTypeBucket REG_DWORD = 0x00000001 (1) MimeTypes =        
>     
>     
>       
>       
>     
>     [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office Server\12.0\Search\Setup\ContentIndexCommon\Filters\Extension.ext] 默认 REG_MULTI_SZ = IFIlter CLASSID
>     
>     
> 
> 3.  最后，通过从命令窗口执行以下命令来回收搜索服务：
>     
>     
>       
>       
>     
>     D:> 网络停止搜索
>     
>     
>       
>       
>     
>     D:> 网络开始搜索

**Search Server 是否传递 URL 而不是本地文件名？** 
LoadIFilter函数用于获取文件的路径名[。](http://technet.microsoft.com/en-us/library/ms691002(VS.85).aspx)在此处创建读取索引文本而不是实际文件的 IFilter 实例。

**如果它为尚未编入索引的 URL 调用 IFilter::Init，我该怎么办？**
如果索引文件不存在，您将无法索引，因此返回可用的[错误代码](http://technet.microsoft.com/en-us/library/ms690965(VS.85).aspx)之一。

如果需要很长时间，预处理应用程序将需要从文档中提取文本。在 LoadIFilter 函数期间处理文件时，需要将文本存储在 IFilter 可以访问的位置（搜索应用程序将文件的 url/文件路径传递给该文件）。使用文件的 url/文件路径，Ifilter 必须能够确定先前提取的文本在哪里。当 IFilter 然后可以加载文本并解析它而不是“实际”文件。绕过长搜索爬网时间的需要。

如果您不打算让预处理器完成整个站点，则需要多次通过搜索爬虫才能获得所需的内容。假设爬虫每天晚上都在进行增量爬取。添加文件的第一天，增量抓取会拾取文件并将其传递给 LoadIFilter。该函数查找但看不到文件的任何预处理文本，因此它将路径添加到配置文件（或列表）并返回错误代码。该文件不会添加到搜索结果中。预处理器在不同的时间查看配置列表，发现有要处理的文件并开始工作。完成后，它会存储文本并从配置列表中删除文件。下次爬虫运行时，它将找到文件及其存储的文本进行解析。

这个过程开始变得有点复杂，我会担心爬虫和预处理器必须进行如此良好的通信。此外，增量抓取可能需要预处理器在提取文本后“触摸”文件。

在这一点上，最好开发一些东西，看看到目前为止会发生什么，因为这只是一个理论算法。

希望这会有所帮助。

# sql - OPENQUERY 在游标中带有变量

> ID：486978
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T09:12:50.050
> 
>         
> 
> 标签：sql, sql-server, sybase, linked-server

如何在 SQL Server 中将包含变量的 OpenQuery 返回到游标？

```
DECLARE curMyCursor CURSOR FOR
    EXEC('SELECT *
          FROM OPENQUERY(SYBASE,
                ''SELECT * FROM MyTable WHERE MyPrimaryKey=''''' + @Variable + ''''''')')
OPEN @ResultCrsr 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-28T13:01:49.387

你没有。将打开的查询结果放入临时表并在其上打开游标。

但是为什么你需要一个光标呢？我确信没有它会有更好的做事方式。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2016-12-07T03:53:12.480

您必须使用 TSQL，因为您不能将变量传递给`OPENQUERY`：

```
DECLARE sqlCMD VARCHAR(500);

SET @sqlCMD = 
   'SELECT * FROM OPENQUERY(PASON, ''SELECT * FROM MyTable WHERE     MyPrimaryKey=''''' + @Variable + ''''''')')                    

EXEC (@sqlCMD); 
```

# sql-server-2005 - 您对根据某个类别 ID 将大型 SQL 表拆分为多个表有何想法？

> ID：486991
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-28T09:19:32.127
> 
>         
> 
> 标签：sql-server-2005

我们有一个大表，它为许多网站上的许多不同存储过程提供服务，但通常只处理表中与使用它的网站相关的数据。

换句话说，按websiteID拆分表会不会出错？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-28T09:24:47.593

如果这意味着您要在多台服务器上安装多个数据库，那么这是推荐的扩展方式之一。如果您的意思是同一台服务器上的多个表（相同的数据库或不同的数据库），那么您的收益将微乎其微；并且您的管理开销可能会增加以使它们保持同步。而且，如果所有查询都遇到多个表，那么效率就会降低。

无论是好是坏，这种影响都不太可能很大。你期望得到什么好处？（顺便说一下，这是用于过早优化的典型 rdbms 反模式。）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T09:28:06.633

是的，这是错误的。您应该在 websiteid 上保留一张表和索引。如果你真的想让它们看起来是分开的，你可能想要使用分区视图，但我认为这没有必要。

在 SQL 术语中，您永远不应该根据表的过长（即行数）来拆分表，但您可以考虑根据过长（即列数）来拆分表。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-28T09:37:10.313

如果您想将应用程序移动到它们自己的表以进行隔离，您最好为每个实例设置一个数据库，而不是尝试在应用程序中执行此操作。这具有以下优点：

*   查询的 SQL 不会改变。

*   数据库比表分区更容易保护数据。您可以让客户更灵活地访问数据，而不会损害其他客户的数据。

*   如有必要，您可以针对每个客户实施独立的备份/恢复机制。

*   如果必须的话，通过将一些客户转移到另一台服务器上来“横向扩展”会更容易。

*   应用程序架构更简单，因为它不必明确了解每个查询中的客户过滤。

为每个客户设置多个表意味着您必须为应用程序维护单独的构建或生成涉及这些表的所有 SQL 语句。这很混乱，很难扩展到大量客户。  

概括地说，如果您有一个相对简单的应用程序和大量客户，那么带有过滤的单个表可能是更合适的解决方案。对于客户较少的更复杂的应用程序，最好的方法是设置多个数据库并为每个客户提供一个应用程序实例。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-28T09:26:55.670

你的意思是你想拥有`BigTableForWebsite1`, `BigTableForWebsite2`,`BigTableForWebsite3`等而不是一个`BigTableForAllWebsites`? 这让我对我的数据库纯粹主义者感到有些不适......

我认为它不会给您带来性能提升，因为每次访问仍将针对单个数据库（可能存储在一组文件中）。

# python - Ruby equivalent of virtualenv?

> ID：486995
> 
>         
> 
> 赞同：179
> 
>         
> 
> 时间：2009-01-28T09:24:14.070
> 
>         
> 
> 标签：python, ruby, virtualenv

Is there something similar to the Python utility [virtualenv](http://pypi.python.org/pypi/virtualenv)?

Basically it allows you to install Python packages into a sandboxed environment, so `easy_install django` doesn't go in your system-wide site-packages directory, it would go in the virtualenv-created directory.

For example:

```
$ virtualenv test
New python executable in test/bin/python
Installing setuptools...cd .........done.
$ cd test/
$ source bin/activate
(test)$ easy_install tvnamer
Searching for tvnamer
Best match: tvnamer 0.5.1
Processing tvnamer-0.5.1-py2.5.egg
Adding tvnamer 0.5.1 to easy-install.pth file
Installing tvnamer script to /Users/dbr/test/bin

Using /Library/Python/2.5/site-packages/tvnamer-0.5.1-py2.5.egg
Processing dependencies for tvnamer
Finished processing dependencies for tvnamer
(test)$ which tvnamer 
/Users/dbr/test/bin/tvnamer 
```

Is there something like this for RubyGems?

* * *

## 回答 #1

> 赞同：93
> 
>             
> 
> 时间：2010-09-27T07:20:31.393

[RVM](http://rvm.io/) works closer to how virtualenv works since it lets you sandbox different ruby versions and their gems, etc.

* * *

## 回答 #2

> 赞同：79
> 
>             
> 
> 时间：2012-09-30T17:57:19.687

Neither sandbox, RVM, nor rbenv manage the versions of your app's gem dependencies. The tool for that is [bundler](http://bundler.io/rationale.html).

*   use a [Gemfile](http://bundler.io/v1.5/gemfile.html) as your application's dependency declaration

*   use `bundle install` to install explicit versions of these dependencies into an isolated location

*   use `bundle exec` to run your application

* * *

## 回答 #3

> 赞同：21
> 
>             
> 
> 时间：2012-11-09T11:33:15.947

I'll mention the way I do this with Bundler (which I use with RVM - RVM to manage the rubies and a default set of global gems, Bundler to handle project specific gems)

```
bundler install --binstubs --path vendor 
```

Running this command in the root of a project will install the gems listed from your Gemfile, put the libs in `./vendor`, and any executables in `./bin` and all `require`s (if you use `bundle console` or the Bundler requires) will reference these exes and libs.

* * *

## 回答 #4

> 赞同：18
> 
>             
> 
> 时间：2012-09-30T16:58:20.823

No one seems to have mentioned [rbenv](http://rbenv.org/).

* * *

## 回答 #5

> 赞同：16
> 
>             
> 
> 时间：2009-01-28T09:49:35.547

I think you'll like [sandbox](http://github.com/nkryptic/sandbox/tree/master).

* * *

## 回答 #6

> 赞同：16
> 
>             
> 
> 时间：2013-07-01T21:10:18.857

If you only need to install gems as non-root, try setting the `GEM_HOME` environment variable.  Then just run `gem`.

For example:

```
$ export GEM_HOME=$HOME/local/gems
$ gem install rhc 
```

* * *

## 回答 #7

> 赞同：4
> 
>             
> 
> 时间：2015-11-20T09:42:48.587

I recommend [direnv](https://github.com/direnv/direnv). It is an environment switcher for the shell.

Before each prompt it checks for the existence of an ".envrc" file in the current and parent directories. If the file exists (and authorized), it is loaded into a bash sub-shell and all exported variables are then captured by direnv and then made available the current shell.

Here is [how to use direnv](https://github.com/direnv/direnv/wiki/Ruby) with ruby-install

## + ruby-install

Add this to the `~/.direnvrc`

```
use_ruby() {
  local ruby_root=$HOME/.rubies/$1
  load_prefix "$ruby_root"
  layout_ruby
} 
```

Install ruby-install (`brew install ruby-install`) and install a bunch of rubies.

```
ruby-install ruby 1.9.3
ruby-install ruby 2.0.0
ruby-install ruby 2.2.0 
```

And then make a couple of symlinks for convenience:

```
ln -s .rubies/1.9 ruby-1.9.3-p*
ln -s .rubies/2.0 ruby-2.0.0
ln -s .rubies/2.2 ruby-2.2.0 
```

And finally in any project's `.envrc`:

`use ruby 2.0`

This will put all gems under the project's `.direnv/ruby` directory (makes opening gems easier). bundler will put wrapper binaries in  `.direnv/bin` (no more `bundle exec`!). 

## + rbenv

It's also possible to use rbenv by adding the `use rbenv` command in any `.envrc` file. This will activate rbenv which in turn will put the ruby wrappers in the PATH.

Note that it's not necessary to install rbenv in the .bashrc or .zshrc for this to work.

## + RVM

Here is the most complicated .envrc that I use on ruby projects:

```
rvm use 1.8.7
layout ruby
PATH_add .direnv/bundler-bin 
```

rvm is used to select the right ruby version for you

layout commands automatically set some of the usual environment variables. For now only the ruby layout exists. What it does is set the GEM_HOME environment variable and it's bin directory to your path. Because it depends on the ruby version, make sure to call it after "rvm". Since each ruby layout directories have their own GEM_HOME, you don't need to use rvm's gemsets.

PATH_add prepends and expands the given relative path. In that case, I use this to segregate the bundler binstubs from my own bin scripts with `bundle install --binstubs .direnv/bundler-bin`

If you want to find out what those commands exactly do, for now: cat `direnv stdlib` | less

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2018-12-07T07:33:29.463

[Mineshaft](https://github.com/camerontesterman/mineshaft) is a project that I've been working on for some time and am continuing development work on.

It offers the ability to both create virtual environments akin to how virtualenv works and can also install Ruby globally as well.

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2022-01-21T17:15:37.100

Here's two cents from an experienced Python developer currently learning Ruby. Using [rbenv](https://github.com/rbenv/rbenv) together with its [rbenv-gemset](https://github.com/jf/rbenv-gemset) plugin is the closest thing to Python Virtual Environments I have found so far.

*rbenv* is a tool to manage multiple Ruby versions against the same platform. If you are a Python developer you have probably stumbled upon [pyenv](https://github.com/pyenv/pyenv). Well, they share the very same purpose and, as a matter of fact, *pyenv* was actually born as a fork of *rbenv*.

Without entering in to much technical details, *rbenv* intercepts Ruby commands using SHIM executables injected into your `PATH`, and determines which Ruby version has been specified by your application, and passes your commands along to the correct Ruby installation.

A Ruby version can be specified for a project in many different ways. One of the most common is to place a `.ruby-version` file in the project root directory containing the desired version.

However, whenever a version is used to install gems, those will be shared among all the projects using that version.

Here's where [rbenv-gemset](https://github.com/jf/rbenv-gemset) plugins comes in handy. In a similar fashion to the `.ruby-version` file you may initialize a `.ruby-gemsets` file containing the path of the directory where the gems should be installed for this project (by default a local `.gems` directory in the project root). Thus isolation between project is achieved.

Here's an [oldie but good article](https://develves.net/blogs/asd/2016-03-17-using-virtual-environments-ruby-1/) about the topic.**** 
````***``***