# StackOverflow 问答 10324000-10324999

# vb.net - 需要有关 VB.Net 多线程选项的建议

> ID：10324000
> 
> 赞同：3
> 
> 时间：2012-04-25T21:22:30.463
> 
> 标签：vb.net, multithreading, controls, richtextbox

大家好，

我花了很长时间弄清楚在我当前的工作项目中使用哪种多线程方法。由于我一生中从未编写过多线程应用程序，因此这一切都令人困惑且非常压倒性。事不宜迟，这是我的背景故事：

我被指派在我公司的研发实验室中接管一个测试设备的控制应用程序的工作。该程序必须能够半并发地与三个不同的设备发送和接收串行通信。原始程序是用 VB 6（无多线程）编写的，我确实计划将其修改为与需要测试的较新产品一起使用，直到它在测试期间由于过多的串行通信而导致 UI 锁定时造成安全隐患. 这导致部分测试仪硬件崩溃，所以我决定尝试在 VB.Net 中重写应用程序，因为我一开始对它更满意，而且我认为多线程可能有助于解决这个问题。

我的计划是从主应用程序线程向其他设备发送命令，并将接收端旋转到它们自己的线程中，这样主线程就不会在时间紧迫时锁定。但是，我还没有接受我的选择。为了增加我的问题，我需要在接收到的单独富文本框中显示接收到的通信，而来自一个特定设备的数据需要由主程序解析，但只有来自最新测试的文本（我需要文本框来包含所有接收到的数据）。

到目前为止，我已经调查了委托，自己处理线程，并且刚刚开始研究 BackgroundWorkers。我今天早些时候尝试使用代表，但无法找到更新文本框的方法。我是否需要使用回调函数来执行此操作，因为我无法在委托函数本身的主体中执行此操作？我自己处理线程时看到的问题是弄清楚如何在线程和程序的其余部分之间来回传递数据。BackgroundWorkers，正如我所说，我刚刚开始调查，所以我还不确定如何看待它们。

我还应该注意，该计划是让生成的线程连续运行，直到以某种方式触发停止。上述任何选项都可以做到这一点吗？还有其他我还没有发现的选择吗？

对不起，我似乎在散布一些杂乱无章的信息，但我的期限很紧，压力大到我无法思考的地步！任何建议/信息/链接都非常感谢。我只需要帮助权衡选项，这样我就可以选择一个方向并继续前进。感谢所有花时间阅读这个烂摊子的人！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T23:29:45.340

好的，串行端口、线程间通信、在 RichTextBox 等 GUI 组件中显示内容，需要快速解析传入数据以解码协议并触发状态机。

所有三个串行端口都将触发到同一个“processControl”状态机吗？

如果是这样，那么您可能应该通过组装事件/数据对象并将它们排队到由一个线程运行的状态机来做到这一点（参见 BlockingCollection）。这比用互斥锁锁定状态引擎要安全得多，也更容易理解/调试。

定义一个“comms”类来保存数据并在系统中携带它。它应该有一个“命令”枚举，以便获得一个的线程可以通过打开枚举来做正确的事情。一个“事件”成员，可以设置为状态引擎使用的任何内容。一个 'bool loadChar(char inChar)' 可以将 char-by-char 数据投入其中，并且仅当一个完整的、经过验证的协议单元已被组装、检查并解析为数据文件时才会返回“true”。一个“字符串 textify()”方法，它以文本形式转储有关包含数据的信息。保存文本内容的通用“状态”字符串。'errorMess' 字符串和异常成员。

你可能明白了——这个 comms 类可以在系统中传输任何东西。它被封装，因此线程可以使用它的数据和方法，而无需参考任何其他 comms 实例——它不需要任何锁定。它可以排队以在阻塞集合上工作线程并 BeginInvoked 到 GUI 线程以显示内容。

在 serialPort 对象中，在启动时创建一个 comms 并使用 serialPort 实例加载一个成员。并且，当 DataReceived 事件触发时，一次从 args 中获取数据并触发到 comms.loadChar()。如果 loadChar 调用返回 true，则将 comms 实例排队到状态机输入 BlockingCollection，然后立即创建另一个 comms 并开始为新的 comms 加载数据。一直这样做——用字符加载通信实例，直到它们有一个经过验证的协议单元并将它们排队到状态机。可能每个串行端口都有自己的协议 - 好的，因此您可能需要三个覆盖 loadChar 的通信后代才能正确解码自己的协议。

在状态机线程中，只需从输入中获取（）通信对象并使用当前状态和来自通信对象的事件来执行状态引擎的事情。如果 SM 动作例程决定显示某些东西，BeginInvoke comms 到 GUI 线程，命令设置为“displaySomeStuff”。当 GUI 线程获得通讯时，它可以切换命令来决定显示什么/什么。

无论如何，这就是我构建所有过程控制类型应用程序的方式。数据在“通讯”对象实例中在系统中流动，没有通讯对象一次被超过一个人操作。如果转到 GUI 线程，这一切都是通过 BlockingCollection（或类似的）、队列或 BeginInvoke() 上的消息传递来完成的。

唯一的锁在队列中，因此被封装。根本没有显式锁。这意味着根本不存在显式死锁。我确实会头疼，但我不会被锁定。

哦 - 不要靠近 'Thread.Join()'。

# xml - 加入 XML 元素并在不退出时处理 - 使用 Linq-to-XML ASP.Net C#

> ID：10324003
> 
> 赞同：0
> 
> 时间：2012-04-25T21:22:41.943
> 
> 标签：xml, asp.net-mvc-3, c#-4.0, linq-to-xml

[从我的早期帖子](https://stackoverflow.com/questions/9995686/query-nested-xml-elements-using-linq-to-xml-asp-net-c-sharp)扩展到我自己的问题

如果您注意到我正在使用**let**关键字加入我的元素

有时我的 XML 可能没有所有这些元素。

那么是否可以在退出时加入此元素？如果不存在，则为该字段提供**null 或空**值

例如，如果没有**Pharmacy Element。**

那么这 `let Pharmacy = MD.Element(NameSpace + "Pharmacy")` 应该是可能的，这

```
phStoreName = Pharmacy.Element(NameSpace + "StoreName").Value, 
```

应该给我一个**空值或空**值**phStoreName**

```
var MedicationDispensed =
  (from MD in xdoc.Descendants(NameSpace + "MedicationDispensed")
   let DrugCoded = MD.Element(NameSpace + "DrugCoded")
   let Quantity = MD.Element(NameSpace + "Quantity")
   let Pharmacy = MD.Element(NameSpace + "Pharmacy")
   let phIdentification = Pharmacy.Element(NameSpace + "Identification")
   let phAddress = Pharmacy.Element(NameSpace + "Address")
   let phPhoneNumbers = Pharmacy.Element(NameSpace + "PhoneNumbers")
   let phPhone = phPhoneNumbers.Element(NameSpace + "Phone")
   let Prescriber = MD.Element(NameSpace + "Prescriber")
   let prIdentification = Prescriber.Element(NameSpace + "Identification")
   let prName = Prescriber.Element(NameSpace + "Name")
   let prAddress = Prescriber.Element(NameSpace + "Address")
   select new
   {
       DrugDescription = MD.Element(NameSpace + "DrugDescription").Value,
       ProductCode = DrugCoded.Element(NameSpace + "ProductCode").Value,
       ProductCodeQualifier = DrugCoded.Element(NameSpace + "ProductCodeQualifier").Value,
       Qualifier = Quantity.Element(NameSpace + "Qualifier").Value,
       Value = Quantity.Element(NameSpace + "Value").Value,
       CodeListQualifier = Quantity.Element(NameSpace + "CodeListQualifier").Value,
       DaysSupply = MD.Element(NameSpace + "DaysSupply").Value,
       LastFillDate = MD.Element(NameSpace + "LastFillDate").Value,
       phStoreName = Pharmacy.Element(NameSpace + "StoreName").Value,
       phNCPDPID = phIdentification.Element(NameSpace + "NCPDPID").Value,
       phAddress1 = phAddress.Element(NameSpace + "AddressLine1").Value,
       phCity = phAddress.Element(NameSpace + "City").Value,
       phState = phAddress.Element(NameSpace + "State").Value,
       phZipcode = phAddress.Element(NameSpace + "ZipCode").Value,
       phPhoneNumber = phPhone.Element(NameSpace + "Number").Value,
       phQualifier = phPhone.Element(NameSpace + "Qualifier").Value,
       prDEANumber = prIdentification.Element(NameSpace + "DEANumber").Value,
       prLastName = prName.Element(NameSpace + "LastName").Value,
       prFirstName = prName.Element(NameSpace + "FirstName").Value,
       prMiddleName = prName.Element(NameSpace + "MiddleName").Value,
       prAddress1 = prAddress.Element(NameSpace + "AddressLine1").Value,
       prCity = prAddress.Element(NameSpace + "City").Value,
       prState = prAddress.Element(NameSpace + "State").Value,
       prZipCode = prAddress.Element(NameSpace + "ZipCode").Value
   }).ToList(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T04:21:17.297

而不是这样做：

```
Pharmacy.Element(NameSpace + "StoreName").Value 
```

像这样使用显式转换运算符：

```
(string)Pharmacy.Element(NameSpace + "StoreName") 
```

如果元素不为 null，它将返回 .Value，如果元素不存在，则返回空字符串。在这里您可以找到有关 XElement 的显式转换运算符的更多详细信息：http: [//msdn.microsoft.com/en-us/library/system.xml.linq.xelement.op_explicit.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.op_explicit.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T17:24:59.683

终于找到了解决办法 参考这个[链接](http://weblogs.asp.net/fmarguerie/archive/2007/12/05/use-the-power-of-let-in-your-linq-queries.aspx)

```
 What if "let" returns null?

If you declare an object with "let" such as

let myPayment = bill.Element("payment")

select new Payment

  {

     Amount = (decimal) myPayment.Element("Amount")

  }

If myPayment is null, this blows up with a null reference exception.  The alternative would be

  Amount = myPayment != null ? (decimal) myPayment.Element("Amount")

but think how cumbersome that is for a bunch of fields.

What's the solution? 
```

# icons - NSIS CreateShortcut 坚持使用 %ProgramFiles% 作为图标路径

> ID：10324004
> 
> 赞同：5
> 
> 时间：2012-04-25T21:22:42.803
> 
> 标签：icons, nsis, filepath

我有以下 NSIS 代码

```
Function CreateDesktopSC
    ;Creates Desktop Shortcut
    SetShellVarContext current
    SetOutPath "$DOCUMENTS\Foo\"
    SetShellVarContext all
    detailprint "Icon path: $INSTDIR\Bar\icon.ico"
    CreateShortCut "$DESKTOP\${productName}.lnk" "$INSTDIR\Bar\binary.exe" "" "$INSTDIR\Bar\icon.ico" 0
FunctionEnd 
```

安装日志显示以下内容（来自 detailprint 命令）图标路径：C:\Program Files (x86)\Bar\icon.ico

快捷方式已创建，但带有可执行文件中的图标。

如果我打开 lnk 文件或右键单击快捷方式并单击“更改图标 ...”，则会收到错误消息“Windows 找不到文件 %ProgramFiles%\Bar\icon.ico。”

如果我浏览到 %ProgramFiles%，它会将我带到 c:\Program Files，而不是 detailsprint 命令中显示的 x86 版本。图标文件存在，但在 x86 文件夹中。

似乎 NSIS 或 windows 正在用“%ProgramFiles%”替换“C:\Program Files (x86)\”，这并不指向 x86 版本。

可执行文件的实际路径是正确的，只是图标链接不正确。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-14T16:25:45.940

该线程的解决方法是在您的图标代码中添加第二个 \。我真的不明白为什么这对 64 位系统有帮助，但它确实......

所以替换：

```
CreateShortCut "$SMPROGRAMS\$StartMenuGroup\${PRODUCT_NAME}.lnk" "yourapp.exe" "$INSTDIR\${APPLICATION_ICON}" 
```

和

```
CreateShortCut "$SMPROGRAMS\$StartMenuGroup\${PRODUCT_NAME}.lnk" "yourapp.exe" "$INSTDIR\\${APPLICATION_ICON}" 
```

在 APPLICATION_ICON 之前添加第二个 \ 后，图标将再次显示

令人困惑，但它有效

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:47:38.443

NSIS 只使用记录在案的 IShellLink 接口。NSIS 论坛上有一个关于它的[线程（您可以尝试一种解决方法）。](http://forums.winamp.com/showthread.php?t=327806)我相信这是 WOW64 中的一个错误...（注册表重定向器已[记录](http://msdn.microsoft.com/en-us/library/aa384232%28v=vs.85%29.aspx)在您背后将 %ProgramFiles% 更改为 %ProgramFiles(x86)%，我怀疑 IShellLink 缺少此 hack）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T16:30:05.070

1.  禁用重定向
2.  从路径加载图标

一切都通过系统插件完成。为什么要复杂...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-02T23:50:44.713

[http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.3.4](http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.3.4)似乎是错误的，对我来说有效的是：

```
CreateShortCut "$SMPROGRAMS\${PRODUCT_PUBLISHER}\${SHORTCUT_NAME}.lnk" "$INSTDIR\${PRODUCT_EXE}" "$INSTDIR\${PRODUCT_EXE}" "$INSTDIR\MyIcon.ico" 
```

# audio - 在 Altera DE2 板上生成简单的哔声

> ID：10324005
> 
> 赞同：2
> 
> 时间：2012-04-25T21:22:43.393
> 
> 标签：audio, vhdl, intel-fpga

我一直在网上寻找有关如何使用 VHDL 使用 DE2 Altera 板生成简单蜂鸣声的解决方案，但我似乎找不到任何东西。

我见过一些关于音频编解码器的事情，但我无法牢牢掌握我需要用它做什么。

非常感谢！

-将要

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T07:32:23.497

“音频编解码器”是一个单独的芯片（在您的情况下是 Wolfson WM8731），它可以将数字形式的信息转换为模拟信息，以通过带有放大器/扬声器/等的标准音响系统进行放大/播放。

您需要了解如何从 FPGA 连接到音频编解码器芯片（谷歌该芯片的数据表），然后向其发送必要的信息以生成哔声。根据音频芯片的先进程度，这项任务的复杂性可能会有很大差异。由于它是一个教育委员会，您也许可以找到已经做过类似事情的人，然后在他们的经验基础上再接再厉。

如果您只需要一个简单的哔声，您也可以自己创建一个带有压电蜂鸣器或类似设备的简单电路 - 无需使用音频编解码器即可控制......

# python - multiprocessing.Connection 线程安全吗？

> ID：10324006
> 
> 赞同：2
> 
> 时间：2012-04-25T21:22:45.820
> 
> 标签：python, thread-safety, multiprocessing

`multiprocessing.Connection`python对象线程安全吗？

如果是这样，两个线程可以同时在同一个连接上使用`conn.recv()`和`conn.send()`，这对于全双工通信可能很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T00:01:26.683

看起来它**不是**线程安全的。在 Python 3.2 之前，`multiprocessing.Connection`对象[没有附加任何信号量](http://hg.python.org/cpython/file/3d0686d90f55/Modules/_multiprocessing/multiprocessing.h#l164)，也没有任何使用它们的库代码。

有趣的是，在 Python 3.3[中，实现已经移动了](http://hg.python.org/cpython/file/2f69db52d6de/Lib/multiprocessing/connection.py#l123). 但同样，没有使用锁定原语。

该文档没有过多地提及`multiprocessing`模块的线程安全性。考虑到 Python 文档的质量，这有点出乎意料。

# c# - MVVM：修改模型，如何正确更新 ViewModel 和 View？

> ID：10324009
> 
> 赞同：34
> 
> 时间：2012-04-25T21:23:13.583
> 
> 标签：c#, silverlight, mvvm, domain-driven-design, prism

## 案子

假设我有一个`Person`类， a`PersonViewModel`和 a `PersonView`。

`PersonView`从模型更新属性`Person`非常简单。`PersonViewModel`包含一个`Person`对象并具有绑定到的公共属性`PersonView`，以便更新 Person 模型。

然而。

想象一下`Person`模型可以通过`Service`. 现在需要将属性更改传递给`PersonViewModel`，然后传递给`PersonView`.

这就是我将如何解决它：

对于`Person`模型上的每个属性，我都会引发 PropertyChanged 事件。`PersonViewModel`订阅 的 PropertyChanged 事件`Person`。`PersonViewModel`然后会引发另一个 PropertyChanged 以更新`PersonView`.

这对我来说似乎是最明显的方式，但我有点想把这个问题抛在那里，希望有人给我一个更好的方式。真的这么简单还是有更好的方法将模型标记为已修改并更新 ViewModel 上的相应属性？

## 加法

的`PersonView`DataContext 是`PersonViewModel`. `Person`从 JSON 填充并在其生命周期内多次更新。

随意为我的特定案例建议架构更改。

## 回答

我将 aqwert 标记为我的问题的答案，因为它为我提供了我已经提出的解决方案的替代方案。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-26T08:37:28.313

当视图直接绑定到模型时（ViewModel 暴露模型时也是如此），您正在混合 UI 代码和数据代码。MVVM 的目标是分离这两个代码域。这就是 ViewModel 的用途。

视图模型必须有它自己的属性，视图可以绑定到。一个例子：

```
class PersonViewModel
{
    private Person OriginalModel { get; set; }

    public ValueViewModel<string> Name { get; set; }
    public ValueViewModel<int> Postcode { get; set; }

    protected void ReadFromModel(Person person)
    {
        OriginalModel = person;
        Name.Value = OriginalModel.Name;
        Postcode.Value = OriginalModel.Postcode;
    }

    protected Person WriteToModel()
    {
        OriginalModel.Name = Name.Value; //...
        return OriginalModel;
    }
} 
```

使用这样的 ViewModel 设计确实将您的数据对象与您的用户界面代码分开。当 Person 类的结构发生变化时，UI 不需要相应地调整，因为 ViewModel 将它们彼此分开。

现在回答你的问题。正如您在上面的示例中看到的，我使用了一个通用的`ValueViewModel<T>`. 这个类实现`INotifyPropertyChanged`（和其他一些东西）。当你收到一个新`Person`实例时，你只需要调用`ReadFromModel(newPerson)`你的 ViewModel 来更新 UI，因为 View 绑定到的 ValueViewModel 会在它们的值发生变化时通知 UI。

这里有一个非常简化的内部结构示例`ValueViewModel`：

```
class ValueViewModel<T> : INotifyPropertyChanged
{
    private T _value;
    public T Value 
    {
        get { return _value;}
        set
        {
            _value = value;
            RaisePropertyChanged("Value");
        }
    }
} 
```

这是我们在 MVVM 库中使用的一种方法。它的优点是它迫使开发人员清楚地将代码与设计人员的关注点分开。而且，作为副作用，它会在所有视图和视图模型中生成标准化的代码布局，从而提高代码质量。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-25T21:27:11.600

如果视图直接绑定到模型，那么只要服务使用相同的实例，对模型属性的任何更改都将传播到视图。

但是，如果您要在服务中重新创建新模型，那么您将为视图模型提供新模型。我希望将模型视为视图模型上的属性，因此当您设置该属性时，所有绑定都应收到更改警报。

```
//in the ViewModel
public Person Model
{
   get { return _person; }
   set { _person = value; 
         RaisePropertyChanged("Model");  //<- this should tell the view to update
        }
} 
```

编辑：

由于您声明有特定的`ViewModel`逻辑，因此您可以在`ViewModel`

```
 private void Model_PropertyChanged(object sender, PropertyChangedEventArgs e)
 {
      if(e.PropertyName == "Prop1") RaisePropertyChanged("SpecicalProperty");
      ...
 }

  public string SpecicalProperty
  {
     get
     {
         reutrn Model.Prop1 + " some additional logic for the view"; 
     }
   } 
```

在 XAML 中

```
 <TextBlock Text="{Binding Model.PropertyDirect}" />  
  <TextBlock Text="{Binding SpecicalProperty}" /> 
```

这样，只有`Model`和`ViewModel`属性都绑定到视图而不复制数据。

您可以更高级地创建一个助手来将模型的属性更改链接到视图模型或使用映射字典

```
 _mapping.Add("Prop1", new string[] { "SpecicalProperty", "SpecicalProperty2" }); 
```

然后通过获取属性列表找到要更新的属性

```
 private void Model_PropertyChanged(object sender, PropertyChangedEventArgs e)
 {

      string[] props;
      if(_mapping.TryGetValue(e.PropertyName, out props))
      {
          foreach(var prop in props)
              RaisePropertyChanged(prop);
      } 
 } 
```

# ruby-on-rails - 用于 ip 地理定位的准确和免费的地理编码服务？

> ID：10324013
> 
> 赞同：1
> 
> 时间：2012-04-25T21:23:38.607
> 
> 标签：ruby-on-rails, geocoding

什么是可靠地确定给定 IP 所在城市的优质免费地理编码服务？我希望有一个可以插入的 Ruby gem。

我目前正在使用 Geocoder gem。有什么方法可以插入 FreeGeoIP 的替代品（这些替代品是什么）？当我插入曼哈顿 ip 时，它会返回城市的弗农山，而不是纽约。

这就是我使用它的目的：

[tmrw.am](http://www.tmrw.am)

# 编辑

Geokit 对于 FreeGeoIP 难以处理的某些 ip 似乎做得很好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:00:15.117

对于 FreeGeoIP 难以处理的某些 ip，Geokit 似乎做得很好。

# javascript - Jquery，还原时的事件？

> ID：10324014
> 
> 赞同：0
> 
> 时间：2012-04-25T21:23:47.990
> 
> 标签：javascript, jquery, html, css, jquery-ui

我正在使用 Jquery Ui 的可拖动和还原选项。

有没有办法检测元素是否正在恢复？

```
$(function() {
$("#draggable").revert(function(){
alert('the div is reverting');
});

}); 
```

我见过

```
 revert:function(){
alert("");
} 
```

但是，它似乎将还原位置设置为释放鼠标的位置。

现在，我似乎拥有的选项是使用 mouseup。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:02:33.063

这实际上很有趣。我在文档中找不到任何提及它的内容。似乎调用了该​​函数，如果`true`返回，它将恢复，如果`false`它不会恢复。由于您根本没有回报，因此将其视为`false`.

因此，如果您使用 revert 选项`true`作为值（这意味着，总是恢复），那么您可以简单地在您的函数中添加一个 return 语句：

```
$(function() {
    $("#draggable").revert(function(){
        alert('the div is reverting');
        return true;
    });
}); 
```

但是，如果您将恢复设置为`invalid`，我不确定您如何做到这一点。

而且由于它没有记录，我猜使用风险自负。

**编辑：** 我对它进行了更多研究，显然一个 agument 被传递给了它被丢弃的可丢弃函数，如果没有可丢弃则为 false。所以从技术上讲，你可以像这样模仿`invalid`：

```
$(function() {
    $("#draggable").revert(function(droppable){
        alert('the div is reverting');
        return !!droppable;  // might just be able to return droppable but I think this is safer
    });
}); 
```

# python - Python中的健身比例选择（轮盘赌选择）

> ID：10324015
> 
> 赞同：19
> 
> 时间：2012-04-25T21:23:49.893
> 
> 标签：python, random, genetic-algorithm

我有一个对象列表（染色体），它有一个属性适合度（chromosome.fitness 介于 0 和 1 之间）

给定这些对象的列表，我如何实现一个返回单个染色体的函数，该染色体被选中的机会与其适应度成正比？也就是说，适应度为 0.8 的染色体被选择的可能性是适应度为 0.4 的染色体的两倍。

我找到了一些 Python 和伪代码实现，但它们对于这个要求来说太复杂了：该函数只需要一个染色体列表。染色体将自己的适应度存储为内部变量。

我已经编写的实现是在我决定允许染色体存储它们自己的适应度之前，所以要复杂得多，并且涉及压缩列表和其他东西。

## - - - - - - - - - - - - - - 编辑 - - - - - - - - - - - --------

谢谢 Lattyware。以下功能似乎有效。

```
def selectOne(self, population):
    max     = sum([c.fitness for c in population])
    pick    = random.uniform(0, max)
    current = 0
    for chromosome in population:
        current += chromosome.fitness
        if current > pick:
            return chromosome 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2018-09-09T10:59:17.297

使用 numpy.random.choice。

```
import numpy.random as npr
def selectOne(self, population):
    max = sum([c.fitness for c in population])
    selection_probs = [c.fitness/max for c in population]
    return population[npr.choice(len(population), p=selection_probs)] 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-25T21:29:11.910

有一种非常简单的方法可以从字典中选择加权随机选项：

```
def weighted_random_choice(choices):
    max = sum(choices.values())
    pick = random.uniform(0, max)
    current = 0
    for key, value in choices.items():
        current += value
        if current > pick:
            return key 
```

如果您手头没有字典，您可以修改它以适合您的班级（因为您没有提供更多详细信息，或者生成字典：

```
choices = {chromosome: chromosome.fitness for chromosome in chromosomes} 
```

假设适应度是一个属性。

这是一个修改为采用可迭代染色体的函数的示例，再次做出相同的假设。

```
def weighted_random_choice(chromosomes):
    max = sum(chromosome.fitness for chromosome in chromosomes)
    pick = random.uniform(0, max)
    current = 0
    for chromosome in chromosomes:
        current += chromosome.fitness
        if current > pick:
            return chromosome 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-29T15:17:57.270

我更喜欢更少的行：

```
import itertools

def choose(population):
    bounds = list(itertools.accumulate(chromosome.fitness for chromosome in population))
    pick = random.random() * bounds[-1]
    return next(chromosome for chromosome, bound in zip(population, bounds) if pick < bound) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-11-02T15:32:35.313

```
def Indvs_wieght(Indvs): # to comput probality of selecting each Indvs by its fitness
    s=1
    s=sum(i.fitness for i in Indvs)
    wieghts = list()
    for i in range(len(Indvs)) :
        wieghts.append(Indvs[i].fitness/s)
    return wieghts  

def select_parents(indvs,indvs_wieghts,number_of_parents=40): # Roulette Wheel Selection method  #number of selected  parent 
    return np.random.choice(indvs,size=number_of_parents,p=indvs_wieghts) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-26T06:43:49.500

```
from __future__ import division
import numpy as np
import random,pdb
import operator

def roulette_selection(weights):
        '''performs weighted selection or roulette wheel selection on a list
        and returns the index selected from the list'''

        # sort the weights in ascending order
        sorted_indexed_weights = sorted(enumerate(weights), key=operator.itemgetter(1));
        indices, sorted_weights = zip(*sorted_indexed_weights);
        # calculate the cumulative probability
        tot_sum=sum(sorted_weights)
        prob = [x/tot_sum for x in sorted_weights]
        cum_prob=np.cumsum(prob)
        # select a random a number in the range [0,1]
        random_num=random.random()

        for index_value, cum_prob_value in zip(indices,cum_prob):
            if random_num < cum_prob_value:
                return index_value

if __name__ == "__main__":
    weights=[1,2,6,4,3,7,20]
    print (roulette_selection(weights))
    weights=[1,2,2,2,2,2,2]
    print (roulette_selection(weights)) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-25T21:29:37.613

```
import random

def weighted_choice(items):
    total_weight = sum(item.weight for item in items)
    weight_to_target = random.uniform(0, total_weight)
    for item in items:
        weight_to_target -= item.weight
        if weight_to_target <= 0:
            return item 
```

# php - 向许多设备发送推送通知

> ID：10324018
> 
> 赞同：0
> 
> 时间：2012-04-25T21:23:59.627
> 
> 标签：php, objective-c, ios, xcode, apple-push-notifications

这是我第一次在堆栈溢出上发帖，所以如果这个问题非常明显，我深表歉意。

我正在为我的 iOS 应用程序设置推送通知，并且仅使用我自己的设备就成功完成了。我将很快在许多设备上进行测试，但我想知道我是否有正确的想法。

我会将所有设备令牌保留在我的数据库中，当需要发送推送通知时，我只需运行数据库中的所有行（包含令牌）并通过以下脚本发送它们，每次都替换设备令牌并且每次都保持我自己的私钥相同。这个对吗？

提前致谢！

```
 // Put your device token here (without spaces):
  $deviceToken = $device; // this will be run through a loop that 
                             changes this variable for every new device

   $passphrase = 'XXXXXXXXX'; //This is mine and remains always
                                the same despite which device... correct?

   // Put your alert message here:
   $message = 'Testing first notification!';

  $ctx = stream_context_create();
 stream_context_set_option($ctx, 'ssl', 'local_cert', 'ck.pem');
 stream_context_set_option($ctx, 'ssl', 'passphrase', $passphrase);

    // Open a connection to the APNS server
      $fp = stream_socket_client(
'ssl://gateway.sandbox.push.apple.com:2195', $err,
$errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);

     if (!$fp)
exit("Failed to connect: $err $errstr" . PHP_EOL);

      echo 'Connected to APNS' . PHP_EOL;

   // Create the payload body
     $body['aps'] = array(
'alert' => $message,
'sound' => 'default',
'badge' => 1
);

   // Encode the payload as JSON
   $payload = json_encode($body);

   // Build the binary notification
    $msg = chr(0) . pack('n', 32) . pack('H*', $deviceToken) . 
     pack('n', strlen($payload)) . $payload;

  // Send it to the server
   $result = fwrite($fp, $msg, strlen($msg));

    if (!$result)
echo 'Message not delivered' . PHP_EOL;
     else
echo 'Message successfully delivered' . PHP_EOL;

     // Close the connection to the server
     fclose($fp); 
```

# php - 为什么我会在包含在 try-catch 中的 PHP 代码上抛出错误？

> ID：10324022
> 
> 赞同：2
> 
> 时间：2012-04-25T21:24:09.690
> 
> 标签：php, exception-handling, error-handling

```
<?php

try {   
    $attrs = $xml->attributes();
    $code = $attrs['_Code'];
}
catch (Exception $e)  
{
    $code = '';
}

?> 
```

得到我：

> 致命错误：在第 6 行调用非对象上的成员函数 attributes()

为什么我在包含在 try-catch 中的代码上抛出错误？

* * *

**注意：使用以下***代码*可以避免此错误。（问题不是关于避免错误，而是为什么它没有被捕获 - 我仍然认为我会分享非错误代码）

```
if (is_object($xml) && method_exists($xml,'attributes')) {
    $attrs = $xml->attributes();
    $code = !empty($attrs['_Code'])?$attrs['_Code']:'';
 }
else {
    $code = '';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:26:11.413

无法捕获 PHP 致命错误。我不知道你在做什么的细节，但你必须想出一些其他的方法来测试是否`$xml->attributes()`有效。

此外，吞下每个错误而不将其记录在任何地方都是不好的做法，因为当事情开始破坏时，您将不知道原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:26:38.260

`try`/`catch`仅适用于*异常*，不适用于解析错误。您必须进行测试以确保`$xml`具有`attributes`避免此类错误的方法（可以称为空指针，但不完全是）。

# sql-server-2008 - 无法连接到本地 SQL Server

> ID：10324025
> 
> 赞同：1
> 
> 时间：2012-04-25T21:24:17.240
> 
> 标签：sql-server-2008, ado.net, enterprise-library

我正在尝试从 EntLib（MVC3、EntLib5、SQL Server 2008）调用存储过程。我正在使用 SQL Server 的默认实例，并且可以从 SQL Server Management Studio 很好地连接到它。我已经尝试了所有可以在网上找到的东西，但没有任何东西能让我保持联系。该服务作为 LocalSystem 运行。这是连接字符串：

服务器=本地；数据库=测试；Trusted_Connection=True

这是我收到的错误消息：

建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:31:23.530

服务器应该是“localhost”，而不是“local”，并且应该在 SQL Server 配置管理器中启用“TCP/IP”和“命名管道”协议。此外，如果您想使用受信任的连接，您可能需要在 MVC3 应用程序上启用 Windows 身份验证，否则还要在连接字符串中提供用户名和密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:27:27.067

如果您使用本地 SQL Server，则需要使用 localhost 或“.”。

# php - 在 Dreamhost 中编辑 Wordpress 文件

> ID：10324031
> 
> 赞同：0
> 
> 时间：2012-04-25T21:24:47.157
> 
> 标签：php, wordpress, ftp, dreamhost

我在我的子域上构建的 Wordpress 坐席使用了 Dreamhost 中的一键安装。当我在我的 FTP 中查找 WP php 文件时，我在目录中找不到它们。Idk dreamhost 将文件放在哪里？这是我第一次不使用本地主机进行开发。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:27:40.727

模板文件位于`/wp-content/[yourthemename]/`. 根据您的主题，其中可能有任意数量的 .php 文件，唯一需要的是 .php 文件`index.php`。

在`Appearance > Themes`您的管理面板下，它应该告诉您您正在使用什么主题以及主题目录在哪里。

# mysql - 日期计算排名 - 为事件年龄分配一个值

> ID：10324032
> 
> 赞同：0
> 
> 时间：2012-04-25T21:24:47.840
> 
> 标签：mysql

我正在尝试使用以下方法根据事件的年龄为事件分配一个值：

```
SELECT u.iduser, timeIsImportant
FROM user AS u
LEFT OUTER JOIN(
SELECT action, user_id, action_time, 
    (IF(bb.action_time < DATE_SUB(CURDATE(), INTERVAL 7 DAY), 
      (CASE 
       WHEN bb.action_time BETWEEN DATE_SUB(CURDATE(), INTERVAL 3 MONTH) AND CURDATE() THEN 0.1 
       WHEN bb.action_time BETWEEN DATE_SUB(CURDATE(), INTERVAL 6 MONTH) AND CURDATE() THEN 0.2
       WHEN bb.action_time BETWEEN DATE_SUB(CURDATE(), INTERVAL 12 MONTH) AND CURDATE() THEN 0.4
       WHEN bb.action_time BETWEEN DATE_SUB(CURDATE(), INTERVAL 18 MONTH) AND CURDATE() THEN 0.7
       WHEN bb.action_time BETWEEN DATE_SUB(CURDATE(), INTERVAL 24 MONTH) AND CURDATE() THEN 1.0
       END), 0)) 
AS timeIsImportant
FROM bigbrother AS bb
ORDER BY bigbrother.uid DESC LIMIT 1) 
AS bbb 
ON
bbb.user_id = u.iduser AND bbb.action = "C"
WHERE u.iduser = 2; 
```

这个想法是，老大哥表上的旧“事件”需要从排名查询计算中减去不同的值。上述查询中的 timeIsImportant 值将是以下示例中的 agePoints。

样本数据：

```
 row1                              row2
 -------------                    -------------
 rank: 4.7                         rank 4.9
 agePoints: 0.1                    agePoints 0.4
 timedRank: (rank-AgePoints)       timedRank: (rank-AgePoints)

 -------------------------------------------------------------

 SQL: ORDER BY timedRank DESC

 row1, row2

 SQL: ORDER BY timedRank ASC

 row2, row1 
```

**我想知道是否有另一种基于事件 age 分配值的方法**，因为我在每个页面加载时都进行此计算以对搜索结果进行排名，并发现当嵌套在搜索查询中时，这段代码会降低整体性能。

# javascript - nodejs保存所有图像

> ID：10324033
> 
> 赞同：0
> 
> 时间：2012-04-25T21:24:55.143
> 
> 标签：javascript, node.js

将所有图像从网页保存到文件的解决方案是什么。

我还在玩。我目前所拥有的只是列出 src。我现在如何去下载这些文件。

```
var request = require('request');
var cheerio = require('cheerio');

var url = 'http://www.slashdot.org';

request(url, function(err, resp, body){

  $ = cheerio.load(body);
  imglist = $('img');

  for (var i = 0; i < imglist.length; i++){
    console.log(imglist[i].attribs.src);
  }

}); 
```

理想情况下，我想要一个页面的本地副本，其中图像也保存在本地，但这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:33:18.047

当然，**可以**将页面与图像一起保存，但这并不容易。首先，您已经有了正文，因此您可以将其保存到文件中。但在此之前，您需要调整所有资源（如图像）的位置，使它们指向您的本地副本。

否则，您应该能够像获得页面一样获得图像。

去去去你可以的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:36:48.483

获得 img src 属性后，您可以将其设置为相对于页面位置的 URL（如果它还不是完整的 URL）。

获得 URL 后，您可以使用[`http.get(options, callback)`](http://nodejs.org/docs/latest/api/http.html#http_http_get_options_callback).

# xml - 在 xml 中指定 keyref 时出错

> ID：10324038
> 
> 赞同：0
> 
> 时间：2012-04-25T21:25:23.833
> 
> 标签：xml

这是我的代码：

```
 <xs:key name="UserIdKey">
        <xs:selector xpath="Users/User"></xs:selector>
        <xs:field xpath="@Id"></xs:field>
    </xs:key>
    <xs:keyref name="FriendsIdKeyRef" refer="UserIdKey">
        <xs:selector xpath="Friends/User"></xs:selector>
        <xs:field xpath="@FriendId"></xs:field>
    </xs:keyref> 
```

我收到以下错误：

> 属性 refer='UserIdKey' 不引用键或唯一约束。

但它就在`UserIdKey`那里。我究竟做错了什么？

谢谢。

# algorithm - Lucene's algorithm

> ID：10324050
> 
> 赞同：19
> 
> 时间：2012-04-25T21:25:58.847
> 
> 标签：algorithm, indexing, lucene, information-retrieval, inverted-index

I read the paper by Doug Cutting; "[Space optimizations for total ranking](http://lucene.sourceforge.net/papers/riao97.ps)".

Since it was written a long time ago, I wonder what algorithms lucene uses (regarding postings list traversal and score calculation, ranking).

Particularly, the total ranking algorithm described there involves traversing down the entire postings list for each query term, so in case of very common query terms like "yellow dog", either of the 2 terms may have a very very long postings list in case of web search. Are they all really traversed in the current Lucene/Solr? Or are there any heuristics to truncate the list employed?

In the case when only the top k results are returned, I can understand that distributing the postings list across multiple machines, and then combining the top-k from each would work, but if we are required to return "the 100th result page", i.e. results ranked from 990--1000th, then each partition would still have to find out the top 1000, so partitioning would not help much.

Overall, is there any up-to-date detailed documentation on the internal algorithms used by Lucene?

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-26T08:34:34.427

I am not aware of such documentation, but since Lucene is open-source, I encourage you go reading the source code. In particular, the current trunk version includes [flexible indexing](http://wiki.apache.org/lucene-java/FlexibleIndexing), meaning that the storage and posting list traversal has been decoupled from the rest of the code, making it possible to write custom codecs.

You assumptions are correct regarding posting list traversal, by default (it depends on your [Scorer](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.lucene/lucene-core/3.5.0/org/apache/lucene/search/Scorer.java#Scorer.score%28org.apache.lucene.search.Collector%29) implementation) Lucene traverses the entire posting list for every term present in the query and puts matching documents in a heap of size k to compute the top-k docs (see [TopDocsCollector](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.lucene/lucene-core/3.5.0/org/apache/lucene/search/TopDocsCollector.java#TopDocsCollector)). So returning results from 990 to 1000 makes Lucene instantiate a heap of size 1000\. And if you partition your index by document (another approach could be to split by term), every shard will need to send the top 1000 results to the server which is responsible for merging results (see Solr [QueryComponent](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.solr/solr-core/3.5.0/org/apache/solr/handler/component/QueryComponent.java#QueryComponent.createMainQuery%28org.apache.solr.handler.component.ResponseBuilder%29) for example, which translates a query from N to P>N to several shard requests from 0 to P `sreq.params.set(CommonParams.START, "0");`). This is why Solr might be slower in distributed mode than in standalone mode in case of extreme paging.

I don't know how Google manages to score results efficiently, but Twitter published a [paper on their retrieval engine Earlybird](http://www.umiacs.umd.edu/~jimmylin/publications/Busch_etal_ICDE2012.pdf) where they explain how they patched Lucene in order to do efficient reverse chronological order traversal of the posting lists, which allows them to return the most recent tweets matching a query without traversing the entire posting list for every term.

**Update:** I found this [presentation](http://static.googleusercontent.com/external_content/untrusted_dlcp/research.google.com/en//people/jeff/WSDM09-keynote.pdf) from Googler [Jeff Dean](http://www.quora.com/Jeff-Dean/Who-is-Jeff-Dean), which explains how Google built its large scale information retrieval system. In particular, it talks about sharding strategies and posting list encoding.

# jquery - SPA 是如何运作的？

> ID：10324053
> 
> 赞同：0
> 
> 时间：2012-04-25T21:26:06.583
> 
> 标签：jquery, asp.net-mvc-3, singlepage, single-page-application

我是单页应用程序概念的新手，我正在尝试了解服务器端和客户端导航模式以及 SPA 的请求处理生命周期。如果这些是非常基本的，请原谅。

如果 Web 应用程序尚未在客户端缓存并且用户点击 URL，那么服务器上发生的步骤顺序是什么？

如果在服务器端 SPA 只公开静态数据端点，那么客户端何时下载部分视图？整个 SPA（不同视图的所有部分视图）是否一次性下载？如果是这样，文件如何链接以供下载？

我们如何更改 SPA 不同部分的布局？

当代表 Web 应用程序大模块的“SPA”中有多个页面时，客户端导航如何工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:42:35.343

不知道您对 ASP.NET MVC 了解多少以及这些部分如何协同工作，**[Dan Wahlin](http://www.pluralsight-training.net/microsoft/Authors/Details?handle=dan-wahlin)****的Plural Sight**课程是一个不错的创业项目，名为*Building ASP.NET MVC Apps with EF Code First, HTML5, and jQuery*。

 ***课程说明**：[http](http://www.pluralsight-training.net/microsoft/Courses/TableOfContents?courseName=web-development) ://www.pluralsight-training.net/microsoft/Courses/TableOfContents ? courseName=web-development

**展示 SPA 工作的Youtube 视频**以及整个课程项目是什么：[http ://www.youtube.com/watch?v=Xcp82q6L3lM](http://www.youtube.com/watch?v=Xcp82q6L3lM)

它是一个**单页应用程序**，从数据库和 Web 服务获取数据，它使用最新的技术，例如 EF Code first、Knockout 和 svg，还使用 ​​jQuery 模板...

我有机会看到了整个课程，很可爱……你可以在 Plural Sight 上获得 10 天的[免费试用。](https://www.pluralsight-training.net/microsoft/Subscribe/Step1?isTrial=True)

***PS***我是[Plural Sight 的简单用户](https://stackoverflow.com/questions/3522913/net-video-training-tutorials-when-considering-cost-vs-quality-how-do-learnv/6190210#6190210)，我不以任何其他方式与他们有关联。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T14:41:53.403

您可能想看看 John Papa 关于如何在复数视觉上构建 SPA 的精彩演示。链接在这里

[http://bit.ly/Papa_SPA](http://bit.ly/Papa_SPA)*

# php - 转介系统的制作

> ID：10324056
> 
> 赞同：0
> 
> 时间：2012-04-25T21:26:21.827
> 
> 标签：php, mysql, referrals

我目前正在开发我的推荐系统，但在保护它免受欺诈方面存在问题。好的，这是它现在的工作方式：

*   用户注册并激活其帐户
*   用户现在可以访问控制面板，并且有以下格式的唯一链接：domain.tld/ref/12345
*   当其他人点击用户的链接时，他或她必须点击特定按钮以确认这不是某种欺诈行为（例如“点击这里，您将获得 100 美元”之类的）
*   系统将访问者的 IP 写入数据库，并将一些数据写入 cookie，以防止再次按下按钮。用户现在有 +1 分。

但是，问题是访问者可以更改它的 IP，清除 cookie 并再次点击按钮。这需要几秒钟，这不行，那是作弊。

如何预防？是否有一些技巧可以获取一些唯一的计算机 ID，或者某些东西不能那么容易更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:55:49.917

真正唯一的选择是将过程与用户不太容易操纵的东西联系起来——[超级cookie](http://samy.pl/evercookie/)、[浏览器指纹](http://symcbean.blogspot.co.uk/2012/03/im-currently-spending-significant.html)、OpenID、电子邮件地址和电话号码（后2个在计票前使用某种验证步骤）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:29:49.437

您可以确定被推荐方不重复使用推荐代码的唯一方法是让原始用户向每个人发送不同的一次性使用推荐 URL。一旦使用了代码，它就会在您的数据库中被标记为（或完全从您的数据库中删除），这样就不能再次使用它了。

如何防止原始用户向同一个人发送多个链接是另一回事 - 解决起来并不容易。

你认为谁是威胁？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:49:11.667

虽然它肯定不是 100% 准确，但您仍然可以使用例如他们的 ip、浏览器用户代理的组合对访问者进行指纹识别，并且使用一些 javascript，您甚至可以选择屏幕大小或安装的字体。使用这些信息，您可以建立一个系统，将指纹保存在数据表中，并在同一记录中存储会话 ID（来自 cookie）。现在，当新访客到达时，您可以根据具有不同访客 ID 的近期指纹数据库来测试他们的指纹。如果您发现大量具有不同会话的匹配指纹（您定义了阈值），那么您可以提醒欺诈的可能性。

干杯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T22:19:41.543

当用户导航到链接时，如何与用户一起存储链接。然后在数据库中，您将拥有该链接，如果用户已经访问过该链接，则拒绝他们。似乎它可以工作，那么你就不必担心饼干等......

# java - Mockito ClassCastException

> ID：10324063
> 
> 赞同：12
> 
> 时间：2012-04-25T21:27:03.397
> 
> 标签：java, testing, mocking, mockito

我要测试的方法有一个 for 循环，其中包含 bList 中每个元素的逻辑：

```
class A {
    void someMethod(){

        for(B b: bList){
            //some logic for b
        }
    }
} 
```

执行以下测试时出现异常：

```
@RunWith(MockitoJUnitRunner.class)
class ATest {

    @Mock
    private B b;

    @Mock
    private Map<Int, List<B>> bMap;

    @Mock(answer = Answers.RETURNS_DEEP_STUBS)
    private List<B> bList;

    @Spy
    @InjectMocks
    private C c;
    ....

    @Test
    public void test(){

        //this line executes fine
        when(bList.size()).thenReturn(1);

        //strangely this works fine
        when(bMap.get(any())).thenReturn(bList);

        //ClassCastException
        when(bList.get(0)).thenReturn(b); // or when(bList.get(anyInt())).thenReturn(b);

        c.methodIWantToTest();
    }
} 
```

我得到的例外是：

```
java.lang.ClassCastException:
org.mockito.internal.creation.jmock.ClassImposterizer$ClassWithSuperclassToWorkAroundCglibBug$$EnhancerByMockitoWithCGLIB$$ cannot be cast to xyz.B
```

有没有人遇到过这种情况并提出解决方法？

我已经搜索了一个解决方案并遇到了一些链接： [http](http://code.google.com/p/mockito/issues/detail?id=251) ://code.google.com/p/mockito/issues/detail?id=251 和 [http://code.google.com/p/mockito/issues /detail?id=107](http://code.google.com/p/mockito/issues/detail?id=107)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-26T03:13:56.560

正如[您发布的此链接](http://code.google.com/p/mockito/issues/detail?id=251)所示，您遇到了`Answers.RETURNS_DEEP_STUBS`.

我实际上没有看到`RETURNS_DEEP_STUBS`在您的示例代码中实际使用的任何理由。您确实应该尝试评估是否需要深度存根，因为正如[Mockito 文档所说](http://mockito.googlecode.com/svn/tags/1.8.3/javadoc/org/mockito/Mockito.html#RETURNS_DEEP_STUBS)，“每次模拟返回模拟时，仙女就会死去。” 所以如果可以的话，把它拿出来，你的例子就会奏效。

但是，如果您坚持使用深度存根，则可以通过将方法调用的返回值向上转换为`Object`. 例如，将代码中的违规行替换为：

```
when((Object)bList.get(0)).thenReturn(b); 
```

话虽如此，我个人同意@jhericks。最好的解决方案可能是使用`ArrayList`包含您的 mock 而不是 mocking的 actual `List`。唯一的问题是让你的列表注入，所以你必须使用`@Spy`. 例如：

```
@RunWith(MockitoJUnitRunner.class)
class ATest{
  private B b = mock(B.class);
  @Spy
  private List<B> bList = new ArrayList<B>() {{ add(b); }};

  @InjectMocks
  private C c = new C();

  @Test
  public void test(){
    c.methodIWantToTest();
    // verify results
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-14T10:31:30.577

不幸的是，这是不可能的

案例：API 测试：

```
interface ConfigurationBuilder {...}
configurationBuilder.newServerAction("s1").withName("111")....create(); 
```

这种用法的主要原因是编译时的兼容性维护。但是由于 java 中的类型擦除，mockito 不能支持具有 RETURNS_MOCKS 和 RETURNS_DEEP_STUBS 选项的链中的泛型：

```
Builder/*<ServerActionBuilder>-erasured generic*/ b = configurationBuilder.newServerAction("s1");
b.withName("111")...create(); 
```

上面示例中的结果应该是 ServerAction，但在 mockito 中它是生成类的对象。

请参阅[问题：无法从返回泛型类型的泛型方法返回深层存根 #484](https://github.com/mockito/mockito/issues/484)

# jquery - IE8中的jquery工具覆盖掩码

> ID：10324066
> 
> 赞同：0
> 
> 时间：2012-04-25T21:27:23.917
> 
> 标签：jquery, css, internet-explorer, overlay, jquery-tools

我正在使用 jQuery 工具覆盖小部件制作一个网站，它在 Firefox 和 Chrome 上运行良好，但与往常一样，它在 Internet Explorer 中存在问题，特别是 IE8，其中掩蔽背景甚至影响覆盖，使得无法点击任何地方在页面上，甚至关闭覆盖。

这是元素：

```
<div id="caja" class="wizard modal">
    <p id="texto"></p>
    <div class="contenedorCheckbox"><input type="checkbox" class="mostrarAyuda" /><span class="mostrarAyuda">Mostrar la ayuda la próxima vez</span></div>
    <br/>
    <button type="button" id="anterior">&lt; Anterior</button>
    <button type="button" id="siguiente">Siguiente &gt;</button>
    <button type="button" id="salir">Salir</button>
</div> 
```

jQuery代码：

```
$('#comercio_index_content_body #caja').overlay({
    top: 170,
    mask: {
        color: '#fff',
        loadSpeed: 200,
        opacity: 0.5
    },
    closeOnClick: false,
    load: true,
    onClose: function () {
        $("body").css("overflow", "");
    }
}); 
```

（我有溢出：隐藏在此之前准备好的文档中）

和CSS：

```
.modal  {
    background-color:#fff;
    display:none;
    width:350px;
    padding:15px;
    text-align:left;
    border:2px solid #333;
    opacity:0.8;
    -moz-border-radius:6px;
    -webkit-border-radius:6px;
    -moz-box-shadow: 0 0 50px #ccc;
    -webkit-box-shadow: 0 0 50px #ccc;
} 
```

我不知道 Explorer 与 css 的所有不兼容性，所以，你能告诉我这段代码有什么问题吗？

提前致谢

编辑：我遇到了问题，但这是一个不同的问题，所以我将这个问题留给另一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:32:34.253

对于 IE 在 css 中使用的不透明度：

```
filter:progid:DXImageTransform.Microsoft.Alpha(opacity=80); 
```

# c - 在 C 中取消引用字符串指针

> ID：10324087
> 
> 赞同：0
> 
> 时间：2012-04-25T21:29:05.140
> 
> 标签：c, pointers

我是 C 新手，我想知道下面两个代码段之间的区别。当我尝试执行第一个代码段时，它工作正常，但是当我运行第二个代码段时，它给了我分段错误。这种行为的原因是什么？

```
 printf("%c\n",*strptr++);

        printf("%c\n",*(strptr+i)); 
```

这是下面的代码。

```
#include<stdio.h>

int main(void)
{
        char str[100]="My name is Vutukuri";
        int i=0;
        char *strptr;

        strptr=str;

        while(*strptr != '\0')
        {
                printf("%c\n",*strptr++);
                //printf("%c\n",*(strptr+i));
                //i++;
        }
        return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:33:21.683

完全不同。

第一个片段打印字符 at`strptr`然后递增`strptr`1。

第二个片段在 处打印字符`strptr + i`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T21:37:12.377

显然，地址`strptr`是指内存中已分配的位置，而`strptr + i`指向未分配的位置。如果您将字符串分配为

```
char s[LENGTH]; 
```

或者

```
char* s = (char*)malloc(LENGTH * sizeof(char)); 
```

那么您只能使用`s[0]`to的字符`s[LENGTH - 1]`（并且字符串本身只能很`LENGTH - 1`长，因此可以使用空终止符）。在您的情况下，指针`strptr + i`可能不在范围内`s...s + LENGTH - 1`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T21:33:55.833

也许您想将 i 替换为 1。

*   ++ 运算符首先使用初始值，然后将其递增。
*   +operator 计算新值，然后使用它。

# asp.net-mvc-3 - DropDownlistFor 使用 MVC3 创建新实体

> ID：10324088
> 
> 赞同：1
> 
> 时间：2012-04-25T21:29:07.643
> 
> 标签：asp.net-mvc-3, entity-framework, razor, html.dropdownlistfor

我正在开发一个小应用程序，以便更好地了解 MVC3 和 Razor 的工作原理。我正在使用 MVC3，所有代码都是自动生成的（通过 T4 的 dbContext，通过添加控制器的控制器，来自 EDMX 模型的 Databese...）。

在我的模型中，我有这个简单的模型：http: [//i.stack.imgur.com/nyqu4.png](http://i.stack.imgur.com/nyqu4.png)

```
public partial class Application
{
    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ApplicationType ApplicationType { get; set; }
}

public partial class ApplicationType
{
    public int Id { get; set; }
    public string Type { get; set; }
} 
```

如您所见，ApplicationType 基本上是一个枚举（遗憾的是 EF 4 不支持枚举）。所以，在我的 ApplicationController 我有这个：

```
public ActionResult Create()
{
    ViewBag.AppTypes = new SelectList(db.ApplicationTypes.OrderBy(c => c.Type), "Id", "Type");
    return View();
} 

[HttpPost]
public ActionResult Create(Application application)
{
    if (ModelState.IsValid)
    {
        db.Applications.Add(application);
        db.SaveChanges();
        return RedirectToAction("Index");
    }

    return View(application);
} 
```

在我看来：

```
@Html.DropDownListFor(model => model.ApplicationType.Id, (SelectList)ViewBag.AppTypes, "Choose...") 
```

现在我面临两个问题：

**1) 未填充 ApplicationType：**

由于@Html.DropDownListFor 仅呈现一个简单的选择，它填充ID，但不填充Type 属性，如下所示（对不起，我无法发布图像，因为我是新来的）：

[http://i.stack.imgur.com/96IR1.png](http://i.stack.imgur.com/96IR1.png)

图中可以看到ID是ok的，但是Type是空的。

我做错了什么？

**2) 重复数据**

第二个问题是，如果我在调试期间手动填充 Type 属性（模拟正确的工作流场景），ApplicationType 将在数据库中复制，而不是仅引用旧注册表。

那么，如何使 @Html.DropDownListFor 引用以前的现有项目而不是创建新项目？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:39:47.903

你有没有尝试过：

```
@Html.DropDownListFor(model => model.ApplicationType.Id, m => m.ApplicationType.Type, "Choose...") 
```

注意第二个参数的变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:41:15.670

我相信您犯的错误是在视图中使用域模型并假设在发布后整个模型应该完全绑定并准备好存储在数据库中。虽然可以在视图中使用域模型，但更好的做法是创建单独的**视图模型**。

例如 ：

```
public class ApplicationViewModel
{
    public int Id { get; set; }
    public string Name { get; set; }

    public SelectList ApplicationTypeList { get; set; }
    public string ApplicationTypeId { get; set; }
} 
```

在您看来：

```
@Html.DropDownListFor(model => model.ApplicationTypeId, Model.ApplicationTypeList , "Choose...") 
```

在您的控制器中

```
[HttpPost]
public ActionResult Create(ApplicationViewModel model)
{
    if (ModelState.IsValid)
    {
        Application application = new Application()
        {
           Id = model.Id,
           Name = model.Name,
           ApplicationType = db.ApplicationTypes
              .First(a => a.Id == model.ApplicationTypeId);

        };
        db.Applications.Add(application);
        db.SaveChanges();
        return RedirectToAction("Index");
    }

    return View(model);
 } 
```

然后，您可以验证您的 View Model 的 ApplicationTypeId 是否对应于您的模型状态验证的真实应用程序类型部分。您可以使用[AutoMapper](http://automapper.codeplex.com/ "自动映射器")加快将视图模型转换为域模型的过程。

# javascript - jQuery / datatables：排序和页面后更新排名列

> ID：10324089
> 
> 赞同：0
> 
> 时间：2012-04-25T21:29:09.493
> 
> 标签：javascript, jquery, datatables

表的第一列在当前排序顺序中具有其排名。我在排序后更新它（简单），但无法弄清楚如何访问当前页面＃和页面大小以更新第 2、第 3 等页面。我有..

```
 $("table.datatable")
            .dataTable({
                fnDrawCallback: function() {
                    $(this).find("td.counter span").each(function(i, row) {
                        $(this).html(i + 1);
                        // Should be something like
                        // $(this).html(dataTable.pageno + dataTable.pagesize + i)
                    });
                }
            }); 
```

获取页面＃和页面大小的正确方法是什么，所以第二页的第一行是＃11（如果每页10）？

**UPDATE**最终这样做了；不确定它有多“合适”，但是..

```
fnDrawCallback: function(settings) {
    $(this).find("td.counter span").each(function(i, row) {
        $(this).html(i + 1 + settings._iDisplayStart);
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:58:00.457

您可以在 Datatables 文档中使用此示例，该示例将索引列添加到您的表中：

[http://datatables.net/release-datatables/examples/api/counter_column.html](http://datatables.net/release-datatables/examples/api/counter_column.html)

# android - 谷歌地图路线未正确显示

> ID：10324099
> 
> 赞同：0
> 
> 时间：2012-04-25T21:30:04.983
> 
> 标签：android, google-maps

我正在尝试构建一个 GPS 应用程序，它可以显示两个地方之间的方向。为了解码折线，我使用了这里的代码：[Decoding Polylines from Google Maps Direction API with Java](http://jeffreysambells.com/posts/2010/05/27/decoding-polylines-from-google-maps-direction-api-with-java/)。我想比这更准确地显示我的路线，我可以通过 kml 做到这一点，但它仅在文件大小达到限制之后才适用于非常小的距离。这是波士顿-西雅图的屏幕截图，其中地图上的线条不沿着道路而是与道路相交
![在此处输入图像描述](../Images/52e06c7af9b03382437855768288a090.png)

这是我使用方向 API 的方式

```
public void drawRoute(String source, String destination)
{
    String strURL = "http://maps.google.com/maps/api/directions/xml?origin=" + source + 
            "&destination=" + destination + "&sensor=false&mode=driving";

    String url = strURL.replace(" ", "%20");
    HttpGet get = new HttpGet(url);
    String strResult = "";
    try {
        HttpParams httpParameters = new BasicHttpParams();
        HttpConnectionParams.setConnectionTimeout(httpParameters, 3000);
        HttpClient httpClient = new DefaultHttpClient(httpParameters); 
        HttpResponse httpResponse = null;
        httpResponse = httpClient.execute(get);
        if (httpResponse.getStatusLine().getStatusCode() == 200){
            strResult = EntityUtils.toString(httpResponse.getEntity());
        }
    }
    catch (Exception e){ }

    if (-1 == strResult.indexOf("<status>OK</status>")){
        this.finish();
        return;
    }

    int pos = strResult.indexOf("<overview_polyline>");
    pos = strResult.indexOf("<points>", pos + 1);
    int pos2 = strResult.indexOf("</points>", pos);
    strResult = strResult.substring(pos + 8, pos2);

    List<GeoPoint> points = decodePoly(strResult);

    RouteOverlay mOverlay = new RouteOverlay(points);
    overlayList.add(mOverlay);

    if (points.size() >= 2){
        controller.animateTo(points.get(0));
    }
    map.invalidate();
} 
```

这是我的 RouteOverlay 课程：

```
public class RouteOverlay extends Overlay{
private List<GeoPoint> points;
private Paint paint;

public RouteOverlay(List<GeoPoint> points) {
    this.points = points;
    paint = new Paint();
    paint.setColor(Color.BLUE);
    paint.setAlpha(150);
    paint.setAntiAlias(true);
    paint.setStyle(Paint.Style.FILL_AND_STROKE);
    paint.setStrokeWidth(4);
}

@Override
public void draw(Canvas canvas, MapView mapView, boolean shadow) 
{
    if (!shadow) 
    {
        Projection projection = mapView.getProjection();
        if (points != null && points.size() >= 2) 
        {
            Point start = new Point();
            projection.toPixels(points.get(0), start);
            for (int i = 1; i < points.size(); i++) 
            {
                Point end = new Point();
                projection.toPixels(points.get(i), end);
                canvas.drawLine(start.x, start.y, end.x, end.y, paint);
                start = end;
            }
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T07:00:06.703

请参阅此[链接](http://asmncl.blogspot.in/2012/04/android-draw-route-map-between-two.html)以在您的应用程序中绘制行驶路径。您只需在项目中添加链接中存在的四个类，并在需要显示路线时调用以下行。

```
SharedData data = SharedData.getInstance();
data.setAPIKEY("0RUTLH7cqd6yrZ0FdS0NfQMO3lioiCbnH-BpNQQ");//set your map key here
data.setSrc_lat(17);//set your src lat
data.setSrc_lng(78);//set your src lng
data.setDest_lat(18);//set your dest lat
data.setDest_lng(77);//set your dest lng
startActivity(new Intent(YourActivity.this,RoutePath.class));//add RoutePath in your manifeast file 
```

//同时将权限添加到您的清单文件

```
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"></uses-permission>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"></uses-permission>

<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>

<uses-permission android:name="android.permission.INTERNET"></uses-permission> 
```

# internet-explorer-8 - IE9.js（代码 0）中的无效参数行：6 字符：28214

> ID：10324100
> 
> 赞同：4
> 
> 时间：2012-04-25T21:30:06.643
> 
> 标签：internet-explorer-8, ie8-compatibility-mode, ie8-browser-mode

我在兼容性视图中使用 IE8，虽然这确实产生了可接受的渲染，但这只会在刷新后发生。

当页面第一次加载时，它根本不会显示（停留在前一页）并且只给出这个错误：

```
Invalid argument
IE9.js
Code: 0
Line: 6
Char: 28214 
```

我对这个问题的解决方案的搜索产生了以下不*提供*任何解决方案的[旧线程。](http://code.google.com/p/ie7-js/issues/detail?id=300)

 *但是，它确实提供了一个指向演示此错误的*最小*可重现测试用例的链接。

[http://panoptic.com/ie7-js-300/](http://panoptic.com/ie7-js-300/)

在打开“兼容性视图”的情况下使用 IE8 访问该 URL，您将看到 JS 错误。

检查`IE9.js`文件时，第 6 行 char 28214 指向`.`in：

```
g.runtimeStyle[a]= 
```

知道如何解决这个问题吗？（是的，它需要在兼容性视图中工作）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:46:14.707

这可能会给你一些问题的方向。[http://code.google.com/p/ie7-js/issues/detail?id=300#c12](http://code.google.com/p/ie7-js/issues/detail?id=300#c12)

即使我正在寻找解决方案。

更新：[http ://code.google.com/p/ie7-js/issues/detail?id=354](http://code.google.com/p/ie7-js/issues/detail?id=354)*

# r - R：如何按行检测矩阵中的模式

> ID：10324102
> 
> 赞同：0
> 
> 时间：2012-04-25T21:30:19.577
> 
> 标签：r, matrix

我有一个有 4 列的大矩阵，包含归一化值（按列，平均值 ~ 0 和标准偏差 = 1）

我想看看矩阵中是否有模式，如果有，我想按模式对行进行聚类，按模式我的意思是给定行示例中的值

对于第 N 行

如果第 1 列中的值 < 第 2 列 < 第 3 列 < 第 4 列，那么假设是模式 1

基本上有 4^4 = 256 种可能的模式（理论上）

R中有没有办法做到这一点？

提前致谢

辐射

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:51:18.227

是的。（虽然不同排列的数量只有 24 = 4*3*2。选择一个值后，第二个可能的值只有三个，第二个指定后只剩下两个排序。）该`order`函数应用于每行应给出所需的 1,2,3,4 排列：

```
mtx <- matrix(rnorm(10000), ncol=4)
res <- apply(mtx, 1, function(x) paste( order(x), collapse=".")  )

> table(res)[1:10]
> table(res)
res
1.2.3.4 1.2.4.3 1.3.2.4 1.3.4.2 1.4.2.3 1.4.3.2 
     98     112      95     120     114     118 
2.1.3.4 2.1.4.3 2.3.1.4 2.3.4.1 2.4.1.3 2.4.3.1 
    101     114     105     102     104     122 
3.1.2.4 3.1.4.2 3.2.1.4 3.2.4.1 3.4.1.2 3.4.2.1 
    105      82     107      90      97      86 
4.1.2.3 4.1.3.2 4.2.1.3 4.2.3.1 4.3.1.2 4.3.2.1 
     99      93     100     108     118     110 
```

# django - Django url 模式 - 如何获取页面的绝对 url？

> ID：10324106
> 
> 赞同：1
> 
> 时间：2012-04-25T21:30:52.073
> 
> 标签：django, url, url-pattern

我正在尝试在 Django 中获取请求的 url 的完整路径。我使用这样的 url 模式：('^', myawesomeview)，它适用于 domain.com/hello、domain.com/hello/sdfsdfsd，甚至适用于 domain.com/hello.php/sd""^some!bullshit .index.aspx（尽管“^”被替换为“%5E”）

但是当我尝试在请求中使用 # 时（例如[http://127.0.0.1:8000/solid#url](http://127.0.0.1:8000/solid#url)）它只返回“/sold”。有没有办法在不进行任何更改或替换的情况下获得完整路径？

顺便说一句，我得到带有返回 HttpResponse(request.path) 的 url 提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:52:24.847

URI 中以“#”号分隔的部分称为片段标识符。它的意义是只在客户端处理，而不是传递给服务器。所以如果你真的需要这个，你必须用 JS 来处理它，例如，把它作为一个常用的参数传递。否则，此信息将永远不会发送给 Django。

# sql - 显示具有重复某些列的所有行

> ID：10324107
> 
> 赞同：31
> 
> 时间：2012-04-25T21:30:52.680
> 
> 标签：sql, sql-server-2008

假设我有以下 sql 表

```
 objid  firstname lastname active
     1       test      test     0
     2       test      test     1
     3       test1     test1    1
     4       test2     test2    0
     5       test2     test2    0
     6       test3     test3    1 
```

现在，我感兴趣的结果如下：

```
 objid  firstname lastname active
     1       test      test     0
     2       test      test     1
     4       test2     test2    0
     5       test2     test2    0 
```

我怎样才能做到这一点？我尝试了以下查询，

```
select firstname,lastname from table
group by firstname,lastname
having count(*) > 1 
```

但是这个查询给出的结果如下

```
 firstname  lastname
     test        test
     test2       test2 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-04-25T21:34:22.890

您已找到重复的记录，但您有兴趣获取附加到它们的所有信息。您需要将`join`副本复制到主表才能获取该信息。

```
select *
  from my_table a
  join ( select firstname, lastname 
           from my_table 
          group by firstname, lastname 
         having count(*) > 1 ) b
    on a.firstname = b.firstname
   and a.lastname = b.lastname 
```

这与 an 相同`inner join`，意味着对于子查询中的每条记录，找到重复记录的您从主表中找到具有相同 firstseen 和 lastseen 组合的所有内容。

您也可以使用 in 执行此操作，[但您应该测试差异](https://stackoverflow.com/questions/1200295/sql-join-vs-in-performance)：

```
select *
  from my_table a
 where ( firstname, lastname ) in   
       ( select firstname, lastname 
           from my_table 
          group by firstname, lastname 
         having count(*) > 1 ) 
```

### 延伸阅读：

*   来自 Coding Horror[的连接的可视化表示](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)
*   加入维基百科的[解释](http://en.wikipedia.org/wiki/Join_(SQL))

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-25T21:36:00.840

```
SELECT DISTINCT t1.*
FROM myTable AS t1
INNER JOIN myTable AS t2
  ON t1.firstname = t2.firstname
  AND t1.lastname = t2.lastname
  AND t1.objid <> t2.objid 
```

这将输出具有重复项的每一行，基于`firstname`和`lastname`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-25T21:48:01.420

这是做本的第一个答案的更清晰的方法：

```
WITH duplicates AS (
   select    firstname, lastname
   from      my_table
   group by  firstname, lastname
   having    count(*) > 1
)
SELECT    a.*
FROM      my_table   a
JOIN      duplicates b ON (a.firstname = b.firstname and a.lastname = b.lastname) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-03-28T11:37:19.623

```
SELECT user_name,email_ID 
FROM User_Master WHERE 
email_ID 
in (SELECT email_ID 
FROM User_Master GROUP BY 
email_ID HAVING COUNT(*)>1) 
```

[![在此处输入图像描述](../Images/c4ec77df23f42c68d77be087419161e3.png)](https://i.stack.imgur.com/8qfP5.jpg)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-26T17:44:33.987

不错的选择从表中获取所有重复值

```
 select * from Employee where Name in (select Name from Employee group by Name having COUNT(*)>1) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-06-20T09:05:44.280

这是最简单的方法：

```
SELECT * FROM yourtable a WHERE EXISTS (SELECT * FROM yourtable b WHERE a.firstname = b.firstname AND a.secondname = b.secondname AND a.objid <> b.objid) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-09-17T04:04:41.147

如果要打印表中的所有重复 ID：

```
select * from table where id in (select id from table group By id having count(id)>1) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-05-03T18:02:17.577

**我很惊讶使用Window function**没有答案。我刚刚遇到了这个用例，这对我有帮助。

```
select t.objid, t.firstname, t.lastname, t.active
from
(
select t.*, count(*) over (partition by firstname, lastname) as cnt
from my_table t
) t
where t.cnt > 1; 
```

小提琴 - [https://dbfiddle.uk/?rdbms=sqlserver_2017&fiddle=c0cc3b679df63c4d7d632cbb83a9ef13](https://dbfiddle.uk/?rdbms=sqlserver_2017&fiddle=c0cc3b679df63c4d7d632cbb83a9ef13)

* * *

格式如下

```
select
    tbl.relevantColumns
from
(
    select t.*, count(*) over (partition by key_columns) as cnt
    from desiredTable t
) as tbl
where tbl.cnt > 1; 
```

`count > 1`此格式从用于`key_columns`标识重复行的表中选择您需要的任何列（有时是所有列） 。`key_columns`可以是任意数量的列。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-27T05:56:02.973

这个答案可能不是很好，但我认为它很容易理解。

```
SELECT * FROM table1 WHERE (firstname, lastname) IN ( SELECT firstname, lastname FROM table1 GROUP BY firstname, lastname having count() > 1); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-05-03T07:45:51.783

此查询返回重复项

```
SELECT * FROM (
  SELECT  a.* 
    FROM table a 
    WHERE (`firstname`,`lastname`) IN (
        SELECT `firstname`,`lastname` FROM table 
        GROUP BY `firstname`,`lastname` HAVING COUNT(*)>1       
        )  
    )z WHERE z.`objid` NOT IN (
        SELECT MIN(`objid`) FROM table 
        GROUP BY `firstname`,`lastname` HAVING COUNT(*)>1
        ) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-04-07T15:11:01.800

请试试

```
WITH cteTemp AS (
  SELECT EmployeeID, JoinDT,
     row_number() OVER(PARTITION BY EmployeeID, JoinDT ORDER BY EmployeeID) AS [RowFound]
  FROM dbo.Employee 
)
SELECT * FROM cteTemp WHERE [RowFound] > 1 ORDER BY JoinDT 
```

# json - 找到所有叶节点的完整路径？

> ID：10324113
> 
> 赞同：2
> 
> 时间：2012-04-25T21:31:30.647
> 
> 标签：json, graph, quickgraph

我正在使用 QuickGraph 来创建 (P) 产品及其相关属性、(T) 类型、(S) 子类型和 (F) 频率的图表。

所以在这个例子中，我有 2 个产品 P1 和 P2：

*   P1 被分配属性 T1, S1 & S2, F1
*   P2 被分配属性 T1、S1、F1 和 F2

有向的未加权图如下所示：

![在此处输入图像描述](../Images/409d8a228f27b39d865394f47390c5a5.png)

有没有办法使用它生成一个 JSON 对象来保存所有产品的完整路径？就像是：

```
{T1: [
    {S1: [
        {F1: [
            P1,P2
        ]},
        {F2: [
            P2
        ]}
    ]},
    {S2: [
        {F1: [
            P1
        ]}
    ]}
]} 
```

我最初查看了 DepthFirstSearchAlgorithm 及其 DiscoverVertex 事件，它将按深度遍历图形，但该事件仅在发现**新**顶点时触发，因此我得到 T1、S1、F1、P1、P2、F2、S2。

任何帮助表示赞赏。

# regex - 如何匹配包含每个元音的单词至少一次？

> ID：10324115
> 
> 赞同：5
> 
> 时间：2012-04-25T21:31:53.897
> 
> 标签：regex

如何匹配包含每个元音的单词至少一次？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:42:30.570

这取决于你所说的“元音”是什么意思——就此而言，你所说的“单词”也是什么意思——但正常的方式是这样的：

```
(?xsi)
(?= .* a)
(?= .* e)
(?= .* i)
(?= .* o)
(?= .* u)
(?= .* y) 
```

但你不想那样做。您想将逻辑连接放在适当的编程语言中，而不是正则表达式中，这会导致这样的事情（忽略大小写问题）：

```
/a/ && /e/ && /i/ && /o/ && /u/ && /y/ 
```

# 什么是元音？

请注意，整个“元音”问题非常荒谬，因为任何连续音都可以表现得像元音，即使它看起来不像元音。这意味着一些看起来不像元音的字母是。另外，有时字母看起来像元音，但不是。

1.  例如，*s*是*psst ，* *little*中的第二个*l*，*acre*中的*r*和*nth*中的*n*都充当元音。另外还有著名的单词*cwm*，来自威尔士语，其中*w*是元音。

****   此外，Mike 中的e*不是**元音*，而*i*有一个双元音（两个元音融合）。

    ***   此外，虽然*天空中的**y*是元音，但*黄色*中的*y*不是元音。

    ****   你必须弄清楚你认为在诸如*lie*或*speak*甚至*queue*之类的词中有多少个元音。

    *   最后，如果您有变音符号，您必须决定是否将它们单独计算。*e*、*é*、*è*和*ê*只是一个元音还是四个？******** 

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:30:20.703

这个怎么样

```
\s* (?= \S* a)  (?= \S* e)  (?= \S* i)  (?= \S* o)  (?= \S* u)  (?= \S* y) (\S*) 
```**

# python - 多维数组上的映射函数

> ID：10324118
> 
> 赞同：1
> 
> 时间：2012-04-25T21:32:11.807
> 
> 标签：python, map, multidimensional-array

我有一个浮点值的大型 4D 数组（时间、高度、纬度、经度）。我想有效地将​​数组中大于 100.0 的任何值强制为 100.0。我认为`map`函数（+ `lambda`？）可以做到这一点，但我被卡住了。目前，我有一个粗略的 for 循环遍历每个索引，但这花费的时间太长了！

提前感谢您的帮助！

解决方案：numpy.clip(array,0,100.0)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:39:33.860

为了提高效率，您可能应该使用[NumPy](http://numpy.scipy.org/)。

使用 NumPy，您可以拥有节省空间的[多维数组](http://docs.scipy.org/doc/numpy-1.6.0/reference/arrays.ndarray.html)并准备好[解决您的问题](http://docs.scipy.org/doc/numpy-1.6.0/reference/generated/numpy.clip.html#numpy.clip)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T21:39:51.883

> 我有一个浮点值的**大型 4D 数组**（时间、高度、纬度、经度）。我要**高效**

停止。

使用[numpy](http://numpy.scipy.org/)。

# java - 方法声明中的异常。JAXB

> ID：10324120
> 
> 赞同：3
> 
> 时间：2012-04-25T21:32:31.760
> 
> 标签：java, web-services, jaxb, cxf

假设我有这样的异常层次结构：

```
public class A extends RuntimeException {
...
}

public class B extends A {
...
} 
```

在web服务接口中有一个方法：

```
public void aa() throws A; 
```

此方法的实现可以抛出异常`A`或异常`B`，但是在部署到 tomcat 时，cxf 仅发布带有`A`异常声明的 wsdl。

我尝试`@XmlRootElement`在两个类、`@XmlType`两个类、`@XmlRootElement`父类、父类上`@XmlRootElement`使用`@XmlSeeAlso`，但发布的 wsdl 没有`B`异常声明。此外，我编写了一个使用该 wsdl 的测试，并且测试仅获得 A 异常，但是我已经模拟了这两种类型的异常。如何在 wsdl 声明中获取子异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T10:53:33.733

我认为您需要列出从 抛出`A`的`B`可能的异常`aa`，否则 jaxb 无法知道您可能会抛出派生类的异常。尝试：

```
public void aa() throws A, B; 
```

# xslt-2.0 - XSL 中的显式类型变量

> ID：10324122
> 
> 赞同：2
> 
> 时间：2012-04-25T21:32:54.030
> 
> 标签：xslt-2.0

我正在使用 XSL 的便捷函数进行比较，`gt, lt, ge, le, eq`.

我知道这些函数在执行比较时不会将字符串提升为数值，但是我需要进行强制转换，并且我不想用类似的行来混淆我的代码

```
<xsl:when test="xs:integer($variable) lt 250" > 
```

我宁愿让演员像这样（当然是假设的）

```
<xsl:variable name="variable" type="xs:integer"> 
```

那么，是否有一种`variable`在声明/创建时显式转换为数字类型的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T02:37:20.497

> ```
> <xsl:when test="xs:integer($variable) lt 250" > 
> ```
> 
> 我宁愿让演员像这样（当然是假设的）
> 
> ```
> <xsl:variable name="variable" type="xs:integer"> 
> ```

**使用`as`属性**——其目的正是指定变量、参数、模板或函数的类型：

```
<xsl:variable name="variable" as="xs:integer" 
              select="some-integer-type-expression"> 
```

# android - 安装Android SDKr18，SDK检测不到JDK

> ID：10324127
> 
> 赞同：0
> 
> 时间：2012-04-25T21:33:24.363
> 
> 标签：android, sdk, java

![在此处输入图片描述][1]感谢您抽出宝贵时间阅读我的问题。

这不是另一个返回，然后是下一个问题。

我已经安装了eclipse classic和jdk-7u3-windows-x64，问题是当我去安装android SDK时，我得到这个错误：

[http://i.stack.imgur.com/V9VIY.jpg](http://i.stack.imgur.com/V9VIY.jpg)

我一直在网上搜索一夜，一个解决方案似乎是针对早期版本的Android SDK是单击返回然后下一步，我尝试了这个无济于事。我还设置了一个环境变量，这也不起作用。我已经检查过 java 确实已经安装，我已经以管理员身份运行并安装了所有软件。我仍然收到同样的信息。

那么有人可以帮我解决这个问题吗？

非常感谢您的帮助！

缺口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T16:09:40.853

我在 Windows 7 - 64 位机器上遇到了类似的问题。Andriod SDK 的安装将挂在它试图定位 JDK 的屏幕上。我安装了 64 位和 32 位 JDK。JAVA_HOME 已设置为将 JDK (32) 位更正为 C:\Java\jdk1.6.0_13，但安装程序将陷入循环并且永远无法从屏幕中恢复。

这真的很愚蠢，但我必须做的是，这次在不同的目录中重新安装 jdk-6 32 位 (C:\Program Files (x86)\Java\jdk1.6.0_31) ，将 JAVA_HOME 更改为 C:\ Program Files (x86)\Java\jdk1.6.0_31 并重新安装 SDK。非常奇怪的是，它没有在 C:\Program Files (x86)\Java\jdk1.6.0_31 中安装 JAVA_HOME 中设置的新安装的 JDK，而是从 C:\Java\jdk1.6.0 中安装了我的旧安装_13\

有人真的需要在 Google 上检查他们的代码！！

但是排序，我很高兴

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T02:02:23.363

我认为所有安装和卸载java都会导致上述错误。无论如何将我的计算机恢复到某个点并安装jdk 6 32而不是开始。sdk马上就找到了。

# javascript - window.print 不适用于 Firefox

> ID：10324133
> 
> 赞同：1
> 
> 时间：2012-04-25T21:34:02.647
> 
> 标签：javascript, html

我对不适用于 firefox 的 JS 函数不太熟悉，因此我在这里发帖询问你们我的代码有什么问题。适用于除火狐以外的任何其他浏览器。

```
var headstr = "<html><head><title></title></head><body>";
var footstr = "</body>"; 
var newstr = document.all.item("printable").innerHTML; 
var oldstr = document.body.innerHTML; 
document.body.innerHTML = headstr+newstr+footstr; 
window.print(); 
document.body.innerHTML = oldstr; 
return false; 
```

我做了一些阅读，我得到的只是document.focus不适用于firefox，但我没有使用那行代码，所以我对导致我的问题的原因有点迷茫。谢谢你们。

发生的事情是它什么都不做，试图发出警报以防万一并且它工作正常（当然评论了所有代码并且只留下警报）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:48:35.010

Firefox 不打印任何内容，因为会引发早期错误。`document.all`在`undefined`火狐中。打开控制台后，应该可以在附近看到以下错误消息`var newstr = ...`：

```
TypeError: document.all is undefined 
```

# rake - Rake clean -- 排除子目录

> ID：10324134
> 
> 赞同：1
> 
> 时间：2012-04-25T21:34:04.117
> 
> 标签：rake

我有一个如下所示的目录树：

```
|- src
| \- stuff
| \- app
|- target
| \- stuff
| \- app 
```

我有以下内容`rakefile`：

```
include 'rake/clean'
CLEAN.include 'target'
CLEAN.exclude 'target/stuff' 
```

我的意图是让树最终如下所示：

```
|- src
| \- stuff
| \- app
|- target
| \- stuff 
```

显然，在我上面的示例中，这可以完成，`CLEAN.include 'target/app'`但我的实际布局更复杂。

有没有办法排除`target/app`被清理但仍然清理`target`目录中的所有其他内容？如果不是，那么`CLEAN.exclude`在 api 中有什么意义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T14:15:01.873

我同意 exclude 似乎没有按预期运行。这是我为解决此问题所做的工作：

```
Dir['target/*'].each do |file|
  CLEAN.include file unless file == 'stuff'
end 
```

# c++ - 获取在 C++ 中创建/修改注册表项的日期

> ID：10324136
> 
> 赞同：4
> 
> 时间：2012-04-25T21:34:11.667
> 
> 标签：c++, windows, registry

我似乎找不到这样做的方法，但我觉得奇怪的是，注册表项在创建时根本不会被赋予时间戳。有谁知道一种方法？目标平台是 XP 32 位。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T21:37:09.213

[RegQueryInfoKey()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724902%28v=vs.85%29.aspx)声明它可以检索最后修改时间：

```
lpftLastWriteTime [输出，可选]

    指向接收最后写入时间的 FILETIME 结构的指针。
    此参数可以为 NULL。

    该函数设置 FILETIME 结构的成员以指示
    上次修改键或其任何值条目的时间。

```

# c# - 如何使用 SHA512 对密码进行哈希处理

> ID：10324141
> 
> 赞同：2
> 
> 时间：2012-04-25T21:34:35.787
> 
> 标签：c#, security, encryption, passwords, hash

在我之前的问题中，我被告知要散列密码而不是加密，结果证明这是正确的。问题是，我以前从未处理过散列密码，所有文档都说我尝试在测试帐户上使用的 SHA512 无济于事。我不知道从这里去哪里。代码注释为我提供了他们称之为“加密”字符串的示例，它是“FA35A0194E3BE7024CEFB1839CBFC922”，我不确定如何使用 SHA512 对其进行格式化，因为它所需要和返回的只是一个字节数组或来自`ComputeHash()`方法：

```
byte[] hashedPassword = HashAlgorithm.Create("SHA512").ComputeHash( ??? ); 
```

更新

我尝试在字节上打印出 UTF8Encoding.GetString，但它只显示一堆看起来与示例文档中的字符完全不同的废话字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T21:56:51.130

使用普通的 SHA-512 散列仍然是错误的。使用通过[Rfc2898DeriveBytes](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx)公开的 PBKDF2 。

它返回原始字节，您应该使用 hex 或 base64 对其进行编码。

您可以使用以下方法进行十六进制编码：

```
BitConverter.ToString(bytes).Replace("-","") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:50:47.307

你确定它说 512 因为那是 128，但无论如何你可以使用类似的东西

```
System.String Hashed = System.BitConverter.ToString(((System.Security.Cryptography.SHA512)new System.Security.Cryptography.SHA512Managed()).ComputeHash(System.Text.Encoding.ASCII.GetBytes("NotHashedPass"))).Replace("-","");

MessageBox.Show(Hashed); 
```

但我建议至少使用盐。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-30T15:04:16.380

请在此处查看教程： [http ://www.obviex.com/samples/hash.aspx](http://www.obviex.com/samples/hash.aspx)

来自教程：“这些代码示例演示了如何散列数据和验证散列。它支持多种散列算法。为了帮助降低字典攻击的风险，代码在生成之前将随机字节（所谓的盐）添加到原始纯文本中散列并将它们附加到生成的密文（散列验证需要原始盐值）。生成的密文是 base64 编码的。重要提示：数据散列不能被解密回纯文本“

# c - 如何读取 wtmp 文件？

> ID：10324144
> 
> 赞同：1
> 
> 时间：2012-04-25T21:35:07.017
> 
> 标签：c

我正在处理使用各种数据结构来存储和排序数据的任务。数据结构部分对我来说相当简单，但是，我在第一步中被挂断了，读取/解析一个 wtmp 文件。我以前解析过几个文件，但从来没有解析过二进制文件。解析这样的文件有什么技巧？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:43:45.390

尝试使用[utmp.h](http://linux.about.com/library/cmd/blcmdl5_wtmp.htm)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T22:36:40.147

这是一个如何解析它的示例，您需要将文件的字节读入 utmp 结构。您真的应该查看手册页以了解所有详细信息，这与使用标准 C 库读取文件不同。

```
#include<stdio.h>
#include<fcntl.h>
#include<utmp.h>

int main()
{
      int fd;
      struct utmp cr;
      int reclen = sizeof(struct utmp);

      fd = open(WTMP_FILE, O_RDONLY);
      if (fd == -1){
        perror("oops");
        exit(1);
      }
      while (read(fd, &cr, reclen) == reclen)
        printf("-- %s\n", cr.ut_user);

      close (fd);
      return 0;
} 
```

# url-rewriting - 基本的 NGINX url 重写

> ID：10324147
> 
> 赞同：1
> 
> 时间：2012-04-25T21:35:18.147
> 
> 标签：url-rewriting, nginx, rewrite

我有一个带有一些 get 参数的域。让我们说 3，所以我们有这个：www.domain.com/?a1=x&a2=y&a3=z 我想把它改写成这个：www.domain.com/x/y/z/

这是我到目前为止所拥有的

```
rewrite ^/(.*)\/(.*)\/(.*)/$ /index.php?a1=$1&a2=$2&a3=$3? last; 
```

当所有参数都填满时，这几乎可以完成工作。但是！当您留下 1 个参数时，您会得到 404。

那么有哪位 NGINX 专家可以帮我重写 url？我还需要排除 .js 和 .css 文件，并且由于某种原因也不能这样做。

亲切的问候，WouterDS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:35:26.693

如果您的 xyz 变量是字母数字，您可以执行以下操作：

```
rewrite ^/([a-zA-Z0-9]*)/?([a-zA-Z0-9]*)/?([a-zA-Z0-9]*)/?$ /index.php?a1=$1&a2=$2&a3=$3? last; 
```

# c# - SSIS - 如何从文件路径位于另一个文本文件中的文本文件中加载数据？

> ID：10324149
> 
> 赞同：2
> 
> 时间：2012-04-25T21:35:28.200
> 
> 标签：c#, ssis

我有一个文本文件，其中包含要加载到数据库中的文件列表。

该列表包含两列：

```
FilePath,Type
c:\f1.txt,A
c:\f2.txt,B
c:\f3.txt,B 
```

我想将此文件作为 SSIS 的源提供。然后我希望它一行一行地通过它。对于每一行，我希望它读取 FilePath 列中的文件并检查类型。

如果类型是 A，那么我希望它忽略位于当前行的 FilePath 列的文件的前 4 行，然后将该文件内的其余数据加载到表中。如果类型是 B，那么我希望它打开文件并将文件的第一列复制到表 1 中，将第二列复制到表 2 中的所有行。

如果有人能提供我需要遵循的步骤的高级列表，我将不胜感激。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T02:59:54.587

这是在 SSIS 中执行此操作的一种方法。以下步骤是关于*SSIS 2008 R2*的。

*   创建一个 SSIS 包并创建三个包变量`FileName`，即`FilesToRead`和`Type`。FilesToRead 变量将保存文件列表及其类型信息。我们将有一个循环遍历这些记录中的每一个，并在每次循环时将信息存储在*FileName*和*Type*变量中。

![变量](../Images/85ea023e494f46f357c07388862cabe5.png)

*   在控制流选项卡上，放置一个数据流任务，后跟一个 ForEach 循环容器。数据流任务将读取包含必须处理的文件列表的文件。然后循环将遍历每个文件。您的控制流选项卡最终看起来像这样。目前，由于没有配置任何内容，因此会出现错误。我们很快就会谈到这一点。

![控制流](../Images/738156df23e24f0b0d862a4d516bd1d8.png)

*   在连接管理器部分，您需要四个连接。
*   首先，您需要一个 OLE DB 连接来连接到数据库。将此命名为**`SQLServer`**。
*   其次，一个平面文件连接管理器读取包含文件和类型列表的文件。此平面文件连接管理器将包含配置的两列`FileName`，并将其`Type`命名为**`Files`**.
*   第三，另一个平面文件连接管理器，用于读取 A 类型的所有文件。将其命名为**`Type_A`**. 在此平面文件连接管理器中，在文本框中输入值 4，`Header rows to skip`以便始终跳过前四行。
*   第四，另外一个平面文件连接管理器来读取所有类型 B 的文件。将其命名为**`Type_B`**.

![连接](../Images/d69ad2b1e4cf93ec9cf9d9b053403a7a.png)

*   让我们回到控制流。双击第一个数据流任务。在数据流任务中，放置一个平面文件源，该文件源将使用连接管理器读取所有文件**`Files`**，然后放置一个`Recordset Destination`. 在记录集目标中配置变量`FilesToRead`。您的第一个数据流任务如下所示。

![数据流任务](../Images/92a059cf78d90694e512a99c0585f33a.png)

*   现在，让我们再次回到控制流选项卡。如下所示配置 ForEach 循环。此循环将遍历存储在变量中的记录集`FilesToRead`。因为，记录集包含两列，每次循环遍历一条记录时，变量`FileName`和`Type`将被分配当前记录的值。

![对于每个集合](../Images/089f3613638ad9ec6f8230d363c0a014.png)

![对于每个变量](../Images/9a7ee270c4d53bf98f2ea003b9792b42.png)

*   在 for each 循环容器内部，有两个数据流任务，即`Type A files`和`Type B files`。您可以根据需要配置这些数据流任务中的每一个，以从连接管理器中读取文件。但是，我们需要根据正在读取的文件禁用任务。，
*   `Type A files`只有在处理 A 类文件时才应启用数据流任务。
*   同样，`Type B files`只有在处理 B 类文件时才应启用数据流任务。
*   为此，请单击`Type A files`数据流任务并按 F4 以显示属性。单击属性上可用的*省略号按钮。*`Expression`
*   在 Property Expressions Editor 上，选择`Disable`Property 并输入表达式`!(@[User::Type] == "A")`

![表达式 A](../Images/5dde18f3089a15a6c9c712af272c6717.png)

*   同样，点击`Type B files`数据流任务，按F4调出属性。单击属性上可用的*省略号按钮。*`Expression`
*   在 Property Expressions Editor 上，选择`Disable`Property 并输入表达式`!(@[User::Type] == "B")`

![表达式 B](../Images/bfe44a43895d7e8e229423744bfc566c.png)

*   这是一个示例 Files.txt，仅包含列表中的 A 类型文件。当执行包读取这个文件时，你会注意到只有`Type A files`数据流任务。

![样本文件](../Images/3fcaebec02a67018420315613dfe015e.png)

![样本执行](../Images/b30e605289808f21c5e6dc107b0764eb.png)

*   这是另一个示例 Files.txt，其中仅包含列表中的 B 类型文件。当执行包读取这个文件时，你会注意到只有`Type B files`数据流任务。

![样本文件 b](../Images/96880ee4212bb78059bad7d09d1902cf.png)

![样本执行 b](../Images/02f19d707fd816d7cd36f9887b955334.png)

*   如果 Files.txt 同时包含 A 和 B 类型文件，则循环将根据正在处理的文件类型执行适当的数据流任务。

# 配置数据流任务类型 A 文件

*   假设您的 A 类型平面文件具有如下所示的三列布局，并带有逗号分隔值。此处的文件数据使用带有所有特殊字符的 Notepad++ 显示。`CR LF`表示行以回车和换行结束。此文件存储在路径 C:\f1.txt

![输入文件](../Images/b18e5f9063612cb7b2669fb6a2bdbb5a.png)

*   我们需要数据库中的一个表来导入数据。让我们创建一个`dbo.Table_A`在 SQL Server 数据库中命名的表，如下所示。

![桌子](../Images/f705c9aedd4dbaaffea68df9a72cb356.png)

*   现在，转到 SSIS 包。*以下是配置名为Type_A*的平面文件连接管理器的详细信息。为连接管理器命名。您需要在标题行中指定值 4 以跳过文本框。您的平面文件连接管理器应如下所示。

![平面文件一般](../Images/f0d87fa1fc2ee659e20873d5a119a490.png)

![平面文件列](../Images/f197bb1d7a4bc82e2f8b84871239144d.png)

*   在“高级”选项卡上，您可以根据需要重命名列名。

![高级平面文件](../Images/d19ad134570d9d15816137778965c283.png)

*   现在连接管理器已经配置好了，我们需要配置数据流任务`Type A files`来处理相应的文件。双击数据流任务`Type A files`。在任务中放置一个平面文件源和 OLE DB 目标。

![数据流任务](../Images/5ec0eee8c7fe8682a192956e7460a93a.png)

*   平面文件源必须配置为从平面文件连接管理器读取文件。

![平面文件源连接](../Images/e2853a66a8005f0e38956287062fe364.png)

![平面文件源列](../Images/c799cd71eeb2770995d1895c56e62da7.png)

*   数据流任务没有做任何特别的事情。它只是读取类型 A 的平面文件并将数据插入到表 dbo.Table_A 中。现在，我们需要配置 OLE DB 目标以将数据插入数据库。平面文件连接管理器中配置的列名与表不同。因此，它们必须手动映射。

![ole db 目标连接](../Images/0328f447c4b3d42f111cee73149b4c41.png)

![ole db 目标列](../Images/9b0e4b1f8e02bda451112b47f43ac391.png)

*   现在，数据流任务已配置完毕。我们必须确保从 Files.txt 读取的文件路径正确传递。为此，请单击 Type_A 平面文件连接管理器并按 F4 以显示属性。将`DelayValidation`属性设置为`True`。单击属性上的`Ellipsis`按钮。`Expressions`

![特性](../Images/bdd3194215c73d8628e2a17b4a887ec9.png)

*   在“属性表达式”构建器中，选择`ConnectionString`属性并将其设置为“表达式”`@[User::FileName]`

![表达](../Images/b333d4337d1bbacf9cf8ef7ac11c4d19.png)

*   这是一个仅包含 A 类文件的示例 Files.txt 文件。

![文件](../Images/355243907388a79844623260c9dc659f.png)

*   以下是样本类型 A 文件 f01.txt 和 f02.txt

![f01](../Images/3e51cb19689caafebbb682a0082938a1.png)

![f02](../Images/09b39de595ea2ae96f82a8fdbec48ab9.png)

*   打包执行后，会在表Table_A中找到以下数据

![表数据](../Images/b3cc2bf993cfb02885598483519cc22e.png)

*   对于 B 类文件，必须遵循上述配置步骤。但是，由于文件处理逻辑不同，数据流任务看起来会略有不同。数据流任务类型 B 文件是这样的。由于您必须将 B 类文件中的两列插入到不同的表中。您必须使用多播转换来创建输入数据的克隆。您可以使用每个多播输出传递到不同的转换或目标。

![数据流任务类型 b](../Images/0b01fae49cfa2b086fa887202c8f913b.png)

希望这可以帮助您完成任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T01:15:04.360

我建议您为要执行的每种不同类型的文件加载创建一个 SSIS 包。您可以从另一个程序执行这些包，请参见此处：[如何从 .NET 执行 SSIS 包？](https://stackoverflow.com/questions/273751/how-to-execute-an-ssis-package-from-net)

有了这些信息，您可以编写一个快速程序来执行相关包：

```
var jobs = File.ReadLines("C:\\temp\\order.txt")
               .Skip(1)
               .Select(line => line.Split(','))
               .Select(tokens => new { File = tokens[0], Category = tokens[1] });

foreach (var job in jobs)
{
    // execute the relevant package for job.Category using job.File
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T02:28:22.293

我的解决方案看起来像 N + 1 个平面文件连接管理器来处理源文件。CM A 将解决跳过前 4 行文件格式，B 听起来它只是一个 2 列文件，等等。最后一个 CM 将用于解析您说明的命令文件。

现在您已经定义了所有这些连接管理器，您可以开始处理逻辑了。

创建 3 个变量。2 类型的字符串（CurrentPath，CurrentType）。1 是 Object 类型，我称之为 Recordset。

![在此处输入图像描述](../Images/ecc654956be938c975cd8e83b71e4d75.png)

第一个数据流使用“CM Control”从平面文件源中读取所有行。这是您在示例中提供的数据。

然后，我们将使用该 Recordset 对象作为 ForEach 循环容器的源，通常称为粉碎。Bingle 术语“Shred 记录集 ssis”，您一定会看到许多描述如何做到这一点的文章。最终结果是，对于该源 CM 控制文件中的每一行，您将这些值分配给 CurrentPath、CurrentType 变量。

在该循环容器内，创建一个控制中心点，以便控制向外辐射。我发现一个脚本任务非常适合这个。将它拖到画布上，给它一个强名称以表明它不用于任何事情，然后创建一个数据流来处理每个处理排列。

魔术来自使用表达式。在 SSIS 中的所有东西附近都可以在其属性上设置表达式，这就是专业人士与装腔作势者的区别。在这里，我们将双击连接到给定数据流的线并将约束类型从“约束”更改为“表达式和约束”然后您将使用的表达式类似于`@[User::CurrentType] == "A"`这将确保仅当两个父任务成功且条件为真。

第二个表达式魔法将应用于连接管理器本身。他们需要让他们的 ConnectionString 属性由属性值驱动`@[User::CurrentFile]`。这将允许控制文件中的设计时值`C:\filea.txt`但允许运行时值是`\\network\share\ClientFileA.txt`除非所有文件具有相同的结构，否则您很可能需要在属性中将 DelayValidation 设置为 True。否则，SSIS 将失败 PreValidation，因为所有“CM A”到“CM N”都将使用该 CurrentFile 变量，该变量可能是也可能不是该文件布局的有效连接字符串。

# asp.net - ASP.net 数据库绑定注释

> ID：10324150
> 
> 赞同：0
> 
> 时间：2012-04-25T21:35:34.723
> 
> 标签：asp.net, ajax, comments

我有包含详细信息视图的网页。我想添加评论框，用户可以在其中查看/添加/编辑/保存评论。保存后，评论将存储到数据库中，并显示记录（storyID）。我有一个包含 StoryID 和 Comments 列的表格，我想在其中存储评论。

详细信息视图显示基于会话变量 (storyid) 的文章

有没有我可以使用的代码示例？花了一个小时，但不是运气。

提前谢谢了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:01:34.703

我做过类似的事情，这里有一些想法可以考虑。

1.  使用您当前的 2 列获得更好的数据库布局，它将如何正确排序线程？

    专栏创意（CommentId、StoryId、Comment、CreatedOn、CreatedBy）

2.  在您的 DetailsView 中，您需要将现有评论绑定到故事的底部，对吗？这是一个使用中继器的示例。

    ```
     <div class="Comment">
                <ul class="Comment-Items">
                    <asp:Repeater ID="Item" EnableViewState="True" runat="server">
                        <ItemTemplate>
                            <li class="CommentBy">
                                <%# Eval("CreatedBy") %> - <%# Eval("CreatedOn") %></li>
                            <li class="CommentText">
                                <%# Eval("Comment") %></li>
                        </ItemTemplate>
                    </asp:Repeater>
                </ul>
        </div> 
    ```

3.  添加评论，一些想法......

    一个。通过 Ajax 添加新评论并将新评论插入 DOM

    湾。通过 Ajax 添加新评论并返回所有评论以重新绑定到 DOM

    C。使用 POSTBACK 添加新评论并刷新页面

# jquery - JQuery mobile：单击外部时关闭可折叠div（或任何div）

> ID：10324152
> 
> 赞同：0
> 
> 时间：2012-04-25T21:35:37.437
> 
> 标签：jquery, jquery-mobile

我有一个包含多个可折叠部分的页面，如下所示：

### *   角色*   印普雷萨*   消息

当我在页面外部单击时，我希望页面上的所有可折叠 div（包括这个）都折叠起来。我在stackoverflow上尝试了许多通用解决方案，但每个都有一些不好的副作用......知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:42:29.183

```
//when a user clicks anywhere (unless the event is stopped from propagating) this will fire
$(document).delegate('.ui-page', 'click', function () {

    //if we trigger `collapse` on the collapsible widget, it will close
    $(this).find('.ui-collapsible').trigger('collapse');
}); 
```

这将处理单击页面时关闭页面上的所有可折叠小部件。然后，您可能希望停止可折叠小部件的事件冒泡，因此当您打开小部件时它也不会关闭：

```
//anytime a user clicks on a collapsible widget
$(document).delegate('.ui-collapsible', 'click', function (event) {

    //we stop the event from bubbling so it doesn't reach the `.ui-page` element and close the collapsible again
    event.stopPropagation();
}); 
```

这是一个演示：http: [//jsfiddle.net/Hgzpn/](http://jsfiddle.net/Hgzpn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T15:54:38.537

很棒的小费。

我做了一些改变。

```
 //when a user clicks anywhere (unless the event is stopped from propagating) this will fire
        $(document).delegate('.ui-page', 'click', function () {

            //if we trigger `collapse` on the collapsible widget, it will close
            $(this).find('.ui-collapsible').trigger('collapse');
        });

        //When clicking on a collapsible, close the remainig collapsibles
        $('.ui-collapsible').bind('expand', function (dropdown) {

            $(document).find('.ui-collapsible').each( function (number, element) {

                if (dropdown.currentTarget != element)
                {
                    $(this).trigger('collapse');
                }

            });
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:42:01.240

触发单击时，您可以检查鼠标位置是否在每个可协作部分内。

就像是：

```
if (section.X <= mouseX && mouseX <= section.x + section.width && section.y <= mouseY && mouseY <= section.y + section.height) //mouse is inside => don't collapse
else // mouse is outside => collapse 
```

上面的代码不是javascript，但我相信你理解这个想法。

# matlab - 如何在 Matlab 中为边缘检测和角点检测提供感兴趣区域（ROI）？

> ID：10324153
> 
> 赞同：7
> 
> 时间：2011-11-29T22:09:36.630
> 
> 标签：matlab, image-processing, computer-vision, video-processing, matlab-cvst

我有一个电影文件，我有兴趣在其中记录一个点的运动；要具体的圆形特征的中心。我正在尝试使用 Matlab 中的边缘检测和角点检测技术来执行此操作。

要执行此操作，我如何在视频中指定感兴趣的区域？子情节是个好主意吗？

我试图使用如下二进制掩码执行此操作，

```
hVideoSrc = vision.VideoFileReader('video.avi','ImageColorSpace', 'Intensity');
hEdge = vision.EdgeDetector('Method', 'Prewitt','ThresholdSource', 'Property','Threshold', 15/256, 'EdgeThinning', true);
hAB = vision.AlphaBlender('Operation', 'Highlight selected pixels');
WindowSize = [190 150];
hVideoOrig = vision.VideoPlayer('Name', 'Original');
hVideoOrig.Position = [10 hVideoOrig.Position(2) WindowSize];

hVideoEdges = vision.VideoPlayer('Name', 'Edges');
hVideoEdges.Position = [210 hVideoOrig.Position(2) WindowSize];

hVideoOverlay = vision.VideoPlayer('Name', 'Overlay');
hVideoOverlay.Position = [410 hVideoOrig.Position(2) WindowSize];

c = [123 123 170 170]; 
r = [160 210 210 160];
m = 480;  % height of pout image
n = 720;  % width of pout image
BW = ~poly2mask(c,r,m,n);

while ~isDone(hVideoSrc)
    dummy_frame = step(hVideoSrc) > 0.5;                % Read input video
    frame = dummy_frame-BW;
    edges = step(hEdge, frame);
    composite = step(hAB, frame, edges);        % AlphaBlender

    step(hVideoOrig, frame);                    % Display original
    step(hVideoEdges, edges);                   % Display edges
    step(hVideoOverlay, composite);             % Display edges overlayed
end
release(hVideoSrc); 
```

但事实证明，应用于帧的蒙版仅适用于原始视频。边缘检测算法检测被二进制掩码掩蔽的边缘。如何永久屏蔽其他特征并执行边缘检测？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-11-30T11:37:11.113

你是这个意思吗？

```
BW = poly2mask(c,r,m,n);
frame = dummy_frame .* BW; 
```

# php - PHP Preg_replace youtube 链接到嵌入链接

> ID：10324156
> 
> 赞同：0
> 
> 时间：2012-04-25T21:35:43.633
> 
> 标签：php

好的，每个人，我已经找到了多种方法，我什至让它工作，但我的问题是，我理解的 preg_replace 应该替换与模式匹配的所有内容，但它似乎只运行一次。

这就是我需要的，我有一个网站正在运行一项功能，让用户可以在他们的个人资料上发布他们想要的任何内容，我们想让他们也发布 youtube 链接并将这些链接变成嵌入。当他们发布超过一个视频时会出现问题，它只会嵌入其中一个视频，更糟糕的是它会删除文本。

```
$test = "This is a great lecture: http://www.youtube.com/watch?v=Ps8jOj7diA0 This is another great lecture http://www.youtube.com/watch?v=k6U-i4gXkLM What are your opinions on the two?"
$patterns[] = '|http://www\.youtube\.com/watch\?.*\bv=([^ ]+)|';
$replacements[] = ' <br /><iframe width="420" height="315" src=http://www.youtube.com/embed/$1 frameborder="0" allowfullscreen></iframe><br />';
$patterns[] = '|&feature=related|';
$replacements[] = '';
$test = preg_replace($patterns, $replacements, $test);
echo $test;
Output:
"This is a great lecture: 
<iframe width="420" height="315" src=http://www.youtube.com/embed/k6U-i4gXkLM frameborder="0" allowfullscreen></iframe>
What are your opinions on the two?" 
```

所以你看......它会删除第一个和第二个视频之间的所有内容，并且只嵌入第二个视频。我需要一个解决方案，让我删除 youtube 链接产生的额外内容，并保留用户发布的所有消息文本。有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:46:17.130

让它不贪心。

```
http://www\.youtube\.com/watch\?.*?\bv=([^ ]+) 
```

`?`请注意这里`?.*?`的额外内容`http://www\.youtube\.com/watch\?.*\bv=([^ ]+)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-04T13:08:01.947

Jack 的代码有两个问题： - 它没有正确捕获行尾的链接（\n 字符） - 它没有删除可选的附加参数（例如。&list=...）

这是完整的代码：

```
$test = "This is a great lecture: http://www.youtube.com/watch?v=Ps8jOj7diA0&list=PL33AFE53E080251DF This is another great lecture http://www.youtube.com/watch?v=k6U-i4gXkLM What are your opinions on the two?"
$patterns = array('|http://www\.youtube\.com/watch\?.*?\bv=([^&]+).+?\s|i');
$replacements = array(' <br /><iframe width="400" height="300" src="http://www.youtube.com/embed/$1" frameborder="0" allowfullscreen></iframe><br />');
$test= preg_replace($patterns, $replacements, $test); 
```

# unix - 在 bc 中除法时如何获得十进制数？

> ID：10324157
> 
> 赞同：30
> 
> 时间：2012-04-25T21:35:54.653
> 
> 标签：unix, bc

我需要 'bc' 来划分一个数字，不仅给我发言权，还给我余数。例如，如果我做 '5/2'，'bc' 会给我 '2'。我真的想要像'2.5'这样的东西

也许这甚至不可能？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-04-25T21:37:03.193

```
scale = 20 
```

它设置小数位数。

```
$ bc
bc 1.06
Copyright 1991-1994, 1997, 1998, 2000 Free Software Foundation, Inc.
This is free software with ABSOLUTELY NO WARRANTY.
For details type `warranty'. 
355/113
3
scale=20
355/113
3.14159292035398230088
quit
$ 
```

# html - 对 YouTube iframe 使用无缝和/或沙盒属性有什么意义吗？

> ID：10324159
> 
> 赞同：9
> 
> 时间：2012-04-25T21:35:56.607
> 
> 标签：html, iframe, accessibility, usability

更新：这个问题不再有效。请参阅下面的评论。

1.  现在，YouTube 嵌入是使用 iframe 完成的。
2.  HTML5 引入了[无缝](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-iframe-element.html#attr-iframe-seamless)属性，这不仅会影响呈现，而且会使与主机页面的集成更加紧密。（不应**将**其作为单独的文档向屏幕阅读器公布。）
3.  HTML5 引入了[沙盒](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-iframe-element.html#attr-iframe-sandbox)属性，它限制了 iframe，从而提高了安全性。

在浏览器完全支持这两个属性的世界中，当嵌入 YouTube 视频时，它们会受益还是会以任何方式对页面产生不利影响？（是的，问题的后半部分主要是关于*无缝*的。）

我正在考虑建议我的学生始终将这 2 个属性用于 YouTube 视频，并在浏览器支持可用时自动受益。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-21T06:22:05.870

我将重点讨论`sandbox`属性。

要在沙盒中播放 YouTube 视频，您需要执行以下操作：

1.  添加`sandbox="allow-scripts allow-same-origin"`
2.  添加`?html5=1`到视频网址

#1 的一个问题是 Flash 不会被加载；是否需要 Flash 取决于一些因素，例如最终用户的浏览器、他们的 YouTube 设置，或者当视频根本无法作为 HTML5 视频使用时（第 2 点会使情况变得更糟）。

#1 的另一个（更严重的）问题是结合`allow-scripts`并`allow-same-origin`有效地消除了您本来可以享受的任何安全优势。

**结论**

忘记使用`sandbox`YouTube 视频嵌入的属性。

**进一步阅读**

*   [HTML5 沙盒和一些注意事项](http://www.novogeek.com/post/HTML5-Sandbox-and-some-notes.aspx)
*   [在沙盒 iframe 中播放嵌入的 youtube 视频时出错](http://productforums.google.com/forum/#!topic/youtube/AY5QGdPhXlE)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T01:43:17.640

不，全屏似乎无法同时启用这两个属性，如果您处于[HTML5 测试版](http://www.youtube.com/html5)，请在此处查看示例：http: [//bcmoney-mobiletv.com/view/2133/monty-python-tax-sketch/](http://bcmoney-mobiletv.com/view/2133/monty-python-tax-sketch/)

但是，当我离开 HTML5 beta 程序时，它会在标准的 YouTube Flash 播放器中播放，它完全忽略了那些 iFrame 属性。

所以，这真的取决于你的目标是什么。如果您想要增加安全性和感觉更像是由您的页面控制的页内网络视频的体验，请继续使用这些属性，但是，如果您想为用户提供全方位的控制和选项，请离开关闭*沙盒*和/或*无缝*。

# php - 打印到打印机错误处理

> ID：10324163
> 
> 赞同：1
> 
> 时间：2012-04-25T21:36:14.410
> 
> 标签：php, printing, error-handling, event-handling

我必须实现一个**打印（到打印机）程序，该程序能够**：

*   查找要从特定文件夹打印的文件（PDF、DOC、DOCX、XLS、XLSX、文本）；
*   根据文件创建时间打印找到的文件；
*   **处理打印错误**（登录到数据库并通过电子邮件发送给负责人）；

最好的是 PHP 脚本，但如果不可能的话，我可以用其他任何东西（C#、C++ 等）开发，只要它可以在 MS Windows 7 Pro 上运行。

至于 PHP，查找文件并启动打印作业不是问题（通过 COM 对象调用 MS Word 完成），但**我不知道如何从打印机获得响应（确认或错误代码）**。

我已经对如何使用其他语言（尤其是 .NET）进行了一些研究，但找不到有关错误处理的任何信息。

至于现在，我能想象的解决方案是：

*   从 COM 对象启动打印作业，然后从 Windows 事件管理器中读取时间事件以检查错误；
*   首先将文档转换为 PostScript/PCL，然后通过后台处理程序直接启动打印作业；

您是否看到任何其他满足需求的解决方案？我真的很感激任何关于如何开发这样一个程序的建议。

在此先感谢您的帮助，

# ruby-on-rails - 通过Rails 3中的唯一列值选择所有列

> ID：10324165
> 
> 赞同：4
> 
> 时间：2012-04-25T21:36:20.857
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord

在 Rails 3 中，如何根据唯一列值选择行，我需要获取所有列，例如：

```
SELECT COUNT(DISTINCT date) FROM records 
```

这仅返回日期列，但我想要所有列（名称、日期、年龄、created_at）列而不仅仅是日期。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-30T16:48:25.727

这里的问题是，根据定义，可能有多个记录具有相同的日期。它需要用户空间中的逻辑来确定要使用具有唯一日期的多个记录中的哪一个。这是一些获取这些行的代码：

```
Record.select("distinct date").each do |record|
    records = Record.find_by_date record.date
    puts records.count # do something with the records
end 
```

如果您真正追求的是多列之间的唯一性，请列出不同查询中的所有相关列：

```
Record.select("distinct date, name, age, created_at").each do |record|
    puts record.date
    puts record.name
    puts record.age
    puts record.created_at
    # ``record'' still represents multiple possible records
end 
```

您使用 distinct 的事实意味着返回的每个“行”实际上代表*n*行，因此数据库不知道从*n*行中的哪一行中提取剩余的列。这就是为什么它只返回不同的列。它不能做其他...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T06:27:13.863

我想这会对你有所帮助

```
Model.find(:all, :select => 'DISTINCT name, date, age, created_at') 
```

请使用它并告诉我。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-08T23:56:26.380

```
Model.group(:column) 
```

对于您的情况：

```
Record.group(:date) 
```

这将返回没有“日期”重复的所有列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-17T07:10:24.890

对于 rails 3.2 及更高版本，`Model.select('DISTINCT name, date, age, created_at')`

# mysql - 使用子句编写使用另一个表的属性更新表的查询

> ID：10324168
> 
> 赞同：0
> 
> 时间：2012-04-25T21:36:54.693
> 
> 标签：mysql

我想做这样的事情：

```
CREATE TRIGGER addwinner AFTER INSERT ON bids
FOR EACH ROW BEGIN 
IF exists(select * from wins as LT where LT.item_index=NEW.item_index) THEN

SELECT item_index, MIN( bid_amount ) 
FROM update_winnerslist AS a1
WHERE a1.item_index =  NEW.item_index;
UPDATE wins SET email_id=NEW.emai_id, bid_amount=a1.bid_amount where wins.item_index=a1.item_index;

END IF;
END; 
```

基本上我想要的是通过比较某些属性来使用另一个表的元组更新一个表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:54:27.617

如[手册中所述](http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html)，在定义过程/触发器/等时。在它们的主体中使用`;`来分隔命令，您需要定义一个备用分隔符，以便将`CREATE`命令解释为单个语句。

要`UPDATE`使用 的结果`SELECT`，就像您描述的那样，您可以执行以下任何操作：

1.  将 的结果保存`SELECT`在一个变量中，然后在`UPDATE`:

    ```
    DELIMITER ;; -- or anything else you like

    CREATE TRIGGER addwinner AFTER INSERT ON bids FOR EACH ROW
      IF EXISTS (SELECT * FROM wins AS LT WHERE LT.item_index=NEW.item_index)
      THEN
        SELECT MIN(bid_amount) INTO @bid_amount
        FROM   update_winnerslist AS a1
        WHERE  a1.item_index = NEW.item_index;

        UPDATE wins
        SET    email_id=NEW.emai_id, bid_amount=@bid_amount
        WHERE  wins.item_index=a1.item_index;
      END IF;;  -- whatever command delimiter you chose above goes here

    DELIMITER ; -- reset to normal 
    ```

2.  只需使用子查询（只要它不引用您正在更新的表）：

    ```
    DELIMITER ;; -- or anything else you like

    CREATE TRIGGER addwinner AFTER INSERT ON bids FOR EACH ROW
      IF EXISTS (SELECT * FROM wins AS LT WHERE LT.item_index=NEW.item_index)
      THEN
        UPDATE wins
        SET    wins.email_id=NEW.emai_id, wins.bid_amount=(
          SELECT MIN(bid_amount)
          FROM update_winnerslist AS a1
          WHERE a1.item_index = NEW.item_index
        )
        WHERE  item_index = NEW.item_index
      END IF;;  -- whatever command delimiter you chose above goes here

    DELIMITER ; -- reset to normal 
    ```

3.  或者只是加入表格：

    ```
    DELIMITER ;; -- or anything else you like

    CREATE TRIGGER addwinner AFTER INSERT ON bids FOR EACH ROW
      IF EXISTS (SELECT * FROM wins AS LT WHERE LT.item_index=NEW.item_index)
      THEN
        UPDATE wins JOIN update_winnerslist AS a1 USING (item_index)
        SET    wins.email_id=NEW.emai_id, wins.bid_amount=MIN(a1.bid_amount);
        WHERE  item_index = NEW.item_index
      END IF;;  -- whatever command delimiter you chose above goes here

    DELIMITER ; -- reset to normal 
    ```

# php - 收音机只传递第一个值

> ID：10324170
> 
> 赞同：1
> 
> 时间：2012-04-25T21:37:07.550
> 
> 标签：php, jquery, mysql

> **可能重复：**
> [如何获取通过 jQuery 选择的收音机？](https://stackoverflow.com/questions/596351/how-can-i-get-which-radio-is-selected-via-jquery)

我试图在我的网站上放置一个用户评级系统，但只有第一个值被传递，所以在表中评级列始终是一个。自从我使用收音机以来已经有一段时间了。

这就是我所拥有的。

```
 <form id="add-rateing">
<input type="radio" name="MOVIE_RATING" value="1" > 1
<input type="radio" name="MOVIE_RATING" value="2" > 2
<input type="radio" name="MOVIE_RATING" value="3" checked="yes"> 3
<input type="radio" name="MOVIE_RATING" value="4" > 4 
<input type="radio" name="MOVIE_RATING" value="5" > 5 <br>
<input type="hidden" name="MOVIE_ID" value="<?php echo $id; ?>">
<input type="hidden" name="MOVIE_TITLE" value="<?php echo $title; ?>">
<input type="hidden" name="USER_ID" value="<?php echo $loggedinusername; ?>">
<input type="submit" value="I Drank To The Credits" onclick="$('#add-rateing').hide('fast')">
</form>
<script type="text/javascript">
$("#add-rateing").submit(function(event){
event.preventDefault()

addrateing();

 });

function addrateing()
{
var movie_rating_s   = $("#add-rateing [name='MOVIE_RATING']").val();
var movie_id_s    = $("#add-rateing [name='MOVIE_ID']").val();
var movie_title_s   = $("#add-rateing [name='MOVIE_TITLE']").val();
var user_id_s   = $("#add-rateing [name='USER_ID']").val();
var errors  = '';

$.ajax({
type    : "POST",
url     : "movie_watched.php",
data    : { rating: movie_rating_s,
            movie  : movie_id_s,
        title: movie_title_s,
            user : user_id_s, },

cache   : false, timeout: 10000,

success  : function() {
    alert("You have played <?php echo $title; ?> ");

},
error    : function() {
    alert("there is a problom");
},
complete : function() {
}

});
};
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:40:42.777

尝试改变这个：

```
var movie_rating_s   = $("#add-rateing [name='MOVIE_RATING']").val(); 
```

进入这个：

```
var movie_rating_s   = $("#add-rateing [name='MOVIE_RATING']:checked").val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:40:59.967

您需要选择选定的单选元素，如下所示：

```
$('input[name="MOVIE_RATING"]:checked').val(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:48:22.223

看起来问题出在您的 jQuery 选择器上。它没有指定获取“选中”单选按钮的值。在加载你的 movie_rating_s 变量时试试这个：

var movie_rating_s = $("#add-rateing [name='MOVIE_RATING']:checked").val()

# spring - 对于 Spring 中的只读查询，@Transactional(readOnly=true) 的替代方法是什么？

> ID：10324180
> 
> 赞同：1
> 
> 时间：2012-04-25T21:37:32.353
> 
> 标签：spring, hibernate

我正在将 Spring 与 Hibernate 一起使用。我有一些实际上不需要事务的查询，但我正在使用一个，因为它为我进行会话管理。在不进行我自己的会话管理的情况下执行这些非事务性读取查询的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:02:52.007

我认为 @Transaction(readOnly=true)**是**正确的方法。这不会创建新的/额外的物理事务，因此使用它不应该有任何开销。它将使用已经为请求设置的事务。根据休眠文档：

> ...事实上，每个 SQL 语句，无论是查询还是 DML，都必须在数据库事务中执行。在数据库事务之外不能与数据库通信。（请注意，如果数据库引擎不够聪明，无法优化自己的操作，则可以使用只读事务之类的东西来提高清理时间。）

[https://community.jboss.org/wiki/SessionsAndTransactions#Transactions](https://community.jboss.org/wiki/SessionsAndTransactions#Transactions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T05:11:29.387

没有数据库事务是无法工作的（嗯，有，但是驱动程序支持 NO_TRANSACTION 模式（如 DB2 驱动程序）是一种罕见的情况）。此外，驱动程序和数据库可能不支持只读事务（如 Oracle）。所以即使底层连接设置为只读模式，也不代表它会生效。

在这种情况下，唯一可以确定只读标志的是它将 Hibernate 的刷新模式设置为 MANUAL。这意味着 Hibernate 不会与数据库同步，除非发出对 Session#flush() 的显式调用。因此，事务结束时不会发出脏检查和插入/更新/选择。

有关事务管理的更精确信息，您可以查看`org.springframework.orm.hibernate3.HibernateTransactionManager#doBegin()`方法。

# mysql - MySql 相当于一个 for-each 循环

> ID：10324184
> 
> 赞同：0
> 
> 时间：2012-04-25T21:37:39.617
> 
> 标签：mysql

我是一个完全的 MySql 菜鸟。我有两张桌子，计算机和技术员。计算机具有techID 的外键，它将它与特定的技术员条目相关联，并指示上次为计算机服务的技术员。基本上我想列出最后一位维修*每台*计算机的技术人员。

我想做类似的事情：

```
SELECT techID FROM Computer 
```

我的问题是，对于结果集中的每个 techID，我想从 Technician 表中获取技术人员的姓名并将其返回。基本上我想知道如何查询并获得与以下相同的结果：

```
results = SELECT techID FROM Computer
for-each(r in results){
    SELECT name FROM Technician WHERE techID = r.techID
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:41:00.440

使用连接：

```
SELECT     Computer.id, Technician.name
FROM       Computer
INNER JOIN Technician
ON         Computer.techID = Technician.techID 
```

这应该为您提供具有匹配技术人员的每台计算机的列表。

# java - 尝试运行 java 时出现错误消息

> ID：10324186
> 
> 赞同：6
> 
> 时间：2012-04-25T21:37:54.520
> 
> 标签：java

尝试运行 java 时收到以下错误消息。我输入了 java -version 但出现错误：

```
C:\>java -version
Picked up _JAVA_OPTIONS: -Xrunjvmhook -Xbootclasspath/a:C:\PROGRA~1\HP\QUICKT~1\
bin\JAVA_S~1\classes;C:\PROGRA~1\HP\QUICKT~1\bin\JAVA_S~1\classes\jasmine.jar
Error occurred during initialization of VM
Could not find agent library jvmhook on the library path, with error: Can't find
 dependent libraries 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-11T02:43:35.910

Java 以一种稍微不正常的方式被调用。

我有多个答案，具体取决于您的 Java 版本号以及您是否希望在您的计算机上执行自动化测试。

HP 的 Quick Test Professional（QTP，一种自动化工具）已安装在您的计算机上；这是创建**_JAVA_OPTIONS**（通常也是**IBM_JAVA_OPTIONS**）的程序，它是您在帖子中观察到的：

```
-Xrunjvmhook -Xbootclasspath/a:C:\PROGRA~1\HP\QUICKT~1\
bin\JAVA_S~1\classes;C:\PROGRA~1\HP\QUICKT~1\bin\JAVA_S~1\classes\jasmine.jar 
```

QTP 将这些放在适当的位置，以便它可以识别 Java 对象，从而允许您测试 Java 应用程序。

它还可以使用创建环境 变量**JAVA_TOOL_OPTIONS**

```
-agentlib:jvmhook 
```

这是使用 Java 1.6 所必需的

如果您不需要 QTP 对 Java 应用程序执行测试，那么您可以尝试删除这些环境变量。易于恢复的专业提示，只需修改环境变量名称（例如，将 _JAVA_OPTIONS 重命名为 IGNOREME_JAVA_OPTIONS） *环境变量需要本地管理员权限并重新启动系统才能生效。

如果您使用的是 Java 1.5 或更低版本，那么您可能只需删除**JAVA_TOOL_OPTIONS 即可**。

jasmine.jar 似乎对许多 java 应用程序很麻烦；过去，我在阻止我的应用程序运行方面遇到了相当大的困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:42:13.437

环境变量正在对`_JAVA_OPTIONS`您的 Java 环境进行一些非常严重的修改——显然做错了，因为它没有启动。我不知道是什么设置了该环境变量，但是如果这不是您自己尝试做的事情，如果我是您，我会记下该值以防万一您需要恢复它，然后转到您的 Windows“系统”控制面板并`_JAVA_OPTIONS`完全删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-20T06:20:59.900

我正在使用 Intellij IDE。从项目的本地目录中删除 .idea 文件夹解决了这个问题。

# ruby-on-rails - Twitter Bootstrap css - 保持布局固定

> ID：10324191
> 
> 赞同：0
> 
> 时间：2012-04-25T21:38:18.343
> 
> 标签：ruby-on-rails, css, twitter-bootstrap

当浏览器大小发生变化时，我试图让我的 Twitter Bootstrap 布局不乱七八糟。我基本上想保持最小宽度。

我已经按照引导页面上的说明没有流体容器或流体行，并且我还尝试在正文中添加最小宽度标签，但由于某种原因未能使其正常工作 - 我在想这里必须有一个我想念的简单解决方案。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:40:18.680

这是 Bootstrap 的[响应式功能](http://twitter.github.com/bootstrap/scaffolding.html#responsive)。
如果您不想要它，请不要引用 responsive.less。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:05:07.567

正如 SLaks 所说，布局调整大小在 Bootstrap 的响应式代码中。如果您正在编译 LESS 文件，请不要包含 responsive.less（这反过来又包含 v2.0.3 中的其他响应式较少文件）。顺便说一句，默认情况下*不*包括 responsive.less。

如果您要添加提供的 .css 文件（即，不是从 LESS 编译），只需在您的页面上包含 bootstrap.css/bootstrap.min.css 而不是 bootstrap-responsive.css/bootstrap-responsive.min.css应该管用。

# mysql - 连接子表上多行的更新

> ID：10324194
> 
> 赞同：1
> 
> 时间：2012-04-25T21:38:31.283
> 
> 标签：mysql, multiple-tables

```
parent_table:
ID  | FIELD1 | FIELD2
____|________|________
1   |........|......
2   |........|.....
3   |.............. 

child_table:
ID | FIELD3
___|________
1  |   18
1  |   7
2  |   ..
1  |   ..
3  |   ..
2  |   .. 
```

假设我想更新这些表。这是我需要实现的：

```
 UPDATE parent_table SET 
   FIELD1 = 'XXX', 
   FIELD2 = 'YYY' 
 WHERE ID = 2;

 DELETE FROM child_table 
 WHERE ID = 2;

 INSERT INTO child_table (ID, FIELD3)
   VALUES (2, 50),
   VALUES (2, 17),
   VALUES (2, 9); 
```

请注意，每个 ID 的子表中的条目数在更新期间可能会有所不同。

是否有可能在一次查询中获得相同的结果？我不能使用交易。

也许前两个查询更容易合并。我尝试在 UPDATE 期间加入子表并设置空值，但我不知道如何处理多行.. 是否可以像嵌套 SELECT 一样嵌套 UPDATE？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:57:30.500

您可以在一个命令中更新多个表：

```
UPDATE parent_table p LEFT JOIN child_table c On p.id = c.id
 SET 
   p.FIELD1 = 'XXX', 
   p.FIELD2 = 'YYY',
   c.FIELD3 = ''
 WHERE p.ID = 2; 
```

但是，我不认为您可以在同一命令中执行更新和删除 - 但我必须承认我不确定。

[您可以在此处](http://dev.mysql.com/doc/refman/5.5/en/update.html)阅读有关多个表更新的更多信息

另一种（也是首选）方法是在 parent_table 上创建一个触发器，该触发器将在更新时从 child_table 中删除相关记录。

# sql - 有没有办法在 SQL 中选择父 ID 而无需递归或循环？

> ID：10324196
> 
> 赞同：3
> 
> 时间：2012-04-25T21:38:37.240
> 
> 标签：sql, parent-child

我有一个包含以下列的表：group_id、parent_id、name

在这个表中 parent_id 是另一个记录的 group_id。父母与孩子之间存在一对多的关系。这形成了一个层次结构，其中只有一个顶级组的 parent_id 为 NULL。可以有任意数量的深度，但实际上我的层次结构永远不会超过 20 层。

我想检索具有给定 group_id 的组的每个祖先（父母的父母等）。我担心返回的特定方式。

我正在使用 MS SQL 2005，但我也对使用其他 RDBMS 的解决方案感兴趣。

我发现了一些类似的问题，但它们似乎都分解为递归、循环或嵌套集。我不能使用嵌套集，因为我不能改变数据结构。我想尽可能避免递归或循环，或者至少理解为什么不可能。

以下是我在研究时发现的一些问题：

[如何选择父ID](https://stackoverflow.com/questions/4184114/how-to-select-parent-ids)

[没有递归的sql递归](https://stackoverflow.com/questions/1323245/sql-recursion-without-recursion)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:44:39.860

该操作本质上是循环的。因为每个节点与其根没有任何有限关系，所以您必须遍历才能发现它。

例如，如果您知道最大深度为 N，那么您可以`LEFT OUTER JOIN`在单个语句中创建 N 并显示以这种方式返回的最后一个非空父 ID。

循环要求是您根本不知道 N 是什么，并且您不能要求像 SQL 这样的声明性语言来“弄清楚”

即使您可以使用一些内置方法来完成它，它仍然是一个循环或递归，只是被您混淆了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:47:32.767

如果你确切地知道你的数据结构有多深，你可以手动写出代码：

```
DECLARE
    @parentId1 int
   ,@parentId2 int
   ...
   ,@parentId19 int
   ,@parentId20 int

SELECT
    @parentId1 = parent_id
FROM
    myTable
WHERE
    group_id = <someid>

SELECT
    @parentId2 = parent_id
FROM
    myTable
WHERE
    group_id = @parentId1 
```

等等。然而，这会给你一大堆额外的代码，并且不会比循环更好，而且它非常脆弱。向树中添加新级别需要您修改代码，这应该是即时的代码味道。

用任何其他语言来考虑它。您必须总共执行任务 X N 次，其中 N 是可变的。你打算怎么写这个？你会使用一个循环。现在假设您的数据结构是一棵树（这就是您在这里得到的）。你会怎么写这个？您可能会使用递归，除非您将递归扁平化为循环。

唯一针对 MSSQL 的警告是，默认情况下，递归堆栈的深度限制为 16。在 MSSQL 中使用循环比使用递归要好得多。

我通常会做这样的事情：

```
-- Temp table will hold the results starting from the ID of the source item
-- through all its ancestors in ascending order
DECLARE @table TABLE (
    sequence int IDENTITY(1, 1)
   ,group_id int
)

DECLARE @groupId int

SELECT @groupId = <someid>

-- Loop backwards through the group's hierarchy inserting all parent IDs
-- into the temporary table
WHILE @groupId IS NOT NULL
BEGIN
    INSERT INTO @table (
        group_id
    )

    VALUES (
        @groupId
    )

    -- Get the ID of the group's parent ready to loop again
    SELECT @groupId = parent_id
    FROM mutable
    WHERE group_id = @groupId
END

-- Print the results
SELECT group_id
FROM @table 
```

可能有更好的方法，但这将以一种您可以轻松操作的形式为您提供所有 ID，而且它们的顺序正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T21:56:38.943

您可以创建一个类似于您的临时表并像这样填充它：

```
INSERT INTO #T(group_id, parent_id) SELECT group_id, parent_id FROM Your_Table 
```

现在执行五次完全相同的 SQL：

```
INSERT INTO #T(group_id, parent_id) SELECT T2.group_id, T1.parent_id FROM #T T1 JOIN #T T2 ON T2.parent_id = T1.group_id LEFT JOIN #T C ON T2.group_id = C.group_id AND T1.parent_id = C.parent_id  AND C.group_id IS NULL
INSERT INTO #T(group_id, parent_id) SELECT T2.group_id, T1.parent_id FROM #T T1 JOIN #T T2 ON T2.parent_id = T1.group_id LEFT JOIN #T C ON T2.group_id = C.group_id AND T1.parent_id = C.parent_id  AND C.group_id IS NULL
INSERT INTO #T(group_id, parent_id) SELECT T2.group_id, T1.parent_id FROM #T T1 JOIN #T T2 ON T2.parent_id = T1.group_id LEFT JOIN #T C ON T2.group_id = C.group_id AND T1.parent_id = C.parent_id  AND C.group_id IS NULL
INSERT INTO #T(group_id, parent_id) SELECT T2.group_id, T1.parent_id FROM #T T1 JOIN #T T2 ON T2.parent_id = T1.group_id LEFT JOIN #T C ON T2.group_id = C.group_id AND T1.parent_id = C.parent_id  AND C.group_id IS NULL
INSERT INTO #T(group_id, parent_id) SELECT T2.group_id, T1.parent_id FROM #T T1 JOIN #T T2 ON T2.parent_id = T1.group_id LEFT JOIN #T C ON T2.group_id = C.group_id AND T1.parent_id = C.parent_id  AND C.group_id IS NULL 
```

在此之后，您的表现在跟踪祖先而不是父母，最多 32 级距离。（2^5 = 32 和 32 > 20）。

这是计算“传递闭包”的一种有效方法，尽管如果您添加循环而不是仅仅重复相同的`INSERT`五次，您将不再需要您假设大约 20 个级别。`INSERT`当插入零个新行时，您应该停止。这种循环将有助于而不是损害性能，并且迭代次数将非常少。

# java - Groovy，嵌入Java，回调Java

> ID：10324199
> 
> 赞同：4
> 
> 时间：2012-04-25T21:38:51.523
> 
> 标签：java, groovy, classpath

我知道我必须做一些愚蠢的事情才能让它不起作用，但我处于一种我想将行为动态加载到正在运行的服务器中的情况。我选择 groovy 作为我的工具来做到这一点。该行为将需要引用服务器类路径上的类，例如我的模型对象以及 Freemarker 等第三方库。

我把这个愚蠢的 POC 放在一起来展示可行性。尽管我将 GroovyClassPath 的父类路径设置为当前的，但我无法使用 groovy 脚本来解析 Java 类“ThingyDoodle”和“Fooable”。

```
public class GroovyTest
{
    public static void main ( String [ ] argv ) throws Throwable
    {
            // Setting parent classloader!
            // also tried plain old "GroovyTest.class.getClassLoader()" as well
        GroovyClassLoader gcl = new GroovyClassLoader ( Thread.currentThread().getContextClassLoader() ) ;
        String src =
              "class Arf implements Fooable {
                 public String foo ( ) {
                   return new ThingyDoodle().doStuff('Arf');}}" ;
        Class clazz = gcl.parseClass(src, "AppleSauce.groovy");
        Object aScript = clazz.newInstance();
        Fooable myObject = (Fooable) aScript;
        System.out.println ( myObject.foo() ) ;
    }

    public static interface Fooable { public String foo ( ) ; }

    public static class ThingyDoodle
    {
        public String doStuff ( String input )
        {
            return "Hi Worlds" ;
        }
    }
} 
```

我到底做错了什么？

```
Exception in thread "main" org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:
AppleSauce.groovy: 1: unable to resolve class Fooable
 @ line 1, column 1.
   class Arf implements Fooable { public String foo ( ) { return new ThingyDoodle().doStuff('Arf');}}
   ^

AppleSauce.groovy: 1: unable to resolve class ThingyDoodle
 @ line 1, column 63.
   ublic String foo ( ) { return new Thingy
                                     ^ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T10:38:49.127

您的代码中的问题是**找不到 Fooable**接口和**ThingyDoodle**类，因为它们都是内部类，需要使用包含的类名进行限定，即**GroovyTest**。我在嵌入式脚本中限定了两个名称（并修复了脚本周围的引号）并且它按预期运行。

```
import groovy.lang.GroovyClassLoader;

public class GroovyTest
{

    public static void main ( String [ ] argv ) throws Throwable
    {
            // Setting parent classloader!
            // also tried plain old "GroovyTest.class.getClassLoader()" as well
        GroovyClassLoader gcl = new GroovyClassLoader ( Thread.currentThread().getContextClassLoader() ) ;
        String src =
              "class Arf implements GroovyTest.Fooable { " + 
                 "public String foo ( ) { " + 
                   "return new GroovyTest.ThingyDoodle().doStuff('Arf');}}" ;
        Class clazz = gcl.parseClass(src, "AppleSauce.groovy");
        Object aScript = clazz.newInstance();
        Fooable myObject = (Fooable) aScript;
        System.out.println ( myObject.foo() ) ;
    }       
     public static interface Fooable { public String foo ( ) ; }

    public static class ThingyDoodle
    {
        public String doStuff ( String input )
        {
            return "Hi Worlds" ;
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T08:07:03.610

不知道你是如何编译它的......我试过这个（使用[Gradle](http://gradle.org/)作为构建工具）并且它工作......

./build.gradle

```
apply plugin:'application'

repositories {
    mavenCentral()
}

dependencies {
    compile group: 'org.codehaus.groovy', name: 'groovy', version: '1.8.6'
}

mainClassName = 'org.timyates.GroovyTest' 
```

./src/main/java/org/timyates/Fooable.java

```
package org.timyates ;

public interface Fooable {
  public String foo() ;
} 
```

./src/main/java/org/timyates/ThingyDoodle.java

```
package org.timyates ;

public class ThingyDoodle {
  public String doStuff( String input ) {
    return String.format( "Hi %s", input ) ;
  }
} 
```

./src/main/java/org/timyates/GroovyTest.java

```
package org.timyates ;

import groovy.lang.GroovyClassLoader ;

public class GroovyTest {
  public static void main( String[] args ) throws Exception {
    GroovyClassLoader gcl = new GroovyClassLoader( GroovyTest.class.getClassLoader() ) ;
    String src = "import org.timyates.*\n" +
                 "class Arf implements Fooable {\n" +
                 "  public String foo() {\n" +
                 "    new ThingyDoodle().doStuff( 'tim' )\n" +
                 "  }\n" +
                 "}" ;
    Class clazz = gcl.parseClass( src, "AppleSauce.groovy" ) ;
    Fooable myObject = (Fooable)clazz.newInstance() ;
    System.out.println( myObject.foo() ) ;
  }
} 
```

然后，当我`gradle run`在命令行输入时，我得到输出：

```
$ gradle run
:compileJava
:processResources UP-TO-DATE
:classes
:run
Hi tim

BUILD SUCCESSFUL 
```

# android - 开启/唤醒屏幕一段时间

> ID：10324200
> 
> 赞同：1
> 
> 时间：2012-04-25T21:38:54.773
> 
> 标签：android, screen, power-management

我试图实现一些东西 -

屏幕关闭（暗）。我希望能够将屏幕唤醒 15 秒（通过事件/广播或其他东西......），之后，如果没有用户干预，屏幕应该再次关闭（黑暗） .

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:56:07.963

您可以使用警报管理器。

您可以使用以下行触发警报：

```
Alarm Manager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);

pendingServiceIntent = PendingIntent.getService(this.getApplicationContext(), 0,
            new Intent(this.getApplicationContext(), DataCollectionService.class), 0);

long intervalInMinutes = 5; // will wake you up every 5 minutes
long triggerAtTime = System.currentTimeMillis() + 1000*60*intervalInMinutes;
alarmManager.set(AlarmManager.ELAPSED_REALTIME_WAKEUP, triggerAtTime, pendingServiceIntent); 
```

就我而言，我正在触发一项服务。您可以扩展 BroadcastReceiver 或任何您想要的。然后，您将使用 WakeLock 点亮屏幕至少 15 秒：

```
powerManager = (PowerManager) getSystemService(POWER_SERVICE);
wL = powerManager.newWakeLock(PowerManager.FULL_WAKE_LOCK, "LocRepTask");
wL.acquire(); // forces processor to stay awake
// do your stuff.....
wl.release();  // processor no longer awake because of you 
```

您将需要`WAKE_LOCK`在 android manifest 中获得许可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:49:06.943

为此，您必须有一个正在运行的 Service 持有[部分唤醒锁](http://developer.android.com/reference/android/os/PowerManager.html#PARTIAL_WAKE_LOCK)。然后，该服务可以在您想要的任何时间间隔向广播接收器发出意图并唤醒屏幕。不过，就像评论者所建议的那样，这意味着 CPU 必须保持开启，即使设备屏幕关闭，这将比待机更快地耗尽电池电量。（这本身并不是不这样做的理由，只是说你必须权衡考虑）

PowerManager API 可以轻松满足您的其他要求 - 希望这足以让您摆脱困境。祝你好运！

# algorithm - 不会导致图形断开的安全顶点删除

> ID：10324201
> 
> 赞同：2
> 
> 时间：2012-04-25T21:39:03.190
> 
> 标签：algorithm, graph, depth-first-search

## 这里有两个关于安全顶点删除的 excises

> 5-28。图 G 的一个关节顶点是一个其删除断开 G 的顶点。设 G 是一个具有 n 个顶点和 m 个边的图。给出一个简单的 O(n + m) 算法来找到 G 的一个不是关节顶点的顶点——即 ，其删除不会断开 G。
> 
> 5-29。继续上一个问题，给出一个 O(n + m) 算法，该算法找到 n 个顶点的删除顺序，使得没有删除会断开图的连接。（提示：想想 DFS/BFS。）

* * *

**对于5-28，这是我的想法：**

我只会做一个dfs，但不完整。**完成处理的第一个顶点**将是一个非关节顶点，因为它必须是一个叶子，或者一个后边缘指向其祖先的叶子（它也不是一个关节顶点）。

**对于 5-29**

我还不确定如何做得很好。我想到的是，在图中，循环中的任何顶点都不能安全地删除。此外，如果没有循环，则从 dfs 树向后删除顶点也是安全的。

谁能给我一些提示或告诉我我的想法是对还是错？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T19:57:12.017

我认为您对 5-28 的解决方案是正确的，它保证在 O(n+m) 时间内找到一个不是关节的节点。

对于 5-29，我认为一种方法是基于您对 5-28 的解决方案。在执行 dfs 时，请注意每个节点何时离开堆栈（处理完成的时间）。如您所说，首先离开的必须是叶节点，因此删除它不会断开图的连接。然后你可以删除第二个离开堆栈的节点，当我们删除第一个节点时，它也必须是一个叶子节点。**因此，我们可以在执行 DFS 时按照从堆栈中弹出节点的相反顺序删除节点。**这样做只需要一次 DFS，因此运行时间是 O(n+m)。

另一种简单的方法是使用 BFS。对于 5.28，删除任何具有最大深度的节点不会使图形断开连接。因为深度较小的节点可以到达其他节点。所以对于 5.29，我们可以按排序深度降序删除所有节点。而且，我们只需要 1 个 BFS，所以运行时间是 O(n+m)。我认为人们更容易理解这种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-18T17:15:34.780

5-29：扩展5-28的想法，当你处理完一个顶点时，它是一个非关节顶点，所以删除它。然后继续 DFS，每次处理完另一个顶点时，也将其删除。由于您删除了先前已完成处理的顶点，因此每次完成顶点处理时，实际上都是您第一次完成顶点处理（对于没有先前删除的顶点的图形）。

另一种方法，更容易证明，但效率稍低（但仍然 O(V + E)） - 从图中创建一个 DFS 树，然后进行拓扑排序，然后从最后一个顶点开始逐个删除排序图并返回第一个图。在每一步都删除最后一个，并且您确定（因为它是拓扑排序图）它不指向任何其他节点，这意味着除了通向它的边之外不会删除任何边。这意味着所有其他节点仍然可以从第一个节点到达，如果图是双向的，那么所有节点也可以到达第一个节点，使其连接。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-25T23:15:26.630

对于第一个问题，我将从图中删除要测试的顶点，然后从任何其他顶点开始运行 DFS/BFS，计算访问顶点的数量。如果它小于`(original size - 1)`，那么测试的顶点是一个关节顶点。

同样的想法适用于第二个问题。您随机选择一个顶点并将其删除，这通常会将图形切割成两个块。如果删除的顶点不是关节顶点，则两个块之一必须为空。否则，两个块都有一些顶点，在这种情况下，两个块中的所有顶点都必须按照最终的“安全删除”顺序列在该顶点的前面，而决定首先完全删除哪个块并不重要. 所以我们可以写一个这样的递归函数：

```
vertex[] safe_order_cut (vertex[] v)
    if (v.length==0) return empty_vertex_list;
    vertex x = randomly_pick(v);
    vertex v1[], v2[];
    cut_graph(v,x,v1,v2);
    return safe_order_cut(v1) + safe_order_cut(v2) + x; 
```

连通性问题（以及相关的割点问题）已在图论中得到广泛研究。如果您有兴趣，可以阅读 wiki 页面了解更多算法。

# c# - 自动更新下载最新的 .exe 文件 - 如何验证它没有被篡改？

> ID：10324211
> 
> 赞同：2
> 
> 时间：2012-04-25T21:39:51.957
> 
> 标签：c#, code-signing

我们有一个小型控制台应用程序（小于 200kb）将分发给客户端，我们希望确保它们运行最新版本（由 WCF 服务验证）。目前它通过 HTTPS 下载新的 .exe 文件并用它替换当前的 .exe 文件。

假设我们的服务器没有受到损害，这没问题。但是，我们也使用代码签名证书对我们的 .exe 文件进行签名。有没有办法验证这一点并在文件不匹配时删除文件？我们需要能够验证和删除文件而无需执行它，以防它是病毒。

我们如何验证我们签名的 .exe 文件？例如，Windows 将显示它是否无效： ![失败的数字签名](../Images/0076b3ba322a8415a40f8c7ba4853baa.png)

编辑：这段代码能完成这项工作吗？

```
X509Certificate basicSigner = X509Certificate.CreateFromSignedFile(file);
X509Certificate2 cert = new X509Certificate2(basicSigner);
if (cert.Subject.Contains("CN=MY COMPANY NAME IN CERTIFICATE"))
    valid = true; 
```

编辑：如果我们也检查`StrongNameSignatureVerificationEx`，如果文件中的一位被更改，它会返回失败。也许这已经足够了？

```
[DllImport("mscoree.dll", CharSet = CharSet.Unicode)]
        static extern bool StrongNameSignatureVerificationEx(string wszFilePath, bool fForceVerification, ref bool pfWasVerified); 
```

编辑：我也实现了这段代码，它在**WinTrust.dll中调用****WinVerifyTrust**来实际验证 Authenticode 签名：[http ://www.pinvoke.net/default.aspx/wintrust.winverifytrust](http://www.pinvoke.net/default.aspx/wintrust.winverifytrust)

 **现在，它检查数字签名是否包含正确的主题、来自有效的受信任根、签名是否有效以及代码是否使用其数字签名进行了强命名。这现在应该够安全了吧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:45:49.697

[这](http://blogs.msdn.com/b/shawnfa/archive/2004/06/07/150378.aspx)是一个很好的演练，包括可用于实现您想要的选项的源代码......

基本上，您需要 pinvoke [StrongNameSignatureVerificationEx](http://msdn.microsoft.com/en-us/library/ms232579%28v=vs.100%29.aspx)，因为没有托管 API 可以满足您的需求。

另一种选择可能是[调用 SignTool](http://msdn.microsoft.com/en-us/library/aa388171%28VS.85%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T23:57:39.377

这是一个非常根本错误的方法。代码签名证书唯一能证明的是签署 EXE 的个人或公司的身份。证书颁发机构仅证明身份有效。你根本没有证明它是*你的*证书，你只是证明了它是*某人的*证书。攻击者可以用他签名的另一个 EXE 轻松替换您的 EXE。

你可能会反对“但我不能只是验证它是我的！”。答案是否定的，如果攻击者可以替换 EXE，那么他也可以轻松替换您的检查代码。在同一台机器上执行验证的安全性为零。

代码证书只有一个目的，它们向用户证明签名者的身份。让他们做任何其他事情是一个安全漏洞。真正糟糕的那种，那种让你*觉得*你的系统是安全的。并让您停止考虑实施*真正的*安全性。**

# twig - 树枝变量错误

> ID：10324215
> 
> 赞同：1
> 
> 时间：2012-04-25T21:40:25.427
> 
> 标签：twig

我在 PHP 中有数组：

```
    大批（
        'name1' => '一个',
        'name2' => '二',
        'name3' => '三'
    )

```

但在树枝中：

```
    {% for i in range(1, 3) %}
        {{'名字' ~ i}}
    {% endfor %}

```

给我吗：

```
    1
    2
    3

```

请帮我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:15:56.000

你可以这样做：

```
 {% for i in range(1, 3) %}
        {{ attribute(_context, 'name' ~ i) }}
  {% endfor %} 
```

具有：

```
one
two
three 
```

# java - Spring Data、Hibernate 4.1.1 和 Spring JTA 事务管理器

> ID：10324216
> 
> 赞同：1
> 
> 时间：2012-04-25T21:40:26.650
> 
> 标签：java, spring, hibernate, jta, spring-data

我正在开发一个 Web 应用程序，并决定使用 spring-data 是一个好主意。公平地说，它使生活变得非常容易，并且 DAO 层非常薄。

我遇到的问题与持久化数据有关。当我使用 JPATransactionManager 时，持久性按预期工作。但我需要使用 JTATransactionManager。当我使用它时，事务看起来不错，但休眠刷新似乎与 tx 提交无关

> 调试 [org.springframework.transaction.jta.JtaTransactionManager] (http--127.0.0.1-8080-2) 使用名称 [com.clubgroups.user.registration.service.impl.UserRegistrationServiceImpl.registerUser] 创建新事务：PROPAGATION_REQUIRED,ISOLATION_DEFAULT ; ''
> 
> DEBUG [org.springframework.transaction.jta.JtaTransactionManager] (http--127.0.0.1-8080-2) 参与现有事务
> 
> DEBUG [org.springframework.transaction.jta.JtaTransactionManager] (http--127.0.0.1-8080-2) 启动事务提交

上面是确认事务正在提交的调试消息。但是数据似乎没有刷新到数据库中。

我像这样初始化事务管理器：

```
@Bean
public JpaTransactionManager transactionManager() {
    JtaTransactionManager transactionManager = new JtaTransactionManager();       

    return transactionManager;
} 
```

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T07:50:51.650

我对你的 JTA 设置有点困惑，因为它非常不寻常。首先，查看有关如何正确设置 JTA 事务[的参考文档。](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/transaction.html#d0e20593)简单地实例化是`JtaTransactionManager`行不通的，因为您需要`UserTransaction`通过某种方式从 JNDI 获取。`afterPropertiesSet()`如果你调用你的方法，你应该会看到一个错误弹出，`@Bean`因为这将揭示缺少的配置。

# iphone - 使用 MDM + Enterprise 许可证自动更新 iOS 应用程序

> ID：10324218
> 
> 赞同：3
> 
> 时间：2012-04-25T21:40:31.340
> 
> 标签：iphone, ios, ipad, enterprise, mdm

我们有一个 iPad 应用程序以 kiosk 模式运行，部署在多个物理位置。我们希望有一个解决方案，将应用程序的任何更新自动推送到设备，这样客户就不必触摸他们拥有的每台 iPad。

我们的客户有一个现有的 MDM 软件，如果有更新，它会通知用户，但由于它的目的是作为一个信息亭，我们不希望公众真正自己进行更新。

有谁知道这是否可能？

谢谢，
泰加。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T21:56:00.017

**编辑：**从 iOS 7 开始，您现在可以通过 MDM 软件强制更新应用程序。

* * *

（以前适用于 iOS 6 及更低版本）：

抱歉，即使使用企业程序和 MDM 服务器，您也无法在 iOS 设备上强制更新。

您最好的选择是配置更新，以便它们只需单击一次并接受更新即可自动运行。这样任何人都可以安全地接受。

资料来源：自有知识和[本站](http://www.esecurityplanet.com/views/article.php/11163_3919161_3/Review-AirWatch-Enterprise-MDM-for-Apple-iOS4.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-03T02:08:24.493

我知道从 iOS 7 开始，情况不再如此。如果您的应用程序是通过 MDM 解决方案管理的，您可以强制更新。

# linux - Linux大数据流捕获窗口

> ID：10324219
> 
> 赞同：0
> 
> 时间：2012-04-25T21:40:32.463
> 
> 标签：linux, stream, window

假设我有大量数据在很长一段时间内（可能是一个小时）流经标准输出，并且我想根据该窗口中间发生的触发器捕获该数据的 30 秒窗口。例如，也许像

```
$ program-that-outputs-lots-of-data | program-that-captures-a-window-of-data 
```

在某些时候，程序将输出包含“A-unique-string”的行，此时我想保存该字符串前后 15 秒的数据，丢弃之前的所有内容。紧接着，我想再次开始监视相同的字符串，并在它进入时捕获另一个窗口并将其保存到一个新文件中。知道如何使用 Linux 工具做这样的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:07:36.300

您尝试将**时间**用作缓冲单位的事实使您的问题非常罕见。在 Unix 命令行下，一切都倾向于围绕**文本行**概念进行设计。

例如，如果您想要捕获 15 行文本（在特殊标记之前和之后）而不是 15*秒的数据，您可以简单地执行以下操作：*

```
$ program-that-outputs-lots-of-data | grep -C 15 A-unique-string 
```

在您的情况下，即使您正在开发自己定制的过滤工具，决定保存和丢弃多少输入也是一个相当复杂的问题。我想说多媒体流是可能有一些现成工具的领域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:08:45.380

我认为不存在任何接近这些目标的东西。除了您的要求相当具体的事实之外，您还要求窗口是基于时间的，而大多数 Unix 样式的文本过滤器是面向行的（例如`grep -C 100`，获取围绕匹配的一百行）。

在 Python 或 Perl 或 Ruby 或类似的脚本语言中执行此操作应该相当简单。

# caching - 确认使用 SDL Tridion 2009 Content Delivery 启用分类缓存

> ID：10324223
> 
> 赞同：10
> 
> 时间：2012-04-25T21:40:47.273
> 
> 标签：caching, taxonomy, tridion2009, tridion

有没有人对确认分类缓存功能的简单但有效的方法有任何建议。我正在开发一个系统，其中 cd_broker_config (Tridion 2009) 已将分类缓存注释掉。

我们现在取消注释并重新启动部署服务，但有什么方法可以 100% 确认缓存正在发生？使用 ORACLE 11.2.0.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T11:04:10.437

[Tridion World](http://www.sdltridionworld.com/articles/sdltridion2011/analyzing_object_cache.aspx)关于分析对象缓存的文章没有帮助吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T02:24:24.510

我认为，如果您发布您的分类，加载一个查询它的页面，然后关闭缓存通道服务 (CCS) 并取消发布您的分类，如果您重新加载它，该页面仍然可以工作。然后在启用 CCS 的情况下执行相同操作，页面应该无法加载分类驱动部分。

# c# - 如何处理datagrid中的空itemsource

> ID：10324224
> 
> 赞同：0
> 
> 时间：2012-04-25T21:40:47.357
> 
> 标签：c#, silverlight, datagrid

我的程序中有一个数据网格，其中数据来自 SQL 存储过程，列名是自动生成的。下面是我对数据网格的 xaml 定义。

当我的页面被加载时，存储过程被执行并且数据被填充到这个带有标题的网格中。

对于结果为空的情况，我想显示标题名称并想向用户显示一条消息。

```
<DataGrid Name="datagrid"
    Margin="12,77,52,156"
    DataContext="{Binding}"
    IsReadOnly="True" 
    Grid.RowSpan="2"
    Grid.ColumnSpan="2" 
    AlternatingRowBackground="#FFF2F2F2"
    AreRowDetailsFrozen="True"
    CanUserResizeRows="False"
    ClipboardCopyMode="IncludeHeader"
    Focusable="False"
    MinRowHeight="1">
</DataGrid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T06:52:52.933

将数据绑定到数据网格后，您可以查看记录数，并在记录数为 0 时显示消息。希望本页中的示例对您有所帮助。

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.aspx)

# java - 正则表达式验证文件名

> ID：10324228
> 
> 赞同：8
> 
> 时间：2012-04-25T21:41:02.843
> 
> 标签：java, regex, file

我需要在这样的方法中验证 a 。

```
 validateFileName(Editable s) {
        String filtered_str = s.toString();
        if (filtered_str.matches(".*[regexp].*")) {
            filtered_str = filtered_str.replaceAll("[regxp]", "");
            s.clear();
            s.append(filtered_str);} 
```

我应该使用哪些正则表达式来排除所有非法字符和空格？我正在使用 linux

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-01-22T18:11:43.533

如果您使用的是 POSIX 兼容的操作系统，则文件名中的合法字符是 az、AZ、0-9、句点、下划线和连字符。因此，匹配“非法”字符的正则表达式将是

`[^-_.A-Za-z0-9]`

附录：这是如果您想要一个完全可移植的文件名。正如我在下面 Josip 的评论中得到纠正的那样，POSIX 本身实际上允许更多字符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T21:44:26.297

如果您的想法只是排除非法字符和空格字符，您可以使用以下内容：

`'^[^*&%\s]+$'`

您可以将任何“非法”字符添加到字符列表中（在这种情况下，它会忽略 *、&、% 和空格） `\s`是空格！`^`内部`[]`是正则表达式语法的一部分，它意味着：不**匹配**内部的任何字符`[]`。

# asp.net-mvc-3 - MVC3 句柄错误

> ID：10324230
> 
> 赞同：0
> 
> 时间：2012-04-25T21:41:12.280
> 
> 标签：asp.net-mvc-3, c#-4.0

在发布此之前，我浏览了所有有类似问题的帖子。

我希望 MVC 在代码中显示我未处理的错误的视图，但是当我调试它时，它会一直停在引发异常的下一行。

1) 应用的根 web.config 有以下内容：

```
<customErrors mode="On"></customErrors> 
```

2）控制器动作方法：

```
[HandleError()]
        public ActionResult ShowErrorHandle()
        {
            int a = 10, b = 0; 
            throw new InvalidOperationException();
            return Content(a.ToString(),"text/plain",Encoding.Default);
        } 
```

我还尝试将上面的默认 HandleError 替换为更具体的内容，但它仍然是同一个问题：

```
[HandleError(ExceptionType=typeof(Exception), View="AnotherIndex")] 
```

除了 1 行之外，我完全删除了 error.cshtml 文件，并确保它正常工作。

洛基。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:59:49.833

据我所知——在调试时，你总是会遇到异常，因为在 VS 中默认情况下会打开异常断点。

您可以尝试在 Debug --> Exceptions (Ctrl + D, E) 中编辑设置

# entity-framework - 如何防止 Code First 对关系启用外键约束？

> ID：10324231
> 
> 赞同：1
> 
> 时间：2012-04-25T21:41:14.757
> 
> 标签：entity-framework, ef-code-first, code-first

我有两个实体，用户和反馈，在用户名字段的帮助下，它们之间存在一对多的关系。

```
Feedback --> User 
--------   --------
username   username 
```

但是，有时反馈可能来自未注册用户，反馈上的用户名字段将为空。在这种情况下，由于外键约束，添加反馈将失败。

如何以声明方式或通过 Fluent API 禁用对关系执行外键约束？创建数据库时默认启用。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T22:24:20.050

您不需要出于您的目的禁用外键约束的执行，您只需要允许外键为 NULL 值，这称为*可选*的一对多关系（与*不需要*的关系相反） t 允许外键的 NULL 值）。

您可以通过以下方式定义此可选关系：

```
public class Feedback
{
    public int Id { get; set; }

    [ForeignKey("User")]
    public int? UserId { get; set; } 
    public User User { get; set; }
} 
```

具有可空类型`int?`的外键使关系可选。如果`User`有一个名为主键的属性`Id`，您甚至可以省略该`[ForeignKey]`属性，因为 Entity Framework 将根据命名约定将其检测`UserId`为导航属性的外键。`User`

或者，您可以使用 Fluent API 代替数据注释：

```
modelBuilder.Entity<Feedback>()
    .HasOptional(f => f.User)
    .WithMany() // or WithMany(u => u.Feedbacks)
    .HasForeignKey(f => f.UserId); 
```

# xml - 将超过 100,000 条记录插入 SQLite

> ID：10324232
> 
> 赞同：0
> 
> 时间：2012-04-25T21:41:19.577
> 
> 标签：xml, database, apache-flex, sqlite, air

我有一个需要定期更新的数据库。我的雇主想在 MS Access 中保留它的基本实例，并在本地 SQLite 表中更新一个。

我已经能够从 MS Access 表中获取所有数据（到 XML 中），但是当我尝试将其插入 SQLite 表时，我得到了复合选择语句中的术语太多的错误。

我知道 SQLite 限制复合选择插入到 500，但这个数据库超过 150,000 行。我不知道如何移动数据。

有人有什么想法吗？

这是我尝试使用的代码：

```
var sqlItem:String="INSERT INTO items (itemID,barcode,desc,brandNum,size,units,multQty,multPrice,price,brand,cat01,catSub,cost,srp,lastPriceChangeDate,lastScanDate,addDate,chgDate) ";
for each(var i:XML in itemList.item){
    sqlItem=sqlItem+"SELECT "+
    parseInt(i.itemID,10)+","+
    parseInt(i.barcode,10)+","+
    "\""+i.description+"\","+
    parseInt(i.brandNum,10)+","+
    "\""+i.size+"\","+
    "\""+i.units+"\","+
    parseInt(i.multQty,10)+","+
    "\""+i.multPrice+"\","+
    "\""+i.price+"\","+
    "\""+i.brand+"\","+
    "\""+i.cat01+"\","+
    "\""+i.catSub+"\","+
    "\""+i.cost+"\","+
    "\""+i.srp+"\","+
    "\""+i.lastPriceChangeDate+"\","+
    "\""+i.lastScanDate+"\","+
    "\""+i.addDate+"\","+
    "\""+i.chgDate+"\""+
    " UNION ";
}
sqlItem=sqlItem.substring(0,sqlItem.length-7);
itemStmt.text=sqlItem;
try{
    itemStmt.execute();
}catch(error:SQLError){
    trace("Update USER Database - ERROR: "+error.detailID +" - "+error.details );
} 
```

这是我正在读入数据库的 XML 示例：

```
<items>
    <item>
        <itemID>1234</itemID>
        <barcode>01111111111111</barcode>
        <description>Product Description</description>
        <brandNum>1</brandNum>
        <size>1</size>
        <units>oz.</units>
        <multQty>1</multQty>
        <multPrice>0.85</multPrice>
        <price>0.85</price>
        <brand>Product Brand</brand>
        <cat01>Product Category</cat01>
        <catSub>(none)</catSub>
        <cost>0.10</cost>
        <srp>0.95</srp>
        <lastPriceChangeDate>1/9/2009 3:32:29 PM</lastPriceChangeDate>
        <lastScanDate>1/9/2009 3:32:29 PM<lastScanDate>
        <addDate/>1/9/2009 3:32:29 PM<addDate/>
        <chgDate>1/9/2009 3:32:29 PM</chgDate>
    </item>
    <item>
        <itemID>1234</itemID>
        <barcode>01111111111111</barcode>
        <description>Product Description</description>
        <brandNum>1</brandNum>
        <size>1</size>
        <units>oz.</units>
        <multQty>1</multQty>
        <multPrice>0.85</multPrice>
        <price>0.85</price>
        <brand>Product Brand</brand>
        <cat01>Product Category</cat01>
        <catSub>(none)</catSub>
        <cost>0.10</cost>
        <srp>0.95</srp>
        <lastPriceChangeDate>1/9/2009 3:32:29 PM</lastPriceChangeDate>
        <lastScanDate>1/9/2009 3:32:29 PM<lastScanDate>
        <addDate/>1/9/2009 3:32:29 PM<addDate/>
        <chgDate>1/9/2009 3:32:29 PM</chgDate>
    </item>
</items> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T20:31:22.803

试试这个解决方案吧！！！我什至在基于 sqlite 的 Web Sql DB 中测试了这个解决方案

选择 sqlite_version()

## 3.6.19

```
INSERT INTO items (val)  
select * from
(select 1  val  union all
 select 2   val union all
 select 3   val union all
 select 4   val union all
 ...
 select 500 val
)
union all
select * from
(select 501  val    union all
 select 502 val union all
 select 503 val union all
 select 504 val union all
 ...
 select 1000    val
)
union all
select * from
(select 1001  val   union all
 select 1002    val union all
 select 1003    val union all
 select 1004    val union all
 ...
 select 1500    val
)
... 
```

# javascript - 淘汰赛绑定处理程序拆卸功能？

> ID：10324240
> 
> 赞同：24
> 
> 时间：2012-04-25T21:42:20.670
> 
> 标签：javascript, knockout.js

我有一个淘汰绑定处理程序，它使用 plupload 进行拖放和 ajax 上传。

为了使用 plupload 脚本，我创建了一个 plupload 实例，该实例又将事件侦听器绑定到 DOM 元素。

这很好用。

但是，我有一个“文件夹”列表，当我单击一个文件夹时，我会显示该文件夹中的文件列表。我通过使用 foreach 绑定 selectedFolder().documents 来重用相同的 DOM 元素。

我遇到的问题是，在我的绑定处理程序中，我在 init 函数中完成了所有的 plupload 工作，并且由于我重用了 DOM 元素，它们获得了多个绑定到它们的事件处理程序。这会导致将拖放事件发送到所有处理程序。这意味着，如果我将文件拖放到渲染文件列表中，则 drop 事件也会在所有先前渲染的文件列表上触发。

我正在寻找的是绑定处理程序中的某种拆卸或清理功能，这样我就可以在文件列表未呈现时取消注册所有事件（这是一个词吗？）。

也许我们无法检测到未渲染？那我该如何处理呢？我不希望有一个全局实例，因为这会阻止我同时在多个地方使用绑定。

很抱歉没有给你任何代码。我在我的手机自动取款机上。

干杯!

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-25T22:21:00.323

您可以注册一个处理程序，该处理程序将在 KO 删除元素时执行（例如重新渲染模板时）。看起来像：

```
 //handle disposal (if KO removes by the template binding)
    ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
        $(element).datepicker("destroy");
    }); 
```

因此，在您的“init”函数中，您将为被绑定的元素注册一个 dispose 回调，并且您将有机会运行您想要的任何清理代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T20:00:17.523

我相信这里提供的解决方案只有在 Knockout 是删除 DOM 节点（即当它重新设置模板时）时才有效。我很难让它在某些条件下触发。在某些情况下，无论您的元素如何被删除，您都需要执行回调；无论是使用 Knockout，还是通过 jQuery.html() 等（尤其是在单页应用程序中）。

在 jQuery 的帮助下，我酝酿了一种不同的方法来添加这样的钩子。使用特殊事件 API（[在此处进行了详细描述），您可以添加一个在从 DOM 节点](http://benalman.com/news/2010/03/jquery-special-events/#api-remove)[移除](http://benalman.com/news/2010/03/jquery-special-events/#api-remove)特定事件时执行的方法（在拆卸时发生的事情）。

如果您将 Knockout 与 jQuery 结合使用，则可以将其包装到敲除绑定中，如下所示：

```
ko.bindingHandlers.unload = {
    init: function (element, valueAccessor) {
        var eventName = 'your_unique_unLoad_event'; // Make sure this name does not collide
        if (!$.event.special[eventName]) {
            $.event.special[eventName] = {
                remove: function (o) {
                    o.data.onUnload()
                }
            };
        }
        $(element).on(eventName, { onUnload: valueAccessor()}, $.noop);
    }
}; 
```

然后，您可以在任何元素上使用它，如下所示：

```
<div id="withViewModelMethod" data-bind="unload: aMethodOnMyViewModel" />
<div id="withInLineMethod" data-bind="unload: function() { /* ... */ }" /> 
```

我欠这篇[SO 帖子的](https://stackoverflow.com/questions/2200494/jquery-trigger-event-when-an-element-is-removed-from-the-dom/10172676#10172676)功劳。

# ios - 在模拟器中运行的 iPad 应用程序中的神秘 SIGKILL

> ID：10324241
> 
> 赞同：1
> 
> 时间：2012-04-25T21:42:21.913
> 
> 标签：ios, sigkill

我的 iPad 应用程序最近在 iOS 模拟器中运行时收到了神秘的 SIGKILL 信号。它似乎在应用程序启动后 2 分钟内发生，但并非每次都发生。

这个回溯是否表明了什么，或者我应该尝试删除一些东西直到找到罪魁祸首？

可能涉及一些组件；一个例子是我最近集成了 Crashlytics。另一个例子是我使用 CLGeocoder 在 MKMapView 上绘制位置，这可以解释为什么问题发生在启动后的某个未确定点（以及 MapKit 出现在其中一个线程中的原因）。但是如果没有从回溯或日志中获得更清晰的指示，我就在黑暗中拍摄。

Xcode 4.3.2；针对 iOS 5。

```
 * thread #1: tid = 0x1f03, 0x9c2c4c22 libsystem_kernel.dylib`mach_msg_trap + 10, stop reason = signal SIGKILL
    frame #0: 0x9c2c4c22 libsystem_kernel.dylib`mach_msg_trap + 10
    frame #1: 0x9c2c41f6 libsystem_kernel.dylib`mach_msg + 70
    frame #2: 0x0178110a CoreFoundation`__CFRunLoopServiceMachPort + 186
    frame #3: 0x016e4550 CoreFoundation`__CFRunLoopRun + 1312
    frame #4: 0x016e3d84 CoreFoundation`CFRunLoopRunSpecific + 212
    frame #5: 0x016e3c9b CoreFoundation`CFRunLoopRunInMode + 123
    frame #6: 0x015af7d8 GraphicsServices`GSEventRunModal + 190
    frame #7: 0x015af88a GraphicsServices`GSEventRun + 103
    frame #8: 0x00394626 UIKit`UIApplicationMain + 1163
    frame #9: 0x00001d4d Tablecloth`main + 141 at main.m:16
    frame #10: 0x00001cb5 Tablecloth`start + 53

  thread #3: tid = 0x2403, 0x9c2c790a libsystem_kernel.dylib`kevent + 10
    frame #0: 0x9c2c790a libsystem_kernel.dylib`kevent + 10
    frame #1: 0x020b9372 libdispatch.dylib`_dispatch_mgr_invoke + 918
    frame #2: 0x020b7be1 libdispatch.dylib`_dispatch_mgr_thread + 53

  thread #5: tid = 0x2603, 0x9c2c4c22 libsystem_kernel.dylib`mach_msg_trap + 10
    frame #0: 0x9c2c4c22 libsystem_kernel.dylib`mach_msg_trap + 10
    frame #1: 0x9c2c41f6 libsystem_kernel.dylib`mach_msg + 70
    frame #2: 0x0178110a CoreFoundation`__CFRunLoopServiceMachPort + 186
    frame #3: 0x016e45d5 CoreFoundation`__CFRunLoopRun + 1445
    frame #4: 0x016e3d84 CoreFoundation`CFRunLoopRunSpecific + 212
    frame #5: 0x016e3c9b CoreFoundation`CFRunLoopRunInMode + 123
    frame #6: 0x03ede420 WebCore`_ZL12RunWebThreadPv + 560
    frame #7: 0x93ebced9 libsystem_c.dylib`_pthread_start + 335

  thread #6: tid = 0x2703, 0x9c2c4c22 libsystem_kernel.dylib`mach_msg_trap + 10
    frame #0: 0x9c2c4c22 libsystem_kernel.dylib`mach_msg_trap + 10
    frame #1: 0x9c2c41f6 libsystem_kernel.dylib`mach_msg + 70
    frame #2: 0x0178110a CoreFoundation`__CFRunLoopServiceMachPort + 186
    frame #3: 0x016e45d5 CoreFoundation`__CFRunLoopRun + 1445
    frame #4: 0x016e3d84 CoreFoundation`CFRunLoopRunSpecific + 212
    frame #5: 0x016e3c9b CoreFoundation`CFRunLoopRunInMode + 123
    frame #6: 0x00d94e30 Foundation`+[NSURLConnection(Loader) _resourceLoadLoop:] + 398
    frame #7: 0x00ca64d6 Foundation`-[NSThread main] + 76
    frame #8: 0x00ca6447 Foundation`__NSThread__main__ + 1258
    frame #9: 0x93ebced9 libsystem_c.dylib`_pthread_start + 335

  thread #7: tid = 0x2803, 0x9c2c4c22 libsystem_kernel.dylib`mach_msg_trap + 10
    frame #0: 0x9c2c4c22 libsystem_kernel.dylib`mach_msg_trap + 10
    frame #1: 0x9c2c41f6 libsystem_kernel.dylib`mach_msg + 70
    frame #2: 0x0178110a CoreFoundation`__CFRunLoopServiceMachPort + 186
    frame #3: 0x016e45d5 CoreFoundation`__CFRunLoopRun + 1445
    frame #4: 0x016e3d84 CoreFoundation`CFRunLoopRunSpecific + 212
    frame #5: 0x016e3c9b CoreFoundation`CFRunLoopRunInMode + 123
    frame #6: 0x0012286b MapKit`MKNormalizedPointForLayer + 30057
    frame #7: 0x00ca64d6 Foundation`-[NSThread main] + 76
    frame #8: 0x00ca6447 Foundation`__NSThread__main__ + 1258
    frame #9: 0x93ebced9 libsystem_c.dylib`_pthread_start + 335

  thread #8: tid = 0x2903, 0x9c2c6b42 libsystem_kernel.dylib`select$DARWIN_EXTSN + 10
    frame #0: 0x9c2c6b42 libsystem_kernel.dylib`select$DARWIN_EXTSN + 10
    frame #1: 0x017157cb CoreFoundation`__CFSocketManager + 939
    frame #2: 0x93ebced9 libsystem_c.dylib`_pthread_start + 335

  thread #9: tid = 0x2a03, 0x9c2c702e libsystem_kernel.dylib`__workq_kernreturn + 10
    frame #0: 0x9c2c702e libsystem_kernel.dylib`__workq_kernreturn + 10
    frame #1: 0x93ebeccf libsystem_c.dylib`_pthread_wqthread + 773 
```

编辑：Crashlytics 支持团队帮助我调试了这个，似乎解决它的方法是使用模拟器应用程序中的“重置内容和设置...”菜单项。目前尚不清楚为什么会发生这种情况，但我不再遇到调试中断。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:03:49.577

SIGKILL 通常表明您被操作系统杀死。您的控制台日志将比堆栈跟踪更有用。如果它在设备上，我会怀疑使用了太多内存，但这在模拟器中不太可能。另一个常见的 SIGKILL 是如果你阻塞你的主线程太久，所以我会寻找它（虽然我不认为模拟器提供了那个）。

但是最好的查看位置是在运行日志中。

# python - 使用不需要的空行写入文件

> ID：10324244
> 
> 赞同：0
> 
> 时间：2012-04-25T21:42:27.923
> 
> 标签：python

我有一段代码从文本文件中删除一些不需要的行并将结果写入新的：

```
f = open('messyParamsList.txt')
g = open('cleanerParamsList.txt','w')
for line in f:
    if not line.startswith('W'):
        g.write('%s\n' % line) 
```

原始文件是单行距的，但新文件在每行文本之间有一个空行。我怎样才能丢失空行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:44:12.153

您没有从输入行中删除换行符，因此您不应该`\n`在输出中添加一个 ( )。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:44:53.980

要么从您阅读的行中删除换行符，要么在写出时不添加新行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T22:32:40.383

做就是了：

```
f = open('messyParamsList.txt')
g = open('cleanerParamsList.txt','w')
for line in f:
    if not line.startswith('W'):
        g.write(line) 
```

您从原始文件中读取的每一行末尾都有`\n`（新行）字符，所以不要添加另一个（现在您正在添加一个，这意味着您实际上引入了空行）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T21:45:00.763

我的猜测是变量“line”已经有一个换行符，但是你正在用 g.write('%s* *\n* *' % line)编写一个额外的换行符

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T21:46:03.970

行末尾有一个换行符。

从您的 write 或 rstrip 行中删除 \n。

# java - java graphics2d 动画 gif 更新

> ID：10324250
> 
> 赞同：1
> 
> 时间：2012-04-25T21:42:54.353
> 
> 标签：java, swing, graphics, animated-gif

小程序播放动画 gif 文件：

```
public class Applet1 extends Applet {
    private Image m_image=null;
    public void init() {
        m_image=getImage(getDocumentBase(), "001.gif");
    }   
    public void paint(Graphics g) {
        g.drawImage(m_image,0,0,this); 
    }   
    public boolean imageUpdate( Image img, int flags, int x, int y, int w, int h ) {
        System.out.println("Image update: flags="+flags+" x="+x+" y="+y+" w="+w+" h="+h);
        repaint();
        return true;
    }
} 
```

我需要在另一个程序中添加更新的图像：

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.text.*;

public class HighlightExample {
    public static void main(String[] args) {
        JFrame f = new JFrame("Highlight example");
        final JTextPane textPane = new JTextPane();
        JPanel pane = new JPanel();
        pane.setLayout(new BorderLayout());
        final JTextField tf = new JTextField();
        pane.add(tf, "Center");
        f.getContentPane().add(pane, "South");
        f.getContentPane().add(new JScrollPane(textPane), "Center");

        textPane.setText("abсdefghijkl lmnop12345678");
        final WordSearcher searcher = new WordSearcher(textPane);

        tf.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent evt) {
                word = tf.getText().trim();
                int offset = searcher.search(word);
                if (offset != -1) {
                    try {
                        textPane.scrollRectToVisible(textPane.modelToView(offset));
                    } catch (BadLocationException e) {}
                }
            }
        });

        textPane.getDocument().addDocumentListener(new DocumentListener() {
            public void insertUpdate(DocumentEvent evt) {
                searcher.search(word);
            }
            public void removeUpdate(DocumentEvent evt) {
                searcher.search(word);
            }
            public void changedUpdate(DocumentEvent evt) {
            }
        });
        f.setSize(400, 400);
        f.setVisible(true);
    }
    public static String word;
}

class WordSearcher {
    protected JTextComponent comp;
    protected Highlighter.HighlightPainter painter;
    public WordSearcher(JTextComponent comp) {
        this.comp = comp;
        this.painter = new UnderlineHighlighter.UnderlineHighlightPainter(Color.red);
    }
    public int search(String word) {
        int firstOffset = -1;
        Highlighter highlighter = comp.getHighlighter();
        Highlighter.Highlight[] highlights = highlighter.getHighlights();
        for (int i = 0; i < highlights.length; i++) {
            Highlighter.Highlight h = highlights[i];
            if (h.getPainter() instanceof UnderlineHighlighter.UnderlineHighlightPainter) {
                highlighter.removeHighlight(h);
            }
        }
        if (word == null || word.equals("")) {
            return -1;
        }
        String content;
        try {
            Document d = comp.getDocument();
            content = d.getText(0, d.getLength()).toLowerCase();
        } catch (BadLocationException e) {
            return -1;
        }

        word = word.toLowerCase();
        int lastIndex = 0;
        int wordSize = word.length();

        while ((lastIndex = content.indexOf(word, lastIndex)) != -1) {
            int endIndex = lastIndex + wordSize;
            try {
                highlighter.addHighlight(lastIndex, endIndex, painter);
            } catch (BadLocationException e) {}
            if (firstOffset == -1) {
                firstOffset = lastIndex;
            }
            lastIndex = endIndex;
        }
        return firstOffset;
    }
}

class UnderlineHighlighter extends DefaultHighlighter{
    protected static final Highlighter.HighlightPainter sharedPainter = new UnderlineHighlightPainter(null);
    protected Highlighter.HighlightPainter painter;

    public static class UnderlineHighlightPainter extends LayeredHighlighter.LayerPainter {
        protected Color color; // The color for the underline
        public UnderlineHighlightPainter(Color c) {
            color = c;
        }
        public void paint(final Graphics g, int offs0, int offs1, Shape bounds, JTextComponent c) {
        }
        public Shape paintLayer(final Graphics g, int offs0, int offs1, Shape bounds, JTextComponent c, View view) {
            g.setColor(color == null ? c.getSelectionColor() : color);
            Rectangle alloc;
            try {
                Shape shape = view.modelToView(offs0,Position.Bias.Forward, offs1,Position.Bias.Backward, bounds);
                alloc = (shape instanceof Rectangle) ? (Rectangle) shape : shape.getBounds();
            } catch (BadLocationException e) {
                return null;
            }
            FontMetrics fm = c.getFontMetrics(c.getFont());
            int baseline = alloc.y + alloc.height - fm.getDescent() + 1;
            g.drawLine(alloc.x, baseline, alloc.x + alloc.width, baseline);

            Toolkit kit=Toolkit.getDefaultToolkit();
            Image im3 =kit.getImage("001.gif");
            g.drawImage(im3,alloc.x+15,alloc.y-6,null);
            return alloc;
        }
    }
} 
```

在这个程序中总是只显示图像 im3 的第一帧。抱歉有很多代码，它是完全可编译的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:52:34.550

似乎问题在于您在绘制图像时传递`null`了`ImageObserver`（接近代码末尾）：

```
g.drawImage(im3,alloc.x+15,alloc.y-6,null); 
```

因此，当新帧准备好时，图像将触发更新，但该更新会被忽略，因为没有侦听器。您可能希望`c`作为 the传递，`ImageObserver`以便在图像更改时重新绘制自己。

**编辑：**

这种做法将`c`完全。如果你想聪明一点，你可以创建自己的`ImageObserver`，记住`c`绘制图标的确切矩形，并在收到更新通知时重新绘制该矩形。

# java - java中对象与父对象的通信

> ID：10324251
> 
> 赞同：0
> 
> 时间：2012-04-25T21:42:55.090
> 
> 标签：java, arrays, object, communication, parent

现在，我一直在寻找这个问题的答案，但谷歌和我所有的力量似乎都让我失望了。

我得到了这门课。（我的世界）。在 MyWorld 我有一个对象数组

```
GameUnit m_MyUnits[] = new GameUnit[maxUnits]; 
```

现在 m_MyUnits 充满了 GameUnits 和子类，它们像芝士蛋糕一样快乐地在屏幕上走来走去。我什至为它们中的每一个编写了自己的小碰撞检测，因此它们不会相互碰撞。

一切正常，但是！为了让我的碰撞检测起作用，我选择了最慢的方法（我认为需要最多的内存）

在 MyWorld 中，我首先循环遍历每个 GameUnit 并获取数组的 X 和 Y 位置 private int[][] Positions = new int[2][maxUnits]);

然后我循环遍历每个 GameUnit 并将这个数组分配给它。（GameUnit 有自己的名为 Positions 的数组）

现在，虽然这有效，但我不禁认为这很愚蠢，就像……。好吧，我不会在这里使用这些词。

有没有办法让 GameUnit 调用 MyWorld 中的位置，或者更好的是，让游戏单元调用 MyWorld 中的数组 m_MyUnits[].getX() 和 m_MyUnits[].getY() 类似这样的事情（我使用 Parent从 GameUnit 引用 MyWorld）

```
For(int i = 0;i < Parent.maxUnits;i++) {
  int targetX = Parent. m_MyUnits[i].getX();
  int targetY = Parent. m_MyUnits[i].getX();
  //Do some thing like collition detection with the data.
} 
```

这是可能的，还是？

你的JavaApprentis。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:46:09.890

当您创建 a`GameUnit`时，您可以将`MyWorld`作为构造函数参数传递。然后`GameUnit`构造函数可以将`MyWorld`对象存储在成员变量中。然后，当它需要进行碰撞检测时，它可以`MyWorld`通过调用该对象上的方法来请求潜在合作伙伴的列表。

在`GameUnit`：

```
private MyWorld myWorld;

public GameUnit(int,int,double, MyWorld m) {
    myWorld = m;
} 
```

然后在`MyWorld`，当你做一个`GameUnit`：

```
new GameUnit(1, 2, 1.0, this); 
```

然后在 的所有方法中`GameUnit`，您都有可用的`MyWorld`对象。`myWorld`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:16:41.943

将 MyWorld 类型的 World 属性添加到 GameUnit。更改 GameUnit 的构造函数以接受 World 作为参数并将 World 设置为它。

将 GetX 和 GetY 方法添加到 MyWorld，将 m_MyUnits[i].getX() 和 getY 与数组中的索引作为参数一起包装。

给予类似的东西

```
For(int i = 0;i < World.maxUnits;i++) {
  int targetX = World. getX(i);
  int targetY = World. getY(i);
  //Do some thing like collition detection with the data.
} 
```

说我想我会颠倒这个并做类似的事情

```
If (World.Collide(this))
{
  // Die messily.
} 
```

# javascript - Backbone（也包括 Marionette）试图在集合开始时显示新记录，而不重新渲染整个集合

> ID：10324255
> 
> 赞同：7
> 
> 时间：2012-04-25T21:43:19.457
> 
> 标签：javascript, backbone.js, marionette

我正在尝试在集合开始时呈现一个项目（想象一下，如果你在 facebook 上发布一条新记录）

当我来 add(response, {at: 0}); 到集合中，记录在 0 处正确插入到集合中，但呈现在项目列表的底部。我很困惑，因为我以前做过这个工作，但我认为我在做的是一种 hacky 风格，只是重置并重新渲染集合。

我想知道处理这个问题的整洁方法是什么，我应该在哪里绑定逻辑。

是在集合的 add 方法上吗？目前这是空的（但我正在使用 Marionette），我觉得这会覆盖骨干的默认渲染。我如何再次控制它，这样我就可以正确地将我的新项目添加到列表中，而不会全部破坏并重新创建它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-26T01:23:40.200

在 Marionette 中，将新项目添加到视图中的集合的默认方法是使用 jQuery 的`append`方法。该`CollectionView`类型有一个名为的方法`appendHtml`，用于执行实际的附加操作。（见[http://derickbailey.github.com/backbone.marionette/docs/backbone.marionette.html#section-24](http://derickbailey.github.com/backbone.marionette/docs/backbone.marionette.html#section-24)）

不过，您可以在特定的集合视图中轻松覆盖此方法，并将新模型附加到需要的任何位置。

在您的情况下，如果您总是想将新模型添加到列表的顶部，那么更改您的集合视图以执行此操作非常简单：

```
Backbone.Marionette.CollectionView.extend({
  appendHtml: function(cv, iv){
    cv.$el.prepend(iv.el);
  }
}); 
```

请注意，这`cv`是集合视图实例，并且`iv`是集合中模型的项目视图实例。

如果您需要执行更复杂的操作，例如在现有的 HTML 节点集合中查找确切位置，您也可以在`appendHtml`函数中执行此操作。当然，这比仅仅做前置而不是追加要复杂得多，但它仍然是可能的。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-14T13:28:04.690

这可能是一个非常古老的问题，但无论如何我都会发布我的解决方案......它通过覆盖 appendHtml 函数，根据新模型添加到集合中的方式（取消移位/添加），在 itemViewContainer 前添加/附加新模型。

```
appendHtml: function(collectionView, itemView, index){
            if(index > 0) {
                collectionView.$el.find(this.itemViewContainer).append(itemView.el);
            } else {
                collectionView.$el.find(this.itemViewContainer).prepend(itemView.el);
            }
        }, 
```

# c# - Silverlight C# WP - 列出类的属性名称

> ID：10324256
> 
> 赞同：-3
> 
> 时间：2012-04-25T21:43:21.517
> 
> 标签：c#, silverlight, windows-phone-7, xaml

如何通过绑定列出类的所有属性名称

```
<ListBox>
<TextBlock Name="{Binding WHAAAAT???!}" />
</ListBox> 
```

班级：

```
public class DaysOfWeek
{    
    public bool Monday {get; set;}
    public bool Tuesday { get; set; }
    public bool Wednesday { get; set; }
    public bool Thursday { get; set; }
    public bool Friday { get; set; }
    public bool Saturday { get; set; }
    public bool Sunday { get; set; }
} 
```

我想将此内容放在列表框中。请在这件事上给予我帮助。

```
Monday
Tuesday
Wednesday 
Thursday 
Friday 
Saturday
Sunday 
```

感激的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:57:07.590

听起来您需要使用反射，如此[处所示](http://www.csharp-examples.net/reflection-property-names/)

```
using System.Reflection;  // reflection namespace

// get all public static properties of MyClass type
PropertyInfo[] propertyInfos;
propertyInfos = typeof(MyClass).GetProperties(BindingFlags.Public |
                                              BindingFlags.Static);
// sort properties by name
Array.Sort(propertyInfos,
        delegate(PropertyInfo propertyInfo1, PropertyInfo propertyInfo2)
        { return propertyInfo1.Name.CompareTo(propertyInfo2.Name); });

// write property names
foreach (PropertyInfo propertyInfo in propertyInfos)
{
  Console.WriteLine(propertyInfo.Name);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:05:26.823

我的解决方案：

```
Classes.DaysOfWeek _DaysOfWeek;

_DaysOfWeek = new Classes.DaysOfWeek();
var listProp = _DaysOfWeek.GetType().GetProperties().ToList();

List<String> newList = new List<String>{};
foreach(var item in listProp){
newList.Add(item.Name);
}
listBox_Days.ItemsSource = newList; 
```

容易理解！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T14:37:54.620

查看 MVVM 模型（例如创建一个新的全景 / 透视 / 数据绑定示例应用程序），这是在尝试编写新代码时减少最多时间的模型，同时保持非常干净。

祝你好运 ;）

# linux - 无法执行二进制文件错误

> ID：10324257
> 
> 赞同：1
> 
> 时间：2012-04-25T21:43:30.553
> 
> 标签：linux, shell

我有一个 shell 脚本，我试图以特定用户的身份运行它。我的命令如下所示：

```
su - jetty sh ./runProgram.sh 
```

当我尝试通过控制台运行此命令时，我收到一条错误消息：

```
/bin/sh: /bin/sh: cannot execute binary file 
```

我也试过：

```
 su - jetty sh runProgram.sh 
```

我仍然得到同样的错误..

如果我这样做，它确实有效：

```
sh runProgram.sh 
```

但是这个 shell 脚本是由特定用户运行的。关于如何使它工作的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:46:10.047

尝试

```
su - jetty -c sh runProgram.sh 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-24T17:01:31.640

根据的`su`文档（`info coreutils 'su invocation'``su`

含义很简单：`su`本质上是在做： `/bin/sh` `*arguments_to_su*` 但它作为另一个用户（“有效用户ID”）做......就是这样......所以

```
su - jetty sh ./runprogram.sh 
```

类似于

```
(become the user jetty via login or su)
/bin/sh sh ./runprogram.sh 
```

...并且 shell 会报告一个错误，因为第一个`/bin/sh`被 调用的`su`试图将程序`sh`作为 shell 脚本运行，并`./runprogram.sh`以它的参数作为参数。但是 sh 本身不是一个 shell 脚本，它是一个二进制文件（它的工作是运行 shell 脚本）。

如果你只是这样做：

```
su - jetty ./runprogram.sh 
```

然后该`su`命令将以`/bin/sh`程序`./runprogram.sh`作为参数调用，jetty 作为有效用户 ID，一切都应该很好。...应该很好，因为你正在做一个`su -`你正在做的外壳登录外壳并更改到用户的主目录。如果`runprogram.sh`不在主目录中，则会出现错误。

这也是为什么您不能运行例如运行`cp`命令的原因：

```
su - jetty cp file1 file2 
```

...因为，同样，在`su`将有效用户 ID 更改为码头后，它将尝试以下操作：

```
/bin/sh cp file1 file2 
```

...并且`cp`不是 shell 脚本。但是该`-c`选项在这种情况下有效；因为您告诉`su`您要`/bin/sh`使用 shell 的 -c 选项运行：

```
su - jetty -c "cp file1 file2" 
```

做这项工作。请注意，您必须引用该命令，因为整个字符串都被传递给 shell，并且（我相信）任何后续参数都将被忽略。

最后，前一个海报的答案在 Linux 上对我不起作用，它需要引用整个命令字符串。

# trigger.io - 使用 saveLocation: "file" 总是会导致照片方向为横向（而不是纵向）

> ID：10324260
> 
> 赞同：2
> 
> 时间：2012-04-25T21:43:36.927
> 
> 标签：trigger.io, forge

我发现的一个问题（或者我没有正确使用它）是使用 saveLocation: "file" 在文件上传期间总是会导致照片方向为横向。

（我希望照片是纵向的）。

我尝试使用以下 config.json 设置将方向强制为纵向：

```
"orientations": {
    "default": "portrait",
    "iphone": "portrait",      
}, 
```

但它并没有解决问题。

我对 getImages 的调用就像：

```
forge.file.getImage({
    source: "camera",
    saveLocation: "file",
    width: 300,
    height: 300
}, function (file) { ... }
); 
```

如果我删除 saveLocation:"file"，则上传的照片是纵向的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T15:07:17.493

这是因为 Trigger.io 在读取照片时没有使用 EXIF 数据：我们在从图库中读取时会获得旋转信息，但在从文件中读取时应该会做得更好。

**更新**：这已在 Trigger.io 平台的 v.1.4.27 中修复。请参阅[http://docs.trigger.io/en/v1.4/release-notes.html#v1-4-27](http://docs.trigger.io/en/v1.4/release-notes.html#v1-4-27)。

当显示从 返回的图像时`file.getImage`，我们会自动处理方向。

使用 将图像上传到服务器时`forge.request.ajax`，有两种可能性。任何一个：

*   已指定图像大小约束，我们对图像应用缩放和旋转变换
*   没有指定图像大小限制，我们通过原始图像数据

因此，如果上传的图像中有 Exif 方向数据，您可以在任何您想做的后期处理中使用它。如果没有 Exif 数据，则设备无法提供该数据，或者我们已经将图像预先旋转到正确的位置。

# c# - 如何避免重命名属性和 Automapper 的问题

> ID：10324263
> 
> 赞同：1
> 
> 时间：2012-04-25T21:43:51.127
> 
> 标签：c#, automapper, automapper-2

假设我们有两个具有以下属性的 c# 类 A 和 B

```
A
-Name
-SurName

B
-Name
-SurName 
```

使用 Automapper，我可以毫无问题地从 A 类映射到 B 类。

如果我对**Class A -Name**进行重构会发生什么。使用 VS2010 重命名。

然后类将是

```
A
-NameRefactored
-SurName
B
-Name
-SurName 
```

由于我们使用的是 Automapper，Refactor 无法知道他也应该更改 B 的名称。

最糟糕的是重构永远不会抱怨任何事情，直到我们发现AutoMap 之后的**B.Name**为空......

我们怎样才能避免这类问题呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T02:46:47.423

使用 Mapper.AssertConfigurationIsValid() 方法来验证您的配置。它完全按照宣传的方式进行 - 检查以确保目标类型上的所有成员都已映射。

# android - 在 .htaccess 中检测 Android 版本

> ID：10324266
> 
> 赞同：0
> 
> 时间：2012-04-25T21:44:27.317
> 
> 标签：android, apache, .htaccess

如何在 htaccess 文件中检测 Android 设备的版本？像这样的东西：

```
RewriteCond %{REQUEST_URI} !^/directory_for_android_1_x/.*$
RewriteCond %{HTTP_USER_AGENT} "android1.x" [NC]
RewriteRule ^(.*)$ /directory_for_android_1_x/ [L,R=302] 
```

我需要达到 1.x、2.x、3.x 和 4.x。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:49:23.000

你不能，没有任何可靠性 - 用户代理嗅探是复杂且充满危险的，如果你正在做这一切，它不应该通过`.htaccess`.

[使用Modernizr](http://modernizr.com/)之类的东西来检测支持**的功能**和 CSS @media 查询并相应地调整网站的行为会好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T17:06:27.997

实际上，有一个足够可靠的简单解决方案。假设您要将所有 androids <4 重定向到其他目录：

```
RewriteCond %{HTTP_USER_AGENT} "Android 1" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Android 2" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Android 3" [NC]
RewriteRule ^(.*)$ /directory_for_older_androids/ [L,R=302] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:23:38.640

[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)有一个 .htaccess （Apache）

下载它并将其修剪为您想要的代码。

# makefile - 将 make 之后的参数传递给 makefile 中的变量

> ID：10324270
> 
> 赞同：0
> 
> 时间：2012-04-25T21:44:59.253
> 
> 标签：makefile

我有一块`makefile`要生成`.pdf`, `.ps`,`.dvi`来自`.tex`：

```
...
$(FILE).pdf: $(FILE).tex $(SRC) $(DEPS)
    latex $(FILE).tex && \
    bibtex --min-crossrefs=500 $(FILE) && \
    latex $(FILE).tex && \
    latex $(FILE).tex && \
    dvips $(FILE).dvi -o $(FILE).ps && \
    ps2pdf $(FILE).ps $(FILE).pdf
... 
```

我想`$(FILE)`直接从命令行获取，作为`make`. 例如，`make paper`编译`paper.tex`并生成`paper.pdf`. 另外，我不想允许`make`或`make all`作为命令，其中没有指定文件名。

谁能告诉我如何将第一个参数传递`make`给`$(FILE)`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:49:25.957

这不是`make`工作方式。也许你想使用一个 shell 脚本，它接受一个参数，验证它，并`make`使用你的 Makefile 调用，将文件作为`make`变量传递；也就是说，类似

```
make -f tex.mk FILE="$validated_filename" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:15:58.210

您在这里有几个选项，具体取决于您想要的行为。（而且我不确定我是否完全理解你的命令——我认为没有任何理由将它作为一个包裹线——但没关系。）

**如果您只想允许预先知道的列表中的目标：**

```
FILES = scissors paper rock

$(FILES): % : %.tex $(SRC) $(DEPS)
    latex $*.tex && \
    ... 
```

**如果您只想允许`.tex`存在文件的目标：**

```
% : %.tex $(SRC) $(DEPS)
    latex $*.tex && \
    ... 
```

现在了解如何处理不需要的目标。**如果警告就足够了：**

```
all:
    @echo $@ is not a valid target

(real rule)

%:
    @echo $@ is not a valid target 
```

**如果你想让 Make 完全中止，**我认为这是可能的，但我必须再考虑一下......

# java - 为什么在布尔值上同步不是一个好习惯？

> ID：10324272
> 
> 赞同：38
> 
> 时间：2012-04-25T21:45:00.850
> 
> 标签：java, multithreading, boolean, synchronize

我的建筑师总是这么说

> 从不同步布尔值

我无法理解原因，如果有人可以举例说明为什么这不是一个好习惯，我将不胜感激。 [参考示例代码](http://www.theothertomelliott.com/node/40)

```
private Boolean isOn = false;
private String statusMessage = "I'm off";
public void doSomeStuffAndToggleTheThing(){

   // Do some stuff
   synchronized(isOn){
      if(isOn){
         isOn = false;
         statusMessage = "I'm off";
         // Do everything else to turn the thing off
      } else {
         isOn = true;
         statusMessage = "I'm on";
         // Do everything else to turn the thing on
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-04-25T21:46:02.190

> 我无法理解为什么我们应该“永远不要在布尔同步”的原因

你应该总是`synchronize`在一个*常量对象实例*上。如果您在您分配的任何对象上进行同步（即将对象更改为新对象），则它不是恒定的，不同的线程将在不同的对象*实例*上同步。因为它们在不同的对象实例上同步，所以多个线程将同时进入受保护的块，并且会发生竞争条件。`Long`这与在,`Integer`等上同步的答案相同。

```
// this is not final so it might reference different objects
Boolean isOn = true;
...
synchronized (isOn) {
   if (isOn) {
      // this changes the synchronized object isOn to another object
      // so another thread can then enter the synchronized with this thread
      isOn = false; 
```

更糟糕的是，`Boolean`通过自动装箱 ( `isOn = true`) 创建的任何对象都与`Boolean.TRUE`(或`.FALSE`) 相同，后者是所有对象中的`ClassLoader`单*例*。你的锁对象应该是它所使用的类的本地对象，否则你将锁定同一个单例对象，如果其他类犯了同样的错误，其他类可能会在其他锁定情况下锁定它们。

如果您需要锁定布尔值，正确的模式是定义一个`private final`锁定对象：

```
private final Object lock = new Object();
...

synchronized (lock) {
   ... 
```

或者您还应该考虑使用该`AtomicBoolean`对象，这意味着您可能根本不必`synchronize`使用它。

```
private final AtomicBoolean isOn = new AtomicBoolean(false);
...

// if it is set to false then set it to true, no synchronization needed
if (isOn.compareAndSet(false, true)) {
    statusMessage = "I'm now on";
} else {
    // it was already on
    statusMessage = "I'm already on";
} 
```

在您的情况下，因为看起来您需要使用线程打开/关闭它，所以您仍然需要`synchronize`在`lock`对象上设置布尔值并避免测试/设置竞争条件：

```
synchronized (lock) {
    if (isOn) {
        isOn = false;
        statusMessage = "I'm off";
        // Do everything else to turn the thing off
    } else {
        isOn = true;
        statusMessage = "I'm on";
        // Do everything else to turn the thing on
    }
} 
```

最后，如果您希望`statusMessage`从其他线程访问它，那么它应该被标记为`volatile`除非您`synchronize`在获取期间也会这样做。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-25T21:50:47.100

```
private Boolean isOn = false;
public void doSomeStuffAndToggleTheThing(){
   synchronized(isOn){ 
```

这是一个可怕的想法。将引用与公开可用`isOn`的对象相同的对象。`Boolean.FALSE`如果任何其他写得不好的代码也决定锁定这个对象，两个完全不相关的事务将不得不相互等待。

锁定是在[对象实例](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.19)上执行的，而不是在引用它们的变量上：

![在此处输入图像描述](../Images/c9d2b3ae737b7ba4093e32a62112d404.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T22:28:59.983

我认为你的问题更多的是同步本身而不是布尔同步。想象一下，每个线程都是一条道路，语句（汽车）一个接一个地去。在某些时候可能会有一个交叉点：如果没有信号量，可能会发生冲突。Java 语言有一种内置的方式来描述这一点：因为任何对象都可以是交集，所以任何对象都有一个关联的监视器作为信号量。当您在代码中使用同步时，您正在创建一个信号量，因此您必须对所有道路（线程）使用相同的信号量。所以这个问题并不是真正的布尔特定的，因为只存在两个布尔值，每次你同步一个实例变量然后将同一个变量指向不同的对象时都会发生这个问题。所以你的代码对布尔值是错误的，但对整数同样危险，

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-29T18:12:54.660

所有包装类都是不可变的。人们不应该在它们上同步的主要原因之一。

就好像 2 个线程在包装类对象上同步，其中一个修改了它的值，它将在一个新的/修改的对象上同步，两个线程将在 2 个不同的对象上同步。所以，同步的整个目的就失去了。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-04-26T02:47:04.983

编辑：格雷的答案是正确的。

我要补充的是：您的架构师是对的，如果从角度来看`Boolean`是**不可变**的，为什么要同步它？但是多线程很复杂并且基于场景。

# javascript - 淘汰赛循环错误 - 需要有关查找原因的建议

> ID：10324275
> 
> 赞同：0
> 
> 时间：2012-04-25T21:45:33.143
> 
> 标签：javascript, knockout.js

我正在与许多开发人员一起开展一个大型项目。我们有 2 页使用淘汰赛已经工作了一段时间。引入了一些新的、不相关的代码，并发现带有 Knockout 的 2 页不再正常工作。当页面加载时，会抛出如下错误。一些调查使我认为数据绑定属性中存在某种解析问题。我已经尝试了很多方法来让它工作，但是每当我尝试访问一个可观察的属性时，我都会不断地返回整个视图模型对象。我认为这是导致页面加载后我在下面看到的错误的原因。

我很难在此处放置示例，因此我正在寻找有关查找可能导致 Knockout 失败的错误 JavaScript 和/或 HTML 标记的任何建议。

```
<error>
(anonymous function)
r.Oa.v
r.i.q
r.a.n
e
h
f
r.R.fn.notifySubscribers
r.a.n
r.R.fn.notifySubscribers
r.w.b.G
b
Array.indexOf
r.a.k
r.T.Ha
b
PriceFormatted.ko.dependentObservable.read
h
f
r.R.fn.notifySubscribers
r.a.n
r.R.fn.notifySubscribers
r.w.b.G
b
Array.indexOf
r.a.k
r.T.Ha
b
// it keeps going from here... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T03:29:14.180

只是想更新这个答案。不幸的是，我没有确切地找到问题所在，但它与重新排列应用程序主页面中引用的脚本文件的顺序有关。我恢复到原来的顺序，问题就消失了，所以它实际上与整个应用程序中编写糟糕的自定义 JavaScript 的更大问题有关。

# c# - Crystal 报告导出崩溃 C#

> ID：10324276
> 
> 赞同：-3
> 
> 时间：2012-04-25T21:45:48.330
> 
> 标签：c#, crystal-reports, export, report

我在将水晶报告导出为 pdf 时遇到了一些问题。我的程序在加载teleneUdaje.rpt 时崩溃，我确信它是正确的名称。

if (txtpath.Text == "") throw new Exception("Prosím zvoľte cieľovú adresu");

```
 DataSet dt = new DataSet();

    string x = nastavenia.adresa_servera();
    string y = nastavenia.nazov_databazy();
    string z = nastavenia.ponechat_udaje();
    string a = nastavenia.sql_meno();
    string b = nastavenia.sql_heslo();

    SqlConnection databaza = new SqlConnection();
    databaza.ConnectionString = "Data Source=" + x + ";Initial Catalog=" + y + ";Persist Security Info=" + z + ";User ID=" + a + "; password=" + b + "";
    da.SelectCommand = new SqlCommand("SELECT * FROM tblTepelneUdaje", databaza);
    dt.Clear();
    da.Fill(dt);

    System.IO.FileInfo info = new System.IO.FileInfo(txtpath.Text.Trim());
    string type = info.Extension;

    CrystalDecisions.Shared.ExportFormatType tp = CrystalDecisions.Shared.ExportFormatType.Excel;

    switch (type)
    {
        case ".pdf":
            tp = CrystalDecisions.Shared.ExportFormatType.PortableDocFormat;
            break;
        case ".doc":
            tp = CrystalDecisions.Shared.ExportFormatType.WordForWindows; break;
        case ".rtf":
            tp = CrystalDecisions.Shared.ExportFormatType.RichText; break;
        case ".xls":
            tp = CrystalDecisions.Shared.ExportFormatType.Excel; break;
        default: MessageBox.Show("Invalid File type you entered"); break;
    }

    ReportDocument doc = new ReportDocument();
    doc.Load("TeleneUdaje.rpt");
    doc.SetDataSource(dt);
    doc.ExportToDisk(tp, txtpath.Text);
    MessageBox.Show("Zostava bola úspešne exportovaná"); 
```

请帮忙。

** 已编辑

它会抛出Crystal Reports 异常，报告加载失败。文件没问题，因为在程序中我可以使用报告查看器工具显示报告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T18:45:37.793

我找到了我的问题的正确答案。表达方式

```
doc.Load("TeleneUdaje.rpt") 
```

是错误的，因为它需要 .rpt 文件的完整路径，如下所示：

```
doc.Load("C:\\report.rpt"); 
```

谢谢大家的评论

# regex - 如何用正则表达式匹配双引号或单引号或不带引号？

> ID：10324279
> 
> 赞同：3
> 
> 时间：2012-04-25T21:45:54.000
> 
> 标签：regex

我试图从所有三种类型的输入中获取一些文本，但无法弄清楚如何处理未引用的情况。

到目前为止，我有：

```
name=['"](.*?)['"] 
```

输入：

```
name="sometext"
name='sometext'
name=sometext 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:03:12.573

看起来您是 C# 开发人员，因此您可以使用第一个匹配组来确保它被相同的引号关闭（因此 support `phrase="Don't forget apostrophes"`）。

```
Regex regex1 = new Regex(@"=(?:(['""])(.*?)\1|.*)");

string text = @" 
name=""don't forget me""
name='sometext'
name='sometext'
name=sometext
";

foreach (Match m in regex1.Matches(text))
   Console.WriteLine (m.Groups[2].Value); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:00:03.947

我将使用 OR 运算符`|`分别指定三种情况：

```
('[^'"]*')|("[^'"]*")|([^'"]*) 
```

根据您使用的正则表达式方言，您必须定义由 OR 运算符分隔的非匹配组，并为 words 定义匹配组`[^'"]*`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:07:41.620

在不知道 'name=asdf' 之后可能是什么的情况下，假设它的空格或没有任何东西
来分隔结尾。

```
name= 
(?:
     (['"])((?:(?!\1).)*)\1    # (1,2)
 |   (\S*)                     # (3)
) 
```

答案是 2 美元加 3 美元

# ruby - 如何在Ruby中查找字符串中特殊字符之间的文本值？

> ID：10324285
> 
> 赞同：1
> 
> 时间：2012-04-25T21:46:10.827
> 
> 标签：ruby, regex

对 Ruby 非常陌生，

```
file_path = "/.../datasources/xml/data.txt" 
```

如何找到最后两个正斜杠之间的值？在这种情况下，该值是“xml”...我不能使用绝对定位，因为“/”的数量会随着文本而变化，但我需要的值总是在最后两个 / 之间

我只能找到有关如何在字符串中查找特定单词的示例，但在这种情况下，我不知道该单词的值，因此这些示例没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:50:05.760

`file_path.split("/").fetch(-2)`

你说你确定它总是在最后两个斜线之间。这会将您的字符串拆分为斜杠数组，然后获取倒数第二个元素。

```
"/.../datasources/xml/data.txt".split("/").fetch(-2) => "xml" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:50:51.570

如果您有 Ruby 1.9 或更高版本：

```
if subject =~ 
    /(?<=\/) # Assert that previous character is a slash
    [^\/]*   # Match any number of characters except slashes
    (?=      # Assert that the following text can be matched from here:
     \/      #  a slash,
     [^\/]*  #  followed by any number of characters except slashes
     \Z      # and the end of the string
    )        # End of lookahead assertion
    /x
    match = $& 
```

# python - INSERT 上的 SQL 语法错误

> ID：10324294
> 
> 赞同：2
> 
> 时间：2012-04-25T21:46:49.347
> 
> 标签：python, mysql, sql

我不断遇到以下语句的错误：

```
cursor.execute("""INSERT into financial_statements (url) 
                  VALUES (%s) WHERE provider=%s AND date=%s""", (url, provider, date)) 
```

我得到的错误是：

```
_mysql_exceptions.ProgrammingError: (1064, "You have an error in your SQL syntax; 
check the manual that corresponds to your MySQL server version for the right syntax to use near 
'WHERE provider='ANGEL' AND date='2012-03-01'' at line 2") 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T21:48:03.527

INSERT 语句不能有 WHERE 子句。

也许您打算执行更新？

```
UPDATE financial_statements
SET url = %s
WHERE provider=%s AND date=%s 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T21:48:11.903

`WHERE`在语句中使用是没有意义的`INSERT`——没有什么可以限制的。

如果要修改现有行，请使用`UPDATE`：

```
UPDATE financial_statements SET url=%s WHERE provider=%s and DATE=%s 
```

# javascript - 需要一个简单的叠加层或工具提示

> ID：10324297
> 
> 赞同：0
> 
> 时间：2012-04-25T21:47:24.930
> 
> 标签：javascript

我需要一个工具提示或覆盖来显示 onmouseover 和消失 onmouseout 显示单元格内的文本。我可以从单元格中取出文本没问题。我如何将其变成工具提示或叠加层？问题是这需要非常轻量级。没有 JQuery 库加载。Css 可以由 javascript 控制，因此除了 javascript 处理它之外没有 css 声明。有没有办法用几行代码来创建某种框（如果代码保持小，背景颜色会很好）出现在单元格文本的鼠标悬停上并在鼠标退出时消失？

```
<td onmouseover="this.value; what else here?"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:23:07.027

```
<td onmouseover="this.title = this.value;"> 
```

有几十种解决方案，但这是最简单的，这就是我正在寻找的。

# fullcalendar - 即时重新绘制fullCalendar

> ID：10324311
> 
> 赞同：7
> 
> 时间：2012-04-25T21:48:32.057
> 
> 标签：fullcalendar

我希望 fullCalendar 在不重新加载页面的情况下重绘自身（所有结构和事件）。

**场景：** 我正在使用一个支持[Resource View](http://www.ikelin.com/jquery-fullcalendar-resource-day-view/)的 fullCalendar 补丁。对于一些用户操作，我想更改资源。但我不想重新加载页面。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-26T01:39:39.920

您可以将日历作为一个整体“销毁”和“渲染”。但这可能很麻烦——尤其是在较旧的浏览器中。

```
$('#calendar').fullCalendar('destroy');
$('#calendar').fullCalendar('render'); 
```

如果您实际上不需要渲染表格，而只是重新渲染事件，则可以使用 'rerenderEvents' 方法：

```
$('#calendar').fullCalendar('rerenderEvents'); 
```

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-11T15:16:54.667

使用 refetchResources：`.fullCalendar( 'refetchResources' )`

[根据FullCalendar 文档](https://fullcalendar.io/docs/resource_data/refetchResources/)，这将获取并重新渲染资源数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-05T20:32:34.007

问题：

“...问题是日历已初始化，而模式或 div 不可见...”基于此链接[在此处输入链接描述](https://stackoverflow.com/questions/16994673/fullcalendar-not-visible-until-button-is-clicked-or-window-resized)

在我看来，这种情况下不需要销毁，只有使用渲染才能看到日历。

我的解决方案：

```
<script type="text/javascript">
    $('#objectname').show(0,onObjectShow);
    function onObjectShow(){$('#calendar').fullCalendar('render');}
</script> 
```

您必须确保对象（日历容器）完全可见。例如，我的第一个错误是将此代码放在“onClick”事件上，并且在显示对象容器之前触发了click事件并且没有效果。

解决方案基于此[参考](https://stackoverflow.com/questions/4948323/jquery-event-handler-div-becomes-visible-hidden)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-12T07:37:29.677

您还可以使用以下命令即时重绘日历 - $(window).trigger("resize");

# model-view-controller - CFWheels - 过滤器“除外”的问题。冲突的操作名称

> ID：10324320
> 
> 赞同：4
> 
> 时间：2012-04-25T21:48:53.840
> 
> 标签：model-view-controller, coldfusion, railo, cfwheels

我有一个过滤器设置，它运行一个检查用户会话是否存在于某些操作的函数，就像这样；

```
<cffunction name="init">

        <cfset filters(through="checkLogin", except="login,register,signin,create,home,profile") />

    </cffunction> 
```

问题是，这些是动作名称......与我拥有的其他控制器冲突。

例如，我有 2 个控制器“用户”和“链接”。其中每一个都有一个名为 create 的操作，因此我的 URL 如下所示：

/用户/创建/ /链接/创建/

过滤器如何知道与哪个控制器关联？有没有办法在“except”子句中为某些“动作”加上控制器名称的前缀？

例如，也许是这样的：

```
<cffunction name="init">

        <cfset filters(through="checkLogin", except="user/login,user/register,user/signin,link/create,main/home,user/profile") />

    </cffunction> 
```

我记得尝试过这个，但它没有用而且很糟糕。

希望你明白我在这里说什么。我不想为单独的控制器中的每个操作命名完全唯一的名称。

谢谢，迈克尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T13:39:58.930

您可以使用基本继承来完成此操作：

```
<!--- controllers/Controller.cfc --->
<cffunction name="init">
    <cfargument name="checkLoginExcept" type="string" required="false" default="">

    <cfset filters(through="checkLogin", except=arguments.checkLoginExcept)>
</cffunction> 
```

然后在任何子控制器（`user`例如）中，您可以指定要排除的操作。这很有效，因为父控制器应该对它的子控制器一无所知。它实现了它关心的东西，没有别的。

```
<!--- controllers/User.cfc --->
<cffunction name="init">
    <cfset super.init(checkLoginExcept="login,register,signIn,profile")>
</cffunction> 
```

如果另一个孩子*总是*想`checkLogin`运行，那么它不应该传递一个值 for `checkLoginExcept`：

```
<!--- controllers/Foo.cfc --->
<cffunction name="init">
    <cfset super.init()>
</cffunction> 
```

# mysql - MySQL - 使用 LIMIT 有效地将两个 select 语句组合成一个结果

> ID：10324321
> 
> 赞同：15
> 
> 时间：2012-04-25T21:49:02.230
> 
> 标签：mysql, database, select, join

对于约会应用程序，我有几个表需要查询单个输出，两个查询的 LIMIT 10 组合。目前似乎很难做到，即使单独查询它们不是问题，但 LIMIT 10 将不起作用，因为数字不准确（例如，不是 LIMIT 5 和 LIMIT 5，一个查询可能返回 0 行，而其他 10 个，视情况而定）。

```
members table
member_id | member_name
------------------------
     1         Herb
     2         Karen
     3         Megan

dating_requests
request_id | member1 | member2 | request_time
----------------------------------------------------
     1          1         2      2012-12-21 12:51:45

dating_alerts
alert_id | alerter_id | alertee_id | type | alert_time
-------------------------------------------------------
    5           3            2     platonic  2012-12-21 10:25:32

dating_alerts_status
status_id | alert_id | alertee_id | viewed | viewed_time
-----------------------------------------------------------
     4          5           2          0      0000-00-00 00:00:00 
```

假设您是 Karen 并且刚刚登录，您应该会看到以下 2 项：

```
1\. Herb requested a date with you.
2\. Megan wants a platonic relationship with you. 
```

在一个 LIMIT 为 10 的查询中。相反，这里有两个查询需要合并：

```
1\. Herb requested a date with you.
   -> query = "SELECT dr.request_id, dr.member1, dr.member2, m.member_name 
               FROM dating_requests dr 
               JOIN members m ON dr.member1=m.member_id 
               WHERE dr.member2=:loggedin_id 
               ORDER BY dr.request_time LIMIT 5";
2\. Megan wants a platonic relationship with you.
   -> query = "SELECT da.alert_id, da.alerter_id, da.alertee_id, da.type,
                      da.alert_time, m.member_name
               FROM dating_alerts da
               JOIN dating_alerts_status das ON da.alert_id=das.alert_id
                    AND da.alertee_id=das.alertee_id
               JOIN members m ON da.alerter_id=m.member_id
               WHERE da.alertee_id=:loggedin_id AND da.type='platonic'
                     AND das.viewed='0' AND das.viewed_time<da.alert_time 
               ORDER BY da.alert_time LIMIT 5"; 
```

同样，有时两个表都可能是空的，或者 1 个表可能是空的，或者都是满的（其中 LIMIT 10 开始）并按时间排序。关于如何获取查询以有效执行此任务的任何想法？欢迎提出想法、建议、提示、优化。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-25T22:53:37.633

您可以将多个查询与 结合起来[`UNION`](http://dev.mysql.com/doc/refman/5.6/en/union.html)，但前提是查询具有相同的列数。理想情况下，列是相同的，不仅在数据类型上，而且在它们的语义上；但是，MySQL 并不关心语义，而是通过转换为更通用的东西来处理不同的数据类型 - 因此，如果有必要，您*可以*重载列以使每个表具有不同的含义，然后确定在您的更高级别代码中合适的含义（虽然我不建议这样做）。

`SELECT`当列数不同时，或者当您希望从两个查询中获得更好/更少重载的数据对齐时，您可以在语句中插入虚拟文字列。例如：

```
SELECT t.cola, t.colb, NULL, t.colc, NULL FROM t; 
```

您甚至可以为第一个表保留一些列，为第二个表保留一些列，以便它们位于`NULL`其他位置（但请记住，列名来自第一个查询，因此您可能希望确保它们都在那里命名）：

```
 SELECT a, b, c, d, NULL AS e, NULL AS f, NULL AS g FROM t1
UNION ALL -- specify ALL because default is DISTINCT, which is wasted here
  SELECT NULL, NULL, NULL, NULL, a, b, c FROM t2; 
```

您可以尝试以这种方式对齐您的两个查询，然后将它们与`UNION`运算符组合；通过申请`LIMIT`，`UNION`您接近实现您的目标：

```
 (SELECT ...)
UNION
  (SELECT ...)
LIMIT 10; 
```

剩下的唯一问题是，如上所述，第一个表中的 10 条或更多记录将“推出”第二个表中的任何记录。但是，我们可以利用`ORDER BY`外部查询中的 an 来解决这个问题。

把它们放在一起：

```
(
  SELECT
    dr.request_time AS event_time, m.member_name,      -- shared columns
    dr.request_id, dr.member1, dr.member2,             -- request-only columns
    NULL AS alert_id, NULL AS alerter_id,              -- alert-only columns
      NULL AS alertee_id, NULL AS type
  FROM dating_requests dr JOIN members m ON dr.member1=m.member_id 
  WHERE dr.member2=:loggedin_id
  ORDER BY event_time LIMIT 10 -- save ourselves performing excessive UNION
) UNION ALL (
  SELECT
    da.alert_time AS event_time, m.member_name,        -- shared columns
    NULL, NULL, NULL,                                  -- request-only columns
    da.alert_id, da.alerter_id, da.alertee_id, da.type -- alert-only columns
  FROM
    dating_alerts da
    JOIN dating_alerts_status das USING (alert_id, alertee_id)
    JOIN members m ON da.alerter_id=m.member_id
  WHERE
    da.alertee_id=:loggedin_id
    AND da.type='platonic'
    AND das.viewed='0'
    AND das.viewed_time<da.alert_time
  ORDER BY event_time LIMIT 10 -- save ourselves performing excessive UNION
)
ORDER BY event_time
LIMIT 10; 
```

当然，现在由您决定在读取结果集中的每条记录时要处理的行类型（建议您测试`request_id`和/或`alert_id`获取`NULL`值；或者，可以在结果中添加一个额外的列，明确说明每条记录来自哪个表，但如果这些`id`列是`NOT NULL`)，它应该是等效的。

# java - 多个应用程序中的内存泄漏

> ID：10324325
> 
> 赞同：6
> 
> 时间：2012-04-25T21:49:21.417
> 
> 标签：java, mysql, hibernate, solr, c3p0

我在 Tomcat 6.0.35 服务器中的两个应用程序中出现内存泄漏，这些应用程序“突然出现”。一个应用程序是 Solr，另一个是我们自己的软件。我希望有人以前见过这种情况，因为过去几周我一直在发生这种情况，我必须在生产环境中不断重启 Tomcat。

尽管没有触及任何与线程或数据库连接操作相关的代码，但它出现在我们的原始服务器上。由于运行此应用程序的旧服务器即将退役，因此我将站点迁移到新服务器和“更清洁”的环境，其想法是清除任何遗留内容。但它继续发生。

就在 Tomcat 关闭之前，catalina.out 日志充满了如下错误：

> 2012-04-25 21:46:00,300 [main] 错误 org.apache.catalina.loader.WebappClassLoader- Web 应用程序 [/AppName] 似乎已经启动了一个名为 [MultiThreadedHttpConnectionManager cleanup] 的线程，但未能阻止它。这很可能造成内存泄漏。
> 
> 2012-04-25 21:46:00,339 [main] 错误 org.apache.catalina.loader.WebappClassLoader-Web 应用程序 [/AppName] 似乎已经启动了一个名为 [com.mchan ge.v2.async.ThreadPoolAsynchronousRunner$ 的线程PoolThread-#2] 但未能阻止它。这很可能造成内存泄漏。
> 
> 2012-04-25 21:46:00,470 [main] 错误 org.apache.catalina.loader.WebappClassLoader-Web 应用程序 [/AppName] 仍在处理尚未完成的请求。这很可能造成内存泄漏。您可以使用标准上下文实现的 unloadDelay 属性来控制请求完成的时间。

在迁移期间，我们从 Solr 1.4->Solr 3.6 尝试解决问题。当上面的错误开始填充日志时，下面的 Solr 错误紧随其后，重复了 10-15 次，然后 tomcat 停止工作，我必须关闭并启动才能让它响应。

> 2012-04-25 21:46:00,527 [main] 错误 org.apache.catalina.loader.WebappClassLoader-Web 应用程序 [/solr] 创建了一个 ThreadLocal，其键类型为 [org.a pache.solr.schema.DateField。 ThreadLocalDateFormat]（值 [org.apache.solr.schema.DateField$ThreadLocalDateFormat@1f1e90ac]）和类型 [org.apache.solr. schema.DateField.ISO8601CanonicalDateFormat] （值 [org.apache.solr.schema.DateField$ISO8601CanonicalDateFormat@6b2ed43a]）但在 web 应用程序停止时无法将其删除。这很可能造成内存泄漏。

我的研究提出了很多关于更改管理线程的代码以确保它们杀死数据库池连接等的建议，但该代码在近 12 个月内没有更改。Solr 应用程序也崩溃了，这是第 3 方，所以我的想法是这是环境问题（jar 冲突、版本控制、配置胖手指？）

我的最后一个更改是将用于 java 的 mysql 连接器更新到最新版本，因为在早期版本中池中存在一些内存泄漏错误，但服务器仅在几个小时后再次崩溃。

我刚刚注意到的一件事是我在 Tomcat Web 管理器中看到了数千个会话，但这可能是一个红鲱鱼。

如果有人看到这个，任何帮助都非常感谢。

[编辑]

我想我找到了问题的根源。毕竟这不是内存泄漏。我已经从另一个开发团队接管了一个应用程序，该团队使用[c3p0](http://www.mchange.com/projects/c3p0/index.html#basic_pool_configuration)通过 Hibernate 进行数据库池。c3p0 有一个错误/功能，如果您不释放数据库连接，一旦使用了所有连接（通过 MaxPoolSize：默认为 15），c3p0 可以进入等待状态。它将无限期地等待连接可用。因此我的摊位。

我首先将 MaxPoolSize 从 25->100 提高，我的应用程序运行了几天而没有挂起，然后从 100->1000 开始，从那以后它一直稳定运行（超过 2 周）。

这不是完整的解决方案，因为我需要找出它耗尽池连接的原因，因此我还将 c3p0 的 unreturnedConnectionTimeout 设置为 4 小时，这对所有连接强制执行 4 小时的时间限制，无论它们是否处于活动状态。如果它是一个活动连接，它将关闭它并重新打开。

不漂亮，c3p0 不推荐它，但它给了我一些喘息的空间来找出问题的根源。

注意：当 c3p0 与 Hibernate 一起使用时，设置存储在您的 persistence.xml 文件中，但并非所有设置都可以放在那里。某些设置（例如 unreturnedConnectionTimeout）必须进入[c3p0.properties](http://www.mchange.com/projects/c3p0/index.html#hibernate-specific)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T00:00:50.660

您声明事件的顺序是：

*   出现错误
*   Tomcat 停止响应
*   需要重启

但是，只有在 Web 应用程序停止时才会报告内存泄漏错误消息。因此，某些事情正在触发 Web 应用程序停止（或重新加载）。你需要弄清楚是什么触发了它并阻止它。

关于实际泄漏，您可能会发现这很有用：

[http://people.apache.org/~markt/presentations/2010-11-04-Memory-Leaks-60mins.pdf](http://people.apache.org/~markt/presentations/2010-11-04-Memory-Leaks-60mins.pdf)

看起来您的应用程序和 Solr 都有一些需要修复的漏洞。演示文稿将为您提供一些指导。我还会考虑升级到最新的 7.0.x。内存泄漏检测已得到改进，但并非所有改进都已进入 6.0.x。

# android - proguard 注意：程序类 com.facebook.android.R.string 的重复定义我该如何解决这个问题？

> ID：10324331
> 
> 赞同：1
> 
> 时间：2012-04-25T21:49:40.427
> 
> 标签：android, proguard

如何解决来自 proguard 的此注释。重复定义的含义是什么？我需要解决这个问题吗？如果需要，如何解决？我还看到：

```
[proguard] Note: there were 625 duplicate class definitions.
[proguard] Initializing...
[proguard] Note: the configuration refers to the unknown class      'com.android.vending.licensing.ILicensingService' 
```

我还看到：

```
 [proguard] Reading program jar [/GoogleAdMobAdsSdk-4.3.1.jar]
  [proguard] Note: duplicate definition of program class [com.google.ads.Ad] etc. 
```

取出

```
 injars  bin/classes 
```

帮助减少到 200 个班级。但是对于我所包含的每个库 jar，我都看到了上述内容。谷歌分析 jar 文件也是如此。

我看到：

```
 [proguard] Note: duplicate definition of program class [com.test.activities.MyActivity] 
```

MyActivity 只出现在我的一个项目中......我该如何摆脱这个？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-18T09:18:14.187

Proguard[手册](http://proguard.sourceforge.net/index.html#manual/troubleshooting.html)指出以下内容：

> **注意：程序/库类的重复定义**
> 
> 您的程序 jar 或库 jar 包含列出的类的多个定义。ProGuard 像往常一样继续处理，只考虑第一个定义。该警告可能表明存在某些问题，因此建议删除重复项。一种方便的方法是在输入 jar 或库 jar 上指定过滤器。您可以通过指定 -dontnote 选项来关闭这些注释。

以我的经验，并不是你有多个类定义，而是你需要更好地配置 proguard。无论如何，这不是一个大问题，事情可能会正常工作。

# assembly - printf 在 x86-64 上是否需要额外的堆栈空间？

> ID：10324333
> 
> 赞同：3
> 
> 时间：2012-04-25T21:49:46.760
> 
> 标签：assembly, x86, printf, x86-64

虽然我知道最好使用编译器内在函数，并且就此而言，`printf_chk`以及将数据放在`.rodata`部分中，但我正在寻求更深入地了解汇编语言并对紧凑代码感兴趣。有一点`printf`我不明白。我知道将参数放在哪里，并且我知道如何使用`%al`可变参数，但它似乎需要额外的堆栈空间，我无法解释。

这个小程序

```
 .text
        .globl  main
main:
        movsd   value(%rip), %xmm0    # value to print
        movl    $format, %edi         # format string
        movl    $1, %eax              # one floating-point arg
        call    printf
        movl    $0, %eax              # return 0 from main
        ret
        .align 8
value:  .double 74.321 
format: .asciz "%g\n" 
```

给出一个段错误。

但是，当我向框架添加额外的堆栈空间时，它可以正常工作：

```
 .text
        .globl  main
main:
        subq    $8, %rsp              # ADD SOME STACK SPACE TO FRAME (WHY?)
        movsd   value(%rip), %xmm0    # value to print
        movl    $format, %edi         # format string
        movl    $1, %eax              # one floating-point arg
        call    printf
        movl    $0, %eax              # return 0 from main
        addq    $8, %rsp              # REMOVE ADDED STACK SPACE
        ret
        .align 8
value:  .double 74.321 
format: .asciz "%g\n" 
```

会不会是对齐问题？`value`（当和`format`在一个部分时，我遇到了同样的问题`.rodata`。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:42:31.347

根据 www.x86-64.org/documentation/abi.pdf 和 Microsoft 的[http://msdn.microsoft.com/en-us/library/ms235286(v=vs. 80).aspx](http://msdn.microsoft.com/en-us/library/ms235286(v=vs.80).aspx)

# performance - 最快的 OpenCV 2 OpenGL 上下文

> ID：10324337
> 
> 赞同：2
> 
> 时间：2012-04-25T21:50:19.077
> 
> 标签：performance, opengl, opencv, fbo

我已经在网上搜索了几天，寻找最快的方法来捕获 OpenCV 网络摄像头并将其显示在 OpenGL 上下文中。到目前为止，这似乎工作正常，直到我需要缩放。

```
void Camera::DrawIplImage1(IplImage *image, int x, int y, GLfloat xZoom, GLfloat yZoom)
{
    GLenum format;
        switch(image->nChannels) {
            case 1:
                format = GL_LUMINANCE;
                break;
            case 2:
                format = GL_LUMINANCE_ALPHA;
                break;
            case 3:
                format = GL_BGR;
                break;
            default:
                return;
        }

    yZoom =- yZoom;
        glRasterPos2i(x, y);
        glPixelZoom(xZoom, yZoom);  //Slow when not (1.0f, 1.0f);
        glDrawPixels(image->width, image->height, format, GL_UNSIGNED_BYTE, image->imageData);
} 
```

我听说也许采用 FBO 方法会更快。关于以最快的方式将 OpenCV 网络摄像头捕获到 OpenGL 上下文的任何想法。我将测试我看到的所有内容并发布结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T18:49:58.893

您确定您的 openGL 实现需要 ^2 纹理吗？即使是非常糟糕的 PC 实现（是的英特尔）现在也可以管理任意大小。

那么最快的可能是使用openGL像素缓冲区抱歉代码来自Qt，所以函数名称略有不同但顺序相同

分配opengl纹理

```
glEnable(GL_TEXTURE_2D);
glGenTextures(1,&texture);

glBindTexture(GL_TEXTURE_2D,texture);       
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);          
glTexImage2D(GL_TEXTURE_2D, 0, glFormat, width, height, 0, glFormatExt, glType, NULL ); 

glDisable(GL_TEXTURE_2D); 
```

现在获取指向纹理的指针以使用内存

```
glbuffer.bind();
unsigned char *dest = (unsigned char*)glbuffer.map(QGLBuffer::ReadWrite);
// creates an openCV image but the pixel data is stored in an opengl buffer
cv::Mat opencvImage(rows,cols,CV_TYPE,dest);  
.... do stuff ....
glbuffer.unmap(); // pointer is no longer valid - so neither is openCV image 
```

然后绘制它 - 这应该基本上是即时的，因为数据在上面的映射调用中被复制到 GPU

```
glBindTexture(GL_TEXTURE_2D,texture);                       
glTexSubImage2D(GL_TEXTURE_2D, 0, 0,0, width, height, glFormatExt, glType, 0);                                                                                  
glbuffer.release(); 
```

通过为 glFormat 和 glFormatExt 使用不同的类型，您可以让显卡在硬件中自动在 opencVs BGR 和典型的 RGBA 显示格式之间进行转换。

# ruby-on-rails - 为什么rails找不到我的扫地机？

> ID：10324338
> 
> 赞同：1
> 
> 时间：2012-04-25T21:50:20.563
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sweeper

我的控制器上有：

```
class FormulariosController < ApplicationController
    cache_sweeper :campanha_sweeper, :only => [:show]

    # actions
end 
```

我尝试在应用程序中创建一个名为 /sweepers 的目录，但没有成功，我尝试在模型内部创建一个 /cache 文件夹（有一个博客以此为例），但没有成功。

我的扫地机是这样的：

```
class CampanhaSweeper < ActionController::Caching::Sweeper
  observe Campanha

  def after_update(campanha)
    expire_cache_for(campanha)
  end

  private
  def expire_cache_for(campanha)
    expire_page(:controller => 'formularios', :action => 'show')

    ap "Expired cache for formularios#show in formulariosweeper"
  end 
```

结尾

我在尝试启动服务器时得到以下信息：

```
/Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.0.12/lib/action_controller/caching/sweeping.rb:41:in `const_get': uninitialized constant CampanhaSweeper (NameError)
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.0.12/lib/action_controller/caching/sweeping.rb:41:in `block in cache_sweeper'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.0.12/lib/action_controller/caching/sweeping.rb:39:in `each'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.0.12/lib/action_controller/caching/sweeping.rb:39:in `cache_sweeper'
    from /Users/thiagomassa/Projects-ginga/ginga-campanhas/app/controllers/formularios_controller.rb:2:in `<class:FormulariosController>'
    from /Users/thiagomassa/Projects-ginga/ginga-campanhas/app/controllers/formularios_controller.rb:1:in `<top (required)>'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/engine.rb:138:in `block (2 levels) in eager_load!'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/engine.rb:137:in `each'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/engine.rb:137:in `block in eager_load!'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/engine.rb:135:in `each'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/engine.rb:135:in `eager_load!'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/application.rb:108:in `eager_load!'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/application/finisher.rb:41:in `block in <module:Finisher>'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/initializable.rb:25:in `instance_exec'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/initializable.rb:25:in `run'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/initializable.rb:50:in `block in run_initializers'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/initializable.rb:49:in `each'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/initializable.rb:49:in `run_initializers'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/application.rb:134:in `initialize!'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/application.rb:77:in `method_missing'
    from /Users/thiagomassa/Projects-ginga/ginga-campanhas/config/environment.rb:5:in `<top (required)>'
    from /Users/thiagomassa/Projects-ginga/ginga-campanhas/config.ru:3:in `block in <main>'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/rack-1.2.5/lib/rack/builder.rb:46:in `instance_eval'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/rack-1.2.5/lib/rack/builder.rb:46:in `initialize'
    from /Users/thiagomassa/Projects-ginga/ginga-campanhas/config.ru:1:in `new'
    from /Users/thiagomassa/Projects-ginga/ginga-campanhas/config.ru:1:in `<main>'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/rack-1.2.5/lib/rack/builder.rb:35:in `eval'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/rack-1.2.5/lib/rack/builder.rb:35:in `parse_file'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/rack-1.2.5/lib/rack/server.rb:162:in `app'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/rack-1.2.5/lib/rack/server.rb:253:in `wrapped_app'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/rack-1.2.5/lib/rack/server.rb:204:in `start'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/commands/server.rb:65:in `start'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/commands.rb:30:in `block in <top (required)>'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/commands.rb:27:in `tap'
    from /Users/thiagomassa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.12/lib/rails/commands.rb:27:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

为什么它不起作用？此外，是否有任何方法可以使仅视图（其呈现方式）的缓存过期。我正在动态生成视图，如果我可以使位于views/formularios/a.html.rb 的视图的缓存过期，这将非常有用

如果人们想知道我在做什么，这很简单。我使用表单生成视图，当我想更新该视图（或它的代码）并且我在生产中时，视图由于缓存而没有更新，所以我每次“更新”表单时都必须手动重置它的缓存.

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:54:20.607

您是否将`sweepers`目录（或您放置清扫器代码的位置）添加到您的`autoload_paths`in `application.rb`？

# xcode - 标签栏控制器+导航控制器上的导航栏布局问题

> ID：10324342
> 
> 赞同：0
> 
> 时间：2012-04-25T21:50:36.657
> 
> 标签：xcode, uinavigationcontroller, uitabbarcontroller, uinavigationbar

我遵循了如何在第一个选项卡中创建一个带有导航控制器的简单选项卡栏控制器。直到这里一切正常，预计布局上会出现一个奇怪的问题。当应用程序第一次启动时，第一个加载的 nib 顶部的导航栏有点在视图之外。我无法弄清楚为什么会发生这种情况。在第一个视图中，有一个“添加新系统”按钮可以打开模式视图。如果我按下此按钮并出现模态视图，然后我关闭模态返回初始视图，则顶部的导航栏将正确放置/刷新。如果我按下第二个 TAB（现在它是一个没有导航控制器的简单笔尖）然后回到第一个 TAB，也会发生同样的情况，导航栏被放置在正确的位置。这是第一次启动的屏幕截图：

![启动](../Images/b47afe5023c79548feb8083b036b15b4.png)

在这里，当我按下模态视图或第二个 TAB 然后回到第一个视图时：

![后](../Images/1277341d7bd138f54c7b918851bc4f7d.png)

遵循网上众多教程之一，代码很简单。我没有使用故事板。只有自定义是在导航栏顶部添加按钮：

```
UIImage *editbuttonImage = [UIImage imageNamed:@"edit_pressed.png"];
UIButton *editButton = [UIButton buttonWithType:UIButtonTypeCustom];
[editButton setBackgroundImage:editbuttonImage forState:UIControlStateNormal];
editButton.frame = CGRectMake(0, 0, editbuttonImage.size.width, editbuttonImage.size.height);
[editButton addTarget:self action:@selector(leaveEditMode) 
       forControlEvents:UIControlEventTouchUpInside];

self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] 
                                          initWithCustomView:editButton];

[editButton release];
[editbuttonImage release]; 
```

没有进行其他修改。笔尖以前在单个视图中使用过。然后我尝试将其插入 TAB 控制器 + 导航控制器。如果需要，我可以发布整个代码。在选择系统下有一个表格视图，在这些图片中是空的，也没有显示。

谢谢您的帮助！

西蒙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T13:14:48.517

我自己解决了这个问题。在启动时，我已设置隐藏状态栏并在应用程序委托中再次显示。使用的指令：

`[[UIApplication sharedApplication] setStatusBarHidden:NO];`

是**在**将 navController 添加为子视图之后。导航控制器 BAR 也没有超出视图，只是在状态栏下方。

希望这可以帮助某人:)

干杯，西蒙

# mysql - 简单的codeigniter查询+结果显示不会显示

> ID：10324343
> 
> 赞同：0
> 
> 时间：2012-04-25T21:50:45.950
> 
> 标签：mysql, codeigniter, codeigniter-2

我正在尝试在 Codeigniter 视图中显示我的数据库中的数据。似乎它应该很简单，但它只是行不通。

我收到 2 个错误：未定义的变量（$movielist，在视图中）和 php foreach 的无效参数，也在视图中。

知道我怎样才能让它工作吗？代码如下。

**控制器**

```
function displayMovies() {

$this->load->model('movie_list_model');

$data['movielist'] = $this->movie_list_model->getList();

$this->load->view('movielist_view', $data);
} 
```

**模型**

```
function getList() {

        $query = $this->db->query('SELECT firstname, lastname, favorite_movie FROM movies');
        return $query->result();

        if ($query->num_rows() > 0) {

        foreach ($query->result_array() as $row)
        {
             echo $row['firstname'];
             echo $row['lastname'];
             echo $row['favorite_movie'];
        }   
    } 
```

**看法**

```
 <?php foreach($movielist as $mlist)
        {
            echo  $mlist->firstname . '<br />'; 
            echo  $mlist->lastname . '<br />'; 
            echo  $mlist->favorite_movie; 
        }
      ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:01:58.447

if( 查询没有找到任何行，它会返回`null`，导致`undefined`你视图中的错误。无效参数错误是因为你不能遍历`null`。

在您看来，安全性将包括以下内容：

```
if($movielist)
{
    /* foreach() {} */
} 
```

此外，您的模型应该只返回数据（而不是回显它）。

```
function getList() {
    $query = $this->db->query('SELECT firstname, lastname, favorite_movie FROM movies');
    return $query->result(); /* returns an object */
    // Alternatively:
    // return $query->result_array(); /* returns an array */
} 
```

我还建议使用[活动记录](http://codeigniter.com/user_guide/database/active_record.html)：

```
function getList() {
    $this->db->select('firstname');
    $this->db->select('lastname');
    $this->db->select('favorite_movie');

    $query = $this->get('movies');
    return $query->result();
} 
```

祝你好运！

# javascript - 这 === 对浮点舍入不准确不起作用吗？

> ID：10324348
> 
> 赞同：1
> 
> 时间：2012-04-25T21:50:53.710
> 
> 标签：javascript, floating-point

假设我有这个片段。

```
var age = prompt('what is your age?');

if (age === 30)
{
alert('your age is 30');
} 
```

当我在提示符中输入 30 时，if 语句不会触发。我怀疑它与浮点舍入错误有关，但并不确定。很高兴听到您对此的想法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T21:51:44.590

`window.prompt()`返回一个字符串。字符串与数字不同。使用以下任一：

```
if (age === '30') 
if (+age === 30)  // Explicit type conversion
if (age == 30)    // Implicit type conversion 
```

有关显式转换的说明，请参阅[此答案](https://stackoverflow.com/a/8112802/938089?are-there-are-any-side-effects-of-using-this-method-to-convert-a-string-to-an-i)。例如，输入的`00030`也可能是有效的。

# asp.net - 外键表字段未显示在独立的动态数据启用列表视图中

> ID：10324350
> 
> 赞同：2
> 
> 时间：2012-04-25T21:50:56.697
> 
> 标签：asp.net, dynamic-data, asp.net-dynamic-data

在过去的几天里，我浏览了数百个谷歌结果页面，试图找到答案。

使用独立的动态数据页面显示表，使用 EntityDataSource，其中一个字段是子表的外键。我希望它显示子表中的值。我一直在玩一个使用 NorthWinds 数据库的简化案例（见下面的代码）。如果我为 DynamicControl 分配一个 DataField="Supplier"，它会改为显示子表/类名称 ("DAL.Supplier")。如果我尝试分配 DataField="Supplier.CompanyName"，则会出现“表 'Product' 没有名为 'Supplier.CompanyName' 的列”的错误。因为我想利用动态数据的编辑功能，所以使用带有 <%# Eval("Supplier.CompanyName") %> 的模板化字段已经过时了。

这对于独立的动态数据页面是不可能的吗？它在一个完全脚手架的系统中显然可以正常工作。还是我（希望）只是错过了什么？谢谢你。

测试.aspx

```
<%@ Page Title="" Language="VB" MasterPageFile="~/Master/Site.master" AutoEventWireup="false" CodeFile="Test.aspx.vb" Inherits="Test" %>
<asp:Content ID="Content3" ContentPlaceHolderID="BodyContent" Runat="Server">

<asp:ListView ID="ListView1" runat="server" DataSourceID="theDataSource" DataKeyNames="ProductID">
    <ItemTemplate>
        <tr>
            <td>
                <asp:DynamicControl runat="server" DataField="ProductID" Mode="Edit" />
            </td>
            <td>
                <asp:DynamicControl runat="server" DataField="ProductName" Mode="Edit" />
            </td>
            <td>
                <asp:DynamicControl runat="server" DataField="Supplier" Mode="Edit" />
            </td>
            <td>
                <asp:DynamicControl runat="server" DataField="UnitPrice" Mode="Edit" />
            </td>
            <td>
                <asp:DynamicControl runat="server" DataField="Discontinued" Mode="Edit" />
            </td>
        </tr>
    </ItemTemplate>
    <LayoutTemplate>
        <table runat="server">
            <tr runat="server">
                <td runat="server">
                    <table id="itemPlaceholderContainer" runat="server" border="0">
                        <tr runat="server">
                            <th runat="server">
                                ProductID
                            </th>
                            <th runat="server">
                                ProductName
                            </th>
                            <th runat="server">
                                Supplier
                            </th>
                            <th runat="server">
                                UnitPrice
                            </th>
                            <th runat="server">
                                Discontinued
                            </th>
                        </tr>
                        <tr id="itemPlaceholder" runat="server">
                        </tr>
                    </table>
                </td>
            </tr>
            <tr runat="server">
                <td runat="server">
                </td>
            </tr>
        </table>
    </LayoutTemplate>
</asp:ListView>

<asp:EntityDataSource ID="theDataSource" runat="server" 
        ConnectionString="name=NorthwindEntities" 
        DefaultContainerName="NorthwindEntities" EnableDelete="True" 
        EnableFlattening="False" EnableInsert="True" EnableUpdate="True" 
        Include="Supplier"
        EntitySetName="Products">
    </asp:EntityDataSource>
</asp:Content> 
```

测试.aspx.vb

```
Imports System.Web.DynamicData
Imports DAL

Partial Class Test
Inherits System.Web.UI.Page

Protected table As MetaTable

Protected Sub Page_Init(sender As Object, e As System.EventArgs) Handles Me.Init
    Listview1.EnableDynamicData(GetType(Product))
    table = theDataSource.GetTable()
    Title = table.DisplayName   
End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T14:10:48.283

问题解决了。当所有这一切开始时，我最初收到了错误消息：

> 无法确定 MetaTable。无法为数据源“EntityDataSource1”确定 MetaTable，也无法从请求 URL 中推断出 MetaTable。确保表映射到数据源，或者数据源配置了有效的上下文类型和表名，或者请求是注册的 DynamicDataRoute 的一部分

试图追踪它导致我摆脱了 asp:DynamicDataManager 标记，并在代码隐藏中将其替换为：

```
Listview1.EnableDynamicData(GetType(Product))
table = theDataSource.GetTable() 
```

事实证明，这让我陷入了众所周知的兔子洞......虽然它摆脱了 MetaTable 错误，但它无意中导致了我在上面写的问题。非常感谢：[http](http://daviworld.net/?tag=/DynamicDataManager) ://daviworld.net/?tag=/DynamicDataManager指出此错误消息实际上是由以下原因引起的：

> 这是由于 Designer 代码生成问题。当您为 GridView 控件选择数据源时，它不会将 ContextTypeName 属性添加到 EntityDataSourceControl。

一旦我删除了上面的代码行，并在 asp:DynamicDataManager 中重新添加到标记中，然后将 ContextTypeName="DAL.NorthwindEntities" 添加到 EntitiyDataSource，现在一切都可以正常工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T23:03:01.300

是的，你说的是真的。我在你被卡住的同一个地方。我从柱子跑到柱子，肚子里着火，但我想它可能很快就会熄灭。

怎么会搞砸到你不能在脚手架机制之外工作，你真正做的就是借用一个动态数据管理器，这样你就可以在他们的框架和你新添加的框架中保持模板化。

我进入这个洞的方式是当我尝试在同一页面上显示多个实体数据时。规则的拇指似乎是单个实体，单个页面。不管我现在有什么错误。在我再次打开瓶子之前再给它几天……让啤酒来吧！

# c# - 让构造函数改变对象类型

> ID：10324351
> 
> 赞同：1
> 
> 时间：2012-04-25T21:51:04.167
> 
> 标签：c#, constructor

我的代码使用了一个带有基类的列表，我稍后将其转换为它们各自的派生类型。我达到了一个点，我认为我可以为基类创建一个构造函数，该构造函数将确定它应该是什么类型并将其自身更改为该类型。像这样的东西：

```
 public class BaseClass
    {
        // Constructor
        BaseClass(string Input)
        {
            if (Input.Substring(0, 5) == "Something")
                return new DerivedClass(); // <-- Not allowed
        }
    }
    public class DerivedClass : BaseClass
    {
    } 
```

这是不允许的，因为构造函数必须返回 void。似乎也不允许更改“this”的类型。我知道这个代码有非常简单的替代方案，但我认为它有一定的优雅，你不觉得吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T21:51:57.163

您应该研究工厂模式。当您想要创建对象的实例但允许根据其他参数确定特定类型时使用它。

```
public static class BaseClassFactory
{
    public static BaseClass Create(string input)
    {
        if (input.Substring(0, 5) == "Something")
            return new DerivedClass();

        return new BaseClass();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T21:58:24.387

我也推荐[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)，但写的不同。这可以防止创建 BaseClass `new`，因此获取类的唯一选择是通过该`Create`方法。

```
public class BaseClass
{
  private BaseClass()
  {
  }

  public static BaseClass Create(string input)
  {
    if (input.Substring(0, 5) == "Something")
      return new DerivedClass();

    return new BaseClass();
  }
} 
```

# javascript - JavaScript 加载和 DOM

> ID：10324352
> 
> 赞同：3
> 
> 时间：2012-04-25T21:51:16.943
> 
> 标签：javascript, dom, onload-event

我有这个示例文档：

```
<html>
    <body>
        <script type="text/javascript">
            document.body.onload = myFunc();

            function myFunc() {
                element = document.getElementById('myDiv');
                element.innerHTML = 'Hello!';
            }
        </script>
        <div id="myDiv"></div>
    </body>
</html> 
```

`myFunc`如果是回调，为什么“元素”为空`document.body.onload`？

相反，如果在 div 之后插入脚本，它可以工作：

```
<html>
    <body>
        <div id="myDiv"></div>
        <script type="text/javascript">
            document.body.onload = myFunc();

            function myFunc() {
                element = document.getElementById('myDiv');
                element.innerHTML = 'Hello!';
            }
        </script>
    </body>
</html> 
```

我的问题是：如果我`onload`在处理函数中使用事件，我是否应该拥有整个 DOM？为什么我不应该？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:53:03.087

问题是您正在立即调用该函数（并分配其返回值）。

而是分配函数，它将起作用：

```
document.body.onload = myFunc; 
```

您还应该`var element`在函数中使用以避免创建全局变量。

* * *

或者，如果您想迷惑人们：

```
document.body.onload = myFunc();
function myFunc() {
    return function() {
        var element = document.getElementById('myDiv');
        element.innerHTML = 'Hello!';
    };
} 
```

但我们**不要**那样做。这里没有任何意义。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:52:19.117

改用这个

```
document.body.onload = myFunc; 
```

或者

```
document.body.onload = function() {
    myFunc();
}; 
```

# java - 如何将 16 位 PCM 音频字节数组转换为双精度或浮点数组？

> ID：10324355
> 
> 赞同：10
> 
> 时间：2012-04-25T21:51:29.700
> 
> 标签：java, android, fft

我正在尝试对 .3gpp 音频文件执行快速傅立叶变换。该文件包含来自手机麦克风的 44100kHz 的 5 秒小录音。

由于显而易见的原因，我能找到的每个 Java FFT 算法都只需要 double[]、float[] 或 Complex[] 输入，但我正在以字节数组的形式读取音频文件，所以我有点困惑我从这里去哪里。我唯一能找到的是上一个问题的答案：

[Android音频FFT使用audiorecord检索特定频率幅度](https://stackoverflow.com/questions/5774104/android-audio-fft-to-retrieve-specific-frequency-magnitude-using-audiorecord)

但我不确定这是否是正确的程序。有任何见解的人吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-25T23:39:05.460

没有替代。您必须运行一个循环并分别转换数组的每个元素。

我对作为浮动的短裤做同样的事情：

```
public static float[] floatMe(short[] pcms) {
    float[] floaters = new float[pcms.length];
    for (int i = 0; i < pcms.length; i++) {
        floaters[i] = pcms[i];
    }
    return floaters;
} 
```

### 根据评论编辑 2012 年 4 月 26 日

如果您确实有 16 位 PCM 但将其作为一个字节 []，那么您可以这样做：

```
public static short[] shortMe(byte[] bytes) {
    short[] out = new short[bytes.length / 2]; // will drop last byte if odd number
    ByteBuffer bb = ByteBuffer.wrap(bytes);
    for (int i = 0; i < out.length; i++) {
        out[i] = bb.getShort();
    }
    return out;
} 
```

然后

```
float[] pcmAsFloats = floatMe(shortMe(bytes)); 
```

除非您正在使用一个奇怪且设计糟糕的类，该类首先为您提供了字节数组，否则该类的设计者应该将字节打包以与 Java 将字节（一次 2 个）转换为短裤的方式一致。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-04-25T23:40:04.697

```
byte[] yourInitialData;
double[] yourOutputData = ByteBuffer.wrap(bytes).getDouble() 
```

# jquery - 这个 jQuery 表单帖子有什么问题？

> ID：10324364
> 
> 赞同：0
> 
> 时间：2012-04-25T21:52:11.013
> 
> 标签：jquery, ajax, asp.net-mvc

我有一个表单，我试图用 Ajax / 提交而不重新加载页面。

Ajax 调用正在访问服务器，但它似乎没有调用该函数。我都试过了`$.post`和`$.ajax`。两者似乎都不起作用。几周前我有一些非常相似的工作，但现在我无法复制它。（最终目标是将模型作为局部视图返回，以便查看验证。）

使用 Firefox，控制器方法立即被命中。使用 Chrome，浏览器选项卡似乎被锁定。它有时会在延迟后击中控制器。（模型信息准确地过来了。）

我在这里做错了什么？

我在这里有我的部分观点：

```
<% using (Ajax.BeginForm("CreateSimpleReport", "Main", new AjaxOptions { HttpMethod="POST" }, new { id="CreateSimpleReport" })){ %>
   <%: Html.ValidationSummary(false, "Report creation was unsuccessful. Please correct the errors and try again.", new { @class = "validation_summary" })%>
   <% Html.EnableClientValidation(); %>
   <div class="col">
<div class="row">
    <div class="label">
        <%: Html.LabelFor(m => m.Name)%>
    </div>
    <div class="field">
        <%: Html.TextBoxFor(m => m.Name, new { @class = "input texbox" })%>
        <%: Html.ValidationMessageFor(m => m.Name, "*")%>
    </div>
</div>
<div class="row">
    <div class="label">
        <%: Html.LabelFor(m => m.Description)%>
    </div>
    <div class="field">
        <%: Html.TextBoxFor(m => m.Description, new { @class = "input texbox" })%>
        <%: Html.ValidationMessageFor(m => m.Description, "*")%>
    </div>
</div>
<div class="row">
    <div class="label">
        <%: Html.LabelFor(m => m.Quantity)%>
    </div>
    <div class="field">
        <%: Html.TextBoxFor(m => m.Quantity, new { @class = "input texbox" })%>
        <%: Html.ValidationMessageFor(m => m.Quantity, "*")%>
    </div>
</div>
<div class="right"><input type="submit" class="button" value="Create Report" /></div>
</div>
<% } %> 
```

控制器：

```
[HttpPost]
public string CreateSimpleReport(SimpleReportModel model)
{
    if (ModelState.IsValid)
    {
        // do something
        return "success";
    }
    else
    {
        return "failure";
    }
} 
```

最后，jQuery：

```
 $('#CreateSimpleReport').on('submit', function (e) {
            var $this = $(this);
            $.post((this), (this), function(data) {
                alert('finish');
            });
//            $.ajax({
//                type: 'POST',
//                url: (this),
//                data: (this),
//                success: function () {
//                    alert('success');
//                },
//                error: function (jqXHR, textStatus, errorThrown) {
//                    alert('error');
//                }
//            }); // end ajax call
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T06:01:14.330

您不应该将`Ajax.*`助手与`jQuery.ajax`. 如果您使用 Ajax.BeginForm 帮助程序，则只需包含`jquery.unobtrusive-ajax.js`脚本 (ASP.NET MVC 3) 或`MicrosoftAjax.js`和`MicrosoftMvcAjax.js`脚本 (ASP.NET MVC 2) 并订阅`AjaxOptions`.

如果您决定手动使用 jQuery.ajax，则使用标准 Html.BeginForm：

```
<% using (Html.BeginForm("CreateSimpleReport", "Main", FormMethod.Post, new { id = "CreateSimpleReport" })) { %> 
```

进而：

```
$(function() {
    $('#CreateSimpleReport').on('submit', function() {
        $.ajax({
            url: this.action,
            type: this.method,
            data: $(this).serialize(),
            success: function(result) {
                alert('AJAX success');
            }
        });

        // make sure you return false to cancel the default event
        return false;
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:56:08.107

```
$.post((this), (this) 
```

*这*（没有双关语）没有意义。您也不能 POST 到参数为 DOM 元素的 DOM 元素。除此之外，您需要`e.preventDefault();`（或`return false;`）避免定期提交表单。因此，当您的回调触发时，页面已经重新加载。

通过 AJAX 提交表单的最简单方法是使用[**jQuery 表单插件**](http://jquery.malsup.com/form/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:03:52.177

你已经在使用了`Ajax.BeginForm`，为什么还需要 jQuery 脚本来做 ajax？

你包括了`jquery.unobtrusive-ajax.js`吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T08:31:40.223

关于将 microsoft ajax 和验证与自定义 jquery ajax 混合，我在这里有一个类似的线程： [Mixing Microsoft MVC ajax and validation helpers with native jquery ajax](https://stackoverflow.com/questions/10380245/mixing-microsoft-mvc-validation-techniques-with-custom-jquery-ajax-form-post-wit)

# php - 提交后隐藏html表单？

> ID：10324368
> 
> 赞同：2
> 
> 时间：2012-04-25T21:52:20.003
> 
> 标签：php, javascript, jquery, ajax

我有一个 HTML 表单，它发布到一个 php 脚本，然后通过电子邮件将表单内容发送给我。我还在使用 javascript 表单验证和一些 jquery ajax，这样页面就不会重新加载。

HTML -

```
<form action="mail.php" class="contactus" onsubmit="return ValidateRequiredFields();"   name="contactus" method="POST">
<p class="floatleft" style="width:200px; background-color:#FF0000; line-height:50px; margin:0; padding:0;">Nameeeeee</p> <input class="sizetext" type="text" maxlength="10" name="name">
<div style="clear:both"></div>
<p class="floatleft" style="width:200px;">Email</p> <input class="sizetext" type="text" maxlength="10" name="email">
<div style="clear:both"></div>
<p class="floatleft" style="width:200px;">Telephone</p> <input class="sizetext" type="text" maxlength="10" name="telephone">

<p>Priority</p>
<select name="priority" size="1">
<option value="Low">Low</option>
<option value="Normal">Normal</option>
<option value="High">High</option>
<option value="Emergency">Emergency</option>
</select>

</select>
<p>Message</p><textarea name="message" rows="6" cols="25"></textarea><br />

<br />
<input class="buttonstyle" type="submit" value="Send">
</form>

    <div id="formResponse">
        </div> 
```

PHP -

```
<?php $name = $_POST['name'];
$email = $_POST['email'];
$priority = $_POST['priority'];
$message = $_POST['message'];
$telephone = $_POST['telephone'];
$formcontent="From: $name \n Email: $email \n Telephone Number: $telephone \n Priority: $priority \n Message: $message";
$recipient = "myemailaddress";
$subject = "Contact Form";
$mailheader = "From: $email \r\n";
mail($recipient, $subject, $formcontent, $mailheader) or die("Error!");
echo "Thank You!";
?> 
```

表单验证和 ajax -

```
<script type="text/javascript" language="JavaScript">

var FormName = "contactus";

var RequiredFields = "name,email,priority,message";

function ValidateRequiredFields()
{
var FieldList = RequiredFields.split(",")
var BadList = new Array();
for(var i = 0; i < FieldList.length; i++) {
    var s = eval('document.' + FormName + '.' + FieldList[i] + '.value');
    s = StripSpacesFromEnds(s);
    if(s.length < 1) { BadList.push(FieldList[i]); }
    }
if(BadList.length < 1) { return true; }
var ess = new String();
if(BadList.length > 1) { ess = 's'; }
var message = new String('\n\nThe following field' + ess + ' are required:\n');
for(var i = 0; i < BadList.length; i++) { message += '\n' + BadList[i]; }
alert(message);
return false;
}

function StripSpacesFromEnds(s)
{
while((s.indexOf(' ',0) == 0) && (s.length> 1)) {
    s = s.substring(1,s.length);
    }
while((s.lastIndexOf(' ') == (s.length - 1)) && (s.length> 1)) {
    s = s.substring(0,(s.length - 1));
    }
if((s.indexOf(' ',0) == 0) && (s.length == 1)) { s = ''; }
return s;
}
// -->
</script>

    <script type="text/javascript">

            $(document).ready(function() {

                $(".contactus").submit(function() {

                    $.post("mail.php", $(".contactus").serialize(),

                        function(data) {
                            $("#formResponse").html(data);
                        }
                    );
                    return false;
                });
            });
        </script> 
```

我想知道的是如何在提交后隐藏表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:06:40.410

```
$(".contactus").on('submit', function() {
    $this = $(this);
    $.post("mail.php", $(".contactus").serialize(), function(data) {
         $("#formResponse").html(data);
         $this.hide()
    });
    return false;
}); 
```

或者你可以试试：

```
$(document).ready(function() {
    $(".contactus").on('submit', function(e) {
        e.preventDefault();
        $this = $(this);
        $.ajax({
           type: 'POST',
           url: "mail.php",
           data: $(".contactus").serialize()
        }).done(function() { //done will only hide if the submit is successful, using always instead will alway hide the form
           $this.hide();
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:54:50.830

尝试

```
$('form.contactus').submit(function() {
  $(this).hide();
}); 
```

# ios - 如何在 CGContext CGMutablePathRef 上绘制顶点？

> ID：10324373
> 
> 赞同：0
> 
> 时间：2012-04-25T21:52:41.993
> 
> 标签：ios, render, cgcontext

当用户输入单击以指定顶点时，我正在绘制一组连接线。我正在构建一个 CGMutablePathRef

```
- (void)addPointToCGMPR: (CGPoint)p
      forNewPolygon: (BOOL)newPoly
{
    if (newPoly)
    {
        CGPathMoveToPoint(cgmpr, NULL, p.x, p.y);
    }
    else
    {
        CGPathAddLineToPoint(cgmpr, NULL, p.x, p.y);
    }
    [self setNeedsDisplay];
} 
```

然后在每个点输入后调用drawRect:，并将上下文CGMutablePathRef添加到一个CGContext中进行显示

```
- (void)drawRect:(CGRect)rect
{    
    // Set up a context to display
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextAddPath(context, cgmpr);

    CGContextSetLineWidth(context, 1);
    CGContextStrokePath(context);  

    // If NOT empty then Close the context so that box comparison can occur later
    if (!CGContextIsPathEmpty(context))
    {
        CGContextClosePath(context);
    }
} 
```

正如人们所期望的那样，我在屏幕上看到了线条。我的麻烦是，在用户选择了第一个点之后，屏幕上什么也没有呈现，并且用户在输入第二个点之前不知道系统是否得到了他的第一个选择。我希望系统甚至在输入下一个点之前渲染第一个点。我还希望系统以视觉上不同的方式渲染每个选择的顶点 - 现在我没有渲染顶点，只有线条。有没有办法让 CGContext 渲染点？有没有办法指定渲染这些点的样式？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:00:32.153

不，您需要自己渲染它们，方法是添加另一个 CGPath 来描述您想要表示顶点的任何内容。由于您可能会经常绘制它，因此您可能希望将其渲染到 CGLayer，以便您可以轻松地将其复制到您需要的地方。您还可以将顶点绘制到 CALayers 上，以便轻松移动它们。但由您来设计和管理这部分绘图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:03:29.320

你可以随意画出任何你想代表点的东西：一个小正方形、一个小圆圈、一个图钉的图像等。你已经知道如何在上下文中绘制；只需循环您的点并绘制它们，但是您希望它们出现。我个人倾向于使用`CGContextFillEllipseInRect`这样的东西。对于每个点，制作一个围绕该点的矩形并绘制它：

```
CGFloat pointSize = 4;
CGRect pointRect = CGRectMake(point.x - pointSize / 2, point.y - pointSize / 2, pointSize, pointSize);
CGContextFillEllipseInRect(context, pointRect); 
```

# objective-c - 如何在不使用 segue.destinationViewController 作为 setDelegate 方法的接收者的情况下设置委托？

> ID：10324376
> 
> 赞同：2
> 
> 时间：2012-04-25T21:52:52.950
> 
> 标签：objective-c, ios, delegates, protocols

使用委托时，我通常只告诉 UINavigationController 中的下一个视图控制器我想将自己设置为委托。我在 prepareForSegue 方法中执行此操作：

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    [segue.destinationViewController setDelegate:self];
} 
```

这一直很有效。但是，我试图在 navController 中告诉 viewController 两个索引或两个视图，我想将 self 设置为委托。我已经尝试了所有我能想到的方法来定义我想将 setDelegate 方法发送到的 viewController 接收器，但似乎没有任何效果。这是我尝试过的一个示例：

```
 DateSelectViewController *dsvc = [[DateSelectViewController alloc] init];
    [dsvc setDelegate:self]; 
```

该方法永远不会被委托，我知道它与我设置委托的方式有关，因为我已经排除了所有其他可能性。我怎样才能正确地做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:05:30.670

您不能直接这样做，因为该视图控制器尚不存在。您可以在下一个中执行以下操作：

```
[segue.destinationViewController setDelegate:self.delegate]; 
```

如果你有`A`-> `B`->`C`

在`A`你有你的原始代码：

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    [segue.destinationViewController setDelegate:self];
    // self == A
} 
```

在`B`你有：

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    [segue.destinationViewController setDelegate:self.delegate];
    // self.delegate == A
} 
```

# android - 无法在 Android 中使用 Pop 接收邮件

> ID：10324379
> 
> 赞同：1
> 
> 时间：2012-04-25T21:53:03.810
> 
> 标签：android, jakarta-mail, imap, pop3

我可以使用以下代码示例通过 Imap 接收邮件：

```
URLName server = new URLName("imaps://" + username + ":"+ password + "@imap.gmail.com/INBOX");
    Session session = Session.getDefaultInstance(new Properties(), null);
    Folder folder = session.getFolder(server);
if (folder == null) 
{
    System.exit(0);
}
   folder.open(Folder.READ_ONLY);
   Message[] messages = folder.getMessages(); 
```

但有时 Imap 不提供任何服务，那时我想使用 Pop 但我无法在我的代码中使用它。使用接收邮件的其他代码不同。但在 Android 中，只有此代码有效。

我应该在此代码中更改哪些内容以使用 Pop？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:14:57.653

首先，有一个很好的 URLName 构造函数，它将所有组件片段作为单独的参数，因此您不必进行字符串连接。

从 IMAP 切换到 POP3 需要更改协议名称以及主机名。有关示例，请参阅[JavaMail 常见问题解答。](http://www.oracle.com/technetwork/java/javamail/faq/index.html#gmail)协议名称为“pop3s”，主机名称为“pop.gmail.com”。

最后，您应该使用 Session.getInstance 而不是 Session.getDefaultInstance。比较这两种方法的 javadocs 以了解原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T05:18:47.170

这个怎么样。真的为我工作！（来源：[这里](http://www.java-tips.org/other-api-tips/javamail/connecting-gmail-using-pop3-connection-with-ssl-6.html)）

```
 String SSL_FACTORY = "javax.net.ssl.SSLSocketFactory";

    Properties pop3Props = new Properties();

    pop3Props.setProperty("mail.pop3.socketFactory.class", SSL_FACTORY);
    pop3Props.setProperty("mail.pop3.socketFactory.fallback", "false");
    pop3Props.setProperty("mail.pop3.port", "995");
    pop3Props.setProperty("mail.pop3.socketFactory.port", "995");

    URLName url = new URLName("pop3", "pop.gmail.com", 995, "","youremailid@gmail.com",yourpassword);
    Session session = Session.getInstance(pop3Props, null);
    Store store = new POP3SSLStore(session, url);
    try {
        store.connect();
    } catch (MessagingException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }

    Folder folder = null;
    try {
        folder = store.getDefaultFolder();

        folder = folder.getFolder("INBOX");

    } catch (MessagingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    if (folder == null) {
        System.exit(0);
    }
    try {
        folder.open(Folder.READ_ONLY);
    } catch (MessagingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

尝试通过存储对象检索文件夹。还要提到您要检索的文件夹是收件箱！另请注意，在设置中，端口号是 995 表单弹出。（您可以保留前六行。）

# c# - 从 Windows 服务应用程序发送报告

> ID：10324380
> 
> 赞同：1
> 
> 时间：2012-04-25T21:53:05.347
> 
> 标签：c#, windows, pdf, console, report

我必须每 N 分钟通过电子邮件定期发送一份 Reporting Services 报告报告（或水晶报告）。

我没有 SQL Reporting Server，它是一个独立的应用程序。他们希望在收件箱中以 PDF 或 XLS 文件的形式接收报告。

我如何使用*控制台应用程序*或*Windows 服务应用程序*来做到这一点？那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T06:30:27.990

我假设您可以生成报告。或者，如果您希望创建 xls 格式的报告，而不使用 MS SQL 报告服务或 Crystal 报告，您可以使用 Microsoft.Office.Interop.Excel dll 完成。您可以配置保存生成报告的物理路径（在您的 app.config 文件中）。在您的 Windows 服务中，您可以按时间间隔发送电子邮件。您可以选择已创建的 xls 文件（报告），将其与电子邮件一起作为附件发送。为此，您可以使用 System.Net.Mail.SmtpClient 类。（有关更多详细信息 - [http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx)）

创建电子邮件时，您可以根据需要在 App.config 文件中配置 smtp 服务器、发件人地址和发件人地址以及 Windows 服务的时间间隔。希望这可以帮助。

PS 我有使用 Microsoft.Office.Interop.Excel 程序集创建 xls 文件的示例代码。如果你需要我愿意分享。

# ruby - 使用 find_or_create_by 时关联 id = nil

> ID：10324383
> 
> 赞同：0
> 
> 时间：2012-04-25T21:53:19.300
> 
> 标签：ruby, ruby-on-rails-3, associations

当我尝试通过 find_or_create_by 方法添加客户端时，我没有将 trainer_id 作为值传入（客户端的 trainer_id = nil）

即使你在我的 Client_Controller 我也有 build 方法，我假设它会从 current_trainer 中提取 id

我假设 find_or_create_by_name 和构建方法之间存在脱节。

对此有任何帮助将不胜感激。

**客户端控制器**

```
 def create
    @client = current_trainer.clients.build(params[:client])

    respond_to do |format|
      if @client.save
        ClientMailer.registration_confirmation(@client).deliver
        format.html { redirect_to @client, :notice => 'Client was successfully added.' }
        format.json { render :json => @client, :status => :created, :location => @client }
      else
        format.html { render :action => "new" }
        format.json { render :json => @client.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

**锻炼模型**

```
class Workout < ActiveRecord::Base

    belongs_to :client
    belongs_to :trainer

    validates_presence_of   :day, 
                            :client_id, 
                            :trainer_id, 
                            :message => "You have to indicated for when you want to schedule this workout."
    def client_name
        client.try(:name)
    end

    def client_name=(name)
        self.client = Client.find_or_create_by_name(name) if name.present?
    end

end 
```

**客户模型**

```
class Client < ActiveRecord::Base

    belongs_to :trainer

    before_save :generate_password

    has_many :workouts
    has_many :weigh_ins

    validates_presence_of   :name, :message => "You have to provide a client name in order to add new client."

    has_attached_file :profile_pic, :styles => { :micro => "60x60>", :small => "150x150>" }, 
                                    :default_url => 'profile_default_small.jpg',
                                    :storage => :s3,
                                    :s3_credentials => S3_CREDENTIALS,
                                    :bucket => '#',
                                    :path => ":attachment/:id/:style/:basename.:extension"

    validates_attachment_size   :profile_pic, 
                                :less_than => 3.megabytes,  
                                :message => "Your profile picture can`t be bigger than 3MB, sorry."

    def generate_password
        self.password = name[0..2].to_s + rand(99).to_s
    end

    def self.authenticate(email, password)  
        client = find_by_email(email)  
        if client && client.password == client.password
          client  
        else  
          nil  
        end
    end 
```

**服务器日志**

```
 Started POST "/workouts" for 127.0.0.1 at Wed Apr 25 17:39:37 -0400 2012
    Processing by WorkoutsController#create as HTML
      Parameters: {"commit"=>"Schedule Session", "authenticity_token"=>"CxJSVfn0fwerdyrpA9/JEe8fX8Ep2/ZhnOqQkjZ3iwE=", "utf8"=>"✓", "workout"=>{"client_name"=>"John Doe", "day(1i)"=>"2012", "day(2i)"=>"4", "day(3i)"=>"29", "day(4i)"=>"21", "day(5i)"=>"00", "note"=>"", "title"=>"Current_Client"}}
      Trainer Load (0.1ms)  SELECT "trainers".* FROM "trainers" WHERE "trainers"."id" = ? LIMIT 1  [["id", 37]]
      Client Load (0.2ms)  SELECT "clients".* FROM "clients" WHERE "clients"."name" = 'John Doe' LIMIT 1
       (0.0ms)  begin transaction
      SQL (0.4ms)  INSERT INTO "clients" ("created_at", "email", "goal_weight", "name", "notes", "password", "profile_pic_content_type", "profile_pic_file_name", "profile_pic_file_size", "profile_pic_updated_at", "start_weight", "trainer_id", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  [["created_at", Wed, 25 Apr 2012 21:39:37 UTC +00:00], ["email", nil], ["goal_weight", nil], ["name", "John Doe"], ["notes", nil], ["password", "Joh55"], ["profile_pic_content_type", nil], ["profile_pic_file_name", nil], ["profile_pic_file_size", nil], ["profile_pic_updated_at", nil], ["start_weight", nil], ["trainer_id", nil], ["updated_at", Wed, 25 Apr 2012 21:39:37 UTC +00:00]]
    [paperclip] Saving attachments.
       (2.3ms)  commit transaction
       (0.1ms)  begin transaction
      SQL (0.5ms)  INSERT INTO "workouts" ("client_id", "created_at", "day", "note", "title", "trainer_id", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)  [["client_id", 53], ["created_at", Wed, 25 Apr 2012 21:39:37 UTC +00:00], ["day", Sun, 29 Apr 2012 21:00:00 UTC +00:00], ["note", ""], ["title", "Current_Client"], ["trainer_id", 37], ["updated_at", Wed, 25 Apr 2012 21:39:37 UTC +00:00]]
       (1.1ms)  commit transaction
    Redirected to http://localhost:3000/workouts/64
    Completed 302 Found in 13ms (ActiveRecord: 4.8ms) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:45:49.520

据我了解，`find_or_create_by`将使用该`create`方法，而不是您的创建控制器操作。这就是为什么其他信息都没有进入新`Client`记录的原因。

您可以将其他参数传递给`find_or_create_by_name`. 这些参数将要么 1) 如果找到记录则被忽略，或者 2)`create`如果未找到记录，则在方法中使用这些参数。您需要`create`为您的关系传递额外的参数，因为它不会像这样自动处理它们`build`。

你想要这样的东西：`find_or_create_by_name(:name => name, :trainer_id => self.trainer_id)`. 请注意，使用其他参数时，您需要将它们全部作为散列传递。

更多信息：[将额外数据传递给 find_or_create](https://stackoverflow.com/q/2394489/1005071)

# .htaccess - Htaccess 重定向 - www 到添加文件夹结构的子域

> ID：10324387
> 
> 赞同：0
> 
> 时间：2012-04-25T21:53:42.807
> 
> 标签：.htaccess, redirect, subdomain

我正在寻找将属性列表重定向到新的子域和域结构。例如，我想重定向

```
http://www.example.com/idx/details.php?thenALongString... 
```

至

```
http://mls.example.com/idx/3494/details.php?thenALongString... 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T14:03:11.767

我能够弄清楚。我使用了以下内容：

`RedirectMatch 301 /idx/details.php(.*) http://mls.lisasellspontevedra.com/idx/3494/details.php`

旧 URL 上的动态字符串被转移到新位置的末尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:16:42.990

我认为这应该有效：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.example.com$ [NC]
RewriteRule ^idx/details.php http://mls.example.com/idx/3494/details.php [R=301,L] 
```

# java - 在 JAVA 中将图像添加到 GUI 的问题

> ID：10324392
> 
> 赞同：0
> 
> 时间：2012-04-25T21:54:29.793
> 
> 标签：java, swing, user-interface, imageicon

我正在为 java 中的棋盘游戏构建这个 GUI。我创建了许多面板、标签和按钮，并将它们全部添加到框架中。一切正常，除了我无法显示图像。这是我的代码和支持评论。我无法弄清楚为什么图像不会显示。我已经尝试了很多不同的尝试，你可以看到有很多注释掉的代码。在此先感谢您的帮助。

```
package gui;

import java.awt.Color;
import java.awt.FlowLayout;
import java.awt.Frame;

import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JPanel;
import javax.swing.JTextField;

import listeners.PlaceButtonListener;
import listeners.TextFieldListener;

public class GUI {

public static void main(String[] args)
{
    new GUI();
}

public GUI()
{

    int playerTurn = 1; // Variable to hold what player's window it is

    JFrame frame = new JFrame();
    frame.setSize(880, 680);

    //JPanel totalGUI = new JPanel(); // Contains all other panels
    //totalGUI.setLayout(null);

    // Creation of Panels on totalGUI
    JPanel scorePanel = new JPanel();
    JPanel buttonPanel = new JPanel();
    JPanel boardPanel = new JPanel();
    JPanel tilePanel = new JPanel();
    JPanel turnPanel = new JPanel();
    JPanel playerPanel = new JPanel();
    JPanel placePanel = new JPanel();

    // Creation of Labels
    JLabel scoreLabel = new JLabel("Score:");
    JLabel playerLabel = new JLabel("Player: " + playerTurn);
    JLabel tileLabel = new JLabel("Current Tile:");
    JLabel turnLabel = new JLabel("Player " + playerTurn +"'s Turn");
    JLabel imageLabel = new JLabel(new ImageIcon("a1.png"));

    // Creation of Buttons
    JButton resignButton = new JButton("Resign");
    JButton placeButton = new JButton ("Place");
    JButton commitButton = new JButton("Commit");
    JButton removeButton = new JButton("Remove");

    // Creation and adding of JMenuBar, JMenus and JMenuItems
    JMenuBar mBar = new JMenuBar();
    JMenu file = new JMenu("File");
    JMenuItem saveAndQuit = new JMenuItem("Save and Quit");
    JMenuItem quit = new JMenuItem("Quit");
    JMenu help = new JMenu("Help");
    JMenuItem gameManual = new JMenuItem("Game Manual");
    file.add(saveAndQuit);
    file.add(quit);
    help.add(gameManual);
    mBar.add(file);
    mBar.add(help);

    // Creates the text field where the player will input x and y values
    JTextField placeField = new JTextField(10);

    // playerPanel displays what Player's window it is
    playerLabel.setLocation(0, 0);
    playerLabel.setSize(120, 30);
    playerLabel.setHorizontalAlignment(0);
    playerPanel.add(playerLabel);
    playerPanel.setLayout(null);
    playerPanel.setLocation(350, 0);
    playerPanel.setSize(120, 30);
    //totalGUI.add(playerPanel);
    frame.add(playerPanel);

    // scorePanel displays the score of all Players
    scoreLabel.setLocation(0, 0);
    scoreLabel.setSize(120, 30);
    scoreLabel.setHorizontalAlignment(0);

    scorePanel.add(scoreLabel);
    scorePanel.setLayout(null);
    scorePanel.setLocation(740, 40);
    scorePanel.setSize(120, 300);
    scorePanel.setBackground(Color.YELLOW);
    //totalGUI.add(scorePanel);
    frame.add(scorePanel);

    // Places and adds buttons to panel
    buttonPanel.add(commitButton);
    commitButton.setLocation(10, 0);
    commitButton.setSize(120, 30);

    buttonPanel.add(placeButton);
    placeButton.setLocation(140, 0);
    placeButton.setSize(120, 30);

    buttonPanel.add(removeButton);
    removeButton.setLocation(10, 40);
    removeButton.setSize(120, 30);

    buttonPanel.add(resignButton);
    resignButton.setLocation(140, 40);
    resignButton.setSize(120, 30);

    buttonPanel.setLayout(null);
    buttonPanel.setLocation(350, 560);
    buttonPanel.setSize(280,100);
    buttonPanel.setBackground(Color.BLUE);
    //totalGUI.add(buttonPanel);
    frame.add(buttonPanel);

    // placeField takes user input of where to place tile
    placeField.setLocation(145, 0);
    placeField.setVisible(true);
    placeField.setSize(60, 30);
    placePanel.add(placeField);
    placePanel.setLocation(630, 560);
    placePanel.setSize(150, 40);
    placePanel.setBackground(Color.BLACK);
    frame.add(placePanel);

    // Sets size of Board and adds it to totalGUI
    imageLabel.setSize(100, 100);
    imageLabel.setLocation(10,10);
    boardPanel.setLayout(null);
    boardPanel.setLocation(220, 40);
    boardPanel.setSize(480, 480);
    // boardPanel.setBackground(Color.BLACK);

    boardPanel.add(imageLabel);
    //totalGUI.add(boardPanel);
    frame.add(boardPanel);

    //add JLabel on the boardPanel to display board configuration. HashMap?

    // Adds tileLabel to tilePanel and sets the size of tilePanel
    tileLabel.setLocation(0, 0);
    tileLabel.setSize(200, 30);
    tileLabel.setHorizontalAlignment(0);

    tilePanel.add(tileLabel);
    tilePanel.setLayout(null);
    tilePanel.setLocation(0, 40);
    tilePanel.setSize(200, 210);
    tilePanel.setBackground(Color.RED);
    //totalGUI.add(tilePanel);
    frame.add(tilePanel);

    // Adds turnLabel to turnPanel and sets size
    turnLabel.setLocation(0, 0);
    turnLabel.setSize(150, 30);
    turnLabel.setHorizontalAlignment(0);

    turnPanel.add(turnLabel);
    turnPanel.setLayout(null);
    turnPanel.setLocation(0, 280);
    turnPanel.setSize(150, 30);
    turnPanel.setBackground(Color.GREEN);
    //totalGUI.add(turnPanel);
    frame.add(turnPanel);

    // Adds all the panels and menus to the Frame
    frame.setJMenuBar(mBar);
    //frame.add(totalGUI);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(280, 190);
    //frame.pack();
    frame.setVisible(true);     
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:03:44.280

假设它`a1.png`与 位于同一文件夹中`GUI.class`，您可能希望像这样加载它：

```
new ImageIcon(GUI.class.getResource("a1.png")) 
```

# python - sphinx-build 失败 - autodoc 无法导入/查找模块

> ID：10324393
> 
> 赞同：126
> 
> 时间：2012-04-25T21:54:39.240
> 
> 标签：python, python-sphinx, autodoc

我正在尝试开始使用 Sphinx，但似乎遇到了无情的问题。

命令：`docs/sphinx-quickstart`

我回答了所有问题，一切正常。

命令：`docs/ls`

一切看起来都很正常。结果：`build Makefile source`

命令：`sphinx-build -d build/doctrees source build/html`

它似乎工作。我能够打开 index.html 文件并看到我想要的“外壳”。

当我尝试将我的实际源代码作为`source`文件夹时，我遇到了问题。

命令：`sphinx-build -d build/doctrees ../ys_utils build/html`

结果：

```
Making output directory...
Running Sphinx v1.1.3
loading pickled environment... not yet created
No builder selected, using default: html
loading intersphinx inventory from http://docs.python.org/objects.inv...
building [html]: targets for 1 source files that are out of date
updating environment: 1 added, 0 changed, 0 removed
Traceback (most recent call last):                                                                                               
  File "/usr/local/lib/python2.6/dist-packages/Sphinx-1.1.3-py2.6.egg/sphinx/ext/autodoc.py", line 321, in import_object
    __import__(self.modname)
ImportError: No module named ys_utils
Traceback (most recent call last):
  File "/usr/local/lib/python2.6/dist-packages/Sphinx-1.1.3-py2.6.egg/sphinx/ext/autodoc.py", line 321, in import_object
    __import__(self.modname)
ImportError: No module named ys_utils.test_validate_ut
Traceback (most recent call last):
  File "/usr/local/lib/python2.6/dist-packages/Sphinx-1.1.3-py2.6.egg/sphinx/ext/autodoc.py", line 321, in import_object
    __import__(self.modname)
ImportError: No module named ys_utils.git_utils
Traceback (most recent call last):
  File "/usr/local/lib/python2.6/dist-packages/Sphinx-1.1.3-py2.6.egg/sphinx/ext/autodoc.py", line 321, in import_object
    __import__(self.modname)
ImportError: No module named setup.setup

/home/ricomoss/workspace/nextgen/ys_utils/ys_utils.rst:4: WARNING: autodoc can't import/find module 'ys_utils', it reported error: "No module named ys_utils", please check your spelling and sys.path
/home/ricomoss/workspace/nextgen/ys_utils/ys_utils.rst:10: WARNING: autodoc can't import/find module 'ys_utils.test_validate_ut', it reported error: "No module named ys_utils.test_validate_ut", please check your spelling and sys.path
/home/ricomoss/workspace/nextgen/ys_utils/ys_utils.rst:12: WARNING: don't know which module to import for autodocumenting u'UnitTests' (try placing a "module" or "currentmodule" directive in the document, or giving an explicit module name)
/home/ricomoss/workspace/nextgen/ys_utils/ys_utils.rst:18: WARNING: autodoc can't import/find module 'ys_utils.git_utils', it reported error: "No module named ys_utils.git_utils", please check your spelling and sys.path
/home/ricomoss/workspace/nextgen/ys_utils/ys_utils.rst:24: WARNING: autodoc can't import/find module 'setup.setup', it reported error: "No module named setup.setup", please check your spelling and sys.path
WARNING: master file /home/ricomoss/workspace/nextgen/ys_utils/index.rst not found
looking for now-outdated files... none found
pickling environment... done
checking consistency... /home/ricomoss/workspace/nextgen/ys_utils/ys_utils.rst:: WARNING: document isn't included in any toctree
done
preparing documents... done
writing output... [ 50%] index                                                                                                   
Exception occurred:
  File "/usr/local/lib/python2.6/dist-packages/Sphinx-1.1.3-py2.6.egg/sphinx/environment.py", line 1213, in get_doctree
    f = open(doctree_filename, 'rb')
IOError: [Errno 2] No such file or directory: '/home/ricomoss/workspace/nextgen/docs/build/doctrees/index.doctree'
The full traceback has been saved in /tmp/sphinx-err-jjJ7gM.log, if you want to report the issue to the developers.
Please also report this if it was a user error, so that a better error message can be provided next time.
Either send bugs to the mailing list at <http://groups.google.com/group/sphinx-dev/>,
or report them in the tracker at <http://bitbucket.org/birkenfeld/sphinx/issues/>. Thanks! 
```

我是 Sphinx 的新手，对这类文档也比较陌生。任何人都可以提供一些建议吗？

编辑：

我希望能够使用 Makefile 来处理这个问题。截至目前，我的项目中有两个文件夹。

`nextgen/ls`

`docs ys_utils`

我需要为我将拥有`nextgen/docs/Makefile`的所有其他模块生成 HTML 。`ys_utils`

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-04-27T13:59:15.013

Autodoc 找不到您的模块，因为它们不在`sys.path`.

您必须`sys.path`在`conf.py`. 看看你的顶部`conf.py`（就在 import 之后`sys`），有一个`sys.path.insert()`声明，你可以适应它。

顺便说一句：您可以使用`Makefile`Sphinx 创建的文档来创建您的文档。打电话

```
make 
```

查看选项。

如果在尝试之前出现问题：

```
make clean 
```

在运行之前`make html`。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2017-07-07T22:30:59.897

## 解决方案

听起来`os.path.append()`对人们来说工作正常，但是如果您遵循`conf.py`模板，您会将模块路径插入到`sys.path`using的前面`os.path.insert(0, ...)`，然后添加一个额外的`.`

```
import os
import sys
sys.path.insert(0, os.path.abspath('..')) 
```

如果您已将`sphinx`项目设置为使用单独的目录`build`和`source`目录，则该调用应改为：

```
sys.path.insert(0, os.path.abspath('../..')) 
```

## 关于 sys.path ...

要运行 python 代码，python 解释器需要知道它在哪里。由于 sphinx 配置是一个 python 脚本，它的位置需要知道，这是通过`sys.path`使用 insert 方法将其添加到变量来完成的（请参阅[模块搜索路径](https://docs.python.org/3/tutorial/modules.html#the-module-search-path)上的文档）。

在这种情况下添加的路径`sys.path`是“相对”路径，使用点指定。这是指定路径的一般方法，它允许移动代码并仍然正确指向代码库中的正确路径。

`.`- 当前路径`conf.py`

`..`- 的父路径`conf.py`

`../..`- 父路径的父路径等。

我使用的是 linux，所以目录是用正斜杠指定的，但是指定父目录的跨平台方法可以用`pathlib`.

```
from pathlib import Path

parent = Path(__file__).parent
parents_parent = Path(__file__).parents[1] 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-09-03T10:47:36.297

在`conf.py`

只需将路径添加到您的项目文件夹。

```
sys.path.append('/home/workspace/myproj/myproj') 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-03-15T05:35:24.387

如果

1.  在 conf.py 中正确设置了模块根路径
2.  `__init__.py`放置正确
3.  第一个语法是正确的

并且您的自动文档仍然找不到模块...

可能是因为你的python环境下不满足这些模块的依赖关系。您将需要检查所有导入语句是否在模块中工作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-12-03T12:02:05.963

我不知道为什么（也许在我的情况下 autodoc 无法安装我的包），但我总是遇到`module-not-found`错误，直到我明确地将所有包含模块的目录包含到路径中。

对于以下示例文件夹结构

```
project_dir
|- setup.py
|- src
|  |- __init__.py
|  |- source1.py
|  |- sub_project
|     |- __init__.py
|     |- source2.py 
|- docs
    |- conf.py
    |- source
    |  |- index.rst
    |- _build 
```

包括我

```
for x in os.walk('../../src'):
  sys.path.insert(0, x[0]) 
```

到开头`conf.py`这样所有涉及的目录都将被添加。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-25T22:02:40.337

我想我第一次尝试将文件添加到目录树时就这样做了。我认为这是因为我遗漏了 :maxdepth 行和文件名之间的空白行。

```
.. Animatrix Concepts documentation master file, created by
   sphinx-quickstart on Thu Mar 22 18:06:15 2012.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

Welcome to Animatrix Concepts documentation!
============================================

Contents:

.. toctree::
   :maxdepth: 2

   stuff

Indices and tables
==================

* :ref:`genindex`
* :ref:`modindex`
* :ref:`search` 
```

以上是我的 index.rst 文件。stuff.rst 与它位于同一目录中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-06-05T23:33:42.750

我得到了同样的错误，但它是由与其他答案中解释的完全不同的原因引起的。

我的`.. automethod:: mymodule.func`指令实际上应该是：

```
.. automethod:: mymodule::func 
```

请参阅[文档中的](https://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html#directive-autoclass)*1.3 版*中的新增部分。[`autoclass`](https://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html#directive-autoclass)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-08T03:52:57.500

您可以使用[Pweave](http://mpastell.com/pweave)和 noweb 格式生成包含嵌入其中的代码输出的 rst 文档。基本上，你编写你的第一个文件，将 python 代码嵌入到标记的块中，如下所示：

```
<<echo=False>>=
print("some text that will appear in the rst file")
@ 
```

Pweave 将执行这些块，并将它们替换为生成的 rst 文件中的输出，然后您可以将其与 sphinx 一起使用。有关外观的更多详细信息，请参阅[Pweave reST 示例](http://mpastell.com/pweave/examples.html#sphinx-example)。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2022-01-31T16:44:04.240

线程中的许多解决方案都在正确的方向上进行了讨论。对我来说，[官方文档](https://www.sphinx-doc.org/en/master/tutorial/describing-code.html#including-doctests-in-your-documentation)上的命令很有帮助。

```
import pathlib
import sys
sys.path.insert(0, pathlib.Path(__file__).parents[2].resolve().as_posix()) 
```

# php - CakePHP i18n 不工作

> ID：10324395
> 
> 赞同：0
> 
> 时间：2012-04-25T21:55:08.363
> 
> 标签：php, cakephp, internationalization, gettext

我按照说明使用 PoEdit 创建了 .po 文件，其中语言：越南语，国家：VIETNAM 在：my_app **./Locale/vie/LC_MESSAGES/default.po**

我用一个普通的编辑器仔细检查它以查看 msgid，这是一个示例：

＃小路

msgstr "登录"

msgstr "Đăng nhập"

在 bootstrap.php 中：**Configure::write('Config.language', 'vie');** 我试过**Configure::write('Config.language', 'vi');** 还。

在视图文件中我回显 __("Login"); 但它仍然显示“登录”...

我尝试了很多方法让它工作，甚至重新启动 Apache 或我的电脑，但没有成功。任何帮助将不胜感激！

我的环境：

*   启用了 gettext 库的 XAMPP v1.7.3

*   MAC OSX 狮子 10.7.2

*   CakePHP 2.1.1 稳定版

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T02:55:41.727

你`uses ( 'L10n' );`里面有吗？

代码示例会有所帮助。我知道涉及多个文件，但这就是事情的方式......每个文件的样本。你读过[说明书](http://book.cakephp.org/1.3/en/view/1230/Localization-in-CakePHP)吗？

[这篇文章](https://stackoverflow.com/questions/7529020/cakephp-localization)还谈到了文件组织。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T20:33:42.230

如果您确定 *.po 文件正常，删除文件夹中的文件会有所帮助。（不是文件夹，只有文件）

```
/app/tmp/cache/persistent/myapp_cake_core_* 
```

# c++ - 包含包含标头的目录时出现编译错误

> ID：10324398
> 
> 赞同：0
> 
> 时间：2012-04-25T21:55:25.633
> 
> 标签：c++

我有一个目录`maths`，它是一个仅由头文件组成的库。我正在尝试通过在我的主目录中运行以下命令来编译我的程序：

```
g++ -I ../maths prog1.cpp prog2.cpp test.cpp -o et -lboost_date_time -lgsl -lgslcblas 
```

但我收到以下编译错误：

```
prog1.cpp:4:23: fatal error: maths/Dense: No such file or directory
compilation terminated.
prog2.cpp:6:23: fatal error: maths/Dense: No such file or directory
compilation terminated. 
```

`maths`与 .cpp 文件位于同一目录（即我的主目录）中，我也在我的家中运行编译行。

prog1.cpp 和 prog2.cpp 分别在第 4 行和第 6 行具有以下标题 `#include<maths/Dense>`，因此我收到错误消息。

我如何解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:56:56.187

您可以将包含路径更改为，也可以将包含更改`-I..`为`#include <Dense>`

等待，如果`maths`与源文件在同一目录中并且是当前目录，则可以将包含路径更改为`-I.`或包含更改为`#include "Dense"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:58:59.727

> maths 与 .cpp 文件位于同一目录（即我的主目录）中

您的包含路径为`-I ../maths`. 您需要`-I ./maths`- 或更简单，`-I maths`因为它是*当前目录*`maths`的子目录，而不是父目录的子目录。对？

 *然后在您的 C++ 文件中，使用`#include <Dense>`. 如果你想使用`#include <maths/Dense>`你需要调整包含路径。但是，使用`-I.`可能会导致大量问题¹，我强烈建议*不*要这样做。

Instead, it’s common practice to have an `include` subdirectory that is included. So your folder structure should preferably look as follows:

```
./
+ include/
| + maths/
|   + Dense
|
+ your_file.cpp 
```

Then use `-I include`, and in your C++ file, `#include <maths/Dense>`.

* * *

^(1)) Consider what happens if you’ve got a file `./map.cpp` from which you generate an executable called `./map`. As soon as you use `#include <map>` anywhere in your code, this will try to include `./map` instead of the `map` standard header.*

# shell - 在 shell 脚本中测试文件格式

> ID：10324407
> 
> 赞同：2
> 
> 时间：2012-04-25T21:56:20.757
> 
> 标签：shell, file-format

我想要的是让这个脚本测试作为参数传递给它的文件是 ASCII 文件还是 zip 文件，如果它是 ascii 回显“ascii”，如果它是 zip 回显“zip”，否则回显“错误” .

这是我目前拥有的

```
filetype = file $1
isAscii=`file $1 | grep -i "ascii"`
isZip=`file $1 | grep -i "zip"`

if [ $isAscii -gt "0" ] then echo "ascii";
else if [ $isZip -gt "0" ] then echo "zip";
else echo "ERROR";
fi 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:04:07.020

您运行文件/grep 命令并检查其返回码的方式不正确。你需要做这样的事情：

```
if file "$1" | grep -i ascii; then
    echo ascii
fi 
```

之前，您将文件/grep 管道的文本输出捕获到变量中，然后将其与数字 0 作为字符串进行比较。上面将使用命令的实际返回值，这正是你所需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T15:04:22.497

对于`file`命令，请尝试`-b --mime-type`. 下面是一个过滤 MIME 类型的示例：

```
#!/bin/sh
type file || exit 1
for f; do
    case $(file -b --mime-type "$f") in
        text/plain)
            printf "$f is ascii\n"
            ;;
        application/zip)
            printf "$f is zip\n"
            ;;
        *)
            printf "ERROR\n"
            ;;
    esac
done 
```

# symfony - symfony2 表单错误与字段错误主题（树枝）

> ID：10324408
> 
> 赞同：4
> 
> 时间：2012-04-25T21:56:25.180
> 
> 标签：symfony, twig

在 Twig 中，有没有办法为字段错误定义**不同的主题**，而不是形成相关的错误，如 CSRF 错误或复合唯一约束？

我想用 a 显示字段错误，用 a 显示`<span>`表单错误`<ul>`

```
{{ form_errors(form) }}        

<table>
    <tbody>
        <tr>
            <td>{{ form_label(form.tabla) }}</td>
            <td>
                {{ form_widget(form.tabla) }}
                {{ form_errors(form.tabla) }}
            </td>
            <td></td>
            <td>{{ form_label(form.descripcion) }}</td>
            <td>
                {{ form_widget(form.descripcion) }}
                {{ form_errors(form.descripcion) }}
            </td>
            <td></td>
        </tr>
    </tbody>
</table> 
```

这是我用于两种情况的表单主题（不是我想要的）。

```
{% block field_errors %}
    {% if errors|length > 0 %}
        <span class="val-error">
            {% for error in errors %}
                {{ error.messageTemplate|trans(error.messageParameters, 'validators')~'. ' }}
            {% endfor %}
        </span>
    {% endif %}
{% endblock field_errors %} 
```

有没有办法区分这两种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T22:55:00.420

表单类扩展字段。如果您将新主题设置为字段，它将应用于表单。您应该像以前一样覆盖 field_errors 块，然后使用另一个模板（带有 th ul 标签）定义 form_errors 块。

```
{% block field_errors %}
    {% if errors|length > 0 %}
        <span class="val-error">
            {% for error in errors %}
                {{ error.messageTemplate|trans(error.messageParameters, 'validators')~'. ' }}
            {% endfor %}
        </span>
    {% endif %}
{% endblock field_errors %}

{% block form_errors %}
    {% if errors|length > 0 %}
        <ul class="val-error">
            {% for error in errors %}
                <li>{{ error.messageTemplate|trans(error.messageParameters, 'validators')~'. ' }}</li>
            {% endfor %}
        </ul>
    {% endif %}
{% endblock form_errors %} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-09T18:54:10.000

由于`field_*`在 2.3 中被删除，批准的解决方案将不再有效。我发现的一个hacky解决方案是

```
{% block form_errors %}
    {% if errors|length > 0 %}
        {% if form.parent is empty %}
            <ul class="val-error">
                {% for error in errors %}
                    <li>{{ error.messageTemplate|trans(error.messageParameters, 'validators')~'. ' }}</li>
                {% endfor %}
            </ul>
        {% else %}
             <span class="val-error">
                 {% for error in errors %}
                     {{ error.messageTemplate|trans(error.messageParameters,  'validators')~'. ' }}
                 {% endfor %}
             </span>
        {% endif %}
    {% endif %}
{% endblock form_errors %} 
```

所以基本上，如果没有父级，它知道它是顶级的。

# jquery - IE 7 显示错误和 jQuery Datepicker

> ID：10324409
> 
> 赞同：0
> 
> 时间：2012-04-25T21:56:27.680
> 
> 标签：jquery, css, internet-explorer-7, jquery-ui-datepicker

在使用我们都知道和喜爱的浏览器时，我遇到了一个从未见过的问题。在此页面 - [http://weresayingido.com/register](http://weresayingido.com/register) - 标签和帮助文本在 IE 中无法正常显示。但是，使用以下代码快速刷新 Datepicker 会导致所有文本正常呈现。

```
// IE detection hackery
if ('\v' == 'v') {
  // Flash the Datepicker UI
  $('input[name="date"]').focus();
  $('input[name="date"]').blur();
  setTimeout("$('body').mousedown()", 1);
} 
```

（是的，setTimeout 是必要的，否则 Datepicker 块只会留在那里。不，我不知道为什么会这样，但我很想知道。）

鉴于这绝对是一个相当老套的 hack，我想知道*为什么*会发生这种情况，以及是否可以在不使用这种技巧的情况下进行复制，特别是仅使用 CSS/HTML。有人碰巧知道这些问题的答案吗？

**tl;dr:** jQuery UI Datepicker 正在做的事情是强制文本在 IE 7 中明显呈现，否则不会。我可以只用 CSS/HTML 解决这个问题吗？

**相关链接：**

*   使用 jQuery Datepicker 修复的页面：[http ://weresayingido.com/register](http://weresayingido.com/register)
*   在没有 Datepicker hack 的情况下呈现的页面：[http ://weresayingido.com/manage/login](http://weresayingido.com/manage/login)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:02:11.693

IE7 不喜欢`visibility`，也不考虑`body`真正的元素。

保持您的页面可见（这对于您可能拥有的不幸的非 JavaScript 用户来说也更好）。如果您绝对必须，请在您的 style.css 中使用，并通过您的 script.js`body {display: none;}`使其可见。`$('body').show()`远离`visibility`。

干杯。

# css - 如何用CSS做margin：0 auto 0 auto减去几个像素？

> ID：10324411
> 
> 赞同：9
> 
> 时间：2012-04-25T21:56:44.513
> 
> 标签：css, margin

我想做这个：

```
margin: 0 auto 0 auto; 
```

使其浮动到中心，但我想将 div 100px 向左移动

```
margin: 0 auto 0 [auto minus 100px]; 
```

所以它在中心左侧100px。

我如何用 CSS 做到这一点？

* * *

笔记：

此 div 覆盖在另一个 div 之上。我**不能**把它放在另一个更大的 div 中。

```
<style>
#one {
 width: 100px;
 margin: ?
}
</style>
<div id="one">
sdgdgffdsg
</div> 
```

* * *

## 更新：已解决

GGG 在评论中给了我解决方案。

```
position: absolute;
left: -100px;
margin: 0 auto; 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-25T22:13:15.757

**使用**居中**`margin: 0 auto;`
并使用**左移**`position: relative; left: -100px;`**

 **```
position:relative;
margin:0 auto;
left:-100px; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T22:12:24.970

试试这个：

```
position:relative; left:-100px; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-25T22:00:24.820

你没有。您必须包裹另一个具有固定边距的元素。

```
<div id="foo">
  <div id="bar">Hi!</div>
</div>

#foo {
  margin: 0 100px 0 0; /* left margin only is 100px */
}

#bar {
  margin: 0 auto;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-25T22:11:38.840

你的内部 div 有固定的宽度吗？如果是这样，你可以这样做：

HTML

```
<div class="outside">
    <div class="inside">
    </div>
</div> 
```

CSS

```
.inside {
    position: absolute;
    width: 100px;
    height: 100px;
    left: 50%;
    top: 50%;
    margin: -50px 0 0 -150px;
} 
```**

# ruby-on-rails-3 - Custom lookup field on rails 3 form

> ID：10324412
> 
> 赞同：0
> 
> 时间：2012-04-25T21:56:50.690
> 
> 标签：ruby-on-rails-3, activerecord

So heres what I am trying to do:

I want a field that is text based, "a coupon code"

in a nested form.

So basically `f.text_field :coupon`

But that value should be a relationship to an item in a `coupons` table, but not by id.

Coupon table could look like

```
|ID| CouponCode |
+--+------------+
|1 | a89sd9asda |
+--+------------+ 
```

and my main table would look like

```
|ID| OrderTitle |   Coupon   |
+--+------------+------------+
|1 | sdfsdfsdfd | a89sd9asda |
+--+------------+------------+ 
```

Is there a way in rails to link these two via a has_one and use a non ID field?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:12:02.847

To answer your question:

```
class Order < ActiveRecord::Base
   has_one :coupon_code, :foreign_key => 'CouponCode'
end

class CouponCode < ActiveRecord::Base
   belongs_to :order, :foreign_key => 'CouponCode'
end 
```

However, I agree with damien: this looks a bit off of the common db design approaches.

# java - 如何在 Spring AOP 中访问实际的方法参数名称？

> ID：10324416
> 
> 赞同：2
> 
> 时间：2012-04-25T21:57:16.907
> 
> 标签：java, spring, reflection, aop

我迫切需要这方面的帮助。我一直在寻找一种方法来做到这一点。我在 Tomcat 7 中运行的 Web 应用程序中使用 Spring AOP。我正在尝试使用 @Before 建议来打印方法切入点的实际参数的名称和值。首先，我认为只需使用 -g 选项编译类文件就可以了。那没有用。然后我在某处的一篇文章中读到，使用 AspectJ 加载时编织肯定会成功。所以我为Tomcat 7做了以下事情：

在我的 context.xml 中

```
<Loader loaderClass="org.springframework.instrument.classloading.tomcat.TomcatInstrumentableClassLoader"/> 
```

在我的 config.xml

```
<context:load-time-weaver weaver-class="org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver"/> 
```

但是当我调用 MethodSignature.getParameterNames() 时，它仍然返回 null。

所以我的问题是：有没有办法从建议中获取方法的参数名称？如果有怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:05:33.470

需要使用调试信息进行编译。

然后您可以使用 的实例`org.springframework.core.LocalVariableTableParameterNameDiscoverer`来解析参数名称。

# javascript - Blob 的数据 URI 损坏图像

> ID：10324421
> 
> 赞同：0
> 
> 时间：2012-04-25T21:57:49.637
> 
> 标签：javascript, html

我已经看过很多关于这个的帖子和很多答案，但我不能让它发挥作用。

我有一个画布，我保存到一个 base 64 编码的图像，效果很好。

```
capture: function(callback) {
    var ctx, imgData, src;
    ctx = canvas.getContext("2d");
    ctx.drawImage(video, 0, 0, video.width, video.height);
    imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    ctx.putImageData(imgData, 0, 0);
    src = canvas.toDataURL("image/jpeg");
    return src;
  } 
```

然后我可以将图像 src 设置为 base 64 编码字符串，一切正常。当我尝试将其转换为 blob 以便下载时，下载的文件将无法作为图像格式读取。

```
saveImage: function(dataURI) {
    var ab, bb, blob, byteString, i, ia, mimeString, _i, _len;
    if (dataURI.split(',')[0].indexOf('base64') >= 0) {
      byteString = atob(dataURI.split(',')[1]);
    } else {
      byteString = unescape(dataURI.split(',')[1]);
    }
    mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
    ab = new ArrayBuffer(byteString.length);
    ia = new Uint8Array(ab);
    for (_i = 0, _len = byteString.length; _i < _len; _i++) {
      i = byteString[_i];
      ia[i] = byteString.charCodeAt(i);
    }
    bb = new BlobBuilder();
    bb.append(ab);
    blob = bb.getBlob(mimeString);
    return saveAs(blob);
  } 
```

所有这些代码对我来说似乎都很好，但是下载时生成的文件不会被识别为有效图像。

我有一种感觉，我在数据 url 中有转义错误，但我找不到在哪里。

我正在使用 Chrome Canary 进行开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:01:40.270

读取位置的 charCode `_i`，而不是`i`。

```
 ia[_i] = byteString.charCodeAt(_i); 
```

# android - 在 Android 中使用 QR 码进行定位

> ID：10324427
> 
> 赞同：-1
> 
> 时间：2012-04-25T21:58:47.630
> 
> 标签：android, android-camera, qr-code

我想使用二维码获取智能手机的位置（UTM 或纬度/经度）。看了[这篇文章](http://mirror2image.wordpress.com/2009/12/09/google-googles-qr-codes-localization/)，貌似可以得到智能手机的位置。另外，我想在相机屏幕上渲染一些 3D 模型。可能吗？其实我不知道我应该从哪里开始。

任何人都可以帮我解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:14:16.797

如果你仔细阅读那篇文章，它所建议的获取手机位置的方法就是简单地在二维码本身中编码纬度/经度。这只有在显示的二维码的位置是固定的（例如墙上的贴纸而不是传单上的标签）时才有效。

是否可以在相机屏幕上渲染 3D 模型？当然。它不会是默认的相机应用程序，您必须自己制作。如果您想相对于 QR 码定位 3D 模型，这将涉及相当多的数学运算。您可能会尝试根据正方形的边构建平面。

# android - 如何在运行时禁用 AlertDialog 的正按钮？

> ID：10324435
> 
> 赞同：4
> 
> 时间：2012-04-25T22:00:05.593
> 
> 标签：android, android-widget

有没有办法在运行时禁用 AlertDialog 的正按钮，比如在 TextWatcher 中？

```
AlertDialog.Builder(this)
                    .setTitle(getString(R.string.createvfs))
                    .setView(newVSView_v11)
                    .setPositiveButton(getString(R.string.okay),
                            new DialogInterface.OnClickListener() {

                                @Override
                                public void onClick(DialogInterface dialog,
                                        int whichButton) {
                                }
                            })
                    .setNegativeButton(getString(R.string.cancel),
                            new DialogInterface.OnClickListener() {
                                @Override
                                public void onClick(DialogInterface dialog,
                                        int whichButton) {
                                    // Canceled.
                                }
                            }).show(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T22:06:54.360

您需要获取对对话框本身的引用以便稍后对其进行修改，因此您必须稍微更改您的构建器，但是您可以随时调用`AlertDialog.getButton()`以启用或禁用该按钮。像这样的东西...

```
//Use create() so you can get the instance back
AlertDialog dialog = AlertDialog.Builder(this)
                .setTitle(getString(R.string.createvfs))
                .setView(newVSView_v11)
                .setPositiveButton(getString(R.string.okay),
                        new DialogInterface.OnClickListener() {

                            @Override
                            public void onClick(DialogInterface dialog,
                                    int whichButton) {
                            }
                        })
                .setNegativeButton(getString(R.string.cancel),
                        new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog,
                                    int whichButton) {
                                // Canceled.
                            }
                        }).create();
//Then show it
dialog.show();

/* ...Sometime in the distance future... */
dialog.getButton(DialogInterface.BUTTON_POSITIVE).setEnabled(false); 
```

如果你真的想让按钮不可见，那就有点困难了。我目前无法测试`setVisibility()`按下按钮是否会产生良好的结果......

高温高压

# html - 无法为电子邮件中访问的链接设置颜色

> ID：10324437
> 
> 赞同：13
> 
> 时间：2012-04-25T22:00:17.357
> 
> 标签：html, css, email

这是一个简单的问题，我很难找到答案。我正在设置链接的颜色，如下所示：

```
<a style="color:#3067b3;text-decoration:none;" href="#">colored link</a> 
```

但是当我点击链接时，它会无缘无故地变成白色，我无法将它改回来。有人知道这是为什么吗？

注意：我正在设计一封电子邮件，旨在在不同的电子邮件客户端中看起来正确。否则我会在 CSS 文件中指定样式。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-05-09T14:27:46.170

斯蒂芬的解决方案确实对我有用。我还不能发表评论，所以这是 Rajneesh 要求的必要代码：

```
<a href="http://www.example.org" style="text-decoration: none; color: #EC7405;">
    <strong style="text-decoration: none; color: #EC7405;">Example Link</strong>
</a> 
```

确保使用 <strong>，我先用 <span> 尝试过，但是没有用，出于某种原因它需要是 <strong> 标签。还要确保在 <a> 中至少添加“text-decoration: none”样式，否则单击链接后可能会出现下划线。我使用了确定的解决方案并将完整样式添加到 <a> 和 <strong> 中，比抱歉更安全；）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-19T17:41:04.993

我遇到了同样的问题，发现在链接文本周围添加一个强标签可以防止它在点击时变成紫色。如果您不希望链接为粗体，只需将 font-weight:normal 添加到强标签

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-04-16T08:30:10.283

根据我的经验，最好的方法是使用标准正文链接`vlink`，它在 Outlook 中确实有效

```
<body link="#DD0000" vlink="#DD0000">
 <a href="#">Here</a>
  </body>
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-11T15:00:56.333

大多数电子邮件客户端将完全忽略任何非内联的 CSS，因此外部样式表不是要走的路

# java - 在 Java 中，如何将 JLabel 添加到矩形？

> ID：10324440
> 
> 赞同：2
> 
> 时间：2012-04-25T22:00:23.573
> 
> 标签：java, swing, jpanel, paintcomponent, jcomponent

我正在尝试将 JLabel 添加到我的健康栏上，该健康栏是由红色矩形顶部的绿色矩形模拟的。尽管我声明了一个 JLabel 并将其附加到我的 rectangleComponent，但它从未出现过。有任何想法吗？这是我的 rectangleComponent 和它初始化的 Frame。

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.geom.Rectangle2D;

import javax.swing.JComponent;
import javax.swing.JLabel;

public class RectangleComponent extends JComponent
{
    private Color color;
    private int width;
    private int height;
    private int origWidth;
    private JLabel label;
    private Rectangle2D rectangle;
    private boolean wantLabel;
    private int xCoord;
    private int yCoord;

    public RectangleComponent(int x, int y, Color color, int width, int height, boolean wantLabel)
    {
        this.width = width;
        this.height = height;
        this.color = color;
        origWidth = width;
        xCoord = x;
        yCoord = y;
        this.wantLabel = wantLabel;
        if(wantLabel)
        {
            label = new JLabel(this.width + "/" + origWidth);
            label.setLabelFor(this);
        }
        setBounds(xCoord, yCoord, width, height);
        rectangle = new Rectangle2D.Float(xCoord, yCoord, width, height);
    }

    public RectangleComponent(int x, int y, Color color, boolean wantLabel)
    {
        width = 125;
        height = 18;
        xCoord = x;
        yCoord = y;
        this.color = color;
        origWidth = width;
        this.wantLabel = wantLabel;
        if(wantLabel)
        {
            label = new JLabel(this.width + "/" + origWidth);
            label.setLabelFor(this);
        }
        setBounds(xCoord, yCoord, width, height);
        rectangle = new Rectangle2D.Float(xCoord, yCoord, width, height);
    }

    public void paintComponent(Graphics g)
    {
        Graphics2D graphics2 = (Graphics2D) g;
        rectangle = new Rectangle2D.Float(xCoord, yCoord, width, height);
        graphics2.setPaint(color);
        graphics2.fill(rectangle);
        graphics2.draw(rectangle); 
        if(wantLabel)
            label.setText(this.width + "/" + origWidth);
    }

    public Dimension getPreferredSize()
    {
        return (new Dimension(width, height));
    }

    public void subtractLife(int amount)
    {
        width -= amount;
        if(width > 0)
        {
            rectangle.setRect(xCoord, yCoord, width, height);
            repaint();
        }
        else
            width = 0;
    }

    public void addLife(int amount)
    {
        width += amount;
        if(width < origWidth)
        {
            rectangle.setRect(xCoord, yCoord, width, height);
            repaint();
        }
        else width = origWidth;
    }
}

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.FlowLayout;
import java.awt.GridLayout;

import javax.swing.JFrame;
import javax.swing.JPanel;

public class GameFrame extends JFrame
{
    private SpellBarComponent bar;
    private JPanel mainPanel = new JPanel();
    private JPanel buttonPanel = new JPanel();
    Color green = new Color(29, 180, 29);
    Color red = new Color(255, 0, 0);
    private RectangleComponent life;
    private RectangleComponent death;

    public GameFrame(char x)
    {
        setSize(1024, 768);
        setTitle("Game");
        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        mainPanel.setLayout(null);
        createPanels(x);
        buttonPanel.setLayout(new FlowLayout(FlowLayout.LEFT, 5, 5));
        repaint();
        getContentPane().add(mainPanel, BorderLayout.CENTER);
        getContentPane().add(buttonPanel, BorderLayout.PAGE_END);
        setExtendedState(getExtendedState() | JFrame.MAXIMIZED_BOTH);
        setLocationByPlatform(true);
        life.subtractLife(10);
        setVisible(true);

    }

    public RectangleComponent getLife()
    {
        return life;
    }

    private void createHealth()
    {
        life = new RectangleComponent(0, 0, green, true);
        death = new RectangleComponent(0, 0, red, true);
    }

    private void createPanels(char x)
    {
        createBar(x);
        createHealth();
        mainPanel.add(buttonPanel);
        mainPanel.add(life);
        mainPanel.add(death);
        buttonPanel.add(bar.getSpell1());
        buttonPanel.add(bar.getSpell2());
        buttonPanel.add(bar.getSpell3());
    }

    private void createBar(char x)
    {
        bar = new SpellBarComponent(x);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:27:05.393

您缺少调用`add(label)`您的组件。因此，您的标签没有附加到它上面。顺便说一句，我认为如果不是禁止的话，真的不鼓励修改您的paintComponent 中的标签。您应该在修改 widh 和/或 origWidth 时执行该调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:41:03.727

在我看来，您在paintComponent 中缺少对label.paint() 的调用。或者，我认为您可以在构造函数中调用 add(label) ，将标签添加为该容器的子项，并让 paintChildren 处理它。

由于您想要的只是一个带有自定义背景的标签，因此最好扩展 JLabel，覆盖paintComponent 来绘制自定义背景，然后调用 super.paintComponent 来绘制前景。

# wcf - wcf 服务的子属性的结果为空

> ID：10324442
> 
> 赞同：0
> 
> 时间：2012-04-25T22:00:25.570
> 
> 标签：wcf, properties, subclass

好的，所以我的 WCF 服务中有两个看起来像这样的对象。当我的 User 类中的 MyProfile 属性返回到客户端时，它的所有属性都为空；然而，没有别的了。

```
[DataContract]
[Serializable]
public class User { 

    private WebProfile.UserTable _MyProfile;

    public WebProfile.UserTable MyProfile { 
        get { return _MyProfile; }
        set { _MyProfile = value; }
    }
}

[DataContract]
[Serializable]
public class WebProfile { 

    [DataContract]
    [Serializable]
    public class UserTable { 

    }
} 
```

在 WCF 服务上，它看起来像这样。

```
#region User Contract...
[ServiceContract]
public interface IUser {
    List<User> GetAllUsers();
}
#endregion

public List<User> GetAllUsers() {
    return _users;
} 
```

我只列出了有问题的属性，因为我相信它特定于该属性在子类中。

这是我所做的。我已经验证数据实际上是从数据库中从服务端的数据库中获取的。此外，该 MyProfile 通过事件日志具有其​​属性的值。

当客户端请求用户列表时，我会写入托管服务的服务器上的事件日志，以确保 MyProfile 的属性具有值。所以问题要么是客户端反序列化信息，要么是服务器将其序列化以发送给客户端。我的 WebProfile 类是否可能需要用某种类型的属性进行装饰？

同样，我已经验证了用户返回的所有额外属性的值，并且在对象离开服务器之前填充了这些值。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:09:03.787

所述对象的类的所有属性都没有使用 [DataMember] 属性进行修饰。

# java - Java 小程序在 Mac 上闪烁

> ID：10324444
> 
> 赞同：5
> 
> 时间：2012-04-25T22:00:45.027
> 
> 标签：java, swing, japplet, flicker

**这个问题很奇怪**。**并非每个平台都会出现**此问题。它发生在我使用 MacOSX 的 Google Chrome 中，但它不会发生在 Safari 中。对于使用 Windows 的朋友来说，在 Google Chrome 上它可以完美运行。我还有一个使用 MacOSX 的朋友，对他来说，它在 Chrome、Safari 和 Firefox 上闪烁。我们都有 MacOSX Lion。我没有看到任何链接。**你们能否测试它并报告它是否发生，以及您的平台是什么（最多应在 30 秒内发生）？**

* * *

我[在 Oracle 的论坛上找到了这个帖子](https://forums.oracle.com/forums/thread.jspa?messageID=10267732)。显然，这是 MacOSX 上的一个众所周知的问题，因为 Java 创建了一个子进程，而 Safari 不允许将此作为​​安全功能。然而，这个问题也出现在 Mac 上的 Chrome 和 Firefox 中（对于我来说，Safari 上没有）。去想……我很高兴听到任何人对此的看法。

* * *

我目前正在制作一个小型 Java 俄罗斯方块游戏，我的问题是在小程序版本（扩展 JApplet）中屏幕偶尔会闪烁。当我在计算机上的 JFrame 中运行它时，一切正常。

这个小程序可以在这个网站上查看和使用：http: [//mtetris.herokuapp.com/](http://mtetris.herokuapp.com/)（我不是想做广告或宣传任何东西，我只是把它放出来，这样人们就可以真正看到问题所在）。

（还有另一个问题是，当小程序没有自动加载时，它不能正确获得鼠标焦点——即当浏览器阻止它并询问用户是否允许加载它时。如果“开始级别”数字没有正确突出显示，这就是原因。）

以下是我尝试过的未能解决闪烁问题的方法：

*   将小程序的背景、根窗格、内容窗格、小程序中的每个组件设置为黑色。
*   覆盖小程序的`paint()`方法并在其中进行双缓冲（我在当前代码中注释了这部分，因为它没有改进任何东西）
*   覆盖小程序的`update()`方法，直接调用（现在[根据官方文档中的方法描述](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JApplet.html#update%28java.awt.Graphics%29)`paint()`已经修复了这个问题）

整个源代码可以在[这个页面](https://github.com/rez-antlion/musical_tetris)的 github 上找到。扩展 JApplet 的类是 TetrisApplication。源代码还不是很干净，所以，很抱歉。

* * *

这就是我实现双缓冲的方式

```
public class TetrisApplication extends JApplet {

    //  the dimension of the applet
    private Dimension dimension;
    // image used for double buffering
    Image offscreen;
    // the second buffer
    Graphics bufferGraphics;

    public void init() {
        super.init();
        dimension = getSize();
        offscreen = createImage(dimension.width, dimension.height);
        bufferGraphics = offscreen.getGraphics();
        ...
    }

    public void paint(Graphics g){
        bufferGraphics.clearRect(0, 0, dimension.width, dimension.height);
        super.paint(bufferGraphics);
        g.drawImage(offscreen, 0, 0, this);
    }
    ...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T02:50:14.543

为了更平滑的绘制，覆盖的`paintComponent()`方法`JPanel`，默认情况下是双缓冲的。这个[答案](https://stackoverflow.com/a/9106263/230513)讨论了一个例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:22:40.417

我注意到`GameController`您正在使用后台线程（在 a 中`SwingWorker`）来更新状态。我怀疑当更新发生`paint()`在`GamePanel`.

更好的方法可能是将所有内容推送到 EDT，使用 a`java.swing.Timer`触发每一帧并导致状态更新，然后使用`repaint()`. 然后就没有同步问题了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:11:56.367

要停止轻弹，您需要对绘图表面进行双重缓冲。您确定您第一次正确实施了吗？

也许这会有所帮助：[https ://gamedev.stackexchange.com/questions/18661/how-do-i-prevent-flickering-when-drawing-to-a-jpanel](https://gamedev.stackexchange.com/questions/18661/how-do-i-prevent-flickering-when-drawing-to-a-jpanel)

# xpages - 如何从 Java Bean 调用临时 SSJS

> ID：10324445
> 
> 赞同：1
> 
> 时间：2012-04-25T22:00:46.273
> 
> 标签：xpages, serverside-javascript

我需要从类似于[this issue](https://stackoverflow.com/questions/9099093/calling-ssjs-from-java)的java bean调用ssjs 。问题是我需要执行的代码来自配置文档，可能看起来像：

```
getComponent("xxx").getValue(); 
```

我已经建立了一个版本：

```
String compute = doc.getItemValueString("SSJSStuff");
String valueExpr = "#{javascript:" + compute + "}";
FacesContext fc = FacesContext.getCurrentInstance();
Application app = fc.getApplication();
ValueBinding vb = app.createValueBinding(valueExpr);
String vreslt = vb.getValue(fc).toString(); 
```

但我明白了`"Exception in xxx: com.ibm.xsp.exception.EvaluationExceptionEx: Error while executing JavaScript computed expression"`

我想我已经很近了，但我看不到山那边..有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T06:16:15.423

有几种可能性：

1.  变量*计算*为空

2.  *计算*包含非法字符

3.  *计算*中的代码格式错误/没有正确的语法

4.  SSJS 代码中不返回任何对象：

    如果您的 SSJS 代码未返回任何内容，*则 vb.getValue(fc)*将返回*null*。*toString()*将失败。为了防止这种情况，您应该明确地转换您的返回对象：

    ```
    vreslt = (String) vb.getValue(fc); 
    ```

希望这可以帮助

斯文

**编辑**：
重新阅读您的帖子后，我看到您想在动态 SSJS 代码中执行*getComponent*。这不适用于添加到*javax.faces.application.Application*的值绑定。为此，您必须改用*com.ibm.xsp.page.compiled.ExpressionEvaluatorImpl*对象：

```
String valueExpr = "#{javascript:" + compute + "}";
FacesContext fc = FacesContext.getCurrentInstance();
ExpressionEvaluatorImpl evaluator = new ExpressionEvaluatorImpl( fc );
ValueBinding vb = evaluator.createValueBinding( fc.getViewRoot(), valueExpr, null, null);
vreslt = (String) vb.getValue(fc); 
```

# jquery - Jquery mobile 阻止从我的基于 django 的站点下载

> ID：10324450
> 
> 赞同：1
> 
> 时间：2012-04-25T22:01:13.347
> 
> 标签：jquery, django, jquery-mobile, django-templates, django-views

我的网站上有一个下载链接（基于 Django），在我开始使用 jQuery-mobile 之前效果很好。现在，当我尝试点击下载链接时，jQuery-mobile 加载屏幕出现并随着加载图标的旋转无限期挂起。

我试过在没有 jQuery 和 jQuery-mobile 的情况下运行，并且下载有效。我也尝试过只使用 jQuery 而没有 jQuery-mobile 并且下载工作正常。

考虑到所有这些，这似乎是 jQuery-mobile 的页面加载功能的问题，但我不知道从哪里开始，如果是这种情况，我希望在谷歌搜索时会看到很多类似的问题。

以防万一它有帮助的是文件下载视图中的标题：

```
content_type = 'application/force-download'
response['Content-Length'] = file_size
response['Content-Disposition'] = 'attachment; filename="%s"' % file_name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:05:28.183

看起来您在 content_type 中有错字，应该是：

```
content_type = 'application/force-download' 
```

此外，最后一行缺少 %：

```
response['Content-Disposition'] = 'attachment; filename="%s"' % file_name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-05T13:40:47.980

不是最令人满意的工作轮次，但我发现如果我通过在我的链接中添加 target="_blank" 在新选项卡中打开下载，然后下载没有问题。

# java - Java读取csv文件并分别列出重复出现

> ID：10324451
> 
> 赞同：0
> 
> 时间：2012-04-25T22:01:15.433
> 
> 标签：java, csv

下面是我用于读取 .csv 文件并打印输出的程序，但我无法实现输入和输出中提到的以下功能。如果用户 ID 在 2 个不同的组中可用，我基本上希望单独列出用户 ID。

我的输入是这样的：

```
User ID       Group

ABC           Group1   
DEF           Group2
ABC           Group3
GHI           Group4 
```

由于 ABC 在 2 个不同的组中可用，我需要输出为：

```
ABC     Group1
ABC     Group3 
```

你能帮忙吗？

```
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.FileWriter;
import java.util.StringTokenizer;

public class dumpRead {
    public static void main(String[] args) {
        try {

            //csv file containing data
            String strFile = "C:/Tracker/read/data.csv";

            //create BufferedReader to read csv file
            BufferedReader br = new BufferedReader( new FileReader(strFile));
            String strLine = "";
            StringTokenizer st = null;
            int lineNumber = 0, tokenNumber = 0;

            //read comma separated file line by line
            while( (strLine = br.readLine()) != null){
                lineNumber++;

                //break comma separated line using ","
                st = new StringTokenizer(strLine, ",");

                while(st.hasMoreTokens()){
                    //display csv values
                    tokenNumber++;
                    System.out.println("Token # " + tokenNumber 
                    + ", Token : "+ st.nextToken());
                }

                //reset token number
                tokenNumber = 0;                        
            }
        }
        catch(Exception e) {
            System.out.println("Exception while reading csv file: " +     e);                   
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:17:24.983

解析所有用户 id 并将其放入 HashMap>

对于每个userid，检查hashmap中是否已经存在，如果已经存在，则获取对应的Set并将其添加到列表的末尾。如果 hashmap 不包含用户，则创建一个新的 HashSet 并添加组

注意：HashSet 背后的想法是它会忽略重复项

伪代码将是这样的，

```
for(string user: users)
{
  if(hashmap.contains(user))
    {
       HashSet<Sting> usergroups = hashmap.get(user);
       usergroups.add(group);
    }
   else
    {
      HashSet<String> groups = new HashSet<String> ();
       groups.add(group);
    }
} 
```

# php - 使用 Google TV 模板时，如何使用 AJAX、PHP 和 MySQL 为动态视频源实现后端？

> ID：10324457
> 
> 赞同：1
> 
> 时间：2012-04-25T22:02:04.857
> 
> 标签：php, javascript, ajax, google-tv

对于有兴趣为 Google TV 开发网络应用程序的人，尤其是那些有视频内容的人，最简单的方法是使用 Google TV 模板：[https](https://developers.google.com/tv/web/docs/gtv-templates) ://developers.google.com/tv/web/docs/gtv-templates 。

最初的 Google TV 模板是使用 Javascript 文件硬编码的视频源文件开发的。许多人询问如何使用 PHP 和 MySQL 实现后端并将视频源存储在那里，以便可以从模板中的前端动态加载。下面的文章就是为了解决这个问题而写的。

[https://developers.google.com/tv/web/docs/ajax_gtv_templates_tutorial](https://developers.google.com/tv/web/docs/ajax_gtv_templates_tutorial)

本教程将引导您了解如何在 MySQL 中设置数据库（即模式、示例数据）、提供数据的 PHP 代码以及修改 Javascript 以进行 AJAX 加载。

目前要将视频源数据添加到数据库中，可以直接使用 SQL，但可能更希望构建一个 PHP 管理前端。

Maurizio 最近在 Google TV 开发者 + 页面上报告了一个错误： https: [//plus.google.com/117492290125593364976/posts](https://plus.google.com/117492290125593364976/posts)：

“嗨，我下载了 html5 模板 mysql 版本。它工作正常，但如果我添加多个类别，最后添加的类别会重复。你知道如何解决这个问题吗？非常感谢。”

我会跟进修复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T06:02:48.417

可以修复此错误，新下载地址为： http: [//gtv-resources.googlecode.com/files/gtv_template2_ajax_php_mysql.tgz](http://gtv-resources.googlecode.com/files/gtv_template2_ajax_php_mysql.tgz)

实际的修复在这个 php 文件中：

[http://code.google.com/p/gtv-resources/source/browse/trunk/gtv_template2_ajax_php_mysql/videosources.php](http://code.google.com/p/gtv-resources/source/browse/trunk/gtv_template2_ajax_php_mysql/videosources.php)

如果有兴趣，请提出问题，我也会写一个管理页面。

# facebook - 未使用 opengraph 数据中的书作者？

> ID：10324458
> 
> 赞同：1
> 
> 时间：2012-04-25T22:02:12.403
> 
> 标签：facebook, facebook-opengraph

我的网站包含有关书籍的信息，并且包含开放的图形数据。事情似乎大多奏效。我已将 og:title 设置为书名。对于我能找到的人，或者关于他们的页面，我在 book:author 中将 url 添加到该页面。但是作者信息似乎没有发生任何事情，而且我无法（对于普通用户）看到这本书的作者是谁。这是正常的，还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T14:10:49.760

我想如果你只是像书一样使用，作者信息不会出现在任何地方。但是您可以进行任何 FB opengraph 操作，在这种情况下，您可以在墙帖或聚合中看到作者的姓名。

但要小心，FB 文档有点棘手：

```
<meta property="book:author" content="Who wrote this"> 
```

但是，内容必须是 URL，而不是此处的作者姓名，并且作者页面 og 需要包含 og:profile 标签。

# php - 如何定向到移动网站/模板？

> ID：10324464
> 
> 赞同：-1
> 
> 时间：2012-04-25T22:02:41.640
> 
> 标签：php, mobile, joomla, joomla2.5

我想知道如何在 j2.5 站点上为移动用户显示模板以及为桌面用户显示模板？这可能不使用子域吗？

如果不是，那么检测移动用户并仅显示替代 .css 文件（而不是不同的模板）的最有效方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:06:41.620

您可以通过浏览器用户代理检测用户浏览器（包括手机）。在 PHP 中，这可以通过

```
$_SERVER['HTTP_USER_AGENT'] 
```

这将显示一个字符串

```
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.165 Safari/535.19 
```

那是我目前在 MacBook 上使用 Chrome 的用户代理。

您可以针对此字符串运行正则表达式匹配以匹配已知的移动浏览器并将其重定向到网站的移动版本。大多数网站使用一个`m.`或`mobile.`子域。

# ios - 如何使用故事板 segue 使目标视图成为窗口的子视图？

> ID：10324465
> 
> 赞同：0
> 
> 时间：2012-04-25T22:02:51.647
> 
> 标签：ios, storyboard, fullscreen

我正在使用情节提要并尝试从条形视图切换到全屏视图，其中条形视图的父视图与条形视图的大小相同并且正在剪切子视图，但我希望目标视图能够全屏显示。有没有一种简单的方法可以通过设置 segue 或目标视图控制器的属性来做到这一点？这样做的正确方法是什么？我真的很想让全屏视图成为窗口的子视图。

感谢您的任何建议！

*   卢维里奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T20:15:03.200

I had to go around the segue by manually instantiate the target view controller and add it as the window's `rootViewController`.

# design-patterns - nodejs express框架的块到区域（如drupal）模板系统

> ID：10324473
> 
> 赞同：0
> 
> 时间：2012-04-25T22:03:31.320
> 
> 标签：design-patterns, node.js, express

我正在使用 nodejs **express**框架。有 2 个独立的 express 应用程序（auth 和 service），它们与**connect** npm 模块**vhost**模块合并，如下所示：

```
    // 合并应用
    express.createServer()
    //子域解析器
    .use(函数(req, res, next){
      req.subdomain = getSubdomain(req.headers.host);
      下一个（）;
    })
    .use(express.vhost('auth.' + domain, authApp))
    .use(express.vhost('*.' + domain, serviceApp))
    .听（端口）；

```

我想在应用程序模板区域（页眉、侧边栏、页脚等）之间共享，并使用应用程序模板块（类似于 php Drupal 主题系统）提供的填充区域。

如何在没有反模式的情况下让它变得更好？也许已经有一些有用的模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T08:45:21.687

如果您正在寻找 express 的模板引擎，请注意[Jade](http://jade-lang.com/)。这是一种 [常用](http://expressjs.com/guide.html#view-rendering)的表达方式。您可以使用两个应用程序之间共享的一些模板。Jade 经常与[Stylus](http://learnboost.github.com/stylus/)一起使用。

# php - PHP PDO 选择 ID

> ID：10324482
> 
> 赞同：0
> 
> 时间：2012-04-25T22:04:52.083
> 
> 标签：php, pdo

我正在从[NetTuts](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)学习 PDO，到目前为止，我已经成功地根据字符串搜索 FETCH_ASSOC。

问题：`PDO::`按整数搜索需要哪个？我以为是`PDO::Fetch_OBJ`。以下返回错误。

```
$busid = $this->sanitize($string);

$database->query('SELECT name, address FROM business_information WHERE id = :id', array(':id' => $busid));  
var_dump($database);
    if($database->count() >= '1') {
                $results->setFetchMode(PDO::FETCH_OBJ); 
                   while($row = $results->fetch()) { 
                        $test = "Name: ".$row['name']." Address: ".$row['address'];             

    }else{
        $test = "no results were found";

    } 
```

var_dump 返回：

> 对象（数据库）#1 (7) {["pdo":"database":private]=> object(PDO)#2 (0) { } ["port"]=> int(3306) ["statement"] => object(PDOStatement)#6 (1) { ["queryString"]=> string(61) "SELECT name, address FROM business_information WHERE id = :id" } }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:23:50.107

`prepare`在将它发送到数据库之前，您可能想要一个语句。为什么？[答案就在PDO::prepare](http://www.php.net/manual/en/pdo.prepare.php)附近。当您使用`prepare`时，您会发现自己持有 a`PDOStatement`作为返回值。

好的。让我们将值绑定到一个占位符：[PDOStatement::bindValue](http://www.php.net/manual/en/pdostatement.bindvalue.php)

看一下签名：

```
`bool PDOStatement::bindValue(mixed $parameter,
                              mixed $value
                              [,int $data_type=PDO::PARAM_STR])` 
```

`data_type`: 使用 PDO::PARAM_* 常量的参数的显式数据类型。您可以`data_type`手动设置，但在 99% 的时间里没有必要。（正如我发现的那样。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:32:40.883

1）准备好的陈述比消毒更好。
2) PDO::query 有另一个签名，请阅读手册。

```
/** @var \PDO $PDO */
$query = $PDO->prepare('SELECT name, address FROM business_information WHERE id = :id');
if (!$query) return false;
if (!$query->execute(array(':id' => $busid))) return false;
$results = $query->fetchAll(\PDO::FETCH_ASSOC);
if (empty($results)) return false;
foreach ($results as $row)
{
    $test = "Name: ".$row['name']." Address: ".$row['address'];
    echo $test, PHP_EOL;
} 
```

# c# - Invoke 没有适当地更新 GUI

> ID：10324487
> 
> 赞同：1
> 
> 时间：2012-04-25T22:05:22.353
> 
> 标签：c#, multithreading, invoke, begininvoke

我是为一堂气象课写的。出于某种原因，GUI 上的文本框没有针对大量（大量光子）正确更新。计算完成，但文本框不更新。

我怀疑问题出在调用 Invoke() 上，但我一辈子都看不到出了什么问题。我尝试过使用 Invoke() 和 BeginInvoke() 并获得类似的结果。

任何人都可以帮助找出我要去哪里错了吗？

谢谢！

PS> 请原谅全局变量。本来打算以后清理的。。。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Threading;

namespace CloudTransmittance
{
public partial class Form1 : Form
{

    public Form1()
    {
        InitializeComponent();
    }

    private void buttonCalculate_Click(object sender, EventArgs e)
    {

        Thread t = new Thread(calculateModel);
        t.Start();

    }

    //number of photons that have gone to albedo, direct, or diffuse transmittance
    private ulong top = 0;
    private ulong direct = 0;
    private ulong diffuse = 0;
    private ulong absorbed = 0;
    private ulong failed = 0;
    private ulong photons = 0;

    private void calculateModel()
    {
        //model variables
        double theta = 0;
        double tauStar = 0;
        double omega = 0;
        double g = 0;
        photons = 0;

        //Get data from form
        theta = Convert.ToDouble(textBoxTheta.Text);
        tauStar = Convert.ToDouble(textBoxTau.Text);
        omega = Convert.ToDouble(textBoxOmega.Text);
        g = Convert.ToDouble(textBoxG.Text);
        photons = Convert.ToUInt64(textBoxPhotons.Text);

        //Clear the progress bar and set its limits

        this.progressBar1.BeginInvoke(
            (MethodInvoker)delegate()
            {
                this.progressBar1.Minimum = 0;
                this.progressBar1.Value = 0;
                this.progressBar1.Maximum = (int)photons;
                this.progressBar1.Step = 1;
            });

        //Clear the text boxes
        this.textBoxAlbedo.Invoke(
            (MethodInvoker)delegate()
             {
                  this.textBoxAlbedo.Text = "";
             });
        this.textBoxDirect.Invoke(
           (MethodInvoker)delegate()
           {
               this.textBoxDirect.Text = "";
           });
        this.textBoxDiffuse.Invoke(
           (MethodInvoker)delegate()
           {
               this.textBoxDiffuse.Text = "";
           });
        this.textBox1.Invoke(
           (MethodInvoker)delegate()
           {
               this.textBox1.Text = "";
           });
        this.textBox2.Invoke(
           (MethodInvoker)delegate()
           {
               this.textBox2.Text = "";
           });

        //convert theta to radians from degrees
        theta *= Math.PI / 180;

        //number of photons that have gone to albedo, direct, or diffuse transmittance
        top = 0;
        direct = 0;
        diffuse = 0;
        absorbed = 0;
        failed = 0;

        //Random number generator
        Random r = new Random();
        double randomValue = 0;

        int count = 1000; //number of iterations of the problem...
        double delta = 0.00001; //close enough to "1" for calculations, since C# random goes from [0, 1) instead of [0, 1]
        //Calculate transmittance

        for (ulong photonCount = 0; photonCount < photons; photonCount++)
        {

            bool scattered = false;
            double newTheta = theta; //needed for looping
            int i = 0; //counting variable used to prevent infinite looping
            for (i = 0; i < count; i++)
            {
                double length = calculateTauP(); //length of the photon's travel
                double newTau = calculateTau(newTheta, length);
                if (newTau < 0)
                {
                    top++; //photon has exited through the top
                    break; //move to the next photon
                }
                else if (newTau > tauStar)
                {
                    //exited through the bottom of the cloud
                    if (scattered == false)
                    {
                        //direct transmittance
                        direct++;
                    }
                    else
                    {
                        //diffuse transmittance
                        diffuse++;
                    }
                    break;
                }
                else
                {
                    //photon is either scattered or absorbed
                    randomValue = r.NextDouble();
                    if (randomValue >= omega)  // || ((omega == 1) && (randomValue >= (omega - delta)) )
                    {
                        //photon absorbed, no longer of interest
                        absorbed++;
                        break;
                    }
                    else
                    {
                        //photon scattered, determine direction
                        scattered = true;
                        newTheta = calculateNewAngle(newTau, newTheta, g, randomValue);
                    }
                }
            }
            if (i >= count)
            {
                failed++;
            }
            this.progressBar1.BeginInvoke(
            (MethodInvoker)delegate()
            {
                this.progressBar1.PerformStep();
            });
        }

        //Update Form values
        displayData();
    }

    private void displayData()
    {
        if (this.textBoxAlbedo.InvokeRequired)
        {
            this.textBoxAlbedo.Invoke(
            (MethodInvoker)delegate()
            {
                this.textBoxAlbedo.Text = ((double)top / (double)photons).ToString();
            });
        }
        else
        {
            textBoxAlbedo.Text = ((double)top / (double)photons).ToString();
        }
        if (this.textBoxDirect.InvokeRequired)
        {
            this.textBoxDirect.Invoke(
               (MethodInvoker)delegate()
               {
                   this.textBoxDirect.Text = ((double)direct / (double)photons).ToString();
               });
        }
        else
        {
            textBoxDirect.Text = ((double)direct / (double)photons).ToString();
        }
        if (this.textBoxDiffuse.InvokeRequired)
        {
            this.textBoxDiffuse.Invoke(
               (MethodInvoker)delegate()
               {
                   this.textBoxDiffuse.Text = ((double)diffuse / (double)photons).ToString();
               });
        }
        else
        {
            textBoxDiffuse.Text = ((double)diffuse / (double)photons).ToString();
        }
        if (this.textBox1.InvokeRequired)
        {
            this.textBox1.Invoke(
               (MethodInvoker)delegate()
               {
                   this.textBox1.Text = absorbed.ToString();
               });
        }
        else
        {
            textBox1.Text = absorbed.ToString();
        }
        if (this.textBox2.InvokeRequired)
        {
            this.textBox2.Invoke(
               (MethodInvoker)delegate()
               {
                   this.textBox2.Text = failed.ToString();
               });
        }
        else
        {
            textBox2.Text = failed.ToString();
        }

    }

    private double calculateNewAngle(double length, double angle, double g, double randomNumber)
    {
        double newAngle = 0;
        double cos = (1 / (2 * g)) * (1 + Math.Pow(g, 2) - Math.Pow(((1 - Math.Pow(g, 2)) / (1 + g * (2 * randomNumber - 1))), 2));
        newAngle += angle + cos;
        while (newAngle >= 2 * Math.PI)
        {
            newAngle -= 2 * Math.PI; //normalize the angle to 0 <= angle < 2PI
        }

        return newAngle;
    }

    private double calculateTauP()
    {
        Random r = new Random();
        double distance = -1 * Math.Log(1 - r.NextDouble());
        return distance;
    }

    private double calculateTau(double angle, double tauP)
    {
        double tau = tauP * Math.Cos(Math.PI/2 - angle);
        return tau;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T14:49:54.423

停止使用`Invoke`并`BeginInvoke`更新 UI。尽管您可能被告知，但这并不是一个很好的解决方案。实际上，在这种情况下，您只想用进度信息更新 UI，这可能是最糟糕的解决方案。相反，让您的工作线程将其进度信息发布到可以与 UI 线程共享的不可变数据结构。然后让您的 UI 线程使用`System.Windows.Forms.Timer`.

```
public class YourForm : Form
{

  private class ProgressInfo
  {
    public ProgressInfo(ulong top, ulong direct, ulong diffuse, ulong absorbed, ulong failed, ulong photons)
    {
      // Set properties here.
    }

    public ulong Top { get; private set; }
    public ulong Direct { get; private set; }
    public ulong Diffuse { get; private set; }
    public ulong Dbsorbed { get; private set; }
    public ulong Failed { get; private set; }
    public ulong Photons { get; private set; }
  }

  private volatile ProgressInfo progress = null;

  private void calculateModel()
  {
    for (ulong photonCount = 0; photonCount < photons; photonCount++)
    {
      // Do your calculations here.

      // Publish new progress information.
      progress = new ProgressInfo(/* ... */);
    }
  }

  private void UpdateTimer_Tick(object sender, EventArgs args)
  {
    // Get a local reference to the data structure.
    // This is all that is needed since ProgressInfo is immutable
    // and the member was marked as volatile.
    ProgressInfo local = progress;
    this.textBoxAlbedo.Text = ((double)local.Top / (double)local.Photons).ToString();
    this.textBoxDirect.Text = ((double)local.Direct / (double)local.Photons).ToString();
    this.textBoxDiffuse.Text = ((double)local.Diffuse / (double)local.Photons).ToString();
    this.textBox1.Text = local.Absorbed.ToString();
    this.textBox2.Text = local.Failed.ToString();
  } 
```

注意这里的几件事。

*   代码更容易理解和遵循。
*   UI 线程决定何时以及多久更新一次它的控件。
*   您可以在工作线程上获得更多吞吐量，因为它不必像`Invoke`.

我经常使用这些`Invoke`和`BeginInvoke`解决方案，因为在许多情况下它们是糟糕的解决方案。使用 a`BackgroundWorker`稍微好一点，但它仍然迫使您使用更新 UI 的推送方法（尽管如此，通过幕后的相同编组技术）。pull 方法可以（并且通常是）更优雅的解决方案，并且通常更有效。

# objective-c - 截断字符串

> ID：10324492
> 
> 赞同：1
> 
> 时间：2012-04-25T22:05:41.323
> 
> 标签：objective-c, cocoa, nstableview

我有一个 NSTableView，它在一列中显示文件的路径。当用户调整 tableview 的大小时，我希望调整路径名（例如 /Users/name/testfile.m）的大小，但我希望路径名的结尾（例如 ...name/testfile.m）可见而不是默认情况下，路径的开始（例如 /Users/test/te...）。我编写了一个函数，它成功地完成了我想做的事情，但是当用户缩放 tableview 时，tableview 在重绘时会闪烁。我认为必须有一个更好、更优雅的算法来执行此操作，但我查看了 NSString 和[Stackoverflow](https://stackoverflow.com/questions/3303101/shorten-an-nsstring)的文档，但找不到任何能提供更好解决方案的东西。如果有人对此问题有更优雅的解决方案，将不胜感激。谢谢！干杯，特隆德

我目前的功能：

```
-(NSString *) truncateString:(NSString *) myString withFontSize:(int) myFontSize withMaxWidth:(NSInteger) maxWidth
{
    // Get the width of the current string for a given font
    NSFont *font = [NSFont systemFontOfSize:myFontSize];
    CGSize textSize = NSSizeToCGSize([myString sizeWithAttributes:[NSDictionary     dictionaryWithObject:font forKey: NSFontAttributeName]]);
    NSInteger lenURL =(int)textSize.width;

    // Prepare for new truncated string
    NSString *myStringShort;
    NSMutableString *truncatedString = [[myString mutableCopy] autorelease];

    // If the available width is smaller than the string, start truncating from first character
    if (lenURL > maxWidth)
    {
        // Get range for first character in string
        NSRange range = {0, 1};

        while ([truncatedString sizeWithAttributes:[NSDictionary dictionaryWithObject:font forKey: NSFontAttributeName]].width  > MAX(TKstringPad,maxWidth)) 
        {
            // Delete character at start of string
            [truncatedString deleteCharactersInRange:range];
        }     
        myStringShort = [NSString stringWithFormat:@"...%@",truncatedString];
    }
    else
    {
        myStringShort=myString;
    }
    return myStringShort;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T22:35:30.383

典型的方法很简单：

```
[tableViewCell setLineBreakMode:NSLineBreakByTruncatingHead]; 
```

正如 Dondragmer 所指出的，这个属性也可以在 Xcode 的 NIB 编辑器中设置。

# javascript - 如何在 Google 地图监听器中使用 bool？

> ID：10324495
> 
> 赞同：0
> 
> 时间：2012-04-25T22:05:56.903
> 
> 标签：javascript, google-maps-api-3, error-handling, boolean, dom-events

我在这个问题上停了 4 小时，`if`在调用 Google 地图事件时忽略了我的布尔值。我需要提供参数不同的数据。也许世界上有人知道为什么？

`console.log`在同一时间点击后抛出：

```
true before click
stack.html:56[object HTMLDivElement]in listener
stack.html:62[object HTMLDivElement]bunga bunga 
```

破布尔：

```
this.b = true;
...
console.log(this.b + " beafore click");
this.mapListener = google.maps.event.addListener(map, 'click', function(e) {
    console.log(this.b + "in listener");
    if (this.b==true) {
        console.log(this.b + "true works");
        tools[type](e.latLng, last_marker_origin);
        this.b = false;
    } else {
        console.log(this.b + "bunga bunga");
        //tools[type](e.latLng);
    }
}); 
```

`this`指的是我的对象默认设置为false的“属性”，但是当我更改选项时，它的标志为true。

我现在去睡觉。我会在早上回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:19:57.017

您的问题是它`this`不再是对您的`properties`. 处理您的特定问题的最简单方法是更改​​代码：

```
this.b = true;
var props = this;
console.log(this.b + " beafore click");  //Notice that "this" is still valid here 
this.mapListener = google.maps.event.addListener(map, 'click', function(e) {
    console.log(props.b + "in listener");
    if (props.b == true) {
        console.log(props.b + "true works");
        tools[type](e.latLng, last_marker_origin);
        props.b = false;
    } else {
        console.log(props.b + "bunga bunga");
        //tools[type](e.latLng);
    }
}); 
```

根本问题是实际调用回调函数的代码在完全不同的范围内，因此`this`当代码运行时， 的含义发生了变化。设置参考并将其放入代码中将解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:25:00.887

这里的问题是`this`. 当您在 click 事件处理函数内部时，`this`不再引用您的属性对象，而是指向事件处理程序。事件处理程序是一个所谓的[闭包](http://james.padolsey.com/javascript/closures-in-javascript/)。

您的问题有两种可能的解决方案。

1.  使用局部变量（`var b`而不是`this.b`）作为您的值，局部变量被复制到闭包中，因此可以在闭包内部和外部使用该值：

    ```
    var b = true;
    console.log(b + " beafore click");
    this.mapListener = google.maps.event.addListener(map, 'click', function(e) {
        console.log(b + "in listener");
        if (b==true) {
            console.log(b + "true works");
            tools[type](e.latLng, last_marker_origin);
            b = false;
        } else {
            console.log(b + "bunga bunga");
            //tools[type](e.latLng);
        }
    }); 
    ```

2.  保存`this`在局部变量中，这是避免范围问题的一种非常常见的技术：

    ```
    //save this in a locale variable, now 'me' provides access to this scope
    var me = this;
    me.b = true;
    console.log(me.b + " beafore click");
    this.mapListener = google.maps.event.addListener(map, 'click', function(e) {
        console.log(me.b + "in listener");
        if (me.b==true) {
            console.log(me.b + "true works");
            tools[type](e.latLng, last_marker_origin);
            me.b = false;
        } else {
            console.log(me.b + "bunga bunga");
            //tools[type](e.latLng);
        }
    }); 
    ```

# javascript - 将函数附加到 DOMWindow 对象

> ID：10324501
> 
> 赞同：11
> 
> 时间：2012-04-25T22:06:26.910
> 
> 标签：javascript

我有一个很好的小片段，用于获取浏览器位置：

```
if (!window.position) {
    window.position = function() {
        return navigator.appName.toLowerCase().indexOf("explorer") >= 0 ? { x: window.screenLeft, y: window.screenTop } : { x: window.screenX, y: window.screenY };
    };
}; 
```

它工作得很好，我想知道的是，任何人都知道（我似乎无法找到/记住它是否存在）是否有类似“_prototype”的东西，以便我可以永久附加该功能。如果我有类似的情况，这将很有用：

```
var bob =   window.open(...); 
```

那么我可以说：

```
var bobSposisition = bob.position(); // and of course get the same thing on bob that i'm getting on my current parent window. 
```

* * *

> *回答后*更新[添加有趣的片段！]

* * *

这个问题很老而且有点未经思考，但如果它对你有帮助，你可能也对下面的代码片段感兴趣！

```
;;(function() {
    "use strict";
    /** window.position
     *  Add `position` method to windows object that allows for detection of the current browser window position.
     *
     *  @returns Object Object of x and y points of current position. Also updates window.position properties, as neccesary.
     *  
     *  @property INT window.position.originX Original X point upon page load. Never updates, unless page is reloaded.
     *  @property INT window.position.originY Original Y point upon page load. Never updates, unless page is reloaded.
     *  @property INT window.position.lastX Last X Point at time of last call to window.position() method. Only updates if current position has changed since last call.
     *  @property INT window.position.lastY Last Y Point at time of last call to window.position() method. Only updates if current position has changed since last call.
     *  @property INT window.position.x Current X Point at time of last call to window.position() method. Updates everytime window.position() method is called.
     *  @property INT window.position.y Current Y Point at time of last call to window.position() method. Updates everytime window.position() method is called.
     */
    window['position'] = function() { var position = function() { var a = 0 <= navigator.appName.toLowerCase().indexOf("explorer") ? { x: window.screenLeft, y: window.screenTop } : { x: window.screenX, y: window.screenY }; void 0 == window.position && (window.position = {}); void 0 == window.position.history && (window.position.history = []); if (void 0 == window.position.lastX || a.x != window.position.x) window.position.lastX = window.position.x; if (void 0 == window.position.lastY || a.y != window.position.y) window.position.lastY = window.position.y; window.position.x = a.x; window.position.y = a.y; window.position.history.push({ x: a.x, y: a.y, last: { x: window.position.lastX, y: window.position.lastY } }); return a; }, pos = position(); position.originX = position.x = pos.x; position.originY = position.y = pos.y; position.history = [{ x: pos.x, y: pos.y, last: { x: pos.x, y: pos.y } }]; return position; }();
})();

/*  To Add To jQuery, simply insert the following after above code and after jQuery is added to page    */

if (jQuery) {
    (function($) {
        /** jQuery(window).position()
         *
         *  @description As is, jQuery's `.position` method errors out when applied to '$(window)'.
         *  The following extends the `.position` method to account for `window` if `window.position` exist.
         *
         *  @example $(window).position();
         *      Will output an Object like:
         *      { x: 2643, y: 0, top: 0, left: 2643, lastX: 1920, lastY: 0, originX: 1920, originY: 0 }
         */
        if (window.position && $.fn.position) {
            $.fn.originalPosition = $.fn.position;
            $.fn.position = function() {
                return this && "object" == typeof this && this[0] == window ? $.extend(!0, window.position(), {
                    top: window.position.y,
                    left: window.position.x,
                    lastX: window.position.lastX,
                    lastY: window.position.lastY,
                    originX: window.position.originX,
                    originY: window.position.originY
                }) : $.fn.originalPosition.apply(this, arguments)
            }
        }
    })(jQuery);
} 
```

# [jsFiddle](http://jsfiddle.net/SpYk3/x3nnu35b/show/)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-25T22:10:39.433

分配给`window`对象的属性与全局变量相同。所以你的代码：

```
if (!window.position) {
    window.position = function() {
        return navigator.appName.toLowerCase().indexOf("explorer") >= 0 ? { x: window.screenLeft, y: window.screenTop } : { x: window.screenX, y: window.screenY };
    };
}; 
```

是相同的：

```
if (typeof position == "undefined") {
    var position = function () {
        return navigator.appName.toLowerCase().indexOf("explorer") >= 0 ? { x: window.screenLeft, y: window.screenTop } : { x: window.screenX, y: window.screenY };
    };
}; 
```

在任何情况下，对全局变量或窗口属性的更改都不会持续到另一个页面、窗口或框架，因为它们每个都从头开始拥有自己的状态。

* * *

为了解决您的问题，您可以创建一个将所需窗口作为参数的函数：

```
function getWindowPosition(obj) {
    return navigator.appName.toLowerCase().indexOf("explorer") >= 0 ? { x: obj.screenLeft, y: obj.screenTop } : { x: obj.screenX, y: obj.screenY };
} 
```

在新窗口的上下文中，您可以像这样使用它：

```
var bob = window.open(...);
var pos = getWindowPosition(bob); 
```

这种跨窗口访问将受到[同源安全限制](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)，但只要它们是同源，这将起作用。

# android - 转移到手机时应用程序不播放音乐

> ID：10324505
> 
> 赞同：0
> 
> 时间：2012-04-25T22:06:52.720
> 
> 标签：android

我创建了一个应用程序，它在启动时在后台播放歌曲，当我在 Eclipse 中执行它时它工作正常，但是一旦我将应用程序转移到我的手机上，歌曲就不再播放了？

关于我应该做什么的任何建议/解决方案？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:10:26.063

Throwing out the simple things. Have you verified volume is all the way up and that the music file was also successfully transferred to the device? Is the music file located at the path where the program expects it to be? Can you connect the device and use the debug tool to step through the application while running on the device?

# c# - 将枚举的内容获取到下拉列表

> ID：10324507
> 
> 赞同：2
> 
> 时间：2012-04-25T22:06:55.920
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, c#-4.0, enums

我正在尝试将我的项目从枚举转换为下拉列表。请帮助

```
public enum Colors{ red,blue,green,yellow,orange,white,black,Teal,Custom }

 @Html.DropDownList("SelectedColourId", Model.ColourList, "(Select one Color)") 
```

我的 ViewModel 如下

```
 myPageViewModel:BasicViewModel
    {
 .....
     public IEnumerable<SelectListItem> ColourList{ get; set; }
.........
    } 
```

我尝试过类似的东西

```
myViewModel.ColourList = Enum.GetNames(typeof(Colors)).ToArray()
                .Select(e => new SelectListItem() { Text = e.item, Value = e.itemindex }); 
```

但我不知道如何获取 itemText 及其相应的 Index 。它的抛出错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:09:35.513

在控制器中，使用 Enum **GetNames**静态方法和 Linq初始化**ColourList数组：**

 **```
myPageViewModel.ColourList = Enum.GetNames(typeof(Colors))
    .Select(c => new SelectListItem() { Text = c, Value = c })
    .ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T13:42:31.057

要从枚举的下拉列表中添加选项，请使用以下代码：

```
 foreach (DropDownEnum enumValue in Enum.GetValues(typeof(DropDownEnum)))

        {

            model.SortOptions.Add(new SelectListItem()
            {
                Text = enumValue.ToString(),
                Value = url+enumValue.ToString(),
                Selected = false

            });

        } 
```**

# android - HttpURLConnection works on emulator but not on the device

> ID：10324509
> 
> 赞同：2
> 
> 时间：2012-04-25T22:07:10.757
> 
> 标签：android, httpurlconnection

I'm trying to experiment the HttpURLConnection to get some XML from a server. This is the code I'm using:

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    String myConn = this.getString(R.string.myConnection);
    HttpURLConnection httpConnection = null;
    InputStream in = null;
    try {
        URL mySite = new URL(myConn);
        URLConnection connection = mySite.openConnection();
        TextView tv = (TextView)this.findViewById(R.id.myTextView);
        httpConnection = (HttpURLConnection)connection;         

            in = httpConnection.getInputStream();

            String myString = convertStreamToString(in);
            tv.setText(myString);           

    } catch (IOException ex) {} catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    finally {
        httpConnection.disconnect();
        try {
            in.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

On the emulator this code works and i can see the stream on the TextView...

On my device I can't see anything (3g connection)..

Did I miss something?

thanks

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-05-26T10:06:09.887

通过使用 AsyncTask 可以解决这个问题。

# r - R数据框中的Excel类似列操作

> ID：10324515
> 
> 赞同：5
> 
> 时间：2012-04-25T22:08:08.273
> 
> 标签：r, dataframe

我正在尝试使用 R 复制我在 Excel 中所做的一些建模。我已将 csv 文件中的数据读入数据框。csv 文件包含两列数据**A**和**B**。

我现在想将额外的列**C**、**D**和**E**添加到数据框中，并使用通过将公式应用于先前列中的数据而生成的数据填充新列 C 、 D 和 E 。

下面的代码片段应该有望澄清我正在尝试做的事情：

```
 A       B        C                   D              E
1    100.5   101.3
2    102.6   102.5
3    107.2   109.3
4    99.3    89.3
5    102.8   100.7     =(B5-B1)*A5         = C5           = IF(D5 >100,1,-1)
6    107.2   98.9      =(B6-B2)*A6         = C6+C5        = IF(D6 >100,1,-1)
7    99.8    109.9     =(B7-B3)*A7         = C7+C6        = IF(D7 >100,1,-1)
8    108.2   99.5      =(B8-B4)*A8         = C8+C7        = IF(D8 >100,1,-1)
9    78.7    89.6      =(B9-B5)*A9         = C9+C8        = IF(D9 >100,1,-1)
10   108.9   109.2     =(B10-B6)*A10       = C10+C9       = IF(D10 >100,1,-1) 
```

如何使用 R 复制 Excel (ahem - Excels) 中的这种“列式”函数式编程？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T22:55:04.297

我的大脑在抗议下这样做。这让我觉得我又回到了 Minitab 会话中。

```
 dfrm$C <- NA
 dfrm$C[5:10] <- with(dfrm, (B[5:10]-B[1:6])*A[5:10])
 dfrm$D <- NA
 dfrm$D[5:10] <- cumsum(dfrm$C[5:10])
 dfrm$E <- NA
 dfrm$E[5:10] <- 1 - 2*(dfrm$D[5:10] <= 100) # could also use ifelse()

dfrm
       A     B       C       D  E
1  100.5 101.3      NA      NA NA
2  102.6 102.5      NA      NA NA
3  107.2 109.3      NA      NA NA
4   99.3  89.3      NA      NA NA
5  102.8 100.7  -61.68  -61.68 -1
6  107.2  98.9 -385.92 -447.60 -1
7   99.8 109.9   59.88 -387.72 -1
8  108.2  99.5 1103.64  715.92  1
9   78.7  89.6 -873.57 -157.65 -1
10 108.9 109.2 1121.67  964.02  1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-11T21:59:13.817

通过将 BondedDust 和 Justin 提供的答案结合到我的解决方案中，我在下面创建了正确的解决方案：

```
A <- c(100.5, 102.6, 107.2, 99.3, 102.8, 107.2, 99.8, 108.2, 78.7, 108.9)
B <- c(101.3, 102.5, 109.3, 89.3, 100.7, 98.9, 109.9, 99.5, 89.6, 109.2)
dfexcel <- data.frame(A, B, C = rep_len(NA, 10), D = rep_len(NA, 10), E = rep_len(NA, 10))
dfexcel$C[5:10] <- with(dfexcel, diff(B, lag=4)*A[5:10])
dfexcel$D[5:10] <- with(dfexcel, (C[5:10]+c(0,C[5:9]))) # cumsum doesn't work for D
dfexcel$E[5:10] <- ifelse(dfexcel$D[5:10] > 100, 1, -1) 
```

这是 LibreOffice Calc/Gnumeric/Microsoft Excel/等中的结果：

```
A   B   C   D   E
1   100.5   101.3           
2   102.6   102.5           
3   107.2   09.3            
4   99.3    89.3            
5   102.8   100.7   -61.68  -61.68  -1
6   107.2   98.9    -385.92 -447.6  -1
7   99.8    109.9   59.88   -326.04 -1
8   108.2   99.5    1103.64 1163.52 1
9   78.7    89.6    -873.57 230.07  1
10  108.9   109.2   1121.67 248.1   1 
```

# javascript - 在 jQuery 中，当窗口不在焦点上时，如何让我的计数器停止？

> ID：10324516
> 
> 赞同：0
> 
> 时间：2012-04-25T22:08:11.197
> 
> 标签：javascript, jquery, html

我有以下代码。倒计时有效，但是当窗口不在焦点时停止计时器不起作用。另外，我想在窗口处于焦点时恢复倒计时。

在我下面的代码中，该`$(document).blur()`事件不起作用，但是当我将 blur 替换为 时`click()`，它起作用了。`blur()`和文件有问题吗？

```
var tm;
$(document).ready(function(){    
   function countdown(){ 
         if (seconds > 0) {
            seconds--; 
            $('#timer_div').text(seconds);
            tm = setTimeout(countdown,1000);
            }
        if (seconds<=0){ 
            $('#timer').text('Go');
            }   
        } 

        var seconds = 50;
        $('#timer').html(seconds);
        countdown();

    });
    $(document).blur(function(){
        clearTimeout(tm);
        seconds++;
        $('#timer').text(seconds);

    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:10:34.300

```
var tm;
$(document).ready(function(){    
   function countdown(){ 
         if (seconds > 0) {
            seconds--; 
            $('#timer_div').text(seconds);
            tm = setTimeout(countdown,1000);
            }
        if (seconds<=0){ 
            $('#timer').text('Go');
            }   
        } 

        var seconds = 50;
        $('#timer').html(seconds);
        countdown();

    });
    $(document).blur(function(){
        clearTimeout(tm);
        seconds++;
        $('#timer').text(seconds);

    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:10:58.247

试试这个：

```
var counter;
$(document).ready(function(){

function countdown(){ 

     if (seconds > 0) {
        seconds--; 
        $('#timer_div').text(seconds);
        counter=setTimeout(countdown,1000);
        }
    if (seconds<=0){ 
        $('#timer').text('Go');
        }   
    } 

    var seconds = 50;
    $('#timer').html(seconds);
    countdown();

});

$(document).blur(function(){
    clearTimeout(counter);
    seconds++;
    $('#timer').text(seconds);

}); 
```

# soap - 查询 SOAP 和 HTTP 基础知识

> ID：10324517
> 
> 赞同：1
> 
> 时间：2012-04-25T22:08:17.883
> 
> 标签：soap, gsoap

客户端 SOAP 请求是否只是使用 HTTP POST 通过 TCP/IP 套接字连接向 Web 服务服务器发送格式正确的 HTTP 标头，然后是正确格式的 XML SOAP 内容，然后等待并解析响应？

这是“简单”还是幕后发生的事情更多？

我之所以问，是因为难以将 gSOAP 和 C++ 用于多个 WSDL 文件，并且正在考虑从头开始编写客户端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:40:20.960

SOAP 可用于任何传输协议，如 TCP、HTTP、SMTP 等，其中 HTTP 是最流行的。

HTTP 上的 SOAP 基本上转换为一个有效的 POST HTTP 请求，其中包含一个 SOAP 信封，如果我们要谈论来自浏览器的经典 POST，表单参数将在那里。响应正文还包含一个 SOAP 信封，在那里您希望 HTML 作为对来自浏览器的请求的响应。

您只需要为正在使用的 SOAP 版本（`text/xml`对于 SOAP 1.1 和`application/soap+xml`SOAP 1.2）使用正确的内容类型，并且如果需要（对于 SOAP 1.1）可能指定`SOAPAction`标头，但这就是关于 HTTP 通信的问题。

然后信封的接收者（无论是请求的服务器还是响应的客户端）必须使用 SOAP 消息，但这与 HTTP 无关，HTTP 只是在那里获取消息。

# java - Google App Engine User Registration System

> ID：10324520
> 
> 赞同：0
> 
> 时间：2012-04-25T22:08:31.383
> 
> 标签：java, google-app-engine, jsp, servlets, google-cloud-datastore

I am creating a user registration system in google app engine, and so far I could develop the registration side of the app. But I can't log in and create a HttpSession.

Here what I did, I created login.jsp and two text boxes to input email and password.

And then I created Bean class and DAO class as following. package com.myfirstguide.beans;

```
import javax.servlet.http.HttpSession;

import com.google.appengine.api.datastore.DatastoreService;
import com.google.appengine.api.datastore.DatastoreServiceFactory;
import com.google.appengine.api.datastore.Entity;
import com.google.appengine.api.datastore.PreparedQuery;
import com.google.appengine.api.datastore.Query;

public class UserDAO {

public static UserBean login(UserBean bean){

    String email = bean.getEmail();
    String password = bean.getPassword();

    try{
        DatastoreService datastore = DatastoreServiceFactory.getDatastoreService();
        Query q = new Query("Account");
        q.addFilter("email", Query.FilterOperator.EQUAL, email);
        q.addFilter("password", Query.FilterOperator.EQUAL, password);

        PreparedQuery pq = datastore.prepare(q);
        Entity result = pq.asSingleEntity();
        if(result != null){
            bean.setValid(true);

        }

        //return bean;
    }catch(Exception e){

    }
    return bean;
}

} 
```

Here is the Bean class.

```
package com.myfirstguide.beans;

public class UserBean {

private String username; 
private String password; 
private String firstName;
private String lastName; 
private String email;
public boolean valid; 

public String getFirstName() {
    return firstName; 
} 

public void setFirstName(String newFirstName) { 
    firstName = newFirstName; 
} 

public void setEmail(String semail){
    email = semail;
}

public String getEmail(){
    return email;
}

public String getLastName() {
    return lastName; 
} 

public void setLastName(String newLastName) { 
    lastName = newLastName; 
} 

public String getPassword() { 
    return password;
} 

public void setPassword(String newPassword) { 
    password = newPassword;
} 

public String getUsername() {
    return username; 
} 

public void setUserName(String newUsername) {
    username = newUsername; 
} 

public boolean isValid() {
    return valid;
} 

public void setValid(boolean newValid) {
    valid = newValid;
} 
 } 
```

And here is the Servlet.

```
package com.myfirstguide.users;

import java.io.IOException;

import javax.servlet.ServletException;
 import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import com.myfirstguide.beans.UserBean;
import com.myfirstguide.beans.UserDAO;

 public class SignIn extends HttpServlet{

@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp)
        throws ServletException, IOException {

    String email = req.getParameter("email");
    String password = req.getParameter("password");

    try{
        UserBean ubean = new UserBean();
        ubean.setEmail(email);
        ubean.setPassword(password);

        ubean = UserDAO.login(ubean);
        if(ubean.isValid()){
              HttpSession session = req.getSession(true);       
              session.setAttribute("currentSessionUser",ubean); 
              resp.sendRedirect("index.jsp?session=" + ubean.getFirstName()); //logged-in page      
        }
    }catch(Throwable e){
        System.out.println(e);
    }

}

 } 
```

And I don't know JPA. And if there is better way to do this, please tell me.

Thank you!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T19:40:17.567

您是否启用了会话？

[https://developers.google.com/appengine/docs/java/config/appconfig#Enabling_Sessions](https://developers.google.com/appengine/docs/java/config/appconfig#Enabling_Sessions)

# frama-c - Frama-C 中的模型变量

> ID：10324523
> 
> 赞同：1
> 
> 时间：2012-04-25T22:08:44.267
> 
> 标签：frama-c

模型变量在 Frama-C 手册中进行了描述（在规范和“实现”版本中）。

但是我无法解析一个简单的片段，例如手册中的片段，例如。

```
//@ model set<integer > forbidden = \empty; 
```

甚至

```
//@ model integer x = 0; 
```

导致解析错误。

真的支持模型变量吗？如果是这样，我做错了什么？我使用的 frama-c 版本是 MacOS 上的 Nitrogen。

谢谢，爱德华多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T08:00:38.607

正如 ACSL 手册“实施”版本的第 11 页所述，以红色字体编写的功能在 Frama-C 中尚不可用。事实上，在 Nitrogen 中，既没有实现模型变量，也没有实现模型字段。

# c# - RestSharp 不反序列化 JSON 对象列表，始终为 Null

> ID：10324526
> 
> 赞同：33
> 
> 时间：2012-04-25T22:08:55.670
> 
> 标签：c#, asp.net, .net, http, rest

我在使用 RestSharp 将返回内容反序列化到我的类中时遇到问题。从我所有的搜索来看，我似乎做得对。我宁愿使用 RestSharp 的反序列化器，也不愿回退到像 Newstonsoft 的 Json.NET 这样的另一个包。

我正在做的是向 GoToWebinar 发出 API 请求以获取所有已安排的网络研讨会列表：

```
var client = new RestClient(string.Format("https://api.citrixonline.com/G2W/rest/organizers/{0}/upcomingWebinars", "300000000000239000"));
var request = new RestRequest(Method.GET);
request.AddHeader("Authorization", "OAuth oauth_token=" + System.Configuration.ConfigurationManager.AppSettings["GoToWebinar"]);
var response2 = client.Execute<List<RootObject>>(request); 
```

如您所见，我想获取对象“RootObject”的列表（如下所示）。我在 response2.Content 中收到以下 JSON 响应：

```
[
   {
      "webinarKey":678470607,
      "subject":"Easton's Wild Rice Cooking Demo",
      "description":"Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
      "organizerKey":300000000000239551,
      "times":[{"startTime":"2012-05-09T15:00:00Z","endTime":"2012-05-09T16:00:00Z"}],
      "timeZone":"America/Denver"
   },
   {
      "webinarKey":690772063,
      "subject":"Easton's Match Making Service",
      "description":"Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
      "organizerKey":300000000000239551,
      "times":[{"startTime":"2012-05-09T15:00:00Z","endTime":"2012-05-09T16:00:00Z"}],
      "timeZone":"America/Denver"
   }
] 
```

我使用上面的 JSON 结果使用[http://json2csharp.com](http://json2csharp.com)创建了以下对象：

```
public class RootObject
{
    public int webinarKey { get; set; }
    public string subject { get; set; }
    public string description { get; set; }
    public long organizerKey { get; set; }
    public List<Time> times { get; set; }
    public string timeZone { get; set; }
}

public class Time
{
    public string startTime { get; set; }
    public string endTime { get; set; }
} 
```

问题是 response2.Data 始终为 Null。由于某种原因，反序列化失败了，我不知道为什么。我的目标是能够使用 foreach 循环遍历结果：

```
foreach(RootObject r in response2.Data)
{
    lblGoToWebinar.Text += r.webinarKey.ToString() + ", ";
} 
```

关于反序列化为什么失败的任何想法？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-04-27T16:27:31.487

根据上面@agarcian 的建议，我用谷歌搜索了错误：

> restsharp 根级别的数据无效。第 1 行，位置 1。

并找到了这个论坛：[http ://groups.google.com/group/restsharp/browse_thread/thread/ff28ddd9cd3dde4b](http://groups.google.com/group/restsharp/browse_thread/thread/ff28ddd9cd3dde4b)

基本上，我错误地认为 client.Execute 将能够自动检测返回的内容类型。它需要明确设置：

```
var request = new RestRequest(Method.GET);
request.OnBeforeDeserialization = resp => { resp.ContentType = "application/json"; }; 
```

这可以在 RestSharp 的文档中更清楚地引用。希望这会帮助别人！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-01-06T05:30:21.277

迟到：您需要找到您收到的响应的**实际**内容类型。服务器不一定会使用您请求的 Accept 标头中的任何内容类型进行响应。对于谷歌的 API，我得到了一个文本/简单的响应，所以这个[小组的建议](https://groups.google.com/d/msg/restsharp/_yjd2c093ks/4rosyOMj6bYJ)对我有用。

```
public T Execute<T>(string url, RestRequest request) where T : new()
{
    var client = new RestClient();
    // tell RestSharp to decode JSON for APIs that return "Content-Type: text/plain"
    client.AddHandler("text/plain", new JsonDeserializer());
    ... 
```

如果它可以在一个地方完成，例如上面的共享 Execute 方法，而不是在每个请求创建的地方强制使用 OnBeforeDeserialization 响应类型，它也会更整洁。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-11-10T17:26:14.103

我遇到了同样的问题，上面的答案都没有帮助。

这是我的响应类：

```
public class SomeResponse
{
    public string string1;
    public string string2;
} 
```

问题是人为错误 - 我忘记包含 get/set 访问器。我不经常使用 C# 并且忘记了对它们的需要。

```
public class SomeResponse
{
    public string string1 { get; set; }
    public string string2 { get; set; }
} 
```

希望这可以帮助那里的人。

# html - 内联元素中的顶部边距

> ID：10324527
> 
> 赞同：17
> 
> 时间：2012-04-25T22:08:57.140
> 
> 标签：html, css, inline, margin

我的问题很简单：

为什么 Firefox 中的内联元素忽略边距顶部？

有人知道吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-25T22:16:47.903

这不是 Firefox 独有的，并且在[CSS 2.1 规范](http://www.w3.org/TR/CSS21/box.html#margin-properties)中定义：

> ### 8.3 边距属性：'margin-top'、'margin-right'、'margin-bottom'、'margin-left'和'margin'
> 
> 边距属性指定框的[边距区域](http://www.w3.org/TR/CSS21/box.html#box-margin-area)的宽度。'margin' 速记属性设置所有四个边的边距，而其他边距属性只设置它们各自的边。这些属性适用于所有元素，**但垂直边距不会对未替换的内联元素产生任何影响。**

^(（最后的重点是我的；`margin-top`是垂直边距）)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-07-15T06:46:37.087

内联元素只能应用边距 letf 和 right 但如果您使用的是 firefox，它也会在检查元素后出现边距底部和顶部，但它并不适用

# java - Creating new SoapObject Blows up android app

> ID：10324529
> 
> 赞同：2
> 
> 时间：2012-04-25T22:09:02.507
> 
> 标签：java, android, ksoap2

I'm new to ksoap2 and I'm trying to get example w3 schools example working. For some reason it always fails on this line.

```
SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME); 
```

I dont know what is causing the fail. The android app just blows up. I have set internet permisions in Manifest. Im not really sure what is going on. Thanks

```
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapPrimitive;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.EditText;
import android.widget.Toast;
public class WebServiceTurorialActivity extends Activity implements OnClickListener{

private static final String SOAP_ACTION = "http://tempuri.org/CelsiusToFahrenheit";
private static final String METHOD_NAME = "CelsiusToFahrenheit";
private static final String NAMESPACE = "http://tempuri.org/";
private static final String URL = "http://www.w3schools.com/webservices/tempconvert.asmx";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    (findViewById(R.id.button1)).setOnClickListener(this);
}

public void onClick(View v) {
    int a;
    int b;
    try
    { 
        // EditText ed1=(EditText)findViewById(R.id.editText1);
        // EditText ed2=(EditText)findViewById(R.id.editText2); 
        // a = Integer.parseInt(ed1.getText().toString());
        // b = Integer.parseInt(ed2.getText().toString()); 

         SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME);
         //Request.addProperty("a", a);
        // Request.addProperty("b", b);
         Request.addProperty("Celsius", "32");

         SoapSerializationEnvelope soapEnvelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
         soapEnvelope.dotNet = true;
         soapEnvelope.setOutputSoapObject(Request);

         HttpTransportSE transport= new HttpTransportSE(URL);

         transport.call(SOAP_ACTION, soapEnvelope);
         SoapPrimitive resultString = (SoapPrimitive)soapEnvelope.getResponse();

         Toast.makeText(this,"200 " + resultString,Toast.LENGTH_SHORT).show();

     }catch(Exception ex) {
         Toast.makeText(this,"FALSE",Toast.LENGTH_SHORT).show();
     }
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T20:49:49.643

我有同样的问题。这对我行得通：

正如上一个答案所说：

*   在您的构建路径中清除所有库（jar 文件）。
*   在项目的主目录中创建一个文件夹并将其命名为“libs”（不是“lib”）。
*   现在 Eclipse ADT 插件会将您的 jar 文件添加到构建路径

对我来说不是真的。我的方式：

1.  在您的构建路径中删除“ksoap2-android-assembly-2.xx-jar-with-dependencies.jar”
2.  单击确定（显示的忽略错误）
3.  在项目的主目录中创建一个文件夹“libs”
4.  将 JAR 文件复制到此目录 (!)
5.  在您的构建路径中添加具有此目录的 JAR 文件

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T22:17:10.787

对于每个也有这个问题的人......我试图解决这个问题很多小时，但后来我发现我的错误是：我没有正确下载 ksoap2 库，所以只有一个 21 KB 的 jar 文件，但正确的jar文件大约是150KB。因此，请确保正确下载文件！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T07:50:39.330

*   在您的构建路径中清除所有库（jar 文件）。
*   在项目的主目录中创建一个文件夹并将其命名为“libs”（不是“lib”）。
*   现在 Eclipse ADT 插件会将您的 jar 文件添加到构建路径。
*   快乐编码

如果您仍然遇到同样的问题，请尝试这些课程（对我有用）：

```
public class Main extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        String fahrenheit = CelsiusToFahrenheitWs.celsiusToFahrenheit("32");
        Toast.makeText(getApplicationContext(), fahrenheit, Toast.LENGTH_SHORT).show();
    }
} 
```

和

```
public class CelsiusToFahrenheitWs {
    private static final String METHOD_NAME = "CelsiusToFahrenheit";
    private static final String NAMESPACE = "http://tempuri.org/";
    private static final String SOAP_ACTION = "http://tempuri.org/CelsiusToFahrenheit";
    private static final String URL = "http://www.w3schools.com/webservices/tempconvert.asmx";

    public static String celsiusToFahrenheit(String celsius) {
        String fahrenheit = null;

        SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
        request.addProperty("Celsius", celsius);

        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.dotNet = true;
        envelope.setOutputSoapObject(request);

        HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
        androidHttpTransport.debug = true;

        try {
            androidHttpTransport.call(SOAP_ACTION, envelope);
            SoapPrimitive response = (SoapPrimitive) envelope.getResponse();
            fahrenheit = response.toString();
        } catch (Exception e) {
            e.printStackTrace();
            fahrenheit = null;
        }
        return fahrenheit;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T15:24:07.770

我创建了另一个 SOAP 库来调用 Android 上的 SOAP 服务，该项目的名称是 AndroidSOAP ( [http://wiki.javaforum.hu/display/ANDROIDSOAP/Home](http://wiki.javaforum.hu/display/ANDROIDSOAP/Home) )。

我今天发布了 0.0.5 版本，请查看：[http ://wiki.javaforum.hu/display/ANDROIDSOAP/2012/05/01/Version+0.0.5+released](http://wiki.javaforum.hu/display/ANDROIDSOAP/2012/05/01/Version+0.0.5+released)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-30T17:19:23.883

W3Schools.com 不再接受 NAMESPACE 作为 tempuri.org 导致代码中的 SOAP 异常。您需要对 NAMESPACE使用“ [http://www.w3schools.com/webservices/](http://www.w3schools.com/webservices/) ”，对 SOAP_ACTION使用“ [http://www.w3schools.com/webservices/CelsiusToFahrenheit ”。](http://www.w3schools.com/webservices/CelsiusToFahrenheit)

希望这是帮助！

# javascript - 骨干模型效率低下？

> ID：10324534
> 
> 赞同：2
> 
> 时间：2012-04-25T22:09:39.487
> 
> 标签：javascript, json, performance, backbone.js

我正在使用主干创建一个 gps 数据可视化器。我将每个 gps 数据存储在主干模型中，并将所有数据存储在一个集合中。与数组和 json 对象相比，使用它会涉及什么样的开销？

我在 5 分钟到 10 小时内检索 1 到 20 多个跟踪对象的 GPS。每一秒都会有一个点。平均每节课 25,000 分。

目前我最多使用 1gb 的 ram，并且会变得非常缓慢。数据无法再压缩。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:17:43.600

我的经验是，在这种情况下，猜想的价值远低于指标。您最好分析不同的方法并查看在您的特定情况下增加了多少开销。

请参阅[http://jtaby.com/2012/04/23/modern-web-development-part-1.html](http://jtaby.com/2012/04/23/modern-web-development-part-1.html)作为起点，但您也可以使用操作系统分析器来告诉您浏览器的总体内存和 CPU 使用情况本身。

# objective-c - handling push notifications to different views

> ID：10324535
> 
> 赞同：5
> 
> 时间：2012-04-25T22:09:42.087
> 
> 标签：objective-c, ios, xcode, apple-push-notifications

I receive my push notification successfully but when I tap on it, it simply takes me to first view when my app loads.

I want the user to go to specific views depending on the push notification because the user will be receiving many different push notifications (1 for each soccer team, hence possiblity of many different views).

So example: I have a view controller called manchesterUnitedView and somebody just scored so the user receives a push notification for that particular view. When they press it, I want it to take them to the manchesterUnitedView.

Does anyone know how to do this?

thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T10:26:41.317

您可以使用通知的有效负载将您需要的信息传递给应用程序，然后在由于用户点击通知而启动应用程序时检索并使用它。

为此，只需将自定义字典添加到通知的 JSON 有效负载，然后添加您需要传递给应用程序的信息。

有关有效负载格式的详细信息，请参见[此处](https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html#//apple_ref/doc/uid/TP40008194-CH100-SW1)。

`application:didFinishLaunchingWithOptions:`然后，您可以在您的方法实现中启动应用程序时检索您的自定义字典，`UIApplicationDelegate`并使用它来初始化您的应用程序状态。

有关如何在 UIApplicationDelegate 中检索有效负载的文档，请参阅[此处。](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T10:06:51.387

我也对这个感兴趣。

以下应该可以工作：我在我的 iPhone 上收到推送，单击“查看”按钮后，应用程序应该打开，然后我可以阅读完整的消息。

就像在这个网站上（底部）：[http ://www.myfitapp.de/fitnessstudio-app/push-nachrichten/](http://www.myfitapp.de/fitnessstudio-app/push-nachrichten/)

# c++ - 运算符>>重载

> ID：10324537
> 
> 赞同：3
> 
> 时间：2012-04-25T22:09:51.397
> 
> 标签：c++, operator-overloading

我正在使用运算符重载实现一个复数。在程序中，用户总是以以下形式输入一个复数：

```
a + bi 
```

所以，例如...

```
25.0 + 3.6i 
```

假设用户将始终输入复数的实部和虚部，例如，用户将输入“5 + 0i”（而不是“5”）或“0 - 6.2i”（而不是“-6.2”一世”）。

我的问题是在 main() 我有以下代码：

```
ComplexNumber c1;
cin >> c1;
cout << c1; 
```

代码打印：

```
0 + 0i 
```

...当我在运行时在提示中输入“4.2 + 8.3i”时。

这是我的`operator>>`课程的实现：

```
istream & operator>>(istream & in, ComplexNumber & n) {
    string real;
    string imag;
    bool done = false;
    int sign = 1;

    string num;
    in >> num;

    int length;
    for (int i = 0; i < num.length(); i++) {
        if (num.at(i) == 'i') {
            imag = num.substr((i - length), i);
        }
        else if (num.at(i) == '-') {
            sign = -1;
        }
        else if (num.at(i) == ' ') {
            if (!done) {
                real = num.substr(i);
                done = true;
            }
            length = 0;
        }
        length++;
    }

    n = ComplexNumber(atof(real.c_str()), atof(imag.c_str()) * sign);
    return in;
} 
```

这是我的`operator<<`类的实现：

```
ostream & operator<<(ostream & out, const ComplexNumber & n) {
    n.print(out);
    return out;
} 
```

这是我对 ComplexNumber 成员类 print() 的实现：

```
void ComplexNumber::print(ostream & out) const {
    if (imag >= 0)
        out << real << " + " << imag << "i";
    else 
        out << real << " - " << (-1 * imag) << "i";
} 
```

这是我的 ComplexNumber 头文件以获取更多详细信息：

```
#ifndef COMPLEXNUMBER_H
#define COMPLEXNUMBER_H

#include <iostream>
using namespace std;

class ComplexNumber {

  public:

    // constructors
    ComplexNumber();
    ComplexNumber(double real_part, double imaginary_part);
    ComplexNumber(const ComplexNumber & rhs);

    // named member functions
    void print(ostream & out = cout) const;
    bool equals(const ComplexNumber & rhs) const;

    // assignment operators
    const ComplexNumber & operator=(const ComplexNumber & rhs);
    const ComplexNumber & operator+=(const ComplexNumber & rhs);
    const ComplexNumber & operator-=(const ComplexNumber & rhs);
    const ComplexNumber & operator*=(const ComplexNumber & rhs);

  private:
    double real;      
    double imag; 
};

// arithmetic operators
ComplexNumber operator+(const ComplexNumber & lhs, const ComplexNumber & rhs);
ComplexNumber operator-(const ComplexNumber & lhs, const ComplexNumber & rhs);
ComplexNumber operator*(const ComplexNumber & lhs, const ComplexNumber & rhs);

// relational operators
bool operator==(const ComplexNumber & lhs, const ComplexNumber & rhs);
bool operator!=(const ComplexNumber & lhs, const ComplexNumber & rhs);

// I/O operators
ostream & operator<<(ostream & out, const ComplexNumber & n);
istream & operator>>(istream & in, ComplexNumber & n);

#endif 
```

对我的实现有任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T22:28:56.187

本质上你`operator >>`的方法太复杂了，甚至不能正确处理错误。您不应该将值读入字符串开头 - 直接将其读入数字。此外，在每次读取操作之后，您需要检查（并可能*设置*）流的状态。

```
istream& operator >>(istream& in, ComplexNumber& value) {
    int re;
    if (not (in >> re)) {
        return in;

    char pm;
    if (not (in >> pm) or (pm != '+' and pm != '-') {
        in.setstate(ios::failbit);
        return in;
    }

    int im;
    if (not (in >> im))
        return in;

    char i;
    if (not (in >> i) or i != 'i') {
        in.setstate(ios::failbit);
        return in;
    }

    value = ComplexNumber {re, (pm == '-' ? -im : im)};
    return in;
} 
```

（我使用 C++11 初始化程序，因为我很懒……）

而且，是的，通过将整个阅读内容拉入单个链式表达式，可以将其写得更短：

```
istream& operator >>(istream& in, ComplexNumber& value) {
    int re;
    int im;
    char pm;
    char i;

    if (not (in >> re >> pm) or
        (pm != '+' and pm != '-') or
        not (in >> im >> i) or
        i != 'i')
    {
        in.setstate(ios::failbit);
        return in;
    }

    value = ComplexNumber {re, (pm == '-' ? -im : im)};
    return in;
} 
```

这是否更好取决于观众。就个人而言，我确实发现它比第一个版本更具可读性（！）。一个更结构化的替代方案（对于这样一个简单的情况来说，这将是多余的）是[Boost.Qi](http://www.boost.org/doc/libs/1_38_0/libs/spirit/doc/html/spirit/qi_and_karma.html)，它允许非常优雅的解析器构造。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:19:17.043

这部分：

```
string num;
in >> num; 
```

它只从输入中读取一个单词。您需要多次调用它才能阅读类似的`4.2 + 8.3i`内容，其中包含三个单词。

# asp.net-mvc - ASP MVC 标准视图

> ID：10324540
> 
> 赞同：2
> 
> 时间：2012-04-25T22:10:12.470
> 
> 标签：asp.net-mvc, t4, asp.net-mvc-templates

ASP MVC 脚手架创建 Index、Create、Update、Delete 视图，但这在现实中是多么实用。创建、更新和删除视图似乎有很多重复的 UI 代码。让一个视图用于列表，另一个视图用于添加/编辑，并使用一些开关来适当地格式化视图以进行添加或编辑，并允许删除列表和编辑视图而不重定向到另一个视图，而不是简单地弹出，这不是更实用吗？出现某种“请确认删除...”消息？

如果有人做过这样的事情并愿意分享一些代码片段或通用案例的 T4 脚手架模板，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:17:31.453

实际上，NuGet 包 MvcScaffolding 正是这样做的，它使用**CreateOrEdit**局部视图。（[参见此处。](http://blog.stevensanderson.com/2011/01/13/scaffold-your-aspnet-mvc-3-project-with-the-mvcscaffolding-package/)）然后通过引用部分视图（分别针对不同的控制器操作）创建添加/编辑视图：

```
<fieldset>
    @Html.Partial("_CreateOrEdit", Model)
    <input type="submit" value="Create" />
</fieldset> 
```

另一种选择是使用默认的 MVC 脚手架（在模型中使用数据注释属性定义）。

```
<fieldset>
    @Html.EditorForModel()
    <input type="submit" value="Create" />
</fieldset> 
```

至于删除，您始终可以在任何视图的底部（或列表中）添加第二个迷你表单：

```
@{ using (Html.BeginForm("Delete", "MyController", FormMethod.Post))
    {
        @Html.HiddenFor(model => model.id)
        <input type='submit' value='Delete' />
    }
} 
```

# ios - 在 MVC 中连接数据

> ID：10324544
> 
> 赞同：0
> 
> 时间：2012-04-25T22:10:28.463
> 
> 标签：ios, model-view-controller

我有一个导航控制器和 2 个视图控制器。第一个 View Controller 与一个名为 ViewController 的 UIViewController 相关联。第二个连接到一个名为 BookVC 的 UIViewController。BookVC 有一个 UITextField 并通过一个插座连接：

```
@property (strong, nonatomic) IBOutlet UITextField *textFieldContent; 
```

连接是通过使用 segue 的按钮进行的​​。我想在两者之间传递一些数据，并使用以下代码失败：

```
-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
BookVC* nextPage = [[BookVC alloc] init];
nextPage = [segue destinationViewController];
nextPage.textFieldContent.text=@"Some content";
} 
```

我应该如何在视图控制器之间传递数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T00:18:44.540

你不需要这一行：

```
BookVC* nextPage = [[BookVC alloc] init]; 
```

这将创建一个全新的 BookVC，然后您可以在下一行中覆盖它。

由于您使用的是 [segue destinationViewController]，因此您应该一切顺利。当您转到 nextPage 时发生了什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T02:15:42.730

我认为问题在于那个`textFieldContent`时候不存在。您需要添加一个属性，`BookVC`该属性可以保存您要放入的文本`textFieldContent`……我们称之为`@property NSString *textFieldContentText`。那么，

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    BookVC *nextPage = [segue destinationViewController];
    [nextPage setTextFieldContentText:@"Some content"];
    ...
} 
```

然后，在`-viewDidLoad`方法中`BookVC`：

```
- (void)viewDidLoad
{
    [textFieldContent setText:[self textFieldContentText]];
} 
```

# ios - 如何访问以编程方式创建的按钮？

> ID：10324547
> 
> 赞同：0
> 
> 时间：2012-04-25T22:10:38.107
> 
> 标签：ios, ios5, uinavigationbar, uibarbuttonitem, uinavigationitem

我正在向导航栏添加多个按钮，就像这样。

```
UIToolbar* tools = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 133, 44.01)];

NSMutableArray* buttons = [[NSMutableArray alloc] initWithCapacity:2];
UIBarButtonItem *bi = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAction target:self action:@selector(assignSelected)];
bi.style = UIBarButtonItemStyleBordered;

[bi setEnabled:FALSE];

[buttons addObject:bi];
[buttons addObject:self.editButtonItem];

[tools setItems:buttons animated:NO];

self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:tools];

self.editButtonItem.title = @"Select"; 
```

基本上我这样做是为了让他们可以使用编辑按钮来选择一组项目并对它们采取行动。我想启用我在编辑时添加的操作按钮。我有以下方法来控制编辑时按钮所说的内容。

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated
{
    [super setEditing:editing animated:animated];

    if (editing)
    {
        self.editButtonItem.title = NSLocalizedString(@"Cancel", @"Cancel");
    }
    else
    {
        self.editButtonItem.title = NSLocalizedString(@"Select", @"Select");
    }
} 
```

那就是我要启用和禁用操作按钮的地方。我不确定如何访问该按钮，因为它是以编程方式创建的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:13:59.650

您应该能够通过您创建它的“bi”变量来访问它。bi 变量应该保存指向按钮的指针。因此，您可以像这样调用该按钮上的方法：

`[bi methodName:methodArg];`

# google-fusion-tables - fusion tables map isn't showing

> ID：10324555
> 
> 赞同：0
> 
> 时间：2012-04-25T22:11:33.893
> 
> 标签：google-fusion-tables

I saved this code as an html file, but I'm not being able to visualize the map. I took the code directly from FusionTablesLayer Wizard 2.0\. Is it something wrong with the code? I thought that it would be 'ready to use'. I need some help!

```
<!DOCTYPE html>
<html>
  <head>
  <style>
    #map-canvas { width:500px; height:400px; }
  </style>
  <script type="text/javascript"
    src="http://maps.google.com/maps/api/js?sensor=false">
  </script>
  <script type="text/javascript">
    var map;
    var layerl0;
    function initialize() {
      map = new google.maps.Map(document.getElementById('map-canvas'), {
        center: new google.maps.LatLng(0, 0),
        zoom: 1,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      });
      layerl0 = new google.maps.FusionTablesLayer({
        query: {
          select: "'geometry'",
      from: 1x46BzbRzLVz2S4_ml5Nx4oto2930DFrH39TM3uc
    },
    map: map
  });
}
function changeMapl0() {
  var searchString = document.getElementById('search-string-l0').value.replace(/'/g, "\\'");
  layerl0.setOptions({
    query: {
      select: "'geometry'",
      from: 1x46BzbRzLVz2S4_ml5Nx4oto2930DFrH39TM3uc,
      where: "'NOME' = '" + searchString + "'"
    }
  });
}
google.maps.event.addDomListener(window, 'load', initialize);
  </script>
  </head>
  <body>
    <div id="map-canvas"></div>
    <div style="margin-top: 10px;">
      <label>Escolha a cidade</label>
      <select id="search-string-l0" onchange="changeMapl0(this.value);">
        <option value="">--Select--</option>
    <option value="ALVORADA">ALVORADA</option>
    <option value="ARARICA">ARARICA</option>
    <option value="ARROIO DOS RATOS">ARROIO DOS RATOS</option>
    <option value="CACHOEIRINHA">CACHOEIRINHA</option>
    <option value="CAMPO BOM">CAMPO BOM</option>
    <option value="CANOAS">CANOAS</option>
    <option value="CAPELA DE SANTANA">CAPELA DE SANTANA</option>
    <option value="CHARQUEADAS">CHARQUEADAS</option>
    <option value="DOIS IRMAOS">DOIS IRMAOS</option>
    <option value="ELDORADO DO SUL">ELDORADO DO SUL</option>
    <option value="ESTANCIA VELHA">ESTANCIA VELHA</option>
    <option value="ESTEIO">ESTEIO</option>
    <option value="GLORINHA">GLORINHA</option>
    <option value="GRAVATAI">GRAVATAI</option>
    <option value="GUAIBA">GUAIBA</option>
    <option value="IVOTI">IVOTI</option>
    <option value="MONTENEGRO">MONTENEGRO</option>
    <option value="NOVA HARTZ">NOVA HARTZ</option>
    <option value="NOVA SANTA RITA">NOVA SANTA RITA</option>
    <option value="NOVO HAMBURGO">NOVO HAMBURGO</option>
    <option value="PAROBE">PAROBE</option>
    <option value="PORTAO">PORTAO</option>
    <option value="PORTO ALEGRE">PORTO ALEGRE</option>
    <option value="ROLANTE">ROLANTE</option>
    <option value="SANTO ANTONIO DA PATRULHA">SANTO ANTONIO DA PATRULHA</option>
    <option value="SAO JERONIMO">SAO JERONIMO</option>
    <option value="SAO LEOPOLDO">SAO LEOPOLDO</option>
    <option value="SAPIRANGA">SAPIRANGA</option>
    <option value="SAPUCAIA DO SUL">SAPUCAIA DO SUL</option>
    <option value="TAQUARA">TAQUARA</option>
    <option value="TRIUNFO">TRIUNFO</option>
    <option value="VIAMAO">VIAMAO</option>
  </select>
</div>
  </body>
  </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:05:29.307

唯一缺少的是编码表ID周围的引号:-)

```
function initialize() {
      map = new google.maps.Map(document.getElementById('map-canvas'), {
        center: new google.maps.LatLng(0, 0),
        zoom: 1,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      });
      layerl0 = new google.maps.FusionTablesLayer({
        query: {
          select: "'geometry'",
      from: "1x46BzbRzLVz2S4_ml5Nx4oto2930DFrH39TM3uc"
    },
    map: map
  });
}

function changeMapl0() {
  var searchString = document.getElementById('search-string-l0').value.replace(/'/g, "\\'");
  layerl0.setOptions({
    query: {
      select: "'geometry'",
      from: "1x46BzbRzLVz2S4_ml5Nx4oto2930DFrH39TM3uc",
      where: "'NOME' = '" + searchString + "'"
    }
  });
} 
```

我将您的代码放在[jsFiddle 上并进行更正](http://jsfiddle.net/odi86/vDGNy/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:09:51.287

我的理解是，加密的 doc id 仅适用于 Fusion Table API，但不适用于 Fusion Table 图层的 GMaps API。通过 FT UI 访问您的表，然后选择 File -> About，这将显示 Encrypted Id 和 Numeric ID。尝试使用数字 ID 而不是加密的 ID：

```
layerl0 = new google.maps.FusionTablesLayer({
        query: {
          select: "'geometry'",
      from: 1x46BzbRzLVz2S4_ml5Nx4oto2930DFrH39TM3uc  // change this to numeric id
    }, 
```

# android - How to know how many elements user has viewd/scrolled in my listView

> ID：10324556
> 
> 赞同：0
> 
> 时间：2012-04-25T22:11:34.550
> 
> 标签：android

I have a requirement that I need to display a custom ListView with 'N' elements(Size of ListView may vary). I need to display how many elements user has viewed/ scrolled from my Listview...

My requirement is to I nned to display user that how many List items user not viewed yet..

Please let me know how get the count of elemnts...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:03:15.790

```
// class members
private TextView textView;
private in maxViewed = 0;

// in your onCreate method   
// find pointer to where you are displaying to user how many items he's viewed
textView = (TextView)findViewById(R.id.textView); // make sure to make this item in your layout

// make the scroll listener for the listview
listView.setOnScrollListener(new OnScrollListener(){

    public void onScroll(AbsListView view, int firstVisibleItem,
            int visibleItemCount, int totalItemCount) { 
    }

    public void onScrollStateChanged(AbsListView view, int scrollState) {   
        // keep track of how many items we've viewed         
        maxViewed = Math.max(maxViewed, listView.getLastVisiblePosition());
        textView.setText(String.valueOf(maxViewed));
    }

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:15:59.413

您可以使用`listView.getLastVisiblePosition()`，它会告诉您在您的最底部可见项目的位置`ListView`。

# exception - Get line of exception in my own exception class

> ID：10324558
> 
> 赞同：0
> 
> 时间：2012-04-25T22:11:49.400
> 
> 标签：exception, error-handling, python-3.2

Is there any way, how to find out line of code, where I called: raise MyError("something")??

I have code like this:

```
class MyError(Exception):
    def __init__(self, value):
        self.value = value

    def __str__(self):
        return repr(self.value) 
```

Can I get the line of exception in this class?

Calling like this:

```
try:
    somethin()
except:
    raise MyError("abc") 
```

Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:19:59.360

您应该能够为此使用[回溯](http://docs.python.org/py3k/library/traceback.html?highlight=traceback#traceback)。

# java - Java - .class not found issue

> ID：10324564
> 
> 赞同：4
> 
> 时间：2012-04-25T22:12:28.387
> 
> 标签：java

I have following code,

```
class AA {

    public static void main(String[] args) {

        long ll = 100 ;

        AA1 a1 = new AA1() ;

        if(ll == 100) // Marked line
            long lls [] = a1.val(ll);

    }
}

class AA1 {

    public long [] val (long ll1) {
        long [] val = new long []{1 , 2, 3};
        return val ;
    }

} 
```

which executes properly without the marked line. However, gives error ".class expected" with marked line. Can anybody help me what is the problem and how to solve this ?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T22:16:28.107

Basically this is a simplified version of your problem:

```
if (condition)
    int x = 10; 
```

You can't do that in Java. You can't use a *variable declaration* as the single statement in an `if` body... presumably because the variable itself would be pointless; the only purpose would be for the side effect of the expression used for the assignment.

If you *really* want the pointless declaration, use braces:

```
if (condition) {
    int x = 10;
} 
```

It's still useless, but at least it will compile...

EDIT: Responding to the comment, if you need to use the variable *outside* the `if` block, you need to declare it *before* the `if` block, and also make sure it's initialized before you read the value. For example:

```
// Note preferred style of declaration, not "long lls []"
long[] lls = null; // Or some other "default" value
if (ll == 100) {
    // I always put the braces in even when they're not necessary.
    lls = a1.val(ll);
}
// Now you can use lls 
```

Or:

```
long[] lls;
if (ll == 100) {
    lls = a1.val(ll);
} else {
    // Take whatever action you need to here, so long as you initialize
    // lls
    lls = ...;
}
// Now you can use lls 
```

Or possibly use a conditional expression:

```
long[] lls = ll == 100 ? a1.val(ll) : null; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:25:25.060

As Jon Skeet points out, this (1):

```
if(ll == 100)
    long lls [] = a1.val(ll); 
```

won't compile because it's using a declaration as a single statement.

This (2):

```
if(ll == 100){
    long lls [] = a1.val(ll);
} 
```

will compile because the compiler doesn't really care what's inside the `{}` -- it's a block, as far as the `if` is concerned. It's also pointless because it's equivalent to (3):

```
if(ll == 100)
    a1.val(ll); 
```

However, when I see (1), it usually looks like what was actually meant is:

```
long lls [];
if(ll == 100)
    lls = a1.val(ll); 
```

# javascript - 如何获取json格式的KendoGrid显示数据？

> ID：10324565
> 
> 赞同：31
> 
> 时间：2012-04-25T22:12:28.817
> 
> 标签：javascript, jquery, json, kendo-ui, kendo-grid

我有一个`kendoGrid`，我想`JSON`在过滤和排序后摆脱它，我该如何实现？

类似于以下内容，

```
var grid = $("#grid").data("kendoGrid");

alert(grid.dataSource.data.json); // I could dig through grid.dataSource.data and I see a function ( .json doen't exist I put it there so you know what i want to achieve ) 
```

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-04-28T06:44:03.830

我想你正在寻找

```
var displayedData = $("#YourGrid").data().kendoGrid.dataSource.view() 
```

然后将其字符串化如下：

```
var displayedDataAsJSON = JSON.stringify(displayedData); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-08-21T16:32:12.913

如果要获取过滤数据的所有页面，可以使用：

```
var dataSource = $("#grid").data("kendoGrid").dataSource;
var filters = dataSource.filter();
var allData = dataSource.data();
var query = new kendo.data.Query(allData);
var data = query.filter(filters).data; 
```

确保在尝试应用过滤器之前检查是否存在过滤器，否则 Kendo 会抱怨。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-11-09T22:59:54.673

获取网格中所有行的计数

```
$('#YourGridName').data("kendoGrid").dataSource.total() 
```

获取特定的行项目

```
$('#YourGridName').data("kendoGrid").dataSource.data()[1] 
```

获取网格中的所有行

```
$('#YourGridName').data("kendoGrid").dataSource.data() 
```

Json到网格中的所有行

```
JSON.stringify($('#YourGridName').data("kendoGrid").dataSource.data()) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-30T14:01:18.903

像这样，仅显示当前正在查看的数据。还扩展了网格以在整个应用程序中提供这些功能。

```
 /**
 * Extends kendo grid to return current displayed data
 * on a 2-dimensional array
 */
var KendoGrid = window.kendo.ui.Grid;
KendoGrid.fn.getDisplayedData = function(){
    var items = this.items();
    var displayedData = new Array();
    $.each(items,function(key, value) {
        var dataItem = new Array();
        $(value).find('td').each (function() {
            var td = $(this);
            if(!td.is(':visible')){
                //element isn't visible, don't show
                return;//continues to next element, that is next td
            }
            if(td.children().length == 0){
                //if no children get text
                dataItem.push(td.text());
            } else{
                //if children, find leaf child, where its text is the td content
                var leafElement = innerMost($(this));
                dataItem.push(leafElement.text());
            }
        }); 
        displayedData.push(dataItem);
    });
    return displayedData;
};

KendoGrid.fn.getDisplayedColumns = function(){
    var grid = this.element;
    var displayedColumns = new Array();
    $(grid).find('th').each(function(){
        var th = $(this);
        if(!th.is(':visible')){
            //element isn't visible, don't show
            return;//continues to next element, that is next th
        }
        //column is either k-link or plain text like <th>Column</th>
        //so we extract text using this if:
        var kLink = th.find(".k-link")[0];
        if(kLink){
            displayedColumns.push(kLink.text);
        } else{
            displayedColumns.push(th.text());
        }

    });
    return displayedColumns;
};

/**
 * Finds the leaf node of an HTML structure
 */
function innerMost( root ) {
    var $children = $( root ).children();

    while ( true ) {
        var $temp = $children.children();
        if($temp.length > 0) $children = $temp;
        else return $children;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-29T14:35:23.357

对于 JSON 部分，有一个辅助函数可以提取 JSON 格式的数据，可以提供帮助：

```
var displayedData = $("#YourGrid").data().kendoGrid.dataSource.view().toJSON() 
```

编辑：由于剑道网格行为，上述方法出现一些错误后，我发现这篇文章解决了这个问题： [Kendo DataSource view not always return observablearray](http://blog.falafel.com/kendo-datasourceview-does-not-always-return-observablearray/)

# jquery - 我可以将 jquery 动画添加到 updateprogress 模板吗？

> ID：10324566
> 
> 赞同：0
> 
> 时间：2012-04-25T22:12:34.557
> 
> 标签：jquery, asp.net, animation, updatepanel

现在，我使用 UpdateProgress 模板来显示一个带有动画 gif 的 div，指示“某事”正在异步发生。我将显示固定在屏幕底部的 div。就像 updateprogress 控件通常工作一样，当发生异步调用时，会显示 UpdateProgress 控件。我想要它做的不仅仅是凭空显示，而是使用 jQuery 动画（如 SlideUp）作为 div 显示，甚至可能滑出，因为它在异步调用结束后被隐藏。现在我想象控件实际上显示和隐藏 div 就像你通常用手做的那样，所以必须有一种方法来添加动画。有人有想法么？？TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T05:39:09.753

updateprogress 在页面上发生服务器端进程时触发，因此我认为实现您想要发生的事情的最佳方法是切换到 jquery ajax 并使用 beforeSend 显示 div 并成功隐藏它......

# c++ - 由于 memcpy，C++ ifstream::read 很慢

> ID：10324582
> 
> 赞同：10
> 
> 时间：2012-04-25T22:14:08.863
> 
> 标签：c++, performance, visual-c++, fstream, memcpy

最近我决定优化我正在做的一些文件读取，因为正如大家所说，将大量数据读取到缓冲区然后使用它比使用大量小读取要快。而且我的代码现在当然要快得多，但是在进行了一些分析之后，memcpy 似乎占用了很多时间。

我的代码的要点是...

```
ifstream file("some huge file");
char buffer[0x1000000];
for (yada yada) {
    int size = some arbitrary size usually around a megabyte;
    file.read(buffer, size);
    //Do stuff with buffer
} 
```

我正在使用 Visual Studio 11，在分析我的代码后，它说`ifstream::read()`最终调用`xsgetn()`从内部缓冲区复制到我的缓冲区。这个操作占用了80%以上的时间！排在第二位的是`uflow()`占用 10% 的时间。

有什么办法可以绕过这种复制吗？我可以以某种方式告诉将`ifstream`我需要的大小直接缓冲到缓冲区中吗？C 风格是否`FILE*`也使用这样的内部缓冲区？

更新：由于人们告诉我使用 cstdio ......我做了一个基准测试。

编辑：不幸的是，旧代码充满了失败（它甚至没有读取整个文件！）。你可以在这里看到它：http: [//pastebin.com/4dGEQ6S7](http://pastebin.com/4dGEQ6S7)

这是我的新基准：

```
const int MAX = 0x10000;
char buf[MAX];
string fpath = "largefile";
int main() {
    {
        clock_t start = clock();
        ifstream file(fpath, ios::binary);
        while (!file.eof()) {
            file.read(buf, MAX);
        }
        clock_t end = clock();
        cout << end-start << endl;
    }
    {
        clock_t start = clock();
        FILE* file = fopen(fpath.c_str(), "rb");
        setvbuf(file, NULL, _IOFBF, 1024);
        while (!feof(file)) {
            fread(buf, 0x1, MAX, file);
        }
        fclose(file);
        clock_t end = clock();
        cout << end-start << endl;
    }
    {
        clock_t start = clock();
        HANDLE file = CreateFile(fpath.c_str(), GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_ALWAYS, NULL, NULL);
        while (true) {
            DWORD used;
            ReadFile(file, buf, MAX, &used, NULL);
            if (used < MAX) break;
        }
        CloseHandle(file);
        clock_t end = clock();
        cout << end-start << endl;
    }
    system("PAUSE");
} 
```

时间是：
185
80
78

嗯...看起来使用 C 风格的 fread 比 ifstream::read 快。同样，使用windows ReadFile 仅提供微不足道的优势（我查看了代码，fread 基本上是ReadFile 的包装器）。看来我毕竟要改用 fread 了。

伙计，编写一个真正正确测试这些东西的基准是令人困惑的。

结论：使用`<cstdio>`比`<fstream>`. fstream 较慢的原因是因为 c++ 流有自己的内部缓冲区。这会在您读/写时导致额外的复制，并且这种复制占 fstream 所花费的全部额外时间。更令人震惊的是，额外花费的时间比实际读取文件所花费的时间还要长。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T22:19:28.680

> 我可以以某种方式告诉 ifstream 将我需要的大小直接缓冲到缓冲区中吗？

是的，这就是[pubsetbuf()](http://en.cppreference.com/w/cpp/io/basic_filebuf/setbuf)的用途。

但是，如果您在读取文件时担心复制，请考虑内存映射，boost 有一个[可移植的实现](http://www.boost.org/doc/libs/release/libs/iostreams/doc/classes/mapped_file.html#mapped_file_source)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:19:45.403

如果你想加快文件 I/OI 的速度，建议你使用好的 ol' `<cstdio>`，因为它可以大大优于 C++ 的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T22:21:27.047

已经多次证明，读取数据最快的方式是`mmap()`在 linux 系统上。我不知道Windows。但是，它肯定会没有这种缓冲。

`fopen()`, `fread()`, `fwrite()`( `FILE*`) 有点高级，可能会引入缓冲区，而 `open()`, `read()`,`write()`函数是低级的，您可能在那里拥有的唯一缓冲区来自 Os 内核。

# javascript - 在 JQuery 中从字符串创建数组映射

> ID：10324583
> 
> 赞同：0
> 
> 时间：2012-04-25T22:14:13.253
> 
> 标签：javascript, jquery, map

我正在努力通过对 PHP 的深入了解来理解 jQuery。

我有一个这样的字符串：

```
[donor="company1" web="http://company1.com" amount="5.50"];[donor="company2" web="http://company2.com" amount="40.00"] 
```

我正在尝试从这个[问题](https://stackoverflow.com/questions/4538788/javascript-clearing-duplicates-from-an-array-object)中获得答案。

不幸的是，我不知道如何将我的字符串变成另一个问题的提问者必须开始的东西，即：

```
var data = [{'donor':'company1', 'web':'http://company1.com', 'amount':5.50}, 
            {'donor':'company2', 'web':'http://company2.com', 'amount':40.00}] 
```

你能提供的任何帮助都会很棒。我认为它与映射、关联数组、对象有关，但我就是不明白。

在此先感谢，我真的很感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:14:50.823

您可以使用 regex replacemnt 将原始字符串转换为所需的字符串：

```
var s='[donor="company1" web="http://company1.com" amount="5.50"];[donor="company2" web="http://company2.com" amount="40.00"]';
s='[' + s.replace(/\[/g,'{').replace(/\]/g,'}').replace(/=/g,':')
  .replace(/"\s/g,'", ').replace(/{(.+?):/g,'{"$1":')
  .replace(/;/g,',\r\n') + ']'; 
```

此转换的结果是您想要获取的字符串，它是对象数组的 JSON 表示法。

如果您评估此 JSON 表达式，您将获得对象数组。

如果将这些行添加到上一个脚本的末尾，您将看到一个长度为 2 的数组，其中包含 JSON 表示的对象：

```
var t = eval(s);
alert(t.length); // output 2, which is the array length
alert(t[0].donor); // outputs company1, which is the donor of the first object in the array 
```

您可以在[w3schools 中使用此代码尝试自己编辑器](http://www.w3schools.com/js/tryit.asp?filename=tryjs_events)。复制并粘贴此代码：

```
<html>
<head>
<script type="text/javascript">
var s='[donor="company1" web="http://company1.com" amount="5.50"];[donor="company2" web="http://company2.com" amount="40.00"]';
s='[' + s.replace(/\[/g,'{').replace(/\]/g,'}').replace(/=/g,':')
  .replace(/"\s/g,'", ').replace(/{(.+?):/g,'{"$1":')
  .replace(/;/g,',\r\n') + ']';
var t = eval(s);
alert("Array length: " + t.length);
alert("1st object donor: " + t[0].donor);
</script>
</head>
<body>

</body>
</html> 
```

# javascript - javascript上indexOf中的正则表达式

> ID：10324584
> 
> 赞同：0
> 
> 时间：2012-04-25T22:14:13.690
> 
> 标签：javascript, regex, indexof

我想从元素的 rel 属性中获取我的程序参数，首先它是否合乎逻辑？

并且 rel 属性可能包含这个字符串`rel="_p|b|w=300|h=200"`or `rel="_p|w=300"` ，所以我使用 split 来分割我的字符串 | 图案 ：

```
var attr = $(this).attr('rel').split('|'); 
```

for`_p`并且`b`没有问题，因为我可以检查`indexOf`but for`w`并且`h`我应该使用正则表达式，因为`w`and`h`值会发生变化。

如何在 indexOf 中使用正则表达式？

对不起，我的英语不好

编辑：

```
if (attr.indexOf('b')) {
        blank = true;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:21:18.307

首先，这不是一种非常优雅的数据检索方式。无论如何，如果你真的想这样做，那么你可以使用正则表达式，如下所示：

```
var matches = $(this).attr('rel').match(/w=(\d+)/);
var w = (matches && matches[1]) || defaultValue; 
```

此外，如果可以有多个以“w”结尾的元素，那么你最好将你的正则表达式更改为：

```
var matches = $(this).attr('rel').match(/(?:^|\|)w=(\d+)/); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:29:58.563

我也会建议使用自定义属性，但是这些不会像你想要的那样符合 w3。

一种简单的方法是拆分参数，然后遍历并检查每个索引是否是您期望的属性之一：

```
var cust_params = $(this).attr('rel').split('|'); //or this.rel as GGG suggested in a comment?

for(var i=0;i<cust_params.length;i++) {
    if('_p'==cust_params[i]) {
        //...
    }
    //...
    if(cust_params[i].match(/w=(\d+)/)) {
        //you could even do this without a regular expression
    }
} 
```

我希望这不会违反我不知道的一些好的做法，因为我总是觉得当我做这种事情时必须有一种更优雅的方式:) 因为它是我得到一种快速而肮脏的对此感到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:30:58.677

像 Paolo Bergantino 一样，我也建议使用数据属性，*或者*您可以将数据存储在 JSON 中（同样，在数据属性中）并解析：

```
<a href="#" data-info='{"width": "300", "height": "200", "color": "#fff", "etc": "foo"}'>

var info = JSON.parse(a.getAttribute('data-info')); 
```

编辑：替换`eval`为 Phrogz 的建议。

`eval('(' + a.getAttribute('data-info') + ')')`（带评估：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T22:39:49.300

抱歉，您无法使用普通的 javascript 在一个命令中完成此操作， indexOf 只是不支持正则表达式。

您可以遍历数组或使用`jquery`支持的数组命令。

例如：一旦你有`attr`你喜欢的数组，你可以使用`jQuery.grep()` [http://api.jquery.com/jQuery.grep/](http://api.jquery.com/jQuery.grep/)

```
a_equal = jQuery.grep(attr, function(a, i){
  return (a.match(/=/) and i > 0); // modify this as you like
}); 
```

`a_equal`用所有赋值参数创建一个数组。

*免责声明..代码尚未测试。*

# ruby-on-rails - Ruby / Rails——从哪里包含一个方法？

> ID：10324587
> 
> 赞同：2
> 
> 时间：2012-04-25T22:14:26.047
> 
> 标签：ruby-on-rails, ruby

有没有办法找出方法包含在 Ruby / Ruby on Rails 中的位置？

例如，通过搜索[Rails API](http://api.rubyonrails.org)，我知道：

*   `link_to`来自`ActionView::Helpers::UrlHelper`，并且
*   `pluralize`来自`ActionView::Helpers::TextHelper`

但是有没有办法在 Ruby 本身中找出答案？即在`irb`，或Rails 控制台？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:18:33.293

是的：

```
@object.method(:method_name) 
```

例如：

```
@object.method(:pluralize) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T23:14:55.970

无论您身处何种环境，都可以使用以下方法获取源位置：

```
obj.method(:method).source_location 
```

它不会给你你想要的东西，但是 Rails 核心开发人员擅长正确命名空间。以下示例可以从 rails 控制台运行：

```
Time.method(:zone).source_location

["/Users/pete/.rvm/gems/ruby-1.9.2-p290@gemset/gems/activesupport-3.2.3/lib/active_support/core_ext/time/zones.rb", 9] 
```

Then you can go to the [Rails source](https://github.com/rails/rails) and search for that file. Hint: type 't' on Github and start typing. It will bring you to [that file](https://github.com/rails/rails/blob/master/activesupport/lib/active_support/core_ext/time/zones.rb) and you can see that it is defined directly on the Time class.

# android - 蓝牙输入流不需要的拆分

> ID：10324593
> 
> 赞同：2
> 
> 时间：2012-04-25T22:15:18.620
> 
> 标签：android, bluetooth, message, inputstream

我遇到了蓝牙问题，我的连接已经建立，我可以向我的模块发送数据，但接收总是拆分我的字节数组，来自模块的消息在第一个字节和消息的其余部分分开，所以不是单个消息我收到两个。我使用了蓝牙聊天示例。

```
 public void run() {
        Log.i(TAG, "BEGIN mConnectedThread");
        byte[] buffer = new byte[100];

        int bytes;

        // Keep listening to the InputStream while connected
        while (true) {
            try {
                // Read from the InputStream
                bytes = mmInStream.read(buffer);

                // Send the obtained bytes to the UI Activity
                mHandler.obtainMessage(ActivityTrafficSignChooserUpperSign.MESSAGE_READ, bytes, bytes, buffer)
                        .sendToTarget();
                //Log.d(TAG, bytes);
            } catch (IOException e) {
                Log.e(TAG, "disconnected", e);
                connectionLost();
                break;
            }
        }
    } 
```

这是我活动的一部分：

```
private final Handler mHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        switch (msg.what) {

            case MESSAGE_READ:
                byte[] readBuf = (byte[]) msg.obj;
                // construct a string from the valid bytes in the buffer
                readMessage = new String(readBuf, 0, msg.arg1);
                Toast.makeText(getApplicationContext(), readMessage, Toast.LENGTH_SHORT).show();

                break;
         }} 
```

# jquery - jQuery - 非法调用

> ID：10324594
> 
> 赞同：126
> 
> 时间：2012-04-25T22:15:25.560
> 
> 标签：jquery, ajax, post

**jQuery v1.7.2**

我有这个函数，它在执行时给了我以下错误：

```
Uncaught TypeError: Illegal invocation 
```

这是功能：

```
$('form[name="twp-tool-distance-form"]').on('submit', function(e) {
    e.preventDefault();

    var from = $('form[name="twp-tool-distance-form"] input[name="from"]');
    var to = $('form[name="twp-tool-distance-form"] input[name="to"]');
    var unit = $('form[name="twp-tool-distance-form"] input[name="unit"]');
    var speed = game.unit.speed($(unit).val());

    if (!/^\d{3}\|\d{3}$/.test($(from).val()))
    {
        $(from).css('border-color', 'red');
        return false;
    }

    if (!/^\d{3}\|\d{3}$/.test($(to).val()))
    {
        $(to).css('border-color', 'red');
        return false;
    }

    var data = {
        from : from,
        to : to,
        speed : speed
    };

    $.ajax({
        url : base_url+'index.php',
        type: 'POST',
        dataType: 'json',
        data: data,
        cache : false
    }).done(function(response) {
        alert(response);
    });

    return false;
}); 
```

如果我`data`从 ajax 调用中删除，它可以工作..有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2014-01-03T15:52:14.033

尝试在这样的 ajax 设置中设置**processData: false**

```
$.ajax({
    url : base_url+'index.php',
    type: 'POST',
    dataType: 'json',
    data: data,
    cache : false,
    processData: false
}).done(function(response) {
    alert(response);
}); 
```

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2012-04-25T22:27:13.540

我认为您需要将字符串作为数据值。可能是 jQuery 内部的某些东西没有正确编码/序列化 To & From 对象。

尝试：

```
var data = {
    from : from.val(),
    to : to.val(),
    speed : speed
}; 
```

还要注意以下行：

```
$(from).css(...
$(to).css( 
```

您不需要 jQuery 包装器，因为 To & From 已经是 jQuery 对象。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-02-26T09:02:38.553

只是为了记录，如果您尝试在数据中使用未声明的变量，例如

```
var layout = {};
$.ajax({
  ...
  data: {
    layout: laoyut // notice misspelled variable name
  },
  ...
}); 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2018-10-27T12:05:16.810

如果您想使用 Javascript **FormData** API 提交表单并上传文件，您需要设置以下两个选项：

```
processData: false,
contentType: false 
```

您可以尝试如下：

```
//Ajax Form Submission
$(document).on("click", ".afs", function (e) {
    e.preventDefault();
    e.stopPropagation();
    var thisBtn = $(this);
    var thisForm = thisBtn.closest("form");
    var formData = new FormData(thisForm[0]);
    //var formData = thisForm.serializeArray();

    $.ajax({
        type: "POST",
        url: "<?=base_url();?>assignment/createAssignment",
        data: formData,
        processData: false,
        contentType: false,
        success:function(data){
            if(data=='yes')
            {
                alert('Success! Record inserted successfully');
            }
            else if(data=='no')
            {
                alert('Error! Record not inserted successfully')
            }
            else
            {
                alert('Error! Try again');
            }
        }
    });
}); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-06-28T12:00:54.997

就我而言，我只是改变了

**注意：**这是 Django 的情况，所以我添加了`csrftoken`. 在您的情况下，您可能不需要它。

> 添加`contentType: false`,`processData: false`
> 
> 已注释掉`"Content-Type": "application/json"`

```
$.ajax({
    url: location.pathname, 
    type: "POST",
    crossDomain: true,
    dataType: "json",
    headers: {
        "X-CSRFToken": csrftoken,
        "Content-Type": "application/json"
    },
    data:formData,
    success: (response, textStatus, jQxhr) => {

    },
    error: (jQxhr, textStatus, errorThrown) => {

    }
}) 
```

到

```
$.ajax({
    url: location.pathname, 
    type: "POST",
    crossDomain: true,
    dataType: "json",
    contentType: false,
    processData: false,
    headers: {
        "X-CSRFToken": csrftoken
        // "Content-Type": "application/json",
    },
    data:formData,
    success: (response, textStatus, jQxhr) => {

    },
    error: (jQxhr, textStatus, errorThrown) => {

    }
}) 
```

它奏效了。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-07-15T12:20:30.527

在我的情况下，我没有定义我在 ajax 中传递给数据的所有变量。

```
var page = 1;

$.ajax({
    url: 'your_url',
    type: "post",
    data: { 'page' : page, 'search_candidate' : search_candidate }
    success: function(result){
        alert('function called');
    }
)} 
```

我刚刚定义了变量`var search_candidate = "candidate name";`及其工作。

```
var page = 1;
var search_candidate = "candidate name"; // defined
$.ajax({
    url: 'your_url',
    type: "post",
    data: { 'page' : page, 'search_candidate' : search_candidate }
    success: function(result){
        alert('function called');
    }
)} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-14T19:34:50.943

我的问题与`processData`. 这是因为我发送了一个以后无法调用的函数，`apply`因为它没有足够的参数。具体来说，我不应该用作`alert`回调`error`。

```
$.ajax({
    url: csvApi,
    success: parseCsvs,
    dataType: "json",
    timeout: 5000,
    processData: false,
    error: alert
}); 
```

有关为什么这可能是一个问题的更多信息，请参阅此答案：[为什么某些函数调用在 JavaScript 中被称为“非法调用”？](https://stackoverflow.com/questions/10743596/why-are-certain-function-calls-termed-illegal-invocations-in-javascript)

我能够发现这一点的方法是`console.log(list[ firingIndex ])`向 jQuery 添加一个，这样我就可以跟踪它正在触发什么。

这是修复：

```
function myError(jqx, textStatus, errStr) {
    alert(errStr);
}

$.ajax({
    url: csvApi,
    success: parseCsvs,
    dataType: "json",
    timeout: 5000,
    error: myError // Note that passing `alert` instead can cause a "jquery.js:3189 Uncaught TypeError: Illegal invocation" sometimes
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-16T05:56:31.323

在我的情况下（使用 webpack 4）在一个匿名函数中，我将其用作回调。

我不得不使用`window.$.ajax()`而不是`$.ajax()`尽管有：

```
import $ from 'jquery';
window.$ = window.jQuery = $; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-28T16:11:39.357

这也是一个原因：如果你构建了一个 jQuery 集合（通过 .map() 或类似的东西），那么你不应该在 .ajax() 的数据中使用这个集合。因为它仍然是一个**jQuery 对象**，而不是普通的**JavaScript Array**。您应该在 and 处使用 .get() 来获取普通的 js 数组，并且应该在 .ajax() 上的数据设置中使用它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-27T09:46:26.760

为我工作。 **processData: false, contentType: false,**工作需要。

```
 var formData = new FormData($('#author_post')[0]);
 formData.append('t','author-add');
 $.ajax({
        type: 'POST',
        url: 'url-here',
        cache: false,
        processData: false,
        contentType: false,
        data:formData,
        success: function(response) {
           //success code
        }
 }); 
```

# iphone - 检测何时按下主页按钮iOS

> ID：10324596
> 
> 赞同：28
> 
> 时间：2012-04-25T22:15:36.633
> 
> 标签：iphone, ios, ipad, ios5

我有几个 iOS 应用程序都使用相同的端口来监听网络信标。在主视图上，当打开另一个视图时，我使用 viewWillDisappear 关闭端口，效果很好。然后我注意到如果我从主视图控制器按下主页按钮而不打开另一个视图来关闭端口，那么端口保持打开状态并且我的其他应用程序不能再监听该端口。然后我尝试使用 viewWillUnload，但是当我按下主页按钮时似乎没有被调用。

```
-(void)viewWillUnload
{
    //[super viewWillUnload];
    NSLog(@"View will unload");
    [udpSocket close];
    udpSocket = nil;
} 
```

View will unload 永远不会显示在控制台中，这使我相信该方法永远不会被调用。

有没有办法检测何时按下主页按钮以便我可以关闭我的端口？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-04-25T22:41:41.237

这些是您的选择

在您的应用委托中：

```
- (void)applicationWillResignActive:(UIApplication *)application
{
    // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
    // Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
}

- (void)applicationDidEnterBackground:(UIApplication *)application
{
    // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later. 
    // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
}

- (void)applicationWillTerminate:(UIApplication *)application
{
    // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-11-06T22:26:45.843

处理此问题的最简单方法是在视图控制器中注册以接收 UIApplicationWillResignActiveNotification 通知。

该事件在按下主页按钮、锁定和打电话时发出

```
- (void) applicationWillResign{
    NSLog(@"About to lose focus");
}

- (void) myVcInitMethod { 
    [[NSNotificationCenter defaultCenter]
        addObserver:self
        selector:@selector(applicationWillResign)
        name:UIApplicationWillResignActiveNotification 
        object:nil];
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-10-03T23:04:28.867

如果是 Swift 用户

你可以这样写

```
override func viewDidLoad() {
    super.viewDidLoad()

    // code here...

    NSNotificationCenter.defaultCenter().addObserver(
        self,
        selector: "applicationWillResignActive:",
        name: UIApplicationWillResignActiveNotification,
        object: nil)
}

func applicationWillResignActive(notification: NSNotification) {
    print("I'm out of focus!")
} 
```

另外，不要忘记在您的应用程序终止时关闭它

```
deinit {

    // code here...

    NSNotificationCenter.defaultCenter().removeObserver(self)
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-25T22:43:02.860

`viewWillUnload`通常不调用，除非内存不足。您最好实现[应用程序委托方法](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html) `applicationDidEnterBackground:`或`applicationWillTerminate:`在那里完成工作或向知道如何处理清理过程的应用程序部分发送通知。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-25T23:36:10.703

**viewWillUnload 通常不会被调用，除非内存不足。** 改用这些：

在您的应用程序委托中：

```
- (void)applicationWillResignActive:(UIApplication *)application
{
// Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
// Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
}

- (void)applicationDidEnterBackground:(UIApplication *)application
{
// Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later. 
// If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
}

- (void)applicationWillTerminate:(UIApplication *)application
{
// Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.
} 
```

或者，如果您想在视图控制器中使用代码：

```
- (void)viewDidDisappear:(BOOL)animated
{
//Put code here
}

- (void)viewWillDisappear:(BOOL)animated
{
//Put code here
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-10-25T14:14:58.560

更好地使用`UIApplicationWillResignActive`并且`UIApplicationDidBecomeActive`由于它们捕获“顶部矩形捕获和释放事件”。我建议使用这个根类：

```
class VBase: UIViewController {
    fileprivate var listenersActivated = false
    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view.
    }
    override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(animated)
        onStart()
    }
    override func viewWillDisappear(_ animated: Bool) {
        super.viewWillDisappear(animated)
        onStop()
        removeListeners()
    }
    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
        onStop()
        removeListeners()
    }

    internal func iniListeners() {
        if (!listenersActivated) {
            NotificationCenter.default.addObserver(self, selector: #selector(onStop), name: NSNotification.Name.UIApplicationWillResignActive, object: nil)
            NotificationCenter.default.addObserver(self, selector: #selector(onStart), name: NSNotification.Name.UIApplicationDidBecomeActive, object: nil)
            listenersActivated = true
        } else {

        }
    }
    internal func removeListeners() {
        NotificationCenter.default.removeObserver(self)
        listenersActivated = false
    }
    internal func onStop() {

    }
    internal func onStart() {
        iniListeners()
    }

} 
```

覆盖`onStop()`和`onStart()`内部子项以捕获所有视图出现/消失

那是，

```
class SomeViewController: VBase {

...
    override func onStart() {
        super.onStart()
        someFunctionToInitialize()
    }
    override func onStop() {
        super.onStop()
        stopTimer()
        someFunctionToDesctruction()
    }
} 
```

# mysql - 让mysql回答表中有多少个名字

> ID：10324597
> 
> 赞同：0
> 
> 时间：2012-04-25T22:15:39.010
> 
> 标签：mysql

![简单的表](../Images/0e72cb2c50d109ceb0abdb3b3641f5f7.png)

假设我们有这个非常简单的“测试”表。

有：5 个鲍勃，2 个亚当，1 个亚历克斯。

无论如何我可以让MySQL回答这样的事情：

```
name | count
bob  | 5
adam | 2
alex | 1 
```

不使用php？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:16:37.030

```
SELECT name, COUNT(1) AS count
FROM test
GROUP BY name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:16:54.923

这是一个简单的 GROUP BY 查询：

```
SELECT name, COUNT(*) FROM table GROUP BY name 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T22:25:56.220

您可以`COUNT`使用`GROUP BY`：

```
SELECT name, COUNT(name) as total
FROM test
GROUP BY name
ORDER BY total DESC 
```

这是一个工作示例：[http ://sqlfiddle.com/#!2/9a9f2/3](http://sqlfiddle.com/#!2/9a9f2/3)

# xml - XSD 允许序列中元素的属性

> ID：10324601
> 
> 赞同：0
> 
> 时间：2012-04-25T22:16:13.680
> 
> 标签：xml

我想创建一个允许以下 XML 的 XSD 架构。我想我什么都有，除了`<subsegent>`元素上的属性。有人可以提供一个示例 XSD 吗？我尝试过的一切都会产生错误。

```
<Segment>
    <Subsegment target="all">This is test 1</Subsegment>
    <Subsegment target="some">This is test 2</Subsegment>
</Segment> 
```

更新

这是我尝试过的一个 XSD。我希望序列中的元素具有属性。我收到此错误：“此上下文不支持 'http://www.w3.org/2001/XMLSchema:attribute' 元素。” 从我的工具。

谢谢

```
<xsd:schema elementFormDefault="qualified" xmlns:xsd="http://www.w3.org/2001/XMLSchema" >
<xsd:complexType name="Segment">
    <xsd:sequence>
        <xsd:element name="Subsegment" minOccurs="1" maxOccurs="unbounded" type="xsd:string">
            <xsd:attribute name="target" type="xsd:string" use="required" />
        </xsd:element>
    </xsd:sequence>
</xsd:complexType>
</xsd:schema> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T14:15:08.153

架构......

```
<?xml version="1.0"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">

  <xsd:element name="Segment">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="Subsegment" minOccurs="1" maxOccurs="unbounded" type="SubsegmentType"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>

  <xsd:complexType name="SubsegmentType">
    <xsd:simpleContent>
      <xsd:extension base="xsd:string">
        <xsd:attribute name="target" type="xsd:string"/>
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>

</xsd:schema> 
```

而使用 xmllint 的结果......

```
xmllint testfile.xml --schema Subsegment.xsd
<?xml version="1.0" encoding="UTF-8"?>
<Segment>
    <Subsegment target="all">This is test 1</Subsegment>
    <Subsegment target="some">This is test 2</Subsegment>
</Segment>
testfile.xml validates 
```

让我们添加一些错误来验证...

**使用未指定的元素**

```
xmllint badtestfile.xml --schema Subsegment.xsd
<?xml version="1.0" encoding="UTF-8"?>
<Segment>
    <Something-Else/>
    <Subsegment target="all">This is test 1</Subsegment>
    <Subsegment target="some">This is test 2</Subsegment>
</Segment>
badtestfile.xml:3: element Something-Else: Schemas validity error : Element 'Something-Else': This element is not expected. Expected is ( Subsegment ).
badtestfile.xml fails to validate 
```

**使用无效属性**

```
xmllint badtestfile.xml --schema Subsegment.xsd
<?xml version="1.0" encoding="UTF-8"?>
<Segment>
    <Subsegment mytarget="all">This is test 1</Subsegment>
    <Subsegment target="some">This is test 2</Subsegment>
</Segment>
badtestfile.xml:3: element Subsegment: Schemas validity error : Element 'Subsegment', attribute 'mytarget': The attribute 'mytarget' is not allowed.
badtestfile.xml fails to validate 
```

# iphone - 在 iOS SDK 中发出请求，循环飞得太快

> ID：10324610
> 
> 赞同：1
> 
> 时间：2012-04-25T22:16:49.983
> 
> 标签：iphone, ios, xcode, facebook-graph-api

我有一个我想调用的朋友 ID 数组，然后存储返回的数据对象。

看起来像这样：

```
for (int i = 0; i < self.friendIDArray.count; i++){

            self.detailedRequest = [facebook requestWithGraphPath:[self.friendIDArray objectAtIndex:i] andDelegate:self];
        } 
```

问题是我想我发送请求太频繁了，没有给 FB 机会正确返回数据？我怎样才能解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:57:39.750

这是您需要做的。这非常接近地模仿了您如何使用 NSURLConnection API 发出异步请求。

在你的 header/.h 文件中创建一个类属性（成员变量，无论你想怎么称呼它）

```
//header/.h file
int indexOfLastFriendLoaded; 
```

在您的实现文件中：

```
- (void) loadFriend:(int) indexOfFriendToLoad {
    [facebook requestWithGraphPath:[self.friendIDArray objectAtIndex:indexOfFriendToLoad] andDelegate:self];
}

//this method is called when each facebook request finishes,
- (void)request:(FBRequest *)request didLoad:(id)result {
    //first do whatever you need to with "result" to save the loaded friend data

    //We make the next request from this method since we know the prior has already completed.
    if (indexOfLastFriendLoaded < [self.friendIDArray count]) {
        [self loadFriend:indexOfLastFriendLoaded];
        indexOfLastFriendLoaded++;
    }   
}

- (void) viewDidLoad {
    //initialize facebook object first

    indexOfLastFriendLoaded = 0;
    [self loadFriend:indexOfLastFriendLoaded];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:06:07.527

requests api 建议您委派处理结果。

[https://developers.facebook.com/docs/reference/iossdk/FBRequestDelegate/](https://developers.facebook.com/docs/reference/iossdk/FBRequestDelegate/)

# c - 如何在 C 中计算大文件的 MD5 哈希？

> ID：10324611
> 
> 赞同：17
> 
> 时间：2012-04-25T22:16:54.480
> 
> 标签：c, hash, md5

我正在使用 OpenSSL 库用 C 语言编写。

如何使用 md5 计算大文件的哈希？

据我所知，我需要将整个文件作为 char 数组加载到 RAM，然后调用哈希函数。但是如果文件大约 4Gb 长呢？听起来是个坏主意。

**[已](https://stackoverflow.com/users/1347147/askovpen)解决：感谢**askovpen**，我发现了我的错误。我用过**

 **```
while ((bytes = fread (data, 1, 1024, inFile)) != 0)
    MD5_Update (&mdContext, data, 1024); 
```

不是

```
while ((bytes = fread (data, 1, 1024, inFile)) != 0)
    MD5_Update (&mdContext, data, bytes); 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-04-25T22:48:16.670

例子

`gcc -g -Wall -o file file.c -lssl -lcrypto`

```
#include <stdio.h>
#include <openssl/md5.h>

int main()
{
    unsigned char c[MD5_DIGEST_LENGTH];
    char *filename="file.c";
    int i;
    FILE *inFile = fopen (filename, "rb");
    MD5_CTX mdContext;
    int bytes;
    unsigned char data[1024];

    if (inFile == NULL) {
        printf ("%s can't be opened.\n", filename);
        return 0;
    }

    MD5_Init (&mdContext);
    while ((bytes = fread (data, 1, 1024, inFile)) != 0)
        MD5_Update (&mdContext, data, bytes);
    MD5_Final (c,&mdContext);
    for(i = 0; i < MD5_DIGEST_LENGTH; i++) printf("%02x", c[i]);
    printf (" %s\n", filename);
    fclose (inFile);
    return 0;
} 
```

结果：

```
$ md5sum file.c
25a904b0e512ee546b3f47574703d9fc  file.c
$ ./file
25a904b0e512ee546b3f47574703d9fc file.c 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T22:22:09.427

首先，MD5 是一种散列算法。它不加密任何东西。

无论如何，您可以以任意大小的块读取文件。调用[MD5_Init](http://linux.die.net/man/3/md5_update)一次，然后使用从文件中读取的每个数据块调用[MD5_Update 。](http://linux.die.net/man/3/md5_update)完成后，调用[MD5_Final](http://linux.die.net/man/3/md5_update)获取结果。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-25T22:21:52.777

您不必一次将整个文件加载到内存中。您可以使用函数 [MD5_Init()、MD5_Update() 和 MD5_Final()](http://www.openssl.org/docs/crypto/md5.html)将其分块处理以生成哈希。如果您担心使其成为“原子”操作，则可能需要锁定文件以防止其他人在操作期间对其进行更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-12T13:34:51.383

最佳答案是正确的，但没有提及：哈希值对于使用的每个缓冲区大小都会有所不同。该值将在散列之间保持一致，因此相同的缓冲区大小每次都会产生相同的散列，但是如果稍后将此散列与相同数据的散列进行比较，则每次调用必须使用相同的缓冲区大小。

另外，如果你想确保你的摘要代码正常运行，并上网与在线哈希网站比较你的哈希，看起来他们使用的缓冲区长度为 1。这也带来了一个有趣的想法：完全可以接受使用 1 的缓冲区长度来散列一个大文件，它只需要更长的时间（*duh*）。

所以我的经验法则是，如果它仅供内部使用，那么我可以为大文件相应地设置缓冲区长度，但如果它必须与其他系统很好地配合，则将缓冲区长度设置为 1 并处理时间后果.

```
int hashTargetFile(FILE* fp, unsigned char** md_value, int *md_len) {

    #define FILE_BUFFER_LENGTH 1

    EVP_MD_CTX *mdctx;
    const EVP_MD *md;
    int diglen; //digest length
    int arrlen = sizeof(char)*EVP_MAX_MD_SIZE + 1;
    int arrlen2 = sizeof(char)*FILE_BUFFER_LENGTH + 1;
    unsigned char *digest_value = (char*)malloc(arrlen);
    char *data = (char*)malloc(arrlen2);
    size_t bytes; //# of bytes read from file

    mdctx = EVP_MD_CTX_new();
    md = EVP_sha512();

    if (!mdctx) {
        fprintf(stderr, "Error while creating digest context.\n");
        return 0;
    }

    if (!EVP_DigestInit_ex(mdctx, md, NULL)) {
        fprintf(stderr, "Error while initializing digest context.\n");
        return 0;
    }

    while (bytes = fread(data, 1, FILE_BUFFER_LENGTH, fp) != 0) {
        if (!EVP_DigestUpdate(mdctx, data, bytes)) {
            fprintf(stderr, "Error while digesting file.\n");
            return 0;
        }
    }

    if (!EVP_DigestFinal_ex(mdctx, digest_value, &diglen)) {
        fprintf(stderr, "Error while finalizing digest.\n");
        return 0;
    }

    *md_value = digest_value;
    *md_len = diglen;

    EVP_MD_CTX_free(mdctx);

    return 1;
} 
```**

# ruby-on-rails-3 - Cancan 允许更新模型的特定属性

> ID：10324614
> 
> 赞同：1
> 
> 时间：2012-04-25T22:17:00.117
> 
> 标签：ruby-on-rails-3, cancan

我想使用 cancan 来允许更新模型的某个属性而不是其他属性。这是我的更新操作的样子。

```
 class UsersController < ApplicationController
   load_and_authorize_resource

   def update
   respond_with User.update(params[:id], params[:user])
   end
 end 
```

如果resource.instance_of？老师

```
 can [:read, :update], User do |user|
   resource.users.include? user
 end 
```

我希望老师能够修改 user.course_id 但没有别的。我应该如何改变

```
 can :update, User 
```

做我想做的事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T14:47:46.583

嗯..我不确定康康舞曲能力中的“动作”是否必须明确地是控制器中的动作。如果不是，你可以做......

```
# ability.rb
if resource.instance_of? Teacher 
  can :update_course, User
end

# Controller
def update
  params[:user].delete(:course_id) if cannot? :update_course, User
  respond_with User.update(params[:id], params[:user])
end 
```

# c# - 使用 asp.net web api 进行部分更新

> ID：10324615
> 
> 赞同：8
> 
> 时间：2012-04-25T22:17:02.227
> 
> 标签：c#, asp.net-mvc, json.net, asp.net-web-api

我使用 web api 和 dbContext 在 asp.net mvc 3 中创建了一个简单的待办事项列表应用程序。（客户端使用主干和requirejs）一切正常，但我有点担心如果我选中或取消选中待办事项项，我必须将整个模型发送到服务器。我只想在提交数据时发送“完成”字段。

我应该提一下，我还使用 JsonNetFormatter 来使用 JSON.NET 作为默认序列化程序（此处解释：http: [//blogs.msdn.com/b/henrikn/archive/2012/02/18/using-json- net-with-asp-net-web-api.aspx](http://blogs.msdn.com/b/henrikn/archive/2012/02/18/using-json-net-with-asp-net-web-api.aspx)）。

目前这是我更新模型的 api 控制器方法

```
public HttpResponseMessage Put(Todo todo)
{
    _db.Entry(todo).State = EntityState.Modified;
    _db.SaveChanges();
    return new HttpResponseMessage(HttpStatusCode.NoContent);
} 
```

将其作为 json 数据

```
{"content":"Pick up milk","done":false,"id":10} 
```

当然这可行，但它正在更新整个模型，它应该只更新 1 个字段。我可以实现只将更改的字段从浏览器发送到服务器，但我不确定 web api 方法应该是什么样子。我正在考虑使用 FormCollection 做一些事情，但这似乎不适用于 web api，因为它似乎试图将提交的表单值直接序列化为 FormCollection 类型，我收到此错误。

```
Cannot deserialize JSON object (i.e. {"name":"value"}) into type 'System.Web.Mvc.FormCollection'. 
```

如何将模型中 1 个或多个字段的部分更新发送到我的 Web api？我只想将更新的字段发送到服务器，然后从那里只将这些字段更新到数据库。我当然不想在更新之前查询数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-06T17:51:39.277

一种方法是使用名为[Automapper](http://automapper.org/)的工具并对其进行配置，以便在映射 Todo 对象时空值不会覆盖现有值。例如：

```
 Mapper.CreateMap<Todo,Todo>()
        .ForMember(d => d.Id, o => o.Ignore())
        .ForAllMembers(mo => mo.Condition(cond => !cond.IsSourceValueNull)); 
```

然后，您只需将接收到的对象值映射到现有对象值，如下所示：

```
 Mapper.Map(todo, item); 
```

另一个建议是使用 PATCH 而不是 PUT ，这[更适合根据 REST 对资源进行部分更新](https://stackoverflow.com/questions/14177676/whats-the-currently-recommended-way-of-performing-partial-updates-with-web-api)。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-04-25T22:34:10.420

您需要从数据库中查询原始对象，设置其属性并调用 _db.SaveChange()

```
public HttpResponseMessage Put(Todo todo){
var item = _db.Todo.First(i => i.id = todo.id);
item.Content = todo.Content;
item.Done = todo.Done;
_db.SaveChanges();
return new HttpResponseMessage<Todo>(HttpStatusCode.Accepted);
} 
```

参考：http: [//msdn.microsoft.com/en-us/library/dd456854.aspx](http://msdn.microsoft.com/en-us/library/dd456854.aspx)

# arrays - 通用列表实用程序可以使用向量 (AS3) 吗？

> ID：10324618
> 
> 赞同：0
> 
> 时间：2012-04-25T22:17:24.033
> 
> 标签：arrays, actionscript-3, list, generics, vector

使用 Object 或 * 作为 Vector 的类型不提供通用功能（如 Java 中的 List）。见证：

```
public static function someGenericVectorUtil (value:Vector.<*>) :void {
    // do stuff to/with the Vector
}

var someVector:Vector.<Number>;
someGenericVectorUtil(someVector);  // compile-time implicit coercion error 
```

所以，也许我们重新定义了实用方法来接受一个数组。但是没有简单的方法可以将进入实用程序的向量转换为数组，也没有简单的方法在之后将它们打包回来，导致代码如下：

```
public static function someGenericArrayUtil (value:Array) :void {
    // do stuff to/with the formerly-known-as-Vector
}

var someVector:Vector.<Number>;
var tempArray:Array = new Array(someVector.length);
for (var i:uint=0; i<someVector.length; i++) {
    tempArray[i] = someVector[i];
}
someGenericVectorUtil(tempArray);
someVector = Vector.<Number>([tempArray]); 
```

不用说，这非常可怕。好的，让我们将 Vector-Array-Vector 废话移到实用程序中：

```
public static function vectorToArray (Vector.<*>) :Array {
    // oh wait....that Vector.<*> param is useless,
    // as demonstrated earlier.
} 
```

有什么办法可以解决这个烂摊子吗？或者当我认为我可能需要通过通用实用程序运行 Vectors 时，我应该停止使用它们吗？（显然，也不是一个真正的选择......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:43:16.807

```
public static function someGenericVectorUtil (value:Vector.<*>) :void {
    // do stuff to/with the Vector
}

var someVector:Vector.<Number>;
someGenericVectorUtil(Vector.<*>(someVector)); 
```

^ 它有效。也尝试使用数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:39:05.830

这不是答案，而是对@Lukasz 答案的长评论。

The problem with his answer is that you're actually creating a new Vector, so you need to return the Vector from `someGenericVectorUtil` and re-cast it. E.g. try:

```
var v:Vector.<int> = Vector.<int>([1,2,3]); 
trace( v == Vector.<int>( Vector.<*>( v ) ) ); // traces false 
```

That code just creates a simple Vector of `ints`, then compares it with a version of itself casted (first to `*`, then back to `int`). If you trace the Vectors out, they'll trace identical, but the actual Vectors references themselves aren't the same object. Thus if you have a utility function that modifies the Vector (e.g. a shuffle or randomise function), nothing will change.

E.g:

```
var v:Vector.<int> = Vector.<int>([1,2,3]);
trace( v ); // traces "1,2,3"

// shuffle() randomises the elements in a vector - this first call won't work
// as the cast creates a new vector
VectorUtil.shuffle( Vector.<*>( v ) );
trace( v ); // traces "1,2,3"

// we need to recast it back, and change shuffle() to return the vector
v = Vector.<int>( VectorUtil.shuffle( Vector.<*>( v ) ) );
trace( v ); // traces "3,1,2" 
```

As you can see, it starts to get a bit ugly towards the end, and if you're keeping track of the Vector anywhere else, you'll need to update the references, but it's the only solution that I've found so far :S

# javascript - (function(global){ some code .. })(this) 中的 global 有什么作用？

> ID：10324621
> 
> 赞同：1
> 
> 时间：2012-04-25T22:17:35.830
> 
> 标签：javascript

我正在考虑向 JSON 添加注释，并发现[这个脚本](https://github.com/getify/JSON.minify/blob/master/minify.json.js)在处理使 JSON 有效之前将它们剥离。我只是想了解如何使 JSON.minify() 函数可用？

它开始于

```
(function(global){ ... 
```

这对我来说很奇怪。我在 MDN 上发现“[全局是 RegExp 实例的属性，而不是 RegExp 对象](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp/global)”，但我完全不明白它在这个脚本中是如何工作的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:19:20.757

这个片段：

```
(function(global){
   // your code here
   // referring to the variable named "global" in this scope 
   // will be a reference to the default javascript global object
})(this); 
```

是一个构造，用于将全局对象（无论它可能是什么）分配给一个标记`global`为这个自执行函数内部的所有代码的参数。

自执行函数用于定义单独的执行范围，以便您在此其他范围内定义的任何函数或变量都不会干扰或可从此范围外直接访问（将您的范围与其他代码范围隔离）。

在浏览器中，全局对象就是`window`对象，但是如果您打算拥有可能在全局对象可能不存在的其他 javascript 环境（例如服务器上没有 node.js）中工作的代码`window`，这是一种提取默认值的全局值`this`，将其放入另一个变量中，然后您可以在代码块中的任何位置引用该变量。

对于仅在浏览器中运行的代码，这确实没有意义。您可以`window`在需要全局对象时参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:20:52.893

它只是一个函数参数名称。它也可能是`froozboggles`。

这段代码：

```
(function(foo) {
    // In here, what's called "bar" in the outer scope is called "foo"
})(bar); 
```

定义一个接受一个参数的匿名函数，`bar`并立即以`bar`第一个参数的值调用它。

除了 jfriend00 在他的好回答中提到的内容之外，这也是确保您不会将变量和函数泄漏到外部范围的好方法：如果您`var baz = 17;`在 javascript 的顶级范围中声明，它将是一个属性的`window`。如果您将其包装在您提到的模式中的函数中，则只能将属性`window`显式导出为 -`global`在您的示例中，通过将它们分配给 。**编辑：**正如@josh3736 在他的评论中所说，您也可以`window`通过在没有先前声明的情况下分配来泄漏，例如`quux = 4711;`.

# javascript - 关于如何根据内容高度最好地显示其他内容的建议

> ID：10324622
> 
> 赞同：0
> 
> 时间：2012-04-25T22:17:38.750
> 
> 标签：javascript, jquery

我有一个包含内容的#banner，基本上我想做的是显示一定数量的内容，然后有一个更多按钮，如果单击该按钮将显示其余内容。这反过来也会为#banner 的高度设置动画，我已将#banner 高度设置为 300px，但希望找到内容#inner 的高度并相应地对其进行动画处理。目前我有以下版本，但估计我使用了很多#ids / 来达到效果，有人能告诉我如何让它变得更好吗？

在这里小提琴：http: [//jsfiddle.net/43gTt/1/](http://jsfiddle.net/43gTt/1/)

谢谢凯尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:30:52.100

我建议您计算 div 的高度`inner`并使用它来制作动画。

```
var $tmpInner = inner.clone().appendTo('body');
var divHeight = $tmpInner.outerHeight();
$tmpInner.remove(); 
```

下面将根据 div 的内容计算 innerDiv 的高度。

此外，更新了横幅的 css 样式，`overflow:hidden`以便您不需要为横幅单独设置动画。

[**演示**](http://jsfiddle.net/skram/43gTt/24/)

**CSS：**

```
#banner{background:#dedede;overflow: hidden; }
#outer{margin:0 auto;width:200px;}
#middle{height:200px;overflow:hidden}
#inner{width:200px;margin:0 auto;}
.entry{display:none;} 
```

**JS：**

```
$(document).ready(function() {

    var outer = $('#outer'),
        middle = $('#middle'),
        inner = $('#inner'),
        /*innerH = inner.height(),*/
        banner = $('#banner'),
        more = $('#more');

    var $tmpInner = inner.clone().appendTo('body');
    var divHeight = $tmpInner.outerHeight();
    $tmpInner.remove();    

    // animate banner and #middle to reveal additional content
    more.on('click', function(e) {
        middle.animate({
            height: divHeight
        }, 300);

        /*banner.animate({
            height: innerH
        }, 300);*/
    });
}); 
```

**注意：**我不确定你为什么需要这么多包装器 div，但我认为这将是你的 HTML 的一部分。另外，我会将代码清理留给您。

# ruby-on-rails-3.1 - Rails 部分用于不同的控制器

> ID：10324625
> 
> 赞同：2
> 
> 时间：2012-04-25T22:18:25.977
> 
> 标签：ruby-on-rails-3.1

所以我有不同的控制器共享很多功能，我想知道是否有办法在它们之间共享类似的功能。

例如这个：

```
= link_to 'Edit', dvd_path(dvd), :class => 'btn' 
```

控制器之间唯一改变的是对象，而不是 dvd，它将是书籍或游戏。所以我认为必须有一种方法来创建一个使用该控制器正确路径的部分，而不必重写每个部分。并且无需发送对象。

想法受到赞赏。

**编辑**

@defaye：我想做的是重用上面的代码并将其应用于 7 个左右不同的控制器。上面的代码只是一堆始终相同的链接和路径的示例，唯一改变的是 dvd_path(dvd) 变为 book_path(book) 等。

我想要最简单，更直接的方法。

**事实上，我现在想知道是否有可能拥有处理多个控制器的相同视图，因为它们非常相似。这太棒了！**

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T10:00:05.487

如果您的代码只是几个方法，则根本不需要部分方法。助手可以帮助你。

这是一个例子。您可以在 ApplicationHelper 中定义它。

```
# application_helper.rb
def link_to_edit(object)
  link_to('Edit', polymorphic_path(object, :action => 'edit'), :class => 'btn')
end 
```

在你看来

```
= link_to_edit(object) 
```

# asp.net - 来自 ADFS 服务器的 URL 重定向

> ID：10324627
> 
> 赞同：12
> 
> 时间：2012-04-25T22:18:36.513
> 
> 标签：asp.net, authentication, redirect, wif, adfs

我在我的 ASP.net Web 应用程序中使用 ADFS 进行身份验证。STS 服务器将浏览器重定向到[https://test.contoso.com](https://test.contoso.com)。首先将客户端重定向到 STS 时，STS 不允许任何返回 URL 参数。

是否可以将浏览器从[https://test.contoso.com](https://test.contoso.com)（从 STS 重定向后）重定向到任何其他 URL，例如[https://variableName.test1.contoso2.com](https://variableName.test1.contoso2.com)？

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-27T17:48:37.207

身份验证后，默认情况下 ADFS 应将用户重定向到依赖方应用程序领域。听起来这是您已经拥有的，但您希望能够重定向到不同的 RP URL。

假设您有一个 RP，在 ADFS 中配置了领域[http://myrprealm.com 。](http://myrprealm.com)用户浏览到[http://myrprealm.com/Contacts.aspx](http://myrprealm.com/Contacts.aspx)。WIF FederatedAuthenticationModule (FAM) 发现用户未通过身份验证，因此它将相对 URL“/Contacts.aspx”保存在名为 ru 的返回 URL 参数中。此 ru 被打包在 WS-Federation Passive 上下文参数 (wctx) 中。FAM 然后将用户重定向到 ADFS 进行身份验证。ADFS 将保留 wctx 参数，并在成功验证后将其回显到 RP ( [http://myrprealm.com )。](http://myrprealm.com)现在 FAM 处理此 ADFS 响应。当 FAM 打开 wctx 时，它注意到 ru=/Contacts.aspx，所以在建立会话后，它会将用户重定向到 Contacts.aspx。

如果您使用 SDK（Visual Studio > 添加 STS 参考）将 WIF 合并到您的 ASP.NET 站点中，则默认情况下您将具有此行为。

# asp.net - 在客户端更改的asp.net标签文本在Web服务器端不可用

> ID：10324631
> 
> 赞同：1
> 
> 时间：2012-04-25T22:18:50.273
> 
> 标签：asp.net, state

我正在客户端使用 jquery 更改 asp.net 标签控件的文本。但是当我在网络服务器（C# 代码）上阅读它时，它会显示在 UI（aspx）中设置的值。标签文本不是控件状态的一部分吗？

有没有办法强制标签成为控件状态的一部分（视图状态包含其他控件的值，如文本框）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:27:41.603

**标签不会将其值发布回网络服务器。标签基本上是跨度或标签标签。**

您必须将更改存储在隐藏的文本框中以及标签中

或者

使文本框在样式中显示为标签，以便返回值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:23:29.397

您是否为此控件尝试过 EnableViewState = true ？

此外 - IMO - 标签值不是已发布表单集合项目的一部分。

为什么不在包含标签更改文本的表单上放置一个隐藏字段，然后在服务器端读取它？

# android - Android - 从另一个类设置 ImageView 内容

> ID：10324633
> 
> 赞同：0
> 
> 时间：2012-04-25T22:19:12.857
> 
> 标签：android, class, imageview

事情是这样的：我有两个类：Main 和 control.java Main 类是一个 Activity 类，我在其中构建我的应用程序，而控件类仅用于我必须从其他类访问的变量控件。

问题是：在 Main 类中我有 2 个方法，每个方法都有一个 ImageView，我需要在第一个方法的单击侦听器上设置第二个方法的图像视图资源。像这样：

```
public void first() {
    final ImageView first = (ImageView) findViewById(R.id.myview);
    first.setBackgroundResource(R.drawable.myimage);
}

public void second() {
    final ImageView second = (ImageView) findViewById(R.id.myview2);
    //And then, I want something like this: first.setBackgroundResource(first);
} 
```

多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:26:31.010

我承认对你的问题有点困惑，但我认为下面至少是你正在寻找的开始

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    control.setImageView((ImageView) findViewById(R.id.myview));
    second = (ImageView) findViewById(R.id.myview2);
}
public void first() {

    control.getImageView().setBackgroundResource(R.drawable.myimage);
}

public void second() {
    second.setBackgroundDrawable(control.getImageView().getDrawable());
}

ImageView second; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:27:00.200

你为什么不做类似的事情：

```
公共无效第二（）{
    final ImageView second = (ImageView) findViewById(R.id.myview2);
    最终 ImageView first = (ImageView) findViewById(R.id.myview);
    first.setBackgroundResource(R.drawable.myimage);
}

```

否则，您必须使用私有/公共类变量并在方法之外定义它。

# regex - 在 Excel VBA 中将正则表达式模式从 Sub 传递给函数

> ID：10324638
> 
> 赞同：4
> 
> 时间：2012-04-25T22:19:38.387
> 
> 标签：regex, function, vba, arguments

我正在尝试将正则表达式模式传递给 Excel VBA 中的函数，但该模式似乎无效。我已插入 msgbox'es 以查看字符串的外观，结果正常。这是我正在使用的代码。

```
Sub clean_COP_names()
Dim strSheet As String
Dim strPatternOrig As String

Dim strRow As Integer
Dim strCol As Integer
Dim UpBound As Range
Dim LowBound As Range

Dim strUpBoundRow As Integer
Dim strUpBoundColumn As Integer
Dim strLowBoundRow As Integer
Dim strLowBoundColumn As Integer
Dim CompareRange As Range

Dim c As Variant
Dim d As Integer
    Dim strTest As String
    strTest = ActiveCell.Value

    strSheet = "Sheet2"

    strRow = 2
    strCol = 2
    strUpBoundRow = 0
    strUpBoundColumn = 0
    strLowBoundRow = 0
    strLowBoundColumn = 0

    '/////call ext function
    SelectColumn strSheet, strRow, strCol, strUpBoundRow, strUpBoundColumn, strLowBoundRow, strLowBoundColumn

    Set CompareRange = Worksheets(strSheet).Range _
(Cells(strUpBoundRow, strUpBoundColumn), Cells(strLowBoundRow, strLowBoundColumn))

    d = 1
    Cells(d, 6).Value = "Alumni Officer - Last,First names"
    strPatternOrig = """^([^ ]+)([ ]+)([^ ]+)([ ]+)([^ ]+)(.*)$"""
    'MsgBox (strPatternOrig)
    For Each c In CompareRange
    d = d + 1
        '/////ext function
        Cells(d, 6).Value = Reorder_Name_COP_Data_a(c.Value, strPatternOrig, "$3,$1")
    Next
End Sub

Function Reorder_Name_COP_Data_a(strData As String, strPattern As String, strReplacementPattern As String) As String

Dim RE As Object

Set RE = CreateObject("vbscript.regexp")
With RE
    .MultiLine = False
    '.Global = False
    .Global = True
    .IgnoreCase = True
    'MsgBox (strPattern)

    .Pattern = strPattern
End With

Reorder_Name_COP_Data_a = RE.Replace(strData, strReplacementPattern)

End Function 
```

===================

附录 2012 年 4 月 26 日 非常感谢-

我注意到当我使用如下转义引号时问题仍然存在：

```
 strPatternOrig = "^[ ]?([^\ ,()""'']+)(?:[ ](\(([^)]*?)\)))?[ ]((?:(([^\ ,()""''])[^\ ,()""'']*)[ ])([^\ ,()""'']+(?:[ ][^\ ,()""'']+)*))(?: [ ]? , [ ]?(.*?))?[ ]?(\(\s*'*\d*\s*\))[ ]?$" 
```

双引号和单引号是否需要以不同的方式转义，可能吗？当正则表达式模式“硬连线”到函数中时，上述方法有效，但是当它传递给函数时，它失败了。再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:22:49.593

您不需要转义单引号，只需转义双引号。一旦变量被分配了一个字符串常量，它就可以自由地传递并且不会改变。

大正则表达式唯一真正的问题是它不匹配，因为您在其中留下了一些“空气”。
这就是你所拥有的：

```
"^[ ]?([^\ ,()""'']+)(?:[ ](\(([^)]*?)\)))?[ ]((?:(([^\ ,()""''])[^\ ,()""'']*)[ ])([^\ ,()""'']+(?:[ ][^\ ,()""'']+)*))(?: [ ]? , [ ]?(.*?))?[ ]?(\(\s*'*\d*\s*\))[ ]?$" 
```

这应该是：

```
"^[ ]?([^\ ,()""']+)(?:[ ](\(([^)]*?)\)))?[ ]((?:(([^\ ,()""'])[^\ ,()""']*)[ ])([^\ ,()""']+(?:[ ][^\ ,()""']+)*))(?:[ ]?,[ ]?(.*?))?[ ]?(\(\s*'*\d*\s*\))[ ]?$" 
```

这是您的正则表达式的测试用例（如果我记得的话，它只匹配最后一个形式）：

```
Dim RXE As Object
Dim RXNorm As Object

Sub RegexColumnValueComparison()
  Dim strData As String
  Dim strPat As String
  Call InitializeRXs

   ' Here, the grad part ('#) is optional
   strPat = "^[ ]?([^\ ,()""']+)(?:[ ](\(([^)]*?)\)))?[ ]((?:(([^\ ,()""'])[^\ ,()""']*)[ ])([^\ ,()""']+(?:[ ][^\ ,()""']+)*))(?:[ ]?,[ ]?(.*?))?[ ]?(?:(\(\s*'*\d*\s*\))[ ]?)?$"
   ' Here, the grad part ('#) is required
   'strPat = "^[ ]?([^\ ,()""']+)(?:[ ](\(([^)]*?)\)))?[ ]((?:(([^\ ,()""'])[^\ ,()""']*)[ ])([^\ ,()""']+(?:[ ][^\ ,()""']+)*))(?:[ ]?,[ ]?(.*?))?[ ]?(\(\s*'*\d*\s*\))[ ]?)$"

   strData = " John   Bert Smith, Jr  ('78) "
   MsgBox (RxRepl(strData, strPat, "$7 $8 , $1 $3 $6 $9"))
End Sub

Function RxRepl(sData As String, sPat As String, sRepl As String) As String
   sData = RXNorm.Replace(sData, " ")
   RXE.Pattern = sPat
     ' Can test for pass/fail ..
     'If RXE.Test(sData) Then
     '   MsgBox ("matched pattern")
     'Else
     '   MsgBox ("did NOT match pattern")
     'End If
   RxRepl = RXE.Replace(sData, sRepl)
End Function

Sub InitializeRXs()
  Set RXE = CreateObject("vbscript.regexp")
  Set RXNorm = CreateObject("vbscript.regexp")
  RXE.Global = True
  RXNorm.Global = True
  RXNorm.Pattern = "\s+"
End Sub 
```

# spring - 为什么在 @Transactional 块内没有调用 AbstractRoutingDataSource.determineCurrentLookupKey()？

> ID：10324644
> 
> 赞同：2
> 
> 时间：2012-04-25T22:20:15.127
> 
> 标签：spring, hibernate, transactions

我正在使用带有 Spring 的 Hibernate，相关配置：

```
<bean id="transactionManager"
        class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
</bean>

<bean id="openSessionInViewInterceptor"  class="org.springframework.orm.hibernate3.support.OpenSessionInViewInterceptor">
    <property name="sessionFactory"><ref bean="sessionFactory" /></property>
</bean>

<tx:annotation-driven  />
<aop:aspectj-autoproxy /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T18:47:18.937

想一想...

1.  一些代码想要`Connection`从 a 中获取 a `DataSource`。可能是为了启动事务并运行一些 SQL 查询

2.  `AbstractRoutingDataSource`执行`determineCurrentLookupKey()`以便`DataSource`从一组可用的中找到合适的

3.  查找键用于获取*当前* `DataSource`. `AbstractRoutingDataSource`从该数据源返回 JDBC 连接。

4.  连接是从返回的，`AbstractRoutingDataSource`就好像它是一个正常的源一样。

现在你问为什么`determineCurrentLookupKey()`不在事务中运行？第一个 Spring 必须转到第 1 点，以获取启动事务所需的一些数据库连接。看下一点。看到问题了吗？对我来说闻起来像无限递归。

简单地说 -`determineCurrentLookupKey()`不能在事务中运行，因为事务需要连接，并且该方法的目的是确定`DataSource`使用哪个来获取连接。另见：[*鸡或蛋*](http://en.wikipedia.org/wiki/Chicken_or_the_egg)。

同样，工程师们也无法使用计算机来设计第一台计算机。

# git - 全球 gitignore 被，嗯，被忽略了

> ID：10324649
> 
> 赞同：1
> 
> 时间：2012-04-25T22:20:41.107
> 
> 标签：git, github, gitignore

我在我的 Windows 机器上运行 xampp。我在 c:/xampp/htdocs 上本地运行了大量 git 存储库，并希望添加一个全局忽略以忽略所有这些存储库的应用程序/配置文件夹中的数据库配置文件。

我在 htdocs 文件夹中创建了 .gitignore_global 并在 htdocs 文件夹中运行`git config --global core.excludesfile .gitignore_global`，然后导航到我的一个存储库并运行`git rm --cached application/config/database.php`，然后添加、提交和推送。该文件已在 github 上删除，很好，但是当我修改 database.php 并运行`git status`它时，它会显示该文件，等待添加....我研究过这个并尝试了很多东西，但看不到我的'我做错了......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:54:19.600

`.gitignore_global`您必须指定in的绝对路径`git config --global core.excludesfile`，因为它由您机器上的所有存储库共享，git 必须知道它在哪里！

# java - Java，在使用窗口边框调整小程序大小之前，不会显示绘制的 drawRect

> ID：10324651
> 
> 赞同：1
> 
> 时间：2012-04-25T22:20:51.590
> 
> 标签：java, applet, resize, paint

我搜索了线程并尝试了所有解决方案，但将 drawRect 放入面板中。这是最好的解决方案还是我错过了一些简单的东西？我使用了 set visible 但我不认为这是必要的，我也尝试过重新绘制。

```
import java.applet.*;
import java.awt.*;
import java.awt.event.*;

public class HW5_drawRec extends Applet implements ActionListener

 {
   int width, height;
  int y = 150;
  int x = 75;

 //construct Components
Label appletLabel = new Label("Homework 5, Draw a Rectangle");
Label widthLabel = new Label("Enter the desired width:");
TextField widthField = new TextField(10);
Label heightLabel = new Label("Enter the desired height:");
    TextField heightField = new TextField(10);
 Button drawButton = new Button("Draw");
 Label outputLabel = new Label("Click to draw the rectangle.");

 public void init(){
    setForeground(Color.gray);
    add(appletLabel);
    add(widthLabel);
    add(widthField);
    add(heightLabel);
    add(heightField);
    add(drawButton);
    drawButton.addActionListener(this);
    add(outputLabel);
 }

 public void actionPerformed(ActionEvent e){

    width = Integer.parseInt(widthField.getText());
    height = Integer.parseInt(heightField.getText());

}

  public void paint(Graphics g){

if (width  >= 401){
    if (height >= 401){
    g.drawString("Please input dimensions greater than zero and/or less than 400",x,y);
  }}else{
     g.setColor(Color.RED);
     g.fillRect(x,y,width,height);
     g.setColor(Color.BLACK);
     g.drawRect(x,y,width,height);
     setVisible(true);

  }
}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:18:34.773

放在`repaint()`actionPerformed 事件的末尾。

# url-routing - 如何确定 ember-routemanager 中的下一个状态？

> ID：10324653
> 
> 赞同：0
> 
> 时间：2012-04-25T22:20:56.340
> 
> 标签：url-routing, ember.js

如果我有一个像这样有 3 个状态的路由管理器

```
App.routeManager = Ember.RouteManager.create({
rootElement: '#tabContent',
initialState: 'test1',

test1: Ember.ViewState.create({
    route: 'test1',
    view: Ember.View.extend({
        defaultTemplate: Ember.Handlebars.compile('test1')
    })
}),

test2: Ember.ViewState.create({
    route: 'test2',
    view: Ember.View.extend({
        defaultTemplate: Ember.Handlebars.compile('test2')
    })
}),

test3: Ember.ViewState.create({
    route: 'test3',
    enter: function (manager, transition) {
        var careView;
        require(['require', 'test3'], function (require) {
            test3View= require('test3');                 
        });
        this.set('view', test3View);
    },
    exit: function(){
        this._super();
    }
}); 
```

我如何确定它在退出事件中的下一个状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T05:45:51.443

您可以按照这些方法做一些事情，请参阅[http://jsfiddle.net/pangratz666/zxLkt/](http://jsfiddle.net/pangratz666/zxLkt/)：

```
exit: function(manager, transition){
    var route = manager.get('location');
    var params = manager.get('params');
    var state = manager.getState(route, params);

    console.log(route, params, state);
} 
```

* * *

你想用它做什么？你这样做的目的是什么？

# mercurial - Mercurial - 与非头部修订合并

> ID：10324657
> 
> 赞同：0
> 
> 时间：2012-04-25T22:21:24.457
> 
> 标签：mercurial, branch, bookmarks

我正在处理一个项目，当我准备`0.1.0`发布时，我创建了一个名为 的书签`release`，将该修订标记为`0.1.0`，然后使该书签处于非活动状态并继续处理我的项目。

修订看起来像这样（从最新到最旧）：

*   `Tip`（`hg update default`去这里）
*   *更多修改*
*   带书签的修订（`hg update release`在这里）
*   *更多修改*

我的意图是在新版本准备好时`hg update release`执行`hg merge default`。`hg tag <version>`但是，这会产生以下错误：

> 中止：没有可合并的内容（使用“hg update”或检查“hg head”）

我显然只有一个头，我不确定`hg update`会做什么。`hg update release`当我处于提示状态时，*确实会*更新到正确的修订版。考虑到我当前的情况并且仍然使用书签（没有命名分支），有没有办法将指向的修订`release`与提示合并（从而创建一个新头）？我最初的想法是对 做一个小改动`release`，提交它以创建一个新的头部，然后合并；但是，我宁愿在尝试之前确定自己在做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:41:59.480

只有当您有多个头时才需要合并，即非线性历史。

但是，我不确定您的工作流程是否比应有的复杂。请记住，您**不必**为了标记它而强制更新到特定版本。请参阅[命令的](http://selenic.com/hg/help/tag)[帮助`tag`](http://selenic.com/hg/help/tag)。

# grails - grails “test-app” 功能性 geb+spock 测试失败，但 “test-app -functional” 成功

> ID：10324664
> 
> 赞同：1
> 
> 时间：2012-04-25T22:21:53.260
> 
> 标签：grails, spock, geb

我在使用 GEB+Spock 在 Grails 中进行功能测试时遇到了一些问题。如果我运行“test-app”它总是失败，但如果我在“test-app”*之前*运行“test-app -integration ”它可以工作！

以下测试序列说明了我的问题：

运行#1

```
grails> clean
grails> test-app -functional
...
Tests PASSED 
```

运行#2

```
grails> clean
grails> test-app
...
Tests FAILED 
```

运行#3

```
grails> clean
grails> test-app -functional
...
Test PASSED
grails> test-app
...
Test PASSED 
```

失败的测试抛出“geb.waiting.WaitTimeoutException：条件在 10.0 秒内未通过”。值得注意的是，失败的测试用例正在等待数据库查询的结果。

***所以我的问题是，功能测试*通过“test-app -integration”与“test-app”运行到底有什么区别？**

与我认为的唯一区别是“test-app”正在运行所有测试阶段（单元、集成、功能）。

奇怪的是它*确实*以某种方式起作用，但前提是我首先运行“test-app -integration”：/

我使用以下设置：

*   圣杯 2.0.1

*   geb 0.7.0

*   斯波克 0.6

*   htmlunit-driver 2.0rc3（我用 2.20.0 试过，但给了我更多的问题）

真的希望有人可以帮助我。Geb+spock 似乎是一个不错的解决方案，*当*它起作用时......

问候托比

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T12:17:32.107

如果有兴趣，我设法解决了这个问题并在这里为其他人编写了解决方案。使用geb报告功能找到了解决方案（很棒的工具！）

问题是我在功能测试所针对的应用程序中大量使用 grails ZKUI，并且 zkui 在不同的测试场景中生成了不同的 html 代码（是的，这真的很奇怪）。

例如作曲家中的一个 zk 按钮：

```
<z:button id="simpleSearchButton" class="simpleSearchButton"/> 
```

运行“test-app -integration”时，它生成以下内容：

```
<span id="cECQ4" class="simpleSearchButton z-button"><table id="cECQ4-box" style=""     cellpadding="0" cellspacing="0" border="0"><tbody><tr><td class="z-button-tl"/><td class="z-button-tm"/><td class="z-button-tr"/></tr><tr><td class="z-button-cl"><button type="button" id="cECQ4-btn" class="z-button"/></td><td class="z-button-cm"><img src="/certservice-admin/images/search.png;jsessionid=2ADDD6FA5F1D011A96E447435514BDA2" align="absmiddle"/></td><td class="z-button-cr"><div></div></td></tr><tr><td class="z-button-bl"/>td class="z-button-bm"/><td class="z-button-br"/></tr></tbody></table></span> 
```

但是在运行“test-app”时，它生成了以下内容：

```
<button type="button" id="l9AP4" class="simpleSearchButton z-button-os"><img src="/certservice-admin/images/search.png;jsessionid=835A2B8A3FE0C54341BB4F109A0CCC62" align="absmiddle"/></button> 
```

在我的 Page 对象中，我将按钮定义为：

```
simpleSearchButton(required: false) { $("span.simpleSearchButton") } 
```

“test-app”失败，但“test-app -integration”失败。解决困难/奇怪问题的简单方法是：

```
simpleSearchButton(required: false) { $(".simpleSearchButton") } 
```

:)

干杯/托比

# html - 通过超链接传递参数

> ID：10324665
> 
> 赞同：0
> 
> 时间：2012-04-25T22:21:54.373
> 
> 标签：html, jsp, redirect, hyperlink

我有一个 Web 应用程序，其中包含一些超链接，这些超链接将用户重定向到另一个页面，其中包含一些信息作为参数。更具体地说，我的超链接包含 sql 查询作为参数。

我这样做是这样的：

```
<a href="somepage.jsp?query=<%=stringSQLQuery%>"></a> 
```

但是，每当我的 sql 查询将通配符作为搜索词（例如 %）时，我都会在日志文件中收到以下错误消息：

```
Character decoding failed. Parameter [string] with value ... 
```

差不多，我认为我不能通过带有通配符的超链接传递 SQL 查询。我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:25:08.623

你需要[对你的参数进行uri编码。](http://en.wikipedia.org/wiki/Percent-encoding)

我认为这就是你想要的：

```
<a onclick='window.href.location = encodeURI("somepage.jsp?query=<%=stringSQLQuery%>");'>Click me</a> 
```

看到[这个jsfiddle](http://jsfiddle.net/7F6f5/)

此外，像这样传递 SQL 是一个***坏坏坏主意***。任何人都可以访问您的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:34:43.090

URL 对允许的字符有限制。这`%`是一个保留字符，指示 URL 编码字符的开始。

请求参数必须是[URL 编码的](http://en.wikipedia.org/wiki/Percent-encoding)。[JSTL](https://stackoverflow.com/tags/jstl/info) 就是专为这项工作而设计`<c:url>`的。`<c:param>`

```
<c:url var="somepage" value="somepage.jsp">
    <c:param name="query" value="${stringSQLQuery}" />
</c:url>
<a href="${somepage}">link</a> 
```

正如大家所提到的，您在这里犯了一个巨大的设计错误，将 SQL 字符串作为请求参数传递。而是使用存储在某些`Map`或可能是 RESTful URL 中的固定命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-22T16:17:38.620

您可以使用超链接传递参数或值

例如：我有一页 display.html 并传递参数 a 和 b 并且分别有值 10 和 20。在锚标记中，我们将 href 如下。

```
 href="xyz.html?a=10&b=20" 
```

# iphone - 使用 Xcode 4.3.1 正确配置 SVN

> ID：10324666
> 
> 赞同：0
> 
> 时间：2012-04-25T22:21:57.443
> 
> 标签：iphone, ios, svn, configuration, xcode4.3

当我在 Xcode 4.3.1 中添加存储库时，我在名称字段中输入名称，然后从菜单中选择颠覆，然后在位置字段中（最初显示一个模板，我输入

svn://server.myhomedomain.net/aproject

立即弹出一个红色状态指示器以及无法访问的消息主机。

如果我输入服务器的 IP 地址，则不会显示红色状态，但是稍后，存储库无论如何都无法连接。但是，如果我尝试使用 google 的存储库，它可以正常工作：http: [//googledocs-cocoa-sample.googlecode.com/svn](http://googledocs-cocoa-sample.googlecode.com/svn)

我不明白发生了什么，我认为问题出在协议上，但我需要帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:49:41.927

尝试

```
**http**://server.myhomedomain.net/aproject 
```

或者

```
**svn+ssh**://username@server.myhomedomain.net/aproject 
```

# php - 如何在数组中返回表格 td 标签？

> ID：10324668
> 
> 赞同：1
> 
> 时间：2012-04-25T22:22:00.693
> 
> 标签：php, html, arrays

我在字符串中有一个这样的表：

```
<table>
    <tr class='test'>
        <td class='t' style='color: red'>
            aaaaa
        </td>
        <td class='t'>
            bbbbb
        </td>
    </tr>

    <tr>
        <td style='color: red'>
            ccccc
        </td>
        <td class='t'>
            ddddd
        </td>
    </tr>
</table> 
```

现在我如何将所有 td 内容放入 PHP 中的数组中？像这样：

```
array(
      arg[0] => 'aaaaa',
      arg[1] => 'bbbbb',
      arg[2] => 'ccccc',
      arg[3] => 'ddddd',
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:26:55.910

尝试使用[`DOMDocument`](http://php.net/manual/en/class.domdocument.php)解析 HTML，并获取元素。

```
$result = array();

$dom = new DOMDocument;
$dom->loadHTML($table);
$xPath = new DOMXPath($dom);

$td = $xPath->query('//table/tr/td');

foreach($td as $val){
    $result[] = $val->nodeValue;
}

print_r($result); 
```

演示：[http ://codepad.viper-7.com/wqIPbp](http://codepad.viper-7.com/wqIPbp)

# ios - 以明文形式发送用户名/密码是否安全？

> ID：10324669
> 
> 赞同：1
> 
> 时间：2012-04-25T22:22:06.677
> 
> 标签：ios, authentication, ssl, oauth

我的网站正在创建一个扩展其功能的应用程序 - 这意味着该应用程序不需要遵循严格的 OAuth 流程，因为我们显然相信自己。

我们希望应用程序的用户能够从应用程序中输入他们的用户名和密码……这意味着我们需要一种方法将该信息传输到网络服务器以验证它们。

假设我们使用 SSL，这是一个安全的想法吗？

我们是否需要采取额外的步骤，我们是否需要以某种方式确保请求来自我们的应用程序，而不是欺骗性的应用程序，或者其他什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:44:45.627

首先，相信自己是不够的。一旦你的用户掌握了你的应用程序，你将无法控制你的应用程序、使用它的设备或它连接到的网络。

如果您的应用程序中有一个公共共享密钥，只有您的服务器才能解密（正如评论中提到的那样），这种方案仍然可能会导致问题，因为掌握您的应用程序的用户可能会对其进行逆向工程并获得该密钥锁定其他用户的关键。

如果您没有使用单点登录 (SSO) 对您的网站进行身份验证，而是在表单中使用普通用户名和密码，那么通过 SSL/TLS 连接从您的应用程序传输与从浏览器传输没有什么不同（通过 HTTPS），前提是整体配置正确。无论如何，当您从浏览器发布表单时，就会发生这种情况。通过按照您的建议使用 SSL/TLS，您实际上并没有明文发送密码（只要配置正确）。

检查它是来自您的应用程序还是来自欺骗性应用程序是另一回事，通常很难防范。如果您的服务设计良好，那么当您已经拥有用户身份验证时，通常不值得。经过身份验证的用户应该只能执行您的服务器允许他们执行的操作，无论这些操作的请求来自您的应用程序还是这些用户控制的其他应用程序（只要服务器验证他们已正确验证）。（在这种情况下，如果用户被欺骗使用欺骗性应用程序，而不是服务本身，那么欺骗性应用程序往往会成为更大的问题。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:48:16.553

有几种可能的安全威胁，您可以决定是否要担心其中的任何一种：http: [//xkcd.com/538/](http://xkcd.com/538/)

但安全的原罪是“明文密码”。至少对它进行哈希处理，以便它不会以明文形式存储在服务器上。

# python - 在 Python 中解析 .pdb 文件

> ID：10324674
> 
> 赞同：5
> 
> 时间：2012-04-25T22:22:41.753
> 
> 标签：python

我正在尝试为 .pdb 文件编写一个快速解析器（它们显示蛋白质结构）。我正在研究的蛋白质的一个例子是 KRAS（在癌症中很常见），在这里：[http ://www.rcsb.org/pdb/files/3GFT.pdb](http://www.rcsb.org/pdb/files/3GFT.pdb)

如果您向下滚动足够远，您将看到如下所示的一行：ATOM 1 N MET A 1 63.645 97.355 31.526 1.00 33.80 N

第一个元素“原子”意味着这与蛋白质中的实际原子有关。1 与一般计数有关，N 与原子类型有关，“MET”是残基的名称，“A”与链的类型有关，1（第二个“1”）是原子数和那么接下来的 3 个数字是空间中的 xyz 位置。

我需要的输出是这样的（下面的“1”对应于原子计数，而不是一般计数）：MET A 1 63.645 97.355 31.526

更复杂的是，有时原子数（在这种情况下是第二个“1”）是负数。在这些情况下，我想跳过该行继续，直到我遇到一个积极的条目，因为这些元素与找到位置所需的生物化学有关，而不是实际的蛋白质。更糟糕的是，有时你会得到这样的一行：

ATOM 139 CA AILE A 21 63.260 111.496 12.203 0.50 12.87 C
ATOM 140 CA 胆汁 A 21 63.275 111.495 12.201 0.50 12.17 C

虽然他们都提到残基 21，但 biochem 不够精确，无法获得准确的位置，因此他们提供了两种选择。理想情况下，我会指定“1”、“2”或其他任何内容，但如果我只选择第一个选项就可以了。最后，对于原始示例中的原子类型（“N”），我只想获得带有“CA”的那些行。

我是 python 的新手，我的培训是生物统计学，所以我想知道最好的方法是什么？我是否使用 for 循环逐行解析？有没有办法在 python 中更快地做到这一点？如何处理某些原子的双重输入？

我意识到这有点问，但一些指导会很有帮助！我已经使用 R 编写了所有统计数据位，但现在我只需要以正确的格式获取我的文件！

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2020-05-06T15:50:00.267

没有人提到来自 BioPython 的[Bio.PDB](https://biopython.org/DIST/docs/api/Bio.PDB-module.html)包，我感到有点惊讶。自己编写 PDB 解析器是一个相当严重的不必要的重新发明案例，我的意思是重新实现轮子。

[BioPython](https://biopython.org)是一个有用的软件包集合，可用于处理其他类型的生物数据（例如蛋白质或核酸序列）。

我知道这是一个老问题，但也许有人仍然觉得这个指针很有帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-25T23:28:10.503

看起来解析 PDB 文件的库已经存在。查看：

[http://www.csb.pitt.edu/prody/index.html](http://www.csb.pitt.edu/prody/index.html)

简要浏览教程，似乎这就是您所说的不？

[http://www.csb.pitt.edu/prody/tutorial.html#atomic-data](http://www.csb.pitt.edu/prody/tutorial.html#atomic-data)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-25T23:34:39.347

这是一个很长的描述。我不确定我是否正确:-) 如果字段（以 ATOM 开头的行）是固定的，您可以使用拆分和一些comaprisons。我已经使用哈希来查看是否已经看到该条目以消除您想要的重复项。希望这会给你一个开始，

```
visited = {}
for line in open('3GFT.pdb'):
    list = line.split()
    id = list[0]
    if id == 'ATOM':
        type = list[2]
        if type == 'CA':
            residue = list[3]
            type_of_chain = list[4]
            atom_count = int(list[5])
            position = list[6:8]
            if atom_count >= 0:
                if type_of_chain not in visited:
                    visited[type_of_chain] = 1
                    print residue,type_of_chain,atom_count,' '.join(position) 
```

会输出，

```
MET A 1 62.935 97.579
GLY B 0 39.524 105.916
GLY C 0 67.295 110.376
MET D 1 59.311 124.106
GLY E 0 44.038 96.819
GLY F 0 44.187 123.590 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-08-11T10:49:46.287

对于`pdb`具有大量原子的大文件，字段之间没有空白，因此您不能使用该`split`命令。相反，您可以使用蛋白质数据库格式定义来解析`pdb`文件：

```
with open('min.pdb') as pdbfile:
    for line in pdbfile:
        if line[:4] == 'ATOM' or line[:6] == "HETATM":
            print line
            # Split the line
            splitted_line = [line[:6], line[6:11], line[12:16], line[17:20], line[21], line[22:26], line[30:38], line[38:46], line[46:54]]
            print splitted_line
            # To format again the pdb file with the fields extracted
            print "%-6s%5s %4s %3s %s%4s    %8s%8s%8s\n"%tuple(splitted_line) 
```

下面是一个示例输出：

```
# Original line:
HETATM10000  O   HOH B3257       2.509  40.006  -4.097  1.00  0.00           O

# Fields extracted:
['HETATM', '10000', ' O  ', 'HOH', 'B', '3257', '   2.509', '  40.006', '  -4.097']

# Reformatted line:
HETATM10000  O   HOH B3257       2.509  40.006  -4.097 
```

# c - AWS lib3s C/C++ 库示例代码/教程

> ID：10324678
> 
> 赞同：6
> 
> 时间：2012-04-25T22:23:20.887
> 
> 标签：c, api, callback, amazon-s3, amazon-web-services

我已经下载并查看了[libs3](http://aws.amazon.com/developertools/Amazon-S3/1648)的代码，这是一个为 C/C++ 编写的与 Amazon S3 交互的库。这个库使用了一些我不太熟悉的概念，所以我很好奇人们是否知道任何使用这个库的教程或示例程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-23T21:10:15.640

给[http://ceph.com/docs/master/radosgw/s3/cpp/](http://ceph.com/docs/master/radosgw/s3/cpp/)读一读；那里有几个例子。此外，源代码有一些很好的示例，例如[https://github.com/ceph/libs3/blob/master/src/s3.c#L1396](https://github.com/ceph/libs3/blob/master/src/s3.c#L1396)，这是 putObject 的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T00:27:55.403

我找到合理示例的唯一地方是检查 libs3 的头文件，并查看现在包含在库中的 s3.c 应用程序的源代码。

# vb.net - VB.NET：SelectedIndexChanged 多次触发

> ID：10324679
> 
> 赞同：2
> 
> 时间：2012-04-25T22:23:21.277
> 
> 标签：vb.net, events, event-handling, controls, selectedindexchanged

我正在尝试以编程方式将未指定数量的新用户控件添加到表单中。每次在包含在 UserControl 中的 ComboBox 中选择一个条目时，都会添加一个。

问题是，SelectedIndexChanged 事件完全不规律地触发。有时是两次，有时是 3 次，等等，但绝不是一次。无论我将组合框的 SelectedIndex 设置为 -1 多少次，它都会至少触发一次，且 SelectedIndex 为 0。有时 Itemselected 事件会在 SelectedIndexChanged 事件之间触发多次。

InvoiceEntry.vb 片段：

```
Public Event ItemSelected As EventHandler
Private Sub cboItem_SelectedIndexChanged(sender As System.Object, _
            e As System.EventArgs) Handles cboItem.SelectedIndexChanged
    RaiseEvent ItemSelected(Me, EventArgs.Empty)
End Sub 
```

发票.vb 片段：

```
Private numEntries As Integer = 1

Public Sub invEntry1_ItemSelected() Handles invEntry1.ItemSelected
    numEntries += 1

    Dim newEntry As InvoiceEntry = invEntry1
    Dim pt As Point = newEntry.Location
    pt.Y += 30

    newEntry.Location = pt
    newEntry.Name = "invEntry" + numEntries.ToString

    pnlEntries.Controls.Add(newEntry) 
```

结束子

我完全不知道出了什么问题。如果您需要更多信息，请告诉我，因为我将监控此线程，直到我或其他人弄清楚为止。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T12:22:47.230

据我所知，当您添加新组合框时，所选索引此时正在发生变化（这是它第一次触发的时候）。每次您以编程方式更改值时，它也会触发。

如果您想在用户从组合框中选择某些内容后生成控件，请尝试使用

```
ComboBox.SelectionChangeCommitted 
```

[http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectionchangecommitted.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectionchangecommitted.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-30T15:01:52.330

与 listview 我有同样的问题。我用这个：

```
if (listview.SelectedItems.Count > 0)
{
   //do something...
} 
```

# javascript - HTML5 - drawImage 没有在其他图层上绘制

> ID：10324686
> 
> 赞同：0
> 
> 时间：2012-04-25T22:24:12.807
> 
> 标签：javascript, html

我正在`drawImage`尝试绘制瓷砖和玩家。它可以工作，但是它首先绘制玩家*然后*绘制瓷砖。这应该是相反的，因为现在我看不到我的播放器。

我怎么知道我的球员被抽中了？因为如果我取出绘制瓷砖的东西（`if (loadedImagesCount==NUM_OF_TILES) draw();`），那么我可以看到我的玩家。此外，总是会弹出提示玩家已被绘制的消息。

帮助？

这是我的代码：

```
// HTML5 JS Tile Example
var canvas, context, board, imageObj, tiles;
var currentMap = 1;
var upMap = 0;
var rightMap = 0;
var leftMap = 0;
var downMap = 3;
var NUM_OF_TILES = 16; // starting from ZERO

    var spawnX = 9; // spawn on X position
    var spawnY = 7; // spawn on Y position
    var playerImg = new Image();
    var currX = 9; // current X position
    var currY = 7; // current Y position

// Set return 2D array of map
function loadMap(map) {
    if (map == 1) {
        return [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1], [1, 13, 1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1], [1, 13, 1, 13, 1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1], [1, 13, 1, 13, 1, 13, 1, 13, 13, 13, 13, 13, 1, 13, 13, 1], [1, 13, 13, 13, 1, 13, 1, 13, 1, 13, 13, 13, 1, 13, 13, 1], [1, 13, 13, 13, 13, 13, 1, 13, 1, 13, 1, 13, 1, 13, 13, 1], [1, 13, 13, 13, 13, 13, 13, 13, 1, 13, 1, 13, 13, 13, 13, 1], [1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1, 13, 13, 13, 13, 1], [1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 13, 1, 1, 1, 1, 1, 1]
        ];
    }
}

var drawPlayer = function() {           
        realSpawnX = spawnX * 32;
        realSpawnY = spawnY * 32;
        playerImg.src = "me.gif";
        context.drawImage(playerImg, realSpawnX, realSpawnY, 32, 32);
        console.log("Player drawn at (" + spawnX + "," + spawnY + ") Real spawn: X: " + realSpawnX + " Y: " + realSpawnY);
}

window.onload = function () {
    canvas = document.getElementById("canvas");
    context = canvas.getContext("2d");
    imageObj = new Image();
    tiles = [];
    board = loadMap(1);

    canvas.width = 512;
    canvas.height = 352;

    // Draw the player .,.. now
    drawPlayer();

    var draw = function() {
        var theX;
        var theY;
        // 3\. DRAW MAP BY ROWS AND COLS
        for (x = 0; x <= 10; x++) {
            for (y = 0; y <= 15; y++) {

                theX = x * 32;
                theY = y * 32;
                context.drawImage(tiles[board[x][y]], theY, theX, 32, 32);
            }
        }
    } 

    var loadedImagesCount = 0;

    // 2\. SET UP THE MAP TILES

    for (x = 0; x <= NUM_OF_TILES; x++) {
        var imageObj = new Image(); // new instance for each image
        imageObj.src = "line_tile/t" + x + ".png";
        imageObj.onload = function() {
            loadedImagesCount++;
            if (loadedImagesCount==NUM_OF_TILES) draw();
        };
        tiles.push(imageObj);
    }

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:14:25.720

这就是我的意思，我所做的更改应该很明显：

```
// HTML5 JS Tile Example
var canvas, context, board, imageObj, tiles;
var currentMap = 1;
var upMap = 0;
var rightMap = 0;
var leftMap = 0;
var downMap = 3;
var NUM_OF_TILES = 16; // starting from ZERO

    var spawnX = 9; // spawn on X position
    var spawnY = 7; // spawn on Y position
    var playerImg = new Image();
    var currX = 9; // current X position
    var currY = 7; // current Y position

// Set return 2D array of map
function loadMap(map) {
    if (map == 1) {
        return [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1], [1, 13, 1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1], [1, 13, 1, 13, 1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1], [1, 13, 1, 13, 1, 13, 1, 13, 13, 13, 13, 13, 1, 13, 13, 1], [1, 13, 13, 13, 1, 13, 1, 13, 1, 13, 13, 13, 1, 13, 13, 1], [1, 13, 13, 13, 13, 13, 1, 13, 1, 13, 1, 13, 1, 13, 13, 1], [1, 13, 13, 13, 13, 13, 13, 13, 1, 13, 1, 13, 13, 13, 13, 1], [1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1, 13, 13, 13, 13, 1], [1, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 13, 1, 1, 1, 1, 1, 1]
        ];
    }
}

var drawPlayer = function() {           
        realSpawnX = spawnX * 32;
        realSpawnY = spawnY * 32;
        playerImg.src = "me.gif";
        context.drawImage(playerImg, realSpawnX, realSpawnY, 32, 32);
        console.log("Player drawn at (" + spawnX + "," + spawnY + ") Real spawn: X: " + realSpawnX + " Y: " + realSpawnY);
}

window.onload = function () {
    canvas = document.getElementById("canvas");
    context = canvas.getContext("2d");
    imageObj = new Image();
    tiles = [];
    board = loadMap(1);

    canvas.width = 512;
    canvas.height = 352;

    // Draw the player .,.. now
    //*************No, later

    var draw = function() {
        var theX;
        var theY;
        // 3\. DRAW MAP BY ROWS AND COLS
        for (x = 0; x <= 10; x++) {
            for (y = 0; y <= 15; y++) {

                theX = x * 32;
                theY = y * 32;
                context.drawImage(tiles[board[x][y]], theY, theX, 32, 32);
            }
        }
    } 

    var loadedImagesCount = 0;

    // 2\. SET UP THE MAP TILES

    for (x = 0; x <= NUM_OF_TILES; x++) {
        var imageObj = new Image(); // new instance for each image
        imageObj.src = "line_tile/t" + x + ".png";
        imageObj.onload = function() {
            loadedImagesCount++;
            if (loadedImagesCount==NUM_OF_TILES) {
                draw();
                drawPlayer();
            }
        };
        tiles.push(imageObj);
    }
}; 
```

问题是在一个`onload`事件中绘制了图块 - 当浏览器完成从网络获取图像时执行。所以无论你把调用放在哪里，`drawPlayer`如果加载它们最后绘制的所有平铺图像需要超过一毫秒左右的时间。解决方案是扩展`onload`处理程序中的代码块，以查看是否加载了所有图像（此位：）`if (loadedImagesCount==NUM_OF_TILES)`，以便您可以按顺序绘制地图和播放器。

# php - 在文件中查找最小/最大/平均值的快速方法

> ID：10324688
> 
> 赞同：1
> 
> 时间：2012-04-25T22:24:28.343
> 
> 标签：php

我有一个格式的文件

```
1    52
2    456
3    4516
5    4545
6     41 
```

什么是读取文件并在 PHP 的第二列中获取 min/max/avg 值的最快方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:29:30.227

类似于以下内容，`<filename>`文件的路径在哪里。

```
$file = fopen('<filename>', 'r');

$a = 0;
$b = 0;
$first = true;
while (fscanf($file, '%d%d', $a, $b)) {
    if ($first)
    {
        $min = $b;
        $max = $b;
        $total = $b;
        $count = 1;
        $first = false;
    }
    else
    {
        $total += $b;
        if ($b < $min) $min = $b;
        if ($b > $max) $max = $b;
        $count++;
    }
}
$avg = $total / $count; 
```

演示：http: [//ideone.com/rWbqm](http://ideone.com/rWbqm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T04:37:52.083

从@mellamokb 代码进行了一些性能改进：

```
$file = fopen('<filename>', 'r'); 

$a = $b = 0; 
if (fscanf($file, '%d%d', $a, $b))
{
   $min = $max = $total = $b; 
   $count = 1;
   while (fscanf($file, '%d%d', $a, $b))
   { 
      $total += $b; 
      if ($b < $min) $min = $b; 
      else if ($b > $max) $max = $b; 
      ++$count; 
   } 
   $avg = $total / $count;
}
else
{
   // Do something here as there is nothing in the file
} 
```

# html - CSS 搜索框不会向左浮动

> ID：10324689
> 
> 赞同：0
> 
> 时间：2012-04-25T22:24:31.550
> 
> 标签：html, css, shopify, search-box

我有这个

```
 <td width="312" valign="center" height="157" background="{{ 'BT_S3.png' | asset_url }}">
             <div style="width:95%; text-align: left; height:52px; background-image:url('{{ 'search_bar.png' | asset_url }}');" float="left">
            <form action="/search" method="get">
            <input type="text" name="q" src="{{ 'search_bar.png' | asset_url }}" />
            <input type="image" value="Search"  src="{{ 'search_button.png' | asset_url }}"  />
            </form>
            </div>
            </td> 
```

这是我的搜索框的 HTML，位于 [http://clarkbetty.myshopify.com/#](http://clarkbetty.myshopify.com/#) 密码： betweu

我希望搜索按钮浮动，以便搜索框和按钮位于同一行。我尝试了很多东西，但没有任何效果。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:29:07.617

您应该添加`style="float:left"`到文本框和按钮元素。

```
<input type="text" [...] style="float:left" />
<input type="image" [...] style="float:left" /> 
```

另请注意，最好将这些规则放入 css 文件中，并通过它们的 id 或类来引用这些元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:28:41.920

另一种方法是将相对定位应用于包装`form`元素，并在内部控件（搜索字段和按钮输入）上使用绝对定位来控制其内部布局。

这些方面的东西：

```
form {
    position: relative;
}
input[type='text'],
input[type='image'] {
    position: absolute;
    top: 0;
}
input[type='text'] {
    left: 0;
    width: 100%;
    padding-right: 20px;
}
input[type='image'] {
    right: 0;
    width: 20px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:30:41.063

更改此行：

```
<input type="text" name="q" src="{{ 'search_bar.png' | asset_url }}" /> 
```

对此：

```
<input type="text" style="float:left;" name="q" src="{{ 'search_bar.png' | asset_url }}" /> 
```

float:left 必须在 style 属性内。

# php - 使用 simplexml_load_file 从 XML 提要中提取数据

> ID：10324690
> 
> 赞同：2
> 
> 时间：2012-04-25T22:24:36.237
> 
> 标签：php, xml, api, rss, simplexml

我正在尝试使用 simplexml_load_file 从 XML 提要中提取数据。这就是我现在所拥有的：

```
 <?php 
        $anobii = simplexml_load_file('http://www.anobii.com/rss_shelf?s=01fe251a6c442bbf8a');
        foreach ($anobii->entry as $anobiiinfo):
            $title=$anobiiinfo->rss->channel->item->title;
            $desc=$anobiiinfo->rss->channel->item->description;       
            echo "<span> ",$title,"</span><br><span> ",$desc,"</span>";
        endforeach;
    ?> 
```

问题是我不知道正确的分隔符来告诉脚本它需要提取的部分（`rss->channel->item->title`）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:40:57.767

您应该遵循 xml 树结构来获取各个项目。

```
<?php 
        $feedUrl = 'http://www.anobii.com/rss_shelf?s=01fe251a6c442bbf8a';
        $rawFeed = file_get_contents($feedUrl);
        $anobii = new SimpleXmlElement($rawFeed);

        foreach ($anobii->channel->item as $anobiiinfo):
            $title=$anobiiinfo->title;
            $desc=$anobiiinfo->description;       
            echo "<span> ",$title,"</span> <br/> <span> ",$desc,"</span>";
        endforeach;
    ?> 
```

# assembly - 将地址存储在 MIPS 的寄存器中

> ID：10324691
> 
> 赞同：6
> 
> 时间：2012-04-25T22:24:37.477
> 
> 标签：assembly, mips

我已经分配了一定数量的内存，并希望将此内存的位置分配给我在程序的 .data 部分中声明的变量。我知道如何将内存位置分配给变量，但是一旦我这样做了，我如何使用该变量来访问分配的内存？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T22:47:14.003

如果我正确理解您的问题，您将需要使用`la`（加载地址）指令将地址放入寄存器。然后，您将使用`lw`（加载字）和`sw`（存储字）指令来操作数据。例如，考虑以下代码

```
.data
tmpval: .word 5

__start:
  sub $sp, $sp, 12
  sw  $ra, 0($sp) # Return addy
  sw  $t0, 4($sp)
  sw  $t1, 8($sp)

  la  $t0, tmpval
  lw  $t1, 0($t0)  # $t1 == tmpval == 5
  li  $t1, $2      # $t1 == 2
  sw  $t1, 0($t0)  # tmpval == 2

  lw  $ra, 0($sp)
  lw  $t0, 4($sp)
  lw  $t1, 8($sp)
  add $sp, $sp, 12
  jr $ra 
```

因此，在代码的内部块中，您可以看到您将`$t0`（或任何其他寄存器）视为内存位置并适当地使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T22:48:47.693

MIPS 有许多用于加载和存储到内存的指令：加载字 (lw)、加载半字 (lh)、加载字节 (lb)、存储字 (sw)、存储半字 (sh) 和存储字节 (sb)举几个例子。它们都使用相同的语法，因此这里是从内存位置加载的示例：

```
lw $t, C($s) 
```

这将从寄存器 $s 加上 C 中保存的内存位置加载单词到寄存器 $t。即$t = [$s + C]

类似的存储：

```
sw $t, C($s) 
```

这会将寄存器 $t 中的单词存储到 $s 加上 C 中的内存位置。即 [$s + C] = $t

# java - 发送邮件时未找到受信任的证书，但该证书似乎在密钥库中

> ID：10324692
> 
> 赞同：1
> 
> 时间：2012-04-25T22:24:45.503
> 
> 标签：java, ssl, jakarta-mail, keystore

我有一个 Tomcat 5 webapp，它尝试通过 smtp.gmail.com 在端口 465 上通过 SSL 套接字发送邮件。我得到了例外：

```
javax.mail.MessagingException: Could not connect to SMTP host: smtp.gmail.com, port: 465;
  nested exception is:
    javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: No trusted certificate found
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1706)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:525)
    at javax.mail.Service.connect(Service.java:291)
    at javax.mail.Service.connect(Service.java:172) 
```

好的。我试图在我的密钥库中导入我在网站[https://www.gmail.com](https://www.gmail.com)上获得的证书。

```
keytool -import -trustcacerts -file c:\verising-c3_01.cer 
```

但是 keytool 说这个证书已经存在。Tomcat 是使用默认设置安装的，我没有移动密钥库（我什至不知道它们在哪里）。我的 javaMail 版本是 1.4.3，我的 jvm 版本是 1.4.2_12。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:03:45.460

导入的证书进入信任库，而不是密钥库。除非服务器需要客户端证书，否则您根本不需要密钥库，而邮件服务器很少这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:57:51.423

使用更新版本的 JDK 可能会有所帮助，即使只是为了调试目的，看看它是否有任何不同。

可能您的 Tomcat 配置覆盖了密钥库配置，因此您没有使用您认为正在使用的密钥库。JavaMail 包含的[SSLNOTES.txt](http://www.oracle.com/technetwork/java/javamail145sslnotes-1562622.html)文件有指向 SSL 调试提示的指针；这可能会帮助您缩小问题的根源。

# php - 复选框提交到 mysql 数据库

> ID：10324694
> 
> 赞同：0
> 
> 时间：2012-04-25T22:24:49.123
> 
> 标签：php, mysql, html, forms, checkbox

我正在尝试创建一个复选框系统来完成我拥有的在线表格。

除复选框部分外，有关表单的所有内容都可以正常工作。它只是向数据库发布任何内容。

```
 <input type='checkbox' name='species' value='$txt' />$txt<br/> 
```

上面的代码放置在表单页面中，它动态地从数据库中提取信息以显示完整的物种列表。该文件也可以正常工作，并按预期将它们全部显示在表单上。但是，当用户勾选任何或所有复选框时，提交表单时不会将任何内容发布到数据库中。表单中的所有其他内容都已提交。没有错误从数据库返回。

```
 $_POST[species] 
```

谁能建议这里可能出了什么问题？

其次，表格是关于钓鱼的。用户可以选择一些品种（例如褐鳟鱼、虹鳟鱼和金鳟鱼） 是否可以将其发布为褐鳟鱼、金鳟鱼和虹鳟鱼？我认为可能需要大量的 IF 语句？？？这是唯一的方法吗，因为它似乎是一条很长的路线，有很多组合......

对这两个问题的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:33:42.963

使用 PHP 处理表单在网上有很好的记录。[在 PHP Freaks 尝试这篇文章](http://www.phpfreaks.com/tutorial/working-with-checkboxes-and-a-database)。

看起来你正在寻找

```
<input type='checkbox' name='species[]' value='$txt' />$txt<br/> 
```

# jquery - 如何检测 jQuery mobile 何时打开或关闭选择菜单？

> ID：10324698
> 
> 赞同：0
> 
> 时间：2012-04-25T22:24:57.720
> 
> 标签：jquery, mobile, cordova

我正在使用带有 jQ​​uerymobile 的 phonegap，

使用自定义菜单时，我知道很容易检查具有“ui-selectmenu-screen”类的div是否也有“ui-screen-hidden”类，但我的问题是我无法触发此功能，我完全不知道“点击”事件在哪里触发，当我点击折叠的选择菜单时，我尝试过：

```
$('a.ui-btn').bind('click',function() {
    if (  $('.ui-selectmenu-screen').hasClass("ui-screen-hidden");  ) {
       DO WHAT EVER...
    }
}); 
```

以及许多变化，但就像没有点击事件......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:03:46.983

我今天刚遇到这个问题并开发了以下解决方案。

```
$("select").change(function() {

    // Ignore events if the interval has already been established
    if (this.interval)
        return false;

    // Self invoking anonymous function to prevent polution of parent scope 
    // in some environments (IE), passes 'this' as element
    (function (element) {

        // Set an interval to watch for the window to close
        element.interval = setInterval((function callback() {

            // Find the widget
            var $widget = $('#'+element.id+'-menu').closest('.ui-selectmenu');

            // If it has been closed DO STUFF and clear the interval
            if ($widget.hasClass('ui-selectmenu-hidden')) {

                // YOUR CODE HERE

                clearInterval(element.interval);

            }

            return callback;
        })(), 1000);

    })(this);

    return false;
}); 
```

另外值得注意的是，如果您通过 ajax 重新加载这些表单元素，则需要在插入新 HTML 之前从 DOM 中删除自定义小部件元素。动态更新选项将是一个更优雅的解决方案，但我没有那个选项。

```
$('.ui-selectmenu, .ui-selectmenu-screen, .ui-dialog').remove(); 
```

# java - 记忆游戏 - 将图像数组馈送到网格按钮矩阵

> ID：10324700
> 
> 赞同：1
> 
> 时间：2012-04-25T22:25:06.400
> 
> 标签：java, arrays, swing, netbeans

我从 Netbeans 中的设计视图创建了我的按钮（JToggleButton 类型）

前任。btn00, btn01 ...

我的网格有一个矩阵（记忆游戏风格）：

int matriz[][] = 新的 int [4][6];

我有另一个矩阵用于我的图像所在的位置（ImageIcon 类型），我使用这种方法来遍历它：

```
public ImageIcon[] ArrayIconos()
{
    ImageIcon Disney[] = new ImageIcon[25];

    for (int n=0; n<25; n++)
    {
        Disney[n] = new ImageIcon("Disney"+(n+1)+".png");
        System.out.println(Disney[n]);
    }

    return Disney;

} 
```

我怎样才能将我的图像矩阵（迪士尼）输入我的矩阵矩阵，以便我可以将图像加载到按钮？

感谢您在高级方面的帮助。如果我的解释不够清楚，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T03:00:11.437

请注意，记忆游戏不需要知道单元格是按矩形矩阵排列的；它只关心两个单元格是否有匹配的图像。这个[例子](https://sites.google.com/site/drjohnbmatthews/buttons)使用了两个实例`List<GameButton>`

*   `buttons`拥有所有的记忆单元。
*   `selected`记录当前选择。

# java - .properties 文件中的 PropertyPlaceholderConfigurer 和环境变量

> ID：10324702
> 
> 赞同：15
> 
> 时间：2012-04-25T22:25:14.233
> 
> 标签：java, spring, environment-variables, applicationcontext, properties-file

我有一个带有 PropertyPlaceholderConfigurer 的 Spring application-context.xml，可以从 .properties 文件中获取属性值。主要和测试源文件夹具有单独的 .properties 文件。问题是我需要在 .properties 文件中使用环境变量。但是当我按照以下方式进行操作时：

```
property.name=${env.SYSTEM_PROPERTY} 
```

我收到以下错误：

```
org.springframework.beans.factory.BeanDefinitionStoreException: Invalid bean definition with name 'beanName' defined in class path resource [com/example/applicationContext.xml]: Could not resolve placeholder 'env.SYSTEM_PROPERTY' 
```

而占位符配置器定义为

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="classpath:com/example/application.properties"/>
</bean> 
```

任何想法如何使 property.name 被解释为环境变量（而不是占位符）？

最好的问候，德米特里。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-28T07:22:33.790

我可能会完全改变解决方案：直接注入系统属性，而不是注入引用系统属性的属性

例如

```
@Value("#{ systemProperties['JAVA_MY_ENV'] }") 
private String myVar; 
```

或者

```
<property name ="myVar" value="#{systemProperties['JAVA_MY_ENV']}"/> 
```

我使用这样的属性占位符配置器

```
<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
  <property name="locations">
    <list>
        <value>classpath:someprops.properties</value>
    </list>
  </property>
  <property name="ignoreResourceNotFound" value="true" />
  <property name="searchSystemEnvironment" value="true" />
  <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE" /> 
```

您还必须记住将参数传递给程序使用

```
 -DJAVA_MY_ENV=xyz 
```

这样，当您运行生产版本时，您可以传递一件事，而在运行测试时传递另一件事。

我经常做的事情是这样的：

```
 <property name="locations">
    <list>
      <value>classpath:someprops.properties</value>
      <value>classpath:someprops-{environment}.properties</value>
    </list>
  </property> 
```

其中环境是 prod/stage/test/int/ci/local（每个环境 1 个 - 您现在可能只有 2 或 3 个）。您可以将环境变量传递给程序。无论其在本地 pc/tests 上的生产/运行是否在 someprops.properties 属性文件中，任何应该相同的属性。任何特定于环境/运行方式的文件都将放入更具体的文件中（您应该将其放入 someprops.properties 文件以及默认值，除非被覆盖机制）

例如在类路径中：someprops.properties

```
url=www.mysite.com 
```

在类路径中：someprops-local.properties

```
url=localhost 
```

通过使用这个基本思想，您可以以干净的方式分离测试和程序的正常运行属性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-03T15:29:34.493

使用：

```
<context:property-placeholder location="classpath:env.properties"/> 
```

改变你的：

```
property.name=${env.SYSTEM_PROPERTY} 
```

至：

```
property.name=${SYSTEM_PROPERTY} 
```

我正在使用 Spring 3.0.4.RELEASE，但我不知道这是什么时候引入的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-16T19:42:40.127

我使用了 benkiefer 的方法，但我必须在 web.xml 中添加一个侦听器：

```
<listener>
   <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener> 
```

# clojure - Clojure ref - 有什么理由重试此事务？

> ID：10324703
> 
> 赞同：2
> 
> 时间：2012-04-25T22:25:19.297
> 
> 标签：clojure, ref

我有这个代码：

```
(defn on-thread [f]
  (.start (Thread. f)))

(def myref (ref 0))

(on-thread
  #(loop [x 100]
     (when (> x 0)
       (do
         (Thread/sleep 100)
         (println "myref is:" @myref)
         (recur (dec x))))))

(on-thread 
  #(dosync
    (println "transaction1 initial:" @myref) 
    (alter myref inc)
    (println "transaction1 final:" @myref) 
    (Thread/sleep 5000)
    (println "transaction1 done")))

(on-thread 
  #(dosync
     (println "transaction2 initial:" @myref) 
     (Thread/sleep 1000)
     (alter myref inc)
     (println "transaction2 final:" @myref) 
     (println "transaction2 done"))) 
```

当我运行它时，很明显第一个事务首先运行，它将 ref 的值更改为 1 - 但其他线程看不到这一点：好吧，当然，因为第一个事务尚未完成。所以我认为此时还没有“提交”给裁判。

但是此时，第一个事务进入睡眠状态，当它处于睡眠状态时，第二个事务尝试更改 ref 的值。它被回滚，并被环境重试！为什么？第二笔交易如何“看到”第一笔交易的 ref 发生了（或将要发生）某事？

我认为如果第二个事务能够更改 ref 的事务中值（从 0 到 1）然后休眠 1000，然后最终成功提交，那么将重试第一个事务会更合乎逻辑. 但这种情况并非如此。

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:10:00.893

第二个事务被重试，因为当它改变你的 ref 时，它看到它已经被另一个未提交的事务改变了。因此，它会重试，直到第一个事务提交。

如果有某种机会，第二个事务首先更改了 ref，那么是的，第一个事务将被重试。但是，事实并非如此，因为您的第二个事务发生在第一个事务之后（在 CPU 时间中）。

# java - 按 Enter 关闭对话框

> ID：10324704
> 
> 赞同：5
> 
> 时间：2012-04-25T22:25:24.363
> 
> 标签：java, swing, dialog

我有一个特殊的要求：

我有一个创建新对象模式对话框，其中包含许多字段和按钮确定和取消。我希望 OK 按钮具有焦点，因此用户可以简单地调用对话框并按 Enter 以创建具有默认值的新对象。我尝试调用`requestFocusInWindow()`，但在实际显示窗口之前它不起作用。显示窗口后我无法调用它，因为对话框是模态的。并且没有像`setInitialFocusedComponent()`对话框类那样的方法。

好的，然后我继续为`KeyListener`对话框中的每个字段创建一个（只有 3 个，没什么大不了的），如果用户在它们上按 Enter，它将手动按下 OK 按钮。现在的问题是第一个字段（因此也是焦点字段）是 a `JSpinner`，它消耗自己的`KeyEvents`。所以按 Enter 什么都不做。

如何在不重新组织元素的情况下在我的对话框中实现这种“Enter to OK”行为？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T22:32:25.173

两件事情：

1.  您是否尝试过使用 setDefaultButton？：`dialog.getRootPane().setDefaultButton(okButton)`
2.  您可以考虑在 invokeLater 中调用您的 requestFocusInWindow()。

像这样：

```
 SwingUtilities.invokeLater(new Runnable()
     @Override
     public void run() {
         okButton.requestFocusInWindow();
     }
 }); 
```

# jquery - AJAX 返回数据 fadeIn()

> ID：10324713
> 
> 赞同：1
> 
> 时间：2012-04-25T22:26:31.293
> 
> 标签：jquery, ajax

我使用 AJAX 将数据插入到我的表中，一旦完成，我希望我的新值淡入，代替现有的 .html 数据。

我有以下只是它似乎没有淡入...

```
// UPDATE INCOME 
     $("#salary-upd").on("submit", function(event) {
          event.preventDefault();
          var elem = $(this);
          $.post("update_salary.php", $(this).serialize(), function(data) {
                $(".spends").fadeIn().html(data);
     }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:28:56.983

你可以这样做：

```
 $(".spends").append(data).fadeIn(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:42:53.733

尝试，

```
 $(".spends").fadeOut('slow', function() { 
      $(this).html(data).fadeIn('slow'); 
   }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:32:08.637

试试这个。将初始值设置为开始，然后显式执行动画：

```
$(".spends").css('opacity', 0).animate( { opacity: 1 }, 'slow'); 
```

# ruby - .gemrc 评论？

> ID：10324725
> 
> 赞同：5
> 
> 时间：2012-04-25T22:28:29.260
> 
> 标签：ruby, comments, gem, rc

这是一个基本问题

文件中是否允许评论`.gemrc`？

如果是这样，你会怎么做？

我在这里检查无济于事

[docs.rubygems.org/read/chapter/11](http://docs.rubygems.org/read/chapter/11)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T22:33:14.327

医生说：[`The config file itself is in ’’’YAML’’’ format.`](http://docs.rubygems.org/read/chapter/11)

这意味着您可以有[以 # 开头的评论](http://yaml.org/spec/current.html#id2502724)，例如：

```
# I like docs
rdoc: --inline-source --line-numbers 
```

# css - LessCSS - 带有变量和变亮的 IE 渐变过滤器

> ID：10324729
> 
> 赞同：5
> 
> 时间：2012-04-25T22:28:41.033
> 
> 标签：css, internet-explorer, less

我需要在带有变量和变亮的 Less CSS 中使用 IE 渐变过滤器。这可能吗？

```
#whatever {
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='lighten(@grayColor, 3%)', endColorstr='@greenColor', GradientType=0);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T22:56:00.603

据我所知，您不能混合转义（因为这就是您需要的）和颜色功能（lighen）。因此，您需要将 startColor 值存储在另一个变量中。

```
@grayColor :#dddddd;
@greenColor : #ff0000;
@start : lighten(@grayColor, 3%);
.css {
   filter:~"progid:DXImageTransform.Microsoft.gradient(startColorstr='@{start}', endColorstr='@{greenColor}', GradientType=0)";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:48:52.527

您可以将变量插入字符串并在连接过程中“打印它们”。空字符串需要获取字符串作为连接的结果。所有变量都将插入字符串

```
@filterStr: "progid:DXImageTransform.Microsoft.gradient( startColorstr='@{upper}', endColorstr='@{bottom})',GradientType=1 )";
@emptyStr: "";
filter:e(@filterStr+@emptyStr); 
```

# php - 非 ascii 字符停止 mysql 语句

> ID：10324737
> 
> 赞同：0
> 
> 时间：2012-04-25T22:29:09.027
> 
> 标签：php, mysql, sql, non-ascii-characters

此 SQL 已失败。

SQL 是

```
INSERT INTO
    `migration_loose_terms`
    (`source`,`field`,`term`,`lastaccess`)
VALUES
    ('services.media','keywords','spermatozoïde','2012-04-25 12:00:00') 
```

因为它包含一个奇怪的`(ï)`字符。

你在 php/mysql 中使用什么函数来清除要被剥离的 nonascii 字符或以某种方式将该词放入 mysql 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:47:55.267

如果要去除非 ASCII 字符，可以使用以下代码：

```
<?php
$input = "Clean the non ASCII äócharacters.";
$output = preg_replace('/[^(\x20-\x7F)]*/','', $input);
echo $output;
?> 
```

否则，您是否尝试过用[mysql_real_escape_string](http://php.net/manual/en/function.mysql-real-escape-string.php "mysql真正的转义字符串")包装有问题的单词？

# asp.net - 301重定向是否刷新浏览器中的url

> ID：10324738
> 
> 赞同：0
> 
> 时间：2012-04-25T22:29:09.323
> 
> 标签：asp.net, redirect

出于 SEO 原因，我们从代码中发出 301 重定向。它工作得很好，我可以看到 301 在萤火虫中移动。

我在网上搜索并没有得到正确的答案。301 重定向是否也会刷新浏览器 url？

例如我在

```
www.test.com/hello1 
```

它搬到了

```
www.test.com/hello2 
```

我看到来自 hello2 的内容，但浏览器是否显示

www.test.com/hello2 或 www.test.com/hello1

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:33:37.027

是的，它确实。它就像一个正常的重定向一样工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:36:51.723

如[seomoz 所述](http://www.seomoz.org/blog/url-rewrites-and-301-redirects-how-does-it-all-work)：

> 重写 URL 意味着更改 URL 在浏览器中的显示方式。

# java - 以管理员身份发布到 Facebook 页面

> ID：10324742
> 
> 赞同：0
> 
> 时间：2012-04-25T22:30:01.100
> 
> 标签：java, facebook, scribe

我不知道 Java + Facebook 集成会花费很多钱。有没有人有示例代码以管理员身份发布到 Facebook 页面？

[我了解 OAuth 流程，我只需要使用scribe lib](https://github.com/fernandezpablo85/scribe-java)发送带有我的文本的 OAuthRequest 。如果可能的话，如何发送一个字节[]（一张图片）。

`request.addBodyParameter("status", "Testing: Updating my facebook status through Java"); service.signRequest(accessToken, request);
Response response = request.send();`

我已经从[scribe 示例](https://github.com/fernandezpablo85/scribe-java/blob/master/src/test/java/org/scribe/examples/FacebookExample.java)中尝试了上面的代码，但我得到了`{"error":{"message":"(#100) Can only call this method on valid test users for your app","type":"OAuthException","code":100}}`

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:31:30.593

I believe you need to generate an application token (assuming you have all the proper permissions) using the app secret and using this newly created token in your posts, etc.

# ios - UIViewController 中的 UITableView

> ID：10324744
> 
> 赞同：9
> 
> 时间：2012-04-25T22:30:02.557
> 
> 标签：uiviewcontroller中使用, uitableview, , ios, objective-c, uitableview, uiviewcontroller

如何在[uiviewcontroller中使用](/questions/tagged/uiviewcontroller "show questions tagged 'uiviewcontroller'")[uitableview](/questions/tagged/uitableview "显示标记为“uitableview”的问题")？下面是我正在尝试做的一个例子（除了这只是在我的故事板中）：`UITableview`

![UIViewController 中的 UITableView](../Images/4004220e3b08a32ed03d8c88dbc1c546.png)

我发现我需要将委托和数据源添加到我的标题中：

```
//MyViewController.h
@interface MyViewController : UIViewController <UITableViewDelegate, UITableViewDataSource> 
```

在我的实现文件中，我添加了所需的方法：

```
//MyViewController.m

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    NSLog(@"cellForRowAtIndexPath");

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"FileCell"];

    NSLog(@"cellForRowAtIndexPath");
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSArray *fileListAct = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:documentsDirectory error:nil];

    cell.textLabel.text = [NSString stringWithFormat:@"%@",[fileListAct objectAtIndex:indexPath.row]];

    return cell;
} 
```

、`delegate`和`datasource`都`UITableView`连接在我的故事板中：

![Interface Builder Connections Outlet 中的 UITableView 委托和数据源](../Images/7d8f8889d292a2c76c963f25e50b496d.png)

我无法让 TableView 加载我告诉它的内容。它总是空白。为什么 TableView 不会填充我在 cellForRowAtIndexPath 方法中告诉它的内容？我在这里想念什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T23:59:18.527

您必须将数据源和委托出口从情节提要中的 tableview 链接到视图控制器。这不是可选的。这就是为什么您的表格是空白的，它永远不会调用您的视图控制器的表格视图方法。（您可以通过在它们上设置断点并看到它们永远不会被触发来证明这一点。）您遇到了什么样的构建错误？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-26T20:20:35.477

您没有返回任何有效值。看到`return;`没有任何数值返回？

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
  return; // it should be return 15; or return self.datasource.count;
  NSLog(@"numberOfRowsInSection");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-08T22:10:42.100

您需要 YourTableView 的 IBOutlet，然后将 TableView 连接到 YourTableView

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-05T22:10:57.423

问题出在`UITableViewDelegate`方法`numberOfRowsInSection`上。这个不返回`NSInteger`行数。这个例子可以帮助：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return theNumberOfRowsForYourTable; // <-- not just return;
} 
```

# linux - DLNA FLAC 音频客户端可以在 Linux 上无头工作吗？

> ID：10324745
> 
> 赞同：1
> 
> 时间：2012-04-25T22:30:12.647
> 
> 标签：linux, upnp, dlna, flac

主题行说——谁能给我指出一个 DLNA 音频播放器客户端，它无需转码即可播放 FLAC，不需要 X 服务器或图形界面，并且可以从命令行愉快地运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:51:34.957

我也一直在寻找类似的东西。唯一与此类似的是 gmediarenderer，但我看不到将它安装在没有安装 X 库的盒子上的方法——但我可能是错的。它也没有维护...... [https://github.com/hzeller/gmrender-resurrect](https://github.com/hzeller/gmrender-resurrect)提供了一个分支，可能值得一试。

FWIW，mpd ( [http://mpd.wikia.com/wiki/Music_Player_Daemon_Wiki](http://mpd.wikia.com/wiki/Music_Player_Daemon_Wiki) ) 确实无头运行，并且除了支持来自我的 Upnp 控制点的控制之外，它可以做我想做的一切。

# java - 在将集合拆分/连接到数组或迭代集合本身之间哪个更快

> ID：10324749
> 
> 赞同：-3
> 
> 时间：2012-04-25T22:30:58.043
> 
> 标签：java

我有 2 个代码 tbat 做同样的事情。我想知道哪个会更快：

1.

```
import org.apache.commons.collections.CollectionUtils;
String [] htArray = StringUtils.join (CollectionUtils.subtract (
    Arrays.asList ((h + " " + t).split (" ") ),
    Arrays.asList (htSelected.split (" ") ) ), " " ).split (" ");
for (String term: htArray ) {
    ...
} 
```

2.

```
import org.apache.commons.collections.CollectionUtils;
ArrayList <String> htList = null;
try {
    htList = (ArrayList <String>) CollectionUtils.subtract (
        Arrays.asList ( (h + " " + t).split (" ") ), 
        Arrays.asList (htSelected.split (" ") ) );
} catch (Exception except) {}

if ( htList != null) {
    for (String term: htList) {
        ...
    }
} 
```

第一个加入一个集合，然后将字符串拆分为一个数组。第二个转换集合，尝试/捕获然后添加一个'if'。哪一个是最优的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:32:45.580

运行它 100 次并弄清楚

# jquery - jQuery函数获取当前视口？

> ID：10324753
> 
> 赞同：5
> 
> 时间：2012-04-25T22:31:31.757
> 
> 标签：jquery

我找到了这个：

```
getViewport = function () {
  var m = document.compatMode == 'CSS1Compat';
  return {
    l : window.pageXOffset || (m ? document.documentElement.scrollLeft : document.body.scrollLeft),
    t : window.pageYOffset || (m ? document.documentElement.scrollTop : document.body.scrollTop),
    w : window.innerWidth || (m ? document.documentElement.clientWidth : document.body.clientWidth),
    h : window.innerHeight || (m ? document.documentElement.clientHeight : document.body.clientHeight)
  };
}; 
```

但是 jQuery 是否为此提供了内置函数？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T23:54:39.413

虽然没有一个内置函数，但函数本身可以使用 jQuery 函数进行简化：

```
getViewport = function() {
    var $w = $(window);
    return {
        l: $w.scrollLeft(),
        t: $w.scrollTop(),
        w: $w.width(),
        h: $w.height()
    }
} 
```

在这里进行了测试：http: [//jsfiddle.net/naLLa/](http://jsfiddle.net/naLLa/)

您可能还会发现这个插件感兴趣，它添加了基于视口的选择器：http: [//www.appelsiini.net/projects/viewport](http://www.appelsiini.net/projects/viewport)

# svg - 标记在 D3 的 SVG 路径末尾没有正确定位

> ID：10324754
> 
> 赞同：2
> 
> 时间：2012-04-25T22:31:39.477
> 
> 标签：svg, d3.js

我正在尝试创建一个可视化，其中 2 个节点之间的线通过使用 d3.svg.diagonal 的路径连接，如[http://www.isi.edu/~shubhamg/d3-test-6.html所示](http://www.isi.edu/~shubhamg/d3-test-6.html)

可以看出，标记在 SVG 路径末端的方向不正确（标记是指路径末端的箭头） 有什么建议可以解决吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:31:05.633

您可能想查看名为“ [Mobile Patents](http://bl.ocks.org/1153292) ”的力有向图示例。我相信这是一个小例子，它准确地展示了如何做到这一点。

我希望它有所帮助。

坦率

# php - mysql_fetch_array() 期望参数 1 是资源，给定的布尔值

> ID：10324761
> 
> 赞同：-2
> 
> 时间：2012-04-25T22:32:25.203
> 
> 标签：php, html, css

> **可能重复：**
> [PHP 错误：mysql_fetch_array() 期望参数 1 是资源，给定布尔值](https://stackoverflow.com/questions/2973202/php-error-mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given)

当我运行我的脚本时，我继续收到这些错误，我无法弄清楚我需要修复什么，因为现在它没有像我需要的那样显示任何 php。

这是我收到的错误。

```
Warning: mysql_num_rows() expects parameter 1 to be resource, boolean given in    /Applications/XAMPP/xamppfiles/htdocs/WordOfMouth/root/pages/profile_page/profile_page.php on line 38

Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in /Applications/XAMPP/xamppfiles/htdocs/WordOfMouth/root/pages/profile_page/profile_page.php on line 44

Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in  /Applications/XAMPP/xamppfiles/htdocs/WordOfMouth/root/pages/profile_page/profile_page.php on line 136 
```

任何帮助都会令人难以置信。

```
<?php
include_once("../../mysql_server/checkuserlog.php");
?>
<?php 
// Now let's initialize vars to be printed to page in the HTML section so our script does not return errors 
// they must be initialized in some server environments
$id = "";
$firstname = "";
$middlename = "";
$lastname = "";
$country = "";  
$state = "";
$city = "";
$zip = "";
$bio_body = "";
$bio_body = "";
$user_pic = "";
$blabberDisplayList = "";
// If coming from category page
if ($_GET['id']) {

 $id = $_GET['id'];

} else if (isset($_SESSION['id'])) {

 $id = $_SESSION['id'];

} else { 

   include_once "../home_page/home_page.php";

   exit();
}

$id = mysql_real_escape_string($id);
$sql = mysql_query("SELECT * FROM myMembers WHERE id='$id' LIMIT 1");

 if (mysql_num_rows($sql) === 0) { // evaluate the count
 echo("ERROR");
     exit();
}
// ------- END MAKE SURE PERSON EXISTS IN DATABASE ---------
// Make sure this person a visitor is trying to view actually exists
while($row = mysql_fetch_array($sql)){ 
$firstname = $row["firstname"];
$lastname = $row["lastname"];
$country = $row["country"]; 
$state = $row["state"];
$city = $row["city"];
$sign_up_date = $row["sign_up_date"];
    $sign_up_date = strftime("%b %d, %Y", strtotime($sign_up_date));
$last_log_date = $row["last_log_date"];
    $last_log_date = strftime("%b %d, %Y", strtotime($last_log_date));  
$bio_body = $row["bio_body"];   
$bio_body = str_replace("&amp;#39;", "'", $bio_body);
$bio_body = stripslashes($bio_body);
$website = $row["website"];
$youtube = $row["youtube"];
$facebook = $row["facebook"];
$twitter = $row["twitter"];
$friend_array = $row["friend_array"];
///////  Mechanism to Display Pic. See if they have uploaded a pic or not     //////////////////////////
$check_pic = "../../members/$id/image01.jpg";
$default_pic = "../../members/0/image01.jpg";
if (file_exists($check_pic)) {
$user_pic = "<img src=\"$check_pic?$cacheBuster\" width=\"218px\" />"; 
} else {
$user_pic = "<img src=\"$default_pic\" width=\"218px\" />"; 
}

}

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html" />
<meta name="Description" content="Profile for <?php echo "$username"; ?>" />
<meta name="Keywords" content="<?php echo "$username, $city, $state, $country"; ?>" />
<meta name="rating" content="General" />
<meta name="ROBOTS" content="All" />
<title>Profile Page</title>
<link href="../../style.css" rel="stylesheet" type="text/css" />
<link rel="icon" href="#" type="image/x-icon" /> <!-- INSERT ICON -->
<link rel="shortcut icon" href="#" type="image/x-icon" /> <!-- AND HERE -->
<script src="../../jquery-1.4.2.js" type="text/javascript"></script>

</head>
<body>
<div class="wrapOverall">
<?php include_once '../../templates/decide_header.php'; ?>
<table width="900" border="0" style="background-color:#F2F2F2; border:#999 1px solid;" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td width="738"><br />
      <table width="90%" border="0" align="center" cellpadding="6">
      <tr>
        <td width="48%" valign="top">
        <?php print "$firstname $lastname"; ?>
        <br />
        <?php print "$user_pic"; ?>
        <br />
        Member Since: <?php print "$sign_up_date"; ?>
        <br />
       <?php print "$youtubeChannel"; ?>
       </td>
        <td width="52%" valign="top">
        <br />
        <strong><u><?php print "$firstname $lastname"; ?>'s Blabs:</u></strong>
        <br />
        <?php print "$the_blab_form"; ?>
        <div style="width:100%; height:180px; overflow:auto; overflow-x:hidden;">
        <?php print "$blabberDisplayList"; ?>
        </div>
        <br />
        <br />
        <strong><u><?php print "$firstname $lastname"; ?>'s Location Details:</u></strong>
    <br />
    <?php print "$city"; ?> &bull; <?php print "$state"; ?> &bull; <?php print "$country"; ?>
    <br />
    <br />
    <strong><u>About <?php print "$firstname $lastname"; ?></u></strong>
    <br />
    <?php print "$bio_body"; ?>
    <br />

    </td>
  </tr>
  <tr>
    <td colspan="2" valign="top">&nbsp;</td>
    </tr>
  </table>
  <p><br />
    <br />
  </p></td>
<td width="160" valign="top"><?php include_once "../../templates/right_AD_template.php"; ?    ></td>
  </tr>
</table>
<?php include_once '../../templates/footer_template.php'; ?>
</div> <!-- END wrapOverall -->
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:19:49.287

在以下两行代码中：

```
$sql = mysql_query("SELECT * FROM myMembers WHERE id='$id' LIMIT 1");
if (mysql_num_rows($sql) === 0) { // evaluate the count 
```

如果`mysql_query`失败，则您没有可传递给的可行[资源](http://www.php.net/manual/en/language.types.resource.php)`mysql_num_rows()`。

您应该首先检查以确保查询实际运行：

```
$sql = mysql_query("SELECT * FROM myMembers WHERE id='$id' LIMIT 1");
if (!$sql) {
    // query failed
    echo "Query failed: " . mysql_error();
} else {
    $num_rows = mysql_num_rows($sql);
    // rest of your code
} 
```

因为你有`===`，所以表达式的`mysql_num_rows($sql) === 0`计算结果为 true ，因为函数返回了 null ，因为它被调用时使用了错误的值。`mysql_fetch_array`因此，在使用无效资源调用时，您会遇到同样的问题。

主要线索是：`mysql_num_rows() expects parameter 1 to be resource, boolean given`。

它需要一个资源，但它被赋予了一个不能使用的布尔值。因此，您可以调查您传递给它的变量的值以及为什么它是布尔而不是资源（在这种情况下是因为查询失败）。

# java - 如何在互联网连接中断时收到通知，但 WiFi 仍然连接

> ID：10324762
> 
> 赞同：1
> 
> 时间：2012-04-25T22:32:26.460
> 
> 标签：java, android, network-programming

有人知道在连接到 WiFi 时是否可以在 Android 中通知互联网连接断开？如果可能的话，我想在不 ping 的情况下执行此操作。例如，当互联网连接中断时，我的应用程序可能正在通过 WiFi 下载文件。该设备仍然可以连接到无线路由器，但不再能够下载文件。

我简要地查看了 ConnectivityManager，但它似乎只具有从 3G 切换到 WiFi 或失去特定模式的意图。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:06:26.957

就您的设备而言，有一个活动的 WiFi 连接*正在*连接到 Internet。断开您家的 DSL 调制解调器与让电信公司的接线盒熔断并没有什么不同，只是可能修复得更快。

如果您想监控与特定服务的连接，则必须设计一种不同的方案，而不仅仅是查看网络堆栈。

# java - 如何匹配数据库中不同表的唯一 ID 并根据 Java 中的唯一 ID 检索数据？

> ID：10324773
> 
> 赞同：0
> 
> 时间：2012-04-25T22:33:26.433
> 
> 标签：java, postgresql, servlets, match, fuzzy

数据库（postgresql）中的表**用户**对每个用户都有唯一的id，dob，用户的名字和姓氏；数据库中的表**点**有 userID 和 gamePoints 列。

在 java servlet 中，如何通过点和输出匹配和检索该用户的确切身份？模糊匹配？？

例子：

```
Table user:
userID-name-lastname-dob
1-Edward-Maka-1950
2-Kapu-Aka-1990
3-Park-Lewins-1993

Table points:
userID-gamePoints
1-320
3-3312
2-1001 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:46:04.550

这不只是一个问题，还是编写一个适当的查询并用 Java 解析来自 ResultSet 的结果？

查询应该是这样的：

```
SELECT user.userID, user.name, user.lastname, user.dob, points.gamePoints
FROM user, points
WHERE user.userID = points.userID 
  AND (user.name = ? OR user.lastname = ?) 
```

# ruby-on-rails - rails 应用程序默认为 sqlite3。我想将 postgresql 作为默认值_如何更改

> ID：10324778
> 
> 赞同：2
> 
> 时间：2012-04-25T22:33:45.693
> 
> 标签：ruby-on-rails, postgresql, sqlite

我正在学习 rails，当我开始并安装基于我正在阅读的书籍的 sqlite3 的所有内容时。但是，我正在尝试部署我在 heroku 上编写的测试应用程序。Heroku 建议应用程序运行 postgresql 进行开发和生产，以防止出现细微的错误。所以我决定从今以后对我所有的 Rails 应用程序使用 post gresql。

为此，我进行了以下设置：
1）下载并安装了 Postgresql
2）在我的 .bash_rc 文件中添加了文件夹的路径
3）安装了 pg gem
4）到目前为止一切都很好。但是，当我转到我的应用程序的根文件夹并尝试以下命令时：

```
rails generate scaffold User name:string email:string 
```

我在控制台上收到以下错误

```
rails generate scaffold User name:string email:string

invoke  active_record 
/Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/bundler-
1.0.22/lib/bundler/rubygems_integration.rb:143:in `block in replace_gem': 
Please install the sqlite3 adapter: `gem install activerecord-sqlite3-adapter` 
(sqlite3   is not part of the bundle. Add it to Gemfile.) (LoadError)
from /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/activerecord- 
3.2.1/lib/active_record/connection_adapters/sqlite3_adapter.rb:3:in `<top (required)>' 
```

这告诉我，我的 rails 应用程序中的默认设置清楚地适用于 sqlite3。所以我打开了我的 databse.yml 文件，这就是它的内容。

```
# SQLite version 3.x
#   gem install sqlite3
#
#   Ensure the SQLite 3 gem is defined in your Gemfile
#   gem 'sqlite3'
development:
  adapter: sqlite3
  database: db/development.sqlite3
  pool: 5
  timeout: 5000

# Warning: The database defined as "test" will be erased and
# re-generated from your development database when you run "rake".
# Do not set this db to the same as development or production.
test:
  adapter: sqlite3
  database: db/test.sqlite3
  pool: 5
  timeout: 5000

production:
  adapter: sqlite3
  database: db/production.sqlite3
  pool: 5
  timeout: 5000 
```

一切都为 sqlite3 设置了如何更改我的 rails 设置，以便默认情况下数据库的所有配置都用于 postgresql？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T23:07:12.450

**更新：**查看 - [http://railscasts.com/episodes/342-migrating-to-postgresql](http://railscasts.com/episodes/342-migrating-to-postgresql)

您只需要更改 database.yml 文件中的设置，以便它知道您要使用什么。在您的情况下，您需要更改适配器和数据库：

```
development:
  adapter: postgresql
  database: my_app_dev
  username: username
  password: pw 
```

一旦你把它放在那里，你可以运行以下命令来让它与你在 sqlite 中的内容相匹配：

```
rake db:create && rake db:schema:load 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-23T19:53:44.543

自从您提出问题以来，不确定这是否是一项新功能，但是将“-d postgresql”传递给`rails new`命令，它将使用 postgres 信息填充 config/database.yml。

```
rails new testapp -d postgresql 
```

# mercurial - 我可以在 Mercurial 中禁用回滚吗？

> ID：10324779
> 
> 赞同：2
> 
> 时间：2012-04-25T22:33:48.923
> 
> 标签：mercurial

今天我失去了大约 6 个小时的工作，因为我做了 'hg rollback' 而不是 'hg revert'。我不会浪费时间谈论拥有没有确认或警告的破坏性命令是多么愚蠢。

我宁愿做到这一点，这样我就不能再犯这样的简单错误了。有没有办法可以从命令行禁用此命令？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T22:45:14.160

您可以使用别名来破坏它。尝试将以下内容添加到您的`~/.hgrc`：

```
[alias]
rollback = !echo WAT? 
```

请注意，它可能不适用于旧的 mercurial 版本（我会说，早于 1.8）。

# c# - 为什么 VS 一直坚持要求另一个正确的括号？

> ID：10324780
> 
> 赞同：2
> 
> 时间：2012-04-25T22:33:52.340
> 
> 标签：c#, boolean

这段代码：

```
private bool ValToEnterIsValid(string ACandidateVal) {
  return ((ACandidateVal == "1") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum1.Text)) ||
         ((ACandidateVal == "2") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum2.Text)) ||
     ((ACandidateVal == "3") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum3.Text));
} 
```

...以及此代码：

```
private bool ValToEnterIsValid(string ACandidateVal) {
  return (((ACandidateVal == "1") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum1.Text)) ||
          ((ACandidateVal == "2") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum2.Text)) ||
      ((ACandidateVal == "3") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum3.Text)));
} 
```

...导致 VS 说，“）预期” - 无论我添加多少正确的括号，试图幽默它！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T22:36:12.583

每行的括号是不平衡的。此外，由于优先级的工作方式，您有多余的括号；我会把它写成

```
private bool ValToEnterIsValid(string ACandidateVal) {
  return (ACandidateVal == "1" && !String.IsNullOrWhiteSpace(textBoxPhoneNum1.Text)) ||
         (ACandidateVal == "2" && !String.IsNullOrWhiteSpace(textBoxPhoneNum2.Text)) ||
         (ACandidateVal == "3" && !String.IsNullOrWhiteSpace(textBoxPhoneNum3.Text));
} 
```

另外，您使用三个变量而不是数组是否有原因？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:37:48.800

似乎您在 if 的每个部分都缺少 )：

```
private bool ValToEnterIsValid(string ACandidateVal) {
  return (( (ACandidateVal == "1") && 
            (!String.IsNullOrWhiteSpace(textBoxPhoneNum1.Text)) ) ||
          ( (ACandidateVal == "2") && 
            (!String.IsNullOrWhiteSpace(textBoxPhoneNum2.Text)) ) ||
          ( (ACandidateVal == "3") && 
            (!String.IsNullOrWhiteSpace(textBoxPhoneNum3.Text)) )
         );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T22:41:28.067

您在每个 !String.IsNullOrWhiteSpace 比较的末尾都缺少额外的“)”：

此代码有效：

```
 private bool ValToEnterIsValid(string ACandidateVal) {
          return (
              (ACandidateVal == "1") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum1.Text)) ||
              (ACandidateVal == "2") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum1.Text)) ||
              (ACandidateVal == "3") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum1.Text))
             );
        }

        private bool ValToEnterIsValid(string ACandidateVal) {
          return (
              ((ACandidateVal == "1") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum1.Text))) ||
              ((ACandidateVal == "2") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum2.Text))) ||
              ((ACandidateVal == "3") && (!String.IsNullOrWhiteSpace(textBoxPhoneNum3.Text)))
              );
        } 
```

# postgresql - 如果行已存在，则 Postgres 事务使用 UPDATE 而不是 INSERT

> ID：10324781
> 
> 赞同：1
> 
> 时间：2012-04-25T22:33:57.980
> 
> 标签：postgresql, stored-procedures, transactions, postgresql-9.1

来自 Postgres 新手的一个简单问题：

我如何编写类似的 Postgres 事务

```
IF SELECT COUNT(*) FROM myTable WHERE myPK = myValue > 0 THEN
UPDATE myTable ...
ELSE
INSERT INTO myTable...
END 
```

我希望它可以解决我的网络应用程序中的一个错误，该错误发生在 myTable 上发生另一个插入时，我能够`SELECT COUNT(*)`从中决定是否应该更新或插入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:52:18.757

在 Postgresql 的文档中有一个示例 plpgsql 实现：参见[merge_db](http://www.postgresql.org/docs/9.1/static/plpgsql-control-structures.html#PLPGSQL-UPSERT-EXAMPLE)

它专门用于支持并发更新或插入（通常称为 UPSERT）。

# php - 在 Symfony 2 中验证没有表单的实体

> ID：10324782
> 
> 赞同：45
> 
> 时间：2012-04-25T22:33:58.183
> 
> 标签：php, symfony

我正在为 Symfony 2 创建一个 REST API 控制器。我开始使用 SensioGeneratorBundle 创建一个 CRUD 并修改控制器以充当 REST 控制器。但是，我没有表格，所以我正在考虑删除这部分。

如何在没有表单的情况下验证我的字段？一切都与表单相关联，我想要一些自由，包括自定义字段名称。例如，POST x 和 y 字段被 Symfony 解释为标题和内容。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-04-26T03:19:18.463

确实，表单与验证没有直接关系。让我解释一下。

表单组件负责映射从客户端接收到的数据，无论是 GET 还是 POST 数据。因此，它将字符串映射到您的代码对象（如果未绑定到实体，则可以是数组）。

在将数据映射到实体后，表单使用验证器组件来验证实体。这意味着实体的验证与表单组件完全分离。因此，当表单被验证时，它实际上意味着表单组件验证您的实体而不是表单数据。得到验证的是实体，而不是表单。

该表单仅用于获取字符串表示并将其映射到实体层次结构。文档反映了这一点，因为[Form](http://symfony.com/doc/current/book/forms.html)和[Validation](http://symfony.com/doc/current/book/validation.html)是 symfony [book](http://symfony.com/doc/current/book/index.html)的不同部分。

话虽如此，这也意味着实体的验证可以在表单组件之外轻松完成。您将您的约束定义为注释或在外部文件（yml、php 或 xml）中，并使用验证器组件来验证您的实体。这里有一个取自本书[验证](http://symfony.com/doc/current/book/validation.html#using-the-validator-service)部分的代码示例：

```
use Symfony\Component\HttpFoundation\Response;
use Acme\BlogBundle\Entity\Author;
// ...

public function indexAction()
{
    $author = new Author();
    // ... do something to the $author object

    $validator = $this->get('validator');
    $errors = $validator->validate($author);

    if (count($errors) > 0) {
        return new Response(print_r($errors, true));
    } else {
        return new Response('The author is valid! Yes!');
    }
} 
```

如您所见，这里没有涉及任何形式，只有一个对象和验证器服务。此外，Symfony2 的验证组件是完全独立的。这意味着您可以在没有整个框架的情况下使用它。话虽如此，当独立使用时，您会失去与其他东西的良好集成。

这样，您的 REST 服务接收参数，从中创建实体并使用验证器服务来验证它们的完整性。验证实体并不强制使用该表单。

# javascript - 上下文菜单默认值

> ID：10324783
> 
> 赞同：0
> 
> 时间：2012-04-25T22:33:59.593
> 
> 标签：javascript, html, contextmenu, right-click

我有一些使用动画精灵表的按钮，因此必须设置为背景图像（据我所知）。目前他们使用javascript重定向而不是href，因此右键单击的上下文菜单用于背景图像。

理想情况下，我希望它显示链接的上下文菜单，以便可以通过右键单击使用“在新选项卡/窗口中打开”（或浏览器等效项）。

我不想创建自定义上下文菜单，只是让它使用浏览器标准菜单链接，而不是背景图像。

不幸的是，谷歌在这件事上并没有太多帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T00:09:32.437

HTML5 规范更新了超链接以允许它们[包含流内容](http://dev.w3.org/html5/markup/a.html)。如果您想要这种行为，则需要使用@Eliran 建议的超链接将它们包装起来。

不支持修改上下文菜单，最接近的就是用创建 HTML 菜单的东西覆盖默认的右键单击事件处理。

# c++ - 如何访问矩阵形式的所有变量的解值？

> ID：10324785
> 
> 赞同：1
> 
> 时间：2012-04-25T22:34:12.660
> 
> 标签：c++, matrix, cplex

*（注意：这个问题与[IBM 的 ILOG CPLEX](http://en.wikipedia.org/wiki/CPLEX) C++ API、2007 年前后通过 HTTP 的 pdf 格式的文档有关[，以及可](http://www-eio.upc.es/lceio/manuals/cplex-11/pdf/refcppcplex.pdf)[通过 IBM 的 FTP](ftp://ftp.software.ibm.com/software/websphere/ilog/docs/optimization/cplex/)获得的“版本 12”的当前材料）*

我有一个矩阵变量，我想将它们的值传递给矩阵参数。这就是我所做的：

```
typedef IloArray<IloNumArray> NumMatrix;
typedef IloArray<IloBoolVarArray> BoolVarMatrix;

NumMatrix ystar(env,I);
for(IloInt i = 0; i < I; i++){
    ystar[i] = IloNumArray(env, T);
}

BoolVarMatrix y(env,I);
for(IloInt i = 0; i < I; i++){
    y[i] = IloBoolVarArray(env, T);
}

for(IloInt i = 0; i < I; i++)
    cplex_master.getValues(ystar[i],y[i]); 
```

但显然`getValues()`只适用于`IloNumVarArray`. 我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T00:19:53.997

猜猜比赛时间！:-) 我只是猜测那`cplex_master`是 type `IloCplex`。

您有两个新初始化的二维矩阵，一个是“布尔变量”，另一个是“非可变浮点数”。看起来您想要求解中的布尔变量`y`并将结果表示为 中的浮点数`ystar`。

1.  我不确定将空白矩阵相互解决会完成什么，所以我会假装它们在您的实际代码中不是空白的

2.  我不知道您的方案是将布尔矩阵逐行转换为浮点数，但也许这在某种程度上是合法的

无论如何，`IloCplex`提供了四个变体`getValues()`，所有这些变体似乎都在它命名为*var*和*val*的两个参数上运行：

```
public void getValues(const IloIntVarArray var, IloNumArray val) const
public void getValues(IloNumArray val, const IloIntVarArray var) const
public void getValues(const IloNumVarArray var, IloNumArray val) const
public void getValues(IloNumArray val, const IloNumVarArray var) const 
```

他们都有类似的文档，其效果是：

> 此方法将数组 var 指定的整数变量的解值放入数组 val 中。数组 val 被调整为与数组 var 相同的大小，并且 val[i] 将包含变量 var[i] 的解值。

有一个不寻常的设计选择，因为*val*正在被修改，尽管它是按值传递的。这是非常非 C++ 风格的。例如，如果您正在处理整数，并编写如下代码：

```
void myCopy(const int source, int destination) {
    /* what could go here? */
}

void someFunction() {
   int a = 10;
   int b;
   myCopy(a, b);
} 
```

...无法`myCopy()`使用该原型编写例程。目的地是按值传递的，因此`myCopy()`无法返回并更改`b`调用者中的值。正确的 C++ 将通过使用指针或引用（通过`&`）来做到这一点：

```
void myCopy(const int source, int& destination) {
    destination = source;
} 
```

所以这个 CPLEX C++ 事情在后台使用了某种技巧，我假设通过那个神秘的`env`参数......以另一种方式做事。当人们编写奇怪的语言包装器并且不知道习语时，它会遭受典型情况的困扰。另一个帖子在这里非常重要：

[只是我还是 Cplex Concert API 可以使用一些改进？](https://stackoverflow.com/questions/3443195/is-it-just-me-or-could-the-cplex-concert-api-use-some-improvements)

您的问题可能是为什么`IloCplex`不将`IloBoolVarArray`a 作为*var*和`IloNumArray` *val*`IloIntVarArray` ，而将 a作为*var*和`IloNumArray` *val*会很高兴。毕竟`IloBoolVarArray`继承自`IloIntVarArray`……不应该可以在同一个slot中使用吗？

但是该方法的这些按值传递语义`getValue()`抑制了本来可以起作用的自然继承。通过指针或引用传递时，您只能传递派生类来代替基类。所以不要继续这个。

如果您真的想使用 an`IloBoolVarArray`而不是 an `IloIntVarArray`，那么我猜您必须经过一个中间环节：

```
typedef IloArray<IloNumArray> NumMatrix;
typedef IloArray<IloBoolVarArray> BoolVarMatrix;
typedef IloArray<IloIntVarArray> IntVarMatrix;

NumMatrix ystar(env,I);
for(IloInt i = 0; i < I; i++){
    ystar[i] = IloNumArray(env, T);
}

BoolVarMatrix y(env,I);
for(IloInt i = 0; i < I; i++){
    y[i] = IloBoolVarArray(env, T);
}

IntVarMatrix yint(env,I);
for(IloInt i = 0; i < I; i++){
    for(IloInt t = 0; t < T; t++) {
        yint[i][t] = y[i][t];
    }
}

for(IloInt i = 0; i < I; i++)
    cplex_master.getValues(ystar[i],yint[i]); 
```

真正的问题可能是使用`IloBool`vs.`IloInt`是否真的值得。这看起来像是事后的想法：

> 此类型定义表示 Concert Technology 中的布尔值。这些值是 IloTrue 和 IloFalse。事实上，布尔值是 IloInt 类型的整数。IloFalse 为 0（零），IloTrue 为 1（一）。此类型预期为标准 C++ 建议的内置 bool 类型。通过使用这种类型，您可以确保应用程序的 Concert Technology 组件将在这方面进行移植，而无需跨不同硬件平台更改源代码。

数组似乎在求解器中没有一流的处理，但单个变量可以：

> IloBoolVar 的实例由 IloSolver 提取（在 ILOG Solver Reference Manual 中记录）作为 IlcBoolVar 类的实例（也在 ILOG Solver Reference Manual 中记录）。
> 
> IloBoolVar 的一个实例由 IloCplex 提取（记录在 ILOG CPLEX 参考手册中）作为表示 Bool 类型的数值变量的列，其边界由 IloBoolVar 指定

我想完全避免它是最好的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T03:20:37.837

IloCplex::getValue 可用于任何 IloNumVar。返回值只是一个双精度值，因此您不受 Concert 数据结构的限制。表达式 y[i][t] 为您提供 IloNumVar。

```
 for(IloInt i = 0; i < I; i++)
        for (IloInt t = 0; t < T; ++t)
        ystar[i][t] = cplex_master.getValue(y[i][t]); 
```

# php - Mysql_query 不会发送到数据库

> ID：10324786
> 
> 赞同：0
> 
> 时间：2012-04-25T22:34:21.733
> 
> 标签：php, mysql, send

我正在为一个网站创建一个注册页面。当我提交表单时，数据不会发送到数据库。有谁知道为什么会这样？以下代码来自名为 register.php 的脚本我不明白为什么它不会发送到我的 mysql 数据库。昨晚我遇到了一个错误“phpMyAdmin - 错误无法在没有错误的情况下启动会话，请检查您的 PHP 和/或网络服务器日志文件中给出的错误并正确配置您的 PHP 安装。” 但现在它的工作。会不会是从那里来的？

```
<?php
echo "<h1>Register</h1>";

$submit = filter_input(INPUT_POST, 'submit');
//form data
$fullname = strip_tags (filter_input(INPUT_POST, 'fullname'));
$username = strtolower(strip_tags (filter_input(INPUT_POST, 'username')));
$password = strip_tags(filter_input(INPUT_POST, 'password'));
$repeatpassword = strip_tags(filter_input(INPUT_POST, 'repeatpassword'));
$date = date("Y-m-d");

if ($submit)
{
//open database
$connect=mysql_connect("localhost","root","mypasswordwouldgohere");
mysql_select_db("phplogin");

$namecheck = mysql_query("SELECT username FROM users WHERE username='$username'" );
$count = mysql_num_rows($namecheck);

if($count!=0)
{
die("Username already taken, please choose another");
}

//check for existence
if($fullname&&$username&&$password&&$repeatpassword)
{
    if ($password==$repeatpassword)
    {
    //check char length of username and fullname
        if (strlen($username)>25||strlen($fullname)>25)
        {
        echo "Length of username or full name is too long!";
        }
        else
        {
        //check password length 
            if (strlen ($password)>25 || strlen ($password)<6)
            {
            echo "Password must be between 6 and 25 characters";
            }
            else
            {
            $password = md5($password);
            //register user 

            $queryreg = mysql_query("INSERT INTO users VALUES           ('','$fullname','$username','$password','$date',)");
            die ("You have been registered! <a href='index.php'>Return  to the login page</a>");

            }   
        }   
    }
    else echo "Your passwords do not match";
}
else echo "Please fill in <b>all</b> fields!";

}

?>
<p>
<html>

<form action='register.php' method='POST'>
<table>
    <tr>
        <td>
        Your full name:
        </td>
        <td>
        <input type='text' name='fullname' value='<?php echo $fullname;?>'>
        </td>

    </tr>

    <tr>
        <td>
        choose a username:
        </td>
        <td>
        <input type='text' name='username' value='<?php echo $username;?>'>
        </td>

    </tr>

    <tr>
        <td>
        Choose a password:
        </td> 
        <td>
        <input type='password' name='password'>
        </td>

    </tr>

    <tr>
        <td>
        Repeat your password:
        </td> 
        <td>
        <input type='password' name='repeatpassword'>
        </td>
    </tr>

<table>
<p>
<input type='submit' name='submit' value='Register'>

</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:49:05.280

这里有 SQL 语法错误`"INSERT INTO users VALUES ('','$fullname','$username','$password','$date',)"`。删除查询中的最后一个“，”。

# java - Spring 3 PropertyEditorSupport setAsText 未为客体化客户编辑器调用

> ID：10324806
> 
> 赞同：0
> 
> 时间：2012-04-25T22:36:18.440
> 
> 标签：java, spring, google-app-engine, spring-mvc, objectify

我正在使用 spring，并且我有一个带有 objectify 关键对象的子模型 - “Key parent”

加载表单时 getAsText 打印正常，但是当表单提交时， setAsText 被跳过。任何原因？当它到达控制器时 parentType 是空的。是表单问题还是控制器还是编辑器？

（旁道：是否有为 Objectify Key <-> String 映射编写的编辑器？）

jsp

```
<form:hidden path="parentType"  /> 
```

控制器

```
 @InitBinder
    protected void initBinder(HttpServletRequest request,
            ServletRequestDataBinder binder) throws Exception {

        /** Key Conversion **/
        binder.registerCustomEditor(com.googlecode.objectify.Key.class,  new KeyEditor());
}
@RequestMapping(value = "/subtype-formsubmit", method = RequestMethod.POST)
    public ModelAndView subTypeFormSubmit(@ModelAttribute("productSubType") @Valid ProductSubType productSubType,
            BindingResult result){
        ModelAndView mav = new ModelAndView();

        //OK, getting the value
        log.info(productSubType.getType()); 

            //NOT OK, productSubType.getParentType() always null, and setAsText is not called?!
        log.info(productSubType.getParentType().toString()); 

        return mav;
    } 
```

KeyEditor.java

```
public class KeyEditor extends PropertyEditorSupport {

private static final Logger log = Logger
        .getLogger(KeyEditor.class.getName());

public KeyEditor(){
    super();
}

@Override
public String getAsText() {
    Long id = ((Key) getValue()).getId();
    String kind = ((Key) getValue()).getKind();
    log.info(kind + "." + id.toString());
    return kind + "." + id.toString();
}

@Override
public void setAsText(String text) throws IllegalArgumentException {
    log.info(text);
    String clazz = text.substring(0, text.indexOf("."));
    Long id = Long.parseLong(text.substring(text.indexOf(".")));
    log.info(clazz+":"+id);
    Class c=null;
    Key<?> key=null;
    try {
        c = Class.forName(clazz);
        key = new Key(c, id);
    } catch (Exception ex) {
        log.info("ex" + ex.toString());
        ex.printStackTrace();
    }

    setValue(key);
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T13:18:30.387

您需要`Class.forName`使用完整的类名进行调用，包括包。

我认为`Key#getKind()`返回没有包的简单类名。另外`text.substring(0, text.indexOf("."));`（在 setAsText 中）告诉我 没有点`clazz`，所以你没有提供正确的输入`Class.forName`

选项：

*   如果您的所有类都在同一个包中，那么只需将其添加到`clazz`（不是一个非常强大的解决方案）
*   由于无论如何您都必须注册所有实体 ( `ObjectifyService.register(YourEntity.class);`)，因此您可以同时创建从 kind 到完整类名的映射，然后在`setAsText`.

但可能有更好的选择...

# java - 如何在 Java（和其他）中决定“FI”的连字

> ID：10324807
> 
> 赞同：5
> 
> 时间：2012-04-25T22:36:26.287
> 
> 标签：java, pdf, character-encoding, ligature

我们有一个系统可以解析 PDF 文件并提取其中的文本以进行索引等。我们遇到的一个问题是 Illustrator 设置包含“fi”的单词以使用 fi 的连字（单个字形）。

例如这条线...

“长凳和丰富的玻璃化瓷砖。”

在我的 Java 调试器中显示如下

“ete 长凳和丰富的 vitri\u001Fed 瓷砖。”

\u001F 似乎是 Adob​​e PDF 文件用于连字“fi”的字符代码。我显然可以将 \u001F 的出现换成“fi”，但有人知道处理这种情况和类似情况的可靠方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T06:39:23.477

在 PDF（TJ、Tj 等）中用作“显示文本”运算符的操作数的字节序列应使用图形状态下活动字体的编码和与该字体关联的 ToUnicode cmap 转换为文本。一些字体包括一个 ToUnicode cmap，它将 0x001F 代码（或它用于字形的任何代码）映射到字符“f”和“l”。其他字体使用带有 /Differences 数组的编码，该数组将代码 0x1F 映射到字符 /fl。必须处理这些结构以获得正确的结果。

# javascript - Jquery UI，在恢复可拖动时使用线性而不是摆动？

> ID：10324811
> 
> 赞同：1
> 
> 时间：2012-04-25T22:36:38.397
> 
> 标签：javascript, jquery, html, css, jquery-ui

我正在使用 Jquery UI 的可拖动对象，并启用了还原功能。

默认情况下，div 以“摇摆”运动恢复，

我想知道如何使 div 以线性运动恢复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T14:12:48.217

您不能在可拖动对象上使用常规 revert 方法来获得自定义返回缓动，因为它只支持更改持续时间。如果要使还原具有自定义效果，则需要如下一些自定义代码，并插入来自 JQueryUI 展示[http://jqueryui.com/demos/effect/#easing](http://jqueryui.com/demos/effect/#easing)的任何自定义缓动效果。

请注意，在 stop 方法中，我将缓动效果设为 easeInElastic 以突出差异，但您可以将其更改为您想要的任何内容（在您的情况下为线性）。

请注意，您需要包含 JQuery UI 才能获得这些效果。

[http://jsfiddle.net/gregjuva/Hjf8p/](http://jsfiddle.net/gregjuva/Hjf8p/)

```
$(function() {
$("#draggable").draggable({
    // We Can't use revert, as we animate the original object so
    //revert: true,  <- don't use this

    helper: function(){
        // Create an invisible div as the helper. It will move and
        // follow the cursor as usual.
        return $('<div></div>').css('opacity',0);
    },
    create: function(){
        // When the draggable is created, save its starting
        // position into a data attribute, so we know where we
        // need to revert to.

        // cache $this to keep from having to make 
        // lots of DOM calls w jquery
        var $this = $(this); 
        $this.data('starttop',$this.position().top)
             .data('startleft',$this.position().left);
    },
    stop: function(){
        // When dragging stops, revert the draggable to its
        // original starting position.
        var $this = $(this);
        $this.stop().animate({
            top: $this.data('starttop'),
            left:$this.data('startleft')
        },1000,'easeInElastic'); 
        // replace with whatever jQueryUI easing you want
    },
    drag: function(event, ui){
        // During dragging, animate the original object to
        // follow the invisible helper with custom easing.
        $(this).stop().animate({
            top: ui.helper.position().top,
            left: ui.helper.position().left
        },0,'linear');
    }
   });
 });​ 
```

# c++ - 带有此指针的初始化列表

> ID：10324813
> 
> 赞同：2
> 
> 时间：2012-04-25T22:36:44.560
> 
> 标签：c++, constructor

在这里糊涂了。即使传入`this`初始化列表，程序也正在编译并成功运行。我的印象是，在传递`this`到这里时，编译器应该给出一些错误，因为这里没有创建对象。

两个`cout`s的输出是一样的；即他们持有相同的地址。

我知道这不是正确的编程方法，但这里到底发生了什么？

```
 class foo
    {
            public:
            foo():myself( this ) {}
            foo * myself;
    };

    int main()
    {
            foo f;
            cout<<f.myself<<endl;   
            cout<<&f<<endl;
            return 0;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:38:30.483

即使对象还没有完全初始化，它的地址是已知的并且可以分配给一个指针。

虽然这个习语并不常见，但我可以看到它被用于例如链表的初始化。

# c++ - 使用向量和 fstream 的代码中的 Segfault 11？C++

> ID：10324817
> 
> 赞同：0
> 
> 时间：2012-04-25T22:37:11.560
> 
> 标签：c++, vector, segmentation-fault, fstream

我正在尝试编写一个将 txt 文件作为输入的程序，并使用文本文件中单词中的 ques 来生成一个 .h 文件（希望以后再生成一个 .cpp 文件）。这段代码编译得很好，只是它在获取输入文件后会出现 11 段错误。有人可以帮帮我吗？

```
#include <iostream>
#include <fstream>
#include "12337756_Library.cpp"
#include <string>
#include <vector>

using namespace std;

int main()
{
    bool a;
    string filename;
    string line;
    vector<string> Attr;

    cout << "Enter input file name:";
    getline(cin, filename);

    ifstream fin(filename.c_str());

    if (fin)
    {
        while(!fin.eof())
        {
            getline(fin, line);
            createNewFile(line);
            Attr.push_back(line); 
        }
        if(Attr[1]=="Movie.h")
        {
            bool x,y;
            //x=createNewFile(Attr[0]);
            y=createNewFile(Attr[1]);
            if(x)
            {
                ofstream fout(Attr[1].c_str());
                fout << "#ifndef HEADER_H_" << endl << "#define HEADER_H_" << endl;
                fout << "#include <iostream>" << endl << "#include <vector>" << endl;
                fout << "using namespace std;" << endl;
                fout << "enum Movie_Rating {G,PG,PG13,R,NC17,NR} ;" << endl;
                fout << endl << endl << endl;
                fout << "class Movie" << endl << "{"<< endl;
                fout << "public: " << endl;
                fout << "// ------------------------------------------------------" << endl;
                fout << "// ----- Constructors -----------------------------------" << endl;
                fout << "// ------------------------------------------------------" << endl;
                fout << endl << "Movie();" << endl << "Movie(const string& title);" << endl;
                fout << "Movie(const string& title, const string& director, Movie_Rating rating,unsigned int year,const string& path,const string& actor); " << endl;
                fout << endl;
                fout << "// ------------------------------------------------------" << endl;
                fout << "// ----- Destructor -------------------------------------" << endl;
                fout << "// ------------------------------------------------------" << endl;
                fout << endl;
                fout << "~Movie();" << endl << endl;
                fout << "// ------------------------------------------------------" << endl;
                fout << "// ----- Inspectors -------------------------------------" << endl;
                fout << "// ------------------------------------------------------" << endl;
                fout << endl;
                fout << "string getTitle() const;" << endl;
                fout << "string getDirector() const;" << endl;
                fout << "Movie_Rating getRating() const ;" << endl;
                fout << "unsigned int getYear() const ;" << endl;
                fout << "string getURL() const ;" << endl;
                fout << "string getActor(unsigned int i) const ;" << endl;
                fout << "int getActorNumber() const ;" << endl;
                fout << endl;
                fout << "// ------------------------------------------------------" << endl;
                fout << "// ----- Mutators ---------------------------------------" << endl;
                fout << "// ------------------------------------------------------" << endl;
                fout << endl;
                fout << "void setTitle(const string& title);" << endl;
                fout << "void setDirector(const string& director) ;" << endl;
                fout << "void setRating(Movie_Rating rating)  ;" << endl;
                fout << "void setYear(unsigned int year)  ;" << endl;
                fout << "void setURL(const string& path)  ;" << endl;
                fout << "void setActor(const string& actor);" << endl;
                fout << endl;
                fout << "//-----------------------------------------------------------" << endl;
                fout << "//------- Facilitators --------------------------------------" << endl;
                fout << "//-----------------------------------------------------------" << endl;
                fout << "void output(ostream & out);" << endl;
                fout <<"// ----------------------------------------------------------" << endl;
                fout <<"// ----------------------------------------------------------" << endl;
                int size = Attr.size();

                while(size!= 1)
                {
                    fout << Attr[size] << endl;
                    size--;
                }
                fout << "};" << endl;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:48:05.627

您只推回了一个`std::string`，因此您的向量仅包含 1 个元素。要访问该元素，请使用`Attr[0]`not `Attr[1]`（在代码中有几个地方可以这样做）。请记住，在 C++ 中，索引开始于`0`而不是`1`.

此外，在下面的代码中`size()`返回`1`，因此永远不会进入 while 循环。

```
int size = Attr.size();

while(size!= 1)
{
    fout << Attr[size] << endl;
    size--;
} 
```

# ruby-on-rails - Ruby on Rails 3.2 教程第 11 章中的 SQL 插值错误？

> ID：10324821
> 
> 赞同：0
> 
> 时间：2012-04-25T22:37:48.050
> 
> 标签：ruby-on-rails, railstutorial.org

Ruby on Rails 教程的作者说他很高兴收到文本中的错误报告，但随后他立即继续说他并不真正期望有任何错误，所以请不要直接向他报告。不过，我相信我可能已经发现了这样的错误。在教程 3.2 版本的代码清单 11.44 中定义了以下方法：

```
 def self.from_users_followed_by(user)
    followed_user_ids = user.followed_user_ids.join(', ')
    where("user_id IN (?) OR user_id = ?", followed_user_ids, user)
  end 
```

该方法的第一行通过调用 join() 生成一个字符串。第二行将该字符串插入 SQL WHERE 子句的 IN 部分括号内的占位符。我没有使用默认的 SQLite 驱动程序对此进行测试，因为我按照作者的说明进行了高级练习，并切换到 PostgreSQL 进行测试和开发环境。使用 PostgreSQL 驱动程序，占位符替换机制检测到该占位符的替换变量是一个字符串值，并插入带有单引号的值，SQL 期望该值用于字符串值。因此，生成的 WHERE 子句显示为“`WHERE user_id IN ('...') OR ...`.” user_id 列是一个 INT 列，因此它被拒绝（至少在 PostgreSQL 中是这样）。该问题稍后在文本中通过使用子查询的方法的变体实现来消除，但作者在添加了上面引用的失败代码，测试套件中的所有验证都应该通过。

如果作者正在监视此论坛以获取有关本教程的错误报告，那么很高兴得到确认这是否确实是错误的响应，甚至可能已对其进行更正。:-)

谢谢！

[PS：作者在这里指导读者报告错误，使用标签“ruby-on-rails”和“tutorials”，但SO不允许使用“tutorials”标签。]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:02:37.793

为了解决这个问题，您可以使用：

```
 def self.from_users_followed_by(user)
    followed_user_ids = user.followed_user_ids
    where((['user_id = ?'] * followed_user_ids.size).join(' OR '), *followed_user_ids)
  end 
```

这将构造一个查询，其中有许多`user_id = ? OR`s 取决于数组的大小，并将传入 postgreSQL 应该乐于容纳的 int 。

# powershell - 此 XML 管道中的空项是什么？

> ID：10324824
> 
> 赞同：2
> 
> 时间：2012-04-25T22:38:10.053
> 
> 标签：powershell

考虑以下 XML 文档：

```
$xml = [xml] "<root><value>one</value><value>two</value></root>" 
```

然后打印值（带有一些前缀/后缀）：

```
$xml.root.value | %{"*$_*"}
*one*
*two* 
```

到现在为止还挺好。但是，如果该元素不存在，则会通过管道传播一个空项：

```
$xml.root.foo | %{"*$_*"}
** 
```

这是为什么？有什么办法可以避免这种额外的检查：

```
$xml.root.foo | ?{$_} | %{"*$_*"} 
```

这很容易忘记，而且似乎容易出错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:56:07.270

要关闭缺少属性的静默失败，请使用`Set-StrictMode -Version Latest`例如：

```
PS> $xml = [xml] "<root><value>one</value><value>two</value></root>"
PS> $xml.root.foo | %{"*$_*"}
**
PS> Set-StrictMode -Version Latest
PS> $xml.root.foo | %{"*$_*"}
Property 'foo' cannot be found on this object. Make sure that it exists.
At line:1 char:1
+ $xml.root.foo | %{"*$_*"}
+ ~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], PropertyNotFoundException
    + FullyQualifiedErrorId : PropertyNotFoundStrict 
```

请注意，这还将捕获对不存在变量的引用。我强烈建议`Set-StrictMode`以这种方式使用，因为它可以节省您调试较大脚本的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-05T03:58:51.563

基思是对的，你得到了一个静默错误，它允许空元素沿管道传播。我也是在***StrictMode中编写******PowerShell***脚本的坚定倡导者。

 *这是我对您的问题的解决方案（将在启用***StrictMode***的情况下工作）。

如果您对***$xml进行快速******Get-Member***操作，您将看到它的类型为[System.Xml.XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)（随后元素的类型为***System.Xml.XmlElement***）。使用***SelectNodes***函数，我们可以获得给定***XPath的******XmlNodeList***。所以上面的示例文件可以写成如下：

 ***```
$xml.SelectNodes("//root/value")  | % {"*" + $_.'#text'+ "*"} 
```

这将为您提供所需的输出。

```
*one*
*two* 
```

如果我们开始寻找不存在的节点：

```
$xml.SelectNodes("//root/value")  | % {"*" + $_.'#text'+ "*"} 
```

正如预期的那样，您不会得到任何响应。****

# algorithm - 如何从 T(n) = 2T(n/2) + O(n) 得到 O(nlogn)

> ID：10324830
> 
> 赞同：6
> 
> 时间：2012-04-25T22:38:51.250
> 
> 标签：algorithm, big-o

我想在`O(n log(n))`不使用主定理的情况下进行计算。

有谁知道`O(n log(n))`从递归公式计算的数学方法`T(n) = 2T(n/2) + O(n)`？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-25T22:56:36.760

注意模式（简化一点，最好保留`O(n)`而不是`n`）：

```
T(n) = 2T(n/2) + n
     = 2(2T(n/4) + n/2) + n  = 4T(n/4) + n + n  = 4T(n/4) + 2n
     = 4(2T(n/8) + n/4) + 2n = 8T(n/8) + n + 2n = 8T(n/8) + 3n
     = 8(2T(n/16) + n/8)+ 3n = 8T(n/16)+ n + 3n = 16T(n/16) + 4n
     ...                                        = 32T(n/32) + 5n
     ...
                                                = n*T(1) + log2(n)*n
                                                = O(n*log2(n)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T22:44:51.710

绘制递归树：

树的高度将为 log n

每个级别的成本将是常数倍 n

因此，总成本将为 O(nlogn)。[http://homepages.ius.edu/rwisman/C455/html/notes/Chapter4/RecursionTree.htm](http://homepages.ius.edu/rwisman/C455/html/notes/Chapter4/RecursionTree.htm)

如果你愿意，你总是可以通过归纳来证明它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-03T16:47:06.207

对于仍在弄清楚如何绘制递归树的任何人：

图片：T(n) = 2T(n/2) + O(n) 算法的递归树

如下图绘制一棵树，我们可以看到每次我们除以 2 直到我们的叶子等于 1

```
n/2^k = 1 
2^k = n 
k= log(n) 
```

上述陈述证明我们的树的深度为**log(n)**。

在每个级别上，我们都进行了花费 O(n) 的操作。

即使我们每次除以 2，我们仍然对这两个部分进行操作，因此我们在每个级别都有**n次迭代。**

由于我们执行它的次数等于我们的深度，因此产生的复杂度是**O(nlog(n))**。

[![在此处输入图像描述](../Images/17ecb0b49bcb55a390cd26c573f70414.png)](https://i.stack.imgur.com/IJuYt.png)

另外，请查看此视频教程[https://youtu.be/1K9ebQJosvo](https://youtu.be/1K9ebQJosvo)

# c# - jQuery ui 聊天插件-如何引导（需要）

> ID：10324833
> 
> 赞同：0
> 
> 时间：2012-04-25T22:39:28.533
> 
> 标签：c#, asp.net, jquery-ui, chat

我（有点）实现了一个我在网上找到的 jQuery ui 聊天插件[https://github.com/dexterpu/jquery.ui.chatbox](https://github.com/dexterpu/jquery.ui.chatbox)

我的网页上有一个按钮可以切换聊天框，用户可以输入一些文本，按 Enter 键，该文本将与他们的用户名一起显示在**他们的**聊天框中。

这一切都很好，但与自己聊天并不好玩。我将如何在两个用户之间传递输入到文本框中的数据 - 我希望用户从列表框中选择另一个用户（已登录用户），单击聊天按钮，这两个用户将被（*拖动*）在（到）同一个聊天框。或者我如何让所有登录用户全局可见所有聊天数据（每个登录用户都会看到所有其他用户在他们自己的聊天框中输入的所有消息）？

一些正确方向的指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:14:22.040

你看过 SignalR 吗？

Scott Hanselman 的团队正在研究它。

> SignalR 是一个用于 ASP.NET 的异步信号库，我们的团队正在努力帮助构建实时多用户 Web 应用程序。

使用代码示例链接到 Scott 的博客文章： [具有 SignalR 的实时持久长期运行连接的异步可扩展 Web 应用程序](http://www.hanselman.com/blog/AsynchronousScalableWebApplicationsWithRealtimePersistentLongrunningConnectionsWithSignalR.aspx)

[您可以使用NuGet](http://www.nuget.org/)将其拉下来，或者这里是 github：[https ://github.com/SignalR/SignalR](https://github.com/SignalR/SignalR)

# android - 找不到资源：res/drawable/list_selector_background.xml？

> ID：10324834
> 
> 赞同：1
> 
> 时间：2012-04-25T22:39:32.140
> 
> 标签：android, android-preferences, android-resources

我最近发布了我的第一个应用程序。仅在 SDK 模拟器和 Galaxy S2 上进行了测试，我收到的关于它运行的设备的反馈非常好。

不幸的是，我有几个用户向我报告了 FC。他们之间的共同点是他们都是 MIUI 用户（不同的设备 IIRC）。

一个在提供信息和尝试示例构建以解决问题方面非常有帮助，但我似乎无法在这方面取得任何进展。

我在网上搜索得相当广泛。尽管我找到了有类似报告的人，但我没有任何东西可以帮助解决我所看到的这个特殊情况。

**问题+注释：**

*   问题似乎是`res/drawable/list_selector_background.xml`不存在的
*   我没有为列表背景制作自定义资源，也没有在我的代码中引用这个特定资源
*   我正在使用 ActionBarSherlock ( `minSdkVersion == 7`, `targetSdkVersion == 7`, `project build target == 15`)
*   `android:theme="@style/Theme.Sherlock.Dialog"`加载首选项活动（清单中确实有）时发生崩溃
*   **通过相同方法加载另一个首选项活动时不会**发生崩溃（使用活动类启动意图）

**以供参考：**

*   [原始错误报告](http://pastebin.com/269v1qFG)，以及
*   [他们的 logcat 输出](http://pastebin.com/FSwtLDuJ)

最让我困惑的是，当它是原始首选项 XML 中的子项时，我在此首选项活动中显示的特定设置将起作用`<PreferenceScreen>`（我将首选项列表分开，因为它对用户更友好）。

**编辑：**应该注意，这是一个空`<PreferenceScreen>`的，通过代码填写；当它在一个单一的时它仍然有效`PreferenceActivity`。

以下是我开始有效的偏好活动的方式：

```
Intent intent = new Intent(this, PreferencesActivity.class);
startActivity(intent); 
```

这就是我开始失败的偏好活动的方式：

```
Intent subredditsIntent = new Intent(MainTabs.this, SubredditPreferencesActivity.class);
startActivity(subredditsIntent); 
```

**我刚刚注意到我`MainTabs.this`在第二个中**使用，可能是由于从嵌套对话框类中复制它；当然这不是原因，因为它在从对话框中调用时也会崩溃？

这似乎仅限于 MIUI 设备，但我无法 100% 肯定地确认。有其他人经历过吗？

任何想法将不胜感激！

谢谢

*   D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T14:08:01.073

我设法为乐于助人的 MIUI 用户建立了“最后的把握”。我所做的唯一更改是`android:theme="@style/Theme.Sherlock.Dialog"`从清单中的活动定义中删除。

这似乎奏效了！

供其他人参考，似乎（此时）将对话框主题用于偏好活动会导致 MIUI 下的 FC。

我还没有测试通过该`onCreate()`方法手动设置主题是否会结束 FCing。

希望这对某人有帮助！

# assembly - 实际的机器代码在各个方面是什么样的？

> ID：10324835
> 
> 赞同：9
> 
> 时间：2012-04-25T22:39:43.277
> 
> 标签：assembly, hex, machine-code, machine-instruction

关于机器代码实际上是什么似乎有很多意见。我听说有人说它是汇编、二进制或十六进制。

说机器代码本质上是特定处理器的一组指令是否正确？如果是这样，我想这些可以用二进制或十六进制表示法或汇编来表示。但是未翻译的“实际”机器代码是什么样的？是基于架构的字长吗？还是所有意图和目的的十六进制都是默认表示？

坐在硬盘上时会是什么样子？坐在登记簿上时是什么样子的？当它被处理时，它只是在那一点上的一组电压变化吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-25T23:05:43.627

机器代码只是对应于特定处理器架构的 CPU 指令的二进制数据。

我不会过多地讨论它是如何存储的，因为这取决于它的存储位置。例如，在磁盘上，它通常存储为一系列磁化区域。机器码在存储方面与其他二进制数据没有什么不同。如果您的问题更多关于数据如何存储在计算机上，您应该研究计算机中的各种数据存储设备，例如 HDD、RAM 和寄存器等。

可视化机器代码如何存储的最简单方法是在十六进制编辑器中查看一些。这向您显示了由十六进制数字表示的二进制数据。例如，接受以下指令：

```
0xEB 0xFE 
```

这可以很容易地写成 1110101111111110 或 60414。这取决于您希望如何将二进制转换为人类可读的形式。

该指令代表一个无限循环。（这是假设它在 x86 CPU 上运行。其他 CPU 可以根据需要对其进行解释。）它可以像这样在汇编中编码：

```
j:
jmp j 
```

当您运行汇编程序时，它会获取上面的代码并将其转换为上面的二进制机器代码。

该指令实际上是两个部分。第一个是所谓的操作码，是`0xEB`. 当这段代码进入 CPU 时，意味着： 从程序中读取一个字节，然后跳过那么多字节的数据。然后 CPU 读取字节`0xFE`。由于它需要一个有符号整数，因此它将二进制数据解释为数字 -2。然后指令被读完，指令指针向前移动 2 个字节。然后执行该指令，使指令指针向前移动 -2 (0xFE) 个字节，这实际上将指令指针设置为与指令启动时相同的值。

我希望这回答了你的问题。如果您想了解 CPU 的内部工作原理，请阅读微码和电子逻辑门。基本上，它是一堆电压差，例如 1 位是 5 伏电荷，0 位是 0 位电荷。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-29T02:11:40.037

像我一样，您似乎对计算机如何在幕后工作感到好奇。我的知识不足以很好地回答您的问题（无论如何这是一个很大的话题），但我强烈推荐 Steve Gibson 的“让我们设计一台计算机”播客系列。这是“机器语言”成绩单的摘录，让您了解一下。. .

> 而所有的跳过方式是，我们不是在程序计数器上加一，而是加二，或者加一两次，这实际上是这些机器当时的工作方式。这只会让我们跳过一个跳跃。所以本质上这意味着我们可以分支到内存中我们想要的任何地方或继续前进，这给了我们，即使这很简单，也给了我们足够的权力让机器做出决定。我们有输入/输出；我们有数学；我们有能力将数据从内存中的一个位置传输到另一个位置。这些都是机器运行方式的所有要素。那就是机器语言。
> 
> 现在，置于其之上的一层人性就是所谓的“汇编语言”，它只不过是命名事物。例如，您为不同的指令创建了一种所谓的助记符。因此，例如，加载累加器将是 LDA。存储累加器 STA。您希望它们简短，因为您将经常输入它们。请记住，您最终会使用大量的小指令来完成某件事。然后，汇编语言唯一真正做的另一件事是，它允许您命名内存中的位置。
> 
> 因此，例如，您可能会说 LDA，对于负载累加器，当前分数。而当前分数只是指一个，本质上就像一个变量，内存中你标记为“当前分数”的位置。然后，如果您进行 STA，存储累加器，新分数，那么它会首先将当前分数加载到累加器中，然后将其存储到称为新分数的不同位置。所以我们真正谈论的就是一些简单的缩写，用于帮助记住和使用这些单独的指令和方便的标签来标记内存中的位置，这样你就不必记住，哦，那是在位置 329627。我的意思是，谁能做到？因此，您只需用英语标记该位置，某种字母数字短语，
> 
> 事实上，你并不关心这个数字是多少。那就是汇编程序将为您做的一件事就是您只是说我需要称为这些东西的内存。它担心他们去哪里，因为只要他们一直被提及，这对你来说并不重要。这就是整个过程。那是机器语言和汇编语言。这就是 50 年前的样子，或多或少就是现在的样子。

. . 但他比这更进一步，从晶体管和逻辑门开始。据我所知，这是完整的系列（听众在 wiki 中提供了有用的图表）：

*   让我们设计一台计算机：晶体管、逻辑门（Security Now 233, 42:00）[http://www.grc.com/sn/sn-233.htm](http://www.grc.com/sn/sn-233.htm)和[http://wiki.twit.tv/wiki/Security_Now_233](http://wiki.twit.tv/wiki/Security_Now_233)
*   机器语言 (Security Now 235, 46:00) [http://www.grc.com/sn/sn-235.htm](http://www.grc.com/sn/sn-235.htm)和[http://wiki.twit.tv/wiki/Security_Now_235](http://wiki.twit.tv/wiki/Security_Now_235)
*   听众反馈（Security Now 236, 51:43）[http://www.grc.com/sn/sn-236.htm](http://www.grc.com/sn/sn-236.htm)和[http://wiki.twit.tv/wiki/Security_Now_236](http://wiki.twit.tv/wiki/Security_Now_236)
*   间接：指针的力量（Security Now 237, 27:45）[http://www.grc.com/sn/sn-237.htm](http://www.grc.com/sn/sn-237.htm)和[http://wiki.twit.tv/wiki/Security_Now_237](http://wiki.twit.tv/wiki/Security_Now_237)
*   听众反馈（Security Now 238, 40:28）[http://www.grc.com/sn/sn-238.htm](http://www.grc.com/sn/sn-238.htm)和[http://wiki.twit.tv/wiki/Security_Now_238](http://wiki.twit.tv/wiki/Security_Now_238)
*   堆栈、寄存器和递归（Security Now 239, 1:01:00）[http://www.grc.com/sn/sn-239.htm](http://www.grc.com/sn/sn-239.htm)和[http://wiki.twit.tv/wiki/Security_Now_239](http://wiki.twit.tv/wiki/Security_Now_239)
*   听众反馈（Security Now 240 48:16、1:01:21）[http://www.grc.com/sn/sn-240.htm](http://www.grc.com/sn/sn-240.htm)和[http://wiki.twit.tv/wiki/Security_Now_240](http://wiki.twit.tv/wiki/Security_Now_240)
*   硬件中断（Security Now 241, 42:25）[http://www.grc.com/sn/sn-241.htm](http://www.grc.com/sn/sn-241.htm)和[http://wiki.twit.tv/wiki/Security_Now_241](http://wiki.twit.tv/wiki/Security_Now_241)
*   听众反馈（Security Now 242, 59:27）[http://www.grc.com/sn/sn-242.htm](http://www.grc.com/sn/sn-242.htm)和[http://wiki.twit.tv/wiki/Security_Now_242](http://wiki.twit.tv/wiki/Security_Now_242)
*   多元宇宙：多线程、多任务、多处理、多核（Security Now 247, 47:15）[http://www.grc.com/sn/sn-247.htm](http://www.grc.com/sn/sn-247.htm)和[http://wiki .twit.tv/wiki/Security_Now_247](http://wiki.twit.tv/wiki/Security_Now_247)
*   听众反馈（Security Now 249, 1:30:21）[http://www.grc.com/sn/sn-249.htm](http://www.grc.com/sn/sn-249.htm)和[http://wiki.twit.tv/wiki/Security_Now_249](http://wiki.twit.tv/wiki/Security_Now_249)
*   操作系统（Security Now 250, 43:22）[http://www.grc.com/sn/sn-250.htm](http://www.grc.com/sn/sn-250.htm)和[http://wiki.twit.tv/wiki/Security_Now_250](http://wiki.twit.tv/wiki/Security_Now_250)
*   听众反馈（Security Now 251, 1:00:22）[http://www.grc.com/sn/sn-251.htm](http://www.grc.com/sn/sn-251.htm)和[http://wiki.twit.tv/wiki/Security_Now_251](http://wiki.twit.tv/wiki/Security_Now_251)
*   RISC 与 CISC（Security Now 252, 53:31）[http://www.grc.com/sn/sn-252.htm](http://www.grc.com/sn/sn-252.htm)和[http://wiki.twit.tv/wiki/Security_Now_252](http://wiki.twit.tv/wiki/Security_Now_252)
*   听众反馈（Security Now 253, 50:38）[http://www.grc.com/sn/sn-253.htm](http://www.grc.com/sn/sn-253.htm)和[http://wiki.twit.tv/wiki/Security_Now_253](http://wiki.twit.tv/wiki/Security_Now_253)
*   我们将为速度做些什么：流水线、分支预测（Security Now 254、29:30）[http://www.grc.com/sn/sn-254.htm](http://www.grc.com/sn/sn-254.htm)和[http://wiki.twit.tv/wiki /Security_Now_254](http://wiki.twit.tv/wiki/Security_Now_254)

如果有人对史蒂夫在这些剧集中所说的任何内容提出异议，提供反馈的最佳位置是[http://www.grc.com/feedback.htm](http://www.grc.com/feedback.htm)或[http://www.grc.com/discussions.htm](http://www.grc.com/discussions.htm)或[https:/ /twitter.com/SGgrc](https://twitter.com/SGgrc)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-25T23:23:15.553

**为初学者解释**

从一开始，计算机就有很多“开关”。例如，可以关闭
或打开 LED 灯，只有 2 个选项（1=打开或 0=关闭）。如果您有 2 个 LED，您可以关闭 LED 1 并打开 LED
2，反之亦然，或者您可以同时打开或关闭它们。现在有更多的可能性。

你可以计算出有多少种不同的可能性。
1 盏灯 = 2^ **1** = 2 种可能性
2 盏灯 = 2^ **2** = 4 种可能性
8 盏灯 = 2^ **8** = 256 种可能性

所以计算机只读取零和一。一台计算机有很多开关，具体取决于 CPU 容量。要告诉计算机激活灯，您需要在系统中添加 0 和 1，这将是一项非常艰巨的任务。为了避免这种情况，他们将可能性转换为十六进制数。汇编只是一种计算机语言，它将您键入的字母转换为 0 和 1（二进制代码）并按照说明进行操作。

# mysql - Mysql - 插入带有空格的字符串

> ID：10324836
> 
> 赞同：1
> 
> 时间：2012-04-25T22:39:47.627
> 
> 标签：mysql

如何在 VARCHAR 中插入带有空格的字符串？

```
insert into users (user_id,firstname,lastname,email,group) values('admin','some','Body','admin@something.com','Site admin'); 
```

这给了我语法错误，我是 mysql 新手，我浏览了 mysql 文档，但没有让我清楚地知道为什么会出现这种行为。

```
 mysql> insert into users (user_id,firstname,lastname,email,group) values('admin','some','Body','admin@something.com','Site admin');
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'group) values('admin','some','Body','admin@something.com','Site admin')' at line 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T22:59:21.190

`group`是 MySQL 中的关键字。像这样修改您的查询：

```
INSERT INTO users (user_id, firstname, lastname, email, `group`)
VALUES('admin', 'some', 'Body', 'admin@something.com', 'Site admin'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T22:58:56.773

组是一个关键字，您需要使用像这样的“组”这样的反引号来创建它，以便将组读取为表格列

```
INSERT into users (user_id,firstname,lastname,email,`group`)
VALUES ('admin','some','Body','admin@something.com','Site admin'); 
```

# jquery - Slider : 如何设置右侧“输入框”的位置？

> ID：10324839
> 
> 赞同：-2
> 
> 时间：2012-04-25T22:40:04.583
> 
> 标签：jquery, jquery-mobile

如何更改css文件中“.ui-slider-input”的位置？.....

示例，在 jquery mobile CSS 中

```
input.ui-slider-input,
.ui-field-contain input.ui-slider-input { display: inline-block;  width: 50px; position:   relative; } 
```

我已经尝试了很多：

[http://jsfiddle.net/EWQ6n/26/](http://jsfiddle.net/EWQ6n/26/)

非常感谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T11:38:44.940

可以使用 float: 'right'，感谢 Bill ！

例如在 jquery mobile 中，

jquerymobile.css，第 2037 行：

```
input.ui-slider-input, .ui-field-contain input.ui-slider-input { display: inline- block;**float: right;** width: 50px; position: relative; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:47:19.057

交换它们的一种方法是将输入框浮动到右侧。您可能需要调整其他属性以使其看起来像您想要的那样。

```
$('input[name="slider"]').css('float', 'right'); 
```

# .net - 通过 linq 表达式从被覆盖的属性中获取属性

> ID：10324842
> 
> 赞同：6
> 
> 时间：2012-04-25T22:40:22.330
> 
> 标签：.net, linq-expressions, getcustomattributes

我正在尝试使用`GetCustomAttributes()`来获取在属性上定义的属性。问题是该属性是一个被覆盖的属性，我无法弄清楚如何从表达式中提取被覆盖的属性。我只能弄清楚如何获得基类的。

这是一些代码

```
public class MyAttribute : Attribute 
{
  //... 
}

public abstract class Text
{
  public abstract string Content {get; set;}
}

public class Abstract : Text
{
  [MyAttribute("Some Info")]
  public override string Content {get; set;}
} 
```

现在我正试图`MyAttribute`摆脱抽象类。但我需要通过`Expression`. 这是我一直在使用的：

```
Expression<Func<Abstract, string>> expression =  c => c.Content;
Expression exp = expression.Body;
MemberInfo memberType = (exp as MemberExpression).Member;

var attrs = Attribute.GetCustomAttributes(memberType, true); 
```

不幸的是`atts`，最终是空的。问题是`menberType`最终是 for`Text.Content`而不是`Abstract.Content`类。所以当我得到属性时，它什么也不返回。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T05:52:01.793

它不起作用，因为`MemberExpression`忽略覆盖并从基本类型返回属性`Text`，这就是您找不到属性的原因。

您可以在此处阅读有关此问题的信息：[如何从表达式中获取子声明类型？](https://stackoverflow.com/questions/9466582/how-to-get-the-child-declaring-type-from-an-expression)

但是，您拥有表达式中的所有信息，并且您可以通过更多反射（快速和肮脏的示例）获得您的属性：

```
Expression<Func<Abstract, string>> expression = (Abstract c) => c.Content;
Expression exp = expression.Body;
MemberInfo memberType = (exp as MemberExpression).Member;

var attrs = Attribute.GetCustomAttributes(
expression.Parameters[0].Type.GetProperty(memberType.Name)); 
```

# ios - 如何确定在编辑模式下选择了哪些行

> ID：10324846
> 
> 赞同：0
> 
> 时间：2012-04-25T22:40:30.043
> 
> 标签：ios, ios5, uitableview

我在编辑期间为我的 uitableviewcontroller 选择了多项选择。我正在做的是在编辑模式下启用一个操作按钮，以便他们可以选择一组项目并分配它们。我将以下方法绑定到操作按钮。

```
- (void)assignSelected
{

    for(int i = 0; i < [self.tableView numberOfRowsInSection:0]; i++)
    {

    }
} 
```

我不确定如何确定在我的 for 循环中是否选择了该行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T02:58:11.140

您可能想要一组选定的行。选择一行时，然后将该行添加到数组中。然后，您可以在 for 循环中遍历该数组。

# amazon-ec2 - 如何为 Debian 使用 Linux Amazon Kernel (amzn) 存储库

> ID：10324847
> 
> 赞同：1
> 
> 时间：2012-04-25T22:40:33.213
> 
> 标签：amazon-ec2, repository

我正在使用带有 Debian 发行版的 Amazon EC2 实例，该发行版具有 Amazon Linux 内核 (2.6.35.11-83.9.amzn1.i686)。我想下载并安装内核头文件，这样我就可以在那里构建一个内核模块。

是否有 Amazon 的存储库服务器，我可以在其中找到它的所有标头包？

我更喜欢使用 apt-get 来安装头文件，但如果有人知道 RPM 存储库，那应该没问题。我可以使用“rpm”手动安装它们。

我没有找到任何信息或网站可以找到它们。

# php - 如何检查数组中是否存在 aa 值以及它是否增加了它

> ID：10324848
> 
> 赞同：0
> 
> 时间：2012-04-25T22:40:40.357
> 
> 标签：php

我有以下代码。我希望`elseif`零件检查是否`$pId`已经在数组中，如果是，我想增加它`quantity`而`price`不是向`$pId`数组中添加一个新的。

我不知道我是否使用了错误的方法，或者我的数组结构是否错误，但我无法让它增加这些值

```
if (!isset($_SESSION['cart'])) {
    $_SESSION['cart'] = array();
    $_SESSION['cart']['pid'][] = $pid;
    $_SESSION['cart']['pid']['price'] = $price;
    $_SESSION['cart']['pid']['quantity'] = $quantity;
    $_SESSION['cart']['total_price'] = $price;
    $_SESSION['cart']['total_items'] = $quantity;
}elseif(array_key_exists($pid, $_SESSION['cart'])){
    //increase price
    //increase quantity
}else{
    $_SESSION['cart']['pid'][] = $pid;
    $_SESSION['cart']['pid']['price'] = $price;
    $_SESSION['cart']['total_price'] += $price;
    $_SESSION['cart']['total_items'] += $quantity;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:50:24.890

我为数组添加了一个额外的维度，以便您可以轻松选择它。

```
if (!isset($_SESSION['cart'])) {
    $_SESSION['cart'] = array('pid' => array(), 'total_price' => 0, 'total_items' => 0);
    $_SESSION['cart']['pid'][$pid] = array();
    $_SESSION['cart']['pid'][$pid]['price'] = $price;
    $_SESSION['cart']['pid'][$pid]['quantity'] = $quantity;
    $_SESSION['cart']['total_price'] = $price;
    $_SESSION['cart']['total_items'] = $quantity;
}elseif(array_key_exists($pid, $_SESSION['cart']['pid'])){
    $_SESSION['cart']['pid'][$pid]['price'] = 'new price';
    $_SESSION['cart']['pid'][$pid]['quantity'] = 'new quantity';
}else{
    $_SESSION['cart']['pid'][$pid]['price'] = $price;
    $_SESSION['cart']['total_price'] += $price;
    $_SESSION['cart']['total_items'] += $quantity;
} 
```

我不知道`pid`代表什么，但乍一看，它看起来并不具有描述性。也许`products`会是一个更好的钥匙？

# pdf - Tridion 和 PDF（大容量）内容管理

> ID：10324849
> 
> 赞同：10
> 
> 时间：2012-04-25T22:40:44.513
> 
> 标签：pdf, batch-processing, binaries, tridion

我们有 5,000 个 PDF，总共不超过 200GB。它们可能需要在全年以大约 1,000 个为单位进行更新。

如我所见，有两条主要路线...

1) 通过 Tridion 发布 PDF 和相关元数据 2) 直接导入交付环境并在 Tridion 中管理 PDF 元数据

将这些 PDF 放入 CMS 的一个令人信服的（商业）原因是让它们投入生产的途径 - CMS = 简单 - 非 CMS = 一点也不简单，而且它直接为企业提供了控制权。

我们当然更愿意管理与二进制项目直接关联的元数据，并且还利用组件链接（跟踪使用位置等）而不是将组件（用于元数据）与“链接”映射到非 CMS 控制的二进制项目 -所以在我看来，**通过**CMS 会更有意义。

**现在**- 存在膨胀数据库/阻塞发布队列的问题......

其中一些项目可能需要通过工作流程（如果我们通过 WebDAV 批量上传，我想我们可以为特定文件夹定义特定的磁带，从而关联不同的模式？）。但是 - 使用 WebDAV*可能*意味着 PDF（及其历史版本）将存储在数据库中，这*可能会*出现问题。

所以......我们可以在 Tridion 中将这些链接为*外部链接*组件*，但*我认为这意味着我们不能使用 WebDAV（或者我们仍然可以将 WebDAV 与 externally_linked PDF 一起使用 - 似乎没有意义？）

我敢肯定，在 CMS 中（或周围）管理的大量二进制文件是我们许多人都遇到过的，并且很想知道其他人是如何解决这个困境的？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T23:41:34.460

只是为了回答你的观点：

> 所以...我们可以在 Tridion 中将这些链接为外部链接组件，但我认为这意味着我们不能使用 WebDAV（或者我们仍然可以将 WebDAV 与 externally_linked PDF 一起使用 - 似乎没有意义？）

我不确定 WebDAV 是否​​可行，但如果您决定采用外部多媒体路线，您可以编写一个简单的应用程序来根据 pdf 文件的存储目录/目录创建多媒体组件。

我见过一个实现，其中使用特定的发布来允许用户放置文件并通过 Tridion 发布。发布到共享区域的出版物，即发布的共享文件夹，被映射到所需的演示网站（IIS 中的虚拟目录）......一个自定义模式字段用于帮助用户选择如何将 pdf 嵌入到内容中。我知道，这是一个非常奇怪的解决方案，但它在简单的安全性和发布配置方面解决了很多问题，并且 pdf 没有通过蓝图/本地化复制到数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T23:06:58.043

我认为您（或您团队中的某个人）一定在 SDL Tridion 论坛中提出过这个问题。如果不是，那就是一个巨大的巧合，看看那里的建议。

我会让其他人加入他们的经验，但如果您想使用 WebDAV，它将始终使用多媒体组件的上传版本。您应该将外部二进制文件视为 CMS 无法控制的只读源。

正如我在另一个论坛中所说，如果您需要工作流程并管理可以编辑二进制文件的用户权限，我建议您坚持将它们上传到 CMS。如果您在谈论 Terra 字节，我会更担心，但我预计您的数据大小不会有大问题。

考虑经常运行清除工具来删除非常旧版本的二进制文件，并确保在发布它们时留出一些时间。也可以小批量发布它们，因为超过 500Mb 的发布事务是众所周知的内存密集型。

# android - 获取当前正在运行的活动的实例？

> ID：10324856
> 
> 赞同：8
> 
> 时间：2012-04-25T22:41:42.327
> 
> 标签：android, events, android-activity

我想要做的是将运动事件分派给当前正在运行的活动。我从这段代码中得到了当前活动的 ComponentName

```
ActivityManager am = (ActivityManager) getSystemService(ACTIVITY_SERVICE);

// get the info from the currently running task
List<ActivityManager.RunningTaskInfo> taskInfo = am.getRunningTasks(1);

Log.d("current task :", "CURRENT Activity ::" + 
            taskInfo.get(0).topActivity.getClassName());

ComponentName componentInfo = taskInfo.get(0).topActivity; 
```

现在我有了组件名称，我想分派事件

```
dispatchTouchEvent(MotionEvent ev) 
```

那是在`Activity`课堂上，为此我需要一个当前活动的实例。我被困在组件名称上。如何获取`Activity`实例以便调度事件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T23:22:50.013

哇，这个问题有很多问题，很难知道从哪里开始！让我们按顺序排列它们：

> 我想要做的是将运动事件分派给当前正在运行的活动

当前前台活动将获得运动事件，除非它不应该。我可以想象这有意义的唯一方法是您的服务已经在所有应用程序之上放置了一个系统窗口......在这种情况下，我会敦促您不要这样做，而只是让您的前台活动处理事件。

> 我从这段代码中得到了当前活动的 ComponentName

ActivityManager.getRunningTasks()*不适*用于正常的应用程序开发。这适用于任务管理器等。您永远不应编写依赖于此函数返回的信息的核心程序逻辑。那是自找麻烦，事实上我可以保证这样的代码会在某个时候中断。（当多个应用程序可以同时在前面运行时会发生什么？）

> 我要派发活动

你真的，真的不应该将运动事件从一个窗口中取出并将它们塞进另一个窗口。各种调度状态将无法正确设置，事件中的状态将不一致（事件设置为原始窗口等，而不是您要填充的新窗口）等等。这是另一个如果您甚至可以拼凑它以使其在今天完全正常工作，那么这是制作一个在未来很有可能崩溃的片状应用程序的好方法。

> 我被困在组件名称上。如何获取 Activity 实例以便调度事件？

实际上，您所拥有的只是一个组件名称。这与活动实例无关。没有神奇的方法可以把它变成一个实际的实例。提供一个是错误的，因为这很容易产生歧义（如果实例化了该类的两个实例）。

我认为你需要从头开始，看看你实际上想要完成什么，以获得帮助，了解什么是接近它的合理方式。在这一点上，你自己走的路是终点站。

# javascript - 如何使用leaflet.js 中的.off() 事件方法？

> ID：10324857
> 
> 赞同：20
> 
> 时间：2012-04-25T22:41:44.027
> 
> 标签：javascript, geocoding, leaflet

我正在尝试使用 Leaflet.js 构建地图应用程序，但我不知道如何使用 .off 方法。该文档没有任何示例，我似乎在网上其他任何地方都找不到任何东西。我已将问题提炼成更简单的代码块，这样我的问题就可以更清楚了。

基本上我已经设置好了，当你点击“启用点击”链接时，它会添加一个事件监听器，每次你点击它时都会向地图添加一个标记。当您单击“禁用单击”时，我想删除该事件侦听器。

[这是演示的链接](http://demos.nodeline.com/leaflet_development)

这是我现在拥有的代码。

```
$(document).ready(function(){

var map, cloudmade, sanAntonio, polygonPoints  

 map = new L.Map('map');
 cloudmade = new L.TileLayer('http://{s}.tile.cloudmade.com/d4334cd6077140e3b92ccfae2b363070/997/256/{z}/{x}/{y}.png', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://cloudmade.com">CloudMade</a>',
    maxZoom: 18
});

 sanAntonio = new L.LatLng(29.4238889, -98.4933333); // geographical point (longitude and latitude)

 map.setView(sanAntonio, 13).addLayer(cloudmade);

//everything above sets up the map

function enableClick(){
  map.on('click', function(e) {    
    var marker = new L.Marker(e.latlng, {draggable:true});
    map.addLayer(marker);
  });//closes the click function

  this.disableClick = function(){
    map.off('click');
  }

}

//when 
$('#enable_click').click(function(){
  var enable_click = new enableClick()

  $('#disable_click').click(function(){
    enable_click.disableClick;
  });

});

});//closes the document ready function 
```

我已经尝试了很多不同的东西，所以整个“this.disableClick”只是我尝试过的最新奇怪的东西。有人有线索吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-26T09:58:49.393

您需要将函数传递给`on`并`off`通过引用：

```
function doStuff() { ... }

map.on('click', doStuff);
...
map.off('click', doStuff); 
```

# java - 如何保护客户端/服务器套接字通信

> ID：10324860
> 
> 赞同：4
> 
> 时间：2012-04-25T22:42:05.980
> 
> 标签：java, security, sockets, client-server

假设客户端和服务器应用程序在不同的机器上运行

今天：

```
// Server will receive the request and cast it as needed
ProxyResponse message = (ProxyResponse) objStream.readObject();

// Update message with some content
...

// Sent it back to client
ObjectOutputStream oos = new ObjectOutputStream(toClient);
oos.writeObject(message); 
```

我想进一步增强这一点，以确保发出的数据受到某种保护。你会建议我如何处理这个？

我正在寻找一个示例，说明如何在客户端和服务器之间传递的数据在两端被加密和解密并通过 SSL 发送。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T22:47:27.040

JDK[提供了一个 SSL 套接字](http://docs.oracle.com/javase/6/docs/api/javax/net/ssl/SSLSocket.html) 实现，这似乎是一个合适的起点。使用起来很简单。

最初，您可能有这样的代码：

```
final SocketFactory factory = SocketFactory.getDefault();
final Socket socket = factory.createSocket(host, port); 
```

您只需更改工厂：

```
final SocketFactory factory = SSLSocketFactory.getDefault();
final Socket socket = factory.createSocket(host, port); 
```

对于`ServerSocketFactory`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T22:48:22.047

您可以使用[非对称](http://en.wikipedia.org/wiki/Public-key_cryptography)或基于[对称](http://en.wikipedia.org/wiki/Symmetric-key_algorithm)的加密。查看[BouncyCastle](http://www.bouncycastle.org/java.html)库。使用对称密钥加密，这就像每一方都有一个用于加密数据的共享密钥一样简单。

根据您更新的答案，我同意您应该调查`SSLSocket`.

# node.js - Dreamhost 上的 Socket.io 聊天：隐藏 URL

> ID：10324864
> 
> 赞同：0
> 
> 时间：2012-04-25T22:42:35.143
> 
> 标签：node.js, socket.io, dreamhost

我的 socket.io 聊天可以通过 URL [http://example.com:8080/](http://example.com:8080/)访问。Dreamhost不允许我们绑定80，所以我在8080上绑定。

我想去掉 URL 中的端口号。所以，我使用了 Dreamhost 的代理服务器功能 (http://wiki.dreamhost.com/Proxy_Server)，它是 Apache 的 mod_proxy。

我将端口号 8080 代理到 URL [http://example.com/socketchat](http://example.com/socketchat)。当我转到那个 URL 时，聊天不起作用。我收到此错误：

“代理错误代理服务器收到来自上游服务器的无效响应。代理服务器无法处理请求 GET /socket/。原因：从远程服务器读取错误”

有没有办法摆脱与 socket.io 一起使用的 URL 中的端口号？如果没有任何效果，如果我在向公众发布我的网站时将端口号留在 URL 中会不会有安全风险？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T00:02:21.690

我的猜测是 mod_proxy 不能很好地处理 websockets，这不足为奇。也就是说，你真的不应该把 node.js 放在 Apache 后面，因为这违背了 node.js 的很多目的。Apache 将很快成为您的瓶颈。

最后，不，在另一个端口上使用 socket.io 没有安全风险——无论您在哪个端口上运行它，都会存在任何安全风险。如果其他防火墙阻止与端口 80 以外的端口的连接（这并非闻所未闻），您可能会遇到其他防火墙的问题——但话又说回来，此类防火墙在任何情况下都可能会出现 websocket 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T01:24:28.880

Apache 是否很快成为瓶颈取决于您如何准确地使用它。这是一个非常成熟的网络服务器，可以很好地托管世界各地的大量网站。无论如何，您的 socket.io 应用程序不一定要与您的 Web 应用程序共享相同的端口。您可以让 socket.io 在端口 8081 上侦听，并在端口 8080 上进行正常的 http 请求。然后您可以将代理设置为指向 8080，就像现在一样，让您的 socket.io 连接转到 8081。

在这种情况下，端口应该不是问题，因为用户不会在他们的 URL 中看到它，并且 socket.io 通信不必通过代理。如果您为 Apache 提供了足够多的请求以合法地成为瓶颈，那么无论如何您应该能够为更好的托管环境而努力！

**例子**

**服务器**

```
var app = require('http').createServer(handler)
  , io = require('socket.io').listen(8081)
  , fs = require('fs')

app.listen(8080);

function handler (req, res) {
  fs.readFile(__dirname + '/index.html',
  function (err, data) {
    if (err) {
      res.writeHead(500);
      return res.end('Error loading index.html');
    }

    res.writeHead(200);
    res.end(data);
  });
}

io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
}); 
```

请注意，网络服务器正在侦听与 socket.io 连接不同的端口。这意味着您可以使用 mod_proxy 安全地代理从 80 到 8080 的正常 http 请求，并且 socket.io 可以绕过代理直接在端口 8081 上非常愉快地通信。您的用户无需输入端口即可访问该站点。

**客户**

```
<script src="http://domain.com:8081/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect('http://domain.com:8081');
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });
</script> 
```

# scala - Play 2.0中的共享文件夹

> ID：10324873
> 
> 赞同：1
> 
> 时间：2012-04-25T22:43:57.563
> 
> 标签：scala, playframework-2.0

在 play 2.0 应用程序中，我需要一个额外的源文件夹（我可以在其他项目中重复使用的共享文件夹）在“app”文件夹旁边。

所以我在根目录中创建了文件夹，并将这些行添加到 Build.scala 文件中：

```
sourceDirectory in Compile <<= baseDirectory / "shared"
javaSource in Compile <<= baseDirectory / "shared" 
```

没有任何效果，我仍然收到编译错误：“包 foo.bar 不存在”。

我尝试的下一件事是为共享文件夹创建一个模块：

```
val sharedFolder = Project("shared", file("modules/shared"))
val main = PlayProject(appName, appVersion, appDependencies, mainLang = JAVA).settings(
    ebeanEnabled := false).dependsOn(sharedFolder) 
```

这行得通，除了在这种情况下，模块中的 appDependencies 不可用，所以我仍然会遇到编译错误。有什么想法可以修复模块的依赖项或向我的主项目添加额外的源文件夹吗？

# jquery - jQuery Data Tables 插件不删除表格行

> ID：10324875
> 
> 赞同：3
> 
> 时间：2012-04-25T22:44:48.967
> 
> 标签：jquery, datatables

我试图弄清楚为什么当我单击删除按钮时它会更改执行 php 方面的操作，但是当它返回客户端时它不会从表中删除该行。我正在为我的表使用数据表。

```
$('.delete').click(function() { 
    var titleID = $(this).attr('rel');
    $.post('titles/delete', { titleID:titleID }, function(data) {
        if (data.success)
        {
            var anSelected = fnGetSelected( oTable );
            oTable.fnDeleteRow( anSelected[0] );
        }
    });
}); 
```

php端的响应是这样的：

```
{"success":"Yes","message":"Title was deleted successfully!"} 
```

**编辑 ：**

这是我现在正在使用的内容，我收到一条有趣的错误消息，指出未定义 fnGetSelected。所以我不确定我是否正确地这样做来删除表格行。

```
$('.delete').click(function() { 
var titleID = $(this).attr('rel');
$.post('titles/delete', { titleID:titleID }, function(data) {
    if (data.success)
    {
        var anSelected = fnGetSelected( oTable );
        oTable.fnDeleteRow( anSelected[0] );
    }
}, 'json');
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:23:56.207

oTable 是在数据表功能中找到的对象，并在其中定义。一旦函数运行了它的过程并呈现了它想要的任何东西，这个变量就会被销毁，因为它不是任何类型的全局变量。

还

```
$('.delete').click(function() { 
    var titleID = $(this).attr('rel');
    $.post('titles/delete', { titleID:titleID }, function(data) {
        if (data.success)
        {
            var anSelected = fnGetSelected( oTable );
            oTable.fnDeleteRow( anSelected[0] );
        }
    });
}); 
```

如果您希望使用 $.post 并返回数据，那么指定您想要返回的数据和类型是个好主意

```
$('.delete').click(function() { 
    var titleID = $(this).attr('rel');
    $.post('titles/delete', { titleID:titleID }, function(data) {
        if (data.success)
        {
            var anSelected = fnGetSelected( oTable );
            oTable.fnDeleteRow( anSelected[0] );
        }
    }, 'json');
}); 
```

还值得一提的是，而不是在渲染后尝试使用数据表对象。根据“删除”按钮所在的位置，您可以并且很可能是最简单的路线，例如

```
$(this).parent('tr').remove(); 
```

假设按钮/链接与要删除的按钮/链接在同一行。您可以执行上述操作，因为这纯粹是为了删除相关表格行的视觉效果。还假设您的 ajax 正在更改下次加载页面时的数据，因此它不再在集合中，因此不会包含在下一次加载中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:02:18.807

您在此处提供的代码存在多个问题...
1.通过您为 POST 请求获得的响应。
您正在为“成功”属性获得“是”值，我认为`if`在 javascript 中不会将其视为`true`.
2.`fnGetSelected`数据表的函数需要一个实例来处理..你不能像调用全局函数一样调用函数..所以如果你有表引用存储在一个变量中，`dTable`那么你可以调用它，`dTable.fnGetSelected()`
你应该这样调用它改变这个

```
var anSelected = fnGetSelected( oTable ); 
```

对此

```
var anSelected = oTable.fnGetSelected(); 
```

我假设 oTable 有你的数据表，
所以通过按 f12 来调试打开开发人员工具，并在控制台或任何地方查找 javascript 错误，具体取决于你的浏览器

# c# - 路径中的非法字符。将 Skip and Take 与 IEnumerable 一起使用时出错

> ID：10324877
> 
> 赞同：8
> 
> 时间：2012-04-25T22:44:51.807
> 
> 标签：c#, asp.net-mvc-3, ienumerable

您好，我的控制器中有以下操作

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index()
{
    IEnumerable<SurveyResult> myresult = filterData();
    totalCount = myresult.Count<SurveyResult>();
    ViewBag.totalCount = totalCount;
    //myresult = myresult.Skip<SurveyResult>(100 * pageIndex).Take<SurveyResult>(100);
    return View(myresult);
} 
```

这是我的看法

```
@model IEnumerable<SurveyResult>
@{
    ViewBag.Title = "Survey Results";
}
@using (Html.BeginForm())
{

    <table class="std-tbl">
        <thead>
            <tr>
                <th>
                    DEL
                </th>
                ...

                <th>
                </th>
            </tr>
        </thead>
        @Html.DisplayFor(x => x, new { pageIndex = ViewBag.index })
    </table>
} 
```

我对 SurveyResult 有部分看法，但我不包括在内，因为我认为它不相关。这是我的问题。上面的代码工作正常，但只要我取消注释以下行

```
myresult = myresult.Skip<SurveyResult>(100 * pageIndex).Take<SurveyResult>(100); 
```

我得到“路径中的非法字符。”我认为它可以找到 SurveyResult 的部分视图。我不明白为什么当上面的行被注释时它可以找到它，而当它没有被注释时它却不能？谢谢你。

这是我的堆栈跟踪

```
[ArgumentException: Illegal characters in path.]
   System.IO.Path.CheckInvalidPathChars(String path) +126
   System.IO.Path.Combine(String path1, String path2) +38
   System.Web.Compilation.DiskBuildResultCache.GetPreservedDataFileName(String cacheKey) +27
   System.Web.Compilation.DiskBuildResultCache.GetBuildResult(String cacheKey, VirtualPath virtualPath, Int64 hashCode, Boolean ensureIsUpToDate) +14
   System.Web.Compilation.BuildManager.GetBuildResultFromCacheInternal(String cacheKey, Boolean keyFromVPP, VirtualPath virtualPath, Int64 hashCode, Boolean ensureIsUpToDate) +200
   System.Web.Compilation.BuildManager.GetVPathBuildResultFromCacheInternal(VirtualPath virtualPath, Boolean ensureIsUpToDate) +51
   System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) +68
   System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) +111
   System.Web.Compilation.BuildManager.GetVirtualPathObjectFactory(VirtualPath virtualPath, HttpContext context, Boolean allowCrossApp, Boolean throwIfNotFound) +125
   System.Web.Mvc.BuildManagerWrapper.System.Web.Mvc.IBuildManager.FileExists(String virtualPath) +29
   System.Web.Mvc.BuildManagerViewEngine.FileExists(ControllerContext controllerContext, String virtualPath) +41
   System.Web.Mvc.VirtualPathProviderViewEngine.GetPathFromGeneralName(ControllerContext controllerContext, List`1 locations, String name, String controllerName, String areaName, String cacheKey, String[]& searchedLocations) +150
   System.Web.Mvc.VirtualPathProviderViewEngine.GetPath(ControllerContext controllerContext, String[] locations, String[] areaLocations, String locationsPropertyName, String name, String controllerName, String cacheKeyPrefix, Boolean useCache, String[]& searchedLocations) +304
   System.Web.Mvc.VirtualPathProviderViewEngine.FindPartialView(ControllerContext controllerContext, String partialViewName, Boolean useCache) +130
   System.Web.Mvc.<>c__DisplayClass8.<FindPartialView>b__7(IViewEngine e) +21
   System.Web.Mvc.ViewEngineCollection.Find(Func`2 lookup, Boolean trackSearchedPaths) +127
   System.Web.Mvc.ViewEngineCollection.FindPartialView(ControllerContext controllerContext, String partialViewName) +170
   System.Web.Mvc.Html.TemplateHelpers.ExecuteTemplate(HtmlHelper html, ViewDataDictionary viewData, String templateName, DataBoundControlMode mode, GetViewNamesDelegate getViewNames, GetDefaultActionsDelegate getDefaultActions) +418
   System.Web.Mvc.Html.TemplateHelpers.TemplateHelper(HtmlHelper html, ModelMetadata metadata, String htmlFieldName, String templateName, DataBoundControlMode mode, Object additionalViewData, ExecuteTemplateDelegate executeTemplate) +1117
   System.Web.Mvc.Html.TemplateHelpers.TemplateHelper(HtmlHelper html, ModelMetadata metadata, String htmlFieldName, String templateName, DataBoundControlMode mode, Object additionalViewData) +66
   System.Web.Mvc.Html.TemplateHelpers.TemplateFor(HtmlHelper`1 html, Expression`1 expression, String templateName, String htmlFieldName, DataBoundControlMode mode, Object additionalViewData, TemplateHelperDelegate templateHelper) +117
   System.Web.Mvc.Html.TemplateHelpers.TemplateFor(HtmlHelper`1 html, Expression`1 expression, String templateName, String htmlFieldName, DataBoundControlMode mode, Object additionalViewData) +100
   System.Web.Mvc.Html.DisplayExtensions.DisplayFor(HtmlHelper`1 html, Expression`1 expression, Object additionalViewData) +57
   ASP._Page_Views_SurveyResult_Index_cshtml.Execute() in c:\Source\Test\Admin\Views\SurveyResult\Index.cshtml:163
   System.Web.WebPages.WebPageBase.ExecutePageHierarchy() +207
   System.Web.Mvc.WebViewPage.ExecutePageHierarchy() +81
   System.Web.WebPages.StartPage.RunPage() +19
   System.Web.WebPages.StartPage.ExecutePageHierarchy() +65
   System.Web.WebPages.WebPageBase.ExecutePageHierarchy(WebPageContext pageContext, TextWriter writer, WebPageRenderingBase startPage) +76
   System.Web.Mvc.RazorView.RenderView(ViewContext viewContext, TextWriter writer, Object instance) +220
   System.Web.Mvc.BuildManagerCompiledView.Render(ViewContext viewContext, TextWriter writer) +115
   System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context) +303
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult) +13
   System.Web.Mvc.<>c__DisplayClass1c.<InvokeActionResultWithFilters>b__19() +23
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +260
   System.Web.Mvc.<>c__DisplayClass1e.<InvokeActionResultWithFilters>b__1b() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult) +177
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +343
   System.Web.Mvc.Controller.ExecuteCore() +116
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +37
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +21
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +12
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +50
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8969117
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184

Here is the source Error: 
```

第 161 行：第 162 行： **第 163 行：@Html.DisplayFor(x => x, new { pageIndex = ViewBag.index })** 第 164 行：第 165 行：}

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-25T22:55:59.767

`DisplayFor` is looking for a view named after the name of the EF-generated implementation classes, which contain illegal characters.

Try calling `.ToList()` in the controller.

# python - elementTree 无法解析 unicode xml

> ID：10324888
> 
> 赞同：0
> 
> 时间：2012-04-25T22:46:27.847
> 
> 标签：python, xml, xml-parsing, elementtree

我有以下xml：

```
<Earth>
 <country name="Česká republika" population="8900000">
    <capital>Praha1</capital>        
  </country>
</Earth> 
```

但是当我尝试解析它失败并出现错误：

```
 xml.etree.ElementTree.ParseError: not well-formed (invalid token): line 2, column 20 
```

我的代码：

```
 tree=etree.parse(input) # input -> file.xml 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T07:45:45.227

正如 arhimmel 指出的那样，这个问题很可能是编码问题。etree.parse 允许传递类似文件的对象以及路径，因此您可以尝试`import codecs`在代码顶部添加，然后替换`input`为`codecs.open("file.xml", encoding="UTF-8")`.

# c - 嵌套许多while循环有问题吗？

> ID：10324890
> 
> 赞同：8
> 
> 时间：2012-04-25T22:47:13.497
> 
> 标签：c, while-loop, nested-loops

我正在做一些功课，想知道是否有太多嵌套的while循环之类的东西。嵌套几个while循环有缺点吗？如果是这样，将如何重构我下面的代码片段？

下面是一次读取一行文件的代码，解析由一些定义的分隔符分隔的字段，并在打印到控制台之前删除前导空格。

```
// Read the file one line at a time
while (fgets(lineStr, MAXLINELENGTH, fp) != NULL)
{
    charPtr = strtok(lineStr, DELIMITERS);

    // Loop until line is parsed
    while (charPtr != NULL)
    {
        // Skip past leading whitespace
        while (isspace(*charPtr))
            charPtr++;

        puts(charPtr);
        charPtr = strtok(NULL, DELIMITERS);
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T22:54:10.300

这确实是一个相当主观的话题。在我看来，三个嵌套的 while 循环根本没有问题，但你已经达到了可接受的极限。在我看来，如果你再添加一层或两层嵌套，那么你就会越过期望读者理解的合理范围。人脑只能在任何一个时间点处理如此多的复杂性。

与我的观点相反，有些人会争辩说，一个函数中的嵌套级别不应超过一层，并且函数不应包含超过 10 行代码。相反的论点是，这样的策略会导致代码更加碎片化、脱节。我的经验法则是，如果您无法为一段代码想出一个好的函数名，那么也许那段代码并不真正意味着作为一个函数独立存在。

看看你可以打破这个功能的方式，有几个明显的选择。

1.  将最外层的主体提取`while`到一个单独的函数中。提取的函数将处理一行。这将很容易命名和清晰阅读。
2.  将跳过空格的循环提取`while`到单独的函数中。这又很容易命名，并使您的代码更易于阅读。您将删除空白注释，因为提取函数的名称会使它变得不必要。这可能是值得做的。

如果您应用了这些想法，那么您的代码可能看起来像这样：

```
char* skipWhitespace(char* str)
{
    while (isspace(*str))
        str++;
    return str;
}

void parseLine(char *lineStr)
{
    charPtr = strtok(lineStr, DELIMITERS);
    while (charPtr != NULL)
    {
        charPtr = skipWhitespace(charPtr);
        puts(charPtr);
        charPtr = strtok(NULL, DELIMITERS);
    }
}
......
while (fgets(lineStr, MAXLINELENGTH, fp) != NULL)
    parseLine(lineStr); 
```

请注意，提取方法的重构和命名使注释有点多余，我删除了它们。另一个好的经验法则是，如果您需要过多地注释代码，那么它可能还没有被很好地考虑。

归根结底，确实没有硬性规定，这取决于判断和个人喜好。在我看来，问题中的代码非常清晰易读，但在我看来，重构后的版本更加清晰一些。

[免责声明：我不对代码的正确性或其他方面发表评论。我只是忽略了这方面。]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T22:54:12.580

唯一真正的缺点是可读性，对此并没有任何硬性规定……尽管超过 3 个嵌套通常会激怒与您一起工作的任何其他人。正如另一位海报所说，有时最好通过将循环移动到另一个函数来打破嵌套，但你在这里所拥有的对我来说是完全可读的——这是唯一真正的指标；纯粹的主观意见:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T23:01:24.137

如前所述，这是相对主观的。但是，嵌套循环的**方式**会对代码产生直接的性能影响。考虑*缓存感知*编程。也就是说，您希望以处理器可以在需要之前将下一个数据块预取（即预测）到高速缓存存储器中的方式来安排您的代码。这将允许更多的缓存命中和更快的内存访问时间。

请注意，这对于您的示例并不是特别重要，但是，如果您进行多次内存访问，这可能会显着提高或降低性能。如果您在行优先架构上以列方式遍历多维数组，则可能会出现许多缓存未命中（请注意，缓存未命中在实时方面的成本非常高）。

所以嵌套循环不一定是坏事，但它肯定会对性能产生明显的影响，尤其是在一些任意数量的**n**循环之后。

# .net - 在 Atom 移动设备上运行 .NET 应用程序

> ID：10324900
> 
> 赞同：1
> 
> 时间：2012-04-25T22:47:59.503
> 
> 标签：.net, mobile, intel, managed-c++, intel-atom

我有一个使用 .NET 4.0 的 .NET WPF 应用程序。它在台式机和笔记本电脑上运行良好。然而，最近有人试图将它安装在一个“移动设备”上，该设备具有 Atom 处理器 Z530，运行 Windows 7 32 位专业版。它似乎安装了 .NET 4.0 Client Profile 和 .NET 4.0 Extended。但是，我们的应用程序无法在此设备上运行，并且在尝试加载托管 C++ 程序集时崩溃。在构建针对此类设备的应用程序时，是否必须遵循任何特殊程序？它的规格是：

*   英特尔® 凌动™ 1.6GHZ 512 KB 二级缓存

*   2GB DDR2 533 兆赫

*   DDR2 2GB DDR2 533MHz 内存

*   英特尔® GMA 500

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T06:59:31.813

原子可能不是原因。检查您是否安装了 VC++ 可再发行组件。检查无法加载的 dll 是否使用在...\folder 等一般路径类型下构建的库（dlls、.lib），而不是像 C:\something 在部署的机器上不存在的直接路径

# excel - 公式或宏根据一列中的条件将长列表（多列）分成单独的列表

> ID：10324902
> 
> 赞同：1
> 
> 时间：2012-04-25T22:48:15.627
> 
> 标签：excel, split, criteria

我有一个数据日志列表，其中前两列作为潜在标识符，如 Flickr 上的图像中的缩短形式所示（noobie - 无法发布图片）：

[http://farm8.staticflickr.com/7036/7114053281_30bf57300d.jpg](http://farm8.staticflickr.com/7036/7114053281_30bf57300d.jpg)

我已经根据 B 列的值进行了排序。我希望能够将这组长数据拆分为四列的单独列表，其中一个列表包含一个“Spot ID”，如下所示：

[http://farm9.staticflickr.com/8160/6967974902_7f84b57e46.jpg](http://farm9.staticflickr.com/8160/6967974902_7f84b57e46.jpg)

A 列“Frame #”并不重要，但我把它留在里面是因为我想知道它是否可以用来使宏更容易运行。

我必须处理很多这样的数据，所以我想了解如何修改宏以将单独的列表发送到不同的工作表，而不是不同的列。

如果您想知道，Frame # 指的是视频显微照片帧，spot ID 指的是被跟踪的特定胶体粒子。X Pos 和 Y Pos 分别是 X 和 Y 坐标。

任何帮助深表感谢。

nan0guy

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T02:27:02.950

试试这个，它使用一个简单的 AUTOFILTER 来获取具有唯一 SPOT ID 的每一行，它唯一没有做的是将 ... ... ... ... 行保持在中间，希望不是实际上很关键。

```
Option Explicit

Sub SplitColumns()
Dim c As Range, wsNEW As Worksheet, NC As Long, LR As Long
Dim List As New Collection, Item As Variant

With ActiveSheet
    .AutoFilterMode = False       // turn autofilter off
    LR = .Range("A" & .Rows.Count).End(xlUp).Row        //count cells in A 

    On Error Resume Next        //on error, continue on next line
    For Each c In .Range("B:B").SpecialCells(xlConstants, xlNumbers) //Help here?
        //doing something to the values in column B (the Spot IDs)
        List.Add c.Value, CStr(c.Value)        //Make a list of values in column A in c
    Next c        //For-next loop
    On Error GoTo 0

    .Rows(1).AutoFilter        //turn autofilter on?
    Set wsNEW = Sheets.Add        //add a new sheet
    NC = 1        //counter for columns in new sheet

    For Each Item In List        //exactly, but where does Item come from?
        .Rows(1).AutoFilter Field:=2, Criteria1:=Item //autofilter using Item as criteria
        .Range("B1:D" & LR).Copy wsNEW.Cells(1, NC)  //copy everything in the range to new column in new sheet
        NC = NC + 3        //iterate column by 3
    Next Item        // for-next loop

    .AutoFilterMode = False        // turn autofilter off
End With

End Sub 
```

# android - 安卓 SDK。用于发布的自签名应用程序

> ID：10324906
> 
> 赞同：0
> 
> 时间：2012-04-25T22:48:27.067
> 
> 标签：android, android-2.2-froyo

问题的目的：我从哪里获得“release.keystore”？

我已准备好将我的应用程序打包/导出到 .apk

我使用谷歌地图，所以我不能再使用我的调试密钥。

现在，我必须对我的应用程序进行自签名并使用“发布”密钥库创建发布密钥。

唯一的问题，我该怎么做？

我在这里：[https](https://developers.google.com/android/maps-api-signup) ://developers.google.com/android/maps-api-signup ，准备插入我的新密钥，在这里：http: [//developer.android.com/guide/publishing/app-signing.html](http://developer.android.com/guide/publishing/app-signing.html)，准备好不同的链接，并进行谷歌搜索。

此版本密钥库在哪里？如何自签名我的应用程序？它只能从我的网站上获得，而不是从 android 市场上获得。

我还需要为 Google 生成一个发布密钥。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:51:43.997

> 此版本密钥库在哪里？

无论您在何处创建它，只要您[按照文档中的说明进行操作即可](http://developer.android.com/guide/publishing/app-signing.html#releasemode)。

> 如何自签名我的应用程序？

使用`jarsigner`或 Eclipse，如[文档](http://developer.android.com/guide/publishing/app-signing.html#releasemode)中所示。

# html - HTML5 Filesystem API 可以帮助我在没有服务器的情况下在自己的硬盘上编辑 .html 文件吗？

> ID：10324914
> 
> 赞同：1
> 
> 时间：2012-04-25T22:49:51.657
> 
> 标签：html, html5-filesystem

我对 HTML5 Filesystem API 的意义感到困惑。

据我所知，引用使用 File API 创建的沙盒文件之一的内容的方式需要引用域名。

“使用 HTML5 文件系统 API”在“安全注意事项”下有这样的说法：

> 私有数据的泄漏或擦除——通过将 HTML5 文件系统的范围限制为类似于 chroot 的、特定于源的沙箱来缓解这种情况。应用程序无法访问另一个域/源的文件系统。

但究竟什么是“起源”？据我所知，那本书没有定义它们。在我看来，一个来源必须包含一个域名，即使该域是`localhost`.

是这样吗？如果是的话，那就糟了。这意味着我们再次无法构建可以编辑本地文件的编辑器。当然，有安全方面的考虑，但这不就是让编辑本地文件成为可能的*计划的一部分吗？*HTML5 API 是专门针对 Internet 上的内容还是针对知道如何设置本地服务器的人？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T23:07:14.360

[这是 HTML5 中原点的完整定义](http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html)，参考[RFC 6454](https://www.rfc-editor.org/rfc/rfc6454)。就您而言，重要的是：

> 如果两个源是方案/主机/端口三元组，当且仅当它们具有相同的方案、主机和端口时，这两个源是相同的。

确实，这不会让您从 JavaScript 浏览文件系统，但如果您考虑一下，这是一件好事。如果可以使用 JavaScript 浏览您的文件系统，那么您访问的任何网页都可能在您不知情的情况下窃取您的所有文件。然而，这与无法访问文件并不完全相同，多年来一直有一种访问 HTML 文件的方法，它看起来像这样：

```
<input type="file" id="inputField"> 
```

HTML5 允许您访问使用此元素选择的任何文件，而无需往返服务器。

```
var inputElement = document.getElementById("inputField");
inputElement.addEventListener("change", handleFiles, false);

function handleFiles() {
    var fileList = this.files;

    for (var i = 0, numFiles = files.length; i < numFiles; i++) {
        var file = files[i];
        //do stuff with file
    }
} 
```

[在这篇 MSN 文章](https://developer.mozilla.org/en/Using_files_from_web_applications)中还有一些其他很好的示例，我从中窃取了上述（未经测试的）代码。

如果您使用[HTML5 离线应用程序](http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html)，您可以只访问一次 Web 服务器，然后关闭该服务器并继续使用该应用程序来编辑您通过上述方法附加到它的任何文件。

# asp.net-mvc-3 - 如果我将对象传递给模型绑定器，如何防止某些值被更新

> ID：10324915
> 
> 赞同：0
> 
> 时间：2012-04-25T22:50:02.247
> 
> 标签：asp.net-mvc-3, modelbinder

我有一个名为 Visit 的对象，具有以下属性：-

备注 DoctorID VisitTypeID CreatedBy Date VisitID PatientID StatusID Timestamp

在编辑视图中，用户只能编辑以下两个属性：- 注意 DoctorID 所以我在编辑视图中将其他属性添加为隐藏字段，如下所示：-

```
 @using (Html.BeginForm()) {
        @Html.ValidationSummary(true)
        <fieldset>
            <legend>Visit</legend>
            <div class="editor-label">
                @Html.LabelFor(model => model.Note)
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.Note)
                @Html.ValidationMessageFor(model => model.Note)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.DoctorID)
            </div>
            <div class="editor-field">
                @Html.DropDownList("DoctorID", String.Empty)
                @Html.ValidationMessageFor(model => model.DoctorID)
            </div>

            <p>
              @Html.HiddenFor(model => model.VisitTypeID)
              @Html.HiddenFor(model => model.CreatedBy)
              @Html.HiddenFor(model => model.Date)
              @Html.HiddenFor(model => model.VisitID)
              @Html.HiddenFor(model => model.PatientID)
              @Html.HiddenFor(model => model.StatusID)
              @Html.HiddenFor(model => model.timestamp)

            <input type="submit" value="Create" /> 
```

我必须在我的编辑视图中包含所有属性，因为我将访问对象传递给我的后期编辑操作方法，如下所示：-

```
 [HttpPost]
            public ActionResult Edit(Visit visit)
            {
                if (!(visit.Editable(User.Identity.Name)))
                {
                    return View("NotFound");
                }
                try
                {
                    if (ModelState.IsValid)
                    {
                        repository.UpdateVisit(visit);
                        repository.Save();
                        return RedirectToAction("Index");
                    }
                }
                catch (DbUpdateConcurrencyException ex)
                {
    var entry = ex.Entries.Single();
                    var clientValues = (Visit)entry.Entity;

                    ModelState.AddModelError(string.Empty, "The record you attempted to edit "
                    + "was modified by another user after you got the original value. The "

    //code goes here 
```

因此，我担心上述方法的原因如下：- 1\. 攻击者可能会修改隐藏字段的值。2\. 我无法在我的 Visit 模型类中定义 [Bind(Include = "....")]。

**所以我无法决定是否应该继续使用这种方法，或者有更好的方法可以遵循**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:04:11.413

您可能会重新拉动`Visit`控制器中的对象，然后只保留您希望填充的两个字段。这将确保只编辑这两个字段。

```
Visit existingVisit = /* retrieve Visit */;
existingVisit.Note = visit.Note;
existingVisit.DoctorID = visit.DoctorID;
repostistory.Update(existingVisit);
reposistory.SaveChanges(); 
```

但是，我可能会更进一步，为该特定操作创建一个视图模型，该模型仅包含您关心的字段。

# wpf - 如何在运行时在 WPF 按钮内居中对齐文本？

> ID：10324916
> 
> 赞同：0
> 
> 时间：2012-04-25T22:50:02.573
> 
> 标签：wpf, wpf-controls

有没有办法在运行时创建的 wpf 按钮内垂直对齐文本（即居中），我试过：

**代码片段**

```
Button btn = new Button();
Style style = this.FindResource("ButtonStyle1") as Style;
btn.Style = style;
TextBlock txtTblNme = new TextBlock();
txtTblNme.Text = Convert.ToString(Tbl.SelTblNme(i));
txtTblNme.TextAlignment = TextAlignment.Center;
txtTblNme.VerticalAlignment = VerticalAlignment.Center;
txtTblNme.HorizontalAlignment = HorizontalAlignment.Stretch;
btn.Content = txtTblNme; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T00:10:06.097

查看 ContentAlignment 属性。Button 上的 Horizo​​ntalContentAlignment 和 VerticalContentAlignment 的默认值应该已经是 Center。如果它们还没有，请尝试将它们设置为 Center，或者如果您在上面应用的样式覆盖了这些默认值，您可以在那里更改它们。

如果样式是针对所有按钮创建的，则在运行时、在 XAML 或代码隐藏中创建按钮不应更改应用程序中的样式（IE：样式具有 TargetType="{x:Type Button}" 并且应该省略x:Key 属性）。如果您指定了一个键，则需要在样式中引用，就像在上面的示例中一样。

这有帮助吗？

# html - 谷歌自定义搜索引擎需要很长时间才能加载到网页上？

> ID：10324919
> 
> 赞同：2
> 
> 时间：2012-04-25T22:50:53.097
> 
> 标签：html, search-engine, google-custom-search

我通过 www.google.com/cse/ 与 google 建立了一个自定义搜索引擎

我正在我的 Chrome 网站上的机器上对其进行测试，网页加载正常，但 CSE 需要超过 45 秒才能加载。当它加载时，它工作得很好。

有没有人遇到过这个问题？

我在 Firefox 中尝试，它立即加载，没有问题。在 IE9 中，它具有：

> Internet Explorer 已限制此网页运行脚本或 ActiveX 控件。

具有可用的启用选项。

这可能是 Chrome 的 ActiveX 问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T15:38:49.567

据我所知，这似乎是[Google AJAX API （或 CSE 生成器）的一个错误。](http://code.google.com/p/google-ajax-apis/)我找到了一种解决方法，可以让自定义搜索在 Chrome 中快速加载：

假设您没有修改从 收到的代码`www.google.com/cse/`，请更改：

```
google.load('search', '1', {language : 'en', style : google.loader.themes.V2_DEFAULT}); 
```

到：

```
google.load('search', '1', {language : 'en'}); 
```

由于某些奇怪的原因，该`style`设置会导致 Chrome 中的加载时间过长/无限。

# python - python删除C函数体

> ID：10324922
> 
> 赞同：2
> 
> 时间：2012-04-25T22:51:08.557
> 
> 标签：python, c, regex, match, substitution

我正在寻找如何从某些 C 源文件中的函数中删除整个身体的方法。

例如，我有包含以下内容的文件：

```
1\.  int func1 (int para) {
2\.    return para;
3\.  }
4.
5\.  int func2 (int para) {
6\.    if (1) {
7\.      return para;
8\.    }
9\.    return para;
10\. } 
```

我试过这些正则表达式：

```
content = re.sub('(\{[.*]?\})', '', content, flags=re.DOTALL) 
```

但是嵌套的 { } 有问题。此正则表达式仅替换第一个 }，因此第 9 行和第 10 行仍在内容中。我认为解决方案应该是计算 { 和 } 括号并在计数器为 0 时停止替换。{ 被发现 => counter++，} 被发现 => counter--。但我不知道如何在 python 中实现它。你们可以踢我一脚吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T23:44:58.233

我认为您正在尝试重新发明一个之前已经实施过多次的轮子。如果您只想提取 C 文件中每个函数的签名，那么有更简单的方法可以做到这一点。

ctags 实用程序将为您解决这个问题：

```
~/test$ ctags -x --c-types=f ./test.c
func1            function      1 ./test.c         int func1 (int para) {
func2            function      5 ./test.c         int func2 (int para) {
~/test$ # Clean up the output a little bit
~/test$ ctags -x --c-types=f ./test.c | sed -e 's/\s\+/ /g' | cut -d ' ' -f 5-
int func1 (int para) {
int func2 (int para) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T01:53:14.407

这是我从 C 源文件中删除函数体的脚本之一。唯一的要求是来自 Mac OSX 中 brew 的 ctags，而不是 Mac OSX 中内置的 ctags。我不确定为什么它不适用于 Mac OSX 中的内置 ctags。您可以通过输入以下命令使用[brew](http://brew.sh)安装 ctags ：

```
$ brew install ctags 
```

然后，将以下名为 dummyc.pl 的 PERL 脚本与 C 源文件一起使用。例如输入 C 源：

```
int
func1 (int para)
{
  return para;
}

int
func2 (int para)
{
  if (1)
    {
      return para;
    }
  return para;
} 
```

这是输出：

```
int
func1 (int para)
{
  return 0;
}

int
func2 (int para)
{
  return 0;
} 
```

这是 PERL 脚本：

```
#!/usr/bin/env perl
use strict;
use warnings;

unless ( @ARGV == 1 )
{
  print "Filter out the body of C functions.
Usage: dummyc.pl file.c
Required: ctags (e.g., \$ brew install ctags)\n";
  exit;
}

my $cfile = $ARGV[0];
my $lc = 1;
my $kindPrev = "comment";
my $lnPrev = 1;
my $lsPrev = "comment";
my $namePrev = "comment";
my $line = 1;
open(CFILE, $cfile) or die "could not open $cfile: $!";
open(PIPE, "/usr/local/Cellar/ctags/5.8/bin/ctags -xu $cfile|") or die "couldn't start pipe: $!";
while ($line)
{
  last unless $line;
  # R_USE_SIGNALS    macro        24 errors.c         #define R_USE_SIGNALS 1
  $line = <PIPE>;
  my $name;
  my $kind;
  my $ln;
  my $ls;
  if ($line)
  {
    $line =~ /^(\S+)\s+(\w+)\s+(\d+)\s+$cfile\s+(.+)/;
    $name = $1;
    $kind = $2;
    $ln = $3;
    $ls = $4;
  }
  else
  {
    $ln = 1000000;
  }

  if ($kindPrev eq "function") 
  {
    my $isFunctionBody = 0;
    my $hasStartBrace = 0;
    my $hasReturnValue = 1;
    my $noReturn = 0;
    for (my $i = $lnPrev; $i < $ln; $i++)
    {
      my $cline = <CFILE>;
      last unless $cline;

      if ($cline =~ /void.+$namePrev/)
      {
        $hasReturnValue = 0;  
      }
      if ($cline =~ /NORET.+$namePrev/)
      {
        $noReturn = 1;  
      }
      if ($isFunctionBody == 0 and $cline =~ /\{/)
      {
        $isFunctionBody = 1;
        unless ($cline =~ /^\{/)
        {
          $hasStartBrace = 1;
          print $cline;
        }
      }
      elsif ($cline =~ /^\}/)
      {
        $isFunctionBody = 0;
        print "{\n" if $hasStartBrace == 0;
        if ($noReturn == 0)
        {
          if ($hasReturnValue == 1)
          {
            print "  return 0;\n";
          }
          else
          {
            print "  return;\n";
          }
        }
      }
      unless ($isFunctionBody == 1)
      {
        print $cline;
      }
    }
  }
  else
  {
    for (my $i = $lnPrev; $i < $ln; $i++)
    {
      my $cline = <CFILE>;
      last unless $cline;
      print $cline;
    }
  }
  $kindPrev = $kind;
  $lnPrev = $ln;
  $lsPrev = $ls;
  $namePrev = $name;
}
close(PIPE) or die "couldn't close pipe: $! $?";
close(CFILE) or die "couldn't close $cfile: $! $?"; 
```

不过，您可能想要编辑 PERL 脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-13T14:33:42.577

这是一个纯python解决方案，实现起来非常简单。

## 提取身体的功能

基本上，您尝试将每个`{`与相应的匹配`}`：

*   `{`如果在下一个之前有两个，`}`那么您正在进入一个范围。
*   另一方面，如果`}`在 next 之前有一个`{`，那么您将退出范围。

然后实现是微不足道的：

*   您在不同列表中查找`{`和维护的所有索引`}`
*   您还维护一个范围深度变量
    *   如果当前`{`位置低于当前`}`位置，则您正在进入一个范围，您将范围深度加 1，然后移动到下一个`{`位置
    *   如果当前`{`位置高于当前`}`位置，则您正在退出范围，您将 1 移至范围深度并移动到下一个`}`位置
*   如果作用域深度变量为 0，那么您找到了函数体的右大括号

假设您的字符串在函数体的第一个大括号之后开始（不包括大括号），使用此子字符串调用以下函数将为您提供最后一个大括号的位置：

```
def find_ending_brace(string_from_first_brace):
  starts = [m.start() for m in re.finditer('{', string_from_first_brace, re.MULTILINE)]
  ends = [m.start() for m in re.finditer('}', string_from_first_brace, re.MULTILINE)]

  i = 0
  j = 0
  current_scope_depth = 1

  while(current_scope_depth > 0):  
    if(ends[j] < starts[i]):
      current_scope_depth -= 1
      j += 1
    elif(ends[j] > starts[i]):
      current_scope_depth += 1
      i += 1
      if(i == len(starts)): # in case we reached the end (fewer { than })
        j += 1
        break

  return ends[j-1] 
```

## 提取候选函数定义

现在，如果文件的原始字符串在变量`my_content`中，

```
find_func_begins = [m for m in re.finditer("\w+\s+(\w+)\s*\((.*?)\)\s*\{", my_content)] 
```

会给你每个函数的原型（`find_func_begins[0].group(1) == func1`和`find_func_begins[0].group(2) == 'int para')`，和

```
my_content[
  find_func_begins[0].start():
    find_func_begins[0].end() +
    find_ending_brace(my_content[find_func_begins[0].end():])] 
```

会给你正文的内容。

## 提取原型

我想您应该在到达第一个结束大括号后再次查找函数定义，因为正则表达式 for`find_func_begins`有点松散。迭代每个函数定义并匹配大括号会产生以下迭代算法：

```
reg_ex = "\w+\s+(\w+)\s*\((.*?)\)\s*\{"
last = 0
protos = ""
find_func_begins = [m for m in re.finditer(reg_ex, my_content[last:], re.MULTILINE | re.DOTALL)]
while(len(find_func_begins) > 0):
  function_begin = find_func_begins[0]
  function_proto_end = last + function_begin.end()
  protos += my_content[last: function_proto_end-1].strip() + ";\n\n"

  last = function_proto_end + find_ending_brace(my_content[function_proto_end:]) + 1
  find_func_begins = [m for m in re.finditer(reg_ex, my_content[last:], re.MULTILINE | re.DOTALL)] 
```

你应该有你想要的`protos`。希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-07T19:15:42.353

# 我需要清理它:)

类 FuncBody（对象）：

```
def __init__(self):

    self.stack = []

def stack_insert(self, sym_list):

    sym_list.sort(key=lambda x : x[1])
    #print "sym_list ", sym_list

    for sym, idx in sym_list:
        #print "here ", sym, idx
        if self.stack != [] and\
                (self.stack[-1] == '{' and sym == '}'):
            self.stack.pop()
        else:
            self.stack.append(sym)

def get_body(self, filepath, start):

    Begin = False
    self.stack = []
    for lineno in range(start, get_line_count(filepath)):
        #print lineno, getline(filepath, lineno)
        if False == Begin and\
                '{' in getline(filepath, lineno):
            self.stack_insert([('{', m.start())\
                    for m in re.finditer('{', getline(filepath, lineno))]+\
                    [('}', m.start()) for m in\
                    re.finditer('}', getline(filepath, lineno))])
            #print "Begin"
            Begin = True
            yield getline(filepath, lineno)
            continue
        if True == Begin and self.stack == []:
            #print "End here"
            break
        elif True == Begin:
             self.stack_insert([('{', m.start())\
                    for m in re.finditer('{', getline(filepath, lineno))]+\
                    [('}', m.start()) for m in\
                    re.finditer('}', getline(filepath, lineno))])

        #print "stack ", self.stack
        yield getline(filepath, lineno) 
```

# verilog - 如果使用类似于生成语句的变量，则始终阻止事件列表

> ID：10324923
> 
> 赞同：1
> 
> 时间：2012-04-25T22:51:09.290
> 
> 标签：verilog

考虑如下代码：

```
 reg [2:0] cnt;
   // a is an input (say 4 bit) to design and being assigned after some manipulation 
   // to some other variable  

   always @(a)
      for (cnt = 0; cnt < 4; cnt = cnt+1) begin
          //some operation involving a [bitwise]
      end 
```

现在你可以看到我没有将cnt包含在always块的事件列表中，因为cnt没有在always块之外引用/分配，并且完全通过for循环迭代

我的问题是我应该在事件列表上有 cnt 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T23:21:45.533

always 块的敏感性列表的工作方式是，一旦其中一个输入发生变化，always 块将执行直到它到达末尾，然后它将等待敏感性列表中的另一个变化。

在您的情况下，如果您更改`a`，它应该运行 for 循环的所有 4 个循环然后完成，因此`cnt`不需要在敏感度列表中。

也就是说，我很难想象这应该合成什么样的逻辑。您的 for 循环是应该计时的，还是打算立即执行？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T10:50:39.833

添加作为允许代码示例的答案：使用 @* 完成敏感度列表并检查不必要的触发。

```
integer cnt;
integer loop_cnt = 0;
reg [3:0] b;

always @* begin
  $display("%t : Loop Count ",$realtime, loop_cnt);
  loop_cnt = loop_cnt + 1;
  for (cnt = 0; cnt < 4; cnt = cnt+1) begin
    b[cnt] = one_bit_data ;
  end
end 
```

是相同的：

```
integer cnt;
integer loop_cnt = 0;
reg [3:0] b;

always @( one_bit_data ) begin
  $display("%t : Loop Count ",$realtime, loop_cnt);
  loop_cnt = loop_cnt + 1;
  for (cnt = 0; cnt < 4; cnt = cnt+1) begin
    b[cnt] = clk ;
  end
end 
```

运行两者，时间和计数应该匹配。如果有额外的触发，计数将高出四倍。

# jquery - 使用 $.ajax() 获取图像 - 访问控制请求标头

> ID：10324924
> 
> 赞同：2
> 
> 时间：2012-04-25T22:51:17.230
> 
> 标签：jquery

我正在使用这样的东西通过 jquery ajax 获取图像。

```
$.ajax({
   url: imageurl,
   type:'GET',
   contentType: 'image/png',
   success: success,
   error: error,
   timeout: 5000
}); 
```

我可以看到我的请求标头包括

> Access-Control-Request-Headers:origin, content-type, 接受

另一方面，如果我设置了一个 img 元素，例如

```
<img src="imageurl" ... 
```

并观察请求标头我没有看到任何“访问控制请求标头”。

只是想知道 $.ajax() 添加此标头的原因是什么。为什么要为应该是有效的跨站点 HTTP 请求的图像添加这个。删除此标头是否是一种好习惯，甚至可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:07:55.973

使用 XMLHttpRequest 访问的任何内容都将具有这些标头，无论它是否是图像。关键部分是请求的来源（脚本而不是“img”标签）。

这个标头实际上是由浏览器创建的，所以，不，不可能通过 jquery 删除它。

历史上不允许脚本执行跨站点 HTTP 请求，这些标头是新的“跨域共享”功能的一部分。参见：[https ://developer.mozilla.org/en/http_access_control](https://developer.mozilla.org/en/http_access_control)

请注意，可以通过使用 jquery 生成“img”标签来规避，这可能会以您想要的方式进行操作*。*我没试过，但值得一试。。

# alfresco - 我可以限制 Alfresco 中标题和内容字段的大小吗？

> ID：10324925
> 
> 赞同：0
> 
> 时间：2012-04-25T22:51:19.910
> 
> 标签：alfresco

有没有办法限制 Alfresco 中标题和内容字段的大小？（我知道如何向我自己的字段添加约束，但不知道这些。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T11:16:52.890

使用表单引擎，您可以定义自己的控件。检查[wiki](http://wiki.alfresco.com/wiki/Forms#Configuring_Controls)以了解如何设置它。

您可以从复制 textfield.ftl 控件开始，并设置一个最大长度或一个不错的 JavaScript 最大值。你甚至可以用鼠标添加一些花哨的东西，它会显示最大字符为 x 的信息。

# ruby - 如何使 Yard `@macro`s 适用于多个文件

> ID：10324926
> 
> 赞同：3
> 
> 时间：2012-04-25T22:51:32.957
> 
> 标签：ruby, documentation, yard

如果我在**一个文件**中有以下内容：

```
module Something
  class Resource
    # Defines a new property
    # @param [String] name the property name
    # @param [Class] type the property's type
    # @macro [attach] property
    #   @return [$2] the $1 property
    def self.property(name, type) end
  end

  class Post < Resource
    property :title, String
    property :view_count, Integer
  end
end 
```

用 get 定义的方法`property`正确记录。但是，如果我在单独的文件中有这些定义，则无法正确生成文档，例如以下情况：

`file0.rb`：

```
require 'file1.rb'
require 'file2.rb' 
```

`file1.rb`：

```
module Something
  class Resource
    # Defines a new property
    # @param [String] name the property name
    # @param [Class] type the property's type
    # @macro [attach] property
    #   @return [$2] the $1 property
    def self.property(name, type) end
  end
end 
```

`file2.rb`：

```
module Something
  class Post < Resource
    property :title, String
    property :view_count, Integer
  end
end 
```

当在单独的文件中时，**Yard 宏**在生成文档时不会保留。如何实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T04:36:13.993

YARD 不跟随`require`调用，它也是一个单遍解析器，这意味着解析顺序很重要。基本上，定义宏的文件必须在使用它的文件之前进行解析。据推测，您的文件实际上并未命名为“file1.rb”和“file2.rb”，否则默认的全局排序可能对您有利。

要处理多个文件，只需确保 YARD 首先解析您的“file1.rb”。您可以通过将其放在 glob 的前面来做到这一点，如下所示：

```
$ yard doc lib/path/to/file1.rb lib/**/*.rb 
```

（“但它会列出 'file1.rb' 两次，”你说？不要担心列表的唯一性，YARD 会为你做到这一点）

# jquery-plugins - 编写自己的jquery插件时如何传递参数

> ID：10324927
> 
> 赞同：0
> 
> 时间：2012-04-25T22:51:35.400
> 
> 标签：jquery-plugins, parameter-passing, undefined, javascript

我正在使用以下模式编写一个 javascript 库，但它无法接收传递给函数的参数，我在这里遗漏了什么吗？

```
(function($){

    var Foo = function(elements, options){
    ... ...
    }

    Foo.prototype = {

        constructor: Foo,

        bar: function(arg){        
            console.log(arg);     // print 'undefined' here
        },

    }

    $.fn.foo = function(option){
        return this.each(function(){
        ... ...
        })
    }

    $.fn.foo.Constructor = Bricker

    $.fn.foo.defaults = {
        ... ...
    }

})(jQuery) 
```

当我调用 $('select').foo('bar', content) 时，内容将被记录为 'undefined'，谁能告诉我问题所在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-17T10:34:44.793

在这种情况下`Foo.prototype`，`$.fn.foo`两者的工作方式不同，请尝试以下代码来创建 jquery 函数，例如，

```
;(function(){
    $.fn.foo = function(name,value){
       console.log(name,value);
    };
})(jQuery); 
```

你可以用任何`jquery-selector`喜欢的方式调用它

```
$('#id').foo('bar','value');// check your console to see the magic. 
```

而且，您的第二个场景（原型）在某种程度上有所不同，您正在使用原型方法（不同于`jQuery.fn`）来运行您的代码，请尝试以下操作，

```
var Foo = function() {};
Foo.prototype = {
    constructor: Foo,
    bar: function(arg){        
        console.log(arg); // print 'test' here
    }
};
var f=new Foo();
f.bar('test'); 
```

```
;(function($){
    $.fn.foo = function(name,value){
           console.log(name,value);
    };
})(jQuery);
$(document).foo('bar','value');

var Foo = function() {};
Foo.prototype = {
    constructor: Foo,
    bar: function(arg){        
        console.log(arg);     // print 'undefined' here
    }
};
var f=new Foo();
f.bar('test');
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

还有一个[jsfiddle](http://jsfiddle.net/rohankumar1524/42tm3b7c/)和[一个解释性的答案](https://stackoverflow.com/a/310914/1817690)来解决你的疑问。

# orchardcms - 将多个地址附加到一名员工

> ID：10324930
> 
> 赞同：0
> 
> 时间：2012-04-25T22:51:44.140
> 
> 标签：orchardcms

我正在创建一个自定义员工模块。一名员工最多可以拥有三个地址。我正在尝试关注这篇文章 - [http://docs.orchardproject.net/Documentation/Creating-1-n-and-nn-relations](http://docs.orchardproject.net/Documentation/Creating-1-n-and-n-n-relations)

这就是我在 Migrations.cs 中的内容。

```
 SchemaBuilder.CreateTable("EmployeeRecord",
        table => table
            .ContentPartRecord()
            .Column<int>("EmployeeId")
            ...
            .Column<int>("AddressRecord_Id")
        );

SchemaBuilder.CreateTable("AddressRecord",
    table => table
        .Column<int>("Id", column => column.PrimaryKey().Identity())
        ...
    ); 
```

这是模型。

```
public class EmployeeRecord : ContentPartRecord {
    public virtual int EmployeeId { get; set; }
    ...
    public virtual AddressRecord AddressRecord { get; set; }
}

public class AddressRecord {
    public virtual int Id { get; set; }
    ...
} 
```

提交 create-new-employee 表单时，我得到具有多个地址的数据。我可以创建一个新的员工内容类型。但我不确定如何创建三个地址并将其分配给该员工。有什么帮助吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T01:28:27.523

您的模型的基础知识错了：如果员工有地址，那么地址应该指向员工，而不是员工指向地址。除非你真的永远不会有超过三个，在这种情况下你可以拥有 Address1、Address2 和 Address3 属性。无论如何，我建议在继续之前阅读更多关于关系数据库中关系表示的内容。

# apache - 如何编写自己的请求正文解析方法来覆盖 Apache2::Request 中的默认方法

> ID：10324935
> 
> 赞同：2
> 
> 时间：2012-04-25T22:52:15.733
> 
> 标签：apache, mod-perl

我正在使用 mod_perl 来处理文件上传（多部分/表单数据）。
上传文件时，Apache2::Request 会自动解析请求正文并将内容存储到 tmp 文件中。

我的问题是，有什么简单的方法可以编写自己的请求主体处理方法，它可以覆盖默认的处理方法，因为我需要对文件主体进行额外的处理，例如加密等。

到目前为止，我发现的唯一方法是使用 UPLOAD_HOOK，但在文档中，它说：

“设置在读取文件上传数据时运行的回调。这可用于在文件上传期间提供上传进度表。在挂钩退出后，Apache 将自动继续将原始数据写入 $upload->fh。”

这意味着默认输入处理程序将在生成第二个 tmp 文件的 upload_hook 之后再次处理该文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T06:15:29.630

我相信你现在已经解决了这个问题，但我还是会发布。
您可以轻松地继承 Apache2::Request，请参阅： [继承 Apache2::Request](http://httpd.apache.org/apreq/docs/libapreq2/group__apreq__xs__request.html)
这是另一个示例的 CPAN 模块： [Apache2::REST::Request.pm](http://search.cpan.org/~jeteve/Apache2-REST-0.07/lib/Apache2/REST/Request.pm)

# python - 列表在 2 点之间的某个位置丢失一个元素，而该区域中的列表没有执行任何操作

> ID：10324937
> 
> 赞同：0
> 
> 时间：2012-04-25T22:52:46.620
> 
> 标签：python, list

```
 print liveCoords                                      # displays [(0,0),(1,0),(2,0)]
  if population > 3 or population < 2:
      if (j,i) in liveCoords:
          try:
              del liveCoords2[liveCoords2.index((j,i))]
          except:
              pass
  elif population == 3:
      if (j,i) in liveCoords:
          pass
      else:
          liveCoords2.append((j,i))
  print liveCoords                                       # displays [(1,0),(2,0)] 
```

我的问题不是关于如何做一些具体的事情，而是我的列表 liveCoords 如何在这两点之间改变，据我所知，没有做任何可能改变 liveCoords 的事情，但它正在被改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:58:33.530

你是`liveCoords2`用这条线创作的`liveCoords2 = liveCoords`吗？如果是这样，那么它们都是对同一个列表的引用，因此添加或删除元素`liveCoords2`也会影响`liveCoords`。

如果是这种情况，那么将分配更改为`liveCoords2 = list(liveCoords)`or`liveCoords2 = liveCoords[:]`将解决此问题。请注意，这两种方法都将创建浅拷贝，如果其中的任何元素`listCoords`是可变对象，那么`listCoords2`将引用与 相同的对象`listCoords`，这对于您当前的代码应该没问题，但如果您最终需要创建深层副本可以使用[复制](http://docs.python.org/library/copy.html#module-copy)模块：

```
import copy
liveCoords2 = copy.deepcopy(liveCoords) 
```

# c++ - 获取 PrintDialog 的结果

> ID：10324946
> 
> 赞同：0
> 
> 时间：2012-04-25T22:54:27.587
> 
> 标签：c++, visual-c++, c++-cli, printdialog, dialogresult

好的，在我的程序中，我正在显示一个 printDialog，我希望能够知道用户是单击打印按钮还是取消按钮。在我看到的所有在线示例中，printDialogs 都有 OK 按钮，而不是 Print 按钮。

例如（来自 msdn 的代码）：

```
System::Windows::Forms::DialogResult result = printDialog1->ShowDialog();
if ( result == ::DialogResult::OK )
{
   //printing code here
} 
```

因此，如果没有 OK 按钮，显然这段代码是行不通的。

有人知道如何判断是否单击了打印按钮吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:16:57.857

“打印”按钮返回`DialogResult::OK`，因此可以安全地检查该值。

事实上，任何继承自[CommonDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.commondialog.aspx)的对话框都会返回 OK 以表示成功。

# javascript - 在 HTML 和 Javascript 中的图像上“绘制”

> ID：10324949
> 
> 赞同：6
> 
> 时间：2012-04-25T22:54:43.057
> 
> 标签：javascript, html

我正在构建一个网络应用程序，用户将通过用光标在图像上“绘图”来标记图像。我们会将用户的图纸发送到服务器以转换为 PNG 或其他格式进行存储。

我们需要这个应用程序在基于桌面和平板电脑的浏览器上工作，所以 Flash、Java 和 Silverlight 都出来了。我们希望支持 IE8+、FF、Chrome 和 Safari。是否有任何类型的 Javascript 库可以提供某种形式的类似 MS-Paint 的原始绘图功能，以便我可以将该数据发送到服务器？

[这个问题](https://stackoverflow.com/questions/304804/drawing-on-top-of-an-image-in-javascript)很相似，但我正在寻找可以编码有机的人类手势的东西，而不是把它们画出来。

（不，为每个不同的移动平台创建原生应用程序不在我们的核心能力或预算范围内，所以这不是一个可行的选择）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T22:58:03.857

您可以使用 html 画布元素或使用像[Raphael](http://raphaeljs.com/)这样的 SVG 库，例如[http://ianli.com/sketchpad/](http://ianli.com/sketchpad/)是使用 Raphael 的库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T23:00:52.577

您可以使用矢量图形渲染 JavaScript 库，例如[Raphaël](http://www.raphaeljs.com)。

Raphaël 还将支持大量的用户代理，因为它使用 IE (< 9) 的 VML 或现代浏览器的 SVG 呈现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:57:01.893

基本上，让一个`<canvas/>`元素覆盖你`<img/>`并让用户在画布上“绘画”。

绘画功能将取决于您需要什么，您没有具体指定，所以这就是我能提供的最大帮助。

# java - Android手机的“硬件版本”可以更改吗？

> ID：10324952
> 
> 赞同：1
> 
> 时间：2012-04-25T22:55:13.033
> 
> 标签：java, android, version, hardware

当您在 Android 设备上转到“设置”>“关于手机”时，它会为您提供内核、软件、硬件版本等。

我很好奇硬件版本是否真的会在任何给定的手机上发生变化。我从之前的经验中得知我的手机和更新 ROM/内核/调制解调器的所有其他数字和版本都有更改的能力，但我相当有信心硬件版本往往保持不变，只需要确认。

我之所以这样问是因为我对制作一个应用程序感到好奇，然后为某些手机类型为该应用程序添加特定功能，即只向 Galaxy s2 (d710.10) 的所有变体显示一些数据并抓取的手机此数据来自 android.os.Build.MODEL（或 Build.PRODUCT）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T02:46:18.773

这些字段是 build.prop 的一部分。build.prop 可以在有根手机上编辑，否则不能。

# drupal - Drupal Commerce 添加输入小部件

> ID：10324953
> 
> 赞同：0
> 
> 时间：2012-04-25T22:55:21.127
> 
> 标签：drupal, drupal-commerce

除了问别无选择

使用 Drupal Commerce，我创建了

1.  一种产品类型
2.  将产品添加为实体
3.  创建了一个与实体有关系的节点。

工作正常。我想为产品类型添加自定义文本输入。例如产品上的品牌名称

根据我收集的信息，您可以使用自定义订单项或添加小部件（不知道如何）

有没有可用的指南？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:01:49.473

转到您创建的产品内容类型，然后单击管理字段。此页面列出了为内容类型声明的所有字段。此页面还允许您向内容类型添加新字段。添加一个文本类型的新字段，这应该完成。

# c - 分配或传递缓冲区？

> ID：10324955
> 
> 赞同：2
> 
> 时间：2012-04-25T22:55:34.417
> 
> 标签：c, performance, struct, compiler-optimization

假设*缓冲区*是一个由多个成员组成的结构，包括一个数组。

使用通常的优化标志进行编译，运行这两个代码片段应该会有什么样的性能差异？

```
buffer buf;
for (int i = 0; i < BIG_ENOUGH_NUMBER; i++) {
   init(huge_file, i, &buf);
}

// buf is not used afterward

...

void init(FILE* f, int i, buffer* b) {
   ... // b is filled using f, according to i
   do_something(b);
} 
```

对比

```
for (int i = 0; i < BIG_ENOUGH_NUMBER; i++) {
   init(huge_file, i);
}

...

void init(FILE* f, int i) {
   buffer buf;
   ... // buf is filled from scratch using f, according to i
   do_something(&buf);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T00:01:38.157

第一个答案是：对它们进行基准测试。

第二个答案是：将它们编译为汇编语言，并查看源代码。在有和没有优化标志的情况下这样做可能是有启发性的。

正如 abelenky 所指出的，在这两种情况下`buf`都在堆栈上。我的一般猜测是第二种情况会稍微快一些（使用我使用的编译器），因为 buf 不必作为参数传递。它确实必须在堆栈上分配，但堆栈分配通常只是函数调用帧的大小略有不同。无论该帧有多大，都必须完成相同数量的工作（调整堆栈指针）。

所以我希望生成代码的主要区别是在第二种情况下少一条“PUSH”指令，假设有足够的参数必须进入堆栈。（如果它们都在寄存器中，那就有点不同了。）

它可能会受到优化的影响，例如是否`buf`在每种情况下都以寄存器结尾。但是填充 buf 的缺失代码可能会影响这一点，所以我不会推测。

请注意，以上是我基于查看编译器行为的猜测。理论上，只要生成的程序正确运行，编译器就可以按照他们喜欢的方式翻译代码，这使得很难概括他们可能会或可能不会做哪些优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:05:06.570

@TJD 在他的评论中是正确的。

在这两种情况下，`buf`都在堆栈上，如果它很大，则有可能导致问题。您通常应该使用`malloc`.

也就是说，在您的第二个示例中，`buf`完全在`init`函数内部，并且在该函数返回给调用者的那一刻消失（在您的示例中调用者未命名）。

`init`实际上是无用的，因为完成的所有工作都丢失了，并且在调用函数中不可见。

在第一个示例中，返回`buf`后仍然有效`init`。

# android - 如何在 Android 运行时导入共享对象库？

> ID：10324956
> 
> 赞同：2
> 
> 时间：2012-04-25T22:55:44.490
> 
> 标签：android, android-ndk, java-native-interface, shared-libraries

我正在开发一个开源模拟器项目，它有多个可定制的原生插件。这些插件构建为原生共享对象库（.so 文件），并通过 JNI 在原生和 Java 之间提供各种接口。与其将 APK 与每个创建的插件一起分发，而且为了允许人们构建自己的自定义插件，我需要一种在安装应用程序后随时导入这些 .so 文件的方法。

我发现我可以将文件复制到文件夹 /data/data/[package_name]，但不能复制到 lib/ 子文件夹（因为它归“系统”组所有）。要在 Java 中使用 JNI 接口，我必须调用 System.loadLibrary( libname ); 但是，这似乎要求 .so 文件位于 lib/ 子文件夹中。我能想到的唯一方法是要求用户拥有一个根设备。还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T14:30:12.370

使用 System.load() 代替：

```
static
{
    final String[] libs = {
        "/data/data/com.foo.test/lib/liba.so",
        "/data/data/com.foo.test/lib/libb.so"
    };

    for (int i=0; i<libs.length; ++i)
    {
        Log.d(TAG, "Loading " + libs[i] + "...");
        System.load(libs[i]);
    }
} 
```

$亚行日志猫

D/LibTest (1022): 加载 /data/data/com.foo.test/lib/liba.so...
D/dalvikvm(1022): 试图加载 lib /data/data/com.foo.test/lib /liba.so 0x40512640
D/dalvikvm（1022）：添加了共享库 /data/data/com.foo.test/lib/liba.so 0x40512640
D/dalvikvm（1022）：在 /data/data/com 中找不到 JNI_OnLoad。 foo.test/lib/liba.so 0x40512640，跳过初始化
D/LibTest（1022）：加载 /data/data/com.foo.test/lib/libb.so...
D/dalvikvm（1022）：试图加载lib /data/data/com.foo.test/lib/libb.so 0x40512640
D/dalvikvm（1022）：添加共享库 /data/data/com.foo.test/lib/libb.so 0x40512640
D/dalvikvm（1022 ): 在 /data/data/com.foo.test/lib/libb.so 0x40512640 中找不到 JNI_OnLoad，跳过初始化

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T23:20:37.593

将您的插件分发为 APK，并通过 IPC 机制从主机与插件通信：

*   播送`Intents`
*   服务（命令或绑定模式）
*   `ContentProvider`

作为附带奖励，如果插件需要比主机更多/不同的权限，则支持此功能。

诚然，这将需要 IPC，它增加了不平凡的开销，引导您朝着粗粒度的插件通信协议的方向发展。而且，它会消耗更多的 RAM（额外的 CPU 时间会消耗更多的电池寿命）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T15:24:39.133

您可以使用 dlopen 使用 c++ 加载 so 文件。我在 c++ 中使用此代码将 so 文件加载到任何文件夹中。

```
// KGEmain function pointer
typedef void (*KGEmain) ();

std::string strPluginName = "/data/data/com.kge.android/lib/lib";
strPluginName += appname;
strPluginName += ".so";

void* handle = dlopen(strPluginName.c_str(), RTLD_LAZY);

const char* error;

if (!handle)
{
    LOGE("can't load the %s plugin. (%s)", strPluginName.c_str(), dlerror());
    return;
}
// Clear any exiting error
dlerror();

// Load the KGEmain function
pFn = (KGEmain)dlsym(handle, "KGEmain");
if ((error = dlerror()) != NULL || !pFn)
{
    LOGE("KGEmain function dose not find in %s plugin.\n%s", strPluginName.c_str(), error);
    return;
}

pFn(); 
```

# c - 没有任何可以理解的理由中止 C 中的陷阱（对我来说 ;)）

> ID：10324957
> 
> 赞同：-2
> 
> 时间：2012-04-25T22:55:50.860
> 
> 标签：c, memory-management, abort, off-by-one

使用命令“gcc -lm”编译以下代码没有任何问题：

```
/*  The code was considerable shortened for a clearer understanding     */

#include <stdio.h> 
#include <stdlib.h> 
#include <math.h>
#include <string.h> 
#include <complex.h>

#define N       (21)            /*  Number of positions of the chain        */

double Tleft, Tright, gama, J, k, Ji, C, omega;

void rk4(double h, complex a[N], complex da[N], double b[N],double db[N],double c[N], double dc[N])
{;}

int main()
{
    double tmax, dt;                //max time and lenth of the step
    double xn[N], dxn[N], pn[N], dpn[N];
    complex alfan[N], dalfan[N];
    double tempo;
    char fileName[100];         
    FILE *outputFile;
    int i, j;
    int printEvery;

    //Asking for input

    printf("tmax = ");              //These variables are either used in main() or in rk4()
    scanf("%lf", &tmax);
    printf("%f\n", tmax);
    printf("dt = ");
    scanf("%lf", &dt);
    printf("%f\n", dt);
    printf("Tleft = ");
    scanf("%lf", &Tleft);
    printf("%f\n", Tleft);
    printf("Tright = ");
    scanf("%lf", &Tright);
    printf("%f\n", Tright);
    printf("gamma = ");
    scanf("%lf", &gama);
    printf("%f\n", gama);
    printf("J = ");
    scanf("%lf", &J);
    printf("%f\n", J);
    printf("k = ");
    scanf("%lf", &k);
    printf("%f\n", k);
    printf("Ji = ");
    scanf("%lf", &Ji);
    printf("%f\n", Ji);
    printf("C = ");
    scanf("%lf", &C);
    printf("%f\n", C);
    printf("omega = ");
    scanf("%lf", &omega);
    printf("%f\n", omega);
    printf("print every ");
    scanf("%d", &printEvery);
    printf("%d\n", printEvery);
printf("Print this");

    for (i = 1; i<=N; i++)          //Initializing vectors
    {
        alfan[i] = 0.0+0.0i;
        dalfan[i] = 0.0+0.0i;
        xn[i] = 0.0;
        dxn[i] = 0.0;
        pn[i] = 0.0;
        dpn[i] = 0.0;
    }

    tempo = 0.0;                    //Initializing time

    //Initializing the file and printing its column titles

    sprintf(fileName, "tmax=%.4f, dt=%.4f, Tleft=%.4f, Tright=%.4f, gamma=%.4f, J=%.4f, k=%.4f, Ji=%.4f, C=%.4f, omega=%.4f, every%d.dat", tmax, dt, Tleft, Tright, gama, J, k, Ji, C, omega, printEvery);
    outputFile = fopen(fileName, "w");
    fprintf(outputFile, "tempo\t\t");
    for (i = 1; i<=N; i++)                              //alfas
    {
        fprintf(outputFile, "realfa[%d]\timalfa[%d]\t", i, i);
    }
    for (i = 1; i<=N; i++)                              //x's
    {
        fprintf(outputFile, "x[%d]\t\t", i);
    }
    for (i = 1; i<=N-1; i++)                            //p's
    {
        fprintf(outputFile, "p[%d]\t\t", i);
    }
    fprintf(outputFile, "p[%d]\n\n", i);

    j = 0;

    while (tempo < tmax)            
    {
        if (j % imprimirCada == 0)
        {
            fprintf(outputFile, "%f\t", tempo);                     //tempo
            for (i = 1; i<=N; i++)                          //alfas
            {
                fprintf(outputFile, "%f\t%f\t", creal(alfan[i]), cimag(alfan[i]));
            }
            for (i = 1; i<=N; i++)                          //x's
            {
                fprintf(outputFile, "%f\t", xn[i]);
            }
            for (i = 1; i<=N-1; i++)                        //p's
            {
                fprintf(outputFile, "%f\t", pn[i]);
            }
            fprintf(outputFile, "%f\n", pn[i]);

        }

        j++;
        rk4(dt, alfan, dalfan, xn, dxn, pn, dpn);
        tempo += dt;
    }

    printf("\n");

    return 0;       
} 
```

当我运行它时，我得到：

```
tmax = 1 
1.000000
dt = 0.1
0.100000
Tleft = 0.1
0.100000
Tright = 0.2
0.200000
gamma = 0.5
0.500000
J = 0.001
0.001000
k = 0.001
0.001000
Ji = 0.001
0.001000
C = 0.001
0.001000
omega = 0.01
0.010000
print every 1
1
Abort trap 
```

是什么导致了“中止陷阱”，为什么我没有得到最后一个 'printf("Print this")' 句子？

谢谢您的帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:04:30.197

您看不到 ，`Print this`因为您没有在其上包含换行符，因此它位于行缓冲区中。我建议使用调试器来追踪陷阱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:06:31.310

C 中的数组是 0 索引的，因此 xn[N] （除其他外）的索引从 0 .. N-1 运行，但您从 1 .. N 循环。

# r - 使用 R 的 VAR 模型中系数稳定性的 QLR 检验

> ID：10324960
> 
> 赞同：2
> 
> 时间：2012-04-25T22:56:15.857
> 
> 标签：r, time-series

我已经为这个数据集拟合了一个简单的双变量 VAR 模型，我想运行 QLR 测试来检查系数随时间的稳定性。我查看了“strucchange”包，但无法弄清楚如何实际运行一个简单的 QLR 测试。

时间序列中的任何 R-pro 都可以帮助我吗？非常感谢。！

```
var.est_2 <- VAR(z.train, ic= "FPE", type = "const") # var.est_2 has the estimates of VAR 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T12:12:47.243

QLR 检验只是 Chow 检验对某个样本的最大 F 统计量。Fstats() 函数为您提供您想要的。以下是使用菲利普斯曲线的示例：

```
require(strucchange)
data("PhillipsCurve")
model <- dp ~ dp1 + u1
qlr <- Fstats(model,data=PhillipsCurve)
plot(qlr,alpha=0.05) 
```

图中的黑线是一组 F 统计量。最大 F-stat 是 QLR stat。红线是基于 Andrews (1993) 和 Hansen (1997) 的临界值。在这种情况下，我们将无法拒绝没有结构变化的空值。我不确定 strucchange 与 vars 包的效果如何。但是由于可以逐行估计 VAR，您可以简单地使用 lm() 重新估计每个方程，然后应用 Fstats() 函数。另外，请查看本文的第 5 部分：http: [//www.jstatsoft.org/v07/i02/paper](http://www.jstatsoft.org/v07/i02/paper) 他们还有另一个使用纠错模型的示例。

# c - 架构 x86_64 MAC GCC 的未定义符号

> ID：10324961
> 
> 赞同：0
> 
> 时间：2012-04-25T22:56:16.213
> 
> 标签：c, xcode, macos, gcc

所以我正在尝试运行一些在 Windows 中完美编译的 c 代码，并尝试使用 Xcode 和 gcc 编译器运行相同的代码，当我尝试编译时，我的代码中出现此错误

架构 x86_64 的未定义符号：“_stricmp”，引用自：cckZHFWV.o 中的 _PrintResults ld：未找到架构 x86_64 的符号 collect2：ld 返回 1 个退出状态

并且无法弄清楚为什么我会收到此错误

这是我要编译的代码

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "definitions.h"

//#define DEBUG 1

int main(int argc, char *argv[]) {
    FILE *config_file, *trace;
    unsigned int address, exec_info;
    char check, trash[25], op;
    int j, para;
    int i=0;

    //    char valid,dirty;
    //    unsigned int tag;
    //    next *tagstr;
    //    bptr tptr
    //    check if tptr is at head of list dont use bptr, dummy pointer

    if(argc >= 2)   
    config_file = fopen(argv[1],"r");    
    else 
    config_file = fopen("config0.txt","r");

    // Grabs desired cache parameters from the specified config files
    while(fscanf(config_file,"%s %d\n",trash,&para) == 2) {
    config[i] = para;
   i++;      
    }

    // Close the config file
    fclose(config_file);

    // Puts Cache parameters from config file in desired variables
    InitializeParameters();

    // Initializes the L1 and L2 caches into Linked List
    CacheInit();

    // Checks to see if file exists
    trace = fopen("I10.txt","r");
    if (!trace) {
    puts("I1.txt not found!");
    return 1;
    }

    while (fscanf(trace,"%c %x %x\n",&op,&address,&exec_info) == 3) {
    //printf("Op is %c, Address is %x, and exec is %x\n",op,address,exec_info); 
    switch(op) {
    case 'L': {
        load_count++;
        total++;
        //printf("Welcome to Load.\n");
        // do something
    }
    break;      
    case 'S': {
        store_count++;
        total++;
        //printf("Welcome to Store.\n");
        // do something here also
    }
    break;
    case 'B': {
        branch_count++;
        total++;
        //printf("Welcome to Branch.\n");
        // oh, don't forget this
    }
    break;      
    case 'C': {
        comp_count++;
        total++;
        //printf("Welcome to Computation.\n");        
        // Here, too 
    }
    break;
    }   // Handles incoming Operation data   
    }

    // Prints the Results of the Simulation
    PrintResults(argv[1]);
}

int InitializeParameters() {   
    L1_cache_size = config[0];
    L1_block_size = config[1];
    L1_assoc = config[2];
    L1_hit_time = config[3];
    L1_miss_time = config[4];
    L2_block_size = config[5];
    L2_cache_size = config[6];
    L2_assoc = config[7];
    L2_hit_time = config[8];
    L2_miss_time = config[9];
    L2_transfer_time = config[10];
    L2_bus_width = config[11];
    mem_sendaddr=config[12];
    mem_ready=config[13];
    mem_chunktime=config[14];
    mem_chunksize=config[15];    
}

int CacheInit() {
if(L1_assoc == 0){
L1_assoc = L1_cache_size / L1_block_size;
L1_sets = 1;
}
else
L1_sets = L1_cache_size / L1_block_size / L1_assoc;

if(L2_assoc == 0){
L2_assoc = L2_cache_size / L2_block_size;
L2_sets = 1;
}
else
L2_sets = L2_cache_size / L2_block_size / L2_assoc;    
}

int PrintResults(char *config_file) {
printf("--------------------------------------------------------\n");
printf("                   Simulation Results\n");
printf("--------------------------------------------------------\n");

// Trace File
printf("Trace File:\n");

// Cache Name
printf("Cache Type: ");
if (config_file == NULL)
printf("Direct Mapped\n\n");
if (stricmp("config0.txt",config_file) == 0)
printf("Direct Mapped\n\n");
if (stricmp("config1.txt",config_file) == 0)
printf("L1-2way\n\n");
if (stricmp("config2.txt",config_file) == 0)
printf("L2-2way\n\n");
if (stricmp("config3.txt",config_file) == 0)
printf("All-2way\n\n");
if (stricmp("config4.txt",config_file) == 0)
printf("2-4-way\n\n");
if (stricmp("config5.txt",config_file) == 0)
printf("L2-Big\n\n");
if (stricmp("config6.txt",config_file) == 0)
printf("All-FA\n\n");
if (stricmp("config7.txt",config_file) == 0)
printf("Direct Mapped 2 x Memory Chunksize\n\n");
if (stricmp("config8.txt",config_file) == 0)
printf("Direct Mapped 4 x Memory Chunksize%s\n\n");     

// Cache info
printf("Memory System:\n");
printf("  DCache Size = %Lu : Ways = %Lu : Block Size = %Lu\n",
   L1_cache_size, L1_assoc, L1_block_size);
printf("  ICache Size = %Lu : Ways = %Lu : Block Size = %lu\n",
   L1_cache_size, L1_assoc, L1_block_size);
printf("  L2-Cache Size = %Lu : Ways = %Lu : Block Size = %lu\n",
   L2_cache_size, L2_assoc, L2_block_size);
printf("  Memory Ready Time = %Lu : Chunksize = %Lu : Chunktime = %lu\n\n", mem_ready, mem_chunksize, mem_chunktime);

// Time
printf("Time:\n");
printf("  Execute Time = %Lu :", time);
printf(" Total Refs = %Lu\n", total + data_refs);
printf("  Inst Refs = %Lu :", total);
printf(" Data Refs = %Lu\n\n", data_refs);

// Number of Instructions
printf("Number of Instructions: [Percentage]\n");
printf("  Loads  (L) = %Lu",load_count);
printf(" [%.1f%%] :",100*load_count/ (double) total);
printf(" Stores (S) = %Lu",store_count);
printf(" [%.1f%%]\n",100*store_count/ (double) total);
printf("  Branch (B) = %Lu",branch_count);
printf(" [%.1f%%] :",100*branch_count/ (double) total);
printf(" Comp   (C) = %Lu",comp_count);
printf(" [%.1f%%]\n",100*comp_count/ (double) total);
printf("  Total  (T) = %Lu\n\n",total);

// Number of Cycles
printf("Cycles for Instructions: [Percentage]\n");
printf("  Loads  (L) = %Lu",load_cycle);
printf(" [%.1f%%] :",100*load_cycle/ (double) total_cycle);
printf(" Stores (S) = %Lu",store_cycle);
printf(" [%.1f%%]\n",100*store_cycle/ (double) total_cycle);
printf("  Branch (B) = %Lu",branch_cycle);
printf(" [%.1f%%] :",100*branch_cycle/ (double) total_cycle);
printf(" Comp   (C) = %Lu",comp_cycle);
printf(" [%.1f%%]\n",100*comp_cycle/ (double) total_cycle);
printf("  Total  (T) = %Lu\n\n",total_cycle);

// CPI
printf("Cycles Per Instructions:\n");
printf("  Loads      (L) = %.1f :", load_cycle/(double) load_count);
printf("  Stores (S) = %.1f%\n", store_cycle/(double) store_count);
printf("  Branch     (B) = %.1f :",
   branch_cycle/(double) branch_count);
printf("  Comp   (C) = %.1f\n", comp_cycle/ (double) comp_count);
printf("  Overall  (CPI) = %Lu\n\n", total_cycle/ (double) total);

// Real/Simulated Comparision
printf("Perfect to Simulation Comparision:\n");
printf("  Cycles for Processor w/Perfect Memory System %Lu\n",
   perfect_cycle);
printf("  Cycles for Processor w/Simulated Memory System %Lu\n",
   total_cycle);
printf("  Ratio of Simulated/Perfect Performance = %.6f\n\n",
   total_cycle/ (double) perfect_cycle );

// L1 ICache Hit/Miss
printf("Memory Level: L1 ICache\n");
printf("  Hit Count = %Lu : ", L1_I_hits);
printf("Miss Count = %Lu : ", L1_I_misses);
printf("Hit Count = %Lu\n", L1_I_hits+L1_I_misses);
printf("  Hit Rate = %.1f%% : Miss Rate = %.1f%%\n",
   100*L1_I_hits / (double) (L1_I_hits + L1_I_misses),
   100*L1_I_misses / (double) (L1_I_hits + L1_I_misses));
printf("  Kickouts = %Lu : ", L1_I_kickouts);
printf("Dirty Kickouts = %Lu : ", L1_I_kickouts_dirty);
printf("Transfers = %Lu\n\n", L1_I_transfers);

// L1 DCache Hit/Miss
printf("Memory Level: L1 DCache\n");
printf("  Hit Count = %Lu : ", L1_D_hits);
printf("Miss Count = %Lu : ", L1_D_misses);
printf("Hit Count = %Lu\n", L1_D_hits+L1_D_misses);
printf("  Hit Rate = %.1f%% : Miss Rate = %.1f%%\n",
   100*L1_D_hits / (double) (L1_D_hits + L1_D_misses),
   100*L1_D_misses / (double) (L1_D_hits + L1_D_misses));
printf("  Kickouts = %Lu : ", L1_D_kickouts);
printf("Dirty Kickouts = %Lu : ", L1_D_kickouts_dirty);
printf("Transfers = %Lu\n\n", L1_D_transfers);

// L2 Cache Hit/Miss
printf("Memory Level: L2\n");
printf("  Hit Count = %Lu : ", L2_hits);
printf("Miss Count = %Lu : ", L2_misses);
printf("Hit Count = %Lu\n", L2_hits+L2_misses);
printf("  Hit Rate = %.1f%% : Miss Rate = %.1f%%\n",
   100*L2_hits / (double) (L2_hits + L1_D_misses),
   100*L2_misses / (double) (L2_hits + L2_misses));
printf("  Kickouts = %Lu : ", L2_kickouts);
printf("Dirty Kickouts = %Lu : ", L2_kickouts_dirty);
printf("Transfers = %Lu\n\n", L2_transfers);

// Cost Analysis
printf("Cost:\n");
//L1 Cache Cost
L1_cost = (L1_cache_size / 4096) * 100 * (log2(L1_assoc) + 1);
cost += L1_cost*2;
printf("  L1 Cache Cost (ICache $%Lu) + (DCache $%Lu) = $%Lu\n",
   L1_cost, L1_cost, L1_cost*2);

// L2 Cache Cost
L2_cost = (L2_cache_size / (64*1024)) * 50 * (log2(L2_assoc) + 1);
cost += L2_cost;
printf("  L2 Cache Cost = $%Lu\n", L2_cost);

// Memory Cost
mem_cost = log2(100 / mem_ready) * 200 + 50;
mem_cost += (log2(mem_chunksize)-4)*100 + 25;
cost += mem_cost;
printf("  Memory Cost = $%Lu\n", mem_cost);

// Total Cost
printf("  Total Cost = $%Lu\n", cost);
} 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:59:00.713

`stricmp`不是标准库函数，也不是可移植的。 `strcasecmp`是便携功能。

# r - 不同组的相加连续数区间r

> ID：10324965
> 
> 赞同：-1
> 
> 时间：2012-04-25T22:56:52.573
> 
> 标签：r, numbers, sum

我有以下类型的大向量：

```
myvec <- c(1,2,3,5,  0,1,2,5,8,  0,1,3,  0,2,3,8,  0,3,5) 
```

group 对应的向量是：

```
grp <- c(rep(1, 4), rep(2, 5), rep(3,3), rep(4, 4), rep(5, 3)) 
```

我需要以这样的方式添加数字，以便将连续组的最后一个数字添加到第二组中的距离加上 2（以创建间隙）。然后第二组的最后一个数字将添加到第三个 pus 3 以创建一个间隙。

因此新向量看起来像

```
 myvecnew <- c(1,  2, 3 ,5,  # maximum 5 + 2 applied in group 2

     5+0+2 = 7, 5+1+2 = 8, 5+2+2 = 9, 5+5+2 = 12, 8+5+2 = 15, # maximum 15 + 2 applied in group 3

       0+15+2 = 17, 1+15+2 = 18, 3+15+2 = 20, # maximum 20 + 2 applied to group 4 

                  0 + 20 + 2 = 22,..........and so on) 
```

因此，第 1 组加 2 的最大值（值）被添加到每个第 2 组值中，第 2 组的新最大值将被添加到第 3 组加上常数 2，我需要继续前进，直到所有组都被覆盖。如何做到这一点？...........

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:46:27.443

阅读我认为是问题中的 2 个错误（见评论），我相信你可以实现你想要的：

```
grps   = lapply(unique(grp), function(x) myvec[grp==x])
to.add = cumsum(sapply(grps, max) + 2)

> c(grps[[1]], unlist(lapply(2:length(grps), function(x) grps[[x]] + to.add[x-1])))
 [1]  1  2  3  5  7  8  9 12 15 17 18 20 22 24 25 30 32 35 37 
```

（如您所见，我也更喜欢使用列表）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T23:32:20.860

```
for(i in unique(grp)[-1])
{
    myvec[which(grp==i)]=
            2 +
            myvec[which(grp==i)]+
            max(myvec[which( grp==(i-1) )])
} 
```

# search - 使用 Solrj 提升 SOLR 中的字段

> ID：10324969
> 
> 赞同：2
> 
> 时间：2012-04-25T22:57:15.470
> 
> 标签：search, solr, lucene, solrj

我正在使用 solrj API 来查询我的 SOLR 3.6 索引。我有多个文本字段，我想对它们进行不同的加权。根据我的阅读，我应该能够使用 dismax 或 edismax 查询类型来做到这一点。我尝试了以下方法：

```
SolrQuery query = new SolrQuery();
query.setQuery( "title:apples oranges content:apples oranges");
query.setQueryType("edismax");
query.set("qf", "title^10.0 content^1.0");
QueryResponse rsp = m_Server.query( query ); 
```

但这不起作用。我尝试了以下变体来设置查询类型，但似乎没有什么不同。

```
query.setQueryType("dismax");
query.set("qt","dismax");
query.set("type","edismax");
query.set("qt","edismax");
query.set("type","dismax"); 
```

我想保留完整的 Lucene 查询语法，所以我更喜欢 ExtendedDisMax 而不是 DisMax。提升查询中的单个术语（如下所示）确实有效，但不是有效的解决方案，因为查询是自动生成的，并且语法可能会变得任意复杂。

```
query.setQuery( "title:apples^10.0 oranges^10.0 content:apples oranges"); 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T06:03:32.217

最好的方法是在你的 solrconfig.xml 中定义一个请求处理程序，比如 -

```
<requestHandler name="search" class="solr.SearchHandler" default="true">
 <lst name="defaults">
   <str name="echoParams">explicit</str>
   <str name="defType">dismax</str>
   <str name="qf">
      title^1 content^0.8
   </str>
   <str name="q.alt">*:*</str>
   <str name="rows">10</str>
   <str name="fl">*,score</str>
 </lst>
</requestHandler> 
```

并使用 qt 参数来定义请求处理程序 -

```
query.set("qt","search"); 
```

您可以通过更改 solr config xml 配置并重新加载内核来微调 boost 配置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-04T12:40:53.303

您应该能够以编程方式执行此操作。

如果您定义了处理程序：

```
<requestHandler name="dismax_nl" class="solr.SearchHandler"> <lst name="defaults"> <str name="defType">dismax</str> 
```

和下面的代码

```
solrQuery.put("defType", "dismax"); 
solrQuery.put("qf", "comments_nl^20 id^1 name_nl^1 description_nl^0.2 url_nl^0.5 text^0.1"); 
```

保持您的查询简单。qf 定义（加权）字段。您还应该能够在上面的示例中设置 qt=dismax_nl 而不是 deftype=dismax （这可能更好，但我展示的那个是我知道有效的东西）

# php - APNS 自定义声音

> ID：10324971
> 
> 赞同：3
> 
> 时间：2012-04-25T22:57:20.250
> 
> 标签：php, xcode, audio, apple-push-notifications

我想发送带有自定义声音的推送通知，但我总是尝试，我只听到默认的东西。

我的声音被命名为 wil.caf，我在我的 xcode 项目中有它。

这是我的 php 脚本来触发推送消息：

```
<?php

$message = $_GET["message"];

$deviceToken = $_GET["token"];

$devideToken = dechex ($deviceToken);
// Payload erstellen und JSON codieren

$payload['aps'] = array('alert' => $message, 'badge' => 0, 'sound' => 'default');
$payload = json_encode($payload);
$apnsHost = 'gateway.push.apple.com';

$apnsPort = 2195;

$apnsCert = 'apsDevBundle2.pem';

// Stream erstellen

$streamContext = stream_context_create();

stream_context_set_option($streamContext, 'ssl', 'local_cert', $apnsCert);

$apns = stream_socket_client('ssl://' . $apnsHost . ':' . $apnsPort, $error, $errorString, 2, STREAM_CLIENT_CONNECT, $streamContext);

if ($apns)

{

  // Nachricht erstellen und senden

  $apnsMessage = chr(0) . chr(0) . chr(32) . pack('H*', str_replace(' ', '', $deviceToken)) . chr(0) . chr(strlen($payload)).$payload;

  fwrite($apns, $apnsMessage);

  // Verbindung schliessen

  fclose($apns);

} 

else

{

  echo "Fehler!";

  var_dump($error);

  var_dump($errorString);

}

?> 
```

有谁能够帮我？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T10:42:49.313

您的示例有效负载将“默认”指定为要播放的声音。如果要播放自定义声音，请确保声音文件位于应用程序包中并按如下方式指定（使用 Apple 的示例 bingpong.aiff 声音文件）：

```
$payload['aps'] = array('alert' => $message, 'badge' => 0, 'sound' => 'bingbong.aiff' 
```

完整的 APNS 文档：http: [//developer.apple.com/library/ios/#DOCUMENTATION/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html#//apple_ref/doc/uid/TP40008194-CH100-SW9](http://developer.apple.com/library/ios/#DOCUMENTATION/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html#//apple_ref/doc/uid/TP40008194-CH100-SW9)

# c# - PublicKeyToken=null 是否忽略程序集绑定？

> ID：10324972
> 
> 赞同：20
> 
> 时间：2012-04-25T22:57:24.277
> 
> 标签：c#, .net

我的`app.config`.

```
<configuration>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
    <probing privatePath="bin2" />
    <dependentAssembly>
      <assemblyIdentity name="Foo" culture="neutral" publicKeyToken="null">
        <bindingRedirect oldVersion="0.0.0.0-3.0.0.0" newVersion="3.0.4497.27619" />
      </assemblyIdentity>
    </dependentAssembly>
  </assemblyBinding>
  ...
<configuration> 
```

Fusion logging 告诉我它没有在寻找`bin2`我的程序集。

*LOG：Initial PrivatePath = NULL*（它从不搜索`bin/Debug/bin2/Foo`）

这是没有的问题`publicKeyToken`吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-21T08:34:16.690

是的，对于非强命名（具有 publicKeyToken）的程序集，它们会被忽略，因为 CLR 会忽略这些程序集的版本号。

有关详细信息，请参阅[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/7wd6ex19.aspx)。

# ruby-on-rails - 从 Rackspace cloudfiles 下载带有carrierwave的文件不起作用

> ID：10324974
> 
> 赞同：1
> 
> 时间：2012-04-25T22:57:42.470
> 
> 标签：ruby-on-rails, carrierwave, fog

我正在使用 Carrierwave 将文本文件上传到 Rackspace，并使其正常工作。我的设置非常标准：

上传者：

```
class FileUploader < CarrierWave::Uploader::Base
  include CarrierWave::MimeTypes

  storage :fog

  def store_dir
    "/my/local/path"
  end
end 
```

模型：

```
class UploadedFile < ActiveRecord::Base
  attr_accessible :file

  mount_uploader :file, FileUploader
end 
```

载波初始化文件：

```
CarrierWave.configure do |config|
  config.fog_credentials = {
    :provider           => "Rackspace",
    :rackspace_username => "xxxxx",
    :rackspace_api_key  => "yyyyy"
  }
  config.fog_directory = "my_container"
  config.fog_host = "http://c000000.cdn.rackspacecloud.com"
  config.fog_public = false
end 
```

我不是从表单上传文件，而是使用延迟作业在后台进程中生成文件，然后将其上传到 Rackspace：

```
file = File.new("/my/local/path/some_text_file.txt", "r")
uploaded_file = UploadedFile.new
uploaded_file.file = file
uploaded_file.save 
```

到目前为止，一切都很好。我可以在我的 Rackspace 帐户中看到我的文件。我还看到我的模型已保存，并且我在 upload_files 表中有记录。

我的问题是检索文件。我尝试了以下方法：

```
downloader = FileUploader.new
downloader.retrieve_from_store!("some_text_file.txt") 
```

我意识到retrieve_from_store！实际上并没有下载文件。但是，接下来应该是：

```
downloader.cache_stored_file! 
```

但是该换行符是因为没有从先前的调用中检索到任何内容。

我认为我在下载时做了一些根本错误的事情，因为以下会产生奇怪的输出：

```
f = UploadedFile.first
f.file.url

"/my/local/path/some_text_file.txt" 
```

根据我看到的所有示例，我希望 f.file.url 返回一个 Rackspace CDN url。但它不是，而是返回 store_dir 路径。

**编辑**

我应该注意到 UploadedFile 模型的基础表有一个名为“file”的列，其中仅包含文件的基本名称，而不是 Rackspace 云文件的 url 或完整路径，这可能是问题的一部分......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-17T17:14:08.893

确保您已配置您的 RackSpace 帐户以启用对您文件的公开访问。在**Cloud / FilesContainers**下，编辑设置以启用 CDN。之后，公共链接将通过 CarrierWave::Uploader.url 提供

# c++ - 使用 Firebreath 和 Curl 加载插件

> ID：10324978
> 
> 赞同：0
> 
> 时间：2012-04-25T22:58:23.437
> 
> 标签：c++, curl, firebreath

我正在使用 Firebreath 和 Linux [Arch Linux](http://www.archlinux.org/)构建一个插件。当我尝试在另一个 Linux 系统（Ubuntu 11.10）中加载我的插件时出现以下错误。

```
[3957:3957:162659560325:ERROR:plugin_list.cc(448)] Loading plugin /home/admin/Documents/myplugin/0.1/npMediaDownload.so
[3957:3957:162659561719:ERROR:plugin_lib_posix.cc(158)] While reading plugin info, unable to load library /home/admin/Documents/myplugin/0.1/npMediaDownload.so (/usr/lib/libcurl.so.4: version `CURL_OPENSSL_4' not found (required by /home/admin/Documents/myplugin/0.1/npMediaDownload.so)), skipping. 
```

`#include "curl/curl.h"`我的MediaDownloadAPI.cpp 上已经有了。在我的项目文件夹中，我添加了以下内容：

**X11/projectDef.cmake**

```
target_link_libraries(${PROJECT_NAME} ${PLUGIN_INTERNAL_DEPS} curl ) 
```

**PluginConfig.cmake**

```
add_firebreath_library(curl) 
```

我在 Arch Linux 系统上编译和执行插件没有问题。

TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T15:44:27.480

最有可能的问题是您正在链接动态（.so）版本的 curl 并且您尝试加载它的系统缺少该库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T19:27:00.353

问题是因为 Openssl 版本。在 Arch linux Openssl 版本 4 和 Ubuntu 12.04 版本 3 中。我尝试添加`curl_easy_setopt(curl, CURLOPT_SSLVERSION, 3);`到我的程序中，但这并没有解决问题。我会将其标记为已解决，因为我知道问题是什么，但不知道解决方案。

# ios - iTunes Connect：“发布此版本”延迟？

> ID：10324981
> 
> 赞同：42
> 
> 时间：2012-04-25T22:58:49.173
> 
> 标签：ios, app-store, app-store-connect

在 iTunes Connect 中单击“发布此版本”后，新版本需要多长时间才能在 App Store 中提供？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-04-26T01:29:38.100

Apple 不保证需要多长时间。根据“版本[iTunes Connect 开发人员指南”](http://developer.apple.com/library/ios/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/iTunesConnect_Guide.pdf)：

> 单击出现的“发布此版本”按钮。
> 
> 然后，您的应用程序版本将在 App Store 上发布，**等待惯常的处理时间**。

单击“发布此版本”后，您的应用程序将在 Apple 的许多 iTunes 服务器上上线。我认为到每个服务器的传输过程有不同的延迟时间。我的经验是这需要 15 分钟到 4 小时。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-26T00:00:14.787

这个时间（至少根据我的经验）往往在几分钟到 1-2 小时之间，但肯定会在一天内更新。我注意到应用程序出现在 iTunes 上的速度似乎比它们出现在 App Store 中的速度要快。

# html - 最好的支持 HTML 和 CSS 代码验证的免费 Windows IDE？

> ID：10324987
> 
> 赞同：0
> 
> 时间：2012-04-25T22:59:38.233
> 
> 标签：html, css

我正在学习 CSS 和 HTML，所以我需要一个免费、清晰、易于理解且易于使用的 HTML 和 CSS IDE，最好有一个漂亮的 UI。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T23:03:57.427

来自 Microsoft 的 Visual Web Developer 2010 Express 看起来像您所需要的：http: [//www.microsoft.com/visualstudio/en-us/products/2010-editions/visual-web-developer-express](http://www.microsoft.com/visualstudio/en-us/products/2010-editions/visual-web-developer-express)

它是 Visual Studio 的免费版本，专门针对 Web 开发，包括（但不限于）HTML 和 CSS 开发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T23:04:47.380

Adobe Dreamweaver 是一个不错的 IDE。

谢谢

编辑

Dreamwaver 不是免费的 IDE。[Aptana](http://www.aptana.com/)是一个很好的免费 IDE。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T23:05:15.063

[dabblet](http://dabblet.com/)是一个简单的、基于 Web 的解决方案，可以满足您的需求。让您编辑 html 和 css 并实时查看结果。

# design-patterns - DDD 应用服务中的 CRUD？

> ID：10324988
> 
> 赞同：9
> 
> 时间：2012-04-25T22:59:52.900
> 
> 标签：design-patterns, architecture, repository, domain-driven-design

我是 DDD 的新手，但我正在尝试将 DDD 概念整合到我当前的项目中。

对于我域中的许多实体，客户需要执行所有标准的 CRUD 操作，独立于任何特定的工作流程。我发现自己拥有许多应用程序级服务，这些服务的名称如 UserService 或 LocationService ，它们只不过是各自存储库的门面而已。

这些作为存储库外观的应用程序服务是否是应用程序服务模式的“正确”应用程序？还是应该只使用 CRUD 的方法远离应用程序服务？如果是这样，接口层是否应该有一个存储库外观？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T05:12:44.710

这当然取决于应用程序，也可能是个人喜好问题，有些人选择更直接的方法并将存储库直接暴露给客户。这种方法的一个好处是简单。您没有遍历层来跟踪代码的执行。另一方面，应用程序服务的角色是领域层的外观或 API。

换句话说，应用服务封装了领域层并编排了领域逻辑的执行。通过这个标记，存储库也可以被应用程序服务封装。这种情况下的好处可以是一致性，因为域层的所有客户端都通过应用程序服务与其交互，无论它们是发出命令还是检索数据。

最佳解决方案取决于您的应用。如果所有必需的功能都是 CRUD 或主要是 CRUD，则不需要应用程序服务（或完全成熟的 DDD），因为在这种情况下，所有服务都委托给存储库，因此增加了不必要的复杂性。但是，应用程序服务也可以是管理事务和工作单元的便捷连接点，存储库不应该处理这些。

另一种方法是将此责任委托给宿主环境的基础结构，例如 ASP.NET MVC 应用程序中的操作筛选器。

* * *

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-30T08:34:58.150

如果您的域需要 CRUD 风格的用例，那么它们是正确的。

在我看来，直接公开存储库是错误的，因为应用程序服务的职责不仅仅包括“仅”功能用例；即事务控制、安全性和基本输入验证。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-26T16:23:10.263

您的应用程序服务中的方法应该具有代表您的用例的名称。DDD 中经常说应该避免 CRUD，但根据我的经验，产品所有者/领域专家经常谈论“创建”或“添加”实体，以及“更新”、“编辑”或“修改”和实体。如果这些是您负责实施的用例，那么它们肯定会在您的应用程序层中。

如果产品所有者在谈论反映 CRUD 的术语，那么它应该在那里，但如果他们在谈论不反映 CRUD 的术语，那么你应该避免它。

# ios - 在 CGContext 中定位预制的 CGPath

> ID：10324989
> 
> 赞同：3
> 
> 时间：2012-04-25T22:59:53.357
> 
> 标签：ios, quartz-2d, cgcontext

我正在尝试找出一种添加或附加路径（我已经创建）的方法，并且能够以某种方式设置绘制路径的位置。

这是我正在谈论的一个例子：

```
//everything here can be compiled in a regular UIViewController
//this example is very trivial but it illustrates basically what I want to do
CGRect preMadeRect = CGRectMake(0.0f, 0.f, 50.f, 50.f);
CGPathRef preMadePath = CGPathCreateWithEllipseInRect(preMadeRect, NULL);

UIGraphicsBeginImageContext(self.view.frame.size);
CGContextRef context = UIGraphicsGetCurrentContext();

//I thought that maybe if I moved to a new point
//the path would respect the starting point as its new 
//x and y coordinates
CGContextMoveToPoint(context, 50.f, 50.f);
//I am adding a path
//I want the path to be positioned at new coordinates
//within the context
CGContextAddPath(context, preMadePath);
CGContextStrokePath(context);

UIImage *resultImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

UIImageView *imageView = [[UIImageView alloc]initWithImage:resultImage];
[self.view addSubview: imageView]; 
```

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T23:03:48.037

您不能更改路径中的点；他们已经设置好了。但是，您可以对上下文应用变换，而是更改坐标系。

您的路径定义了一个在原点 (0,0) 有一个角的矩形。默认情况下，原点位于图像的左上角（或左下角）。如果将上下文的坐标系平移 50,50，然后绘制路径（仍然在 0,0），它将出现在距离角点 50 像素的位置。

`CGContextTranslateCTM`在文档中查找。

如果您正在进行其他绘图并且需要撤消坐标系更改，`CGContextSaveGState`您可能还需要使用。`CGContextRestoreGState`

# php - 如何使用/不使用 html 表单加载带有 jQ uery 变量的 $_POST 数组

> ID：10324993
> 
> 赞同：0
> 
> 时间：2012-04-25T23:00:47.390
> 
> 标签：php, html, jquery, post

我在 $.ajax() 和 $.post() 调用中遇到了一些问题，需要在接口端将一些变量发送到服务器端 PHP 进行处理。虽然这似乎是一个微不足道的问题，并且在表格中大量报告，但我尝试了过去几天的所有选项，但没有成功。

我的情况如下：

我有一个简单的界面，绘制了一个 4X4 网格，以便用户可以单击任何位置，并且将通过运行正常的 jquery 函数记录 2D 坐标值。现在我需要通过单击用户按钮将这两个 xy 变量发送到 PHP 以存储在数据库中。我允许用户单击多次，但有一个提交按钮，以便仅提交最终单击的值。我将所有工作都写在一个文件 test.php 中，如下所示：

```
<?php
$x = $_POST['xval'];
$y = $_POST['yval'];
echo "X-Value......" . "$x";
echo "Y-Value......" . "$y";
// Code to store $x and $y in database
?>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
jQuery(document).ready(function(){
var x=0;
var y=0;
$("#table").click(function(e1){
// Process x, y values from the grid..This part is working fine and tested also
})
$("#form").submit(function(event) {
    //var $form = $(this);
    //var url_s = $form.attr('action');
    var data_s = {xval: 'x', yval: 'y'};
    //$.post("test.php", { xval:"x", yval: y });
      $.ajax({ type: "POST", url: "test.php", data: {xval: 'x', yval: 'y'}});
})
});
</script>
<div class="form">
<form name="form100" id="form">
<input type="submit" name="SubmitOption" id="button" value="Next">
</form>
</div> 
```

我将值发布在同一页面，即 test.php，因为我想处理 PHP 代码顶部的值，但我无法检索 PHP- 中的 $x、$y 值结尾。我测试用如下表格发布：>

经过测试，我发现 $_POST 只能使用 method="post" action=" 加载表单变量，但不能使用带有 jQ​​uery 变量的 $.post 或 $.ajax 调用。我尝试通过加载来解决方法jQuery click 函数的表单中的两个文本区域，然后使用带有 method="post" action=" 的表单 POST，因为现在 jQuery 变量被传输到表单变量。

如何仅使用表单提交按钮执行 AJAX 调用（$.ajax 或 $.post）并通过 $_POST 数组将 jQuery 变量传递给服务器 PHP，因为似乎 $_POST 数组仅使用来自的表单变量加载method="post" action=" 并且无法从 $.post() 和 $.ajax() 调用并将 jQuery 变量传递给 $_POST 数组。另一个问题是如何在没有表单的情况下传递 jQuery 变量在 $_POST 数组中仅使用输入 type="button" 单击（尝试使用 $("#button").click(function()....但 POST 不适用于 $.ajax 并且 _POST 数组为空），因为从技术上讲我不需要表格，因为我没有任何表格变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:27:23.897

尝试这个

```
<?php
if(isset($_POST['action'])){
$x = $_POST['xval'];
$y = $_POST['yval'];
echo "X-Value......$x";
echo "Y-Value......$y";
exit;
}
?>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script language="javascript" type="text/javascript">

            $(function() {
            $('#button').click(function(){
            $.ajax({
            type: 'POST',
            url : 'test.php',
            data: {
            action   :'ADD' ,
            xval     :'x',
            yval     :'y'
         },
        success: function(data) {
           alert(data);
            } ,
        error : function(){
            alert('erroR');
           }
           })
         })  

$("#table").click(function(e1){
// Process x, y values from the grid..This part is working fine and tested also
})

   })
</script>
<div class="form">
<input type="submit" name="SubmitOption" id="button" value="Next">
</div> 
```

并使用 firebug 捕捉可能的 jq-js 语法错误

# java - Java 的 ProxySelector 不能与自动代理配置脚本一起使用吗？

> ID：10324996
> 
> 赞同：25
> 
> 时间：2012-04-25T23:01:14.137
> 
> 标签：java, proxy

我希望我的 Java 程序使用系统的代理配置。因此，我使用在许多地方找到的代码（例如[这个 answer](https://stackoverflow.com/a/381698/76365)）设置`java.net.useSystemProxies`为 true 并调用`ProxySelector.getDefault().select(...)`以发现我想要访问的特定主机的代理。当我在 Internet 属性中配置了单个显式代理服务器时，这可以正常工作。但是如果我设置了“使用自动配置脚本”，它总是返回直接的“代理”。

我知道该脚本有效，因为我的浏览器可以访问它为其返回代理服务器的主机，而如果没有脚本集，它就不能。我什至尝试将脚本简化为最基本的要素：

```
function FindProxyForURL(url, host)
{
    return "PROXY my.proxy.mydomain:3128";
} 
```

它在我的浏览器中工作，但`ProxySelector.getDefault().select(...)`仍然只返回 DIRECT。

我错过了什么吗？（这是在 Java 1.6 和 Windows 7 上，如果有关系的话。）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-26T01:03:32.883

不，Java ProxySelector 不读取[代理自动配置 (PAC)](http://en.wikipedia.org/wiki/Proxy_auto-config)文件。

但是，[正如 Brian de Alwis](https://stackoverflow.com/a/4877497/14419)对我的类似问题的回答所建议的那样，**[Proxy Vole](http://code.google.com/p/proxy-vole/)**库似乎提供了这种支持/功能。

> 要为您的 Java 应用程序提供开箱即用的网络连接，您可以使用 Proxy - Vole 库。它提供了一些自动检测当前代理设置的策略。有许多可配置的策略可供选择。目前 Proxy - Vole 支持以下代理检测策略。
> 
> *   读取平台设置（支持：Windows、KDE、Gnome、OSX）
> *   读取浏览器设置（支持：Firefox 3.x、Internet Explorer；Chrome 和 Webkit 使用平台设置）
> *   读取环境变量（Linux/Unix 服务器系统上常用的变量）
> *   **使用 WPAD/PAC 的自动检测脚本**（不支持所有变体）

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-26T15:01:46.750

正如 Mads Hansen 已经建议的那样，[Proxy-Vole](http://code.google.com/p/proxy-vole/)可以做到这一点！

您只需将下载站点中的 jar 添加到您的类路径（包括 dll），此代码帮助我配置代理设置：

```
ProxySearch proxySearch = new ProxySearch();
proxySearch.addStrategy(Strategy.OS_DEFAULT); 
proxySearch.addStrategy(Strategy.JAVA); 
proxySearch.addStrategy(Strategy.BROWSER); 
ProxySelector proxySelector = proxySearch.getProxySelector(); 

ProxySelector.setDefault(proxySelector); 
URI home = URI.create("http://www.google.com"); 
System.out.println("ProxySelector: " + proxySelector); 
System.out.println("URI: " + home); 
List<Proxy> proxyList = proxySelector.select(home); 
if (proxyList != null && !proxyList.isEmpty()) { 
 for (Proxy proxy : proxyList) { 
   System.out.println(proxy); 
   SocketAddress address = proxy.address(); 
   if (address instanceof InetSocketAddress) { 
     String host = ((InetSocketAddress) address).getHostName(); 
     String port = Integer.toString(((InetSocketAddress) address).getPort()); 
     System.setProperty("http.proxyHost", host); 
     System.setProperty("http.proxyPort", port); 
   } 
 } 
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-12-11T13:14:35.750

您可以使用 Proxy Vole 来解决此问题：

*   原始[谷歌代码项目](https://code.google.com/archive/p/proxy-vole/)
*   最近的[GitHub 项目](https://github.com/MarkusBernhardt/proxy-vole)，fork original

如果您确切知道要使用哪个 PAC 文件，您可以执行以下操作：

```
UrlPacScriptSource source = new UrlPacScriptSource("http://www.example.org/proxy.pac");
PacProxySelector selector = new PacProxySelector(source);

ProxySelector.setDefault(selector); 
```

这样做的好处是它与用户无关。例如，如果将此作为 Windows 服务运行，您最终可能会在 SYSTEM 用户上运行它，该用户可能`OS_DEFAULT`与管理员用户没有相同的代理设置（如果有）。

使用系统/软件值的方法是：

```
ProxySearch proxySearch = new ProxySearch();
proxySearch.addStrategy(Strategy.OS_DEFAULT);
proxySearch.addStrategy(Strategy.BROWSER);
proxySearch.addStrategy(Strategy.JAVA);
ProxySelector proxySelector = proxySearch.getProxySelector();

ProxySelector.setDefault(proxySelector); 
```

这从 开始`OS_DEFAULT`，然后是`JAVA`代理`BROWSER`选择器的策略。

此代码基于 GitHub 代码，发布版本 1.0.3。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-08T15:22:31.553

我可以在 Java 上加载代理自动配置 (PAC) 文件。请参阅下面的代码和包装。我希望这将是您正在寻找的：

```
import com.sun.deploy.net.proxy.*;
.
.
BrowserProxyInfo b = new BrowserProxyInfo();        
b.setType(ProxyType.AUTO);
b.setAutoConfigURL("http://yourhost/proxy.file.pac");       
DummyAutoProxyHandler handler = new DummyAutoProxyHandler();
handler.init(b);

URL url = new URL("http://host_to_query");
ProxyInfo[] ps = handler.getProxyInfo(url);     
for(ProxyInfo p : ps){
    System.out.println(p.toString());
} 
```

您的机器上已经有一个 [com.sun.deploy.net.proxy] 包！查找 [deploy.jar] ;D

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-09-11T14:53:27.513

是的，[从版本 9](https://bugs.openjdk.java.net/browse/JDK-8170868)开始，将从操作系统读取自动代理配置 (PAC/WPAD)。

# mysql - XAMPP mysql.sock 丢失

> ID：10324997
> 
> 赞同：4
> 
> 时间：2012-04-25T23:01:16.717
> 
> 标签：mysql, linux, xampp, mysql.sock

我按照以下说明从 apachefriends.org 安装了 XAMPP：http: [//www.apachefriends.org/en/xampp-linux.html#377](http://www.apachefriends.org/en/xampp-linux.html#377)。

问题是文件 /opt/lampp/var/mysql/mysql.sock 丢失。我怎样才能得到这个文件？事情是我想运行一个简单的 MySQL 命令学习工具，但我收到文件丢失的错误。（警告：PDO::__construct() [pdo.--construct]: [2002] /opt 中没有这样的文件或目录（试图通过 unix:///opt/lampp/var/mysql/mysql.sock 连接） /lampp/htdocs/SID/sid.php 在第 188 行）

XAMPP 运行正常，我使用 sudo /opt/lampp/lampp start 启动它。[http://localhost/](http://localhost/)工作正常。我检查了/opt/lampp/etc/my.cnf，没关系，它包含这些数据[http://pastebin.me/8d6b367a7ee76be70f944d9b960bb8f0](http://pastebin.me/8d6b367a7ee76be70f944d9b960bb8f0)

请帮忙，我怎样才能得到那个mysql.sock？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-02T15:38:03.657

在终端窗口中执行下一个命令：

ps -ax|grep mysql

你可以看到这样的结果：

--socket=/Applications/XAMPP/xamppfiles/var/mysql/mysql.sock --port=3306

问候

PS：我用的是 MAC OS X

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-05-28T21:18:14.650

在ubuntu中

/opt/lampp/var/mysql/mysql.sock

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-01T00:00:20.023

我认为您正在运行 mysql 的其他实例 ..

试试这个 ：

```
/opt/lampp/bin/mysql -u *user* -p 
```

然后在要求时输入您的密码..希望这会有所帮助..

我有一个类似的情况，当只放 mysql 时，因为那样它不被称为lampp stack mysql 但是`/usr/bin/mysql`（你可以找到打字-> which mysql）