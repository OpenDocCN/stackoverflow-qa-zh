# StackOverflow 问答 000673000-000673999

# bash - Bash：如何在算术表达式中进行变量扩展？

> ID：673016
> 
> 赞同：2
> 
> 时间：2009-03-23T11:23:18.233
> 
> 标签：bash, scripting

在尝试编写一个简单的 bash 脚本来帮助我的部署过程时，我遇到了一个令人困惑的错误：

```
#!/bin/bash
WEEKDAY=$(date +'%u')
echo $WEEKDAY
DAYS_TO_WEDNESDAY=$((3-$WEEKDAY))
echo $DAYS_TO_WEDNESDAY 
```

结果是：

```
1
")syntax error: invalid arithmetic operator (error token is " 
```

其中最奇怪的部分是，我可以发誓这个脚本在几天前运行得非常好。

## 编辑（14:58）：

问题不在于 bash 脚本，而在于通过 TortoiseSVN 使用 SVN。绕过 Windows 将 EOL 标记更改为“CR LF”，这导致 bash 中的语法错误。设置 svn:eol-style -property 有助于避免进一步的类似问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T15:31:14.927

您的错误消息似乎表明您的数据被 CR 污染了。

```
")syntax error: invalid arithmetic operator (error token is " 
```

请注意应该在当前行尾之后出现的内容是如何开始的。这很可能是因为您的错误标记实际上是一个 CR（它是一个回车符 - 一个指示终端将光标放在行首的字符）。这些字符几乎只被作为行尾一部分的 Windows 机器使用。

我将假设您正在使用 Windows 机器，并且您的“date”命令给出了输出，后跟“windows”换行符，这实际上是一个 \r\n （回车，换行符）。$() 总是去除尾随的换行符，这会使 \r 留在最后，从而导致脚本中出现解析问题。

在这里，以下命令会在 UNIX 上产生错误：

```
$ foo=$'5\r'; echo $((5+foo))
")syntax error: invalid arithmetic operator (error token is " 
```

要解决此问题，您需要删除数据中的 \r。您可以为此使用参数扩展，或 tr(1)。

```
$ foo=$'5\r'; echo $((5+${foo//$'\r'}))
10

$ $ foo=$'5\r'; echo $((5+$(tr -d '\r' <<< "$foo")))
10 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T11:26:45.403

您可以在算术表达式中省略 $。

所以：

```
DAYS_TO_WEDNESDAY=$((3 - WEEKDAY)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T11:27:43.310

复制并粘贴您的代码，它工作正常：

```
$ cat > test.sh
#!/bin/bash
WEEKDAY=$(date +'%u')
echo $WEEKDAY
DAYS_TO_WEDNESDAY=$((3-$WEEKDAY))
echo $DAYS_TO_WEDNESDAY
^D

$ bash test.sh 
1
2 
```

也许`$WEEKDAY`里面有坏数据？

# c# - 从后面的代码启动用户控制的正确方法是什么

> ID：673020
> 
> 赞同：3
> 
> 时间：2009-03-23T11:25:34.237
> 
> 标签：c#, asp.net

基本上我想在后面的代码中创建一个用户控件，DataBind() 它然后将控件插入当前页面

我目前正在尝试这个：

```
var comment = new IncidentHistoryGroupComment();
comment.LoadControl("~/Controls/IncidentHistoryGroupComment.ascx");
comment.LoadTemplate("~/Controls/IncidentHistoryGroupComment.ascx");
comment.InitializeAsUserControl(this);
comment.AttachmentActions = group.HastAttachmentActions ? group.AttachmentActions : null;
comment.Comment = group.Comment;
comment.NextStep = group.NextStep;
comment.IsInitiationStep = group.InitializationEntry != null;
comment.DataBind(); 
```

但它里面的所有控件仍然是空的。例如，我有一个 id 为 pnlComments 的窗格，当我尝试在 IncidentHistoryGroupComment.DataBind() 方法中访问它时，我得到空值。我还检查了 Controls 属性，看看是否有东西，但 Controls.Count == 0

所以问题是如何从后面的代码中正确初始化用户控件，以便将所有控件分配给 IncidentHistoryGroupComment.designer.cs 中的实例，以便我可以轻松访问它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T11:40:23.450

```
MyControl myControl = (MyControl)LoadControL("~/MyControl.ascx"); 
```

为了便于阅读，我更改了控件的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T11:35:14.417

应该是这样的：

```
 var comment = (IncidentHistoryGroupComment)Page.LoadControl("~/Controls/IncidentHistoryGroupComment.ascx"); 
```

然后你只需插入控制树

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T11:44:56.060

我认为您的问题不在于实例化用户控件。

在您的 DataBind 事件中，将此代码放在第一行：

```
this.EnsureChildControls(); 
```

如果没有实例化，它会实例化所有子控件。我的意思是它检查子控件并在必要时调用 createChildControl。

# java - Java中的匿名内部类有没有办法“失去”它们的范围？

> ID：673021
> 
> 赞同：3
> 
> 时间：2009-03-23T11:25:56.373
> 
> 标签：java, closures, inner-classes

当我将匿名内部类传递给函数时，我可以从该类的方法中引用当前范围内的变量，如下所示：

```
class Caller {
    private Object callerPrivate;

    // ...

    public void someMethod() {
        final String callerLocal = "Eyes only";

        ISomeInterface anon = new ISomeInterface() {
                                     public void doSomethingInterfacy {
                                         System.out.println(callerPrivate.toString());
                                         System.out.println(callerLocal);
                                     }
                                  };
        // this is some other object that puts ISomeInterfaces in a queue
        // and makes them doSomethingInterfacy later
        myCallManager.enqueue(anon);
    }
} 
```

现在，在上面的 someMethod 运行之后，调用者和带有小匿名的队列可以分道扬镳，据我了解，JVM 保持所有引用正常，因此这始终有效。

但是，如果，例如，队列被序列化，程序关闭并重新启动，然后队列被反序列化并且其中的项目应该运行，而 Caller 实例早已消失并被遗忘，该怎么办？

还有其他方法可以让周围的对象和匿名内部类以一种在匿名类内部调用不再起作用的方式分离吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T11:31:50.867

不要序列化本地类，因为 (a) 文档是这样说的，并且 (b) 序列表示不稳定（它们一开始没有稳定的名称）。

如果您不希望您的实例为外部 this 和使用的 final 局部变量保留字段，请使用（静态）嵌套类或外部类。对于（Java）序列化，您可以使用`writeReplace`序列化串行代理对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T11:32:25.357

不要忘记您的匿名内部类包含隐式*this*引用。即对周围类的引用。

所以如果你序列化你的内部类，就会有一个对你的外部类的引用。如果您使用[XStream](http://xstream.codehaus.org/)进行序列化并查看 XML 输出，您可以清楚地看到这一点。

# html - 将 HTML 转换为图像

> ID：673023
> 
> 赞同：2
> 
> 时间：2009-03-23T11:26:06.950
> 
> 标签：html, image, thumbnails, cutycapt, iecapt

复制

> [创建网页缩略图的最佳方法是什么？](https://stackoverflow.com/questions/65078/what-is-the-best-way-to-create-a-web-page-thumbnail)

我想显示 HTML 页面的缩略图。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T13:05:17.070

您可能想看看[CutyCapt](http://cutycapt.sourceforge.net/)或[IECapt](http://iecapt.sourceforge.net/)是否适合您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-23T07:12:05.627

怎么样

[PageGlimpse](http://www.pageglimpse.com/)

用于网站等

[DotNetShoutout](http://dotnetshoutout.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T11:46:14.077

提供更多信息，例如您使用的是 PHP、ASP.net 还是 Windows 应用程序。例如，如果您使用 PHP，您可以从可以为您完成工作的各种开源扩展中获益。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T11:46:50.550

了解如何[使用 PHP 生成任何网页的缩略图](http://hasin.wordpress.com/2006/09/03/generate-thumbnail-of-any-webpage-using-php/)。

也看看[WebThumb](http://webthumb.bluga.net/home)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T11:50:18.653

我发现有几个网站提供的服务可以使用[http://www.google.com/search?&q=web+page+thumbnail](http://www.google.com/search?&q=web+page+thumbnail)为您完成这项工作。对于 .NET Dll，您可以尝试[http://www.websitesscreenshot.com/](http://www.websitesscreenshot.com/)。

# c# - Process.Close() 没有终止创建的进程，c#

> ID：673031
> 
> 赞同：29
> 
> 时间：2009-03-23T11:28:20.283
> 
> 标签：c#, process

我编写了一个 C# 应用程序，它使用`System.Diagnostics.Process`类来创建一个进程，使用

```
 Process P1 = new Process();
 P1.FileName = "myexe.exe"; 
```

和其他适当的设置。

我已经将它链接到一个运行大约 10 分钟的 exe 文件。（我正在编写程序来测量程序的运行时间）。现在，我想中止正在运行的进程。所以我在取消按钮的事件中写了，

```
 Process.Close(); 
```

但是在任务管理器中我仍然看到 myexe.exe 正在运行，它并没有中止。该怎么办？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-23T11:29:26.503

[Process.Close()](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.close.aspx)并不是要中止进程——它只是为了释放你对进程和相关资源的“本地”视图。

我认为您的意思是[Process.Kill()](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.kill.aspx)或[Process.CloseMainWindow()](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.closemainwindow.aspx)。就个人而言，我会尝试找到一种更优雅的方式来关闭它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T11:29:53.103

请改用[Process.Kill](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.kill.aspx)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T11:31:32.800

我想`Process.Kill()`这就是你要找的。

# c# - 变量\属性命名约定

> ID：673032
> 
> 赞同：0
> 
> 时间：2009-03-23T11:28:43.247
> 
> 标签：c#, .net, vb.net, naming-conventions

当我为目录命名变量时，我应该以路径、文件夹或目录结束变量名。

我在.net 中编写我的代码..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T11:31:38.527

我使用“路径”来指代文件的完整路径（目录+文件名）。我推荐“文件夹”、“目录”甚至“目录”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T12:37:22.317

好的，首先是一些定义：

*   **路径**是文件系统中的一个地址，它可以指向文件或目录。
*   一个**目录**可以包含多个文件和子目录。
*   可以通过文件的完整路径（例如）**或**`C:\Temp\Foo.txt`相对路径（`..\Temp\Foo.txt`）访问文件。（我认为文件名 ( `Foo.txt`) 也是一个相对路径）。

因此，如果一个变量是不明确的，（即可以指向一个文件或一个目录，比如递归遍历目录树时），我会称之为`FooPath`.

如果您的变量始终指向一个文件，我会调用它`FooFile`

如果您的变量始终是目录的名称，而不是文件的名称，我会通过调用它来反映这一点`FooDirectory`，或者`FooDir`简称。

但当然，最重要的规则是一致性：选择一种命名约定并坚持下去。不要调用一个变量`FooDirectory`，下一个`BarDir`和第三个`BuzzFolder`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T11:32:38.960

没关系 - 所有或多或少都是同义词，应该在上下文中清楚地理解。

我要说的唯一警告是，路径可能是 Web 位置或文件，文件夹和目录不会是，如果这有助于您的决定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T11:37:41.150

那里没有官方的编码约定。我更喜欢这种风格：

***** “C:\Windows\Systems32”或“file://...”或“../../bin/Debug”的路径（SystemPath，AppPath）

***Dir** (ImageDir, ThemeDir) for ("img" or "theme")

# .net - 如何处理通过 System.Diagnostics.Process 启动的进程中的崩溃？

> ID：673036
> 
> 赞同：14
> 
> 时间：2009-03-23T11:29:01.280
> 
> 标签：.net, process, crash

我正在使用 System.Diagnostics.Process 启动一个外部进程。这是批处理作业的一部分，所以如果一个进程崩溃，我想处理它并让其余的继续。

当前发生的情况是 Windows 会弹出一个对话框，告诉我程序已崩溃，并且只有在我手动关闭该对话框后，该进程才会退出。

根据[这个问题](https://stackoverflow.com/questions/125934/system-diagnostics-process-start-weird-behaviour)， Process.Responding 属性仅适用于具有 UI 的程序（我正在启动的进程是控制台应用程序）。

我还查看了进程提供的各种事件，但没有一个是在崩溃时触发的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-23T13:03:01.803

尝试将注册表以下注册表值设置为值 DWORD 2：

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Windows\ErrorMode = 2 
```

这将影响机器上的每个进程。

参考： [如何摆脱系统和应用程序弹出消息](http://msdn.microsoft.com/en-us/embedded/aa731206.aspx)

如果您有崩溃程序的源代码，您可以通过捕获所有结构化异常并退出而不弹出消息框来防止弹出窗口。你如何做到这一点取决于所使用的编程语言。

如果您没有源，请使用父级中的 SetErrorMode 函数来抑制弹出窗口。错误模式由子进程继承。您必须将 UseShellExecute 设置为 false 才能使其工作：

```
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;

namespace SubProcessPopupError
{

    class Program
    {
        [DllImport("kernel32.dll", SetLastError = true)]
        static extern int SetErrorMode(int wMode);

        static void Main(string[] args)
        {
            int oldMode = SetErrorMode(3);
            Process p;
            ProcessStartInfo ps = new ProcessStartInfo("crash.exe");
            ps.UseShellExecute = false;
            p = Process.Start(ps);
            SetErrorMode(oldMode);
            p.WaitForExit();
        }
    }
} 
```

如果您看到一个对话框说“您想使用选定的调试器进行调试吗？”，您可以通过将此注册表值设置为 0 来关闭它。

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug\Auto = 0 
```

但是，如果您如上所述将错误模式设置为 3，我认为不会出现这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-29T13:24:58.857

另一种选择是在[cdb](http://msdn.microsoft.com/en-us/library/ff539058%28VS.85%29.aspx)下运行您的可执行文件，然后使用以下命令行搜索单词“exception”：

```
cdb.exe -G -g -c "Q" <your executable> 
```

# xslt - 带有索引计数器的 XSLT 过滤器

> ID：673042
> 
> 赞同：4
> 
> 时间：2009-03-23T11:30:48.247
> 
> 标签：xslt, xpath

我编写了一些 XSLT，它使用一个 XML 文档来过滤另一个文档。现在我想使用 对我的输出元素进行编号`position()`，但我的过滤条件没有内置到 my`<xsl:for-each>`中，所以`position()`给我的结果有编号间隙。我如何摆脱差距？

```
<xsl:variable name="Astring">
  <a><b>10</b><b>20</b><b>30</b></a>
</xsl:variable>
<xsl:variable name="A" select="msxml:node-set($Astring)" />

<xsl:variable name="Bstring">
  <c><d>20</d><d>30</d></c>
</xsl:variable>
<xsl:variable name="B" select="msxml:node-set($Bstring)" />

<e>
  <xsl:for-each select="$A/a/b">
    <xsl:variable name="matchvalue" select="text()" />
    <xsl:if test="count($B/c/d[text() = $matchvalue]) &gt; 0">
      <xsl:element name="f">
        <xsl:attribute name="i">
          <xsl:value-of select="position()" />
        </xsl:attribute>
        <xsl:copy-of select="text()" />
      </xsl:element>
    </xsl:if>
  </xsl:for-each>
</e> 
```

结果如下：

```
<e>
  <f i="2">20</f>
  <f i="3">30</f>
</e> 
```

...但我想要这个：

```
<e>
  <f i="1">20</f>
  <f i="2">30</f>
</e> 
```

有没有办法将上述`<xsl:if>`过滤测试合并到`<xsl:for-each>` `select`属性中？

注意：我看过[这个问题](https://stackoverflow.com/questions/336572/filter-xml-based-on-another-xml-using-xslt-1)re:filtering 和[这个](https://stackoverflow.com/questions/93511/counter-inside-xslfor-each-loop)re: counters，但前者没有对其结果进行编号，而后者使用 position()。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T11:35:59.140

是否有任何特殊原因不能将您的条件包含在 for-each 循环中？

```
<xsl:for-each select="$A/a/b[$B/c/d = .]"> 
```

我在 Visual Studio 中对此进行了测试，它适用于本示例。

这是输出：

```
<e>
  <f i="1">20</f>
  <f i="2">30</f>
</e> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T12:51:44.467

我不确定为什么人们总是想使用`<xsl:for-each>`when`<xsl:apply-templates>`显然是更好的选择。

好吧，这是修辞。我知道这是为什么：`<xsl:for-each>`似乎更容易。但事实并非如此——以下两个模板替换了整个 for-each 构造：

```
<xsl:template match="/">
  <e><xsl:apply-templates select="$B/c/d[$A/a/b = .]" /></e>
</xsl:template>

<xsl:template match="d">
  <f i="{position()}"><xsl:value-of select="." /></f>
</xsl:template> 
```

输出：

```
<e>
  <f i="1">20</f>
  <f i="2">30</f>
</e> 
```

嗯，我骗了一点。您可以将版本压缩为`<xsl:for-each>`：

```
<xsl:template match="/">
  <e>
    <xsl:for-each select="$B/c/d[$A/a/b = .]">
      <f i="{position()}"><xsl:value-of select="." /></f>
    </xsl:for-each>
  </e>
</xsl:template> 
```

尽管如此，它仍然缺乏`<xsl:apply-templates>`变体恕我直言的轻盈。

# bash - 正确的 Bash 和 shell 脚本变量大写

> ID：673055
> 
> 赞同：239
> 
> 时间：2009-03-23T11:34:29.660
> 
> 标签：bash, shell, scripting, naming-conventions, capitalization

我遇到了许多带有所有大写变量的 shell 脚本，我一直认为这是一个严重的误解。我的理解是，按照惯例（也许很久以前是必要的），**环境变量**都是大写的。

但是在像 Bash 这样的现代脚本环境中，我一直更喜欢使用小写字母命名临时变量，而大写字母*仅用于导出（即环境）变量*。例如：

```
#!/usr/bin/env bash
year=`date +%Y`
echo "It is $year."
export JAVA_HOME="$HOME/java" 
```

这一直是我对事情的看法。是否有任何权威人士同意或不同意这种方法，或者这纯粹是风格问题？

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2009-03-23T15:53:24.170

按照惯例，环境变量（`PAGER`, `EDITOR`, ...）和内部 shell 变量（`SHELL`, `BASH_VERSION`, ...）都是大写的。所有其他变量名称应为小写。

请记住，变量名是区分大小写的；此约定避免意外覆盖环境和内部变量。

遵守这个约定，您可以放心，您不需要知道 UNIX 工具或 shell 使用的每个环境变量，以避免覆盖它们。如果它是您的变量，请将其小写。如果你导出它，大写它。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2017-02-17T05:48:42.350

始终遵循的任何命名约定总是有帮助的。以下是一些有关 shell 变量命名的有用提示：

*   对导出的变量和常量使用**全部大写和下划线**，尤其是当它们在多个脚本或进程之间共享时。在适用的情况下使用通用前缀，以便相关变量脱颖而出，并且不会与全大写的[Bash 内部变量发生冲突。](https://www.gnu.org/software/bash/manual/html_node/Bash-Variables.html)

    例子：

    *   具有公共前缀的导出变量：`JOB_HOME` `JOB_LOG` `JOB_TEMP` `JOB_RUN_CONTROL`
    *   常数：`LOG_DEBUG` `LOG_INFO` `LOG_ERROR` `STATUS_OK` `STATUS_ERROR` `STATUS_WARNING`
*   对范围为单个脚本或块的所有变量使用“蛇形大小写”（**所有小写和下划线）。**

    例子：`input_file` `first_value` `max_amount` `num_errors`

    当局部变量与环境变量有某种关系时，请使用混合大小写，例如：`old_IFS` `old_HOME`

*   对“私有”变量和函数使用**前导下划线**。如果您曾经编写过一个 shell 库，其中库文件内或跨文件的函数需要共享变量，而不会与主代码中可能类似命名的任何内容发生冲突，则这一点尤其重要。

    例子：`_debug` `_debug_level` `_current_log_file`

*   避免**骆驼案**。这将最大限度地减少由大小写错误引起的错误。请记住，shell 变量**区分大小写**。

    示例：`inputArray` `thisLooksBAD`, `numRecordsProcessed`,`veryInconsistent_style`

* * *

也可以看看：

*   [The Open Group Base Specifications 第 7 期 - 环境变量](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2018-09-24T17:23:46.070

如果要将 shell 变量导出到环境中，值得考虑的是 POSIX（第 7 期，2018 版）[环境变量定义](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html)指定：

> POSIX.1-2017 的 Shell and Utilities 卷中的实用程序使用的环境变量名称仅由 Portable Character Set 中定义的字符中的大写字母、数字和下划线 ( `_`) 组成，并且不以数字开头。

...

> 包含小写字母的环境变量名称的命名空间是为应用程序保留的。应用程序可以使用此名称空间中的名称定义任何环境变量，而无需修改标准实用程序的行为。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-23T11:36:39.340

我做你做的。我怀疑是否有权威来源，但它似乎是一个相当广泛的事实上的标准。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-23T12:03:45.237

实际上，“环境变量”一词似乎是最近才出现的。Kernighan 和 Pike 在他们 1984 年出版的经典著作《UNIX 编程环境》中只提到了“shell 变量”——索引中甚至没有“环境”条目！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T11:36:21.230

这只是一个非常广泛的会议，我怀疑它是否有任何“权威”来源。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-23T11:59:34.870

我倾向于将 ALL_CAPS 用于环境和全局变量。当然，在 Bash 中没有真正的变量作用域，因此有很大一部分变量用作全局变量（主要是设置和状态跟踪），而“局部变量”（计数器、迭代器、部分构造的字符串和临时变量）相对较少

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-16T16:03:58.200

Bash 和大多数 shell 脚本解释器可以识别函数中的全局变量和局部变量（例如排版、声明、本地），并且应该酌情使用。如前所述，“POSIX.1-2017 的 Shell and Utilities 卷中的实用程序使用的环境变量名称仅由 Portable Character Set 中定义的字符中的大写字母、数字和下划线 (_) 组成，并且不以带有数字。...包含小写字母的环境变量名称的名称空间是为应用程序保留的。应用程序可以定义任何具有此名称空间名称的环境变量，而无需修改标准实用程序的行为。” （[POSIX IEEE Std 1003.1-2008 第 8.1 节](http://pubs.opengroup.org/onlinepubs/9699919799.2016edition/basedefs/V1_chap08.html)）

# flash - AS3 DAE 增强现实 PaperVision 3D

> ID：673059
> 
> 赞同：2
> 
> 时间：2009-03-23T11:35:20.437
> 
> 标签：flash, actionscript-3, papervision3d

我最近一直在玩增强现实（并且玩得很开心！！）我已经能够创建 PaperVision 基元（立方体、圆柱体、圆锥体等）并使用它们）但是添加 DAE 模型证明了虚幻！

```
var cubeMaterialList:MaterialsList = new MaterialsList( { all: new FlatShadeMaterial(light, 0x0099FF, 0x0066AA) } );

            var cube:Cube = new Cube(cubeMaterialList,
                                     30,
                                     30,
                                     30);

            cube.z += 15;

            mainContainer.addChild(cube); 
```

这一切都很好！

我正在使用它来导入/尝试导入 dae！

```
private var mCollada:Collada;
private var universe:DisplayObject3D;
mCollada = new Collada("sample.dae");
universe = new DisplayObject3D();
universe.addChild(mCollada);
        mainContainer.addChild(universe); 
```

我已经使用这种将 DAE 导入到非增强现实 PaperVision 项目中的方法，而且效果很好！所以只是想知道是否有人在使用 AR 导入 DAE 时有运气！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T22:26:02.687

[单击此处在我的网站上查看必要导入和工作演示的视频。](http://www.hodgedev.com/tutorials/as3/FlarToolkit_imports_and_dae/)

我注意到您使用的是 Collada 类，而不是 DAE 类，它们的行为与上面视频中显示的有所不同。

同样重要的是要注意，您很可能正确地执行此操作，并且模型甚至可能纹理存在问题。如果纹理未加载，您应该立即从控制台知道。尝试创建一个 ColorMaterial 并创建一个 MaterialsList 对象，将“all”属性设置为您创建的 ColorMaterial。最后通过实例化或加载方法将列表传递给 Collada 或 DAE 类的实例化。还要确保相机没有放大关闭，可能会留下 3D 对象。最后玩规模，并非所有模型都以相同的规模出现，并且使用 Collada 类，而不是 DAE，似乎将模型炸得相当大，如上面的视频链接所示。

最近，我有很多时间与 FlarToolkit / Papervision3D / Collada 合作，为 Tony Hawk XI 网站做准备。

## - 你需要什么

*   一个 IDE，我使用 FlashDevelop3 RC2，但 Flex Builder 或您选择的 IDE 都可以使用。
*   Papervision3D 2.0 Whiteshark，（最新版本）
*   弹性 3.3 开发工具包
*   耐心

## -查找和准备模型

*   为我的 Collada 文件使用[Google 3D 模型库](http://sketchup.google.com/3dwarehouse/)。
*   接下来将“.skp”sketchup 文件放入 Google Sketchup。
*   确保sketchup 窗口具有焦点并同时按下CTRL 和A。（全选）
*   向上编辑，然后到下拉列表的底部，通常会显示您选择了多少组。
*   选择爆发。
*   重复直到你不能再爆炸。（如果您使用的是应有的低多边形模型，这应该不会花很长时间。）
*   CTRL + A 再次全选。
*   转到文件 > 导出 > 3D 模型并选择“.dae” //如果您没有 Sketchup，.dae 扩展名不可用，查找解决方法:) （本质上 .dae 被包裹在“.skp”中
*   您现在将拥有一个 .dae 文件和一个具有相同名称的文件夹，其中包含与模型相关的纹理。

## - 导入/解析模型并显示它

```
package 
{
    import flash.display.BitmapData;
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.media.Camera;
    import flash.media.Video;
    import flash.utils.ByteArray;
    import org.libspark.flartoolkit.core.FLARCode;
    import org.libspark.flartoolkit.core.param.FLARParam;
    import org.libspark.flartoolkit.core.raster.rgb.FLARRgbRaster_BitmapData;
    import org.libspark.flartoolkit.core.transmat.FLARTransMat;
    import org.libspark.flartoolkit.core.transmat.FLARTransMatResult;
    import org.libspark.flartoolkit.detector.FLARSingleMarkerDetector;
    import org.libspark.flartoolkit.pv3d.FLARBaseNode;
    import org.libspark.flartoolkit.pv3d.FLARCamera3D;
    import org.papervision3d.cameras.Camera3D;
    import org.papervision3d.render.LazyRenderEngine;
    import org.papervision3d.scenes.Scene3D;
    import org.papervision3d.view.Viewport3D;
    import org.papervision3d.objects.parsers.Collada;
    import org.papervision3d.objects.parsers.DAE;
/**
 * ...
 * @author Brian Hodge
 */
public class Main extends Sprite 
{
    [Embed(source="../lib/camera_para.dat", mimeType="application/octet-stream")]
    private var CameraParameters:Class;

    [Embed(source="../lib/collada.pat", mimeType="application/octet-stream")]
    private var MarkerPattern:Class;

    private var cameraParameters:FLARParam;
    private var markerPattern:FLARCode;
    private var raster:FLARRgbRaster_BitmapData;
    private var detector:FLARSingleMarkerDetector;

    private var cam:Camera;
    private var vid:Video;
    private var capture:BitmapData;

    private var cam3D:FLARCamera3D;
    private var scene3D:Scene3D;
    private var viewPort:Viewport3D;
    private var mainContainer:FLARBaseNode;
    private var renderer:LazyRenderEngine;

    private var trans:FLARTransMatResult;
    private var prevSet:Boolean = false;
    private var prevZ:Number = 0;

    private var _collada:Collada;
    private var _dae:DAE;

    public function Main():void 
    {
        cameraParameters = new FLARParam();
        cameraParameters.loadARParam(new CameraParameters() as ByteArray);

        markerPattern = new FLARCode(16, 16);
        markerPattern.loadARPatt(new MarkerPattern());

        cam = Camera.getCamera();
        cam.setMode(640, 480, 30);

        vid = new Video();
        vid.width = 640;
        vid.height = 480;
        vid.attachCamera(cam);
        addChild(vid);

        capture = new BitmapData(vid.width, vid.height, false, 0x0);
        capture.draw(vid);

        raster = new FLARRgbRaster_BitmapData(capture);
        detector = new FLARSingleMarkerDetector(cameraParameters, markerPattern, 80);

        cam3D = new FLARCamera3D(cameraParameters);

        scene3D = new Scene3D();

        mainContainer = new FLARBaseNode();
        scene3D.addChild(mainContainer);

        viewPort = new Viewport3D(vid.width, vid.height);
        viewPort.scaleX = viewPort.scaleY = 2;
        addChild(viewPort);

        renderer = new LazyRenderEngine(scene3D, cam3D, viewPort);

        _dae = new DAE();
        _dae.load("assets/dae/apc.dae");
        _dae.rotationZ -= 90;
        mainContainer.addChild(_dae);

        /*
        _collada = new Collada("assets/dae/apc.dae");
        _collada.scale = 0.05;
        _collada.rotationZ -= 90;
        mainContainer.addChild(_collada);
        */

        trans = new FLARTransMatResult();

        this.addEventListener(Event.ENTER_FRAME, mainEnter);
    }
    private function mainEnter(e:Event):void 
    {
        capture.draw(vid);

        if (detector.detectMarkerLite(raster, 80) && detector.getConfidence() > 0.5)
        {
            detector.getTransformMatrix(trans);

            mainContainer.setTransformMatrix(trans);
            mainContainer.visible = true;
            renderer.render();
        }
        else
        {
            mainContainer.visible = false;
            renderer.render();
        }
    }
} 
```

}

希望所有这些对您有所帮助，我建议您继续玩它并继续熟悉它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T03:20:34.063

@布雷迪，

嘿，我认为这可能是错误：

[Embed(source="pat1.pat", mimeType="application/octet-stream")] private var CameraParameters:Class;

[嵌入(source="pat1.pat", mimeType="application/octet-stream")] 私有变量 MarkerPattern:Class;

在“CameraParameters”处，您应该嵌入“camera_para.dat”而不是 - pat1.pat。试试这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-24T05:06:01.050

我实际上在[这个网站上](http://papervision2.com/loading-complex-models/)找到了一些很好的信息。我使用那里的代码将模型导入到我的 AR 东西中。它概述了一种非常简单的导入 collada 模型的方法。我只是拿了示例 FlarToolkit 示例（simpleCube 示例）并在那篇文章中添加了代码，这足以让我继续前进。

这是代码：

```
package {
    import org.papervision3d.lights.PointLight3D;
    import org.papervision3d.materials.WireframeMaterial;
    import org.papervision3d.materials.shadematerials.FlatShadeMaterial;
    import org.papervision3d.materials.utils.MaterialsList;
    import org.papervision3d.materials.*;
    import org.papervision3d.materials.utils.*;
    import org.papervision3d.materials.shadematerials.*;
    import org.papervision3d.objects.primitives.Cube;
    import org.papervision3d.objects.primitives.Cylinder;
    import org.papervision3d.objects.DisplayObject3D;
    import org.papervision3d.objects.parsers.Collada;
    import flash.events.*;

    public class SimpleCube extends PV3DARApp {

        public var FAlogo:DisplayObject3D;
        public var light                        :PointLight3D;

        public function SimpleCube() {
            this.init('Data/camera_para.dat', 'Data/flarlogo.pat');
        }

        protected override function onInit():void {
            super.onInit();
            this.addEventListener( Event.ENTER_FRAME, EROnEnterFrame );

            // let there be light
            this.light = new PointLight3D;
            this.light.x = 0;
            this.light.y = 1000;
            this.light.z = -1000;

            // cow model
            FAlogo = new Collada("http://papervision2.com/wp-content/downloads/dae/cow.dae");
            FAlogo.rotationZ = -90;
            FAlogo.rotationY = -90;
            FAlogo.x = -100;
            FAlogo.z = 100;
            FAlogo.scale = 0.1;

            // re-orient the logo model before adding it to the scene

            this._baseNode.addChild(this.FAlogo);
        }

        private function EROnEnterFrame( event :Event ):void
        {
            // spins the cow yay!
            FAlogo.yaw(3);
        }
    }
} 
```

# php - 在 PHP 中合并两个数组（键和内容）

> ID：673070
> 
> 赞同：4
> 
> 时间：2009-03-23T11:40:30.533
> 
> 标签：php, arrays, merge, key

我有一个像下面这样的数组

数组（ [0] => "txt1" [1] => "txt2" [2] => "txt3"）

我有另一个类似的数组，但内容不同：数组（[0] => on [2] => on）

目的是得到一个包含第二个键和第一个内容的最终数组，就像合并它们一样。

这样最终的结果是： Array ( [0] => "txt1" [2] => "txt3") 把key改成0-1会更好，不过这是个小问题，我们重点来合并它们一对一。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-23T11:46:01.177

最简单的方法是使用`array_intersect_key`（[请参阅 PHP 文档](http://ca.php.net/manual/en/function.array-intersect-key.php)）。它从传递的第一个数组中获取与传递的所有其他数组中存在的键相对应的值。

因此，您的示例将如下所示：

```
$a = array(0 => "txt1", 1 => "txt2", 2 => "txt3");
$b = array(0 => 1, 2 => 1);
$c = array_intersect_key($a, $b);
print_r($c); 
```

印刷：

```
Array
(
    [0] => txt1
    [2] => txt3
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T15:08:36.307

> [`array_combine`](http://www.php.net/array_combine)- 通过使用一个数组作为键和另一个作为其值来创建一个数组

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T15:16:21.623

你为什么不使用简单的解决方案？

```
foreach($arr2 as $k=>$v) {
    $a[$k] = $arr1[$k];
} 
```

# .net - .NET AJAX 调用 ASMX 或 ASPX 或 ASHX？

> ID：673075
> 
> 赞同：39
> 
> 时间：2009-03-23T11:43:27.577
> 
> 标签：.net, asp.net, ajax

使用 AJAX 在客户端从 javascript 调用某些业务逻辑的最有效方法是什么？看起来您可以直接从 javascript 调用 aspx 上的 [WebMethod]（在我的情况下，我使用 JQuery 来提供帮助）或者您可以直接调用 .asmx。哪个调用产生的开销更少？最佳做法是什么？

另外，[ScriptService] 属性对类有什么作用？我以前从未在我的 .aspx [WebMethod] 方法上使用过它，而且一切似乎都运行良好。

我希望这是一个纯粹客观的问题。提前致谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-24T02:12:53.167

在我看来，ScriptService 的东西是 asp.net 中的一颗隐藏的宝石。对脚本服务的调用不会回传表单数据 + 视图状态，它们是精简、快速的 JSON 有效负载。

这是最好的部分，ASP.NET3.5 的脚本管理器可以为您完成大部分工作，包括生成供您调用的 JS 方法以及设置所需的任何 JS 类。

一个获取“Person”详细信息的简单示例，假设 Person 是一个 C# 类。

**在 PersonService.asmx 中：**

```
namespace MyProj.Services {
  [System.Web.Script.Services.ScriptService]
  [System.Web.Script.Services.GenerateScriptType(typeof(Person))] 
  public class PersonService : System.Web.Services.WebService
  {
    [WebMethod, ScriptMethod(UseHttpGet = true, ResponseFormat = ResponseFormat.Json)]
    public Person GetPersonDetails(int id)
    { 
       /* return Logic here */
    }
  }
} 
```

**在 DetailsPage.aspx 中**

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
 <Services>
  <asp:ServiceReference Path="~/Services/PersonService.asmx" />
 </Services>
</asp:ScriptManager> 
```

通过使用这样的设置，您甚至不需要 JQuery 的帮助来调用服务并取回您的 C# Person 类的 JS 版本，.net 为您完成了这一切。从 JS 使用此服务的一个示例是：

```
MyProj.Services.PersonService.GetPersonDetails(id, _onDetailsCallbackSuccess, _requestFailed, null);

_onDetailsCallbackSuccess: function(result, userContext, methodName) {
 //all persons properties are now intact and available
 document.getElementById('txtFirstname').value = result.Firtname;
} 
```

无论如何，更值得研究 ASP.NET Ajax ScriptService 的东西。即使您决定这次不使用它，它也是一个非常邪恶的功能。

**链接**

*   看起来像是使用脚本服务的一个很好的基本示例：[http ://www.jankoatwarpspeed.com/post/2008/05/14/asp-net-ajax-basics-calling-scriptservices-using-javascript.aspx](http://www.jankoatwarpspeed.com/post/2008/05/14/asp-net-ajax-basics-calling-scriptservices-using-javascript.aspx)
*   ASP.NET Ajax Extenders，将 Ajax 集成到控件中的下一个合乎逻辑的步骤。[http://weblogs.asp.net/scottgu/archive/2007/08/19/using-asp-net-ajax-control-extenders-in-vs-2008.aspx](http://weblogs.asp.net/scottgu/archive/2007/08/19/using-asp-net-ajax-control-extenders-in-vs-2008.aspx)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-23T11:51:34.000

如果您只关心服务器端开销，那么将带有查询字符串的简单 GET 发送到 ASHX 可能就是这样。它绝对比 .ASPX 更可取，因为它会经历一个您不需要的页面生命周期。

ASMX Web 方法的优点是它建立在一个标准上，可以很容易地被其他技术调用（支持发现）。不过，有了一些文档，您的 .ASHX 将同样易于调用。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-23T23:46:28.340

您提出问题的方式，我相信您正在考虑 ASMX“ScriptService”、ASHX HttpHandler 和 ASP.NET AJAX“PageMethod”（不是实际的 ASPX 页面）之间的区别。

如果是这种情况，它们都非常相似。就所有意图和目的而言，ASP.NET AJAX PageMethods 与 ASMX ScriptServices 相同。它们不创建页面的实例，因此它们不会产生通常与 ASPX 页面相关的开销。

除非您正在谈论用请求使服务器饱和，否则您可能会发现所有三者的性能相当。

# c# - 序列化 System.Globalization.CultureInfo 类型的对象时检测到循环引用

> ID：673079
> 
> 赞同：8
> 
> 时间：2009-03-23T11:45:20.850
> 
> 标签：c#, jquery, web-services, json

我正在使用 jquery 调用一个 web 服务，该服务返回一个包含几个表的数据集。

在我需要设置我的 webmethod 以接受参数之前，这一切正常。我在客户端反映了这一点

```
data: "{paramname:'" + paramval+ "'}", 
```

当 web 方法返回时，我现在收到以下错误。无论数据集中返回什么，都会发生这种情况

> 错误：{“消息”：“在 System.Web.Script.Serialization.JavaScriptSerializer.SerializeValueInternal(Object o) 序列化 \u0027System.Globalization.CultureInfo\u0027 类型的对象时检测到循环引用。 , StringBuilder sb, Int32 depth, Hashtable objectsInUse, SerializationFormat serializationFormat)\r\n at ...等

当 webmethod 没有参数时，客户端 js 看起来与下面相同，除了 data: 行被删除。

```
function ClientWebService(paramval){
$.ajax({
    type: "POST",
    url: "WebService1.asmx/webmethodName", 
    data: "{paramname:'" + paramval+ "'}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
        ParseResult(msg.d);
    },
    error: function(err) {
        if (err.status == 200) {
              ParseResult(err);
        }
        else { alert('Error:' + err.responseText + '  Status: ' + err.status); }
    }
}); 
```

}

编辑：根据建议将请求更改为

```
data: {paramname: paramval}, 
```

产生以下错误。

> 错误：{"Message":"无效的 JSON 原语：paramval。","StackTrace":"
> 在 System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializePrimitiveObject()\r\n 在 System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializeInternal(Int32 深度)\r\n 在 System.Web.Script.Serialization.JavaScriptObjectDeserializer.BasicDeserialize （字符串输入，Int32 depthLimit，JavaScriptSerializer 序列化程序）\r\n 在 System.Web.Script.Serialization.JavaScriptSerializer.Deserialize（JavaScriptSerializer 序列化程序，字符串输入，类型类型，Int32 depthLimit）\r\n 在 System.Web.Script。 Serialization.JavaScriptSerializer.Deserialize[T]（字符串输入）\r\n 在 System.Web.Script.Services.RestHandler.GetRawParamsFromPostRequest（HttpContext 上下文，JavaScriptSerializer 序列化程序）\r\n 在 System.Web.Script.Services.RestHandler。 GetRawParams(WebServiceMethodData methodData,HttpContext 上下文）\r\n 在 System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType":"System.ArgumentException"} 状态：500

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T16:29:17.080

我改变了我的网络方法返回

```
ds.GetXml(); 
```

这行得通。考虑到数据集是可序列化的，我不确定为什么必须这样做，但它让我克服了这个障碍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-04T09:09:22.410

我有同样的问题，

我从我的实体中删除了 Virtual 关键字，这使得延迟加载对象。

问题解决了！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-05T15:57:02.723

当使用 entityrefs 和 entitysets 序列化对象时，通常会发生这种情况。例如，如果你有这样的一套

```
public EntitySet<ProductCategory> Subcategories 
```

序列化程序将进入`ProductCategory`并尝试序列化那里的所有集合，通常最终回到原始对象，因此创建一个循环。

避免这种情况的最好方法是将 `[ScriptIgnore]`和`[NonSerialized]`放在字段上以及`[ScriptIgnore]`这样的属性上。

```
[ScriptIgnore]
[NonSerialized]
private EntitySet < ProductCategory > _Subcategories;
[ScriptIgnore]
[Association(Storage = "_Subcategories", ThisKey = "ID", OtherKey = "ParentID")]
public EntitySet < ProductCategory > Subcategories {
 get {
  return this._Subcategories;
 }
 set {
  this._Subcategories.Assign(value);
 }
} 
```

参考文献也一样

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T07:30:45.807

我知道这个问题已经得到解答，但我遇到了同样的问题，并认为我应该把对我有用的东西放在这里，这样其他人就可以有希望解决这个问题。

```
data: JSON.stringify(Params), 
```

通过使用**JSON.stringify**方法，我得到了所需的结果

其中**参数**等于`{"key":"value"}`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-22T20:31:31.713

当服务器端出现类型转换异常时，我遇到了这个响应。

# .net - 用数据填充 .Net 数据集的工具

> ID：673084
> 
> 赞同：1
> 
> 时间：2009-03-23T11:46:10.583
> 
> 标签：.net, dataset

是否有使用测试数据填充 System.Data.Dataset 的工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T12:18:57.803

有问题的数据集是否已经定义了模式，或者您只需要一些/任何测试数据？

如果有任何数据可以做 Northwind 是一个测试数据库，您可以将其用于示例业务数据：

[http://www.microsoft.com/Downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&displaylang=en](http://www.microsoft.com/Downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&displaylang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T12:21:09.717

查看 Red Gate 的[数据生成器](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)工具。我推荐他们建造的任何东西，但我认为这个可以满足您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T12:20:13.357

我建议使用工具生成一次测试数据并将其存储在可以重复填充数据集的数据库中，这将是一个更好的解决方案。您可以使用多种工具来执行此操作：Red Gate [SQL 数据生成器](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)、EMS[数据生成器](http://www.sqlmanager.net/en/products)等。

# fonts - Lazarus 字体错误

> ID：673086
> 
> 赞同：0
> 
> 时间：2009-03-23T11:46:19.707
> 
> 标签：fonts, fedora, lazarus

我最近在我的 Acer Aspire One 上安装了 FPC 2.2.2 和 Lazarus 0.9.6，所以我可以交叉编译一些应用程序，但令我沮丧的是，菜单的字体都是小方块。

有没有人在 Fedora Core 安装上遇到过与 Lazarus 类似的问题，可以给我一些建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T13:06:17.440

即使它适用于 Fedora Core 8 而不是 10，这个[答案也可能会有所帮助。我一直坚持使用 Linpus，并且必须为 Lazarus 做同样的事情才能让字体显示正常。](http://forum.lazarus.freepascal.org/index.php?topic=5803.0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T11:45:10.360

用“make LCL_PLATFORM=gtk2”重新编译默认是（仍然）GTK1，现在看起来很糟糕。（它从来都不是美，但不知何故发行版不再维护它，因为在最近的发行版中它看起来更糟？）

# mysql - 如何跨不同数据库维护外键约束？

> ID：673087
> 
> 赞同：5
> 
> 时间：2009-03-23T11:46:32.733
> 
> 标签：mysql, database-design, symfony1

我知道，*我知道*，将两个相关的表放在不同的数据库中并不是最好的设计实践。但无论如何，假设我*必须*绝对这样做。而且我必须将以前位于数据库中的两个与外键相关的表分解为两个数据库，**它们位于两个不同的服务器上**，但我仍然想保持数据库的完整性。做这个的最好方式是什么？

**编辑：我正在使用 MySQL 和 Symfony**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T12:09:55.393

您是否考虑过[联合表](http://dev.mysql.com/doc/refman/5.0/en/federated-use.html)？这些基本上是指向托管在不同/相同主机上的不同数据库上的表的*链接。*

您可以在本地创建一个联合表并使用它来强制引用完整性。但是，我不能过分强调这样一个事实，即这种方法充满了未来的陷阱，根本不推荐。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T23:43:01.327

我想不出任何方法可以用标准 MySQL 做到这一点。

[您可以为MySQL Proxy](https://launchpad.net/mysql-proxy)编写一个插件，该插件管理不同服务器上父表和子表之间的引用完整性：

*   拦截`INSERT`并`UPDATE`针对子表。查询父表中的匹配行。失败`INSERT`/`UPDATE`如果在父表中找不到匹配项。

*   拦截`DELETE`父表。查询子表中的依赖行。`DELETE`如果在子表中找到任何依赖行，则失败。如果约束旨在支持级联行为，请这样做而不是失败。

*   拦截`UPDATE`父表。如果主键值作为更新的一部分发生变化，则查询在子表中找到的相关行。`UPDATE`如果在子表中找到任何依赖行，则失败。如果约束旨在支持级联行为，请这样做而不是失败。

请注意，您必须在 MySQL 代理插件中保留有关引用完整性约束的信息（或为记录关系的插件编写自定义配置文件）。您不能使用常规`FOREIGN KEY`语法来跨 MySQL 实例声明此类约束。

# silverlight - 这个 Silverlight 模板有什么问题？

> ID：673091
> 
> 赞同：0
> 
> 时间：2009-03-23T11:47:45.197
> 
> 标签：silverlight, silverlight-2.0

我正在使用 Silverlight 2.0 中的模板。我复制了这个...

```
<Style x:Key="RoundButton">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <Grid>
                    <Ellipse Width="200" Height="200">
                        <Ellipse.Fill>
                            <RadialGradientBrush GradientOrigin=".2,.2">
                                <GradientStop Offset="0.2" Color="White" />
                                <GradientStop Offset="1" Color="Blue" />
                            </RadialGradientBrush>
                        </Ellipse.Fill>
                    </Ellipse>

                    <TextBlock Text="Push me" FontSize="28" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

来自[http://weblogs.asp.net/scottgu/pages/silverlight-tutorial-part-7-using-control-templates-to-customize-a-control-s-look-and-feel.aspx](http://weblogs.asp.net/scottgu/pages/silverlight-tutorial-part-7-using-control-templates-to-customize-a-control-s-look-and-feel.aspx)的网页.

我将它放入我的 app.xaml 中，但尚未在任何地方使用它。当我尝试运行我的代码时，我收到一个错误“抛出了‘System.ExecutionEngineException’类型的异常。”

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T11:55:02.497

我相信 Silverlight 需要 TargetType 属性。如果将 TargetType="Button" 添加到 Style 元素，它将编译和执行而不会出现此异常。

**编辑：**是的......我刚刚点击了您发布的链接，他的示例代码中有 TargetType 属性。加上那个，你就很好了。我创建了一个简单的测试应用程序，只有那个 Style 元素和一个使用它的按钮，它运行良好。

# java - 禁用序列化缓存

> ID：673096
> 
> 赞同：1
> 
> 时间：2009-03-23T11:49:39.950
> 
> 标签：java, serialization

有没有办法在 Java 中禁用序列化对象的缓存？

我有这种情况：

1.  我有一个可序列化的对象，我正在序列化它，反序列化它，值没问题。
2.  在同一个对象上，我正在更改一些值，我正在对其进行序列化，反序列化，值不正确，值与最初加载的第一个值相同。

似乎序列化器正在缓存值，或者没有？

谢谢

从“fredrik”复制了这个例子并采用了我的案例：

```
public class SerialDeserial {
    public static void main(String[] args) {
        try {
            ChangingObject obj = new ChangingObject();
            obj.foo=1;
            // Write it
            ObjectOutputStream os = new ObjectOutputStream(new FileOutputStream("test.foo"));
            os.writeObject(obj);
            os.flush();os.close();

            // Read the object
            ObjectInputStream is = new ObjectInputStream(new FileInputStream("test.foo"));
            ChangingObject objDummy = (ChangingObject)is.readObject();
            System.out.println("objDummy.foo is "+objDummy.foo);

            // Change it
            obj.foo=2;
            // Write it
            os = new ObjectOutputStream(new FileOutputStream("test.foo"));
            os.writeObject(obj);
            os.flush();os.close();

            // Read the object
            is = new ObjectInputStream(new FileInputStream("test.foo"));
            objDummy = (ChangingObject)is.readObject();
            System.out.println("objDummy.foo is "+objDummy.foo); // this returns "1" insted of "2"

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}

class ChangingObject implements Serializable {
    public int foo;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T12:06:52.280

[`ObjectOutputStream.reset`](http://java.sun.com/javase/6/docs/api/java/io/ObjectOutputStream.html#reset()).

您也可以使用 编写对象[`writeUnshared`](http://java.sun.com/javase/6/docs/api/java/io/ObjectOutputStream.html#writeUnshared(java.lang.Object))，但这很浅，因此引用的对象仍将被共享。

当然，不可变对象像往常一样是一种胜利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T12:00:54.307

stepancheg 是对的，你确定你没有重读第一个序列化对象吗？

以下示例有效。如果您可以创建类似的东西，请在此处发布。导入java.io.*；

```
public class SerialDeserial {
  public static void main(String[] args) {
    try {
      ChangingObject obj = new ChangingObject();
      obj.foo=1;
      // Write it
      ObjectOutputStream os = new ObjectOutputStream(new FileOutputStream("test.foo"));
      os.writeObject(obj);
      os.flush();os.close();

      // Read the object
      ObjectInputStream is = new ObjectInputStream(new FileInputStream("test.foo"));
      obj = (ChangingObject)is.readObject();
      System.out.println("obj.foo is "+obj.foo);

      // Change it
      obj.foo=2;
      // Write it
      os = new ObjectOutputStream(new FileOutputStream("test.foo"));
      os.writeObject(obj);
      os.flush();os.close();

      // Read the object
      is = new ObjectInputStream(new FileInputStream("test.foo"));
      obj = (ChangingObject)is.readObject();
      System.out.println("obj.foo is "+obj.foo);

    } catch (Exception e) {
      e.printStackTrace();
    }
  }
}

class ChangingObject implements Serializable {
  public int foo;
} 
```

**编辑：**如果我采用您更改的（好吧，不是真的）示例，我仍然会得到正确的输出（使用 2 而不是作为第二个输出）。当您重新打开文件并在读取和写入时从头开始时，您建议进行重置应该没有区别。我认为您的问题出在其他地方（您使用的是什么操作系统？，哪个文件系统？等）它应该可以正常工作，抱歉。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-23T11:52:45.527

序列化程序没有缓存。

您应该展示一个如何重复您的案例的最小示例。

# c# - 使用 WebService 将文件上传到文件夹中的服务器

> ID：673103
> 
> 赞同：1
> 
> 时间：2009-03-23T11:52:00.520
> 
> 标签：c#, asp.net, web-services

我正在尝试使用 webservice 将文件从 Windows 应用程序上传到文件夹中的服务器..（Asp.Net，C#）.. 任何人都可以帮助我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T12:13:12.593

尝试这个：

[http://www.codeproject.com/KB/webservices/wsfileserver.aspx](http://www.codeproject.com/KB/webservices/wsfileserver.aspx)

# javascript - Javascript - 尝试获取数组的原型时获取“未定义”

> ID：673107
> 
> 赞同：1
> 
> 时间：2009-03-23T11:53:36.260
> 
> 标签：javascript, prototype

我认为这是凌晨 5 点的人才流失，但我无法理解这一点。

```
obj = ['a','b'];
alert( obj.prototype ); //returns "undefined" 
```

为什么不`obj.prototype`返回函数`Array(){ }`作为原型？它确实`Array`作为构造函数引用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T12:02:19.840

因为实例没有原型，所以 class* 有。

可能你想要`obj.constructor.prototype`或替代`obj.constructor==Array`

**更准确的说，**构造函数**是有原型的，当然在JS里functions = classes = constructors*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T12:12:14.840

我不确定您是否可以`prototype`从对象的实例访问该对象。以下行为可能会对您有所帮助：

```
alert(Array); // displays "function Array() { [native code] }"
alert(Array.prototype); // displays ""
alert(['a','b'].constructor); // displays "function Array() { [native code] }" 
```

`obj.prototype`没有返回`function Array() { ... }`，因为那是对象的构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T12:34:20.887

在您的示例中，`obj`是一个实例`Array`，而不是类`Array`本身。

另一种理解方式是，例如，您不能从对象（或类）的*实例*继承，只能从对象（或类）本身继承，在您的示例中，这意味着您可以从对象，但不是来自 Array 对象的`Array`直接实例，例如`obj`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T15:43:57.470

根据 ECMA 规范，对象的原型链接是不可见的，但大多数现代浏览器（firefox、safari、chrome）都允许您通过该`__proto__`属性看到它，因此请尝试：

```
obj = ['a','b'];
alert( obj.__proto__ ); 
```

对象还具有构造时设置的“构造函数”属性，因此您可以尝试：

```
obj = ['a','b'];
alert( obj.constructor.prototype ); 
```

但是，`obj.constructor`可以在对象构造后更改，就像 can 一样`obj.constructor.prototype`，而无需更改 obj 的实际原型指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T11:59:42.127

不是真的我的一杯茶，但这种定义它的方式是否使“obj”成为一个数组？试过了

```
obj = new Array();
obj[0] = "a";
obj[1] = "b"; 
```

?

# sql - SQL Server 2005“FOR XML PATH”具有相同名称的多个标签

> ID：673108
> 
> 赞同：3
> 
> 时间：2009-03-23T11:54:17.910
> 
> 标签：sql, sql-server, xml

我有一个如下的 XML 结构

```
<root>
    <person>
        <name>James</name>
        <description xsi:type="me:age">12</description>
        <description xsi:type="me:height>6 foot</description>
... 
```

我必须从桌子上拉出来......

## 人

姓名、年龄、身高

我正在尝试将 SQL 2005 中的 FOR XML 路径内容与类似的查询一起使用

```
SELECT
Name as 'name'
Age as 'description xsi:type="me:age"'
Height as 'description xsi:type="me:height"'
FOR XML PATH('person') 
```

但它给了我一个关于缺少“description xsi”命名空间的错误。有没有办法使用 FOR XML PATH 来实现这一点。实际的查询比这个例子要复杂得多，而且要花很多力气去改变。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-11T22:41:01.070

FOR XML PATH 有时有点困难（至少据我所知）。这可能会让你到达那里：

```
WITH XMLNAMESPACES('uri' as xsi)    
SELECT    
'me:age'     AS 'description/@xsi:type'    
,age         AS 'description'    
,name        AS 'name'   
,'me:height' AS 'description/@xsi:type'    
,height      AS 'description'    
FROM #test    
FOR XML PATH('person') 
```

产生：

```
<person xmlns:xsi="uri">
  <description xsi:type="me:age">32</description>
  <name>Alice</name>
  <description xsi:type="me:height">6 Foot</description>
</person>
<person xmlns:xsi="uri">
  <description xsi:type="me:age">24</description>
  <name>Bob</name>
  <description xsi:type="me:height">5 Feet 5 Inches</description>
</person> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T14:05:54.770

我认为不可能使用`FOR XML PATH`.

我能够使用`FOR XML EXPLICIT`.

输出不是有效的 XML，因为它不包含 then`xsi`命名空间的定义，但它确实符合您的规范：

```
create table #test
(id int identity
,name varchar(50)
,age int
,height varchar(20))

insert #test (name,age,height)
select 'Alice',32,'6 feet one inch'
union select 'Bob',30,'5 feet 10 inches'
union select 'Charles',23,'6 feet two inch'

SELECT 1         AS Tag
       ,NULL     AS Parent
       ,''       AS [root!1]
       ,null     AS [person!2!name!ELEMENT]
       ,null     AS [description!3]
       ,null     AS [description!3!xsi:type]  
       ,null     AS [description!4]
       ,null     AS [description!4!xsi:type]     
UNION ALL
SELECT 2         AS Tag
       ,1        AS Parent
       ,null
       ,name
       ,null
       ,null 
       ,null
       ,null    
FROM #test
UNION ALL
SELECT 3         AS Tag
       ,2        AS Parent
       ,null       
       ,name     
       ,age      
       ,'me:age' 
       ,null
       ,null 
FROM #test
UNION ALL
SELECT 4         AS Tag
       ,2        AS Parent
       ,null       
       ,name     
       ,null
       ,null
       ,height   
       ,'me:height'
FROM #test
order by [person!2!name!ELEMENT],Tag
FOR XML EXPLICIT 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-21T21:34:55.210

一个很好的解决方案，类似于 eddiegroves，但不需要重新排序同名兄弟姐妹，可以在[这里](http://beyondrelational.com/ask/public/questions/288/different-attributes-as-repeating-lines-using-for-xml-path.aspx)找到。

改编的代码示例（也从 eddiegroves 的答案修改）：

```
WITH XMLNAMESPACES('uri' as xsi)
SELECT name AS 'person/name'
,   'me:age' AS 'person/description/@xsi:type'
,   age AS 'person/description'
,   '' AS 'person'
,   'me:height' AS 'person/description/@xsi:type'
,   height AS 'person/description'
,   '' AS 'person'
,   'me:weight' AS 'person/description/@xsi:type'
,   weight AS 'person/description'
FROM #test
FOR XML PATH('') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-09T20:13:40.777

```
<rt> 
  <A> 
    <B> 
      <C> 
        <D> 
          <E>a</E> 
          <F>b</F> 
          <G>c</G> 
        </D> 
    <D> 
          <E>x</E> 
          <F>y</F> 
          <G>z</G> 
        </D> 
      </C> 
    </B> 
  </A> 
</rt> 
```

--打印标签后，我在查询中添加了以下字段以关闭和打开标签

```
,(SELECT * FROM          
    (SELECT '' AS 'text()'           
    ) l         
    FOR XML PATH(''),type) as 'A/B/C' 
```

--使用借来的代码

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-25T16:41:52.663

我们需要制作这样的东西......

```
<rt>
  <A>
    <B>
      <C>
        <D>
          <E>a</E>
          <E>b</E>
          <E>c</E>
          <E>d</E>
        </D>
      </C>
    </B>
  </A>
</rt> 
```

它具有重复的 E 元素。

我们用下面的 t-sql 做到了。

```
select 
    '' as "A/B/C/D"
    ,
    (
        SELECT * FROM 
        (
              SELECT 'a' AS 'text()'
        UNION SELECT 'b' AS 'text()'
        UNION SELECT 'c' AS 'text()'
        UNION SELECT 'd' AS 'text()'
        ) l
        FOR XML PATH('E'),type 
    ) as 'A/B/C/D'

from [Case]
where [Case].CaseRef = 'YOUR_PKEY' 
for xml path('rt')
go 
```

也应该可以戳 xsi 属性...

# c# - 穷人的 C#“词法分析器”

> ID：673113
> 
> 赞同：33
> 
> 时间：2009-03-23T11:57:23.037
> 
> 标签：c#, regex, lexer

我正在尝试用 C# 编写一个非常简单的解析器。

我需要一个词法分析器——它可以让我将正则表达式与标记相关联，因此它可以读取正则表达式并返回符号。

似乎我应该能够使用 Regex 来完成实际的繁重工作，但我看不到一个简单的方法来做到这一点。一方面，Regex 似乎只适用于字符串，而不适用于流（为什么会这样！？！？）。

基本上，我想要以下接口的实现：

```
interface ILexer : IDisposable
{
    /// <summary>
    /// Return true if there are more tokens to read
    /// </summary>
    bool HasMoreTokens { get; }
    /// <summary>
    /// The actual contents that matched the token
    /// </summary>
    string TokenContents { get; }
    /// <summary>
    /// The particular token in "tokenDefinitions" that was matched (e.g. "STRING", "NUMBER", "OPEN PARENS", "CLOSE PARENS"
    /// </summary>
    object Token { get; }
    /// <summary>
    /// Move to the next token
    /// </summary>
    void Next();
}

interface ILexerFactory
{
    /// <summary>
    /// Create a Lexer for converting a stream of characters into tokens
    /// </summary>
    /// <param name="reader">TextReader that supplies the underlying stream</param>
    /// <param name="tokenDefinitions">A dictionary from regular expressions to their "token identifers"</param>
    /// <returns>The lexer</returns>
    ILexer CreateLexer(TextReader reader, IDictionary<string, object> tokenDefinitions);
} 
```

所以，请发送 codz...
不，说真的，我即将开始编写上述接口的实现，但我发现很难相信在 .NET (2.0) 中已经没有一些简单的方法可以做到这一点.

那么，对于执行上述操作的简单方法有什么建议吗？（另外，我不想要任何“代码生成器”。性能对于这件事并不重要，我不想在构建过程中引入任何复杂性。）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-23T14:46:55.530

我在此处作为答案发布的原始版本存在一个问题，即它仅在有多个与当前表达式匹配的“正则表达式”时才有效。也就是说，只要只有一个 Regex 匹配，它就会返回一个令牌 - 而大多数人希望 Regex 是“贪婪的”。对于诸如“引用的字符串”之类的内容尤其如此。

位于 Regex 之上的唯一解决方案是逐行读取输入（这意味着您不能拥有跨越多行的标记）。我可以忍受这个——毕竟，这是一个穷人的词法分析器！此外，在任何情况下，从 Lexer 中获取行号信息通常很有用。

因此，这是一个解决这些问题的新版本。[这](http://sites.google.com/site/fredm/linguist-parsing-system)也归功于

```
public interface IMatcher
{
    /// <summary>
    /// Return the number of characters that this "regex" or equivalent
    /// matches.
    /// </summary>
    /// <param name="text">The text to be matched</param>
    /// <returns>The number of characters that matched</returns>
    int Match(string text);
}

sealed class RegexMatcher : IMatcher
{
    private readonly Regex regex;
    public RegexMatcher(string regex) => this.regex = new Regex(string.Format("^{0}", regex));

    public int Match(string text)
    {
        var m = regex.Match(text);
        return m.Success ? m.Length : 0;
    }
    public override string ToString() => regex.ToString();
}

public sealed class TokenDefinition
{
    public readonly IMatcher Matcher;
    public readonly object Token;

    public TokenDefinition(string regex, object token)
    {
        this.Matcher = new RegexMatcher(regex);
        this.Token = token;
    }
}

public sealed class Lexer : IDisposable
{
    private readonly TextReader reader;
    private readonly TokenDefinition[] tokenDefinitions;

    private string lineRemaining;

    public Lexer(TextReader reader, TokenDefinition[] tokenDefinitions)
    {
        this.reader = reader;
        this.tokenDefinitions = tokenDefinitions;
        nextLine();
    }

    private void nextLine()
    {
        do
        {
            lineRemaining = reader.ReadLine();
            ++LineNumber;
            Position = 0;
        } while (lineRemaining != null && lineRemaining.Length == 0);
    }

    public bool Next()
    {
        if (lineRemaining == null)
            return false;
        foreach (var def in tokenDefinitions)
        {
            var matched = def.Matcher.Match(lineRemaining);
            if (matched > 0)
            {
                Position += matched;
                Token = def.Token;
                TokenContents = lineRemaining.Substring(0, matched);
                lineRemaining = lineRemaining.Substring(matched);
                if (lineRemaining.Length == 0)
                    nextLine();

                return true;
            }
        }
        throw new Exception(string.Format("Unable to match against any tokens at line {0} position {1} \"{2}\"",
                                          LineNumber, Position, lineRemaining));
    }

    public string TokenContents { get; private set; }
    public object Token   { get; private set; }
    public int LineNumber { get; private set; }
    public int Position   { get; private set; }

    public void Dispose() => reader.Dispose();
} 
```

示例程序：

```
string sample = @"( one (two 456 -43.2 "" \"" quoted"" ))";

var defs = new TokenDefinition[]
{
    // Thanks to [steven levithan][2] for this great quoted string
            // regex
    new TokenDefinition(@"([""'])(?:\\\1|.)*?\1", "QUOTED-STRING"),
    // Thanks to http://www.regular-expressions.info/floatingpoint.html
    new TokenDefinition(@"[-+]?\d*\.\d+([eE][-+]?\d+)?", "FLOAT"),
    new TokenDefinition(@"[-+]?\d+", "INT"),
    new TokenDefinition(@"#t", "TRUE"),
    new TokenDefinition(@"#f", "FALSE"),
    new TokenDefinition(@"[*<>\?\-+/A-Za-z->!]+", "SYMBOL"),
    new TokenDefinition(@"\.", "DOT"),
    new TokenDefinition(@"\(", "LEFT"),
    new TokenDefinition(@"\)", "RIGHT"),
    new TokenDefinition(@"\s", "SPACE")
};

TextReader r = new StringReader(sample);
Lexer l = new Lexer(r, defs);
while (l.Next())
    Console.WriteLine("Token: {0} Contents: {1}", l.Token, l.TokenContents); 
```

输出：

```
Token: LEFT Contents: (
Token: SPACE Contents:
Token: SYMBOL Contents: one
Token: SPACE Contents:
Token: LEFT Contents: (
Token: SYMBOL Contents: two
Token: SPACE Contents:
Token: INT Contents: 456
Token: SPACE Contents:
Token: FLOAT Contents: -43.2
Token: SPACE Contents:
Token: QUOTED-STRING Contents: " \" quoted"
Token: SPACE Contents:
Token: RIGHT Contents: )
Token: RIGHT Contents: ) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T15:03:53.367

这可能是矫枉过正，但看看CodePlex 上的[Irony](http://www.codeplex.com/irony)。

*Irony 是一个在 .NET 平台上实现语言的开发工具包。它利用 c# 语言和 .NET Framework 3.5 的灵活性和强大功能来实现一种全新的、流线型的编译器构造技术。与大多数现有的 yacc/lex 风格的解决方案不同，Irony 不使用任何扫描器或解析器代码生成来自以专门的元语言编写的语法规范。在 Irony 中，目标语言语法直接用 C# 编码，使用运算符重载来表达语法结构。Irony 的扫描器和解析器模块使用编码为 c# 类的语法来控制解析过程。请参阅表达式语法示例以获取 c# 类中的语法定义示例，并在工作解析器中使用它。*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-23T12:30:27.620

除非你有一个非常规的语法，否则我*强烈*建议不要使用你自己的词法分析器/解析器。

我通常发现 C# 的词法分析器/解析器真的很缺乏。但是，F# 附带 fslex 和 fsyacc，您可以[在本教程](http://plus.kaist.ac.kr/~shoh/ocaml/ocamllex-ocamlyacc/ocamlyacc-tutorial/)中了解如何使用它们。我用 F# 编写了几个词法分析器/解析器，并在 C# 中使用它们，而且它很容易做到。

我想它并不是一个穷人的词法分析器/解析器，因为你必须学习一门全新的语言才能开始，但它是一个开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T12:41:23.367

改变我原来的答案。

看看具有不同语法类型的解析器的[SharpTemplate](http://sharptemplate.codeplex.com/)，例如

```
#foreach ($product in $Products)
   <tr><td>$product.Name</td>
   #if ($product.Stock > 0)
      <td>In stock</td>
   #else
     <td>Backordered</td>
   #end
  </tr>
#end 
```

它对每种类型的令牌使用正则表达式：

```
public class Velocity : SharpTemplateConfig
{
    public Velocity()
    {
        AddToken(TemplateTokenType.ForEach, @"#(foreach|{foreach})\s+\(\s*(?<iterator>[a-z_][a-z0-9_]*)\s+in\s+(?<expr>.*?)\s*\)", true);
        AddToken(TemplateTokenType.EndBlock, @"#(end|{end})", true);
        AddToken(TemplateTokenType.If, @"#(if|{if})\s+\((?<expr>.*?)\s*\)", true);
        AddToken(TemplateTokenType.ElseIf, @"#(elseif|{elseif})\s+\((?<expr>.*?)\s*\)", true);
        AddToken(TemplateTokenType.Else, @"#(else|{else})", true);
        AddToken(TemplateTokenType.Expression, @"\${(?<expr>.*?)}", false);
        AddToken(TemplateTokenType.Expression, @"\$(?<expr>[a-zA-Z_][a-zA-Z0-9_\.@]*?)(?![a-zA-Z0-9_\.@])", false);
    }
} 
```

像这样使用哪个

```
foreach (Match match in regex.Matches(inputString))
{
    ...

    switch (tokenMatch.TokenType)
    {
        case TemplateTokenType.Expression:
            {
                currentNode.Add(new ExpressionNode(tokenMatch));
            }
            break;

        case TemplateTokenType.ForEach:
            {
                nodeStack.Push(currentNode);

                currentNode = currentNode.Add(new ForEachNode(tokenMatch));
            }
            break;
        ....
    }

    ....
} 
```

它从堆栈中推送和弹出以保持状态。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T13:07:53.507

[Malcolm Crowe在此处](http://cis.paisley.ac.uk/crow-ci0/)为 C# 提供了出色的 LEX/YACC 实现。通过为 LEX 创建正则表达式来工作...

[直接下载](http://cis.paisley.ac.uk/crow-ci0/CSTools.zip)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T12:01:16.397

如果您查看我的[WPF 转换器库](http://wpfconverters.codeplex.com)中的 ExpressionConverter ，它具有 C# 表达式的基本词法分析和解析。从记忆中不涉及正则表达式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T12:57:39.663

可以将 Flex 和 Bison 用于 C#。

爱尔兰大学的一位研究人员开发了一个部分实现，可以在以下链接中找到：[Flex/Bison for C#](http://www.cs.nuim.ie/~jpower/Research/csharp/Index.html)

它绝对可以被认为是一个“可怜的人词法分析器”，因为他的实现似乎仍然存在一些问题，例如没有预处理器、“悬空其他”案例的问题等。

# c++ - 是否可以在 C++ 中创建方法调用调度程序？

> ID：673114
> 
> 赞同：5
> 
> 时间：2009-03-23T11:57:23.770
> 
> 标签：c++, pointers, methods, types, dispatcher

考虑以下代码：

```
struct X {
  void MethodX() {
    ...
  }
};

struct Y {
  void MethodY() {
    ...
  }
};

void test () {
  X x;
  Y y;
  Dispatcher d;
  d.Register("x", x, &X::MethodX);
  d.Register("y", y, &Y::MethodY);
  d.Call("x");
  d.Call("y");
} 
```

问题是如何实现 Dispatcher。我不介意 X 和 Y 可能从某些东西继承，但是 Dispatcher 应该允许更多的客户端（不仅是 X 和 Y）。如果可能的话，我想避免使用 void* 指针:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T11:58:52.643

看看[boost::function](http://www.boost.org/doc/libs/1_38_0/doc/html/function.html)，它就是这样做的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T12:33:02.123

为避免提高使用率并实现您自己的，您可以查看本书 [http://en.wikipedia.org/wiki/Modern_C%2B%2B_Design](http://en.wikipedia.org/wiki/Modern_C%2B%2B_Design)

书中描述了一个 Loki 库，它很好地解释了如何让你自己的函数足够聪明，以满足你需要的函子。

```
class Dispather
{
public:
    typedef boost::function< void ( void ) > FunctionT;

    void Register( const std::string& name, FunctionT function )
    {
        registered_[ name ] = function;
    }

    void Call( const std::string& name )
    {
        RegisterdFunctionsT::const_iterator it =
            registered_.find( name );

        if ( it == registered_.end() )
            throw std::logic_error( "Function is not registered" );

        (it->second)();
    }

private:
    typedef std::map< std::string, FunctionT > RegisterdFunctionsT;
    RegisterdFunctionsT registered_;

};

int main()
{
    X x;
    Y y;

    Dispather d;
    d.Register( "x", boost::bind( &X::MethodX, &x ) );
    d.Register( "y", boost::bind( &Y::MethodY, &y ) );

    d.Call( "x" );
    d.Call( "y" );

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T12:03:07.437

看看这篇论文：

[http://www.oopweb.com/CPP/Documents/FunctionPointers/Volume/CCPP/functor/functor.html](http://www.oopweb.com/CPP/Documents/FunctionPointers/Volume/CCPP/functor/functor.html)

它在 C++ 中实现了一个基于模板的仿函数。void* 在幕后使用，但它都是类型安全的，因为它由创建和解包 void* 的模板函数包装。这将使实现这一点变得容易。它支持普通方法指针不支持的各种调用样式（例如，您可以传递一个返回某些东西的函数，作为返回 void 的函子，它会自动忽略返回值）

# qa - 设计阶段的质量保证？

> ID：673128
> 
> 赞同：6
> 
> 时间：2009-03-23T12:01:35.710
> 
> 标签：qa

质量保证如何融入软件开发的设计阶段？

在设计阶段进行了哪些（如果有）质量保证活动？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T12:13:52.403

QA 在设计阶段可以做的最有用的事情是确保提供的规范具有一组清晰、可测试的目标。并使用这些目标来制定测试计划。

这样他们就可以回答两个非常重要的问题：“**这可以测试吗**”和“测试**需要多长时间**”。首先是确保每个人都知道项目完成的标准很重要。第二个是必要的，因为它构成了实施总成本的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T19:14:07.930

设计阶段：设计过程中缺乏质量会使良好的需求规范失效，并可能使正确的实施变得不可能。行业实践表明，在设计过程中使用清单有助于提高设计质量

我们是否解决了 SRS 中提到的所有要求？SRS 是否已置于文件控制之下？在设计过程中是否解决了与以下功能相关的要求？性能、安全性、并发性、可用性、可移植性、可测试性、语言/数据库/操作系统/硬件要求、开发环境、兼容性、遵守行业标准、可扩展性、异常处理

选择的设计方法是否适合要开发的软件项目类型。清晰性：设计文档是否清晰/明确？他的设计是否在技术上是合理的 与现有软件的兼容性 是否已确定该设计对现有软件的影响 我们是否进行了影响分析 该设计是否依赖于其他软件的副作用？该设计是否依赖于任何其他相关设计？

组件级别：接口是否定义良好？是否定义了主要数据结构 是否定义了主要算法 是否定义了数据/控制流 数据结构和算法 是否定义了数据结构 是否定义了对数据结构的访问方法？是否定义了算法？数据结构和算法能解决问题吗

错误/异常处理 是否处理数据类型错误？软件是否验证用户输入？如果发生错误，软件是否会给出明确的、非威胁性的消息？（错误消息的质量）。软件出现错误后可以从任意点重新启动吗？软件是否优雅地处理异常情况，例如访问冲突和浮点错误。

过程接口 实际参数的数量是否与形式参数的数量相匹配？实参的类型和大小是否与形参的类型和大小匹配？我们是否正确指定了局部和全局函数？全局变量是否跨模块一致地定义和使用？是否记录了所有通信（即参数和共享数据）？

过程级别 过程是否与现有过程非常相似？是否有一个库程序可以做同样的事情？程序是否过于复杂 能否将程序分解成独立的、更符合逻辑的部分。程序的大小是否可以接受？

该过程是否只做一件合乎逻辑的事情？该过程是否依赖于过程范围静态变量？该程序是否易于维护和正确引用？该程序是否易于测试？是否描述了副作用？

质量 是否规定了设计目标（可靠性、灵活性、可维护性、性能等）？设计是否满足其既定目标？（需求的可追溯性）是否有证据表明考虑了多个设计选项？是否列出了几个设计选项以及采用或拒绝的原因？是否规定了设计假设 是否规定了设计权衡 设计是否有效？设计是否可维护？设计是否便携？设计能否以最少的修改处理外部环境的变化？是设计参数驱动还是程序中硬编码的值。

要求 设计是否满足所有要求？设计和系统规范之间是否存在可追溯性？设计能否满足开发成本要求？能否在规定时间内完成？设计是否符合要求的内存限制 设计是否符合要求的磁盘使用限制 设计是否满足响应时间要求？设计能否处理预期的交易率？设计能否处理预期的数据流量？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T12:11:50.147

好的设计是可测试的设计。IMO，即使在设计阶段，人们也需要始终考虑如何测试软件。当然，所需的关注程度取决于您是在进行详细设计还是高级架构。使用诸如 TDD 之类的方法将迫使人们关注设计期间测试的重要性。当然，不应忽视 QA 的其他方面，例如可用性测试、性能测试等。这些也是设计过程中需要考虑的重要因素——如何实现目标以及如何评估目标是否实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T12:22:03.490

*质量保证*根本不适合设计阶段。QA 是在缺陷发生后对其进行修复，这是上个千年的普遍做法。当然，在设计过程中产生的规范文件中可能存在缺陷，但除了那些你还没有产品的缺陷，因此没有缺陷可查。

*另一方面，*质量管理是 21 世纪的必经之路。*它是一种综合的缺陷*预防*方法。从一开始就将其集成到您的项目中至关重要，因此它绝对必须适合设计。*

 *关于这个主题有成千上万的书籍和网页，但 IMO 最重要的是：

1.  从早期的错误中吸取教训。分析类似的项目，看看那里犯的最大错误是什么。尽量在你的项目中避免它们。
2.  项目完成后，进行事后审查，找出上述步骤 1 中遗漏的内容。在下一个类似项目中使用该信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T12:22:11.760

大致有一个架构设计阶段和一个详细设计阶段。

这些阶段的质量保证活动可能包括：

*   确保架构支持所有（非）功能需求
*   确保在详细设计中涵盖并正确设计所有重要模块
*   确保设计文档处于配置（变更）管理之下
*   进行（正式）审查以审查架构及其文档
*   确保遵循预定义的设计标准

这有时被称为“软件质量关键设计评审”。[您可以在此处](http://sw-assurance.gsfc.nasa.gov/disciplines/quality/checklists/pdf/critical_design_review.pdf)查看示例清单。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T17:07:53.803

要了解它如何适合您的特定开发过程，您必须考虑：

*   产品质量是整个团队的责任。每个角色组都必须为项目带来相应的价值（如果您觉得缺少某些技能，请为项目带来帮助）。不要让质量团队进行那些/应该是同行评审的活动，即架构/设计评审。
*   QA 不是你丢掉项目中任何缺失责任的地方，即项目管理应该关心预算、风险等。这个角色的责任是确保所有这些都到位。除此之外，您还可以使用审核+指导来帮助每个团队成员履行职责。
*   QA 确实对架构/设计做出了贡献，因为他们认为架构/设计应该是可测试的。他们积极考虑/计划/设计他们将如何测试所述架构/设计，这是进行有效/成功测试工作的重要因素。
*   QA 为各种工件做出了贡献，就像开发方面一样。始终关注它与他们想要实现的目标的关系。
*   QA 需要准备从开发开始就开始测试自动化。这还涉及与开发人员和计划的重要协调，以便使用允许 QA 团队持续/逐步进行测试自动化的开发方法。
*   就像开发活动的范围/优先级一样，QA 团队也必须这样做。在一个项目中可以完成的测试有很多变体，以至于不可能在完全覆盖的情况下真正完成所有测试。这将影响项目中的 QA 工作，并且还有助于明确在 QA 团队方面遗漏了哪些内容（可能会采取其他措施来解决其他角色的问题）。
*   活动的完成方式/时间与所使用的流程和实践密切相关。一个简化是：如果您涉及开发活动/工作，那么质量检查工作也应该进行一些有意义的事情。
*   不同方法中的大多数角色和活动都是为了增加项目质量和相关产品的不同方面。

# perl - 如何在 Perl 中捕获 rsync 进度消息？

> ID：673145
> 
> 赞同：2
> 
> 时间：2009-03-23T12:07:04.043
> 
> 标签：perl, rsync

我想从 Perl 脚本中捕获 rsync 进程发出的所有进度消息。在某些情况下，这不起作用。

这是我使用的典型 rsync 命令行：

```
rsync -aL --verbose --progress --bwlimit=100 \
  --include-from=/tmp/78hJ2eDCs1 \
  --include '*/' --exclude '*' \
  /srcdir/* \
  hostname:/target/ 2>&1 
```

如果我在 bash shell 中运行它，我会看到如下内容：

```
Building file list ...
1600 files...
1700 files...
and so on 
```

如果我在 Perl 中尝试相同的命令，我会得到“构建文件列表”输出 OK，但不是状态更新。这是我测试捕获的方法

```
my $pid = open(OUTPUT, "$cmd |")  or die "Couldn't fork: $!\n";

my $ch;
while(read(OUTPUT, $ch, 1)==1)
{
    print $ch;
}
close(OUTPUT); 
```

我的猜测是，要么 rsync 感知到输出句柄不是典型的控制台，要么以某种我没有捕获的不寻常方式输出。*然而，更奇怪的是，如果我省略 --include 和 --exclude 过滤器，我可以很好地捕获状态消息。*

有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T12:13:34.667

perl 是否缓冲管道的输出？如果是这样，如果在打开 OUTPUT 句柄后使用 OUTPUT->autoflush(1) 关闭缓冲，则可能可以使其正常工作；

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T12:15:17.097

您可以使用模仿 PTY 的[Expect.pm](http://search.cpan.org/~rgiersig/Expect-1.15/Expect.pod)，它可能会为您提供您正在寻找的输出。

如果做不到这一点，您可以尝试[`--stats`](http://search.cpan.org/~rgiersig/Expect-1.15/Expect.pod)or[`--progress`](http://www.manpagez.com/man/1/rsync/)选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T14:02:05.437

原来解决方案很简单——我只需要在我的脚本中取消缓冲 IO`$| = 1;`

我仍然对我如何观察一些 rsync 选项而不是其他选项的问题感到困惑。谢谢 Paul Tomblin 和 dsm 给我的想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T15:21:40.750

您可能还想使用 IPC::Run 它是标准输出/标准错误上数据的回调。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-31T12:17:38.993

[受缓冲之苦？](http://perl.plover.com/FAQs/Buffering.html)是迄今为止我发现的关于缓冲效果的最佳解释。非常值得花时间阅读和理解。

不要忘记缓冲是有原因的，所以不要盲目地为每个可能的问题关闭它。

# css - css 字体大小

> ID：673152
> 
> 赞同：1
> 
> 时间：2009-03-23T12:11:02.020
> 
> 标签：css, fonts

CSS：

```
.lnk { font-size:0.9em; color:#0000CC; font-family:Courier New; } 
```

我如何在 Paint.NET 中获得与此等效的内容？

我偶然发现了本指南：

```
100% = 1.0em = 16px = 15pt
95% = 0.95em = 15px = 14pt
90% = 0.9em = 14px = 13pt
85% = 0.85em = 13px = 12pt
80% = 0.8em = 12px = 11pt
75% = 0.75em = 11px = 10pt
70% = 0.7em = 10px = 9pt
65% = 0.65em = 9px = 8pt 
```

但这似乎不正确。

（有点相关[这个](https://stackoverflow.com/questions/672989/default-web-font)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T12:20:52.167

对应于 1 em 的大小取决于文档的默认字体大小。

理论上，0.9 em = 0.9 * 默认字体大小（通常为 12pt）。

这里似乎解释得很好：[http ://www.thesug.org/blogs/kyles/Lists/Posts/Post.aspx?ID=22](http://www.thesug.org/blogs/kyles/Lists/Posts/Post.aspx?ID=22)

# javascript - 带有固定标题的 HTML 表格？

> ID：673153
> 
> 赞同：246
> 
> 时间：2009-03-23T12:11:12.333
> 
> 标签：javascript, css, html-table

是否有一种跨浏览器 CSS/JavaScript 技术来显示一个长 HTML 表格，以便列标题保持固定在屏幕上并且不随表格主体滚动。想想 Microsoft Excel 中的“冻结窗格”效果。

我希望能够滚动浏览表格的内容，但始终能够看到顶部的列标题。

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2014-09-18T01:35:01.870

## 这可以用四行代码干净地解决。

如果您只关心现代浏览器，则可以通过使用 CSS 转换更轻松地实现固定标头。听起来很奇怪，但效果很好：

*   HTML 和 CSS 保持原样。
*   没有外部 JavaScript 依赖项。
*   四行代码。
*   适用于所有配置（表格布局：固定等）。

```
document.getElementById("wrap").addEventListener("scroll", function(){
   var translate = "translate(0,"+this.scrollTop+"px)";
   this.querySelector("thead").style.transform = translate;
}); 
```

除了 Internet Explorer 8- 之外，对 CSS 转换的支持已[得到广泛应用。](http://caniuse.com/#feat=transforms2d)

这是供参考的完整示例：

```
document.getElementById("wrap").addEventListener("scroll",function(){
   var translate = "translate(0,"+this.scrollTop+"px)";
   this.querySelector("thead").style.transform = translate;
});
```

```
/* Your existing container */
#wrap {
    overflow: auto;
    height: 400px;
}

/* CSS for demo */
td {
    background-color: green;
    width: 200px;
    height: 100px;
}
```

```
<div id="wrap">
    <table>
        <thead>
            <tr>
                <th>Foo</th>
                <th>Bar</th>
            </tr>
        </thead>
        <tbody>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
            <tr><td></td><td></td></tr>
        </tbody>
    </table>
</div>
```

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2011-10-11T20:49:21.100

我一直在寻找解决方案，发现大多数答案都不起作用或不适合我的情况，所以我用 jQuery 编写了一个简单的解决方案。

这是解决方案大纲：

1.  克隆需要有固定表头的表，并将克隆的副本放在原始的顶部。
2.  从顶部桌子上取下桌子主体。
3.  从底部表格中删除表格标题。
4.  调整列宽。（我们跟踪原始列宽）

以下是可运行演示中的代码。

```
function scrolify(tblAsJQueryObject, height) {
  var oTbl = tblAsJQueryObject;

  // for very large tables you can remove the four lines below
  // and wrap the table with <div> in the mark-up and assign
  // height and overflow property  
  var oTblDiv = $("<div/>");
  oTblDiv.css('height', height);
  oTblDiv.css('overflow', 'scroll');
  oTbl.wrap(oTblDiv);

  // save original width
  oTbl.attr("data-item-original-width", oTbl.width());
  oTbl.find('thead tr td').each(function() {
    $(this).attr("data-item-original-width", $(this).width());
  });
  oTbl.find('tbody tr:eq(0) td').each(function() {
    $(this).attr("data-item-original-width", $(this).width());
  });

  // clone the original table
  var newTbl = oTbl.clone();

  // remove table header from original table
  oTbl.find('thead tr').remove();
  // remove table body from new table
  newTbl.find('tbody tr').remove();

  oTbl.parent().parent().prepend(newTbl);
  newTbl.wrap("<div/>");

  // replace ORIGINAL COLUMN width				
  newTbl.width(newTbl.attr('data-item-original-width'));
  newTbl.find('thead tr td').each(function() {
    $(this).width($(this).attr("data-item-original-width"));
  });
  oTbl.width(oTbl.attr('data-item-original-width'));
  oTbl.find('tbody tr:eq(0) td').each(function() {
    $(this).width($(this).attr("data-item-original-width"));
  });
}

$(document).ready(function() {
  scrolify($('#tblNeedsScrolling'), 160); // 160 is height
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>

<div style="width:300px;border:6px green solid;">
  <table border="1" width="100%" id="tblNeedsScrolling">
    <thead>
      <tr><th>Header 1</th><th>Header 2</th></tr>
    </thead>
    <tbody>
      <tr><td>row 1, cell 1</td><td>row 1, cell 2</td></tr>
      <tr><td>row 2, cell 1</td><td>row 2, cell 2</td></tr>
      <tr><td>row 3, cell 1</td><td>row 3, cell 2</td></tr>
      <tr><td>row 4, cell 1</td><td>row 4, cell 2</td></tr>			
      <tr><td>row 5, cell 1</td><td>row 5, cell 2</td></tr>
      <tr><td>row 6, cell 1</td><td>row 6, cell 2</td></tr>
      <tr><td>row 7, cell 1</td><td>row 7, cell 2</td></tr>
      <tr><td>row 8, cell 1</td><td>row 8, cell 2</td></tr>			
    </tbody>
  </table>
</div>
```

此解决方案适用于 Chrome 和 IE。由于它是基于 jQuery 的，因此它应该也可以在其他支持 jQuery 的浏览器中使用。

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2009-10-06T05:56:45.130

我刚刚完成了一个 jQuery 插件，它将使用有效的 HTML 获取有效的单个表（必须有一个 thead 和 tbody），并将输出一个具有固定标题的表，可选的固定页脚可以是克隆的标题或任何您选择的内容（分页等）。如果您想利用更大的显示器，它也会在调整浏览器大小时调整表格大小。如果表格列不能全部放在视图中，另一个附加功能是能够侧滚动。

[http://fixedheadertable.com/](http://fixedheadertable.com/)

在 github 上：http: [//markmalek.github.com/Fixed-Header-Table/](http://markmalek.github.com/Fixed-Header-Table/)

它非常容易设置，您可以为其创建自己的自定义样式。它还在所有浏览器中使用圆角。请记住，我刚刚发布了它，所以它在技术上仍然是测试版，我正在解决的小问题很少。

它适用于 Internet Explorer 7、Internet Explorer 8、Safari、Firefox 和 Chrome。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-12-04T17:00:46.230

我还创建了一个插件来解决这个问题。我的项目 - [jQuery.floatThead](http://mkoryak.github.io/floatThead/)已经存在 4 年多了，并且非常成熟。

它不需要外部样式，也不希望您的表格以任何特定方式设置样式。它支持 Internet Explorer9+ 和 Firefox/Chrome。

目前（2018-05）它有：

> GitHub 上 405 次提交和 998 颗星

* * *

这里的许多（不是全部）答案都是快速破解，可能已经解决了一个人遇到的问题，但不适用于每张桌子。

其他一些插件很旧，可能在 Internet Explorer 上运行良好，但在 Firefox 和 Chrome 上会中断。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2012-10-25T15:04:48.240

所有从 CSS 规范之外解决这个问题的尝试都与我们真正想要的东西相去甚远：交付 THEAD 的隐含承诺。

很长一段时间以来，HTML/CSS 中的冻结标题问题一直是一个开放的伤口。

在一个完美的世界里，这个问题会有一个纯 CSS 的解决方案。不幸的是，似乎没有一个好的地方。

关于该主题的相关标准讨论包括：

*   www-style 的粘性定位提案：http: [//lists.w3.org/Archives/Public/www-style/2012Jun/0627.html](http://lists.w3.org/Archives/Public/www-style/2012Jun/0627.html)
*   Tab Atkins 对 position-root、position-contain 或 position-restrict 的提议： [http ://www.xanthir.com/blog/b48H0](http://www.xanthir.com/blog/b48H0)

**更新**：Firefox`position:sticky`在 32 版中发布。每个人都赢了！

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2013-11-17T11:49:02.563

# TL;博士

如果您针对现代浏览器并且没有奢侈的样式需求： http: [//jsfiddle.net/dPixie/byB9d/3/](http://jsfiddle.net/dPixie/byB9d/3/) ...虽然[四大版本](http://www.imaputz.com/cssStuff/bigFourVersion.html)也很可爱，但这个版本处理流体宽度要好得多。

# 大家好消息！

随着 HTML5 和 CSS3 的进步，这现在是可能的，至少对于现代浏览器来说是这样。我想出的稍微有点骇人听闻的实现可以在这里找到：http: [//jsfiddle.net/dPixie/byB9d/3/](http://jsfiddle.net/dPixie/byB9d/3/)。我已经在 FX 25、Chrome 31 和 IE 10 中对其进行了测试...

相关 HTML（尽管在文档顶部插入 HTML5 文档类型）：

```
html,
body {
  margin: 0;
  padding: 0;
  height: 100%;
}

section {
  position: relative;
  border: 1px solid #000;
  padding-top: 37px;
  background: #500;
}

section.positioned {
  position: absolute;
  top: 100px;
  left: 100px;
  width: 800px;
  box-shadow: 0 0 15px #333;
}

.container {
  overflow-y: auto;
  height: 200px;
}

table {
  border-spacing: 0;
  width: 100%;
}

td+td {
  border-left: 1px solid #eee;
}

td,
th {
  border-bottom: 1px solid #eee;
  background: #ddd;
  color: #000;
  padding: 10px 25px;
}

th {
  height: 0;
  line-height: 0;
  padding-top: 0;
  padding-bottom: 0;
  color: transparent;
  border: none;
  white-space: nowrap;
}

th div {
  position: absolute;
  background: transparent;
  color: #fff;
  padding: 9px 25px;
  top: 0;
  margin-left: -25px;
  line-height: normal;
  border-left: 1px solid #800;
}

th:first-child div {
  border: none;
}
```

```
<section class="positioned">
  <div class="container">
    <table>
      <thead>
        <tr class="header">
          <th>
            Table attribute name
            <div>Table attribute name</div>
          </th>
          <th>
            Value
            <div>Value</div>
          </th>
          <th>
            Description
            <div>Description</div>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>align</td>
          <td>left, center, right</td>
          <td>Not supported in HTML5\. Deprecated in HTML 4.01\. Specifies the alignment of a table according to surrounding text</td>
        </tr>
        <tr>
          <td>bgcolor</td>
          <td>rgb(x,x,x), #xxxxxx, colorname</td>
          <td>Not supported in HTML5\. Deprecated in HTML 4.01\. Specifies the background color for a table</td>
        </tr>
        <tr>
          <td>border</td>
          <td>1,""</td>
          <td>Specifies whether the table cells should have borders or not</td>
        </tr>
        <tr>
          <td>cellpadding</td>
          <td>pixels</td>
          <td>Not supported in HTML5\. Specifies the space between the cell wall and the cell content</td>
        </tr>
        <tr>
          <td>cellspacing</td>
          <td>pixels</td>
          <td>Not supported in HTML5\. Specifies the space between cells</td>
        </tr>
        <tr>
          <td>frame</td>
          <td>void, above, below, hsides, lhs, rhs, vsides, box, border</td>
          <td>Not supported in HTML5\. Specifies which parts of the outside borders that should be visible</td>
        </tr>
        <tr>
          <td>rules</td>
          <td>none, groups, rows, cols, all</td>
          <td>Not supported in HTML5\. Specifies which parts of the inside borders that should be visible</td>
        </tr>
        <tr>
          <td>summary</td>
          <td>text</td>
          <td>Not supported in HTML5\. Specifies a summary of the content of a table</td>
        </tr>
        <tr>
          <td>width</td>
          <td>pixels, %</td>
          <td>Not supported in HTML5\. Specifies the width of a table</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
```

# 但是怎么办？！

简单地说，您有一个表格标题，您可以通过将其设为 0px 高来在视觉上隐藏它，其中还包含用作固定标题的 div。表格的容器在顶部留有足够的空间以允许绝对定位的标题，并且带有滚动条的表格会按照您的预期显示。

上面的代码使用定位类来绝对定位表格（我在弹出式对话框中使用它），但您也可以通过`positioned`从容器中删除类来在文档流中使用它。

# 但 ...

这并不完美。Firefox 拒绝将标题行设置为 0px（至少我没有找到任何方法），但顽固地将其保持在至少 4px ...这不是一个大问题，但根据您的样式，它会弄乱您的边框等。

该表还使用了一种假列方法，其中容器本身的背景颜色用作标题 div 的背景，它们是透明的。

# 概括

总而言之，根据您的要求，可能存在样式问题，尤其是边框或复杂背景。可计算性也可能存在问题，我还没有在各种浏览器中检查过（如果你尝试过，请评论你的经验），但我没有找到类似的东西，所以我认为值得发布反正 ...

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2012-08-21T21:50:12.990

这是一个用于固定表头的 jQuery 插件。它允许整个页面滚动，当标题到达顶部时冻结标题。它适用于 Twitter [Bootstrap](https://en.wikipedia.org/wiki/Bootstrap_%28front-end_framework%29)表。

GitHub 存储库：[https ://github.com/oma/table-fixed-header](https://github.com/oma/table-fixed-header)

它*不仅仅*滚动表格内容。寻找其他工具，作为其他答案之一。你决定什么最适合你的情况。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2018-10-04T01:37:11.530

CSS 属性`position: sticky`在大多数现代浏览器中都有很好的支持（我遇到了 Edge 的问题，见下文）。

这让我们很容易解决固定标题的问题：

```
thead th { position: sticky; top: 0; } 
```

Safari 需要一个供应商前缀：`-webkit-sticky`.

对于 Firefox，我必须添加`min-height: 0`一个父元素。我完全忘记了为什么需要这样做。

最不幸的是，Microsoft Edge 的实现似乎只是半工作。至少，我的测试中有一些闪烁和未对齐的表格单元格。这张桌子仍然可以使用，但存在严重的美学问题。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2012-11-27T18:37:58.620

此处发布的大多数解决方案都需要 jQuery。如果您正在寻找独立于框架的解决方案，请尝试使用 Grid： http: [//www.matts411.com/post/grid/](http://www.matts411.com/post/grid/)

它托管在 Github 上：[https ://github.com/mmurph211/Grid](https://github.com/mmurph211/Grid)

它不仅支持固定页眉，还支持固定左栏和页脚等。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2014-09-12T23:41:48.250

## 更精致的纯CSS滚动表

到目前为止，我看到的所有纯 CSS 解决方案——尽管它们可能很聪明——都缺乏一定程度的润色，或者在某些情况下无法正常工作。所以，我决定创建自己的...

特征：

*   它是纯 CSS，因此不需要 jQuery（或任何 JavaScript 代码，就此而言）
*   您可以将表格宽度设置为百分比（又名“流体”）或固定值，或者让内容确定其宽度（又名“自动”）
*   列宽也可以是流动的、固定的或自动的。
*   由于水平滚动，列永远不会与标题不对齐（我见过的所有其他基于 CSS 的解决方案中都会出现这个问题，不需要固定宽度）。
*   与所有流行的桌面浏览器兼容，包括 Internet Explorer 回到第 8 版
*   干净、抛光的外观；没有看起来邋遢的 1 像素间隙或未对齐的边框；在所有浏览器中看起来都一样

这里有几个显示流体和自动宽度选项的小提琴：

*   **Fluid Width and Height**（适应屏幕大小）：**[jsFiddle](http://jsfiddle.net/doctorDestructo/kn4xprgx/)**（注意滚动条只在此配置中需要时才会显示，因此您可能需要缩小框架才能看到它）

*   **自动宽度，固定高度**（更容易与其他内容集成）：**[jsFiddle](http://jsfiddle.net/doctorDestructo/x54uraaq/)**

Auto Width, Fixed Height 配置可能有更多的用例，所以我将在下面发布代码。

```
/* The following 'html' and 'body' rule sets are required only
   if using a % width or height*/

/*html {
  width: 100%;
  height: 100%;
}*/

body {
  box-sizing: border-box;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0 20px 0 20px;
  text-align: center;
}
.scrollingtable {
  box-sizing: border-box;
  display: inline-block;
  vertical-align: middle;
  overflow: hidden;
  width: auto; /* If you want a fixed width, set it here, else set to auto */
  min-width: 0/*100%*/; /* If you want a % width, set it here, else set to 0 */
  height: 188px/*100%*/; /* Set table height here; can be fixed value or % */
  min-height: 0/*104px*/; /* If using % height, make this large enough to fit scrollbar arrows + caption + thead */
  font-family: Verdana, Tahoma, sans-serif;
  font-size: 16px;
  line-height: 20px;
  padding: 20px 0 20px 0; /* Need enough padding to make room for caption */
  text-align: left;
  color: black;
}
.scrollingtable * {box-sizing: border-box;}
.scrollingtable > div {
  position: relative;
  border-top: 1px solid black;
  height: 100%;
  padding-top: 20px; /* This determines column header height */
}
.scrollingtable > div:before {
  top: 0;
  background: cornflowerblue; /* Header row background color */
}
.scrollingtable > div:before,
.scrollingtable > div > div:after {
  content: "";
  position: absolute;
  z-index: -1;
  width: 100%;
  height: 100%;
  left: 0;
}
.scrollingtable > div > div {
  min-height: 0/*43px*/; /* If using % height, make this large
                            enough to fit scrollbar arrows */
  max-height: 100%;
  overflow: scroll/*auto*/; /* Set to auto if using fixed
                               or % width; else scroll */
  overflow-x: hidden;
  border: 1px solid black; /* Border around table body */
}
.scrollingtable > div > div:after {background: white;} /* Match page background color */
.scrollingtable > div > div > table {
  width: 100%;
  border-spacing: 0;
  margin-top: -20px; /* Inverse of column header height */
  /*margin-right: 17px;*/ /* Uncomment if using % width */
}
.scrollingtable > div > div > table > caption {
  position: absolute;
  top: -20px; /*inverse of caption height*/
  margin-top: -1px; /*inverse of border-width*/
  width: 100%;
  font-weight: bold;
  text-align: center;
}
.scrollingtable > div > div > table > * > tr > * {padding: 0;}
.scrollingtable > div > div > table > thead {
  vertical-align: bottom;
  white-space: nowrap;
  text-align: center;
}
.scrollingtable > div > div > table > thead > tr > * > div {
  display: inline-block;
  padding: 0 6px 0 6px; /*header cell padding*/
}
.scrollingtable > div > div > table > thead > tr > :first-child:before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  height: 20px; /*match column header height*/
  border-left: 1px solid black; /*leftmost header border*/
}
.scrollingtable > div > div > table > thead > tr > * > div[label]:before,
.scrollingtable > div > div > table > thead > tr > * > div > div:first-child,
.scrollingtable > div > div > table > thead > tr > * + :before {
  position: absolute;
  top: 0;
  white-space: pre-wrap;
  color: white; /*header row font color*/
}
.scrollingtable > div > div > table > thead > tr > * > div[label]:before,
.scrollingtable > div > div > table > thead > tr > * > div[label]:after {content: attr(label);}
.scrollingtable > div > div > table > thead > tr > * + :before {
  content: "";
  display: block;
  min-height: 20px; /* Match column header height */
  padding-top: 1px;
  border-left: 1px solid black; /* Borders between header cells */
}
.scrollingtable .scrollbarhead {float: right;}
.scrollingtable .scrollbarhead:before {
  position: absolute;
  width: 100px;
  top: -1px; /* Inverse border-width */
  background: white; /* Match page background color */
}
.scrollingtable > div > div > table > tbody > tr:after {
  content: "";
  display: table-cell;
  position: relative;
  padding: 0;
  border-top: 1px solid black;
  top: -1px; /* Inverse of border width */
}
.scrollingtable > div > div > table > tbody {vertical-align: top;}
.scrollingtable > div > div > table > tbody > tr {background: white;}
.scrollingtable > div > div > table > tbody > tr > * {
  border-bottom: 1px solid black;
  padding: 0 6px 0 6px;
  height: 20px; /* Match column header height */
}
.scrollingtable > div > div > table > tbody:last-of-type > tr:last-child > * {border-bottom: none;}
.scrollingtable > div > div > table > tbody > tr:nth-child(even) {background: gainsboro;} /* Alternate row color */
.scrollingtable > div > div > table > tbody > tr > * + * {border-left: 1px solid black;} /* Borders between body cells */
```

```
<div class="scrollingtable">
  <div>
    <div>
      <table>
        <caption>Top Caption</caption>
        <thead>
          <tr>
            <th><div label="Column 1"/></th>
            <th><div label="Column 2"/></th>
            <th><div label="Column 3"/></th>
            <th>
              <!-- More versatile way of doing column label; requires two identical copies of label -->
              <div><div>Column 4</div><div>Column 4</div></div>
            </th>
            <th class="scrollbarhead"/> <!-- ALWAYS ADD THIS EXTRA CELL AT END OF HEADER ROW -->
          </tr>
        </thead>
        <tbody>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
          <tr><td>Lorem ipsum</td><td>Dolor</td><td>Sit</td><td>Amet consectetur</td></tr>
        </tbody>
      </table>
    </div>
    Faux bottom caption
  </div>
</div>

<!--[if lte IE 9]><style>.scrollingtable > div > div > table {margin-right: 17px;}</style><![endif]-->
```

我用来冻结标题行的方法与 d-Pixie 的类似，所以请参阅他的帖子以获得解释。该技术存在大量错误和限制，只能通过大量额外的 CSS 和一两个额外的 div 容器来修复。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-07-05T15:16:09.127

# 一个简单的 jQuery 插件

这是 Mahes 解决方案的一个变体。你可以这样称呼它`$('table#foo').scrollableTable();`

这个想法是：

*   `thead`将and拆分`tbody`为单独的`table`元素
*   使它们的单元格宽度再次匹配
*   将第二个包裹`table`在一个`div.scrollable`
*   使用 CSS 进行`div.scrollable`实际滚动

CSS 可以是：

```
div.scrollable { height: 300px; overflow-y: scroll;} 
```

### 注意事项

*   显然，拆分这些表会降低标记的语义。我不确定这对可访问性有什么影响。
*   这个插件不处理页脚、多个页眉等。
*   我只在 Chrome 版本 20 中测试过它。

也就是说，它适用于我的目的，您可以自由使用和修改它。

这是插件：

```
jQuery.fn.scrollableTable = function () {
  var $newTable, $oldTable, $scrollableDiv, originalWidths;
  $oldTable = $(this);

  // Once the tables are split, their cell widths may change. 
  // Grab these so we can make the two tables match again.
  originalWidths = $oldTable.find('tr:first td').map(function() {
    return $(this).width();
  });

  $newTable = $oldTable.clone();
  $oldTable.find('tbody').remove();
  $newTable.find('thead').remove();

  $.each([$oldTable, $newTable], function(index, $table) {
    $table.find('tr:first td').each(function(i) {
      $(this).width(originalWidths[i]);
    });
  });

  $scrollableDiv = $('<div/>').addClass('scrollable');
  $newTable.insertAfter($oldTable).wrap($scrollableDiv);
}; 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-07-19T19:40:24.117

:)

不那么干净，但纯粹的 HTML/CSS 解决方案。

```
table {
    overflow-x:scroll;
}

tbody {
    max-height: /*your desired max height*/
    overflow-y:scroll;
    display:block;
} 
```

针对 IE8+ [JSFiddle 示例进行了更新](http://jsfiddle.net/ZdeEH/4/)

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-10-10T09:42:45.063

不知何故，我最终`Position:Sticky`在我的案子上工作得很好：

```
table{
  width: 100%;
  border: collapse;
}

th{
    position: sticky;
    top: 0px;
    border: 1px solid black;
    background: #ff5722;
    color: #f5f5f5;
    font-weight: 600;
}
td{
    background: #d3d3d3;
    border: 1px solid black;
    color: #f5f5f5;
    font-weight: 600;
}

div{
  height: 150px
  overflow: auto;
  width: 100%
}
```

```
<div>
    <table>
        <thead>
            <tr>
                <th>header 1</th>
                <th>header 2</th>
                <th>header 3</th>
                <th>header 4</th>
                <th>header 5</th>
                <th>header 6</th>
                <th>header 7</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
            <tr>
                <td>data 1</td>
                <td>data 2</td>
                <td>data 3</td>
                <td>data 4</td>
                <td>data 5</td>
                <td>data 6</td>
                <td>data 7</td>
            </tr>
        </tbody>
    </table>
</div>
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-09-26T12:53:19.647

## 支持固定页脚

我扩展了 Nathan 的功能以支持固定页脚和最大高度。此外，该函数将自行设置 CSS，您只需要支持宽度即可。

用法：

固定高度：

```
$('table').scrollableTable({ height: 100 }); 
```

最大高度（如果浏览器支持 CSS 'max-height' 选项）：

```
$('table').scrollableTable({ maxHeight: 100 }); 
```

脚本：

```
jQuery.fn.scrollableTable = function(options) {

    var $originalTable, $headTable, $bodyTable, $footTable, $scrollableDiv, originalWidths;

    // Prepare the separate parts of the table
    $originalTable = $(this);
    $headTable = $originalTable.clone();

    $headTable.find('tbody').remove();
    $headTable.find('tfoot').remove();

    $bodyTable = $originalTable.clone();
    $bodyTable.find('thead').remove();
    $bodyTable.find('tfoot').remove();

    $footTable = $originalTable.clone();
    $footTable.find('thead').remove();
    $footTable.find('tbody').remove();

    // Grab the original column widths and set them in the separate tables
    originalWidths = $originalTable.find('tr:first td').map(function() {
        return $(this).width();
    });

    $.each([$headTable, $bodyTable, $footTable], function(index, $table) {
        $table.find('tr:first td').each(function(i) {
            $(this).width(originalWidths[i]);
        });
    });

    // The div that makes the body table scroll
    $scrollableDiv = $('<div/>').css({
        'overflow-y': 'scroll'
    });

    if(options.height) {
        $scrollableDiv.css({'height': options.height});
    }
    else if(options.maxHeight) {
        $scrollableDiv.css({'max-height': options.maxHeight});
    }

    // Add the new separate tables and remove the original one
    $headTable.insertAfter($originalTable);
    $bodyTable.insertAfter($headTable);
    $footTable.insertAfter($bodyTable);
    $bodyTable.wrap($scrollableDiv);
    $originalTable.remove();
}; 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-03-23T12:24:44.360

两个 div，一个用于标题，一个用于数据。使数据 div 可滚动，并使用 JavaScript 将标题中列的宽度设置为与数据中的宽度相同。我认为数据列的宽度需要固定而不是动态的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-06-18T17:50:17.093

我意识到这个问题允许使用 JavaScript，但这是我设计的一个纯 CSS 解决方案，它还允许表格水平扩展。它使用 Internet Explorer 10 以及最新的 Chrome 和 Firefox 浏览器进行了测试。jsFiddle 的链接在底部。

的HTML：

```
Putting some text here to differentiate between the header
aligning with the top of the screen and the header aligning
with the top of one of its ancestor containers.

<div id="positioning-container">
<div id="scroll-container">
    <table>
        <colgroup>
            <col class="col1"></col>
            <col class="col2"></col>
        </colgroup>
        <thead>
            <th class="header-col1"><div>Header 1</div></th>
            <th class="header-col2"><div>Header 2</div></th>
        </thead>
        <tbody>
            <tr><td>Cell 1.1</td><td>Cell 1.2</td></tr>
            <tr><td>Cell 2.1</td><td>Cell 2.2</td></tr>
            <tr><td>Cell 3.1</td><td>Cell 3.2</td></tr>
            <tr><td>Cell 4.1</td><td>Cell 4.2</td></tr>
            <tr><td>Cell 5.1</td><td>Cell 5.2</td></tr>
            <tr><td>Cell 6.1</td><td>Cell 6.2</td></tr>
            <tr><td>Cell 7.1</td><td>Cell 7.2</td></tr>

        </tbody>
    </table>
</div>
</div> 
```

和CSS：

```
table{
    border-collapse: collapse;
    table-layout: fixed;
    width: 100%;
}
/* Not required, just helps with alignment for this example */
td, th{
    padding: 0;
    margin: 0;
}

tbody{
    background-color: #ddf;
}

thead {
    /* Keeps the header in place. Don't forget top: 0 */
    position: absolute;
    top: 0;
    background-color: #ddd;

    /* The 17px is to adjust for the scrollbar width.
     * This is a new css value that makes this pure
     * css example possible */
    width: calc(100% - 17px);
    height: 20px;
}

/* Positioning container. Required to position the
 * header since the header uses position:absolute
 * (otherwise it would position at the top of the screen) */
#positioning-container{
    position: relative;
}

/* A container to set the scroll-bar and
 * includes padding to move the table contents
 * down below the header (padding = header height) */
#scroll-container{
    overflow-y: auto;
    padding-top: 20px;
    height: 100px;
}
.header-col1{
    background-color: red;
}

/* Fixed-width header columns need a div to set their width */
.header-col1 div{
    width: 100px;
}

/* Expandable columns need a width set on the th tag */
.header-col2{
    width: 100%;
}
.col1 {
    width: 100px;
}
.col2{
    width: 100%;
} 
```

[http://jsfiddle.net/HNHRv/3/](http://jsfiddle.net/HNHRv/3/)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-07-21T18:19:09.363

我找到了这个解决方法 - 在表格上方的表格中使用数据移动标题行：

```
<html>
<head>
	<title>Fixed header</title>
	<style>
		table td {width:75px;}
	</style>
</head>

<body>
<div style="height:auto; width:350px; overflow:auto">
<table border="1">
<tr>
	<td>header 1</td>
	<td>header 2</td>
	<td>header 3</td>
</tr>
</table>
</div>

<div style="height:50px; width:350px; overflow:auto">
<table border="1">
<tr>
	<td>row 1 col 1</td>
	<td>row 1 col 2</td>
	<td>row 1 col 3</td>		
</tr>
<tr>
	<td>row 2 col 1</td>
	<td>row 2 col 2</td>
	<td>row 2 col 3</td>		
</tr>
<tr>
	<td>row 3 col 1</td>
	<td>row 3 col 2</td>
	<td>row 3 col 3</td>		
</tr>
<tr>
	<td>row 4 col 1</td>
	<td>row 4 col 2</td>
	<td>row 4 col 3</td>		
</tr>
<tr>
	<td>row 5 col 1</td>
	<td>row 5 col 2</td>
	<td>row 5 col 3</td>		
</tr>
<tr>
	<td>row 6 col 1</td>
	<td>row 6 col 2</td>
	<td>row 6 col 3</td>		
</tr>
</table>
</div>

</body>
</html>
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-03-19T16:02:50.887

对于那些尝试了 Maximilian Hils 给出的很好的解决方案，但没有成功让它与 Internet Explorer 一起工作的人，我遇到了同样的问题（Internet Explorer 11）并找出了问题所在。

在 Internet Explorer 11 中，样式转换（至少使用 translate）在`<THEAD>`. 我通过将样式应用于`<TH>`循环中的所有内容来解决此问题。那行得通。我的 JavaScript 代码如下所示：

```
document.getElementById('pnlGridWrap').addEventListener("scroll", function () {
  var translate = "translate(0," + this.scrollTop + "px)";
  var myElements = this.querySelectorAll("th");
  for (var i = 0; i < myElements.length; i++) {
    myElements[i].style.transform=translate;
  }
}); 
```

在我的情况下，该表是 ASP.NET 中的 GridView。一开始我以为是因为它没有`<THEAD>`，但即使我强迫它有一个，它也不起作用。然后我发现了我上面写的东西。

这是一个非常好的和简单的解决方案。在 Chrome 上它是完美的，在 Firefox 上有点生涩，在 Internet Explorer 上更生涩。但总的来说是一个很好的解决方案。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2022-02-09T10:44:37.883

派对很晚了，但因为它仍然是派对，这是我使用 tailwindcss 的两分钱：

```
<div class="h-screen overflow-hidden flex flex-col">
  <div class="overflow-y-scroll flex-1">
    <table>
      <thead class="sticky top-0">
        <tr>
          <th>Timestamp</th>
          <th>Species</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>2022-02-09T08:20:39.967Z</td>
          <td>willow</td>
        </tr>
        <tr>
          <td>2022-02-09T08:21:29.453Z</td>
          <td>red osier dogwood</td>
        </tr>
        <tr>
          <td>2022-02-09T08:22:18.984Z</td>
          <td>buttonbush</td>
        </tr>
      </tbody>
    </table>
  </div>
</div> 
```

这是一个关于 tailwind 的[playgroud](https://play.tailwindcss.com/Pzpn90UjgK)的完整示例。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-02-15T08:44:51.997

使用最新版本的 jQuery，并包含以下 JavaScript 代码。

```
$(window).scroll(function(){
  $("id of the div element").offset({top:$(window).scrollTop()});
}); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-08-22T18:25:41.247

这不是固定标题行的精确解决方案，但我创建了一种相当巧妙的方法，在整个长表中重复标题行，但仍保持排序能力。

这个简洁的小选项需要[jQuery`tablesorter`插件](http://tablesorter.com/docs/index.html)。以下是它的工作原理：

**HTML**

```
<table class="tablesorter boxlist" id="pmtable">
    <thead class="fixedheader">
        <tr class="boxheadrow">
            <th width="70px" class="header">Job Number</th>
            <th width="10px" class="header">Pri</th>
            <th width="70px" class="header">CLLI</th>
            <th width="35px" class="header">Market</th>
            <th width="35px" class="header">Job Status</th>
            <th width="65px" class="header">Technology</th>
            <th width="95px;" class="header headerSortDown">MEI</th>
            <th width="95px" class="header">TEO Writer</th>
            <th width="75px" class="header">Quote Due</th>
            <th width="100px" class="header">Engineer</th>
            <th width="75px" class="header">ML Due</th>
            <th width="75px" class="header">ML Complete</th>
            <th width="75px" class="header">SPEC Due</th>
            <th width="75px" class="header">SPEC Complete</th>
            <th width="100px" class="header">Install Supervisor</th>
            <th width="75px" class="header">MasTec OJD</th>
            <th width="75px" class="header">Install Start</th>
            <th width="30px" class="header">Install Hours</th>
            <th width="75px" class="header">Revised CRCD</th>
            <th width="75px" class="header">Latest Ship-To-Site</th>
            <th width="30px" class="header">Total Parts</th>
            <th width="30px" class="header">OEM Rcvd</th>
            <th width="30px" class="header">Minor Rcvd</th>
            <th width="30px" class="header">Total Received</th>
            <th width="30px" class="header">% On Site</th>
            <th width="60px" class="header">Actions</th>
        </tr>
    </thead>
        <tbody class="scrollable">
            <tr data-job_id="3548" data-ml_id="" class="odd">
                <td class="c black">FL-8-RG9UP</td>
                <td data-pri="2" class="priority c yellow">M</td>
                <td class="c">FTLDFLOV</td>
                <td class="c">SFL</td>
                <td class="c">NOI</td>
                <td class="c">TRANSPORT</td>
                <td class="c"></td>
                <td class="c">Chris Byrd</td>
                <td class="c">Apr 13, 2013</td>
                <td class="c">Kris Hall</td>
                <td class="c">May 20, 2013</td>
                <td class="c">May 20, 2013</td>
                <td class="c">Jun 5, 2013</td>
                <td class="c">Jun 7, 2013</td>
                <td class="c">Joseph Fitz</td>
                <td class="c">Jun 10, 2013</td>
                <td class="c">TBD</td>
                <td class="c">123</td>
                <td class="c revised_crcd"><input readonly="true" name="revised_crcd" value="Jul 26, 2013" type="text" size="12" class="smInput r_crcd c hasDatepicker" id="dp1377194058616"></td>
                <td class="c">TBD</td>
                <td class="c">N/A</td>
                <td class="c">N/A</td>
                <td class="c">N/A</td>
                <td class="c">N/A</td>
                <td class="c">N/A</td>
                <td class="actions"><span style="float:left;" class="ui-icon ui-icon-folder-open editJob" title="View this job" s="" details'=""></span></td>
            </tr>
            <tr data-job_id="4264" data-ml_id="2959" class="even">
                <td class="c black">MTS13009SF</td>
                <td data-pri="2" class="priority c yellow">M</td>
                <td class="c">OJUSFLTL</td>
                <td class="c">SFL</td>
                <td class="c">NOI</td>
                <td class="c">TRANSPORT</td>
                <td class="c"></td>
                <td class="c">DeMarcus Stewart</td>
                <td class="c">May 22, 2013</td>
                <td class="c">Ryan Alsobrook</td>
                <td class="c">Jun 19, 2013</td>
                <td class="c">Jun 27, 2013</td>
                <td class="c">Jun 19, 2013</td>
                <td class="c">Jul 4, 2013</td>
                <td class="c">Randy Williams</td>
                <td class="c">Jun 21, 2013</td>
                <td class="c">TBD</td>
                <td class="c">95</td>
                <td class="c revised_crcd"><input readonly="true" name="revised_crcd" value="Aug 9, 2013" type="text" size="12" class="smInput r_crcd c hasDatepicker" id="dp1377194058632"></td><td class="c">TBD</td>
                <td class="c">0</td>
                <td class="c">0.00%</td>
                <td class="c">0.00%</td>
                <td class="c">0.00%</td>
                <td class="c">0.00%</td>
                <td class="actions"><span style="float:left;" class="ui-icon ui-icon-folder-open editJob" title="View this job" s="" details'=""></span><input style="float:left;" type="hidden" name="req_ship" class="reqShip hasDatepicker" id="dp1377194058464"><span style="float:left;" class="ui-icon ui-icon-calendar requestShip" title="Schedule this job for shipping"></span><span class="ui-icon ui-icon-info viewOrderInfo" style="float:left;" title="Show material details for this order"></span></td>
            </tr>
            .
            .
            .
            .
            <tr class="boxheadrow repeated-header">
                <th width="70px" class="header">Job Number</th>
                <th width="10px" class="header">Pri</th>
                <th width="70px" class="header">CLLI</th>
                <th width="35px" class="header">Market</th>
                <th width="35px" class="header">Job Status</th>
                <th width="65px" class="header">Technology</th>
                <th width="95px;" class="header">MEI</th>
                <th width="95px" class="header">TEO Writer</th>
                <th width="75px" class="header">Quote Due</th>
                <th width="100px" class="header">Engineer</th>
                <th width="75px" class="header">ML Due</th>
                <th width="75px" class="header">ML Complete</th>
                <th width="75px" class="header">SPEC Due</th>
                <th width="75px" class="header">SPEC Complete</th>
                <th width="100px" class="header">Install Supervisor</th>
                <th width="75px" class="header">MasTec OJD</th>
                <th width="75px" class="header">Install Start</th>
                <th width="30px" class="header">Install Hours</th>
                <th width="75px" class="header">Revised CRCD</th>
                <th width="75px" class="header">Latest Ship-To-Site</th>
                <th width="30px" class="header">Total Parts</th>
                <th width="30px" class="header">OEM Rcvd</th>
                <th width="30px" class="header">Minor Rcvd</th>
                <th width="30px" class="header">Total Received</th>
                <th width="30px" class="header">% On Site</th>
                <th width="60px" class="header">Actions</th>
            </tr> 
```

显然，我的表的行数比这多得多。准确地说是 193，但您可以看到标题行重复的位置。重复标题行由此函数设置：

**jQuery**

```
// Clone the original header row and add the "repeated-header" class
var tblHeader = $('tr.boxheadrow').clone().addClass('repeated-header');

// Add the cloned header with the new class every 34th row (or as you see fit)
$('tbody tr:odd:nth-of-type(17n)').after(tblHeader);

// On the 'sortStart' routine, remove all the inserted header rows
$('#pmtable').bind('sortStart', function() {
    $('.repeated-header').remove();
    // On the 'sortEnd' routine, add back all the header row lines.
}).bind('sortEnd', function() {
    $('tbody tr:odd:nth-of-type(17n)').after(tblHeader);
}); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-09-24T05:35:43.837

我希望我早点找到@Mark 的解决方案，但是在我看到这个 SO 问题之前，我去写了自己的解决方案......

Mine 是一个非常轻量级的 jQuery 插件，它支持固定页眉、页脚、列跨度 (colspan)、调整大小、水平滚动以及在滚动开始前显示的可选行数。

[jQuery.scrollTableBody (GitHub)](https://github.com/nheldman/jquery.scrollTableBody)

只要您有一张带有正确`<thead>`、`<tbody>`和 (optional)的表格`<tfoot>`，您需要做的就是：

```
$('table').scrollTableBody(); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-12-12T17:07:35.357

我开发了一个简单的轻量级 jQuery 插件，用于将格式良好的 HTML 表格转换为具有固定表格标题和列的可滚动表格。

该插件可以很好地匹配固定部分与可滚动部分的像素到像素定位。此外，您还可以冻结水平滚动时始终在视图中的列数。

演示和文档： http: **[//meetselva.github.io/fixed-table-rows-cols/](http://meetselva.github.io/fixed-table-rows-cols/)**

GitHub 存储库：**[https ://github.com/meetselva/fixed-table-rows-cols](https://github.com/meetselva/fixed-table-rows-cols)**

下面是一个带有固定标题的简单表格的用法，

```
$(<table selector>).fxdHdrCol({
    width:     "100%",
    height:    200,
    colModal: [{width: 30, align: 'center'},
               {width: 70, align: 'center'}, 
               {width: 200, align: 'left'}, 
               {width: 100, align: 'center'}, 
               {width: 70, align: 'center'}, 
               {width: 250, align: 'center'}
              ]
}); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-12-19T17:40:40.047

很多人似乎都在寻找这个答案。我发现它隐藏在另一个问题的答案中：*[Syncing column width of between tables in two different frames, etc](https://stackoverflow.com/questions/3580016/syncing-column-width-of-between-tables-in-two-different-frames-etc)*

在我尝试过的几十种方法中，这是我发现的唯一一种可靠的方法，可以让您拥有一个滚动底部表格，标题表格具有相同的宽度。

这就是我的做法，首先我改进了上面的 jsfiddle 来创建这个函数，它同时适用于`td`和`th`（以防绊倒其他`th`用于设置标题行样式的人）。

```
var setHeaderTableWidth= function (headertableid,basetableid) {
            $("#"+headertableid).width($("#"+basetableid).width());
            $("#"+headertableid+" tr th").each(function (i) {
                $(this).width($($("#"+basetableid+" tr:first td")[i]).width());
            });
            $("#" + headertableid + " tr td").each(function (i) {
                $(this).width($($("#" + basetableid + " tr:first td")[i]).width());
            });
        } 
```

接下来，您需要创建两个表格，注意标题表格应该有一个额外`TD`的表格，以便在顶部表格中为滚动条留出空间，如下所示：

```
 <table id="headertable1" class="input-cells table-striped">
        <thead>
            <tr style="background-color:darkgray;color:white;"><th>header1</th><th>header2</th><th>header3</th><th>header4</th><th>header5</th><th>header6</th><th></th></tr>
        </thead>
     </table>
    <div id="resizeToBottom" style="overflow-y:scroll;overflow-x:hidden;">
        <table id="basetable1" class="input-cells table-striped">
            <tbody >
                <tr>
                    <td>testdata</td>
                    <td>2</td>
                    <td>3</td>
                    <td>4</span></td>
                    <td>55555555555555</td>
                    <td>test</td></tr>
            </tbody>
        </table>
    </div> 
```

然后执行以下操作：

```
 setHeaderTableWidth('headertable1', 'basetable1');
        $(window).resize(function () {
            setHeaderTableWidth('headertable1', 'basetable1');
        }); 
```

这是我在 Stack Overflow 上找到的唯一解决方案，该解决方案适用于已发布的许多类似问题，适用于我的所有情况。

例如，我尝试了不适用于 durandal 的 jQuery stickytables 插件，以及此处的 Google Code 项目[https://code.google.com/p/js-scroll-table-header/issues/detail?id=2](https://code.google.com/p/js-scroll-table-header/issues/detail?id=2)

其他涉及克隆表的解决方案，性能很差，或者很糟糕并且在所有情况下都不起作用。

*不需要这些过于复杂的解决方案。只需像下面的示例那样制作两个表格，然后*像这里描述的那样调用 setHeaderTableWidth 函数，然后*繁荣，你就完成了*。

如果这对您不起作用，您可能正在使用 CSS box-sizing 属性，您需要正确设置它。很容易意外地搞砸你的 CSS 内容。有很多事情可能会出错，所以请注意/小心。*这种方法对我有用*。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-04-07T16:25:48.160

这是我们最终使用的解决方案（为了处理一些边缘情况和旧版本的 Internet Explorer，我们最终还在滚动时淡出标题栏，然后在滚动结束时将其淡入，但在 Firefox 和 WebKit 浏览器中这个解决方案*很有效*。它假设边界崩溃：崩溃。

这个解决方案的关键是，一旦你应用了**border-collapse**，**CSS 转换**就会在标题上起作用，所以它只是拦截滚动事件并正确设置转换的问题。你不需要复制任何东西。如果没有在浏览器中正确实现这种行为，很难想象一个更轻量级的解决方案。

JSFiddle：http: [//jsfiddle.net/podperson/tH9VU/2/](http://jsfiddle.net/podperson/tH9VU/2/)

它被实现为一个简单的 jQuery 插件。您只需使用 $('thead').sticky() 之类的调用使您的thead 保持粘性，它们就会挂起。它适用于页面上的多个表和大表中间的头部部分。

```
$.fn.sticky = function(){
    $(this).each( function(){
        var thead = $(this),
            tbody = thead.next('tbody');

        updateHeaderPosition();

        function updateHeaderPosition(){
            if(
                thead.offset().top < $(document).scrollTop()
                && tbody.offset().top + tbody.height() > $(document).scrollTop()
            ){
                var tr = tbody.find('tr').last(),
                    y = tr.offset().top - thead.height() < $(document).scrollTop()
                        ? tr.offset().top - thead.height() - thead.offset().top
                        : $(document).scrollTop() - thead.offset().top;

                thead.find('th').css({
                    'z-index': 100,
                    'transform': 'translateY(' + y + 'px)',
                    '-webkit-transform': 'translateY(' + y + 'px)'
                });
            } else {
                thead.find('th').css({
                    'transform': 'none',
                    '-webkit-transform': 'none'
                });
            }
        }

        // See http://www.quirksmode.org/dom/events/scroll.html
        $(window).on('scroll', updateHeaderPosition);
    });
}

$('thead').sticky(); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-10-05T15:47:23.760

通过将[StickyTableHeaders](https://github.com/jmosbech/StickyTableHeaders) jQuery 插件应用于表格，列标题将在您向下滚动时粘在视口的顶部。

**例子：**

```
$(function () {
    $("table").stickyTableHeaders();
});

/*! Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
	MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */

;
(function ($, window, undefined) {
    'use strict';

    var name = 'stickyTableHeaders',
        id = 0,
        defaults = {
            fixedOffset: 0,
            leftOffset: 0,
            marginTop: 0,
            scrollableArea: window
        };

    function Plugin(el, options) {
        // To avoid scope issues, use 'base' instead of 'this'
        // to reference this class from internal events and functions.
        var base = this;

        // Access to jQuery and DOM versions of element
        base.$el = $(el);
        base.el = el;
        base.id = id++;
        base.$window = $(window);
        base.$document = $(document);

        // Listen for destroyed, call teardown
        base.$el.bind('destroyed',
        $.proxy(base.teardown, base));

        // Cache DOM refs for performance reasons
        base.$clonedHeader = null;
        base.$originalHeader = null;

        // Keep track of state
        base.isSticky = false;
        base.hasBeenSticky = false;
        base.leftOffset = null;
        base.topOffset = null;

        base.init = function () {
            base.$el.each(function () {
                var $this = $(this);

                // remove padding on <table> to fix issue #7
                $this.css('padding', 0);

                base.$originalHeader = $('thead:first', this);
                base.$clonedHeader = base.$originalHeader.clone();
                $this.trigger('clonedHeader.' + name, [base.$clonedHeader]);

                base.$clonedHeader.addClass('tableFloatingHeader');
                base.$clonedHeader.css('display', 'none');

                base.$originalHeader.addClass('tableFloatingHeaderOriginal');

                base.$originalHeader.after(base.$clonedHeader);

                base.$printStyle = $('<style type="text/css" media="print">' +
                    '.tableFloatingHeader{display:none !important;}' +
                    '.tableFloatingHeaderOriginal{position:static !important;}' +
                    '</style>');
                $('head').append(base.$printStyle);
            });

            base.setOptions(options);
            base.updateWidth();
            base.toggleHeaders();
            base.bind();
        };

        base.destroy = function () {
            base.$el.unbind('destroyed', base.teardown);
            base.teardown();
        };

        base.teardown = function () {
            if (base.isSticky) {
                base.$originalHeader.css('position', 'static');
            }
            $.removeData(base.el, 'plugin_' + name);
            base.unbind();

            base.$clonedHeader.remove();
            base.$originalHeader.removeClass('tableFloatingHeaderOriginal');
            base.$originalHeader.css('visibility', 'visible');
            base.$printStyle.remove();

            base.el = null;
            base.$el = null;
        };

        base.bind = function () {
            base.$scrollableArea.on('scroll.' + name, base.toggleHeaders);
            if (!base.isWindowScrolling) {
                base.$window.on('scroll.' + name + base.id, base.setPositionValues);
                base.$window.on('resize.' + name + base.id, base.toggleHeaders);
            }
            base.$scrollableArea.on('resize.' + name, base.toggleHeaders);
            base.$scrollableArea.on('resize.' + name, base.updateWidth);
        };

        base.unbind = function () {
            // unbind window events by specifying handle so we don't remove too much
            base.$scrollableArea.off('.' + name, base.toggleHeaders);
            if (!base.isWindowScrolling) {
                base.$window.off('.' + name + base.id, base.setPositionValues);
                base.$window.off('.' + name + base.id, base.toggleHeaders);
            }
            base.$scrollableArea.off('.' + name, base.updateWidth);
        };

        base.toggleHeaders = function () {
            if (base.$el) {
                base.$el.each(function () {
                    var $this = $(this),
                        newLeft,
                        newTopOffset = base.isWindowScrolling ? (
                        isNaN(base.options.fixedOffset) ? base.options.fixedOffset.outerHeight() : base.options.fixedOffset) : base.$scrollableArea.offset().top + (!isNaN(base.options.fixedOffset) ? base.options.fixedOffset : 0),
                        offset = $this.offset(),

                        scrollTop = base.$scrollableArea.scrollTop() + newTopOffset,
                        scrollLeft = base.$scrollableArea.scrollLeft(),

                        scrolledPastTop = base.isWindowScrolling ? scrollTop > offset.top : newTopOffset > offset.top,
                        notScrolledPastBottom = (base.isWindowScrolling ? scrollTop : 0) < (offset.top + $this.height() - base.$clonedHeader.height() - (base.isWindowScrolling ? 0 : newTopOffset));

                    if (scrolledPastTop && notScrolledPastBottom) {
                        newLeft = offset.left - scrollLeft + base.options.leftOffset;
                        base.$originalHeader.css({
                            'position': 'fixed',
                                'margin-top': base.options.marginTop,
                                'left': newLeft,
                                'z-index': 3 // #18: opacity bug
                        });
                        base.leftOffset = newLeft;
                        base.topOffset = newTopOffset;
                        base.$clonedHeader.css('display', '');
                        if (!base.isSticky) {
                            base.isSticky = true;
                            // make sure the width is correct: the user might have resized the browser while in static mode
                            base.updateWidth();
                        }
                        base.setPositionValues();
                    } else if (base.isSticky) {
                        base.$originalHeader.css('position', 'static');
                        base.$clonedHeader.css('display', 'none');
                        base.isSticky = false;
                        base.resetWidth($('td,th', base.$clonedHeader), $('td,th', base.$originalHeader));
                    }
                });
            }
        };

        base.setPositionValues = function () {
            var winScrollTop = base.$window.scrollTop(),
                winScrollLeft = base.$window.scrollLeft();
            if (!base.isSticky || winScrollTop < 0 || winScrollTop + base.$window.height() > base.$document.height() || winScrollLeft < 0 || winScrollLeft + base.$window.width() > base.$document.width()) {
                return;
            }
            base.$originalHeader.css({
                'top': base.topOffset - (base.isWindowScrolling ? 0 : winScrollTop),
                    'left': base.leftOffset - (base.isWindowScrolling ? 0 : winScrollLeft)
            });
        };

        base.updateWidth = function () {
            if (!base.isSticky) {
                return;
            }
            // Copy cell widths from clone
            if (!base.$originalHeaderCells) {
                base.$originalHeaderCells = $('th,td', base.$originalHeader);
            }
            if (!base.$clonedHeaderCells) {
                base.$clonedHeaderCells = $('th,td', base.$clonedHeader);
            }
            var cellWidths = base.getWidth(base.$clonedHeaderCells);
            base.setWidth(cellWidths, base.$clonedHeaderCells, base.$originalHeaderCells);

            // Copy row width from whole table
            base.$originalHeader.css('width', base.$clonedHeader.width());
        };

        base.getWidth = function ($clonedHeaders) {
            var widths = [];
            $clonedHeaders.each(function (index) {
                var width, $this = $(this);

                if ($this.css('box-sizing') === 'border-box') {
                    width = $this[0].getBoundingClientRect().width; // #39: border-box bug
                } else {
                    var $origTh = $('th', base.$originalHeader);
                    if ($origTh.css('border-collapse') === 'collapse') {
                        if (window.getComputedStyle) {
                            width = parseFloat(window.getComputedStyle(this, null).width);
                        } else {
                            // ie8 only
                            var leftPadding = parseFloat($this.css('padding-left'));
                            var rightPadding = parseFloat($this.css('padding-right'));
                            // Needs more investigation - this is assuming constant border around this cell and it's neighbours.
                            var border = parseFloat($this.css('border-width'));
                            width = $this.outerWidth() - leftPadding - rightPadding - border;
                        }
                    } else {
                        width = $this.width();
                    }
                }

                widths[index] = width;
            });
            return widths;
        };

        base.setWidth = function (widths, $clonedHeaders, $origHeaders) {
            $clonedHeaders.each(function (index) {
                var width = widths[index];
                $origHeaders.eq(index).css({
                    'min-width': width,
                        'max-width': width
                });
            });
        };

        base.resetWidth = function ($clonedHeaders, $origHeaders) {
            $clonedHeaders.each(function (index) {
                var $this = $(this);
                $origHeaders.eq(index).css({
                    'min-width': $this.css('min-width'),
                        'max-width': $this.css('max-width')
                });
            });
        };

        base.setOptions = function (options) {
            base.options = $.extend({}, defaults, options);
            base.$scrollableArea = $(base.options.scrollableArea);
            base.isWindowScrolling = base.$scrollableArea[0] === window;
        };

        base.updateOptions = function (options) {
            base.setOptions(options);
            // scrollableArea might have changed
            base.unbind();
            base.bind();
            base.updateWidth();
            base.toggleHeaders();
        };

        // Run initializer
        base.init();
    }

    // A plugin wrapper around the constructor,
    // preventing against multiple instantiations
    $.fn[name] = function (options) {
        return this.each(function () {
            var instance = $.data(this, 'plugin_' + name);
            if (instance) {
                if (typeof options === 'string') {
                    instance[options].apply(instance);
                } else {
                    instance.updateOptions(options);
                }
            } else if (options !== 'destroy') {
                $.data(this, 'plugin_' + name, new Plugin(this, options));
            }
        });
    };

})(jQuery, window);
```

```
body {
    margin: 0 auto;
    padding: 0 20px;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 11px;
    color: #555;
}
table {
    border: 0;
    padding: 0;
    margin: 0 0 20px 0;
    border-collapse: collapse;
}
th {
    padding: 5px;
    /* NOTE: th padding must be set explicitly in order to support IE */
    text-align: right;
    font-weight:bold;
    line-height: 2em;
    color: #FFF;
    background-color: #555;
}
tbody td {
    padding: 10px;
    line-height: 18px;
    border-top: 1px solid #E0E0E0;
}
tbody tr:nth-child(2n) {
    background-color: #F7F7F7;
}
tbody tr:hover {
    background-color: #EEEEEE;
}
td {
    text-align: right;
}
td:first-child, th:first-child {
    text-align: left;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<div style="width:3000px">some really really wide content goes here</div>
<table>
    <thead>
        <tr>
            <th colspan="9">Companies listed on NASDAQ OMX Copenhagen.</th>
        </tr>
        <tr>
            <th>Full name</th>
            <th>CCY</th>
            <th>Last</th>
            <th>+/-</th>
            <th>%</th>
            <th>Bid</th>
            <th>Ask</th>
            <th>Volume</th>
            <th>Turnover</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>A.P. Møller...</td>
            <td>DKK</td>
            <td>33,220.00</td>
            <td>760</td>
            <td>2.34</td>
            <td>33,140.00</td>
            <td>33,220.00</td>
            <td>594</td>
            <td>19,791,910</td>
        </tr>
        <tr>
            <td>A.P. Møller...</td>
            <td>DKK</td>
            <td>34,620.00</td>
            <td>640</td>
            <td>1.88</td>
            <td>34,620.00</td>
            <td>34,700.00</td>
            <td>9,954</td>
            <td>346,530,246</td>
        </tr>
        <tr>
            <td>Carlsberg A</td>
            <td>DKK</td>
            <td>380</td>
            <td>0</td>
            <td>0</td>
            <td>371</td>
            <td>391.5</td>
            <td>6</td>
            <td>2,280</td>
        </tr>
        <tr>
            <td>Carlsberg B</td>
            <td>DKK</td>
            <td>364.4</td>
            <td>8.6</td>
            <td>2.42</td>
            <td>363</td>
            <td>364.4</td>
            <td>636,267</td>
            <td>228,530,601</td>
        </tr>
        <tr>
            <td>Chr. Hansen...</td>
            <td>DKK</td>
            <td>114.5</td>
            <td>-1.6</td>
            <td>-1.38</td>
            <td>114.2</td>
            <td>114.5</td>
            <td>141,822</td>
            <td>16,311,454</td>
        </tr>
        <tr>
            <td>Coloplast B</td>
            <td>DKK</td>
            <td>809.5</td>
            <td>11</td>
            <td>1.38</td>
            <td>809</td>
            <td>809.5</td>
            <td>85,840</td>
            <td>69,363,301</td>
        </tr>
        <tr>
            <td>D/S Norden</td>
            <td>DKK</td>
            <td>155</td>
            <td>-1.5</td>
            <td>-0.96</td>
            <td>155</td>
            <td>155.1</td>
            <td>51,681</td>
            <td>8,037,225</td>
        </tr>
        <tr>
            <td>Danske Bank</td>
            <td>DKK</td>
            <td>69.05</td>
            <td>2.55</td>
            <td>3.83</td>
            <td>69.05</td>
            <td>69.2</td>
            <td>1,723,719</td>
            <td>115,348,068</td>
        </tr>
        <tr>
            <td>DSV</td>
            <td>DKK</td>
            <td>105.4</td>
            <td>0.2</td>
            <td>0.19</td>
            <td>105.2</td>
            <td>105.4</td>
            <td>674,873</td>
            <td>71,575,035</td>
        </tr>
        <tr>
            <td>FLSmidth &amp; Co.</td>
            <td>DKK</td>
            <td>295.8</td>
            <td>-1.8</td>
            <td>-0.6</td>
            <td>295.1</td>
            <td>295.8</td>
            <td>341,263</td>
            <td>100,301,032</td>
        </tr>
        <tr>
            <td>G4S plc</td>
            <td>DKK</td>
            <td>22.53</td>
            <td>0.05</td>
            <td>0.22</td>
            <td>22.53</td>
            <td>22.57</td>
            <td>190,920</td>
            <td>4,338,150</td>
        </tr>
        <tr>
            <td>Jyske Bank</td>
            <td>DKK</td>
            <td>144.2</td>
            <td>1.4</td>
            <td>0.98</td>
            <td>142.8</td>
            <td>144.2</td>
            <td>78,163</td>
            <td>11,104,874</td>
        </tr>
        <tr>
            <td>Københavns ...</td>
            <td>DKK</td>
            <td>1,580.00</td>
            <td>-12</td>
            <td>-0.75</td>
            <td>1,590.00</td>
            <td>1,620.00</td>
            <td>82</td>
            <td>131,110</td>
        </tr>
        <tr>
            <td>Lundbeck</td>
            <td>DKK</td>
            <td>103.4</td>
            <td>-2.5</td>
            <td>-2.36</td>
            <td>103.4</td>
            <td>103.8</td>
            <td>157,162</td>
            <td>16,462,282</td>
        </tr>
        <tr>
            <td>Nordea Bank</td>
            <td>DKK</td>
            <td>43.22</td>
            <td>-0.06</td>
            <td>-0.14</td>
            <td>43.22</td>
            <td>43.25</td>
            <td>167,520</td>
            <td>7,310,143</td>
        </tr>
        <tr>
            <td>Novo Nordisk B</td>
            <td>DKK</td>
            <td>552.5</td>
            <td>-3.5</td>
            <td>-0.63</td>
            <td>550.5</td>
            <td>552.5</td>
            <td>843,533</td>
            <td>463,962,375</td>
        </tr>
        <tr>
            <td>Novozymes B</td>
            <td>DKK</td>
            <td>805.5</td>
            <td>5.5</td>
            <td>0.69</td>
            <td>805</td>
            <td>805.5</td>
            <td>152,188</td>
            <td>121,746,199</td>
        </tr>
        <tr>
            <td>Pandora</td>
            <td>DKK</td>
            <td>39.04</td>
            <td>0.94</td>
            <td>2.47</td>
            <td>38.8</td>
            <td>39.04</td>
            <td>350,965</td>
            <td>13,611,838</td>
        </tr>
        <tr>
            <td>Rockwool In...</td>
            <td>DKK</td>
            <td>492</td>
            <td>0</td>
            <td>0</td>
            <td>482</td>
            <td>492</td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>Rockwool In...</td>
            <td>DKK</td>
            <td>468</td>
            <td>12</td>
            <td>2.63</td>
            <td>465.2</td>
            <td>468</td>
            <td>9,885</td>
            <td>4,623,850</td>
        </tr>
        <tr>
            <td>Sydbank</td>
            <td>DKK</td>
            <td>95</td>
            <td>0.05</td>
            <td>0.05</td>
            <td>94.7</td>
            <td>95</td>
            <td>103,438</td>
            <td>9,802,899</td>
        </tr>
        <tr>
            <td>TDC</td>
            <td>DKK</td>
            <td>43.6</td>
            <td>0.13</td>
            <td>0.3</td>
            <td>43.5</td>
            <td>43.6</td>
            <td>845,110</td>
            <td>36,785,339</td>
        </tr>
        <tr>
            <td>Topdanmark</td>
            <td>DKK</td>
            <td>854</td>
            <td>13.5</td>
            <td>1.61</td>
            <td>854</td>
            <td>855</td>
            <td>38,679</td>
            <td>32,737,678</td>
        </tr>
        <tr>
            <td>Tryg</td>
            <td>DKK</td>
            <td>290.4</td>
            <td>0.3</td>
            <td>0.1</td>
            <td>290</td>
            <td>290.4</td>
            <td>94,587</td>
            <td>27,537,247</td>
        </tr>
        <tr>
            <td>Vestas Wind...</td>
            <td>DKK</td>
            <td>90.15</td>
            <td>-4.2</td>
            <td>-4.45</td>
            <td>90.1</td>
            <td>90.15</td>
            <td>1,317,313</td>
            <td>121,064,314</td>
        </tr>
        <tr>
            <td>William Dem...</td>
            <td>DKK</td>
            <td>417.6</td>
            <td>0.1</td>
            <td>0.02</td>
            <td>417</td>
            <td>417.6</td>
            <td>64,242</td>
            <td>26,859,554</td>
        </tr>
    </tbody>
</table>
<div style="height: 4000px">lots of content down here...</div>
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-09-29T15:18:07.907

这是对[Maximilian Hils](https://stackoverflow.com/users/934719/maximilian-hils)发布的答案的改进答案。

这个在 Internet Explorer 11 中工作，没有任何闪烁：

```
var headerCells = tableWrap.querySelectorAll("thead td");
for (var i = 0; i < headerCells.length; i++) {
    var headerCell = headerCells[i];
    headerCell.style.backgroundColor = "silver";
}
var lastSTop = tableWrap.scrollTop;
tableWrap.addEventListener("scroll", function () {
    var stop = this.scrollTop;
    if (stop < lastSTop) {
        // Resetting the transform for the scrolling up to hide the headers
        for (var i = 0; i < headerCells.length; i++) {
            headerCells[i].style.transitionDelay = "0s";
            headerCells[i].style.transform = "";
        }
    }
    lastSTop = stop;
    var translate = "translate(0," + stop + "px)";
    for (var i = 0; i < headerCells.length; i++) {
        headerCells[i].style.transitionDelay = "0.25s";
        headerCells[i].style.transform = translate;
    }
}); 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2017-11-03T17:25:10.083

我喜欢[马克西米利安希尔斯的](https://stackoverflow.com/a/25902860/150342)回答，但我有一些问题：

1.  除非您将其应用于 th，否则转换在 Edge 或 IE 中不起作用
2.  在 Edge 和 IE 中滚动时标题闪烁
3.  我的表是使用 ajax 加载的，所以我想附加到窗口滚动事件而不是包装器的滚动事件

为了摆脱闪烁，我使用超时等待用户完成滚动，然后应用转换 - 因此在滚动期间标题不可见。

我还使用 jQuery 编写了这个，其中一个优点是 jQuery 应该为您处理供应商前缀

```
 var isScrolling, lastTop, lastLeft, isLeftHidden, isTopHidden;

    //Scroll events don't bubble https://stackoverflow.com/a/19375645/150342
    //so can't use $(document).on("scroll", ".table-container-fixed", function (e) {
    document.addEventListener('scroll', function (event) {
        var $container = $(event.target);
        if (!$container.hasClass("table-container-fixed"))
            return;    

        //transform needs to be applied to th for Edge and IE
        //in this example I am also fixing the leftmost column
        var $topLeftCell = $container.find('table:first > thead > tr > th:first');
        var $headerCells = $topLeftCell.siblings();
        var $columnCells = $container
           .find('table:first > tbody > tr > td:first-child, ' +
                 'table:first > tfoot > tr > td:first-child');

        //hide the cells while returning otherwise they show on top of the data
        if (!isLeftHidden) {
            var currentLeft = $container.scrollLeft();
            if (currentLeft < lastLeft) {
                //scrolling left
                isLeftHidden = true;
                $topLeftCell.css('visibility', 'hidden');
                $columnCells.css('visibility', 'hidden');
            }
            lastLeft = currentLeft;
        }

        if (!isTopHidden) {
            var currentTop = $container.scrollTop();
            if (currentTop < lastTop) {
                //scrolling up
                isTopHidden = true;
                $topLeftCell.css('visibility', 'hidden');
                $headerCells.css('visibility', 'hidden');
            }
            lastTop = currentTop;
        }

        // Using timeout to delay transform until user stops scrolling
        // Clear timeout while scrolling
        window.clearTimeout(isScrolling);

        // Set a timeout to run after scrolling ends
        isScrolling = setTimeout(function () {
            //move the table cells. 
            var x = $container.scrollLeft();
            var y = $container.scrollTop();

            $topLeftCell.css('transform', 'translate(' + x + 'px, ' + y + 'px)');
            $headerCells.css('transform', 'translateY(' + y + 'px)');
            $columnCells.css('transform', 'translateX(' + x + 'px)');

            isTopHidden = isLeftHidden = false;
            $topLeftCell.css('visibility', 'inherit');
            $headerCells.css('visibility', 'inherit');
            $columnCells.css('visibility', 'inherit');
        }, 100);

    }, true); 
```

该表被包装在一个带有 class 的 div 中`table-container-fixed`。

```
.table-container-fixed{
    overflow: auto;
    height: 400px;
} 
```

我将边框折叠设置为分离，否则我们会在翻译过程中丢失边框，并且我删除了表格上的边框以阻止内容出现在滚动期间边框所在的单元格上方。

```
.table-container-fixed > table {
   border-collapse: separate;
   border:none;
} 
```

我将`th`背景设为白色以覆盖下面的单元格，并添加一个与表格边框相匹配的边框 - 使用 Bootstrap 设置样式并滚动到视图之外。

```
 .table-container-fixed > table > thead > tr > th {
        border-top: 1px solid #ddd !important;
        background-color: white;        
        z-index: 10;
        position: relative;/*to make z-index work*/
    }

            .table-container-fixed > table > thead > tr > th:first-child {
                z-index: 20;
            }

.table-container-fixed > table > tbody > tr > td:first-child,
.table-container-fixed > table > tfoot > tr > td:first-child {
    background-color: white;        
    z-index: 10;
    position: relative;
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2018-11-28T09:06:08.433

```
<html>
<head>
    <script src="//cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
    <script>
        function stickyTableHead (tableID) {
            var $tmain = $(tableID);
            var $tScroll = $tmain.children("thead")
                .clone()
                .wrapAll('<table id="tScroll" />')
                .parent()
                .addClass($(tableID).attr("class"))
                .css("position", "fixed")
                .css("top", "0")
                .css("display", "none")
                .prependTo("#tMain");

            var pos = $tmain.offset().top + $tmain.find(">thead").height();

            $(document).scroll(function () {
                var dataScroll = $tScroll.data("scroll");
                dataScroll = dataScroll || false;
                if ($(this).scrollTop() >= pos) {
                    if (!dataScroll) {
                        $tScroll
                            .data("scroll", true)
                            .show()
                            .find("th").each(function () {
                                $(this).width($tmain.find(">thead>tr>th").eq($(this).index()).width());
                            });
                    }
                } else {
                    if (dataScroll) {
                        $tScroll
                            .data("scroll", false)
                            .hide()
                        ;
                    }
                }
            });
        }

        $(document).ready(function () {
            stickyTableHead('#tMain');
        });
    </script>
</head>

<body>
    gfgfdgsfgfdgfds<br/>
    gfgfdgsfgfdgfds<br/>
    gfgfdgsfgfdgfds<br/>
    gfgfdgsfgfdgfds<br/>
    gfgfdgsfgfdgfds<br/>
    gfgfdgsfgfdgfds<br/>

    <table id="tMain" >
        <thead>
        <tr>
            <th>1</th> <th>2</th><th>3</th> <th>4</th><th>5</th> <th>6</th><th>7</th> <th>8</th>

        </tr>
        </thead>
        <tbody>
            <tr><td>11111111111111111111111111111111111111111111111111111111</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
            <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5555555</td><td>66666666666</td><td>77777777777</td><td>8888888888888888</td></tr>
        </tbody>
    </table>
</body>
</html> 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-03-30T04:53:25.377

除了@Daniel Waltrip 的回答。表需要用 div 括起来`position: relative`才能使用`position:sticky`. 所以我想在这里发布我的示例代码。

**CSS**

```
/* Set table width/height as you want.*/
div.freeze-header {
  position: relative;
  max-height: 150px;
  max-width: 400px;
  overflow:auto;
}

/* Use position:sticky to freeze header on top*/
div.freeze-header > table > thead > tr > th {
  position: sticky;
  top: 0;
  background-color:yellow;
}

/* below is just table style decoration.*/
div.freeze-header > table {
  border-collapse: collapse;
}

div.freeze-header > table td {
  border: 1px solid black;
} 
```

**HTML**

```
<html>
<body>
  <div>
   other contents ...
  </div>
  <div>
   other contents ...
  </div>
  <div>
   other contents ...
  </div>

  <div class="freeze-header">
    <table>
       <thead>
         <tr>
           <th> header 1 </th>
           <th> header 2 </th>
           <th> header 3 </th>
           <th> header 4 </th>
           <th> header 5 </th>
           <th> header 6 </th>
           <th> header 7 </th>
           <th> header 8 </th>
           <th> header 9 </th>
           <th> header 10 </th>
           <th> header 11 </th>
           <th> header 12 </th>
           <th> header 13 </th>
           <th> header 14 </th>
           <th> header 15 </th>
          </tr>
       </thead>
       <tbody>
         <tr>
           <td> data 1 </td>
           <td> data 2 </td>
           <td> data 3 </td>
           <td> data 4 </td>
           <td> data 5 </td>
           <td> data 6 </td>
           <td> data 7 </td>
           <td> data 8 </td>
           <td> data 9 </td>
           <td> data 10 </td>
           <td> data 11 </td>
           <td> data 12 </td>
           <td> data 13 </td>
           <td> data 14 </td>
           <td> data 15 </td>
          </tr>         
         <tr>
           <td> data 1 </td>
           <td> data 2 </td>
           <td> data 3 </td>
           <td> data 4 </td>
           <td> data 5 </td>
           <td> data 6 </td>
           <td> data 7 </td>
           <td> data 8 </td>
           <td> data 9 </td>
           <td> data 10 </td>
           <td> data 11 </td>
           <td> data 12 </td>
           <td> data 13 </td>
           <td> data 14 </td>
           <td> data 15 </td>
          </tr>         
         <tr>
           <td> data 1 </td>
           <td> data 2 </td>
           <td> data 3 </td>
           <td> data 4 </td>
           <td> data 5 </td>
           <td> data 6 </td>
           <td> data 7 </td>
           <td> data 8 </td>
           <td> data 9 </td>
           <td> data 10 </td>
           <td> data 11 </td>
           <td> data 12 </td>
           <td> data 13 </td>
           <td> data 14 </td>
           <td> data 15 </td>
          </tr>         
         <tr>
           <td> data 1 </td>
           <td> data 2 </td>
           <td> data 3 </td>
           <td> data 4 </td>
           <td> data 5 </td>
           <td> data 6 </td>
           <td> data 7 </td>
           <td> data 8 </td>
           <td> data 9 </td>
           <td> data 10 </td>
           <td> data 11 </td>
           <td> data 12 </td>
           <td> data 13 </td>
           <td> data 14 </td>
           <td> data 15 </td>
          </tr>         
         <tr>
           <td> data 1 </td>
           <td> data 2 </td>
           <td> data 3 </td>
           <td> data 4 </td>
           <td> data 5 </td>
           <td> data 6 </td>
           <td> data 7 </td>
           <td> data 8 </td>
           <td> data 9 </td>
           <td> data 10 </td>
           <td> data 11 </td>
           <td> data 12 </td>
           <td> data 13 </td>
           <td> data 14 </td>
           <td> data 15 </td>
          </tr>         
         <tr>
           <td> data 1 </td>
           <td> data 2 </td>
           <td> data 3 </td>
           <td> data 4 </td>
           <td> data 5 </td>
           <td> data 6 </td>
           <td> data 7 </td>
           <td> data 8 </td>
           <td> data 9 </td>
           <td> data 10 </td>
           <td> data 11 </td>
           <td> data 12 </td>
           <td> data 13 </td>
           <td> data 14 </td>
           <td> data 15 </td>
          </tr>         
         <tr>
           <td> data 1 </td>
           <td> data 2 </td>
           <td> data 3 </td>
           <td> data 4 </td>
           <td> data 5 </td>
           <td> data 6 </td>
           <td> data 7 </td>
           <td> data 8 </td>
           <td> data 9 </td>
           <td> data 10 </td>
           <td> data 11 </td>
           <td> data 12 </td>
           <td> data 13 </td>
           <td> data 14 </td>
           <td> data 15 </td>
          </tr>         
         <tr>
           <td> data 1 </td>
           <td> data 2 </td>
           <td> data 3 </td>
           <td> data 4 </td>
           <td> data 5 </td>
           <td> data 6 </td>
           <td> data 7 </td>
           <td> data 8 </td>
           <td> data 9 </td>
           <td> data 10 </td>
           <td> data 11 </td>
           <td> data 12 </td>
           <td> data 13 </td>
           <td> data 14 </td>
           <td> data 15 </td>
          </tr>         
       </tbody>
    </table>
  </div>
</body>
</html> 
```

**演示**

[![在此处输入图像描述](https://i.stack.imgur.com/A57IW.gif)](https://i.stack.imgur.com/A57IW.gif)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2022-02-09T11:01:41.077

几乎所有现代浏览器都会支持它！

```
// '.tbl-content' consumed little space for vertical scrollbar, scrollbar width depend on browser/os/platfrom. Here calculate the scollbar width .
$(window).on("load resize ", function() {
  var scrollWidth = $('.tbl-content').width() - $('.tbl-content table').width();
  $('.tbl-header').css({
    'padding-right': scrollWidth
  });
}).resize();
```

```
h1 {
  font-size: 30px;
  color: #fff;
  text-transform: uppercase;
  font-weight: 300;
  text-align: center;
  margin-bottom: 15px;
}

table {
  width: 100%;
  table-layout: fixed;
}

.tbl-header {
  background-color: rgba(255, 255, 255, 0.3);
}

.tbl-content {
  height: 300px;
  overflow-x: auto;
  margin-top: 0px;
  border: 1px solid rgba(255, 255, 255, 0.3);
}

th {
  padding: 20px 15px;
  text-align: left;
  font-weight: 500;
  font-size: 12px;
  color: #fff;
  text-transform: uppercase;
}

td {
  padding: 15px;
  text-align: left;
  vertical-align: middle;
  font-weight: 300;
  font-size: 12px;
  color: #fff;
  border-bottom: solid 1px rgba(255, 255, 255, 0.1);
}

/* demo styles */

@import url(https://fonts.googleapis.com/css?family=Roboto:400,500,300,700);
body {
  background: -webkit-linear-gradient(left, #25c481, #25b7c4);
  background: linear-gradient(to right, #25c481, #25b7c4);
  font-family: 'Roboto', sans-serif;
}

section {
  margin: 50px;
}

/* follow me template */

.made-with-love {
  margin-top: 40px;
  padding: 10px;
  clear: left;
  text-align: center;
  font-size: 10px;
  font-family: arial;
  color: #fff;
}

.made-with-love i {
  font-style: normal;
  color: #F50057;
  font-size: 14px;
  position: relative;
  top: 2px;
}

.made-with-love a {
  color: #fff;
  text-decoration: none;
}

.made-with-love a:hover {
  text-decoration: underline;
}

/* for custom scrollbar for webkit browser*/

::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
}

::-webkit-scrollbar-thumb {
  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<section>
  <!--for demo wrap-->
  <h1>Fixed Table header</h1>
  <div class="tbl-header">
    <table cellpadding="0" cellspacing="0" border="0">
      <thead>
        <tr>
          <th>Code</th>
          <th>Company</th>
          <th>Price</th>
          <th>Change</th>
          <th>Change %</th>
        </tr>
      </thead>
    </table>
  </div>
  <div class="tbl-content">
    <table cellpadding="0" cellspacing="0" border="0">
      <tbody>
        <tr>
          <td>AAC</td>
          <td>AUSTRALIAN COMPANY </td>
          <td>$1.38</td>
          <td>+2.01</td>
          <td>-0.36%</td>
        </tr>
        <tr>
          <td>AAD</td>
          <td>AUSENCO</td>
          <td>$2.38</td>
          <td>-0.01</td>
          <td>-1.36%</td>
        </tr>
        <tr>
          <td>AAX</td>
          <td>ADELAIDE</td>
          <td>$3.22</td>
          <td>+0.01</td>
          <td>+1.36%</td>
        </tr>
        <tr>
          <td>XXD</td>
          <td>ADITYA BIRLA</td>
          <td>$1.02</td>
          <td>-1.01</td>
          <td>+2.36%</td>
        </tr>
        <tr>
          <td>AAC</td>
          <td>AUSTRALIAN COMPANY </td>
          <td>$1.38</td>
          <td>+2.01</td>
          <td>-0.36%</td>
        </tr>
        <tr>
          <td>AAD</td>
          <td>AUSENCO</td>
          <td>$2.38</td>
          <td>-0.01</td>
          <td>-1.36%</td>
        </tr>
        <tr>
          <td>AAX</td>
          <td>ADELAIDE</td>
          <td>$3.22</td>
          <td>+0.01</td>
          <td>+1.36%</td>
        </tr>
        <tr>
          <td>XXD</td>
          <td>ADITYA BIRLA</td>
          <td>$1.02</td>
          <td>-1.01</td>
          <td>+2.36%</td>
        </tr>
        <tr>
          <td>AAC</td>
          <td>AUSTRALIAN COMPANY </td>
          <td>$1.38</td>
          <td>+2.01</td>
          <td>-0.36%</td>
        </tr>
        <tr>
          <td>AAD</td>
          <td>AUSENCO</td>
          <td>$2.38</td>
          <td>-0.01</td>
          <td>-1.36%</td>
        </tr>
        <tr>
          <td>AAX</td>
          <td>ADELAIDE</td>
          <td>$3.22</td>
          <td>+0.01</td>
          <td>+1.36%</td>
        </tr>
        <tr>
          <td>XXD</td>
          <td>ADITYA BIRLA</td>
          <td>$1.02</td>
          <td>-1.01</td>
          <td>+2.36%</td>
        </tr>
        <tr>
          <td>AAC</td>
          <td>AUSTRALIAN COMPANY </td>
          <td>$1.38</td>
          <td>+2.01</td>
          <td>-0.36%</td>
        </tr>
        <tr>
          <td>AAD</td>
          <td>AUSENCO</td>
          <td>$2.38</td>
          <td>-0.01</td>
          <td>-1.36%</td>
        </tr>
        <tr>
          <td>AAX</td>
          <td>ADELAIDE</td>
          <td>$3.22</td>
          <td>+0.01</td>
          <td>+1.36%</td>
        </tr>
        <tr>
          <td>XXD</td>
          <td>ADITYA BIRLA</td>
          <td>$1.02</td>
          <td>-1.01</td>
          <td>+2.36%</td>
        </tr>
        <tr>
          <td>AAC</td>
          <td>AUSTRALIAN COMPANY </td>
          <td>$1.38</td>
          <td>+2.01</td>
          <td>-0.36%</td>
        </tr>
        <tr>
          <td>AAD</td>
          <td>AUSENCO</td>
          <td>$2.38</td>
          <td>-0.01</td>
          <td>-1.36%</td>
        </tr>
        <tr>
          <td>AAX</td>
          <td>ADELAIDE</td>
          <td>$3.22</td>
          <td>+0.01</td>
          <td>+1.36%</td>
        </tr>
        <tr>
          <td>XXD</td>
          <td>ADITYA BIRLA</td>
          <td>$1.02</td>
          <td>-1.01</td>
          <td>+2.36%</td>
        </tr>
        <tr>
          <td>AAC</td>
          <td>AUSTRALIAN COMPANY </td>
          <td>$1.38</td>
          <td>+2.01</td>
          <td>-0.36%</td>
        </tr>
        <tr>
          <td>AAD</td>
          <td>AUSENCO</td>
          <td>$2.38</td>
          <td>-0.01</td>
          <td>-1.36%</td>
        </tr>
        <tr>
          <td>AAX</td>
          <td>ADELAIDE</td>
          <td>$3.22</td>
          <td>+0.01</td>
          <td>+1.36%</td>
        </tr>
        <tr>
          <td>XXD</td>
          <td>ADITYA BIRLA</td>
          <td>$1.02</td>
          <td>-1.01</td>
          <td>+2.36%</td>
        </tr>
        <tr>
          <td>AAC</td>
          <td>AUSTRALIAN COMPANY </td>
          <td>$1.38</td>
          <td>+2.01</td>
          <td>-0.36%</td>
        </tr>
        <tr>
          <td>AAD</td>
          <td>AUSENCO</td>
          <td>$2.38</td>
          <td>-0.01</td>
          <td>-1.36%</td>
        </tr>
        <tr>
          <td>AAX</td>
          <td>ADELAIDE</td>
          <td>$3.22</td>
          <td>+0.01</td>
          <td>+1.36%</td>
        </tr>
        <tr>
          <td>XXD</td>
          <td>ADITYA BIRLA</td>
          <td>$1.02</td>
          <td>-1.01</td>
          <td>+2.36%</td>
        </tr>
        <tr>
          <td>AAC</td>
          <td>AUSTRALIAN COMPANY </td>
          <td>$1.38</td>
          <td>+2.01</td>
          <td>-0.36%</td>
        </tr>
        <tr>
          <td>AAD</td>
          <td>AUSENCO</td>
          <td>$2.38</td>
          <td>-0.01</td>
          <td>-1.36%</td>
        </tr>
        <tr>
          <td>AAX</td>
          <td>ADELAIDE</td>
          <td>$3.22</td>
          <td>+0.01</td>
          <td>+1.36%</td>
        </tr>
        <tr>
          <td>XXD</td>
          <td>ADITYA BIRLA</td>
          <td>$1.02</td>
          <td>-1.01</td>
          <td>+2.36%</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
```

# java - swt.graphics.ImageLoader.save() 没有刷新？

> ID：673159
> 
> 赞同：1
> 
> 时间：2009-03-23T12:13:25.587
> 
> 标签：java, image, swt, save

我正在使用此类`swt.graphics.ImageLoader`将文件另存为 PNG：

```
ImageLoader loader = new ImageLoader();
loader.data = new ImageData[] { m_imgdat };
loader.save(selected, SWT.IMAGE_PNG); 
```

然而有时我得到的文件是不完整的。最后一行像素是黑色的，某些程序（photoshop）完全拒绝打开它。
有什么我想念的吗？我怎样才能告诉这个类刷新文件并关闭它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T12:23:10.807

原理是正确的，但是您可以尝试像这样保存它[`ImageDialog`](http://kickjava.com/src/org/apache/directory/ldapstudio/valueeditors/image/ImageDialog.java.htm)：

查看它的**[buttonPressed()](http://kickjava.com/src/org/apache/directory/ldapstudio/valueeditors/image/ImageDialog.java.htm#160)**方法：

```
try
{
    ImageData imageData = new ImageData( new ByteArrayInputStream JavaDoc( this.newImageRawData ) );
    if ( imageData.type != this.requiredImageType )
    {
        ImageLoader imageLoader = new ImageLoader();
        imageLoader.data = new ImageData[] { imageData };
        ByteArrayOutputStream JavaDoc baos = new ByteArrayOutputStream JavaDoc();
        imageLoader.save( baos, this.requiredImageType );
        this.newImageRawDataInRequiredFormat = baos.toByteArray();
    }
    else
    {
        this.newImageRawDataInRequiredFormat = this.newImageRawData;
    }
}
catch ( SWTException swte )
{
    this.newImageRawDataInRequiredFormat = null;
} 
```

* * *

注意：当它[保存图像](http://kickjava.com/src/org/apache/directory/ldapstudio/valueeditors/image/ImageDialog.java.htm#274)时，它确实使用以下代码：

```
try
    {
    File JavaDoc file = new File JavaDoc( returnedFileName );
    FileOutputStream JavaDoc out = new FileOutputStream JavaDoc( file );
    out.write( currentImageRawData );
    out.flush();
    out.close();
} 
```

# wpf - 在 WPF 中，为什么 Rectangle.Fill 属性在使用 TemplateBinding 时似乎不起作用？

> ID：673167
> 
> 赞同：1
> 
> 时间：2009-03-23T12:15:42.320
> 
> 标签：wpf, templatebinding

我不明白为什么这个 XAML 代码不起作用。使用 TemplateBinding（见下文）时，**未**设置背景颜色。但是当我使用正常的颜色字符串（即“红色”）时，它可以正常工作。

```
<ControlTemplate x:Key="InstanceButtonTemplate" TargetType="{x:Type Control}">
    <Grid>
        <Rectangle>
            <Rectangle.Fill>
                <SolidColorBrush Color="{TemplateBinding Background}"></SolidColorBrush>
            </Rectangle.Fill>
        </Rectangle>
    </Grid>
</ControlTemplate> 
```

然而，当我以这种方式使用 TemplateBinding 时，它工作得很好......

```
<ControlTemplate x:Key="InstanceButtonTemplate" TargetType="{x:Type Control}">
    <Grid>
        <Rectangle Fill="{TemplateBinding Background}"></Rectangle>
    </Grid>
</ControlTemplate> 
```

有任何想法吗？

***编辑：***澄清一下，我打算将其扩展为使用渐变画笔，这就是为什么我需要能够使用 XAML 而不是纯字符串分配给 Rectangle.Fill 属性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T12:18:13.313

那是因为颜色的类型与背景不同

背景是画笔，颜色是......以及颜色..您可以使用 IValueConverter 将画笔转换为颜色..

高温高压

# python - 在 Python 3 中重命名了哪些 tkinter 模块？

> ID：673174
> 
> 赞同：45
> 
> 时间：2009-03-23T12:20:01.670
> 
> 标签：python, python-3.x, tkinter

我正在尝试创建一个[文件选择器对话框](http://www.java2s.com/Code/Python/GUI-Tk/Fileopendialog.htm)。但是，当我尝试`tkMessageBox`在 Python 3 中导入时，我收到一个错误，声称该模块不存在。

```
import tkMessageBox
# ImportError: No module named 'tkMessageBox' 
```

尝试在 Python 3 中导入其他 Tkinter 模块时出现类似错误。

```
import Tkinter          # No module named 'Tkinter'
import tkColorChooser   # No module named 'tkColorChooser'
import tkFileDialog     # No module named 'tkFileDialog' 
```

如何在 Python 3 中导入 Tkinter 模块？新的模块名称是什么？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-03-23T13:11:44.073

[`Tkinter`Python 2](https://docs.python.org/2/library/tkinter.html)中的包已重命名为[`tkinter`in Python 3](https://docs.python.org/3/library/tkinter.html)以及与之相关的其他模块。

以下是重命名模块的列表：

*   [`Tkinter`](https://docs.python.org/2/library/tkinter.html)→[`tkinter`](https://docs.python.org/3/library/tkinter.html)
*   `tkMessageBox`→`tkinter.messagebox`
*   `tkColorChooser`→`tkinter.colorchooser`
*   `tkFileDialog`→`tkinter.filedialog`
*   `tkCommonDialog`→`tkinter.commondialog`
*   `tkSimpleDialog`→`tkinter.simpledialog`
*   `tkFont`→`tkinter.font`
*   `Tkdnd`→`tkinter.dnd`
*   [`ScrolledText`](https://docs.python.org/2/library/scrolledtext.html)→[`tkinter.scrolledtext`](https://docs.python.org/3/library/tkinter.scrolledtext.html)
*   `Tix`→`tkinter.tix`
*   `ttk`→`tkinter.ttk`

我建议您学习如何使用[`dir`](http://docs.python.org/library/functions.html#dir)命令动态浏览模块。如果您在 Windows 下，请将 Python 配置为使用[readline](http://ipython.scipy.org/moin/PyReadline/Intro)模块以获取自动完成功能，并使列出模块中可用的类变得更加容易。

有关每个模块的说明，请参阅官方 Python 文档。（[`Tkinter`在 Python 2.x](https://docs.python.org/2/library/tkinter.html#tkinter-modules)中，[`tkinter`在 Python 3.x 中](https://docs.python.org/3/library/tkinter.html#tkinter-modules)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-20T17:25:10.143

## **用于 Python 2和 Python 3*的 Tkinter / tkinter 的快速脚本**。 ***

 *我有一个脚本，其中有不同的 Python 2.* Tkinter 导入，所以浏览了 a 但我看到答案都是零散的。这里有一个小摘要，其中包含使用两个 Python 版本的安全脚本。

```
try:  # Python 2.7
    import Tkinter as tk
    import tkColorChooser as color
    import tkCommonDialog as cdialog
    import Tkconstants as const
    import Tkdnd as dnd
    import tkFileDialog as fdialog
    import tkFont as font
    import tkMessageBox as msgbox
    import ScrolledText as stext
    import tkSimpleDialog as sdialog
    import Tix as tix
    import ttk

except ImportError:  # Python 3.* 
    import tkinter as tk
    from tkinter import (
        colorchooser as color,
        commondialog as cdialog,
        constants as const,
        dialog,
        dnd,
        filedialog as fdialog,
        font,
        messagebox as msgbox,
        scrolledtext as stext,
        simpledialog as sdialog,
        tix,
        ttk
    ) 
```

## ModuleNotFoundError 错误列表（运行 Python 3 时。）

```
ModuleNotFoundError: No module named 'Tkinter'
ModuleNotFoundError: No module named 'tkMessageBox'
ModuleNotFoundError: No module named 'ScrolledText'
ModuleNotFoundError: No module named 'tkFileDialog' 
```

# c# - 在c#中开发winform应用程序是否有任何标准的屏幕分辨率

> ID：673187
> 
> 赞同：10
> 
> 时间：2009-03-23T12:24:30.367
> 
> 标签：c#, .net, winforms

我已经开发了一个 1280 X 1024 像素的 winform 应用程序......当使用相同的屏幕分辨率时，它完全显示......但是我将屏幕分辨率更改为 800 X 600 像素，它显示的屏幕带有屏幕外的关闭按钮。如何解决这个问题......基本上使用特定屏幕分辨率构建应用程序是否有任何限制......

提前致谢....

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T12:30:57.557

1 没有默认分辨率。您可以观察您的客户有哪些解决方案，然后取平均值。

如果您为公司开发应用程序，这是给您的提示。只是去那里并获取有关它的信息。如果您只需要为一种分辨率设计应用程序 - 请确保该公司可以将所有计算机设置为该分辨率。99% 无法做到，但有时可以做到，当您的应用程序如此具体和罕见，并且只为这个唯一的应用程序（如上网本）购买计算机时。

2 如何处理不同的分辨率？当今大多数 GUI 应用程序开发工具中的使用`Dock`和属性。`Anchor`

当您使用它时，控件将自然地缩放到屏幕大小，并且您的控件将不再位于应用程序的角落后面。

3 为您选择的分辨率构建应用程序没有任何限制。

但是现在我认为应用程序可以假设 res 是最小的。1024x768。当它像你在 800x600 上描述的那样重叠时，不要费心去实现花哨的逻辑来处理这个。用户会很快发现他需要将 res 更改为更高的 res。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T12:27:20.093

将表单设置为全屏，表单将始终是正确的大小。

```
this.WindowState = FormWindowState.Maximized; 
```

（是我还是很明显 1280x1024 的形式不适合 800x600 屏幕？）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T12:54:30.123

您可以通过询问自己的目标受众是谁来计算出必须设计多少“房地产”。

*   公司内部用户？轻松查出公司默认屏幕尺寸
*   外部公司。再问
*   网络上的乔博客 - 设计为 800x600。如果这还不够，那么 1024x768 是现在最流行的屏幕分辨率

[这是](http://www.w3schools.com/browsers/browsers_display.asp)浏览器的一些显示统计信息，它们基本相同。

这篇[slashdot](http://ask.slashdot.org/article.pl?sid=05/12/23/1634234)帖子有很多信息，尽管那是 2005 年，现在它的分辨率可能更高。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T12:31:05.873

您必须对布局中的每个对象使用锚点。

这意味着在调整窗口大小时布局将遵循该锚边。（缩小窗口可能很难。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T13:08:22.850

我只是想补充一点，现在，我们也应该担心上网本，它通常具有 1024*XXX 的分辨率，其中 XXX 并不总是 768。由于屏幕宽等原因，它可能会更少。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T14:40:59.773

最好的方法可能是重新设计布局以支持调整大小：您可以使用控件的`Anchor`/`Dock`属性（通常与 sub 一起`Panel`）让表单在调整大小时更改布局。也许您还可以考虑使用`TableLayoutPanel`或类似的布局助手。

如果您不想更改布局并且只需要快速修复，则可以`AutoScroll`将表单的属性设置为 True （如果您还没有设置，则可以通过设置`FormBorderStyle`来调整它们的大小）。`Sizable`然后，用户可以使表单更小，并且仍然可以使用滚动条访问所有控件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-01T12:14:51.147

事实上，如果表单不适合屏幕，锚定将无法正常工作。在应用布局逻辑之前它会被缩小，因此控件无论如何都会脱离形式。我正在寻找合适的解决方案。

# regex - (LigHTTPd) RegExp 重写规则

> ID：673191
> 
> 赞同：0
> 
> 时间：2009-03-23T12:26:24.353
> 
> 标签：regex, lighttpd

我正在为我正在编写的几个 PHP 脚本编写一些我自己的规则，即使我对正则表达式几乎没有经验。注意：很少。

基本上，我想将除少数 URL 之外的所有 URL 作为参数传递给 index.php，重写大多数在数​​据库中定义为 slug 的 URL。

即：/admin、/config、/images、/lib 和/template 存在，但我不想被重写。但其他一切，我想作为参数传递给 index.php。

我目前正在这样做：

```
url.rewrite-once = (
    "^/(.*)$" => "/index.php?$1"
) 
```

它与数据库 slug 配合得很好，但它也重定向了上面列出的文件夹。这些包含需要直接访问的文件，但我找不到任何描述如何从匹配中排除字符串的地方。

一旦我知道如何做到这一点，我就可以弄清楚其余的，但是对于正则表达式的新手，我不知道从哪里开始。

任何帮助将不胜感激。

**编辑：** 我已经给了这些机会：

```
"^/(index\.php|admin|config|images|lib|template)" => "$0", 
```

FF 报告这些文件夹的无休止重定向；

```
"^/(?!(admin|config|images|lib|template))(.*)$" => "$0" 
```

不匹配除文件夹之外的所有内容；

```
"^/([^(admin|config|images|lib|template)]*)$" => "/index.php?$1" 
```

同样，不重写任何东西；

```
"^/(.*)$" => "/index.php?$1" 
```

重写所有内容，包括我不想重写的文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T04:10:01.030

我似乎已经通过以下表达式实现了我正在寻找的东西：

```
"^/(?!(index\.php|admin|config|images|lib|template)).*$" => "/index.php?$0" 
```

然后我只是

```
trim( $_SERVER['argv'] ,"/") 
```

在 index.php 中获取蛞蝓。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T12:34:27.940

试试这个：

```
url.rewrite-once = (
    "^/(index\.php|admin|config|images|lib|template)" => "$0",
    "^/(.*)$" => "/index.php?$1"
) 
```

# testing - 我在哪里可以买到 QTP 工具？

> ID：673192
> 
> 赞同：0
> 
> 时间：2009-03-23T12:26:51.733
> 
> 标签：testing

我正在下载 QTP 的试用版，但找不到购买 QTP 工具的链接。

QTP在哪里可以买到？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T12:52:34.917

您只需直接联系供应商即可。我怀疑你只能在网上购买它。

[https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&cp=1-11-127-24^1352_4000_100__](https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&cp=1-11-127-24%5E1352_4000_100__)

查看右上角的“联系 HP”。

# php - ZendRouter 找不到页面：将文件夹名称视为控制器名称

> ID：673196
> 
> 赞同：1
> 
> 时间：2009-03-23T12:28:33.413
> 
> 标签：php, zend-framework, routing

我尝试不从根文件夹运行 ZF Quickstart 应用程序，而是从 webserver 子文件夹运行 ZF Quickstart 应用程序，就像通​​常的 php 应用程序一样，例如 localhost/quickstart。当 localhost/quickstart/guestbook 给出 page not found 错误：

```
> Page not found
> 
> array(3) {   ["controller"]=>  
> string(10) "quickstart"   ["action"]=>
> string(9) "guestbook"   ["module"]=>  
> string(7) "default" } 
```

它将父文件夹名称视为控制器名称。我已将我的问题缩小到这一行：

Zend_Controller_Front::getInstance()->dispatch();

我应该以某种方式配置路由器对象以避免父文件夹混淆吗？我应该使用什么代码？

我的元目的是在同一个网络服务器上运行几个 zend 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T12:31:47.337

您可能需要[设置基本 url](http://framework.zend.com/manual/en/zend.controller.request.html#zend.controller.request.http.baseurl)。

例如：

```
$controller->setControllerDirectory('./application/controllers')
       ->setRouter($router)
       ->setBaseUrl('/quickstart'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T14:41:22.847

你说：

> 我尝试不是从根文件夹，而是从 webserver 子文件夹运行 ZF Quickstart 应用程序，

这不一定与以下内容相同：

> 我的元目的是在同一个网络服务器上运行几个 zend 应用程序。

RoBorg 说的是真的，并且专门回答了您的第一个问题，但是当您真正想要的是能够使用自己的子域设置您的所有项目 URL，以便它们可以在顶级运行，而无需触摸任何配置或路由。碰巧[我最近写了一篇关于这个的博客文章](http://marcus.bointon.com/archives/83-The-web-developers-holy-vhost-trinity.html)......

# c# - 我们可以将一个注册在一个 aspx 中的控件 ID 访问到另一个 ascx 控件中吗？

> ID：673197
> 
> 赞同：1
> 
> 时间：2009-03-23T12:28:34.910
> 
> 标签：c#, asp.net

我们可以将一个注册在一个 aspx 中的控件 ID 访问到另一个 ascx 控件中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T12:36:19.293

您的问题不是很清楚，但我猜您正试图从 .ascx 控件内部访问页面控件，对吗？

如果这是问题，答案是否定的，你不能。或者至少你不应该（正如其他答案所表明的那样，实际上你可以做到）

您不应该这样做，因为 .ascx 控件是可重用的。所以它必须独立于任何页面，它必须具有自身的意义。例如，您能想象一个文本框控件需要在页面中使用某个名称的元素吗？

如果您需要控件来访问页面中的数据，则必须反其道而行之。该页面必须通过公共属性提供数据以进行控制。

希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T12:40:33.743

如果您在 ascx 中并且需要访问父 aspx 页面中的控件，则可以按如下方式执行此操作：

```
Control myControl = this.Page.FindControl("myControl"); 
```

但是，值得调查一下为什么需要这样做 - 通常，子用户控件在父页面内执行操作不是一个好习惯。另一种方法是让 ascx 在给定场景中抛出一个事件，父 Page 将依次订阅该事件（并可能基于该事件执行内部操作）。这将允许页面和用户控件之间的互操作性，同时仍然正确封装每个人的功能。

# java - 在 Spring 中使用 RMI 暴露多个对象

> ID：673198
> 
> 赞同：1
> 
> 时间：2009-03-23T12:28:35.050
> 
> 标签：java, jakarta-ee, spring, rmi

如何使用 Spring 使用 RMI 公开多个对象？

我从[这里](http://static.springframework.org/spring/docs/2.5.x/reference/remoting.html#remoting-rmi-server)写的开始。

如果我想暴露更多对象，我必须声明另一个 RMIServiceExporter 实例吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T13:29:30.443

是的，您需要为您希望公开的每个服务声明一个 RMIServiceExporter 实例。每个 RMIServiceExporter 只能与单个服务实例和服务接口相关联。

# django - 选择字段的“禁用”选项 - Django

> ID：673199
> 
> 赞同：28
> 
> 时间：2009-03-23T12:30:02.053
> 
> 标签：django

我遇到了一个简单的问题：如何在 django 框架中通过 modelForm 和 choiceFied 生成的下拉菜单中有一些“禁用”字段？

目前，我无法弄清楚如何获得这样的输出： -- Root 1 entry --（禁用） -- Elt 1 --（未禁用）- Root 2 entry --（禁用）

你有什么建议吗？

皮埃尔

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-23T21:16:24.173

Django 的表单小部件提供了一种传递应该在`<option>`标签上呈现的属性列表的方法：

```
my_choices = ( ('one', 'One'), ('two', 'Two'))
class MyForm(forms.Form):
    some_field = forms.ChoiceField(choices=my_choices, 
                                   widget=forms.Select(attrs={'disabled':'disabled'})) 
```

不幸的是，这对您不起作用，因为该属性将应用于呈现的每个选项标签。Django 无法自动知道哪些应该启用，哪些应该禁用。

在您的情况下，我建议编写一个自定义小部件。这很容易做到，而且您不需要应用那么多自定义逻辑。这方面的文档在[这里](http://docs.djangoproject.com/en/dev/ref/forms/widgets/#customizing-widget-instances)。简而言之：

*   子类`forms.Select`，这是默认的选择渲染器
*   在您的子类中，实现该`render(self, name, value, attrs)`方法。使用您的自定义逻辑来确定是否`value`符合需要禁用的条件。如果您需要灵感，请查看`render`in的非常简短的实现。`django/forms/widgets.py`

然后，定义您的表单字段以使用您的自定义小部件：

```
class MyForm(forms.Form):
    some_field = forms.ChoiceField(choices=my_choices, 
                                   widget=MyWidget) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-26T15:54:22.357

您可以像这样创建 Bryan 提到的选择。在下面的选项中，Root 1、Root 2 被自动禁用，它们看起来像 Group Options

```
CHOICES = (
  ('-- Root 1--', 
      (
        ('ELT1', 'ELT1'),
        ('ELT2', 'ELT2'),
        ('ELT3', 'ELT3'),
      )
   ),
  ('-- Root 2--', 
      (
        ('ELT3', 'ELT3'),
        ('ELT4', 'ELT4'),
      )
  ),
) 
```

上面的选项会像这样显示。在下图中，无法选择 Root 1 和 Root 2。

![在此处输入图像描述](https://i.stack.imgur.com/7sJqw.png)

希望这能解决您的问题

-维克拉姆

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-07-16T20:05:05.853

```
field_choices = (
        ('','Make choice'),
        (1,'first'),
        (2,'second'),
        (3,'third')
    )

from django.forms import Select

class Select(Select):
    def create_option(self, *args,**kwargs):
        option = super().create_option(*args,**kwargs)
        if not option.get('value'):
            option['attrs']['disabled'] = 'disabled'

        if option.get('value') == 2:
            option['attrs']['disabled'] = 'disabled'

        return option 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-24T08:29:06.007

似乎 django 1.1 将允许“optgroup”：[Django 文档](http://docs.djangoproject.com/en/stable/ref/models/fields/#choices)

```
class MyForm(forms.Form):
    some_field = forms.ChoiceField(choices=[
        ('Audio', (
                ('vinyl', 'Vinyl'),
                ('cd', 'CD'),
            )
        ),
        ('Video', (
                ('vhs', 'VHS Tape'),
                ('dvd', 'DVD'),
            )
        ),
        ('unknown', 'Unknown'),
    ]) 
```

这个恕我直言是必须的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T21:02:04.147

您是否正在尝试创建一个菜单，其中列表项被分成类别，并且您不希望类别本身是可选择的？

如果是这样，您可以通过让模板使用标签呈现字段来实现此目的，例如

```
<select name="my_field" id="id_my_field">
<optgroup label="-- Root 1 entry --">
    <option value="1">Elt 1</option>
    <option value="2">Elt 2</option>
    <option value="3">Elt 3</option>
</optgroup>
<optgroup label="--- Root 2 entry ---">
    <option value="4">Elt 4</option>
    <option value="5">Elt 5</option>
</optgroup>
</select> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-04-30T23:09:16.470

这可能是一个迟到的答案，但这是一个简化版本，可以使用表单实例进行修改。

您可以传递要禁用的值列表，即

```
def __init__(self, disabled_choices, *args, **kwargs):
        self.disabled_choices = disabled_choices 
```

或者

```
from django.forms import Select

class SelectWidget(Select):
    """
    Subclass of Django's select widget that allows disabling options.
    """
    def __init__(self, *args, **kwargs):
        self._disabled_choices = []
        super(SelectWidget, self).__init__(*args, **kwargs)

    @property
    def disabled_choices(self):
        return self._disabled_choices

    @disabled_choices.setter
    def disabled_choices(self, other):
        self._disabled_choices = other

    def create_option(self, name, value, label, selected, index, subindex=None, attrs=None):
        option_dict = super(SelectWidget, self).create_option(
            name, value, label, selected, index, subindex=subindex, attrs=attrs
        )
        if value in self.disabled_choices:
            option_dict['attrs']['disabled'] = 'disabled'
        return option_dict 
```

根据条件禁用选项，即用户不是超级用户。

```
class MyForm(forms.Form):
    status = forms.ChoiceField(required=True, widget=SelectWidget, choices=(('on', 'On'), ('off', 'Off')))

    def __init__(self, request, *args, **kwargs):
        super().__init__(*args, **kwargs)

        if not request.user.is_superuser:
            self.fields['status'].widget.disabled_choices = ['off'] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-26T00:09:53.997

在 Django 中，简单的问题有时会有复杂的答案。我花了很多时间让它正常工作。将 Jarrett 的概述与 jnns 的重要说明`render_option`以及 freenode 上#django 的一些帮助相结合，我有一个运行良好的完整示例解决方案：

首先，此示例假定在我称为 Rule 的模型中通常定义了选择类型 CharField。我是我自己的子类`TimeStampedModel`，但你可以使用`models.Model`：

```
class Rule(TimeStampedModel):

    ...

    # Rule Type
    SHORT_TERM_RULE = 'ST'
    MAX_SIGHTINGS_PER_PERIOD_RULE = "MA"
    WHITE_LIST_RULE = "WL"
    BLACK_LIST_RULE = "BL"
    RULE_CHOICES = (
        (SHORT_TERM_RULE, 'Short Term Rule'),
        (MAX_SIGHTINGS_PER_PERIOD_RULE, 'Max Sightings Per Period Rule'),
        (WHITE_LIST_RULE, 'White List Rule'),
        (BLACK_LIST_RULE, 'Black List Rule'),
    )
    rule_type = models.CharField(
        max_length=2,
        choices=RULE_CHOICES,
        default=SHORT_TERM_RULE,
    )

    ... 
```

在 forms.py 中，定义`Select`接受`disabled_choices`. 如果选项标签的选择包含在传入列表中，它有一个自定义`render_option()`添加到选项标签的 html 输出。请注意，我保留了大部分代码：`disabled``disabled_choices``render_option()``Select`

```
class MySelect(Select):
    def __init__(self, attrs=None, choices=(), disabled_choices=()):
        super(MySelect, self).__init__(attrs, choices=choices)
        self.disabled_choices = disabled_choices

    def render_option(self, selected_choices, option_value, option_label):
        if option_value is None:
            option_value = ''
        option_value = force_text(option_value)
        if option_value in selected_choices:
            selected_html = mark_safe(' selected="selected"')
            if not self.allow_multiple_selected:
                selected_choices.remove(option_value)
        else:
            selected_html = ''
        for key, value in self.disabled_choices:
            if option_value in key:
                return format_html('<option disabled value="{}"{}>{}</option>', option_value, selected_html,
                                   force_text(option_label))
        return format_html('<option value="{}"{}>{}</option>', option_value, selected_html, force_text(option_label)) 
```

然后，在定义表单子类化`ModelForm`时，检查传入的`disabled_choices`列表并相应地初始化字段。在这个例子中，我还潜入了一个默认选项。

```
class RuleChoiceForm(ModelForm):
    class Meta:
        model = Rule
        fields = ['rule_type']

    # Add a default choice to the list defined in the Rule model
    default_choice = ('DF', 'Choose a Rule Type...')
    choices = list(Rule.RULE_CHOICES)
    choices.insert(0, default_choice)
    choices = tuple(choices)

    rule_type = forms.ChoiceField(widget=MySelect(attrs={'class': 'form-control'}, disabled_choices=[]),
                                  choices=choices)

    def __init__(self, *args, disabled_choices=None, **kwargs):
        super(RuleChoiceForm, self).__init__(*args, **kwargs)
        if disabled_choices:
            self.fields['rule_type'].widget.disabled_choices = disabled_choices 
```

然后在您的视图中，定义`disabled_choices`为一个列表，将您的`_CHOICES`var 中的选项附加到您的模型中，并将其传递给表单实例化。在我的逻辑中，我使用列表理解`RULE_CHOICES`来获取我想要禁用的选择的元组。尽管可能有更简单的方法，但请随时发布建议以简化或改进此答案。

```
 disabled_choices = []
    # Logic disabling choices
    if Rule.objects.filter(route=route, rule_type=Rule.SHORT_TERM_RULE).exists():
        disabled_choices.append([item for item in Rule.RULE_CHOICES if Rule.SHORT_TERM_RULE in item][0])
        disabled_choices.append([item for item in Rule.RULE_CHOICES if Rule.MAX_SIGHTINGS_PER_PERIOD_RULE in item][0])

    rule_choice_form = RuleChoiceForm(disabled_choices=disabled_choices) 
```

# resources - 从命令行向现有 EXE 文件添加图标

> ID：673203
> 
> 赞同：28
> 
> 时间：2009-03-23T12:31:07.930
> 
> 标签：resources, icons, exe, ico

是否有可以将图标添加到现有可执行文件的命令行工具？它应该能够将图标设置为资源管理器中显示的文件的“主”图标。

我没有 Visual Studio，无法使用包含图标的自定义资源重新编译 exe。

**更新**：自发布此问题以来，我发现的最佳工具是 WinRun4J 中包含的 RCEDIT.exe 实用[程序](http://winrun4j.sourceforge.net/)。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-11-21T07:35:33.153

~~抱歉，我还没有亲自尝试过这个，但是因为~~我在捆绑 atom-shell 应用程序时想要这个，当我第一次搜索其他答案中提到的 RCEDIT 实用程序时出现[https://github.com/atom/rcedit时，我发现它非常有趣。](https://github.com/atom/rcedit)

它的命令之一是：

> $ rcedit "path-to-exe-or-dll" --set-icon "path-to-ico"

…所以假设这可行，这很可能是我将使用的解决方案——我的 Windows 构建机器已经设置为`git`使用`gyp`.

**更新**：有一个预构建的可执行文件可通过[https://github.com/atom/rcedit/releases/](https://github.com/atom/rcedit/releases/)获得，它在 Win7 上对我很有效（来自 Git Bash/Msys shell，尽管如果这有什么不同我会感到惊讶）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-23T12:45:29.253

**[Resource Hacker](http://angusj.com/resourcehacker/)**是一个免费工具，允许您修改可执行文件中的资源，并且可以从命令行编写脚本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-07T15:50:08.167

就我而言，尝试使用带有 /A 或 /I 开关的 RCEdit.exe 添加图标会导致修剪后的可执行文件。我有一个 NSIS（NullSoft 安装程序系统） - 创建的设置最初为 13 MiB，但在运行 RCEdit 向其添加图标后，它剩下的所有内容只有几千字节（接近图标的大小），但是是的，可执行文件显示图标。

使用 Resource Hacker 添加图标对我有用。它甚至不需要将图标设置为默认值的选项，它是唯一的图标组资源。我使用 103 作为资源名称，使用 1033 作为语言。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T12:37:45.373

你试过[ResourceTuner 控制台](http://www.heaventools.com/rtconsole-features.htm)吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T12:39:23.840

试试这个[http://www.reseditor.com/rtc-solution-replace-icons.htm](http://www.reseditor.com/rtc-solution-replace-icons.htm)

# c# - 如何检查两个表达式 > 是一样的

> ID：673205
> 
> 赞同：51
> 
> 时间：2009-03-23T12:31:25.200
> 
> 标签：c#, expression, equality

是否有可能找出两个表达式是否相同？

就像给定以下四个表达式：

```
 Expression<Func<int, bool>> a = x => false;
        Expression<Func<int, bool>> b = x => false;
        Expression<Func<int, bool>> c = x => true;
        Expression<Func<int, bool>> d = x => x == 5; 
```

那么，至少*我们*可以看到：

*   `a == b`
*   `a != c`
*   `a != d`

但是我可以做些什么来在我的代码中找到这个吗？

看了一眼 msdn 库，上面写着

> `Equals`: 判断指定的 Object 是否等于当前的`Object`. （继承自`Object`。）

我猜这意味着至少Expression类没有覆盖equals方法成为Equatable？那么你会怎么做呢？还是我在这里要求太多了？:p

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-23T12:44:49.117

您可以查看在[Linq to db4o](http://evain.net/blog/articles/2008/02/06/an-elegant-linq-to-db4o-provider-and-a-few-linq-tricks)中使用的[ExpressionEqualityComparer](https://github.com/lytico/db4o/blob/master/db4o.net/Db4objects.Db4o.Linq/Db4objects.Db4o.Linq/Expressions/ExpressionEqualityComparer.cs)类型。它实现了 IEqualityComparer<T> 接口，因此它可用于泛型集合，也可用于独立使用。

它使用[ExpressionComparison](https://github.com/lytico/db4o/blob/master/db4o.net/Db4objects.Db4o.Linq/Db4objects.Db4o.Linq/Expressions/ExpressionComparison.cs)类型来比较两个 Expression 的相等性，并使用[HashCodeCalculation](https://github.com/lytico/db4o/blob/master/db4o.net/Db4objects.Db4o.Linq/Db4objects.Db4o.Linq/Expressions/HashCodeCalculation.cs)来从 Expression 计算哈希码。

这一切都涉及访问表达式树，因此如果您重复执行它可能会非常昂贵，但它也可以非常方便。

该代码在 GPL 或[dOCL下可用](http://www.db4o.com/about/company/legalpolicies/docl.aspx)

例如，这是您的测试：

```
using System;
using System.Linq.Expressions;

using Db4objects.Db4o.Linq.Expressions;

class Test {

    static void Main ()
    {
        Expression<Func<int, bool>> a = x => false;
        Expression<Func<int, bool>> b = x => false;
        Expression<Func<int, bool>> c = x => true;
        Expression<Func<int, bool>> d = x => x == 5;

        Func<Expression, Expression, bool> eq =
            ExpressionEqualityComparer.Instance.Equals;

        Console.WriteLine (eq (a, b));
        Console.WriteLine (eq (a, c));
        Console.WriteLine (eq (a, d));
    }
} 
```

它确实打印了 True, False, False。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-23T12:50:19.663

作为一个懒惰的答案，您可以检查`ToString()`- 它至少应该指出它们明显不同的地方（尽管它会在那里包含 var-name，所以它必须是相同的）。

为了准确地检查等价性......更加困难 - 大量工作，涉及许多不同的节点类型。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T12:38:05.357

令我震惊的是，除了最简单的情况外，这可能很难做到。

例如：

```
var numbers1 = Enumerable.Range(1, 20);
Expression<Func<int, IEnumerable<int>>> a = x => numbers1;
var numbers2 = Enumerable.Range(1, 20);
Expression<Func<int, IEnumerable<int>>> b = x => numbers2; 
```

从技术上讲，它们是相等的，但是如果不评估每个表达式中返回的 IEnuemrable，如何确定呢？

# algorithm - 斜矩阵算法

> ID：673216
> 
> 赞同：12
> 
> 时间：2009-03-23T12:34:19.937
> 
> 标签：algorithm, graphics, matrix

我正在寻找偏斜算法，就像在 Photoshop 上一样，编辑->转换-​​>偏斜是否有任何简单的矩阵可以做到这一点？

到目前为止我所看到的是基本的倾斜矩阵（剪切），但它缺乏控制点，不喜欢在矩形的每个角上至少有 4 个点的 Photoshop 上，我们可以自由移动每个控制点。

我需要实现它来改造飞机。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-23T12:43:02.350

查看有关 SVG 的[http://www.w3.org/TR/SVG11/coords.html](http://www.w3.org/TR/SVG11/coords.html)，它说：

*   沿 x 轴的倾斜变换等价于矩阵

![替代文字](https://www.w3.org/TR/SVG11/images/coords/MatrixSkewX.png)

或 [1 0 tan(a) 1 0 0]，它具有将 X 坐标倾斜角度 a 的效果。

*   沿 y 轴的倾斜变换等价于矩阵

![替代文字](https://www.w3.org/TR/SVG11/images/coords/MatrixSkewY.png)

或 [1 tan(a) 0 1 0 0]，它具有将 Y 坐标倾斜角度 a 的效果。

希望有帮助！:)

# functional-programming - 如何在 Erlang 的列表中搜索项目？

> ID：673219
> 
> 赞同：13
> 
> 时间：2009-03-23T12:34:33.477
> 
> 标签：functional-programming, erlang

我正在为公司使用编写缓存生成服务器。我想知道如何从列表中搜索一个项目，因为我想要比较 erlang 中的各种数据结构（如 dict、orddict、List、tuples、tree、queue 等）以用于缓存程序的搜索成本。

例子：

```
List = [{"A1",["ankit","sush", "Hover", "x4", "a3","nilesh","mike","erlang" | ...]}|...]. 
```

现在，我想搜索 Key A1 并在列表中搜索“mike”。搜索上述列表的最佳方法是什么。

请提供一些例子。至少是伪的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-07-26T22:37:04.637

只是为了简化[https://stackoverflow.com/a/15587565/56250](https://stackoverflow.com/a/15587565/56250)上的示例：

```
listFind(Element, List) ->
  lists:member(Element, List). 
```

`lists:member`适用于空列表。快速查看源代码（[https://github.com/erlang/otp/blob/07b8f441ca711f9812fad9e9115bab3c3aa92f79/erts/emulator/beam/erl_bif_lists.c#L184](https://github.com/erlang/otp/blob/07b8f441ca711f9812fad9e9115bab3c3aa92f79/erts/emulator/beam/erl_bif_lists.c#L184)）表明它执行得很慢。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T17:26:54.770

感谢您的回答。我编写了一个 Erlang 代码来查找将日期插入和获取日期到各种数据结构（如数据结构的**LIST、DICT、QUEUE、SET 和 PARALLEL MAP）中的时间**。只有 list 的 insert & fetch 完成，其余的有并行 map 插入。我想分享代码和代码的结果。以下是模块 test.erl

```
-module(test).
-author('ankit@hover.in').
-export ([ 
       %%list
       create_list/1, fetch_list/2, test_list/1, parmap_create_list/1 , ins_list/3, parallel_list/1,
       para_fetch_list/2, pfetch_list/1,

       %%dict
       create_dict/1, fetch_dict/2, test_dict/1, parmap_create_dict/1 , ins_dict/3, parallel_dict/1,

       %queue
       create_q/1, fetch_q/2, test_q/1, parmap_create_q/1, ins_q/3, parallel_q/1,

       %set
       create_set/1, fetch_set/2, test_set/1, parmap_create_set/1 , ins_set/3, parallel_set/1,

       create/1, multi_create/0,
       pcreate/1, parallel_multi_create/0

       %test/1 , multi_test/0 
      ]).

%%creation tests

%% For List
create_list(N) ->
    lists:foldl ( fun(X,Prev) -> Prev ++ [X] end, [] , lists:seq(1,N)).

test_list(N) ->
    {R1,List} = timer:tc(?MODULE, create_list, [N]),
    %%Set = lists:foldl(fun(X,Prev) -> sets:add_element(X,Prev) end,SET, lists:seq(1,N)),
    {R2,_} = timer:tc(?MODULE, fetch_list,[ N, List ]),
    {list,inserT,R1,fetchT,R2}.

%% For Dict
create_dict(N) ->
    lists:foldl( fun(X,Prev)-> dict:append([],X,Prev) end, dict:new(), lists:seq(1,N)).

test_dict(N) ->
    {R1,Dict} = timer:tc(?MODULE, create_dict, [N]),
    %%Set = lists:foldl(fun(X,Prev) -> sets:add_element(X,Prev) end,SET, lists:seq(1,N)),
    {R2,_} = timer:tc(?MODULE, fetch_dict,[ N, Dict ]),
    {dict,inserT,R1,fetchT,R2}.

%% For Queue
create_q(N) ->
    lists:foldl(fun(X,Prev) -> queue:in(X,Prev) end, queue:new() , lists:seq(1,N)).

test_q(N)->
    {R1,Q}  = timer:tc(?MODULE, create_q,[N]),
    %%Q = lists:foldl(fun(X,Prev) -> queue:in(X,Prev) end,Q0, lists:seq(1,N)),
    {R2,_} = timer:tc(?MODULE, fetch_q, [ N,Q ] ),
    {queue,inserT,R1,fetchT,R2}.

%% For Set
create_set(N) ->
    SET = sets:new(),
    lists:foldl(fun(X,Prev) -> sets:add_element(X,Prev) end,SET, lists:seq(1,N)).

test_set(N) ->   
    {R1,Set} = timer:tc(?MODULE, create_set, [N]),
    %%Set = lists:foldl(fun(X,Prev) -> sets:add_element(X,Prev) end,SET, lists:seq(1,N)),
    {R2,_} = timer:tc(?MODULE, fetch_set,[ N, Set ]),
    {set,inserT,R1,fetchT,R2}.

create(N)->
    [   timer:tc(?MODULE, X , [N])  || X <- [ test_list, test_dict, test_q,test_set ] ].

xmulti_create()->
    [ ?MODULE:create(X) || X<- [10,100,1000,10000,100000] ].

multi_create() ->
    InputRange = [10,100,1000,10000,100000],
    lists:map(fun(X) ->
              ?MODULE:create(X)
          end,InputRange).

%%fetching midpoint tests
fetch_q(N,Q)->
    fetch_q(N,Q,100).

fetch_q(N,Q,Find) ->
    F = fun(I) -> queue:out_r(I) end,
    R = lists:foldl( fun(_X,{Bool,PrevQ} ) ->
                 {{value, Ele},QQ} = F(PrevQ),
                 Ret1 = case Ele of 
                       Temp when Temp =:= Find -> 
                       true;
                       _ ->
                       Bool
                   end,
                 Ret2 = QQ, 

                 {Ret1,Ret2}

             end,{false,Q}, 
             lists:seq(1,N)),
    R.

fetch_set(N,Set) ->
    fetch_set(N,Set,100).

fetch_set(_N,Set,Find) ->
    Return = sets:is_element(Find,Set),
    Return.

fetch_list(N,List) ->
    fetch_list(N,List,500).

fetch_list(_N,List,Find) ->
    Ret = lists:foldl(fun(X,Prev) when X =:= Find -> true; 
             (X, Prev) -> Prev 
              end,false,List),
    Ret.

fetch_dict(N,Dict) ->
    {ok,List} = dict:find([],Dict),
    fetch_dict(N,List,500).

fetch_dict(_N,List,Find) ->
    Ret = lists:foldl(fun(X,Prev) when X =:= Find -> true; 
             (X, Prev) -> Prev
              end,false,List),
    Ret.

%% parallel operation

%% Parallel Map for Queue
parallel_q(N) ->
    {R1,Set} = timer:tc(?MODULE, parmap_create_q, [N]),
    {parallel_q,pcreate,R1}.

parmap_create_q(N) ->

    PID = spawn(fun() ->
            ?MODULE:ins_q( queue:new(),0,N) end),
    [PID ! {self(),X} || X <- lists:seq(1,N) ],
    receive
    {ok, Q} ->
        %%io:format("~n Still insertin, Q till now ~p",[Q]),
        ok;
    {done, Q}  ->
        io:format("~n *******DONE*********~n ~p",[Q]);
    _E ->
        io:format("unexpected ~p",[_E])
    end.

ins_q(Q,Ctr, Max) ->    
    receive
    {From, N} ->
        %%io:format("~n insert ~p, ctr ~p, Q ~p ~n",[N,Ctr,Q]),
        NewQ = queue:in( N, Q) ,
        case Ctr
        of Temp when Temp < Max ->
            From ! {ok, NewQ};
        _-> 
            From ! {done, NewQ}
        end,
        ?MODULE:ins_q(NewQ,Ctr+1, Max);
    _E ->
        io:format("unexpected ~p",[_E]),
        ?MODULE:ins_q(Q, Ctr, Max)
    end.

%% Parallel Map for set
parallel_set(N) ->
    {R1,Set} = timer:tc(?MODULE, parmap_create_set, [N]),
    {parallel_set,pcreate,R1}.

parmap_create_set(N) ->

    PID = spawn(fun() ->
            ?MODULE:ins_set( sets:new(),0,N) end),
    [PID ! {self(),X} || X <- lists:seq(1,N) ],
    receive
    {ok, Sets} ->
        %%io:format("~n Still insertin, Sets till now ~p",[Sets]),
        ok;
    {done, Sets}  ->
        io:format("~n *******DONE*********~n ~p",[Sets]);
    _E ->
        io:format("unexpected ~p",[_E])
    end.

ins_set(Sets,Ctr, Max) ->    
    receive
    {From, N} ->
        %%io:format("~n insert ~p, ctr ~p, Sets ~p ~n",[N,Ctr,Sets]),
        NewSets = sets:add_element(N,Sets),

        case Ctr
        of Temp when Temp < Max ->
            From ! {ok, NewSets};
        _-> 
            From ! {done, NewSets}
        end,
        ?MODULE:ins_set(NewSets,Ctr+1, Max);
    _E ->
        io:format("unexpected ~p",[_E]),
        ?MODULE:ins_set(Sets, Ctr, Max)
    end.

%% Parallel Map for dict
parallel_dict(N) ->
    {R1,Set} = timer:tc(?MODULE, parmap_create_dict, [N]),
    {parallel_dict,pcreate,R1}.

parmap_create_dict(N) ->

    PID = spawn(fun() ->
            ?MODULE:ins_dict( dict:new(),0,N) end),
    [PID ! {self(),X} || X <- lists:seq(1,N) ],
    receive
    {ok, Dict} ->
        %%io:format("~n Still insertin, Sets till now ~p",[Dict]),
        ok;
    {done, Dict}  ->
        io:format("~n *******DONE*********~n ~p",[Dict]);
    _E ->
        io:format("unexpected ~p",[_E])
    end.

ins_dict(Dict,Ctr, Max) ->    
    receive
    {From, N} ->
        %%io:format("~n insert ~p, ctr ~p, Dict ~p ~n",[N,Ctr,Dict]),
        NewDict = dict:append([],N,Dict),

        case Ctr
        of Temp when Temp < Max ->
            From ! {ok, NewDict};
        _-> 
            From ! {done, NewDict}
        end,
        ?MODULE:ins_dict(NewDict,Ctr+1, Max);
    _E ->
        io:format("unexpected ~p",[_E]),
        ?MODULE:ins_dict(Dict, Ctr, Max)
    end.

%% Parallel Map for list
parallel_list(N) ->
    {R1,List} = timer:tc(?MODULE, parmap_create_list, [N]),
    {R2,_} = timer:tc(?MODULE, para_fetch_list, [N,List]),
    {parallel_list,pCreate,R1,pFetch,R2}.

parmap_create_list(N) ->

    PID = spawn(fun() ->
            ?MODULE:ins_list( [],0,N) end),
    [PID ! {self(),X} || X <- lists:seq(1,N) ],
    receive
    {ok, List} ->
        %%io:format("~n Still insertin, List till now ~p",[List]),
        ok;
    {done, List}  ->
        io:format("~n *******DONE*********~n ~p",[List]);
    _E ->
        io:format("unexpected ~p",[_E])
    end.

ins_list(List,Ctr, Max) ->    
    receive
    {From, N} ->
        %%io:format("~n insert ~p, ctr ~p, Sets ~p ~n",[N,Ctr,Dict]),
        NewList = List ++ [N] ,

        case Ctr
        of Temp when Temp < Max ->
            From ! {ok, NewList};
        _-> 
            From ! {done, NewList}
        end,
        ?MODULE:ins_list(NewList,Ctr+1, Max);
    _E ->
        io:format("unexpected ~p",[_E]),
        ?MODULE:ins_list(List, Ctr, Max)
    end.

para_fetch_list(List, FindN) ->
    Pid = spawn(fun() ->
            ?MODULE:pfetch_list(FindN) end),
    Self = self(),
    Now1 = now(),
    lists:map ( fun(X) ->
            Pid ! {Self, X},
            receive
                {true,Find} ->
                io:format("~n Found ~p ",[Find]),
                true;
                {false,Find}  ->
                %io:format("~n NOT FOUND ~p ",[Find]),
                false;
                _E ->
                io:format("para main unexpected ~p",[_E])
            after 4000 ->
                io:format("timerout ",[])

            end
        end, List ) ,
    Now2 = now(),
    timer:now_diff(Now2,Now1).

pfetch_list(Find) ->    
    receive
    {From, CurrN} ->

        _Ret = case CurrN of 
              Temp when Temp =:= Find ->
              From ! {true,Find},
              true;
              _ -> 
              From ! {false,Find},
              false
          end,
        %%io:format("~n insert ~p, ctr ~p, Sets ~p ~n",[N,Ctr,Dict]),
        ?MODULE:pfetch_list(Find);
    _E ->
        io:format("pfetch unexpected ~p",[_E]),
        ?MODULE:pfetch_list(Find)
    end.    

pcreate(N)->
    [   timer:tc(?MODULE, X , [N])  || X <- [ parallel_list ] ].

parallel_multi_create() ->
    InputRange = [10,100,1000,10000],
    lists:map(fun(X) ->
              ?MODULE:pcreate(X)
          end,InputRange). 
```

**以下是结果：** 对于并行 Map DS

```
(ankit@127.0.0.1)2> test:pcreate(1000).
[{5399,{parallel_list,pCreate,5352,pFetch,30}},
 {9886,{parallel_dict,pcreate,9875}},
 {87603,{parallel_q,pcreate,87593}},
 {42271,{parallel_set,pcreate,42223}}] 
```

对于所有 DS

```
 (ankit@127.0.0.1)3> test:multi_create().
 %% For 10   
[[{38,{list,inserT,14,fetchT,8}},
      {91,{dict,inserT,67,fetchT,11}},
      {47,{queue,inserT,13,fetchT,21}},
      {81,{set,inserT,61,fetchT,7}}],
%%for 100
     [{234,{list,inserT,191,fetchT,30}},
      {690,{dict,inserT,642,fetchT,35}},
      {218,{queue,inserT,60,fetchT,144}},
      {559,{set,inserT,540,fetchT,6}}],
%% for 1000
     [{13746,{list,inserT,13452,fetchT,262}},
      {96137,{dict,inserT,96009,fetchT,116}},
      {967,{queue,inserT,284,fetchT,674}},
      {5562,{set,inserT,5547,fetchT,5}}],
%% for 10000  
   [{438301,{list,inserT,437256,fetchT,1027}},
      {361450,{dict,inserT,360412,fetchT,1020}},
      {7937,{queue,inserT,2292,fetchT,5636}},
      {31293,{set,inserT,31279,fetchT,5}}],
% for 100000
     [{43750210,{list,inserT,43739956,fetchT,10238}},
      {51517971,{dict,inserT,51507134,fetchT,10819}},
      {92503,{queue,inserT,29676,fetchT,62811}},
      {682118,{set,inserT,682100,fetchT,5}}]] 
```

希望这些信息可以帮助您确定哪个是用于不同目的的最佳 DS。当我完成整个代码时，我会更新它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T13:12:52.247

如果您想搜索列表，请使用[列表模块](http://erlang.org/doc/apps/stdlib/index.html)中的函数，该模块是Erlang 附带的[大量文档](http://erlang.org/doc/)的一部分。

如果您想知道要使用的最佳数据结构 - 这是一个稍微不同的问题，需要更多信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-22T17:20:12.653

使用模块中的`keyfind`功能。`lists`例如：

```
30> List = [{"A1",["ankit","sush", "Hover", "x4", "a3","nilesh","mike","erlang"]}].
[{"A1",
  ["ankit","sush","Hover","x4","a3","nilesh","mike",
   "erlang"]}]
31> lists:keyfind("A1", 1, List).
{"A1",
 ["ankit","sush","Hover","x4","a3","nilesh","mike","erlang"]} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T22:35:18.540

如果您想要这种“列表”，您可以轻松手工制作自己的搜索：

```
search_key(Key, [{Key,_}=V|_]) -> {ok, V};
search_key(Key, [_|T]) -> search_key(Key, T);
search_key(_, []) -> not_found.

search_val(Val, [{_,L}=X|T]) ->
  case _search_val(Val, L) of
    ok -> {ok, X};
    not_found -> search_val(Val, T)
  end;
search_val(_, []) -> not_found.

_search_val(Val, [Val|_])-> ok;
_search_val(Val, [_|T])-> _search_val(Val, T);
_search_val(_,[])-> not_found. 
```

但我不确定你到底想要什么。例如，如果您想在列表中搜索键“A1”而不是值“mike”，这将是不同的解决方案。如果您想知道如何以最佳结构存储这种类型，那只是另一个问题。您应该提供更多信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-23T13:54:50.030

如果您的列表是一个简单的基于术语的项目列表，那么最简单的解决方案是：

```
listFind ( Element, [] ) ->
    false;

listFind ( Element, [ Item | ListTail ] ) ->
    case ( Item == Element ) of
        true    ->  true;
        false   ->  listFind(Element, ListTail)
    end. 
```

假设您使用**==**运算符检查列表中项目的相等性，上述内容将起作用。您可以根据需要修改该运算符以适应其他类型的比较/相等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-08T15:41:37.030

您也可以`any`从[http://erlang.org/doc/man/lists.html#any-2使用](http://erlang.org/doc/man/lists.html#any-2)

```
lists:any(fun(X) -> X == <<"yourthing">> end, YourList) 
```

`true`如果找到或以其他方式返回`false`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-18T22:02:02.773

不能比这更简单：

```
fein(_, []) ->
    [];
fein(Element, [Item| ListTail]) ->
    case (Item =:= Element) of
    true -> [Element|fein(Element, ListTail)];
    false -> fein(Element, ListTail)
    end. 
```

# windows - WMI“已安装”查询不同于添加/删除程序列表？

> ID：673233
> 
> 赞同：44
> 
> 时间：2009-03-23T12:40:29.530
> 
> 标签：windows, windows-installer, wmi

尝试使用 WMI 获取 Windows XP 已安装程序的列表。使用 wmic，我尝试了：

```
wmic /output:c:\ProgramList.txt product get name,version 
```

我得到了许多已安装程序的列表，但是在根据“添加/删除程序”显示的内容擦洗该列表后，我看到添加/删除程序的 GUI 中列出的程序比 WMI 查询中列出的程序多得多。我需要使用另一个 WMI 查询来安装其余程序吗？或者还有其他地方我需要寻找其余的地方吗？

此外，WMI 查询中列出了两个已安装的程序，它们不在“添加/删除程序”中。知道为什么吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-23T13:01:15.270

我相信您的语法是使用 WMI 中的[Win32_Product](http://msdn.microsoft.com/en-us/library/aa394378(VS.85).aspx)类。一个原因是此类仅显示使用 Windows Installer 安装的产品（[请参阅此处](http://www.tech-archive.net/Archive/Windows/microsoft.public.windows.server.scripting/2005-05/msg00675.html)）。[卸载注册表项](https://docs.microsoft.com/en-us/windows/win32/msi/uninstall-registry-key)是您最好的选择。

`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall` `HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall`

更新评论：

卸载注册表项是列出已安装和未安装内容的标准位置。这是添加/删除程序列表将用于填充应用程序列表的位置。我确信有些应用程序没有在此位置列出自己。在这种情况下，您将不得不求助于另一种更粗略的方法，例如搜索程序文件目录或查看开始菜单程序列表。这两种方式肯定都不理想。

在我看来，查看注册表项是最好的方法。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-23T12:46:27.053

所有添加/删除程序真正做的是读取这个注册表项：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-02-07T16:55:09.693

除了最常见的已安装程序注册表项：

> HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall

wmic 命令和添加/删除程序还查询另一个注册表项：

> HKEY_CLASSES_ROOT\Installer\Products

列表中显示的软件名称是从名为 ProductName 的该键中的数据条目的值中读取的

从上述两个位置删除特定产品的注册表项将使其不会显示在添加/删除程序列表中。这不是卸载程序的方法，它只会从 Windows 已知的已安装软件中删除该条目。

因为，通过使用这种方法，您将失去使用添加/删除列表中的“删除”按钮从系统中彻底删除软件的机会；建议在删除注册表项之前将其导出到文件。将来，如果您决定将该项目带回列表，您只需运行您存储的注册表文件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-03-17T02:53:51.070

我一直在使用 Inno Setup 作为安装程序。我只使用 64 位 Windows 7。我发现正在写入注册表项

> HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall

我还没有弄清楚如何让 WMI 报告这个列表（尽管该程序被列为已安装在程序和功能中）。如果我弄明白了，我会尽量记得在这里报告。

**更新：**

安装在 64 位计算机上的 32 位程序的条目位于该注册表位置。这里写的更多：

[http://mdb-blog.blogspot.com/2010/09/c-check-if-programapplication-is.html](http://mdb-blog.blogspot.com/2010/09/c-check-if-programapplication-is.html)

请参阅我在同一篇文章中描述 32 位与 64 位行为的评论：

[http://mdb-blog.blogspot.com/2010/09/c-check-if-programapplication-is.html?showComment=1300402090679#c861009270784046894](http://mdb-blog.blogspot.com/2010/09/c-check-if-programapplication-is.html?showComment=1300402090679#c861009270784046894)

不幸的是，似乎没有办法让 WMI 列出添加/删除程序列表中的所有程序（又名 Windows 7 中的程序和功能，不确定 Vista）。我当前的代码已经放弃了 WMI，转而使用注册表。查询注册表的代码本身比使用 WMI 更容易。示例代码在上面的链接中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-04-01T05:08:30.990

不是最好的，而是是否实用的方法：

使用[HijackThis](http://sourceforge.net/projects/hjt/)。

运行 hijack this，点击“Open the Misc Tools section”按钮

![HijackThis 主菜单](https://i.stack.imgur.com/Z5qmx.jpg)

点击“打开卸载管理器”

![劫持此配置](https://i.stack.imgur.com/uqZdS.jpg)

单击保存列表 (*.txt)，提示是，记事本将打开您的添加/删除程序列表。

![HijackThis 添加/删除程序管理器](https://i.stack.imgur.com/qkmUe.jpg)

* * *

[来源](http://www.computing.net/answers/windows-xp/export-addremove-programs-list/155452.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-02-23T07:05:12.240

您可以使用 powershell 和批处理文件在一行中获取它：

```
@echo off
Powershell /command "Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-List"
Pause 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-03-18T05:15:52.677

已安装的产品由已安装的软件元素和功能组成，因此值得检查 PRODUCT 的 wmic 别名以及检查 SOFTWAREELEMENT 和 SOFTWAREFEATURE：

```
wmic product get name,version

wmic softwareelement get name,version

wmic softwarefeature get name,version 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-01-24T18:52:43.680

您可以使用来自[http://technet.microsoft.com/en-us/library/ee692772.aspx#EBAA](http://technet.microsoft.com/en-us/library/ee692772.aspx#EBAA)的脚本来访问注册表并使用 WMI 列出应用程序。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-04-07T07:55:23.080

添加/删除程序还必须查看此注册表项以查找当前用户的安装：

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Uninstall 
```

Google Chrome、Dropbox 等应用程序或通过 JavaWS（网络启动）JNLP 安装的快捷方式只能在此处找到。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-12-19T07:57:04.877

为了在控制面板的“程序和功能”中构建一个或多或少可靠的应用程序列表，您必须考虑并非所有应用程序都是使用 MSI 安装的。WMI 仅提供与 MSI 一起安装的那些。

以下是我发现的内容的简短摘要：

**MSI 应用程序**`HKLM\...\Uninstall`始终在和/或 下具有产品代码 (GUID) 子项`HKLM\...\Installer\UserData\S-1-5-18\Products`。此外，他们可能有一个看起来像`HKLM\...\Uninstall\NotAGuid`.

**非 MSI 应用程序**没有产品代码，因此具有类似`HKLM\...\Uninstall\NotAGuid`或的键`HKCU\...\Uninstall\NotAGuid`。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-02-24T08:54:49.190

希望这对某人有所帮助：我一直在我的脚本中使用基于注册表的枚举（如上面的一些答案所建议的那样），但发现当通过 SCCM 在 Windows 10 x64 上运行时它无法正确枚举 64 位软件（使用 32 位客户端）。在我的特殊情况下，发现这样的解决方案是最直接的解决方案：

```
Function Get-Programs($Bits) {
  $Result = @()
  $Output = (reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall /reg:$Bits /s)

  Foreach ($Line in $Output) {
    If ($Line -match '^\s+DisplayName\s+REG_SZ\s+(.+?)$') {
      $Result += New-Object PSObject -Property @{
        DisplayName = $matches[1];
        Bits = "$($Bits)-bit";
      }
    }
  }

  $Result
}

$Software  = Get-Programs 32
$Software += Get-Programs 64 
```

意识到这有点过于 Perl-ish，但我见过的所有其他替代方案都涉及包装脚本和类似的聪明聪明的解决方案的疯狂，这似乎更人性化。

PS 非常努力地避免在这里向微软倾倒大量盐，因为这使得一件绝对微不足道的事情几乎是不可能的。即，枚举网络上使用的所有 MS Office 版本是一项让成年人哭泣的任务。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-07-04T15:55:17.767

自从提出这个问题以来，随着时间的推移，时间已经过去了很多......

现在有一个 WMI 类可用于注册表中的卸载条目。这比 Win32_Product 引用起来要快得多，我认为 Win32_Product 也会在列表上运行验证，并且可能需要一段时间才能枚举。下面的 Powershell 代码（可能需要 Powershell 3 或更高版本）将列出所有条目（Out-Gridview 部分只是为了漂亮的显示）。

```
Get-CimInstance Win32Reg_AddRemovePrograms | Out-gridview 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-06-24T11:15:08.560

我根据自己的需要调整了 MS-Technet VBScript。它将 Wow6432Node 以及标准条目转储到“programms.txt”中使用它需要您自担风险，不提供任何担保！

另存为**转储.vbs**

从命令行输入：**wscript dump.vbs**

```
Const HKLM = &H80000002
Set objReg = GetObject("winmgmts://" & "." & "/root/default:StdRegProv")
Set objFSO = CreateObject("Scripting.FileSystemObject")

outFile="programms.txt"

Set objFile = objFSO.CreateTextFile(outFile,True)
writeList "SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\", objReg, objFile
writeList "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\", objReg, objFile
objFile.Close 

Function writeList(strBaseKey, objReg, objFile) 
objReg.EnumKey HKLM, strBaseKey, arrSubKeys 
    For Each strSubKey In arrSubKeys
        intRet = objReg.GetStringValue(HKLM, strBaseKey & strSubKey, "DisplayName", strValue)
        If intRet <> 0 Then
            intRet = objReg.GetStringValue(HKLM, strBaseKey & strSubKey, "QuietDisplayName", strValue)
        End If
        objReg.GetStringValue HKLM, strBaseKey & strSubKey, "DisplayVersion", version
        objReg.GetStringValue HKLM, strBaseKey & strSubKey, "InstallDate", insDate 
        If (strValue <> "") and (intRet = 0) Then
            objFile.Write strValue & "," & version & "," & insDate & vbCrLf
        End If
    Next
End Function 
```

# ncurses - 使用 ncurses 设计文本用户界面。

> ID：673234
> 
> 赞同：2
> 
> 时间：2009-03-23T12:40:32.090
> 
> 标签：ncurses

我打算使用 ncurses 编写一个实用程序。那是 Unix 上的菜单和面板。在我进行实际编码之前，有没有什么方法可以设计我的 TUI 以查看它的外观和感觉？

是否有任何实用程序，或一些文章、链接等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T13:11:56.493

我是 ncurses 的忠实粉丝，但我不知道有这样的工具。您可以尝试只做铅笔和纸或[Balsamiq](http://www.balsamiq.com/)模型。或许，最好的办法是编写一个精简版的 UI，不包含所有业务逻辑，然后看看感觉如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-26T08:55:05.070

似乎这个问题不再相关，但仍然..

我在 LibreOffice Calc 中制作了一个相同长度和宽度的单元格，并绘制线条界面

# c++ - how do I print an unsigned char as hex in c++ using ostream?

> ID：673240
> 
> 赞同：77
> 
> 时间：2009-03-23T12:42:14.160
> 
> 标签：c++, formatting, cout, ostream, unsigned-char

I want to work with unsigned 8-bit variables in C++. Either `unsigned char` or `uint8_t` do the trick as far as the arithmetic is concerned (which is expected, since AFAIK `uint8_t` is just an alias for `unsigned char`, or so the debugger presents it.

The problem is that if I print out the variables using ostream in C++ it treats it as char. If I have:

```
unsigned char a = 0;
unsigned char b = 0xff;
cout << "a is " << hex << a <<"; b is " << hex << b << endl; 
```

then the output is:

```
a is ^@; b is 377 
```

instead of

```
a is 0; b is ff 
```

I tried using `uint8_t`, but as I mentioned before, that's typedef'ed to `unsigned char`, so it does the same. How can I print my variables correctly?

**Edit:** I do this in many places throughout my code. Is there any way I can do this *without* casting to `int` each time I want to print?

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-03-23T12:44:29.380

Use:

```
cout << "a is " << hex << (int) a <<"; b is " << hex << (int) b << endl; 
```

And if you want padding with leading zeros then:

```
#include <iomanip>
...
cout << "a is " << setw(2) << setfill('0') << hex << (int) a ; 
```

As we are using C-style casts, why not go the whole hog with terminal C++ badness and use a macro!

```
#define HEX( x )
   setw(2) << setfill('0') << hex << (int)( x ) 
```

you can then say

```
cout << "a is " << HEX( a ); 
```

**Edit:** Having said that, MartinStettner's solution is much nicer!

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-03-23T13:37:15.993

I would suggest using the following technique:

```
struct HexCharStruct
{
  unsigned char c;
  HexCharStruct(unsigned char _c) : c(_c) { }
};

inline std::ostream& operator<<(std::ostream& o, const HexCharStruct& hs)
{
  return (o << std::hex << (int)hs.c);
}

inline HexCharStruct hex(unsigned char _c)
{
  return HexCharStruct(_c);
}

int main()
{
  char a = 131;
  std::cout << hex(a) << std::endl;
} 
```

It's short to write, has the same efficiency as the original solution and it lets you choose to use the "original" character output. And it's type-safe (not using "evil" macros :-))

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2015-02-05T22:23:23.370

You can read more about this at [http://cpp.indi.frih.net/blog/2014/09/tippet-printing-numeric-values-for-chars-and-uint8_t/](http://cpp.indi.frih.net/blog/2014/09/tippet-printing-numeric-values-for-chars-and-uint8_t/) and [http://cpp.indi.frih.net/blog/2014/08/code-critique-stack-overflow-posters-cant-print-the-numeric-value-of-a-char/](http://cpp.indi.frih.net/blog/2014/08/code-critique-stack-overflow-posters-cant-print-the-numeric-value-of-a-char/). I am only posting this because it has become clear that the author of the above articles does not intend to.

The simplest and most correct technique to do print a char as hex is

```
unsigned char a = 0;
unsigned char b = 0xff;
auto flags = cout.flags(); //I only include resetting the ioflags because so
                           //many answers on this page call functions where
                           //flags are changed and leave no way to  
                           //return them to the state they were in before 
                           //the function call
cout << "a is " << hex << +a <<"; b is " << +b << endl;
cout.flags(flags); 
```

The readers digest version of how this works is that the unary + operator forces a no op type conversion to an int with the correct signedness. So, an unsigned char converts to unsigned int, a signed char converts to int, and a char converts to either unsigned int or int depending on whether char is signed or unsigned on your platform (it comes as a shock to many that char is special and not specified as either signed or unsigned).

The only negative of this technique is that it may not be obvious what is happening to a someone that is unfamiliar with it. However, I think that it is better to use the technique that is correct and teach others about it rather than doing something that is incorrect but more immediately clear.

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2018-03-01T16:16:56.330

Well, this works for me:

```
std::cout << std::hex << (0xFF & a) << std::endl; 
```

If you just cast `(int)` as suggested it might add 1s to the left of `a` if its most significant bit is 1\. So making this binary AND operation guarantees the output will have the left bits filled by 0s and also converts it to unsigned int forcing cout to print it as hex.

I hope this helps.

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2020-12-15T15:32:17.420

In C++20 you'll be able to use [`std::format`](https://en.cppreference.com/w/cpp/utility/format) to do this:

```
std::cout << std::format("a is {:x}; b is {:x}\n", a, b); 
```

Output:

```
a is 0; b is ff 
```

In the meantime you can use [the {fmt} library](https://github.com/fmtlib/fmt), `std::format` is based on. {fmt} also provides the `print` function that makes this even easier and more efficient ([godbolt](https://godbolt.org/z/MfP1rr)):

```
fmt::print("a is {:x}; b is {:x}\n", a, b); 
```

**Disclaimer**: I'm the author of {fmt} and C++20 `std::format`.

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-09-04T10:30:49.547

Hm, it seems I re-invented the wheel yesterday... But hey, at least it's a generic wheel this time :) `char`s are printed with two hex digits, `short`s with 4 hex digits and so on.

```
template<typename T>
struct hex_t
{
    T x;
};

template<typename T>
hex_t<T> hex(T x)
{
    hex_t<T> h = {x};
    return h;
}

template<typename T>
std::ostream& operator<<(std::ostream& os, hex_t<T> h)
{
    char buffer[2 * sizeof(T)];
    for (auto i = sizeof buffer; i--; )
    {
        buffer[i] = "0123456789ABCDEF"[h.x & 15];
        h.x >>= 4;
    }
    os.write(buffer, sizeof buffer);
    return os;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-09-28T08:51:22.643

I think TrungTN and anon's answer is okay, but MartinStettner's way of implementing the hex() function is not really simple, and too dark, considering hex << (int)mychar is already a workaround.

here is my solution to make "<<" operator easier:

```
#include <sstream>
#include <iomanip>

string uchar2hex(unsigned char inchar)
{
  ostringstream oss (ostringstream::out);
  oss << setw(2) << setfill('0') << hex << (int)(inchar);
  return oss.str();
}

int main()
{
  unsigned char a = 131;
  std::cout << uchar2hex(a) << std::endl;
} 
```

It's just not worthy implementing a stream operator :-)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-03-13T14:55:37.913

I think we are missing an explanation of how these type conversions work.

`char` is platform dependent `signed` or `unsigned`. In x86 `char` is equivalent to `signed char`.

When an integral type (`char`, `short`, `int`, `long`) is converted to a larger capacity type, the conversion is made by adding zeros to the left in case of `unsigned` types and by sign extension for `signed` ones. Sign extension consists in replicating the most significant (leftmost) bit of the original number to the left till we reach the bit size of the target type.

Hence if I am in a `signed char` by default system and I do this:

```
char a = 0xF0; // Equivalent to the binary: 11110000
std::cout << std::hex << static_cast<int>(a); 
```

We would obtain `F...F0` since the leading `1` bit has been extended.

If we want to make sure that we only print `F0` in any system we would have to make an additional intermediate type cast to an `unsigned char` so that zeros are added instead and, since they are not significant for a integer with only 8-bits, not printed:

```
char a = 0xF0; // Equivalent to the binary: 11110000
std::cout << std::hex << static_cast<int>(static_cast<unsigned char>(a)); 
```

This produces `F0`

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-23T14:00:42.350

I'd do it like MartinStettner but add an extra parameter for number of digits:

```
inline HexStruct hex(long n, int w=2)
{
  return HexStruct(n, w);
}
// Rest of implementation is left as an exercise for the reader 
```

So you have two digits by default but can set four, eight, or whatever if you want to.

eg.

```
int main()
{
  short a = 3142;
  std:cout << hex(a,4) << std::endl;
} 
```

It may seem like overkill but as Bjarne said: "libraries should be easy to use, not easy to write".

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-02-02T15:23:52.637

I would suggest:

```
std::cout << setbase(16) << 32; 
```

Taken from: [http://www.cprogramming.com/tutorial/iomanip.html](http://www.cprogramming.com/tutorial/iomanip.html)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-05-07T02:27:10.737

You can try the following code:

```
unsigned char a = 0;
unsigned char b = 0xff;
cout << hex << "a is " << int(a) << "; b is " << int(b) << endl;
cout << hex
     <<   "a is " << setfill('0') << setw(2) << int(a)
     << "; b is " << setfill('0') << setw(2) << int(b)
     << endl;
cout << hex << uppercase
     <<   "a is " << setfill('0') << setw(2) << int(a)
     << "; b is " << setfill('0') << setw(2) << int(b)
     << endl; 
```

Output:

**`a is 0; b is ff`**

**`a is 00; b is ff`**

**`a is 00; b is FF`**

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-05-16T09:18:12.227

I use the following on win32/linux(32/64 bit):

```
#include <iostream>
#include <iomanip>

template <typename T>
std::string HexToString(T uval)
{
    std::stringstream ss;
    ss << "0x" << std::setw(sizeof(uval) * 2) << std::setfill('0') << std::hex << +uval;
    return ss.str();
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-03-13T04:54:08.843

I realize this is an old question, but its also a top Google result in searching for a solution to a very similar problem I have, which is the desire to implement arbitrary integer to hex string conversions within a template class. My end goal was actually a `Gtk::Entry` subclass template that would allow editing various integer widths in hex, but that's beside the point.

This combines the unary `operator+` trick with `std::make_unsigned` from `<type_traits>` to prevent the problem of sign-extending negative `int8_t` or `signed char` values that occurs in [this answer](https://stackoverflow.com/a/28355222/942746)

Anyway, I believe this is more succinct than any other generic solution. It should work for *any* signed or unsigned integer types, and throws a compile-time error if you attempt to instantiate the function with any non-integer types.

```
template < 
  typename T,
  typename = typename std::enable_if<std::is_integral<T>::value, T>::type
>
std::string toHexString(const T v)
{ 
  std::ostringstream oss;
  oss << std::hex << +((typename std::make_unsigned<T>::type)v);
  return oss.str();
} 
```

Some example usage:

```
int main(int argc, char**argv)
{
  int16_t val;
  // Prints 'ff' instead of "ffffffff". Unlike the other answer using the '+'
  // operator to extend sizeof(char) int types to int/unsigned int
  std::cout << toHexString(int8_t(-1)) << std::endl;

  // Works with any integer type
  std::cout << toHexString(int16_t(0xCAFE)) << std::endl;

  // You can use setw and setfill with strings too -OR- 
  // the toHexString could easily have parameters added to do that.
  std::cout << std::setw(8) << std::setfill('0') << 
    toHexString(int(100)) << std::endl;
  return 0;
} 
```

**Update:** Alternatively, if you don't like the idea of the `ostringstream` being used, you can combine the templating and unary operator trick with the accepted answer's struct-based solution for the following. Note that here, I modified the template by removing the check for integer types. The `make_unsigned` usage might be enough for compile time type safety guarantees.

```
template <typename T>
struct HexValue 
{
  T value;
  HexValue(T _v) : value(_v) { }
};

template <typename T>
inline std::ostream& operator<<(std::ostream& o, const HexValue<T>& hs)
{
  return o << std::hex << +((typename std::make_unsigned<T>::type) hs.value);
}

template <typename T>
const HexValue<T> toHex(const T val)
{
  return HexValue<T>(val);
}

// Usage:
std::cout << toHex(int8_t(-1)) << std::endl; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-11-13T16:56:28.603

If you're using prefill and signed chars, be careful not to append unwanted 'F's

`char out_character = 0xBE; cout << setfill('0') << setw(2) << hex << unsigned short(out_character);`

prints: ffbe

using int instead of short results in ffffffbe

To prevent the unwanted f's you can easily mask them out.

`char out_character = 0xBE; cout << setfill('0') << setw(2) << hex << unsigned short(out_character) & 0xFF;`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-11-01T12:50:46.207

I'd like to post my re-re-inventing version based on @FredOverflow's. I made the following modifications.

fix:

*   Rhs of `operator<<` should be of `const` reference type. In @FredOverflow's code, `h.x >>= 4` changes output `h`, which is surprisingly not compatible with standard library, and type `T` is requared to be copy-constructable.
*   Assume only `CHAR_BITS` is a multiple of 4\. @FredOverflow's code assumes `char` is 8-bits, which is not always true, in some implementations on DSPs, particularly, it is not uncommon that `char` is 16-bits, 24-bits, 32-bits, etc.

improve:

*   Support all other standard library manipulators available for integral types, e.g. `std::uppercase`. Because format output is used in `_print_byte`, standard library manipulators are still available.
*   Add `hex_sep` to print separate bytes (note that in C/C++ a 'byte' is by definition a storage unit with the size of `char`). Add a template parameter `Sep` and instantiate `_Hex<T, false>` and `_Hex<T, true>` in `hex` and `hex_sep` respectively.
*   Avoid binary code bloat. Function `_print_byte` is extracted out of `operator<<`, with a *function parameter* `size`, to avoid instantiation for different `Size`.

More on binary code bloat:

As mentioned in improvement 3, no matter how extensively `hex` and `hex_sep` is used, only two copies of (nearly) duplicated function will exits in binary code: `_print_byte<true>` and `_print_byte<false>`. And you might realized that this duplication can also be eliminated using exactly the same approach: add a function parameter `sep`. Yes, but if doing so, a runtime `if(sep)` is needed. I want a common library utility which may be used extensively in the program, thus I compromised on the duplication rather than runtime overhead. I achieved this by using compile-time `if`: C++11 `std::conditional`, the overhead of function call can hopefully be optimized away by `inline`.

hex_print.h:

```
namespace Hex
{
typedef unsigned char Byte;

template <typename T, bool Sep> struct _Hex
{
    _Hex(const T& t) : val(t)
    {}
    const T& val;
};

template <typename T, bool Sep>
std::ostream& operator<<(std::ostream& os, const _Hex<T, Sep>& h);
}

template <typename T>  Hex::_Hex<T, false> hex(const T& x)
{ return Hex::_Hex<T, false>(x); }

template <typename T>  Hex::_Hex<T, true> hex_sep(const T& x)
{ return Hex::_Hex<T, true>(x); }

#include "misc.tcc" 
```

hex_print.tcc:

```
namespace Hex
{

struct Put_space {
    static inline void run(std::ostream& os) { os << ' '; }
};
struct No_op {
    static inline void run(std::ostream& os) {}
};

#if (CHAR_BIT & 3) // can use C++11 static_assert, but no real advantage here
#error "hex print utility need CHAR_BIT to be a multiple of 4"
#endif
static const size_t width = CHAR_BIT >> 2;

template <bool Sep>
std::ostream& _print_byte(std::ostream& os, const void* ptr, const size_t size)
{
    using namespace std;

    auto pbyte = reinterpret_cast<const Byte*>(ptr);

    os << hex << setfill('0');
    for (int i = size; --i >= 0; )
    {
        os << setw(width) << static_cast<short>(pbyte[i]);
        conditional<Sep, Put_space, No_op>::type::run(os);
    }
    return os << setfill(' ') << dec;
}

template <typename T, bool Sep>
inline std::ostream& operator<<(std::ostream& os, const _Hex<T, Sep>& h)
{
    return _print_byte<Sep>(os, &h.val, sizeof(T));
}

} 
```

test:

```
struct { int x; } output = {0xdeadbeef};
cout << hex_sep(output) << std::uppercase << hex(output) << endl; 
```

output:

`de ad be ef DEADBEEF`

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-03-23T13:01:43.957

This will also work:

```
std::ostream& operator<< (std::ostream& o, unsigned char c)
{
    return o<<(int)c;
}

int main()
{
    unsigned char a = 06;
    unsigned char b = 0xff;
    std::cout << "a is " << std::hex << a <<"; b is " << std::hex << b << std::endl;
    return 0;
} 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2013-09-04T09:58:04.883

I have used in this way.

```
 char strInput[] = "yourchardata";
char chHex[2] = "";

int nLength = strlen(strInput);
char* chResut = new char[(nLength*2) + 1];
memset(chResut, 0, (nLength*2) + 1);

for (int i = 0; i < nLength; i++)
{
    sprintf(chHex, "%02X", strInput[i]& 0x00FF);    
    memcpy(&(chResut[i*2]), chHex, 2);
}

printf("\n%s",chResut);
delete chResut;
chResut = NULL; 
```

# asp.net - ASP.NET 应用程序服务 - 如何创建新的用户帐户？

> ID：673245
> 
> 赞同：1
> 
> 时间：2009-03-23T12:44:47.837
> 
> 标签：asp.net, asp.net-membership

我一直在玩弄 ASP.NET 应用程序服务。我已经成功实现了身份验证服务、配置文件服务和角色服务，能够登录并获取登录用户的配置文件信息和角色信息。

现在我注意到了一个重大缺陷，即我不知道如何使用应用程序服务创建一个新的用户帐户。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T14:00:03.037

似乎[Application Services](http://msdn.microsoft.com/en-us/library/system.web.applicationservices.aspx) [AuthenticationService](http://msdn.microsoft.com/en-us/library/system.web.applicationservices.authenticationservice.aspx)仅支持验证现有用户。您应该通过应用程序的其他部分（您自己的 Web 服务或网页）启用创建用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T13:01:24.567

我不确定应用程序服务，但我知道您可以使用会员服务创建新用户。

就像这样：

```
Dim mbmr As MembershipUser
mbmr = Membership.CreateUser(newUserName,newUserPwd) 
```

CreateUser 方法有 6 个覆盖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-27T02:48:41.963

我认为没有多少人没有完全理解应用程序服务的作用，因此当他们没有找到暴露在商店购买的 json 端点上的完整的 asp.net 提供程序堆栈时会感到沮丧......

应用服务是公开的。它们旨在提供身份验证和识别设施。

思考...

您的用户未登录。要登录，您必须访问应用程序服务以进行身份​​验证。

对？

您真的认为在该端点上公开会员管理 API（例如创建/删除用户）是明智的吗？

在面向公众的 api 上公开管理功能提出了一个巨大的挑战，以适应一个场景，更不用说有能力促进每个场景，所以也许你可以看到为什么应用程序服务只公开你需要做的事情来识别和验证用户。

# sql - 存储过程和它们使用的表

> ID：673254
> 
> 赞同：3
> 
> 时间：2009-03-23T12:49:18.840
> 
> 标签：sql, sql-server, sql-server-2005

有没有办法通过执行 SQL 查询来知道一个存储过程使用的表是什么？

最好的问候，并感谢您的帮助。

PS：我使用的是 SQL Server 2005。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T12:55:05.830

这篇关于 TechRepublic 的文章

[在 SQL Server 2005 中查找依赖项](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/datacenter/?p=277)

描述了一种方法：

> 本教程将展示如何编写一个查找所有依赖于其他对象的对象的过程。

下面是创建用于查找对象依赖关系的系统存储过程的代码：

```
USE master
 GO
 CREATE PROCEDURE sp_FindDependencies
 (
         @ObjectName SYSNAME,
         @ObjectType VARCHAR(5) = NULL
 )
 AS
 BEGIN
     DECLARE @ObjectID AS BIGINT    

         SELECT TOP(1) @ObjectID = object_id
         FROM sys.objects
         WHERE name = @ObjectName
         AND type = ISNULL(@ObjectType, type)    

     SET NOCOUNT ON ;    

       WITH DependentObjectCTE (DependentObjectID, DependentObjectName, ReferencedObjectName, ReferencedObjectID)
         AS
         (
         SELECT DISTINCT
                sd.object_id,
                OBJECT_NAME(sd.object_id),
                ReferencedObject = OBJECT_NAME(sd.referenced_major_id),
                ReferencedObjectID = sd.referenced_major_id
         FROM    
                sys.sql_dependencies sd
                JOIN sys.objects so ON sd.referenced_major_id = so.object_id
         WHERE   
                sd.referenced_major_id = @ObjectID
         UNION ALL
         SELECT
                sd.object_id,
                OBJECT_NAME(sd.object_id),
                OBJECT_NAME(referenced_major_id),
                object_id
         FROM    
                sys.sql_dependencies sd
             JOIN DependentObjectCTE do ON sd.referenced_major_id = do.DependentObjectID       
         WHERE
                sd.referenced_major_id <> sd.object_id     
         )
         SELECT DISTINCT
                DependentObjectName
         FROM   
                DependentObjectCTE c
 END 
```

> 此过程使用带有递归的公用表表达式 (CTE) 来遍历依赖链，以获取依赖于传递到过程中的对象的所有对象。数据的主要来源来自系统视图 sys.sql_dependencies，它包含数据库中所有对象的依赖信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T12:53:33.027

尝试[sp_depends](http://msdn.microsoft.com/en-us/library/ms189487.aspx)，尽管您可能应该重新编译存储过程以更新数据库中的统计信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T12:54:04.040

查找 sp_depends 系统存储过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T12:54:32.540

我认为只要存储过程和表都在同一个数据库中，那么您可以右键单击 SSMS 中的过程并单击“查看依赖关系”。我不知道对话框背后的查询...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T13:25:28.910

正如其他人指出的那样，您可以使用 Dependancies 存储过程；但是，根据我的经验，这又回到了 SQL Server 2000 上，依赖并不总是可靠的。在某些情况下，它们没有被更新。假设您的架构未加密，您始终可以转到 sysComments 表。

```
declare @crlfSearch varchar(max),@objectSearch varchar(max),@escapeSearch varchar(max)

set @crlfSearch=('%bid' + char(13)+'%')
set @objectSearch='%bid %'
set @escapeSearch ='%[[]Bid]%'
select distinct so.name
from syscomments sc
inner join sysobjects so
on sc.id=so.id
where text like @objectSearch or text like @crlfSearch
or text like @escapesearch 
```

此查询查找您可能需要添加的三种常见情况，但基本上我们会找到表名后面有空格的位置，（这有助于限制表名是另一个表名的一部分的情况），在结束，或在括号内转义。

# java - eclipse RCP 中的 plugin.properties 机制

> ID：673265
> 
> 赞同：7
> 
> 时间：2009-03-23T12:52:47.957
> 
> 标签：java, plugins, rcp, fragment

我的项目包含多个插件，每个插件都包含带有近 20 个翻译的 plugin.properties 文件。MANIFEST.MF 文件定义了存储外部插件字符串的属性文件的名称。

```
Bundle-Localization: plugin 
```

我定义的插件的名称

```
%plugin.name 
```

Eclipse 将在运行时在 plugin.properties 文件中搜索“%plugin.name”。

哪个类读出了 MANIFEST.MF Bundle-Localization 条目，并且在“plugin.properties”文件中搜索了带有起始“%”后缀的字符串？

我想以这种方式查找并修补这些类，我可以首先查看其他一些目录/文件中的“%plugin.name”标识符。通过这些新机制，我可以在我的产品中添加片段并覆盖“plugin.properties”文件中的单行，而无需更改原始插件。通过这些机制，我可以通过添加不同的片段来为多个客户创建一个构建过程。包括客户姓名和他们想要更改的特殊字符串的片段。

我想这样做，因为片段机制只会将文件添加到原始插件中。当插件中存在“plugin.properties”文件时，片段“plugin.properties”文件将被忽略。

**更新 1：**

方法

```
class ManifestLocalization{
...
protected ResourceBundle getResourceBundle(String localeString) {
}
...
} 
```

返回给定语言环境字符串的属性文件的 ResourceBundle。当有人知道我现在如何首先查看片段以获取资源路径时，请发布它。

**更新 2：**

ManifestLocalization 类中的方法

```
 private URL findInResolved(String filePath, AbstractBundle bundleHost) {

        URL result = findInBundle(filePath, bundleHost);
        if (result != null)
            return result;
        return findInFragments(filePath, bundleHost);
    } 
```

搜索属性文件并将其缓存。翻译可以从缓存文件中获取。问题是，完整的文件被缓存而不是单个翻译。

一种解决方案是首先读取片段文件，而不是读取捆绑文件。当两个文件都存在时，将它们合并到一个文件中并将新的属性文件写入磁盘。返回新属性文件的 URL，以便可以缓存新的属性文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T09:06:35.587

虽然我弄错了信息......我遇到了完全相同的问题。该插件未激活两次，我无法访问 Fragments Bundle-Localization 键。

我想在 plugin.properties 中提供我所有的语言翻译（我知道这是不受欢迎的，但管理单个文件要容易得多）。

我（一半）通过使用解决了这个问题

```
public void populate(Bundle bundle) {
    String localisation = (String) bundle.getHeaders().get("Bundle-Localization");
    Locale locale = Locale.getDefault();

    populate(bundle.getEntry(getFileName(localisation)));
    populate(bundle.getEntry(getFileName(localisation, locale.getLanguage())));
    populate(bundle.getEntry(getFileName(localisation, locale.getLanguage(), locale.getCountry())));
    populate(bundle.getResource(getFileName("fragment")));
    populate(bundle.getResource(getFileName("fragment", locale.getLanguage())));
    populate(bundle.getResource(getFileName("fragment", locale.getLanguage(), locale.getCountry())));
} 
```

并简单地将我的片段本地化文件名称为“fragment.properties”。

这不是特别优雅，但它有效。

顺便说一句，要从片段中获取文件，您需要 getResource，似乎片段文件位于类路径上，或者仅在使用 getResource 时才搜索。

如果有人有更好的方法，请纠正我。

祝一切顺利，

标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T08:12:53.533

```
/**
 * The Hacked NLS (National Language Support) system.
 * <p>
 * Singleton.
 * 
 * @author mima
 */
public final class HackedNLS {
    private static final HackedNLS instance = new HackedNLS();

    private final Map<String, String> translations;

    private final Set<String> knownMissing;

    /**
     * Create the NLS singleton. 
     */
    private HackedNLS() {
        translations = new HashMap<String, String>();
        knownMissing = new HashSet<String>();
    }

    /**
     * Populates the NLS key/value pairs for the current locale.
     * <p>
     * Plugin localization files may have any name as long as it is declared in the Manifest under
     * the Bundle-Localization key.
     * <p>
     * Fragments <b>MUST</b> define their localization using the base name 'fragment'.
     * This is due to the fact that I have no access to the Bundle-Localization key for the
     * fragment.
     * This may change.
     * 
     * @param bundle The bundle to use for population.
     */
    public void populate(Bundle bundle) {
        String baseName = (String) bundle.getHeaders().get("Bundle-Localization");

        populate(getLocalizedEntry(baseName, bundle));
        populate(getLocalizedEntry("fragment", bundle));
    }

    private URL getLocalizedEntry(String baseName, Bundle bundle) {
        Locale locale = Locale.getDefault();
        URL entry = bundle.getEntry(getFileName(baseName, locale.getLanguage(), locale.getCountry()));
        if (entry == null) {
            entry = bundle.getResource(getFileName(baseName, locale.getLanguage(), locale.getCountry()));
        }
        if (entry == null) {
            entry = bundle.getEntry(getFileName(baseName, locale.getLanguage()));
        }
        if (entry == null) {
            entry = bundle.getResource(getFileName(baseName, locale.getLanguage()));
        }
        if (entry == null) {
            entry = bundle.getEntry(getFileName(baseName));
        }
        if (entry == null) {
            entry = bundle.getResource(getFileName(baseName));
        }
        return entry;
    }

    private String getFileName(String baseName, String...arguments) {
        String name = baseName;
        for (int index = 0; index < arguments.length; index++) {
            name += "_" + arguments[index];
        }
        return name + ".properties";
    }

    private void populate(URL resourceUrl) {
        if (resourceUrl != null) {
            Properties props = new Properties();
            InputStream stream = null;
            try {
                stream = resourceUrl.openStream();
                props.load(stream);
            } catch (IOException e) {
                warn("Could not open the resource file " + resourceUrl, e);
            } finally {
                try {
                    stream.close();
                } catch (IOException e) {
                    warn("Could not close stream for resource file " + resourceUrl, e);
                }
            }
            for (Object key : props.keySet()) {
                translations.put((String) key, (String) props.get(key));
            }
        }
    }

    /**
     * @param key The key to translate.
     * @param arguments Array of arguments to format into the translated text. May be empty.
     * @return The formatted translated string.
     */
    public String getTranslated(String key, Object...arguments) {
        String translation = translations.get(key);
        if (translation != null) {
            if (arguments != null) {
                translation = MessageFormat.format(translation, arguments);
            }
        } else {
            translation = "!! " + key;
            if (!knownMissing.contains(key)) {
                warn("Could not find any translation text for " + key, null);
                knownMissing.add(key);
            }
        }
        return translation;
    }

    private void warn(String string, Throwable cause) {
        Status status;
        if (cause == null) {
            status = new Status(
                    IStatus.ERROR, 
                    MiddlewareActivator.PLUGIN_ID, 
                    string);
        } else {
            status = new Status(
                IStatus.ERROR, 
                MiddlewareActivator.PLUGIN_ID, 
                string,
                cause);
        }
        MiddlewareActivator.getDefault().getLog().log(status);

    }

    /**
     * @return The NLS instance.
     */
    public static HackedNLS getInstance() {
        return instance;
    }

    /**
     * @param key The key to translate.
     * @param arguments Array of arguments to format into the translated text. May be empty.
     * @return The formatted translated string.
     */
    public static String getText(String key, Object...arguments) {
        return getInstance().getTranslated(key, arguments);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T09:48:06.807

将片段 plugin.properties 的名称更改为其他名称，例如。片段属性

在您的片段清单中将 Bundle-Localization: 插件更改为 Bundle-Localization: fragment

您的插件将被激活两次，第一次使用 plugin.properties，第二次使用 fragment.properties。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T22:08:58.993

插件激活由 OSGi 运行时 Equinox 处理。但是，我强烈反对尝试修补那里的任何文件以创建特定行为。马克建议的方法似乎是解决您的问题的更明智的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-16T15:08:13.717

一种方法是附加捆绑侦听器，并侦听捆绑的安装（也许还查看已安装的捆绑），并为每个捆绑生成/提供 - 并安装 - 带有所需属性文件的片段。如果这是在应用程序启动之前完成的，这应该会生效。

# command-line - Cygwin - 从“运行命令”静默运行脚本

> ID：673278
> 
> 赞同：40
> 
> 时间：2009-03-23T12:57:32.313
> 
> 标签：command-line, cygwin, silent

我有脚本可以说：

```
C:\foo.bsh 
```

我希望能够通过 windows 运行命令运行此命令：

```
Start -> Run
Windows Key + R 
```

并输入一些像'foo'这样的小东西并按回车键。

但是，我不希望 cmd 提示可见。该脚本对 IDE 进行了一些预处理。我不希望 cmd 提示符在 IDE 进程的生命周期内打开。

我努力了：

1）创建一个bat文件，内容如下：

```
c:\cygwin\bin\bash --login "C:\foo.bsh" (this fails because it keeps a cmd open) 
```

2) 使用 bat_2_exe_converter 将上述 bat 文件转换为 exe（不会使 cmd 静默）

想法？

**编辑：**到目前为止的解决方案建议从实际的 cygwin shell 中键入一些内容。我试图通过在 Windows 运行命令中键入一些简短的内容来获得更快的解决方案。此外，`nohup command; exit`它不会自动杀死该框 - 但是我可以手动杀死它而不杀死 IDE 进程。运行命令接受快捷方式 (.lnk's)、bat's、exe's。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2010-11-18T19:15:50.707

[试试cygwin](https://www.cygwin.com/)的 run.exe 命令。这是一个大安装，一个完整的 Windows 机器的 unix 环境。假设您将它安装在`c:\cygwin\`.

没有什么神秘的，只要运行`c:\cygwin\bin\run.exe <your command here>`，你就会有你的 no dos 窗口执行。

您可以从任何 DOS 窗口运行它（从开始菜单运行 cmd.exe）。您不需要从 cygwin 运行它。

为了使它更容易，请附加`C:\cygwin\bin`到您的 %PATH% 环境变量（我的电脑 → 属性 → 高级 → 环境变量）（感谢 Felipe Alvarez 评论）。

现在你可以输入

```
c:\cygwin\bin\run.exe "C:\foo.bsh" 
```

您必须使用此命令在开始菜单中创建一个链接，以便能够使用 Win-R 运行它。

这是 run 命令的手册页：

```
$ man run
RUN(1)                             run 1.3.0                            RUN(1)

NAME
       run - start programs with hidden console window

SYNOPSIS
       run [ -p path ] command [ -wait ] arguments

       runcommand [ -p path ] [ -wait ] arguments

DESCRIPTION
       Windows  programs  are  either  GUI  programs or console programs. When
       started console  programs  will  either  attach  to an existing console
       or  create a new one. GUI programs can  never attach to an exiting con‐
       sole. There is no way to attach to an existing console but hide  it  if
       started as GUI program.

       run  will  do this for you. It works  as intermediate and starts a pro‐
       gram but makes the console window hidden.

       With -p path you can add path to the PATH environment variable.

       Issuing -wait as first program  argument will make run wait for program
       completition, otherwise it returns immediately.

       The  second  variant  is  for   creating wrappers. If the executable is
       named runcommand (eg runemacs), run will try  to start the program  (eg
       emacs).

EXAMPLES
       run -p /usr/X11R6/bin xterm

       run emacs -wait
       runemacs -wait

       run make -wait

AUTHORS
       Charles S. Wilson

       Harold L Hunt II

       Jehan Bing

       Alexander Gottwald

Version 1.3.0                    November 2005                          RUN(1) 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-06-20T03:06:35.177

您可以使用任一...

```
c:\cygwin\bin\bash -l /path/to/script_to_interpret.sh 
```

...或者...

```
c:\cygwin\bin\bash -l -c /path/to/executable_script.sh 
```

**注意：**该`-l`标志告诉 bash “表现得好像它已被登录直接调用”并使用[Bash Startup Files](https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html#Bash-Startup-Files)。这很重要，因为它会设置您的 $PATH 以及您在启动 cygwin 终端时所依赖的其他内容。如果您不包含`-l`，或者`--login`当您尝试调用除内置 bash 之外的任何内容时，您将得到“找不到命令”。

两者之间的区别就像做...

```
bash script_to_interpret.sh 
```

...和...

```
./executable_script.sh 
```

...在 *nix 中。前者使用 bash 解释脚本。后者执行脚本（仅当它具有 时`chmod +x executable_script.sh`）并根据其[“shebang”](https://unix.stackexchange.com/questions/87560/does-the-shebang-determine-the-shell-which-runs-the-script)行对其进行解释。如果您的可执行文件根本不是脚本，则后一种方法也是您想要做的，例如从源代码编译的 *nix 二进制文件。）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-04-15T23:09:08.253

它一直困扰着我一段时间，我找不到解决方案，但我终于得到了正确的组合。

如果您的 PATH 上有 cygwin，您可以简单地执行以下操作：
`run bash test.js`

如果 cygwin 不在您的路径上，您可以这样做：
`c:\cygwin\bin\run.exe -p /bin bash test.js`

如果您正在寻找对创建的窗口的更多控制（最大化等），它看起来也可以使用`cygstart`。

资料来源：
- neves 上面的回答（尽管我个人认为这还不够）
- [http://cygwin.com/ml/cygwin/2008-09/msg00156.html](http://cygwin.com/ml/cygwin/2008-09/msg00156.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T13:20:46.190

由于脚本仍在运行时终端无法关闭，请尝试以下命令：

```
"nohup C:\foo.bsh; exit" 
```

这样，您的脚本将在后台运行并与终端分离，并且它应该快速退出，以便终端消失。我认为使用这种方法，窗口可能仍然“闪烁”，但结果应该比你得到的要好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-09-02T10:10:17.427

我正在运行 Cygwin64，xwin 服务器链接指向：

C:\cygwin64\bin\run.exe /usr/bin/bash.exe -l -c /usr/bin/startxwin.exe

这会在任务栏上创建一个图标和一个通知。我不喜欢那样。该图标相当无用，通知包含 .XWinrc 中的所有菜单选项。

所以...我编写了一个 .vbs 脚本以静默运行此命令并使图标消失：

```
Set objShell = CreateObject("WScript.Shell")
objShell.Run("C:\cygwin64\bin\run.exe /usr/bin/bash.exe -l -c /usr/bin/startxwin.exe"), 0 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T13:27:18.810

另一种不完美的可能性是通过快捷方式运行脚本并将快捷方式的运行选项设置为“最小化”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-31T14:05:41.660

转到您安装 cygwin 的目录（在我的机器上它是 c:/cygwin64/bin） 在那里只需键入“bash.exe”

# python - 如何在 Python 中的 PDF 文档中包含 PDF 中的页面

> ID：673288
> 
> 赞同：5
> 
> 时间：2009-03-23T13:03:12.473
> 
> 标签：python, pdf, pdf-generation, reportlab

我在 Python 中使用 reportlab 工具包生成一些 PDF 格式的报告。我想使用已经以 PDF 格式发布的文档的一些预定义部分包含在生成的 PDF 文件中。是否有可能（以及如何）在 reportlab 或 python 库中实现这一点？

我知道我可以使用其他一些工具，例如 PDF Toolkit (pdftk)，但我正在寻找基于 Python 的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T14:10:39.533

我目前正在使用[PyPDF](http://pybrary.net/pyPdf/ "PyPDF")来读取、编写和组合现有 PDF 和 ReportLab 以生成新内容。使用这两个包似乎比我能找到的任何一个包都好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-22T23:46:43.650

如果您想将现有的 PDF 页面放在您的 Reportlab 文档中，我推荐[pdfrw](http://code.google.com/p/pdfrw/)。与 PageCatcher 不同，它是免费的。

我已经将它用于需要将条形码等添加到现有文档的几个项目中，并且效果很好。项目页面上有几个[示例说明](http://code.google.com/p/pdfrw/wiki/ExampleTools)如何将其与 Reportlab 一起使用。

不过有几点需要注意：

如果源 PDF 包含错误（例如，由于原始程序不完全遵循 PDF 规范），即使 Adob​​e Reader 之类的软件在阅读 PDF 时没有明显问题，pdfrw 也可能会失败。pdfrw 目前不是很容错。

此外，pdfrw 与您放置的 PDF 页面的实际内容完全无关。因此，例如，您将无法使用 pdfrw 检查页面以查看它是否包含右下角的某个文本字符串。但是，如果您*不需要*做类似的事情，那应该没问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T13:17:53.420

ReportLab 有一个插件[——PageCatcher](http://www.reportlab.com/docs/PageCatchIntro.pdf)。

# asp.net - 如何创建用于创建屏幕抓取的书签？

> ID：673296
> 
> 赞同：3
> 
> 时间：2009-03-23T13:07:22.617
> 
> 标签：asp.net, javascript, html

如何创建像这样的书签：http: [//www.vimeo.com/1626505](http://www.vimeo.com/1626505)

我想创建一个相同的，从哪里开始？我想知道这个是如何建立我自己的工作流程的。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T20:44:19.103

书签只是用一行代码编写的 javascript 程序，替换书签上通常的位置属性 ( [http://www.somestuffhere.com](http://www.somestuffhere.com) )。

要构建您自己的书签，我建议您使用[Firebug](http://www.getfirebug.com)： - 在 firebug 中输入您的代码并执行它，直到您想要做的工作， - 然后，删除所有新行以获得一大段代码， - 在您的浏览器中创建一个新书签，并在位置字段中编写`javascript:`并复制粘贴您的单行代码。

您可以通过直接在浏览器位置栏中输入来尝试一个简单的书签：`javascript: alert('this is a very simple bookmarklet');`然后输入 enter 执行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T21:03:08.683

这是我有时使用[的方便的书市构建器。](http://subsimple.com/bookmarklets/jsbuilder.htm)它可以将多行javascript压缩成一行，可以设置为书签的“目标”

（可能有比这更好的，但它对我来说做得很好）

# c# - 强制为所有成员添加 xml 注释

> ID：673298
> 
> 赞同：4
> 
> 时间：2009-03-23T13:07:54.193
> 
> 标签：c#, visual-studio

对于公共成员，我收到警告“缺少公开可见类型或成员的 XML 注释......”。这很棒，但还不够。我想为所有（或至少是内部和受保护的）成员启用此警告。

有没有办法获得有关缺少 xml 注释的警告或信息？运行时是否有任何具有该功能的工具（如 Resharper）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T14:37:24.493

如果您使用 ReSharper，请使用适用于 ReSharper 的 Agent Smith 插件。它是开源的，所以随意看看他们在那里有什么好东西。

[史密斯特工主页](http://www.agentsmithplugin.com/)

[Google Code 上的 Agent Smith 源代码](http://agentsmithplugin.googlecode.com/)

编辑：Agent Smith 在代码编辑器运行时进行 xml 注释验证（因为缺少更好的词）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T13:17:28.897

[StyleCop（又名 MS SourceAnalysis）](http://code.msdn.microsoft.com/sourceanalysis/)可以为您做到这一点。这是[团队的博客](http://blogs.msdn.com/sourceanalysis/)，您可以在其中阅读更多相关信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T13:18:10.160

查看[StyleCop](http://code.msdn.microsoft.com/sourceanalysis/Release/ProjectReleases.aspx?ReleaseId=1425)。它是一个 Microsoft 工具，可以集成到您的构建中，如果不遵循其样式规则，则会生成警告或错误。

它有一条规则：“SA1600：ElementsMustBeDocumented”，看起来可以满足您的要求。

# iphone - 如何在使用 cocos2d 的 iphone 应用程序中使用 MYSQL 数据库连接？

> ID：673300
> 
> 赞同：4
> 
> 时间：2009-03-23T13:08:20.073
> 
> 标签：iphone, cocos2d-iphone

我正在做项目，我需要连接 MYSQL 数据库。我成功在我的项目中连接 SQLite（使用 cocos2d）。但我无法在我的项目中连接 MYSQL 数据库。我任何人都喜欢这样做，而不是帮助我了解如何连接。给我必要的信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T13:18:37.053

您将无法直接从 iPhone 连接到 MySQL。您**必须**使用一些中间层，例如带有 PHP 的 Web 应用程序。

所以，你会有这样的事情：

1.  iPhone 使用 HTTP 向 WebServer 发布请求
2.  连接到 MySQL 数据库的 Web 服务器
3.  Web 服务器向 iPhone 返回数据（XML、纯文本）
4.  iPhone 处理数据

您可以使用此技术来查询和插入/更新/删除数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-11T13:19:13.240

该站点包含为 iphone (arm) 编译的 libmysqlclient.a 文件。

[http://www.eval-art.com/2008/09/05/libmysqlclient-for-iphone-2/](http://www.eval-art.com/2008/09/05/libmysqlclient-for-iphone-2/)

# iphone - 如何在iphone中保存密码？

> ID：673305
> 
> 赞同：2
> 
> 时间：2009-03-23T13:08:57.140
> 
> 标签：iphone

我需要创建一个 iPhone 应用程序...它将与网站通信...所以它需要用户名和密码...现在我需要知道如何在 iphone 中保存用户名和密码...我已经使用过 NSuserdefaults ...但这并没有解决我的 pblm ....我还需要恢复视图...从用户退出应用程序的位置...所以我请求您帮助我？

问候和感谢您的支持，

赛姆

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-04-08T14:18:05.420

我对在 plist 文件或 NSUserDefaults 等纯文本文件中保存安全数据（用户名/密码）有点偏执。

Apple 提供钥匙串服务来存储安全数据。稍微复杂一点，查看文档[Keychain Services Tasks for iPhone OS](http://developer.apple.com/Mac/library/documentation/Security/Conceptual/keychainServConcepts/iPhoneTasks/iPhoneTasks.html#//apple_ref/doc/uid/TP30000897-CH208-SW1)

他们还提供[通用钥匙串应用程序](http://developer.apple.com/iphone/library/samplecode/GenericKeychain/Introduction/Intro.html)供您探索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-14T10:54:53.727

我最近做的应用程序中有一个注销功能。

我有一个层次结构：

```
 "BaseUITableViewController
            ^
            |
 "Any subclass of UITAbleView Controller used in project." 
```

所有这些子类都有一个“注销”按钮，调用注销服务的方法是在基类中编写的。

一旦注销请求的响应有效并且会话被终止，我就会调用以下方法（与上述文本相比，您感兴趣的是:)）

```
-(void)gotoMainScreenOnLogout
{
    self.navigationController.navigationBarHidden = YES;//to make the previous view invisible 
    self.navigationController.toolbarHidden=YES;        //27 JUNE UPDATE
    [self.view removeFromSuperview];                    //27 JUNE UPDATE

//  MYAPPViewController *homeViewController = [[MYAPPViewController alloc]initWithNibName:@"MYAPPViewController" bundle:nil];
MYAPP_LoginUIVIewController *homeViewController =[[MYAPP_LoginUIVIewController alloc] initWithNibName:@"MYAPP_LoginUIVIewController" bundle:nil];
UINavigationController *nc = [[UINavigationController alloc]initWithRootViewController:homeViewController ];
[nc.navigationBar setBarStyle:UIBarStyleBlackOpaque];
//
UIWindow *MYAPP_window = [[[UIApplication sharedApplication] windows]objectAtIndex:0];
CATransition *transition = [CATransition animation];
transition.duration = 0.8;
transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
transition.type = kCATransitionMoveIn;
transition.subtype = kCATransitionFade;
transition.delegate = self;
//...
[MYAPP_window.layer addAnimation:transition forKey:nil];
[MYAPP_window removeAllSubviews]; // not needed anymore
[MYAPP_window addSubview:nc.view];
[homeViewController release]; 
```

}

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T13:15:55.517

您可以将密码存储在常规文件中，也可以将其存储在 SQLite 数据库中。

# seo - Plone CMS (Zope) 中的 301 重定向

> ID：673316
> 
> 赞同：1
> 
> 时间：2009-03-23T13:16:25.920
> 
> 标签：seo, plone, zope

我正在运行一个托管在 Apache 和 Plone（基于 Zope）上的网站。我的问题是我有以下网址的重复内容：

www.site.com www.site.nl/en www.site.com/nl

以此类推，每个页面都显示相同的内容。

Google 网站管理员工具还会报告以下格式的网站重复：

www.site.nl/news www.site.nl/news/

注意尾部的斜杠。

解决此问题的最佳方法是什么（将 301 重定向到正确的 url）？我可以在 Plone 源中执行此操作吗？还是我应该使用规范标签？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T13:29:26.560

Best place to solve it is in your apache configuration.

1.  Duplicate sites: choose one and permanently redirect the rest. For me, all www.reinout.vanrees.org traffic is redirected to reinout.vanrees.org.
2.  Trailing slashes: redirect URLs ending in / to their non-slash equivalents.

For (1), use this as an example:

`<VirtualHost *>`

`ServerName www.reinout.vanrees.org`

`Redirect permanent / http://reinout.vanrees.org/`

`</VirtualHost>`

For (2): you probably have big "virtualhostmonster" rewriterule at the end of your apache config. Copy/paste that line and use `^(.*)/$` instead of `^(.*)` in the first one. That effectively strips trailing slashes.

# vb.net - 我可以在设计时更改继承控件的属性吗？

> ID：673319
> 
> 赞同：4
> 
> 时间：2009-03-23T13:17:39.490
> 
> 标签：vb.net, visual-studio, inheritance, visual-inheritance

我正在使用视觉继承，想知道是否有办法在设计时更改继承控件的属性，最好是在表单设计器中。如果没有，那么在设计器代码中。

我在基类中将控件声明为 Public。我可以在子表单代码中访问它，但不能在表单设计器中访问它。这是不可能的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T17:27:34.790

在视觉工作室中存在视觉继承的限制。不幸的是，派生的表单\用户控件不能修改包含基础中的集合的控件，即 DataGridViewRows、ToolStrips、ListViewColumns 等。

[微软错误报告](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=123288)

在某些情况下有办法解决这个问题。在基类中创建一个受保护的属性，该属性公开您希望修改的控件的确切属性（DataGridView.BackgroundColor 或 ListView.Columns）。

您的基本表单*应该*能够访问此属性以更改所需的组件。我已经成功地为 ListView.Columns 和 DataGridView.rows 完成了此操作，但是 ToolStrip.Items 不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T15:15:30.610

它似乎只适用于某些控件，但不是全部，我不明白为什么。在我的基本表单上，我有一个 TabControl，其中包含一个 ComboBox、一个 ToolStrip 和一个 DataGridView。它们都设置为 Public，但我只能修改 ComboBox 的属性，而不能修改其他两个控件。

我不知道为什么会这样。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-23T14:38:23.507

您需要更改控件的可见性。将控件属性Modifiers 设置为public 并重新编译项目，然后您可以更改继承控件的属性。

# ajax - Scriptaculous 自动完成器问题

> ID：673321
> 
> 赞同：1
> 
> 时间：2009-03-23T13:17:46.103
> 
> 标签：ajax, autocomplete, scriptaculous

在 Scriptaculous Ajax 自动完成器中，它默认选择第一个条目。我如何阻止它默认选择第一个选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T14:04:38.707

在Scriptaculous 库的**controls.js中，第 286 行：更改“this.index = 0;”** 到“this.index = -1;”。这将解决您的问题。

{ autoSelectFirst: false } 中没有选项是很痛苦的。希望在未来的版本中:)

另一方面，您可能想看看：[http ://docs.jquery.com/Plugins/Autocomplete](http://docs.jquery.com/Plugins/Autocomplete)

这使您可以禁用开箱即用的选择第一个选项。

# asp.net-mvc - ASP.net MVC - ViewModel 对象和会话变量

> ID：673324
> 
> 赞同：2
> 
> 时间：2009-03-23T13:17:56.603
> 
> 标签：asp.net-mvc, session, viewmodel

假设我有以下情况：

*   分页视图显示具有以下路由的联系人列表：联系人/索引/页面/2。
*   View 获取其分页数据 ViewModel 对象。
*   View 还从 ViewModel 中获取其过滤器属性，例如 Contact Category。

我想将页码和过滤器属性存储在某处，以便当用户返回联系人/索引页面时，应用相同的页码和过滤器。

将这些属性存储在 Session 变量中是一种好习惯吗？ViewModel 是否应该处理这些 Session 变量？

有没有另一种方法来解决这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-06T15:42:50.830

如果您想在从另一个页面返回后拥有相同的过滤器/页面，那么您必须使用会话，没有其他更好的方法

# c# - 组装成字节

> ID：673330
> 
> 赞同：6
> 
> 时间：2009-03-23T13:19:28.127
> 
> 标签：c#, .net, assemblies

我的场景 - 我正在尝试将程序集文件从服务器发送到客户端（通过直接 TCP 连接）。但主要问题是 - 我如何将此程序集转换为可以轻松传输的字节？我使用以下 -

```
byte[] dllAsArray;
using (MemoryStream stream = new MemoryStream())
{
    BinaryFormatter formatter = new BinaryFormatter();
    formatter.Serialize(stream,loCompiled.CompiledAssembly);
    dllAsArray = stream.ToArray();
} 
```

但是当我使用 -

```
Assembly assembly = Assembly.Load(dllAsArray); 
```

我得到一个例外 -

> 无法加载文件或程序集“从代码生成器服务器加载的 165 字节，版本 = 1.0.0.0，文化 = 中性，PublicKeyToken = null”或其依赖项之一。试图加载格式不正确的程序。请帮忙！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T13:21:55.000

那不就是原始的 dll 内容吗，就好像您已将其保存到磁盘一样？即相当于`File.ReadAllBytes`？

听起来好像生成了 dll - 你可以将它保存在任何地方吗？（临时区域、内存流等）？

**编辑**由于您似乎正在使用 code-dom，请尝试使用`PathToAssembly`（在编译器结果上）和`File.ReadAllBytes`（或类似的流式传输机制）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T13:25:40.343

只需通过 ReadAllBytes 加载文件并通过 WriteAllBytes 写入。byte[] 可以通过网络传输。

```
// Transfer to byte[]
byte[] data = System.IO.File.ReadAllBytes(@"C:\ClassLibaryOne.dll");

// Write to file again
File.WriteAllBytes(@"C:\ClassLibaryOne.dll", data); 
```

**编辑**：如果您使用 AssemblyBuilder 创建您的 dll，您可以使用 .Save(fileName) 将其保存到您的硬盘驱动器之前。

```
AssemblyBuilder a = ...
a.Save("C:\ClassLibaryTwo.dll); 
```

# asp.net-mvc - ASP.NET MVC：找不到视图“登录”或其主视图

> ID：673331
> 
> 赞同：1
> 
> 时间：2009-03-23T13:20:10.997
> 
> 标签：asp.net-mvc, deployment, iis-6

我正在尝试将我的 ASP.NET MVC 应用程序部署到新环境中，但遇到了这个错误：

```
The view 'Login' or its master could not be found. The following locations were searched:
~/Views/Account/Login.aspx
~/Views/Account/Login.ascx
~/Views/Shared/Login.aspx
~/Views/Shared/Login.ascx 
```

我已经验证 ~/Views/Account/Login.aspx 存在。

服务器是运行 IIS 6 的 Windows 2k3。我们没有使用通配符映射，而是使用文件扩展名。这个相同版本的站点在其他 2 个环境中运行良好，两者都具有类似的设置（2k3 和 IIS 6）。

这可能是权限问题还是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T14:03:39.457

我是一个傻瓜。我的母版页没有复制到新服务器。到了那里，一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T13:36:48.960

请注意 MS 在 RC1 中将 LogIn 更改为 LogOn（注意 O）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T13:41:59.417

检查一致性。

如果文件 ~/Views/Account/Login.aspx 存在，请检查控制器帐户中是否存在名为 Login 的操作。

您也可以重建和重新部署您的应用程序。

# c# - 分配给不同子类类型的通用属性和方法

> ID：673335
> 
> 赞同：0
> 
> 时间：2009-03-23T13:21:15.127
> 
> 标签：c#, multiple-inheritance

我正在构建自己的基本用户界面类。在它们上，我希望它们都具有相似的“通用”属性和方法。我可以定义一个接口类，但接口似乎只允许抽象方法，没有属性。

我不想将完全相同的代码复制到每个类，但不知道如何实现... 例如：我希望这些常见的东西适用于按钮、文本框、复选框、列表框等用户控件。

建议？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T13:24:41.780

在这种情况下，我通常使用抽象类。创建您的基本抽象类，然后从您的新控件继承它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T13:25:08.863

您可以在接口上定义属性：[接口属性](http://msdn.microsoft.com/en-us/library/64syzecx(VS.80).aspx)

```
public interface ISampleInterface
{
    // Property declaration:
    string Name
    {
        get;
        set;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T13:26:21.713

您可以在接口中声明一个属性，如下所示：

```
public interface IMyInterface
{
   string Name { get; set; }
   int Age { get; set; }
} 
```

但是，在这种情况下，听起来抽象类会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T13:26:36.923

绝对可以在接口上指定属性

```
interface IFoo {
  string Name { get; set; } 
  string Age { get; } // Read Only
} 
```

但否则你是对的。接口没有指定任何行为，因此只能定义“抽象”方法和属性。必须在每个实施者上完成实施。这就是接口灵活性所付出的代价。

如果所有子类之间的行为确实相同，那么我通常会选择一个抽象类。或者经常是组合。即定义一个接口和一个实现该接口的基本实现。

```
class Foo : IFoo { 
  private string _name;
  public Name { get { return _name; } set { _name = value; } }
  public Age { get { return 42; } }
} 
```

这使您可以灵活地选择使用接口用于由于某种原因不能从 Foo 派生的类的快速实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T13:27:09.637

.Net 不允许多重继承，但您可以使用“继承层次结构”来组织您的基类。这就是 .Net 本身的布局方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T13:32:34.930

我自己来自 C++ 背景，允许和可扩展地使用多继承，所以我经常遇到和你一样的问题。您需要做的第一件事是阅读混音 - 在这里您会发现自己一直在使用它们，而从未命名它们。第二步是在你需要的时候开始识别你的mixin，你会经常发现你还不如通过组合来使用它们。第三步是使用组合来实现它们......是的，我也讨厌这个，但如果你想去 .NET（或 Java 或......），就没有办法了：）

你应该使用继承的不是你的混入，而是真正识别你的项目的东西。我建议查看一些常用控件（文本框等）的 .NET 层次结构以获得一些灵感。

祝你好运

# asp.net - Response.WriteFile("mymenu.aspx") 错误？

> ID：673338
> 
> 赞同：0
> 
> 时间：2009-03-23T13:21:56.373
> 
> 标签：asp.net

我正在使用`Response.WriteFile("mymenu.aspx")`将纯文本文件写入`MasterPage`. 不幸的是，它还打印出一个由方形字符表示的未知字符。菜单文件内容如下：

```
<ul>
  <li><a href="Accounts">Accounts</a></li>
</ul> 
```

方形字符是导致我的菜单显示不正确的原因，将其向下推了大约 20 像素。我测试了只将 HTML 放在母版页中而不是包含文件，它工作正常，这意味着它必须归结为`Response.WriteFile`函数。我想没有其他人遇到过这个问题吗？

**编辑**：我也尝试了以下方法，只是为了确保我没有做任何愚蠢的事情并且文件不包含任何狡猾的东西。

```
<%
   Dim tw As New System.IO.StreamReader(Server.MapPath("menu.aspx"))
   For Each s As String In tw.ReadToEnd
      Response.Write(s)
   Next
%> 
```

有效。但这仍然不能解释 Response.WriteFile 行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T13:30:09.897

This sounds like a character encoding issue. Is this file in the same encoding as the page your using it from?

# Edit

Open the file up in a hex editor make sure there are no weird characters in there.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T13:35:32.503

Have a look at your text file in an editor that will show all characters including carriage returns, line feeds etc. (Notepad++ is my choice). File may have an unusual eof marker or other encoding issue from the software that created the file.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-26T03:10:07.773

我测试了您的代码，它为我正确呈现。

我以前见过 ASP.NET 在 WebMethods 中更改传入的 XML 字符串。在响应之前将文本保存到磁盘上的文件中。写入以进行比较。检查您的 CSS 以了解您的 LI 样式。

# asp.net - 带有自定义子元素的 ASP.NET 中的自定义元素

> ID：673339
> 
> 赞同：15
> 
> 时间：2009-03-23T13:22:55.827
> 
> 标签：asp.net, custom-controls

我知道可以使用用户控件在 ASP.NET 中定义自定义标签。但据我所知，您只能为这些控件添加属性。我希望能够嵌入更复杂的数据，这有点简单：

```
<myControls:MyGraph id="myGraph1" runat="server">
   <colors>
     <color>#abcdef</color>
     <color>#123456</color>
   </colors>
</myControls:MyGraph> 
```

这在 ASP.NET 中可能吗？我应该尝试扩展 ListView 吗？还是有更好更正确的解决方案？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-23T14:48:28.210

这当然是可能的。对于您的示例，类将如下所示：

```
[ParseChildren(true)]
class MyGraph : WebControl {
    List<Color> _colors = new List<Color>();
    [PersistenceMode(PersistenceMode.InnerProperty)]
    public List<Color> Colors {
        get { return _colors; }
    }
}

class Color {
    public string Value { get; set; }
} 
```

实际的标记是：

```
<myControls:MyGraph id="myGraph1" runat="server">
   <Colors>
     <myControls:Color Value="#abcdef" />
     <myControls:Color Value="#123456" />
   </Colors>
</myControls:MyGraph> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-12T11:04:52.020

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;

namespace ComponentDemo
{
    [ParseChildren( true )]
    public class MyGraph : System.Web.UI.WebControls.WebControl
    {
        private List<Color> _colors;

        public MyGraph() : base() { ;}

        [PersistenceMode( PersistenceMode.InnerProperty )]
        public List<Color> Colors
        {
            get 
            {
                if ( null == this._colors ) { this._colors = new List<Color>(); }
                return _colors; 
            }
        }
    }

    public class Color
    {
        public Color() : base() { ;}
        public string Value { get; set; }
    }
}

<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="ComponentDemo._Default" %>
<%@ Register Assembly="ComponentDemo" Namespace="ComponentDemo" TagPrefix="my" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <my:MyGraph runat="server">
            <Colors>
                <my:Color Value="value1" />
                <my:Color Value="value2" />
                <my:Color Value="value3" />
                <my:Color Value="value4" />
            </Colors>
        </my:MyGraph>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-12T09:31:14.910

您不能出于此类目的使用 UserControl。如上所述，继承 Control 或 WebControl。

# powerpoint - 使用代码/脚本/定义在 PowerPoint 中创建自定义形状或连接器

> ID：673347
> 
> 赞同：1
> 
> 时间：2009-03-23T13:25:38.317
> 
> 标签：powerpoint, shapes, openxml, drawingml

PowerPoint 2007 中的形状似乎是内置的 - 有没有办法创建“用户”/“自定义”形状？

我想创建一个自定义连接器，但知道您是否可以创建自定义形状，将来可能会很方便。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-26T19:32:00.297

有几种方法可以做到这一点，但不确定它们是否能满足您的需求。如果您需要将自定义形状添加到“插入形状”下拉列表中，然后使用鼠标光标放置和调整大小，那么我不知道该怎么做。

但是，如果您想定义一个自定义形状，然后以编程方式将其添加到演示文稿中的某个位置，这肯定是可行的。在 VBA 和 VSTO 中，这可以通过对象模型来完成；您可以添加 FreeForm 形状、多段线、曲线等，并且在某些情况下将它们组合成一个形状。我已经完成了一系列我经常需要的 9 角星。

在 Drawing ML 中创建自定义形状/连接器也是可能的。这不是我尝试过的事情，但看起来确实可以做到。为此，您需要进行许多计算，这些计算在 Ecma 规范中有详细记录。我所说的“有据可查”并不是指“容易”——所有的公式都可能很复杂。在连接器的情况下，您似乎需要以编程方式将连接器连接到的形状更改为自定义连接器（形状标识其连接器，如果有的话）。

# java - JAAS 的意义何在

> ID：673355
> 
> 赞同：6
> 
> 时间：2009-03-23T13:27:22.117
> 
> 标签：java, security, jakarta-ee, jaas

如果我必须编写自己的 {whatever}LoginModule 和其他所有内容，那么 JAAS 的意义何在？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-23T13:35:51.630

JAAS 在您的应用程序和底层身份验证机制之间提供了一个抽象层。因此，您可以更改应用程序使用的身份验证机制，而无需更改任何应用程序代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T13:34:01.133

嗯，这就是它的美丽。。

我们在大型抵押贷款申请系统中使用了 JAAS，虽然我们使用了基于属性的 LoginModule，但大型抵押银行使用了自己实现的基于活动目录的 LoginModule，而我们无需更改代码中的某些内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T13:38:11.327

就像任何其他标准一样，您可以免费（或几乎免费）获得可移植性、可插入性和可扩展性。

# c# - DatagridView Checkbox Checked?

> ID：673361
> 
> 赞同：1
> 
> 时间：2009-03-23T13:29:13.923
> 
> 标签：c#, windows

i have a check box in a datagridview windows form and have a event handler cell_Click on cell click i check the datagridview column for a check box it shows true if the cell is selected too(that is the check box is unchecked and only the the datagrid view cell is selected) and the check box is not selected .i tried for the column gettype and found out the type it shows DatagridViewCheckBox but wrong checked values .???

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T13:43:44.107

If I understand you correctly you are saying the checkbox value does not align with the underlying data?

This may well be because the data has been updated and is 'dirty', e.g. it hasn't been committed to the datasource yet. If you add an event handler like this:

```
private void dataGridView1_CurrentCellDirtyStateChanged(object sender, EventArgs e)
{
   if (dataGridView1.CurrentCell is System.Windows.Forms.DataGridViewCheckBoxCell)
   {
      dataGridView1.CommitEdit(DataGridViewDataErrorContexts.Commit);
   }
} 
```

Then that should update the datasource and you'll have the correct checkbox state when you query the cell.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T13:36:41.127

Several things here:

*   the cell click event just means that the user clicked with the mouse button on the data grid view, what you're looking for is probably the CellValueChanged
*   this event will give you the coordinates of the cell that changed. You should check to see if it's in your check box column, then get a reference to the cell and you can check the cell.Value to see if it's true or false. You're not going to find any values on the DataGridViewCheckBoxColumn -- it's going to be at the cell level, and you'll always find the value stored in cell.Value, no matter what type of column it is.

# spring - i18n in ExtJS & Spring MVC

> ID：673364
> 
> 赞同：3
> 
> 时间：2009-03-23T13:29:50.787
> 
> 标签：spring, internationalization, extjs

I've searched a bit on the web but haven't really found a concrete solution to internationalize an application running ExtJS & Spring MVC. Currently (for testing), I define global javascript variables in the JSP's & assign the string literals using JSTL tags.

Has anyone had any success in coming up w/ a clear/clean/flexible solution on this?

Any thoughts are really appreciated. TIA.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-21T12:09:52.617

您应该在应用程序中翻译 3 种类型的字符串

1.  您页面上的静态字符串-> 正如亚当所说，使用模板是个好主意。MVC 可以解决这个问题。因此，您将所有字符串保存在数据库或属性文件中。

2.  发送到 Ext JS 的错误消息字符串 -> 这里有两种解决方案，或者允许 Ext JS 处理它们，所以这意味着在发送回复之前，在 MVC 上有加载翻译的 js 文件或添加翻译您的回复

3.  必须翻译的数据库表中的值，例如汽车零件。在这种情况下，您将密钥保留在 car_parts 表中，并将翻译保留在属性文件或 db 中的翻译表中。

在我当前的应用程序中，我在 MVC 级别执行翻译，并将翻译保存在数据库中。优点是1.翻译逻辑是MVC的一个地方而不是拆分。2.您的翻译在一个地方，每当您在翻译中出现错误时，您不必发布新版本，您只需更新数据库，或者您在应用程序管理员上提供一个表格以自行完成。需要翻译表的备份！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T11:48:20.590

这就是在我的应用程序中完成的方式，它使用 Pylons、Ext JS 和一个名为 Mako 的模板引擎。

我将 JavaScript 文件视为模板。我将每个类保存在一个单独的文件中，并使用我定义的函数*require()*来处理依赖关系。我的服务器处理这些模板，处理依赖关系，将它们连接在一起并压缩。这些模板包含对 gettext-like 函数“_”的调用，例如：

```
window.setTitle("${_('My title')}"); 
```

这些模板是常规 Mako 模板，可以通过类似 gettext 的实用程序进行预处理以创建*.po*文件。我正在使用的*.po生成器（Babel）将找到的字符串的位置作为注释放入**.po*文件中，这对我来说很方便，因为我知道字符串出现在哪里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-26T11:53:09.547

看一下[Spring MVC Ajax 示例](https://src.springframework.org/svn/spring-samples/mvc-ajax/trunk/)frpm Spring。如果您使用 JSP 视图，则可以使用 fmt 标记库和资源包。[如果您使用 Velocity 视图，请按照 Spring文档](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/view.html#views-form-macros)中的说明使用 #springMessage('my.key') 。

# asp.net - ASP.Net 自定义控件与用户控件：这两个是否相同

> ID：673370
> 
> 赞同：5
> 
> 时间：2009-03-23T13:30:40.270
> 
> 标签：asp.net, user-controls

如果它们不同，在什么情况下我们应该决定使用哪一种方法？

另外，ascx 比 aspx 有什么优势？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T13:35:44.047

用户控件是自定义控件的一种形式，可为您提供可视化设计器。当您希望在同一网站中使用可重复使用的控件时，它们非常适合使用。（可以将用户控件创建和打包为单独的程序集，但这超出了这个问题的范围，我知道在 SO 上已被问到）。

自定义控件通常用于指代 Web 控件或复合控件，它是 Web 控件的特殊形式。这些控件没有设计器，通常在与您的 Web 不同的项目中实现，允许它们在许多站点中重复使用。

现在你的第二个问题，ASCX 和 ASPX 是两个不同的东西。ASCX 是用户控件的扩展，而 ASPX 是 ASP.Net 页面。您不能单独使用 ASCX，它必须放在 ASPX 或母版页上。

我喜欢使用用户控件的一种方法是，例如，我有一个非常复杂的页面，它有 7 个选项卡，其中 5 个有网格，其中三个网格是相同的。那么我能做的是为选项卡的内容创建一个单独的用户控件，这现在大大减少了我需要的代码（因为除了数据之外三个网格是相同的）。

此外，它允许多个人在页面的各个部分上工作，并且它帮助我保持一切正常，因为我正在降低页面的复杂性。您不使用用户控件而不是页面，而是将它们与页面结合使用。

# 编辑

您不要在 aspx 上使用 ascx。您使用 ascx 来补充。例如，在我的网站上，每个页面都有相同的页脚，但我不希望每个页面都源自单个母版页。我可以将页脚创建为 acsx 控件并将其放在我的每个母版页中。

另一个例子，我有一个表单可以让用户输入三个不同的日期范围。（我们还有其他形式）。所以我把启用日历按钮的逻辑和一个文本框放在用户控件中打开日历。然后我可以在我的所有 aspx 页面中重用该用户控件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T13:45:15.647

**自定义控件**是完全在代码中构建的控件。优点是您可以将它们放在库中，将图标添加到工具箱和其他精细控制。

**用户控件**更容易做，通常是一种封装事物以简化其他页面或需要在多个页面中使用相同标记的方法。

控件优于常规 aspx 页面的优点是您只需要做部分标记（而不是整个页面）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T13:34:02.507

**用户控件/复合控件**

由其他 ASP.Net 或自定义控件组成的用户控件。它们通常非常简单，并且可以很快创建。它们通常不会跨项目共享，但是有一些[技巧](http://webproject.scottgu.com/CSharp/UserControls/Usercontrols.aspx)可以让你做到这一点。

**自定义控件**

自定义控件是您通过创建从 HTML 输出到设计时支持的所有内容来实现 UI 的控件。自定义控件需要更长的时间来制作。您必须使用 Web.UI.Control 或从子控件（例如文本框）继承。自定义控件被编译为二进制格式，以便更轻松地分发它们。由于它们是编译的，因此可以从 Visual Studio 的工具箱中引用它们。

**在**aspx 页面中使用控件有两个主要优点。封装逻辑和可重用性。

# cocoa-touch - autorelease 什么时候真正导致 Cocoa Touch 中的释放？

> ID：673372
> 
> 赞同：11
> 
> 时间：2009-03-23T13:32:07.707
> 
> 标签：cocoa-touch, memory-management, autorelease, nsautoreleasepool

`autorelease`我知道您在 iOS 上需要小心。我有一个方法返回`alloc`调用者需要的对象，所以在这种情况下——据我所知——我需要`autorelease`在它返回之前发送给被调用者中的对象。

这很好，但是一旦控制权返回到手机（即在我的按钮点击被处理之后），似乎自动释放池被释放了。我怀疑这是应该的，但我想知道这种情况下的最佳做法是什么。

我已经求助于从调用者发送一条`retain`消息，以便该对象不被释放，然后在`dealloc`.

这是最好的方法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-23T14:02:41.177

自动释放池通常在每次运行循环迭代后释放。大致来说，每个 Cocoa 和 Cocoa Touch 应用程序的结构如下：

```
Get the next message out of the queue
Create an autorelease pool
Dispatch the message (this is where your application does its work)
Drain the autorelease pool 
```

您描述的是预期的行为。如果您想保留一个对象比这更长的时间，您需要明确地保留它。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-23T21:20:06.757

使用`autorelease`是一种说法，“对象，我不再想要你了，但我会把你交给可能想要你的人，所以现在不要消失。” 因此，该对象将停留足够长的时间，以便您从方法中返回它或将其提供给另一个对象。当一些代码想要保留对象时，它必须通过`retain`ing 来声明所有权。

请参阅[内存管理指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)，了解正确使用所需的一切`autorelease`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T21:21:33.350

这是[Apple 内存管理文档](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)中提供的示例：

```
– (id)findMatchingObject:(id)anObject 
{ 
    id match = nil; 
    while (match == nil) { 
        NSAutoreleasePool *subPool = [[NSAutoreleasePool alloc] init]; 
        /* Do a search that creates a lot of temporary objects. */ 
        match = [self expensiveSearchForObject:anObject]; 
        if (match != nil) { 
            [match retain]; /* Keep match around. */ 
        } 
        [subPool release]; 
    } 
    return [match autorelease];   /* Let match go and return it. */ 
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T13:43:49.707

是的，这是最好的方法。自动释放实际上仅适用于您知道的代码中的交互。一旦你存储了一个对象，你应该知道持有引用的对象不会死/超出范围，直到你也完成了该对象，或者你需要保留该对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T21:06:03.200

仅保证自动释放的对象将在您的方法结束后释放。毕竟，调用您的方法的方法可以创建自己的池并在您的方法之后立即释放它。

# wpf - 无法使用 TypeConverter 将资源转换为字符串

> ID：673375
> 
> 赞同：0
> 
> 时间：2009-03-23T13:33:34.350
> 
> 标签：wpf, resources, typeconverter

例外：

> 无法将属性“Text”中的值转换为“System.String”类型的对象。无法将“MyApp.Foo”类型的对象转换为“System.String”类型。

XAML：

```
<Window.Resources>
  <my:Foo x:Key="foo"></my:Foo>
</Window.Resources>

<TextBox Text="{DynamicResource foo}"></TextBox> 
```

C＃

```
[TypeConverter(typeof(FooConverter))]
public class Foo
{
    public Foo()
    {}
}

public class FooConverter : TypeConverter
{
    public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType)
    {
        return true;
    }

    public override object ConvertTo(ITypeDescriptorContext context, System.Globalization.CultureInfo culture, object value, Type destinationType)
    {
        return "Foo";
    }
} 
```

怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T13:59:18.187

您不需要在那里使用值转换器而不是类型转换器。

XAML

```
<Window.Resources>  
    <my:Foo x:Key="foo"/>
    <my:FooConverter x:Key="fooConverter />
</Window.Resources>
<TextBox Text="{DynamicResource foo, Converter={DynamicResource fooConverter}}"></TextBox> 
```

C＃

```
public class FooConverter : IValueConverter
{ 
     public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
     {
          return ((Foo)value).ToString();
     }
 } 
```

# iphone - 使用音频队列处理中断

> ID：673381
> 
> 赞同：6
> 
> 时间：2009-03-23T13:35:34.360
> 
> 标签：iphone, audio, streaming

我正在开发一个音频流媒体，并声明了一个中断侦听器，以在发生中断时保存歌曲的状态 - 例如来电或短信。

这是相关代码

在我的 AppDelegate 中，我有这个

```
AudioSessionInitialize (NULL, NULL, interruptionListenerCallback, self);
AudioSessionSetActive(YES); 
```

这就是中断监听器的样子

```
void interruptionListenerCallback (void *inUserData, UInt32 interruptionState) {
// This callback, being outside the implementation block, needs a reference 
//to the AudioPlayer object
MyPlayer *player = (MyPlayer *)inUserData;

if (interruptionState == kAudioSessionBeginInterruption) {
    if ([player audioStreamer]) {
        // if currently playing, pause
        [player pausePlayback];
        player.interruptedOnPlayback = YES;
    }

} else if ((interruptionState == kAudioSessionEndInterruption) && player.interruptedOnPlayback) {
    // if the interruption was removed, and the app had been playing, resume playback
    [player resumePlayback];
    player.interruptedOnPlayback = NO;
} 
```

}

当我接到电话时，会调用中断侦听器，如果用户拒绝通话，也会调用播放恢复方法。但在调用 resumePlayback 方法之前，我在控制台中为 AudioQueueEnqueueBuffer 收到此错误

> 错误：**tca！** 错误整数：**560030580**

有没有人知道如何在流式传输音频文件时正确处理音频中断。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T14:03:14.230

此链接显示了问题所在。可能会帮助某人。

[https://devforums.apple.com/message/31758#31758](https://devforums.apple.com/message/31758#31758)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-26T12:59:42.530

!act 是 kAudioSessionNotActiveError，在 AudioServices.h 中声明，带有注释

“操作失败，因为 AudioSession 未激活。在大多数情况下，首先调用 AudioSessionSetActive(true) 将修复此错误。”

在中断后调用 AudioQueueStart() 时也会出现此错误（正如我今天发现的那样）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T15:22:01.610

在我看来，您将 inUserData 设置为您的 appDelegate 而不是您的播放器。

# css - How can I get a fixed footer like facebook application design

> ID：673386
> 
> 赞同：1
> 
> 时间：2009-03-23T13:36:22.237
> 
> 标签：css

How can I build a fixed footer like facebook application design? Examples with css appreciated.

Duplicate of [Facebook like status div](https://stackoverflow.com/questions/506835/facebook-like-status-div)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T13:39:43.960

One way is given [here](http://sunblu.sh/2008/09/pin-your-footers-with-css/):

In HTML:

```
<div id="container">
  <div id="content"></div>
  <div id="footer"></div>
</div> 
```

In CSS:

```
#container {
  position:absolute;
  min-height:100%;
}

#content {
  margin-bottom:100px; /* same as footer height */
}

#footer {
  position:absolute;
  bottom:0;
  height:100px; /* same as content margin-bottom */
} 
```

**Edit:** That link was based on [this](http://boagworld.com/technology/fixed_footers_without_javascri/) which has some exceptions

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T14:06:57.810

当您滚动时，Facebook 的页脚会保持原位。为此，您需要这样的 HTML：

```
<body>
  <div id="content">
    [content]
  </div>
  <div id="footer">
    [footer]
  </div>
</body> 
```

和这样的CSS：

```
#footer {
  position: fixed;
  bottom: 0;
  width: 100%;
  background: #f00;
} 
```

CSS`position: fixed`指示浏览器保持此元素的位置固定，而不管滚动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T13:45:00.797

I have found CSS Play a really helpful site.

[http://www.cssplay.co.uk/](http://www.cssplay.co.uk/)

More specifically, [http://www.cssplay.co.uk/layouts/](http://www.cssplay.co.uk/layouts/), for layouts.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:22:07.330

[CSS Sticky Footer](http://www.cssstickyfooter.com/)中的更多示例。

编辑：[另一个](http://ryanfait.com/sticky-footer/)*稍微*干净的CSS示例

# iphone - where to store media files in an iPhone app

> ID：673394
> 
> 赞同：4
> 
> 时间：2009-03-23T13:39:35.457
> 
> 标签：iphone, audio, media

I am new to writing iPhone apps, but I have an idea for one. The only problem is that the app I want to write will require a ton of very tiny sound files. I want to organize everything in a hierarchy of folders in the app, but allow the user to add more sounds later, possibly from the music collection or something. Basically, the user needs to be able to add sound files, but the only way I see to have sound files in the app are if they are in the binary app.

**Is anyone familiar with setting up an iPhone app that can access sound or media files from outside the iPhone app?**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T20:18:57.230

您*可以*从应用程序包外部访问文件，它只需位于与您的应用程序关联的文档文件夹中。

这是在文档文件夹中打开文件的示例（我在 Objective-C++ 中编写代码）

```
FILE *fopenForDocument(std::string fileName, const char *mode) {
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    std::string s=[documentsDirectory cStringUsingEncoding:NSASCIIStringEncoding];
    s+="/"+fileName;
    FILE *file = fopen(s.c_str(),mode);
    if (file==NULL) {
        //LOG("failed to open file %s",fileName.c_str());
    }
    //LOG(s.c_str());
    return file;
} 
```

在您的情况下，您的应用程序附带的声音必须在应用程序包中，并且您的用户稍后将添加的声音必须位于文档文件夹中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T13:49:20.223

You can definitely do that. Start reading [this](http://developer.apple.com/iphone/library/referencelibrary/GettingStarted/GS_AudioVideo_iPhone/index.html) document to get familiar with iPhone's audio and video APIs.

You can write all sorts of files into the phone's file system to store the sound files later.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-23T14:05:45.630

您无法访问 iphone 应用程序文件夹之外的文件。

# version-control - 如何在 VSS 中合并分支？

> ID：673399
> 
> 赞同：2
> 
> 时间：2009-03-23T13:40:35.517
> 
> 标签：version-control, visual-sourcesafe

我正在尝试在 Visual SourceSafe 6 中合并一个分支。

在这里，您可以看到“主线”代码库中的错误：

[![替代文字](https://i.stack.imgur.com/CEd8P.png)](https://i.stack.imgur.com/CEd8P.png)

创建了一个修补程序分支，并修复了该文件：

[![替代文字](https://i.stack.imgur.com/VrWEN.png)](https://i.stack.imgur.com/VrWEN.png)

现在是时候将修补程序重新合并到主线开发中了。我选择要合并的文件，然后点击**SourceSafe** → **Merge Branches...**菜单选项：

[![替代文字](https://i.stack.imgur.com/wdMgC.png)](https://i.stack.imgur.com/wdMgC.png)

合并完成后，我确认主线现在包含修补程序，但它不包含：

[![替代文字](https://i.stack.imgur.com/bvXE9.png)](https://i.stack.imgur.com/bvXE9.png)

那么在 Visual SourceSafe 6 中合并分支的正确技术是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T13:43:26.337

选择要合并**到**的文件，即主线文件。然后执行合并分支。在对话框中，选择要合并的文件**，**即修补程序文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-30T23:30:18.887

选择trunk中的文件，执行合并分支，在对话框中选择分支文件，点击合并。

# c# - 在共享主机中在 IIS/WCF 下触发线程/进程的最佳方法

> ID：673402
> 
> 赞同：1
> 
> 时间：2009-03-23T13:41:01.070
> 
> 标签：c#, asp.net, wcf, multithreading, shared-hosting

场景：WCF 服务从客户端接收 XDocument，对其进行处理并在 MS SQL 表中插入一行。

多个客户端可能同时调用 WCF 服务。通话通常不会花费很长时间（几秒钟）。

现在我需要*一些东西*来轮询 SQL 表并以异步方式运行另一组进程。第二个进程不需要回调任何东西，也不需要以任何方式与 WCF 相关。它只需要读取表格并执行一系列方法，也许还需要一个 Web 服务调用（当然，如果有记录的话），仅此而已。使用上述服务的 WCF 服务客户端对此一无所知，也不关心它。

我[在 StackOverflow 中阅读过这个问题，](https://stackoverflow.com/questions/536681/can-i-use-threads-to-carry-out-long-running-jobs-on-iis)而且我也知道 Windows 服务是理想的，但是这个 WCF 服务将托管在共享主机（discountasp 或类似的）上，因此，安装 Windows 服务将不是一个选项（据我所知）。

鉴于架构是固定的（IE：我无法更改表，它来自旧格式，也无法更改 WCF 服务的机制），您对轮询/处理此表有何建议？

我会说我需要它每 10 分钟左右检查一次。它不需要是即时的。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T14:58:08.857

欺骗。将此进程公开为另一个 WCF 服务，并在预定时间从您控制的框中触发 go 命令。

虽然您可以在 WCF 中启动后台线程，或者使用缓存过期作为穷人的调度程序，但当您的应用程序池回收时，这些线程将停止，直到您的网站上的下一次点击并且应用程序池再次启动。至少从您控制的机器发出请求意味着您知道应用程序池将每 10 分钟左右恢复一次，因为您已经向其发送了请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T14:26:28.387

Web 应用程序根本不适合以固定的时间间隔运行某些东西。如果没有请求进入，则应用程序中没有运行代码，如果应用程序有一段时间不活动，IIS 可以决定完全关闭它，直到下一个请求进入。

对于某些应用程序，以特定时间间隔运行某些东西并不重要，只要它最近运行过即可。如果您的应用程序是这种情况，那么您可以跟踪上次轮询表的时间，并为每个请求检查是否有足够的时间再次轮询表。

如果您有权管理数据库，则 SQL Server 中有一个调度程序。如果您有权限，它可以运行查询、存储过程，甚至启动进程（尽管这在共享主机上不太可能）。

如果您需要特定时间间隔的代码，并且您无法访问服务器来调度它或将其作为服务运行，或者无法使用 SQL Server 调度程序，那么它根本不可行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-21T18:49:47.080

让您的应用程序池“始终处于活动状态”并使用您的线程做任何您想做的事情。

# c# - 使用标记为“内部”的外部程序集的接口 (C#)

> ID：673406
> 
> 赞同：0
> 
> 时间：2009-03-23T13:43:03.203
> 
> 标签：c#, .net, reflection, interface

我想实现一个驻留在外部程序集中的接口。但是，该特定接口已被标记为“内部”。有没有办法我仍然可以为我自己的类实现这个接口？

我知道如何在 C# 中使用反射调用私有/内部方法，所以我想在这种情况下也应该使用反射。但是，我不知道怎么做。是的，我知道使用内部/私人的东西通常是不明智的，但在这种情况下，我看不到其他解决方案。

**更新：**我无法以任何方式编辑/更改外部程序集。它应该保持不变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T13:47:54.080

您不能这样做，除非您可以更改包含接口的程序集以添加[InternalsVisibleToAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)，以您自己的程序集为目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T13:48:28.277

使用外部程序集中的 InternalsVisibleToAttribute 指向要向其公开内部类型的程序集。

[http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T14:03:33.997

只是为了获得一些背景知识，大概你想将接口实现传递给这个程序集中的其他东西，这也是内部的，因为否则他们将无法编译这个其他程序集（引用内部是错误的键入公共方法的参数）。

我认为你必须使用 Reflection.Emit 来构建一个实现接口的类型，通过反射获得接口的 Type 对象。不完全是一项简单的任务，结果将是脆弱的，因为您正在挖掘其他人的程序集的内部。

其他选项：

*   拆卸另一个程序集，使用反射器和从程序集构建整个项目的酷插件。
*   与其他组件的所有者交谈并向他们解释您的需求

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T13:51:25.023

如果您有外部程序集的源代码，那么您可以使用[`InternalsVisibleTo`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)指向您程序集的属性对其进行编译。这不是一个完美的解决方案，我经常将它用于单元测试而不是生产代码，但它可能值得一看。

基本上，您需要做的就是将以下内容添加到`AssemblyInfo.cs`项目中的代码文件中：

```
[assembly: InternalsVisibleTo("YourAssembly")] 
```

如果`YourAssembly`是强名称，那么您必须输入程序集的完全限定名称，包括整个公钥（不仅仅是令牌）。

# git - 如何在 Git 中清除本地工作目录？

> ID：673407
> 
> 赞同：748
> 
> 时间：2009-03-23T13:43:19.223
> 
> 标签：git

如何清除 Git 中的工作目录？

* * *

## 回答 #1

> 赞同：1132
> 
> 时间：2009-03-24T00:57:22.787

将特定文件重置为最后提交状态（丢弃特定文件中未提交的更改）：

```
git checkout thefiletoreset.txt 
```

这在`git status`输出中提到：

```
(use "git checkout -- <file>..." to discard changes in working directory) 
```

要将整个存储库重置为上次提交的状态：

```
git reset --hard 
```

要删除未跟踪的文件，我通常只删除工作副本中的所有文件（但不是**文件**`.git/`夹！），然后`git reset --hard`只保留已提交的文件。

更好的方法是使用`git clean`（**警告**：使用`-x`下面的标志将导致 Git 删除被忽略的文件）：

```
git clean -d -x -f 
```

将删除未跟踪的文件，包括目录 ( `-d`) 和 git ( `-x`) 忽略的文件。将`-f`参数替换`-n`为执行试运行或`-i`交互模式，它会告诉您将删除什么。

相关链接：

*   [git-reset 手册页](http://git-scm.com/docs/git-reset)
*   [git-clean 手册页](http://www.kernel.org/pub/software/scm/git/docs/git-clean.html)
*   [git 准备好“清理未跟踪的文件”](http://www.gitready.com/beginner/2009/01/16/cleaning-up-untracked-files.html)（正如 Marko 发布的那样）
*   堆栈溢出问题*[“如何从当前 Git 工作树中删除本地（未跟踪）文件”](https://stackoverflow.com/questions/61212/how-to-remove-local-untracked-files-from-the-current-git-working-tree)*）

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2009-03-23T13:45:34.757

采用：

```
git clean -df 
```

宣传的不是很好，但`git clean`真的很方便。*Git* [Ready`git clean`](http://www.gitready.com/beginner/2009/01/16/cleaning-up-untracked-files.html)对.

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2012-12-19T00:24:08.517

到目前为止，所有答案都保留了本地提交。如果你**真的很**认真，你可以通过以下方式丢弃所有本地提交和所有本地编辑：

```
git reset --hard origin/branchname 
```

例如：

```
git reset --hard origin/master 
```

这使您的本地存储库与源的状态**完全匹配**（未跟踪的文件除外）。

如果您只是在阅读命令后不小心这样做了，而不是它的作用:)，请使用 git reflog 查找您的旧提交。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-01-25T05:23:56.017

您可以创建一个包含空工作副本的提交。

这是一种通常安全、非破坏性的方法，因为它不涉及使用任何蛮力重置机制。首先，您使用 隐藏所有托管内容`git checkout empty`，然后您可以自由地手动查看并删除任何剩余的非托管内容。

```
## create a stand-alone, tagged, empty commit
true | git mktree | xargs git commit-tree | xargs git tag empty

## clear the working copy
git checkout empty 
```

您的工作副本现在应该没有任何托管内容。剩下的就是非托管文件和`.git`文件夹本身。

要重新填充您的工作副本...

```
git checkout master ## or whatever branch you will be using 
```

* * *

如果您是一个有远见的人，您可能会通过将所有内容基于初始空提交来从右脚开始您的存储库......

```
git init
git commit --allow-empty --allow-empty-message -m ""
git tag empty
... 
```

* * *

标记的空工作树有多种用途。目前我最喜欢的是在一组子文件夹下删除根目录`git worktree`。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-10-18T16:02:19.970

要切换到另一个分支，丢弃所有未提交的更改（例如，由于 Git 对行尾的奇怪处理）：

```
git checkout -f <branchname> 
```

我有一个包含数百个已更改文件（但为空`git diff --ignore-space-at-eol`）的工作副本，我无法使用我在此处阅读的任何命令摆脱这些文件，并且`git checkout <branchname>`也无法使用 - 除非给出`-f`(or `--force`) 选项。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-21T18:09:29.353

按照 git status 的建议重置特定文件：

```
git checkout <filename> 
```

重置文件夹

```
git checkout <foldername>/* 
```

# xml - 如何从 XML 文档中删除命名空间？

> ID：673412
> 
> 赞同：2
> 
> 时间：2009-03-23T13:43:55.603
> 
> 标签：xml, apache-flex, actionscript-3, web-services, namespaces

在我的 Flex 应用程序中，我调用了几个返回 XML 的 .NET WebService。但是，这些 Web 服务都返回带有命名空间的 XML。如果不引用命名空间，我就无法读取/解析 XML，这意味着我必须在每个调用 WebService 的类中包含以下代码行：

```
private namespace PCRWebServices = "xxx.somename.web.services";

use namespace PCRWebServices; 
```

我想消除这种静态/硬编码逻辑的需要，只需从 WebService 读取 XML。

有没有办法从 XML 中“删除”命名空间，以便我可以将其作为“普通”XML 文档读取？

我有一个类，我为每个处理结果和错误的 WebService 调用扩展：

```
private function faultHandler(event:FaultEvent):void
{

}

private function resultHandler(event:ResultEvent):void
{
    var resultXML:XML = new XML(event.result);
} 
```

我想在结果处理程序中添加一些逻辑来“转换”XML。有任何想法吗？

这会`trace(resultXML)`返回：

```
<GetDataResult xmlns="xxx.somename.web.services">
  <DataSet>
    <Data>
      <IdNmb>15</IdNmb>
      <NameTxt>Hello</NameTxt>
    </Data>
    <Data>
      <IdNmb>16</IdNmb>
      <NameTxt>World</NameTxt>
    </Data>
    <Status>
      <Status>Success</Status>
    </Status>
    <ReturnCode>
      <ReturnCode>0</ReturnCode>
    </ReturnCode>
  </DataSet>
</GetDataResult> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T17:02:58.650

这是另一个正则表达式解决方案。它将删除多个命名空间，而不仅仅是一个。

```
private function resultHandler(event:ResultEvent):void
{
    var nsRegEx:RegExp = new RegExp(" xmlns(?:.*?)?=\".*?\"", "gim");

    var resultXML:XML = new XML(String(event.result).replace(nsRegEx, ""));        
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T20:57:25.047

我找到了这个解决方法，使用 RegEx 从 XMLString 中删除命名空间。

[http://brianmriley.wordpress.com/2008/03/14/remove-xml-namespaces-in-flex-or-as3/](http://brianmriley.wordpress.com/2008/03/14/remove-xml-namespaces-in-flex-or-as3/)

以下是我的实现方式：

```
private function resultHandler(event:ResultEvent):void
{
    var resultXML:XML = 
        removeDefaultNamespaceFromXML(new XML(event.result));

    // play with your XML here
}

private function removeDefaultNamespaceFromXML(xml:XML):XML
{
    var rawXMLString:String = xml.toXMLString();

    /* Define the regex pattern to remove the default namespace from the 
        String representation of the XML result. */
    var xmlnsPattern:RegExp = 
        new RegExp("xmlns=[^\"]*\"[^\"]*\"", "gi");

    /* Replace the default namespace from the String representation of the 
        result XML with an empty string. */
    var cleanXMLString:String = rawXMLString.replace(xmlnsPattern, "");

    // Create a new XML Object from the String just created
    return new XML(cleanXMLString);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-19T15:10:16.487

试试下面的解决方案。我发现它比用正则表达式替换字符串更好。

```
replaceDefaultNameSpace(src, new Namespace()); //no uri
replaceDefaultNameSpace(src, new Namespace("", "http://uri.com")); //with uri

private function replaceDefaultNameSpace (src:XML, ns:Namespace):void
    {
        var tempNs:Namespace = new Namespace ("temp");
        var node:XML;

        src.addNamespace(tempNs);
        src.setNamespace(tempNs);

        for each (node in src.descendants()) node.setNamespace(tempNs);

        src.addNamespace(ns);
        src.setNamespace(ns);

        for each (node in src.descendants()) node.setNamespace(ns);

        src.removeNamespace(tempNs);

        trace (src.toXMLString());

    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T15:55:45.757

当您指定**使用命名空间**时，您将其设置为默认命名空间，而不是调用它，您可以在尝试访问元素时传递命名空间

```
var myval:String = PCRWebServices::node.@attribute; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-02T10:30:43.493

我不会使用从 xml 中删除名称空间作为字符串的技巧。这是一个丑陋的黑客（更不用说效率低下）。为了避免在代码中对命名空间进行硬编码，您可以做的是询问 xml 对象它的默认命名空间是什么并使用它。像这样：

```
var defaultNS:Namespace = xml.namespace("");  // get default namespace
use namespace defaultNS;  // use default ns 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-14T23:36:36.667

虽然我同意与 XML 交互的适当方式是通过其命名空间对其进行寻址，但当您有意尝试将内容从一个命名空间的 XML 转换或转换为另一个命名空间（例如，FXG 到 MXML）时，有时您必须得到向下和肮脏并将XML作为字符串破解。这绝不是最优雅的，如果有更正确的方法，我愿意接受。不幸的是，根据我的阅读，您似乎无法从 XML 对象中删除默认名称空间或最后一个名称空间。

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/XML.html#removeNamespace%28%29](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/XML.html#removeNamespace%28%29)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-06-20T20:51:45.700

我尝试了这里发布的一些解决方案，但取得了一定的成功。
这对我有用...

```
var myXML:XML = new XML(myString);
for each ( var ns:Namespace in myXML.namespaceDeclarations() ) {
    if (ns.prefix == 'my_namespace_prefix' || ns.uri == 'my_namespace_uri') {
        myXML.removeNamespace( new Namespace(ns.prefix, ns.uri) );
    }
} 
```

您可以省略删除所有命名空间的条件。

我发现创建一个新`Namespace`对象是必要的，因为如果您按`ns`原样传入变量，它似乎被强制转换为一个字符串，该字符串返回`uri`属性，其效果是将前缀留在我的 XML 数据中。

我发现有必要添加下一个代码块，以删除原始命名空间的所有痕迹（运行上述代码在命名空间删除后会产生奇怪的“aaa”命名空间）。

```
myXML.setNamespace('');
for each (var node:XML in myXML.descendants()) {
    node.setNamespace('');
    for each (var attribute:XML in node.attributes()) {
        attribute.setNamespace('');
    }
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-23T16:00:35.103

我记得在这方面遇到了一些问题。不记得我是如何解决的，但我猜 removeNamespace 函数将是一个好的开始。也许是这样的：

```
private function resultHandler(event:ResultEvent):void
{
    var resultXML:XML = new XML(event.result);

    for each( var ns:Namespace in resultXML.namespaceDeclarations() )
        resultXML.removeNamespace(ns);
} 
```

我根本没有测试过代码，只是从我的头顶开始。

您可以在此处阅读更多信息：http: [//help.adobe.com/en_US/AS3LCR/Flash_10.0/XML.html#removeNamespace()](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/XML.html#removeNamespace())

# c# - ASP.net：动态绑定字段

> ID：673415
> 
> 赞同：1
> 
> 时间：2009-03-23T13:44:55.150
> 
> 标签：c#, asp.net

在 GridView 中，我尝试使用公共布尔属性显示一列或另一列：

```
 <Columns>
   ...

    <asp:BoundField Visible="<%= !ShowPurchaseDate %>" DataField="Published" HeaderText="Publicerad" SortExpression="PriceRange" DataFormatString="{0:yyyy.MM.dd}" HtmlEncode="false" />

    <asp:BoundField Visible="<%= ShowPurchaseDate %>" DataField="OrderDate" HeaderText="Köpt" SortExpression="OrderDate" DataFormatString="{0:yyyy.MM.dd}" HtmlEncode="false" />

   ...
  </Columns> 
```

但是我收到一条错误消息，指出无法从包含属性 Visisble 的 <% !ShowPurchaseDate %> 的字符串创建 System.Boolean。

我怎样才能做到这一点？

更新：

<%# !ShowPurchaseDate %> 也不起作用，因为没有进行数据绑定。

使用受保护的功能也不起作用（与属性相同的错误消息）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T13:57:48.130

我通过以下方式解决了它：

```
gridMain.Columns[ShowPurchaseDate ? 3 : 4].Visible = false; 
```

这是最好的解决方案吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T13:47:31.023

在后面的代码中提供一个受保护的方法，该方法将布尔属性作为字符串返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T13:47:52.380

你的代码应该是**<%# !ShowPurchaseDate %>**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T15:19:54.437

你可以尝试调用一个方法而不是像 shouldshowcolumn() 这样的绑定。

# jquery - 是否有 ADO.NET 数据服务 jQuery 插件？

> ID：673423
> 
> 赞同：2
> 
> 时间：2009-03-23T13:47:25.360
> 
> 标签：jquery, plugins, wcf-data-services

ADO.NET 数据服务看起来很酷，我很想将它与 jQuery 支持的 ajax 网站一起使用。

StackOverflow 上的各位大佬知道 jQuery 插件可以简化针对 ADO.NET 数据服务的 CRUD 操作吗？

问候，埃吉尔。

**更新**：事实证明，[ASP.NET AJAX 4.0（目前在预览版 4 中）](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24645)对 ADO.NET 数据服务有很好的支持，看起来它与 jQuery 配合得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T14:09:15.767

jQuery 的开箱即用 getJSON 方法与 ADO.NET 数据服务配合得很好。请记住正确设置内容类型，如此[处所示](https://stackoverflow.com/questions/26620/how-to-set-encoding-in-getjson-jquery/27023#27023)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T14:51:58.790

事实证明，[ASP.NET AJAX 4.0（当前处于预览版 4）](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24645)对 ADO.NET 数据服务的支持非常好，而且看起来它与 jQuery 配合得很好。

# .net - IWindsorContainer 作为类的参数

> ID：673427
> 
> 赞同：8
> 
> 时间：2009-03-23T13:48:18.400
> 
> 标签：.net, inversion-of-control, castle-windsor

我有一个类，我想访问我的 IOC 容器（Windsor），但是我不想保留一个静态的 IWindsorContainer 属性——我希望容器将自身注入到任何需要 IWindsorContainer 的类中构造函数依赖。

我已经用 Unity 完成了这个，但是当我对 Windsor 容器尝试同样的事情时，它告诉我 IWindsorContainer 没有在容器中注册。

我认为我不能只注册 IWindsorContainer => WindsorContainer，因为这将导致容器创建一个新的（或不同的）自身实例以传递给我的类，并且该实例不会注册我的所有其他类型它。我也看不到构造容器的方法，在其中注册所有类型，然后针对 IWindsorContainer 注册它自身的实例——所有注册方法只接受服务和实现的类型——从来没有一个实际的具体实例。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T18:37:48.860

通常，您不想将容器注入您的应用程序组件中。

看到这些问题（这个问题几乎是它们的重复）：

*   [IoC 容器的使用；特别是温莎](https://stackoverflow.com/questions/367178/usage-of-ioc-containers-specifically-windsor)
*   [NInject：你把你对内核的引用保存在哪里？](https://stackoverflow.com/questions/590900/ninject-where-do-you-keep-your-reference-to-the-kernel)
*   [IoC，你把容器放在哪里？](https://stackoverflow.com/questions/109668/ioc-where-do-you-put-the-container)

**顺便说一句**：您可以`IKernel`免费获得注射，您**可以**注册`IWindsorContainer`：

```
container.Register(Component.For<IWindsorContainer>().Instance(container)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:29:26.940

通常，就像 mausch 所说，在将容器传递给组件之前要三思而后行。你**真的**需要它来访问容器吗？

要从容器中提取依赖项，请使用[类型工厂](http://stw.castleproject.org/Windsor.Typed-Factory-Facility.ashx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-19T16:54:09.073

我最近很想这样做。我希望能够在对象的生命周期内创建服务的多个实例。注册工厂会更好，因为对依赖项的需求更清楚。但是为每个服务创建一个工厂似乎很痛苦。

我最终使用了类似本文中的代码：http: [//mikehadlow.blogspot.com/2010/01/10-advanced-windsor-tricks-1a-delegate.html](http://mikehadlow.blogspot.com/2010/01/10-advanced-windsor-tricks-1a-delegate.html)。假设您有一个需要创建 IService 实例的类。这篇文章描述了一种允许您的类依赖于 Func 的技术，您将自动获得特定于该类的工厂。

# c# - C# 为什么我的代码会抛出 io.system.directorynotfound？

> ID：673430
> 
> 赞同：0
> 
> 时间：2009-03-23T13:50:02.967
> 
> 标签：c#, directory

为什么下面的代码会抛出 io.system.directorynotfound 异常？我自己无法重现问题，但我的代码的另一个用户确实看到了它，有什么想法吗？谢谢

```
try
{
  //create path
  string strAppData = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData).ToString() + "\\MyApp\\Data\\logs";
  //check path exists
  if (!System.IO.File.Exists(strAppData))
  {
      System.IO.Directory.CreateDirectory(strAppData);
  }
  System.IO.DirectoryInfo dir = new System.IO.DirectoryInfo(strAppData);
  int count = dir.GetFiles().Length;

  if (count > 100)
  {
      string[] files = System.IO.Directory.GetFiles(strAppData);

      foreach (string file in files)
      {
          System.IO.File.Delete(file);
      }
  }

  this.fileName = fileName;
  // delete the file if it exists
  if (File.Exists(fileName))
  {
      //delete the file
      File.Delete(fileName);
  }

      // write the data to the file
      fs = File.OpenWrite(fileName);
      sWriter = new StreamWriter(fs);

      sWriter.WriteLine(headerText);

      sWriter.Flush();
      sWriter.Close();
}
catch (Exception exp)
{
    throw new Exception(exp.Message);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T13:51:58.220

在检查路径是否存在时，您是否尝试过使用 System.IO.Directory.Exists 而不是 System.IO.File.Exists？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T13:52:32.137

`System.IO.File`您正在使用而不是检查目录是否存在`System.IO.Directory`。它可能适用于您的机器，因为该目录已经存在，因此检查无关紧要。

无论哪种方式，您都需要记住文件系统是易失的。与其检查是否存在，不如尝试打开资源并在失败时处理异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T13:52:47.597

检查目录是否存在，而不是文件...

尽管您正在检查它，并在它不存在时创建它。您不知道他们是否有创建目录的权限。因此，您的 Directory.CreateDirectory 调用很可能也失败了，然后其余代码将失败

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T13:53:23.350

[http://msdn.microsoft.com/en-us/library/system.io.file.exists.aspx](http://msdn.microsoft.com/en-us/library/system.io.file.exists.aspx)

“评论

Exists 方法不应用于路径验证，该方法仅检查路径中指定的文件是否存在。将无效路径传递给 Existsl 将返回 false。"

那是你的错误。您的验证不能确保文件的路径存在

# javascript - how to extract the value of a field in an iframe into the main page

> ID：673431
> 
> 赞同：1
> 
> 时间：2009-03-23T13:50:40.830
> 
> 标签：javascript, iframe

I have an iframe inserted into my main page.

The iframe generates a value which is of the type hidden

I need to extract this value into my main page using a javascript

Can someone please help me with this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T14:00:46.780

如果您在 iframe 中加载的页面与您的主页位于同一域中，您可以通过以下方式访问该页面的 DOM：

```
 window.frames[iframeName].document 
```

而且很容易获得任何元素的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T13:59:14.897

You can access the contents of the iframe from the parent page the following way:

```
var iframe = document.getElementById("iframeId");
var field = iframe.contentWindow.document.getElementById("hiddenFieldId"); 
```

I didn't test it and it's been a while since I've used raw DOM in JavaScript so let me know if it does not work.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T14:09:16.557

如果 iframe 的 url 指向不同的域，那么您可能需要确保 iframe 中文档的域与包含文档的域相同。在尝试读取字段的值之前，在两个文档中运行此代码：

```
document.domain = "example.com"; 
```

如果 iframe 的内容属于与您不同的站点，则您无法使用 javascript 访问它。这是一种安全措施。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T14:20:43.050

用这个
`fram.document.getElementById("name").value`

肯定会奏效

细节 ：

fram = id 给框架
name = id 给框架内的文本框

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T14:37:16.223

如果您的页面和 iframe 内容来自不同的域，这将非常棘手。我最近被迫为此找到一种解决方法，并通过使用 file_get_contents() 对 PHP 脚本的 AJAX 调用来管理它，但它不是非常符合版权或安全......

# c# - Debugging Asp.net application

> ID：673433
> 
> 赞同：1
> 
> 时间：2009-03-23T13:51:03.230
> 
> 标签：c#, asp.net, debugging

My project has 4 layers i need to debug from UI to DAL ,,but when i am debugging,its going only in UI,,can any one tell how can idebug up to Dal

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T13:55:36.387

Are the layers all in separate Solutions? If so use the refrences to the Build\Debug directories to be able to step through.

Also make sure all projects are set the DEBUG under Build-> Configuration Manager

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T13:53:38.933

Does your Solution contain all 4 projects?

Is your ASP.NET application referencing your DLLs as Binaries or as Projects? (check by right-clicking on the web project and selecting Properties | References) Needs to be "Project".

Are all four assemblies/projects set to "Debug" output?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T08:01:49.120

嗨，请先打开您所有的项目并尝试，它会起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T16:05:16.887

如果您只是为各个层引用 dll，请确保您也为 dll 复制了适当的 pdb 文件。

# python - 是否有用于轻松编写可缩放 UI 的 Python 库？

> ID：673434
> 
> 赞同：3
> 
> 时间：2009-03-23T13:51:13.060
> 
> 标签：python, user-interface, opengl, gtk, cairo

我的下一个工作将主要集中在处理在二维可缩放平面或画布上组织时最容易理解的数据，而不是使用列表和属性表单。

该库可以基于 OpenGL、GTK+ 或 Cairo。它应该允许我：

*   用矢量形状和文本构建小部件（甚至可能基于 SVG？）
*   将这些小部件排列在 2D 平面上
*   捕获与小部件相关的事件
*   深入放大小部件以显示其他数据
*   在树中排列小部件
*   流畅地动画小部件

如果它也允许一些数据绑定或模型/视图概念，那也不会受到伤害。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T13:54:34.643

Qt 涵盖了这个...检查 PyQt

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T02:32:42.323

我认为[Clutter](http://www.clutter-project.org/)非常适合您。

从网站：

> Clutter 是一个开源软件库，用于创建快速、视觉丰富和动画的图形用户界面。

Clutter 是用 C 语言编写的，但它有很好的[Python 绑定](http://clutter-project.org/sources/pyclutter/)。

一个非常相似的项目是[Pigment](https://code.fluendo.com/pigment/trac)：

> Pigment 是一个 3D 场景图库，旨在轻松创建丰富的应用程序用户界面。

# c# - 反序列化期间未找到构造函数？

> ID：673444
> 
> 赞同：23
> 
> 时间：2009-03-23T13:54:00.820
> 
> 标签：c#, .net, serialization

给定以下示例：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Runtime.Serialization.Formatters.Binary;
using System.IO;

namespace SerializationTest
{
    [Serializable]
    class Foo : Dictionary<int, string>
    {
    }

    class Program
    {
        static void Main(string[] args)
        {
            Foo foo = new Foo();
            foo[1] = "Left";
            foo[2] = "Right";

            BinaryFormatter formatter = new BinaryFormatter();
            MemoryStream stream = new MemoryStream();

            formatter.Serialize(stream, foo);
            stream.Seek(0, SeekOrigin.Begin);
            formatter.Deserialize(stream);
        }
    }
} 
```

在最后一行中，由于格式化程序找不到 Foo 的构造函数，引发了 SerializationException。这是为什么？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-03-23T13:57:35.010

在类 Foo 中附加以下代码行

```
public Foo() {

}

public Foo(SerializationInfo info, StreamingContext context) : base(info, context) {

} 
```

该类需要一个带有相关序列化参数的构造函数。

# java - Java 代码可以判断它是否在应用服务器中吗？

> ID：673446
> 
> 赞同：4
> 
> 时间：2009-03-23T13:54:22.163
> 
> 标签：java, jakarta-ee, jboss, ejb-3.0, application-server

我可以从 POJO 调用什么来查看代码当前是在 App Server 中还是在 App Server 之外？

像这样的东西（粗略的伪代码）：

```
System.getRunningEnvironment().equals(Environment.Glassfish) 
```

或者

```
System.getRunningEnvironment().equals(Environment.ApplicationServer) 
```

或者

```
System.getRunningEnvironment().equals(Environment.JavaSE) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T17:53:22.743

如果您可以更改 AppServer 初始化脚本（请查看[此链接](http://www.exampledepot.com/egs/java.lang/PropCmdLine.html)）：

在 AppServer 初始化脚本中添加 -DRunningInAppServer=true。

在应用程序初始化脚本中添加 -DRunningInAppServer=false。

然后使用这个方法：

```
public boolean isRunningInAppServer() {

        if ("true".equals(System.getProperty("RunningAppServer"))) {
            return true;
        }
        return false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T14:21:29.057

最简单的方法是检查 Java EE/App Server 特定类的存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T14:40:28.150

我不相信你可以轻而易举地做到这一点。您想区分应用服务器、Web 容器等吗？

确定这一点的原因是什么？让您的 POJO 在不同的环境中表现不同？如果是这样，那么我认为这指向一个不太正确的对象/组件结构，或者至少在对象职责没有明确定义的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T14:07:43.580

我从未使用过应用程序服务器，但也许你可以使用`System.getProperties()`/`System.getProperty(...)`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T15:19:21.537

如果您的应用程序服务器使用一个，请考虑检查当前的 SecurityManager。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-26T16:53:57.413

我认为没有任何方法可以直接确定这一点。是的，正如 SourceRebel 所说，您可以设置系统属性。不过，我个人会避免这样做，因为您会遇到一些隐藏的耦合：您的函数依赖于必须正确设置才能使其工作的系统属性，但是接口中没有明确定义来反映这一点. 我认为您最好只传递一个说明它的参数，并让调用者负责传递正确的参数。那么在函数签名中可以清楚地看到这个参数的存在，任何使用它的人都会有强烈的线索表明他们需要正确设置它。让调用者正确设置它应该是微不足道的，因为大概在调用链中的某个时刻，您要么从桌面应用程序调用，要么从网页调用，

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-05T12:19:03.953

一些应用服务器设置系统属性，例如 JBoss：http: [//community.jboss.org/wiki/JBossProperties](http://community.jboss.org/wiki/JBossProperties)

# sharepoint - SharePoint 用户的 AD 组成员身份

> ID：673450
> 
> 赞同：3
> 
> 时间：2009-03-23T13:55:05.857
> 
> 标签：sharepoint, sharepoint-2007

我的任务是为我们的新网站创建一个 SharePoint Web 部件。它需要知道的一件事是当前用户属于哪些 AD 组（每个站点用户将属于域中的一个或多个特殊安全组。）是否有 SharePoint API 的一部分公开此信息，或者执行我需要直接查询AD吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T13:58:28.503

我会直接做一个 LDAP 查询。这要简单得多，而且 Active Directory 的 LDAP 接口也有很好的文档记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T20:32:34.833

查看这些 .NET 命名空间。

```
System.DirectoryServices
System.DirectoryServices.AccountManagement
System.DirectoryServices.ActiveDirectory 
```

# caching - Entlib Cache.Contains NULL problem

> ID：673455
> 
> 赞同：0
> 
> 时间：2009-03-23T13:56:49.940
> 
> 标签：caching, null, enterprise, contains

I have a combined authorization and menustructure system on our backend. For performance reasons EntLib caching is used in the frontend client (MVC rel 1.0 website, IIS 5.1 local, IIS 6.0 server, no cluster).

Sometimes 'Cache.Contains' will return true, but the contents of the cache is NULL. I know for certain that I filled it correctly, so what can be the problem here?

EDIT: when I set the cache to 1 minute and add the cacheKey 'A_Key', I will see the key coming back when inspecting the CurrentCacheState. When I view CurrentCacheState after 2 minutes, the key is still there. When I execute 'contains', true is returned. When I execute 'contains' again, the cacheKey is gone! Synchronization problem??

Regards, Michel

Excerpt:

```
if (IntranetCaching.Cache.Contains(cacheKey))
{
    menuItems = (List<BoMenuItem>)IntranetCaching.Cache[cacheKey];
}
else
{
    using (AuthorizationServiceProxyHelper authorizationServiceProxyHelper = new AuthorizationServiceProxyHelper())
    {
        menuItems = authorizationServiceProxyHelper.Proxy.SelectMenuByUserAndApplication(APPNAME, userName, AuthorizationType.ENUM_LOGIN);
        IntranetCaching.Add(cacheKey, menuItems);
    }
} 
```

And the cachehelper:

```
public static class IntranetCaching
{
    public static ICacheManager Cache { get; private set; }

    static IntranetCaching()
    {
        Cache = CacheFactory.GetCacheManager();
    }

    public static void Add(string key, object value)
    {
        Cache.Add(
            key
            , value
            , CacheItemPriority.Normal
            , null
            , new Microsoft.Practices.EnterpriseLibrary.Caching.Expirations.AbsoluteTime(TimeSpan.FromMinutes(10)));
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-03T07:46:05.477

感谢迈克尔跟进您自己的问题，我整天都在坚持这一点，我发现如果我尝试从缓存中检索一个项目，这将到期（+ 0 到 25 秒）我将得到一个 NULL 值。Codeplex 在其常见问题解答中发布了一种解决方法（各种）：

> 一个。刷新项目时如何避免从 CacheManager 获取空值？- 间歇性地，您可能会遇到这种情况。要解决此问题，请创建您自己的 ICacheItemExpiration 实现。在 HasExpired() 方法中，实现一个逻辑，该逻辑将检查项目是否已过期，如果已过期，将更新项目的值。此方法应始终返回 false 以使项目不被标记为过期。作为在 HasExpired() 方法中返回 false 的结果，该项目将不会被刷新，并且将包含在该方法中实现的更新值。参考：[链接](http://entlib.codeplex.com/wikipage?title=EntLib%20FAQ&referringTitle=Home)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T08:43:31.200

我收到了埃维诺（Entlib 的创建者）的以下回复：

> 很可能，BackgroundScheduler 还没有执行它的扫描。如果您要检查源代码， Contains 方法仅检查特定键是否存在于内存缓存哈希表中，而在 GetData 方法上，代码首先检查项目是否已过期，如果已过期，则该项目是从缓存中删除。
> 
> Sarah Urmeneta 全球技术与解决方案 Avanade, Inc. entlib.support@avanade.com

该解决方案对我有用。问题仍然存在，当它的结果不能以合理的方式使用时，为什么你可以使用“包含”。

问候，M。

# ruby-on-rails - 如何在 Rails 中为带有单选按钮的帖子分配一个类别？

> ID：673456
> 
> 赞同：4
> 
> 时间：2009-03-23T13:57:01.563
> 
> 标签：ruby-on-rails, forms, radio-button

新手，第一次发帖。

我只是花了大约 4 个小时试图通过单选按钮将一个类别分配给一个帖子（尝试一个常规的博客内容），但无济于事。该关联运行良好，最终我设法让它与一个选择菜单一起工作，但由于某种原因，单选按钮似乎根本不适合这个。

我真的不喜欢为此使用选择菜单，因为我只有 4 个类别，并且必须单击两次才能选择一个类别，因为单击太多。所以我真的很想使用单选按钮。

我检查了[有关该主题的另一个问题](https://stackoverflow.com/questions/623051/radio-buttons-on-rails)并毫无意义地搜索了网络，但它只帮助我得到了更多不同的错误：未定义的方法，AssociationTypeMismatch，0的category_ids，你的名字。所以我今天放弃了，决定创建一个帐户，看看是否有人可以破解这个。任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T14:32:46.267

开始了。在[RailsCasts 第 17 集中](http://railscasts.com/episodes/17-habtm-checkboxes)，Ryan 使用 habtm 和复选框来做这种事情。我将其修改为使用 belongs_to 和单选按钮。谢谢你的练习。

```
> script/generate scaffold category category_name:string
> script/generate scaffold post post_name:string, post_content:text, category_id:integer 
```

后模型

```
Class Post < ActiveRecord::Base
   belongs_to :category
End 
```

发布创建视图（删除 category_id 的默认文本框）

```
...
<p>
 <% for category in Categories.find(:all) %>
   <div>
       <%= radio_button_tag "post[category_id]", category.id, @post.category_id == category.id %><%= category.name %>
   </div>
 <% end %>
</p> 
```

# c# - 尝试反序列化 xml 文件时出现异常

> ID：673468
> 
> 赞同：7
> 
> 时间：2009-03-23T13:59:41.290
> 
> 标签：c#, xml, exception, xml-serialization

我试图用 XmlSerializer 反序列化一个 XML 文件，但是我得到了这个异常：

> “XML 文档 (1, 2) 中存在错误”内部异常是：“`<Mymessage xmlns='http://MyMessages/'>`不是预期的。”

这是 XML 文件中的第一行。我的猜测是它与xmlns有关。

我试图询问谷歌，然后尝试将以下行添加到我的代码中

```
[XmlRoot("MyMessage", Namespace="'http://MyMessages/")] 
```

但我仍然得到同样的例外。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T12:01:57.297

在 XmlSerializer 的构造函数中，我需要指定一个默认命名空间，之后一切正常

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T14:15:16.183

请提供完整的 XML 文件代码，以帮助更好地理解问题。

也把它作为xml文件的第一行，看看这是否解决了问题

```
 <?xml version="1.0" encoding="utf-8"?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-19T01:29:52.150

在 CruelIO 的回应之后，我通过添加以下内容解决了该错误：

```
[XmlRoot("RenderResult", Namespace = "http://mynamespace.uri.org")] 
```

到我试图反序列化的类。例如：序列化代码是：

```
RenderResult result;
using (var memoryStream = new MemoryStream(data))
{
    var xmlSerializer = new XmlSerializer(typeof(RenderResult));
    result = (RenderResult)xmlSerializer.Deserialize(memoryStream);
} 
```

我的课看起来像这样：

```
[XmlRoot("RenderResult", Namespace = "http://mynamespace.uri.org")]
public class RenderResult
{
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T14:22:41.063

听起来你有一个无聊的 xml 文件。找出来的简单方法：

*   尝试将其加载到 xml 查看器中
*   或者只是确保它具有 .xml 扩展名并在 VS 或 IE 中加载
*   或在其上运行 xsd.exe

如果他们抱怨，那么 xml 肯定是损坏的。如果它们工作正常并显示您的数据，那么您可能有错误的序列化属性。尝试将 xsd.exe 与“/classes”开关一起使用，看看它会做什么......

# html - XSLT：帮我修复多个 BODY 标签

> ID：673471
> 
> 赞同：1
> 
> 时间：2009-03-23T14:00:19.963
> 
> 标签：html, xslt

我需要对一些结构不好的 HTML 进行后处理——例如

```
<html>
<body>...</body>
<body>...</body>
</html> 
```

转换此 HTML 以使第二个正文的内容出现在第一个正文中的最佳方法是什么，当然除了额外的正文标记？我不想用这条规则来操纵其他任何东西。

我曾想过匹配 html 标记并使用显式的 apply-templates 调用从那里处理它，但对我来说似乎有点草率。我知道如何匹配虚假体（“body [position（）> 1]”），但我想了解如何最好地编写转换。

编辑：我确实需要将其他模板应用于所有这些元素的子元素，因此简单的副本不起作用。

我想保留评论和处理说明。我几乎想要整个文档作为身份转换，除了这些多个主体和其他一些小的编辑，我已经成功地完成了。

编辑 2：在上面的示例中保留第二个 body 元素的子元素很重要。它们应该是输出中第一个 body 标签的子节点，位于第一个 body 标签的子节点的末尾。

编辑 3：这是一些说明性的输入/输出（未检查有效性）：

```
<html>
  <!-- Look at my comments -->
  <head>
    <title>My title!</title>
    <!-- Commentary -->
  </head>
  <body>
     <p>Something <b>bold</b></p>
  </body>
  <body>
     <!-- heh -->
     <p>Some bozo put my parent in here.</p>
  </body>
  <body>
     <p>More stuff here</p>
  </body>
</html> 
```

需要是：

```
<html>
  <!-- Look at my comments -->
  <head>
    <title>My title!</title>
    <!-- Commentary -->
  </head>
  <body>
     <p>Something <b>bold</b></p>
     <!-- heh -->
     <p>Some bozo put my parent in here.</p>
     <p>More stuff here</p>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T18:15:28.713

将这些模板添加到身份转换：

```
<xsl:template match="/html/body[1]">
   <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
      <xsl:apply-templates select="/html/body[2]/node() | /html/body[2]/@*"/>
   </xsl:copy>
</xsl:template>

<xsl:template match="/html/body"/> 
```

**编辑：**

要对它束手无策，而不是`body[2]`在上面你可以使用`body[position() != 1]`. 这将处理您的输入包含两个以上`body`元素的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T14:21:51.877

通常通过编写量身定制的 hack 来避免下游问题会导致代码库难以管理。

您最好在源代码处修复损坏的 HTML，因为有几个 body 标签在某处听起来像是一个严重的误解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T14:31:21.480

如果您的输入 HTML 是格式正确的 XML，那么此 XSLT 模板将执行此操作：

```
<xsl:template match="/">
  <body>
    <xsl:copy-of select="//body/node()" />
  </body>
</xsl:template> 
```

*（我不关心`<html>`这个例子中的节点，因为这很简单。）*

上述更灵活的变体（根据 OP 的要求）

```
<!-- explicitly catching the initial html circumvents built-in templates -->
<xsl:template match="/html">
  <xsl:copy>
    <xsl:apply-templates />
  </xsl:copy>
</xsl:template>

<!-- copy everything that is not processed otherwise -->
<xsl:template match="@*|node()|processing-instruction()">
  <xsl:copy-of select="." />
</xsl:template>

<!-- matches any "body" node, but produces output only for the first -->
<xsl:template match="body">
  <xsl:if test="not(preceding-sibling::body)">
    <xsl:copy>
      <xsl:apply-templates select="//body/@*|//body/node()" />
    </xsl:copy>
  </xsl:if>
</xsl:template>

<!-- you can add more of these specific templates, as needed -->
<xsl:template match="body//a">
  <b>
    <xsl:copy-of select="." />
  </b>
</xsl:template> 
```

这个输入：

```
<html>
  <head><title>Foo!</title></head>
  <?dummy processing instruction?>
  <body foo="bar">...<a href="foo">asd</a><!-- comment --></body>
  <body>...contents of body#2...</body>
</html> 
```

得到我这个结果（空格和缩进为了可读性而改变）：

```
<html>
  <head><title>Foo!</title></head>
  <?dummy processing instruction?>
  <body foo="bar">
    ...
    <b><a href="foo">asd</a></b>
    <!-- comment -->
    ...contents of body#2...
  </body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T16:02:21.777

也许这更接近你所追求的：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
            version="2.0" exclude-result-prefixes="xsl">
<xsl:output indent="yes" method="html"/>

<xsl:template match="/">
    <xsl:apply-templates select="@*|node()"/>
</xsl:template>

<!-- Identity Template -->
<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>

<!-- Matches on the first 'body' tag -->
<xsl:template match="body[1]">
    <xsl:copy>
        <!-- apply=templates the children of all the body tags -->
        <xsl:apply-templates select="//body/node()"/>
    </xsl:copy>
</xsl:template>

<!-- Skip processing on the subsequent body tags 
     (their children are still processed however)   -->
<xsl:template match="body"/>

</xsl:stylesheet> 
```

这对模板使用了流行的“推送”结构，因此您可能会发现它更灵活。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T17:21:56.843

我认为@Keltex 的意思是你应该去掉

```
</body>\s*<body> 
```

在处理文档之前，您可以像编写规范化输入一样编写 XSLT。

这就是我要做的。

（这假设多个 body 标签之间没有内容。）

**编辑：**这不会删除正文标签的内容。请注意，您将从*结束*正文标记中删除任何内容到*开始*标记。这将保留初始和最终标签。换句话说，像这样的输入

```
<body>
    good stuff
</body>
<body>
    more good stuff
</body> 
```

您将在中间定位这两个标签。删除这些将产生一个单一的、连续的主体：

```
<body>
    good stuff
    more good stuff
</body> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-23T15:56:26.020

如果 HTML 是乱七八糟的，那么我不愿意假设 HTML 的格式足够好，可以使用 xlst。您可能只想使用正则表达式来查找

```
<body>(whitespace)</body> 
```

并将其删除。

# c# - 从 DateTime（出生日期）算起的年龄

> ID：673476
> 
> 赞同：9
> 
> 时间：2009-03-23T14:01:18.870
> 
> 标签：c#, datetime

### 复制

> [如何在 C# 中计算某人的年龄？](https://stackoverflow.com/questions/9/how-do-i-calculate-someones-age-in-c)

我有一个`datetime`代表用户出生日期的变量。

我怎样才能从中得到年龄？

**更新** 我想要一个精确的生日，所以 30.45 岁或其他。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T14:05:33.930

尝试以下操作（假设出生日期存储在 中`dtDOB`）：

```
public int getAgeInYears {
  TimeSpan tsAge = DateTime.Now.Subtract(dtDOB);

  return new DateTime(tsAge.Ticks).Year - 1;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T14:09:47.007

从杰夫的问题的答案中被盗：

```
DateTime now = DateTime.Now;
int age = now.Year - bday.Year;
if (now < bday.AddYears(age)) age--; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T14:05:27.363

您可以尝试（在 Vb 中）：

```
 Dim dateOfBirth As Date

    Now.Subtract(dateOfBirth).TotalDays \ 365 
```

\ 是 Vb 中的整数除法，我不知道它在 C# 中是否有对应关系。

# .net - 如何在没有大量样板代码的情况下为异常添加上下文？

> ID：673479
> 
> 赞同：1
> 
> 时间：2009-03-23T14:02:54.140
> 
> 标签：.net, exception-handling

在我当前的项目中，我看到了很多这种类型的代码：

```
public User GetUserByName(string userName) 
{
    try
    {
        // Lots of code here to check if the user is in the cache,
        // get it from the DB if not, set properties on it, etc...
    }
    catch (Exception ex)
    {
        throw new Exception("Exception getting user by name, username: " + userName, ex);
    }
} 
```

我很欣赏这里的意图，拥有局部变量对于调试非常有用，但是在*每个*方法周围放置一个 try/catch 似乎工作量太大，而且它确实无助于可读性。现在我忽略了我们正在抛出 System.Exception 的事实，自然更具体的类型会更好，但这不是我问题的重点。同样，不用说，这会被大量复制和粘贴，而对异常消息没有任何修改......

所以我的问题是：你如何捕获这种上下文信息（例如上面示例中的用户名）进行调试？出于问题的目的，我们假设该方法编写得很好，并且处理了任何*特定*的异常检查，我想要的只是将上下文添加到此处无法处理且需要冒泡的任何异常顶级处理程序。

我的第一个想法：

1.  依靠日志框架来跟踪每个方法调用及其参数，这又是真正的样板，并且比适合生产的日志记录要多得多。

2.  引入一些 AOP 并拦截每个方法（或有限的子集），在返回时检查异常并记录参数或将它们添加到抛出的异常中。

欢迎任何其他意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T14:10:15.383

我添加了一条带有方法名称的日志消息，然后重新抛出异常。异常只应在不可预见的情况下发生，因此供程序员使用来修复。对程序员来说最重要的是知道异常发生在哪里以及日志消息的作用（如果它是通用方法名，我也会将类名添加到日志消息中）。

```
public User GetUserByName(string userName) 
{    
    try    
    {        

    }    
    catch (Exception ex)   
    {        
       logger.Error("Exception GetUserByName. " + ex.Message);
       throw;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T14:41:19.210

您的 Try-Catch 块应该只围绕能够引发异常的代码片段（任何涉及用户输入的内容，任何涉及外部数据源的内容）在这些情况下，最好只记录相关的局部变量。这些异常是预期的（不可避免的），因此您需要以区分预期错误和代码错误的方式记录它们。

如果您没有在消息中添加额外的上下文，那么您正在滥用您的日志工具。捕获并重新抛出总比完全不捕获要好（它执行 finally 块），但您还应该在每条日志消息中添加相关注释，否则您实际上会损害您调试代码的能力，因为您有不知道异常是从哪里引发的。

此外，.Log 文件很便宜，每当您抛出错误时，在其中包含大量信息并没有什么坏处。您拥有的错误日志记录越多，调试生产应用程序就越容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:42:09.987

抛出异常是代码的正常行为。没有理由去挖掘日志来找出这样做的原因或是谁。并更改您的代码以使这种情况不再发生。

抛出异常意味着出现问题。但不是用代码。这可能是数据库连接、用户输入和其他环境内容的问题。

您可以捕获日志的唯一异常是逻辑异常。找出**程序员**出错的地方。只有这个异常你必须修复和记录。所有其他异常都应该在适当的抽象级别被捕获，而无需重新抛出。

# c++ - 如何在 C++ 中编写可内联的相互抽象？

> ID：673491
> 
> 赞同：1
> 
> 时间：2009-03-23T14:04:40.733
> 
> 标签：c++, class, inline, abstraction

先举例：

```
template <class HashingSolution> 
struct State : public HashingSolution {

  void Update(int idx, int val) {
    UpdateHash(idx, val);
  }

  int GetState(int idx) {
    return ...;
  }
};

struct DummyHashingSolution {
  void UpdateHash(int idx, int val) {}
  void RecalcHash() {}
};

struct MyHashingSolution {
  void UpdateHash(int idx, int val) {
    ...
  }

  void RecalcHash() {
    ...
    UpdateHash(idx, GetState(idx)); // Problem: no acces to GetState function, can't do recursive application of templates
    ...
  }
}; 
```

在此示例中，我可以将 MyHashingSolution 传递给 State 类，因此 State 可以访问 HashingSolution 的方法，但 HashingSolution 不能调用 GetState。有可能解决这个问题吗？

这是最深的循环。这里的虚函数使性能下降了 25% 以上。内联对我来说至关重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T16:05:55.187

正如 jalf 在评论中所建议的那样，您可能想要使用[Curiously Recurring Template Pattern](http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern) (CRTP) 的变体。也就是说，制作`MyHashingSolution`一个由派生类参数化的类模板：

```
template <typename D>
struct MyHashingSolution {
    typedef D Derived;

    void UpdateHash(int idx, int val) {
        ...
    }

    void RecalcHash() {
        ...
        UpdateHash(idx, derived().GetState(idx));
        ...
    }

private:
    // Just for convenience
    Derived& derived() { return *static_cast<Derived*>(this); }
}; 
```

在这种情况下，因为您希望派生`State`类也是一个模板，所以您需要采取稍微不寻常的步骤，即声明`State`为接受*模板模板参数*的类模板：

```
template <template <class T> class HashingSolution>
struct State : public HashingSolution<State<HashingSolution> > {
typedef HashingSolution<State<HashingSolution> > Parent;

    void Update(int idx, int val) {
        Parent::UpdateHash(idx, val);   // g++ requires "Parent::"
    }

    int GetState(int idx) {
        return ...;
    }
}; 
```

关键是，如果`State`继承自`HashingSolution<State<HashingSolution> >`，`Derived`是的派生类，`HashingSolution<State<HashingSolution> >`因此`static_cast<Derived*>(this)`向下转换`HashingSolution<State>::derived()`编译并正常工作。（如果你搞砸了并从中派生`State`，`HashingSolution<SomeOtherType>`然后尝试一些涉及到调用的事情，`derived()`编译器会抱怨`static_cast<>`不满足要求。）

然后`State`像这样声明要使用的具体类：

```
typedef State<MyHashingSolution> MyState; 
```

不幸的是，此解决方案具有副作用，您需要更改`DummyHashingSolution`（以及任何其他此类类型）为忽略其一个模板参数的模板，以使它们可用作模板模板参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T14:19:40.183

作为在黑暗中的镜头，考虑到问题中几乎完全缺乏信息（见评论）：模板有用吗？它们通常适用于编译时多态性。

要获得更多可能有用的信息，请进一步解释问题。看问题评论。告诉我们为什么您知道当您仍在进行基础设计时需要进行哪些微优化。如果有任何关于编译或执行环境的非主流，请给我们一些细节。

# java - 在 OSX 中运行 CMD 等价物？

> ID：673498
> 
> 赞同：0
> 
> 时间：2009-03-23T14:06:03.117
> 
> 标签：java, macos, shell, scripting, sh

我正在使用此代码使我的 Java 程序打开一个（可见的）CMD 窗口：

```
try {
            String line;
            Process p = Runtime.getRuntime().exec("cmd /C start \"Render\" \"" + myPath + "\\punchRender.cmd\"");
             BufferedReader input =
                    new BufferedReader(new InputStreamReader(p.getInputStream()));
            while ((line = input.readLine()) != null) {
            System.out.println(line);
            jLabel7.setText(line);

            }
            input.close();
        } catch (Exception err) {
            err.printStackTrace();
        } 
```

我一直在尝试对 OSX 终端做同样的事情，这就是我现在所处的位置：

```
 try {
            String line;
            Process p = Runtime.getRuntime().exec("sh " + myPath + "/punchRender.sh");
             BufferedReader input =
                    new BufferedReader(new InputStreamReader(p.getInputStream()));
            while ((line = input.readLine()) != null) {
            System.out.println(line);
            jLabel7.setText(line);

            }
            input.close();
        } catch (Exception err) {
            err.printStackTrace();
        } 
```

到目前为止，没有运气:(有什么建议吗？.sh 文件甚至没有运行......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T14:08:22.330

我只是确保你的 shell 脚本有执行位，然后传入 shell 脚本文件名。

`Process p = Runtime.getRuntime().exec(myPath + "/punchRender.sh")`

**编辑：**

我不知道 Java 是否有任何方式为 Unix/Linux 设置文件权限以设置 eXecute 位或如何转义引号。但它会是这样的：

`Process chmod = Runtime.getRuntime().exec("chmod u+x \"" + myPath + "/punchRenderer.sh\"")`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T14:15:39.427

这应该有效。不仅运行脚本，还打开终端：

`Process p = Runtime.getRuntime().exec("open -a /Applications/Utilities/Terminal.app \"" + myPath + " /punchRender.sh\"");`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T14:15:50.393

如果你想要一个新的可见终端窗口，你不能直接运行 shell。您需要启动终端，然后运行 ​​.command 文件，而不是 shell 脚本。我不确定将该命令的标准输出连接到您的 Java 进程有多难。您可能必须想办法将输出输入终端。

顺便说一句，我在家中自己的 Mac 上的一个课程中尝试了您的代码，它运行了一个 .sh 文件就好了。我正在从命令行运行 java 类。也许 sh 只是不在您的 PATH 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T14:08:20.740

我假设您已经检查过 .sh 文件是可执行的，不是吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T14:22:41.377

我可以建议您捕获标准错误*以及*标准输出，然后转储它。这应该让您对正在发生的事情有所了解（通常这是一种很好的做法）。

您可能需要在不同的线程中收集标准输出和标准错误以避免阻塞问题。看[这里](http://www.velocityreviews.com/forums/t130884-process-runtimeexec-causes-subprocess-hang.html)_`StreamGobbler`

# ruby-on-rails - 在 Rails 中创建永久链接（slug） - 为什么我的测试失败了？

> ID：673502
> 
> 赞同：4
> 
> 时间：2009-03-23T14:07:39.150
> 
> 标签：ruby-on-rails

我正在编写一个小型 CMS 作为 Rails 测试项目（也计划将其用于我的个人网站）。我想要对 SEO 友好的 URL，因此我进行了一项测试，以验证是否会根据页面标题自动创建永久链接（例如 About Us => about-us）。但是，我无法弄清楚为什么这个测试失败了。这是代码（我使用的是 Rails 2.3.2）：

```
# page_test.rb
# note I am using the "shoulda" framework
require 'test_helper'

class PageTest < ActiveSupport::TestCase
  should_validate_presence_of :title, :permalink, :content
  should_validate_uniqueness_of :title

  should "create permalink automatically" do
    p = pages(:sample_page)
    p.save

    assert_equal "sample-page", p.permalink
  end
end

# pages.yml
sample_page:
  title: Sample Page
  permalink: # gets automatically created by model
  content: This is a sample page

# page.rb
class Page < ActiveRecord::Base
  validates_presence_of :title, :permalink, :content
  validates_uniqueness_of :title

  before_save :generate_permalink

  private

  def generate_permalink
    self.permalink = self.title.parameterize
  end
end 
```

发生的情况是永久链接为零，而不是应该的“示例页面”。但是，如果我手动将永久链接放在夹具中并更改测试，它就可以工作，例如：

```
p - pages(:sample_page)
p.title = "Contact Us"
p.save

assert_equal "contact-us", p.permalink 
```

我可以像这样修复它，但我想知道为什么它没有为原始测试触发 before_save 方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:34:48.127

好吧，我能够弄清楚。我需要`before_validation`用作回调而不是`before_save`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T14:13:30.447

如果`permalink:`从 pages.yml 文件中删除空键，它会起作用吗？

# silverlight - Silverlight 与 Adob e Air

> ID：673504
> 
> 赞同：9
> 
> 时间：2009-03-23T14:07:46.997
> 
> 标签：silverlight, air

现在有了 Silverlight 3（离线，没有浏览器的东西），这两种技术之间的主要区别是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T17:15:14.003

目前 Beta 版中存在一些显着差异，不知道在发布版本中这些差异是否仍然存在。

1.  在 Silverlight OOB 中无法隐藏窗口镶边。
2.  无法创建通知托盘图标。
3.  Air 应用程序可以是多窗口的，Silverlight OOB 不能。
4.  Air 应用程序对系统有更多访问权限，Silverlight 应用程序是沙盒化的。
5.  安装和更新过程存在差异，不确定所有细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T18:16:20.583

这是一场三方面的战争：Adobe AIR、MS Silverlight 和 Mozilla Prism。

阅读[这篇](http://www.steveciske.com/post/Using-Silverlight-vs-Flash.aspx)博文和这篇[文章](http://www.webdirections.org/the-state-of-the-web-2008/flash-silverlight-and-other-embedded-content/)。引用第二篇文章：

> Silverlight 在功率方面显然是赢家，但正如我的一位同事前几天指出的那样，这有关系吗？他的观点是，Flash 具有令人难以置信的渗透率。根据 Adob​​e 的说法，它在 99% 的范围内。在考虑推出需要插件的新产品时，为什么要引入另一个采用障碍？

另一个来自第二个：

> 然后我们询问那些回答“是”的人他们使用哪种格式。毫不奇怪，考虑到它的可用时间，Flash 以 61% 的受访者领先。更令人惊讶的是，Silverlight 的市场份额非常小，仅略高于 2%，与 Real 格式的市场份额基本相同。Quicktime 的表现出人意料地好，不到 20%。

至于 SL 中的 VOIP 支持，请阅读[此](http://www.techcrunchit.com/2009/02/03/tringme-finds-a-way-to-make-voip-calls-from-microsoft-silverlight/)。

[在此处](http://labs.mozilla.com/projects/prism/)阅读 Prism 。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T17:18:42.123

AIR 让您可以访问文件系统和 SQLite 数据库。SL3 仅允许您通过用户交互（另存为对话框）写入文件系统，并且不支持隔离存储或磁盘中的数据库。

SLOOB 仍然在沙盒中运行，因此您受限于与在浏览器中运行的 Silverlight 应用程序相同的跨域问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T14:21:03.207

除了 Dave 所说的，Silverlight 似乎缺少设备支持（麦克风和网络摄像头）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-19T14:53:21.957

我想指出的一件事是，其他人没有提到的是（当我这么说时，我并没有选择最喜欢的，因为我们在我的工作中使用 Air/Flex 进行项目）：

Adobe 没有为开发人员创建高质量运行时和 IDE 所需的人才。他们的想法很好，我怀疑的是这些想法的执行。我认为我们都同意 Visual Studio 比任何 IDE 都领先数年。质量方面，我什至可以说 VS2005 比市场上的任何产品（现在是 2011 年）在 6 年后都做得更好。

如果您觉得 Flex/Air 能更好地满足您的需求，我会全力以赴。但如果觉得任何一个平台都能满足您的需求，我会说 Silverlight 每次都赢。它更成熟，更稳定。

对于我们的商业应用程序，我们最头疼的是 Air 没有很好地管理垃圾收集，在过去的一年半里，我们的应用程序一直在减速，唯一的解决办法是每晚在 kiosk 上重新启动，因为我们将对象嵌套在对象中，一旦你打到第 3 次嵌套，Air 似乎无法正确冲洗这些对象，Adobe 会意识到这一点，考虑到已经过去了多少时间以及所有较新的版本，Adobe 没有解决方案。这是运行时间不佳和 Adob​​e 开发人员不是很好的标志。尽管人们喜欢抨击 MS，但如今他们的平台非常可靠，总体而言是可靠的，尤其是他们的 .NET 运行时。Adobe 感觉就像 1997 年左右的微软，他们距离提供可靠的解决方案还有好几年的时间。

PS：我敢肯定，喝过 Adob​​e 的几个 koolaid 开发人员会否决这个答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T14:17:40.017

假设在桌面上运行 Silverlight 应用程序只需进行微小的更改，差异在于实现细节。Silverlight 是一个基于 WPF 的 .NET 空间框架。Flash/Flex/AIR 是基于 ActionScript 的专有 Adob​​e 产品。

就能力而言，它们似乎与互补的优势和劣势大致相当。示例：SL3 将支持 GPU 和像素着色器。最新的 Flash 作为逆运动学。不同的笔画等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T09:00:35.497

从用户的角度来看，我更喜欢 Silverlight 安装过程......特别是在 Mac 上 - Air 应用程序安装不自然（对于许多点击和进程栏），但 oneclick Silverlight 安装很好 :)

# javascript - 简单的javascript“功能”面板

> ID：673507
> 
> 赞同：0
> 
> 时间：2009-03-23T14:08:42.363
> 
> 标签：javascript, jquery

我正在开发一个免费模板，它有一个特色的 Div...

www.subigya.com/test/durbarsquare

“在聚光灯下”是特色 div。

我在那里有简单的 jQuery js 来切换图像。如何切换标题&

与交换机中的每个 div 相关。现在，只有图像切换而不是文本。

使用的脚本是 feature.js，样式表是 style.css

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T14:23:58.613

从您的脚本中：

```
$("#spotlightright a").click(function(){
//these two assignments are fine, because "href" and "title" are both attributes of "a" tags
    var largePath = $(this).attr("href");
    var largeAlt = $(this).attr("title");

//these two are not, an "a" does not have "h2" and "p" attributes
    var featureHead = $(this).attr("h2");
    var featureText = $(this).attr("p"); 
```

解决方案：直接引用包含您要复制的文本的元素，例如

```
var featureHead = $('h2#example').text();
var featureText = $('p#example').text(); 
```

# java - 使用休眠标准，有没有办法逃避特殊字符？

> ID：673508
> 
> 赞同：16
> 
> 时间：2009-03-23T14:08:42.877
> 
> 标签：java, database, hibernate, criteria, escaping

对于这个问题，我们希望避免编写特殊查询，因为查询在多个数据库中必须不同。仅使用休眠标准，我们希望能够转义特殊字符。

这种情况是需要能够转义特殊字符的原因：

假设我们在数据库中有表 'foo'。表 'foo' 仅包含 1 个字段，称为 'name'。“名称”字段可以包含在数据库中可能被视为特殊的字符。这种名称的两个示例是“name_1”和“name%1”。'_' 和 '%' 都是特殊字符，至少在 Oracle 中是这样。如果用户在将这些示例输入数据库后想要搜索其中一个示例，则可能会出现问题。

```
criterion = Restrictions.ilike("name", searchValue, MatchMode.ANYWHERE);
return findByCriteria(null, criterion); 
```

在此代码中，“searchValue”是用户赋予应用程序用于其搜索的值。如果用户想要搜索 '%'，则用户将返回数据库中的每个 'foo' 条目。这是因为 '%' 字符表示用于字符串匹配的“任意数量的字符”通配符，hibernate 生成的 SQL 代码如下所示：

```
select * from foo where name like '%' 
```

有没有办法告诉休眠转义某些字符，或者创建一个不是特定于数据库类型的解决方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-07-10T20:27:44.797

LikeExpression 的构造函数都受到保护，因此它不是一个可行的选择。此外，它也有[自己的问题](http://opensource.atlassian.com/projects/hibernate/browse/HHH-2997)。

我和一位同事创建了一个效果很好的补丁。补丁的要点是，对于使用 MatchMode 的 LikeExpression 构造函数，我们转义了特殊字符。对于使用 Character（转义字符）的构造函数，我们假设用户自行转义特殊字符。

我们还对转义字符进行了参数化，以确保在 SQL 查询中使用 \ 或引号字符之类的字符时它不会破坏 SQL 查询。

```
package org.hibernate.criterion;

import org.hibernate.Criteria;
import org.hibernate.HibernateException;
import org.hibernate.dialect.Dialect;
import org.hibernate.engine.TypedValue;

public class LikeExpression implements Criterion {
    private final String propertyName;
    private final String value;
    private final Character escapeChar;

    protected LikeExpression(
            String propertyName,
            Object value) {
        this(propertyName, value.toString(), (Character) null);
    }

    protected LikeExpression(
            String propertyName,
            String value,
            MatchMode matchMode) {
        this( propertyName, matchMode.toMatchString( value
                .toString()
                .replaceAll("!", "!!")
                .replaceAll("%", "!%")
                .replaceAll("_", "!_")), '!' );
    }

    protected LikeExpression(
            String propertyName,
            String value,
            Character escapeChar) {
        this.propertyName = propertyName;
        this.value = value;
        this.escapeChar = escapeChar;
    }

    public String toSqlString(
            Criteria criteria,
            CriteriaQuery criteriaQuery) throws HibernateException {
        Dialect dialect = criteriaQuery.getFactory().getDialect();
        String[] columns = criteriaQuery.getColumnsUsingProjection( criteria, propertyName );
        if ( columns.length != 1 ) {
            throw new HibernateException( "Like may only be used with single-column properties" );
        }
        String lhs = lhs(dialect, columns[0]);
        return lhs + " like ?" + ( escapeChar == null ? "" : " escape ?" );

    }

    public TypedValue[] getTypedValues(
            Criteria criteria,
            CriteriaQuery criteriaQuery) throws HibernateException {
        return new TypedValue[] {
                criteriaQuery.getTypedValue( criteria, propertyName, typedValue(value) ),
                criteriaQuery.getTypedValue( criteria, propertyName, escapeChar.toString() )
        };
    }

    protected String lhs(Dialect dialect, String column) {
        return column;
    }

    protected String typedValue(String value) {
        return value;
    }

} 
```

如果您想知道 lhs 和 typedValue 方法的用途，新的 IlikeExpression 应该可以回答这些问题。

```
package org.hibernate.criterion;

import org.hibernate.dialect.Dialect;

public class IlikeExpression extends LikeExpression {

    protected IlikeExpression(
            String propertyName,
            Object value) {
        super(propertyName, value);
    }

    protected IlikeExpression(
            String propertyName,
            String value,
            MatchMode matchMode) {
        super(propertyName, value, matchMode);

    }

    protected IlikeExpression(
            String propertyName,
            String value,
            Character escapeChar) {
        super(propertyName, value, escapeChar);
    }

    @Override
    protected String lhs(Dialect dialect, String column) {
        return dialect.getLowercaseFunction() + '(' + column + ')';
    }

    @Override
    protected String typedValue(String value) {
        return super.typedValue(value).toLowerCase();
    }

} 
```

在此之后，唯一剩下的就是让 Restrictions 使用这些新类：

```
public static Criterion like(String propertyName, Object value) {
    return new LikeExpression(propertyName, value);
}

public static Criterion like(String propertyName, String value, MatchMode matchMode) {
    return new LikeExpression(propertyName, value, matchMode);
}

public static Criterion like(String propertyName, String value, Character escapeChar) {
    return new LikeExpression(propertyName, value, escapeChar);
}

public static Criterion ilike(String propertyName, Object value) {
    return new IlikeExpression(propertyName, value);
}

public static Criterion ilike(String propertyName, String value, MatchMode matchMode) {
    return new IlikeExpression(propertyName, value, matchMode);
}

public static Criterion ilike(String propertyName, String value, Character escapeChar) {
    return new IlikeExpression(propertyName, value, escapeChar);
} 
```

编辑：哦，是的。这适用于甲骨文。不过，我们不确定其他数据库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-08-01T16:14:57.300

这不是一种非常干净的方法，但 sqlRestrinction 应该更容易：

```
criterions.add(Restrictions.sqlRestriction(columnName+ " ilike '!%' escape '!'")); 
```

您甚至可以使用相同的原则从搜索开始：

```
criterions.add(Restrictions.sqlRestriction(columnName+ " ilike '!%%' escape '!'")); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T14:49:32.217

如果您直接使用 LikeExpression，它可以让您指定转义字符。我认为这应该是你所需要的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-02-23T17:33:32.660

如果您使用 Hibernate 3.2+，您可以子类化`LikeExpression`，然后创建工厂`like`/`ilike`方法：

```
import org.hibernate.criterion.Criterion;
import org.hibernate.criterion.LikeExpression;
import org.hibernate.criterion.MatchMode;

public class EscapedLikeRestrictions {
    private EscapedLikeRestrictions() {}

    public static Criterion likeEscaped(String propertyName, String value, MatchMode matchMode) {
        return likeEscaped(propertyName, value, matchMode, false);
    }

    public static Criterion ilikeEscaped(String propertyName, String value, MatchMode matchMode) {
        return likeEscaped(propertyName, value, matchMode, true);
    }

    private static Criterion likeEscaped(String propertyName, String value, MatchMode matchMode, boolean ignoreCase) {
        return new LikeExpression(propertyName, escape(value), matchMode, '!', ignoreCase) {/*a trick to call protected constructor*/};
    }

    private static String escape(String value) {
        return value
                .replace("!", "!!")
                .replace("%", "!%")
                .replace("_", "!_");
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-16T11:10:19.193

如果您使用 sqlRestrictions，正确的方法如下：

`criterions.add(Restrictions.sqlRestriction(columnName+" LIKE '!%' ESCAPE '!'"));`

就像一个 sql 查询，不起作用 ilike => 在 Oracle 12i 中使用 LIKE。

# c# - 在给定日期时间的情况下，以小数为单位的年龄

> ID：673514
> 
> 赞同：4
> 
> 时间：2009-03-23T14:10:33.637
> 
> 标签：c#, datetime

如何在 C# 日期时间中获取给定出生日期的某人的年龄。

**我想要一个准确的年龄，比如 40.69 岁**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-23T14:54:05.933

这将计算确切的年龄。年龄的小数部分是相对于上一个生日和下一个生日之间的天数计算的，因此它将正确处理闰年。

小数部分在一年中是线性的（并且不考虑月份的不同长度），如果您想表达小数年龄，这似乎最有意义。

```
// birth date
DateTime birthDate = new DateTime(1968, 07, 14);

// get current date (don't call DateTime.Today repeatedly, as it changes)
DateTime today = DateTime.Today;
// get the last birthday
int years = today.Year - birthDate.Year;
DateTime last = birthDate.AddYears(years);
if (last > today) {
    last = last.AddYears(-1);
    years--;
}
// get the next birthday
DateTime next = last.AddYears(1);
// calculate the number of days between them
double yearDays = (next - last).Days;
// calcluate the number of days since last birthday
double days = (today - last).Days;
// calculate exaxt age
double exactAge = (double)years + (days / yearDays); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T14:14:10.070

这将是一个近似计算：

```
 TimeSpan span = DateTime.Today.Subtract(birthDate);
 Console.WriteLine( "Age: " + (span.TotalDays / 365.25).toString() ); 
```

顺便说一句：另请参阅 Stack Overflow 上的这个问题：[如何在 C# 中计算某人的年龄？](https://stackoverflow.com/questions/9/how-do-i-calculate-someones-age-in-c)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T14:18:24.977

一个近似值是：

```
 DateTime bd = new DateTime(1999, 1, 2);

        TimeSpan age = DateTime.Now.Subtract(bd);
        Console.WriteLine(age.TotalDays / 365.25); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T14:42:16.167

40年的部分很容易。但是要获得真正准确的小数点，我不确定您如何将其余的年龄转换为十进制数。您会看到年龄以年、月、日、小时、秒表示。而且计算不是那么容易。你必须处理周年纪念日。就像某人在 1 月 31 日出生，他们是 1 个月大吗？答案是 3 月 1 日。但有些年份是 28 天后，有些年份是 29 天后。 [这](http://snippets.dzone.com/posts/show/623)是我尝试处理的一个javascript实现。

但我想小数可以表示自最近的生日周年纪念日以来的天数除以下一个生日周年纪念日的天数。如果您想获得更精确的信息，您可以使用相同的原理在几秒钟内完成。

但我认为这是一个时代的不良代表。我们只是通常不代表这样的年龄。

并确保您的日期时间在同一时区进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T14:24:24.557

你可以这样做：

```
Console.WriteLine(DateTime.Now.Date.Subtract(new DateTime(1980, 8, 1)).TotalDays / 365.25); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T14:36:49.970

小数部分允许有多少错误？准确的年龄是

31 年、10 天、3 小时等，取决于所需的精度。

# wpf - 如何在 WPF Datagrid 上启用滚动条？

> ID：673516
> 
> 赞同：68
> 
> 时间：2009-03-23T14:10:48.223
> 
> 标签：wpf, datagrid, scroll

[当我运行本文](http://www.codeproject.com/KB/WPF/WPFDataGrid.aspx)中的以下**Northwind WPF Toolkit Datagrid**代码时，我得到了一个数据网格，但**没有滚动条**，因此用户只能看到部分数据网格。我使用的是 2009 年 3 月的最新版本。

 ****我需要指定什么以使 WPF Datagrid 具有滚动条？**

我尝试将数据网格放在 ScrollViewer 中，但这没有帮助。

**XAML：**

```
<Window x:Class="TestDataGrid566.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/wpf/2008/toolkit"
    Title="Window1" Height="600" Width="800">
    <StackPanel>
        <toolkit:DataGrid x:Name="TheDataGrid" AutoGenerateColumns="True"/>
    </StackPanel>
</Window> 
```

**代码隐藏：**

```
using System.Linq;
using System.Windows;
using TestDataGrid566.Model;

namespace TestDataGrid566
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            NorthwindDataContext db = new NorthwindDataContext();
            var customers = from c in db.Customers
                            select c;
            TheDataGrid.ItemsSource = customers;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-03-23T14:28:20.943

把`DataGrid`,`Grid`或直接放在`DockPanel`. 一个垂直方向将给它的孩子他们要求的任何垂直空间——即使这意味着它被渲染在视野之外。`ContentControl``Window``StackPanel`

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2011-02-08T14:18:35.070

WPF4

```
<DataGrid AutoGenerateColumns="True" Grid.Column="0" Grid.Row="0"
      ScrollViewer.CanContentScroll="True" 
      ScrollViewer.VerticalScrollBarVisibility="Auto"
      ScrollViewer.HorizontalScrollBarVisibility="Auto">
</DataGrid> 
```

与 : `<ColumnDefinition Width="350" />`&`<RowDefinition Height="300" />`工作正常。

滚动条不显示`<ColumnDefinition Width="Auto" />`& `<RowDefinition Height="300" />`。

也适用于：`<ColumnDefinition Width="*" />`&`<RowDefinition Height="300" />` 在嵌套在外部的情况下`<Grid>`。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-05-25T07:06:12.163

如果任何父容器`RowDefinition`高度设置`"Auto"`为滚动条的停止器

或者，您可以设置高度“*”

这发生在我的案例中。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-05-12T09:27:04.883

添加`MaxHeight`并解决`VerticalScrollBarVisibility="Auto"`了`DataGrid`我的问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-06-03T14:21:41.140

为列和行添加具有定义的高度和宽度的网格。然后添加`ScrollViewer`并在其中添加dataGrid。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-03-27T12:07:45.123

就我而言，我必须设置`MaxHeight`并替换`IsEnabled="False"`为`IsReadOnly="True"`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-24T17:16:31.190

这对我有用。关键是使用 * 作为行高。

```
<Grid x:Name="grid">
        <Grid.RowDefinitions>
            <RowDefinition Height="60"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="10"/>
        </Grid.RowDefinitions>

        <TabControl  Grid.Row="1" x:Name="tabItem">
                <TabItem x:Name="ta" 
                        Header="List of all Clients">
                        <DataGrid Name="clientsgrid" AutoGenerateColumns="True" Margin="2" 
                         ></DataGrid>
                </TabItem>
        </TabControl>

    </Grid> 
```

# php - 您如何使用使用 ORM 的应用程序进行单元测试？

> ID：673518
> 
> 赞同：3
> 
> 时间：2009-03-23T14:12:37.627
> 
> 标签：php, unit-testing, phpunit, propel

我浏览了有关单元测试的各种问题，但找不到专门回答这个问题的问题。

我有几个 PHP 类，其中包含如下所示的函数：

```
 static function _setSuspended($Suspended, $UserID)
    {
        try {
            $con = Propel::getConnection();

            $c1 = new Criteria();
            $c1->add(DomainsPeer::USERID,$UserID);

            $update = new Criteria();
            $update->add(DomainsPeer::SUSPENDED,$Suspended);

            BasePeer::doUpdate($c1, $update, $con);

            return true;
        } catch(PropelException $e) {
            return $e->getMessage();
        }
    } 
```

我使用 Propel 作为我的 ORM。我已经阅读了各种单元测试主题，这些主题讨论了创建“模拟”和“存根”等等，但我找不到任何具体告诉你如何测试上述函数的内容。

我的想法是这样的：我需要测试上面的函数，所以我想调用它。但如果我调用它，它使用 Propel 作为 ORM，根据单元测试原则，我应该单独隔离每个函数。

我只是没有办法做到这一点。我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T14:23:15.400

这是一个通用的答案，因为我根本不熟悉 Propel，只是稍微熟悉 PHP。基本答案是您使用依赖注入。不是直接引用您的 ORM，而是围绕它创建一个包装器，然后将包装器注入到您的类/函数中以实际使用。要进行单元测试，您需要创建一个模拟或伪造的包装器版本，它不与 ORM 接口，而是让您配置从包装器到方法调用的响应。这允许您在对函数进行单元测试时排除 ORM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T14:56:51.653

我发现模拟 ORM 并没有给我任何信心，因为 ORM 配置从未经过测试。ORM 还具有许多远距离作用，这可能会给单元测试带来错误的信心。模拟数据库驱动程序或提供一个备用内存数据库让我更有信心我的代码是正确的，并且与模拟 ORM 一样难。

SQLite 是用于单元测试的出色内存数据库。它在 PDO 支持的数据库列表中。（PDO 是 Propel 1.3 数据库驱动程序。）如果您不想使用内存数据库，您可以找到已经编写好的 PDO 模拟。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-13T18:06:40.593

[在为 Symfony](https://github.com/JWT-OSS/sfJwtPhpUnitPlugin)构建 PHPUnit 插件时，我试图解决同样的问题。我最终以类似于[Django 的测试框架的](https://docs.djangoproject.com/en/dev/topics/testing/#the-test-database)方式接近它——使用单独的数据库/连接，并在每次测试之前销毁并重建它。

我发现在测试运行中的第一个测试之前（或者如果测试明确指示它），我也能够只重建测试数据库；在其他测试之前，它只是删除所有数据以加快速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T21:06:12.653

我最近一直在阅读[Misko Hevery 关于测试的博客](http://misko.hevery.com/code-reviewers-guide/)。它涵盖了这种情况；您需要使用 DI（依赖注入）。

我也在为此苦苦挣扎，我也使用推进器。

一方面，您可以将“挂起”方法移动到“对象”类而不是对等方。无论如何，对于这个特定的功能，您不需要使用静态方法来实现这一点。您的 API 可能如下所示：

```
MyObjectPeer::retrieveByPK(1)->suspend(); 
```

这可以通过正常的单元测试方法进行测试。

如果它真的是需要测试的数据库，那么 AFAIK 你需要真正让数据库参与测试。我在我当前的项目中经常使用 ltree 和 postgis，除了将它包含在我的测试中之外，我想不出任何其他方法来为依赖于数据库的模型逻辑运行单元测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-08T00:30:41.763

这是一个不能进行单元测试的具有硬依赖的类的例子。

我们可以通过与另一个数据库的连接进行测试，但是它不再是单元测试而是集成测试。

我想到的更好的选择是拥有一个 QueryFactory 类，它将包装您需要的所有不同方法，然后您将能够模拟它。

首先我创建一个界面

```
interface iQueryFactory
{
    function firstFunction($argument);
    function secondFunction($argument, $argument2);
} 
```

带有我们需要的所有 ORM 请求的 QueryFactory

```
class QueryFactory implements iQueryFactory
{
    function firstFunction($argument) 
    {
        // ORM thing
    }

    function secondFunction($argument, $argument2)
    {
        // ORM stuff
    }
} 
```

有查询工厂注入的业务逻辑

```
class BusinessLogic 
{
    protected $queryFactory;

    function __construct($queryFactoryInjection) 
    {
        $this->queryFactory= $queryFactoryInjection;
    }

    function yourFunctionInYourBusinessLogique($argument, $argument2) 
    {
        // business logique

        try {
            $this->queryFactory->secondFunction($argument, $argument2);
        } catch (\Exception $e) {
            // log
            // return thing
        }

        // return stuff
    }
} 
```

模拟部分，请注意我的示例没有使用模拟框架（顺便说一句，您可以创建响应设置器）

```
class QueryFactoryMock implements iQueryFactory
{
    function firstFunction($argument) 
    {
        if (is_null($argument)) 
        {
            throw new \Exception("");
        } 
        else 
        {
            return "succes";
        }
    }

    function firstFunction($argument, $argument2) 
    { 
        // sutff  
    }
} 
```

最后是用模拟实现测试我们的业务逻辑的单元测试

```
class BusinessLogicTest extends PHPUnit_Framework_TestCase 
{
    public function setUp() 
    {
        require_once "BusinessLogic.php";
    }

    public function testFirstFunction_WhenInsertGoodName() 
    {
        $queryMockup = new QueryFactoryMock();
        $businessLogicObject = new BusinessLogic($queryMockup);
        $response = $businessLogicObject ->firstFunction("fabien");

        $this->assertEquals($response, "succes");
    }

    public function testFirstFunction_WhenInsetNull() 
    {
        $queryMockup = new QueryFactoryMock();
        $businessLogicObject = new BusinessLogic($queryMockup);
        $response = $businessLogicObject->firstFunction(null);

        $this->assertEquals($response, "fail");
    }
} 
```

# delphi - 以 HTML 格式发送电子邮件

> ID：673519
> 
> 赞同：2
> 
> 时间：2009-03-23T14:12:38.360
> 
> 标签：delphi, email

目前我们正在使用 MAPI 从我们的应用程序发送纯文本电子邮件。当用户调用此函数时，我们指定对话框标志，以便电子邮件将出现在他们的电子邮件客户端中，然后他们可以修改并发送它。

我们想修饰电子邮件并以 HTML 格式发送。
根据此链接 MSDN 链接 MAPI 不适用于此[http://support.microsoft.com/kb/268440](http://support.microsoft.com/kb/268440)

我在 ExpertsExchange 上看到了一篇文章，说您可以使用 MAPI 来执行此操作，但我无法让该示例与 Outlook 一起使用（尚未尝试任何其他客户端）

```
procedure ShowMailDlg(ToName,Address,HTMLMessage: string);
var
    li: integer;
    lMessage: TMapiMessage;
    lRecipArray: array of TMapiRecipDesc;
    lREs: DWord;
begin
    SetLength(lRecipArray,1);
    lRecipArray[0].ulRecipClass:=MAPI_TO;
    lRecipArray[0].lpszName:=pChar(ToName);
    lRecipArray[0].lpszAddress:=pChar(Address);
    lMessage.ulReserved:=0;
    lMessage.lpszSubject:=nil;
    lMessage.lpszNoteText:=pChar(HTMLMessage);
    lMessage.lpszMessageType:= nil;//pChar('HTML');
    lMessage.lpszDateReceived:=nil;
    lMessage.lpszConversationID:=nil;
    lMessage.flFlags:=0;
    lMessage.lpOriginator:=nil;
    lMessage.nRecipCount:=length(lRecipArray);
    lMessage.lpRecips:=PMapiRecipDesc(lRecipArray);
    lMessage.nFileCount:=0;
    lMessage.lpFiles:=PMapiFileDesc(nil);
    lRes:=MapiSendMail(0, 0 , lMessage,MAPI_DIALOG, 0);
end; 
```

任何人都知道我该如何做到这一点。我可能可以自动化 Outlook，但我想让它完全独立于电子邮件客户端（因此 MAPI）

谢谢

更新：感谢大家的建议。问题是该功能没有被大量使用，因此要求用户配置 SMTP 详细信息并不是一个真正的选择。我想我们会坚持使用纯文本电子邮件。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T00:21:54.167

MAPI 不支持 HTML 格式的消息。来自[Microsoft](http://support.microsoft.com/kb/268440)：“扩展消息应用程序编程接口 (MAPI) 不应用于生成 HTML 格式的消息。作为替代方案，请考虑使用 Microsoft Outlook 对象模型、CDONTS、CDOSYS、CDOEX 或第三方 SMTP 控件。”

我会回应关于通过 Indy 发送的评论。[我在这里](http://ruminatedrumblings.blogspot.com/2008/04/smtp-mail-and-indy-again.html)发布了一个单元，可以非常简单地使用 Indy 发送 HTML 消息，或者随意编写自己的。如果您真的想让消息可编辑，请尝试结合使用 WPTools 和 Indy。WPTools 对 HTML 标记有很好的支持，然后您可以通过 Indy 发送生成的消息。

我对 Synapse 没有任何经验，所以我不能说这个项目有多容易/多难。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T13:40:59.463

如果您只需要为 Outlook 客户端提供服务，则可以尝试通过 OLE 访问 Outlook：

```
procedure SendMail(const aRecipient, aSubject, aNote, aFile: string; Silent, HTML: boolean);
const
  olMailItem = 0;
var
  ii: integer;
  MyOutlook, MyMail: variant;
begin
  //*** Send something via OLE/Outlook...

  //*** Outlook- und Mail-Objekt erstellen...
  MyOutlook := CreateOLEObject('Outlook.Application');
  MyMail    := MyOutlook.CreateItem(olMailItem);

  //*** create a mail message...
  MyMail.To       := aRecipient;
  MyMail.Subject  := aSubject;

  if aNote <> '' then begin
    if HTML then
      MyMail.HTMLBody := aNote
    else begin
      MyMail.Body     := aNote;
    end;
  end;

  //*** Add Attachment...  
  if aFile <> '' then begin
    MyMail.Attachments.Add(aFile);
  end;

  if Silent then
    MyMail.Send
  else
    MyMail.Display;

  MyOutlook := UnAssigned;
end; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T18:21:47.527

这也可以使用[Synapse](http://www.ararat.cz/synapse/doku.php)库。[标题为“关于 MIME 及其 MIME 部件](http://www.ararat.cz/synapse/doku.php/public:howto:mimeparts)”的操作指南页面提供了一个具体示例。我个人在几个程序中使用过这种技术来发送 HTML 电子邮件。

不幸的是，这在 MAPI 上不起作用，您需要获取用户的 SMTP 或 IMAP 信息并自己处理该通信（Synapse 库具有执行此操作的例程）。

如果您决定下载 Synapse，我强烈建议您从 subversion 存储库获取最新版本。那里可用的更新包括对 Delphi 2009 的支持。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-12T14:13:16.917

对于 Delphi 电子邮件，我会推荐 SakEmail
[http://groups.yahoo.com/group/sakemail/](http://groups.yahoo.com/group/sakemail/)
如果您使用的 delphi 版本高于 7，
则应将版本定义添加到 .inc 文件中。
这是 SakEmail 提供的，否则它将回退到
Delphi4 兼容模式。
修补 inc 文件后，Delphi 2005似乎很好。

此外，似乎 HTML over MAPI 在 Thunderbird 中工作，但没有其他客户端。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-16T21:17:01.960

**`MAPISendMail`**包含 HTML 正文有一个未记录的功能：

*   设置`lpszNoteText`为`nil`（或指向*空字符串*的指针）
*   添加 HTML 附件

MAPI 将使用 html 附件作为电子邮件的正文（不包括附件）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T16:05:24.750

您可以将 SMTP 与 Indy 一起使用：
[HTML 消息](http://www.indyproject.org/Sockets/Blogs/RLebeau/2005_08_17_A.EN.aspx)
[新的 HTML 消息生成器类](http://www.indyproject.org/Sockets/Blogs/RLebeau/20080116.EN.aspx)(Indy 10)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-12T19:24:16.977

您应该考虑使用 SMTP 组件，例如 Indy，并将执行发送的用户添加到消息的 CC 或 BCC 字段。这在很大程度上满足了让此类发送的消息出现在用户自己的邮件客户端中的需要，这是 MAPI 的主要优势。用户甚至可以设置专门用于接收此类副本的单独帐户。

这样做可以让您完全自定义与发送邮件相关的每个细节（MHTML 就是这样一个示例），包括缓存所有邮件并在单独的线程中或在不同的时间发送等等。此外，这种方法甚至比 MAPI 更与客户端无关；例如，即使用户使用 Gmail 等基于网络的电子邮件，这仍然有效。

# .net - 在具有自定义类型的 WSE 服务中，构造函数是否在消费客户端工作？

> ID：673520
> 
> 赞同：0
> 
> 时间：2009-03-23T14:13:01.463
> 
> 标签：.net, web-services, wse

我在 WSE Web 服务中有自定义类型。

在实例化一个类时，消费客户端似乎看不到我的构造函数，这正常吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T14:14:54.967

是的。

Web 服务不传递对象，它们传递消息。客户端的类只是该消息属性的持有者，除此之外它不会有实现。

# windows - 如何在 Windows 命令行上测量命令的执行时间？

> ID：673523
> 
> 赞同：585
> 
> 时间：2009-03-23T14:13:43.520
> 
> 标签：windows, batch-file, time, cmd, windows-server-2003

是否有内置方法来测量 Windows 命令行上命令的执行时间？

* * *

## 回答 #1

> 赞同：581
> 
> 时间：2011-01-26T04:55:26.650

PowerShell 有一个用于此的 cmdlet，称为`Measure-Command`. 您必须确保 PowerShell 在运行它的机器上可用。

```
PS> Measure-Command { echo hi }

Days              : 0
Hours             : 0
Minutes           : 0
Seconds           : 0
Milliseconds      : 0
Ticks             : 1318
TotalDays         : 1.52546296296296E-09
TotalHours        : 3.66111111111111E-08
TotalMinutes      : 2.19666666666667E-06
TotalSeconds      : 0.0001318
TotalMilliseconds : 0.1318 
```

`Measure-Command`捕获命令的输出。您可以使用以下命令将输出重定向回控制台`Out-Default`：

```
PS> Measure-Command { echo hi | Out-Default }
hi

Days              : 0
... 
```

正如[Makotoe](https://stackoverflow.com/users/4386643/makotoe)评论的那样，[`Measure-Command`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/measure-command?view=powershell-7)返回一个[`TimeSpan`](https://docs.microsoft.com/en-us/dotnet/api/system.timespan?view=netcore-3.1)对象，因此测量的时间被打印为一堆字段。您可以使用以下方法将对象格式化为时间戳字符串`ToString()`：

```
PS> (Measure-Command { echo hi | Out-Default }).ToString()
hi
00:00:00.0001318 
```

如果里面的命令`Measure-Command`改变了您的控制台文本颜色，请使用`[Console]::ResetColor()`将其重置为正常。

* * *

## 回答 #2

> 赞同：338
> 
> 时间：2011-06-02T01:08:31.420

如果你想

1.  以（hh:mm:ss.ff 格式）将执行时间测量到百分之一秒
2.  不必下载和安装资源包
3.  看起来像一个巨大的 DOS 书呆子（谁没有）

尝试将以下脚本复制到一个新的批处理文件中（例如**timecmd.bat**）：

```
@echo off
@setlocal

set start=%time%

:: Runs your command
cmd /c %*

set end=%time%
set options="tokens=1-4 delims=:.,"
for /f %options% %%a in ("%start%") do set start_h=%%a&set /a start_m=100%%b %% 100&set /a start_s=100%%c %% 100&set /a start_ms=100%%d %% 100
for /f %options% %%a in ("%end%") do set end_h=%%a&set /a end_m=100%%b %% 100&set /a end_s=100%%c %% 100&set /a end_ms=100%%d %% 100

set /a hours=%end_h%-%start_h%
set /a mins=%end_m%-%start_m%
set /a secs=%end_s%-%start_s%
set /a ms=%end_ms%-%start_ms%
if %ms% lss 0 set /a secs = %secs% - 1 & set /a ms = 100%ms%
if %secs% lss 0 set /a mins = %mins% - 1 & set /a secs = 60%secs%
if %mins% lss 0 set /a hours = %hours% - 1 & set /a mins = 60%mins%
if %hours% lss 0 set /a hours = 24%hours%
if 1%ms% lss 100 set ms=0%ms%

:: Mission accomplished
set /a totalsecs = %hours%*3600 + %mins%*60 + %secs%
echo command took %hours%:%mins%:%secs%.%ms% (%totalsecs%.%ms%s total) 
```

**用法**

如果将 timecmd.bat 放在路径中的目录中，则可以从任何地方调用它，如下所示：

```
timecmd [your command] 
```

例如

```
C:\>timecmd pause
Press any key to continue . . .
command took 0:0:1.18 
```

如果要进行输出重定向，可以引用如下命令：

```
timecmd "dir c:\windows /s > nul" 
```

这应该处理从午夜之前到午夜之后运行的命令，但是如果您的命令运行 24 小时或更长时间，输出将是错误的。

* * *

## 回答 #3

> 赞同：262
> 
> 时间：2010-03-10T14:28:53.990

呵呵，最简单的解决办法可能是这样的：

```
echo %time%
YourApp.exe
echo %time% 
```

这适用于所有开箱即用的 Windows。

* * *

如果应用程序使用控制台输出，将开始时间存储在临时变量中可能会很方便：

```
set startTime=%time%
YourApp.exe
echo Start Time: %startTime%
echo Finish Time: %time% 
```

* * *

## 回答 #4

> 赞同：123
> 
> 时间：2015-08-30T12:40:33.513

[只是对 Casey.K](https://stackoverflow.com/a/4801509/938111)关于使用[`Measure-Command`](https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Measure-Command)PowerShell[的](https://en.wikipedia.org/wiki/PowerShell)答案的一点扩展：

1.  您可以从标准命令提示符调用 PowerShell，如下所示：

    ```
    powershell -Command "Measure-Command {echo hi}" 
    ```

2.  `| Out-Default`这会吃掉标准输出，但您可以通过从 PowerShell 中添加这样的内容来防止这种情况发生：

    ```
    Measure-Command {echo hi | Out-Default} 
    ```

    或者从命令提示符：

    ```
    powershell -Command "Measure-Command {echo hi | Out-Default}" 
    ```

当然，您可以自由地将其包装在脚本文件`*.ps1`或`*.bat`.

* * *

## 回答 #5

> 赞同：118
> 
> 时间：2009-04-15T15:44:29.010

如果您使用的是 Windows 2003（请注意不支持 Windows Server 2008 及更高版本），您可以使用 Windows Server 2003 资源工具包，其中包含显示详细执行统计信息的 timeit.exe。这是一个示例，对命令“timeit -?”进行计时：

```
C:\>timeit timeit -?
Invalid switch -?
Usage: TIMEIT [-f filename] [-a] [-c] [-i] [-d] [-s] [-t] [-k keyname | -r keyname] [-m mask] [commandline...]
where:        -f specifies the name of the database file where TIMEIT
                 keeps a history of previous timings.  Default is .\timeit.dat
              -k specifies the keyname to use for this timing run
              -r specifies the keyname to remove from the database.  If
                 keyname is followed by a comma and a number then it will
                 remove the slowest (positive number) or fastest (negative)
                 times for that keyname.
              -a specifies that timeit should display average of all timings
                 for the specified key.
              -i specifies to ignore non-zero return codes from program
              -d specifies to show detail for average
              -s specifies to suppress system wide counters
              -t specifies to tabular output
              -c specifies to force a resort of the data base
              -m specifies the processor affinity mask

Version Number:   Windows NT 5.2 (Build 3790)
Exit Time:        7:38 am, Wednesday, April 15 2009
Elapsed Time:     0:00:00.000
Process Time:     0:00:00.015
System Calls:     731
Context Switches: 299
Page Faults:      515
Bytes Read:       0
Bytes Written:    0
Bytes Other:      298 
```

您可以在 Windows 2003 Resource Kit 中获得 TimeIt。它不能从 Microsoft 下载中心直接下载，但仍然可以从[archive.org - Windows Server 2003 Resource Kit Tools](http://web.archive.org/web/20150327014146/http://www.microsoft.com/en-us/download/details.aspx?id=17657 "Windows 2003 资源工具包")获得。

* * *

## 回答 #6

> 赞同：55
> 
> 时间：2010-06-23T20:44:03.463

我在 Windows Server 2008 R2 中使用的单线是：

```
cmd /v:on /c "echo !TIME! & *mycommand* & echo !TIME!" 
```

只要*mycommand*不需要引号（这与 cmd 的引号处理有关）。这`/v:on`是为了允许独立评估两个不同的 TIME 值，而不是在执行命令时评估一次。

* * *

## 回答 #7

> 赞同：52
> 
> 时间：2009-03-23T14:51:10.247

如果您打开命令窗口并手动调用命令，则可以在每个提示符上显示时间戳，例如

```
prompt $d $t $_$P$G 
```

它给了你类似的东西：

> `23.03.2009 15:45:50,77`
> 
> `C:\>`

如果您有一个执行命令的小批量脚本，请在每个命令之前留一个空行，例如

> （空行）
> 
> 我的命令
> 
> （下一个空行）
> 
> 我的命令2.exe

您可以通过提示符中的时间信息来计算每个命令的执行时间。最好的可能是将输出通过管道传输到文本文件以进行进一步分析：

```
MyBatchFile.bat > output.txt 
```

* * *

## 回答 #8

> 赞同：29
> 
> 时间：2011-06-02T01:34:11.667

由于其他人建议安装免费软件和 PowerShell 之类的东西，您还可以安装[Cygwin](http://www.cygwin.com)，它可以让您访问许多基本的 Unix 命令，例如[time](http://en.wikipedia.org/wiki/Time_%28Unix%29)：

```
abe@abe-PC:~$ time sleep 5

real    0m5.012s
user    0m0.000s
sys 0m0.000s 
```

不确定 Cygwin 增加了多少开销。

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2009-03-23T14:32:51.930

不如 Unix 上的某些功能那么优雅，但创建一个 cmd 文件，如下所示：

```
@echo off
time < nul
yourexecutable.exe > c:\temp\output.txt
time < nul
rem on newer windows system you can try time /T 
```

这将显示开始和停止时间，如下所示：

```
The current time is: 10:31:57.92
Enter the new time:
The current time is: 10:32:05.94
Enter the new time: 
```

* * *

## 回答 #10

> 赞同：20
> 
> 时间：2009-08-03T17:35:09.450

我使用名为“GS Timer”的免费软件。

只需像这样制作一个批处理文件：

```
timer
yourapp.exe
timer /s 
```

如果您需要一组时间，只需将 timer /s 的输出通过管道传输到 .txt 文件中。

你可以在这里得到它：[Gammadyne 的免费 DOS 实用程序](http://www.gammadyne.com/cmdline.htm#timer)

* * *

分辨率为 0.1 秒。

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2012-03-06T05:52:46.163

我使用的是 Windows XP，由于某种原因 timeit.exe 对我不起作用。我找到了另一种选择 - PTIME。这很好用。

[http://www.pc-tools.net/win32/ptime/](http://www.pc-tools.net/win32/ptime/)

例子 -

```
C:\> ptime

ptime 1.0 for Win32, Freeware - http://www.pc-tools.net/
Copyright(C) 2002, Jem Berkes <jberkes@pc-tools.net>

Syntax: ptime command [arguments ...]

ptime will run the specified command and measure the execution time
(run time) in seconds, accurate to 5 millisecond or better. It is an
automatic process timer, or program timer.

C:\> ptime cd

ptime 1.0 for Win32, Freeware - http://www.pc-tools.net/
Copyright(C) 2002, Jem Berkes <jberkes@pc-tools.net>

===  cd ===
C:\

Execution time: 0.015 s 
```

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2011-03-10T16:25:28.687

只要不超过24小时...

```
@echo off

set starttime=%TIME%
set startcsec=%STARTTIME:~9,2%
set startsecs=%STARTTIME:~6,2%
set startmins=%STARTTIME:~3,2%
set starthour=%STARTTIME:~0,2%
set /a starttime=(%starthour%*60*60*100)+(%startmins%*60*100)+(%startsecs%*100)+(%startcsec%)

:TimeThis
ping localhost 

set endtime=%time%
set endcsec=%endTIME:~9,2%
set endsecs=%endTIME:~6,2%
set endmins=%endTIME:~3,2%
set endhour=%endTIME:~0,2%
if %endhour% LSS %starthour% set /a endhour+=24
set /a endtime=(%endhour%*60*60*100)+(%endmins%*60*100)+(%endsecs%*100)+(%endcsec%)

set /a timetaken= ( %endtime% - %starttime% )
set /a timetakens= %timetaken% / 100
set timetaken=%timetakens%.%timetaken:~-2%

echo.
echo Took: %timetaken% sec. 
```

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2013-01-21T11:03:51.887

还有[TimeMem](http://code.google.com/p/time-windows/)（2012 年 3 月）：

> 这是一个 Windows 实用程序，它执行程序并显示其执行时间、内存使用情况和 IO 统计信息。它的功能类似于 Unix 时间实用程序。

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2015-12-20T22:40:08.773

这里有一个

## 后缀计时器版本：

使用示例：

*超时 1* **| TimeIt.cmd**

```
Execution took  ~969 milliseconds. 
```

将其复制并粘贴到一些编辑器中，例如[Notepad++](https://notepad-plus-plus.org)并将其保存为**TimeIt.cmd**：

```
:: --- TimeIt.cmd ----
    @echo off
    setlocal enabledelayedexpansion

    call :ShowHelp

    :: Set pipeline initialization time
    set t1=%time%

    :: Wait for stdin
    more

    :: Set time at which stdin was ready
    set t2=!time!

    :: Calculate difference
    Call :GetMSeconds Tms1 t1
    Call :GetMSeconds Tms2 t2

    set /a deltaMSecs=%Tms2%-%Tms1%
    echo Execution took ~ %deltaMSecs% milliseconds.

    endlocal
goto :eof

:GetMSeconds
    Call :Parse        TimeAsArgs %2
    Call :CalcMSeconds %1 %TimeAsArgs%

goto :eof

:CalcMSeconds
    set /a %1= (%2 * 3600*1000) + (%3 * 60*1000) + (%4 * 1000) + (%5)
goto :eof

:Parse

    :: Mask time like " 0:23:29,12"
    set %1=!%2: 0=0!

    :: Replace time separators with " "
    set %1=!%1::= !
    set %1=!%1:.= !
    set %1=!%1:,= !

    :: Delete leading zero - so it'll not parsed as octal later
    set %1=!%1: 0= !
goto :eof

:ShowHelp
    echo %~n0 V1.0 [Dez 2015]
    echo.
    echo Usage: ^<Command^> ^| %~nx0
    echo.
    echo Wait for pipe getting ready... :)
    echo  (Press Ctrl+Z ^<Enter^> to Cancel)
goto :eof 
```

^ - 基于[“丹尼尔斯帕克斯”版本](https://stackoverflow.com/a/19804504/3135511)

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2019-02-23T22:23:26.660

根据您使用的 Windows 版本，只需运行即可`bash`让您进入 Bash 模式。这将允许您直接使用 PowerShell 上不可用的一堆命令（如`time`命令）。计时命令现在就像执行一样简单：

```
# The clause <your-command> (without the angle brackets) denotes the command you want to run.
$ time <your-command> 
```

> **注意：**`exit`您可以通过在 Bash 模式下运行轻松退出 Bash 模式并返回主流 shell 。

在尝试了`Measure-Command`有时会产生不希望的统计数据的其他方法（例如）之后，这对我来说非常有效（Windows 10）。希望这也适用于你。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2015-09-02T00:41:31.143

[这是一种避免延迟扩展](http://ss64.com/nt/delayedexpansion.html)的单行程序，这可能会干扰某些命令：

```
cmd /E /C "prompt $T$$ & echo.%TIME%$ & COMMAND_TO_MEASURE & for %Z in (.) do rem/ " 
```

输出类似于：

> ```
> 14:30:27.58$
> ...
> 14:32:43.17$ rem/ 
> ```

对于长期测试，请替换`$T`by`$D, $T`和`%TIME%`by`%DATE%, %TIME%`以包括日期。

要在**批处理文件**中使用它，请替换`%Z`为`%%Z`.

* * *

### 更新

这是一个**改进的单线**（也没有[延迟扩展](http://ss64.com/nt/delayedexpansion.html)）：

```
cmd /E /C "prompt $D, $T$$ & (for %# in (.) do rem/ ) & COMMAND_TO_MEASURE & for %# in (.) do prompt" 
```

输出类似于：

> ```
> 2015/09/01, 14:30:27.58$ rem/ 
> ...
> 2015/09/01, 14:32:43.17$ prompt 
> ```

这种方法不包括在结果中实例化新`cmd`的过程，也不包括`prompt`命令。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2018-09-21T14:07:25.340

测量时间的替代方法是简单的“获取日期”。您没有转发输出等的麻烦。

```
$start = Get-Date
[System.Threading.Thread]::Sleep(1500)
$(Get-Date) - $start 
```

输出：

```
Days              : 0
Hours             : 0
Minutes           : 0
Seconds           : 1
Milliseconds      : 506
Ticks             : 15060003
TotalDays         : 1.74305590277778E-05
TotalHours        : 0.000418333416666667
TotalMinutes      : 0.025100005
TotalSeconds      : 1.5060003
TotalMilliseconds : 1506.0003 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2016-02-20T14:37:45.653

这是我的方法，没有转换也没有毫秒。确定编码持续时间很有用（但仅限于 24 小时）：

```
@echo off

:start
REM Start time storage
set ST=%time%
echo Process started at %ST%
echo.
echo.

REM Your commands
REM Your commands
REM Your commands

:end
REM Start Time Definition
for /f "tokens=1-3 delims=:" %%a in ("%ST%") do set /a h1=%%a & set /a m1=%%b & set /a s1=%%c

REM End Time Definition
for /f "tokens=1-3 delims=:" %%a in ("%TIME%") do set /a h2=%%a & set /a m2=%%b & set /a s2=%%c

REM Difference
set /a h3=%h2%-%h1% & set /a m3=%m2%-%m1% & set /a s3=%s2%-%s1%

REM Time Adjustment
if %h3% LSS 0 set /a h3=%h3%+24
if %m3% LSS 0 set /a m3=%m3%+60 & set /a h3=%h3%-1
if %s3% LSS 0 set /a s3=%s3%+60 & set /a m3=%m3%-1

echo Start    :    %ST%
echo End    :    %time%
echo.
echo Total    :    %h3%:%m3%:%s3%
echo.
pause 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-08-01T01:45:02.887

我的代码以毫秒为单位为您提供运行时间，最长为 24 小时，它对语言环境不敏感，并且如果代码运行到午夜则考虑负值。它使用延迟扩展，应保存在 cmd/bat 文件中。

**在您的代码之前：**

```
SETLOCAL EnableDelayedExpansion

for /f "tokens=2 delims==" %%I in ('wmic os get localdatetime /format:list') do set t=%%I
set /a t1 = %t:~8,1%*36000 + %t:~9,1%*3600 + %t:~10,1%*600 + %t:~11,1%*60 + %t:~12,1%*10 + %t:~13,1% && set t1=!t1!%t:~15,3% 
```

**在你的代码之后：**

```
for /f "tokens=2 delims==" %%I in ('wmic os get localdatetime /format:list') do set t=%%I
set /a t2 = %t:~8,1%*36000 + %t:~9,1%*3600 + %t:~10,1%*600 + %t:~11,1%*60 + %t:~12,1%*10 + %t:~13,1% && set t2=!t2!%t:~15,3%
set /a t2-=t1 && if !t2! lss 0 set /a t2+=24*3600000 
```

**如果您想要 HH:mm:ss.000 格式的运行时间，请添加：**

```
set /a "h=t2/3600000,t2%%=3600000,m=t2/60000,t2%%=60000" && set t2=00000!t2!&& set t2=!t2:~-5!
if %h% leq 9 (set h=0%h%) && if %m% leq 9 (set m=0%m%)
set t2=%h%:%m%:%t2:~0,2%.%t2:~2,3%

ENDLOCAL 
```

变量`t2`保存你的运行时间，你可以`echo %t2%`显示它。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-07-16T03:30:29.817

1.  在您的程序所在的目录中，键入`notepad mytimer.bat`，单击“是”以创建一个新文件。

2.  粘贴下面的代码，替换`YourApp.exe`为您的程序，然后保存。

    ```
    @echo off
    date /t
    time /t
    YourApp.exe
    date /t
    time /t 
    ```

3.  在命令行中输入`mytimer.bat`，然后按 Enter。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-05-23T19:34:47.917

万一其他人来这里寻找这个问题的答案，有一个名为[`GetProcessTimes()`](http://msdn.microsoft.com/en-us/library/ms683223%28VS.85%29.aspx). 编写一个可以启动命令、进行调用并返回处理时间的小 C 程序看起来并不需要太多工作。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2014-02-20T11:32:51.133

*这*是对 Luke Sampson 的评论/编辑，`timecmd.bat`并回复

> 出于某种原因，这只会给我整秒钟的输出……这对我来说没用。我的意思是我运行 timecmd pause，它总是导致 1.00 秒、2.00 秒、4.00 秒……甚至 0.00 秒！Windows 7\. – Camilo Martin 2013 年 9 月 25 日 16:00

在某些配置中，分隔符可能不同。以下更改应至少涵盖大多数西方国家。

```
set options="tokens=1-4 delims=:,." (added comma) 
```

添加“，”后，`%time%`毫秒在我的系统上工作

（*因为网站不允许匿名评论，并且即使我总是使用相同的访客电子邮件，结合 ipv6 ip 和浏览器指纹，也不能很好地跟踪身份，应该足以在没有密码的情况下唯一识别）

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2012-07-31T11:05:37.177

```
@echo off & setlocal

set start=%time%

REM Do stuff to be timed here.
REM Alternatively, uncomment the line below to be able to
REM pass in the command to be timed when running this script.
REM cmd /c %*

set end=%time%

REM Calculate time taken in seconds, to the hundredth of a second.
REM Assumes start time and end time will be on the same day.

set options="tokens=1-4 delims=:."

for /f %options% %%a in ("%start%") do (
    set /a start_s="(100%%a %% 100)*3600 + (100%%b %% 100)*60 + (100%%c %% 100)"
    set /a start_hs=100%%d %% 100
)

for /f %options% %%a in ("%end%") do (
    set /a end_s="(100%%a %% 100)*3600 + (100%%b %% 100)*60 + (100%%c %% 100)"
    set /a end_hs=100%%d %% 100
)

set /a s=%end_s%-%start_s%
set /a hs=%end_hs%-%start_hs%

if %hs% lss 0 (
    set /a s=%s%-1
    set /a hs=100%hs%
)
if 1%hs% lss 100 set hs=0%hs%

echo.
echo  Time taken: %s%.%hs% secs
echo. 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-11-06T05:03:36.160

以下脚本仅使用“cmd.exe”并输出从创建管道到脚本之前的进程退出的毫秒数。即，键入您的命令，然后通过管道传送到脚本。示例：“timeout 3 | runtime.cmd”应该产生类似“2990”的结果。如果您需要运行时输出和标准输入输出，请在管道之前重定向标准输入 - 例如：“dir /s 1>temp.txt | runtime.cmd”会将“dir”命令的输出转储到“temp.txt”并将运行时打印到控制台。

```
:: --- runtime.cmd ----
@echo off
setlocal enabledelayedexpansion

:: find target for recursive calls
if not "%1"=="" (
    shift /1
    goto :%1
    exit /b
)

:: set pipeline initialization time
set t1=%time%

:: wait for stdin
more > nul

:: set time at which stdin was ready
set t2=!time!

::parse t1
set t1=!t1::= !
set t1=!t1:.= !
set t1=!t1: 0= !

:: parse t2
set t2=!t2::= !
set t2=!t2:.= !
set t2=!t2: 0= !

:: calc difference
pushd %~dp0
for /f %%i in ('%0 calc !t1!') do for /f %%j in ('%0 calc !t2!') do (
    set /a t=%%j-%%i
    echo !t!
)
popd
exit /b
goto :eof

:calc
set /a t=(%1*(3600*1000))+(%2*(60*1000))+(%3*1000)+(%4)
echo !t!
goto :eof

endlocal 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-11-20T11:47:03.000

[driblio](https://stackoverflow.com/a/5262637/587239)的答案可以做得更短一些（虽然可读性不强）

```
@echo off

:: Calculate the start timestamp
set _time=%time%
set /a _hours=100%_time:~0,2%%%100,_min=100%_time:~3,2%%%100,_sec=100%_time:~6,2%%%100,_cs=%_time:~9,2%
set /a _started=_hours*60*60*100+_min*60*100+_sec*100+_cs

:: yourCommandHere

:: Calculate the difference in cSeconds
set _time=%time%
set /a _hours=100%_time:~0,2%%%100,_min=100%_time:~3,2%%%100,_sec=100%_time:~6,2%%%100,_cs=%_time:~9,2%
set /a _duration=_hours*60*60*100+_min*60*100+_sec*100+_cs-_started

:: Populate variables for rendering (100+ needed for padding)
set /a _hours=_duration/60/60/100,_min=100+_duration/60/100%%60,_sec=100+(_duration/100%%60%%60),_cs=100+_duration%%100

echo Done at: %_time% took : %_hours%:%_min:~-2%:%_sec:~-2%.%_cs:~-2%

::prints something like:
::Done at: 12:37:53,70 took: 0:02:03.55 
```

根据 Luke Sampson的[说法](https://stackoverflow.com/questions/673523/how-to-measure-execution-time-of-command-in-windows-command-line#comment7229122_5262637)，这个版本是八进制安全的，尽管任务应该在 24 小时内完成。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2019-03-15T01:07:04.580

在 Perl 安装了可用的招聘解决方案后，运行：

```
C:\BATCH>time.pl "echo Fine result"
0.01063
Fine result 
```

STDERR 出现在测量秒数之前

```
#!/usr/bin/perl -w

use Time::HiRes qw();
my $T0 = [ Time::HiRes::gettimeofday ];

my $stdout = `@ARGV`;

my $time_elapsed = Time::HiRes::tv_interval( $T0 );

print $time_elapsed, "\n";
print $stdout; 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2020-11-12T00:37:54.680

powershell的另一种方法：

```
@echo off
for /f %%t in ('powershell "(get-date).tofiletime()"') do set mst=%%t

rem some commands

powershell ((get-date).tofiletime() - %mst%) 
```

这将以毫秒为单位打印执行时间。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-03-09T01:32:21.420

以下脚本模拟 *nix 纪元时间，但它是本地和区域的。它应该处理包括闰年在内的日历边缘情况。如果[Cygwin](http://en.wikipedia.org/wiki/Cygwin)可用，则可以通过指定*Cygwin*选项来比较 epoch 值。

我在美国东部标准时间，报告的差异是 4 小时，这是相对正确的。有一些有趣的解决方案可以删除 TZ 和区域依赖项，但我没有注意到任何微不足道的问题。

```
@ECHO off
SETLOCAL EnableDelayedExpansion

::
::  Emulates local epoch seconds
::

:: Call passing local date and time
CALL :SECONDS "%DATE%" "%TIME%"
IF !SECONDS! LEQ 0 GOTO END

:: Not testing - print and exit
IF NOT "%~1"=="cygwin" (
    ECHO !SECONDS!
    GOTO END
)

:: Call on Cygwin to get epoch time
FOR /F %%c IN ('C:\cygwin\bin\date +%%s') DO SET EPOCH=%%c

:: Show the results
ECHO Local Seconds: !SECONDS!
ECHO Epoch Seconds: !EPOCH!

:: Calculate difference between script and Cygwin
SET /A HOURS=(!EPOCH!-!SECONDS!)/3600
SET /A FRAC=(!EPOCH!-!SECONDS!)%%3600

:: Delta hours shown reflect TZ
ECHO Delta Hours: !HOURS! Remainder: !FRAC!

GOTO END

:SECONDS
SETLOCAL  EnableDelayedExpansion

    :: Expecting values from caller
    SET DATE=%~1
    SET TIME=%~2

    :: Emulate Unix epoch time without considering TZ
    SET "SINCE_YEAR=1970"

    :: Regional constraint! Expecting date and time in the following formats:
    ::   Sun 03/08/2015   Day MM/DD/YYYY
    ::   20:04:53.64         HH:MM:SS
    SET VALID_DATE=0
    ECHO !DATE! | FINDSTR /R /C:"^... [0-9 ][0-9]/[0-9 ][0-9]/[0-9][0-9][0-9][0-9]" > nul && SET VALID_DATE=1
    SET VALID_TIME=0
    ECHO !TIME! | FINDSTR /R /C:"^[0-9 ][0-9]:[0-9 ][0-9]:[0-9 ][0-9]" > nul && SET VALID_TIME=1
    IF NOT "!VALID_DATE!!VALID_TIME!"=="11" (
        IF !VALID_DATE! EQU 0  ECHO Unsupported Date value: !DATE! 1>&2
        IF !VALID_TIME! EQU 0  ECHO Unsupported Time value: !TIME! 1>&2
        SET SECONDS=0
        GOTO SECONDS_END
    )

    :: Parse values
    SET "YYYY=!DATE:~10,4!"
    SET "MM=!DATE:~4,2!"
    SET "DD=!DATE:~7,2!"
    SET "HH=!TIME:~0,2!"
    SET "NN=!TIME:~3,2!"
    SET "SS=!TIME:~6,2!"
    SET /A YEARS=!YYYY!-!SINCE_YEAR!
    SET /A DAYS=!YEARS!*365

    :: Bump year if after February  - want leading zeroes for this test
    IF "!MM!!DD!" GEQ "0301" SET /A YEARS+=1

    :: Remove leading zeros that can cause octet probs for SET /A
    FOR %%r IN (MM,DD,HH,NN,SS) DO (
        SET "v=%%r"
        SET "t=!%%r!"
        SET /A N=!t:~0,1!0
        IF 0 EQU !N! SET "!v!=!t:~1!"
    )

    :: Increase days according to number of leap years
    SET /A DAYS+=(!YEARS!+3)/4-(!SINCE_YEAR!%%4+3)/4

    :: Increase days by preceding months of current year
    FOR %%n IN (31:1,28:2,31:3,30:4,31:5,30:6,31:7,31:8,30:9,31:10,30:11) DO (
        SET "n=%%n"
        IF !MM! GTR !n:~3! SET /A DAYS+=!n:~0,2!
    )

    :: Multiply and add it all together
    SET /A SECONDS=(!DAYS!+!DD!-1)*86400+!HH!*3600+!NN!*60+!SS!

:SECONDS_END
ENDLOCAL & SET "SECONDS=%SECONDS%"
GOTO :EOF

:END
ENDLOCAL 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2016-05-09T13:22:45.070

使用 sub 以百分之一秒返回时间

```
::tiemeit.cmd
@echo off
Setlocal EnableDelayedExpansion

call :clock 

::call your_command  or more > null to pipe this batch after your_command

call :clock

echo %timed%
pause
goto:eof

:clock
if not defined timed set timed=0
for /F "tokens=1-4 delims=:.," %%a in ("%time%") do ( 
set /A timed = "(((1%%a - 100) * 60 + (1%%b - 100)) * 60 + (1%%c - 100))  * 100 + (1%%d - 100)- %timed%"
)
goto:eof 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2017-05-16T06:08:33.360

**具有区域格式、24 小时和混合输入的“精益和平均”计时器支持**
适应[Aacini 的](https://stackoverflow.com/questions/9922498/calculate-time-difference-in-windows-batch-file/9935540#9935540)替换方法主体，没有 IF，只有一个 FOR（我的区域修复）

1：文件**timer.bat**放置在 %PATH% 或当前目录中的某处

```
@echo off & rem :AveYo: compact timer function with Regional format, 24-hours and mixed input support
if not defined timer_set (if not "%~1"=="" (call set "timer_set=%~1") else set "timer_set=%TIME: =0%") & goto :eof
(if not "%~1"=="" (call set "timer_end=%~1") else set "timer_end=%TIME: =0%") & setlocal EnableDelayedExpansion
for /f "tokens=1-6 delims=0123456789" %%i in ("%timer_end%%timer_set%") do (set CE=%%i&set DE=%%k&set CS=%%l&set DS=%%n)
set "TE=!timer_end:%DE%=%%100)*100+1!"     & set "TS=!timer_set:%DS%=%%100)*100+1!"
set/A "T=((((10!TE:%CE%=%%100)*60+1!%%100)-((((10!TS:%CS%=%%100)*60+1!%%100)" & set/A "T=!T:-=8640000-!"
set/A "cc=T%%100+100,T/=100,ss=T%%60+100,T/=60,mm=T%%60+100,hh=T/60+100"
set "value=!hh:~1!%CE%!mm:~1!%CE%!ss:~1!%DE%!cc:~1!" & if "%~2"=="" echo/!value!
endlocal & set "timer_end=%value%" & set "timer_set=" & goto :eof 
```

用法：
**timer** *& echo start_cmds & timeout /t 3 & echo end_cmds &* **timer**
**timer** & **timer** "23:23:23,00"
**timer** "23:23: 23,00" & **timer**
**timer** "13.23.23,00" & **timer** "03:03:03.00"
**定时器**和**定时器**"0:00:00.00" no & cmd /v:on /c 回显直到午夜=！timer_end！
*现在可以混合输入，因为在执行期间那些不太可能但可能的时间格式更改*

2：函数**:timer**与批处理脚本捆绑在一起（示例用法如下）：

```
@echo off
set "TIMER=call :timer" & rem short macro
echo.
echo EXAMPLE:
call :timer
timeout /t 3 >nul & rem Any process here..
call :timer
echo.
echo SHORT MACRO:
%TIMER% & timeout /t 1 & %TIMER% 
echo.
echo TEST INPUT:
set "start=22:04:04.58"
set "end=04.22.44,22"
echo %start% ~ start & echo %end% ~ end
call :timer "%start%"
call :timer "%end%"
echo.
%TIMER% & %TIMER% "00:00:00.00" no 
echo UNTIL MIDNIGHT: %timer_end%
echo.
pause 
exit /b 
```

::*测试它，复制粘贴上面和下面的代码部分*

```
rem :AveYo: compact timer function with Regional format, 24-hours and mixed input support 
:timer Usage " call :timer [input - optional] [no - optional]" :i Result printed on second call, saved to timer_end 
if not defined timer_set (if not "%~1"=="" (call set "timer_set=%~1") else set "timer_set=%TIME: =0%") & goto :eof
(if not "%~1"=="" (call set "timer_end=%~1") else set "timer_end=%TIME: =0%") & setlocal EnableDelayedExpansion
for /f "tokens=1-6 delims=0123456789" %%i in ("%timer_end%%timer_set%") do (set CE=%%i&set DE=%%k&set CS=%%l&set DS=%%n)
set "TE=!timer_end:%DE%=%%100)*100+1!"     & set "TS=!timer_set:%DS%=%%100)*100+1!"
set/A "T=((((10!TE:%CE%=%%100)*60+1!%%100)-((((10!TS:%CS%=%%100)*60+1!%%100)" & set/A "T=!T:-=8640000-!"
set/A "cc=T%%100+100,T/=100,ss=T%%60+100,T/=60,mm=T%%60+100,hh=T/60+100"
set "value=!hh:~1!%CE%!mm:~1!%CE%!ss:~1!%DE%!cc:~1!" & if "%~2"=="" echo/!value!
endlocal & set "timer_end=%value%" & set "timer_set=" & goto :eof 
```

*CE,DE 和 CS,DS 代表冒号结尾，点结尾和冒号集，点集 - 用于混合格式支持*

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-11-12T12:56:31.493

### 将纯 PHP 用于 cmd 和一个 env 的解决方案。多变的：

```
@echo off
setlocal enableextensions

REM set start time env var
FOR /F "tokens=* USEBACKQ" %%F IN (`php -r "echo microtime(true);"`) DO ( SET start_time=%%F )

## PUT_HERE_THE_COMMAND_TO_RUN ##

REM echo elapsed time
php -r "echo 'elapsed: ' . (round(microtime(true) - trim(getenv('start_time')), 2)) . ' seconds' . mb_convert_encoding('&#13;&#10;', 'UTF-8', 'HTML-ENTITIES');" 
```

*   不需要 cygwin 或不受信任的实用程序。当 PHP 在本地可用时很有用

*   精度和输出格式可以轻松调整

*   相同的想法可以移植到 PowerShell

# web-services - SQL CE OutOfMemoryException 使用 Web 服务

> ID：673526
> 
> 赞同：1
> 
> 时间：2009-03-23T14:14:20.087
> 
> 标签：web-services, windows-mobile, windows-ce

尝试通过 Web 服务下载文档时，我们不断收到 OutOfMemory 异常。我们将文档字节数组数据存储为序列化消息对象的一部分，原始文档的大小均约为 500kb。消息对象图中唯一的另一件事是用于关联的两个字符串属性。

我们已尝试检索具有相同问题的压缩和未压缩文档。现在我*相信*在尝试反序列化消息而不是在下载流时引发了异常。

我知道这是一个模糊的问题，但是你们中的任何人都知道是什么原因造成的吗？此处传输的数据量似乎很小，传输时设备上几乎没有发生其他事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T14:21:03.877

Windows Mobile 设备上的内存非常紧张——使用它确实是一个痛苦的世界。首先，一个进程的总内存是（如果我没记错的话）32 MB。现在，它不仅被代码内内存分配填满，而且还被从 DLL、EXE 等加载的代码填满。

现在，当您将 500KB 下载到字节数组中时，它不仅需要 500KB。它需要 500KB 的 CONTIGUOUS MEMORY，一旦应用程序运行了一小段时间，它就不太可能找到。

我的建议是直接使用 HttpRequest 而不是 Web 服务下载文件。也许网络服务可以传回您需要的 URL 或类似的东西。但是直接下载文件，您可以分块处理它——读取 8K，然后将该 8K 写入磁盘，然后再读取另一个 8K，等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T14:21:03.173

为了获得 OutOfMemory 异常，代码要么存在消耗内存的错误，直到设备没有更多内存，要么设备通常没有足够的内存来处理甚至 500Kb 的变化。

您说“在尝试下载文档时”也许您将它们保存在内存中并且您得到了异常。

# .net - TransactionScope 和多线程

> ID：673530
> 
> 赞同：47
> 
> 时间：2009-03-23T14:15:28.960
> 
> 标签：.net, multithreading, transactions, transactionscope

我想知道在处理多线程时如何以正确的方式使用 TransactionScope 类？

我们在主线程中创建了一个新范围，然后生成了几个工作线程，我们希望它们参与主范围，例如，如果范围从未完成，则在每个工作线程上调用回滚。

我在内部使用 ThreadStaticAttribute 阅读了有关 TransactionScope 的一些内容，这使得上述不可能/非常困难 - 有人可以验证任何一种方式吗？如果我们以同步方式运行我们的代码，那么回滚工作，即内部事务能够参与主事务，但如果我们切换到线程执行则不能。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-23T14:36:02.983

见[MSDN](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)：

> 对于需要跨多个函数调用或多个线程调用使用相同事务的应用程序，您还应该使用 TransactionScope 和 DependentTransaction 类。

所以也许看看`DependentTransaction`- 特别是，这里有一个工作线程[示例](http://msdn.microsoft.com/en-us/library/system.transactions.dependenttransaction.aspx)。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-23T16:25:15.607

这是正确的：`TransactionScope`该类使用`Transaction.Current`将其值存储在字段中的属性，该字段用`ThreadStatic`属性​​标记。

该`ThreadStatic`属性确保字段值获得线程亲和性，即它在每个线程中具有唯一值。这是在线程*内*共享数据的推荐方法。它也称为[线程本地存储](http://en.wikipedia.org/wiki/Thread-Specific_Storage)(TLS)。

该类`TransactionScope`只是在当前线程中定义了一个事务上下文。然而，这并不意味着*您的*代码必须完成该线程中的所有工作。我可以想象一个使用多个线程的复杂计算算法。

# zend-framework - Zend 框架：OpenID 2.0 和定向身份

> ID：673531
> 
> 赞同：3
> 
> 时间：2009-03-23T14:15:36.510
> 
> 标签：zend-framework, openid, directed-identity

我有自定义 OpenID 提供者和消费者。

OpenID URL 应该在消费者应用程序中进行硬编码，并将指向我的自定义提供程序（比如说：[http://login.loc/](http://login.loc/)）。提供者应用程序反过来告诉消费者当前在服务器上登录的身份（例如[http://login.loc/johndoe](http://login.loc/johndoe)）。

它应该与 Stack Overflow 上的 Google 或 Yahoo OpenID 登录实现完全相同。

如何实现登录过程，使用户不需要提供他的 OpenID URL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T16:31:11.723

我发现这种技术称为定向身份，是 OpenID 2.0 的一部分。

[这里](http://barelyenough.org/blog/2007/12/openid-20s-killer-feature/)有一些关于它的一般信息。

描述这一点的规范部分在[这里](http://openid.net/specs/openid-authentication-2_0.html#discovery)。

# design-patterns - 状态机是否适合处理促销系统中的状态变化？

> ID：673535
> 
> 赞同：2
> 
> 时间：2009-03-23T14:15:55.543
> 
> 标签：design-patterns, state-machine

我正在开发促销系统，我刚刚踩到了一些可能用状态机模式处理的东西，但我还没有使用状态机的经验。也许状态机在这种情况下完全没用:) 所以我有一个促销活动，它有一定的持续时间，一些指定的客户、产品、折扣等。每个促销活动也有它的状态。大约有5个州。状态之间的转换是严格定义的——不可能直接将状态 1 更改为状态 3——用户必须先将状态更改为 2。有一些限制，例如“促销处于状态 3-5 时无法添加更多产品”。或者像“只有超级用户可以在状态 3-5 时编辑促销成本”之类的限制。

我刚刚阅读了有关[http://www.codeplex.com/SimpleStateMachine](http://www.codeplex.com/SimpleStateMachine)的信息，但我不确定对于这种情况是否不太复杂。我可以使用以下方式处理服务层中的状态逻辑：

```
if (promotion.state == statesRepository.GetState3() && false == loggedUser.IsInRole("superUser")){
   throw new PromotionStateException("user not allowed to edit promotion in this status");
}
... 
```

或者

```
public void ChangePromotionStatus(promotion, newStatus){
  if (promotion.Status == status1 && newStatus != statesRepo.GetState2()){
    throw new StateTransitionException("unable to change from status 1 to " + newStatus);
  }
} 
```

但我不喜欢这种代码 - 必须有一些更好的方法:) 有人有建议吗？当然，我可以分离关注点并开发诸如 PromotionStatusChangeReviewService、PromotionEditPermissionService 等服务以减少代码耦合，但目前可能有一些更好的解决方案我看不到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T14:23:15.930

五个状态对于状态机来说并不太复杂，但我认为你会通过尝试对一些转换进行特殊或显式处理而遇到一些问题。这里有一些提示：

*   除非您可以以有意义的方式标记状态，否则状态机没有帮助。“状态 3”没有任何意义；您需要将其称为有用的名称，例如“已升级”、“活动”、“已完成”等。

*   状态机模式的一部分假设您有一个分离的实体，它了解状态以及如何在它们之间转换。例如，您不应该使用示例中的方法`ChangePromotionStatus()`，如果不应该允许该状态，它就会爆炸。状态机应该简单地防止不能发生的转换。

*   如果可能的转换数量很少且定义明确，并且标记它们是有意义的，我还建议命名转换。如果转换都做同样的事情但方式略有不同，这可能特别有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T19:33:01.973

John 一针见血——您希望您的流程（使用状态机建模）与您的域实体分离。您的域实体可能不应该直接知道它们正在用于状态机，状态机将根据某些事件管理将它们从状态转换为状态的工作，但它们*会*理解它们所处的每个状态的业务含义，并能够执行或应用与这些州相关的业务规则。

理想情况下，适合由状态机管理的域实体将具有某种状态，充当状态机的状态，并将引发可由状态机用来确定何时适合转换的事件.

但是，如果您的状态确实是*完全*顺序的 - 即它们总是走 abcde 或向后和向前恰好一步，我不确定状态机是否有意义，因为选择下一个状态不需要特殊的上下文- 你只能后退或前进，所以任何有序的状态列表（例如枚举）加上 Next/Previous 逻辑就足够了 - 但现实世界的进程很少是严格线性的，即使它们乍一看可能看起来很脸红.

# wpf - 无法将焦点设置到 UserControl 的子级

> ID：673536
> 
> 赞同：39
> 
> 时间：2009-03-23T14:16:30.267
> 
> 标签：wpf, focus, user-controls, focusmanager

我有一个`UserControl`包含一个`TextBox`. 当我的主窗口加载时，我想将焦点设置到这个文本框，所以我添加`Focusable="True" GotFocus="UC_GotFocus"`到`UserControl`s 定义和`FocusManager.FocusedElement="{Binding ElementName=login}"`我的主窗口定义中。在该`UC_GotFocus`方法中，我只需调用`.Focus()`我想要关注的控件，但这不起作用。

我需要做的就是`TextBox`在`UserControl`应用程序启动时获得焦点。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-07T22:47:59.760

我最近为第一次加载主窗口时通过情节提要显示的登录启动画面解决了这个问题。

我相信修复有两个关键。一个是使包含元素成为焦点范围。另一个是处理由正在加载的窗口触发的情节提要的情节提要完成事件。

该故事板使用户名和密码画布可见，然后逐渐变为 100% 不透明。关键是用户名控件在情节提要运行之前不可见，因此该控件在可见之前无法获得**键盘**焦点。让我失望的是它有“焦点”（即焦点是真的，但事实证明这只是逻辑焦点），直到阅读 Kent Boogaart 之前，我才知道 WPF 有逻辑焦点和键盘焦点的概念回答并查看微软的 WPF[链接文本](http://msdn.microsoft.com/en-us/library/aa969768.aspx)

一旦我这样做了，我的特定问题的解决方案就很简单了：

1）使包含元素成为焦点范围

```
<Canvas FocusManager.IsFocusScope="True" Visibility="Collapsed">
    <TextBox x:Name="m_uxUsername" AcceptsTab="False" AcceptsReturn="False">
    </TextBox>
</Canvas> 
```

2) 将已完成的事件处理程序附加到情节提要

```
 <Storyboard x:Key="Splash Screen" Completed="UserNamePassword_Storyboard_Completed">
...
</Storyboard> 
```

和

3) 将我的用户名 TextBox 设置为在情节提要完成事件处理程序中具有键盘焦点。

```
void UserNamePassword_Storyboard_Completed(object sender, EventArgs e)
{
 m_uxUsername.Focus();
} 
```

请注意，调用 item.Focus() 会导致调用 Keyboard.Focus(this)，因此您无需显式调用 this。请参阅此问题，了解[Keyboard.Focus(item) 和 item.Focus 之间的区别。](https://stackoverflow.com/questions/197088/whats-the-difference-between-keyboard-focusitem-and-item-focus)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-12-02T22:12:43.723

它很愚蠢，但它有效：

弹出一个等待一段时间然后返回并设置所需焦点的线程。它甚至可以在元素宿主的上下文中工作。

```
private void ListView_SelectionChanged(object sender, SelectionChangedEventArgs e)
{

 System.Threading.ThreadPool.QueueUserWorkItem(
                   (a) =>
                        {
                            System.Threading.Thread.Sleep(100);
                            someUiElementThatWantsFocus.Dispatcher.Invoke(
                            new Action(() =>
                            {
                                someUiElementThatWantsFocus.Focus();

                            }));
                        }
                   );

} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-23T15:48:07.740

就在最近，我有一个包含一些 TextBlock 的列表框。我希望能够双击文本块并将其变成一个文本框，然后专注于它并选择所有文本，以便用户可以开始输入新名称（类似于 Adob​​e 图层）

无论如何，我正在通过一个活动来做这件事，但它不起作用。对我来说，这里的灵丹妙药是确保我将事件设置为已处理。我认为它*正在*设置焦点，但是一旦事件沿着路径前进，它就会切换逻辑焦点。

这个故事的寓意是，确保您将事件标记为已处理，这可能是您的问题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-08-06T06:18:34.657

> “在应用程序启动时设置初始焦点时，接收焦点的元素必须连接到 PresentationSource，并且元素必须将 Focusable 和 IsVisible 设置为 true。设置初始焦点的推荐位置是在 Loaded 事件处理程序中”

(MSDN)

只需在窗口（或控件）的构造函数中添加一个“已加载”事件处理程序，然后在该事件处理程序中调用目标控件上的 Focus() 方法。

```
 public MyWindow() {
        InitializeComponent();
        this.Loaded += new RoutedEventHandler(MyWindow_Loaded);
    }

    void MyWindow_Loaded(object sender, RoutedEventArgs e) {
        textBox.Focus();
    } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-09-20T09:08:44.430

因为我尝试了 fuzquat 的解决方案并发现它是最通用的解决方案，所以我想我会分享一个不同的版本，因为有些人抱怨它看起来很乱。所以这里是：

```
 casted.Dispatcher.BeginInvoke(new Action<UIElement>(x =>
                {
                    x.Focus();
                }), DispatcherPriority.ApplicationIdle, casted); 
```

没有 Thread.Sleep，没有 ThreadPool。我希望足够干净。真的可以使用一些代表，所以我可以评论其他人的解决方案。

更新：

由于人们似乎喜欢漂亮的代码：

```
public static class WpfExtensions
{
    public static void BeginInvoke<T>(this T element, Action<T> action, DispatcherPriority priority = DispatcherPriority.ApplicationIdle) where T : UIElement
    {
        element.Dispatcher.BeginInvoke(priority, action);
    }
} 
```

现在你可以这样称呼它：

```
child.BeginInvoke(d => d.Focus()); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T14:26:07.233

WPF 支持两种不同风格的焦点：

1.  键盘焦点
2.  逻辑焦点

该`FocusedElement`属性在焦点范围内获取或设置逻辑焦点。我怀疑你`TextBox` *确实*有逻辑焦点，但它包含的焦点范围不是活动的焦点范围。因此，它*没有*键盘焦点。

所以问题是，你的视觉树中有多个焦点范围吗？

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-09-16T18:30:56.480

1.  将您的用户控件设置为**Focusable="True"** (XAML)
2.  处理控件上的**GotFocus**事件并调用**yourTextBox.Focus()**
3.  处理窗口上的**Loaded**事件并调用**yourControl.Focus()**

在我键入时，我有一个使用此解决方案运行的示例应用程序。如果这对您不起作用，则一定是您的应用程序或环境特定的东西导致了问题。在您最初的问题中，我认为绑定导致了问题。我希望这有帮助。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-07-07T08:48:06.340

我发现了一系列关于 WPF 焦点的博客文章。

*   [第 1 部分：它基本上是焦点](http://julmar.com/blog/programming/part-1-its-basically-focus/)
*   [第 2 部分：在代码中更改 WPF 焦点](http://julmar.com/blog/programming/part-2-changing-wpf-focus-in-code/)
*   [第 3 部分：将焦点转移到 WPF 中的第一个可用元素](http://julmar.com/blog/programming/part-3-shifting-focus-to-the-first-available-element-in-wpf/)

它们都很好读，但第 3 部分专门处理将焦点设置到 UserControl 中的 UI 元素。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-01-24T17:37:59.980

在经历了“WPF Initial Focus Nightmare”并基于堆栈上的一些答案之后，以下证明对我来说是最好的解决方案。

首先，添加您的 App.xaml OnStartup() 以下内容：

```
EventManager.RegisterClassHandler(typeof(Window), Window.LoadedEvent,
          new RoutedEventHandler(WindowLoaded)); 
```

然后在 App.xaml 中添加 'WindowLoaded' 事件：

```
void WindowLoaded(object sender, RoutedEventArgs e)
    {
        var window = e.Source as Window;
        System.Threading.Thread.Sleep(100);
        window.Dispatcher.Invoke(
        new Action(() =>
        {
            window.MoveFocus(new TraversalRequest(FocusNavigationDirection.First));

        }));
    } 
```

必须使用线程问题，因为 WPF 初始焦点主要由于某些框架竞争条件而失败。

我发现以下解决方案最好，因为它在全球范围内用于整个应用程序。

希望能帮助到你...

奥兰

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-31T20:09:57.497

我注意到一个与在 ElementHosts 中托管 WPF UserControls 相关的焦点问题，这些元素主机包含在通过 MdiParent 属性设置为 MDI 子项的 Form 中。

我不确定这是否与其他人遇到的问题相同，但您可以通过以下链接深入了解详细信息。

[在 WindowsForms 子 MDI 表单的 ElementHost 中托管的 WPF UserControl 中设置焦点的问题](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/7d41218e-c2bb-4957-b0b4-aa24efc4d8c2)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-10-30T10:17:48.233

我不喜欢为 UserControl 设置另一个选项卡范围的解决方案。在这种情况下，通过键盘导航时您将有两个不同的插入符号：在窗口上和另一个 - 内部用户控件。我的解决方案只是将焦点从用户控件重定向到内部子控件。将用户控件设置为可聚焦（因为默认情况下为 false）：

```
<UserControl ..... Focusable="True"> 
```

并在代码隐藏中覆盖焦点事件处理程序：

```
protected override void OnGotFocus(RoutedEventArgs e)
{
    base.OnGotFocus(e);
    MyTextBox.Focus();
}

protected override void OnGotKeyboardFocus(KeyboardFocusChangedEventArgs e)
{
    base.OnGotKeyboardFocus(e);
    Keyboard.Focus(MyTextBox);
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-12-18T20:02:27.900

对我有用的是**FocusManager.FocusedElement**属性。我首先尝试在 UserControl 上设置它，但它不起作用。

所以我试着把它放在 UserControl 的第一个孩子上：

```
<UserControl x:Class="WpfApplication3.UserControl1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<Grid FocusManager.FocusedElement="{Binding ElementName=MyTextBox, Mode=OneWay}">
    <TextBox x:Name="MyTextBox"/>
</Grid> 
```

......它奏效了！:)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-12-01T11:57:23.967

我将 fuzquat 的答案转换为扩展方法。我正在使用它而不是 Focus() ，其中 Focus() 不起作用。

```
using System;
using System.Threading;
using System.Windows;

namespace YourProject.Extensions
{
    public static class UIElementExtension
    {
        public static void WaitAndFocus(this UIElement element, int ms = 100)
        {
            ThreadPool.QueueUserWorkItem(f =>
            {
                Thread.Sleep(ms);

                element.Dispatcher.Invoke(new Action(() =>
                {
                    element.Focus();
                }));
            });
        }
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-06-29T14:52:31.280

我有用户控件 - 带有两个文本框的堆栈面板。文本框是在构造函数中添加的，而不是在 xaml 中。当我尝试关注第一个文本框时，什么也没发生。带有 Loaded 事件的 siggestion 解决了我的问题。刚刚在 Loaded 事件中调用 control.Focus() 和其他任何东西。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-12-23T04:58:05.993

假设您想为用户名文本框设置焦点，因此用户每次出现时都可以直接输入。

在您的控件的构造函数中：

```
this.Loaded += (sender, e) => Keyboard.Focus(txtUsername); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-07-19T19:03:03.947

在尝试了上述建议的组合之后，我能够可靠地将焦点分配给子 UserControl 上所需的文本框，如下所示。基本上，将焦点放在子控件上，并让子 UserControl 将焦点放在其 TextBox 上。TextBox 的焦点语句本身返回 true，但是直到 UserControl 也获得焦点后才产生所需的结果。我还应该注意，UserControl 无法为自己请求焦点，必须由 Window 提供。

为简洁起见，我没有在 Window 和 UserControl 上注册 Loaded 事件。

窗户

```
private void OnWindowLoaded(object sender, RoutedEventArgs e)
{
    ControlXYZ.Focus();
} 
```

用户控制

```
private void OnControlLoaded(object sender, RoutedEventArgs e)
{
    TextBoxXYZ.Focus();
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-08-16T18:14:54.600

我将它设置在 PageLoaded() 或加载控件中，但随后我调用 WCF 异步服务并做一些似乎失去焦点的事情。我必须在我所做的所有事情的最后设置它。这很好，但有时我对代码进行了更改，然后我忘记了我也在设置光标。

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2012-01-30T13:54:06.000

在 WPF 用户控件中将键盘焦点设置为画布时，我遇到了同样的问题。我的解决方案

1.  在 XAML 中将元素设置为`Focusable="True"`
2.  在`element_mousemove`事件中创建简单检查：

    ```
    if(!element.IsKeyBoardFocused)
        element.Focus(); 
    ```

就我而言，它工作正常。

# java - EJB3 - 处理 RollBackExceptions

> ID：673538
> 
> 赞同：0
> 
> 时间：2009-03-23T14:17:23.793
> 
> 标签：java, transactions, jakarta-ee, persistence, ejb-3.0

我有一个 EJB3 应用程序，它包含一些用于访问数据库的 EJB，并通过会话 Bean 作为 Web 服务公开。

现在有两件事我需要找出：

1) 有什么方法可以阻止 SQL 异常导致 Web 服务抛出 SOAP 错误？事务由容器处理，当前 sql 异常会导致引发 RollBackException，因此事务会回滚（期望的行为）并且 Web 服务会引发错误（不期望的）。

2）我希望扩展 web 服务以能够接收实体列表，并且会话 bean 能够持久化。但是，我希望每个实体都在自己的事务中执行，这样如果一个实体失败，其他实体不会受到影响（同样，Web 服务也不应该出错）。

对于 (1) 我试图捕获 RollBackException，但我认为这是在另一个线程的某个地方抛出的，因为永远不会到达 catch 块。我假设（2）我需要研究用户事务，但首先希望容器来管理它，其次不知道如何强制使用用户事务。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T15:23:57.610

不，您可以使用容器管理的事务来完成所有这些工作（这绝对是可取的，因为管理事务很痛苦）。

该解决方案的要点是创建第二个仅具有本地接口和所需事务语义的 EJB。然后，Web 服务直接调用的“公共”ejb 通过其本地接口调用第二个 ejb 以执行实际工作。

类似于：

```
public class MyPublicEjb {
  @EJB
  private MyPrivateImpl impl;

  public void doSomething() {
    try {
      impl.doSomething();
    } catch(TXRolledBack) {
      // handle rollback ...
    }
  }
} 
```

我知道这看起来有点难看，但相信我，这比直接操纵交易要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T14:26:32.723

对于 (1)：调试您的代码以找出异常被抛出的位置以及导致它的原因。然后在那里处理异常。

对于 (2)：用 beginTransaction() 和 commit() 包装每个实例。

```
for(each Entity){
    try{
        //begin transaction
        //save entity
        //commit
    } catch(Exception e) {
         //handle Exception, but continue on
    }
} 
```

# debugging - 我如何知道故障转储的 CLR 版本？

> ID：673542
> 
> 赞同：10
> 
> 时间：2009-03-23T14:18:26.893
> 
> 标签：debugging, clr, windbg, crash-dumps

我有一个小型转储从 .NET 应用程序中崩溃。有没有办法使用 Windbg 或其他工具知道故障机器（生成故障转储）的 CLR 版本（例如 mscorwks.dll 的版本）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-23T14:38:11.573

在 WinDbg 中：最简单的方法是使用`!eeversion`命令，但如果您需要更多信息，可以使用带有运行时模块`lm`的详细选项的命令。如果您使用的是 .NET 4，则调用运行时，因此在这种情况下，您需要相应地更改命令。`v``mscorwks``clr`

```
0:026> lm vm mscorwks
start    end        module name
79e70000 7a3ff000   mscorwks T (no symbols)           
    Loaded symbol image file: mscorwks.dll
    Image path: c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
    Image name: mscorwks.dll
    Timestamp:        Wed Oct 24 09:41:29 2007 (471EF729)
    CheckSum:         00597AA8
    ImageSize:        0058F000
    File version:     2.0.50727.1433
    Product version:  2.0.50727.1433
    File flags:       0 (Mask 3F)
    File OS:          4 Unknown Win32
    File type:        2.0 Dll
    File date:        00000000.00000000
    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-10-27T20:34:53.337

!EEVersion 应该给出 CLR 版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-11T18:47:10.277

在 WinDbg 中详细说明：

```
>lm v 
............. (lots of modules).......

687d0000 68d06000   System_Xml_ni   (deferred)             
Image path: C:\Windows\assembly\NativeImages_v2.0.50727_32\System.Xml\38b9d09539b67b08ee996db6c71f8a9b\System.Xml.ni.dll
Image name: System.Xml.ni.dll
Has CLR image header, track-debug-data flag not set
Timestamp:        Mon Oct 06 20:43:49 2008 (48EADAF5)
CheckSum:         00000000
ImageSize:        00536000
File version:     2.0.50727.3074
Product version:  2.0.50727.3074
File flags:       0 (Mask 3F)
File OS:          4 Unknown Win32
File type:        2.0 Dll
File date:        00000000.00000000
Translations:     0409.04b0
CompanyName:      Microsoft Corporation
ProductName:      Microsoft® .NET Framework
InternalName:     System.Xml.dll
OriginalFilename: System.Xml.dll
ProductVersion:   2.0.50727.3074
FileVersion:      2.0.50727.3074 (QFE.050727-3000)
FileDescription:  .NET Framework
LegalCopyright:   © Microsoft Corporation.  All rights reserved.
Comments:         Flavor=Retail 
```

或者，在 Visual Studio 中加载转储并使用 Debug | 窗户 | 模块工具窗口来显示其中的一些信息。

* * *

两个不同 .Net 版本的示例，使用 clr.dll 的版本信息：

.Net 4.0(.x?)

```
Image name: clr.dll
Timestamp:        Thu Mar 18 21:39:07 2010 (4BA21EEB)
...
File version:     4.0.30319.1
Product version:  4.0.30319.1 
```

.Net 4.5.2

```
Image name: clr.dll
Timestamp:        Fri Nov 07 20:09:21 2014 (545CA861)
...
File version:     4.5.27.0
Product version:  4.0.30319.0 
```

# c# - 无法从 Web 应用程序从服务器运行报告

> ID：673549
> 
> 赞同：0
> 
> 时间：2009-03-23T14:21:00.897
> 
> 标签：c#, asp.net

我正在使用 ASP.NET 2005、C# 和 Crystal Reports 8.5 进行开发。它在我的开发计算机上运行良好，但是当我尝试从服务器运行时，它给了我一个错误。

> **无法加载文件或程序集“CrystalDecisions.ReportAppServer.CommLayer，版本=10.2.3600.0，Culture=neutral，PublicKeyToken=692fbea5521e1304”或其依赖项之一。该系统找不到指定的文件。**

我的 bin 文件夹中引用了这些 Crystal Reports dll：

*   CrystalDecisions.CrystalReports.Engine.dll
*   CrystalDecisions.ReportSource.dll
*   CrystalDecisions.Shared.dll
*   CrystalDecisions.Web.dll
*   CrystalDecisions.Windows.Forms.dll

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-01T18:02:58.907

您是否在服务器上安装了 Crystal Reports 可再发行组件？然后网页会知道在哪里可以找到引用的程序集。

# c++ - 如何使用 emacs 重构 C++ 源代码？

> ID：673554
> 
> 赞同：49
> 
> 时间：2009-03-23T14:21:48.320
> 
> 标签：c++, emacs, refactoring

我主要对 C++ 和方法/类名/签名自动更改感兴趣。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-02-13T09:52:23.017

在最近的 Emacs 版本 (24) 中，Semantic 能够做到这一点。

1.  可能激活语义模式`M-x semantic-mode RET`。
2.  使用 调出 Symref 缓冲区`C-c , g`。
3.  按`C-c C-e`打开所有参考。
4.  用 重命名`R`。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-24T07:26:58.233

如果您可以在 elisp 中编程，您可以从[CEDET 库](http://cedet.sourceforge.net/)中查看 cedet + srecode 的组合- 它为这项任务提供了所有工具 - 查找函数的调用者，获取签名等。但是您需要自己创建重构工具，使用这些工具

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-23T14:37:32.620

我经常这样做，所以我也在焦急地等待其他答复。

我知道的唯一技巧是非常基本的。以下是我在重构代码时在 Emacs 中最好的朋友：

```
M-x query-replace 
```

这允许您进行全局搜索和替换。当您将方法和常用数据移动到其他类或命名空间时，您会经常这样做。

```
C-x 3 
```

这为您提供了一个并排显示两个缓冲区的显示。然后，您可以继续在其中加载不同的文件，并使用 .将光标从一个移动到另一个`C-x o`。这是非常基本的东西，但我之所以提到它是因为它使下一个...

```
C-x (
(type any amount of stuff and/or emacs commands here)
C-x ) 
```

这就是在 emacs 中定义宏的方式。任何时候你发现自己需要对一堆代码一遍又一遍地做同样的事情（而且对于查询替换来说太复杂了），这就是救命稻草。如果你搞砸了，你可以点击`C-g`停止宏定义，然后撤消（`C-_`）直到你回到你开始的地方。调用宏的键是`C-x e`。如果您想多次这样做，您可以`Esc`先点击并输入一个数字。例如：`Esc 100 C-x e`将尝试调用您的宏 100 次。

（注意：在 Windows 上，您可以通过按 Esc 键或按住 Alt 来获得“Meta”）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-01T16:05:36.877

对于介于重构工具和简单正则表达式之间的某个地方，从 Emacs 22 开始，您可以在替换文本中嵌入任意 elisp 表达式，这使您可以进行非常强大的文本操作。Steve Yegge 不久前写了[一篇很好的文章](http://steve-yegge.blogspot.com/2006/06/shiny-and-new-emacs-22.html)。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-02-22T22:08:04.370

我想说，当前（2021 年）最先进的技术是使用[`lsp-mode`](https://emacs-lsp.github.io/lsp-mode/)带有合适语言服务器的 emacs。

使用[`clangd`](https://clangd.llvm.org/)or [`ccls`](https://github.com/MaskRay/ccls)，它提供“语言服务器协议”（lsp）并连接到`lsp-mode`，您可以重构名称：

`M-x lsp-rename`

为了简化此设置，我建议将[Spacemacs](https://www.spacemacs.org/)与`c-c++`和`lsp`层一起使用（并使用`clangd`）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-23T14:28:37.167

我的一个朋友在玩[xrefactory](http://www.xref.sk/xrefactory/main.html)，说它工作得很好。不过它并不便宜。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-08-24T04:34:47.887

构建 cscope 符号。

查找要重构的符号。

进入 cscope 窗口，在第一次出现光标后启动宏

*   ret
*   cf你的符号开始
*   导航到符号的开头
*   修改单词
*   cx o（返回 cscope）
*   n（用于下一个 cscope 符号）

你现在必须 cx ce

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-12-13T15:21:06.163

我完全同意查找和替换工作正常。然而，cedet 的一个非常好的特性是'semantic-symref-list'。

将光标放在方法上，运行此命令，您将看到一个缓冲区，其中列出了代码中引用此标记的所有位置。

您仍然可以使用查找和替换技巧，这将确认您已更改所有引用。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-03-29T13:04:04.263

我一直在使用*cquery*完成我的 C++ 完成，它使用 Microsoft LSP 进行 IDE <-> 工具通信。*cquery*服务器使用 clang 后端满足 LSP 协议的请求。

*lsp-emacs*是位于 emacs 和公开函数的*cquery*`lsp-rename`后端 (cquery-emacs) 之间的包。*顺便说一下， cquery*作为一个补全系统，一直非常可靠和快速，强烈推荐。

试试看，遵循*cquery* github 上的入门指南： [https ://github.com/cquery-project/cquery/wiki/Emacs](https://github.com/cquery-project/cquery/wiki/Emacs)

*完成 cquery*设置后：

1.  将光标悬停在要重命名的标识符（类、var 等）上。
2.  MX`lsp-rename`
3.  输入标识符的**新**名称。
4.  执行**Cx s**（保存**一些**缓冲区），这将提示您保存重构所触及的所有缓冲区。

您可能应该检查所有修改过的缓冲区并检查使用任何工具/语言重构后所做的工作。

# c# - 如何根据百分比管理 AI 操作

> ID：673557
> 
> 赞同：4
> 
> 时间：2009-03-23T14:22:09.863
> 
> 标签：c#

我现在正在寻找一段时间，关于程序员如何根据最终幻想类战术游戏（策略游戏）的动作百分比来模拟 AI 决策。

举例来说，AI 角色有以下动作：

攻击 1：10%
攻击 2：9%
魔法：4%
移动：1%

所有这一切都远不等于 100%

现在起初我想有一个有 100 个空插槽的阵列，攻击将有 10 个插槽，攻击阵列上的 2 个 9 插槽。结合随机我可以采取行动。我的问题是它不是很有效，或者似乎没有。同样重要的是，如果我坐到空位该怎么办。我是否必须根据 100% 计算每个角色的所有动作，或者为每个人定义一个“默认”动作？

或者也许有一种更有效的方式来查看所有这些？我认为这个百分比是实现人工智能的最简单方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T14:24:26.083

我能想到的最佳答案是列出您希望角色拥有的所有可能动作，给每个动作一个相对值，然后将它们全部缩放到 100%。

编辑：

例如，这是我的三个动作。我希望攻击和魔法的可能性相同，而逃跑的可能性是攻击或使用魔法的一半：

*   攻击 = 20
*   魔法 = 20
*   逃离 = 10

这加起来是 50，所以将每个除以这个总数得到一个分数值（乘以 100 表示百分比）：

*   攻击 = 0.4
*   魔法 = 0.4
*   逃离 = 0.2

然后，我会从中创建一个累积值列表（即每个条目是该条目和之前所有条目的总和）：

*   攻击 = 0.4
*   魔法 = 0.8
*   逃离 = 1

现在，生成一个介于 0 和 1 之间的随机数，并在列表中找到大于或等于该数字的第一个条目。这就是你的举动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T14:31:05.803

不，您只是创建阈值。一种简单的方法是：

0 - 9 -> 攻击1

10 - 18 -> 攻击 2

19 - 22 -> 魔法

23 -> 移动

其他 -> 24-99（你需要加起来 100）

现在创建一个随机数并将其修改 100（因此 num = randomNumber % 100）来定义您的操作。随机数越接近您将获得的正确分布。因此，您获取结果并查看它属于哪个类别。您实际上可以使这更加高效，但这是一个好的开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T14:32:03.803

好吧，如果它们的总和不等于 100，它们就不是真正的百分比。不过这无关紧要。你只需要计算出每个动作的相对概率。为此，请使用以下公式...

```
prob = value_of_action / total_value_of_all_actions 
```

This gives you a number between 0 and 1\. if you really want a percentage rather than a fraction, multiply it by 100.

here is an example:

```
prob_attack = 10 / (10 + 9 + 4 + 1)
            = 10 / 24
            = 0.4167 
```

This equates to attack being chosen 41.67% of the time.

you can then generate thresholds as is mentioned in other answers. And use a random number between 0 and 1 to choose your action.

# cocoa-touch - 带有自定义前导的 UIFont？

> ID：673563
> 
> 赞同：3
> 
> 时间：2009-03-23T14:23:27.957
> 
> 标签：cocoa-touch

我想使用系统字体但带有自定义前导，但 UIFont 的前导属性是只读的。有没有办法创建具有自定义前导值的系统字体？

我正在尝试使用 UILabel 显示多行，但默认前导太窄。（\n\n 太宽了）

如果没有办法，那么我需要创建多个 UILabel 但这似乎有点矫枉过正。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T10:58:55.743

我认为你不能那样做。UIFont 受到非常严格的限制。

如果您自己设置了换行符，那么自己绘制字符串而不是创建多个 UILabel 是相当简单的。您可以使用 UIKit NSString 添加生成子字符串`– componentsSeparatedByString:`并以指定的前导增量呈现每个子字符串：`– drawAtPoint:withFont:`。

如果您需要生成自己的包装，这很困难 - 请参阅[此相关问题](https://stackoverflow.com/questions/851856/string-length-with-given-font-to-fit-uitextview)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-29T16:24:23.593

有一种方法可以自定义多行中的行距`UILabel`。不要使用`text`标签的属性，而是使用`attributedText`属性。属性文本可以具有负值的段落样式，`lineSpacing`以使行更紧密。这是一个例子：

```
NSMutableParagraphStyle *paragraphStyle = [[NSMutableParagraphStyle alloc] init];
paragraphStyle.lineSpacing = -4;

NSMutableAttributedString *attributedString = [[NSMutableAttributedString alloc] initWithString:yourStringHere];
[attributedString addAttribute:NSParagraphStyleAttributeName value:paragraphStyle range:NSMakeRange(0, titleText.length)];
yourUILabel.attributedText = attributedString; 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2010-06-30T09:10:48.947

这可以通过在 UIFont 上创建一个自定义类别并用自定义设置器替换属性来完成。我仍在尝试这样做。

# nhibernate - 如何关闭 NHibernate 的自动（脏检查）更新行为？

> ID：673564
> 
> 赞同：28
> 
> 时间：2009-03-23T14:23:31.313
> 
> 标签：nhibernate

我刚刚发现，如果我从 NHibernate 会话中获取对象并更改对象的属性，NHibernate 将在提交时自动更新对象，而无需我调用`Session.Update(myObj)`！

我可以看到这可能会有所帮助，~~但作为默认行为，它似乎很疯狂！~~

**更新：**我现在理解持久性无知，所以这种行为现在显然是首选。我将把这个现在令人尴尬的问题留在这里，希望能帮助其他亵渎的用户。

我怎样才能阻止这种情况发生？这是默认的 NHibernate 行为还是来自 Fluent NHibernate 的 AutoPersistenceModel？

如果没有办法阻止这种情况，我该怎么办？除非我错过了这一点，否则这种行为似乎会造成正确的混乱。

我正在使用 NHibernate 2.0.1.4 和 18/3/2009 的 Fluent NHibernate 构建

这个人[的回答对](http://brian.pontarelli.com/2007/04/03/hibernate-pitfalls-part-2/#comment-3403)吗？

我还读到覆盖事件侦听器可能是解决此问题的方法。但是，`IDirtyCheckEventListener.OnDirtyCheck`在这种情况下不会调用。有谁知道我需要覆盖哪个听众？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-23T14:53:49.117

您可以设置`Session.FlushMode`为`FlushMode.Never`. 这将使您的操作明确

即：开`tx.Commit()`或`session.Flush()`。当然，这仍然会在提交/刷新时更新数据库。如果你不想要这种行为，那么调用`session.Evict(yourObj)`它，它就会变成瞬态的，NHibernate 不会为它发出任何 db 命令。

**对您的编辑的回应：是的，那个人为您提供了更多关于如何控制它的选项。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-10T15:34:10.327

我的解决方案：

1.  在您最初的 ISession 创建中，（在您的注入框架注册中的某处）将 DefaultReadOnly 设置为 true。
2.  在围绕 NHibernate 并管理 ISession 等的 IRepository 实现中，在调用 ISession.Save、Update、SaveUpdate 等的 Insert、Update、InsertUpdate 和 Delete（或类似）方法中，为实体和标志集调用 SetReadOnly为假。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T15:05:31.413

调用 SaveOrUpdate() 或 Save() 使对象持久化。如果您使用 ISession 或从对持久对象的引用中检索到它，则该对象是持久的，刷新会话将保存更改。您可以通过在对象上调用 Evict() 来防止这种行为，这使它成为瞬态。

编辑添加：我通常认为 ISession 是一个工作单元。这很容易在 Web 应用程序中实现。使用每个请求的会话，但需要在 WinForms 中进行更多控制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-30T12:20:20.600

我们通过使用带有 NH 的事件侦听器来做到这一点（这不是我的工作 - 但我找不到我在哪里做的链接......）。

我们有一个 EventListener 用于在读取数据时将其设置为 ReadOnly - 然后为 Save（和 SaveOrUpdate）设置一个以将它们设置为已加载，以便当我们手动调用它时*该*`Save()`对象将持续存在。

那 - 或者您可以使用没有状态/更改跟踪的 IStatelessSession。

这会在加载时立即将实体/项目设置为只读。

*我只包含了一个 Insertion 事件侦听器，但我的配置代码引用了所有这些侦听器。*

```
/// <summary>
/// A listener that once an object is loaded will change it's status to ReadOnly so that
/// it will not be automatically saved by NH
/// </summary>
/// <remarks>
/// For this object to then be saved, the SaveUpdateEventListener is to be used.
/// </remarks>
public class PostLoadEventListener : IPostLoadEventListener
{
    public void OnPostLoad(PostLoadEvent @event)
    {
        EntityEntry entry = @event.Session.PersistenceContext.GetEntry(@event.Entity);

        entry.BackSetStatus(Status.ReadOnly);
    }
} 
```

在保存对象时，我们调用它来将该对象设置为已加载（意味着它现在将持续存在）

```
public class SaveUpdateEventListener : ISaveOrUpdateEventListener
{
    public static readonly CascadingAction ResetReadOnly = new ResetReadOnlyCascadeAction();

    /// <summary>
    /// Changes the status of any loaded item to ReadOnly.
    /// </summary>
    /// <remarks>
    /// Changes the status of all loaded entities, so that NH will no longer TrackChanges on them.
    /// </remarks>
    public void OnSaveOrUpdate(SaveOrUpdateEvent @event)
    {
        var session = @event.Session;
        EntityEntry entry = session.PersistenceContext.GetEntry(@event.Entity);

        if (entry != null && entry.Persister.IsMutable && entry.Status == Status.ReadOnly)
        {
            entry.BackSetStatus(Status.Loaded);
            CascadeOnUpdate(@event, entry.Persister, @event.Entry);
        }
    }

    private static void CascadeOnUpdate(SaveOrUpdateEvent @event, IEntityPersister entityPersister, 
        object entityEntry)
    {
        IEventSource source = @event.Session;
        source.PersistenceContext.IncrementCascadeLevel();
        try
        {
            new Cascade(ResetReadOnly, CascadePoint.BeforeFlush, source).CascadeOn(entityPersister, entityEntry);
        }
        finally
        {
            source.PersistenceContext.DecrementCascadeLevel();
        }
    }
} 
```

我们将它实现到 NH 中，因此：

```
 public static ISessionFactory CreateSessionFactory(IPersistenceConfigurer dbConfig, Action<MappingConfiguration> mappingConfig, bool enabledChangeTracking,bool enabledAuditing, int queryTimeout)
    {
        return Fluently.Configure()
            .Database(dbConfig)
            .Mappings(mappingConfig)
            .Mappings(x => x.FluentMappings.AddFromAssemblyOf<__AuditEntity>())
            .ExposeConfiguration(x => Configure(x, enabledChangeTracking, enabledAuditing,queryTimeout))
            .BuildSessionFactory();
    }

    /// <summary>
    /// Configures the specified config.
    /// </summary>
    /// <param name="config">The config.</param>
    /// <param name="enableChangeTracking">if set to <c>true</c> [enable change tracking].</param>
    /// <param name="queryTimeOut">The query time out in minutes.</param>
    private static void Configure(NHibernate.Cfg.Configuration config, bool enableChangeTracking, bool enableAuditing, int queryTimeOut)
    {
        config.SetProperty(NHibernate.Cfg.Environment.Hbm2ddlKeyWords, "none");
        if (queryTimeOut > 0)
        {
            config.SetProperty("command_timeout", (TimeSpan.FromMinutes(queryTimeOut).TotalSeconds).ToString());
        }

        if (!enableChangeTracking)
        {
            config.AppendListeners(NHibernate.Event.ListenerType.PostLoad, new[] { new Enact.Core.DB.NHib.Listeners.PostLoadEventListener() });
            config.AppendListeners(NHibernate.Event.ListenerType.SaveUpdate, new[] { new Enact.Core.DB.NHib.Listeners.SaveUpdateEventListener() });
            config.AppendListeners(NHibernate.Event.ListenerType.PostUpdate, new[] { new Enact.Core.DB.NHib.Listeners.PostUpdateEventListener() });
            config.AppendListeners(NHibernate.Event.ListenerType.PostInsert, new[] { new Enact.Core.DB.NHib.Listeners.PostInsertEventListener() });
        }
    } 
```

# apache - 如何在 apache dav svn 中指定存储库？

> ID：673572
> 
> 赞同：1
> 
> 时间：2009-03-23T14:26:55.517
> 
> 标签：apache, svn, webdav, mod-dav-svn

我有以下设置：

```
<VirtualHost *:80>
    ServerName svn.project1.com

    <Location />
       DAV svn
       SVNPath /svn
    </Location>
</VirtualHost>

<VirtualHost *:80>
    ServerName svn.project2.com

    <Location />
       DAV svn
       SVNPath /svn
    </Location>
</VirtualHost> 
```

当我导航到[http://svn.project1.com/](http://svn.project1.com/)或[http://svn.project1.com/](http://svn.project1.com/)时，它会提供一个包含两个存储库的目录列表：

```
Revision 1270: /

* project1/
* project2/

Powered by Subversion version 1.4.4 (r25188) 
```

如何让两个主机都指向各自的存储库？

我希望能够使用如下 URL：

```
http://svn.project1.com/trunk/ 
```

代替：

```
http://svn.project1.com/project1/trunk/ 
```

从而防止从 project1 访问例如 project2，即：

```
http://svn.project1.com/project2/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T14:32:07.063

这适用于`SVNPath /svn/project#`. 但是请注意，我认为这仅在您确实有两个单独的存储库时才有效。据我从您的信息中得知，您对两个项目都使用了一个存储库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-07T20:14:04.343

```
<Location /svn/>
     DAV svn
     SVNParentPath "D:\repos"
     SVNListParentPath On
     AuthName "Subversion repository"
     SVNPathAuthz on
     AuthType SSPI
     SSPIAuth On
     SSPIAuthoritative On
     SSPIDomain RAILINC
     SSPIOfferBasic On
     SSPIUsernameCase lower
     SSPIOmitDomain On
     AuthzSVNAccessFile "D:\repos\svnaccessfile.txt"
     Require valid-user
</Location> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:30:45.053

不确定，但你试过吗？

```
SVNPath /svn/project1/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T14:38:11.090

使用时

```
SVNPath /svn/projectX/ 
```

应该解决您的问题，它将暴露 DavSVN 中的一个严重缺陷。它在域的根目录中存在问题的缺陷。出现目前没有可用解决方案的随机签入错误是我们不得不从子域切换到子目录的问题。

# logging - 记录企业应用程序的最佳实践是什么？

> ID：673575
> 
> 赞同：29
> 
> 时间：2009-03-23T14:27:53.330
> 
> 标签：logging

企业应用程序有哪些日志记录标准？

有人有关于这个主题的白皮书吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-23T14:35:08.117

请参阅 Microsoft[企业库](https://web.archive.org/web/20100323144635/http://www.codeplex.com:80/entlib)。它包括[日志记录应用程序块](https://docs.microsoft.com/en-us/previous-versions/msp-n-p/ff664569(v=pandp.50)?redirectedfrom=MSDN)，并且该文档可能是您正在寻找的。您无需先安装库即可查看[MSDN 文档。](https://docs.microsoft.com/en-us/previous-versions/msp-n-p/ff648951(v=pandp.10)?redirectedfrom=MSDN)具体来说，请参阅[Key Scenarios](https://docs.microsoft.com/en-us/previous-versions/msp-n-p/ff664736(v=pandp.50)?redirectedfrom=MSDN) and [Design of the Logging Application Block](https://docs.microsoft.com/en-us/previous-versions/msp-n-p/ff664735(v=pandp.50)?redirectedfrom=MSDN)来回答您的问题（也许即使您不使用 .NET）。

更新（2013 年 4 月 23 日）请参阅使用新的[语义日志记录应用程序块](https://web.archive.org/web/20170520181054/http://entlib.codeplex.com:80/releases/view/101823)[拥抱语义日志记录](https://docs.microsoft.com/en-us/archive/blogs/agile/embracing-semantic-logging)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-11-16T14:13:53.690

[有效的日志记录实践简化了企业开发](https://geekdetected.files.wordpress.com/2013/12/effective-logging-practices-ease-enterprise-development.pdf)中写了一篇很好的文章。

症结在于：

1.  了解日志记录的需要。
2.  了解可用的选项以及最适合您的选项（因平台/操作系统/等而异）
3.  在实施之前提前规划战略。
4.  继续审查并进行更改。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T14:49:07.430

一些技巧 ：

*   在发布/生产中不超过必要的日志
*   永远记录错误，如果可能的话，请这样做：
    *   将日志操作放入临时变量（向量/列表）
    *   最后，如果没有错误发生，丢弃日志，在另一种情况下发送到日志文件
*   创建标志以控制要记录的信息级别
*   控制生产/开发环境中的日志行为
*   控制日志文件的并发访问
*   控制需要多长时间的文件日志
*   控制文件日志应该维护多少时间
*   有时需要执行性能验证，在必要时放置计时器

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-04-21T07:17:09.870

如果您真的想深入研究该主题的哲学，请尝试Miloslav Trmač 博客上 的[“Do Not Believe in Structured Logging” 。](http://mtrmac.blogspot.com/2011/11/do-not-believe-in-structured-logging.html)

“......这些教训是通过艰难的方式吸取的......”

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T14:39:18.717

有大量的日志框架，包括 log4net 和 log4j，但适合你的将取决于你的平台和系统。

最好的日志记录技术在很大程度上取决于您的平台和系统的设计。您需要知道/决定诊断特定类型的问题需要多少信息。通常，您应该以不需要大量代码重复或修改的方式检测您的代码。.NET 中使用属性类和方法的日志框架是低影响检测的一个很好的例子。您还应该能够通过配置修改日志记录级别（从低到详细），而无需关闭或重新启动任何服务。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-04-21T07:06:54.647

[Serilog](http://serilog.net/)是另一种结构化日志记录解决方案，自从第一次提出这个问题以来就变得流行起来。

*   [Serilog 网站](http://serilog.net/)。
*   [与开发人员 Nicholas Blumhardt 讨论 .NET Rocks！](http://www.dotnetrocks.com/default.aspx?showNum=966)

在他的采访中，Blumhardt 先生谈到了建立图书馆的经历，因为我们经历了我们都经历过的伐木之痛。他们在节目中谈到了初始开发期间的简单日志记录以及随着项目的成熟而正式记录日志。好东西，可能会添加到问题中提出的最佳实践知识库中。

从网站：

> 与 .NET 的其他日志库一样，Serilog 为文件、控制台等提供诊断日志记录。它易于设置，具有干净的 API，并且可以在最近的 .NET 平台之间移植。
> 
> 与其他 .NET 日志库不同，Serilog 在构建时考虑了结构化日志数据。与日志消息一起传递的参数不会破坏性地呈现为文本格式。相反，它们被保存为结构化数据，可以以文档形式写入 NoSQL 数据存储

# drupal - 如何允许用户角色访问 Drupal6 中的内容类型？

> ID：673577
> 
> 赞同：0
> 
> 时间：2009-03-23T14:28:32.283
> 
> 标签：drupal

我只想允许一种类型的用户访问某种内容类型。这很简单，我以前做过，但今天我想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T15:10:28.517

通常这需要一个访问控制模块，如[Node Access。](http://drupal.org/project/nodeaccess)使用这样的模块，您可以完全隐藏某些类型的内容，让不允许查看的用户看到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T18:00:14.303

如果您的意思是“读取”访问，您确实需要某种形式的访问控制模块，正如伊顿建议的那样。[例如， OG](http://drupal.org/project/og)是一个访问控制模块，尽管由于它的其他特性，人们常常不这么认为。

如果您的意思是编辑/删除访问权限，OTOH，您可以按节点类型与角色在`admin/user/permissions`.

当然，如果您只想对非管理员隐藏节点，您可以取消发布它们：只有管理员才能看到它们。

# javascript - 是否可以复制 JavaScript 的 prompt() 的本机行为？

> ID：673579
> 
> 赞同：2
> 
> 时间：2009-03-23T14:30:40.483
> 
> 标签：javascript, execution, prompt

`prompt()`出于审美目的，我正在滚动我自己的版本；就视觉效果而言，它的表现非常好，但我遇到了一个小问题：该函数的本机版本导致代码执行完全停止，直到处理了提示。

这非常可爱，这就是为什么下面的工作方式如下：

```
<script>
    var c = prompt('Name?', '');
    alert(c); // displays whatever the user entered
</script> 
```

然而，用我的方法，事情并没有那么顺利。我正在使用对话框、输入框和`OK`按钮从用户那里收集数据；据我所知，数据收集工作完美；也就是说，我确定在用户按下`OK`按钮后，我可以访问他们刚刚放入提示中的数据。

但是，我无法找到一种方法让我的版本像本地版本一样工作。那么，我的问题是：是否有可能告诉 JavaScript 停止执行，直到你告诉它继续执行？

提前感谢您提供的任何和所有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T14:34:38.617

不，不可能复制这种行为。实现相同效果的方法是在代码中使用回调，因此您可以执行以下操作：

```
myPrompt('Hello, mate, whats yer name?', function(answer) {
   alert(answer);
}); 
```

**编辑**：根据您的代码，为什么不这样做？

```
<body>
<div id="prompt" style="display: none;">
<input type="text" id="q" /> <input type="button" value="OK" id="ok" />
</div>
<script>
$ = function(i) {return document.getElementById(i);}

_prompt = function(prompt, callback) {
    $('prompt').style.display = '';
    $('q').value = '';
    $('ok').onclick = function() {
        callback($('q').value);
    }
}

_prompt('Name?', function(answer) {
    alert(answer);  
});
</script>
</body> 
```

如果您更改`alert(answer);`为说... `gAnswer = answer;`（注意没有`var`声明），您将创建一个名为的全局变量`gAnswer`，您可以在 javascript 代码中的任何其他位置访问该变量，假设提示已得到回答。如果您担心全局变量会污染您的空间，则可以将其全部包装在一个闭包中，否则应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T15:04:02.183

@保罗：

这是我目前正在使用的代码：

```
<body>
<div id="prompt" style="display: none;">
<input type="text" id="q" /> <input type="button" value="OK" id="ok" />
</div>
<script>
$ = function(i) {return document.getElementById(i);}
_prompt = function(q, e)
 {
    $('prompt').style.display = '';
    $('q').value = '';
    $('ok').setAttribute('onclick', e + ' $("prompt").style.display = "none";');
 }
var c; _prompt('Name?', 'c = $("q").value;');
alert(c);
</script>
</body> 
```

现在，正如预期的那样，alert() 会在页面加载后立即触发，这绝对不是我想要的；理想情况下，我希望其余代码等待提示得到处理，但我强烈怀疑这在本机实现之外是否可行。估计我只需要满足于设计我的算法，以便立即使用提示？

# asp.net - 执行 SQL 查询时，394 的持续时间是否过多？

> ID：673584
> 
> 赞同：1
> 
> 时间：2009-03-23T14:31:36.363
> 
> 标签：asp.net, sql, sql-server

我有这个连接池问题：

> [如何解决 ASP.NET 和 SQL Server 之间的连接池问题？](https://stackoverflow.com/questions/670774/how-to-solve-a-connection-pool-problem-between-asp-net-and-sql-server)

我现在正在使用 SQL 分析器进行跟踪，我发现一些查询需要大约 400 持续时间才能完成并返回数据。

这个值是不是太大了？

会不会导致之前的连接池问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T14:42:16.180

400 表示 400 毫秒或 0.4 秒。

这是否太长真的取决于。如果这是您的首页或其他高流量区域，那么这太多了，除非这是一个 Intranet 站点。您可能需要重新考虑如何获取这些数据，或者使用缓存来减少您实际必须运行查询的次数。

如果这是一个报告，或者其他更多涉及的页面，那么 400 毫秒并不过分。充其量您可能想检查是否可以更快地完成查询以改善整体用户体验。

您可能还需要运行 Tuning Advisor 来确定查询是否只是因为没有正确的索引而运行缓慢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T14:42:25.823

这取决于您的应用程序。这不到 1/2 秒。如果您正在处理数千万行数据，那么这可能会非常好。另一方面，如果您有 1000 多个用户，您的数据集很小，并且此查询不断运行，那么您可能需要查看查询的性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T14:43:35.023

这取决于查询的用途、运行频率以及用户对响应时间的期望。

如果查询在少量数据上运行缓慢，则可能是您的 SQL、索引或 Web 服务器与数据库服务器之间的网络连接存在问题。优化查询可能是解决此问题的最佳首要任务。

此外，如果查询经常运行，或者在您需要快速响应时间的系统区域中，您可能需要稍微优化一下查询。

如果查询需要运行该时间长度并且无法进一步优化，但数据不会经常更改，那么在应用程序中缓存结果可能有助于缩短响应时间。

如果您有少量不关心性能的用户（例如运行报告的管理员），那么您不必担心。

# asp.net - 将特定文件夹映射到 web.config 中的 HttpHandler

> ID：673592
> 
> 赞同：8
> 
> 时间：2009-03-23T14:34:35.607
> 
> 标签：asp.net, httphandler

是否可以将文件夹中的所有文件扩展名映射到特定的 HttpHandler（假设它们的文件扩展名映射到 IIS 中的 aspnet_isapi.dll）？

我已将 FLV 扩展名映射到 IIS 中的 ASP.NET，并在我的 Web 应用程序中有一个名为*Static*的文件夹，其中包含以下文件：

*   静态/索引.htm
*   静态/MyFile.flv

索引文件是使用[JW FLV 媒体播放器](http://www.longtailvideo.com/players/jw-flv-player/)播放 FLV 的基本 html 页面。

在 Web.Config 中，在 HttpHanders 部分下，以下工作（FLV 已加载并成功播放）：

```
<add verb="*" path="MyFile.flv" type="MyApp.PassthroughFileHandler, MyApp"/> 
```

但这不是（无法加载视频）：

```
<add verb="*" path="Static/*" type="MyApp.PassthroughFileHandler, MyApp"/> 
```

我尝试了各种组合，但运气不佳。

理想情况下，我希望静态文件夹中的所有 FLV 都使用 PassthroughFileHandler，而不是必须在 web.config 中单独指定每个文件名。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-03-01T19:32:56.647

这是一种不同的方式，不需要“虚拟”文件夹和新的 web.config。

将此添加到您的主 web.config

```
<location path="static">
  <system.web>
    <httpHandlers>
      <add verb="GET,HEAD" path="*.*" 
           type="MyApp.PassthroughFileHandler, MyApp" />
    </httpHandlers>
  </system.web>    
</location> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T14:46:24.190

尝试在该文件夹中放置第二个 web.config，例如：

```
<?xml version="1.0"?>
<configuration>
    <system.web>
      <httpHandlers>
        <!-- <clear/> -->
        <add verb="*" path="*.flv"
            type="WebApplication3.MyHandler, WebApplication3"/>
      </httpHandlers>
    </system.web>
</configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T15:40:18.273

我认为您需要进入 IIS（我假设您使用的是 II 6）并配置 ASP.NET 以处理通配符扩展。因为虽然您已经映射了 .flv 扩展名，但 IIS 将正常处理 Static/Index.htm 而不会将其传递给 ASP.NET。

[http://professionalaspnet.com/archive/2007/07/27/Configure-IIS-for-Wildcard-Extensions-in-ASP.NET.aspx](http://professionalaspnet.com/archive/2007/07/27/Configure-IIS-for-Wildcard-Extensions-in-ASP.NET.aspx)

您可能只为这个静态文件夹配置 IIS，尽管我从未尝试过。

# silverlight - Silverlight 使用 xamlreader 添加带有用户控件的 datagrid 列

> ID：673596
> 
> 赞同：0
> 
> 时间：2009-03-23T14:35:22.767
> 
> 标签：silverlight, datagrid

我尝试使用以下代码向我的数据网格添加一列，但我会遇到浏览器崩溃（看不到异常）。我在这里添加了一个示例项目：http: [//cid-5d0909fd6cd506a0.skydrive.live.com/self.aspx/Offentlig/DependencyPropblem.zip](http://cid-5d0909fd6cd506a0.skydrive.live.com/self.aspx/Offentlig/DependencyPropblem.zip)

代码如下：

```
 private void LoadDynamicDataColumnTemplate()
    {

        string xaml;
        if (false)
        {
            // THis one does not work. Whats wrong?????????
            xaml = @"<DataTemplate xmlns=""http://schemas.microsoft.com/client/2007"" 
                               xmlns:me=""clr-namespace:SilverlightApplication2"">
                                              <me:MyUserControl Age=""{Binding Path=Age}""/>
                                        </DataTemplate>";
        }
        else
        {
            // This runs fine!
            xaml = @"<DataTemplate xmlns=""http://schemas.microsoft.com/client/2007"" 
                               xmlns:me=""clr-namespace:SilverlightApplication2"">
                                  <Button Content=""{Binding Path=Age}""/>
                            </DataTemplate>";
        }

        DataGridTemplateColumn tc = new DataGridTemplateColumn();
        tc.CellTemplate = (DataTemplate)XamlReader.Load(xaml);
        tc.Header = "Dynamic";
        MyDataGrid.Columns.Add(tc);
    } 
```

我的数据网格是这样定义的：

```
 <data:DataGrid x:Name="MyDataGrid" ItemsSource="{Binding Path=Rows}" AutoGenerateColumns="False">
        <data:DataGrid.Columns>
            <data:DataGridTextColumn Binding="{Binding Path=Name}" Header="Name"></data:DataGridTextColumn>
            <data:DataGridTemplateColumn Header="Static">
                <data:DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <me:MyUserControl Age="{Binding Path=Age}"/>
                    </DataTemplate>
                </data:DataGridTemplateColumn.CellTemplate>
            </data:DataGridTemplateColumn>
        </data:DataGrid.Columns>
    </data:DataGrid> 
```

我的用户控件是这样的：

```
<UserControl x:Class="SilverlightApplication2.MyUserControl"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
>
<Grid x:Name="LayoutRoot" Background="Red">
    <Button Content="{Binding Age}" Click="Button_Click"/>
</Grid> 
```

任何帮助都会很棒！

我正在使用 SL 3 beta 运行，但在卸载它并重新安装工具后，我设法得到了一个异常：

Sys.InvalidOperationException：控件“Xaml1”中的 ManagedRuntimeError 错误 #4004：System.Windows.Markup.XamlParseException：System.Windows.Markup.XamlParseException：System.Windows.Markup.XamlParseException：System.Windows.Markup.XamlParseException：System.Windows。 Markup.XamlParseException：System.Windows.Markup.XamlParseException：System.Windows.Markup.XamlParseException：System.Windows.Markup.XamlParseException：System.Windows.Markup.XamlParseException：System.Windows.Markup.XamlParseException：System.Windows.Markup。 XamlParseException: AG_E_UNKNOWN_ERROR [行：1 位置：162] 在 MS.Internal.XcpImports.MethodEx(IntPtr ptr，字符串名称，CValue [] cvData) 在 MS.Internal.XcpImports.MethodEx(DependencyObject obj，字符串名称) 在 MS.Internal System.Windows.DataTemplate 中的 .XcpImports.DataTemplate_LoadContent（DataTemplate 模板）。System.Windows.Controls.DataGrid.AddNewCellPrivate（DataGridRow 行，DataGridColumn 列）上 System.Windows.Controls.DataGrid.AddNewCellPrivate（DataGridRow 行，DataGridColumn 列）的 System.Windows.Controls.DataGrid.AddNewCellPrivate（DataGridRow 行，DataGridColumn 列）上 System.Windows.Controls.DataGrid.PopulateCellContent 的 LoadContent（） .Controls.DataGrid.CompleteCellsCollection(DataGridRow dataGridRow) 在 System.Windows.Controls.DataGrid.GenerateRow(Int32 rowIndex) 在 System.Windows.Controls.DataGrid.GetEdgedExactRowHeight(Int32 rowIndex) 在 System.Windows.Controls.DataGrid.UpdateDisplayedRows(Int32 newFirstDisplayedRowIndex, Double displayHeight) 在 System.Windows.Controls.DataGrid.ComputeScrollBarsLayout() 在 System.Windows.Controls.DataGrid.MeasureOverride(Size availableSize) 在 System.Windows.FrameworkElement。MeasureOverride(IntPtr nativeTarget, Single inWidth, Single inHeight, Single& outWidth, Single& outHeight) [Line: 0 Position: 0] at MS.Internal.XcpImports.MethodEx(IntPtr ptr, String name, CValue[] cvData) 在 MS.Internal。 MS.Internal.XcpImports.DataTemplate_LoadContent（DataTemplate 模板）处的 XcpImports.MethodEx（DependencyObject obj，字符串名称）

但仍然没有运行代码。现在我使用的是 2.0.40115.0 和 VSTS 2008 Dev ed。

有任何想法吗？

问候拉尔西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T15:28:43.417

我尝试了您的示例，当将“ if (false)”更改为“ if (true)”时，它在我的机器上运行良好

您使用的是什么版本的 SL、VS 等？

好的，这是您的问题：在定义“动态”模板的字符串中，您指出

```
xmlns:me=""clr-namespace:SilverlightApplication2"" 
```

在 XamlLoader 的上下文中，您需要指出实际的程序集，因为它没有被编译（我相信这是在 xaml 文件中使用时在编译时替换的快捷方式）。

在任何情况下，无论是什么根本原因，您都需要指出：

```
xmlns:me=""clr-namespace:SilverlightApplication2;assembly=SilverlightApplication2"" 
```

这给了你

```
xaml = @"<DataTemplate xmlns=""http://schemas.microsoft.com/client/2007"" 
              xmlns:me=""clr-namespace:SilverlightApplication2;assembly=SilverlightApplication2"">
              <me:MyUserControl Age=""{Binding Path=Age}""/>
         </DataTemplate>"; 
```

这段代码实际上适用于我的 SL 3.0 机器。

# c# - C# 通用类中的单独 GUID

> ID：673597
> 
> 赞同：1
> 
> 时间：2009-03-23T14:35:49.520
> 
> 标签：c#, generics

我创建了以下类：

```
[Guid("4469031d-23e0-483c-8566-ce978ccc9a6f")]
class MyGenericContianer<BasicType> : SomeOtherContainer
{
} 
```

这会导致以下两个类具有相同的 GUID：

```
MyGenericContianer<int> x;
MyGenericContianer<float> y; 
```

我需要每种特定类型都有自己的 GUID。你会怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T14:38:12.383

您需要通过继承来执行此操作。

```
class MyGenericContianer<BasicType> : SomeOtherContainer { }

[Guid("4469031d-23e0-483c-8566-ce978ccc9a6f")]
class Container1: MyGenericContainer<X> { }

[Guid("5569031d-23e0-483c-8566-ce978ccc9a6f")]
class Container2: MyGenericContainer<Y> { } 
```

# tinymce - 使用 TinyMCE 的 Wordpress 和 Widget

> ID：673600
> 
> 赞同：2
> 
> 时间：2009-03-23T14:36:41.750
> 
> 标签：tinymce, wordpress

我编写了一个 Text/HTML 小部件，它使用 TinyMCE 来允许一些基本格式。但是，当我保存更改时，文本区域中的数据不会被发布。如果我只使用一个没有 TinyMCE 的简单文本区域，那么我可以正确保存数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T07:59:47.480

I've experienced this issue recently as well. Just solved it, actually. :)

If you write a PHP function to include your tinyMCE code and run the Javascript init, you can include that in admin_head

```
add_action( 'admin_print_scripts-widgets.php', 'NAME OF YOUR INIT FUNCTION HERE' ); 
```

Currently I've also go the following in my init function. although I'm not certain it's needed in this context:

```
wp_enqueue_script( 'editor' );
wp_enqueue_script( 'editor_functions' );
wp_enqueue_script( 'quicktags' ); 
```

Hope this helps. :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T05:12:19.113

它会发布吗？做一个

```
<?php print_r($_REQUEST); ?> 
```

在其发布到的页面上，查看是否正在传递值。99% 的时间是打字错误，也许是 textarea 名称错误。

# internet-explorer - Internet Explorer 和客户端身份验证

> ID：673604
> 
> 赞同：1
> 
> 时间：2009-03-23T14:37:27.800
> 
> 标签：internet-explorer, authentication, certificate, private-key, pkcs#12

我希望 Intenet Explorer 允许我在连接到启用客户端身份验证的 Web 服务器时选择身份。

目前，我已将 Tomcat Web 服务器配置为使用客户端身份验证。我还有一个 ssl 客户端访问密钥库并成功连接到 Web 服务器。但是，当尝试让 IE 7 成功连接到 Web 服务器时，方法失败了。我做了以下事情：

我创建了一个 pkcs12 文件，其中包含一个私钥以及相关的数字证书（它目前是自签名的）。

然后我进入 IE Tools-Internet-Options-Content 并将 pkcs12 文件导入个人证书框。当浏览器尝试与 Web 服务器建立连接时，我收到一条名为“选择数字证书”的弹出消息

然而，查看证书按钮是灰色的。我认为这个按钮应该允许我选择与我导入的密钥对关联的证书。

1.  为什么会变灰？
2.  我要一起完成的工作的方法是否不同？

谢谢，迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T15:53:08.680

我现在将回答我自己的问题，因为我发现了问题。

我尚未使用 CA 证书（与自签名证书相同的证书）更新 Web 服务器信任库。我终于这样做了，但只是出于绝望，因为我此时唯一的目标是能够选择证书，但不一定要连接成功。

显然，握手工作流程是这样的，IE 知道 Web 服务器将信任哪些证书，因此如果没有匹配项，则不会显示证书选项。我原以为 IE 将允许您选择任何证书，如果 Web 服务器不信任它，那么连接就会失败。有趣的。

# python - 在 GTK 中，我应该为剪贴板粘贴和字符插入捕获哪些信号？

> ID：673605
> 
> 赞同：1
> 
> 时间：2009-03-23T14:37:30.280
> 
> 标签：python, gtk, clipboard, pygtk, signals

我有一个带有 TextView 的窗口，我想在用户粘贴一些文本时执行一些操作。

我还想知道当用户在 TextView 中按下一个键时我应该捕获什么信号才能执行某些操作。

你能告诉我我必须连接的信号是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T14:44:47.157

对于粘贴：看看类的[粘贴完成](http://library.gnome.org/devel/gtk/stable/GtkTextBuffer.html#GtkTextBuffer-paste-done)信号`[GtkTextBuffer](http://library.gnome.org/devel/gtk/stable/GtkTextBuffer.html)`，听起来差不多。

对于常规字符插入：[insert-text](http://library.gnome.org/devel/gtk/stable/GtkTextBuffer.html#GtkTextBuffer-insert-text)。

# javascript - 如何使用 Javascript 添加另一个文本装饰定义？

> ID：673614
> 
> 赞同：-1
> 
> 时间：2009-03-23T14:38:58.810
> 
> 标签：javascript, css

我想在 JavaScript 的帮助下将另一个文本装饰类添加到已经有一个与之关联的类的链接中。

我想要像`<a>`激活的链接应该有的东西，`text:decoration=none`但我不能用 CSS 来做，因为它被应用于所有的链接，然后如果我声明一个没有装饰的新类。

用 JavaScript 怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T14:40:55.747

你可以这样做：

```
var elem = document.getElementById('ELEMENT_ID_HERE');
elem.style.textDecoration = 'none'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T14:48:45.870

如果您为您使用的所有链接设置唯一 ID，然后引用脚本中的链接，您可以通过以下方式更改您想要更改的任何链接：

```
document.getElementById('YourLinksId').style.textDecoration = 'overline';
document.getElementById('yourLinksId').onmouseover.style.textDecoration = 'blink'; 
```

您直接在元素上设置的样式将覆盖 css 类中设置的任何属性。

编辑：对不起，我想我误解了你的问题。如果您的意思是在单击链接时激活，鼠标悬停等您可以执行以下操作：

```
a:link {color: #FF0000}     /* unvisited link */
a:visited {color: #00FF00}  /* visited link */
a:hover {color: #FF00FF}   /* mouse over link */
a:active {color: #0000FF}   /* selected link */ 
```

[w3schools](http://w3schools.com/css/css_pseudo_classes.asp)的更多资源

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:44:39.017

如果你想使用 CSS 类：

```
var element = document.getElementById(idOfElement);
element.className = element.className + " noDecorationClass"; 
```

这会为元素添加一个新类，您也可以覆盖现有的类。

```
element.className = "noDecorationClass"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T14:45:01.307

我建议使用像 mootools ( [http://mootools.net/](http://mootools.net/) ) 这样的框架。

使用该框架，它非常简单：

```
element.addClass('my_new_css_class'); 
```

或者你可以添加一个新样式

```
element.setStyle('text-decoration', 'none'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T16:15:16.333

活动链接**仅在被点击时才处于活动状态**。

一旦您释放鼠标按钮，它就不再具有*活动*状态。因此，您可以使用适用于*所有链接的**a:active* ，因为一次只有一个链接处于活动状态。

 *我猜你真的希望它保留你的文本装饰：在单击另一个链接之前没有，在这种情况下你将需要 JavaScript。如果我错了，请按照@ChrisAD 的示例进行操作，但要添加：

```
a:active {color: #0000FF;

   text-decoration: none;

}   /* selected link */ 
```

# c# - 如何删除数据集的列？

> ID：673616
> 
> 赞同：4
> 
> 时间：2009-03-23T14:39:21.557
> 
> 标签：c#, .net, dataset

如何删除数据集的列？

有没有一种方法可以像这样为我做到这一点：

```
rh.dsDetail = ds.Tables[0].Columns.Remove( 
```

或者可能是这样的：

```
rh.dsDetail = ds.Tables[0].Columns.Remove( ds.Tables[0].Columns[1],ds.Tables[0].Columns[2]) 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-23T14:42:10.083

首先， a`DataTable`有列，而不是数据集。

如果你想摆脱它们，那么：

```
table.Columns.Clear(); 
```

否则，如果您有索引：

```
table.Columns.RemoveAt(0); 
```

如果您有列索引，应该可以完成这项工作。请注意，如果您删除第 0 列，则数字将随机排列（因此您可能需要以相反的顺序进行操作）。

或者，您可能希望按名称删除：

```
table.Columns.Remove("Foo"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-17T21:22:04.780

我以前在 winforms 和 web 应用程序中都这样做过。您必须反向遍历 DataTable，然后在最后执行 AcceptChanges。这个特定示例很典型，因为它删除了所有 GUID（以“id”结尾的列）。

```
 private void RemoveUselessFields(ref DataTable dtResults)
    {
        for (int i = dtResults.Columns.Count - 1; i >= 0; i--)
        {
            DataColumn column = dtResults.Columns[i];
            if (column.ColumnName.Substring(column.ColumnName.Length - 2, 2).ToUpper() == "ID") 
            {
                dtResults.Columns.Remove(column);
            }
        }
        dtResults.AcceptChanges();

    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T14:47:21.693

没有内置方法可以一次删除多个列。如果你愿意，你可以创建一个扩展方法。像这样的东西：

```
 public static class DataColumnCollectionExtensions
    {
        public static void RemoveColumns(this DataColumnCollection column, params string[] columns)
        {
            foreach (string c in columns)
            {
                column.Remove(c);
            }
        }
    } 
```

然后你可以像这样使用它：

```
DataTable table1 = ds.Tables[0];
table1.Columns.RemoveColumns("Column1","Column2","Column6"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T14:45:31.930

没有这样的方法。但是您可以简单地编写自己的 Helpermethod

```
public static void RemoveColumns(DataTable dt, params DataColumn[] dc)
{
    foreach (DataColumn c in dc)
    {
        dt.Columns.Remove(c);
    }
}

RemoveColumns(ds.Tables[0], ds.Tables[0].Columns[1], ds.Tables[0].Columns[2]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-04T09:27:28.853

如果你想删除列，因为你有一组新的列名，你可以使用这个：

```
DataSet.Reset(); 
```

希望能帮助到你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-18T02:18:15.680

在 python 中，有一个名为 pandas 的包。它有一个叫做drop的函数。`pandas.dataframe.drop(labels=None, axis=0, index=None, columns=None, level=None, inplace=False, errors='raise')` 在这里，使用要在标签="列名称" 处删除的列的名称。

请参阅熊猫文档中的更多内容：[https ://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html)

# machine-learning - 机器学习挑战：学习英语发音

> ID：673617
> 
> 赞同：5
> 
> 时间：2009-03-23T14:39:36.563
> 
> 标签：machine-learning, phonetics

假设您要采用如下所示[的 CMU 语音数据集](http://www.speech.cs.cmu.edu/cgi-bin/cmudict)输入：

```
ABERRATION  AE2 B ER0 EY1 SH AH0 N
ABERRATIONAL  AE2 B ER0 EY1 SH AH0 N AH0 L
ABERRATIONS  AE2 B ER0 EY1 SH AH0 N Z
ABERT  AE1 B ER0 T
ABET  AH0 B EH1 T
ABETTED  AH0 B EH1 T IH0 D
ABETTING  AH0 B EH1 T IH0 NG
ABEX  EY1 B EH0 K S
ABEYANCE  AH0 B EY1 AH0 N S 
```

（单词在左边，右边是一系列音素，[关键在这里](http://www.speech.cs.cmu.edu/cgi-bin/cmudict#about)）

您想将其用作机器学习系统的训练数据，该系统将接受新单词并猜测它们在英语中的发音方式。

至少对我来说并不是那么明显，因为没有固定的字母标记大小可以映射到音素。我有一种感觉，与马尔可夫链有关的事情可能是正确的方法。

你会怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T23:07:16.747

该问题称为字素到音素的转换，是[自然语言处理](http://en.wikipedia.org/wiki/Natural_language_processing)的一个子问题。谷歌[提出了](http://www.google.com/search?q=grapheme+to+phoneme)一些论文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T14:58:36.687

不完全是我的领域，但可能建立一个具有多层的神经网络 - 较早的层猜测单词分成连续的音节，后面的层猜测所述音节的发音。

对于数字数据，建立一个 ANFIS 学习神经网络相当简单，对于文字/语音数据，任务无疑要复杂几个数量级。

# .net - 将数据从一个 DataSet 循环和复制到另一个 DataSet 的最快方法

> ID：673623
> 
> 赞同：2
> 
> 时间：2009-03-23T14:41:07.167
> 
> 标签：.net, ado.net, dataset

我有一个包含 2 个相关数据表（主数据表和详细信息）的数据集。我想将与我的过滤器匹配的数据（例如主数据列 A = "XXX"）复制到另一个 DataSet。

现在我发现这个过程需要很长时间（1k 条记录大约需要一个小时）。

我想知道如何改善这个处理时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T14:00:29.557

我想说复制 1000 条记录应该只需要几毫秒。确保没有事件触发或数据绑定做奇怪的事情。也许你应该尝试没有关系，但我相信enforcecontraints = false也会禁用外键检查..

以下代码非常快速地复制了一个完整的数据集：

```
fDstDataSet.EnforceConstraints = false;
foreach (DataTable fSrcTable in fSrcDataSet.Tables)
{
    DataTable fDstTable = fOpenOrders.Tables[fSrcTable.TableName];
    foreach (DataRow fSrcRow in fSrcTable.Rows)
    {
        fDstTable.ImportRow(fSrcRow);
    }
}
fDstDataSet.EnforceConstraints = true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T14:43:48.423

您可能想尝试一下；

```
 myDataSet.Tables[0].Select("A = 'xxx'"); 
```

哪个返回`DataRow[]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:50:53.633

您可能会在更详细地概述您的问题时获得一些好处 - 可能有比复制数据更好的选择。

如果你真的想走这条路，你可能想看看 DataView 类：

[http://msdn.microsoft.com/en-us/library/system.data.dataview.aspx](http://msdn.microsoft.com/en-us/library/system.data.dataview.aspx)

这将允许您根据数据表中的过滤器提取数据。DataView 也有一个方法 ToTable：

[http://msdn.microsoft.com/en-us/library/system.data.dataview.totable.aspx](http://msdn.microsoft.com/en-us/library/system.data.dataview.totable.aspx)

这将根据 DataView 中的选定行返回一个数据表。

这应该比您的版本执行得更好，尽管我不确定其他选项是否会再次提供更快的实现。我相信上面的 DataTable.Select 会比 DataView 表现得更好

# iphone - 捆绑视频或稍后下载？

> ID：673624
> 
> 赞同：0
> 
> 时间：2009-03-23T14:41:10.770
> 
> 标签：iphone, itunes, app-store-connect

我有一个应用程序，它使用我创建的小视频来演示特定主题中解释的概念。视频至少为 3MB，我不确定最大但可能为 5MB。对于 v1.0，我想分发 5 个视频。大约 15MB 加上该应用程序的另一个兆。我是否应该通过 iTunes 分发视频，因为用户的计算机连接速度可能更快并且整体体验更好？您的 .app 文件是否有一些大小限制？

或者我应该把某种按需方案放在一起？例如，该应用程序可以向我的网站发送用于身份验证的代码。然后用户可以通过他们的 iPhone 下载视频内容。如果用户使用 wifi 或 3G，我想这是一个不错的体验。但是如果他们只有2G，那就不好了。

v1.1 将包含更多视频，并可能重做现有视频。每个新版本都有望包含更多视频。

只是寻找最好的方法来做到这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:36:53.973

一种选择：

无论何时发布，只发布新视频。用户第一次运行应用程序时，将捆绑包中的所有视频复制到设备上。每当您发布新版本时，他们都会有以前版本中的先前视频。任何错过的视频/更新都可以使用您建议的身份验证方案随时从您的网站下载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:28:40.980

在 15-16MB 时，您可能高于平均水平，但您肯定不会处于“极端”大小的区域。Apple 对上传大于 200MB 的应用程序有特殊说明，因此他们准备好处理比您想象的要大得多的捆绑包。我的手机上有一个应用程序，大小为 283MB。

是否包含视频或提供以后下载实际上应该取决于您是否希望在不下载新版本应用程序的情况下向用户提供新视频。

话虽如此，如果视频可以重新编码为更小的尺寸而不会显着影响它们在 iPhone 屏幕上的外观，那么这样做将是一个非常好的主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:51:52.720

我最近在手机上的 appstore 应用程序中看到一条警告，它不允许我更新我试图通过 3G 更新的应用程序，因为它的大小 > 10MB - 我必须等到我有 WiFi 连接。只是另一个需要注意的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-08T19:44:28.087

我现在自己也面临着这个困境。我更愿意在我的应用程序中嵌入一些使用教程视频，但它会使我的应用程序在未压缩的情况下保持在 20MB 左右（我怀疑压缩会使其低于 10MB）。我真的不想失去冲动的下载者，因为该应用程序对于 3g 来说太大了。

所以我正在玩弄的策略是将较小的包含到我有可能超过 10MB 限制的地步，然后指出指向任何无法包含的视频的链接将通过网络流式传输. 并且可能在未来的更新中，提供一个选项来下载未包含的视频，然后更改 HTML 帮助页面中的链接以使用缓存版本，尽管我不相信这值得付出努力。

我现在正在使用 iShowU HD（虽然我喜欢 ScreenFlow 的编辑功能，但 iShowU 的价格合适并且足以满足我的需求）并且通过将视频大小调低到 15fps 并使用压缩滑块播放.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T16:40:08.940

除了应用程序大小与下载时间之外，您可能还需要考虑如果您从您的网站提供多媒体内容而不是在应用程序包中嵌入资源，您的应用程序是否会触发拒绝标志。

# oop - 为什么 MATLAB 报告我的变量未初始化？

> ID：673626
> 
> 赞同：1
> 
> 时间：2009-03-23T14:41:22.080
> 
> 标签：oop, matlab

我做了一个类，在它的一种方法中，我需要计算两点之间的距离。所以我写了一个名为“remoteness”的普通函数来为我做这件事。

### 编译错误：

> 在编译时，“remoteness”被确定为一个变量并且这个变量是未初始化的。“remoteness”也是一个函数名，以前版本的 MATLAB 会调用该函数。

但是，MATLAB 7 禁止在相同的上下文中使用相同的名称作为函数和变量。

> ==> TRobot>TRobot.makeVisibilityGraph 在 58 处出错 obj.visiblityGraph(k,k+1) = remoteness(:,obj.VGVertices(k),obj.VGVertices(:,k+1));

我认为该名称`remoteness`可能是另一个函数的名称，但是当我将其名称更改为时`kamran`，错误仍然存​​在。应该注意的是，我可以在命令行中使用该`kamran`函数（或`remoteness`）没有任何问题。

### 命令行示例：

```
>> kamran([0,0],[3,4])

ans = 5 
```

该`kamran`函数的代码在一个单独的 m 文件中。

### 功能代码`kamran`：

```
function dist = kamran(v1,v2)
    dist = sqrt(    (v1(1) - v2(1)) ^2  + (v1(2) - v2(2)) ^2   ); 
```

### `kamran`如何使用函数的代码示例：

```
function obj = makeVisibilityGraph(obj)
          verticesNumber = 0; 
          for num = 1: size(obj.staticObstacle,2)
              verticesNumber = verticesNumber + size(obj.staticObstacle(num).polygon,2);
          end
          % in the below line, 2 is for start and goal vertices
           obj.visibilityGraph = ones(2 + size(obj.VGVertices,2)) * Inf;
           for j=1 : size(obj.staticObstacle,2)
              index = size(obj.VGVertices,2);
              obj.VGVertices = [obj.VGVertices, obj.staticObstacle(j).polygon];
              obj.labelVGVertices = [obj.labelVGVertices, ones(1,size(obj.staticObstacle(j).polygon,2))* j ];
              for k = index+1 : (size(obj.VGVertices,2)-1)
                  obj.visiblityGraph(k,k+1) = kamran(:,obj.VGVertices(k),obj.VGVertices(:,k+1));
              end
%             as the first and last point of a polygon are visible to each
%             other, so set them visible to each other
              obj.visibilityGraph(index+1,size(obj.VGVertices,2)) = ...
                               kamran( obj.VGVertices(:,index+1), obj.VGVertices(:,size(obj.VGVertices,2)));
           end     

end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T14:51:55.363

您似乎正在尝试将 kamran 用作数组：

```
 kamran(:,obj.VGVertices(k),obj.VGVertices(:,k+1)); 
```

注意第一个参数“：”？

我敢打赌 MATLAB 假定 kamran （如此处所称）应该是一个 3 维数组，并且您正在尝试选择包含

```
kamran(all-of-first-index, Nth-of-second, Mth-of-third) 
```

kamran 的第二次调用看起来是正确的：

```
kamran( obj.VGVertices(:,index+1), obj.VGVertices(:,size(obj.VGVertices,2)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T14:51:46.550

我不知道 MATLAB，但我注意到这一行，你正在运行 kamran，看起来像 3 个参数。在所有其他情况下，它使用 2 个参数执行。也许这有什么关系？

```
 kamran(:,obj.VGVertices(k),obj.VGVertices(:,k+1)); 
```

# c# - WCF：MessageContract、DataContract ... 感到困惑？

> ID：673638
> 
> 赞同：23
> 
> 时间：2009-03-23T14:44:05.240
> 
> 标签：c#, wcf, architecture

我正在编写我的第一个 WCF 服务。我决定首先将服务编写为一个 DLL，然后再将 WCF 的东西放在上面，这就是我现在所处的位置。

架构师建议我应该坚持我已经完成的消息对象的特定格式。但是，我在消息对象中使用了接口、复杂类型及其列表。我要添加属性，我有点困惑。

这是我的代码的展示示例。

```
[ServiceContract]
public interface MyServiceContract
{
     [OperationContract]
     MyMethodResponseMessage MyMethod(MyMethodRequestMessage request);
}

public class MyService : MyServiceContract
{
    public MyMethodResponseMessage MyMethod(MyMethodRequestMessage request)
    {
        //Do things
    }
}

//Messages
[MessageContract]
public class MyMethodResponseMessage 
{
    [MessageBodyMember]
    public MyMethodResponse Body { get; set; }
}

[DataContract]
public class MyMethodResponse
{
    [DataMember]
    public IMyComplexTypeItem { get; set; }

    [DataMember]
    public List<IMyComplexType> Items { get; set; }

    [DataMember]
    public bool Success { get; set; }
}

//DTO    
public interface IMyComplexType 
{
    [DataMember]
    string Identity { get; set; }
}

[DataContract]
public class MyComplexType1 : IMyComplexType
{
     [DataMember]
     public virtual string Identity
} 
```

任何人都可以评论使用 MessageContract、DataContract、DataMember 和 Serializable 等的正确性吗？有任何指示或明显的错误吗？

还有哪个序列化器最好用？以及确保我从中获得格式良好的 XML 以便其他客户可以轻松使用我的服务的最佳策略是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-23T15:08:50.377

重新请求/响应 - a`[DataContract]`也可以。消息合同的优点之一是您可以对成员设置隐私，但在许多情况下这不是必需的。在这种情况下，我更喜欢让合同尽可能简单，就像数据合同一样。

Re which serializer - 这在很大程度上是配置的一个因素。例如，默认情况下通过 http，它将是`DataContractSerializer`.

但是，我不确定该列表`IMyComplexType`是否会很好地工作。您可以尝试，但通常它需要具体类型。请注意，您可以使用基类`[KnownType]`来指定允许的子类型。

请注意，与 不同`XmlSerializer`的是，集合成员不需要设置器 - 尽管`OnDeserializing`如果这样做，您可能需要添加一个回调方法来初始化列表（WCF 不调用构造函数）。

另外：您还可以将[protobuf-net](http://code.google.com/p/protobuf-net/)与数据合同和 WCF 一起使用（只要它们有明确的订单）；这比常规的 xml 更密集。不过，它目前不支持消息合同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T07:45:02.337

虽然不是您问题的直接答案，但值得注意[MSDN 中的以下内容 - 使用消息合同](http://msdn.microsoft.com/en-us/library/ms730255.aspx)

> 每个单独的消息头和消息正文部分都使用为使用消息的服务合同选择的序列化引擎进行序列化（转换为 XML）。默认序列化引擎**XmlFormatter**可以处理任何具有**数据协定**的类型，无论是**显式**（通过具有 System.Runtime.Serialization.DataContractAttribute）还是**隐式**（通过作为原始类型，具有 System.SerializableAttribute 等） ）。

![在此处输入图像描述](https://i.stack.imgur.com/Hy7V2.jpg)

# logging - 日志记录白皮书

> ID：673640
> 
> 赞同：0
> 
> 时间：2009-03-23T14:44:37.767
> 
> 标签：logging

我计划从头开始为 Java/J2EE 创建一个日志框架。在这方面，我想要一些关于常见行业日志标准的白皮书以供参考。任何指向相同的指针表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T14:48:49.410

谷歌“log4j 糟透了”或类似的东西，并尝试找出有关当前框架有什么问题的一切。因为它们显然不能满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T14:46:23.707

最好的资源是当前的 Java 日志记录冠军——AFAIK，即 log4j。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T16:49:31.897

为什么需要另一个日志框架？

最常用的 log4j 做得很好，SLF4J 更好。您需要什么不在这些框架中？

# java - 如何防止 Netbeans 中的 PermGen 空间错误？

> ID：673646
> 
> 赞同：27
> 
> 时间：2009-03-23T14:45:04.707
> 
> 标签：java, netbeans, netbeans6.5, java-6

每 15-30 分钟 Netbeans 显示一个“ `java.lang.OutOfMemoryError: PermGen space`”。根据我从 Google 那里了解到的情况，这似乎与一般的类加载器泄漏或内存泄漏有关。

不幸的是，我发现的所有建议都与应用程序服务器有关，我不知道将它们调整到 Netbeans。（我什至不确定这是同一个问题）

我的应用程序有问题吗？我怎样才能找到源头？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-23T15:11:17.470

这是因为不断的类加载。

Java 将类字节码和所有常量（例如字符串常量）存储在默认情况下不会被垃圾回收的永久堆中（这在大多数情况下是有意义的，因为类在应用程序的生命周期中只加载一次）。

在通常在整个生命周期中加载类的应用程序中：

*   热重新部署期间的 Web 和应用程序服务器；
*   运行已开发应用程序时的 IDE（每次您在 Netbeans 或 Eclipse 中点击“运行”按钮时，它都会重新加载应用程序的类）；
*   等等这种行为是不恰当的，因为堆最终会填满。

您需要打开永久堆垃圾回收以防止出现此错误。

我使用选项

```
-XX:MaxPermSize=256M
-XX:+CMSClassUnloadingEnabled
-XX:+CMSPermGenSweepingEnabled 
```

（阻止我的 Eclipse 3.4 抛出“ `java.lang.OutOfMemoryError: PermGen space`”，因此它也应该与 netbeans 一起使用）。

**编辑**：请注意，对于 Netbeans，您在以下位置设置了这些选项： `[Netbeans installation]\etc\netbeans.conf` 您应该为这些选项添加前缀`-J`并添加它们`netbeans_default_options`（有关更多信息，请参阅注释`netbeans.conf`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T14:57:58.780

尝试将以下参数添加到 netbeans netconf：-J-XX:MaxPermSize=256m

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-12-06T10:27:37.067

如果您正在开发 Web 应用程序，请尝试使用服务器 vm 选项

-Xmx512m -Xms512m -XX:MaxPermSize=512m

转到工具/服务器//平台/VM 选项（Netbeans 7.4）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T14:54:08.663

请参阅此[链接](http://blog.paulgu.com/2008/07/19/6-common-errors-in-setting-java-heap-size/)了解如何设置 PermSize 的大小。很可能这不是您的代码的问题，因此唯一的解决方案是增加 PermSize。当您使用 JAXB 时，我发现这很常见。一般来说，如果你使用很多库，而这些库本身也依赖于很多其他的 jar 文件，那么 PermGen 空间的默认大小可能不够大。

有关更多详细信息，请参阅这些博客文章：[类加载器泄漏](http://frankkieviet.blogspot.com/2006/10/classloader-leaks-dreaded-permgen-space.html)和[如何修复可怕的“java.lang.OutOfMemoryError: PermGen space”](http://frankkieviet.blogspot.com/2006/10/how-to-fix-dreaded-permgen-space.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T14:55:18.630

您可以通过编辑文件 /etc/netbeans.conf 来更改 netbeans JVM 的启动选项。我在开发 Webapp 并经常部署它时经常会遇到这种错误。在那种情况下，我会不时重启tomcat。

# sql - SQL中日期的模运算

> ID：673651
> 
> 赞同：2
> 
> 时间：2009-03-23T14:45:52.023
> 
> 标签：sql, sql-server, oracle, date

我有一个系统，它定义了天的重复模式。每个模式都有一个基准日期（通常是几年前，即创建该模式的时间）和一个天数（循环），因此例如它可能定义一个为期 7 天的模式：

**表：模式**

```
ID | BaseDate   | DayCount
-----------------------------
1  | 01/02/2005 | 7 
```

**表：图案详情**

```
PID  | Offset | Detail
----------------------
1    | 0      | A
1    | 1      | B
1    | 2      | B
1    | 3      | C
  etc. 
```

（详细信息列是特定领域的，不相关。）

我想要做的是，给定一个日期（比如今天），为给定的工作模式在**PatternDetail表中计算出正确的偏移量。**在伪代码中我会这样做：

```
offset = ((today.InDays) - (Pattern.BaseDate.InDays)) % (Pattern.DayCount) 
```

如何在 SQL 中执行此操作（需要在 MSSQL Server 和 Oracle 中工作）？换句话说，我如何计算两个日期之间的天数并取这个差异的模数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T14:57:43.353

我不知道 PL/SQL 中有什么可用的，但 T-SQL 有一个 DATEDIFF 函数，这似乎是您正在寻找的：

```
@Offset = ((DATEDIFF(day, @BaseDate, GETDATE()) % @DayCount) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T14:57:34.193

使用 DATEDIFF 获得不同的天数。这给出了一个整数。然后使用 % （标准 SQL 模运算符）。

就这么简单吗？

# language-agnostic - 什么时候可以检查文件是否存在？

> ID：673654
> 
> 赞同：35
> 
> 时间：2009-03-23T14:46:30.290
> 
> 标签：language-agnostic, filesystems

文件系统是易变的。这意味着您不能相信一个操作的结果对于下一个操作仍然有效，即使它是下一行代码。你不能只说`if (some file exists and I have permissions for it) open the file`，也不能说`if (some file does not exist) create the file`。`if`您的条件结果总是有可能在代码的两个部分之间*发生变化*。这些操作是不同的：不是原子的。

更糟糕的是，问题的性质意味着，如果您想进行此检查，您很可能已经担心或意识到文件可能会发生您无法控制的事情。开发环境的性质使此事件在您的测试期间不太可能发生并且非常难以重现。因此，您不仅有错误，而且错误不会在测试时出现。

因此，在正常情况下，最好的做法是不要尝试检查文件或目录是否存在。相反，请将您的开发时间用于处理来自文件系统的异常。无论如何，您必须处理这些异常，因此这是对资源的更好利用。尽管异常很慢，但检查文件是否存在需要额外访问磁盘，并且磁盘访问*要*慢得多。在另一个问题中，我什至对此效果有一个很好的[答案。](https://stackoverflow.com/questions/265953/c-how-can-you-easily-check-if-access-is-denied-for-a-file/265958#265958)

但我有一些疑问。例如，在 .Net 中，如果确实*总是*如此，那么这些`.Exists()`方法一开始就不会出现在 API 中。*还要考虑您希望*程序需要创建文件的场景。想到的第一个例子是桌面应用程序。该应用程序将一个默认的用户配置文件安装到它的主目录，并且当每个用户第一次启动该应用程序时，它会将这个文件复制到该用户的应用程序数据文件夹中。它希望该文件在第一次启动时不存在。

那么什么时候可以提前检查文件的存在（或其他属性，如大小和权限）？在第一次尝试时期待失败而不是成功是一个足够好的经验法则吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-23T16:12:00.023

File.Exists 方法主要用于在您不打算打开文件时测试文件是否存在。例如，测试一个锁定文件的存在，它的存在告诉你一些事情，但其内容并不重要。

如果您要打开该文件，那么无论之前对 File.Exists 的任何调用的结果如何，您都需要处理任何异常。所以，一般来说，在这种情况下调用它没有真正的价值。只需在您的 open 方法中使用适当的 FileMode 枚举值并处理任何异常，就这么简单。

编辑：尽管这是根据 .Net API 表达的，但它基于底层系统 API。Windows 和 Unix 都有使用 FileMode 枚举等效的系统调用（即 CreateFile）。事实上，在 .Net（或 Mono）中，FileMode 值只是传递给底层系统调用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-01-13T16:07:44.970

作为一般策略，方法如`File.Exists`，或属性如`WeakReference.Alive`or`SomeConcurrentQueue.Count`作为确保“好”状态存在的一种手段没有用，但可以作为一种确定“坏”状态存在而不做任何不必要（并且可能适得其反）工作的手段。这种情况可能出现在许多涉及锁（和文件，因为它们通常包括锁）的场景中。因为所有需要锁定一组资源的例程都应该在可行的情况下始终以一致的顺序获取这些资源上的锁定，因此可能有必要在获取可能存在的资源之前获取预期存在的一个资源上的锁定或者可能不存在。在这种情况下，虽然无法避免可能会锁定第一个资源，但无法获取第二个资源，然后在没有对其进行任何有用工作的情况下释放第一个锁，

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T14:50:06.427

这取决于您的要求，但一种方法是尝试通过某种重试机制获得**独占的打开文件句柄。**一旦有了那个句柄，另一个进程就很难（或不可能）删除（或移动）该文件。

我在 .NET 中使用了与以下类似的代码来获取独占文件句柄，我希望其他进程可能会在其中写入文件：

```
FileInfo fi = new FileInfo(fullFilePath);

int attempts = maxAttempts;
do
{
    try
    {
        // Asking to open for reading with exclusive access...
        fs = fi.Open(FileMode.Open, FileAccess.Read, FileShare.None);
    }
    // Ignore any errors... 
    catch {}

    if (fs != null)
    {
        break;
    }
    else
    {
        Thread.Sleep(100);
    }
}
while (--attempts > 0); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T14:58:14.397

一个例子：您可能能够检查您无法打开的文件是否存在（例如，由于权限）。

另一个可能更好的例子：你想检查一个 Unix 设备文件是否存在。但绝对不要打开它；打开它有副作用（例如，打开/关闭`/dev/st0`会倒带）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T14:50:44.960

在 *nix 环境中，检查程序的另一个副本是否已经在运行的一种完善的方法是创建一个锁定文件。因此，检查文件是否存在用于验证这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T14:53:16.013

这可能过于简单，但我认为检查文件是否存在（因此存在 .Exists()）的主要原因是防止意外覆盖现有文件，而不是避免因尝试访问而导致的异常不存在或不可访问的文件。

**编辑 2**

事实上，这太简单了，我建议你看看斯蒂芬马丁的回应。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T14:56:40.140

我认为当您首先要确保文件存在时，检查是有意义的。正如你所说的设置文件......如果有一个文件，我会尝试合并现有的设置，而不是把它们吹走。

其他情况是当用户告诉我对文件做某事时。是的，我知道 openFileDialog 将检查文件是否存在（但这是可选的）。我模糊地记得在 VB6 中情况并非如此，因此验证他们刚刚告诉我使用的文件是否存在是很常见的。

我宁愿不按例外编程。

# 编辑

我没有错过重点。您可能会尝试访问该文件，然后引发异常，然后当您创建文件时，该文件已经放置在那里。现在这会导致您的异常处理代码出现问题。所以我想我们可以在我们的异常处理程序中有一个异常处理程序来捕获文件再次更改......

我宁愿尝试防止异常，而不是使用它们来控制逻辑。

# 编辑

此外，检查大小等属性的另一个时间是在您等待文件操作完成时，是的，您永远无法确定，但使用良好的算法并且取决于写入文件的系统，您可能能够处理大量案例（有一个运行了五年的系统，它监视通过 ftp 的小文件，它使用与文件系统监视程序相同的 api，然后开始轮询等待文件停止更改，然后引发文件的事件已准备好食用）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-23T14:56:53.057

如果我希望它丢失（例如应用程序设置）并且只有当我必须阅读文件时，我才会检查它。

如果我必须写入文件，它要么是一个日志文件（所以我可以附加到它或创建一个新文件）或者我替换它的内容，所以我还是重新创建它。

如果我期望该文件存在，那么抛出异常是正确的。然后异常处理应通知用户或执行恢复。我的观点是，这会产生更清晰的代码。

文件保护（即不覆盖（可能很重要）文件）是不同的，在这种情况下，如果框架不为我这样做，我总是会检查文件是否存在（想想 SaveFileDialog）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-23T14:51:35.223

如果您担心其他人删除文件，也许您应该实施某种锁定系统。例如，我曾经为 Usenet 新闻服务器 C-News 编写代码。由于它所做的很多事情都可能异步发生，它会通过制作一个临时文件来“锁定”一个文件或目录，然后将其硬链接到一个名为“LOCK”的文件。如果链接失败，则意味着程序的其他版本正在写入该目录，否则它是你的，你可以做你喜欢的。

有趣的是，大部分程序都是用 shell 和 awk 编写的，这是一种非常便携的锁定机制。此外，锁定文件将包含所有者的 PID，因此您可以查看现有的锁定文件以查看所有者是否仍在运行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-23T14:52:17.467

我们有一个诊断工具，它必须收集一组文件，包括安装程序日志。根据不同的条件，安装程序日志可以位于两个文件夹之一中。更糟糕的是，这两个文件夹中可能有不同版本的日志。该工具如何找到正确的？

如果您检查是否存在，这很简单。如果只有一个，请获取该文件。如果存在两个，则查找哪个具有最新的修改时间并获取该文件。这只是正常的做事方式。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-23T14:52:33.630

虽然这是一篇与语言无关的帖子，但您似乎在谈论 .NET。大多数系统（.NET 和其他系统）都有更详细的 API，以便在打开文件时确定文件是否存在。

您应该做的是调用访问该文件，因为它通常会通过某种错误指示该文件不存在（如果它确实不存在）。在 .NET 中，您必须通过 P/Invoke 层并使用 CreateFile API 函数。如果该函数返回 ERROR_FILE_NOT_FOUND 错误，那么您就知道该文件不存在。如果它成功返回，那么你就有了一个可以使用的句柄。

这里的重点是它是一个*有点*原子的操作，这最终是你要找的。

然后，使用句柄，您可以将其传递给 FileStream 构造函数并在文件上执行您的工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-23T14:53:30.850

您可能正在编写许多可能的应用程序，简单的 File.Exists 足以胜任这项工作。如果它是一个只有您的应用程序会使用的配置文件，那么您不需要在异常处理中如此矫枉过正。

虽然您在使用此方法时指出的“缺陷”都是有效的，但这并不意味着它们在某些情况下不是可接受的缺陷。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-23T14:57:09.233

我认为，只要您知道文件可能存在或不存在，并且您想根据文件的存在执行一些替代操作，您应该进行检查，因为在这种情况下，文件不存在并不是例外情况. 这不会免除您必须处理异常的责任——其他人在检查和打开之间删除或创建文件——但它使程序的意图清晰，并且不依赖异常处理来执行流程-控制逻辑。

**编辑**：一个例子可能是启动时的日志轮换。

```
 try
  {
       if (File.Exists("app.log"))
       {
           RotateLogs();
       }

       log = File.Open("app.log", FileMode.CreateNew );
  }
  catch (IOException)
  {
     ...another writer, perhaps?
  }
  catch (UnauthorizedAccessException)
  {
     ...maybe I should have used runas?
  } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-23T14:59:56.763

各种应用程序包括内置的 Web 服务器。他们第一次启动时生成自签名 SSL 证书是很常见的。实现这一点的一种直接方法是检查证书是否在启动时存在，如果不存在则创建它。

理论上，它可以为检查而存在，以后不存在。在这种情况下，当我们尝试收听时，我们会得到一个错误，但这可以很容易地处理并且不是什么大问题。

它也可能不存在用于检查，并且稍后存在。在这种情况下，它要么被新证书覆盖，要么写入新证书失败，具体取决于您的策略。第一个有点烦人，就证书更改引起的一些警报而言，但也不是很关键，特别是如果您进行一些日志记录以指示正在发生的事情。

而且，在实践中，这两种情况都极不可能出现。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-23T15:02:14.307

就像您指出的那样，如果文件丢失，程序应该做什么总是很重要的。在我的所有应用程序中，用户始终可以删除配置文件，应用程序将使用默认值创建一个新文件。没问题。我还发布了没有配置文件的应用程序。

但是用户倾向于删除文件，甚至是他们不应该删除的文件，如序列号和模板文件。我总是检查这些文件，因为没有它们，应用程序根本无法运行。我无法从默认值创建新的序列号。

文件丢失时应该发生什么？您可以执行文件查找或异常处理程序，但真正的问题是：文件丢失时会发生什么？或者文件对应用程序有多重要。在尝试访问应用程序的任何支持文件之前，我一直在检查。另外，如果文件损坏并且无法加载，我会进行错误处理。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-23T15:26:01.270

我认为“存在”的原因是确定文件何时丢失，而无需创建访问文件所需的所有操作系统内务数据或引发异常。所以这是一个文件处理优化比什么都重要。

对于单个文件，“Exists”给出的保存通常是微不足道的。如果您要检查一个文件是否存在很多次（例如，搜索#include 文件），那么节省可能会很大。

在 .Net 中，File.Exists 的规范没有列出该方法可能抛出的任何异常，这与 File.Open 列出了九个异常不同，因此前者的检查肯定更少。

即使“存在”返回 true，您仍然需要在打开文件时处理异常，正如 .Net 参考所建议的那样。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-01T18:59:19.987

为了回答我自己的问题（部分），我想扩展我使用的示例：默认配置文件。

与其在应用程序启动时检查它是否存在并在检查失败时尝试复制文件，不如*始终*尝试复制文件。您只需这样做，如果文件存在，副本将失败，而不是替换现有文件。这样，您需要做的就是捕获并忽略由于现有文件而导致复制失败时引发的任何异常。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-08T15:10:53.833

您的问题可以通过基本的计算机科学轻松解决……阅读[Semaphores](http://en.wikipedia.org/wiki/Semaphore_(programming))。

（我并不是要听起来像个混蛋，我只是为您指出一个常见问题的简单答案）。

# html - 如何改善静态 HTML 网站的加载时间？

> ID：673655
> 
> 赞同：6
> 
> 时间：2009-03-23T14:46:35.640
> 
> 标签：html, gif

我们正在开发一个网站，并注意到 GIF 图像（100kb - 200kb）的加载速度非常慢。

该站点是具有 CSS/HTML 的静态站点。

有没有人指出为什么图像加载缓慢？

使用 JPG 会提高性能吗？

这是该图像的 HTML 代码：

```
<div><img src="images/mainImg_3.gif"> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-23T14:51:31.573

它们加载缓慢，因为它们很大。200KB 是一个非常大的图像文件。我不确切知道网络图像的推荐是什么，但将它们保持在 50K 以下是一个非常好的主意。

GIF 图像对于摄影图像不是很有效。您应该尝试使用 JPG 和 PNG 等其他格式，看看是否可以用更小的文件大小获得相同的质量。您应该能够在保持质量的同时大大缩小文件大小。

另一个技巧：使用缩略图。保存每个图像的两个版本，一个是另一个大小的 25%（按分辨率）。如果您的网站访问者想要查看更多内容，可以单击缩略图。这将加快加载时间并减少您的带宽费用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T14:51:18.360

你的图片尺寸合适吗？如果您在网页上将它们显示为 300x300 像素，请确保原始图像的大小相同。

这有两方面的帮助，一是要下载的数据更少，二是不需要额外的处理能力来调整浏览器的大小。此外，如果图像尺寸准确，图像看起来会更清晰。

至于 GIF 和 JPG 之间的区别（除了透明度，JPG 不支持），它归结为您的图像包含的内容。GIF 使用颜色表和该颜色表的映射来存储图像，而 JPG 使用压缩算法。因此，如果您的图像包含很少的颜色变化，您将从 GIF 中获得较小的文件大小。相反，如果您有一张颜色变化很大的照片，您将需要使用 JPG。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T14:58:29.420

也看看[YSlow](http://developer.yahoo.com/yslow/)

它将为您分析您的网站并告诉您瓶颈可能在哪里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T15:01:32.017

为图像文件启用缓存（下面的示例还添加了 css 和 js 缓存），这将确保用户不会下载文件两次。如果您使用的是 apache 1.3 或 2：

```
ExpiresActive On
<FilesMatch "\.(ico|gif|jpe?g|png|js|css)$">
   ExpiresDefault "access plus 1 year"
</FilesMatch> 
```

为 html 和 css 启用 gzip 压缩可能是一个合理的想法。在阿帕奇 2：

```
SetOutputFilter DEFLATE 
```

在 Apache 1.3 中：

```
mod_gzip_on Yes 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T14:52:01.180

这取决于图像的大小，如果您以 100kb 显示壁纸大小的图像，那还不错。如果您要显示这种大小的缩略图，那么您就有问题了。

JPEG 图像有损，但可以轻松压缩。根据您选择的压缩程度，您可以使用 JPEG 真正减小图像尺寸。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T15:20:55.340

加载速度最快的资源始终是根本不需要加载的资源。即除了将图像缩小到合理的大小之外，您还应该阅读有关 HTTP 缓存的信息。

您应该指示您的 Web 服务器传递带有适当缓存信息的响应，以便用户代理可以重用本地缓存版本。

Mark Nottingham 写了一篇[关于 HTTP 缓存的教程](http://www.mnot.net/cache_docs/)。这是一个很好的起点。这[是一个](http://www.websiteoptimization.com/speed/tweak/cache/)关于 HTTP chaching 上的 apache 配置的教程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T15:25:30.273

您应该为 img 标签指定 height 和 width 属性，请参阅下面的 W3C Schools 解释为什么应该这样做。有关更多信息，请参阅[http://www.codinghorror.com/blog/archives/000807.html](http://www.codinghorror.com/blog/archives/000807.html)以了解更多更激进的技术。

> 提示：最好同时指定图像的高度和宽度属性。如果设置了这些属性，则在加载页面时会保留图像所需的空间。但是，如果没有这些属性，浏览器就无法知道图像的大小，也无法为其预留适当的空间。效果将是页面布局将在加载期间更改（同时加载图像）。
> 
> 提示：不要使用高度和宽度属性重新缩放图像！缩小具有高度和宽度属性的大图像会迫使用户下载大图像（即使它在页面上看起来很小）。正确的方法是在页面上使用图像之前，使用程序重新缩放图像。

[这是从http://www.w3schools.com/tags/att_img_height.asp](http://www.w3schools.com/tags/att_img_height.asp)复制的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T17:44:42.500

查看免费工具：[Smush It！](http://smush.it/)

它由 Stoyan Stephanov、Nicole Sullivan（来自 Yahoo!）共同开发，并结合了来自[YSlow](http://developer.yahoo.com/yslow/)（来自 Yahoo!）和 Yahoo Developer Network 调查结果的所有图片花絮。

它将分析您的图像并从一组服务器端工具中确定最佳图像类型是什么（例如 PNG8、PNG24、GIF、JPG 等），并创建优化的图像......例如，即使您提供它是一个PNG图像，它会找到最好的方法来压缩它，并将它“粉碎”到尽可能小的文件大小。

然后获取输出图像，然后从（[无 cookie 域](http://developer.yahoo.com/performance/rules.html#cookie_free)）提供它，如果可以的话，最好是在[CDN](http://developer.yahoo.com/performance/rules.html#cdn)上，带有[远期过期标头](http://developer.yahoo.com/performance/rules.html#expires)，使用[gzip 压缩](http://developer.yahoo.com/performance/rules.html#gzip)。

# opengl - 如何在 OpenGL 中以交互方式绘制图元？

> ID：673665
> 
> 赞同：2
> 
> 时间：2009-03-23T14:49:52.730
> 
> 标签：opengl

我很难在我的程序中设置这种行为。
基本上，我希望当用户按下`"a"`键时，屏幕上会显示一个新球体。

你怎么能那样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T14:53:25.670

我可能会通过简单地拥有某种数据结构（数组、链表等）来保存当前的“场景”来做到这一点。最初这是空的。然后当事件发生时，您创建某种新的所需几何图形的表示，并将其添加到列表中。

在每一帧上，您清除屏幕，并通过数据结构，将每个表示映射到一组合适的 OpenGL 命令。这真的很标准。

数据结构通常被称为[场景图](http://en.wikipedia.org/wiki/Scene_graph)，它通常采用树或图的形式，其中几何可以有子几何等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T15:10:04.477

如果您使用的是 GLuT 库（非常标准），您可以利用它的自动基元生成功能，例如`glutSolidSphere`. [您可以在此处](http://www.opengl.org/resources/libraries/glut/spec3/spec3.html)找到 API 文档。看看第 11 节，“几何对象渲染”。

正如 unwind 建议的那样，您的程序可以保留某种列表，但每个基元的参数，而不是实际的几何形状。在球体的情况下，这将是位置/半径/切片。然后，您可以使用 GLuT 函数轻松绘制对象。显然，这将您限制在 GLuT 可以绘制的范围内，但这通常适用于简单的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T15:10:14.633

如果没有更多关于您使用的环境的详细信息，很难具体说明，但是一些指向在设置 OpenGL 时很容易出错的事情的指针

1.  确保您已将相机设置为查看您正在绘制球体的点。这可能非常困难，最简单的方法是从 OpenGL Utility Toolkit 实现 glutLookAt。确保您的前面板和后面板设置为合理的值。

2.  至少在开始时关闭背面剔除。当然，使用生产代码背面剔除可以快速提高性能，但是很容易在对象上错误地设置法线并且因为您正在查看不可见的面而看不到它

3.  请记住调用 glFlush 以确保执行所有命令。绘制到后台缓冲区然后未能调用 glSwapBuffers 也是一个常见错误。

4.  有时，您可能会遇到缓冲区格式的问题——尽管如果您从适用于您系统的示例代码中复制，这不太可能成为问题。

一旦基本环境正确，图形编码往往很容易调试，因为输出是可视的，但是在新系统上设置渲染环境总是有点棘手，直到你渲染了第一个立方体或球体。我建议获取一个示例或模板并对其进行修改以开始，而不是尝试从头开始设置渲染窗口。使用 GLUT 检查 OpenGL 调用的初稿也是一种很好的技术。

# ajax - RichFaces：AJAX 操作成功时显示通知“弹出”

> ID：673670
> 
> 赞同：2
> 
> 时间：2009-03-23T14:50:47.987
> 
> 标签：ajax, jsf, richfaces, effect, ajax4jsf

我们目前正在开发一个基于 Java EE 5、JSF、Facelets 和 RichFaces 的 B2B 网上商店。到目前为止，该技术确实运行良好，但现在我面临一个小问题，我无法弄清楚如何解决：

产品以表格形式列出，通过单击行尾的小图标，可以将每个项目添加到购物篮中。添加产品是通过 AJAX 完成的，以避免页面完全重新加载。`h:dataTable`只需使用 a和 an`a4j:commandLink`调用将所选产品添加到购物篮的操作方法，就可以毫无问题地工作。即使在侧栏中始终可见的篮子总数的重新渲染也可以正常工作。

由于 AJAX 的性质，没有可见的指示（除了旁边的更改总数）操作成功或至少已完成。现在我想添加一个小“弹出”框，当 AJAX 操作完成时，它在添加图标旁边可见，表明该项目已添加到购物篮中。此框应在几秒钟后自动消失。

这是我认为应该起作用的（popup_message 和 popup_content css-classes 使框浮动在其标记所在的位置之上）：

```
<h:dataTable ....>
    ...
    <h:column>
        <a4j:commandLink action="...">
            <rich:effect event="oncomplete" targetId="addedMessage"
                 type="Appear" />
            <rich:effect event="oncomplete" targetId="addedMessage"
                 type="Appear" params="{delay:3.0, duration:1.0}" />
        </a4j:commandLink>

        <a4j:outputPanel id="addedMessage" styleClass="popup_message"
            style="display: none">
            <a4j:outputPanel layout="block" styleClass="popup_content">
                <h:outputText value="Item added!" />
            </a4j:outputPanel>
        </a4j:outputPanel>
    </h:column>
</h:dataTable> 
```

不幸的是，它根本不显示该框。如果我`event`将“出现”效果更改为`onclick`它几乎可以按预期工作。单击图标时立即显示，并在 AJAX 操作完成 3 秒后消失。但我不希望它在单击后立即出现，因为表明该项目已添加到购物篮是错误的，而实际上操作还没有开始。当我想指出一些错误或想在框中包含一些项目特定信息时，这变得更加重要，这些信息仅在添加项目后可用。

那么任何想法如何做到这一点？为什么为同一个事件添加两个效果不起作用？

（我已经看过[RichFaces 现场演示中的效果示例](http://livedemo.exadel.com/richfaces-demo/richfaces/effect.jsf)。这些示例的工作原理几乎相同，只是它们添加了第二个效果并明确说明了`for`属性。但即使这对我也不起作用。）

**更新：**我已经尝试`rich:toolTip`为此目的使用，这实际上似乎非常灵活。但无论我做什么，我都无法将任何内容附加到 的“未完成”（我也尝试过“完成”）事件`a4j:commandLink`，除了一个效果......似乎有一些关于该事件的错误/未记录的行为. 我刚刚发现了这个错误报告：[RF-3427](https://jira.jboss.org/jira/browse/RF-3427)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-24T13:12:18.963

你可以试试`rich:notify`这个 [http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=notify&skin=blueSky](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=notify&skin=blueSky)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T13:21:38.927

你试过`rich:status`吗？我不会发布一段代码。我认为文档会做得很好。

[http://livedemo.exadel.com/richfaces-demo/richfaces/status.jsf](http://livedemo.exadel.com/richfaces-demo/richfaces/status.jsf)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-23T15:23:26.707

您在参数之外定义 targetId。你想做的是：

```
<rich:effect event="oncomplete" type="Appear" params="targetId:'addedMessage',delay:3.0, duration:1.0" /> 
```

试试看，我认为它会奏效。

# asp.net - 在 ASP.NET 网站中是否有超过 100 个与 SQL Server db 的活动连接不正常？

> ID：673678
> 
> 赞同：1
> 
> 时间：2009-03-23T14:51:59.357
> 
> 标签：asp.net, sql, sql-server, security

在跟踪我的数据库上的活动连接时，我发现有时连接超过 100，这正常吗？几分钟后它返回到 20 或 25 活动连接 [有关我的问题的更多详细信息](https://stackoverflow.com/questions/673584/is-a-duration-of-394-when-executing-a-sql-query-too-much)

**该网站每天的访问量约为 200 人次。** **我为什么要问？因为 asp.net 连接字符串中的默认 MaxPool 是 100 我也在网站 IIS 中使用 Connection**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T14:59:16.017

这实际上取决于您的网站和您的流量。我看到一个站点在其高峰期查看了超过 350 个与 SQL 的活动连接。那是为大约 7,000 个并发 Web 用户，在两台 Web 服务器上，以及各种后端进程。

# 编辑

一些额外的信息，我们需要给你一个更好的答案：

*   有多少 Web 进程访问了您的 sql 服务器？例如，您是否使用网络花园？如果你有多个服务器，你有多少？这很重要，因为您可以通过计算您配置的每个进程的工作线程数来计算可以拥有的连接数。假设更糟糕的情况，每个线程都在运行，这会添加一个到池的连接。
*   你在使用连接池吗？如果是这样，您将在用户请求结束后看到连接仍然存在。默认情况下启用。
*   你有多少并发用户？

但是，我认为你犯了这个错误，你的池中没有可用的免费连接存在问题。我要寻找的第一件事是任何泄漏的连接（连接保持打开的时间比它们应该的更长）。例如，将数据阅读器传递到网页，可能是这种情况的标志。

接下来是评估默认设置。也许你应该运行一个网络花园，它应该给你更多的连接，或者增加可用连接的数量。

我要做的最后一件事是尝试优化你上一个问题中的查询。假设您将这些查询减半，您所做的只是为自己争取更多时间，直到更多用户进入系统，然后您就回到这里，只是这一次您可能无法再次优化该查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T15:00:05.123

您遗漏了一些细节，因此很难正确回答，但是...

这取决于，真的。如果您没有使用连接池，那么每次点击需要访问数据库的页面时，都会打开一个新连接。所以当然，这可能是完全正常的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T15:51:13.893

我也会研究缓存。缓存页面、缓存查询结果等。您可能会惊讶于您返回数据库获取美国各州列表的次数...

# mfc - 将静态文本框绑定到复选框

> ID：673680
> 
> 赞同：0
> 
> 时间：2009-03-23T14:52:07.420
> 
> 标签：mfc

我需要一些关于 MFC 的帮助。以下是我的问题：

1.  我有两个控件一个静态文本和一个复选框
2.  使用 MFC 向导时，我在静态文本中的一个字母前面放置一个“&”，在执行时如果按 Alt+，复选框将启用或禁用。
3.  现在我的问题是我正在以编程方式添加这些控件，即使我在静态文本中放置了“&”，如果我按下 Alt+，它也不会改变复选框控件的状态。

我的查询是：

1.  如果我们以编程方式添加控件，任何人都可以告诉我是否必须完成一些绑定。
2.  如果有人可以简要解释 MFC 如何处理绑定，那将是 gr8 帮助

编辑：复选框不会有任何与之关联的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T15:51:59.383

由于静态文本与复选框控件没有关联，系统如何知道它应该链接哪个复选框？我敢打赌，如果您查看 TAB 排序和控件的组设置，您将得到您的解决方案。

# java - 用 Java 为 OSX 编写一个可执行的 .sh 文件

> ID：673685
> 
> 赞同：8
> 
> 时间：2009-03-23T14:53:25.780
> 
> 标签：java, shell, scripting, executable, sh

所以我正在尝试编写一个可执行的 .sh 文件，这就是我目前的编写方式：

```
Writer output = null;

try {
  output = new BufferedWriter(new FileWriter(file2));
  output.write(shellScriptContent);
  output.close();
} catch (IOException ex) {
  Logger.getLogger(PunchGUI.class.getName()).log(Level.SEVERE, null, ex);
} 
```

这样就可以很好地写入文件，但它不可执行。有没有办法在我写的时候改变它的可执行状态？

编辑：为了进一步澄清，我试图让它默认执行，例如，如果你双击生成的文件，它会自动执行。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-23T15:00:36.870

您可以调用[`File.setExecutable()`](http://java.sun.com/javase/6/docs/api/java/io/File.html#setExecutable(boolean))为文件设置所有者的可执行位，这对于您的情况可能就足够了。或者您可以`chmod`自己使用`Process`.

唉，文件权限的全功能编程更改直到 Java 7 才可用。它将成为新 IO 功能集的一部分，您可以在[**此处**](http://jcp.org/en/jsr/detail?id=203)阅读更多信息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-23T14:56:44.993

你需要 chmod 它，你可以通过执行这样的系统命令来做到这一点：

你真正需要的只是启动这样的东西：

```
Runtime.getRuntime().exec("chmod u+x "+FILENAME); 
```

但是，如果您想更明确地跟踪它，可以捕获 stdin / stderr 然后更像：

```
Process p = Runtime.getRuntime().exec("chmod u+x "+FILENAME);
BufferedReader stdInput = new BufferedReader(new InputStreamReader(p.getInputStream()));    
BufferedReader stdError = new BufferedReader(new InputStreamReader(p.getErrorStream())); 
```

我从这里得到的：http: [//www.devdaily.com/java/edu/pj/pj010016/pj010016.shtml](http://www.devdaily.com/java/edu/pj/pj010016/pj010016.shtml)

**更新：**

测试程序：

```
package junk;
import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.io.Writer;

public class Main{
  private String scriptContent = '#!/bin/bash \n echo "yeah toast!" > /tmp/toast.txt';
  public void doIt(){
    try{
      Writer output = new BufferedWriter(new FileWriter("/tmp/toast.sh"));
      output.write(scriptContent);
      output.close();
      Runtime.getRuntime().exec("chmod u+x /tmp/toast.sh");
    }catch (IOException ex){}
  }

  public static void main(String[] args){
    Main m = new Main();
    m.doIt();
  }

} 
```

在 linux 上，如果您打开文件浏览器并双击 /tmp/toast.sh 并选择运行它，它应该会生成一个文本文件 /tmp/toast.txt，其中包含“yeah toast”。我认为 Mac 会做同样的事情，因为它的底层是 BSD。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-09-18T21:21:23.223

在 Java 7 中，您可以调用[`Files.setPosixFilePermissions`](https://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#setPosixFilePermissions(java.nio.file.Path,%20java.util.Set)). 这是一个例子：

```
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.attribute.PosixFilePermission;
import java.util.Set;

class FilePermissionExample {
  public static void main(String[] args) throws IOException {
    final Path filepath = Paths.get("path", "to", "file.txt");
    final Set<PosixFilePermission> permissions = Files.getPosixFilePermissions(filepath);
    permissions.add(PosixFilePermission.OWNER_EXECUTE);
    Files.setPosixFilePermissions(filepath, permissions);
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T15:55:13.883

在 Mac OS X 上，除了 chmod +x，`.command`如果你想通过双击启动它，你必须给你的 shell 脚本一个扩展名。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T19:32:52.583

[我为如何以编程方式更改文件权限](https://stackoverflow.com/questions/664432/java-how-do-i-programmatically-change-file-permissions)的问题写的[这个答案](https://stackoverflow.com/questions/664432/java-how-do-i-programmatically-change-file-permissions/664453#664453)通过使用 jna 的本机调用显示了一个 chmod 示例，它应该在 Mac OS X 上工作。

# data-compression - 数据压缩视频教程？

> ID：673691
> 
> 赞同：0
> 
> 时间：2009-03-23T14:54:40.957
> 
> 标签：data-compression

有谁知道我在哪里可以找到有关数据压缩的视频/截屏教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T14:59:11.133

不知道任何视频或截屏视频，但我对一个类似问题的[回答](https://stackoverflow.com/questions/386930/best-compression-algorithm-with-the-following-features/386946#386946)可能会有所帮助......

# javascript - Javascript事件调用者未传递给参数

> ID：673701
> 
> 赞同：1
> 
> 时间：2009-03-23T14:57:05.427
> 
> 标签：javascript, events, event-handling, dom-events

我正在使用`onmouseover`Javascript 编写以下函数

```
function fnNavMouseOver(evt) {
    alert(evt.target);
    var eSrc
    evt = (evt) ? evt : (window.event) ? window.event : ""
    eSrc = (evt.target) ? evt.target : evt.srcElement
    alert(eSrc);
} 
```

我的印象是在 Firefox 中应该将事件传递给函数。但是`evt`似乎以空值出现。有什么可能导致这种情况吗？

编辑 ：

调用这个方法的代码是这样工作的：

```
ButtonHTML += "<img onmouseover='fnNavMouseOver()' id='" + ButtonId + "Norm' src='" + ImgPath + "_n.jpg' style='border-style:none;z-index=102;position:absolute;left:0px;top:0px'>"; 
```

然后将该字符串附加到页面上的 div 中。我意识到这确实不理想，但我正在使用一个旧框架并尝试在其中插入一些新功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T15:15:00.317

如果您在 HTML 元素之外设置元素的 mouseover 事件处理程序，我认为您会将事件传递给您的函数。

在您的使用中，您实际上是在这样做：

`element.onmouseover = function () { yourfunction() };`

而不是这个：

`element.onmouseover = yourfunction`

这就是你*想要*做的。由于您在没有参数的情况下调用函数，因此它没有接收任何参数，从而导致传入 Null 值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T15:59:06.340

我同意关于事件处理程序的不显眼分配的答案，但是对于它的价值，您可以通过将事件对象作为参数传递来继续使用 HTML onmouseover 属性......

```
onmouseover="fnNavMouseOver(event);" 
```

# apache - RewriteLog 触发内部服务器错误

> ID：673711
> 
> 赞同：10
> 
> 时间：2009-03-23T14:59:05.720
> 
> 标签：apache, .htaccess

我正在尝试对我的重写规则进行一些调试，并希望启用 RewriteLog 来查看它们是如何被解释的。

但是当我激活它时，我得到内部服务器错误继承人这一行：

```
RewriteLog "/home/solomongaby/www/project/logs/rewrite.log" 
```

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-08-04T09:25:02.503

该[`RewriteLog`指令](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritelog)仅允许在服务器或虚拟主机配置中使用（请参阅[*上下文*值](http://httpd.apache.org/docs/2.2/mod/directive-dict.html#Context)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T19:34:42.477

您应该确保从 apache 日志文件中发布整个字符串，但我怀疑您已尝试在 .htaccess 中添加此字符串，它会给您错误“您不能在此处使用重写日志指令”。

ps是

```
RewriteLog "/home/solomongaby/www/project/logs/rewrite.log" 
```

并不是

```
RewriteLog "/home/solomongaby/www/project/logs/rewrite.log 
```

对？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T19:32:39.097

这很可能是权限问题。检查 Apache 的 error.log 文件。

# wpf - 将控件绑定到多个 DataTable

> ID：673715
> 
> 赞同：0
> 
> 时间：2009-03-23T14:59:31.990
> 
> 标签：wpf, data-binding, wpf-controls

这可能是一个奇怪的问题，但我来了（如果这是一个糟糕的数据库设计或只是我所处的奇怪情况，请告诉我）。

我的数据库中有两个表：ProductGroup 和Parameters。一个包含有关其名称的各种产品组的信息，另一个包含有关可应用于每个组的各种参数的信息（从而使每个组不同）。

现在为了关联这两个表，设置了第三个表 - GroupParameters 具有两个主键：parameterId 和 groupId，第三列是该组的参数值。

现在我有一个屏幕，显示有关每个组及其参数值的信息。用户也应该能够编辑这些值。因此，我的问题是如何将此值（存储在第三个表中）绑定到文本框。一般来说，在这种情况下我将如何绑定控件。

多谢你们！

**编辑：**我遗漏了一个重要的细节。我想使用**DataSet**和**DataTable**对象来存储数据库中的内存数据并将它们绑定到控件。其原因与问题无关，但它与我必须跟踪更改并能够按照用户的意愿撤消它们有关:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T15:40:09.023

我在这里没有看到任何真正糟糕的设计。

您可以为此构建 UI 作为用户必须从中选择的产品组列表（ListBox 绑定到 ProductGroups 集合），然后您可以拥有一个带有 ListBox、名为 CurrentGroupId 的属性和一些控制按钮的用户控件（例如“确定”）。将 CurrentGroupId 绑定到 ProductGroups 列表框的选定值。当 CurrentGroupId 更改或参数集合更改时，您应该使用 LINQ 或其他方式过滤此内部 ListBox 项目 - 基本上用 GroupParameter-s 重新填充 ListBox，其中 CurrentGroupId 与所选 ProductGroupId 匹配。ListBox 项应该是 GroupParameter-s 对象。

现在（终于:)）回答您的问题：您可以使用数据模板列表的项目来拥有一个文本框，像这样绑定到 Value 属性（这里 'local' 是您的命名空间）：

```
<DataTemplate DataType={x:Type local:GroupParameter}>
  <StackPanel Orientation="Horizontal">
    <TextBox Text="{Binding Value, Mode=TwoWay}" />
    <Button Content="OK" Click=INSERT_YOUR_OK_HANDLER_HERE />
    <Button Content="Cancel" Click=INSERT_YOUR_CANCEL_HANDLER_HERE />
  </StackPanel>
</DataTemplate> 
```

如果您需要让用户能够添加新参数，您可以创建一些添加功能，该功能将在参数集合中添加一个具有当前选定组 ID 的新条目。然后用户可以在您的用户控件中编辑刚刚添加的项目。

希望它有所帮助，如果我刚才所说的很难理解，我想我可以用代码编写大部分内容。不要犹豫，问我:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T20:59:02.897

实际上对我有用的最好的事情是使用[MultiBinding](http://msdn.microsoft.com/en-us/library/system.windows.data.multibinding.aspx)。我没有意识到这一点——不得不通过谷歌搜索查询自己学习很糟糕（即使用书学习会很慢）。

# java - 为什么 Java 会给我一个 IllegalArgumentException？

> ID：673716
> 
> 赞同：2
> 
> 时间：2009-03-23T14:59:44.907
> 
> 标签：java, javascript, spring, dwr

我正在使用 dwr 和 spring，我得到了这个错误：

```
java.lang.IllegalArgumentException：Javascript 名称 * 被 2 个类使用
```

我在 Google 上没有发现任何有用的信息，您知道我为什么会收到此错误吗？

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:dwr="http://www.directwebremoting.org/schema/spring-dwr"

       http://www.directwebremoting.org/schema/spring-dwr
       http://www.directwebremoting.org/schema/spring-dwr-3.0.xsd">

<dwr:configuration />
<dwr:controller id="dwrController" debug="true" />

    <bean id="ping" class="com.mycompany.Ping">
        <dwr:remote javascript="rpcPing">
            <dwr:include method="ping" />
        </dwr:remote>
    </bean>
</beans> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T17:01:00.123

成立。因为 DWR 的 jar 的版本与 DWR 的 schema 的版本不匹配

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-13T08:41:13.273

就我而言，原因是 dwr.xml 中的相关片段出现了两次。

```
<create creator="new" javascript="Tab">
  <param name="class" value="org.openxava.web.dwr.Tab"/>
</create>
...
<create creator="new" javascript="Tab">
  <param name="class" value="org.openxava.web.dwr.Tab"/>
</create> 
```

# c# - 重载和覆盖

> ID：673721
> 
> 赞同：113
> 
> 时间：2009-03-23T15:00:17.900
> 
> 标签：c#, inheritance

重载和覆盖有什么区别。

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2009-03-23T15:01:54.480

**重载**

重载是指在同一范围内有多个方法，名称相同但签名不同。

```
//Overloading
public class test
{
    public void getStuff(int id)
    {}
    public void getStuff(string name)
    {}
} 
```

**覆盖**

覆盖是允许您更改子类中方法的功能的原则。

```
//Overriding
public class test
{
        public virtual void getStuff(int id)
        {
            //Get stuff default location
        }
}

public class test2 : test
{
        public override void getStuff(int id)
        {
            //base.getStuff(id);
            //or - Get stuff new location
        }
} 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-02-27T06:36:14.907

Simple definitions for overloading and overriding

**Overloading** (Compile Time Polymorphism):: Functions with same name and different parameters

```
public class A
{
    public void print(int x, int y)
    {
        Console.WriteLine("Parent Method");
    }
}

public class B : A
{
    public void child()
    {
        Console.WriteLine("Child Method");
    }

    public void print(float x, float y)
    {
        Console.WriteLine("Overload child method");
    }
} 
```

**Overriding** (Run Time Polymorphism):: Functions in the extended class with same name and same parameters as in the base class, but with different behaviors.

```
public class A
{
    public virtual void print()
    {
        Console.WriteLine("Parent Method");
    }
}

public class B : A
{
    public void child()
    {
        Console.WriteLine("Child Method");
    }

    public override void print()
    {
        Console.WriteLine("Overriding child method");
    }
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-08-16T22:13:52.623

我想分享一个在我学习时对我很有意义的例子：

*这只是一个不包括虚方法或基类的示例。只是为了给出关于主要思想的提示。*

假设有一台洗车机，它有一个名为“Wash”的功能，并接受 Car 作为一种类型。

获取 Car 输入并清洗 Car。

```
public void Wash(Car anyCar){
       //wash the car
} 
```

让我们重载 Wash() 函数

**重载：**

```
public void Wash(Truck anyTruck){
   //wash the Truck  
} 
```

洗车功能以前只能洗车，现在也超载洗车了。

*   如果提供的输入对象是汽车，它将执行 Wash(Car anyCar)
*   如果提供的输入对象是卡车，那么它将执行 Wash(Truck anyTruck)

让我们重写 Wash() 函数

**覆盖：**

```
public override void Wash(Car anyCar){
   //check if the car has already cleaned
   if(anyCar.Clean){ 
       //wax the car
   }
   else{
       //wash the car
       //dry the car
       //wax the car
   }     
} 
```

清洗功能现在有一个条件来检查汽车是否已经干净并且不需要再次清洗。

*   如果汽车是干净的，那么只需打蜡即可。

*   如果不干净，那就先洗车，然后擦干，再打蜡

.

因此，通过添加新功能或做一些完全不同的事情来覆盖功能。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-23T15:07:04.763

*   重载 = 多个方法签名，相同的方法名称
*   覆盖 = 相同的方法签名（声明为虚拟），在子类中实现

精明的面试官会跟进：

[覆盖和阴影有什么区别？](https://stackoverflow.com/questions/392721/difference-between-shadowing-and-overriding-in-c)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-23T15:10:08.017

正如迈克尔所说：

*   重载 = 多个方法签名，相同的方法名称
*   覆盖 = 相同的方法签名（声明为虚拟），在子类中实现

和

*   Shadowing = 如果作为 DerivedClass 使用派生方法，如果作为 BaseClass 使用基本方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-08-28T10:56:11.443

拥有多个同名但参数不同的方法/构造函数称为重载。这是一个编译时事件。

```
Class Addition 
{
   int add(int a, int b) 
   {
     return a+b;
   }
   int add(int a, int b, int c)
   {
     return a+b+c;
   }

   public static main (String[] args) 
   {
     Addition addNum = new Addition();
     System.out.println(addNum.add(1,2));
     System.out.println(addNum.add(1,2,3));
   }
} 
```

开/关：

```
3
6 
```

覆盖是一个运行时事件，这意味着根据您的代码，输出在运行时会发生变化。

```
class Car
{
    public int topSpeed() 
    {
        return 200;
    }
}
class Ferrari extends Car
{
    public int topSpeed()
    {
        return 400;
    }
    public static void main(String args[])
    {
        Car car = new Ferrari();
        int num= car.topSpeed();
        System.out.println("Top speed for this car is: "+num);
    }
} 
```

请注意，两个类 topSpeed() 中有一个通用方法。由于我们实例化了一辆法拉利，我们得到了不同的结果。

开/关：

```
Top speed for this car is: 400 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-02-11T05:01:01.317

在 C# 中，没有 Java 之类的*隐藏*覆盖，覆盖方法上没有关键字**覆盖**！查看这些 C# 实现：

没有*覆盖*的变体 1 ：结果是 200

```
 class Car {
        public int topSpeed() {
            return 200;
        }
    }

    class Ferrari : Car {
        public int topSpeed(){
                return 400;
        }
    }

    static void Main(string[] args){
        Car car = new Ferrari();
        int num= car.topSpeed();
        Console.WriteLine("Top speed for this car is: "+num);
        Console.ReadLine();
    } 
```

*带有覆盖*关键字的变体 2 ：结果为 400

```
 class Car {
        public virtual int topSpeed() {
            return 200;
        }
    }

    class Ferrari : Car {
        public override int topSpeed(){
                return 400;
        }
    }

    static void Main(string[] args){
        Car car = new Ferrari();
        int num= car.topSpeed();
        Console.WriteLine("Top speed for this car is: "+num);
        Console.ReadLine();
    } 
```

Car 类上的关键字**virtual**与Java 上的**final相反，表示***不是 final*，如果 Car 是抽象的，您可以覆盖或实现

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-12-08T15:38:38.720

重载是一个概念，其中您具有相同的签名或具有相同名称但参数不同的方法和覆盖，我们具有不同参数的相同名称方法也具有继承称为覆盖。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-08-06T17:29:39.690

还有一点要补充。

**重载**多个具有相同名称的方法。相同或不同的返回类型。不同的参数或不同类型的参数。在同一类或派生类中。

int Add(int num1, int num2) int Add(int num1, int num2, int num3) double Add(int num1, int num2) double Add(double num1, double num2)

可以在同一个类或派生类中。一般喜欢同班。例如 Console.WriteLine() 有 19 个重载方法。

可以重载类的构造函数、方法。

可以认为是编译时（静态/早期绑定）多态性。

==================================================== ==================================================== =

**不能在同一个类中**覆盖。**可以覆盖类方法、属性、索引器、事件。**

 **有一些限制，例如重写的基方法必须是虚拟的、抽象的或重写的。您不能使用 new、static 或 virtual 修饰符来修改覆盖方法。

可以认为是运行时（动态/后期绑定）多态性。

有助于版本控制[http://msdn.microsoft.com/en-us/library/6fawty39.aspx](http://msdn.microsoft.com/en-us/library/6fawty39.aspx)

==================================================== ==================================================== =

**有用的网址**

[http://msdn.microsoft.com/en-us/library/ms173152.aspx](http://msdn.microsoft.com/en-us/library/ms173152.aspx) [编译时多态性与运行时多态性](https://stackoverflow.com/questions/2152848/compile-time-polymorphism-vs-run-time-polymorphism)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-02-17T07:10:19.893

shadowing = 在派生类中维护两个定义，为了投影基类定义，它隐藏（隐藏）派生类定义，反之亦然。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-04-11T00:23:21.080

**重载**是静态多态性的一部分，用于实现具有相同名称但不同签名的不同方法。**覆盖**用于完成不完整的方法。在我看来，这两个概念之间没有可比性，唯一相似的是两者都带有相同的词汇。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-06-24T16:34:49.360

方法重载和方法覆盖是两个完全不同的概念。方法重载具有相同的方法名称但具有不同的签名。方法覆盖是改变派生类中基类方法的默认实现。您可以在下面找到 2 个解释这些概念的优秀视频教程。

[方法覆盖与隐藏](http://csharp-video-tutorials.blogspot.com/2012/06/part-24-c-tutorial-difference-between.html)

[方法重载](http://csharp-video-tutorials.blogspot.com/2012/06/part-25-c-tutorial-method-overloading.html)

# c# - 正则表达式帮助示例模式。C＃

> ID：673722
> 
> 赞同：1
> 
> 时间：2009-03-23T15:00:22.580
> 
> 标签：c#, regex

我决定使用正则表达式，现在我有两个问题:)

给定输入字符串“hello world [2] [200] [%8] [%1c] [%d]”，

匹配 "[%8]" "[%1c]" + "[%d]" 实例的合适模式是什么？（所以是百分号，后跟任意长度的字母数字，全部括在方括号中）。

对于“[2]”和[200]，我已经使用

```
Regex.Matches(input, "(\\[)[0-9]*?\\]"); 
```

哪个工作正常。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T15:14:20.893

```
MatchCollection matches = null;
try {
    Regex regexObj = new Regex(@"\[[%\w]+\]");
    matches = regexObj.Matches(input);
    if (matches.Count > 0) {
        // Access individual matches using matches.Item[]
    } else {
        // Match attempt failed
    } 
} catch (ArgumentException ex) {
    // Syntax error in the regular expression
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T15:03:46.113

试试这个：

```
Regex.Matches(input, "\\[%[0-9a-f]+\\]"); 
```

或作为组合正则表达式：

```
Regex.Matches(input, "\\[(\\d+|%[0-9a-f]+)\\]"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T12:51:34.520

匹配字符串中的“[%anyLengthAlphaNumeric]”模式所需的正则表达式是“[(%\w+)]”

前导“[”用“\”转义，然后您将使用 (...) 创建一组字符。此分组定义为 %\w+。\w 是所有单词字符的快捷方式，包括字母和数字，没有空格。+ 匹配前一个符号、字符或组的一个或多个实例。然后尾随的“]”用“\”转义并抓住右括号。

这是一个基本的代码示例：

```
string input = @"hello world [2] [200] [%8] [%1c] [%d]";
Regex example = new Regex(@"\[(%\w+)\]");
MatchCollection matches = example.Matches(input); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T15:06:24.797

怎么样`@"\[%[0-9a-f]*?\]"`？

```
string input = "hello world [2] [200] [%8] [%1c] [%d]";
MatchCollection matches = Regex.Matches(input, @"\[%[0-9a-f]*?\]");
matches.Count // = 3 
```

# internationalization - Web 应用程序的特定消息目录技术

> ID：673724
> 
> 赞同：0
> 
> 时间：2009-03-23T15:00:49.897
> 
> 标签：internationalization

我有一个 Web 应用程序，它在三个地方都有用户可读的文本：CGI 程序的 C 源代码、.js 文件中的 JavaScript 和 .HTML 文件，我们正在考虑国际化。我曾经在一个用 C 和 Tcl 编写的基于 PC 的程序的 I18N 上工作。我们使用了可以从两种语言访问的通用[消息目录。](http://www.tcl.tk/man/tcl8.2.3/TclCmd/msgcat.htm)我完全不确定该技术将如何应用于 Web 应用程序。我在 StackOverflow 上看过几篇关于“I18N 的注意事项”的文章，但我的问题是关于在 Web 应用程序中存储和检索文本的特定技术。这通常是怎么做的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-14T07:31:09.540

主要的 Web 应用程序框架提供了简单的方法来为本地化文本提供公共资源文件。

因此，通常，Web 应用程序可能有一个指向资源的指针，而不是标记源中的文字文本。当用户请求页面时，处理引擎将用文字替换资源。

例如，ASP.NET 使用资源文件，Java 有 .properties 文件，每个文件都可以在运行时提供替换。

# jquery - 使用 PiL 截取 HTML/CSS

> ID：673725
> 
> 赞同：1
> 
> 时间：2009-03-23T15:00:51.393
> 
> 标签：jquery, python, css, xhtml, python-imaging-library

我想让网站上的用户上传图片，并在上面写一些文字。此外，他们应该能够裁剪/缩放/移动图像和文本。对于那些东西，我可以在 jQuery 中完成。

在他们按照他们想要的方式制作图像之后，有没有办法我可以截取该图像的屏幕截图（使用 PiL）并将其保存在服务器上？

最好/正确的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T15:59:10.880

对图片进行“截图”既不是最好的，也不是正确的做法。要截屏，您需要在客户端机器上执行代码，这在网站场景中是“不可能的”。

看看[lolcat builder](http://mine.icanhascheezburger.com/)（我现在想不出更严肃的例子；）。每次单击“预览”按钮时，图像 src 都会更新为包含文本、样式和位置的 url。该请求由服务器处理，该服务器将生成要显示的新图片。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T15:58:28.807

我假设你在服务器端有 Python。

imo 最好的方法是以某种方式从客户端“获取”所有编辑参数，然后使用 PIL 重新渲染它。

更新：我将如何做 在服务器端，您需要一个 url 来处理帖子。在客户端，（每次编辑后，）使用编辑参数向该 url 发送一个帖子。我认为没有一个简单的解决方案。

也许如果您不使用 PIL 渲染最终图像，而只记住参数，则来自客户端的每个视图都可以自己渲染？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:55:34.113

PIL 在客户端不可用.. 因此，除非正如 Jack Ha 建议的那样，您打算将图像编辑的所有指令上传到服务器并重新执行它们，否则它不是一个选项。我会回避这一点，因为您需要在客户端和服务器上实现相同的编辑例程，从而使代码库的大小增加一倍。（也许如果您的服务器端代码是用 Javascript 编写的，那将是有意义的，因此可以重用绘图代码。）

相反，请寻找一个 Javascript 库来完成客户端图像处理，并让浏览器上传最终的编辑图像。我不熟悉该区域的选项，但通过 Google 快速搜索[发现了这一点](http://www.pixastic.com/)，它使用 canvas 元素存储像素数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T17:08:06.253

好吧，即使其他人试图阻止您这样做，也可能不会那么难。

在客户端，您定义一个在图像上浮动/可调整大小的 div，具有透明度，可以针对裁剪进行缩放。

移动，我假设它仅适用于文本，因此您可以在客户端动态创建可拖动的跨度，仍然很容易。

规模，我不知道一个简单的用户界面来做到这一点。

当你想更新你的图像时，你序列化你的数据（你的裁剪 div 的位置和你的文本跨度/缩放的位置，相对于图像的位置。）然后，使用 json 或任何你想要的类似的东西，你转移数据到服务器。

然后，在服务器上，使用 python/PIL 重现已序列化的转换。

# c++ - 使用 boost::function 和 boost::bind 确定仿函数中的对象和方法

> ID：673731
> 
> 赞同：2
> 
> 时间：2009-03-23T15:02:56.210
> 
> 标签：c++, boost-bind

我想获得指向该对象的指针，以及该函子将从使用 boost::function 和 boost::bind 构造的函子中调用的方法的指示。这将允许我自动确定必须执行哪些函子的顺序。

以下（伪）代码（请参阅**POINTER_OF**和**METHOD_OF**）显示了我正在尝试做的事情：

```
class myClassA
{
  public:
    DoIt(int i) { return i+i; }
};

class myClassB
{
  public:
    DoItToo(double d) { return d*d; }
};

typedef boost::function0<int> Functor;

myClassA classA;
myClassB classB;

Functor funcA = boost::bind( &myClassA::DoIt, &classA, 10 );
Functor funcB = boost::bind( &myClassB::DoItToo, &classB, 12.34 );

// Create a vector containing some functors and try to determine the objects
// they are called upon and the methods they invoke
std::vector<Functor> vec;
vec.push_back( funcA );
vec.push_back( funcB );

for (int i = 0; i < vec.size();i++)
{
  if (POINTER_OF(vec[i]) == &classA)
  {
    // This functor acts on classA
    if (METHOD_OF(vec[i]) == &myClassA::DoIt)
    {
      // This functor calls the 'DoIt' method.
    }
    else if (METHOD_OF(vec[i]) == &myClassB::DoItToo)
    {
      // This functor calls the 'DoItToo' method.
    }
  }
  // etc...
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T15:12:30.227

我知道以下内容不是对您问题的严格回答，但是。

不要这样做。改用多态性。这是我在当前项目代码中看到的最奇怪的事情之一：如果函数指针指向“someFunction” - 做一些额外的操作。

您可以使用装饰器设计模式添加额外的行为，而无需过多地更改您的类。这将使用 Decorator::DoIt 扩展您的 myClassA::DoIt。

[http://en.wikipedia.org/wiki/Decorator_pattern](http://en.wikipedia.org/wiki/Decorator_pattern)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T19:29:21.607

不，我认为您无法获得设置为 boost 绑定（即 METHOD_OF）的 boost 函数的目标。根据boost 邮件列表上的[这篇文章](http://lists.boost.org/Archives/boost/2008/12/145709.php "这个帖子")，这是因为没有正式指定 bind 的返回类型。

编辑：链接到与此问题相关的较早问题：[demote-boostfunction-to-a-plain-function-pointer](https://stackoverflow.com/questions/282372/demote-boostfunction-to-a-plain-function-pointer)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:01:38.157

`boost::function`对象是平等可比的，所以你应该能够做类似的事情

```
if (vec[i] == boost::bind( &myClassA::DoIt, &classA, 10 ))
{
   // ... this Functor calls DoIt on classA with argument 10
} 
```

我怀疑您正在寻找更通用的东西。深入研究`boost/function_equal.hpp`(ie `boost::bind`'s `function_equal_impl`) 的实现细节可能会让您了解如何有选择地测试`boost::bind`参数的子集。

但我真的认为你最好使用基于多态的解决方案，或者只是用一些元数据聚合函数对象。

# asp.net - 我可以使用 HttpHandler 来伪造 aspx 页面的存在吗？

> ID：673736
> 
> 赞同：3
> 
> 时间：2009-03-23T15:04:14.880
> 
> 标签：asp.net

我正在使用 ASP.NET 3.5 构建一个网站，并且大多数网站结构都是静态的，足以创建文件夹结构和 aspx 页面。但是，站点管理员希望能够通过 Web 界面和使用所见即所得编辑器将新页面添加到站点的不同部分。我正在使用嵌套母版页为站点的不同部分提供自己的菜单。我想做的是在站点的每个部分下都有一个通用页面，该页面使用适当的母版页，并有一个可以从数据库加载的内容的占位符。我还希望这些“假”页面具有与任何其他 aspx 页面一样的 url，就好像它们在服务器上有相应的文件一样。所以不要让我的网址是：

```
http://mysite.com/subsection/gerenicconent.aspx?contentid=1234 
```

它会是这样的：

```
http://mysite.com/subsection/somethingmeaningful.aspx 
```

问题是somethingmeaningful.aspx 不存在，因为管理员是通过web UI 创建的，内容存储在数据库中。我在想的是，我将实现一个 HTTP 处理程序来处理对 aspx 文件的请求。在该处理程序中，我将检查所请求的 URL 是实际文件还是我的“假页面”之一。如果它是对虚假页面的请求，我会将请求重新路由到相应部分的通用内容页面，更改查询字符串以从数据库请求适当的数据，并重写 URL 使其看起来用户就好像假页面真的存在一样。我现在遇到的问题是我无法弄清楚如何将请求路由到 aspx 页面的默认处理程序。我试图实例化一个PageHandlerFactory，但构造函数在内部受到保护。有什么方法可以告诉我的 HttpHandler 调用通常用于处理请求的 HttpHandler 吗？我的处理程序代码当前如下所示：

```
using System.Web;
using System.Web.UI;

namespace HandlerTest
{
    public class FakePageHandler : IHttpHandler
    {
        public bool IsReusable
        {
            get { return false; }
        }

        public void ProcessRequest(HttpContext context)
        {
            if(RequestIsForFakedPage(context))
            {
                // reroute the request to the generic page and rewrite the URL
                PageHandlerFactory factory = new PageHandlerFactory(); // this won't compile because the constructor is protected internal
                factory.GetHandler(context, context.Request.RequestType, GetGenericContentPath(context), GetPhysicalApplicationPath(context)).ProcessRequest(context);
            }
            else
            {
                // route the request to the default handler for aspx pages
                PageHandlerFactory factory = new PageHandlerFactory();
                factory.GetHandler(context, context.Request.RequestType, context.Request.Path, context.Request.PhysicalPath).ProcessRequest(context);
            }
        }

        public string RequestForPageIsFaked(HttpContext context)
        {
            // TODO
        }

        public string GetGenericContentPath(HttpContext context)
        {
            // TODO
        }

        public string GetPhysicalApplicationPath(HttpContext context)
        {
            // TODO
        }
    }
} 
```

我还有一些工作要做，以确定请求是否是针对真实页面的，而且我还没有重写任何 URL，但是这样的事情可能吗？除了调用其构造函数之外，还有其他方法可以创建 PageHandlerFactory 吗？有什么方法可以将请求路由到 aspx 页面的“正常”HttpHandler 吗？我基本上是在说“像往常一样处理这个 ASPX 请求”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T15:18:27.623

如果您使用的是 3.5，请考虑使用 asp.net 路由。

[http://msdn.microsoft.com/en-us/library/cc668201.aspx](http://msdn.microsoft.com/en-us/library/cc668201.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T15:25:06.860

为此，您最好使用 http 模块，因为在这种情况下，您可以使用 RewritePath 方法来路由虚假页面的请求，而对实际页面不做任何事情，这将使它们能够正常处理。

这里有一个很好的解释[，](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)它还涵盖了使用 IIS 7.0 的好处（如果您愿意的话）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T15:18:17.733

我刚刚从我们刚刚编写的类似系统中提取了这个。

此方法处理物理页面和“假”页面。我敢肯定，您将能够确定这与您的虚假页面架构的匹配程度。

```
public class AspxHttpHandler : IHttpHandlerFactory
{
        #region ~ from IHttpHandlerFactory ~

        public IHttpHandler GetHandler(HttpContext context, string requestType, string url, string pathTranslated)
        {
                    string url=context.Request.Url.AbsolutePath;
            string[] portions = url.Split(new char[] { '/', '\\' });
                    // gives you the path, i presume this will help you identify the section and page
                    string serverSidePage=Path.Combine(context.Server.MapPath("~"),url);
                    if (File.Exists(serverSidePage))
                    {
                             // page is real
                            string virtualPath = context.Request.Url.AbsolutePath;
                string inputFile = context.Server.MapPath(virtualPath);

                try
                {
                                    // if it's real, send in the details to the ASPX compiler
                    return PageParser.GetCompiledPageInstance(virtualPath, inputFile, context);
                }
                catch (Exception ex)
                {
                        throw new ApplicationException("Failed to render physical page", ex);
                }
                      }
                      else
                      {
                            // page is fake
                            // need to identify a page that exists which you can use to compile against
                            // here, it is CMSTaregtPage - it can use a Master
                            string inputFile = context.Server.MapPath("~/CMSTargetPage.aspx");
                string virtualPath = "~/CMSTargetPage.aspx";
                            // you can also add things that the page can access vai the Context.Items collection
                            context.Items.Add("DataItem","123");
                            return PageParser.GetCompiledPageInstance(virtualPath, inputFile, context);
}

public void ReleaseHandler(IHttpHandler handler)
{

} 
```

# c# - 如何在 C# 中将 " 字符添加到多行字符串声明中？

> ID：673744
> 
> 赞同：60
> 
> 时间：2009-03-23T15:06:58.603
> 
> 标签：c#, string, escaping

如果我写这样的东西：

```
string s = @"...."......"; 
```

它不起作用。

* * *

如果我试试这个：

```
string s = @"...\"....."; 
```

它也不起作用。

如何在 C# 中的多行字符串声明中添加 " 字符？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-03-23T15:08:38.457

试试这个：

```
string s = @"...""....."; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-23T15:31:42.380

双字符用法也适用于字符`{`，并且`}`当您使用`string.Format`并且想要包含其中任一的文字实例而不是指示参数参数时，例如：

```
string jsString = string.Format(
    "var jsonUrls = {{firstUrl: '{0}', secondUrl: '{1}'}};",
    firstUrl,
    secondUrl
    ); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-23T15:39:34.280

字符串`s = "...\".....";` 应该工作

@ 禁用转义，所以如果你想使用 \" 那么没有 @ 符号

我个人认为你应该去

```
string s = string.format("{0}\"{1},"something","something else"); 
```

从长远来看，它更容易

# c++ - 逻辑设计模式

> ID：673751
> 
> 赞同：0
> 
> 时间：2009-03-23T15:09:32.090
> 
> 标签：c++, design-patterns, logic

在游戏中，每帧都应该更新许多实体。我玩弄不同的设计模式来实现这一点。到目前为止，我有一个单例管理器类，每个 Logic 实例都添加到其中。但我正在考虑以下内容，即 Logic 类本身中的静态列表。这很好，因为它会从项目中删除一个类。本例中的“Engine”是调用 update_all 的主类。

```
class Logic
{
public:
    Logic() { all.push_back(this); }
    virtual ~Logic() { all.erase(this); }
    virtual void update(float deltatime) = 0;

private:
    friend Engine;
    static std::list<Logic*> all;
    static void update_all(float deltatime)
    {
        for (std::list::iterator i = all.begin(); i!=all.end(); ++i)
            (*i)->update(deltatime);
    }
}; 
```

*   这种模式有名字吗？
*   您认为这比单例管理器类更好吗？
*   还有其他意见或警告吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T15:28:13.560

您也可以为此使用[观察者模式](http://www.dofactory.com/Patterns/PatternObserver.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T15:41:46.553

首先，您需要使用`remove()`而不是`erase()`（后者需要一个迭代器作为参数）

如果您使用稍微不同的循环，例如

```
std::list<Logic*>::iterator it = all.begin();
while (it != all.end()) {
  Logic* current = *it;
  ++it;
  current->update(deltatime);
} 
```

您甚至可以克服*siukurnin*提到的问题（在 update() 期间删除逻辑对象）。`list::remove()`除了指向已移除元素的迭代器之外，不会使迭代器无效。

除此之外，我还投票赞成这是单例模式的一种变体。而且我建议将原始解决方案保留为单独的管理类，以防万一您希望拥有两个具有不同增量时间的循环或显式多线程支持（不同线程上的不同逻辑对象）或将来的任何内容。

在我看来，这是单例类相对于静态方法（您始终可以使用）的一般优势：如果您将来想这样做，您可以轻松地增加您的功能......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T15:15:24.073

我认为它仍然是一个单例：“只能有一个”

单例是一种模式，一种概念：你可以用不同的方式实现它......

静态类成员或全局实例是同一想法的两种可能实现。

问题是：你为什么要改变它？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T15:42:25.040

恕我直言，这是一种观察者模式（参见`update`对每个订阅者的调用），其中主题恰好是单例。

在更新观察者时注销的“警告”是一个困难的问题。我发现自己很多次都在为此苦苦挣扎。

这个问题的一个优雅的解决方案在我关于它的问题的[答案](https://stackoverflow.com/questions/82074/design-pattern-for-multithreaded-observers/102984#102984)中暗示：对于每个观察者，添加一个包含指向“真实”观察者的指针的中间“代理”。取消注册就相当于（原子地）交换代理的指针。更新后，可以安全地删除所有具有空指针的代理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-05T21:44:21.993

通常，您希望在每次更新调用时遍历游戏中的每个实体，因此您可以继续使用[复合模式](http://en.wikipedia.org/wiki/Composite_pattern)，其中您将拥有一个根节点。从此，您将递归地遍历节点并调用每个实体的 update() 方法。从我从您的代码中可以看出，您已经有了一个列表，但是使用复合模式，您可以改为创建实体组，这可能会简化您的任务。

据我了解，您的引擎只需要调用根节点的 Update() 方法（如果您使用复合模式）。从那以后，根节点将使用它们的 update() 调用后续节点。在通过复合树的某个时刻，您将接触到知道如何正确更新自己的叶子。

你只需要在你的引擎中有一个指向你的根节点的指针，它将有一个函数 UpdateAll() （或其他东西），然后调用 rootNode->Update(); 反过来，它将执行我在上一段中描述的操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T15:13:10.990

需要注意的是，这种模式（当前）不允许在调用 update_all 期间删除逻辑实例，因为它会使迭代器指针无效。

一个解决方案可能是使析构函数私有并让更新返回一个标志，说明是否应该删除实例？

# moss - 在 MOSS 文档库中使用 send-to

> ID：673763
> 
> 赞同：0
> 
> 时间：2009-03-23T15:11:57.093
> 
> 标签：moss, document, sendto

我想使用 MOSS 文档库中的发送到选项将文件移动到同一文档库中的文件夹。如果我选择文件夹的 url，然后尝试发送到选项，它会告诉我文件夹名称太长。

一切顺利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T20:20:00.720

生成的新文件 URL 不能超过 260 个字符。

# sql - 如何在有限的、任意排序的记录集中找到单个记录的*位置*？

> ID：673768
> 
> 赞同：5
> 
> 时间：2009-03-23T15:12:45.733
> 
> 标签：sql, mysql

*MySQL*

假设您只想通过某个 id 检索单个记录，但您想知道如果您在一个大的有序集中遇到它，它的位置会是什么。

一个典型的例子是照片库。你登陆一张照片，但系统必须知道它在整个画廊中的偏移量是多少。

我想我可以使用自定义索引字段来跟踪位置，但是仅在 SQL 中必须有一种更优雅的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:17:42.740

因此，首先您创建一个虚拟表，其位置 # 按您的 ORDER BY 排序，然后从该集合中选择最高的一个。那是更大的结果集中的位置。如果您不按唯一值/值集排序，您可能会遇到问题......

如果您在 (photo_gallery_id, date_created_on) 上创建索引，它可能会进行索引扫描（取决于照片的分布），这应该比表扫描更快（前提是您的 gallery_id 不是照片的 90% 或诸如此类） .

```
SELECT @row := 0; 
SELECT MAX( position ) 
  FROM ( SELECT @row := @row + 1 AS position
           FROM photos
          WHERE photo_gallery_id = 43
            AND date_created_on <= 'the-date-time-your-photo-was' 
          ORDER BY date_created_on ) positions; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T15:17:07.017

并不真地。我认为甲骨文给你一个“ROWID”或类似的东西，但大多数人都不给你。自定义排序，例如数据库中的一列，告诉您希望将条目放在图库中，这是很好的，因为您永远无法确定 SQL 是否会按照您认为它们应该在的顺序将内容放入表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T15:19:11.227

由于您不具体说明您使用的是什么数据库，因此在 SQL Server 2005 中您可以使用

```
SELECT 
  ROW_NUMBER() OVER (ORDER BY PhotoID)
  , PhotoID
FROM dbo.Photos 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T15:19:24.703

您没有说您使用的是什么 DBMS，“解决方案”会相应地有所不同。在 Oracle 中，您**可以**这样做（但我敦促您不要这样做！）：

```
select photo, offset
from
( select photo
  ,      row_number() over (partition by gallery_id, order by photo_seq) as offset
  from   photos
)
where  id = 123 
```

该查询将选择**所有**照片（全表扫描），然后挑选出您要求的照片 - 不是性能查询！

我建议如果您*真的需要*此信息，则应将其存储。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T15:22:52.793

假设位置完全由 id 决定，那不就是统计所有 id 值较小的记录那么简单吗？：

```
select
    po.[id]
    ...
    ((select count(pi.[id]) from photos pi where pi.[id] < po.[id]) + 1) as index
    ...
from photos po
... 
```

我不确定这种查询的性能影响是什么，但我认为返回大量记录可能是一个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T16:10:04.007

您必须了解“应用程序密钥”和“技术密钥”之间的区别。

存在技术密钥的唯一目的是使项目独一无二。它通常在 INTEGER 或 BIGINT 中，生成（身份等）。该键用于定位数据库中的对象，快速找出已经持久化的对象（ID 必须 > 0，因此默认 ID == 0 的对象尚未在数据库中）等。

应用程序密钥是您需要在应用程序上下文中理解对象的东西。在这种情况下，它是图库中照片的排序。这对数据库没有任何意义。

考虑有序列表：这是大多数语言的默认设置。您有一组项目，由索引访问。对于数据库，此索引是应用程序键，因为数据库中的集合是无序的（或者数据库不保证任何排序，除非您指定 ORDER BY）。出于同样的原因，对查询结果进行分页非常痛苦：数据库真的不喜欢“位置”的概念。

因此，您必须做的是添加一个索引行（即一个 INTEGER，它表示您的图像在图库中的哪个位置；不是用于更快访问的数据库索引，即使您应该在此列上创建一个索引......）并维护那。对于每次插入，您必须 `UPDATE index = index + 1 where index >= insertion_point`，等等。

是的，这很糟糕。我知道的唯一解决方案：使用 ORM 框架为您解决这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-27T12:50:59.693

不需要额外的表，为什么不只计算记录呢？

您知道它们的显示顺序（可能会有所不同），但您知道这一点。

你也知道当前记录的ID；假设它是在日期订购的：

记录的偏移量是日期<该日期的记录总数。

```
SELECT COUNT(1) FROM ... WHERE date < "the-date" 
```

这为您提供了可以用作其他查询的偏移量的数字...

# sql-server-2005 - asp.net 会员供应商受到威胁？

> ID：673772
> 
> 赞同：1
> 
> 时间：2009-03-23T15:13:37.057
> 
> 标签：sql-server-2005, asp.net-membership, membership-provider, provider

我使用的是开箱即​​用的标准 aspnet 会员提供程序，并且我在 web.config 中有以下设置：

```
<anonymousIdentification enabled="false"/>
<authentication mode="Forms">
    <forms cookieless="AutoDetect" loginUrl="~/XXXX.aspx" name="XXXXAuth" slidingExpiration="true" timeout="432000"/>
</authentication>
...
<membership defaultProvider="XXXMembershipProvider">
    <providers>
        <add name="XXXMembershipProvider" type="System.Web.Security.SqlMembershipProvider" applicationName="XXX" connectionStringName="XXX" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="true" minRequiredPasswordLength="5" minRequiredNonalphanumericCharacters="0" passwordFormat="Hashed" maxInvalidPasswordAttempts="5" passwordAttemptWindow="10" passwordStrengthRegularExpression=""/>
    </providers>
</membership> 
```

今天我遇到了一个问题，用户报告说他们去登录并注意到该网站说他们已经登录......作为一个完全不同的用户。在联系了这两个用户后，事实证明两者都没有从共享计算机访问该站点。两个账户的数据都没有在数据库中显示出任何被“黑客入侵”的迹象。

它托管在负载均衡器后面的两个 Web 服务器上。数据库架构是一台用于读取的服务器，一台用于写入的服务器，通过复制使它们保持同步。

有谁知道可能是什么导致了这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T18:50:25.870

我想知道负载均衡器有多聪明，以及它是否也在缓存页面。

会员 cookie 被该死的锁定了，所以非常怀疑它是否已被泄露。如果负载均衡器也在缓存它很可能不会传递请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T15:56:06.050

可以实现这一点的一个选项是 cookieless=AutoDetect。如果某个用户的浏览器不支持 cookie，asp.net 将在 url 中嵌入加密的身份验证票证。如果用户碰巧与其他人分享了链接，或者不太直接地在论坛上发布了链接，那么他（她）正在无意中访问他（她）的帐户。

# zend-framework - 如何使用 .htaccess 强制 www。在使用 Zend 框架时

> ID：673778
> 
> 赞同：3
> 
> 时间：2009-03-23T15:16:13.730
> 
> 标签：zend-framework, .htaccess, redirect, http-status-code-301

我想强制一个www。通过使用 .htaccess 301 重定向在我的网站上添加前缀。我目前正在尝试：

```
RewriteCond %{HTTP_HOST} ^mysite.com [NC]
RewriteRule ^(.*)$ http://www.mysite.com/$1 [L,R=301] 
```

这通常可以工作，但我使用的是 Zend Framework，它会导致所有请求都被重定向回[http://www.mysite.com/index.php](http://www.mysite.com/index.php)，而不管初始请求如何。

例如...

```
http://mysite.com/blog, 
http://mysite.com/contact,
http://mysite.com/blog/this-is-my-article, 
```

将全部重定向到[http://www.mysite.com/index.php](http://www.mysite.com/index.php)

但是，如果我最初请求特定文件，例如...

```
http://mysite.com/some-file.htm 
```

重定向工作正常，重定向到[http://www.mysite.com/some-file.htm](http://www.mysite.com/some-file.htm)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T00:43:39.120

第一次，不要忘记启用重写（“RewriteEngine on”）。如果您使用 Zend Framework，最后一行很重要。

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^mysite.com [NC]
RewriteRule ^(.*)$ http://www.mysite.com/$1 [L,R=301]
RewriteRule !\.(pdf|php|js|ico|txt|gif|jpg|png|css|rss|zip|tar\.gz)$ index.php 
```

现在网址...

```
http://mysite.com/some-file.htm 
```

...重定向到[http://www.mysite.com/some-file.htm](http://www.mysite.com/some-file.htm)但使用 index.php

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-16T19:25:18.407

重定向到 www 时不要忘记忽略子域。

[http://www.theblogaholic.com/2011/01/16/force-www-using-htaccess-except-for-subdomains/](http://www.theblogaholic.com/2011/01/16/force-www-using-htaccess-except-for-subdomains/)

# c# - 什么是阴影？

> ID：673779
> 
> 赞同：35
> 
> 时间：2009-03-23T15:16:17.567
> 
> 标签：c#, polymorphism, shadowing

在 C# 中，术语*阴影*是什么意思？我已阅读[此链接](https://stackoverflow.com/questions/392721/difference-between-shadowing-and-overriding-in-c)，但没有完全理解。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-23T15:25:05.360

阴影隐藏了基类中的方法。使用您链接的问题中的示例：

```
class A 
{
   public int Foo(){ return 5;}
   public virtual int Bar(){return 5;}
}
class B : A
{
   public new int Foo() { return 1;}
   public override int Bar() {return 1;}
} 
```

类`B` *覆盖*了虚方法`Bar`。它*隐藏*（阴影）非虚拟方法`Foo`。覆盖使用**override**关键字。阴影是使用**new**关键字完成的。

在上面的代码中，如果你在定义类中的方法时没有使用**new**关键字，你会得到这个编译器警告：`Foo``B`

```
'test.B.Foo()' hides inherited member 'test.A.Foo()'. Use the new keyword if hiding was intended. 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-23T15:19:22.800

*   覆盖：在基类上重新定义现有方法
*   Shadowing：创建一个全新的方法，其签名与基类中的方法相同

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-23T15:24:00.963

假设我有一个实现虚方法的基类：

```
public class A
{
    public virtual void M() { Console.WriteLine("In A.M()."); }
} 
```

我还有一个派生类，它也定义了一个方法 M：

```
public class B : A
{
    // could be either "new" or "override", "new" is default
    public void M() { Console.WriteLine("In B.M()."); }
} 
```

现在，假设我写了一个这样的程序：

```
A alpha = new B(); // it's really a B but I cast it to an A
alpha.M(); 
```

对于我希望如何实现它，我有两种不同的选择。`new`默认行为是调用 A 的 M 版本。（这与将 " " 关键字应用于 时的行为相同`B.M()`。）

当我们有一个名称相同但从基类调用时行为不同的方法时，这称为“阴影”。

或者，我们可以指定 " `override`" on `B.M()`。在这种情况下，`alpha.M()`会调用 B 的 M 版本。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-23T15:39:00.303

阴影包括在子类中隐藏具有新定义的基类方法。

隐藏和覆盖之间的区别与调用方法的方式有关。

这样，当一个虚方法被覆盖时，基类的方法调用表的调用地址被替换为子例程的地址。

另一方面，当一个方法被隐藏时，一个新的地址被添加到子类的方法调用表中。

当调用相关方法时：

1.  获取方法调用表类类型，如果引用基类调用则获取基类方法表，如果有子类引用则获取子类方法表。
2.  在表中搜索该方法，如果找到则进行调用，否则搜索基类方法表。

如果我们通过引用子类来调用方法，那么行为是相同的，如果方法被覆盖，方法地址将在基类中找到，如果方法被隐藏，方法地址将在基类中找到子类，由于已经找到，所以不会搜索基类表。

如果我们使用对基类的引用来调用该方法，那么行为就会改变。重写时，由于方法地址覆盖了基类条目，我们将调用子方法，即使持有对基类的引用也是如此。使用阴影，基类方法表（这是唯一可见的，因为我们持有对基类的引用）包含虚拟方法地址，因此将调用基类方法。

一般来说，阴影是一个坏主意，因为它会根据我们对它的引用而对实例的行为产生差异。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-23T15:55:52.247

扩展肯特的正确答案

在消除何时调用哪个方法的歧义时，我喜欢考虑使用以下内容进行遮蔽与覆盖

*   Shadowing：调用的方法取决于调用点的引用类型
*   覆盖：调用的方法取决于调用时对象的类型。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T15:23:43.070

这是有关阴影的[MSDN 文章。](http://msdn.microsoft.com/en-us/library/c4swkw24.aspx)语言示例在 Visual Basic 中（不幸的是，MSDN 上没有等效的 C# 页面），但它通常处理这些概念，希望无论如何都能帮助您理解。

**编辑：**似乎有*一篇*关于阴影的[C# 文章](http://msdn.microsoft.com/en-us/library/aa691135(VS.71).aspx)，只是它被称为*隐藏*在 C# 中。此外，[此页面](http://www.akadia.com/services/dotnet_polymorphism.html)提供了一个很好的概述。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-11T06:49:39.573

如果要隐藏基类方法，请在基类中使用覆盖[基类中的虚拟方法]

如果要隐藏子类方法，请在基础中使用 new [基础中的非虚拟方法]->shadow

```
Base B=new Child() 
```

`B.VirtualMethod()`-> 调用子类方法

`B.NonVirtualMethod()`-> 调用基类方法

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-13T01:09:36.767

**覆盖**：相同的名称和完全相同的参数，在子类中实现不同。

*   如果被视为 DerivedClass 或 BaseClass，它使用派生方法。

**Shadowing** : 相同的名称和完全相同的参数，在子类中实现不同。

*   如果被视为 DerivedClass，它使用派生方法。
*   如果被视为 BaseClass，它使用基本方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-06-14T10:52:55.773

希望这个简短的解释有所帮助。

**`Shadowing`**- 替换父类的完整元素

```
class InventoryAndSales
{
    public int InvoiceNumber { get; set; }
}

//if someone calls for this class then the InvoiceNumber type is now object 
class NewInventoryAndSales : InventoryAndSales
{
    public new object InvoiceNumber { get; set; }
} 
```

**`Overriding`**- 仅替换实现。它不会替换它不会替换的数据类型，例如您有一个变量，它不会将其转换为方法，因此如果有方法，它将使用该方法并且只更改实现

```
 class InventoryAndSales
    {
        public virtual int GetTotalSales(int a, int b)
        {
            return a + b;
        }
    }

    class NewInventoryAndSales : InventoryAndSales
    {
        //it replaces the implementation in parent class
        public override int GetTotalSales(int a, int b)
        {
            return a * b;
        }
    } 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-03-23T15:33:19.897

阴影不是我担心理解或实施的事情，除非它非常“适合”问题。我已经看到它使用不当并且比正确使用更频繁地导致奇怪的逻辑错误。我认为，最大的原因是当程序员忘记将覆盖放在方法签名中时，编译器警告会建议使用 new 关键字。我一直觉得它应该推荐使用覆盖。

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2012-01-11T12:56:20.927

```
 private static int x = 10;

static void Main(string[] args)
    { int x = 20;
        if (Program.x == 10)
        {
            Console.WriteLine(Program.x);
        }
        Console.WriteLine(x);} 
```

输出：

10 20

# c - 为什么从 TCP 套接字读取整数数组时会得到奇怪的结果？

> ID：673799
> 
> 赞同：2
> 
> 时间：2009-03-23T15:20:12.657
> 
> 标签：c, sockets, tcp

正如我在上一个问题的回答中所建议的那样（[如何在 C 中通过 TCP 发送一个整数数组？](https://stackoverflow.com/questions/672241/how-do-i-send-an-array-of-integers-over-tcp-in-c)），我尝试发送一个 long int 数组，但是我可能正在做一些事情来破坏解决方案......

```
#define ARRAY_LEN 4

/* I'm using long because the numbers are very large,
 * but in this example they're small to save space. */
long originalArray[ARRAY_LEN] = { 1, 2, 3, 4 };

myObject.SetMyArray(originalArray);

// NOTE: The following is in a different function.

long *myArrayFromFunction = myObject.GetMyArray();

write(clientSocketFD, myArrayFromFunction, sizeof(myArrayFromFunction) * ARRAY_LEN); 
```

转换为指针然后传递不正确吗？

在客户端阅读时，我收到的不是我发送的数字（1、2、3、4），而是长数字，例如 140088443806649...

```
#define ARRAY_LEN 4

long targetArray[ARRAY_LEN];
read(socketFD, targetArray, sizeof(targetArray) * ARRAY_LEN); 
```

所以，假设我需要读入一个指针，我试过这个......

```
#define ARRAY_LEN 4

long *targetArray;
read(socketFD, targetArray, sizeof(targetArray) * ARRAY_LEN); 
```

但这也不起作用（读取函数返回-1）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T15:24:34.177

额外的指针是不必要的。数组（基本上是一个指针）可以直接传递。您错误地使用了指针的大小而不是数据类型的大小（长）；使用`sizeof (long) * ARRAY_LEN`或只是`sizeof (originalArray)`代替。

写：

```
#define ARRAY_LEN 4
long originalArray[ARRAY_LEN] = { 1, 2, 3, 4 };
write(clientSocketFD, originalArray, sizeof (originalArray)); 
```

读：

```
#define ARRAY_LEN 4
long targetArray[ARRAY_LEN];
read(socketFD, targetArray, sizeof (targetArray)); 
```

如果您将数组作为指针传递，则`sizeof`不能用于获取数组的总大小。在这种情况下，大小必须与指针一起传递，并且使用构造的大小`sizeof (long) * ARRAY_LEN`。

小心使用 long 这样的类型，因为它在不同平台上的大小并不总是相同（即 32 位与 64 位）；[更喜欢像int32_t](http://linux.die.net/include/stdint.h)这样的大小类型。此外，您也可能遇到[字节序](http://en.wikipedia.org/wiki/Endianness)问题。考虑在写入之前使用[htonl](http://opengroup.org/onlinepubs/007908775/xns/htonl.html)对值进行字节交换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T15:35:35.773

我还想指出，在某些情况下，存储在内存中的数据和通过网络发送的数据的不同字节序可能是问题的原因，因此如果您在低级别工作，请务必检查这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T20:25:20.600

如果您正在编写自己的 TCPStream 或其他东西，您可能想查看[http://smartwinlib.org中的 SmartNetwork 代码...](http://smartwinlib.org)

它包含从 TCP 一直到 HTTP 甚至 SOAP 的所有流包装器，并且代码*非常*小，尽管模板化程度很高......

# hibernate - 如何使用 Hibernate 将初始数据导入数据库？

> ID：673802
> 
> 赞同：70
> 
> 时间：2009-03-23T15:20:56.447
> 
> 标签：hibernate, import, initialization, data-importer

在部署应用程序时，我经常使用 Hibernate 的能力来创建数据库模式，以简化部署。这很容易通过配置 hibernate.hbm2ddl.auto 属性来实现。

但是，有时我还需要向数据库中插入一些初始数据，例如 root 用户。有没有办法通过休眠和某种加载文本文件来实现这一点？

我知道我可以很容易地编写代码来实现这一点，但只是想知道是否已经有一些实用程序可以帮助我通过配置实现相同的目标？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-03-23T23:42:17.617

我通过搜索“休眠装置”找到了这个：

> Hibernate 会在创建实体管理器工厂时创建数据库（实际上是在实体管理器工厂创建 Hibernate 的 SessionFactory 时）。如果类路径（'/import.sql'）的根目录中存在一个名为 import.sql 的文件，Hibernate 将在创建数据库模式后执行从该文件中读取的 SQL 语句。重要的是要记住，在 Hibernate 创建模式之前，它会清空它（删除所有表、约束或将在构建模式的过程中创建的任何其他数据库对象）。

资料来源：[http ://www.velocityreviews.com/forums/t667849-hibernate-quotfixturesquot-or-database-population.html](http://www.velocityreviews.com/forums/t667849-hibernate-quotfixturesquot-or-database-population.html)

试一试，让我们知道它是否有效！

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-05-29T21:48:05.420

将 import.sql 添加到类路径效果很好，hbm2ddl 检查文件是否存在并执行它。唯一的额外细节是每个sql命令必须在自己的行中，否则将无法执行。

这也仅在`hbm2ddl.auto`设置为`create`or时才有效`create-drop`。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2013-07-08T13:19:03.053

在您的休眠配置中添加休眠属性[**hibernate.hbm2ddl.import_files 。**](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#configuration-misc-properties)更改 hibernate.hbm2ddl.auto 属性以创建。在 /classes 目录中添加 initial_data.sql 并使用初始 sql 代码插入数据。Hibernate 在创建数据库模式后执行此操作。

```
<bean id="sessionFactory"
    class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">${hibernate.dialect}</prop>
            <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
            <prop key="hibernate.hbm2ddl.auto">create</prop>
            <prop key="hibernate.hbm2ddl.import_files">initial_data.sql</prop>
        </props>
    </property>
</bean> 
```

如果您不想在 hibernate 配置中添加属性，您可以在 /classes 目录中创建一个文件 import.sql，如果属性 hibernate.hbm2ddl.auto 等于 create，hibernate 默认使用此文件

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2014-03-22T01:55:13.357

## 为什么`hbm2ddl.auto`和`hbm2ddl.import_files`属性是*邪恶的*

### （当被误用作数据库变更管理工具时）

就像[其他地方](https://stackoverflow.com/questions/19559068/jpa-hibernate-create-database-schema-and-import-data-on-first-run-update-schem/22571976#22571976 "spring - JPA/Hibernate：在第一次运行时创建数据库模式并导入数据，在后续运行时更新模式 - 代码日志")说的那样，使用`hibernate.hbm2ddl.auto`and`hibernate.hbm2ddl.import_files`进行数据库变更管理有一些*严重的*缺点：

1.  只有结构可以改变。现有值可能会被覆盖，或者 - 在最坏的情况下 - 只是发送到 Nirvana。如果没有像[liquibase](http://www.liquibase.org "Liquibase 主页")或[scriptella](http://scriptella.javaforge.com)这样的工具，您就没有任何[ETL](http://en.wikipedia.org/wiki/Extract,_transform,_load "维基百科上关于提取、转换和加载的文章")功能。
2.  此方法没有事务。结构和数据语句都将在事务管理器接管之前执行。假设您在 256 的第 42 条语句中有错误。您的数据库现在处于不一致的状态。
3.  恕我直言，您失去了透明度和控制权：在脚本或 liquibase 更改设置或通常与域模型中的更改一起提交的情况下，您在域模型中进行更改并希望（基本上）hibernate 会找出要做什么。（它没有，但这是一个不同的故事。）
4.  对于集成、系统和验收测试，您只需*假设*您的测试数据库与生产数据库处于*绝对、完全相同的状态*。你必须手动跟踪它（祝你好运，玩得开心！;)）。万一你犯了一个错误，一个小小的失误就足够了，结果可能我们将是灾难性的。

我个人使用 liquibase 进行数据库变更管理，并开发了以下工作流程来减少维护工作：

*   从我上次发布结构[的命令行创建一个变更日志](http://www.liquibase.org/documentation/generating_changelogs.html "liquibase.org 上的“生成变更日志”")
*   创建我最新数据库的更新日志
*   **手动**比较两个更改日志（通常更改不是那么大，如果是，它们通常会遇到[liquibases diff](http://www.liquibase.org/documentation/diff.html "liquibase.org 上的“数据库差异”")命令的缺点之一。
*   创建变更集

即使对于必须实现[customChange](http://www.liquibase.org/documentation/changes/custom_change.html "liquibase.org 上的 customChange")的复杂更改，这也可以在几个小时内完成，包括回滚的定义、测试和文档。对于微不足道的更改，只需几分钟。基本上：您必须做更多的工作（我在不到一天的时间内为 4 个数据库配置创建了自定义更改集），但您可以放心，您已尽一切可能使数据库保持一致状态。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-09-03T18:40:50.240

经过几个小时的磕磕绊绊，我决定分享我的发现，尽管这是一个非常古老的帖子。

为了使其正常工作，我必须执行以下操作：

*   `hbmddl`设置为`create`或`create-drop`
*   类路径根目录中的 file.sql；就我而言，我只是把它放在`resources`文件夹中，我使用的是 maven。
*   一行中的每个 sql 命令
*   **每个 file.sql 必须在文件开头有一个空行**==> 不知道这个的原因，但是如果我不插入那个空行，在执行时服务器告诉我有一个第一个字符附近的语法错误。

希望有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-31T16:24:05.913

在 JPA 中执行此操作的标准方法是使用配置属性`javax.persistence.sql-load-script-source`。

`AvailableSettings`您可以探索与 Hibernate类中列出的模式导出和测试数据导入相关的各种设置。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-09-21T09:51:32.633

请确保您的 import.sql 格式正确。从一个单行插入语句开始进行测试。

# .net - DataTable.Select Expression 使用 IN 和 Like

> ID：673803
> 
> 赞同：1
> 
> 时间：2009-03-23T15:21:00.567
> 
> 标签：.net, sql, winforms, datatable

问候，

我有两个关于 DataTable.Select() 的问题：

1）如何逃避潜在的撇号或任何其他会导致问题的字符。我不担心 SQL 注入。2) 如何将 IN 与 Like 一起使用，并包含具有 null 的结果。

1）不幸的是，我似乎无法为第一个选项找到任何建议，因为每个人都说使用参数化（是一个词）查询，我很确定你不能用 Datatable.select 做。情况就是这样，我不知道这些值会提前是什么，因为列表是从文本框中检索的。('US' , 'Engineering' , 'Lumburg's') 我知道我可以在将字符串传递给 select 之前解析字符串，但我敢肯定有一些内置的 ANSI 可以做到这一点，恐怕我没有知道。我知道如果我知道字符的位置，连续两个撇号会避开该字符，但我在收到它时不知道确切的位置。

2）好的。现在是实际的选择表达式。我要做的是允许用户在文本字段中自由输入表单。此文本字段将使用 4 个不同的列进行过滤。因此，用户可以输入几个以空格分隔的项目，然后根据他们的标准执行查询。（比如 iTunes 搜索框，它允许您输入自由格式的专辑歌曲等，或者您可以是特定的并且只搜索一种类型的项目）

我知道如何自己做 IN 或 Like，但我不确定如何将它们放在一起（包括转义撇号并包括匹配但在其中一列中可能有 null 的结果）当然做一些事情.Select 方法支持。

WHERE (Country IN ('US' , 'Engineering' , 'Lumburg's')) WHERE (Country LIKE 'LU%')

因此，上述案例中的用户提供了 LU，它应该返回 Lumburg 的记录。他们提供的信息越多，将进一步完善结果。有任何想法吗？

以下是有关我的应用程序的技术规格：

Winforms VB.NET .Net 2.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:02:01.497

您最终会希望得到一个如下所示的查询：

Country = 'US' OR Country = 'Engineering' OR Country = 'Lumburg''s' OR Country LIKE 'LU%'

```
terms = //split apart their search entry
foreach (string searchTerm in terms)
{
  // I don't know how you're telling the difference between terms you want an exact
  // match for, and which use like, but do something like this

  if (exactMatchNeeded)
  {
    query += " OR Country = '" + searchTerm.Replace("'", "''") + "' ";
  }
  else
  {
    query += " OR Country LIKE '" + searchTerm.Replace("'", "''") + "' ";
  }
} 
```

当然，您需要整理一下以确保某些事情，例如防止在开始时出现额外的“或”，但这应该可以帮助您入门。

# sql - 根据主数据表中的值动态创建新的查找表

> ID：673805
> 
> 赞同：1
> 
> 时间：2009-03-23T15:21:24.560
> 
> 标签：sql, dynamic, schema, lookup

我正在开发一个应用程序，它接受任何上传的 CSV 数据，将其与之前上传的其他数据集一起存储，然后根据用户选择他们想要返回的列/值生成输出（CSV 或 HTML）。数据库将根据需要自动扩展以处理新的/不同的列和数据类型。这优先于实体属性值模型。

示例 - 将这 2 个集合上传到空白数据库：

数据集 A：

```
name  | dept  | age   
------+-------+------
Bob   | Sales | 24
Tim   | IT    | 32 
```

数据集 B：

```
name  | dept  | age  | salary
------+-------+------+--------
Bob   | Sales | 24   | £20,000
Tim   | IT    | 32   | £20,000 
```

将以编程方式更改“数据”表，以便导入数据集 A 导致 3 个新创建的列（名称、部门、年龄）。导入数据集 B 会产生 1 个新创建的列（工资）。目前，忘记记录集是否应该合并以及没有标准化。

我遇到的问题是某些列也将具有查找值 - 假设 Dept 列将在将来的某个时候具有关联值，这些值给出该部门的地址和电话号码。对于 Salary 列、查找税组等也是如此。

这个大表中的列数不应该变得太高（几百），但应该足够多，以便用户通过管理面板管理查找表结构和值，而不是每次都需要开发人员参与。

**问题**是是为每列（值、描述）使用单独的查找表，还是使用引用列（列、值、描述）的组合查找表。通常我会选择单独的查找表，但在这里应用程序需要自动创建它们（例如lookup_dept、lookup_salary），然后在主SQL 语句中添加一个新连接。这将在用户的请求下完成，而不是在添加列时完成（以避免数百个空表）。

另一方面，组合查找表需要多次连接到数据表上，每次都选择列名。

个人查找对我来说似乎很有意义，但我可能完全找错了树。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T18:07:38.433

我同意单独的表格更可取。它更具可扩展性，更适合查询优化。此外，如果将来用户在特定查找中需要更多列，那么您可以添加它们。

是的，应用程序必须自动创建表和约束：我通常不会这样做，但是这个应用程序已经在更改现有表并向它们添加列，而我通常也不会这样做！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T20:22:36.743

啊，“[一个真正的查找表](http://www.dbazine.com/ofinterest/oi-articles/celko22)”的想法。我同意塞尔科先生的罕见情况之一。 [谷歌搜索也](http://www.google.com/search?q=one+true+lookup+table)

每次都有单独的桌子。在数据库意义上它是“正确的”。

我的理由（请不要规范化）：表中的每一行仅存储一个实体。例如水果名称、汽车品牌、电话品牌。把它们混在一起是无稽之谈。我可以拥有一个名为“Apple”的手机品牌。呃……等一下……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-18T18:13:26.510

你说，

> 这优先于实体属性值模型。

但在我看来，这正是你所需要的。

考虑使用 RDF 三元存储，并使用 SPARQL 进行查询。

忘记 SQL，这是 RDF 的工作。

# firewall - MSDTC - 需要多少端口

> ID：673806
> 
> 赞同：13
> 
> 时间：2009-03-23T15:21:32.170
> 
> 标签：firewall, msdtc, ports

我有一个使用 MSDTC 的相当大的应用程序。我应该打开多少端口？有什么方法可以确定吗？

**编辑：**我知道我需要打开**哪些**端口，我不知道我需要**多少**。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T15:35:42.543

当我们不得不进行这种调试时，这篇文章特别有用： [如何解决 MS DTC 防火墙问题](http://support.microsoft.com/kb/306843)。它包括一个名为 DTCPing 的应用程序，可帮助您快速调试问题所在。

据我记得使用了以下端口：

TCP 端口 1433（SQL Server 使用的默认端口）

UDP 端口 1434（由 SQL Server 使用）

TCP 端口 3372（由 MSDTC.EXE 使用）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-09T09:35:56.053

[我想Migol想知道RPC动态端口分配](http://support.microsoft.com/Default.aspx?kbid=154596)的范围应该有多大。

在 KB 中，他们提到至少 100 个端口

> 此外，之前的经验表明，至少应该打开 100 个端口，因为多个系统服务依赖这些 RPC 端口相互通信。

所以我会设计一个基准应用程序来测试你的动态范围的不同值。

# ssis - 将新的输出列添加到自定义数据流组件 SSIS

> ID：673808
> 
> 赞同：0
> 
> 时间：2009-03-23T15:21:36.197
> 
> 标签：ssis

我正在尝试使用同步自定义数据流组件添加新的输出列（下面是代码）。在测试时，我发现我添加的输入列没有显示在输出列中，只有新添加的列才会显示。我不确定问题出在哪里。请帮忙！

```
 Public Overloads Overrides Sub ProvideComponentProperties()
    Dim input As IDTSInput100 = ComponentMetaData.InputCollection.New()
    input.Name = "Input"

    Dim Output As IDTSOutput100 = ComponentMetaData.OutputCollection.New()
    Output.Name = "Output Rows"
    Output.Description = "Output rows with unique row ID appended."

    'Adds new column RowID to output columns list
    Dim rowIDColumn As IDTSOutputColumn100 = Output.OutputColumnCollection.[New]
    rowIDColumn.Name = "Row ID"
    rowIDColumn.SetDataTypeProperties(DataType.DT_UI8, 0, 0, 0, 0)
    Output.SynchronousInputID = input.ID 
```

提前感谢赛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T13:19:11.663

我的错！对于数据流组件，高级编辑器中只会显示新列，但是当我们使用输出箭头并附加到目标（如 excel 或文件或 db）时，它会显示所有列，包括输入列和新添加的列目标编辑器的映射选项卡。:)

# grails - grails 默认约束

> ID：673818
> 
> 赞同：8
> 
> 时间：2009-03-23T15:23:42.697
> 
> 标签：grails, groovy

假设我有一个像这样的 Grails 域对象：

```
class Todo {

    String name
    String status

    static constraints = {
        name(blank: false)
    }    
} 
```

在以下情况下，字段的默认约束是什么：

*   它列在`constraints`块中，例如名称
*   它未在`constraints`块中列出，例如状态

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T05:00:41.000

是的，Siegfried 是对的，可以为空：false 是唯一默认设置的。您可以查看域类工件并在控制台中询问受约束的属性：

```
grailsApplication.getDomainClass("Todo").constrainedProperties.each { propName, constraints  ->
    println "$propName : ${constraints.appliedConstraints.name}"
} 
```

印刷：

```
status : [nullable]
priority : [nullable]
name : [blank, nullable] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T16:36:35.657

据我所知，这只是`nullable: false`在这两种情况下。

# html - 将字段集放在表单之外是否有合法的用例？

> ID：673824
> 
> 赞同：4
> 
> 时间：2009-03-23T15:24:05.737
> 
> 标签：html

我最近得到了纠正，根据 HTML4 DTD，使用 a`fieldset`外部是合法的`form`： [http ://www.w3.org/TR/html401/sgml/dtd.html#block](http://www.w3.org/TR/html401/sgml/dtd.html#block)

以前我不知道这一点，想知道是否有人能想到这样做的合法用例。我觉得大多数设计师都不喜欢用一个来装饰。那么是否有一个合法的用例，或者**你可以链接到一个被认为合适并被使用的网站？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T15:35:35.210

我在打印文档时使用了一个字段集来装饰部分。例如，发票可能有一个 Bill To 和一个 Ship To，并且在它们周围绘制框架并嵌入框架中的图例文本看起来非常漂亮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T15:27:57.180

我认为将其用于装饰是合法的。它简单而优雅，并且使用标签非常好。

查看[w3schools](http://www.w3schools.com/TAGS/tryit.asp?filename=tryhtml_fieldset)示例

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T16:01:24.883

我认为在*语义*上在表单元素之外有一个字段集是不合理的，因为*字段*集是一*组*（输入）*字段*- 线索就在名称中！如果您有输入字段，您可能总是有一个表单，即使您没有回发到服务器。

我偶尔会从表示方面使用，因为字段集+图例组合不可能在 CSS 中完全复制，特别是图例后面的虚线。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T17:36:46.043

可以使用表单元素之外的所有表单字段控件，包括字段集。

这适用于您的字段只与 JavaScript 对话，而不是被提交回服务器端。

（这最初在 Netscape 4 中并不适用，但在本世纪这几乎不是问题......）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T15:28:25.680

好吧，用它来装饰可能会受到设计师的反对并且是合法的，所以有一个合法的用例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T15:31:51.040

表单只是您希望通过回发提交的字段的容器。大多数常规网站页面甚至可能没有。也就是说，使用字段集作为样式标签是合法的，与表单标签是否存在完全无关。

# c - 优化二分查找算法

> ID：673826
> 
> 赞同：4
> 
> 时间：2009-03-23T15:24:11.823
> 
> 标签：c, algorithm, binary, micro-optimization

在二分查找中，我们有两个比较，一个是大于，另一个是小于，否则是中间值。您将如何优化以便我们只需要检查一次？

```
bool binSearch(int array[], int key, int left, int right)
{

    mid = left + (right-left)/2;
    if (key < array[mid])
        return binSearch(array, key, left, mid-1);
    else if (key > array[mid])
        return binSearch(array, key, mid+1, right);
    else if (key == array[mid])
        return TRUE; // Found

    return FALSE; // Not Found
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-23T15:42:39.797

我会先尝试[bsearch()](http://www.manpagez.com/man/3/bsearch/)标准函数。它很有可能比您的方法表现更好。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-23T15:35:47.973

不建议按照您描述的方式尝试和优化。来自[维基百科上的二进制搜索算法文章](http://en.wikipedia.org/wiki/Binary_search#Syntax_difficulties)：

> 大约有一半的时间，第一次测试为真，因此只有一次比较 a 和 b，但另一半时间为假，第二次比较是强制的。这太严重了，以至于有些版本被重铸，以至于根本不进行第二次测试，因此直到跨度减少到零才确定相等性，从而排除了提前终止的可能性——请记住，大约一半的时间搜索将发生在小于限制的一次迭代的匹配值上。
> 
> [通过](http://en.wikipedia.org/wiki/Binary_search#Iterative)使用诸如

```
if a = b then action3
 else if a > b then action2
  else action1; 
```

> 这将强制对除最后一次搜索之外的所有内容执行两次比较，而不是及早检测相等性（可能看起来如此）。

某些语言，如 Fortran，具有三向比较，允许通过一个分支到三个不同部分的比较来完成此步骤（请参阅[三向比较示例](http://en.wikipedia.org/wiki/Binary_search#Three-way_comparison)的第十行）。如果您的语言不支持三向测试（大多数语言不支持），那么最好进行两次比较。

不过，我*建议*您查看同一篇文章中的[迭代实现](http://en.wikipedia.org/wiki/Binary_search#Iterative)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-10-05T01:34:51.190

我试图重构二进制搜索算法的优化步骤。我从这个迭代版本开始：

```
int binsearch_1( arr_t array[], size_t size, arr_t key, size_t *index ){
  if( !array || !size ) return 0;
  arr_t *p=array;
  int found=0;
  while( size > 0 ){
    size_t w=size/2;
         if( p[w] <  key  ){ p+=w+1; size-=w+1; }
    else if( p[w] >  key  ){         size =w;   }
    else  /* p[w] == key */{ p+=w; found=1; break; }
  }
  *index=p-array; return found;
} 
```

从循环中消除比较：

```
int binsearch_2( arr_t array[], size_t size, arr_t key, size_t *index ){
  if( !array || !size ) return 0;
  arr_t *p=array;
  while( size > 0 ){
    size_t w=size/2;
    if( p[w+1] <= key ){ p+=w+1; size-=w+1; } else size =w;
  }
  *index=p-array; return p[0]==key;
} 
```

从循环中展开小尺寸：

```
int binsearch_3( arr_t array[], size_t size, arr_t key, size_t *index ){
  if( !array || !size ) return 0;
  arr_t *p=array;
  while( size > 8 ){
    size_t w=size/2;
    if( p[w+1] <= key ){ p+=w+1; size-=w+1; } else  size =w;
  }
  if( size==8 ){ if( p[5] <=  key ){ p+=5; size=3; } else size=4; }
  if( size==7 ){ if( p[4] <=  key ){ p+=4; size=3; } else size=3; }
  if( size==6 ){ if( p[4] <=  key ){ p+=4; size=2; } else size=3; }
  if( size==5 ){ if( p[3] <=  key ){ p+=3; size=2; } else size=2; }
  if( size==4 ){ if( p[3] <=  key ){ p+=3; size=1; } else size=2; }
  if( size==3 ){ if( p[2] <=  key ){ p+=2; size=1; } else size=1; }
  if( size==2 ){ if( p[2] <=  key ){ p+=2; size=0; } else size=1; }
  if( size==1 ){ if( p[1] <=  key ){ p+=1;         }              }
  *index=p-array; return p[0]==key;
} 
```

重新排序 if 语句，将特殊情况 [size==pow(2,N)-1] 移到末尾：

```
int binsearch_4( arr_t array[], size_t size, arr_t key, size_t *index ){
  if( !array || !size ) return 0;
  arr_t *p=array;
  while( size > 8 ){
    size_t w=size/2;
    if( p[w+1] <= key ){ p+=w+1; size-=w+1; } else  size =w;
  }
  if( size==8 ){ if( p[5] <=  key ){ p+=5; size=3; } else size=4; }
  if( size==6 ){ if( p[4] <=  key ){ p+=4; size=2; } else size=3; }
  if( size==5 ){ if( p[3] <=  key ){ p+=3; size=2; } else size=2; }
  if( size==4 ){ if( p[3] <=  key ){ p+=3; size=1; } else size=2; }
  if( size==2 ){ if( p[2] <=  key ){ p+=2; size=0; } else size=1; }

  if( size==7 ){ if( p[4] <=  key ){ p+=4; size=3; } else size=3; }
  if( size==3 ){ if( p[2] <=  key ){ p+=2; size=1; } else size=1; }
  if( size==1 ){ if( p[1] <=  key ){ p+=1;         }              }
  *index=p-array; return p[0]==key;
} 
```

将 if 语句更改为 switch 语句：

```
int binsearch_5( arr_t array[], size_t size, arr_t key, size_t *index ){
  if( !array || !size ) return 0;
  arr_t *p=array;
  while( size > 8 ){
    size_t w=size/2;
    if( p[w+1] <= key ){ p+=w+1; size-=w+1; } else  size =w;
  }
  if( size==8 ){ if( p[5] <=  key ){ p+=5; size=3; } else size=4; }
  if( size==6 ){ if( p[4] <=  key ){ p+=4; size=2; } else size=3; }
  if( size==5 ){ if( p[3] <=  key ){ p+=3; size=2; } else size=2; }
  if( size==4 ){ if( p[3] <=  key ){ p+=3; size=1; } else size=2; }
  if( size==2 ){ if( p[2] <=  key ){ p+=2; size=0; } else size=1; }

  switch(size){
    case 7: if( p[4] <= key ) p+=4;
    case 3: if( p[2] <= key ) p+=2;
    case 1: if( p[1] <= key ) p+=1;
  }
  *index=p-array; return p[0]==key;
} 
```

扩展 switch 语句以处理所有特殊情况：

```
int binsearch_6( arr_t array[], size_t size, arr_t key, size_t *index ){
  if( !array || !size ) return 0;
  arr_t *p=array;
  switch( size ){
#define C(n) case ((size_t)1<<n)-1: if( p[1<<(n-1)]<=key ) p+=1<<(n-1); 
#if SIZE_MAX == UINT64_MAX 
                                              C(63) C(62) C(61)
    C(60) C(59) C(58) C(57) C(56) C(55) C(54) C(53) C(52) C(51)
    C(50) C(49) C(48) C(47) C(46) C(45) C(44) C(43) C(42) C(41)
    C(40) C(39) C(38) C(37) C(36) C(35) C(34) C(33) C(32)
#endif 
                                                          C(31)
    C(30) C(29) C(28) C(27) C(26) C(25) C(24) C(23) C(22) C(21)
    C(20) C(19) C(18) C(17) C(16) C(15) C(14) C(13) C(12) C(11)
    C(10) C( 9) C( 8) C( 7) C( 6) C( 5) C( 4) C( 3) C( 2) C( 1)
#undef C 
      break;
    default:
      while( size > 0 ){
        size_t w=size/2;
        if( p[w] < key ){ p+=w+1; size-=w+1; } else size=w;
      }
  }
  *index=p-array; return p[0]==key;
} 
```

从代码中消除一般情况处理： [ w 是最小的数字： w==pow(2,N)-1; 尺寸<=2*(w+1) ]

```
int binsearch_7( arr_t array[], size_t size, arr_t key, size_t *index ){
  if( !array || !size ) return 0;
  arr_t *p=array;
  size_t w=(size-1)>>1; w|=w>>1; w|=w>>2; w|=w>>4; w|=w>>8; w|=w>>16;
#if SIZE_MAX == UINT64_MAX
  w|=w>>32;
#endif
  if( p[w]<key ) p+=size-w-1;
  switch( w ){
#define C(n) case ((size_t)1<<n)-1: if( p[1<<(n-1)]<=key ) p+=1<<(n-1);
#if SIZE_MAX == UINT64_MAX
                                              C(63) C(62) C(61)
    C(60) C(59) C(58) C(57) C(56) C(55) C(54) C(53) C(52) C(51)
    C(50) C(49) C(48) C(47) C(46) C(45) C(44) C(43) C(42) C(41)
    C(40) C(39) C(38) C(37) C(36) C(35) C(34) C(33) C(32)
#endif
                                                          C(31)
    C(30) C(29) C(28) C(27) C(26) C(25) C(24) C(23) C(22) C(21)
    C(20) C(19) C(18) C(17) C(16) C(15) C(14) C(13) C(12) C(11)
    C(10) C( 9) C( 8) C( 7) C( 6) C( 5) C( 4) C( 3) C( 2) C( 1)
#undef C
  }
  *index=p-array; return p[0]==key;
} 
```

我所做的最后一步是简化案例标签 [从：'((size_t)1<<n)-1' 到：'n'] 但我发现修改后的代码在我的旧 PC 上比以前的版本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T15:26:43.750

如果你想优化你的二分搜索算法，你必须用迭代替换递归。请参阅维基百科中的示例。

如果您需要更多详细信息，请告诉我。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-23T15:37:28.950

在您发布的代码中，您可以删除最后一个比较。也就是说，如果`key`不小于`array[mid]`或大于`array[mid]`，则根据定义它是相等的。所以你的代码变成：

```
mid = left + (right-left)/2;
if (key < array[mid])
    return binSearch(array, key, left, mid-1);
else if (key > array[mid])
    return binSearch(array, key, mid+1, right);
else 
    return TRUE; // Found 
```

另请注意，我已删除最后一行。在您的原始代码中，`return FALSE;`永远不可能执行。我会假设您在检查的开头有一个检查`binSearch`是否`left`<= `right`。

在 C 中，没有办法根据小于、等于、大于进行三向比较/分支，因此您必须进行两次比较才能在三种可能性中进行选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T15:30:58.793

对于整数没关系，不要这样做。

对于更昂贵的比较，使用 -1, 0, 1 表示 <, =, > 就像在 C 库函数 strcmp 或 Java 的 compareTo() 中一样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-10-05T00:54:13.877

Ganesh M - 如果数组中不存在密钥，那么您的函数将被卡在一个永无止境的循环中。它永远不会返回 FALSE。

如果键不存在，找到插入点的最佳方法是什么？

考虑 <、== 和 > 的条件“如果级联”将仅返回 TRUE，或者永远继续计算。

我需要最佳条件来确定密钥何时被隔离为不存在。

我知道这会减慢搜索速度，但我想减慢搜索速度。

使用 log(N)/log(2) 似乎是个好主意，但是当 N 不是 2 的幂时，事情可能会变得混乱。

也许，我应该选择一个大小为 2 的数组，并使用一个简单的 while 循环？

检查中点 == 是否会增加太多的比较次数？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-03-07T10:17:11.830

```
// Optimized Binary Search Implementation
int binsearch(int* data, int size, int val)
{
    int result = -1;
    int start, mid, end;
    start = 0;
    end = size - 1;
    mid = (start + end) >> 1;
    while (start <= end && data[mid] != val)
    {
        if (data[mid] > val)
            end = mid - 1;
        else
            start = mid + 1;
        mid = (start + end) >> 1;
    }
    if (val == data[mid])
        result = mid;
    return result;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-05-29T11:02:33.627

它是 K&R 第二版中的一个练习题。

```
While(low <= high && arr[mid]!=num)
{
    if(arr[mid] > num)
    {
       low = mid+1;
    }
    else
    {
       high = mid-1;
    }
    mid = (low+high)/2;
}

if(arr[mid] == num)
{
    printf("found the ugly number");
    return mid;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-03-08T17:31:05.577

我在 C# 中使用无分支版本与普通分支版本进行了一些性能测试。分支版本总是获胜。我试图让性能测试产生随机的最坏情况结果，以损害找到或未找到结果的分支，但它可能不是完全最坏的情况。这一切都说得通，这要归功于 Peter Cordes 在[https://stackoverflow.com/a/54273248](https://stackoverflow.com/a/54273248)提供的出色链接。

```
// choose on of these three...
#define BRANCHLESS_UNSAFE // branchless binary search
//#define BRANCHLESS_FROM_SOURCE // copy source from Array.BinarySearch
//#define BRANCHLESS_BUILTIN // Array.BinarySearch

// BRANCHLESS_UNSAFE is on average 4-5 ms slower than BRANCHLESS_BUILTIN on threadripper 1950x

using System;
using System.Diagnostics;
using System.Linq;

namespace BranchlessBinarySearchNamespace
{
    /// <summary>
    /// C# branchless binary search performance test
    /// The built in array binary search is currently faster in release mode, it's possible the compiler is smarter than me :)
    /// </summary>
    public static unsafe class BranchlessBinarySearch
    {
        // if index not found, returns ~(index of element to insert sorted) at.
        public static int BinarySearch<T>(T[] array, T value) where T : IComparable<T>
        {
            int cmp;
            int mid;
            int start = 0;
            int end = array.Length - 1;

#if BRANCHLESS_UNSAFE

            int** ptrArray = stackalloc int*[3];
            ptrArray[0] = &start;
            ptrArray[2] = &end;
            int g0;

#endif

            while (start <= end)
            {
                mid = start + ((end - start) >> 1);
                cmp = array[mid].CompareTo(value);
                if (cmp == 0)
                {
                    return mid;
                }

#if BRANCHLESS_UNSAFE

                // use -1 or 1 to access start or end in array of 3 ptr

                // compiler will turn into non branch most likely
                //g0 = cmp > 0 ? 1 : -1;

                // access sign bit, negate, multiply by 2 and add one. This gives us -1 if less than 0 or 1 if greater than 0.
                g0 = (-(int)((uint)cmp >> 31) * 2) + 1; 

                // index into ptrArr, if g0 is -1 (using end ptr) we access index 0 (1 + -1) which is where end ptr is
                // if g0 is 1 (using start ptr) we access index 2 (1 + 1) which is where start ptr is
                *(ptrArray[1 + g0]) = mid - g0;

#else

                // the above two lines equivelant to this:
                // compiler may be able to optimize this, but the above code is simply an illustration on how to do
                // the binary search logic without any branching logic at all
                else if (cmp > 0)
                {
                    end = mid - 1;
                }
                else
                {
                    start = mid + 1;
                }

#endif

            }
            return ~start;
        }

        private static unsafe void Test(int[] items, int[] find, bool output)
        {
            if (output)
            {
                const bool testBranchless =

#if BRANCHLESS_UNSAFE || BRANCHLESS_FROM_SOURCE

                true;

#else

                false;

#endif

                Console.Write("Testing {0} items, branchless: {1}... ", items.Length, testBranchless);
            }
            Stopwatch sw = Stopwatch.StartNew();

#if BRANCHLESS_UNSAFE || BRANCHLESS_FROM_SOURCE

            for (int i = 0; i < find.Length; i++)
            {
                BinarySearch(items, find[i]);
                //int idx = BinarySearch(items, find[i]);
                //if (idx != Array.BinarySearch(items, find[i]))
                {
                    //throw new ApplicationException("Binary search invalid result");
                }
            }

#else

            for (int i = 0; i < find.Length; i++)
            {
                Array.BinarySearch(items, find[i]);
                //int idx = Array.BinarySearch(items, find[i]);
                //if (idx != Array.BinarySearch(items, find[i])) // ensure same perf characteristic as branchless test
                {
                    //throw new ApplicationException("Binary search invalid result");
                }
            }

#endif

            if (output)
            {
                Console.WriteLine("Time: {0:0.00} ms", sw.Elapsed.TotalMilliseconds);
            }
        }

        private static unsafe void Test(int count, bool output = true)
        {
            Random r = new Random();
            int[] items = new int[count];
            for (int i = 0; i < items.Length; i++)
            {
                items[i] = r.Next(0, items.Length);
            }
            Array.Sort(items);
            int[] find = new int[1024];
            for (int i = 0; i < 1024; i++)
            {
                int found = r.Next(0, 11);
                if (found > 6)
                {
                    // found
                    find[i] = items[r.Next(0, items.Length)];
                }
                else
                {
                    // not found
                    find[i] = (r.Next(0, 2) == 0 ? r.Next(int.MinValue, 0) : r.Next(items.Length + 1, int.MaxValue));
                }
            }
            Test(items, find, output);
        }

        public static void Main()
        {
            for (int i = 0; i < 10; i++)
            {
                for (int j = 10; j <= 10000000; j *= 10)
                {
                    Test(j);
                }
            }
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-06-07T13:04:36.520

```
bool binSearch(int array[], int key, int len)
{
    int mid, low, high;

    low = 0;
    right = len - 1;
    mid = low + (high-low)/2;

    while ((low <= high) && (array[mid] != key)) {
         if (key < array[mid]) {
             high = mid - 1;
         } else {
             low = mid + 1;
         }
         mid = low + (high-low)/2;
    }

    if (array[mid] == key) {
        return TRUE;
    }
    return FALSE;
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-07-05T18:52:22.640

```
BinarySearch = function (array, value)  
{  
    var l = 0;  
    var r = array.length;  
    var mid;  
    while (l!=r)  
    {  
        mid = Math.round( (r+l)/2 )-1;  
        if(value > array[mid])  
            l=mid+1;  
        else  
            r=mid;  
    }  
    if(array[mid]==value)  
        return mid;  
    else  
    {  
        if( (mid < (array.length-1)) && (array[mid+1]==value) )  
            return mid+1;  
        else  
            return -1; // Not found  
    }  
} 
```

来源：[http ://calcs.appspot.com/docview?id=agVjYWxjc3IPCxIIRG9jdW1lbnQY0w8M](http://calcs.appspot.com/docview?id=agVjYWxjc3IPCxIIRG9jdW1lbnQY0w8M)

# java - 如何使 java.text.NumberFormat 格式 0.0d 为“0”而不是“+0”？

> ID：673841
> 
> 赞同：2
> 
> 时间：2009-03-23T15:27:24.967
> 
> 标签：java, text, formatting

需要带符号的结果，0.0d 除外。IE：

```
-123.45d -> "-123.45",
  123.45d -> "+123.45",
  0.0d -> “0”。

```

我调用`format.setPositivePrefix("+")`DecimalFormat 的实例来强制正输入结果中的符号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:02:26.707

我敢肯定有一种更优雅的方式，但看看这是否有效？

```
import static org.junit.Assert.assertEquals;

import java.text.ChoiceFormat;
import java.text.DecimalFormat;
import java.text.FieldPosition;
import java.text.NumberFormat;
import java.text.ParsePosition;

import org.junit.Test;

public class NumberFormatTest {
    @Test
    public void testNumberFormat() {
        NumberFormat nf = new MyNumberFormat();
        assertEquals("-1234.4", nf.format(-1234.4));
        assertEquals("0.0", nf.format(0));
        assertEquals("+0.3", nf.format(0.3));
        assertEquals("+12.0", nf.format(12));
    }
}

class MyNumberFormat extends NumberFormat {

    private DecimalFormat df = new DecimalFormat("0.0#");
    private ChoiceFormat cf = new ChoiceFormat(new double[] { 0.0,
            ChoiceFormat.nextDouble(0.0) }, new String[] { "", "+" });

    @Override
    public StringBuffer format(double number, StringBuffer toAppendTo,
            FieldPosition pos) {
        return toAppendTo.append(cf.format(number)).append(df.format(number));
    }

    @Override
    public StringBuffer format(long number, StringBuffer toAppendTo,
            FieldPosition pos) {
        return toAppendTo.append(cf.format(number)).append(df.format(number));
    }

    @Override
    public Number parse(String source, ParsePosition parsePosition) {
        throw new UnsupportedOperationException();
    }
} 
```

根据[十进制格式](http://java.sun.com/javase/6/docs/api/java/text/DecimalFormat.html)

> 否定子模式是可选的；如果不存在，则以局部减号（在大多数语言环境中为“-”）为前缀的正子模式用作负子模式

因此`new DecimalFormat("0.0#")`等价于`new DecimalFormat("0.0#;-0.0#")`

所以这会给我们： `-1234.5`和`1234.5`

现在，要将“+”添加到正数，我使用[ChoiceFormat](http://java.sun.com/javase/6/docs/api/java/text/ChoiceFormat.html)

*   `0.0 <= X < ChoiceFormat.nextDouble(0.0)`将使用选择格式`""`. `ChoiceFormat.nextDouble(0.0)`是大于 的最小数`0.0`。
*   `ChoiceFormat.nextDouble(0.0) <= X < 1`将使用选择格式`"+"`.

> 如果没有匹配，则使用第一个或最后一个索引，具体取决于数字 (X) 是太低还是太高。如果限制数组不是升序排列，格式化的结果会不正确。ChoiceFormat 也接受 \u221E 作为无穷大（INF）。

因此

*   `Double.NEGATIVE_INFINITY <= X < 0`将使用`""`.
*   `1 <= X < Double.POSITIVE_INFINITY`将使用`"+"`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T16:58:03.430

非常感谢大家，这里有一些非常好的想法。

根据建议，我决定使用两种格式：zeroFormat 用于 0.0d 的特殊情况，而 nonZeroFormat 用于其余情况。我将实现隐藏在 IDisplayableValueFormatter（由自定义 UI 控件使用）后面，并且不需要遵守 NumberFormat 合同/接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-18T20:48:15.293

我只是在一个项目中遇到这个问题，我没有发现这里的任何答案特别令人满意。

我能做的（这可能对你有用也可能不对你有用）是：

```
// Convert negative zero to positive zero.  Even though this
// looks like it should be a no-op, it isn't.
double correctedValue = (value == 0.0 ? 0.0 : value); 
```

然后该值将由`DecimalFormat`类正确格式化。

实际上，我有点惊讶 Java 没有内置类似的构造。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T16:07:48.877

Java 有“负零”和“正零”。它们有不同的表示，但比较为彼此相等。

如果您的正值之前必须有一个加号，但您不希望它为正零，那么您可能需要执行以下操作来临时清除前缀：

```
try {
    if (val == 0.0) {
        format.setPositivePrefix("");
    }
    result = format.format(val);
}
finally {
    format.setPositivePrefix("+");
} 
```

# gwt - 我如何试驾 GWT 开发？

> ID：673842
> 
> 赞同：5
> 
> 时间：2009-03-23T15:27:32.640
> 
> 标签：gwt, user-interface, tdd

只需在谷歌上搜索“TDD”和“GWT”就很容易找到[这篇文章](http://robvanmaris.jteam.nl/2008/03/09/test-driven-development-for-gwt-ui-code/)，作者解释了他如何在没有容器的情况下测试 GWT 应用程序。但是，我认为他的示例不是测试驱动的，因为他首先完成了所有设计，然后再编写测试，而不是“测试优先”。

这让我想到：是否有可能在像 GWT 这样的 UI 上进行“测试优先”开发？有人说 UI 代码不适合 TDD。但是我认为通过采用MVC模式，也许我们至少可以试驾MC部分？（所以 V 是 UI 部分，不能进行测试驱动开发）。

我们将在文章示例中编写的第一个失败的测试是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-23T18:56:16.180

测试驾驶 UI 是有问题的，因为您通常不知道屏幕上想要什么，直到您在屏幕上看到它。出于这个原因，GUI 开发往往是大规模迭代的，因此很难通过测试来驱动。

这并不意味着我们只是放弃了 GUI 的 TDD。相反，我们将尽可能多的代码从 GUI 中推出，只留下简单的接线代码。这种布线使我们能够进行所需的大规模迭代更改，而不会影响问题的本质。

[几年前，Michael Feathers 在一篇题为“The Humble Dialog Box”](http://www.objectmentor.com/resources/articles/TheHumbleDialogBox.pdf)的文章中对这种技术进行了最好的描述。也是四年前引起如此轰动的[Model-View-Presenter模式背后的基本思想；](http://martinfowler.com/eaaDev/ModelViewPresenter.html)现在已经分为被动视图和监督控制器模式。这个问题中的文章链接利用了这些想法，但是以测试后而不是测试驱动的方式。

我们的想法是测试除视图之外的所有内容。事实上，我们甚至不需要长时间编写视图。事实上，View 非常简单，以至于它可能根本不需要任何类型的单元测试。或者，如果确实如此，它们实际上可以最后写入。

要试驾监督控制器，您只需确保您了解数据将如何显示在屏幕上。您不需要知道数据在哪里，或者字体是什么，或者它是什么颜色，或者导致 GUI 大量迭代的任何其他外观问题。相反，您知道一个数据项将是某种文本字段。另一个是菜单，另一个是按钮或复选框。然后确保 View 可以提出它需要提出的所有问题，以正确呈现这些项目。

例如，文本框可能有一个默认值。视图应该能够要求它。菜单中的某些项目可能是灰色的。视图应该能够询问此信息。视图提出的问题都是关于表示的，并且没有业务规则。

同样的道理，当有任何变化时，视图会告诉监督控制器。控制器将适当地修改数据，包括任何类型的验证和错误恢复，然后视图可以询问应该如何呈现数据。

所有这些都可以测试驱动，因为它们都与视觉显示分离。这完全是关于*如何*操作和呈现数据，而*不是*关于它的外观。所以它不需要大规模迭代。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T15:52:37.150

我已经通过 GUI 成功地测试驱动了 Swing 和 GWT 应用程序的开发。

“仅在 GUI 之后”进行测试会忽略模型代码和 GUI 组件之间的集成。当模型更改并从 GUI 接收输入并更新模型时，应用程序需要连接事件处理程序以在 GUI 中显示数据。如果手动完成，测试所有这些事件处理程序是否已正确连接是非常乏味的。

通过 GUI 进行测试时要克服的大问题是如何应对开发过程中对 GUI 的更改。

GWT 有帮助解决这个问题的钩子。您需要在 GWT 小部件上设置调试 ID，并将 DebugID 模块导入您的应用程序。然后，您的测试可以通过控制 Web 浏览器、通过 id 查找元素并单击它们或在其中输入文本来与应用程序交互。[Web Driver](http://webdriver.googlecode.com)是一个非常好的 API。

然而，这仅仅是开始。您还需要将测试与 GUI 的结构分离：用户如何通过 UI 导航以完成工作。无论您是通过 GUI 还是在 GUI 后面针对控制器进行测试，情况都是如此。如果您针对控制器进行测试，则控制器决定了用户在应用程序的不同视图中导航的方式，因此您的测试与该导航结构耦合，因为它与控制器耦合。

为了解决这个问题，我们的测试通过“驱动程序”的层次结构控制应用程序。测试与驱动程序交互，使其能够执行以用户为中心的活动，例如登录、输入订单和付款。驱动程序通过四处导航并将数据输入到 GUI 中来获取有关这些任务如何执行的知识。它通过使用较低级别的驱动程序来实现这一点，这些驱动程序捕获“手势”如何执行导航和数据输入，例如单击按钮或在输入字段中输入文本。您最终会得到如下层次结构：

*   用户目标：测试验证用户可以通过系统实现他们的目标，并展示这些目标是如何通过一系列...
*   用户活动：用户通过 GUI 执行的操作，表示为执行...的驱动程序
*   手势：用于控制 GUI 的低级鼠标和键盘输入。

这种层次结构经常在以用户为中心的设计文献中使用（尽管使用不同的术语）。

# python - 如何从 os.pipe() 读取而不被阻塞？

> ID：673844
> 
> 赞同：10
> 
> 时间：2009-03-23T15:27:53.403
> 
> 标签：python, file, pipe

我正在尝试从开放中阅读，`os.pipe()`以查看阅读时它是否为空。问题是调用`read()`会导致程序在那里阻塞，直到那里实际上有一些东西可以读取，但是如果我正在做的测试成功，就不会有任何东西。

我知道我可以使用`select.select()`超时但是我想知道是否有其他解决方案。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-23T17:54:55.127

你可以试试这个。

```
import os, fcntl
fcntl.fcntl(thePipe, fcntl.F_SETFL, os.O_NONBLOCK) 
```

这`thePipe.read()`应该是非阻塞的。

从[管道（7）](http://man7.org/linux/man-pages/man7/pipe.7.html)手册页：

> 如果一个进程试图从一个空管道中读取，那么 read(2) 将阻塞直到数据可用。`F_SETFL`(...) 通过使用 fcntl(2)操作启用`O_NONBLOCK`打开文件状态标志，可以实现非阻塞 I/O 。

# c# - How to find this using Regular Expression?

> ID：673849
> 
> 赞同：1
> 
> 时间：2009-03-23T15:28:31.233
> 
> 标签：c#, .net, regex

I thought I understood C# regular expressions, but clearly it's not the case. I need some help devising an expression that would find everything from START|BEGIN until )). Expression can be multi line.

Ex.

```
START( FTP_STATE, XXX(
   VAL( FTP_INITIAL_STATE, 0 )
   VAL( FTP_INBOUND,       1 )
   AL( FTP_OUTBOUND,      2 )
))

/**************************************************************/

BEGIN( FTP_TIMER_MODE, YYY(
   VAL( FTP_REMOVE_TIMER,     0 )
   VAL( FTP_NOT_REMOVE_TIMER, 1 )
))

/**************************************************************/ 
```

Any help greatly appreciated

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-23T15:30:16.473

It is straight forward; START or BEGIN, then any number of any symbol but non greedy and finaly the two closing parenthesis. .*? takes any number of any symbol, but as few as possible. To match over more then one line the single line option (?s) must be enabled (Thanks Alan M. for pointing that out.)

```
(?s)(START|BEGIN).*?\)\) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T15:32:35.890

Try this:

```
(?:START|BEGIN)(?:[^)]+|\)[^)])+\)\) 
```

To explain it:

*   **`(?:START|BEGIN)`**   Start with either `START` or `BEGIN`.
*   **`(?:[^)]+|\)[^)])+`**    After that either any character other than a `)` (`[^)]+`) or a `)` that is followed by any character other than `)` (`\)[^)]`) may follow. (So there is no way to match `))` with this expression.)
*   **`\)\)`**   Finally the `))`.

I hope this will reduce backtracking.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T15:37:33.380

Actually you need to account for the VAL( ... )'s as well.

In perl it would be:

```
(BEGIN|START)\([^(\)\)\))].+\)\)\) 
```

1.  Starts with BEGIN or START
2.  Has a opening bracket
3.  Allows anything NOT ))) in between, to avoid greedy matching
4.  Ends with three closing brackets )))

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T15:48:10.097

```
@"(?s)(?:START|BEGIN).*?\)\)" 
```

What some of the others are calling "multiline mode" is actually *single-line* (or DOTALL) mode. That's the mode that lets the dot match newlines. Multiline mode lets '^' match the beginning of a line '$' match the end of a line (normally, the only match the start and end of the whole string. I'm using DOTALL mode with the inline modifier "(?s)".

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T15:30:27.953

I don't know the syntax for C#, but in Perl it's:

```
m/(BEGIN|START).*?\)\)/s 
```

The `s` makes it multiline.

You just have to see how to make the regex multiline in C#

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T15:32:34.580

If you don't understand, and want to learn, regexps then let me recommend this [regexp site](http://regular-expressions.info)

The solution is probably something like /(START|BEGIN).*))/

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T15:39:47.277

```
ResultString = Regex.Match(subject, @"(START|BEGIN).*?\)\)", RegexOptions.Singleline).Value; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T15:41:03.200

Try this

```
MatchCollection m = Regex.Matches(input, "(START|BEGIN).+?\\)\\)", RegexOptions.Multiline); 
```

# actionscript-3 - YouTube 动作脚本 API

> ID：673851
> 
> 赞同：0
> 
> 时间：2009-03-23T15:29:22.073
> 
> 标签：actionscript-3, youtube-api

任何人都可以解释如何使用 actionscript3.0 代码调整你的管播放器的大小。我可以使用以下代码将 you Tube 播放器 swf 加载到我的应用程序中，但是我无法调整播放器的大小。

```
var request = new URLRequest("http://www.youtube.com/v/_UNgokP71tw");
request.method = URLRequestMethod.GET;
youTubeLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaded);
Security.allowDomain("*");
youTubeLoader.load(request); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-07T15:16:57.277

您需要使用 setSize(width, height) 来更改 youtube 播放器的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T15:52:40.850

您不能只更改 youtube 对象的 .width 和 .height 吗？或者我在这里错过了什么？一个问题可能是您需要等到它完全加载后才能调整它的大小。

# mysql - Ruby：Mysql 时间戳/日期时间问题

> ID：673855
> 
> 赞同：0
> 
> 时间：2009-03-23T15:30:25.643
> 
> 标签：mysql, ruby, datetime, timestamp, dbi

'0000-00-00 00:00:00' 问题是否有解决方案，无需更改表？

我在这个查询中有“[]”：

```
dbh.select_all("select j.n, j.name, j.dsc, j.flag, j.td from job j where j.td='0000-00-00 00:00:00'") 
```

我为此寻找解决方案：[http ://rubyforge.org/tracker/index.php?func=detail&aid=22243&group_id=234&atid=967](http://rubyforge.org/tracker/index.php?func=detail&aid=22243&group_id=234&atid=967)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:49:16.000

所以你的默认值是'0000-00-00 00:00:00'，你不能改变它。我挖掘了我的 ruby​​-dbi 邮件列表档案，发现了以下解释：

> 后一种情况的问题在于它不能被强制转换为 DateTime 对象，因为它不是有效时间......老实说，我很惊讶 mysql 完全允许它。无论哪种方式，您都需要关闭类型转换（请参阅 参考资料 `DBI.convert_types=`）以使该默认值正常工作或更改它以及数据库中所有出现的它，或者`bind_coltype`改为将其视为字符串。

请参阅[此邮件列表存档](http://rubyforge.org/pipermail/ruby-dbi-users/2008-September/000046.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T15:36:49.203

我通常将我的日期时间声明为接受 NULL，例如：

```
dtime DATETIME NULL DEFAULT NULL 
```

这样我可以检查一个字段是否为空，而不是一个字段是否='0000-00-00 00:00:00'。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-22T16:58:51.557

您可以将“0000-00-00 00:00:00”转换为 NULL：

从我的表中选择 IF(mytime="0000-00-00 00:00:00",NULL,mytime);

# python - python：任意顺序

> ID：673867
> 
> 赞同：5
> 
> 时间：2009-03-23T15:33:24.077
> 
> 标签：python, sql-order-by

在 Oracle SQL 中，有一个功能需要订购，如下所示：

```
order by decode("carrot" = 2
               ,"banana" = 1
               ,"apple" = 3) 
```

在 python 中实现这一点的最佳方法是什么？

我希望能够通过它的键订购一个字典。而且该顺序不一定是按字母顺序或任何其他顺序 - 我确定顺序。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-23T15:40:10.100

使用 的`key`命名关键字参数`sorted()`。

```
#set up the order you want the keys to appear here
order = ["banana", "carrot", "apple"]

# this uses the order list to sort the actual keys.
sorted(keys, key=order.index) 
```

要获得比 更高的性能`list.index`，您可以`dict.get`改用。

```
#this builds a dictionary to lookup the desired ordering
order = dict((key, idx) for idx, key in enumerate(["banana", "carrot", "apple"]))

# this uses the order dict to sort the actual keys.
sorted(keys, key=order.get) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T15:47:08.880

您不能对 dict 本身进行排序，但可以将其转换为 (key, value) 元组的列表，并且可以对其进行排序。

您使用 .items() 方法来做到这一点。例如，

```
>>> {'a': 1, 'b': 2}
{'a': 1, 'b': 2}
>>> {'a': 1, 'b': 2}.items()
[('a', 1), ('b', 2)] 
```

最有效的排序方法是使用键功能。使用 cmp 效率较低，因为必须为每对项目调用它，而使用 key 它只需要为每个项目调用一次。只需指定一个可调用对象，它将根据项目的排序方式对其进行转换：

```
sorted(somedict.items(), key=lambda x: {'carrot': 2, 'banana': 1, 'apple':3}[x[0]]) 
```

上面定义了一个字典，它指定你想要的键的自定义顺序，并且 lambda 为旧字典中的每个键返回该值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T15:37:47.780

Python 的 dict 是一个 hashmap，所以它没有顺序。[但是您可以单独对键进行排序，使用keys()](http://docs.python.org/library/stdtypes.html#dict.keys)方法从字典中提取它们。

[`sorted()`](http://docs.python.org/library/functions.html#sorted)将比较函数和键函数作为参数。

你可以做你的解码的精确副本

```
sortedKeys = sorted(dictionary, {"carrot": 2
                                ,"banana": 1
                                ,"apple":  3}.get); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T15:39:42.330

你不能对字典进行排序；字典是映射，映射没有顺序。

但是，您可以提取键并对它们进行排序：

```
keys = myDict.keys()
sorted_keys = sorted(keys, myCompare) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T15:41:25.040

将会有`OrderedDict`新的 Python 版本： http: [//www.python.org/dev/peps/pep-0372/](http://www.python.org/dev/peps/pep-0372/)。

同时，您可以尝试其中一种替代实现：[http](http://code.activestate.com/recipes/496761/) : [//code.activestate.com/recipes/496761/，Ordered Dictionary](http://pypi.python.org/pypi/Ordered%20Dictionary/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T15:39:58.227

字典没有排序。您将需要保留密钥列表。

您可以将自己的比较函数传递给 list.sort() 或 sorted()。

如果您需要对多个键进行排序，只需将它们连接到一个元组中，然后对元组进行排序。

# .htaccess - .htaccess 在 Chrome/IE/Opera 中不起作用？

> ID：673877
> 
> 赞同：0
> 
> 时间：2009-03-23T15:35:51.590
> 
> 标签：.htaccess, google-chrome, dns

我有一个 .htaccess 文件将所有人重定向到 www。网站的版本。像这样：

```
      RewriteCond %{HTTP_HOST} ^baldwinbrothersinc\.com$ [NC]
      重写规则 ^(.*)$ http://www.baldwinbrothersinc.com/$1 [L,R=301]

```

当我在 Firefox 或 Safari 中访问 baldwinbrothersinc.com 时，我被重定向到 www.baldwinbrothersinc.com。甜的。

当我在 Opera、IE7 或 Chrome 中执行相同操作时，我被重定向到“找不到页面”消息（或“未找到 DNS”消息，具体取决于浏览器）。我不明白。这些是服务器设置，而不是浏览器解释的东西，对吧？

我知道这个网站的托管有点时髦（他们没有将整个域指向我的域名服务器，而是使用 A 记录来重定向网络流量）但我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T15:40:46.977

那是因为一些浏览器修复了 URL 并添加了`www.`. 问题不在于 htaccess，而是缺少以下 DNS 条目`baldwinbrothersinc.com`：

```
$ dig baldwinbrothersinc.com
;; (...)
;; QUESTION SECTION:
;baldwinbrothersinc.com.                IN      A
;; AUTHORITY SECTION:
baldwinbrothersinc.com. 785     IN      SOA     NS83.WORLDNIC.com. namehost.WORLDNIC.com. 109030615 10800 3600 604800 3600
;; (...)

$ dig www.baldwinbrothersinc.com
;; (...)
;; QUESTION SECTION:
;www.baldwinbrothersinc.com.    IN      A
;; ANSWER SECTION:
www.baldwinbrothersinc.com. 7195 IN     A       205.153.119.13
;;(...) 
```

您也必须先配置您的名称服务器才能解析`baldwinbrothersinc.com`为`205.153.119.13`.

# vba - Excel 导入中的动态寻路

> ID：673883
> 
> 赞同：1
> 
> 时间：2009-03-23T15:38:26.390
> 
> 标签：vba, excel

我有一段 VB 代码可以在 Excel 中动态查找我当前的文件路径。现在我希望在从文本文件中导入文本时使用它，但不知道如何对其进行编码。

这是我获取当前路径的代码：

```
Function GetCurDir()
Dim str As String
Dim pos As Integer
str = ActiveWorkbook.FullName
pos = InStrRev(str, "\")
str = Mid(str, 1, pos)
GetCurDir = str
End Function 
```

这是我在写入文件时使用它的方式：

```
MyFile = GetCurDir & "\Data\MaterialBalance\Ngasdata.dat" 
```

这也是我想使用它的地方：

```
With ActiveSheet.QueryTables.Add(Connection:= _
    "TEXT;C:\NGasSim\Data\MaterialBalance\NGASPROD.DAT", Destination:=Range( _
    "$G$4")) 
```

如您所见，这是一条静态路径。有人可以帮助我使用正确的语法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T15:42:30.203

只需创建另一个变量来构建您的连接字符串：

```
MyFile = GetCurDir & "\Data\MaterialBalance\Ngasdata.dat"

MyConnection = "TEXT;" & MyFile 

With ActiveSheet.QueryTables.Add(Connection:= _
    MyConnection, Destination:=Range( _
    "$G$4")) 
```

# lucene - 使用 RAM 目录

> ID：673887
> 
> 赞同：14
> 
> 时间：2009-03-23T15:39:36.560
> 
> 标签：lucene, lucene.net

什么时候应该使用 Lucene 的 RAMDirectory？与其他存储机制相比，它有哪些优势？最后，我在哪里可以找到一个简单的代码示例？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-23T16:42:39.183

当您不想永久存储索引数据时。我将其用于测试目的。将数据添加到您的 RAMDirectory，在 RAMDir 中进行单元测试。
例如

```
 public static void main(String[] args) {
    try {
      Directory directory = new RAMDirectory();  
      Analyzer analyzer = new SimpleAnalyzer();
      IndexWriter writer = new IndexWriter(directory, analyzer, true); 
```

或者

```
 public void testRAMDirectory () throws IOException {

    Directory dir = FSDirectory.getDirectory(indexDir);
    MockRAMDirectory ramDir = new MockRAMDirectory(dir);

    // close the underlaying directory
    dir.close();

    // Check size
    assertEquals(ramDir.sizeInBytes(), ramDir.getRecomputedSizeInBytes());

    // open reader to test document count
    IndexReader reader = IndexReader.open(ramDir);
    assertEquals(docsToAdd, reader.numDocs());

    // open search zo check if all doc's are there
    IndexSearcher searcher = new IndexSearcher(reader);

    // search for all documents
    for (int i = 0; i < docsToAdd; i++) {
      Document doc = searcher.doc(i);
      assertTrue(doc.getField("content") != null);
    }

    // cleanup
    reader.close();
    searcher.close();
  } 
```

通常，如果使用 RAMDirectory 可以解决问题，那么与其他人一起使用它几乎可以正常工作。即永久存储您的索引。
替代它的是[FSDirectory](http://hudson.zones.apache.org/hudson/job/Lucene-trunk/javadoc//org/apache/lucene/store/FSDirectory.html)。在这种情况下，您必须注意文件系统权限（这对 RAMDirectory 无效）

从功能上讲，RAMDirectory 与 FSDirectory 相比并没有明显的优势（除了 RAMDirectory 明显快于 FSDirectory 的事实）。他们都满足两种不同的需求。

*   RAMDirectory -> 主内存
*   FSDirectory -> 辅助内存

与 RAM 和硬盘非常相似。

我不确定如果 RAMDirectory 超出内存限制会发生什么。我除了一个

> OutOfMemoryException : System.SystemException

抛出。

# windows - 通过 IOCP 进行串行通信

> ID：673896
> 
> 赞同：2
> 
> 时间：2009-03-23T15:41:24.183
> 
> 标签：windows, serial-port, iocp

是否可以将 IO 完成端口用于串行 I/O？根据 Windows 通过 C/C++ 暗示这是可能的，并且确实给出了一个使用 IOCP 和物理文件的示例，显示与 CreateFile、ReadFile、WriteFile 等一起使用。但是这实际上可以与串行通信一起使用吗？它工作吗？

我在网上找不到任何这样的例子，但我不能成为第一个尝试它的人吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T23:55:52.140

是的，使用串行 I/O 的 I/O 完成端口可以正常工作。为适合 IOCP 的串行端口创建文件句柄需要进行一些设置工作。但是一旦设置完成，您就可以像使用常规文件句柄和套接字句柄一样进行异步`ReadFile()`和操作。`WriteFile()`

设置基本上是：

1.  将值作为参数`CreateFile()`传入，打开串口。`FILE_FLAG_OVERLAPPED``dwFlagsAndAttributes`
2.  `GetCommState()`使用和根据需要修改串行端口状态`SetCommState()`。就像不使用 IOCP 时那样做。
3.  使用`GetCommTimeouts()`and`SetCommTimeouts()`关闭读取操作的总超时，因为异步操作的超时通常没有意义。（您将改为显式调用以取消读取操作。）通过将结构的and字段设置为零来`CancelIO()`关闭总超时。`ReadTotalTimeoutMultiplier``ReadTotalTimeoutConstant``COMMTIMEOUTS`

现在您可以将句柄与 IOCP 一起使用，就像使用常规文件句柄和套接字句柄一样。即使用 将句柄附加到完成端口，使用或使用结构`CreateIoCompletionPort()`启动 I/O 操作，使用该功能从完成端口出列已完成、失败或取消的操作。`ReadFile()``WriteFile()``OVERLAPPED``GetQueuedCompletionStatus()`

还可以使用该`WaitCommEvent()`函数异步检索其他串行端口特定事件。

# java - 如何分析一个非常大的 Java webapp？

> ID：673903
> 
> 赞同：4
> 
> 时间：2009-03-23T15:43:09.077
> 
> 标签：java, web-applications, profiling

我有一个非常大的 Java 应用程序。它在 Tomcat 上运行，是典型的 Spring/Hibernate webapp。它也是一个非常大的 Java 程序。测试数据库查询的性能对我来说很容易，因为我可以单独运行它们，但我不知道在这样的堆栈上寻找 Java 瓶颈。我试过 Eclipse 的 TPTP profiler，但它似乎真的不喜欢我的程序，我怀疑是因为我的程序太大了。有人对分析大型 web 应用程序有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T16:54:32.650

现在随 JDK 一起提供的[Visual VM](https://visualvm.dev.java.net/)分析器可以附加到正在运行的进程，并且至少可以提供性能的初步概述。它基于 Netbeans 分析器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T15:50:09.873

试试 jProfiler。很容易与[Tomcat集成](http://www.ej-technologies.com/products/jprofiler/java-profiler-J2EE.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:03:37.907

如果您可以让 Tomcat 和您的应用程序在[Netbeans](http://www.netbeans.org)中运行。

然后您可以使用 Netbeans 内置[分析器](http://profiler.netbeans.org/)来测试性能、内存使用情况等...

Netbeans 中tomcat 上的[维基页面。](http://wiki.netbeans.org/NetbeansedTomcat)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T07:06:54.083

我已经使用 YourKit 来分析具有 8 GB 堆的应用程序，并且效果很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T08:54:33.327

检查[JAMon](http://jamonapi.sourceforge.net/)。它不是分析器，但它是我推荐的最好的分析工具。它很容易与 spring 集成。我们在测试和现场环境中使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T16:09:10.123

我从来没有找到一种简单的方法来做到这一点，因为通常发生的事情太多了，很难获得清晰的整体情况。使用 Hibernate 之类的东西更是如此，因为正确的行为可能是为缓存数据获取一大块内存，即使您的应用程序并没有真正“做任何事情”，所以您运行的另一个内存效率低下的进程可能会淹没在分析中。

您是针对内存、速度进行分析，还是只是在寻找较差的性能？尝试单独测试您怀疑不好的流程，这肯定容易得多。

JProbe、JProfiler 都提供了不错的免费演示。在 IDE 中进行测试会使内存问题复杂化，我发现不打扰更容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T00:17:11.090

尝试[JProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)。它具有试用许可证，并且功能非常齐全。要使用它，您必须：

*   将 JProfiler 代理作为参数添加到您的 java 命令
*   在服务器上启动程序
*   启动 JProfiler 并选择“连接到远程运行的应用程序”
*   给它端口号和它正在运行的任何主机

所有这些都在 JProfiler 附带的说明中，但重要的部分是您将通过主机和端口连接到正在运行的应用程序。

至于要分析什么，我相信您对可能会占用大量内存/CPU 的事情有所了解——加载大型数据集、排序，甚至是简单的网络 I/O（如果操作不正确）。做这些事情（如果您可以使用一些在您的服务器上运行的脚本来自动化负载测试，那就太好了）并使用 JProfiler 收集快照。

然后在闲暇时查看图表。打开 CPU 监控并观察 CPU 周期的使用情况。您将能够在每个方法调用中按百分比缩小范围，因此，如果您在有源的方法中使用超过 1% 或 2% 的 CPU，请进行调查，看看是否可以减少它们的 CPU 密集度。

记忆也是如此。禁用所有 CPU 分析，启用所有内存分析，再次运行测试并获取快照。

冲洗，重复。

您可能还花时间阅读内存管理和垃圾收集。没有比已经进行分析更好的时间来调整垃圾收集了：http: [//java.sun.com/docs/hotspot/gc5.0/gc_tuning_5.html](http://java.sun.com/docs/hotspot/gc5.0/gc_tuning_5.html)

特别注意关于 eden/survivor 对象提升的部分。在 Web 应用程序中，您会得到很多短期对象，因此以牺牲老代为代价来增加年轻代通常是有意义的。

# ssis - 如何遍历多个文件并使用 SSIS 包处理它们？

> ID：673904
> 
> 赞同：2
> 
> 时间：2009-03-23T15:43:09.997
> 
> 标签：ssis

我们有一种情况，我们正在使用相同的 SSIS 包导入许多具有相同格式的文件。正在从 .net 程序集加载和执行该包。目前正在为每个文件重新加载包。

我想在 .net 进程的初始化期间加载一次包，然后为每个文件执行它，以节省为每个文件重新加载包的开销。这是一个安全的过程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-16T11:42:04.767

我了解到您已通过使用 找到问题的答案`Foreach Loop Container`。如果文件格式相同，我认为这是我认为的最佳方法。我发布了以下示例，以便其他用户可以发现它很有用。

实现此目的的一种可能方法是`ForEach Loop container`在`Control Flow`选项卡中使用，然后`Data Flow task`在控制流任务中放置一个。我在下面的例子中解释了这个过程。此示例使用`SQL Server`后端作为目标，使用`Excel 97-2003`格式`.xls`作为源文件。请**注意**，Excel 文件的格式应相同。

**分步过程：**

1.  创建一个名称如屏幕截图 # **1**`dbo.Location`所示的表。此示例将通过读取具有相同布局的三个不同 Excel 文件来填充此表。屏幕截图显示了包执行之前的一个空表。

***   在路径中创建两个 Excel 文件，`c:\temp\`如屏幕截图 # **2** - # **4**所示。请注意，两个 Excel 文件的布局相同，但内容不同。

    *   在 SSIS 包上，创建三个变量，如屏幕截图 # **5**所示。变量`FolderPath`将包含 Excel 文件所在的路径；`FileExtension`将包含 Excel 文件扩展名（在本例中为***.xls**），并且`FilePath`应配置为指向一个有效的 Excel 文件（仅在 Excel 连接管理器的初始配置期间需要）。

    *   `Excel connection`在**连接管理器**中创建一个指向一个有效 Excel 文件的文件，如屏幕截图 # **6**所示。

    *   在指向 SQL Server`OLE DB Connection`的**连接管理器**中创建一个。

    *   在 SSIS 包上，在 ForEach 循环容器中放置一个 ForEach 循环容器和一个数据流任务，如屏幕截图 # **7**所示。

    *   配置 ForEach 循环容器，如屏幕截图 # **8**和 # **9**所示。通过这样做，变量`User::FilePath`将包含位于文件夹中的完整路径 Excel 文件`c:\temp\`，借助变量`FolderPath`并`FileExtension`在该`Collection`部分进行配置。

    *   在数据流任务中，放置一个`Excel source`读取 Excel 文件数据和 O`LE DB destination`将数据插入 SQL Server 表**dbo.Location**。数据流任务应如屏幕截图 # **10**所示。

    *   **如截图 # 11**和 # **12**所示配置 Excel 源，以使用 Excel 连接读取数据。

    *   **如屏幕截图 # 13**和 # **14**所示配置 OLE DB 目标，以将数据插入 SQL Server 数据库表。

    *   在连接管理器中的**Excel 连接**上，配置表达式`ExcelFilePath`，`ServerName`如屏幕截图 # **15**所示。

    *   数据流任务的示例执行如屏幕截图 # **16**所示。

    *   屏幕截图 # **17**显示了包执行后表 dbo.Location 中的数据。请注意，它包含截图 # **3**和 # **4**中显示的 Excel 文件中的所有行。

    *   在`Data Flow task`属性上，将 设置`DelayValidation`为**True**以便 SSIS 在您打开包时不会引发错误。** 

 **希望有帮助。

**截图#1：**

![1](https://i.stack.imgur.com/nDrCm.png)

**截图#2：**

![2](https://i.stack.imgur.com/QizPX.png)

**截图#3：**

![3](https://i.stack.imgur.com/qKiu0.png)

**截图#4：**

![4](https://i.stack.imgur.com/mqDUD.png)

**截图#5：**

![5](https://i.stack.imgur.com/DYWxo.png)

**截图#6：**

![6](https://i.stack.imgur.com/kHd4X.png)

**截图#7：**

![7](https://i.stack.imgur.com/NASkM.png)

**截图#8：**

![8](https://i.stack.imgur.com/Hue96.png)

**截图#9：**

![9](https://i.stack.imgur.com/Cht39.png)

**截图#10：**

![10](https://i.stack.imgur.com/c5XiD.png)

**截图 #11：**

![11](https://i.stack.imgur.com/sy8bL.png)

**截图#12：**

![12](https://i.stack.imgur.com/b6wxb.png)

**截图#13：**

![13](https://i.stack.imgur.com/PUaHF.png)

**截图#14：**

![14](https://i.stack.imgur.com/HUiVZ.png)

**截图#15：**

![15](https://i.stack.imgur.com/4Osn9.png)

**截图#16：**

![16](https://i.stack.imgur.com/Snhgy.png)

**截图#17：**

![17](https://i.stack.imgur.com/zBSzG.png)

**截图#18：**

![18](https://i.stack.imgur.com/8T8XX.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T12:01:17.720

最后，我在包中使用了一个 foreach 循环来逐项处理每个文件。这非常快！关于 SSIS，我还有很多东西要学！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:20:56.803

对我来说似乎是安全的。但是我会在这个过程中运行一些受控测试，可能首先使用一个非常简单的 SSIS 包，然后是更复杂的包。

我不能说我自己已经完成了这个确切的场景。

# javascript - 如何在浏览器中确定用户的语言环境？

> ID：673905
> 
> 赞同：274
> 
> 时间：2009-03-23T15:43:30.887
> 
> 标签：javascript, flash, browser, localization

我有一个本地化为十几种语言的网站 (Flash)，我想根据用户的浏览器设置自动定义一个默认值，以最大限度地减少访问内容的步骤。

仅供参考，由于代理限制，我无法使用服务器脚本，所以我想 JavaScript 或 ActionScript 适合解决这个问题。

**问题：**

1.  “猜测”用户语言环境的最佳方法是什么？

2.  是否有任何现有的简单类/函数可以帮助我（没有复杂的本地化包）？特别是以一种聪明的方式将所有可能的语言减少到更小的数量（我拥有的翻译）。

3.  我可以相信这样的解决方案到什么程度？

4.  还有其他解决方法或建议吗？

* * *

## 回答 #1

> 赞同：232
> 
> 时间：2009-03-23T18:12:09.843

正确的方法是查看发送到服务器的 HTTP [Accept-Language标头。](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4)这包含用户已将其浏览器配置为首选语言的有序加权列表。

不幸的是，此标头无法在 JavaScript 中读取；你得到的只是[`navigator.language`](https://developer.mozilla.org/docs/Web/API/NavigatorLanguage/language)，它告诉你安装了哪个本地化版本的网络浏览器。这不一定与用户的首选语言相同。在 IE 上，您会得到`systemLanguage`(OS installed language)、`browserLanguage`(same as `language`) 和`userLanguage`(user configured OS region)，这些都同样无济于事。

如果我必须在这些属性之间进行选择，我会`userLanguage`先嗅探，然后再回退`language`（如果这些属性与任何可用的语言都不匹配）`browserLanguage`，最后再看`systemLanguage`.

如果您可以将服务器端脚本放在网络上的其他地方，该脚本只需读取 Accept-Language 标头并将其作为 JavaScript 文件返回，并在字符串中包含标头值，例如：

```
var acceptLanguage= 'en-gb,en;q=0.7,de;q=0.3'; 
```

那么您可以在 HTML 中包含一个指向该外部服务的 <script src>，并使用 JavaScript 来解析语言标头。不过，我不知道任何现有的库代码可以做到这一点，因为接受语言解析几乎总是在服务器端完成。

无论你最终做什么，你肯定需要一个用户覆盖，因为它总是会猜错某些人。通常将语言设置放在 URL 中是最简单的（例如 http​://www.example.com/en/site vs http​://www.example.com/de/site），然后让用户点击两者之间的联系。有时您确实希望两种语言版本都有一个 URL，在这种情况下，您必须将设置存储在 cookie 中，但这可能会使不支持 cookie 和搜索引擎的用户代理感到困惑。

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2015-06-30T10:15:52.977

在 Chrome 和 Firefox 32+ 上，`navigator.languages`包含按用户偏好顺序排列的语言环境数组，并且比 更准确`navigator.language`，但是为了使其向后兼容（经过测试的 Chrome / IE / Firefox / Safari），然后使用：

```
function getLang() {
  if (navigator.languages != undefined) 
    return navigator.languages[0]; 
  return navigator.language;
} 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2009-03-23T15:53:01.223

[本文](http://www.techrepublic.com/article/detect-foreign-language-support-using-javascript/)建议浏览器的**navigator**对象具有以下属性：

*   `navigator.language`（网景 - 浏览器本地化）
*   `navigator.browserLanguage`（特定于 IE - 浏览器本地化语言）
*   `navigator.systemLanguage`（特定于 IE - Windows 操作系统 - 本地化语言）
*   `navigator.userLanguage`

将它们放入一个 javascript 函数中，在大多数情况下，您应该能够猜出正确的语言。一定要优雅地降级，所以有一个 div 包含你的语言选择链接，这样如果没有 javascript 或方法不起作用，用户仍然可以决定。如果它确实有效，只需隐藏 div。

在客户端执行此操作的唯一问题是，您要么向客户端提供*所有*语言，要么必须等到脚本运行并检测到语言才能请求正确的版本。也许默认提供最流行的语言版本会激怒最少的人。

编辑：我同意 Ivan 的 cookie 建议，但要确保用户以后可以随时更改语言；不是每个人都喜欢他们的浏览器默认使用的语言。

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2018-08-31T09:11:28.837

结合浏览器用于存储用户语言的多种方式，您将获得以下功能：

```
const getNavigatorLanguage = () => {
  if (navigator.languages && navigator.languages.length) {
    return navigator.languages[0];
  } else {
    return navigator.userLanguage || navigator.language || navigator.browserLanguage || 'en';
  }
} 
```

我们首先检查`navigator.languages`数组的第一个元素。
然后我们得到`navigator.userLanguage`or `navigator.language`。
如果这失败了，我们得到`navigator.browserLanguage`.
最后，我们将其设置为`'en'`如果其他一切都失败了。

* * *

**这是性感的单线：**

```
const getNavigatorLanguage = () => (navigator.languages && navigator.languages.length) ? navigator.languages[0] : navigator.userLanguage || navigator.language || navigator.browserLanguage || 'en'; 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2019-08-16T18:23:35.453

用户的首选语言和系统/浏览器区域设置之间存在差异。

用户可以在浏览器中配置首选语言，这些将用于`navigator.language(s)`，并在从服务器请求资源时使用，以根据语言优先级列表请求内容。

但是，浏览器区域设置将决定如何呈现数字、日期、时间和货币。此设置可能是排名最高的语言，但不能保证。在 Mac 和 Linux 上，区域设置由系统决定，而与用户语言偏好无关。在 Windows 上，可以在 Chrome 上的首选列表中选择语言。

通过使用 Intl ( [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl) )，开发人员可以覆盖/设置用于渲染这些东西的语言环境，但有些元素不能被覆盖，例如`<input type="date">`格式。

要正确提取这种语言，我发现的唯一方法是：

`(new Intl.NumberFormat()).resolvedOptions().locale`

（`Intl.NumberFormat().resolvedOptions().locale`似乎也有效）

这将为默认语言环境创建一个新的 NumberFormat 实例，然后读回这些已解析选项的语言环境。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2020-04-13T20:24:47.967

我使用了所有答案并创建了一个单行解决方案：

```
const getLanguage = () => navigator.userLanguage || (navigator.languages && navigator.languages.length && navigator.languages[0]) || navigator.language || navigator.browserLanguage || navigator.systemLanguage || 'en';

console.log(getLanguage()); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-05-22T05:46:37.210

我对此进行了一些研究，并在下表中总结了迄今为止的发现

[![在此处输入图像描述](https://i.stack.imgur.com/d9Bv4.png)](https://i.stack.imgur.com/d9Bv4.png)

所以推荐的解决方案是编写一个服务器端脚本来解析`Accept-Language`标题并将其传递给客户端以设置网站的语言。奇怪的是为什么需要服务器来检测客户端的语言偏好，但到目前为止就是这样。还有其他各种黑客可用于检测语言，但`Accept-Language`根据我的理解，阅读标题是推荐的解决方案。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-08-05T13:29:09.703

您也可以尝试从文档中获取语言，这可能是您的第一个停靠港，然后回退到其他方式，因为人们通常希望他们的 JS 语言与文档语言相匹配。

HTML5：

`document.querySelector('html').getAttribute('lang')`

遗产：

`document.querySelector('meta[http-equiv=content-language]').getAttribute('content')`

没有真正的来源一定是 100% 可靠的，因为人们可以简单地输入错误的语言。

有一些语言检测库可以让您按内容确定语言。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-05T08:52:31.813

您说您的网站有 Flash，然后，作为另一种选择，您可以获取操作系统的语言[`flash.system.Capabilities.language`](https://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/Capabilities.html)- 请参阅[如何在浏览器中确定操作系统语言](https://stackoverflow.com/questions/3894488/is-there-anyway-to-detect-os-language-using-javascript/30351342#30351342)以*猜测*操作系统区域设置。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2020-08-09T21:00:31.470

您可以使用 http 或 https。

[https://ip2c.org/XXX.XXX.XXX.XXX](https://ip2c.org/XXX.XXX.XXX.XXX) 或 [https://ip2c.org/?ip=XXX.XXX.XXX.XXX](https://ip2c.org/?ip=XXX.XXX.XXX.XXX) |

*   标准 IPv4 从 0.0.0.0 到 255.255.255.255

[https://ip2c.org/s](https://ip2c.org/s) 或 [https://ip2c.org/self](https://ip2c.org/self) 或 [https://ip2c.org/?self](https://ip2c.org/?self) |

*   处理调用者的IP
*   比 ?dec= 选项更快，但仅限于一个目的 - 提供有关您自己的信息

**参考： [https ://about.ip2c.org/#inputs](https://about.ip2c.org/#inputs)**

# version-control - 存储库文件夹结构和从该结构自动构建

> ID：673907
> 
> 赞同：0
> 
> 时间：2009-03-23T15:44:02.523
> 
> 标签：version-control, build-automation, cruisecontrol.net, branch

我们正在工作中升级我们的源代码控制（最有可能是**Vault**）并且正在转向分支方法，并且在制定要使用的文件夹结构时遇到了一些问题。

我们打算使用主干作为开发线，分支将是一个版本和对该版本的错误修复。

我们提出了两种文件夹结构，我想知道它们各自的优缺点是什么：

```
Projects
  |-> Trunk
    |-> Data Access
    |-> Business
    |-> Desktop
    |-> Website
  |-> Branches
    |-> Branch 01
      |-> Data Access
      |-> Business
      |-> Desktop
      |-> Website 
```

和

```
Projects
  |-> Data Access
    |-> Trunk
    |-> Branches
      |-> Branch 01
  |-> Business
    |-> Trunk
    |-> Branches
      |-> Branch 01
  |-> Desktop
    |-> Trunk
    |-> Branches
      |-> Branch 01
  |-> Website
    |-> Trunk
    |-> Branches
      |-> Branch 01 
```

如果我们在构建机器（**Cruisecontrol.net**）上使用源代码控制块和第一个解决方案，我们可以说：

```
<path>$\Projects\trunk\</path> 
```

建立一个分支会非常相似，但是是否可以在文件夹中选择最新的分支`branches`？否则我们将不得不为每个版本编辑 ccnet 配置。

如果要使用第二种方法（很多人建议这种方法），构建机器将如何拾取所有相关项目？像这样的东西可能：

```
<path>$\Projects\*\trunk\</path> 
```

如果一些项目已经分支但其他项目没有，我怎样才能在不存在分支的情况下让它成为主干（如果可能的话）。

会得到所有的树干，然后用树枝覆盖吗？如果它试图访问一个不存在的分支会不会出错？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T21:54:06.393

第一种方法*非常*可靠。您确切地知道您要运送什么（因为每个版本都有一个入口点：主干或分支/标签）。

我发现第二种方法存在几个问题：

1.  所有项目必须同时分支/标记
2.  必须为每个项目单独完成合并

这两种选择都是可能的，但我认为第一种是最简单但也是最安全的选择。

由于该网站很可能独立于版本（如果您从 2007 年创建的分支发布，您不会选择 2007 年的网站，而是 2009 年的网站）。

```
Project
  |
  +- Trunk

Website
  |
  +- Trunk 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T15:16:00.880

最后我写了一个源代码控制插件（使用 Vault 的 API）来允许我在`<folder>`标签中指定一些额外的东西：

```
<folder>$/branches/%latest%</folder> 
```

将检索分支文件夹中的最新分支。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-19T11:57:52.410

我更喜欢细粒度、非常有组织、自包含、结构化的存储库。有一个[图表](http://scm.altern.kiev.ua/images/branches_naming_A3.en.jpg)说明了存储库维护过程的一般（理想）方法。例如，我最初的存储库结构（每个项目存储库都应该有）是：

```
/project
    /trunk
    /tags
        /builds
            /PA
            /A
            /B
        /releases
            /AR
            /BR
            /RC
            /ST
    /branches
        /experimental
        /maintenance
            /versions
            /platforms
        /releases 
```

# java - Eclipse 插件片段

> ID：673908
> 
> 赞同：12
> 
> 时间：2009-03-23T15:44:53.817
> 
> 标签：java, eclipse, plugins

有没有人有用于创建 Eclipse 插件片段的“hello world”示例或教程？

我有一个工作主机插件，为了简单起见，就是这样......

```
public void start(BundleContext context) throws Exception {
    System.out.println("Hello....");
    super.start(context);
    plugin = this;
}

public void stop(BundleContext context) throws Exception {
    System.out.println("Goodbye...");
    plugin = null;
    super.stop(context);
} 
```

足够简单并且有效。现在我想给那个主机添加一个片段，这似乎不像创建一个插件主机那么简单。我只是看不到如何创建片段项目并向其添加逻辑。假设我只想做一些简单的事情，并让片段在 打印“Hello2”`start()`和“Goodbye2” `stop()`。有人可以给我一个工作的例子吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-07-02T14:17:16.630

1.  *Eclipse* ->*文件*->*新建...* ->*片段项目*-> 设置主机插件（位于您的工作区或目标平台的插件中）。

2.  打开*插件清单编辑器*（您可以通过单击来完成`build.properties`，`manifest.mf`或者`fragment.xml`- 如果没有这样的文件，则手动创建它）

3.  在选项卡*扩展*中单击*添加..*并添加`org.eclipse.ui.startup`和浏览实现类的`org.eclipse.ui.IStartup`类。

4.  创建这个类并实现它。您需要实现`earlyStartup()`作为片段入口点的方法。

*注意：下面的行只是示例。我没有测试它，所以可能有错误......*

您只需要这个（这是项目结构/目录结构）：

*   **片段项目**- 根目录
    *   /**元信息**
        *   **清单文件**
    *   / **src**（即源目录）
        *   **FragmentStartClass.java**（实现了org.eclipse.ui.IStartup接口和earlyStartup方法）
    *   **build.properties**
    *   **片段.xml**

**META-INF/MANIFEST.MF**内容：

```
清单版本：1.0
捆绑清单版本：2
捆绑包名称：FragmentProject
Bundle-SymbolicName: FragmentProject;singleton:=true
捆绑版本：1.0.0
Bundle-ClassPath: src/,.
片段主机：*HostPluginProjectSymbolicName*;bundle-version="1.0.0"
Bundle-RequiredExecutionEnvironment：J2SE-1.5
要求捆绑：  

```

**build.properties**内容：

```
源.. = src,\
输出.. = bin/
bin.includes = META-INF/,
              .,
                  片段.xml

```

**fragment.xml**内容：

```
<?xml 版本="1.0" 编码="UTF-8"?>
<?eclipse 版本="3.2"?>
<片段>
   <扩展名
         point="org.eclipse.ui.startup">
      <启动
            class="FragmentStartClass">
      </启动>
   </extension>
</片段>

```

**FragmentStartClass.java**内容：

```
导入 org.eclipse.ui.IStartup；

公共类 FragmentStartClass 实现 IStartup {

    公共无效早期启动（）{
       System.out.println("Hello World From Fragment!");

    }

}

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T17:10:00.977

好吧，首先你想完成什么？你确定碎片是解决方案吗？

片段只是对现有插件的添加。没有 Bundle-Activator 可以“启动”片段。您只需在片段中获得额外的资源。您可以使用扩展点通知主机某些特定功能已由当前片段扩展。将其视为在运行时合并两者。

请参阅[Eclipse Wiki](http://wiki.eclipse.org)中的[此注释](http://wiki.eclipse.org/FAQ_What_is_a_plug-in_fragment%3F)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T17:46:25.787

我不确定您是否可以在主机插件不知道加载片段的额外实现代码的情况下执行此操作。

例如：

```
MyInterface o = null;
try {
    Class<?> c = getClass().getClassLoader().loadClass("my.fragment.Activator");
    o = (MyInterface) c.newInstance();
} catch (ClassNotFoundException e) {
}

if (o != null) {
    o.start();
} 
```

其中 MyInterface 是在主机插件中定义的接口，并由您的片段实现。

另一种方法可能是让片段提供标识扩展类的扩展点，但这可能超出了需要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T17:59:29.717

我认为使用[扩展点](http://www.eclipsezone.com/eclipse/forums/t97608.rhtml)和单独的插件可以更好地为您提供更好的服务，因为您想向基本插件添加功能。

片段仅用于向基本插件添加资源或额外的类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-22T22:58:40.667

作为记录，我刚刚创建了一个 Eclipse 片段，其中包含一些 PMD Java 规则类。

在类文件旁边，该 Jar中**只需要一个文件**`META-INF/MANIFEST.MF`：：

```
Manifest-Version: 1.0
Bundle-ManifestVersion: 2
Bundle-Name: com.acme.tools.pmd
Bundle-SymbolicName: com.acme.tools.pmd;singleton:=true
Bundle-Version: 1.0.0
Fragment-Host: net.sourceforge.pmd.eclipse.plugin;bundle-version="3.2.6"
Bundle-RequiredExecutionEnvironment: J2SE-1.5 
```

我用当前的 Eclipse 3.7 试过这个。部署是通过将 Jar 文件放入`<eclipse root>/dropins/plugins`（如果该文件夹尚不存在则创建该文件夹）。

# c - 开发了一个 strtok 替代方案

> ID：673912
> 
> 赞同：4
> 
> 时间：2009-03-23T15:48:03.123
> 
> 标签：c, pointers, strtok

我已经开发了自己的 strtok 版本。只是为了练习使用指针。

任何人都可以看到任何限制，或者无论如何我可以改进。

```
void stvstrtok(const char *source, char *dest, const char token) 
{
    /* Search for the token. */
    int i = 0;
    while(*source)
    {
        *dest++ = *source++;
        if(*source == token)
        {
            source++;
        }
    }
    *dest++ = '\0';
    }

int main(void)
{
    char *long_name = "dog,sat ,on ,the,rug,in ,front,of,the,fire";
    char buffer[sizeof(long_name)/sizeof(*long_name)];

    stvstrtok(long_name, buffer, ',');

    printf("buffer: %s\n", buffer);

   getchar();

   return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T16:01:42.807

附注：“token”一词通常用于描述返回的字符串部分。Delimiter 用于描述分隔标记的事物。因此，为了使您的代码更清晰，您应该将 token 重命名为 delimiter 并将 dest 重命名为 token_dest。

**您的功能和 strtok 的差异：**

您的函数和 strtok 之间有几个不同之处。

*   您的函数所做的只是删除标记分隔符
*   您只需调用一次函数即可处理字符串的所有部分。使用 strtok 您可以为字符串的每个部分多次调用它（随后将 NULL 作为第一个参数）。
*   strtok 还会破坏源字符串，而您的代码使用自己的缓冲区（我认为最好像您一样使用自己的缓冲区）。
*   strtok 存储每次调用后第一个参数为 NULL 的下一个标记的位置。该位置随后用于后续调用。虽然这不是线程安全的，但您的函数将是线程安全的。
*   strtok 可以使用多个不同的分隔符，而您的代码只使用一个。

话虽如此，我会就如何制作更好的函数给出建议，而不是更接近 strtok 实现的函数。

**如何改进你的功能（不模仿 strtok）：**

我认为最好进行以下更改：

*   让您的函数简单地返回“下一个”令牌
*   当你有 *source 或 *source == delimiter 时跳出你的循环
*   返回指向包含下一个标记的源字符串的第一个字符的指针。该指针可用于后续调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T19:30:45.223

这段代码根本不像`strtok()`. 你到底想做什么？但就改进而言，你的代码有一个严重的错误：如果减去的长度`source`减去出现的次数`token`大于`dest`你自己的长度，你就会得到一个非常经典的*Stack overflow*，这对我来说似乎有点讽刺. 这不会发生在`main`你用过的那个，但在别处使用这个函数，势必会带你走上不确定的道路和绝望的泥潭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T15:55:54.773

strtok 允许您遍历所有标记。它通过假设源字符串是可写的并在标记中断处将空值插入其中来实现这一点。目标缓冲区是指向源缓冲区中字符偏移量的指针。您可以使用这个事实来了解您何时到达终点 + 也可以在通话之间保持“状态”。

Strtok 不是一个好用的函数，因为它会破坏源字符串。它也不是可重入的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T15:58:24.533

strtok() 将保存一些状态，因此您可以多次调用它以获取多个令牌。此外， strtok() 将“拆分”源字符串，以便您获得多个目标字符串，每个目标字符串都是一个标记。

从我所见，您的所有代码所做的就是忽略任何等于标记分隔符的输入字符，并继续复制到源的空终止符。

编辑：另外，考虑有两个排序标记分隔符：第一个将被您的函数忽略，第二个将被写入目标，而 strtok() 将定义 2 个或更多分隔符的序列作为单个分隔符（man页面：[http](http://man.cx/?page=strtok) ://man.cx/?page=strtok ）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T19:40:29.320

strtok 使用 NUL 字符破坏输入字符串，这使它有点敌意。

您还需要考虑“xyz,,pdq”的情况，如果 ',' 是分隔符，strtok 将从该字符串中拉出多少个标记。

在这种情况下，您希望您的功能做什么？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T19:53:18.557

此外， strtok(...) 支持多个分隔符。查看 strspn(...) 和 strcspn(...) 的定义，因为它们可用于重新实现 strtok(...)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T10:28:41.483

顺便说一句，long_name 是指向 char 的指针，而 sizeof(long_name) 是 sizeof(char*)。不是 long_name 指向的大小。

# html - 如何获得右对齐以在 IE 7 的表格单元格内的 div 中工作？

> ID：673917
> 
> 赞同：4
> 
> 时间：2009-03-23T15:48:55.460
> 
> 标签：html, css, internet-explorer-7, alignment, css-float

`Float:right`为表格单元格内的 a指定`div`似乎在 IE 中无效。我还尝试了 text-align right 以将图层内容向右对齐，但在 IE 7 中没有成功。

CSS 片段：

```
.workloadcell {
    background-color: #E6D7E9;
    padding: 0px;
    width: 14px;
    height: 16px;
    text-align: right;
}

div.workload {
    background-color: #E6D7E9;
    text-align: right;
    width: 14px;
    float: right;
} 
```

HTML 片段：

```
<td class="workloadcell">
    <div class="workload">
        1
    </div>
</td> 
```

HTML 和 CSS 都有效，并且在 Firefox 中，文本正确对齐，正如它应该的那样。如果你想通过复制/粘贴来测试完整的代码，它在这里：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
        <title>Table Test</title>
        <style type="text/css">
td {
    border: 1px solid black;
}

.workloadcell {
    background-color: #E6D7E9;
    padding: 0px;
    width: 14px;
    height: 16px;
    text-align: right;
}

div.workload {
    background-color: #E6D7E9;
    text-align: right;
    width: 14px;
    float: right;
}
</style>
    </head>

<body>
        <table>
            <tr>
                <td>
                    &nbsp;
                </td>
                <td colspan="4">
                    <div>
                        2008
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    &nbsp;
                </td>
                <td>
                    <div>
                        Q1
                    </div>
                </td>
                <td>
                    <div>
                        Q2
                    </div>
                </td>
                <td>
                    <div>
                        Q3
                    </div>
                </td>
                <td>
                    <div>
                        Q4
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    workload forecast
                </td>
                <td class="workloadcell">
                    <div class="workload">
                        1
                    </div>
                </td>
                <td class="workloadcell">
                    <div class="workload">
                        2
                    </div>
                </td>
                <td class="workloadcell">
                    <div class="workload">
                        2
                    </div>
                </td>
                <td class="workloadcell">
                    <div class="workload">
                        2
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    actual workload
                </td>
                <td class="workloadcell">
                    <div class="workload">
                        3
                    </div>
                </td>
                <td class="workloadcell">
                    <div class="workload">
                        3
                    </div>
                </td>
                <td class="workloadcell">
                    <div class="workload">
                        2
                    </div>
                </td>
                <td class="workloadcell">
                    <div class="workload">
                        3
                    </div>
                </td>
                        </tr>
        </table>
    </body>
</html> 
```

（我知道 CSS 不是最优的，因为类声明对多个元素重复，但如果与问题无关，请不要对此发表评论。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T16:33:35.820

它应该按照您的方式工作（或 alexmeia 建议的方式）。

但是，（这是 IE），*标题*Q1、Q2 等正在推动表格列比您请求的 14 px 更宽。

这些列在您定义的 14px 内右对齐，但 div 在 IE 中没有向右移动。（即使列*实际上*比 14px 宽，div 也保持在为它定义的 14px 内）

为了说明这一点，您可以将宽度设为 28px**或**更改其中一个背景的颜色，以展示 td 和 in 中的 div 之间的差异。

```
.workloadcell {
    background-color: #E6D7E9;
    padding: 0px;
    width: 14px;
    height: 16px;
    text-align: right;
}

div.workload {
    background-color: #E6EEE9;
    text-align: right;
    width: 14px;
    float: right;
} 
```

IE 的解决方案是要么不定义宽度，要么*使其*宽度足以容纳标题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T16:05:23.127

您不需要为 div.workload 声明规则。仅使用此规则，一切都会正常工作：

```
 td {
    border: 1px solid black;
     }

 .workloadcell {
    background-color: #E6D7E9;
    padding: 0px;
    width: 20px;
    height: 16px;
    text-align: right;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T17:00:17.050

值得注意的是，当您在 div 中混合表格以及在这些表格中混合 div 时，IE，尤其是 pre SP1 XP 上的 v6 和旧 Windows 会出现严重的渲染问题。一旦超过一定的复杂性和嵌套，您可能会得到一个空白/白页。

如果您需要在某些单元格中右对齐文本内容，我建议在 td 标记中添加一个额外的类声明，而不是嵌套 div。我还建议在 IE8 中尝试，看看问题是否仍然存在。你没有提到你需要支持哪些版本。

# c++ - What is the workaround for unaligned memory access exception on ARM9 using C?

> ID：673930
> 
> 赞同：4
> 
> 时间：2009-03-23T15:51:32.800
> 
> 标签：c++, c, embedded, arm

Architecture ARM9\. Programming Language C.

We have a third-party stack and one of the calls takes a pointer(`pBuffer`) to a memory location. Within the stack, they are free to move around the pointer passed and access it as they wish. Unfortunately, they offset the passed in pointer and passed it into a another function that tried to do this from an **odd/unalighed** memory location

```
 ((uint16 *)pBuffer)[index] = value; 
```

where `value` is of type `uint16` and `index` is bounds checked and indexes `pBuffer`. This causes a unaligned memory access exception. `pBuffer` points to `char *` on the heap.

As mentioned, even though we can peek into the third-party stack, we can not update the code officially. So we notify the provider and they provide the update in the next release.

I want to understand if there is a work around for this. How do I perform the above assignment without violating the unaligned access? What is the best approach to resolving such problems.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T15:59:19.600

Copy the value byte by byte. Cast it to a (unsigned) char pointer, and then copy a byte at a time.

It's not pretty, but it doesn't sound like you have many options.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:06:42.953

There are three possibilities, and I cannot determine from your question so far which is the case.

Case 1: The index is always odd. Solution: memmove() pBuffer over 1 bytes Case 2: The index is sometimes odd, and you can predict up front when it will be. Solution: memmove() pBuffer over 1 byte when you know index will be odd. Case 3: The index is sometimes odd, and you cannot predict when it will be. This is unfortunate, because the code *will* fault.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-23T07:58:25.300

If you are in control of pBuffer, as a work around, you could declare it as an array of uint32_t (or whatever matches the alignment of your architecture). With declaring the buffer as uint32_t, the compiler will choose the correct alignment. You can cast it to uint8_t* when calling your target function.

This should work with the example code you posted, but may still fail if the third party code applies any unaligned offset to the buffer.

# c# - 文件系统树视图

> ID：673931
> 
> 赞同：8
> 
> 时间：2009-03-23T15:51:35.610
> 
> 标签：c#, file, treeview, path, system

我正在使用文件系统，并且我有一个文件对象列表<>，这些文件对象具有文件路径作为属性。基本上我需要在 .NET 中创建一个树视图，但我很难想出最好的方法来做到这一点，因为我需要从如下列表中创建一个树结构：

```
C:/WINDOWS/Temp/ErrorLog.txt
C:/Program Files/FileZilla/GPL.html
C:/Documents and Settings/Administrator/ntuser.dat.LOG 
```

ETC....

该列表根本没有结构化，我无法对当前对象结构进行任何更改。

我在 C# 中工作。

非常感谢所有贡献的人

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-23T16:33:55.103

如果您想坚持使用这样的字符串，则可以使用...

```
TreeNode root = new TreeNode();
TreeNode node = root;
treeView1.Nodes.Add(root);

 foreach (string filePath in myList) // myList is your list of paths
 {
    node = root;
    foreach (string pathBits in filePath.Split('/'))
    {
      node = AddNode(node, pathBits);
    }
 }

private TreeNode AddNode(TreeNode node, string key)
{
    if (node.Nodes.ContainsKey(key))
    {
        return node.Nodes[key];
    }
    else
    {
        return node.Nodes.Add(key, key);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T16:24:27.137

我会将字符串转换为 FileInfo。

拥有[FileInfo](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)对象后，您可以使用 Directory 属性来检索每个路径的[DirectoryInfo](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)。

一旦你有了路径的 DirectoryInfo，就很容易在 DirectoryInfo 中“向上走”父引用，将每个路径转换为目录 + 文件名列表 - 即：

```
{"C:","Windows","Temp","ErrorLog.txt"} 
```

这应该相当简单地插入到您的树视图中。只需依次查找路径的每一部分，如果不存在，则添加它....

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T16:32:41.923

试试递归。

```
private void AddFiles()
{
  // Iterate your list with FileInfos here
  foreach( var fileInfo in new Collection<FileInfo>() )
  {
    GetOrCreateTreeNode( fileInfo.Directory ).Nodes.Add( new TreeNode( fileInfo.Name ) );
  }
}

private TreeNode GetOrCreateTreeNode( DirectoryInfo directory )
{
  if( directory.Parent == null )
  {
    // Access your TreeView control here:
    var rootNode = <TreeView>.Nodes[directory.Name];
    if( rootNode == null )
    {
      rootNode = new TreeNode(directory.Name);
      // Access your TreeView control here:
      <TreeView>.Nodes.Add( rootNode );
    }
    return rootNode;
  }

  var parent = GetOrCreateTreeNode( directory.Parent );
  var node = parent.Nodes[directory.Name];
  if( node == null )
  {
    node = new DirectoryNode( directory );
    parent.Nodes.Add( node );
  }
  return node;
} 
```

这段代码应该只给你一个想法——我不得不承认在发布之前我没有测试它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-20T05:01:22.067

```
 private void Form1_Load(object sender, EventArgs e)
    {
        var paths = new List<string>
                        {
                            @"C:\WINDOWS\AppPatch\MUI\040C",
                            @"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727",
                            @"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\MUI",
                            @"C:\WINDOWS\addins",
                            @"C:\WINDOWS\AppPatch",
                            @"C:\WINDOWS\AppPatch\MUI",
                            @"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\MUI\0409"
                        };
        treeView1.PathSeparator = @"\";
        PopulateTreeView(treeView1, paths, '\\');
    }

    private static void PopulateTreeView(TreeView treeView, IEnumerable<string> paths, char pathSeparator)
    {
        TreeNode lastNode = null;
        string subPathAgg;
        foreach (string path in paths)
        {
            subPathAgg = string.Empty;
            foreach (string subPath in path.Split(pathSeparator))
            {
                subPathAgg += subPath + pathSeparator;
                TreeNode[] nodes = treeView.Nodes.Find(subPathAgg, true);
                if (nodes.Length == 0)
                    if (lastNode == null)
                        lastNode = treeView.Nodes.Add(subPathAgg, subPath);
                    else
                        lastNode = lastNode.Nodes.Add(subPathAgg, subPath);
                else
                    lastNode = nodes[0];
            }
        }
    } 
```

![替代文字](https://imgur.com/ZBOKk.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-19T04:06:02.327

EHosca 的作品对我来说非常有效，只是做了一个改动——在路径区域中的 foreach 路径之后，我必须将 lastnode 设置为空。

这是上面 eHosca 的代码，移植到 VB。

```
Private Sub PopulateTreeView(tv As TreeView, paths As List(Of String), pathSeparator As Char)
    Dim lastnode As TreeNode = Nothing
    Dim subPathAgg As String
    For Each path In paths
        subPathAgg = String.Empty
        lastnode = Nothing
        For Each subPath In path.Split(pathSeparator)
            subPathAgg += subPath + pathSeparator
            Dim nodes() As TreeNode = tv.Nodes.Find(subPathAgg, True)
            If nodes.Length = 0 Then
                If IsNothing(lastnode) Then
                    lastnode = tv.Nodes.Add(subPathAgg, subPath)
                Else
                    lastnode = lastnode.Nodes.Add(subPathAgg, subPath)
                End If
            Else
                lastnode = nodes(0)
            End If
        Next
    Next
End Sub 
```

# python - 在 Apache 上部署 Django 时出错

> ID：673936
> 
> 赞同：1
> 
> 时间：2009-03-23T15:52:46.310
> 
> 标签：python, windows, django, apache, mod-python

我有一个小型 Django 网站，我试图在 Apache 2.2 HTTP-Server 上运行。该应用程序使用“python manage.py runserver”运行良好。

Django 版本：1.0.2 最终版本
Python：2.5
操作系统：Windows 2000

我没有完成[文档](http://docs.djangoproject.com/en/dev//howto/deployment/modpython/)中描述的步骤，经过一番摆弄，在我的 httpd.conf 中出现了以下内容。

```
<Location "/therap/">
SetHandler python-program
PythonHandler django.core.handlers.modpython
SetEnv DJANGO_SETTINGS_MODULE settings
PythonOption django.root /therap
PythonDebug On
PythonPath "['D:/therap/therap'] + sys.path"
</Location>

MaxRequestsPerChild 1 
```

D:\therap\therap 在我的 manage.py 所在的地方。

当我尝试在浏览器中打开时，我看到 Django 使用的样式出现错误（而不是白色背景上的黑色 courier。）

```
ImportError at /

No module named therap.urls

Request Method: GET
Request URL:    http://****:8080/
Exception Type: ImportError
Exception Value:   

No module named therap.urls

Exception Location: C:\python25\lib\site-packages\django\core\urlresolvers.py in _get_urlconf_module, line 200
Python Executable:  C:\Programme\Apache Software Foundation\Apache2.2\bin\httpd.exe
Python Version:     2.5.1
Python Path:        ['D:/therap/therap', 'C:\\WINNT\\system32\\python25.zip', 'C:\\Python25\\Lib', 'C:\\Python25\\DLLs', 'C:\\Python25\\Lib\\lib-tk', 'C:\\Programme\\Apache Software Foundation\\Apache2.2', 'C:\\Programme\\Apache Software Foundation\\Apache2.2\\bin', 'C:\\Python25', 'C:\\Python25\\lib\\site-packages', 'C:\\Python25\\lib\\site-packages\\pyserial-2.2', 'C:\\Python25\\lib\\site-packages\\win32', 'C:\\Python25\\lib\\site-packages\\win32\\lib', 'C:\\Python25\\lib\\site-packages\\Pythonwin', 'C:\\Python25\\lib\\site-packages\\wx-2.8-msw-unicode']
Server time:        Mo, 23 Mär 2009 16:27:03 +0100 
```

D:\therap\therap 中有一个 urls.py。但是，在我的大部分代码所在的 D:\therap\therap\main 中没有。

然后我尝试使用父文件夹

```
<Location "/therap/">
    SetHandler python-program
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE therap.settings
    PythonOption django.root /therap
    PythonDebug On
    PythonPath "['D:/therap'] + sys.path"

</Location>

MaxRequestsPerChild 1 
```

这给了我一个不同的错误：

```
MOD_PYTHON ERROR

ProcessId:      2424
Interpreter:    '***'

ServerName:     '****'
DocumentRoot:   'C:/Programme/Apache Software Foundation/Apache2.2/htdocs'

URI:            '/therap/'
Location:       '/therap/'
Directory:      None
Filename:       'C:/Programme/Apache Software Foundation/Apache2.2/htdocs/therap'
PathInfo:       '/'

Phase:          'PythonHandler'
Handler:        'django.core.handlers.modpython'

Traceback (most recent call last):

  File "C:\Python25\Lib\site-packages\mod_python\importer.py", line 1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "C:\Python25\Lib\site-packages\mod_python\importer.py", line 1229, in _process_target
    result = _execute_target(config, req, object, arg)

  File "C:\Python25\Lib\site-packages\mod_python\importer.py", line 1128, in _execute_target
    result = object(arg)

  File "C:\Python25\lib\site-packages\django\core\handlers\modpython.py", line 228, in handler
    return ModPythonHandler()(req)

  File "C:\Python25\lib\site-packages\django\core\handlers\modpython.py", line 201, in __call__
    response = self.get_response(request)

  File "C:\python25\Lib\site-packages\django\core\handlers\base.py", line 67, in get_response
    response = middleware_method(request)

  File "C:\python25\Lib\site-packages\django\middleware\locale.py", line 17, in process_request
    translation.activate(language)

  File "C:\python25\Lib\site-packages\django\utils\translation\__init__.py", line 73, in activate
    return real_activate(language)

  File "C:\python25\Lib\site-packages\django\utils\translation\trans_real.py", line 209, in activate
    _active[currentThread()] = translation(language)

  File "C:\python25\Lib\site-packages\django\utils\translation\trans_real.py", line 198, in translation
    default_translation = _fetch(settings.LANGUAGE_CODE)

  File "C:\python25\Lib\site-packages\django\utils\translation\trans_real.py", line 183, in _fetch
    app = __import__(appname, {}, {}, [])

ImportError: No module named main 
```

我确实使用了国际化模块，但我不明白为什么它会在这一点上引起问题。

“main”是唯一的 Django 应用程序的名称（包含视图、模型、表单等）。完整路径是 D:\therap\therap\main。

我将`__init__.py`-files 从主文件夹的任何地方放到 d:\therap。

现在我不知道我还能做什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T02:38:00.313

问题是您正在导入您的应用程序（“main”），就好像它直接位于 Python 路径上一样，而您的 URLconf（“therap.urls”）就好像它位于 Python 路径上的“therap”模块中一样。这只有在“D:/therap”和“D:/therap/therap”都在 Python 路径上时才有效（runserver 会自动为您“让事情变得简单”；尽管它最终只是延迟了混乱，直到部署时间）。您可以通过在 Apache 配置中使用以下行来模拟 runserver 的行为：

```
PythonPath "['D:/therap', 'D:/therap/therap'] + sys.path" 
```

标准化您的引用可能更有意义，因此您的 Python 路径只需要包含一个或另一个。通常的方式（至少我看到的更经常引用的方式）是将“D:\therap”放在 Python 路径上，并将您的应用程序限定为“therap.main”，而不仅仅是“main”。就我个人而言，我采取了相反的方法，它工作得很好：将“D:\therap\therap”放在你的 Python 路径上，并将 ROOT_URLCONF 设置为“urls”而不是“therap.urls”。这样做的好处是，如果将来您想让您的“主”应用程序可重用并将其移出特定项目，您对它的引用不会与项目名称“therap”相关联（尽管应用程序名为“ main”这听起来不像你在考虑可重用的应用程序）。

# javascript - 如果在父页面中加载 iframe 后将其 src 更改为“about:blank”，iframe 可以访问其父级吗？

> ID：673937
> 
> 赞同：1
> 
> 时间：2009-03-23T15:52:50.020
> 
> 标签：javascript, html

`iframe`如果我在父页面中加载后将其更改`src`为，可以访问其父级吗？`"about:blank"`

注意：`iframe`在另一个域中与父页面不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T15:56:36.113

不会。如果将框架的 src 属性更改为 about:blank，则该框架的内容将替换为空白文档，并且在 iframe 内运行的任何 javascript 都将终止。

如果您需要一种方式让两者进行通信，其中一种方法是公开某种基于 JSON 的端点，该端点可以从一个域调用，而另一个则轮询结果。

**UPD**：关于您的问题，我猜他们不使用 iframe。Pronto 是一个小书签，它允许代码在“外部”页面中运行。虽然我没有验证这一点，但我猜他们能够让浏览器页面通过注入的脚本元素加载他们的 JS 库，并以这种方式显示他们的 UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T15:56:10.700

一般来说，没有。这被称为跨站点脚本 (XSS)，被认为是一种安全风险，因此大多数浏览器都会阻止它。

# sharepoint - 我应该使用工作流还是事件接收器？

> ID：673945
> 
> 赞同：2
> 
> 时间：2009-03-23T15:55:47.423
> 
> 标签：sharepoint, moss, workflow, wss

我想构建一个自定义内容类型，它将成为具有多种状态的列表项的基础。各种状态将确定哪个列表将实例化该项目。它将根据用户操作在状态和列表之间移动。

我有几个选择来实现这个：

1.  在每个列表上创建处理与该列表相关的特定功能的工作流。必要时将项目移动到另一个列表（将项目复制到新列表，删除原始项目），然后启动该工作流程。
2.  在我们将使用的自定义内容类型上创建一个工作流，并让它在各种列表之间移动项目。不确定内容类型上的工作流是否可以在列表之间移动，更不用说跨网站集了。
3.  使用自定义内容类型上的事件接收器来管理状态。用户作用于一个项目，改变它的状态，所以事件接收者在另一个列表上创建自己的副本，然后在当前列表上删除自己。我知道这适用于网站集。

哪种方式最好，为什么？有什么绝对行不通的吗？我忽略了什么方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T16:55:52.727

在我看来，使用事件接收器，因为它们跟随项目而不是列表。您仍然需要为接收列表启用内容类型，但这种方法比根据某些内容类型的存在或不存在更新和删除列表中的工作流要容易得多。

但是，为什么不结合这些方法呢？让内容类型事件接收器处理特定于内容类型的活动，并让列表处理任何特定于列表的活动。事件接收器既便宜又灵活。

.b

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T17:23:24.767

一般来说：在 SharePoint 工作流和事件接收器是相关的（如果您查看带有附加工作流的列表中的事件，您会发现一个事件接收器启动工作流..）

工作流的优点是用户可以检查日志（假设您使用 Log-Activity）

事件接收器的优点是事件数量更多；它们比工作流程更灵活。

根据您的描述，我可能会选择工作流程，因此用户可以检查他们的项目是否被正确处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T11:13:34.257

我使用与每个列表方法相关联的工作流，因为我需要将工作流历史记录作为用户执行操作的审计跟踪。我更喜欢内容类型的工作流的想法，但是回想起来，这将是我所做工作的更清洁的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-22T10:18:44.903

这是在工作流和事件接收器之间做出决定的完美流程图：

[http://msdn.microsoft.com/en-us/library/ff648492.aspx](http://msdn.microsoft.com/en-us/library/ff648492.aspx)

# .net - 业务组件：何时引入它们

> ID：673946
> 
> 赞同：1
> 
> 时间：2009-03-23T15:55:50.483
> 
> 标签：.net

我正在执行代码审查 (VS2008/.NET 3.5)。开发团队在 DAC 程序集中创建了多个数据访问组件。

我遇到了一个业务流程组件，其中每个 DAC 都包含一个业务组件，没有附加值或代码。

这是一个正确的不成熟的架构步骤吗？只是为即将发生的事情做好准备：缓存或验证或事务？所有这些最后提到的话题现在都不是这样，但将来可能会发生。

我在评论中发表评论说，引入这种架构准备会使代码库膨胀。所以尽量只在真正需要的时候才引入它。

你对这个问题有什么经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:04:12.023

我的投票是始终拥有业务对象，并始终根据它们编写您的应用程序。这使得应用层数据访问不可知，并提高了您的整体灵活性。它确实需要更多的前期工作，但任何长期应用程序的红利都是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:17:02.257

为表态表示敬意。作为架构师，我的第一个错误是在编写单行功能代码之前实现图表上的*所有层。*最好为您的层（在图表上）进行规划，但它们只应*在需要时*实施。

*需要*的时候通常是：

*   在物理层上分离逻辑
*   引入逻辑上属于单独层的附加行为
*   强制间接以支持一种模式（只要该模式不是对架构的自我证明滥用）。

话虽这么说，即使你一开始没有实现层，你仍然需要小心避免层之间的紧密耦合。这样，当您确实需要创建层时，您不必重写一堆代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:41:26.723

我同意拥有一个“空”业务层似乎有点矫枉过正——但我的问题是，如果业务类本质上是 DAL 类的空包装器，那么*正在编码的应用程序中的业务逻辑在*哪里？在这些情况下，我经常看到它遍布整个 UI 和 DAL 代码和/或数据库/存储过程，这违背了最初拥有业务层的整个目的。

如果你打算有一个业务层，那么它应该尽可能多地封装业务逻辑，包括验证和各种持久化方法。如果您本质上让业务层成为一堆“愚蠢的”数据传输对象，那么它不会提供任何价值，您可能应该考虑在没有它们的情况下开发您的架构。

# asp.net - 可在 Visual Studio 中拖入设计视图的自定义服务器控件

> ID：673947
> 
> 赞同：2
> 
> 时间：2009-03-23T15:55:51.713
> 
> 标签：asp.net, visual-studio-2008, custom-server-controls

如何设置自定义服务器控件，以便可以将其拖到 Visual Studio 中的设计视图中？

我创建了一个单独的 ASP.NET 服务器控件项目和一个自定义控件`MailLink`，基本上是通过复制这篇 MSDN 文章中的代码：[如何：在 Visual Studio 中使用自定义 ASP.NET 服务器控件](http://msdn.microsoft.com/en-us/library/ms366537.aspx)。如果我手动注册库并使用以下两行将控件插入到我的网页中，该控件可以正常工作：

```
<%@ Register Namespace="Samples.AspNet" TagPrefix="Sample" %>
<Sample:MailLink runat="server" /> 
```

**但是如何注册/配置控件，以便可以将其拖入 Visual Studio 的设计视图中？**如果我从解决方案资源管理器中拖动我的控件，我得到的只是控件的路径。如果将服务器控件项目中的 dll 添加到我的 VS 工具箱中，当我将控件拖到设计视图上时，我会收到剪贴板 FORMATETC 错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:36:52.367

这是我发现比 MSDN 更有用的方法。

[http://www.osnews.com/story/6802/Visual_Studio_NET_Design_View_and_Custom_Web_Controls](http://www.osnews.com/story/6802/Visual_Studio_NET_Design_View_and_Custom_Web_Controls)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:43:15.703

这显示了如何处理它的逐步过程[http://www.newmobilecomputing.com/story/6802/Visual_Studio_NET_Design_View_and_Custom_Web_Controls/page4/](http://www.newmobilecomputing.com/story/6802/Visual_Studio_NET_Design_View_and_Custom_Web_Controls/page4/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:49:53.333

只是为了确保我们在同一页面上：

您可以在 ASP.Net 中构建不止一种类型的控件。不幸的是，根据您构建的控件类型，您通常只能在开发控件时*或**在*开发将使用控件的页面时从 Visual Studio 获得对控件的设计器支持，但是*不是两者*。不受支持的控件将仅显示为灰色框。

 **IMO 这是 Visual Studio/ASP.Net 的重大失败，但我离题了。`ascx`我已经看到通过使用没有代码隐藏的控件克服了这个限制。

既然已经解决了，让我们继续前进。

听起来在这种情况下您正在使用`Server Control`. 您很幸运，因为在构建使用该控件的页面时，服务器控件*应该*从 Visual Studio 获得设计器支持。但是，您需要使控件对项目可用。

服务器控件通常被编译成一个 dll 程序集。您必须在解决方案中包含此文件的引用。此时您应该能够在工具箱中右键单击并选择`Choose Items...`. 这将向您显示一个对话框，允许您选择您的程序集。此时，您的控件应显示在工具箱中。

不幸的是，Visual Studio 有时可能对添加这些控件感到奇怪。您可能需要重新启动 Visual Studio 才能使它们可用。请注意，我仍然使用 Visual Studio 2005，因此希望 2008 年在这方面有所改进。

# java - 如何找出 JPA @Entity 中列的长度？

> ID：673954
> 
> 赞同：7
> 
> 时间：2009-03-23T15:56:59.153
> 
> 标签：java, jpa

我定义了一个字符串列

```
@Column(length = 4000) 
```

该属性包含日志信息，并且可以长于定义的长度。在这种情况下，可以安全地截断该字段而不会引发错误消息。

我想找出 pojo 的 DAO 类中列的确定长度，以便在必要时截断字符串。我怎样才能做到这一点？

问候，

克里斯

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-05-20T15:14:13.403

查看 EJB 对这个问题的[回答](https://stackoverflow.com/questions/1816780/how-to-reuse-fieldlength-in-form-validation-and-ddl/1946901#1946901)；

> [如何在表单、验证和 ddl 中重用字段长度？](https://stackoverflow.com/questions/1816780/)

换句话说，如果您想要 person 表中 firstName 列的长度，您可以使用此代码。

```
person.getClass().getDeclaredField("firstName").getAnnotation(Column.class).length() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:02:44.523

好吧，最简单的方法是在注释中使用[反射](http://www.java2s.com/Code/Java/Language-Basics/JavaAnnotationAnnotationandReflection.htm)。不过，就性能而言，我不会便宜。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-17T14:07:05.330

实现此目的的一种廉价且简单的方法是在实体类中使用长度常量。我认为这应该是正确的方法，如果你认为列大小在你的实体中是一个常数

例子

```
public static final short FIELD_LENGTH = 255;
@Column(name="FIELD", length = FIELD_LENGTH)
private String field; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T16:00:54.107

使用反射将是一个明显的答案。

你在使用休眠吗？如果是这样，那么 Hibernate Validator 应该为您验证长度并提供合适的错误消息。

# c# - 抛出 Win32Exception

> ID：673956
> 
> 赞同：19
> 
> 时间：2009-03-23T15:57:52.787
> 
> 标签：c#, winapi, exception, win32exception

我最近一直在编写很多涉及与 Win32 API 互操作的代码，并且开始想知道处理由调用 Windows API 函数引起的本机（非托管）错误的最佳方法是什么。

目前，对本机函数的调用如下所示：

```
// NativeFunction returns true when successful and false when an error
// occurred. When an error occurs, the MSDN docs usually tell you that the
// error code can be discovered by calling GetLastError (as long as the
// SetLastError flag has been set in the DllImport attribute).
// Marshal.GetLastWin32Error is the equivalent managed function, it seems.
if (!WinApi.NativeFunction(param1, param2, param3))
    throw new Win32Exception(); 
```

引发异常的行可以等效地重写，我相信：

```
throw new Win32Exception(Marshal.GetLastWin32Error()); 
```

现在，这一切都很好，因为它适当地引发了一个异常，其中包含设置的 Win32 错误代码以及（通常）人类可读的错误描述作为`Message`Exception 对象的属性。但是，我一直认为建议至少修改/包装这些异常中的一些（如果不是全部），以便它们提供稍微更面向上下文的错误消息，即在本机代码的任何情况下更有意义的错误消息是正在使用。为此，我考虑了几种替代方案：

1.  在构造函数中为`Win32Exception`.

    ```
    throw new Win32Exception(Marshal.GetLastWin32Error(), "My custom error message."); 
    ```

2.  将 包装`Win32Exception`在另一个 Exception 对象中，以便保留原始错误代码和消息（`Win32Exception`现在是`InnerException`父异常的）。

    ```
    throw new Exception("My custom error message.", Win32Exception(Marshal.GetLastWin32Error())); 
    ```

3.  与 2 相同，除了使用另一个`Win32Exception`作为包装异常。

4.  与 2 相同，但使用派生自的自定义类`Exception`作为包装异常。

5.  与 2 相同，除了在适当时使用 BCL（基类库）异常作为父异常。不确定在这种情况下是否适合将 设置为`InnerException`（`Win32Exception`可能是低级包装器，但不是更高级别/抽象的接口，这不会使 Win32 互操作在幕后发生明显？）

基本上我想知道的是：在 .NET 中处理 Win32 错误的推荐做法是什么？我看到它以各种不同的方式在开源代码中完成，但我很好奇是否有任何设计指南。如果没有，我会在这里对您的个人喜好感兴趣。（也许您甚至没有使用上述方法？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T16:10:11.103

这并不是 Win32 异常所特有的。问题是，两种不同的异常派生类型何时应该识别两种不同的错误情况，何时应该抛出存储在其中的不同值的相同类型？

不幸的是，如果不事先知道将调用您的代码的所有情况，这是不可能回答的。:) 这是只能按类型过滤异常的问题。从广义上讲，如果您强烈认为以不同的方式处理两种错误情况会很有用，请抛出不同的类型。

否则，通常情况下 Exception.Message 返回的字符串只需要记录或显示给用户。

如果有其他信息，请使用您自己的更高级别的内容包装 Win32Exception。例如，您正在尝试对文件执行某些操作，而您正在运行的用户没有执行此操作的权限。捕获 Win32Exception，将其包装在您自己的异常类中，其消息给出文件名和正在尝试的操作，然后是内部异常的消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T16:18:23.720

我的观点一直是，处理这个问题的适当方法取决于目标受众以及你的课程将如何被使用。

如果您的类/方法的调用者将意识到他们正在以一种或另一种形式调用 Win32，我将使用您指定的选项 1)。这对我来说似乎是最“清楚”的。（但是，如果是这种情况，我会以清楚表明将直接使用 Win32 API 的方式命名您的类）。话虽如此，BCL 中有一些异常实际上是 Win32Exception 的子类，以便更清楚地了解，而不仅仅是包装它。例如，SocketException 派生自 Win32Exception。我从来没有亲自使用过这种方法，但它似乎确实是一种潜在的干净方式来处理这个问题。

如果您的类的调用者不知道您正在直接调用 Win32 API，我将处理该异常，并使用您定义的自定义、更具描述性的异常。例如，如果我正在使用您的课程，并且没有迹象表明您正在使用 Win32 api（因为您出于某些特定的、非显而易见的原因在内部使用它），我没有理由怀疑我可能需要处理 Win32Exception。您总是可以记录这一点，但对我来说，将其捕获并给出一个在您的特定业务环境中具有更多意义的异常似乎更合理。在这种情况下，我可能会将初始 Win32Exception 包装为内部异常（即：您的情况 4），但取决于导致内部异常的原因，我可能不会。

此外，很多时候会从本机调用中引发 Win32Exception，但 BCL 中还有其他更相关的异常。当您调用未包装的本机 API 时就是这种情况，但也有类似的函数被包装在 BCL 中。在这种情况下，我可能会捕获异常，确保它是我所期望的，然后抛出标准的 BCL 异常。一个很好的例子是使用 SecurityException 而不是抛出 Win32Exception。

不过，总的来说，我会避免您列出的选项 2 和 3。

选项二会抛出一个通用的异常类型——我非常建议完全避免这种情况。将特定异常包装成更通用的异常似乎是不合理的。

选项 3 似乎是多余的 - 与选项 1 相比确实没有优势。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T16:18:37.103

就我个人而言，我会做#2 或#4 ...最好是#4。将 Win32Exception 包装在上下文相关的异常中。像这样：

```
void ReadFile()
{
    if (!WinApi.NativeFunction(param1, param2, param3))
        throw MyReadFileException("Couldn't read file", new Win32Exception());
} 
```

这样，如果有人捕捉到异常，他们就会很清楚问题发生在哪里。我不会做＃1，因为它需要捕获来解释您的文本错误消息。而#3 并没有真正提供任何额外的信息。

# java - 有谁知道如何从java中的记录中提取日期？

> ID：673962
> 
> 赞同：0
> 
> 时间：2009-03-23T15:59:16.480
> 
> 标签：java, java-me

我有一个像这样设置的日期属性

```
 cal1.setTime(StartDate.getDate());
        strStartDate = cal1.get(cal1.DAY_OF_MONTH) + "/" +
                 (cal1.get(cal1.MONTH) + 1) + "/" +
                 cal1.get(cal1.YEAR); 
```

我需要在执行搜索时提取它。

我到目前为止有这个

```
 int endOfName = record.indexOf(";");
            int endOfDesc = record.indexOf(";" , endOfName + 1);
            int endOfTown = record.indexOf(";", endOfDesc + 1);
            int endOfPlace = record.indexOf(";", endOfTown + 1);
            int endOfStart = record.indexOf(";", endOfPlace +1);

            String Name = record.substring(0, endOfName);
            String Desc = record.substring(endOfName + 1, endOfDesc);
            String Town = record.substring(endOfDesc + 1, endOfTown);
            String Place= record.substring(endOfTown + 1, endOfPlace);
            String Start =record.substring(endOfPlace +1, endOfStart);
            mListForm.append(Name + " aged: " + Desc + Town + Place + Start); 
```

我已经成功地提取了其他数据，但这并没有返回任何关于日期属性的内容，任何人都可以通过给我提取数据的代码来帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:25:12.393

与其多次使用 indexOf 和 substring ，不如使用 split 更容易。

```
String [] pieces = record.split(";"); 
```

然后您可以使用数组访问记录的各个部分。例如：

```
String name = pieces[0];
String desc = pieces[1];
String date = pieces[N]; 
```

一旦你在一个名为 date 的字符串中找到了日期，你也可以调用 split ：

```
String[] dateParts = date.split("/"); 
```

然后您可以使用 dateParts 数组获取有关日期的特定信息。我不太熟悉如何在 java 中存储日期/日历，但这个站点可能可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T17:30:09.023

我认为您正在寻找的是 DateFormat 类。尝试查看[SimpleDateFormat](http://java.sun.com/j2se/1.5.0/docs/api/java/text/SimpleDateFormat.html)

你可以这样做：

```
DateFormat df = new SimpleDateFormat("MM/dd/yyyy");
Date date = df.parse(dateString); 
```

# vb.net - VB.NET 中 DataGrid 的最大记录数是多少？

> ID：673966
> 
> 赞同：0
> 
> 时间：2009-03-23T15:59:57.710
> 
> 标签：vb.net

VB.NET 中 DataGrid 的最大记录数是多少？有没有限制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T16:06:39.037

DataGrid 中没有明确的限制。

然而，它受到内部数据结构的限制，这些数据结构倾向于以整数来计算行数。这意味着硬限制是 Integer.MaxValue

但是，在 32 位系统上，您会在遇到 Integer.MaxValue 行之前很久就遇到问题。添加到 DataGrid 的每个项目都有一定的开销。如果每个项目只有 4 个字节的开销，您将在 Integer.MaxValue / 4 处达到最大值。尽管这确实是一个简单的问题视图，因为它没有考虑其他控件、内部 WinForms 资源等......

您打算添加多少条记录？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:07:44.633

我不知道可用内存的物理限制或 Integer.MaxValue 之外的任何硬限制。不过，如果有的话，我不会太惊讶。

更重要的是，数据网格是向*真实用户展示的**可视化*结构。用户不会很喜欢有 1000 个项目的网格，更不用说 100,000+（我以前见过）。

 *关键是，与其担心可以在其中填充的最大记录数，不如实施分页或更好的搜索机制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:08:28.550

DataGridView.Rows 集合的`Count`属性是`Integer`，因此 4 字节有符号整数的正常范围应作为有效限制：0 到 2,147,483,647

至于 Rows 集合实际上可以容纳什么，我不确定……这取决于您的应用程序实际在做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T16:15:31.997

除了 Integer.MaxValue，我想这取决于应用程序可用的内存和已经使用的内存。

您为什么要考虑一次用所有行填充网格？
向用户显示所有记录是没有意义的。

# python - 如何使用列表中显示的相关项目的下拉列表使特定模型类的 Django contrib Admin 更改列表可编辑？

> ID：673970
> 
> 赞同：1
> 
> 时间：2009-03-23T16:00:39.770
> 
> 标签：python, django, django-admin, django-templates, django-forms

基本上我想要一个相关条目的可编辑表单而不是静态列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T09:24:43.353

试试 Django 1.1 测试版。它可以选择使更改列表中的项目可编辑（以及合并 django-batchadmin 项目）

# jquery - 如何使用 jQuery 对多行记录进行条带化？

> ID：673983
> 
> 赞同：1
> 
> 时间：2009-03-23T16:02:52.260
> 
> 标签：jquery, html, css, html-table

我目前正在使用以下 jQuery 脚本来突出显示表中的行，效果很好！

```
 <script type="text/javascript">
        $(document).ready(function()
        {
            $('table.grid tbody tr:odd').addClass('alt');
        });
    </script> 
```

这对于每一行都是新记录的数据表非常有用，但是，我遇到了一个问题，我的记录占用了两行数据，并且想要修改 jQuery，使其呈现如下内容：

```
<table>
    <thead>
        <tr>
            <th>Col 1</th>
            <th>Col 2</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Record 1 Field 1</td>
            <td>Record 1 Field 2</td>
        </tr>
        <tr>
            <td colspan="2">Record 1 Field 3</td>
        </tr>
        <tr class="alt1">
            <td>Record 2 Field 1</td>
            <td>Record 2 Field 2</td>
        </tr>
        <tr class="alt2">
            <td colspan="2">Record 2 Field 3</td>
        </tr>
        <tr>
            <td>Record 3 Field 1</td>
            <td>Record 3 Field 2</td>
        </tr>
        <tr>
            <td colspan="3">Record 1 Field 3</td>
        </tr>
        <tr class="alt1">
            <td>Record 4 Field 1</td>
            <td>Record 4 Field 2</td>
        </tr>
    <tr class="alt2">
        <td colspan="4">Record 2 Field 3</td>
    </tr>
</tbody>
</table> 
```

我将如何在 jQuery 中实现这一点，我希望每 3 行都有一个“alt1”类，每 4 行有一个“alt2”类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T16:28:56.143

上面的答案稍微正确。不要使用 i%3==0 和 i%4==0，而是使用相同的模除数。因此，从 0 开始，i%4==2 和 i%4==3 将跳过两个、取两个、跳过两个、取两个等。另一种方式取 3、4、6、8、9、12等。所以，小的修改将是

```
<script type="text/javascript">
    $(document).ready(function()
    {
        $('table.grid tbody tr').each(function(i) {
            if(i%4 == 2) {
                //Each 3rd row in sets of 4
                $(this).addClass('alt1');
            }
            if(i%4 == 3) {
                //Each 4th row in sets of 4
                $(this).addClass('alt2');
            }
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T16:16:46.143

```
 <script type="text/javascript">
        $(document).ready(function()
        {
            $('table.grid tbody tr').each(function(i) {
                if(i%3 == 0) {
                    //We're at a 3rd row
                    $(this).addClass('alt1');
                }
                if(i%4 == 0) {
                    //We're at at 4th row
                    $(this).addClass('alt2');
                }
            });
        });
    </script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:43:40.383

将每条记录（多行或不多行）分配到单独的 tbody 标记中可能会更容易。您可以有许多 tbody 标签，如果您的记录在多行中，那么单独的 tbody 标签中的每条记录在这里最有意义。

```
$('table.grid tbody:odd tr:first').addClass('alt1');
$('table.grid tbody:odd tr:last').addClass('alt2');
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T17:10:00.460

```
$('table.grid tbody tr:nth-child(4n+2)').addClass('alt1');
$('table.grid tbody tr:nth-child(4n+3)').addClass('alt2'); 
```

应该工作（未经测试）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T09:59:13.733

嗯——这个表结构很不寻常——你能展示一些你放在这样一个表中的样本数据吗？

在我能想到的大多数情况下，使用行跨度（如 Nerdling 提到的）或正文中的其他 TH 元素（为每条记录提供标题行）或两者的组合会更准确。

一旦你的结构有了额外的细节，你就可以编写 javascript 来读取表的实际结构，而不是将条带 3rd/stripe 4th 值硬编码到脚本中。例如，您最终会得到一个无需做任何额外操作即可处理 3 行记录的脚本。

如果您可以显示一些示例数据，我会很高兴地编写脚本！

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-23T16:11:23.970

如果它占用另一行，请使用[rowspan (HTML) 属性](http://www.htmlcodetutorial.com/tables/index_famsupp_30.html)来指示。************