# StackOverflow 问答 000362000-000362999

# html - 如何使用 Perl 提取或更改 HTML 中的链接？

> ID：362000
> 
> 赞同：2
> 
> 时间：2008-12-12T05:53:15.700
> 
> 标签：html, regex, perl, multiple-instances

我有这个输入文本：

```
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"></head><body><table cellspacing="0" cellpadding="0" border="0" align="center" width="603">   <tbody><tr>     <td><table cellspacing="0" cellpadding="0" border="0" width="603">       <tbody><tr>         <td width="314"><img height="61" width="330" src="/Elearning_Platform/dp_templates/dp-template-images/awards-title.jpg" alt="" /></td>         <td width="273"><img height="61" width="273" src="/Elearning_Platform/dp_templates/dp-template-images/awards.jpg" alt="" /></td>       </tr>     </tbody></table></td>   </tr>   <tr>     <td><table cellspacing="0" cellpadding="0" border="0" align="center" width="603">       <tbody><tr>         <td colspan="3"><img height="45" width="603" src="/Elearning_Platform/dp_templates/dp-template-images/top-bar.gif" alt="" /></td>       </tr>       <tr>         <td background="/Elearning_Platform/dp_templates/dp-template-images/left-bar-bg.gif" width="12"><img height="1" width="12" src="/Elearning_Platform/dp_templates/dp-template-images/left-bar-bg.gif" alt="" /></td>         <td width="580"><p>&nbsp;what y all heard?</p><p>i'm shark oysters.</p>             <p>&nbsp;</p>             <p>&nbsp;</p>             <p>&nbsp;</p>             <p>&nbsp;</p>             <p>&nbsp;</p>             <p>&nbsp;</p></td>         <td background="/Elearning_Platform/dp_templates/dp-template-images/right-bar-bg.gif" width="11"><img height="1" width="11" src="/Elearning_Platform/dp_templates/dp-template-images/right-bar-bg.gif" alt="" /></td>       </tr>       <tr>         <td colspan="3"><img height="31" width="603" src="/Elearning_Platform/dp_templates/dp-template-images/bottom-bar.gif" alt="" /></td>       </tr>     </tbody></table></td>   </tr> </tbody></table> <p>&nbsp;</p></body></html> 
```

如您所见，这段 HTML 文本中没有换行符，我需要查找其中的所有图像链接，将它们复制到目录中，然后将文本中的行更改为`./images/file_name`.

目前，我使用的 Perl 代码如下所示：

```
my ($old_src,$new_src,$folder_name);
    foreach my $record (@readfile) {
        ## so the if else case for the url replacement block below will be correct
        $old_src = "";
        $new_src = "";
        if ($record =~ /\<img(.+)/){
            if($1=~/src=\"((\w|_|\\|-|\/|\.|:)+)\"/){
                $old_src = $1;
                my @tmp = split(/\/Elearning/,$old_src);
                $new_src = "/media/www/vprimary/Elearning".$tmp[-1];
                push (@images, $new_src);
                $folder_name = "images";
            }## end if
        }
        elsif($record =~ /background=\"(.+\.jpg)/){
            $old_src = $1;
            my @tmp = split(/\/Elearning/,$old_src);
            $new_src = "/media/www/vprimary/Elearning".$tmp[-1];
            push (@images, $new_src);
            $folder_name = "images";
        }
        elsif($record=~/\<iframe(.+)/){
            if($1=~/src=\"((\w|_|\\|\?|=|-|\/|\.|:)+)\"/){
                $old_src = $1;
                my @tmp = split(/\/Elearning/,$old_src);
                $new_src = "/media/www/vprimary/Elearning".$tmp[-1];
                ## remove the ?rand behind the html file name
                if($new_src=~/\?rand/){
                    my ($fname,$rand) = split(/\?/,$new_src);
                    $new_src = $fname;
                    my ($fname,$rand) = split(/\?/,$old_src);
                    $old_src = $fname."\\?".$rand;
                }
        print "old_src::$old_src\n"; ##s7test
        print "new_src::$new_src\n\n"; ##s7test
                push (@iframes, $new_src);
                $folder_name = "iframes";
            }## end if
        }## end if

        my $new_record = $record;
        if($old_src && $new_src){
            $new_record =~ s/$old_src/$new_src/ ;
    print "new_record:$new_record\n"; ##s7test
            my @tmp = split(/\//,$new_src);
            $new_record =~ s/$new_src/\.\\$folder_name\\$tmp[-1]/;
##  print "new_record2:$new_record\n\n"; ##s7test
        }## end if
        print WRITEFILE $new_record;
    } # foreach 
```

这仅足以处理其中包含换行符的 HTML 文本。我以为只循环正则表达式语句，但随后我必须将匹配行更改为其他文本。

您是否知道是否有一种优雅的 Perl 方法可以做到这一点？或者，也许我太笨了，看不到明显的做法，而且我知道把全局选项放在一边是行不通的。

谢谢。〜史蒂夫

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-12T06:22:46.653

Perl 有优秀的 HTML 解析器，学习使用它们并坚持下去。HTML 很复杂，允许 > 在属性中，大量使用嵌套等。使用正则表达式解析它，除了非常简单的任务（或机器生成的代码）之外，很容易出现问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T07:43:09.830

我想你想要我的[HTML::SimpleLinkExtor](http://search.cpan.org/dist/HTML-SimpleLinkExtor)模块：

```
使用 HTML::SimpleLinkExtor；

我的 $extor = HTML::SimpleLinkExtor->new;
$extor->parse_file($file);

我的@imgs = $extor->img;

```

我不确定你到底想做什么，但如果我的不这样做的话，听起来好像其中一个 HTML 解析模块应该可以解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T07:10:20.130

如果您必须避免使用任何其他模块，例如 HTML 解析器，您可以尝试：

```
while ($string =~ m/(?:\<\s*(?:img|iframe)[^\>]+src\s*=\s*\"((?:\w|_|\\|-|\/|\.|:)+)\"|background\s*=\s*\"([^\>]+\.jpg)|\<\s*iframe)/g) {
  $old_src = $1;
            my @tmp = split(/\/Elearning/,$old_src);
                    $new_src = "/media/www/vprimary/Elearning".$tmp[-1];
  if($new_src=~/\?rand/){
    // remove rand and push in @iframes
  else
  {
    // push into @images
  }
} 
```

这样，您将在所有源代码（包括换行符）上应用此正则表达式，并拥有更紧凑的代码（另外，您将考虑属性及其值之间的任何额外空间）

# linq-to-sql - Linq2SQL 引用类型

> ID：362004
> 
> 赞同：1
> 
> 时间：2008-12-12T05:56:05.100
> 
> 标签：linq-to-sql

我有一个带有 NameValueCollection 属性的对象，我正在使用 Linq2SQL 进行管理。我打算将它序列化为数据库中的 XML 列（xelement）。我的问题是我真的没有一个钩子可以在使用 Linq2SQL 保存时将其转换为 XML。我相信我可以使用 OnLoaded 部分方法来控制反序列化。

有没有人有一个好的方法可以使用 Linq2SQL 将引用类型持久化到 XML 列中？我不想为此属性创建一个新表。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T07:05:26.957

我通过使用 OnLoaded() 和 OnValidate() 扩展方法将我的引用类型加载和序列化到 XElement 对象中解决了这个问题。这似乎工作得很好，我现在有一种方法可以将 NameValueCollection 保存到我们的数据库中。

# perl - 如何从文本文件中提取数字数据？

> ID：362032
> 
> 赞同：1
> 
> 时间：2008-12-12T06:22:43.377
> 
> 标签：perl, extract

我希望 Perl 脚本从文本文件中提取数据并将其保存为另一个文本文件。文本文件的每一行都包含一个指向 jpg 的 URL，例如“ [http://pics1.riyaj.com/thumbs/000/082/104//small.jpg](http://pics1.riyaj.com/thumbs/000/082/104//small.jpg) ”。我希望脚本将每个 jpg URL 的最后 6 个数字（即 082104）提取到一个变量中。我希望将变量添加到新文本每一行的不同位置。

输入文本：

```
text http://pics1.riyaj.com/thumbs/000/082/104/small.jpg text
text http://pics1.riyaj.com/thumbs/000/569/315/small.jpg text 
```

输出文本：

```
text php?id=82104 text
text php?id=569315 text 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T07:40:01.177

你试过什么了？

这是一个简短的程序，可以为您提供问题的核心，您可以添加其余部分：

```
尽管（ ）
    {
    s|http://.*/\d+/(\d+)/(\d+).*?jpg|php?id=$1$2|;
    打印;
    }

```

这非常接近命令行程序，它使用`-p`开关为您处理循环和打印（有关详细信息，请参阅[perlrun](http://perldoc.perl.org/perlrun.html)文档）：

```
perl -pi.old -e 's|http://.*/\d+/(\d+)/(\d+).*?jpg|php?id=$1$2|' inputfile > outputfile 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T07:44:56.987

我不知道是根据您所描述的（“最后 6 位数字”）回答还是只是假设这一切都符合您所展示的模式。所以我决定两种方式都回答。

这是一种可以处理比您的示例更多样化的行的方法。

```
use FileHandle;

my $jpeg_RE = qr{
    (.*?)           # Anything, watching out for patterns ahead
    \s+             # At least one space
    (?> http:// )   # Once we match "http://" we're onto the next section
    \S*?            # Any non-space, watching out for what follows
    ( (?: \d+ / )*  # At least one digit, followed by a slash, any number of times
      \d+           # another group of digits
    )               # end group
    \D*?            # Any number of non-digits looking ahead
    \.jpg           # literal string '.jpg'
    \s+             # At least one space
   (.*)             # The rest of the line
}x;

my $infile  = FileHandle->new( "<$file_in" );
my $outfile = FileHandle->new( ">$file_out" );

while ( my $line = <$infile> ) { 
    my ( $pre_text, $digits, $post_text ) = ( $line =~ m/$jpeg_RE/ );
    $digits        =~ s/\D//g;
    $outfile->printf( "$pre_text php?id=%s $post_text\n", substr( $digits, -6 ));
}
$infile->close(); 
```

但是，如果它像您显示的那样常规，它会变得容易得多：

```
use FileHandle;
my $jpeg_RE = qr{
    (?> \Qhttp://pics1.riyaj.com/thumbs/\E ) 
    \d{3}
    /
    ( \d{3} )
    / 
    ( \d{3} )
    \S*?
    \.jpg
}x;

my $infile  = FileHandle->new( "<$file_in" );
my $outfile = FileHandle->new( ">$file_out" );

while ( my $line = <$infile> ) { 
    $line =~ s/$jpeg_RE/php?id=$1$2/g;
    $outfile->print( $line );
}
$infile->close(); 
```

# html - div的弯曲角边框

> ID：362038
> 
> 赞同：10
> 
> 时间：2008-12-12T06:29:02.757
> 
> 标签：html, css

我需要构建一个带有弯曲角边框的 div，而不使用角落中的任何图像。可能吗？

我不想在角落插入弯曲的图像，请帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T06:42:57.830

If you want to rely on webkit and mozilla browsers, you can use the following css commands:

```
.radius {
-moz-border-radius: 6px;
-webkit-border-radius:6px;
border-radius: 6px;
    } 
```

Details can be viewed [here](http://www.css3.info/preview/rounded-border/).

info on the CSS2 spec border-radius can be found [here](http://www.w3.org/TR/2005/WD-css3-background-20050216/#the-border-radius)

These unfortunately do not work for ie.

you could go a javascript route for IE only by using [niftycube](http://www.html.it/articoli/niftycube/index.html) which has the added benefit of supporting column height leveling without problems.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-12T06:34:17.050

[http://www.curvycorners.net/](http://www.curvycorners.net/)

试试这个库，它为我创造了奇迹！这是一个经过测试的跨浏览器解决方案。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-12T06:37:33.567

您可以使用 CSS 在现代浏览器中实现圆角...

```
border-radius: 10px; 
```

[手持发电机](http://border-radius.com/)

这称为[*渐进增强*](http://en.wikipedia.org/wiki/Progressive_enhancement)。IMO，这比带有边距和边框的图像和/或 CSS 技巧要好。除非你绝对必须有圆角。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T17:56:18.583

这是我写的，如果你喜欢，欢迎你使用。它使用背景颜色渲染任何尺寸的圆角框，但在整个框周围没有边框。它适用于白色页面背景，但可以通过编辑 c1、c2 和 c3 样式中的边框颜色来更改。

```
.rounded {background-color:#f1f0f1}
.rounded .inner {padding:8px 10px 8px 12px}
.rounded .c1 {height:1px;line-height:1px;font-size:1px;border-width: 0px 4px 0px 4px;border-color:#FFFFFF;border-style:solid;padding:0px}
.rounded .c2 {height:1px;line-height:1px;font-size:1px;display:block;border-width: 0px 2px 0px 2px;border-color:#FFFFFF;border-style:solid;padding:0px}
.rounded .c3 {height:2px;line-height:1px;font-size:1px;display:block;border-width: 0px 1px 0px 1px;border-color:#FFFFFF;border-style:solid;padding:0px}

   <div class="rounded" style="width:200px;height:100px">
    <div class="c1"></div><div class="c2"></div><div class="c3"></div>
        <div class="inner">
        -- Content Here --
        </div>
        <div class="c3"></div><div class="c2"></div><div class="c1"></div>
   </div> 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-12T18:02:29.697

我会使用 jQuery 插件来处理圆角。这是 jQuery 网站上可用的圆角插件列表：http: [//plugins.jquery.com/taxonomy/term/189](http://plugins.jquery.com/taxonomy/term/189)

# c# - 发生 WebClientProtocol Timeout 时会发生什么

> ID：362042
> 
> 赞同：1
> 
> 时间：2008-12-12T06:34:13.387
> 
> 标签：c#, .net, web-services, timeout

我们有一个引用 Web 服务的客户端应用程序。我们已将 webclientprotocol 对象的 timeout 属性设置为 50 (ms)，并想观察发生了什么。我们绑定了一个长期运行的 Web 方法，它向客户端返回一个巨大的 DataSet。当存在默认值时，DataSet 已正确返回给客户端。当我们将其更改为 50(ms) 时，我们没有观察到任何东西。我们的假设是，由于发生超时，客户端会发生某种异常。谁能解释一下这里发生了什么

谢谢拉吉

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T07:13:00.030

不幸的是，文档不清楚。当你说你“没有观察到任何东西”时，你到底是什么意思？代码是否永远挂起？是否抛出异常？大概没有返回有效的数据集。

我希望*会*引发[TimeoutException](http://msdn.microsoft.com/en-us/library/system.timeoutexception.aspx)，但我很惊讶这在您的客户端代码中并不完全明显。你没有吞下异常，是吗？

您是同步还是异步执行调用？如果它是异步的，我希望回调被执行，然后在“EndXxx”调用中抛出异常。

我强烈建议您编写一个简短的控制台应用程序，*它只*调用 Web 服务，看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-22T02:26:36.230

我刚碰到这个。在 .NET 2.0 Web 服务中，它会抛出一个非常不确定`WebException`的 ，只有`Message`属性来区分它：

> 请求被中止：连接意外关闭。

我没有在较新版本的 Visual Studio 中默认生成的基于 WCF 的服务引用中尝试过它，但如果我理解[正确](http://weblogs.asp.net/sujithkjagini/archive/2009/08/24/timeout-exceptions.aspx)，它们会抛出更有用`TimeoutException`的，就像[Jon Skeet](https://stackoverflow.com/questions/362042/what-happens-when-webclientprotocol-timeout-occurs/362093#362093)一样，我会猜到（并且更喜欢) 成为 Web 服务中的行为。

请注意，超时仅适用于同步调用（至少在 Web 服务中；我认为 WCF 服务引用也是如此）。如果您希望异步调用超时，则必须设置一个计时器并手动中止调用，例如[此处](http://spinningtheweb.blogspot.com/2011/02/async-web-service-timout.html)所示。

# mysql - MySQL ENUM 类型与连接表

> ID：362044
> 
> 赞同：68
> 
> 时间：2008-12-12T06:34:36.443
> 
> 标签：mysql, database-design, enums

**我的要求**

一个表需要维护一个*状态*列。

此列代表 5 个州之一。

**初始设计**

我想我可以将其设为整数列并使用数值表示状态。

*   0 = 开始
*   1 = 运行
*   2 = 崩溃
*   3 = 暂停
*   4 = 停止

由于我不希望我的应用程序维护从整数到其字符串描述的映射，因此我计划将它们放在单独的状态描述表中（依赖于 FK 关系）。

然后我发现 MySQL 有一个 ENUM 类型完全符合我的要求。除了直接依赖 MySQL 之外，使用 ENUM 类型是否有任何陷阱？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-12-12T06:45:11.320

*   更改 ENUM 中的一组值需要一个`ALTER TABLE`可能导致表重组的操作 - 一个非常昂贵的操作（如果您只是在 ENUM 定义的末尾添加一个新值，则不会发生表重组，但如果您删除一个，或更改顺序，它会进行表重组）。而更改查找表中的值集就像 INSERT 或 DELETE 一样简单。

*   无法将其他属性与 ENUM 中的值相关联，例如哪些属性已停用，哪些属性可以放入用户界面的下拉列表中。但是，查找表可以包含此类属性的附加列。

*   查询 ENUM 以获取不同值的列表非常困难，基本上需要您从 查询数据类型定义`INFORMATION_SCHEMA`，并从返回的 BLOB 中解析列表。您可以从您的表中尝试`SELECT DISTINCT status`，但这只会获取当前正在使用的状态值，这可能不是 ENUM 中的所有值。但是，如果您将值保存在查找表中，则很容易查询、排序等。

如您所知，我不是 ENUM 的忠实粉丝。:-)

这同样适用于简单地将列与一组固定值进行比较的 CHECK 约束。尽管 MySQL 不支持 CHECK 约束。

更新：MySQL 8.0.16 现在实现了[CHECK 约束](https://dev.mysql.com/doc/refman/8.0/en/create-table-check-constraints.html)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-12T06:51:21.947

这是关于[enum 速度比较的](https://www.percona.com/blog/2008/01/24/enum-fields-vs-varchar-vs-int-joined-table-what-is-faster/)文章。也许它给出了一些提示。恕我直言，它应该仅限于在固定的字符串列表（“是/否”，“儿童/成人”）中使用，99% 的概率在未来不会改变。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-12T14:23:25.783

由于已经解释的原因，MySQL 中的枚举不好。
我可以添加以下事实：枚举不确保在服务器端进行任何类型的验证。如果您插入一个值在枚举定义中不存在的行，您将在数据库中获得一个 nice`<empty>`或`NULL`值，这取决于枚举字段声明的 NULL 能力。

我对 tinyints 的看法：

*   枚举限制为 65535 个值
*   如果您不需要超过 256 个值，则 tinyint 将为每一行占用更少的空间，并且它的行为更加“可预测”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-18T18:23:11.710

如果你的数据库中有很多数据（更多的数据然后你有 RAM）并且你的 ENUM 值永远不会改变，我会选择 ENUM，而不是加入。它应该更快。
想想看，在连接的情况下，您需要一个外键索引和另一个表中主键的索引。正如 Riho 所说，请参阅基准。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T06:38:03.097

一张表会更容易国际化。但是完全在数据库之外的类也是如此。当不在业务逻辑中时，这种检查可能很难调试，并且通常不是数据库人员的责任。

作为一种优化，它可能还为时过早。但无论如何，OP 主要将其作为一种便利功能提出来。

另见[http://komlenic.com/244/8-reasons-why-mysqls-enum-data-type-is-evil/](http://komlenic.com/244/8-reasons-why-mysqls-enum-data-type-is-evil/)

# sql - 使用 Windows Server 2008 + MS SQL 的虚拟专用服务器托管

> ID：362045
> 
> 赞同：-1
> 
> 时间：2008-12-12T06:37:05.593
> 
> 标签：sql, hosting, windows-server-2008, web-hosting, vps

我在stackoverflow上看到这个问题弹出了几次，但还没有找到一个好的解决方案。我正在寻找有关具有 Windows Server 2008 和 MS SQL 数据库功能的虚拟专用服务器托管的建议。

我看到有人建议使用 webhost4life.com、hostmysite.com 和其他网站，但他们不提供 windows server 2008 托管，只有 2003。我还查看了 mosso 和 aspnix.com。Mosso 似乎是一个不错的举措，但希望能找到每月 100 美元以下的东西，而且我在 aspnix.com 上听到了极端混合的评论。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T07:02:26.293

这是我发现的最好的交易：[ASPNix](http://aspnix.com/hosting/virtual-private-server/)

您可能会关注的其他著名 VPS 托管公司：

1.  [VPSLand](http://www.vpsland.com/xlwin.html)
2.  [服务器智力](http://www.serverintellect.com/virtualservers/)
3.  [HostMySite](http://www.hostmysite.com/vps/windows/asp/)
4.  [去吧爸爸](http://www.godaddy.com/gdshop/hosting/virtual.asp?ci=9013&display=virtual)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T07:09:54.280

**更新 2：**自从这在 2008 年发布以来，我已经从 Serverloft ( [http://www.serverloft.com/](http://www.serverloft.com/) ) 切换到专用服务器，在那里我以比 ServerIntellect 共享/VPS 更少的钱获得专用硬件......

* * *

*原答案：*

**更新：**他们目前只为专用服务器提供 Win2008，虚拟服务器都是 2003 ......除此之外：

我正在使用[Server Intellect](http://web.serverintellect.com/10054/10067/)，我对它们**非常满意**。出色的带宽、出色的支持（通常在提交工单后几分钟内响应）等。除了 Windows 和 SQL Server，他们的 VPS 还带有“Helm”（我不使用它）和 SmarterTools 邮件 + 网络统计信息 + 工单系统（我使用所有这些）。

我能想到的唯一 [可能] 负面的事情是他们的备份服务会备份单个文件，因此无法完成“完整系统”映像。（或者上次我问他们时不能——也许从那以后发生了变化）。*完整的系统映像会很整洁，因为如果*服务器死机，这将意味着更快的恢复......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:04:44.707

查尔斯，你目前在使用[ASPNix](http://aspnix.com)吗？就正常运行时间、支持和功能而言，“产品”的表现如何。我目前有[GoDaddy](http://GoDaddy.com)（共享主机），它是可靠的，但是......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T16:20:57.293

KristoferA，除非我遗漏了一些东西[Server Intellect](http://www.serverintellect.com/)不提供虚拟专用服务器托管与 Windows Server 2008 仅 2003

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T06:20:54.683

我想我找到了一个非常有前途的。 [Applied.net](http://www.appliedi.net/windows-vps-hosting/)刚刚推出了用于服务器 2008 的 VPS 包。我还研究了[discountasp.net](http://www.discountasp.net/)，它看起来也可以满足我的目的/应用程序（它们允许您修改我需要的信任级别）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-24T22:24:04.707

[Softsys 托管 - Windows 2008 虚拟专用服务器 - 39 美元](http://www.softsyshosting.com/Windows-VPS-HyperV.aspx)

那是最便宜的之一。

# maven-2 - Setting up a Maven repository using SourceForge's file servers

> ID：362055
> 
> 赞同：13
> 
> 时间：2008-12-12T06:42:11.293
> 
> 标签：maven-2, sourceforge

Is it possible to host a Maven repository that serves the artifacts (at least the jar files) from SourceForge's file release system (since they are already there and SF provides download statistics and such)?

All the repositories I have seen use the same directory layout, but is that a must? Download URLs would have to look more like *[http://sf.net/something.cgi?file-id=1234567](http://sf.net/something.cgi?file-id=1234567)*

There would only be a small number of files in the project, so that maintaining the download URL in some kind of repository metadata XML file semi-manually is still an option.

**Note:** This is kind of the opposite question to [How can I deploy artifacts from a Maven build to the SourceForge File Release System?](https://stackoverflow.com/questions/16487/how-can-i-deploy-artifacts-from-a-maven-build-to-the-sourceforge-file-release-s)

**Clarification:** I want to put the files in the File Release System (Project Downloads), not the project web space or the subversion repository.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T08:48:49.667

Yes you can. But it's a bit convoluted:

If you look at a project like this [http://jwebunit.sourceforge.net/m2-repo/](http://jwebunit.sourceforge.net/m2-repo/) you'll see that they are exposing a perfectly legal maven repo. These are the steps to do it:

Theoretically you could just add the relevant part of your ~/.m2/repo folder to the root of svn on the project in question (in a folder called m-2repo for instance like jwebunit has done). Sourceforge exposes the full svn structure accessible through web, so there's your repo.

But; the problem is that maven requires that remote repositories contain MD5 checksums of all elements. When you run "maven install" towards a lolcal file repo you will not get these checksums generated.

The way I have solved this locally is to set up apache/webdav on a specific folder on my machine. I then use THIS folder as a target for "mvn deploy". Then i just keep this full folder checked into subversion on sourceforge.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-03T14:16:07.607

对此感到抱歉，但我看不到将两个问题联系在一起的方法。我在此处向类似（重复？）问题添加了一些信息。它展示了如何在不需要任何 pom 技巧或插件的情况下将 maven 部署到 SF。

[如何将 Maven 构建中的工件部署到 SourceForge 文件发布系统？](https://stackoverflow.com/questions/16487/how-can-i-deploy-artifacts-from-a-maven-build-to-the-sourceforge-file-release-sys/2187533#2187533)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-13T16:21:27.417

非常好的解决方案，感谢 krosenvold。此外，您可以尝试使用 pom 的这一部分生成校验和：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-install-plugin</artifactId>
    <executions>
        <execution>
            <goals>
                <goal>install</goal>
            </goals>
            <configuration>
                <createChecksum>true</createChecksum>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

# big-o - 什么是嵌套循环的 Big-O，其中内循环的迭代次数由外循环的当前迭代决定？

> ID：362059
> 
> 赞同：59
> 
> 时间：2008-12-12T06:45:52.770
> 
> 标签：big-o, nested-loops

以下嵌套循环的 Big-O 时间复杂度是多少：

```
for (int i = 0; i < N; i++) {
    for (int j = i + 1; j < N; j++) {
        System.out.println("i = " + i + " j = " + j);
    }
} 
```

还会是*O(N^2)*吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-12-12T06:47:20.707

是的，它仍然是 O(n^2)，它有一个较小的常数因子，但这不会影响 O 表示法。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-12-12T07:12:54.353

是的。回想一下 Big-O 的定义：*O(f(n))*根据定义表示某个常数*k的运行时间**T(n)* ≤ *kf(n)*。在这种情况下，步数将为*(n-1)+(n-2)+...+0*，重新排列为 0 到 n-1 的总和；这是

 ***T(n)=(n-1)((n-1)+1)/2*。

重新排列，你可以看到*T(n)*总是 ≤ 1/2(n²)；根据定义，因此*T(n) = O(n²)*。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-12T07:22:21.370

如果忽略 System.out.println，它是 N 平方。如果您假设所花费的时间在其输出中是线性的（当然可能不是），我怀疑您最终会得到 O ( (N^2) * log N)。

我提到这并不是挑剔，而是要指出，在计算复杂性时，您不仅需要考虑明显的循环 - 您还需要查看所调用内容的复杂性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-12T06:49:17.287

是的，它将是 N 平方。如果我没记错的话，实际的步数是 1 到 N 的总和，即 0.5*(N - 1)^2。大 O 只考虑最高指数而没有常数，因此，这仍然是 N 平方。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-05-14T09:15:53.887

如果你有 N = 10，你的迭代将是：10+9+8+7+6+5+4+3+2+1。（这是：十次迭代加上九次迭代加上八次迭代......等等）。

现在，您需要在加法中找出可以得到 N 的次数（示例中为 10）：

1:(10)、2:(9+1)、3:(8+2)、4:(7+3)、5:(6+4)。这是5次......并且休息5次迭代。

现在你知道你有五个十 + 5：

10(5) + 5

就 f(n)（或 N）而言，我们可以很容易地看到这将是：

f(n) = n(n/2) + n/2 = (n^2)/2 + n/2 = (n^2 + n)/2... 这正是这些嵌套循环的复杂性。

但是，考虑到大 O 的渐近行为，我们可以去掉 f(n) 的不太重要的值，即单个 n 和分母。

结果：O(n^2)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-12-15T03:10:10.123

对于给定的程序：

```
for (int i = 0; i < n; i++)
    for (int j = i; j < n; j++)
        println(...); 
```

考虑 n = 3：

`i`将具有值 0、1 和 2。

```
For i = 0: println will execute 3 times
for i = 1: println will execute 2 times
for i = 2: println will execute 1 times 
```

因此该`println`函数将执行 3 + 2 + 1 次，即 n(n+1)/2 次。

因此 O(n(n+1)/2) = O(n^2)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-03-29T05:21:47.423

AFAIL，从内部循环开始到外部循环是计算嵌套循环复杂度的充分方法。 [![在此处输入图像描述](https://i.stack.imgur.com/ExYmU.png)](https://i.stack.imgur.com/ExYmU.png)

# c - Windows not sizable and without caption

> ID：362066
> 
> 赞同：0
> 
> 时间：2008-12-12T06:49:36.770
> 
> 标签：c, winapi

I want to to create a window **not sizable** and without caption like vista sndvol.exe [DlgSimpleVolume](http://img530.imageshack.us/img530/4871/vistasndbf8.png "DlgSimpleVolume")

[![alt text](https://i.stack.imgur.com/2eDda.png "DlgSimpleVolume")](https://i.stack.imgur.com/2eDda.png "DlgSimpleVolume")

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T07:07:49.200

在 CreateWindowEx 中使用 WS_EX_DLGMODALFRAME 样式，不要设置 WS_CAPTION。阅读有关可能样式的手册

# sharepoint - 如何在共享点页面上更改样式，以便我在访问数据表视图中的数据可见

> ID：362078
> 
> 赞同：0
> 
> 时间：2008-12-12T06:59:36.737
> 
> 标签：sharepoint, ms-access, wss-3.0

如何在共享点页面上更改样式，以便我在访问数据表视图中的数据可见

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T09:26:31.977

解决了问题，只需要更改页面属性并且它可以工作。现在数据表可见，其中的数据为黑色

# usability - 争论可用性和“漂亮”

> ID：362096
> 
> 赞同：2
> 
> 时间：2008-12-12T07:16:04.050
> 
> 标签：usability, arguments

作为一名 UI 人员（编码和设计用户界面），我经常发现自己处于奇怪的境地，与程序员和其他“外行”争论用户界面的质量。

我发现争论颜色、图标或布局之类的事情有些困难，而且似乎没有事实对错。但是仍然 - 在没有令人信服的论点的情况下，我仍然知道（即感觉）有时解决方案是错误的。您对此有何看法？您是否让昂贵的可用性测试来决定甚至是客户？您是否接受过可用性工程方面的教育？你知道传递论点的好书（比如 Joel Spolsky 的“程序员用户界面设计”）吗？你会避免这样的讨论吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T07:27:45.307

最终客户做出决定，因为客户支付了账单。然而，客户通常会付钱给我，因为他们相信我拥有他们不具备的技能和能力。通常，我会尝试向他们解释为什么我认为从设计的角度来看，特定的布局或颜色选择是有意义的。如果我有足够好的理由，超出个人喜好，那通常可以解决问题。如果没有，那我就走客户的路。有时，如果我知道客户真的会讨厌他们“想要”的东西，我会完全避免争论/讨论，按照他们的方式去做，让他们告诉我把它改回来。

我要说的一件事。通常这些讨论最终会得到比我原来的更好的第三种解决方案。被迫真正考虑我的选择来捍卫它们通常会导致我思考解决问题的方法，这些方法比原始设计更好地解决了客户的观点。

就配色方案而言，您总是希望有一个有品味的客户。可悲的是，这并不总是发生。而且，是的，有时我不得不整合一个解决方案，但由于这个原因，它没有进入我的投资组合。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T07:26:00.270

[Edward Tufte](http://www.edwardtufte.com/)总是一个很好的来源。Mark Miller为[.Net Rocks做了一个](http://www.dotnetrocks.com/default.aspx)[播客](http://www.dotnetrocks.com/default.aspx?showNum=338)和一个关于这个的[截屏视频！](http://dnrtv.com/default.aspx?showID=112). 他实际上进入了 UI 原则背后的科学，比如最小有效差异原则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T07:41:44.467

我的很多客户都很小。他们没有钱请可用性/UI 专家，所以我们应得的。他们了解我的局限性，我们都尽最大努力将一点常识带到桌面上——了解我们正在构建足够好的与最好的（UI 方面）。

根据我的经验，大客户对内部应用的态度是一样的。只有当你建造一些东西来销售时，人们才会愿意在这个问题上花费额外的钱。

就我自己而言，我相信没有充分的理由完全无知。我确实花一点时间阅读和推杆。我找到了很好的材料：

*   [史蒂夫克鲁格](http://www.sensible.com/)- 他的书，[别让我思考！](https://rads.stackoverflow.com/amzn/click/com/0789723107)，是老化，但仍然相当不错。
*   [Donald Norman](http://www.jnd.org/) - 写的不仅仅是 UI 设计。他让你看到和思考无处不在的设计。
*   [雅各布尼尔森](http://www.useit.com/)- 可能有点极端。不过，他也不是白痴。他对设计（尤其是网页设计）进行了很多思考，并做出了一些很好的观察。

# algorithm - 无向图中的路径

> ID：362102
> 
> 赞同：2
> 
> 时间：2008-12-12T07:21:35.990
> 
> 标签：algorithm, graph-theory

给定一个无向图 G = (V, E) 和两个顶点 s, t ∈ V。我们考虑 s 和 t 之间的简单路径。如果每个顶点最多访问一次，则路径很简单。

~~以下是 P 或 NP 完全的吗？~~

以下是否存在有效的算法多项式时间？

“n”表示图“V”中的顶点数

1.  是否有一条从 s 到 t 长度最多为 n/100 的简单路径？
2.  是否有一条从 s 到 t 长度至少为 n/100 的简单路径？
3.  是否有一条从 s 到 t 长度正好为 n/100 的简单路径？
4.  从 s 到 t 是否有两条边不相交的路径？（如果两条路径不共享边，则称它们是边不相交的。）

我的想法（如果我错了，请纠正我）感谢您的意见。

1.  我想我可以运行 Dijkstra 算法以在多项式时间内找到 S 和 T 之间的最短路径。所以问题 1 在 P 中。
2.  我认为有必要列举从 s 到 t 的所有简单路径。我不知道它的运行时间是多少，但我认为它会比多项式更糟糕。
3.  类似于上面的2。没有多项式算法。
4.  我不知道。我不知道有什么有效的（多时间算法）可以在两个节点之间找到多条路径，但这并不意味着它们不存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T07:36:03.260

你在正确的轨道上。我写了[另一篇关于 NP-complete](https://stackoverflow.com/questions/308213/explaining-computational-complexity-theory#309507)的文章，我将向您介绍一些细节，但请记住，基本上您需要做两件事来证明 NP-complete：

1.  显示问题出在 NP 中
2.  显示一个已知为 NP 完全问题的多项式时间缩减。

做 1 很容易（如果走图的东西“知道”下一条要采取的所有正确决定，它会在多项式时间内找到答案吗？）；我会认真考虑我在另一篇笔记中描述的“决策 TSP”问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T13:56:38.400

我想出了什么：

1.  和你说的一样，使用任何适用的 SPP 算法。
2.  这是最长的路径决策问题，即使对于未加权的图也是 NP-Hard。
3.  对于未加权图，线性数量的应用程序足以解决 2，因此它也是 NP-Hard。
4.  您可以使用具有单位容量的最大流算法来查找边缘不相交路径的最大数量。

# asp.net - 在 dropdown_SelectedIndexChanged 事件 ASP.Net,C# 下获取 DataGrid 的 SelectedRow

> ID：362104
> 
> 赞同：0
> 
> 时间：2008-12-12T07:22:56.517
> 
> 标签：asp.net, drop-down-menu

我有一个模板列，我在其下放置了一个下拉列表。现在我想在模板列内的下拉列表的 selectedIndeChanged 事件上获取数据网格的 selectedRow

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T08:03:13.223

您可以通过查看包含下拉列表的 DataGridItem 来获取数据网格中项目的索引。

假设您的 DropDownList 直接在 TemplateColumn 中并且没有被其他元素包裹，那么以下示例显示了如何执行此操作：

```
 protected void DropDown_SelectedIndexChanged(object sender, object eventdata)
    {
        int gridRowIndex = ((DataGridItem)((DropDownList)sender).Parent.Parent).ItemIndex;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T08:11:22.707

DataGrid1.SelectedIndex 有帮助吗？

DataGrid1 = 作为页面上 DataGrid 控件名称的变量的名称。

# ruby - 如何排序不简单的散列（散列的散列）

> ID：362105
> 
> 赞同：5
> 
> 时间：2008-12-12T07:23:37.933
> 
> 标签：ruby, sorting, hash

我有一个像这样的哈希

```
{ 55 => {:value=>61, :rating=>-147},
  89 => {:value=>72, :rating=>-175},
  78 => {:value=>64, :rating=>-155},
  84 => {:value=>90, :rating=>-220},
  95 => {:value=>39, :rating=>-92},
  46 => {:value=>97, :rating=>-237},
  52 => {:value=>73, :rating=>-177},
  64 => {:value=>69, :rating=>-167},
  86 => {:value=>68, :rating=>-165},
  53 => {:value=>20, :rating=>-45}
} 
```

我如何通过***:rating***对其进行排序？或者也许我应该使用一些不同的结构？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T12:53:48.273

我会将数据结构更改为哈希数组：

```
my_array =
[
  {:id => 78, :value=>64, :rating=>-155},
  {:id => 84, :value=>90, :rating=>-220},
  {:id => 95, :value=>39, :rating=>-92}
] 
```

您可以轻松地对这种结构进行排序

```
my_array.sort_by { |record| record[:rating] } 
```

要获得通过 id 获取记录的类似哈希的功能，您可以在 my_array 上定义一个新方法：

```
def my_array.find_by_id(id) 
  self.find { |hash| hash[:id] == id }
end 
```

所以在那之后你可以做

```
my_array.find_by_id(id) 
```

代替

```
my_hash[id] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T07:43:34.277

Ruby 中的哈希不能排序（至少在 1.9 之前不能）

这意味着遍历 Hash 不一定会以正确的顺序为您生成信息。但是，通过首先将哈希数据转换为数组来以特定顺序循环遍历哈希数据是微不足道的，实际上调用哈希上的排序方法会将其转换为数组：

```
>> { :a => 4, :b => 12, :c => 3, :d => 8 }.sort_by { |key, value| value }
=> [[:c, 3], [:a, 4], [:d, 8], [:b, 12]] 
```

所以在你的情况下：

```
hsh.sort_by {|key, ratings| ratings[:rating] } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T07:44:30.297

可能有更好的数据结构，但是（我假设这是 ruby​​）可以通过使用内联排序样式在 Ruby 中完成，基本上告诉它如何比较两者。这是一个具体的例子：

```
my_hash = { 
  55 => {:value=>61, :rating=>-147},
  89 => {:value=>72, :rating=>-175},
  78 => {:value=>64, :rating=>-155},
  84 => {:value=>90, :rating=>-220},
  95 => {:value=>39, :rating=>-92},
  46 => {:value=>97, :rating=>-237},
  52 => {:value=>73, :rating=>-177},
  64 => {:value=>69, :rating=>-167},
  86 => {:value=>68, :rating=>-165},
  53 => {:value=>20, :rating=>-45}
}

puts "MY HASH"
my_hash.each do |local|
  puts local
end

sorted_hash = my_hash.sort  { | leftval, rightval | rightval[1][:rating]<=>leftval[1][:rating] }

puts "SORTED HASH"
sorted_hash.each do |local|
  puts local
end 
```

# history - 在有网络/应用程序服务器之前，人们是如何建立网站的？

> ID：362111
> 
> 赞同：4
> 
> 时间：2008-12-12T07:28:05.990
> 
> 标签：history

我刚刚阅读了 Joel Spolsky 的文章，[没有芭蕾舞短裙的 Up the tata](http://www.joelonsoftware.com/articles/fog0000000026.html)，Joel 说，

> 在那些日子里，没有应用程序服务器。

和

> 那时真的没有任何其他应用服务器。

那么基本上，当时人们是如何编写网络应用程序的？他们是否编写了自己的 Web 服务器和应用服务器实现？公司是什么时候开始推出像 Tomcat、JBoss 等“标准”网络/应用服务器的？如果有的话，人们也可以分享任何与此相关的轶事吗？网站链接也很感激......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T07:47:23.283

啊，这把我带回来了。是的，第一个 Web 应用程序需要编写自己的 Web 服务器。第一个，比如[CERN HTTPd](http://en.wikipedia.org/wiki/CERN_HTTPd)，其中的程序非常简单：它们在端口上侦听基本连接请求，解析文件路径，并返回一个静态文件。

不久之后，人们想出了如何从生成 HTML 文件的 HTTP 守护进程中 fork/exec 一个程序，而不是从静态文件中提供它。其中一些是简单的 C 程序；Perl 也变得流行起来。但是像银行系统这样的东西（我在其中一个工作过）会在会话开始时分叉程序，然后通过像[CICS](http://en.wikipedia.org/wiki/CICS)这样的东西连接到现有的后端来获取数据，然后使用像 fprintf 这样的东西生成输出来发送文本到套接字连接。

当人们意识到他们正在编写需要与后端“数据层”或“持久层”*以及*前端 Web 服务器通信的重复代码块时，应用服务器实际上已经到来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T07:39:14.893

您的 Web 服务器会调用 CGI 脚本，通常（根据我的经验）用 Perl 或 C 编写。

我的网站上还有一些基于 C 的 Web 应用程序，包括一个相当原始的论坛系统。回首往事，这是相当痛苦的事情——但它奏效了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T07:46:09.793

人们拥有 Web 服务器，但没有我们今天所理解的应用程序服务器。早期的网站是静态 HTML，后来出现了 CGI，它允许您将程序（通常是 perl 或 C）的 HTML 输出发送到用户的浏览器。

# mysql - 当自动递增列用完时会发生什么？

> ID：362112
> 
> 赞同：25
> 
> 时间：2008-12-12T07:28:08.083
> 
> 标签：mysql, database-design

考虑一个带有自动增量列的简单表，如下所示：

```
CREATE TABLE foo 
(
  `fooid` bigint unsigned NOT NULL auto_increment,
   ....snipped.... other columns
  PRIMARY KEY (`fooid`)
) 
ENGINE=InnoDB AUTO_INCREMENT=10 
```

如何重新设计它，以免我们达到 bigint 数据类型的最大值？无符号范围是 0 到 18446744073709551615。我不知道需要多长时间才能达到 18446744073709551615，但就像 Y2K 问题一样，我想为此做好准备。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-12-12T07:34:01.377

假设您每毫秒插入一行。

18446744073709551615 毫秒 = 18446744073709552 秒 = 307445734561826 分钟 = 5124095576030 小时 = 213503982335 天 = 584942417 年

所以这不是*千年虫*问题

您可以每毫秒插入一*百万*行，并且仍然可以使用 500 多年。

换句话说：别担心。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-12T11:02:44.297

根据您使用的[SQL 模式](http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html)`AUTO_INCREMENT`，当数值列的值超出范围时，MySQL 会执行两种操作之一。无论哪种情况，您都会收到错误，但原因不同。

在**严格模式下**，MySQL 拒绝超出范围的值，抛出无效值错误，然后`INSERT`失败。在默认的**非严格模式下**，MySQL 将值减小到数据类型允许的最大值，并执行`INSERT`. 但是`INSERT`失败是因为该`AUTO_INCREMENT`属性已导致所有可能的值都已使用，并且您收到此错误（无符号`SMALLINT`示例）：

```
MySQL said:

#1062 - Duplicate entry '65535' for key 1 
```

对于`BIGINT`此处的示例，将“65535”替换为 18 quintillion，尽管在生产数据库上不太可能发生此错误。

但是如果您低估了应用程序生命周期内可能的键值（s 的数量），那么使用`TINYINT`s 和`SMALLINT`s 很容易发生这种情况。`INSERT`想象一下，您正在对代码进行更改并测试您的数据是否正确插入。突然，您的应用程序因上述错误而退出工作。您将更改回滚到已知良好的代码，但错误不会消失......非常令人沮丧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T11:08:02.303

不了解 MySQL，但在[Postgresql](http://www.postgresql.org/docs/8.1/static/sql-createsequence.html)的情况下，您可以指定序列是 CYCLE/NO CYCLE。如果使用 CYCLE 选项创建，它将再次返回 1（或最小值）并抛出重复键的错误。

# c++ - 在某些东西本身变得线程安全之前，您要走多低？

> ID：362113
> 
> 赞同：7
> 
> 时间：2008-12-12T07:28:49.873
> 
> 标签：c++, multithreading, thread-safety

我一直在想，在某些东西自动成为线程安全之前，你必须深入到什么程度？

快速示例：

```
int dat = 0;
void SetInt(int data)
{
    dat = data;
} 
```

.. 这种方法会被认为是线程安全的吗？我通常将我所有的 set-methods 包装在互斥体中，只是为了确定，但每次我这样做时，我不禁认为这是一种无用的性能开销。我想这一切都分解为编译器生成的程序集？线程什么时候能够闯入代码？每个汇编指令或每个代码行？线程可以在方法堆栈的设置或销毁期间中断吗？像 i++ 这样的指令会被认为是线程安全的吗？如果不是，那么 ++i 呢？

这里有很多问题-我不希望直接回答，但是有关该主题的一些信息会很棒:)

[更新] 因为我现在很清楚（谢谢你们 <3），线程中唯一保证原子的东西是汇编指令，我知道我开始思考：互斥锁和信号量包装类呢？像这样的类通常使用制作调用堆栈的方法 - 并且通常使用某种内部计数器的自定义信号量类不能保证是原子/线程安全的（无论你想怎么称呼它，只要你知道我的意思，我不在乎： )

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T10:34:45.677

考虑因素：

1) 编译器优化——“dat”是否按您的计划存在？除非它是“外部可观察”的行为，否则 C/C++ 抽象机不保证编译器不会对其进行优化。您的二进制代码中可能根本没有“dat”，但您可能正在写入寄存器，并且线程将/可能具有不同的寄存器。在抽象机器上阅读 C/C++ 标准，或者简单地在谷歌上搜索“volatile”并从那里进行探索。C/C++ 标准关心单线程的健全性，多线程很容易绊倒这种优化。

2）原子存储。任何有可能跨越单词边界的东西都不是原子的。Int-s 通常是，除非您将它们打包到具有例如字符的结构中，并使用指令来删除填充。但是你每次都需要分析这个方面。研究你的平台，谷歌搜索“填充”。请记住，不同的 CPU 有不同的规则。

3）多CPU问题。你在 CPU0 上写了“dat”。甚至会在 CPU1 上看到更改吗？或者你会写到本地寄存器吗？缓存？缓存是否与您的平台保持一致？访问是否保证井井有条？阅读“弱内存模型”。Gogle 搜索“memory_barriers.txt Linux”——这是一个好的开始。

4）用例。您打算在分配后使用“dat” - 这是同步的吗？但我想这是显而易见的。

通常，“线程安全”不仅仅保证一个函数在同时从不同线程调用时可以工作，但这些调用不能相互依赖，即它们不交换关于该调用的任何数据。例如，您从 thread1 和 thread2 调用 malloc() 并且它们都获得内存，但它们不访问彼此的内存。

一个反例是 strtok() ，它不是线程安全的，并且会在不相关的调用上达到平衡。

一旦您的线程开始通过数据相互通信，通常的线程安全性并不能保证太多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T07:33:08.757

通常，线程上下文切换可以在任意两个汇编语言指令之间的*任何时间发生。*CPU 完全不知道汇编语言如何映射到您的源代码。此外，对于多个处理器，其他指令可以同时在不同的 CPU 内核上执行。

话虽如此，在示例中，您将 CPU 大小的字分配给内存位置通常是原子操作。这意味着从观察者（另一个线程）的角度来看，分配尚未开始，或者已经完成。没有中间状态。

多处理有许多微妙之处，因此最好了解您正在工作的硬件和操作系统环境的可能性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T07:54:09.870

线程状态可以在任意两条机器指令之间改变。如果计算机能够在单个机器指令中执行分配，那么分配在单处理器机器上应该是线程安全的。一般来说，假设赋值右侧的计算结果可以在单个指令中计算并存储在赋值左侧指定的位置是不安全的。在某些处理器上，可能没有可用的内存到内存复制指令，并且可能需要先将数据加载到寄存器中。如果上下文切换发生在加载和存储指令之间，那么赋值的结果是不确定的（不是线程安全的）。这就是为什么大多数指令集都包含原子测试和设置操作的原因之一，该操作允许您将内存位置用作锁。这允许其他线程检查锁的可用性并等待继续，直到获得锁。

在您的情况下，我不确定操作是否在硬件级别以线程安全的方式完成是否重要，因为执行分配的多个竞争线程的结果只是让其中一个线程最后完成存储并且“赢”。但是，如果您在右侧执行任何类型的计算，涉及使用多个变量的计算，那么我肯定会将其放在关键部分，因为您希望计算结果与状态一致计算开始时的那些变量。如果不在关键部分，变量的值可能会在另一个线程的中途更改，您最终可能会得到任何一个线程都不可能的结果。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T08:59:19.193

“本机”数据类型（32 位）的分配在大多数平台（包括 x86）上是原子的。这意味着分配将完全发生，并且您不会冒“中途更新” dat 变量的风险。但这是你得到的唯一保证。

我不确定双数据类型的分配。您可以在 x86 规范中查找它，或者检查 .NET 是否做出任何明确的保证。但一般来说，不是“本机大小”的数据类型不会是原子的。甚至更小的，比如 bool 可能不会（因为要写一个 bool，你可能必须读取整个 32 位字，覆盖一个字节，然后再次写入整个 32 字节字）

一般来说，线程可以在任意两条汇编指令之间中断。这意味着只要您不尝试从 dat*读取*，您上面的代码就是线程安全的（您可能会争辩说，这使得它相当无用）。

原子性和线程安全并不是一回事。线程安全完全取决于上下文。您对 dat 的分配是原子的，因此读取 dat 值的另一个线程将看到旧值或新值，但永远不会看到“介于两者之间”的值。但这并不能使它成为线程安全的。另一个线程可能会读取旧值（比如数组的大小），并基于该值执行操作。但是您可能会在读取旧值后立即更新 dat，也许将其设置为较小的值。另一个线程现在可能会访问您的新的、更小的数组，但相信它具有旧的、更大的大小。

i++ 和 ++i*也不*是线程安全的，因为它们由多个操作（读取值、递增值、写入值）组成，通常，任何同时包含读取和写入的操作都不是线程安全的。线程也可以在为函数调用设置调用堆栈时被中断，是的。在*任何*汇编指令之后。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T07:35:32.827

确保某些东西自动成为线程安全的唯一方法是确保不存在可变的共享状态。这就是如今函数式编程越来越受欢迎的原因。

所以，如果你所有的线程共享 X，那么你必须确保 X 不会改变。任何发生变化的变量都必须是该线程的本地变量。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-12T08:02:45.063

这**不是**线程安全的，它最终并不适用于所有类型的情况。

假设**dat**变量保存数组中元素的计数。另一个线程开始使用**dat**变量扫描数组，并缓存其值。同时，您更改**dat**变量的值。另一个线程再次扫描数组以进行其他操作。另一个线程是使用旧的**dat**值还是新的？我们不知道，也不能确定。根据模块的编译，它可能会使用旧的缓存值或新的值，这两种情况都是麻烦的。

您可以在另一个线程上显式缓存**dat变量的值以获得更可预测的结果。**例如，如果这个**dat**变量持有一个超时值，而您只写入这个值而另一个线程读取，那么我在这里看不到问题。即使是这样，你也不能说这是线程安全的**！！！**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T09:04:23.520

好吧，我不相信一切都必须是线程安全的。由于使代码线程安全会在复杂性和性能方面付出代价，因此在实现任何内容之前，您应该问自己代码是否需要线程安全。在许多情况下，您可以将线程感知限制在代码的特定部分。

显然，这需要一些思考和计划，但编写线程安全代码也是如此。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T08:11:02.973

Increment operation isn't thrad safe on x86 processors because it is not atomic. On windows you need to call InterlockedIncrement functions. This function generate full memory barier. Also you can use tbb::atomic from intel threading building blocks(TBB) library.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-12T10:45:48.340

有很多关于事务性记忆的研究。
类似于数据库事务的东西，但粒度要细得多。

从理论上讲，这允许多个线程读/写对一个对象做任何他们喜欢的事情。但是对象上的所有操作都是事务感知的。如果一个线程修改了一个对象状态（并完成了它的事务），所有其他在该对象上有打开事务的线程都将自动回滚并重新启动。

这是在硬件级别完成的，因此软件不需要涉及与锁定相关的问题。

不错的理论。不能等待它成为现实。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2008-12-12T08:10:29.103

The above code is threadsafe!

The main thing to look out for is static (i.e.shared) variables.

These are not thread safe unless update is managed by some sort of locking machanism such as a mutex. The same obviously applies to any OS provided shared memory.

So as long as your code has no static data it will be thread safe in itself.

You then need to check whether any libraries or system calls you use are thread safe. This is stated explicitly in the documentation of most system calls.

# winforms - 字体家族问题

> ID：362120
> 
> 赞同：0
> 
> 时间：2008-12-12T07:34:27.367
> 
> 标签：winforms

为什么 Font 对象的 FontFamily 参数是字符串而不是枚举？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T07:47:28.697

FontFamily 是指字体的名称。虽然您可以使用“等宽”或“衬线”，但我认为 .Net 不会支持它。

请记住，使用枚举是不可能的。枚举是静态编译时特性，这意味着它不能从系统上的字体动态“生成”枚举。事实上，在语言中包含任何这种特定的东西可能是一个糟糕的主意。即使支持这一点，用户的机器也不会使用与您相同的字体 - 某些字体会错误地包含在列表中，而某些字体会被排除在外（因为一旦编译，枚举就会变成“最终”）。

枚举是整数常量的方便存储，没有别的。枚举中的每个项目都有一个方便的名称和值，即使您没有指定它。以下两个枚举是相同的。

```
public enum MyEnum
{
  A = 1,
  B = 2
}

public enum FooEnum
{
  A,
  B
} 
```

还有另外两个问题，枚举名称不能包含空格，而字体名称可以。从枚举中获取字段并不是一项简单的任务（它需要大量的反射代码）。

以下代码将为您提供字体列表（您需要添加 System.Drawing 作为参考）：

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Drawing.Text;
    using System.Drawing;

    namespace ConsoleApplication19
    {
        class Program
        {
            static void Main(string[] args)
            {
                InstalledFontCollection ifc = new InstalledFontCollection();

                foreach (FontFamily o in ifc.Families)
                {
                    Console.WriteLine(o.Name);
                }
                Console.ReadLine();
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T07:38:49.247

因为 Enum 是一组固定值，当它发生变化时会强制重新编译（在这种情况下，这最终意味着：框架的新版本）。

字体系列可能会发生变化，可用字体因主机系统而异。

# sql - SQL 查询建议 - 获取以前的客户订单

> ID：362121
> 
> 赞同：1
> 
> 时间：2008-12-12T07:35:31.657
> 
> 标签：sql, sql-server

我有下表

```
custid ordid 数量 日期 已售出
1 A2 12 2008-01-05
2 A5 5 2008-01-02
1 A1 5 2008-01-01
2 A7 3 2007-02-05

```

为每位客户获取先前订单的最佳方式是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T07:48:34.717

如果“以前的”是指“最新的之前的”：

```
SELECT TOP 1
  ordid
FROM
  orders
WHERE
  custid = @custid
  and datesold < (SELECT MAX(datesold) FROM orders i where i.custid = orders.custid)
ORDER BY
  datesold DESC 
```

当然`datesold`，它必须是具有足够不同值的 DATETIME 才能正常工作。仅约会是不够的。例如，如果您有一个记录创建日期，这将是一个很好的替代`datesold`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T07:46:32.383

此类问题的常见解决方案是选择 Max(datesold) 并以这种方式获取最新的。如果 custid/datesold 组合是唯一的，这是可以的，但如果同一天有两个订单，则可能会导致重复。

如果您有 SQL 2005 或更高版本，则可以使用 Row_Number 函数对每个客户订单进行排名并为每个订单选择第一个：

```
SELECT custid, ordid, qty, datesold
FROM (
    SELECT *, 
        Row_Number() OVER (PARTITION BY custid ORDER BY datesold desc) as 'Rank'
    FROM tbl
)
WHERE Rank = 1 
```

为确保它始终选择相同的项目，即使它们具有相同的销售日期，请在 Row_number 的 ORDER BY 子句中添加更多项目（例如 RowID、recieptNumber）。

如果你没有 SQL 2005，通过添加标识列可以做类似的事情：

```
SELECT custid, ordid, qty, datesold
FROM tbl
WHERE id = 
    (SELECT TOP 1 id FROM tbl a WHERE custid = a.custID ORDER BY dateSold) 
```

这样做的缺点是，如果不是每一行，至少每个客户都会有一个表查找。

如果您很幸运希望处理最新的订单，您可以：

```
SELECT custid, ordid, qty, datesold
FROM tbl
INNER JOIN (
    SELECT a.id FROM tbl a GROUP BY tbl.custId
) s ON tbl.id = s.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T07:50:08.443

假设：销售日期将按升序排列（前一个订单的日期将小于当前日期）

假设您想在 A5 之前为客户 2 获取订单。这是查询的方式。

```
 SELECT TOP 1 *
FROM Orders
WHERE DateSold < (SELECT DateSold FROM Orders WHERE CustId = 2 and OrdID = A5)
AND CustId = 2 

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T12:48:57.317

这与您提出的另一个问题非常相似。

```
SELECT
     T1.ordid
FROM
     dbo.Sales T1
INNER JOIN dbo.Sales T2 ON
     T2.custid = T1.custid AND
     T2.datesold > T1.datesold
LEFT OUTER JOIN dbo.Sales T3 ON
     T3.custid = T1.custid AND
     T3.datesold > T1.datesold AND
     T3.datesold < T2.datesold
WHERE
     T1.custid = @custid AND
     T3.custid IS NULL 
```

关于具有相同日期值的行的相同警告。

# c# - 发生异常时如何跟踪所有局部变量

> ID：362124
> 
> 赞同：12
> 
> 时间：2008-12-12T07:36:52.073
> 
> 标签：c#, .net, exception, logging

当方法中发生异常时，有什么通用方法可以跟踪/记录所有局部变量的值？（在 C# 3 中）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-17T08:00:49.733

答：使用 PostSharp（策略注入），XTraceMethodBoundary 属性，覆盖 OnException 。这会记录所有方法输入和返回参数的类型和值。我修改了 PostSharp 以添加一个简单的方法来记录参数。不完美但足够好

```
private static void TraceMethodArguments(MethodExecutionEventArgs eventArgs)
{
    object[] parameters = eventArgs.GetReadOnlyArgumentArray();

    if (parameters != null)
    {
        string paramValue = null;
        foreach (object p in parameters)
        {
            Type _type = p.GetType();
            if (_type == typeof(string) || _type == typeof(int) || _type == typeof(double) || _type == typeof(decimal))
            {
                paramValue = (string)p;
            }
            else if (_type == typeof(XmlDocument))
            {
                paramValue = ((XmlDocument)p).OuterXml;
            }
            else
            { //try to serialize
                try
                {
                    XmlSerializer _serializer = new XmlSerializer(p.GetType());
                    StringWriter _strWriter = new StringWriter();

                    _serializer.Serialize(_strWriter, p);
                    paramValue = _strWriter.ToString();
                }
                catch
                {
                    paramValue = "Unable to Serialize Parameter";
                }
            }
            Trace.TraceInformation("[" + Process.GetCurrentProcess().Id + "-" + Thread.CurrentThread.ManagedThreadId.ToString() + "]" + " Parameter: " + paramValue);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-12T07:47:30.507

你不能，基本上。反射使您可以获取*实例*（和静态）变量，但是如果您想记录局部变量，则必须明确地这样做。使用分析 API 可能会做得更好，但这将是一个非常极端的步骤。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T08:24:35.503

您可以对进程进行内存转储，因为它同时捕获了堆和堆栈，但是由于您将问题标记为日志记录，我认为这不是您要寻找的。

但是，您可以通过确保您的方法总是小而中肯来减少对这些信息的需求。这将产生更有用的堆栈跟踪，并将限制要检查的本地人的数量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T08:28:01.690

使用[MiniDumpWriteDump](http://msdn.microsoft.com/en-us/library/ms680360(VS.85).aspx)在异常点创建进程的内存转储。您将不得不 P/Invoke 它。

# language-agnostic - 编写光线追踪器的文献和教程

> ID：362140
> 
> 赞同：35
> 
> 时间：2008-12-12T07:45:59.653
> 
> 标签：language-agnostic, graphics, raytracing

我有兴趣找到关于编写光线追踪器的书籍的建议、可以在网络上看到的简单而清晰的光线追踪实现以及关于介绍性光线追踪的在线资源。

理想情况下，该方法将是增量式和教程式的，并从基础开始解释编程技术和基础数学。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-12T10:00:43.813

凯文·萨芬 (Kevin Suffern) 的“从头开始的光线追踪”，用于入门。

Matt Pharr 和 Greg Humphreys 的“基于物理的渲染”，当您熟悉了基础知识后，可以更深入地了解它。

如果您真正了解它，那么[光线追踪新闻](http://tog.acm.org/resources/RTNews/html/)档案是一本不错的读物。[此外， ompf2.com 论坛上](http://ompf2.com/)还有很多光线追踪爱好者。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-12T20:23:07.760

好的，我自己还没有找到任何完美的答案，从最基本的开始；然而，我发现了很多简单的光线追踪器，以及大量教科书和学术参考资料的指针。

我没有尝试过这些光线追踪器，但它们看起来既有趣又简单。

[http://www.barakcohen.co.il/2008/10/ray-tracing-simple-java-open-source.html](http://www.barakcohen.co.il/2008/10/ray-tracing-simple-java-open-source.html)

[http://blogs.msdn.com/lukeh/archive/2007/04/03/a-ray-tracer-in-c-3-0.aspx](http://blogs.msdn.com/lukeh/archive/2007/04/03/a-ray-tracer-in-c-3-0.aspx)

[http://www.ffconsultancy.com/languages/ray_tracer/](http://www.ffconsultancy.com/languages/ray_tracer/)

来自 ACM Cross Roads 学生杂志

[http://www.acm.org/crossroads/xrds3-4/raytracing.html](http://www.acm.org/crossroads/xrds3-4/raytracing.html)

C++ 中的这个至少很短；为了速度而失去了简单

[http://ompf.org/ray/sphereflake/](http://ompf.org/ray/sphereflake/)

关于光线追踪某些方面的博士论文在[这里](http://graphics.cs.uni-sb.de/~benthin/final.pdf)

关于 DevMaster 的系列文章在[这里](http://www.devmaster.net/articles/raytracing_series/part1.php)

OMPF 论坛必读系列帖子可以在[这里找到](http://ompf.org/forum/viewtopic.php?f=3&t=9)

听起来我需要的是[“光线追踪简介”一](http://www.glassner.com/andrew/writing/books/irt.htm)书；-)，作者的主页是[这里更多](http://www.glassner.com/andrew/cg/graphics.htm)与图形相关的编程。

[从头开始的](http://www.raytracegroundup.com/downloads.html)光线追踪也包括可下载的光线追踪器源代码。

[MiniLight](http://www.hxa.name/minilight/)是一个最小的全局照明渲染器。

[SmallPT](http://kevinbeason.com/smallpt/)是一个全局光照渲染器，采用 99 行 C++ 语言，在[OpenCL](http://davibu.interfree.it/opencl/smallptgpu/smallptGPU.html)中的 CPU 和 GPU 上使用单精度浮点数。

感谢其他海报的指点

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-16T16:47:23.367

我在大学上的[高级渲染课程](http://rivit.cs.byu.edu/655/)有我见过的最好的设计项目。有了项目帮助和讲义，您所需要的只是在网站上。

基本思想是，在光线追踪器中制造非常细微的错误非常容易，尤其是在涉及折射之类的事情时。如果您只是在空间中随机创建一堆球体，则很难验证正确性或诊断错误。

所以，有一个解析器很容易合并到你自己的代码中，还有一堆诊断场景文件。第一个文件是最容易工作的（注视原点，向下看一个轴，一个球体），如果你能正确渲染它们，你几乎可以保证有一个正常工作的光线跟踪器。

此外，[解析器使用 RIB 格式](http://rivit.cs.byu.edu/655/codeSnipets/codeSnipets.html)，这是 Pixar 的标准场景文件格式，几乎可以从任何建模器导出。

它还探索了分布式光线跟踪和路径跟踪，可以为您提供一些[非常漂亮的图像](http://rivit.cs.byu.edu/655/ribScenes/ribScenes.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-16T18:14:35.250

几年前，有人挑战我做一个[小型光线追踪器](http://www.mysterystudio.com/2k_raytracer.php)的 Delphi 端口（少于 200 行 C 代码）。

我[将它移植到 Delphi](http://groups.google.com/group/borland.public.delphi.graphics/browse_frm/thread/a15bb9d0f91dde12?hl=en&ie=UTF-8&q=tiny+raytracer+ian+boyd+delphi)，也许有一天我会重新移植到 C#。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T02:38:36.740

我发现的最好的一个是：http: [//www.devmaster.net/articles/raytracing_series/part1.php](http://www.devmaster.net/articles/raytracing_series/part1.php) 本教程的进展确实有点快，但它涵盖了光线追踪的*许多*方面。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-01-09T17:47:51.710

我*强烈*建议阅读[https://www.scratchapixel.com/](https://www.scratchapixel.com/)上的教程，他们花时间解释事物背后的物理和数学，但也提供了出色的代码示例！

在实现我自己用 Java 编写的光线追踪器时，我使用了他们的许多教程：[https ://github.com/bradforj287/brads-java-raytracer](https://github.com/bradforj287/brads-java-raytracer)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-12T10:31:44.343

如上所述，您可能得到的最好的书是 Matt Pharr 的基于物理的渲染（请查看 www.pbrt.org）。详细解释了许多算法，包括光子映射等高级内容。此外，它包括一个完整的光线追踪器，因此您可以查看它。它还涵盖了数学基础知识，所以如果你不想买很多书，我绝对建议你看看这本书。

它比关于这个主题的经典书籍要好得多，因为它们往往只解释理论，而不是如何真正实现它。对于基础知识，任何数学书都可以，或者您可以尝试“实时碰撞检测”，它还解释了许多相交例程（在光线追踪中需要）。

如果您真的想从基础开始，您应该尝试“计算机图形学：原理与实践”，它已经过时了（现在有些部分真的是胡说八道），但它很好地解释了基础知识。如果您想要一本更新的书，请尝试“计算机图形学基础”，其中包含相同的内容，只是没有那么详细（应该足以让您入门）。

最后但并非最不重要的一点是，[关于光线追踪的维基百科页面](http://en.wikipedia.org/wiki/Ray_tracing_(graphics))实际上非常好，应该可以为您提供一些起点。看看外部链接部分。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-16T16:59:56.900

如果您正在寻找一本能让您从一无所有到可以生成图像的工作代码的好书，我从 Andrew Glassner 的**[An Introduction to Ray Tracing](http://www.glassner.com/andrew/writing/books/irt.htm)**开始。我现在无法访问亚马逊，但这里是[相关链接](https://rads.stackoverflow.com/amzn/click/com/0122861604)。

巧合的是，这实际上是向我介绍面向对象设计的书和问题域。男孩，那是很久以前的事了......

从那里开始，我建议继续阅读 Pete Shirley 的书，正如[Wikipedia 参考书目](http://en.wikipedia.org/wiki/Backwards_ray_tracing#References)所暗示的那样。实际上，一个更好的建议是参加他的光线追踪课程。它对我有用！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-12T07:50:46.663

这个用户有一些关于光线追踪的有趣教程，我相信这些教程使用 C#：

[http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=3589667](http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=3589667)

我相信会有一些更好的教程，但这可能会很有趣。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-12T09:22:59.067

你见过povray吗？恕我直言，这是了解光线追踪的一个很好的起点（[http://www.povray.org/](http://www.povray.org/)）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-03-20T02:32:32.420

这是一个可能有助于理解和可视化光线跟踪的一般概念的工具：[光线跟踪模拟器](https://github.com/vreyn/graphics/tree/master/RaytracingVisualization/RaytracingGame)

这是我为我教授的图形课程构建的模拟器。它不是将 3D 场景渲染为 2D 图像，而是将 2D 场景渲染为 1D 图像，这样可以一次将整个算法可视化，让您可以实时修改场景的参数。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-26T13:11:19.187

*在一个周末进行光线追踪*

是从初级到高级技术的三本书系列。这是一个带有大量图表和解释的光线追踪器（用 C 语言实现）教程。

[https://raytracing.github.io/](https://raytracing.github.io/)

# vb.net - 如何读取字符串列表

> ID：362150
> 
> 赞同：0
> 
> 时间：2008-12-12T07:50:21.203
> 
> 标签：vb.net

我有这个：

公共字符串列表作为新列表（字符串）

我需要使用 For each statement 阅读整个列表，使用 VB.net 语法的最佳方法是什么？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T07:52:17.517

听起来您应该阅读[For Each...Next 语句的 MSDN 文档](http://msdn.microsoft.com/en-us/library/5ebk1751.aspx)。

例如：

```
For Each x As String In stringList
    Console.WriteLine(x)
Next 
```

如果这不是您所追求的，请在您的问题中提供更多详细信息。

# coupling - 松散耦合与信息隐藏和易于更改

> ID：362154
> 
> 赞同：12
> 
> 时间：2008-12-12T07:51:20.063
> 
> 标签：coupling

我正在阅读 Steve McConell 的 Code Complete，我正在考虑他在关于松散耦合的部分中给出的示例。它是关于一个计算员工假期数的方法的接口，它是根据员工的入职日期和她的销售额计算的。作者建议将入职日期和销售额作为方法的参数，而不是员工的实例：

```
int holidays(Date entryDate, Number sales) 
```

代替

```
int holidays(Employee emp) 
```

争论的焦点是这将方法的客户端解耦，因为它不需要知道有关 Employee 类的任何信息。

我想到了两件事：

1.  提供计算所需的所有参数会破坏封装。它显示了该方法如何计算结果的内部结构。

2.  更难改变，例如当有人决定员工的年龄也应该包括在计算中时。一个人将不得不更改签名。

你怎么看？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-12T08:32:18.170

我看到你的论点 2 的问题是

1.  您假设每个需要的值都来自一个 Employee 实例。这并不总是正确的。例如，假设您必须考虑公司的财务状况来计算给任何员工多少“奖金假期”。您是否会将财务状况信息添加到员工类以避免更改签名？

2.  更改签名不一定“更难”，尤其是在这些日子里，单击按钮即可突出显示每个呼叫位置的工具。

你的论点 1 的主要问题是它并没有像其他人所说的那样破坏封装。你展示的是什么，而不是如何，这就是封装的意义所在。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-12T09:22:32.860

最终松耦合[获胜](http://en.wikipedia.org/wiki/Coupling_%28computer_science%29)。从高耦合到低耦合，有各种类型的耦合：

> 1.  内容耦合（高）：一个模块修改或依赖另一个模块的内部工作
> 2.  公共耦合：两个模块共享相同的全局数据（例如一个全局变量）。更改共享资源意味着更改所有使用它的模块。
> 3.  外部耦合：两个模块共享外部强加的数据格式、通信协议或设备接口。
> 4.  控制耦合：一个模块控制另一个模块的逻辑，通过向它传递关于做什么的信息（例如传递一个做什么标志）。
> 5.  标记耦合（数据结构耦合）：当模块共享一个复合数据结构并且只使用它的一部分，可能是不同的部分（例如，将整条记录传递给只需要它的一个字段的函数）。
> 6.  数据耦合：当模块通过例如参数共享数据时。每个数据都是一个基本部分，并且这些是唯一共享的数据（例如，将整数传递给计算平方根的函数）。
> 7.  消息耦合（低）：模块不相互依赖，而是使用公共接口来交换无参数消息（或事件，请参阅[消息传递](http://en.wikipedia.org/wiki/Message_passing)）。
> 8.  无耦合：模块之间根本不通信。

传入的`Employee`是Stamp耦合，比Data耦合更耦合。如果您真的考虑修改的难易程度，那么低耦合会更好，因为您不必担心不必要的副作用。假设你想改变`Employee`类的结构。您现在必须检查假期函数的实际实现，以确保它不会破坏数学运算。

最好的最解耦的方法是定义一个 interface `IHolidayable`，但这对于这种情况来说有点过头了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-15T21:46:32.123

To me the "right" answer boils down to whether you're defining a high-level or low-level API when creating this function. A low-level API puts flexibility above convenience for any particular case and argues for `int holidays(Date entryDate, Number sales)` . A high-level API is designed to do one thing well with as much convenience as possible for the client. This argues for `int holidays(Employee emp)` because it requires less boilerplate on the caller's part (extracting the date and sales from the Employee class) and is less verbose.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T08:00:56.410

1) 提供参数不会破坏封装。它只是表明这些参数用于计算假期。“如何”仍然隐藏在方法中。

2) Holiday 方法不应该是 Employee 类的一部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T08:02:47.527

1.  这并没有破坏封装。打破封装将揭示它用于计算假期的内部方法。提供起始参数是定义 API 的内容。

2.  可以改进 API 以允许此类更改 - 但是，大多数方法建议您应该设计以满足当前的需求，而不是针对不可预见的更改进行过度设计（为更改而设计，但不要试图预测更改）。最好现在实现你需要的东西，如果有必要，以后再重构。

在我看来，最好通过尽可能多的解耦和封装来规划变更，以便尽可能轻松地进行重构。试图提前预测每一个可能的场景最终会导致一个臃肿的过度设计的系统。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T08:04:59.973

```
int holidays(Employee emp) 
```

在这种情况下，只有员工可以使用相关功能......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T08:04:05.217

我想说松耦合的主要好处之一是易于更改。松散耦合的类型可以相互独立地改变，所以我不明白你在问题中的“vs”。

此外，我不会说您通过为方法提供参数来破坏封装。您可以`Sum(int a, int b)`随心所欲地实现 - 但您必须告诉我（作为用户）您期望两个数字。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T08:58:45.560

与其他一些帖子不同，我同意你的观点，这打破了封装。不是类的封装，而是计算假期的概念。如果你想在未来改变这个计算的工作方式，并且仍然避免紧密耦合，我建议让 Employee 成为一个接口。如果这仍然与 Employee 紧密耦合，因为您认为可能需要为其他事情计算假期，那么您可以拥有一个 GetsHolidays 接口，Employee 可以从该接口继承。

当然，您选择的解决方案的参与程度应该取决于您认为耦合和封装问题的严重程度。我认为这两种原始解决方案在许多情况下都是可以接受的，尽可能保持简单。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-12T10:08:47.367

> 最好的最解耦的方式是定义一个接口 IHolidayable

This sort of blanket statement really annoys me. Just because you use an interface does NOT mean you automatically decouple anything. If your employee class implements an interface to calculate holidays, any code that calls the method, *still* calls the same method. At worst, the calling code will do that by direct access to an employee object, not an IHolidayable interface reference, in which case you have only made the situation worse (because there is now also a more subtle coupling between the interface and any classes which implement it).

Interfaces can indeed help with decoupling, but they do not *automatically* do so, and even when they do, they are not necessarily a better solution than an abstract (or some other ancestor) class.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-06-03T00:18:58.847

```
int holidays (IHolidayInfo obj) 
```

Is might be a way. In this case, any object that implements `IHolidayInfo` would able to use "holidays" function. Just an alternative.

# performance - Groovy：加载动态脚本的最佳/高性能方式

> ID：362184
> 
> 赞同：1
> 
> 时间：2008-12-12T08:07:34.540
> 
> 标签：performance, groovy

我正在实现一个程序，它利用 Groovy 作为脚本引擎，为用户提供了自动化任务的可能性。因此脚本必须按需加载，我使用以下代码实现：

```
// short version, try/catch and error handling skipped
String[] roots = new String[] { "data" };
Binding binding = new Binding();
GroovyScriptEngine gse = new GroovyScriptEngine(roots);

binding.setVariable("control", this.getControl());
// .. several others

gse.run(scriptName, binding); // where scriptName is provided through user selection 
```

我注意到在第一次运行时整个块的执行需要 400 到 800 毫秒，但在我的笔记本上稍后运行时会下降到 200 到 400 毫秒。

一开始，每个事件都会初始化一个新的 GroovyScriptEngine，然后结束。与此同时，我为整个程序使用了一个 GSE 实例，尽管最初的问题尚未解决：

**有没有办法在 GSE 启动时预编译 groovy 脚本？**groovyc 不是一个选项，因为这需要“外部”程序调用。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T08:31:47.267

I am looking at the same problem and have the following :

*   Create a single GSE that looks at a shared directory ("data" in your example)
*   The single GSE monitors and pre-compiles the items in the dir so that is the speed up (not sure but the GSE seems to have some staitc stuff that hangs around between instance creation.

If your scripts do not change much then pre-compiling them is the best way to go and when a change is registered re-compile at that time.

Hope that helps.

# java - 如何在 Windows 上使用另一个用户帐户创建新进程？

> ID：362198
> 
> 赞同：11
> 
> 时间：2008-12-12T08:20:08.977
> 
> 标签：java, windows, process, account

是否可以使用不同的用户帐户在 Windows 上创建新进程？我知道有一个上下文菜单“运行方式”，但我想用 Java 来做。我有用户名和密码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T08:54:02.043

您需要使用[Java 本机接口 (JNI)](http://en.wikipedia.org/wiki/Java_Native_Interface)编写 DLL，因为您无法使用纯 Java 代码执行此操作。

DLL 本身需要调用**[CreateProcessAsUser](http://msdn.microsoft.com/en-us/library/ms682429(VS.85).aspx)**函数来在另一个用户的上下文中创建一个进程。要成功创建该进程，您需要向该函数提供一个访问令牌，该令牌本身是通过调用[LogonUser](http://msdn.microsoft.com/en-us/library/aa378184(VS.85).aspx)函数创建的（它需要用户名和密码来验证该其他用户）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T08:22:54.540

有一个名为“runas.exe”的程序。您可以运行该进程并为您的进程和用户名/密码提供适当的参数。我认为这是最简单的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-22T05:12:34.093

我刚刚遇到了一个名为 MiniRunAs 的 runas.exe 程序的替代方案，它将在命令行上获取密码 - [http://www.source-code.biz/snippets/c/1.htm](http://www.source-code.biz/snippets/c/1.htm)

如果您能够将它与您的应用程序一起安装，那可能比编写 JNI DLL 更简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-20T22:54:09.877

根据您的需要，Win32 API“ [CreateProcessWithLogonW](http://msdn.microsoft.com/en-us/library/ms682431(VS.85).aspx) ”比“CreateProcessAsUser / LogonUser”函​​数更容易使用。

来自 MSDN 文档：

```
CreateProcessWithLogonW 和 CreateProcessWithTokenW 函数是
类似于 CreateProcessAsUser 函数，除了调用者
不需要调用 LogonUser 函数来验证用户
并获得一个令牌

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-20T21:41:34.047

RUNAS 有“/savecred”开关，让您只在第一次输入凭证。一个潜在的问题是，当 /SaveCred 保存凭据时，它会在 RUNAS 调用该用户帐户时保存它。这可能是一个巨大的安全风险，所以要小心使用它！

[http://www.rgagnon.com/javadetails/java-0014.html](http://www.rgagnon.com/javadetails/java-0014.html)上的示例（最后）

# database - 是否有免费（或低成本）的名字和姓氏数据库？

> ID：362202
> 
> 赞同：5
> 
> 时间：2008-12-12T08:22:29.143
> 
> 标签：database, language-agnostic, testing

我正在寻找可用于测试联系人数据库中可能的姓名拼写错误的参考数据库。这是一个批处理，所以性能不是一个真正的问题。理想情况下，我想要一个全面的数据库，但即使是“前 5000 名”之类的东西也会有很长的路要走。

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-12T08:24:35.613

我不知道数据库，但自己从诸如 [http://web.archive.org/web/20081218100813/http://www.census.gov/genealogy/names/dist.all之类的资源中填充一个.last](http://web.archive.org/web/20081218100813/http://www.census.gov/genealogy/names/dist.all.last) 应该可以正常工作:)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-12T09:23:59.580

我知道一个名字数据库[http://www.lexique.org/public/Prenoms100.zip](http://www.lexique.org/public/Prenoms100.zip)涵盖 `Phil, Phile, Philip, Philipp, Phillip, Felipe, Philippe`. （大约 12000 个名字）

我认为你不会发现第二个名字有什么用处，因为它们比名字多得多。这是计算语言学中的一个已知问题。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-12T09:09:37.830

我不明白您如何在名称中找到拼写错误。我的意思是，我的名字是 Philippe（法语），但它可以是 Philip、Philips、Felipe、Fèlipe 或其他任何名字。可能有一个传统的法国名字 Sandrine，但一种趋势是写成 Cendrine，因为最近法国的法律有所放松。等等。
好吧，也许 Jhon 闻起来像错字（常见的两个字母倒置），但你不能确定。
姓氏中的拼写错误更不可能被发现……除非您检查有限的已知列表（例如，公司的员工）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T10:18:00.080

如果不涉及额外的语言信息，这可能毫无用处。我不会为此付出努力，因为它可能只适用于一小部分人口。

PS：别忘了中文、俄罗斯和印度的名字（百万）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T16:10:42.447

我个人认识一些名字独特的人（他们的父母故意编造独特的名字），我个人也认识一些名字看起来拼写错误但实际上是他们父母给他们起名字的人。我什至不会尝试尝试修复名称拼写错误。相反，我们所做的是导入名称（并且我们需要来自客户的唯一标识符）。然后下次导入时，我们匹配唯一标识符，如果名称已更改（因为我们联系了此人，他或她告诉我们将其更改为什么），则名称不会更新。但是，如果名称没有更改并且文件中的名称不同（通常是因为结婚或离婚），那么名称就会更新。您需要在数据记录上添加某种标志来表明它是手动更新的。我们通过触发器填充它。

导入名称数据时更重要的是避免创建重复项（因此我们要求数据源中的唯一标识符）或避免数据的不正确匹配（匹配时不能只考虑名称来查看记录是否已存在）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-28T16:28:54.537

我发现了一些不用于检查拼写的数据库，但这里有一个列出常见名字的数据库：[Name Genders Database](http://www.easydbs.com/name-genders-database)，另一个列出常见的姓氏：[Name Ethnicities Database](http://www.easydbs.com/name-ethnicities-database)

希望有帮助！

# msbuild - MSTest 在 2008 年从构建脚本失败

> ID：362208
> 
> 赞同：0
> 
> 时间：2008-12-12T08:25:21.087
> 
> 标签：msbuild, mstest

大家好，有人知道这里到底发生了什么吗？

错误片段：

```
Loading ..\LocalTestRun.testrunconfig...
..\LocalTestRun.testrunconfig
Expected type attribute not found.
File ..\LocalTestRun.testrunconfig Line 2 Pos 2. 
```

msbuild 脚本中的测试目标中的任务

我见过其他人遇到同样的错误，但没有修复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T08:29:16.587

好的，已经弄清楚发生了什么。当我应该使用 $(VS90COMNTOOLS) 时，我正在使用 $(VS80COMNTOOLS) 来查找我的 MSTest.exe。对不起！

# database-design - 线程论坛的最佳数据库结构是什么？

> ID：362215
> 
> 赞同：3
> 
> 时间：2008-12-12T08:30:28.813
> 
> 标签：database-design, forum

我想为一个电子学习站点建立一个线程论坛（当然是开源的 asp.net mvc，尽管这对这个问题无关紧要）。

什么样的数据库结构可以帮助检索具有最佳性能的论坛帖子？我没有拒绝。到它，因为它可能会随着被检索的行数而变化。

此外，我应该能够将特定线程与另一个线程链接。例如。显示“相关论坛链接”。

我正在使用 SQL Server 2005。

以下是我想到的结构（无耻地取自） [Stephen Walther 优秀的博文](http://weblogs.asp.net/stephenwalther/archive/2008/09/05/asp-net-mvc-application-building-forums-3-post-messages.aspx)

表：论坛

```
· Id
· ParentId  (null if this is the first message)
· ParentThreadId  (Identify message in the same thread)
· Author
· Subject
· Body
· PostedDate 
```

表：相关论坛

```
· ForumId
· RelatedForumId 
```

欢迎提出想法/建议。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T08:48:57.653

当您为最常见的用例考虑数据的非递归自上而下（论坛 -> 线程 -> 发帖）检索时，这种表结构是一个好的开始，因为这将主要导致`WHERE ParentId = @SomeId`查询。

当您希望能够计算诸如“该论坛/线程中存在多少帖子？”之类的事情时，您很容易陷入无法分辨哪些 Id 嵌套在其他 Id 中的情况（即子关系是失踪）。

您可以通过冗余保存`ThreadId`并`ForumId`写入每个帖子来解决这一问题。那你就可以问了`SELECT COUNT(*) FROM Postings WHERE ThreadId = @SomeId`。

对于给定的帖子，这些 ID 不太可能更改，因此冗余不会立即创建插入/更新异常，但您应该有一个适当的程序来使用正确的 ID 更新所有相关的帖子，以防您决定移动内容.

对于将分层数据存储到 RDBMS 中的更高级方法，您可以查看这个问题的答案（这是我自己的，“没有钓鱼投票”的意图）：[“解析平面表的最有效/优雅的方法是什么到树上？”](https://stackoverflow.com/questions/192220/what-is-the-most-efficientelegant-way-to-parse-a-flat-table-into-a-tree)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T08:54:34.787

表：帖子

```
· ThreadId
· UUID
· Author
· Subject
· Body
· PostedDate 
```

表：螺纹

```
·ThreadID
·Forum
·UUID
·Author
·Subject
·Body
·PostedDate 
```

仅在具有缓存和索引的 MySQL 服务器上。否则这种结构不是最好的，但使用上述服务器，这使得计数和全文搜索变得容易

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T09:19:57.153

看起来挺好的。我会简单地调用 ParentThreadID ThreadID。添加 ForumID 不会有什么坏处，尤其是出于计数目的。

您应该添加作者姓名。大概 Author 是您的 User 表的 ID。提取该用户的名称并立即附加它。这样可以省去在显示线程或响应列表时从用户表中查找 50 个名称的麻烦。同样，如果用户从系统中删除，您将无法再查找该名称。当然不想从树中删除这些节点。

# web-services - Checking the incoming and outgoing data of a Web Service

> ID：362221
> 
> 赞同：0
> 
> 时间：2008-12-12T08:35:14.780
> 
> 标签：web-services

I have a web service in C# that I have deployed on IIS 6.0\. I want to view the data going out and coming to this web service.

I know about MS SOAP toolkit, but it seems to be deprecated by MS. Does anyone know about any other good tool other than MS soap toolkit. I cannot afford to spend money on any tool, so I need FREE tools if any.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T08:54:44.303

您可以使用[wireshark](http://www.wireshark.org/)来分析您的网络流量。

您还可以使用[SoapUI](http://www.soapui.org/)将 SOAP 命令发送到您的 Web 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T15:18:11.477

您可以使用[MS Fiddler](http://www.fiddlertool.com/fiddler/)或[MS Visual Round Trip Analyzer](http://www.microsoft.com/downloads/details.aspx?FamilyID=119F3477-DCED-41E3-A0E7-D8B5CAE893A3&displaylang=en)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T08:49:45.017

It is not clear (to me) from your question, whether this is a one time debugging exercise you are after or a logging-style solution for your app.

For the former I use either [TCPTrace](http://irg.cs.ohiou.edu/software/tcptrace/download.html) (free) or [HttpAnalyzer](http://www.ieinspector.com/httpanalyzer/)

# .net - 渲染 Excel 文件

> ID：362222
> 
> 赞同：1
> 
> 时间：2008-12-12T08:38:57.970
> 
> 标签：.net, asp.net, javascript, vb.net

我实际上是在浏览器中渲染一个 excel 文件。我使用 Response.Writefile(filePath) 来做到这一点。它在几台机器上工作得非常好。我收到一个带有“打开”、“保存”和“取消”选项的弹出窗口。

但是如果我在弹出窗口上点击保存后很少有机器，一个普通的空白页面仍然打开。这只发生在少数机器上。这个窗口只是在另一台机器上闪烁并自行关闭。请让我知道可以做些什么来避免在打开或保存文件后自行关闭这个纯空白页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T13:22:09.310

您是否设置了任何 HTTP 标头？如果不是，则您依赖浏览器正确解释数据。

告诉浏览器您正在发送 excel 内容：

```
Response.ContentType = "application/x-excel"; 
```

告诉浏览器将响应视为下载：

```
Response.AddHeader("content-disposition", "inline; filename=\"" + YourSuggestedFileName + "\""); 
```

给您带来麻烦的机器可能不知道如何处理 excel 数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T12:47:56.340

这种方法的问题是日期字段和数字字段都呈现为字符串。如果最终用户想要对这些字段进行排序，他们必须显式地修改这些字段的类型。

如果你有预算，我建议使用类似的组件： [Aspose.Cells](http://www.aspose.com/categories/file-format-components/aspose.cells-for-.net-and-java/default.aspx)

# mysql - 最好的 MySQL 性能调优工具？

> ID：362223
> 
> 赞同：46
> 
> 时间：2008-12-12T08:40:43.350
> 
> 标签：mysql, performance

哪个是 MySQL 最好的、对用户最友好的性能工具？我需要帮助确定我的设置的瓶颈。是 SQL 语句、设置变量还是其他问题？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-12-12T09:15:47.803

坏消息：有 GUI 工具可以帮助解决这个问题，但它是一项熟练且范围广泛的工作。因此它们并没有涵盖所有内容，您可能需要使用命令行内容/sql 语句等来提供帮助。我只真正使用过命令行工具。我将概述一下我知道/使用过的东西：

首先，您需要一个良好的数据库设计。如果设计不好，你只能做到这一点。这包括规范化，以及为字段使用适当的类型。我将把这一点留在这里，因为我认为它有点旁白，而不是你所追求的。

确保 MySQL 查询缓存已设置并正常工作，如果可以的话，给它更多的 RAM，并确保你的重要查询没有做任何阻止 mysql 缓存它们的事情。例如，在查询中使用 NOW() 函数可以做到这一点 - 原因很明显 - NOW 每秒都在变化！您可以改为将时间戳放入 sql 中，并使用最接近分钟/小时/天（您可以逃脱的最大时间段）的时间来允许 mysql 获得一些缓存优势。

开始优化：在 select 前面加上“EXPLAIN”是查看查询如何执行并确定如何改进它的方法。学习解释输出：[http](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html) ://dev.mysql.com/doc/refman/5.0/en/using-explain.html您通常可以向现有索引添加新索引/添加列以改进事情。但是您也会遇到需要重组查询的情况。

开始使用 MySQL 提高性能（假设您还不知道问题查询是什么）是检查慢查询日志 - 它将所有查询时间超过 x 秒的查询记录到一个文件中。

概述，包括如果它还没有记录的配置，在这里：[http](http://dev.mysql.com/doc/refman/5.0/en/slow-query-log.html) ://dev.mysql.com/doc/refman/5.0/en/slow-query-log.html - 我还发现设置 long_query_time 到0 一天左右，以便在此处记录所有查询并记录所用时间，这是了解性能确切情况的有用方法。但我不会马上去那里！并且不要让它打开，日志可能会变得很大。

一旦你有几天的日志记录，我从这里找到了 mysqlsla（mysql 慢日志分析器）：http://hackmysql.com/mysqlsla[是](http://hackmysql.com/mysqlsla)一个很好的工具。

它可以做的不仅仅是慢查询日志分析——阅读手册。但是要解释它对慢日志的作用：慢查询日志可以包含大量数据，因此很难确定哪些查询总体上是最昂贵的 - 例如：考虑它们运行的​​次数以及两个查询何时实际上与 where 子句中的不同 id 相同。

MySQL sla 为您完成这一切。它贯穿日志，并且可以对 where 子句中相同/具有不同值的查询进行分组。然后它（默认情况下）向您显示总执行时间方面的前 10 个查询 - 这通常会带来一些惊喜，但通常是最高效的起点 - 采用最昂贵的查询并在其上使用 EXPLAIN，看看您是否可以改进它。

有些查询需要很长时间，而且不容易改进。在这种情况下，您能否以另一种方式获取数据，或者至少将其缓存起来？您甚至可能会发现需要更改数据库模式。同样，某些查询可能位于 mysqlsla 输出的顶部，因为您经常运行它们（尤其是当 long_query_time 设置为 0 时更是如此），即使它们运行得非常快。也许是时候为您的应用添加一些缓存了？

[http://www.maatkit.org/](http://www.maatkit.org/)看起来也很有希望 - 从未使用过，但 mk-query-profiler 工具应该有助于进一步研究查询缓慢的原因。

还有一个完全独立的东西要查看：PHPMYADMIN 中的“状态”页面（或者您可以运行所有查询来生成此信息....） - 它以红色突出显示它认为可能不好的东西，并且可以帮助您看看您可以从分配系统资源中获得什么好处。我对此知之甚少-我的方法一直是，如果某些东西是红色的并且看起来很糟糕，请去阅读它并确定它是否重要以及我是否应该做某事（通常意味着为 MySQL 分配更多资源通过更改配置）。

最近我发现运行 SHOW PROCESSLIST 在受苦的服务器上也很有用。虽然它只为您提供实时（嗯，实时快照）信息，但它可以帮助您了解给定时间发生的事情，特别是如果您刷新几次并观察变化。我最近发现一个服务器使用每个可用的 mysql 连接来使用这种方法运行相同的查询。当然，它会在慢查询日志中，但这是查看发生了什么的一种非常快速且明显的方式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-13T07:00:31.903

解释是你的朋友。除此之外，您必须依赖临时工具、测试和操作系统工具的混合来查看到底发生了什么。

从操作系统工具（有利于确定情况是受 CPU 还是 IO 限制）或可以在 MySQL 本身中看到的各种变量（显示全局变量、显示引擎 innodb 状态等）中可以有效地看到很多东西。

我觉得有一个性能测试环境真的很重要。在实验室的生产级硬件上运行具有生产级负载（使用负载模拟）的生产级数据库（昂贵但必不可少）。

完成此操作后，您可以在完全安全的情况下调整所需的任何参数，知道即使它融化了整个服务器，您也可以重建它而不会影响任何东西。

不要做人们建议的具体事情，除非你已经在你的性能测试环境中对其进行了测试并且发现它们证明是有益的。

本质上，性能调优通常按以下顺序关注三个方面：

*   数据库本身的结构（表结构、索引等）
*   查询
*   调整服务器参数

前两个经常被忽略，而最后一个则有帮助，但只有在前两个完成后才会有所帮助。

不要低估减少服务器需要做的工作量的重要性——使用更小的字段、更少的行、更少的列等总是更好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-16T08:29:28.403

当我有一个痛苦的 mysql 服务器时，我发现[MONyog是一个很大的帮助。](http://webyog.com/en/)

这是一个基于 Web 的系统，可以 24/7 全天候分析您的系统，并为您提供关于系统变量、缓存大小等更好值的体面建议……

它还具有内置的 mysqlsla 类型慢查询分析器功能。

可惜不是免费的。 ![MONyog 屏幕截图：当前连接](https://i.stack.imgur.com/PNgle.png)

**MONyog- MySQL Monitor and Advisor**有我喜欢的新 UI，我最喜欢这些功能：

1.  查找问题 SQL - 使用慢日志、一般日志、PROCESSLIST 和通过 PROXY

2.  在关键情况下发出警报 - 服务器已关闭，连接过多等。

3.  定期监控自己的查询结果

4.  复制监控

    等等......[完整的功能列表](http://www.webyog.com/en/monyog_feature_list.php)

# c# - 从文本文件读取到锯齿状数组

> ID：362224
> 
> 赞同：1
> 
> 时间：2008-12-12T08:41:09.587
> 
> 标签：c#, jagged-arrays

我在您网站的一个旧问题中发现了这个问题，所以我认为我可以做到，但我想我错了:-)

旧帖子在[这里](https://stackoverflow.com/questions/360943/read-text-from-file-and-apply-some-operations-on-it)

我是锯齿状数组的新手，所以下面的代码

```
StreamReader rows = new StreamReader("c:\\practice.txt");
            string line;
            int i;
            i=1;
            while ((line = rows.ReadLine()) != null)
            {
                String[][]rows = new String [i][]; ;
                rows = rows.ReadLine();
                String[][] rows = new string[S.Length][];
                i++;
            }
            for (int i; i < S.Length; i++)
            {

                row[i] = S[I].Split(',');

            }

            int totalCounter = 0, totalSum = 0;
            // etc
            foreach(string[] row in rows)
            {    
                int m1 = int.Parse(row[3]);
                totalCounter++;
                totalSum += m1;
                switch(row[2])
                {        
                    case "male":
                    maleCount++;            
                    maleSum += m1;            
                        break;        
                    case "female":            
                        femaleCount++;            
                        femaleSum += m1;            
                        break;    
                }
            } 
```

我知道我犯了重大错误，但在东部我尝试过任何人都可以帮助我使其成为工作代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T09:03:45.673

首先，确保在 using 语句中包装非托管资源，例如流。

就我个人而言，我喜欢我的[LineReader](http://csharpindepth.com/ViewNote.aspx?NoteID=113)类，它可以很容易地从文件（或其他任何东西）中读取文本行。

接下来，我会[避免使用数组](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)，除非你真的必须这样做。`List<T>`通常工作起来会更愉快。现在如果 string.Split 做你想要的，你可以很容易地拥有一个`List<String[]>`. 或者，您可以使用 LINQ 完成很多工作：

```
var query = from line in new LineReader("c:\\practice.txt")
            let parts = line.Split(',')
            select new { Gender=parts[2], Amount=int.Parse(parts[3]) }; 
```

在“普通”LINQ 中从单个数据流中获取多个聚合是很棘手的（这就是 Marc Gravell 和我开发[Push LINQ](http://msmvps.com/blogs/jon_skeet/archive/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation.aspx)的原因）。但是，您可以使用普通的 foreach 语句：

```
int totalCounter = 0, totalSum = 0;
int maleCount = 0, maleSum = 0, femaleCount = 0, femaleSum = 0;
foreach (var row in query)
{
    totalCounter++;
    totalSum += row.Amount;
    switch (row.Gender)
    {
        case "male":
            maleCount++;
            maleSum += Amount;
            break;
        case "female":
            femaleCount++;
            femaleSum += Amount;
            break;
    }
} 
```

如果您按性别对行进行分组，您可能会更简单，特别是如果您知道性别始终是“男性”或“女性”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T09:24:18.283

您似乎在重复阅读这些行，或者您可能混淆了行和单元格 - 这一点特别看起来**很**奇怪：

```
 while ((line = rows.ReadLine()) != null)
        {
            String[][]rows = new String [i][]; ;
            rows = rows.ReadLine();
            String[][] rows = new string[S.Length][];
            i++;
        } 
```

即重新声明行，`ReadLine`每个循环两次调用等。我怀疑你的意思是`string.Split`？无论哪种方式，要么使用`File.ReadAllLines`，要么查看昨天提出的一些选项。如果您迫切需要使用数组，核心可能类似于：

```
using System;
using System.IO;
static class Program
{
    static void Main()
    {
        string[] lines = File.ReadAllLines("foo.txt");
        string[][] grid = new string[lines.Length][];
        for (int i = 0; i < lines.Length; i++)
        {
            grid[i] = lines[i].Split(',');
        }

        int totalCount = 0, maleCount = 0, femaleCount = 0,
            m1Total = 0, m2Total = 0, m3Total = 0,
            m1MaleTotal = 0, m1FemaleTotal = 0;
        foreach (string[] line in grid)
        {
            totalCount++;
            int m1 = int.Parse(line[3]),
                m2 = int.Parse(line[4]),
                m3 = int.Parse(line[5]);
            m1Total += m1;
            m2Total += m2;
            m3Total += m3;
            switch (line[1].Trim())
            {
                case "male":
                    maleCount++;
                    m1MaleTotal += m1;
                    break;
                case "female":
                    femaleCount++;
                    m1FemaleTotal += m1;
                    break;
            }
        }
        Console.WriteLine("Rows: " + totalCount);
        Console.WriteLine("Total m1: " + m1Total);
        Console.WriteLine("Average m1: " + ((double)m1Total)/totalCount);
        Console.WriteLine("Male Average m1: " + ((double)m1MaleTotal) / maleCount);
        Console.WriteLine("Female Average m1: " + ((double)m1FemaleTotal) / femaleCount);
    }
} 
```

再一次 - 我不能强调你应该用 LINQ 做多少而不是手动循环......

# c++ - 使用 IAMCameraControl::Set() 在 Windows Mobile 设备上设置缩放

> ID：362225
> 
> 赞同：0
> 
> 时间：2008-12-12T08:43:28.460
> 
> 标签：c++, windows-mobile, directshow, zooming, video-capture

我正在开发一个视频捕捉应用程序，我想实现缩放功能。

使用 DirectShow 我遇到了 IAMCameraControlInterface。它有一个方法::Set()，应该用于设置几个相机参数。

但是我玩了，我什么也做不了。然后我尝试调用 ::GetRange() 方法，该方法应该返回可能的参数值的范围，但它没有返回任何内容。

该设备真的有可能不支持任何选项吗？看起来很奇怪，因为原生相机应用程序支持缩放，但我真的不知道这种奇怪结果的主要问题在哪里。

有没有人有类似应用的经验？有谁知道这里可能出了什么问题或如何有效地使用[IAMCameraControlInterface](http://msdn.microsoft.com/en-us/library/aa929836.aspx)函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T09:49:10.840

我没有任何个人经验，但看看这个[论坛端口](http://social.msdn.microsoft.com/forums/en-US/vssmartdevicesnative/thread/b74ac0ab-edc9-4a9c-959c-d42d9f40884c/)。根据回复者的说法，驱动程序可能无法正确实现 IAMCameraControl 接口，并依赖于实现特定的技巧来进行放大和缩小。

据我所知（请有人更正或验证）相机驱动程序不是 Windows Mobile 认证过程的一部分。这意味着制造商可以为所欲为。

# html - Google Chrome Bug with CSS Padding style applying to empty cells

> ID：362227
> 
> 赞同：1
> 
> 时间：2008-12-12T08:45:17.600
> 
> 标签：html, css, google-chrome, stylesheet, padding

I have a problem only in Google Chrome (Firefox, IE, Netscape, Safari and Opera are Okay) where a padding property which should be applied to text in a cell, is being applied to all empty cells aswell. It's easy to solve by adding more specific styles to my affected perimeter cells and using different styles, but that uses a lot of extra code and something which I try to save on. Is there possible way to get my CSS to pass over empty cells in the table it applies to?

```
#regFormTable{ padding:8px 30px 0px; } 
```

Is the style affecting it.

Edit: The commas were an accident in typing the class on here (I'm using to submitting parameters syntax)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T08:52:14.200

I think Google Chrome have a different default for the [`empty-cells`](http://www.w3schools.com/Css/pr_tab_empty-cells.asp) css property. you should try to do :

```
#regFormTable{ padding:8px 30px 0px; empty-cells: hide; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T08:52:32.250

You shouldn't have commas in there:

```
#regFormTable { padding: 8px 30px 0px; } 
```

Also, I usually use either 2 or 4 values - it's just easier to understand!

# python - Python：在大量字符串中查找部分字符串匹配

> ID：362231
> 
> 赞同：2
> 
> 时间：2008-12-12T08:49:03.317
> 
> 标签：python, search

我对在 Python 中实现自动完成很感兴趣。例如，当用户键入字符串时，我想显示磁盘上名称以该字符串开头的文件子集。

在大型语料库（例如几十万个字符串）中查找与某些条件匹配的字符串的有效算法是什么？就像是：

```
matches = [s for s in allfiles if s.startswith(input)] 
```

我希望条件灵活；例如。只要输入中的所有字母以相同的顺序出现在 s 中，它就会是匹配的，而不是严格的开头。有什么比我在这里展示的蛮力方法更好的呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T10:37:07.327

对于精确匹配，通常实现这样的方法是将您的语料库存储在[trie](http://en.wikipedia.org/wiki/Trie)中。这个想法是将每个字母存储为树中的一个节点，链接到单词中的下一个字母。查找匹配项只是简单地遍历树，并显示您当前位置的所有子项。例如。“cat”、“cow”和“car”将存储为：

```
 a--t
 / \ 
c   r
 \
  o--w 
```

当你得到 ac 时，你从 c 节点开始，然后 a 将带你到 c/a 节点（孩子“t”和“r”，让 cat 和 car 作为你的完成）。

请注意，您还需要标记作为完整单词的节点以处理作为其他子字符串的名称（例如“car”和“cart”）

但是，要获得所需的模糊匹配，您可能需要进行一些更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T09:05:15.670

我使用[Lucene](http://pylucene.osafoundation.org/)自动完成具有十万多种可能性的文本字段，我认为它是即时的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T09:15:52.373

也许 readline 模块是您正在寻找的。它是 GNU readline 库[Python Documentation](http://docs.python.org/library/readline.html#module-readline)的接口。也许您可以使用`set_completer()`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T09:05:57.043

匹配字符串所需的灵活性称为*模糊匹配*或*模糊搜索*。我不知道有任何 python 实现（但我没有深入研究该主题），但有可以重用的 C/C++ 实现，例如支持带有模糊参数的正则表达式的[TRE 封装](http://laurikari.net/tre/)。

除此之外，总是存在一个问题，即你的单词列表是否适合记忆。如果没有，将它们保存在列表中是不可行的，并且必须将某些内容缓存到磁盘或数据库中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T09:18:05.833

（仅解决问题的字符串匹配部分）

如果你想自己快速尝试一些东西，为什么不创建一些字典，每个字典都将初始模式映射到字符串列表，其中

*   每个字典都以特定长度的初始模式为键
*   字符串列表中的所有字符串都以初始模式开头
*   *仅当列表中的字符串少于*特定数量（例如 10）时，才会创建初始模式/字符串列表对

因此，例如，当用户键入三个字符时，您在字典中查找长度为 3 的键。如果匹配，则意味着您有 1 到 10 个立即可用的可能性。

# sql-server - Guid 是数据库的最佳身份数据类型吗？

> ID：362232
> 
> 赞同：12
> 
> 时间：2008-12-12T08:49:36.030
> 
> 标签：sql-server, database-design, replication, guid

它连接到 BI 并合并来自不同数据源的数据，并使该过程更加顺畅。

是否有从没有 Guids 的数据库到没有信息丢失的有 Guids 的版本的最佳迁移策略？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-12T10:15:37.807

请记住，PK 的 GUID（或“unique_identifier”）是一个不好的选择，因为许多 PK 具有聚集索引（因此所有行都按索引顺序存储在磁盘上）。由于 GUID 是随机的，因此不确定是否会在索引末尾附加新行，但可以将其插入索引中间。这会导致磁盘垃圾，因为必须移动行。

如果您考虑 guid，至少使用 sqlserver 2005 或更高版本和 NEWSEQUENTIALID() 作为 PK 值，以获得始终大于最后一个的顺序 guid，因此始终附加在索引的末尾。如果您不使用 sqlserver（但例如 postgresql 或您使用 oracle 并使用 CHAR(32) 或其他类型），请考虑使用 COMB（请参阅： http: [//www.informit.com/articles/article.aspx? p=25862](http://www.informit.com/articles/article.aspx?p=25862) )

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-12T09:22:05.263

在阅读了 Frans Bouma 的答案后进行了编辑，因为我的答案已被接受并因此移至顶部。谢谢，弗兰斯。

GUID 确实具有很好的独特价值，但是由于它们的复杂性，它们并不是真正的人类可读的，这会使支持变得困难。如果您打算使用 GUID，您可能需要考虑在做出选择之前对批量数据操作进行一些性能分析。考虑到如果您的主键是“集群的”，那么 GUID 就不合适了。

这是因为聚集索引会导致在插入/更新时对表中的行进行物理重新排序。由于 GUID 是随机的，因此每次插入都需要移动表中的实际行以便为新行让路。

就我个人而言，我喜欢在我的数据上有两个“键”：

**1) 主键** 具有聚集主键的唯一数值。这是我系统每行的*内部*ID，用于唯一标识一行和外键。

如果您使用数据库复制（SQL Server 将自动为合并复制的表添加“rowguid”列），标识可能会导致麻烦，因为标识种子是按服务器实例维护的，并且您会得到重复。

**2) 外部密钥/外部 ID/业务 ID** 通常，最好还有一个“外部 ID”的附加概念。这通常是具有唯一约束的字符字段（可能包括另一列，例如客户标识符）。

这将是外部接口使用的值，并且会暴露给客户（他们不认可您的内部值）。这个“企业 ID”允许客户使用对他们有意义的值来引用您的数据。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T09:02:46.550

您可能需要该工具来追溯源以进行审计，尤其是在财务数据方面。

即使您在仓库系统中使用合成密钥（如果您有多个数据源，您几乎肯定会这样做），您仍然需要支持审计。在系统中的表上放置一个“数据源”和“自然键”列，并用源代码和唯一标识源记录的表示填充它们。

如果你这样做，合成键只需要足够宽的整数或数字来存储足够的值（如果 <4b 行，则为整数，如果超过，则为数字）。这意味着它们将比 GUID 更具可读性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-01T15:27:41.407

下面的项目可能有一些用处，或者至少能激发你解决这个问题。

[https://github.com/twitter/snowflake](https://github.com/twitter/snowflake)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T08:53:33.870

任何可以唯一标识记录的都是良好的身份数据类型。GUID 通常很好，但如果您实际上有来自源数据的唯一 ID，则它不是最佳标识。GUID 是保证唯一的随机整数值；但是，在集成情况下，您通常希望检测信息的重复，而不仅仅是匹配记录。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T14:36:52.077

没有“最佳”身份数据类型。各种选项有不同的优点和缺点。我经常使用 GUID，但我必须定期处理断开连接的客户端和合并复制，所以选择是合适的。如果您不必处理复制（即用户在与中央数据库断开连接时添加新记录的情况），自动递增的 int 字段是更好的选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-19T16:27:45.850

GUID 在数据复制方案中更好，使用“身份”方法，您必须小心不要导致数据库之间复制的数据之间发生冲突。希望这可以帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-19T16:19:55.320

我以前根本不喜欢 GUID，但我已经爱上了它。我喜欢它，因为它相对统一且被采用，而且我最终通过使用它编写的代码和维护该代码比我通常编写和维护的代码要少。

它对于存储文件特别有用，在这种情况下，您需要保证文件名是唯一的，在具有大量文件（包括预先存在的文件）的目录中。

# java - 许多返回的记录导致 Hibernate 的 stackoverflow

> ID：362252
> 
> 赞同：1
> 
> 时间：2008-12-12T08:57:53.050
> 
> 标签：java, hibernate, stack-overflow

如果有很多来自 DB 的返回记录。它会得到stackoverflow问题。 `User`是一个类，它具有一对多的关系（与其他 3 个类）。当我打印出 SQL 时，我发现系统多次运行相同的查询以从 DB 中获取数据。有谁知道问题是什么？

```
result.addAll(getCurrentSession().createCriteria(User.class)
    .add(Restrictions.ilike("name", "tom", MatchMode.ANYWHERE))
    .setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY)
    .list()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-26T21:06:38.870

如果您正在寻找名称中只有 tom 的用户，那么它不应该耗尽内存，除非您有很多 %tom% 呵呵。

您可以尝试对其进行限制，以便它一次只返回一些您可以处理的内容。

我不确定是否有人能在没有更多信息的情况下弄清楚为什么它运行相同的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T03:19:53.937

无论如何，您使用的是 EntityMode.DOM4J 吗？（即 Hibernate --> XML 而不是 Hibernate --> POJO）。如果不进行调整，嵌套关系就无法工作，因为 XML 生成器会无限递归，因为 POJOS 可以很好地处理它们。

我可以详细说明，但如果您不使用 DOM4J，那么问题就出在了其他地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-19T19:16:55.150

这将有助于准确了解您所看到的重复查询。正如其他人指出的那样，我们只是在猜测而没有看到您的映射。您可能会遇到 Hibernate 的急切获取。这是 Hibernate 尝试为每个匹配非常通用名称的用户（及其地址、电话、宠物等）加载整个对象图的地方，其中包含“tom”查询。尝试关闭 Hibernate 映射文件或注释中用户属性的默认预取，然后执行以下操作：

假设您对表`USER_ADDRESS (hibernate property "addresses")`、`USER_PHONE (property "phones")`和进行了大量重复查询`USER_PET (property "pets")`。使用以下条件调用在原始查询中加入这些属性并减少重复查询。Hibernate 知道如何将这些列拆分为单独的对象。您也可以尝试添加最大数量的返回结果。

```
Criteria myUsers = getCurrentSession().createCriteria(User.class);
myUsers = myUsers.add(Restrictions.ilike("name", "tom", MatchMode.ANYWHERE));
myUsers.createCriteria("addresses"); // NEW
myUsers.createCriteria("phones"); // NEW
myUsers.createCriteria("pets"); // NEW
myUsers.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);
myUsers.setMaxResults(100); // NEW
result.addAll(myUsers.list()); 
```

[您可以在此处](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/querycriteria.html#querycriteria-associations)的第 15.4-15.6 节中了解更多信息

# c++ - 线程安全和`const`

> ID：362260
> 
> 赞同：11
> 
> 时间：2008-12-12T09:01:49.453
> 
> 标签：c++, multithreading

（指针、引用和成员函数）如何`const`帮助 C++ 中的线程安全？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-12T09:06:00.897

任何不可变（即不可更改）的数据本质上都是线程安全的——多个线程同时读取相同的只读数据没有风险，因为它永远不会改变！

在 C++ 中将变量标记为 const 使其只读，因此是线程安全的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-12T09:06:39.957

多线程的主要问题是可变性。const 限制了这一点，但是由于您可以抛弃 const-ness，因此它并非万无一失。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-12T09:22:23.653

const 成员函数不应更改状态，这使得同时从多个线程调用是安全的。但是线程安全不是 const 的目的，C++ 提供了 mutable 关键字和 const_cast 意味着 const 实际上并不能保证线程安全，因此不应依赖于此目的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-12T10:09:05.793

const 函数不是线程安全的。通常，您可以同时从不同的线程调用 const 对象方法，但是如果您从不同的线程调用非 const 和 const 方法，则会出现竞争条件。检查这个：

```
class Foo
{
    size_t size_;
public:
    ...
    size_t get_size() const
    {
        return size_
    }
};

class Bar
{
    boost::shared_ptr<Foo> foo_;
public:
    //accessor
    size_t get_size() const
    {
        size_t size = 0;
        if (foo_)
            size = foo_->size();
        return size;
    }
    //modifiers
    void init()
    {
        foo_ = new Foo;
    }

    void clear()
    {
        foo_ = boost::shared_ptr<Foo>();
    }
}; 
```

如果有人调用 init 方法，然后同时调用 clear 和 get_size 方法，就会导致访问冲突。您必须使用读写锁定习语。可以同时调用多个访问器，同时只能调用一个修饰符。示例：

```
class Bar
{
    boost::shared_ptr<Foo> foo_;
    mutable tbb::spin_rw_mutex lock_;
public:
    //accessor
    size_t get_size() const
    {
        size_t size = 0;
        //lock modifiers
        rw_mutex_type::scoped_lock lock(mutex, false);
        if (foo_)
            size = foo_->size();
        return size;
    }
    //modifiers
    void init()
    {
        //lock accessor and modifiers
        rw_mutex_type::scoped_lock lock(mutex, true);
        foo_ = new Foo;
    }

    void clear()
    {
        //lock accessor and modifiers
        rw_mutex_type::scoped_lock lock(mutex, true);
        foo_ = boost::shared_ptr<Foo>();
    }
}; 
```

tbb::spin_rw_lock 是来自[线程构建块库的互斥锁类](http://www.threadingbuildingblocks.org/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-15T20:33:27.800

C++ const 允许非常量别名，例如：

```
Foo myVar;
const Foo* ptr1;
Foo* ptr2; 
```

鉴于此， const 不保证数据的不变性，即使您不进行任何强制转换或任何绕过它的操作。如果您通过 ptr1 访问 myVar，则无法通过 ptr1 更改它（假设我的语法正确；这就是意图。）但是，它仍然可以通过 ptr2 更改。你真正想要的是一个单独的不可变结构。这在 C++ 中不存在。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-02-22T19:29:10.757

常量和线程安全是正交的概念。

以 const 函数为例：一个类可能同时具有 const 和非常量函数，一个线程可能正在调用一个修改对象的非常量函数，同时另一个线程在其 const 函数中。在这种情况下，标记函数 const 不会提供任何安全性。线程安全只能通过锁定或其他同步原语来实现。

# c# - 预编译一个非常大的正则表达式

> ID：362269
> 
> 赞同：2
> 
> 时间：2008-12-12T09:07:15.167
> 
> 标签：c#, vb.net, regex, compiled

我有一个非常奇怪的问题。我有一个非常大的正则表达式来搜索某些文本中的某些单词（RegEx 看起来像这样：`(?i)\b(a|b|c|d...)\b;`等等，其中 a、b、c、d 代表单词）。无论如何，我把它放在一个预编译的程序集中以加快速度，但问题是预编译的正则表达式与同一个正则表达式的非编译版本的工作方式不同...... o_0

例如，如果正则表达式是：`(?i)\b(he|desk)\b`并且我通过它传递“帮助台”，则预编译版本会返回“lp”，因此他和办公桌的单词会被删除，就好像边界条件根本不起作用一样，但是如果我确实使用了相同的正则表达式一个非预编译版本它工作得很好......有谁知道我是否可能遗漏任何东西？

谢谢

（抱歉使用 VB.Net 和 C#）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T10:14:40.040

既然您正在搜索整个单词，那么如何搜索`\w+`并检查该单词是否在集合中。基于散列的集合或散列映射在这里可以很好地工作。如果需要，这种方法将更容易更新列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T09:25:28.703

你在那里给出了两种不同的语言。所以也许有一些互动。

无论如何，我认为可能需要一些简短但完整的测试程序 - 尝试在一些独立的测试代码中重现问题，以便更容易推理。

也许在没有正则表达式的情况下进行搜索会更有效？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T09:31:53.247

我编写了两个测试应用程序，一个在 C# 中，一个在 VB.Net 中，两者都表现出相同的行为。我正在使用的正则表达式的预编译版本似乎忽略了某些单词的边界条件。我试过不使用正则表达式，但我在表达式中有一个 3000 多个单词的列表，经过一些测试，它似乎是最好的解决方案，唯一的事情是我不想在我的主代码中使用它，而是希望将它包含在一个预编译的程序集...

谢谢

# java - 在java中将十六进制字符串转换为整数

> ID：362278
> 
> 赞同：0
> 
> 时间：2008-12-12T09:12:03.537
> 
> 标签：java, core

我是java的初学者我正在从串口读取数据，我已经将数据存储在字符串数组数据中，数据长度为24字节。

我作为输出得到的数据：12120814330006050.0

data 还包含字符串中的十六进制字符，我想读取字符串的第一个字符。我已经做好了：

```
String str=dispArray[i].substring(1,2);
int i= Integer.parseInt(str,16);
System.out.println("Decimal:="+ i); 
```

但我得到 NumberFormatException.plz 帮助我阅读十六进制字符。

谢谢您的回复

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T09:19:09.903

您可以从字符串中获取的单个字符

```
str.getChar(0); 
```

当您知道字符串在每个字符中都包含十六进制值时，您不必转换每个字符。您可以将完整的字符串放入并获取十六进制字符串的 dec 值。否则，您只计算 1 个十六进制值，并且必须乘以字符位置的索引号。

要将其解析为十六进制值，您可以调用

```
Integer.parseInt(str,16); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T09:47:57.533

听起来您的数据流实际上包含二进制和文本数据的混合。非常重要（IMO），您*不要*尝试将整个内容存储为字符串。将其保存为二进制数据，并在需要时将适当的块转换为文本。

这可能意味着首先改变您从串行端口读取的方式 - 使用处理字节和字节数组而不是字符和字符串的 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T09:19:29.853

Java 字符串是 unicode - 因此字节已经使用某种编码（可能是 UTF-8？）解码。

所以：

1.  检查字符串的内容。
2.  检查子字符串的内容。

# c# - 比较通用字段

> ID：362293
> 
> 赞同：3
> 
> 时间：2008-12-12T09:20:57.167
> 
> 标签：c#, comparison, icomparable, compareto

我有一些通用类型，如下所示：

```
public struct Tuple<T1, T2> { ... }
public struct Tuple<T1, T2, T3> { ... }
etc. 
```

这些理论上应该能够将自己与相同类型的其他值进行比较，以便我可以编写以下类型的代码：

```
List<Tuple<Type, String>> l = new List<Tuple<Type, String>>();
l.Add(new Tuple<Type, String>(typeof(ISomeInterface), "123"));
if (l.Contains(new Tuple<Type, String>(typeof(ISomeOtherInterface), "123"))
    ... 
```

不幸的是，我的代码中有一个错误，然后问题就变成了如何正确地做到这一点。

该错误与我的 CompareTo> 实现有关，它基本上如下所示：

```
Int32 result = HelperMethods.CompareTwoFields<T1>(_Value1, other._Value1);
if (result != 0)
    return result;

Int32 result = HelperMethods.CompareTwoFields<T2>(_Value2, other._Value2);
if (result != 0)
    return result;

return 0; 
```

HelperMethods.CompareTwoFields 看起来像这样：

```
internal static Int32 CompareTwoFields<T>(T field1, T field2)
{
    Int32 result = 0;
    if (ReferenceEquals(field1, null) != ReferenceEquals(field2, null))
        result = ReferenceEquals(field1, null) ? -1 : +1;
    else if (!ReferenceEquals(field1, null) && field1 is IComparable<T>)
        result = ((IComparable<T>)field1).CompareTo(field2);
    else if (!typeof(T).IsValueType)
    {
        if (Object.ReferenceEquals(field1, field2))
            return 0;
        else
            return field1.ToString().CompareTo(field2.ToString());
    }
    return result;
} 
```

最后一个 if 语句有一些我现在用来修复错误的东西，但这是正确的吗？

基本上，我如何比较两个 Type 对象？除了将它们转换为字符串并进行比较之外，这些是否有有意义的比较？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T09:33:55.817

你的意思是：

```
bool equal = EqualityComparer<T>.Default.Equals(val1,val2); 
```

这适用于`IEquatable<T>`(for `T : IEquatable<T>`)，否则回退到`object.Equals`.

还有`Comparer<T>.Default`用于不平等比较（更大/更少）：

```
int delta = Comparer<T>.Default.Compare(val1,val2); 
```

这使用`T : IComparable<T>`, 或`T : IComparable`其他方式。

顺便说一句，`Type`应该只使用 提供的常规参考比较`object.Equals`，所以它应该可以正常使用上述内容。

# sharepoint - 可以覆盖 Sharepoint 中的站点创建吗？

> ID：362295
> 
> 赞同：1
> 
> 时间：2008-12-12T09:21:57.587
> 
> 标签：sharepoint, sharepoint-2007, mysite, sitedefs

我们想为不同的角色定制“我的网站”模板，比如学生和教师。所以基本上我们想要一个 Site Def。对于每个人，当他们按下“我的网站”时，我们希望根据用户的角色（学生与教师）使用不同的模板创建一个新网站。有人知道这是否可能吗？或者任何可行的解决方法？

我知道在这个过程中执行代码是可能的，我已经看过很多这样的例子，但我们想在此之前做一些事情......

编辑：是否可以覆盖“我的网站”的链接，然后手动创建一个新网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T13:15:47.247

您不能为 mysite 创建自定义站点定义。SharePoint 团队博客上描述[了](http://blogs.msdn.com/sharepoint/archive/2007/03/22/customizing-moss-2007-my-sites-within-the-enterprise.aspx)要走的路。
然后在要执行的代码中，可以根据当前用户角色激活功能。

这是我能想到的最简单（且受支持）的方式。

# java - 如何抽象出两种不同的缓存实现

> ID：362300
> 
> 赞同：0
> 
> 时间：2008-12-12T09:22:53.263
> 
> 标签：java, memcached, abstraction, ehcache, distributed-caching

我计划在我的负载平衡 web 应用程序中使用分布式缓存。所以我将尝试抽象出apache ehcache和memcached之间的共同功能。

我的目标是能够进行简单的配置切换来选择要使用的缓存解决方案。我应该走 SPI 路线，例如 XML 解析器是如何连接的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T09:30:37.617

修复界面后，这确实是一个创建模式的问题。依赖注入是我最喜欢的，如果缓存选择策略是动态的，你可以使用 spring bean factory 在运行时决定。Spring 支持 Web 应用程序上的“会话”范围，这意味着您可以让工厂根据需要决定每个会话。

否则，一个简单的服务定位器也应该可以解决问题。

[http://en.wikipedia.org/wiki/Service_locator_pattern](http://en.wikipedia.org/wiki/Service_locator_pattern)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T10:16:24.013

从我的头顶...

*   使用常见的缓存相关方法创建接口（add()、remove()、refresh() 是最明显的方法）。
*   创建该接口的实现，该实现在下面使用所需的缓存（“MyEhCacheImplementation”和“MyMemCachedImplementation”或类似的东西）。
*   创建一个 CacheFactory，它根据简单的值（如数字、字符串或枚举）返回某种类型的缓存。不要忘记为默认实现做一个后备！
*   创建某种方式在初始化时将该单个值注入工厂，例如，如果您有一些在启动期间读取各种设置的类，或者您正在使用 Spring applicationContext.xml 或类似的东西，您需要为缓存创建一个初始化方法它接受一个参数，调用工厂并返回正确类型的缓存和/或将其设置到您使用它的某个位置。

我相信这就是你在结构上需要让它可靠地工作的所有东西，这样你就可以随时扩展它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-21T04:45:11.133

Spring 也有一个缓存提供程序模块，它完全可以满足您的需求。不过，我只是不确定是否支持 memcached。即使没有，为它编写一个适配器也可能比手动滚动你自己的界面要少。见[https://springmodules.dev.java.net/docs/reference/0.8/html_single/#cache](https://springmodules.dev.java.net/docs/reference/0.8/html_single/#cache)

# c# - .NET IHttpHandler 和 HTTP/1.0

> ID：362318
> 
> 赞同：0
> 
> 时间：2008-12-12T09:35:37.327
> 
> 标签：c#, asp.net-2.0

如何在 IHttpHandler 的响应中将 HTTP 协议版本设置为 HTTP/1.0？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T10:00:40.037

您无法控制 IIS 响应的协议版本。

如果请求指示 1.0，则 IIS 应以与 1.0 客户端一致的方式响应，但是响应标头仍将指示服务器支持 1.1。

这是正确的行为。

# iphone - UITextField 输入问题

> ID：362320
> 
> 赞同：0
> 
> 时间：2008-12-12T09:38:10.503
> 
> 标签：iphone, uiwebview

在我的应用程序中有两个 Outlet，一个是 UItextfield，另一个是 UIWebview，textfield 用于获取用户的 url 请求并在 webview 中显示，但我遇到了一个问题是在我的 textfield 中完成输入时，然后单击 GO 按钮(return) 在键盘上，那在我的 webview 中什么都没有发生，我的源代码如下所示：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    NSLog(@"clicked");
    [textField resignFirstResponder];
    [mywebview loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:[textField text]]]];

    return YES;
} 
```

问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T16:28:01.260

您是否将文本字段的委托设置为具有 textFieldShouldReturn: 方法的类？

# .net - WCF 套接字错误 10045

> ID：362321
> 
> 赞同：0
> 
> 时间：2008-12-12T09:38:32.687
> 
> 标签：.net, visual-studio-2008, wcf

我的同事有一个应用程序，它托管一个带有 net.tcp 端点的简单 WCF 服务。我可以将服务引用添加到我使用地址 net.tcp://192.168.0.22:9999/GSS-POS/QueryDispatcher/mex 创建的任何应用程序中

但是，当他尝试将服务引用添加到在他的机器上运行的应用程序时，他立即收到套接字错误 10045。我们尝试使用 net.tcp://localhost:9999/GSS-POS/QueryDispatcher/mex

和

net.tcp://192.168.0.22:9999/GSS-POS/QueryDispatcher/mex

他尝试重新安装 Visual Studio 2008、Service Pack 1 和 XP Service Pack 3，但均无济于事。任何人都可以提供任何指示吗？

更新：这似乎与 Visual Studio 有关。通过使用 WCF 客户端测试应用程序，可以看到该服务。似乎 VS 在添加服务引用时遇到了问题。

更新 2：使用 VS 2008 添加引用适用于命名管道和 http 传输。该问题仅在尝试添加使用 net.tcp 端点的服务引用时才会出现。

此致，

西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T13:17:06.603

我没有给你答案，但代码 10045 代表 WSAEOPNOTSUPP（不支持操作），根据[MSDN](http://msdn.microsoft.com/en-us/library/ms740668(VS.85).aspx)，这意味着：

> 引用的对象类型不支持尝试的操作。通常，当无法支持此操作的套接字的套接字描述符试图接受数据报套接字上的连接时，就会发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T13:11:41.407

[Juval Lowy](https://rads.stackoverflow.com/amzn/click/com/0596526997)的书说，tcp 通信仅针对 WCF->WCF 通信进行了“优化”。也许这与你的问题有关。

# class - 如何实现所有使用相同变量的类

> ID：362326
> 
> 赞同：0
> 
> 时间：2008-12-12T09:41:48.110
> 
> 标签：class, field

我有 6 个类，它们都是文档类型。所有文档类型都有相同的 8 个字段。有一个类只包含这 8 个字段。其余的类有更多的领域。其中一些类具有相同的字段（除了 8 个字段）。

例子：

类文档：字段 1 到 8

类表格：字段 1 到 8 以及字段 9 和 10

类 WorkInstruction：字段 1 到 8 以及字段 9 和 10

类过程：字段 1 到 10 和字段 11

希望这能说明我的观点。

我的问题是，实现这一点的最佳方法是什么？我应该创建一个或多个接口，还是应该使用抽象类？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T09:46:06.337

要么使 Document 成为 Form 等的基本类型，要么使表单具有额外的字段和对单独 Document 的引用（即使用组合而不是继承）。在这种情况下，继承听起来很可能是最好的选择，但这真的取决于你想用它做什么。您是否有适用于任何文档的代码，包括 Form、WorkInstruction 等？

编辑：例如，假设您有一个用户界面控件，它可以显示任何文档的公共部分 - 即常见的 8 个字段。那将需要一个 Document 的实例。您*可能*希望能够直接将 Form 或 WorkInstruction 传递给它 - 在这种情况下，最好从 Document. 或者，在呈现 Form 或 WorkInstruction 时，您可以创建一个单独传入文档部分的控件实例。即这之间的区别（在 C# 中 - 你没有指定你感兴趣的语言）：

```
class Form : Document { ... }

// Later on
Controls.Add(new DocumentDisplay(form)); 
```

还有这个：

```
class Form
{
    private Document Document { get; set; }
    // Other stuff
}

// Later on
Controls.Add (new DocumentDisplay(form.Document)); 
```

在不了解您设计的其余部分的情况下，很难推荐其中一种。我*通常*更喜欢组合而不是继承，但这感觉更像是一种自然的继承情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T10:41:38.330

The old school answer would be creating a class with the shared fields and inherit.

The trendy answer would be to create a class that has those fiends and have it as a member.

Inheriting creates more dependency between the classes, if you will every change the base, which is considered bad practice.

In a simple case it doesn't really make that much difference. But if you start adding behavior to those fields it may.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T11:13:56.143

Too little information to give a definitive answer

If the only thing these objects share is data attributes... I'd use something like this.

```
class Document
{
   List<Field> m_Fields;
   public void AddField(Field f) {... }
   public void AddFields(Field[] f) {... }
}

class DocumentFactory()
{
  public static Document GetDocument()
  {
     Document d = new Document();
     d.AddFields(GetDocumentFields());      // private helper .. returns fields 1-8
     return d; 
  }
  public static Document GetForm()
  {
     Document d = new Document();
     AddDocumentFields(d);
     d.AddField(FIELD_9);
     d.AddField(FIELD_10);
  }
  // and so on..
} 
```

Any code that works irrespective of type of document, goes into the Document class.
If in addition to this you have behavior that is specialized/based on specific object type, you'd need to grow an inheritance type-hierarchy (as Jon says.. it looks like a IS-A relationship from the names.)

# php - 无法从 PHPDocumentor 中排除目录

> ID：362328
> 
> 赞同：5
> 
> 时间：2008-12-12T09:42:56.110
> 
> 标签：php, documentation, phpdoc

我正在尝试在我的 WAMPServer 设置上运行 PHPDocumentor。它运行良好，但我想排除某些目录，例如不包含我自己的代码的 \sqlbuddy\。具有讽刺意味的是，PHPDocumentor 似乎忽略了我的 --ignore 开关。我尝试了几种表达相同事物的方法，但结果相同。下面是我运行它的命令：

```
php.exe "C:\Users\username\Documents\PhpDocumentor\phpdoc" -t "C:\Program Files\wamp\www\docs" -o HTML:default:default -d "C:\Program Files\wamp\www" --ignore sqlbuddy\ --ignore docs\ 
```

非常感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-11-05T11:07:55.627

我遇到了同样的问题，但原因不同：忽略多个目录需要传递一个逗号分隔的列表，即：

`--ignore sqlbuddy/,docs/`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T18:22:36.670

您使用的是哪个版本的 phpDocumentor？

因为[phpDocumentor 1.4.2 发行说明](http://phpdoc.org/news.php?id=57)指出：

> 此版本修复了两个特定于 Windows 的错误，一个涉及使用“--ignore”选项，一个涉及使用 @filesource 标记。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T12:49:22.730

您可能需要将该忽略值更改为正斜杠...

在内部，旧的 PHP4 时代的 PhpDocumentor 仍然有一些自己的斜杠处理，它试图使所有目录分隔符仅读取为正斜杠。将其与 --ignore 选项值结合起来，实际上是正则表达式掩码，并且很容易看出反斜杠（通常是正则表达式中的转义字符）如何成为意外行为的潜在原因。

尝试改用“--ignore sqlbuddy/”，让我们知道这是怎么回事。

# php - 是否有类似 activerecord 的数据库模式迁移的独立替代方案？

> ID：362334
> 
> 赞同：1
> 
> 时间：2008-12-12T09:46:31.797
> 
> 标签：php, python, sql, mysql, shell

是否有类似 activerecord 的迁移的独立替代方案。类似于能够跟踪当前模式版本并应用未完成迁移的脚本。基本上，这些迁移文件可能只是一个普通的 SQL 文件，例如：

```
[时间戳]_create_users.sql
reverse_[时间戳]_create_users.sql

```

实现语言不是很重要——它可以是通常安装/预安装在 *nix 系统上的任何东西。

我试图找出一些东西——但失败了。我当然可以在一两个小时内开发自己的，但我只是好奇——可能已经有一些不错的东西了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T12:54:19.863

试试[http://freshmeat.net/projects/liquibase/](http://freshmeat.net/projects/liquibase/)

如果您专门使用 MySQL，请查看： [http](http://www.mysqldiff.org/) ://www.mysqldiff.org/ 我使用它来同步两个数据库的模式（因此您必须将更改应用于“主”）。

还有[http://phpmyversion.sourceforge.net/](http://phpmyversion.sourceforge.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T20:59:27.700

[http://code.google.com/p/sqlalchemy-migrate/](http://code.google.com/p/sqlalchemy-migrate/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T10:01:20.847

不是 linux 选项，但可能会为某些人回答这个问题：

SQLYog 可以为 MySQL 执行此操作 - 它是一个 Windows GUI 工具：

[http://www.webyog.com/en/](http://www.webyog.com/en/)

它可以（除其他外）比较模式并使一个模式看起来像另一个模式，或者如果您想这样做，则可以生成执行此操作所需的 sql。我们用它来制作可用于升级的 sql 补丁文件。它比在开发中进行更改时手动维护文件更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T01:50:25.550

[https://sourceforge.net/projects/migrations/](https://sourceforge.net/projects/migrations/)

这是一个用于管理基于从 Rails 迁移的 Active Record 对数据库模式的结构更改的工具。具有多种模式交互、值的运行时替换、脚本生成等功能。

此外，它同时具有命令行界面和图形界面。Also 正在积极开发中，我们公司已经使用它一年多了，它极大地改善了每个人的生活，从开发到 dbas，再到运营，再到简化的部署和回滚。管理层现在认为数据库更改是理所当然的（有时不是一件好事），因为有了这个工具，它现在变得如此自动化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T12:59:02.740

查看[自动补丁](http://autopatch.sourceforge.net/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T13:20:26.537

ezComponents 库有一个[数据库模式组件](http://www.ezcomponents.org/docs/api/latest/introduction_DatabaseSchema.html)，可以比较和应用两个数据库（或数据库和文件）之间的模式差异。

# swt - 为什么 Table.getItem(Point) 总是从零列返回项目？

> ID：362336
> 
> 赞同：0
> 
> 时间：2008-12-12T09:47:21.373
> 
> 标签：swt, eclipse-rcp, jface

我已经实现了一个类来为 org.eclipse.swt.widgets.Table 类提供更灵活的提示。我相信你们都知道，默认情况下，您会为整个表格获得一个工具提示 - 而不是每个单元格的单独提示。

我的对象创建了许多侦听器来实现它自己的位置敏感工具提示，但是，当我调用 Table.getItem(Point) 来获取鼠标悬停在其上的 TableItem（或单元格）时，它总是从第 0 列返回单元格正确的行。

有问题的表是由具有此咒语的 TableViewer 创建的...

```
viewer = new TableViewer( parent, SWT.MULTI | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION ); 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T13:18:50.713

答案最终是 TableItem 代表一行，而不是一行中的一个单元格。这个小方法将为您获取列号...

```
/**
 * Get the column from the given TableItem and Point objects 
 * @param pt
 * @param item
 * @return -1 if no column is found
 */
public static int getColumn( Point pt, TableItem item )
{
    int columns = item.getParent().getColumnCount();
    for (int i=0; i<columns; i++)
    {
        Rectangle rect = item.getBounds (i);
        if ( pt.x >= rect.x && pt.x < rect.x + rect.width ) return i;
    }
    return -1;
} 
```

注意： Rectangle.intersects( Point ) 如果您将鼠标准确地悬停在表格边缘上，则可能会失败，因此我使用了简单的 X 比较。

# css - 有效的 CSS、XHTML 标志生成器

> ID：362342
> 
> 赞同：3
> 
> 时间：2008-12-12T09:51:27.403
> 
> 标签：css, xhtml, icons

我曾经知道一个网站，用户可以在其中生成小的 W3C 有效 CSS 标签，它看起来比太大的 W3C 官方标签要好得多。也可以用其他内容的任何内容和颜色填充图标。

我丢失了书签，无法用谷歌搜索它，你能发布它以及其他类似的资源吗？

编辑：是的，我知道...

我可以修改现有图标来创建自己的图标吗？

不可以。验证者的图标是根据 W3C 文档许可证分发的，该许可证允许分发但不允许衍生作品。

但我不在乎，因为我不希望我的设计看起来很丑。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T10:02:12.437

您可能指的是[antipixel 的图标](http://antipixel.com/blog/archives/2002/10/22/steal_these_buttons.html)和[LucaZappa 的 Brilliant Button Maker](http://www.lucazappa.com/brilliantMaker/buttonImage.php)。

[图标图片 http://img353.imageshack.us/img353/1368/stealthesebuttonsli4.gif](http://img353.imageshack.us/img353/1368/stealthesebuttonsli4.gif)

来自反[像素网站](http://antipixel.com)：

> **如果你想要它们，它们就是你**的， **免费的，没有附加条件。**
> 
> **如果您愿意，可以直接将它们从主页上拉下来** **，如果您想** **更改它们的任何内容，请继续** **执行此操作。**我在下面发布了 Photoshop 文件，因此您可以下载这些文件并更改您想要的任何内容。你不需要给我信用或在此处提供链接或类似的东西。（有些人已经在使用它们，并且至少有一个善良的灵魂在这里发布了这样的链接。你不需要再这样做了，但感谢你是一个非常体面的人。）

[RSS 按钮也可用。](http://www.antipixel.com/blog/archives/2002/10/23/rss_buttons.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T10:04:47.000

这是 antipixel 的原始徽章：

[http://www.antipixel.com/blog/archives/2002/10/22/steal_these_buttons.html](http://www.antipixel.com/blog/archives/2002/10/22/steal_these_buttons.html)

[http://www.antipixel.com/blog/archives/2002/10/23/rss_buttons.html](http://www.antipixel.com/blog/archives/2002/10/23/rss_buttons.html)

这是生成器：

[http://www.lucazappa.com/brilliantMaker/buttonImage.php](http://www.lucazappa.com/brilliantMaker/buttonImage.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T10:07:00.663

不过要小心，W3C 对他们的标志使用非常严格（就像任何公司一样）：
[W3C 标志和图标使用](http://www.w3.org/Consortium/Legal/logo-usage-20000308)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T10:22:18.090

你不希望你的设计看起来很业余吗？然后不要把那些标志放在上面。唯一可能关心您的网站是否有效的人会检查他们是否看到徽标。

# php - 动态图像创建

> ID：362352
> 
> 赞同：0
> 
> 时间：2008-12-12T10:01:02.407
> 
> 标签：php, jquery

是否可以将网页的某些部分转换为图像。假设我有一个 div，其中包含文本和图像。我想将整个 div 存储为服务器端的图像，以便我可以从下一次开始使用该图像。

你能否让我知道是否有任何 jquery 插件/ php 扩展可以做到这一点。我刚刚发现了这个[http://www.visionmasterdesigns.com/tutorial-convert-text-into-transparent-png-image-using-php/](http://www.visionmasterdesigns.com/tutorial-convert-text-into-transparent-png-image-using-php/)

但这只是将文本转换为png。但我想将 a 转换为图像。

提前致谢。

问候，~沙菲

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T10:24:34.527

您可以使用浏览器引擎将页面呈现为图像，然后剪切页面的请求部分。

我不知道是否有 jquery 或 php 扩展程序可以为您执行此操作，但您可以使用 exec 调用并使用例如[CutyCapt](http://cutycapt.sourceforge.net/)来呈现页面，并使用图像处理扩展程序来裁剪它。我自己没有测试过这个软件，但这是一个开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T16:51:53.407

"I have a sample div which is exposed to the user to modify it. That accomodates two images and some text. He can select the image out of many which we offer. Finally I want to store it as one big image."

In that case, client-side screen capture is the wrong way to go about it. You should allow the image to be composited on the users browser (as it sounds like you have this part done), but then have the browser send back the information required to recreate the image* on the server, which you then do with GD, ImageMagick or something similar. It'll be easier, cleaner and quicker in so many ways :)

*for example:

*   imageid: 7
*   text: 'blah'
*   textcolour: #ffffff
*   textsize: 3
*   textx: 10
*   texty: 10

EDIT: You should probably also put the quoted part into the question, as it isn't entirely clear from the original post.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T15:08:00.937

你到底想通过这样做来完成什么？

LOLcat 风格的图像字幕？我会使用 Gd2 并直接修改图像。

简化的网页布局？缓存 div 的源代码可能更快。我还建议手动创建一些并比较生成的文件传输大小，我敢打赌在几乎所有情况下（原始 HTML + 图像）都小于（结果图像）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T10:09:16.353

我很确定你不能在 JavaScript / jQuery 中做到这一点。无论如何都不是没有一些插件。

此外，将文本存储为图像听起来有点奇怪。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T10:23:51.673

您可以调查使用其中一项服务的可能性。他们中的大多数人都按照美味的用途做缩略图。但是[http://www.webshotspro.com/](http://www.webshotspro.com/)看起来它可以做完整的分辨率。有没有办法可以使用他们的 API 来获取屏幕截图，然后裁剪出你需要的部分？这真的取决于你关心什么/为什么要捕捉这个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T14:52:57.753

绝对不要在客户端上这样做，即使有办法（js和canvas元素），你也必须相信客户端（垃圾邮件发送者可以用它来给你广告而不是你的部分截图），是取决于客户的字体、颜色设置等。

正确的方法是在服务器上，或者调用命令行浏览器，以编程方式获取屏幕截图并关闭它（但这将是**非常**棘手的实现，对服务器征税，以及当你例如清除缓存时会发生什么？一个受欢迎的网站，所有内容都可以立即重新渲染，并尝试将 100 多个浏览器实例放入 RAM ...）。

我会：

1.  考虑一下我是否真的需要这样做，以及是否有更好的解决方案来解决最初的问题（您需要将网站的某些部分渲染为图像，究竟为什么？缓存 html 的那部分可以解决问题吗？还是 iframe？）
2.  如果是，请使用 PHP 支持的图形库，如 GD，您必须自己合成绘图，也许有一些库可以在更高级别上进行（用文本填充布局区域而不是手动拆分它逐行等...）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T21:08:55.013

如果您决定渲染图像，则必须

1.  调用独立的网络浏览器，或
2.  嵌入 (X)HTML 渲染引擎，或
3.  限制输入选项，以便您可以编写（非常简化的）自定义渲染器，或者
4.  将工作委托给外部服务

所有这些都取决于服务器的操作系统、可用的软件以及您拥有的访问权限。

1.  在 Windows 上：使用 COM 自动化调用 IE；在 Linux 上：参见[http://www.chimeric.de/blog/2007/1018_automated_screenshots_using_bash_firefox_and_imagemagick](http://www.chimeric.de/blog/2007/1018_automated_screenshots_using_bash_firefox_and_imagemagick)

2.  在 Windows 上：请参阅[http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)；在 Linux 上，请参阅[http://webkit.org/building/build.html](http://webkit.org/building/build.html)或[http://khtml2png.sourceforge.net/](http://khtml2png.sourceforge.net/) 您可能还会考虑 PHP-Qt 或 PHP-GTK 绑定。

希望有帮助。

# vb6 - 如何在 Visual Basic 6 中对齐 RichEdit 粘贴对象位置？

> ID：362355
> 
> 赞同：0
> 
> 时间：2008-12-12T10:04:33.570
> 
> 标签：vb6, sendmessage, richedit

我们有一个[RichEdit](http://blogs.msdn.com/murrays/archive/2006/10/14/richedit-versions.aspx)控件，允许用户在其中插入[Office MathML](http://en.wikipedia.org/wiki/Office_MathML)方程对象。

基本上逻辑是这样的：用户点击插入数学方程，我们允许他们使用外部的 MathML 编辑器，然后我们将一个图像来表示方程到 RichEdit 控件中：

```
' Paste the picture into the RichTextBox.
SendMessage ctlLastFocus.hwnd, WM_PASTE, 0, 0 
```

找到它的位置并将其锁定使用：

```
With ctlLastFocus
    'lock the image
    .SelStart = .SelStart - 1
    .SelLength = 1
    .SelProtected = True 
```

在美丽的 ANSI 世界里一切都很好，但我们也允许使用[Unicode](http://en.wikipedia.org/wiki/Unicode)字符，而我注意到，当你使用汉字时，插入的位置错了总位置的一半，即如果它应该成为第 7 个位置，现在它被插入到第三个位置。

基本上除以二，我猜是因为 Unicode 需要两个字节，而 ANSI 只需要一个字节。所以因为我是一个没有[RTF](http://en.wikipedia.org/wiki/Rich_Text_Format)、RichEdit 和 Visual Basic 6 经验的傻瓜。

所以我的问题是：我可以在使用 sendMessage 行粘贴图像时更改图像的位置吗？

或者通过其他方式来控制插入到 RichEdit 框中的图像的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T13:34:21.733

我的方法是这样，如果您查看该`rtf.SelRTF`属性，您将能够准确地看到在 RichTextBox 中创建视觉效果的 RTF 代码。然后，您可以将其保存到文件中，将其加载到 word 中并移动图像直到它在正确的位置，保存文件并再次查看 RTF 代码。此时，您应该对中文或其他 Unicode 语言的组合有足够的了解，以构建字符串操作代码来执行您想要的操作。我不完全确定每个 unicode 字符都是 2 个字节 - 如果您认真支持全系列，值得一试。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T13:59:31.150

为什么不在粘贴之前检索位置？

```
Dim iStartPos As Long
Dim iLength As Long
With ctlLastFocus
    iStartPos = .SelStart
    SendMessage.hwnd, WM_PASTE, 0, 0
    iLength = .SelStart - iStartPos
    .SelStart = iStartPos
    .SelLength = iLength
    .SelProtected = True
End With 
```

# mapi - MAPI33.dll 的下载位置？

> ID：362359
> 
> 赞同：4
> 
> 时间：2008-12-12T10:07:40.193
> 
> 标签：mapi

从哪里可以下载 MAPI33.dll。我从一个站点获得了链接[http://www.mapi33.adexsolutions.com/](http://www.mapi33.adexsolutions.com/)但似乎这不正确。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T10:40:14.497

您可以在此处找到旧版本：

[http://g8.cx/mapi/](http://g8.cx/mapi/)

必须购买最新版本。

我引用：

> 以下代码示例可能已过时。它们可能不适用于当前版本的 mapi33 dll，尽管它们仍然可以使用示例 zip 文件中包含的过期（但运行良好且免费）版本的 mapi33 dll。
> 
> 要获取有关 mapi33 dll 的最新信息并购买最新版本，请访问 mapi33 网站 [http://www.mapi33.adexsolutions.com/](http://www.mapi33.adexsolutions.com/)

公司主页的链接似乎已过时。

然而，示例链接不是。它可以在第 4 节下找到，也可以作为直接链接在这里找到：

[http://g8.cx/mapi/ExtendedMapiWithCSharp_sourcecode.zip](http://g8.cx/mapi/ExtendedMapiWithCSharp_sourcecode.zip)

我在写这篇文章时验证了示例链接是否有效。

# java - 在 Grails 中调整图像大小

> ID：362360
> 
> 赞同：13
> 
> 时间：2008-12-12T10:07:58.150
> 
> 标签：java, grails, image-processing, frameworks

我正在使用 Grails 开发网络相册，对于图像处理，我正在使用 grails-image-tools 插件。如果上传的图像尺寸太大（例如：超过 600 * 840 ），我需要一个调整图像大小的功能。在这种情况下，我需要将此图像的大小调整为 600 * 840）。最有效的方法是什么？非常感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-30T20:07:45.467

在[imgscalr](http://www.thebuzzmedia.com/software/imgscalr-java-image-scaling-library/)`BuildConfig.groovy`添加依赖项

```
dependencies {
    compile 'org.imgscalr:imgscalr-lib:4.1'     
} 
```

然后调整图像大小变成单行：

```
BufferedImage thumbnail = Scalr.resize(image, 150); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-12T10:28:49.793

```
import java.awt.Image as AWTImage 
import java.awt.image.BufferedImage      
import javax.swing.ImageIcon 
import javax.imageio.ImageIO as IIO  
import java.awt.Graphics2D

static resize = { bytes, out, maxW, maxH -> 
    AWTImage ai = new ImageIcon(bytes).image 
    int width = ai.getWidth( null ) 
    int height = ai.getHeight( null )

    def limits = 300..2000 
    assert limits.contains( width ) && limits.contains( height ) : 'Picture is either too small or too big!'

    float aspectRatio = width / height float requiredAspectRatio = maxW / maxH

    int dstW = 0 
    int dstH = 0 
    if (requiredAspectRatio < aspectRatio) { 
        dstW = maxW dstH = Math.round( maxW / aspectRatio) 
    } else { 
        dstH = maxH dstW = Math.round(maxH * aspectRatio) 
    }

    BufferedImage bi = new BufferedImage(dstW, dstH,   BufferedImage.TYPE_INT_RGB)            
    Graphics2D g2d = bi.createGraphics() g2d.drawImage(ai, 0, 0, dstW, dstH, null, null) 

    IIO.write( bi, 'JPEG', out )
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T08:13:27.167

使用 ImageTool 插件。 [https://grails.org/plugin/image-tools](https://grails.org/plugin/image-tools) PS 仅适用于 grails v2。

# language-agnostic - 在 7-10++ 年的 OO 开发经验之后，您获得了哪些开发技能？

> ID：362365
> 
> 赞同：4
> 
> 时间：2008-12-12T10:10:36.960
> 
> 标签：language-agnostic, oop

一些开发技能，比如重构操作，感觉他们有几乎无限的学习潜力——只有傻瓜才会说他已经学完了。

其他技能与特定工具绑定，作为优秀的开发人员，我们大部分时间都在学习新工具。

但有些技能与您如何看待代码以及如何处理编码有关，有时还与如何应用特定工具功能有关。轮换结对编程和与其他人密切合作似乎是获得这些技能的最佳方式，但肯定不是唯一的方法。（有时你会学到 5 年前应该学到的东西，这些不是我要问的）

所以我想将程序与所有 StackOverflow 配对：

您最近获得的编码技能是什么？

编辑：我想我并没有考虑如果你今天刚从学校毕业，你会在课程中学到的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-12T10:23:22.503

只有当我意识到我需要**人际交往能力**来补充我的技术技能时，我才真正开始发展我的职业生涯。

令人惊讶的是，与“开发技能”相比，程序员经常忽略这一点或将其视为不重要的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-12T10:45:35.343

这可能看起来很愚蠢而且很明显，但是......我认为这需要很多年才能掌握它，就我而言：

*   知道何时在真正需要的地方写评论。
*   知道什么时候不要写注释，因为代码现在已经足够自我记录了。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-12T11:57:18.950

成为团队中更好的开发人员的软技能，而不是真正能够制作（或多或少）符合规范并编译的应用程序并使用户/测试人员不会大声喧哗的具体细节。

1.  何时防御性地编写可扩展代码，因为您知道这最终会节省您的时间。
    *   何时明确不执行第 (1) 点。
    *   如何在团队中工作
    *   如何阅读并响应一个不是非常精确或清楚写的规范
    *   什么时候（以及如何）让别人做这个时髦的项目，因为你太忙于苦差事

主要是关于成为一个更好的驮畜，有时间和地点成为一个阿尔法男性，但程序员经常无法接受批评，我们不能总是把项目当作我们的玩具玩。

如果你做不到，那么 Guy Kawasaki 和 Joel Spolsky 写了很多关于创建自己公司的好东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T10:19:51.167

原型设计和模拟。

我回想过去，当我一头扎进“原位”开发功能时——最好将问题隔离在沙盒应用程序中。

嘲弄——再一次，遵循隔离原则（分治法），这绝对是我现在提出的任何设计的核心。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-12T10:28:52.397

我开始编码时不具备的一些技能：

*   单元测试，
*   重构，
*   其他一些敏捷范例。

只有当你停止呼吸时，你才应该停止学习。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-12T11:47:21.717

实用主义和人际交往能力。

对情况务实。是的，它可能是理想的，但它真的有必要吗。有些东西可能是世界上最酷的功能，但它真的会产生更多的收入吗？提出这些问题并保持现实将使您从小麦中过滤掉很多谷壳。

我还在学习人际交往能力。这不仅仅是要知道所有的答案，而是能够以他们会理解和接受的方式将这些传递给管理层和客户。作为一个患有强迫症和双极的自闭症患者有时会让事情变得有点棘手。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-12T11:56:53.460

嗯，通过依赖注入编写可测试的代码。*之前*我们是怎么管理的...

对我来说，知道要测试什么。

有一段时间我是一个狂热者，他说一切都必须经过测试，DTO 的 get/set 方法等。这是不切实际和不必要的。您必须测试（至死）复杂和关键的东西，因为那是您的复杂和关键缺陷所在。轻轻测试其余部分。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-12T17:12:17.317

我已经学会了不要亲自依附于我编写的代码。当人们更改我的代码或批评我的代码时，我不再感到人身攻击/违规。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-12T10:36:50.057

我可能不属于管理层（我在那里工作了几年）。我比管理更快乐编码:)

编辑：此外；我刚刚开始真正掌握 TDD，我很享受它！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-12T12:51:32.037

软件架构，大型编程。我意识到软件>>代码，编程语言的问题充其量是第三级的。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-17T01:53:53.030

谦卑地看到这么多代码，有的好，有的坏，还有一些很奇怪，以至于你认识到你想在你工作的地方拥有什么，你不想拥有什么。例如，有些人喜欢“牛仔”风格的编程，而另一些人则完全有条不紊，不会将其作为计划的一部分，该计划已由 3 名高层管理人员编写、审查和签署，以得到祝福做一些可能需要几周时间的事情。

更好地组织代码并查看可以在哪里重构以使某些东西更通用，以便它有更多用途，或者何时尝试锁定某些东西以便完成，而不是在客户不知道的情况下一遍又一遍地进行外观更改他们想要什么，但他们不想要他们见过的 101 个原型。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-12T11:09:07.900

知道：虽然我可以，但这并不意味着我应该“放纵”自己并构建我遇到的每一个请求。我的主要目标是提供一个解决方案，如果这意味着采用已经存在的东西并对其进行扩展 - 就是这样。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-17T02:10:51.827

我真的同意“人际交往能力”的帖子，但除此之外：

举个例子——我真的明白语言实际上不是语言。他们是方言。

似乎对于进入我手指自主部分的每一个微知识，我都有能力将其概括为对事物的更高层次的理解。-- 这些是我父亲的话，他是一名焊工/钢铁工人。不能再同意了。

/罗伯特

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-12T10:30:01.897

仅使用我的代码的逻辑结构并尽可能忽略物理文件位置。

# java - Java 数组和泛型：Java 等价于 C# IEnumerable

> ID：362367
> 
> 赞同：48
> 
> 时间：2008-12-12T10:10:57.223
> 
> 标签：java, arrays, generics

所以在 C# 中，我可以将 a`string[]`视为`IEnumerable<string>`.

有Java等价物吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-12-14T16:25:49.230

`Iterable<String>`相当于`IEnumerable<string>`。

如果实现了数组，这将是类型系统中的一个奇怪之处`Iterable`。`String[]`是 的一个实例`Object[]`，但`Iterable<String>`不是`Iterable<Object>`. 类和接口不能乘以不同的泛型参数实现相同的泛型接口。

`String[]`就像`Iterable`在增强的 for 循环中一样工作。

`String[]`可以很容易地变成`Iterable`：

```
Iterable<String> strs = java.util.Arrays.asList(strArray); 
```

比数组更喜欢集合（无论如何对于非基元）。引用类型的数组有点奇怪，自 Java 1.5 以来很少需要。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-12T10:23:46.697

你在找`Iterable<String>`吗？

```
Iterable<T> <=> IEnumerable<T>
Iterator<T> <=> IEnumerator<T> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-12T10:21:38.903

`Iterable <T>`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T10:30:33.050

我相信 Java 等价物是`Iterable<String>`. 虽然`String[]`没有实现它，但无论如何您都可以遍历元素：

```
String[] strings = new String[]{"this", "that"};
for (String s : strings) {
    // do something
} 
```

如果你真的需要实现的东西`Iterable<String>`，你可以这样做：

```
String[] strings = new String[]{"this", "that"};
Iterable<String> stringIterable = Arrays.asList(strings); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-04T10:06:05.370

`Iterable<T>`可以，但是有个小问题。它不能在`stream()`ie lambda 表达式中轻松使用。

如果你愿意，你应该得到它的分裂器，并使用 class `StreamSupport()`。

# database - 目前持久性的最佳实践是什么？

> ID：362380
> 
> 赞同：8
> 
> 时间：2008-12-12T10:19:57.207
> 
> 标签：database, orm, persistence

我来自java背景。

但是我想从跨平台的角度来看待持久对象的最佳实践。

在我看来，有3个阵营：

*   ORM营
*   直接查询阵营 eg JDBC/DAO, iBatis
*   LINQ 阵营

人们仍然对查询进行手工编码（绕过 ORM）吗？为什么，考虑通过 JPA、Django、Rails 提供的选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T12:26:15.473

没有一种持久性的最佳实践（尽管尖叫 ORM 是最佳实践的人数可能会让您不相信）。唯一的最佳实践是使用最适合您的团队和项目的方法。

我们使用 ADO.NET 和存储过程进行数据访问（尽管我们确实有一些帮助程序可以非常快速地编写，例如 SP 类包装器生成器、对象转换器的 IDataRecord 以及一些封装常见模式和错误处理的高阶过程） .

有很多原因我不会在这里讨论，但我只想说它们是对我们团队有用并且我们团队同意的决定。归根结底，这才是最重要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T11:33:34.310

我目前正在阅读.net 中的持久对象。因此，我无法提供最佳实践，但也许我的见解可以为您带来一些好处。直到几个月前，我一直使用手工编码查询，这是我 ASP.classic 时代的一个坏习惯。

**Linq2SQL** - 非常轻量级且易于上手。我喜欢强类型查询的可能性以及 SQL 不会立即执行的事实。相反，它在您的查询准备好（应用了所有过滤器）时执行，因此您可以将数据访问与数据过滤分开。此外，Linq2SQL 允许我使用与动态生成的数据对象分开的域对象。我还没有在更大的项目上尝试过 Linq2SQL，但到目前为止它似乎很有希望。哦，它只支持 MS SQL，这是一种耻辱。

**实体框架**- 我玩了一点，不喜欢它。它似乎想为我做所有事情，并且它不适用于存储过程。EF 支持 Linq2Entities，它再次允许强类型查询。我认为它仅限于 MS SQL，但我可能是错的。

**SubSonic 3.0 (Alpha)** - 这是支持 Linq 的更新版本的 SubSonic。SubSonic 最酷的地方在于它基于模板文件（T4 模板，用 C# 编写），您可以轻松地对其进行修改。因此，如果您希望自动生成的代码看起来不同，您只需更改它:)。到目前为止，我只尝试了预览，但今天会看一下 Alpha。看看这里[SubSonic 3 Alpha](http://blog.wekeroad.com/blog/subsonic-3-alpha-updated/)。支持 MS SQL，但很快将支持 Oracle、MySql 等。

到目前为止，我的结论是在 SubSonic 准备好之前使用 Linq2SQL，然后切换到它，因为 SubSonics 模板允许更多的自定义。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T12:10:42.417

至少还有一个：[系统流行](http://www.prevayler.org/wiki/;jsessionid=273ACA00BCB9D135E2FB0A10BC7B90A2)度。

据我所知，什么对你来说是最佳的，很大程度上取决于你的情况。我可以看到对于非常简单的系统，使用直接查询仍然是一个好主意。此外，我看到 Hibernate 无法很好地处理复杂的遗留数据库模式，因此使用 ORM 可能并不总是一个有效的选择。如果您有足够的内存将所有对象放入 RAM，则系统流行度应该是无与伦比的快。不知道 LINQ，但我想它也有它的用途。

因此，通常情况下，答案是：了解各种工作工具，以便您能够使用最适合您的具体情况的工具。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T14:21:12.683

最佳做法取决于您的情况。

如果您需要具有某种有意义结构的表结构中的数据库对象（因此每个字段一列，每个实体一行等），您需要在对象和数据库之间存在某种转换层。这些分为两个阵营：

*   如果数据库中没有逻辑（只是存储）并且表很好地映射到对象，那么 ORM 解决方案可以提供快速可靠的持久性系统。Toplink 和 Hibernate 等 Java 系统是这方面的成熟技术。

*   如果持久性*中*涉及到数据库逻辑，或者您的数据库模式已明显偏离您的对象模型，则由数据访问对象包装的存储过程（您喜欢更多的模式）比 ORM 涉及更多但更灵活。

如果您不需要结构化存储（并且您需要确定不需要，因为将其引入现有数据*并不*好玩），您可以将序列化的对象图直接存储在数据库中，绕过很多复杂性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-16T00:40:43.427

我更喜欢编写自己的 SQL，但这样做时我会应用我所有的重构技术和其他“好东西”。

我编写了数据访问层、ORM 代码生成器、持久层、UnitOfWork 事务管理和大量 SQL。我已经在各种形状和大小的系统中做到了这一点，包括极高性能的数据馈送（40000 个文件，每天总计 4000 万个事务，每个在两分钟内实时加载）。

最重要的标准是命运，因为它控制着它。永远不要让你的 ORM 工具成为你完成工作的障碍，或者做不正确的借口。归根结底，所有好的 SQL 都是手写和手动调整的，但是一些不错的工具可以帮助您快速获得一个好的初稿。

我对待这个问题的方式与我做 UI 设计的方式相同。我直接用代码编写所有 UI，但我可能会使用视觉设计器对我想到的一些基本元素进行原型设计，然后我将它生成的代码拆开以启动我自己的代码。

因此，使用任何形式的 ORM 工具作为获得体面示例的一种方式——看看它如何解决出现的许多问题（密钥生成、关联、导航等）。拆开它的输出，把它变成你自己的，然后再利用它。

# asp.net - 如何在 ASP.NET 生成的 Word 文件中嵌入图像

> ID：362381
> 
> 赞同：4
> 
> 时间：2008-12-12T10:20:24.210
> 
> 标签：asp.net, image, ms-word

正如我在各种用户组中看到的那样，我有一个很常见的问题，但找不到合适的答案。

我想做的是在我的网站中生成一个 ASP.NET 页面，该页面可以选择导出为 Microsoft Word .doc 格式。

我使用的方法是这样的：

```
Response.Clear();
Response.AddHeader("content-disposition", "attachment;filename=Test.doc");
Response.Charset = "";
Response.Cache.SetCacheability(HttpCacheability.NoCache);
Response.ContentType = "application/msword";

StringWriter sw = new StringWriter();
HtmlTextWriter htmlWrite = new HtmlTextWriter(sw);
Page.RenderControl(htmlWrite);
Response.Write(sw.ToString());
Response.End(); 
```

然而，尽管它生成了一个 word 文档，但图像是嵌入在文档中的注释，而不是它们作为链接放置。我一直在寻找一种方法来做到这一点，但还没有找到真正有效的方法。

我会很感激我能得到的任何帮助，因为这是“最后一分钟”的要求（谈论典型）

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T23:15:58.027

**简短回答：**您需要为页面中图像的来源提供绝对 URL。

**更长的答案：**

如果您将其重命名为 *.doc 扩展名，Microsoft Word 将打开一个 HTML 文档。这就是您提供的代码正在做的事情。在这种情况下，图像不会像您以实际 Word 格式创建文档那样嵌入到文档中。如果您的图像使用相对 URL，那么 Word 将不知道在哪里查找它们，因此需要绝对 URL。

*注意：这意味着在没有 Internet 连接的情况下查看文档的任何人都不会看到图像，因为每次打开文档时都会从服务器请求图像。*

更优雅的解决方案是以真实的 Word 格式创建文档。一个很棒的库是[Aspose.Words](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx)。使用这个库，您可以将图像直接嵌入到文档中，这样它们就不会依赖于服务器。

# asp.net - 无法让 ViewState 在生产服务器上工作

> ID：362383
> 
> 赞同：0
> 
> 时间：2008-12-12T10:21:04.910
> 
> 标签：asp.net, viewstate

我在我的 Vista 盒子 (IIS7) 上开发了一个 ASP.NET 应用程序。在我将它部署到产品服务器 (W2K3/IIS6) 之前它工作正常。部署后，我会得到一致的“对象引用未设置为对象的实例”。从我的 ViewState 对象读取时，该对象确定按钮是显示“开”还是“关”图像。

页面加载的代码将 ViewState 初始化为 on：

```
if (!IsPostBack)
{
    ViewState["ButtonState"] = true;
} 
```

然后我在 OnPreRender 方法中检查按钮的状态：

```
protected override void OnPreRender(EventArgs e)
{
    base.OnPreRender(e);

    if ((bool)ViewState["ButtonState"])
    {
        MyButton.ImageUrl = Constants.ButtonIcon;
    }
    else
    {
        MyButton.ImageUrl = Constants.NoButtonIcon;
    }
} 
```

为了在按钮的状态之间切换，我捕获了按钮的单击并切换 ViewState 中的值：

```
protected void MyButton_Click(object sender, ImageClickEventArgs e)
{
    ViewState["ButtonState"] = !(bool)ViewState["ButtonState"];
} 
```

在开发盒上，这非常有效。但是，在 live box 上，页面加载正确，但是当您单击按钮（或实际上导致回发的任何其他按钮）时，您会在回发后收到错误消息。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T13:50:59.157

您是否在服务器的 web.config 或 machine.config 文件中设置了 <system.web><pages enableViewState="false" />？

# java - Java 是以小端还是大端读取整数？

> ID：362384
> 
> 赞同：98
> 
> 时间：2008-12-12T10:21:17.063
> 
> 标签：java, endianness

我问是因为我正在将字节流从 C 进程发送到 Java。在 C 端，32 位整数的 LSB 是第一个字节，MSB 是第 4 个字节。

所以我的问题是：在 Java 端，当我们读取从 C 进程发送的字节时，Java 端的字节序是[什么](https://en.wikipedia.org/wiki/Endianness)？

一个后续问题：如果Java端的endian和发送的不一样，如何在它们之间进行转换？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-12-12T10:36:30.603

使用网络字节顺序（大端），这与 Java 使用的相同。请参阅 man htons 以了解 C 中的不同翻译器。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2011-12-08T13:52:50.770

我通过 Google 偶然发现了这里，并得到了 Java 是**big endian**的答案。

阅读回复我想指出字节确实有一个字节顺序，虽然幸运的是，如果你只处理过“主流”微处理器，你不太可能遇到过它，因为英特尔、摩托罗拉和 Zilog 都是同意他们的 UART 芯片的移位方向，并且一个字节的 MSB将在他们的 CPU 中`2**7`，LSB 将`2**0`在他们的 CPU 中（我使用 FORTRAN 幂符号来强调这些东西有多古老 :)）。

20 多年前，当我们用 Mac 计算机替换价值 1 万美元的接口硬件时，我遇到了一些航天飞机位串行下行链路数据的问题。很久以前有一篇关于它的 NASA 技术简报。`table[0x01]=0x80`在每个字节从位流移入后，我只是使用了一个 256 个元素的查找表，位反转（等）。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-12-12T10:23:06.683

Java 中没有无符号整数。所有整数都是有符号的并且是大端的。

> 在 C 端，每个字节的开头都有 tne LSB，左侧是 MSB，结尾是 MSB。

听起来您使用 LSB 作为最低有效位，是吗？LSB 通常代表最低有效字节。 [字节序](http://en.wikipedia.org/wiki/Endianness#Big-endian)不是基于位，而是基于字节。

要将无符号字节转换为 Java 整数：

```
int i = (int) b & 0xFF; 
```

要将 byte[] 中的无符号 32 位 little-endian 转换为 Java long（根据我的想法，未经测试）：

```
long l = (long)b[0] & 0xFF;
l += ((long)b[1] & 0xFF) << 8;
l += ((long)b[2] & 0xFF) << 16;
l += ((long)b[3] & 0xFF) << 24; 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-12-12T21:37:19.340

这不可能影响 Java 中的任何内容，因为没有（直接的非 API）方法可以将某些字节直接映射到 Java 中的 int。

每个执行此操作或类似操作的 API 都非常精确地定义了行为，因此您应该查找该 API 的文档。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-12T10:27:07.393

我会一个一个地读取字节，并将它们组合成一个**长**值。这样您就可以控制字节顺序，并且通信过程是透明的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-12T11:06:48.717

如果它适合您使用的协议，请考虑使用 DataInputStream，其行为[定义非常明确](https://docs.oracle.com/javase/9/docs/api/java/io/DataInput.html#readInt())。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-02-18T07:36:33.427

如上所述，Java 是“大端”。这意味着如果您检查内存（至少在 Intel CPU 上），则 int 的 MSB 位于左侧。对于所有 Java 整数类型，符号位也在 MSB 中。
从“Little-endian”系统存储的二进制文件中读取 4 字节无符号整数需要在 Java 中进行一些调整。DataInputStream 的 readInt() 需要大端格式。
这是一个将四字节无符号值（HexEdit 显示为 01 00 00 00）读入值为 1 的整数的示例：

```
 // Declare an array of 4 shorts to hold the four unsigned bytes
 short[] tempShort = new short[4];
 for (int b = 0; b < 4; b++) {
    tempShort[b] = (short)dIStream.readUnsignedByte();           
 }
 int curVal = convToInt(tempShort);

 // Pass an array of four shorts which convert from LSB first 
 public int convToInt(short[] sb)
 {
   int answer = sb[0];
   answer += sb[1] << 8;
   answer += sb[2] << 16;
   answer += sb[3] << 24;
   return answer;        
 } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-04T22:16:25.493

java力确实大端：[https ://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.11](https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.11)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-07T13:47:06.447

恕我直言，没有为 java 定义字节序。字节序是硬件之一，但java是高级别的并且隐藏了硬件，所以你不必担心这一点。

唯一与字节序相关的特性是 java lib 如何将 int 和 long 映射到 byte[] （反之亦然）。它使用 Big-Endian，这是最易读和最自然的：

```
int i=0xAABBCCDD 
```

映射到

```
byte[] b={0xAA,0xBB,0xCC,0xDD} 
```

# php - 将 %40 返回到 @ 符号

> ID：362386
> 
> 赞同：4
> 
> 时间：2008-12-12T10:21:33.503
> 
> 标签：php, html

```
dev%40bionic%2Dcomms%2Eco%2Euk 
```

我想把上面的内容变成可读的文本。谁能告诉我怎么做？谢谢

编辑 请原谅我的疏忽，PHP 是首选语言！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-12T10:27:36.427

你还没有说是哪种语言，但在许多你想要的功能是 urldecode

（看看你的其他问题，你可能想要 PHP。那里是[urldecode](http://uk3.php.net/urldecode) :)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T10:26:35.833

在 JavaScript 中：`decodeURIComponent("dev%40bionic%2Dcomms%2Eco%2Euk")`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T10:28:10.497

尽管这不是您所追求的，但作为 C# 中的参考，您可以使用 HttpUtility.UrlEncode

编辑

网址解码：P

[http://msdn.microsoft.com/en-us/library/system.web.httputility.urldecode.aspx](http://msdn.microsoft.com/en-us/library/system.web.httputility.urldecode.aspx)

# security - 如何在使用容器管理的安全性时从数据库中检索用户名、密码和角色，而不是从 tomcat-user.xml 中检索它们

> ID：362401
> 
> 赞同：3
> 
> 时间：2008-12-12T10:25:24.153
> 
> 标签：security, tomcat, container-managed

我有一个部署在 Tomcat 中的 Web 应用程序。我想保护 url 路径*管理/**下的所有页面。

我已经设置了容器管理的安全性，在 web.xml 文件中输入了下一个片段：

```
<security-role>
    <role-name>administrator</role-name>
</security-role>
<login-config>
    <auth-method>BASIC</auth-method>                
</login-config>  
<security-constraint>
    <web-resource-collection>
        <web-resource-name>AdministrationPanel</web-resource-name>          
    <url-pattern>/administration/*</url-pattern>            
    <http-method>GET</http-method>
    <http-method>POST</http-method>         
    </web-resource-collection>
    <auth-constraint>
        <role-name>administrator</role-name>
    <role-name>member</role-name>
    </auth-constraint>
</security-constraint> 
```

在 $CATALINA_HOME/conf/tomcat-users.xml 我有

```
<user username="userA" password="userA" roles="administrator"/> 
```

一切正常。我得到一个登录框，我可以将自己验证为 userA。

但是，我希望能够通过使用 Web 应用程序直接存储新用户、更改用户密码等。

是否可以通过其他方式告诉 tomcat 获取用户、密码和角色？例如从数据库中检索它们的类。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T12:55:17.460

是的，[这是可能的](http://tomcat.apache.org/tomcat-4.1-doc/realm-howto.html#DataSourceRealm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T23:14:33.180

或者对于当前版本的[Tomcat 6 Realm Howto](http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html)

# netbeans - 是否有适用于 Netbeans 6.5 的 struts 配置工具？

> ID：362402
> 
> 赞同：0
> 
> 时间：2008-12-12T10:25:56.693
> 
> 标签：netbeans, struts

我找到了[Struts Console Tool](http://www.jamesholmes.com/struts/console/help.html)，但它的开发于 2004 年停止，因此它适用于 Netbeans 3.2。

有没有办法在 Netbeans 6.5 下安装它？

是否有任何选项可以在 XML 级别之上编辑 struts-config.xml？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T12:34:54.537

Netbeans 支持自动`struts-config.xml`修改。例如，如果您右键单击您的项目并选择`New/Struts Action`Netbeans 不仅会创建一个新类，而且它还可以修改您的项目`struts-config.xml`并添加一个新`<action>`标签。当然它不是一个复杂的 GUI，但你不必一直手动编辑`struts-config.xml`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T10:48:12.750

您需要一个工具来编写一个非常简单的 XML 文件吗？尤其是当 IDE 应该在 XML 编辑器中为您提供标记完成、成员列表帮助等时？

# c# - 使用 Process.Start() 从 Windows 服务中以不同用户身份启动进程

> ID：362419
> 
> 赞同：35
> 
> 时间：2008-12-12T10:32:37.757
> 
> 标签：c#, .net, windows-services, process, service

我想定期在 Windows 服务的指定用户帐户下运行任意 .NET exe。

到目前为止，我已经让我的 Windows 服务运行逻辑来决定目标进程是什么，以及何时运行它。目标进程以如下方式启动：

1.  Windows 服务使用“管理员”凭据启动。
2.  时机成熟时，将执行一个中间 .NET 进程，其中包含详细说明应启动哪个进程的参数（文件名、用户名、域、密码）。
3.  此过程创建一个新的 System.Diagnostics.Process，关联一个填充了传递给它的参数的 ProcessStartInfo 对象，然后在该过程对象上调用 Start()。

第**一次**发生这种情况时，**目标进程执行良好，然后正常关闭**。然而，每次后续的时间，一旦目标进程启动，它就会抛出错误“应用程序无法正确初始化（0xc0000142）”。重新启动 Windows 服务将允许该进程再次成功运行（第一次执行）。

自然，目标是让目标进程每次都能成功执行。

关于上面的第 2 步：要以不同的用户身份运行进程 .NET 调用 win32 函数 CreateProcessWithLogonW。此功能需要一个窗口句柄来登录指定的用户。由于 Windows 服务未在交互模式下运行，因此它没有窗口句柄。这个中间进程解决了这个问题，因为它有一个可以传递给目标进程的窗口句柄。

请不要建议使用 psexec 或 windows 任务规划器。我已经接受了我的生活，这包括以上述方式解决问题。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-19T08:47:40.200

对于以下场景，我似乎有一个可行的实现（Works On My Machine(TM)）：

批处理文件、.NET 控制台程序集、.NET Windows 窗体应用程序。

就是这样：

我有一个以管理员用户身份运行的 Windows 服务。我将以下策略添加到管理员用户：

*   作为服务登录
*   作为操作系统的一部分
*   调整进程的内存配额
*   替换进程级令牌

这些策略可以通过打开控制面板/管理工具/本地安全策略/用户权限分配来添加。设置后，策略在下次登录之前不会生效。您可以使用其他用户而不是管理员，这可能会使事情更安全:)

现在，我的 Windows 服务具有以其他用户身份启动作业所需的权限。当需要启动一项作业时，该服务会执行一个单独的程序集（“Starter”.NET 控制台程序集），它会为我启动该过程。

以下代码位于 Windows 服务中，执行我的“Starter”控制台程序集：

```
Process proc = null;
System.Diagnostics.ProcessStartInfo info;
string domain = string.IsNullOrEmpty(row.Domain) ? "." : row.Domain;
info = new ProcessStartInfo("Starter.exe");
info.Arguments = cmd + " " + domain + " " + username + " " + password + " " + args;
info.WorkingDirectory = Path.GetDirectoryName(cmd);
info.UseShellExecute = false;
info.RedirectStandardError = true;
info.RedirectStandardOutput = true;
proc = System.Diagnostics.Process.Start(info); 
```

然后控制台程序集通过互操作调用启动目标进程：

```
class Program
{
    #region Interop

    [StructLayout(LayoutKind.Sequential)]
    public struct LUID
    {
        public UInt32 LowPart;
        public Int32 HighPart;
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct LUID_AND_ATTRIBUTES
    {
        public LUID Luid;
        public UInt32 Attributes;
    }

    public struct TOKEN_PRIVILEGES
    {
        public UInt32 PrivilegeCount;
        [MarshalAs(UnmanagedType.ByValArray, SizeConst = 1)]
        public LUID_AND_ATTRIBUTES[] Privileges;
    }

    enum TOKEN_INFORMATION_CLASS
    {
        TokenUser = 1,
        TokenGroups,
        TokenPrivileges,
        TokenOwner,
        TokenPrimaryGroup,
        TokenDefaultDacl,
        TokenSource,
        TokenType,
        TokenImpersonationLevel,
        TokenStatistics,
        TokenRestrictedSids,
        TokenSessionId,
        TokenGroupsAndPrivileges,
        TokenSessionReference,
        TokenSandBoxInert,
        TokenAuditPolicy,
        TokenOrigin,
        TokenElevationType,
        TokenLinkedToken,
        TokenElevation,
        TokenHasRestrictions,
        TokenAccessInformation,
        TokenVirtualizationAllowed,
        TokenVirtualizationEnabled,
        TokenIntegrityLevel,
        TokenUIAccess,
        TokenMandatoryPolicy,
        TokenLogonSid,
        MaxTokenInfoClass
    }

    [Flags]
    enum CreationFlags : uint
    {
        CREATE_BREAKAWAY_FROM_JOB = 0x01000000,
        CREATE_DEFAULT_ERROR_MODE = 0x04000000,
        CREATE_NEW_CONSOLE = 0x00000010,
        CREATE_NEW_PROCESS_GROUP = 0x00000200,
        CREATE_NO_WINDOW = 0x08000000,
        CREATE_PROTECTED_PROCESS = 0x00040000,
        CREATE_PRESERVE_CODE_AUTHZ_LEVEL = 0x02000000,
        CREATE_SEPARATE_WOW_VDM = 0x00001000,
        CREATE_SUSPENDED = 0x00000004,
        CREATE_UNICODE_ENVIRONMENT = 0x00000400,
        DEBUG_ONLY_THIS_PROCESS = 0x00000002,
        DEBUG_PROCESS = 0x00000001,
        DETACHED_PROCESS = 0x00000008,
        EXTENDED_STARTUPINFO_PRESENT = 0x00080000
    }

    public enum TOKEN_TYPE
    {
        TokenPrimary = 1,
        TokenImpersonation
    }

    public enum SECURITY_IMPERSONATION_LEVEL
    {
        SecurityAnonymous,
        SecurityIdentification,
        SecurityImpersonation,
        SecurityDelegation
    }

    [Flags]
    enum LogonFlags
    {
        LOGON_NETCREDENTIALS_ONLY = 2,
        LOGON_WITH_PROFILE = 1
    }

    enum LOGON_TYPE
    {
        LOGON32_LOGON_INTERACTIVE = 2,
        LOGON32_LOGON_NETWORK,
        LOGON32_LOGON_BATCH,
        LOGON32_LOGON_SERVICE,
        LOGON32_LOGON_UNLOCK = 7,
        LOGON32_LOGON_NETWORK_CLEARTEXT,
        LOGON32_LOGON_NEW_CREDENTIALS
    }

    enum LOGON_PROVIDER
    {
        LOGON32_PROVIDER_DEFAULT,
        LOGON32_PROVIDER_WINNT35,
        LOGON32_PROVIDER_WINNT40,
        LOGON32_PROVIDER_WINNT50
    }

    #region _SECURITY_ATTRIBUTES
    //typedef struct _SECURITY_ATTRIBUTES {  
    //    DWORD nLength;  
    //    LPVOID lpSecurityDescriptor;  
    //    BOOL bInheritHandle;
    //} SECURITY_ATTRIBUTES,  *PSECURITY_ATTRIBUTES,  *LPSECURITY_ATTRIBUTES;
    #endregion
    struct SECURITY_ATTRIBUTES
    {
        public uint Length;
        public IntPtr SecurityDescriptor;
        public bool InheritHandle;
    }

    [Flags] enum SECURITY_INFORMATION : uint
    {
        OWNER_SECURITY_INFORMATION        = 0x00000001,
        GROUP_SECURITY_INFORMATION        = 0x00000002,
        DACL_SECURITY_INFORMATION         = 0x00000004,
        SACL_SECURITY_INFORMATION         = 0x00000008,
        UNPROTECTED_SACL_SECURITY_INFORMATION = 0x10000000,
        UNPROTECTED_DACL_SECURITY_INFORMATION = 0x20000000,
        PROTECTED_SACL_SECURITY_INFORMATION   = 0x40000000,
        PROTECTED_DACL_SECURITY_INFORMATION   = 0x80000000
    }

    #region _SECURITY_DESCRIPTOR
    //typedef struct _SECURITY_DESCRIPTOR {
    //  UCHAR  Revision;
    //  UCHAR  Sbz1;
    //  SECURITY_DESCRIPTOR_CONTROL  Control;
    //  PSID  Owner;
    //  PSID  Group;
    //  PACL  Sacl;
    //  PACL  Dacl;
    //} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;
    #endregion
    [StructLayoutAttribute(LayoutKind.Sequential)]
    struct SECURITY_DESCRIPTOR
    {
        public byte revision;
        public byte size;
        public short control; // public SECURITY_DESCRIPTOR_CONTROL control;
        public IntPtr owner;
        public IntPtr group;
        public IntPtr sacl;
        public IntPtr dacl;
    }

    #region _STARTUPINFO
    //typedef struct _STARTUPINFO {  
    //    DWORD cb;  
    //    LPTSTR lpReserved;  
    //    LPTSTR lpDesktop;  
    //    LPTSTR lpTitle;  
    //    DWORD dwX;  
    //    DWORD dwY;  
    //    DWORD dwXSize;  
    //    DWORD dwYSize;  
    //    DWORD dwXCountChars;  
    //    DWORD dwYCountChars;  
    //    DWORD dwFillAttribute;  
    //    DWORD dwFlags;  
    //    WORD wShowWindow;  
    //    WORD cbReserved2;  
    //    LPBYTE lpReserved2;  
    //    HANDLE hStdInput;  
    //    HANDLE hStdOutput;  
    //    HANDLE hStdError; 
    //} STARTUPINFO,  *LPSTARTUPINFO;
    #endregion
    struct STARTUPINFO
    {
        public uint cb;
        [MarshalAs(UnmanagedType.LPTStr)]
        public string Reserved;
        [MarshalAs(UnmanagedType.LPTStr)]
        public string Desktop;
        [MarshalAs(UnmanagedType.LPTStr)]
        public string Title;
        public uint X;
        public uint Y;
        public uint XSize;
        public uint YSize;
        public uint XCountChars;
        public uint YCountChars;
        public uint FillAttribute;
        public uint Flags;
        public ushort ShowWindow;
        public ushort Reserverd2;
        public byte bReserverd2;
        public IntPtr StdInput;
        public IntPtr StdOutput;
        public IntPtr StdError;
    }

    #region _PROCESS_INFORMATION
    //typedef struct _PROCESS_INFORMATION {  
    //  HANDLE hProcess;  
    //  HANDLE hThread;  
    //  DWORD dwProcessId;  
    //  DWORD dwThreadId; } 
    //  PROCESS_INFORMATION,  *LPPROCESS_INFORMATION;
    #endregion
    [StructLayout(LayoutKind.Sequential)]
    struct PROCESS_INFORMATION
    {
        public IntPtr Process;
        public IntPtr Thread;
        public uint ProcessId;
        public uint ThreadId;
    }

    [DllImport("advapi32.dll", SetLastError = true)]
    static extern bool InitializeSecurityDescriptor(IntPtr pSecurityDescriptor, uint dwRevision);
    const uint SECURITY_DESCRIPTOR_REVISION = 1;

    [DllImport("advapi32.dll", SetLastError = true)]
    static extern bool SetSecurityDescriptorDacl(ref SECURITY_DESCRIPTOR sd, bool daclPresent, IntPtr dacl, bool daclDefaulted);

    [DllImport("advapi32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    extern static bool DuplicateTokenEx(
        IntPtr hExistingToken,
        uint dwDesiredAccess,
        ref SECURITY_ATTRIBUTES lpTokenAttributes,
        SECURITY_IMPERSONATION_LEVEL ImpersonationLevel,
        TOKEN_TYPE TokenType,
        out IntPtr phNewToken);

    [DllImport("advapi32.dll", SetLastError = true)]
    public static extern bool LogonUser(
        string lpszUsername,
        string lpszDomain,
        string lpszPassword,
        int dwLogonType,
        int dwLogonProvider,
        out IntPtr phToken
        );

    #region GetTokenInformation
    //BOOL WINAPI GetTokenInformation(
    //  __in       HANDLE TokenHandle,
    //  __in       TOKEN_INFORMATION_CLASS TokenInformationClass,
    //  __out_opt  LPVOID TokenInformation,
    //  __in       DWORD TokenInformationLength,
    //  __out      PDWORD ReturnLength
    //);
    #endregion
    [DllImport("advapi32.dll", SetLastError = true)]
    static extern bool GetTokenInformation(
        IntPtr TokenHandle,
        TOKEN_INFORMATION_CLASS TokenInformationClass,
        IntPtr TokenInformation,
        int TokenInformationLength,
        out int ReturnLength
        );

    #region CreateProcessAsUser
    //        BOOL WINAPI CreateProcessAsUser(
    //  __in_opt     HANDLE hToken,
    //  __in_opt     LPCTSTR lpApplicationName,
    //  __inout_opt  LPTSTR lpCommandLine,
    //  __in_opt     LPSECURITY_ATTRIBUTES lpProcessAttributes,
    //  __in_opt     LPSECURITY_ATTRIBUTES lpThreadAttributes,
    //  __in         BOOL bInheritHandles,
    //  __in         DWORD dwCreationFlags,
    //  __in_opt     LPVOID lpEnvironment,
    //  __in_opt     LPCTSTR lpCurrentDirectory,
    //  __in         LPSTARTUPINFO lpStartupInfo,
    //  __out        LPPROCESS_INFORMATION lpProcessInformation);
    #endregion
    [DllImport("advapi32.dll", CharSet = CharSet.Unicode, SetLastError = true)]
    static extern bool CreateProcessAsUser(
        IntPtr Token, 
        [MarshalAs(UnmanagedType.LPTStr)] string ApplicationName,
        [MarshalAs(UnmanagedType.LPTStr)] string CommandLine,
        ref SECURITY_ATTRIBUTES ProcessAttributes, 
        ref SECURITY_ATTRIBUTES ThreadAttributes, 
        bool InheritHandles,
        uint CreationFlags, 
        IntPtr Environment, 
        [MarshalAs(UnmanagedType.LPTStr)] string CurrentDirectory, 
        ref STARTUPINFO StartupInfo, 
        out PROCESS_INFORMATION ProcessInformation);

    #region CloseHandle
    //BOOL WINAPI CloseHandle(
    //      __in          HANDLE hObject
    //        );
    #endregion
    [DllImport("Kernel32.dll")]
    extern static int CloseHandle(IntPtr handle);

    [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
    internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr prev, IntPtr relen);

    [DllImport("advapi32.dll", SetLastError = true)]
    internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    internal struct TokPriv1Luid
    {
        public int Count;
        public long Luid;
        public int Attr;
    }

    //static internal const int TOKEN_QUERY = 0x00000008;
    internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
    //static internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

    internal const int TOKEN_QUERY = 0x00000008;
    internal const int TOKEN_DUPLICATE = 0x0002;
    internal const int TOKEN_ASSIGN_PRIMARY = 0x0001;

    #endregion

    [STAThread]
    static void Main(string[] args)
    {
        string username, domain, password, applicationName;
        username = args[2];
        domain = args[1];
        password = args[3];
        applicationName = @args[0];

        IntPtr token = IntPtr.Zero;
        IntPtr primaryToken = IntPtr.Zero;
        try
        {
            bool result = false;

            result = LogonUser(username, domain, password, (int)LOGON_TYPE.LOGON32_LOGON_NETWORK, (int)LOGON_PROVIDER.LOGON32_PROVIDER_DEFAULT, out token);
            if (!result)
            {
                int winError = Marshal.GetLastWin32Error();
            }

            string commandLine = null;

            #region security attributes
            SECURITY_ATTRIBUTES processAttributes = new SECURITY_ATTRIBUTES();

            SECURITY_DESCRIPTOR sd = new SECURITY_DESCRIPTOR();
            IntPtr ptr = Marshal.AllocCoTaskMem(Marshal.SizeOf(sd));
            Marshal.StructureToPtr(sd, ptr, false);
            InitializeSecurityDescriptor(ptr, SECURITY_DESCRIPTOR_REVISION);
            sd = (SECURITY_DESCRIPTOR)Marshal.PtrToStructure(ptr, typeof(SECURITY_DESCRIPTOR));

            result = SetSecurityDescriptorDacl(ref sd, true, IntPtr.Zero, false);
            if (!result)
            {
                int winError = Marshal.GetLastWin32Error();
            }

            primaryToken = new IntPtr();
            result = DuplicateTokenEx(token, 0, ref processAttributes, SECURITY_IMPERSONATION_LEVEL.SecurityImpersonation, TOKEN_TYPE.TokenPrimary, out primaryToken);
            if (!result)
            {
                int winError = Marshal.GetLastWin32Error();
            }
            processAttributes.SecurityDescriptor = ptr;
            processAttributes.Length = (uint)Marshal.SizeOf(sd);
            processAttributes.InheritHandle = true;
            #endregion

            SECURITY_ATTRIBUTES threadAttributes = new SECURITY_ATTRIBUTES();
            threadAttributes.SecurityDescriptor = IntPtr.Zero;
            threadAttributes.Length = 0;
            threadAttributes.InheritHandle = false;

            bool inheritHandles = true;
            //CreationFlags creationFlags = CreationFlags.CREATE_DEFAULT_ERROR_MODE;
            IntPtr environment = IntPtr.Zero;
            string currentDirectory = currdir;

            STARTUPINFO startupInfo = new STARTUPINFO();
            startupInfo.Desktop = "";

            PROCESS_INFORMATION processInformation;

            result = CreateProcessAsUser(primaryToken, applicationName, commandLine, ref processAttributes, ref threadAttributes, inheritHandles, 16, environment, currentDirectory, ref startupInfo, out processInformation);
            if (!result)
            {
                int winError = Marshal.GetLastWin32Error();
                File.AppendAllText(logfile, DateTime.Now.ToLongTimeString() + " " + winError + Environment.NewLine);
            }
        }
        catch
        {
            int winError = Marshal.GetLastWin32Error();
            File.AppendAllText(logfile, DateTime.Now.ToLongTimeString() + " " + winError + Environment.NewLine);
        }
        finally
        {
            if (token != IntPtr.Zero)
            {
                int x = CloseHandle(token);
                if (x == 0)
                    throw new Win32Exception(Marshal.GetLastWin32Error());
                x = CloseHandle(primaryToken);
                if (x == 0)
                    throw new Win32Exception(Marshal.GetLastWin32Error());
            }
        }
    } 
```

基本程序是：

1.  登录用户
2.  将给定令牌转换为主令牌
3.  使用此令牌，执行流程
4.  完成后关闭手柄。

这是我机器上的新开发代码，几乎无法在生产环境中使用。这里的代码仍然有问题 - 对于初学者：我不确定句柄是否在正确的位置关闭，并且上面定义的一些互操作函数不是必需的。单独的启动程序也让我很恼火。理想情况下，我希望将所有这些工作内容打包在一个程序集中，以供我们的 API 和此服务使用。如果有人在这里有任何建议，他们将不胜感激。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T11:03:52.467

我既不建议 psexec 也不建议任务规划器。但是，你看过[Sudowin](http://sourceforge.net/projects/sudowin)吗？

它几乎完全符合您的要求，除了它在执行该过程之前要求输入密码。

此外，由于是开源的，您可以一次又一次地看到它如何从相关服务中执行流程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T11:50:04.423

只是一个猜测 - 您是否使用 LoadUserProfile=true 和开始信息？CreateProcessWithLogonW 默认不加载用户注册表配置单元，除非你告诉它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T09:25:05.667

第一次调用失败的原因很可能是因为它使用了“默认”安全描述符（无论是什么）。

来自[msdn](http://msdn.microsoft.com/en-us/library/ms682429.aspx)：

> lpProcessAttributes [输入，可选]
> 
> 指向 SECURITY_ATTRIBUTES 结构的指针，该结构指定新进程对象的安全描述符并确定子进程是否可以继承返回的进程句柄。如果 lpProcessAttributes 为 NULL 或 lpSecurityDescriptor 为 NULL，则进程获取默认的安全描述符并且不能继承句柄。默认安全描述符是 hToken 参数中引用的用户的安全描述符。此安全描述符可能不允许调用者访问，**在这种情况下，进程在运行后可能不会再次打开。** *进程句柄有效，并将继续拥有完全访问权限。*

我猜 CreateProcessWithLogonW 正在创建这个默认的安全描述符（无论如何，我没有指定一个）。

是时候开始互操作了...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T12:14:09.977

您不需要窗口句柄来使用 CreateProcessWithLogonW，我不确定您的信息来自哪里。

应用程序初始化失败错误有很多原因，但几乎总是与安全或用户资源耗尽有关。如果没有关于您正在运行的内容和正在运行的上下文的更多信息，很难诊断这一点。但要研究的是：提供的用户是否具有访问可执行文件目录的正确权限，是否用户有权访问正在启动它的窗口站和桌面，它是否对初始化时需要加载的任何 dll 文件具有正确的权限等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T13:48:33.437

我刚刚在 msdn ( [http://msdn.microsoft.com/en-us/library/ms682431(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms682431(VS.85).aspx) ) 上阅读了此评论：

> 不要用这个函数调用用户应用程序！克里斯蒂安维默 |
> 编辑 | 显示历史请稍候 如果您要调用提供文档编辑和类似内容（如 Word）的用户模式应用程序，所有未保存的数据都将丢失。这是因为通常的关闭顺序不适用于使用 CreateProcessWithLogonW 启动的进程。这样启动的应用程序就不会得到 WM_QUERYENDSESSION、WM_ENDSESSION 和最重要的 WM_QUIT 消息。所以他们不要求保存数据或清理他们的东西。他们会毫无征兆地退出。此功能对用户不友好，应谨慎使用。
> 
> 这只是“糟糕的用户体验”。没有人期望它。

这可以解释我所观察到的：第一次工作。以后每次都失败。这加强了我的信念，即内部没有正确清理某些东西

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-13T14:56:11.883

您说“Windows 服务是使用“管理员”凭据启动的”

您是指实际的“管理员”帐户，还是“管理员”组中的用户？以管理员身份启动服务为我解决了这个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-04-28T12:09:29.687

当我尝试在 Windows 服务中使用“runas”-verb 启动 PhantomJS 二进制文件时，我遇到了类似的问题。我现在已经使用以下过程解决了这个问题：

*   模拟用户
*   启动进程（无 UI）
*   冒充回来

您可以使用[Impersonator-Class](https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/f3cb7279-3f1e-4bf1-a732-32b4bc54e9db/getdirectories-attempted-to-perform-an-unauthorized-operation?forum=wcf)进行模拟。在 ProcessStartInfo 中设置以下属性也很重要，因此应用程序不会尝试访问 Windows UI：

```
var processStartInfo = new ProcessStartInfo()
{
    FileName = $@"{assemblyFolder}\PhantomJS\phantomjs.exe",
    Arguments = $"--webdriver={port}",
    RedirectStandardOutput = true,
    RedirectStandardError = true,
    RedirectStandardInput = true,
    UseShellExecute = false,
    CreateNoWindow = true,
    ErrorDialog = false,
    WindowStyle = ProcessWindowStyle.Hidden
}; 
```

# java - 访问匿名类的构造函数

> ID：362424
> 
> 赞同：229
> 
> 时间：2008-12-12T10:34:23.510
> 
> 标签：java, constructor, overloading, anonymous-types

假设我有一个具体的 Class1 类，我正在用它创建一个匿名类。

```
Object a = new Class1(){
        void someNewMethod(){
        }
      }; 
```

现在有什么办法可以重载这个匿名类的构造函数。如下图所示

```
Object a = new Class1(){
        void someNewMethod(){
        }
        public XXXXXXXX(int a){
          super();
          System.out.println(a);
        }
      }; 
```

用 xxxxxxxx 处的东西来命名构造函数？

* * *

## 回答 #1

> 赞同：297
> 
> 时间：2008-12-12T10:42:54.320

来自[Java Language Specification](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.9.5.1)，第 15.9.5.1 节：

> 匿名类不能有显式声明的构造函数。

对不起 ：（

编辑：作为替代方案，您可以创建一些最终局部变量，和/或在匿名类中包含一个实例初始化程序。例如：

```
public class Test {
    public static void main(String[] args) throws Exception {
        final int fakeConstructorArg = 10;

        Object a = new Object() {
            {
                System.out.println("arg = " + fakeConstructorArg);
            }
        };
    }
} 
```

这很糟糕，但它可能只会帮助你。或者，使用适当的嵌套类:)

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2008-12-12T10:53:05.127

这是不可能的，但您可以像这样添加一个匿名初始化程序：

```
final int anInt = ...;
Object a = new Class1()
{
  {
    System.out.println(anInt);
  }

  void someNewMethod() {
  }
}; 
```

不要忘记对匿名类使用的局部变量或参数的最终声明，就像我为 anInt 所做的那样。

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2010-01-08T07:19:13.070

这是解决问题的另一种方法：

```
public class Test{

    public static final void main(String...args){

        new Thread(){

            private String message = null;

            Thread initialise(String message){

                this.message = message;
                return this;
            }

            public void run(){
                System.out.println(message);
            }
        }.initialise(args[0]).start();
    }
} 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-09-22T11:35:58.620

我知道该线程太旧而无法发布答案。但我仍然认为这是值得的。

虽然你不能有一个显式的构造函数，但如果你的意图是调用超类的一个可能受保护的构造函数，那么下面就是你所要做的。

```
StoredProcedure sp = new StoredProcedure(datasource, spName) {
    {// init code if there are any}
}; 
```

[**`StoredProcedure`**](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/object/StoredProcedure.html#StoredProcedure-javax.sql.DataSource-java.lang.String-)这是一个在 Spring 中通过传递 a`DataSource`和一个对象来创建对象的示例`String`。

所以底线是，如果你想创建一个匿名类并想调用超类构造函数，那么创建一个**签名匹配超类构造函数**的匿名类。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-08T18:45:48.360

是的，你不能在匿名类中定义构造是正确的，但这并不意味着匿名类没有构造函数。混淆......实际上你不能在匿名类中定义构造，但编译器会为它生成一个构造函数，其签名与其父构造函数相同。如果父级有多个构造函数，匿名将只有一个构造函数

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-01-31T12:35:08.863

您可以在接受初始化参数的抽象类中有一个构造函数。Java 规范只规定匿名类，它是（可选的）抽象类或接口实现的后代，不能拥有自己的构造函数。

以下是绝对合法和可能的：

```
static abstract class Q{
    int z;
    Q(int z){ this.z=z;}
    void h(){
        Q me = new Q(1) {
        };
    }
} 
```

如果您有可能自己编写抽象类，请将这样的构造函数放在那里，并在没有更好解决方案的地方使用流畅的 API。您可以通过这种方式覆盖原始类的构造函数，使用带参数的构造函数创建一个命名的兄弟类，并使用它来实例化您的匿名类。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-28T01:24:31.080

如果你不需要传递参数，那么初始化代码就足够了，但是如果你需要从一个 contrcutor 传递参数，有一种方法可以解决大多数情况：

```
Boolean var= new anonymousClass(){
    private String myVar; //String for example

    @Overriden public Boolean method(int i){
          //use myVar and i
    }
    public String setVar(String var){myVar=var; return this;} //Returns self instane
}.setVar("Hello").method(3); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-11-13T15:31:47.600

Peter Norvig 的 Java IAQ：不常回答的问题

[http://norvig.com/java-iaq.html#constructors](http://norvig.com/java-iaq.html#constructors) - 匿名类构造器

[http://norvig.com/java-iaq.html#init](http://norvig.com/java-iaq.html#init) - 构造函数和初始化

总结，你可以构造这样的东西..

```
public class ResultsBuilder {
    Set<Result> errors;
    Set<Result> warnings;

...

    public Results<E> build() {
        return new Results<E>() {
            private Result[] errorsView;
            private Result[] warningsView;
            {
                errorsView = ResultsBuilder.this.getErrors();
                warningsView = ResultsBuilder.this.getWarnings();
            }

            public Result[] getErrors() {
                return errorsView;
            }

            public Result[] getWarnings() {
                return warningsView;
            }
        };
    }

    public Result[] getErrors() {
        return !isEmpty(this.errors) ? errors.toArray(new Result[0]) : null;
    }

    public Result[] getWarnings() {
        return !isEmpty(this.warnings) ? warnings.toArray(new Result[0]) : null;
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-12T13:34:39.313

在匿名类中拥有命名的重载构造函数没有任何意义，因为无论如何都无法调用它。

根据您实际尝试执行的操作，仅访问在类外部声明的最终局部变量，或使用 Arne 所示的实例初始化程序，可能是最佳解决方案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-05-05T19:14:34.620

在我的例子中，一个本地类（带有自定义构造函数）作为一个匿名类工作：

```
Object a = getClass1(x);

public Class1 getClass1(int x) {
  class Class2 implements Class1 {
    void someNewMethod(){
    }
    public Class2(int a){
      super();
      System.out.println(a);
    }
  }
  Class1 c = new Class2(x);
  return c;
} 
```

# python - 实现“[command] [action] [parameter]”风格的命令行界面？

> ID：362426
> 
> 赞同：15
> 
> 时间：2008-12-12T10:35:03.710
> 
> 标签：python, command-line, user-interface

什么是实现命令行 UI 的“最干净”的方式，类似于 git，例如：

```
git push origin/master
git remote add origin git://example.com master 
```

理想情况下还允许更灵活的解析，例如，

```
jump_to_folder app theappname v2
jump_to_folder app theappname source
jump_to_folder app theappname source v2
jump_to_folder app theappname build v1
jump_to_folder app theappname build 1
jump_to_folder app theappname v2 build 
```

`jump_to_folder`是脚本名称，`app`是命令，`theappname`是“固定位置”参数，“build”和“v2”等是参数（例如，可能的参数可以是任何数字/以 av 为前缀的任何数字，或 build/source/时间/配置）

我可以用一系列`if`/ `else`/手动解析参数`elifs`，但是必须有更优雅的方法来做到这一点？

作为一个完全理论上的例子，我可以描述 UI 模式。

```
app:
    fixed: application_name

    optional params:
        arg subsection:
            "build"
            "source"
            "tmp"
            "config"

        arg version:
            integer
            "v" + integer 
```

然后通过上述模式解析提供的参数，并得到一个字典：

```
>>> print schema.parse(["app", "theappname", "v1", "source"])
{
    "application_name": "theappname",
    "params":{
        "subsection": "source",
        "version":"v1"
    }
} 
```

这样的系统存在吗？如果没有，我将如何按照这些思路实施一些事情？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-06T11:56:29.597

[argparse](http://docs.python.org/library/argparse.html#sub-commands)非常适合这个，特别是[“子命令”](http://docs.python.org/library/argparse.html#sub-commands)和位置参数

```
import argparse

def main():
    arger = argparse.ArgumentParser()

    # Arguments for top-level, e.g "subcmds.py -v"
    arger.add_argument("-v", "--verbose", action="count", default=0)

    subparsers = arger.add_subparsers(dest="command")

    # Make parser for "subcmds.py info ..."
    info_parser = subparsers.add_parser("info")
    info_parser.add_argument("-m", "--moo", dest="moo")

    # Make parser for "subcmds.py create ..."
    create_parser = subparsers.add_parser("create")
    create_parser.add_argument("name")
    create_parser.add_argument("additional", nargs="*")

    # Parse
    opts = arger.parse_args()

    # Print option object for debug
    print opts

    if opts.command == "info":
        print "Info command"
        print "--moo was %s" % opts.moo

    elif opts.command == "create":
        print "Creating %s" % opts.name
        print "Additional: %s" % opts.additional

    else:
        # argparse will error on unexpected commands, but
        # in case we mistype one of the elif statements...
        raise ValueError("Unhandled command %s" % opts.command)

if __name__ == '__main__':
    main() 
```

这可以像这样使用：

```
$ python subcmds.py create myapp v1 blah
Namespace(additional=['v1', 'blah'], command='create', name='myapp', verbose=0)
Creating myapp
Additional: ['v1', 'blah']
$ python subcmds.py info --moo
usage: subcmds.py info [-h] [-m MOO]
subcmds.py info: error: argument -m/--moo: expected one argument
$ python subcmds.py info --moo 1
Namespace(command='info', moo='1', verbose=0)
Info command
--moo was 1 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-12T13:17:11.643

该`cmd`模块可能适用于此。

例子：

```
import cmd

class Calc(cmd.Cmd):
    def do_add(self, arg):
        print sum(map(int, arg.split()))

if __name__ == '__main__':
    Calc().cmdloop() 
```

运行：

```
$python calc.py
(Cmd) add 4 5
9
(Cmd) help

Undocumented commands:
======================
add  help

(Cmd) 
```

有关更多信息，请参阅[Python 文档](http://docs.python.org/library/cmd.html)或[PyMOTW 站点](http://blog.doughellmann.com/2008/05/pymotw-cmd.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T11:04:19.737

直接来自我的一个脚本：

```
import sys

def prog1_func1_act1(): print "pfa1"
def prog2_func2_act2(): print "pfa2"

commands = {
    "prog1 func1 act1": prog1_func1_act1,
    "prog2 func2 act2": prog2_func2_act2
}

try:
    commands[" ".join(sys.argv[1:])]()
except KeyError:
    print "Usage: ", commands.keys() 
```

这是一个非常快速和肮脏的解决方案，但非常适合我的使用。如果我要稍微清理一下，我可能会添加[argparse](http://argparse.python-hosting.com/)来解析位置和关键字参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T11:04:58.910

Python 有一个用于解析命令行选项的模块[optparse](http://docs.python.org/library/optparse.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-04T21:02:44.317

你可能想看看[悬崖 - 命令行界面公式框架](http://readthedocs.org/docs/cliff/en/latest/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T14:41:32.097

这是我的建议。

1.  稍微改变你的语法。

2.  使用 optparse。

理想情况下还允许更灵活的解析，例如，

```
jump_to_folder -n theappname -v2 cmd 
jump_to_folder -n theappname cmd source 
jump_to_folder -n theappname -v2 cmd source 
jump_to_folder -n theappname -v1 cmd build 
jump_to_folder -n theappname -1 cmd build 
jump_to_folder -n theappname -v2 cmd build 
```

然后你有 1 或 2 个参数：命令总是第一个参数。它的可选参数始终是第二个参数。

其他一切都是选项，没有特定的顺序。

# ironpython - Ironpython Studio 表单

> ID：362428
> 
> 赞同：1
> 
> 时间：2008-12-12T10:36:07.390
> 
> 标签：ironpython, ironpython-studio

这是一个两部分的问题。一个愚蠢的技术查询和一个更广泛的查询，关于我学习用我不熟悉的语言做一些事情的可能错误的方法。

我只是在玩一些 Python GUI 库（主要是 wxPython 和 IronPython）来做一些我正在考虑在开源应用程序上做的工作，只是为了提高我的技能等等。

白天，我是一个非常标准的 c# 开发者，使用一组非常普通的基于 MS 的工具，我正在寻找 Python 来给我一个新的视角。因此使用 Ironpython Studio 可能有点作弊（好吧，很多）。这似乎无关紧要，因为无论它试图看起来像 Visual Studio 项目等。有一个简单的行为我可能太笨而无法实现。

IE 如何将我的表单保存在漂亮的单独代码文件中，就像我一直以来的 c# 猴子一样，但又相互调用它们？我已经尝试将要调用的表单导入到主表单中，但我似乎无法让表单被识别为对象以外的任何东西。新表单似乎是它自己的代码文件中的表单对象，我正在导入 clr。我正在尝试调用表单的“显示”方法。这不对吗？

我已经尝试了一些（在我看来不太可能）解决这个问题的方法，但这个问题似乎很棘手。这是我没有看到的东西，还是实际上更适合我改变我对 GUI 脚本的看法以适应 Python （在这种情况下，我可能会切换回 wxPython，这似乎从 Pythonic 更平易近人观点）而不是尝试从 Visual Studio shell 的安全性来看待 Python？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T14:15:31.510

我对这个问题并不完全清楚。您当然可以`System.Windows.Forms.Form`在 IronPython 的一个模块中定义一个子类，然后在其他模块中导入表单子类：

```
# in form.py
from System.Windows.Forms import Form, Button, MessageBox
class TrivialForm(Form):
   def __init__(self):
       button = Button(Parent=self, Text='Click!')
       button.Click += self.show_message

   def show_message(self, sender, args):
       MessageBox.Show('Stop that!')

# in main.py
import clr
clr.AddReference('System.Windows.Forms')
from System.Windows.Forms import Application
from form import TrivialForm
if __name__ == '__main__':
   f = TrivialForm()
   Application.Run(f) 
```

IronPython Studio 的表单设计器/代码生成器是否不允许您这样构建代码？（我从未使用过它。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T17:12:34.477

最后，它变得更加简单。

我试图这样调用子表单：

f = frmSubform()
f.Show()

但我实际上需要这样做

f = frmSubform()
Form.Show(f)

Form.ShowDialog(f) 也有效；当然是对话格式。

一个足够简单的错误，但直到你知道你，好吧，不知道。

我不是 100% 确定我在这个阶段理解为什么什么有效，有效，但我相信我会从经验中学习。

# coldfusion - 如何摆脱我的 RSS 提要中的奇怪字符？

> ID：362429
> 
> 赞同：3
> 
> 时间：2008-12-12T10:36:14.707
> 
> 标签：coldfusion, utf-8, rss, character-encoding

我创建了一个 utf8 编码的 RSS 提要，它显示了从数据库中提取的新闻数据。我已将数据库的所有方面都设置为 utf8，并将我放入数据库的文本保存为 utf8，方法是将其粘贴到记事本中并另存为 utf8。因此，当将 RSS 提要呈现给浏览器时，所有内容都应该以 utf8 编码，但是我仍然会收到奇怪的问号字符作为井号:(

这是我的 RSS 提要代码 (CFML)：

```
<cfsilent>
<!--- Get News --->
<cfinvoke component="com.news" method="getAll" dsn="#Request.App.dsn#"     returnvariable="news" />
</cfsilent>
<!--- If we have news items --->
cfif news.RecordCount GT 0>
<!--- Serve RSS content-type --->
<cfcontent type="application/rss+xml">
<!--- Output feed --->
<cfcontent reset="true"><?xml version="1.0" encoding="utf-8"?>
<cfoutput>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>News RSS Feed</title>
        <link>#Application.siteRoot#</link>
        <description>Welcome to the News RSS Feed</description>
        <lastBuildDate>Wed, 19 Nov 2008 09:05:00 GMT</lastBuildDate>
        <language>en-uk</language>
        <atom:link href="#Application.siteRoot#news/rss/index.cfm" rel="self" type="application/rss+xml" />

    <cfloop query="news">
    <!--- Make data xml compliant --->
        <cfscript>
        news.headline = replace(news.headline, "<", "&lt;", "ALL");
        news.body = replace(news.body, "<", "&lt;", "ALL");
        news.date = dateformat(news.date, "ddd, dd mmm yyyy");
        news.time = timeformat(news.time, "HH:mm:ss") & " GMT"; 
        </cfscript>        
    <item>
        <title>#news.headline#</title>
        <link>#Application.siteRoot#news/index.cfm?id=#news.id#</link>
        <guid>#Application.siteRoot#news/index.cfm?id=#news.id#</guid>
        <pubDate>#news.date# #news.time#</pubDate>
        <description>#news.body#</description>
    </item>
    </cfloop>
    </channel>
</rss>
</cfoutput>
<cfelse>
<!--- If we have no news items, relocate to news page --->
<cflocation url="../news/index.cfm" addtoken="no">
</cfif> 
```

有人有什么建议吗？我做了很多研究，但找不到任何答案:(

提前致谢，

克罗米斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T18:57:48.117

摆脱您的转义代码并改用 XMLFormat：

```
<item>
    <title>#XMLFormat(news.headline)#</title>
    <link>#Application.siteRoot#news/index.cfm?id=#XMLFormat(news.id)#</link>
    <guid>#Application.siteRoot#news/index.cfm?id=#XMLFormat(news.id)#</guid>
    <pubDate>#XMLFormat(news.date)# #XMLFormat(news.time)#</pubDate>
    <description>#XMLFormat(news.body)#</description>
</item> 
```

[查看 XMLFormat livedoc 页面。](http://livedocs.adobe.com/coldfusion/8/functions_t-z_20.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T21:22:35.250

这对我有用，只需组合成一个 cfcontent 标签并附加 charset=utf-8。 `<cfcontent type="text/xml; charset=utf-8" reset="yes" />`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T12:51:02.883

你的转义功能太简单了。您需要先更改`&`为`&amp;`。

如果您使用命名实体（即`&pound;`），则会导致错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T09:41:20.343

在将每个输入输入数据库时​​对其进行清理，这样可以简化之后此类数据的显示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T09:28:13.297

如果您使用的是 Adob​​e ColdFusion 9 或更高版本，请考虑使用带有“escapeChars”属性的 CFFEED 来创建您的 RSS（CF8 也支持 CFFEED，但不支持该属性）。

[http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7675.html](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7675.html)

# sql-server - 如何在不使用 MS SQL Server Management Studio 的情况下更改 SQL Server 中的默认数据库？

> ID：362434
> 
> 赞同：177
> 
> 时间：2008-12-12T10:38:32.113
> 
> 标签：sql-server, sql-server-2005, ssms, default-database

我从 SQL Server 中删除了一个数据库，但事实证明**我的登录**名被设置为使用删除的数据库作为其默认值。我可以通过使用连接对话框中的“选项”按钮并选择“主”作为要连接的数据库来连接到 SQL Server Management Studio。但是，每当我尝试在对象资源管理器中执行任何操作时，它都会尝试使用我的默认数据库进行连接并失败。

有谁知道如何在**不使用对象资源管理器**的情况下设置我的默认数据库？

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2008-12-12T10:38:41.893

您可以做的是使用 sp_defaultdb 系统存储过程设置您的默认数据库。像您一样登录，然后单击“新建查询”按钮。之后只需运行 sp_defaultdb 命令，如下所示：

```
Exec sp_defaultdb @loginame='login', @defdb='master' 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2017-11-21T13:20:55.490

sp_defaultdb（[将在 Microsoft SQL Server 的未来版本中删除）的](https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-defaultdb-transact-sql)替代方案可能是[`ALTER LOGIN`](https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-login-transact-sql)：

```
ALTER LOGIN [my_user_name] WITH DEFAULT_DATABASE = [new_default_database] 
```

**注意**：用户名和数据库名不带引号（与`sp_defaultdb`解决方案不同）。如果名称有特殊字符，则需要括号（最常见的例子是域用户，`domain\username`没有括号也不能工作）：

```
ALTER LOGIN me WITH DEFAULT_DATABASE = my_database 
```

但

```
ALTER LOGIN [EVILCORP\j.smith28] WITH DEFAULT_DATABASE = [prod\v-45] 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2008-12-12T16:30:50.707

要以 GUI 方式执行此操作，您需要编辑您的登录名。它的属性之一是用于该登录的默认数据库。您可以在 Security 节点下的 Logins 节点下找到登录列表。然后选择您的登录名并右键单击并选择属性。更改默认数据库，您的生活会更美好！

请注意，具有系统管理员权限的人需要能够登录才能执行此操作或运行上一篇文章中的查询。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2013-02-19T12:36:37.567

感谢[这篇文章](https://web.archive.org/web/20121113222237/https://beginsql.wordpress.com/2012/05/03/how-to-set-default-database-in-sql-server-mangement-studio-a-time-saving-tip/)，我找到了一个更简单的答案：

1.  打开 Sql Server 管理工作室

2.  转到对象资源管理器 -> 安全 -> 登录

3.  右键单击登录并选择属性

4.  并在属性窗口中更改默认数据库，然后单击确定。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-12-12T17:23:03.113

如果您无权更改默认数据库，则可以在查询顶部手动选择不同的数据库...

```
USE [SomeOtherDb]
SELECT 'I am now using a different DB' 
```

只要您有权访问*其他*数据库，就可以使用

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-02-23T06:44:45.680

1.  单击更改连接图标
2.  点击选项<<
3.  从连接到数据库下拉列表中选择数据库

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-08-24T21:55:14.950

单击连接到服务器对话框和连接属性上的选项，您可以选择在启动时连接到的数据库。最好将其保留为默认值，这将使 master 成为默认值。否则，您可能会在连接到数据库后无意中在错误的数据库上运行 sql。

[![在此处输入图像描述](https://i.stack.imgur.com/v9EzQ.png)](https://i.stack.imgur.com/v9EzQ.png)

[![在此处输入图像描述](https://i.stack.imgur.com/6FaE3.png)](https://i.stack.imgur.com/6FaE3.png)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-02-23T13:51:18.577

我也更喜欢`ALTER LOGIN`Command 作为接受的答案并在[此处描述](https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-login-transact-sql?view=sql-server-2017)

但对于 GUI 爱好者

1.  转到 [服务器实例] --> 安全 --> 登录 --> [您的登录]
2.  右键单击[您的登录名]
3.  更新页面底部的默认数据库选项

看书累了！！！看看下面

[![在此处输入图像描述](https://i.stack.imgur.com/A1gju.png)](https://i.stack.imgur.com/A1gju.png)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-11-04T13:24:16.320

如果您无法登录 SQL Server：

```
sqlcmd –E -S InstanceName –d master 
```

参考： https: [//support.microsoft.com/en-us/kb/307864](https://support.microsoft.com/en-us/kb/307864)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-08-13T21:03:20.680

这可能会也可能不会完全回答这个问题，但是当我将帐户更改为拥有一个创建为“默认数据库”的新数据库时，我遇到了这个问题（和问题）。然后我删除了该数据库并想从头开始测试我的创建脚本。我注销了 SSMS 并打算重新登录，但被拒绝 - 无法登录到默认数据库是错误。哦！

我所做的是，在 SSMS 的登录对话框中，转到选项、连接属性，然后`master`在“连接到数据库”组合框中键入。单击连接。让我进去。从那里你可以运行命令：

```
ALTER LOGIN [DOMAIN\useracct] WITH DEFAULT_DATABASE=[master]
GO 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-05-23T10:53:10.810

如果您使用 Windows 身份验证，并且您不知道通过用户名和密码以用户身份登录的密码，您可以这样做：在 SSMS 的登录屏幕上单击右下角的选项，然后转到连接属性选项卡. 然后，您可以手动输入您有权访问的另一个数据库的名称，在它显示的位置，这将允许您连接。然后按照其他建议更改默认数据库

[https://gyazo.com/c3d04c600311c08cb685bb668b569a67](https://gyazo.com/c3d04c600311c08cb685bb668b569a67)

# vb.net - 在 VB.NET 中拆分“十进制”

> ID：362441
> 
> 赞同：13
> 
> 时间：2008-12-12T10:40:38.037
> 
> 标签：vb.net, split, decimal

我确信这是一个非常简单的问题，但我是 VB.NET 的新手，所以我遇到了问题。

我有一个`Decimal`变量，我需要将它分成两个单独的变量，一个包含整数部分，一个包含小数部分。

例如，对于 x = 12.34，您最终会得到 ay = 12 和 az = 0.34。

是否有一个很好的内置功能可以做到这一点，还是我必须尝试手动解决？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-12T10:46:03.173

您可以使用[Math.Truncate(decimal)](http://msdn.microsoft.com/en-us/library/7d101hyf.aspx)然后从原始值中减去它。请注意，如果输入为十进制，这将为您提供两个部分的负值（例如 -1.5 => -1，-.5）

编辑：这是 Eduardo 代码的一个版本，它始终使用十进制：

```
Sub SplitDecimal(ByVal number As Decimal, ByRef wholePart As Decimal, _
                 ByRef fractionalPart As Decimal)
    wholePart = Math.Truncate(number)
    fractionalPart = number - wholePart
End Sub 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T10:47:04.047

（正如 Jon Skeet 所说），请注意小数的整数部分可能大于整数，但这个函数会让你明白。

```
 Sub SlipDecimal(ByVal Number As Decimal, ByRef IntegerPart As Integer, _
                    ByRef DecimalPart As Decimal)
        IntegerPart = Int(Number)
        DecimalPart = Number - IntegerPart
    End Sub 
```

如果您使用大数字，请使用 Jon 版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-21T05:53:37.843

简单地：

```
DecimalNumber - Int(DecimalNumber) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-06T11:21:17.470

当数字大于零或小于零时，数字的小数部分和小数部分具有不同的意义。因此，您必须考虑这两种情况。我建议使用以下代码：

```
Dim dbl as double = 13.067
Dim int1 As Integer = 0
Dim fraction As Double = 0
If dbl >= 0 Then
    int1 = Math.Floor(dbl)
ElseIf dbl < 0 Then
    int1 = Math.Ceiling(dbl)
End If
fraction = dbl - int1 
```

fraction 持有 0.067，而 int1 持有 13 。Floor 和 Ceiling，分别将任何小数四舍五入为最小和最大连续整数。

# macros - 如何为 Notepad++ 编写宏？

> ID：362444
> 
> 赞同：37
> 
> 时间：2008-12-12T10:43:28.857
> 
> 标签：macros, notepad++

我想为 Notepad++ 编写一个宏，它应该分别用 char4、char5、char6 替换 char1、char2、char3。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-12-12T14:15:37.657

Notepad++ 中的宏只是一堆编码操作：您开始录制、操作缓冲区、可能激活菜单、停止录制然后播放宏。
经过调查，我发现它们保存在 Macros 部分的文件 shortcuts.xml 中。例如，我有：

```
<Macro name="Trim Trailing and save" Ctrl="no" Alt="yes" Shift="yes" Key="83">
    <Action type="1" message="2170" wParam="0" lParam="0" sParam=" " />
    <Action type="1" message="2170" wParam="0" lParam="0" sParam=" " />
    <Action type="1" message="2170" wParam="0" lParam="0" sParam=" " />
    <Action type="0" message="2327" wParam="0" lParam="0" sParam="" />
    <Action type="0" message="2327" wParam="0" lParam="0" sParam="" />
    <Action type="2" message="0" wParam="42024" lParam="0" sParam="" />
    <Action type="2" message="0" wParam="41006" lParam="0" sParam="" />
</Macro> 
```

我没有查看源代码，但从外观上看，我会说我们有消息发送到 Scintilla（编辑组件，可能类型 0 和 1）和 Notepad++ 本身（可能激活菜单项）。
我认为它不会在对话框中记录操作（例如搜索/替换）。

查看[Scintilla.iface](https://sourceforge.net/p/scintilla/code/ci/default/tree/include/Scintilla.iface)文件，我们可以看到 2170 是 ReplaceSel 的代码（即 insert string is nothing 被选中），2327 是 Tab 命令，Resource Hacker（随便用吧……）显示 42024 是“修剪尾随空格”菜单项和 41006 是“保存”。
我猜动作类型 0 用于带有数字参数的 Scintilla 命令，类型 1 用于带有字符串参数的命令，2 用于 Notepad++ 命令。

问题： Scintilla 没有“全部替换”命令：客户端的任务是进行迭代，无论是否确认等。
另一个问题：似乎类型 1 操作仅限于 1 个字符（我手动编辑, 退出 N++ 时被截断）。
我尝试了一些技巧，但我担心这样的任务超出了宏的能力。

也许这就是具有 Lua 脚本能力的 SciTE（或似乎可以用 Python 编写脚本的程序员记事本）具有优势的地方...... :-)

[编辑] 看起来我从[这个线程](https://stackoverflow.com/questions/118728/notepad-disable-auto-indent-after-empty-lines#118903)或类似的地方得到了上面的宏...... :-) 我猜第一行是不必要的（副作用或录音），但无论如何它们都是宏代码的好例子。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-11-29T07:20:36.480

我发现 Notepad++ 的“ **Python Script** ”插件更有用，因为使用该插件，我可以以 python 的形式编写简单的宏，并且它也有非常好的文档和用 python 编写的示例宏。如果您对 python 很满意，那么我认为“Python 脚本”将提供正义。有关详细信息，请参阅： http: [//npppythonscript.sourceforge.net/](http://npppythonscript.sourceforge.net/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-12-08T10:24:14.010

我录制了一个宏，我在 %APPDATA%\Notepad++\shortcuts.xml 中找到了它。它看起来像在这个线程的第一篇文章中发布。

我使用 NPP 版本。5.9.6.2 与 Win7。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-02-28T18:07:07.583

在 OP 发布 10 多年后发布，但我认为这仍然是一个相关问题（至少对我而言）。今天，Notepad++用户手册中有相当多的信息，与OP的问题有关：

*   关于宏的一般信息：[https ://npp-user-manual.org/docs/macros/](https://npp-user-manual.org/docs/macros/)
*   关于所用语言的一般说明在配置文件文档中：[https ://npp-user-manual.org/docs/config-files/#macros](https://npp-user-manual.org/docs/config-files/#macros)
*   此处更详细地介绍了搜索和替换操作（根据 OP 的要求）：[https ://npp-user-manual.org/docs/searching/#searching-actions-when-recorded-as-macros](https://npp-user-manual.org/docs/searching/#searching-actions-when-recorded-as-macros)

下面是一段宏代码：用 REPLACETEXT 替换 SEARCHTEXT，使用正则表达式“.”。在文件夹 PATH 中与过滤器 GLOBFILEFILTER 匹配的每个文件中找到 /r 和 /n（没有子文件夹，不确定在哪里定义/设置了此标志）。

```
<Macro name="REPLACE_IN_FILES_REGEX_DOT_FINDS_CR_AND_LF" Ctrl="no" Alt="no" Shift="no" Key="0">
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="SEARCHTEXT" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam="REPLACETEXT" />
    <Action type="3" message="1653" wParam="0" lParam="0" sParam="PATH" />
    <Action type="3" message="1652" wParam="0" lParam="0" sParam="GLOBFILEFILTER" />
    <Action type="3" message="1702" wParam="0" lParam="1024" sParam="" /> 
        <!-- #COMMENT: "1024" seems to be the flag ". finds /n and /r". This is not in the documentation. -->
    <Action type="3" message="1701" wParam="0" lParam="1660" sParam="" />
</Macro> 
```

关于此代码的备注：

*   文件夹的路径需要以反斜杠结尾。
*   <、>、& 等字符需要在 xml 中进行转义。而是通过录制宏来创建搜索和替换字符串。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T11:18:58.427

这篇文章可以帮助你有点相关：

[在 Notepad++ 中使用 RegEX 前缀和追加](https://stackoverflow.com/questions/283608/using-regex-to-prefix-and-append-in-notepad)

假设字母数字单词，您可以使用：

搜索 = ^([A-Za-z0-9]+)$ 替换 = 能够："\1"

或者，如果您只想突出显示这些行并使用“全部替换”和“在选择中”（使用相同的替换）：

搜索 = ^(.+)$

^ 指向行首。$ 指向行尾。

\1 将是括号内的源匹配。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-30T08:23:47.383

我个人的经验是，当 Notepad++ 退出时，shortcuts.xml 被最初加载的 + 后来记录的宏和设置覆盖。所以你不能使用 Notepad++ 本身来编辑这个文件。

关闭Notepad++，用其他工具编辑shortcuts.xml，保存并重启Notepad++。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-05-12T18:04:57.780

我不确定这是否有帮助，但我需要创建一个宏来保存一个片段，所以我只是记录了自己插入项目并为其设置快捷方式。当然，我没有使用 5.9 版，所以可能会有一些细微的版本差异。要访问宏录制器，请转到宏 > 开始录制。然后您将执行您的操作，然后转到宏 > 停止录制。我建议播放它以确保它正确，然后保存并设置您的快捷键。

希望有帮助。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-08-03T12:13:41.393

我刚刚在 v5.9.1 中做到了这一点。只需转到宏菜单，单击“开始录制”，执行 3 替换所有命令，然后停止录制。然后，您可以选择“保存当前录制的宏”，并按您喜欢的频率播放它，它会按照您的预期执行替换。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-12-29T18:07:34.563

实际上，shortcuts.xml 文件不*存储*用户生成的宏，并且没有明显的候选包含此信息。这些说明已过时。

与各种网站的提示相反，v.5.4.2 未启用存储用户生成的宏。该 XML 文件在那里，但您的宏没有存储在其中。

估计是下个版本修复的bug。

# html - Visual Studio 中样式表的相对路径在预览中不起作用

> ID：362445
> 
> 赞同：6
> 
> 时间：2008-12-12T10:43:48.000
> 
> 标签：html, css, visual-studio, visual-studio-2008

我假设这是一个简单的问题，但如果我能找到答案，我会很生气。

我在 Visual Studio 2008 中有一个网站。样式表（和图像）的路径采用以下格式 /css/stylesheetname.css

在 Visual Studio 中 Web 项目的根目录中，该文件夹与样式表一样存在。这些路径在 IIS 中运行时可以正常工作。

如果我在 Visual Studio 中使用内置网络服务器，则路径将失败，因为它将项目名称放在路径中，即[http://localhost:2020/projectname/default.aspx](http://localhost:2020/projectname/default.aspx)

在这种情况下， / 将路径直接返回到[http://localhost:2020](http://localhost:2020)

如果您单击“设计”，则尽管样式表已正确导入，但导入背景图像的样式都将失败（因为样式表的所有其他方面工作，即`.class{font-family:arial;}`工作但`.class{background: url(/images/image.jpg)}`不工作），这使情况更加复杂。

我想这与 Visual Studio 如何计算其网站的根路径有关，但是我找不到更改此设置的设置。

有任何想法吗？？ **更新：**根据 Egil Hansen 的回答，我将 CSS 文件中的路径转换为相对路径。但是，背景图像仍然不会在设计模式下显示。我会在适当的时候看看使用主题来解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T11:26:42.360

I think the correct solution is to use relative urls in the style sheet instead of absolute urls as you use now.

Do note that relative urls in style sheets are relative to the location of the style sheet, not the current page being view by the browser.

If you use ASP.NET Themes, you can put all your website graphics in a `/App_Themes/YourTheme/Images/` folder, and put your style sheet in the `/App_Themes/YourTheme/` folder.

In your style sheet, you can then simply reference an image with `url(Images/img.gif)`, and it will work both online and in development.

The you just need to assign your ASP.NET Theme to the page(s) you want, either through web.config's Pages section (`<pages styleSheetTheme="Default">`) that will assign a theme to all pages on the website or through the <%@ Page ... directive on each page.

In general, you can do some really neat things with ASP.NET Themes and Skins, just take a look at the [ASP.NET Themes and Skins Overview](http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx) over at msdn.microsoft.com.

There are a few issues to be aware of with Themes in ASP.NET, take a look at my post [How to take control of style sheets in ASP.NET Themes with the StylePlaceHolder and Style control](https://stackoverflow.com/questions/328763/how-to-take-control-of-style-sheets-in-aspnet-themes-with-the-styleplaceholder), which explains and solves the issues I have come across so far.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T22:23:19.283

不确定这是否适用于 VS 2008，但我使用的是 Visual Web Developer 2010，它对我有用：

1) 在解决方案资源管理器中单击项目

2）它显示了一个“虚拟路径”属性，默认为“/projectname”

3）改为“/”，它似乎做了想要的

让我知道这是否适合您！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-20T07:06:42.637

我一直在为 ASP.Net 应用程序的所有图形使用自定义 Image 文件夹运行项目。虽然渐进式 VS IDE 中的 App_Theme 和 App_Code 文件夹在这方面取得了进展；我仍然保留了我的文件夹，并且在服务器上部署它时并没有失望。

话虽如此 - 众所周知的文件夹将与所有 bin、App_Code 和 _Themes 一起放置，并且通过这种方式对其进行引用

背景：网址（../image/..）；

当然，上面的代码位于 CSS 文件中。它一直对我有用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T07:54:42.063

我有同样的问题，它让我发疯。解决方案是添加一个 Apps_Theme 文件夹并将图像复制到那里。发布站点时，会保留文件夹结构并显示图像。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T11:13:16.693

自从我在 css 中做任何事情以来已经很久了，但也许 url(./images/image.jpg) 会起作用吗？

编辑：或者更确切地说 ~/format /css/stylesheetname.css 或 ./format /css/stylesheetname.css 作为样式表的 url。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-08T09:09:06.847

我已经通过代码设置路径 css url 图像 { background:url(/images/xxx.jpg) no-repeat; 并在 IIS 上运行文件，因此必须将默认网站指向您的项目

如何运行测试预览类型： [http://localhost/default.aspx](http://localhost/default.aspx)

这是在服务器上运行的正确路径，包括文件 js 或 css 可以使用“/”根路径

欢呼Noboyband

# java - 具有所有具体方法的抽象类

> ID：362446
> 
> 赞同：17
> 
> 时间：2008-12-12T10:44:12.773
> 
> 标签：java, abstract-class

当类抽象中的所有方法都是具体的时，是否有一些实际的编程情况可供某人声明类抽象？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-12T10:51:04.380

好吧，您可以使用模板方法模式，其中有多个覆盖点都具有默认实现，但是组合的默认实现本身是不合法的 - 任何功能实现都必须子类化。

（是的，我不喜欢模板方法模式；））

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T10:50:03.353

抽象类是被声明为抽象的类——它可能包含也可能不包含抽象方法。它们不能被实例化，所以如果你有一个带有具体方法的抽象类，那么它可以被子类化，然后子类可以被实例化。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T12:43:59.697

想象一个接口，其声明的方法通常在实现时显示相同的默认行为。在编写需要支持接口的类时，您必须一遍又一遍地定义所述默认行为。

为了促进具体类的实现，您可能希望提供一个抽象类，为每个方法提供默认行为。要支持具体类中的接口，您可以从抽象类派生并覆盖偏离标准行为的方法。这样您就可以避免重复实现相同（冗余）的默认行为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T18:39:56.593

另一个可能的用例是装饰器，它将所有调用委托给包装的实例。具体的装饰器实现只能覆盖那些添加了功能的方法：

```
public interface Foo {
    public void bar();
}
public abstract class FooDecorator implements Foo {
    private final Foo wrapped;
    public FooDecorator(Foo wrapped) { this.wrapped = wrapped; }
    public void bar() { wrapped.bar(); }
}
public class TracingFoo extends FooDecorator {
    //Omitting constructor code...
    public void bar() {
        log("Entering bar()");
        super.bar();
        log("Exiting bar()");
    }
} 
```

虽然我并不认为有必要将 FooDecorator 声明为抽象（非抽象示例：[HttpServletRequestWrapper](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/http/HttpServletRequestWrapper.html)）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T23:34:54.440

以前的答案已经解决了主要问题，但有一个小细节可能值得一提。

您可以拥有一个返回抽象类的（隐藏）子类实例的工厂。抽象类在结果对象上定义契约，并提供默认实现，但该类是抽象的这一事实既使其不能被直接实例化，也表明“真实”实现类的身份不是发表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-18T10:40:15.583

想知道为什么没有人指出 MouseAdapter 的实际示例：

[http://docs.oracle.com/javase/6/docs/api/java/awt/event/MouseAdapter.html](http://docs.oracle.com/javase/6/docs/api/java/awt/event/MouseAdapter.html)

> 用于接收鼠标事件的抽象适配器类。此类中的方法为空。此类的存在是为了方便创建侦听器对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T10:58:48.860

好问题:)

有一件事是肯定的……这当然是可能的。krosenvold 的模板建议是这样做的一个很好的理由。

我只想说一个类不能`abstract`仅仅为了防止它的实例化而被声明。

[这在 Java 语言规范第 8.1.1.1 节](http://java.sun.com/docs/books/jls/third_edition/html/classes.html#8.1.1.1)中有所提及

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T15:40:13.243

当您有一个重要的类但系统无法为该类创建实例时，因为

*   这个类是系统很多类的父类；
*   这对域的需求有很多责任（很多类使用的方法）；
*   此类不代表具体对象；

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-06T15:15:30.830

**小服务程序示例：**

**所有方法都是具体的，但基类本身是无用的：**

删除Author.java

1.  具有具体 doGet 方法的抽象类。
2.  doGet 调用在**受保护**字符串 sql_path 中指向的文件。
3.  **sql_path 为 null**。

DeleteAuthor **Keep** Book.java

1.  扩展抽象类 DeleteAuthor
2.  将 sql_path 设置为 delete_author_ **KEEP** _BOOK.sql

DeleteAuthor**烧录**书.java

1.  扩展抽象类 DeleteAuthor
2.  将 sql_path 设置为 delete_author_ **BURN** _BOOK.sql

# perl - 为什么 HMAC SHA-1 会返回具有相同输入的不同摘要？

> ID：362461
> 
> 赞同：5
> 
> 时间：2008-12-12T10:50:35.147
> 
> 标签：perl, encryption, hmac, digest, sha1

我正在尝试为 Amazon S3 Web 服务构建一个有效的加密签名，使用 Objective C 编写一个连接库。

我在 ObjC 代码中遇到了 HMAC SHA-1 摘要问题，所以我把它放在一边，并查看现有的工作 Perl 代码，以尝试解决摘要创建问题。

我正在测试包`s3ls`命令的HMAC SHA-1 摘要输出，并将其与我取出并放入其自己的 perl 脚本的子例程进行比较：`Net::Amazon::S3``_encode`

```
#!/usr/bin/perl -w                                                                                                                                                                                    

use MIME::Base64 qw(encode_base64);
use Digest::HMAC_SHA1;
use String::Escape qw( printable unprintable );

sub _ascii_to_hex {
    (my $str = shift) =~ s/(.|\n)/sprintf("%02lx", ord $1)/eg;
    return $str;
}

sub _encode {
    my ( $aws_secret_access_key, $str ) = @_;
    print "secret key hex: "._ascii_to_hex($aws_secret_access_key)."\n";
    my $hmac = Digest::HMAC_SHA1->new($aws_secret_access_key);
    $hmac->add($str);
    my $digest = $hmac->digest;
    print "cleartext hex: "._ascii_to_hex($str)."\n";
    print "digest hex: "._ascii_to_hex($digest)."\n";
    my $b64 = encode_base64( $digest, '' );
    print "encoded: ".$b64."\n";
}

my $secret = "abcd1234";
my $cleartext = "GET\n\n\nFri, 12 Dec 2008 10:08:51 GMT+00:00\n/";
_encode($secret, $cleartext); 
```

这是此脚本的示例输出：

```
$ ./testhmac.pl 
secret key hex: 6162636431323334
cleartext hex: 4745540a0a0a4672692c2031322044656320323030382031303a30383a353120474d542b30303a30300a2f
digest hex: 63308f9b8a198440d6d8685a3f3f70d0aab02f68
encoded: YzCPm4oZhEDW2GhaPz9w0KqwL2g= 
```

What I am testing is that, if I input the same secret key and cleartext into the same `_encode` function of the `Net::Amazon::S3` package, I should see the very same secret key, cleartext, and digest bytes.

Indeed, I get the same bytes for the secret key and cleartext.

But I get something different for the digest (and of course the base64 encoding), e.g.:

```
$ s3ls --access-key=foobar --secret-key=abcd1234
...
secret key hex: 6162636431323334
cleartext hex: 4745540a0a0a4672692c2031322044656320323030382031303a30383a353120474d542b30303a30300a2f
digest hex: c0da50050c451847de7ed055c5286de584527a22
encoded: wNpQBQxFGEfeftBVxSht5YRSeiI= 
```

I have verified that the secret key and clear text are the same input to both scripts. The encoding subroutine is virtually identical in both scripts (except for an unused argument passed to the subroutine, which I remove from my custom version).

What would cause the HMAC SHA-1 digest to be computed differently in both cases, if the input bytes and `_encode` subroutine are the same?

(I have also verified the two scripts against the test cases at [RFC 2201](http://www.faqs.org/rfcs/rfc2202.html).)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T12:16:44.120

I find the the main problems I have had with hashes in comparisons are:

1.  ensure the data and key are the same in both comparisons
2.  ensure the data and key are in the same character encoding in both comparisons
3.  ensure the key and text are being passed the same in both scripts, i.e. which one is key and which one is text (this has caught me more than once).

Try using the Digest::SHA module to create the hash for you and compare the results with that.

```
use Digest::SHA qw(hmac_sha1_hex);
my $hash = hmac_sha1_hex($data, $key); 
```

See docs at [http://perldoc.perl.org/Digest/SHA.pdf](http://perldoc.perl.org/Digest/SHA.pdf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T21:10:00.160

> The encoding subroutine is virtually identical in both scripts (except for an unused argument passed to the subroutine, which I remove from my custom version).

Since you're not comparing the digests themselves, but Base-64 encoded versions of the digests, I would recommend backing up one step and checking the digests themselves. It may be possible that the Base-64 encoding routines are incorrect.

If you can't compare the digests themselves, then use the same encoding routine in both programs and see what you get.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T11:26:22.157

I'm afraid I can't help much here, but there's definitely something wrong with what you posted. Your example script produces different output for me and the output you posted really cannot be correct.

How could this

```
secret key hex: abcd...1234 
```

ever be the result of that

```
_ascii_to_hex("blahblahblah") 
```

Of course, the whole ascii_to_hex thing is completely irrelevant to your problem, but it shows that you should double-check your results.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T12:24:17.803

Divide and conquer?

The test vectors in the RFC are the best place to start. Did they pass in both instances? Which ones did you try? If some work and others don't the most likely problem is that one of the two APIs are improperly marshalling the keys input (Signed vs unsigned arrays, charset conversions..etc)

As an aside its really difficult to help you when your example is nonsense. As others mentioned the hex representation of blah blah is not abc..123\. Makes me wonder what else in your example is inaccurate?

# asp.net - 如何在 ASP.NET 中使用 log4net 在日志文件中包含 SessionID？

> ID：362468
> 
> 赞同：24
> 
> 时间：2008-12-12T10:58:31.260
> 
> 标签：asp.net, logging, log4net

我是 log4net 的新手，所以希望这对某人来说是一个非常简单的问题？！

我已经让 log4net 与 RollingLogFileAppender 一起用于我的 Web 应用程序。我正在使用日志记录来尝试找出一些性能问题的来源。为了做到这一点，在日志输出中包含 ASP.NET SessionID 会很有用，这样我就可以确保我正在查看特定用户的日志条目。

有什么办法可以通过附加程序的`conversionPattern`设置来做到这一点？有`%property{??}`我可以使用的设置吗？

**更新：这个问题仍然没有得到回答——有人有什么想法吗？**

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2011-03-16T05:08:45.967

Alexander K. 几乎是正确的。唯一的问题是`PostAcquireRequestState`静态请求也会发生该事件。在这种情况下调用 Session 将导致`HttpException`.

因此正确的解决方案变为：

```
protected void Application_PostAcquireRequestState(object sender, EventArgs e)
{
    if (Context.Handler is IRequiresSessionState)
    {
        log4net.ThreadContext.Properties["SessionId"] = Session.SessionID;
    }
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-16T23:10:08.090

**更新（2014-06-12）：**从 log4net 1.2.11 开始，您可以`%aspnet-request{ASP.NET_SessionId}`为此目的在转换模式中使用。

参考资料： [https :](https://issues.apache.org/jira/browse/LOG4NET-87) [//issues.apache.org/jira/browse/LOG4NET-87 http://logging.apache.org/log4net/release/sdk/log4net.Layout.PatternLayout.html](http://logging.apache.org/log4net/release/sdk/log4net.Layout.PatternLayout.html)

* * *

您应该在 Global.asax.cs 中创建 Application_PostAcquireRequestState 处理程序（在每个请求中都会调用它）：

```
protected void Application_PostAcquireRequestState(object sender, EventArgs e)
{
    log4net.ThreadContext.Properties["SessionID"] = Session.SessionID;
} 
```

并将 [%property{SessionID}] 添加到 conversionPattern。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-11T07:02:07.357

我也在寻找这个问题的答案，发现这`%aspnet-request{ASP.NET_SessionId}`对我来说很好。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-24T22:42:59.373

如果我错了，有人会纠正我，但是一个 ASP.NET 线程可以处理多个会话，因此您不能使用 Session_Start，因为它在会话开始时被调用一次。这意味着一旦其他用户访问该网站，您的 log4net.ThreadContext 可能会被新的用户信息覆盖。

您可以将以下代码放在 Application_AcquireRequestState 中，或者创建一个 HttpModule 并在 AcquireRequestState 方法中执行此操作。当 ASP.NET 运行时准备好获取当前 HTTP 请求的会话状态时，将调用 AcquireRequestState。如果您对获取用户名感兴趣，您可以在 AuthenticateRequest 中执行此操作，该操作在 ASP.NET 运行时准备好验证用户身份时（以及在 AcquireRequestState 之前）引发。

```
 private void AcquireRequestState(Object source, EventArgs e)
    {
        HttpApplication application = (HttpApplication)source;
        HttpContext context = application.Context;
        log4net.ThreadContext.Properties["SessionId"] = context.Session.SessionID;
     } 
```

之后，您可以像这样设置 log4net.config（或在 web.config 中）。

```
<appender name="rollingFile"
      type="log4net.Appender.RollingFileAppender,log4net" >
  <param name="AppendToFile" value="false" />
  <param name="RollingStyle" value="Date" />
  <param name="DatePattern" value="yyyy.MM.dd" />
  <param name="StaticLogFileName" value="true" />

  <param name="File" value="log.txt" />
  <layout type="log4net.Layout.PatternLayout,log4net">
    <param name="ConversionPattern"
      value="%property{SessionId} %d [%t] %-5p %c - %m%n" />
  </layout>
</appender> 
```

希望这可以帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T11:38:24.253

You can try:

```
<conversionPattern
    value="%date %-5level %logger ${COMPUTERNAME} [%property{SessionID}] - %message%newline" /> 
```

...in your Web.config, and in Global.asax.cs:

```
protected void Session_Start(object sender, EventArgs e)
{
    log4net.ThreadContext.Properties["SessionID"] = Session.SessionID;
    log4net.Config.XmlConfigurator.Configure();
} 
```

# asp.net - 将站点从 php 移动到 asp.net 时，如何在 asp.net 中从旧的 Apache mod_rewrite 样式 url 进行 301 重定向？

> ID：362472
> 
> 赞同：1
> 
> 时间：2008-12-12T11:02:53.420
> 
> 标签：asp.net, redirect, iis-6, http-status-code-301

我有一个使用 mod_rewrite 插件在 Apache 上运行的现有 php 站点。换句话说，我目前有诸如 www.example.com/section/subsection/ 之类的网址，Google 和其他人已将其编入索引。

但是，该站点需要进行重大升级，我想将其移至 asp.net。我只能选择使用共享主机解决方案（iis 6、aps.net 3.5、完全信任）。所以我的问题是：我如何让 asp.net 从我的旧网址（如 www.example.com/section/subsection/）执行 301 重定向到新 asp.net 网站上的等效网址？

我显然需要这样做，以免失去搜索引擎中的当前排名。

谢谢，埃吉尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T11:17:48.897

如果您使用 ASP.NET MVC 框架，它会内置一个 URL 重写系统。

如果要设置“移动”位置，可以使用 IIS 管理器手动将 301 重定向添加到 IIS。

如果你想重写 URL，那么你需要实现 IHttpModule，连接 BeginRequest 事件，并将这个新类添加到 Web.config 中的 httpModules 部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T13:24:51.190

好的......所以这可能是矫枉过正，可能会在两行中以另一种方式完成......但是......

如果您保留相同的域名，那么我过去所做的就是保留一张旧网址表以及它们如何映射到新网址。根据应用程序的请求，我将扫描表，如果找到旧的 url，那么我将添加一个标头，将 301 重定向到新的 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T11:39:42.177

根据 Steve Sanderson 的博客文章 将[ASP.NET MVC 部署到 IIS 6](http://blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/)，在共享主机设置中似乎没有选项可以使用 IIS6 进行 url 重写/重定向，您无法手动配置 IIS。嘎...

# upload - 如何使用 CURL 将文件上传到受密码保护的 HTTPS 站点？

> ID：362473
> 
> 赞同：4
> 
> 时间：2008-12-12T11:03:12.593
> 
> 标签：upload, curl

如何使用 CURL 将文件上传到 HTTPS 站点？

该网站也受密码保护。

用于为该特定站点上传的命令行是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T11:37:49.840

是的你可以，

```
$ curl --user login:password --upload-file your.file.txt https://the.url/where/that/should/go 
```

`--insecure`如果您不希望 cURL 检查证书链，则可能需要添加。

# linq-to-sql - 将常量 where 子句添加到 Linq 到 SQL 映射

> ID：362483
> 
> 赞同：1
> 
> 时间：2008-12-12T11:10:52.907
> 
> 标签：linq-to-sql

可以将常量 where 子句放入 Linq 到 SQl 的映射。

我真的不想在查询级别或我的数据访问对象中执行此操作，因为它们目前是完全通用的，并且希望保持这种方式为其他开发人员创造生活并避免我不断重复自己。

科林·G

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T11:46:30.423

我解决此问题的一种方法是使用返回实体类型的 IQueryable 的扩展方法，然后在需要该实体的任何地方使用它。

例如，如果我所有的自定义查询只对没有设置 Inactive 标志的 Horses 感兴趣，我将有一个名为 GetHorses 的扩展方法：

```
public static IQueryable<Horse> GetHorses(this DataContext db)
{
    return from h in db.Horses
           where !h.Inactive
           select h;
} 
```

显然，由于该方法返回一个 IQueryable，您可以在任何使用它的方法中进行进一步的过滤/排序等。因此，而不是我的自定义查询看起来像这样：

```
var deadHorses = from h in db.Horses
                 where !h.inactive && !h.Alive
                 select h; 
```

它们看起来像这样：

```
var deadHorses = from h in db.GetHorses()
                 where !h.Alive
                 select h; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T12:01:12.217

我相信你可以使用你的 DataContext 的 Options 属性来做到这一点。检查 AssociateWith 方法。

# python - 将 Python 对象序列化到 S60 手机/从 S60 手机序列化一个 Python 对象

> ID：362484
> 
> 赞同：1
> 
> 时间：2008-12-12T11:11:00.567
> 
> 标签：python, serialization, pickle, pys60

我正在寻找一种在基于 CherryPy 的服务器和在 Symbian 手机上运行的 Python 客户端之间序列化**通用**Python 对象的方法。由于 pyS60 没有实现 pickle 模块，你会怎么做？

我知道[Cerealizer](http://home.gna.org/oomadness/en/cerealizer)，但它要求您在使用前注册课程（我想避免）并且看起来不太成熟。那么，您会使用什么？Python 2.2 的 pickle 模块可能是从源代码中提取的？XML、JSON？几个库中的哪一个？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T12:09:24.447

使用 pickle 模块有什么问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T16:48:31.483

有人为 PyS60 编写了一个 json 模块。我只是抓住它，将事物序列化为 json 并将其用作 Web/客户端应用程序之间的传输方法。

对于 json 库和一本不错的 PyS60 书籍： [http ://www.mobilepythonbook.org/](http://www.mobilepythonbook.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-08T17:19:45.477

最新版本的 Python (>1.9) 有模块 pickle 和 cPickle 可用

JSON 序列化的另一种替代方法是使用 netstring（查看 wikipedia）格式进行序列化。对于二进制对象，它实际上比 JSON 更有效。

你可以在这里找到一个好的网络字符串模块 [http://github.com/tuulos/aino/blob/d78c92985ff1d701ddf99c3445b97f452d4f7fe2/wp/node/netstring.py](http://github.com/tuulos/aino/blob/d78c92985ff1d701ddf99c3445b97f452d4f7fe2/wp/node/netstring.py)（或aino/wp/node/netstring.py）

# language-agnostic - 我应该为将来的更改准备代码吗？

> ID：362488
> 
> 赞同：11
> 
> 时间：2008-12-12T11:14:34.927
> 
> 标签：language-agnostic

我是否应该为可能/预测的未来更改准备我的代码，以便即使我真的不知道是否随时需要这些更改，也可以更轻松地进行这些更改？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-12T11:37:53.367

我可能会因为我对此的意见而被处以私刑，但我走了。

虽然多年来我一直在阅读理想主义的文章，并参加了太多的研讨会和讲座，这些研讨会和讲座都明确地说明了这一点的涅槃般的好处，但我心中也有类似的问题。这种思路可能导致代码的大量过度设计，在设计、开发和测试估算中增加许多工时或更多，增加成本和管理费用，而实际上这种情况并不常见。您实际重用了多少次代码或库。如果要在许多地方，通过许多项目使用它，那么是的，你应该这样做。

然而，大多数时候情况并非如此。当您真正知道要再次使用它时，您通常会发现仅重构代码以实现重用和可配置性更经济（在时间和金钱上）。剩下的时间，真正的好处就消失了。

我再说一遍，这不是编写草率、设计不佳、文档记录不佳的代码的借口。这应该是一个根深蒂固的基本原理，以至于你无法打破它，但是编写一个用于重用的类在大多数情况下是一种浪费，因为它永远不会被重用。

这有明显的例外。如果您正在编写第三方库，那么显然情况并非如此，重用和扩展应该是您设计的关键。某些其他类型的代码应该很容易重用（日志记录、配置等）

我在这里问了一个类似的问题[代码可重用性：值得吗](https://stackoverflow.com/questions/325514/code-reusability-is-it-worth-it "代码可重用性：值得吗")？它可能会有所帮助。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-12T11:18:14.950

在合理的范围内，当然，如果它没有太多的努力。

我不认为你总是可以应用这个，因为它会让你过度设计一切，然后花费太长时间而且你赚不到多少钱。考虑客户实施某事的可能性有多大，现在为它做准备需要多少额外的时间，以及以后会节省多少时间。

如果它需要大量的工作，但省钱是有意义的，你可以和客户一起筹集。

我似乎与这里的很多人意见相左，他们总是这么说——但我看到很多事情都在努力使未来的功能易于实现……但它们从未实现过。如果客户没有为使该功能易于实施所花费的时间付费，那么这笔钱就直接从您的底线中扣除了。

编辑：我认为指出我来自代理环境是相关的。如果您正在为自己编写代码，您可能可以更确定地预测未来的发展，因此在更多情况下这样做可能是可行的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-12T11:37:09.233

亚尼。

[http://en.wikipedia.org/wiki/YAGNI（*](http://en.wikipedia.org/wiki/YAGNI)由友好编辑插入 :-) *）

修复您今天编写的那段可怕的代码中的错误。

时机成熟时重构。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-12T11:33:28.337

如果您使用重构友好的语言工作，我会说不。（其他语言我不确定）

您应该使您的代码尽可能松散耦合，并使事情尽可能简单。保持具体，不要泛化到未知的用例。

这将使您的代码库为未来将带来的东西做好准备。

（坦率地说，对未来的大多数预期往往都离谱，以至于今天不值得为它编码）

编辑：这也取决于你在做什么。为外部用户设计 API 与为您的公司开发 Web 应用程序不同

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-12T11:53:22.593

是的——做的更少。

您将不知道您的代码未来的要求是什么。对未来最好的准备是*不要*立即实施任何不需要的东西，并且对你实施的所有东西都有良好的单元测试*覆盖率*。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-12T11:18:02.907

**代码的可扩展性**是您应该始终考虑的一件事。

**您今天花在满足可扩展解决方案上的时间越多，您在未来实际扩展时花费的时间就越少**

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-12T11:19:19.410

预测的或很可能的变化——是的，通常最好记住它们。

“考虑到宇宙中可能发生的任何事情” - 不。你*不知道*会发生什么，试图覆盖所有未知的东西只是过度工程。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-12T11:44:34.153

请记住，**大多数代码**将被更改/重构。如果您知道您**将**在下周内更改您的代码，请做好准备。但不要开始默认使所有东西都可交换和模块化。仅仅因为“也许在未来”你不应该创建一个框架，如果三行代码现在就可以完成这项工作。

但是请三思，如果背后的系统使重构变得困难（数据库）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-12T13:09:07.713

在我为我工作的公司编码的仅仅一年中，我学到了一件事情，你所做的一切，无论你认为它多么完美，都会回来困扰你进行更新或需要更改，因为客户 X 突然决定不喜欢它。

现在我正在使我的代码高度可定制，所以当那一天进行一些调整时，它会立即准备好，我可以继续我的工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-12T11:16:18.043

一句话，是的。

简而言之，您应该始终使您的代码尽可能可读，包括注释，并始终假设在将来的某个时间，您将被要求或其他人修改代码。

如果将来有人遇到一段代码，未注释，未格式化，没有说明它做什么或应该做什么，那么他们将永远诅咒你:)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-12T12:29:27.433

没有永不。编写易于重用/重构的好代码，但为经过深思熟虑的增强做准备是，imo，过早优化的兄弟；您可能最终会做您不需要的事情，或者在未来某个日期将您推向某个（可能不是最佳的）设计路径。正如 mfx 所说，现在做最低要求并对所有内容进行单元测试；它使扩展代码变得轻而易举。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-12T11:17:23.143

就两个字：是的，总是。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-12T11:17:51.363

您所描述的是成为一名优秀开发人员的重要组成部分。

请参阅**[编写可维护代码](http://codebetter.com/blogs/jeremy.miller/archive/2006/12/06/On-Writing-Maintainable-Code.aspx)**

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-12T11:33:36.543

显而易见的答案是肯定的。但更重要的问题是如何！

正交性、可逆性、灵活架构、解耦和元编程是解决这个问题的一些关键词。[查看“实用程序员](https://rads.stackoverflow.com/amzn/click/com/020161622X)”的第 2 章和第 5 章

我发现设计一个“适应变化”的架构通常比试图指定可能（或可能不会）发生的特定变化更好。不过，问“未来会发生什么变化？”是一个很好的练习，然后抵制过早实现可能不必要的功能的诱惑，而是在创建应用程序架构时考虑到这些可能性。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-12T12:15:18.850

我发现这里与我最近听到的关于测试驱动开发的内容有相似之处。谈论它的人观察到，虽然一开始总是编写单元测试并考虑如何编写可测试的代码可能有点烦人，但事实证明，在某些时候它只是开始自然而然地编写测试友好的代码。

关键是，如果您始终考虑可修改性，您最终可能会或多或少地通过反射来完成它，从而使编写额外代码的开销非常小。如果你能达到一个高质量、可扩展的代码对你来说自然而然的状态，我认为这绝对值得你付出初始成本。不过，我仍然相信，您必须适度使用它，而且有时对于特定客户而言，这样做并不是正确的做法。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-12T12:47:25.260

遵循两个简单的原则：

1.  吻
2.  始终避免依赖

这是一个好的开始

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-12T12:57:34.193

是的，但只能通过编写可维护、易于重构的代码。

您绝对不应该尝试猜测未来可能需要什么。这样的努力不仅对您当前的目标毫无意义且浪费时间，而且当未来的任何变化变得明显时，往往会适得其反。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-12T13:14:52.757

这真的很重要。它需要做好，但需要经验。

如果我在实施典型的需求更改后计算编辑次数（通过“差异”），10-50 之类的数字很常见。

如果我在其中任何一个上犯了错误，*我已经插入了一个错误*。

所以就个人而言，我总是尝试设计来**保持这个数字**。

我还尝试在代码中留下有关如何进行预期更改的说明。如果我正在维护代码，如果之前的作者也这样做了，我真的很感激。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-12T13:15:34.580

> 平衡努力与收益是设计的技巧。

并非我们所有的代码都需要灵活。有些事情不会改变。

没有白费力气。找到合适的部分来投入我们的注意力。

棘手。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-12-12T13:45:19.747

是的，请始终考虑您的代码将来可能需要在哪里发展。在我正在处理的当前项目中，有数千个文件，每个文件都至少有一个修订版。即使撇开错误修复，这些修订中的很多也是为其他软件功能让路。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-12-12T14:01:41.070

我不会改变我的能力来为未知的未来功能做准备。

但我会重构以获得当前问题的最佳解决方案。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-07-08T09:07:17.350

您不能针对未知（未来）进行设计，正如其他人所说，尝试构建灵活的设计很容易导致过度工程，因此我认为最好的务实方法是避免您知道会发生的事情使您将来更难维护代码。每次你做出设计决定时，问问自己是否会让未来改变事情变得更加困难，如果是这样，你将采取什么措施来限制问题。

总是会导致问题的显而易见的事情：

*   分散的配置信息 - 您需要能够轻松检查和更改这些内容
*   未经测试的代码 - 您需要测试才能自信地进行更改
*   将存储和输出问题与核心逻辑混合——如果只是为了测试，您将切换数据库实例和输出格式
*   复杂的架构——你需要对系统有一个清晰的心智模型
*   需要人工干预或更新以保持运行的安排

# python - 如何在 NumPy 中为矩阵添加保护环？

> ID：362489
> 
> 赞同：2
> 
> 时间：2008-12-12T11:15:15.220
> 
> 标签：python, numpy

使用[NumPy](http://numpy.scipy.org/)，矩阵 A 有 n 行和 m 列，我想为矩阵 A 添加一个保护环。该保护环全为零。

我该怎么办？使用重塑？但该元素不足以构成一个 n+1 m+1 矩阵。

还是等等？

提前致谢

我的意思是一圈额外的单元格总是包含 0 环绕矩阵 A。基本上有一个矩阵 B 有 n+2 行 m+2 列，其中第一行和列以及最后一行和列都为零，其余为与矩阵 A 相同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T15:12:04.923

跟进您的[评论](https://stackoverflow.com/questions/362489/how-do-i-add-a-guard-ring-to-a-matrix-in-numpy#362576)：

```
>>> import numpy
>>> a = numpy.array(range(9)).reshape((3,3))
>>> b = numpy.zeros(tuple(s+2 for s in a.shape), a.dtype)
>>> b[tuple(slice(1,-1) for s in a.shape)] = a
>>> b
array([[0, 0, 0, 0, 0],
       [0, 0, 1, 2, 0],
       [0, 3, 4, 5, 0],
       [0, 6, 7, 8, 0],
       [0, 0, 0, 0, 0]]) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-14T00:10:02.820

这是[亚历克斯答案](https://stackoverflow.com/questions/362489/how-do-i-add-a-guard-ring-to-a-matrix-in-numpy#363040)的一个不太通用但更容易理解的版本：

```
>>> a = numpy.array(range(9)).reshape((3,3))
>>> a
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
>>> b = numpy.zeros(a.shape + numpy.array(2), a.dtype)
>>> b
array([[0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0]])
>>> b[1:-1,1:-1] = a
>>> b
array([[0, 0, 0, 0, 0],
       [0, 0, 1, 2, 0],
       [0, 3, 4, 5, 0],
       [0, 6, 7, 8, 0],
       [0, 0, 0, 0, 0]]) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-11T03:56:46.910

这个问题现在很古老，但我只是想提醒人们发现[numpy 有一个`pad`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.pad.html)现在很容易完成的功能。

```
import numpy as np
a = np.array(range(9)).reshape((3, 3))
a
Out[15]: 
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])

a = np.pad(a, pad_width=((1,1),(1,1)), mode='constant', constant_values=0)
a
Out[16]: 
array([[0, 0, 0, 0, 0],
       [0, 0, 1, 2, 0],
       [0, 3, 4, 5, 0],
       [0, 6, 7, 8, 0],
       [0, 0, 0, 0, 0]]) 
```

# java - 从 Java 1.4.2 更新到 Java 6（都是 Sun VM）会导致性能下降

> ID：362500
> 
> 赞同：2
> 
> 时间：2008-12-12T11:24:27.450
> 
> 标签：java, performance, jvm, sun

我刚刚将一些在 Sun Java 1.4.2 VM 上运行的旧 Java 源升级到 Sun Java (JRE) 6 VM。或多或少我唯一需要改变的是为一些抽象对象（Hashmap's、Vector's 等）添加显式数据类型。代码本身非常占用内存，最多使用 1G 的堆内存（使用 -Xmx1024m 作为启动 VM 的参数）。

由于我阅读了很多关于在较新的 Java VM 上获得更好性能的信息，这就是我进行此升级的原因之一。

1.  谁能想到我现在的情况下性能更差的原因（当然，一般来说，因为您无法查看代码）？
2.  如果我想优化（速度方面）现有代码，有没有人对非 Java 大师有什么建议？任何提示、推荐的文档、工具？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T11:35:30.093

这里没有太多信息。但这里有一些你可能想要探索的东西：

*   使用 Xmx 和 Xms 作为相同的值启动 VM（在您的情况下为 1024M）

*   确保正在使用服务器 jvm dll 来启动虚拟机。

*   运行分析器以查看哪些对象正在占用内存或哪些对象没有被垃圾收集

*   使用 jconsole 连接您的 VM 并跟踪对象

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T11:28:40.357

如果您的应用程序几乎耗尽可用空间，垃圾收集时间可能会支配计算时间。

启用 gc 调试以查找此内容。或者，更好的是，只需启动 jconsole 并将其附加到您的程序中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T15:07:46.037

从理论上讲，您的应用程序可能会消耗更多内存，因为字符串共享其内部 char[] 的方式发生了变化。1.4 后共享较少。[在http://www.sdn.sap.com/irj/scn/weblogs?blog=/pub/wlg/5100](http://www.sdn.sap.com/irj/scn/weblogs?blog=/pub/wlg/5100)查看我的旧博客（新博客在[这里](http://kohlerm.blogspot.com/)）

我会比较垃圾收集器日志，看看内存使用是否真的是问题所在。

如果这没有帮助，我们可以使用 Yourkit 之类的分析器来找出差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-31T02:25:59.567

绝对在应用程序上使用分析器（YourKit 很棒）......当大多数时候你可以在分析器中快速缩小范围时，很容易浪费大量时间猜测问题。

# regex - How can I remove the text before and after a particular character?

> ID：362503
> 
> 赞同：3
> 
> 时间：2008-12-12T11:26:46.540
> 
> 标签：regex, perl

I have been trying to remove the text before and after a particular character in each line of a text. It would be very hard to do manually since it contain 5000 lines and I need to remove text before that keyword in each line. Any software that could do it, would be great or any Perl scripts that could run on Windows. I run Perl scripts in ActivePerl, so scripts that could do this and run on ActivePerl would be helpful.

Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T12:10:04.603

I'd use this:

```
$text =~ s/ .*? (keyword) .* /$1/gx; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T11:32:30.803

You don't need software, you can make this part of your existing script. Multiline **regex** replace along the lines of /a(b)c/ then you can backref b in the replacer with $1\. Without knowing more about the text you're working with it's hard to guess what the actual pattern would be.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T11:57:53.643

Presuming that you have the following:

> text1 text2 keyword text3 text4 text5 keyword text6 text7

and what you want is

```
s/.*?keyword(.*?)keyword.*/keyword$1keyword/; 
```

otherwise you can just replace the whole line with keyword

An example of the data may help us be clearer

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T11:34:45.993

I'd say, that if $text contains your whole text, you can do :

```
$text =~ s/^.*(keyword1|keyword2).*$/$1/m; 
```

The `m` modifier makes `^` and `$` see a beginning and an ending of line, and not the beginning and ending of the string.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T13:13:25.223

假设您要删除左侧的`keyword1`所有文本和右侧的所有文本`keyword2`：

```
while (<>) {
  s/.*(keyword1)/$1/;
  s/(keyword2).*/$1/;
  print;
} 
```

将其放入 perl 脚本并像这样运行它：

```
fix.pl original.txt > new.txt 
```

或者，如果您只想就地执行此操作，可能一次在多个文件上执行：

```
perl -i.bak -pe 's/.*(keyword1)/$1/; s/(keyword2).*/$1/;' original.txt original2.txt 
```

这将进行就地编辑，将原始文件重命名为具有 .bak 扩展名，使用带有 print 的隐式 while 循环，并在每次打印之前执行搜索和替换模式。

为了安全起见，请先在没有 -i 选项的情况下验证它，或者至少只在一个文件上验证它......

# .net - 数据网格视图、绑定列表 , DataGridViewComboBoxColumn

> ID：362506
> 
> 赞同：2
> 
> 时间：2008-12-12T11:29:03.697
> 
> 标签：.net, winforms, datagridview, castle-activerecord

所以，我有一个使用 BindingList 作为数据源的 DataGridView

```
DataGridView.DataSource = new  BindingList<Car>{...} 
```

在哪里

```
public class Car
{
    public ColorName Color { get; set;}
} 
```

和

```
public class ColorName
{
    public int Id {get; set;}
    public string Name{get; set;}
} 
```

我使用一个组合框列：

```
DataGridViewComboBoxColumn colorNameDataGridViewTextBoxColumn;
colorNameDataGridViewTextBoxColumn.DataPropertyName = "Color";
colorNameDataGridViewTextBoxColumn.HeaderText = "Color";
colorNameDataGridViewTextBoxColumn.Name = "Color";
colorNameDataGridViewTextBoxColumn.DisplayMember = "Name";
colorNameDataGridViewTextBoxColumn.ValueMember = "Id";
colorNameDataGridViewTextBoxColumn.DataSource = new ColorName[] {...}; 
```

我怎样才能让它工作？现在我得到一个例外，因为我认为它试图将 Id 转换为 ColorName。

我尝试使用空的 ValueMember 或将直接转换运算符添加到 ColorName 类，但无法使其正常工作。

当然，我可以在 Car 类中使用 int 来表示颜色，但效果不是很好。

正如您可能猜到的那样，这些类实际上是 Castle Project ActiveRecord-s。

欢迎任何想法！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T11:36:43.463

您是否尝试过 ValueMember = "" 或 ValueMember = "."？

真的很hacky，但是您可以在其上添加一个属性`ColorName`吗？（也许通过部分类）

```
public ColorName Self {get {return this;}} 
```

然后设置`ValueMember = "Self";'

除此之外，你可能需要一个`TypeConverter`

另一个选项可能是覆盖`ToString()`返回`ColorName`，`Name`并且没有值/显示成员？

* * *

（更新：不，它没有）

~~已检查，`ToString()`似乎工作：~~

 ~~```
public override string ToString() { return Name; } 
```~~ 

~~只是不要设置 a`DisplayMember` *或*a `ValueMember`。~~

* * *

好吧，你知道什么 - “自我”技巧也有效......

```
using System;
using System.ComponentModel;
using System.Windows.Forms;
class ColorName
{
    public ColorName(int id, string name) {
        this.Id = id;
        this.Name = name;
    }
    public int Id { get; private set; }
    public string Name { get; private set; }

    // maybe declare this one in a partial class...
    public ColorName Self { get { return this; } }
}
class Car
{
    public ColorName Color { get; set; }
}

static class Program
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        using(Form form = new Form())
        using (DataGridView grid = new DataGridView())
        {
            grid.Dock = DockStyle.Fill;
            grid.AutoGenerateColumns = false;
            ColorName[] colors = new[] {
              new ColorName(1,"Red"),
              new ColorName(2,"Blue"),
              new ColorName(3,"Green")
            };
            var col = new DataGridViewComboBoxColumn
            {
                DataPropertyName = "Color",
                HeaderText = "Color",
                Name = "Color",
                DisplayMember = "Name",
                ValueMember = "Self",
                DataSource = colors
            };

            grid.Columns.Add(col);
            grid.DataSource = new BindingList<Car> {
                new Car { Color = colors[0]}
            };
            form.Controls.Add(grid);
            Application.Run(form);
        }
    }
} 
```

# c# - 如何在 ASP.NET MVC 视图中返回当前操作？

> ID：362514
> 
> 赞同：294
> 
> 时间：2008-12-12T11:33:34.607
> 
> 标签：c#, asp.net-mvc

我想在我的母版页中设置一个 CSS 类，这取决于当前的控制器和操作。我可以通过 访问当前控制器`ViewContext.Controller.GetType().Name`，但如何获取当前操作（例如`Index`，`Show`等）？

* * *

## 回答 #1

> 赞同：473
> 
> 时间：2009-02-09T11:42:13.693

在 RC 中，您还可以像这样提取动作方法名称之类的路由数据

```
ViewContext.Controller.ValueProvider["action"].RawValue
ViewContext.Controller.ValueProvider["controller"].RawValue
ViewContext.Controller.ValueProvider["id"].RawValue 
```

* * *

### MVC 3 的更新

```
ViewContext.Controller.ValueProvider.GetValue("action").RawValue
ViewContext.Controller.ValueProvider.GetValue("controller").RawValue
ViewContext.Controller.ValueProvider.GetValue("id").RawValue 
```

### MVC 4 的更新

```
ViewContext.Controller.RouteData.Values["action"]
ViewContext.Controller.RouteData.Values["controller"]
ViewContext.Controller.RouteData.Values["id"] 
```

### MVC 4.5 更新

```
ViewContext.RouteData.Values["action"]
ViewContext.RouteData.Values["controller"]
ViewContext.RouteData.Values["id"] 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2008-12-12T11:49:16.563

使用`ViewContext`和 查看`RouteData`集合以提取控制器和操作元素。但我认为设置一些指示应用程序上下文的数据变量（例如，“editmode”或“error”）而不是控制器/动作会减少视图和控制器之间的耦合。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2008-12-12T13:20:42.573

要获取视图上的当前 ID：

```
ViewContext.RouteData.Values["id"].ToString() 
```

获取当前控制器：

```
ViewContext.RouteData.Values["controller"].ToString() 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2009-09-11T04:07:02.963

我知道这是一个较老的问题，但是我看到了它，并且我认为您可能对替代版本感兴趣，而不是让您的视图处理检索完成工作所需的数据。

我认为更简单的方法是覆盖[OnActionExecuting](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuting.aspx)方法。向您传递了包含[ActionDescriptor成员的](http://msdn.microsoft.com/en-us/library/system.web.mvc.actiondescriptor.aspx)[ActionExecutingContext](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionexecutingcontext.aspx) ，您可以使用它来获取您正在查找的信息，即 ActionName，您还可以访问 ControllerDescriptor，它包含 ControllerName。

```
protected override void OnActionExecuting(ActionExecutingContext filterContext)
{
    ActionDescriptor actionDescriptor = filterContext.ActionDescriptor;
    string actionName = actionDescriptor.ActionName;
    string controllerName = actionDescriptor.ControllerDescriptor.ControllerName;
    // Now that you have the values, set them somewhere and pass them down with your ViewModel
    // This will keep your view cleaner and the controller will take care of everything that the view needs to do it's job.
} 
```

希望这可以帮助。如果有的话，至少它会为您的问题提出的其他任何人提供替代方案。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2010-12-14T08:03:31.267

我看到了不同的答案并想出了一个类助手：

```
using System;
using System.Web.Mvc;

namespace MyMvcApp.Helpers {
    public class LocationHelper {
        public static bool IsCurrentControllerAndAction(string controllerName, string actionName, ViewContext viewContext) {
            bool result = false;
            string normalizedControllerName = controllerName.EndsWith("Controller") ? controllerName : String.Format("{0}Controller", controllerName);

            if(viewContext == null) return false;
            if(String.IsNullOrEmpty(actionName)) return false;

            if (viewContext.Controller.GetType().Name.Equals(normalizedControllerName, StringComparison.InvariantCultureIgnoreCase) &&
                viewContext.Controller.ValueProvider.GetValue("action").AttemptedValue.Equals(actionName, StringComparison.InvariantCultureIgnoreCase)) {
                result = true;
            }

            return result;
        }
    }
} 
```

因此，在 View（或 master/layout）中，您可以像这样使用它（Razor 语法）：

```
 <div id="menucontainer">

                <ul id="menu">
                    <li @if(MyMvcApp.Helpers.LocationHelper.IsCurrentControllerAndAction("home", "index", ViewContext)) {
                            @:class="selected"
                        }>@Html.ActionLink("Home", "Index", "Home")</li>
                    <li @if(MyMvcApp.Helpers.LocationHelper.IsCurrentControllerAndAction("account","logon", ViewContext)) {
                            @:class="selected"
                        }>@Html.ActionLink("Logon", "Logon", "Account")</li>
                    <li @if(MyMvcApp.Helpers.LocationHelper.IsCurrentControllerAndAction("home","about", ViewContext)) {
                            @:class="selected"
                        }>@Html.ActionLink("About", "About", "Home")</li>
                </ul>

            </div> 
```

希望能帮助到你。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2011-01-14T22:48:05.937

您可以从 ViewContext 的 RouteData 中获取这些数据

```
ViewContext.RouteData.Values["controller"]
ViewContext.RouteData.Values["action"] 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-12-12T11:47:02.247

在 MVC 中，您应该为视图提供所有数据，而不是让视图收集自己的数据，因此您可以做的是在控制器操作中设置 CSS 类。

```
ViewData["CssClass"] = "bold"; 
```

并从 View 中的 ViewData 中挑选出这个值

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-09-20T18:21:24.413

我投票给这2：

```
string currentActionName = ViewContext.RouteData.GetRequiredString("action"); 
```

和

```
string currentViewName = ((WebFormView)ViewContext.View).ViewPath; 
```

您可以检索当前视图的物理名称和触发它的操作。它可以在部分 *.acmx 页面中用于确定主机容器。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-11-28T17:12:31.733

我正在使用 ASP.NET MVC 4，这对我有用：

```
ControllerContext.Controller.ValueProvider.GetValue("controller").RawValue
ControllerContext.Controller.ValueProvider.GetValue("action").RawValue 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-12-07T21:23:02.873

扩展[Dale Ragan 的答案](https://stackoverflow.com/questions/362514/asp-net-mvc-current-action/1408919#1408919)，他的重用示例，创建一个派生自 Controller 的 ApplicationController 类，然后让所有其他控制器派生自该 ApplicationController 类而不是 Controller。

例子：

```
public class MyCustomApplicationController : Controller {}

public class HomeController : MyCustomApplicationController {} 
```

在您的新 ApplicationController 上使用此签名创建一个名为 ExecutingAction 的属性：

```
protected ActionDescriptor ExecutingAction { get; set; } 
```

然后在 OnActionExecuting 方法中（来自 Dale Ragan 的回答），只需将 ActionDescriptor 分配给此属性，您就可以在任何控制器中随时访问它。

```
string currentActionName = this.ExecutingAction.ActionName; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-06-14T07:02:02.693

在你的控制器中覆盖这个函数

```
protected override void HandleUnknownAction(string actionName) 
{  TempData["actionName"] = actionName;
   View("urViewName").ExecuteResult(this.ControllerContext);
} 
```

# xml - 如何忽略 JAXB 中的意外元素情况？

> ID：362516
> 
> 赞同：11
> 
> 时间：2008-12-12T11:33:55.840
> 
> 标签：xml, jaxb

如何忽略 JAXB ans 中的意外元素情况仍然会得到所有其他类型的 javax.xml.bind.UnmarshalException？

```
obj = unmler.unmarshal(new StringReader(xml)) 
```

请注意，我仍然想获得 xml 解析的 obj 结果。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-12T11:45:41.017

解决方案。

在像这样实现 ValidationEventHandler 的 JAXB 中：

```
class CustomValidationEventHandler implements ValidationEventHandler{

    public boolean handleEvent(ValidationEvent evt) {
        System.out.println("Event Info: "+evt);
        if(evt.getMessage().contains("Unexpected element"))
            return true;
        return false;
    }

} 
```

然后

```
Unmarshaller u = ...;

u.setEventHandler(new CustomValidationEventHandler());

u.unmarshal(new StringReader(xml)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-28T16:44:12.100

此外，JAXB 2.0 会自动忽略无法识别的元素并继续解组过程。请参阅[https://jaxb.java.net/nonav/jaxb20-fcs/docs/api/javax/xml/bind/Unmarshaller.html](https://jaxb.java.net/nonav/jaxb20-fcs/docs/api/javax/xml/bind/Unmarshaller.html)并跳转到“验证和格式良好”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-24T10:13:42.833

使用`JAXB.unmarshal()`默认忽略意外元素。小心，因为它也会跳过模式验证。

JavaDoc： [https ://docs.oracle.com/javase/8/docs/api/javax/xml/bind/JAXB.html](https://docs.oracle.com/javase/8/docs/api/javax/xml/bind/JAXB.html)

# python - Switching from python-mode.el to python.el

> ID：362522
> 
> 赞同：30
> 
> 时间：2008-12-12T11:37:05.257
> 
> 标签：python, emacs, editing

I recently tried switching from using `python-mode.el` to `python.el` for editing python files in emacs, found the experience a little alien and unproductive, and scurried back. I've been using `python-mode.el` for something like ten years, so perhaps I'm a little set in my ways. I'd be interested in hearing from anyone who's carefully evaluated the two modes, in particular of the pros and cons they perceive of each and how their work generally interacts with the features specific to `python.el`.

The two major issues for me with `python.el` were

1.  Each buffer visiting a python file gets its own inferior interactive python shell. I am used to doing development in one interactive shell and sharing data between python files. (Might seem like bad practice from a software-engineering perspective, but I'm usually working with huge datasets which take a while to load into memory.)

2.  The skeleton-mode support in python.el, which seemed absolutely gratuitous (python's syntax makes such automation unnecessary) and badly designed (for instance, it has no knowledge of "`for`" loop generator expressions or "`<expr 1> if <cond> else <expr 2>`" expressions, so you have to go back and remove the colons it helpfully inserts after insisting that you enter the expression clauses in the minibuffer.) I couldn't figure out how to turn it off. There was a `python.el` variable which claimed to control this, but it didn't seem to work. It could be that the version of `python.el` I was using was broken (it came from the debian emacs-snapshot package) so if anyone knows of an up-to-date version of it, I'd like to hear about it. (I had the same problem with the version in CVS emacs as of approximately two weeks ago.)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T15:34:00.567

对于它的价值，我没有看到您在问题 #1 中看到的行为，“每个访问 python 文件的缓冲区都有自己的劣质交互式 python shell。”

这就是我使用 Emacs 22.2 中的 python.el 所做的。

Cx Cf foo.py [插入：打印“foo”]

Cx Cf bar.py [插入：打印“bar”]

Cc Cz [*Python* 缓冲区出现]

Cxo

Cc Cl RET ["bar" 在 *Python* 中打印]

Cx b foo.py RET

Cc Cl RET ["foo" 打印在同一个 *Python* 缓冲区中]

因此，这两个文件共享相同的劣质 python shell。也许在您对 python-mode 的个人定制和 python.el 的默认行为之间存在一些无法预料的交互。您是否尝试过在没有 .emacs 自定义的情况下使用 python.el 并检查其行为是否相同？

python.el 在 python-mode 上的主要特性是符号补全函数 python-complete-symbol。你可以添加这样的东西

```
(define-key inferior-python-mode-map "\C-c\t" 'python-complete-symbol) 
```

然后输入

```
>>> import os
>>> os.f[C-c TAB] 
```

你会得到一个 *Completions* 缓冲区，其中包含

```
Click <mouse-2> on a completion to select it.
In this buffer, type RET to select the completion near point.

Possible completions are:
os.fchdir                          os.fdatasync
os.fdopen                          os.fork
os.forkpty                         os.fpathconf
os.fstat                           os.fstatvfs
os.fsync                           os.ftruncate 
```

它也可以在 .py 文件缓冲区中工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-31T15:24:02.107

1.  我无法在 Emacs v23.1 上重现这种行为，从那以后肯定已经改变了。

2.  忘掉任何模式的骨架支持，改用超高级和可扩展的[yasnippet](http://code.google.com/p/yasnippet/)，真的值得一试！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T10:21:47.263

请注意，随着事情的变化，这里所说的几乎所有内容都已过时。

python-mode.el 命令基本上都以“py-”为前缀，您应该能够同时使用这两个命令，而不管先加载哪个命令。

python-mode.el 不卸载 python.el；在重新定义的 python-mode-map 旁边。

差异在显示的菜单和按键设置中，但是，最后加载的将决定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T07:08:48.227

python-mode.el 不支持三引号字符串，因此如果您的程序包含长文档字符串，所有语法着色（和相关的语法特征）往往会崩溃。

我的 .02

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T12:20:43.240

python-mode.el is written by the Python community. python.el is written by the emacs community. I've used python-mode.el for as long as I can remember and python.el doesn't even come close to the standards of python-mode.el. I trust the Python community better than the Emacs community to come up with a decent mode file. Just stick with python-mode.el, is there really a reason not to?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-03-03T20:53:26.747

Debian 已经删除了 python-mode 包，唉，所以我不得不尝试 python.el。我加载它并运行“describe-bindings”。它似乎是为那些认为`c-X ;`是注释一行 Python 代码的直观绑定的 elisp 编码人员而设计的。（哇。）此外，我根本没有办法评论代码区域，或者更确切地说，没有与其中的字符串“region”和“comment”绑定。

好的旧 python 模式仍然可以通过`git clone https://gitlab.com/python-mode-devs/python-mode.git`. 它是在一周前在撰写本文时最后一次编辑的，因此可以肯定地假设它没有被放弃。

# tdd - 如何基于接口创建mock对象并设置只读属性？

> ID：362541
> 
> 赞同：0
> 
> 时间：2008-12-12T11:49:38.200
> 
> 标签：tdd, rhino-mocks

我是 TDD 的新手。所以任何帮助将不胜感激。我正在使用 NUnit 和 Rhino 模拟。如何在我的模拟对象中将 ID 值设置为 1？

我看了一下：[http](http://www.iamnotmyself.com/2008/06/26/RhinoMocksAndReadOnlyPropertyInjectionPart2.aspx) ://www.iamnotmyself.com/2008/06/26/RhinoMocksAndReadOnlyPropertyInjectionPart2.aspx 但反射似乎对接口不起作用。

```
 public interface IBatchInfo
    {
        int ID { get;}
        Branches Branch { get; set; }
        string Description { get; set; }                                
    }

 [SetUp]
       public void PerFixtureSetup()
       {

           _mocks = new MockRepository();
           _testRepository = _mocks.StrictMock<IOLERepository>();

       }

    [Test]
            public void ItemsAreReturned()
            {
                IBatchInfo aBatchItem=  _mocks.Stub<IBatchInfo>();

                aBatchItem.ID = 1; //fails because ID is a readonly property
                aBatchItem.Branch = Branches.Edinburgh;

                List<IBatchInfo> list = new List<IBatchInfo>();

                list.Add( aBatchItem);

                Expect.Call(_testRepository.BatchListActive()).Return(list);
                _mocks.ReplayAll();

                BatchList bf = new BatchList(_testRepository, "usercreated", (IDBUpdateNotifier)DBUpdateNotifier.Instance);
                List<Batch> listofBatch = bf.Items;

                Assert.AreEqual(1, listofBatch.Count);
                Assert.AreEqual(1, listofBatch[0].ID);
                Assert.AreEqual( Branches.Edinburgh,listofBatch[0].Branch);
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T12:08:04.077

在这里找到答案[http://haacked.com/archive/2007/05/04/setting-propertybehavior-on-all-properties-with-rhino-mocks.aspx](http://haacked.com/archive/2007/05/04/setting-propertybehavior-on-all-properties-with-rhino-mocks.aspx)。

简单，而不是

```
aBatchItem.ID=1; 
```

采用：

```
SetupResult.For(aBatchItem.ID).Return(1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T13:18:08.687

如果使用 rhino mocks 3.5 会更好：

```
aBatch.Stub(x => x.ID).Return(0); 
```

# scaling - Scaling exercises to practice

> ID：362544
> 
> 赞同：1
> 
> 时间：2008-12-12T11:51:56.527
> 
> 标签：scaling

I was trying to find online some exercises to practice scaling techniques (memchached, SQL Optimization, sharding dbs), but I could only find descriptions of these techniques, not any project on which to try them.

This link with [slides on scaling techniques](http://www.slideshare.net/Georgio_1999/how-to-scale-your-web-app), is an interesting one, as it sums up some tools to achieve scalability quite well.

Is there a projecteuler kind of site for these kind of activities? Or at least some excercises (such as a downloadable ASP.NET/PHP site with obvious slowdowns, concurrency issues, subtle bugs) for people to try and learn how to fight this issue?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T13:43:17.283

我发现网站[High Scalability](http://highscalability.com/)有一些很好的见解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T02:22:06.483

破解 Wordpress 可能会很有趣。他们的缓存插件解决了很多扩展问题，但是编写自己的插件或在源代码上修改以减少 SQL 查询或缓存静态页面会很酷。如果您有什么想法，请务必让社区的其他人知道！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T13:39:24.857

George 的幻灯片绝对是一个很好的工作基础。请注意，他不是在谈论特定的技术或技术；相反，他正在讨论更通用的架构和设计决策，这将有助于您的应用程序整体扩展。

我个人认为这种高层次的思考会比单独的优化技术更有价值。也许您可以使用一个众所周知的 Web 应用程序并对其进行破解，直到它可以在多台机器上很好地扩展？大量廉价、[低功耗 EC2 机器](http://aws.amazon.com/ec2/instance-types/)的集群在这里可能非常有用。让现有的或新的应用程序在多台机器上正常运行将是一个很棒的练习。

与直觉相反，与其尽可能多地在一台机器上运行，我会说让同一个应用程序在多台机器上运行更具教育意义。

一旦有了这些，就可以进行更具体的改进，例如单独的静态内容层`memcached`、数据库分片、批处理操作等。

[就具体项目而言，克隆Twitter](http://twitter.com/)、[Flickr](http://www.flickr.com/)或[The Pirate Bay](http://thepiratebay.org/)怎么样。他们过去都面临过性能和扩展挑战。

# asp.net - asp.net 最佳实践字符串连接

> ID：362548
> 
> 赞同：1
> 
> 时间：2008-12-12T11:55:33.070
> 
> 标签：asp.net, optimization

我正在尝试找到生成和输出 html 的最佳实践，这需要首先进行数据库查询才能获取信息。目前在 aspx 页面中，我有一个带有 runat 服务器的 div：

```
<div runat="server" id="leaflet"></div> 
```

现在，作为开始做一些测试的开始，我有一个在 page_load 上运行的方法，它基本上可以：

```
private void BuildLeaflet(string qnid)
    {
    //gets leaflet details
    QueryLeafletDetails();
    //return concatenated content string
    leaflet.InnerHtml "<h1>" + dr["LSC Descriptor"] + "</h1>";
    } 
```

在真正的解决方案中，返回是大约 10 个字段的串联，其中一些字段非常长，只要它们是内容即可。

我绝不认为这是最好的解决方案，但什么是？一个字符串生成器？我可以将每个部分依次写入站点，避免方法中的连接吗？服务器 div 是否最好？

编辑：忘记在我的一些内容部分中已经包含简单（有限）的 html，例如段落、列表……这使我可以轻松地生成用于 Web 和打印的文档，我只使用不同的样式表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T12:00:53.047

我会用`<asp:Literal runat="server" enableViewState="false" id="leaflet" />`. 这不会在页面上生成任何标签，也不会填充 ViewState 中的所有文本。

是的，如果您需要连接许多长字符串，请使用 StringBuilder。这将提高内存效率。

另一种解决方案是查看您是否可以在页面上制作一些固定标记并将每个 DB 字段的内容放在它自己的控件中（`<asp:Literal />`？）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T12:00:26.667

如果字段的数量是固定的（并且相对较小），我将使用 string.Format，否则使用 StringBuilder。代码的可读性将是我的指南，而不是性能。如果您打算重用它，您可能还想考虑将其抽象为 UserControl。然后你可以给它可设置的属性并将渲染逻辑构建到控件中以避免重复自己。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T12:06:33.160

许多人对此进行了基准测试 - iirc 格式适用于 <4 项，简单连接适用于 <7，高于此的字符串构建。

我强烈建议不要将 HTML 创建为字符串 btw。

# c# - what is the easiest way to retain values of fields while switching from page to page

> ID：362549
> 
> 赞同：2
> 
> 时间：2008-12-12T11:55:33.383
> 
> 标签：c#, asp.net

I am using Multiview. And I am switching between views. Each view contains lots of fields. I am going to another view from the current view to add some data. And after adding data from the new view, I am returning to the previous view. Now on this view I want to populate fields which I have entered before switching. Currently I am using ViewState to retain previous values. But this costs lot as there are lots of fields on a single view. Is there any other way to do this task?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T12:34:37.097

这与 viewstate 的设计目标相差不远——我会坚持下去。

其他不太受欢迎的替代方案包括会话、数据库表和 httpcontext。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T12:18:27.440

You can store those values in a temporary table otherwise i dont think there is any problem with Viewstate.. better make a structure, store your values in that structure and store the structure in one viewstates...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T14:09:02.507

另一种可能性是使用 Server.Transfer("url", true) ，它允许您将前一个表单与表单中包含的数据一起传递到下一页。

查看[http://www.developer.com/net/asp/article.php/3299641](http://www.developer.com/net/asp/article.php/3299641)以获取使用示例。

# vb.net - vb.net中的SubString函数抛出异常

> ID：362555
> 
> 赞同：1
> 
> 时间：2008-12-12T11:58:19.633
> 
> 标签：vb.net, string

`FromIp`包含`"192.168.1.1"`. 我想得到最后一个数字，但我不知道这里出了什么问题：

```
 Dim str As String
    str = FromIP.Text.Substring(FromIP.Text.LastIndexOf("."), FromIP.Text.Length).ToString()
    MessageBox.Show(FromIP.Text.Length) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T12:07:05.123

Eduardo 给出了获取子字符串的正确方法——我在这里的回答将解释为什么现有的会失败。

[`String.Substring(int, int)`](http://msdn.microsoft.com/en-us/library/aka44szs.aspx)需要一个起始位置和一个*计数*。您基本上是在说，“从位置 9 开始 10 个字符”。文档明确指出它将抛出：

> ArgumentOutOfRangeException [如果]
> 
> startIndex 加上长度表示不在此实例中的位置。
> 
> -或者-
> 
> startIndex 或长度小于零。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T12:04:16.627

测试代码：

```
 Dim FromIp As String = "192.168.1.1"
    Dim str As String
    str = FromIp.Substring(FromIp.LastIndexOf(".") + 1).ToString()
    MessageBox.Show(str) 
```

*   您必须将 1 添加到 LastIndexOf 以跳过点
*   当您想要字符串的所有其余部分时，无需放置子字符串的长度

但是这个重构的代码会更好地工作：

```
 Dim FromIp As String = "192.168.1.1"
    Dim IpPart As String() = FromIp.Split(".")
    MessageBox.Show(IpPart(3)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T12:07:00.583

```
FromIP.Text.LastIndexOf(".") + 1 
```

代替

```
FromIP.Text.LastIndexOf(".") 
```

和

```
FromIP.TextLength-FromIP.Text.LastIndexOf(".") 
```

是最后一个参数而不是

```
FromIP.TextLength 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T12:05:52.333

据我记得， Substring 以 Start,Stop 作为参数。

所以那将是：`txt.Substring(IndexOf, txt.Length - IndexOf)`或者只有一个参数： Substring(IndexOf + 1)

# oracle - oracle左外连接不显示右空值

> ID：362556
> 
> 赞同：15
> 
> 时间：2008-12-12T11:58:57.590
> 
> 标签：oracle, join

我在 oracle 中创建一个似乎不想加入缺失值的查询时遇到问题

我的桌子是这样的：

```
table myTable(refnum, contid, type)

values are:
1, 10, 90000
2, 20, 90000
3, 30, 90000
4, 20, 10000
5, 30, 10000
6, 10, 20000
7, 20, 20000
8, 30, 20000 
```

我所追求的领域的细分是这样的：

```
select a.refnum from myTable a where type = 90000
select b.refnum from myTable b where type = 10000 and contid in (select contid from myTable where type = 90000)
select c.refnum from myTable c where type = 20000 and contid in (select contid from myTable where type = 90000) 
```

我要查询的结果是这样的：

```
a.refnum, b.refnum, c.refnum 
```

我认为这会起作用：

```
select a.refnum, b.refnum, c.refnum
from myTable a 
left outer join myTable b on (a.contid = b.contid) 
left outer join myTable c on (a.contid = c.contid) 
where a.id_tp_cd = 90000
and b.id_tp_cd = 10000
and c.id_tp_cd = 20000 
```

所以值应该是：

```
1, null, 6
2, 4, 7
3, 5, 8 
```

但它唯一的回报：

```
2, 4, 7
3, 5, 8 
```

我认为左连接会显示左侧的所有值并为右侧创建一个空值。

帮助 ：（

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-12T12:06:50.130

您说的是正确的，左连接将在没有匹配的地方返回空值，但是当您将此限制添加到 where 子句时，您不允许返回这些空值：

```
and b.id_tp_cd = 10000
and c.id_tp_cd = 20000 
```

您应该能够将这些放在连接的“on”子句中，因此只返回右侧的相关行。

```
select a.refnum, b.refnum, c.refnum
from myTable a 
left outer join myTable b on (a.contid = b.contid and b.id_tp_cd = 10000) 
left outer join myTable c on (a.contid = c.contid and c.id_tp_cd = 20000) 
where a.id_tp_cd = 90000 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-15T02:32:29.120

或者使用 Oracle 语法而不是 ansi

```
select a.refnum, b.refnum, c.refnum
from myTable a, mytable b, mytable c
where a.contid=b.contid(+)
and a.contid=c.contid(+)
and a.type = 90000
and b.type(+) = 10000
and c.type(+) = 20000;

REFNUM     REFNUM     REFNUM
---------- ---------- ----------
     1                     6
     2          4          7
     3          5          8 
```

# winapi - 如何检测应用程序所需的 DLL？

> ID：362560
> 
> 赞同：9
> 
> 时间：2008-12-12T12:03:36.613
> 
> 标签：winapi, dll

简而言之：我想做与“Dependency Walker”相同的事情。

是否有任何 Win32 API 函数可以枚举 EXE 和/或 DLL 文件的依赖关系？

是否有任何安全的方法来检测 ActiveX 类的依赖关系？（我怀疑这是可能的，但谁知道......）

**编辑：**我知道提供相同核心功能的可用工具（Dependency Walker、ProcessExplorer、AQTime，...），但我想创建自己的程序来转储包含所需模块的文本文件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T12:54:11.940

以下命令转储 some.exe 的直接依赖项：

```
dumpbin /imports some.exe 
```

它也适用于 DLL。

这不会列出依赖项，例如在应用程序启动时加载的插件（通过 LoadLibrary 调用）。COM 依赖项也一样，因为它们的工作方式相同（据我所知）。

如果您需要了解正在运行的程序使用的所有 DLL，请使用 ProcessExplorer。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-23T00:37:46.263

findstr -i .dll exe.exe | 更多 | findstr -i .dll | 更多的

雷姆:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T12:15:36.540

运行应用程序，[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)已经运行并设置为过滤您的应用程序 .exe 名称。

如果不运行它，就无法检测可执行文件所具有的所有 COM 依赖项。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T12:36:43.800

似乎 Dependency Walker 源代码本身是由 Microsoft 通过 MSJ 提供的。请看*[Re: [DUG]: Dependency Walker](http://www.mail-archive.com/delphi@delphi.org.nz/msg11397.html)*。

由于此邮件跟踪中给出的链接无效，您需要参考其他站点进行下载。

请检查*[MSJ 源代码更新](http://www.microsoft.com/msj/codeupdates.aspx)*：由于我没有时间，我没有检查它是否包含源代码或只有 EXE foæes。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T13:33:01.393

用户 @blue... 避开了[Dependency Walker](http://www.dependencywalker.com/)。使用 Dependency Walker 时，打开文件后，您可以看到使用的基本要求。只有在执行程序并执行其所有功能时，才能找到所有动态加载的 DLL。

有时，如果可以的话，最好的办法是询问开发人员需要哪些 DLL。应用程序可能仅在绝对需要时才加载一些 DLL。例如加载faultrep.dll，用于自定义Windows 错误报告，当它即将崩溃时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T21:40:48.617

您可能需要遍历可执行文件的文件结构才能以编程方式解决此问题。因此，类似于此处提到的“PE Dump”程序：[http://msdn.microsoft.com/en-gb/magazine/cc301808.aspx](http://msdn.microsoft.com/en-gb/magazine/cc301808.aspx)将是一个很好的起点。您需要的实际代码可以在这里找到：[http://www.wheaty.net/downloads.htm](http://www.wheaty.net/downloads.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-07T03:00:03.750

您可以编写一个控制台应用程序来包装它，使用它创建一个 PowerShell 脚本，或者就像我通常最终会做的那样，因为我只需要在一个蓝月亮中执行一次，将以下内容添加到您的代码中以进行快速检查：

```
 private static HashSet<string> ReferencedAssemblies = new HashSet<string>();

    ...
    OutputDependencies(Assembly.GetAssembly(typeof(Program)), 0);
    ...

    static void OutputDependencies(Assembly assembly, int indent)
    {
        if (assembly == null) return;

        Console.WriteLine(new String(' ', indent * 4) + assembly.FullName);
        if (!ReferencedAssemblies.Contains(assembly.FullName))
        {
            ReferencedAssemblies.Add(assembly.FullName);

            foreach (var childAssembly in assembly.GetReferencedAssemblies())
            {
                OutputDependencies(Assembly.Load(childAssembly.FullName), indent + 1);
            }
        }
    } 
```

# c++ - Carbide / Symbian C++ - 更改应用程序图标

> ID：362570
> 
> 赞同：4
> 
> 时间：2008-12-12T12:06:51.037
> 
> 标签：c++, symbian, icons, s60, carbide

我正在使用 Carbide（刚刚升级到 2.0）来开发 S60 3rd Edition 应用程序。

我想知道更改图标的最简单方法（设备菜单上的应用程序图标**和**主视图左上角的图标），因为我需要尽可能轻松地以多种不同方式对我的应用程序进行皮肤.

到目前为止，我所有弄乱 .mif 文件的努力都失败了。我有一个用 Illustrator 制作的 44x44 .svg 图标，有人可以帮助我朝正确的方向前进吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T11:36:24.883

要在运行应用程序时更改应用程序图标（在状态栏中）：

```
CEikStatusPane* sp=iEikonEnv->AppUiFactory()->StatusPane();
CAknContextPane* cp=(CAknContextPane *)sp->ControlL(TUid::Uid(EEikStatusPaneUidContext));
_LIT(KContextBitMapFile, "my_bitmap_file.mbm");
CFbsBitmap* bitmap = iEikonEnv->CreateBitmapL(KContextBitMapFile, EMbmBitmap);
CleanupStack::PushL(bitmap);
CFbsBitmap*  bitmapmask = iEikonEnv->CreateBitmapL(KContextBitMapFile, EMbmBitmapMask);
CleanupStack::PushL(bitmapmask);
cp->SetPicture(bitmap, bitmapmask);
CleanupStack::Pop(); // bitmapmask
CleanupStack::Pop(); // bitmap
DrawNow(); 
```

除了使用不同的 mif 文件重新安装应用程序之外，我不知道以编程方式更改菜单列表中的应用程序图标的任何可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T11:25:26.577

如果您想更改 SIS 文件中的图标，然后在设备上重新安装它，那么您可能需要在安装后重新启动设备 - 应用程序图标在 Symbian 缓存中并且没有更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-22T11:45:43.483

[http://wiki.forum.nokia.com/index.php/CS000808_-_Creating_and_adding_an_icon_to_an_S60_3rd_Edition_application](http://wiki.forum.nokia.com/index.php/CS000808_-_Creating_and_adding_an_icon_to_an_S60_3rd_Edition_application)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-31T04:43:31.897

使用最新的 QMake 和 Qt SDK (4.6.2)，您无需自己创建任何 .mif 文件。一个 SVG 文件就可以了。

有关更详细的说明，请参阅：[如何在 Symbian S60 中设置 Qt 应用程序图标和标题](http://qt-mobility.blogspot.com/2010/03/how-to-set-qt-application-icon-and.html "如何在 Symbian S60 中设置 Qt 应用程序图标和标题")。

文章虽然使用了Qt Creator，但只要你使用QMake那就是一回事了。

# java - 期望 Java Portal Server 托管“标准”Java WebApp 是否有效？

> ID：362575
> 
> 赞同：0
> 
> 时间：2008-12-12T12:08:06.027
> 
> 标签：java, web-applications, portal, jboss-portal

有人建议这可能是一种合理的方法，以便最大限度地减少对现有服务器配置的更改，但它实际上是否有效/受支持？无论哪种方式，我都找不到任何具体的东西。

在实践中，对于 JBoss Portal V2.4.2 服务器，似乎存在一些类加载问题，因此诸如可下载的 Stripes 示例或标准 Wicket 快速启动应用程序之类的东西无法运行，但我不确定问题是否存在有一个服务器特定的或通用的 - 任何人？

注意：这不是关于将现有的 Web 应用程序显示/移动到门户中，只要 Portal Server 也应该是有效的 AppServer？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T15:22:36.180

[JSR 286（Portlet 2.0）规范](http://jcp.org/en/jsr/detail?id=286)：

> PLT.2.7
> 
> 与 Java 2 Platform、Standard 和 Enterprise Edition 的关系
> 
> Portlet API v2.0 基于 Java Platform，Standard Edition 5.0 和 Enterprise Edition v1.4。Portlet 容器至少应满足 J2EE 规范 v 1.4 中描述的在 J2EE 环境中执行的要求。

因此，期望标准应用服务器应用程序在门户下工作并非不合理。

但是，根据定义，门户将在全局类空间中包含更多库。将库添加到容器总是会带来不兼容的风险，并且需要管理哪些类/资源暴露给您的应用程序以及如何（应用程序优先类加载等）。我过去曾遇到过第三方库的问题，这些库的依赖项与门户附带的版本冲突。我不希望依赖管理变得更容易。

正如他们所说，一次编写，到处测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T12:15:03.593

我认为问题在于是否可以将标准 Web 应用程序呈现为来自 Portlet 容器的 Portlet。这是不可能的。Portlet 需要基于 GenericPortlet 类并具有特殊的部署描述符。有 JSR-168 标准，它指定了门户的要求。JSR-286 规范即将发布。

您唯一能做的就是创建一个通过 iframe 为现有应用程序提供服务的 portlet，但这当然很难看。

有一本名为“ [Portlets and Apache Portals](http://www.manning.com/hepper/) ”的关于 portlet 的免费书籍，它可能很有用。另请参阅规范。这个[博客点](http://portlets.blogspot.com/)很有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T12:21:26.700

根据我的经验，这是一个有效的建议。Portlet 应用程序通常也是 Web 应用程序（例如，它们可能包含一个 servlet，以允许也通过要在其中一个 portlet 中呈现的链接访问应用程序逻辑），因此它们包含 portlet.xml 和 web.xml，并且需要 j2ee 类和 jsr168类。WSRP 标准还包含资源链接类型，应该代表远程服务器的普通应用服务器。

Websphere 门户服务器也是一个应用服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T13:45:26.017

我使用 JBoss Portal、BEA WebLogic Portal 和 Apache Jetspeed 2 在单个 Web 应用程序中混合了 servlet 和 portlet。

但是，将 servlet 转换为 portlet 可能很困难。确实存在使用诸如[Portals Bridges](http://portals.apache.org/bridges/)之类的桥接技术，但我很幸运能够避免进行这种转换，并且除了玩教程之外没有直接经验。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T15:33:09.950

> 嗯...但它可以/排他地/包含 servlet，或者换句话说，应用程序是否需要至少 1 个 portlet？（我没有/想要提供一个 portlet，只是一个 servlet，但我只有一个 Portal Server！）

即使应用程序包含一个 portlet，也没有什么说您需要在某个页面上公开该 portlet。如果您编写这样的应用程序，只需编写任意数量的 servlet，直接链接到它们，不要在任何页面的任何地方放置任何虚拟/默认 portlet。

我编写了一个符合 JSR-168 的应用程序，其中包含一个空 portlet 和一个用于检索一些 XML 股票价格数据的 servlet。几个月以来，所有被调用的都是 servlet，portlet 在站点上的任何地方都不可见。后来我添加了一个 portlet，它从 XML 提要中提供了一些额外的数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-18T10:12:10.767

答案是肯定的，它是有效的，**但是**特定的 JBoss Portal V2.4.* 版本似乎存在类加载器问题，因此只有更基本的 Web 应用程序才能正确运行。

# sharepoint - 如果 Sharepoint 中的数据视图 Web 部件没有数据，如何显示默认文本？

> ID：362586
> 
> 赞同：1
> 
> 时间：2008-12-12T12:14:28.073
> 
> 标签：sharepoint, web-parts, dataview

我正在尝试使用 Sharepoint 中的数据视图 Web 部件。网络上有许多与填充数据相关的文章。我的问题是，如果数据源为空怎么办？有没有办法在这种情况下显示默认消息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T18:21:55.923

您可以在 XSL 样式表中执行此操作，当您将文本设置为在数据源为空时显示时，SharePoint Designer 会执行此操作。

```
 <xsl:variable name="dvt_IsEmpty" select="$dvt_RowCount = 0" />
    <xsl:choose>
        <xsl:when test="$dvt_IsEmpty">
            <xsl:call-template name="dvt_1.empty" />
        </xsl:when>
        <xsl:otherwise><!-- Do stuff if not empty --></xsl:otherwise>

<xsl:template name="dvt_1.empty"><!-- Default template from SPD -->
    <xsl:variable name="dvt_ViewEmptyText">There are no items to show in this view.</xsl:variable>
    <table border="0" width="100%">
        <tr>
            <td class="ms-vb">
                <xsl:value-of select="$dvt_ViewEmptyText" />
            </td>
        </tr>
    </table>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T08:06:09.700

转到 DataView 属性，在底部的常规选项卡下有一个字段，您可以在其中键入要显示的消息（如果显示了 n 数据）。

# c# - Set a disabled TextBox's ForeColor to be the same as its BackColor in C#

> ID：362603
> 
> 赞同：5
> 
> 时间：2008-12-12T12:24:43.823
> 
> 标签：c#, .net, user-interface

How do I set a disabled TextBox's current text color to be the same as its current background color in C#?

Simply doing txtLala.ForeColor = txtLala.BackColor does not seems to work.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T12:30:47.167

This works:

```
txtLala.Text = "Red";
txtLala.BackColor = System.Drawing.Color.Red;
txtLala.ForeColor = txtLala.BackColor;
txtLala.ReadOnly = true; 
```

Try setting the `color`, before the `readonly`. And also check how you are setting the color!

**EDIT**

Try this

```
txtLala.Attributes.Add("style","background-color:Red;color:Red"); 
```

If you are trying to make it invisible, you know you can set it as

```
txtLala.Visible = False; 
```

**EDIT II**

I finally tried

```
txtLala.Enabled = false; 
```

... you see that grey shadow color! I don't think you can mess with that, it looks to be a browser property setting.

Why not set as `ReadOnly` or `Visible = False`?

Maybe you have a good reason for `Enabled = false`

But you should note:

> Use the Enabled property to specify or determine whether a control is functional. **When set to false, the control appears dimmed**, preventing any input from being entered in the control.
> 
> Note The ability to enable or disable functionality is always available. **However, dimming and locking the control only works in Microsoft Internet Explorer version 4 and later.**
> 
> This property propagates down the control hierarchy. Therefore, disabling a container control will disable all child controls within that container.
> 
> Note Not all controls support this property. See the indivual controls for details.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T12:28:14.003

If this is a readonly textbox, you need to explicitly set your BackColor first, then your statement will work.

```
txtLala.BackColor = System.Drawing.SystemColors.Info;
txtLala.ForeColor = txtLala.BackColor; 
```

Ref: [http://bytes.com/groups/net-c/233961-read-only-textbox](http://bytes.com/groups/net-c/233961-read-only-textbox)

Then again, if it's readonly, a label might be better. If you're trying to hide it, perhaps setting `.Visible = false` would be better still.

* * *

**Edit**: This seems to be a [common question](http://www.google.com/search?hl=en&q=Enabled+false+textbox+font+color+change&btnG=Search) on the web. With respect to **winforms**: [This site](http://www.xtremevbtalk.com/showthread.php?t=296536) suggests dropping the box into a frame and setting `Enabled = false` *on the frame, not the textbox*. Once you do that, you may be able to maintain control of the forecolor.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T12:35:36.953

它似乎只适用于只读的 TextBox。如果它被禁用（.Enabled = false）。它似乎不起作用。

# visual-studio-2008 - VS 解决方案中的 ReSharper 配置

> ID：362613
> 
> 赞同：3
> 
> 时间：2008-12-12T12:29:58.027
> 
> 标签：visual-studio-2008, configuration, resharper

任何人都有向 VS2008 解决方案添加 ReSharper 配置文件并在开发人员之间共享的经验 - 想模仿 CodeStyle Enforcer 的行为以及它如何“遵循”解决方案。

有什么想法吗？

谢谢/贾斯珀

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T13:21:57.483

查看选项/语言/通用/代码样式共享

# javascript - Calling onclick on a radiobutton list using javascript

> ID：362614
> 
> 赞同：58
> 
> 时间：2008-12-12T12:30:16.450
> 
> 标签：javascript, onclick, radiobuttonlist

How do I call onclick on a radiobutton list using javascript?

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-12-12T12:40:41.983

你是如何生成单选按钮列表的？如果您只是使用 HTML：

```
<input type="radio" onclick="alert('hello');"/> 
```

如果您通过 ASP.NET 之类的工具生成这些，则可以将其作为属性添加到列表中的每个元素。您可以在填充列表后运行它，或者如果您逐个构建列表，则将其内联：

```
foreach(ListItem RadioButton in RadioButtons){
    RadioButton.Attributes.Add("onclick", "alert('hello');");
} 
```

更多信息：[http ://www.w3schools.com/jsref/event_onclick.asp](http://www.w3schools.com/jsref/event_onclick.asp)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2011-11-23T15:00:02.520

要在单选按钮上触发 onClick 事件，请调用`click()`DOM 元素上的方法：

```
document.getElementById("radioButton").click() 
```

使用jQuery：

```
$("#radioButton").click() 
```

AngularJs：

```
angular.element('#radioButton').trigger('click') 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-12-12T12:46:09.960

我同意@annakata 的观点，这个问题需要进一步澄清，但这里有一个非常非常基本的示例，说明如何`onclick`为单选按钮设置事件处理程序：

```
<html>
 <head>
  <script type="text/javascript">
    window.onload = function() {

        var ex1 = document.getElementById('example1');
        var ex2 = document.getElementById('example2');
        var ex3 = document.getElementById('example3');

        ex1.onclick = handler;
        ex2.onclick = handler;
        ex3.onclick = handler;

    }

    function handler() {
        alert('clicked');
    }
  </script>
 </head>
 <body>
  <input type="radio" name="example1" id="example1" value="Example 1" />
  <label for="example1">Example 1</label>
  <input type="radio" name="example2" id="example2" value="Example 2" />
  <label for="example1">Example 2</label>
  <input type="radio" name="example3" id="example3" value="Example 3" />
  <label for="example1">Example 3</label>
 </body>
</html> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-18T16:36:06.650

这里的问题是 RadioButtonList 的呈现将单个单选按钮 (ListItems) 包装在跨度标记中，即使您直接使用属性将客户端事件处理程序分配给列表项，它也会将事件分配给跨度。将事件分配给 RadioButtonList 会将其分配给它所呈现的表。

这里的技巧是在 aspx 页面上添加 ListItems，而不是从后面的代码中添加。然后，您可以将 JavaScript 函数分配给 onClick 属性。这篇博文；[Juri Strumpflohner 将客户端事件处理程序附加到单选按钮列表](http://juristr.com/blog/2008/06/attaching-client-side-event-handler-to/)说明了这一切。

这仅在您事先知道 ListItems 时才有效，并且无助于需要使用后面的代码动态添加 RadioButtonList 中的项目的位置。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-03-23T16:23:04.197

```
Hi, I think all of the above might work. In case what you need is simple, I used:

<body>
    <div class="radio-buttons-choice" id="container-3-radio-buttons-choice">
        <input type="radio" name="one" id="one-variable-equations" onclick="checkRadio(name)"><label>Only one</label><br>
        <input type="radio" name="multiple" id="multiple-variable-equations" onclick="checkRadio(name)"><label>I have multiple</label>
    </div>

<script>
function checkRadio(name) {
    if(name == "one"){
    console.log("Choice: ", name);
        document.getElementById("one-variable-equations").checked = true;
        document.getElementById("multiple-variable-equations").checked = false;

    } else if (name == "multiple"){
        console.log("Choice: ", name);
        document.getElementById("multiple-variable-equations").checked = true;
        document.getElementById("one-variable-equations").checked = false;
    }
}
</script>
</body>
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-05-19T21:21:13.667

尝试以下解决方案

HTML：

```
<div id="variant">
<label><input type="radio" name="toggle" class="radio" value="19,99€"><span>A</span></label>
<label><input type="radio" name="toggle" class="radio" value="<<<"><span>B</span></label>
<label><input type="radio" name="toggle" class="radio" value="xxx"><span>C</span></label>
<p id="price"></p> 
```

JS：

```
$(document).ready(function () {
       $('.radio').click(function () {
           document.getElementById('price').innerHTML = $(this).val();
       });

   }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-09T07:49:39.553

其他答案对我不起作用，所以我查看了[Telerik 的官方文档](https://docs.telerik.com/devtools/aspnet-ajax/controls/button/client-side-programming/overview)，它说您需要找到按钮并调用该`click()`函数：

```
function KeyPressed(sender, eventArgs) {
            var button = $find("<%= RadButton1.ClientID %>");
            button.click();
        } 
```

# xml - 在“验证”服务器中正确使用 HTTP 状态代码

> ID：362618
> 
> 赞同：22
> 
> 时间：2008-12-12T12:31:57.850
> 
> 标签：xml, http, validation, xsd, http-status-codes

在我的应用程序发送到第三方 SOA 服务器的数据中，有复杂的 XML。`.xsd`服务器所有者确实提供了XML 模式（

我可以使用独立的 XML 模式验证器，但它们很慢，主要是因为解析模式文件需要时间。*因此，我以HTTP 服务器*的形式编写了自己的模式验证器（如果重要的话，用 Java），它缓存已经解析的模式。

问题是：在验证过程中，很多事情都可能出错。除了意外异常和成功验证：

*   服务器可能找不到指定的架构文件
*   指定的文件可能不是有效的架构文件
*   XML 对架构文件无效

由于它是一个 HTTP 服务器，我想为客户端提供有意义的*状态代码*。对于上述所有情况，服务器是否应该以*400*错误（*错误请求*）回答？或者它们与 HTTP 无关，它应该在正文中回复*200*消息？还有什么建议吗？

*更新*：主应用程序是用*Ruby*编写的，它没有一个好的 xml 模式验证库，所以单独的验证服务器并没有过度设计。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-04-17T07:23:23.857

[状态码 422（“无法处理的实体”）](http://greenbytes.de/tech/webdav/rfc4918.html#rfc.section.11.2)听起来很接近：

“422（Unprocessable Entity）状态码意味着服务器理解请求实体的内容类型（因此 415（Unsupported Media Type）状态码是不合适的），并且请求实体的语法是正确的（因此 400（Bad "

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-12-15T14:13:00.980

将验证过程中的错误情况映射到有意义的 HTTP 状态代码是一种完全有效的想法。

我想您使用 URI 将 XML 文件作为 POST 内容发送到您的验证服务器，以确定用于验证的特定模式。

所以这里有一些关于错误映射的建议：

*   200：XML 内容有效
*   400：XML 内容格式不正确，标头不一致，请求与 RFC 2616 语法不匹配
*   401：在缓存中未找到模式，服务器需要凭据用于针对第 3 方 SOA 后端的身份验证才能获取模式文件
*   404：未找到架构文件
*   409: XML 内容对指定的架构无效
*   412: 指定的文件不是有效的 XML 模式
*   500：验证服务器中的任何意外异常（NullPointerExceptions 等）
*   502：在缓存中找不到模式，尝试从第 3 方 SOA 服务器请求它失败。
*   503：验证服务器正在重新启动
*   504：查看 502，原因=超时

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-28T11:26:26.357

假设您将 XML 文件发布到资源，例如：

POST /validator 内容类型：application/xml

如果请求实体未能解析为它提交的媒体类型（即应用程序/xml），则 400 Bad Request 是正确的状态。

如果它在语法上解析为它提交的媒体类型，但它没有针对某些所需的模式进行验证，或者具有使其提交到的资源无法处理的语义 - 那么 422 Unprocessable Entity 是最好的状态（尽管你可能应该在错误响应中伴随一些更具体的错误信息；还请注意，它在技术上定义在 HTTP 的扩展中，WebDAV，尽管在 HTTP API 中被广泛使用，并且比任何其他 HTTP 错误状态更合适，当有已提交实体的语义错误）。

如果它作为媒体类型提交，这意味着 xml 之上的特定模式（例如 application/xhtml+xml），那么如果它无法针对该模式进行验证，您可以使用 400 Bad Request。但是，如果它的媒体类型是纯 XML，那么我认为模式不是媒体类型的一部分，尽管它有点灰色地带；如果 xml 文件指定了它的模式，您可能会将验证解释为 application/xml 语法要求的一部分。

如果您通过 multipart/form 或 application/x-www-form-urlencoded 表单提交来提交 XML 文件，那么您必须使用 422 Unprocessable Entity 来解决 XML 文件的所有问题；仅当基本表单上传存在语法问题时，400 才合适。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-11-03T21:03:59.827

Amazon 可用作如何将 http 状态代码映射到实际应用程序级别条件的模型： [http](http://docs.amazonwebservices.com/AWSImportExport/latest/API/index.html?Errors.html) ://docs.amazonwebservices.com/AWSImportExport/latest/API/index.html?Errors.html （请参阅 Amazon S3 状态代码标题)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-12T12:52:06.203

从 w3c：400 = 由于语法错误，服务器无法理解请求。

除非实际上是服务器无法理解请求的情况，否则我不会提供该服务。如果您只是获得无效的 xml，请提供 200 并解释为什么事情不起作用。

假的

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-12T12:36:15.640

我会`400 Bad request`在正文中添加更具体的消息（可能在标题中带有辅助错误代码，`X-Parse-Error: 10451`以便于处理）

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-12T13:32:12.393

这听起来是个不错的主意，但 HTTP 状态代码并没有真正提供“操作失败”的情况。我将返回带有`X-Validation-Result: true/false`标头的 HTTP 200，必要时将正文用于任何文本或“原因”。将 HTTP 4xx 保存为 HTTP 级错误，而不是应用程序级错误。

不过，这是一种耻辱和双重标准。许多应用程序使用 HTTP 身份验证，它们能够从应用程序级别返回 HTTP 401 Not Authorized 或 403 Forbidden。拥有某种可以使用的全面的 HTTP 4xx Request Rejected 会很方便和明智。

# language-agnostic - 您如何管理应用程序的外部依赖项？

> ID：362627
> 
> 赞同：5
> 
> 时间：2008-12-12T12:36:53.363
> 
> 标签：language-agnostic, defensive-programming, robustness, external-dependencies

有许多类型的外部依赖项。与外部应用程序、组件或服务（例如用于发送电子邮件的 Outlook、用于扫描的 TWAIN 或 WIA、用于各种目的的 ActiveX 对象和 Web 服务等）的接口。

你有什么策略来确保你的应用程序是健壮的，并且即使在这种外部依赖项（由于无数原因）不可用时也可以运行？

注意：您自己的源代码中包含的来自外部源的代码是另一种类型的外部依赖，但这并不是我在这里主要关心的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T12:57:30.887

我们的策略是，我们的软件可能不会，除非在特殊情况下。所以我们非常防御性地编程：

*   如果没有邮件连接，则邮件功能不可用。
*   图形输出取决于可用的图形卡。
*   只有网络的可用性才能实现分布式功能。

还有更多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T13:36:41.930

另请注意，对于外部接口，与用户输入一样，您不应*信任该输入*。始终*验证输入*，并在调用时检查一致性（或存在）。

# sql - 如何在开始时只将相同的输入传递给所有 sql 文件？

> ID：362628
> 
> 赞同：0
> 
> 时间：2008-12-12T12:37:11.490
> 
> 标签：sql, mysql

我一次从一个文件中调用 4-5 个脚本。但是我只需要在我调用的第一个 sql 中为文件提供一个输入。

该输入将是我在第一个之后调用的所有其他 sql 文件的输入。

有没有办法做到这一点？

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T13:07:07.810

[我认为您可以通过使用sqlcmd](http://msdn.microsoft.com/en-us/library/ms162773.aspx)实用程序和[脚本变量](http://msdn.microsoft.com/en-us/library/ms188714.aspx)来实现您想要的。最后一个链接指出您还可以使用环境变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T15:53:18.443

您是否考虑过为此使用存储过程。当然，它确实取决于 MySQL 的 5.0 版（或更高版本）。但这允许您定义变量并在程序中使用它们，非常灵活且使用起来非常有趣！警告，我自己没有测试过，我的经验是使用 Oracle PL/SQL，但概念是相似的。

然后你可以做这样的事情（来自 MySQL 时事通讯：

[http://www.mysql.com/news-and-events/newsletter/2004-01/a0000000297.html](http://www.mysql.com/news-and-events/newsletter/2004-01/a0000000297.html)

```
DELIMITER // [1]

CREATE PROCEDURE payment [2]
(payment_amount DECIMAL(6,2),
payment_seller_id INT)
BEGIN
DECLARE n DECIMAL(6,2);
SET n = payment_amount - 1.00;
INSERT INTO Moneys VALUES (n, CURRENT_DATE);
IF payment_amount > 1.00 THEN
UPDATE Sellers
SET commission = commission + 1.00
WHERE seller_id = payment_seller_id;
END IF;
END;
// 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T12:52:01.070

你的意思是：

query2 基于 query1 的结果，query3 基于 query2 的结果等...

如果是这样，您可以使用视图

```
create view view1 as select * from table1;
create view view2 as select * from view2;
create view view3 as select * from view3;
create view view4 as select * from view4;
select * from view4 
```

当然，您必须自己添加 where 子句。

有关视图的更多信息，请参见[http://dev.mysql.com/doc/refman/5.0/en/create-view.html](http://dev.mysql.com/doc/refman/5.0/en/create-view.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T13:08:25.140

no START fbm.sql START fba.sql START fei.sql START fbe.sql START fae.sql START tfat.sql START ins_FBH.sql 是代码。

在 fbm.sql 中，我有一个像 bill id = '&1' 这样的输入。我在其他 sql 中也有相同的账单 ID 输入。

但是当我运行主 sql 时，它会运行 fbm.sql 并要求我输入账单 ID。假设我将其作为“ABC”并在完成此 fbm.sql 后再次向我询问 fba.sql 的账单 ID 输入，我不想再次给出 n。我想要的是，这个 fba.sql 和其他相应的 sql 应该将输入的账单 ID 设为“ABC”，而无需我输入。

# performance - 静态类会导致多核系统上的性能问题吗？

> ID：362632
> 
> 赞同：2
> 
> 时间：2008-12-12T12:39:25.447
> 
> 标签：performance, language-agnostic, static, class

前几天我的一位同事表示，使用静态类可能会导致多核系统上的性能问题，因为静态实例不能在处理器缓存之间共享。是对的吗？是否有围绕证明此声明的一些基准？该声明是在 .Net 开发（使用 C#）相关讨论的背景下做出的，但在我看来，这听起来像是一个独立于语言和环境的问题。

谢谢你的意见。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-12T12:42:33.227

我会推动你的同事提供数据或*至少*参考。

问题是，如果你有共享数据，那么你就有了共享数据。无论是通过静态类、单例还是其他方式公开，都不是很重要。如果您首先不需要共享数据，我希望您无论如何都不会拥有静态类。

除此之外，在任何给定的应用程序中，可能存在比静态类中共享数据的处理器缓存更大的瓶颈。

与以往一样，首先编写最明智、可读、可维护的代码——然后找出性能瓶颈并采取相应措施。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T12:58:46.500

“[a] 静态实例不能在处理器缓存之间共享。对吗？”

这种说法对我来说没有多大意义。每个处理器的专用缓存的关键在于它包含一小块内存的私有副本，因此如果处理器正在执行一些只需要访问该特定内存区域的算法，那么它不必继续运行返回访问外部存储器。如果我们谈论的是静态类中的静态字段，那么这些字段的内存可能都适合一块连续的内存块，而这块内存又将适合单个处理器（或内核）的专用缓存。但他们每个人都有自己的缓存副本——它不是“共享的”。这就是缓存的意义所在。

如果算法的工作集大于缓存，那么它将破坏该缓存。这意味着当算法运行时，它会反复导致处理器从外部存储器中提取数据，因为所有必要的部分都无法立即放入缓存中。但这是一个普遍问题，不适用于静态类。

我想知道您的同事是否实际上不是在谈论性能，而是在谈论如果多个线程正在读取/写入相同的数据时需要应用正确的锁定？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T13:23:50.337

如果多个线程正在*写入*该数据，则会出现缓存抖动（一个 CPU 缓存上的写入会使其他 CPU 的缓存无效）。你的朋友在技术上是正确的，但很有可能它不是你的主要瓶颈，所以没关系。

如果多个线程正在*读取*数据，那么您的朋友就大错特错了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T12:42:01.153

如果您不使用任何类型的锁或同步，那么静态与非静态不会对您的性能产​​生任何影响。

如果您正在使用同步，那么如果所有线程都需要获取相同的锁，那么您可能会遇到问题，但这只是静态的副作用，而不是静态方法的直接结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T13:00:41.693

在任何“虚拟机”受控语言（.NET、Java 等）中，此控制都可能委托给底层操作系统，并且可能进一步下放到 BIOS 和其他调度控制。话虽如此，在 .NET 和 Java 这两个巨头中，静态与非静态是*内存*问题，而不是 CPU 问题。

再次重申sua的观点，对CPU的影响来自于同步和线程控制，而不是对静态信息的访问。

CPU 缓存管理的问题不仅限于静态方法。一次只有一个 CPU 可以更新*任何*内存地址。虚拟机中的对象，特别是对象中的字段，是指向所述内存地址的指针。因此，即使我有一个可变对象，一次只允许在一个 CPU 上`Foo`调用Foo 。`setBar(true)`

*话虽如此，.NET 和 Java 的意义在于，在您能够证明*自己有问题之前，您不应该花时间去解决这些问题，我怀疑您会这样做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T14:29:19.097

1.  如果您在线程之间共享可变数据，则需要锁或无锁算法（不幸的是，很少可用，有时很难使用）。
    *   拥有很少的、广泛使用的、锁定仲裁的资源会让你陷入瓶颈。
    *   静态数据类似于单实例资源。

所以：

*   如果许多线程访问静态数据，并且您使用锁进行仲裁，则您的线程将争夺访问权限。

在设计一个高度多线程的应用程序时，尽量使用许多细粒度的锁。拆分您的数据，以便一个线程可以抓取一个并运行它，希望没有其他线程需要等待它，因为它们正忙于处理自己的数据。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T15:06:01.347

x86 架构实现了缓存窥探，以在写入时保持数据缓存同步，以防它们碰巧缓存相同的东西……并非所有架构都在硬件中这样做，有些架构依赖于软件来确保这种情况永远不会发生。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T13:21:20.357

即使这是真的，我怀疑你有很多更好的方法来提高性能。当涉及到将静态更改为实例时，对于处理器缓存，您会知道您确实在挑战极限。

# sql - 在查询结果中添加oracle的时间戳

> ID：362641
> 
> 赞同：1
> 
> 时间：2008-12-12T12:43:14.833
> 
> 标签：sql, oracle, timestamp

[昨天你教我在这里](https://stackoverflow.com/questions/359733/oracle-record-history-using-as-of-timestamp-within-a-range)查询一个时间范围内的历史记录。

我还需要将 oracle 的（历史）时间戳作为列添加到结果中。是否可以？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T12:48:42.060

是的，事实上，您上一个问题的答案显示了如何：

```
SQL> select empno, sal, versions_starttime,versions_xid
  2  from emp
  3  versions between timestamp sysdate-1 and sysdate
  4  where empno=7369;

     EMPNO        SAL VERSIONS_STARTTIME                                                          VERSIONS_XID
---------- ---------- --------------------------------------------------------------------------- --
      7369       5900 11-DEC-08 16.05.32                                                          0014001300002A74
      7369       5800 11-DEC-08 16.03.32                                                          000D002200012EB1
      7369       5800 
```

还有一个 VERSIONS_ENDTIME 伪列。在它们之间，VERSIONS_STARTTIME 和 VERSIONS_ENDTIME 括起进行更改的时间段。

# visual-studio-2008 - 如何在 TFS 中始终启用“原因”字段

> ID：362663
> 
> 赞同：1
> 
> 时间：2008-12-12T12:59:15.533
> 
> 标签：visual-studio-2008, tfs

我正在使用 Visual Studio Team System 2008，我希望能够始终为工作项启用“原因”字段。目前，“原因”下拉菜单仅在更改“状态”时启用。执行“保存”后，“原因”下拉菜单将被禁用。

我已经尝试通过修改流程模板来做到这一点，但它不能在那里完成。

我要完成的是以下内容，例如“测试”任务。

1.  初始状态为“活动”，“原因”为“待定”。这标识了由于开发工作尚未完成而无法开始的计划测试工作。

2.  开发完成后，开发人员会将“测试”任务的原因设置为“就绪”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T01:16:03.793

我不认为你可以用 Reason 字段做你想做的事，因为它的值是在转换中定义的。其目的是为状态更改提供理由。由于您没有更改工作项的状态，因此您无权访问该字段。

听起来您真的想要一个“状态”类型的字段。我建议最好为此在您的工作项中创建一个自定义字段，而不是使用 Reason。将您的自定义字段添加到工作项的活动状态并设置“AllowedValues”规则。这将创建一个您可以随时更改的组合。

# xml - Outlook XML 视图定义

> ID：362664
> 
> 赞同：3
> 
> 时间：2008-12-12T12:59:35.313
> 
> 标签：xml, outlook

[除了http://msdn.microsoft.com/en-us/library/aa140157(office.10).aspx](http://msdn.microsoft.com/en-us/library/aa140157(office.10).aspx)之外，是否有任何完整的 Outlook XML 视图定义不完整且仅描述 Outlook 2002？

# java - Tomcat 与 WebSphere 与 WebLogic 的安全性

> ID：362665
> 
> 赞同：5
> 
> 时间：2008-12-12T12:59:52.537
> 
> 标签：java, tomcat, jakarta-ee, websphere, weblogic

我工作的公司销售在 Tomcat、WebSphere 或 WebLogic 上运行的 J2EE 应用程序。我们有一个客户正试图在 Tomcat 和 WebSphere 之间做出决定。他们倾向于 WebSphere，因为他们担心 Tomcat 有更多的安全漏洞。

在网上搜索之后，我找不到任何网站或研究从安全的角度比较主要 J2EE 应用程序服务器的健壮性。

你们中的任何人都可以指出比较应用服务器安全漏洞的信息吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-28T15:37:05.587

有趣的是，您的客户“担心 Tomcat 存在更多安全漏洞”。我想知道他们是否可以列出这些洞是什么？如果他们不能，那就是道听途说和 FUD。

我会说所有的 Web 服务器/servlet 引擎都会遇到同样的问题。部署在它们上的应用程序代表了真正的安全漏洞。跨站点脚本、SQL 注入、缺乏输入验证、由于分层和实践不佳导致敏感数据暴露——这些都是*应用程序*问题，无论您选择哪个应用程序服务器，这些问题都会成为问题。

我个人认为 WebLogic 是市场上最好的 Java EE 应用服务器。我没有使用 WebSphere 的第一手经验，但我尊敬的人告诉我，这是一场恐怖秀。我只使用Tomcat进行本地开发。它从来没有让我失望过，但这几乎不是生产经验。我不知道它是如何扩展的。

我会仔细考虑基于 Tomcat、Spring 和 OSGi 的 Spring 的 dm 服务器。我有一种感觉，它代表了所有竞争对手都将采取的未来方向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T18:48:01.117

如果可能的话，我会说在 WebSphere 上使用 tomcat。

我认为 99% 的安全性是你如何设置的。

您是否也在评估 Apache HTTP Server、IBM HTTP Server 和 IIS 的安全隐患？

安全性不仅仅涉及您选择在哪个应用程序服务器上运行您的 webapp。

[Tomcat 安全报告](http://tomcat.apache.org/security-6.html)

[Websphere 安全报告](http://www-01.ibm.com/support/docview.wss?rs=180&uid=swg27004980)（您必须深入了解每个更新以查看已修复的内容）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T13:16:50.020

根据我的经验，WebSphere 不会添加任何非规范（因此在 Tomcat 上有所支持）。当您尝试做一些更复杂的安全技巧（使用 SecureID 或其他东西的管理员身份验证）时，问题就出现了，您需要更深入地挖掘。WebSphere 尝试将更多内容放在 UI 控制台中。

话虽如此，贵公司应该考虑在 Glassfish 上进行测试。它使用 Tomcat 作为 servlet 容器，但添加了更好的 UI 用于管理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T13:19:04.167

根据这篇[文章](http://www.ibm.com/developerworks/websphere/library/techarticles/0511_li1/0511_li1.html)，WebSphere 社区添加在 servlet 引擎方面与 Tomcat 5.5 没有什么不同。在我看来，这个决定应该基于所需的整体功能，而不是感知到的“安全漏洞”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-07T05:46:28.167

几项不同的调查已经证实，Tomcat 在全球超过 60% 的组织中运行，包括最大的银行。正如其他人所说，Tomcat 安全不是问题。“Plain Vanilla”Tomcat 缺少的是许多企业在访问控制、诊断、监控、警报和配置方面所需的控制台和 UI。查看MuleSoft 的[Tcat 服务器](http://www.mulesoft.com/tcat-server-enterprise-tomcat-application-server-0)。它是 100% 的 Tomcat（无分叉），但具有运行 Tomcat 的企业能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T15:27:16.810

我不能说一个是否比另一个更好，因为我从未使用过 Tomcat，而且你真的没有定义你的安全要求是什么。安全性可能是一个相当大的野兽，涉及不同的级别。因此，您甚至需要明确定义的要求才能确定需要哪些安全功能。

我们使用与其他几个 IBM 产品集成的 Websphere 来提供对我们应用程序的安全访问，这对我们来说一直运行良好。您可以查找 Webseal 和 Tivoli 系列产品以增加 WebSphere 的安全性。

# wpf - 如何从 (X,Y) 位置获取 ListView 项目？

> ID：362670
> 
> 赞同：3
> 
> 时间：2008-12-12T13:05:07.020
> 
> 标签：wpf, listview

我在 WPF 的 ListView 中删除了一些东西。我需要知道我正在丢弃的 (X,Y) 位置的项目。我怎样才能做到这一点？

* * *

WPF ListView 没有 GetItemAt。我回到我原来的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T17:43:35.163

完毕！感谢这篇文章 [http://www.codeproject.com/KB/WPF/WPF_Drag_And_Drop_Sample.aspx](http://www.codeproject.com/KB/WPF/WPF_Drag_And_Drop_Sample.aspx)

```
private int GetCurrentIndex(GetPositionDelegate getPosition)
{
    int index = -1;
    for (int i = 0; i < clasesListView.Items.Count; ++i)
    {
        ListViewItem item = GetListViewItem(i);
        if (this.IsMouseOverTarget(item, getPosition))
        {
            index = i;
            break;
        }
    }
    return index;
}

private bool IsMouseOverTarget(Visual target, GetPositionDelegate getPosition)
{
    Rect bounds = VisualTreeHelper.GetDescendantBounds(target);
    Point mousePos = getPosition((IInputElement)target);
    return bounds.Contains(mousePos);
}

delegate Point GetPositionDelegate(IInputElement element);

ListViewItem GetListViewItem(int index)
{
    if (clasesListView.ItemContainerGenerator.Status != GeneratorStatus.ContainersGenerated)
        return null;

    return clasesListView.ItemContainerGenerator.ContainerFromIndex(index) as ListViewItem;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T17:45:48.607

箍，对不起。这应该可以正常工作：

```
FrameworkElement element = (FrameworkElement)e.OriginalSource;

ListViewItem lvi = (ListViewItem)listView1.ItemContainerGenerator.ContainerFromItem(element.DataContext); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-12T13:13:26.253

您想使用[GetItemAt](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.getitemat.aspx)函数。您可能还需要在 GetItemAt 之前调用[PointToClient](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.pointtoclient.aspx)函数，因为您需要使用[客户端坐标](http://msdn.microsoft.com/en-us/library/ms229598.aspx)。

# silverlight - Does TDD apply well when developing an UI?

> ID：362671
> 
> 赞同：20
> 
> 时间：2008-12-12T13:05:40.637
> 
> 标签：silverlight, unit-testing, tdd

What are your opinions and experiences regarding using TDD when developing an user interface?

I have been pondering about this question for some time now and just can't reach a final decision. We are about to start a Silverlight project, and I checked out the [Microsoft Silverlight Unit Test Framework](http://code.msdn.microsoft.com/silverlightut/) with TDD in mind, but I am not sure how to apply the approach to UI-development in general - or to Silverlight in particular.

**EDIT:** The question is about if it is practical thing to use TDD for UI-development, not about how to do separation of concerns.

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-12T13:12:25.303

Trying to test the exact placement of UI components is pointless. First because layout is subjective and should be "tested" by humans. Second, because as the UI changes you'll be constantly rewriting your tests.

Similarly, don't test the GUI components themselves, unless you're writing new components. Trust the framework to do its job.

Instead, you should be testing the behavior that underlies those components: the controllers and models that make up your application. Using TDD in this case drives you toward a separation of concerns, so that your model is truly a data management object and your controller is truly a behavior object, and neither of them are tightly coupled to the UI.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-12T13:13:27.203

I look at TDD from a UI perspective more from the bare acceptance criteria for the UI to pass. In some circles, this is being labeled as ATDD or Acceptance Test Driven Development.

Biggest over-engineering I have found in using TDD for UIs is when I got all excited about using automated tests to test look and feel issues. My advice: don't! Focus on testing the behavior: this click produces these events, this data is available or displayed (but not how it's displayed). Look and Feel really is the domain of your independent testing team.

The key is to focus your energy on "High Value Add" activities. Automated style tests are more of a debt (keeping them up to date) than a value add.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-12T13:10:53.170

If you separate you logic from the actual GUI code, you can easily use TDD to build the logic and it will be a lot easier to build another interface on top of your logic as well, if you ever need that.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-12T13:46:45.467

I can't speak to Microsoft Silverlight, but I never use TDD for any kind of layout issues, just is not worth the time. What works well is using Unit Testing for checking any kind of wiring, validation and UI logic that you implemented. Most systems provide you with programmatic access to the actions the user takes, you can use these to assert that your expectations are correctly met. E.g. calling the click() method on a button should execute what ever code you intended. Selecting an item in a list view changes all the UI elements content to this items properties ...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T13:30:44.220

Based on your edit, here's a little more detail about how we do it on my current team. I'm doing Java with GWT, so the application to Silverlight might be a bit off.

Requirement or bug comes in to the developer. If there is a UI change (L&F) we do a quick mock up of the UI change and send it over to the product owner for approval. While we are waiting on that, we start the TDD process.

We start with at least on of either a Web test (using Selenium to drive user clicks in a browser), *or* a "headless" functional test using Concordion, FiT or something like it. Once that's done and failing, we have a high level vision of where to attack the underlying services in order to make the system work right.

Next step is to dig down and write some failing unit and integration tests (I think of unit tests as stand-alone, no dependencies, no data, etc. Integration tests are fully wired tests that read/write to the database, etc.)

Then, I make it work from bottom up. Sounds like your TDD background will let you extrapolate the benefits here. Refactor on the way up as well....

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-22T10:58:53.173

I think [this blog post](http://ayende.com/Blog/archive/2008/12/21/the-tests-has-no-value-by-themselves-my-most-successful.aspx) by Ayende Rahien answers my question nicely using a pragmatic and sound approach. Here are a few quotes from the post:

> Testing UI, for example, is a common place where it is just not worth the time and effort.
> 
> ...
> 
> Code quality, flexibility and the ability to change are other things that are often attributed to tests. They certainly help, but they are by no mean the only (or even the best) way to approach that.

Tests should only be used when they add value to the project, without becoming the primary focus. I am finally quite certain that using test-driven development for the UI can quickly become the source of much work that is simply not worth it.

Note that it seems the post is mainly about testing AFTER things have been built, not BEFORE (as in TDD) - but I think the following golden rule still applies: *The most important things deserve the greatest effort, and less important things deserve less effort.* Having a unit-tested UI is often not THAT important, and as Ayende writes, the benefit of using TDD as development model is probably not so great - especially when you think of that developing an UI is normally a top-down process.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T13:46:56.310

GUIs by their very nature are difficult to test, so as Brian Rasmussen suggests keep the dialog box code separate from the the GUI code.

This is the [Humble Dialog Box Pattern](http://www.objectmentor.com/resources/articles/TheHumbleDialogBox.pdf).

For example, you may have a dialog box where details (e.g. credit card number) are input and you need to verify them. For this case you would put the code that checks the credit card number with the [Luhn algorithm](http://en.wikipedia.org/wiki/Luhn_algorithm) into a separate object which you test. (The algorithm in question just tests if the number is plausible - it's designed for checking for transcription errors.)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-22T11:11:25.817

At my workplace we use TDD and we actually unit test our UI code (for a web application) thanks to [Apache Wicket](http://wicket.apache.org/)'s [WicketTester](http://www.ddpoker.com/javadoc/wicket/1.4-m2/org/apache/wicket/util/tester/WicketTester.html) but it's not testing that some descriptive label is before a text field or something like that, instead we test that hierarchy of the components is somewhat correct ("*label is in the same subset as text field*") and the components are what they're supposed to be ("*this label really is a label*").

Like others have already said, it's up to the real person to determine how those components are placed on the UI, not the programmer, especially since programmers have a tendency of doing all-in-one/obscure command line tools instead of UIs which are easy to use.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-12T13:12:10.390

Test-Driven Development lends itself more to developing code than for developing user-interfaces. There are a few different ways in which TDD is performed, but the preferred way of true TDD is to write your tests first, then write the code to pass the tests. This is done iteratively throughout development.

Personally, I'm unsure of how you would go about performing TDD for UI's; however, the team that I am on performs automated simulation tests of our UIs. Basically, we have a suite of simulations that are run every hour on the most recent build of the application. These tests perform common actions and verify that certain elements, phrases, dialogs, etc, etc, properly occur based on, say, a set of use cases.

Of course, this does have its disadvantages. The downside to this is that the simulations are locked into the code representing the case. It leaves little room for variance and is basically saying that it expects the user to do **exactly** this behavior with respect to this feature.

Some testing is better than no testing, but it could be better.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-12T13:12:16.787

Yes, you can use TDD with great effect for GUI testing of web apps.

When testing GUI's you typically use stub/fake data that lets you test all the different state changes in your gui. You must separate your business logic from your gui, because in this case you will want to mock out your business logic.

This is really neat for catching those things the testers always forget clicking at; they get test blindness too !

# asp.net - 如何从 HTML 中提取元素 id 属性值

> ID：362674
> 
> 赞同：0
> 
> 时间：2008-12-12T13:08:12.677
> 
> 标签：asp.net, html, regex, html-content-extraction

我正在尝试计算服务器控件的 ASP.NET 自动命名的开销。我有一个页面，其中包含从数百个嵌套的 ASP.NET 控件呈现的 7,000 行 HTML，其中许多具有长度为数百个字符的 id/name 属性。

理想情况下，我想要的是将每个以“ctl00”开头的 HTML 属性值提取到列表中的东西。如果我知道正则表达式应该是什么，Notepad++ 中的正则表达式查找功能将是完美的？

例如，如果 HTML 是：
<input name="ctl00$Header$Search$Keywords" type="text" maxlength="50" class="search" />

我希望输出类似于：
name="ctl00$Header$Search$Keywords"
更高级的搜索也可能包括元素名称（例如控件类型）：
input|name="ctl00$Header$Search$Keywords "

为了同时处理 Id 和 Name 属性，我将简单地重新运行搜索以查找 Id 而不是 Name（即，我不需要同时搜索两者的东西）。

最终输出将是一个 Excel 报告，其中列出了页面上服务器控件的数量，以及每个名称的长度，可能按控件类型排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T13:21:33.943

又快又脏：

搜索

```
\w+\s*=\s*"ctl00[^"]*" 
```

这将匹配任何看起来像属性的文本，例如`name="ctl00test"`或`attr = "ctl00longer text"`。它不会检查这是否真的发生在 HTML 标记中 - 这有点难做，也许是不必要的？它也不会检查标签名称中的转义引号。像往常一样使用正则表达式，所需的复杂性取决于您想要匹配的内容以及您的输入看起来像什么......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T13:21:43.477

“7000”？“数百”？亲爱的上帝。

因为您只是在文本编辑器中查看源代码，所以试试这个... /(id|name)="ct[^"]*"/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-15T21:45:44.927

回答我自己的问题，最简单的方法是使用 BeautifulSoup，它的标语是“脏 HTML”Python 解析器：

*“你没有写那个糟糕的页面。你只是想从中获取一些数据。现在，你并不真正关心 HTML 应该是什么样子。这个解析器也不关心。”*

它有效，可以从这里获得 - [http://crummy.com/software/BeautifulSoup](http://crummy.com/software/BeautifulSoup)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-12T13:45:44.737

我建议使用 xpath，就像在这个[问题中一样](https://stackoverflow.com/questions/99279/how-do-you-parse-a-web-page-and-extract-all-the-href-links#100197)

# sql-server - SQL 导入向导删除前导零

> ID：362679
> 
> 赞同：0
> 
> 时间：2008-12-12T13:11:30.470
> 
> 标签：sql-server, sql-server-2005, excel, import

我已经阅读了所有关于在数字前加上 ' 并在连接字符串中设置 IMEX=1 的帖子；似乎没有什么对我有用。

设置如下： 包含混合数据的 Excel 列 - 99% 的数字（有些以 0 开头）1% 的文本。

以编程方式导入 SQL Server 2005 表/列类型 - varchar(255)。

**导入在本地可以正常工作，但是一旦我将代码移至生产环境（GoDaddy），它就会删除列中的前导 0。**

有任何想法吗？

ps 我知道注册表更改解决方案，事实上 - 在我的开发盒上该值设置为 0，但答案让我意识到该值未在 PRODUCTION SERVER 上设置:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T13:50:37.160

是的。Excel 驱动程序仅对前 8 行进行采样以确定数据类型。这意味着它假定列是数字的“bob”不会出现在第 1 到第 8 行中。

目标表列数据类型无关紧要。

这个问题[很久](http://forums.xmetal.com/index.php?topic=21.0)了，2003年第一次看到。

[BOL 关于 excel 导入的说明](http://msdn.microsoft.com/en-us/library/ms141683.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T18:57:08.853

ISAM 驱动程序仅对前 8 行进行采样，但您可以通过更改注册表来更改该行为：

[http://sqlserversd.wordpress.com/2008/09/14/ssis-excel-values-import-as-nulls/](http://sqlserversd.wordpress.com/2008/09/14/ssis-excel-values-import-as-nulls/)

但是，是的，使用 Excel 进行机器对机器的数据传输是一场噩梦……没有其他方法可以发送数据吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:06:52.410

我们通常将文件保存为 .csv 文件或 .txt 文件，然后问题就不会发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-18T14:48:32.903

有一种快速而棘手的方法。按照这些步骤但首先将所有数据/列和行从实际的 excel 表复制到另一个 excel 表中，只是为了安全起见，以便您有实际数据进行比较。

脚步：

1.  复制列中的所有值并将它们粘贴到记事本中。
2.  现在在 Excel 工作表中将列类型更改为文本（它将修剪前面/后面的零），不用担心。
3.  转到记事本并复制您刚才粘贴的所有值。
4.  转到您的 Excel 工作表并将值粘贴到同一列中。

如果您有不止一列具有 0 值，那么只需重复相同的操作。现在您的 excel 文档已准备好以零值导入 :)。

快乐的时光。

# asp.net - Asp.net CheckBox.Enabled = false 问题

> ID：362691
> 
> 赞同：-1
> 
> 时间：2008-12-12T13:14:59.153
> 
> 标签：asp.net, checkbox

如果在服务器端将 Enabled 属性设置为 False，为什么 asp.net CheckBox 不会呈现到客户端 html？启用 Enabled=false 的目的很简单 - 您不希望用户有时更改 CheckBox。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T13:18:13.497

你想要只读。

# licensing - 英特尔的线程构建块“运行时异常”许可证：这是什么意思？

> ID：362694
> 
> 赞同：20
> 
> 时间：2008-12-12T13:15:41.663
> 
> 标签：licensing, gpl, tbb

刚刚查看了线程构建块，作为他们的许可证，他们说这是带有[运行时异常](http://gcc.gnu.org/onlinedocs/libstdc++/manual/bk01pt01ch01s02.html)的 GPLv2 。在[英特尔页面上，](http://www.intel.com/cd/software/products/asmo-na/eng/294797.htm)他们说如果您需要商业支持，商业许可证是正确的。

那么，如果我正在做一个使用 TBB 的商业、封闭源代码应用程序，但我不需要商业支持，该怎么办？我还可以使用开源版本，还是必须购买商业版本？

毕竟，我假设我可以在商业应用程序中不受限制地使用 libstdc++（即链接它）。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-31T16:01:43.837

我相信你的理解是正确的。如果您需要英特尔的商业支持，那么您应该为商业许可证付费。如果您只是想使用该库，即使在封闭源代码的应用程序中，您也应该没问题。

[LibSTDC++ FAQ](http://gcc.gnu.org/onlinedocs/libstdc++/faq.html#faq.license.any_program)简明扼要地介绍了这个问题。

# c - 嵌套结构/数组初始化

> ID：362696
> 
> 赞同：5
> 
> 时间：2008-12-12T13:16:14.093
> 
> 标签：c, compound-literals

我有一个包含另一个结构的数组的结构，它看起来像这样：

```
 typedef struct bla Bla;
typedef struct point Point;

struct point
{
    int x, y;
};

struct bla
{
    int another_var;
    Point *foo;
}; 
```

我现在想在全局范围内初始化它们。它们旨在作为模块的描述。我试图用 c99 复合文字来做到这一点，但编译器（gcc）不喜欢它：

```
 Bla test =
{
    0, (Point[]) {(Point){1, 2}, (Point){3, 4}}
}; 
```

我收到以下错误：

```
错误：初始化元素不是常量
错误：（接近初始化“测试”）

```

因为我不需要修改它，所以我可以根据需要在其中添加尽可能多的“const”。有没有办法编译它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T13:23:45.390

您不需要每个元素的复合文字，只需创建一个复合文字数组：

```
Bla test =
{
    0, (Point[]) {{1, 2}, {3, 4}}
}; 
```

确保使用`-std=c99`.

# c# - c# 使用基类中的setter或getter

> ID：362719
> 
> 赞同：4
> 
> 时间：2008-12-12T13:24:07.247
> 
> 标签：c#, variables, member, protected

是否建议将基类的成员变量设置为受保护，以便子类可以访问这些变量？还是更推荐将成员变量设置为私有，让子类通过getter和setter获取或设置变量？

如果推荐使用getter和setter方法，什么时候使用protected变量？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-12T13:31:33.657

这与[这个问题](https://stackoverflow.com/questions/355787)非常*相似*，关于是通过属性还是直接访问来访问同一类中的信息。可能也值得阅读所有这些答案。

就个人而言，我不喜欢任何字段都是非私有的，除了具有不可变值（无论是否为 const）的静态只读字段偶尔例外。对我来说，属性只是提供了更好的封装程度。如何存储数据是*实现*决策，而不是*API*决策（与属性不同）。为什么派生自类 Bar 的类 Foo 应该关心类 Bar 的*实现*？

简而言之，我总是选择属性，除了一次性测试代码之外，我不使用受保护的变量。

借助 C# 3.0 中自动实现的属性，将字段转换为属性比以往任何时候都容易。没有什么理由*不*这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T13:41:58.363

其他程序集中的类可以派生自您的未密封类，并且可以访问受保护的字段。如果有一天您决定将这些字段设置为属性，则其他程序集中的这些类将需要重新编译才能与您的程序集的新版本一起使用。这被称为“破坏二进制兼容性”，这可能是您永远不应该在程序集之外公开字段的一个可靠原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T13:35:15.927

这是一个权衡。Setter 和 getter 比直接访问字段要慢一些，所以如果你正在做大量的数学运算并且在你的子类中读/写这些字段很多，你应该直接访问这些字段。但这更像是一个例外。

通常，您应该将它们标记为私有并使用 getter/setter。

所以我的回答是：直接访问频繁使用的字段，否则是 getter/setter。使用常识。

**编辑：我做了一些分析，显然即使在发布模式下，字段和属性之间的速度差异也可能高达 20%。**在这里查看我的测试用例：http: [//pastebin.com/m5a4d1597](http://pastebin.com/m5a4d1597)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T13:46:25.470

我必须同意乔恩的观点。

但是，在某些情况下，我有时将受保护的变量用于“最顶级”的继承类。例如，如果您有一个只读对象并且您无法将其设置回来但您可以在子类中使用它，我不明白为什么我应该拥有一个受保护的 Get 来访问该变量。一个简单的受保护变量执行相同的封装，因为您无法设置此变量并且只能从子类访问此变量。

但是设置/获取是其他情况的方法。

# linux - 如何让 gdb 忽略我的 shell 窗口的大小？

> ID：362724
> 
> 赞同：3
> 
> 时间：2008-12-12T13:29:00.183
> 
> 标签：linux, gdb

这是我们单元测试流程的一部分。我使用 --command 选项运行 gdb 以让它执行来自文本文件的命令。然后将 gdb 的输出定向到一个文件中，并将该文件与参考文件进行比较。但问题是，gdb 使用当前 shell 窗口的大小在其输出中放置换行符。如果窗口较小，它将在输出中添加更多换行符以使其更具可读性。

gdb 中是否有一个选项可以禁用它，这样无论我在哪个 shell 窗口中运行它，我的测试输出总是相同的？

编辑：找到它，我只是将它用作第一个 gdb 命令：

```
set width 80 
```

有时事情很容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T13:26:20.823

找到了，我只是用它作为第一个 gdb 命令：

```
set width 80 
```

有时事情很容易。

# web-applications - 构建可通过键盘访问的 Web 应用程序

> ID：362727
> 
> 赞同：9
> 
> 时间：2008-12-12T13:30:07.687
> 
> 标签：web-applications, accessibility

您如何构建一个完整的可通过键盘访问的 Web 应用程序？假设这适用于访问受限（不向公众开放）的受控部署环境（用于在组织内使用）。

更新：忘了说这是为了提高数据输入效率，与残疾无关。

更新 2：对整个应用程序使用 Flash 是否有意义？考虑到环境是基于浏览器而不是基于 Web 的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T13:54:17.683

好吧，首先，您必须做出强有力的假设才能有机会实现您的目标：

*   **您只需要支持一种浏览器。**如果没有，您已经准备好在屁股过程中遇到痛苦，因为所有浏览器都有不同的预定义快捷方式。
*   **您将在受控环境中工作**。与上面相同，使用所有这些插件以及向浏览器添加功能的相关工具，避免冲突成为一场噩梦。
*   **您将进行大量用户验收测试！**真的很难找到正确的捷径。它必须在键盘上易于访问，有意义，易于用户提醒，最后但并非最不重要的一点是，避免危险的快捷键组合太容易发生。

如果你不满足所有这些点。在继续之前停下来三思而后行，否则你会碰壁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T18:55:11.893

我已经广泛使用[了这个库](http://www.openjs.com/scripts/events/keyboard_shortcuts/)

```
shortcut.add("Ctrl+Shift+X",function() {
    alert("Hi there!");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T13:44:46.767

这有点痛苦。在我处理该要求的项目（银行柜员的柜员系统）中，我们有很多 javascript 监控 key*（keypress、keydown、keyup 等）事件等。这可能不是最好的方法（我们都是该项目 Web 开发的新手——盲人领导盲人），但这是我们的方法。

我们从来没有给他们的东西是能够按回车键在字段之间移动，就像他们能够在他们的旧柜员系统或夏普柜员机上做的那样......

*编辑*如果 Joel 的团队在 FogzBugz 上做了很多 javascript 来处理它，也许还不错

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T13:33:49.300

[Fogbugz](http://discuss.joelonsoftware.com/help/topics/basics/KeyboardShortcuts.html)中的键盘快捷键功能是我在 Web 应用程序中看到的一些最好的键盘支持。

这显然需要编写大量的 Javascript——我不确定 Joel 是否在任何地方记录了他们的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T13:57:04.153

我问了同样的问题，但得到的答案很少：
[键盘快捷键](https://stackoverflow.com/questions/299776/keyboard-shortcuts)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T14:16:47.873

accesskey html 属性

# html - iframe 被认为是“不好的做法”吗？

> ID：362730
> 
> 赞同：302
> 
> 时间：2008-12-12T13:30:58.450
> 
> 标签：html, iframe, standards

在某个地方，我发现使用 iframe 是“不好的做法”。

这是真的？使用它们的优点/缺点是什么？

* * *

## 回答 #1

> 赞同：235
> 
> 时间：2008-12-12T13:36:58.513

与所有技术一样，它有起有落。如果您使用 iframe 绕过一个适当开发的站点，那么这当然是不好的做法。但是有时 iframe 是可以接受的。

iframe 的主要问题之一与书签和导航有关。如果您使用它只是在您的内容中嵌入一个页面，我认为这很好。这就是 iframe 的用途。

但是，我也看到过 iframe 被滥用。它永远不应用作您网站的组成部分，而应作为网站中的一部分内容。

通常，如果您可以在没有 iframe 的情况下执行此操作，那是一个更好的选择。我相信这里的其他人可能有更多信息或更具体的示例，这一切都归结为您要解决的问题。

话虽如此，如果您仅限于 HTML 并且无法访问 PHP 或 ASP.NET 等后端，有时 iframe 是您唯一的选择。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2008-12-12T13:41:26.757

它们不是坏习惯，它们只是另一种工具，它们增加了灵活性。

用作标准页面元素......它们很好，因为它们是一种将内容分离到多个页面的简单可靠的方法。`iframe`尤其是对于用户生成的内容，将内部页面“沙箱化”到一个不影响主页的糟糕标记中可能很有用。不利的一面是，如果您引入多层滚动（一层用于浏览器，一层用于`iframe`），您的用户会感到沮丧。就像 adzm 所说，您不想使用`iframe`主要导航，而是将它们视为等同于嵌入视频或其他媒体文件的方式的文本/标记。

对于脚本背景事件，通常在隐藏`iframe`和`XmlHttpRequest`加载当前页面内容之间进行选择。不同之处在于`iframe`生成页面加载，因此您可以在大多数浏览器的浏览器缓存中前后移动。请注意，到处使用的 Google在某些情况下`XmlHttpRequest`也使用`iframe`s 来允许用户在浏览器历史记录中前后移动。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-12-12T13:47:11.130

在不了解它们的缺点的情况下使用它们是“不好的做法”。Adzm 的帖子很好地总结了它们。

另一方面，gmail 在后台大量使用 iFrame 来实现一些更酷的功能（例如自动文件上传）。如果您知道 iFrame 的局限性，我认为您不会对使用它们感到内疚。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2010-01-29T16:41:31.487

在许多情况下与他们合作后，我真的开始认为 iframe 是 goto 语句的 Web 编程等价物。也就是说，通常要避免的事情。在站点内，它们可能会有些用处。然而，跨站点，除了最简单的内容之外，它们几乎总是一个坏主意。

考虑可能性......如果用于参数化内容，他们已经创建了一个界面。而在专业站点中，该界面需要 SLA 和版本管理——在急于上网时几乎总是被忽略。

如果用于活动内容 - 承载脚本的框架 - 则存在（不同的）跨域脚本限制。有些可能会被黑客入侵，但很少会始终如一。如果您的框架内容需要交互，那么超出框架将难以做到这一点。

如果与许可内容一起使用，则参与站点需要在主机之间将权利信息移出带外。

因此，尽管它们在站点中偶尔有用，但它们相当不适合混搭。您可以更好地查看真正的门户和 portlet。更糟糕的是，它们是每个网络爱好者的宠儿——许多技术经理都将它们视为解决许多问题的方法。事实上，他们创造了更多。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-06-17T06:16:05.430

根据我的经验，iframe 的**积极方面**是在调用第三方代码时，这可能涉及调用调用 a 的 javascript 具有`Document.write();`命令。您可能知道，由于解析方式（DOM Parser 等），这些命令不能被异步调用。这方面的一个例子是[http://sourceforge.net/projects/phpadsnew/](http://sourceforge.net/projects/phpadsnew/)我已经使用 iframe 来帮助加快我们的网站，因为有多个对 phpadsnews 的调用，并且该网站在继续渲染之前等待响应页面的一部分。使用 iframe，我能够允许网站呈现页面的其他部分，并且仍然`Document.write()`异步调用 ppads 的命令。防止和js锁定。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2010-03-03T15:40:23.947

肯定有 iframe 人的用途。您还会如何将天气网络小部件放在您的页面上？唯一的另一种方法是获取他们的 XML 并解析它，但是当然你需要条件来抛出相关的天气图形……这并不值得，但如果你有时间的话，它会更干净。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-12-13T14:31:13.413

从可用性的角度来看，最初的框架集模型（框架集和框架元素）非常糟糕。IFrame 是后来的发明，它没有原始框架集模型那么多问题，但它确实有其缺点。

如果您允许用户在 IFrame 内导航，则链接和书签将无法按预期工作（因为您为外部页面的 URL 添加了书签，而不是 iframe 的 URL）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-12-12T13:54:52.363

值得注意的是，无论用户的互联网连接速度或 iframe 的内容如何，​​iframe 都会导致页面下载速度出现小幅（0.3 秒左右）但明显减慢。这不是您在本地测试时会看到的。实际上，对于添加到页面的任何元素都是如此，但 iframe 似乎更糟。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-08-05T10:19:14.860

当您的主页以 HTTP 协议加载并且您的部分页面需要以 HTTPS 协议工作时，iFrame 可以轻松击败 jsonp。

特别是，如果您的 dataType 不是原生 json 并且需要在服务器上翻译成 json 并在客户端翻译回例如复杂的 html。

所以不 - iFrame 并不邪恶。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-08-05T10:29:40.400

它们还不错，但实际上很有帮助。前段时间我遇到了一个大问题，我必须嵌入我的 twitter 提要，它只是不允许 md 在同一页面上执行此操作，所以我将它设置在不同的页面上，并将其作为 iframe 放入。

它们也很好，因为所有浏览器（和手机浏览器）都支持它们。只要您正确使用它们，它们就不能被认为是一种不好的做法。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-12-12T13:43:21.420

我已经看到 IFRAME 作为一种制作动态上下文菜单的简单方法非常成功地应用，但该 Web 应用程序的目标受众只是 Internet Explorer 用户。

我会说这完全取决于您的要求。如果您希望确保您的页面在每个浏览器上都能正常运行，请避免使用 IFRAME。如果您的目标受众是狭窄且知名的受众（例如，在本地 Intranet 上）并且您看到使用 IFRAME 的好处，那么我会说这样做是可以的。

# java - 用于双向 I/O 的 Java 数据对象

> ID：362737
> 
> 赞同：3
> 
> 时间：2008-12-12T13:34:27.630
> 
> 标签：java, io

我正在开发一个接口，该接口将加密的字节流（可能是一个非常*大*的字节流）作为输入，生成或多或少相同格式的输出。

输入格式是这样的：

```
{N byte envelope}
    - encryption key IDs &c.
{X byte encrypted body} 
```

输出格式相同。

这是通常的用例（当然是大量伪代码）：

```
Message incomingMessage = new Message (inputStream);

ProcessingResults results = process (incomingMessage);

MessageEnvelope messageEnvelope = new MessageEnvelope ();
// set message encryption options &c. ...

Message outgoingMessage = new Message ();
outgoingMessage.setEnvelope (messageEnvelope);

writeProcessingResults (results, message);

message.writeToOutput (outputStream); 
```

对我来说，使用同一个对象来封装这种行为似乎是有意义的，但我对如何去做这件事有点茫然。一次加载所有加密的正文是不切实际的；我需要能够对其进行流式传输（因此，我将使用某种输入流过滤器对其进行解密），但同时我需要能够写出该对象的新实例。什么是使这项工作的好方法？内部应该是什么`Message`样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T20:42:46.833

我不会创建一个类来处理输入和输出——一个类，一个责任。我想要两个过滤器流，一个用于输入/解密，一个用于输出/加密：

```
InputStream decrypted = new DecryptingStream(inputStream, decryptionParameters);
...
OutputStream encrypted = new EncryptingStream(outputSream, encryptionOptions); 
```

他们可能有类似惰性初始化机制的东西，在第一次调用之前读取信封`read()`/在第一次调用之前写入信封`write()`。您还可以在过滤器实现中使用 Message 或 MessageEnvelope 等类，但它们可能会保留包保护的非 API 类。

该处理对仅在流上工作的解密/加密一无所知。在处理流式处理输入和输出期间，您还可以同时使用两个流进行输入和输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T22:31:58.463

您应该查看有关支持流加密的不同分组密码模式的[Wikipedia 文章](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation)。不同的加密算法可能支持其中的一个子集。

缓冲流将允许您在循环中读取、加密/解密和写入。

演示 ZipInputStream 和 ZipOutputStream 的示例可以为您如何解决此问题提供一些指导。见[例子](http://java.sun.com/developer/technicalArticles/Programming/compression/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T19:33:25.803

我同意[Arne](https://stackoverflow.com/questions/362737/java-data-object-for-bidirectional-i-o#463015)的观点，数据处理器不应该知道加密，它只需要读取消息的解密正文并写出结果，流过滤器应该负责加密。但是，由于这在逻辑上是对同一条信息（一条消息）进行操作，因此我认为它们*应该*封装在一个处理消息格式的类中，尽管加密/解密流确实与此无关。

这是我对结构的想法，稍微翻转架构，并将 Message 类移到加密流之外：

```
class Message {
  InputStream input;
  Envelope envelope;

  public Message(InputStream input) {
    assert input != null;
    this.input = input;
  }

  public Message(Envelope envelope) {
    assert envelope != null;
    this.envelope = envelope;
  }

  public Envelope getEnvelope() {
    if (envelope == null && input != null) {
      // Read envelope from beginning of stream
      envelope = new Envelope(input);
    }
    return envelope
  }

  public InputStream read() {
    assert input != null

    // Initialise the decryption stream
    return new DecryptingStream(input, getEnvelope().getEncryptionParameters());
  }

  public OutputStream write(OutputStream output) {
    // Write envelope header to output stream
    getEnvelope().write(output);

    // Initialise the encryption
    return new EncryptingStream(output, getEnvelope().getEncryptionParameters());
  }
} 
```

现在您可以通过为输入和输出创建一条新消息来使用它：OutputStream 输出；// 这是发送消息的流 Message inputMessage = new Message(input); 消息 outputMessage = new Message(inputMessage.getEnvelope()); 过程（inputMessage.read（），outputMessage.write（输出））；

现在 process 方法只需要从输入中读取需要的数据块，并将结果写入输出：

```
public void process(InputStream input, OutputStream output) {
  byte[] buffer = new byte[1024];
  int read;
  while ((read = input.read(buffer) > 0) {
    // Process buffer, writing to output as you go.
  }
} 
```

现在这一切都在同步进行，您不需要任何额外的线程。您也可以提前中止，而不必处理整个消息（例如，如果输出流已关闭）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T21:35:45.043

What you need is using Cipher Streams ([CipherInputStream](http://java.sun.com/j2se/1.4.2/docs/api/javax/crypto/CipherInputStream.html)). Here is an [example](http://docstore.mik.ua/orelly/java-ent/security/ch13_06.htm) of how to use it.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-02T17:19:24.057

如果您需要同时读取和写入，则必须使用线程（不同的线程读取和写入）或异步 I/O（java.nio 包）。使用来自不同线程的输入和输出流不是问题。

如果你想在java中制作一个流API，你通常应该提供InputStream用于读取和OutputStream用于写入。通过这种方式，可以将它们传递给其他 API，以便您可以链接事物，从而使流一直作为流传输。

输入示例：

```
Message message = new Message(inputStream);
results = process(message.getInputStream()); 
```

输出示例：

```
Message message = new Message(outputStream);
writeContent(message.getOutputStream()); 
```

消息需要使用执行所需加密和解密的类来包装给定的流。

请注意，同时读取多条消息或同时写入多条消息也需要协议的支持。您需要正确同步。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T13:49:33.670

你可以在任意位置分割身体吗？

如果是这样，我将有两个线程，输入线程和输出线程，并有一个输出线程监控的并发字符串队列。就像是：

```
ConcurrentLinkedQueue<String> outputQueue = new ConcurrentLinkedQueue<String>();
...

private void readInput(Stream stream) {
    String str;
    while ((str = stream.readLine()) != null) {
       outputQueue.put(processStream(str));
    }
}

private String processStream(String input) {
    // do something
    return output;
}

private void writeOutput(Stream out) {
    while (true) {
        while (outputQueue.peek() == null) {
            sleep(100);
        }

        String msg = outputQueue.poll();
        out.write(msg);
    }
} 
```

注意：这肯定不会按原样工作。只是一个设计建议。欢迎有人对此进行编辑。

# iis-6 - IIS6.0 应用程序池

> ID：362739
> 
> 赞同：0
> 
> 时间：2008-12-12T13:34:54.463
> 
> 标签：iis-6, application-pool

无论如何如何在不浏览每个网站并检查其分配的池的情况下检查哪个网站正在与该池一起使用？

我有大约 35 个网站，我不能一个一个地浏览这些网站....

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T13:41:42.843

在 IIS 管理器 MMC 中，您可以看到应用程序池节点并查看每个应用程序池，或者您可以打开每个站点的属性并查看分配给它的应用程序池。

还有一些技巧可用于管理应用程序池，如果您正在寻找这些技巧，我可以挖掘这些技巧。

你不应该“浏览”这些网站来看看什么是什么，除非我不明白你的意思。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T13:42:10.533

下拉 inetmgr 中的应用程序池 - 所有网站都应该列在下面（它们在我的服务器上）...

# java - Java 内存模型 - 有人可以解释一下吗？

> ID：362740
> 
> 赞同：31
> 
> 时间：2008-12-12T13:35:13.637
> 
> 标签：java, concurrency

多年来，我一直试图理解Java 规范中处理内存模型和并发的[部分。](http://java.sun.com/docs/books/jls/third_edition/html/memory.html#17.4)我不得不承认我失败得很惨。是的'我了解锁和“同步”以及等待（）和通知（）。我可以很好地使用它们，谢谢。我什至对“易失性”的作用有一个模糊的概念。但所有这些都不是来自语言规范——而是来自一般经验。

这是我要问的两个示例问题。我对特定答案不太感兴趣，因为我需要了解答案是如何从规范中得出的（或者可能是我如何得出规范没有答案的结论）。

*   “易失性”到底是做什么的？
*   写入变量是原子的吗？它取决于变量的类型吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-12-12T13:52:06.580

我不会在这里尝试实际回答您的问题 - 相反，我会将您重定向到我看到推荐的关于该主题的建议书：[Java Concurrency in Practice](https://rads.stackoverflow.com/amzn/click/com/0321349601)。

一句话警告：如果这里*有*答案，预计其中有不少是错误的。我不打算发布详细信息的原因之一是因为我很确定至少在某些方面*我会弄错。*当我说每个认为他们可以回答这个问题的人实际上有足够的严谨性来正确回答这个问题时，我的意思是对社区没有任何不尊重。（Joe Duffy 最近发现了一些令人惊讶的 .NET 内存模型。如果他能弄错，那么像我们这样的凡人也可以。）

* * *

我将仅就一个方面提供一些见解，因为它经常被误解：

波动性和原子性是有区别的。人们通常认为原子写入是易失的（即，如果写入是原子的，则无需担心内存模型）。这不是真的。

波动性是关于一个线程执行读取（逻辑上，在源代码中）是否会“看到”另一个线程所做的更改。

原子性是关于是否有可能如果看到更改，*则*只会看到部分更改。

例如，写入一个整数字段。这保证是原子的，但不是易失的。这意味着如果我们有（从 foo.x = 0 开始）：

```
Thread 1: foo.x = 257;
Thread 2: int y = foo.x; 
```

可能`y`是 0 或 257。由于原子性约束，它不会是任何其他值（例如 256 或 1）。但是，即使您知道在“墙上时间”中线程 2 中的代码在线程 1 中的代码之后执行，也可能存在奇怪的缓存、内存访问“移动”等。使变量`x`volatile 可以解决这个问题。

我会把剩下的留给真正的诚实的专家。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-12T14:04:35.167

*   非`volatile`变量可以在线程本地缓存，因此不同的线程可能同时看到不同的值；`volatile`防止这种情况（[来源](http://www.javamex.com/tutorials/synchronization_volatile.shtml)）
*   写入 32 位或更小的变量保证是原子的（[隐含在这里](http://java.sun.com/docs/books/jvms/second_edition/html/Threads.doc.html#22244)）；和并非如此`long`，`double`尽管 64 位 JVM 可能将它们实现为原子操作

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-12T13:41:14.137

我不会尝试在这里解释这些问题，而是请您参考 Brian Goetz 关于该主题的优秀书籍。

这本书是“Java Concurrency in Practice”，可以在[亚马逊](https://rads.stackoverflow.com/amzn/click/com/0321349601)或任何其他分类良好的计算机文献商店找到。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-12T14:19:01.567

这是一个很好的链接，可以为您提供一些深入的信息：

[http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html](http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-16T14:51:07.907

我最近发现[了一篇出色的文章](http://jeremymanson.blogspot.com/2008/11/what-volatile-means-in-java.html)，将 volatile 解释为：

> 首先，您必须对 Java 内存模型有所了解。多年来，我一直在努力简单而准确地解释它。到今天为止，我能想到的最好的描述方式就是如果你这样想象：
> 
> *   Java 中的每个线程都发生在一个单独的内存空间中（这显然是不真实的，所以请耐心等待）。
>     
>     
> *   您需要使用特殊机制来保证这些线程之间发生通信，就像在消息传递系统上一样。
>     
>     
> *   在一个线程中发生的内存写入可能会“泄漏”并被另一个线程看到，但这绝不是保证。如果没有明确的通信，您无法保证其他线程可以看到哪些写入，甚至无法保证看到它们的顺序。
>     
>     
> 
> Java volatile 修饰符是保证线程之间发生通信的特殊机制的一个示例。当一个线程写入 volatile 变量，而另一个线程看到该写入时，第一个线程将告诉第二个内存的所有内容，直到它执行对该 volatile 变量的写入。

附加链接：http: [//jeremymanson.blogspot.com/2008/11/what-volatile-means-in-java.html](http://jeremymanson.blogspot.com/2008/11/what-volatile-means-in-java.html) [http://www.javaperformancetuning.com/news/qotm030.shtml](http://www.javaperformancetuning.com/news/qotm030.shtml)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-07T16:23:17.607

上面的其他答案是绝对正确的，因为您的问题不是假装的。

但是，我理解您对真正想要了解底层内容的痛苦——为此，我将向您指出世界上的编译器和 Java 的低级前辈——即汇编、C 和 C++。

阅读不同类型的障碍（“栅栏”）。了解什么是内存屏障，以及它在哪里是必要的，将帮助您直观地掌握 volatile 的作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T15:04:51.223

一个概念可能会有所帮助：数据（基准）和副本。

如果你声明一个变量，比如说一个字节，它驻留在内存的某个地方，在一个数据段中（粗略地说）。内存中有 8 位专门用于存储该信息。

但是，可以有多个该数据的副本，在您的机器中移动。由于各种技术原因，例如线程的本地存储、编译器优化。如果我们有多个副本，它们可能不同步。

所以你应该永远记住这个概念。这不仅适用于 java 类字段，而且适用于 cpp 变量、数据库记录（记录状态数据被复制到多个会话等）。变量、它们的隐藏/可见副本和微妙的同步问题将永远存在。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-19T15:48:28.823

另一次尝试提供我从这里的答案和其他来源的答案中理解的内容的摘要（第一次尝试离基地很远。我希望这个更好）。

Java 内存模型是将一个线程中写入内存的值传播到其他线程，以便其他线程在从内存中读取时可以看到它们。

简而言之，如果您获得了对互斥锁的锁定，那么之前释放该互斥锁的任何线程编写的任何内容都将对您的线程可见。

如果您读取 volatile 变量，则在读取之前写入该 volatile 变量的任何内容对读取线程都是可见的。此外，在写入变量之前写入变量的线程对 volatile 变量的任何写入都是可见的。此外，在 Java 1.5 中，在写入 volatile 变量之前发生在写入 volatile 变量的任何线程上的任何写入，无论是否 volatile，都将对您可见。

对象构造完成后，可以将其传递给另一个线程，所有最终成员都将可见并在新线程中完全构造。对于非最终成员，没有类似的保证。这让我认为对最终成员的赋值相当于对 volatile 变量（内存栅栏）的写入。

线程在其 Runnable 退出之前写入的任何内容对于执行 join() 的线程都是可见的。线程在执行 start() 之前写入的任何内容都将对生成的线程可见。

另一件要提的事情：易失性变量和同步有一个很少被提及的功能：除了刷新线程缓存和提供一次一个线程的访问之外，它们还可以防止编译器和 CPU 重新排序跨同步边界的读取和写入。

这些都不是新的，其他答案更好地说明了这一点。我只是想写下这个来理清头绪。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-14T18:41:49.640

这使用城市（线程）和行星（主内存）来解释它。

[http://mollypages.org/tutorials/javamemorymodel.mp](http://mollypages.org/tutorials/javamemorymodel.mp)

从一个城市到另一个城市没有直飞航班。

你必须先去另一个星球（在这种情况下是火星），然后去你家乡星球上的另一个城市。所以，从纽约到东京，你必须去：

纽约 -> 火星 -> 东京

现在用 2 个线程替换 NYC 和 Tokyo，用主内存替换 Mars，将航班替换为获取/释放锁，你就有了 JMM。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-12-20T16:24:04.313

**JVM内存模型**

高级图

![](https://i.stack.imgur.com/O9Smp.png)

代码示例

```
class MainClass {
    void method1() { //<- main
        int variable1 = 1;
        Class1 variable2 = new Class1();

        variable2.method2();
    }
}

class Class1 {
    static Class2 classVariable4 = new Class2();
    int instanceVariable5 = 0;
    Class2 instanceVariable6 = new Class2();

    void method2() {
        int variable3 = 3;
    }
}

class Class2 { } 
```

*笔记：

*   `thread stack`仅包含**局部变量**
*   成员（类和实例变量）`heap`即使是基元也被存储

> “易失性”到底是做什么的？

[[Java易失性]](https://stackoverflow.com/a/59498520/4770877)

> 写入变量是原子的吗？它取决于变量的类型吗？

[[原子变量]](https://stackoverflow.com/a/65382071/4770877)

[[局部变量的Java线程安全]](https://stackoverflow.com/a/59521281/4770877)

# javascript - 如何使用 Javascript 构建无限可扩展的表单？

> ID：362748
> 
> 赞同：0
> 
> 时间：2008-12-12T13:40:56.480
> 
> 标签：javascript, html, dom

我有一个产品注册表单，允许用户通过单击“添加产品”来添加其他产品字段。当用户单击添加产品时，Javascript 在现有 div 中创建新的产品字段。

我目前允许在表单上添加多达 10 个产品，所以我设置了一个这样的 div 结构：

```
<div id="product1"></div>
<div id="product2"></div>
<div id="product3"></div> etc... 
```

对于用户可能添加的每个产品框，我都有一个空 div。我使用 Javascript 的 innerHTML 方法来填充 div。

关于我的问题：如何允许一次添加无限数量的产品？显然，我当前的设置不支持这一点，因为我需要为每个潜在产品硬编码单独的 div，因此 Javascript 有一个特定的位置来删除更多数据。

注意：在有人建议使用单个 div 并将新数据附加到其中之前，这是行不通的。可悲的是，每当通过附加数据将另一个字段添加到 div 时，在先前字段中输入的所有数据都会被清除，如下所示：

```
document.getElementById('product').innerHTML += <input name="product"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T13:47:42.423

您可以轻松地动态添加更多 DIV。我使用[原型](http://prototypejs.org)：

```
$("someContainerDiv").insert(new Element("div", { id: "product_"+prodId, 'class':'prod' })) 
```

然后把你的内容放进去`$("product_"+prodId).innerHTML`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T13:53:57.030

我只想说[jQuery](http://jquery.com) :)

示例（为您的表单动态构建输入）：

```
output = '';
for(i in products){
   output += '<div id="product_' + products[i].id + '">';
   output += '<input type="text" name="products[' + products[i].id + '][name]">';
   output += '<input type="text" name="products[' + products[i].id + '][price]">';
   output += '</div>';
}
$('#products_list').append(output); 
```

# c - realloc 和 memcpy 是如何工作的？

> ID：362760
> 
> 赞同：27
> 
> 时间：2008-12-12T13:43:13.073
> 
> 标签：c, memory-management, realloc

我有两个问题。

1.  `realloc()`以比仅迭代每个元素更快的方式将数组中的`memcpy()`条目复制到另一个数组中吗`O(N)`？如果答案是肯定的，那么您认为它的复杂性是什么？

2.  如果分配的大小小于原始大小，是否`realloc()`将条目复制到其他地方，或者在它们减小数组大小时将它们保留？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-12T14:28:33.123

1 - 不。他们一次复制一个块。请参阅[http://www.embedded.com/design/configurable-systems/4024961/Optimizing-Memcpy-improves-speed](http://www.embedded.com/design/configurable-systems/4024961/Optimizing-Memcpy-improves-speed)以获得很好的分析。

2 - 这取决于实现。有关 glibc 的详细信息，请参阅[http://www.gnu.org/software/libtool/manual/libc/Changing-Block-Size.html](http://www.gnu.org/software/libtool/manual/libc/Changing-Block-Size.html)。“在几种分配实现中，有时需要将块变小以复制它”

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-27T04:19:34.363

让我们更仔细地看一下`memcpy`“大 O”或朗道符号。

首先，大O。正如我在别处谈到的，值得记住大 O 的定义，即当存在一个常数*k时，某个函数**g(n)*被称为*O(f(n))*，其中*g(n)* ≤ *kf(n)*。常量的作用是让您忽略小细节，转而关注重要部分。正如每个人都注意到的那样，在大多数正常架构中，*n*字节的 O(n) 将是*O(n)*，因为无论你必须移动这些*n*字节，一次一个块。因此，可以编写 C 中的第一个简单的实现***`memcpy`***`memcpy`******

 ***```
unsigned char *
memcpy(unsigned char * s1, unsigned char * s2, long size){
    long ix;
    for(ix=0; ix < size; ix++)
        s1[ix] = s2[ix];
    return s1;
} 
```

这实际上是*O(n)*，并且可能会让您想知道为什么我们还要为库例程而烦恼。然而，关于*libc*函数的事情是它们是编写特定于平台的实用程序的地方；如果您想针对架构进行优化，这是您可以做到的地方之一。因此，*根据架构*，可能会有更高效的实现选项；例如，在 IBM 360 架构中，有一条`MOVL`指令使用高度优化的微码移动大块数据。因此，代替那个循环，memcpy 的 360 度实现可能看起来像

```
LR 3,S1      LOAD S1 ADDR in Register 3
LR 4,S2      
MOVL 3,4,SIZE 
```

（顺便说一句，不能保证这是完全正确的 360 代码，但它可以用作说明。）这个实现*看起来*不像 C 代码那样在循环中执行*n*步，它只执行 3 条指令。

然而，*真正*发生的是它在幕后执行*O(n) 微指令*。两者的*不同*之处在于常数*k*；因为微码要快得多，并且因为指令上只有三个解码步骤，所以它比原始版本快得多，但它仍然是*O* *(n)* - 它只是常数更小。

这就是为什么您可以充分利用它的原因`memcpy`——它并不是渐进地更快，但实现速度与某人*在该特定架构上*实现的速度一样快。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-12T14:02:16.390

1.  绝对没有办法比 O(N) 更快地复制 N 个项目。但是，它可能能够一次复制多个项目，或者使用特殊的处理器指令——所以它仍然可能比你自己做的要快。
2.  我不确定，但我假设内存已完全重新分配。这是最安全的假设，无论如何它可能取决于实现。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-12T14:04:23.733

1.  的性能`memcpy`确实不能比 O(N) 好，但可以对其进行优化，使其优于手动复制；例如，它可能能够在您复制 1 个字节的时间内复制 4 个字节。许多`memcpy`实现是使用优化指令以汇编形式编写的，这些指令可以一次复制多个元素，这通常比一次复制一个字节的数据要快。

2.  我不太明白这个问题，如果你`realloc`用来减少内存大小并且它成功（返回非NULL），新位置将包含与旧位置相同的数据，直到新请求的大小。如果由于调用而更改了内存位置`realloc`（在减小大小时不常见），则将复制内容，否则由于内存没有移动，因此不需要进行复制。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T19:35:38.177

1.  可以推测，memcpy 可以这样写，它会移动大量的位。例如，如果有利的话，完全可以使用 SSE 指令复制数据。

正如其他人所说，它不会比 O(n) 快，但内存系统通常有一个首选的块大小，并且还可以一次写入一个高速缓存行的大小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-27T02:21:34.960

假设您正在谈论 glibc，并且由于您的问题取决于实现，因此最好只检查源代码：

[malloc.c](http://sourceware.org/cgi-bin/cvsweb.cgi/libc/malloc/malloc.c?rev=1.190&content-type=text/x-cvsweb-markup&cvsroot=glibc)

[memcpy.c](http://sourceware.org/cgi-bin/cvsweb.cgi/libc/string/memcpy.c?rev=1.1&content-type=text/x-cvsweb-markup&cvsroot=glibc)

我读它的方式，答案是：

1.  O(N) --- 没有办法比线性时间更好地复制项目。
2.  当使用 realloc() 缩小它们时，有时会复制大的项目。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-27T05:51:37.720

x86 具有用于扫描和匹配内存块中的字节/字的特殊指令，以及可用于复制内存块的特殊指令（毕竟它是 CISC cpu）。许多实现内联汇编语言和编译整个函数的编译器的 C 编译器多年来一直在其库函数中利用这一点。

用于 mem 复制的是 movsb/movsw 与 rep 指令的组合。

```
CMPS/MOVS/SCAS/STOS
REP, REPE, REPNE, REPNZ, REPZ 
```

使用 src/trg 地址和 int 计数设置寄存器，然后就可以了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-18T03:13:00.487

与 realloc 相关的一些要点（检查 dev c++）： void *realloc(void *ptr, size_t size);

1.  realloc() 函数应将 ptr 指向的内存对象的大小更改为 size 指定的大小。

2.  对象的内容应保持不变，直至新旧尺寸中的较小者。

3.  如果新大小更大，则未指定对象新分配部分的内容。

4.  如果 size 为 0 且 ptr 不是空指针，则释放指向的对象。

5.  如果 ptr 是空指针，realloc() 应等效于指定大小的 malloc()。

6.  如果 ptr 与 calloc()、malloc() 或 realloc() 先前返回的指针不匹配，或者如果空间先前已通过调用 free() 或 realloc() 释放，则行为未定义。

# visual-studio - VS2008：为不是解决方案中的活动项目的项目启动可执行文件

> ID：362763
> 
> 赞同：0
> 
> 时间：2008-12-12T13:43:50.683
> 
> 标签：visual-studio, visual-studio-2008

在 VS2008 中，是否可以为解决方案中不是活动项目的项目启动可执行文件？（即它的名字不是粗体）。

不调试它 - 只是启动它。据我所知，您只需进入 Windows 资源管理器并双击 .exe！我是否缺少菜单项或快捷方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T14:05:35.697

您可以右键单击项目进行调试。右键单击项目 -> 调试 -> 启动新实例。

**编辑：**我不确定在调试模式之外执行此操作的方法。这基本上就是“活动项目”的设施的用途。我通常设置活动项目，然后使用 Shift+F5 启动应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T03:23:07.843

1.  右键单击您的解决方案并选择**Properties**。
2.  选择**通用属性**>**启动项目**。
3.  选择**多个启动项目**。
4.  在您要运行的那个旁边，它显示 None ，将其更改为**Start without debugging**。

这样做是你想要的吗？

# visual-studio - 安装 TFS Powertools 后出现 VS2008 错误

> ID：362764
> 
> 赞同：3
> 
> 时间：2008-12-12T13:44:25.800
> 
> 标签：visual-studio, visual-studio-2008, tfs

我在 VS2008 中偶尔会遇到一个奇怪的错误。一位同事遇到了类似的错误，我们都在安装 TFS PowerToys 后注意到了它，所以我想知道它是否相关。

无论如何，错误是：

由于以下错误，Team Foundation 错误检索具有 CLSID{GUIID...} 的组件的 COM 类工厂失败：80040154，

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-10-29T13:46:18.240

Team Explorer 具有协作功能，可以与 Windows Live Messenger 或 Office Communicator 进行交互。如果您卸载了这些，您可能会从团队资源管理器尝试与不存在的程序对话时收到相同的错误。在团队资源管理器中，右键单击团队成员，单击个人设置。在协作下，单击更改并选择（如果您愿意，也可以将其提供给其他提供商）。

这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T17:55:10.813

TFS Power 工具安装了一些能够通知使用 MSN Messenger 的开发人员的东西，这个错误是由 MSN Messenger 引起的。也许这应该有助于[MSN Messenger 错误 80040111 和 80040154](http://msn-errors.blogspot.com/2006/11/msn-messenger-errors-80040111-and.html)

> 修复 80040111 和 80040154 错误。
> 
> 原因：MSXML 库可能已损坏，可能必须重新安装
> 
> 故障排除步骤：
> 
> 步骤 1\. 重新注册 msxml3.dll
> 
> *   单击开始菜单，选择运行并键入以下内容：
>     **Regsvr32 %windir%\system32\msxml3.dll**
> 
> 希望您会看到一个窗口弹出窗口，上面写着：
> **DllRegisterServer succeeded in C:\Windows\System32\msxml3.dll is succeeded。**
> 
> 步骤 2\. 重新启动计算机并再次登录 Messenger

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T13:11:57.920

我们最近在我的工作场所从 SourceSafe 更改为 TFS，我们中的很多人不得不在 VS2008 中重新安装 SP1 以使 Powertools 和 TFS 正常工作。这是否与您的问题有关，但我不确定......它似乎确实为我清除了几个奇怪的错误。

# java - 从基类继承的接口是否应该在子类中显式实现？

> ID：362770
> 
> 赞同：14
> 
> 时间：2008-12-12T13:45:58.887
> 
> 标签：java, interface, contract

我的问题是，如果通过扩展已经实现它的类隐式实现的接口应该由该类显式实现，如果该类想要宣传这样一个事实，即它履行了该接口的合同。

例如，如果你想编写一个类，它会满足接口的约定`java.util.List`。你实现这个，扩展`java.util.AbstractList`已经实现接口的类`List`。您是否明确声明您实现了 List？

```
public class MyList extends AbstractList implements List 
```

或者您是否使用隐式方式节省打字？

```
public class MyList extends AbstractList 
```

哪种方式被认为是更好的风格？你有什么理由偏爱一种或另一种方式？在哪些情况下您更喜欢方式 1 或方式 2？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-12T13:47:27.900

避免冗余。使用方法2。

使用 @Override 进行覆盖。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-12T13:48:31.050

这不是一个“风格”问题。如果要扩展已经实现 List 的 AbstractList，则不需要显式实现 List。

这不仅仅是节省打字的问题。由于额外的“实现列表”是多余的，有人可能会花一些时间试图弄清楚它为什么存在。你本质上是在写一个已经是语言一部分的保证。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-13T04:07:09.913

我很久以前在我的博客上问[过同样的问题](http://tech.puredanger.com/2007/03/30/java-inheritance-question/)。如果您有兴趣了解其他人的想法，那里也有很长的讨论。有趣的是，这两种策略都是在 JDK 中采用的。

我最终决定，在这方面的硬性规则没有意义——最好对我想要传达的内容做出最佳判断。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T00:25:36.437

如果您关心您的类的用户能够通过 Class.getInterfaces() 获取已实现接口的列表，那么您的类应该在其实现列表中提及所有接口。Class.getInterfaces() 不会返回超类实现的接口。以下程序将打印 1，然后打印 0。

```
import java.io.Serializable;

class Test implements Serializable {
    class Inner extends Test {
    }

    public static void main(String[] argv) throws Exception {
        System.out.println(Test.class.getInterfaces().length);
        System.out.println(Inner.class.getInterfaces().length);
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T13:55:21.520

我会说更逐字的方式。为什么要让其他阅读您的代码的人必须查找类实现的内容？它清楚地说明了您的类的继承功能。但我会尽量保持项目中所有代码的一致性。如果你只在一个地方做这将是令人困惑的，但如果你一直这样做，他们就会意识到冗余。

旁注：Java 中有这么多类，谁知道它们？更何况，谁知道每个类从哪些类实现？你多打字几秒钟就可以为其他开发人员节省一两分钟的看课时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T15:43:25.047

其他评论者说你应该避免冗余，我同意他们的观点。

为了回答一般性问题，我能想到的同时说明两者的唯一情况是，如果您扩展（比如说）AbstractFrotzer 并实现了 Frobner，AbstractFrotzer 实现了 Frobner，但您有理由相信它可能不会在未来发生。如果 AbstractFrotzer 是真正抽象的，那么它甚至可能不会实现 Frobner 的所有方法本身。这意味着某人可以更改 AbstractFrotzer 的合同，而无需更改您的类或任何其他依赖于您的类的代码成为 Frobner。但是，我认为这是一种非常罕见的情况，即使它发生并且您的类只扩展了 AbstractFrotzer，也很容易对其进行快速语义检查，并在必要时向其中添加 implements 子句那一点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-13T22:15:35.767

虽然我通常坚持选项 2，但我会坚持认为选项 1 在适用的更多情况下实际上是合适的。

代码的可用性和可理解性很重要。我们必须问自己的问题是，使用或看到对此类的引用的开发人员是否会直观地理解该类实现了该接口（因此本质上是一个子类型）。

在典型情况下编写良好的类中，类的名称应该清楚地表明它实现了接口。添加接口只是一个冗余。

**但是**，如果类名不能清楚地表明它实现了哪些接口，并且尽管有异味，事情就是这样，而且这是会卡住的名称，**那么**添加实现以明确指示接口是有意义的. 如果将来有人更改层次结构，这也很好，这在像这样不直观的继承中是可能的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-09-30T14:53:50.670

虽然在子类中实现接口是多余的，但实现它是一个好习惯。因为有人可能会从超类中删除已实现的接口。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-07-07T11:37:05.673

如上面的答案所述，无需明确执行此操作。

但有时，你神秘地*不得不这样做*。我有一些库，其中包含用于 JIRA 插件开发的类和类：

```
public abstract class Condition extends AbstractWebCondition 
```

实现失败，直到我在类声明中明确添加“实现 com.atlassian.plugin.web.Condition”（尽管[AbstractWebCondition](https://docs.atlassian.com/software/jira/docs/api/7.13.18/com/atlassian/jira/plugin/webfragment/conditions/AbstractWebCondition.html)确实实现了它）。幸运的是在[这里](https://community.developer.atlassian.com/t/updating-plugin-compatibility-for-jira-7-4-x/8486/3)找到了解决方案。

我不知道这种行为的起源，但我们到了。从 JIRA 7.0.0 更新到 JIRA 7.13.18 时观察到。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-12T13:50:07.037

当您扩展 AbstractList 时，MyList 已经属于“类型”List，因此无需显式统计（或实现）接口。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-13T22:09:37.790

作为一般规则，使用选项 2，而不是选项 1。

在绝大多数情况下，选项 1 不会为开发人员或将要维护代码的人提供任何附加值。

如果有人真的想知道某个特定类的所有*根源*，那么任何 IDE 都应该能够为您做到这一点，直截了当。(Eclipse: ctrl+shift+G)

如果 AbstractList 决定不再实现 List 怎么办？绝大多数*普通*班级不会发生这种情况。其他不太明显（不太*值得信赖*）的呢？当然也有例外，但很少（<1%？）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-11T21:35:49.713

正如你们中的许多人已经指出的那样，我以前见过这种情况，但在技术上感觉并不正确。我认为这应该是显而易见的，但是如果由于某种原因不是我认为通过类注释指示继承而不是再次显式实现接口更有意义。

如果基类实现了多个接口怎么办？然后，您是否显式实现所有这些接口，并一直备份继承链？显然不是，所以我认为这种做法的不一致证明自己是错误的。可以通过多种方式传达意图，恕我直言，这不是最好的方法。

# ajax - 您可以将动态数据发送到处理小程序吗？

> ID：362773
> 
> 赞同：1
> 
> 时间：2008-12-12T13:46:42.410
> 
> 标签：ajax, dynamic, applet, processing, data-driven

我有一个从数据库中提取数据的 ajax 页面。我想添加一个[处理](http://www.processing.org/)小程序来可视化数据，但我不知道如何随着数据的变化更新可视化。这个想法是能够将新数据推送到可视化中。

我不受处理技术的束缚，任何事情都会奏效。处理似乎是让它看起来不错的最简单方法。感谢您的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T01:59:22.323

最简单的方法是构建您自己的 XML 结构（如果需要，base64 编码二进制数据）并在您的小程序中添加一个计时器以从服务器检索更新（通过 HTTP 请求）。如何准备和处理 XML 取决于您。

小程序对于可视化来说有点重，所以如果同样的事情可以在 Flash 中完成，我建议使用它。Flash 还支持 HTTP 请求（或者您可以让 javascript 处理它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T14:38:59.013

我不确定如何促进两者之间的通信，但作为一种可能的选择，您可以查看[processing.js](http://ejohn.org/blog/processingjs/)，它是用 javascript 实现的处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T15:02:13.773

小程序在自己的沙箱中运行。查看 java.net.URL 和 java.net.HttpURLConnection 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T14:08:32.693

您可以从 java 小程序发出 http 请求。不过，我对处理小程序一无所知。

# eclipse - Subclipse and Tortoise SVN together

> ID：362784
> 
> 赞同：10
> 
> 时间：2008-12-12T13:48:02.970
> 
> 标签：eclipse, svn, subclipse, plugins

Can these two SVN clients collaborate? I have my projects checked out with Tortoise, but now I would like to be able to use the SVN functionality (mostly updating and committing) from inside Eclipse. But the Subcipse doesn't see the SVN status of the files checked out by Tortoise.

I'm doing similar with Tortoise and MSVS plugin Ankh SVN and it works great. But now I need it to work in Eclipse...

Thanks

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-03T03:32:01.810

They work great together.

The one caveat: Make sure they're both using the same underlying subversion revision! Subversion updates it's directories and reformats the .svn directories the first time you run a revision with major updates. What this means is that when you upgrade you have to be careful that both subeclipse and tortoise have released new versions with the matching underlying subversion updates.

Since I've been using both, there have been two updates that break the compatability with the underlying .svn directories, so do be careful!

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T14:08:14.740

When you check code out of Subversion to create a "sandbox", the directories all contain meta-data in the .svn directory. Any client you try to use against the "sandbox" will (assuming the client version is not behind the server), read the meta-data and understand the state of the sandbox and how to manage it with respect to the server.

So ... Yes, it will work just fine;)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T13:59:16.660

It works fine for me. Always update both to the latest version, since there might be a problem if the files created by a specific client are incompatible with an earlier version.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-08T09:52:13.843

Watchout for versions as mentioned before. For example Tortoise (1.8.2) requires Subversion 1.10 at Eclipse side. Update site: [http://subclipse.tigris.org/update_1.10.x](http://subclipse.tigris.org/update_1.10.x)

# excel - 使用 VSTO 2008 加载项在 Excel 2007 中将 .NET 方法显示为 UDF

> ID：362788
> 
> 赞同：2
> 
> 时间：2008-12-12T13:48:59.893
> 
> 标签：excel, vsto

我们有一个现有的加载项，我们通过单击一次发布给用户。我们现在想使用它作为一种工具，将我们现有的一些 C# 方法直接发布到 Excel 中，以便用户可以将它们称为 UDF。

例如 - 我有一个名为 MyAssembly 的程序集，它有一个名为 MyClass 的类和一个名为 MyMethod 的公共方法。我还有一个 excel 插件，它为一些自定义功能添加了一些项目到功能区。我现在想用我现有的插件发布 MyAssembly，这样安装了插件的人就可以在单元格中输入 =MyMethod 并运行我的自定义方法。

怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T12:00:27.293

我通过使用 ExcelDna 非常全面地解决了这个问题，这是一个开源 XLL 实现，使用起来非常简单，并且几乎避免了整个 COM 崩溃。到目前为止，它完全符合我们的要求......

[http://groups.google.com/group/exceldna](http://groups.google.com/group/exceldna)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T14:22:47.690

你对你想做的事情并不是很冗长。“用户可以打电话给他们”是什么意思？

如果您的意思是应该向 VBA 公开加载项方法，您可以在此处找到两篇关于此的文章：

*   [http://blogs.msdn.com/andreww/archive/2008/08/13/comaddins-race-condition.aspx](http://blogs.msdn.com/andreww/archive/2008/08/13/comaddins-race-condition.aspx)
*   [http://blogs.msdn.com/andreww/archive/2008/08/11/why-your-comaddin-object-should-derive-from-standardolemarshalobject.aspx](http://blogs.msdn.com/andreww/archive/2008/08/11/why-your-comaddin-object-should-derive-from-standardolemarshalobject.aspx)

# c# - 确定应用程序根目录的最佳方法是什么？

> ID：362790
> 
> 赞同：58
> 
> 时间：2008-12-12T13:49:26.773
> 
> 标签：c#, .net, winforms

我需要在我的应用程序根目录中获取所有 dll。最好的方法是什么？

```
string root = Application.StartupPath; 
```

或者，

```
string root = new FileInfo(Assembly.GetExecutingAssembly().Location).FullName; 
```

在那之后，

```
Directory.GetFiles(root, "*.dll"); 
```

哪种方式更好？有没有更好的方法？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-12-12T14:04:29.690

`AppDomain.CurrentDomain.BaseDirectory`是我这样做的方式。

然而：

`Application.StartupPath`获取可执行文件的目录

`AppDomain.BaseDirectory`获取用于解析程序集的目录

由于它们可能不同，也许您想使用 Application.StartupPath，除非您关心程序集解析。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-12T14:10:34.280

这取决于。如果您想要启动应用程序的 EXE 目录，那么您的两个示例中的任何一个都可以使用。但请记住，.NET 非常灵活，可能是另一个应用程序已链接到您的 EXE 并正在调用它，可能来自另一个目录。

这种情况不会经常发生，如果发生了你可能会写，但这是可能的。因此，我更喜欢指定我感兴趣的程序集并从中获取目录。然后我知道我将所有 DLL 都放在与该特定程序集相同的目录中。例如，如果您有一个应用程序 MyApp.exe，其中有一个类 MyApp.MyClass，那么您会这样做；

```
string root = string.Empty;
Assembly ass = Assembly.GetAssembly( typeof( MyApp.MyClass ) );
if ( ass != null )
{
   root = ass.Location;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-09-02T17:29:33.753

这是一个老问题，但我一直使用：

```
Environment.CurrentDirectory = Path.GetDirectoryName(Process.GetCurrentProcess().MainModule.FileName); 
```

但是，看看这里的解决方案，我认为需要进行一些简单的测试：

```
var r = new List<long>();
var s = Stopwatch.StartNew();

s.Restart();
string root1 = Application.StartupPath;
r.Add(s.ElapsedTicks);

s.Restart();
string root2 = Path.GetDirectoryName(Process.GetCurrentProcess().MainModule.FileName);
r.Add(s.ElapsedTicks);

s.Restart();
string root3 = Path.GetDirectoryName(new FileInfo(Assembly.GetExecutingAssembly().Location).FullName);
r.Add(s.ElapsedTicks);

s.Restart();
string root4 = AppDomain.CurrentDomain.BaseDirectory;
r.Add(s.ElapsedTicks);

s.Restart();
string root5 = Path.GetDirectoryName(Assembly.GetAssembly( typeof( Form1 ) ).Location);
r.Add(s.ElapsedTicks); 
```

蜱的结果：

*   49
*   306
*   166
*   26
*   201

所以这似乎`AppDomain.CurrentDomain.BaseDirectory`是要走的路。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-05T10:52:38.630

如果要获取应用程序根文件夹路径，请使用以下代码示例。

```
string path =new DirectoryInfo(Environment.CurrentDirectory).Parent.Parent.FullName 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-22T17:26:23.080

我用

`Path.GetDirectoryName(new Uri(Assembly.GetEntryAssembly().CodeBase).LocalPath)`

如果您使用卷影复制，则 Assembly.Location 将指向卷影副本，因此使用 CodeBase 是更好的选择，但 CodeBase 是一个 Url。

# .net - 从 Web 应用程序启动过程

> ID：362791
> 
> 赞同：1
> 
> 时间：2008-12-12T13:49:29.800
> 
> 标签：.net, asp.net, javascript, vb.net, zip

我实际上是在尝试启动一个 winzip 进程并压缩一个文件夹。这是我在 vb 中使用下面的代码。

```
Dim startInfo As New System.Diagnostics.ProcessStartInfo
Dim pStart As New System.Diagnostics.Process
Dim tempFileName As String
Try
    startInfo = New System.Diagnostics.ProcessStartInfo( _
    "c:\Program Files\WinZip\WINZIP32.EXE")
    startInfo.Arguments = " -a -r ""c:\test.zip"" c:\test"
    startInfo.UseShellExecute = False
    startInfo.WindowStyle = Diagnostics.ProcessWindowStyle.Normal

    pStart.StartInfo = startInfo
    'startInfo.WorkingDirectory = "c:\Program Files\WinZip"
    'startInfo.FileName = "WINZIP32.EXE"
    pStart.Start()
    pStart.WaitForExit()

Catch ex As Exception
    Throw
End Try 
```

当它放入 Windows 应用程序的按钮单击事件中时，它工作正常。但是，当在 Web 应用程序的按钮单击事件中执行相同操作时，我可以看到该过程已在机器的任务管理器中启动。但它不会压缩，也不会关闭应用程序，也不会弹出其 winzip ui.... 但在极少数机器上，这确实可以正常工作。在大多数机器中，我都面临着这个问题，并且能够始终如一地重现这个问题......

但是如果我尝试使用 7z zip 做类似的事情，它确实可以从 Web 应用程序本身正常工作......

这个过程有解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T22:02:35.530

我相信 .Net 框架已经内置了 zip 功能。我会先尝试使用这些。由于 Web 服务器上的权限，您的 zip 程序可能没有运行。

编辑

我刚刚检查了一下，System.IO.Compression 中的 zip 支持似乎有限。但根据[这个讨论](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/a343411d-f577-431b-92d7-5792912a7652/)，它可能不是你需要的。然而，该讨论提到了一篇名为“[使用 Windows Shell API 和 C# 解压缩 Zip 文件](http://geraldgibson.net/dnn/Home/CZipFileDecompression/tabid/149/Default.aspx)”的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T13:52:37.173

这可能与运行 IIS 的用户有关；尝试将应用程序池更改为以您的身份运行，看看它是否有效。当然，winzip 是一个 UI 工具——使用命令行 zip 实用程序可能会做得更好... pkzip ;-p

就个人而言，我会考虑改用[#ZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/) - 这将允许您在托管代码中操作 zip 文件。

# regex - 匹配有效正则表达式的正则表达式

> ID：362793
> 
> 赞同：33
> 
> 时间：2008-12-12T13:49:44.527
> 
> 标签：regex

是否有匹配有效正则表达式的正则表达式？

（我知道有几种正则表达式。一种可以。）

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-07-15T20:11:48.213

> 是否有匹配有效正则表达式的正则表达式？

根据定义，这很简单：**不**。

所有正则表达式的语言都不是**正** *则*语言（只看嵌套的括号），因此不能有*正则*表达式来解析它。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-12-13T13:08:55.420

如果您只想检查正则表达式是否有效，只需尝试使用您正在使用的任何编程语言或正则表达式库来编译它。

解析正则表达式绝非易事。作为[RegexBuddy](http://www.regexbuddy.com)的作者，我已经在那个街区转过几次了。如果您真的想这样做，请使用正则表达式来标记输入，并将解析逻辑留给程序代码。也就是说，您的正则表达式一次将匹配一个正则表达式标记（`^`, `$`, `\w`, `(`, `)`, 等），并且您的程序代码将检查它们的顺序是否正确。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-12-12T14:26:56.527

不幸的是，由于括号嵌套错误，大多数无效的正则表达式都是无效的。这正是正则表达式无法匹配的字符串类型。（好吧，一些花哨的正则表达式系统有递归扩展，但这种情况很少见）

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-12T15:50:54.453

如前所述，由于其递归性质，您不能用正则表达式描述正则表达式。你需要一个上下文无关的语法。

但是无论如何，拥有这样一个正则表达式有什么意义呢？如果你只是想检查一个正则表达式是否正确，你可以简单地尝试使用它（Java 中的Pattern.compile(regexp)），如果它尖叫它是无效的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-12T15:37:46.820

您可能需要解析器，而不是正则表达式。正则表达式是强大的工具，但不是解析工具。例如，它们不太适合嵌套语法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-26T22:44:18.480

来自 Douglas Crockford 的*JavaScript 编程语言*视频 4（共 4 个）：

`/\/(\\[^\x00-\x1f]|\[(\\[^\x00-\x1f]|[^\x00-\x1f\\\/])*\]|[^\x00-\x1f\\\/\[])+\/[gim]*/`

[http://video.yahoo.com/watch/111596/1710658](http://video.yahoo.com/watch/111596/1710658)大约在 -17.20。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-12T13:54:36.997

根据你的目标，我肯定会说也许。

如果你想从某个地方过滤掉正则表达式，这可能会很困难，因为正则表达式有各种大小和形状，而且它们并不都以斜杠开头和结尾。

如果您只需要知道正则表达式是否有效，还有另一种方法。根据您使用的语言，您可以尝试/捕获

如果您可以更具体一点，我可以尝试给出更好的答案，这个问题很有趣。

# eclipse-plugin - Force.com IDE - Eclipse 插件不起作用？

> ID：362799
> 
> 赞同：2
> 
> 时间：2008-12-12T13:50:48.020
> 
> 标签：eclipse-plugin, salesforce, apex-code, force.com, force-ide

我是 Apex 的新手，刚刚下载了 Eclipse 开始工作

Eclipse SDK 3.3.2

我已按照说明进行操作

[http://wiki.apexdevnet.com/index.php/Force.com_IDE_Installation_for_Eclipse_3.3.x](http://wiki.apexdevnet.com/index.php/Force.com_IDE_Installation_for_Eclipse_3.3.x)

并添加了远程站点：

[http://www.adnsandbox.com/tools/ide/install/](http://www.adnsandbox.com/tools/ide/install/)

但我得到一个对话框告诉我

“在所选站点上未找到任何功能。请选择其他站点或站点类别”

任何想法我做错了什么？

谢谢

担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T14:24:17.827

从[干净的 eclipse install](http://community.salesforce.com/sforce/board/message?board.id=scontrols&thread.id=1975)尝试该过程，并重复安装步骤，确保在单击“完成”之前取消选中左下角的复选框：“忽略不适用于此环境的功能”。

此外，检查是否可以从您的工作站访问[http://www.adnsandbox.com/tools/ide/install/ 。](http://www.adnsandbox.com/tools/ide/install/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T09:41:53.027

[请通过在任何浏览器中访问“ http://www.adnsandbox.com/tools/ide/install/”URL](http://www.adnsandbox.com/tools/ide/install/)检查您的代理设置，并在 Eclipse 中更新代理设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-01T19:06:45.037

安装最新的 Eclipse Ganymede 并尝试一下。另一个好消息是，force.com 即将发布 Eclipse galileo 插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-14T09:04:45.200

Force.com 现在有一个独立的开发环境，您无需下载 Eclipse。只是把它放在那里给那些偶然发现这篇文章的人。

# python - django 在我的机器上很慢

> ID：362808
> 
> 赞同：18
> 
> 时间：2008-12-12T13:53:04.643
> 
> 标签：python, django, dns

我有一个全新的 django 1.0 安装，从它提供的一个简单页面需要 5 秒才能加载。在我同事的电脑上几乎不需要时间。

我使用启动服务器

```
python manage.py 测试服务器

```

我可以看到每个 GET 请求（PNG 和样式表）大约需要半秒钟。

我认为与之相关的另一件奇怪的事情是，应用程序的功能测试在我使用 MySQL 的机器上运行速度要慢得多（比我同事的机器慢 100 倍）。当我将应用程序设置为使用 sqlite 时，它​​们运行得非常快。我想惊呼 sqlite 并没有太大改变加载页面所需的时间，但它确实加快了服务器启动速度。

看起来像 IO 问题，但至少除了 django 之外，我的机器上没有看到一般的性能问题。

Django 在 python2.4 上运行，我在运行 Vista。我还检查了python2.5。

谢谢 ΤZΩΤZΙΟΥ，这一定是一个 DNS 问题，因为页面加载很快，而不是[http://localhost:8000/app](http://localhost:8000/app)我去[http://127.0.0.1:8000/app](http://127.0.0.1:8000/app)。

但它可能是由什么引起的？我的主机文件只有两个条目：

```
127.0.0.1 本地主机
::1 本地主机

```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-15T14:46:40.337

Firefox 在某些 Windows 机器上浏览 localhost 时出现问题。您可以通过关闭 ipv6 来解决它，这不是真正推荐的。直接使用 127.0.0.1 是解决问题的另一种方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-08-19T14:43:11.203

这些帖子都没有帮助我。在我的具体情况下，[贾斯汀卡莫尼](http://www.justincarmony.com/blog/2011/07/27/mac-os-x-lion-etc-hosts-bugs-and-dns-resolution/)给了我答案。

**问题**

为了便于开发，我在我的 /etc/hosts 文件中将 [hostname].local 映射到 127.0.0.1，并且 dns 请求需要 5 秒才能解决。有时他们会很快解决，有时他们不会。

**解决方案**

Apple 正在使用 .local 在较新的 Snow Leopard 构建（我想我在更新到 10.6.8 后开始注意到它）和 Mac OS X Lion 上做一些 bonjour 魔法。如果您将您的开发主机名更改为以本地开头而不是以本地结尾，那么您应该一切就绪。此外，除了本地之外，您几乎可以使用任何 TLD，并且它可以毫无冲突地工作。

**例子**

test.local 可能变成：

*   local.test.com
*   测试开发
*   测试。[除本地之外的任何内容]

并且您的主机文件条目将显示为：

```
local.test.com  127.0.0.1 
```

*注意：此解决方案具有作为 [hostname].com 的子域的额外好处，这使得为 Facebook API 等指定应用程序域名变得更加容易。*

`dscacheutil -flushcache`更新 /etc/hosts 后，可能还想在终端中运行

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T15:04:52.720

我过去也遇到过同样的问题。可以通过从主机文件中删除以下行来解决。

```
::1         localhost 
```

一旦它消失了，您应该能够快速再次使用 localhost。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T17:41:00.330

由于您报告您朋友的计算机没有延迟，并且我假设您和他的计算机是可比的，这可能是与 DNS 相关的问题。尝试将客户端和服务器的 IP 地址都添加到服务器的 hosts 文件中。

如果你在 *nix 上运行 Django，它就是`/etc/hosts`文件。如果在 MS Windows 上运行它，它就是`%WINDIR%\SYSTEM32\DRIVERS\ETC\HOSTS`文件。（它们是文本文件，可以通过您喜欢的文本编辑器进行编辑。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T14:25:51.163

我认为它是开发服务器，它没有针对速度和安全性进行优化。我注意到专门提供静态文件（即媒体）的速度很慢。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-25T20:07:24.790

也有同样的问题，我在 Vista 和 Windows 7 机器上的 Firefox 上注意到了它。访问开发服务器 127.0.0.1:8000 解决了这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T17:46:33.830

如果所有其他方法都失败了，您始终可以对您的应用程序进行[cProfile](http://docs.python.org/library/profile.html)并查看瓶颈到底在哪里。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-23T08:29:06.863

我有同样的问题，但它是由 mysqld 引起的。

该应用程序在生产环境中使用 wsgi 和 mysql 服务器在同一主机上运行得非常快，但在使用 django runserver 选项和远程 mysql 服务器的开发环境中运行缓慢。

我注意到使用“显示进程列表”时，数据库中的连接卡在用户“未经身份验证的用户”的“登录”状态，这让我注意到身份验证过程中的问题。

寻找真正的问题，我终于注意到mysqld试图获取我的ip的dns名称并禁用名称dns解析，我解决了这个问题。

为此，您可以将此行添加到 my.cnf 文件中：

> 跳过名称解析

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-03-26T12:43:31.140

升级到 Django 1.3 或更新版本。

如果您在 2012 年仍然遇到此问题（使用 Chrome），请确保您正在升级。在 1.3 中，[修复](https://code.djangoproject.com/ticket/16099)了与开发服务器为单线程时速度慢有关的错误。

升级解决了我的问题。我正在运行 Django 1.2，因为这是 Debian Squeeze 的默认设置。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-03-09T08:08:30.503

我这样解决了这个问题：

去`setting.py`设置

```
DEBUG = False 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-12T14:09:54.063

禁用 AV 扫描并查看是否有所不同。它也可能是由 Vista 引起的。升级到最新的服务包，然后重试。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-02-05T18:30:11.603

要在不更改主机文件或 Firefox 中的任何设置的情况下完全绕过 localhost，您可以安装插件[重定向器](https://addons.mozilla.org/en-US/firefox/addon/5064)并制定从 localhost 重定向到 127.0.0.1 的规则。使用这些设置

```
Include pattern : http://localhost*
Redirect to     : http://127.0.0.1$1 
```

将其他字段留空。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-09-30T15:41:17.810

我有同样的问题。

解决方案是：

*   我试图在本地启动一个通常部署在生产网络服务器上的版本。
*   生产中的静态文件由 apache 配置提供，而不是由 django static serve

所以我**只是取消了我的静态服务网址的注释**：/

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-07-25T13:26:32.810

**静态文件加载缓慢**

如果您注意到静态和媒体文件（图像、样式表等）的加载速度特别慢，那么问题可能出在 Django 的开发服务器（`python manage.py runserver`）上。正如[hassen](https://stackoverflow.com/a/362895/5916915)所指出的，该服务器未针对速度进行优化。

您可以尝试使用带有选项的[django-extensions](https://github.com/django-extensions/django-extensions) `runserver_plus`命令来`--threaded`替代 Django 的`runserver`命令。在底层，它使用 Werkzeug 作为线程化的 WSGI 服务器。您可能会注意到静态文件加载时间的巨大改进。

另请参阅：[使 Django 开发服务器更快地为静态媒体提供服务](https://stackoverflow.com/questions/2358450/)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-09-19T20:35:58.617

对我来说，它是 Django 调试工具栏——它在需要时非常有用，但在不需要时它会减慢开发速度，这可能会非常令人沮丧且难以识别。我发现在开发过程中禁用它会更好，除非你需要它。：僵尸永不死：

# visual-c++ - MFC AfxParseURL 反向功能？

> ID：362810
> 
> 赞同：2
> 
> 时间：2008-12-12T13:53:33.113
> 
> 标签：visual-c++, mfc

MFC AfxParseURL 是否有反向功能（从服务类型、端口等创建 URL）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T23:03:38.510

[AfxParseURL](http://msdn.microsoft.com/en-us/library/cs1z60t6.aspx)是[InternetCrackUrl](http://msdn.microsoft.com/en-us/library/aa384376.aspx)函数的包装器`<wininet.h>`。反向函数是[InternetCreateUrl](http://msdn.microsoft.com/en-us/library/aa384473.aspx)，但 MFC 没有为此提供包装器。

您可以`InternetCreateUrl`直接使用或创建自己的包装函数，该函数将`CString`对象作为输入、初始化`URL_COMPONENTS`结构、调用`InternetCreateUrl`并将结果作为`CString`.

# c++ - 如何在没有明确说明的情况下从 dll 中导出模板类？

> ID：362822
> 
> 赞同：16
> 
> 时间：2008-12-12T13:55:59.413
> 
> 标签：c++, dll, templates

我有一个包含模板类的 dll。有没有办法在没有明确说明的情况下导出它？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-12T14:24:43.817

由于模板的代码通常在标头中，因此您根本不需要导出函数。也就是说，使用 dll 的库可以实例化模板。

这是让用户自由使用模板的任何类型的唯一方法，但从某种意义上说，它与 dll 的工作方式背道而驰。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-12T14:35:25.650

您是否正在考虑通过 dll 导出模板类的实例化？一个类：

```
typedef std::vector<int> IntVec; 
```

有一些讨论如何做到这一点：http: [//support.microsoft.com/kb/168958](https://jeffpar.github.io/kbarchive/kb/168/Q168958/)

另一种方法是通过针对此模板实例的包装类显式导出您感兴趣的每个函数。这样你就不会用比你实际感兴趣的符号更多的符号来混淆 dll。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T14:27:06.823

当编译器找到模板类的实例化时，例如 MyTemplate<int>，它会生成模板特化的代码。
因此，所有模板代码都必须放在头文件中，并包含在您要使用的地方。
如果您想“导出”您的模板类，只需将您的代码放在头文件中并将其包含在需要的地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-24T17:15:33.530

在您的出口控制文件中。

```
#ifdef XXXX_BUILD
    #define XXXX_EXPORT __declspec(dllexport)
    #define XXXX_EXTERN
#else
    #define XXXX_EXPORT __declspec(dllimport)
    #define XXXX_EXTERN extern
#endif 
```

其中 XXXX_BUILD 是项目中定义的符号。

让您的课程导出。

```
XXXX_EXTERN template class XXXX_EXPORT YourClass<double>; 
```

其中 double 是您要实例化类的类型。

[https://support.microsoft.com/en-us/help/168958/how-to-export-an-instantiation-of-a-standard-template-library-stl-clas](https://support.microsoft.com/en-us/help/168958/how-to-export-an-instantiation-of-a-standard-template-library-stl-clas)

# c++ - dll与Visual Studio之间的循环依赖关系

> ID：362830
> 
> 赞同：15
> 
> 时间：2008-12-12T13:59:39.733
> 
> 标签：c++, dll, circular-dependency

我有两个函数之间的循环依赖。我希望这些函数中的每一个都驻留在自己的 dll 中。是否可以使用 Visual Studio 构建它？

```
foo(int i)
{
   if (i > 0)
      bar(i -i);
} 
```

-> 应该编译成 foo.dll

```
bar(int i)
{
   if (i > 0)
      foo(i - i);
} 
```

-> 应该编译成 bar.dll

我在 Visual Studio 中创建了两个项目，一个用于 foo，一个用于 bar。通过使用“参考”并编译几次，我设法获得了我想要的 dll。但是，我想知道 Visual Studio 是否提供了一种以干净的方式执行此操作的方法。

如果 foo 发生变化，bar 不需要重新编译，因为我只依赖 bar 的签名，而不依赖于 bar 的实现。如果两个 dll 都存在 lib，我可以将新功能重新编译到两者中的任何一个中，整个系统仍然可以工作。

我尝试这样做的原因是我有一个具有循环依赖关系的遗留系统，该系统当前是静态链接的。出于各种原因，我们希望转向 dll。我们不想等到清理完所有循环依赖项。我正在考虑解决方案并在 linux 上使用 gcc 尝试了一些事情，并且可以按照我的建议进行操作。因此，您可以拥有两个相互依赖并且可以相互独立构建的共享库。

我知道循环依赖不是一件好事，但这不是我想要的讨论。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-22T21:16:54.750

它在类 Unix 系统上工作的原因是因为它们在加载时执行实际的链接解析。共享库在加载到进程之前不知道其函数定义来自何处。这样做的缺点是你也不知道。库可以在任何其他库（甚至是最初启动该进程的主二进制文件）中查找和调​​用函数。此外，默认情况下，共享库中的所有内容都会被导出。

Windows 根本不能那样工作。仅导出显式导出的内容，并且所有导入必须在库链接时解析，此时已确定将提供每个导入函数的 DLL 的标识。这需要一个导入库来链接。

但是，您可以（通过一些额外的工作）解决这个问题。用来`LoadLibrary`打开任何你喜欢的DLL，然后`GetProcAddress`用来定位你要调用的函数。这样，没有任何限制。但是普通方法的限制是有原因的。

当您想从静态库转换到 DLL 时，听起来您假设您应该将每个静态库都变成一个 DLL。这不是你唯一的选择。为什么不将代码移动到 DLL 中，仅当您将其识别为适合分层设计且没有循环性的独立模块时？这样你现在就可以开始这个过程，但仍然一次只攻击它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T15:18:28.153

我对你的情况深表同情（正如你的编辑所澄清的那样），但作为一个坚定的相信做正确的事情，而不是*现在*可行的事情，如果有任何可能的话，我认为你需要**重构**这些项目。

解决问题而不是症状。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-05-28T20:39:19.520

可以使用带有 .EXP 文件的 LIB 实用程序来“引导”（在没有先前的 .LIB 文件的情况下构建）一组具有循环引用的 DLL，例如这个。有关详细信息，请参阅[MSDN 文章](http://msdn.microsoft.com/en-us/library/kkt2hd12%28v=VS.90%29.aspx)。

我同意上面其他人的观点，应该通过修改设计来避免这种情况。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-02-24T04:03:29.993

这个问题是我搜索“dll 循环依赖”时的第一个问题，即使它已有 10 年的历史，但遗憾的是大多数答案都指向“重构”，这对于大型项目来说是一个非常非常非常愚蠢的建议，而不是无论如何问题。

所以我需要指出，循环依赖并不是那么危险。它们在 unix/linux 中完全没问题。在许多 msdn 文章中都提到了它们作为可能的情况以及[绕过它们的方法](https://www.lurklurk.org/linkers/linkers.html#wincircular)。它们发生在 JAVA 中（编译器通过多遍编译来解决它）。说重构是唯一的方法就像在课堂上禁止“朋友”一样。

*   链接器的一些初学者指南（David Drysdale）中的[这个段落很好地解释了 VS 链接器。](https://www.lurklurk.org/linkers/linkers.html#wincircular)

所以诀窍是使用两遍编译：第一个将创建“import-libs”，第二个将生成 dll 本身。

对于视觉工作室和任何图形IDE 编译，它可能仍然有些奇怪。但是，如果您制作自己的 Makefile，并且对链接器进程和标志有更好的控制，那么做起来并不难。

使用 OP 示例文件和 mingw-gcc 语法作为一个概念来展示（因为我对其进行了测试并确定它在 Windows 上可以正常工作），必须： - 编译/链接 a.lib 和 b.lib 而不指定循环库：

```
g++ -shared -Wl,--out-implib=a.lib -o a.dll a.obj //without specifying b.lib  
g++ -shared -Wl,--out-implib=b.lib -o b.dll b.obj //without specifying a.lib 
```

... 将显示“未定义的引用错误”并且无法提供 dll-s，但它会创建`a.lib`and `b.lib`，我们希望用于第二遍链接：

```
g++ -shared -Wl,--out-implib=a.lib -o a.dll a.obj b.lib  
g++ -shared -Wl,--out-implib=b.lib -o b.dll b.obj a.lib 
```

结果是非常干净的方法`a.dll`。`b.dll`使用 Microsoft 编译器应该是类似的，他们的建议是将 link.exe 切换到 lib.exe（没有测试它，看起来更干净，但与 mingw + make 工具相比，可能更难从中产生生产力）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T15:23:55.553

这个怎么样：

**项目A**

公共 A 类实现 C.IA

```
Public Function foo(ByVal value As C.IB) As Integer Implements C.IA.foo
    Return value.bar(Me)
End Function 
```

结束类

**项目 B**

公共 B 类实现 C.IB

```
Public Function bar(ByVal value As C.IA) As Integer Implements C.IB.bar
    Return value.foo(Me)
End Function 
```

结束类

**项目 C**

```
Public Interface IA
    Function foo(ByVal value As IB) As Integer
End Interface

Public Interface IB
    Function bar(ByVal value As IA) As Integer
End Interface 
```

**项目 D**

```
Sub Main()

    Dim a As New A.A
    Dim b As New B.B

    a.foo(b)

End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-22T20:55:24.327

一般来说，Visual Studio 将强制执行依赖关系，因为函数地址可能会在新编译的 DLL 中发生变化。即使签名可能相同，暴露的地址也可能会改变。

但是，如果您注意到 Visual Studio 通常设法在构建之间保持相同的函数地址，那么您可以使用“仅项目”构建设置之一（忽略依赖项）。如果你这样做并得到一个关于无法加载依赖 DLL 的错误，那么只需重建两者。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T14:31:35.317

干净利落是不可能的。因为它们都相互依赖，所以如果 A 发生变化，则 B 必须重新编译。因为B被重新编译了，它已经改变了，A需要重新编译等等。

这就是循环依赖不好的部分原因，不管你想不想，你都不能把它排除在讨论之外。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-04T00:49:47.437

您需要将两个 DLL 解耦，将接口和实现放在两个不同的 DLL 中，然后使用后期绑定来实例化该类。

* * *

```
// IFoo.cs: (build IFoo.dll)
    interface IFoo {
      void foo(int i);
    }

    public class FooFactory {
      public static IFoo CreateInstance()
      {
        return (IFoo)Activator.CreateInstance("Foo", "foo").Unwrap();
      }
    } 
```

* * *

```
// IBar.cs: (build IBar.dll)
    interface IBar {
      void bar(int i);
    }

    public class BarFactory {
      public static IBar CreateInstance()
      {
        return (IBar)Activator.CreateInstance("Bar", "bar").Unwrap();
      }
    } 
```

* * *

```
// foo.cs: (build Foo.dll, references IFoo.dll and IBar.dll)
    public class Foo : IFoo {
      void foo(int i) {
        IBar objBar = BarFactory.CreateInstance();
        if (i > 0) objBar.bar(i -i);
      }
    } 
```

* * *

```
// bar.cs: (build Bar.dll, references IBar.dll and IFoo.dll)
    public class Bar : IBar {
      void bar(int i) {
        IFoo objFoo = FooFactory.CreateInstance();
        if (i > 0) objFoo.foo(i -i);
      }
    } 
```

“工厂”类在技术上不是必需的，但更好的说法是：

```
IFoo objFoo = FooFactory.CreateInstance(); 
```

在应用程序代码中比：

```
IFoo objFoo = (IFoo)Activator.CreateInstance("Foo", "foo").Unwrap(); 
```

由于以下原因：

1.  您可以避免应用程序代码中的“强制转换”，这是一件好事
2.  如果承载类的 DLL 发生更改，您不必更改所有客户端，只需更改工厂即可。
3.  代码完成仍然有效。
4.  根据您的需要，您必须调用文化感知或密钥签名的 DLL，在这种情况下，您可以在一个地方向工厂中的 CreateInstance 调用添加更多参数。

——肯尼斯·卡萨吉安

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-04T01:04:28.307

您将“干净地”解决这个问题（我松散地使用该术语）的唯一方法是消除一个静态/链接时依赖项并将其更改为运行时依赖项。

也许是这样的：

```
// foo.h
#if defined(COMPILING_BAR_DLL)
inline void foo(int x) 
{
  HMODULE hm = LoadLibrary(_T("foo.dll");
  typedef void (*PFOO)(int);
  PFOO pfoo = (PFOO)GetProcAddress(hm, "foo");
  pfoo(x); // call the function!
  FreeLibrary(hm);
}
#else
extern "C" {
__declspec(dllexport) void foo(int);
}
#endif 
```

Foo.dll 将导出函数。Bar.dll 不再尝试导入函数；相反，它在运行时解析函数地址。

滚动您自己的错误处理和性能改进。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-11T12:45:21.907

当我最近遇到这个问题时，我想分享一个使用 CMake 的解决方案。这个想法是我们有两个 dll`a`并且`b`有一个循环依赖和一个调用`a.dll`. 为了使链接工作，我们创建了一个`b_init`使用标志编译的附加库，`/FORCE:UNRESOLVED`以便允许使用不完整的符号进行构建，因为它没有链接到`a`. 此外，`b_init`s 输出名称是`b`，因此它将创建`b.lib`.

在下一步中，我们链接`a`到新创建的`b.lib`. 注意，`PRIVATE`避免传递添加`b.lib`到`b`下面库的关键字。

这是`CMakeLists.txt`：

```
project(circ_dll CXX)

cmake_minimum_required(VERSION 3.15)

set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)

add_library(b_init SHARED b_dll.cpp)
set_target_properties(b_init PROPERTIES LINK_FLAGS "/FORCE:UNRESOLVED")
set_target_properties(b_init PROPERTIES OUTPUT_NAME "b")

add_library(a SHARED a_dll.cpp)
target_link_libraries(a PRIVATE b_init)

add_library(b SHARED b_dll.cpp)
target_link_libraries(b a)

add_executable(main main.cpp)
target_link_libraries(main a b) 
```

# treeview - CATIA-CAA CATNavigBox 调整大小

> ID：362833
> 
> 赞同：1
> 
> 时间：2008-12-12T14:00:36.593
> 
> 标签：treeview, catia, caa

可视化后是否可以更改树视图窗口的大小？

我的代码如下所示：

```
_p2DNavViewer = NULL;       
_p2DNavViewer = new CATNavigation2DViewer(this, "", CATDlgFraNoTitle | CATDlgWndNoDecoration |CATDlgWndChildMDI |CATDlgFraNoFrame, _width, _height);

_pNavigBox = new CATNavigBox(this, "", NULL, Indented, "CATINavigateObject_ForCAA2", 0, 0, _p2DNavViewer); 
```

*这*是周围的CATDlgContainer。

我找不到任何表明它可能的东西，但 CATIA 正在这样做，所以必须有办法。我正在使用 CAAV5 R16。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T14:58:54.017

我不知道为什么它不起作用，但现在我得到了它。我正在捕捉来自 CATDlgContainer 的 Resizecallback

```
 AddAnalyseNotificationCB(this,this->GetResizeNotification(), 
        (CATCommandMethod)&PROTrvTreeView::OnContainerResizeNotification,
         NULL); 
```

捕捉方法是这样的

```
void PROTrvTreeView::OnContainerResizeNotification(CATCommand* cmd, 
                  CATNotification* evt, CATCommandClientData data) {
    DRECT * pRect = new DRECT();
    GetRectDimensions(pRect);
    if (pRect != NULL) {
        _p2DNavViewer->SetRectDimensions(pRect->x,pRect->y, pRect->dy, pRect->dx);
    }
    delete pRect;
    pRect = NULL;
} 
```

所以它一直是 _p2DNavViewer->SetRectDimensions

# mysql - MYSQL 和关系数据库管理系统

> ID：362839
> 
> 赞同：0
> 
> 时间：2008-12-12T14:03:30.443
> 
> 标签：mysql, database-design, rdbms

我很难回答这个问题。有人能帮我吗？

讨论 MYSQL 的好处并解释为什么它被全球许多组织接受为首选的 RDBMS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-28T03:07:37.863

因为它是免费的（或者过去一直是免费的），并且比它的竞争对手（例如 postgresql）更早地在开源平台堆栈上获得了临界质量。

由于[软件中的经典网络效应](http://en.wikipedia.org/wiki/Network_effect#Software)，rdbms 不仅本身很有价值，而且它的用户群也很有价值，特别是对于用户可以回馈的 OSS。这就是为什么临界质量如此重要。

经典观察到任何产品中的网络效应都会导致“雪球效应”或自我实现的预言，其中受欢迎程度会进一步普及。这可以确保早期成功产品的主导地位，尽管[它可能存在或不存在任何技术缺陷](http://en.wikipedia.org/wiki/Mysql#Criticism)。此外，rdbms 客户非常保守（DBA 不愿意将任何尚未推出的产品投入生产），并且在 rdbms 之间转换成本对于任何开发团队来说都是非常重要的，因为它们的使用和操作存在无数的微妙之处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T14:10:15.077

以下是使用 MySQL 的好处（[链接](http://www.novell.com/documentation/oes/web_mysql/index.html?page=/documentation/oes/web_mysql/data/aj5bj52.html)）

此外，更完整的讲座（[链接](http://hxfu.org/rdbms_alternatives/#section8)）

和维基（[链接](http://en.wikipedia.org/wiki/MySQL)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T14:26:36.980

MySQL 快速、免费且开源。它易于启动和运行，具有多种语言的良好 API 和几个内置的扩展选项（复制和最近分区）。

此外，它的营销非常好:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T14:49:04.843

MySQL 轻巧、易于使用，并且拥有一个非常活跃的优秀全球社区。一个活跃、充满活力的社区表明您的同行一定接受，我认为这是一个产品在市场上的地位的一个很好的标志。对于 MySQL 论坛上发布的任何查询，我个人几乎都能立即得到答案。

Post，被Sun收购MySQl，在业界获得了更大的牵引力和认可度。根据您想要的支持类型，您可以选择 MySQL 的商业版本。

这些是我个人的看法。我很确定您可以在网络上获得很多详细介绍 MySQL 无数特性的链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T14:27:24.513

尝试向 Sun Microsystems 询问他们对[MySQL](http://www.sun.com/software/products/mysql/)的意见。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-28T02:39:20.820

我认为这也取决于组织的规模。我不会说 MySQL 正在获得全世界的认可。大多数大公司（财富 500 强）仍然对开源软件持谨慎态度，并且更愿意为支持付费。

开源公司（如 Spring Source、JBoss 和 Red Hat 以及 Sun 的 MySQL）正在采用的新服务模型有很大帮助。

但它没有打开任何闸门。大多数 IT 经理都知道，他们不会失去从 IBM、微软和甲骨文购买的工作。他们会抱怨许可证费用，但他们仍然担心开源。

有一个两层的采用模型：大的和小的。大公司对 IBM、Microsoft 和 Oracle 以及 C# 和 Java 等主流语言感到满意。小公司可以尝试使用开源和 Python、Ruby 等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-28T03:22:30.547

虽然网络效应是 MySQL 仍然受欢迎的原因，但我认为它之所以受欢迎有两个简单的原因：它是免费的，这使其成为廉价网络主机提供给廉价网络管理员的理想选择；对于大多数使用廉价虚拟主机的任务来说，这已经足够了。

MySQL 并没有在 IT 后台站稳脚跟。玩具网站用户的虚拟主机提供商需要数据库产品。在 myspace 和 facebook 和 livejournal 出现之前，网站制造商将使用最便宜的网站提供商推出自己的产品。

与 PHP 自身流行起来的协同作用可能也不是微不足道的。但我怀疑这是不必要的题外话。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-12T14:34:56.870

MYSQL 并不总是免费的。如果您打算将其用于商业目的，则应购买许可证 ( [link1](http://www.mysql.com/about/legal/licensing/oem/) [link2](https://shop.mysql.com/enterprise/?rz=s2) )。您可能需要仔细检查。

您不会被迫购买许可证，但建议您购买。开源软件开发并不总是免费的。

# .net - F# 中的业务线应用程序要多久才能成为常态？

> ID：362840
> 
> 赞同：4
> 
> 时间：2008-12-12T14:03:41.423
> 
> 标签：.net, f#, functional-programming

随着最近有关 F# 包含在 Visual Studio 2010 中的消息，我开始思考……在我看到函数式编程在通常的“业务线应用程序”领域占据一席之地之前多久？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T14:15:24.380

我会在那个标签上添加主观标签；）

就个人而言，我认为它不会成为常态，尽管它会在非常适合的领域使用。

我认为它不会成为常态，因为它最适合应用程序的某些层，但不太适合 UI 等其他层。

因此，在 C# 或 VB 中将继续开发多个层。从公司的角度来看，即使 F# 是应用程序的一部分的更好工具，他们还是倾向于用 C# 或 VB 编写以保持一致性，因为他们的程序员会更擅长这些语言，因此未来的员工会更容易找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T14:14:27.020

它不会很快发生。你有一百万程序员从小就使用命令式编程风格，他们需要很长时间才能适应。如果曾经。这是一种完全不同的思维方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T14:31:28.467

我怀疑这些*想法*会比实际使用 F# 更重要……例如，我预计（尤其是随着多核升级）不可变设计将在 C# 中蓬勃发展。但我没有看到人们从 C# 切换到 F#。我都尝试过，C# 绝对（对我来说）使事情更易于维护和理解。

不要忘记，使用委托和用于闭包的 lambda，我们可以在 C# 中以函数式风格进行编写。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T15:21:50.083

大约10-15年。这大致就是任何新语言（不仅仅是在旧语言上涂刷油漆）获得牵引力所需要的。以 Python 和 Ruby 为例——两者都始于 90 年代初，现在才真正获得动力。也有例外 - C# 就是其中之一。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T14:16:08.903

取决于你的业务，我猜。它已经在我的行中实现了，其中包括财务环境中的定量分析，其中大部分涉及编写函数。在订单处理环境中，为了挑选一些常见的东西，我认为函数式语言没有多大用处。但我可能是错的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T14:26:55.840

我认为人们已经在它的某些原则中看到了价值。人们不得不在很长一段时间内开始在标准过程语言中使用 OOP 范式，然后才考虑到该概念构建的语言变得流行。即便如此，人们还是编写了一些不太理想的 OOP 代码。因此，现在关于该主题的书籍、模式和最佳实践数不胜数。我可以看到函数式编程出现了类似的趋势。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T13:22:19.573

我希望的不是推动 F# 接管任何其他 .net 语言，而是他们会为 VS2010 添加能力，让您在同一个项目中拥有多种编程语言。据我所知，你今天不能这样做，但我可能是错的。这将很容易让人们为他们需要的事物的一个方面拥有一个 F# 文件，然后为其余的东西（UI 逻辑、状态等）提供 C# 或 VB。

人们一直将 F# 视为一种革命性的新语言……唯一的革命性在于它是一种基于 .NET 的函数式语言。所以仅仅因为它是新的，并不意味着它会成为常态。看看 Erlang 和 Haskell ......它们都是函数式语言，已经存在了大约 2 年，而且都没有在大学之外获得大众接受。

# c# - 从 c# .net 代码为 S_OK 或 E_FAIL 返回什么值？

> ID：362861
> 
> 赞同：11
> 
> 时间：2008-12-12T14:12:08.367
> 
> 标签：c#, .net, com, return-value

我正在实现一个 COM 接口，它应该返回 int 值`S_OK`或`E_FAIL`. 我`S_OK`可以返回，因为我从另一个调用 (Marshal.QueryInterface) 得到它，但是如果我想返回一个失败值，我应该使用什么实际值`E_FAIL`？

（这是一个基本的基本问题，很难找到答案）

假设它是 Win32 API 中定义的特定数字，有没有办法在 .net 代码中使用它而不声明我自己的常量？

谢谢！

**更新（在下面回答）：**

也许我是一个彻头彻尾的笨蛋，但我在这方面遇到了问题。根据我的 Platform SDK，HRESULT 是一个 LONG，它是一个 32 位有符号整数，对吧？所以可能的值 –2,147,483,648 到 2,147,483,647。但是 0x80004005 = 2,147,500,037 > 2,147,483,647。是什么赋予了！？

这意味着当我尝试将其放入我的代码中时：

```
const int E_FAIL = 0x80004005; 
```

我收到编译器错误无法将类型“uint”隐式转换为“int”。

**更新 2：**

我要这样声明：

```
const int E_FAIL = -2147467259; 
```

因为如果我尝试做这样的事情：

```
const UInt32 E_FAIL = 0x80004005;
return (Int32)E_FAIL; 
```

我得到一个编译器错误*常量值'2147500037'不能转换为'int'（使用'unchecked'语法来覆盖）*

呸！谁知道声明一个标准的返回值会有多棘手……一定有一个潜伏的类，我应该使用它，比如**return Win32ReturnCodes.E `_`FAIL;** ...*叹息*

**终极解决方案：**

我现在通过从[pinvoke.net](http://www.pinvoke.net/default.aspx/Enums/HRESULT.html)获取（大量但非常有用的）HRESULT 枚举并将其添加到我的解决方案中来做到这一点。然后像这样使用它：

```
return HRESULT.S_OK; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-12T14:16:52.193

E_FAIL 是 WinError.h 中的十六进制 80004005

您可以查看完整的[Common HRESULT 值](http://msdn.microsoft.com/en-us/library/windows/desktop/aa378137(v=vs.85).aspx)。您不必为了查看值而安装 C++。

**更新：**

0x80004005 的有符号和无符号版本只是同一位掩码的两种表示形式。如果您遇到转换错误，请使用负符号值。当投射到联合国签署的 long 时，它将是“正确”的值。在 C# 中自己测试一下，它会起作用，例如

这段代码

```
 static void Main(string[] args)
    {
        UInt32 us = 0x80004005;
        Int32 s = (Int32)us;

        Console.WriteLine("Unsigned {0}", us);
        Console.WriteLine("Signed {0}", s);
        Console.WriteLine("Signed as unsigned {0}", (UInt32)s);

        Console.ReadKey();
    } 
```

将产生这个输出

*   未签名 2147500037
*   签名-2147467259
*   签名为未签名 2147500037

所以使用 -2147467259 作为 E_FAIL 的值是安全的

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-12T14:19:36.667

来自 Win32 的 WinError.h

```
#define E_FAIL _HRESULT_TYPEDEF_(0x80004005L) 
```

要找到这样的答案，请使用 Visual Studio 的文件搜索来搜索 Visual Studio 安装目录的 VC Include 目录中的头文件。

```
C:\Program Files\Microsoft Visual Studio 9.0\VC\include 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-05T22:32:01.227

使用“未选中”关键字来执行此操作。

例如

```
const int E_FAIL = unchecked((int)0x80004005); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-12-04T18:07:03.303

[VSConstants](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.vsconstants.aspx)可能是你想要的：

VSConstants.S_OK 字段

成功的通用 HRESULT。

命名空间：Microsoft.VisualStudio

程序集：Microsoft.VisualStudio.Shell.10.0（在 Microsoft.VisualStudio.Shell.10.0.dll 中）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-31T04:13:24.567

我用过这个：

```
const int EFail = int.MinValue + 0x00004005; 
```

在可读性（如果您习惯于十六进制代码）和 C# 的限制之间妥协。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-12T14:23:59.043

您应该下载平台 SDK（[链接](http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5&displaylang=en)）

我搜索了代码，在winerror.h中找到了以下内容

```
typedef long HRESULT;

#ifdef RC_INVOKED
#define _HRESULT_TYPEDEF_(_sc) _sc
#else // RC_INVOKED
#define _HRESULT_TYPEDEF_(_sc) ((HRESULT)_sc)
#endif // RC_INVOKED

#define E_FAIL _HRESULT_TYPEDEF_(0x80004005L)
#define S_OK  ((HRESULT)0x00000000L) 
```

您应该返回 E_FAIL 而不是该值。只需包含 winerror.h。

# nhibernate - nHibernate 共享参考？

> ID：362872
> 
> 赞同：4
> 
> 时间：2008-12-12T14:16:12.430
> 
> 标签：nhibernate, hibernate, exception

保存对象时出现以下异常：

> 找到对集合的共享引用

有谁知道这意味着什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T00:05:46.927

从理论上讲，这意味着您有 2 条记录包含对另一个对象的相同引用。在数据库级别，这很可能是一个弱实体，但是在代码级别，这很可能表示为一个集合。

您是否复制了另一个记录集合？例如

```
Blog blog1 =  Blog.Find(1);
Blog blog2 = new Blog();
blog2.Entries =  blog1.Entries;
blog2.Save(); 
```

此代码适用于 ActiveRecords，但由于它构建在 nHibernate 之上，因此基本原理是相同的。

当我遇到这个问题时，有趣的是它所引用的集合是不正确的。这是一个不同的。

如果这是您的问题，请尝试遍历每个项目并将其分配给新集合。例如

```
Blog blog1 =  Blog.Find(1);
Blog blog2 = new Blog();

foreach (BlogEntry entry in blog1.Entries)
   blog2.Entries.Add(entry);
blog2.Save(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T14:33:41.287

[快速谷歌说](http://forum.hibernate.org/viewtopic.php?p=2273553)

```
 rel   Group n --- 1 User
         m             ^
         |             | inh
         |  rel        |
         --------- n Member 
```

> rel 代表关系（关联） inh 代表继承
> 
> 成功创建成员对象并从数据库中读取后，将引发异常。在读取最后一个成员对象后，事务被提交，但失败。

你的映射是什么样的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T14:31:26.470

您是否在其他地方引用了集合中的任何对象？另一个会话，可能，甚至在另一个对象的同一会话中？确保当您访问休眠时，您正在控制任何休眠会话中对这些对象的唯一引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-22T14:15:06.830

根据我的经验，当您有一个连接的子类映射时，会发生此错误，其中继承的属性同时映射到超类和子类中。假设你有这些对象：

```
public class Being
{
    public string DnaSequence { get; protected set; }
}

public class Animal : Being
{
    public IList<Animal> Relatives { get; protected set; }
}

public class Human : Animal
{
    public string Name { get; protected set; }
} 
```

在您的`Human`映射中，重要的是**不要**映射`Relatives`属性。在连接子类映射中，您应该只映射对您正在映射的层次结构中的级别唯一的属性：

1.  对于`Being`，您只映射`DnaSequence`属性。
2.  对于`Animal`，您只映射`Relatives`属性。
3.  对于`Human`，您只映射`Name`属性。

如果您不小心在映射`Relatives`中`Human`映射，NHibernate 将抛出“找到对集合的共享引用”。

# asp.net - ASP.NET 会话状态迁移

> ID：362884
> 
> 赞同：1
> 
> 时间：2008-12-12T14:20:45.680
> 
> 标签：asp.net, session-state

在我建议我的客户从 30/mo 升级到 80/mo 托管包之前，我希望有人可以验证我的假设。

**站点：**该站点是一个自定义的 ASP.NET 电子商务站点。购物车存储在 inproc 会话中。

**在像我们现在这样的繁忙**季节，用户经常丢失他们的购物车和他们的 FormsAuthentication 登录信息。

**解决方案**我想迁移站点以使用 SQL Server 会话状态。我的假设是客户正在丢失他们的购物车，因为 InProc 会话由于负载而比他们的 20 分钟超时更频繁地回收。将会话移动到 SQL Server 或会话状态服务器是否允许客户在没有回收的情况下存储他们的购物车会话，如果是这样，如果我将会话超时时间增加到 40 或 60 分钟，他们是否会遇到任何问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T14:26:43.000

使用 SQL Session 状态意味着会话应该在 IIS 的循环中继续存在（但如果您使用在 tempdb 中创建会话数据库的默认脚本，则不是 SQL Server 的循环）。

Microsoft 网站上有一个脚本可用于创建永久会话状态数据库。我建议改用那个（见[这里](http://www.dbazine.com/sql/sql-articles/cook9)）。

所以，基本上回答你的问题。是的，SQL 会话状态会有所帮助。您可能还想考虑使用进程外状态服务器来测试您的理论。

另外，正如一位同事刚刚提醒我的那样，请确保在迁移之前将您存储在会话中的任何内容标记为可序列化，否则您会遇到问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T14:25:21.130

你能在盒子里加点内存吗？这可能会有所帮助，并且可能比将会话移动到 SQL Server 更便宜、更简单。当然，这只是权宜之计，但如果它在几年内为他们节省了 50 美元/月，那可能是值得的。

您还可以检查代码以查看会话中是否保留了一些其他数据超过必要的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T14:24:58.357

这些假设对我来说听起来很合理。可能还想查看 AppPool 上的设置并尝试找出其回收的原因。也许你需要做的就是改变那些（如果可以的话）。

# pdf - 如何摆脱从 SSRS 导出的 PDF 中的空白页

> ID：362902
> 
> 赞同：205
> 
> 时间：2008-12-12T14:27:10.253
> 
> 标签：pdf, reporting-services, ssrs-2008, ssrs-2008-r2, ssrs-2012

我有一个两页的 SSRS 报告。当我将它导出为 PDF 时，由于它的宽度，它占用了 4 页，其中第 2 和第 4 页显示了我在表格中的一个字段。我尝试将报表属性中的布局大小设置为宽度 = 18 英寸和高度 = 8.5 英寸。

它在一页 PDF 中给了我整个表格，但我仍然让第二页和第四页空白。

我这样做的方式不正确吗？我还能如何摆脱那些空白页？

* * *

## 回答 #1

> 赞同：363
> 
> 时间：2008-12-18T02:08:21.473

在 BIDS 或 SSDT-BI 中，执行以下操作：

1.  单击报告 > 报告属性 > 布局选项卡（SSDT-BI 中的页面设置选项卡）
2.  记下**Page width** , **Left margin** , **Right margin的值**
3.  关闭并返回设计界面
4.  在“属性”窗口中，选择**“正文”**
5.  单击 + 符号以展开 Size 节点
6.  记下**Width的值**

要在 PDF 中正确呈现，正文宽度 + 左边距 + 右边距必须小于或等于页面宽度。当您看到正在呈现空白页面时，几乎总是因为正文宽度加上边距大于页面宽度。

记住：（**正文宽度+左边距+右边距）<=（页面宽度）**

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2013-07-17T21:57:26.723

要尝试的另一件事是将调用的*报告属性*`ConsumeContainerWhitespace`设置为`True`（默认为`false`）。我就是这样解决的。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-12-05T18:14:40.017

经过数小时的努力解决这个问题后，我偶然发现了一个对我有用的解决方案：

在 SSDT (2012) 中，我最初将页面设置/页面单位设置为厘米。当我将其更改为英寸时，奇怪的是，我能够将我的报告导出为 PDF，而无需其他所有页面都是空白的。

![在此处输入图像描述](https://i.stack.imgur.com/92QpW.jpg)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2015-01-26T15:03:04.923

在编辑 SSRS 文档时计算任何数学之前，最好先在设计图面上执行此操作（*显示了 Visual Studio 2012，但可以在其他版本中完成）。*

以下红色圆圈中的数字下方对应以下步骤：

1.  在设计面，有时编辑器会创建一个`page`比实际控件大的；因此要打印重影区域。
2.  调整到控件的大小。直观地查看宽度/高度，看看您是否无法*在设计图面上引入***页面** 以将其调整为控件实际需要的空间，仅此而已。
**   然后尝试创建一个 PDF 并查看是否可以修复它。*   如果#3 不能解决问题，那么有些控件需要太多的实际页面大小并且在长度/宽度上*都超出了。*因此，需要使控件的大小更小以适应更小的页面大小。*

 *![手动修复的步骤](https://i.stack.imgur.com/CQAIf.png)

* * *

此外，在某些情况下，您可以通过设置为自动使用空间来更改报告页面的`ConsumeContainerWhitespace`属性`true`。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2015-06-16T03:47:14.283

对我来说，问题是 SSRS 故意将您的空白视为您打算尊重它：

![在此处输入图像描述](https://i.stack.imgur.com/cQS4r.png)

**除了空白，确保没有右边距。**

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2008-12-12T16:09:26.290

如果来自 SSRS 的页面是空白的，则需要调整报表布局。这将比运行输出和后处理来修复布局问题的副作用要有效得多。

SSRS 在推动边距边界方面非常挑剔。只需调整报表上的文本框或其他控件，很容易意外地扩大/加长报表。仔细检查报表面的宽度和高度属性，尽量挤压。注意大的页眉和页脚。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-06-17T10:43:34.927

我已经与 SSRS 合作了 10 多年，上面的答案就是答案。但。如果没有任何效果，并且您完全被塞满了......从报告中删除项目，直到问题消失。一旦您确定了导致问​​题的行或报告项，请将其放在一个矩形容器中。而已。帮助了我们很多很多次！多余的页面主要是由于报表项超出了右边距造成的。当所有其他方法都失败时，将东西放在一个矩形内或一个项目右侧的空矩形内，可以阻止这种情况的发生。祝你好运！

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-07-16T23:24:36.560

您是否尝试查看报告右侧是否有空白？如果是这样，您可以将其拖回报告的末尾，然后将报告背景拖回同一位置。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-04-10T21:13:21.103

除了边距，这是迄今为止最常见的问题，我还看到了另外两种可能性：

1.  用于`+`连接文本。你应该`&`改用。
2.  超出指定文本框宽度的文本。因此，如果您的文本框仅包含 30 个字符并且您尝试在其中塞入 300 个字符，那么您最终可能会得到额外的页面。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-01-29T15:41:44.267

我最近继承了一份报告，我需要进行一些更改。遵循上述所有建议后，它没有帮助。该报告历来有这个额外的页面，没有人能弄清楚为什么。

我右键单击 tablix 并选择了属性。有一个复选框被选中，说在之后添加一个分页符。删除它后，它现在打印在一页上。

[![在此处输入图像描述](https://i.stack.imgur.com/ZRNE0.png)](https://i.stack.imgur.com/ZRNE0.png)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-12-18T19:28:31.620

在报告 (myReport.rdlc) 的属性选项卡上，将“Keep Together”属性更改为 False。我一直在努力解决这个问题，这似乎解决了我的问题。 ![在此处输入图像描述](https://i.stack.imgur.com/8eGZH.png)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-03-20T21:57:23.727

如果您的报表包含子报表，如果允许子报表和层次结构增长，则子报表的宽度可能会超出正文的边界。我有一个类似的问题出现在一个可以放在一个单元格中（跨越 2 列）的子报表中。看起来跨度可以在设计器中包含它，并且在 winform 或浏览器中呈现良好，并且最初它可以生成打印机输出（或 pdf 文件）而不会溢出到多余的页面上。
然后，在更改了其他一些列宽（并且不超过正文宽度加上边距）之后，winform 和浏览器渲染看起来仍然很好，但是当生成输出（打印机或 pdf）时，它增长超过边距并写入右侧将每一页作为第 2（第 4 等）页。我可以通过增加放置子报表的 colspan 来消除我的问题。
无论您是否使用子报表，如果您有页面溢出并且您的正文设计适合页面的边缘，请寻找允许增长的东西，将正文的宽度推出。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-06-22T13:36:21.683

我通过执行以下操作解决了这个问题。（使用最新版本的报表生成器）

第 1 步。）转到“查看”选项卡
第 2 步。）选中“属性”复选框 第 3 步。）在报告正文内单击（它将更新属性选项卡中的值） 第 4 步。）此处不要考虑宽度 第 5 步。）右键单击报告外部的灰色区域，然后单击报告属性 第 6 步。）将左边距 + 右边距添加到身体宽度（如果等于 10，则将宽度设为 11） 第 7 步。）保存[![在此处输入图像描述](https://i.stack.imgur.com/gxGBP.png)](https://i.stack.imgur.com/gxGBP.png)
[![在此处输入图像描述](https://i.stack.imgur.com/n5MVp.png)](https://i.stack.imgur.com/n5MVp.png)

[![在此处输入图像描述](https://i.stack.imgur.com/N3Ldd.png)](https://i.stack.imgur.com/N3Ldd.png)
[![在此处输入图像描述](https://i.stack.imgur.com/phjgz.png)](https://i.stack.imgur.com/phjgz.png)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-03-25T16:04:05.203

确保视觉工作室中的设计师没有超出您的最大宽度。将鼠标悬停在右侧页面边框上并向左拖动以确保页面不会超出您想要的布局。

[![在此处输入图像描述](https://i.stack.imgur.com/ZccTf.png)](https://i.stack.imgur.com/ZccTf.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-12-07T13:07:08.557

我只是减少了所有小于 8 英寸的 Wight 元素，它更正了，我用鼠标做到了，你的报告体应该小于 8 英寸。

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2008-12-12T15:03:15.813

我已经成功地使用 pdftk 删除了我在 pdf 中不需要/不需要的页面。你可以在[这里下载程序](http://www.pdfhacks.com/pdftk/#packages)

您可以尝试以下方法。取自[此处](http://pwet.fr/man/linux/commandes/pdftk)的示例

从 in1.pdf 中删除“第 13 页”以创建 out1.pdf pdftk in.pdf cat 1-12 14-end 输出 out1.pdf

或者：

pdftk A=in1.pdf cat A1-12 A14-端输出out1.pdf

# asp.net-2.0 - Roles.IsUserInRole 在以下简单场景中的行为是否符合预期？

> ID：362907
> 
> 赞同：3
> 
> 时间：2008-12-12T14:28:33.497
> 
> 标签：asp.net-2.0, roles

在 .NET 2.0 的自定义角色提供程序（继承自 RoleProvider）中，IsUserInRole 方法已被硬编码为始终返回 true：

```
public override bool IsUserInRole(string username, string roleName) { return true; } 
```

在配置为使用此角色提供程序的 ASP.NET 应用程序中，以下代码返回 true（如预期的那样）：

```
Roles.IsUserInRole("any username", "any rolename"); // results in true 
```

但是，以下代码返回 false：

```
Roles.IsUserInRole("any rolename"); // results in false 
```

请注意， User.IsInRole("any rolename") 也返回 false。

1.  这是预期的行为吗？
2.  假设仅采用角色名称的重载仍会调用重写的 IsUserInRole 是否不正确？

**更新**：请注意，对于采用单个字符串的版本似乎没有可用的覆盖，这导致了我在 #2 中的假设。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T14:59:44.340

我查看了 .net 反射器中的 Roles.IsUserInRole(string rolename) ，它解析为以下内容：

```
public static bool IsUserInRole(string roleName)
{
    return IsUserInRole(GetCurrentUserName(), roleName);
} 
```

我会看看你当前的用户。原因如下：

```
private static string GetCurrentUserName()
{
    IPrincipal currentUser = GetCurrentUser();
    if ((currentUser != null) && (currentUser.Identity != null))
    {
        return currentUser.Identity.Name;
    }
    return string.Empty;
} 
```

我愿意打赌这将返回一个空字符串，因为您要么没有当前用户，要么它的名称是空字符串或 null。

在该`IsUserInRole(string username, string roleName)`方法的开头附近有以下代码块：

```
 if (username.Length < 1)
   {
       return false;
   } 
```

如果您`GetCurrentUserName()`没有返回任何有意义的内容，那么它将在调用您的覆盖方法之前返回 false。

道德带走这一点：反射器是一个很好的工具:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-07T14:17:33.467

如果您在 RoleManager 配置中选择了 cacheRolesInCookie="true"，请注意。如果您向数据库添加了新角色，它可能正在查看 cookie 中的缓存版本。

我遇到了这个问题，解决方案是删除cookie并重新登录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-25T12:36:01.717

这可能对某人有所帮助 - 请注意：

如果您正在使用登录控件进行身份验证 - 输入到控件中的用户名将成为 HttpContext.Current.User.Identity.Name ，它在 Roles.IsUserInRole(string rolename) 中使用，更具体地说 - 成员资格的 GetUser() 方法。因此，如果是这种情况，请确保您覆盖 Authenticate 事件，在此方法中验证用户并将用户名设置为您的自定义成员资格提供程序可以使用的值。

```
 protected void crtlLoginUserLogin_Authenticate(object sender, AuthenticateEventArgs e)
{
    bool blnAuthenticate = false;
    string strUserName = crtlLoginUserLogin.UserName;

    if (IsValidEmail(strUserName))
    {

        //if more than one user has email address - must authenticate by username.

        MembershipUserCollection users = Membership.FindUsersByEmail(strUserName);
        if (users.Count > 1)
        {
            crtlLoginUserLogin.FailureText = "We are unable to determine which account is registered to that email address. Please enter your Username to login.";

        }
        else
        {
            strUserName = Membership.GetUserNameByEmail(strUserName);
            blnAuthenticate = Membership.ValidateUser(strUserName, crtlLoginUserLogin.Password);

            //setting the userLogin to the correct user name (only on successful authentication)
            if (blnAuthenticate)
            {
                crtlLoginUserLogin.UserName = strUserName;
            }

        }

    }
    else
    {
        blnAuthenticate = Membership.ValidateUser(strUserName, crtlLoginUserLogin.Password);
    }

    e.Authenticated = blnAuthenticate;

} 
```

# .net - 是否可以使用 ICriteria 从 NHibernate 查询中获取惰性 IEnumerable？

> ID：362911
> 
> 赞同：6
> 
> 时间：2008-12-12T14:29:45.723
> 
> 标签：.net, nhibernate, .net-3.5

我正在使用 NHibernate，需要检索和处理多达 200 万行。理想情况下，我可以处理每一行——一次一个——而不用 NHibernate 一次加载所有 200 万个内存（因为，你知道，这很痛苦）。

我更喜欢获得一个 IEnumerable ，它会为每次读取迭代地调用数据读取器，这样我就可以处理读取的数据 - 然后丢弃它。通过这样做，我节省了大量内存，并开始更快地处理结果。我还可以通过多线程和/或使用 PLinq 来提高性能。

NHibernate 的 ICriteria 可以做到这一点吗？它返回的所有内容似乎都是 IList，并且在关闭集合引用之前已完全加载。为什么用 IList 而不是 IEnumerable？！

我并不是指 NHibernate 在加载子对象或父对象时使用的传统意义上的“懒惰”。我想要一个**懒惰的 IEnumerable，这意味着以某种方式从 ICriteria 对象获取 IEnumerable**。ICriteria 只有一个 List() 方法，它将结果加载到 ArrayList 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T17:57:24.307

ICriteria 没有任何返回 IEnumerable 的方法，但[IQuery 有](http://fisheye3.atlassian.com/browse/nhibernate/trunk/nhibernate/src/NHibernate/IQuery.cs?r=3868#l96)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T14:39:22.243

您想要做的是将您的数据访问包装在如下方法中：

```
public IEnumerable<YourObject> GetALotOfRows() {
  ..execute DataReader
  while(..read..) {
    yield return yourObject;
  }
} 
```

现在手头没有 VS 或 nHibernate，对于半伪代码感到抱歉。但这里的关键是使用“收益回报”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:21:36.857

您必须逐行执行什么样的操作？我只是好奇 ：）。

您可以尝试对结果进行分页 - 获取前 10 个，接下来的 10 个......等等。

**编辑：** 所以你会有

```
Session.CreateCriteria(typeof(T)).SetFirstResult(0).SetMaxResults(1).UniqueResult<T>();
Session.CreateCriteria(typeof(T)).SetFirstResult(1).SetMaxResults(1).UniqueResult<T>();
Session.CreateCriteria(typeof(T)).SetFirstResult(2).SetMaxResults(1).UniqueResult<T>(); 
```

你明白了，我想这不是最好的方法，它不是 IEnumerable ......但它会起作用。您也可以执行 SetMaxResults(10) 或更大的操作，因此不要一次发送 1 个。

# .net - 循环参考

> ID：362918
> 
> 赞同：3
> 
> 时间：2008-12-12T14:32:48.107
> 
> 标签：.net, winforms, circular-dependency

我正在寻找一种好的模式来解决 Windows 窗体应用程序中的以下循环引用：

*   程序集 1 包含一个带有 Infragistics 菜单项“.显示”程序集 2 中的表单的 Windows 窗体
*   程序集 2 包含一个带有 Infragistics 菜单项“显示”程序集 1 中的表单的 Windows 窗体

菜单在整个应用程序中通常具有相同的项目。因此，Assembly 1 和 Assembly 2 都相互引用以“新建”彼此的表格并显示它们。

关于大小的说明：我的应用程序是一个现有的应用程序，所以情况并不像上面两个组装的情况那么简单。但是，如果我可以简单地解决上述问题（可能不实现 a ，我可以将其应用于更大的应用程序（大约 20 个组件，所有组件都有几种跨组件相互弹出的表单）。

我已经考虑了一些解决方案，但它们似乎都很麻烦。我缺少一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T14:43:34.433

您可以（在这两种情况下）使按钮简单地引发一个事件。shell exe 引用了这两个程序集，并连接了偶数以显示另一种形式。

所以exe知道两者；两种形式都不知道对方。

例如（相同的概念）：

```
using System;
using System.Windows.Forms;
class Form1 : Form
{
    public event EventHandler Foo;
    public Form1()
    {
        Button btn = new Button();
        btn.Click += delegate { if(Foo!=null) Foo(this, EventArgs.Empty);};
        Controls.Add(btn);
    }
}
class Form2 : Form
{
    public event EventHandler Bar;
    public Form2()
    {
        Button btn = new Button();
        btn.Click += delegate { if (Bar!= null) Bar(this, EventArgs.Empty); };
        Controls.Add(btn);
    }
}
static class Program
{
    [STAThread]
    static void Main()
    {
        ShowForm1();
        Application.Run();
    }
    static void ShowForm1()
    {
        Form1 f1 = new Form1();
        f1.Foo += delegate { ShowForm2(); };
        f1.Show();
    }
    static void ShowForm2()
    {
        Form2 f2 = new Form2();
        f2.Bar += delegate { ShowForm1(); };
        f2.Show();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T14:47:16.687

您是否考虑过创建第三个程序集并将所有公共代码移动到第三个程序集中？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T14:54:41.073

使用组件工厂或组件编写器（如[MEF](http://www.codeplex.com/MEF)）来创建实例，而无需引用组件的源程序集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T15:46:59.780

使用接口怎么样？您可以构建包含接口的第三个库，每个窗口都从自身实现一个接口，并引用另一个窗口的接口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T15:50:11.923

目前，我决定使用反射来弹出需要弹出的窗口。我不再需要直接引用它们，实际上我可以更轻松地添加组件，而无需创建所有交叉引用的程序集。

我查看了 MEF，但不幸的是，我使用的是 VS2003，而不是 VS2008。这个建议让我走上了简单反思的道路。

谢谢。

# java - 从父小程序创建子小程序窗口

> ID：362919
> 
> 赞同：1
> 
> 时间：2008-12-12T14:32:55.670
> 
> 标签：java, applet

如何从在该浏览器中运行的小程序内创建 Web 浏览器外部的小程序窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T14:39:08.217

您可以使用 . 打开一个新窗口[`AppletContext.showDocument()`](http://java.sun.com/j2se/1.5.0/docs/api/java/applet/AppletContext.html)。您需要在服务器上有一个包含 HTML 和所有内容的页面。您[`getAppletContext()`](http://java.sun.com/j2se/1.4.2/docs/api/java/applet/Applet.html#getAppletContext())从继承自基类的小程序中获取上下文。

它最终会看起来像这样：

```
AppletContext ctxt = getAppletContext();
ctxt.showDocument("http://www.example.com/child_applet.html", "_top"); 
```

如果您只想要一个外部窗口，您可以创建并显示一个框架。它将是小程序的一个子项，并受到相同的限制。此外，如果用户离开小程序页面，它也会消失。

```
JFrame frame = new JFrame();
// setup all the context...
frame.show(); 
```

# c++ - 用于向量数学的开源 C++ 库

> ID：362928
> 
> 赞同：16
> 
> 时间：2008-12-12T14:37:59.170
> 
> 标签：c++, math

我需要在应用程序中使用一些基本的向量数学结构。点积，叉积。寻找线的交叉点，那种东西。

我可以自己做到这一点（事实上，已经这样做了），但没有一个“标准”可以使用，所以错误和可能的优化不会出现在我身上吗？

Boost没有它。据我所知，他们的数学部分是关于统计函数的。

**附录：**

Boost 1.37 确实似乎有[这个](http://www.boost.org/doc/libs/1_37_0/libs/numeric/ublas/doc/overview.htm)。他们还优雅地介绍了该领域的许多其他解决方案，以及为什么他们仍然坚持自己的解决方案。我喜欢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-12T14:43:49.503

重新检查名为[Boost](http://www.boost.org)的 C++ 程序员的好朋友。它有[一个线性代数包](http://www.boost.org/doc/libs/1_37_0/libs/numeric/ublas/doc/index.htm)，可以很好地满足您的需求。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-12T17:10:55.400

我还没有测试过，但是 C++ [eigen 库](http://eigen.tuxfamily.org/index.php?title=Main_Page)现在变得越来越流行。据他们说，它们与周围最快的库不相上下，而且它们的 API 在我看来相当简洁。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-11T11:30:22.423

[犰狳](http://arma.sourceforge.net/speed.html)

> 犰狳采用延迟评估方法将多个操作合并为一个，并减少（或消除）对临时人员的需求。在适用的情况下，优化操作顺序。通过递归模板和模板元编程实现延迟评估和优化。
> 
> 虽然诸如加法、减法和乘法（矩阵和元素方式）之类的链式操作是加速机会的主要目标，但其他操作（例如子矩阵的操作）也可以进行优化。注意保持“小”和“大”矩阵的效率。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T14:53:47.703

除了学习概念之外，我不会将 NRC 代码用于其他任何事情。

我认为您正在寻找的是[Blitz++](http://www.oonumerics.org/blitz/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T14:51:02.047

查看由橡树岭国家实验室和田纳西大学维护的[www.netlib.org 。](http://www.netlib.org)您可以在那里搜索数字包。还有[C++ 中的数值食谱](http://www.nr.com)，其中有代码，但是这本书的 C++ 版本有点贵，而且我听说该代码被描述为“糟糕”。C 和 FORTRAN 版本是免费的，相关代码相当不错。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T14:56:22.723

在预言 SDK 中有一个不错的 3d 图形矢量库：

查看[http://www.twilight3d.com/downloads.html](http://www.twilight3d.com/downloads.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T14:59:46.600

对于线性代数：尝试[JAMA/TNT](http://math.nist.gov/tnt/download.html)。这将涵盖点积。（+矩阵分解和其他东西）至于矢量叉积（真的只对3D有效，否则我认为你会进入张量），我不确定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T17:15:45.297

对于一个非常轻量级（单个 .h 文件）的库，请查看[CImg](http://cimg.sourceforge.net/)。它适用于图像处理，但处理矢量没有问题。

# database - 是否有带有数据库逆向工程的 Perl ORM？

> ID：362929
> 
> 赞同：7
> 
> 时间：2008-12-12T14:38:49.997
> 
> 标签：database, perl, orm

我正在寻找一个支持数据库模式逆向工程的 Perl ORM 库。到目前为止，我发现的只是 [http://perlorm.sourceforge.net/](http://perlorm.sourceforge.net/) ，它似乎没有逆向工程支持。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-12T15:23:32.917

[P5P wiki 上有推荐的 ORM 模块](http://www.perlfoundation.org/perl5/index.cgi?recommended_database_modules)列表。

[Rose::DB::Object](http://search.cpan.org/dist/Rose-DB-Object)和[DBIx::Class](http://search.cpan.org/dist/DBIx-Class)可以从现有的数据库模式为您生成类，也可以将它们写到一组 Perl 模块文件中。

*   [Rose::DB::Object::Loader](http://search.cpan.org/perldoc?Rose::DB::Object::Loader)
*   [DBIx::Class::Schema::Loader](http://search.cpan.org/perldoc?DBIx::Class::Schema::Loader)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T16:38:44.763

[DBIx::Class](http://search.cpan.org/dist/DBIx-Class)具有[DBIx::Class::Schema::Loader](http://search.cpan.org/perldoc?DBIx::Class::Schema::Loader)，它可以从现有数据库为您生成类，也可以将它们写出到文件中。它仅限于加载单个模式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T15:19:43.423

Perl 中有三个常用的 ORM，[Class:DBI](http://search.cpan.org/dist/Class-DBI/)、[DBIx::Class](http://search.cpan.org/dist/DBIx-Class/)和[Rose::DB::Object](http://search.cpan.org/dist/Rose-DB-Object/)。根据 PerlMonks 的[这个](http://www.perlmonks.org/?node_id=700283)页面，他们都可以从数据库中加载元数据，但没有说明如何。

# asp.net - .NET isapi 捕获的 ASP 文件

> ID：362941
> 
> 赞同：1
> 
> 时间：2008-12-12T14:42:28.587
> 
> 标签：asp.net, iis, asp-classic, isapi

我需要从我的 ASP.NET 站点中提供一些 .asp 页面。

这个 ASP.NET 站点有一个处理程序，它允许我们从数据库中提供页面，而不是在磁盘（.asp 文件所在的位置）上查找它们。

问题似乎是 .NET isapi (C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322\aspnet_isapi.dll) 正在捕获我的请求......此时，它会进入数据库并没有找到文件。

我的问题：为什么 ASP.NET 捕捉到我的请求？我认为它应该进来并为.asp 使用正确的扩展名映射（C:\WINDOWS\system32\inetsrv\asp.dll）。

有没有办法告诉 ASP.NET 不理会 .asp 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T16:46:14.640

一种替代方法是设置一个虚拟目录，它只能执行 .asp 并且没有 asp.net 支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T15:49:14.187

听起来您的应用程序配置中有一个通配符脚本映射，将所有请求转发到 aspnet_isapi.dll。.asp 是否映射到 asp.dll？

# xpath - 当属性不存在时，Xpath 查询选择节点？

> ID：362945
> 
> 赞同：26
> 
> 时间：2008-12-12T14:45:13.370
> 
> 标签：xpath, attributes

我想选择不存在特定属性的节点。我试过 Not() 函数，但它不起作用。有办法吗？

示例：以下 Xpath 查询：

```
group/msg[not(@owner)] 
```

应该检索第一个节点而不是第二个节点。但是，SketchPath（测试 Xpath 查询的工具）和我的 C# 代码都认为这两个节点都可以。

```
<group>
    <msg id="EVENTDATA_CCFLOADED_XMLCONTEXT"  numericId="14026"  translate="False"  topicId="302"  status="translated" >
        <text>Context</text>
        <comment></comment>
    </msg>
    <msg id="EVENTDATA_CCFLOADED_XMLCONTEXT_HELP"  numericId="14027"  translate="False"  topicId="302"  status="translated"  owner="EVENTDATA_CCFLOADED_XMLCONTEXT" >
        <text>Provides the new data displayed in the Object.</text>
        <comment></comment>
    </msg>
</group> 
```

* * *

事实上 Not() 函数工作正常，只是我有其他条件和括号没有正确设置。*人为错误*。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-12T15:06:31.907

`string-length(@attr)=0`出于同样的原因，我不得不在一些旧的且不是很标准的 XPath 引擎中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T15:27:52.380

[在使用XPath Explorer](http://sourceforge.net/projects/xpe "XPath 资源管理器")（基于[Jaxen](http://jaxen.org/ "贾森")库）进行测试时为我工作。
所以我想这确实取决于 XPath 的实现。

# cryptography - 如何使用 X509 证书（通过简单验证签署文件，+其他问题）

> ID：362948
> 
> 赞同：2
> 
> 时间：2008-12-12T14:45:52.883
> 
> 标签：cryptography, openssl, x509

昨天我花了几个小时尝试使用 X509 证书（来自 thawte 的“免费邮件”证书之一）对一个短文件进行数字签名。我终于让 openssl 将其签名为 SMIME 消息，但我无法成功验证它，而且它采用 SMIME 格式——我无法访问实际上可以发送 SMIME 文件的“sendmail”程序。

我只想通过简单的剪切和粘贴创建一些“可摘录”的文件，例如：

```
===BEGIN SIGNED DOCUMENT===
===BEGIN DOCUMENT===
blah blah blah this is the plaintext ...
===END DOCUMENT===
===BEGIN SIGNATURE===
AFab12121abadAF ...
===END SIGNATURE===
===END SIGNED DOCUMENT=== 
```

或者，我想我可以制作一个包含原始文件和签名的 .zip 文件。

所以我想我的要求是：

1.  输入明文 = 任意文件
2.  输入signkey =来自X509证书
3.  输出 = 我可以通过剪切和粘贴或附加单个 .zip 文件轻松地通过电子邮件发送给其他人的东西
4.  程序 = 免费和开源的东西，例如 openssl 或 gpg
5.  程序！=一个神奇的 GUI，我不明白发生了什么
6.  能够轻松使用程序从输入中生成输出
7.  能够轻松地从输出中提取明文（例如，直接通过眼睛或作为 .zip 文件的一个组件）
8.  能够验证明文是否由 X509 证书的被授予者（即我）签署，并且证书的授予者 (CA) 是知名 CA……假设我是一个保持证书安全的理性人被其他方使用（否则有人可以像我一样签名）。

有没有关于 X509 证书的好教程以及它们在实践中如何用于这些东西？我有 Schneier 的“应用密码学”的第 2 版，并且在密码算法 + 协议方面有相当多的经验，但对 X509 知之甚少，我真的很困惑证书实际上是什么. （换句话说，“证书是颁发方 CA 的加密断言，即证书中指定的方 X 是 CA 已知的身份？”和“证书使其持有者能够_____”）

当我得到一个时，它会显示在 Firefox 的证书管理器的“您的证书”选项卡中，我可以将其导出并使用 openssl 读取它，但我想确保它不会以任何其他人可以使用的方式存储 w /o 知道证书。密码——我真的很困惑，因为似乎有些证书只有公钥，而其他证书有加密的私钥。

是否有一个围绕 openssl 的良好、简单的 GUI 包装器，可以让您解释它在做什么？

* * *

**编辑：** thawte 不容易让你直接使用证书请求；相反，它与 Web 浏览器（我使用 Firefox）对话，并生成私钥并处理所有证书协议。所以我可以将它导出为 PKCS12 文件，但我不确定如何使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T23:10:23.547

> 所以我可以将它导出为 PKCS12 文件，但我不确定如何使用它。

如果使用 openssl 工具，可以使用命令

```
openssl pkcs12 -in file.p12 -out file.pem 
```

将其转换为 pem 格式。

**编辑**：

> 我无法弄清楚 PEM 和 PKCS12 以及所有这些东西的作用彼此不同

PKCS#12 文件只是证书和密钥的容器。如果你想查看它包含的内容（至少除了加密的部分），你可以使用诸如[dumpasn1 之类的工具](http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.c)类的工具。您从浏览器导出的 PKCS#12 文件将包含加密格式的私钥、您的证书以及 CA 证书，这些证书是形成通往受信任 CA 的链所必需的。

同样，PEM 文件可以包含证书和密钥。在 PEM 文件中，证书和密钥采用 base64 编码并放置在一些文本分隔符中（PKCS#12 文件使用名为 ASN.1 的二进制编码来构造文件 - 您可以将 ASN.1 视为 XML 的二进制形式。您遇到的大多数加密结构都将使用 ASN.1) 进行编码。除此之外，格式之间唯一真正的区别是 PKCS#12 包含完整性检查 - 否则格式是等效的。

OpenSSL 最适合 PEM，而大多数浏览器和电子邮件应用程序都需要 PKCS#12，但您可以在格式之间自由转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T18:17:54.030

首先，您可能需要了解私钥、公钥和证书之间的区别。证书是在声明“公钥 XX 属于个人 YY”上带有 CA 私钥的签名。如果您使用您的私钥签名，则可以使用您的公钥验证签名，信任 CA 的第三方可以断定签名是由您签名的。

如果您生成 S/MIME 消息并将其作为扩展名为 .p7s 的文件附加，大多数邮件程序可能能够验证它。

如果你想完全控制你正在做的事情，我的经验是围绕 PGP 格式的工具可以让你更好地控制（与实现 S/MIME 协议的邮件程序相比）。

# c++ - C++ 构造“placement new”的用途是什么？

> ID：362953
> 
> 赞同：14
> 
> 时间：2008-12-12T14:47:01.853
> 
> 标签：c++, memory, new-operator, placement-new, equivalence

我刚刚了解了名为“placement new”的 C++ 构造。它允许您精确控制指针在内存中指向的位置。它看起来像这样：

```
 #include <new>        // Must #include this to use "placement new"
 #include "Fred.h"     // Declaration of class Fred

 void someCode()
 {
   char memory[sizeof(Fred)];
   void* place = memory;

   Fred* f = new(place) Fred();   // Create a pointer to a Fred(),
                                  // stored at "place"

   // The pointers f and place will be equal

   ...
 } 
```

（来自[C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.10 "C++ 常见问题解答精简版")的示例）

在此示例中，`this`Fred 的指针将等于`place`。

* * *

我已经看到它在我们团队的代码中使用过一两次。根据您的经验，这种结构能带来什么？其他指针语言有类似的结构吗？对我来说，这似乎让人想起`equivalence`FORTRAN，它允许不同的变量占据内存中的相同位置。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-12T15:03:34.283

它允许您进行自己的内存管理。通常，这最多只会让您的性能略有提高，但有时这是一个巨大的胜利。例如，如果您的程序使用大量标准大小的对象，您可能希望创建一个分配一个大内存的池。

这类事情也在 C 中完成，但由于 C 中没有构造函数，因此不需要任何语言支持。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-12T15:02:16.970

它还用于嵌入式编程，其中 IO 设备通常映射到特定的内存地址

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-12T18:28:33.387

它在构建自己的容器（如对象）时很有用。

例如，如果您要创建一个矢量。如果您为大量对象保留空间，您希望使用某种不调用对象构造函数的方法（如 new char[sizeof(object) * reserveSize]）分配内存。然后，当人们开始将对象添加到向量中时，您可以使用placement new 将它们复制到分配的内存中。

```
template<typename T>
class SillyVectorExample
{
    public:
        SillyVectorExample()
            :reserved(10)
            ,size(0)
            ,data(new char[sizeof(T) * reserved])
        {}
        void push_back(T const& object)
        {
            if (size >= reserved)
            {
                // Do Somthing.
            }
            // Place a copy of the object into the data store.
            new (data+(sizeof(T)*size))  T(object);
            ++size;
        }
        // Add other methods to make sure data is copied and dealllocated correctly.
    private:
        size_t   reserved;
        size_t   size;
        char*    data;
 }; 
```

PS。我不提倡这样做。这只是容器如何工作的一个简化示例。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-12T15:13:02.080

我在共享内存段中构造对象时使用过它。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-12T14:55:37.327

放置 new 可用于创建类型安全的联合，例如 Boost 的`variant`.

union 类包含一个与其指定包含的最大类型一样大的缓冲区（并且具有足够的对齐方式）。它`new`根据需要将对象放置到缓冲区中。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-12T14:51:46.740

我在内核模式下做 C++ 时使用这个结构。

我使用内核模式内存分配器并在分配的块上构造对象。

所有这些都包含在类和函数中，但最后我做了一个新的放置。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-13T04:12:41.710

放置 new 不是为了让指针相等（你可以使用赋值！）。

Placement new 用于在特定位置构造对象。在 C++ 中有三种构造对象的方法，而放置 new 是唯一一种可以让您显式控制该对象“存在”的位置的方法。这对一些事情很有用，包括共享内存、低级设备 I/O 和内存池/分配器实现。

通过堆栈分配，对象在堆栈顶部构造，无论当前碰巧在哪里。

使用“常规”new，对象在堆上的一个有效的任意地址构造，由标准库管理（除非您覆盖了 operator new）。

放置 new 说“专门在这个地址为我构建一个对象”，它的实现只是 operator new 的重载，它返回传递给它的指针，作为获取 new 运算符的其余机制的一种手段，它构造运算符 new 函数返回的内存中的对象。

还值得注意的是 operator new 函数可以用任意参数重载（就像任何其他函数一样）。这些其他参数通过“new(arg 2, arg3, ..., argN)”语法传递。Arg1 总是隐式传递为“sizeof（无论你在构造什么）”。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-13T06:16:38.293

通过控制确切的位置，您可以对齐内存中的内容，这*有时*可用于提高 CPU 获取/缓存性能。虽然从未真正看到它在使用中

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-13T03:54:41.030

Placement new 允许开发人员从预先分配的内存块中分配内存。如果系统更大，那么开发人员会选择使用placement new。现在我正在开发一个更大的航空电子软件，我们在开始时分配执行应用程序所需的大内存。我们使用placement new 在需要的地方分配内存。它将性能提高到一定程度。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-12T14:55:14.083

它在将内存分页到硬盘驱动器上的文件时很有用，在操作大型对象时可能会这样做。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-12T15:09:12.430

在我看来，这就像在堆栈上分配对象的一种方式..

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-13T05:18:02.467

我用它来创建基于包含从网络接收到的消息的内存的对象。

# c# - 使用泛型来实例化对象的工厂类是个好主意吗？

> ID：362955
> 
> 赞同：3
> 
> 时间：2008-12-12T14:47:23.973
> 
> 标签：c#, generics, factory

使用泛型来实例化对象的工厂类是个好主意吗？

假设我有一个类 Animal 和一些子类（Cat、Dog 等）：

```
abstract class Animal
{
    public abstract void MakeSound();
}

class Cat : Animal
{
    public override void MakeSound()
    {
        Console.Write("Mew mew");
    }
}

class Dog : Animal
{
    public override void MakeSound()
    {
        Console.Write("Woof woof");
    }
}

static class AnimalFactory
{
    public static T Create<T>() where T : Animal, new()
    {
        return new T();
    }
} 
```

然后在我的代码中，我会像这样使用 AnimalFactory：

```
class Program
{
    static void Main(string[] args)
    {
        Dog d = AnimalFactory.Create<Dog>();
        d.MakeSound();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T14:52:41.933

取决于你想用它做什么。您提供的示例并没有那么有用，因为它所做的只是调用 new() 这也是您可以在代码中执行的操作。如果您想将必须在对象创建过程中运行的逻辑放置在要创建的对象之外的某个地方，但也远离实例化对象的代码，那么工厂会更有用。

有鉴于此，这取决于您希望在工厂中运行什么逻辑，以及该逻辑是否也可以使用与工厂相同的通用约束来写入。如果没有，您可能需要一种称为抽象工厂的模式，它使用通用工厂在幕后为类型实例化正确的特定工厂，以创建手头的对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T15:07:17.803

是的，非泛型类中的工厂方法通常很有用。特别是，泛型*方法*可以应用类型推断，而泛型*类型*不能。

我有时也有两层工厂 - 对于具有 2 个类型参数的泛型类型，我可能有：

```
class Foo
{
    static Foo<TKey, TValue> Create<TKey, TValue>(TKey key, TValue value) 
    {...}
}

class Foo<TKey>
{
    static Foo<TKey, TValue> Create<TValue>(TValue value)
    {...}
}

class Foo<TKey, TValue>
{
} 
```

这允许：

```
Foo.Create(x, y);
Foo<string>.Create(y);
new Foo<string, int>(x, y); 
```

我有一个包含更多示例和推理的[博客条目。](http://codeblog.jonskeet.uk/2008/08/06/making-the-most-of-generic-type-inference/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T03:54:48.793

我建议将工厂关注点与构造函数关注点分开。这允许不同的实例化策略：

```
public interface IFactory<T>
{
    T Create();
}

public class DefaultConstructorFactory<T> : IFactory<T> where T : new()
{
    public T Create()
    {
        return new T();
    }
}

public class ActivatorFactory<T> : IFactory<T>
{
    public T Create()
    {
        return Activator.CreateInstance<T>();
    }
}

public class AnimalTamer<TAnimal> where TAnimal : Animal
{
    IFactory<TAnimal> _animalFactory;

    public AnimalTamer(IFactory<TAnimal> animalFactory)
    {
        if(animalFactory == null)
        {
            throw new ArgumentNullException("animalFactory");
        }

        _animalFactory= animalFactory;
    }

    public void PutOnShow()
    {
        var animal = _animalFactory.Create();

        animal.MakeSound();
    }
}

class Program
{
    static void Main(string[] args)
    {
        var tamer = new AnimalTamer<Tiger>(new DefaultConstructorFactory<Tiger>());

        tamer.PutOnShow();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T15:12:01.460

来自此的更烦人的事情之一，并且可能有一种解决方法，就是您被困在使用无参数构造函数中。据我所知，你不能这样做：

```
public class Factory  
{
  public static T Create<T>() where T : ParentClass, new(String)
  {

  }
} 
```

或这个

```
public class Factory  
{
  public static T Create<T>() where T : ParentClass
  {
    T child = new T("hi")
  }
} 
```

或者更有趣的是：

```
public class Factory  
{
  public static T Create<T>() where T : ParentClass, new()
  {
    T child;

    child = new T();

    if (child is ChildClass)
    {
      child = new ChildClass("hi");
    }

    return child;
  }
} 
```

这可能会限制您使用某些类设计。如果您不想只调用默认构造函数，这可能是个问题。

除非有人找到解决此问题的方法。

我知道我在使用 Activator.CreateInstance() 时也遇到了这个问题，因为实际上所做的只是调用无参数构造函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-19T23:28:12.383

在运行时之前一无所知或知之甚少的情况下，您可以通过使用打开/关闭泛型和函数来使其更加动态。似乎您对泛型有很好的掌握，所以请继续努力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T15:07:46.817

为构造函数使用泛型称为抽象工厂模式。

它很好，但只有在你使用它的情况下，在这个例子中你至少有一些工厂的默认值。

```
static class AnimalFactory
{
    public static Animal Create<T>() where T : Animal
    {
       return Create<T>("blue");
    }

    public static Animal Create<T>(string colour) where T : Animal, new()
    {
       return new T() {Colour = colour};
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T16:26:09.017

> 使用泛型来实例化对象的工厂类是个好主意吗？

对于您描述的情况，不，不是。您只是为了使用模式而使用模式，并且从示例中，只会使事情变得不必要地复杂化。

现在，如果您的应用程序有多个实现某个接口的对象，并且您根据配置文件加载其中一个对象，那么是的，使用工厂创建该对象是有意义的。

这个问题的泛型部分实际上来自工厂实现本身。我没有支持代码，但这是我设想调用代码的样子：

```
Factory<IAwesome> awesomeFactory = new Factory<IAwesome>();
IAwesome awesomeObject = awesomeFactory.Load(configValue); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-15T05:36:33.020

是的。创建设计模式（[http://en.wikipedia.org](http://en.wikipedia.org)）与泛型配合得很好。并且泛型可能有点复杂（[http://www.artima.com/intv/genericsP.html](http://www.artima.com/intv/genericsP.html)），因此可以在某种工厂中隐藏任何构造复杂性以使客户更容易。

# database - 谷歌使用什么数据库？

> ID：362956
> 
> 赞同：382
> 
> 时间：2008-12-12T14:48:04.517
> 
> 标签：database, google-search, google-cloud-datastore, bigtable

是 Oracle 还是 MySQL 还是他们自己构建的东西？

* * *

## 回答 #1

> 赞同：597
> 
> 时间：2008-12-12T14:53:52.087

## 大表

[结构化数据的分布式存储系统](http://research.google.com/archive/bigtable.html)

> Bigtable 是一个分布式存储系统（由 Google 构建），用于管理结构化数据，旨在扩展到非常大的规模：数千个商品服务器中的 PB 级数据。
> 
> Google 的许多项目都将数据存储在 Bigtable 中，包括网络索引、Google 地球和 Google 财经。这些应用程序在数据大小（从 URL 到网页再到卫星图像）和延迟要求（从后端批量处理到实时数据服务）方面对 Bigtable 提出了非常不同的要求。
> 
> 尽管有这些不同的需求，Bigtable 还是成功地为所有这些 Google 产品提供了灵活、高性能的解决方案。

**一些功能**

*   快速且超大规模的 DBMS
*   一个稀疏的、分布式的多维排序图，共享面向行和面向列的数据库的特征。
*   旨在扩展到 PB 级
*   它适用于数百或数千台机器
*   很容易向系统中添加更多机器并自动开始利用这些资源而无需重新配置
*   每个表都有多个维度（其中一个是时间字段，允许版本控制）
*   通过将表格拆分为多个平板电脑，表格针对 GFS（Google 文件系统）进行了优化 - 表格的片段沿所选行拆分，以便平板电脑的大小约为 200 兆字节。

**建筑学**

BigTable 不是关系数据库。它不支持连接，也不支持丰富的类似 SQL 的查询。每个表都是一个多维稀疏映射。表格由行和列组成，每个单元格都有一个时间戳。可以有具有不同时间戳的多个版本的单元。时间戳允许诸如“选择此网页的‘n’个版本”或“删除早于特定日期/时间的单元格”之类的操作。

为了管理巨大的表，Bigtable 在行边界处拆分表并将它们保存为平板电脑。一个平板大约 200 MB，每台机器节省大约 100 个平板。这种设置允许来自单个表的平板电脑分布在许多服务器上。它还允许细粒度的负载平衡。如果一个表正在接收许多查询，它可以摆脱其他平板电脑或将繁忙的表移动到另一台不那么繁忙的机器上。此外，如果一台机器出现故障，平板电脑可能会分布在许多其他服务器上，因此对任何给定机器的性能影响最小。

表存储为不可变的 SSTables 和日志尾部（每台机器一个日志）。当机器用完系统内存时，它会使用 Google 专有的压缩技术（BMDiff 和 Zippy）压缩一些平板电脑。Minor compaction 只涉及几个 tablet，而 Major compaction 涉及整个 table 系统并恢复硬盘空间。

Bigtable tablet 的位置存储在单元格中。任何特定平板电脑的查找都由三层系统处理。客户端得到一个指向 META0 表的点，其中只有一个。META0 表跟踪许多 META1 tablet，其中包含正在查找的 tablet 的位置。META0 和 META1 都大量使用预取和缓存来最大程度地减少系统中的瓶颈。

**执行**

BigTable 建立在**Google 文件系统**(GFS) 之上，该系统用作日志和数据文件的后备存储。GFS 为 SSTables 提供可靠的存储，SSTables 是一种用于持久化表数据的 Google 专有文件格式。

BigTable 大量使用的另一项服务是**Chubby**，这是一种高可用、可靠的分布式锁服务。Chubby 允许客户端获取锁，可能将其与一些元数据相关联，它可以通过将保持活动消息发送回 Chubby 来更新这些元数据。锁存储在类似文件系统的分层命名结构中。

Bigtable 系统中有三种主要的**服务器类型：**

1.  主服务器：将平板电脑分配给平板电脑服务器，跟踪平板电脑的位置并根据需要重新分配任务。
2.  平板服务器：处理平板的读/写请求，并在平板超过大小限制（通常为 100MB - 200MB）时拆分平板。如果一个 tablet server 发生故障，那么 100 个 tablet server 每个会拾取 1 个新 tablet，系统会恢复。
3.  锁服务器：Chubby 分布式锁服务的实例。BigTable 中的许多操作都需要获取锁，包括打开 tablet 进行写入、确保一次不超过一个活动 Master 以及访问控制检查。

**谷歌研究论文中的例子：**

![替代文字](https://i.stack.imgur.com/oN41X.png)

> 存储网页的示例表的一部分。行名称是一个 **反向 URL**。内容列族包含**页面内容**，锚列族包含 引用页面**的任何锚的文本。**CNN 的主页被 Sports Illustrated 和 MY-look 主页引用，因此该行包含名为 `anchor:cnnsi.com`和 的列`anchor:my.look.ca`。每个锚单元都有**一个版本**；内容列有**三个版本**，在时间戳 `t3`，`t5`和`t6`。

**API**

BigTable 的典型操作是创建和删除表和列族，写入数据和从一行中删除列。BigTable 以 API 的形式向应用程序开发人员提供此功能。在行级别支持事务，但不支持跨多个行键。

* * *

这是[研究论文 PDF 的链接](http://research.google.com/archive/bigtable-osdi06.pdf)。

在这里，您可以找到一段[视频，展示了 Google 的 Jeff Dean 在华盛顿大学的一次演讲中](http://norfolk.cs.washington.edu/htbin-post/unrestricted/colloq/archive.cgi?id=437)，讨论了 Google 后端使用的 Bigtable 内容存储系统。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-12-12T14:49:52.923

这是他们自己构建的东西——它被称为 Bigtable。

[http://en.wikipedia.org/wiki/BigTable](http://en.wikipedia.org/wiki/BigTable)

谷歌有一篇关于数据库的论文：

[http://research.google.com/archive/bigtable.html](http://research.google.com/archive/bigtable.html)

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2013-09-28T18:44:59.880

[Spanner](http://en.wikipedia.org/wiki/Spanner_%28database%29)是 Google 的全球分布式关系数据库管理系统 (RDBMS)，是[BigTable](http://en.wikipedia.org/wiki/BigTable)的继任者。谷歌声称它不是一个纯粹的关系系统，因为每个表都必须有一个主键。

[这](http://research.google.com/archive/spanner.html)是论文的链接。

> Spanner 是 Google 的可扩展、多版本、全球分布和同步复制的数据库。它是第一个在全球范围内分发数据并支持外部一致的分布式事务的系统。本文介绍了 Spanner 的结构、其功能集、各种设计决策的基本原理，以及一种暴露时钟不确定性的新颖时间 API。此 API 及其实现对于支持外部一致性和各种强大功能至关重要：过去的非阻塞读取、无锁只读事务和原子模式更改，跨越所有 Spanner。

Google 发明的另一个数据库是[Megastore](http://research.google.com/pubs/pub36971.html)。这是摘要：

> Megastore 是为满足当今交互式在线服务需求而开发的存储系统。Megastore 以一种新颖的方式将 NoSQL 数据存储的可扩展性与传统 RDBMS 的便利性融合在一起，并提供强一致性保证和高可用性。我们在细粒度的数据分区中提供完全可序列化的 ACID 语义。这种分区允许我们以合理的延迟在广域网上同步复制每个写入，并支持数据中心之间的无缝故障转移。本文描述了 Megastore 的语义和复制算法。它还描述了我们支持使用 Megastore 构建的各种 Google 生产服务的经验。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-12-12T15:11:14.830

正如其他人所提到的，谷歌使用了一种名为 BigTable 的本土解决方案，并且他们已经发布了一些将其描述到现实世界中的论文。

Apache 人员对这些论文中提出的想法有一个实现，称为[HBase](http://hadoop.apache.org/hbase/)。HBase 是更大的 Hadoop 项目的一部分，根据他们的网站，该项目*“是一个软件平台，可以让人们轻松编写和运行处理大量数据的应用程序”。*一些基准非常令人印象深刻。他们的网站位于[http://hadoop.apache.org](http://hadoop.apache.org)。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-12-12T15:05:23.983

尽管 Google 将 BigTable 用于所有主要应用程序，但他们[也将 MySQL](http://www.mysql.com/customers/customer.php?id=75)用于其他（可能是次要的）应用程序。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-01-20T13:49:10.723

知道 BigTable 不是一个关系数据库（如 MySQL）而是一个巨大的（分布式）[哈希表](http://en.wikipedia.org/wiki/Hash_table)，它具有非常不同的特性，这可能也很方便。您可以在[Google AppEngine](http://code.google.com/appengine/)平台上自己使用 BigTable（有限版本）。

除了上面提到的 Hadoop，还有许多其他实现试图解决与 BigTable 相同的问题（可扩展性、可用性）。[我昨天看到一篇不错的博客文章，在这里](http://www.metabrew.com/article/anti-rdbms-a-list-of-distributed-key-value-stores/)列出了其中的大部分。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-03-14T17:33:19.520

谷歌主要使用 Bigtable。

Bigtable 是一个分布式存储系统，用于管理结构化数据，旨在扩展到非常大的规模。

[如需更多信息，请从此处](http://labs.google.com/papers/bigtable.html)下载文档。

谷歌还在他们的一些应用程序中使用 Oracle 和 MySQL 数据库。

非常感谢您可以添加的任何更多信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-01-09T18:39:25.900

Google 服务具有多语言持久性架构。BigTable 被其大部分服务所利用，如 YouTube、谷歌搜索、谷歌分析等。搜索服务最初使用 MapReduce 作为其索引基础设施，但后来在 Caffeine 发布期间过渡到 BigTable。

Google Cloud 数据存储区有超过 100 个在 Google 生产中的应用程序，面向内部和外部用户。Gmail、Picasa、Google 日历、Android Market 和 AppEngine 等应用程序使用 Cloud Datastore 和 Megastore。

Google 趋势使用 MillWheel 进行流处理。Google Ads 最初使用 MySQL，后来迁移到 F1 DB - 一种自定义编写的分布式关系数据库。Youtube 使用 MySQL 和 Vitess。谷歌借助谷歌文件系统在商品服务器上存储 EB 级数据。

资料来源：[谷歌数据库：谷歌服务如何存储 PB-Exabyte 规模的数据？](https://www.8bitmen.com/google-database-how-do-google-services-store-petabyte-exabyte-scale-data/)

[YouTube 数据库 – 它如何在不耗尽存储空间的情况下存储这么多视频？](https://www.8bitmen.com/youtube-database-how-does-it-store-so-many-videos-without-running-out-of-storage-space/)

[![在此处输入图像描述](https://i.stack.imgur.com/nOHXD.jpg)](https://i.stack.imgur.com/nOHXD.jpg)

# java - 在 Java 中，如果在操作中使用 Double.NaN 会发生什么？

> ID：362958
> 
> 赞同：7
> 
> 时间：2008-12-12T14:49:17.497
> 
> 标签：java, nan

我编译了错误地尝试添加数字和 Double.NaN 的代码。我想知道它是否抛出了一个没有被捕获的异常？有谁知道这种情况是如何处理的？
谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T14:52:08.300

将一个数字添加到 NaN 会得到 NaN。预计不会导致异常。我知道这符合 IEEE 754。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T15:09:24.240

回答史蒂夫 B 的问题：

POSITIVE_INFINITY 是您可以存储的最大正数，如果您有无限的存储空间。如果没有这种奢侈，我们必须使用像 1.0 / 0.0 这样的结构，它做得很好。NEGATIVE_INFINITY 也是如此，但最大的负数也是如此。

NaN 通常定义为 0.0 / 0.0，因为没有像 0/0 这样的数字，因此完全符合 NaN 的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T14:55:42.303

```
public static void main(String args[])
{
    Double d = Double.NaN + 1.0;
    System.out.println(d);
} 
```

打印 Double.Nan。谁能解释源代码实现？

```
 public static final double POSITIVE_INFINITY = 1.0 / 0.0;
  public static final double NEGATIVE_INFINITY = -1.0 / 0.0;
  public static final double NaN = 0.0d / 0.0; 
```

# user-interface - 改进 Web 登录屏幕

> ID：362961
> 
> 赞同：5
> 
> 时间：2008-12-12T14:50:29.443
> 
> 标签：user-interface, login

我正在尝试获取有关如何开发 Web 登录屏幕的一些想法。我正在使用 DynamicData Webforms，因此大多数强大的框架都提供了很多选项，但我将非常感谢阅读您的建议。

提前致谢

已编辑：除了功能之外，我还想阅读您对演示模型的看法，我说，我使用 fx3.5，因此为单个登录或使用登录 aspx 控件改进了 2 个以上的文本框，我记住了使用silverlight，但可以在不更改所有表示层的情况下“点亮我的webapp”，它是在webforms 和dynamicdata 中构建的？

更难以理解：使用 Extjs 作为视图层的表示框架的示例，但我的项目是 webforms，所以这对 MVC.net 来说会很好，我说原因在 json 问题上更灵活

[替代文字 http://rodotelmi.rebstech.com/wp-content/uploads/2008/07/picture-1.png](http://rodotelmi.rebstech.com/wp-content/uploads/2008/07/picture-1.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-12T15:07:34.870

请查看 65 多个登录屏幕示例以获取灵感……

[65+登录表单设计](http://www.smileycat.com/design_elements/login_forms/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T14:59:32.717

我会说这取决于您的应用程序。如果您正在开发一个公共网站，希望增加注册用户的数量并增加您的公共可用页面的点击次数，那么每个页面上的全功能*登录或方便的登录控制是有意义的。如果它是一个需要登录才能访问任何内容的 Intranet 应用程序，那么一个包含最少信息的简单登录页面是合适的。您还需要决定登录是否在浏览器会话中持续存在，以及是否要给用户一个选择，这将决定您是否需要“记住我”按钮。如果合适，您还想提供联系信息和基本帮助（或找回丢失的 ID/密码的方法）的链接。

*   我所说的全功能是指类似于@Danny 的建议，即可以从登录页面轻松访问应用程序的其他部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T14:57:55.763

我不喜欢网站只有一个字段而不是您需要按下按钮的字段，而不是密码字段：分两步。

**保持简单和极简主义**。我建议您在用户未登录且不让他进入登录页面时在所有窗口中都设置登录屏幕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T14:52:40.623

*   有 2 个文本框：电子邮件（或用户名）和密码。
*   提交按钮。
*   “忘记密码”的链接。
*   “记住我”的复选框。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T14:55:52.413

一个好的登录屏幕的诀窍是让它像你的应用程序的其余部分一样有趣，并在那里和你的应用程序中为用户提供有用的链接和其他信息（当然，任何不需要凭据的东西）。

看看 Facebook 登录页面就是一个很好的例子。除了正常的登录基础设施外，您还可以从那里搜索用户、注册网站、查看他们的政策等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T14:57:41.440

诀窍是尽可能少地从谷歌 UI 中学习

这本书是 UI 设计的好书，不需要你花太多时间阅读[不要让我思考](https://rads.stackoverflow.com/amzn/click/com/0321344758)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T15:06:09.257

尽可能保持简单和友好。如果它在自己的屏幕上，使其成为关键焦点非常重要，因此最小化页面以仅显示您需要的内容，否则使其在标题或侧边栏中突出。

如需设计和布局灵感，请查看[Pattern Tap](http://patterntap.com/tap/collection/login)或[box.mepholio](http://box.mepholio.com/collections/13/recent)。

为了获得最佳的用户体验和表单完成时间，如果您有足够的垂直空间，例如[http://www.sanchothefat.com/projects/forms/login](http://www.sanchothefat.com/projects/forms/login) ，顶部对齐的标签和左对齐的提交按钮是不错的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-23T21:18:32.860

This resource can be useful too. [http://webdesignledger.com/inspiration/interface-design-loginsignup](http://webdesignledger.com/inspiration/interface-design-loginsignup)

# java - 在 grails 中上传图片

> ID：362972
> 
> 赞同：3
> 
> 时间：2008-12-12T14:54:40.853
> 
> 标签：java, grails, groovy, frameworks

我是 grails 的新手。我正在做从客户端上传图像并将其存储在服务器中的 Web 应用程序。

我的 Gsp 代码是：

```
<g:uploadForm action="saveImage">
<input type="file" name="image"> 
<input type="submit" value="Submit">
</g:uploadForm> 
```

我在控制器中的 saveImage 操作是：

```
def saveImage={
def file = request.getFile('image')
        if (file && !file.empty) {
            file.transferTo(new java.io.File("image.jpg"))
            flash.message = 'Image uploaded'
            redirect(action: 'uploadImage')
        }
} 
```

在这段代码中，如果我上传一些其他文件，如文本文件，它会抛出异常。为此，我想检查文件扩展名，并且我想使用 If 循环来确保上传的文件是图像文件。但我不知道如何找到grails 中的文件扩展名。

有没有其他方法可以在 grails 应用程序中上传图像。它必须只接受图像文件。

谁能提供帮助？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-14T02:27:59.343

我不知道以下答案是找到文件扩展名的正确方法。我对此也很陌生。但是这个答案有效

使用**file.getOriginalFilename()**方法。它返回一个类似“test.jpg”的字符串。然后你使用tokenize方法将文件名拆分为“.”。然后你从拆分列表中取出最后一个字符串元素。这是文件的扩展名.现在你可以做剩下的过程了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-14T03:08:32.180

从 file.getOriginalFilename() 获取文件扩展名效果很好。我认为这是更好的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-13T07:39:28.243

```
if(params?.photo?.getContentType()=='image/jpeg' || 
   params?.photo?.getContentType()=='image/gif' ||
   params?.photo?.getContentType()=='image/png' || 
   params?.photo?.getContentType()=='image/bmp'
) 
```

我想你可以试试这个

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T14:01:52.477

有一个小问题`file.getContentType()`。Windows 和其他系统处理它的方式不同。

例如**.csv**文件将`text/plain`在其他系统中，但`application/vnd.ms-excel`在 Windows 上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-01T10:26:51.697

好吧，这真的很晚了。但是我发现最好的解决方案（因为扩展并没有真正说明内容）是使用`file.getContentType()`......

例如，对于 jpeg 图像，返回值将是一个`image/jpeg`您可以轻松测试的字符串。其他文件格式（png、gif、...）也是如此。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-29T00:25:17.997

您可以使用[Files.probeContentType(filePath)](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#probeContentType%28java.nio.file.Path%29)来确定文件类型

# .net - 在 VB asp.net 2.0 中对数据表的行进行分组

> ID：362979
> 
> 赞同：3
> 
> 时间：2008-12-12T14:56:11.227
> 
> 标签：.net, vb.net, datatable

顾名思义，我正在尝试对数据表中的行进行分组。更详细地说，该表具有相同的行，除了一个字段（列）。基本上我要做的是将相同行的所有不同字段放入单个字段中，同时删除其他行。

这是我目前使用的语法

```
 Dim i As Integer
    Dim j As Integer
    For i = 0 To (ds.Tables(0).Rows.Count() - 1) Step 1
        If (i < ds.Tables(0).Rows.Count()) Then
            roleHtml = "<table><tr><td>" + ds.Tables(0).Rows(i).Item("roleName") + "</td></tr>"
            For j = (ds.Tables(0).Rows.Count() - 1) To 0 Step -1
                If (ds.Tables(0).Rows(i).Item("UserName") = ds.Tables(0).Rows(j).Item("UserName")) And (ds.Tables(0).Rows(i).Item("roleName") IsNot ds.Tables(0).Rows(j).Item("roleName")) Then
                    roleHtml += "<tr><td>" + ds.Tables(0).Rows(j).Item("roleName") + "</td></tr>"
                    ds.Tables(0).Rows.Remove(ds.Tables(0).Rows(j))
                    i -= 1
                End If
            Next j
            roleHtml += "</table>"
            ds.Tables(0).Rows(i).Item("roleName") = roleHtml
        End If
    Next i 
```

问题是当删除行时，他们的索引发生了变化，基本上该字段被扔到与它无关的另一行中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T16:45:31.253

好吧，我可以帮助处理循环结构。这与您正在做的事情不完全匹配（它使表格完好无损，只是构建了一个大字符串，并且还假设表格以特定方式排序），但它将使用您的实际数据演示经典的控制中断处理。为此，表需要按用户排序，然后按角色排序。

```
Dim i As Integer = 0
Dim CurUser As String = ""
Dim CurRole As String = ""
Dim result As new StringBuilder()
Dim r as DataRowCollection = ds.Tables(0).Rows

While i < r.Count
    'Next User:'
    CurUser = r(i)("UserName")
    result.AppendFormat("<h2>{0}</h2>", CurUser).AppendLine()
    result.AppendLine("<table>")

    While i < r.Count AndAlso CurUser = r(i)("UserName")
        'Next Role:'
        CurRole = r(i)("roleName")
        result.AppendFormat("<tr><td>{0}</td></tr>", CurRole).AppendLine()

        While i < r.Count AndAlso CurUser = r(i)("UserName") AndAlso CurRole = r(i)("roleName")
            i += 1 'Next Record: same user, role '
        End While
        'Finished this role'
    End While
    'Finished this user:'
     result.AppendLine("</table>").AppendLine()
End While 
```

这有***3 个***嵌套循环，而不仅仅是你的两个。然而，它仍然获得*线性*性能：它只会遍历每条记录一次。它之所以有效，是因为所有循环共享相同的计数器，该计数器仅在内部循环中递增，并且它们都具有相同的基本结束条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T15:44:12.843

[最近我不得不用控制中断](http://en.wikipedia.org/wiki/Control_break)风格的报告 做类似的事情。

我结束了将数据绑定到一个转发器控件，其中项目模板只是一个文字控件。然后我处理了 OnItemDataBound 事件，并使用与您的代码有点相似的代码来检查，只要“控制”（在控制中断意义上而不是 Web 控制意义上）列匹配，只需将剩余列的值添加到一个类-level 变量并将 e.Item.Visible 设置为 false。当它们不再匹配时，我将 e.Item.Visible 保留为 true（默认）并将文字控件的 Text 属性设置为我正在处理的行所需的 html。

我确信有更好的方法来做到这一点，但是使用 asp.net 查找控制中断报告的信息并不容易：`control`在这个难以克服的域中搜索时，这个词具有双重含义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:08:35.120

这很难阅读，这通常意味着它已经准备好进行一些重组。

您能详细说明您想要实现的目标吗？你想在你的数据表中留下什么？

数据是否已排序，或者您可以在数据库中进行排序吗？如果它已排序，那么您只需要一个循环即可。

我会做以下事情：

*   对数据表进行排序
*   为您的结果创建一个新的数据表
*   按顺序单步执行，保留最后一个用户名和当前角色列表的变量。如果用户名与最后一个不同，则使用最后一个用户名和当前角色列表向您的数据表添加一个新行。如果用户名相同，则附加到角色列表。到最后不要忘记添加最后一行。

这解决了从您正在单步执行的集合中删除行的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T17:04:06.490

显然我的代码有效。i -=1 行是额外的。很抱歉给您带来不便，感谢您的帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-27T13:44:04.430

循环部分看起来像是被覆盖了。

但是，如果您没有意识到**诀窍是从下往上**（或从最后一个元素到第一个元素，或者您想表达它），那么在循环时选择性地（或全部）删除项目可能会很快变得讨厌.

这就是问题删除部分的全部答案。

当您从最后一个到第一个工作时，删除编号列表中的项目只会影响您已经处理的项目的索引 - 那谁在乎，对吧？

-T。

# msbuild - 规范化 MSBuild 中的项目列表

> ID：362983
> 
> 赞同：7
> 
> 时间：2008-12-12T14:57:40.893
> 
> 标签：msbuild, unique, distinct, normalize

我正在尝试获取项目根目录下所有单元测试程序集的列表。我可以这样做：

```
<CreateItem Include="**\bin\**\*.UnitTest.*.dll">
   <Output TaskParameter="Include" ItemName="Items"/>
</CreateItem> 
```

但是，这将多次找到相同的 DLL，因为它们存在于多个子目录中。有没有一种简单的方法可以根据项目元数据（即文件名和扩展名）进行规范化，以便获得唯一的单元测试 DLL 列表？还是我必须求助于编写自己的任务？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-26T15:00:27.320

尽管这很旧，但我永远无法让 Thomas 解决方案自己工作，但我确实找到了一种解决方法，仅使用带有 msbuild v4.0 的内置命令：

```
<ItemGroup>
    <TestAssemblies Include="$(SolutionRoot)\**\bin\*.Tests.dll" />
    <TestItems Include="%(TestAssemblies.FileName)%(TestAssemblies.Extension)">
        <ItemPath>%(TestAssemblies.Identity)</ItemPath>
    </TestItems>
    <DistinctTestItems Include="@(TestItems->Distinct())"></DistinctTestItems>
</ItemGroup>
<Message Text="%(DistinctTestItems.ItemPath)" Importance="high" /> 
```

文档：[项目功能](https://msdn.microsoft.com/en-us/library/ee886422.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-23T15:23:49.393

[MSBuild 扩展包](https://github.com/mikefourie/MSBuildExtensionPack)包含任务*MSBuildHelper*，支持命令*RemoveDuplicateFiles*。

```
<CreateItem Include="**\bin\**\*.UnitTest.*.dll">
    <Output TaskParameter="Include" ItemName="Items"/>
</CreateItem>
<MSBuild.ExtensionPack.Framework.MsBuildHelper TaskAction="RemoveDuplicateFiles" InputItems1="@(Items)">
    <Output TaskParameter="OutputItems" ItemName="Items"/>
</MSBuild.ExtensionPack.Framework.MsBuildHelper> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-14T16:10:44.830

我在网上进行了很好的搜索，但找不到任何方法。如果有人知道一种干净的内置方式，请告诉我。与此同时，我写了一个简单的任务来完成这项工作。用法如下所示：

```
<NormalizeByMetadata Items="@(ItemsToNormalize)" MetadataName="Filename">
    <Output TaskParameter="NormalizedItems" ItemName="MyNormalizedItems"/>
</NormalizeByMetadata> 
```

执行上述任务后，`MyNormalizedItems`将仅包含那些`ItemsToNormalize`对元数据具有唯一值的项目`Filename`。如果两个或多个项目的`Filename`元数据具有相同的值，则第一个匹配项将包含在输出中。

MSBuild 任务的代码是：

```
public class NormalizeByMetadata : Task
{
    [Required]
    public ITaskItem[] Items
    {
        get;
        set;
    }

    [Required]
    public string MetadataName
    {
        get;
        set;
    }

    [Output]
    public ITaskItem[] NormalizedItems
    {
        get;
        private set;
    }

    public override bool Execute()
    {
        NormalizedItems = Items.Distinct(new ItemEqualityComparer(MetadataName)).ToArray();
        return true;
    }

    private sealed class ItemEqualityComparer : IEqualityComparer<ITaskItem>
    {
        private readonly string _metadataName;

        public ItemEqualityComparer(string metadataName)
        {
            Debug.Assert(metadataName != null);
            _metadataName = metadataName;
        }

        public bool Equals(ITaskItem x, ITaskItem y)
        {
            if (x == null || y == null)
            {
                return x == y;
            }

            var xMetadata = x.GetMetadata(_metadataName);
            var yMetadata = y.GetMetadata(_metadataName);
            return string.Equals(xMetadata, yMetadata);
        }

        public int GetHashCode(ITaskItem obj)
        {
            if (obj == null)
            {
                return 0;
            }

            var objMetadata = obj.GetMetadata(_metadataName);
            return objMetadata.GetHashCode();
        }
    }
} 
```

# c# - 将屏幕捕获为位图

> ID：362986
> 
> 赞同：72
> 
> 时间：2008-12-12T14:57:59.850
> 
> 标签：c#, .net, screenshot

我想在我的代码中捕获屏幕以获取图像 - 就像使用键盘上的“打印屏幕”按钮一样。

有谁知道如何做到这一点？我没有起点。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2008-12-12T15:04:39.663

如果使用 .NET 2.0（或更高版本）框架，您可以使用[`CopyFromScreen()`](http://msdn.microsoft.com/en-us/library/cdcw1c3b.aspx)此处详述的方法：

[http://www.geekpedia.com/tutorial181_Capturing-screenshots-using-Csharp.html](http://www.geekpedia.com/tutorial181_Capturing-screenshots-using-Csharp.html)

```
//Create a new bitmap.
var bmpScreenshot = new Bitmap(Screen.PrimaryScreen.Bounds.Width,
                               Screen.PrimaryScreen.Bounds.Height,
                               PixelFormat.Format32bppArgb);

// Create a graphics object from the bitmap.
var gfxScreenshot = Graphics.FromImage(bmpScreenshot);

// Take the screenshot from the upper left corner to the right bottom corner.
gfxScreenshot.CopyFromScreen(Screen.PrimaryScreen.Bounds.X,
                            Screen.PrimaryScreen.Bounds.Y,
                            0,
                            0,
                            Screen.PrimaryScreen.Bounds.Size,
                            CopyPixelOperation.SourceCopy);

// Save the screenshot to the specified path that the user has chosen.
bmpScreenshot.Save("Screenshot.png", ImageFormat.Png); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-01-29T16:29:26.443

我对接受的答案有两个问题。

1.  它不会捕获多显示器设置中的所有屏幕。
2.  `Screen`当使用显示缩放并且您的应用程序未声明为[dpiAware](https://msdn.microsoft.com/en-us/library/windows/desktop/mt846517(v=vs.85).aspx)时，该类返回的宽度和高度不正确。

这是我使用`Screen.AllScreens`静态属性并`EnumDisplaySettings`使用 p/invoke 调用以获得真实屏幕分辨率的更新解决方案。

```
using System.Drawing;
using System.Linq;
using System.Runtime.InteropServices;
using System.Windows.Forms;

class Program
{
    const int ENUM_CURRENT_SETTINGS = -1;

    static void Main()
    {
        foreach (Screen screen in Screen.AllScreens)
        {
            DEVMODE dm = new DEVMODE();
            dm.dmSize = (short)Marshal.SizeOf(typeof(DEVMODE));
            EnumDisplaySettings(screen.DeviceName, ENUM_CURRENT_SETTINGS, ref dm);

            using (Bitmap bmp = new Bitmap(dm.dmPelsWidth, dm.dmPelsHeight))
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.CopyFromScreen(dm.dmPositionX, dm.dmPositionY, 0, 0, bmp.Size);
                bmp.Save(screen.DeviceName.Split('\\').Last() + ".png");
            }
        }
    }

    [DllImport("user32.dll")]
    public static extern bool EnumDisplaySettings(string lpszDeviceName, int iModeNum, ref DEVMODE lpDevMode);

    [StructLayout(LayoutKind.Sequential)]
    public struct DEVMODE
    {
        private const int CCHDEVICENAME = 0x20;
        private const int CCHFORMNAME = 0x20;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 0x20)]
        public string dmDeviceName;
        public short dmSpecVersion;
        public short dmDriverVersion;
        public short dmSize;
        public short dmDriverExtra;
        public int dmFields;
        public int dmPositionX;
        public int dmPositionY;
        public ScreenOrientation dmDisplayOrientation;
        public int dmDisplayFixedOutput;
        public short dmColor;
        public short dmDuplex;
        public short dmYResolution;
        public short dmTTOption;
        public short dmCollate;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 0x20)]
        public string dmFormName;
        public short dmLogPixels;
        public int dmBitsPerPel;
        public int dmPelsWidth;
        public int dmPelsHeight;
        public int dmDisplayFlags;
        public int dmDisplayFrequency;
        public int dmICMMethod;
        public int dmICMIntent;
        public int dmMediaType;
        public int dmDitherType;
        public int dmReserved1;
        public int dmReserved2;
        public int dmPanningWidth;
        public int dmPanningHeight;
    }
} 
```

参考：

[https://stackoverflow.com/a/36864741/987968](https://stackoverflow.com/a/36864741/987968) [http://pinvoke.net/default.aspx/user32/EnumDisplaySettings.html?diff=y](http://pinvoke.net/default.aspx/user32/EnumDisplaySettings.html?diff=y)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-08-20T15:23:32.417

```
// Use this version to capture the full extended desktop (i.e. multiple screens)

Bitmap screenshot = new Bitmap(SystemInformation.VirtualScreen.Width, 
                               SystemInformation.VirtualScreen.Height, 
                               PixelFormat.Format32bppArgb);
Graphics screenGraph = Graphics.FromImage(screenshot);
screenGraph.CopyFromScreen(SystemInformation.VirtualScreen.X, 
                           SystemInformation.VirtualScreen.Y, 
                           0, 
                           0, 
                           SystemInformation.VirtualScreen.Size, 
                           CopyPixelOperation.SourceCopy);

screenshot.Save("Screenshot.png", System.Drawing.Imaging.ImageFormat.Png); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-04T08:00:22.867

试试[这个](http://www.csharp-tutorials1.blogspot.com/2017/01/capture-screenshot-using-c.html)代码

```
Bitmap bmp = new Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height);
Graphics gr = Graphics.FromImage(bmp);
gr.CopyFromScreen(0, 0, 0, 0, bmp.Size);
pictureBox1.Image = bmp;
bmp.Save("img.png",System.Drawing.Imaging.ImageFormat.Png); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-28T04:37:40.137

```
Bitmap memoryImage;
//Set full width, height for image
memoryImage = new Bitmap(Screen.PrimaryScreen.Bounds.Width,
                       Screen.PrimaryScreen.Bounds.Height,
                       PixelFormat.Format32bppArgb);
Size s = new Size(memoryImage.Width, memoryImage.Height);
Graphics memoryGraphics = Graphics.FromImage(memoryImage);
memoryGraphics.CopyFromScreen(0, 0, 0, 0, s);
string str = "";
try
{
    str = string.Format(Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments) +
          @"\Screenshot.png");//Set folder to save image
}
catch { };
memoryImage.save(str); 
```

# wpf - ToggleButton UserControl 中的 WPF 模板绑定

> ID：362993
> 
> 赞同：2
> 
> 时间：2008-12-12T15:00:24.213
> 
> 标签：wpf, user-controls, dependency-properties

我正在开发一个基本的拨码开关用户控件作为个人学习练习。最初我设置了它，您可以在用户控件上声明一些自定义颜色属性，并将它们用于控件内的元素。

然而，我最近发现了 ToggleButtons，并重建了我的控件以利用它们。从那时起，我的自定义颜色属性（SwitchColor 和 SwitchBkgndColor）不再正常工作。它们总是使用默认颜色呈现，而不是我将它们放在窗口中时指定的颜色。这是一些代码：

```
 <UserControl x:Class="DipSwitchToggleBtn"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:app="clr-namespace:SwitchesApp"
        Width="20" Height="40">
        <ToggleButton Name="ToggleBtn" IsThreeState="False">
            <ToggleButton.Template>
                <ControlTemplate>

                    <Canvas Name="SwitchBkgnd"
                            Background="{TemplateBinding app:DipSwitchToggleBtn.SwitchBkgndColor}"
                            >

                        <Rectangle Name="SwitchBlock"
                                   Fill="{TemplateBinding app:DipSwitchToggleBtn.SwitchColor}"
                                   Width="16" Height="16"
                                   Canvas.Top="22"
                                   Canvas.Left="2"
                                   />

                    </Canvas>

                    <ControlTemplate.Triggers>

                    <Trigger Property="ToggleButton.IsChecked" Value="True">
                        <Trigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="SwitchBlock"
                                                     Duration="00:00:00.05"
                                                     Storyboard.TargetProperty="(Canvas.Top)" To="2" />
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.EnterActions>
                        <Trigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="SwitchBlock"
                                                     Duration="00:00:00.05"
                                                     Storyboard.TargetProperty="(Canvas.Top)" To="22" />
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.ExitActions>
                    </Trigger>

                </ControlTemplate.Triggers>

                </ControlTemplate>
            </ToggleButton.Template>
        </ToggleButton>
    </UserControl> 
```

...以及背后的代码：

```
Partial Public Class DipSwitchToggleBtn

    Public Property State() As Boolean
        Get
            Return Me.ToggleBtn.IsChecked
        End Get
        Set(ByVal value As Boolean)
            Me.ToggleBtn.IsChecked = value
        End Set
    End Property

    Public Sub Toggle()
        Me.State = Not Me.State
    End Sub

#Region " Visual Properties "

    Public Shared ReadOnly SwitchColorProperty As DependencyProperty = _
                           DependencyProperty.Register("SwitchColor", _
                           GetType(Brush), GetType(DipSwitchToggleBtn), _
                           New FrameworkPropertyMetadata(Brushes.LightGray))

    Public Property SwitchColor() As Brush
        Get
            Return GetValue(SwitchColorProperty)
        End Get

        Set(ByVal value As Brush)
            SetValue(SwitchColorProperty, value)
        End Set
    End Property

    Public Shared ReadOnly SwitchBkgndColorProperty As DependencyProperty = _
                           DependencyProperty.Register("SwitchBkgndColor", _
                           GetType(Brush), GetType(DipSwitchToggleBtn), _
                           New FrameworkPropertyMetadata(Brushes.Gray))

    Public Property SwitchBkgndColor() As Brush
        Get
            Return GetValue(SwitchBkgndColorProperty)
        End Get

        Set(ByVal value As Brush)
            SetValue(SwitchBkgndColorProperty, value)
        End Set
    End Property

#End Region

End Class 
```

默认的 Gray 和 LightGray 显示在 VS2008 设计器和编译的应用程序中，但是当我在窗口中执行以下操作时：

```
<app:DipSwitchToggleBtn x:Name="DipSwitchTest" SwitchColor="#0000FF" SwitchBkgndColor="#000000" /> 
```

我为此实例指定的颜色没有被使用。一切都编译没有错误，但我的控件仍以默认颜色显示。

我相信有一些新的层次结构在起作用，因为我将我的项目嵌套在 ToggleButton 中。

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T15:52:05.667

在您的颜色属性的吸气剂中，您需要转换为画笔

```
Public Property SwitchBkgndColor() As Brush
    Get
        Return CType(GetValue(SwitchBkgndColorProperty), Brush)
    End Get

    Set(ByVal value As Brush)
        SetValue(SwitchBkgndColorProperty, value)
    End Set
End Property 
```

它可能没有什么不同，因为它可能只是自动转换但试一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T21:34:05.323

[请参阅子元素使用的自定义用户控件属性](https://stackoverflow.com/questions/358443/custom-usercontrol-property-used-by-child-element#360700)的答案。相同的概念可以应用于您的 ToggleButton。创建没有内容的 UserControl 只是一个 UserControl.Template 覆盖并使用 TemplateBinding 来设置你的道具

# python - 组织包含 SQLAlchemy 模型的文件夹的最佳方式

> ID：362998
> 
> 赞同：8
> 
> 时间：2008-12-12T15:02:25.270
> 
> 标签：python, orm, sqlalchemy

我在工作中使用 SQLAlchemy，它做得很好。现在我正在考虑最佳实践。

现在，我创建了一个包含所有 SQLA 内容的模块：

```
my_model
        |__  __init__.py 
        |__  _config.py <<<<< contains LOGIN, HOST, and a MetaData instance
        |__  table1.py <<<<< contains the class, the model and the mapper for table1
        |__  table2.py <<<<< contains the class, the model and the mapper for table2
        [...] 
```

现在，我真的不知道这是否是最好的方法。我想以细粒度加载类，并确保只与数据库等创建一个连接。

在这里，所有的类都是分开的，但都是 import _config ，我想知道这是否是一件好事。

更重要的是，我希望能够创建可以独立存储的模型类的子类，而不会每次都弄乱映射器。我怎样才能做到这一点 ？

现在我只是把它们放在同一个文件中，我必须创建另一个映射器，但第一个映射器仍然每次都会被调用。如果我必须导入父类，也会发生同样的情况，因为映射器是在导入时触发的。如果我不使用类来访问数据，每次映射它会不会过热？

我也想避免使用 Elixir，拜托。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T16:21:32.297

就我个人而言，我喜欢将数据库 / ORM 逻辑排除在模型类之外。它使它们更容易测试。我通常有类似 a 的东西，`types.py`它定义了我的应用程序中使用的类型，但独立于数据库。

然后通常有一个`db.py`或类似的东西，它具有`Session`设置数据库所需的类和其余代码，包括所有映射器等。

除了执行数据库操作的模块之外，其他模块都不需要导入`db`模块，并且数据库的存在对大多数应用程序类都是完全隐藏的。

据我所知，如果不更改映射器，您将无法轻松创建子类。当您执行查询时，SQLAlchemy 将无法知道从数据库中检索哪个子类，并且无论如何您都需要能够在存储数据时指示子类。

我还没有真正看到从主`db`模块一次调用所有映射器会出现任何问题，所以我不认为一直初始化它们真的是一个问题，除非你真的将它识别为瓶颈。根据我的经验，其他处理比次要映射器开销要大得多。

# vb.net - 使用 linq 将 IDictionary(Of TK, TV) 过滤到 IDictionary(Of TK, TV)

> ID：362999
> 
> 赞同：1
> 
> 时间：2008-12-12T15:02:42.087
> 
> 标签：vb.net, linq-to-objects

一些非常基本的东西似乎在逃避我。

```
Dim foo As New Dictionary(Of String, String)
foo.Add("key", Nothing)
foo.Add("key2", "something") 
```

我希望得到一个 IDictiorany(Of String, String) 回来，只有具有非空值的元素。我认为这会做到这一点：

```
foo.Where(Function(x) Not String.IsNullOrEmpty(x.Value)) 
```

但这最终是错误的类型。添加：

```
.ToDictionary(Function(x) x.Key) 
```

也无济于事。有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T15:10:51.570

啊...回答了我自己的问题。将保留它以防万一它对其他人有任何用处。

```
Dim foo As Dictionary(Of String, String)
foo.Add("k1", Nothing)
foo.Add("k2", "something")

Dim IDictionary(Of String, String) res = foo _
    .Where(Function(x) Not String.IsNullOrEmpty(x.Value)) _
    .ToDictionary(Function(x) x.Key, Function(y) y.Value) 
```******