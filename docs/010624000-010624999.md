# StackOverflow 问答 10624000-10624999

# gcc - some-prefix-gcc 和 gcc --target=some-prefix 有什么区别？

> ID：10624000
> 
> 赞同：2
> 
> 时间：2012-05-16T17:54:41.173
> 
> 标签：gcc, gnu-toolchain

我想使用另一个版本的`gcc`（更新），但不想替换原来的`<some-prefix>-gcc`可执行文件。

我必须使用哪些编译器标志来模拟`<some-prefix>-gcc`行为？我在构建过程中知道`--prefix`和`--target`标志，但我不想构建特定版本的 gcc。

`/my/new/gcc --target=some-prefix`不同工具链 ( `<some-prefix>-ld`, `<some-prefix>-as`)中的问题。因此，我想将我的 GCC 版本用作前端，将原始工具链用作后端（不仅是可执行文件，还包括/库）。

哪些附加标志可以帮助我告诉`gcc`使用`<some-prefix>-as`as 后端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T14:49:51.037

您可以使用`-B dir`来告诉 gcc 查找`dir`它需要的其他可执行文件，但您不能告诉它使用不同的可执行文件，`<some-prefix>`因为这是在构建 gcc 时设置的。您也不能（通常）将一个版本的 gcc 中的头文件和库与另一个版本混合使用，它们旨在与它们附带的版本一起使用。

您可以创建一个新目录，其中包含指向所需后端工具的符号链接，将符号链接命名为 gcc 期望找到它们，然后用于`-B`告诉它在该目录中查找。但是，如果它无法正常工作，请不要感到惊讶。

# java - 包 javax.servlet.http 不存在，但 servlet-api.jar 存在

> ID：10624002
> 
> 赞同：2
> 
> 时间：2012-05-16T17:54:46.390
> 
> 标签：java, servlets, classpath

我的 GlassFish 3.1.2 Web 服务器与 Java SE 1.6 一起正常工作，用于常规 Java POJO。JAVA_HOME、JAVA_PATH 和 JRE_HOME 变量设置正确。我正在使用Linux CentOS6.2，我正在从vi 和命令行执行所有java 工作（例如，没有框架或工具，如Spring、Eclipse 等）。

现在我想使用 Java Servlet，但出现以下错误：

```
package javax.servlet.http does not exist 
```

我假设由于我的环境路径设置正确，因此在编译期间可以看到 servlet 文件。显然情况并非如此。

有谁知道如何解决这个错误？如果要在我的 linux 目录上四处寻找，我要为 servlet jar 文件查找什么文件名？任何人都知道这个文件从 JDK 1.6 的 JAVA_HOME 开始位于哪里？

或者，servlet相关的文件不是jdk 1.6的一部分，需要单独下载安装吗？

更新：

如果我`locate servlet-api.jar`在 linux 提示符下键入，它会返回 GlassFish 安装目录中的路径（例如`~/glassfish3/glassfish/modules/javax.servlet-api.jar`）。因此，如下所述，它是 GlassFish 安装的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T17:56:51.043

编译时需要`servlet-api`在类路径中，它可能与服务器一起存在，但在运行时可用（而不是在编译时）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T17:57:45.047

servlet API 不是 Java SE 的一部分，而是 Java EE 的一部分。它不与 JDK 捆绑在一起。在 Glassfish 安装中找到 javaee jar 文件并将其放入编译类路径中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T17:57:42.637

确保您的类路径中有**servlet-api.jar**，因为它不是标准 Java SDK 的一部分。

# testng - 从 XML 调用中指定调用计数

> ID：10624004
> 
> 赞同：2
> 
> 时间：2012-05-16T17:54:54.517
> 
> 标签：testng

我有一个现有的 TestNG 测试用例。我想通过在多个线程中并行运行测试用例来进行压力测试。一种方法是将`@Test`注释更改为

```
@Test(invocationCount = 100, threadPoolSize=10) 
```

但我不想编辑原件（我想把它留作功能测试）。我更愿意在我的 XML 测试套件定义中设置调用计数。

作为一种解决方法，我创建了一个具有高调用计数的新测试，并在该测试中调用旧测试。这个解决方案有效，但感觉就像一个黑客。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T19:22:22.653

您可以`@Test`在运行时使用[IAnnotationTransformer](http://testng.org/doclava/reference/org/testng/IAnnotationTransformer.html)修改注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:10:50.137

作为一种解决方法，我创建了一个具有高调用计数的新测试，并在该测试中调用旧测试。这个解决方案有效，但感觉就像一个黑客。

这不是一个理想的解决方案，但它有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-18T14:26:06.400

您可以使用 beanshell 脚本在 XML 文件中设置 invocationCount，如下所示：

```
<test name="TestName" >
    <method-selectors>
            <method-selector>
                <script language="beanshell">
                <![CDATA[
                testngMethod.setInvocationCount(2);
                return true;
                ]]>
                </script>
            </method-selector>
    </method-selectors>
        <classes>
            <class name="testNG.test" />
        </classes>
</test> 
```

相应地更改计数，上面的 xml 配置将执行两次测试用例。

# php - 从 Buddypress 个人资料页面隐藏子导航选项

> ID：10624014
> 
> 赞同：1
> 
> 时间：2012-05-16T17:55:40.513
> 
> 标签：php, wordpress, buddypress

我试图在 BuddyPress 的“会员资料”页面中隐藏“更改头像”选项。我一直在研究代码，据我所知，有一个多维数组用于创建此导航以及其他组导航以及其他导航。有谁知道我可以用来禁用子导航项的任何钩子？不确定 slug/id 是什么，也不确定我是否可以那样禁用它。

这是我要删除的内容的屏幕截图（注意：我已将名称从默认的“更改头像”更改为“更改个人资料图片”。

这是一个屏幕截图 [http://dl.dropbox.com/u/722321/Screen%20shot%202012-05-16%20at%2012.46.53%20PM.png](http://dl.dropbox.com/u/722321/Screen%20shot%202012-05-16%20at%2012.46.53%20PM.png) )

谢谢你的帮助。杰森

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T14:17:40.163

在你的 bp-custom.php 或主题的 functions.php 中试试这个

```
function remove_change_avatar() {
    bp_core_remove_subnav_item( 'profile', 'change-avatar' );
}
add_action( 'bp_setup_nav', 'remove_change_avatar', 100 ); 
```

# c# - 多线程的应用程序冗余

> ID：10624024
> 
> 赞同：3
> 
> 时间：2012-05-16T17:56:27.747
> 
> 标签：c#, multithreading, service, redundancy

我们正在尝试为 Windows 编写服务，并且需要制定冗余计划，以便如果应用程序中的某些内容出现故障，它会再次恢复。我想知道我是否可以使用多线程来完成这个。

我的想法是创建两个线程，每个线程处理单独的任务。我还想让每个线程监视另一个线程以确保它仍在运行，如果不是，那么它应该启动该线程的新实例。这听起来可行吗？我将使用哪些线程技术：互斥体、共享内存、信号量等...？如果这不是正确的方法，那么可能是什么，只需编写两个单独的服务并使用 IPC？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:06:12.967

那么让您的服务在失败时重新启动的最简单方法是让 Windows 来做。您只需将服务配置为自动重启，这真的很容易。您也可以在服务安装程序期间以编程方式执行此操作。有关如何执行此操作的指南，请参阅这篇文章：[构建 Windows 服务 - 第 4 部分：扩展服务安装程序](http://csharptest.net/955/building-a-windows-service-part-4-extending-the-service-installer/)。

至于这提供“冗余”，这没有。冗余的正确定义意味着您拥有不止一个。这可能是使用多个服务，或者更有可能在多个主机上使用多个服务。在单个主机上拥有多个服务更容易，因为您可以在需要时使用互斥锁进行同步。

> 真正的问题是这项服务在做什么？

如果您的服务正在轮询任务，例如来自数据库或消息队列，那么同步会为您处理。只需对您的数据库进行建模，以便多个服务都可以独立运行和处理工作，而无需重复工作。现在你有了冗余。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T18:02:02.200

是的，这听起来像是一个可行的解决方案。双线程的唯一问题是，如果应用程序崩溃，那么两个线程都会死掉（如果它们是后台线程） 我发现对这个问题有用的解决方案是有一个看门狗进程。每当工作进程崩溃时，看门狗就会启动并创建一个新实例并运行它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T18:07:27.650

您可以简单地将应用程序编写为 Windows 服务使用的类库（Visual Studio 中的模板，您需要添加安装程序）。**如果您以这种方式运行您的应用程序，您将可以随时选择设置失败时的行为，即始终重新启动，重新启动几次，然后向某人发送电子邮件或运行其他应用程序等。**

它内置在您拥有凭据的任何 Windows 框中，所有繁重的工作都为您完成。对于我需要始终启动和运行的服务来说，这始终是一件轻而易举的事。

为此，您只需将服务类型设置为自动（如果您的机器重新启动，这将重新启动它），然后您可以在管理窗口的[管理窗口](http://technet.microsoft.com/en-us/library/cc736564%28v=ws.10%29.aspx)中为需要的前三个重新启动选项进行设置服务部分。

更多信息： [Windows 服务文档](http://msdn.microsoft.com/en-us/library/d56de412%28v=vs.80%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T19:37:20.093

我发现涵盖各种情况的最强大的解决方案是有一个可以启动和停止工作进程的看门狗进程。您将使用 WCF 在进程之间来回发送信号（或其他信息）。这个想法是保持看门狗过程简单，这样它在执行有限的任务集时失败的可能性很小。然后把所有有风险的逻辑放到worker进程中。

提出一个协议，用于将工作进程的故障或健康状况传达给看门狗进程。这里有一些想法。这份清单绝不是一份详尽的清单。

*   如果看门狗没有及时收到状态报告，它会重新启动工作进程。
*   如果 Watchdog 收到失败状态报告，它会重新启动工作进程。
*   如果检测到内存泄漏，Watchdog 会重新启动工作进程。
*   如果看门狗没有运行，它会启动工作进程。

除了最后一项，Windows 服务控制管理器无法处理其他 3 种情况。这也是我喜欢看门狗进程理念的原因之一。另一个原因是因为您的主要逻辑可能会挂断阻塞调用。因为`Thread.Abort`不推荐，因为它会破坏状态，所以除了杀死工作进程之外，你真的只有很少的选择。

此外，请尝试使您的主要逻辑尽可能容错。这样，如果您确实需要强制终止它，那么恢复和清理它留下的混乱会容易得多。这可能意味着使用诸如 DB 事务或聪明的文件操作之类的原子操作。

# localization - 如何使用国际互联网域名（.it、.co.uk、.es、...）以实现 SEO 的最佳效果

> ID：10624029
> 
> 赞同：7
> 
> 时间：2012-05-16T17:57:07.787
> 
> 标签：localization, seo

我开发了一个英文 Web 应用程序 - 你可以访问它，例如，在 www.example.com。

然后，我做了意大利本地化。基本上，如果您使用“意大利语”浏览器访问 www.example.com，语言会自动切换为意大利语。

我还购买了域名 example.it。如果您访问：
[http](http://www.example.it)
://www.example.it ，您将被自动重定向到
[http://www.example.com/it/](http://www.example.com/it/)
，您可以在此处阅读意大利语网站。

现在我在意大利做一些公关，用意大利语写客座博客文章。

我的问题是：为了从 SEO 中获益最多，我应该从那些意大利语文章中链接 www.example.it 或 www.example.com 吗？

非常感谢权威来源的链接。

谢谢，
丹

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T12:19:06.350

[如果您的域http://www.example.com](http://www.example.com)已经有 Page Rank，您应该明确使用[http://www.example.com/it/](http://www.example.com/it/)或子域解决方案。

如果您使用您的域[http://www.example.it](http://www.example.it)，搜索引擎会将其视为一个新域，因此您不会从您的域 .com 中受益。

另一种方法可能是使用子域。示例：it.example.com。

我还建议您使用 Google Web Master Tools for GeoTargeting，这样您就可以更好地在意大利 SERP 上排名（它适用于子域）

这里有一些有用的资源：

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=62399](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=62399)

[http://www.seomoz.org/ugc/folders-vs-subdomains-vs-cctld-in-international-seo-an-overview](http://www.seomoz.org/ugc/folders-vs-subdomains-vs-cctld-in-international-seo-an-overview)

如果您有任何问题，请告诉我，希望对您有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T22:22:15.940

如果您使用[301“永久移动”](https://en.wikipedia.org/wiki/HTTP_301)重定向`example.it`到`example.com/it`它应该给您的 example.com 域带来*几乎*与直接链接到它一样多的好处。

[搜索引擎优化](http://www.seomoz.org/learn-seo/redirection)：

> 301 重定向是一种永久重定向，它会将 90-99% 的链接汁（排名能力）传递到重定向的页面。

[搜索引擎优化博客](http://qrehman.com/2011/05/01/301-redirect-and-canonical/)：

> 根据 Matt Cutts 的说法，“每当您使用 301 永久重定向时，您只会损失一点点 SEO 价值”</p>

两个消息来源都提到的小损失可能与速度有关：搜索引擎更喜欢快速页面，而重定向会导致页面加载速度稍慢（请参阅[Yahoo Performance Best Practices](http://developer.yahoo.com/performance/rules.html#redirects)）。

因此，额外的重定向似乎会产生一个微小的劣势。但是，当涉及到 SEO 时，有很多猜测，我不会太在意。

但是由于您的`example.it`域无论如何都不会显示为搜索结果（由于重定向，只会`example.com/it`被索引），您也可以直接链接到该`.com`版本，以确保安全（和快速）方面。

总结一下：

*   人们无论如何都不会看到该`example.it`域，除非他们在悬停链接时查看状态栏
*   直接链接到重定向目标会更好更快，`example.com/it`
*   只需`example.it`在人们实际输入您的 URL 的情况下使用您更简单的域

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-20T11:45:02.850

最好的选择是：

www.example.it

和

`<meta lang="it">`

# tfs - 如何执行 TFS 获取到提供的或当前的目录路径，忽略工作区设置

> ID：10624031
> 
> 赞同：10
> 
> 时间：2012-05-16T17:57:10.857
> 
> 标签：tfs

我正在使用 TFS 2010 并编写一个脚本来启用我们软件的特定版本标签的简单获取。由于这只是一个简单的获取，所以无论如何只执行获取而不必使用当前工作区设置或将工作区设置更改为所需的路径？获取后没有理由将文件链接到 CM，所以我没有理由保留这个“工作区”。我只想能够在我想要的任何地方创建一个目录，并让 TFS 给我当前目录中标记为当前版本的文件的副本，或者给我“即时”提供的目录。似乎没有办法将简单的 get 与项目工作区设置分开。我是否遗漏了某些东西，或者我是否被迫在获取之前隐藏或更改工作区设置？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-16T18:34:42.380

您将需要一个工作区来执行`get`，但它不必与您用于 Visual Studio 的工作区相同。实际上，您可以只创建一个简单的一次性工作区，例如：

```
# {{Server}} is http://server:8080/tfs/DefaultCollection; for readability.

tf workspace /new temp_workspace /collection:{{server}} /noprompt
tf workfold /map $/Project/Project C:\Build\Project
tf get C:\Build\Project /recursive /noprompt
tf workspace /delete temp_workspace /collection:http{{server}} /noprompt 
```

* * *

请注意，TFS SDK 确实提供了`Item`无需创建工作空间就可以下载的机制，因此您可以编写一个程序来执行此操作，但要避免创建工作空间，这将是相当多的代码，最终，相当便宜的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-01T18:35:19.060

[Neno Loje 创建了一个小型实用程序，可通过命令行的一个命令提供此功能](http://msmvps.com/blogs/vstsblog/archive/2011/03/14/download-files-from-tfs-version-control-and-set-the-file-last-access-timestamp-to-the-file-s-last-check-in-time.aspx)。

# c++ - 如何在 Visual C++ 非托管代码中编写用户定义的异常？

> ID：10624032
> 
> 赞同：1
> 
> 时间：2012-05-16T17:57:18.437
> 
> 标签：c++, visual-c++, exception, exception-handling, unmanaged

我想知道如何在 Visual C++ 中编写非托管异常？

```
#include <string>
#include <exception>

using namespace std;
using namespace System;

class GraphException : public Exception
{
public:
    GraphException() { }
//  GraphException(string message) : Exception (message)
//  { }
//  GraphException(string message, Exception inner) : Exception (message, inner)
//  { }
}; 
```

这不起作用我收到以下错误，

> 错误 1 ​​错误 C3625：“GraphException”：非托管类型无法从托管类型“System::Exception”派生 c:\breadthfirst\graph\graphexception.h 10 1 breadthFirst

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:01:06.193

派生自`std::exception`而不是`Exception`.

更好的是从[`stdexcept`](http://msdn.microsoft.com/en-US/library/t65b74ad).

# model-view-controller - Symfony2和视图模型的MVC概念

> ID：10624033
> 
> 赞同：3
> 
> 时间：2012-05-16T17:57:42.073
> 
> 标签：model-view-controller, design-patterns, symfony, naming-conventions

我认为 Symfony2 缺少**ViewModel**的概念（如 ASP.NET MVC 框架），即与视图关联的模型。Symfony2（作为文档）通常将一个**数组**分配给一个视图。

视图模型可能是一个 PHP 类，但它与表单模型不同，有时它与域实体相同。在处理要显示的大量信息时，它有时很有用。

无论如何，关于视图模型在 Symfony2 中的位置是否有任何约定？有具体的文件夹吗？现在我有：

```
Symfony2/src/MyCompany/MyBundle/Form/Model 
```

它保存与表单关联的模型。和：

```
Symfony2/src/MyCompany/MyBundle/Entity 
```

对于域实体（绑定到数据库表）。

非常感谢您的建议。怎么样`Symfony2/src/MyCompany/MyBundle/Model`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T13:16:40.190

在 Symfony2 中，没有 ViewModel 这样的概念。您直接传入模板实体或模型。不过，您可以构建自己的 ViewModel。

实体不是模型。正如您所说，它们是原则管理对象或域实体。如果您想拥有业务模型，请将它们放在 MyBundle/Model 中，就像许多其他捆绑包一样（例如，[FOSUserBundle](https://github.com/FriendsOfSymfony/FOSUserBundle/)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T12:40:55.167

`ViewModel`只要你的命名空间反映了它的位置，你把你的……放在哪里并不重要。

我会将其放入`src/MyCompany/MyBundle/View/Model`，然后您的命名空间将是`MyCompany\MyBundle\View\Model`.

# msbuild - cygwin mintty 下的 msbuild 停止工作

> ID：10624037
> 
> 赞同：1
> 
> 时间：2012-05-16T17:57:55.567
> 
> 标签：msbuild, cygwin

我已经从我的 mintty shell 运行 msbuild.exe 好几个星期了。突然（好吧，在对终端类型和颜色等进行了一些处理之后）msbuild 挂起外壳。如果我做一些简单的事情，比如 $ msbuild -? 它只是挂起。没有屏幕输出，什么都没有。我必须在物理上关闭外壳才能超越它。

我已经检查了其他 shell 应用程序（例如 csc.exe），它们仍然可以正常工作。完全不确定会发生什么。我什至已经将cygwin重新安装到另一个驱动器，但仍然没有乐趣。

任何日志或想法？在这里绝望了……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:36:43.023

在 win7 PC 上安装新的 cygwin 时遇到同样的问题。

最新版本的 cygwin 似乎有问题：http: [//cygwin.com/ml/cygwin/2012-03/msg00215.html](http://cygwin.com/ml/cygwin/2012-03/msg00215.html)

升级到最新快照修复问题： [http ://cygwin.com/snapshots/](http://cygwin.com/snapshots/)

解压cygwin1-20120517.dll.bz2，替换bin/cygwin1.dll

干杯。

# perl - 尝试使用 Perl 读取文本文件

> ID：10624040
> 
> 赞同：1
> 
> 时间：2012-05-16T17:58:07.267
> 
> 标签：perl

我希望用户输入文件名并让程序输出文件的内容。

我得到 2x“未加引号的字符串可能与将来的保留字冲突”和“全局符号 $filename 需要明确的包名。

```
use strict;
use warnings;
print 'Enter file name: ';
my $fileName = <STDIN>;
chomp($fileName);
open(fh, $filename or die $!); 
```

另外，为什么文件句柄不是变量（实际上取决于我是否看到它是变量的示例，就像我在这里所看到的一样）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:00:06.663

`$fileName`不同于`$filename`-- Perl 区分大小写！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T18:00:53.640

> 我得到 2x“未引用的字符串可能与未来的保留字冲突”和

`fh`应该`my $fh`

> “全局符号 $filename 需要明确的包名。

`$fileName`并且`$filename`是不同的变量。第二个还没有宣布。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-16T18:01:50.503

你所有的问题都在这里（和`$filename`vs. `$fileName`）。

```
open(fh, $filename or die $!); 
```

你想要更多类似的东西

```
open (my $fh, '<', $filename) || die $!; 
```

在第一种情况下，`die`条件是 on `$filename`；它相当于：

```
if (!$filename) { die $! } 
```

但第二个更像：

```
if (!open (my $fh, '<', $filename)) { die $! } 
```

尽管以这种方式 (with `if (!open)`) 这样做是没有意义的，除非您`$fh`使用更有用的范围声明——现在它只在`if`块内可见。

第二种情况隐含地涵盖了第一种情况，因为 if `$filename`is undefined`open()`将失败并返回`Use of uninitialized value $filename in open`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-16T18:19:54.957

您还问为什么有时会看到裸字文件句柄（例如`fh`）与标量文件句柄（例如`$fh`）。前者已弃用。使用已声明但未定义的标量文件句柄是使用“间接”文件句柄调用的。Perl 为您自动激活（创建）对文件（句柄）的引用。最重要的是，一旦变量超出范围，并且没有其他对它的引用，文件句柄就会自动关闭，Perl 的垃圾收集器可以回收使用的内存。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-16T18:00:31.507

您需要美元符号和正确的`$fileName`：

```
open(my $fh, '<', $fileName) or die $!; 
```

这里有一些有用的参考： http: [//perldoc.perl.org/functions/open.html](http://perldoc.perl.org/functions/open.html)

# javascript - 订阅 pubsub 但像在 MUC 中一样匿名发布

> ID：10624043
> 
> 赞同：0
> 
> 时间：2012-05-16T17:58:14.717
> 
> 标签：javascript, xmpp, openfire

我看不到使用我的 JID 订阅 pubsub 的可能性，但有时会像在 MUC 中那样匿名发布。我慢慢但肯定地意识到 pubsub 并不像它实际上应该的那样灵活.. 太糟糕了..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T22:18:11.703

我不确定您所说的“匿名发布”是什么意思。

除非服务器将其包含在通知中，否则 pubsub 项目的发布者是未知的，根据 XEP-0060[是可选](http://xmpp.org/extensions/xep-0060.html#publisher-publish-success-publisher)的。

# java - 您将 -Dvar=value 参数放在 Eclipse 调试配置中的什么位置？

> ID：10624050
> 
> 赞同：0
> 
> 时间：2012-05-16T17:59:17.590
> 
> 标签：java, eclipse, arguments

标题几乎说明了一切。我要迁移到新的计算机设置，并且必须运行带有`-Dvar=value`参数的 Eclipse 配置。我忘了把它放在 Eclipse 的什么地方。调试配置参数选项卡似乎不是正确的位置。

这些参数叫什么，在调试配置中我应该在哪里输入它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:10:28.310

这很简单：只要按照“红色”

![向下箭头](../Images/effa3c7972af465979276c51bb556789.png)

![论据](../Images/3d559a43e4d7c73d88a56fbc740b98cb.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:03:52.853

创建启动配置，转到“参数”选项卡并在“VM 参数”字段中输入它们

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T18:03:07.803

这是正确的地方。您必须将它们放在 VM 参数文本区域中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T18:03:16.763

从主菜单运行/调试配置中选择，然后选择您的调试配置或创建新配置。选择选项卡“参数”并将您的添加`-D...`到“VM 参数”文本区域。

# javascript - 从 Javascript 函数参考中获取名称作为字符串？

> ID：10624057
> 
> 赞同：40
> 
> 时间：2012-05-16T17:59:47.543
> 
> 标签：javascript

我想做与[Get JavaScript function-object from its name as a string 相反吗？](https://stackoverflow.com/questions/773184/get-javascript-function-object-from-its-name-as-a-string)

也就是说，给定：

```
function foo()
{}

function bar(callback)
{
  var name = ???; // how to get "foo" from callback?
}

bar(foo); 
```

如何获取引用后面的函数名称？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-16T18:03:38.537

如果你不能使用[`myFunction.name`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function)，那么你可以：

```
// Add a new method available on all function values
Function.prototype.getName = function(){
  // Find zero or more non-paren chars after the function start
  return /function ([^(]*)/.exec( this+"" )[1];
}; 
```

或者对于不支持该`name`属性的现代浏览器（它们是否存在？）直接添加它：

```
if (Function.prototype.name === undefined){
  // Add a custom property to all function values
  // that actually invokes a method to get the value
  Object.defineProperty(Function.prototype,'name',{
    get:function(){
      return /function ([^(]*)/.exec( this+"" )[1];
    }
  });
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-16T18:01:17.780

```
var name = callback.name; 
```

[**MDN**](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/Name)：

> name 属性返回函数的名称，或者匿名函数的空字符串：

[**现场演示**](http://jsfiddle.net/pxmBt/1)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-16T18:09:38.717

```
function bar(callback){
    var name=callback.toString();
    var reg=/function ([^\(]*)/;
    return reg.exec(name)[1];
}

>>> function foo() { };
>>> bar(foo);
"foo"
>>> bar(function(){});
"" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-16T18:02:59.900

```
var x = function fooBar(){};
console.log(x.name);
// "fooBar" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-30T12:17:46.047

您可以使用以下方法提取对象和函数名称：

```
function getFunctionName()
{
    return (new Error()).stack.split('\n')[2].split(' ')[5];
} 
```

例如：

```
function MyObject()
{
}

MyObject.prototype.hi = function hi()
{
    console.log(getFunctionName());
};

var myObject = new MyObject();
myObject.hi(); // outputs "MyObject.hi" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-16T18:03:16.270

尝试访问该`.name`属性：

```
callback.name 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-22T14:32:49.630

如果您正在寻找特定对象事件的函数，这可能会有所帮助：

```
var a = document.form1
a.onsubmit.name 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-24T09:12:21.930

对我来说，只需稍作修改（在父级之前添加 \），这项工作：

```
if (Function.prototype.name === undefined){
  // Add a custom property to all function values
  // that actually invokes a method to get the value
  Object.defineProperty(Function.prototype,'name',{
    get:function(){
      return /function ([^\(]*)/.exec( this+"" )[1];
    }
  });
} 
```

# linux - Cygwin：使用 cronjob 启动 Windows 批处理文件

> ID：10624061
> 
> 赞同：0
> 
> 时间：2012-05-16T18:00:01.537
> 
> 标签：linux, windows-xp, cygwin

我尝试在 Cygwin 下创建一个启动外部批处理文件的 cronjob。好吧，如果可能的话，我也可以尝试运行 sh 脚本，但问题是：

我尝试使用 truecrypt 和 java，或更详细：尝试挂载容器，使用 java jar-commandline 工具同步目录并随后关闭容器

我无法传递参数，例如：

/cygdrive/e/backup/truecrypt.exe /v "e:\dropbox\projects.secured" ... 不起作用

和

java -jar Sync.jar "E:\home\git" "Z:" 也不...

你有想法吗？问题是，在 cygwin 下没有 java 和 truecrypt 的本地安装。

非常感谢你的帮助 ...！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T11:52:55.663

几分钟后，我找到了解决此问题的方法：

我不知道为什么它比批处理更好，但我现在正在调用 *.cmd 文件。我不再寻找在这种情况下不适用于 cygwin 的“sh 解决方案”。

现在我的文件看起来像：

```
e:/backup/truecrypt /v "E:\path\to\my\tcfile\container.tc" /p mygreatpass ...
java -jar Sync.jar --ignorewarnings ...
e:/backup/truecrypt /d /q /f 
```

# android - 什么类型的安卓应用最难支持（碎片化担忧）

> ID：10624066
> 
> 赞同：6
> 
> 时间：2012-05-16T18:00:12.257
> 
> 标签：android, testing, avd

前几天看到一篇有趣又有点吓人的博文。这是他们测试的移动开发人员的 Android 设备集合。大约是 400。--> [http://feedproxy.google.com/~r/Techcrunch/~3/0LybOzd0l0U/](http://feedproxy.google.com/~r/Techcrunch/~3/0LybOzd0l0U/)

我是一个孤独的人，如果应用程序只需要一小部分测试和支持，我就无法支持它。我知道您可以模拟许多设备，但在少数几个 AVD 上进行测试仍然需要相当长的时间。听起来这可能是一场噩梦。

对于那些一直在研究 Android 的人，关于哪些应用程序最容易处理各种设备的任何数据或建议？博客里的开发者做了很多游戏，那些是最棘手的吗？

我确信 Hello World 在所有 Android 设备上都运行良好，但不会有很多用户，你知道吗？

在开始一个雄心勃勃的应用程序之前，最好知道，例如，GPS 很简单、一致，但本机代码可能是一场噩梦，或者静态图片还可以，视频很难支持。SMS、数据库、sdcard 访问？OpenGL，手势等等之类的东西......

如果有人有一些一般性提示，或者特别是最容易到最难的列表，这可能对我们新手非常有帮助。

谢谢

PS请不要说“在iOS上开发......”，这不是问题，更糟糕的是它太可预测了。;-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:25:18.300

他们正在发展，`70 million downloads`他们在亚洲市场相当大，这意味着大量的新设备来自`lower-end Asian manufacturers`

[Netflix 仅在十几种设备上进行测试](http://techblog.netflix.com/2012/03/testing-netflix-on-android.html)，这些设备代表了他们的大多数用户、一些自定义 ROM、各种处理能力和各种播放架构。

因为在每台 Android 设备上测试你的设备是不现实的，所以只要确保你的应用[看起来不错](http://developer.android.com/design/index.html)并且[构建可靠](http://developer.android.com/guide/practices/compatibility.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:17:57.243

好吧，既然你喜欢可怕的文章，这里有另外 2 篇可怕的（和信息丰富的）文章： http:
[//opensignalmaps.com/reports/fragmentation.php](http://opensignalmaps.com/reports/fragmentation.php)
[http://burnsmod.com/development/2012/05/01/Android-碎片化-伤害-每个人/](http://burnsmod.com/development/2012/05/01/Android-Fragmentation-Hurts-Everyone/)

作为一般规则，任何使用低级硬件访问的东西都是一场噩梦，所以只要有可能，坚持使用 Java API 来访问硬件功能。

相机 API，无论是高级还是低级都可能存在问题。例如，当通过`startActivityForResult`with调用高级相机 API 时，我遇到了特定于设备的问题`android.media.action.IMAGE_CAPTURE`。

此处有关设备特定错误的更多信息：
[是否有针对 Android 设备的设备特定错误的汇编？](https://stackoverflow.com/questions/9792672/is-there-a-compilation-of-device-specific-bugs-for-android-devices)
[Android 设备特定错误](https://stackoverflow.com/questions/6381917/android-device-specific-bugs)

您最好的选择是为“正常”设备构建，然后根据用户投诉的频率调查特定设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:59:50.400

已经给出的一般建议是，构建坚固且看起来不错的东西，这是一个很好的起点。一般来说，您的应用程序越独立，就越容易确信它在对畅销书的核心子集进行测试后可以在大量设备上运行。

困难的主要领域是当您与其他应用程序（如图库、地址簿等）交互时。OEM 可能/将更改您想要集成的内置应用程序的任何地方都可能导致问题。对于大多数应用程序来说，这不是问题。具体来说，我开发了一个消息传递应用程序，该应用程序需要在特定运营商的所有手机上进行测试；这不是我希望有人独自承担的那种项目。

因此，简单的答案是避免与其他应用程序集成，将其视为 iOS 沙盒。不幸的是，这删除了一些 Android 价值，但这是避免碎片问题的最简单方法。

实际上，如果您的应用程序在商业上取得成功很重要，您确实需要在一些真实设备上进行测试。就个人而言，我会说测试的最低要求是在每个主要 OEM 的手机上进行测试，包括 Gingerbread 和 ICS，如果它是每个运营商的联网应用程序。对于刚开始的人来说，这种级别的财务义务是不现实的，此时您最终只是将用户用作测试人员。

# string - 在 R 中使用字符串名称分配 data.frame 的列

> ID：10624067
> 
> 赞同：15
> 
> 时间：2012-05-16T18:00:14.553
> 
> 标签：string, r, assign

我正在尝试使用在循环中生成的名称将数据分配给现有数据框。一个基本的例子可能是

```
A = data.frame(a = c(1,2,3), b=c(3,6,2))

for (i in 1:2){
    name = paste("Name",i, sep="")
    assign(name, c(6,3,2))
} 
```

现在我只需要弄清楚如何将 name1 和 name2 添加到 data.frame A，同时保留它们的指定名称。我敢肯定有一个简单的答案，我只是现在没有看到它。

最后我想结束

```
A
#a b name1 name2
#1 3 6      6
#2 6 3      3
#3 2 2      2 
```

但我需要以自动化方式执行此操作。

例如，如果 for 循环可以调整为

```
for (i in 1:2){
    name = paste("Name",i, sep="")
    assign(name, c(6,3,2)
    A= cbind(A, get(paste(name,i,sep="")))  # works but doesn't maintain the column name as name1 or name2 etc
} 
```

但是，这不维护列名

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-17T16:32:40.477

其他答案很好，但是如果您设置使用像您一样的循环，那么这将起作用：

```
A <- data.frame(a = c(1,2,3), b = c(3,6,2))

for (i in 1:2){
    A[paste("Name", i, sep="")] <- c(6,3,2)
} 
```

这使

```
> A
  a b Name1 Name2
1 1 3     6     6
2 2 6     3     3
3 3 2     2     2 
```

或者，`paste("Name", i, sep="")`可以替换为`paste0("Name", i)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T18:12:24.133

也许你想要这个：

```
R> A <- data.frame(a=c(1,2,3), b=c(3,6,2))
R> colnames(A) <- paste("Names", 1:ncol(A), sep="")
R> A
  Names1 Names2
1      1      3
2      2      6
3      3      2
R> 
```

但正如泰勒在评论中所说，你在问什么并不完全清楚。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-16T18:21:32.887

仍然不完全确定您要完成的工作：

```
A = data.frame(a = c(1,2,3), b=c(3,6,2))
B <- data.frame(A, c(6, 3, 2), c(6, 3, 2))
names(B)[3:4] <- paste0("name", 1:2)
B 
```

产生：

```
 a b name1 name2
1 1 3     6     6
2 2 6     3     3
3 3 2     2     2 
```

# powershell - Remove-DistributionGroupMember - 指定唯一用户

> ID：10624069
> 
> 赞同：0
> 
> 时间：2012-05-16T18:00:23.287
> 
> 标签：powershell, exchange-server

我正在尝试使用 powershell 从分发列表中删除一堆成员作为交换。我最初使用别名值来指定成员，但遇到错误说有多个具有指定别名的成员。所以我试图用别的东西来唯一地标识这些成员。

根据[此](http://technet.microsoft.com/en-us/library/aa996367.aspx)文档，Get-DistributionGroupMember 在身份下具有许多与[Remove-DistributionGroupMember](http://technet.microsoft.com/en-us/library/aa998016.aspx) cmdlet 在成员下相同的字段，但我无法让除别名之外的任何字段正常工作。到目前为止，这是我的代码：

```
foreach ($member in Get-DistributionGroupMember -Identity $selecteddl | Select-Object Alias) {
        Remove-DistributionGroupMember -Identity $selecteddl -Member $member.alias -Confirm:$False
    } 
```

那是产生重复成员错误的代码。如果我将两个“别名”属性都更改为“guid”，我会得到一个不同的错误：

> 无法处理参数“成员”的参数转换。无法将“System.Guid”类型的“4ed0987f-7c86-48e7-8f47-ca9ad731e2fd”值转换为“Microsoft.Exchange.Configuration.Tasks.GeneralRecipientIdParameter”类型。+ CategoryInfo : InvalidData: (:) [Remove-DistributionGroupMember], ParameterBindin...mationException + FullyQualifiedErrorId : ParameterArgumentTransformationError,Remove-DistributionGroupMember

为了解决这个问题，我应该做些什么不同的事情吗？我对powershell很陌生，所以我会为您提供任何其他提示。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:01:05.697

更新：您可以使用它来简化操作。同样，这将删除所有成员，因此您最好在管道到 Remove-DistributionGroupMember 之前进行一些过滤。

```
Get-DistributionGroupMember $selecteddl | Remove-DistributionGroupMember $selecteddl -Confirm:$false 
```

根据文档 Alias 应该是一个合法的值。我现在无法对此进行测试，但这应该可以。请记住，您正在删除所有组成员。

```
foreach ($member in Get-DistributionGroupMember -Identity $selecteddl) 
{
  Remove-DistributionGroupMember -Identity $selecteddl -Member $member -Confirm:$False
} 
```

# winforms - When using the Supervising Presenter pattern with C# WinForms, how do you accommodate for UI thread constraints?

> ID：10624075
> 
> 赞同：1
> 
> 时间：2012-05-16T18:00:39.203
> 
> 标签：winforms, c#-4.0, tdd, mvp

I am trying to apply TDD for the first time with a Form for an existing WinForms application that I need to write. I read "Agile Principles, Patterns, and Practices in C#", which is where most of my knowledge of TDD came from.

In the book the author recommends doing UI development with a slightly modified form of MVP which he referred to as Supervising Presenter which has the Presenter having a dependency on the View and the Model. I like the way this has caused the code in the Presenter to look. For the sake of illustration here is a trivial example:

```
class Presenter
{
  Public IDomainApi _api;
  Public IView _view;
  ...
  public void PerformOperation()
  {
    bool userDecidesToPerformOperation = _view.PromptUserToConfirmOperation();
    if( userDecidesToPerformOperation )
    {
       bool success = _api.PerformOperation();
       if( success)
         _view.AlertUserOperationSuccessful();
       else
         _view.AlertUserOperationFailed();
    }
  }
 } 
```

This all works great, for testing purposes I have a mock `IDomainApi` and a mock `IView`, I was able to be sure that my logic is sound in the controller life is good.

For the actual application `_api` is the real implementation of `IDomainApi` which does work over a network, and `_view` is an instance of a `Form` that implements `IView` which has all the required controls.

Some of the operations that the real `IDomainApi` performs take some time so I decided to modify the Presenter method slightly to alert the user that stuff is going on. The presenter was modified like so:

```
 public void PerformOperation()
  {
    bool userDecidesToPerformOperation = _view.PromptUserToConfirmOperation();
    if( userDecidesToPerformOperation )
    {
       _view.NotifyPendingOperation("Performing operation ...");
       bool success = _api.PerformOperation();
       _view.PendingOperationCompleted();
       if( success)
         _view.AlertUserOperationSuccessful();
       else
         _view.AlertUserOperationFailed();
    }
  } 
```

I added the new methods to the "real" `IView` implementation, and it just displays a simple dialog box that contains the passed in text and a progress bar set to indicate activity (marqee setting). Sadly when testing I found that the dialog does not have the progress indicator active because the thread the `Presenter` is running in is the UI thread (and its blocked waiting for `_api.PerformOperation()` to complete).

I have tried modifying the code that creates and uses the `Presenter` to call `Presenter` in a separate thread, but that causes the UI to not render properly (rendering only happens on UI thread and not the new one). The only solutions I can see to this problem involve expanding `IView` to expose the UI thread so that I can invoke the appropriate `IView` methods on that thread, but this seems like it would make the Presenter code ugly and would make it dependent on WinForms. Has anybody found a better way to handle this sort of thing? My searches online so far tend to produce mostly information about TDD with Web, does anybody know of a good resource on how to do some of these things that are specific to WinForms?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T22:42:11.077

The answer to your question has little to do with TDD. It's more about asynchronous method calls.

Let's look at these three lines of code from your `Presenter` class:

```
view.NotifyPendingOperation("...");
bool success = _api.PerformOperation(); 
_view.PendingOperationCompleted(); 
```

Remember, all things UI need to run on the UI thread. So, what else could be shifted to a background worker thread so that the UI thread stays free to update your progress bar?

Assuming that the presenter doesn't perform long-running (>0.4 seconds or so) operations itself, there's no harm if it runs on the UI thread.

However, it seems to be the case that `_api.PerformOperation()` is likely a long-running task and will thus block the UI thread. Thus I suggest to you that you execute only this method call on a separate thread.

There are many ways how to do this, and I cannot explain them all in detail. Instead, I'll provide you with some starting points instead:

*   Use a [`System.ComponentModel.BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx) to execute your API method on a background thread (via the `DoWork` event. Continue with `_view.PendingOperationCompleted` in a handler of the `RunWorkerCompleted` event...

*   ... but beware: When you subscribe a handler method to this event, it will get called on the background thread, from where you must not update the UI. Either perform a `.BeginInvoke` (Winforms-only mechanism) on your `_view` form to get back on the UI thread, or look into [`System.Threading.SynchronizationContext`](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx) (generic solution and not easy to understand at first, so google for some tutorials, too!).

*   Implement an asynchronous version of the `IDomainApi.PerformOperation` method, called `PerformOperationAsync`, that adheres to the so-called [Event-based Async Pattern (EAP)](http://msdn.microsoft.com/en-us/library/wewwczdw.aspx). The advantage of this pattern is that the "completed" event handler gets called in the same sync. context (which usually means, on the same thread) that issued the method call; meaning that unlike with `BackgroundWorker`, you get automatically called back on the UI thread and won't need to `BeginInvoke` in order to call methods on `_view`.

    MSDN has some slighty cryptic examples on [how to implement the EAP](http://msdn.microsoft.com/en-us/library/e7a34yad.aspx); please don't give up too quickly; google also for easier-to-grasp tutorials, they're easily found.

*   Starting in .NET 4, use the Task Parallel Library (TPL), i.e. the `Task<bool>` class in your case, to simplify async program logic. AFAIK, the TPL is built on top of the lower-level `SynchronizationContext` and the EAP (both mentioned above).

*   If you're writing C# 5 code (e.g. in Visual Studio 11), you can simplify your async program logic even more with the `async` and `await` language features, which are built on top of the TPL mentioned just above.

Again, these are only pointers to possible ways how to make your code execute asynchronously and thus free the UI thread to do UI work; if any of this is unfamiliar, google for further resources. Going into more detail would be beyond a simple answer.

# c# - 在 Metro 应用程序中将数组从 javascript 传递到 C#

> ID：10624077
> 
> 赞同：8
> 
> 时间：2012-05-16T18:00:45.460
> 
> 标签：c#, javascript, windows-8, windows-runtime

编辑：我找到了答案（在 Tejs 的帮助下）；见下文。

* * *

我正在使用 HTML/Javascript 以及一些基于 C# 的帮助程序库开发 Metro 应用程序。一般来说，我在从 Javascript 调用 C# 方法方面取得了很大的成功，但我似乎无法让传递数组（在我的特定情况下，字符串数组）工作。传递单个字符串没有问题。

我的代码是这样的：

```
// in javascript project
var string1 = ...;
var string2 = ...;
var string3 = ...;
var result = MyLibrary.MyNamespace.MyClass.foo([string1, string2, string3]); 
```

然后，在 C# 中：

```
// in C# project
public sealed class MyClass {
    public static string Foo(string[] strings) {
        // do stuff...
    }
} 
```

问题是方法“Foo”得到了一个长度正确的数组（所以在上面的例子中，3），但所有的元素都是空的。我也试过这个：

```
public static string Foo(object[] strings) {
... 
```

这也不起作用 - 同样，数组的大小是正确的，但所有元素都是空的。

我试过传递字符串文字，字符串变量，在javascript中使用“new Array(...)”，将“Foo”的签名更改为“params string[]”和“params object[]”，都无济于事.

由于传递单个字符串工作正常，我可能可以通过一些黑客来解决这个问题......但看起来这确实应该工作。对我来说，数组以正确的大小传入似乎真的很奇怪（即，无论做什么封送处理都知道有关 javascript 数组结构的某些信息），但内容却没有被填充。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:50:34.617

您的问题的解决方案非常简单，只需要敏锐的眼光就能注意到它。首先，您必须接受这样一个事实，即在 C#（也很可能是 javascript）中，您不能拥有数组数组（至少不像您的做法！）所以在您的 javascript 中：

> var 结果 = MyLibrary.MyNamespace.MyClass.foo([string1, string2, string3]);

在你的 C# 中：

> 公共静态字符串 Foo(string[] 字符串) {

您将需要让 Foo 方法传递字符串数组的几个参数，如下所示：

> 公共静态字符串 Foo(string[] string1, string[] string2, string[] string3) {

但是如果你想创建一个数组数组，你将不得不使用 List 构造函数：

> 公共静态字符串 Foo(List< string[] > strings) {

但上述答案的问题在于 Javascript 没有 List 构造函数，所以我建议使用第一个解决方案，除非你能找到解决这个问题的方法！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T16:59:42.163

诀窍是使用 IEnumerable 而不是 string[]。因此，将我的原始代码替换为以下内容：

```
public sealed class MyClass {
    public static string Foo(IEnumerable<string> strings) {
        // do stuff...
    }
} 
```

另请注意，如果您需要传递字符串以外的数组，则 IEnumerable 也可以工作。

感谢@Tejs 的启发！

# magento - Magento 的特色产品（按类别）

> ID：10624080
> 
> 赞同：0
> 
> 时间：2012-05-16T18:00:54.763
> 
> 标签：magento

我正在尝试调整一个模块，为我提供特定类别的特色产品。我*认为*它接近但还没有雪茄。显然我不能在这里使用 getSingleton("catalog/layer") 来获取当前的类别 ID。目前该模块会吐出特色产品，但它们与您所在的特定类别无关。

在此处获取当前类别的任何提示？您将在 /* THIS IS MY ADDITION */ 评论中看到我尝试按当前类别提取产品的内容。

```
class Adodis_Featuredproducts_Block_Product_Featured extends Mage_Catalog_Block_Product_Abstract
{

        protected $_priceBlockDefaultTemplate = 'catalog/product/price_fix.phtml';

        public $totproduct,$opt;
        public function __construct()
        {
            $totproduct=Mage::getStoreConfig("adodis_featuredproducts/adodis_block/adodis_featuredproduct_block_product_number");
            $opt=Mage::getStoreConfig('adodis_featuredproducts/adodis_general/adodis_featuredproducts_display_type');
            parent::__construct();

            /* THIS IS MY ADDITION */ 
        $layer = Mage::getSingleton(‘catalog/layer’);
            var_dump($layer);
            $_category = $layer->getCurrentCategory();
            /* END MY ADDITION */ 

            $currentCategoryId= $_category->getId();
            $storeId    = Mage::app()->getStore()->getId();
            $product    = Mage::getModel('catalog/product');
            /* @var $product Mage_Catalog_Model_Product */
            $todayDate  = $product->getResource()->formatDate(time());
            $products   = $product->setStoreId($storeId)->getCollection()
                ->addAttributeToSelect('status')
                ->addAttributeToFilter('featured_products', array('Yes'=>true))

                /* THIS IS MY ADDITION */ 
                ->addAttributeToFilter('category_id', array('in' => $currentCategoryId))
                /* END MY ADDITION */ 

                ->addAttributeToSelect(array('name', 'price', 'small_image'), 'inner')
                ->addAttributeToSelect(array('special_price', 'special_from_date', 'special_to_date'), 'left');
           /* @var $products Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection */
            Mage::getSingleton('catalog/product_status')->addVisibleFilterToCollection($products);
            Mage::getSingleton('catalog/product_visibility')->addVisibleInCatalogFilterToCollection($products);
          if($opt=='block'){
          $products->setOrder('hot_deals')->setPageSize($totproduct)->setCurPage(1);
          }
          else{
            $products->setOrder('hot_deals')->setPageSize(4)->setCurPage(1);
          }
            $this->setProductCollection($products);
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T19:15:04.757

在此处发布解决方案：

```
 /* THIS IS MY ADDITION */ 
        $_category = Mage::registry('current_category');
        /* END MY ADDITION */ 

        $currentCategoryId= $_category->getId();
        $storeId    = Mage::app()->getStore()->getId();
        $product    = Mage::getModel('catalog/product');
        /* @var $product Mage_Catalog_Model_Product */
        $todayDate  = $product->getResource()->formatDate(time());
        $products   = $product->setStoreId($storeId)->getCollection()
            ->addAttributeToSelect('status')
            ->addAttributeToFilter('featured_products', array('Yes'=>true))
            /* THIS IS MY ADDITION */ 
            ->addCategoryFilter($_category)
            /* END MY ADDITION */ 
```

# android - ListView 之后的滑动活动

> ID：10624083
> 
> 赞同：3
> 
> 时间：2012-05-16T18:01:05.203
> 
> 标签：android, listview, android-viewpager

首先，对于糟糕的问题标题感到抱歉。

我有一个自定义 ListView，里面装满了从 xml 文件中解析的问题。单击其中一个问题后，将开始一项新活动，并有可能回答该问题。这些问题有不同类型的答案，如开放文本、多项选择、滑块......每种答案类型都有一个活动。回答完问题后，用户按下确定按钮并返回到 ListView。

到目前为止，这有效

但是，我想添加滑动。用户单击 ListView 中的问题，回答它，然后可以滑动到下一个问题或前一个问题。

实现它的最佳方法是什么？保持我的回答活动并使用手势检测器在它们之间切换？将我的回答活动转换为片段并使用 ViewPager？

编辑：一个大问题可能是问题以及答案类型（活动）总是不同的，而不是静态的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:05:49.787

为什么不创建要使用的 ArrayList 并根据这些意图调用活动，在填充 ListView 时将意图添加到 ArrayList

# c# - 在 DataContract Serialiser 中停止循环引用

> ID：10624085
> 
> 赞同：0
> 
> 时间：2012-05-16T18:01:11.660
> 
> 标签：c#, xml-serialization

当使用数据契约序列化一个对象时，我遇到了循环引用的问题。我知道使用 IsReference=true 但我不能使用它，因为我是从我无法控制的对象继承的。有什么办法可以绕过，我可以数一下然后退出，比如休息一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:32:14.643

按照此处的建议实施自定义 DataContractSerializerBehavior：我认为[Circular References and WCF](https://stackoverflow.com/questions/4967603/circular-references-and-wcf) should fix it?

为非 WCF 更新：

链接答案中的解决方案基于使用：

```
new DataContractSerializer(type, name, ns, knownTypes,
                          0x7FFF //maxItemsInObjectGraph,
                          false //ignoreExtensionDataObject,
                          **true** //preserveObjectReferences,
                          null //dataContractSurrogate); 
```

我认为使用这个构造函数应该可以解决它。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-16T18:06:21.073

你可以使用弱引用吗？

[http://msdn.microsoft.com/pt-br/library/system.weakreference.aspx](http://msdn.microsoft.com/pt-br/library/system.weakreference.aspx)

# python - 在python中定义ctype等价结构

> ID：10624091
> 
> 赞同：1
> 
> 时间：2012-05-16T18:01:41.127
> 
> 标签：python

我以这种方式在define.h文件的结构中有一个结构：

```
typedef struct
{
 byte iVersion;
 long iMTPL;
 byte iMPR;
 byte iTempCompIndex;
 byte iTempCompRemainder;

} Message_Tx_Datapath;

typedef struct
{
 byte               iNumTxPaths;
 Message_Tx_Datapath datapath[NUM_TX_PATHS];
 } Message_Tx; 
```

我想为此在python中使用ctypes定义一个等效结构，这样当我使用dll时，我可以传递这个结构来获取python中的数据。

如何在 python 中定义它。我知道如何定义单级结构，但这是结构中的结构，我不确定如何定义它。请帮忙。

这是我开始我的代码的方式：

```
class Message_Tx(ctypes.Structure):
   _fields_ = [("iNumTxPaths",c_byte),("datapath",????)] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:23:45.760

看起来像这样：

```
import ctypes

NUM_TX_PATHS = 4    # replace with whatever the actual value is

class Message_Tx_Datapath(ctypes.Structure):
    _fields_ = [('iVersion', ctypes.c_byte),
                ('iMTPL', ctypes.c_long),
                ('iMPR', ctypes.c_byte),
                ('iTempCompIndex', ctypes.c_byte),
                ('iTempCompRemainder', ctypes.c_byte)]

class Message_Tx(ctypes.Structure):
    _fields_ = [('iNumTxPaths', ctypes.c_byte),
                ('datapath', Message_Tx_Datapath*NUM_TX_PATHS)] 
```

请参阅[有关数组的 ctypes 文档](http://docs.python.org/library/ctypes.html#arrays)。

# javascript - 在客户端确定 favicon 文件（.ico 扩展名）？

> ID：10624092
> 
> 赞同：1
> 
> 时间：2012-05-16T18:01:49.703
> 
> 标签：javascript

我知道这是可能的，因为这就是小书签在诸如美味之类的社交书签网站上的工作方式。

1.  谷歌有一个 API 可以为你提取它，但它只有大约 80% 的时间有效。

2.  检查默认位置 host.com/favicon.ico 并不经常工作，可能是 50%。

我正在寻找的链接如下所示：

```
<link href="/static/27009/images/favicon.ico>
<link rel="shortcut icon" href="/static/favicon.ico" /> 
```

一个想法是将网站加载到`visibility:none`iframe 中并通过在文本中搜索`xxxx.ico`.

或者，如果可以访问 iframe dom 并以这种方式获取它。

如何拉图标位置客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:51:55.017

如果你不关心旧浏览器，你可以使用`document.querySelector`来获取 favicon`<link>`元素：

```
var link,
    favicon;
link = document.querySelector('link[rel="shortcut icon"]');
favicon = link ? link.href : '/favicon.ico'; 
```

# javascript - 更改打开的画廊的颜色

> ID：10624095
> 
> 赞同：0
> 
> 时间：2012-05-16T18:01:53.573
> 
> 标签：javascript, jquery, css

我目前正在从事画廊设计。页面上有 2 个 div。左侧 div 是画廊列表，右侧是画廊视图。根据您在左侧列表中单击的那个，右侧的可见画廊更改使用 JavaScript。当任何画廊从左侧列表打开时，它在列表中应该是蓝色的。如果您打开另一个画廊，它应该又是黑色的，而刚刚打开的画廊应该是蓝色的。

我怎样才能实现我的目标？我可以使用 JavaScript 更改列表元素的颜色吗？

这是我的画廊；[http://goo.gl/kfjlJ](http://goo.gl/kfjlJ)

隐藏和显示画廊的 JavaScript 代码。

```
$(window).load(function(){

$('a').click(function() {
  $('.gallery').hide();
  $('#' + $(this).data('gallery')).show();
});
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:10:21.570

假设列表具有这种格式

```
<ul id="list-name">
  <li><a>One</a></li>
  <li><a>Two</a></li>
</ul> 
```

好的？你可以这样做：

```
$(window).load(function(){
  $('a').click(function() {
    $('.gallery').hide();
    $('#' + $(this).data('gallery')).show();
    $('#list-name li.active').removeClass("active");
    $(this).parent().addClass("active");
  });
}); 
```

因此，您只需创建 css 类“#list-name li.active”即可为活动图库提供所需的颜色。

我理解你的问题了吗？

# sql-server - 从一个巨大的表中删除数据

> ID：10624099
> 
> 赞同：0
> 
> 时间：2012-05-16T18:02:10.743
> 
> 标签：sql-server, sql-server-2008, tsql, sql-server-2005

我有几张表，它们都有大约：500 万行，每个表都有 Active 列。我想从 Active = 0.using delete 需要大量时间的所有表中删除数据，而且我无法截断该表，因为它具有外键约束和标识字段。

有没有一种有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:16:07.563

我仍然是一名 JR 程序员，但如果你要删除一些非常大的东西，而它只有一个字段（Active = 0），但这需要很长时间。在我眼里你有两个选择。

1）运行该查询，并耐心等待。

2）找到另一种方法将查询分成几个较小的查询。例如，active = 0 和以 AG 开头的用户名，然后是 HP 的用户名，以此类推。（伪示例，但你明白我希望的想法吗？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:14:28.947

您还可以删除块中的行

[http://www.java2s.com/Tutorial/SQLServer/0400__Transact-SQL/DeletingRowsinChunks.htm](http://www.java2s.com/Tutorial/SQLServer/0400__Transact-SQL/DeletingRowsinChunks.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T21:03:37.307

要记住的另一件事是复制。如果表很大，并且您必须删除很多记录，您可能希望在发生如此多的删除之后放置一个等待[延迟，这样您就不会泛滥复制命令。](http://msdn.microsoft.com/en-us/library/ms187331.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T22:05:31.023

```
declare @batchsize int 10000;

while(1=1)
begin
   delete top (@batchsize) 
   from your_table 
   where isActive = 0;

   if (@@rowcount = 0)
   begin
      break
   end
end 
```

如果查找 isActive = 0 的行是“昂贵的”（即，这是一个非索引选择），您可能需要先将这些行的主键选择到临时表中，然后根据连接从表中删除临时表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T23:31:57.543

试试这个。

这个想法是复制表，重新创建表，并复制活动数据

1.  SSMS > 右键单击​​表并选择 Script table as - Create To - New Window (不要执行)
2.  将现有表重命名为另一个名称。
3.  在第 1 步运行脚本
4.  从重命名表运行复制脚本到新创建的表

    插入新表 select * from RenamedTable where active=1

5.  删除重命名表

让我知道情况如何。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-16T18:20:06.850

这是我以前用来批量删除行的模板，你可以试试：

```
-- Pick the boundaries of the data you want to delete based on
-- the Primary Key of your table
DECLARE
    @StartID INT, -- Pick the appropriate datatype of your PK
    @EndID INT, -- Pick the appropriate datatype of your PK
    @BatchSize INT, -- Number of rows to delete in batch
    @Count INT -- Temporary counter of rows deleted

SELECT TOP 1
    @StartID = PrimaryKeyID
FROM
    dbo.Table WITH (NOLOCK)
ORDER BY
    PrimaryKeyID ASC

SELECT TOP 1
    @EndID = PrimaryKeyID
FROM
    dbo.Table WITH (NOLOCK)
ORDER BY
    PrimaryKeyID DESC

SELECT
    @BatchSize = 1000,
    @Count = 1

-- You can skip this table if you like
-- The idea is to reduce the number of rows processed
-- in the batch below
CREATE TABLE #Temp
(
    [ID] INT
)

WHILE @Count > 0
BEGIN
    TRUNCATE TABLE #Temp

    DELETE TOP (@BatchSize)
    FROM
        dbo.Table WITH (ROWLOCK)
    OUTPUT
        DELETED.PrimaryKeyID
    INTO #Temp
    (
        [ID]
    )
    WHERE
        PrimaryKeyID >= @StartID
    AND PrimaryKeyID <= @EndID
    AND Active = 0

    SET @Count = @@ROWCOUNT

    IF @Count = 0
    BEGIN
        BREAK
    END

    -- Move the @StartID
    SELECT TOP 1
        @StartID = [ID]
    FROM
        #Temp
    ORDER BY
        [ID] DESC

    WAITFOR DELAY '00:01' -- delay for 1 second to allow any other queries running to process
END 
```

# javascript - Google Chrome 开发者工具中的脚本下拉列表中有很多（程序）条目

> ID：10624101
> 
> 赞同：4
> 
> 时间：2012-05-16T18:02:17.260
> 
> 标签：javascript, google-chrome-devtools

我最近注意到，为了调试我的 JavaScript，我在脚本文件中放置的任何断点都不会在调试器中命中。似乎脚本被复制并列在名称（程序）下[见图]。如果我将断点放在（程序）脚本中，它就会被命中。当我有很多脚本时，我必须查看每个（程序）列表并找出哪个是我要调试的脚本。任何人都知道是否有办法解决这个问题或为什么会发生这种情况？

我的谷歌浏览器版本是 18.0.1025.168 m

![脚本调试器截图](../Images/2699b2b7495a868c557e727d098a3774.png)

**更新：** 根据 Paul Irish 的建议，我升级到版本 19 (19.0.1084.46 m)，如果我将断点放在（程序）文件中，我仍然只能调试：

![脚本调试器屏幕截图 2](../Images/1718478a12c5418ff6f4f0d2e9b85a79.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-24T14:46:11.887

这很可能是因为使用了 'eval' 或 new Function([string]) - 没有在文件中直接引用并在全局上下文中解释的代码（来自字符串）。

更新：您正在使用 jQuery 模板，它使用 Function 构造函数。

# asp.net - 一个数据库登录，根据人使用不同的数据库

> ID：10624102
> 
> 赞同：1
> 
> 时间：2012-05-16T18:02:17.523
> 
> 标签：asp.net, sql, sql-server

我打算做一个网站，人们必须登录才能访问它。很容易。现在，一旦他们登录，根据他们的会员信息，我希望网站使用特定的数据库。

因此，我可以拥有 100 个具有相同结构的数据库，但每个特定用户组的数据不同 - 而不是拥有一个大型数据库并确定他们可以使用标识符列访问哪些数据。

不确定我在这里是否有意义。基本上，一个网站，多个网站取决于会员资格。

我有办法做到这一点吗？是否有另一种有效的方法？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:19:19.653

如果我理解正确，您仍然只有一个 Membership 数据库，并且在身份验证之后，根据某些标准，您的应用程序会根据用户切换连接字符串，但它只是一个应用程序。

从技术上讲，这并不是特别具有挑战性，因为所有常见的数据访问机制（Linq2SQL、EntityFramework、SQLClient 等）都允许在运行时提供连接字符串。您可以将 100 个连接字符串添加到您的 web.config，或者将它们存储在其他地方（例如您的初始会员数据库）。

但是，从长远来看，您可能会发现更容易根据用户与数据的关联过滤特定的数据，并只保留一个数据库。

考虑

*   如果允许用户访问多个“数据库”价值的数据会发生什么情况。在一个数据库模型中，它就像在 user:data many:many 表中添加另一个链接一样简单。
*   您现在有 100 个数据库要备份、索引等（？许可！）。
*   整合数据的报告现在必须跨 100 个数据库加入
*   对于这么多数据库，SQL 缓存和连接池不会那么有效。
*   如果您需要更改架构或存储过程怎么办？您现在需要在任何地方复制它。

等等

# asp.net - 从 ASP.NET 生成进程是安全的还是可行的做法？

> ID：10624112
> 
> 赞同：1
> 
> 时间：2012-05-16T18:03:08.537
> 
> 标签：asp.net, web-services

所以我有一个 ASP.NET Web 服务，它需要使用命令行应用程序来完成一些工作。它可以作为与 ASP.NET Web 服务相同的用户运行，因此不需要模拟。在 ASP.NET 中生成进程是否安全\良好做法？

使用调用命令行应用程序的外部调度程序似乎是额外的开销。转换还可能涉及从同步切换到异步通信。Web 服务添加要调度的作业然后通过服务轮询调度程序等待该作业完成似乎是个坏主意。直接启动该过程将简化所有这一切，但前提是这样做是一个好主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:06:10.980

只要 Web Worker 在服务器上具有执行此操作的适当权限，拥有 ASP.NET 启动进程就没有本质上的问题。唯一需要注意的是 ASP.NET 是否应该等待它开始完成的进程。同样，如果要启动非自动关闭应用程序，请确保您没有同时打开太多实例，以免 IIS 资源匮乏。

# sql - 如何加入 2 个临时表？

> ID：10624120
> 
> 赞同：2
> 
> 时间：2012-05-16T18:03:38.627
> 
> 标签：sql, join, temp-tables

我创建了 2 个临时表，但在加入它们时遇到问题。

表格1

```
Create Table #First_Pay(
SAID int,
First_Payment date)
select b.CUSTNMBR, min(b.docdate) as first_payment
from RM20101 b
where b.CUSTNMBR = '1973204005'
and b.CHEKNMBR > '1'
Group by b.CUSTNMBR 
```

表 #2

```
Create Table #First_Bil(
SAID int,
First_Bill date)
Select a.CUSTNMBR, MIN(a.Tax_Date) as First_Bill
from SOP30200 as a
where a.CUSTNMBR = '1973204005'
Group by a.CUSTNMBR 
```

我使用了这个查询：

```
Select a.SAID, a.First_Bill, b.First_Payment
From #First_Bil a 
Full Join
#First_Pay b
On a.SAID = b.SAID;

drop table #First_Bil
drop table #First_Pay 
```

但我得到了空白。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:07:14.460

您必须将其插入到临时表中，而不仅仅是在创建临时表后选择数据：

```
Create Table #First_Pay(SAID int,
                        First_Payment date)

insert into #First_Pay select b.CUSTNMBR, min(b.docdate) as first_payment
                       from RM20101 b
                       where b.CUSTNMBR = '1973204005'
                       and b.CHEKNMBR > '1'
                       Group by b.CUSTNMBR

Create Table #First_Bil(SAID int,
                        First_Bill date)

insert into #First_Bil Select a.CUSTNMBR, MIN(a.Tax_Date) as First_Bill
                       from SOP30200 as a
                       where a.CUSTNMBR = '1973204005'
                       Group by a.CUSTNMBR 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:08:24.870

我假设您的表中有数据？创建它们后，您不插入任何地方吗？确保有一个插入行

# ios - 来自 ClientRuntimeChannel.cs 的 NullReferenceException

> ID：10624125
> 
> 赞同：1
> 
> 时间：2012-05-16T18:03:53.753
> 
> 标签：ios, xamarin.ios, monogame

我正在使用 MonoGame 将我的 XNA 项目转换为 iOS。这个过程进展顺利，但我注意到在过去几周我偶尔会从 ClientRuntimeChannel.cs 收到 NullReferenceException。看起来 Mono 试图在 null 上执行 Array.Copy()，但是堆栈跟踪不会返回到我直接调用的任何代码，并且调用堆栈在命中时几乎是空的；在进程（）中。

奇怪的是，这种情况有时会发生，但并非总是如此。继续抛过去让我的应用程序运行没有任何问题，但有时它发生在调试器附加之前，这使我的应用程序处于冻结状态我讨厌成为“我完全不知道这里发生了什么”事情的人，但我很难找到这个问题的原因。这是抛出异常时的堆栈跟踪。

[http://pastebin.com/jp3DjKFF](http://pastebin.com/jp3DjKFF)

谁能帮我破译发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T21:02:11.620

这是一个已知的错误：[https ://bugzilla.xamarin.com/show_bug.cgi?id=3676](https://bugzilla.xamarin.com/show_bug.cgi?id=3676)

它已在 5.3.3 (alpha) 版本中得到修复。

# python - noob：在 wxpython 对话框中组织输入字段

> ID：10624130
> 
> 赞同：0
> 
> 时间：2012-05-16T18:04:13.060
> 
> 标签：python, wxpython

我是 wxpython 的新手，所以这可能是一个非常简单的问题，我不知道。

我想弹出一个接受用户输入的对话框。查看。我想要多个用户输入字段。查看。我也想让它们出现在同一行，例如：

输入月份：*x*输入日期：*x*输入小时：*x*

等等......而不是让他们每个人都换行。所以如果我有这样的代码（从一些教程复制）：

```
import wx

class TextFrame(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self, None, -1, 'Text Entry Example', size=(300, 100))
        panel = wx.Panel(self, -1) 
        basicLabel = wx.StaticText(panel, -1, "Basic Control:")
        basicText = wx.TextCtrl(panel, -1, "I've entered some text!", size=(175, -1))
        basicText.SetInsertionPoint(0)
        pwdLabel = wx.StaticText(panel, -1, "Password:")
        pwdText = wx.TextCtrl(panel, -1, "password", size=(175, -1),style=wx.TE_PASSWORD)
        sizer = wx.FlexGridSizer(cols=2, hgap=6, vgap=6)
        sizer.AddMany([basicLabel, basicText, pwdLabel, pwdText])
        panel.SetSizer(sizer)

app = wx.PySimpleApp()
frame = TextFrame()
frame.Show()
app.MainLoop() 
```

我将如何使“基本控制”和“密码”字段出现在同一行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T20:14:26.347

如果您希望所有小部件位于同一行，则将大小调整器的列数从 2 更改为 4。或者使用水平方向的框大小调整器。

# android - ArrayIndexOutOfBoundsException 仅在 2 部电话上

> ID：10624133
> 
> 赞同：0
> 
> 时间：2012-05-16T18:04:27.580
> 
> 标签：android

我有这个应用程序的问题：

[https://play.google.com/store/apps/details?id=org.me.gp.project.holidays.countdown](https://play.google.com/store/apps/details?id=org.me.gp.project.holidays.countdown)

我有这份报告。在我朋友的手机和模拟器上一切正常。下面是有问题的报告和班级。它是一个负责 4x2 小部件的类。

```
public class CountdownService extends Service {
public static final String UPDATE = "update";
public static final String PLUS = "plus";
public static final String MINUS = "minus";
public static final long  MODIFY= 86400000;
Bitmap bla[]=null;
 private static final int kDigitsViewIds[] = {
        R.id.bmp0,
        R.id.bmp1,

    };  

@Override
public void onStart(Intent intent, int startId) {
    if (bla==null){
        getDigits();
    }

    String command = intent.getAction();
    int appWidgetId = intent.getExtras().getInt(
            AppWidgetManager.EXTRA_APPWIDGET_ID);
    RemoteViews remoteView = new RemoteViews(getApplicationContext()
            .getPackageName(), R.layout.countdownwidget);
    AppWidgetManager appWidgetManager = AppWidgetManager
            .getInstance(getApplicationContext());
    SharedPreferences prefs = getApplicationContext().getSharedPreferences(
            "prefs", 0);
    int year = prefs.getInt("year", 0);
    int month =prefs.getInt("month", 0);
    int day = prefs.getInt("day", 0);

    //plus button pressed

    TimeZone tz = TimeZone.getTimeZone("GMT+1:00");
    Date date1 = new Date();
    //Calendar calendar = new GregorianCalendar(2012, 05, 8, 18 );
    Calendar calendar = new GregorianCalendar(year, month, day);
    calendar.setTimeZone(tz);
    long timme = calendar.getTimeInMillis() - date1.getTime();
    int d = (int) ((timme / 1000) / (3600*24));

    Bitmap[] bla = getDigits(); 

    String days=String.format("%02d", d);

String time = days;
char[] digits = time.toCharArray(); 

for (int i = 0; i <= 1; i++) {
    char c =digits[i];
    int a=Character.getNumericValue(c);
remoteView.setImageViewBitmap(kDigitsViewIds[i], bla[a]);

}   

    // apply changes to widget
    appWidgetManager.updateAppWidget(appWidgetId, remoteView);
    super.onStart(intent, startId);
}
public Bitmap[] getDigits(){
    if (bla == null){
        bla = prepareDigits();

        }
    return bla;
    }

@Override
public IBinder onBind(Intent arg0) {
    return null;
}

private Bitmap[] prepareDigits() {
    int index = 10;
    Bitmap[] bla = new Bitmap[index];
    for (int i = 0; i < index; i++) {
    bla[1] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit1);
    bla[2] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit2);
    bla[3] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit3);
    bla[4] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit4);
    bla[5] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit5);
    bla[6] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit6);
    bla[7] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit7);
    bla[8] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit8);
    bla[9] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit9);
    bla[0] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit0);
    }
    return bla;
}
 } 
```

和报告：

```
java.lang.RuntimeException: Unable to start service       
org.me.gp.project.holidays.countdown.CountdownService@40520768 with Intent { act=update  
dat=countdownwidget://widget/id/26#update26 flg=0x4 
cmp=org.me.gp.project.holidays.countdown/.CountdownService (has extras) }: 
java.lang.ArrayIndexOutOfBoundsException
Caused by: java.lang.ArrayIndexOutOfBoundsException
at org.me.gp.project.holidays.countdown.CountdownService.onStart
(CountdownService.java:72)
at android.app.Service.onStartCommand(Service.java:428)
at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2115) 
```

我现在出了什么问题，在这

```
 int year = prefs.getInt("year", 0);
    int month =prefs.getInt("month", 0);
    int day = prefs.getInt("day", 0); 
```

我的默认值为 0，数据为 0.0.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:15:24.953

```
private Bitmap[] prepareDigits() {
    int index = 10;
    Bitmap[] bla = new Bitmap[index];
    for (int i = 0; i < index; i++) {
        bla[1] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit1);
        bla[2] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit2);
        bla[3] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit3);
        bla[4] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit4);
        bla[5] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit5);
        bla[6] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit6);
        bla[7] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit7);
        bla[8] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit8);
        bla[9] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit9);
        bla[0] =(Bitmap) BitmapFactory.decodeResource(getResources(), R.drawable.digit0);
        }
        return bla;
    }
} 
```

这对我来说很有趣。您正在创建一个大小为 10 的位图数组，然后循环 10 次，并添加 10 个可绘制对象，对吗？或者至少，您可以不使用循环并保留`bla[1] = ...`线条。另一个奇怪的是你开始在数组索引 1 处添加元素，而不是 0。

```
Bitmap[] bla = new Bitmap[index];
bla[0] = ((BitmapDrawable)getResources().getDrawable(R.drawable.digit0)).getBitmap();
bla[1] = ((BitmapDrawable)getResources().getDrawable(R.drawable.digit1)).getBitmap();
bla[2] = ((BitmapDrawable)getResources().getDrawable(R.drawable.digit2)).getBitmap();
// etc 
```

就个人而言，我认为您应该使用`List<Bitmap>`. 数组在 5 年前是如此。

# javascript - QtScript Javascript 对象失去属性

> ID：10624135
> 
> 赞同：0
> 
> 时间：2012-05-16T18:04:34.423
> 
> 标签：javascript, qt, qtscript

我创建了一个 QScriptEngine 并将一个 QObject 设置为具有一些信号/插槽的全局对象。然后我加载一些脚本文件并将其传递给引擎（使用评估）。该脚本创建一个对象并将全局对象的一些信号连接到它的函数。

可悲的是，脚本对象的属性（this.password）在从信号调用其函数时被清除（它在评估期间设置，我检查过）。

这是脚本：

```
 function Chanserv(password) {
    this.password = password;

//    print("#### Constructor local: " + password + " / global: " + Bot.Password);
}

Chanserv.prototype.test = function() {
//    print("This is a test function / " + Bot.Password + " / " + this.password);
}

Chanserv.prototype.auth = function() {
    print("#### entered auth function! " + this.password);
//    if (this.password && this.password.length > 0) {
    if (Bot.Password && Bot.Password.length > 0) {
        Bot.sendMessage("nickserv", "identify " + Bot.Password);
//        print("Trying to authenticate with " + this.password);
    }
    else {
        print("Bot.Password undefined.");
//        print("this.password = " + this.password 
//              + ", this.password.length = " + (this.password.length > 0));
    }
}

var chanservObject = new Chanserv(Bot.Password);  // this.password gets set

chanservObject.test();
try {
    Bot.joinedChannel.connect(chanservObject.auth); // this.password is empty when called...
    Bot.joinedChannel.connect(chanservObject.test);
//    Bot.connected.connect(chanserv.auth);
}
catch (e) {
    print(e);
} 
```

任何想法为什么会发生这种情况？

问候本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:41:10.113

Javascript 对象通过引用传递。`Bot.Password`打电话前要修改`chanservObject.auth`吗？

# entity-framework-4 - 如何安装 EF 4.3？

> ID：10624138
> 
> 赞同：2
> 
> 时间：2012-05-16T18:04:42.653
> 
> 标签：entity-framework-4

现在我正在使用 EF 4.1。我想升级到4.3。我所做的是： 1\. 为 VS 2010 安装 NuGet 2\. 使用管理 NuGet 包安装 EF 4.3。

然后我收到错误消息：在您的工作区中找不到项目 C:\MyFolder\packages\EntityFramework.4.3.1\lib\net40\EntityFramework.dll，或者您无权访问它。

这条消息很困惑，因为 MyFolder 不应该参与此安装，因为它是用户创建的文件夹。这是否意味着我应该在运行 Manage NuGet Packages 以安装 EF 4.3 之前安装一些东西？

# c# - 使用 Bass.Net 在 C# 上从 RTSP 流式传输音频

> ID：10624142
> 
> 赞同：0
> 
> 时间：2012-05-16T18:04:58.863
> 
> 标签：c#, audio-streaming, rtsp, bass.dll

我有一个流式传输 MPEG-4（视频/音频）的视频服务器

我需要从 MPEG-4 中获取音频...是否可以只获取音频？

我想要一些教程、示例、示例或一些有用的东西来开始编写我的应用程序。

我发现了这个：[Bass.Net](http://www.un4seen.com/)流式传输音频，但我不知道它是否支持 RTSP，我想知道是否有人有任何教程或有用的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:05:26.577

您可以使用我的库获取各个数据包并对其进行处理。

您还可以使用我的库聚合源。

该库是[@http://net7mma.codeplex.com/](http://net7mma.codeplex.com/)

有一篇文章@CodeProject [http://www.codeproject.com/Articles/507218/Managed-Media-Aggregation-using-Rtsp-and-Rtp](http://www.codeproject.com/Articles/507218/Managed-Media-Aggregation-using-Rtsp-and-Rtp)解释了它是如何工作的。

如果您还需要什么，请告诉我！

# php - 从数组中的每个值中删除破折号，然后重建数组

> ID：10624145
> 
> 赞同：3
> 
> 时间：2012-05-16T18:05:15.197
> 
> 标签：php, codeigniter

我在这方面遇到了很多麻烦，现在我知道为什么了。

我有一个动态数组，可以包含 1 个或多个值：

```
[array] => Array
    (
        [0] => blurb
        [1] => news
        [2] => entertainment
        [3] => sci
        [4] => diablo-3
    ) 
```

这是我的模型

```
 public function create_session_filter($filters)
    {
        $array = split("\|", $filters);
        $filter['filter'] = $array;
        $this->session->unset_userdata('filter');
        $this->session->set_userdata($filter);
    } 
```

运行数组 $filters 时，我需要从任何单个数组值中删除任何破折号并用空格替换它们。

这产生了一些时髦的结果：

```
 public function create_session_filter($filters)
    {
        $filterarray = array();
        $array = split("\|", $filters);
        foreach ($array as $filter) 
        {
            print_r($filter);
            $filterspace = implode(' ', explode('-', $filter));
            $filterarray = array_push($filterarray, $filterspace);
        }
        $filter['filter'] = $filterarray;
        $this->session->unset_userdata('filter');
        $this->session->set_userdata($filter);
    } 
```

这样做的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:10:47.773

所有的爆炸和内爆并不是真正必要的。您也不需要创建一个新数组。您可以通过引用循环浏览您的值，并在单行中修改它们：

```
$array = array( "blurb", "news", "diblo-3" );

$array = str_replace( "-", " ", $array ); 
```

哪个输出：

```
Array
(
  [0] => blurb
  [1] => news
  [2] => diblo 3
) 
```

演示：[http ://codepad.org/up0VoZ21](http://codepad.org/up0VoZ21)

# php - PHP IF 语句中的 Echo 变量和 HTML

> ID：10624146
> 
> 赞同：2
> 
> 时间：2012-05-16T18:05:21.610
> 
> 标签：php, html, input, if-statement, echo

我有以下代码，它完全符合我的预期：

```
<?php if ($a - $b < 1)
echo $text;
elseif ($a - $b >= 1)
echo $a - $b;
else
echo $a; ?> 
```

但是，现在我还想根据 IF 语句的结果在 echo 中添加一些 HTML。

```
<?php if ($a - $b < 1)
echo $text;
elseif ($a - $b >= 1)
echo $a - $b;
<input type="button" value="<?php echo $button_txt; ?>" id="button" class="button" />
else
echo $a;
<input type="button" value="<?php echo $button2_txt; ?>" id="button" class="button" /> ?> 
```

当我这样做时，我收到以下错误：解析错误：语法错误，第 213 行上的意外'<'（第 213 行是指`<input>`上面代码中的第一行）。

有没有办法在 IF 语句的 echo 部分中同时包含变量和 HTML？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:09:41.290

编辑：更好的格式

```
<?php if ($a - $b < 1): ?>
  <?php echo $text ?>
<?php elseif ($a - $b >= 1): ?>
  <?php echo $a - $b ?>
  <input type="button" value="<?php echo $button_txt ?>" id="button" class="button" />
<?php else: ?>
  <input type="button" value="<?php echo $button2_txt ?>" id="button" class="button" />
<?php endif ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:09:22.107

试试这个

```
<?php if ($a - $b < 1)
echo $text;
elseif ($a - $b >= 1)
{
echo $a - $b;
?>
<input type="button" value="<?php echo $button_txt; ?>" id="button" class="button" />
<?php
else
 {
echo $a;
?>
<input type="button" value="<?php echo $button2_txt; ?>" id="button" class="button" />
<?php } ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:09:22.680

您需要回显您的 html 行：

```
<?php if ($a - $b < 1)
echo $text;
elseif ($a - $b >= 1)
echo $a - $b;
echo "<input type=\"button\" value=\"$button_txt\" id=\"button\" class=\"button\" />";
else
echo $a;
echo "<input type=\"button\" value=\"$button2_txt\" id=\"button\" class=\"button\" /> ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T18:11:00.160

在开始 html 代码之前，您需要关闭 php 语句，因此您的代码应如下所示：

```
<?php if ($a - $b < 1)
echo $text;
elseif ($a - $b >= 1)
echo $a - $b;
?>
<input type="button" value="<?php echo $button_txt; ?>" id="button" class="button" />
<?php else
echo $a;
?>
<input type="button" value="<?php echo $button2_txt; ?>" id="button" class="button" /> ?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T18:20:10.900

PHP 和 HTML 是不同的语言，它们的解释不同。 `<input type="button">`在 PHP 中没有任何意义，实际上是无效的。PHP 代码位于标签之间`<?php`，`?>`HTML 位于标签之外或引号之间（使其成为字符串）。

一个解决方案可能是：

```
<?php

if ($a - $b < 1)
    echo $text;
elseif ($a - $b >= 1)
{
    echo $a - $b;
    echo '<input type="button" value="' . $button_txt . '" id="button" class="button" />';
}
else
{
    echo $a;
    echo '<input type="button" value="' . $button2_txt . '" id="button" class="button" />';
}

?> 
```

请注意，实际的 HTML 代码现在介于两者之间`'`，`'`因为在 PHP 中它被视为常规文本。另外，我添加了括号`{`和`}`: 当 an`if`后跟多个指令时，需要括号来指定属于`if`. 这同样适用于`else`.

# c++ - C ++将一个结构值复制到另一个

> ID：10624147
> 
> 赞同：0
> 
> 时间：2012-05-16T18:05:22.927
> 
> 标签：c++, copy, structure

我有一个简单的结构：

```
struct Appartament
{
  char address[50];
  char telephoneNumber[20];
  char view[10];

  double price;
  double distanceFromCenter;

  int roomCount;
}; 
```

我有一些记录写在一个文件中。现在，我想从文件中读取所有记录，并且只获取那些 roomCount 小于数字（用户输入）的记录。这很容易，但记录应按价格排序显示。这就是我必须将它们放在一个数组中然后对它们进行排序的方式。

我有一些问题，我相信这是因为我没有很好地处理这些结构。

我尝试了不同的方法：

```
strcpy(CurrentRecords[index].address,currentRecord.address);
strcpy(CurrentRecords[index].telephoneNumber,currentRecord.telephoneNumber);
strcpy(CurrentRecords[index].view,currentRecord.view);
CurrentRecords[index].price=currentRecord.price;
CurrentRecords[index].distanceFromCenter=currentRecord.distanceFromCenter;
CurrentRecords[index].roomCount=currentRecord.roomCount; 
```

或者

```
memcpy(CurrentRecords[index],currentRecord,sizeof(Appartament)); 
```

和

```
CurrentRecords[index]=currentRecord 
```

但没有任何效果...

编辑：这是我的代码 - “没有任何效果”指的是无限循环。

```
 void AdvanceSearch()
    {
        clrscr();

        Appartament currentRecord;

        fstream currentFile("Records.dat",ios::binary|ios::in);

        if(!currentFile)
        {
            cout<<"Error - the file could not be opened."<<endl;
            return;
        }
        else
        {
            //Array with apartments records
            Appartament CurrentRecords[MaxRecords];

            currentFile.seekg(0L,ios::end);
            long int length=currentFile.tellg();
            currentFile.seekg(0L,ios::beg);

            int isAppartamentFound=0;

            if(length==0)
            {
                cout<<"The file is empty."<<endl;
                return;
            }
            else
            {
                int userRoomCount;

                do
                {
                    clrscr();
                    cout<<"Enter apartment room count - ";
                    cin>>userRoomCount;
                }while(userRoomCount<0);

                clrscr();

                cout<<endl<<"Apartments with "<<userRoomCount<<" rooms order by price:";

                currentFile.read((char*)(&currentRecord),sizeof(Appartament));

                int index=0;

                while(!currentFile.eof())
                {
                    if(currentRecord.roomCount==userRoomCount)
                    {

                         /*
                        strcpy(CurrentRecords[index].address,currentRecord.address);
                        strcpy(CurrentRecords[index].telephoneNumber,currentRecord.telephoneNumber);
                        strcpy(CurrentRecords[index].view,currentRecord.view);
                        CurrentRecords[index].price=currentRecord.price;
                        CurrentRecords[index].distanceFromCenter=currentRecord.distanceFromCenter;
                        CurrentRecords[index].roomCount=currentRecord.roomCount;
                         */

                         memcpy(CurrentRecords[index],currentRecord,sizeof(Appartament));

                        //CurrentRecords[index]=currentRecord;
                        index++;
                        isAppartamentFound=1;
                    }

                    currentFile.read((char*)(&currentRecord),sizeof(Appartament));
                }

                currentFile.close();
            }

            if(isAppartamentFound==0)
            {
                cout<<endl<<"There are no matches!"<<endl;
            }
            else
            {
                //If only one apartment is found
                if(sizeof(CurrentRecords)/sizeof(Appartament)==1)
                {
                    cout<<endl;
                    ShowRecord(currentRecord);

                }
                else
                {
                    //Sort the records

                    Appartament tempApartament;

                    int isChangeMade=1;

                    while(isChangeMade==1)
                    {
                        isChangeMade=0;

                        for(int index=0;index<(sizeof(CurrentRecords)/sizeof(Appartament))-1.0;index++)
                        {
                            if(CurrentRecords[index].price>CurrentRecords[index+1].price)
                            {
                                isChangeMade=1;

                                CopyApartament(tempApartament,CurrentRecords[index]);
                                CopyApartament(CurrentRecords[index],CurrentRecords[index+1]);
                                CopyApartament(CurrentRecords[index+1],tempApartament);
                            }
                        }
                    }

                    for(int index=0;index<sizeof(CurrentRecords)/sizeof(Appartament)-1.0;index++)
                    {
                        ShowRecord(CurrentRecords[index]);
                    }
                }
            }
         }
    }

    void CopyApartament(Appartament RecordOne,Appartament RecordTwo)
    { 
                    /*
        strcpy(RecordOne.address,RecordTwo.address);
        RecordOne.distanceFromCenter=RecordTwo.distanceFromCenter;
        RecordOne.price=RecordTwo.price;
        RecordOne.roomCount=RecordTwo.roomCount;
        strcpy(RecordOne.telephoneNumber,RecordTwo.telephoneNumber);
        strcpy(RecordOne.view,RecordTwo.view);
                    */
                    RecordOne=RecordTwo;

    } 
```

注意：我认为我的问题是复制，因为我不知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:09:34.790

```
CurrentRecords[index]=currentRecord; 
```

这复制了整个结构，并且应该按预期工作。

你确定你排序正确吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:13:25.317

我看不出有什么特别好的理由在任何地方显式复制数据。我想我会做这样的事情：

```
std::vector<Apartment> get_apts(int max_rooms) { 

    std::vector<Apartment> apts;

    std::copy_if(file.begin(), file.end(), std::back_inserter(apts),
                 [max_rooms](Apartment const &a) { 
                     return a.roomCount < max_rooms; 
                 });

    std::sort(apts.begin(), apts.end(), 
              [](Apartment const &a, Apartment const &b) { 
                  return a.price < b.price); 
              });

    return apts;
} 
```

# spring - 查找哪个spring上下文文件加载了bean

> ID：10624152
> 
> 赞同：3
> 
> 时间：2012-05-16T18:05:48.423
> 
> 标签：spring

它是一个很大的应用程序，并且有多个由 spring 容器加载的 bean xml 文件。

不知何故，有一个 bean（具有相同的 id）被覆盖。

有没有办法告诉spring记录哪个bean是从哪个.xml文件创建的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:35:32.997

您可以创建`ReaderEventListener`并记录它们。但是您需要覆盖`initBeanDefinitionReader`以设置您的`Listener`开启`XmlBeanDefinitionReader`（我认为没有其他方法，但可能是......）。

例如：

```
 public class LogReaderEventListener extends EmptyReaderEventListener {

    private static final Log log = LogFactory.getLog(LogReaderEventListener.class);

    @Override
    public void componentRegistered(ComponentDefinition componentDefinition) {

        log.info("Registered Component [" + componentDefinition.getName() + "]");
        for (BeanDefinition bd : componentDefinition.getBeanDefinitions()) {
            String name = bd.getBeanClassName();

            if (bd instanceof BeanComponentDefinition) {
                name = ((BeanComponentDefinition) bd).getBeanName();
            }
            log.info("Registered bean definition: [" + name + "]" + 
                    " from " + bd.getResourceDescription());
        }
    }

    public static void main (String[] args) {
        ClassPathXmlApplicationContext context = new LogXmlContext("applicationContext.xml");
        context.close();

    }

}

class LogXmlContext extends ClassPathXmlApplicationContext {

    public LogXmlContext(String configLocation) {
        super(configLocation);
    }

    @Override
    protected void initBeanDefinitionReader(XmlBeanDefinitionReader reader) {
        super.initBeanDefinitionReader(reader);
        reader.setEventListener(new LogReaderEventListener());
    }

} 
```

# multithreading - MFC 对话框冻结

> ID：10624153
> 
> 赞同：0
> 
> 时间：2012-05-16T18:05:54.450
> 
> 标签：multithreading, mfc, dialog, serial-port, modem

我需要帮助如何解冻我的对话框。我正在使用 MFC，当按下按钮时，我想执行一个无限循环。但是，当无限循环开始时，对话框会冻结。现在我查看了 有人遇到类似问题的[线程。](http://forums.codeguru.com/archive/index.php/t-498486.html)

不幸的是，我尝试了多线程，但我发现它对我不起作用，因为我使用的是使用 OLE 自动化的 api，并且我遇到了未处理的内存异常。我认为这是因为程序使用了串行端口，而我在某处读到您只能在一个线程中使用串行端口的句柄。

我的程序只是查看是否有人拨入我的调制解调器并等待他们向我发送文件，然后挂断。这是我的循环。

```
while(1)
    {
        //get rid of input buffer
        ts->_this->m_pHAScript->haReleaseRemoteInput();
        ts-> _this->textBox->SetWindowTextA("thread Commence");
        //wait for connected
        if(success = ts->_this->m_pHAScript->haWaitForString("CONNECT",timeout))
        {
            //getFile
            if(success = ts->_this->m_pHAScript->haWaitForXfer(5000))
            {
                //hangup
                ts->_this->haTypeText("+++ath\r");
            }
        }

    } 
```

有没有办法解冻对话框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:09:15.970

在 while 循环中添加此代码：

```
MSG msg;
while(PeekMessage(&msg, GetSafeHwnd(), 0, 0, PM_REMOVE))
{
  DispatchMessage(&msg);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:47:17.033

Windows 中的 GUI 依赖于消息循环 - 在代码中的某处，无论是显式还是隐藏在框架中，都有一个循环检查队列中的消息并对其进行处理。如果有任何东西阻止代码返回该循环，则 GUI 将被冻结。

有几种方法可以解决这个问题。[David Brabant](https://stackoverflow.com/a/10624210/5987)给出了一个，基本上是重复循环。另一种是启动一个独立运行阻塞操作的新“工作”线程。如果您的消息循环有一个在空闲时调用的函数，即队列中没有更多消息，您可以在那里进行一些处理；但是，在您的示例中这是不可能的。

# c++ - 安全握手失败 (SSL)

> ID：10624158
> 
> 赞同：0
> 
> 时间：2012-05-14T19:56:07.433
> 
> 标签：c++, networking, ssl, liblacewing

我正在使用一个名为 Lacewing 的库。[http://lacewing-project.org/](http://lacewing-project.org/)

它使用 windows crypt api 来制作安全服务器。

我为我的 PC（Josh-Laptop）创建了一个证书，我使用 netsh 将其绑定到端口 8012。Lacewing 说证书已成功加载。

然后问题来了。我正在尝试将消息从我家中的 1 台电脑（主机）发送到另一台（客户端）。

当我不加载证书并在不安全模式下使用它时，会发送和接收所有消息。

```
 void ServerCore::onConnect( Lacewing::Server::Client &client )
    {
        client.SendWritable("test");
    }

...

    void ServerCore::onReceive( 
        Lacewing::Server::Client &client, char * data, int size )
    {
        getServer().FirstClient()->SendWritable("test");
        client.SendWritable("test");
        std::cout << data << " was received from " << client.GetAddress().ToString() << std::endl;
    }

    void ClientCore::onConnect()
    {
        getClient().Send("test");
    }

    void ClientCore::onReceive( char * data, int size )
    {
        getClient().Send("Okay then...");
        std::cout << data << std::endl;
    } 
```

在客户端，我收到“测试”。在服务器端，库吐出一个错误，说“握手失败”，“重叠的 io 操作正在进行中”

这是我加载证书的方式：

```
getServer().LoadSystemCertificate("MY","JOSH-LAPTOP","localmachine"); 
```

为什么握手会失败？有什么我不明白的吗？谢谢

# spring-mvc - java.lang.IllegalStateException：Bean 名称的 BindingResult 和普通目标对象都不是

> ID：10624163
> 
> 赞同：0
> 
> 时间：2012-05-16T18:06:45.390
> 
> 标签：spring-mvc

当我尝试访问我创建的 Spring MVC 表单时出现以下错误：

java.lang.IllegalStateException：Bean 名称“roomSelection”的 BindingResult 和普通目标对象都不能用作请求属性

这是控制器：

```
@Controller
@RequestMapping("/welcome")
public class RoomSelectionListController {

final private static String WELCOME_VIEW     = "welcome";
final private static String SUCCESS_VIEW     = "chatroom";

// Value will be injected.
private ChatRoomRegistryService chatRoomRegistryService = null;
private RoomSelectionValidator roomSelectionValidator = null;

private static Logger logger = Logger.getLogger(RoomSelectionListController.class);

public ChatRoomRegistryService getChatRoomRegistryService() {
    return chatRoomRegistryService;
}

@Autowired
public void setChatRoomRegistryService(ChatRoomRegistryService    chatRoomRegistryService) {
    this.chatRoomRegistryService = chatRoomRegistryService;
}

@Autowired
public RoomSelectionListController(RoomSelectionValidator roomSelectionValidator) {
    this.roomSelectionValidator = roomSelectionValidator;
}

@ModelAttribute("roomSelection")
protected RoomSelection getRoomSelection() {
    logger.debug("Creating a RoomSelection instance");
    return new RoomSelection();
}

@ModelAttribute("chatRoomList")
protected List<ChatRoom> populateChatRoomList(HttpServletRequest request) throws Exception{
    logger.debug("Creating a chatRoomList");
    User user = (User) request.getSession().getAttribute("userLoggedIn");
    List<ChatRoom> chatRoomsForUser = chatRoomRegistryService.getChatRoomsForUser(user);

    return chatRoomsForUser;
}

@RequestMapping(method = RequestMethod.POST)
protected String processSubmit(@ModelAttribute("roomSelection") RoomSelection roomSelection, BindingResult result, ModelMap model, HttpServletRequest request, HttpServletResponse response) throws Exception {

    roomSelectionValidator.validate(roomSelection, result);
    if (result.hasErrors()) {
        return WELCOME_VIEW;
    } else {
        model.addAttribute("chatroom", roomSelection.getChatRoom());
        User user = (User) request.getSession().getAttribute("userLoggedIn");
        model.addAttribute("userLoggedIn", user);

        return SUCCESS_VIEW;
    }
}

@RequestMapping(method = RequestMethod.GET)
protected String initForm(ModelMap model) throws Exception {
    logger.debug("Inside RoomSelectionListController.initForm()");
    RoomSelection roomSelection = new RoomSelection();
    model.addAttribute("roomSelection", roomSelection);

    return WELCOME_VIEW;
}
} 
```

这是我的 JSP 表单部分：

```
<form:form id="joinForm" modelAttribute="roomSelection" method="POST">
    <table>
        <legend><spring:message code="welcome.chatroom.list.lbl" /></legend>
        <tr>
            <td>
                <form:select id="selectChatRoomList" path="chatRoomId" size="7" cssClass="chatRoomList">
                    <form:options items="${chatRoomList}" itemValue="chatRoomId"
                        itemLabel="chatRoomName" />
                </form:select>
            </td>
        </tr>
        <tr>
            <td><form:errors path="chatRoomId" cssClass="advchatError" /></td>
        </tr>
        <tr>
            <td>
                <a id="submitJoinChatRoom" href="javascript:void(0)" class="green-button" onclick="$('#joinForm').submit();">
                    <span class="green-button-outer">
                        <span class="green-button-inner">
                            <div class="joinRoomButtonWidth"><spring:message code="welcome.joinchat.lbl" /></div>
                        </span>
                    </span>
                </a>
            </td>
        </tr>
    </table>
</form:form> 
```

这似乎是一个常见的初学者问题，但我似乎无法弄清楚我做错了什么。有任何想法吗？

谢谢，

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T19:00:51.720

@史蒂夫N

我只是把你的代码简化了（意味着删除了那些服务依赖项，只有一个 get 方法来解决问题）。它就像魅力一样。也许你也可以让你的代码简单，然后在你有一个工作的东西到位后继续添加东西。这是我的代码

控制器

```
@Controller
@RequestMapping("/welcome")
public class RoomSelectionListController {
    final private static String WELCOME_VIEW     = "welcome";

    @RequestMapping(method = RequestMethod.GET)
    protected String initForm(ModelMap model) throws Exception {
        RoomSelection roomSelection = new RoomSelection();
        roomSelection.setRoomName("MyRoom");
        model.addAttribute("roomSelection", roomSelection);
        return WELCOME_VIEW;
    }
} 
```

RoomSelection bean

```
public class RoomSelection {
    private String roomName;

    public void setRoomName(String roomName) {
        this.roomName = roomName;
    }

    public String getRoomName() {
        return roomName;
    }

} 
```

欢迎.jsp

```
<form:form id="joinForm" modelAttribute="roomSelection" method="POST">
    <table>
        <tr>
            <td>Room Name : </td>
            <td>
                <form:input path="roomName"/>
            </td>
        </tr>
    </table>
</form:form> 
```

我的输出

![我的输出：](../Images/8d8746001d38a7b92a05faa5acf0dcfb.png)

我在您的代码中唯一怀疑的地方是您的 post 方法，当验证失败时，您将模型视图设置为 WELCOME_VIEW，我想知道在此期间您是否`@ModelAttribute`会被调用并且它是否会添加`roomSelection`属性。又是一个猜测。

# wpf - WPF 中的模态对话框

> ID：10624164
> 
> 赞同：4
> 
> 时间：2012-05-16T18:06:49.190
> 
> 标签：wpf, mvvm, showmodaldialog

这是我的问题：我正在将应用程序从 Windows 窗体迁移到 WPF，但我对 WPF 技术完全陌生。

我很幸运创建了一个功能区，也能够向它添加一些元素，但现在我正在努力创建一个模式对话框。

我怎样才能做到这一点？我已经创建了对话框的所有设计，但我无法将它作为模式窗口打开。

此外，由于这个应用程序必须在 MVVM 模式下开发，我在哪里可以放置该代码？根据我所读到的，该代码必须放在视图类中，对吗？

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:09:56.270

[您使用Window.ShowDialog](http://msdn.microsoft.com/en-us/library/system.windows.window.showdialog.aspx)以模态方式显示 WPF 窗口。此[WPF 窗口概述](http://msdn.microsoft.com/en-us/library/ms748948.aspx)也将有所帮助。

> 此外，由于这个应用程序必须在 MVVM 模式下开发，我在哪里可以放置该代码？

在您右侧的相关问题下查看，那里有很多关于这个问题的答案。例如：

[在 WPF MVVM 中打开对话框](https://stackoverflow.com/questions/1805778/open-dialog-in-wpf-mvvm)

# c# - 从子窗口添加一些项目后冻结主窗口

> ID：10624166
> 
> 赞同：0
> 
> 时间：2012-05-16T18:06:57.137
> 
> 标签：c#, .net, silverlight, entity-framework, mvvm

我正在使用 mvvm 和 WCF 服务开发 Silverlight 4。

每当我将项目从子窗口添加到主窗口时。但同时主窗口会自动进入禁用模式。我认为主窗口会自动冻结。

ChildWindow 视图模型

```
 public class AddFormFieldInformationViewModel : ViewModelBase
{

 private FieldInformationViewModel _FieldInformationViewModel;
    public FieldInformationViewModel FieldInformationViewModel
    {
        get { return _FieldInformationViewModel; }
        set
        {
            _FieldInformationViewModel = value;
            RaisePropertyChanged("FieldInformationViewModel");
        }
    }
 public void MoveSave(object obj)
    { this.FieldInformationViewModel.SelectedFormFields = FieldInformationModel;
                            ResultHandler(true);
 } 
```

公共操作结果处理程序 { 获取；放; } }

ChildWindow .xaml.cs 文件

```
public partial class AddExistingFormFieldCategoryView : ChildWindow
{
    private AddFormFieldInformationViewModel vm;
    public AddExistingFormFieldCategoryView()
    {
        InitializeComponent();
         vm = new AddFormFieldInformationViewModel();
        this.DataContext = vm;
        vm.ResultHandler = result => { if (result) { Close(); } };

    }        
} 
```

主窗口视图模型

```
public class FieldInformationViewModel : ViewModelBase
{   private void executeOpenChildWindow(object parameter)
    {
        AddExistingFormFieldCategoryView cw = new AddExistingFormFieldCategoryView();
        ((AddFormFieldInformationViewModel)cw.DataContext).FieldInformationViewModel = this;
        cw.Show();
    }
} 
```

将子窗口中的项目添加到主窗口后，有时我的主窗口会自动冻结。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:15:49.413

您好，这是您遇到的错误，请参阅下面的示例。我同样的问题，你必须手动启用主页的显示：

```
 private static void ShowError(string message, string details)
        {
            ErrorWindow error = new ErrorWindow(message, details);
            error.Closed += new EventHandler(error_Closed);
            error.Show();
        }

        static void error_Closed(object sender, EventArgs e)
        {
            Application.Current.RootVisual.SetValue(Control.IsEnabledProperty, true);
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T06:13:04.810

您可以子类化 ChildWindow 并将 RootVisual 显式设置为启用。[资源](http://connect.microsoft.com/VisualStudio/feedback/details/715768/closing-silverlight-childwindow-does-not-reenable-rootvisual)

```
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;

namespace DST_Common_Silverlight_Controls
{
    /// <summary>
    /// Bug in ChildWindow sometimes leaves app disabled. 
    /// </summary>
    public class ChildWindowEx : ChildWindow
    {
        protected override void OnClosed(EventArgs e)
        {
            base.OnClosed(e);
            Application.Current.RootVisual.SetValue(Control.IsEnabledProperty, true);
        }
    }
} 
```

然后只需在 xaml 中使用新类型而不是 ChildWindow，如下所示：

```
<slcommon:ChildWindowEx 
    x:Class="DST.AvSyncMonitor.Silverlight.Gui.ErrorWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:slcommon="clr-namespace:DST_Common_Silverlight_Controls;assembly=DST.Common.Silverlight.Controls"
    xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"    
    Title="Error">

    <Grid x:Name="LayoutRoot" Width="540">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock x:Name="IntroductoryText" Grid.Row="0" Margin="0" 
             Text="An unknown error was encountered. Please contact your administrator for more information."/>

        <StackPanel x:Name="ContentStackPanel" Grid.Row="2" Margin="0,6,0,0">

            <TextBlock x:Name="LabelText" TextWrapping="Wrap" Margin="0,0,0,2" 
                     Text="Error details"/>
            <TextBox x:Name="ErrorTextBox" Height="90" TextWrapping="Wrap" IsReadOnly="True"
                     VerticalScrollBarVisibility="Auto"/>

        </StackPanel>

        <Button x:Name="OKButton" Grid.Row="3" Click="OKButton_Click" 
            Width="75" Height="23" HorizontalAlignment="Right" Margin="0,10,0,0" 
            TabIndex="0" Content="OK"/>

    </Grid>

</slcommon:ChildWindowEx> 
```

# php - 块文件的 HTML5 进度条

> ID：10624170
> 
> 赞同：1
> 
> 时间：2012-05-16T18:06:58.347
> 
> 标签：php, javascript, html, file-upload, progress-bar

我有一个上传文件的代码，并使用 html5 分块来切片文件。目前，进度条适用于每个文件块，我应该怎么做才能使它只有一个进度条，但要响应所有块。例如示例代码和图片：每个进度条对应一个文件块（1MB），但如何将这些进度条组合成只有 1 个条但仍然是正确的百分比等

![在此处输入图像描述](../Images/88e6043b0ffe6c9a94329b237521bd4f.png)

```
 var uploaders = [];
        var totalChunks = 0;
        var i = 0;
        $(document).ready(function() {
            var progress = document.querySelector('progress');
            var bars = document.querySelector('#bars'); 
        });        

        //function for after the button is clicked, slice the file 
        //and call upload function
        function sendRequest() {       
            //clean the screen
            //bars.innerHTML = '';
            var blob = document.getElementById('fileToUpload').files[0];
            var originalFileName = blob.name;
            const BYTES_PER_CHUNK = 1 * 1024 * 1024; // 10MB chunk sizes.
            const SIZE = blob.size;

            var start = 0;
            var end = BYTES_PER_CHUNK;
            totalChunks = Math.ceil(SIZE / BYTES_PER_CHUNK);

            while( start < SIZE ) {                    
                if (blob.webkitSlice) {
                  var chunk = blob.webkitSlice(start, end);
                } else if (blob.mozSlice) {
                  var chunk = blob.mozSlice(start, end);
                }       

                uploadFile(chunk, originalFileName, totalChunks);
                start = end;
                end = start + BYTES_PER_CHUNK;
            }
        }

        function uploadFile(blobFile, fileName, totalChunks) {
            var progress = document.createElement('progress');
            progress.min = 0;
            progress.max = 100;
            progress.value = 0;
            bars.appendChild(progress);   

            var fd = new FormData();
            fd.append("fileToUpload", blobFile);

            var xhr = new XMLHttpRequest();                
            xhr.open("POST", "upload.php"+"?"+"file="+fileName + i, true);
            i++;

            xhr.onload = function(e) {
                //make sure if finish progress bar at 100%
                progress.value = 100;

                //counter if everything is done using stack
                uploaders.pop();

                if (!uploaders.length) {
                    bars.appendChild(document.createElement('br'));
                    bars.appendChild(document.createTextNode('DONE :)'));
                    mergeFile(fileName, totalChunks);
                }                  
            };

            // Listen to the upload progress for each upload.   
            xhr.upload.onprogress = function(e) {;
                if (e.lengthComputable) {
                    progress.value = (e.loaded / e.total) * 100;
                }
            };                 

            uploaders.push(xhr);
            xhr.send(fd);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T13:23:07.993

您必须保留一个全局变量来保存迄今为止上传的总字节数，并在进度处理程序中更新它。

```
var totalLoaded = 0 
```

内部`uploadFile()`：

```
var chunkLoaded = 0;
....
function(e) {
  var prevLoaded = chunkLoaded;

  if (e.lengthComputable) {
    // use e.loaded and e.total as a percentage of bytes per chunk
    // upload request contains more bytes than the actual chunk
    chunkLoaded = Math.ceil(e.loaded / e.total * BYTES_PER_CHUNK);
    totalLoaded = totalLoaded - prevLoaded + chunkLoaded;
    // update progress bar here
  }
} 
```

顺便说一句，您是同时上传 20 个块吗？这通常不是很健康，并且容易断开连接（`totalLoaded`如果您希望重试该块，您还必须更新连接）。

最好将并发上传者的数量限制为 2/3。

# java - 清理 URL 以删除个人信息

> ID：10624173
> 
> 赞同：0
> 
> 时间：2012-05-16T18:07:19.023
> 
> 标签：java, url, sanitization, pii

是否有从 URL 中识别和删除任何 PII 信息的规则？我希望这是通用的，可以处理我们可能在互联网上遇到的各种 url。

澄清：我有一个浏览互联网的人的 url 列表，并希望从中删除 PII。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:15:38.197

要回答您在回复 snemarch 时重申的问题：

> 是的，我明白这一点。我的意思是我需要记住哪些注意事项来识别 url 中的 PII？PII 可能出现在 URL 中的各种方式是什么？

HTTP GET 信息可以通过多种不同的方式传输。有些，可能是大多数，看起来像这样：

> example.com/form.php?key=value。

其他网站，包括 stackoverflow，可能会使用 URL 重写将链接“example.com/form/value”转换为等效的：“example.com/form.php?key=value”。这种 URL 重写完全依赖于服务器的配置，并且没有简单的方法来检测和剥离以这种方式呈现的 PII。

考虑到这一点，实际上没有办法 100% 从不同 url 列表中删除所有 PII，因为从没有任何 PII 的 URL 中可能无法识别此类信息。至少，您可以删除绝对是 PII 的信息，例如“example.com/form.php?key=value”形式的 URL。我敢打赌，任何带有“=”的 URL 中都有某种变量，应该被过滤掉。除此之外，您将不得不手动解析大部分列表。

根据列表的大小以及您对过滤它的认真程度，您可以研究流行产品的流行 mod_rewrite 方法并尝试在您的列表中匹配它们，抓取 URL 以确定有关 URL 的其他信息，并执行一些复杂且可能的操作丑陋的算法试图猜测 URL 中的变量可能是什么 - 可能考虑到用户访问过的类似 URL 并比较 URL 的标记。给定标记中文本略有不同的相似 url 可能是变量，应该被过滤。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:09:17.617

您绝不应该通过 GET 从 URL 传递任何用户敏感信息。如果您改用 POST，则只需确保连接是 HTTPS。

# oauth - Google 联合登录（OpenID + OAuth 2）

> ID：10624175
> 
> 赞同：4
> 
> 时间：2012-05-16T18:07:19.790
> 
> 标签：oauth, openid, google-api, oauth-2.0

我正在尝试让 OpenID 与 OAuth 2 一起使用以使用 Google 的 API。我只希望用户在第一次登录时必须“授予访问权限”一次。这是我到目前为止的流程：

1.  用户点击“使用 Google 登录”
2.  我的服务器使用 OpenID 登录用户。通过联合登录，我会收到一个 OAuth 请求令牌。

从[https://developers.google.com/accounts/docs/OpenID#oauth](https://developers.google.com/accounts/docs/OpenID#oauth)它说下一步是将请求令牌交换为访问令牌。但是，我看到了一些问题：

1.  这是一个 OAuth 1 API 调用。
2.  它需要一个验证器。我不需要用户“授予访问权限”来接收验证者吗？这是如何联合的？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T18:26:22.923

您应该使用基于 OAuth 2.0 的身份验证： [https ://developers.google.com/accounts/docs/OAuth2Login](https://developers.google.com/accounts/docs/OAuth2Login)

这也称为 OpenID Connect。

这将使用授权代码重定向到您的站点。然后，您将其交换为访问令牌。您可以通过使用简单的 REST 请求调用 TokenInfo 端点来[验证](https://developers.google.com/accounts/docs/OAuth2Login#validatingtoken)访问令牌。这将为您提供一个简单的用户 ID 标识符。

之后，您拨打电话以获取详细的[个人资料信息](https://developers.google.com/accounts/docs/OAuth2Login#userinfocall)，例如姓名+电子邮件等。

您可以通过这个出色的演示了解更多关于它如何工作的信息：http: [//oauthssodemo.appspot.com/](http://oauthssodemo.appspot.com/)

# javascript - 从 Firefox 中的父框架在 iFrame 中打印 PDF

> ID：10624183
> 
> 赞同：3
> 
> 时间：2012-05-16T18:07:39.227
> 
> 标签：javascript, jquery, iframe, printing

因此，我有一个包含 iFrame 的主文档，其中是一个 PDF 文件，其中包含一个条形码（由 iTextSharp 创建，尺寸适合 Dymo 标签打印机）。

HTML 看起来像：

```
<html>
    <body>
       <div class="content">
           <iframe src="/pdfs/label.pdf" NAME="loyaltyBadge" ID="loyaltyBadge"></iframe>
               <br/>
           <button id="printPdf">Print</button>
       </div>
    </body>
</html> 
```

使用 jQuery 或标准 JS，如何使按钮触发 PDF 框架上的打印对话框？

这个：

```
$('#printPdf').click(function () {
    document.loyaltyBadge.print();
}); 
```

似乎可以在 Chrome 中工作，但不是 FF 我收到错误的地方`document.loyaltyBadge is undefined`

我试过谷歌搜索，但大多数结果都是人们给出的建议 iFrame 中的文档是 HTML 的位置，因此我们可以将打印控件放在 iFrame 本身中，当然在这种情况下我不能这样做。

iFrame 很小，因此嵌入式 Adob​​e Reader 的本机打印控件没有用。

# c# - rangevalidator 拒绝错误的值并使我的提交按钮无响应

> ID：10624185
> 
> 赞同：1
> 
> 时间：2012-05-16T18:07:48.490
> 
> 标签：c#, asp.net, visual-studio-2010

我有一个带有范围验证器的表单：

```
<label class="required" for="price">price</label>
<input runat="server" id="price" name="price" type="text"  required="required"/>
<asp:RangeValidator runat="server" ControlToValidate="price" ErrorMessage="Must be between 0 and 15,000" MinimumValue="0" MaximumValue="15000"></asp:RangeValidator> 
```

但它拒绝诸如“22”和“5”之类的值，但接受值“0”和“15,000”。最重要的是，它使我的表单的提交按钮对所有输入都没有响应。为什么范围验证器不起作用？

编辑：这是表单按钮

以及当我拥有 rangevalidator 时似乎没有触发的提交功能。如果我删除 rangevalidator，此代码将执行：

```
protected void btnSubmit_Click(object sender, EventArgs e)
        {

                formInputs.Visible = false;
                emailNotification.Visible = true;

                MailMessage mail = new MailMessage();
                mail.To.Add(emailField.Value);
                mail.From = new MailAddress("no-reply@gmail.com");
                mail.IsBodyHtml = true;
                mail.Subject = "Your Form has been submitted";
                mail.Body += "Location: ";
                mail.Body += location.SelectedValue + "<br>";
                mail.Body += " address: ";
                mail.Body += address.Value + "<br>";

                mail.Body += "price: " + price.Value + "<br>";
                mail.Body += "Date submitted: " + todaysDate.Value + "<br>";
                if (FileUploadControl.HasFile)
                {

                    string filename = Path.GetFileName(FileUploadControl.FileName);
                    FileUploadControl.SaveAs(Server.MapPath("~/") + filename);

                    mail.Attachments.Add(new Attachment(HttpContext.Current.Request.MapPath(filename)));
                }
                SmtpClient smtp = new SmtpClient(System.Configuration.ConfigurationManager.AppSettings["mailsetting"]);
                smtp.Send(mail);   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:11:05.963

在验证器中给出 Type="Integer"，因为您没有给出类型。它可能将类型作为字符串，这就是它没有按预期进行验证的原因。

您拥有的验证器将像这样修改

```
<asp:RangeValidator runat="server" Type="Integer" ControlToValidate="price" ErrorMessage="Must be between 0 and 15,000" MinimumValue="0" MaximumValue="15000"></asp:RangeValidator> 
```

# android - 为什么与 Gmail 服务器的连接将我的邮件情况从“未读”更改为“已读”？

> ID：10624188
> 
> 赞同：0
> 
> 时间：2012-05-16T18:07:56.473
> 
> 标签：android, gmail, jakarta-mail

我可以从 Gmail 服务器接收邮件并在我的 Android 项目的列表视图上显示主题。昨天，我开始将邮件的图像视图更改为“未读”或“已读”情况。但是，后来我意识到，当我的应用程序连接到 Gmail 服务器并接收我的邮件时，RECENT 邮件变成了 SEEN 邮件。由于这个原因，我无法为未读邮件设置我的图像视图。

我是说; 我想从 Gmail 服务器接收我的邮件，而不改变他们在 Gmail 服务器上的情况。我想在服务器中收到 3 个未读和 4 个已读。

我应该怎么做？

我的连接代码示例是：

```
public Message[] ConnectionToServer(String email, String password)
            throws Exception 
        {
        Properties props = System.getProperties();
        props.setProperty("mail.imaps.partialfetch", "false");
        URLName server = new URLName("imaps://" + email + ":" + password + "@imap.gmail.com/INBOX");
        Session session = Session.getDefaultInstance(props, null);
        folder = session.getFolder(server);

        if (folder == null) 
        {
            System.exit(0);
        }
        folder.open(Folder.READ_WRITE);     
        messages = folder.getMessages();

        for (int i = messages.length - 1; i >= 23; i--) 
        {
            Part p = messages[i]; 

            subject = messages[i].getSubject();

                     if (messages[i].isSet(Flags.Flag.RECENT)) {
            isSet = true;
            System.out.println("Recent");
            isSetlist.add(String.valueOf(isSet));
        }
        if (messages[i].isSet(Flags.Flag.SEEN)) 
        {
            isSet = false;
            System.out.println("Read");
            isSetlist.add(String.valueOf(isSet));
        }
        else
        {
            isSet = true;
            System.out.println("Recent");
            isSetlist.add(String.valueOf(isSet));
        }

                        body = getText(p);

            list.add(body);
        }
        return (Message[]) messages;
    } 
```

我在 getText() 方法中使用 getContent

```
public String getText(Part p) throws MessagingException, IOException {

        if (p.isMimeType("text/*")) {
            boolean textIsHtml = false;
            String s = (String) p.getContent();

            textIsHtml = p.isMimeType("text/html");
            return String.valueOf(s);
        }

        if (p.isMimeType("multipart/alternative")) {
            // prefer html text over plain text
            Multipart mp = (Multipart) p.getContent();
            String text = null;
            for (int i = 0; i < mp.getCount(); i++) {
                Part bp = mp.getBodyPart(i);
                if (bp.isMimeType("text/plain")) {
                    if (text == null)
                        text = getText(bp);
                    continue;
                } else if (bp.isMimeType("text/html")) {
                    String s = getText(bp);
                    if (s != null)
                        return String.valueOf(s);
                } else {
                    return getText(bp);
                }
            }
            return text;
        } else if (p.isMimeType("multipart/*")) {
            Multipart mp = (Multipart) p.getContent();
            for (int i = 0; i < mp.getCount(); i++) {
                String s = getText(mp.getBodyPart(i));
                if (s != null)
                    return String.valueOf(s);
            }
        }

        return null;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:41:00.697

如果您不需要进行任何修改，请尝试以 READONLY 模式打开文件夹 - 或者，尝试在调用之间保留`Message` [标志。](http://docs.oracle.com/javaee/1.4/api/javax/mail/Flags.Flag.html#SEEN)`getContent`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:38:06.487

在访问内容之前访问消息标志（以确定消息是否可见）。访问内容通常会设置 SEEN 标志。

# javascript - Ajax 和返回数据限制 (jquery)

> ID：10624191
> 
> 赞同：0
> 
> 时间：2012-05-16T18:08:02.337
> 
> 标签：javascript, jquery, ajax, image, file

1.  我正在使用 jquery 对 3 种类型的文件 html/javascript 和 img 文件进行 ajax 调用：

    ```
    $.ajax({
        url: url,
        type: "POST",
        dataType: "text",
        async: true,
        success: function(data) {
            data = data.replace('<', '&lt;');
            data = data.replace('>', '&gt;');
            $('#file_content').html('<pre>' + data + '</pre>');    
        },
        error: function(a,b,c){
            alert("There has been an error! Try again...");
        } 
    }); 
    ```

    *   html文件是这样的：

        ```
        <link href = "{get_url}style.css" rel = "stylesheet" type = "text/css" />
        <script language = "javascript">
            var get_url = '{get_url}';
        </script>   
        <script src = "{get_url}functions.js" language = "javascript"></script>

        <div id="screen">
            <div id="floor"></div>
            <div id="ceiling"></div>
        </div>
        <div id="minimapcontainer">
            <canvas id="minimap"></canvas>
            <canvas id="minimapobjects"></canvas>
        </div> 
        ```

    返回的数据是这样的：

    ```
    <link href = "{get_url}style.css" rel = "stylesheet" type = "text/css" /> 
    ```

    其余的似乎以 html 运行，即使我正在替换小于和大于符号...真的我需要它来返回未处理为 html 的内容。我该怎么做呢？**-已解决，谢谢**

2.  现在转到有关从图像 url 检索图像以及为什么 javascript 文件返回数据的截断版本的其他问题：

    *   js 文件的长度为 8956 个字符，并且似乎在 8343 处将其剪掉......为什么会这样做？
    *   图像文件（打开图像的直接 url）作为二进制数据（我猜）而不是图像返回......返回结果的字符长度为 18615。我如何返回图像而不是数据构成图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:25:08.397

你的代码对我有用：http: [//jsfiddle.net/tsrfq/](http://jsfiddle.net/tsrfq/)

但是，它只是替换第一次出现的“<”和“>”，请尝试使用全局正则表达式。

```
data = data.replace(/</g, '&lt;');
data = data.replace(/>/g, '&gt;'); 
```

[http://jsfiddle.net/tsrfq/1/](http://jsfiddle.net/tsrfq/1/)

# entity-framework - 如何使用实体框架 5.0？

> ID：10624194
> 
> 赞同：1
> 
> 时间：2012-05-16T18:08:15.473
> 
> 标签：entity-framework, entity-framework-4

安装 EF 5.0 后，它说：

成功安装“EntityFramework 5.0.0-rc”。成功将“EntityFramework 5.0.0-rc”添加到 MyWeb。

但我的解决方案有很多项目，不仅仅是网络项目。例如，我有一个 MyyWeb 引用的项目 MyData。如何在 MyData 项目中使用使用 EF 5.0？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:22:39.140

将包安装到需要它的每个项目中。您可以通过右键单击每个项目并选择管理包，或使用包管理器控制台内的默认项目下拉菜单来执行此操作。

# xcode - 如何将 gif 图像添加到 iOS 应用程序图标中？

> ID：10624196
> 
> 赞同：0
> 
> 时间：2012-05-16T18:08:24.280
> 
> 标签：xcode, ios4, ios5

我在 Xcode 4.3.2 中看到的是能够仅添加 .png 图像作为应用程序图标。是否可以将 .gif 图像添加为应用程序图标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:11:38.070

从文档中引用：

> 文件名可以是您想要的任何名称，但所有图像文件必须为 PNG 格式并位于应用程序包的顶层

[人机界面指南](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/IconsImages/IconsImages.html)

# maven - 基础设施 - Maven + Nexus

> ID：10624198
> 
> 赞同：0
> 
> 时间：2012-05-16T18:08:32.217
> 
> 标签：maven, active-directory, nexus

我已经安装了一个 sonatype nexus 作为我的 maven repo。nexus 安装正在使用 Active Directory 对用户进行身份验证，并且匿名登录已关闭。

将工件上传到我的仓库的每个用户都必须使用唯一的用户名进行标识，因此 AD 集成。

使用此结构的常规方法是在`POM.xml`Distribution Managemente 标记中设置，以便将工件发送到 nexus

```
 <distributionManagement>
    ...
    <repository>
      <id>deploymentRepo</id>
      <name>Internal Releases</name>
      <url>http://nexusserver:8081/nexus/content/repositories/releases</url>
    </repository>
    ...
  </distributionManagement> 
```

在本地 repo 设置 ( `~/.m2/settings.xml`) 中添加用户名/密码组合以登录到 nexus

```
<server>
  <id>deploymentRepo</id>
  <username>deployment</username>
  <password>deployment123</password>
 </server> 
```

它对我来说非常有用，但我想要实现的是以某种方式在 nexus 中进行身份验证，而无需将用户密码放入本地存储库中。是否可以？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:26:34.840

您要达到什么目的：不要将密码存储为纯文本或用户每次运行 maven deploy 命令时都必须传递密码？

密码可以以加密形式存储，如此[处所述](http://maven.apache.org/guides/mini/guide-encryption.html)

或者您可以尝试在命令行上传递密码，如下所示，但我没有尝试过：

```
mnv -Dpassword=deployment123 deploy 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T11:24:43.500

Nexus 2.1 将于 6 月发布，我们构建了一项新功能来支持安全身份验证，而无需在 settings.xml 中提供明文密码。

# java - 需要帮助控制我的电脑的主输出扬声器

> ID：10624202
> 
> 赞同：5
> 
> 时间：2012-05-16T18:08:43.903
> 
> 标签：java, javasound, audio

目前我正在尝试使用`JSlider`in `Java`来控制我的 PC 的主音量。到目前为止，我已经能够找到我的 PC 的主扬声器端口。但是，我不知道如何成功调用它并运行 getValue() 或 setValue() 之类的方法。

我使用以下代码在我的电脑中搜索所有音频设备：

```
Mixer.Info [] mixers = AudioSystem.getMixerInfo();  
    System.out.println("There are " + mixers.length + " mixer info objects");  
    for (Mixer.Info mixerInfo : mixers)  
    {  
        System.out.println("mixer name: " + mixerInfo.getName());  
        Mixer mixer = AudioSystem.getMixer(mixerInfo);  
        Line.Info [] lineInfos = mixer.getTargetLineInfo(); // target, not source  
        for (Line.Info lineInfo : lineInfos)  
        {  
            System.out.println("  Line.Info: " + lineInfo);  
            Line line = null;  
            boolean opened = true;  
            try  
            {  
                line = mixer.getLine(lineInfo);  
                opened = line.isOpen() || line instanceof Clip;  
                if (!opened)  
                {  
                    line.open();  
                }  
                FloatControl volCtrl = (FloatControl)line.getControl(FloatControl.Type.VOLUME);  
                System.out.println("    volCtrl.getValue() = " + volCtrl.getValue());  
            }  
            catch (LineUnavailableException e)  
            {  
                e.printStackTrace();  
        }  
            catch (IllegalArgumentException iaEx)  
            {  
                System.out.println("    " + iaEx);  
            }  
            finally  
            {  
                if (line != null && !opened)  
                {  
                    line.close();  
                }  
            }  
        }  
    } 
```

如何控制我的扬声器线路并更改值？

到目前为止， 我已经使用[这个网站寻求帮助。](http://www.coderanch.com/t/492931/java/java/Adjusting-master-volume-Windows-XP)

* * *

**更新**

好的，所以我想我已经接近了一点。在我的测试 GUI 程序下，我正在尝试使用“获取具有所需控件的行”（您给我的链接）下的 Java 教程代码。我将它粘贴到我的 JSlider 的 Change Listener 下的程序中。

这是它的样子：

```
Port SPEAKER;
        FloatControl volCtrl;
        try {
          Mixer mixer = AudioSystem.getMixer(null);
          SPEAKER = (Port)mixer.getLine(Port.Info.SPEAKER);
          SPEAKER.open();
          volCtrl = (FloatControl) SPEAKER.getControl(

            FloatControl.Type.VOLUME);

        } catch (Exception e) {
        System.out.println("Failed trying to find LINE_IN"
            + " VOLUME control: exception = " + e);
        } 
```

每当我移动滑块时，它都会打印出错误异常消息“尝试查找失败...”。为什么它不能让我在主输出扬声器上获得 volCtrl？如何修复此代码以控制我的 SPEAKER？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T19:19:52.847

在 JavaRanch 找到很棒的发现！我在那里得到了很多宝贵的帮助。

找到行后，本教程将展示如何制作控件：[http ://docs.oracle.com/javase/tutorial/sound/controls.html](http://docs.oracle.com/javase/tutorial/sound/controls.html)

但有时高值和低值是出乎意料的。我发现了一条范围从 -80 到 +6 的线（它被设置为模仿 VU 计的分贝范围）。因此，您可能必须对 JSlider 输出进行一些数值转换，以获得合理匹配的 Control 值，尤其是在 Control 是指数的情况下。

# iphone - 更改视图替代

> ID：10624215
> 
> 赞同：0
> 
> 时间：2012-05-16T18:09:23.610
> 
> 标签：iphone, ios, xcode, cocoa-touch, uiviewcontroller

我有一个带有一些 ViewController 的基于窗口的应用程序。

我使用以下方法从一种视图切换到另一种视图：

```
[self.view addSubview:newViewController.view]; 
```

一切正常，但我有一个问题：

当我将视图更改为具有超过 320x480 帧的滚动视图时，我无法返回到以前的帧。我的意思是我通常会进一步更改视图，但我有一个更大的帧，并且我从 scrollView 中看到了其余内容当前视图未涵盖。

有什么方法可以将超级视图大小设置回 320x480？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:22:30.223

您可以通过执行以下操作手动将视图的框架设置回 320X480：

```
yourView.frame = CGRectMake(0,0,320,480); 
```

当您切换回来时，您是否也从超级视图中删除了滚动视图？[scrollview removeFromSuperView]; ?

# facebook - 无法以链接 404 的形式访问 Facebook 的 Open Graph 设置

> ID：10624221
> 
> 赞同：1
> 
> 时间：2012-05-16T18:09:44.310
> 
> 标签：facebook, facebook-opengraph, facebook-apps, social-media

我有一个 facebook 应用程序，我用它来验证网站上的人，以及发布到流媒体。我有兴趣使用打开的图表来设置我自己的对象，但是当我编辑我的应用程序的设置并单击“打开图表”时，我收到 404“找不到您请求的页面”。

我尝试创建一个新应用程序，看看我是否搞砸了设置，但该应用程序上的打开图形链接也出错了。

我正在尝试逐步按照[https://developers.facebook.com/docs/opengraph/tutorial/](https://developers.facebook.com/docs/opengraph/tutorial/)上的步骤进行操作， 但由于链接不起作用，因此无法继续执行第 3 步。

我在这里缺少什么，我如何能够在我的应用程序上编辑打开的图表设置？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:15:57.210

是的，该链接应该可以工作。请打开一个错误：[https ://developers.facebook.com/bugs/](https://developers.facebook.com/bugs/)

# java - 使用 java 使用 Calendar 类比较日期

> ID：10624229
> 
> 赞同：3
> 
> 时间：2012-05-16T18:10:07.670
> 
> 标签：java

用户输入的日期分别使用日、月和年的下拉菜单。我必须将用户输入的日期与今天的日期进行比较，并检查它是同一天还是未来一天。我对时间部分有点困惑，因为我对时间不感兴趣，只对日期感兴趣。如何在不使用 Date 类的情况下解决这个问题（我读过不建议使用 Date 类）。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-16T18:14:56.523

您首先需要创建`GregorianCalendar`代表输入日期的实例：

```
Calendar user = new GregorianCalendar(2012, Calendar.MAY, 17); 
```

还有一个“现在”：

```
Calendar now = new GregorianCalendar(); 
```

如果日期在未来，这将产生正值，如果在过去，则为负值：

```
user.compareTo(now); 
```

关于构造`user`对象的几点注意事项：

*   它使用当前的 JVM 时区，所以在我的情况下，它是 CEST 时区的 5 月 17 日午夜
*   小心月份，它们是从 0 开始的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-21T16:37:50.883

尝试库 Apache Commons Lang 的类 DateUtils。

此类提供方法 truncatedEquals(cal1, cal2, field)。

因此，您可以使用一行代码检查是否相等：

```
Calendar user = new GregorianCalendar(2012, Calendar.MAY, 17);
Calendar now = Calendar.getInstance();

if(DateUtils.truncatedEquals(user, now, Calendar.DATE)){
    // your code goes here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-08T16:15:18.027

简单计算：

```
GregorianCalendar gc1 = new GregorianCalendar();
GregorianCalendar gc2 = new GregorianCalendar();
gc2.add(GregorianCalendar.DAY_OF_MONTH, 2); // gc2 is 2 days after gc1
long duration = (gc2.getTimeInMillis() - gc1.getTimeInMillis() )
                         / ( 1000 * 60 * 60 * 24) ;
System.out.println(duration); 
```

-> 2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T18:17:53.300

试试这个解决方案：

```
 int day = 0; //user provided
    int month = 0; //user provided
    int year = 0; //user provided
    Calendar calendar = Calendar.getInstance();
    calendar.set(Calendar.YEAR, year);
    calendar.set(Calendar.MONDAY, month);
    calendar.set(Calendar.DAY_OF_MONTH, day);
    long millisUser = calendar.getTime().getTime();
    long nowMillis = System.currentTimeMillis();
    if(nowMillis < millisUser) {
        ...
    } 
```

以上是检查日期是否在将来。

使用没有错`java.util.Date` 你可以使用：

```
 int day = 0; //user provided
    int month = 0; //user provided
    int year = 0; //user provided
    Calendar calendar = Calendar.getInstance();
    calendar.set(Calendar.YEAR, year);
    calendar.set(Calendar.MONDAY, month);
    calendar.set(Calendar.DAY_OF_MONTH, day);
    Date userSubmit = calendar.getTime();
    Date now = new Date();
    if(userSubmit.after(now)) {
        ...
    } 
```

但是如果你想要流畅、简单和直观的 API 日期，我建议使用[JodaTime](http://joda-time.sourceforge.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T18:21:14.217

使用公历。如果您想知道两个日期之间的天数差异，那么您可以使用类似于以下的方法。

```
 public int getDays(GregorianCalendar g1, GregorianCalendar g2) {
  int elapsed = 0;
  GregorianCalendar gc1, gc2;
  if (g2.after(g1)) {
     gc2 = (GregorianCalendar) g2.clone();
     gc1 = (GregorianCalendar) g1.clone();
  }
  else   {
     gc2 = (GregorianCalendar) g1.clone();
     gc1 = (GregorianCalendar) g2.clone();
  }
  gc1.clear(Calendar.MILLISECOND);
  gc1.clear(Calendar.SECOND);
  gc1.clear(Calendar.MINUTE);
  gc1.clear(Calendar.HOUR_OF_DAY);
  gc2.clear(Calendar.MILLISECOND);
  gc2.clear(Calendar.SECOND);
  gc2.clear(Calendar.MINUTE);
  gc2.clear(Calendar.HOUR_OF_DAY);
  while ( gc1.before(gc2) ) {
     gc1.add(Calendar.DATE, 1);
     elapsed++;
  }
  return elapsed; 
```

}

这将返回您的天数差异。

# java - String.intern() 的性能损失

> ID：10624232
> 
> 赞同：43
> 
> 时间：2012-05-16T18:10:20.503
> 
> 标签：java, string, performance

很多人都在谈论 String.intern() 的性能优势，但实际上我更感兴趣的是性能损失可能是什么。

我主要担心的是：

*   *搜索成本*：intern() 确定可迭代字符串是否存在于常量池中的时间。该成本如何与该池中的字符串数量成比例？
*   *同步*：显然常量池是由整个 JVM 共享的。当从多个线程一遍又一遍地调用 intern() 时，该池的行为如何？它执行多少锁定？性能如何随争用扩展？

我担心所有这些事情，因为我目前正在开发一个财务应用程序，该应用程序由于重复的字符串而存在使用过多内存的问题。一些字符串基本上看起来像枚举值，并且只能具有有限数量的潜在值（例如货币名称（“USD”，“EUR”）），存在超过一百万份。在这种情况下，String.intern() 似乎很容易，但我担心每次在某处存储货币时调用 intern() 的同步开销。

最重要的是，一些其他类型的字符串可以有数百万个不同的值，但仍然有数万个副本（例如 ISIN 代码）。对于这些，我担心实习一百万个字符串基本上会减慢 intern() 方法的速度，以至于让我的应用程序陷入困境。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-17T01:19:36.767

我自己做了一些基准测试。对于搜索成本部分，我决定将 String.intern() 与 ConcurrentHashMap.putIfAbsent(s,s) 进行比较。基本上，这两个方法做同样的事情，除了 String.intern() 是一个本地方法，它存储和读取直接在 JVM 中管理的 SymbolTable，而 ConcurrentHashMap.putIfAbsent() 只是一个普通的实例方法。

[您可以在github gist](https://gist.github.com/2715360)上找到基准代码（因为没有更好的放置位置）。您还可以在源文件顶部的注释中找到我在启动 JVM 时使用的选项（以验证基准没有倾斜）。

无论如何，这是结果：

## 搜索成本（单线程）

**传奇**

*   *count*：我们试图汇集的不同字符串的数量
*   *初始实习生*：在字符串池中插入所有字符串所需的时间（以毫秒为单位）
*   *查找相同的字符串*：使用与先前在池中输入的完全相同的实例从池中再次查找每个字符串所需的时间（以毫秒为单位）
*   *查找相等字符串*：从池中再次查找每个字符串所需的时间（以毫秒为单位），但使用不同的实例

**String.intern()**

```
count       initial intern   lookup same string  lookup equal string
1'000'000            40206                34698                35000
  400'000             5198                 4481                 4477
  200'000              955                  828                  803
  100'000              234                  215                  220
   80'000              110                   94                   99
   40'000               52                   30                   32
   20'000               20                   10                   13
   10'000                7                    5                    7 
```

**ConcurrentHashMap.putIfAbsent()**

```
count       initial intern   lookup same string  lookup equal string
1'000'000              411                  246                  309
  800'000              352                  194                  229
  400'000              162                   95                  114
  200'000               78                   50                   55
  100'000               41                   28                   28
   80'000               31                   23                   22
   40'000               20                   14                   16
   20'000               12                    6                    7
   10'000                9                    5                    3 
```

搜索成本的结论：String.intern() 调用起来非常昂贵。它的扩展性非常糟糕，在 O(n) 中，其中 n 是池中的字符串数。当池中的字符串数量增加时，从池中查找一个字符串的时间会增加很多（对于 10'000 个字符串，每次查找 0.7 微秒，对于 1'000'000 个字符串，每次查找需要 40 微秒）。

ConcurrentHashMap 按预期缩放，池中的字符串数量对查找速度没有影响。

基于这个实验，我强烈建议避免使用 String.intern() 如果你要实习的字符串不止几个。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-08-25T08:10:31.260

我最近写了一篇关于 Java 6、7 和 8 中 String.intern() 实现的文章：Java 6、7 和 8 [中的 String.intern - 字符串池](http://java-performance.info/string-intern-in-java-6-7-8/)。

有一个 -XX:StringTableSize JVM 参数，它允许您使 String.intern 在 Java7+ 中非常有用。所以，不幸的是，我不得不说这个问题目前正在给读者提供误导性信息。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-16T18:16:30.633

我发现使用 fastutil 哈希表并自己进行实习比重用`String.intern()`. 使用我自己的哈希表意味着我可以自己决定并发性，而且我不会竞争 PermGen 空间。

我这样做是因为我正在处理一个问题，它实际上有数百万个字符串，许多相同，我想 (a) 减少占用空间并 (b) 允许按身份进行比较。对于我的问题，使用我的*不*`String.intern()`方法，实习比没有实习要好。

YMMV。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-27T12:53:00.827

String.intern 变慢是因为两个原因：
1\. -XX:StringTableSize 的限制。
在java中，它使用内部哈希表来管理字符串缓存，在java 6中，默认StringTableSize值为1009，这意味着string.intern是O（字符串对象的数量/ 1009），当越来越多的字符串对象被创建时，它变得越来越慢。

> \openjdk7\hotspot\src\share\vm\classfile\symbolTable.cpp

```
oop StringTable::intern(Handle string_or_null, jchar* name,  
                        int len, TRAPS) {  
  unsigned int hashValue = java_lang_String::hash_string(name, len);  
  int index = the_table()->hash_to_index(hashValue);  
  oop string = the_table()->lookup(index, name, len, hashValue);  
  // Found  
  if (string != NULL) return string;  
  // Otherwise, add to symbol to table  
  return the_table()->basic_add(index, string_or_null, name, len,  
                                hashValue, CHECK_NULL);  
} 
```

2.在java 6中，字符串缓存池在perm区，而不是在堆中，大多数时候，我们配置perm size比较小。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-19T11:34:07.813

以下微基准建议使用枚举提供大约十倍的性能改进（通常的微基准警告适用）测试代码如下：

```
public class Test {
   private enum E {
      E1;
      private static final Map<String, E> named = new HashMap<String, E>();
      static {
         for (E e : E.values()) {
            named.put( e.name(), e );
         }
      }

      private static E get(String s) {
         return named.get( s );
      }
   }

   public static void main(String... strings) {
      E e = E.get( "E1" ); // ensure map is initialised

      long start = System.nanoTime();
      testMap( 10000000 );
      long end = System.nanoTime();

      System.out.println( 1E-9 * (end - start) );
   }

   private static void testIntern(int num) {
      for (int i = 0; i < num; i++) {
         String s = "E1".intern();
      }
   }

   private static void testMap(int num) {
      for (int i = 0; i < num; i++) {
         E e = E.get( "E1" );
      }
   }
} 
```

结果（1000 万次迭代）： testIntern() - 0.8 秒 testMap() - 0.06 秒

当然是 YMMV，但枚举比字符串提供了这么多好处……相对于其他随机字符串的类型安全性、添加方法等的能力似乎是最好的方式去恕我直言

# java - Android HTTP 身份验证错误

> ID：10624243
> 
> 赞同：0
> 
> 时间：2012-05-16T18:11:10.920
> 
> 标签：java, android, http, http-authentication

```
final HttpClient hClient = new DefaultHttpClient();
final HttpPost hPost = new HttpPost(
        "http://xxx.xxx");
try {
    hPost.setHeader("Accept", "application/json");
    hPost.setHeader("Content-type",
            "application/json");
    hPost.setEntity(new StringEntity(JSON));
    // execute request
    final HttpResponse response = hClient
            .execute(hPost);
    final HttpEntity entity = response.getEntity(); 
```

Android 返回 05-16 20:02:52.784: W/DefaultRequestDirector(15642): Authentication error: Unable to respond to any of these challenge: {} 我不知道如何解决它。问题出在哪里，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:20:02.713

我也有这个警告，但它没有引起任何特殊问题，请求仍然正常。

但是，当我开始使用`AndroidHttpClient`而不是`DefaultHttpClient`. 一件不舒服的事情是你不能`AndroidHttpClient`从 UI 线程中使用它并且需要在另一个线程上运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:30:15.143

尝试如下设置 Http 参数：

```
HttpParams myParams = new BasicHttpParams();

HttpConnectionParams.setSoTimeout(myParams, 10000);
HttpConnectionParams.setConnectionTimeout(myParams, 10000); // Timeout

DefaultHttpClient httpClient = new DefaultHttpClient(myParams); 
```

对于 http 帖子和响应，您可以尝试以下代码。请根据您的需要自定义（例如设置您的字符串参数）

```
HttpResponse response;
httpClient.getParams().setParameter("Your String", "YourStringValue");
localContext = new BasicHttpContext();
HttpPost httpPost = new HttpPost(YOurURL);

Log.e("URL", URL); //just to check 

httpClient.getParams().setParameter(ClientPNames.COOKIE_POLICY,CookiePolicy.RFC_2109);

StringEntity tmp = null;

httpPost.setHeader("Accept", "application/json");

tmp = new StringEntity(inputJObject.toString(), "UTF-8");

httpPost.setEntity(tmp);

response = httpClient.execute(httpPost, localContext);

Log.i(TAG, response.getStatusLine().toString()); // Examine the response status

HttpEntity entity = response.getEntity();  // Get hold of the response entity 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T17:07:46.630

我得到了这个错误并通过回到基础来解决它！[该错误是从对https://www.googleapis.com/oauth2/v1/userinfo](https://www.googleapis.com/oauth2/v1/userinfo)的请求生成的。解决办法贴在下面：

```
 URLConnection conn = (HttpURLConnection) url.openConnection();
            conn.addRequestProperty("key", API_KEY);
    conn.addRequestProperty("client_id", CLIENT_ID);
    conn.addRequestProperty("client_secret", "");
    conn.setRequestProperty("Authorization", "OAuth " + token); 
```

所有添加请求都是 HTTPGET 键/值，并且 setProperty 添加了一个标头参数。由于 Google API 控制台在其当前版本中没有提供客户端密码，我添加了一个 balnk 字符串..这最终解决了 AuthToken 到用户数据的问题:)

# ruby-on-rails - Ruby on Rails - 如何解析这个对象

> ID：10624244
> 
> 赞同：0
> 
> 时间：2012-05-16T18:11:18.187
> 
> 标签：ruby-on-rails, ruby

我正在调用一个 REST API，我得到了一堆值。我试图弄清楚如何解析它们。

以下是值：

```
#<User _id: 4f8de8c40a5dcd0d1d00004c, agency_requested: [], encrypted_password: "$2a$10$FPVJDLkkD6AXd5SY/hL6KeuC6QR6vfU3OKI3oGCPxrTiEnAwvGOOu", avatar_file_size: nil, avatar_file_name: nil, agreed_to_terms: ["v1"], location: nil, last_name_first_initial: "Genadinik, A.", first_initial_last_name: "A. Genadinik", legacy_blogger_id: nil, created_at: Tue Apr 17 22:03:50 UTC 2012, active_advertiser_id: nil, avatar_source: :default, agency_roles: [], last_sign_in_ip: "127.0.0.1", confirmation_sent_at: Tue Apr 17 22:03:50 UTC 2012, created_via: "CMPLY-WEB", deleted_at: nil, updated_at: Fri May 11 16:37:16 UTC 2012, last_sign_in_at: Thu May 10 20:48:53 UTC 2012, display_welcome_help: true, program_influencers: [], agency_rep: true, account_type: :influencer, legacy_user_id: nil, sign_in_count: 44, _type: nil, avatar_content_type: nil, programs: [], active_agency_id: nil, account_status: :active, admin_roles: [], legacy_password: nil, gets_newsletter: false, full_name: "Alex Genadinik", last_name: "Genadinik", reset_password_token: nil, current_sign_in_ip: "127.0.0.1", authentication_token: "ViQ5q89n39zyyVUT3wLp", user_name: "me_n0_like_scrennames", time_zone: "Chihuahua", bio: nil, reset_password_sent_at: nil, current_sign_in_at: Fri May 11 16:37:16 UTC 2012, confirmation_token: nil, avatar_updated_at: nil, last_name_first_name: "Genadinik, Alex", agency_id: nil, first_name: "Alex", confirmed_at: Tue Apr 17 22:49:28 UTC 2012, email: "alex@cmp.ly"> 
```

解析器会是什么样子？我对 Ruby 很陌生，返回的东西有点难以理解，所以我不确定如何/从哪里开始。

到目前为止，我有类似的东西：

```
 begin
    // But not sure how to loop through this stuff and extract the values.

  end
  rescue Exception => ex
    # Do something
  end 
```

提前感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:15:55.067

在 Rails 应用程序中，一旦你有了 JSON，你可以这样做：

```
decoded_json = ActiveSupport::JSON.decode(json) 
```

decoded_json 将是一个哈希值，您可以使用 json 中的键访问值，例如：

```
decoded_json["_id"]
decoded_json["location"] 
```

您还可以考虑使用 HTTParty 之类的东西来处理与 RESTful API 的通信，如下所述：http: [//mike.bailey.net.au/2011/02/json-with-ruby-and-rails/](http://mike.bailey.net.au/2011/02/json-with-ruby-and-rails/)

# php - PHP 中的两种形式

> ID：10624245
> 
> 赞同：2
> 
> 时间：2012-05-16T18:11:25.633
> 
> 标签：php

我有一个显示两种形式的 php 文件。第一个表单显示来自 mysql 表中的客户数据，该表还包括一个复选框。第二个表单包含来自另一个表的数据，还包含一个复选框，该表单包含消息。我需要将使用复选框选中的消息发送到第一个表单中选择的客户列表。

我可以用纯php做到这一点吗？还是我需要使用javascript？请指点我一个教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:27:18.947

你需要下载 Jquery 库......并阅读什么是 ajax

获得价值

```
var value = $("#customer").val(); 
```

我们得到选择器的价值，其中 id="customer"

被检查

```
if($('#customer').is(":checked")) { } else { } 
```

在服务器上发送数据

```
var value = $("#customer").val();
$.ajax({
            type: "POST",
            url: "default.php",
            data: "name="+value,
            success: function(data){
            alert('ok!') ;
            }
}); 
```

我们在服务器 post 方法上发送数据...我们发送变量值，value = value in value id="customer"

祝你好运！对不起我的英语不好 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:35:31.767

您尝试完成的最初问题是您[不能同时提交两个表单](https://stackoverflow.com/questions/2719987/how-to-use-two-forms-and-sumit-once)。

有两个单独的表格是绝对必要的吗？如果是这样，您将需要实现[类似这样的东西](https://stackoverflow.com/questions/1435852/copying-from-form-to-form-in-jquery)（由 Roatin Marth 编写），以便在提交时将值从一个表单复制到另一个表单：

```
function form2form(formA, formB) {
   $(':input[name]', formA).each(function() {
     $('[name=' + $(this).attr('name') +']', formB).val($(this).val())
   })
} 
```

当然，如果您的业务需求**不需要**两个单独的表单，您可以将所有值放在一个表单中，然后使用 PHP 进行处理。如果您需要在提交之前验证表单，您需要先使用 Javascript 进行验证。

进入 PHP 后，您将从`$_POST`超全局中获取值。然后你可以用它做你需要做的事情。

```
// With each customer checked, send checked messages
foreach($_POST['customers'] as $customer)
{
   // With this customer, send all messages
   foreach($_POST['messages'] as $message)
   {
      // Send $message here
   }
} 
```

# xml - 需要一些 xml 节点连接的 awk 脚本

> ID：10624246
> 
> 赞同：1
> 
> 时间：2012-05-16T18:11:28.300
> 
> 标签：xml, awk

我是 awk 的新手，需要一个简单的 awk 脚本来帮助去除所有字符度量并连接属性以将 XML 压缩很多。

输入

```
<?xml version="1.0"?>
<document>
    <page>
        <block bbox="270 163.717 363.262 224.155">
            <line bbox="270 163.717 274.453 182.669">
                <span bbox="270 163.717 274.453 182.669" font="Helvetica-Bold" size="16.02">
                    <char bbox="270 200.519 284.425 224.155" c="f"/>
                    <char bbox="284.43 200.519 291.082 224.155" c="o"/>
                    <char bbox="291.087 200.519 297.74 224.155" c="o"/>
                </span>
            </line>
            <line bbox="270 200.519 363.262 224.155">
                <span bbox="270 200.519 363.262 224.155" font="Helvetica-Bold" size="19.98">
                    <char bbox="270 200.519 284.425 224.155" c="b"/>
                    <char bbox="284.43 200.519 291.082 224.155" c="a"/>
                    <char bbox="291.087 200.519 297.74 224.155" c="r"/>
                </span>
            </line>
        </block>
    </page>
</document> 
```

期望的输出

```
<?xml version="1.0"?>
<document>
    <page>
        <block bbox="270 163.717 363.262 224.155">
            <line bbox="270 163.717 274.453 182.669">
                <span bbox="270 163.717 274.453 182.669" font="Helvetica-Bold" size="16.02">foo</span>
            </line>
            <line bbox="270 200.519 363.262 224.155">
                <span bbox="270 200.519 363.262 224.155" font="Helvetica-Bold" size="19.98">bar</span>
            </line>
        </block>
    </page>
</document> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:19:52.430

尝试类似的东西

```
awk '{if (index($0, "<char") == 0) print $0}' xmlfile 
```

**编辑**：试试这个脚本：

```
gawk '{ if (index($0, "<char") > 0) {mat = gensub(/.*c=\"(.*)\".*/, "\\1", "g"); 
                                     tmp = tmp mat;} 
        else if (index($0, "</span>") > 0)
              { print gensub(/(.*)<\/span>/, "\\1", "g") "  " tmp "\n" $0;
                tmp = "";} 
        else print $0 }' xmlfile 
```

输出：

```
<?xml version="1.0"?>
<document>
    <page>
        <block bbox="270 163.717 363.262 224.155">
            <line bbox="270 163.717 274.453 182.669">
                <span bbox="270 163.717 274.453 182.669" font="Helvetica-Bold" size="16.02">
                  foo
                </span>
            </line>
            <line bbox="270 200.519 363.262 224.155">
                <span bbox="270 200.519 363.262 224.155" font="Helvetica-Bold" size="19.98">
                  bar
                </span>
            </line>
        </block>
    </page>
</document> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:35:59.443

不建议使用标准的 unix shell 实用程序进行 XML 解析。它需要一个适当的 XML 解析器来做到这一点。

使用 awk 以下命令可以获得输出（假设`c=`属性始终位于`<char>`XML 标记中的第二个位置：

```
awk 'BEGIN {FS="\""} /<char /{tag = tag $4;}
/<\/span>/{print tag; tag="";} !/<char /' file.xml 
```

### 输出

```
<?xml version="1.0"?>
<document>
    <page>
        <block bbox="270 163.717 363.262 224.155">
            <line bbox="270 163.717 274.453 182.669">
                <span bbox="270 163.717 274.453 182.669" font="Helvetica-Bold" size="16.02">
foo
                </span>
            </line>
            <line bbox="270 200.519 363.262 224.155">
                <span bbox="270 200.519 363.262 224.155" font="Helvetica-Bold" size="19.98">
bar
                </span>
            </line>
        </block>
    </page>
</document> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T20:20:25.267

显然，您正在使用 awk，尽管您知道 XML 应该由适当的工具处理。无论如何，必须提到这确实是[XSLT](http://www.w3.org/TR/xslt)的情况。

使用[Saxon](http://saxon.sourceforge.net/) 6（或更高版本），这样的命令

```
java -jar saxon.jar input.xml stylesheet.xslt 
```

通过这样的样式表产生所需的结果：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>
  <xsl:template match="span">
    <span>
      <xsl:copy-of select="@*"/>
      <xsl:for-each select="char/@c">
        <xsl:value-of select="."/>
      </xsl:for-each>
    </span>
  </xsl:template>
</xsl:stylesheet> 
```

# jquery - JQuery 自动补全（Pengoworks 版）findValue() 函数 - 使用方法

> ID：10624249
> 
> 赞同：0
> 
> 时间：2012-05-16T18:11:34.333
> 
> 标签：jquery, ajax, autocomplete

我已经成功实现了 PengoWorks 版本的 JQuery 自动完成功能多次用于查找等，但现在我试图在添加/编辑屏幕上使用它，如果自动完成框已经设置了一个值，它会检查 ajax 驱动查找以查看该值是否存在，如果存在，则保持原样并允许用户将其更改为自动完成列表中的另一个值。

根据[文档](http://www.pengoworks.com/workshop/jquery/autocomplete_docs.txt)，我应该能够通过调用 findValue() 函数来做到这一点 - 但是，我似乎无法让它工作 - 每次我加载我的页面时，我在输入中的预设值被清除了自动完成，即使该值与自动完成列表中的内容匹配。我尝试使用查看[演示页面](http://www.pengoworks.com/workshop/jquery/autocomplete.htm)源代码的代码，但没有任何反应，Firebug 中也没有 JS 错误。我确实注意到我对 mustMatch 设置的使用似乎会影响它（尽管我认为因为它是匹配项，所以这无关紧要），并且删除它会导致输入中的预设值显示，但现在存在一种可能性用户可以输入不在自动完成列表中的值。

这是我的代码（没有 findValue() 函数 - 我删除了它，希望不会让任何人混淆它，阅读文档和示例的人会看到我没有看到的东西，并为我指明正确的方向。）希望有人可以向我展示如何使用 findValue() 函数，因此如果预设值与列表中的条目匹配，它会保持可见，但仍允许用户清除输入并从自动完成列表中选择另一个条目。

```
<script type="text/javascript">
    $(function(){
        $('#Entity').autocomplete("/validate/getEntities.cfm", { 
                    autofill:true,
                    minChars: 2,
                    matchSubset:true,
                    matchContains:1,
                    selectFirst:true,
                    //mustMatch:true,
                    cellSeparator:"^",
                    onItemSelect:setEntityID
            });

        function setEntityID(li){
            $('#EntityID').setValue(li.extra[0]);
        };
    });
  </script> 
```

# jsf - 只处理值已被修改的输入字段？

> ID：10624252
> 
> 赞同：2
> 
> 时间：2012-05-16T18:11:51.873
> 
> 标签：jsf, jsf-2, primefaces

有没有更简单的方法来设置只处理 ah:form 中的那些输入字段，其值*实际上*已在客户端更改，而忽略那些未更改的字段？

* * *

将 JSF 2.2 与 Primefaces 3.2 一起使用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:22:07.313

不在 JSF 2.2 中，也不在 PrimeFaces 3.2 中。

您可以获得的最接近的是 PrimeFaces 3.3（目前仅作为快照提供），它具有从 jQuery 选择器 API 借用的[新客户端 ID 选择器语法。](http://blog.primefaces.org/?p=1867)不幸的是，这不支持某些`:changed`选择器（甚至已经不在 jQuery 选择器 API 中）。

这在 PrimeFaces JS API 中实现和集成并不是一件容易的事。您基本上需要`change`在后台的每个输入元素上挂接一个侦听器，您可以在其中收集已更改的客户端 ID。

# python - 在绘图区域中设置文本

> ID：10624253
> 
> 赞同：0
> 
> 时间：2012-05-16T18:11:52.637
> 
> 标签：python, pygtk, pango

我想使用 pygtk 将文本设置为绘图区对象。因此，我创建了一个绘图区域并使用“公开事件”信号设置了一个回调函数。然后我编写了一个函数来设置文本。我编码的是：

```
self.pangolayout = self.movie_window.create_pango_layout("")
...
self.pangolayout.set_text("Text here") 
```

其中“movie_windows”是一个 DrawingArea 对象。我没有错误，但绘图区域上没有写任何内容。建议？

脸书

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T23:20:41.860

您是否将布局绘制到窗口？

本教程的第三个示例使用 pango 布局：http: [//zetcode.com/tutorials/pygtktutorial/pangoII/](http://zetcode.com/tutorials/pygtktutorial/pangoII/)

# c - 在 Xcode 中构建旧的 unix C 项目时出现错误的指针？

> ID：10624254
> 
> 赞同：2
> 
> 时间：2012-05-16T18:12:04.277
> 
> 标签：c, xcode, macos, pointers

我有一个在 Unix 中编译得很好的旧 C 项目。我想在 Lion 上的 Xcode 中构建它，所以我创建了一个新的 Xcode 项目并添加了所有文件（除了 makefile）。

无论如何，我在构建时遇到了许多“语义问题”。有谁知道这里会发生什么？指针的所有这些问题似乎很奇怪。在 Xcode 中构建项目与使用 make 真的有什么不同吗？这与osx有关吗？

例如：

```
unsigned char *p = b->buf + adbuf_used(b); 
```

给出错误：

> 使用 'char *' 类型的表达式初始化 'unsigned char *' 在指向具有不同符号的整数类型的指针之间转换

和

```
printf("sizeof(unsigned int) = %d\n", sizeof(unsigned int)); 
```

给出错误：

> 转换指定类型“int”，但参数的类型为“无符号”

和

```
printf("%2d, ", p-cset); 
```

给出错误：

> 转换指定类型“int”，但参数的类型为“long”

和

```
if (getsockname(sock_rt, (struct sockaddr *)&iface_out, &len) == -1 ) { 
```

给出错误：

> 将“int *”传递给“socklen_t *”（又名“unsigned int *”）类型的参数会在指向具有不同符号的整数类型的指针之间进行转换

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:16:55.787

显示编译器的错误是因为此编译器更严格，并且根据定义，它是正确的。在您展示的情况下，您可以更改以下内容：

1.  `p`and`b->buff`不属于同一类型，`p`属于 type `unsigned char *`，而`b->buff`属于 type`char *`

    ```
    unsigned char *p = b->buf + adbuf_used(b);
    // To
    char *p = b->buf + adbuf_used(b);
    // or
    unsigned char *p = (unsigned char *)b->buf + adbuf_used(b); 
    ```

2.  无符号整数的格式说明符是`%u`, not `%d`。或者，正如评论的那样，在`size_t`使用的情况下`%zu`

    ```
    printf("sizeof(unsigned int) = %d\n", sizeof(unsigned int));
    // to
    printf("sizeof(unsigned int) = %zu\n", sizeof(unsigned int)); 
    ```

3.  long 的格式说明符是`%ld`, not`%d`

    ```
    printf("%2d, ", p->cset);
    // to
    printf("%2ld, ", p->cset); 
    ```

4.  第三个参数是 type `socklen_t *`，不是`int *`

    ```
    if (getsockname(sock_rt, (struct sockaddr *)&iface_out, &len) == -1 )
    //instead of 
    int len;
    // define
    socklen_t len; 
    ```

如果保持原样，所有这些情况通常不会造成伤害，但基本上`unsigned`和`signed`是不同的类型，`long`并且`int`是不同的类型（这在许多系统中实际上很重要）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:22:14.180

`b->buf`和中的至少一个`adbuf_used(b)`是普通`char`的或`signed char`.

中无符号整数的说明符`printf`是`u`。

说明符`d`假定参数是 type`int`而`p-cset`(?) 是 type `long`。改为使用`l`。

这`getsockname`又是一个足够相似的错误，您可以自己弄清楚。

阅读手册`printf`。并尊重编译器警告。

# ios - 更改 Phonegap 用户代理

> ID：10624259
> 
> 赞同：11
> 
> 时间：2012-05-16T18:12:41.360
> 
> 标签：ios, cordova, user-agent

我的 Phonegap 应用程序允许浏览到一些也使用 Phonegap API 的外部站点。目前，我根据您所在的平台（Android、iOS 等）有条件地包含 Phonegap javascript。但是，我无法区分 Phonegap 应用程序和移动设备上的常规浏览器之间的区别。有没有办法更改我的 Phonegap 应用程序中的用户代理，以向我的服务器提供有关此的提示？

对此最感兴趣的 iOS 解决方案。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-04T03:02:56.377

如果您仍在为该解决方案寻找快速解决方案，这就是我实现它的方式：

```
// Modify the user-agent
NSString* suffixUA = @" my nice user-agent suffix";
UIWebView* webView = [[UIWebView alloc] initWithFrame:CGRectZero]; 
NSString* defaultUA = [webView stringByEvaluatingJavaScriptFromString:@"navigator.userAgent"];
NSString* finalUA = [defaultUA stringByAppendingString:suffixUA];
NSDictionary *dictionary = [NSDictionary dictionaryWithObjectsAndKeys:finalUA, @"UserAgent", nil];
[[NSUserDefaults standardUserDefaults] registerDefaults:dictionary]; 
```

在 Phonegap (Cordova) 示例应用程序中，您需要在 AppDelegate.m 的*didFinishLaunchingWithOptions**方法*中添加这些行

 *我花了一整天的时间试图弄清楚这一点！我相信它可能对其他人有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-09-25T09:14:30.620

[This answer](https://stackoverflow.com/a/32337353/817202) to a similar question还提到了当前 Cordova 版本中可用的首选项：

```
<preference name="OverrideUserAgent" value="MyCordovaApp/1.2.3" /> 
```

它[记录在 Android](http://cordova.apache.org/docs/en/5.1.1/guide_platforms_android_config.md.html)和[iOS](http://cordova.apache.org/docs/en/5.1.1/guide_platforms_ios_config.md.html)上。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-12-30T20:01:53.480

[CB-2520](https://issues.apache.org/jira/browse/CB-2520)已解决，建议允许修改用户代理字符串。您现在可以通过设置 MainViewController 的*baseUserAgent*属性来实现这一点。对于一个简单的测试，您可以在 MainViewController 初始化后，将以下内容添加到**AppDelegate.m的***didFinishLaunchingWithOptions*方法中：

 **`self.viewController.baseUserAgent = @"My Custom User Agent";`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-10-22T14:47:33.677

如果您正在为允许更改用户代理或任何标头的 cordova 寻找更强大的 http 客户端，请尝试[https://github.com/aporat/cordova-plugin-fetch](https://github.com/aporat/cordova-plugin-fetch)。它包含经过良好测试的本机网络库（`AFNetworking 2`在 ios 和`OKHttp`android 上）。

它还遵循 window.fetch，因此您可以`cordovaFetch`在模拟器和设备上使用，同时在浏览器上使用`fetch.js`.

只需安装插件

`cordova plugin add https://github.com/aporat/cordova-plugin-fetch.git`

并在您发出的任何请求中包含用户代理标头。

```
cordovaFetch('/users.json', {
  method : 'GET',
  headers: {
   'User-Agent': 'your user agent'
 },
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T18:23:26.833

看到这个问题：[Detect between a mobile browser or a PhoneGap application](https://stackoverflow.com/questions/10347539/detect-between-a-mobile-browser-or-a-phonegap-application/10572142#10572142)

我做出了贡献，但有很多答案可能适合您。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-20T18:50:27.370

我无法在使用 Cordova 3.3 的 iOS 中使用它，大概是因为[CB-2520](https://issues.apache.org/jira/browse/CB-2520)，但作为一个 hack，我修改`CDVViewController`了 .h 以使`userAgent`属性可读写，然后在我的控制器中简单地更新 self.userAgent`viewDidLoad`继承从`CDVViewController`.

`userAgent`如果时间是一个问题，你可以强行操纵`CDVViewController.m`.

这两个都很脏。:)***

# php - JQuery/Ajax 调用函数不正确

> ID：10624262
> 
> 赞同：0
> 
> 时间：2012-05-16T18:12:52.907
> 
> 标签：php, jquery

**摘要**：这是一个基本的、独立的 Web 表单。只是 html 表单，其中包含用于功能的 JQuery。

我有一个表格可以检查电子邮件和用户名的唯一性和有效性（电子邮件）。我正在使用 JQuery onChange 事件来调用每个函数，这是对 php 文件的 Ajax 调用。

用于用户名检查的 JQuery 如下：

```
$("#username").change(function() {
    var username = $("#username").val();
    var msgbox_username = $("#username_status");
    var dataString = "username="+ username;

    $("#username_status").html('<img src="images/loader.gif">Checking Availability.');
    if (username != "" && username.length >= 6){
        $.ajax({
            Type: "POST",
            url: "functions/check_username.php",
            data: dataString,
            success: function(msg_username) {
                $("#username_status").ajaxComplete(function (event, request) {
                    if (msg_username == 'Username Ok') {
                        $("#username").removeClass("red").addClass("green");
                        msgbox_username.html('<font color="Green">Available</font>');
                    } else {
                        $("#username").removeClass("green").addClass("red");
                        msgbox_username.html(msg_username); 
                    }
                });
            }
        });
        return false;
    } else {
        $("#username").removeClass("green").addClass("red");
        msgbox_username.html('<font color="Red">Username of 6 or more characters is required</font>');
    }
}); 
```

check_username.php 文件如下：

```
<?php
$username = $_GET["username"];
include_once("../includes/connect.php");
$query = "SELECT    username 
          FROM      sss_users
          WHERE     username = '$username'";
$result = mssql_query($query);  
if(mssql_num_rows($result) > 0 && strlen($username) >= 6) {
    echo '<font color="#cc0000"><strong>' . $username . '</strong> is already in use. </font>'; 
} else {
    echo 'Username Ok'; 
}
?> 
```

继续该模式，电子邮件 JQuery：

```
$("#email").change(function() {
    var email = $("#email").val();
    var msgbox_email = $("#email_status");
    var dataString = "email="+ email;

    $("#email_status").html('<img src="images/loader.gif">Checking Availability.');
    var atpos = email.indexOf("@");
    var dotpos = email.lastIndexOf(".");
    if (atpos < 1 || dotpos < atpos + 2 || dotpos + 2 >= email.length){
        $("#email").removeClass("green").addClass("red");
        msgbox_email.html('<font color="Red">Valid Email Required</font>');
    } else {
        $.ajax({
            Type: "POST",
            url: "functions/check_email.php",
            data: dataString,
            success: function(msg_email) {
                $("#email_status").ajaxComplete(function (event, request) {
                    if (msg_email == 'Email Ok') {
                        $("#email").removeClass("red").addClass("green");
                        msgbox_email.html('<font color="Green">Available</font>');
                    } else {
                        $("#email").removeClass("green").addClass("red");
                        msgbox_email.html(msg_email);   
                    }
                });
            }
        });
        return false;
    }
}); 
```

和电子邮件 PHP：

```
<?php
$email = $_GET["email"];
include_once("../includes/connect.php");
$query = "SELECT    email 
          FROM      sss_users
          WHERE     email = '$email'";
$result = mssql_query($query);        
if(mssql_num_rows($result) > 0) {
    echo '<font color="#cc0000"><strong>' . $email . '</strong> is already in use. </font>';    
} else {
    echo 'Email Ok';    
}
?> 
```

它们各自单独工作，但是如果我在框中输入了无效的用户名，然后输入了有效的电子邮件，则会以某种方式调用 check_username.php 文件，并且无论框中的内容（有效与否）它都认为它是有效的用户名。

一个例子是：

**所有函数都在 OnChange 事件上调用**

1）输入用户名 asdfasdf（可用）

2）从文本框中删除用户名asdfasdf（这可以正常工作，显示用户名必须至少有6个字符）

3) 输入任何有效的电子邮件

结果：有效的电子邮件工作正常，但用户名字段（空白）回忆起之前的内容（asdfasdf）并说它是一个有效的用户名（即使该字段仍然是空白的）。

希望这是有道理的。有什么建议么？

**解决方案**

如下所述， .ajaxComplete() 使用该标记调用所有函数。因此，当我进行以下更改时，它起作用了：

```
$("#username_status").ajaxComplete(function (event, request) { ... code here ... }); 
```

变成：

```
$("#username_status").ajaxComplete(function (event, request, settings) { ... code and new if statement ... }); 
```

然后我包裹

```
if(settings.url == 'functions/check_username.php') {} 
```

围绕验证码。此过程针对用户名和电子邮件验证完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:08:01.523

[http://api.jquery.com/ajaxComplete/](http://api.jquery.com/ajaxComplete/)

> 每当 Ajax 请求完成时，jQuery 都会触发 ajaxComplete 事件。此时会执行已使用 .ajaxComplete() 方法注册的所有处理程序。

也许两个处理程序都被解雇了。

# android - Android：jUnit 测试 Android 库

> ID：10624264
> 
> 赞同：1
> 
> 时间：2012-05-16T18:13:08.457
> 
> 标签：android, unit-testing, android-activity, junit

我正在尝试通过 jUnit 测试我开发的库，但我遇到了一些问题。该库需要实例化一个活动。但是，按照教程（http://www.vogella.com/articles/JUnit/article.html），我无法实例化对象，因为我没有活动。您可以创建一个虚拟活动吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T20:55:33.473

要测试`Activity`你通常应该使用[ActivityInstrumentationTestCase2](http://developer.android.com/reference/android/test/ActivityInstrumentationTestCase2.html)。当您调用时`getActivity()`，`Activity`将创建被测对象。

如果你正在测试一个库项目，post [android: testing library project](http://dtmilano.blogspot.com/2012/04/android-testing-library-projects.html)也会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:27:44.220

单元测试 Android 应用程序很棘手，因为 API 实现已被存根（“java.lang.RuntimeException: Stub!”）

如果您想对您的 Android 活动等进行单元测试，[Robolectric](http://pivotal.github.com/robolectric/)是一个不错的选择： [http ://pivotal.github.com/robolectric/](http://pivotal.github.com/robolectric/)

# c# - Silverlight 回调神秘行为

> ID：10624267
> 
> 赞同：0
> 
> 时间：2012-05-16T18:13:27.983
> 
> 标签：c#, silverlight, events, event-handling, navigation

我正在编写此方法来跟踪页面上是否发生更改，以便用户可以触发依赖系统的重新加载。因此，当用户尝试离开页面时，您可以看到触发器。如果 e.Cancel 不存在，则行为似乎很好，异步 Web 服务调用按预期发生，但我不确定后面到底发生了什么。

重新加载按钮单击方法会触发一系列事件，这些事件通常会更新显示，但由于用户已离开页面，因此组件不再可见。这会给应用程序带来问题吗？我是否应该强迫用户留在同一页面上以防止可能出现的回调问题？

```
 protected override void OnNavigatingFrom(NavigatingCancelEventArgs e)
    {
        base.OnNavigatingFrom(e);
        if (hasDataBeenModified)
        {
            if (System.Windows.Browser.HtmlPage.Window.Confirm("You have not reloaded the policies\nDo you want to do it now?"))
            {
                //e.Cancel = true;
                ReloadButton_Click(null, null);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T21:28:37.520

不要使用 OnNavigatingFrom，而是使用 OnBackKeyPress

```
protected override void OnBackKeyPress(CancelEventArgs e)
{
    if (hasDataBeenModified)
    {
        if (System.Windows.Browser.HtmlPage.Window.Confirm("You have not reloaded the policies\nDo you want to do it now?"))
        {
            e.Cancel = true;
            ReloadButton_Click(null, null);
        }
    }
} 
```

# asp.net - 可以在代码隐藏 ASP.NET 中引用 CSS 选择器

> ID：10624268
> 
> 赞同：0
> 
> 时间：2012-05-16T18:13:34.417
> 
> 标签：asp.net, css-selectors, code-behind

假设我在一个 aspx 页面上有这个 HTML 标记：

```
 <div id = 'logo-container' class='foo'>
          <img alt='logo' src ="images/foo.png" />
      </div> 
```

纯 html，**而不是**runat=server。

是否可以*在 aspx 代码隐藏*中使用 CSS 选择器来引用 DOM 元素？您能否参考 IMG 执行以下操作：

```
 foreach element in GetElement("#logo-container img")
  {
       do something with element, e.g. change a style attribute
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:57:08.757

不，很遗憾，你不能。你最好按照预期的方式去做。如果您需要在代码隐藏中访问控件，只需添加`runat="server"`属性。

考虑到您需要在代码隐藏中访问它们，为什么不想在服务器上运行控件？您是否担心自动生成的 ID？如果是这样，您可以通过设置`ClientIDMode`为*static*来解决此问题。

如果您确实在服务器上运行控件，您应该能够使用 LINQ 找到具有该类的控件，如下所示：

```
var ctrls = pnlControls.Controls.OfType<WebControl>().Where(i => i.CssClass == "logo-container"); 
```

**注意：**如果需要，您可以替换`WebControl`为更具体的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:15:23.093

简短的回答 - 否。如果控件未设置为 runat="server"，则无法从后面的代码访问它。但是，您可以使用 Javascript 访问该元素，然后调用服务器端方法来执行您想要执行的任何逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T10:13:01.877

我感觉更好解决方案是：

如果您真的想更改样式/css 类，您可以更好地使用 jquery 并自定义您想要的方式。

# c - 将字符串“来自文件”解析为整数

> ID：10624269
> 
> 赞同：1
> 
> 时间：2012-05-16T18:13:43.060
> 
> 标签：c, string, parsing, int

我正在用 C 语言编写一个程序，它从文件中读取一行并在屏幕上显示这一行 我的作业要求文件必须从文件中获取一个数字并对其进行一些操作。

我得到文件内容并将其放入一个数组中：

```
while ( fgets ( line, sizeof line, file ) != NULL ) 
    {        
        strcpy(arra[i], line);
        printf("array ----> %d \n", arra[i]);
        i++;        
    } 
```

如何将此内容解析为 int ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:16:39.833

你可以使用 atoi()

```
int x = atoi("string"); 
```

从您的代码示例

```
while ( fgets ( line, sizeof line, file ) != NULL ) 
{        
    strcpy(arra[i], line);
    printf("array ----> %d \n", atoi(arra[i]));
    i++;        
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T18:16:40.397

如果`line`是 a `char*`，您可以使用`atoi`它来将其转换为整数。

```
printf("array ----> %d \n", atoi(line)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T23:26:11.033

```
#include <stdio.h>
#include <stdlib.h>

#define MAX_DATA_SIZE 10

int main(){
    FILE *file;
    char line[128];
    int array[MAX_DATA_SIZE];
    int i,count,sum;

    file = fopen("data.txt","r");
/* data.txt:
100
201
5
-6
0
*/
    for(i=0; NULL!=fgets(line, sizeof(line), file); ++i){
        if(i == MAX_DATA_SIZE){
            fprintf(stderr,"exceeded the size of the array.\n");
            exit(EXIT_FAILURE);
        }
        array[i]=atoi(line);
    }
    fclose(file);
    /*some operations */
    count = i;
    sum = 0;
    for(i=0;i<count;++i)
        sum += array[i];
    printf("%d\n",sum);

    return 0;
} 
```

# iphone - Facebook API for iOS 中的分析器警告

> ID：10624271
> 
> 赞同：0
> 
> 时间：2012-05-16T18:13:57.543
> 
> 标签：iphone, objective-c, ios, facebook, analyzer

这是 APICallsViewController 文件中的代码和几个屏幕截图。我的应用程序崩溃了，我不确定这是否是原因。

谢谢你的帮助

![在此处输入图像描述](../Images/602903ef391ac8c05a7ccc5dab086c60.png)

```
 // Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UILabel *textLabel;
    UILabel *detailTextLabel;
    UIButton *button;

    UIFont *cellFont = [UIFont boldSystemFontOfSize:14.0];
    UIFont *detailCellFont = [UIFont fontWithName:@"Helvetica" size:12.0];

    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
        cell.selectionStyle = UITableViewCellSelectionStyleNone;

        // Initialize API title UILabel
        textLabel = [[[UILabel alloc] initWithFrame:CGRectZero] autorelease];
        textLabel.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleRightMargin;
        textLabel.tag = TITLE_TAG;
        textLabel.font = cellFont;
        [cell.contentView addSubview:textLabel];

        // Initialize API description UILabel
        detailTextLabel = [[[UILabel alloc] initWithFrame:CGRectZero] autorelease];
        detailTextLabel.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleRightMargin;
        detailTextLabel.tag = DESCRIPTION_TAG;
        detailTextLabel.font = detailCellFont;
        detailTextLabel.textColor = [UIColor darkGrayColor];
        detailTextLabel.lineBreakMode = UILineBreakModeWordWrap;
        detailTextLabel.numberOfLines = 0;
        [cell.contentView addSubview:detailTextLabel];

        // Initialize API button UIButton
        button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
        button.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleRightMargin;
        [button setBackgroundImage:[[UIImage imageNamed:@"MenuButton.png"]
                                    stretchableImageWithLeftCapWidth:9 topCapHeight:9]
                          forState:UIControlStateNormal];
        [button setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
        [button addTarget:self action:@selector(apiButtonClicked:) forControlEvents:UIControlEventTouchUpInside];
        [cell.contentView addSubview:button];
    } else {
        textLabel = (UILabel *)[cell.contentView viewWithTag:TITLE_TAG];
        detailTextLabel = (UILabel *)[cell.contentView viewWithTag:DESCRIPTION_TAG];
        // For the button cannot search by tag since it is not constant
        // and is dynamically used figure out which button is clicked.
        // So instead we loop through subviews of the cell to find the button.
        for (UIView *subview in cell.contentView.subviews) {
            if([subview isKindOfClass:[UIButton class]]) {
                button = (UIButton *)subview;
            }
        }
    }

    CGSize constraintSize = CGSizeMake(280.0f, MAXFLOAT);

    // The API title
    NSString *cellText = [[apiMenuItems objectAtIndex:indexPath.row] objectForKey:@"title"];
    CGSize labelSize = [cellText sizeWithFont:cellFont
                            constrainedToSize:constraintSize
                                lineBreakMode:UILineBreakModeWordWrap];
    textLabel.frame = CGRectMake(20, 2,
                                  (cell.contentView.frame.size.width-40),
                                  labelSize.height);
    textLabel.text = cellText;

    // The API description
    NSString *detailCellText = [[apiMenuItems objectAtIndex:indexPath.row] objectForKey:@"description"];
    CGSize detailLabelSize = [detailCellText sizeWithFont:detailCellFont
                                        constrainedToSize:constraintSize
                                            lineBreakMode:UILineBreakModeWordWrap];
    detailTextLabel.frame = CGRectMake(20, (labelSize.height + 4),
                                       (cell.contentView.frame.size.width-40),
                                       detailLabelSize.height);
    detailTextLabel.text = detailCellText;

    // The API button
    CGFloat yButtonOffset = labelSize.height + detailLabelSize.height + 15;
    button.frame = CGRectMake(20, yButtonOffset, (cell.contentView.frame.size.width-40), 44);
    [button setTitle:[[apiMenuItems objectAtIndex:indexPath.row] objectForKey:@"button"]
            forState:UIControlStateNormal];
    // Set the tag that will later identify the button that is clicked.
    button.tag = indexPath.row;

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:23:28.227

该`button`变量是一个局部变量。除非您使用 ARC，否则不能保证将其初始化为任何内容。这可能是胡说八道。分析器警告您，在您尝试向其发送消息时，它是否已分配有意义的地址尚不清楚（`frame`属性的设置器是您发送的消息）。

考虑一下：`cell`is not `nil`，并且您在其子视图中找不到按钮。如果是这种情况，应用程序将在没有分配给`button`变量的情况下到达有问题的行。它可以包含一个指向绝对任何地方的指针。如果您尝试取消引用指针以向对象发送消息，您可能会在应用程序中的任何地方乱写内存。

现在，您可能知道可以保证找到一个按钮的子类。但分析仪无法弄清楚。所以无论如何它都会警告你。

`button`您应该将变量初始化为`nil`. 如果有可能找不到按钮，您应该处理这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:27:22.830

在`else`语句`UIButton *button`中未初始化。看看 if 语句中的情况：

```
button = [UIButton buttonWithType:UIButtonTypeRoundedRect]; 
```

但在`else`初始化时缺失。你可以放在后面：

```
} else {
        textLabel = (UILabel *)[cell.contentView viewWithTag:TITLE_TAG];
        detailTextLabel = (UILabel *)[cell.contentView viewWithTag:DESCRIPTION_TAG];
        button = (UIButton *)[cell.contentView viewWithTag:indexPath.row]; // <---- add this 
```

并移动这个：

```
button.tag = indexPath.row; 
```

前

```
[cell.contentView addSubview:button]; 
```

在 if 语句的末尾...

# sql-server - 数据库/编程中的服务代理

> ID：10624277
> 
> 赞同：1
> 
> 时间：2012-05-16T18:14:34.137
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, c#-4.0, service-broker

**[服务经纪人](http://msdn.microsoft.com/en-us/library/ms345108%28v=sql.90%29.aspx)**

1.  使用 Service Broker 进行编程有什么好处？
2.  在什么情况下应该使用 Service Broker？
3.  您是否有代码/视频的示例链接可以轻松/准确地解释其用法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T05:29:38.110

> 当今许多数据库应用程序都需要排队和异步消息传递。Service Broker 提供了一个新的、基于队列的持久消息传递框架来满足这些需求。使用 Service Broker 提供的 Transact-SQL API，您可以轻松开发服务来处理排队或异步通信的应用程序需求。
> 
> 使用 Service Broker 进行编程的一些好处是：
> 
> 灵活开发：单个分布式应用程序中使用的程序可以用多种语言编写。每个程序都提供每个分布式应用程序组件的功能。
> 
> 提高安全性：您可以通过证书表达安全要求，因此应用程序组件不需要共享相同的安全上下文。Service Broker 使用 SQL Server 安全功能来帮助您保护应用程序。
> 
> 事务处理：消息处理发生在 SQL Server 事务中，以确保数据完整性。Service Broker 支持通过与数据库的标准连接进行远程事务消息传递。
> 
> 有保证的排序：Service Broker 为相关消息集的交付和处理提供了强有力的保证，只需一次按顺序进行，因此不需要额外的编码来提供此功能。
> 
> 可靠交付：会话所需的所有数据（两个或多个服务之间的一组相关通信）都保存在 SQL Server 中。Service Broker 支持集群和数据库镜像。可以通过系统重新启动、服务器故障转移、网络中断等来维持对话，而不会失败或丢失数据。
> 
> 改进的可扩展性：Service Broker 路由基于服务的名称而不是运行服务的计算机的网络地址来传递消息。这允许您在不更改应用程序代码的情况下在多台计算机上安装应用程序。
> 
> 利用现有知识的能力：Service Broker 使用 Transact-SQL 创建对象。使用 Service Broker 的应用程序最常以 Transact-SQL 或 Microsoft .NET Framework 兼容语言实现。您不必学习一门新语言来创建 Service Broker 应用程序。
> 
> 有关更多详细信息，请查看此链接 [http://dotnet.dzone.com/articles/c-sqldependency-monitoring](http://dotnet.dzone.com/articles/c-sqldependency-monitoring)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-28T18:36:37.413

1.  当我们想在数据库中进行异步处理时，服务代理很有用。这将提高性能。
2.  当我们需要数据库间通信时。

[您可以在此处](http://mysoftwareexperience.blogspot.in/2016/02/creating-service-broker-sample-scripts.html)找到使用服务代理创建和发送消息的示例代码。

# c - 在 C 中编程套接字，发送和接收文件时出错

> ID：10624278
> 
> 赞同：1
> 
> 时间：2012-05-16T18:14:39.110
> 
> 标签：c, sockets

我在 C for Linux 环境中制作了一个应用程序。此应用程序有效，但一段时间后（或多或少 5 小时）其性能不稳定。这是背景。我有一些远程计算机（或多或少 400 台）每 5 分钟通过套接字（我的应用程序）发送数据。所有过程都是一个循环，我需要它整天工作。应用程序首先发送数据（如果存在），然后接收数据（同样，如果存在）。我的应用程序像带有一些参数的服务器端一样工作，或者它像带有其他参数的客户端一样工作。应用程序作为服务器模式工作，在监听状态之后，只等待客户端连接。一旦连接了客户端，客户端模式下的应用程序会发送一条消息以指示将要发送的数据，然后发送一条新消息，其大小和名称连接到服务器端（始终发送 64 字节，所以我的应用程序写入 64 个字节，在另一端读取 64 个字节），然后发送数据（文件）。服务器读取要接收的文件大小和名称的消息（64字节），拆分消息，将大小存储在一个变量中，将文件名存储在另一个变量中，然后在接收到文件数据后。将存储在变量中的大小与读取的数据大小进行比较，如果一切正常，则服务器发送一条消息并将数据存储在一个新文件中，该文件的名称与接收之前的名称相同。依此类推，直到最后一个文件被发送。然后服务器发送一条消息并将数据存储在一个新文件中，该文件使用之前接收到的名称。依此类推，直到最后一个文件被发送。然后服务器发送一条消息并将数据存储在一个新文件中，该文件使用之前接收到的名称。依此类推，直到最后一个文件被发送。

当我的应用程序处于开发状态时，我注意到在几个小时后它们会损坏消息，我的意思是消息不完整或有更多数据，可能是下一个消息的数据。所以文件数据也是如此。那么，如何通过同一个套接字发送文件数据？注意：我有一个用于发送和接收消息的缓冲区，还有一个用于发送和接收文件数据的缓冲区。

和其他问题：原始代码：

```
int copydata(int readfd, int writefd, int offset, int bytes) {
  char buffer[4096];
  int crbytes = 0, cwbytes = 0, trbytes = 0, twbytes = 0;
  if (offset) {
    if (lseek(readfd, offset, SEEK_CUR) < 0) {
      return -1;
    }
  }
  while ((crbytes = read(readfd, buffer, bytes)) > 0) {
    if (crbytes < 0) {
      return -1;
    }
    trbytes += crbytes;
    //printf("dbgmsg::Readed data <%dB> | Total readed data <%dB>\n", crbytes, trbytes);
    while (crbytes > 0) {
      cwbytes = write(writefd, buffer, crbytes);
      if (cwbytes < 0) {
        return -1;
      }
      twbytes += cwbytes;
      crbytes -= cwbytes;
      //printf("dbgmsg::Written data <%dB> | Total written data <%dB>\n", cwbytes, twbytes);
    }
  }
  return twbytes;
} 
```

此代码用于发送和接收文件数据。发送数据的一方使用我们要发送（读取）`<readfd>`的文件的文件描述符，并在套接字的文件描述符上写入（写入）`<writefd>`。接收数据的一侧，用于`<readfd>`从套接字文件描述符中读取和`<writefd>`从我们要写入数据的文件中写入文件描述符。如果在使用该函数之前发送了其他消息，客户端和服务器都会卡在内部“while循环”的末尾，即客户端发送所有文件数据，服务器接收所有文件数据（在此点，接收到的数据是完整的，我怎么知道？因为我可以打开接收到的文件）。没有错误，只有一个，“没有所需类型的消息”。如果我没有在此功能之前发送消息一切正常。为了跳过这个小问题，我修改了代码，也将文件大小作为参数传递，并在两个 while 之间写入 if 结构。

```
int copydata(int readfd, int filesz, int writefd, int offset, int bytes) {
  char buffer[4096];
  int crbytes = 0, cwbytes = 0, trbytes = 0, twbytes = 0;
  if (offset) {
    if (lseek(readfd, offset, SEEK_CUR) < 0) {
      return -1;
    }
  }
  while ((crbytes = read(readfd, buffer, bytes)) > 0) {
    if (crbytes < 0) {
      return -1;
    }
    trbytes += crbytes;
    //printf("dbgmsg::Readed data <%dB> | Total readed data <%dB>\n", crbytes, trbytes);
    while (crbytes > 0) {
      cwbytes = write(writefd, buffer, crbytes);
      if (cwbytes < 0) {
        return -1;
      }
      twbytes += cwbytes;
      crbytes -= cwbytes;
      //printf("dbgmsg::Written data <%dB> | Total written data <%dB>\n", cwbytes, twbytes);
    }
    if (twbytes == filesz) { break; }
  }
  return twbytes;
} 
```

谢谢你的提前，对不起我的英语！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T21:03:23.080

如果程序遇到“不完整”的 write()，您的内部循环将重新发送缓冲区的开头。

```
while (crbytes > 0) {
      cwbytes = write(writefd, buffer, crbytes);
      if (cwbytes < 0) {
        return -1;
      }
      twbytes += cwbytes;
      crbytes -= cwbytes;
      //printf("dbgmsg::Written data <%dB> | Total written data <%dB>\n", cwbytes, twbytes);
    } 
```

您可以将其更改为：

```
for ( sentbytes=0; sentbytes < crbytes; sentbytes += cwbytes ) {
      cwbytes = write(writefd, buffer+sentbytes, crbytes - sentbytes);
      if (cwbytes < 0) { return -1; }
      twbytes += cwbytes;
    } 
```

# regex - 正则表达式不匹配数字和字母

> ID：10624281
> 
> 赞同：0
> 
> 时间：2012-05-16T18:14:59.800
> 
> 标签：regex

这个正则表达式是什么意思

> [^0-9^AZ]

??

它不匹配任何数字并且不匹配任何大写字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:16:07.147

正确的正则表达式：不需要`[^0-9A-Z]+`第二个，没有 a你只是匹配这种类型的一个字符。`^``+`

请注意，这`0-9`与此相同`\d`的最佳正则表达式应该是：`[^A-Z\d]+`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:22:49.757

当插入符号`^`位于括号组的开头时，它的意思是“找到除以下项目之外的任何内容”。但是，当它被放置在其他任何地方时，它意味着“与其他项目一起找到插入符号”。你的两者都有，这意味着“找到除了以下项目（包括插入符号）之外的任何东西”。

所以`[^A-Z0-9]`意思是“找到除大写字母或数字以外的任何字符”

您的正则表达式的`[^0-9^A-Z]`意思是“查找除大写字母、数字**或**插入符号之外的任何字符。

正如其他人指出的那样，您可能指的是第一个版本，但我认为注意两者之间的区别很重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:23:58.663

就目前而言，它匹配除数字、大写字母或抑扬符之外的任何单个字符。

`^`开头的抑扬符 ( ) 否定字符集。不紧跟左括号的抑扬符被解释为字符集本身的一部分。正则表达式`[^^]`匹配除抑扬符以外的任何字符。

# javascript - JavaScript 中的 Dynamics CRM 2011 Sharepoint 参考

> ID：10624284
> 
> 赞同：0
> 
> 时间：2012-05-16T18:15:21.343
> 
> 标签：javascript, dynamics-crm, microsoft-dynamics

我在使用 CRM 和 JavaScript 时遇到问题。我想在 JavaScript 文件中引用 sharepoint 库。但它不起作用......我如何引用共享点库？

例如：

```
/// <reference path="C:\sp.js" /> 

function testFieldChange() {

    var serverUrl = Xrm.Page.context.getServerUrl();
    ODataPath = serverUrl + "/xrmservices/2011/OrganizationData.svc";

    // ... sharepoint code ...

    Xrm.Page.getAttribute('test_field').setValue('Test');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:47:41.687

您需要将 sp.js 文件作为 CRM Web 资源上传。完成后，它可以在表单和其他 JS 代码中作为脚本库引用。

[您可以在此处](http://msdn.microsoft.com/en-us/library/gg309414.aspx)阅读有关在 CRM 中使用 JScript 的更多信息

# c# - 如何对 CSV 文件使用 SQL

> ID：10624286
> 
> 赞同：7
> 
> 时间：2012-05-16T18:15:23.650
> 
> 标签：c#, sql, csv

我想使用 C# 对 CSV 文件使用 SQL 查询。[这里](http://www.hxtt.com/)的 java 有类似的东西。c#有这样的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T18:23:28.593

您可以使用 ODBC 对 CSV 文件运行查询：

```
// using System.Data.Odbc;

string strConn = @"Driver={Microsoft Text Driver (*.txt; *.csv)};" +
    "Dbq=C:;Extensions=csv,txt";

OdbcConnection objCSV = new OdbcConnection(strConn);
objCSV.Open();

OdbcCommand oCmd = new OdbcCommand("select column1,column2 " +
    "from THECSVFILE.CSV", objCSV);
OdbcDataReader oDR = oCmd.ExecuteReader();

while (oDR.Read())
{
    // Do something
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-16T18:18:17.847

您可以使用适当的 OLE DB 提供程序来查询文本文件。您可以在此处找到查询字符串：

[文本文件连接字符串示例](http://www.connectionstrings.com/textfile)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T18:26:43.317

```
// need to add
// using System.Linq;

void Main()
{
    var path = @"C:\myfile.csv";
    string csv = System.IO.File.ReadAllText( path );
    var array = csv.Split(new[]{","}, StringSplitOptions.RemoveEmptyEntries);
    // Do the mapping with your databinding object
    var personArray = array.Select(p => new Person { Name = p}); 
   // You need to have this DataContext defined somewhere, for instance using LinqToSql
    using(var context = new PersonDataContext()){ 
        context.InsertAllOnSubmit(personArray);
        context.SubmitChanges();
    } 
}

// Imagine this class is one of linqToSql class
public class Person{
    public string Name {get;set;}
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T18:18:33.097

那么，您的意思是使用 Linq 吗？

像其中之一？
[http://blogs.msdn.com/b/wriju/archive/2009/05/24/linq-to-csv-getting-data-the-way-you-want.aspx](http://blogs.msdn.com/b/wriju/archive/2009/05/24/linq-to-csv-getting-data-the-way-you-want.aspx)
[http://blogs.msdn.com /b/ericwhite/archive/2008/09/30/linq-to-text-and-linq-to-csv.aspx](http://blogs.msdn.com/b/ericwhite/archive/2008/09/30/linq-to-text-and-linq-to-csv.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T18:27:21.590

您可以使用 Openrowsets 。

首先在 SQL 配置中启用 SQL Ad Hoc/Openrowset。启用后，您将能够连接 SQL Server 管理工作室并查询 Excel 和逗号分隔的文件。

您的查询将类似于：

```
SELECT * FROM OPENROWSET('MSDASQL','Driver={Microsoft Text Driver (*.txt; *.csv)};DefaultDir={your path}','SELECT * FROM ypurtextfile.csv') 
```

您可以在 C# 代码中使用这些查询，就像查询任何其他表一样。只需与您的经理核实他是否同意您在 SQL Server 上启用 ad hoc

# sql - 无法连接到 SQL Server 2005 本地主机

> ID：10624287
> 
> 赞同：3
> 
> 时间：2012-05-16T18:15:24.537
> 
> 标签：sql, sql-server-2005, localhost

我一直在尝试在我的本地主机上连接到 SQL Server 2005，但我无法连接......

> 服务器名称：（本地）\SQLEXPRESS
> 身份验证：Windows 身份验证

我尝试过的其他服务器名称是

> LOCALHOST\SQLEXPRESS
> （本地）\我的本地主机名

我收到此错误消息：

> 无法连接到 127.0.0.1\SQLEXPRESS。
> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。

SQL Server Browser 在服务中打开

有任何想法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-16T19:24:21.373

(1)

You need to verify (not just guess) that the SQL Server service is running. You can do this by going to Start > Control Panel > Administrative Tools > Services, and checking that the service `SQL Server (SQLEXPRESS)` is running. If not, start it.

(2)

While you're in the services applet, also make sure that the service `SQL Browser` is started. If not, start it.

(3)

You need to make sure that SQL Server is allowed to use TCP/IP or named pipes. You can turn these on by opening the SQL Server Configuration Manager (found under Start > Programs > Microsoft SQL Server 2005 > Configuration Tools), and make sure that TCP/IP and Named Pipes are enabled. Here my instance name is different but you can see that both of these protocols are disabled (you'll want to check under `Protocols for SQLEXPRESS`):

![enter image description here](../Images/c586621dec14b57e44619ed12683a089.png)

(You'll need to restart the SQL Server service if you change these settings.)

(4)

While it is no longer used in current versions of SQL Server, you'll also want to check the Surface Area Configuration tool. This is also found under Start > Programs > Microsoft SQL Server 2005 > Configuration Tools. Click on "Surface Area Configuration for Services and Connections", then highlight `SQLEXPRESS` (again my local instance name is `SQL2005` but pretend it's the same as yours), and under Database Engine > Remote Connections, enable "Local and remote connections" for the option "Using both TCP/IP and named pipes." In the screen shot below I only have TCP/IP enabled. If you change these settings, hit Apply, and again you'll need to restart SQL Server for the changes to take effect.

![enter image description here](../Images/8ded088fa8ba072c8d07c36a4667bd4e.png)

(This won't help your current problem but you may need to enable this if you want to connect to SQL Server from other machines, and it may also help future readers who are trying to connect to SQL Server 2005 remotely.)

(5)

It may also help to shut off Windows Firewall temporarily, in case you are blocking yourself somehow. (Control Panel > Windows Firewall)

(6)

Review SQL Server's error log. You can get to this file at a path something like:

`C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\LOG\`

(I don't have an Express instance handy so the path might be slightly different on your machine.)

Now, in that folder there will be a file called `ERRORLOG`... this is the most recent log file that was generated the last time SQL Server started. You can right-click this file and choose Open With... select notepad. You should see some lines like this:

> 2012-05... Authentication mode is MIXED.
> ...
> 2012-05...
> Server name is 'something\SQLEXPRESS'. This is an informational message only. No user action is required.
> ...
> 2012-05... Server local connection provider is ready to accept connection on [ \.\pipe\SQLLocal\SQLEXPRESS ].
> 2012-05... Server local connection provider is ready to accept connection on [ \.\pipe\MSSQL$SQLEXPRESS\sql\query ].
> 2012-05... Server is listening on [ ::1 49164].
> 2012-05... Server is listening on [ 127.0.0.1 49164].
> ...
> 2012-05... SQL Server is now ready for client connections. This is an informational message; no user action is required.

Please tell us which of these lines you *don't* see, and what the second line says where I wrote "something\SQLEXPRESS".

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T19:47:34.130

如果您已经安装了 VS2008，则再次重新安装 sqlexpress2005 部分，或者您需要另外安装该部分，然后它将自动修复其服务器名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-22T20:03:12.257

确保您已使用 SQL Server 配置管理器启用客户端协议。

# ruby-on-rails - 安装facebooker rails有什么问题？

> ID：10624293
> 
> 赞同：0
> 
> 时间：2012-05-16T18:15:41.583
> 
> 标签：ruby-on-rails, oauth, facebooker, authlogic-oauth

我尝试从这里[https://github.com/kalasjocke/authlogic_facebook_connect](https://github.com/kalasjocke/authlogic_facebook_connect)将 rails facebooker 安装到我的 authlogic gem ，但是如果 sudo gem install facebooker 我得到

```
from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:215:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:215:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:215:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:215:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:215:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:215:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:215:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:215:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:215:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:336:in `block in resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:335:in `resolve_requirement'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:287:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `reverse_each'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:286:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:160:in `start'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:128:in `block in resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:127:in `catch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/resolver.rb:127:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/definition.rb:151:in `resolve'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/definition.rb:90:in `specs'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/definition.rb:85:in `resolve_remotely!'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/installer.rb:43:in `run'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/installer.rb:8:in `install'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/cli.rb:219:in `install'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/vendor/thor/task.rb:22:in `run'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/vendor/thor/invocation.rb:118:in `invoke_task'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/vendor/thor.rb:263:in `dispatch'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/vendor/thor/base.rb:386:in `start'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/bin/bundle:13:in `<top (required)>'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290/bin/bundle:19:in `load'
        from /home/pavel/.rvm/gems/ruby-1.9.2-p290/bin/bundle:19:in `<main>' 
```

我的 Gemfile 看起来像这样：

```
source 'http://rubygems.org'

gem 'rails', '3.0.9'
gem 'compass'
gem 'haml-rails'
gem 'jquery-rails'
gem 'authlogic'
gem 'russian', '~> 0.6.0'
gem 'facebooker'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

group :assets do
  gem 'sass', '~>3.1'
  #gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer'

  gem 'uglifier', '>= 1.0.3'
end
gem 'mysql2', '< 0.3'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger (ruby-debug for Ruby 1.8.7+, ruby-debug19 for Ruby 1.9.2+)
# gem 'ruby-debug'
# gem 'ruby-debug19', :require => 'ruby-debug'

# Bundle the extra gems:
# gem 'bj'
# gem 'nokogiri'
# gem 'sqlite3-ruby', :require => 'sqlite3'
# gem 'aws-s3', :require => 'aws/s3'

# Bundle gems for the local environment. Make sure to
# put test-only gems in this group so their generators
# and rake tasks are available in development mode:
# group :development, :test do
#   gem 'webrat'
# end 
```

尝试从这里[https://github.com/kalasjocke/authlogic_facebook_connect将 rails facebooker 安装到我的 authlogic gems](https://github.com/kalasjocke/authlogic_facebook_connect)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:37:16.963

我推荐 RVM 并创建一个新的 gemset [RVM](https://rvm.io)

# c# - Linq to SQL 查询列，数据列中有空格

> ID：10624296
> 
> 赞同：-2
> 
> 时间：2012-05-16T18:15:55.793
> 
> 标签：c#, asp.net, sql-server, linq

使用 Linq to SQL

一个查询和匹配如何包含来自辅助表的所有行，其列中包含空格？

表格1：

```
ID  FAQ    MODELS 
1   faq1   model1 
2   faq2   model2 model1
3   faq3   model3 model2 model1   (Spaces in models column) 
```

表 2：

```
ID  MODELS PIC
1   model1 model1pic
2   model2 model2pic
3   model3 modal3pic 
```

期待：

```
faq1 model1 model1pic
faq2 model1 model1pic
faq2 model2 model2pic
faq3 model1 model1pic
faq3 model2 model2pic
faq3 model3 model3pic

SELECT kwfaqtmp.faqmodelnum, kwFAQtmp.issue,
kwfaqtmp.resolution, kwtable4tmp.modelnum,     
kwtable4tmp.prodpic 
FROM kwfaqtmp AS t1 CROSS APPLY dbo.SplitStrings(t1.faqmodelnum, ' ') AS s 
INNER JOIN dbo.kwtable4tmp 
AS t2 ON s.item COLLATE SQL_Latin1_General_CP1_CI_AS = t2.modelnum 
COLLATE SQL_Latin1_General_CP1_CI_AS 
ORDER BY t1.issue; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:19:39.173

如果您无法修复设计（您不应该将多条数据存储在单个列中，正如其他地方所指出的那样），您可以使用拆分功能来完成此操作：

```
CREATE FUNCTION dbo.SplitStrings
(
  @List  NVARCHAR(MAX),
  @Delim NCHAR(1)
)
RETURNS TABLE
AS
   RETURN ( SELECT DISTINCT Item FROM
       ( SELECT Item = x.i.value('(./text())[1]', 'nvarchar(max)')
         FROM ( SELECT [XML] = CONVERT(XML, '<i>'
         + REPLACE(@List, @Delim, '</i><i>') + '</i>').query('.')
           ) AS a CROSS APPLY [XML].nodes('i') AS x(i) ) AS y
       WHERE Item IS NOT NULL
   );
GO 
```

现在你可以说：

```
SELECT t1.FAQ, t2.MODELS, t2.PIC
FROM dbo.Table1 AS t1
CROSS APPLY dbo.SplitStrings(t1.MODELS, ' ') AS s
INNER JOIN dbo.Table2 AS t2
ON     s.Item COLLATE SQL_Latin1_General_CP1_CI_AS 
  = t2.Models COLLATE SQL_Latin1_General_CP1_CI_AS
ORDER BY t1.FAQ; 
```

结果：

```
FAQ   MODELS  PIC
----  ------  ---------
faq1  model1  model1pic
faq2  model1  model1pic
faq2  model2  model2pic
faq3  model1  model1pic
faq3  model2  model2pic
faq3  model3  modal3pic 
```

您尝试使用的查询：

```
 SELECT kwfaqtmp.faqmodelnum, kwFAQtmp.issue,kwfaqtmp.resolution, 
    kwtable4tmp.modelnum, kwtable4tmp.prodpic 
 FROM kwfaqtmp AS t1 
 CROSS APPLY dbo.SplitStrings(t1.faqmodelnum, ' ') AS s 
 INNER JOIN dbo.kwtable4tmp AS t2 
   ON s.item COLLATE SQL_Latin1_General_CP1_CI_AS 
     = t2.modelnum COLLATE SQL_Latin1_General_CP1_CI_AS 
 ORDER BY t1.issue; 
```

根本无效。尽管它不应该产生您在评论中引用的确切错误。保持 t1 / t2 别名作为我的原始查询显示如何？

```
 SELECT t1.faqmodelnum, t1.issue, t1.resolution, 
    t2.modelnum, t2.prodpic 
 FROM kwfaqtmp AS t1 
 CROSS APPLY dbo.SplitStrings(t1.faqmodelnum, ' ') AS s 
 INNER JOIN dbo.kwtable4tmp AS t2 
   ON s.item COLLATE SQL_Latin1_General_CP1_CI_AS 
     = t2.modelnum COLLATE SQL_Latin1_General_CP1_CI_AS 
 ORDER BY t1.issue; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:25:30.863

您应该在映射类中使用[ColumnAttribute](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.columnattribute.aspx)。创建一个带有不带空格的字段名的 POCO 类，映射到表中带空格的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:31:47.863

我认为你需要重构你的数据库。

```
FAQ (remove MODELS column)

ID  FAQ
1   faq1
2   faq2
3   faq3

FAQMODELS (Create this table)
ID FAQ   MODELS
1  faq1  model1
2  faq2  model2
3  faq2  model1
4  faq3  model3
5  faq3  model2
6  faq3  model1

MODELSPIC    
ID  MODELS PIC
1   model1 model1pic
2   model2 model2pic
3   model3 modal3pic 
```

那么你就可以

```
SELECT
    FAQ, 
    MODELS, 
    PIC 
FROM FAQMODELS INNER JOIN MODELSPIC ON FAQMODELS.MODELS = MODELSPIC.MODELS 
```

# php - 在 psql 查询中使用 proc_open() 进行交互式提示

> ID：10624298
> 
> 赞同：0
> 
> 时间：2012-05-16T18:15:58.037
> 
> 标签：php, postgresql, proc-open

我正在尝试从 Web 界面执行一些 PostgreSQL DB 命令。我使用 proc_open() 管道到 Windows 命令提示符。因为 psql（和所有其他 postgres 命令）不接受密码作为选项，所以我必须将密码发送到写入流。下面的代码会导致浏览器挂起。要么没有创建资源，要么没有正确传输密码。在这一点上，欢迎提出任何建议。

```
$cmd = '""C:\\Program files\\PostgreSQL\\9.0\\bin\\psql.exe" --host localhost --port 5432 -U postgres --dbname $database_name --command "$query""';
$p=proc_open($cmd, 
             array(array("pipe","r"), array("pipe","w"), array("pipe","w")), 
             $pipes);
if (is_resource($p)){
  fwrite($pipes[0],"mypassword");
  fclose($pipes[0]);
  proc_terminate($p);
  proc_close($p);                         
} 
```

[你会注意到命令中疯狂的双双引号——这显然是 windows 出于某种原因需要的。]

欢迎解决此问题：

*   我之前尝试过使用 system() 和 exec() 但因为它们不处理交互式提示而放弃了。php中是否有更好的交互选项？
*   pg_query() 是与 postgres DB 交互的主要命令，但不支持 pg_dump 和 pg_restore 操作。是否有另一种方法可以从二进制 postgres .backup 文件进行备份和恢复，可以用 php 完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T20:54:33.660

不要乱用密码提示，最好在`%APPDATA%\postgresql\pgpass.conf`. 格式为

```
hostname:port:database:username:password 
```

确保选择`%APPDATA%`运行网络服务器进程的用户。

如果您真的打算与提示进行交互，您可以尝试人们经常用于此类任务的[Expect](http://pecl.php.net/package/expect "预计")库......免责声明：我从未在 Windows 上使用过它，也不知道它在那里工作得如何，或者如果这确实是必要的。也许您的 fwrite 只是缺少一个终止换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:44:56.277

正如@c-ramseyer 所建议的那样，通过模拟交互式提示来搞乱是不可能`proc_open()`的。PostgreSQL 提供了两种方法来绕过通过交互式提示提供密码。方法（1）是将其作为环境变量提供，正如其他答案所建议的那样。`pgpass.conf`方法（2）是在DB用户的目录下创建一个文件`%appinfo%`。（要从 Windows 命令提示符中找到该目录`echo %appinfo%`。）请参阅 postgresql 了解如何制作这个单行 conf 文件。这些方法都不适合我，原因我仍然不明白。

为了解决这个问题，我不得不修改`ph_hda.conf`文件（PostgreSQL 客户端身份验证配置文件）以禁用身份验证。该文件位于`postgresql/data`目录中。我将底部的 2 行默认设置注释掉并替换为

```
#TYPE  DATABASE     USER        CIDR-ADDRESS       METHOD
host    all         all         127.0.0.1/32       trust     
host    all         all         ::1/128            trust 
```

现在，如果我从 php 调用 postgres，我会包含该`--no-password`选项并且吸盘可以工作。请注意，此解决方案不安全，仅在我的情况下才有意义，因为它被用于公司内部应用程序，机器离线运行。此方法不应用于生产站点，您的数据库将被黑客入侵。这是php代码。

```
$commande_restore = '""'.$postgres_bin_directory.'pg_restore" --host 127.0.0.1 --port 5432 -U postgres --no-password  -d '.$database_name.' '.$restore_file.'"';
$this->execute($commande_restore);      

function execute($cmd, $env = null){
  $proc=proc_open($cmd,array(0=>array('pipe','r'),1=>array('pipe','w'),2=>array('pipe','w')),$pipes, null, $env = null);
  //fwrite($pipes[0],$stdin);  //add to argument if you want to pass stdin                  
  fclose($pipes[0]);
  $stdout=stream_get_contents($pipes[1]);        fclose($pipes[1]);
  $stderr=stream_get_contents($pipes[2]);        fclose($pipes[2]);
  $return=proc_close($proc);    
  return array( 'stdout'=>$stdout, 'stderr'=>$stderr, 'return'=>$return );
} 
```

我花了将近 2 周的时间来解决这个问题，所以我希望它对某人有所帮助。

# codeigniter - 如何从 xampp 迁移到 appserv？

> ID：10624302
> 
> 赞同：0
> 
> 时间：2012-05-16T18:16:09.750
> 
> 标签：codeigniter, xampp

我有这个在xampp上开发和测试的codeigniter项目，当客户拿xampp在他的笔记本电脑上无法工作，所以他下载了appserv并想用它代替xampp，登录页面的主页系统显示正常，但他没有登录，我更改了 codeigniter 项目中 database.php 文件中的数据库，并且还删除了 httpd.conf 中重写角色之前的注释，但它没有任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T00:50:39.720

在 index.php 中将 CI 环境设置为 development 并将 error_reporting 设置为 E_ALL 并查看发生了什么问题。如果是数据库或会话，浏览器可能不接受 cookie 等。

好的，您可能有基本路径问题。检查 application/config/config.php 中的 $config["base_path"] 并将其设置为相对于 Web 服务器根目录的目录名称。

就像 XAMMP 通常

```
c:\xampp\htdocs\ 
```

项目网址可能是

```
c:\xampp\htdocs\projects\project_a 
```

那么你的 base_path 将是

$config["base_path"] = "procjects\project_a";

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-23T05:59:48.330

在 database.php 中，请确保在安装 appserv 时必须输入密码。[复制您在其中输入的密码](https://i.stack.imgur.com/swaM0.gif)

```
$config['hostname'] = 'localhost';
$config['username'] = 'root';
$config['password'] = 'your_password';
$config['database'] = 'your_database';
$config['dbdriver'] = 'mysqli';
$config['dbprefix'] = '';
$config['pconnect'] = FALSE;
$config['db_debug'] = TRUE;
$config['cache_on'] = FALSE;
$config['cachedir'] = '';
$config['char_set'] = 'utf8';
$config['dbcollat'] = 'utf8_general_ci'; 
```

用上面复制的密码替换“your_password”并检查它。

否则，在任务栏的左端，选择“开始”图标并搜索“重置 MySQL Root 密码”，点击它打开。

在命令窗口中，请输入 NEW_PASSWORD 并将其替换为您的 database.php

# knockout.js - 是否可以在计算中使用扩展器？

> ID：10624305
> 
> 赞同：4
> 
> 时间：2012-05-16T18:16:14.553
> 
> 标签：knockout.js

我有一个自定义绑定用于格式化百分比数字。

```
ko.bindingHandlers.textPercent = {
    //init: function (element, valueAccessor, allBindingsAccessor, viewModel) {
    //    //init logic 
    //},
    update: function (element, valueAccessor, allBindingsAccessor, viewModel) {
        var val = parseFloat(ko.utils.unwrapObservable(valueAccessor()));
        if ($.isNumeric(val)) {
            $(element).text((val * 100).toFixed(2))+"%";
        }
        else {
            $(element).text("#Error");
        }
    }
} 
```

用法：

```
<span data-bind="textPercent: amount" ></span>

<span data-bind="textPercent: amount()/2" ></span> 
```

它工作正常，但我希望能够使用不同数量的固定数字，所以我做了一个扩展器：

```
ko.extenders.percent = function (target, precision) {
    var result = ko.computed({
        read: function () {
            return (target()*100).toFixed(precision)+"%";
        },
        write: function (newValue) {
            target(parseFloat(newValue) / 100);
        }
    });
    return result;
}; 
```

用法：

```
<span data-bind="text: amount.extend({ percent: 2 })" ></span>

<span data-bind="text: (amount()/2).extend({ percent: 2 })" ></span> 
```

问题是它不适用于内联计算。

建议？

[http://jsfiddle.net/eRapL/4/](http://jsfiddle.net/eRapL/4/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T22:07:09.857

你必须用`ko.observable()`

例子：

```
text extend percent: <span data-bind="text: ko.observable(amount() / 2).extend({ percent: 2 })" ></span><br/> 
```

看：http: [//jsfiddle.net/c7Qx7/1/](http://jsfiddle.net/c7Qx7/1/)

# javascript - 价格更新有效，但不能多选并在最后打折

> ID：10624307
> 
> 赞同：0
> 
> 时间：2012-05-16T18:16:17.020
> 
> 标签：javascript, mysql, drop-down-menu

最后我有多个下拉列表计算总价，除了一些问题外，它的效果很好。

首先，我想添加更多的价格，所以它应该是：

总计：20.97 英镑

增值税：4.19 英镑

总金额：£25.16

我确定这很简单，但我想不出怎么做？

其次 - 它只适用于单个选择下拉列表，如果我想在一个列表中选择多个选项，它只会计算一个

这是我用来计算价格的代码：

```
$(function(){
    $(".calculate").on("change", function(){
        var total = 0;
        $('.calculate').each(function() {
            if($(this).val() != 0) {
                total += parseFloat($(this).val());
            }
        });
        $('#total').text('£' + total.toFixed(2));
    });

});//]]> 
```

第三，大约有 8 个下拉列表，但我希望最后一个对总价格进行折扣而不是添加到其中，上面的代码从每个选项的选项值中获取价格，折扣金额也是如此（在折扣列中数据库，它被写为 10%。

所以基本上，在 7 个列表之后，我应该总共有 20.97 英镑，然后一旦选择了最后一个列表，它应该用折扣金额替换价格，即 (-10%) 18.87 英镑

我非常接近完成这个，但我无法克服最后一个障碍。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:31:34.080

Javascript 是从数据库中提取 DDL 中的值还是硬编码到表单中？

% 的计算为 20.97 *0.10。由于 10% 是硬编码的，这应该适用于最终的下拉列表。

此外，除了向表单添加值和百分比计算之外，我不确定问题出在哪里，也许更多信息会有价值......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T20:15:31.720

当 SELECT 允许多选时，jQuery val() 函数返回一个值数组。因此，您的代码需要检测 val() 是否返回和数组，如果是，则循环数组并添加所有这些项目。这是一种方法：

```
$('.calculate').each(function() {
    var currentValue = $(this).val();
    if (currentValue.length != undefined) {
        for (var i = 0; i < currentValue.length; i++) {
            if (currentValue[i] != 0) {
                total += parseFloat(currentValue[i]);
            }
        }
    }
    else if(currentValue != 0) {
        total += parseFloat(currentValue);
    }
}); 
```

那应该照顾多个选择选项。对于折扣，只需获取最终 SELECT 的值并应用您的折扣：

```
var discount = parseFloat($('.discount').val()) / 100;
total = total - (total * discount); 
```

# jquery - CakePHP ajax 帖子不断返回 400 Bad Request

> ID：10624311
> 
> 赞同：6
> 
> 时间：2012-05-16T18:16:38.073
> 
> 标签：jquery, cakephp, post

我正在尝试使用 ajax 帖子来执行操作。GET 请求工作正常，但是当我尝试 POST 时，我在 firebug 中看到“400 Bad Request”，并且视图返回“黑洞”响应。

这是 Jquery 请求：

```
 $.ajax({
            url:"/usermgmt/users/editUser",
            type:"POST",
            success:function(data) {
                alert('Wow this actually worked');
                //ko.applyBindings(self);

            },
            error:function() {
                alert('This will never work');
            }
        }); 
```

这是由于 Cake 的安全设置还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-27T08:34:49.107

防止表单篡改是安全组件提供的基本功能之一。只要启用它，它就会将所有 POST 视为表单提交。

常规的手工编码 HTML 表单在启用安全组件的情况下无法使用，因此 JQuery 生成的 POST 也无法使用。当然，您可以使用安全组件提供的保护，但随后您会失去保护`$this->Security->validatePost = false;`。`$this->Security->csrfCheck = false;`

为了保持安全组件正常工作，您需要使用 CakePHP 表单助手来创建您将通过 ajax 发布的表单。这样，`data[_Token][fields]`和`data[_Token][unlocked]`隐藏字段就可以使用它们的键生成：

```
<?php 
    echo $this->Form->create('Test',array('id'=>'testform'));
    echo $this->Form->input('Something');
    echo $this->Form->submit();
    echo $this->Form->end();
?> 
```

这将生成如下内容：

```
<form action="/your/url" id="testform" method="post" accept-charset="utf-8">
    <div style="display:none;">
        <input type="hidden" name="_method" value="POST"/>
        <input type="hidden" name="data[_Token][key]" value="9704aa0281d8b5a2fcf628e9fe6f6c8410d8f07a" id="Token937294161"/>
    </div>
    <div class="input text">
        <input name="data[Test][Something]" class="required" type="text" id="TestSomething"/>
    </div>
    <div class="submit">
        <input  type="submit" />
    </div>
    <div style="display:none;">
        <input type="hidden" name="data[_Token][fields]" value="0c81fda1883cf8f8b8ab39eb15d355eabcfee7a9%3A" id="TokenFields817327064"/>
        <input type="hidden" name="data[_Token][unlocked]" value="" id="TokenUnlocked281911782"/>
    </div>
</form> 
```

现在只需在 JQuery 中序列化此表单，以便可以使用 ajax POST 发送它：

```
 $('#testform').submit(function(event) {
        $.ajax({
            type: 'POST',
            url: "/your/url",
            data: $('#testform').serialize(),
            success: function(data){ 
                alert('Wow this actually worked');
            },
            error:function() {
                alert('This will never work');
            }
        });
        event.preventDefault(); // Stops form being submitted in traditional way
    }); 
```

现在，如果您按下提交按钮，POST 将成功。

**重要提示：**由于表单助手的令牌只能与安全组件一起使用一次，因此此解决方案仅适用于您只打算在每页生成一次 POST 时。如果您需要能够在页面重新加载之间多次发布相同的表单，那么当您在控制器的开头添加安全组件时，您需要执行以下操作：

```
public $components = array(
    'Security' => array(
        'csrfUseOnce' => false
    )
); 
```

...这将允许令牌用于多个请求。它不*那么*安全，但您可以将其结合起来，`csrfExpires`以便令牌最终过期。这一切都记录在[Cake book 的 CSRF 配置部分](http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html#csrf-configuration)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-02T09:51:37.630

仅供参考，CakePHP 2.3 及更高版本现在包含仅用于此目的的 unlockedAction，用于您的控制器或 AppController 中的 beforeFilter 中。

```
$this->Security->unlockedActions = array('ajaxAction'); 
```

来自：[http ://book.cakephp.org/2.0/en/core-libraries/components/security-component.html#disabling-security-component-for-specific-actions](http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html#disabling-security-component-for-specific-actions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T00:04:37.907

确保您将函数 editUser 放入：

```
 public function beforeFilter(){
    parent::beforeFilter()
    $this->Auth->allow('editUser');
    } 
```

在用户控制器内部，

问候

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-25T01:35:47.770

约瑟夫的回答对我来说缺少一个细节。我的表单和 ajax 调用在 index.ctp 中并且正在调用 /controller/edit.ctp 所以我的 $this->Form->create 调用需要添加 'action'=>'/controller/edit'。

# c# - 使用 C# 将 AD 信息拉入 Excel

> ID：10624315
> 
> 赞同：0
> 
> 时间：2012-05-16T18:16:45.403
> 
> 标签：c#, excel, active-directory

我是 C# 新手，我希望使用 C# 从 Active Directory 中提取数据并将其输出到 Excel 文件中。我看过一些教程，对如何做到这一点感到困惑。我正在寻找获取用户 ID、部门和名称。我将如何使用 .FindAll() 功能来做到这一点？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.DirectoryServices;

namespace ADquery
 {
        class UserLookUp
    {
    static void Main(string[] args)
    {
        Console.WriteLine(retrieveUsers());
        Console.ReadLine();
    }

    public static string retrieveUsers()
    {

        string path = ("LDAP://OU=IS,OU=People,DC=Corporate,DC=Amfam,DC=com");

        //Init instance of DirectoryEntry
            DirectoryEntry dEntry = new DirectoryEntry(path);
            DirectorySearcher dSearcher = new DirectorySearcher(dEntry);

            //Establish filter (all users)?
            dSearcher.Filter = "(&(objectCategory=person)(objectClass=user)(cn=*))";

            foreach (SearchResult searchResults in dSearcher.FindAll())
            {
                if (searchResults.Properties["CN"][0].ToString() != null)
                {

                    //pull info desired
                    ResultPropertyValueCollection valueCollection =
                    searchResults.Properties["manager"];

                    foreach (Object propertyValue in valueCollection)
                    {
                        Console.WriteLine("Property Value: " + (string)propertyValue.ToString());
                    }

                    Console.WriteLine(" ");

                    catch ( InvalidOperationException iOe )
                    {

                            dSearcher.Dispose();
                    }

                    catch ( NotSupportedException nSe )
                    {

                    }

                    finally
                    {
                           if(sResults != null)
                               sResults.Dispose();
                    }

        /*

        // Create new Excel file.
           var excelFile = new ExcelFile();

       // Foreach DataTable, add new worksheet and insert data from DataTable into it.
           foreach (DataTable dataTable in dataSet.Tables)
               excelFile.Worksheets.Add(dataTable.TableName).InsertDataTable(dataTable, 0, 0, true);

       // Save Excel file to XLS format.
           excelFile.SaveXls(dataSet.DataSetName + ".xls"); *

       */

                }
            }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:56:44.553

它必须是这样的：

```
 public void WriteEntries(DirectoryEntry domainRoot)
    {
        DirectorySearcher searcher = new DirectorySearcher(domainRoot);
        searcher.PropertiesToLoad.Add("displayName");
        searcher.PropertiesToLoad.Add("cn");
        searcher.PropertiesToLoad.Add("department");
        searcher.Filter = "(&(objectCategory=person))";
        foreach (SearchResult result in searcher.FindAll())
        {
            // Login Name
            Console.WriteLine(GetProperty(result, "cn"));
            // Display Name
            Console.WriteLine(GetProperty(result, "displayName"));
            // Department
            Console.WriteLine(GetProperty(result, "department"));
        }
    }

    private string GetProperty(SearchResult searchResult, string PropertyName)
    {
        if (searchResult.Properties.Contains(PropertyName))
        {
            return searchResult.Properties[PropertyName][0].ToString();
        }
        else
        {
            return string.Empty;
        }
    } 
```

`WriteEntries`与根条目一起使用进行搜索。我在控制台中编写了它们，您可以将它们放在 excel 行中。对于使用 excel，我建议您使用[exellibrary](http://code.google.com/p/excellibrary/)。

# ios - MPMoviePlayerController 不会加载 HTTP 音频流

> ID：10624319
> 
> 赞同：0
> 
> 时间：2012-05-16T18:17:09.147
> 
> 标签：ios, http-streaming

我正在尝试在 iOS 上使用 MPMoviePlayerController 通过 HTTP 播放音频流。

我已经导入`MediaPlayer.framework`并使用了[MPMoviePlayerController 文档](http://developer.apple.com/library/IOs/#documentation/MediaPlayer/Reference/MPMoviePlayerController_Class/Reference/Reference.html)中的代码，但没有声音。

```
MPMoviePlayerController *player =
[[MPMoviePlayerController alloc] initWithContentURL:[NSURL URLWithString:@"http://shoutmedia.abc.net.au:10326"]];
[player prepareToPlay];
[player.view setFrame: self.view.bounds];  // player's frame must match parent's
[self.view addSubview: player.view];

[player play]; 
```

我也尝试过添加`player.movieSourceType = MPMovieSourceTypeStreaming;`，但也没有用。

有什么想法吗？

# asp.net-mvc - 是否可以操纵路由，使其看起来像 mvc .net 中的子域

> ID：10624323
> 
> 赞同：1
> 
> 时间：2012-05-16T18:17:42.387
> 
> 标签：asp.net-mvc, routing, subdomain

我想知道是否有一种解决方案可以将控制器路由设置为看起来像子域，例如 StoreController（其中 store 是特定商店的名称）

[http://store.myDomain.com/](http://store.myDomain.com/) {Parameter}/{Action}

这可以在 MVC (asp.net) 中执行还是我必须在服务器上创建子域？（<--这就是我要解决的问题）

... :)

# iphone - Objective C - 科学记数法“字符串”转换成双精度数

> ID：10624324
> 
> 赞同：2
> 
> 时间：2012-05-16T18:17:46.317
> 
> 标签：iphone, objective-c, parsing, double, nslog

我正在阅读具有大量这种格式的值的文本文件：1.36E-08

有没有办法将这个值“解析”（我认为这就是我需要的词）成双精度值？如果我直接分配它，它会给我 0。

```
//this NSLogs out "0.00000"
double x = 1.36E-08; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:38:58.200

我想你想要这个：

```
NSDecimalNumber *decNumber = [NSDecimalNumber decimalNumberWithString:@"1.36e-08"];

NSLog(@"Number -> %g", [decNumber doubleValue]); 
```

**输出：**

`Number -> 1.36e-08`

# hibernate - Hibernate，（netbeans 7.1.2，maven）无法使用 ElementCollection 属性

> ID：10624326
> 
> 赞同：0
> 
> 时间：2012-05-16T18:17:55.513
> 
> 标签：hibernate, maven, netbeans, netbeans-7, entitycollection

我的 SQL 数据库有一个“项目”表。每个“项目”可以有许多替代标签。这些存储在另一个名为“ItemAltLabel”的表中。外键是“ItemID”。

我试图在 java 中将其表示为具有一组字符串备用标签的实体。

我的财产如下所示：

```
@ElementCollection
@CollectionTable(name="ItemAltLabel", joinColumns=@JoinColumn(name="ItemID"))
@Column(name="Label")
private Set<String> alternateLabels; 
```

这应该是正确的吗？

我得到的错误是：

> org.springframework.beans.factory.BeanCreationException：创建名为“entityBroker”的bean时出错：注入自动装配的依赖项失败；嵌套异常是 org.springframework.beans.factory.BeanCreationException：无法自动装配字段：受保护的 org.hibernate.SessionFactory com.porism.dao.BaseBroker.sessionFactory；嵌套异常是 org.springframework.beans.factory.BeanCreationException：在 ServletContext 资源 [/WEB-INF/springmvc-servlet.xml] 中定义名称为“sessionFactory”的 bean 创建错误：调用 init 方法失败；嵌套异常是 org.hibernate.MappingException：无法确定类型：java.util.Set，对于列：[org.hibernate.mapping.Column(Label)]

我发现了这篇文章，这表明这是我正在使用的休眠版本中的一个错误：

[http://blog.m1key.me/2010/06/orghibernatemappingexception-could-not.html](http://blog.m1key.me/2010/06/orghibernatemappingexception-could-not.html)

“如果您在类似情况下遇到此错误，原因是您的 Hibernate 实现中存在错误，您应该获得更新的错误（我推荐 3.5.3-Final 或更高版本）。”</p>

我的 pom 文件引用了 3 个休眠依赖项：

```
<dependency>
  <groupId>org.hibernate</groupId>
  <artifactId>hibernate</artifactId>
  <version>3.2.5.ga</version>
</dependency>
<dependency>
  <groupId>org.hibernate</groupId>
  <artifactId>hibernate-entitymanager</artifactId>
  <version>3.3.2.GA</version>
</dependency>
<dependency>
  <groupId>org.hibernate</groupId>
  <artifactId>hibernate-core</artifactId>
  <version>3.3.2.GA</version>
</dependency> 
```

我已尝试将这些更新为 3.5.3-Final（如帖子所示）。

我的存储库如下所示：

http://ftp.ing.umu.se/mirror/eclipse/rt/eclipselink/maven.repo eclipselink default Repository for library Library[eclipselink] http://download.java.net/maven/2/hibernate-support default库库的存储库[hibernate-support]

我在尝试构建项目时遇到的错误是：

> 无法在项目 InformWebServices 上执行目标：无法解析项目 porism 的依赖项：InformWebServices:war:1.0：无法将工件 org.hibernate:hibernate:jar:3.5.3-Final 从/到 eclipselink (http://ftp. ing.umu.se/mirror/eclipse/rt/eclipselink/maven.repo）：连接到[http://ftp.ing.umu.se](http://ftp.ing.umu.se)被拒绝：连接超时：连接-> [帮助 1]

如果我去掉对hibernate 3.5.3-Final的依赖，其他两个依赖就下载成功了。项目建成；但出现了一个新错误：

> org.springframework.beans.factory.BeanCreationException：创建名为“entityBroker”的bean时出错：注入自动装配的依赖项失败；嵌套异常是 org.springframework.beans.factory.BeanCreationException：无法自动装配字段：受保护的 org.hibernate.SessionFactory com.porism.dao.BaseBroker.sessionFactory；嵌套异常是 org.springframework.beans.factory.BeanCreationException：在 ServletContext 资源 [/WEB-INF/springmvc-servlet.xml] 中定义名称为“sessionFactory”的 bean 创建错误：调用 init 方法失败；嵌套异常是 java.lang.NoClassDefFoundError: 无法初始化类 org.hibernate.cfg.AnnotationConfiguration

我正在使用 NetBeans 7.1.2 和 Maven。

正如您可能知道的那样，我接到了一个项目，但不知道我在做什么。任何帮助将不胜感激。

我尝试升级到 hibernate 4，但这导致了许多问题，我希望尽可能接近我使用的版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T22:04:38.860

不确定 org.hibernate:hibernate 依赖项应该指的是什么。但这肯定不是我们（Hibernate 团队）生产的罐子。

您应该可以只指定 org.hibernate:hibernate-entitymanager 依赖项。它实际上会传递 org.hibernate:hibernate-core 。这些是应该升级到3.5+的

# fluent-nhibernate - 共享列的流畅 NHibernate 关系

> ID：10624334
> 
> 赞同：0
> 
> 时间：2012-05-16T18:18:17.883
> 
> 标签：fluent-nhibernate

我有一个共享关系列的数据库。这是精简的表结构

```
Order
----------
OrderId int IDENTITY

OrderLine
----------
OrderId int NOT NULL
OrderLine int NOT NULL

OrderNote
----------
NoteId uniqueidentifier NOT NULL
OrderId int NOT NULL
OrderLineId int NULL 
```

基本上，OrderNote 表在 Order 和 OrderLine 之间共享。如果 OrderLineId 列为空，则说明属于订单。如果存在 OrderLineId 列，则说明属于订单行。这是我的课程的样子：

```
class Order {
    int OrderId {get; set;}
    IList<OrderLine> Lines {get;}
    IList<OrderNote> Notes {get;}
}

class OrderLine {
    int OrderLineId {get; set;}
    Order Order {get; set;}
    IList<OrderNote> Notes {get;}
}

class OrderNote {
    Order Order {get; set;}
    OrderLine Line {get; set;}
    Guid NoteId {get; set;}
} 
```

如果 OrderNote.Line 为空，则说明仅属于订单。如果 OrderNote.Line 不为空，则注释属于订单和行。这是我的映射的样子：

```
class OrderClassMap {
    Id(x => x.OrderId).Generated.Identity();
    HasMany(x => x.Lines).Inverse().KeyColumn("OrderId");
    HasMany(x => x.Notes).Inverse().KeyColumn("OrderId");
}

class OrderLineClassMap {
    CompositeId().KeyReference(x => x.Order, "OrderId").KeyProperty(x => x.OrderLineId);
    HasMany(x => x.Notes).Inverse().KeyColumns.Add("OrderId", "OrderLineId");
}

class OrderNoteClassMap {
    Id(x => x.NoteId).Generated.Assigned();
    References(x => x.Order).Column("OrderId");
    References(x => x.Line).Columns("OrderId", "OrderLineId");
} 
```

当我尝试保存新的 OrderNote 时，我收到一条错误消息：“此 SqlParameterCollection 的索引 11 无效，Count=11。如何正确建模和映射它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T06:01:03.353

您似乎在谈论每个订单仅 1 个便笺和每个订单行 1 个便笺？如果是这样，请将注释映射为按顺序排列的列，同时也是订单行的注释列。这将对具有较少连接和简单查询的性能产生重大影响 - （否则您需要左外连接和合并语句）。

如果每个订单和订单行可以有多个注释，则创建单独的 ordernote 和 orderlinenote 值对象。取决于每个订单/订单行需要多于 1 个票据。倾向于每个实体 1 个注释，因为这是最简单的并且提供最佳性能，并且 ordernote 和 orderlinenote 在域设计方面是不同的。

```
class Order {
    int OrderId {get; set;}
    IList<OrderLine> Lines {get;}
    string Note {get;set;}
}

class OrderLine {
    int OrderLineId {get; set;}
    Order Order {get; set;}
    string Note {get;set}
} 
```

或者

```
class Order {
    int OrderId {get; set;}
    IList<OrderLine> Lines {get;}
    IList<OrderNote> Notes {get;}
}

class OrderNote {
    int Id {get;set}
    Order Order {get; set;}
    string Note {get; set;}
}

class OrderLine {
    int OrderLineId {get; set;}
    Order Order {get; set;}
    IList<OrderLineNote> Notes {get;}
}

class OrderLineNote {
    int Id {get; set;}
    OrderLine OrderLine {get; set;}
    string Note {get;set}
} 
```

# iphone - 何时从 Sandbox 切换到生产 StoreKit 服务器？

> ID：10624342
> 
> 赞同：6
> 
> 时间：2012-05-16T18:18:42.563
> 
> 标签：iphone, ios, ipad, storekit, appstore-sandbox

我最近向 iTunes 提交了一个应用程序内购买的应用程序。我应该在什么特定时间从使用沙盒服务器切换到生产服务器？

现在？还是批准后？

我可以随时在服务器上的 php 文件中切换。

我查看了 StoreKit 文档，他们并没有真正说明这一点。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T21:29:53.663

我在 StoreKit[常见问题解答](https://developer.apple.com/library/ios/#technotes/tn2259/_index.html#//apple_ref/doc/uid/DTS40009578-CH1-FREQUENTLY_ASKED_QUESTIONS)中找到了答案：

> 我应该使用什么 url 来验证我的收据 (iOS)？
> 
> ```
> Use the sandbox URL https://sandbox.itunes.apple.com/verifyReceipt while testing your application in the sandbox and while your application is in review.
> 
> Use the production URL http://buy.itunes.apple.com/verifyReceipt once your application is live in the App Store. 
> ```

唯一我仍然不明白的是，如果在应用程序上线进行切换时我不在电脑旁怎么办？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T21:39:54.237

更多来自常见问题解答：

始终首先使用生产 URL 验证您的收据；如果您收到 21007 状态代码，请继续使用沙盒 URL 进行验证。遵循这种方法可确保您在沙盒中测试或审查您的应用程序或在 App Store 中运行时不必在 URL 之间切换。

注意：21007状态码表示此收据是沙箱收据，但已发送到生产服务进行验证。

# iphone - 如果在 iPhone 上使用 phonegap plain，我如何让 Facebook 在登录后返回我的应用程序？

> ID：10624343
> 
> 赞同：0
> 
> 时间：2012-05-16T18:18:45.653
> 
> 标签：iphone, ipad, cordova, facebook-javascript-sdk, facebook-login

我有一个 phonegap 应用程序，我使用 Facebook 插件来实现单点登录。我注册的是一个原生 iPhone 应用程序，因为该应用程序不在浏览器中运行。当我单击登录时，我收到无效的 URL 错误消息。我怀疑我的问题是我需要指定一个我曾尝试在 init 中使用通道的 URL，但我得到一个此配置不允许的 URL。另一个问题可能是我需要将此应用程序注册为 Web 应用程序。但是，使用 phonegap 应用程序没有 url。我不知道该怎么办。

任何帮助表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:37:10.070

您是否查看了插件自述文件的[iOS URL 方案](https://github.com/davejohnson/phonegap-plugin-facebook-connect#ios-url-scheme)部分？

# android - 音频数据有问题

> ID：10624347
> 
> 赞同：0
> 
> 时间：2012-05-16T18:19:19.303
> 
> 标签：android, audio

我相信主要问题来自 MicrophoneManager 中的读取方法，但看不到问题出在哪里。我的 bytesread 控制台输出为 0（这是在另一个类 AudioTransmitter 中）。在我看来，它不是流式传输音频数据，因为发送的数据没有变化，就像我说的读取字节数为 0。

```
 public class MicrophoneManager{
    //  private     TargetDataLine   targetDataLine;
      private   float            sampleRate       = 8000.0F;    //8000,11025,16000,22050,44100
      private   int              sampleSizeInBits = 16;         //8,16
      private   int              channels         = 1;          //1,2
      private   boolean          signed           = true;       //true,false
      private   boolean          bigEndian        = false;      //true,false
      private   AudioFormat      audioFormat;
    //  private AudioRecord      audioRecord;
    //  private AudioInputStream ais;
      private static MicrophoneManager singletonMicrophoneManager = null;

      public AudioRecord audioRecord; 
      public int mSamplesRead; //how many samples read 
      public int buffersizebytes; 
      public int buflen; 
      public int channelConfiguration = AudioFormat.CHANNEL_CONFIGURATION_MONO; 
      public int audioEncoding = AudioFormat.ENCODING_PCM_16BIT; 
      public static byte[] buffer; //+-32767 
      public static final int SAMPPERSEC = 8000; //samp per sec 8000, 11025, 22050 44100 or 48000 

      public class MicrophoneManager{
//  private     TargetDataLine   targetDataLine;
  private   float            sampleRate       = 8000.0F;    //8000,11025,16000,22050,44100
  private   int              sampleSizeInBits = 16;         //8,16
  private   int              channels         = 1;          //1,2
  private   boolean          signed           = true;       //true,false
  private   boolean          bigEndian        = false;      //true,false
  private   AudioFormat      audioFormat;
//  private AudioRecord      audioRecord;
//  private AudioInputStream ais;
  private static MicrophoneManager singletonMicrophoneManager = null;

  public AudioRecord audioRecord; 
  public int mSamplesRead; //how many samples read 
  public int buffersizebytes; 
  public int buflen; 
  public int channelConfiguration = AudioFormat.CHANNEL_CONFIGURATION_MONO; 
  public int audioEncoding = AudioFormat.ENCODING_PCM_16BIT; 
  public static short[] buffer; //+-32767 
  public static final int SAMPPERSEC = 8000; //samp per sec 8000, 11025, 22050 44100 or 48000 

  public MicrophoneManager() { 
      System.out.println("Initializing");   
//      audioFormat = new AudioFormat(sampleRate,sampleSizeInBits,channels,signed,bigEndian);

//      audioRecord = new AudioRecord(MediaRecorder.AudioSource.DEFAULT, (int) sampleRate, channels, AudioFormat.ENCODING_PCM_16BIT, buffersizebytes);

      buffersizebytes = AudioRecord.getMinBufferSize(SAMPPERSEC,channelConfiguration,audioEncoding); //4096 on ion 
      buffer = new short[buffersizebytes]; 
      buflen=buffersizebytes/2; 
      audioRecord = new AudioRecord(android.media.MediaRecorder.AudioSource.MIC,SAMPPERSEC, 
      channelConfiguration,audioEncoding,buffersizebytes); //constructor       
  }

  public static MicrophoneManager getMicrophoneManager() throws Exception {
      if (singletonMicrophoneManager == null) {
          singletonMicrophoneManager = new MicrophoneManager();
          singletonMicrophoneManager.initialize();
      }
      return singletonMicrophoneManager;
  }

  public void initialize() throws Exception {      
  }

  public void startAudioInput(){

      try { 
          audioRecord.startRecording(); 
          mSamplesRead = audioRecord.read(buffer, 0, buffer.length); 
          audioRecord.stop(); 
          } catch (Throwable t) { 
          // Log.e("AudioRecord", "Recording Failed"); 
              System.out.println("Error Starting audio input"+t);
          } 
  }

  public void stopAudioInput(){
      audioRecord.stop(); 
      System.out.println("Stopping audio input");         
  }

  public void finishAudioInput(){
      audioRecord.release(); 
      System.out.println("Finishing audio input");        
  }

  public boolean available() throws Exception {
      return true;
  }

  public int read(byte[] inBuf) throws Exception {
     return audioRecord.read(inBuf,0,inBuf.length);
  }    

} 
```

音频发射器：

```
public class AudioTransmitter extends Thread{

    private MicrophoneManager mm=null;
    private boolean transmittingAudio = false;
    private String host;
    private int port;
    private long id=0;
    boolean run=true;

    public AudioTransmitter(String host, int port, long id) {
        this.host = host;
        this.port = port;
        this.id = id;
        this.start();
    }

    public void run() {

        System.out.println("creating audio transmitter host "+host+" port "+port+" id "+id);

        TrustManager[] trustAllCerts = new TrustManager[]{
                new X509TrustManager() {
                    public java.security.cert.X509Certificate[] getAcceptedIssuers() {
                        return null;
                    }
                    public void checkClientTrusted(
                            java.security.cert.X509Certificate[] certs, String authType) {
                    }
                    public void checkServerTrusted(
                            java.security.cert.X509Certificate[] chain, String authType) {
                        for (int j=0; j<chain.length; j++)
                        {
                            System.out.println("Client certificate information:");
                            System.out.println("  Subject DN: " + chain[j].getSubjectDN());
                            System.out.println("  Issuer DN: " + chain[j].getIssuerDN());
                            System.out.println("  Serial number: " + chain[j].getSerialNumber());
                            System.out.println("");
                        }
                    }
                }
        };

        while (run) {
            if(transmittingAudio) {

                try {
                    if(mm==null) {
                        mm = new MicrophoneManager();
//                      mm.initialize();
                    }
                    SSLContext sc = SSLContext.getInstance("SSL");
                    sc.init(null, trustAllCerts, new java.security.SecureRandom());
                    SSLSocketFactory sslFact = sc.getSocketFactory();
                    SSLSocket socket = (SSLSocket)sslFact.createSocket(host, port);

                    socket.setSoTimeout(10000);
                    InputStream inputStream = socket.getInputStream();
                    DataInputStream in = new DataInputStream(new BufferedInputStream(inputStream));
                    OutputStream outputStream = socket.getOutputStream();
                    DataOutputStream os = new DataOutputStream(new BufferedOutputStream(outputStream));
                    PrintWriter socketPrinter = new PrintWriter(os);
                    BufferedReader br = new BufferedReader(new InputStreamReader(in));

//                  socketPrinter.println("POST /transmitaudio?patient=1333369798370 HTTP/1.0");
                    socketPrinter.println("POST /transmitaudio?id="+id+" HTTP/1.0");
                    socketPrinter.println("Content-Type: audio/basic");
                    socketPrinter.println("Content-Length: 99999");
                    socketPrinter.println("Connection: Keep-Alive");
                    socketPrinter.println("Cache-Control: no-cache");
                    socketPrinter.println();
                    socketPrinter.flush();

//                  in.read();

                    mm.startAudioInput();

                    int buffersizebytes = AudioRecord.getMinBufferSize(8000, AudioFormat.CHANNEL_CONFIGURATION_MONO,AudioFormat.ENCODING_PCM_16BIT); //4096 on ion 

                    System.out.println("audio started");
                    byte[] data = new byte[buffersizebytes];
                    while(transmittingAudio) {
                            //              byte[] data = new byte[mm.available()];
                            int bytesRead = mm.read(data);
                            os.write(data,0,bytesRead);
                            os.flush();
                            //              ca.transmitAxisAudioPacket(data);
//                          System.out.println("read "+data);
                            System.out.println("bytesRead "+bytesRead);
                            System.out.println("data "+Arrays.toString(data));
                    }
                    os.close();
                    mm.stopAudioInput();
                } catch (Exception e) {
                    System.out.println("excpetion while transmitting audio connection will be closed"+e);
                    transmittingAudio=false;
                }
            }
            else {
                try {
                Thread.sleep(1000);
                } catch (Exception e){
                    System.out.println("exception while thread sleeping"+e);}
            }
        }

    }

    public void setTransmittingAudio(boolean transmittingAudio) {
        this.transmittingAudio = transmittingAudio;
    }

    public void finished() {
        this.transmittingAudio = false;
        mm.finishAudioInput();
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T19:42:53.773

你在打电话

```
mSamplesRead = audioRecord.read(buffer, 0, buffersizebytes); 
```

有一些问题。

`audioRecord.read()`想要您正在读取的数组的长度，而不是字节大小。您已将编码设置为 16 位。你真的应该做类似的事情：

```
new short[] buffer = short[1024]; // or whatever length you like
mSampleRead = audioRecord.read(buffer,0,buffer.length); 
```

你打电话来阅读`buffersizebytes`，但你设置了`buffer = new byte[1024];`. 没有特别的理由认为`buffersizebytes`存在正确的数字吗？您想要一个`short[]`具有 16 位编码的数组，并且您希望读取的**SAMPLES**（不是字节）的数量小于或等于`short[] buffer`.

此外，如果您打印出抛出异常时得到的异常，您将处于更好的状态，更改

```
System.out.println("Error Starting audio input"); 
```

到

```
System.out.println("Error Starting audio input" + t); 
```

你至少会知道为什么 android 会把你扔进垃圾箱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T15:37:42.267

谢谢你们的帮助，但是我找到了一种更好的方法来做需要的事情（[在这里](https://stackoverflow.com/questions/6959930/android-need-to-record-mic-input)）。这是代码。请注意，这也使用[http://www.devdaily.com/java/jwarehouse/android/core/java/android/speech/srec/UlawEncoderInputStream.java.shtml](http://www.devdaily.com/java/jwarehouse/android/core/java/android/speech/srec/UlawEncoderInputStream.java.shtml)将音频转换为 ulaw

```
public class AudioWorker extends Thread
{ 
    private boolean stopped = false;

    private String host;
    private int port;
    private long id=0;
    boolean run=true;
    AudioRecord recorder;

    //ulaw encoder stuff
    private final static String TAG = "UlawEncoderInputStream";

    private final static int MAX_ULAW = 8192;
    private final static int SCALE_BITS = 16;

    private InputStream mIn;

    private int mMax = 0;

    private final byte[] mBuf = new byte[1024];
    private int mBufCount = 0; // should be 0 or 1

    private final byte[] mOneByte = new byte[1];
    ////
    /**
     * Give the thread high priority so that it's not canceled unexpectedly, and start it
     */
    public AudioWorker(String host, int port, long id)
    { 
        this.host = host;
        this.port = port;
        this.id = id;
        android.os.Process.setThreadPriority(android.os.Process.THREAD_PRIORITY_URGENT_AUDIO);
//        start();
    }

    @Override
    public void run()
    { 
        Log.i("AudioWorker", "Running AudioWorker Thread");
        recorder = null;
        AudioTrack track = null;
        short[][]   buffers  = new short[256][160];
        int ix = 0;

        /*
         * Initialize buffer to hold continuously recorded AudioWorker data, start recording, and start
         * playback.
         */
        try
        {
            int N = AudioRecord.getMinBufferSize(8000,AudioFormat.CHANNEL_IN_MONO,AudioFormat.ENCODING_PCM_16BIT);
            recorder = new AudioRecord(AudioSource.MIC, 8000, AudioFormat.CHANNEL_IN_MONO, AudioFormat.ENCODING_PCM_16BIT, N*10);
            track = new AudioTrack(AudioManager.STREAM_MUSIC, 8000, 
                    AudioFormat.CHANNEL_OUT_MONO, AudioFormat.ENCODING_PCM_16BIT, N*10, AudioTrack.MODE_STREAM);
            recorder.startRecording();
            track.play();
            /*
             * Loops until something outside of this thread stops it.
             * Reads the data from the recorder and writes it to the AudioWorker track for playback.
             */

            SSLContext sc = SSLContext.getInstance("SSL");
            sc.init(null, trustAllCerts, new java.security.SecureRandom());
            SSLSocketFactory sslFact = sc.getSocketFactory();
            SSLSocket socket = (SSLSocket)sslFact.createSocket(host, port);

            socket.setSoTimeout(10000);
            InputStream inputStream = socket.getInputStream();
            DataInputStream in = new DataInputStream(new BufferedInputStream(inputStream));
            OutputStream outputStream = socket.getOutputStream();
            DataOutputStream os = new DataOutputStream(new BufferedOutputStream(outputStream));
            PrintWriter socketPrinter = new PrintWriter(os);
            BufferedReader br = new BufferedReader(new InputStreamReader(in));

//          socketPrinter.println("POST /transmitaudio?patient=1333369798370 HTTP/1.0");
            socketPrinter.println("POST /transmitaudio?id="+id+" HTTP/1.0");
            socketPrinter.println("Content-Type: AudioWorker/basic");
            socketPrinter.println("Content-Length: 99999");
            socketPrinter.println("Connection: Keep-Alive");
            socketPrinter.println("Cache-Control: no-cache");
            socketPrinter.println();
            socketPrinter.flush();

            while(!stopped)
            { 
                Log.i("Map", "Writing new data to buffer");
                short[] buffer = buffers[ix++ % buffers.length];

                N = recorder.read(buffer,0,buffer.length);
                track.write(buffer, 0, buffer.length);

                byte[] bytes2 = new byte[buffer.length * 2];
                ByteBuffer.wrap(bytes2).order(ByteOrder.LITTLE_ENDIAN).asShortBuffer().put(buffer);

                read(bytes2, 0, bytes2.length);
//              os.write(bytes2,0,bytes2.length);
                os.write(bytes2,0,bytes2.length);

                System.out.println("bytesRead "+buffer.length);
                System.out.println("data "+Arrays.toString(buffer));
            }
            os.close();
        }
        catch(Throwable x)
        { 
            Log.w("AudioWorker", "Error reading voice AudioWorker", x);
        }
        /*
         * Frees the thread's resources after the loop completes so that it can be run again
         */
        finally
        { 
            recorder.stop();
            recorder.release();
            track.stop();
            track.release();
        }
    }

    /**
     * Called from outside of the thread in order to stop the recording/playback loop
     */

/**
 * Called from outside of the thread in order to stop the recording/playback loop
 */
public void close()
{ 
     stopped = true;
}
public void resumeThread()
{ 
     stopped = false;
     run();
}

    TrustManager[] trustAllCerts = new TrustManager[]{
            new X509TrustManager() {
                public java.security.cert.X509Certificate[] getAcceptedIssuers() {
                    return null;
                }
                public void checkClientTrusted(
                        java.security.cert.X509Certificate[] certs, String authType) {
                }
                public void checkServerTrusted(
                        java.security.cert.X509Certificate[] chain, String authType) {
                    for (int j=0; j<chain.length; j++)
                    {
                        System.out.println("Client certificate information:");
                        System.out.println("  Subject DN: " + chain[j].getSubjectDN());
                        System.out.println("  Issuer DN: " + chain[j].getIssuerDN());
                        System.out.println("  Serial number: " + chain[j].getSerialNumber());
                        System.out.println("");
                    }
                }
            }
    };

    public static void encode(byte[] pcmBuf, int pcmOffset,
            byte[] ulawBuf, int ulawOffset, int length, int max) {

        // from  'ulaw' in wikipedia
        // +8191 to +8159                          0x80
        // +8158 to +4063 in 16 intervals of 256   0x80 + interval number
        // +4062 to +2015 in 16 intervals of 128   0x90 + interval number
        // +2014 to  +991 in 16 intervals of  64   0xA0 + interval number
        //  +990 to  +479 in 16 intervals of  32   0xB0 + interval number
        //  +478 to  +223 in 16 intervals of  16   0xC0 + interval number
        //  +222 to   +95 in 16 intervals of   8   0xD0 + interval number
        //   +94 to   +31 in 16 intervals of   4   0xE0 + interval number
        //   +30 to    +1 in 15 intervals of   2   0xF0 + interval number
        //     0                                   0xFF

        //    -1                                   0x7F
        //   -31 to    -2 in 15 intervals of   2   0x70 + interval number
        //   -95 to   -32 in 16 intervals of   4   0x60 + interval number
        //  -223 to   -96 in 16 intervals of   8   0x50 + interval number
        //  -479 to  -224 in 16 intervals of  16   0x40 + interval number
        //  -991 to  -480 in 16 intervals of  32   0x30 + interval number
        // -2015 to  -992 in 16 intervals of  64   0x20 + interval number
        // -4063 to -2016 in 16 intervals of 128   0x10 + interval number
        // -8159 to -4064 in 16 intervals of 256   0x00 + interval number
        // -8192 to -8160                          0x00

        // set scale factors
        if (max <= 0) max = MAX_ULAW;

        int coef = MAX_ULAW * (1 << SCALE_BITS) / max;

        for (int i = 0; i < length; i++) {
            int pcm = (0xff & pcmBuf[pcmOffset++]) + (pcmBuf[pcmOffset++] << 8);
            pcm = (pcm * coef) >> SCALE_BITS;

            int ulaw;
            if (pcm >= 0) {
                ulaw = pcm <= 0 ? 0xff :
                        pcm <=   30 ? 0xf0 + ((  30 - pcm) >> 1) :
                        pcm <=   94 ? 0xe0 + ((  94 - pcm) >> 2) :
                        pcm <=  222 ? 0xd0 + (( 222 - pcm) >> 3) :
                        pcm <=  478 ? 0xc0 + (( 478 - pcm) >> 4) :
                        pcm <=  990 ? 0xb0 + (( 990 - pcm) >> 5) :
                        pcm <= 2014 ? 0xa0 + ((2014 - pcm) >> 6) :
                        pcm <= 4062 ? 0x90 + ((4062 - pcm) >> 7) :
                        pcm <= 8158 ? 0x80 + ((8158 - pcm) >> 8) :
                        0x80;
            } else {
                ulaw = -1 <= pcm ? 0x7f :
                          -31 <= pcm ? 0x70 + ((pcm -   -31) >> 1) :
                          -95 <= pcm ? 0x60 + ((pcm -   -95) >> 2) :
                         -223 <= pcm ? 0x50 + ((pcm -  -223) >> 3) :
                         -479 <= pcm ? 0x40 + ((pcm -  -479) >> 4) :
                         -991 <= pcm ? 0x30 + ((pcm -  -991) >> 5) :
                        -2015 <= pcm ? 0x20 + ((pcm - -2015) >> 6) :
                        -4063 <= pcm ? 0x10 + ((pcm - -4063) >> 7) :
                        -8159 <= pcm ? 0x00 + ((pcm - -8159) >> 8) :
                        0x00;
            }
            ulawBuf[ulawOffset++] = (byte)ulaw;
        }
    }
    public static int maxAbsPcm(byte[] pcmBuf, int offset, int length) {
        int max = 0;
        for (int i = 0; i < length; i++) {
            int pcm = (0xff & pcmBuf[offset++]) + (pcmBuf[offset++] << 8);
            if (pcm < 0) pcm = -pcm;
            if (pcm > max) max = pcm;
        }
        return max;
    }

    public int read(byte[] buf, int offset, int length) throws IOException {
        if (recorder == null) throw new IllegalStateException("not open");

        // return at least one byte, but try to fill 'length'
        while (mBufCount < 2) {
            int n = recorder.read(mBuf, mBufCount, Math.min(length * 2, mBuf.length - mBufCount));
            if (n == -1) return -1;
            mBufCount += n;
        }

        // compand data
        int n = Math.min(mBufCount / 2, length);
        encode(mBuf, 0, buf, offset, n, mMax);

        // move data to bottom of mBuf
        mBufCount -= n * 2;
        for (int i = 0; i < mBufCount; i++) mBuf[i] = mBuf[i + n * 2];

        return n;
    }

} 
```

# c++ - 没有输入时结束循环

> ID：10624349
> 
> 赞同：0
> 
> 时间：2012-05-16T18:19:22.920
> 
> 标签：c++

通常我编写一个控制循环如下：进入的循环将整数写入向量 nVec，直到输入“完成”。

```
while (cin >> sString){
    if (sString="done")
    { 
        break;
    }
    nVec.push_back(sString);

} 
```

这很好用，但是如果我希望在用户没有输入任何内容（只是按下回车键）后循环结束，我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:33:35.717

您不能在令牌提取中“不输入任何内容”。停止循环的唯一方法是让用户发送文件结尾（Linux 上的 Ctrl-D）。我个人会说这是正确的行为，但如果你想以空输入结束，你需要阅读以下行：

```
Sales_item total;

for (std::string line; std::getline(std::cin, line); )
{
     if (line.empty()) { exit_program(); /* or "break" */ }

     std::istringstream iss(line);
     for (Sales_item book; iss >> book; )
     {
          total += book;
          std::cout << "The current total is " << total << std::endl;
     }
} 
```

这样，您将每一行标记为可能的多本书。如果您只想每行一本书，请撕掉内部循环并说`std::istringstream(line) >> book;`.

# arbor.js - arbor.js 中的不同边缘

> ID：10624359
> 
> 赞同：1
> 
> 时间：2012-05-16T18:20:18.940
> 
> 标签：arbor.js

如何使用 arbor.js 绘制不重叠的边缘？例如，我的图中有 2 个节点 A 和 B。有一条来自 A->B 的有向边和一条来自 B->A 的有向边。如何以不重叠的方式显示这些边缘？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T12:57:50.377

好吧，您可以使用边缘渲染器，因此您可以在画布中的两点之间绘制一条弧线...（为此，请使用particlesystem.eachedge 并查看B 和A 是否连接，然后制作一个弧形边缘）

# python - 仅将 Python 列表中的日期时间转换为年份

> ID：10624360
> 
> 赞同：5
> 
> 时间：2012-05-16T18:20:22.593
> 
> 标签：python, pyodbc

所以我使用 pyodbc 将 MS Access 中的日期时间字段添加到 Python 列表中。当我这样做时，它 pyodbc 立即将数据转换为这种格式`datetime.datetime(2012, 1, 1,0,0)`。`2012`在这种情况下，我只对获得年份感兴趣。当它使用这种格式时，如何从我的列表中解析年份？也许 pyodbc 有一些我可以在它进入列表之前使用的语法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-16T18:22:40.037

```
>>> dt = datetime.datetime(2012, 1, 1,0,0)
>>> dt.year
2012 
```

只是为了记录，`datetime.datetime`不是“值列表”，它是一个类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:27:40.443

您可以从每个日期时间对象中获取年份并形成一个新列表。

```
years = [x.year for x in your_list] 
```

# windows - 为什么 CoCreateInstance 返回错误 0x8007007f “找不到指定的过程”？

> ID：10624362
> 
> 赞同：1
> 
> 时间：2012-05-16T18:20:25.570
> 
> 标签：windows, com, 32bit-64bit

在 Windows 7 中，我在 DLL 中有一个 COM 对象，假设它是`my_COM_object.dll`.

我有两个版本的 dll，一个是 32 位的，一个是 64 位的，第一个存在`c:\bin32\`于`c:\bin64\`.

我做了`regsvr32 c:\bin32\my_COM_object.dll`，然后我尝试用它创建 32 位 COM 对象，`CoCreateInstance`但创建失败，错误是`0x8007007f`“找不到指定的过程”。

错误的原因可能是什么？

我很着急，我用蛮力技术解决了这个问题：我删除了注册表中相关的所有键，`my_COM_object.dll`然后我又做了一次，`regsvr32 c:\bin32\my_COM_object.dll`但我想知道是什么`0x8007007f`意思：它似乎没有很好的文档记录。

# css - 如何应用 css 并将 css 保存到文本框

> ID：10624366
> 
> 赞同：0
> 
> 时间：2012-05-16T18:20:49.813
> 
> 标签：css

我有一个带有一些由 formHandler 方法创建的 CSS 属性的文本框。当我检查文本框为空并通过 jquery 代码在边框中应用另一个 css 类时，代码如下

```
 $('a,button').click(function () {
        if($("#FHE_0_first_name").val()=="")
            {
            $("#FHE_0_first_name").addClass("errorCSS");
            }
    }); 
```

我的CSS在下面

```
.errorCSS
{
    clear:both;
    border:1px solid #ff0000 !important;
    background-color:#ffeeee !important;

} 
```

红色和背景色刚来就消失了，我怎么能保留 neww css。

感谢所有建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:28:38.100

首先，您需要将 $(a,button) 选择器更改为 $(a.button)。

# javascript - 使用 jQuery 以百分比形式获取 html 元素的宽度

> ID：10624368
> 
> 赞同：0
> 
> 时间：2012-05-16T18:21:00.810
> 
> 标签：javascript, jquery

如果我`alert`将具有 css 选择器设置为的元素设置为`width:100%`in `px`，是否有某种方法可以`%`从 css 中获取它，我需要它来修复一些具有流畅布局的脚本。

```
// css
.my-element {
    width:100%;
}

// javascript
alert('width: '+$('.my-element').css('width'));
// this alerts "width: 1116px" instead of "width: 100%" 
```

也许这样的事情总是正确的？

```
alert($('.my-element').outerWidth() == $('.my-element').parent().outerWidth()); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T18:41:43.407

```
function percentwidth(elem){
    var pa= elem.offsetParent || elem;
    return ((elem.offsetWidth/pa.offsetWidth)*100).toFixed(2)+'%';
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T18:57:00.390

您可以通过两种方法获得百分比宽度。

[**现场演示**](http://jsfiddle.net/dMLrR/2/)

使用 jQuery 使用 jQuery 1.3.2，您将获得 100%。

```
alert($('.my-element').css('width'))​; 
```

使用javascript通过在标签的样式属性中设置宽度，如下所示

```
<div id="div2" style="width:100%"></div>

div2 = document.getElementById('div2');

alert("Width of div2 with style = " + div2.style.width); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-16T18:22:52.173

这个帖子

[根据开发人员使用 CSS 指定的内容，是否可以使用 jQuery 以百分比或像素为单位获取元素的宽度？](https://stackoverflow.com/questions/4006588/is-it-possible-to-use-jquery-to-get-the-width-of-an-element-in-percent-or-pixels)

# php - 如何解析一行并导致数组 - 卡住

> ID：10624370
> 
> 赞同：0
> 
> 时间：2012-05-16T18:21:05.430
> 
> 标签：php, regex, arrays, preg-match

这是我尝试做的事情：

```
isNumeric(right(trim(contract_id),1))

isNumeric
    right
        trim
            contract_id
        1

isNumeric(right(trim(contract_id),1), bob, george(five(four, two)))

isNumeric
    right
        trim
            contract_id
        1
    bob
    george
        five
            four
            two 
```

所以基本上它需要一条线（让我们说修剪（var））并将其组成一个数组（array（trim => array（var））。

我确实尝试了正则表达式和 strpos 但没有结果......我需要帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T00:25:35.790

首先，下降解析器总是会给你更好的控制。
一个完整的正则表达式解决方案可以让你跳过错误，或者至少让你继续
而不是废话。

您的格式非常简单，并且可以进行内部递归的引擎
至少可以为您提供外部匹配。使用语言递归，您可以重新输入该正则表达式，
使您能够解析核心。

我不是 php 专家，但如果它支持正则表达式递归和语言级别的*eval()*，您
将能够将数组构造注入源文本。
然后评估字符串以创建嵌套数组图像，并带有参数。

实际上，我将您的文本转换为大约 12 行 Perl 中的数组，但是
当它变得有趣时添加到其中。

这是一个 Perl 示例。它被简化了，所以它的可读性。它可能会给你一些在 php 中尝试它的灵感（如果它可以做这些事情）。就像我说我不是 php 专家。

```
 use Data::Dumper;

  my $str = '
    asdf("asg")
    isNumeric(right(trim(contract_id),1))
    var = \'aqfbasdn\'
    isNumeric(right(trim ( ,contract_id,),-1, j( ) ,"  ", bob, george(five(four, two))))
  ';

  my $func      = '\w+';           # Allowed characters (very watered down)
  my $const     = '[\w*&^+-]+';
  my $wspconst  = '[\w*&^+\s-]+';

  my $GetRx = qr~
    \s*
    (                       # 1 Recursion group
       (?:
           \s* ($func) \s* 
           [(]
              (?:  (?> (?: (?!\s*$func\s*[(] | [)] ) . )+ ) 
                 | (?1)                                         
              )*                                               
           [)]
       )
     )                                                 
  ~xs;

  my $ParseRx = qr~
    (                        # 1 Recursion group
       (?:
           \s* ($func) \s*                                    # 2 Function name
           [(]
           (                                                  # 3 Function core
              (?:  (?> (?: (?!\s*$func\s*[(] | [)] ) . )+ ) 
                 | (?1)                                         
              )*                                               
           )                                                   
           [)]
                                         # OR..other stuff
                                         # Note that this block of |'s is where               
                                         # to put code to parse constants, strings,
                                         # delimeters, etc ... Not much done, but
                                         # here is where that goes.
                                         # -----------------------------------------
         |  \s*["'] ($wspconst) ["']\s*      # 4,5 Variable constants
         | \s* ($const) \s* 
                                         # Lastly, accept empty parameters, if
         | (?<=,)                        # a comma behind us,
         | (?<=^)(?!\s*$)                # or beginning of a new 'core' if actually a paramater.
       )       
     )                                                 
  ~xs;

##
  print "Source string:\n$str\n";
  print "=======================================\n";
  print "Searching string for functions ...\n";
  print "=======================================\n\n";

  while ($str =~ /$GetRx/g) {
      print "------------------\nParsing:\n$1\n\n";
      my $res = parse_func($1);
      print "String to be eval()'ed:\n$res\n\n";

      my $hashref = eval $res.";";
      print "Hash from eval()'ed string:\n", Dumper( $hashref ), "\n\n";
  }

###
  sub parse_func
  {
      my ($core) = @_;
      $core =~ s/$ParseRx/ parse_callback($2, $3, "$4$5") /eg;
      return $core;
  }

  sub parse_callback
  {
      my ($fname, $fbody, $fconst) = @_;
      if (defined $fbody) {
          return "{'$fname'=>[" . (parse_func( $fbody )) . "]}";
      }
      return "'$fconst'"
  } 
```

输出

```
Source string:

    asdf("asg")
    isNumeric(right(trim(contract_id),1))
    var = 'aqfbasdn'
    isNumeric(right(trim ( ,contract_id,),-1, j( ) ,"  ", bob, george(five(four, two))))

=======================================
Searching string for functions ...
=======================================

------------------
Parsing:
asdf("asg")

String to be eval()'ed:
{'asdf'=>['asg']}

Hash from eval()'ed string:
$VAR1 = {
          'asdf' => [
                      'asg'
                    ]
        };

------------------
Parsing:
isNumeric(right(trim(contract_id),1))

String to be eval()'ed:
{'isNumeric'=>[{'right'=>[{'trim'=>['contract_id']},'1']}]}

Hash from eval()'ed string:
$VAR1 = {
          'isNumeric' => [
                           {
                             'right' => [
                                          {
                                            'trim' => [
                                                        'contract_id'
                                                      ]
                                          },
                                          '1'
                                        ]
                           }
                         ]
        };

------------------
Parsing:
isNumeric(right(trim ( ,contract_id,),-1, j( ) ,"  ", bob, george(five(four, two))))

String to be eval()'ed:
{'isNumeric'=>[{'right'=>[{'trim'=>['' ,'contract_id','']},'-1',{'j'=>[ ]} ,'  ','bob',{'george'=>[{'five'=>['four','two']}]}]}]}

Hash from eval()'ed string:
$VAR1 = {
          'isNumeric' => [
                           {
                             'right' => [
                                          {
                                            'trim' => [
                                                        '',
                                                        'contract_id',
                                                        ''
                                                      ]
                                          },
                                          '-1',
                                          {
                                            'j' => []
                                          },
                                          '  ',
                                          'bob',
                                          {
                                            'george' => [
                                                          {
                                                            'five' => [
                                                                        'four',
                                                                        'two'
                                                                      ]
                                                          }
                                                        ]
                                          }
                                        ]
                           }
                         ]
        }; 
```

# .net - .NET 和 Oracle 数据访问

> ID：10624374
> 
> 赞同：3
> 
> 时间：2012-05-16T18:21:18.123
> 
> 标签：.net, oracle10g

我正在尝试做这样的事情：

```
Public Sub (ByVal boolTest As Boolean)
Dim objConnecton As System.Data.Common.DbConnection
Try

  If boolTest Then
         objConnecton = New SqlConnection
  Else
          objConnecton = New OracleConnection 
  End If
  Catch ex As Exception

Finally
  'Cleanup here
End Try 
```

这适用于 Oracle.DataAccess 的 2.112.1.0 版，但不适用于 10.2.0.100 版。使用版本 10.2.0.100，我收到以下编译错误：

“'Oracle.DataAccess.Client.OracleConnection' 类型的值无法转换为 'System.Data.Common.DbConnection'”

我正在尝试使用 SQLConnection 或 OracleConnection 的实例初始化连接对象，具体取决于布尔值。

为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:23:31.363

> 为什么我会收到此错误？

用于 .NET 的 Oracle 客户端的更高版本（10.2+）不派生自标准 .NET 框架类，例如`DbConnection`. 如果您想无缝支持多个数据库，这有一个不幸的副作用，即需要更多的工作，因为您不能再仅使用`System.Data.Common`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:27:20.280

您可以使用 Microsoft 的 OracleConnection 实现而不是 Oracle one ..

[http://msdn.microsoft.com/en-us/library/system.data.oracleclient.oracleconnection(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/system.data.oracleclient.oracleconnection(v=vs.90).aspx)

最好的祝福。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:28:05.857

改用 System.Data.IDbConnection 怎么样？

# facebook-graph-api - Facebook OpenGraph：提交新操作

> ID：10624377
> 
> 赞同：3
> 
> 时间：2012-05-16T18:21:45.243
> 
> 标签：facebook-graph-api

我刚开始使用 Facebook SSO 和 OpenGraph。我有 SSO 与我的 iOS 应用程序一起使用，现在我开始了解如何发布 OpenGraph 操作。

我已经设置了一个新的操作类型，我需要提交它。当我这样做时，我收到错误：

> 您必须使用此操作类型将至少一项操作发布到您的时间轴。查看文档。

好的，所以我点击了有用的文档链接，它告诉我我想这样做：

```
https://graph.facebook.com/me/recipebox:cook?recipe=http://www.example.com/pumpkinpie.html&access_token=YOUR_ACCESS_TOKEN 
```

所以我把它翻译成这样：

```
https://graph.facebook.com/me/fotoferret:hug?ferret=http://www.example.com/pumpkinpie.html&access_token=MY_ACCESS_TOKEN 
```

fotoferret 是我的命名空间，拥抱是我的行动

其中 MY_ACCESS_TOKEN 是返回的值：

```
https://graph.facebook.com/oauth/access_token?grant_type=client_credentials&client_id=MY_APP_ID&client_secret=MY_APP_SECRET 
```

当我粘贴翻译后的 URL 时，我得到了这个错误：

```
{
   "error": {
      "message": "An active access token must be used to query information about the current user.",
      "type": "OAuthException",
      "code": 2500
   }
} 
```

这一点我很困惑。我尝试将操作发布到我的时间线，但它告诉我我需要一个我提供的活动访问令牌。那么我怎样才能发布一个动作呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T18:44:17.243

使用应用访问令牌时，请不要使用用户 ID `/me`。您正在代表应用程序而不是直接代表用户执行操作。

*用户访问令牌*

`https://graph.facebook.com/me/fotoferret:hug?ferret=http://www.example.com/pumpkinpie.html&access_token=MY_ACCESS_TOKEN`

*应用访问令牌*

`https://graph.facebook.com/ID/fotoferret:hug?ferret=http://www.example.com/pumpkinpie.html&access_token=MY_ACCESS_TOKEN`

使用 Graph Explorer 时，请务必将选项切换为`POST`而不是 get `GET`。`GET`默认情况下设置，因此它将返回不创建的操作。

或使用 cURL

```
curl -F 'access_token=MY_ACCESS_TOKEN' \
-F 'ferret=http://www.example.com/pumpkinpie.html' \
https://graph.facebook.com/ID/fotoferret:hug 
```

如果您启用了“需要应用令牌才能发布”并获得

`{"error":{"message":"(#15) This method must be called with an app access_token.","type":"OAuthException","code":15}}`

这意味着你正在使用

```
curl -F 'access_token=MY_ACCESS_USER_TOKEN' \
-F 'ferret=http://www.example.com/pumpkinpie.html' \
https://graph.facebook.com/me/fotoferret:hug 
```

使用`MY_APP_TOKEN`. 如果你得到，

`{"error":{"message":"An active access token must be used to query information about the current user.","type":"OAuthException","code":2500}}`

这意味着你正在使用

```
curl -F 'access_token=MY_APP_TOKEN' \
-F 'ferret=http://www.example.com/pumpkinpie.html' \
https://graph.facebook.com/me/fotoferret:hug 
```

您应该使用数字 id

```
curl -F 'access_token=MY_APP_TOKEN' \
-F 'ferret=http://www.example.com/pumpkinpie.html' \
https://graph.facebook.com/ID/fotoferret:hug 
```

如果你得到

`{"error":{"message":"(#200) Requires extended permission: publish_actions","type":"OAuthException","code":200}}`

用户在他们的设置中没有为我/权限设置的 publish_actions 操作，它应该在那里，`"publish_actions": 1`好像没有，通过选择“获取访问令牌”并选择授予权限（您必须更改以适合您的应用程序代码范围为出色地）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:30:30.587

如果您使用[图形 API 资源](https://developers.facebook.com/tools/explorer)管理器为您的应用程序生成访问令牌并使用它，可能会更容易。这至少可以消除您在获取访问令牌时出错的任何可能性。

# coronasdk - OOP 类中的运行时错误（Corona）

> ID：10624379
> 
> 赞同：0
> 
> 时间：2012-05-16T18:22:02.293
> 
> 标签：coronasdk

Corona 新手（来自 Actionscript）并尝试通过一些 OOP 教程为我的应用程序创建可重用模块。目前正在研究一个数字选择器，它似乎正在工作，但当我按下按钮时也会引发错误。这是“numberPicker.lua”的代码：

```
local numberPicker = {}
local numberPicker_mt = { __index = numberPicker }  -- metatable
widget = require "widget"

-------------------------------------------------
-- PUBLIC FUNCTIONS
-------------------------------------------------

function numberPicker.new() -- constructor

local newNP = display.newGroup()
local value = 0

local function dec()
    print("dec")
    if value > 0 then
        value = value - 1
        valueText.text = value
    end
end

local function inc()
    print("inc")
    if value < 100 then
        value = value + 1
        valueText.text = value
    end
end

decrement = widget.newButton{
    default="gfx/dec_normal.png",
    over="gfx/dec_press.png",
    width=58, height=58,
    onRelease = dec
}

valueText = display.newText(value, 70, 10, native.systemFont, 40)
valueText:setTextColor(0, 0, 0)

increment = widget.newButton{
    default="gfx/inc_normal.png",
    over="gfx/inc_press.png",
    width=58, height=58,
    onRelease = inc
}

increment.x = 140

newNP:insert(decrement.view)
newNP:insert(valueText)
newNP:insert(increment.view)
return setmetatable( newNP, numberPicker_mt )
end

return numberPicker 
```

用法：

```
local numberPicker = require( "numberPicker" )
local lengthPicker = numberPicker.new()
scrollView:insert(lengthPicker) 
```

当我按下任一按钮时，我会打印两次以下错误：

```
Runtime error
attempt to call a nil value
stack traceback:
[C]: ? 
```

任何线索任何人？谢谢，艾玛。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:08:50.120

“scrollView”变量未初始化。

# sql-server - 将 oracle 日期字符串转换为 SQL Server 日期时间

> ID：10624383
> 
> 赞同：3
> 
> 时间：2012-05-16T18:22:15.123
> 
> 标签：sql-server, datetime

在 SQL Server 2000 数据库中，我有一个表，其中包含 Oracle 数据库日期的字符串表示形式。它们的格式类似于“16-MAY-12”。我需要将这些转换为日期时间。我似乎找不到匹配的转换样式编号，也找不到允许我指定输入格式的函数。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:49:59.020

这似乎对我有用：

```
SELECT CONVERT(DATETIME, '16-MAY-12'); 
```

您还可以尝试使用[`TO_CHAR()`](http://www.techonthenet.com/oracle/functions/to_char.php)将 Oracle 值转换为对 SQL Server 更友好的格式（最好是`YYYYMMDD`），然后再将它们拉出阴暗面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-29T16:20:34.000

遵循 Aaron 的建议并在 Oracle 端转换为字符串，然后在 MS SQL 端进行检查/重铸。请参见下面的示例：

* * *

```
 ;WITH SOURCE AS (
    SELECT * FROM openquery(lnk, 
    'SELECT
        TO_CHAR(OFFDATE , ''YYYY-MM-DD HH24:MI:SS'') AS OFFDATE,
    FROM
        ORACLE_SOURCE')),
    SOURCE_TRANSFORM AS
    (
    SELECT
        CASE 
        WHEN ISDATE(OFFDATE) = 1 THEN CAST(OFFDATE AS DATETIME)
        ELSE NULL END AS OFFDATE
    FROM
        SOURCE
    )
    SELECT * FROM SOURCE_TRANSFORM 
```

# jquery - 为什么不能在这个 jQuery 代码中放置多个选择器？

> ID：10624385
> 
> 赞同：-3
> 
> 时间：2012-05-16T18:22:27.483
> 
> 标签：jquery

看起来很简单，你点击 .nextbutton 打开#contact 部门，你会想如果你放 '#contact,.nextbutton' 你可以同时使用它来关闭它，但这不起作用？我想知道为什么。

```
$('.nextbutton').click(function () {
$('#contact').stop().fadeTo(1500, 1);
});

$('#contact').click(function () {
$('#contact').stop().fadeTo(1500, 0.001);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T07:22:07.787

```
 $('#contact, .nextbutton').click(function () {
            $('#contact').stop().fadeTo(1500, ($(this).hasClass('nextbutton') ? 1 : 0.001));
  });​ 
```

# ios - 带有OpenGLES的iOS5中的YUV到RGB

> ID：10624386
> 
> 赞同：0
> 
> 时间：2012-05-16T18:22:29.953
> 
> 标签：ios, opengl-es, yuv

大家好

我尝试使用OpenGLES在ios 5中将yuv数据（yuv420p）转换为rgb数据。我已经看过 Apple 的 GLCameraRipple Demo，但这对我不起作用。

有没有人尝试过这个并且可以帮助我？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T01:19:47.017

GLCameraRipple 不使用 RAW YUV 数据。它直接使用来自相机的帧缓冲区。无法让 GLCameraRipple 使用原始 YUV 数据，因为您无法将手动创建的缓冲区分层。

# php - 回复来自发件人的电子邮件地址

> ID：10624393
> 
> 赞同：-2
> 
> 时间：2012-05-16T18:22:56.157
> 
> 标签：php, webforms

这是process.php。我想从表格上的电子邮件地址收到电子邮件，以便回复他们

```
<?php

$where_form_is="http://".$_SERVER['SERVER_NAME'].strrev(strstr(strrev($_SERVER['PHP_SELF']),"/"));

 // To send HTML mail, the Content-type header must be set
    $headers = "MIME-Version: 1.0\n";
    $headers .= "Content-Type: text/html; charset=ISO-8859-1\n";
    $headers .= "From: " .  $_POST['field_9'] . "\n"; 
    $headers .= "Reply-To: ". $_POST['field_9'] . "\n";

mail("harshad@madiganpratt.com","Reservaion Enquiry","Form data:

Preferred Arrival Date : " . $_POST['field_1'] . " 
Preferred Departure Date: " . $_POST['field_2'] . " 
Room Category: " . $_POST['field_3'] . " 
Adults: " . $_POST['field_4'] . " 
Children: " . $_POST['field_5'] . " 
Please contact me by: " . $_POST['field_6'] . " 
First Name: " . $_POST['field_7'] . " 
Last Name: " . $_POST['field_8'] . " 
Email: " . $_POST['field_9'] . " 
Phone: " . $_POST['field_10'] . " 

");

include("confirm.html");

?> 
```

……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:26:13.170

您需要设置标题：

```
 // To send HTML mail, the Content-type header must be set
        $headers = "MIME-Version: 1.0\n";
        $headers .= "Content-Type: text/html; charset=ISO-8859-1\n";
        $headers .= "From: " .  $from . "\n"; 
        $headers .= "Reply-To: ". $from . "\n";
        $headers .= "CC: email@eami.com\n"; 

        // Mail it
        mail($to, $subject, $message, $headers); 
```

# asp.net - SQL Server 用户定义的表类型和 .NET

> ID：10624394
> 
> 赞同：4
> 
> 时间：2012-05-16T18:23:01.897
> 
> 标签：asp.net, sql-server-2008

[我需要将整数数组传递给 .NET 中的存储过程，因此我在 Google 上搜索了该主题并最终在 SQL Server 2008 中](http://www.sommarskog.se/arrays-in-sql-2008.html)遇到了数组和列表，由 Erland Sommarskog 编写，并被认为是处理此问题的标准方式过程。

我尝试了两种不同的方式将用户定义的表类型传递给存储过程，但每种方式都出现异常。这两种方式都类似于 Erland Sommarskog 在上面的链接中使用的方式。

**方式 #1 - 使用 DataTable 作为 SqlParameter**

```
DataTable dt = new DataTable();
dt.Columns.Add("n", typeof(int));

// Just adding 3 test rows to the DataTable
DataRow dr = dt.NewRow();
dr["n"] = 1;
dt.Rows.Add(dr);

dr = dt.NewRow();
dr["n"] = 2;
dt.Rows.Add(dr);

dr = dt.NewRow();
dr["n"] = 3;
dt.Rows.Add(dr);

// Creation of the SqlParameter
SqlParameter p = new SqlParameter();
p.ParameterName = "@ids";
p.Direction = ParameterDirection.Input;
p.SqlDbType = SqlDbType.Structured;
p.TypeName = "lstInt_TblType";
p.Value = dt;

// Blows up here
DataSet ds = DAWrapper.GetDataSet(
    Common.GetDB(),
    "usp_Test",
    new SqlParameter[] { p }); 
```

我得到状态的异常： **传入的表格数据流（TDS）远程过程调用（RPC）协议流不正确。参数 1 ("@ids")：数据类型 0x62 (sql_variant) 的类型特定元数据的类型无效。**

**方式二——使用列表作为SqlParameter**

```
List<SqlDataRecord> lstSDR = new List<SqlDataRecord>();
SqlMetaData[] tvp_definition = { new SqlMetaData("n", SqlDbType.Int) };

// Just adding 3 test rows
SqlDataRecord rec = new SqlDataRecord(tvp_definition);
rec.SetInt32(0, 50);
lstSDR.Add(rec);

rec = new SqlDataRecord(tvp_definition);
rec.SetInt32(0, 51);
lstSDR.Add(rec);

rec = new SqlDataRecord(tvp_definition);
rec.SetInt32(0, 52);
lstSDR.Add(rec);

// Creation of the SqlParameter
SqlParameter p = new SqlParameter();
p.ParameterName = "@ids";
p.Direction = ParameterDirection.Input;
p.SqlDbType = SqlDbType.Structured;
p.TypeName = "lstInt_TblType";
p.Value = lstSDR;

// Blows up here
DataSet ds = DAWrapper.GetDataSet(
    Common.GetDB(),
    "usp_Test",
    new SqlParameter[] { p }); 
```

我得到的例外是： **对象类型 System.Collections.Generic.List`1[[Microsoft.SqlServer.Server.SqlDataRecord, System.Data, Version=4.0.0.0, Culture=neutral, 不存在映射， PublicKeyToken=b77a5c561934e089]] 到已知的托管提供程序本机类型。**

**其他信息** lstInt_TblType 是我的 SQL Server 2008 中的用户定义的表类型。它确实存在（我对此进行了三次检查！）。它有一个名为“n”的列，类型为 int，主键，不允许空值。我完全复制了 Erland 的设置方式。

我还验证了存储过程 usp_Test 可以在 SQL Server Manager Studio 中运行，所以我相当确定异常不是从那个方向发出的。这是我用来验证存储过程是否有效的 t-sql：

```
DECLARE @ids lstInt_TblType
INSERT @ids(n) VALUES(1),(2),(3)
EXEC usp_Test ids 
```

任何关于去哪里的建议将不胜感激。谢谢！

**编辑： ** 存储过程 usp_Test：

```
ALTER PROCEDURE [dbo].[usp_Test]
(
    @ids lstInt_TblType READONLY
)
AS
BEGIN

    SET NOCOUNT ON;

        select *
    from dbo.dat_MetaData
    where MetaDataTypeID in (select n from @ids)
END
GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T21:37:43.303

找到了一种不同的方法来做这件事。这种方式使用 System.Data.SqlClient 库创建与数据库的连接，指定存储过程名称，然后将参数作为 DataTable 传入，该 DataTable 用作 SQL Server 用户定义的表类型。

```
using (SqlConnection conn = new SqlConnection(connStr)) {
    SqlCommand cmd = conn.CreateCommand();
    cmd.CommandType = System.Data.CommandType.StoredProcedure;
    cmd.CommandText = "dbo.usp_Test";
    cmd.Parameters.AddWithValue("@ids", dt);
    conn.Open();

    using (SqlDataReader sqlReader = cmd.ExecuteReader()) {
        DataTable retTbl = new DataTable();
        retTbl.Load(sqlReader);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-06T22:37:52.890

[您还可以在 Microsoft 自己的表值参数](https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/table-valued-parameters)参考中找到有关如何将表值参数数据传递到存储过程的良好示例。

# grails - 如何在 Grails 中评估 DataSource.groovy 之前执行代码？

> ID：10624397
> 
> 赞同：1
> 
> 时间：2012-05-16T18:23:06.677
> 
> 标签：grails

DataSource.groovy 似乎在 BootStrap.groovy 之前被评估。但是，我需要设置一些东西，以便我可以在 DataSource.groovy 中调用一些静态方法（我的数据库设置很复杂）。

更多信息：

如果我在没有 Grails 的情况下这样做，我可能会创建一个 DataSourceFactory Spring Bean。然后我会声明这个 bean 和其他代码之间的依赖关系，这样我就可以显式地控制一切初始化的时间。在我的 DataSourceFactory 类的 PostConstruct 方法中，我将执行调用我公司的属性/配置框架所需的代码，以获取必要的数据库连接信息。

因此，我正在寻找的是对 JDBC 数据源的构建方式的完整（或至少更多）编程控制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:27:05.927

`DataSource.groovy`被评估为一个可执行的 groovy 文件。为什么不一开始就调用你的方法呢？例如：

```
MyApp.doExtraDatabaseConfig()

dataSource {
    ...
} 
```

# mysql - 返回天数范围内的唯一日期

> ID：10624398
> 
> 赞同：0
> 
> 时间：2012-05-16T18:23:10.950
> 
> 标签：mysql, sql

我正在尝试查询使用 id、startDateTime、endDateTime 设置的表。假设第 1 行如下所示：

```
id      startDateTime      endDateTime      
100     2/9/2012 20:55     3/21/2012 10:43 
```

我需要查询上述内容，以便获得上述范围内所有天数的不同计数。我的预期结果将在上述 42 天，因为从 2 月 9 日到 3 月 21 日有 42 个独特的日历日。Datediff 因为它查看时间片给了我 41 天。我尝试了 datediff 和 timediff 的各种迭代，试图让它工作，但找不到在所有情况下都有效的东西。关于如何在 SQL 中完成此操作的任何建议？

我从如下所示的查询开始：

```
SELECT ConditionStatus.ID, 
  SUM((DATEDIFF(ConditionStatus.endDate,ConditionStatus.startDate))) AS Duration 
WHERE ID = 100 
```

我的查询返回 41 的持续时间，这在技术上是准确的，但我需要设置条件以使日期范围内的每个日期都计数为 1

我试图模仿我们在数据仓库中使用的一些逻辑，在其中我们为每个有活动的日期持续计数 1。

谢谢，鲍勃

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:51:53.907

基本答案是您可以使用`DATEDIFF()`并添加 1，因为您想包括当天。

例如：

```
mysql> select datediff(current_date(),current_date()) + 1;
+---------------------------------------------+
| datediff(current_date(),current_date()) + 1 |
+---------------------------------------------+
|                                           1 |
+---------------------------------------------+
1 row in set (0.00 sec) 
```

扩展您的原始示例，您可以将字符串转换为日期时间，然后丢弃时间组件，然后使用如下查询计算包含日期计数：

```
mysql> SELECT ABS(DATEDIFF(DATE(STR_TO_DATE('2/9/2012 20:55','%m/%d/%Y %H:%i')),
    ->          DATE(STR_TO_DATE('3/21/2012 10:43','%m/%d/%Y %H:%i')))) + 1 as days_in_range;
+---------------+
| days_in_range |
+---------------+
|            42 |
+---------------+
1 row in set (0.00 sec)

mysql> SELECT ABS(DATEDIFF(DATE(STR_TO_DATE('3/21/2012 10:43','%m/%d/%Y %H:%i')),
    ->          DATE(STR_TO_DATE('2/9/2012 20:55','%m/%d/%Y %H:%i')))) + 1 as days_in_range;
+---------------+
| days_in_range |
+---------------+
|            42 |
+---------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-25T08:20:24.377

请参阅此答案-[如何选择日期范围内的不同天数？](https://stackoverflow.com/questions/8315147/how-do-i-select-the-number-of-distinct-days-in-a-date-range)

在使用@Ike 的答案之前先看看。如果您添加 +1，则在时间值为 00:00:00 的情况下，您将获得太多。

`select datediff(days, '2/9/2012 20:55', '3/21/2012 10:43')`返回 41

`select datediff(days, '2/9/2012 20:55', '3/21/2012 10:43') + 1`返回 42

这就是中断的地方-

`select datediff(days, '2/9/2012 20:55', '3/21/2012 00:00:00') + 1`返回 42

那是错误的答案。它不应该包括最后一天。

这是解决方法 -

`datediff(days, '2/9/2012 20:55', dateadd(seconds, -1, '3/21/2012 00:00:00') + 1`

# c - 如何用C打开文件

> ID：10624400
> 
> 赞同：-3
> 
> 时间：2012-05-16T18:23:13.667
> 
> 标签：c, file-io, fopen

我正在尝试创建一个程序来创建一个 .dat 文件，读取该文件并调用一个函数以使用以下方法之一在屏幕上打印数据：冒泡、选择或插入、按 DESC 表单排序数据。任何人都可以帮助我吗？你可以在下面看到我的一段代码：

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
  FILE *arquivo = fopen("teste.dat", "r");

  // testa se o arquivo foi aberto com sucesso
  if(arquivo != NULL)
    printf("Arquivo foi aberto com sucesso.");
  else
    printf("Nao foi possivel abrir o arquivo.");

  printf("\n\n");
  system("PAUSE");
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:28:07.170

文件区域是否存在？如果不是，您必须使用“a+”或“w+”，因为您需要访问作为第二个参数。阅读文档[http://www.cplusplus.com/reference/clibrary/cstdio/fopen/](http://www.cplusplus.com/reference/clibrary/cstdio/fopen/) ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T13:14:57.840

看你的代码看起来不错，除了它有一个非常小的错误。

只需将“r”更改`fopen`为“a+”

通过“a+”从文件的最后打开一个文件，然后可以读取和写入该文件，但如果不存在则它将自动创建它。

如果您想在文件不存在时通知用户，请同时使用“r+”和“w+”

但是要在最前面，您可以使用`fseek`and `fsetpos`here。

# c# - 在多个 Metro 风格应用程序中重用 JavaScript 代码

> ID：10624401
> 
> 赞同：2
> 
> 时间：2012-05-16T18:23:20.910
> 
> 标签：c#, javascript, windows-8, windows-runtime

解决了！请参阅下面的我的自我回答。

* * *

我正在使用 Javascript 和 HTML 构建两个 Metro 风格的应用程序，它们将具有不同的表示层，但在底层有很多相似的功能。由于能够从 Javascript 调用 C# 方法，我可以将许多“通用”功能分解到 C# WinMd 库中，然后两个顶级应用程序都可以引用该库。

但是，我想重用一些纯 Javascript 的实用程序类型函数。似乎没有办法使用 Javascript（仅 C# 或 C++）创建“WinMD”。

在 .NET 世界中，我通常只是将任何文件打包为资源并从通用程序集中加载它。有没有办法可以将“通用”.js 文件作为资源添加到 WinMD，并通过一些应用程序感知 URL（即 ms-appx: 或 ms-resource: 或类似的东西）访问它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T18:56:44.533

The trick is as follows:

1.  Add the file you wish to reuse to a WinMD class library project (e.g. "MyWinMdProj")
2.  Mark the resource as "content" in its property page (usually is by default)
3.  Add a reference to the class library from the top-level Metro app
4.  Use a script tag with the ms-appx protocol to reference the file, i.e.

< script src="ms-appx:///MyWinMdProj/path/to/file.js" >

Note the three slashes; "MyWinMdProj" is a folder relative the Metro app's package (i.e. ms-appx:///) as opposed to being its own top-level package.

Note that any file included in this manner will be exposed on the filesystem under C:\Program Files\WindowsApps - but all of your html, js, css, etc. files from the top-level app project already are anyway, so you're not any worse off in that regard than if you copied and pasted the code in between two (or more) different apps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T14:51:14.253

或者，您可以将脚本打包到 Nuget 包中，类似于 jQuery 和 Modernizer 的完成方式，然后只需为这两个项目添加 Nuget 引用。

[http://www.nuget.org](http://www.nuget.org)

# php - php mvc + 模板引擎

> ID：10624402
> 
> 赞同：1
> 
> 时间：2012-05-16T18:23:21.653
> 
> 标签：php, model-view-controller, templating-engine

我已经离开 PHP 世界一段时间了，现在我回来了。在 asp.net 中广泛使用了 mvc 模式，我很想在 php 中再次使用它。我在 2006 年使用了 codeigniter，它仍然是标准吗？我知道还有其他的，例如 Symphony 和 phpCake。

这些是我想要的功能：

*   轻巧快速
*   最好不是一个巨大的学习曲线
*   不包括数据库查询优化
*   包括模板引擎（例如 Smarty） - 我可以使用 Smarty，但我想知道是否有将 mvc 与模板引擎结合的产品。

现在的标准是什么？你会推荐什么符合上述标准？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:31:00.780

Symfony2 是目前最流行的一种，它很现代，并且拥有一个庞大的社区。它具有您想要的所有功能，但学习曲线相当大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:37:08.103

试试 Symfony2。这是一个非常值得尊敬的框架。它集成了一个名为“twig”的模板引擎，该引擎由 Symfony 项目背后的同一家公司开发，类似于 smarty。公平地说，如果您有使用 mvc 的背景，那么学习曲线并没有那么糟糕。

文档和学习资源非常好，与它结合的分析器是我最近看到的最好的东西之一，它还利用了 PHP 的最新结合，例如命名空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:35:02.190

您可以使用 Kohana 框架，它是目前最流行的框架之一。Kohana 包含您提到的功能，并且您还使用了 Kostache（小胡子实现）。[只需在http://kohanaframework.org/](http://kohanaframework.org/)上查看即可

# android - Android 编辑通话记录

> ID：10624406
> 
> 赞同：0
> 
> 时间：2012-05-16T18:23:28.980
> 
> 标签：android, database, call, calllog

我想知道是否有办法修改通话记录？我想编辑通话日期。

例如，如果我今天接到一个电话，我想编辑日志并将日期更改为昨天。

有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:27:57.293

这似乎是一件非常奇怪的事情，但是......

通话记录数据的提供者 ( [CallLog.Calls](http://developer.android.com/reference/android/provider/CallLog.Calls.html) ) 只公开记录查询数据的方法，而不是修改它。您可以进入 Android 源代码查看是否有未记录的方法。

# javascript - Javascript - 字母、数字、下划线逗号分隔标签的正则表达式

> ID：10624412
> 
> 赞同：1
> 
> 时间：2012-05-16T18:23:42.370
> 
> 标签：javascript, regex

我是正则表达式和 javascript 的新手，我想知道是否有人知道正则表达式用于检测输入字段是否包含以下类型的格式：

至少一个不能包含空格的字母数字和下划线 (_) 标记（例如“test”和“test_”，但不能包含“test test”）

每个标签由一个逗号分隔（例如“word1,word2,word_3,_word_4”但不是“word1,,word2,word_3,_word_4）和任何其他符号无效（如;！”'@#%^&*( )-+=.>

我的意思是这样的一个例子，这些将是有效的标签：

something1,something_2,something_something,something 这些将是无效标签：

something1%,something% *2^,* !something%_&something,(*)something@+

它也应该能够只接受一个标签，也可以接受多个标签！！

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:49:48.780

Presuming you want to accept both uppercase and lowercase characters:

```
^[a-zA-Z0-9_]+(,[a-zA-Z0-9_]+)*$ 
```

The mentioned site has great information about regular expressions, I recommend reading through it. For now a short explanation:

`^` means beginning of the string, so that no other (possibly invalid) characters can precede it. Between `[` and `]` is a character class: specifying what characters may follow. `[ABC]` for example means an A, a B or a C. You can also specify ranges like `[A-E]`, which means an A, B, C, D or E.

In the regular expression above I specify the range `a` to `z`, `A` to `Z` (uppercase), `0` to `9` and the single character `_`. The `+` means that the character, a group or a character from the character class preceding it must appear at least once or more.

The `(` and `)` group a part of the regular expression. In this case they group the `,` (for the comma-separated list you wanted) and a repetition of the expression so far. The `*` means (like the `+`) that the group preceding it may appear many times, but with the difference that the `*` makes it optional.

**So, in short:** this expression allows tags consisting of at least one or more characters in the range *a-z*, *A-Z*, *0-9* or the character `_`, optionally followed by more tags that begin with a `,`, specifying the requirements for a comma-separated list :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:30:15.577

单个标签将匹配

```
[a-zA-Z0-9_]+ 
```

这是一个字符类，包含大写和小写的拉丁字母以及数字和下划线。这通常可以缩短为

```
\w+ 
```

如果您知道您的 RE 引擎不会处理 Unicode（JavaScript 就是这种情况）。不过，我现在会继续`\w+`。

您可以通过选择单个标签和可能为零的*逗号*+*标签来匹配多个标签*：

```
\w+(,\w+)* 
```

如果你想验证一个完整的字符串，你应该在表达式周围放置*字符串开头和字符串*结尾*的*锚：

```
^\w+(,\w+)*$ 
```

# c# - 来自后台工作人员的文件对话框

> ID：10624416
> 
> 赞同：3
> 
> 时间：2012-05-16T18:24:05.713
> 
> 标签：c#, multithreading, dialog, backgroundworker

**在维护一些代码时，我发现我们在后台工作人员**中有一个无限挂断。工作人员需要访问脚本文件。如果没有定义脚本文件，则编写原始代码以弹出文件对话框，以允许用户选择一个。它看起来像这样：

```
private void bgworker_DoWork(object sender, DoWorkEventArgs e)
{
    ... snip ...

    if (String.IsNullOrWhitespace(scriptFile))
    {
         scriptFile = PromptForScript();
    }

    ... snip ...
}

private string PrompForScript()
{
    string script = "";
    OpenFileDialog openDialog = new OpenFileDialog();

    if (openDialog.ShowDialog() == DialogResult.OK)
    {
        script = openDialog.FileName;
    }

    return script;
} 
```

我已经阅读了一些关于 的内容`MethodInvoker`，但是几乎所有的调用方法都要求您从控件中调用它们。有问题的后台工作人员**从一个单独的类运行，该类不扩展`Control`**. 我是否为此使用与 bgworker 一起调用类的表单？还是有另一种方法可以中断用户输入的线程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:45:14.683

不建议从后台工作人员 DoWork 事件处理程序调用 UI。 `BackgroundWorker`旨在在非 UI 线程上工作以保持 UI 响应。在`BackgroundWorker`使用`RunWorkerAsync`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:45:32.367

您要做的是在 UI 线程上捕获[SynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx)并将其传递给后台工作人员。BackgroundWorker 可以在上下文上调用`Send()`(同步, like `Invoke`) 和`Post()`(asynchronous, like `BeginInvoke`) 以调用回正确的 UI 线程。也就是说，在这种情况下可能不需要 BackgroundWorker - 常规线程池线程就可以了。

[来自http://msmvps.com/blogs/manoj/archive/2005/11/03/74120.aspx](http://msmvps.com/blogs/manoj/archive/2005/11/03/74120.aspx)的这段代码（稍作修改）应该给你一个大致的想法：

```
private void button1_Click(object sender, EventArgs e)
{
    // Here we are on the UI thread, so SynchronizationContext.Current
    // is going to be a WindowsFormsSynchronizationContext that Invokes properly
    ctx = SynchronizationContext.Current;
    ThreadPool.QueueUserWorkItem(
        // This delegate is going to be invoked on a background thread
        s => {
            // This uses the context captured above to invoke
            // back to the UI without the "messy" referencing 
            // of a particular form
            ctx.Send(s2 =>
            {
               // Interact with your UI here- you are on the UI thread
            },null);
        }
    );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:54:33.777

如果某个表单在另一个使用 BGworker 的类中启动了一个长时间运行的进程，为什么表单（或演示者，取决于 UI 架构）不处理错误状态的处理？

也许，只是传回一些状态[结果](http://msdn.microsoft.com/en-us/library/system.componentmodel.doworkeventargs.result.aspx)（或抛出一个非常有针对性的、特定的异常，您可以在 UI 中处理）？

让后台工作人员确定是否存在错误，但将错误（尤其是显示消息框的 UI 部分）交给上层。

抱歉，这没有更具体的代码，但根据您的系统的架构方式，它可能会有很多不同的方式。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-16T18:40:24.270

好吧，[`Form`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.aspx)该类有一个[`Invoke`](http://msdn.microsoft.com/en-us/library/zyzhdc6b.aspx)方法，因此将表单实例传递给后台工作类应该可以。

# javascript - Jquery 选择 TD 内的输入

> ID：10624417
> 
> 赞同：3
> 
> 时间：2012-05-16T18:24:09.823
> 
> 标签：javascript, jquery, html, jquery-selectors

这是我使用 Firebug 复制/粘贴的 HTML 代码：

```
<div id="TBI">
<tr class="t-state-selected t-grid-edit-row">
    <td>8081</td>

    <td class="t-grid-edit-cell">
        <input id="ijn" class="text-box single-line valid" type="text" value=""  name="ijn"> 
    </td> 
```

我可以使用以下命令访问该表的第二个单元格：

```
$('#TBI tr.t-state-selected')[0].cells[1] 
```

一切正常。

但是，如何获得对 TD 中包含的输入的 jquery 引用？一旦我弄清楚如何获得该文本框的选择器，我就可以随意操作它。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T18:25:15.923

试试看嘛：

```
$("#TBI tr.t-state-selected input") 
```

或者对于第二个 td 内的输入：

```
$("#TBI tr.t-state-selected:nth-child(1) input"); 
```

演示：[小提琴](http://jsfiddle.net/gMEue/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:25:25.840

```
$('#TBI tr.t-state-selected td input') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T18:27:19.680

```
$("input[type=text]", "div#TBI tr.t-state-selected td"); 
```

# html - 通过 HTML 而不是 PDF 显示发票？

> ID：10624419
> 
> 赞同：0
> 
> 时间：2012-05-16T18:24:24.823
> 
> 标签：html, ruby-on-rails, invoice

我正在使用 Prawn 即时生成 PDF 格式的发票，这些发票在 Adob​​e Acrobat 中打开。有没有一种快速的方法可以将相同的发票显示为 HTML，或者至少可以在我的网络应用程序中查看，同时保留布局，而不是打开一个新窗口/PDF？我一直找不到任何好的例子或建议。感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:42:17.720

在您的控制器操作中使用`send_data`以在浏览器中打开所需的文件。

查看以下[SO 问题](https://stackoverflow.com/questions/7292625/rails-prawn-pdf-show-up-in-browser-etc)以获取更多信息

# ruby-on-rails - 只需使用 rails 密码保护页面 - 我该怎么办？

> ID：10624422
> 
> 赞同：5
> 
> 时间：2012-05-16T18:24:30.500
> 
> 标签：ruby-on-rails, ruby-on-rails-3, passwords, password-protection

我现在处于 Hartl 的 rails 教程书的第 7 级，并且开始考虑部署中的应用程序。这是一个允许大约 12 名社会工作者进行协作和私下交流的应用程序。因此，我需要密码保护它。

但是，它也需要易于使用，非常易于使用。其中一些人以前从未使用过计算机，并且登录和注册过程会让他们完全放弃。

因此，我想创建一个登录页面，他们必须在其中输入密码（每个人的密码相同），然后重定向到“讨论页面”。我的第一个想法是使用一些混淆的javascript，这样在输入密码时，它会将它们重定向到讨论页面，但这听起来不太安全。

任何人都可以推荐我在rails中执行此操作的更好方法吗？理想情况下，他们只需输入一次，然后它会自动对所有页面进行身份验证（通过设置 cookie？），任何尝试直接访问页面的人都将被重定向到身份验证页面。

提前喝彩

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-16T20:00:47.123

在这种情况下，您可以使用一个非常简单的身份验证选项。我建议您观看[Ruby on Railscast 第 270 集](http://railscasts.com/episodes/270-authentication-in-rails-3-1?autoplay=true)。我认为这可能是您正在寻找的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:30:44.883

如果你想要*非常*简单，你可以使用[authenticate_or_request_with_http_basic](http://apidock.com/rails/v3.2.3/ActionController/HttpAuthentication/Basic/ControllerMethods/authenticate_or_request_with_http_basic)

但是，它不能替代真正的身份验证系统，例如 Devise 或 AuthLogic。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-09T14:34:13.977

我开始`lockup`为此目的使用 gem： [https ://github.com/gblakeman/lockup](https://github.com/gblakeman/lockup)

它非常易于设置，几乎每个访问该站点的用户都应该能够使用它。

# css - 如何在 Google 地图上放置带有控件的表单？

> ID：10624424
> 
> 赞同：1
> 
> 时间：2012-05-16T18:24:34.937
> 
> 标签：css, google-maps, html, google-maps-api-3

我有一个带有控件的小表单，我想将它放置在我的谷歌地图上，就在最左上角。

我发现了几个对这个问题的回应：

[如何在谷歌地图上浮动一个div](https://stackoverflow.com/questions/6037712/how-to-float-a-div-over-google-maps)

[使用谷歌地图 api 在 div 之上的 div](https://stackoverflow.com/questions/2786967/div-on-top-of-div-with-google-maps-api)

**但是**，这些都不适合我。我要么看到没有表单控件的地图，要么只看到表单控件但没有地图。可能是什么问题呢？

我最新的 HTML 和 CSS：

**HTML：**

```
<html>
    <body>
    <div id="wrapper">
        <div id="map_canvas"></div>
        <div id="over_map">
            <p>Select something!</p>
            <select>
                <option value="Red">Red</option>
                <option value="Green">Green</option>
                <option value="Blue">Blue</option>
            </select>
        </div>
    </div>
    </body>
</html> 
```

**CSS：**

```
html { height: 100%; width: 100% }
body { height: 100%; margin: 0; padding: 0 }
#map_canvas { position: absolute; top: 10px; left: 10px; height: 100%; width: 100%; }
#wrapper { position: relative; }
#over_map { position: absolute; top: 10px; left: 10px; z-index: 99; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T19:08:53.577

从你的 CSS 中删除这一行：

```
#wrapper { position: relative; } 
```

地图平移和缩放控件位于左上角，因此请小心放置或禁用这些控件。

关于 jsfiddle 的工作示例：http: [//jsfiddle.net/pratie/2sJSg/](http://jsfiddle.net/pratie/2sJSg/)

# jquery - 将宽度设置为 110

> ID：10624426
> 
> 赞同：0
> 
> 时间：2012-05-16T18:24:43.510
> 
> 标签：jquery

在示例中，为什么宽度不是 110。我知道这是因为边框。但是将宽度设置为 110 的跨浏览器方式是什么？

[http://jsfiddle.net/RS5wf/](http://jsfiddle.net/RS5wf/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:28:17.583

尝试使用[outerWidth](http://api.jquery.com/outerWidth/)获取宽度，其中考虑了填充和边框。

[http://jsfiddle.net/RS5wf/2/](http://jsfiddle.net/RS5wf/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:33:11.437

这是由于一个鲜为人知的属性称为`box-sizing`.

盒子大小决定了用什么盒子模型来渲染一个对象。

content-box 是大多数元素的默认值，但表单元素往往默认为边框框，这在设置表单元素样式时可能会有点令人沮丧。

[这是关于box-sizing](https://developer.mozilla.org/En/CSS/Box-sizing)的一个很好的链接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:38:33.077

可以使用 .width() 读取宽度，它返回内部宽度（删除填充和边框像素），或 .outerWidth() ，它返回总宽度。

宽度只能使用 .width(size) 设置，而不能使用 .outerWidth(size)。

# javascript - 隐藏在身体点击 exept 项目 id = something

> ID：10624427
> 
> 赞同：0
> 
> 时间：2012-05-16T18:24:52.993
> 
> 标签：javascript

除非用户单击 ID = 'menubutton' 的元素，否则如何隐藏菜单？

```
$('body').click(function(event) {
    $('#menu').hide();
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:29:38.183

使用 not() 选择器

```
$('body :not(#menubutton)').click(function(event) {
    $('#menu').hide();
}); 
```

[http://api.jquery.com/not-selector/](http://api.jquery.com/not-selector/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:27:09.347

使用`target`元素。

```
$('body').click(function(event) {
    // If the element clicked doesn't have the id "menubutton"
    if ( $(event.target).attr( 'id' ) !== 'menubutton' ) {
        $('#menu').hide();
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T18:27:09.773

```
$('body').click(function(event) {
    // don't hide if the clicked element was #menubutton,
    // or any element within #menubotton
    if (!$(event.target).closest('#menubutton').length) {
        $('#menu').hide();
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T18:28:40.990

```
$('body :not(div #menubutton)').click(function(event) {
   $('#menu').hide();
}); 
```

[jQuery 不（）](http://api.jquery.com/not-selector/)

not() 的选择器可能需要针对您的情况进行一些更改

# ruby-on-rails - Rails 3：通过 js/prototype 在远程表单上触发提交

> ID：10624428
> 
> 赞同：0
> 
> 时间：2012-05-16T18:25:02.703
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, prototypejs, onsubmit

我正在将旧的 Rails 应用程序从 Rails 2.3.14 转换为 Rails 3.0。

它仍在使用 Prototype（转换为 jQuery 是我们迁移路径中的后续步骤），所以请不要使用 jQuery 回答。

我们有很多带有下拉列表的表单，我们目前在其中一个下拉列表发生更改时以 AJAX 的形式提交。

在我们使用的Rails **2.3**版本中，下拉事件将调用以 ajaxily 提交表单。`form_remote_tag``onchange``$('myform').onsubmit();`

在**Rails 3.0**分支中，我们已将表单转换为使用`form_tag`with `:remote => true`，但是，当我们从下拉列表中选择一个选项时，Firebug 报告`$('myform').onsubmit is not a function.`

从 更改`$('myform').onsubmit();`为 只是`$('myform').submit();`导致表单被提交，但 **不是 ajaxily**。

关于如何在下拉列表中使用 onchange 事件以使用 Prototype 和 Rails 3 ajaxily 提交表单的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:57:16.870

弄清楚了。我只是`:remote => true`从`form_tag`调用中删除了，并在其位置添加了以下参数......

`:onsubmit => "new Ajax.Request('#{url}', {asynchronous:true, evalScripts:true, method:'get', parameters:Form.serialize(this)}); return false;"`

这基本上再现了旧`form_remote_tag`人曾经做的事情。

这并不是一个永久的解决方案。只是让我们将这个应用程序切换到 jQuery 的垫脚石。

# google-maps - Google Places Autocomplete 会返回我的应用通过地点报告添加的地点吗？

> ID：10624431
> 
> 赞同：0
> 
> 时间：2012-05-16T18:25:16.127
> 
> 标签：google-maps, google-maps-api-3, google-places-api

我正在寻找 Google Places Autocomplete 是否应该返回包括我提交的地点在内的结果。

*   我已经向 Place Report 端点提交了一个地点，并得到了一个 id 和 ref。
*   然后，我希望我的用户能够从自动完成框中选择该地点 - 以及所有其他结果。我已将浏览器 API 密钥添加到 Javascript src。

这是它的设计工作方式吗，因为目前它不是那样工作的 - 还是我不耐烦/做错了什么。

我已经通过使用添加时返回的引用调用详细信息来验证我的地点已添加...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T20:41:04.983

您的地点报告应该可以立即提供给您的应用程序，但它们必须通过 Google 审核流程，然后才能普遍提供给所有用户。从 Google Places API Docs 的[**User Place Reports**部分](https://developers.google.com/maps/documentation/places/#PlaceReports)：

> 地点报告请求用于添加新地点或删除现有地点。**新地点将立即在您的应用程序发起的地点搜索中可用**，并将进入审核队列以考虑用于 Google 地图。在审核过程批准之前，新添加的场所将无法用于其他应用程序。

从您的问题中不清楚您是如何执行*Place Report*的，所以我假设您使用了 Google Places API。

**根据您的评论，一些附加信息：**

您可以看到使用 Places API 添加的地点，但使用`Autocomplete`. Places API 设计得*非常*彻底（当然，新地点是由您的应用程序添加的），而`Autocomplete`它专注于高速、低延迟，并且几乎完全基于 Google 如何评价附近的地方。假设新添加的地点在 maps.google.com 上的点击次数、评分等还没有很多，那么它的显着性评价还不会很高是有道理的。

[在Autocomplete Demo & Places API Demo & Discussion Video](https://www.youtube.com/watch?v=9MZzosZkzpQ&feature=plcp)`Autocomplete`中有一些关于该工具和通用 Places API之间差异的非常好的信息，由 Google 的开发人员倡导者 Paul Saxman 和 Google 的 Places API 技术主管 Marcelo Camelo 提供. 接近尾声的部分是他们讨论添加新地点，我认为这将有助于澄清您所看到的结果。无论如何，我希望它有所帮助 -

# templates - Symfony2 和 Twig 侧边栏

> ID：10624433
> 
> 赞同：0
> 
> 时间：2012-05-16T18:25:19.443
> 
> 标签：templates, symfony, twig, sidebar

我正在使用 Symfony2 开发应用程序。我正在使用 Twig 模板化一个 3 级接口架构。在我的应用程序中有 3 种用户，匿名用户、已识别用户和管理员。页面以这种方式划分为多个部分：

```
<!-- app/Resources/views/base.html.twig -->
<!DOCTYPE html>

<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />

        <title>{% block title %}Anotatzailea{% endblock %} - Anotatzailea</title>
            <!--[if lt IE 9]>
                    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->

            {% block stylesheets %}
        <link href='http://fonts.googleapis.com/css?family=Voces' rel='stylesheet' type='text/css'>
                <link href='http://fonts.googleapis.com/css?family=La+Belle+Aurore' rel='stylesheet' type='text/css'>
                <link href="{{ asset('css/screen.css') }}" type="text/css" rel="stylesheet" />
            {% endblock %}

            <link rel="shortcut icon" href="{{ asset('favicon.ico') }}" />
        </head>

    <body>
    <section id="wrapper">
                <header id="header">

                <div id="logo">
                    <text>Anotatzailea</text>
                </div>
                        <div class="top">
                                 {% block navigation %}
                     {# Ikusi behar da ea erabiltzailea kautotu den, horren arabera aukera desberdinak erakusteko #}
                        {% if is_granted('ROLE_USER') %}
                                    <nav>
                                        <ul class="navigation">
            <li class="first current_page_item"><a href="{{ path('AnotatzaileaAnotatzaileaBundle_homepage') }}">Hasiera</a></li>
                    <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_informazioa') }}">Argibideak</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_nirekontua') }}">Kontua</a></li>
            <li><a href="">Estatistikak</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_testuaanotatu') }}">Anotatu</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_FAQ') }}">FAQ</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_kontaktatu') }}">Kontaktatu</a></li>
            <li class="last"><a href="{{ path('saioa_amaitu') }}">Irten</a></li>
                                        </ul>           
                                    </nav>
                    {% elseif is_granted('ROLE_ADMIN')%}
                        <nav>
                                        <ul class="navigation">
            <li class="first current_page_item"><a href="{{ path('AnotatzaileaAnotatzaileaBundle_homepage') }}">Hasiera</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_informazioa') }}">Argibideak</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_nirekontua') }}">Kontua</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_dokumentuak') }}">Dokumentuak</a></li>
            <li><a href="">Erabiltzaileak</a></li>
            <li><a href="">Estatistikak</a></li>
            <li class="last"><a href="{{ path('saioa_amaitu') }}">Irten</a></li>
                        </ul>           
                                    </nav>
                    {% else %}
                        <nav>
                                        <ul class="navigation">
            <li class="first current_page_item"><a href="{{ path('AnotatzaileaAnotatzaileaBundle_homepage') }}">Hasiera</a></li>
                    <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_informazioa') }}">Argibideak</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_saioahasi') }}">Sartu</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_erregistratu') }}">Erregistratu</a></li>
            <li><a href="{{ path('AnotatzaileaAnotatzaileaBundle_FAQ') }}">FAQ</a></li>
            <li class="last"><a href="{{ path('AnotatzaileaAnotatzaileaBundle_kontaktatu') }}">Kontaktatu</a></li>
                                        </ul>           
                                    </nav>
                    {% endif %}                 
                                {% endblock %}
                        </div>
        </header>
        <section id="page">
                    <section class="main-col">
                        {% block body %}{% endblock %}
                </section>
                         {% if is_granted('ROLE_USER') or is_granted('ROLE_ADMIN') %}
                    <section class="sidebar">
                        {% block sidebar %}{% endblock %}
                    </section>
                         {% endif %}
            <div id="footer">
                        {% block footer %}
                <!-- Partekatu -->
                <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
                    <a class="addthis_button_preferred_1"></a>
                    <a class="addthis_button_preferred_2"></a>
                    <a class="addthis_button_preferred_3"></a>
                    <a class="addthis_button_preferred_4"></a>
                    <a class="addthis_button_compact"></a>
                    <a class="addthis_counter addthis_bubble_style"></a>
                </div>
        <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=xa-4f4e593d146466e9"></script>
                <!--------------->
                <script type="text/javascript">
                        var addthis_config = {
                        ui_language : "[eu]"   
                        }
                </script>
                                 Testua anotatzeko tresna - created by H.Salaberri</a>
                        {% endblock %}
                    </div>

            </section>

    </section>

            {% block javascripts %}

        {% endblock %}
        </body>
</html> 
```

我想做的是仅在已识别的用户登录应用程序时显示侧边栏。我这样做的方式只是实现了不为匿名用户显示侧边栏。另一个问题是我不知道如何将 main-col 部分做得更大，以至于看不到侧边栏留下的间隙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T04:53:56.587

我认为您可以通过以下条件轻松获得所需的东西

```
 {% if is_granted('ROLE_USER') or is_granted('ROLE_ADMIN') %}
                      <section class="main-col">
     {%else%} 
                      <section class="main-col">
                     {# modify the class of this section as your requirement #}
     {%endif%}

                            {% block body %}{% endblock %}
                      </section>
{% if is_granted('ROLE_USER') or is_granted('ROLE_ADMIN') %}
                      <section class="sidebar">
                            {% block sidebar %}{% endblock %}
                      </section>
{%endif%} 
```

希望这可以帮助

# wcf - OBJECT 使用 XML Serializer 序列化，当使用 HTTPPOST 传递给服务时，对象的值为 null 或空

> ID：10624434
> 
> 赞同：1
> 
> 时间：2012-05-16T18:25:20.633
> 
> 标签：wcf, wcf-rest

**这是我的 WCF REST OperationContract**

```
 [OperationContract(Name = "SaveBasicInfoObjectById")]
     [WebInvoke(Method = "POST",
          ResponseFormat = WebMessageFormat.Xml,
          RequestFormat = WebMessageFormat.Xml,
         BodyStyle = WebMessageBodyStyle.Bare,
         UriTemplate = "Core/SaveBasicInfoObjectById?ID={ID}")]
     List<Response> SaveBasicInfoObjectById(string ID, BasicClass basicClass); 
```

**这是我的客户代码**

```
 string ID= "123";

  MyService.BasicClass basicClass = new MyService.BasicClass();

  string sErrorMsg = "";
  string sResponseStatus = "";
string URLString = "http://localhost:59133/MyService.svc/Core/SaveBasicInfoObjectById?ID=" + ID;

basicClass.FirstName = txt_Fname.Text.Trim();
basicClass.Lastname = txt_Lname.Text.Trim();

var paramContent = Serialize(basicClass);

CreateWebRequest(URLString, paramContent.ToString()); 
```

**这是序列化方法**

```
 public static string Serialize<T>(T obj)
    {

        var serializer = new System.Xml.Serialization.XmlSerializer(obj.GetType());
        var ms = new MemoryStream();
        serializer.Serialize(ms, obj);
        string retVal = Encoding.Default.GetString(ms.ToArray());
        ms.Dispose();
        return retVal;

    } 
```

**这是 CreateWebRequest 方法**

```
 private string CreateWebRequest(string endPoint, string paramContent)
    {
        string result = string.Empty;

        byte[] buffer = Encoding.UTF8.GetBytes(paramContent);
        var myHttpWebRequest = (HttpWebRequest)WebRequest.Create(endPoint);

        myHttpWebRequest.Method = "POST";
        myHttpWebRequest.ContentLength = buffer.Length;
        myHttpWebRequest.ContentType = "text/xml";

        using (var request = myHttpWebRequest.GetRequestStream())
        {
            request.Write(buffer, 0, buffer.Length);
            request.Close();
        }

        var myHttpWebResponse = (HttpWebResponse)myHttpWebRequest.GetResponse();
        using (var reader = new StreamReader(myHttpWebResponse.GetResponseStream(), Encoding.UTF8))
        {
            result = reader.ReadToEnd();
            myHttpWebResponse.Close();
        }

        return result;
    } 
```

**我面临的问题是对象以以下格式序列化，并且当在服务处命中断点时，对象值为空，即 firstname = "" 和 lastname = "" **

```
<?xml version="1.0"?>
 <BasicClass xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" ID="0">
<FirstName xmlns="http://tempuri.org/">James</FirstName>
<Lastname xmlns="http://tempuri.org/">Kravis</Lastname>
</BasicClass> 
```

任何人都可以建议为什么会这样吗？

我现在已经将 tempuri 命名空间针对 firstname 和 lastname 元素替换为“”或空，现在这个工作和来自客户端的值现在在服务中收到

**以下是序列化方法的更新代码**

```
public  string Serialize<T>(T obj)
    {
        //System.Xml.Serialization.XmlSerializer x = new System.Xml.Serialization.XmlSerializer(p.GetType());
        var serializer = new System.Xml.Serialization.XmlSerializer(obj.GetType());
        var ms = new MemoryStream();
        serializer.Serialize(ms, obj);
        string retVal = Encoding.Default.GetString(ms.ToArray());
        ms.Dispose();
        return retVal.Replace("xmlns=\"http://tempuri.org/\"", "");
    } 
```

** 更新上述代码 **

```
public  string Serialize<T>(T obj)
    {
        var serializer = new System.Xml.Serialization.XmlSerializer(obj.GetType());
        var ms = new MemoryStream();
        serializer.Serialize(ms, obj);
        string retVal = Encoding.Default.GetString(ms.ToArray());
        ms.Dispose();
        return retVal;
    } 
```

** 摆脱了替换并找到了阻止将默认命名空间添加到元素的方法 **

```
public class BasicClass
{
    [XmlElement(Namespace="")]//add namespace as ""
    public string Firstname{get;set;}

    [XmlElement(Namespace="")]//add namespace as ""
    public string Lastname{get;set;}
} 
```

**通过执行上述操作，我可以删除默认命名空间并且无需替换**

```
<?xml version="1.0"?>
 <BasicClass xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" ID="0">
<FirstName>James</FirstName>
<Lastname>Kravis</Lastname>
</BasicClass> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T23:50:19.143

默认情况下，WCF 使用 .`DataContractSerializer`作为其序列化程序，而不是`XmlSerializer`. 它们产生（并期望）不同的格式，因此您应该更改客户端（使用 DataContractSerializer 而不是 XmlSerializer 序列化您的对象）或服务（将`[XmlSerializerFormat]`属性应用于操作或服务合同以让 WCF 使用该序列化程序）。

您也不应该替换“xmlns”声明（`Serialize<T>`方法中的最后一行），因为这样做会改变生成的 XML 的语义。

# asp.net - 一个控制器中有多个 IQueryable？

> ID：10624438
> 
> 赞同：0
> 
> 时间：2012-05-16T18:25:44.937
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4, asp.net-web-api

我的整个数据库都有一个控制器，代码如下：

```
public class YogaController : DbDataController<Yoga.Models.YOGAEntities>
{
    public YogaController()
    {
    }

    public IQueryable<Yoga.Models.Action> GetActions(int BugId)
//GetActions retrieves "actions" table from the db, not Actions in MVC term 
    {
        return DbContext.Actions.Where(x => x.FK_BugsID == BugId);
    }
    public IQueryable<Yoga.Models.Label> GetRequiredLabels()
    {
        return DbContext.Labels.Where(x => x.IsRequired == true);
    }
    public IQueryable<Yoga.Models.Role> GetRoles()
    {
        return DbContext.Roles;
    }
    public IQueryable<Role> GetRoles2() //TODO: finish this
    {
        return DbContext.Roles.Where(x => x.RoleID == 1);
    }
    public IQueryable<Tag> GetTags(int actionid)
    {
        return DbContext.Tags.Where(x => x.J_Tags.Any(y => y.FK_ActionID == actionid));
    }
} 
```

如您所见，我在一个控制器中有多个 IQueryable，每个都查询不同的表。这是被禁止的东西吗？因为当我去`localhost/api/Yoga/GetActions`或`localhost/api/Yoga/GetRequiredLabels`我收到错误消息时：

```
Multiple actions were found that match the request: 
 System.Linq.IQueryable`1[Yoga.Models.Label] GetRequiredLabels() on type Yoga.Controllers.YogaController
 System.Linq.IQueryable`1[Yoga.Models.Role] GetRoles() on type Yoga.Controllers.YogaController
 System.Linq.IQueryable`1[Yoga.Models.Role] GetRoles2() on type Yoga.Controllers.YogaController 
```

当我禁用除一个 IQueryable 之外的所有 IQueryable 时，结果很好。

我搜索了类似的问题并检查了我的路由设置，控制器路径和名称没有冲突。

我的路线（默认生成）：

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
        routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );
        //routes.MapRoute(
        //    name: "Default",
        //    url: "{controller}/{action}/{id}",
        //    defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        );
    } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:35:34.550

MVC4 可能会将您的 HTTP 动词 (Get) 与名称以“Get”开头且没有参数的所有方法相匹配。尝试强制操作名称：

```
[ActionName("GetRequiredLabels")]
public IQueryable<Yoga.Models.Label> GetRequiredLabels()
...
[ActionName("GetActions")]
public IQueryable<Yoga.Models.Action> GetActions(int BugId)
... // etc 
```

**编辑：**

根据您粘贴的路线和控制器，我认为您的路线应该是：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
    routes.MapHttpRoute(
        name: "DefaultApi",
        routeTemplate: "api/{controller}/{action}/{id}",
        defaults: new { id = RouteParameter.Optional }
    );
} 
```

即它应该`{action}`在那里。如果您只有一个“获取”方法，则默认的 MVC4 路由将起作用。由于您有多个，因此您必须强制它根据路线选择动作。

# search - 增加 Google Search Appliance 上的代码段大小

> ID：10624443
> 
> 赞同：0
> 
> 时间：2012-05-16T18:26:12.173
> 
> 标签：search, google-search-appliance

我目前正在使用 Goggle 的 XSL 样式表为客户的网站定制一个公司 GSA 框。

不幸的是，我无法直接访问该盒子，这涉及与另一个时区的同事会面，因此我的实验和学习时间非常短。

我们遇到的最大问题之一是天气是否有可能在 XML 输出的结果*搜索片段中获取更多字符/单词。*更具体地说，返回的~~场地。~~

 ~~我已经为此阅读了很多文档，到目前为止，我只找到了标题长度的*tlen*值，但没有找到片段长度。

我知道有一些参数（隐藏字段）可以自定义搜索表单中的一些选项，但没有找到与此相关的任何内容。由于我无法访问管理员控制面板本身，我不知道那里有哪些选项。谁能指出我对此有帮助的东西？非常感谢，我对此表示赞赏。

顺便提一句; 我相信我们现在是 6.14 版。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T02:53:17.390

GSA 管理员可以增加片段的长度。这是系统范围的设置，无法在查询时进行自定义。

看到[这个](https://developers.google.com/search-appliance/documentation/614/help_gsa/serve_query_expansion#snippets)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-01T21:47:34.687

[http://www.google.com/support/enterprise/static/gsa/docs/admin/70/admin_console_help/serve_query_expansion.html#snippets](http://www.google.com/support/enterprise/static/gsa/docs/admin/70/admin_console_help/serve_query_expansion.html#snippets)

更改搜索结果中的片段长度

默认情况下，对于大多数语言，Search Appliance 将返回长度为 160 个字符的片段。此规则的一些例外是 CJK 语言，其片段默认为 24​​0 个字符。要更改片段长度：

在代码段生成下，在代码段长度框中键入一个数字。该数字必须大于或等于 0 且不大于 1024。单击 Apply Snippets Generation Settings。~~

# php - 邮件发送的 CakeEmail 响应

> ID：10624450
> 
> 赞同：1
> 
> 时间：2012-05-16T18:26:45.187
> 
> 标签：php, email, cakephp, cakephp-2.0

**[我可以使用 CakePHP 的CakeEmail](http://book.cakephp.org/2.0/en/core-utility-libraries/email.html)**类成功发送电子邮件。但是我怎样才能确定电子邮件已发送？电子邮件发送成功后是否有回复？

当我接受成功响应时，我会将访问者重定向到其他页面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T19:33:22.833

如果邮件发送成功或抛出异常，则**[send()方法发送内容数组。](http://api20.cakephp.org/class/cake-email#method-CakeEmailsend)**

# java - getLogger(String name) 还是 getLogger(Class clazz) 哪个更有效？

> ID：10624451
> 
> 赞同：0
> 
> 时间：2012-05-16T18:26:53.727
> 
> 标签：java, performance, logging

我正在使用 apache logger api 来记录消息、警告、错误和异常。我在 logger api 中找到了两种方法来捕获日志名称。

```
public static Logger getLogger(String name)

public static Logger getLogger(Class clazz) 
```

其中哪些是选择性能的最佳方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:44:28.683

通常，记录器实例被创建为静态字段。所以这个调用每个JVM每个类只进行一次，性能差异将在于噪音。

很难找到不这样做的充分理由。如果您要调用上课的那个，那么您正在为每个班级制作一个记录器，因此您不可能坐在一个循环中。

因此，您可以期望上课的人会更快，但您将很难在现实情况下衡量差异。

# javascript - 使用 java 脚本更新 dom 项列表的方法？

> ID：10624456
> 
> 赞同：1
> 
> 时间：2012-05-16T18:27:14.890
> 
> 标签：javascript, web-applications

我是[这个网站](http://www.bunch-it.com)的一体化开发者。在该站点中，如果您单击图形上的任何节点，它会更新结果 div 的内容。我以愚蠢的方式这样做，我只是从头开始重写所有 div 内容。我确信这不是最好的方法，那么对于这种动态更新，您有什么建议？

我认为会有一种方法匹配结果（可能是他们的 id）和结果的 div 的 id，这样我就可以将所有这些片段 div 保存在具有这些 id 的数组中。然后当我需要更新时，我只是再次重写所有内容，但只是推送与结果匹配的 dom 对象。

是否也可以将 dom 对象保留在 div 中，并在需要时将它们推送到页面主体？

或者有什么其他方法可以成功吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:34:53.270

只需隐藏与图表中单击的节点不匹配的 div。这样，当他们单击重置时，您会显示所有 div，无需继续重新创建内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:49:02.827

您可以将所有 div 放入文档中并最初隐藏它们。将单个节点的所有 div id 保存在数组或某种对象中。

当一个节点被点击时，将被点击的节点对应的那些div插入到目标div中，并设置为可见。

这种方法的一个问题是：即使隐藏的 div 也是 DOM 树的一部分，当您将选择的 div 插入目标 div 时，这些 div 实际上会从原始 DOM 节点移动到新节点。这样，当用户再次单击同一节点时，这些 div 不再存在。

解决此问题的一种方法是首先克隆节点并将克隆的节点移动到目标位置，或者您最好先将它们放回原处以避免悬空节点，然后再使用新的 div 更新目标。

# c++ - 模板类的静态类函数可以在没有模板参数的情况下使用吗？

> ID：10624457
> 
> 赞同：3
> 
> 时间：2012-05-16T18:27:15.263
> 
> 标签：c++, templates

我有一个模板类，其中包含一个不依赖于模板参数的静态函数。然而，当我使用该函数时，编译器似乎强迫我指定一个类型名。

```
template <typename T>
class MyClass {
    ...
    static void function();
};

template <typename T>
void MyClass<T>::function() {
    ....
} 
```

此功能可用作：

```
MyClass<int>::function(); 
```

但是'int'只是为了满足编译器。它没有任何意义，可以替换为任何其他类型，这不会增加代码的可读性。我想做一些类似的事情

```
MyClass<>::function(); 
```

甚至

```
MyClass::function(); 
```

但编译器不让我。我意识到这是因为在头文件中我已将函数明确标记为模板化，但是当我从头文件中删除“< T >”时，它也不会编译。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T18:34:46.833

类型很重要！

模板可以是*专门*的，因此：

```
template <typename T>
class MyClass {
public:
    static void function() { std::cout << "Hello, World!\n"; }
};

template <>
class MyClass<City> {
public:
    static void function() { launchRockets(); }
}; 
```

是一个可行的方案。

如果你再写`MyClass::function()`，它应该歼灭巴格达还是打印一个友好的信息？

* * *

当然，如果这个函数没有理由做任何其他打印，那么它可能应该是一个*独立*的函数：

```
void function() { std::cout << "Hello, World!\n"; } 
```

它由 简单地调用`function()`，嘿，它甚至更短，因为没有类！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-16T18:39:50.737

想象一下你有这个：

```
template <typename T> struct Foo
{
    static void boom()
    {
        static int n = 0;
        std::cout << ++n << std::endl;
    }
}; 
```

现在想象一下如果你说 会发生什么`Foo<int>::boom(); Foo<int>::boom();`，并将其与根本不等价的 进行比较`Foo<int>::boom(); Foo<char>::boom();`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T18:28:41.963

不要将 a`template`视为`class`. 它只是构建类的骨架。

`MyClass::function()`没有任何意义，因为`MyClass`除非你专门化它，否则它不是一个实际的类。

`MyClass<int>::function();`并且`MyClass<char>::function();`可能不依赖于模板参数，它们的行为可能相同，但它们不是同一个函数。

让我们看一下二进制文件：

```
 MyClass<int>::function();
00D617CE  call        MyClass<int>::function (0D611C2h) 
    MyClass<char>::function();
00D617D3  call        MyClass<char>::function (0D611C7h) 
```

为此，我为 提供了一个空定义`function`，因此它绝对不依赖于模板参数。如您所见，这两个功能是不同的。

那是因为编译器生成了两个类 -`MyClass<int>`和`MyClass<char>`.

# perl - 有没有办法让 Perl 解释器列出 pl 文件中的所有全局变量？

> ID：10624464
> 
> 赞同：1
> 
> 时间：2012-05-16T18:27:37.877
> 
> 标签：perl, global-variables

我有一个巨大的系统，我正在从 cgi 转换为守护程序，我需要找到所有最终成为全局变量（如未用我的 $... 声明）它们可能打算在本地范围内，但是在 perl 中，如果你不小心忘记了，它并不在乎，但现在我愿意。

我想perl解释器可以区分，那么有没有办法让它告诉我？我可以手动浏览所有代码，寻找声明，但是这个系统中有成千上万行代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:43:23.757

[perldoc strict](http://perldoc.perl.org/strict.html)将显示所有未声明的变量`my`：

```
$ perl -Mstrict=vars -c -e '$x=5; my $y=7; $z=6;'
Global symbol "$x" requires explicit package name at -e line 1.
Global symbol "$z" requires explicit package name at -e line 1.
-e had compilation errors. 
```

与文件列表相同的事情：

```
$ perl -Mstrict=vars -c *.pl 
```

这是使用[perldoc B::Xref的另一种方式](http://perldoc.perl.org/B/Xref.html)

```
$ perl -MO=Xref -e '$x=5; my $y=7; $z=6;'

... lots of verbose output

  Subroutine (main)
    Package (lexical)
      $y                i1
    Package main
      $x                1
      $z                1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T13:48:12.227

使用 PadWalker 模块，您可以查看特定范围内的所有变量。您可以看到用“my”和“our”声明的变量。

您仍应使用“use strict”，但使用“use strict”不会显示您声明为全局的全局变量。

例如这个例子仍然有一个全局变量，而 strict 不做任何事情

```
#!/usr/bin/env perl
use strict;
use warnings;
our $foo; 
```

使用 PadWalker，您可以使用类似的东西。

```
#!/usr/bin/env perl
use strict;
use warnings;
use DDP;
use PadWalker qw(peek_our);

our $var;

print p peek_our(0); 
```

输出是

```
\ {
    $var   \ undef
} 
```

当然，您应该只使用 PadWalker 进行调试。

# javascript - 将滑动事件添加到我的 WP jQuery // 幻灯片放映？

> ID：10624471
> 
> 赞同：0
> 
> 时间：2012-05-16T18:27:55.703
> 
> 标签：javascript, jquery, jquery-mobile, responsive-design

我想知道如何将 jQuery / Mobile Swipe 事件添加到我的 Wordpress 幻灯片放映中：

我希望能够在 Mobile 上使用它来“滑动”我的幻灯片。

***幻灯片放映代码 // 使用 WP 的 PHP 进行标记：***

```
<!-- Top of Page Slider FRAGILE -->

<div id="photo-rotatorWrapper">

<div id="photosubwrap" style="min-height: 280px; max-height: 280px;">

<div id="photo-rotator" style="">
<?php $slide_id=1; ?>
<?php
 $featuredPosts = new WP_Query();
 $featuredPosts->query("showposts=3");
 while ($featuredPosts->have_posts()) : $featuredPosts->the_post();
 ?>

    <div id="slide-<?php echo $slide_id; $slide_id++;?>">
     <a href="<?php the_permalink() ?>" class="post-image">
         <?php the_post_thumbnail( 'rotator-post-image' ); ?>
         <span class="title" style="font-style:italic; color:#999;"><?php the_title(); ?></span>
     </a>
     </div>

    <?php endwhile; ?><!--/close loop-->

    <ul id="slide-nav">
        <?php $nav_id=1; ?>
        <?php while ($featuredPosts->have_posts()) : $featuredPosts->the_post(); ?>
            <li>
                <a href="#slide-<?php echo $nav_id; ?>">
                    <span class="thumbnail" style="display:none;">
                    </span>
                    <p style="color:#F93; font-family:Georgia, 'Times New Roman', Times, serif; font-size: 18px;"><? the_title(); $nav_id++;?></p>

                    <div style="">

                    <!--<?php the_excerpt(); ?>-->

                    <?php if($text= get_post_meta($post->ID, "slidetext", true)) { ?>
                         <div class="">

                         <p style="font-weight: normal; color: #333; font-family: Arial, Helvetica, sans-serif; font-size: 14px;"><?php echo $text; ?></p> 

                         </div>
                        <?php } //else { print"<div>"; } ?>  

                    </div>   
                </a>
            </li>
        <?php endwhile; ?><!--/close loop-->
        </ul>
        </div>

</div>
</div>

<!-- End Top page Slider FRAGILE --> 
```

***允许幻灯片放映的脚本：***

```
<script type="text/javascript">

jQuery(document).ready(function($){
    $("#photo-rotator").tabs({fx:{opacity: "toggle"}}).tabs("rotate", 6000);
});

</script> 
```

**更新**：*我刚刚尝试过*：

```
<script>
$("#slide-1").swiperight(function() {
    $.mobile.changePage("#slide-2");
});
</script> 
```

*没有这样的运气~*

***有什么建议么 - ？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T21:30:13.417

为了扩展我的评论，这里是如何使用 jQuery UI 的选项卡小部件以编程方式更改选项卡：

```
//cache all the tabs (I called them slides...)
//get the number of tabs
var $slides    = $('div[id^="slide"]')
    slideCount = $slides.length;

//bind the event handlers necessary
$slides.bind('swipeleft', function () {
    //this is to go to the next index

    //get current slide index and figure out the next one
    var currentIndex = $(this).index();
    if ((currentIndex + 1) < slideCount) {
        currentIndex++;
    } else {
        //the end was reached, so go back to the first tab
        currentIndex = 0;
    }

    //now select the new tab
    $("#photo-rotator").tabs( "select" , currentIndex);
}).bind('swiperight', function () {
    //this is to go to the previous index

    //get current slide index and figure out the previous one
    var currentIndex = $(this).index();
    if ((currentIndex - 1) >= 0) {
        currentIndex--;
    } else {
        //the beginning was reached, so go to the last tab
        currentIndex = slideCount;
    }

    //now select the new tab
    $("#photo-rotator").tabs( "select" , currentIndex);
}); 
```

# html - 在 html5 应用上录制音频

> ID：10624478
> 
> 赞同：0
> 
> 时间：2012-05-16T18:28:10.933
> 
> 标签：html, audio, recording

我正在尝试构建一个 html5 应用程序，其中一部分需要录制长度应长达一分钟的音频，然后将其编码为基于 64 位的音频，因此我进行了相当多的搜索，但没有找到好的答案。

有没有办法在 html5 应用程序上使用 Html5、Javascript 或本地 API 录制音频，尤其是在 IOS 设备上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T23:18:18.083

Html5 还没有一种被广泛接受的录制音频的方法。如果您的目标是非 iOS，您可以使用 flash 或任何数量的调用 flash 的 javascript 包装器（例如[http://www.sajithmr.me/jrecorder-jquery](http://www.sajithmr.me/jrecorder-jquery)我认为[soundmanager2](http://www.schillmania.com/projects/soundmanager2/)也可以，但我我不确定）。对于 iOS，您仍然需要编写一个应用程序。:(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T10:43:48.020

简短的回答是暂时不。因为尚未在 HTML5 浏览器中实现音频。方法有效，但您无法捕获任何音频。

那么这里给你一个详细的答案：[Recording html5 audio](https://stackoverflow.com/questions/10718183/recording-html5-audio/12618246#12618246)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-27T13:15:00.257

这可能为时已晚，但话虽如此，Chrome 和 Firefox 现在都完全支持`getUserMedia` ，如果需要，您可以将它与 AudioContext 接口一起使用，直接从浏览器捕获音频。

下面的 gitHub 项目录制音频并使用 HTML5 和 JS 直接在浏览器中将其保存为 MP3 格式。

录音保存在base64中，录音后也可以直接在浏览器中收听。

该项目可以在这里找到： [https ://github.com/nusofthq/Recordmp3js](https://github.com/nusofthq/Recordmp3js)

并且是 RecorderJS 的扩展，它也使用 libmp3lame.js。

如果您希望可以阅读有关实际实现的更多详细信息：http: [//nusofthq.com/blog/recording-mp3-using-only-html5-and-javascript-recordmp3-js/](http://nusofthq.com/blog/recording-mp3-using-only-html5-and-javascript-recordmp3-js/)

# php - 使用引用变量 VS 用于自定义方法调用的公共类变量

> ID：10624479
> 
> 赞同：2
> 
> 时间：2012-05-16T18:28:11.303
> 
> 标签：php

我遇到了一个奇怪的情况，也许你可以帮助我理解这一点。

```
$object = array('controller' => 'frontend_shop', 'method' => 'category');

include_once(PATH.'controllers/'.$object['controller'].'.php');

$controller = new $object['controller']($object);

class Frontend_shop extends Controller {

   public $controller;

   public function __construct($object)
   {

    // Works
    $this->$object['method']();

    //Don´t work
    $this->controller = $object;
    $this->controller['method']();

    }

   public function category()
   {
       echo 'hello';
   }
} 
```

这有效并显示“你好”

```
 $this->$object['method'](); 
```

但是当我将此数组分配给一个类变量时，例如：

```
 $this->controller = $object;
    $this->controller['method'](); 
```

我得到：

```
Fatal error: Call to undefined function category() in /usr/lib/app/application/controllers/frontend_shop.php on line 10 
```

当然我知道我可以使用第一种方法，但也许你可以解释一下类变量的方法有什么问题。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:37:57.950

你需要类似的东西

```
$this->{$this->controller['method']}(); 
```

`$this->controller['method']`解析为字符串（方法名称）。但是必须在对象上调用方法（否则它们是函数，而不是方法），这就是其他`$this->`解决方案的来源。

我更喜欢

```
$callable = array($this, $this->controller['method']);
call_user_func($callable); 
```

我不喜欢乱七八糟的调用语法，因为你必须仔细查看代码才能看到真正发生了什么。

[http://php.net/manual/en/function.call-user-func.php](http://php.net/manual/en/function.call-user-func.php)

[http://www.php.net/manual/en/language.types.callable.php](http://www.php.net/manual/en/language.types.callable.php)

# ruby-on-rails - Capybara 在测试中可能出现路由问题，导致我的 NoElementFound 错误？

> ID：10624483
> 
> 赞同：0
> 
> 时间：2012-05-16T18:28:23.520
> 
> 标签：ruby-on-rails, rspec, capybara

Capybara 在我的测试中给了我 NoElementFound 错误我的测试

```
Describe "agenda pages" do
    subject { page }

    login_user

    describe "Agenda Creation" do
        before { visit users_path }

        describe "with invalid information" do
            it "should not create an agenda" do
                expect { click_button "Post" }.should_not change(Agenda, :count)
            end
            describe "error message" do
                before  { click_button "Post" }
                it { should have_content('error') }
            end
        end

        describe "with valid information" do
            before  { fill_in 'agenda_subject', with: "Lorem Ipsum" }
            it "should create a an agenda" do
                expect { click_button "Post" }.should change(Agenda, :count).by(1)
            end
        end

    end 
```

结尾

我怀疑水豚因为我访问 users_path 而没有找到该元素，它只是没有看到该页面。请注意，行为在生产力方面符合预期并且正在工作）如果我将其更改为 root_path，我会得到同样的错误。我的 spec_helper 文件启用了 url_helpers 并且表单正确且值正确。至少我确定, 表格在帖子的末尾我的路线

```
 root        /                              users#index
                    root        /                              home#index
        new_user_session GET    /users/sign_in(.:format)       devise/sessions#new
            user_session POST   /users/sign_in(.:format)       devise/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)      devise/sessions#destroy
           user_password POST   /users/password(.:format)      devise/passwords#create
       new_user_password GET    /users/password/new(.:format)  devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format) devise/passwords#edit
                         PUT    /users/password(.:format)      devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)        devise/registrations#cancel
       user_registration POST   /users(.:format)               devise/registrations#create
   new_user_registration GET    /users/sign_up(.:format)       devise/registrations#new
  edit_user_registration GET    /users/edit(.:format)          devise/registrations#edit
                         PUT    /users(.:format)               devise/registrations#update
                         DELETE /users(.:format)               devise/registrations#destroy
                   users GET    /users(.:format)               users#index
                 agendas POST   /agendas(.:format)             agendas#create
                  agenda DELETE /agendas/:id(.:format)         agendas#destroy 
```

路线文件

```
Engage::Application.routes.draw do
  authenticated :user do
    root to: 'users#index'
  end
  root :to => "home#index"
  devise_for :users
  resources :users, only: [:index]
  resources :agendas, only: [:create, :destroy]
end 
```

我正在使用规范和设计。这是呈现的形式：

```
<%= form_for(@agenda) do |f| %>
  <div class="field">
    <%= f.text_area :subject, placeholder: "Compose new agenda..." %>
  </div>
  <%= f.submit "Post", class: "btn btn-large btn-primary" %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:08:15.637

所以，对于控制器测试，你真的不应该使用 capybara。Capybara 是一个用于驱动浏览器的集成测试库。要直接测试控制器，您将设置一个请求并发布/获取/放置/等到有问题的操作，并验证您从操作中得到了您期望的结果。通常这将验证记录是否已创建或检查实例变量的内容。

您的控制器不知道路由。单元测试的重点是测试它与这些其他组件隔离。要与 Capybara 一起测试它，请进行集成测试。（集成 = 一次不止一件事！）

例如：

```
expect { post :create, agenda: FactoryGirl.attributes_for(:agenda)}.to change(Agenda, :count).by(1)

agenda = FactoryGirl.create(:agenda)
get :show, id: agenda
assigns(:agenda).should eq agenda 
```

# symfony - symfony2 - 尝试保留在一对多/多对一中使用的表单数据时出错

> ID：10624487
> 
> 赞同：0
> 
> 时间：2012-05-16T18:28:32.483
> 
> 标签：symfony, doctrine-orm, symfony-forms

我有一个提交文章的表格。该表单有一个类别多选框，它使用我的 Category.php 实体从数据库中提取类别。表单生成正常，但尝试提交时出现以下错误：

```
Property "categories" is not public in class "Natknow\EditorBundle\Entity\Article". Maybe you should create the method "setCategories()"? 
```

**模板表格代码：**

```
[...]
<div id="artFormG1">
    <?php echo $view['form']->row($form['title']) ?>
    <?php echo $view['form']->row($form['description']) ?>
    <?php echo $view['form']->row($form['source']) ?>
</div>

<div id="artFormG2">
    <?php echo $view['form']->row($form['categories']) ?>
</div>

<?php echo $view['form']->row($form['body']) ?>
<br />
<input class="button" type="submit" formnovalidate = "true" />

<?php echo $view['form']->rest($form) ?>
[...] 
```

**ArticleType.php - 表单类**

```
[...]
    $builder->add('title', 'text', array(
        'attr' => array('class' => 'artFormLeft')
    ));
    $builder->add('description', 'text', array(
        'attr' => array('class' => 'artFormLeft')
    ));
    $builder->add('source', 'text', array(
        'attr' => array('class' => 'artFormLeft')
    ));
    $builder->add('categories', 'entity',
        array('class' => 'NatknowEditorBundle:Category',
            'property' => 'name',
            'expanded' => false,
            'multiple' => true,
        )
    );
    $builder->add('body', 'textarea', array(
        'attr' => array('class' => 'tinymce'),
    ));
[...] 
```

**Article.php - 文章表实体**

```
[...]

/**
 * Add categories
 *
 * @param Natknow\EditorBundle\Entity\ArticleCategory $categories
 */
public function addArticleCategory(\Natknow\EditorBundle\Entity\ArticleCategory $categories)
{
    $this->categories[] = $categories;
}

/**
 * Get categories
 *
 * @return Doctrine\Common\Collections\Collection 
 */
public function getCategories()
{
    return $this->categories;
}
[...] 
```

**ArticleCatigory.php - article_category 表实体**

```
[...]
/**
 *  @ORM\Id
 *  @ORM\Column(type="integer")
 *  @ORM\GeneratedValue(strategy="AUTO")
*/
protected $id;

/**
 *  @ORM\ManyToOne(targetEntity="Article", inversedBy="categories", cascade={"all"})
*/
protected $article;

/**
 *  @ORM\ManyToOne(targetEntity="Category", inversedBy="articles", cascade={"all"})
*/
protected $category;

/**
 *  @ORM\Column(type="smallint")
*/
protected $isParent = 0;

/**
 * Get id
 *
 * @return integer 
 */
public function getId()
{
    return $this->id;
}

/**
 * Set isParent
 *
 * @param smallint $isParent
 */
public function setIsParent($isParent)
{
    $this->isParent = $isParent;
}

/**
 * Get isParent
 *
 * @return smallint 
 */
public function getIsParent()
{
    return $this->isParent;
}

/**
 * Set article
 *
 * @param Natknow\EditorBundle\Entity\Article $article
 */
public function setArticle(\Natknow\EditorBundle\Entity\Article $article)
{
    $this->article = $article;
}

/**
 * Get article
 *
 * @return Natknow\EditorBundle\Entity\Article 
 */
public function getArticle()
{
    return $this->article;
}

/**
 * Set category
 *
 * @param Natknow\EditorBundle\Entity\Category $category
 */
public function setCategory(\Natknow\EditorBundle\Entity\Category $category)
{
    $this->category = $category;
}

/**
 * Get category
 *
 * @return Natknow\EditorBundle\Entity\Category 
 */
public function getCategory()
{
    return $this->category;
}
[...] 
```

**Category.php - 类别表实体**

```
[...]
/**
 * Add articles
 *
 * @param Natknow\EditorBundle\Entity\ArticleCategory $articles
 */
public function addArticleCategory(\Natknow\EditorBundle\Entity\ArticleCategory $articles)
{
    $this->articles[] = $articles;
}

/**
 * Get articles
 *
 * @return Doctrine\Common\Collections\Collection 
 */
public function getArticles()
{
    return $this->articles;
}
[...] 
```

**控制器：**

```
[...]
$art = new Article();

        $em = $this->getDoctrine()
            ->getEntityManager();
        $repo = $this->getDoctrine()
            ->getRepository('NatknowEditorBundle:Article');

        $success = "<h3>Use this form to add an article:</h3>";

        $form = $this->createForm(new ArticleType(), $art);

        if ($request->getMethod() == 'POST') {
            $form->bindRequest($request);

            if ($form->isValid()) {
                $em = $this->getDoctrine()->getEntityManager();
                $em->persist($art);
                $em->flush();

                $success = "You have successfully added the article '"
                . $art->getName() . "'!";

                $articles = $repo->findAllPastDay();
            }else {
                $success = "There was an error validating the form data!";
            }

            return $this->render('NatknowEditorBundle:Default:insertArticle.html.php',
                array('form' => $form->createView(), 'status' => $success, 'arts' => $articles,)
            );
        }
[...] 
```

注意：我使用命令行实用程序生成 ArticleCategory.php 实体，没有错误。但是，我不能 100% 确定它是否可以做我想做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T22:30:25.900

您需要将 setCatagories() 添加到 Article 实体以克服发布的错误。

可能会遇到其他问题。让多对多表单按需要工作可能很棘手。

变得非常熟悉：

[http://symfony.com/doc/current/cookbook/form/form_collections.html](http://symfony.com/doc/current/cookbook/form/form_collections.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T10:59:39.847

你应该命名`addArticleCategory()`为`addCategory()`，然后 Symfony (master) 会很好地识别它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T12:09:33.953

不要忘记使用：

```
Doctrine\Common\Collections\ArrayCollection; 
```

和：

```
public function __construct()
{
    $this->categories = new ArrayCollection();
} 
```

（文章.php）

不确定这是否是问题，但我遇到了类似的问题。

# crystal-reports - Crystal Reports 详细信息部分抑制空白部分已锁定

> ID：10624494
> 
> 赞同：1
> 
> 时间：2012-05-16T18:29:01.437
> 
> 标签：crystal-reports, crystal-reports-xi, suppression

我正在尝试修改公司的报告，但代码编辑器似乎无法编辑。该报告有我想有条件地抑制行的详细信息部分。当我单击 Suppress Blank Rows 部分的 X-2 编辑器时，Non Drill Down 部分的代码编辑器视图包含代码，但无法更改。背景为灰色，无法更改。有谁知道如何或在哪里编辑本节的代码？

# android - Android/iOS 上的蓝牙游戏

> ID：10624496
> 
> 赞同：3
> 
> 时间：2012-05-16T18:29:13.643
> 
> 标签：android, ios, bluetooth, android-networking, wireless

如何使用我的 iPhone 和我朋友的 Android 设备下蓝牙国际象棋？阿皮？（可能与其他问题重复）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:40:50.160

[ZeroConf](http://jmdns.sourceforge.net/) aka [Bonjour](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/NetServices/Introduction.html#//apple_ref/doc/uid/TP40002445-SW1)是发现其他提供服务的设备的好方法，它仅限于本地网络。它最好的功能之一是它不需要任何先验知识或设置——它的任务是*服务发现*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:47:31.063

以下链接提供了一本名为《**开始 IOS 游戏中心和游戏套件：适用于 iPhone、iPad 和 iPod Touch**》的书，希望对您有所帮助。祝您好运。

[http://books.google.co.in/books?id=C9xVXg3w-LcC&pg=PA2&lpg=PA2&dq=gamekit+for+networking+in+ios&source=bl&ots=tcO-uKk5ZC&sig=g4ft4nUBep40NCHj9skyLK6fWJQ&hl=en&sa=X&ei=hPWzT6_TGY2zrAe-jMm 2&ved=0CGIQ6AEwBw#v=onepage&q=gamekit%20for%20networking%20in%20ios&f=](http://books.google.co.in/books?id=C9xVXg3w-LcC&pg=PA2&lpg=PA2&dq=gamekit%20for%20networking%20in%20ios&source=bl&ots=tcO-uKk5ZC&sig=g4ft4nUBep40NCHj9skyLK6fWJQ&hl=en&sa=X&ei=hPWzT6_TGY2zrAe-jMmADA&sqi=2&ved=0CGIQ6AEwBw#v=onepage&q=gamekit%20for%20networking%20in%20ios&f=false) false

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:44:30.753

为什么不只使用网络服务？这比做蓝牙发现和配对或 wifi 服务器客户端的东西要容易（相信我，至少在后者上）。这是使一切相对网络（即 3g/4g/wifi）独立的最简单方法。您的应用程序只需遵循一个简单的协议，您就可以在任何地方与所有玩家一起玩，无需发现。电池消耗也可能比蓝牙少。

Bonjour 非常适合在同一网络上发现东西（即其他玩家）。bonjour 的问题是你通常需要在同一个 wifi 网络上（虽然不一定，但不要问我这到底是怎么工作的，但显然可以做到）。理论上你还需要申请一个 bonjour/mdns id，虽然这很容易。

这是[一个类似的问题](https://stackoverflow.com/questions/10210835/is-it-possible-to-connect-two-ios-devices-using-sockets-by-getting-their-ip-addr/10436974#10436974)。

# java - java字符串拆分正则表达式

> ID：10624500
> 
> 赞同：1
> 
> 时间：2012-05-16T18:29:34.203
> 
> 标签：java, regex

我有一个 string `(1, 2, 3, 4)`，我想将整数解析成一个数组。

我可以`split(",\\s")`用来拆分除开始和结束元素之外的所有元素。我的问题是如何修改它以便忽略开头和结尾的括号？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:34:29.600

匹配数字而不是匹配它们之间的空格会更好地为您服务。采用

```
final Matcher m = Pattern.compile("\\d+").matcher("(1, 2, 3, 4)");
while (m.find()) System.out.println(Integer.parseInt(m.group())); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:34:21.337

使用 2 个正则表达式：第一个删除括号，第二个拆分：

```
Pattern p = Pattern.compile("\\((.*)\\)");
Matcher m = p.matcher(str);
if (m.find()) {
    String[] elements = m.group(1).split("\\s*,\\s*");
} 
```

并注意我对您的拆分正则表达式的修改。它更加灵活和安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T18:40:22.570

你可以使用 substring() 然后 split(",")

```
 String s = "(1,2,3,4)";
  String s1 = s.substring(1, s.length()-2);//index should be 1 to length-2
  System.out.println(s1);

  String[] ss = s1.split(",");
  for(String t : ss){
    System.out.println(t);
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T18:32:23.943

改为使用它`split("[^(),\\s]")`。

# php - 如何使 phpmyadmin 与 kohana 网站一起工作？(.htaccess)

> ID：10624502
> 
> 赞同：1
> 
> 时间：2012-05-16T18:29:42.457
> 
> 标签：php, .htaccess, phpmyadmin, kohana

今天我试图将 phpmyadmin 上传到带有 kohana 站点的文件夹之一，但事实证明，我得到的是空白页面，而不是 phpmyadmin。所以我认为这是在站点根目录的.htaccess 中重写规则的问题。

.htaccess 文件有以下几行：

```
RewriteEngine On
RewriteBase /
<Files .*>
    Order Deny,Allow
    Deny From All
</Files>
RewriteRule ^(?:application|modules|system)\b.* index.php/$0 [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Rewrite all other URLs to index.php/URL
RewriteRule .* index.php/$0 [PT] 
```

我的 phpmyadmin index.php 文件位于 phpmyadmin/ 目录中，但是，据我所知，每个请求都被重定向到根目录中的 index.php。如何使 phpmyadmin 工作而不破坏 kohana 的路由？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:48:05.897

`RewriteCond`只需在最后一个之前添加另一个`RewriteRule`：

```
RewriteCond %{REQUEST_URI} !^/phpmyadmin 
```

或者更明确地说，您可以在现有`RewriteCond`s 之前添加另一个规则：

```
RewriteCond %{REQUEST_URI} ^/phpmyadmin
RewriteRule ^.*$ - [NC,L] 
```

# c# - 控制空间？在产品说明中

> ID：10624504
> 
> 赞同：0
> 
> 时间：2012-05-16T18:29:52.307
> 
> 标签：c#, string, padleft

好吧，我有一台打印机，我打印他们的价格

```
4      $297.41$297.41$892.24
11         $135   $135  $1350
5       $211.2     $0$1056.03
4       $211.2 $211.2$633.62
3      $318.96$206.89   $750
1      $172.41     $0$172.41
2      $172.41$172.41$172.41
1      $172.41     $0$172.41
1      $172.41     $0$172.41
1      $172.41     $0$172.41
1      $189.65     $0$189.65
1      $189.65     $0$189.65 
```

我需要一些东西：

```
4   $297.41 $297.41 $892.24
11  $135    $135    $1350
5   $211.2  $0      $1056.03
4   $211.2  $211.2  $633.62
3   $318.96 $206.89 $750
1   $172.41 $0      $172.41
2   $172.41 $172.41 $172.41
1   $172.41 $0      $172.41
1   $172.41 $0      $172.41
1   $172.41 $0      $172.41
1   $189.65 $0      $189.65
1   $189.65 $0      $189.65 
```

这是我的 C# 代码

```
 file.WriteLine(cantidad+preciouni.PadLeft(13,' ')+desctot.PadLeft(7,' ')+stotal.PadLeft(7,' ')); 
```

但这是我的第一个例子，我必须如何使用它？左手边？还是padleft？非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:39:56.820

您可以使用内置格式代码来做到这一点：

```
file.WriteLine(
    string.Format(
        "{0,-3} {1,-13}, {2,-7} {3,-7}",
        cantidad,preciouni,desctot,stotal
    )
); 
```

在宽度格式中使用负数使字符串左对齐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:40:09.513

我会使用[对齐格式](http://msdn.microsoft.com/en-us/library/txafckwd)：

```
file.WriteLine(String.Format("{0,-5}{1,13}{2,7}{3,7}", 
                             cantidad, preciouni, desctot, stotal)); 
```

逗号后面的数字是要填充的空格数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T18:37:12.613

我认为您需要做的就是从切换`PadLeft`到[`PadRight`](http://msdn.microsoft.com/en-us/library/system.string.padright.aspx)：

> 返回一个指定长度的新字符串，其中当前字符串的末尾用空格或指定的 Unicode 字符填充。

由于您希望列字段左对齐，因此您必须向右填充。

```
file.WriteLine(
    cantidad.PadRight(5, ' ') +
   preciouni.PadRight(9, ' ') +
     desctot.PadRight(9, ' ') + 
      stotal.PadRight(9, ' ')); 
```

# uiwebview - 如果 使用远程 url 指定，并且用户播放文件，文件是流式传输还是下载？

> ID：10624505
> 
> 赞同：0
> 
> 时间：2012-05-16T18:30:02.670
> 
> 标签：uiwebview

如果我使用 UIWebView 启动网页并且该页面包含一个带有指定远程视频文件的 url 的标签，那么当用户单击视频观看它时会发生什么？

网络引擎是否会流式传输视频，或者将其下载到某个地方，如果它下载了它，那么它在我的应用程序中播放时是否放置在我的应用程序的沙箱中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:33:09.217

UIWebView 只是创建一个 Safari 浏览器组件，因此它应该具有与它相同的行为。

Safari 的 HTML5 中的标签支持 MP4 格式的视频和 AAC 或 MP3 格式的音频。它将通过[HTTP Live Streaming](http://www.longtailvideo.com/html5/hls/)和（仅在 iOS 中）[Adaptive Streaming](http://www.longtailvideo.com/html5/#adaptive_streaming)进行流式传输。我相信这将在 Safari 的沙箱中完成。

# postgresql-9.1 - 寻找一种策略来避免 PostgreSQL 模式中的循环依赖

> ID：10624507
> 
> 赞同：1
> 
> 时间：2012-05-16T18:30:07.420
> 
> 标签：postgresql-9.1

在我的数据库中，我拥有`schema a`依赖于 的实体`schema b`，并且`schema b`拥有依赖于 的实体`schema a`。这是一年多的增量发展。现在，将数据库迁移到另一台服务器失败了。当我`pgdump`从一台服务器获取架构并尝试`pg_restore`在另一台服务器上使用它时，它会发出嘶哑的声音。我能做些什么来绕过，无论是现在还是未来的好策略？

# python - 升级python而不破坏yum

> ID：10624511
> 
> 赞同：60
> 
> 时间：2012-05-16T18:30:20.570
> 
> 标签：python, centos, yum

我最近通过从源代码编译在 CentOS 机器上安装了 Python 2.7.3。Python 2.7.3 安装在 /opt/python2.7 中，当我安装它时，我只是将 /usr/bin/python 更改为指向新版本。这显然是错误的，因为当我这样做时它打破了百胜。我会得到以下。

```
There was a problem importing one of the Python modules
required to run yum. The error leading to this problem was:

   No module named yum

Please install a package which provides this module, or
verify that the module is installed correctly.

It's possible that the above module doesn't match the
current version of Python, which is:
2.7.3 (default, May 15 2012, 17:45:42) 
[GCC 4.4.4 20100726 (Red Hat 4.4.4-13)]

If you cannot solve this problem yourself, please go to 
the yum faq at:
  http://yum.baseurl.org/wiki/Faq 
```

我将 /usr/bin/python 更改为指向 python 2.6.6，但现在 2.6.6 是 python 的默认版本。知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2012-06-25T20:30:08.543

我写了一份关于如何在 CentOS 6 和 CentOS 7 上安装最新版本的 Python 2 和 Python 3的[快速指南。它目前涵盖 Python 2.7.13 和 Python 3.6.0：](https://danieleriksson.net/2017/02/08/how-to-install-latest-python-on-centos/)

```
# Start by making sure your system is up-to-date:
yum update
# Compilers and related tools:
yum groupinstall -y "development tools"
# Libraries needed during compilation to enable all features of Python:
yum install -y zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel expat-devel
# If you are on a clean "minimal" install of CentOS you also need the wget tool:
yum install -y wget 
```

后续步骤取决于您安装的 Python 版本。

对于 Python 2.7.14：

```
wget http://python.org/ftp/python/2.7.14/Python-2.7.14.tar.xz
tar xf Python-2.7.14.tar.xz
cd Python-2.7.14
./configure --prefix=/usr/local --enable-unicode=ucs4 --enable-shared LDFLAGS="-Wl,-rpath /usr/local/lib"
make && make altinstall

# Strip the Python 2.7 binary:
strip /usr/local/lib/libpython2.7.so.1.0 
```

对于 Python 3.6.3：

```
wget http://python.org/ftp/python/3.6.3/Python-3.6.3.tar.xz
tar xf Python-3.6.3.tar.xz
cd Python-3.6.3
./configure --prefix=/usr/local --enable-shared LDFLAGS="-Wl,-rpath /usr/local/lib"
make && make altinstall

# Strip the Python 3.6 binary:
strip /usr/local/lib/libpython3.6m.so.1.0 
```

要安装 Pip：

```
# First get the script:
wget https://bootstrap.pypa.io/get-pip.py

# Then execute it using Python 2.7 and/or Python 3.6:
python2.7 get-pip.py
python3.6 get-pip.py

# With pip installed you can now do things like this:
pip2.7 install [packagename]
pip2.7 install --upgrade [packagename]
pip2.7 uninstall [packagename] 
```

您不应该更改 Python 的系统版本，因为它会破坏系统（如您所见）。只要您不理会原始系统版本，安装其他版本就可以正常工作。这可以通过`/usr/local`在运行 configure 时使用自定义前缀（例如 ）来完成，并在安装 Python 构建时使用`make altinstall`（而不是正常的）来完成。`make install`

只要您记得输入包含版本号的全名（例如“python2.7”或“pip2.7”），拥有多个可用的 Python 版本通常不是什么大问题。如果您从 virtualenv 完成所有 Python 工作，则版本控制会为您处理，因此请确保您安装并使用 virtualenv！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-05-15T04:59:20.757

```
vim `which yum`
modify #/usr/bin/python to #/usr/bin/python2.4 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-16T18:34:30.847

将`/opt/python2.7/bin`您的`PATH`环境变量放在...前面，`/usr/bin`或者只是习惯于键入`python2.7`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-05T11:50:38.077

[pythonz](https://github.com/saghul/pythonz)是 pythonbrew的一个活跃分支，使这变得轻而易举。您可以安装一个版本：

```
# pythonz install 2.7.3 
```

然后设置一个符号链接：

```
# ln -s /usr/local/pythonz/pythons/CPython-2.7.3/bin/python2.7 /usr/local/bin/python2.7
# python2.7 --version
Python 2.7.3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-28T04:11:19.803

```
ln -s /usr/local/bin/python2.7 /usr/bin/python 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-28T14:40:04.127

好吧，对我来说，正在修复的错误是安装了不同版本的 python 并且 yum 找不到某个 .so 文件并引发异常。
yum 根据错误想要 2.7.5。

```
which python gives me /usr/bin/python
python --version gives me 2.7.5 
```

对我来说，解决方法是将 /lib64 附加到 LD_LIBRARY_PATH 环境变量中。相关内容为/lib64/python2.7和/lib64/python3.6。

```
export LD_LIBRARY_PATH=/lib64:$LD_LIBRARY_PATH 
```

为我修复了安装多个 python 版本的 yum 错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-22T20:20:35.880

丹尼尔的[答案](https://stackoverflow.com/a/11196864/2016436)可能是最理想的答案，因为它不涉及更改操作系统文件。但是，我发现自己需要一个通过调用来调用 python 的 3rd 方程序`usr/bin/python`，但需要 Python 2.7.16，而默认的 Python 是 2.7.5。这意味着我必须`usr/bin/python`指出 2.7.16 版本的 Python 版本，这意味着那`yum`行不通。

我最终做的是编辑文件`/usr/bin/yum`并将那里的 shebang 替换为系统默认 Python（在我的情况下，这意味着更改`#! /usr/bin/python`为`#! /usr/bin/python2`）。但是，在那之后运行`yum`给了我一个错误：

```
ImportError: No module named urlgrabber.grabber 
```

我通过以`/usr/libexec/urlgrabber-ext-down`与`/usr/bin/yum`. 即，`#! /usr/bin/python`到`#! /usr/bin/python2`。之后`yum`工作。

这是一个 hack，应该小心使用。正如其他评论中提到的，修改操作系统文件应该是最后的手段。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-05-03T16:13:25.547

如果你想尝试 rpm 包，你可以安装基于最新 Fedora rpms 的二进制包，但在 RHEL6/CentOS6/ScientificLinux-6 上重新编译：

```
http://www.jur-linux.org/download/el-updates/6/ 
```

此致，

弗洛里安·拉罗什

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-09-10T21:59:39.320

相反，我建议更新相关脚本（例如 /usr/bin/yum）中的路径，以指向您以前的 Python 作为解释器。

理想情况下，您希望升级 yum 及其相关脚本，以便安装的默认 Python 支持它们。

如果那是不可能的，以上是完全可行和经过测试的。

改变：

```
#!/usr/bin/python 
```

无论您的旧版本的路径是什么，直到您可以进行上述 yum 改进。

如果您有一台独立的机器，没有时间手动升级 rpm 或无法临时或永久连接到标准 yum 存储库，则您无法执行上述操作。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2019-04-07T06:18:30.133

我读了一篇评论，指出现在可以运行以下命令。我没有测试过自己，所以要小心。

```
$ yum install -y epel-release
$ yum install -y python36 
```

# iphone - 如何使不同项目大小的网格视图调整为不同大小？

> ID：10624513
> 
> 赞同：2
> 
> 时间：2012-05-16T18:30:25.050
> 
> 标签：iphone, gridview

我正在尝试使用不同大小（三种类型）的框（项目）制作网格视图，我已经实现了这个

[https://github.com/tanin47/UIGridView](https://github.com/tanin47/UIGridView)

但不能真正制作三种不同类型的单元格并在网格视图中对齐它们。

我正在尝试像这样调用不同的单元格：

```
- (UIGridViewCell *) gridView:(UIGridView *)grid cellForRowAt:(int)rowIndex AndColumnAt:(int)columnIndex
{
    NSMutableDictionary *dic = [testArray objectAtIndex:rowIndex * 2 +columnIndex] ;

    if ([[dic objectForKey:@"type"] isEqualToString:@"one"]) {
        Cell *cell = (Cell *)[grid dequeueReusableCell];

        if (cell == nil) {
            cell = [[Cell alloc] init];
        }
        NSLog(@"dic:%@",dic);
        //  cell.label.text = [NSString stringWithFormat:@"(%d,%d)", rowIndex, columnIndex];
        cell.label.text = [dic objectForKey:@"handa"];
        return cell;

    }
    else {
        CellTpye2 *cell = (CellTpye2 *)[grid dequeueReusableCell];

        if (cell == nil) {
            cell = [[CellTpye2 alloc] init];
        }

        NSLog(@"dic:%@",dic);
        //  cell.label.text = [NSString stringWithFormat:@"(%d,%d)", rowIndex, columnIndex];
        cell.label.text = [dic objectForKey:@"handa"];
        return cell;
    }

} 
```

我在做正确的调用，这可以在这个网格视图中完成吗？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-17T17:51:12.430

uicollectionview insets 解决了问题，抱歉更新晚了

# perl - How to capture a certain group of lines using perl regex?

> ID：10624516
> 
> 赞同：0
> 
> 时间：2012-05-16T18:30:35.003
> 
> 标签：perl

How to remove a trailing blank space in a regex substitution?

Here the Data

```
 __Data__
              Test - results 
              dkdkdkdkdkdkdkdkdkkkdkd
              slsldldldldldldldldldll
              Information
              ddkdkdkeieieieieieieiei
              eieieieieieieieieieieiei
              Test - summary
              dkdkdkdkdkdkdkdkkdkdkdk
              dkdkdkdkdkdkdkdkdkdkdkk 
```

What I would like to remove these lines shown above:

```
 Information
              ddkdkdkeieieieieieieiei
              eieieieieieieieieieieiei 
```

My attempt using regex expression

```
 $/ = "__Data__";

           $_ =~ s/^(Test.*[^\n]+)\n(Information.*[^\n]+)\n(Test.*Summary[^\n]+)/$1$3/ms;
              print $_ 
```

The input of the data is the same as the output. In other words, nothing changes.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:40:29.363

Why not this:

```
while (<DATA>) {
    if ( m/^Information/..m/^Test/ ) {
        next unless m/^Test/;
    }
    s{\s+$}{};
    print "$_\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T20:03:43.850

if you want to remove the information section use

```
$s =~ s/Information.*Test/Test/s; 
```

if $s contains the data you gave then the following is returned

```
Test - results 
dkdkdkdkdkdkdkdkdkkkdkd
slsldldldldldldldldldll
Test - summary
dkdkdkdkdkdkdkdkkdkdkdk
dkdkdkdkdkdkdkdkdkdkdkk 
```

If you want the information only then use

```
$s =~ s/(.*?)(Information.*?)(Test.*)/$2/s; 
```

In both cases notice the the "s" at the end of the substitution, that flag allows it to process multiple lines.

# java - java.lang.RuntimeException：SDK 更新后无法实例化活动 ComponentInfo

> ID：10624520
> 
> 赞同：5
> 
> 时间：2012-05-16T18:30:40.337
> 
> 标签：java, android

我最近更新了 Android 3.2 SDK，从那以后我无法运行我的应用程序，没有它立即强制退出并给出“无法实例化活动 ComponentInfo”错误。我已经检查了有关该主题的所有帖子，并且相信我已经涵盖了导致此错误的所有常见问题。我相信这可能与集成的谷歌地图有关，但在更新之前它工作正常。这是 LogCat 和清单。主要活动课程非常大，所以我想避免发布。

```
05-16 14:08:16.313: I/dalvikvm(2880): Failed resolving 

Lcnp/apps/dronecontrol/DroneControlActivity; interface 112 'Lslickdevlabs/apps/usb2seriallib/AdapterConnectionListener;'
05-16 14:08:16.313: W/dalvikvm(2880): Link of class 'Lcnp/apps/dronecontrol/DroneControlActivity;' failed
05-16 14:08:16.313: D/AndroidRuntime(2880): Shutting down VM
05-16 14:08:16.313: W/dalvikvm(2880): threadid=1: thread exiting with uncaught exception (group=0x40239760)
05-16 14:08:16.313: E/AndroidRuntime(2880): FATAL EXCEPTION: main
05-16 14:08:16.313: E/AndroidRuntime(2880): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{cnp.apps.dronecontrol/cnp.apps.dronecontrol.DroneControlActivity}: java.lang.ClassNotFoundException: cnp.apps.dronecontrol.DroneControlActivity in loader dalvik.system.PathClassLoader[/system/framework/com.google.android.maps.jar:/data/app/cnp.apps.dronecontrol-2.apk]
05-16 14:08:16.313: E/AndroidRuntime(2880):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1739)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1831)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at android.app.ActivityThread.access$500(ActivityThread.java:122)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1024)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at android.os.Looper.loop(Looper.java:132)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at android.app.ActivityThread.main(ActivityThread.java:4123)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at java.lang.reflect.Method.invokeNative(Native Method)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at java.lang.reflect.Method.invoke(Method.java:491)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at dalvik.system.NativeStart.main(Native Method)
05-16 14:08:16.313: E/AndroidRuntime(2880): Caused by: java.lang.ClassNotFoundException: cnp.apps.dronecontrol.DroneControlActivity in loader dalvik.system.PathClassLoader[/system/framework/com.google.android.maps.jar:/data/app/cnp.apps.dronecontrol-2.apk]
05-16 14:08:16.313: E/AndroidRuntime(2880):     at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:251)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at java.lang.ClassLoader.loadClass(ClassLoader.java:540)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at java.lang.ClassLoader.loadClass(ClassLoader.java:500)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at android.app.Instrumentation.newActivity(Instrumentation.java:1022)
05-16 14:08:16.313: E/AndroidRuntime(2880):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1730)
05-16 14:08:16.313: E/AndroidRuntime(2880):     ... 11 more
05-16 14:13:50.023: I/dalvikvm(2918): Failed resolving Lcnp/apps/dronecontrol/DroneControlActivity; interface 112 'Lslickdevlabs/apps/usb2seriallib/AdapterConnectionListener;'
05-16 14:13:50.023: W/dalvikvm(2918): Link of class 'Lcnp/apps/dronecontrol/DroneControlActivity;' failed
05-16 14:13:50.023: D/AndroidRuntime(2918): Shutting down VM
05-16 14:13:50.023: W/dalvikvm(2918): threadid=1: thread exiting with uncaught exception (group=0x40239760)
05-16 14:13:50.023: E/AndroidRuntime(2918): FATAL EXCEPTION: main
05-16 14:13:50.023: E/AndroidRuntime(2918): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{cnp.apps.dronecontrol/cnp.apps.dronecontrol.DroneControlActivity}: java.lang.ClassNotFoundException: cnp.apps.dronecontrol.DroneControlActivity in loader dalvik.system.PathClassLoader[/system/framework/com.google.android.maps.jar:/data/app/cnp.apps.dronecontrol-1.apk]
05-16 14:13:50.023: E/AndroidRuntime(2918):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1739)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1831)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at android.app.ActivityThread.access$500(ActivityThread.java:122)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1024)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at android.os.Looper.loop(Looper.java:132)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at android.app.ActivityThread.main(ActivityThread.java:4123)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at java.lang.reflect.Method.invokeNative(Native Method)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at java.lang.reflect.Method.invoke(Method.java:491)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at dalvik.system.NativeStart.main(Native Method)
05-16 14:13:50.023: E/AndroidRuntime(2918): Caused by: java.lang.ClassNotFoundException: cnp.apps.dronecontrol.DroneControlActivity in loader dalvik.system.PathClassLoader[/system/framework/com.google.android.maps.jar:/data/app/cnp.apps.dronecontrol-1.apk]
05-16 14:13:50.023: E/AndroidRuntime(2918):     at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:251)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at java.lang.ClassLoader.loadClass(ClassLoader.java:540)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at java.lang.ClassLoader.loadClass(ClassLoader.java:500)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at android.app.Instrumentation.newActivity(Instrumentation.java:1022)
05-16 14:13:50.023: E/AndroidRuntime(2918):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1730)
05-16 14:13:50.023: E/AndroidRuntime(2918):     ... 11 more 
```

这是清单，我相信错误就在这里，我更新 SDK 后没有更改任何代码，它刚刚开始崩溃

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="cnp.apps.dronecontrol"
    android:versionCode="7"
      android:versionName="1.6">
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"></uses-permission>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"></uses-permission>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"></uses-permission>
    <uses-sdk android:minSdkVersion="13" />
    <uses-feature android:name="android.hardware.usb.host" android:required="true"></uses-feature>

    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <uses-library android:name="com.google.android.maps" />
        <activity android:name=".DroneControlActivity"
                  android:windowSoftInputMode="adjustPan|stateHidden"
                  android:label="@string/app_name"
                  android:launchMode="singleTask" android:screenOrientation="landscape">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>

            <intent-filter>
                <action android:name="android.hardware.usb.action.USB_DEVICE_ATTACHED" />
            </intent-filter>

            <meta-data android:name="android.hardware.usb.action.USB_DEVICE_ATTACHED"
                android:resource="@xml/device_filter" />
        </activity>
        <activity android:name=".MenuHelper"
                  android:label="@string/app_name" />

    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T18:33:51.607

可怕的 ClassNotFoundException。您必须将第三方库放在“libs”文件夹中并重新引用它们（右键单击、属性、Java 构建路径、库、添加 Jar...）。

# jquery - 如何防止jQuery“fadeToggle”一遍又一遍地循环？

> ID：10624524
> 
> 赞同：0
> 
> 时间：2012-05-16T18:30:47.763
> 
> 标签：jquery

我有一个关于 jQuery 的相对简单的问题（请原谅我是菜鸟）。我在 div 上使用了“fadeToggle”（单击）功能来显示另一个元素，但是如果用户单击 div 说 100 次，我如何阻止动画在每次单击时一遍又一遍地播放？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:44:50.067

您还可以在调用之前验证队列是否为空，

```
$("button").click(function() {
    if (!$animatedElement.queue().length) {
      $animatedElement.fadeToggle("slow", "linear");
    }
});​ 
```

[http://jsfiddle.net/EU5WK/](http://jsfiddle.net/EU5WK/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:37:04.943

我已经看到了这个问题的一个变体，其中使用了`is running?`一种变量：

[http://jsfiddle.net/VRDP9/](http://jsfiddle.net/VRDP9/)

```
running = false;

$("button:first").click(function() {
    if (!running) {
      running = true;
      $("p:first").fadeToggle("slow", "linear", function() { running = false; });
    }
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:34:21.100

您需要设置某种在第一次迭代中激活的指标，然后在该函数开始时检查它。这可以是一个变量，或者您可以在目标元素上添加并检查类名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-01T16:12:57.217

最简单的方法是使用 .(stop) 示例：

```
<div id="hover_on_me_box>Hover on me!</div>

<div style="display:none" id="hidden_box">Content....</div>

$("#hover_on_me_box").hover(function() {
    $("#hidden_box").stop().fadeToggle("500");
}); 
```

在此处阅读更多信息：http: [//www.learningjquery.com/2009/01/quick-tip-prevent-animation-queue-buildup](http://www.learningjquery.com/2009/01/quick-tip-prevent-animation-queue-buildup)

# c - 是否可以在 C 中重载运算符？

> ID：10624525
> 
> 赞同：12
> 
> 时间：2012-05-16T18:30:55.000
> 
> 标签：c, overriding, overloading

是否可以在 C 中重载运算符（例如比较运算符）？

如果是这样，你怎么做？我进行了快速搜索，但我发现的只是 C++，而我想要的是 C。

有人有想法么？

Edit1：想法是：我有一个结构，我需要做一个比较（基于结构的成员）。为此，我想将运算符与我的新“数据类型”进行比较。

Edit2：我完全知道我可以不使用运算符重载，但想知道你是否可以通过 OVERLOAD 来做到这一点。

答：重载的概念与面向对象的编程有关。由于C不是面向对象的，因此不能包含重载的概念。（：

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-16T18:32:17.513

不，这是不可能的。C 不支持开发人员的运算符重载。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-16T18:33:15.143

如果通过重载，您的意思是用户定义的运算符重载，那么答案是否定的。但是，对于算术类型，某些预定义的运算符（例如`*`等`+`）是重载的（如果您考虑一下的话）。这`*`是特殊的，因为它还具有取消引用指针的重载。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-16T19:26:29.563

C 不支持运算符*或*函数的重载。您无法重新定义`<`, `<=`, `>`, `>=`, `==`, 或`!=`直接比较结构类型。

# ios - 如何在未端到端连接的石英上下文中绘制线条？

> ID：10624540
> 
> 赞同：1
> 
> 时间：2012-05-16T18:32:18.747
> 
> 标签：ios, cgcontext, cgpath

我在我的视图中跟踪触摸并在关联的“画布”层中创建相应的线。这些点被累积到一个 CGPathRef 中，并在 touchesDidEnd 时间存储在一个 NSArray 中。

在 drawLayer 时间，我绘制当前路径和存储路径，如下所示：

```
 // draw the current line:
    CGContextAddPath(ctx, path);
    CGContextStrokePath(ctx);
    NSLog(@"Canvas drawing path %@", path);

    // draw the stored lines
    for (NSMutableArray *arr in storedPaths) {
        CGMutablePathRef aPath = CGPathCreateMutable();
        // set up the path with the CGPointObjects
        NSLog(@"Canvas drawing stored path");
        BOOL inited = NO;
        for (CGPointObject *thePt in arr) {                    
            if (inited==NO) {
                CGPathMoveToPoint(aPath, NULL, [thePt.x floatValue],  [thePt.y floatValue]);
                //CGContextMoveToPoint(ctx, [thePt.x floatValue], [thePt.y floatValue]);
                inited = YES;
            }
            else {
                CGPathAddLineToPoint(aPath, NULL, [thePt.x floatValue], [thePt.y floatValue]); 
                //CGContextAddLineToPoint(ctx, [thePt.x floatValue], [thePt.y floatValue]); 
            }
        }
        CGContextAddPath(ctx, aPath);
        CGContextStrokePath(ctx);
        // didn't help connected problem
        //CGPathRelease(aPath);
    } 
```

这可以按预期工作，只是它将第一行的终点连接到下一行的起点，而不是将它们保留为不接触的单独行。示例：用户绘制了一个 X，但获得了两个端点相连的 X。

CGClosePath 看起来不像我想要的。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:46:35.033

如果每个偶数/奇数对都是一条线，则将 'inited==NO' 替换为计数器并使用 'counter%2 == 0' 以便对于偶数点它移动到您想要的位置和奇数点它连接上一点。不使用快速枚举而是使用老式的 for 循环可能更容易。

```
 for (int i = 0; i < [arr count]; ++i) {
        CGPointObject *thePt = [arr objectAtIndex:i];                    
        if (i%2 == 0)
            CGPathMoveToPoint(aPath, NULL, [thePt.x floatValue],  [thePt.y floatValue]);
        else
            CGPathAddLineToPoint(aPath, NULL, [thePt.x floatValue], [thePt.y floatValue]); 
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T01:56:48.210

苹果关于 CGContextAddPath() 的文档非常不足，但看起来它正在继续以前的路径，而不是添加新的子路径。所以，尝试构建一个单一的 CGMutablePathRef，用子路径填充它，然后将整个东西添加到上下文中并抚摸它。

即，将对 CGPathCreateMutable() 的调用移至外循环之前，并将对 CGContextAddPath() 和 CGContextStrokePath() 的调用移至其之后。其余的可以保持不变。

# javascript - for循环中的距离计算不起作用

> ID：10624544
> 
> 赞同：0
> 
> 时间：2012-05-16T18:32:46.343
> 
> 标签：javascript, arrays, for-loop, latitude-longitude

我现在正在开发测试地理定位应用程序。

我发现了一些有助于两点之间距离的代码（带有纬度经度坐标）。现在我尝试的是，在 for 循环中循环该公式以获得距离，不仅是两点，而且还有很多。

假设我有一个参考点、X 点和许多其他点，并且我想获得 X 和 A、X 和 B 之间的每个距离等等。

其他点的每个经度和纬度都设置在关联维数组中，如下所示，

```
 var response = (

    {

    id = 2;

    latitude = "50";

    longitude = "0";

    username = AAA;

    },

    {

    id = 5;

    latitude = "51";

    longitude = "-1";

    username = BBB;

    },

    {

    id = 6;

    latitude = "52";

    longitude = "-3";

    username = CCC;

    }

    )

    //and pointX data is
    var lat1 = "50";
    var lon1 = "0"; 
```

我正在尝试的是；

```
 for(var i = 0; i < response.length; i++){

        var lat2 = response[i].latitude;
        var lon2 = response[i].longitude;

    //distance in kilometer
    function distance(lat1, lon1, lat2, lon2,response) {
        var radlat1 = Math.PI * lat1/180;
        var radlat2 = Math.PI * lat2/180;
        var radlon1 = Math.PI * lon1/180;
        var radlon2 = Math.PI * lon2/180;
        var theta = lon1-lon2;
        var radtheta = Math.PI * theta/180;
        var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
        dist = Math.acos(dist);
        dist = dist * 180/Math.PI;
        dist = dist * 60 * 1.1515;
        dist = dist * 1.609344;
        return response[i].distanceKm = dist;
    } 
```

但是当我运行它并输出时，例如，response[1].distanceKm 是未定义的。smthng 似乎出错了。但我不知道......有什么建议吗？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:49:07.490

您的`response`代码声明未声明为数组。它使用`(`and `)`，而不是`[`和`]`像数组一样使用。因此，没有`response[1]`（例如它是未定义的）。

数组是这样声明`[`的`]`：

```
var response = [ /* comma separate data elements here */ ]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:53:25.147

正如 jfriend00 所说，`response[1]`未定义。你也有不正确的对象文字定义：

```
{  id = 5;
   latitude = "51";
   longitude = "-1";
   username = BBB;
 }, 
```

应该：

```
{  id : 5,
   latitude : "51",
   longitude : "-1",
   username : BBB
 }, 
```

等等

# unix - 简单的 Unix 语句不起作用

> ID：10624551
> 
> 赞同：2
> 
> 时间：2012-05-16T18:33:16.967
> 
> 标签：unix, if-statement

对不起 UNIX 新手。我有一个在我的 NAS 上运行的脚本，它只是检查我的 IP 是什么，并运行一个脚本来重新连接 VPN（如果它已更改）。

*注意：对于这个示例，我已将下面 IP 中的前四个数字更改为“x”，我知道它们需要反映我的真实 IP 地址。*

```
#!/bin/sh
YOUR_IP="$(w3m -dump http://checkip.dyndns.org)"

echo "Current ip:" "$YOUR_IP"
if [ "$YOUR_IP" == "Current IP Address: XX.XX.148.73" ]
then
        echo "UP VPN is active :)"
else
        echo "DOWN VPN is disconnect :("
        sh /opt/etc/init.d/S20openvpn restart
fi

echo "$(date +"%d / %m / %Y")"
echo "$(date +"%H : %M : %S")"
echo "------------------------"
exit 
```

谁能告诉我为什么 if else 语句不运行。在我的日志中，我得到以下信息。我猜该语句必须出错，否则它会回显某些内容，而目前它没有。这可能只是一个语法错误，或者 w3m -dump 在运行 if else 之前没有得到它的结果，我不知道足够的 UNIX 来调试。任何帮助都会很棒。

```
Current ip: Current IP Address: XX.XX.148.73
16 / 05 / 2012
18 : 50 : 01 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:56:22.600

修复它的两种方法：

1.  使用 /bin/bash （如果可能的话）
2.  使用“=”而不是“==”进行比较

这个SO问题提供了更多信息/背景[[：shell编程中的意外运算符](https://stackoverflow.com/q/3411048/1209279)

# php - 使用 PHP 将 XML 数据加载到 Oracle 中

> ID：10624553
> 
> 赞同：-1
> 
> 时间：2012-05-16T18:33:25.927
> 
> 标签：php, simplexml

尽管我已经编程了几年，但我对 php 还是很陌生。

我正在做一个项目，最终目标是每晚将 xml 文件的某些元素加载到 oracle 表中。我有一个脚本，它每晚运行并将文件保存在我的本地机器上。我无休止地寻找答案，但没有成功。

这是 xml 文件的汇总示例。

```
<?xml version="1.0" encoding="UTF-8" ?> 
<Report account="7869" start_time="2012-02-23T00:00:00+00:00" end_time="2012-02-23T15:27:59+00:00" user="twilson" more_sessions="false">
 <Session id="ID742247692" realTimeID="4306650378">
  <Visitor id="5390643113837">
   <ip>128.XXX.XX.XX</ip> 
   <agent>MSIE 8.0</agent> 
  </Visitor>
 </Session>
 <Session id="ID742247695" realTimeID="4306650379">
  <Visitor id="7110455516320">
    <ip>173.XX.XX.XXX</ip> 
    <agent>Chrome 17.0.963.56</agent> 
   </Visitor>
 </Session>
</Report> 
```

需要注意的一件事是，xml 文件将包含几个我需要加载到表中的对象，上面的示例仅适用于两行数据。我熟悉将数据连接和加载到 oracle 的整个过程，并设置了类似的脚本来执行 txt 的 ETL。和.csv。文件使用 php。不幸的是，在这种情况下，数据存储在 xml 中。我在加载 csv 时采用的方法。文件是将数据加载到数组中并从那里继续。

我很确定我可以使用类似的东西，也许可以为每个或类似的东西创建变量，但我不太确定如何使用 xml 来做到这一点。文件。

```
$xml = simplexml_load_file('C:/Dev/report.xml'); 

echo $xml->Report->Session->Visitor->agent; 
```

在上面的代码中，我试图只返回与每个访问者关联的代理。这将返回错误“尝试在第 11 行的 C:\PHP\chatTest.php 中获取非对象的属性”

最终结果是让我将数据加载到类似于我提供的示例的表中，将两行加载到我的表中，这看起来类似于下面但是我认为如果我能够得到数据到一个数组或类似的东西。

```
IP|AGENT
128.XXX.XX.XX MSIE 8.0
173.XX.XX.XXX Chrome 17.0.963.56 
```

任何帮助将不胜感激。

修改后的代码：

```
 $doc = new DOMDocument();
  $doc->load( 'C:/Dev/report.xml' );

  $sessions = $doc->getElementsByTagName( "Session" );
  foreach( $sessions as $session )
  {
  $visitors = $session->getElementsByTagName( "Visitor" );
  foreach( $visitors as $visitor )

  $sessionid = $session->getAttribute( 'realTimeID' );
  {   

  $ips = $visitor->getElementsByTagName( "ip" );
  $ip = $ips->item(0)->nodeValue;

  $agents = $visitor->getElementsByTagName( "agent" );
  $agent = $ips->item(0)->nodeValue;

     echo "$sessionid- $ip- $agent\n";

}}
  ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T20:02:42.967

PHP 中的 -> 运算符意味着您正在尝试调用对象上的字段或方法。由于 Report 不是 $xml 中的方法，因此您会收到尝试调用非对象属性的错误。

可以试试这样的（不知道行不行，没测试也好久没写PHP了，可以google一下）：

```
$doc = new DOMDocument();
$doc->loadXML($content);

foreach ($doc->getElementsByTagName('Session') as $node)
{
    $agent = $node->getElementsByTagName('Visitor')->item(0)->getElementsByTagName('agent')->item(0)->nodeValue;
} 
```

编辑：

在 PHP 中向数组添加内容很简单，如下所示：

```
$arr = array();
$arr[] = "some data";
$arr[] = "some more data"; 
```

PHP 数组应该被视为一个列表，因为它们可以动态调整大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T17:38:51.427

我能够使用 simplexml_load_file 而不是 DOM 方法来解决这个问题。尽管 DOM 在修改了 Leon 的建议后可以工作，但我建议采用以下方法。

```
$xml_object = simplexml_load_file('C:/Dev/report.xml');

foreach($xml_object->Session as $session) {
        foreach($session->Visitor as $visitor) {
        $ip = $visitor->ip;
        $agent = $visitor->agent;
    }

echo $ip.','.$agent."\n";
} 
```

# string - 对于每个文件：逐行遍历和 grep 字符串（输出不正确）

> ID：10624557
> 
> 赞同：2
> 
> 时间：2012-05-16T18:33:51.617
> 
> 标签：string, bash, text, sed, cat

请参阅下面的更新。

我正在尝试强制更新一些日文电子邮件文件的代码页。这些文件被标记为 UTF-8，但日文文本未正确表示。我需要将标头中的编码从“UTF-8”更改为“shift-jis”。

我已经手动检查了这个工作，但我想自动化这个过程。使用两个 sed 命令：

```
#sed -i 's/charset="shift-jis"/charset="shift-jis"/g' $VariableForLine
#sed -i 's/?UTF-8?/?shift-jis?/g' $VariableForLine 
```

我相信我可以做出所需的改变。由于电子邮件的内容，我需要将其限制为仅更改电子邮件的标题。我看到的标准格式如下：

```
From: "=?UTF-8?Q?JapaneseNameEncodedIncorreclty" <ono.koj@jpm.com>
To: "Yoshi Endo"
Subject: =?UTF-8?Q?????????????????=view=?UTF-8?Q????????????????
MIME-Version: 1.0
Date: Wed, 20 Feb 2006 10:30:22 0100
Content-Type: multipart/alternative;boundary="Next_Item:_(A3CB49KFSA19)/1"

This is a multi-part message in MIME format.

--Next_Item:_(A3CB49KFSA19)/1
Content-type: text/plain; charset="UTF-8"

?UTF-8?(example to skip)

Ÿž=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-Ÿž
       Japanese Content        
Ÿž=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-Ÿž

?UTF-8? (example to skip)

ここには、ログインしてください
----------------------------------------------------------------
Mixed content
***************************************************************************
Mixed content 
***************************************************************************
--Next_Item:_(A3CB4g7FSA19)/1-- 
```

在文件的循环中运行上述两个命令似乎可行，但我需要确保由于其余电子邮件的内容而仅更改文件的标题和紧随其后的字符集变量。

我制作的伪代码如下：

```
for each file in directory of type eml
do 
read file line by line
if line contains "charset=" replace with ??
break
else
if line contains ?UTF-8?
replace ?UTF-8? with ?shift-jis'
exit 
```

if 语句中第一个子句的另一个问题是“charset=”字符串可能没有应用编码，它可能是 UTF-8 或 ANSI，所以我需要搜索 charset= 的第一个实例，然后更改字符串添加或替换后面的“”中的字符。

我目前遇到问题的代码如下所示（请原谅我对语法的掌握不佳）

```
#!/bin/bash
for file in ./*
do
   cat $file | while read myline 
    do 
       if $myline |grep "charset="
       then    
           echo $myline
           #echo $myline #this prints all the content
       fi
      done
             #sed -i 's/charset="shift-jis"/charset="shift-jis"/g' $LINE
             #sed -i 's/?UTF-8?/?shift-jis?/g' $LINE
done #end 
```

感谢您迄今为止的所有投入。非常感激。

编辑：我有一个解决方案

```
for file in `find ./ | grep .EML`
do 
        sed  -i  's/charset=".*"/charset="shift-jis"/' $file
        sed  -i  's/?UTF-8?/?shift-jis?/' $file

done 
```

IT 没有考虑标题，但如果电子邮件中没有 charset= 代码的其他实例，那么它应该没问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T03:01:08.237

您可能会发现这很有帮助，但您需要让我知道标题替换的要求是什么，以便我可以更改命令以匹配。

```
for file in ./*
do
    if [[ -f $file ]]
    then
        sed -i '/header_old/{s//header_new/;:a;n;/other_old/{s//other_new/;:b;n;bb;};ba}' "$file"
    fi
done 
```

这将替换“header_old”的第一次出现和“other_old”的第一次出现。有一个查找“header_old”字符串的外循环（标签`:a`和分支命令）和一个在进行标题替换后运行的内循环（标签和分支命令）。内部循环寻找“other_old”。图案必须按该顺序出现在单独的行上。`ba``:b``bb`

该`n`命令从文件中读取下一行。`/pattern1/s//pattern2/`搜索包含的行`pattern1`，空的斜杠对重用该模式并替换`pattern2`它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:43:48.597

这是做你想做的吗？

```
sed '0,/charset=/s/old/new/' $file 
```

这会将替换应用于从开头开始的每一行，直到并包括与您的条件匹配的第一行。在该行之后，不再应用替换，其最终效果是仅修改与您的条件匹配的第一行。

# php - 单击链接时 PHP 执行文件两次

> ID：10624562
> 
> 赞同：0
> 
> 时间：2012-05-16T18:34:08.387
> 
> 标签：php, mysql, hyperlink, fopen, execute

我的网站上有一个奇怪的问题。每当单击链接时，文件就会被执行两次。我注意到这一点的唯一原因是，当我提交关键字搜索请求时，我将搜索记录在我们的 MySQL 数据库中。数据库总是保存两条记录（有一个时间戳，有时在同一秒内添加记录，但通常相隔一秒）。我知道我是网站上唯一的人，并且查询没有被循环调用。所以我做了一个 fopen($file, 'a') 来查看将添加多少行代码，并且大多数时候添加了两行代码。我可以添加一条记录的唯一方法是连续运行相同的搜索 2-3 次。

所以我唯一能想到的就是我们的网站上有很好的广告。我唯一能想象到的情况是，当我点击链接时，与广告相关的 javascript 也遵循相同的链接。

还有其他绝妙的想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:37:18.773

当有没有实际链接的资产（图像、js、css）时，我已经看到了这样的症状，例如：

```
<img src="" /> 
```

在这种情况下，浏览器尝试获取相同的 url，但`Accept`标题不同。记录一下，这将有助于查看是否是这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:44:57.903

处理表单时，检查他们是否真的点击了提交按钮，如下所示：

```
if (isset($_POST['submit']) && $_POST['submit'] == 'submit') {
   // Process form
} else {
   // Just display it
} 
```

这将阻止您处理它两次。您还应该在表单发布后使用 303 重定向进行重定向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:49:15.460

我应该害怕吗？

我一写这篇文章就注释掉了谷歌广告的代码（并看到了@cilosis 的建议）。

我没有问题了。不过，这完全是谷歌。每次我运行搜索时，这都在我的 apache 访问日志中。

```
66.249.73.87 - - [16/May/2012:12:38:45 -0500] "GET /search.php?page_num=1&keywords=stylist&city=&state=AL&cat= HTTP/1.1" 200 14185 "-" "Mediapartners-Google" 
```

我很害怕.....

# mysql - jdbc 到 MYSQL 错误：“表 airportdetails 不存在”

> ID：10624563
> 
> 赞同：0
> 
> 时间：2012-05-16T18:34:13.113
> 
> 标签：mysql, jsp, jdbc, database-connection, sqlexception

我正在尝试在后端使用 jdbc 从 jsp 页面连接到 MySQL 数据库。
我有以下代码：

```
public static void insertIntoDatabase(String code,String name,String temp,String hum,String del) {
    Connection con = null;
    if (del.length() == 0) {
        del="no data";  
    }
    name = name.replaceAll("\\(.+?\\)", "");
    name = name.replaceAll(" ", "_");
    del = del.replaceAll(" ", "_");
    System.out.println("del "+del);

    String url = "jdbc:mysql://localhost:3306/test";

    try {
        Class.forName("com.mysql.jdbc.Driver");
        con = DriverManager.getConnection(url,"root","");
        con.createStatement().executeUpdate("CREATE TABLE IF NOT EXISTS aiportdetails(code VARCHAR(50) PRIMARY KEY, " +
                "name VARCHAR(250), temp VARCHAR(50), hum VARCHAR(50), del VARCHAR(50))");
        ResultSet rs = con.prepareStatement("SELECT * FROM airportdetails;").executeQuery();
    } catch (SQLException ex) {
        ex.printStackTrace();
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    } finally {
        try {
            if (con != null) {
                con.close();
            }

        } catch (SQLException ex) {
            ex.printStackTrace();
        }
    }
} 
```

我收到以下错误

> ResultSet rs = con.prepareStatement("SELECT * FROM airportdetails;").executeQuery();

错误：

> 表“test.airportdetails”不存在

但是从我的 phpmyadmin 我可以看到该表已创建并存在： ![在此处输入图像描述](../Images/010d5adc950454d59914f6ba608a1961.png) 我收到此错误的原因是什么？
谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:43:53.743

## 执行更新（）

`INSERT`执行此 PreparedStatement 对象中的 SQL 语句，该对象必须是 SQL`UPDATE`或`DELETE`语句；或不返回任何内容的 SQL 语句，例如 DDL 语句。

> 目前您正在尝试使用它来创建表。这就是您收到该错误的原因。

有关**executeUpdate**，请参阅文档**[Java 6](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#executeUpdate%28%29)**或**[Java 1.4.2](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/PreparedStatement.html#executeUpdate%28%29)**

 **## 编辑：

您应该使用创建一个表`Statement`

```
Statement st = con.createStatement();
String table = "Create table .......";
st.executeUpdate(table); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T08:13:35.633

您可以将初始化连接和加载驱动程序放在构造函数级别，然后在方法中您可以先创建检查表是否存在或创建然后如果成功，继续插入操作。像这样：

```
public class MyBean{ 
                 String url = "jdbc:mysql://localhost:3306/test,"root","" ";

              public MyBean(){
                 try{
                   Class.forName("com.mysql.jdbc.Driver");
                   con = DriverManager.getConnection(url);
                    }catch(Exception e){
                     }
              }
            public static void insertIntoDatabase(String code,String name,String temp,String hum,String del) {
                    Connection con = null;
                    if (del.length() == 0) {
                        del="no data";  
                    }
                    name = name.replaceAll("\\(.+?\\)", "");
                    name = name.replaceAll(" ", "_");
                    del = del.replaceAll(" ", "_");
                    System.out.println("del "+del);

                    try {
                         con = DriverManager.getConnection(url);
                    Int result =  con.createStatement().executeUpdate("CREATE TABLE IF NOT EXISTS aiportdetails(code VARCHAR(50) PRIMARY KEY, " +
                                "name VARCHAR(250), temp VARCHAR(50), hum VARCHAR(50), del VARCHAR(50))");
                   if(result>0){
                         try{
                         ResultSet rs = con.prepareStatement("SELECT * FROM airportdetails;").executeQuery();
                     }catch(Exception e){

                          }finally{
                        }
               }//end if
            } catch (SQLException ex) {
                        ex.printStackTrace();
                    } catch (ClassNotFoundException e) {
                        e.printStackTrace();
                    } finally {
                        try {
                            if (con != null) {
                                con.close();
                            }

                        } catch (SQLException ex) {
                            ex.printStackTrace();
                        }
                    }
                }
            } 
```**

# extjs - Extjs4，如何检索单个文本字段值？

> ID：10624577
> 
> 赞同：0
> 
> 时间：2012-05-16T18:35:04.887
> 
> 标签：extjs, extjs4

```
var confirmWindow = Ext.create('Ext.window.Window', {
     title: 'Selected Item List',
     autoHeight: true,
     width: 500,
     layout: 'fit',
     modal: true,
     items: [{
        xtype: 'panel',
        bodyPadding : 5,
        items: [{
           xtype: 'textfield',
           id : 'freightFee',
           fieldLabel: 'Freight Fee ',
           name : 'freight' // I need this value, when I click the button
        }]
     }],
     bbar: ['->', {
         xtype: 'buttongroup',
         items: [{
           text: "test",
           handler: function () {
              // I want to get the textfield value (freightFee)
              var freightFee = Ext.getCmp('freightFee').getValue(); // error :Ext.getCmp('freightFee') is undefined
                }
            }]
            }
        }); 
```

我有一个像上面这样的窗口，我想在单击按钮时获取文本输入框的值。

我试过，

```
var freightFee = Ext.getCmp('freightFee').getValue(); 
```

但错误信息说，

> Ext.getCmp('freightFee') 未定义

有人知道吗？

谢谢你！

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-16T20:26:55.080

永远不要使用`getCmp`！这是非常昂贵和不必要的。查看`up/down`查找元素父母/孩子的方法[http://docs.sencha.com/ext-js/4-0/#!/api/Ext.Element-method-down](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.Element-method-down)

在你的情况下，这样的事情应该有效：

```
handler: function(button) {
   var tf = button.up('window').down('#freightFee');
} 
```

# c# - 查找哪个引用 dll 包含方法

> ID：10624578
> 
> 赞同：0
> 
> 时间：2012-05-16T18:35:22.660
> 
> 标签：c#, visual-studio

我需要将方法从一个项目复制到另一个项目。一些方法依赖于引用的模块。如果不打开所有引用的 dll，如何确定包含该方法的引用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:38:14.253

右键单击方法调用并选择“转到定义”（或类似的，现在不要打开 Visual Studio）。键盘快捷键是`F12`（感谢[@seth flowers](https://stackoverflow.com/users/444610/seth-flowers)）

这应该带您进入对象浏览器并让您知道该方法在哪个程序集中。

# php - Yii JUI 自动完成 - 将 javascript 传递到 sourceUrl

> ID：10624581
> 
> 赞同：0
> 
> 时间：2012-05-16T18:35:47.840
> 
> 标签：php, jquery-ui, autocomplete, yii

我正在处理一个带有 2 个自动完成小部件的表单。第一个小部件获取公司名称并填充表单上的各种其他项目：

```
<?php $this->widget('zii.widgets.jui.CJuiAutoComplete', array(
    'attribute'=>'company_name',
    'model'=>$model,
    'sourceUrl'=>array('company/aclist'),
    'options'=>array(
        'minLength'=>'2',
        'select'=>'js: function(e,u){
            $("#'.CHtml::activeId($model,'company_address').'").val(u.item.address);
            $("#'.CHtml::activeId($model,'company_phone').'").val(u.item.phone);
            $("#'.CHtml::activeId($model,'company_id').'").val(u.item.id);
        }',
    ),
    'htmlOptions'=>array(
        'size'=>45,
        'maxlength'=>45,
    ),
 ));?> 
```

这完美地工作。第二个小部件非常相似，只是它旨在获取与该公司相关的联系人。如何将`company_id`值传递给第二个自动完成？

这是我尝试过的，但没有奏效：

```
'sourceUrl'=>array(
    'company/aclist',
    array("id"=>"js:$('#".CHtml::activeId($model,'company_id')."').val();"),
), 
```

任何人对如何实现这一点有任何其他建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:03:05.537

正确的语法是：

```
'sourceUrl'=>array(
     "company/aclist", "id"=>"js:$('#".CHtml::activeId($model,'company_id')."').val();")
), 
```

但恐怕有问题。我几乎可以肯定 "js:$(.." 将被视为一个字符串，所以它不会被评估。所以我的建议是实现[这里](http://www.yiiframework.com/forum/index.php/topic/15828-how-to-paste-params-into-createurl-by-jquery/page__p__78543__hl__createurl+get#entry78543)提供的解决方案。

该解决方案在这里适用，因为'sourceUrl' 调用CHtml::normalizeUrl()，而后者又调用CHtml::createUrl()。您需要将“点击”事件更改为“更改”。当然还有一些其他的修改需要做，但我希望你能解决它们。

# php - 从 CLI 运行时找不到类 imagick

> ID：10624582
> 
> 赞同：1
> 
> 时间：2012-05-16T18:35:57.857
> 
> 标签：php, imagemagick, kohana, command-line-interface, imagick

```
$im = new imagick($file); 
```

这行代码从我的浏览器运行时可以正常工作，但是当我尝试从命令行 (CLI) 运行它时，我收到以下错误...

> 找不到类“imagick”

任何想法为什么它不能从 CLI 工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:47:43.920

php cli 可执行文件与通常通过网络服务器运行的文件是分开的（如单独的二进制文件）。因此，它们可以是完全不同的 php 版本，具有不同的 php.ini 文件和编译/启用的不同扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T11:21:47.640

找到了解决方案：

```
sudo aptitude install make php5-dev php-pear
sudo aptitude remove php5-imagick
sudo aptitude install libmagick9-dev
sudo pecl install imagick
sudo /etc/init.d/apache2 restart 
```

[http://kvz.io/blog/2008/02/27/class-imagick-not-found/](http://kvz.io/blog/2008/02/27/class-imagick-not-found/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:46:53.093

运行“php -i | grep include_path”并确保类文件路径在那里。如果没有，您可以将其添加到您的脚本或您的环境（bash 配置文件）中。

# javascript - Javascript从表单单选选项或文本字段列表中获取所选值，无论使用哪个，并输出到文本？

> ID：10624584
> 
> 赞同：1
> 
> 时间：2012-05-16T18:36:28.730
> 
> 标签：javascript, html, forms, radio

我是 Stack 的新手，这是我的第一个问题，但我进行了搜索，但找不到任何我想要完成的具体内容。我完全是为了学习，所以任何可以帮助我更好地理解如何解决这个问题的参考资料都将不胜感激，但如果有人想提供一些示例代码，我也不介意：p

好的，所以场景是这样的。我正在编写一个“Note Creator”，它将根据我在表单中输入的某些字段生成自动客户注释。我已经编写了从文本字段中获取值的脚本，但是我有一个字段，我想成为单选选项或文本字段的组合，并且 java 需要获取使用的任何一个字段和正确的值。任何帮助表示赞赏，以下是我的代码：

```
 <script type="text/javascript">
    function getNotes() {
        //Grab Variables
        spokeTo = document.thisForm.spokeWith.value;
        problemItem = document.thisForm.problemWith.value;
        resolvedBy = document.thisForm.resolvedWith.value;
        thisTech = document.thisForm.techName.value;
        fSpace = "... "
        //Read in the location information and prep the output container
        outputValue = "";
        {
        //Test if things are blank
        if (spokeTo == "") { alert('Please Enter the Name of the Person.'); }
        else if (problemItem == "") { alert('Please Select the Problem.');  }
        else if (resolvedBy == "") { alert('Please Type Your Resolution.'); }
        else {
            //The loop that puts the output together
                outputValue += "Spoke With: " + spokeTo + "\n\n" + "Called About: " + problemItem + "\n\n" + "Resolution: " + resolvedBy +fSpace + thisTech;
            }
            //output to the user
            document.thisForm.outputArea.value = outputValue;
        }
    }
</script>

        <form name="thisForm">
        <p>
        1\. Spoke With: <input type="text" id="spokeWith" class="input" name="spokeWith">
        </p>

        <p>
        2\. Called About: 
            Hardware <input type="radio" id="problemWith" class="input" name="problemWith" value="Hardware">
            Software <input type="radio" id="problemWith" class="input" name="problemWith" value="Software">
            <input type="text" id="problemWith" class="input" name="problemWith"><br>
        </p>

        <p>
        3\. Resolved By:<br /><br />
            <textarea name="resolvedWith" id="resolvedWith"></textarea>
        </p>

        <p>
        4\. Your Name:<br>
            <input type="text" id="techName" class="input" name="techName" /><br>
        </p>

        <p>
            <input type="button" class="button" value="Make My Notes!" onClick="javascript:getNotes();" />
            <input type="reset" class="button" value="Start Over" />
        </p>

        <br><br>

        <textarea name="outputArea" id="outputArea"></textarea>
        <p class="finishMessage" id="finishMessage" name="finishMessage"></p>
    </form> 
```

我特别指的是表单的第 2 步部分，其中包含单选选项和具有相同 ID 和名称的文本字段。我知道每页只能使用一次 ID，所以这可能会改变，但我愿意接受任何建议/帮助。我对 Javascript 的使用中等，仍处于学习阶段。

再次感谢！

**--------------- 第二轮 ---------------**

这是我在接受所提供答案的建议后修改后的代码。我添加了一堆警报，让我知道我正在设法击中脚本的哪些部分，并且我无法通过第一个警报触发任何东西，并且根本无法获得任何输出了。我错过了什么？

```
<script type="text/javascript">
    function getNotes() {
    alert('You\'ve hit the function. Congratulations - you didn\'t break the whole damn thing.');
        //Grab Variables
        var spokeTo = document.thisForm.spokeWith.value;
        var resolvedBy = document.thisForm.resolvedWith.value;
        var thisTech = document.thisForm.techName.value;
        var fSpace = "&hellip; ";

        //Grab if radio else text
        var inputVal1 = document.getElementByClass('problemRadio').value;
        var inputVal2 = document.getElementByClass('problemWith').value;
        alert('You made it! Almost there.');
        // If Input Value 1 is not Null, Show Radio Value. Else, show Text Value
        var problemOutput;
        if (inputVal1.length > 0) {
        problemOutput = inputVal1;
        alert('I found value 1!');
        }
        else {
        problemOutput = inputVal2; 
        alert('I found value 2!'); 
        }

        //Read in the location information and prep the output container
        outputValue = "";

        //Test if things are blank
        if (spokeTo == "") { alert('Please Enter the Name of the Person.'); }
        else {
        alert('We Made it to Else to parse outputValue');
            //The loop that puts the output together
                outputValue += "Spoke With: " + spokeTo + "\n\n" + "Called About: " + problemOutput + "\n\n" + "Resolution: " + resolvedBy +fSpace + thisTech;
            }
            //output to the user
            document.thisForm.outputArea.value = outputValue;

    }
</script>

        <form name="thisForm">
        <p>1\. Spoke With: <input type="text" id="spokeWith" class="input" name="spokeWith"></p>

        <p>2\. Called About: 
            Hardware <input type="radio" id="problemRadio" class="problemRadio" name="problemRadio" value="Hardware">
            Software <input type="radio" id="problemRadio" class="problemRadio" name="problemRadio" value="Software">
            <input type="text" id="problemWith" class="problemWith" name="problemWith"><br>
        </p>

        <p>3\. Resolved By:<br /><br />
            <textarea name="resolvedWith" id="resolvedWith"></textarea>
        </p>

        <p>4\. Your Name:<br>
            <input type="text" id="techName" class="input" name="techName" /><br>
        </p>

        <p>
            <input type="button" class="button" value="Make My Notes!" onClick="javascript:getNotes();" />
            <input type="reset" class="button" value="Start Over" />
        </p>

        <br><br>

        <textarea name="outputArea" id="outputArea"></textarea>
        <p class="finishMessage" id="finishMessage" name="finishMessage"></p>
    </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T17:59:26.887

对此感到抱歉，我还不知道在这里获取代码的最佳方法。总是看起来凌乱（直到我弄明白）

我在您的更新中发现的几件事；

1） getElementbyId 是最好的（它没有超过你的第一行）

2) 单选按钮上的重复 ID

3）我们需要“检查”哪些单选按钮被选中

4）总是方便地提醒变量（我已经添加了一些来显示）

我在粗略的测试下面给出了这段代码，它看起来是沿着线..

请参阅下面代码中添加的注释..

```
 <script type="text/javascript">
   function getNotes() {

    //Grab Variables
    var spokeTo = document.getElementById('spokeWith').value;
    var resolvedBy = document.getElementById('resolvedWith').value;
    var thisTech = document.getElementById('techName').value;
    var fSpace = "&hellip; ";

    alert("spokeTo:" + spokeTo 
      +" , resolvedBy: " +resolvedBy+", thisTech: "+thisTech);

    //Grab if radio else text

    var problemWith = document.getElementById('problemWith').value;

   alert("problemWith: "+problemWith);

/* set a default value */
var problemOutput="other";

/* if they added no notes */
if((problemWith=="") || ( problemWith==null)) {

/* check which radio is selected if any */
if(document.getElementById('problemHardware').checked) {
problemOutput = document.getElementById('problemHardware').value;
}

if(document.getElementById('problemSoftware').checked) {
problemOutput = document.getElementById('problemSoftware').value;
}

} else {
problemOutput=problemWith;
}
alert("problem output is: "+problemOutput);

    alert('You made it! Almost there.');

    //Read in the location information and prep the output container
    outputValue = "";

    //Test if things are blank
    if (spokeTo == "") { alert('Please Enter the Name of the Person.'); }
    else {
    alert('We Made it to Else to parse outputValue');
    /* The loop that puts the output together */

    outputValue += "Spoke With: " 
     + spokeTo + "\n\n" 
     + "Called About: " 
     + problemOutput + "\n\n" 
     + "Resolution: " + resolvedBy +fSpace + thisTech;
        }
        //output to the user
        document.thisForm.outputArea.value = outputValue;

}
  </script>

      <form name="thisForm">
    <p>1\. Spoke With: <input type="text" id="spokeWith" class="input" name="spokeWith">  </p>

    <p>2\. Called About: 
        Hardware <input type="radio" id="problemHardware" class="problemRadio" name="problemRadio" value="Hardware">
        Software <input type="radio" id="problemSoftware" class="problemRadio" name="problemRadio" value="Software">
        <input type="text" id="problemWith" class="problemWith" name="problemWith"><br>
    </p>

    <p>3\. Resolved By:<br /><br />
        <textarea name="resolvedWith" id="resolvedWith"></textarea>
    </p>

    <p>4\. Your Name:<br>
        <input type="text" id="techName" class="input" name="techName" /><br>
    </p>

    <p>
        <input type="button" class="button" value="Make My Notes!" onClick="javascript:getNotes();" />
        <input type="reset" class="button" value="Start Over" />
    </p>

    <br><br>

    <textarea name="outputArea" id="outputArea"></textarea>
    <p class="finishMessage" id="finishMessage" name="finishMessage"></p>
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:24:55.063

one approach would be to check on the value and if else

```
 var input1val = document.getElementById('input1Id').value;
 var input2val = document.getElementById('input2Id').value;

 var valfromeitherbox = (input1val.length > 0) ? input1val : input2val;

 /* UPDATE : ^ is the same as - 

 var valfromeitherbox;
 if(input1val.length > 0) { valfromeitherbox=input1val;
 } else { valfromeitherbox=input2val; }

 */

  document.getElementById('input3Id').value = valfromeitherbox;

 /* if val is empty in input1 use val from text box 2 */ 
```

Sorry if a little scrappy , but hope you get the gist and I haven't missed the point

# google-analytics - 我可以在我的应用程序中向用户展示谷歌分析数据吗？

> ID：10624587
> 
> 赞同：0
> 
> 时间：2012-05-16T18:37:03.860
> 
> 标签：google-analytics, google-analytics-api

我正在创建一个拍卖网站，并希望向我的卖家提供与他们的产品页面相关的分析——访问者、搜索词等。我可以推出自己的分析，但想知道是否可以（或禁止）使用谷歌在我的应用程序中进行分析并将该数据呈现给我的用户。这可能吗，有没有人这样做过，如果有，你是怎么做的。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-05T20:00:54.480

您还可以通过 Google 的实时 API 提供实时数据报告 - [https://developers.google.com/analytics/devguides/reporting/realtime/v3/devguide](https://developers.google.com/analytics/devguides/reporting/realtime/v3/devguide)

它将以[维度和指标的方式提供多个数据](https://developers.google.com/analytics/devguides/reporting/realtime/dimsmets/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T04:23:24.723

当然，你可以做到这一点。

最简单的方法是让您的卖家直接访问 GA。我不知道您是如何设置 GA 界面的，但您可以通过多种不同方式（过滤器、细分等）设置配置文件，以使配置文件仅显示特定卖家的数据，并仅授予其 GA 帐户访问权限他们的个人资料。

或者，GA 提供了一个[API](https://developers.google.com/analytics/devguides/reporting/)，用于从中检索数据并显示在您自己的网站上。

# html - 当子元素超出父 div 的宽度时，如何防止水平滚动？

> ID：10624593
> 
> 赞同：0
> 
> 时间：2012-05-16T18:37:17.120
> 
> 标签：html, css, scrollbar, positioning

我为我的网站创建了一个横幅，它由 3 个并排的 iPhone 图片组成，每个图片使用背景图片和相对定位。但是，我遇到了水平滚动的问题。即使包含每个 iphone 图像的 div 超出了父 .content div 的宽度，我也不希望在溢出内容无法适应浏览器宽度时出现滚动条。仅当浏览器宽度低于 960 像素时才应显示滚动条。

目前在[Apple 的主页](http://www.apple.com/ "苹果的主页")上可以看到类似的效果，手/手腕位于网站容器“外部”，但除非浏览器的宽度低于 990 像素，否则看不到水平滚动条。

我希望我已经清楚地解释了这一点，如果不清楚，请告诉我。

这是我正在使用的代码：

```
<div class="content">
    <div id="iphone-a"></div>
    <div id="iphone-b"></div>           
    <div id="iphone-c"></div>
</div> 
```

* * *

```
.content {
    margin: 0 auto;
    width: 960px;
    height: auto;
    text-align: left;
    overflow-x: visible;
    }

#iphone-a {
    z-index: 1;
    position: relative;
    left: 50%;
    bottom: 0;
    margin-left: -306px;
    height: 657px;
    width: 590px;
    background: url(images/banner.png) 0px 0px;
    }

#iphone-b {
    z-index: 0;
    position: relative;
    top: -545px;
    left: 50%;
    margin-left: -732px;
    height: 319px;
    width: 590px;
    background: url(images/banner.png) 0px -658px;
    }

#iphone-c {
    z-index: 0;
    position: relative;
    top: -864px;
    left: 50%;
    margin-left: 144px;
    height: 319px;
    width: 590px;
    background: url(images/banner.png) 0px -658px;  
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:40:48.660

改变

```
overflow-x: visible; 
```

在 .content 中

```
overflow-x : hidden; 
```

编辑：如果这不是你的意思，你只是想让可见的正常工作尝试使用`overflow`而不是`overflow-x`

# r - 生态模拟，如何比较矩阵中的多个数字做出决策

> ID：10624600
> 
> 赞同：3
> 
> 时间：2012-05-16T18:37:49.973
> 
> 标签：r, matrix

在我正在开发的生态模拟过程中，我遇到了一个问题。我在下面附上了一些代码来突出这个问题。总之，假设我有 3 个不同质量的位置。动物想要移动到最高质量的位置（数字越大，质量越高），但无法区分差异小于或等于 0.1 的质量（这是更大循环的一部分，因此此过程将得到重复数千次）。

例如，在这种情况下（个人从位置 #2 开始）：

```
a<-matrix(c(1,2,3,.6,.9,.7),nrow=2,ncol=3,byrow=TRUE)
attributes(a)$dimnames<-list(c("Location","Quality"),c())
a

          [,1] [,2] [,3]
Location  1.0  2.0  3.0
Quality   0.6  0.9  0.7 
```

个人会清楚地将位置#2 识别为最佳位置，并留在那里。

在这种情况下（个人从位置 #2 开始）：

```
a<-matrix(c(1,2,3,.5,.7,.8),nrow=2,ncol=3,byrow=TRUE)
attributes(a)$dimnames<-list(c("Location","Quality"),c())
a

          [,1] [,2] [,3]
Location  1.0  2.0  3.0
Quality   0.5  0.7  0.8 
```

个人将无法清楚地区分 #2 和 #3 的质量（因为差异需要至少为 0.1 才能被检测到），这将触发另一种行为（这可能涉及个人留在 # 2，或评估此示例中不存在的更多位置）。但是，我需要知道位置 #2 和 #3 在质量上接近，而位置 #1 被排除在选项之外。

在这种情况下（同样，从位置 #2 开始）

```
a<-matrix(c(1,2,3,.9,.7,.6),nrow=2,ncol=3,byrow=TRUE)
attributes(a)$dimnames<-list(c("Location","Quality"),c())
a
         [,1] [,2] [,3]
Location  1.0  2.0  3.0
Quality   0.9  0.7  0.6 
```

个人将从位置 2 移动到位置 1。

在这种情况下（同样，从位置 #2 开始）

```
a<-matrix(c(1,2,3,.8,.7,.6),nrow=2,ncol=3,byrow=TRUE)
attributes(a)$dimnames<-list(c("Location","Quality"),c())
a
         [,1] [,2] [,3]
Location  1.0  2.0  3.0
Quality   0.8  0.7  0.6 
```

个人将根据位置 #3 与位置 #1 的差异来消除位置 #3，并且无法在留在 #2 或搬到 #1 之间做出选择

我试图弄清楚如何编写一个代码来比较位置的相对质量，如果个人无法区分位置（如果是，它在哪个位置之间进行选择），或者如果一个位置是显然更大（如果是这样，它需要返回位置编号，以便我可以将个人移动到另一个矩阵中的那个位置）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:57:10.430

我建议为位置创建一个类。我不知道您将如何在 r 中执行此操作，但我相信您可以解决这个问题。

这是我建议的算法：

*   对于每个位置，对于每个其他位置，如果有机体可以分辨出质量差异，则将排名较低的标记为“坏”（可能使用布尔数组；不要在对象内部使用标志，因为这违反了好设计）
*   在那些 for 循环中，如果您获取带有标记的位置，请使用 continue 语句，以节省时间。
*   现在，再次浏览列表，并将所有未标记标志的列表复制到新列表中。
*   检查列表的长度并将其用于决策。

# python - ctype 等效于变量类型字

> ID：10624608
> 
> 赞同：1
> 
> 时间：2012-05-16T18:38:32.390
> 
> 标签：python

这些变量类型在 python 中的 ctype 等效项是什么：

```
signed short iHD;
word iThem; 
```

词定义为：

```
typedef unsigned short word 
```

无符号 16 位类型的定义

到处找，但我找不到等效的 ctype

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:43:02.453

`signed short iHD`是[c_short](http://docs.python.org/library/ctypes.html#ctypes.c_short)

`word iThem;`是[c_ushort](http://docs.python.org/library/ctypes.html#ctypes.c_ushort)

请注意，这些是`short`您的平台定义的类型，可能是 16 位，但不一定！

如果您想要 16 位类型，请使用[c_uint16](http://docs.python.org/library/ctypes.html#ctypes.c_uint16)和[c_int16](http://docs.python.org/library/ctypes.html#ctypes.c_uint16)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:44:03.040

你看过文档吗？

您正在寻找`c_short`和`c_ushort`

[http://docs.python.org/library/ctypes.html#ctypes.c_short](http://docs.python.org/library/ctypes.html#ctypes.c_short) [http://docs.python.org/library/ctypes.html#ctypes.c_ushort](http://docs.python.org/library/ctypes.html#ctypes.c_ushort)

# ruby-on-rails - 需要在 Rails 应用中输出 1095 个字段

> ID：10624618
> 
> 赞同：0
> 
> 时间：2012-05-16T18:39:04.593
> 
> 标签：ruby-on-rails, forms

我正在编写一个应用程序，一年中的每一天每天都需要 3 次输入。(3*365=1095)。我正在努力寻找一种以有效方式输出每个字段的方法。

输入不是全有或全无（您可以填写 10 天的输入，点击保存，稍后再回来填写更多）

我试图通过在控制器中构建所有 1095 个对象然后在视图中输出输入来做到这一点，但显然这真的很慢并且可能是内存密集型的。

有什么建议么？我倾向于在客户端编写整个表单，然后使用 AJAX 填充现有元素。

编辑

该模型称为 Timing，具有以下属性： `month, day, time1, time2, time3` 因此要保存 365 个模型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T20:39:03.113

听起来你有一个嵌套资源。您有一个名为计时的资源，其中包含一个名为“什么”的资源？

```
#routes
resources :timing do
  resources :day
end 
```

因此，假设在创建时间时，您也创建了所有 365 天（听起来像是一项非常昂贵的操作）。显示字段并不是那么棘手。你可以做

```
#controller
def show
  @timings = Timing.all
end

#view
(Date.beginning_of_year..Date.end_of_year).each do |day|
  t = @timings.find { |timing| timing.date == day } #or some other method of deciding that the current day has a timing
  unless t.nil?
    form_for t #etc
  else
    form_for Timing.new #etc
  end
end 
```

然后，也许您可​​以通过 UJS 提交每个文件并收工。虽然这听起来像一个非常复杂的设计，但我不确定你的问题区域是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T20:43:49.523

如果我正确理解您的问题，您需要一种在表单上动态显示时间输入的方法，每天 3 个。

如果以上是正确的，我建议您按照@DVG 的详细说明执行嵌套资源，并**仅**加载当天。如果您需要加载多天，您可以通过 UJS (Ajax) 轻松请求并将其加载到同一页面上。

为了不破坏服务器，您可能想要做的是自动保存时间输入或在分组失去焦点时自动保存每天的时间输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T01:04:36.217

@DVG 的答案可能工作正常，但它保留了服务器上的所有工作。

我最终想到的是我最初的想法：像这样获取所有现有的时间：

```
def edit
  @timings = Timing.find_by_store_id(params[:store_id])
end 
```

然后在视图中，我编写了两个 javascript 函数：一个写入所有 365 行和所有 3 列。一旦该字段全部在 Javascript 中输出，我使用另一个函数获取现有记录并将它们插入到表单中：

```
<script type="text/javascript">
function updateForm(){
 timings = <%= @timings.to_json %>;
 ... fill out the fields ...
}
</script> 
```

It works nice and fast, and best of all, no AJAX calls. Of course one caveat is that this fails if the user has Javascript disabled, but that's not an issue for me.

# elements - JavaFX 2.0 调整场景中所有内容的大小

> ID：10624624
> 
> 赞同：1
> 
> 时间：2012-05-16T18:39:43.813
> 
> 标签：elements, resize, javafx-2

大家好。我的应用程序有这个问题：如果我让它处于待机状态（不使用它）超过 4-5 分钟，当我将按钮、选项卡、文本字段、文本区域、标签等元素悬停时，它们会变得更大。从 100% 开始，它们的高度和宽度将增加 150%。任何人都知道这可能是什么原因，可能是什么原因以及我该如何阻止它？

编辑：

*   JavaFX SDK：2.0 (x64)
*   JavaFX 运行时：2.0 (x64)
*   操作系统：Microsoft Windows 7 (x64)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T16:55:13.130

这是 JavaFX 2.0 版本中的一个错误，已在 2.1+ 中修复

# jquery - jQuery 自动完成 - 关键结果

> ID：10624626
> 
> 赞同：0
> 
> 时间：2012-05-16T18:39:51.207
> 
> 标签：jquery, autocomplete

我正在创建一个带有单个文本框字段的简单自动完成表单。在每次键入时，我都会循环浏览一个 DB 表并填充一个 DIV (#listKeywords) - 位于文本框的正下方。

这是结果的样子......

```
<div id="listKeywords">
    <div class="acListItem">Product 1</div>
    <div class="acListItem">Product 2</div>
    <div class="acListItem">Product 3</div>
</div> 
```

如果我单击任何结果，该结果将填充文本框（根据需要）。如果我按下键盘上的向下箭头，什么也不会发生。

问：我如何将键盘功能合并到我按下向下箭头并将焦点放在 listKeywords DIV 中的第一个项目/产品上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:42:00.963

在我看来，您只需处理文本框的 keyup 事件并使用特殊类更改您的 div 项目，使其看起来好像它们已被选中。

# java - Ant 任务参数的顺序

> ID：10624627
> 
> 赞同：1
> 
> 时间：2012-05-16T18:39:51.260
> 
> 标签：java, ant, junit

我是 Ant 新手，昨天在一些帮助下编写了一个简单的 build.xml。然而，在查看运行 ant -verbose 的输出之后，似乎我必须处理许多 JUnit 测试的类没有被适当地调用。

```
<project name="JUnit_tests" default="run" basedir=".">

<!-- Define variable properties -->
<property name="src" value="${basedir}"/>
<property name="junit" value="org.junit.runner.JUnitCore"/>

<!--<property name="junit" value="org.junit.runner.JUnitCore"/>-->

<!-- Appends all jars in the current directory to the classpath -->
<path id="compile.classpath">
    <fileset dir="./">
        <include name="*.jar"/>
    </fileset>
</path>

<!-- Compiles all code in the current directory and append to the classpath -->
<target name="compile">
    <javac destdir="${src}" srcdir="${src}">
        <classpath refid="compile.classpath"/>
    </javac>
</target>

<!-- Runs the Test code with junit argument as long as compile was run previously -->
<target name="run" depends="compile">
    <java classname="Tests" fork="true">
        <arg value="${junit}"/>
    </java>
</target> 
```

我的 JUnit 测试在 Tests 类中，我需要使用

```
java org.junit.runner.JUnitCore Tests 
```

但是基于以下输出，我相信它被称为

```
java Tests org.junit.runner.JUnitCore 
```

Ant 详细输出：

```
run:
     [java] Executing '/usr/lib/jvm/java-6-sun-1.6.0.26/jre/bin/java' with arguments:
     [java] 'Tests'
     [java] 'org.junit.runner.JUnitCore'
     [java] 
     [java] The ' characters around the executable and arguments are
     [java] not part of the command.
     [java] Exception in thread "main" java.lang.NoSuchMethodError: main
     [java] Java Result: 1 
```

有任何想法吗？我一直在做研究，但找不到太多关于参数顺序的信息，特别是使用 java 调用。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:42:04.537

您已经颠倒了您的论点（即`Tests`）和主类`org.junit.runner.JUnitCore`。

`<arg>`是程序 `<jvmarg>`的参数是JVM的参数

在他们两者之间，您将拥有主要课程。

Java用法：

> 用法：java [-options] 类 [args...]

在您的情况下，您要执行 main 方法，`org.junit.runner.JUnitCore`并且传递给该 main 方法的参数应该是`Tests`

# java - SWT 文本设置滚动值

> ID：10624633
> 
> 赞同：0
> 
> 时间：2012-05-16T18:40:12.967
> 
> 标签：java, text, swt

在我的应用程序中，我有一个 SWT 文本字段。我需要设置一个滚动值（在我的情况下将字段中的文本滚动到末尾）。我怎么能这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T08:09:27.220

在不移动光标位置的情况下，这应该具有所需的结果：

```
text.setTopIndex(text.getLineCount() - 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:58:00.637

您需要将克拉设置到该位置，这将导致文本滚动到该位置。例如：

```
text.setSelection(text.getText().length()); 
```

# c++ - 数组和右值（作为参数）

> ID：10624636
> 
> 赞同：7
> 
> 时间：2012-05-16T18:40:19.030
> 
> 标签：c++, arrays, c++11, rvalue-reference, rvalue

我想知道是否有任何方法可以区分以下代码中显示的函数调用（以数组作为参数）：

```
#include <cstring>
#include <iostream>

template <size_t Size>
void foo_array( const char (&data)[Size] )
{
    std::cout << "named\n";
}

template <size_t Size>
void foo_array( char (&&data)[Size] )  //rvalue of arrays?
{
    std::cout << "temporary\n";
}

struct A {};

void foo( const A& a )
{
    std::cout << "named\n";
}

void foo( A&& a )
{
    std::cout << "temporary\n";
}

int main( /* int argc, char* argv[] */ )
{
    A a;
    const A a2;

    foo(a);
    foo(A());               //Temporary -> OK!
    foo(a2);

    //------------------------------------------------------------

    char arr[] = "hello";
    const char arr2[] = "hello";

    foo_array(arr);
    foo_array("hello");     //How I can differentiate this?
    foo_array(arr2);

    return 0;
} 
```

foo“函数族”能够区分临时对象和命名对象。不是 foo_array 的情况。

在 C++11 中可能吗？如果没有，你认为可能吗？（显然改变了标准）

问候。费尔南多。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-16T18:43:10.440

没有错`foo_array`。不好的是测试用例：`"hello"`是一个左值！想想看。它不是临时的：字符串文字具有静态存储持续时间。

数组右值将是这样的：

```
template <typename T>
using alias = T;
// you need this thing because char[23]{} is not valid...

foo_array(alias<char[23]> {}); 
```

# javascript - 获取数组限制（Javascript）

> ID：10624646
> 
> 赞同：0
> 
> 时间：2012-05-16T18:41:06.147
> 
> 标签：javascript, arrays, limit

我在自己的灯箱中为画廊设置限制时遇到问题

```
 <script>

var imagenumber = 0;

    function btnleft(){
        load = imagenumber-=1;
        document.getElementById('lightboxcontent').innerHTML=imagelist[load];

        }

function btnright(){
    load = imagenumber+=1;
    if (load==undefined){load=imagenumber-=1}
    document.getElementById('lightboxcontent').innerHTML=imagelist[load];
    }
</script> 
```

然后数组

```
var imagelist=new Array(); // regular array (add an optional integer
imagelist[0]="image1.jpg";       // argument to control array's size)
imagelist[1]="image2.jpg";
imagelist[2]="image3.jpg"; 
```

当我在下一个按钮上单击超过 3 次时，我收到错误消息“未定义”。我应该怎么做才能限制我的阵列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:45:33.780

试试看

```
 function btnleft(){
    var load = imagelist[imagenumber-=1];
    if (load) // imagenumber in array boundaries
        document.getElementById('lightboxcontent').innerHTML = load;
    else
        imagenumber = 0;
 }
 function btnright(){
    var load = imagelist[imagenumber+=1];
    if (load) // imagenumber in array boundaries
        document.getElementById('lightboxcontent').innerHTML = load;
    else
        imagenumber = imagelist.length-1;
 } 
```

然而，`Array`Javascript 中的 s 没有大小限制，它们更像（无限）列表。您几乎无法对它们的长度设置限制 - 特别是不能使用[constructor](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array)，其 number 参数仅用于初始化目的。

您可以使用数组的[`length`属性](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/length)来检查您的索引是否在数组边界内：`i >= 0 && i < arr.length`. 我的代码只是检查该索引处是否有项目（正如您的第二个函数似乎也打算这样做），否则会重置索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:53:23.633

我假设单击“下一步按钮”会调用该`btnright()`函数。

如果是这种情况，那么您正在测试 . 的错误值`undefined`。您可以将函数重写为：

```
function btnright(){
  load = imagenumber += 1;
  // Test the value at the index of the array, not your index variable.
  if (imagelist[load] === undefined) {
    load = imagenumber-= 1;
  }
  document.getElementById('lightboxcontent').innerHTML = imagelist[load];
} 
```

从风格上讲，这仍然不是最好的。您的`load`变量不是必需的，因为它的值总是重复的`imagenumber`。您可以重构函数，例如：

```
function btnright() {
  // If we have a new array value do something.
  if (imagelist[imagenumber + 1] !== undefined) {
    // Increment the index and load the new image.
    document.getElementById('lightboxcontent').innerHTML = imagelist[++imagenumber];
  }
}

function btnleft() {
  // If we're not on the first image do something.
  if (imagenumber !== 0) {
    // Decrement the index and load the new image.
    document.getElementById('lightboxcontent').innerHTML = imagelist[--imagenumber];
  }
} 
```

# javascript - 世界银行 JSONP 解析

> ID：10624651
> 
> 赞同：2
> 
> 时间：2012-05-16T18:41:15.917
> 
> 标签：javascript, jquery, jsonp

这应该是非常直接的，但即使查看其他问题，我也无法让它发挥作用。

我正在从以下链接中检索一些世界银行数据样本：

[世界银行查询](http://api.worldbank.org/countries/GBR/indicators/DC.DAC.FINL.CD?per_page=100&date=1960:2012&format=jsonP&prefix=getWorldBankData)

这将返回以下 JSONP 结构：

```
getWorldBankData([
{
    "page": 1,
    "pages": 1,
    "per_page": "100",
    "total": 52
},
[
    {
        "indicator": {
            "id": "DC.DAC.FINL.CD",
            "value": "Net bilateral aid flows from DAC donors, Finland (current US$)"
        },
        "country": {
            "id": "GB",
            "value": "United Kingdom"
        },
        "value": null,
        "decimal": "0",
        "date": "2011"
    },
    {
        "indicator": {
            "id": "DC.DAC.FINL.CD",
            "value": "Net bilateral aid flows from DAC donors, Finland (current US$)"
        },
        "country": {
            "id": "GB",
            "value": "United Kingdom"
        },
        "value": null,
        "decimal": "0",
        "date": "2010"
    }, 
```

我想获得国家的称号。我一直在尝试使用以下代码：

```
function getWorldBankData(json){
    $.each(json.country ,function(){
        var country = "<option>"+this.value+"</option>"
        $('#category').append(country)
    });
} 
```

但我收到以下错误：

```
 a is undefined
f()jquery.min.js (line 16)
a = undefined
c = function()
d = undefined
getWorldBankData()oil.js (line 11)
json = [Object { page=1, pages=1, per_page="100", more...}, [Object { indicator={...}, country={...}, decimal="0", more...}, Object { indicator={...}, country={...}, decimal="0", more...}, Object { indicator={...}, country={...}, decimal="0", more...}, 49 more...]]
DC.DAC.FINL.CD?per_page=100&date=1960:2012&format=jsonP&prefix=getWorldBankData()DC.DAC...ankData (line 1)
[Break On This Error]   

...all(b,0))}}var b=arguments,c=0,d=b.length,e=d,g=d<=1&&a&&f.isFunction(a.promise)... 
```

它不喜欢这一行（第 11 行）：

```
$.each(json.country ,function(){ 
```

获得国家的正确方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:51:40.013

还没有测试过，但是像这样的东西应该可以解决问题

```
function getWorldBankData(json){
    var item;
    var itemArray = json[1];
    for (var i in itemArray ) {
        item = itemArray[i];
        $('#category').append("<option>"+ item.country.value+"</option>");
    };
} 
```

# qtp - 文件下载：对象不可见

> ID：10624653
> 
> 赞同：1
> 
> 时间：2012-05-16T18:41:16.953
> 
> 标签：qtp

我正在尝试从我的 QTP 脚本下载文件。我想记录我单击“保存”或“取消”按钮的操作，但我收到错误，即对象不可见。

我检查对象存储库并查看具有以下描述属性的文件下载对象：

> text: File Download
> nativeclass: #32770 isowned
> window: True
> is child window: False

...并且没有序数标识符。

这是我的脚本：

> Browser("Browser").Page("Page").WebEdit("meetingid").Set "982"
> Browser("Browser").Page("Page").WebEdit("docid").Set "22"
> Browser("Browser").Page("Page").WebButton("Submit").Click
> Browser("Browser").Dialog("File Download").WinButton("Cancel").Click

我收到此错误：

> 对象不可见
> >第 (4) 行：“Browser("Browser").Dialog("File Download").WinButton("Cancel").Click"。

我需要做什么才能使其可见？我尝试在工具 - 对象标识 - 文件对话框下添加“可见”属性。但是当我这样做时，我开始在所有具有非唯一标识符的对象上出现运行时错误，即多次出现的具有相同“名称”值的元素。

我在这里缺少什么，或者有更好的方法吗？

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T10:29:00.240

处理此问题的更好方法是根本不使用特定对象（因为您必须在多台机器上运行它）。使用击键模拟“保存”，并使用 FilesystemObject 将文件从默认位置复制到所需位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T18:11:15.383

似乎让我在辅助显示器中测试的浏览器（我有一个 2 显示器设置）和在主显示器中运行的 QTP 导致了这个问题。一旦我将浏览器移动到 QTP 正在运行的同一监视器上，我就没有更多问题了。

# iphone - NavigationController 中的 Dealloc

> ID：10624657
> 
> 赞同：1
> 
> 时间：2012-05-16T18:41:43.513
> 
> 标签：iphone, uinavigationcontroller, dealloc

在 UINavigationController 中，什么时候调用了 es dealloc？在我的应用程序中，我有 4 个 ViewController：

View1Controller->View2Controller->View3Controller->View4Controller

如果我在 View2Controller 中并按下返回按钮以转到 View1Controller，则调用 View2Controller 中的 dealloc。但是，如果我在 View1Controller 中并转到 View2Controller，则不会在 View1Controller 中调用 dealloc。

没事吧？或者它的泄漏？

谢谢。

编辑

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:51:18.703

在 UINavigationViewController 堆栈上推送和弹出视图控制器就像一般意义上的堆栈。如果你有一个包含数字的堆栈，推 2，那么 36 会给你一个 2 个数字的堆栈，你不会期望 2 消失。推视图控制器是完全一样的，当你推 ViewController2 时，你不会期望 ViewController1 消失。

然而，随着弹出它是不同的。如果您弹出 36，您将不会期望 36 仍然存在。与视图控制器相同。弹出 ViewController2，当用户界面显示 ViewController1 视图时，它将被释放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T13:28:01.413

检查视图控制器中的 NSTimer。如果 NSTimer 存在，则在控制器的 viewWillDisappear 或 viewDidDisappear 中使其无效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T19:04:07.757

这也与保留计数有关。如果你弹出一个视图控制器并且你没有以任何其他方式引用它，那么引用计数将变为零，iOS 可能会在不久之后释放它。如果您以某种方式引用它，例如拥有类中的成员，并且当它从导航堆栈中弹出时引用计数没有归零，那么那时它不会被释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T18:45:10.720

将视图控制器推送到导航堆栈不会卸载/解除分配您来自的视图控制器。它仍然存在于新堆栈下的堆栈中。如果它没有被保留在其他任何地方（使用强指针），则从视图控制器弹出将取消分配它。

编辑：为什么 View4Controller 会对 View2Controller 中发生的事情做出任何反应？从您描述的方式来看，它甚至不应该在导航堆栈上。

**编辑2：**

要记住的一件事是，当您将某些内容推送到导航堆栈时，其保留计数将增加 1。如果您从导航堆栈中弹出某些内容，其保留计数将减少 1。作为一般规则，当对象的保留计数达到 0，将被释放。

push时，您从中**推送**的项目（现在在您刚刚推送的下方）没有更改其保留计数。它仍然被导航控制器保留，因此不会被释放，而是消失。**弹出**时，弹出项的保留计数确实会下降，如果变为 0，它将被释放。

# java - 上传文件到服务器

> ID：10624669
> 
> 赞同：0
> 
> 时间：2012-05-16T18:42:23.040
> 
> 标签：java, httpurlconnection

下午好：我需要将音频文件（.wav）从客户端传输到服务器。问题是我的代码运行没有错误，但文件没有传输，因为目标文件夹中没有出现！我希望有人可以帮助我.. 问候！

科迪戈：

```
try {
        URL pagina = new URL("http://localhost:8081/prueba/audio.wav");
        HttpURLConnection con = (HttpURLConnection) pagina.openConnection();

        con.setDoOutput(true);
        con.setDoInput(true);
        con.setRequestMethod("POST");
        con.setRequestProperty("content-type", "audio/x-wav");
        con.setUseCaches(false);

        con.connect();

        String filename = System.getProperty("user.home") + "\\.vmaudio\\" +                "audio.wav";

        FileInputStream is = new FileInputStream(filename);

        DataOutputStream fos = new DataOutputStream(con.getOutputStream ());

        int fByte;

        int bytesTrasferidos = 0;
        while ((fByte = is.read()) != -1) {
            fos.write(fByte);
            fos.flush();
            bytesTrasferidos++;
        }
        System.out.println("Bytes Transferidos: "+bytesTrasferidos);

        fos.close();
        is.close();
        con.disconnect();

        } catch (MalformedURLException ex) {
        Logger.getLogger(pruebasVarias.class.getName()).log(Level.SEVERE, null, ex);

        } catch (Exception ex) {
        Logger.getLogger(pruebasVarias.class.getName()).log(Level.SEVERE, null, ex);

        } 
```

PD：可能需要创建一个 servlet 来接收文件并将它们复制到服务器上的文件夹中，但事实并非如此，我的想法是直接从客户端发送它..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:47:07.023

您必须创建 servlet。否则，没有任何东西可以接受您的内容并将其保存到目录中。

幸运的是，您不必自己实现它。看看[jakarta文件上传](http://commons.apache.org/fileupload/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:49:12.133

我猜你不应该使用**DataOutputStream**

看看这个。

[使用 java.net.URLConnection 触发和处理 HTTP 请求](https://stackoverflow.com/questions/2793150/how-to-use-java-net-urlconnection-to-fire-and-handle-http-requests)

```
 URLConnection connection = new URL(url).openConnection();
 connection.setDoOutput(true); // Triggers POST.
 connection.setRequestProperty("Accept-Charset", charset);
 connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded;charset=" + charset);
 OutputStream output = null;
 try {
 output = connection.getOutputStream();
 output.write(query.getBytes(charset));
 } finally {  
    if (output != null) try { output.close(); } catch (IOException logOrIgnore) {}
 }
 InputStream response = connection.getInputStream();
 // ... 
```

# c++ - 在 Visual C++ 6 中显示文件夹选择对话框

> ID：10624670
> 
> 赞同：1
> 
> 时间：2012-05-16T18:42:30.947
> 
> 标签：c++, visual-c++

我想允许用户单击“浏览”按钮并显示文件夹选择对话框以允许用户选择用户硬盘上的文件夹。我该怎么做？我在 VC++ 6 中能找到的最接近的控件是浏览文件名的对话框

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:46:52.417

查看[`SHBrowseForFolder`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762115%28v=vs.85%29.aspx)，它允许您显示标准的 Windows“选择文件夹”对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T05:38:42.343

如果您使用的是 MFC 试试这个

```
 char szFilters[]= "Text Files (*.NC)|*.NC|Text Files (*.txt)|*.txt|All Files (*.*)|*.*||";

// Create an Open dialog; the default file name extension is ".my".

CFileDialog fileDlg (TRUE, "txt", "*.txt",    
      OFN_FILEMUSTEXIST| OFN_HIDEREADONLY, szFilters, this);

if( fileDlg.DoModal ()==IDOK )    
        CString m_strPathname = fileDlg.GetPathName(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T06:12:27.000

我使用[来自 codeproject 的这个类](http://www.codeproject.com/Articles/2024/CFolderDialog-Selecting-Folders)，它是`SHBrowseForFolder`. 它提供了一个类似的接口`CFileDialog`：

```
CFolderDialog dlg(sTitle, sInitialPath, pParentWnd, nFlags);

if(dlg.DoModal() == IDOK)
{
    CString sSelectedFolder = dlg.GetFolderPath();

    // Whatever
    // ...
} 
```

# codeigniter - Codeigniter 模型未加载到控制器中

> ID：10624671
> 
> 赞同：0
> 
> 时间：2012-05-16T18:42:33.777
> 
> 标签：codeigniter

在下面的控制器中使用这个 site_model 会给我一个 500 内部错误。我什至无法将模型添加到我的索引中。我可以在另一个控制器中使用这个模型，而不是索引。

我的模型课有什么问题吗？

```
class Site_model extends CI_Model{

    function getAll(){
        $q = $this->db->get('ci_test');

        if($q->num_rows() > 0){
            foreach ($q->result() as $row) {
                $data[] = $row;
            }
        return $data;
        }

    }

    function getAllCup(){
        $q = $this->db->get('cup');

        if($q->num_rows() > 0){
            foreach ($q->result() as $row) {
                $data[] = $row;
            }
        return $data;
        }
    }

    function getOrderCup(){
        session_start();

        $order = $_SESSION['order'];

        $this->db->select('product_id','name','description','price');

        foreach($order as $product):
            $this->db->where('product_id', $product['product_id']);
        endforeach;

        $q = $this->db->('cup');

        if($q->num_rows() > 0){
            foreach ($q->result() as $row) {
                $data[] = $row;
            }
        return $data;
        }

    }

} 
```

/////

```
 class Checkout extends CI_Controller{

    function index()
    {

        $data['main_content'] = "checkout";
        $this->load->view("includes/template",$data);
    }

    function review()
    {

            $this->load->model('site_model');
            /*echo json_encode($this->site_model->getOrderCupcakes());*/

            echo "sfsfdsf";
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:54:14.557

我看到了几件事。

首先，在您的模型中，`$q = $this->db->('cup');`无效。您需要访问一个有效的方法，例如`$this->db->get('cup')`（实际方法取决于您到底要做什么）。

此外，虽然它目前已被注释掉，但您的模型中有一个名为 的方法`getOrderCup()`，但您正试图访问模型中的一个方法（从您的控制器），名为`getOrderCupcakes()`. 您需要更改其中一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:49:42.337

看看我所做的改变`// problem solved`

```
class Checkout extends CI_Controller{

function index()
{
    $data['main_content'] = "checkout";
    $this->load->view("includes/template",$data);
}

function review()
{
   //$this->load->model('site_model');
   // problem sloved
   $this->load->model('site_model');
   $getOrderCupcakes = $this->site_model->getOrderCupcakes();       
   print_r(json_encode($getOrderCupcakes));
   // problem solved
   /*echo json_encode($this->site_model->getOrderCupcakes());*/
   //echo "sfsfdsf";
}

} 
```

# java - JavaFX 查询 - 从 Java 应用程序启动

> ID：10624672
> 
> 赞同：0
> 
> 时间：2012-05-16T18:42:43.957
> 
> 标签：java, javafx-2

我正在尝试确定 JavaFX2 对项目的适用性。我听过很多美妙的事情，但努力将事实与虚构分开，并希望蜂巢的头脑能发光。

该项目是一个在服务器（Linux、Windows）上持续运行的 Java 守护程序，具有可用于访问配置和查看生成数据的用户界面。我想做的是用户连接到服务器并下载并运行 JavaFX 程序，能够通过 REST 调用连接到服务器（例如）。

是否有可能让这个纯 java 服务器运行，并且只打包 JavaFX 应用程序以供下载？服务器环境是否会影响 JavaFX 是否会运行？我是否必须运行某种形式的网络服务器（Jetty？）才能做到这一点？

我很欣赏这个问题含糊不清 - 我发现一些术语很棘手，所以我会根据需要进行编辑和完善。谢谢你的时间

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T19:18:34.383

> 是否有可能让这个纯 java 服务器运行，并且只打包 JavaFX 应用程序以供下载？

是的。有关打包选项和说明，请参阅 JavaFX[部署快速](http://docs.oracle.com/javafx/2/get_started/basic_deployment.htm)入门和[部署指南](http://docs.oracle.com/javafx/2/deployment/jfxpub-deployment.htm)。

> 服务器环境是否会影响 JavaFX 是否会运行？

不，JavaFX 仅在客户端而不在服务器上运行。

> 我是否必须运行某种形式的网络服务器（Jetty？）才能做到这一点？

大概。您将需要有某种方式将您的 JavaFX 应用程序提供给客户端。

您可以将您的 JavaFX 应用程序通过电子邮件发送给您的客户，或者通过网络文件副本将它们放在您的客户端上，但是将应用程序托管在网络服务器上可能是最好的方法。任何 http 服务器都可以用于此目的（例如 apache httpd、tomcat、jetty 作为独立服务器或嵌入在您的应用程序中的服务器）。

您将需要某种方式让 JavaFX 应用程序与服务器通信。如果这种通信是使用 REST 调用进行的，那么您很可能使用 http 作为底层客户端/服务器通信协议，在这种情况下，无论如何您都需要运行 Web 服务器来处理来自客户端的传入 REST 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-08T16:14:37.107

> 我想做的是用户连接到服务器并下载并运行 JavaFX 程序，能够通过 REST 调用连接到服务器（例如）。

您应该在关键字上搜索`JavaFX`,`REST`和`enterprise`. 有几个使用 RESTful Web 服务方法的示例。JavaFX 可以通过 Java Web Start 启动。但是，如果您打算使用 Java Web Start，我认为您没有理由使用 http 有线 RESTful Web 服务。看起来没有一种标准化的方法可以将 JavaFX Web 启动应用程序打包到 EAR 包中，并让他对服务器端资源使用依赖注入。但是，如果您打包一个常规 Java SE 应用程序并让该应用程序启动一个 JavaFX 应用程序并将代理对象转发到您的后端资源，这是可能的。这是我使用仅使用 NetBeans 向导和一些小的代码自定义的解决方案编写的教程：

[http://blog.martinandersson.com/the-enterprise-side-of-javafx-the-missing-part/](http://blog.martinandersson.com/the-enterprise-side-of-javafx-the-missing-part/)

# excel - 如何根据条件使用 Excel VBA 复制行

> ID：10624678
> 
> 赞同：0
> 
> 时间：2012-05-16T18:43:11.557
> 
> 标签：excel, vba

我想根据一列中的以下条件将行从一张纸复制到另一张纸：

1.  如果一行在列中包含值“AB”，则将该行复制到工作表中，但如果下一行在同一列中具有相同的值，则忽略该行并继续
2.  如果一行在列中包含值“NULL”，则将该行复制到工作表中 - 这里没有限制

我写了一些逻辑，但它不起作用 - 这是相关的片段：

```
If wks.Range("N" & CStr(LSearchRow)).Value = "NULL" Or Not _
wks.Range("N" & CStr(LSearchRow)).Value = optionCode Then

    'Select row in master to copy
    Rows(CStr(LSearchRow) & ":" & CStr(LSearchRow)).Select

    Selection.Copy

    'Paste row into new worksheet in next row
    wksCopyTo.Select

    wksCopyTo.Rows(CStr(LCopyToRow) & ":" & CStr(LCopyToRow)).Select

    wksCopyTo.Paste

    optionCode = wks.Range("N" & CStr(LSearchRow)).Value

    'Move counter to next row
    LCopyToRow = LCopyToRow + 1

    'Remove blank rows
    wksCopyTo.Columns(1).SpecialCells(xlCellTypeBlanks).EntireRow.Delete

    'Go back to Master Sheet to continue searching
    wks.Select
End If 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:23:32.477

Here's a small Sub that you can pass your Range reference and Row on copy worksheet into that should do the trick. If you can't figure out how to incorporate it, blow out your code a bit and I will show you how to squeeze it in.

```
Sub copyrow(rng As Range, LCopyToRow As Long)

If rng = vbNullString Then rng.EntireRow.Copy wksCopyTo.Cells(LCopyToRow, 1)

If rng.Offset(1) <> rng Then rng.EntireRow.Copy wksCopyTo.Cells(LCopyToRow, 1)

End Sub 
```

Also, in above code, no need to use select when writing VBA. It's slower and less efficient. Line 5 to 14 (counting blank lines and comments) above can be written simply like this

```
Rows(CStr(LSearchRow) & ":" & CStr(LSearchRow)).Copy wksCopyTo.Rows(CStr(LCopyToRow) & ":" & CStr(LCopyToRow)) 
```

# python - 用于搜索 PII 的 Python 脚本

> ID：10624681
> 
> 赞同：5
> 
> 时间：2012-05-16T18:43:32.993
> 
> 标签：python, privacy, pii

我想编写一个脚本，可以在文件系统中搜索和报告个人身份信息，如卡号等。我想在 txt 以及 xls word 和 PDF 文件中找到它。

欢迎任何入门技巧或使用哪个库。

我还想就一种有效的方法来扫描大文件以查找信用卡等模式的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-10-17T02:11:03.507

试一试piianalyzer： [https ://pypi.python.org/pypi/piianalyzer/0.1.0](https://pypi.python.org/pypi/piianalyzer/0.1.0)

或者您可以自己编写并使用常见的正则表达式数据集，例如 [https://github.com/madisonmay/CommonRegex](https://github.com/madisonmay/CommonRegex)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-05T14:04:24.573

如果您在一家公司工作，您可以考虑购买打包解决方案。我看到的一个广告是 Nuix。此外，Oracle 为 GDPR（新的欧盟隐私法）提供端到端解决方案，其中包括您描述的那种功能。请参阅[http://www.oracle.com/technetwork/database/security/wp-security-dbsec-gdpr-3073228.pdf](http://www.oracle.com/technetwork/database/security/wp-security-dbsec-gdpr-3073228.pdf)。

如果您拥有 Oracle RDBMS，则有一个名为 CTXSYS（现在称为 Oracle Text）的包，它具有跨文档的惊人搜索功能，包括 PDF、整个 Office 套件等等。CTXSYS 包含在常规许可证中。如果您是家庭用户，您可以下载 Oracle 服务器（Express 版本适合此功能）。

如果您按照上面的建议使用正则表达式，一种简单的方法是搜索在句子中间大写的单词，但这仅对文档有帮助（例如，对 XLS 没有多大帮助）。您还可以建立一个常用名字典（名字/姓氏、街道、城镇）。信用卡和 SSN 应该很容易进行正则表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-09T09:52:52.103

我们正在实施一个类似的系统，该系统允许从动态表单和 CSV 导入中输入数据。字段将被分类为列表、数字范围、自由文本。数据最终出现在数据库表的一个字段中。我们正在扫描自由文本条目以查找 PHI。数据通过网站输入并存储在 SQL Server 中。我们启动一个命令，将任何新导入批次的 id 添加到 RabbitMQ 队列，并将批次中的所有自由文本字段标记为待检查，以防止它们被显示或导出。所有被视为“安全”的字段，例如从下拉列表或基于数字范围的字段都可以导出或显示在图表中。只有自由文本字段被临时锁定。然后，python Windows 服务从 Rabbit 队列中提取并扫描每个文本字段以查找 PHI 并相应地标记它们。如果有看起来可疑的字段，我会收到一份报告并手动检查整个文本导入批次。我目前正在使用[Spacy](https://spacy.io/)用于实体识别，以及[Deuce](https://github.com/vmenger/deduce)方面以查找其他 PHI 类型。

由于分析是异步进行的，因此我能够通过多种扫描方法对数据进行处理，而不会影响性能。

# android - 每秒计算当前时间和未来时间之间的时差

> ID：10624682
> 
> 赞同：2
> 
> 时间：2012-05-16T18:43:37.140
> 
> 标签：android

我必须以小时、分钟和秒为单位计算时差，并在每秒后更新我的启动活动时间。我正在使用此代码。

```
 private Handler handler=new Handler() ;
private Runnable updateTimeTask = new Runnable() {
    @Override
    public void run() {

            updateTime();
            //handler.postDelayed(updateTimeTask, 1000);

    }
    };          @Override
protected void onResume() {
    super.onResume();

    int delay = 1000; // delay for 1 sec.

    int period = 1000; // repeat every 4 sec.

    Timer timer = new Timer();

    timer.scheduleAtFixedRate(new TimerTask() {

    public void run() {

         handler.post(updateTimeTask);

    }

    }, delay, period);           }         
      private void updateTime() {

    final TextView time = (TextView) findViewById(R.id.txtViewTime);
    final TextView date = (TextView) findViewById(R.id.txtViewAlarmDesc);

    pref = new Prefs(this);
    String goal_dateTime= pref.getValue("first_goal_dateTime", "");

    Date d1 = Utils.strToDate(goal_dateTime);

    Calendar cal = Calendar.getInstance();
    if(d1!=null && d1.after(new Date()))
    {
    cal.setTime(d1);
    }
    Date cur = new Date();
    Calendar cal_cur = Calendar.getInstance();
    cal_cur.setTime(cur);

    final SimpleDateFormat formatterTime = new SimpleDateFormat("H:mm");

      long milliseconds1 = cal.getTimeInMillis();
      long milliseconds2 = cal_cur.getTimeInMillis();
      long diff = milliseconds1 - milliseconds2;
      long diffSeconds = diff / 1000;
      long diffMinutes = diff / (60 * 1000);
      long diffHours = diff / (60 * 60 * 1000);
      long diffDays = diff / (24 * 60 * 60 * 1000);

      time.setText(diffHours + " : " + diffMinutes+" : "+diffSeconds);
      date.setText(String.valueOf(diffDays+" days left to complete goal"));

} 
```

但是当我第一次启动活动时，它工作正常，当我从它开始另一个活动并再次返回它时，应用程序只是挂起并出现黑屏，并且经过很长时间它给了我诸如 ANR、keydispatchtimeout 之类的错误。

我尝试了几种解决方案，例如在单独的线程中调用我的 updateTime()，但它给了我一个错误“只有创建视图层次结构的原始线程才能触及它的视图。”</p>

任何形式的帮助将不胜感激。提前谢谢了。

问候， 穆纳扎 K

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:57:36.913

您应该使用[runOnUiThread](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)来更新您的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T20:47:14.917

我怀疑您的问题可能是您离开活动时没有删除回调。我使用 postDelayed 而不是 scheduleAtFixedRate 以稍微不同的方式实现了同样的事情，如下所示：

```
 private Handler h = new Handler();
    private static final long TIME_EVERY_SECOND = 1000;

    private Runnable onEverySecond = new Runnable() {
            public void run() {
                updateTime();
                h.postDelayed(onEverySecond, TIME_EVERY_SECOND);
            }
        };

        @Override
        public void onPause() {
            super.onPause();

            if (h != null) {
                h.removeCallbacks(onEverySecond);
            }
        }

        @Override
        public void onResume() {
            super.onResume();
            h.postDelayed(onEverySecond, TIME_EVERY_SECOND);
        } 
```

# php - 执行 API 调用，直到返回所需的响应

> ID：10624685
> 
> 赞同：0
> 
> 时间：2012-05-16T18:43:50.473
> 
> 标签：php

我正在创建的过程需要将数据发送到肥皂服务。在我得到理想的回应之前，我无法继续我的下一步行动。

```
try {
    $return = $soapClient->__soapCall("BulkLoadContacts",array('parameter' => $params));

    foreach ($return as $r){
        $upload_id = $r;
    }

    $process_params = array(
        'ProcessID' => $upload_id,
    );
    $return = $soapClient->__soapCall("GetProcessStatus",array('parameter' => $process_params));
    var_dump($return);

}
catch(SoapFault $fault){
    $status = false;
} 
```

在上面的代码中，我执行了该`BulkLoadContacts`方法。然后我`ProcessID`从响应中获取。获得该 ID 后，我会再次调用以获取我的进程的状态。最后一个转储者告诉我的响应`GetProcessStatus`。自卸车看起来像：

```
object(stdClass)#18 (1) {
  ["WSProcessStatus"]=>
  object(stdClass)#19 (6) {
    ["ProcessID"]=>
    int(3313881)
    ["ListID"]=>
    int(268207)
    ["ProcessName"]=>
    string(20) "listrak_tempfile.txt"
    ["ProcessStartTime"]=>
    string(23) "2012-05-16T14:22:50.643"
    ["ProcessCompleteTime"]=>
    string(22) "2012-05-16T14:22:50.84"
    ["Status"]=>
    string(19) "ProcessingCompleted"
  }
} 
```

最后一项是`Status`。只有在方法返回“ProcessingCompleted”的值之前，我才想继续。关于如何做到这一点的任何建议？一个简单的do-while就足够了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T17:46:37.607

do/while 应该可以解决问题。但我建议在每个循环中放置一个延迟，否则您将敲打 Soap 服务器。

此外，您可能希望指定最大尝试次数。你不想让你的程序陷入无限循环。

```
try {
    $return = $soapClient->__soapCall("BulkLoadContacts",array('parameter' => $params));

    foreach ($return as $r){
        $upload_id = $r;
    }

    $attempts_remaining = 10;
    do {
        sleep(1);
        $process_params = array(
            'ProcessID' => $upload_id,
        );
        $return = $soapClient->__soapCall("GetProcessStatus",array('parameter' => $process_params));

        $attempts_remaining--;
    } while (($return->WSProcessStatus->Status != 'ProcessingCompleted') && ($attempts_remaining > 0));

    if($return->WSProcessStatus->Status == 'ProcessingCompleted') {
        //success
    }
    else {
        //timeout
    }

}
catch(SoapFault $fault){
    $status = false;
} 
```

# javascript - Jquery 适用于除 IE 以外的所有浏览器

> ID：10624687
> 
> 赞同：0
> 
> 时间：2012-05-16T18:43:59.660
> 
> 标签：javascript, jquery, html, css

对于 IE，此代码有效，我做了只有 IE 才能读取的 IE 注释。

```
<!--[if gt IE 6]>
<script type="text/javascript" 
        src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
{

    //--my code
    $(document).ready(function() 
    {
        $('.thumbnail').live("click", function() 
        {
            $('#mainImage').hide();
            $('#imageWrap').css('background-image', "url('ajax-loader.gif')");
            var i = $('<img />').attr('src',this.href).load(function() 
            {
                $('#mainImage').attr('src', i.attr('src'));
                $('#imageWrap').css('background-image', 'none');
                $('#mainImage').fadeIn();
            });
            return false; 
        });
    });
};

</script> <![endif]--> 
```

对于其他所有浏览器，此代码都有效...

```
<script type="text/javascript">
$(document).ready(function() {
    $('.thumbnail').live("click", function() {
        $('#mainImage').hide();
        $('#imageWrap').css('background-image', "url('ajax-loader.gif')");
        var i = $('<img />').attr('src',this.href).load(function() {
            $('#mainImage').attr('src', i.attr('src'));
            $('#imageWrap').css('background-image', 'none');
            $('#mainImage').fadeIn();
        });
        return false; 
    });
});

</script> 
```

我得到了工作代码，即使他们每个人都做不同的事情，他们做我需要他们做的事情。唯一的事情是 IE 不想阅读代码来做我需要的事情......我错过了什么？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:49:17.800

您的 IE6 版本中有太多右括号，请参见此处：

```
});
}; <- delete me 
```

删除`};`，你应该很好:)

编辑：你一`{`开始也有一个流氓，也摆脱它，它在这里：

```
{ <- delete that!

//--my code
$(document).ready(function() 
{ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:51:36.253

document.ready() 外部的左大括号和右大括号是代码的一部分吗？

删除第一个

```
{ 
```

也是最后一个

```
}; 
```

你不需要用大括号把所有东西都包起来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:50:45.513

交换这两个：

```
$('<img />').attr('src',this.href).load(function() 
```

应该

```
$('<img />').load(function(){...}).attr('src',this.href)... 
```

这样一旦图像被缓存，它将在 IE6-IE8 中工作。

参考这个答案：[检查动态加载的图像是否完整](https://stackoverflow.com/questions/10609422/check-if-dynamically-loaded-images-are-complete/10609458#10609458)

# ios - 使用 iOS 定义的本地化在 UINavigationBar 上获取一个“返回”按钮

> ID：10624691
> 
> 赞同：2
> 
> 时间：2012-05-16T18:44:10.313
> 
> 标签：ios, localization, uinavigationbar, uibarbuttonitem

我有`UINavigationBar`两个不同的屏幕。在两个屏幕上，NavigationBar 具有相同的标题。所以 BackButton 应该有`Back`文本而不是 NavigationBar 的标题。

如果我将父 ViewController 标题设置为`nil`我有一个带有 text 的 backButton `Back`，它会被 iOS 自动本地化。

我知道我可以按照这个问题中的描述将文本设置为后退：[如何在 UINavigationBar 上设置后退按钮的文本？](https://stackoverflow.com/questions/2197698/how-to-set-the-text-of-a-back-button-on-a-uinavigationbar) 但是，它`Back`是硬编码的，不会被 iOS 自动翻译。

我不想自己维护本地化，`Localizable.strings`而是使用 iOS 中的预定义值。

我想在我的 NavigationBar 上始终有一个标题和一个 backButton，它表示`Back`并使用 iOS 定义的值自动本地化。

有人知道是否以及如何实现这种行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:40:08.233

据我所知，你不能强迫这种行为。解决它的一种方法是使用 UITextView 将标题添加到导航栏：

```
[self.navigationItem setTitleView:myUITextView] 
```

# objective-c - 计算xcode中时间差异中的闰年天数

> ID：10624696
> 
> 赞同：1
> 
> 时间：2012-05-16T18:44:18.187
> 
> 标签：objective-c, ios5, xcode4.2

我正在尝试确定可以追溯到 19 世纪的应用程序的两个不同日期之间的闰年天数 - 这是一个方法示例：

```
-(NSInteger)leapYearDaysWithinEraFromDate:(NSDate *) startingDate toDate:(NSDate *) endingDate {

// this is for testing - it will be changed to a datepicker object
NSDateComponents *startDateComp = [[NSDateComponents alloc] init];
[startDateComp setSecond:1];
[startDateComp setMinute:0];
[startDateComp setHour:1];
[startDateComp setDay:14];
[startDateComp setMonth:4];
[startDateComp setYear:2005];

NSCalendar *GregorianCal = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];

//startDate declared in .h//
startDate = [GregorianCal dateFromComponents:startDateComp];
NSLog(@"This program's start date is %@", startDate);

NSDate *today = [NSDate date];
NSUInteger unitFlags = NSDayCalendarUnit;
NSDateComponents *temporalDays = [GregorianCal components:unitFlags fromDate:startDate toDate:today options:0];

NSInteger days = [temporalDays day];

// then i will need code for the number of leap year Days

return 0;//will return the number of 2/29 days

} 
```

所以我有日期之间的总天数。现在我需要减去闰年的天数？？？

PS - 我知道这个例子中有两个闰年，但该应用程序将追溯到 19 世纪......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-06-08T07:57:15.283

对于**斯威夫特**

```
func getLeapCount(startDate : NSDate , endDate : NSDate)-> Int{
    var intialDate = startDate
    var dateComponent = NSDateComponents()
    dateComponent.day = 1
    var leapCount = 0;
    var currentCalendar = NSCalendar.currentCalendar()
        while (intialDate.compare(endDate) == NSComparisonResult.OrderedAscending) {
            intialDate = currentCalendar.dateByAddingComponents(dateComponent, toDate: intialDate, options: NSCalendarOptions.allZeros)!            
            if self.isLeapYear(startDate){
                ++leapCount
            }
    }

    return leapCount
}
func isLeapYear (year : NSDate )-> Bool{
    let cal = NSCalendar.currentCalendar()
    let year = cal.component(NSCalendarUnit.CalendarUnitYear, fromDate: year)
    return (( year%100 != 0) && (year%4 == 0)) || year%400 == 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:54:26.293

一个简单的解决方案是遍历两个日期之间的所有年份，如果是闰年，则调用函数递增计数器。（来自维基百科）

```
if year modulo 400 is 0 then 
   is_leap_year
else if year modulo 100 is 0 then 
   not_leap_year
else if year modulo 4 is 0 then 
   is_leap_year
else
   not_leap_year 
```

这会给你闰年的数量，因此你需要减去的闰年天数。可能有更有效的方法，但这是我现在能想到的最简单的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T19:04:09.427

好的，好吧，你把这个复杂化了。我认为这就是你想要的：

```
NSUInteger leapYearsInTimeFrame(NSDate *startDate, NSDate *endDate)
{
    // check to see if it's possible for a leap year (e.g. endDate - startDate > 1 year)
    if ([endDate timeIntervalSinceDate:startDate] < 31556926)
        return 0;

    // now we go year by year
    NSUInteger leapYears = 0;
    NSUInteger startYear = [[NSCalendar currentCalendar] components:NSYearCalendarUnit fromDate:startDate].year;
    NSUInteger numYears = [[NSCalendar currentCalendar] components:NSYearCalendarUnit fromDate:endDate].year - startYear;

    for (NSUInteger currentYear = startYear; currentYear <= (startYear + numYears); currentYear++) {
        if (currentYear % 400 == 0)
            // divisible by 400 is a leap year
            leapYears++;
        else if (currentYear % 100 == 0)
            /* not a leap year, divisible by 100 but not 400 isn't a leap year */ 
            continue;
        else if (currentYear % 4 == 0)
            // divisible by 4, and not by 100 is a leap year
            leapYears++;
        else 
            /* not a leap year, undivisble by 4 */
            continue;
    }

    return leapYears;    
} 
```

# asp.net - 分配回发触发器以控制 ListView

> ID：10624698
> 
> 赞同：0
> 
> 时间：2012-05-16T18:44:25.597
> 
> 标签：asp.net, listview, c#-4.0, updatepanel

我在 UpdatePanel 中有一个 ListView。ListView 的每一行都包含一些按钮。一个按钮调用发送文件的方法 (Response.WriteFile(...)) 所以它应该被视为回发触发器，我的问题是如何实现这一点？当我将此按钮的 ID 放入 UpdatePanel 的触发器部分时，我收到错误“（...）控件未找到（...）”。数据仅在第一页加载期间绑定到 ListView

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:58:14.700

尝试将整个控件注册为触发器。请参见下面的示例。您也可以在代码中执行此操作。

```
AsyncPostBackTrigger trigger;
trigger=new AsyncPostBackTrigger();
trigger.ControlID = Button2.ID;
UpdatePanel1.Triggers.Add(trigger);

<form id="form1" runat="server">
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>
<asp:Label ID="Label2" runat="server" Text="Label">Static Text:</asp:Label>
<br />
<asp:LinkButton ID="LinkButton1" runat="server">LinkButton01</asp:LinkButton><br>
<hr />
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
    <ContentTemplate>
        <asp:Label ID="Label1" runat="server" Text="Label">Text in UpdPanel</asp:Label>
    </ContentTemplate>
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="LinkButton1" EventName="Click" />
    </Triggers>
</asp:UpdatePanel>
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T12:20:47.920

为包含按钮的列表视图添加一个`PostBackTrigger`。

# sql-server - 如何将存储在 Access Query 中的数据导入 SQL

> ID：10624703
> 
> 赞同：1
> 
> 时间：2012-05-16T18:44:36.730
> 
> 标签：sql-server, ms-access

我想导入存储在名为“T4-R01”的访问查询中的所有数据（列/行）

我正在尝试在 SQL Server 管理 2008 中使用以下语法：

```
select Month from OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0','Data Source=c:\EatonFAS109Q12012.mdb;User ID=;Password=')...[T4-R01] 
```

我收到以下错误：

```
OLE DB provider "Microsoft.Jet.OLEDB.4.0" for linked server "(null)" returned message    "Unspecified error".
Msg 7303, Level 16, State 1, Line 1
Cannot initialize the data source object of OLE DB provider "Microsoft.Jet.OLEDB.4.0" for linked server "(null)". 
```

我使用正确的语法吗？有什么建议么？

# php - 只显示一次数据

> ID：10624705
> 
> 赞同：1
> 
> 时间：2012-05-16T18:44:42.897
> 
> 标签：php, mysql

我为日托中心的父母创建了一个联系人列表。现在我想在网页上显示它。到目前为止，它在技术上运行完美，但它的布局让我不满意。

我的数据库如何工作的简短说明：每个父母可以有一个或多个孩子，每个孩子可以有一个或多个父母 - 多对多关系。为了建立一对多的关系，我将其分解为三张表 - parents、children 和 parent_children。然后我使用了 JOIN 并且一切都显示得很好。但是，由于它显示了每个实体，因此在网页上显示它会变得相当混乱。我会用一个例子来解释：

家庭 1：马克和爱丽丝威尔逊有两个孩子，约翰和比尔。
家庭 2：彼得和杰西卡罗伯逊有一个孩子，丽莎。

```
Current layout:
Parent                Child
-------------------------------
Mark Wilson           John Wilson
Mark Wilson           Bill Wilson
Alice Wilson          John Wilson
Alice Wilson          Bill Wilson

Peter Robertson       Lisa Robertson
Jessica Robertson     Lisa Robertson
-------------------------------

Desired layout:
Parent                Child
-------------------------------
Mark Wilson           John Wilson
Alice Wilson          Bill Wilson

Peter Robertson       Lisa Robertson
Jessica Robertson
------------------------------- 
```

有没有什么好的方法来获得所需的布局？

* * *

好的，所以现在我已经在一个列中得到这个工作，这取决于我如何使用 GROUP_CONCAT：

代码：

```
SELECT GROUP_CONCAT(parents.name) AS Parents, children.name
FROM parents p
LEFT JOIN parents_children pc USING(id_parent)
LEFT JOIN children c USING(id_child)
GROUP BY pc.id_parent; 
```

结果：

```
Parents                             Children
-----------------------------------------------
Mark Wilson, Alice Wilson           Bill Wilson
Mark Wilson, Alice Wilson           John Wilson
Peter Robertson, Jessica Robertson  Lisa Robertson 
```

同样，如果我改为使用 GROUP_CONCAT children.name 和 GROUP BY pc.id_child，我会得到：

```
Parents                Children
------------------------------------------
Mark Wilson            Bill Wilson, John Wilson
Alice Wilson           Bill Wilson, John Wilson
Peter Robertson        Lisa Robertson
Jessica Robertson      Lisa Robertson 
```

我真的想要这些的组合，结果如下：

```
Parents                                Children
----------------------------------------------------
Mark Wilson, Alice Wilson              Bill Wilson, John Wilson
Peter Robertson, Jessica Robertson     Lisa Robertson 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:55:28.673

SELECT DISTINCT 应​​该将它们限制为父表中每个实体的一个实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:31:47.373

```
SELECT
    Parents
  , GROUP_CONCAT(name ORDER BY name) AS Children
FROM
  ( SELECT 
        GROUP_CONCAT(p.id_parent ORDER BY p.name) AS parents_ids
      , GROUP_CONCAT(p.name ORDER BY p.name) AS Parents
      , pc.id_child
      , c.name
    FROM parents p 
      JOIN parents_children pc USING(id_parent)
      JOIN children c USING(id_child)
    GROUP BY pc.id_child
  ) AS tmp 
GROUP BY parents_ids ; 
```

您可以在以下位置进行测试：[SQL-Fiddle](http://sqlfiddle.com/#!2/795d5/1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-19T00:15:07.060

表父母：

```
CREATE TABLE `parents` ( 
```

`id_part`int(11) NOT NULL AUTO_INCREMENT, `parent`varchar(60) DEFAULT NULL, PRIMARY KEY ( `id_part`)) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8

表孩子：

```
CREATE TABLE `child` ( 
```

`id_child`int(11) NOT NULL AUTO_INCREMENT, `child`varchar(60) DEFAULT NULL, `f_name`int(11) DEFAULT NULL, `m_name`int(11) DEFAULT NULL, PRIMARY KEY ( `id_child`), KEY `m_key`( `m_name`), KEY `f_key`( `f_name`), CONSTRAINT `f_key`FOREIGN KEY ( `f_name`) 参考`parents`( `id_part`) ON DELETE CASCADE ON UPDATE CASCADE, 约束外`m_key`键 ( `m_name`) 参考`parents`( `id_part`) ON DELETE CASCADE ON UPDATE CASCADE ) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8

查询连接两个表

```
SELECT DISTINCT 
```

GROUP_concat(child.child), p1.parent, p2.parent FROM child Inner Join parents AS p1 ON p1.id_part = child.f_name Inner Join parents AS p2 ON p2.id_part = child.m_name GROUP BY p1.parent, p2。父母

结果

## 孩子的名字 | 父亲的名字| 母亲的名字

## x,y,z | 父亲 1 | 妈妈 1

## q,r | 父亲2 | 妈妈 2

## t,j | 父亲3 | 母亲 3

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T19:03:50.837

这个问题有两种解决方案：

1.  在 php 端遍历数组并创建一个数组，其中 key of
    `[$parent_1 . '|' . $parent2]`包含另一个带有子元素的数组。

2.  在 SQL 结束时做类似这样的事情：

    ```
    SELECT 
        GROUP_CONCAT(Parents.name ORDER BY Parents.parents_id, '|') AS parents, 
        Children.name as child
    FROM Children 
        LEFT JOIN CildrentParents USING( children_id )
        LEFT JOIN Parents USING( parent_id )
    GROUP BY Childrent.children_id 
    ```

    然后使用这个数据集。

PS我不明白，添加`DISTINCT`到原始查询中如何解决这个问题......也许我在这里遗漏了一些东西。

## 更新

究竟是什么阻止您使用 PHP 创建一个数组，其中每个`parent`键都包含一个子列表？

# jquery - jQuery Roundabout 重绘/调整大小问题

> ID：10624709
> 
> 赞同：0
> 
> 时间：2012-05-16T18:45:01.517
> 
> 标签：jquery, css

我正在开发一个涉及[jQuery Roundabout](http://fredhq.com/projects/roundabout "jQuery 环形交叉路口")的新项目。我已经按照我想要的方式设置了大部分样式（我将添加不同的边框和填充，但这不是问题），但目标市场经常调整页面大小（不要问，我不太清楚为什么任何一个）。

所以这给我带来了我的问题，当我访问我的项目站点时：[http](http://cirkut.net/sub/proven/landing/) ://cirkut.net/sub/proven/landing/它加载并且回旋处工作得很好，但是在调整大小时，我希望它“重绘”并重新-居中环岛。调整大小时，单击其中一项，它将“重绘”并再次居中。

这是我的回旋电话：

```
$('#slides').roundabout({
    easing: 'easeInOutQuart',
    responsive: true
}); 
```

这就是我试图避免这个问题的原因：

```
$(window).bind("resize", function() {
    $('#slides').roundabout("relayoutChildren");
}); 
```

然而，发生的事情是它正在转发新`<li>`的 's 并重新迂回它们，这会缩小图像。

任何人都可以对此提供任何见解吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:22:43.123

在摆弄了多个选项之后，我找到了一个可行的。

我使用下面的而不是上面的`"resize"`绑定，它刷新得很好。

```
$(window).bind("resize", function() {
    $('#slides .slide').removeAttr("style");
    $('#slides').roundabout({
        easing: 'easeInOutQuart',
        responsive: true
    });
}); 
```

我发现内联 CSS 是它的位置，如果我重新绕行，它会根据当前大小更改大小，这会导致调整大小时出现无限的“调整大小”循环。因此，如果我删除内联样式然后立即放回`#slides`环形交叉路口，它会正确定位并重新添加内联样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-23T14:00:20.083

您可以使用回旋处`$focusbearing` 属性：`$minScale`并`$maxScale`相对于前面的图像缩放转盘中的图像。这是一个例子：

```
 $('#slides').roundabout({
      easing: 'easeInOutQuart',
      responsive: true ,
      minScale: 0.8
 }); 
```

这将使图像保持成比例。如果您想使用较少数量的图像，请增加比例，反之亦然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-28T17:50:58.573

我解决了在调整大小时刷新页面的问题：

```
var windowWidth = $(window).width();

$(window).resize(function() {
if(windowWidth != $(window).width()){
location.reload();
return;
}
}); 
```

# google-maps-api-3 - 示例谷歌地图代码的问题

> ID：10624710
> 
> 赞同：0
> 
> 时间：2012-05-16T18:45:05.633
> 
> 标签：google-maps-api-3

执行这个：

```
$curl "http://maps.googleapis.com/maps/api/geocode/json?address=1600+Amphitheatre+Parkway,+Mountain+View,+CA&sensor=false" 
```

返回这个：

```
{
   "results" : [],
   "status" : "ZERO_RESULTS"
} 
```

为什么它不起作用？

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:54:52.797

不确定，但是当我直接在浏览器中点击该 URL 时，我得到了相同的结果。它可能与[Google Maps API Web Services Dev Guide 的 Geocoding Responses 部分中](https://developers.google.com/maps/documentation/geocoding/#GeocodingResponses)显示的示例地址有关。也许他们把它关掉了，因为它变得超载了？

我什至尝试了该地址的 URL 编码版本：

[http://maps.googleapis.com/maps/api/geocode/json?address=1600%20Amphitheatre%20Parkway%2C%20Mountain%20View%2C%20CA&sensor=false](http://maps.googleapis.com/maps/api/geocode/json?address=1600%20Amphitheatre%20Parkway%2C%20Mountain%20View%2C%20CA&sensor=false)

但得到与原始尝试相同的结果。

我可以告诉你，如果你直接访问[http://maps.google.com/maps](http://maps.google.com/maps)并输入：`1600 Amphitheatre Parkway, Mountain View, CA`，你*会*得到结果。

无论如何，您的 URL 基本上格式正确并且应该可以工作。尝试不同的地址，格式相同，你会得到结果。这对我来说很好：

[http://maps.googleapis.com/maps/api/geocode/json?address=Wrigley+Field&sensor=false](http://maps.googleapis.com/maps/api/geocode/json?address=Wrigley+Field&sensor=false)

一些跟进，我不确定你试图在哪里运行你的代码，但如果它在 jsFiddle 中，你可能会对这个问题感兴趣：[JQuery won't get json?](https://stackoverflow.com/q/5281039/1314132)

# android - Android C2DM 从服务器端发送附加信息

> ID：10624714
> 
> 赞同：0
> 
> 时间：2012-05-16T18:45:14.023
> 
> 标签：android, cloud, device, messaging, android-c2dm

如何使用 c2dm 从服务器端发送附加信息，如 userId 或 eventId，并在 onMessage() 函数中从我的 android 应用程序获取？

这是服务器端函数 C# 上的 SendMessage

```
private static void SendMessage(string authTokenString, string registrationId, string message)
    {
        //Certeficate was not being accepted for the sercure call
        //ServicePointManager.ServerCertificateValidationCallback += new RemoteCertificateValidationCallback(ValidateServerCertificate);

        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(GoogleMessageUrl);
        request.Method = PostWebRequest;
        request.KeepAlive = false;

        NameValueCollection postFieldNameValue = new NameValueCollection();
        postFieldNameValue.Add(RegistrationIdParam, registrationId);
        postFieldNameValue.Add(CollapseKeyParam, "0");
        postFieldNameValue.Add(DelayWhileIdleParam, "0");
        postFieldNameValue.Add(DataPayloadParam, message);

        string postData = GetPostStringFrom(postFieldNameValue);
        byte[] byteArray = Encoding.UTF8.GetBytes(postData);

        request.ContentType = "application/x-www-form-urlencoded;charset=UTF-8";
        request.ContentLength = byteArray.Length;

        request.Headers.Add(HttpRequestHeader.Authorization, "GoogleLogin auth=" + authTokenString);

        Stream dataStream = request.GetRequestStream();
        dataStream.Write(byteArray, 0, byteArray.Length);
        dataStream.Close();

        WebResponse response = request.GetResponse();
        HttpStatusCode responseCode = ((HttpWebResponse)response).StatusCode;
        if (responseCode.Equals(HttpStatusCode.Unauthorized) || responseCode.Equals(HttpStatusCode.Forbidden))
        {
            Console.WriteLine("Unauthorized - need new token");
        }
        else if (!responseCode.Equals(HttpStatusCode.OK))
        {
            Console.WriteLine("Response from web service not OK :");
            Console.WriteLine(((HttpWebResponse)response).StatusDescription);
        }

        StreamReader reader = new StreamReader(response.GetResponseStream());
        string responseLine = reader.ReadLine();
        reader.Close();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:29:00.340

在 c2dm 中，您可以`data.<key>`在服务器的 POST 字段中发送您自己的数据，例如，您可以这样做：

```
postFieldNameValue.Add("data.userid", theUserId);
postFieldNameValue.Add("data.eventid", theEventId); 
```

确保您发送的字符串 (`theUserId`和`theEventId`) 是 URL 编码的。

Android 客户端可以使用以下方法获取`onMessage(Context context, Intent intent)`方法中的数据：

```
Bundle extras = intent.getExtras();
String theUserId = extras.getString("userid");
String theEventId = extras.getString("eventid"); 
```

可以在本[教程中找到更深入的解释](http://www.vogella.com/articles/AndroidCloudToDeviceMessaging/article.html)

# 3d - HLSL 中的斜角效果

> ID：10624718
> 
> 赞同：2
> 
> 时间：2012-05-16T18:45:26.373
> 
> 标签：3d, xna, directx, pixel-shader

我正在尝试在 HLSL 中制作类似 Photoshop 的斜角效果。
困难的部分是找到一个点与最近边缘的距离（其中 alpha=0）
任何人有任何想法如何做到这一点？

最好的，
西南

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T14:20:15.220

花了一段时间，但我想出了一个解决方案。正确的方法是使用多通滤波器。着色器的第一遍水平模糊图像，第二遍垂直模糊图像，第三遍通过使用前两遍生成的 Alpha 通道中的渐变来渲染斜角。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:38:10.693

您可以尝试基于抽样的方法。在像素着色器（对于每个像素）中，您需要对半径等于斜角半径的圆中的像素进行采样。如果当前像素被点亮（alpha=1），那么您可以采用到未点亮样本的最小距离（alpha=0）并计算衰减因子：`factor = min_dist / bevel_radius`. 然后你可以根据这个因素计算一些渐变颜色。

# xml - 找不到 Java 类型的 Jersey 客户端消息正文阅读器

> ID：10624721
> 
> 赞同：3
> 
> 时间：2012-05-16T18:45:35.220
> 
> 标签：xml, rest, jaxb, jersey

我正在使用 Jersey 1.1（旧的，我知道 - 因为我坚持使用 Java 1.5）。我正在做一个简单的 GET，其中一个 Java 对象作为实体返回。Java 对象正在正确编组（Java 到 XML），因为我可以通过 Web 发出 GET 请求并且效果很好。我正在尝试使用 Jersey 客户端发出 GET 请求并将其解组回 Java 对象，这就是它失败的地方。Jersey 不应该知道如何将它从 GET 请求中接收到的 XML 解组回 POJO，因为它已正确注释吗？它在服务器端工作。这是我得到的例外：

```
ClientHandlerException: A message body reader for Java type, class my.class.SearchResult, and MIME media type, application/xml was not found. 
```

这是客户端代码：

```
private SearchResult search() {
    WebResource wr = new Client().resource( "http://localhost:8080/MyProject/search" );
    return wr.get( SearchResult.class );
} 
```

这是我在客户端和服务器上使用的带有 JAXB 注释的 POJO：

```
@XmlRootElement(name = "searchResults")
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "searchResults", propOrder = {
    "results"
})
public class SearchResult {
    @XmlElement(name = "result")
    private List<Result> results = new ArrayList<Result>();

    public List<Result> getResults() {
        return results;
    }
    ...
} 
```

这也是内部 Result POJO：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "resultType", propOrder = {
    "name",
    "version",
    "type"
})
public class Result {
    private String name;
    private String version;
    private String type;
    ...
} 
```

这是 GET 服务本身：

```
@Path("/search")
public class SearchRest {
    @GET
    @Produces(MediaType.APPLICATION_XML)
    public SearchResult search() {
        SearchResult result = new SearchResult();
        ....
        return result;
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T14:54:03.630

将`@XmlRootElement`注释添加到您的`Result`班级。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T17:29:59.800

我通过在客户端将 JAXB jar 添加到我的类路径中解决了这个问题。我不知道为什么这解决了这个问题，但我猜这是因为我的 POJO 中的 @XmlRootElement 和其他 JAXB 注释在运行时被简单地忽略了，因为 jar 不存在。这导致 Jersey 没有检测到注释，因此认为它无法在客户端的 xml 和 POJO 之间进行转换。当我尝试避免需要注释的替代方法时，我发现了解决方案，您将根 POJO 包装在 JAXBElement 中。我更新了 Web 服务类以生成 JAXBElement 并更新了客户端以期望相同。然后我得到了一个 NoClassDefFoundError ，它更能说明缺少的罐子，因为我直接引用了 JAXBElement。我想我很幸运。

# python - 在 Python 中继承单独类的属性

> ID：10624725
> 
> 赞同：-1
> 
> 时间：2012-05-16T18:45:43.367
> 
> 标签：python, class, inheritance

我正在另一个类中实例化一个类：

```
class A(F):

  def __init__(self):
    return

  b = B() 
```

B 类也继承了 F 类：

```
class B(F):
      def __init__(self):
        return 
```

F 的某些属性已在 A 类中定义，我需要在 B 类中访问这些属性。（MySQL 连接和日志记录处理程序。）

我希望 B 在最初在 A 中实例化它们时具有已设置为 F 的属性，因此我可以在 B 中使用 logging/mysql 处理程序而无需重新实例化它们。

我该怎么办？抱歉，如果问题不清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:52:32.993

把你想分享的东西都放进去，`F`然后`A`就`B`可以分享了。例如

```
class F(object):
    def useful(self):
        pass

class A(F):
    def something(self):
        self.useful()

class B(F):
    def something_else(self):
        self.useful() 
```

# jquery - HTML5 JavaScript 在 Chrome 中粘贴图像数据

> ID：10624729
> 
> 赞同：4
> 
> 时间：2012-05-16T18:46:04.147
> 
> 标签：jquery, html, tinymce, coffeescript

如何使用此插件开发一个工作示例：[HTML5 JavaScript Pasting Image Data in Chrome](http://strd6.com/2011/09/html5-javascript-pasting-image-data-in-chrome/)

作者整理了一个很好的例子，看起来很适合我们的目的。但是，我不熟悉创建 jQuery 插件。

目标是使用此插件将剪贴板图像粘贴到 TinyMCE 等富文本编辑器中。

```
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>PASTE IMAGE</title>

<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.18.custom.min.js"></script>
<script type="text/javascript">

// Created by STRd6
// MIT License
// jquery.paste_image_reader.js
(function($) {
var defaults;

  $.event.fix = (function(originalFix) {
    return function(event) {
      event = originalFix.apply(this, arguments);
     if (event.type.indexOf('copy') === 0 || event.type.indexOf('paste') === 0) {
        event.clipboardData = event.originalEvent.clipboardData;
     }
  return event;
};
})($.event.fix);

defaults = {
  callback: $.noop,
  matchType: /image.*/
};

$.fn.pasteImageReader = function(options) {
if (typeof options === "function") {
options = {
    callback: options
  };
}

options = $.extend({}, defaults, options);

return this.each(function() {
  var $this, element;
  element = this;
  $this = $(this);

  $this.bind('paste', function(event) {
    var clipboardData, found;
    found = false;
    clipboardData = event.clipboardData;

    Array.prototype.forEach.call(clipboardData.types, function(type, i) {
      var file, reader;
      if (found) {
        return;
      }

      if (!type.match(options.matchType)) {
        return;
      }

      file = clipboardData.items[i].getAsFile();
      reader = new FileReader();

      reader.onload = function(evt) {
        options.callback.call(element, {
          filename: file.name,
          dataURL: evt.target.result
        });
      };
      reader.readAsDataURL(file);
      found = true;
    });
  });
});
 };
 })(jQuery);

$("html").pasteImageReader (results) -> 
    {filename, dataURL} = results

$("body").css
    backgroundImage: "url(#{dataURL})"

</script>
</head>

<body>
</body>
</html> 
```

我对插件调用感到困惑：

```
$("html").pasteImageReader (results) -> 
    {filename, dataURL} = results

$("body").css
    backgroundImage: "url(#{dataURL})" 
```

这看起来不像我见过的 jQuery。它特定于插件本身吗？任何指导将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T18:52:36.123

最后的调用是在 CoffeeScript 中，一种编译成 JavaScript 的语言。(http://coffeescript.org)

```
$("html").pasteImageReader (results) -> 
    {filename, dataURL} = results

$("body").css
    backgroundImage: "url(#{dataURL})" 
```

我不是专家——事实上我从来没有使用过咖啡脚本——但它会编译成：

```
$("html").pasteImageReader(function(results) {
  var dataURL, filename;
  return filename = results.filename, dataURL = results.dataURL, results;
});

$("body").css({
  backgroundImage: "url(" + dataURL + ")"
}); 
```

那可能会起作用，但我不喜欢它的格式。这是一些更简洁的代码。

```
$("html").pasteImageReader(function(result){
     $("body").css({backgroundImage: "url("+result.dataURL+")"});
}); 
```

试一试，看看你能不能让它为你工作！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-24T21:59:34.900

接受的答案是正确的，因为调用在 CoffeeScript 中并且只需要转换，但请注意，这些调用只是演示的一部分，它们所做的只是将页面的背景更改为从用户粘贴的任何内容剪贴板。如果要粘贴到富文本编辑器中，则需要更多类似的内容：

```
$("#yourRichTextEditor").pasteImageReader(function(results) {
  document.execCommand("insertimage", 0, results.dataURL);
}); 
```

这假设您的文本编辑器正在使用一个`contentEditable`启用的元素，例如 a `div`，其 ID 为`yourRichTextEditor`; 并且无论在哪个浏览器中运行都支持该[`contentEditable`命令](https://developer.mozilla.org/en/docs/Rich-Text_Editing_in_Mozilla) `insertimage`。我在使用上述代码调用插件的项目中使用[Bootstrap-Wysiwyg ，但如果不是所有基于 HTML5 的富文本编辑器，它应该适用于大多数。](http://mindmup.github.io/bootstrap-wysiwyg/)`pasteImageReader`

# asp.net-mvc-3 - mvc 3为所有文本框分配类

> ID：10624730
> 
> 赞同：0
> 
> 时间：2012-05-16T18:46:09.187
> 
> 标签：asp.net-mvc-3

如何为使用 textboxfor 创建的所有文本框分配类？

有没有办法使用模板覆盖？

我知道有按类型覆盖的模板，但我不想针对特定类型。我想为所有文本框添加一个圆角 css 类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:50:02.487

我看不出 MVC 需要负责对文本框进行*四舍五入的原因。*将 CSS 与`.input[type=textbox]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:50:54.750

CSS：

```
input[type="textbox"]{border-radius: 0.5em;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:51:58.547

添加 css 规则将是最好的选择，但如果您需要添加一个类，使用启动脚本和 jQuery 可能比在服务器端更容易实现：

```
$(document).ready(function(){
    $(":input[type=text]").addClass("foo");
}); 
```

# ruby-on-rails-3 - Flash 成功消息未显示

> ID：10624735
> 
> 赞同：0
> 
> 时间：2012-05-16T18:46:39.777
> 
> 标签：ruby-on-rails-3, flash, twitter-bootstrap

我在 rails 3 项目中使用 twitter 引导程序，并且无法在成功创建帖子时显示 Flash 消息。

这是代码 - 你能告诉我我做错了什么吗？

谢谢，

费萨尔

* * *

**帖子控制器**

```
def create
    @post = Post.new(params[:post])
    @post.user = current_user

    respond_to do |format|
        if verify_recaptcha && @post.save
            format.html { redirect_to '/home'}
            format.json { render :json => @post, :status => :created, :location => @post }
            flash[:notice] = "Thank you, your request has been submitted."
        else
            format.html { render :action => "new" }
            format.json { render :json => @post.errors, :status => :unprocessable_entity }
        end
end
end 
```

**APPLICATION.HTML.ERB 视图**

```
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The little chits that ended 3 years of unemployment for me.</title>
<%= csrf_meta_tags %>

<%= stylesheet_link_tag "application", :media => 'all' %>

<link href="images/favicon.ico" rel="shortcut icon">
<link href="images/apple-touch-icon.png" rel="apple-touch-icon">
<link href="images/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72">
<link href="images/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114">

</head>
<body>

<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
      <div class="container">
      <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/home">LittleChits</a>
      <div class="container nav-collapse">
        <ul class="nav">
            <li><%= link_to "Home", "/home"  %></li>
            <li><%= link_to "How it Works", "/howitworks"  %></li>
            <li><%= link_to "About Us", "/thestory"  %></li>
            <li><%= link_to "Plans & Pricing", "/posts/new"  %></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div>

<div class="container">
  <div class="content">
    <div class="row">
          <% flash.each do |name, msg| %>
            <%= content_tag :div, msg, :id => "flash_#{name}" %>
          <% end %>
          <%= yield %>
    </div><!--/row-->
  </div><!--/content-->

</div> <!-- /container -->

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<%= javascript_include_tag "application" %>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:34:48.760

确保您的视图中有这样的内容（例如views/application.html.erb）

```
 <% flash.each do |name, msg| %>
    <%= content_tag :div, msg, :id => "flash_#{name}" %>
 <% end %> 
```

# c++ - C++ 中嵌套枚举的 Swig 错误

> ID：10624736
> 
> 赞同：1
> 
> 时间：2012-05-16T18:46:43.617
> 
> 标签：c++, segmentation-fault, python-2.7, swig, nested-attributes

我有一个类似于以下的课程。它有一个嵌套的枚举 OptionTag。

```
class MediaPacket
{
    public:
           struct RtcpAppName {
           char mName[RTCP_APPNAME_LENGTH];
           };

          enum OptionTag {
                         RESERVED  = 0,
                         PROFILE   = 1,
                         LATENCY   = 2,
                         PKTLOSS   = 3,
                         JITTER    = 4,
                         LEGACYMIX = 5,
                         LASTTAG   = 255
                     };

                    ....
                    ....
          list<OptionTag> GetOptions(unsigned int ssrc) const;
}; 
```

为此，我创建了一个 swig 界面，如下所示

```
%module mediaopts_packet
%include "stdint.i"

//Redefining nested structure in swig
struct RtcpAppName {
char mName[RTCP_APPNAME_LENGTH];
};

%{
    #define SWIG_FILE_WITH_INIT
    #include "../include/mediaopts_packet.h"
%}

//nestedworkaround key for the nested struct
%nestedworkaround CRtcpAppPacket::RtcpAppName;
%{
typedef CRtcpAppPacket::RtcpAppName RtcpAppName;
%}

//Some swig definitions that are not related to this problem
//%include "carrays.i"
//%array_class(uint8_t, buffer);

//%include "typemaps.i"
//%apply (unit8_t *STRING, int LENGTH) { (uint8_t *id, uint32_t len) };
//%apply uint32_t & OUTPUT { uint32_t & xmitOpt };
//%apply uint32_t & OUTPUT { uint32_t & rcvOpt };
//%apply uint32_t & OUTPUT { uint32_t & optValue };

%include "std_list.i"

namespace std
{
    %template(ListUint32) list<uint32_t>;
    %template(ListOptionTag) list<CRtcpAppMediaoptsPacket::OptionTag>;
}

%include "../include/mediaopts_packet.h" 
```

* * *

在python中使用代码

```
Python 2.7.2+ (default, Oct  4 2011, 20:03:08)
[GCC 4.6.1] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import mediaopts_packet
>>>
>>> packet = mediaopts_packet.MediaPacket()
>>>
>>> packet.AddSSRC(0,1,1)
>>>
>>> packet.GetAllSSRC()
(0,)
>>> ssrc_list = mediaopts_packet.ListUint32()
>>>
>>> ssrc_list = packet.GetAllSSRC()
>>>
>>> ssrc_list
(0,)
>>> ssrc_list[0]
0
>>> packet.AddOption(0, mediaopts_packet.MediaPacket.RESERVED, 0)
0
>>> packet.GetOptions(0)
Segmentation fault 
```

在我在 python 中使用它时构建后，我得到一个分段错误。我无法理解我错过了什么。请帮忙。

# linux - /etc/init.d/openibd：第 147 行：意外标记 `;&' 附近的语法错误

> ID：10624737
> 
> 赞同：0
> 
> 时间：2012-05-16T18:46:49.193
> 
> 标签：linux, bash, shell, infiniband

您好我正在尝试安装一个相当长的脚本来在 Rocks 集群 6.0 上安装 infiniband 和 OFED 堆栈

这是我尝试运行的

```
 user@cluster # /etc/init.d/openibd restart
    /etc/init.d/openibd: line 147: syntax error near unexpected token `;&'
    /etc/init.d/openibd: line 147: `if ( grep -i 'SuSE Linux' /etc/issue &gt;/dev/null 2&gt;&amp;1 ); then' 
```

任何人都可以与我分享修复或确定修复此脚本中的错误的方法吗？在文件 /etc/init.d/openibd

这是脚本的一部分，其中包含指示行上的错误。

```
CONFIG="/etc/infiniband/openib.conf"

if [ ! -f $CONFIG ]; then

echo No InfiniBand configuration found

exit 0

fi

. $CONFIG

CWD=`pwd`

cd /etc/infiniband

WD=`pwd`

PATH=$PATH:/sbin:/usr/bin

if [ -e /etc/profile.d/ofed.sh ]; then

. /etc/profile.d/ofed.sh

fi

# Only use ONBOOT option if called by a runlevel directory.

# Therefore determine the base, follow a runlevel link name ...

base=${0##*/}

link=${base#*[SK][0-9][0-9]}

# ... and compare them

if [ $link == $base ] ; then

RUNMODE=manual

ONBOOT=yes

else

RUNMODE=auto

fi

ACTION=$1

shift

RESTART=0

max_ports_num_in_hca=0

# Check if OpenIB configured to start automatically

if [ "X${ONBOOT}" != "Xyes" ]; then

exit 0

fi

### ERROR ON FOLLOWING LINE ###
if ( grep -i 'SuSE Linux' /etc/issue &gt;/dev/null 2&gt;&amp;1 ); then

if [ -n "$INIT_VERSION" ] ; then

# MODE=onboot

if LANG=C egrep -L "^ONBOOT=['\"]?[Nn][Oo]['\"]?" ${CONFIG} &gt; /dev/null

; then

exit 0

fi

fi

fi 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:52:17.733

您需要修复一些 HTML 编码。

替换`&gt;`为`>`，并替换`&amp;`为`&`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:52:17.750

您的脚本以某种方式将其所有 > 替换为`&gt;`（并且 & 替换为`&amp;`等）

```
if ( grep -i 'SuSE Linux' /etc/issue &gt;/dev/null 2&gt;&amp;1 ); then

                                                       ^^ 
```

这是一个语法错误，因为在终止前面命令的分号和 & 号之间没有命令。结果，某些符号的 HTML 编码会混淆 bash 解析器。

# silverlight - Silverlight DataGrid 控件自定义列标题

> ID：10624741
> 
> 赞同：2
> 
> 时间：2012-05-16T18:46:58.233
> 
> 标签：silverlight, silverlight-4.0, datagrid

我想通过过滤、轻松添加编辑等一些需求来改进默认数据网格控制......我正在尝试自定义列标题但无法获得它。我需要在标题中添加一些其他控件并在代码端访问它们。有没有办法做到这一点？

谢谢。

```
<sdk:DataGrid
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"
xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
mc:Ignorable="d"
x:Class="DataGridTest.SLDataGrid"
d:DesignWidth="640" d:DesignHeight="480">
<sdk:DataGrid.Resources>
    <Style x:Key="SLDataGridStyle" TargetType="sdk:DataGrid">
        <Setter Property="RowBackground" Value="#AAEAEFF4"/>
        <Setter Property="AlternatingRowBackground" Value="#00FFFFFF"/>
        <Setter Property="Background" Value="#FFFFFFFF"/>
        <Setter Property="HeadersVisibility" Value="Column"/>
        <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
        <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
        <Setter Property="SelectionMode" Value="Extended"/>
        <Setter Property="CanUserReorderColumns" Value="True"/>
        <Setter Property="CanUserResizeColumns" Value="True"/>
        <Setter Property="CanUserSortColumns" Value="True"/>
        <Setter Property="AutoGenerateColumns" Value="True"/>
        <Setter Property="RowDetailsVisibilityMode" Value="VisibleWhenSelected"/>
        <Setter Property="BorderBrush">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                    <GradientStop Color="#FF718597" Offset="0.375"/>
                    <GradientStop Color="#FF617584" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="DragIndicatorStyle">
            <Setter.Value>
                <Style TargetType="ContentControl">
                    <Setter Property="Foreground" Value="#7FFFFFFF"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ContentControl">
                                <Grid>
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="SortStates">
                                            <VisualState x:Name="Unsorted"/>
                                            <VisualState x:Name="SortAscending">
                                                <Storyboard>
                                                    <DoubleAnimation Duration="0" To="1.0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SortIcon"/>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="SortDescending">
                                                <Storyboard>
                                                    <DoubleAnimation Duration="0" To="1.0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SortIcon"/>
                                                    <DoubleAnimation Duration="0" To="-.9" Storyboard.TargetProperty="(RenderTransform).ScaleY" Storyboard.TargetName="SortIcon"/>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <Rectangle x:Name="BackgroundRectangle" Grid.ColumnSpan="2" Fill="#66808080" Stretch="Fill"/>
                                    <Rectangle x:Name="BackgroundGradient" Grid.ColumnSpan="2" Opacity="0" Stretch="Fill">
                                        <Rectangle.Fill>
                                            <LinearGradientBrush EndPoint=".7,1" StartPoint=".7,0">
                                                <GradientStop Color="#FFFFFFFF" Offset="0.015"/>
                                                <GradientStop Color="#F9FFFFFF" Offset="0.375"/>
                                                <GradientStop Color="#E5FFFFFF" Offset="0.6"/>
                                                <GradientStop Color="#C6FFFFFF" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                    <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <ContentPresenter Content="{TemplateBinding Content}"/>
                                        <Path x:Name="SortIcon" Grid.Column="1" Data="F1 M -5.215,6.099L 5.215,6.099L 0,0L -5.215,6.099 Z " Fill="#7FFFFFFF" HorizontalAlignment="Left" Margin="4,0,0,0" Opacity="0" RenderTransformOrigin=".5,.5" Stretch="Uniform" VerticalAlignment="Center" Width="8">
                                            <Path.RenderTransform>
                                                <ScaleTransform ScaleY=".9" ScaleX=".9"/>
                                            </Path.RenderTransform>
                                        </Path>
                                    </Grid>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="DropLocationIndicatorStyle">
            <Setter.Value>
                <Style TargetType="ContentControl">
                    <Setter Property="Background" Value="#FF3F4346"/>
                    <Setter Property="Width" Value="2"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ContentControl">
                                <Rectangle Fill="{TemplateBinding Background}" Height="{TemplateBinding Height}" Width="{TemplateBinding Width}"/>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="GridLinesVisibility" Value="Vertical"/>
        <Setter Property="HorizontalGridLinesBrush" Value="#FFC9CACA"/>
        <Setter Property="IsTabStop" Value="True"/>
        <Setter Property="VerticalGridLinesBrush" Value="#FFC9CACA"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="sdk:DataGrid">
                    <Grid>
                        <VisualStateManager.CustomVisualStateManager>
                            <ei:ExtendedVisualStateManager/>
                        </VisualStateManager.CustomVisualStateManager>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates" ei:ExtendedVisualStateManager.UseFluidLayout="True">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="0:0:0.3"/>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="DisabledVisualElement"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ValidationStates" ei:ExtendedVisualStateManager.UseFluidLayout="True">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="0:0:0.3"/>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Invalid"/>
                                <VisualState x:Name="Valid"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="2">
                            <Grid x:Name="Root" Background="{TemplateBinding Background}">
                                <Grid.Resources>
                                    <ControlTemplate x:Key="TopLeftHeaderTemplate" TargetType="sdk:DataGridColumnHeader">
                                        <Grid x:Name="Root">
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Border BorderBrush="#FFC9CACA" BorderThickness="0,0,1,0" Background="#FF1F3B53" Grid.RowSpan="2">
                                                <Rectangle Stretch="Fill" StrokeThickness="1">
                                                    <Rectangle.Fill>
                                                        <LinearGradientBrush EndPoint=".7,1" StartPoint=".7,0">
                                                            <GradientStop Color="#FCFFFFFF" Offset="0.015"/>
                                                            <GradientStop Color="#F7FFFFFF" Offset="0.375"/>
                                                            <GradientStop Color="#E5FFFFFF" Offset="0.6"/>
                                                            <GradientStop Color="#D1FFFFFF" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Rectangle.Fill>
                                                </Rectangle>
                                            </Border>
                                            <Rectangle Fill="#FFDBDCDC" Height="1" Grid.RowSpan="2" StrokeThickness="1" VerticalAlignment="Bottom" Width="Auto"/>
                                        </Grid>
                                    </ControlTemplate>
                                    <ControlTemplate x:Key="TopRightHeaderTemplate" TargetType="sdk:DataGridColumnHeader">
                                        <Grid x:Name="RootElement">
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Border BorderBrush="#FFC9CACA" BorderThickness="1,0,0,0" Background="#FF1F3B53" Grid.RowSpan="2">
                                                <Rectangle Stretch="Fill">
                                                    <Rectangle.Fill>
                                                        <LinearGradientBrush EndPoint=".7,1" StartPoint=".7,0">
                                                            <GradientStop Color="#FCFFFFFF" Offset="0.015"/>
                                                            <GradientStop Color="#F7FFFFFF" Offset="0.375"/>
                                                            <GradientStop Color="#E5FFFFFF" Offset="0.6"/>
                                                            <GradientStop Color="#D1FFFFFF" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Rectangle.Fill>
                                                </Rectangle>
                                            </Border>
                                        </Grid>
                                    </ControlTemplate>
                                </Grid.Resources>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <sdk:DataGridColumnHeader x:Name="TopLeftCornerHeader" Template="{StaticResource TopLeftHeaderTemplate}" Width="22"/>
                                <sdk:DataGridColumnHeadersPresenter x:Name="ColumnHeadersPresenter" Grid.Column="1"/>
                                <sdk:DataGridColumnHeader x:Name="TopRightCornerHeader" Grid.Column="2" Template="{StaticResource TopRightHeaderTemplate}"/>
                                <Rectangle x:Name="ColumnHeadersAndRowsSeparator" Grid.ColumnSpan="3" Fill="#FFC9CACA" Height="1" StrokeThickness="1" VerticalAlignment="Bottom" Width="Auto"/>
                                <sdk:DataGridRowsPresenter x:Name="RowsPresenter" Grid.ColumnSpan="2" Grid.Row="1"/>
                                <Rectangle x:Name="BottomRightCorner" Grid.Column="2" Fill="#FFE9EEF4" Grid.Row="2"/>
                                <Rectangle x:Name="BottomLeftCorner" Grid.ColumnSpan="2" Fill="#FFE9EEF4" Grid.Row="2"/>
                                <ScrollBar x:Name="VerticalScrollbar" Grid.Column="2" Margin="0,-1,-1,-1" Orientation="Vertical" Grid.Row="1" Width="18"/>
                                <Grid Grid.Column="1" Grid.Row="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Rectangle x:Name="FrozenColumnScrollBarSpacer"/>
                                    <ScrollBar x:Name="HorizontalScrollbar" Grid.Column="1" Height="18" Margin="-1,0,-1,-1" Orientation="Horizontal"/>
                                </Grid>
                                <sdk:ValidationSummary x:Name="ValidationSummary" Grid.ColumnSpan="3" MaxHeight="90" Grid.Row="3"/>
                            </Grid>
                        </Border>
                        <Border x:Name="DisabledVisualElement" Background="#8CFFFFFF" CornerRadius="2" HorizontalAlignment="Stretch" Height="Auto" IsHitTestVisible="False" Opacity="0" VerticalAlignment="Stretch" Width="Auto"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="SLDataGridColumnHeaderStyle" TargetType="sdk:DataGridColumnHeader">
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="SeparatorBrush" Value="#FFC9CACA"/>
        <Setter Property="Padding" Value="4"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="sdk:DataGridColumnHeader">
                    <StackPanel x:Name="Root">
                        <VisualStateManager.CustomVisualStateManager>
                            <ei:ExtendedVisualStateManager/>
                        </VisualStateManager.CustomVisualStateManager>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates" ei:ExtendedVisualStateManager.UseFluidLayout="True">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="0:0:0.3"/>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <ColorAnimation Duration="0" To="#FF448DCA" Storyboard.TargetProperty="(Fill).Color" Storyboard.TargetName="BackgroundRectangle"/>
                                        <ColorAnimation Duration="0" To="#7FFFFFFF" Storyboard.TargetProperty="(Fill).(GradientStops)[3].Color" Storyboard.TargetName="BackgroundGradient"/>
                                        <ColorAnimation Duration="0" To="#CCFFFFFF" Storyboard.TargetProperty="(Fill).(GradientStops)[2].Color" Storyboard.TargetName="BackgroundGradient"/>
                                        <ColorAnimation Duration="0" To="#F2FFFFFF" Storyboard.TargetProperty="(Fill).(GradientStops)[1].Color" Storyboard.TargetName="BackgroundGradient"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <ColorAnimation Duration="0" To="#FF448DCA" Storyboard.TargetProperty="(Fill).Color" Storyboard.TargetName="BackgroundRectangle"/>
                                        <ColorAnimation Duration="0" To="#D8FFFFFF" Storyboard.TargetProperty="(Fill).(GradientStops)[0].Color" Storyboard.TargetName="BackgroundGradient"/>
                                        <ColorAnimation Duration="0" To="#C6FFFFFF" Storyboard.TargetProperty="(Fill).(GradientStops)[1].Color" Storyboard.TargetName="BackgroundGradient"/>
                                        <ColorAnimation Duration="0" To="#8CFFFFFF" Storyboard.TargetProperty="(Fill).(GradientStops)[2].Color" Storyboard.TargetName="BackgroundGradient"/>
                                        <ColorAnimation Duration="0" To="#3FFFFFFF" Storyboard.TargetProperty="(Fill).(GradientStops)[3].Color" Storyboard.TargetName="BackgroundGradient"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SortStates" ei:ExtendedVisualStateManager.UseFluidLayout="True">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="0:0:0.3"/>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Unsorted"/>
                                <VisualState x:Name="SortAscending">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1.0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SortIcon"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="SortDescending">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1.0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SortIcon"/>
                                        <DoubleAnimation Duration="0" To="-.9" Storyboard.TargetProperty="(RenderTransform).ScaleY" Storyboard.TargetName="SortIcon"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid Height="24" Width="147">
                            <Rectangle x:Name="BackgroundRectangle" Fill="#FF1F3B53" Stretch="Fill" Margin="0,0,-1,0"/>
                            <Rectangle x:Name="BackgroundGradient" Stretch="Fill" Margin="0,0,-1,0">
                                <Rectangle.Fill>
                                    <LinearGradientBrush EndPoint=".7,1" StartPoint=".7,0">
                                        <GradientStop Color="#FCFFFFFF" Offset="0.015"/>
                                        <GradientStop Color="#F7FFFFFF" Offset="0.375"/>
                                        <GradientStop Color="#E5FFFFFF" Offset="0.6"/>
                                        <GradientStop Color="#D1FFFFFF" Offset="1"/>
                                    </LinearGradientBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                            <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="4,4,0,4" VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter Content="{TemplateBinding Content}"/>
                                <Path x:Name="SortIcon" Grid.Column="1" Data="F1 M -5.215,6.099L 5.215,6.099L 0,0L -5.215,6.099 Z " Fill="#FF444444" HorizontalAlignment="Left" Margin="4,0,0,0" Opacity="0" RenderTransformOrigin=".5,.5" Stretch="Uniform" VerticalAlignment="Center" Width="8">
                                    <Path.RenderTransform>
                                        <ScaleTransform ScaleY=".9" ScaleX=".9"/>
                                    </Path.RenderTransform>
                                </Path>
                            </Grid>
                            <Rectangle x:Name="VerticalSeparator" Fill="{TemplateBinding SeparatorBrush}" Visibility="{TemplateBinding SeparatorVisibility}" VerticalAlignment="Stretch" Width="1" HorizontalAlignment="Right" Margin="0,0,-1,0" d:LayoutOverrides="Width"/>
                        </Grid>
                        <Grid Height="24" Background="#FFE4E4E4">
                            <TextBox TextWrapping="Wrap" Text="TextBox" d:LayoutOverrides="Width"/>
                        </Grid>
                    </StackPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</sdk:DataGrid.Resources>
<sdk:DataGrid.Style>
    <StaticResource ResourceKey="SLDataGridStyle"/>
</sdk:DataGrid.Style>
<sdk:DataGrid.ColumnHeaderStyle>
    <StaticResource ResourceKey="SLDataGridColumnHeaderStyle"/>
</sdk:DataGrid.ColumnHeaderStyle> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T17:52:12.873

可以将自定义控件添加到 Silverlight DataGrid 的标题中，但是如何做到这一点并不明显，而且有点麻烦。

您需要做两件事：

1.  `ContentTemplate`通过将 a应用于列标题的 来指定要添加到列标题的控件`HeaderStyle`。为此，您需要以下两个 XAML 命名空间声明：

    ```
    xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"
    xmlns:dataprimitives="clr-namespace:System.Windows.Controls.Primitives;assembly=System.Windows.Controls.Data" 
    ```

    ```
    <sdk:DataGridTemplateColumn Binding="...">
        <sdk:DataGridTemplateColumn.HeaderStyle>
            <Style TargetType="dataprimitives:DataGridColumnHeader">
                <Setter Property="ContentTemplate">
                    <Setter.Value>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <CheckBox IsChecked="{Binding Path=SomeFlag, Mode=TwoWay}" />
                                <TextBlock Text="Header text" />
                            </StackPanel>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </sdk:DataGridTemplateColumn.HeaderStyle>
        <!-- other DataGridTemplateColumn stuff -->
    <sdk:DataGridTemplateColumn> 
    ```

    在此示例中，我使用了一个`CheckBox`带有`IsChecked`绑定到视图模型属性的属性`SomeFlag`的 a，以及一个`TextBlock`. 我`DataGridTemplateColumn`在这个例子中使用了 a ，但这种方法也应该适用于`DataGridTextColumn`并`DataGridCheckBoxColumn`提供你替换`sdk:DataGridTemplateColumn.HeaderStyle`为`sdk:DataGridTextColumn.HeaderStyle`和 类似的 for `DataGridCheckBoxColumn`。

2.  如果您只想将静态内容添加到列标题，则无需执行任何其他操作。但是，如果您希望使用数据绑定，则需要进一步的步骤，否则标题中控件的数据上下文将无法正确设置。这需要一些代码隐藏。

    以下方法在可视树中搜索`ContentPresenter`s 中`DataGridColumnHeader`的 s 并设置`DataContext`这些 s 的`ContentPresenter`s：

    ```
    using System.Windows;
    using System.Windows.Controls;
    using System.Windows.Controls.Primitives;
    using System.Windows.Media;

    /// <summary>
    /// Sets the DataContext of each column header within the given data-grid.
    /// </summary>
    /// <param name="dataGrid">The DataGrid.</param>
    /// <param name="dataContext">The data-context to set.</param>
    public static void SetHeaderDataContexts(DataGrid dataGrid, object dataContext)
    {
        // First we look for a DataGridColumnHeadersPresenter.
        DataGridColumnHeadersPresenter colsPresenter = GetObjectOfType<DataGridColumnHeadersPresenter>(dataGrid);
        if (colsPresenter == null)
        {
            return;
        }

        // The ColumnHeadersPresenter contains all of the column headers as
        // direct children.  Within each column header is a ContentPresenter,
        // whose DataContext will normally be null.  For each ContentPresenter
        // found, set its DataContext to be that given.
        int colHeaderCount = VisualTreeHelper.GetChildrenCount(colsPresenter);
        for (int i = 0; i < colHeaderCount; ++i)
        {
            var header = VisualTreeHelper.GetChild(colsPresenter, i) as DataGridColumnHeader;
            if (header != null)
            {
                ContentPresenter contentPresenter = GetObjectOfType<ContentPresenter>(header);
                if (contentPresenter != null)
                {
                    contentPresenter.DataContext = dataContext;
                }
            }
        }
    }

    /// <summary>
    /// Returns the first descendant object of the given parent object within
    /// the visual tree that is an instance of the specified type.
    /// </summary>
    /// <remarks>
    /// The visual tree is searched in a depth-first manner, and the first
    /// object of type <c>TObject</c> found within the tree is returned.  If no
    /// control of this type is found, <c>null</c> is returned instead.
    /// </remarks>
    /// <typeparam name="TObject">The type of object to search for.  This must
    /// be a subclass of <see cref="DependencyObject"/>.</typeparam>
    /// <param name="parent">The parent control to search within.</param>
    /// <returns>
    /// The first control of the specified type found, or <c>null</c> if none
    /// were found.
    /// </returns>
    public static TObject GetObjectOfType<TObject>(DependencyObject parent) where TObject : DependencyObject
    {
        int count = VisualTreeHelper.GetChildrenCount(parent);
        for (int i = 0; i < count; ++i)
        {
            DependencyObject child = VisualTreeHelper.GetChild(parent, i);
            if (child is TObject)
            {
                return child as TObject;
            }
            else
            {
                TObject obj = GetObjectOfType<TObject>(child);
                if (obj != null)
                {
                    return obj;
                }
            }
        }

        return null;
    } 
    ```

    唯一需要做的就是调用`SetHeaderDataContexts`. 我发现从用户控件构造函数调用它不起作用，从`Loaded`事件调用它也不起作用（在这两种情况下它都没有效果）。从网格事件中调用它`LayoutUpdated`确实不起作用，因为这会导致抛出异常。

    但是，通过使用在构造函数中调用它

    ```
     Dispatcher.BeginInvoke(() => SetHeaderDataContexts(theDataGrid, this.DataContext)); 
    ```

    似乎确实有效。

致谢：设置的想法`ContentTemplate`来自 Lars Holm Jensen[对类似问题的回答](https://stackoverflow.com/questions/151682/dynamically-setting-the-header-text-of-a-silverlight-datagrid-column/3627372#3627372)，搜索可视化树的想法[来自 Manas Patnaik 的博客文章](http://manaspatnaik.com/blog/index.php/technology/silverlight-4/accessing-controls-in-datagrid-columnheader-silverlight/877)。这两个链接都是通过[一个类似的问题](https://stackoverflow.com/questions/11145092/how-can-i-assign-a-custom-usercontrol-to-a-datagrid-column-header)找到的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-28T22:07:45.927

卢克的回答非常好。

但是，我发现当我将*ComboBox*放入标题模板时，在选择 Combo 中的项目或调整列大小时，绑定（在 Luke 答案的第（2）部分的代码隐藏中设置）消失了。这是因为在调整列大小时会重新创建列标题，因此绑定会丢失。

我通过像这样设置绑定来修复它 -

XAML -

```
 <DataTemplate>
            <StackPanel Orientation="Horizontal" Loaded="HeaderTemplate_OnLoaded" >
                <CheckBox IsChecked="{Binding Path=SomeFlag, Mode=TwoWay}" />
                <TextBlock Text="Header text" />
            </StackPanel>
       </DataTemplate> 
```

代码隐藏 -

> ```
>  private void HeaderTemplate_OnLoaded(object sender, RoutedEventArgs e)
>     {
>         ((FrameworkElement)sender).DataContext = this.DataContext;
>     } 
> ```

这对我来说每次都没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T06:32:38.907

确实可以更改列标题的样式。我试图使标题文本居中，并且此链接的技术对我有用：[Silverlight DataGrid Header Horizo​​ntal Alignment](https://stackoverflow.com/questions/2426954/silverlight-datagrid-header-horizontal-alignment)

# assembly - 在索尼爱立信 ARC S 上对 ARM 处理器进行汇编编程

> ID：10624749
> 
> 赞同：0
> 
> 时间：2012-05-16T18:47:38.907
> 
> 标签：assembly, arm

我有一个索尼爱立信 ARC S。我想用 ARM 汇编语言为它编写一个程序。我熟悉 MIPS 架构和一点 X86。

帮助我开始编写一个简单的程序，并向我展示我需要哪些程序、模拟器或其他东西来执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T21:29:04.607

那里有许多基于 gnu 的交叉编译器，构建自己的非常容易，特别是如果你只想要汇编语言，你只需要构建 binutils。

```
wget ftp://ftp.gnu.org/gnu/binutils/binutils-2.22.tar.gz
tar xzvf binutils-2.22.tar.gz 
cd binutils-2.22
../configure --target=arm-none-eabi --prefix=/pick/a/path --disable-werror --disable-nls
make
sudo make install 
```

你需要选择一个你想安装的地方我自己喜欢/gnuarm。可以尝试 /opt/gnuarm 或任何你喜欢的。

如果您不想尝试，请访问 codesourcery.com，它将带您指导购买了 code sourcery 的图形。寻找ARM的LITE版本，gnueabi版本很好，linux版本也很好，你只需要汇编器和链接器或编译器，汇编器和链接器。

emdebian以前有一个工具链，好久没试过了。如果在 Windows 上，人们仍然使用 ygarto 和 winarm。

如果 mips 是您知道的唯一 asm，那么 arm 在某些方面会更简单。Mips 有点不标准，大多数处理器使用带有进位标志、负标志、零标志、有符号溢出标志 (CNZV) 的程序状态字，您可以使用普通指令、加法、减法等设置这些标志，然后分支他们。使用 mips，您没有状态标志，而是指定说两个寄存器并说如果相等则分支，如果相等则执行减法分支。其他处理器的减法要么通过减法完成，要么通过进行减法但不保存除标志以外的结果的比较来完成。ARM 的加载和存储有不同的语法，而不是 sw $4,0x10($5) 你会有 str r4,[r5,#0x10] 括号表示间接级别，# 前面是一个常量。Arms 立即数通常是 8 或 9 位，而在 mips 上立即数是 16 位。使用 arm，您可以在一条指令中存储多个寄存器 stm r0,{r1,r2,r3,r4} 将 r1 存储在 r0 的地址，r2 存储在 r0+0x04 的地址，r3 存储在 r0+0x08 的地址，依此类推在。这通常用于将事物“推入”和“弹出”堆栈。使用 arm 您可以修改存储或加载上的基址寄存器，例如 ldr r1,[r0],#4 括号外的立即数意味着将 r1 存储在 r0 中的地址然后将 4 添加到 r0 使您不必拥有一个附加添加 r0,r0,#4 指令。Mips 不是唯一具有分支延迟槽的处理器，但出于实际目的假设它是，假设没有其他处理器具有延迟槽，因此不要试图将指令放在分支之后并期望它们执行，

gdb 有从 arm 开源的 armulator 模拟器，我不知道如何访问它。qemu 有很多手臂支撑，但能见度很低。我有 thumbulator，它只是拇指（arm 指令集的简化版本，与 32 位 mips 指令集相比，非常类似于 16 位 mips 指令集），但会给你改变 arm 的感觉，模拟器易于阅读，您可以随意修改以了解正在发生的事情，观察内存总线、寄存器等。skyeye 有许多处理器模拟器、vba 和 nintendo ds 模拟器包含 arm 处理器模拟器。加上无数低于 50 美元和一些低于 20 美元的微控制器板，其中包含 arm 处理器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:13:20.223

一个人会使用与其他处理器相同的工具，即 Eclipse、GNU、Visual Studio、Clang 等。只有一个人必须进行第二次安装和下载**ARM**而不是**x86**。

除非你有一个 Arm 工作站，否则你将在你的 x86 机器上工作并交叉编译/组装到**ARM**因此需要一些方法将编译后的代码放到**ARM**机器上。调试通常通过串行到您的工作站远程完成，因此可以使用符号表。

# java - Android 上的 SimpleDateFormat 时区错误

> ID：10624752
> 
> 赞同：9
> 
> 时间：2012-05-16T18:47:44.747
> 
> 标签：java, android

我一直在尝试隔离我的应用程序中的错误。我成功地产生了以下“谜语”：

```
SimpleDateFormat f1 = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ");
SimpleDateFormat f2 = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ");
Date d = f1.parse("2012-01-01T00:00:00+0700");
String s1 = f1.format(d); // 2011-12-31T18:00:00+0700
String s2 = f2.format(d); // 2011-12-31T18:00:00+0100 
```

**当我在 Android API 7 上**运行此代码时，我得到了注释中的值（是的，真的）。此行为取决于特定的 Java 实现。

我的问题是：

*   为什么 s1 不等于 s2？
*   更重要的是，**为什么 s1 不正确？**虽然`s2`指向一个适当的时间点，`s1`但没有。Android 的 SimpleDateFormat 实现中似乎存在错误。

**问题 1 的答案：**参见 BalusC 的答案：

*   *[使用后`SimpleDateFormat#parse`] 之前通过调用 setTimeZone 设置的任何 TimeZone 值可能需要恢复以进行进一步操作。*

**问题 2**的答案：请参阅 wrygiel（我自己）的答案。

*   *这是由于 Android 2.1 (API 7) 中的一个错误造成的。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T18:56:37.827

这在 javadoc 中提到[`DateFormat#parse()`](http://docs.oracle.com/javase/7/docs/api/java/text/DateFormat.html#parse%28java.lang.String,%20java.text.ParsePosition%29)：

> 根据给定的解析位置解析日期/时间字符串。例如，一个时间文本`"07/10/96 4:5 PM, PDT"`将被解析为一个日期，它等同于`Date(837039900000L)`.
> 
> 默认情况下，解析是宽松的：如果输入不是该对象的格式方法使用的格式，但仍然可以解析为日期，则解析成功。客户可致电[`setLenient(false)`](http://docs.oracle.com/javase/7/docs/api/java/text/DateFormat.html#setLenient%28boolean%29).
> 
> 此解析操作使用[`calendar`](http://docs.oracle.com/javase/7/docs/api/java/text/DateFormat.html#calendar)来生成`Date`. 因此，`calendar's`日期时间字段和`TimeZone`值可能已被覆盖，具体取决于子类实现。`TimeZone`之前通过调用设置的任何值都[`setTimeZone`](http://docs.oracle.com/javase/7/docs/api/java/text/DateFormat.html#setTimeZone%28java.util.TimeZone%29)可能需要恢复以进行进一步操作。

注意最后一段。不幸的是，它没有解释*何时*会发生这种情况。要解决您的特定问题，您需要在格式化操作之前明确设置所需的时区。

至于其自身的可变性`SimpleDateFormat`，这是众所周知的多年。您永远不应将其实例创建并分配为静态或类变量，而应始终作为方法（线程本地）变量。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-16T20:09:27.843

这是由于Android 2.1 (API 7) 中[的一个错误造成的。](http://code.google.com/p/android/issues/detail?id=8258)似乎 Android 程序员在他们的 Android 2.1 实现中遗漏了[一些未记录的 Java 行为](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4827490)（其本身被归类为不可修复的错误！）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:54:14.630

你的问题引起了我的兴趣，所以我继续编译你的代码。结果？正如所料...

```
2011-12-31T18:00:00+0100
2011-12-31T18:00:00+0100 
```

这两个值是相同的，你是在使用一些并发吗？也许变量在`f2.format(d)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T19:05:51.033

我试图通过运行相同的程序来比较 s1 和 s2。他们和我一样。 ![在此处输入图像描述](../Images/fee3820f61768069fb0ccb5e1fc0920c.png)

# css - Flash 对象定位问题

> ID：10624754
> 
> 赞同：0
> 
> 时间：2012-05-16T18:47:51.450
> 
> 标签：css, flash

开发新手。同一个 Flash 对象的两个与位置相关的问题：

1) 经过实验/研究后，我能够使用 CSS 定位我的 Flash 元素。但是，我还没有找到一种方法来让它在调整浏览器窗口大小时正确地重新定位，就像其他页面元素一样。它会垂直滑动，但保持水平固定。

2) 该位置现在在 Firefox、Safari 和 Chrome 中是正确的。但是 IE 应用了过多的左对齐并改变了对象大小。

任何帮助将不胜感激。

地址：www.mconchicago.com

代码：

```
<head>
<style type="text/css">
    #container {
    position:absolute;
    width:200px;
    height:200px;
    top:110px;
    left:177px;
    margin: 0 auto;
 }
</style>
</head>

<body>
<div id="container">

<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" 

codebase="http://download.macromedia.com/pub/shockwave/
cabs/flash/swflash.cab#version=6,0,40,0" 

width="100%" height="100%"

style="margin: 0px 0 0px 0px"

width="590" height="300" 
id="mymoviename"> 

<param name="movie"  

value="banner_creator.swf" /> 

<param name="quality" value="high" /> 

<param name=”wmode” value=”transparent” />

<param name="bgcolor" value="#ffffff" /> 

<embed src="banner_creator.swf" quality="high" bgcolor="#ffffff"

width="590" height="180" 

name="mymoviename" align="" type="application/x-shockwave-flash" 

pluginspage="http://www.macromedia.com/go/getflashplayer"> 

</embed> 

</object>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:07:00.917

我必须承认，你的代码很乱。

我相信有可能修复它:-)

首先将整个移动`div id='container'`到“wrapsky”（之前`<div class="imagesky">`）

然后应用样式：

```
.wrapsky {
    height: 180px;
    overflow: hidden;
    position: relative;
    top: 20px;
    width: 998px;
} 
```

和

```
#container {
    float: left;
    height: 200px;  
    width: 590px;
} 
```

这并不理想，但现在应该这样做:-)

# parallel-processing - OpenMP 程序比顺序程序慢

> ID：10624755
> 
> 赞同：8
> 
> 时间：2012-05-16T18:47:56.873
> 
> 标签：parallel-processing, openmp

当我尝试以下代码时

```
double start = omp_get_wtime();

long i;

#pragma omp parallel for
    for (i = 0; i <= 1000000000; i++) {
        double x = rand();
    }

    double end = omp_get_wtime();

    printf("%f\n", end - start); 
```

执行时间约为 168 秒，而顺序版本仅花费 20 秒。

我仍然是并行编程的新手。我怎样才能获得比顺序版本更快的并行版本？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-16T19:09:11.273

随机数生成器`rand(3)`使用全局状态变量（隐藏在 (g)libc 实现中）。从多个线程访问它们会导致缓存问题，并且也不是线程安全的。您应该使用对线程私有的参数`rand_r(3)`调用：`seed`

```
long i;
unsigned seed;

#pragma omp parallel private(seed)
{
    // Initialise the random number generator with different seed in each thread
    // The following constants are chosen arbitrarily... use something more sensible
    seed = 25234 + 17*omp_get_thread_num();
    #pragma omp for
    for (i = 0; i <= 1000000000; i++) {
       double x = rand_r(&seed);
    }
} 
```

请注意，并行执行时与串行执行时会产生不同的随机数流。我还建议将`erand48(3)`其作为更好的（伪）随机数源。

# onchange - 在下拉选择更改上确认消息

> ID：10624757
> 
> 赞同：0
> 
> 时间：2012-05-16T18:48:11.297
> 
> 标签：onchange, confirm

在下拉列表中选择值 Hiring 时，我需要显示一条确认消息。我怎样才能做到这一点？

```
if (Status.SelectedValue == "HIRING")
    {
       Status.Attributes.Add("onChange", "javascript:return DisplayConfirmation();");
    } 
```

我在 aspx 页面中有 DisplayConfirmation 功能。这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:04:37.310

更改 DisplayConfirmation() javascript 函数以包含所选值的参数，并处理函数内部的逻辑。

在后面的代码中，将您的代码替换为：

```
Status.Attributes.Add("OnChange", string.Format("DisplayConfirmation('{0}');", Status.SelectedValue)); 
```

因此，您可以将您的 javascript 更改为

```
function DisplayConfirmation(Status) { 
 if(Status == "HIRING")
{
 if (confirm('Are you sure you want to do this?')) { __doPostback('Status', ''); } 
  }} 
```

# lda - 潜在狄利克雷分配解决方案示例

> ID：10624760
> 
> 赞同：6
> 
> 时间：2012-05-16T18:48:30.853
> 
> 标签：lda, topic-modeling

我正在尝试了解潜在狄利克雷分配（LDA）。我有机器学习和概率论的基本知识，并且基于这篇博客文章[http://goo.gl/ccPvE](http://goo.gl/ccPvE)，我能够开发 LDA 背后的直觉。但是，我仍然没有完全理解其中的各种计算。我想知道有人可以向我展示使用非常小的语料库的计算（比如说 3-5 个句子和 2-3 个主题）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T04:03:25.680

Edwin Chen（他在 Twitter 工作）在他的博客中有[一个例子。](http://blog.echen.me/2011/08/22/introduction-to-latent-dirichlet-allocation/)5 句话，2 个主题：

*   我喜欢吃西兰花和香蕉。
*   我早餐吃了香蕉和菠菜冰沙。
*   龙猫和小猫很可爱。
*   我姐姐昨天收养了一只小猫。
*   看看这只可爱的仓鼠正在咀嚼一块西兰花。

然后他做了一些“计算”

*   句子 1 和 2：100% 主题 A
*   第 3 句和第 4 句：100% 主题 B
*   句子 5：60% 主题 A，40% 主题 B

并猜测主题：

*   主题 A：30% 的西兰花、15% 的香蕉、10% 的早餐、10% 的咀嚼……
    *   此时，您可以将主题 A 解释为与**食物有关**
*   话题 B：20% 的栗鼠，20% 的小猫，20% 的可爱，15% 的仓鼠，……
    *   此时，您可以将主题 B 解释为关于**可爱的动物**

* * *

你的问题是他是怎么得出这些数字的？这些句子中的哪些词带有“信息”：

*   西兰花, 香蕉, 冰沙, 早餐, 咀嚼, 吃
*   栗鼠, 小猫, 可爱, 采用, 仓鼠

现在让我们逐句从每个主题中获取单词：

*   食物 3，可爱 0 -->**食物**
*   食物 5，可爱 0 -->**食物**
*   食物 0，可爱 3 -->**可爱**
*   食物 0，可爱 2 -->**可爱**
*   食物 2，可爱 2 --> 50%**食物**+ 50%**可爱**

所以我的数字，与陈的略有不同。也许他在“一块西兰花”中加入了“一块”这个词来计入食物。

* * *

我们在脑海中做了两个计算：

*   查看句子并首先提出2个主题。LDA 通过将每个句子视为主题的“混合”并猜测每个主题的参数来做到这一点。
*   来决定哪些词是重要的。LDA 使用“词频/逆文档频率”来理解这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-10T15:48:53.767

LDA 程序

Step1：遍历每个文档，将文档中的每个单词随机分配给K个主题之一（K是预先选择的）

Step2：这个随机分配给出了所有文档的主题表示和所有主题的单词分布，尽管不是很好

因此，为了改进它们：对于每个文档 d，遍历每个单词 w 并计算：

*   p(主题 t | 文档 d)：文档 d 中分配给主题 t 的单词的比例

*   p(word w| topic t)：在所有文档 d 中，来自 word w 的分配给主题 t 的比例

Step3: 重新分配单词 wa 新主题 t'，我们选择主题 t' 的概率

*   p(主题 t' | 文档 d) * p(单词 w | 主题 t')

该生成模型预测主题 t' 生成单词 w 的概率。我们将为语料库中的每个文档多次迭代最后一步以获得稳定状态。

**求解计算**

假设您有两个文件。

Doc i：“**银行打电话询问这笔钱。**”</p>

Doc ii：“**银行说这笔钱已获批准。**”</p>

*删除停用词、大写和标点符号后。*

语料库中唯一词： **bank call about money boat 已批准** [![在此处输入图像描述](../Images/f23c198862f99c7fa6cb85200799c78b.png)](https://i.stack.imgur.com/EaBt1.png) Next then,

[![在此处输入图像描述](../Images/0800763f771e4eea51e1182ea567f162.png)](https://i.stack.imgur.com/PkrM4.png)之后，我们将从 doc i（主题分配为**1的****词库**） 中随机选择一个词，我们将删除其分配的主题，并计算其新分配的概率。

 **[![](../Images/fca2b964a05912248103d9aa8d9599de.png)](https://i.stack.imgur.com/mFb6W.png)

[![在此处输入图像描述](../Images/bbc17c823163f5889b7af312ffc7a9e3.png)](https://i.stack.imgur.com/n9vKj.png)

对于主题**k=1** [![在此处输入图像描述](../Images/28e570283ef19b2ede7400ac82eace95.png)](https://i.stack.imgur.com/y1K9i.png)

对于主题**k=2** [![在此处输入图像描述](../Images/64c718d227b9e43a3ae5bf2f80ff4f78.png)](https://i.stack.imgur.com/be4Lf.png)

现在我们将计算这两个概率的乘积，如下所示： [![在此处输入图像描述](../Images/bb02d7a584a061d6de34ec7f4e0a7b7e.png)](https://i.stack.imgur.com/Ee2rB.png)

主题 2（面积**大于**）比主题 1 更适合**文档**和**单词。因此，我们对****词库**的新分配将是主题 2。

 ****现在，由于新的分配，我们将更新计数。 [![在此处输入图像描述](../Images/16f38cc1fae3e23c61325da3ba2298f6.png)](https://i.stack.imgur.com/z2val.png)

现在我们将重复相同的重新分配步骤。并遍历整个语料库的每个单词。 [![在此处输入图像描述](../Images/124d3e120407fcb399e2f73589518e78.png)](https://i.stack.imgur.com/vWfza.png)******

# c# - 将会话数据存储到表中

> ID：10624761
> 
> 赞同：0
> 
> 时间：2012-05-16T18:48:38.970
> 
> 标签：c#, asp.net, sql, database-connection, session-state

我可以通过单击按钮将会话值存储在表中吗？在我下面的代码中，我想要`UserName`in 表..

这是我正在使用的代码：

```
string cmdstr = "select count(*) from Reg where UserName='" + TextBoxaun.Text + "'";
SqlCommand checkUser = new SqlCommand(cmdstr, con);

int temp = Convert.ToInt32(checkUser.ExecuteScalar().ToString());
if (temp == 1)
{
    string cmdstr2 = "select Password from Reg where UserName='" +   TextBoxaun.Text + "'";

    SqlCommand pass = new SqlCommand(cmdstr2, con);
    string password = pass.ExecuteScalar().ToString();
    con.Close();

    if  (password == TextBoxapass.Text)
        Session["newapply"] = TextBoxaun.Text;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T19:08:03.110

首先，你需要[ASP.NET SQL Server 注册工具](http://msdn.microsoft.com/en-us/library/ms229862%28v=vs.100%29.aspx)

创建 ASPState 数据库后，您必须在 web.config 中更改会话状态模式，如下所示：

```
<sessionState mode="SQLServer" 
              sqlConnectionString="[Database connection string]"/> 
```

PS 当您使用 SQLServer 或 StateServer 模式时，对象必须是可序列化的。有关更多详细信息，请参阅[会话状态模式](http://msdn.microsoft.com/en-us/library/ms178586.aspx)

# javascript - 正则表达式从 JavaScript 中的 url 哈希中提取参数

> ID：10624762
> 
> 赞同：2
> 
> 时间：2012-05-16T18:48:51.340
> 
> 标签：javascript, regex, hash

我的网址将如下所示：

```
http://example.com/whatever#page?x=1&locale=hu&y=2
http://example.com/whatever#page?x=1&locale=hu
http://example.com/whatever#page?locale=hu
http://example.com/whatever#page?locale=
http://example.com/whatever#page?x=1
http://example.com/whatever#page
http://example.com/whatever 
```

如果未设置，我想获取语言环境参数或空字符串。

我正在尝试类似的东西：

```
locale = location.hash.replace(/.*(?:[?&]locale=([^&]*))?.*/, "$2"); 
```

但我的问题是我找不到适用于所有情况的正确正则表达式（当哈希中有 locale= 和没有时）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-16T19:07:00.553

这是一段代码，它将从哈希中提取它并在 URL 中的其他任何地方避免它：

```
function getLocaleFromHash(url) {
    var match = url.match(/#.*[?&]locale=([^&]+)(&|$)/);
    return(match ? match[1] : "");
} 
```

而且，您可以在这里看到它适用于所有测试用例：http: [//jsfiddle.net/jfriend00/p37Mx/](http://jsfiddle.net/jfriend00/p37Mx/)

* * *

如果您希望能够在哈希中查找任何参数，您可以使用：

```
function getParmFromHash(url, parm) {
    var re = new RegExp("#.*[?&]" + parm + "=([^&]+)(&|$)");
    var match = url.match(re);
    return(match ? match[1] : "");
} 
```

在这里看到它的工作：http: [//jsfiddle.net/jfriend00/6kgUk/](http://jsfiddle.net/jfriend00/6kgUk/)

* * *

一个更通用的函数将获取 URL 中的所有参数，如下所示。对于哈希在查询之后并且参数在查询字符串中的普通 URL，它看起来像这样。这是更多的代码，因为它做的更多。它将所有参数提取到一个对象中，您可以在其中通过它的键查找任何参数，并且它的 URL 也将它们全部解码：

```
function getParmsFromURL(url) {
    var parms = {}, pieces, parts, i;
    var hash = url.lastIndexOf("#");
    if (hash !== -1) {
        // remove hash value
        url = url.slice(0, hash);
    }
    var question = url.lastIndexOf("?");
    if (question !== -1) {
        url = url.slice(question + 1);
        pieces = url.split("&");
        for (i = 0; i < pieces.length; i++) {
            parts = pieces[i].split("=");
            if (parts.length < 2) {
                parts.push("");
            }
            parms[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);
        }
    }
    return parms;
} 
```

对于处理哈希值中和之后的参数的特殊版本？在像 OP 的问题（这不是典型情况）中的哈希值中，可以使用这个：

```
function getParmsFromURLHash(url) {
    var parms = {}, pieces, parts, i;
    var hash = url.lastIndexOf("#");
    if (hash !== -1) {
        // isolate just the hash value
        url = url.slice(hash + 1);
    }
    var question = url.indexOf("?");
    if (question !== -1) {
        url = url.slice(question + 1);
        pieces = url.split("&");
        for (i = 0; i < pieces.length; i++) {
            parts = pieces[i].split("=");
            if (parts.length < 2) {
                parts.push("");
            }
            parms[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);
        }
    }
    return parms;
} 
```

工作演示：http: [//jsfiddle.net/jfriend00/v8cd5/](http://jsfiddle.net/jfriend00/v8cd5/)

而且，如果你想要本地选项，你只需这样做：

```
var parms = getParmsFromURL(url);
var locale = parms["locale"]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T19:02:08.527

```
locale = location.hash.match( /[?&]locale=([^&]*)?/ );
locale = ( locale == null ? "" : locale[1] || "" ); 
```

会成功的。我认为`.*`不需要，因为您没有指定字符串的开头或结尾。我在你所有的例子上测试了这个正则表达式，它们都正常工作:)

**编辑：**对不起，在某些情况下它是无效的。现在在所有情况下都是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T19:41:39.633

如果你真的想在一个正则表达式中做到这一点：

```
locale = location.hash.match(/([?&]locale=|^((?![?&]locale=).)+$)([^&]*)/)[3]; 
```

它适用于您的所有示例，尽管我认为它的效率非常低。

# c++ - C++11 右值调用析构函数两次

> ID：10624764
> 
> 赞同：3
> 
> 时间：2012-05-16T18:48:59.523
> 
> 标签：c++, multithreading, c++11

我正在尝试制作一个类运行器（以固定的时间频率运行一个类），它在另一个线程中运行一个类，并且可以从主线程控制（如暂停、恢复、停止）。

所以我想利用 C++11 的 Functor 和其他特性。但是我有一个奇怪的问题，传递给 Runner 的 Functor 的析构函数被调用了两次。

```
#include <iostream>
#include <chrono>
#include <thread>

using namespace std;

class Runner {
 public:
  typedef function<bool()> fn_t;
  Runner(fn_t &&fn) : fn_(move(fn)), thread_(Thread, ref(*this)) {
    cout << "Runner" << endl;
  }
  ~Runner() {
    cout << "~Runner" << endl;
    thread_.join();
  }
 private:
  fn_t fn_;
  thread thread_;
  static void Thread(Runner &runner) {
    while (runner.fn_()) {
      cout << "Running" << endl;
      this_thread::sleep_for(chrono::milliumseconds(1));
    }
  }
};

class Fn {
 public:
  Fn() : count(0) {
    cout << "Fn" << endl;
  }
  ~Fn() {
    cout << "~Fn" << endl;
  }
  bool operator()() {
    return (++count < 5);
  }
 private:
  int count;
};

int main (int argc, char const* argv[])
{
  Fn fn;
  Runner runner(move(fn));
  return 0;
} 
```

输出：

```
Fn
Runner
~Fn
~Runner
Running
Running
Running
Running
Running
~Fn
~Fn 
```

如果我改变

```
Fn fn;
Runner runner(move(fn)); 
```

到

```
Runner runner(Fn()); 
```

该程序什么都没有，并且停滞不前。我试图禁用编译优化，没有任何变化。有什么解释吗？

我该如何解决这个问题或用其他方法做同样的事情？我应该像 std::async / std::thread 那样实现这个类吗？

**更新到** `Runner runner(Fn())`

该语句作为函数声明被中断。

`Runner runner((Fn()))`解决了问题。

感谢所有评论和回答。在查看[rvalue](http://thbecker.net/articles/rvalue_references/)之后，似乎我误解了从地面 0 引用 rvalue 的含义。我会尝试其他一些方法。

**此问题的最终解决方案**

```
#include <iostream>
#include <chrono>
#include <thread>
#include <vector>

using namespace std;

template<typename T, typename... Args>
class Runner {
 public:
  Runner(Args&&... args) : 
      t(forward<Args>(args)...), 
      thread_(Thread, ref(*this)) {
    cout << "Runner" << endl;
  }
  ~Runner() {
    cout << "~Runner" << endl;
    thread_.join();
  }
 private:
  T t;
  thread thread_;
  static void Thread(Runner &runner) {
    while (runner.t()) {
      cout << "Running" << endl;
      this_thread::sleep_for(chrono::milliseconds(100));
    }
  }
};

class Fn {
 public:
  Fn() : count(0) {
    cout << "Fn" << endl;
  }
  ~Fn() {
    cout << "~Fn" << endl;
  }
  bool operator()() {
    return (count++ < 5);
  }
 private:
  int count;
};

int main (int argc, char const* argv[])
{
  //vector<Fn> fns;
  //fns.emplace_back(Fn());
  Runner<Fn> runner;
  return 0;
} 
```

输出：

```
Fn
Runner
~Runner
Running
Running
Running
Running
Running
~Fn 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T19:12:54.967

使用`std::move`：

```
Runner(fn_t &&fn) : fn_(std::move(fn)), thread_(Thread, ref(*this)) {
    /*....*/
} 
```

您需要显式使用`std::move`，否则它将被视为 const 引用。你也可以使用`std::forward`：

```
Runner(fn_t &&fn) : fn_(std::forward<fn_t>(fn)), thread_(Thread, ref(*this)) {
    /*....*/
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T20:20:25.903

首先，您不应该在大多数情况下使用 r 值引用参数，除非在您自己的移动构造函数中。正如你所拥有的，没有办法将左值传递`std::function<bool()>`给`Runner`.

```
int main()
{
    Fn fn;
    std::function<bool()> func(fn);
    Runner runner(func); // this is illegal
} 
```

也许我只是没有足够的创造力，但我无法想象有什么正当理由要阻止这种事情发生。

你应该让`std::function`照顾它自己的复制/移动。当您需要对象的副本时，请按值获取参数。如果函数被传递一个 r 值，那么它将被移动构造。如果它被传递一个左值，那么它将被复制构造。然后，在您的`Runner`构造函数中，您可以将值移动到成员对象中，如 fontanini 所示。

但是，这些都不能保证减少析构函数的调用，因为当您移动一个对象时，您仍在创建第二个对象，并且必须销毁第二个对象。为了减少破坏，必须进行复制省略，这实际上确实避免了创建多个对象。但与搬家不同的是，这是一个实施问题，不能保证在您希望的所有情况下都生效。

# css - Css兄弟绝对定位

> ID：10624771
> 
> 赞同：61
> 
> 时间：2012-05-16T18:49:24.083
> 
> 标签：css, position

有没有办法相对于它的兄弟来绝对定位一个 div？例如：在一个 div 中还有另外两个 div - div1 和 div2。我想绝对定位 div2 相对于 div1。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-05-16T19:06:08.877

绝对定位取决于[“当前定位上下文”](http://www.w3.org/TR/WD-positioning-19970819#Current_Context)，它可能包括父元素（如果是绝对定位或相对定位），但绝不会包括兄弟元素。

你能重新组织你的 dom，让你有一个父子而不是兄弟姐妹吗？如果是这样，您可以将父级的位置设置为相对或绝对，将子级的位置设置为绝对，并且子级的位置相对于父级将保持绝对。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-16T19:06:57.900

根据**w3c** [规范](http://www.w3.org/TR/CSS2/visuren.html#absolute-positioning)，无法使用绝对位置：

> 在绝对定位模型中，框相对于其包含块显式偏移

— 相对于父块，而不是兄弟块

并且没有办法使用相对定位，也根据**w3c** [规范](http://www.w3.org/TR/CSS2/visuren.html#relative-positioning)：

> 一旦一个盒子按照正常流程布局或浮动，它可能会相对于这个位置移动。

— 相对于块的位置，而不是兄弟块

### 概括：

没有人能解决你描述的问题

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2020-07-12T08:31:00.620

正确答案是：**不**，但至少它的**垂直位置**会**受到兄弟姐妹的影响**。

正如其他答案所述，绝对定位的 div 的位置是相对于其祖先的。准确地说，当向上遍历 DOM 树时，它是相对于第一个非静态定位的祖先的。

**然而**：一个绝对定位的元素也会受到它的兄弟姐妹（在元素*之前*的那些）的影响。如果那些前面的兄弟姐妹是相对定位的，并且你的绝对定位元素*没有*设置它的 top 属性，那么它会垂直放置在那些相对定位的兄弟姐妹的下方。

```
<div class="relativeContainer">
  <div class="relative block">relative 1</div>
  <div class="relative block">relative 2</div>
  <div class="absoluteTopZero block">absolute top 0</div>
  <div class="absoluteTopInherited block">absolute</div> 
</div> 
```

[![在此处输入图像描述](../Images/7db595e9752c1c2cba334d13adac27a0.png)](https://i.stack.imgur.com/tZkqi.png)

看到这个小提琴： [https ://jsfiddle.net/fgxeu54t/28/](https://jsfiddle.net/fgxeu54t/28/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-16T19:03:07.787

根据您的需要，您可以使用适当的左/上/右/下值浮动它们或将它们定位为绝对值。

发布您的标记并准确解释您要实现的目标。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-16T19:10:22.300

用jquery试试

```
<script type="text/javascript">
        $('#div2').css('margin-left', $('#div1').outerWidth() +XXX + 'px'); 
```

# php - 对不同页面上的结果消息使用 URL 参数？有什么更好的方法来实现这一点？

> ID：10624784
> 
> 赞同：0
> 
> 时间：2012-05-16T18:50:14.173
> 
> 标签：php, parameters, query-string, alert

我有一个应用程序，我在其中使用 URL 参数在某个操作和重定向后触发结果消息。示例流程如下：

```
1\. User fills out form and clicks "Update"
2\. [PHP code to update DB]
3\. header('Location: [next-page.php]?message=1')
4\. [PHP code on checks DB for the text of message id #1 and echo the message, (e.g. "Update successful!")] 
```

这最初运作良好，但有几个问题。URL 参数在消息显示后仍然存在，因此如果页面被刷新，或者如果用户稍后单击返回该页面，则消息会再次显示。我正在寻找一种方法来执行上述操作，但仅在第一次显示该消息。我想避免为每条结果消息创建一个数据库实体，并带有一个属性来判断它是否已经被查看过，因为这似乎有点矫枉过正。你会怎么处理这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:59:39.680

一种方法是将表单发布到 next-page.php，然后在页面上执行此代码：

```
if (isset($_POST['form_element']))
    include("form-process.php"); //Or whatever page the DB update goes in 
```

**编辑：**您也可以使用 Javascript 来完成。将其放在表单所在的页面上：

```
$("#ajax_submit").click(function(){
    $("#ajax_form").submit();
    window.location=location.protocol+'//'+location.host+location.pathname+"nextpage.php";
}); 
```

在表单如下的页面上：

```
<form action="process_form.php" method="POST" id="ajax_form">
    Name: <input name="username"><br>
    Password: <input name="password" type="password"><br>
    <input type="submit" value="Login" id="ajax_submit">
</form> 
```

# php - 没有边框的iframe？

> ID：10624785
> 
> 赞同：0
> 
> 时间：2012-05-16T18:50:24.353
> 
> 标签：php, html

> **可能重复：**
> [从 IFrame 中删除边框](https://stackoverflow.com/questions/65034/remove-border-from-iframe)

几周前我开始了一个网站项目，需要一些帮助，我有这个 PHP 的 iframe 代码，但我希望它不显示边框，我该怎么做？

这是代码`<iframe src="http://localhost/jesper/nyhedder.php"></iframe>`

我想让边框= 0，而不是显示在表格内。它显示在表格中非常烦人，我也可以将其设为 PHP，但 PHP 不会显示，因为我将 PHP 代码放在了一些 HTML 代码中

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T18:54:09.647

这里与php无关。只需使用 CSS：

```
iframe
{
    border: 0;
} 
```

或添加`frameborder="0"`到`<iframe>`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T18:55:52.290

在 iframe 标记上添加属性 frameborder='0'。这是一个例子。

```
<iframe width="600" scrolling="no" height="700" frameborder="0" style="width: 600px; height: 280px;" src="http://www.google.com"></iframe> 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T18:59:34.080

只需使用 css 人！

```
iframe {
    border: none;
} 
```

# ios - iOS - 将 UIWebView 捕获到图像

> ID：10624787
> 
> 赞同：1
> 
> 时间：2012-05-16T18:50:31.653
> 
> 标签：ios, uiwebview

我正在尝试**将整个 UIWebView（甚至是屏幕外的内容）**捕获到 PNG。以下代码在大多数设备上运行良好，但在某些 iPad 1st gens 上它在此行上崩溃：

```
[self.webview.layer renderInContext:resizedContext]; /// crash 
```

**如何通过停止 renderInContext 进程来防止崩溃？**

有关问题的上下文，请参见下面的代码示例：

```
//Create original tmp bounds
CGRect tmpFrame = self.webview.frame;
CGRect tmpBounds = self.webview.bounds;
CGRect aFrame = self.webview.bounds;
aFrame.size.width = self.webview.frame.size.width;
aFrame.size.height = self.webview.frame.size.height;
self.webview.frame = aFrame;
aFrame.size.height = [self.webview sizeThatFits:[[UIScreen mainScreen] bounds].size].height;

NSLog(@"webpage size %f",self.webview.frame.size.height);

self.webview.frame = aFrame;
UIGraphicsBeginImageContext([self.webview sizeThatFits:[[UIScreen mainScreen] bounds].size]);
CGContextRef resizedContext = UIGraphicsGetCurrentContext();

// crash
[self.webview.layer renderInContext:resizedContext]; // crash
// crash

UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext();
self.webview.frame = tmpFrame;
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *pngPath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.png",@"TestImage"]];
NSError *error;
[UIImagePNGRepresentation(image) writeToFile:pngPath options:NSDataWritingAtomic error:&error];

NSURL *url = [NSURL fileURLWithPath:pngPath];

//reset webview
self.webview.bounds = tmpBounds;
self.webview.frame = tmpFrame; 
```

**模拟器不会崩溃，以下是在设备上运行时来自控制台的日志记录错误：**

```
May 16 12:33:41 unknown SpringBoard[29] <Warning>: Application 'AppName' exited abnormally     with signal 11: Segmentation fault: 11
May 16 12:33:41 unknown DTMobileIS[652] <Warning>: _memoryNotification : {
    OSMemoryNotificationLevel = 0;
    timestamp = "2012-05-16 19:33:41 +0000";
}
May 16 12:33:41 unknown DTMobileIS[652] <Warning>: _memoryNotification : <NSThread: 0x1d5286d0>{name = (null), num = 1}
May 16 12:33:41 unknown DTMobileIS[652] <Warning>: _memoryNotification : {
    OSMemoryNotificationLevel = 0;
    timestamp = "2012-05-16 19:33:41 +0000";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-03T19:38:58.407

我在做类似的事情时遇到了同样的问题，并通过首先计算图像的高度是否超过大约 8,000 像素来解决它。

如果是这样，我就失败了，并警告用户页面对于这个过程来说太大了，只要它是 iPad 1 硬件版本。

我从来没有找到任何真正解决这个问题的方法。

# php - 有没有办法使透明/不可见的 PHP 重定向？

> ID：10624791
> 
> 赞同：0
> 
> 时间：2012-05-16T18:50:47.013
> 
> 标签：php

我在这里使用这个片段：

```
<?php
    $uri = 'http://' . $_SERVER['HTTP_HOST'];
    header('Location: '.$uri.'/name/source/class.ControlEntry.php')
    exit; 
```

然而，所有这些路径信息都以 url 结尾。有没有办法重定向而不在浏览器的 url 中显示路径信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T19:24:00.570

1）您的网络服务器可以进行重定向。对于此解决方案，您必须能够配置您的网络服务器。见这里： [帮助 mod_rewrite 和 mod_redirect](https://stackoverflow.com/questions/3917220/help-with-mod-rewrite-and-mod-redirect)

2）您可以使用框架。将类似于以下内容的文件放入您的第一个网站并参考第二个网站。

```
<html>
  <frameset cols="100%">
    <frame src="URL OF SECOND PAGE HERE">
  </frameset>
</html> 
```

# sql - HQL：是否可以在子查询上执行 INNER JOIN？

> ID：10624794
> 
> 赞同：15
> 
> 时间：2012-05-16T18:50:56.247
> 
> 标签：sql, hibernate, hql

![图表](../Images/eb1393fb3f4c23832d8ab68ed242ea5c.png)

上图是我用来记录项目位置的数据库结构的简化版本。我编写了以下 SQL 查询，它返回每个位置的当前项目库存：

```
select * 
from ItemLocationLog l
inner join 
(select g.idItemLocationLog, max(g.dateTime) as latest
from ItemLocationLog g
group by g.idItem)
as i 
on l.idItem = i.idItem and l.dateTime = i.latest 
```

我遇到的问题是我想将其转换为 HQL，但我还没有找到在子查询上执行 INNER JOIN 的语法，而且似乎不支持。有没有办法将上述内容转换为 HQL（或标准），或者在这种情况下我必须使用标准 SQL 查询吗？谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-16T21:32:48.203

[http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/queryhql.html#queryhql-subqueries](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/queryhql.html#queryhql-subqueries)

> 请注意，HQL 子查询只能出现在 select 或 where 子句中。

您可以重写查询，使子查询成为 where 子句的一部分。在子查询中引用 l.idItem

# c++ - 如何正确处理音频中断？

> ID：10624797
> 
> 赞同：12
> 
> 时间：2012-05-16T18:51:12.963
> 
> 标签：c++, ios, audio, interrupt, openal

我创建了一个使用 OpenAL 进行音频播放的 OpenGL 3D 游戏，如果在初始化音频设备之前按下“主页”按钮，则会遇到丢失音频的问题。我试图连接到音频会话中断处理程序，但我的回调永远不会被调用。无论我是最小化还是最大化我的应用程序。我的“OpenALInterruptionListener”永远不会被调用。

我究竟做错了什么？

```
AudioSessionInitialize(NULL, NULL, OpenALInterriptionListener, this);

void OpenALInterriptionListener(void * inClientData, UInt32 inInterruptionState)
{
    OpenALDevice * device = (OpenALDevice *) inClientData;

    if (inInterruptionState == kAudioSessionBeginInterruption)
    {
          alcSuspendContext(_context);
          alcMakeContextCurrent(_context);
          AudioSessionSetActive(false);
    }
    else if (inInterruptionState == kAudioSessionEndInterruption)
    {
          UInt32 sessionCategory = kAudioSessionCategory_AmbientSound;
          AudioSessionSetProperty(kAudioSessionProperty_AudioCategory, sizeof(sessionCategory), &sessionCategory);
          AudioSessionSetActive(true);    
          alcMakeContextCurrent(_context);
          alcProcessContext(_context);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:30:26.970

请注意，目前存在音频中断和 IOS 问题。中断通知很好，但结束音频中断通知并不总是有效。苹果对此有一个错误，他们没有回应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T03:21:07.150

尝试在 alcMakeContextCurrent() 中使用 NULL

```
void OpenALInterriptionListener(void *inClientData, UInt32 inInterruptionState)
{
    OpenALDevice * device = (OpenALDevice *) inClientData;
    OSStatus nResult;

    if( inInterruptionState == kAudioSessionBeginInterruption )
    {
        alcMakeContextCurrent(NULL);    
    }
    else if( inInterruptionState == kAudioSessionEndInterruption )
    {
        nResult = AudioSessionSetActive(true);

        if( nResult )
        {
            //  "Error setting audio session active"
        }

        alcMakeContextCurrent( device->GetContext() );
    }
} 
```

# c# - 如何在字符串中重复的某个字符处提取字符串？

> ID：10624803
> 
> 赞同：0
> 
> 时间：2012-05-16T18:51:39.987
> 
> 标签：c#, .net

如何从“MyLibrary.Resources.Images.Properties.Condo.gif”字符串中获取“MyLibrary.Resources.Images.Properties”和“Condo.gif”。

我还需要它能够处理“MyLibrary.Resources.Images.Properties.legend.House.gif”之类的内容并返回“House.gif”和“MyLibrary.Resources.Images.Properties.legend”。

IndexOf LastIndexOf 不起作用，因为我需要倒数第二个'。特点。

提前致谢！

**更新**
感谢到目前为止的答案，但我真的需要它能够处理不同的命名空间。所以我真正要问的是如何拆分字符串中倒数第二个字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:54:39.860

您可以使用 Regex 或 String.Split 与 '.' 作为分隔符并返回倒数第二个 + '.' + 最后几件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:56:38.967

您可以查找`IndexOf("MyLibrary.Resources.Images.Properties.")`，将其添加到该位置`MyLibrary.Resources.Images.Properties.".Length`，然后`.Substring(..)`从该位置添加

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T18:56:48.407

如果你确切地知道你在寻找什么，并且它在尾随，你可以使用[string.endswith](http://msdn.microsoft.com/en-us/library/2333wewz.aspx)。就像是

```
if("MyLibrary.Resources.Images.Properties.Condo.gif".EndsWith("Condo.gif")) 
```

如果不是这种情况，请查看[正则表达式](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.aspx)。然后你可以做类似的事情

```
if(Regex.IsMatch("Condo.gif")) 
```

或者更通用的方式：在 '.' 上拆分字符串 然后抓取数组中的最后两项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T18:59:12.920

您可以使用 LINQ 执行以下操作：

```
string target = "MyLibrary.Resources.Images.Properties.legend.House.gif";

var elements = target.Split('.');

const int NumberOfFileNameElements = 2;

string fileName = string.Join(
    ".", 
    elements.Skip(elements.Length - NumberOfFileNameElements));

string path = string.Join(
    ".", 
    elements.Take(elements.Length - NumberOfFileNameElements)); 
```

这假定文件名部分仅包含一个`.`字符，因此要获得它，您可以跳过剩余元素的数量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-16T18:59:58.537

```
string input = "MyLibrary.Resources.Images.Properties.legend.House.gif";
//if string isn't already validated, make sure there are at least two 
//periods here or you'll error out later on.
int index = input.LastIndexOf('.', input.LastIndexOf('.') - 1);
string first = input.Substring(0, index);
string second = input.Substring(index + 1); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-16T19:00:28.317

尝试将字符串拆分为一个数组，通过每个 '.' 分隔它。特点。

然后你会有类似的东西：

```
 {"MyLibrary", "Resources", "Images", "Properties", "legend", "House", "gif"} 
```

然后，您可以采用最后两个元素。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-16T19:07:18.957

只需分解并在 char 循环中执行此操作：

```
int NthLastIndexOf(string str, char ch, int n)
{
    if (n <= 0) throw new ArgumentException();
    for (int idx = str.Length - 1; idx >= 0; --idx)
        if (str[idx] == ch && --n == 0)
            return idx;

    return -1;
} 
```

这比尝试使用字符串拆分方法来哄它便宜，而且代码也不多。

```
string s = "1.2.3.4.5";
int idx = NthLastIndexOf(s, '.', 3);
string a = s.Substring(0, idx); // "1.2"
string b = s.Substring(idx + 1); // "3.4.5" 
```

# c# - 如何在 C# 中使用 bigint？

> ID：10624815
> 
> 赞同：12
> 
> 时间：2012-05-16T18:52:22.117
> 
> 标签：c#, biginteger

我致力于实现[RSA](https://en.wikipedia.org/wiki/RSA_%28cryptosystem%29)密钥算法。但我不能使用 2048 位的值。我该如何使用它？

我想使用大整数。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-16T18:56:02.157

您可以使用`System.Numerics.BigInteger`（添加对 System.Numerics 程序集的引用）。正如评论中提到的，这可能不是正确的方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-16T18:55:46.067

.NET 4.0 中引入了对大整数的本机支持。只需添加对 的程序集引用，在代码文件的顶部`System.Numerics`添加声明，就可以开始了。`using System.Numerics;`你追求的类型是[`BigInteger`](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx).

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-03T16:00:06.223

这里使用`BigInteger`. 此方法将斐波那契数列中的数字打印到`n`.

```
public static void FibonacciSequence(int n)
{
    /** BigInteger easily holds the first 1000 numbers in the Fibonacci Sequence. **/
    List<BigInteger> fibonacci = new List<BigInteger>();
    fibonacci.Add(0);
    fibonacci.Add(1);
    BigInteger i = 2;
    while(i < n)
    {                
        int first = (int)i - 2;
        int second = (int) i - 1;

        BigInteger firstNumber =  fibonacci[first];
        BigInteger secondNumber = fibonacci[second];
        BigInteger sum = firstNumber + secondNumber;
        fibonacci.Add(sum);
        i++;
    }         

    foreach (BigInteger f in fibonacci) { Console.WriteLine(f); }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-16T18:56:53.307

[`BigInteger`](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx)在 .NET 4.0 或更高版本中可用。[还有一些第三方实现](http://biginteger.codeplex.com/)（如果您使用的是框架的早期版本）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-16T19:10:53.587

更好用`System.Numerics.BigInteger`。

# jquery - 使用 ajax 从直接 url 接收图像文件到图像文件

> ID：10624816
> 
> 赞同：1
> 
> 时间：2012-05-16T18:52:24.797
> 
> 标签：jquery, ajax, image

想象一下，我想从以下位置获取图像：

[http://www.entheosweb.com/fireworks/images/tracing/img18.jpg](http://www.entheosweb.com/fireworks/images/tracing/img18.jpg)

使用 jquery ajax。

我该怎么做。

```
$.ajax({
    url: 'http://www.entheosweb.com/fireworks/images/tracing/img18.jpg',
    type: "POST",
    dataType: "image",
    async: true,
    success: function(data) {
        data = data.replace(/</g, '&lt;');
        data = data.replace(/>/g, '&gt;');
        $('#file_content').html('<pre>' + data + '</pre>');    
    },
    error: function(a,b,c){
        alert("There has been an error! Try again...");
    } 
}); 
```

我猜是这样的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:59:26.243

您不需要 ajax，使用 javascript，您可以简单地设置 SRC 属性值。

```
$(function(){
   $("#img1").attr(
      "src","http://www.entheosweb.com/fireworks/images/tracing/img18.jpg") 

});​ 
```

示例：http: [//jsfiddle.net/PBKpk/1/](http://jsfiddle.net/PBKpk/1/)

# c - FindFirstFile 返回拒绝访问

> ID：10624817
> 
> 赞同：8
> 
> 时间：2012-05-16T18:52:25.710
> 
> 标签：c, windows, winapi

我正在尝试创建一个强大的递归文件夹删除器功能。

使用普通目录可以很好地工作。

当我创建“硬核”目录时出现问题，例如：

C:\test\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\ ... \x \x\x

其长度约为 25000（小于 MSDN 限制：32,767）。基本上我递归地创建了这个目录，直到 CreatDirectory 函数失败。

现在，最奇怪的是，我的函数能够删除 2 个目录，然后 FindFirstFile 以 0x5 失败：

```
\\?\C:\test\x\ ... \x\x\x\*.*    < no error
\\?\C:\test\x\ ... \x\x\*.*      < no error
\\?\C:\test\x\ ... \x\*.*        < access denied 
```

（我可以重新运行它，该应用程序正在慢慢咀嚼文件夹，2 x 2，可能直到路径长度变得非常小）

我正在运行 FindFirstFile 来检查文件夹是否为空。

*   是否有任何记录较少的限制？
*   FindFirstFile 根本不起作用？（越野车？）
*   我是否缺少某种 NTFS 权限？
*   别的...

**编辑：重要提示：如果我一步一步慢慢运行程序......那么什么都不会失败。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T20:45:05.403

您可能会遇到诸如病毒扫描程序、索引器或持续备份解决方案之类的东西，该解决方案持有目录句柄。例如，如果索引服务配置为索引该文件夹。

尝试删除打开的文件夹或文件，而不是使用 FILE_SHARE_DELETE 标志将导致 ACCESS_DENIED。

要确认这一点，请使用 Process Monitor 查看与您的路径匹配的任何内容的打开和关闭。

（当然也确认你叫FindClose）。

# java - 是否可以在黑莓中动态添加标签

> ID：10624818
> 
> 赞同：1
> 
> 时间：2012-05-16T18:52:28.797
> 
> 标签：java, blackberry

是否可以在黑莓应用程序中动态添加选项卡？

我发现这段代码适用于 java，但是当我尝试在 BB JDE 中为黑莓做时，它没有给出任何结果。

```
final TabSheet tabSheet = new TabSheet();

Button button = new Button("Add the tab");
button.addListener(
    new Button.ClickListener(){
        public void buttonClick(ClickEvent event) {
            VerticalLayout content = new VerticalLayout();
            content.addComponent(new Label("This is the tab content."));
            Tab tab = tabSheet.addTab(content, "The new Tab", null);
        }
     }
); 
```

我以这种方式在黑莓中实现

```
final TabSheet tabSheet = new TabSheet();
ButtonField button = new ButtonField("Add the tab");
button.setChangeListener(
    new FieldChangeListener() 
    {
        public void fieldChanged(Field field,int context) 
        {
            VerticalFieldManager content = new VerticalFieldManager();
            content.addComponent(new LabelField("This is the tab content."));
            Tab tab = tabSheet.addTab(content, "The new Tab", null);
        }
    }
); 
```

使用“tabsheet”标识符有问题。他们在黑莓中的替代方式是什么？

**更新：**

```
final PaneManagerModel tabsheet = new PaneManagerModel();
ButtonField button = new ButtonField("Add the tab");
button.setChangeListener(
    new FieldChangeListener() 
    {
        public void fieldChanged(Field field,int context) 
        {
            VerticalFieldManager content = new VerticalFieldManager();
            content.add(new LabelField("This is the tab content."));
            Pane panenew = new Pane(New,3);//Are the pane parameters right? 
            model.addPane(content, "The new Tab", null);//Can model be applied to this type?
        }
    }
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:48:25.197

黑莓没有`TabSheet`和`Tab`类。在 BBOS 6.0 及更高版本中，您可以改用`PanelManagerModel`、`PaneManagerView`、`PaneManagerController`和`Pane`类。

# c# - Win32Exeption：操作成功完成...图形

> ID：10624821
> 
> 赞同：0
> 
> 时间：2012-05-16T18:52:39.110
> 
> 标签：c#, .net, graphics, exception-handling, win32exception

我搜索了一些解决方案，但没有一个人显示解决方案......如果有人能解释它为什么会发生以及如何解决它（以简单的方式），我将不胜感激：）

一直在同一个地方发生……在我启动程序几分钟后。

```
private static Bitmap bmpScreenShot;
private static Graphics gfxScreenShot;
...
...

bmpScreenShot = new Bitmap(Screen.PrimaryScreen.Bounds.Width,
    Screen.PrimaryScreen.Bounds.Height, PixelFormat.Format32bppArgb);
gfxScreenShot = Graphics.FromImage(bmpScreenShot);
gfxScreenShot.CopyFromScreen(Screen.PrimaryScreen.Bounds.X,
    Screen.PrimaryScreen.Bounds.Y, 0, 0, Screen.PrimaryScreen.Bounds.Size, 
    CopyPixelOperation.SourceCopy); // <-- Occurs here a while after ive started the application 
```

在发生这种情况之前它会运行几次（比如 40-80 次）：

> Win32Exeption 未处理：操作成功完成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:03:00.070

在继续之前，请创建一个 try and catch 语句：

```
try
{
    //Your code goes here
}
catch (Win32Exception e)
{
    //Handle the exception here, or use one of the following to find out what the issue is:
    Console.WriteLine(e.Message);
    MessageBox.Show(e.Message, "Exception");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T18:26:31.740

原来我不得不`bmpScreenShot.Dispose();`做`gfxScreenShot.Dispose();`

# ucp - 使用 UCP 和 DataDirect 驱动程序连接到 Oracle

> ID：10624822
> 
> 赞同：0
> 
> 时间：2012-05-16T18:52:39.550
> 
> 标签：ucp

我正在尝试使用 UCP 和 Oracle 的 DataDirect JDBC 驱动程序连接到 Oracle 数据库。我需要使用的 URL 是什么。我目前正在使用以下内容。

```
<property name="URL" value="jdbc:datadirect:oracle:TNSNamesFile=C:\\Oracle\\11.2.0\\client_1_X64\\network\\admin\\tnsnames.ora;TNSServerName=TESTA"/> 
```

我收到错误原因：java.sql.SQLException：[DataDirect][Oracle JDBC Driver]如果指定了端口号，则必须指定主机名。

为什么我会收到此错误？是否可以将 UCP 与 DataDirect JDBC 驱动程序一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:22:28.140

看来您的 URL 是正确的，这是文档中的示例 URL：

```
jdbc:datadirect:oracle:TNSNamesFile=c:\\oracle\\NETWORK\\ADMIN\\tnsnames.ora;
    TNSServerName=FITZGERALD.SALES 
```

您可以在此处获取有关使用 UCP 和 DataDirect JDBC 连接到 Oracle 数据库的更多信息：

[http://media.datadirect.com/download/docs/jdbc/alljdbc/userguide/jdbcoracle.11.08.html#974893](http://media.datadirect.com/download/docs/jdbc/alljdbc/userguide/jdbcoracle.11.08.html#974893)

您可能会尝试的一件事是使用主机名和端口号，这是一个示例 URL：

```
jdbc:datadirect:oracle://server3:1521;ServiceName=ORCL;User=test;
Password=secret 
```

# javascript - 带有 phonegap 的手机上的网络应用程序

> ID：10624828
> 
> 赞同：0
> 
> 时间：2012-05-16T18:52:47.253
> 
> 标签：javascript, web-applications, cordova, background-process

我有一个 html + javascript 中的 Web 应用程序（聊天室），它基本上每 5 秒向服务器发送一次请求以检查新消息。

它已经在移动设备上运行，但有两个主要问题：

*   它不会发出哔哔声（它适用于 pc）有新消息
*   当浏览器置于后台时，javascript 显然停止执行，因此与服务器的连接丢失并且客户端断开连接。

我正在考虑使用 phonegap 不仅是为了使其跨平台，而且还要解决上述问题。他们会通过使用phonegap来解决吗？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:34:26.297

[使用Media API](http://docs.phonegap.com/en/1.7.0/cordova_media_media.md.html#Media)可以轻松播放声音。至于让 JavaScript 在后台运行，它真的取决于操作系统。在 Android 上，如果您通过主页按钮离开应用程序，JS 将继续运行，但后退按钮会终止应用程序，因此您将停止 JS。编写一个始终在这种情况下运行的服务可能会更好。

或者，您可以查看推送类型的解决方案来通知您新消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:00:14.003

# java - 将 String 变量分配给 String 数组

> ID：10624830
> 
> 赞同：3
> 
> 时间：2012-05-16T18:53:09.523
> 
> 标签：java

我无法将字符串变量分配给字符串数组。我的代码是：

```
//Declaring a String array 
public String [] fileWrite = new String [10]; 

//assigning a variable 

String value = String.valueOf(aChar1);
fileWrite[0] = value; 
```

但是当我尝试打印数组时，它给出了`null`. 我检查了变量**值**的值，但没关系。我无法理解数组存在的原因`null`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T19:02:37.573

首先，您需要知道java中的“打印数组”有些“损坏”：您需要使用[`Arrays.toString(array)`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#toString%28java.lang.Object%5B%5D%29)来打印数组（您不能依赖`array.toString()`-它没有用）。

试试这个代码：

```
public static void main(String[] args) {
    String[] fileWrite = new String[10];
    char aChar1 = 'x';
    String value = String.valueOf(aChar1);
    fileWrite[0] = value;
    System.out.println(Arrays.toString(fileWrite));
} 
```

输出：

```
[x, null, null, null, null, null, null, null, null, null] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:55:13.507

```
public String[] fileWrite = new String[10];
fileWrite[0] = aChar1 + ""; 
```

尝试这个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T19:00:06.640

分配是正确的。可能变量**aChar1**为 null 或字符串“null”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T19:01:49.133

要将变量分配给数组，请尝试

```
 String[] fileWrite = new String[10];
    Arrays.fill(fileWrite, aChar1);
    System.out.println(Arrays.toString(fileWrite)); 
```

# c# - 是否可以将 POCO 实体与标准实体相关联？

> ID：10624831
> 
> 赞同：1
> 
> 时间：2012-05-16T18:53:15.477
> 
> 标签：c#, frameworks, entity, poco

假设我必须创建一个名为 SalesOrders 的 POCO 实体和一个从名为 SalesOrderLines 的 SQL 数据库生成的常规实体。我想创建一个从 SalesOrders 到 SalesOrderLines 的关联，如下面的代码所示，但我不断在代码下方收到异常。有谁知道这是否可能？

```
[DataServiceKey("SalesOrderNumber")]
public class SalesOrder
{
    [Key]
    public int SalesOrderNumber { get; set; }
    public string StockCode { get; set; }
    public string Description { get; set; }

    [Include]
    [Association("SalesOrder_SalesOrderLine", "SalesOrderNumber", "SalesOrderNumber")]
    public IQueryable<SalesOrderLine> SalesOrderLines
    {
        get
        {
            SalesOrderLineEntities oSalesOrderLineEntities = new SalesOrderLineEntities();
            var soLines = from line in oSalesOrderLineEntities.SalesOrderLines
                         where line.OrderNumber == SalesOrderNumber.ToString() &&
                            line.StockCode == StockCode
                         select line;
            return soLines;
        }
        set
        {
        }
    }
} 
```

'ServiceName.NameSpace.SalesOrder' 类型上的属性 'SalesOrderLines' 不是有效属性。不支持类型为基元或复杂类型集合的属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T19:52:41.190

事实证明，我需要做的就是将 [Key] 属性添加到生成的元数据类中。

```
[MetadataTypeAttribute(typeof(SalesOrderLines.SalesOrderLinesMetadata))]
public partial class SalesOrderLines
{

    internal sealed class SalesOrderLinesMetadata
    {

        private SalesOrderLinesMetadata()
        {
        }

        public DateTime DateStamp { get; set; }

        public string OrderNumber { get; set; }

        [Key]
        public int SalesOrderLineID { get; set; }

        public string SerialNumber { get; set; }

        public string StockCode { get; set; }
    }
} 
```

# jquery - jQuery UI 自动完成 - 无响应导致功能中止

> ID：10624835
> 
> 赞同：0
> 
> 时间：2012-05-16T18:53:32.700
> 
> 标签：jquery, jquery-ui, autocomplete

我还是个 jQuery 新手，但我能够配置 jQuery UI 并在我的搜索框上实现自动完成功能。但是，我一直遇到一些问题。有时，自动完成功能会中断，导致搜索框本身消失。Firebug 告诉我该操作正在中止并且没有收到响应。

![Firebug 控制台错误](../Images/be86a4ae02c88e71d8d9e67fece36090.png)

这些错误没有明显的模式，下次我尝试使用相同的术语时，我怀疑这是一个数据问题。主要问题是这会导致搜索框从页面中完全消失，直到页面刷新。有没有办法至少阻止这种情况发生？如果需要，我很乐意提供更多信息。

```
$(document).ready(function($){
  $('.search').each(function(){
    var self = $(this);
    self.autocomplete({source: "/products/autocomplete"});
  });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:16:21.207

查看 Pedro 发布的链接，这个答案看起来是一个很好的起点： [Firebug 1.5 shows 200 Aborted for Ajax requests](https://stackoverflow.com/questions/2241861/firebug-1-5-showing-200-aborted-for-ajax-requests/4569891#4569891)

为了进一步调试，我还建议换行

```
self.autocomplete({source: "/products/autocomplete"}); 
```

尝试使用执行 console.log 或警报的 catch。您是否在 Firebug 的控制台日志中看到任何有关 javascript 错误的信息，或者只是 http 中止？在 try 中包装该行可能是一种很好的模式，可以潜在地防止网络错误在页面生命周期的剩余时间里破坏该控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:32:02.943

奇怪的是，当我尝试使用 Firebug 的搜索框时，我在 firebug 本身（firebug 1.9）中看到了完全相同的“消失”行为。{[区分大小写]，[上一个]，[下一个]}弹出窗口出现并在我单击搜索框获得焦点后立即消失，在弹出窗口消失的同时*散焦光标。*这可以防止使用搜索框。

但是，我确实有一个解决方法：多次单击，偶尔会非常快地弹出弹出窗口而不会消失。一旦我可以让弹出窗口停留，我就可以在搜索框中输入文本。但是，当我将注意力集中在其他地方时，弹出窗口消失了，因此很难单击 [Next] 以获取下一次出现的搜索字符串。同样，快速单击也是一种解决方法！

我无法在 Chrome 的调试器中复制它。

# java - 来自 Timestamp JPA 模型字段的 Primefaces 日历组件

> ID：10624839
> 
> 赞同：0
> 
> 时间：2012-05-16T18:53:42.660
> 
> 标签：java, jpa, primefaces

如何在日期和时间为 java.sql.Timestamp 的 jpa 模型中使用 primefaces 日历？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T14:12:44.920

我猜你必须实现自己的转换器，在 faces-config 中注册它，然后在日历中使用它。

```
<p:calendar >
    <f:converter converterId="YourRegisteredConverter" />
</p:calendar> 
```

# c# - 需要帮助以使用表达式树构建 LINQ 查询

> ID：10624845
> 
> 赞同：3
> 
> 时间：2012-05-16T18:54:22.713
> 
> 标签：c#, .net, linq, lambda

我需要为看起来像这样的 LINQ 查询构建一个 epression 树：

```
collection.OrderBy(e => ((MyObject)e["PropertyIndex"]).dictionary.Where(k => k.Key == "keyName").Select(k => k.Value).Single()); 
```

我查看了[这个链接](https://stackoverflow.com/questions/41244/dynamic-linq-orderby)，它解释了如何链接 OrderBy 方法。我不知道如何使用表达式树在 OrderBy 中添加 Where。

**更新：**

我需要动态地对内存中的数据进行排序。所以 linq 查询可能看起来像这样：

`collection.OrederBy(field1).ThenByDescending(field2).ThenBy(field3)`

我只知道在运行时需要排序多少个字段。任何 fieldX 都可以是复杂对象。对象的类型当然会在运行时知道。其中一个对象具有您在上面的 LINQ 查询中看到的结构。它有一本字典，我必须对特定的键进行排序。在我的情况下，字典包含本地化数据，例如：

```
{{"en-US", "word (en)"}, {"es-ES", "word (es)"} , ....} 
```

我需要按特定语言排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:00:20.010

看来您的查询正在执行此操作：

```
from k in collection
where k.Key == "keyName"
orderby ((MyObject)k)["PropertyIndex"]
select k.Value 
```

你可以添加更多这样的 where 子句：

```
from k in collection
where k.Key == "keyName"
&& k.OtherProperty == OtherValue
orderby ((MyObject)k)["PropertyIndex"]
select k.Value 
```

**编辑**：根据明确的要求，我建议您首先执行所有 where 子句（无需对您将忽略的数据进行排序），然后应用所有 .OrderBy()。如果您可以使它们成为 lambda，那比您建议的链接（双关语）要容易得多：

```
.OrderBy( e => e.Property1 ).OrderBy( e => e.Property2 ) 
```

如果您想“动态地”形成这些，请执行以下操作：

```
var query = (from k in collection select k);
query = query.Where( e => e.Property1 == "value" );
var orderedQuery = query.OrderBy( e => e.Property1 );
orderedQuery = query.Orderby( e => e.Property2 );
var result = orderedQuery.Select( e => e.Value ).Single(); 
```

在这些东西周围撒上一些条件，你就会变成金色的。请注意， query 是 type`IQueriable<T>`并且 orderedQuery 是 type `IOrderedQueriable<T>`，这就是为什么你不能（没有强制转换）重用相同的 var。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:44:21.270

您只需要通过 OrderBy 应用第一个订单字段，然后通过 ThenBy 应用所有其他字段。当然，您必须使用 IOrderedEnumerable 类型的临时变量。

如果您需要添加一些过滤器，那么您必须在任何订单之前添加 Where。

如果有许多可能的订单选项并且您不想对它们进行硬编码，那么您可以使用 Dynamic LinQ 并将订单字段指定为字符串。

# php - CakePHP 2.1 联系表单数据不会保存

> ID：10624847
> 
> 赞同：2
> 
> 时间：2012-05-16T18:54:26.203
> 
> 标签：php, forms, email, cakephp

我的 CakePHP 2.0 应用程序中有几个不同的联系表格。所有的联系表格都应该通过电子邮件发送，但我需要这个特殊的表格来将表格结果保存到数据库中。帖子数据正在填充，我可以`print_r()`和`pr()`表单数据。我什至可以通过电子邮件发送帖子数据。但是，它实际上并没有将数据保存到模型表中。数据库表已命名`contacts`并具有以下字段：`id, publication, company, name, email, phone, message, contact_method, selections, received`.

这是我的模型：

```
class Contact extends AppModel {
    public $name = 'Contact';

    public $useTable = 'contacts';

    public $validate = array(  
    'name' => array(
            'rule' => 'notEmpty'
        ),
        'email' => array(
            'rule' => 'notEmpty'
        )
    ); 
```

这是我的控制器：

```
App::uses('CakeEmail', 'Network/Email');

class ContactsController extends AppController
{
    public $name = 'Contacts';
    public $helpers = array('Html', 'Form', 'Js');
    public $components = array('Email', 'Session');

...

    public function contact_att() {

        if ($this->request->is('post')) {

            //pr($this->data);
            if ($this->Contact->save($this->request->data)) {
                $this->redirect('/pages/publications-alabama-turf-times');
                $this->Session->setFlash("Mesage Saved!"); 
            }

            else {
                print_r($this->data);
                Configure::write('debug', 2); 
                debug($this->Contact->validationErrors); 

                exit;
            }
        } 
```

这是我认为的表格：

```
echo $this->Form->create('Contact', array(
    'action' => 'contact_att', 
    'label' => '', 
    'class' => 'pubs'));
echo $this->Form->input('publication', array(
    'type' => 'hidden', 
    'value' => 'A', 
    'label' => ''));
echo $this->Form->input('company', array(
    'default' => 'company name (required)', 
    'onfocus' => 'clearDefault(this)', 
        'label' => array(
            'text' => 'Company Name',
            'style' => 'position:absolute;')));
echo $this->Form->input('name', array(
    'default' => 'name (required)', 
    'onfocus' => 'clearDefault(this)', 
    'label' => array(
        'text' => 'Your Name',
        'style' => 'position:absolute;')));
echo $this->Form->input('phone', array(
    'default' => 'phone number (required)', 
    'onfocus' => 'clearDefault(this)', 
    'label' => array(
        'text' => 'Your Phone Number',
        'style' => 'position:absolute;')));
echo $this->Form->input('email', array(
    'default' => 'email (required)', 
    'onfocus' => 'clearDefault(this)', 
    'label' => array(
        'text' => 'Your Email Address',
        'style' => 'position:absolute;')));
echo $this->Form->input('message', array(
    'label' => array(
        'text' => 'Your Message',
        'style' => 'position:absolute;')));
echo $this->Form->input('contact_method', array(
    'type' => 'radio',
    'style' => 'padding-right:20px;', 
    'legend' => 'Preferred contact method:', 
    'options' => array(
        'phone' => 'phone',
        'email' => 'email'
        )
    ));
echo $this->Form->input('selections', array(
    'type' => 'select', 
    'label' => array(
    'text' => 'I am interested in the following:', 
    'style' => 'display:block; width:250px; margin-left:-12px;padding-bottom:15px;'),
        'multiple' => 'checkbox',
        'options' => array(
            'ABC' => 'ABC', 
            'DEF' => 'DEF', 
            'GHI' => 'GHI'
         )
    ));

echo $this->Form->end('Submit'); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T16:08:32.903

在把我的头撞在桌子上之后，答案很简单——当然。我只是从我的模型中删除了这条线。我认为将其设置为正确的表就可以了，但事实证明，它需要被删除：

```
public $useTable = 'contacts'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T18:59:01.750

朋友，我看到你的问题，检查..

您的控制器中缺少此行

```
public $uses = array('Contact'); 
```

放试试看，然后你告诉我...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T19:27:30.807

你可以试试这个：

```
$this->Contact->save($this->request->data, false); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-19T04:21:05.003

请添加此行

```
$this->Contact->create(); 
```

在您尝试使用保存之前

```
if ($this->Contact->save($this->request->data)) { 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T23:56:06.507

尝试：

```
debug($this->model->invalidFields()); 
```

有时，模型在验证上有错误，而不是在validationErrors() 中显示

还要注意这一点。。

如果未提供 $fieldList，恶意用户可以向表单数据添加其他字段（如果您没有使用 SecurityComponent），并通过此更改原本不打算更改的字段。

[http://book.cakephp.org/2.0/en/models/saving-your-data.html](http://book.cakephp.org/2.0/en/models/saving-your-data.html)

花点时间阅读这份文档很重要，希望对你有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-17T19:17:07.270

只有当表单设置了张贴隐藏标志时，发布才返回 true。所以试试这个。

```
if(!empty($this->request->data)) 
```

# php - 变量值是两个字符串

> ID：10624849
> 
> 赞同：-2
> 
> 时间：2012-05-16T18:54:33.377
> 
> 标签：php

不知何故，一个应该只包含一个字符串（不是数组或任何东西）的变量包含一个 url，设法包含两个不同的值；

```
string(8) "value 1 " string(7) "value 2" 
```

我不能使用这个变量，因为回显它或在另一个函数中使用它会打印

```
value 1 value2 
```

这不是我需要的，我只需要值 1，我不能使用 $var[0]

两件事情; 我怎么能做类似的事情（一个变量两个字符串），我该如何操作它。编辑：这是代码

```
public function get_first_image($post) {
        $image_id=get_post_thumbnail_id($post->id);
        $image_url = wp_get_attachment_image_src($image_id,’large’);
        $image_url=$image_url[0];
        var_dump($image_url);
        return $image_url;
    } 
```

var_dump() 结果如上所述

最好的祝福

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:04:23.443

你的问题没有提供很多细节。如果您需要访问字符串的一部分，您可以使用该`explode()`函数。因此，如果字符串在单独的值之间不包含空格，则可以使用`$newstring = explode(" ",$oldstring); echo $newstring[0];`This 将允许您访问字符串的第一部分。

我建议您查找[string concatenation](http://php.net/manual/en/language.operators.string.php)。

如果您能向我们提供更多详细信息，我们可能会为您提供进一步的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:05:41.103

不要重用 $image_url 作为变量，这很可能会导致您的问题。您应该重命名您的变量之一：

```
public function get_first_image($post) {
    $image_id = get_post_thumbnail_id($post->id);

    $image_array = wp_get_attachment_image_src($image_id,’large’);
    $image_url = $image_array[0];

    var_dump($image_url);
    return $image_url;
} 
```

# ruby-on-rails - 在 rails 3 路线中使用 :id 以外的变量

> ID：10624858
> 
> 赞同：1
> 
> 时间：2012-05-16T18:55:18.117
> 
> 标签：ruby-on-rails, routes

我正在尝试让我的 rails 3 应用程序使用如下所示的路线：

```
exampleapp.com/patients/123456 
```

而不是

```
exampleapp.com/patients/1 
```

其中“123456”将与患者的病历编号 ( `:mrn`) 相关联，该编号已在`:patients`表中并且是唯一整数。我想用`:mrn`代替通常的`:id`. 我该怎么办？

抱歉，如果这已经被问到 - 我找不到关于我正在尝试做的事情的术语。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T19:59:14.463

你可以这样做，

```
class Patient < ActiveRecord::Base
  self.primary_key = "mrn"
end 
```

但是，这会改变很多其他的事情。to_params 将使用 mrn。控制器仍将使用 params["id"]，但值将是 mrn 字段。Patient.find 方法适用于 mrn 字段，但不适用于 id 字段。（您可以使用 Patient.find_by_mrn 和 Patient.find_by_id 这将在其指定的字段上工作。）此外，所有外键都将指向 mrn 值。

您可以编辑 mrn 字段，并且您仍然有一个 id 字段（除非您将其关闭），但是，编辑可能会很痛苦，因为必须更正所有外键。

或者，如果您只想更改 URL，则在 config/routes.rb 文件中而不是

```
resources :patient 
```

采用

```
match "/patients/:mrn" => "patients#show"
match "/patients/:mrn" => "patients#update", :via => :put 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-16T19:02:22.650

您可以将其添加到您的患者模型中

```
def class Patient < ActiveRecord::Base
  self.primary_key = "mrn"  
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T15:23:59.193

您可以通过在 Resource 实例上重新定义 member_scope 和 nested_scope 方法来自定义每个资源的标识符。

```
resources :patients do
  @scope[:scope_level_resource].tap do |u|
    def u.member_scope
      "#{path}/:mrn"
    end

    def u.nested_scope
      "#{path}/:#{singular}_mrn"
    end
  end
end 
```

# c# - 如何向 ASP.net 页面添加参数

> ID：10624859
> 
> 赞同：0
> 
> 时间：2012-05-16T18:55:22.587
> 
> 标签：c#, asp.net, database, parameters

我有一个包含我网站用户的一些记录的数据库，例如姓名、电子邮件、地址等。我使用 ASP.net (C#) 创建了一个页面，该页面可以有序地显示用户的信息。当有人从列表中单击用户名时，我想显示该页面的信息。如何在页面中添加参数？这样我就可以使用列表中与用户名链接的名称或 ID 从数据库中获取数据。

我想做的是这样的：

```
example.com/userpage.aspx/XYZ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:56:52.793

您可以使用查询字符串参数：

```
example.com/userpage.aspx?id=XYZ 
```

使用 Request 对象上的 QueryString 集合访问服务器上的 id：

```
string id = Request.QueryString["id"]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:57:11.983

我认为您可能希望使用[ASP.NET 路由引擎](http://msdn.microsoft.com/en-us/library/cc668201.aspx)来获取 URL 的一部分并将其路由到参数。

您可以将路线设置为 example.com/page.aspx?id=xyz 等于 example.com/page/xyz

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T19:13:05.873

如果您使用的是经典的 ASP.NET，那么您必须按照 Xander 的建议将参数传递给查询字符串。ASP.NET 在 ? 之后正确解析参数？您可以通过 Request["parameterName"] 访问它们。

但是，如果您想要像您发布的“用户友好 url”，那么您需要一些机制将用户友好 url 重写为系统 url。

*   首先，您可以使用 IIS7 Url Rewrite 模块或任何 3d 方 Url Rewrite 模块。通常是基于正则表达式，可以将url /Users/XYZ 改写为 /Users.aspx?name=XYZ

*   您也可以像 Ryan 建议的那样使用相对较新的技术 ASP.NET Routing Engine。

*   如果您的 url 方案很复杂，无法用正则表达式描述，那么您可以编写自己的 HTTP 模块并执行一些自定义的重写规则。

如果您的 Users.aspx.cs 页面您可以从 Request["Name"] 中读取查询参数，并使用它的值来执行一些 SQL 查询（或您想要访问数据库的任何内容）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T10:09:50.410

如果您使用的是 GridView，您只需将 OnRowCommand 事件附加到它，然后单击链接即可将名称传递给要在页面上显示的 UserID。

# sql - 将列标题转置为 postgresql 中的行

> ID：10624864
> 
> 赞同：17
> 
> 时间：2012-05-16T18:55:43.313
> 
> 标签：sql, postgresql

我有一个看起来像这样的视图

```
 value1count     value2count value3count
          ----------------------------------------
             25              35          55 
```

我需要将列标题转换成行，所以我需要它看起来像

```
 Values              Count
         -----------------------------
           value1count         25
           value2count         35
           value3count         55 
```

我可以通过选择单个列名作为第一列和数据作为第二列来做到这一点，然后对所有列进行相同的联合。

有一个更好的方法吗？我正在使用 PosgreSQL 8.1，因此没有可以使用的枢轴运算符。

感谢您提前回复。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-05-16T19:24:10.283

Crosstab only does the reverse of what you need, but this should help you:

First create the `unnest()` function that is included in 8.4, see [here](http://wiki.postgresql.org/wiki/Array_Unnest) for instructions.

Then you can do this (based on [this](https://stackoverflow.com/questions/1128737/unpivot-and-postgresql) post):

```
SELECT
   unnest(array['value1Count', 'value2Count', 'value3Count']) AS "Values",
   unnest(array[value1Count, value2Count, value3Count]) AS "Count"
FROM view_name
ORDER BY "Values" 
```

I can verify that this works in 8.4, but because I don't have 8.1, I can't promise it will work the same.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-01-15T09:01:11.813

我通过使用`hstore`的功能实现了您的目标：

```
SELECT (x).key, (x).value
FROM
  ( SELECT EACH(hstore(t)) as x
    FROM   t
  ) q; 
```

如果您的“待展开”视图或表（此处称为`t`）中有多行，您可能需要在中间表中插入一个附加标识符`q`，例如：

```
SELECT id, (x).key, (x).value
FROM
  ( SELECT id, EACH(hstore(t)) as x
    FROM   t
  ) q; 
```

参考：[`hstore`文档](http://www.postgresql.org/docs/9.3/static/hstore.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-03-16T18:52:35.120

我正在寻找与此类似的操作，以更轻松地处理来自 bash 脚本的表信息。事实证明，告诉 psql 将表列显示为行非常容易：

```
psql mydbname -x -A -F= -c "select * from blah where id=123" 
```

*   这`-x`就是输出的枢轴。
*   `-A`删除额外的间距。
*   列名和值之间的替换`-F=`为`|`。`=`

这当然不会在 SQL 中工作，它只会修改`psql`格式化输出的方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-21T18:39:32.530

我也有类似的情况。`UNION ALL`我将查询包装在 with 语句中，然后为每一行做一堆s 。在我的情况下，如果我有多个记录，则 ncm_id 会有所不同，因此我继续将其添加到结果集中的列列表中。这可能不是最好的方法，但它适用于我的用例。

```
 WITH query_a AS (
     SELECT
       fin_item.item_number || ' - ' || fin_item.item_descrip1 fin_item,
       fin_ls.ls_number,
       ls_sort.sortby_employeeid,
       ls_sort.ncm_id,
       ls_sort.created_at,
       ls_sort.updated_at,
       ls_sort.sort_qty,
       ls_sort.initial_scan_time,
       ls_sort.ncm_scan_time,
       ls_sort.badge_scan_time,
       ls_sort.computer_name,
       ls_sort.number_of_ops,
       ls_sort.ncm_item_scan_time,
       sort_by.name sort_by,
       tblncm.instructions,
       tblncm.ncm_comments
     FROM public.item AS fin_item
       INNER JOIN public.ls AS fin_ls ON fin_item.item_id = fin_ls.ls_item_id
       INNER JOIN stone.ls_sort ON fin_ls.ls_id = ls_sort.ls_id
       INNER JOIN stone.vw_mssql_employees AS sort_by ON ls_sort.sortby_employeeid = sort_by.employeeid
       INNER JOIN stone.tblncm ON ls_sort.ncm_id = tblncm.ncm_id
       LEFT JOIN stone.equips AS mach_equips ON ls_sort.mach_equip_id = mach_equips.id
       LEFT JOIN stone.equips AS mold_equips ON ls_sort.mold_equip_id = mold_equips.id
     WHERE 1 = 1
           AND fin_ls.ls_number ILIKE 'S143027526190' || '%'
 )
   SELECT *
   FROM (
     (SELECT 'fin_item' my_column, fin_item::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'ls_number' my_column, ls_number::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'sortby_employeeid' my_column, sortby_employeeid::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'ncm_id' my_column, ncm_id::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'created_at' my_column, created_at::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'updated_at' my_column, updated_at::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'sort_qty' my_column, sort_qty::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'initial_scan_time' my_column, initial_scan_time::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'ncm_scan_time' my_column, ncm_scan_time::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'badge_scan_time' my_column, badge_scan_time::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'computer_name' my_column, computer_name::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'number_of_ops' my_column, number_of_ops::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'ncm_item_scan_time' my_column, ncm_item_scan_time::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'sort_by' my_column, sort_by::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'instructions' my_column, instructions::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
      UNION ALL
     (SELECT 'ncm_comments' my_column, ncm_comments::TEXT my_value, ncm_id::TEXT my_ncm FROM query_a)
   ) as query_guy
 ORDER BY my_ncm; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-26T19:25:51.553

我可能不明白......但我这样做的方式是也选择 DISTINCT 然后选择我需要的平均列值。像这样：

```
SELECT DISTINCT contributing_factor_vehicle_1, AVG(number_of_cyclist_injured) FROM "table1".motor_vehicle_collisions_crashes 
GROUP BY contributing_factor_vehicle_1
ORDER BY avg(number_of_cyclist_injured) desc 
```

这就是创造了这样的东西： [![在此处输入图像描述](../Images/05b3d2e641b2a2f8badd59b3a9530f30.png)](https://i.stack.imgur.com/dYXZL.png)

顺便说一句，这是纽约市机动车碰撞数据。

# android - Android，Eclipse：“无扩展操作码”错误是什么意思？

> ID：10624865
> 
> 赞同：0
> 
> 时间：2012-05-16T18:55:45.980
> 
> 标签：android, eclipse, opcode

尝试从 Eclipse 调试 Android 应用程序时，我收到以下消息

```
Dx trouble writing output: No expanded opcode for 00412995 ExtractorBase.java:101@0006: 
invoke-direct v0:N0001Lorg/xml/sax/InputSource;, v2:Ljava/io/Reader;,
org.xml.sax.InputSource.<init>:(Ljava/io/Reader;)V 
```

这到底是什么意思？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:08:08.490

看起来您可能有更多的字段引用或方法（实际上，硬限制为 64k）。

如果你有一个特别大的项目，你可能会遇到这个限制。

您可以使用 try 摆脱不需要的引用（手动从项目中删除不需要的东西），或者使用 Proguard，它可以自动为您完成此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T04:53:22.417

正如@Booger 已经提到的，您可以在 android 应用程序中声明的字段、方法和类的数量有一个最大限制。实际上，如果您查看 dalivk 字节码指令本身，您可以看到 id 的最大值为 64k。

错误消息来自 android dx 工具，每当您编译 android 代码时就会执行该工具。来自[android open source](https://github.com/android/platform_dalvik/tree/master/dx/src/com/android/dx/dex/code)，这是引发该异常的代码：

```
private Dop findExpandedOpcodeForInsn(DalvInsn insn) {
    Dop result = findOpcodeForInsn(insn.getLowRegVersion(), insn.getOpcode());
    if (result == null) {
        throw new DexException("No expanded opcode for " + insn);
    }
    return result;
} 
```

如果您深入研究 findOpCodeForInsn 函数调用树，您将最终找到定义 dalvik 指令的格式类之一。在您的情况下，它将是 Form35c/3rc。在这里，检查 id 是否可以放入一个短整数：

```
public boolean isCompatible(DalvInsn insn) {
    ....
    CstInsn ci = (CstInsn) insn;
    int cpi = ci.getIndex();
    if (! unsignedFitsInShort(cpi)) {
        return false;
    } 
```

正在开发新的扩展字节码，将来可以容纳更大的 ID，但它们不可用。

与此同时，除了缩减方法的大小之外，您无能为力。对于包含多个 jar 的大型项目，这意味着遍历它们并尝试找到可以删除的未使用库。

# mysql - mysql查询 - 多级位置

> ID：10624868
> 
> 赞同：0
> 
> 时间：2012-05-16T18:55:52.133
> 
> 标签：mysql

我有一个具有以下结构和值的表：

```
location_id, location_name, parent_id

1,           USA,           0
2,           Illinois,      1
3,           Chicago,       2
4,           New York,      1 
```

在这个片段中，row with`'USA'`将被视为一个国家，因为值为`parent_id`0。但是，如果`parent_id`有其他值，则表示特定位置在某个位置之下。我们有多个级别的位置，它没有设置。可以是2级、3级、4级等。

例如。*美国 > 阿拉巴马州 > 阿拉巴马州墨西哥湾沿岸 > 墨西哥湾沿岸*

我需要获取所有`location_id`没有进一步位置的条目。所以在上面的例子中，我应该得到“海湾海岸”的答案。

我认为解决方案应该是这样的：

```
SELECT location_id FROM location WHERE "( parent_id does not contain any value from location_id )" 
```

但我无法弄清楚确切的语法。我应该如何实现这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T19:13:27.980

[如果您使用Closure Tables](http://karwin.blogspot.com/2010/03/rendering-trees-with-closure-tables.html)来实现这一点（如[“SQL Antipatterns”](http://pragprog.com/book/bksqla/sql-antipatterns)一书中推荐的那样），也许您会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T19:10:57.200

```
 select location_id from location l 
    where not exists 
    (select null 
     from location 
     where parent_id = l.location_id); 
```

# r - N 在 R 中选择 K 函数不起作用——我错过了什么？

> ID：10624869
> 
> 赞同：6
> 
> 时间：2012-05-16T18:55:56.150
> 
> 标签：r

我试图让自己熟悉 R 的 nChooseK 函数，但我无法让它工作。我认为这是标准设置的一部分（即不需要额外的包）。

请帮忙。这是我尝试过的：

```
> nChooseK(10,2) 
  Error: could not find function "nChooseK"
> n<-4;k<-2
> print(nChooseK(n,k)) 
 Error in print(nChooseK(n, k)) : could not find function "nChooseK" 
```

最后一个是我在这里看到的一个例子：[R basic nChooseK](http://www.stat.ucl.ac.be/ISdidactique/Rhelp/library/R.basic/html/nChooseK.html)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-16T19:01:04.297

该函数位于**R.basic**包中，它不是默认 R 安装的一部分。您可能只想使用`choose()`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-16T19:22:57.017

正如 joran 提到的那样，该函数`nChooseK`是 R.basic 的一部分。您可以通过查看页面顶部从发布的示例中看出这一点：

* * *

![基础页面](../Images/99d211f0b55fbd2eeac42394f812ebc9.png)

* * *

您会注意到花括号中的“R.basic”，它告诉您该函数是“R.basic”包的一部分。所以要使用`nChooseK`你首先需要加载那个包

```
library(R.basic) 
```

如果您还没有安装 R.basic，那么您需要安装它

```
install.packages("R.basic", contriburl="http://www.braju.com/R/repos/")
library(R.basic) 
```

但如前所述`choose`，base R 中的函数做同样的事情

```
choose(37, 12)
#[1] 1852482996
nChooseK(37, 12)
#[1] 1852482996 
```

# mysql - MySQL - 令人困惑的 RegEx 变量问题

> ID：10624871
> 
> 赞同：3
> 
> 时间：2012-05-16T18:56:05.533
> 
> 标签：mysql, regex, variables

我需要一些关于 RegEx 的帮助。这个概念很简单，但实际的解决方案远远超出了我所知道的任何东西。如果有人能解释我如何达到我想要的效果（并用任何示例代码提供解释），将不胜感激！

* * *

基本上，想象一个存储以下字符串的数据库表：

```
'My name is $1\. I wonder who $2 is.' 
```

首先，请记住美元符号数字格式是一成不变的。这不仅适用于这个例子——这就是这些通配符的实际存储方式。我想要一个像下面这样的输入能够返回上面的字符串。

```
'My name is John. I wonder who Sarah is.' 
```

我将如何创建一个使用这种格式的通配符进行搜索的查询，然后返回适用的行？我想正则表达式将是最好的方法。请记住，理论上，应该可以接受任意数量的通配符。

现在，这是我现有查询的一部分，将内容拖出数据库。存在连接等，因为在单个数据库单元中，有多个字符串由竖线连接。

```
AND CONCAT('|', content, '|')
    LIKE CONCAT('%|', '" . mysql_real_escape_string($in) . "', '|%') 
```

我需要修改 ^this 行以使用作为查询一部分的变量，同时保持当前效果（竖线等）到位​​。如果 RegEx 还考虑了柱，则可以删除 CONCAT() 函数。

这是一个带有连接的示例字符串，它可能出现在数据库中：

```
Hello, my name is $1.|Hello, I'm $1.|$1 is my name! 
```

查询应该能够与字符串中的任何这些块匹配，然后在匹配时返回该行。变量`$1`应被视为通配符。竖线将始终分隔块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T19:08:26.760

对于 MySQL，[这篇文章](http://www.techotopia.com/index.php/MySQL_Regular_Expression_Searches)是一个很好的指南，应该可以帮助你。正则表达式为“(\$)(\d+)”。这是我从文章中摘录的一个查询：

```
SELECT * FROM posts WHERE content REGEXP '(\\$)(\\d+)'; 
```

检索数据后，使用这个方便的功能：

```
function ParseData($query,$data) {
    $matches=array();
    while(preg_match("/(\\$)(\\d+)/",$query,$matches)) {
        if (array_key_exists(substr($matches[0],1),$data))
            $query=str_replace($matches[0],"'".mysql_real_escape_string($data[substr($matches[0],1)])."'",$query);
        else
            $query=str_replace($matches[0],"''",$query);
    }
    return $query;
} 
```

用法：

```
$query="$1 went to $2's house";
$data=array(
    '1' => 'Bob',
    '2' => 'Joe'
);
echo ParseData($query,$data); //Returns "Bob went to Joe's house 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:08:44.923

如果您不坚持使用 $1 和 $2 并且可以稍微更改它们，您可以看看这个：

[http://php.net/manual/en/function.sprintf.php](http://php.net/manual/en/function.sprintf.php)

例如

```
<?php
$num = 5;
$location = 'tree';

$format = 'There are %d monkeys in the %s';
printf($format, $num, $location);
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T19:12:35.433

如果要在数据库中查找条目，则可以使用 LIKE 语句：

```
SELECT statement FROM myTable WHERE statement LIKE '%$1%' 
```

这将找到所有包含 $1 的语句。我假设要替换的第一个数字将始终是 $1 - 在这种情况下，通配符的总数是任意的并不重要，因为我们只是在寻找第一个。

PHP 替换有点棘手。您可能可以执行以下操作：

```
$count = 1;
while (strpos($statement, "$" . $count)) {
    $statement = str_replace("$" . $count, $array[$count], $statement);
} 
```

（我没有测试过，所以那里可能有错别字，但应该足以给出一般的想法。）

一个缺点是，如果您的字符串中有十多个要替换的参数，它将失败 - 第一次运行将替换 $10 的前两个字符，因为它正在寻找 $1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T19:11:49.743

我问了一个不同但相似的问题，我认为该解决方案也适用于这个问题。

[https://stackoverflow.com/a/10763476/1382779](https://stackoverflow.com/a/10763476/1382779)

# c# - Console.WriteLine(ArrayList) 输出错误

> ID：10624872
> 
> 赞同：2
> 
> 时间：2012-05-16T18:56:08.443
> 
> 标签：c#, arraylist, console.writeline

我正在尝试打印各种 foreach 循环的 ArrayList 的内容，但我唯一得到的是 String + System.Collections.ArrayList。

例如下面的代码：

```
ArrayList nodeList = new ArrayList();
foreach (EA.Element element in elementsCol)
{
    if ((element.Type == "Class") || (element.Type == "Component") || (element.Type == "Package"))
    {
         nodeList.Add(element);
    }
    Console.WriteLine("The nodes of MDG are:" + nodeList); //stampato a schermo la lista dei nodi nel MDG finale 
```

我得到的输出是：

`The nodes of MDG are:System.Collections.ArrayList`

请有人告诉我为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:58:30.423

转换为字符串 for`nodeList`只会调用`nodeList.ToString()`产生您看到的输出。相反，您必须遍历数组并打印每个单独的项目。

或者，您可以使用`string.Join`：

```
Console.WriteLine("The nodes of MDG are:" + string.Join(",", nodeList)); 
```

顺便说一句，没有理由（或借口）仍然`ArrayList`在 C# 2 及更高版本中使用 - 如果您不维护旧代码切换到`List<T>`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T19:00:15.337

首先，没有充分的理由在 C# 中使用 ArrayList。您*至少*应该改用`System.Collections.Generic.List<T>`它，即使在这里，它们也可能是更具体的可用数据结构。*永远不要*使用像 ArrayList 这样的无类型集合。

其次，当您将对象传递给 Console.Writeline() 时，它只是调用对象的 .ToString() 方法。

**ArrayList 不会覆盖从基对象类型继承的 .ToString() 方法。**

基本对象类型的 .ToString() 实现只是简单地打印出对象的类型。因此，您发布的行为正是预期的。

我不知道选择不为数组和其他序列类型覆盖 .ToString() 的原因，但简单的事实是，如果您希望它打印出数组中的各个项目，则必须将代码编写为遍历这些项目并自己打印它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-16T18:58:46.073

你必须遍历 arraylist 来获取它的值......

```
foreach(var item in nodeList)
{
    Console.WriteLine("The nodes of MDG are:" + item);
} 
```

这将工作..

更新：

使用元素而不是节点列表

```
Console.WriteLine("The nodes of MDG are:" + element); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T15:43:02.017

我通过以下代码得到了我想要的输出：

```
using System.IO

using (StreamWriter writer = new StreamWriter("C:\\out.txt"))
        {
            Console.SetOut(writer);
         }

Console.WriteLine("the components are:");
        foreach (String compName in componentsList)
        { Console.WriteLine(compName); } 
```

其中 componentsList 是我想要打印的数组列表。

谢谢大家的帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T18:58:55.400

```
StringBuilder builder = new StringBuilder();
foreach (EA.Element element in elementsCol)
{
    if ((element.Type == "Class") || (element.Type == "Component") || (element.Type == "Package"))
    {
        builder.AppendLine(element.ToString());

    }
 }
 Console.WriteLine("The nodes of MDG are:" + builder.ToString()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-16T19:00:02.513

这会调用 nodeList.ToString()。对列表中的每个元素运行 ToString() 并将它们连接在一起会更有意义：

```
Console.WriteLine("The nodes of MDG are:" + string.Join(", ", nodeList)); 
```

# javascript - Node.js 表达的 Error 对象暴露了哪些属性？

> ID：10624873
> 
> 赞同：47
> 
> 时间：2012-05-16T18:56:13.027
> 
> 标签：javascript, node.js, express, connect

我想知道 nodejs express 的 Error 对象在错误处理中暴露了哪些功能？

一个`console.log`错误调用`new Error('NotFound')`只显示`[Error: NotFound]`，这是因为`.toString()`方法被覆盖了吗？如何找到这些对象暴露的属性和功能？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-05-16T19:02:10.017

该`Error`对象实际上是由 提供的本机对象`V8`，而不是由`node.js`or提供的`express`。

最有可能对您最有用的属性是`stack`。例如，

```
console.log(new Error('NotFound').stack); 
```

还有其他可用的属性，例如`name`和`message`。[你可以在这里](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error)阅读它们。请注意，这些文档是针对 Mozilla 的 JavaScript 引擎的，所以不要指望任何标记为`Non-standard`适用于`node.js`.

# mysql - MySQL字符串替换多个值？

> ID：10624875
> 
> 赞同：0
> 
> 时间：2012-05-16T18:56:18.190
> 
> 标签：mysql

```
 ClosedAccount[TABLE] values .

    |---------SERVICES-------------|

    ACCOUNTS,DOCS,BOOKS,READER
    BOOKS,ACCOUTNS,CALENDAR,READER 
```

询问

我想从两行中排除 "ACCOUNTS,BOOKS,READER"。这种秩序没有得到妥善维护。

简单的解决方案：

从 ClosedAccount 中选择 REPLACE(REPLACE(replace(services,"ACCOUNTS",""),"DOCS",""),"READER","")；

我想优化这个。是否有任何可用的解决方案请建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:25:17.543

如果您想删除这些*字符串*，那么我相信您已经得到了答案，因为您所追求的是字符串操作，而不是行的搜索条件。

# facebook-like - 如何发布opengraph对象

> ID：10624881
> 
> 赞同：0
> 
> 时间：2012-05-16T18:56:49.177
> 
> 标签：facebook-like, facebook-opengraph

需要帮助了解 opengraph 的工作原理以及它与“FB Like”按钮的关系。

我们确实在我们的内容的所有页面上部署了 opengraph 元标记。然而，看起来让“FB Like”按钮工作的唯一方法是通过 facebook linter 运行 URL。

如果用户尝试“喜欢”以前从未喜欢过的页面，则只会将 URL 发布到墙上。

如果 url 通过 linter 运行，所有连续的喜欢都将正常工作，按图像、标题和描述将被提取。

*   app_id 是否有可能没有与页面正确链接？
*   让我们的 FB 管理员去喜欢所有制作的内容不是一种选择

[http://www.nydailynews.com/life-style/travel/underwater-photos-amazing-shots-sea-gallery-1.1078782](http://www.nydailynews.com/life-style/travel/underwater-photos-amazing-shots-sea-gallery-1.1078782)

```
<meta property="fb:app_id" content="366487756153">
<meta property="fb:admins" content="1594068001">
<meta property="og:site_name" content="NY Daily News">                            
<meta property="og:title" content="Mark Tipple's Underwater Project - Underwater photos: Amazing shots from under the sea">
<meta property="og:type" content="article">
<meta property="og:url" content="http://www.nydailynews.com/life-style/travel/underwater-photos-amazing-shots-sea-gallery-1.1078782">
<meta property="og:image" content="http://assets.nydailynews.com/polopoly_fs/1.1078770!/img/httpImage/image.jpg_gen/derivatives/searchthumbnail_75/image.jpg">
<meta property="og:description" content="Talented underwater photographer Mark Tipple, from Sydney, Australia, lies in wait for unsuspecting swimmers and surfers before snapping a perfect picture of them from beneath the waves."> 
```

[http://www.nydailynews.com/gossip/john-travolta-experienced-bed-passionate-hotel-romp-claims-masseur-luis-gonzalez-article-1.1079272](http://www.nydailynews.com/gossip/john-travolta-experienced-bed-passionate-hotel-romp-claims-masseur-luis-gonzalez-article-1.1079272)

```
<meta property="fb:app_id" content="366487756153">
<meta property="fb:admins" content="1594068001">
<meta property="og:site_name" content="NY Daily News">                            
<meta property="og:title" content="John Travolta was 'a great kisser' and &lsquo;very experienced&rsquo; in bed during passionate hotel romp, claims masseur Luis Gonzalez&nbsp;">
<meta property="og:type" content="article">
<meta property="og:url" content="http://www.nydailynews.com/gossip/john-travolta-experienced-bed-passionate-hotel-romp-claims-masseur-luis-gonzalez-article-1.1079272">
<meta property="og:image" content="http://assets.nydailynews.com/polopoly_fs/1.1079279!/img/httpImage/image.jpg_gen/derivatives/searchthumbnail_75/image.jpg">
<meta property="og:description" content="Another hotel masseur is claiming sexual shenanigans on the part of John Travolta -- only this accuser says he welcomed the actor's horny horseplay and found him &quot;very experienced&quot; in bed."> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T13:42:35.860

为了让您的页面被识别为自定义打开图形对象，您需要执行以下步骤。

*   创建一个脸书应用
*   设置站点域、命名空间等...
*   在 app settings >> Open Graph: Getting Started 下创建自定义操作和自定义对象（[请参阅此链接获取帮助](http://developers.facebook.com/docs/opengraph/tutorial/)）
*   创建后，您将在 Open Graph Settings 中的对象类型下看到您的对象
*   单击“获取代码”按钮以获取 html 标签
*   更新您的页面以显示相同的 html 头和元标记
*   转到[http://developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)以测试您是否已正确设置所有内容

PS如果有效，别忘了点击正确答案，或PM我寻求更多帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T15:05:15.350

如 linter 中所述，您的 URL 未设置为应用程序，

> 'article' 类型的 URL 'http://www.nydailynews.com/life-style/travel/underwater-photos-amazing-shots-sea-gallery-1.1078782' 上的对象无效，因为域 'www.nydailynews.com ' 不允许用于指定的应用程序 ID '366487756153'。[您可以在https://developers.facebook.com/apps/366487756153](https://developers.facebook.com/apps/366487756153)验证您配置的“应用程序域” 。

将正确的域添加到您的设置中，它应该可以工作。

# haskell - 从目录中获取文件的排序列表

> ID：10624885
> 
> 赞同：0
> 
> 时间：2012-05-16T18:56:55.133
> 
> 标签：haskell

我想要一个目录中的文件排序列表。如何将`sort`函数应用于带有`IO`monad 的列表？

```
import System.Directory 
import Data.List

sortedFiles :: FilePath -> IO [FilePath]
sortedFiles path = do
    files <- getDirectoryContents "."
    return sort files                   -- this does not work 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T19:01:36.413

最初的问题只是缺少括号，因为目前`return`正在应用于两个参数（`sort`和`files`），只需修复它：

```
sortedFiles path = do
    files <- getDirectoryContents "."
    return (sort files) 
```

如果需要，可以`fmap`对目录内容进行排序功能。它有一种很好的、​​直接的感觉，基本上将排序功能提升到 IO monad：

```
sortedFiles path = sort `fmap` getDirectoryContents path 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T19:00:47.740

该`return`函数不接受两个参数。（这有一个例外，但它对初学者来说并不重要——它不会像你期望的那样做任何事情。）这是因为`return`它是一个函数，而不是语法。函数的所有标准语法规则都适用于它。您想传递返回的结果`sort files`，但这不是您使用的语法所说的。

您想要`return (sort files)`或`return $ sort files`。

两者完全等价。后者是稍微惯用的 Haskell。大多数人更喜欢使用`$`运算符而不是括号，因为两者都具有同等的可读性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-16T20:57:31.133

其他人已经指出缺乏括号。

但这里有一个更短、更易读的版本：

```
import System.Directory 
import Data.List
import Control.Applicative

sortedFiles :: FilePath -> IO [FilePath]
sortedFiles =  sort <$> getDirectoryContents 
```

# php - PHP while 不从 mysql 查询返回第一列

> ID：10624887
> 
> 赞同：0
> 
> 时间：2012-05-16T18:57:04.417
> 
> 标签：php, mysql

我是脚本新手，我的脚本有一些问题。我尝试制作一个表，其中脚本显示我在数据库中的表的信息，但代码未显示数据库的第一列

脚本：

```
 $sql = mysql_query("SELECT *
                            FROM verhuur
                            LIMIT 0 , 30"); //== test

        while ($contract = mysql_fetch_array($sql))
        {
?>

      <TR>
        <TD><a href="javascript:;" onclick="window.open('fietsnummer.php?nummer=<? echo $contract['klantid']; ?>','no','scrollbars=yes,width=550,height=400')"><? echo $contract['klantid']; ?></a></TD>
        <TD><? echo $contract['fietsnummers']; ?></TD>
        <TD><? echo $contract['datumverhuur']; ?></TD>
        <TD><? echo $contract['datumterug']; ?></TD>
        <TD><? echo $contract['borg']; ?></TD>
        <TD><? echo $contract['betaald']; ?></TD>
      </TR>  
 <?
 }
 ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:10:53.080

遇到问题时，忘记在浏览器上看到的内容，而是检查源代码，典型的错误是 PHP 乱七八糟的 HTML 和某些部分未显示

# asp.net-web-api - asp.net web api为资源生成url

> ID：10624895
> 
> 赞同：0
> 
> 时间：2012-05-16T18:57:26.233
> 
> 标签：asp.net-web-api

我正在尝试使用 asp.net web api 为资源生成一个 url。我可以在 ApiController 侧很容易地做到这一点，但是我不在 ApiController 上下文中呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T04:34:38.027

漫长的方法是获取请求，从属性集合中挖掘出配置和 RouteData，创建自己的 ControllerContext，然后您可以使用 UrlHelper 到通用 Urls。

可能有更简单的方法，但我还没有找到。

# perl - 使用 perl 登录网站

> ID：10624897
> 
> 赞同：0
> 
> 时间：2012-05-16T18:57:39.817
> 
> 标签：perl, web

我正在尝试使用 perl 登录网站。我已经尝试了所有选项 - LWP::Mechanize、LWP::UserAgent 等，但仍然无法成功登录。我收到 200 的响应代码，这意味着成功，但我将如何进入下一页？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:46:12.957

确保您在 LWP 中使用 cookie

```
$ua->cookie_jar({ file => "$ENV{HOME}/.cookies.txt" }); 
```

登录后只需 $ua 请求下一页。

如果登录名将您编辑到另一个页面并且您想要获取该页面，则使用

```
$ua->requests_redirectable 
```

有关更多信息，请查看 [http://search.cpan.org/~gaas/libwww-perl-6.04/lib/LWP/UserAgent.pm上的文档](http://search.cpan.org/~gaas/libwww-perl-6.04/lib/LWP/UserAgent.pm)

# java - 多线程读取大量文件

> ID：10624899
> 
> 赞同：16
> 
> 时间：2012-05-16T18:58:07.187
> 
> 标签：java, multithreading, concurrency

我仍在思考 Java 中的并发性是如何工作的。我知道（如果您订阅了 OO Java 5 并发模型）您使用or方法（分别）实现了`Task`or ，并且您应该尽可能多地并行化已实现的方法。`Callable``run()``call()`

但我仍然不了解 Java 中并发编程的一些内在特性：

*   如何为`Task`'`run()`方法分配要执行的正确数量的并发工作？

作为一个具体的例子，如果我有一个 I/O-bound方法，可以将 Herman Melville 的*Moby Dick*`readMobyDick()`的全部内容从本地系统上的文件读取到内存中。假设我希望这个方法是并发的并由 3 个线程处理，其中：*`readMobyDick()`*

 **   线程 #1 将书的前 1/3 读入内存
*   线程 #2 将书的第二个 1/3 读入内存
*   线程 #3 将书的最后 1/3 读入内存

**我是否需要将 Moby Dick 分成三个文件并将它们分别传递给他们自己的任务，或者我只是`readMobyDick()`从实现的`run()`方法内部调用并且（不知何故）`Executor`知道如何在线程之间分解工作。**

我是一个非常直观的学习者，因此非常感谢任何正确方法的代码示例！谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-16T19:16:20.563

您可能偶然选择了并行活动的绝对最差示例！

从单个机械磁盘并行读取实际上比使用单个线程读取要慢，因为您实际上是在轮到每个线程运行时将机械头弹跳到磁盘的不同部分。最好将其保留为单线程活动。

让我们再举一个例子，它与你的相似，但实际上可以提供一些好处：假设我想在一个巨大的单词列表中搜索某个单词的出现（这个列表甚至可能来自磁盘文件，但就像我说，由单线程读取）。假设我可以像您的示例中那样使用 3 个线程，每个线程都在巨大的单词列表的 1/3 上进行搜索，并保留一个本地计数器来记录搜索到的单词出现的次数。

在这种情况下，您希望将列表分成 3 个部分，将每个部分传递给类型实现 Runnable 的不同对象，并在`run`方法中实现搜索。

运行时本身不知道如何进行分区或类似的操作，您必须自己指定。还有许多其他的分区策略，每个都有自己的优点和缺点，但我们现在可以坚持静态分区。

让我们看一些代码：

```
class SearchTask implements Runnable {
     private int localCounter = 0;
     private int start; // start index of search
     private int end;
     private List<String> words;
     private String token;

     public SearchTask(int start, int end, List<String> words, String token) {
         this.start = start;
         this.end = end;
         this.words = words;
         this.token = token;
     }

     public void run() {
         for(int i = start; i < end; i++) {
              if(words.get(i).equals(token)) localCounter++;
         }
     }

     public int getCounter() { return localCounter; }
}

// meanwhile in main :)

List<String> words = new ArrayList<String>();
// populate words 
// let's assume you have 30000 words

// create tasks
SearchTask task1 = new SearchTask(0, 10000, words, "John");
SearchTask task2 = new SearchTask(10000, 20000, words, "John");
SearchTask task3 = new SearchTask(20000, 30000, words, "John");

// create threads for each task
Thread t1 = new Thread(task1);
Thread t2 = new Thread(task2);
Thread t3 = new Thread(task3);

// start threads
t1.start();
t2.start();
t3.start();

// wait for threads to finish
t1.join();
t2.join();
t3.join();

// collect results
int counter = 0;
counter += task1.getCounter();
counter += task2.getCounter();
counter += task3.getCounter(); 
```

这应该很好用。请注意，在实际情况下，您将构建更通用的分区方案。如果您希望返回结果，您也可以使用`ExecutorService`and 实现。`Callable``Runnable`

因此，使用更高级构造的替代示例：

```
class SearchTask implements Callable<Integer> {
     private int localCounter = 0;
     private int start; // start index of search
     private int end;
     private List<String> words;
     private String token;

     public SearchTask(int start, int end, List<String> words, String token) {
         this.start = start;
         this.end = end;
         this.words = words;
         this.token = token;
     }

     public Integer call() {
         for(int i = start; i < end; i++) {
              if(words.get(i).equals(token)) localCounter++;
         }
         return localCounter;
     }        
}

// meanwhile in main :)

List<String> words = new ArrayList<String>();
// populate words 
// let's assume you have 30000 words

// create tasks
List<Callable> tasks = new ArrayList<Callable>();
tasks.add(new SearchTask(0, 10000, words, "John"));
tasks.add(new SearchTask(10000, 20000, words, "John"));
tasks.add(new SearchTask(20000, 30000, words, "John"));

// create thread pool and start tasks
ExecutorService exec = Executors.newFixedThreadPool(3);
List<Future> results = exec.invokeAll(tasks);

// wait for tasks to finish and collect results
int counter = 0;
for(Future f: results) {
    counter += f.get();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T19:44:41.297

你选择了一个不好的例子，因为都铎很好地指出了这一点。旋转磁盘硬件受到移动盘片和磁头的物理约束，最有效的读取实现是按顺序读取每个块，这减少了移动磁头或等待磁盘对齐的需要。

也就是说，某些操作系统并不总是将内容连续存储在磁盘上，对于那些记得的人来说，如果您的操作系统/文件系统没有为您完成这项工作，碎片整理可以提高磁盘性能。

正如您提到的想要一个有益的程序，让我建议一个简单的程序，矩阵加法。

假设您为每个内核创建了一个线程，您可以轻松地将要添加的任意两个矩阵划分为 N（每个线程一个）行。矩阵加法（如果你还记得的话）是这样工作的：

```
A + B = C 
```

或者

```
[ a11, a12, a13 ]   [ b11, b12, b13]  =  [ (a11+b11), (a12+b12), (a13+c13) ]
[ a21, a22, a23 ] + [ b21, b22, b23]  =  [ (a21+b21), (a22+b22), (a23+c23) ]
[ a31, a32, a33 ]   [ b31, b32, b33]  =  [ (a31+b31), (a32+b32), (a33+c33) ] 
```

因此，要将其分布在 N 个线程中，我们只需将行数和模数除以线程数即可获得将添加的“线程 ID”。

```
matrix with 20 rows across 3 threads
row % 3 == 0 (for rows 0, 3, 6,  9, 12, 15, and 18)
row % 3 == 1 (for rows 1, 4, 7, 10, 13, 16, and 19)
row % 3 == 2 (for rows 2, 5, 8, 11, 14, and 17)
// row 20 doesn't exist, because we number rows from 0 
```

现在每个线程“知道”它应该处理哪些行，并且“每行”的结果可以简单地计算，因为结果**不会跨越其他线程的计算域**。

现在需要的只是一个“结果”数据结构，它跟踪计算值的时间，以及设置最后一个值的时间，然后计算完成。在这个带有两个线程的矩阵加法结果的“假”示例中，使用两个线程计算答案大约需要一半的时间。

```
// the following assumes that threads don't get rescheduled to different cores for 
// illustrative purposes only.  Real Threads are scheduled across cores due to
// availability and attempts to prevent unnecessary core migration of a running thread.
[ done, done, done ] // filled in at about the same time as row 2 (runs on core 3)
[ done, done, done ] // filled in at about the same time as row 1 (runs on core 1)
[ done, done, .... ] // filled in at about the same time as row 4 (runs on core 3)
[ done, ...., .... ] // filled in at about the same time as row 3 (runs on core 1) 
```

更复杂的问题可以通过多线程来解决，不同的问题用不同的技术解决。我特意选择了一个最简单的例子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T19:45:13.763

> 您使用 run() 或 call() 方法（分别）实现 Task 或 Callable，并且您应该尽可能多地并行化已实现的方法。

A`Task`代表一个*离散的工作单元*
将文件加载到内存中是一个离散的工作单元，因此可以将此活动委托给后台线程。即一个后台线程运行这个加载文件的任务。
它是一个离散的工作单元，因为它不需要其他依赖项来完成其工作（加载文件）并且具有离散的边界。
您要问的是进一步将其划分为任务。即一个线程加载文件的 1/3，而另一个线程加载 2/3 等。
如果您能够将任务划分为更多的子任务，那么根据定义，它首先不是任务。因此，加载文件本身就是一项任务。

举个例子：
假设你有一个 GUI，你需要向用户展示来自 5 个不同文件的数据。为了呈现它们，您还需要准备一些数据结构来处理实际数据。
所有这些都是单独的任务。
例如，文件的加载是 5 个不同的任务，因此可以由 5 个不同的线程完成。
数据结构的准备可以在不同的线程中完成。
GUI 当然在另一个线程中运行。
所有这些都可以同时发生

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-11-04T22:15:05.790

如果您的系统支持高吞吐量 I/O，您可以这样做：

[当高吞吐量（3GB/s）文件系统可用时如何使用 Java 中的多个线程读取文件](https://stackoverflow.com/questions/40412008/how-to-read-a-file-using-multiple-threads-in-java-when-a-high-throughput3gb-s/40432357#40432357)

**这是使用多个线程读取单个文件的解决方案。**

*将文件分成N个块，在一个线程中读取每个块，然后按顺序合并。注意跨越块边界的线。这是用户 [slaks建议的基本思想](https://stackoverflow.com/users/34397/slaks)*

下面对单个 20 GB 文件的多线程实现进行基准测试：

1 个线程：50 秒：400 MB/s

2 个线程：30 秒：666 MB/s

**4 线程：20 秒：1GB/s**

8 个线程：60 秒：333 MB/s

等效 Java7 readAllLines()：400 秒：50 MB/s

注意：这可能只适用于设计为支持高吞吐量 I/O 的系统，而不适用于普通的个人计算机

这是代码的基本细节，有关完整的详细信息，请点击链接

```
public class FileRead implements Runnable
{

private FileChannel _channel;
private long _startLocation;
private int _size;
int _sequence_number;

public FileRead(long loc, int size, FileChannel chnl, int sequence)
{
    _startLocation = loc;
    _size = size;
    _channel = chnl;
    _sequence_number = sequence;
}

@Override
public void run()
{
        System.out.println("Reading the channel: " + _startLocation + ":" + _size);

        //allocate memory
        ByteBuffer buff = ByteBuffer.allocate(_size);

        //Read file chunk to RAM
        _channel.read(buff, _startLocation);

        //chunk to String
        String string_chunk = new String(buff.array(), Charset.forName("UTF-8"));

        System.out.println("Done Reading the channel: " + _startLocation + ":" + _size);

}

//args[0] is path to read file
//args[1] is the size of thread pool; Need to try different values to fing sweet spot
public static void main(String[] args) throws Exception
{
    FileInputStream fileInputStream = new FileInputStream(args[0]);
    FileChannel channel = fileInputStream.getChannel();
    long remaining_size = channel.size(); //get the total number of bytes in the file
    long chunk_size = remaining_size / Integer.parseInt(args[1]); //file_size/threads

    //thread pool
    ExecutorService executor = Executors.newFixedThreadPool(Integer.parseInt(args[1]));

    long start_loc = 0;//file pointer
    int i = 0; //loop counter
    while (remaining_size >= chunk_size)
    {
        //launches a new thread
        executor.execute(new FileRead(start_loc, toIntExact(chunk_size), channel, i));
        remaining_size = remaining_size - chunk_size;
        start_loc = start_loc + chunk_size;
        i++;
    }

    //load the last remaining piece
    executor.execute(new FileRead(start_loc, toIntExact(remaining_size), channel, i));

    //Tear Down

}

} 
```*

# c# - 用来自 mock.Expect() 调用的对象覆盖实例化对象

> ID：10624900
> 
> 赞同：3
> 
> 时间：2012-05-16T18:58:07.753
> 
> 标签：c#, rhino-mocks

我有一个我正在测试的方法。

```
void MethodIAmTesting()
{
   SomeObject so = new SomeObject();

   _someService.AnotherMethodCall(so);
} 
```

现在，我正试图在我的单元测试中模拟“所以”。

```
void UnitTestMethod
{
   SomeObject testSO = new SomeObject();
   //Fill in data here.

   _classMock.Expect(instance => instance.AnotherMethodCall(testSO));

   _mainClass.MethodIAmTesting();
} 
```

但是当我运行测试时，它只是使用在真实方法中实例化的空版本。如何从真实代码中获取我调用的方法来使用我的 testSO 而不是 so？或者那不可能？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-14T13:22:13.940

测试驱动开发的设计的一部分应该推动您进行依赖注入。通常，当您发现难以进行单元测试时，这是因为您需要重新考虑您的设计。

在这种情况下，您的被测对象可能应该可以合理地创建`SomeObject`. 相反，它应该提供给某人。也许它应该在您测试的类第一次实例化时提供，也许它应该在您调用方法时提供。例如：

```
public class ClassBeingTested
{    
  public ClassBeingTested(SomeObject so)
  {
    // Inject class dependency when instantiated the class
  }

  void MethodIAmTesting(SomeObject so)
  {
    // Passing things needed for a function to complete its work
  }   
} 
```

此外，您很可能希望为 SomeObject 创建一个接口。然后，您可以为其创建一个存根，并轻松测试对其进行的调用、存根行为/属性等。当您以这种方式进行操作时，测试变得更加容易。例如，让我们考虑如何编写测试以确保`_someService`提供`SomeObject`：

```
void EnsureSomeObjectPassedToService()
{
   // arrange
   SomeObject so = new SomeObject()
   // act
   _mainClass.MethodIAmTesting(so);
   // assert
   _someObject.AssertWasCalled(x => x.AnotherMethodCall(so));
} 
```

而已！当你做正确的事情时非常容易。

# sql - SQL 移动平均线

> ID：10624902
> 
> 赞同：16
> 
> 时间：2012-05-16T18:58:20.813
> 
> 标签：sql, hive, moving-average

如何在 SQL 中创建移动平均线？

当前表：

```
Date             Clicks 
2012-05-01       2,230
2012-05-02       3,150
2012-05-03       5,520
2012-05-04       1,330
2012-05-05       2,260
2012-05-06       3,540
2012-05-07       2,330 
```

所需的表或输出：

```
Date             Clicks    3 day Moving Average
2012-05-01       2,230
2012-05-02       3,150
2012-05-03       5,520          4,360
2012-05-04       1,330          3,330
2012-05-05       2,260          3,120
2012-05-06       3,540          3,320
2012-05-07       2,330          3,010 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-16T19:22:43.950

这是一个常青乔塞尔科的问题。我忽略了使用哪个 DBMS 平台。但无论如何，Joe 能够在 10 多年前使用标准 SQL 来回答。

> [Joe Celko](http://en.wikipedia.org/wiki/Joe_Celko) SQL Puzzles and Answers 引用：“最后一次更新尝试表明我们可以使用谓词来构造一个查询，该查询会给我们一个移动平均线：”

```
SELECT S1.sample_time, AVG(S2.load) AS avg_prev_hour_load
FROM Samples AS S1, Samples AS S2
WHERE S2.sample_time
BETWEEN (S1.sample_time - INTERVAL 1 HOUR)
AND S1.sample_time
GROUP BY S1.sample_time; 
```

> 额外的列或查询方法更好吗？该查询在技术上更好，因为 UPDATE 方法将使数据库非规范化。但是，如果记录的历史数据不会发生变化并且计算移动平均值的成本很高，那么您可以考虑使用列方法。

微软 SQL 示例：

```
CREATE TABLE #TestDW
( Date1 datetime,
  LoadValue Numeric(13,6)
);

INSERT INTO #TestDW VALUES('2012-06-09' , '3.540' );
INSERT INTO #TestDW VALUES('2012-06-08' , '2.260' );
INSERT INTO #TestDW VALUES('2012-06-07' , '1.330' );
INSERT INTO #TestDW VALUES('2012-06-06' , '5.520' );
INSERT INTO #TestDW VALUES('2012-06-05' , '3.150' );
INSERT INTO #TestDW VALUES('2012-06-04' , '2.230' ); 
```

*SQL 拼图查询：*

```
SELECT S1.date1,  AVG(S2.LoadValue) AS avg_prev_3_days
FROM #TestDW AS S1, #TestDW AS S2
WHERE S2.date1
    BETWEEN DATEADD(d, -2, S1.date1 )
    AND S1.date1
GROUP BY S1.date1
order by 1; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-16T19:00:38.753

**一种方法是在同一张桌子上加入几次。**

```
select
 (Current.Clicks 
  + isnull(P1.Clicks, 0)
  + isnull(P2.Clicks, 0)
  + isnull(P3.Clicks, 0)) / 4 as MovingAvg3
from
 MyTable as Current
 left join MyTable as P1 on P1.Date = DateAdd(day, -1, Current.Date)
 left join MyTable as P2 on P2.Date = DateAdd(day, -2, Current.Date)
 left join MyTable as P3 on P3.Date = DateAdd(day, -3, Current.Date) 
```

调整 ON 条款的 DateAdd 组件以匹配您是否希望移动平均线严格从过去到现在或几天前到几天前。

*   这适用于仅需要几个数据点的移动平均值的情况。
*   对于具有多个数据点的移动平均线，这不是最佳解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-27T10:50:08.010

```
select t2.date, round(sum(ct.clicks)/3) as avg_clicks
from
(select date from clickstable) as t2,
(select date, clicks from clickstable) as ct
where datediff(t2.date, ct.date) between 0 and 2
group by t2.date 
```

[这里](http://sqlfiddle.com/#!2/84eddd/7)的例子。

显然，您可以将间隔更改为您需要的任何内容。您也可以使用 count() 代替幻数来使其更容易更改，但这也会减慢速度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-12T00:40:05.673

适用于大型数据集的滚动平均值的通用模板

```
WITH moving_avg AS (
  SELECT 0 AS [lag] UNION ALL
  SELECT 1 AS [lag] UNION ALL
  SELECT 2 AS [lag] UNION ALL
  SELECT 3 AS [lag] --ETC
)
SELECT
  DATEADD(day,[lag],[date]) AS [reference_date],
  [otherkey1],[otherkey2],[otherkey3],
  AVG([value1]) AS [avg_value1],
  AVG([value2]) AS [avg_value2]
FROM [data_table]
CROSS JOIN moving_avg
GROUP BY [otherkey1],[otherkey2],[otherkey3],DATEADD(day,[lag],[date])
ORDER BY [otherkey1],[otherkey2],[otherkey3],[reference_date]; 
```

对于加权滚动平均值：

```
WITH weighted_avg AS (
  SELECT 0 AS [lag], 1.0 AS [weight] UNION ALL
  SELECT 1 AS [lag], 0.6 AS [weight] UNION ALL
  SELECT 2 AS [lag], 0.3 AS [weight] UNION ALL
  SELECT 3 AS [lag], 0.1 AS [weight] --ETC
)
SELECT
  DATEADD(day,[lag],[date]) AS [reference_date],
  [otherkey1],[otherkey2],[otherkey3],
  AVG([value1] * [weight]) / AVG([weight]) AS [wavg_value1],
  AVG([value2] * [weight]) / AVG([weight]) AS [wavg_value2]
FROM [data_table]
CROSS JOIN weighted_avg
GROUP BY [otherkey1],[otherkey2],[otherkey3],DATEADD(day,[lag],[date])
ORDER BY [otherkey1],[otherkey2],[otherkey3],[reference_date]; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-13T12:56:33.580

```
select *
        , (select avg(c2.clicks) from #clicks_table c2 
            where c2.date between dateadd(dd, -2, c1.date) and c1.date) mov_avg
from #clicks_table c1 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-16T19:04:10.703

假设 x 是要平均的值，xDate 是日期值：

SELECT avg(x) from myTable WHERE xDate BETWEEN dateadd(d, -2, xDate) and xDate

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-16T19:27:58.497

使用不同的连接谓词：

```
SELECT current.date
       ,avg(periods.clicks)
FROM current left outer join current as periods
       ON current.date BETWEEN dateadd(d,-2, periods.date) AND periods.date
GROUP BY current.date HAVING COUNT(*) >= 3 
```

have 语句将阻止返回没有至少 N 个值的任何日期。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-01-11T06:23:00.583

在蜂巢中，也许你可以尝试

```
select date, clicks, avg(clicks) over (order by date rows between 2 preceding and current row) as moving_avg from clicktable; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-24T14:42:56.310

为此，我想创建一个辅助/维度日期表，例如

```
create table date_dim(date date, date_1 date, dates_2 date, dates_3 dates ...) 
```

while`date`是关键，`date_1`对于这一天，`date_2`包含这一天和前一天；`date_3`...

然后你可以在 hive 中进行相等的连接。

使用如下视图：

```
select date, date               from date_dim
union all
select date, date_add(date, -1) from date_dim
union all
select date, date_add(date, -2) from date_dim
union all
select date, date_add(date, -3) from date_dim 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-14T16:27:13.787

**注意：这不是答案，而是****Diego Scaravaggi**答案的增强代码示例。由于评论部分不足，我将其发布为答案。请注意，我已将移动平均线的周期参数化。

```
declare @p int = 3
declare @t table(d int, bal float)
insert into @t values
(1,94),
(2,99),
(3,76),
(4,74),
(5,48),
(6,55),
(7,90),
(8,77),
(9,16),
(10,19),
(11,66),
(12,47)

select a.d, avg(b.bal)
from
       @t a
       left join @t b on b.d between a.d-(@p-1) and a.d
group by a.d 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-09-22T10:28:59.070

```
--@p1 is period of moving average, @01 is offset

declare @p1 as int
declare @o1 as int
set @p1 = 5;
set @o1 = 3;

with np as(
select *, rank() over(partition by cmdty, tenor order by markdt) as r
from p_prices p1
where
1=1 
)
, x1 as (
select s1.*, avg(s2.val) as avgval from np s1
inner join np s2 
on s1.cmdty = s2.cmdty and s1.tenor = s2.tenor
and s2.r between s1.r - (@p1 - 1) - (@o1) and s1.r - (@o1)
group by s1.cmdty, s1.tenor, s1.markdt, s1.val, s1.r
) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-02-23T13:12:02.830

我不确定您的预期结果（输出）是否显示 3 天的经典“简单移动（滚动）平均值”。因为，例如，根据定义，数字的第一个三元组给出：

```
ThreeDaysMovingAverage = (2.230 + 3.150 + 5.520) / 3 = 3.6333333 
```

但你期望`4.360`它令人困惑。

不过，我建议使用以下解决方案，它使用 window-function `AVG`。这种方法比`SELF-JOIN`其他答案中介绍的方法更有效（清晰且资源较少）（我很惊讶没有人给出更好的解决方案）。

```
-- Oracle-SQL dialect 
with
  data_table as (
     select date '2012-05-01' AS dt, 2.230 AS clicks from dual union all
     select date '2012-05-02' AS dt, 3.150 AS clicks from dual union all
     select date '2012-05-03' AS dt, 5.520 AS clicks from dual union all
     select date '2012-05-04' AS dt, 1.330 AS clicks from dual union all
     select date '2012-05-05' AS dt, 2.260 AS clicks from dual union all
     select date '2012-05-06' AS dt, 3.540 AS clicks from dual union all
     select date '2012-05-07' AS dt, 2.330 AS clicks from dual  
  ),
  param as (select 3 days from dual)
select
   dt     AS "Date",
   clicks AS "Clicks",

   case when rownum >= p.days then 
       avg(clicks) over (order by dt
                          rows between p.days - 1 preceding and current row)
   end    
          AS "3 day Moving Average"
from data_table t, param p; 
```

您会看到在第一行`AVG`中用`case when rownum >= p.days then`to force `NULL`s 包裹，其中“3 天移动平均线”是没有意义的。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2016-01-09T00:33:50.607

我们可以应用 Joe Celko 的**“脏”左外连接**方法（如上 Diego Scaravaggi 所引用的）来回答被问到的问题。

```
declare @ClicksTable table  ([Date] date, Clicks int)
insert into @ClicksTable
    select '2012-05-01', 2230 union all
    select '2012-05-02', 3150 union all
    select '2012-05-03', 5520 union all
    select '2012-05-04', 1330 union all
    select '2012-05-05', 2260 union all
    select '2012-05-06', 3540 union all
    select '2012-05-07', 2330 
```

这个查询：

```
SELECT
    T1.[Date],
    T1.Clicks,
    -- AVG ignores NULL values so we have to explicitly NULLify
    -- the days when we don't have a full 3-day sample
    CASE WHEN count(T2.[Date]) < 3 THEN NULL
        ELSE AVG(T2.Clicks) 
    END AS [3-Day Moving Average] 
FROM @ClicksTable T1
LEFT OUTER JOIN @ClicksTable T2
    ON T2.[Date] BETWEEN DATEADD(d, -2, T1.[Date]) AND T1.[Date]
GROUP BY T1.[Date] 
```

生成请求的输出：

```
Date             Clicks    3-Day Moving Average
2012-05-01       2,230
2012-05-02       3,150
2012-05-03       5,520          4,360
2012-05-04       1,330          3,330
2012-05-05       2,260          3,120
2012-05-06       3,540          3,320
2012-05-07       2,330          3,010 
```

# javascript - 我需要一个 javascript/html 插件，它允许我在不编辑 .html 文件的情况下发布新闻

> ID：10624903
> 
> 赞同：-3
> 
> 时间：2012-05-16T18:58:23.917
> 
> 标签：javascript, jquery, html

如果每次我想在我的网站上发布新闻故事时，我都必须在我的 .html 文件中添加故事，这会很不方便。是否有允许您从第三方执行此操作的插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T19:02:39.467

你为什么不使用某种博客框架，比如[Wordpress](https://wordpress.com/)或[Blogger](http://blogger.com)。许多共享主机都有即插即用框架，您可以将其安装到您的站点上。您也可以自定义它们，使其看起来更像您的网站。这些框架将为您完成所有繁重的工作。

您还可以查看[DotNetNuke](http://www.dotnetnuke.com/)等内容管理系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:17:45.540

鉴于您没有使用 Joomla、Wordpress、Blogger、Drupal 等众多有用且免费的内容框架之一来处理此问题，我建议您只使用 jQuery 的[`$.ajax`](http://api.jquery.com/jQuery.ajax/)方法从服务器检索您的文章列表。然后，您可以使用一些简单的 jQuery 选择器在页面上插入内容。

**超级简单的例子（来自[Queness](http://www.queness.com/resources/html/ajax/simple.php)）：**

```
$.ajax({
  url: "getArticle.php",    
  type: "GET",      
  data: data,       
  cache: false,
  success: function (html) {    
    $('#content').html(html);           
  }     
}); 
```

# java - 在运行时加载 jars

> ID：10624907
> 
> 赞同：5
> 
> 时间：2012-05-16T18:58:37.630
> 
> 标签：java, jar, runtime

我正在尝试在运行时将 jar 文件添加到类路径。我使用此代码

```
 public static void addURL(URL u) throws IOException {

            URLClassLoader sysloader = (URLClassLoader) ClassLoader
                    .getSystemClassLoader();
            Class<URLClassLoader> sysclass = URLClassLoader.class;

            try {
                Method method = sysclass.getDeclaredMethod("addURL", parameters);
                method.setAccessible(true);
                method.invoke(sysloader, new Object[] { u });
                System.out.println(u);
            } catch (Throwable t) {
                t.printStackTrace();
                throw new IOException("Error");
            }

        } 
```

系统输出打印此网址：

```
file:/B:/Java/Tools/mysql-connector-java-5.1.18/mysql-connector-java-5.1.18/mysql-connector-java-5.1.18-bin.jar 
```

我仔细检查了这条路径，这个罐子存在。甚至这个测试显示com.mysql.jdbc。存在驱动程序类。

```
javap -classpath "B:\Java\Tools\mysql-connector-java-5.1.18\
mysql-connector-java-5.1.18\mysql-connector-java-5.1.18-bin.jar" com.mysql.jdbc.
Driver
Compiled from "Driver.java"
public class com.mysql.jdbc.Driver extends com.mysql.jdbc.NonRegisteringDriver i
mplements java.sql.Driver{
    public com.mysql.jdbc.Driver()       throws java.sql.SQLException;
    static {};
} 
```

但是当我使用这个 Class.forName(driver) 时，我仍然得到 java.lang.ClassNotFoundException。这段代码有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T19:30:24.070

URL 没问题，但是您尝试从类路径加载 jar，因此这意味着您需要先将文件放在 cp 中。在您的情况下，您想要加载不在类路径中的 jar，因此您必须使用 URLClassLoader，对于 JAR，您还可以使用 JARClassLoader 如果您想要一些示例课程： [http ://docs.oracle.com/javase/教程/部署/jar/jarclassloader.html](http://docs.oracle.com/javase/tutorial/deployment/jar/jarclassloader.html)

这是我自己运行的示例，看看是否对您有帮助。它搜索不在我的类路径中的 Log4j 的 Logger 类，当然我在调用构造函数时遇到异常，因为我没有将正确的参数传递给构造函数

```
package org.stackoverflow;
import java.io.File;
import java.net.URL;
import java.net.URLClassLoader;

public class URLClassLoaderSample
{
  public static void main(String[] args) throws Exception
  {
    File f = new File("C:\\_programs\\apache\\log4j\\v1.1.16\\log4j-1.2.16.jar");
    URLClassLoader urlCl = new URLClassLoader(new URL[] { f.toURL()},System.class.getClassLoader());
    Class log4jClass = urlCl.loadClass("org.apache.log4j.Logger");
    log4jClass.newInstance();
  }
}

Exception in thread "main" java.lang.InstantiationException: org.apache.log4j.Logger
    at java.lang.Class.newInstance0(Class.java:357)
    at java.lang.Class.newInstance(Class.java:325)
    at org.stackoverflow.URLClassLoaderSample.main(URLClassLoaderSample.java:19) 
```

由于错误调用导致的异常，但是在这个阶段我们已经找到了这个类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T15:07:24.553

好的，尝试使用 DataSource 而不是直接使用驱动程序的替代方法 下面是代码（使用 oracle 驱动程序，我没有我的 sql db，但属性相同） 通常使用 DataSource 接口是自 JDBC 2.0 以来的首选方法DataSource jar 不在类路径中，也不用于下面的测试

```
public static void urlCLSample2() throws Exception
{

    File f = new File("C:\\_programs\\jdbc_drivers\\oracle\\v11.2\\ojdbc6.jar");

    URLClassLoader urlCl = new URLClassLoader(new URL[] { f.toURL() }, System.class.getClassLoader());
    // replace the data source class with MySQL data source class.
    Class dsClass = urlCl.loadClass("oracle.jdbc.pool.OracleDataSource");
    DataSource ds = (DataSource) dsClass.newInstance();

    invokeProperty(dsClass, ds, "setServerName", String.class, "<put your server here>");
    invokeProperty(dsClass, ds, "setDatabaseName", String.class, "<put your db instance here>");
    invokeProperty(dsClass, ds, "setPortNumber", int.class, <put your port here>);
    invokeProperty(dsClass, ds, "setDriverType",String.class, "thin");
    ds.getConnection("<put your username here>", "<put your username password here>");

    System.out.println("Got Connection");
  }

  // Helper method to invoke properties
  private static void invokeProperty(Class dsClass, DataSource ds, String propertyName, Class paramClass,
      Object paramValue) throws Exception
  {
    try
    {
      Method method = dsClass.getDeclaredMethod(propertyName, paramClass);
      method.setAccessible(true);
      method.invoke(ds, paramValue);
    }
    catch (Exception e)
    {
      throw new Exception("Failed to invoke method");
    }
  } 
```

# java - Jsoup 超时无法正常工作

> ID：10624908
> 
> 赞同：-1
> 
> 时间：2012-05-16T18:58:40.400
> 
> 标签：java, multithreading, concurrency, jsoup

我编写了一小段代码，它应该使用 Jsoup (1.6.2) 下载给定网站的文本。

```
public String readPage(String url) {

    try {

        long start = System.currentTimeMillis();
        String text = Jsoup.connect(url).timeout(10000).get().html();
        System.out.println(System.currentTimeMillis() - start);
        return text;
    }
    catch (IOException e) {

        // we need to do this because the log file is flooded with useless error messages 
        if ( e.getMessage().contains("Unhandled content type") ||
             e.getMessage().contains("Premature EOF") ||
             e.getMessage().contains("Read timed out") ||
             e.getMessage().contains("403 error loading URL") ||
             e.getMessage().contains("404 error loading URL") ||
             e.getMessage().contains("405 error loading URL") ||
             e.getMessage().contains("500 error loading URL") ||
             e.getMessage().contains("503 error loading URL") ) {

            logger.debug(String.format("Error crawling website: %s", url));
        }
        else logger.error(String.format("Error crawling website: %s", url), e);
    }

    return "";
} 
```

我在线程列表中启动此方法，每个线程负责下载单个网站。在我看来（这显然是错误的），每个 system.out 都应该显示一个低于 10000 的数字，因为 Jsoup 应该抛出一个异常。但情况并非如此，标准输出中的时间跨度高于 100k。

这怎么可能，我做错了什么？

干杯丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:05:52.483

这并不让我感到惊讶。在您获得开始时间和结束时间之间会发生很多事情。连接可能是在截止日期之前建立的，并且您的结束时间很容易超过截止日期，具体取决于下载的速度（尤其是因为您同时进行多个下载）。

你评论说：

> 很抱歉，您能更详细地解释一下吗？

你有这一行：

```
String text = Jsoup.connect(url).timeout(10000).get().html(); 
```

一次被多个线程调用。想象一个场景，所有线程都快速连接，但所有线程都需要时间来下载信息并处理它，尤其是在许多线程都在竞争相同资源的情况下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T19:13:58.453

假设`thread 1`执行`long start = System.currentTimeMillis()`并且系统调度程序停止第一个线程并启动第二个线程。第二个线程调用`long start = System.currentTimeMillis()`并停止第三个线程调用其代码。

这是不确定的 - 系统调度程序可以在所有线程完成后分配运行第 n 个线程 - System.out.println 可以与所有线程的持续时间一样长。

超时有效 - 但线程是这里的问题。

# mysql - 使用 SQL Developer 3 将 MySQL 数据库迁移到 Oracle 11g

> ID：10624914
> 
> 赞同：4
> 
> 时间：2012-05-16T18:58:58.630
> 
> 标签：mysql, oracle, oracle11g, data-migration, oracle-sqldeveloper

我尝试使用 SQL developer 将示例数据库从 mysql 迁移到 Oracle 11g。我浏览了一些在线教程并按照每个步骤进行操作，但我不知道为什么目标数据库中没有数据显示。

这是我所做的：

1.  使用带有 JConnector 的 SQL Developer 连接到 MySQL（连接名称“MySQL”），以 root 身份登录。

2.  在迁移期间为“存储库”创建一个名为“TEMPBUFFER”的空架构

3.  创建用于在 Oracle 中保存数据的目标模式，名为“DEVELOPER”

4.  按照迁移向导：

> Migration Repository = TEMPBUFFER
> 用于迁移的第三方数据库 = MySQL
> Oracle 中的目标模式 = DEVELOPER
> 只选择了一个名为“classmodels”的数据库从 MySQL 迁移

所以这是我的问题：

1.  最重要的是，为什么 DEVELOPER 模式上没有表/数据显示，如何解决？

2.  什么是迁移存储库以及我们为什么需要它？它似乎包含一些带有配置信息的表，所以我们应该将目标模式用作迁移存储库是不是很常见？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T11:28:39.240

我知道这很旧，但最后一步是在源方案上右键单击表时复制到 oracle

本教程中的第 27 步 [http://taliphakanozturken.wordpress.com/tag/db-migration-using-sql-developer/](http://taliphakanozturken.wordpress.com/tag/db-migration-using-sql-developer/)

# python - 什么是“def __iter__(self): return iter(self.file)”？

> ID：10624920
> 
> 赞同：2
> 
> 时间：2012-05-16T18:59:19.967
> 
> 标签：python, django

我对 python 有点陌生，正在查看 Django 源代码。我遇到了[`utils.py`](https://github.com/django/django/blob/master/django/core/files/utils.py)，并且对这个迭代器方法的作用有些困惑：

```
def __iter__(self):
        return iter(self.file) 
```

这将用于什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T19:01:08.317

遍历一个文件会产生它的所有行，例如：

```
for line in open("foo.txt"):
    print line 
```

结果是：

```
line1

line2

line3 
```

如果`foo.txt`是：

```
line1
line2
line3 
```

（额外的换行符，因为`line`包括文件的换行符）。

因此，迭代一个类的实例，该实例的源您发布了一个片段，结果是迭代该实例的`file`行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T19:06:19.320

`__iter__`当某个对象作为参数传递给`iter()`. 也就是说，如果你调用`iter(a)`，在幕后，python 最终会`a.__iter__()`默认调用。

For this particular implementation, it will then return the iterator for the `file` member, whatever that may be.

# css - 使用 CSS 减少 EM 倾斜？

> ID：10624922
> 
> 赞同：0
> 
> 时间：2012-05-16T18:59:23.120
> 
> 标签：css, font-face

我`<em>`用来制作`@font-face`风格`<h1>`斜体的一部分。我遇到的问题是它*太*斜体了。

我正在使用字体 Impact，据我所知，它没有斜体版本。在 Photoshop 中，使用章程面板中的倾斜文本选项仅使文本部分倾斜。但是，在`<em>`网站上，它非常倾斜。有没有办法用 CSS 来调整它？或者有人有我可以使用的真正斜体版本的 Impact 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T19:06:15.480

如果无论出于何种原因，使用 Impact 是绝对*强制性*的，您可以使用 CSS3 模仿斜体。 [http://www.w3schools.com/css3/tryit.asp?filename=trycss3_transform_skew](http://www.w3schools.com/css3/tryit.asp?filename=trycss3_transform_skew)

但是，许多旧浏览器（和一些较新的浏览器）不支持此功能，因此我会犹豫不决。考虑到您想要更改 Impact 实际想要的方式，您可能只想要不同的字体，但这仍然需要 CSS3 才能正确加载，除非您打算在服务器端为您的标题生成一些图像，我非常不推荐这样做。 [http://www.w3schools.com/css3/css3_fonts.asp](http://www.w3schools.com/css3/css3_fonts.asp)

我的推荐？`<em>`只需在标签上使用 CSS3 倾斜。在最坏的情况下，浏览器不支持它，而且它的斜体有点太重了。这没什么大不了的。在最好的情况下，您的网站看起来很棒！如果原来的斜体对你来说太过分了，我会在`<em>`标签上删除它们，然后还是做我的解决方案。这样，如果不支持 CSS3，您仍然会得到一个不错的 Impact 标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T19:19:37.647

Impact 字体没有斜体版本。因此，通过要求某些软件将其斜体化，您得到的只是直立版本或一些机械（算法）倾斜的变形。该算法取决于软件，但不会产生斜体。所以不要这样做。

# android - Android 使用 restlet 与 GAE 通信的挑战

> ID：10624928
> 
> 赞同：0
> 
> 时间：2012-05-16T18:59:45.743
> 
> 标签：android, google-app-engine, gwt, restlet

我正在使用 Eclipse 来（尝试）构建一个 Android 客户端，以重用我使用 GAE 和 GWT 开发的 restlet 服务。

我的服务正在运行

```
 http://127.0.0.1:8888/abc/audits 
```

我可以通过直接访问这个 url 并使用我的 GWT 客户端来测试它——两者都可以。

但是，以下代码返回通信错误

```
 private AuditsResource resource;
    private Audits audits;

    ClientResource cr = new ClientResource("http://127.0.0.1:8888/abc/audits");
    resource = cr.wrap(AuditsResource.class);
    try {
    // Get the remote contact
     audits = resource.retrieve();
    // The task is over, let the parent conclude.
    handler.sendEmptyMessage(0);
    } catch (Exception e) {
        Message msg = Message.obtain(handler, 2);
        Bundle data = new Bundle();
        data.putString("msg", "Cannot get the contact due to: "
            + e.getMessage());
        msg.setData(data);
        handler.sendMessage(msg);
    } 
```

我不知道下一步该往哪里看。我已经检测了 AuditsResource 的服务器实现，并且它从未被触及（由 Android 应用程序）。

AuditsResource 类有一种方法，现在可以让事情变得简单

```
 @Get
    public Audits retrieve(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T12:11:24.503

看来问题是 Andriod Emulator 无法连接到 127.0.0.1 或 10.0.2.2。解决方案是使用您的 PC 的 IP 地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T04:06:15.490

我可以使用 10.0.2.2 而不是 localhost 通过 Android/Restlet 从 Android 连接到我的本地 Google App Engine。

# java - 在 CommandLink 中使用时不会触发动作行为

> ID：10624929
> 
> 赞同：1
> 
> 时间：2012-05-16T18:59:49.917
> 
> 标签：java, jsf-2, primefaces, facelets

我遇到了使用问题`<p:commandLink>`，我使用了

```
<p:commandLink action="#{commonOrgPage.preCreateCommonOrg}" 
               immediate="true" 
               update=":createCommonOrgForm:addCommonOrg" 
               oncomplete="addDlg.show();"> 
```

要显示一个添加对话框，在它之前，我应该调用操作并更新对话框。但是现在没有调用该操作并显示对话框。

主页.xhtml

```
 <ui:define name="mainLayoutTitle">Home Page</ui:define>
    <ui:define name="bodyName">
        <ui:decorate template="/pages/commons/layouts/contentLayout.xhtml">
            <ui:define name="leftContentName">
                <ui:include src="/maintainCodeMenu.xhtml"></ui:include>
            </ui:define>
            <ui:define name="rightContentName">
                    <p:outputPanel id="rightContentPanel" >
                        <p:outputPanel rendered="${commonOrgPage.commonOrgTypeName !=null}">
                            <ui:include src="/pages/admin/commonorg/viewCommonOrgList.xhtml"></ui:include>
                        </p:outputPanel>
                    </p:outputPanel>
            </ui:define>
        </ui:decorate>
    </ui:define>    

</ui:composition> 
```

维护代码菜单.xhtml

```
<h:form id="codeMenu">
<div>Common Organisations</div>
<p:separator />
<div>
    <p:commandLink id="Bank" value="Add Bank" action="#{commonOrgPage.listCommonOrgByCriteria}"
            update=":rightContentPanel" ajax="false">
        <f:param name="commonOrgTypeCode" value="B" />
        <f:param name="commonOrgTypeName" value="Bank"/>        
    </p:commandLink>
</div>  
<div>
    <p:commandLink id="School" value="Add School" action="#{commonOrgPage.listCommonOrgByCriteria}"
            update=":rightContentPanel" >
        <f:param name="commonOrgTypeCode" value="SH" />
        <f:param name="commonOrgTypeName" value="School"/>      
    </p:commandLink>
</div>
</h:form>
</ui:composition> 
```

viewCommonOrgList.xhtml

```
<h:form id="commonOrgList">
<table cellspacing="0" cellpadding="0" width="100%" border="0">
    <tbody>
        <tr>
            <td class="pgHdr">
                <div style="float: right">
                    <p:commandLink action="#{commonOrgPage.preCreateCommonOrg}" immediate="true" update=":createCommonOrgForm:addCommonOrg" oncomplete="addDlg.show();" styleClass="button">
                        <span>Add</span>
                    </p:commandLink>
</div></td></tr></tbody></table></h:form>
<p:dialog header="Add Common Organisation"  appendToBody="true" draggable="false" widgetVar="addDlg" resizable="false" id="addDialog" showEffect="fade" modal="true" >
    <h:form id="createCommonOrgForm">
    <h:panelGroup id="addCommonOrg">
    <ui:include src="/pages/admin/commonorg/createOrUpdateCommonOrg.xhtml"></ui:include>
    </h:panelGroup>
    </h:form>
</p:dialog> 
```

解决了将 PageBean 范围设置为“会话”的预览问题。但是如果我把`<h:outputFormat value="#{commonOrgPage.commonOrgTO.orgEffectiveFrom}"/>`而不是

```
<ui:include src="/pages/admin/commonorg/createOrUpdateCommonOrg.xhtml"></ui:include> 
```

我们可以在调用 #{commonOrgPage.preCreateCommonOrg} 操作后获取新值。但是，当我们使用`<ui:include>`对话框时无法获得新值。

# javascript - 后台代码在任何弹出点击时运行

> ID：10624931
> 
> 赞同：0
> 
> 时间：2012-05-16T18:59:51.103
> 
> 标签：javascript, google-chrome-extension

我试图在后台页面中获取登录代码，以便在浏览器启动时只运行一次。但似乎 bgpage 中的全局代码在每次单击弹出窗口时都会运行。它也在不同的范围内运行。有可能解决这个问题吗？

```
// background.js
var someCustomType = new SomeCustomType();

function SomeCustomType() {
  this.firstProperty;
}

function thisShouldBeCalledOnce() {
  someCustomType.firstProperty = 'defined';
  alert('someCustomType.firstProperty=' + someCustomType.firstProperty);
  console.log('thisShouldBeCalledOnce');
}

if (true) {
  // Alwase 'undefined'
  alert('someCustomType.firstProperty=' + someCustomType.firstProperty);
  thisShouldBeCalledOnce();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:21:22.810

简单的代码示例：

**清单.json**

```
{
  "name": "My First Extension",
  "version": "1.0",
  "manifest_version": 2,
  "description": "The first extension that I made.",
  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "popup.html"
  },
  "background": {
    "scripts": ["background.js"]
  },
  "permissions": [
    "tabs",
    "http://*/*",
    "https://*/*"
  ]
} 
```

**popup.html**：只是一些虚拟代码：

```
<html>
<head>
</head>
<body>
<div>
    <p> sometext</p>
    <button type="button">Click Me</button>
</div>
</body>
</html> 
```

**背景.js：**

```
var someCustomType = new SomeCustomType();
function SomeCustomType() {
  this.firstProperty;
}
function thisShouldBeCalledOnce() {
  someCustomType.firstProperty = 'defined';
  alert('someCustomType.firstProperty=' + someCustomType.firstProperty);
  console.log('thisShouldBeCalledOnce');
}
thisShouldBeCalledOnce(); 
```

在这种情况下，警报被触发一次，当您加载扩展程序时，当您打开弹出窗口时不会显示任何警报。问候。

# c# - WPF C#应用程序中的哈希密码

> ID：10624932
> 
> 赞同：0
> 
> 时间：2012-05-16T18:59:54.620
> 
> 标签：c#, mysql, hash

我试图创建一个远程 MySQL 数据库并将其链接到 WPF 应用程序。我设法做到了，但论坛的用户建议我对我的密码进行哈希处理，因为它很容易被 SQL 注入。我的问题是有人知道如何根据该代码创建散列密码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace ECBSRecruitmentAgencySoftware
{
    public partial class LogIn : Form
    {
        public LogIn()
        {
            InitializeComponent();
        }  

        public bool tryLogin(string username , string password)
        {
             MySqlConnection con = new MySqlConnection("host=aaaaaaaa.baaadsg;user=saaaaaak;password=2333333336;database=soaaaaaaaa2;");
             MySqlCommand cmd = new MySqlCommand("Select * FROM niki WHERE user_name = `" + username + "` AND user_password = `" + password + "`;");
             cmd.Connection = con;
             con.Open();
             MySqlDataReader reader = cmd.ExecuteReader();
             if (reader.Read() != false)
             {
                 if (reader.IsDBNull(0) == true)
                 {
                     cmd.Connection.Close();
                     reader.Dispose();
                     cmd.Dispose();
                     return false;
                 }
                 else
                 {
                     cmd.Connection.Close();
                     reader.Dispose();
                     cmd.Dispose();
                     return true;
                  }
             }
             else 
             {
                 return false;
             }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            if (tryLogin(user.Text, pass.Text) == true)
            {
                MainScreen F2 = new MainScreen();
                F2.Show();
                this.Hide();
            }            
            else 
                MessageBox.Show("Wrong details!");             
        } 
    }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T19:17:51.813

.NET 支持多种加密哈希，包括 MD5 和 SHA，因此使用`ComputeHash`这些类的方法很容易对您的密码进行哈希处理......

下面是一个使用 MD5 对文件进行哈希处理的简单示例，可以轻松地将其转换为生成密码哈希：

```
 using (var md5 = new MD5CryptoServiceProvider())
        {
            var buffer = md5.ComputeHash(File.ReadAllBytes(filename));
            var sb = new StringBuilder();
            for (var i = 0; i < buffer.Length; i++)
            {
                sb.Append(buffer[i].ToString("x2"));
            }
            return sb.ToString();
        } 
```

别忘了给你的哈希加盐……

实际上，最好只是阅读这篇关于在 CP 上将密码存储在数据库中的精彩文章......

[存储密码的艺术与科学](http://www.codeproject.com/Articles/14537/The-Art-Science-of-Storing-Passwords)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T19:17:11.517

您将使用散列算法提供程序，例如 SHA256。

```
var hasher = new SHA256Managed();
var unhashed = System.Text.Encoding.Unicode.GetBytes(password);
var hashed = hasher.ComputeHash(unhashedPassword); 
```

现在，为了在 SQL 查询中进行存储和比较，您需要将字节转换为字符串表示形式，例如 Base64Encoded。

```
var hashedPassword = Convert.ToBase64String(hashed); 
```

现在您可以在查询中使用 hashedPassword 的值。

*然而...*

您还应该考虑为整个应用程序生成一个盐值，或者更好的是，为每个用户生成一个盐值。您需要表中的一列来存储它，并在每次更改密码时为每个用户随机生成它。然后你会使用这样的东西来创建散列密码：

```
static byte[] GenerateSaltedHash(string plainText, string salt)
{
HashAlgorithm algorithm = new SHA256Managed();

byte[] plainTextBytes = System.Text.Encoding.Unicode.GetBytes(plainText);
byte[] saltBytes = Convert.FromBase64String(salt);

byte[] plainTextWithSaltBytes = new byte[plainTextBytes.Length + saltBytes.Length];
salt.CopyTo(plainTextWithSaltBytes, 0);
plainText.CopyTo(plainTextWithSaltBytes, salt.Length); 

byte[] hash = algorithm.ComputeHash(plainTextWithSaltBytes);

return hash;
} 
```

**把它们放在一起...**

```
// omitted

namespace ECBSRecruitmentAgencySoftware
{
    public partial class LogIn : Form
    {
        // omitted

    static byte[] GenerateSaltedHash(string plainText, string salt)
    {
       HashAlgorithm algorithm = new SHA256Managed();

       byte[] plainTextBytes = System.Text.Encoding.Unicode.GetBytes(plainText);
       byte[] saltBytes = Convert.FromBase64String(salt);

       byte[] plainTextWithSaltBytes = new byte[plainTextBytes.Length + saltBytes.Length];
       salt.CopyTo(plainTextWithSaltBytes, 0);
       plainText.CopyTo(plainTextWithSaltBytes, salt.Length); 

       byte[] hash = algorithm.ComputeHash(plainTextWithSaltBytes);

       return hash;
    }

        public bool tryLogin(string username , string password)
        {
             using (var con = new MySqlConnection("host=aaaaaaaa.baaadsg;user=saaaaaak;password=2333333336;database=soaaaaaaaa2;"))
             {
                 con.Open();

                 var salt = string.Empty;

                 using (var cmd = new MySqlCommand("Select salt From niki where user_name = @username"))
                 {
                     cmd.Parameters.AddWithValue("@username", username);

                     salt = cmd.ExecuteScalar() as string;
                 }

                 if (string.IsNullOrEmpty(salt)) return false;

                 var hashedPassword = GenerateSaltedHash(password, salt);

                 using (var cmd = new MySqlCommand("Select * FROM niki WHERE user_name = @username and user_password = @password"))
                 {
                    cmd.Parameters.AddWithValue("@username", username);
                    cmd.Parameters.AddWithValue("@password", hashedPassword);

                    using (var reader = cmd.ExecuteReader())
                    {
                         return reader.Read();
                    }
                 }
             }
        }

        // omitted
    }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T19:32:39.793

我不相信您将能够使用此代码进行安全的身份验证。

首先，您将密码存储到您的代码中的数据库中。因此，任何人都可以使用 Reflector 或任何其他 .NET 反编译器将密码提取到数据库。然后，拥有完整的连接字符串，任何人都可以连接到您的数据库并破坏它（例如，窃取所有用户密码）。即使您使用混淆工具，仍然可以从您的应用程序中提取此字符串。

所以实际上并不重要，你是否会散列用户密码 - 任何人都可以访问你的系统。

执行密码验证的更安全的方法是创建多层系统，因此 WPF 应用程序不能直接访问数据库，它用户*应用程序服务器*对数据执行任何操作。对于通信，您可以使用 Web 服务、WCF。到您的数据库的连接字符串将仅存储在应用程序服务器中。

现在哈希呢。

您必须找出为什么要使用哈希。您可以使用哈希将其存储在数据库中（因此明确的密码不会存储在任何地方）。您可以使用哈希通过网络发送密码，因此即使消息被截获，也没有人会发现清晰的密码）。或者您可以同时使用哈希。

如果您将密码哈希存储在数据库中，您应该研究在 ASP.NET 会员提供程序中构建的数据库方案。

根据您选择的选项，您可以实施实际的密码验证。

实际上，如何计算哈希并不重要。它只需要足够强大的哈希算法，例如 .NET Framework 中内置的 SHA512。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T19:11:44.747

创建一个函数来为你做这件事：

这是 asp.NET

```
public static string PasswordHasher(string Password)
{
return FormsAuthentication.HashPasswordForStoringInConfigFile(Password,     
System.Web.Configuration.FormsAuthPasswordFormat.SHA1);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-03T05:10:49.883

.Net 内置了对 MD5 哈希算法和许多其他哈希算法的支持。微软网站上有一个很好的例子：[https](https://msdn.microsoft.com/en-us/library/system.security.cryptography.md5(v=vs.110).aspx#Examples) ://msdn.microsoft.com/en-us/library/system.security.cryptography.md5(v=vs.110).aspx#Examples 。

要了解有关如何以及为什么需要散列的更多信息，您可以查看此站点：[https ://www.codeproject.com/Articles/704865/Salted-Password-Hashing-Doing-it-Right](https://www.codeproject.com/Articles/704865/Salted-Password-Hashing-Doing-it-Right)

# javascript - Javascript（不是 JQuery）..调用锚点的 OnClick 事件

> ID：10624934
> 
> 赞同：0
> 
> 时间：2012-05-16T18:59:58.557
> 
> 标签：javascript, javascript-events

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:03:31.827

你可以试试 raiseEvent，但我不确定它是否是跨浏览器的。

# python - 仅在 Python 中将 datetime 对象转换为日期字符串

> ID：10624937
> 
> 赞同：388
> 
> 时间：2012-05-16T19:00:02.917
> 
> 标签：python, datetime

我看到很多关于将日期字符串转换为`datetime`Python 中的对象的方法，但我想换一种方式。
我有

```
datetime.datetime(2012, 2, 23, 0, 0) 
```

我想将它转换为字符串，如`'2/23/2012'`.

* * *

## 回答 #1

> 赞同：605
> 
> 时间：2012-05-16T19:01:39.947

您可以使用[strftime](http://docs.python.org/2/library/time.html#time.strftime)来帮助您格式化日期。

例如，

```
import datetime
t = datetime.datetime(2012, 2, 23, 0, 0)
t.strftime('%m/%d/%Y') 
```

将产生：

```
'02/23/2012' 
```

有关格式化的更多信息，请参见[此处](http://docs.python.org/library/datetime.html#strftime-strptime-behavior)

* * *

## 回答 #2

> 赞同：238
> 
> 时间：2016-03-03T19:11:43.040

`date`和`datetime`对象（`time`以及）支持一种[迷你语言来指定输出](https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior)，并且有两种方法可以访问它：

*   [直接方法调用](https://docs.python.org/3/library/datetime.html#datetime.date.strftime)：`dt.strftime('format here')`
*   [格式化方法](https://docs.python.org/3/library/functions.html#format)（python 2.6+）：`'{:format here}'.format(dt)`
*   [f 字符串](https://realpython.com/python-f-strings/)（python 3.6+）：`f'{dt:format here}'`

因此，您的示例可能如下所示：

*   `dt.strftime('The date is %b %d, %Y')`
*   `'The date is {:%b %d, %Y}'.format(dt)`
*   `f'The date is {dt:%b %d, %Y}'`

在所有三种情况下，输出都是：

> 日期为 2012 年 2 月 23 日

为了完整起见：您也可以直接访问对象的属性，但是您只能获得数字：

```
'The date is %s/%s/%s' % (dt.month, dt.day, dt.year)
# The date is 02/23/2012 
```

花时间学习迷你语言是值得的。

* * *

作为参考，以下是迷你语言中使用的代码：

*   `%a` 工作日作为语言环境的缩写名称。
*   `%A` 工作日作为语言环境的全名。
*   `%w` 工作日为十进制数，其中 0 是星期日，6 是星期六。
*   `%d` 以零填充十进制数表示的月份中的日期。
*   `%b` 月份作为语言环境的缩写名称。
*   `%B` 月份作为语言环境的全名。
*   `%m` 以零填充十进制数表示的月份。01, ..., 12
*   `%y` 没有世纪的年份作为零填充的十进制数。00, ..., 99
*   `%Y` 带有世纪的年份作为十进制数。1970、1988、2001、2013
*   `%H` 小时（24 小时制）作为零填充十进制数。00, ..., 23
*   `%I` 小时（12 小时制）作为零填充十进制数。01, ..., 12
*   `%p` 区域设置相当于 AM 或 PM。
*   `%M` 分钟作为一个零填充的十进制数。00, ..., 59
*   `%S` 第二个作为零填充的十进制数。00, ..., 59
*   `%f` 微秒作为十进制数，在左侧补零。000000, ..., 999999
*   `%z` UTC 偏移量，格式为 +HHMM 或 -HHMM（如果不成熟则为空）、+0000、-0400、+1030
*   `%Z` 时区名称（如果幼稚则为空）、UTC、EST、CST
*   `%j` 一年中的一天，作为一个零填充的十进制数字。001, ..., 366
*   `%U` 一年中的周数（星期日是第一个），以零填充十进制数表示。
*   `%W` 以十进制数表示的一年中的周数（星期一是第一个）。
*   `%c` 语言环境的适当日期和时间表示。
*   `%x` 语言环境的适当日期表示。
*   `%X` 语言环境的适当时间表示。
*   `%%` 文字 '%' 字符。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2016-03-09T14:19:35.063

另外的选择：

```
import datetime
now=datetime.datetime.now()
now.isoformat()
# ouptut --> '2016-03-09T08:18:20.860968' 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-05-16T19:04:05.370

您可以使用简单的字符串格式化方法：

```
>>> dt = datetime.datetime(2012, 2, 23, 0, 0)
>>> '{0.month}/{0.day}/{0.year}'.format(dt)
'2/23/2012'
>>> '%s/%s/%s' % (dt.month, dt.day, dt.year)
'2/23/2012' 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2019-04-26T16:13:02.357

如果您正在寻找一种简单的`datetime`字符串转换方法并且可以省略格式。您可以将`datetime`对象转换为`str`然后使用数组切片。

```
In [1]: from datetime import datetime

In [2]: now = datetime.now()

In [3]: str(now)
Out[3]: '2019-04-26 18:03:50.941332'

In [5]: str(now)[:10]
Out[5]: '2019-04-26'

In [6]: str(now)[:19]
Out[6]: '2019-04-26 18:03:50' 
```

但请注意以下事项。`AttributeError`如果在这种情况下，当变量出现其他解决方案时，`None`您将收到一个`'None'`字符串。

```
In [9]: str(None)[:19]
Out[9]: 'None' 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2016-02-10T02:28:21.253

[**`type-specific formatting`**](https://docs.python.org/2/library/string.html#format-examples)也可以使用：

```
t = datetime.datetime(2012, 2, 23, 0, 0)
"{:%m/%d/%Y}".format(t) 
```

输出：

```
'02/23/2012' 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2019-07-11T17:36:50.273

如果你也想要时间，那就去吧

```
datetime.datetime.now().__str__() 
```

`2019-07-11 19:36:31.118766`为我在控制台中打印

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2021-04-01T10:53:56.853

您可以通过这种方式轻松地将日期时间转换为字符串：

```
from datetime import datetime

date_time = datetime(2012, 2, 23, 0, 0)
date = date_time.strftime('%m/%d/%Y')
print("date: %s" % date) 
```

以下是一些可用于将日期时间转换为字符串的模式：

[![日期时间到字符串模式](../Images/d23bf30faa1ea8e6602964515b730c03.png)](https://i.stack.imgur.com/Quv1b.jpg)

为了更好地理解，你可以看看这篇关于[如何在 Python 中将字符串转换为日期时间和日期时间为字符串的](https://www.polynique.com/programming-languages/python-string-to-datetime-and-datetime-to-string/)文章或[官方`strftime`文档](https://docs.python.org/3/library/datetime.html)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2020-07-02T17:53:15.287

迄今为止最性感的版本是格式字符串。

```
from datetime import datetime

print(f'{datetime.today():%Y-%m-%d}') 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-05-23T15:02:22.977

通过直接使用 datetime 对象的组件，可以将 datetime 对象转换为字符串。

```
from datetime import date  

myDate = date.today()    
#print(myDate) would output 2017-05-23 because that is today
#reassign the myDate variable to myDate = myDate.month 
#then you could print(myDate.month) and you would get 5 as an integer
dateStr = str(myDate.month)+ "/" + str(myDate.day) + "/" + str(myDate.year)    
# myDate.month is equal to 5 as an integer, i use str() to change it to a 
# string I add(+)the "/" so now I have "5/" then myDate.day is 23 as
# an integer i change it to a string with str() and it is added to the "5/"   
# to get "5/23" and then I add another "/" now we have "5/23/" next is the 
# year which is 2017 as an integer, I use the function str() to change it to 
# a string and add it to the rest of the string.  Now we have "5/23/2017" as 
# a string. The final line prints the string.

print(dateStr) 
```

输出 --> 2017 年 5 月 23 日

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-06-06T17:33:02.977

您可以将日期时间转换为字符串。

```
published_at = "{}".format(self.published_at) 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-03-07T13:44:56.410

字符串连接，`str.join`，可用于构建字符串。

```
d = datetime.now()
'/'.join(str(x) for x in (d.month, d.day, d.year))
'3/7/2016' 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-05T04:37:04.337

end_date = "2021-04-18 16:00:00"

end_date_string = end_date.strftime("%Y-%m-%d")

打印（结束日期字符串）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-10-27T02:46:19.247

**距离现在有多远**的方法

 ***   通过传入 param 来支持不同的语言`li`，一个列表对应的时间戳。

```
from datetime import datetime
from dateutil import parser

t1 = parser.parse("Tue May 26 15:14:45 2021")
t2 = parser.parse("Tue May 26 15:9:45 2021")
# 5min
t3 = parser.parse("Tue May 26 11:14:45 2021")
# 4h
t4 = parser.parse("Tue May 26 11:9:45 2021")
# 1day
t6 = parser.parse("Tue May 25 11:14:45 2021")
# 1day4h
t7 = parser.parse("Tue May 25 11:9:45 2021")
# 1day4h5min
t8 = parser.parse("Tue May 19 11:9:45 2021")
# 1w
t9 = parser.parse("Tue Apr 26 11:14:45 2021")
# 1m
t10 = parser.parse("Tue Oct 08 06:00:20 2019") 
# 1y7m, 19m
t11 = parser.parse("Tue Jan 08 00:00:00 2019") 
# 2y4m, 28m

# create: date of object creation
# now: time now
# li: a list of string indicate time (in any language)
# lst: suffix (in any language)
# long: display length
def howLongAgo(create, now, li, lst, long=2):
    dif = create - now
    print(dif.days)
    sec = dif.days * 24 * 60 * 60 + dif.seconds
    minute = sec // 60
    sec %= 60
    hour = minute // 60
    minute %= 60
    day = hour // 24
    hour %= 24
    week = day // 7
    day %= 7
    month = (week * 7) // 30
    week %= 30
    year = month // 12
    month %= 12
    s = []
    for ii, tt in enumerate([sec, minute, hour, day, week, month, year]):
        ss = li[ii]
        if tt != 0:
            if tt == 1:
                s.append(str(tt) + ss)
            else:
                s.append(str(tt) + ss + 's')

    return ' '.join(list(reversed(s))[:long]) + ' ' + lst

t = howLongAgo(t1, t11, [
    'second', 
    'minute',
    'hour', 
    'day',
    'week', 
    'month',
    'year',
], 'ago')
print(t)
# 2years 4months ago 
```**

# jquery - 如何通过单击按钮链接表格输出（也可通过 json 格式的 url 获得）和谷歌地图？

> ID：10624945
> 
> 赞同：0
> 
> 时间：2012-05-16T19:00:18.657
> 
> 标签：jquery, json, google-maps

我有一种情况，我有动态表/网格输出，它也由带有谷歌地图有效 json 输出（例如标记）的动态 url 表示。一切都可以正常工作，例如使用静态 json 文件的输入。

当我有新的 table/grid/json-by-url 输出时，我想要一个通过单击按钮来更新地图（例如标记）的选项。无需点击的自动地图更新也是一种选择。

到目前为止，我正在使用 Jquery/Json-input/Google Maps 组合。

请有人能给我一些指导方向或一篇关于如何做的文章吗？

最好的问候彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:05:10.447

我相信`jquery-ui-map`可能对你有用：

[https://code.google.com/p/jquery-ui-map/wiki/jquery_ui_map_v_3_sample_code](https://code.google.com/p/jquery-ui-map/wiki/jquery_ui_map_v_3_sample_code)

它似乎允许动态添加标记。

添加/删除示例：

[http://jquery-ui-map.googlecode.com/svn/trunk/demos/jquery-google-maps-geocoding.html](http://jquery-ui-map.googlecode.com/svn/trunk/demos/jquery-google-maps-geocoding.html)

# c# - 按月生成水晶报表？

> ID：10624948
> 
> 赞同：1
> 
> 时间：2012-05-16T19:00:27.200
> 
> 标签：c#, winforms, crystal-reports

我有一个 mComboBox，其中包含月份名称列表。我有一个 sql 表

```
InstallmentTable
    ID
    CurrentMonth
    Installment
    Commission 
```

我想生成水晶报告，其中**CurrentMonth = mComboBoxSelectedMonth**我是水晶报告的初学者，请指导我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T07:40:05.133

可以有两种方法来做这件事

1）首先，您必须在前端根据组合值过滤数据表，并使用 SetDataSource() 函数将过滤后的数据表重新分配给水晶报表。

2）其次，您可以根据您的组合值过滤数据库端的记录，然后将新数据表重新分配给水晶。

没有直接的方法可以在水晶报表级别过滤记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T13:51:17.953

在您的报告中使用选择公式......

```
{dailysummary2.date} >= cdate(year(currentdate),(Month ({?startdate})),1) 
```

和

```
{dailysummary2.date} < dateserial(year(currentdate),(Month ({?startdate}))+1,1) 
```

# php - 根据页面在主题 header.php 中设置 cookie - wordpress

> ID：10624949
> 
> 赞同：1
> 
> 时间：2012-05-16T19:00:27.997
> 
> 标签：php, wordpress, cookies, wordpress-theming, setcookie

我正在尝试在我的 wordpress 主题 header.php 文件中设置一个 cookie。

我找到了一些关于此的信息，但似乎都使用了 functions.php 文件，这对我来说并不是一个真正的选择，因为我正在根据页面设置 cookie。

我只是想知道我该怎么做，或者可能的解决方法是什么。

这是我的 header.php 文件中的代码。

```
<?
// Set cookie
if (is_page('437')) {
  setcookie("DM", "mis", time()+31536000);
} else if (is_page('441')) {
  setcookie("DM", "w2p", time()+31536000);
}

echo $_COOKIE["DM"];
print_r($_COOKIE);

// Check cookie to load style
if (!is_front_page()){ 
  if (isset($_COOKIE["DM"])) {
    if ($_COOKIE["DM"] == "mis") { ?>
      <link rel="stylesheet" type="text/css" media="all" href="<?php bloginfo('template_directory'); ?>/css/mis.css" />
  <? } else if ($_COOKIE["DM"] == "w2p") { ?>
      <link rel="stylesheet" type="text/css" media="all" href="<?php bloginfo('template_directory'); ?>/css/w2p.css" />
   <? }
  }
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T19:03:53.550

设置 cookie，将其排队发送到客户端，但不会将其添加到 $_COOKIE 数组中。我相信 $_COOKIE 数组仅在初始请求时构造和填充一次。您想要访问的任何 cookie 都会发送到客户端，并在下一页的以下请求中发回，然后可用。

# php - 如何在mongo php中使用多个条件进行计数

> ID：10624953
> 
> 赞同：0
> 
> 时间：2012-05-16T19:00:41.420
> 
> 标签：php, mongodb

我是mongodb的新手。我认为 mongo shell 和 php mongo 驱动程序之间存在一些使用差异。

我可以在 mongo shell 中计算多个标准。例如：

```
db.coll.count( { _id:ObjectId('4fb27b9c876b88e53d000000'), 
                 'items.title':'example' } ); 
```

但我不能用 php mongo 驱动程序做同样的计算。我试过了，但它返回 0。

```
$coll->count( array('_id'=>new MongoID('4fb27b9c876b88e53d000000'), 
                    'items.title'=>'example' ) ); 
```

但是，如果我使用 find() 然后 count()，我会得到相同的计数结果：

```
$coll->find( array('_id'=>new MongoID('4fb27b9c876b88e53d000000'), 
                   'items.title'=>'example' ) ).count(); 
```

我得到了我想要的，但我认为链接方式可能效率低下。我错了吗？

你怎么能用多个标准来计算？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T05:55:45.473

一个代码示例值一千字。看：

```
% mongo
MongoDB shell version: 2.1.1
connecting to: test
> db.foo.count
function (x) {
    return this.find(x).count();
} 
```

这是否回答你的问题？:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:48:17.697

您必须首先使用 find() 而不是 count()

```
db.foo.count() -- will return 0, because db.foo it is only accessing the collection

db.foo.find($where).count() --- will return the number of documents in the collection 
```

这是如何做到的。

# postgresql - Postgresql 更新基于计数、最小值和分组依据

> ID：10624957
> 
> 赞同：0
> 
> 时间：2012-05-16T19:01:04.137
> 
> 标签：postgresql, select, command-line, group-by, min

感谢您花时间看我的问题。我见过类似的问题，但深度不同。请帮忙！

我想更新包含 user_id 和 date_created 的表中所有行的列，其中 user_id 的 date_created 最低。

以下选择为我提供了我想要更新的所有行：

```
select user_id, min(date_created) from mytable s1 where 
    (select count(1) from mytable s2 where 
        s1.user_id = s2.user_id group by s2.user_id) 
 > 1 group by user_id order by user_id; 
```

我本来希望这个更新能够工作：

```
update mytable set join_status = 1 where date_created = 
    (select min(date_created) from mytable s1 where 
        (select count(1) from simplepay_payment s2 where 
            s1.user_id = s2.user_id group by s2.user_id)
  > 1 group by user_id); 
```

但是给出了以下错误：

```
ERROR:  more than one row returned by a subquery used as an expression 
```

我尝试了几种不同的解决方案，但似乎没有任何帮助。

有人对我有什么想法吗？

再次感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T19:26:16.567

将您的 SQL 更改为：

```
update mytable set join_status = 1 where date_created IN
    (select min(date_created) from mytable s1 where 
        (select count(1) from simplepay_payment s2 where 
            s1.user_id = s2.user_id group by s2.user_id)
  > 1 group by user_id); 
```

[在文档](http://www.postgresql.org/docs/current/interactive/functions-comparisons.html)中阅读有关行比较的更多信息。

* * *

**编辑：**

在您正在执行的子查询中`GROUP BY user_id`。这意味着您*将*收到许多行，具体取决于`simplepay_payment`表中唯一 user_id 值的数量。

为了使您的查询按预期工作，您应该使用 2 列加入：`user_id`和`date_created`. 正如您所提到的，您已经有了可以为您提供正确结果的查询，因此您可以像这样使用它：

```
WITH desired AS (
  SELECT user_id, min(date_created) AS mindt
    FROM mytable s1 where 
      (SELECT count(1) FROM mytable s2
        WHERE s1.user_id = s2.user_id GROUP BY s2.user_id) > 1
   GROUP BY user_id)
UPDATE mytable m SET join_status = 1 FROM desired d
 WHERE d.user_id = m.user_id AND d.mindt = m.date_created; 
```

我已将您的查询包装到[公用表表达式](http://www.postgresql.org/docs/current/interactive/queries-with.html)中并在`UPDATE`语句中使用它。您可以`RETURNING m.*`在查询末尾添加以查看已更新的行及其新值。

[您可以在SQL Fiddle](http://www.sqlfiddle.com/#!1/15d6f/2)上测试此查询。

* * *

**编辑2：**

`UPDATE`公用表表达式（WITH 查询）在 9.1 版之前对语句不可用。您可以简单地将 CTE 子查询移动到更新中，如下所示：

```
UPDATE mytable m SET join_status = 1 FROM (
  SELECT user_id, min(date_created) AS mindt
    FROM mytable s1 where 
      (SELECT count(1) FROM mytable s2
        WHERE s1.user_id = s2.user_id GROUP BY s2.user_id) > 1
   GROUP BY user_id) d
 WHERE d.user_id = m.user_id AND d.mindt = m.date_created; 
```

# zend-framework - Zend 视图脚本路径设置

> ID：10624962
> 
> 赞同：3
> 
> 时间：2012-05-16T19:01:10.063
> 
> 标签：zend-framework, templates, zend-view

这是我的代码：

```
$this->getView()->setScriptPath($templatePath);
$this->_helper->viewRenderer($page); 
```

此代码在 Core_PageController 视图操作中处理。我现在遇到的问题是视图对象在其中查找我的脚本文件，`$templatePath/page`因为页面是控制器。我想要的是视图对象只查看`$templatePath`目录路径（没有页面目录）；

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T20:29:36.727

您可以指示`ViewRenderer`不要将控制器名称用作视图脚本路径的一部分。

为此，请尝试：

```
$this->_helper
     ->viewRenderer
     ->setNoController(true); // do not use controller name as part of the view path 
```

> **setNoController($flag = true)**可用于告诉**render()**不要在以控制器命名的子目录中查找操作脚本（这是默认行为）。**getNoController()**检索当前值。

有关[ViewRenderer 助手](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelpers.viewrenderer)的更多信息。

# mongodb - 在同一数据库中复制集合的最快方法是什么？

> ID：10624964
> 
> 赞同：97
> 
> 时间：2012-05-16T19:01:15.353
> 
> 标签：mongodb

我想在**同一个**数据库中复制一个集合并给它一个不同的名称 - 基本上是拍摄快照。

最好的方法是什么？是否有命令，或者我必须依次复制每条记录？

我知道该`cloneCollection`命令，但它似乎仅用于复制到另一台服务器。

我也知道`mongoimport`and `mongoexport`，但是当我通过 PHP 执行此操作时，我不想调用 shell。

* * *

## 回答 #1

> 赞同：264
> 
> 时间：2015-11-24T08:55:04.107

```
db.myoriginal.aggregate([ { $match: {} }, { $out: "mycopy" } ]) 
```

它比在 forEach 循环中进行多次插入要快得多。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-05-16T21:36:29.913

您有几个选择，但最快的是：

```
mongodump -d db -c sourcecollection 
mongorestore -d db -c targetcollection --dir=dump/<db>/<sourcecollection.bson> 
```

或者

```
mongoexport -d db -c sourcecollection | mongoimport -d db -c targetcollection --drop 
```

或在 php 中：

```
`mongoexport -d db -c sourcecollection | mongoimport -d db -c targetcollection --drop`; 
```

之后你有

```
mongo db < script.js 
```

其中，如[mongo docs](http://www.mongodb.org/display/DOCS/Developer+FAQ#DeveloperFAQ-HowdoIcopyallobjectsfromonedatabasecollectiontoanother?)所示，script.js 包含以下内容：

```
db.myoriginal.find().forEach( function(x){db.mycopy.insert(x)} ); 
```

复制集合的最慢（一个数量级或更多）方法是使用本机 php 驱动程序 - 仅仅是因为移动信息。但是，如果您绝对想避免使用[db 执行](http://www.php.net/manual/en/mongodb.execute.php)功能的 cli 调用，则可以发出上述 mongo 查询。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-01-19T17:42:27.133

**注意：**阅读答案**更新**，它们很重要！

* * *

最简单有效的方法是使用[copyTo()](http://docs.mongodb.org/manual/reference/method/db.collection.copyTo/)，因此您可以使用：

```
db.source.copyTo("target"); 
```

& 如果`"target"`不存在，将被创建

**- 更新 -**

根据[CopyTo Documentation](http://docs.mongodb.org/manual/reference/method/db.collection.copyTo/#behavior)，因为`copyTo()`在内部使用 eval ，所以复制操作将阻塞 mongod 实例上的所有其他操作。所以它**不应该在生产**环境中使用。

**- 更新 -**

因为在内部`CopyTo()`使用&自 3.0 版以来已弃用，所以**自 3.0 版以来也已弃用**。[`eval()`](http://docs.mongodb.org/manual/reference/command/eval/#dbcmd.eval)`eval()`**`CopyTo()`**

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-02-10T09:29:30.130

***第一个选项（使用 mongo 转储）***

1.  从集合中获取转储

    mongodump -d db -c source_collection

2.  从收藏中恢复

    mongorestore -d db -c target_collection dir=dump/db_name/source_collection.bson

***第二种选择***

1.  运行骨料

    db.getCollection('source_collection').aggregate([ { $match: {"emailAddress" : "apitester@mailinator.com"} }, { $out: "target_collection" } ])

***第三个选项（最慢）***

1.  运行一个 for 循环

    db.getCollection('source_collection').find().forEach(function(docs){ db.getCollection('target_collection').insert(docs); }) print("回滚完成！");

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-08T11:28:25.533

除了 AD7six 1st 解决方案，如果您使用 mongoexport / import，请确保您的集合数据类型和 mongo 配置，如下所述：http: [//docs.mongodb.org/manual/reference/mongodb-extended-json/](http://docs.mongodb.org/manual/reference/mongodb-extended-json/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-24T13:34:03.563

这是我在 python (pymongo) 中的实现：

```
def copy_collection(client, from_db, from_coll, to_db=None, to_coll=None):
    to_db = from_db if to_db is None else to_db
    to_coll = from_coll if to_coll is None else to_coll
    assert (to_db != from_db or to_coll != from_coll), "Copy Error: Source and destination can't be same!"
    documents = client[from_db][from_coll].find()
    client[to_db][to_coll].insert_many([d for d in documents]) 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-01-12T12:27:15.363

最快的方法是[db.collection.copyTo()](https://docs.mongodb.com/manual/reference/method/db.collection.copyTo/)。

请注意，自 3.0 版起已弃用。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2013-11-10T09:32:08.577

您可以在 mongo shell 中使用 copyDatabase 函数：

[http://docs.mongodb.org/manual/tutorial/copy-databases-between-instances/](http://docs.mongodb.org/manual/tutorial/copy-databases-between-instances/)

# django - 带有本地 smtp 的 Django 电子邮件后端

> ID：10624965
> 
> 赞同：6
> 
> 时间：2012-05-16T19:01:16.843
> 
> 标签：django, smtp, django-mailer

我想从 django 应用程序发送电子邮件。

我想从其他用户名向我的邮件 ID 发送一封电子邮件而无需身份验证。只是我将 smtp 服务器用于经过身份验证的邮件。在 django 邮件 api 中它应该如何使用本地 smtp 发送邮件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T20:37:59.393

如文档所述：[https://docs.djangoproject.com/en/dev/topics/email/?from=olddocs](https://docs.djangoproject.com/en/dev/topics/email/?from=olddocs)您需要：

*   在您`settings.py`定义以下内容：

    EMAIL_HOST = '本地主机' EMAIL_PORT = 1025

*   然后，在另一个 shell 中运行以下命令：

    python -m smtpd -n -c DebuggingServer localhost:1025

这将运行一个虚拟 SMTP 服务器，它实际上不会发送任何电子邮件，但您将能够看到输出并检查它是否正确。如果您想在开发过程中*实际*发送电子邮件，则需要安装像 sendmail 这样的 SMTP 服务器并在您的配置中使用它。

# php - 使用 php 搜索数据并从文本文件中删除数据

> ID：10624966
> 
> 赞同：0
> 
> 时间：2012-05-16T19:01:17.467
> 
> 标签：php, search, text

我有一个程序可以将数据列表导出到 .txt 文件中，很多数据是不需要的。每条数据的格式如下：

```
PUB DATE: 03/16/2012
END DATE: 06/10/2012
PUB:  my company
ADNUM: 00237978
CLASS: 0825
AD TYPE: RE
COLUMNS: 2.00
GRAPHIC FILE: some_image.jpg
AD TEXT: Text
*** end of ad 
```

将有 20 到 50 条这样的记录，我需要做的是搜索文件并删除具有以 0 开头的 CLASS 的记录。因此，如果它搜索并找到具有以 0 开头的 CLASS 的广告记录它将删除该记录中的所有内容。如果它是 .xml 但它是一个 .txt 文件，这将很容易，所以它使事情变得困难。一旦它删除了所有坏数据，它将把好的数据保存在一个新文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:30:49.867

```
$keep = array();
$filePath = '/path/to/txt/file.txt';
$textData = file_get_contents($filePath);
$records = explode('*** end of ad', $textData);
foreach ($records as $record) {
    if (empty($record)) {
        continue;
    }

    if ( ! preg_match('/CLASS:\s+?0/', $record)) {
        $endDate = array();
        preg_match('/END\sDATE:\s?\d{0,2}\/\d{0,2}\/\d{0,4}/', $record, $endDate);
        if ( ! empty($endDate)) {
            $parts = explode(':', $endDate[0]);
            $dateString = trim($parts[1]);
            $date = DateTime::createFromFormat('d/m/Y', $dateString);
            $currentDate = new Date();
            $currentDate->setTime(0, 0, 0);
            if ($currentDate->format('U') > $date->format('U')) {
                continue;
            }
        }
        $keep[] = $record;
    }
}
file_put_contents($filePath, implode('*** end of ad', $keep) . '*** end of ad'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:07:43.857

```
$keep = array;
foreach(explode('*** end of ad', file_get_contents($filePath) as $record):
  if(!preg_match('^CLASS:\s*0825'/, $record))
    $keep[] = $record;
endforeach;

file_put_contents($filePath, implode('*** end of ad', $keep) . '*** end of ad'); 
```

# asp.net-mvc-3 - MVC3中的多个下拉列表回发

> ID：10624973
> 
> 赞同：0
> 
> 时间：2012-05-16T19:02:07.770
> 
> 标签：asp.net-mvc-3, razor

我在视图上有以下代码：

```
@using (Html.BeginForm()) {

    <div class="select-box form">
        <p>
            <strong>Select transcript name to view:</strong>
            @Html.DropDownList("license", (SelectList)ViewBag.Licenses, new { onchange = "this.form.submit();" })
        </p>
    </div>
    <div class="select-box form">
        <p>
            <strong>You may have multiple periods for each transcript name:</strong>
            @Html.DropDownList("period", (SelectList)ViewBag.Periods, new { onchange = "this.form.submit();" })
        </p>
    </div>
} 
```

我需要根据哪个下拉菜单导致回发来实现一些逻辑。我正在考虑在提交表单之前添加一个隐藏的输入并通过 jQuery 设置控件名称的值，但我想知道是否有一种“本机”方法可以做到这一点。

这是我的控制器签名：

```
public ActionResult Checklist(int license, int period) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:08:28.953

我会将一个类应用于下拉列表，以便我的 jQuery 可以将其用作选择器标准

```
 @Html.DropDownList("license", (SelectList)ViewBag.Licenses, new { @class="mySelect"})
 @Html.DropDownList("period", (SelectList)ViewBag.Periods, new { @class="mySelect"})
 <input type="hidden" id="source" name="source" value="" /> 
```

脚本是

```
$(function(){

 $(".mySelect").change(function(){
   var itemName=$(this).attr("name");
   $("#source").val(itemName);
    $("form").submit()
 });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-01T13:33:39.123

使用这样的东西。（这里你调用的是 action 方法而不是提交表单）

哪个下拉菜单会导致更改将非零值传递给操作方法，另一个将传递 0。

```
 @Html.DropDownList("license", (SelectList)ViewBag.Licenses, new { onchange = "document.location.href = '/ControllerName/Checklist?license=' + this.options[this.selectedIndex].value + '&period=0'" })
 @Html.DropDownList("period", (SelectList)ViewBag.Periods, new { onchange = "document.location.href = '/ControllerName/Checklist?license=0&period=' + this.options[this.selectedIndex].value;" }) 
```

希望这可以帮助！

# java - 如何在 Infinispan 中使用 JTA 事务？

> ID：10624975
> 
> 赞同：2
> 
> 时间：2012-05-16T19:02:08.887
> 
> 标签：java, concurrency, transactions, jta, infinispan

Infinispan[文档](https://docs.jboss.org/author/display/ISPN/Infinispan+transactions)说了很多关于其锁定方案的内容，乐观和悲观，但没有详细说明如何使用事务。可能它被认为是知道的，因为它使用Java的默认API，但如果是这样，我也没有找到关于JTA使用模式的信息。

我假设，当使用乐观事务时，它将被提交或回滚，这取决于对数据的并发访问，如果它被回滚，我将能够重播事务，希望现在它可以完成在其他并发访问之前并且会成功。我在 TransactionManager 上有 begin()、commit() 和 rollback() 方法，以及记录不充分的异常，我不确定它们何时会被抛出。有了这些信息，我编写了以下代码：

```
public void transactionSum(Key key, Long delta) {
    boolean redo;
    do{
        redo = false;
        try {
            tm.begin();
            try {
                Long value = cache.get(key);
                // Some processing:
                value += delta;
                cache.put(key, value);
                tm.commit();
            } catch(CacheException e) {
                tm.rollback();
                throw new RollbackException();
            }
        } catch (RollbackException e) {
            redo = true;
            logger.debug("Cache transaction collision, replaying it.");
        } catch (Exception e) {
            logger.error(e.getMessage());
        }
    } while(redo);
} 
```

这段代码正确吗？执行一个据说很常见的操作似乎过于复杂，因此我怀疑我做错了什么......如果失败`CacheException`会抛出一些吗？`cache.put()`如果是这样，我应该明确打电话`tm.rollback()`吗？如果我`tm.commit()`在`finally`子句中调用怎么办？它什么时候会抛出一个`RollbackException`？

更重要的是，是否有一些惯用语/默认方式来执行事务重播？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T12:49:11.567

正确的模式是：

```
Transaction tx = tm.begin();
try
{
// DO SOMETHING
}
catch (Exception e)
{
   tx.setRollbackOnly(); // Force a rollback for this error
   throw e;
}
finally
{
   if (tx.getStatus() == Status.STATUS_ACTIVE)
      tx.commit();
   else
      tx.rollback();
} 
```

如果没有函数式语言，使用它的最简单方法是通过可调用对象或类似模式，即[https://github.com/galderz/infinispan/blob/master/core/src/test/java/org/infinispan/test/TestingUtil .java#L1307](https://github.com/galderz/infinispan/blob/master/core/src/test/java/org/infinispan/test/TestingUtil.java#L1307)

更新：在 Infinispan 中没有重试交易的功能

# memory - 使用 1 个 malloc 调用为 2d 矩阵分配内存

> ID：10624981
> 
> 赞同：2
> 
> 时间：2012-05-16T19:02:21.357
> 
> 标签：memory, runtime, malloc, free

```
We can allocate memory for 2d matrix using 1 malloc call as
int (*a)[5];
int i,j; 
```

a=malloc(sizeof(int*) * 5); //分配5个指针，每个指针指向一个5个int的数组

我们如何才能释放成功分配的内存？使用 free(a) 会产生运行时错误

使用 for(i=0;i<5;i++) free(a[i]);

免费（一）；

这也给出了运行时错误

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T08:56:58.647

编辑：整个故事。

以前我忽略了其他**三种**分配二维数组的方法。

**动态二维数组方法一：**

如果您知道编译时的列数，则此方法有效。

```
#define CCOLS 200

int (*m)[CCOLS] = malloc(cRows * sizeof(*m));
m[iRow][iCol] = n; // sets the item at iRow*CCOLS + iCol

...

free(m); 
```

这是因为 m 被声明为指向 CCOLS 整数数组的指针。编译器知道它的大小并为您计算。m[iRow] = CCOLS 整数数组。

您只能将其传递给具有此签名的函数：

```
foo(int (*m)[CCOLS]) { ... } 
```

也许这个签名，取决于你的编译器和你使用的开关：

```
foo(int m[][CCOLS]) { ... } 
```

不是这个签名：

```
foo(int **m) { ... } 
```

由于内存布局和大小不同。

int m[][CCOLS] 看起来像这样：

```
+---------+---------+---------+---------+     
| m[0][0] | m[0][1] | m[0][2] | m[0][3] |     
+---------+---------+---------+---------+     
| m[1][0] | m[1][1] | m[1][2] | m[1][3] |     
+---------+---------+---------+---------+     
| m[2][0] | m[2][1] | m[2][2] | m[2][3] |     
+---------+---------+---------+---------+     
| m[3][0] | m[3][1] | m[3][2] | m[3][3] |     
+---------+---------+---------+---------+ 
```

int **m 看起来像这样：

```
+----+        +----+----+----+----+----+      
|m[0]|  --->  |    |    |    |    |    |      
+----+        +----+----+----+----+----+      
|m[1]|  --->  |    |    |    |    |    |      
+----+        +----+----+----+----+----+      
|m[2]|  --->  |    |    |    |    |    |      
+----+        +----+----+----+----+----+      
|m[3]|  --->  |    |    |    |    |    |      
+----+        +----+----+----+----+----+ 
```

**动态二维数组方法 2（并非所有编译器都支持的 C99）：**

这一个与上一个相同，但您不需要在编译时知道尺寸。

```
int cCols, cRows, iCol, iRow;
... set cRows, cCols somehow, they could be passed in as parameters also ...
int (*m)[cCols] = malloc(cRows * sizeof(*m));
m[iRow][iCol] = n; // sets the item at iRow*cCols + iCol

...

free(m); 
```

您只能将其传递给具有此签名的函数：

```
foo(int cCols, m[][cCols])  {} 
```

或者这个

```
foo(int cRows, int cCols, m[cRows][cCols])  {} 
```

如果您使用 gcc，这里有更多[信息](http://gcc.gnu.org/onlinedocs/gcc/Variable-Length.html)。

**使用堆栈的动态二维数组方法 3！（并非所有编译器都支持 C99）：**

如果您对堆栈上的二维数组没问题，这可以让您完全避免 malloc。

```
int cRows, cCols;
... set cRows, cCols somehow ...
int m[cRows][cCols];
m[iRow][iCol] = n; 
```

我假设您也可以通过这种方式声明一个全局变量。

您将其传递给函数的方式与方法 2 相同。

**动态二维数组方法4：**

这是很多人使用的指针数组方法。

您使用一个 malloc 进行分配以提高效率。当然，您只能免费使用一个。只有当你有巨大的数组，其中连续的内存变成并发出时，你才想单独 malloc 每一行。

```
int cCols = 10, cRows = 100, iRow;

// allocate:
// cCols*cRows*sizeof(int) = space for the data
// cRows*sizeof(int*) = space for the row ptrs
int **m = malloc(cCols*cRows*sizeof(int) + cRows*sizeof(int*));

// Now wire up the row pointers.  They take the first cRows*sizeof(int*) 
// part of the mem becasue that is what m[row] expects.
// we want each row pointer to have its own cCols sized array of ints.
// We will use the space after the row pointers for this.
// One way to calc where the space after the row pointers lies is to
// take the address of the nth + 1 element: &m[cRows].
// To get a row ptr, cast &m[cRows] as an int*, and add iRow*cCols to that.
for (iRow = 0; iRow < cRows; ++iRow)
    m[iRow] = (int*)&m[cRows] + iRow*cCols; 

// or 
for (p=(int*)&m[cRows] ; iRow = 0; iRow < cRows; ++iRow, p+=cCols)
    m[iRow] = p; 

// use it:
...
m[iRow][iCol] = 10;
...

// free it
free(m); 
```

# templates - 在 play 2.0 scala 中包含 scala.html 文件

> ID：10624983
> 
> 赞同：6
> 
> 时间：2012-05-16T19:02:26.943
> 
> 标签：templates, scala, playframework-2.0

我正在尝试使用 scala 学习 Play 2.0，但我认为我不太了解 play 2.0 的模板系统是如何工作的。我之前使用过 play 1.2，我正在寻找与 #{include 'views/blah.html' /} 等效的版本。我本质上想创建一个在所有页面上呈现的导航栏。

基本上在 main.scala.html 我有

```
@(title: String)(navbar: Html)(content: Html)

<!DOCTYPE html>

<html>
  <head>
    <title>@title</title>
    <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/main.css")">
    <link rel="shortcut icon" type="image/png" href="@routes.Assets.at("images/favicon.png")">
    <script src="@routes.Assets.at("javascripts/jquery-1.7.1.min.js")" type="text/javascript"></script>
  </head>
  <header>
    This is my header
  </header>
    <section class="navbar">@navbar</section>
    <section class="content">@content</section>
  <footer>
    This is my footer
  </footer> 
```

在我的 index.scala.html 中：

```
@navbar = {  
<h1>Index</h1>
<ul>
    <li> 
        <a href=@routes.Application.tasks>Tasks</a>
    </li>
</ul>
}
@main("Home")(navbar){
  content
} 
```

在 task.scala.html 中：

```
@(tasks: List[Task], taskForm: Form[String]) 
@import helper._
@main("Home") {
<h1>Index</h1>
<ul>
    <li> 
        <a href=@routes.Application.tasks>Tasks</a>
    </li>
</ul>
} {
  task code
} 
```

现在要包含这个导航栏，似乎我必须在每个页面中重复这个，我必须将这个导航栏硬编码到每个页面中。有没有办法做到这一点，而无需在每个页面中编写整个导航栏？

我还尝试创建一个 navbar.scala.html 文件，其中包含

```
<h1>Index</h1>
<ul>
    <li> 
        <a href=@routes.Application.tasks>Tasks</a>
    </li>
</ul> 
```

并保存在视图/然后使用导入，`@import views.navbar`但随后我收到一条错误消息，指出“导航栏不是视图的成员”。如果有帮助，我将在 Eclipse Java EE IDE indigo 中编写此内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T20:07:35.997

不要导入它，只需调用它：

```
@navbar() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T19:21:48.407

要将任何其他视图模板包含到另一个视图模板中，您只需使用以下命令调用它：`@views.html.[location].[location].[location]()`

其中 [location] 只是其路径的分解。

例如：

```
@views.html.users.interface() 
```

如果它不带任何参数，请务必将“（）”（即括号）放在语句的末尾。如果没有“()”，您将收到如下错误消息：“BaseScalaTemplate(play.api.templates...)”

如果您的模板有参数，请务必在调用时包含它们，如下所示：

```
@views.html.users.interface( "name" ) 
```

# ajax - 素面。AjaxStatus Dialog 在新对话框后面加载！这会是什么？

> ID：10624984
> 
> 赞同：0
> 
> 时间：2012-05-16T19:02:33.027
> 
> 标签：ajax, jsf-2, dialog, primefaces, loader

图片胜于雄辩：

[有问题的对话（见图片，因为我没有在这里发帖的声誉）](http://lh3.googleusercontent.com/-VBfD1_THND0/T7P6WAIXygI/AAAAAAAAAZg/K-gRgziHjjE/s983/dialogPrime2.png)

我有这个 AjaxStatus 显示这个对话框与消息加载，这个 AjaxStatus 对应用程序是全局的，并响应任何现有的流 ajax，它在应用程序的其余部分工作，但是当你打开“可视化城市”对话框时（一个特定的系统的某个部分中的对话框）”新对话框在所有内容之上打开，甚至在加载程序之上，这很奇怪。

有谁之前经历过这个吗？

对不起我的英语，谢谢大家。（请发送我的声誉，因为我可以发布图片，谢谢）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:58:12.017

您的 ajax 状态对话框是模态的吗？

如果没有，只需使用`<p:dialog modal="true" ...>`.

这将使您的状态对话框位于顶部并添加叠加层以避免点击页面的其他部分。

# .htaccess - 如果有子目录，.htacess 条件会重写吗？

> ID：10624985
> 
> 赞同：1
> 
> 时间：2012-05-16T19:02:37.173
> 
> 标签：.htaccess

我有两个重写规则：

```
RewriteRule ^([^/]+)(/.+)? /negocio$2.php?shopURL=$1 [L,QSA] 
```

和

```
RewriteRule ^([^/]+)(/.+)? /negocio/?shopURL=$1 [L,QSA] 
```

它们都单独工作，但同时使用会创建一个重写循环。我需要添加一个条件，因此第一个条件仅适用于存在子目录（$2 存在）的情况，而第二个条件则相反。如果（$2 不存在）则重写。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:54:25.163

你可以试试这个：

```
RewriteCond %{DOCUMENT_ROOT}$2 -d
RewriteRule ^([^/]+)(/.*)$ negocio$2.php?shopURL=$1 [L,QSA]

RewriteCond %{DOCUMENT_ROOT}$2 !-d
RewriteRule ^([^/]+)(/.+)?$ negocio/?shopURL=$1 [L,QSA] 
```

# php - 如何在 Lithium 中渲染网站图标？

> ID：10624989
> 
> 赞同：0
> 
> 时间：2012-05-16T19:02:49.737
> 
> 标签：php, favicon, lithium

我将如何在 Lithium 中渲染图标？

现在我的布局中有这个：

```
<?php echo $this->html->link('Icon', null, array('type' => 'icon')); ?> 
```

但是，图标没有显示出来。尝试通过 Chrome Inspector 查看 favicon 资源会显示损坏的图像。

我尝试通过 HTTP 下载图像，图像为空：

```
$ wget http://example.org/favicon.ico
--2012-05-17 00:13:58--  http://example.org/favicon.ico
Resolving example.org... xx.xx.xx.xxx
Connecting to example.org|xx.xx.xx.xxx|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 0 [image/x-icon]
Saving to: `favicon.ico'

    [ <=>                                                                   ] 0           --.-K/s   in 0s      

2012-05-17 00:13:59 (0.00 B/s) - `favicon.ico' saved [0/0] 
```

但是，如果我将图像 scp 到本地磁盘并查看它，我可以以正确的格式查看正确的 favicon 图像。

我是否必须设置自定义媒体类型或其他内容？如果是这样，我将如何为图像（图标）等资源执行此操作？我假设这不是必需的，并且默认情况下可以渲染图标。

**编辑** 我忘了提到，当我在本地（开发环境）查看时，我可以通过 HTTP 查看图标，但是当我尝试远程查看（生产环境）时，图标不会按应有的方式呈现。

**编辑 2** 我的重写规则：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-d 
    RewriteCond %{REQUEST_FILENAME} !-f 
    RewriteCond %{REQUEST_FILENAME} !favicon.ico$
    RewriteRule ^ index.php [QSA,L]
</IfModule> 
```

谢谢。

**编辑 3** 我设置了一个测试锂应用程序： http: [//dev.koobi.co/favicon/](http://dev.koobi.co/favicon/)

我唯一改变的是布局文件和`config/bootstrap/libraries.php`

如您所见，图标文件也不会为此加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:46:22.223

你没有什么特别的事情要做。仔细检查 webroot/ 目录中是否存在有效的 favicon.ico。Lithium 带有一个你可以使用的图标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:47:01.730

原来这是 Hostgator 的一个问题。锂工作完美。显然，Hostgators Apache 规则不允许动态呈现网站图标。

# jsf - f:setPropertyActionListener 未调用

> ID：10624994
> 
> 赞同：5
> 
> 时间：2012-05-16T19:03:23.413
> 
> 标签：jsf, primefaces

我正在尝试将 a`p:dialog`移出 a `h:form`，因为我已经读过这是首选方式（但是我想了解原因，因为我的`p:dialog`内部 a`form`在我的应用程序中运行良好）。

唯一的困难是对话框标题需要动态更新。单击a 中的按钮时会显示该对话框`p:dataTable`。

这是我的旧 xhtml（更改之前），它工作正常：

```
<p:dataTable var="event" value="#{eventBean.lazyModel}" selection="#{eventBean.selectedEvent}" />
    ...
    <p:column headerText="#{msgs.Persons}">
        <p:commandButton value="#{msgs.ViewPersons}" update=":viewPersonsForm" oncomplete="viewPersonsDlg.show()"> 
            <f:setPropertyActionListener value="#{event}" target="#{eventBean.selectedEvent}" />
        </p:commandButton>
    </p:column>
</p:dataTable>
<h:form id="viewPersonsForm">
    <p:dialog modal="true" widgetVar="viewPersonsDlg" dynamic="true" header="#{eventBean.selectedEvent.name}" >
        ...
    </p:dialog>
</h:form> 
```

这是新的 xhtml，带有未调用的 eventBean#setSelectedEvent()。

```
<p:dataTable var="event" value="#{eventBean.lazyModel}" selection="#{eventBean.selectedEvent}" />
    ...
    <p:column headerText="#{msgs.Persons}">
        <p:commandButton value="#{msgs.ViewPersons}" update=":viewPersonsDlgId" oncomplete="jQuery('#viewPersonsDlgId .ui-dialog-title').text('#{eventBean.selectedEvent.name}');viewPersonsDlg.show()"> 
            <f:setPropertyActionListener value="#{event}" target="#{eventBean.selectedEvent}" />
        </p:commandButton>
    </p:column>
</p:dataTable>
<p:dialog modal="true" id="viewPersonsDlgId" widgetVar="viewPersonsDlg" dynamic="true" >
    ...
</p:dialog> 
```

那么，为什么在第二种情况下 eventBean#setSelectedEvent() 没有被调用？并且，如果可能的话，为什么第一种情况不是最优的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T20:33:04.427

它不限于`p:dialog`在 a中使用，`h:form`因为它在某些情况下可以工作，但大多数时候你会发现自己在为一些意想不到的行为而苦苦挣扎，这里有一些解释：

[为什么不放在`p:dialog`里面`h:form`1](https://stackoverflow.com/a/10579708/1317692)

[为什么不放在`p:dialog`里面`h:form`2](https://stackoverflow.com/a/10028815/1317692)

`oncomplete`在您的情况下，问题是在设置值之前调用jQuery 方法`f:setPropertyActionListener`。为避免这种情况，请使用与第一种情况相同的解决方案。所以 ：

```
<p:dataTable var="event" value="#{eventBean.lazyModel}" selection="#{eventBean.selectedEvent}" />
    ...
    <p:column headerText="#{msgs.Persons}">
        <p:commandButton value="#{msgs.ViewPersons}" update=":viewPersonsDlgId" oncomplete="viewPersonsDlg.show()"> 
            <f:setPropertyActionListener value="#{event}" target="#{eventBean.selectedEvent}" />
        </p:commandButton>
    </p:column>
</p:dataTable>
<p:dialog modal="true" id="viewPersonsDlgId" widgetVar="viewPersonsDlg" dynamic="true" header="#{eventBean.selectedEvent.name}" >
    ...
</p:dialog> 
```

这里不需要使用 jQuery。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-24T10:00:02.727

我有同样的问题（pf 3.5）：

```
<p:tabView id="cashFlowTabContainer" style="width:100%" activeIndex="0"
    widgetVar="cashFlowTabContainerVar">
    <p:tab title="#{labels['cashflow_incoming']}">
        <p:outputPanel id="incomingPanel">
            <p:dataTable value="#{cashFlowController.incomingCashFlows}"
                var="cashFlow">
<p:column headerText="#{labels.cashflow_actions}">
                    <p:commandButton value="Edit"
                        action="#    {cashFlowController.editIncoming}" update="@form" oncomplete="editInputVar.show();">
                        <f:setPropertyActionListener     value="#{cashFlow}"
                            target="#{cashFlowController.selectedIncoming}" />
                    </p:commandButton>
                </p:column> 
```

这是我的对话：

```
<p:dialog id="editInput" header="Dynamic Dialog"
    widgetVar="editInputVar" resizable="false" draggable="false"
    modal="true">
    <p:panel>
        <h:panelGrid columns="2" cellpadding="5">
...
<h:outputText value="#{labels.cashflow_description}:" />
            <h:inputText
                value="#{cashFlowController.selectedIncoming.description}" /> 
```

所以......这样设置者永远不会被调用。然后我注意到，如果我清空对话框，就会调用 setter。

所以我通过在面板上放置一个“渲染”语句来解决它：

```
<p:dialog id="editInput" header="Dynamic Dialog"
    widgetVar="editInputVar" resizable="false" draggable="false"
    modal="true">
    <p:panel **rendered="#{cashFlowController.selectedIncoming != null}"**>
        <h:panelGrid columns="2" cellpadding="5"> 
```

我想有一个空指针没有记录在任何地方......无论如何它是这样工作的:)