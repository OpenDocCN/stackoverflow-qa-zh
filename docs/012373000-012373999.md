# StackOverflow 问答 12373000-12373999

# php - 使用 Facebook API 发布到朋友的墙上

> ID：12373001
> 
> 赞同：1
> 
> 时间：2012-09-11T15:20:50.190
> 
> 标签：php, facebook, facebook-graph-api

我知道我们可以用这个在朋友的墙上发布一些东西：

```
$publishStream = $facebook->api("/$user/feed", 'post', array(
     'message' => "Your Message", 
     'link'    => 'http://example.com',
     'picture' => '',
     'name'    => 'App Name',
     'description'=> 'App description'
)); 
```

只需将 $user 变量替换为您朋友的用户 ID。

我希望只是在我的朋友中选择，我想使用复选框来写用户配置文件。

例如，如果您想共享粉丝页面，这已经成为可能。您选择将请求发送给的人。

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T03:59:19.123

您可以使用 Facebook 的**Multi-Friend-Selector (MFS)**。 [https://developers.facebook.com/docs/guides/games/custom-muti-friend-selector/](https://developers.facebook.com/docs/guides/games/custom-muti-friend-selector/)

从 Multi-Friend-Selector 文档中获取的经过编辑的示例

```
function renderMFS() {
 // First get the list of friends for this user with the Graph API
 FB.api('/me/friends', function(response) {
   var container = document.getElementById('mfs');
   var mfsForm = document.createElement('form');
   mfsForm.id = 'mfsForm';

   // Iterate through the array of friends object and create a checkbox for each one.
   for(var i = 0; i < Math.min(response.data.length, 10); i++) {
     var friendItem = document.createElement('div');
     friendItem.id = 'friend_' + response.data[i].id;
     friendItem.innerHTML = '<input type="checkbox" name="friends" value="'
       + response.data[i].id
       + '" />' + response.data[i].name;
       mfsForm.appendChild(friendItem);
     }
     container.appendChild(mfsForm);

     // Extract selected friends' Facebook ID from value property of checked checkboxes

     // Do a for loop to send notification (refer to the link posted below) and publish post to each user's wall
   });
 } 
```

> 是否可以在消息写在墙上之前发送通知？

是的，当您拥有 Facebook ID 时，这是可能的。请参阅我在[如何使用 Facebook ID 向朋友发送 Facebook 消息？](https://stackoverflow.com/questions/12370122/how-to-send-facebook-message-to-friend-using-facebook-id/12373036#12373036)

# nlp - 在 scikit-learn 中使用 nltk 搭配作为特征

> ID：12373002
> 
> 赞同：1
> 
> 时间：2012-09-11T15:20:50.563
> 
> 标签：nlp, nltk, text-processing, scikit-learn, feature-extraction

我正在尝试使用 nltk 从语料库中提取搭配，然后将它们的出现用作 scikit-learn 分类器的特征。不幸的是，我对 nltk 不是很熟悉，而且我看不到一个简单的方法来做到这一点。我做到了这一点：

*   `BigramCollocationFinder`使用from corpus提取搭配
*   对于每个文档，提取所有二元组（使用`nltk.bigrams`）并检查它们是否是搭配之一
*   `TfidfVectorizer`使用什么都不做的分析器创建一个
*   以提取的二元组形式向其提供文档

这对我来说似乎过于复杂了。还有一个问题是，它`BigramCollactionFinder`有一个`window_size`跨越单词的二元组参数。标准`nltk.bigrams`提取不能做到这一点。

克服这个问题的一种方法是为每个文档实例化一个新的 BigramCollocationFinder 并再次提取二元组并将它们与我之前找到的那些进行匹配......但同样，这似乎很复杂。当然，我忽略了一种更简单的方法。

感谢您的建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:32:00.633

larsmans 已经为简单的非搭配特征贡献了一个 NLTK / scikit-learn 特征映射器。这可能会给你一些灵感来解决你自己的问题：

[http://nltk.org/_modules/nltk/classify/scikitlearn.html](http://nltk.org/_modules/nltk/classify/scikitlearn.html)

# linux - 关于内核中的 CONFIG_NO_HZ

> ID：12373004
> 
> 赞同：4
> 
> 时间：2012-09-11T15:21:00.827
> 
> 标签：linux, schedule

因此，如果设置了 CONFIG_NO_HZ，我相信它会生成一个不滴答的内核。但我相信这只是意味着当系统空闲时，它可能会变得无滴答声以节省能源。当它工作时，它仍然是滴答内核，对吧？谢谢：>

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T17:17:33.317

本质上，是的。

有正在进行的项目使周期性滴答在不闲置时也消失，但这是一项有很多变化的大量工作，目前尚不清楚它是否会完成。

# sql - 重写rails“where”查询以使用heroku

> ID：12373006
> 
> 赞同：1
> 
> 时间：2012-09-11T15:21:04.763
> 
> 标签：sql, ruby-on-rails, ruby, heroku

晚上所有，

我让这个查询在我的本地机器上运行得很好，

```
@articles = Article.where(category: "news").includes(:pictures) 
```

但是，当在 Heroku 上使用它时，查询不会填充页面，这是需要重写查询的问题还是 Heroku 问题？（ ps 我已经重新启动 heroku 并运行所有迁移）

任何提示都会很棒，提前谢谢，安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T19:28:28.200

看起来您的开发数据库（可能是 SQLite）不区分大小写，而 Heroku 上的 Postgres 是。

当我希望 Heroku 不区分大小写时，我会使用以下内容：

```
where("upper(category) like ?", "NEWS") 
```

这就是为什么让您的开发环境尽可能接近生产环境是最佳实践的原因。

# java - 如何使用 MySQL 和 JPA 避免重复键

> ID：12373009
> 
> 赞同：1
> 
> 时间：2012-09-11T15:21:11.613
> 
> 标签：java, mysql, jpa

我正在使用 JPA/Hibernate 和 MySQL 使用 Java 应用程序，并试图理解正确的方法来做一些看起来应该很简单的事情。

**目标**

目标是：允许并行运行的两个线程（当然，每个线程都有自己的事务）查询，然后如果没有找到，则将唯一值插入到数据库中，并且这样做不会引发任何异常由 MySQL 提供。

所以每个线程首先查询记录是否存在，如果不存在，则插入该记录，然后完成。听起来很简单。

**理论**

我认为可以通过设置查询来消除异常的可能性`LockModeType.PESSIMISTIC_WRITE`，因为这将转换为`SELECT .. FOR UPDATE`，这意味着第一个线程的查询将在记录上设置一个独占写入锁，因此第二个线程的查询将阻塞，直到第一个线程提交，然后第二个线程将唤醒并能够看到新记录。

在直接使用 MySQL 之后，我意识到我缺少一些基本的东西，因为第二个线程实际上在其查询期间没有阻塞。

**实践**

我创建了一个这样的表：

```
CREATE TABLE `test`.`A` (
  `id` BIGINT( 20 ) NOT NULL ,
  `name` VARCHAR( 255 ) NOT NULL ,
  PRIMARY KEY ( `id` ) ,
  UNIQUE (`name`)
) ENGINE = InnoDB; 
```

然后在两个单独的窗口**X**和**Y**中执行以下命令，一次执行一个命令，首先在**X**中，然后在**Y**中：

```
1  SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
2  BEGIN;
3  SELECT * FROM A WHERE `name`='Jones' FOR UPDATE;
4  INSERT INTO A (`name`) VALUES ('Jones');
5  COMMIT; 
```

**执行此测试时， X**和**Y**中的每个语句都立即被接受且无错误，语句 #3 在两者中都返回零行，直到在**Y**中的命令 #4 之后发生错误：

```
ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction 
```

实际上这并不意外......（对我来说）意外的是，当我执行*命令 #3时***Y**不会阻塞。一旦两个线程都查询并且什么也没看到，我的想法显然注定要失败，因为它们不可能都是正确的。*`'Jones'`*

 *我认为它的全部意义`SELECT ... FOR UPDATE`在于它在记录上设置了一个排他锁，这应该导致**Y**在语句 #3 上阻塞。

**问题**

我错过了什么？甚至可以在 JPA 甚至 MySQL 中做我想做的事吗？

笔记：

*   MySQL版本是`5.5.23-log MySQL Community Server (GPL)`
*   更改为`SERIALIZABLE`没有任何帮助。*

# objective-c - UIPageViewController 子视图在页面更改时消失

> ID：12373011
> 
> 赞同：2
> 
> 时间：2012-09-11T15:21:15.477
> 
> 标签：objective-c, cocoa-touch, ios5, uipageviewcontroller

我正在编写一个基于 UIPageViewController 的应用程序，在该应用程序上放置了一个子视图：

```
[self.view addSubview:fontViewController.view]; 
```

当我点击主视图的中心（pageviewcontroller 之一）时，此视图会淡入淡出。当显示此视图时，我不希望在更改页面时它消失。我认为这个子视图应该添加到主视图之上的一个层，而不是视图本身。我错了吗？如果没有，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:31:11.363

主视图的父级是什么？在某些情况下，这可能有效：

```
[self.view.superview addSubview:fontViewController.view]; 
```

# javascript - 使用带有嵌套数据的 jQuery removeData()

> ID：12373012
> 
> 赞同：4
> 
> 时间：2012-09-11T15:21:18.223
> 
> 标签：javascript, jquery

我正在使用 jQuery`data()`函数将数据存储在一系列 div 中，格式类似于：

```
{ 
    options: {
        example: {
            option_1: {
                value: "example 1"
            },
            option_2: {
                value: "example 2"
            }
        }
    }
} 
```

我可以添加新密钥并更新数据，例如

```
$("#mydiv").data('options',{'example':{} });    // the object is already created in the live version
$("#mydiv").data('options')['example']['option_3'] = { value: "example 3" }; 
```

但是当我开始使用 removeData() 时，FireBug 告诉我密钥未定义，例如

```
$("#mydiv").removeData('options')['example']['option_2']; 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:28:17.203

[`.removeData(name)`](http://api.jquery.com/removeData/)使用给定的 删除先前存储的数据`name`，并返回一个*jQuery*对象。在您的场景中，您不希望删除整个`options`对象，而只是删除它的特定属性，因此您应该`delete`改用：

```
delete $("#mydiv").data('options')['example']['option_2']; 
```

# javascript - Javascript书签按钮

> ID：12373016
> 
> 赞同：0
> 
> 时间：2012-09-11T15:21:30.390
> 
> 标签：javascript

我想知道是否可以使用 javascript 创建一个“将其添加为书签”按钮，该按钮会将页面 URL 和页面标题添加到用户的书签中。

有谁知道这样做的方法，或者是否有可能？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:23:59.017

是的 - 没有给你*最好*的方法 - 这是一个可怕的 DHTML 解决方案： [http ://www.dynamicdrive.com/dynamicindex9/addbook.htm](http://www.dynamicdrive.com/dynamicindex9/addbook.htm)

# android - 固定时间安装移动应用程序

> ID：12373017
> 
> 赞同：3
> 
> 时间：2012-09-11T15:21:30.827
> 
> 标签：android, installation

我不知道这可能与否。我想知道用户如何在固定时间（可能是 1 个月）内安装我的应用程序（基于 android、iPhone、phonegap）。1 个月后，用户将无法运行该应用程序。然后如果他卸载并在接下来的 1 个月内再次尝试安装，这将阻止他安装。

有没有可能？如果可能怎么办？

-Arefin

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:46:04.520

**没有 100% 安全的方式来做你想做的**事，但你可以做这样的事情：

*   获取安装应用程序的设备的唯一标识符。获取此标识符没有完美的方法，但这里有一些选项： [是否有唯一的 Android 设备 ID？](https://stackoverflow.com/questions/2785485/is-there-a-unique-android-device-id)

*   让您的应用程序连接到您的服务器并注册该标识符

*   无论您的应用程序是否已经安装在那里，您的服务器都可以返回，因此应用程序可以采取相应的行动。

一个副作用是您的应用程序无法在没有 Internet 连接的情况下运行，以防止用户断开与 Internet 的连接以避免此控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T19:15:09.220

您还可以在创建密钥工具时指定有效性选项。导出应用程序的 .apk 文件时使用 keytool。

或者

您可以在 Shared Preferences 中保存应用程序的安装日期——即首次安装应用程序的时间。然后检查从当前日期和保存日期开始的天数，每次启动应用程序时，只有在限制范围内才允许访问。

解决上网问题。

# java - 带有 CDI 的 ContextNotActiveException

> ID：12373028
> 
> 赞同：5
> 
> 时间：2012-09-11T15:22:01.030
> 
> 标签：java, jsf, jetty, cdi

我正在尝试使用 JSF/Primefaces 在应用程序中设置 CDI（用于 @ConversationScoped）并部署在 Jetty 上。我收到这个异常（我相信是）一个非常基本的 ConversationScoped bean。梳理了我能找到的所有相关搜索结果，但一无所获，因此将不胜感激任何建议。

```
 @Named
    @ConversationScoped
    public class RegisterBean implements Serializable {
...     
        private @Inject Conversation conversation;

...     

        public String doSubmitBasicInfo() {
            conversation.begin();
            if(accountType == null)
                return null;
            if(accountType.equals("seller_account"))
                return "register_seller_1?faces-redirect=true";
            else if(accountType.equals("buyer_account"))
                return "register_buyer_1?faces-redirect=true";
            return null;
        }
... 
```

JSF 页面的相关部分是：

```
 <div style="text-align:center;" class="noBorder autoMargin">
        <p:commandButton type="submit" action="#{registerBean.doSubmitBasicInfo}"  ajax="false" value="Submit" styleClass="autoMargin"></p:commandButton>
    </div> 
```

例外是：

```
javax.enterprise.context.ContextNotActiveException: Conversation Context not active when method called on conversation Conversation with id: 1
    at org.jboss.weld.context.conversation.ConversationImpl.verifyConversationContextActive(ConversationImpl.java:197)
    at org.jboss.weld.context.conversation.ConversationImpl.getLastUsed(ConversationImpl.java:154)
    at org.jboss.weld.context.AbstractConversationContext.isExpired(AbstractConversationContext.java:337)
    at org.jboss.weld.context.AbstractConversationContext.invalidate(AbstractConversationContext.java:285)
    at org.jboss.weld.jsf.WeldPhaseListener.deactivateConversations(WeldPhaseListener.java:146)
    at org.jboss.weld.jsf.WeldPhaseListener.afterPhase(WeldPhaseListener.java:91)
    at com.sun.faces.lifecycle.Phase.handleAfterPhase(Phase.java:189)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:107)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:598)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:486)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:524)
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1065)
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:413)
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:999)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
    at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
    at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111)
    at org.eclipse.jetty.server.Server.handle(Server.java:350)
    at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:454)
    at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:890)
    at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:944)
    at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:630)
    at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:230)
    at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:77)
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:606)
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:46)
    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:603)
    at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:538)
    at java.lang.Thread.run(Thread.java:722) 
```

# node.js - 如何拥有不更新会话的 Express/Connect 路由

> ID：12373031
> 
> 赞同：2
> 
> 时间：2012-09-11T15:22:13.590
> 
> 标签：node.js, express, connect

我正在构建一个在后端与 Express 对话的单页 javascript 应用程序。在应用程序的各个点，我们与后端交互，更新会话。出于安全原因，会话到期时间相对较短。

在其中，我想警告用户会话可能即将到期，如果他们已经闲置很长时间并且没有与后端进行任何交易。

我想要一个 Express“心跳”路由，它返回会话剩余的时间（session.maxAge），但我不希望它刷新会话到期。

connect.session 代码在请求结束时自动刷新会话。

我正在寻找一种方法来访问会话以获取 maxAge，但没有更新它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:56:35.230

最好的办法是手动修改您的 SessionStore 以在来自特定路由（req.url）时不修改会话到期。

查找调用 Session.touch() 的 sessionStore 部分。

# django - Django 页面中的两个视图

> ID：12373033
> 
> 赞同：1
> 
> 时间：2012-09-11T15:22:18.440
> 
> 标签：django, django-templates, django-views

我在显示我的页面的输入框时遇到问题。在同一页面上，我希望有两个视图，一个访问和检索数据，另一个是表单。由于它是一个事件注册页面，第一个视图显示特定事件的详细信息，第二个视图是从事件本身中删除特定用户的视图。

我的观点.py

```
def ShowSpecificEvent(request, eventslug):
if request.method == 'POST':
    form = RemovalForm(request.POST)
    if form.is_valid():
        event   = Event.objects.get(slug=eventslug)
        context = {'event': event,}
        updated_event = event.signed_up.remove(for_removal = form.cleaned_data['for_removal'],)
        updated_event.save()
    return render_to_response('base_specific_event.html', context, context_instance=RequestContext(request))
event   = Event.objects.get(slug=eventslug)
context = {'event': event,}
return render_to_response('base_specific_event.html', context, context_instance=RequestContext(request))

def Remove(request, eventslug):
    if request.method == 'POST':
        form = RemovalForm(request.POST)
        if form.is_valid():
            event   = Event.objects.get(slug=eventslug)
            context = {'event': event,}
            updated_event = event.signed_up.remove(for_removal = form.cleaned_data['for_removal'],)
            updated_event.save()
        return render_to_response('base_specific_event.html', context, context_instance=RequestContext(request))
    return HttpResponseRedirect('base_remove_user.html') 
```

我的模板

```
{% block content %}

event details...

{% if user.is_authenticated %}
{% if event.sign_up_is_live %}
    <p><a href= "{% url eventattend event.slug %}"> Sign me up!</a></p>

<form action='' method='post'>
{% csrf_token %}
{% if form.errors %}<p>Please correct the following fields:</p>{% endif %}
<div class='register_div'>
{% if form.for_removal.errors %} <p class='error'>{{ form.for_removal.errors }}</p>{% endif %}
<p><label for='for_removal'{% if form.for_removal.errors %}class='error'{% endif %}>User to be removed:</label></p>
<p>{{ form.for_removal }}</p>
</div>  

<p><input type='submit'></p>

</form>

{% endif %}{% endif %}

{% endblock %} 
```

我读过我认为最相关的[这篇文章，但规定的方法并没有真正帮助。](https://stackoverflow.com/questions/9255002/django-two-views-on-a-webpage)

我也考虑过拆分这两个页面，但我将无法在删除用户页面中检索 eventslug。

提前致谢 ：）

更新：

gutrt 的回答很有帮助，我设法通过将 ShowSpecificEvent 更改为以下内容来显示输入框：

```
def ShowSpecificEvent(request, eventslug):
event   = Event.objects.get(slug=eventslug)
form    = RemovalForm(request.POST or None)
context = {'event': event, 'form': form,}
if request.method == 'POST':
    if form.is_valid():
        updated_event = event.signed_up.remove(request.POST.get('for_removal'))
        updated_event.save()
        return HttpResponseRedirect('base_user_removed.html')
    else:   
        return render_to_response('base_specific_event.html', context, context_instance=RequestContext(request))
return render_to_response('base_specific_event.html', context, context_instance=RequestContext(request)) 
```

但是，在提交表单后，我得到一个 ValueError(invalid literal for int() with base 10: 'a_technicolor_skye') 其中 a_technicolor_skye 是我要删除的用户。有没有人有任何想法？顺便说一句，event.signed_up 是多对多字段，我已将其设置为 null=True 和 blank=True。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:28:24.713

您可以将所有信息传递到上下文变量中：

```
context = {'event': event, 'form': my_form} 
```

然后两者都可以在您的模板中使用。请注意，这意味着您最终将使用 1 个*视图*，但会在该视图或其方法中计算页面的所有信息。

# android - android在根目录打开文件

> ID：12373035
> 
> 赞同：0
> 
> 时间：2012-09-11T15:22:22.247
> 
> 标签：android, root

有没有办法在根目录（例如/data/）中写入和读取根目录中的 Android 手机上的文本文件？

```
InputStream instream = openFileInput("/data/somefile"); 
```

不工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-09-11T00:03:06.010

如果您是 root 用户，您只能访问 /data 文件夹。

通过 OutputStream 调用 SU 二进制并通过 SU 二进制写入字节（这些字节是命令）并通过 InputStream 读取命令输出，这很容易：
调用`cat`命令以读取文件。

```
try {
    Process process = Runtime.getRuntime().exec("su");
    InputStream in = process.getInputStream();
    OutputStream out = process.getOutputStream();
    String cmd = "cat /data/someFile";
    out.write(cmd.getBytes());
    out.flush();
    out.close();
    byte[] buffer = new byte[1024 * 12]; //Able to read up to 12 KB (12288 bytes)
    int length = in.read(buffer);
    String content = new String(buffer, 0, length);
    //Wait until reading finishes
    process.waitFor();
    //Do your stuff here with "content" string
    //The "content" String has the content of /data/someFile
} catch (IOException e) {
    Log.e(TAG, "IOException, " + e.getMessage());
} catch (InterruptedException e) {
    Log.e(TAG, "InterruptedException, " + e.getMessage());
} 
```

不使用 OutputStream 写入文件，`OutputStream`用于在 SU 二进制文件中执行命令，并`InputStream`用于获取命令的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:06:05.593

为了能够执行您所要求的操作，您必须通过 SU 二进制文件执行所有操作。

喜欢...

```
try {
      Process process = Runtime.getRuntime().exec("su");
      process.waitFor();
    } catch (IOException e) {
      e.printStackTrace();
    } catch (InterruptedException e) {
      e.printStackTrace();
    } 
```

阅读会比写作更容易，因为最简单的写作是将文件写入您可以使用标准 java api 访问的某个地方，然后使用 su 二进制文件将其移动到新位置。

# android - 动态检查类型的变量android

> ID：12373039
> 
> 赞同：1
> 
> 时间：2012-09-11T15:22:35.133
> 
> 标签：android, sqlite

我有一个数据库，我打开它并用游标提取我需要的查询。如何检查我提取的变量是 int 还是 string？因为我不知道我要打开哪张桌子，所以一切都是动态的。所以我不能使用`cursor.getString()`或`cursor.getInt()`

编辑

对不起我的英语不好，我是意大利人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T07:45:49.787

找到了。此方法有效：

```
public boolean isInt(String s){
        boolean result=false;
        try{
            Integer.parseInt(s);
            result=true;
        }catch(Exception e){
        }
        return result;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:26:07.097

这应该会有所帮助： http: [//developer.android.com/reference/android/database/Cursor.html#getType](http://developer.android.com/reference/android/database/Cursor.html#getType(int) (int )

将列索引传递给它。它应该返回您其中之一

*   FIELD_TYPE_NULL
*   FIELD_TYPE_INTEGER
*   FIELD_TYPE_FLOAT
*   FIELD_TYPE_STRING
*   FIELD_TYPE_BLOB

# c# - 对文件数组进行排序以进行重命名

> ID：12373041
> 
> 赞同：2
> 
> 时间：2012-09-11T15:22:49.630
> 
> 标签：c#, .net

我最近编写了一个小程序来重命名位于 6 个目录中的一堆文件。程序循环遍历列表中的每个目录，然后使用 File.Move 方法重命名该目录中的每个文件。这些文件被重命名为 cart_buttons_1.png，其中 1 每次递增 1。

```
public static int RenameFiles(DirectoryInfo d, StreamWriter sqlStreamWriter, 
                                       int incrementer, int category, int size)
{
    FileInfo[] files = d.GetFiles("*.png");

    foreach (FileInfo fileInfo in files)
    {
        File.Move(fileInfo.FullName, d.FullName + "cart_button_" + incrementer + ".png" );
        incrementer++;
    }

    return incrementer;
} 
```

我遇到的问题是，当我多次运行该程序时，它运行良好，直到它到达包含第 100 条记录的文件夹。d.Getfiles 方法首先检索所有 100 的文件，导致 IOException，因为它试图重命名的文件已经存在于文件夹中。我为此找到的解决方法是选择文件名中包含 100 的所有记录，并将它们全部重命名为“z”或其他名称，以便将它们全部批处理。有关如何解决此问题的任何想法或想法。可能以某种方式对 GetFiles 进行排序以首先查看其他文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:27:29.997

使用 LINQ：

```
var sorted = files.OrderBy(fi => fi.FullName).ToArray(); 
```

请注意，上面将按文本值排序，因此您可能希望将其更改为按数值排序：

```
files.OrderBy(fi => int.Parse(fi.Name.Split(new []{'_','.'})[2])) 
```

上面假设按文件名`_`和`.`按文件名分割将产生一个数组，其中第三个值是数值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:28:53.987

最简单的解决方法是在尝试复制之前检查目标名称是否存在。由于您已经拥有该`files`数组，因此您可以构建目标名称，如果 File.Exists() 返回 true，则跳过该数值。

我还将处理 File.Move 引发的异常（您想首先测试存在以避免不必要的异常抛出），因为在您的代码工作时文件系统没有被冻结......所以即使测试存在也不会' t 确保它不是在此期间创建的。

最后，我认为对同一个目录再次运行此代码将再次复制所有文件......可能不是预期的。我会过滤源文件名并避免复制那些已经与您的模式匹配的文件名。

# search - 如何使用高级数据库爬虫添加特定内容项？

> ID：12373046
> 
> 赞同：0
> 
> 时间：2012-09-11T15:23:36.693
> 
> 标签：search, sitecore

我读了这个问题：[如何让高级数据库爬虫索引项目名称](https://stackoverflow.com/questions/11211496/how-can-i-get-the-advanced-database-crawler-to-index-the-item-name)

但是想问它我想索引一个内容项文件夹，它位于：/sitecore/content/Data/MyNewsFeed 并且我想在它上面创建一个索引，我在我的 .config 文件中编写了这段代码：

```
 <configuration xmlns:x="http://www.sitecore.net/xmlconfig/">
  <sitecore>
    <databases>
      <database id="master" singleInstance="true" type="Sitecore.Data.Database, Sitecore.Kernel">
        <Engines.HistoryEngine.Storage>
          <obj type="Sitecore.Data.$(database).$(database)HistoryStorage, Sitecore.Kernel">
            <param connectionStringName="$(id)" />
            <EntryLifeTime>30.00:00:00</EntryLifeTime>
          </obj>
        </Engines.HistoryEngine.Storage>
        <Engines.HistoryEngine.SaveDotNetCallStack>false</Engines.HistoryEngine.SaveDotNetCallStack>
      </database>
    </databases>
    <search>
      <configuration>
        <indexes>
          <index id="web" type="Sitecore.Search.Index, Sitecore.Kernel">
            <param desc="name">$(id)</param>
            <param desc="folder">master</param>
            <Analyzer ref="search/analyzer" />
            <locations hint="list:AddCrawler">
              <master type="Sitecore.SharedSource.SearchCrawler.Crawlers.AdvancedDatabaseCrawler,Sitecore.SharedSource.SearchCrawler">
                <Database>master</Database>
                <Root>/sitecore/content/Data/MyNewsFeed</Root>
                <IndexAllFields>true</IndexAllFields>

                <fieldCrawlers hint="raw:AddFieldCrawlers">
                  <fieldCrawler type="Sitecore.SharedSource.SearchCrawler.FieldCrawlers.LookupFieldCrawler,Sitecore.SharedSource.SearchCrawler" fieldType="Droplink" />
                  <fieldCrawler type="Sitecore.SharedSource.SearchCrawler.FieldCrawlers.DateFieldCrawler,Sitecore.SharedSource.SearchCrawler" fieldType="Datetime" />
                  <fieldCrawler type="Sitecore.SharedSource.SearchCrawler.FieldCrawlers.DateFieldCrawler,Sitecore.SharedSource.SearchCrawler" fieldType="Date" />
                  <fieldCrawler type="Sitecore.SharedSource.SearchCrawler.FieldCrawlers.NumberFieldCrawler,Sitecore.SharedSource.SearchCrawler" fieldType="Number" />
                </fieldCrawlers>
                <!-- If a field type is not defined, defaults of storageType="NO", indexType="UN_TOKENIZED" vectorType="NO" boost="1f" are applied-->
                <fieldTypes hint="raw:AddFieldTypes">
                  <!-- Text fields need to be tokenized -->
                  <fieldType name="single-line text" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="multi-line text" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="word document" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="html" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="rich text" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="memo" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="text" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <!-- Multilist based fields need to be tokenized to support search of multiple values -->
                  <fieldType name="multilist" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="treelist" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="treelistex" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <fieldType name="checklist" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                  <!-- Legacy tree list field from ver. 5.3 -->
                  <fieldType name="tree list" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                </fieldTypes>
              </master>
            </locations>
          </index>
        </indexes>
      </configuration>
    </search>
  </sitecore>
</configuration> 
```

所以基本上我将根目录定位到 MyNewsFeed 文件夹。还有其他方法可以实现吗？谢谢！

我添加了这个片段：

```
 <locations hint="list:AddCrawler">
          <master type="Sitecore.SharedSource.SearchCrawler.Crawlers.AdvancedDatabaseCrawler,Sitecore.SharedSource.SearchCrawler">
            <Database>master</Database>
            <Root>/sitecore/content/Data/myNewsFeed</Root>
            <IndexAllFields>false</IndexAllFields>
            <include hint="list:IncludeTemplate">
              <template1>{GUID here}</template1>
              <template2>{GUID here}</template2>
            </include>
            <fieldCrawlers hint="raw:AddFieldCrawlers">
              <fieldCrawler type="Sitecore.SharedSource.SearchCrawler.FieldCrawlers.LookupFieldCrawler,Sitecore.SharedSource.SearchCrawler" fieldType="Droplink" />
              <fieldCrawler type="Sitecore.SharedSource.SearchCrawler.FieldCrawlers.DateFieldCrawler,Sitecore.SharedSource.SearchCrawler" fieldType="Datetime" />
              <fieldCrawler type="Sitecore.SharedSource.SearchCrawler.FieldCrawlers.DateFieldCrawler,Sitecore.SharedSource.SearchCrawler" fieldType="Date" />
              <fieldCrawler type="Sitecore.SharedSource.SearchCrawler.FieldCrawlers.NumberFieldCrawler,Sitecore.SharedSource.SearchCrawler" fieldType="Number" />
            </fieldCrawlers> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:56:47.760

您的配置是正确的，但是您需要告诉它要在索引中包含哪些模板类型，例如

```
<include hint="list:IncludeTemplate">
  <template1>{GUID here}</template1>
  <template2>{GUID here}</template2>
</include> 
```

# magento - 将 Magento 高级搜索链接从页脚移动到搜索栏下方

> ID：12373048
> 
> 赞同：0
> 
> 时间：2012-09-11T15:23:42.357
> 
> 标签：magento, advanced-search

我正在尝试从搜索栏正下方的页脚链接中移动 magentos 高级搜索链接。

我知道链接的来源在参考名称 =“footer_links”下的 layout/catalogsearch.xml 中，并且由于`getChildHtml('footer_links')`在 footer.phtml中而出现在页脚中

而且我知道搜索栏来自 template/catalogsearch/form.mini.phtml 并通过catalogsearch.xml在参考名称=“top.menu”下出现

关于如何在这里进行的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T11:30:55.177

谢谢你的快速回答！但这并不是我想要的，因为它会在搜索栏下方显示整个页脚链接块。不过，感谢您向我展示您使用的方法！

无论如何，我自己想出了一个解决方案：

我修改了catalogsearch.xml：

```
<default>
    <reference name="top.menu"> 
        <block type="core/template" name="top.search" as="topSearch" template="catalogsearch/form.mini.phtml"/> 
    </reference>

<!-- add a new reference to top.search including my new adv.search block -->
    <reference name="top.search"> 
        <block type="page/template_links" name="adv.search" as="adv.search" >

            <action method="addLink" translate="label title" module="catalogsearch"> 
                <label>Advanced Search</label>
                <url helper="catalogsearch/getAdvancedSearchUrl" />
                <title>Advanced Search</title>
            </action>       

        </block>
    </reference>  
<!-- the reference to the footer i commented out as its not longer needed; it includes advanced search and popular search terms-->
</default> 
```

在 form.mini.phtml 中，我添加了一个名为 adv.search 的新 div：

```
</script>

<div class="adv-search"> <?php echo $this->getChildHtml('adv.search') ?> </div>

</div> 
```

最后，在 styles.css 中，我添加了一些代码来控制该 div 的外观：

```
.adv-search {width:100px; height:15px; margin-top:24px; margin-left: 120px;}
.adv-search a { color:#fff; font-weight:bold; } 
```

任何额外的建议都非常受欢迎

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T20:47:17.800

为了使它起作用，您必须：

1) 更新您的 app/design/frontend/[yourtheme]/default/layout/local.xml 文件

2) 调用 app/design/frontend/[yourtheme]/default/template/page/html/header.phtml 中的新块 - 这是必需的，因为 header.phtml 不是自动呈现其的“core/text_list”块类型嵌套块。所以我们必须明确告诉 Magento 渲染那些子块

您的 app/design/frontend/[yourtheme]/default/layout/local.xml 应包含以下内容：

```
<?xml version="1.0"?>
<layout version="0.1.0">

    <default>

        <reference name="header">

            <!-- Insert cms links. No need to use <action method="insert"> as this block is not used elsewhere in layout -->
            <block type="cms/block" name="top_links_cms" as="top_links_cms" before="top_links_other">
                <action method="setBlockId"><block_id>footer_links</block_id></action>
            </block>

            <!-- Insert former footer links. -->
            <action method="insert">
                <!-- We must keep block name "footer_links" as it is used as a reference for adding links by other modules -->
                <blockName>footer_links</blockName>
                <!-- Name of the block we want to have as sibling (in order to get its position and place our block after it. See next node <after> -->
                <siblingName>topSearch</siblingName>
                <!-- $after param from Mage_Core_Block_Abstract::insert() is a boolean type, so its value in the XML node is [empty], 0 or 1 -->
                <after>1</after>
                <alias>top_links_other</alias>
            </action>
        </reference>

        <reference name="footer">
            <action method="unsetChild"><name>footer_links</name></action>
            <action method="unsetChild"><name>cms_footer_links</name></action>
        </reference>

    </default>

</layout> 
```

这是一个更新的 header.phtml，您可以从中获得灵感，用于您的 app/design/frontend/[yourtheme]/default/template/page/html/header.phtml 文件：

```
<div class="header-container">
    <div class="header">
        <?php if ($this->getIsHomePage()):?>
        <h1 class="logo"><strong><?php echo $this->getLogoAlt() ?></strong><a href="<?php echo $this->getUrl('') ?>" title="<?php echo $this->getLogoAlt() ?>" class="logo"><img src="<?php echo $this->getLogoSrc() ?>" alt="<?php echo $this->getLogoAlt() ?>" /></a></h1>
        <?php else:?>
        <a href="<?php echo $this->getUrl('') ?>" title="<?php echo $this->getLogoAlt() ?>" class="logo"><strong><?php echo $this->getLogoAlt() ?></strong><img src="<?php echo $this->getLogoSrc() ?>" alt="<?php echo $this->getLogoAlt() ?>" /></a>
        <?php endif?>
        <div class="quick-access">
            <?php echo $this->getChildHtml('topSearch') ?>

            <?php
            /**
             * Add other top links (footer and cms links)
             */
            ?>
            <?php echo $this->getChildHtml('top_links_cms') ?>
            <?php echo $this->getChildHtml('top_links_other') ?>

            <p class="welcome-msg"><?php echo $this->getWelcome() ?> <?php echo $this->getAdditionalHtml() ?></p>
            <?php echo $this->getChildHtml('topLinks') ?>
            <?php echo $this->getChildHtml('store_language') ?>
        </div>
        <?php echo $this->getChildHtml('topContainer'); ?>
    </div>
</div>
<?php echo $this->getChildHtml('topMenu') ?> 
```

# c# - c# RichTextbox粘贴方法

> ID：12373050
> 
> 赞同：0
> 
> 时间：2012-09-11T15:23:46.477
> 
> 标签：c#, winforms, image, .net-3.5, wmf

RichTextbox 粘贴方法究竟是如何工作的？我想将图像插入 RTB。如果我使用 Clipboard.SetImage(image); 然后是 RTB.Paste(); 它工作正常。但我想自己做。我有以下代码。但它不起作用：

```
 byte[] byteArray = null;
        using (MemoryStream ms = new MemoryStream())
        {
            image.Save(ms, ImageFormat.Png);
            ms.Seek(0, 0);
            byteArray = ms.ToArray();
        }
        string hexString = "";
        foreach (byte b in byteArray)
        {
            hexString += b.ToString("x2");
        }

        string mpic = @"{\pict\pngblip\picw396\pich396\picwgoal225\pichgoal225 ";
        mpic += hexString;
        mpic += "}";

        Console.WriteLine(mpic);
        return mpic; 
```

我发现使用 Paste() 方法后，hexString 中的值与richTextbox 中的值不同。

如果我使用正确的十六进制值，这可以正常工作。

```
 string mpic = @"{\pict\wmetafile8\picw396\pich396\picwgoal225\pichgoal225 ";
        mpic += hexString;
        mpic += "}"; 
```

我想我需要的只是将图像转换为 WMF hexa 值。但我不知道该怎么做。

如果它有帮助，这就是有效的：

```
010009000003a001000000008a0100000000050000000b0200000000050000000c028c018c018a
010000430f2000cc0000000f000f00000000008c018c0100000000280000000f0000000f000000
0100180000000000d0020000c40e0000c40e00000000000000000000ffffffffffffffffffc5d9
d83a78750a4442011f1e000404011f1e0a44423a7875c5d9d8ffffffffffffffffff000000ffff
ffffffff669896073e3c00636000a7a100dcd400fbf200dcd400a7a1006360073e3c669896ffff
ffffffff000000ffffff66989604393700b0aa00fff600fff600fff600fff600fff600fff600ff
f600b0aa043937669896ffffff000000c5d9d8073e3c00b0aa00fff600fff600fff600fff600ff
f600fff600fff600fff600fff600b0aa073e3cc5d9d80000003a787500636000fff600fff600ff
f600000000000000000000000000000000fff600fff600fff60063603a78750000000a444200a7
a100fff600fff600000000fff600fff600fff600fff600fff600000000fff600fff600a7a10a44
42000000011f1e00dcd400fff600000000fff600fff600fff600fff600fff600fff600fff60000
0000fff600dcd4011f1e00000000040400fbf200fff600fff600fff600fff600fff600fff600ff
f600fff600fff600fff600fff600fbf2000404000000011f1e00dcd400fff600fff600fff600ff
f600fff600fff600fff600fff600fff600fff600fff600dcd4011f1e0000000a444200a7a100ff
f600fff600000000fff600fff600fff600fff600fff600000000fff600fff600a7a10a44420000
003a787500636000fff600fff600000000fff600fff600fff600fff600fff600000000fff600ff
f60063603a7875000000c5d9d8073e3c00b0aa00fff600fff600fff600fff600fff600fff600ff
f600fff600fff600b0aa073e3cc5d9d8000000ffffff66989604393700b0aa00fff600fff600ff
f600fff600fff600fff600fff600b0aa043937669896ffffff000000ffffffffffff669896073e
3c00636000a7a100dcd400fbf200dcd400a7a1006360073e3c669896ffffffffffff000000ffff
ffffffffffffffc5d9d83a78750a4442011f1e000404011f1e0a44423a7875c5d9d8ffffffffff
ffffffff000000030000000000 
```

感谢您的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:12:44.337

由于您实际上是在创建自己的 RTF 格式并将其附加到控件中，因此我认为您可以使用以下内容：

```
RTB.Rtf += mpic; 
```

# c# - 请求 Windows Phone 7.5 位置

> ID：12373052
> 
> 赞同：-1
> 
> 时间：2012-09-11T15:23:49.267
> 
> 标签：c#, .net, web-services, windows-phone-7.1

我正在尝试跟踪 5 个 windows phone 7.5 进行实验，并且我尝试使用一个应用程序（我正在为该实验开发），但该应用程序必须处于活动状态，并且并非所有读数都可以，我在网上查找并找到了一些东西类似于微软对查找我的电话服务所做的，

[https://www.windowsphone.com/en-US/find](https://www.windowsphone.com/en-US/find)

任何人都知道我如何在网站之外调用该服务或以任何其他方式完成此任务我需要每 15 分钟一次 GEO 位置

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-09-11T15:36:28.597

除非应用程序在手机的前台或后台运行，否则您将无法定位手机。您无法将微软能够做的事情与您能够做的事情进行比较。他们在 Windows Phone 7.5 和 8 中实现了许多普通开发人员无法做到的事情。微软并不是唯一这样做的，几乎所有的移动操作系统都具有开发人员无法复制的功能。

对此事进行快速搜索，我发现没有任何东西可以阻止您在后台运行应用程序，因此您可以将手机的位置报告给某种网络服务。

# c# - 更改 appsettings 键时删除配置文件注释

> ID：12373059
> 
> 赞同：1
> 
> 时间：2012-09-11T15:24:01.403
> 
> 标签：c#, app-config

我正在尝试更改 App.Config 文件 appsettings 键值，一切正常，同时更改键值时，配置文件中的所有注释都已删除（我也想要注释），谁能帮助我我的代码有什么问题

```
Configuration config = ConfigurationManager.OpenMappedExeConfiguration(ConfigFilepath,
                ConfigurationUserLevel.None);
            config.AppSettings.Settings["IPAddress"].Value = "10.10.2.3";

            config.Save(ConfigurationSaveMode.Full); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-15T15:00:31.037

这就是我解决这个问题的方法。就我而言，appSettings 部分存储在与 web.config 不同的文件中（使用 configSource 属性）。

```
public static void SaveAppSetting(string key, string value)
{
    Configuration config = WebConfigurationManager.OpenWebConfiguration("~");
    SaveUsingXDocument(key, value, config.AppSettings.ElementInformation.Source);
}

/// <summary>
/// Saves the using an XDocument instead of ConfigSecion.
/// </summary>
/// <remarks>
/// The built-in <see cref="T:System.Configuration.Configuration"></see> class removes all XML comments when modifying the config file.
/// </remarks>
private static void SaveUsingXDocument(string key, string value, string fileName)
{
    XDocument document = XDocument.Load(fileName);
    if ( document.Root == null )
    {
        return;
    }
    XElement appSetting = document.Root.Elements("add").FirstOrDefault(x => x.Attribute("key").Value == key);
    if ( appSetting != null )
    {
        appSetting.Attribute("value").Value = value;
        document.Save(fileName);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-27T14:38:35.293

基于@Jeremy_bell 很好的答案，如果您还想添加新设置（如果不退出），您可以这样做：

```
public static void SaveAppSetting(string key, string value)
{
    Configuration config = WebConfigurationManager.OpenWebConfiguration("~");
    SaveUsingXDocument(key, value, config.AppSettings.ElementInformation.Source);
}

/// <summary>
/// Saves the using an XDocument instead of ConfigSecion.
/// </summary>
/// <remarks>
/// The built-in <see cref="T:System.Configuration.Configuration"></see> class removes all XML comments when modifying the config file.
/// </remarks>
private static void SaveUsingXDocument(string key, string value, string fileName)
{
    XDocument document = XDocument.Load(fileName);
    if ( document.Root == null )
    {
        return;
    }
    XElement appSetting = document.Root.Elements("add").FirstOrDefault(x => x.Attribute("key").Value == key);
    if ( appSetting != null )
    {
        appSetting.Attribute("value").Value = value;
        document.Save(fileName);
    }
    else
    {
        XElement el = new XElement("add");
        el.SetAttributeValue("key", key);
        el.SetAttributeValue("value", value);
        document.Root.Add(el);
        document.Save(fileName);
    }
} 
```

我刚刚添加了这个：

```
else
    {
        XElement el = new XElement("add");
        el.SetAttributeValue("key", key);
        el.SetAttributeValue("value", value);
        document.Root.Add(el);
        document.Save(fileName);
    } 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-11T15:30:13.583

保存后最后调用

```
ConfigurationManager.RefreshSection( "appSettings" ); 
```

# vsto - 如何让用户选择一个值并检索它？

> ID：12373061
> 
> 赞同：0
> 
> 时间：2012-09-11T15:24:01.483
> 
> 标签：vsto

我有一个我希望用户从中选择的值的动态列表，如何使用 VSTO 来做到这一点？是否可以提示一个列表框（作为 MessageBox ？）并检索所选项目？或者我可以在功能区中添加一个列表框吗？

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T06:31:41.213

您是否尝试将[DropDown](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.ribbon.ribbondropdown.aspx) / [ComboBox](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.ribbon.ribboncombobox)控件添加到功能区栏？

或者，也许您可​​以创建一个自定义窗口窗体并将控件放置在其上。然后将该表单附加到事件、加载项启动、按钮单击等。

# php - SQL 需要使用第三个表按“之前”和“之后”日期分隔结果

> ID：12373062
> 
> 赞同：1
> 
> 时间：2012-09-11T15:24:01.730
> 
> 标签：php, mysql

情况如下：我有相关行所在的表...

```
contact
-- contact_id

event
-- event_id
-- event_group_id

groups
-- group_id

groupmember
-- group_id
-- contact_id

attendance
-- contact_id
-- group_id
-- event_id
-- timestamp (current timestamp)

//Query the database for group members 
$result = mysql_query(
"SELECT contact.contact_id, contact.first, contact.last, 
  contact.home_phone, contact.mobile_phone, contact.email, contact.address, 
  contact.city, contact.state, contact.zip 
FROM contact 
INNER JOIN groupmember ON contact.contact_id = groupmember.contact_id 
WHERE groupmember.group_id = '$groupid' 
ORDER BY last
    "); 
```

我想做的是通过检查名为“出席”的表格来修剪这些结果，并仅显示在过去 6 个月内参加过由“$group”组赞助的活动的结果。

然后，在显示这些结果之后，在页面底部生成另一个列表，显示那些“不活跃”的联系人，因为他们上一次参加由“$group”赞助的活动是在 6 个月前。我假设另一个 WHERE 语句必须在出勤表中附加一个 INNER JOIN，但我什至不确定是否可以这样做。

有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:58:47.193

为什么你也不能加入考勤表？

如果你这样做了，GROUP BY contact_id 并获取 MAX（时间戳）。你可以用它来回答你的第一个问题：

```
 MAX(timestamp) >= datesub(now(), interval 6 month) 
```

你的第二个：

```
 MAX(timestamp) < datesub(now(), interval 6 month) 
```

请注意，您的第二个问题询问以前参加过活动的人，因此您可以保证出席表中存在一行。如果您没有说明，并且联系人可能没有出勤记录，则您需要使用 OUTER JOIN。

祝你好运。

# ruby-on-rails - 导轨非常慢

> ID：12373064
> 
> 赞同：0
> 
> 时间：2012-09-11T15:24:06.147
> 
> 标签：ruby-on-rails, ruby-on-rails-3, performance, ruby-on-rails-3.2

抱歉，我知道这是一个通用问题，我会尽量提供尽可能详细的信息

我在 Amazon EC2 中型实例上运行 Bitnami Rubystack (3.2.7)。Rails 的某些方面非常慢，以下是其中的一些：

*   登录时（我使用的是devise gem），如果您提供的密码无效，则需要很长时间才能告诉您密码无效。
*   注册过程需要很长时间，大约 2 分钟后响应（当它所要做的只是对数据库运行几个查询时？）
*   文件上传（在carrierwave上）非常慢，几乎无法正常工作。（文件将通过 CarrierWave 上的 Fog 传输到 S3）。

上述实例中的代码非常简单，我没有发现任何明显错误。事实上，大部分工作都是由 gems 完成的（例如，设计处理注册和登录）。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:30:58.023

尝试使用分析工具，例如[New Relic](https://newrelic.com/)

这将帮助您找到最慢的代码和/或最慢的数据库查询

~~**编辑**~~

在下面的评论中，您提到您正在使用 devise `0.5.8`，这非常糟糕，考虑到 devise 今天是版本`2.1.2`

~~请更新您的设计并随时通知我。~~

**新编辑**

由于设计版本不是问题，您可以查看视图。

在视图中检查可以插入单个请求或异步请求的 http 请求。

例如`Google Analytics`.

如果他们的 javascript 文件的负载阻止了您的视图加载，则可能将它们放入`head`或制作它们`async`可能会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T19:37:45.923

我建议你用 falcon 补丁编译一个 Ruby 1.9.3-p194，它可以显着提高 ruby​​ 和 rails 的速度。 [rvm中的猎鹰补丁](https://github.com/wayneeseguin/rvm/blob/master/patches/ruby/1.9.3/p194/falcon.diff)

如果您不想使用 RVM，请下载 ruby​​ src 并应用此补丁。

如果在 Apache 配置中启用了用于反向 DNS 查找的某些参数，也可能是 DNS 问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-11T15:36:09.300

只需将 gem [rails 调整](https://github.com/wavii/rails-dev-tweaks)到您的 gem 文件中，然后运行

```
bundle install 
```

我认为它会解决你的问题。

谢谢

# ruby-on-rails-3 - 找出rails 3中的命名资源/路径

> ID：12373065
> 
> 赞同：0
> 
> 时间：2012-09-11T15:24:08.220
> 
> 标签：ruby-on-rails-3, tdd, capybara, bdd

我是 Rails 新手，我正在使用 Capybara 和黄瓜编写一些测试。

```
Scenario: Successful login
  Given a user "admin@adm.com" with password "admin123"
  And I am on the sign in page

Given /^I am on the sign in page$/ do |page_name|
  visit('/users/sign_in')
  save_and_open_page
end 
```

我无法找到一种方法来编写命名路径而不是 '/users/sign_in' url。

我怎样才能弄清楚？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:24:08.220

这样做的方法是，

进入项目根目录并运行

```
rake routes 
```

这将给出由 rails 处理的所有请求的列表，如下所示：

```
new_user_session GET    /users/sign_in(.:format)        devise/sessions#new
    user_session POST   /users/sign_in(.:format)        devise/sessions#create
destroy_user_session DELETE /users/sign_out(.:format)       devise/sessions#destroy 
```

所以看上面的第一列，我们看到“new_user_session”

这可以写成 new_user_session_path 并放在 visit() 中：

```
visit(new_user_session_path) 
```

而且（据我所知）它工作得很好:)

# svn - 通过 Cisco VPN 更新存储库时，Subversion 报告“格式错误的网络数据”

> ID：12373067
> 
> 赞同：6
> 
> 时间：2012-09-11T15:24:09.127
> 
> 标签：svn, tortoisesvn

我正在使用 Cisco VPN（在 Windows 7 Ultimate 64bit 上）连接到我的公司网络。当我检查 svn 存储库时，我在下载一些文件后 2 或 3 秒内不断收到此错误。

TortoiseSVN 1.5.9 和 SlikSubversion 1.6.17 都出现此问题

我注意到下载像 java 或 xml 这样的文本文件经常会导致这个问题，但下载压缩文件（jar 等）很好。

是我的 SVN 或 VPN 设置错误，还是网络问题？如何让 SVN 记录更多详细信息？

PS：我没有在我的 SVN 中使用任何 SSL 代理。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:36:16.120

有一些原因，为此，我在 windows 系统中看到了这种情况，而不是在 linux 中，

1.  如果您在 Windows 机器中使用防火墙
2.  或者你的杀毒软件扫描网络数据（比如卡巴斯基）

您需要在更新或签出 svn repo 时禁用/添加防火墙例外并禁用防病毒软件中的网络数据扫描，这将解决问题。

你也可能有版本冲突，说你的 svn 是最新的，而你使用的客户端版本较低。

# android - 从虚拟数据库中删除行

> ID：12373069
> 
> 赞同：0
> 
> 时间：2012-09-11T15:24:11.403
> 
> 标签：android

我创建了一个数据库，如下所示：

```
 mDatabase.execSQL(FTS_TABLE_CREATE); 
```

其中`FTS_TABLE_CREATE`：

```
 private static final String FTS_TABLE_CREATE =
                "CREATE VIRTUAL TABLE " + FTS_VIRTUAL_TABLE +
                        " USING fts3 (" +
                        KEY_WORD + ", " +
                        KEY_DEFINITION + ");"; 
```

然后我添加一个新行：

```
public long addTitle(String word) {
            ContentValues initialValues = new ContentValues();
            initialValues.put(KEY_WORD, "test");
            initialValues.put(KEY_DEFINITION, "null");

            return getWritableDatabase().insert(FTS_VIRTUAL_TABLE, null, initialValues);
        } 
```

现在我需要删除它：

```
public void removeTitle(String title) {
            getWritableDatabase().delete(FTS_VIRTUAL_TABLE, KEY_WORD + "=" + title, null);
        } 
```

但我有一个例外：

> android.database.sqlite.SQLiteException：没有这样的列：test：，编译时：DELETE FROM FTStitleslist WHERESuggest_text_1=test

难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:39:58.980

改变这个：

```
getWritableDatabase().delete(FTS_VIRTUAL_TABLE, KEY_WORD + "=" + title, null); 
```

为此（推荐）：

```
getWritableDatabase().delete(FTS_VIRTUAL_TABLE, KEY_WORD + " = ?", new String[]{title}); 
```

或者这个（不推荐）：

```
getWritableDatabase().delete(FTS_VIRTUAL_TABLE, KEY_WORD + "= '" + title + "'", null); 
```

# shell - While Condition 逐行 cat 文件

> ID：12373071
> 
> 赞同：0
> 
> 时间：2012-09-11T15:24:13.997
> 
> 标签：shell, loops, while-loop, conditional-statements, ksh

通常我使用

```
cat filename|while read line; do
echo $line 
```

这很好用......但我想在附加条件的情况下做到这一点。

```
cat filename|while i=2 read line; do
echo $line 
```

现在我知道这行不通，但是我该如何附加条件呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:31:10.333

您需要像这样连接条件：

```
while ((i == 2)) && read line; do 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T18:46:11.400

这是我的最终工作版本.. 适用于 HP、SOL 和 RHEL。

```
cat $NASFILE|while [[ $NFS2 != "Completed" ]] && read line; do 
```

# c# - 我在 url 上收到 WebException 为什么会这样？

> ID：12373074
> 
> 赞同：0
> 
> 时间：2012-09-11T15:24:43.260
> 
> 标签：c#

我有这个代码：

```
private List<string> webCrawler(string url, int levels)
        {
            HtmlAgilityPack.HtmlDocument doc;
            HtmlWeb hw = new HtmlWeb(); 
            List<string> webSites;
            List<string> csFiles = new List<string>();

            csFiles.Add("temp string to know that something is happening in level = " + levels.ToString());
            csFiles.Add("current site name in this level is : "+url);

            doc = hw.Load(url);
            webSites = getLinks(doc);

            if (levels == 0)
            {
                return csFiles;
            }
            else
            {
                int actual_sites = 0;
                for (int i = 0; i < webSites.Count() && i< 20; i++)                 {
                    string t = webSites[i];
                                        if ( (t.StartsWith("http://")==true) || (t.StartsWith("https://")==true) )                     {
                        actual_sites++;
                        csFiles.AddRange(webCrawler(t, levels - 1));
                        Texts(richTextBox1, "Level Number " + levels + " " + t + Environment.NewLine, Color.Red);
                    }
                }

                return csFiles;
            }

        } 
```

getLinks() 是：

```
private List<string> getLinks(HtmlAgilityPack.HtmlDocument document)
        {

            List<string> mainLinks = new List<string>();
            var linkNodes = document.DocumentNode.SelectNodes("//a[@href]");
            if (linkNodes != null)
            {
                foreach (HtmlNode link in linkNodes)
                {
                    var href = link.Attributes["href"].Value;
                    mainLinks.Add(href);
                }
            }
            return mainLinks;

        } 
```

问题是，例如，我爬进了 google.com，所以几次之后它就进入了该网站：

[http://picasa.google.co.il/intl/iw/#utm_source=iw-all-more&utm_campaign=iw-pic&utm_medium=et](http://picasa.google.co.il/intl/iw/#utm_source=iw-all-more&amp;utm_campaign=iw-pic&amp;utm_medium=et)

然后我得到了异常：

```
doc = hw.Load(url); 
```

错误是：无法解析远程名称：'picasa.google.co.il'

例外是：

```
System.Net.WebException was unhandled
  Message=The remote name could not be resolved: 'picasa.google.co.il'
  Source=System
  StackTrace:
       at System.Net.HttpWebRequest.GetResponse()
       at HtmlAgilityPack.HtmlWeb.Get(Uri uri, String method, String path, HtmlDocument doc, IWebProxy proxy, ICredentials creds) in C:\Source\htmlagilitypack\Trunk\HtmlAgilityPack\HtmlWeb.cs:line 1446
       at HtmlAgilityPack.HtmlWeb.LoadUrl(Uri uri, String method, WebProxy proxy, NetworkCredential creds) in C:\Source\htmlagilitypack\Trunk\HtmlAgilityPack\HtmlWeb.cs:line 1563
       at HtmlAgilityPack.HtmlWeb.Load(String url, String method) in C:\Source\htmlagilitypack\Trunk\HtmlAgilityPack\HtmlWeb.cs:line 1152
       at HtmlAgilityPack.HtmlWeb.Load(String url) in C:\Source\htmlagilitypack\Trunk\HtmlAgilityPack\HtmlWeb.cs:line 1107
       at GatherLinks.Form1.webCrawler(String url, Int32 levels) in D:\C-Sharp\GatherLinks\GatherLinks\GatherLinks\Form1.cs:line 79
       at GatherLinks.Form1.webCrawler(String url, Int32 levels) in D:\C-Sharp\GatherLinks\GatherLinks\GatherLinks\Form1.cs:line 108
       at GatherLinks.Form1.webCrawler(String url, Int32 levels) in D:\C-Sharp\GatherLinks\GatherLinks\GatherLinks\Form1.cs:line 108
       at GatherLinks.Form1..ctor() in D:\C-Sharp\GatherLinks\GatherLinks\GatherLinks\Form1.cs:line 31
       at GatherLinks.Program.Main() in D:\C-Sharp\GatherLinks\GatherLinks\GatherLinks\Program.cs:line 18
       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

我该如何修复/修复/解决它？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:27:35.943

例外是告诉您它无法解析`picasa.google.co.il`为 IP 地址。您可能只需要验证名称是否正确。

打开命令窗口并输入：

```
ping picasa.google.co.il 
```

您会发现您的计算机无法与此服务器通信，因为它没有 DNS 条目。

# android - 相机意图过滤器

> ID：12373075
> 
> 赞同：1
> 
> 时间：2012-09-11T15:24:44.383
> 
> 标签：android, camera, intentfilter

我需要一些关于相机意图/过滤器的帮助。以下是我的问题。

*   我应该使用什么意图过滤器来使我的应用程序处理相机意图？
*   是否有任何应用程序可以处理相机意图（ACTION_IMAGE_CAPTURE）？

我想弄清楚的是，如果我通过过滤器 ACTION_IMAGE_CAPTURE 的意图，任何 3rd 方应用程序都可以响应我的请求吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T00:02:15.193

**1\. 我应该使用什么意图过滤器来让我的应用处理相机意图？**

Ans）应该包含在可以处理相机的活动的清单文件意图过滤器中

**2\. 有没有处理相机意图的应用程序（ACTION_IMAGE_CAPTURE）？**

Ans)布丁相机，LINE相机，Uva静音相机免费，..

我很困惑，因为用于调用相机应用程序的意图是 android.provider.MediaStore.ACTION_IMAGE_CAPTURE，而清单文件中使用的意图过滤器是 android.media.action.IMAGE_CAPTURE。

感谢所有回复的人。

谢谢，

赛。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-27T18:00:10.700

您应该将其添加到清单中：

```
 <intent-filter>
            <action android:name="android.media.action.IMAGE_CAPTURE"/>
            <category android:name="android.intent.category.DEFAULT"/>
        </intent-filter>
        <intent-filter>
            <action android:name="android.media.action.STILL_IMAGE_CAMERA"/>
            <category android:name="android.intent.category.DEFAULT"/>
        </intent-filter>
        <intent-filter>
            <action android:name="android.media.action.VIDEO_CAMERA"/>
            <category android:name="android.intent.category.DEFAULT"/>
        </intent-filter> 
```

至于应用程序，有很多应用程序可以处理意图。只需在 Play 商店中搜索“相机”即可。这是谷歌的一个：

[https://play.google.com/store/apps/details?id=com.google.android.GoogleCamera&hl=en](https://play.google.com/store/apps/details?id=com.google.android.GoogleCamera&hl=en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:34:58.750

如果您安装了两个或多个可以处理意图的应用程序，系统将自动提示您使用哪个。如果您需要一些代码来处理结果，请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T15:29:43.557

2：

是的，任何应用程序都可以响应 ACTION_IMAGE_CAPTURE 意图。不知道您的设备上是否有超过 1 个，但您可以轻松试用。（激发意图）

# c# - PowerPoint 以编程方式添加和删除元数据？

> ID：12373076
> 
> 赞同：1
> 
> 时间：2012-09-11T15:24:47.477
> 
> 标签：c#, ms-office, add-in, powerpoint

我想知道是否可以使用 C# 将元数据存储在 PowerPoint 文件中？它应该能够存储相当大量的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T18:16:50.947

当然......应该可以使用 C# 或任何其他可以自动化 PowerPoint 的语言。

每个演示文稿、幻灯片和形状都有一个`.Tags`集合（*字符串的名称/值对*），可以容纳尽可能多的数据。当我很久以前对此进行测试时，我发现相对较少的标签每个都包含大量数据比带有少量数据的大量标签更有效。这是 1 到 1.5 兆字节的字符串数据。

截至 PPT 2007 左右，也有一个二进制标签的编程接口，但我从未使用过它们，所以不能提供太多建议。

我*肯定*会避免将大量数据存储为文档属性。重载 doc props 会对链接产生不必要的副作用。

# javascript - 如何从 iframe 将元素附加到父正文？

> ID：12373079
> 
> 赞同：5
> 
> 时间：2012-09-11T15:24:47.817
> 
> 标签：javascript, jquery

我在 iframe 中有这段代码。

```
<script type="text/javascript">
    $(document).ready(function(){
        $("body").append($("#ctap").html());
    });
</script> 
```

我想将**#ctap**的 html 附加到父正文。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T15:30:39.190

尝试在 document.ready 中执行以下代码

```
parent.$("body").append($("#ctap").html()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:30:12.597

如果**父体**你应该有这样的东西：

```
var iFrame = $('#iframe_id');
var iContent = iFrame.contents().find("#ctap").html();
$("body").append( iContent ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:57:34.963

由于跨域脚本限制，为了能够从 iframe 访问主机页面的内容，它们必须具有完全相同的位置（主机名和端口）。

请参阅[如何使用 iframe 中的函数从父页面中删除 iframe？](https://stackoverflow.com/questions/3033128/how-to-remove-iframe-from-parent-page-using-a-function-inside-the-iframe?rq=1)

# excel - 在 Excel 中通过 VBA 调用 COM 加载项

> ID：12373080
> 
> 赞同：2
> 
> 时间：2012-09-11T15:24:49.440
> 
> 标签：excel, vba, automation, vsto

我有一个用 VSTO 编写的 COM 加载项，我想使用 VBA 宏调用它。使用加载项我需要启动它，输入一些文本（自动），然后运行应用程序。加载项都是按钮，我不能轻易访问代码，因为其中一些是加密的（它是第 3 方）。遗憾的是，单击此加载项时，记录功能没有获取任何活动，并且我无法将其添加到 VBA 上的引用列表中。我已经尝试了几种方法来做到这一点，但到目前为止都没有奏效。

这是我的代码。如所写，它在代码的倒数第二行抛出运行时错误 91 代码。如果我在最后一行列表周围添加括号，则会出现语法错误（预期：=）。我不确定是什么问题？

```
Sub Test()
    Dim addIn As COMAddIn
    Dim automationObject As Object
    Dim SQL_CODE As String
    Dim PW As String
    Dim Name As String
    Set addIn = Application.COMAddIns("Orion2010")
    SQL_CODE = "SELECT startdatetime, tli, serialnumber, keyname FROM vmfgoperationdata WHERE serialnumber in ( '90102072B030H' , '90102072003BF') and operationname = 'Part Scanning')"
    PW = "password"
    Name = "na\npiotrowski"
    Set automationObject = addIn.Object
    automationObject.Utility.RefreshData Name, PW, SQL_CODE
End Sub 
```

# java - Java：在我的多线程应用程序中使用什么类型的列表

> ID：12373083
> 
> 赞同：2
> 
> 时间：2012-09-11T15:25:05.287
> 
> 标签：java, multithreading, list

我是使用线程的新手，只是想弄清楚。我的最终游戏是拥有一个 URL 列表，我的程序将一次从列表中获取一个 URL，并使用该 URL 执行操作。会有很多 URL，当一些线程使用同一个列表时，可能会添加这个列表。

为了开始实验和学习，我使用了一个简单的 ArrayList 填充数字，并使用线程池来获取 URL。这是我的代码：

```
public static void main(String[] args) {

    for (int i = 0; i < 200; i++){
        test.add(i);
    }

    SlothTest runner = new SlothTest();
    Thread alpha = new Thread(runner);
    Thread beta = new Thread(runner);

    ExecutorService tasker = Executors.newFixedThreadPool(10);

    while (!listEmpty()){
        tasker.submit(new SlothTest());
    }

    tasker.shutdown();
    System.out.println("Complete...");
}

@Override
public void run() {
    getLink();
    try {
        Thread.sleep(20);
    } catch (InterruptedException e) {
    }
}

private synchronized String getLink(){
    link = Thread.currentThread().getName() + " printed " + test.indexOf(test.size()-1);
    test.remove(test.size()-1);
    System.out.println(link);
    return link;
}

private synchronized static boolean listEmpty(){
    if (test.size() > 0){
        return false;
    } else {
        return true;
    }
} 
```

在运行程序并为我的输出获得一些-1 时，我遇到了一些并发问题。我不确定为什么会发生这种情况，我知道我上面的代码很粗糙，但我真的处于学习阶段的多线程应用程序。任何人都可以先帮我解决我的并发问题，然后如果你能给我关于我上面的代码的任何指示，那也很好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:30:10.983

一个问题是

```
while (!listEmpty()){
    tasker.submit(new SlothTest());
} 
```

不是原子的。所以`listEmpty`可能会返回 false，但在您到达下一个语句时变为 true。

另一个是您在两个不同的监视器上同步：

```
private synchronized String getLink(){ //synchronized on this

private synchronized static boolean listEmpty(){//synchronized on this.class 
```

您是否考虑[过使用 a`BlockingQueue`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/BlockingQueue.html)而不是列表，它为您想要实现的目标提供了有用的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T15:30:09.283

尝试为您的 URL 列表使用[ConcurrentLinkedQueue 。](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)这是一个很好的实现，经常在生产者-消费者示例中使用，类似于您的（尽管您本身没有活动的“生产者”）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T15:29:07.693

你不是全局同步的。通过使用`synchronized`方法，您可以锁定当前实例，这对于每个任务都是不同的。您应该改用全局锁：

```
final static Object globalLock = new Object();

private String getLink() {
   synchronized (globalLock) {
      link = Thread.currentThread().getName() + " printed " + test.indexOf(test.size()-1);
      test.remove(test.size()-1);                    
   }
   System.out.println(link);
   return link;
}

private boolean listEmpty(){
    synchronized (globalLock) {
       if (test.size() > 0){
          return false;
       } else {
          return true;
       }
    }
} 
```

# javascript - 为什么我在这个 JavaScript 代码中得到 NaN？

> ID：12373087
> 
> 赞同：1
> 
> 时间：2012-09-11T15:25:39.703
> 
> 标签：javascript, nan

首先我测试每个变量都有一个数值：

```
09-11 18:15:00.420:
       d_drop: -1.178791867393647
  drop_at_zero: 0.0731037475605623
   sightHeight: 4.5
    d_distance: 40
     zeroRange: 10

09-11 18:15:00.420:
       d_drop: true
  drop_at_zero: true
   sightHeight: true
    d_distance: true
     zeroRange: true

function isNumber (o) {
  return ! isNaN (o-0) && o != null;
}

 var d_drop; // in calculation this gets value 1.1789

 var d_path = -d_drop - sightHeight + (drop_at_zero + sightHeight) * d_distance / zeroRange;

console.log("Path: " + d_path + " cm"); 
```

并在日志中：

```
09-11 18:15:00.430: D/CordovaLog(1533): Path: NaN cm 
```

为什么？我已经尝试了几个小时，但没有成功，也许有人有想法，我没有！

谢谢！萨米人

--------答案是在使用 + 操作数时解析每个变量-----------

var d_path = parseFloat(-d_drop) - parseFloat(sightHeight) + (parseFloat(drop_at_zero) + parseFloat(sightHeight)) * parseFloat(d_distance) / parseFloat(zeroRange);

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:28:11.937

如果任一操作数是字符串，则加法运算符`+`会将事物转换为字符串。在使用它们之前，您需要将所有输入（ 、 等）解析`d_drop`为`sightHeight`数字。

`+`这是重载如何工作的演示。请注意减法运算符`-`是如何没有重载的，并且总是将操作数转换为数字：

```
var numberA = 1;
var numberB = 2;
var stringA = '3';
var stringB = '4';

numberA + numberB // 3 (number)
numberA - numberB // -1 (number)
stringA + stringB // "34" (string)
stringA - stringB // -1 (number)
numberA + stringB // "14" (string)
numberA - stringB // -3 (number) 
```

[http://jsfiddle.net/jbabey/abwhd/](http://jsfiddle.net/jbabey/abwhd/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T15:30:12.700

您的数字中至少有一个是字符串。`sightHeight`是最有可能的罪魁祸首，因为它会与`drop_at_zero`连接产生一个带有两个小数点的“数字”——这样的“数字”不是数字，因此`NaN`.

解决方法：使用`parseFloat(varname)`转换为数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T15:34:24.220

如果您将`-d_drop`其用作变量名，那可能是罪魁祸首。变量必须以字母开头。

```
var     d_drop = -1.178791867393647,
  drop_at_zero = 0.0731037475605623,
   sightHeight = 4.5,
    d_distance = 40,
     zeroRange = 10;

var d_path = d_drop - sightHeight + (drop_at_zero + sightHeight) * d_distance / zeroRange;

console.log("Path: " + d_path + " cm"); // outputs: Path: 12.613623122848603 cm 
```

# c# - Cron 作业 asp.net

> ID：12373091
> 
> 赞同：0
> 
> 时间：2012-09-11T15:25:47.673
> 
> 标签：c#, asp.net, sql, sql-server, cron

我有一个时钟输入和时钟输出模块，用于记录来自 Asp.NET 应用程序的工作人员的开始时间和结束时间。

我想问如何为 asp.net 应用程序做 cron 工作，以查看工作人员是否没有在该日期或星期输入他们的时间，并发送电子邮件通知以提醒他们输入开始时间和结束时间。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-11T15:29:24.680

ASP.NET 是不适合这项工作的工具。您最好编写一个在计划任务上运行的[控制台应用程序，或者编写一个定期轮询的](http://msdn.microsoft.com/en-us/library/ms438026.aspx)[Windows 服务](http://msdn.microsoft.com/en-us/library/d56de412%28v=vs.80%29.aspx)。ASP.NET 纯粹用于请求/响应模型。

任何一个都可以访问网站正在读取/写入的任何数据存储，就像 ASP.NET 站点一样容易。

如果您都没有这样做，那么控制台应用程序是迄今为止最容易编写和实现的。与控制台应用程序可能的 XCOPY 部署模型相比，Windows 服务并没有那么糟糕，但涉及额外的开销，包括调试困难，以及需要经历一个[特殊的安装过程。](http://support.microsoft.com/kb/816169)

如果您***真的***想在 ASP.NET 中执行此操作，您可以编写一个执行此操作的 asp.net 网页，并使用 Windows 计划任务来运行它。计划任务可以将 Internet Explorer 打开到特定页面，就像它可以运行任何可执行文件一样容易。 ***但我不会推荐它***。任务完成后，您将永远必须关闭 IE 窗口，这实际上是一个“hackish”解决方案。当我还是一个纯粹的 Web 开发人员时，我就这样做了，并且不知道更好，但从那以后就没有了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-11T15:39:32.867

Jeff Atwood 在 Stack Overflow 博客上发表了题为“ ASP.NET 中的[简单后台任务](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/)”的文章，该博客在该网站的早期发布了关于在 ASP.NET 中执行后台任务的简单方法。如果您的任务相对较轻，这可能不是一个坏方法。如果您有理由真正希望将所有内容保留在现有的 ASP.NET 应用程序中，那么这可能是您要走的路。

要点：

1.  在启动时，向 HttpRuntime.Cache 添加一个具有固定过期时间的项目。
2.  当缓存项过期时，做你的工作，比如 WebRequest 或者你有什么。
3.  将项目重新添加到具有固定过期时间的缓存中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:34:13.110

尽管从技术上讲，它不是一项 cron 工作，但您可以在网站内让网站在一天中的 X 时间调用设置的页面。

我已经通过 web 方法调用完成了几次，从应用程序启动开始在计时器上调用该方法。

基本解释在这里： [Call a pages from c# in code](https://stackoverflow.com/questions/302775/call-a-webpage-from-c-sharp-in-code/303036#303036)

# magento - Magento 中 getPaymentHtml() 的输出

> ID：12373093
> 
> 赞同：2
> 
> 时间：2012-09-11T15:25:53.117
> 
> 标签：magento

我一直无法找到输出的`getPaymentHtml()`来源。

其定义为：

`public function getPaymentHtml() { return $this->getChildHtml('payment_info'); }`

我找不到`payment_info`块的模板。

基本上我希望能够在结帐的进度块中检索信用卡类型和信用卡号。

如何找出方法名称？就像是`$this->getCreditCardType()`

编辑：好的！我了解 Magento 会首先确定付款方式，该方式具有用于呈现输出的相应模板。但是在`progress.phtml`结帐时，`var_dump( $this instanceof Mage_Payment_Block_Info_Cc );`返回false，那么我如何在当前上下文中访问它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:47:18.350

The Progress block doen't have it's own template for Payment info. Mage_Checkout_Block_Onepage_Payment_Info block uses the selected Payment Method block to output html. Look at the `Mage_Checkout_Block_Onepage_Payment_Info::_toHtml()` method:

```
protected function _toHtml()
{
    $html = '';
    if ($block = $this->getChild($this->_getInfoBlockName())) {
        $html = $block->toHtml();
    }
    return $html;
} 
```

To find the actual template and block for the specific Payment method you use, you need to perform next steps:

1.  First - get model alias for current payment method `Mage::getStoreConfig('payment/'.$yourMethod.'/model')` and instantiate it using `Mage::getModel(alias)`
2.  then get block type using $model->getInfoBlockType() - so you'll be able to find the actual Block by it's type

For example for **ccSave** payment method the info block is Mage_Payment_Block_Info_Ccsave, and template for it is app\design\frontend\base\default\template\payment\info\default.phtml. You'll be able to find all data inside those. Good luck ;)

For the sake of completeness, exact functions to fetch CC type and last 4 digits of CC number are:

```
echo Mage::getSingleton('checkout/session')->getQuote()->getPayment()->getCcType();
echo Mage::getSingleton('checkout/session')->getQuote()->getPayment()->getCcLast4(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:47:29.273

The block class is declared in layout update XML; see the [onepage checkout](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/design/frontend/base/default/layout/checkout.xml#L350) and [multishipping](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/design/frontend/base/default/layout/checkout.xml#L271) directives from *checkout.xml*. The actual child block which is used depends on the payment model which is being used, but there is a common template that will be used unless overridden.

Example:

*   See the generic CC method model [`Mage_Payment_ModelMethod_Cc`](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/code/core/Mage/Payment/Model/Method/Cc.php#L31)
*   From that see its info block [`Mage_Payent_Block_Info_Cc`](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/code/core/Mage/Payment/Block/Info/Cc.php)...
*   ...which will lead you to the "base" payment info block [`Mage_Payment_Block_Info`](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/code/core/Mage/Payment/Block/Info.php) which [sets a default template](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/code/core/Mage/Payment/Block/Info.php#L43).

# actionscript-3 - 如何检查 swf 是否在 AS3 中没有聚焦

> ID：12373100
> 
> 赞同：2
> 
> 时间：2012-09-11T15:26:09.503
> 
> 标签：actionscript-3, click, focus, flash

我只是认为知道如何检查 swf 是否已被聚焦会很有用。当最终用户在舞台外（例如在浏览器的地址栏上）单击时，就会出现这种情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T15:26:09.503

```
stage.addEventListener(Event.DEACTIVATE, notFocused);
stage.addEventListener(Event.ACTIVATE, focused);
function notFocused(e:Event) {
    trace("Not focused");
}
function focused(e:Event) {
    trace("Focused");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T05:34:19.263

我们也可以在 AIR 应用程序中使用 NativeApplication。

```
import flash.desktop.NativeApplication;
import flash.events.Event;

NativeApplication.nativeApplication.addEventListener(Event.ACTIVATE, onActivate);
NativeApplication.nativeApplication.addEventListener(Event.DEACTIVATE, onDeactivate);

function onActivate(e:Event){
        trace("Activate");
}

function onDeactivate(e:Event){
    trace("Deactivate");
} 
```

# database - Vertica 是否支持虚拟列？

> ID：12373102
> 
> 赞同：-1
> 
> 时间：2012-09-11T15:26:12.183
> 
> 标签：database, currency, create-table, vertica

**Vertica**是否支持**虚拟列？** *我阅读了文档，但找不到它！*

用途：我有一张桌子：

```
create table test(
id number,
name varchar(12),
account data_type as function_name
); 
```

*   由于 Vertica 不支持美国以外其他国家/地区的货币格式，因此当我填充包含货币列的表格时，我正在寻找一种解决方法。
*   我将在 C++ 中创建一个特殊的格式函数，然后应用于列定义。

这可能吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-12T15:10:14.143

我找到了解决我的问题的方法：

```
dbadmin=> SELECT translate(to_char(123456.77,'R$ 999G999G999D99'), ',.', '.,');
     translate
--------------------
 R$      123.456,77
(1 row) 
```

通过使用翻译功能，我可以替换输出中的字符串片段。谢谢

# javascript - 如何将 CSS（特别是 padding/margin ）应用于选择下拉列表的选项或 optgroup？

> ID：12373104
> 
> 赞同：3
> 
> 时间：2012-09-11T15:26:19.700
> 
> 标签：javascript, asp.net, html

填充或边距 CSS 仅适用于 FF 浏览器中的选项。我在 IE chrome 中尝试过同样的事情，但不起作用。有人可以让我知道我们如何在选择菜单中设置样式（填充/边距）选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T09:03:57.627

有一个[DropKick JQuery 库](http://jamielottering.github.com/DropKick/)，您可以在其中自定义下拉菜单（它会自动用此元素替换本机下拉菜单，因此您无需替换`<select>`html 代码中的元素。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-07-11T16:35:53.080

您不会看到填充或边距选项。那是因为不需要它。我通常做的是将选择下拉列表包装在一个 div 中并设置它的样式。

.myDropdown select{ 边框：实心 1px 红色；字体粗细：正常；宽度：300 像素；高度：40 像素；字体大小：12 像素；背景：#FFC；}

填充不可用的原因是因为它确实不需要。您可以调整框的高度或宽度以及字体大小。调整高度和宽度实质上会在选择中的文本周围增加更多空间。除了调整这些设置之外，其他任何事情都只是矫枉过正。如果您真的想要对样式进行如此多的控制，请使用 jQuery UI 或 bootstrap 之类的东西。

# c# - 连接分层对象列表

> ID：12373115
> 
> 赞同：2
> 
> 时间：2012-09-11T15:27:08.877
> 
> 标签：c#, recursion

我有一个`List<T>`where T 有属性 .Next 的地方。

该列表包含以下数据：

```
One
Two
Three
Four
Five 
```

我想做这个：

```
One.Next = Two;
Two.Next = Three;
Three.Next = Four;
Four.Next = Five; 
```

五.Next 是 null 作为它的最后一个元素

一个应该分配给相同类型的单个变量。

如果没有很多 ifs/while/hacks 我怎么能做到这一点？

**更新**

结果变量不应是匿名类型。

我需要一个相同类型的返回变量，例如 IEnumerable> 或 List>

我也忘了提到我使用的是开放的泛型类型而不是封闭的泛型类型。

对不起，错误信息！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:35:57.130

您可以使用`LinkedList`其他人已经建议的 a 或[`ElementAtOrDefault`](http://msdn.microsoft.com/en-us/library/bb494386.aspx)：

```
var result = list.Select((s,i) => new { This=s, Next=list.ElementAtOrDefault(i+1) });   
foreach(var x in result)
    Console.WriteLine("{0}.{1}",x.This,x.Next); 
```

这是演示：http: [//ideone.com/Qwiwc](http://ideone.com/Qwiwc)

* * *

> 结果变量不应是匿名类型。我需要一个与 IEnumerable> 或 List> 相同类型的返回变量，我还忘了提到我使用的是开放的泛型类型而不是封闭的泛型类型。

**编辑**：这是另一种使用 a 的方法`IEnumerable<Tuple<T, T>>`：

```
public static IEnumerable<Tuple<TSource, TSource>> ToLinkedSequence<TSource>(this IEnumerable<TSource> input)
{
    return input.Select((x,i) => Tuple.Create(x, input.ElementAtOrDefault(i + 1)));
} 
```

你将如何使用它：

```
var sequence = new[] { "One", "Two", "Three", "Four", "Five" };
var linkedSequence = sequence.ToLinkedSequence();
foreach (var x in linkedSequence)
    Console.WriteLine("{0}.{1}", x.Item1, x.Item2); 
```

[元组类](http://msdn.microsoft.com/en-us/library/dd268536.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:30:15.093

```
for(int i = 0;i < list.Count;++i)
    list[i].Next = i < list.Count - 1 ? list[i + 1] : null; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:30:02.293

您可以创建一个 LinkedList

```
 List<string> s = new List<string> {"one", "two", "three", "four", "five"};
  LinkedList<string> ls = new LinkedList<string>(s); 
```

如果你这样做**LinkedList.First**你会得到**LinkedListNode**有你想要的**Next**设置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T15:31:28.643

```
public interface INextable<T>
{
  public T Next {get;set;}
}

List<MyClass> list = new List<MyClass>(); // Where MyClass implements INextable<MyClass>
var query = list.Zip(list.Skip(1), (a, b) => new
{
    First = a,
    Second = b
});

foreach (var item in query)
{
    item.First.Next = item.Second;
} 
```

# android - 更改持续时间 android 音频播放器

> ID：12373122
> 
> 赞同：0
> 
> 时间：2012-09-11T15:27:48.357
> 
> 标签：android, audio, duration

我创建了一个音频播放器，并且我的项目中有一个用于处理持续时间的课程。如何确保 totalDuration 以相反的方向计算？

```
public class Utilities {
public String milliSecondsToTimer(long milliseconds){
    String finalTimerString = "";
    String secondsString = "";
    // Convert total duration into time
    int hours = (int)( milliseconds / (1000*60*60));
    int minutes = (int)(milliseconds % (1000*60*60)) / (1000*60);
    int seconds = (int) ((milliseconds % (1000*60*60)) % (1000*60) / 1000);
    // Add hours if there
    if(hours > 0){
        finalTimerString = hours + ":";
    }
    // Prepending 0 to seconds if it is one digit
    if(seconds < 10){
        secondsString = "0" + seconds;
    }else{
        secondsString = "" + seconds;}
    finalTimerString = finalTimerString + minutes + ":" + secondsString;
    // return timer string
    return finalTimerString;
}

public int getProgressPercentage(long currentDuration, long totalDuration){
    Double percentage = (double) 0;
    long currentSeconds = (int) (currentDuration / 1000);
    long totalSeconds = (int) (totalDuration / 1000);
    // calculating percentage
    percentage =((((double)currentSeconds)/totalSeconds)*100);
    // return percentage
    return percentage.intValue();
}

public int progressToTimer(int progress, int totalDuration) {
    int currentDuration = 0;
    totalDuration = (int) (totalDuration / 1000);
    currentDuration = (int) ((((double)progress) / 100) * totalDuration);
    // return current duration in milliseconds
    return currentDuration * 1000;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:57:30.120

很难弄清楚你想要做什么。也许您可以编辑您的问题以更好地解释？您是否希望 currentDuration 从 totalDuration 倒计时到 0？

我想你可能想要这个：

```
currentDuration = (int) totalDuration - ((((double)progress) / 100) * totalDuration); 
```

# git - "Checkout" 修改 Git 中的文件以进行部署

> ID：12373126
> 
> 赞同：0
> 
> 时间：2012-09-11T15:27:55.283
> 
> 标签：git

所以我决定在本地安装 Windows 版本的 Git（我做 Unix web 开发，也做 .NET 开发，所以在 UNIX 上为我的 .NET 项目运行 Git 似乎很迂回）。

对于 Web 开发工作，我将自己使用 FTP 进行部署，但想问：有没有方便的方法让 Git 为文件子集（例如特定分支中的所有文件）构建目录结构？

例如：假设我有这个 Web 服务器文件结构

```
/public_html/index.php
/public_html/config.php
/public_html/style/style.css
/public_html/style/typography.css 
```

在本地我只修改 index.php 和 style.css

如果有某种方法可以“签出”这些文件并让它构建它们的完整文件路径，那就太好了。在 Visual Source Safe 中，它实际上将所有文件存储在 VSS 数据库中。因此，您可以删除您的工作副本，并签出一些文件，它会将它们写入您的工作目录中相应的目录结构中。GIT中有类似的东西吗？如果是这样，那么我可以导出修改后的文件并将根文件夹（/public_html）上传到服务器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T23:51:54.580

退房[`git diff-tree`](http://www.kernel.org/pub/software/scm/git/docs/git-diff-tree.html)。您可以使用它比较两个提交树的状态并确定哪些文件已更改。例如：

```
git diff-tree --name-status -r `git merge-base master mybranch` mybranch 
```

将显示任何已更改文件的名称和状态。如果您确定仍会正确处理已删除文件之类的事情，您也可以使用`--name-only`代替。`--name-status`

（当然，使用 `` 的命令替换是 UNIX-shell 结构；在 Windows 上，您可能需要使用 FOR /F 之类的东西。）

然后，您可以将此命令列出的文件传递给`git checkout`. 如果要将文件检出到单独的目录中，可以使用`--work-tree`参数：

```
git --work-tree=path/to/build checkout mybranch -- file file file... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:05:07.563

您可以使用以下命令恢复索引的最新副本`file`：

```
git checkout HEAD -- <file> 
```

因此，如果您删除了工作目录中的文件，则可以使用该命令“恢复”它。

# ruby-on-rails - Rails 多态关联 - 拉取评论者姓名

> ID：12373127
> 
> 赞同：0
> 
> 时间：2012-09-11T15:27:55.550
> 
> 标签：ruby-on-rails, polymorphic-associations

我为我的评论设置了多态关联设置。它似乎终于可以正常工作并正确保存所有数据。不过，我无法通过这种关系来提取评论者的姓名。

```
<div class="span5">
  <%= comment.commenter.name %>
  <%= comment.body %>
</div> 
```

我的评论数据库中的数据是正确的。Commenter 对应于 user_id。

```
<Comment id: 9, commenter: 2, subject: nil, body: "whaa", commentable_id: 1, commentable_type: "User", created_at: "2012-09-11 14:58:36", updated_at: "2012-09-11 14:58:36"> 
```

这里的模型：

```
class Comment < ActiveRecord::Base

  belongs_to :commentable, :polymorphic => true

  attr_accessible :body, :commentable_id, :commentable_type, :commenter, :subject

end

class User < ActiveRecord::Base

  has_many :comments, :as => :commentable

  accepts_nested_attributes_for :comments, :reject_if => lambda { |a| a[:body].blank? }

end 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:56:11.107

如果`Comment`'s`:commenter`是 ' 列的外键`User`，则`:id`需要在`Comment`模型中定义此关系

```
belongs_to :commenter, class_name: "User", foreign_key: :commenter 
```

`User`和你模型的另一面

```
has_many :authored_comments, class_name: "Comment" 
```

现在你可以访问所有`Comment`sa`User`写的

```
u = User.find(some_id)
u.authored_comments 
```

与`User` *（可能由其他人撰写的）相关的评论*

```
u.comments 
```

和一些作者`Comment`

```
c = Comment.find(some_id)
c.commenter
c.commenter.name # their :name attribute 
```

# image - 带有自由变换的 html5 kineticjs 将图像保存到 Web 服务

> ID：12373129
> 
> 赞同：1
> 
> 时间：2012-09-11T15:28:02.590
> 
> 标签：image, html, save, transform, kineticjs

我需要使用动力学来使用锚点转换一张图像。我找到了这个例子： [http ://www.html5canvastutorials.com/labs/html5-canvas-drag-and-drop-resize-and-invert-images/](http://www.html5canvastutorials.com/labs/html5-canvas-drag-and-drop-resize-and-invert-images/)

然后我只需要保存一个图像 - yoda 图像（id：myImg）并发送到 Web 服务。我在储蓄部分遇到问题。

任何人都可以帮忙吗？我不确定一切是否正确，因为当 btnsave - Object #Class has no method 'replace' index.html:187 时出现此错误

## 代码

```
<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
      canvas {
        border: 1px solid #9C9898;
      }
    </style>
        <script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.0.0.js"></script>
    <script>
      function update(group, activeAnchor) {
        var topLeft = group.get(".topLeft")[0];
        var topRight = group.get(".topRight")[0];
        var bottomRight = group.get(".bottomRight")[0];
        var bottomLeft = group.get(".bottomLeft")[0];
        var image = group.get(".image")[0];

        // update anchor positions
        switch (activeAnchor.getName()) {
          case "topLeft":
            topRight.attrs.y = activeAnchor.attrs.y;
            bottomLeft.attrs.x = activeAnchor.attrs.x;
            break;
          case "topRight":
            topLeft.attrs.y = activeAnchor.attrs.y;
            bottomRight.attrs.x = activeAnchor.attrs.x;
            break;
          case "bottomRight":
            bottomLeft.attrs.y = activeAnchor.attrs.y;
            topRight.attrs.x = activeAnchor.attrs.x;
            break;
          case "bottomLeft":
            bottomRight.attrs.y = activeAnchor.attrs.y;
            topLeft.attrs.x = activeAnchor.attrs.x;
            break;
        }

        image.setPosition(topLeft.attrs.x, topLeft.attrs.y);

        var width = topRight.attrs.x - topLeft.attrs.x;
        var height = bottomLeft.attrs.y - topLeft.attrs.y;
        if(width && height) {
          image.setSize(width, height);
        }
      }
      function addAnchor(group, x, y, name) {
        var stage = group.getStage();
        var layer = group.getLayer();

        var anchor = new Kinetic.Circle({
          x: x,
          y: y,
          stroke: "#666",
          fill: "#ddd",
          strokeWidth: 2,
          radius: 8,
          name: name,
          draggable: true
        });

        anchor.on("dragmove", function() {
          update(group, this);
          layer.draw();
        });
        anchor.on("mousedown touchstart", function() {
          group.setDraggable(false);
          this.moveToTop();
        });
        anchor.on("dragend", function() {
          group.setDraggable(true);
          layer.draw();
        });
        // add hover styling
        anchor.on("mouseover", function() {
          var layer = this.getLayer();
          document.body.style.cursor = "pointer";
          this.setStrokeWidth(4);
          layer.draw();
        });
        anchor.on("mouseout", function() {
          var layer = this.getLayer();
          document.body.style.cursor = "default";
          this.setStrokeWidth(2);
          layer.draw();
        });

        group.add(anchor);
      }
      function loadImages(sources, callback) {
        var images = {};
        var loadedImages = 0;
        var numImages = 0;
        for(var src in sources) {
          numImages++;
        }
        for(var src in sources) {
          images[src] = new Image();
          images[src].onload = function() {
            if(++loadedImages >= numImages) {
              callback(images);
            }
          };
          images[src].src = sources[src];
        }
      }
      function initStage(images) {
        var stage = new Kinetic.Stage({
          container: "container",
          width: 578,
          height: 400
        });
        var darthVaderGroup = new Kinetic.Group({
          x: 270,
          y: 100,
          draggable: true
        });
        var yodaGroup = new Kinetic.Group({
          x: 100,
          y: 110,
          draggable: true
        });
        var layer = new Kinetic.Layer();

        /*
         * go ahead and add the groups
         * to the layer and the layer to the
         * stage so that the groups have knowledge
         * of its layer and stage
         */
        layer.add(darthVaderGroup);
        layer.add(yodaGroup);
        stage.add(layer);

        // darth vader
        var darthVaderImg = new Kinetic.Image({
          x: 0,
          y: 0,
          image: images.darthVader,
          width: 200,
          height: 138,
          name: "image"
        });

        darthVaderGroup.add(darthVaderImg);
        addAnchor(darthVaderGroup, 0, 0, "topLeft");
        addAnchor(darthVaderGroup, 200, 0, "topRight");
        addAnchor(darthVaderGroup, 200, 138, "bottomRight");
        addAnchor(darthVaderGroup, 0, 138, "bottomLeft");

        darthVaderGroup.on("dragstart", function() {
          this.moveToTop();
        });
        // yoda
        var yodaImg = new Kinetic.Image({
          x: 0,
          y: 0,
          image: images.yoda,
          width: 93,
          height: 104,
          name: "image",
      id: "myImg"
        });

        yodaGroup.add(yodaImg);
        addAnchor(yodaGroup, 0, 0, "topLeft");
        addAnchor(yodaGroup, 93, 0, "topRight");
        addAnchor(yodaGroup, 93, 104, "bottomRight");
        addAnchor(yodaGroup, 0, 104, "bottomLeft");

        yodaGroup.on("dragstart", function() {
          this.moveToTop();
        });

        stage.draw();

            $("#btnSave").click(function () {
                var image = stage.get("#myImg")[0];
                 image = image.replace('data:image/png;base64,', '');

                 $.ajax({
                    type: 'POST',
                    url:  domain + '/Services/WS.asmx/UploadImage',
                    data: '{ "imageData" : "' + image + '" }',
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (msg) {
                       alert(msg.d);
                    }
                 });
              });   
      }

      window.onload = function() {
        var sources = {
          darthVader: "http://www.html5canvastutorials.com/demos/assets/darth-vader.jpg",
          yoda: "http://www.html5canvastutorials.com/demos/assets/yoda.jpg"
        };
        loadImages(sources, initStage);
      };

    </script>
  </head>
  <body onmousedown="return false;">
    <div id="container"></div>
    <input type="button" id="btnSave" name="btnSave" value="Save the canvas to server" />

  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T16:57:48.630

你可能需要对所有内容进行字符串化，

例如：

```
$.ajax({
        type: "POST",
        contentType: "application/json; charset=utf-8",
        url: "/WS/SaveObject.asmx/fSaveToDB"),
        data: JSON.stringify({ _obj: this }),
        dataType: "json"
    }); 
```

我之前遇到了一个大问题，我把它串起来后开始工作

# jaxb - 复杂的 JAXB 解组为多个对象

> ID：12373130
> 
> 赞同：2
> 
> 时间：2012-09-11T15:28:07.280
> 
> 标签：jaxb, jaxb2

我是 JAXB 的新手，目前正在从事一个需要将复杂的 XML 解组为多个嵌套对象的项目。例如假设我有以下 XML

```
 <person>
     <bio>
          <id>12345</id>
          <name>Keth TTT</name>
          <age>30</age>
     </bio>
     <address>
           <no>1232</no>
           <street>York Street</street>
           <city>NewYork<city>
           <country>USA</country>
     </address>
 </person> 
```

并假设我有以下域对象

```
class Person{
    String id;
    String name;
    int age;
    Address address;
} 
```

和

```
class Address{
    String name;
    String no;
    String street;
    String city;
    String country;
} 
```

如果 XSD 正在 mtaching 或具有匹配的结构，JAXB 将轻松填充这些 POJO。但是在这里我们需要做复杂的映射（例如：`Person`和`Address`类都包含相同的属性名称）。我们如何穿越这些对象并填充这两个对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:11:53.983

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

您可以将 MOXy 的`@XmlPath`扩展用于您的用例。你的`Person`课程看起来像：

```
import javax.xml.bind.annotations*;
import org.eclipse.persistence.oxm.annotations.XmlPath;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
class Person{

    @XmlPath("bio/id/text()")
    String id;

    @XmlPath("bio/name/text()")
    String name;

    @XmlPath("bio/age/text()")
    int age;

    Address address;
} 
```

要将 MOXy 指定为您的 JAXB 提供程序，您需要包含一个`jaxb.properties`在与域模型相同的包中调用的文件，其中包含以下条目（请参阅：[http ://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as -你的.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)）：

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/07/xpath-based-mapping.html](http://blog.bdoughan.com/2010/07/xpath-based-mapping.html)
*   [http://blog.bdoughan.com/2010/09/xpath-based-mapping-geocode-example.html](http://blog.bdoughan.com/2010/09/xpath-based-mapping-geocode-example.html)
*   [http://blog.bdoughan.com/2011/03/map-to-element-based-on-attribute-value.html](http://blog.bdoughan.com/2011/03/map-to-element-based-on-attribute-value.html)

# c# - 扔; 据说不会重置堆栈跟踪，但在某些情况下会这样做

> ID：12373134
> 
> 赞同：10
> 
> 时间：2012-09-11T15:28:18.003
> 
> 标签：c#, .net

> **可能重复：**
> [重新抛出错误的堆栈跟踪](https://stackoverflow.com/questions/4217616/incorrect-stacktrace-by-rethrow)

人们普遍认为，在 .NET`throw;`中不会重置堆栈跟踪，但`throw ex;`会重置。

但是，在这个简单的程序中，我得到了不同的行号：

```
void Main()
{
    try
    {
        try
        {
            Wrapper(); // line 13
        }
        catch(Exception e)
        {
            Console.WriteLine(e.ToString());
            throw; // line 18
        }
    }
    catch(Exception e)
    {
          Console.WriteLine(e.ToString());
    }
}

public void Wrapper()
{
    Throw(); // line 28
}

public void Throw()
{
    var x = (string)(object)1; // line 33
} 
```

输出是：

> System.InvalidCastException：无法将“System.Int32”类型的对象转换为“System.String”类型。在 C:\long-path\Program.cs:line 13 中的 ConsoleApplication2.Program.Main(String[] args)
> 
> System.InvalidCastException：无法将“System.Int32”类型的对象转换为“System.String”类型。在 C:\long-path\Program.cs:line 18 中的 ConsoleApplication2.Program.Main(String[] args)

注意：第一个堆栈跟踪包含第 13 行，第二个包含第 18 行。此外，第 13 行和第 18 行都不是实际发生强制转换的行。

我现在的问题是：在什么情况下会`throw;`更改堆栈跟踪，在什么情况下不会更改堆栈跟踪？

请注意，这已经[被观察到](https://stackoverflow.com/questions/7570328/re-throw-exception-in-task-tpl-loses-stack-trace)，但一般没有回答。

* * *

**更新：**
我在调试模式下运行了上面的代码，它产生了这个：

> System.InvalidCastException：无法将“System.Int32”类型的对象转换为“System.String”类型。在 C:\long-path\Program.cs 中的 ConsoleApplication2.Program.Throw() 处：第 33 行在 C:\long-path\Program.cs 中的 ConsoleApplication2.Program.Wrapper() 处：ConsoleApplication2.Program.Main 中的第 28 行(String[] args) 在 C:\long-path\Program.cs:line 13
> 
> System.InvalidCastException：无法将“System.Int32”类型的对象转换为“System.String”类型。在 C:\long-path\Program.cs 中的 ConsoleApplication2.Program.Throw() 处：第 33 行在 C:\long-path\Program.cs 中的 ConsoleApplication2.Program.Wrapper() 处：ConsoleApplication2.Program.Main 中的第 28 行(String[] args) 在 C:\long-path\Program.cs:line 18

请注意：最后的行号仍然会改变

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T15:57:40.447

发生这种情况的原因是因为在 Release 模式下运行时方法内联。如果您不希望`Wrapper`and`Throw`方法在 Release 模式下内联，您可以使用`[MethodImpl]`属性装饰它们：

```
[MethodImpl(MethodImplOptions.NoInlining)]
public void Wrapper()
{
    Throw();
}

[MethodImpl(MethodImplOptions.NoInlining)]
public void Throw()
{
    var x = (string)(object)1;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-11T16:09:42.050

正如 Darin 已经指出的那样，减少的堆栈跟踪是由于方法内联。但是，堆栈跟踪中可用的线参考点也不相等。

我不知道这背后的解释，但是有一种方法可以让您在重新抛出异常时保留所有堆栈跟踪信息。您需要抛出一个新异常并将捕获的异常作为内部异常传递。使用这种方法，合并的堆栈跟踪将包含异常的起源点以及重新抛出异常的点。

我谈到了这一点，并在以下博客文章中提供了有关重新引发异常的不同方法的完整示例：

[.NET 异常 - throw ex 是邪恶的，但 throw 不是那么无辜](http://exceptionalcode.wordpress.com/2010/04/13/net-exceptions-throw-ex-is-evil-but-throw-is-not-that-innocent/)

* * *

您的评论促使我进行快速研究，但我能找到的最好的是 Jonathan de Halleux 在一篇关于[catch and](http://blogs.msdn.com/b/jmstall/archive/2007/02/07/catch-rethrow.aspx) rethrow 的博客文章中的评论：

> 它还会在重新抛出的方法中更改堆栈跟踪中的行号（因为重新抛出成为该方法中的抛出位置）。

这可以进一步详细说明，但它指出了这样一个事实，即可能会在每个方法处跟踪将用于获取线路信息的抛出站点，并且重新抛出会导致它被覆盖。

因此，即使在使用时保留堆栈跟踪`throw`而不是`throw e`原始抛出站点也会丢失，除非您包装并抛出新异常。

[其他要尝试的事情；由于 SO 不允许直接发送消息，并且上述评论是由[Peli](https://stackoverflow.com/users/14403/peli)发表的，因此您可以尝试标记此问题以`pex`引起他的注意并让他跟进该评论。:)]

# datagrid - 动态控制dojo DataGrid列的编辑模式

> ID：12373135
> 
> 赞同：0
> 
> 时间：2012-09-11T15:28:18.920
> 
> 标签：datagrid, dojo, grid

我刚开始使用 dojo 并开始玩弄它。基本上我想要做的是我有一个包含 2 列 A 和 B 的表。B 列中的单元格将被锁定或可编辑，具体取决于 A 列的值。

有没有办法在单元格级别而不是在布局中定义的列级别设置可编辑属性？

我尝试使用格式化程序，但无法使其正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T18:30:43.050

您可以覆盖网格功能`onCellDblClick`- 但这是特定于版本的代码。如果你的页面中 dojo.version 发生了变化，那么网格 Event.js 可能会有其他的行为。以下片段取自**... /dojox/grid/_Event.js**版本*1.7.2*。

如果您的编辑设置为通过双击单元格触发（默认行为），您可以选择简单地忽略它，并`return`在以下位置放置好：

```
 var customOnEditActivate = function(e){
            // summary:
            //              Event fired when a cell is double-clicked.
            // e: Event
            //              Decorated event object contains reference to grid, cell, and rowIndex
            var event;
            if(this._click.length > 1 && has('ie')){
                    event = this._click[1];
            }else if(this._click.length > 1 && this._click[0].rowIndex != this._click[1].rowIndex){
                    event = this._click[0];
            }else{
                    event = e;
            }
////
// entrypoints of interest: event.cell & event.cellNode(.innerHTML)
// As example we could ignore editing mode if cell contains 'NON_EDITABLE'

if(cell.innerHTML.match("NON_EDITABLE"))
     return;

//
////
            this.focus.setFocusCell(event.cell, event.rowIndex);
            this.onRowClick(event);
            this.edit.setEditCell(event.cell, event.rowIndex);
            this.onRowDblClick(e);
    }, 
```

因此，在初始化网格时，将配置参数设置`onCellDblClick`为上述函数：

```
require(["dojox/grid/DataGrid"], function(DataGrid) {
  var grid = new DataGrid({
    onCellDblClick: customOnEditActivate
  });
}); 
```

或者

```
<div 
      data-dojo-type="dojox.grid.DataGrid" 
      data-dojo-props="onCellDblClick: customOnEditActivate"
></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T18:58:09.063

我得到了以下工作（类似于 Ed Jellard 的建议）：

```
<script type="dojo/require">
    jsonRestStore : "dojox/data/JsonRestStore",
    contentPane   : "dijit/layout/ContentPane",
    dataGrid      : "dojox/grid/DataGrid"
</script>

<div dojoType="dijit.layout.ContentPane">
  <script type="dojo/method">
      configStore = new dojox.data.JsonRestStore
        ( { target : "/data/config",
            idAttribute : "propertyName" } );

      configStructure =
          [ {field:'propertyName', name:'Property - Name',
               width:20},
            {field:'value', name:'Value',
               editable:true},
            {field:'guiConfigurable', name:'Property Type'},
            {field:'description', name:'Description'}
          ];
  </script>
</div>

<table data-dojo-type="dojox.grid.DataGrid"
       store="configStore"
       structure=configStructure>
    <script type="dojo/method" event="canSort" args="sortInfo">
        return false;
    </script>
    <script type="dojo/method" event="onApplyCellEdit" >
        configStore.save();
    </script>
    <script type="dojo/method" event="canEdit" args="inCell, inRowIndex">
        var gc = this.getItem(inRowIndex).guiConfigurable;
        return gc == 'W' || gc == 'D';
    </script>
    <tbody/>
</table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T22:31:57.487

你可以覆盖

`canEdit: function(inCell, inRowIndex)`

数据网格的方法。从那里，你可以得到项目：

`this.getItem(inRowIndex)`

然后确定它是否应该是可编辑的，并返回真/假。

# drupal - 没有调用drupal 7 ctool模态表单自定义提交处理程序

> ID：12373139
> 
> 赞同：1
> 
> 时间：2012-09-11T15:28:24.103
> 
> 标签：drupal, drupal-webform, drupal-ctools

我有一个要求，我需要在 ctool 模式中显示网络表单。当用户提交网络表单时，它应该在相同的 ctool 模式中显示确认消息。这个功能正在我的项目中的几个地方使用，只是在 ctool 模式中显示的 web 表单正在发生变化。我用谷歌搜索并找到了这个[http://drupal.org/node/1196150](http://drupal.org/node/1196150)。我在这里找到的代码对我有帮助，现在我可以在 ctool modal 中显示 webform，并且表单工作得很好，但是确认消息没有在 ctool modal 中显示。提交后，它以模态显示相同的表单，而不是确认消息。此代码将自定义提交处理程序与 hook_form_alter 中的表单附加在一起，并在此提交处理程序中设置 sessoin 变量。在此会话变量上，它决定是否显示表单或确认消息。

这是代码

```
function webform_modal_menu() { 
  $items['service-page'] = array(
    'title' => 'Service page',
    'access callback' => TRUE,
    'page callback' => 'webform_modal_page',
    );
  $items['modal/%ctools_js/service-webform'] = array(
    'title' => t("service webform"),
    'page callback' => 'webform_modal_content',
    'file' => 'webform_modal.inc',
    'page arguments' => array(1),
    'access callback' => TRUE,
    'type' => MENU_CALLBACK,
  );

  return $items;
}

function webform_modal_page() {
  ctools_include('ajax'); // Module  include the dependence it needs for ajax.
  ctools_include('modal');
  ctools_modal_add_js();

  $output = ctools_modal_text_button(t('Click Here'), 'modal/nojs/service-webform', t('Pop me up'));
  $output .= '<div id="modal-message">&nbsp</div>';
  ctools_include('plugins');
  return $output;
}

function webform_modal_content($js = NULL) {
  define('WEBFORM_NID', 14);
  $webform_nid = WEBFORM_NID; // Your webform $nid
  return ctools_ajax_modal_webform($js, $webform_nid);
}

function webform_modal_form_alter(&$form, &$form_state, $form_id) {
  if ($form_id == 'webform_client_form_14') {
    $form['#submit'][2] = '_custom_webform_submit';
  }

  function _custom_webform_submit($form, &$form_state) {
    $webform_nid = $form['#node']->nid;
    lists_session('webform_client_form_'.$webform_nid, $value =  'submitted');
  }

  function ctools_ajax_modal_webform($js = NULL, $webform_nid = NULL) {
  $node = node_load($webform_nid); // Load webform node
  $submission =  (object) array(); // empty object required by webform

  // React without the modal
  if (!$js) {
    // Webform requires more parameters than standard forms
    return drupal_get_form('webform_client_form_'.$webform_nid, $node, $submission);
  }

  // React with the modal
  // Add modal components
  ctools_include('modal');
  ctools_include('ajax');
  $form_state = array(
    'title' => $node->title,
    'ajax' => TRUE,
    );

  // Emulate ctools_modal_form_wrapper() form modal.inc because webform can not be triggered trough drupal_build_form
  // If it can, I'd be glad to understand how
  $form_state += array(
    're_render' => TRUE,
    'no_redirect' => !empty($form_state['ajax']),
    );
  //drupal_get_form('webform_client_form_'.$webform_nid, $node, $submission);
  $args = array($node, $submission);
  $form_state['build_info']['args'] = $args;
  $output = ctools_modal_form_wrapper('webform_client_form_'.$webform_nid, $form_state);

  if ( isset($_SESSION['lists']['webform_client_form_'.$webform_nid]) && $_SESSION['lists']['webform_client_form_'.$webform_nid] == 'submitted') {
    unset($_SESSION['lists']['webform_client_form_'.$webform_nid]);
    $confirm_message = array("#markup" => '<div> Your request has been submitted</div>');
    $confirmation['#markup'] = 
    '<div class="popups-confirmation-wrapper">'.
    drupal_render($confirm_message).
    '</div>';    
    $output = array(); // Recreate output
    // Oerwrite the form output if it was successful.
    $output[] = ctools_modal_command_display('Confirmation', $confirmation);

  }

  // Render output in modal window
  print ajax_render($output);
  exit;
}

function lists_session($key, $value = NULL) {
  static $storage;
  if ($value) {
    $storage[$key] = $value ;
    $_SESSION['lists'][$key] = $value ;   // I put 'lists' in case some other module uses 'type' in $_SESSION
  }
  else if (empty($storage[$key]) && isset($_SESSION['lists'][$key])) {
    $storage[$key] = $_SESSION['lists'][$key];
  }
  return $storage[$key];
} 
```

清除缓存后，我直接访问 modal/nojs/service-webform 菜单项，它显示表单并调用 hook_form_alter。我现在在直接访问 modal/nojs/service-webform 后确认了在 form_alter 中打印了一些消息在控制台上（因为我使用 chromephp 进行日志记录。）。但是，如果缓存被清除并且我单击“单击此处”，则表单以模式显示，但不会调用 form_alter，因为它不会在控制台中打印任何消息。单击该按钮后，如果我直接访问 modal/nojs/service-webform，则不会调用 form_alter。所以问题是没有调用自定义提交处理程序。我在表单更改中确认了这个打印 $form 变量。[http://drupal.org/node/1196150#comment-6458176](http://drupal.org/node/1196150#comment-6458176)是否有任何缓存问题或者我犯了一些错误？

# java - Java 小程序 JTextField 在 Ubuntu 上的 JDialog 之后无法访问

> ID：12373140
> 
> 赞同：2
> 
> 时间：2012-09-11T15:28:24.993
> 
> 标签：java, swing, ubuntu, jtextfield, jdialog

我在 Ubuntu 上使用 java 有 2 个问题：

1.  JTextField 无法访问，您无法在其中输入任何内容。要重现，您必须单击标签（“单击此标签”），它将打开我的扩展 JDialog。使用取消按钮将其关闭后，JTextField 将无法访问。问题是它不会一直发生。我认为大约 1 对 10 次尝试。发生这种情况时，您必须单击浏览器窗口上的其他位置或再次打开对话框。

2.  第二个问题是，当 ubuntu 打开 JDialog 时，它会创建其他进程，显示在左侧应用栏上。然后，您可以单击对话框下方小程序上的某个位置，即使认为它是模态的并且应该在顶部，该对话框也会进入浏览器下方。

有没有人在 ubuntu 上遇到过类似的错误，并且知道如何解决它。在 Windows 上一切正常。我们使用 ubuntu-12.04-desktop 和 java 1.6.0_34-b04。它在 Firefox 11.0 和 Google chrome 中进行了测试（我认为是最新的）

这是我的代码 TestApplet.java 类：

```
 import java.awt.FlowLayout;
    import java.awt.Frame;
    import java.awt.event.MouseAdapter;
    import java.awt.event.MouseEvent;

    import javax.swing.JApplet;
    import javax.swing.JComponent;
    import javax.swing.JLabel;
    import javax.swing.JTextField;
    import javax.swing.SwingUtilities;

    import client.utilities.GUIUtilities;

    @SuppressWarnings("serial")
    public class TestApplet extends JApplet {
        public void init() {
            try {
                SwingUtilities.invokeAndWait(new Runnable() {
                    public void run() {
                        JApplet applet = TestApplet.this;

                        applet.setLayout(new FlowLayout());

                        JTextField ts = new JTextField("Test text");
                        ts.setColumns(10);
                        applet.add(ts);

                        applet.add(getCallCalendarButton(ts));
                    }
                });
            } catch (Exception e) {
                System.err.println(e.getCause());
            }
        }

        private JLabel callCalendarButton;

        private MyDialog aDialog;

        protected JLabel getCallCalendarButton(final JComponent cmp) {
            if (callCalendarButton == null) {
                callCalendarButton = new JLabel("Click this label!!");

                callCalendarButton.addMouseListener(new MouseAdapter() {

                    public void mouseClicked(MouseEvent e) {
                        if (callCalendarButton.isEnabled()) {
                            Frame parentFrame = null;
                            if (parentFrame == null)
                                parentFrame = GUIUtilities.getParentFrame(cmp);

                            System.out.println(parentFrame);

                            aDialog = new MyDialog(parentFrame, cmp);
                            aDialog.setVisible(true);

                            System.out.println("qwewqe");
                            cmp.requestFocusInWindow();
                        }
                    }
                });
            }
            return callCalendarButton;
        }

    } 
```

这里是扩展的 JDialog 类（MyDialog.java）：

```
 import java.awt.BorderLayout;
    import java.awt.FlowLayout;
    import java.awt.Frame;
    import java.awt.event.ComponentAdapter;
    import java.awt.event.ComponentEvent;

    import javax.swing.JButton;
    import javax.swing.JComponent;
    import javax.swing.JDialog;
    import javax.swing.JPanel;
    import javax.swing.SwingUtilities;

    @SuppressWarnings("serial")
    public class MyDialog extends JDialog {

        private JButton okButton;

        private JButton cancelButton;

        private JComponent owner;

        private int WIDTH = 230;
        private int HEIGHT = 230;

        Frame parent;

        public MyDialog(Frame parent, JComponent owner) {
            super(parent);

            this.parent = parent;
            this.owner = owner;

            okButton = new JButton("OK");
            okButton.setMnemonic('O');
            okButton.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent e) {
                    MyDialog.this.setVisible(false);
                    MyDialog.this.dispose();
                }
            });

            cancelButton = new JButton("Cancel");
            cancelButton.setMnemonic('C');
            cancelButton.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent e) {
                    MyDialog.this.setVisible(false);
                }
            });

            this.setLayout(new BorderLayout());
            JPanel bottomPanel = new JPanel();
            bottomPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));
            bottomPanel.add(okButton);
            bottomPanel.add(cancelButton);
            this.add(bottomPanel, BorderLayout.SOUTH);
            this.setModal(true);
            this.setBounds(100, 100, WIDTH, HEIGHT);
            //

            this.addComponentListener(new ComponentAdapter(){
                  @Override
                  public void componentHidden(ComponentEvent e){
                    SwingUtilities.invokeLater(new Runnable(){
                      @Override
                      public void run(){
                            MyDialog.this.owner.requestFocusInWindow();
                            //MyDialog.this.parent.toFront();
                            //MyDialog.this.parent.requestFocusInWindow();

                      }
                    });
                  }
                });
        }

    } 
```

要使用此 html 运行小程序：

```
 <html>
    <body>
    <Applet Code="TestApplet.class" width="200" height="100" >
    </Applet>
    </body>
    </html> 
```

# php - 添加缓存到 Zend\Form\Annotation\AnnotationBuilder

> ID：12373142
> 
> 赞同：4
> 
> 时间：2012-09-11T15:28:42.523
> 
> 标签：php, caching, annotations, zend-form, zend-framework2

由于我终于`memcache`在 Windows 上找到了 PHP 5.4.4 的二进制文件，因此我正在加快我目前正在开发的应用程序的速度。

我已经成功地将 memcache 设置为 Doctrine ORM Mapping Cache 驱动程序，但我需要修复另一个泄漏：使用注释构建的表单。

我正在根据[文档](http://zf2.readthedocs.org/en/latest/modules/zend.form.quick-start.html)的注释部分创建表单。不幸的是，这需要很多时间，尤其是在为单个页面创建多个表单时。

是否可以在此过程中添加缓存？我浏览了代码，但似乎`Zend\Form\Annotation\AnnotationBuilder`总是通过反映代码和解析注释来创建表单。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:34:46.393

你可能想尝试这样的事情：

```
class ZendFormCachedController extends Zend_Controller_Action
{
    protected $_formId = 'form';

    public function indexAction()
    {
            $frontend = array(
                    'lifetime' => 7200,
                    'automatic_serialization' => true);

            $backend = array('cache_dir' => '/tmp/');
            $cache = Zend_Cache::factory('Core', 'File', $frontend, $backend);

            if ($this->getRequest()->isPost()) {
                    $form = $this->getForm(new Zend_Form);
            } else if (! $form = $cache->load($this->_formId)) {
                    $form = $this->getForm(new Zend_Form);
                    $cache->save($form->__toString(), $this->_formId);
            }

            $this->getHelper('layout')->setLayout('zend-form');
            $this->view->form = $form;
    } 
```

[在这里](http://blog.fedecarg.com/2008/07/06/zend_form-performance-issues/)找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-12T16:03:10.940

Louis 的回答对我不起作用，所以我所做的只是扩展 AnnotationBuilder 的构造函数以获取缓存对象，然后修改`getFormSpecification`为使用该缓存来缓存结果。我的功能如下..

非常快速的工作......确保它可以改进。就我而言，我仅限于一些旧硬件，这使页面上的加载时间从 10 多秒减少到 1 秒左右

```
/**
 * Creates and returns a form specification for use with a factory
 *
 * Parses the object provided, and processes annotations for the class and
 * all properties. Information from annotations is then used to create
 * specifications for a form, its elements, and its input filter.
 *
 * MODIFIED: Now uses local cache to store parsed annotations
 *
 * @param  string|object $entity Either an instance or a valid class name for an entity
 * @throws Exception\InvalidArgumentException if $entity is not an object or class name
 * @return ArrayObject
 */
public function getFormSpecification($entity)
{
    if (!is_object($entity)) {
        if ((is_string($entity) && (!class_exists($entity))) // non-existent class
            || (!is_string($entity)) // not an object or string
        ) {
            throw new Exception\InvalidArgumentException(sprintf(
                '%s expects an object or valid class name; received "%s"',
                __METHOD__,
                var_export($entity, 1)
            ));
        }
    }

    $formSpec = NULL;
    if ($this->cache) { 
        //generate cache key from entity name
        $cacheKey =  (is_string($entity) ? $entity : get_class($entity)) . '_form_cache';

        //get the cached form annotations, try cache first
        $formSpec = $this->cache->getItem($cacheKey);
    }
    if (empty($formSpec)) {
        $this->entity      = $entity;
        $annotationManager = $this->getAnnotationManager();
        $formSpec          = new ArrayObject();
        $filterSpec        = new ArrayObject();

        $reflection  = new ClassReflection($entity);
        $annotations = $reflection->getAnnotations($annotationManager);

        if ($annotations instanceof AnnotationCollection) {
            $this->configureForm($annotations, $reflection, $formSpec, $filterSpec);
        }

        foreach ($reflection->getProperties() as $property) {
            $annotations = $property->getAnnotations($annotationManager);

            if ($annotations instanceof AnnotationCollection) {
                $this->configureElement($annotations, $property, $formSpec, $filterSpec);
            }
        }

        if (!isset($formSpec['input_filter'])) {
            $formSpec['input_filter'] = $filterSpec;
        }

        //save annotations to cache
        if ($this->cache) { 
            $this->cache->addItem($cacheKey, $formSpec);
        }
    }

    return $formSpec;
} 
```

# android - 用于播放钢琴声音的 Android AudioTrack 类

> ID：12373143
> 
> 赞同：0
> 
> 时间：2012-09-11T15:28:44.503
> 
> 标签：android, audio, stream, audiotrack

我试图实现一个钢琴应用程序，用户可以在显示器上显示的虚拟钢琴上演奏。由于低延迟，我尝试使用 AudioTrack 类，这会带来很多麻烦。我的问题是快速播放声音。目前我使用按钮来测试它。如果我快速按下按钮，我会得到这个例外：

```
09-11 15:06:19.089: E/AudioTrack(3729): AudioFlinger could not create track, status: -12
09-11 15:06:19.097: E/AudioTrack-JNI(3729): Error initializing AudioTrack
09-11 15:06:19.097: E/AudioTrack-Java(3729): [ android.media.AudioTrack ] Error code -20 when initializing AudioTrack.
09-11 15:06:19.097: D/AndroidRuntime(3729): Shutting down VM
09-11 15:06:19.097: W/dalvikvm(3729): threadid=1: thread exiting with uncaught exception (group=0x4001d888)
09-11 15:06:19.097: E/AndroidRuntime(3729): FATAL EXCEPTION: main
09-11 15:06:19.097: E/AndroidRuntime(3729): java.lang.IllegalStateException: play() called on uninitialized AudioTrack.
09-11 15:06:19.097: E/AndroidRuntime(3729):     at android.media.AudioTrack.play(AudioTrack.java:764)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at com.example.audiotrackvssoundpoollayer.MainActivity.onClick(MainActivity.java:216)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at android.view.View.performClick(View.java:2461)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at android.view.View$PerformClick.run(View.java:8890)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at android.os.Handler.handleCallback(Handler.java:587)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at android.os.Handler.dispatchMessage(Handler.java:92)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at android.os.Looper.loop(Looper.java:123)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at android.app.ActivityThread.main(ActivityThread.java:4632)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at java.lang.reflect.Method.invokeNative(Native Method)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at java.lang.reflect.Method.invoke(Method.java:521)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
09-11 15:06:19.097: E/AndroidRuntime(3729):     at dalvik.system.NativeStart.main(Native Method) 
```

我在静态模式下使用 AudioTrack。每次我喜欢播放声音时，我都必须使用 new AudioTrack(....) 创建一个新的 AudioTrack 对象，然后 write(...) 和 play(....)

我认为它不能足够快地实例化，因此例外......

这是代码：声音存储在不同异步任务类的哈希图中

```
 public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);

            Button buttonA1 = (Button) findViewById(R.id.buttonA1);
            buttonA1.setOnClickListener(this);
            Button buttonA2 = (Button) findViewById(R.id.buttonA2);
            buttonA2.setOnClickListener(this);
            Button buttonA3 = (Button) findViewById(R.id.buttonA3);
            buttonA3.setOnClickListener(this);
            Button buttonA4 = (Button) findViewById(R.id.buttonA4);
            buttonA4.setOnClickListener(this);
            Button buttonA5 = (Button) findViewById(R.id.buttonA5);
            buttonA5.setOnClickListener(this);
            Button buttonA6 = (Button) findViewById(R.id.buttonA6);
            buttonA6.setOnClickListener(this);
            Button buttonA7 = (Button) findViewById(R.id.buttonA7);
            buttonA7.setOnClickListener(this);
            Button buttonA8 = (Button) findViewById(R.id.buttonA8);
            buttonA8.setOnClickListener(this);

            //***AudioTrack***
            AudioManager audioManager = (AudioManager) getSystemService(AUDIO_SERVICE);
            float actualVolume = (float) audioManager.getStreamVolume(AudioManager.STREAM_MUSIC);
            float maxVolume = (float) audioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
            volume = actualVolume / maxVolume;
            minBufferSize = AudioTrack.getMinBufferSize(44100, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                            AudioFormat.ENCODING_PCM_16BIT);

            assetManager = getResources().getAssets();

        }

public void onClick(View button) {

        switch(button.getId()) {

        case R.id.buttonA1: 
            audioTrack1 = new AudioTrack(AudioManager.STREAM_MUSIC, 44100, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                     AudioFormat.ENCODING_PCM_16BIT, minBufferSize * 65, AudioTrack.MODE_STATIC);
            audioTrack1.write(soundMap.get(3), 0, minBufferSize * 65);
            audioTrack1.play();
            break;
       case R.id.buttonA2:
            audioTrack2 = new AudioTrack(AudioManager.STREAM_MUSIC, 44100, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                     AudioFormat.ENCODING_PCM_16BIT, minBufferSize * 65, AudioTrack.MODE_STATIC);
            audioTrack2.write(soundMap.get(3), 0, minBufferSize * 65);
            audioTrack2.play();
            break;
        case R.id.buttonA3:
            audioTrack3 = new AudioTrack(AudioManager.STREAM_MUSIC, 44100, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                     AudioFormat.ENCODING_PCM_16BIT, minBufferSize * 65, AudioTrack.MODE_STATIC);
            audioTrack3.write(soundMap.get(3), 0, minBufferSize * 65);
            audioTrack3.play();
            break;      
        case R.id.buttonA4:
            audioTrack4 = new AudioTrack(AudioManager.STREAM_MUSIC, 44100, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                     AudioFormat.ENCODING_PCM_16BIT, minBufferSize * 65, AudioTrack.MODE_STATIC);
            audioTrack4.write(soundMap.get(3), 0, minBufferSize * 65);
            audioTrack4.play();
            break;
        case R.id.buttonA5:
            audioTrack5 = new AudioTrack(AudioManager.STREAM_MUSIC, 44100, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                     AudioFormat.ENCODING_PCM_16BIT, minBufferSize * 65, AudioTrack.MODE_STATIC);
            audioTrack5.write(soundMap.get(4), 0, minBufferSize * 65);
            audioTrack5.play();
            break;
        case R.id.buttonA6:
            audioTrack6 = new AudioTrack(AudioManager.STREAM_MUSIC, 44100, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                     AudioFormat.ENCODING_PCM_16BIT, minBufferSize * 65, AudioTrack.MODE_STATIC);
            audioTrack6.write(soundMap.get(5), 0, minBufferSize * 65);
            audioTrack6.play();
            break;
        case R.id.buttonA7:
            audioTrack7 = new AudioTrack(AudioManager.STREAM_MUSIC, 44100, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                     AudioFormat.ENCODING_PCM_16BIT, minBufferSize * 65, AudioTrack.MODE_STATIC);
            audioTrack7.write(soundMap.get(6), 0, minBufferSize * 65);
            audioTrack7.play();
            break;
        case R.id.buttonA8:
            audioTrack8 = new AudioTrack(AudioManager.STREAM_MUSIC, 44100, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                     AudioFormat.ENCODING_PCM_16BIT, minBufferSize * 65, AudioTrack.MODE_STATIC);
            audioTrack8.write(soundMap.get(7), 0, minBufferSize * 65);
            audioTrack8.play();
            break;
    }
} 
```

如果有人可以帮助解决这个问题，那就太好了，也许使用流模式而不是静态模式，其中声音被预处理或空字节缓冲区被写入音轨，然后单击按钮，哈希图声音被流式传输到音轨。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-06T20:02:48.070

我认为你应该看看 SoundPool 并使用它。它似乎是专门为做你想做的事情而设计的。它不适用于动态生成的声音，但由于您正在弹奏钢​​琴，因此我假设您将样本作为 WAV 文件保存在 SDCard 上。

使用播放速度，您可以更改音高：以双倍速度播放 = 1 个八度音程，半速 = 1 个八度音程。您可能希望稍后使用更精细的方法:)

# plugins - PhoneGap 插件的生命周期是多久？

> ID：12373147
> 
> 赞同：3
> 
> 时间：2012-09-11T15:28:56.647
> 
> 标签：plugins, cordova, lifetime

关于插件实例的生命周期，我是否需要考虑一些事情，或者我可以假设这个对象在我的 web 视图可见的时候一直存在？

从一些插件看来，有些人倾向于使用某种单例管理器将数据存储在他们的 PhoneGap 插件中。为什么不把它存储在 PhoneGap 插件本身呢？

询问的原因是，似乎与 web 视图通信的唯一正确方法是通过 [self writeJavaScript:message] 方法。如果我注册自己以接收一些通知，我想确保我的插件实例存在。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T15:10:09.443

只要 Web 视图存在，插件就会存在。

初始化变量或注册回调的正确方法是

```
- (CDVPlugin*) initWithWebView:(UIWebView*)theWebView {
   self = [super initWithWebView:theWebView];
   if (self) {
       _variable = [[Variable alloc] init]; 
       [Classname addListener:self];
   }
   return self;
} 
```

方法。该方法适用于所有插件。

不要忘记在 dealloc 方法中自己清理。

# java - 每次需要一个值时都会调用一个静态枚举初始化程序吗？

> ID：12373148
> 
> 赞同：1
> 
> 时间：2012-09-11T15:28:59.377
> 
> 标签：java, hashmap

我正在考虑使用带有静态初始化程序的枚举，如下所示：

```
public enum MyEnum{
    ...
    private static HashMap<X, Y> features;

    static {
        features.put(X, new (Y));
    }
    ...
} 
```

每次我需要一个值时，HashMap 是否会重新初始化？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T15:30:14.307

不，像所有静态块一样，它仅在类型初始化时执行。

所以这只会做一次。

但是你应该影响你的地图的价值：你不会在我们看到的代码中这样做。你应该有

```
private static Map<X, Y> features;

static {
    features = new HashMap<X, Y>();
    features.put(X, new Y());
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T15:30:16.803

不，静态块只会在类初始化时执行一次。它不会在每次调用检索时执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T15:30:39.837

不，静态初始化程序仅在加载类时运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T16:20:21.333

不，只有一次。

顺便说一句：[番石榴 ImmutableMap](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableMap.html)可以帮助：

```
private static Map<X, Y> features = ImmutableMap.of(X1, Y1, X2, Y2...)); 
```

益处：

*   不需要静态块
*   一行代码
*   ImmutableMap 意味着更安全，如果你只需要一个不可变的 Map

# ruby-on-rails - Rails 将嵌套属性 id 添加到表单中，从而导致批量分配

> ID：12373149
> 
> 赞同：1
> 
> 时间：2012-09-11T15:29:00.900
> 
> 标签：ruby-on-rails, forms, nested-attributes

奇怪的！当我使用`fields_for`声明嵌套属性字段时，rails 添加了一个隐藏属性，其中包含嵌套属性的 id（以执行更新）：

```
= form_for @opinion do |f|
    = f.fields_for :client do |client_f|
        = client_f.text_field :name 
```

给我：

```
<input name="opinion[client_attributes][name]" type="text" />
<input name="opinion[client_attributes][id]" type="hidden" value="4" /> 
```

这将导致：

```
Can't mass-assign protected attributes: client_attributes 
```

当然，这是我的模型：

```
class Opinion < ActiveRecord::Base

    attr_accessible :content
    attr_accessible :client_id

    validates :content, :presence => true, :length => { :maximum => 2048 }

    belongs_to :client
    accepts_nested_attributes_for :client

end

class Client < ActiveRecord::Base

    attr_accessible :name

    validates :name, :presence => true, :length => { :maximum => 64 }

    has_many :opinions

end 
```

Rails 视图有问题，还是模型有问题？

知道如何解决吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:53:03.327

添加`:client_attributes`到 `:attr_accessible`

`:attr_accessible`用于识别哪些字段被打开以进行批量分配。

在您发送给控制器的请求中，应该有一个调用参数键`client_attributes`来对客户端的详细信息进行分组。您必须启用此功能以进行批量分配，以便您可以以批量分配的方式更新客户端的详细信息。

# python - Google 应用引擎：表单值自动添加到模型中

> ID：12373152
> 
> 赞同：0
> 
> 时间：2012-09-11T15:29:13.597
> 
> 标签：python, forms, google-app-engine

我正在尝试在 python 中使用谷歌应用引擎构建一个应用程序。我正在阅读本官方指南：[https](https://developers.google.com/appengine/docs/python/gettingstarted/handlingforms) ://developers.google.com/appengine/docs/python/gettingstarted/handlingforms 示例中，看来我必须手动检索所有数据

```
self.request.get('content') 
```

然而这个解决方案似乎不方便，有没有办法将表单映射到模型（db）并将表单值直接放入这个模型？

例子：

```
class PostOnBlog(db.Model):
    title = db.StringProperty(required=True)
    text = db.StringProperty(required=True) 
```

现在，我可以从这里自动创建表单吗？如果不行，我可以自己构建表格。但是，一旦我要表单，我可以在提交帖子时将数据自动映射到这个模型吗？有什么办法吗？还是我必须写下所有的 self.request.get('par_name')？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:39:10.597

看看wtforms。

[http://wtforms.simplecodes.com/docs/1.0.2/ext.html#module-wtforms.ext.appengine](http://wtforms.simplecodes.com/docs/1.0.2/ext.html#module-wtforms.ext.appengine)

WTForms 现在包括对 AppEngine 字段以及自动生成表单的支持。您现在可以直接将表单映射到模型，也可以在提交回您的应用程序后将其读回填充模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:40:14.293

您可以在 App Engine 上使用 Django，并能够使用 Django 的可爱[ModelForms](https://developers.google.com/appengine/articles/djangoforms)（请参阅页面示例部分的**定义模型和表单类）**

# iis - 如何在一台 IIS7.5 服务器上比较两个网站的设置

> ID：12373153
> 
> 赞同：2
> 
> 时间：2012-09-11T15:29:14.690
> 
> 标签：iis, iis-7.5, http-status-code-404

我有两个网站在 IIS7.5 的一台服务器上运行，并且想找到一种方法来比较每个网站的设置。（我看到这个[问题已经被问到 IIS6 了](https://stackoverflow.com/questions/1029045/what-is-the-quickest-way-to-compare-two-servers-iis-settings)。）

我想这样做是为了了解为什么一个网站处理 HTTP 404 错误的方式与另一个网站不同。我确信我已将 IIS 中的所有选项设置为在每个站点上都相同。我检查了 web.config 文件在`<httpErrors>`和`<customErrors>`节点中具有相同的值。我在 applicationHost.config 中也看不到任何内容。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T08:25:47.803

嗬！回到 IIS 并再次比较这两个网站后，我意识到我在问题所在的网站上将 ASP 错误设置为“自定义”（而不是“详细”）。ASP.NET 错误设置匹配，但与 ASP 错误设置不匹配。处理 404 的页面是从另一个站点复制的经典 ASP 页面以节省时间。

我仍然很想知道 web.config 和 applicationHost.config 是否是唯一存储网站特定设置的地方？

# tumblr - Tumblr 自定义 HTML

> ID：12373154
> 
> 赞同：0
> 
> 时间：2012-09-11T15:29:19.557
> 
> 标签：tumblr

在 Tumblr 上，我想要一个 2 列格式。也就是说，主页的主栏加上右栏。但在文章页面上，我只想要主栏。

我如何编辑标准的 Tumblr 主题来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:48:09.277

使用 jQuery 显示/隐藏额外的列并根据`window.location`返回的内容调整主列的大小。

**编辑：**

如果您不想使用 jQuery，请查看`{block:IndexPage}`tumblr[主题文档](http://www.tumblr.com/docs/en/custom_themes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-27T03:11:04.517

将要隐藏的列包裹在 {block:index}{/block:index} 中，它只会显示在主页中，如果仍然不起作用，请将列包裹在 div 中并使用 css 将其隐藏，例如：

```
{block:permalinkpage}
.your-wrap {display:none;}
{/block:permalinkpage} 
```

# layout - 如何在 Like Box 中指定 href 的语言环境？

> ID：12373157
> 
> 赞同：2
> 
> 时间：2012-09-11T15:29:29.003
> 
> 标签：layout, localization, facebook-like, facebook-likebox

请参阅下面的代码，我的问题是，如果我直接转到链接（以 SO 为例），我将获得我想要的法语版 Facebook 布局，但如果我通过 Like Box 链接，Facebook 会删除语言环境和目的地以我浏览器的默认英语语言显示。如何在不复制我的 Facebook 页面的情况下用法语完成目的地？ [https://www.facebook.com/pages/Stack-Overflow/105665906133609?ref=ts&locale=fr_CA](https://www.facebook.com/pages/Stack-Overflow/105665906133609?ref=ts&locale=fr_CA)

```
<html><body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/fr_CA/all.js#xfbml=1&appId=123456789";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-like-box" data-lang='fr_CA' data-href="https://www.facebook.com/pages/Stack-Overflow/105665906133609?ref=ts&locale=fr_CA" data-width="292" data-show-faces="true" data-stream="true" data-header="true"></div>

</body></html> 
```

# javascript - 数据表 FixedColumns IE8/7 Firefox 错误

> ID：12373159
> 
> 赞同：-1
> 
> 时间：2012-09-11T15:29:36.933
> 
> 标签：javascript, jquery, datatables

我在使用 IE8、IE7 和 Firefox 中的 FixedColumn 插件时遇到了一些问题。

他们都“毁了我的桌子”。这是他们返回的错误。

```
Message: Invalid argument.
Line: 566
Char: 3
Code: 0
URI: ./resources/javascript/dataTable/FixedColumns.js 
```

桌子正在远离它的位置。这是 2 张图片，显示了桌子的情况。 ![桌子放错了地方](../Images/3c20d9e231bee0cd67dc9713ae7ee0a4.png)

![桌子放错了地方](../Images/c402b5ae2f8d64b02279b64ac01c6cb9.png)

你们能帮帮我吗？我一直在 Datatable 论坛和 Google 中搜索，但没有找到任何对我有帮助的东西。

环境：

1.  jQuery 1.8.1
2.  数据表 1.9.3
3.  固定列 2.0.3

问候，
埃尔卡斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T16:19:08.810

我所做的，就我而言，我已经加载了我正在检查的那个月的所有日子，把今天之前的日子放在白色

我认为该插件不适用于具有一个静态列而其他非静态列的 IE。

浏览器（在这种情况下为 IE8）将文档处理为 IE7，因此我必须添加一个元标记以强制它以 IE8 文档的形式呈现。

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" > 
```

这是该问题描述的[链接。](http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx#SetMode)

# c# - 如何在 web.config 中为 CustomBinding 配置 TransportSecurityBindingElement？

> ID：12373160
> 
> 赞同：1
> 
> 时间：2012-09-11T15:29:39.703
> 
> 标签：c#, .net, wcf

我想通过 web.config 配置以下（简化的）代码

```
var security = new TransportSecurityBindingElement();
security.EndpointSupportingTokenParameters.SignedEncrypted.Add(new UserNameSecurityTokenParameters());

var binding = new CustomBinding(security); 
```

是否可以使用 Web 配置配置此自定义绑定？如果可能的话，我该如何配置支持令牌参数的端点？我尝试了以下配置，但是它没有针对 DotNetConfig.xsd 进行验证：

```
<system.serviceModel>
  <bindings>
    <customBinding>
      <binding name="SomeBinding" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00">
        <transportSecurity> <!-- Fails validation -->
            <!-- How do I configure the EndpointSupportingTokenParameters -->             
        </transportSecurity>
      </binding>
    </customBinding>
  </bindings>
  <client>
    ...
  </client>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T02:21:13.033

我认为您只是使用`customBinding/security`，也许与`authenticationMode`of一起使用`UserNameOverTransport`：

```
<system.serviceModel>
    <bindings>
      <customBinding>
        <binding>
          <security authenticationMode="UserNameOverTransport" />
        </binding>
      </customBinding>
    </bindings>
</system.serviceModel> 
```

如果做不到这一点，您可以尝试手动将令牌添加到[`issuedTokenParameters`](http://msdn.microsoft.com/en-us/library/aa734714.aspx)：

```
<system.serviceModel>
    <bindings>
      <customBinding>
        <binding>
          <security authenticationMode="UserNameOverTransport">
              <issuedTokenParameters tokenType="http://schemas.microsoft.com/ws/2006/05/identitymodel/tokens/UserName" />
          </security>
        </binding>
      </customBinding>
    </bindings>
</system.serviceModel> 
```

（tokenType 被盗`UserNameSecurityTokenParameters`）

老实说，这可能太麻烦了，用代码来做会更容易。如果您需要在每个环境中有所不同，请在配置中定义工厂并使用 DI 来使用它来创建绑定。

# css - 如何使用css精灵？

> ID：12373162
> 
> 赞同：3
> 
> 时间：2012-09-11T15:29:41.687
> 
> 标签：css, sprite

我在某处读到 css sprites 比使用简单图像更好。那个怎么样 ？我也是 Html 的新手，所以谁能告诉我 css 是如何工作的，并给我一个 css sprites 的简单示例？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T15:33:59.327

这是完整的代码。复制并粘贴到记事本中并将其另存为`abc.html`. 将以下两张图片保存在同一文件夹中： `image.gif`一张大一张，一张`trans.gif`小一张。

```
<html>
<head>
    <title>Image Sprites</title>
    <style type="text/css">
        img.sprite
        {
            width:46px;
            height:44px;
            background:url(image.gif) 0px 0px;
        }        

        .sprite:hover
        {
            background: url(image.gif) 0px 44px;
        }
     </style>
</head>

<body>
    <img class="sprite" src="trans.gif" />
</body>
</html> 
```

*   [imgur 上的 image.gif](https://i.stack.imgur.com/W8sKJ.gif)
*   [imgur 上的 trans.gif（1x1 像素）](https://i.stack.imgur.com/GNjoI.gif)

简单来说，CSS sprite 只使用一张图片而不是多张图片。因此，不是来自服务器的许多图像请求，而是只发送一个请求。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T15:34:32.310

一次访问服务器以获取图像与多个图像。我找到 [了 SpritePad（在线应用程序）](http://spritepad.wearekiss.com/)来构建它们，它还会生成相关的样板 css（如果你刚开始可能会有点混乱）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T15:32:19.533

在基本术语中 - 它允许您加载一张图像并在页面周围的各种元素上使用所述图像。导致更少的加载请求和可能的加载时间。

这是一个例子： [http ://www.thedotproduct.org/experiments/css-sprites/](http://www.thedotproduct.org/experiments/css-sprites/)

这是使用的精灵图像： [http ://www.thedotproduct.org/experiments/css-sprites/css-sprites-menu.jpg](http://www.thedotproduct.org/experiments/css-sprites/css-sprites-menu.jpg)

# mysql - 如何使用applescript转储mysql数据库

> ID：12373166
> 
> 赞同：0
> 
> 时间：2012-09-11T15:29:50.647
> 
> 标签：mysql, applescript, mysqldump

我将mysql与zend一起使用。我想做一个苹果脚本来备份特定文件夹上的一个数据库。

我知道如何用 php 做，但不知道用 applescript。

请参阅下面我的 PHP 脚本。

```
 <?php
require_once ('../MySQL.php');
require_once ('../conf.php');
include('../functions.php');

echo '----------------- Dump mySQL-----------------<br>';

$NameFile=DB_DATABASE . date("Y-m-d-H-i-s") . '.sql';
$backupFile =$_SERVER['DOCUMENT_ROOT'].'/MySoft/backup/'.$NameFile;

$commandMac = '/usr/local/zend/mysql/bin/mysqldump -h '.DB_HOST.' -u '.DB_USER.' -p'.DB_PWD.' -B '.DB_DATABASE.'>'. $backupFile;

system($commandMac);

?> 
```

那么你能帮我用applescript做同样的事情吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T20:56:20.780

简单的方法是从 applescript 运行 php 脚本。像这样的东西会起作用......

```
set phpScriptPath to "/path/to/phpscript"
do shell script "php -q " & quoted form of POSIX path of phpScriptPath 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-06T21:02:57.133

我认为这是最简单的方法

```
 set shellScript to "/usr/local/mysql/bin/mysqldump DatabaseToDump > FileWhereToDump.sql"
do shell script shellScript 
```

这种方法仅使用 shell 脚本并且应该与本地 MySQL 一起使用。DatabaseToDump 是您要转储的数据库， FileWhereToDump.sql 是目标。

# javascript - 如何修改此代码以便不必对对象进行排序？

> ID：12373169
> 
> 赞同：1
> 
> 时间：2012-09-11T15:30:01.497
> 
> 标签：javascript

我正在使用以下代码/数据来显示我们每个学院中收入最高的学生的列表。

* * *

**数据**

![User_Info 是一个对象数组](../Images/ca8e0b8f0bdc31719bf53e1bc29da358.png) 附1：User_Info是*一个Objects数组*

![User_Info 是一个对象数组，例如这个](../Images/7169af69787c7212d4efed7ad436c130.png)*附件2：User_Info 是这样一个Objects* 的数组

 *![Database_Info 是这样的对象](../Images/035c954edf1c33ead1c4dec615e78cdf.png) 附件 3：Database_Info 是这样*的 Object*

* * *

**编码**

```
 HPAnalysisObject.dispHPTotals = function(User_Info, Database_Info) {
        // See attachments 1 and 2
        console.log(User_Info);
        // See attachment 3
        console.log(Database_Info);

        // "label" is just a text title, like "Eagles"
        var html = '<h2>' + HPAnalysisObject.label + '</h2>' + 
            // "TotalPoints" is an integer figure
            '<div id="total">' + Database_Info.TotalPoints + '</div>';

        // create the table to display
        html += '<table><tr><th class="name">Name</th><th class="points">Points</th></tr>';

        // use "for, in" to access the value of the object key (which is the user's ID)
        for (var id in Database_Info.UserDetails) {
            html += '<tr>';
            for (var i = 0; i < User_Info.length; i++) {
                if (User_Info[i].id == id) {
                    // if the User_Info and Database_Info objects match up on the User's ID, add table cells to our html variable
                    html += '<td class="name">' + User_Info[i].firstname + ' ' + User_Info[i].surname + '</td><td class="points">' + Database_Info.UserDetails[id] + '</td>';
                }
            }
            html += '</tr>';
        }

        html += '</table>';

        $('div#display').html(html);
    }; 
```

* * *

**问题**

奇怪的是，在 Firefox 中，这些学生以正确的数字顺序显示，因为学生是从我的 PHP 脚本接收的。

但是，在 Google Chrome 和 Internet Explorer 中，它们以看似随机的顺序出现！

我的第一个想法是订购对象，但是在这里阅读了一些问题后，似乎订购对象并不是最佳实践。

*我可以重写这段代码，以便在每个浏览器上以正确的顺序显示相同的表格数据吗？*

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:46:47.997

在大多数语言中，您不能假设对象属性以任何特定顺序出现。

一种解决方案可能是为 UserDetails 中的每个条目添加一个访问器，例如：

UserDetails={ ID:{ 访问者:1, id: ID } }

然后对 UserDetails[ID].accessor 上的记录进行排序。

另一个可能是将 UserDetails 构造为将键值编码为“key:value”的元素数组，将每个检索到的元素拆分为 /:/ ，如下所示：

[“90030:87”...]

编辑

假设

```
var userDetails={
                  a:{i:3,key:'third'},
                  b:{i:1,key:'first'},
                  c:{i:2,key:'second'}
}; 
```

其中 i 是访问器，您可以使用创建排序的对象数组

```
var sortedObjs=Object.keys(userDetails)
                     .map(function(k){ return userDetails[k] })
                     .sort(function(left,right){ return left['i']-right['i'] }); 
```

它从 userDetails 中提取键，通过 map 创建一个键控元素数组，并按其访问器值对结果元素进行排序，使得

```
console.log(sortedObjs.map(function(elt){return elt.key}).join(',')) 
```

将打印到控制台：

```
first,second,third 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:35:09.420

对象是键到值的未排序映射，它们的顺序永远无法保证。

当我得到这样的东西时，我喜欢使用 ID 作为数字键来构建一个数组。例如，在 PHP 中是这样的：

```
$out = Array();
while($row = database_get_row($set)) { // replace with your choice of database library
    $out[$row['id']] = $row;
}
ksort($out);
$out = array_values($out); 
```

这样，您可以确保数组按 ID 递增的顺序排列，然后将该数组传递给 JavaScript 以供`for(i=0;i<l;i++)`循环使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T10:04:02.223

我决定将我的对象包装在一个可排序的数组中。这似乎起到了作用。

```
HPAnalysisObject.dispHPTotals = function(User_Info, Database_Info) {            
    // make a sortable array
    var Combined_Info = [];

    // "label" is just a text title, like "Eagles"
    var html = '<h2>' + HPAnalysisObject.label + '</h2>' + 
        // "TotalPoints" is an integer figure
        '<div id="total">' + Database_Info.TotalPoints + '</div>';

    // create the table to display
    html += '<table><tr><th class="name">Name</th><th class="points">Points</th></tr>';

    // use "for, in" to access the value of the object key (which is the user's ID)
    for (var id in Database_Info.UserDetails) {

        for (var i = 0; i < User_Info.length; i++) {
            if (User_Info[i].id == id) {
                var StudentInfo = { name: User_Info[i].firstname + ' ' + User_Info[i].surname, points: Database_Info.UserDetails[id] };
                Combined_Info.push(StudentInfo);
            }
        }

    }

    Combined_Info.sort( function(a, b) {
        return b.points - a.points;
    });

    for (var i = 0; i < Combined_Info.length; i++) {
        html += '<tr>';
        html += '<td class="name">' + Combined_Info[i].name + '</td><td class="points">' + Combined_Info[i].points + '</td>';
        html += '</tr>';
    }

    html += '</table>';

    $('div#display').html(html);
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T16:02:26.673

您必须使用数组包装器对 Database_Info.UserDetails 进行排序：

```
// test data using same data as example but with no order
var Database_Info = { 
  UserDetails : { 
    137473 : 87, 
    90132 : 126, 
    90057 : 79, 
    90030 : 87, 
    90095 : 82 
  }
}

var objWrapper = [];
for (key in Database_Info.UserDetails) {
  objWrapper.push(key);
}
objWrapper.sort(); // default sort = numeric order ascending

for (a = 0, b = objWrapper.length; a < b; a++) {
  var userInfo = Database_Info.UserDetails[objWrapper[a]];
  // do something interesting
  console.log(userInfo);
} 
```*

# css - 使用 CSS 和 div 或 span 创建扩展图像

> ID：12373170
> 
> 赞同：1
> 
> 时间：2012-09-11T15:30:03.550
> 
> 标签：css, html

我有一个复杂的图像被切成很多片。你可以看到[http://jsfiddle.net/yefQR/](http://jsfiddle.net/yefQR/)

```
<!--Force IE6 into quirks mode with this comment tag-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Page Title</title>
<style type="text/css">

body{
margin: 0;
padding: 0;
border: 0;
overflow: hidden;
height: 100%; 
max-height: 100%; 
}

#framecontentTop, #framecontentBottom{
position: absolute; 
top: 0; 
left: 0; 
width: 100%; 
height: 130px; /*Height of top frame div*/
overflow: hidden; /*Disable scrollbars. Set to "scroll" to enable*/
background-color: navy;
color: white;
}

#framecontentBottom{
top: auto;
bottom: 0; 
height: 110px; /*Height of bottom frame div*/
overflow: hidden; /*Disable scrollbars. Set to "scroll" to enable*/
background-color: navy;
color: white;
}

#maincontent{
position: fixed; 
top: 130px; /*Set top value to HeightOfTopFrameDiv*/
left: 0;
right: 0;
bottom: 110px; /*Set bottom value to HeightOfBottomFrameDiv*/
overflow: auto; 
background: #fff;
}

.innertube{
margin: 15px; /*Margins for inner DIV inside each DIV (to provide padding)*/
}

* html body{ /*IE6 hack*/
padding: 130px 0 110px 0; /*Set value to (HeightOfTopFrameDiv 0     HeightOfBottomFrameDiv     0)*/
}

* html #maincontent{ /*IE6 hack*/
height: 100%; 
width: 100%; 
}

</style>

</head>

<body>

<div id="framecontentTop">
<div class="innertube">

<div id="screenshot%20tsam%20900r2c2"  style=" background-color:     green;position:absolute;  left:4px;  top:6px;  width:20px;  height:68px;  z-index:1;  visibility:visible; ">
</div>
<div id="screenshot%20tsam%20900r2c3" style="background-color: yellow;     position:absolute; left:24px; top:6px;width:47px; height:68px;z-index:2; visibility:visible;"></div>
<div id="screenshot%20tsam%20900r2c4" style="background-color: red; position:absolute;     left:71px; top:6px;width:165px; height:68px;z-index:3; visibility:visible;"></div>
<div id="screenshot%20tsam%20900r2c5" style="background-color: black; position:absolute; left:236px; top:6px;width:62px; height:68px;z-index:4; visibility:visible;"></div>
<div id="screenshot%20tsam%20900r2c6" style="background-color: pink; position:absolute; left:298px; top:6px;width:147px; height:68px;z-index:5; visibility:visible;"></div>
<div id="screenshot%20tsam%20900r2c7" style="background-color: orange; position:absolute; left:445px; top:6px;width:311px; height:37px;z-index:6; visibility:visible;"></div>
<div id="screenshot%20tsam%20900r2c9" style="background-color: cyan; position:absolute; left:756px; top:6px;width:108px; height:37px;z-index:7; visibility:visible;"></div>
<div id="screenshot%20tsam%20900r2c11" style="background-color: white; position:absolute; left:864px; top:6px;width:27px; height:37px;z-index:8; visibility:visible;"></div>
<div id="screenshot%20tsam%20900r3c7" style="background-color: DodgerBlue; position:absolute; left:445px; top:43px;width:8px; height:31px;z-index:9; visibility:visible;"></div>
<div id="screenshot%20tsam%20900r3c8" style="background-color: Gold; position:absolute; left:453px; top:43px;width:355px; height:31px;z-index:10; visibility:visible;"></div>
<div id="screenshot%20tsam%20900r3c10" style="background-color: LightCyan ; position:absolute; left:808px; top:43px;width:83px; height:31px;z-index:11; visibility:visible;"></div>

</div>
</div>

<div id="framecontentBottom">
<div class="innertube">

<h3>Sample text here</h3>

</div>
</div>

<div id="maincontent">
<div class="innertube">

<h1>Lorem</h1>
<p>

Lorem ipsum 

</p>
<p style="text-align: center">Vestibulum  </p>

</div>
</div>

</body>
</html> 
```

我想做：

1) 使用 DodgerBlue color 和 Orange div 的重复-y css 属性自动扩展标题图像，因为你是图像可扩展的唯一 2 部分。2）是否可以定义标题的最小尺寸，并且可以根据该尺寸使整个正文最小尺寸，以便浏览器不能变小，如果窗口变小，则显示滚动条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:36:20.043

是的，只需`min-width`在您的 css 中使用。`max-width`如果需要，您也可以定义 a 。

# sed - 如何使用 SED 删除多个空行？

> ID：12373171
> 
> 赞同：2
> 
> 时间：2012-09-11T15:30:05.023
> 
> 标签：sed, text-processing

我正在尝试通过删除重复的空行来压缩文本文档，使用[`sed`](http://en.wikipedia.org/wiki/Sed). 这就是我正在做的（无济于事）：

```
sed -i -E 's/\n{3,}/\n/g' file.txt 
```

根据[本手册](http://www.grymoire.com/Unix/Sed.html#uh-47)，我知道这是不正确的，但我不知道如何正确地做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T19:50:19.943

我认为您想用单个空行替换多个空行的跨度，即使您的示例用`\n`单个`\n`而不是`\n\n`. 考虑到这一点，这里有两个解决方案：

```
sed '/^$/{ :l
    N; s/^\n$//; t l
    p; d; }' input 
```

在 sed 的许多实现中，这可以全部在一行上，嵌入的换行符被替换为`;`.

```
awk 't || !/^$/; { t = !/^$/ }' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-25T09:06:45.000

正如上面所建议的 Tripleee，我使用 Perl 而不是`sed`：

```
perl -0777pi -e 's/\n{3,}/\n\n/g' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-11T15:41:10.560

使用翻译功能

```
 tr -s '\n' 
```

-s 或 --squeeze-repeats 将重复字符序列减少为单个实例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T20:47:12.303

由`tr -s '\n'`or处理得更好`cat -s`，但如果您坚持使用`sed`，这里有一个来自 GNU sed 手册第 4.17 节的示例：

```
#!/usr/bin/sed -f

# on empty lines, join with next
# Note there is a star in the regexp
:x
/^\n*$/ {
  N
  bx
}
# now, squeeze all '\n', this can be also done by:
# s/^\(\n\)*/\1/
s/\n*/\
/ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-25T19:15:22.883

我不确定这是 OP 想要的，但如果您想删除文件中的所有空行，则使用 William Pursell 的 awk 解决方案是一种方法：

```
awk '!/^$/' file.txt 
```

解释：

awk 模式

```
'!/^$/' 
```

正在测试当前行是否仅由行首（用'^'表示）和行尾（用'$'表示）组成，换句话说，该行是否为空。

如果此模式为真，则 awk 应用其默认值并打印当前行。

高温高压

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-19T08:17:35.787

我认为 OP 想要*压缩*空行，例如，如果有 9 个连续的空行，他想要只有三个。我已经编写了一个小 bash 脚本来做到这一点：

```
#! /bin/bash
TOTALLINES="$(cat file.txt|wc -l)"
CURRENTLINE=1
while [ $CURRENTLINE -le $TOTALLINES ]
do
    L1=$CURRENTLINE
    L2=$(($L1 + 1))
    L3=$(($L1 +2))
    if [[ $(cat file.txt|head -$L1|tail +$L1) == "" ]]||[[ $(cat file.txt|head -$L1|tail +$L1) == " " ]]
    then
        L1EMPTY=true
    else 
        L1EMPTY=false
    fi
    if [[ $(cat file.txt|head -$L2|tail +$L2) == "" ]]||[[ $(cat file.txt|head -$L2|tail +$L2) == " " ]]
    then
        L2EMPTY=true
    else 
        L2EMPTY=false       
    fi
    if [[ $(cat file.txt|head -$L3|tail +$L3) == "" ]]||[[ $(cat file.txt|head -$L3|tail +$L3) == " " ]]
    then
        L3EMPTY=true
    else 
        L3EMPTY=false       
    fi  
    if [    $L1EMPTY = true ]&&[    $L2EMPTY = true ]&&[    $L3EMPTY = true ]
    then
        #do not cat line to temp file
        echo "Skipping line "$CURRENTLINE   
    else
        echo "$(cat file.txt|head -$CURRENTLINE|tail +$CURRENTLINE)">>temp.txt
        echo "Writing line " $CURRENTLINE
    fi
    ((CURRENTLINE++))
done    
cat temp.txt>file.txt
rm -r temp.txt
FINALTOTALLINES="$(cat file.txt|wc -l)"
EMPTYLINELINT=$(( $CURRENTLINE - $FINALTOTALLINES ))
echo "Deleted " $EMPTYLINELINT " empty lines." 
```

# c# - 在子窗口 wpf-c# 中定义内部变量以获取他

> ID：12373182
> 
> 赞同：0
> 
> 时间：2012-09-11T15:30:20.610
> 
> 标签：c#, wpf

我在主窗口变量中有

例子：

```
public partial class MainWindow : Window
{
   internal int i;
    public MainWindow()
    {
        InitializeComponent();
    }
} 
```

我想在子窗口中使用他，为此我在内部（同一个命名空间中的两个窗口）和子窗口仍然无法识别变量

我应该做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:38:24.630

您应该在类型的子窗口上创建一个公共属性`int`。创建子窗口时，然后根据父窗口中字段的值设置该属性。

看来您不仅希望能够读取子类中的变量，还希望能够修改它并将该更改反映在父表单中，这样会使答案复杂化。

我们需要从帮助类开始。因为我们感兴趣的数据是一个`int`（它是一个值类型），所以我们需要一个引用类型（即一个类）。

```
public class Wrapper<T>
{
    public T Value { get; set; }
} 
```

所以我们首先在父表单中没有整数，而是这个类的实例：

```
public class Form1
{
    private Wrapper<int> data = new Wrapper<int>(); //TODO give better name
    //...
} 
```

接下来，我们需要子窗体上的公共属性；而不是`int`我们将使用这个新类：

```
public class Form2
{
    public Wrapper<int> Data { get; set; }
    //...
} 
```

现在，当我们创建子类时，我们将根据父类中的值设置属性：

```
public void someMethod()
{
    Form2 childForm = new Form2();
    childForm.Data = data;
    childForm.Show();
} 
```

现在我们已经完成了所有这些，我们确保了父类和子类都引用了相同的实例，因此对实例属性的`Wrapper`任何更改（来自任一类）都将被任一引用“看到” .`Value``Wrapper`

# actionscript-3 - 从 adobeAir 应用程序编译 SWF 运行时

> ID：12373183
> 
> 赞同：0
> 
> 时间：2012-09-11T15:30:25.453
> 
> 标签：actionscript-3, flash, apache-flex

我在从 adobe air 应用程序创建 swf 文件运行时时遇到问题。例如，我使用[https://github.com/jamesflorentino/Flip-Planes-AS3](https://github.com/jamesflorentino/Flip-Planes-AS3)创建动画，我已将 Sprite 扩展转换为 MovieClip，动画运行得非常好。现在我想让动画可以被用户保存为 swf 文件。

我用这样的脚本尝试了 as3swf：

```
private function createSwf():void{
    //let make example the Main class is taken from github above
    var _main:Main = new Main();
    // in this case i use AS3SWF plugin
    var _swf:SWF = new SWF(_main.loaderInfo.bytes);
    // this is for copy byteArray from the _swf convertor
    var buffer:ByteArray = new ByteArray();
    _swf.publish(buffer);        
    saveToDesktop(buffer);
}

private function saveToDesktop(_ba:ByteArray):void{
  // create the file on the desktop
  var myFile:File = File.desktopDirectory.resolvePath("demo.swf");
  // create a FileStream to write the file
  var fs:FileStream = new FileStream();
  // add a listener so you know when its finished saving
  fs.addEventListener(Event.CLOSE, fileWritten);
  // open the file
  fs.openAsync(myFile, FileMode.WRITE);   
  // write the bytearray to it
  fs.writeBytes(_ba);
  // close the file
  fs.close();
}

private function fileWritten(e:Event):void{
  trace("new swf file is created");
} 
```

在所有这些过程之后，我在桌面文件夹中生成了名为 demo.swf 的 swf，但是当我打开文件时，它只是一个带有错误消息的白色背景：

```
VerifyError: Error #1014: Class flash.events::NativeWindowBoundsEvent could not be found.
at flash.display::MovieClip/nextFrame()
at mx.managers::SystemManager/deferredNextFrame()[E:\dev\4.y\frameworks\projects\framework\src\mx\managers\SystemManager.as:278]
at mx.managers::SystemManager/preloader_preloaderDocFrameReadyHandler()[E:\dev\4.y\frameworks\projects\framework\src\mx\managers\SystemManager.as:2627]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at mx.preloaders::Preloader/timerHandler()[E:\dev\4.y\frameworks\projects\framework\src\mx\preloaders\Preloader.as:515]
at flash.utils::Timer/_timerDispatch()
at flash.utils::Timer/tick() 
```

请帮助我从脚本端或命令行端创建 swf 文件运行时的最佳方法是什么，只要不是服务器端，因为它是桌面应用程序。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:59:00.410

在运行时创建 SWF 与获取动画的内存字节数组表示并使用 SWF 扩展名保存它不同。

如果您想从 AIR 构建 SWF；您可以考虑将 Flex Framework 与您的应用程序捆绑在一起，并使用[NativeProcess](http://www.seriousmagic.com/devnet/air/flex/quickstart/articles/interacting_with_native_process.html)来触发 mxmlc 以生成 SWF。您需要源代码 [或 SWC] 来执行此操作，但它不适用于您正在运行的应用程序中已编译的资产/类。

或者，您可能想要查看[SWF 的文件格式](http://www.adobe.com/content/dam/Adobe/en/devnet/swf/pdf/swf_file_format_spec_v10.pdf)并从 AIR 应用程序手动创建它。我毫不怀疑这是可能的，但我不认为这是微不足道的。

# doctrine - 计算学说中的外键数

> ID：12373185
> 
> 赞同：1
> 
> 时间：2012-09-11T15:30:33.343
> 
> 标签：doctrine, dql

这是这个问题的后续：[count number of foreign keys](https://stackoverflow.com/questions/12371304/count-number-of-foreign-keys)

我正在使用学说 1.2，我想计算属于子类别的业务数量。

以下是mysql表。

**1.`fi_category`**

```
+----+-----------------+-----------------+
| id | name            | slug            |
+----+-----------------+-----------------+ 
```

**2.`fi_subcategory`**

```
+----+-----------------+-----------------+-------------+
| id | name            | slug            | category_id |
+----+-----------------+-----------------+-------------+ 
```

**3.`fi_business_subcategory`**

```
+----+-------------+----------------+
| id | business_id | subcategory_id |
+----+-------------+----------------+ 
```

我正在使用这个 DQL。

```
$q = Doctrine_Query::create()
    ->select('c.name, c.slug, sc.name, sc.slug')
    ->from('Model_Category c')
    ->leftJoin('c.Subcategory sc')
    ->leftJoin('sc.BusinessSubcategory bsc'); 
```

这给了我这样的东西。

```
Array
(
    [0] => Array
    (
        [id] => 1
        [name] => Entertainment & Lifestyle
        [slug] => entertainment-lifestyle
        [Subcategory] => Array
        (
            [0] => Array
            (
                [id] => 1
                [name] => Arts and Crafts
                [slug] => arts-and-crafts
            )
            [1] => Array
            (
                [id] => 2
                [name] => Family
                [slug] => family
            )
            [2] => Array
            (
                [id] => 3
                [name] => Fashion
                [slug] => fashion
            )
        )
    )
) 
```

我正在寻找业务数量，即返回的结果应该是这样的，具体取决于它所属的业务。

```
Array
(
    [0] => Array
    (
        [id] => 1
        [name] => Entertainment & Lifestyle
        [slug] => entertainment-lifestyle
        [Subcategory] => Array
        (
            [0] => Array
            (
                [id] => 1
                [name] => Arts and Crafts
                [slug] => arts-and-crafts
                [business_count] => 35
            )
            [1] => Array
            (
                [id] => 2
                [name] => Family
                [slug] => family
                [business_count] => 10
            )
            [2] => Array
            (
                [id] => 3
                [name] => Fashion
                [slug] => fashion
                [business_count] => 27
            )
        )
    )
) 
```

使用 DQL 尝试了各种方法，但似乎没有任何效果。知道我应该如何去做我想要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T11:11:07.907

你试过了吗：

```
$q = Doctrine_Query::create()
     ->select('c.name, c.slug, sc.name, sc.slug, COUNT(sc.BusinessSubcategory.id) AS business_count')
     ->from('Model_Category c')
     ->leftJoin('c.Subcategory sc')
     ->groupBy('c.id, sc.id'); 
```

和`HYDRATE_ARRAY`

# php - PHP 领域模型

> ID：12373189
> 
> 赞同：12
> 
> 时间：2012-09-11T15:30:43.103
> 
> 标签：php, oop, domain-driven-design, domain-model, object-oriented-database

我已经用 PHP 编程好几年了，过去我采用了自己的方法来处理我的应用程序中的数据。

我过去构建了自己的 MVC，并且对 php 中的 OOP 有合理的理解，但我知道我的实现需要一些认真的工作。

过去，我在模型和数据库表之间使用了 is-a 关系。经过一些研究，我现在知道这并不是最好的前进方式。据我了解，我应该创建并不真正关心底层数据库（或要使用的任何存储机制）但只关心它们的操作和数据的模型。

由此我已经确定我可以创建模型，例如一个 Person 一个这个人对象可以有一些子项（人类子项），这些子项也是保存在数组中的 Person 对象（使用 addPerson 和 removePerson 方法，接受一个 Person 对象） .

然后我可以创建一个 PersonMapper，我可以用它来获取一个具有特定“id”的人，或者保存一个人。

然后，这可以在查找表中查找关系数据，并为已请求的 Person（如果有）创建关联的子对象，并同样在 save 命令上将数据保存在查找表中。

这现在正在突破我的知识范围......

如果我想为具有不同楼层和这些楼层内不同房间的建筑物建模怎么办？如果我想在这些房间里放置一些物品怎么办？

我会为建筑、关卡、房间和物品创建一个类吗

具有以下结构。

building 可以有 1 个或多个 level 对象保存在一个数组中 level 可以有 1 个或多个 room 对象保存在一个数组中 room 可以有 1 个或多个 item 对象保存在一个数组中

每个类的映射器和更高级别的映射器使用子映射器来填充数组（根据顶级对象的请求或请求的延迟加载）

尽管在一个方向上，这似乎将不同的对象紧密地耦合在一起（即，楼层不需要在建筑物中，但建筑物可以有层次）

这是做事情的正确方法吗？

在视图中，我想显示一个带有选择级别选项的建筑物，然后显示带有选择房间等选项的级别。但我可能还想显示建筑物中项目的树状结构以及什么他们所在的楼层和房间。

我希望这是有道理的。当 oop 的一般概念似乎是分离事物时，我只是在相互嵌套对象的概念上苦苦挣扎。

如果有人可以提供帮助，那将非常有用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-11T04:18:53.027

假设您像这样组织对象： ![在此处输入图像描述](../Images/a5715f4f46233b08856eb2f18e87427a.png)

为了初始化整个建筑对象（包括关卡、房间、物品），您必须提供数据库层类来完成这项工作。获取建筑物树视图所需的所有内容的一种方法是：

（*放大浏览器以获得更好的视图*）

![缩放以获得更好的视图](../Images/c9fce65d3273c28e3ef8ff99e99269a3.png)

构建将根据作为参数提供给 initializeById 方法的映射器使用适当的数据初始化自身。这种方法也可以在初始化关卡和房间时起作用。（注意：在初始化整个建筑物时重用那些 initializeById 方法会导致大量的数据库查询，所以我使用了一点结果索引技巧和 SQL IN opetator）

```
class RoomMapper implements RoomMapperInterface {

    public function fetchByLevelIds(array $levelIds) {
        foreach ($levelIds as $levelId) {
            $indexedRooms[$levelId] = array();
        }

        //SELECT FROM room WHERE level_id IN (comma separated $levelIds)
        // ...
        //$roomsData = fetchAll();

        foreach ($roomsData as $roomData) {
            $indexedRooms[$roomData['level_id']][] = $roomData;
        }

        return $indexedRooms;
    }

} 
```

现在假设我们有这个数据库模式

![在此处输入图像描述](../Images/cc22e54e77936f26515639710345a7eb.png)

最后是一些代码。

**建造**

```
class Building implements BuildingInterface {

    /**
     * @var int
     */
    private $id;

    /**
     * @var string
     */
    private $name;

    /**
     * @var LevelInterface[]
     */
    private $levels = array();

    private function setData(array $data) {
        $this->id = $data['id'];
        $this->name = $data['name'];
    }

    public function __construct(array $data = NULL) {
        if (NULL !== $data) {
            $this->setData($data);
        }
    }

    public function addLevel(LevelInterface $level) {
        $this->levels[$level->getId()] = $level;
    }

    /**
     * Initializes building data from the database. 
     * If all mappers are provided all data about levels, rooms and items 
     * will be initialized
     * 
     * @param BuildingMapperInterface $buildingMapper
     * @param LevelMapperInterface $levelMapper
     * @param RoomMapperInterface $roomMapper
     * @param ItemMapperInterface $itemMapper
     */
    public function initializeById(BuildingMapperInterface $buildingMapper, 
            LevelMapperInterface $levelMapper = NULL, 
            RoomMapperInterface $roomMapper = NULL, 
            ItemMapperInterface $itemMapper = NULL) {

        $buildingData = $buildingMapper->fetchById($this->id);

        $this->setData($buildingData);

        if (NULL !== $levelMapper) {
            //level mapper provided, fetching bulding levels data
            $levelsData = $levelMapper->fetchByBuildingId($this->id);

            //indexing levels by id
            foreach ($levelsData as $levelData) {
                $levels[$levelData['id']] = new Level($levelData);
            }

            //fetching room data for each level in the building
            if (NULL !== $roomMapper) {
                $levelIds = array_keys($levels);

                if (!empty($levelIds)) {
                    /**
                     * mapper will return an array level rooms 
                     * indexed by levelId
                     * array($levelId => array($room1Data, $room2Data, ...))
                     */
                    $indexedRooms = $roomMapper->fetchByLevelIds($levelIds);

                    $rooms = array();

                    foreach ($indexedRooms as $levelId => $levelRooms) {
                        //looping through rooms, key is level id
                        foreach ($levelRooms as $levelRoomData) {
                            $newRoom = new Room($levelRoomData);

                            //parent level easy to find
                            $levels[$levelId]->addRoom($newRoom);

                            //keeping track of all the rooms fetched 
                            //for easier association if item mapper provided
                            $rooms[$newRoom->getId()] = $newRoom;
                        }
                    }

                    if (NULL !== $itemMapper) {
                        $roomIds = array_keys($rooms);
                        $indexedItems = $itemMapper->fetchByRoomIds($roomIds);

                        foreach ($indexedItems as $roomId => $roomItems) {
                            foreach ($roomItems as $roomItemData) {
                                $newItem = new Item($roomItemData);
                                $rooms[$roomId]->addItem($newItem);
                            }
                        }
                    }
                }
            }

            $this->levels = $levels;
        }
    }

} 
```

**等级**

```
class Level implements LevelInterface {

    private $id;
    private $buildingId;
    private $number;

    /**
     * @var RoomInterface[]
     */
    private $rooms;

    private function setData(array $data) {
        $this->id = $data['id'];
        $this->buildingId = $data['building_id'];
        $this->number = $data['number'];
    }

    public function __construct(array $data = NULL) {
        if (NULL !== $data) {
            $this->setData($data);
        }
    }

    public function getId() {
        return $this->id;
    }

    public function addRoom(RoomInterface $room) {
        $this->rooms[$room->getId()] = $room;
    }

} 
```

**房间**

```
class Room implements RoomInterface {

    private $id;
    private $levelId;
    private $number;

    /**
     * Items in this room
     * @var ItemInterface[]
     */
    private $items;

    private function setData(array $roomData) {
        $this->id = $roomData['id'];
        $this->levelId = $roomData['level_id'];
        $this->number = $roomData['number'];
    }

    private function getData() {
        return array(
            'level_id' => $this->levelId,
            'number' => $this->number
        );
    }

    public function __construct(array $data = NULL) {
        if (NULL !== $data) {
            $this->setData($data);
        }
    }

    public function getId() {
        return $this->id;
    }

    public function addItem(ItemInterface $item) {
        $this->items[$item->getId()] = $item;
    }

    /**
     * Saves room in the databse, will do an update if room has an id
     * @param RoomMapperInterface $roomMapper
     */
    public function save(RoomMapperInterface $roomMapper) {
        if (NULL === $this->id) {
            //insert
            $roomMapper->insert($this->getData());
        } else {
            //update
            $where['id'] = $this->id;
            $roomMapper->update($this->getData(), $where);
        }
    }

} 
```

**物品**

```
class Item implements ItemInterface {

    private $id;
    private $roomId;
    private $name;

    private function setData(array $data) {
        $this->id = $data['id'];
        $this->roomId = $data['room_id'];
        $this->name = $data['name'];
    }

    public function __construct(array $data = NULL) {
        if (NULL !== $data) {
            $this->setData($data);
        }
    }

    /**
     * Returns room id (needed for indexing)
     * @return int
     */
    public function getId() {
        return $this->id;
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T02:34:37.750

> 这现在正在突破我的知识范围......

您描述的建筑物/级别/房间/项目结构对我来说听起来非常好。领域驱动设计就是要理解你的领域，然后将概念建模为对象——如果你能用简单的语言描述你想要的东西，你就已经完成了你的任务。当你设计你的领域时，不要考虑其他所有事情（例如持久性），这样跟踪事情会变得更加简单。

> 尽管在一个方向上，这似乎将不同的对象紧密耦合

这没有什么不对。现实世界中的建筑物确实有楼层、房间等，您只是在模拟这个事实。

> 和使用子映射器的具有更高级别映射器的每个类的映射器

在 DDD 术语中，这些“映射器”称为“存储库”。此外，如果您的`Building`对象拥有其中的所有楼层/房间/项目，并且如果在没有`Room`建筑物的情况下单独加载 a 没有意义，则它可能被视为“聚合”。在这种情况下，您只需要一个`BuildingRepository`可以加载整个建筑树的工具。如果您使用任何现代 ORM 库，它应该会自动为您完成所有映射工作（包括加载子对象）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T19:38:17.723

如果我正确理解您的问题，那么您的主要问题是您没有正确使用抽象类。基本上，您应该为每个建筑物、级别、房间等设置不同的类。例如，您应该有一个抽象类 Building，一个由 Building 扩展的抽象类 Levels 等等，这取决于您想要拥有的确切内容，并且就像你有一个树建筑->关卡->房间，但它更像是一个双链表，因为每个建筑都有一个关卡对象数组，每个关卡都有一个建筑对象的父级。您还应该使用界面，因为许多人会忽略它们，它们将来会对您和您的团队有很大帮助。

关于以更通用的方式构建模型，我认为最好的方法是拥有一个类，该类为您使用的每种类型的数据库或其他存储方法实现相同的方法。例如，您有一个 mongo 数据库和一个 mysql 数据库，您将为每个数据库创建一个类，它们将具有 add、remove、update、push 等方法。确保您不会犯任何错误，一切都会正常工作最好的方法是拥有一个接口数据库来存储方法，并且您最终不会在未定义 mysql 方法的地方使用 mongo 方法。您还可以为公共方法定义一个抽象类（如果有的话）。希望这会有所帮助，干杯！

# objective-c - 在 iOS 中创建类似于 Facebook 应用的视图

> ID：12373193
> 
> 赞同：0
> 
> 时间：2012-09-11T15:30:55.053
> 
> 标签：objective-c, uitableview, ios5

我需要创建一个主屏幕与 Facebook iOS 应用非常相似的 iOS 应用。我正在使用 UITableView 来显示提要中的不同帖子。我的问题是：

实现这一点的最佳选择是什么？一种选择是将 Textviews/Imageviews/labels 插入表格视图单元格，另一种选择是在每个表格视图单元格中都有一个 UIWebView。我要展示很多图片和文字，所以也许html会更容易。

有什么经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:47:15.583

如果您必须显示大量图片和文本，添加一个复杂级别（如 HTML）将无济于事。

我建议开始研究如何加快这个巨大的表格，以及如何检索要在每个单元格上显示的内容。例如，您可以使用并行线程，在您向下滚动时在后台检索内容并将其存储在缓存中，因此不必多次执行。[RestKit](http://restkit.org/)或（取决于您的特定需求）[AFNetworking](https://github.com/AFNetworking/AFNetworking)肯定会对您的情况有所帮助。

另外，看看这篇关于如何提高滚动速度的文章（有点旧，但仍然很有趣！）：[快速滚动](http://web.archive.org/web/20100322222950/http://blog.atebits.com/2008/12/fast-scrolling-in-tweetie-with-uitableview/)（并链接到 github[示例项目](https://github.com/adamalex/fast-scrolling)）

# macos - Mac上的Mercurial“未提供用户名”错误

> ID：12373194
> 
> 赞同：-1
> 
> 时间：2012-09-11T15:30:55.650
> 
> 标签：macos, version-control, mercurial

我刚刚在我的 OSX Mountain Lion Max (10.8) 上安装了 Mercurial，在我的第一次提交中我收到了错误：

```
abort: no username supplied (see "hg help config") 
```

我看到很多答案表明我需要从某个位置创建或复制文件并将其粘贴到另一个位置并将我的用户名和电子邮件添加到文档中。

如果这是正确的做法：

*   我需要复制的文件在哪里（或者我需要创建的文件是什么）
*   我把那个文件放在哪里
*   我只需要在文件中添加以下两行吗？

    ```
    [ui]
    username = Your Name <your@email.com> 
    ```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T15:44:36.853

该文件已命名`.hgrc`，并且位于您的主目录中。如果您只是将这些行附加到`~/.hgrc`，那么一切都应该没问题。

Mercurial 配置文件的极其详细的概述位于[此处](http://www.selenic.com/mercurial/hgrc.5.html)。

`-u your@email.com`另一种不太方便的方法是在命令行上传递。

# javascript - 在 Jquery 倒数计时器上为每个数字设置动画

> ID：12373200
> 
> 赞同：1
> 
> 时间：2012-09-11T15:31:10.000
> 
> 标签：javascript, jquery, mobile

[http://jsfiddle.net/GNrUM/](http://jsfiddle.net/GNrUM/)

上面的当前 jsfiddle 显示了 2 秒倒计时。想象一下，没有文字，只有数字。我试图找出：

a）我应该如何将某种动画集成到 js 中，以便数字在当前被计数时改变大小、颜色和位置（与持续时间一致）。Css3 可以工作，但我需要它是基于 javascript 的，所以它可以在移动设备上的旧浏览器上工作。

b) 倒计时完成后显示其他内容，就好像它是一个新页面但仍然在相同的 url 上。

非常感谢任何反馈。

编辑：即使是一个很好的提示来帮助我，也可能更好地帮助我自己解决这个问题。只是缺乏语法知识，在 js 中有点菜鸟。干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T15:52:37.917

使用 animate() 函数

```
var sec = 10
var timer = setInterval(function() {
    $('#hideMsg span').animate({
        opacity: 0.25,
        fontSize: '2em'
    }, 500, function() {
        $('#hideMsg span').css('opacity', 1);
        $('#hideMsg span').css('font-size', '1em');
        $('#hideMsg span').text(sec--);
    })

    if (sec == -1) {
        $('#hideMsg').fadeOut('fast');
        clearInterval(timer);
    }
}, 1000);​ 
```

JSFiddle 链接：http: [//jsfiddle.net/GNrUM/412/](http://jsfiddle.net/GNrUM/412/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:38:27.520

我会看看类似于这个库的东西：[http ://ricostacruz.com/jquery.transit/](http://ricostacruz.com/jquery.transit/)

它将在可用时使用 CSS3 过渡并进行优雅的后备。

至于在哪里添加它，在你这样做之前：

```
$('#hideMsg span').text(sec--); 
```

我会执行所需的动画，并在动画结束时执行上面的代码来更新计时器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:46:08.797

[http://jsfiddle.net/GNrUM/410/](http://jsfiddle.net/GNrUM/410/)

```
var sec = 10
var timer = setInterval(function() { 
    var color = sec > 5 ? "red" : "green";
   $('#hideMsg span').text(--sec).css("font-size", 10+sec*2 + "px").css("color", color);
   if (sec == 0) {
      $('#hideMsg').fadeOut('fast');
      clearInterval(timer);
   } 
}, 1000);​ 
```

这些值可能不是您想要的，但这为您提供了入门的基本思路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T15:47:42.877

我过去使用过[这个 jQuery 插件](https://stackoverflow.com/a/2540673/1639699)。它有`onUpdate`和`onComplete`回调。您应该能够重新设置计数器的样式`onUpdate`并隐藏它并加载一些内容`onComplete`。这对你有意义吗？

我看到你需要倒计时，而不是倒计时，但你应该没有问题适应插件，因为它很简单。

# asp.net-mvc - MongoDB C# - 从序列化程序中隐藏属性

> ID：12373203
> 
> 赞同：1
> 
> 时间：2012-09-11T15:31:12.673
> 
> 标签：asp.net-mvc, mongodb, mongodb-.net-driver

这是我的用户模型的样子：

```
namespace Api.Models
{
    public class User
    {

        [BsonId(IdGenerator = typeof(StringObjectIdGenerator))]
        [BsonRequired]
        public string Id { get; set; }

        [Required(ErrorMessage = "Username is required.")]
        [StringLength(20, MinimumLength=3, ErrorMessage="Username must be between 3 and 20 characters.")]
        [BsonRequired]
        public string Username { get; set; }

        [Required(ErrorMessage="Email is required.")]
        [EmailAddress(ErrorMessage="Valid email required.")]
        [BsonRequired]
        public string Email { get; set; }

        [Required(ErrorMessage = "Password is required.")]
        [StringLength(50, MinimumLength=8, ErrorMessage="Password must be between 8 and 50 characters.")]
        [BsonRequired]
        public string Password { get; set; }

        [BsonRequired]
        public string Salt { get; set; }

    }
} 
```

我想将所有属性写入 MongoDB 数据库，并且需要这些属性。我不想做的是在我通过请求发送时公开**Password**和**Salt属性。**

是否可以设置任何类型的数据属性来编写它，但在向任何 API 用户显示时不公开它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:36:27.773

正确的方法是使用视图模型。不要将您的域实体传递给视图。设计满足视图特定要求的视图模型。因此，例如设计一个没有 Password 和 Salt 属性的视图模型，因为这正是该视图所需要的。然后为了简化域模型和视图模型之间的映射，您可以使用[AutoMapper](http://automapper.org/)。

如果您不想在视图模型中遵循良好实践，您仍然可以使用 Bind 属性将 POST 操作弄乱，并决定要从模型绑定中包含/排除哪些属性。例如：

```
[HttpPost]
public ActionResult SomeAction([Bind(Exclude="Password,Salt")]User user)
{
    // at this stage the Password and Salt properties will always be null =>
    // they will never be bound from the request even if the user attempts to 
    // forge an HTTP request and include them
    ...
} 
```

# objective-c - 检查 NSFont 是否包含字符

> ID：12373213
> 
> 赞同：2
> 
> 时间：2012-09-11T15:31:28.043
> 
> 标签：objective-c, unicode, nsfont

如何以编程方式检查 NSFont 是否包含像“°”这样的 unicode 字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:15:37.640

好的，试试这个：

```
NSFont *font = [NSFont fontWithName:@"Arial" size:14.0];
NSCharacterSet *set = [font coveredCharacterSet];
if (![set characterIsMember:[@"°" characterAtIndex:0]]) {
    NSLog(@"Failed");
} else {
    NSLog(@"Success");
} 
```

# c++ - QInputDialog - 用回车键确认

> ID：12373221
> 
> 赞同：4
> 
> 时间：2012-09-11T15:32:00.953
> 
> 标签：c++, qt, key, keyboard-shortcuts, qdialog

我试图使用没有按钮的 QInputDialog 。它看起来就像我想要的那样，但我不确认输入（将其用于文本输入）。有没有可能用回车键确认，然后`exec()`返回`QInputDialog::Accepted`？就像转义键使对话框返​​回一样`QInputDialog::Rejected`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T14:47:17.007

您可以在 QInputDialog 上安装EventFilter()，然后让 eventFilter() 在 keypressevent() 上接受对话框。:)

# vb.net - OleDbException：SQL 语句末尾缺少分号 (;)

> ID：12373225
> 
> 赞同：1
> 
> 时间：2012-09-11T15:32:11.803
> 
> 标签：vb.net, oledb, oledbexception

我得到一个 OleDbException 说“缺少 SQL 语句末尾的分号 (;)”。我对 UPDATE 语句是否正确感到困惑。在我的代码中，我使用按钮测试更新语句。谁能帮我？我想给变量加 1 以增加它的值；瓶数。我正在使用 Microsoft Access 数据库。Primary id 是 ID，然后 Unique 是 room_number。

这是我的代码：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    '====test number of bottles=============
    Dim bottlecount As Integer 'variable used in order to increase the value of no. of bottle/s used

    bottlecount = Form3.lblBottle.Text
    bottlecount += 1
    Form3.lblBottle.Text = bottlecount

    roomhold = 1

    Dim statement As String = "UPDATE tblPatientInfo SET bottle_used='" & bottlecount & "' WHERE room_number= '" & roomhold & "' ORDER BY ID ;"
    Dim cmd As New OleDbCommand

    With cmd
        .CommandText = statement
        .Connection = Conn
        Conn.Open()
        .ExecuteNonQuery()
    End With
    Conn.Close()

End Sub 
```

===应用更改后========== 这是我的代码：

```
 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    Dim bottlecount As Integer = CInt(Form3.lblBottle.Text) + 1
    Form3.lblBottle.Text = bottlecount

    roomhold = 1

    Dim statement As String = "UPDATE tblPatientInfo SET bottle_used = @bottlecount"
    statement &= "WHERE room_number = @roomhold"

     Dim cmd As New OleDbCommand

    With cmd

        .Connection = Conn
        .CommandType = CommandType.Text
        .CommandText = statement
        .Parameters.AddWithValue("@bottlecount", bottlecount)
        .Parameters.AddWithValue("@roomhold", roomhold)
        Conn.Open()
        .ExecuteNonQuery()
    End With 
```

# 连接关闭（）

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:35:35.647

您不订购更新命令。

```
Dim statement As String = "UPDATE tblPatientInfo SET bottle_used='" & bottlecount & "' WHERE room_number= '" & roomhold & "'" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:49:46.793

`UPDATE`不允许有`ORDER BY`子句。如果您希望更新为有序，请创建它的子查询，其中包含更新的有序列表。使用 ADONet 时，请确保您的查询是参数。习惯了`SQLCommand and Parameters`。试试这个编辑过的代码，如果它对你有用

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim bottlecount As Integer = cint(Form3.lblBottle.Text) + 1
    Form3.lblBottle.Text = bottlecount

    Dim roomhold AS Integer = 1

    Dim statement As String = "UPDATE tblPatientInfo SET bottle_used = @bottlecount " 
    statement &= "WHERE room_number = @roomhold  "
    Using conn as New SqlConnection("ConnectionStringHere")
        Using comm as New SqlCommand()
            With comm
                .Connection = conn
                .CommandType = CommandType.Text
                .CommandText = statement
                .Parameters.AddWithValue("@bottlecount", bottlecount )
                .Parameters.AddWithValue("@roomhold" , roomhold)
            End With
            Try
                conn.Open()
                comm.ExecuteNonQuery()
            Catch (ex as SQlException)
                ' add message here '
            Finally
                conn.Close()
            End Try
        End Using
    End Using
End Sub 
```

# mysql - ON DUPLICATE KEY 查询中的重复项在哪里？

> ID：12373227
> 
> 赞同：2
> 
> 时间：2012-09-11T15:32:17.930
> 
> 标签：mysql, sql-update, sql-insert, on-duplicate-key

**描述：**

我正在尝试将用户的首选项插入数据库。如果用户还没有放置任何东西，我想要一个`insert`，否则，我想要一个`update`. 我知道我可以在创建用户时插入默认值，而不是专门使用`update`，但这增加了另一个查询（我认为）

**问题：**

我已经阅读了，`ON DUPLICATE KEY UPDATE`但我不明白。[这](https://stackoverflow.com/questions/6786141/mysql-on-duplicate-key-update-question)几乎是我的确切问题，但没有答案。答案说：

> 只要您将正确的列定义为 UNIQUE KEY 或 PRIMARY KEY，它听起来确实适用于您想要做的事情。

如果我`insert`像这样做一个简单的事情：

```
INSERT INTO table (color, size) VALUES ('blue', '18') ... 
```

那将如何产生`DUPLICATE KEY`？据`mysql`所知，它只是另一个插入，并且`id`是自动递增的。我将表中的主键设置为唯一的，但`insert`不会对此进行检查，对吧？

**桌子：**

```
CREATE TABLE `firm_pref` (
    `id` int(9) NOT NULL AUTO_INCREMENT,
    `firm_id` int(9) NOT NULL, //user_id in this case
    `header_title` varchar(99) NOT NULL,
    `statement` varchar(99) NOT NULL,
    `footer_content` varchar(99) NOT NULL,
PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:40:51.773

好吧，除非您希望您的应用程序仅由一个人使用，否则您必须在其中指定某人的 user_id `INSERT`- 当这个“某人”男孩或女孩更新他/她的偏好时，对吗？

该字段 ( `user_id`) 正是`ON DUPLICATE KEY UPDATE`子句检查的内容。

如果你想插入一条新记录，只需发送`NULL`：

```
INSERT INTO table (user_id, color, size) VALUES (NULL, 'blue', 18); 
```

...因此自动增量将有机会继续前进并挽救局面。)

**更新：**请注意，要了解某些字段应被视为*唯一*标识符，您应该将其标记为唯一标识符。通常它是自然完成的，因为该字段用作`PRIMARY KEY`. 但有时这还不够；这意味着一些`UNIQUE`约束工作。例如，在您的表中，它可以这样使用：

```
CREATE TABLE `prefs` (
    `id` int(9) NOT NULL AUTO_INCREMENT,
    `firm_id` int(9) NOT NULL,
     ...
     PRIMARY KEY (`id`),
     UNIQUE KEY (`firm_id`)
); 
```

*（或者您可以使用命令将此约束添加到现有表中* `ALTER TABLE prefs ADD UNIQUE (firm_id)` *）*

然后插入/更新查询看起来像......

```
INSERT INTO prefs(firm_id, header_title, statement, footer_content) 
           VALUES(17, 'blue', '18', 'some_footer')
 ON DUPLICATE KEY UPDATE 
           header_title = 'blue', 
           statement = '18', 
           footer_content = 'some_footer'; 
```

我在 SQL Fiddle 中构建了一个[演示。](http://sqlfiddle.com/#!2/f4f1e)你可以多玩一些来更好地理解这个概念。)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:42:58.453

对于选项，您通常会有一个`options`包含可用选项列表（如颜色、大小等）的表格，然后是一个包含用户值的表格，该表格跨越您的`options`表格和表格。`users`

例如，您的`options`表：

```
id | name
=========
1  | color
2  | size 
```

你的`users`桌子：

```
id | name
================
1  | Martin Bean 
```

和一个`options_users`连接表：

```
option_id | user_id | value
===========================
1         | 1       | Blue
2         | 1       | Large 
```

通过在表中设置正确的外键`options_users`，您可以在从系统中删除选项或用户时删除冗余值。此外，当保存用户的偏好时，您可以先删除他们以前的答案并插入新的答案。

```
DELETE FROM `options_users`
WHERE `user_id` = @user_id;

INSERT INTO `options_users` (`option_id`, `user_id`, `value`)
VALUES (1, @user_id, 'Blue'), (2, @user_id, 'Large'); 
```

希望有帮助。

# excel - UserForm 在 Workbook_Open 上闪烁并消失

> ID：12373232
> 
> 赞同：0
> 
> 时间：2012-09-11T15:32:47.863
> 
> 标签：excel, vba

```
Private Sub Workbook_Open()
Sheets("01").Delete
Sheets("02").Copy before:=Sheets("02")
Sheets("02 (2)").Name = "01"
Form1.Show
End Sub 
```

Form1 很快出现（有点像闪烁）然后 - 永远消失
如果我在 Workbook_Open 事件之外运行此代码 - 它运行良好。
当我将它放回 Workbook_Open 时 - 再次闪烁 - 并消失。
当我删除前三行（仅运行 Form1.Show）时 - 它可以工作。
请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T01:39:07.930

-- 听起来只是您看到代码执行请求的进程。

# c# - 为什么 BackgroundWorker 的 WorkerReportsProgress 和 WorkerSupportsCancellation 的默认值是 false？

> ID：12373233
> 
> 赞同：3
> 
> 时间：2012-09-11T15:32:57.480
> 
> 标签：c#, performance, backgroundworker

`BackgroundWorker`使用's`WorkerReportsProgress`和`WorkerSupportsCancellation`设置为有性能损失`true`吗？他们还有其他原因`false`吗？

`true`会更合乎逻辑，因为如果您不想实现它们 - 就不要。`true`不会伤害你。

我正在考虑将`BackgroundWorker`s 封装在一个类中（所以我不会忘记将这些属性设置为 true，以及其他一些东西）。但是由于默认值是`false`，也许这表明它们存在一些缺点`true`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:35:29.760

似乎它们只是通知调用程序它不能调用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:48:02.097

根据`BackgroundWorker`'s 代码`WorkerReportsProgress`设置为`false`将阻止用户代码调用`ReportProgress`方法。`ReportProgress`方法本身相当快，但计算当前显示可能需要一些时间。所以我猜没有很大的性能差距，但可以节省一些滴答声。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:42:34.890

我从来没有注意到任何退化。我经常使用这些，并且几乎总是将这些值设置为 true。如果有惩罚，那么它必须被它提供的功能所抵消。如果有数据支持相反的情况，我想知道。

# mysql - mysql - 将查询作为值（动态值）

> ID：12373237
> 
> 赞同：0
> 
> 时间：2012-09-11T15:33:09.477
> 
> 标签：mysql

我可以在 mysql 中将查询作为值提供吗？

我的意思是这样的：

```
UPDATE table1 SET val='X' 
```

在哪里

```
X= SELECT COUNT(page) AS X FROM table2 WHERE order_no=1 
```

所以每次我要求 X 它应该取决于其他表格的内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:34:26.753

你可以`subquery`为你的价值做事，例如

```
UPDATE table1 
SET val = (
           SELECT COUNT(page) 
           FROM table2 
           WHERE order_no = 1
          ) 
```

# file - 什么是规范的“将文件 1 附加到文件 2”常规代码片段？

> ID：12373238
> 
> 赞同：1
> 
> 时间：2012-09-11T15:33:09.517
> 
> 标签：file, groovy

我搜索了 Google & the [File Recipes](http://groovy.codehaus.org/Recipes+For+File)，但我还没有找到规范的方法：

```
cat a.txt b.txt > c.txt 
```

在时髦。这里有一个建议：

```
def appendFile(File src, File target) {
    def newline = System.getProperty('line.separator')

    src.eachLine { line ->
        target << line
        target << newline
    };
} 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:39:55.533

如果将 InputStream 传递给[`File.leftShift`](http://groovy.codehaus.org/groovy-jdk/java/io/File.html#leftShift%28java.lang.Object%29)，它会将流的内容附加到文件中。我会做这样的事情：

```
src.withInputStream { input ->
    target << input
} 
```

# c# - MVPVM - 使用 Interface 或 Presenter 处理事件

> ID：12373239
> 
> 赞同：3
> 
> 时间：2012-09-11T15:33:11.443
> 
> 标签：c#, winforms, design-patterns, mvvm, mvp

处理按钮点击、行双击等事件。什么是更好的方法？

演示者直接访问查看。所以视图可以直接在presenter上调用相应的方法，例如。`Presenter.Save()`

**或者**

界面中的事件。

```
interface ILoginDetailView:
{
   event EventHandler Save;        
} 
```

看法

```
private void btnSave_Click(object sender, EventArgs e)
{
   Save(this, null)
} 
```

主持人

```
view.Save += new EventHandler(view_Save); 
```

我觉得第二种方法更好，因为它使视图与演示者分离。但是在所有描述该模式的文章/论文中，都使用了第一种方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:17:17.717

就个人而言，我总是选择第二种方法。一般来说，我不喜欢让视图知道演示者，而解耦是一个很大的优势。否则，我发现自己在制作函数，从视图中获取特定变量。事件模式很好地打破了这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T15:53:12.817

我也将采用第二种方法，因为正如您所说，它将视图与演示者分离，这反过来又使这些东西可测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-19T04:16:49.873

在 MVPVM（模型视图演示者视图模型）模式中，它声明视图通常与您的视图紧密耦合。这允许您的视图模型、视图和业务/数据访问层保持分离。

所以再一次，演示者可以严格地允许直接访问视图，而无需为您的视图模型或视图增加责任。

[MVPVM 设计模式](http://msdn.microsoft.com/en-us/magazine/hh580734.aspx)

这是一篇很棒的文章，很好地讨论了 MVC、MVP、MVVM 和 MVPVM。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T16:17:38.730

我认为第一种方法更清洁。

*Save*感觉不像是一个*事件*。这是一个直接的动作。

在 MVVM 中，您在视图模型上调用命令，在 MVC 中，您在控制器上调用动作，在 MVP 中，您在演示者上调用方法。

*Saved*或*Saving*是一个事件，但不是*Save*。

但这可能是关于个人喜好的问题。

# ios - 在 iOS 上移植 GDB 服务器

> ID：12373240
> 
> 赞同：0
> 
> 时间：2012-09-11T15:33:12.027
> 
> 标签：ios, arm, cross-compiling, darwin, gdbserver

我需要为 iOS 交叉编译一个最新的 GDB 服务器版本（7.4 或 7.5）。默认情况下配置脚本不支持这样的目标（arm-apple-darwin）。但是，我有一个想法，将 Apple 的开源版本的 GDB 服务器（基于相当旧的 GDB 版本）与最新的 GDB 版本合并。有没有人尝试过这种方法？可能有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:07:10.043

使用主线 GDB 会很棘手；Apple 的版本已经分叉很久了，移植它并非易事。为什么你特别需要7.4？

如果您只需要 iOS 的 gdbserver，请尝试[Saurik 的补丁](http://svn.telesphoreo.org/trunk/data/gdb/)，尽管我不确定它们有多新。

# php - 在数组中查找特定值

> ID：12373242
> 
> 赞同：-2
> 
> 时间：2012-09-11T15:33:14.710
> 
> 标签：php, arrays

有一个数组：

```
$arr = array(
        'AA' => 90,
        'AB' => 150,
        'BC' => 100,
        'CD' => 60
); 
```

和一个字符串：

```
$val = 'CD' 
```

有没有快速的方法（没有 FOR 循环）来定义对应的数值`$val`？在此示例中，结果必须为 60。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:35:48.783

你真的只需要`$arr[$val]`.

`echo $arr[$val];`将输出 60。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T15:35:14.467

```
$value = @$arr[$val]; 
```

这就是你所需要的

# mysql - MySql 中的正则表达式

> ID：12373245
> 
> 赞同：0
> 
> 时间：2012-09-11T15:33:22.233
> 
> 标签：mysql, regex

在 MySql（我使用的是 5.1.48）中，以下正则表达式返回`true`ie `1`。

```
SELECT '10-5' REGEXP '10-5' as temp;
SELECT '10/5' REGEXP '10/5' as temp;
SELECT '1*5' REGEXP '1*5' as temp; 
```

然而，以下表达式返回`false`ie `0`。

```
SELECT '10+5' REGEXP '10+5' as temp;
SELECT '10*5' REGEXP '10*5' as temp; 
```

* * *

> 要在正则表达式中使用特殊字符的文字实例，请在其前面加上两个反斜杠 (\) 字符。MySQL 解析器解释其中一个反斜杠，而正则表达式库解释另一个。

转义`+`and`*`在前面两个语句中返回`true`ie`1`如下。

```
SELECT '10+5' REGEXP '10\\+5' as temp;
SELECT '10*5' REGEXP '10\\*5' as temp; 
```

如果是这种情况，那么为什么`*`在以下语句（第一个片段中的最后一个）中**不需要**转义？

```
SELECT '1*5' REGEXP '1*5' as temp; 
```

它返回`true`ie`1`而不转义`*`，并且以下类似的内容（第二个片段中的最后一个）返回`false`.

```
SELECT '10*5' REGEXP '10*5' as temp; 
```

它需要`*`逃脱。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:50:23.363

如您所知，未转义的星号表示“前面的字符的零个或多个”，因此“1 * 5”表示“任意数量的 1，后跟 5”。

关键是来自[文档的](http://dev.mysql.com/doc/refman/5.0/en/pattern-matching.html)信息：

```
 A REGEXP pattern match succeeds if the pattern matches anywhere in the value being tested. (This differs from a LIKE pattern match, which succeeds only if the pattern matches the entire value.) 
```

因此，“1*5”（“任意数量的 1，后跟 5”）将通过仅看到“5”来匹配字符串“1*5”。“10*5”（“1，后跟任意数量的 0，后跟 5”）与字符串“10*5”不匹配，因为“*”字符将其分解。

希望有帮助。

# amazon-s3 - 我想在我的 Wordpress 上嵌入带有 s3 的播放列表。

> ID：12373246
> 
> 赞同：-2
> 
> 时间：2012-09-11T15:33:30.123
> 
> 标签：amazon-s3

希望一切都好，我的问题是我想在我的 wordpress 上嵌入从 s3 流式传输的音频播放器，每个帖子都有不同的播放列表。有没有办法设置它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T18:56:18.177

没有什么可做的。这里有几个简单的步骤：-

1.  创建一个 s3 存储桶
2.  设置读取对象的权限。
3.  将音频文件上传到存储桶。
4.  如果您没有为经过身份验证的用户设置读取权限，您可以使用 url（类似于[http://s3.amazonaws.com/](http://s3.amazonaws.com/) /mp3_filename），或者您必须将签名、到期日期和 AWSAccessKeyId 作为 url 中的参数传递.
5.  您可能还想尝试使用 cloudfront，这将提高可用性并提高性能。

在音频播放器上，您只需将 s3 uri 作为音频源。

# c# - 将一个矩形分成 n 个相等的部分

> ID：12373247
> 
> 赞同：0
> 
> 时间：2012-09-11T15:33:33.487
> 
> 标签：c#, geometry, diagram, rectangles

我需要将一个矩形矩形结构，矩形（双 X，双 Y，双宽度，双高度）拆分为多个较小的矩形/结构，用于 n = 2、n = 4 和 n = 6，我为我的限制整个图表的图表（节点和链接）

```
Rect b = activeDiagram.Panel.DiagramBounds; 
```

有人可以提供一个使用我在 C# 中的结构的示例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:58:49.377

我不是 100% 确定我完全理解你的问题，但它是否像在一个方向上切分一样简单？

```
Rect[] smallerRects = new Rect[n];
for(int i = 0;i < n;++i)
   smallerRects[i] = new Rect(b.X + b.Width / n * i, b.Y, b.Width / n, b.Height); 
```

# .net - 滚动条相遇的恼人广场

> ID：12373248
> 
> 赞同：17
> 
> 时间：2012-09-11T15:33:34.023
> 
> 标签：.net, wpf

我有一个带有 ScrollViewer 的应用程序。2 个滚动条相遇的地方是一个烦人的小方块（见下面的 img），我正试图摆脱它。当我“窥探”应用程序时，我可以找到它作为“矩形”，但我假设它是 ScrollViewer 的一部分？

我已经搜索并搜索了有关此的任何信息，但我能找到的只是通过在其顶部放置一些东西来隐藏它的建议：s

谁能指出我正确的方向来解决这个问题？

![烦人的小广场](../Images/72098335e497053a451885e284ead2fa.png)

```
<ControlTemplate x:Key="HorizontalScrollBar" 
        TargetType="{x:Type ScrollBar}">
        <Grid >
            <Grid.ColumnDefinitions>
                <ColumnDefinition MaxWidth="18"/>
                <ColumnDefinition Width="0.00001*"/>
                <ColumnDefinition MaxWidth="18"/>
            </Grid.ColumnDefinitions>
            <Border
                Grid.ColumnSpan="3"
                CornerRadius="2" 
                Background="Transparent"   />
            <RepeatButton 
                Grid.Column="0"                           
                Style="{StaticResource ScrollBarLineButton}"
                Width="18"
                Command="ScrollBar.LineLeftCommand"
                Content="M 4 0 L 4 8 L 0 4 Z" />
            <Track 
                Name="PART_Track"
                Grid.Column="1"
                IsDirectionReversed="False">
                <Track.DecreaseRepeatButton>
                    <RepeatButton 
                        Style="{StaticResource ScrollBarPageButton}"
                        Command="ScrollBar.PageLeftCommand" />
                </Track.DecreaseRepeatButton>
                <Track.Thumb>
                    <Thumb 
                        Style="{StaticResource ScrollBarThumb}" 
                        Margin="0,1,0,1"  
                        Background="{DynamicResource NormalBrush}"
                        BorderBrush="{DynamicResource NormalBorderBrush}" />
                </Track.Thumb>
                <Track.IncreaseRepeatButton>
                    <RepeatButton 
                        Style="{StaticResource ScrollBarPageButton}"
                        Command="ScrollBar.PageRightCommand" />
                </Track.IncreaseRepeatButton>
            </Track>
            <RepeatButton 
                Grid.Column="3" 
                Style="{StaticResource ScrollBarLineButton}"
                Width="18"
                Command="ScrollBar.LineRightCommand"
                Content="M 0 0 L 4 4 L 0 8 Z"/>
        </Grid>
    </ControlTemplate> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-26T00:08:56.143

我只是遇到了完全相同的问题，但在 Stack 上找到了这个答案来为我解决它：

[无法在 WPF 中完全设置 ListBox/Scrollviewer 的样式](https://stackoverflow.com/questions/1944633/cant-fully-style-a-listbox-scrollviewer-in-wpf)

尽管**该**解决方案**确实**将某些东西放在了正方形的位置，但它是在 ControlTemplate（**ScrollViewer**的，而不是 ScrollBar 的）中完成的，而不是通过一些泡泡糖修补方法将某些东西放在 ScrollViewer**控件**之上。

但是，我发现只要完全从该模板中省略 Rectangle 定义，烦人的角方块就会消失 - 即该区域采用 ScrollViewer 的背景颜色（在给出的示例中是透明的），并且很适合我。如果要设置 ScrollViewer 背景的颜色，只需设置 Grid 的 Background 属性）。

因此，尝试将其添加到您的资源中：

```
<Style TargetType="{x:Type ScrollViewer}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ScrollViewer}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <ScrollContentPresenter Grid.Column="0" />
                    <ScrollBar x:Name="PART_VerticalScrollBar" Grid.Row="0" Grid.Column="1" Value="{TemplateBinding VerticalOffset}" Maximum="{TemplateBinding ScrollableHeight}" ViewportSize="{TemplateBinding ViewportHeight}" Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
                    <ScrollBar x:Name="PART_HorizontalScrollBar" Orientation="Horizontal" Grid.Row="1" Grid.Column="0" Value="{TemplateBinding HorizontalOffset}" Maximum="{TemplateBinding ScrollableWidth}" ViewportSize="{TemplateBinding ViewportWidth}" Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>
                    <!--<Rectangle Grid.Row="1" Grid.Column="1" Fill="Red"/>-->
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-02-25T11:39:17.687

我有一个自定义控件，需要 ScrollViewer 的 ViewportWidth 和 ViewportHeight。但是被回答的覆盖样式打破了那部分。

所以也许是一个简单的方法。

```
<Style TargetType="{x:Type ScrollViewer}">
        <Style.Resources>
            <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Transparent" />
        </Style.Resources>
</Style> 
```

默认模板中的 Rectangle Fill 属性设置为 SystemColors.ControlBrushKey

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-18T14:18:05.673

如果您想删除空白空间，请使用以下代码：

```
<Style TargetType="{x:Type ScrollViewer}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ScrollViewer}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <ScrollContentPresenter Grid.Column="0" />
                    <ScrollBar x:Name="PART_VerticalScrollBar" Grid.Row="0" Grid.Column="1" Value="{TemplateBinding VerticalOffset}" Maximum="{TemplateBinding ScrollableHeight}" ViewportSize="{TemplateBinding ViewportHeight}" Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
                    <ScrollBar x:Name="PART_HorizontalScrollBar" Orientation="Horizontal" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Value="{TemplateBinding HorizontalOffset}" Maximum="{TemplateBinding ScrollableWidth}" ViewportSize="{TemplateBinding ViewportWidth}" Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-06-13T10:26:47.367

标记的答案不适合我。这个做到了。

```
<Style TargetType="{x:Type ScrollViewer}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ScrollViewer}">
                <Grid Background="{TemplateBinding Panel.Background}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <!--<Rectangle Grid.Column="1" Grid.Row="1" Fill="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />-->
                    <ScrollContentPresenter Grid.Column="0" Grid.Row="0" Margin="{TemplateBinding Control.Padding}" Content="{TemplateBinding ContentControl.Content}" ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}" CanContentScroll="{TemplateBinding ScrollViewer.CanContentScroll}" />
                    <ScrollBar Grid.Column="1" Grid.Row="0" Minimum="0" Maximum="{TemplateBinding ScrollViewer.ScrollableHeight}" ViewportSize="{TemplateBinding ScrollViewer.ViewportHeight}" Value="{Binding Path=VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource Mode=TemplatedParent}}" Visibility="{TemplateBinding ScrollViewer.ComputedVerticalScrollBarVisibility}" Cursor="Arrow" AutomationProperties.AutomationId="VerticalScrollBar" />
                    <ScrollBar Orientation="Horizontal" Grid.Column="0" Grid.Row="1" Minimum="0" Maximum="{TemplateBinding ScrollViewer.ScrollableWidth}" ViewportSize="{TemplateBinding ScrollViewer.ViewportWidth}" Value="{Binding Path=HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource Mode=TemplatedParent}}" Visibility="{TemplateBinding ScrollViewer.ComputedHorizontalScrollBarVisibility}" Cursor="Arrow" AutomationProperties.AutomationId="HorizontalScrollBar" />
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# java - Apache POI 保留现有的 Excel 格式样式

> ID：12373251
> 
> 赞同：4
> 
> 时间：2012-09-11T15:33:42.067
> 
> 标签：java, excel, apache-poi

我正在使用 Apache POI 读取现有模板 excel 文件，并希望复制某些标题行中的现有样式并将它们应用于新单元格。

似乎没有应用现有格式（IE、日期、货币、百分比等）。

代码非常基本：

```
//read existing style
Row existingRow = sheet.getRow(headerRowIndex);
Cell existingCell = existingRow.getCell(0);
CellStyle currentStyle = existingCell.getCellStyle();

//apply date style here
Date date = StringUtil.toDate(map.get(column.getHeaderName()));
cell.setCellValue(date);
//apply previous style      
cell.setCellStyle(currentStyle); 
```

它确实复制了字体和背景颜色等，但格式似乎丢失了（所有单元格都应用了“通用”格式）。

当我这样做时：

```
currentStyle.getDataFormat(); // always 0 
```

所以这让我觉得我没有正确阅读格式。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:11:39.317

好的，我想通了，这是我的错误。我从行中的第一个单元格中读取样式并将其应用于所有单元格，而不是从每个单元格中读取。

这修复了它

```
Cell existingCell = existingRow.getCell(i); 
```

# java - 如何在 Spring WebFlow2 中将新模型传递给视图状态

> ID：12373253
> 
> 赞同：0
> 
> 时间：2012-09-11T15:33:44.273
> 
> 标签：java, spring, spring-mvc, spring-webflow

如何将新模型传递给 Spring WebFlow2 中的视图状态。我有一个输入屏幕，我的用户在其中输入一些数据，然后返回到服务器进行处理。如果数据正常，那么我必须设置一个工单模型并将其传递给下一个视图状态以显示。

我无法获得下一个视图状态来显示票证中的数据。有人可以帮帮我吗。

我的流量：

```
<view-state id="MemberInquiry" view="question.jsp" model="memberrequest" >
        <transition on="submit" to="endState">
            <evaluate expression="flowActions.addInquiry(memberrequest)" result="flowScope.ticket"/>
        </transition>

        <transition on="cancel" to="endState" bind="false"/>
    </view-state>

    <view-state id="endState" view="thanks.jsp" >

    </view-state> 
```

这是控制器中的代码：

```
public Ticket addInquiry(MemberRequest memberrequest) {

        LOGGER.debug("[" + memberrequest.toString() + "]");

        // Setting data over to RT

        String Ticket = memberInquiryService.sentWebRequest(memberrequest);

        /*
         * Setting out the ticket number to be displayed to user
         */

        Map<String, Object> model = new HashMap<String, Object>();
        Ticket t = new Ticket();
        t.setTicketDetails(Ticket);

        LOGGER.debug("[" + t.toString() + "]");

        return t;
    } 
```

这是感谢页面中的代码：

```
<p>
    Thanks for submitting.  We will get back to you as soon as possible.
    <p>
    <c:out value="${ticket.TicketDetails}" />
    <br>
    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:51:10.990

尝试一个动作状态：

```
<transition on="submit" to="addInquiry" />

<action-state id="addInquiry">
    <evaluate expression="flowActions.addInquiry(memberrequest)" result="flowScope.ticket"/>
    <transition to="endState" />
</action-state> 
```

# cuda - Cuda 驱动程序初始化失败

> ID：12373255
> 
> 赞同：2
> 
> 时间：2012-09-11T15:33:52.423
> 
> 标签：cuda, gpu, multi-gpu

我有一个两个 gpu 系统，一个 Geforce 8400 GS 和 Geforce GT 520。我能够在两个 gpu 上运行我的 cuda 程序。但是当我使用 cuda-gdb 调试它们时，我收到一条错误消息，说`Cuda driver initialization failed.`另外，当我使用 运行程序时`cuda-gdb`，`cudaGetDeviceCount`说我只有 1 个 gpu。如果我不使用`cuda-gdb`. 有人可以帮我吗？

我正在运行 Ubuntu 11.04。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:56:20.053

1.  看起来您的显示驱动程序版本比 CUDA 工具包所需的版本旧。确保您安装了从您获得工具包的同一下载页面下载的显示驱动程序。
2.  cuda-gdb 将从被调试的应用程序中隐藏用于运行桌面环境的 GPU。否则，当应用程序在断点处挂起时，桌面环境可能已经挂起。要在 cuda-gdb 中查看两个 GPU，您需要在没有桌面环境的情况下运行。

# ios - 实例变量、属性和向 ARC 的过渡

> ID：12373256
> 
> 赞同：0
> 
> 时间：2012-09-11T15:33:55.430
> 
> 标签：ios, automatic-ref-counting

最后，我正在过渡到 ARC。听起来为时已晚，但我所有的项目都具有对 3.0 的逆向兼容性（有关 App Store 不支持的任何消息？）所以我不能使用它。但是现在我正在一个在 iOS 5 中进行基本部署的新项目中工作，所以我使用的是 ARC。

我的问题很简单。我习惯于声明私有实例变量和公共属性。例如：

```
@interface MyClass : NSObject {
@private

    Var *aVar_;
    Var *anotherVar_;
}

@property (nonatomic, readonly) Var *aVar;

@end

@implementation MyClass

@synthesize aVar = aVar_;

@end 
```

在类中，我使用实例变量，而不是属性。

但是现在我试图避免使用实例变量，因为我认为如果我使用 proeprties 就没有必要和冗余，而且我之前读过最好使用属性而不是实例变量，但我不确定。那堂课现在看起来像这样

```
@interface MyClass : NSObject

@property (nonatomic, readwrite, strong) Var *aVar;

@end

@interface MyClass()

@property (nonatomic, readwrite, strong) Var *anotherVar;

@end

@implementation MyClass

@synthesize aVar = aVar_;
@synthesize anotherVar = anotherVar_;

@end 
```

在这种情况下，我仍然使用实例变量（下划线）来管理我的数据，因为它不那么冗长，而且 ARC 考虑了所有内存问题，但我不知道这是否正确。

另外我还有一个问题。`aVar`第一段代码中的属性是只读的，但如果我只使用属性，我必须将该属性设为可读写。如果我想将公共属性设为只读，我是否必须在@interface 中声明公共只读属性并在私有@interface 中声明私有读写？

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:45:35.330

你的问题的答案有些复杂，但通常你有它的摇摆。

由于 ARC 为您完成所有内存管理，因此通常更简单地使用 ivar（类私有，在实现中声明）来满足您的内部需求。在这种情况下，所有用法都只使用名称。

使用属性，您可以从 Xcode 4.4 开始让 Xcode 合成 setter 和 getter 以及 ivar。自动合成的 ivars 使用前导“_”字符创建。

您可以在实现中将属性定义为只读，将其保留为只读，然后在代码中将其设置为“_foo = ....”。[这个网站上的许多人会认为这是一种不好的做法，我的观点是你可以做到。]

Xcode 4.4 有一个标题为“隐式合成属性”的警告，默认值为 NO。如果您没有为每个属性提供 @synthesize 语句，这会产生一个警告，即使它无论如何都会进行综合。

就个人而言，我尽可能使用 ivars，并且仅在需要将某些内容对其他类公开，或者我在多个文件中声明了类别时才定义属性（在这种情况下，我将类扩展的接口声明放在它自己的文件中以及其中定义的属性。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:45:28.710

如果您声明一个属性，您的实现通常应该使用该属性，即使 ARC 减少了一些内存管理错误。

`init`有些人更喜欢避免使用属性，因为这样做可能会触发仅部分初始化的对象 () 上的KVO `self`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:37:55.497

使用新的 Objective-C 更新，您甚至不需要综合属性。您需要做的就是声明`@property (strong, nonatomic) Var *aVar;`，编译器将自动添加合成，`self.aVar`用`_aVar`实例变量支持属性。

# php - 如何每 10.6 秒从时间戳增加 +1

> ID：12373257
> 
> 赞同：1
> 
> 时间：2012-09-11T15:33:56.117
> 
> 标签：php, javascript, time, increment

我正在为狗救援组织配置站点。我试图创建一个安乐死计数器，以直观地显示美国每天有多少只狗被安乐死。使用当前时间的实时“死亡计数器”，它仍然为访问者不停地逐页计数。

我希望计数器在每天午夜从 0 开始。然后，我希望计数器每 10.6 秒增加 +1。

我想出的充其量只是一个hack，而且似乎不准确。

我的 EMBARRASSING 代码如下，我知道数学是错误的，但是我的理解力有限。此外，我对 strtotime 缺乏了解可能会添加不必要的行。

```
 <?php
    $tsdate = date('d-m-Y');
    $date = date('m/d/Y');
    $timestamp = strtotime($tsdate);
    ?>
    <b><font color="#ff0000">
<span id="number"><?=(int)((time()-$timestamp)/14.6);?></span>
</font> dogs have been put to death in this country TODAY <?php echo $date ?>.<br />
Don't buy - Don't breed - ADOPT! </b>

    <script type="text/javascript">
        var i = <?=(int)((time()-$timestamp)/14.6);?>;
        function increment() {
            i++;
            document.getElementById('number').innerHTML = i;
        }
        setInterval('increment()', 10600);
    </script> 
```

代码功能，但是，您可以看到我需要帮助，而且我一无所知。我不得不使用上面看到的 14.6 来获得接近但不正确的结果。

我还想显示这一年的总和。

有人能帮我吗？

非常感谢您的帮助，但我无法让它发挥作用。这是我所拥有的：

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title> count up test </title>

<script type='text/javascript'>
var div = document.getElementById('count');
var yeardiv = document.getElementById('yearcount');

function updateCount() {
    var d = new Date();
    // set d to midnight
    d.setHours(0,0,0,0);
    var count = Math.floor( ( new Date().getTime() - d.getTime() ) / 10600 );
    div.innerHTML = count;

    // set d to Jan 1st
    d.setMonth( 0 );
    d.setDate( 1 );
    count = Math.floor( ( new Date().getTime() - d.getTime() ) / 10600 )
    yeardiv.innerHTML = count;
}

updateCount();
setInterval( updateCount, 10600 );

</script>

</head>
<body>
Today: <div id="count"></div><br/>
This Year: <div id="yearcount"></div>

</body>

</html> 
```

上面没有显示计数，只是文本......

**谢谢你下面的作品！**

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title> count up test THANKS to agreco </title>
</head>
<body>

Today: <div id="count"></div><br/>
This Year: <div id="yearcount"></div>

<script type='text/javascript'>
var div = document.getElementById('count');
var yeardiv = document.getElementById('yearcount');

function updateCount() {
    var d = new Date();
    // set d to midnight
    d.setHours(0,0,0,0);
    var count = Math.floor( ( new Date().getTime() - d.getTime() ) / 10600 );
    div.innerHTML = count;

    // set d to Jan 1st
    d.setMonth( 0 );
    d.setDate( 1 );
    count = Math.floor( ( new Date().getTime() - d.getTime() ) / 10600 )
    yeardiv.innerHTML = count;
}

updateCount();
setInterval( updateCount, 10600 );
</script>
</body>
</html> 
```

我真的要感谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:46:20.273

最好用 javascript 来做这一切。正如另一条评论所说，它还将包括用户时区，其中 php 将基于服务器时间。

这里也是一年的更新代码：

```
var div = document.getElementById('count');
var yeardiv = document.getElementById('yearcount');

function updateCount() {
    var d = new Date();
    // set d to midnight
    d.setHours(0,0,0,0);
    var count = Math.floor( ( new Date().getTime() - d.getTime() ) / 10600 );
    div.innerHTML = count;

    // set d to Jan 1st
    d.setMonth( 0 );
    d.setDate( 1 );
    count = Math.floor( ( new Date().getTime() - d.getTime() ) / 10600 )
    yeardiv.innerHTML = count;
}

updateCount();
setInterval( updateCount, 10600 ); 
```

看到这个[小提琴](http://jsfiddle.net/cx6rC/1/)

而不是递增，我只是根据*现在*-*午夜计算了计数*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:45:38.003

我会跳过 PHP，只用 JavaScript 来做。使用 JavaScript Date 对象，然后使用小时分钟和秒计算自午夜以来的秒数。您的增量计时器似乎很好。另外，使用 JavaScript 将使用查看器的时区（JavaScript 在浏览器上运行）而不是服务器的时区（PHP 在服务器上运行）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T16:01:55.803

我认为你正在努力从 PHP 中获取午夜的秒数，你可以这样做：

```
<?php 
$ar = explode(':',date('G:i:s'));
$ar[0] *= 3600;
$ar[1] *= 60;
$seconds_from_midnight = $ar[0] + $ar[1] + $ar[2];
$dogs_killed_from_midnight = floor($seconds_from_midnight / 10.6);
?> 
```

然后只需替换以下代码：

```
<?=(int)((time()-$timestamp)/14.6);?> 
```

为了这：

```
<?=$dogs_killed_from_midnight;?> 
```

那应该在您的代码中完成这项工作。

# php - $_GET 可以定位在 url 中的任何位置吗？

> ID：12373263
> 
> 赞同：0
> 
> 时间：2012-09-11T15:34:24.137
> 
> 标签：php, url

我已经有一个看起来像这样的 URL，
`/admin/add_to_list/' .$payer. '/' .$tid. '?credit=1`

知道我的网址中已经有一个`$_GET`，我想在我的网址上添加另一件事。我的新网址是否可能看起来像这样，

```
/admin/add_to_list/' .$payer. '/' .$tid. '?credit=1/silentmode 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:37:20.513

您的示例将导致获取与第一个相同的 URL，但现在`$_GET['credit']`将等于`"1/silentmode"`而不是`"1"`.

路径元素必须始终位于查询字符串之前，而查询字符串本身必须始终位于片段之前。这只是 URL 的语法 - 毕竟，您不会期望`example.com.www//http:`工作，对吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:37:29.740

使用与号 (&) 具有多个 $_GET 值。例子：

```
index.php?name=joe&surname=smith 
```

然后，您可以像这样单独检索它们：

```
$name = $_GET['name'];
$surname = $_GET['surname']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:37:08.143

不。第一个之后`?`直到第一个`#`（如果有）的任何内容都是查询字符串。

您需要解构您的 URL 并将额外的路径元素放在查询字符串之前。

# facebook - Facebook 应用程序 - 发布新闻 - 当有新内容可用时，我希望能够在人们的墙上发帖

> ID：12373269
> 
> 赞同：1
> 
> 时间：2012-09-11T15:34:38.877
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我已经构建了一个 facebook 应用程序，它运行良好。

但由于某种原因，我找不到或无法理解我将如何提醒用户新交易正在我的应用程序中等待他们。

我正在使用画布。

我想做的就是在我有新内容（更新我的数据库）时提醒用户。我已经可以通过 sdk 发布到用户墙了。但我想把它发送给所有用户

请有任何想法。

# javascript - 覆盖 CSS：使用 jquery 显示无属性

> ID：12373272
> 
> 赞同：0
> 
> 时间：2012-09-11T15:34:51.067
> 
> 标签：javascript, jquery, html, css, settimeout

对于在 css 中定义为 display:none 的元素，我正在尝试运行一个函数，该函数尝试使用 .show() 显示该元素，代码如下：

**CSS**

```
.element {
  position: absolute;
  display: none;
  left: 0;
  top: 0;
} 
```

**HTML**

```
<div class="element">Some content here</div>
<div class="element">Some content here</div> 
```

**jQuery**

```
var c = $('.element');

c.each(function () {
  c.css({
    'left': dleft + 'px'
  });

  c.css({
    'top': dtop + 'px'
  });

  c.setTimeout(function () {
    c.show(1000);
  }, sduration); 
```

所有变量都被填充我已经通过警告所有变量进行检查并给它们默认值，但不知何故在超时后元素没有显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:39:00.887

`setTimeout`是一个全局函数。

```
var c = $('.element');

c.each(function () {
  c.css({ 'left': dleft + 'px', 'top': dtop + 'px' });

  setTimeout(function () {
    c.show(1000);
  }, sduration);
}); 
```

演示：http: [//jsfiddle.net/S7nw3/](http://jsfiddle.net/S7nw3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:42:27.940

您编写的代码似乎存在两个问题。你还没有关闭 .each() 循环.. setTimeout 也是一个全局函数.. .. 检查这个

```
 var dleft = 40;
var dtop = 40;
var sduration = 1000;
var c = $('.element');

c.each(function() {
    c.css({
        'left': dleft + 'px',
        'top': dtop + 'px'
    });
});
setTimeout(function() {
    c.show(1000);
}, sduration);​ 
```

检查这个[小提琴](http://jsfiddle.net/sushanth009/MHvjA/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:55:07.727

如果你需要延迟元素的显示，你也可以使用 jQuery[`.delay()`](http://api.jquery.com/delay/)函数。

```
c.each(function() {
    c.css({
        'left': dleft + 'px',
        'top': dtop + 'px'
    });
});

c.delay(1000).show(); 
```

# hbase - Hbase Cell 版本的使用

> ID：12373275
> 
> 赞同：3
> 
> 时间：2012-09-11T15:34:56.303
> 
> 标签：hbase

有个问题困扰了我很久，对Hbase cell的版本一头雾水，我知道如何设置版本和获取版本等API操作，但不知道为什么会有版本概念，以及如何使用版本。有什么好的例子可以帮助我理解单元版本的目的吗？提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-06T12:55:53.440

版本可用于为列存储多个但固定数量的值。假设您要存储用户最近 10 次登录的时间戳。您可以有一个名为“loginTime”的列，并在定义表时将最大版本设置为 10。现在，您需要做的就是每次用户登录时更新“loginTime”列的值，HBase 不会覆盖该列的先前值，而是将先前的值向下推到版本列表并存储最新值在上面。它将在内部存储对此列的最近 10 次更新，并删除较旧的条目。想象一下在 RDBMS 中做这样的事情，你最终会明确地删除旧条目。

您可以使用“获取”方法检索任意多个版本。

另一个可能的用例是，假设您正在构建一个版本控制系统之类的东西，比如说一个 Wiki 页面。您可以将旧版本的页面存储为“pagecontent”列中的版本。

# java - Cloudera Manager 4.0 字数统计示例

> ID：12373277
> 
> 赞同：0
> 
> 时间：2012-09-11T15:34:58.787
> 
> 标签：java, hadoop, cloudera, word-count

我安装了 Cloudera Manager 并有 2 个节点连接到一个主节点。我正在尝试使用 cloudera 在此链接上提供的教程运行 wordcount 程序： [https ://ccp.cloudera.com/display/SUPPORT/Hadoop+Tutorial#HadoopTutorial-InputsandOutputs](https://ccp.cloudera.com/display/SUPPORT/Hadoop+Tutorial#HadoopTutorial-InputsandOutputs)

Cloudera 说要编译我在命令提示符下使用 nano 创建的 WordCount.java 文件。我创建了 Wordcount_Classes 目录并将 wordcount.java 文件放在那里。我不知道该目录是否应该移动到 cloudera 目录之一中的某个位置以使 java 代码工作？或者，如果我做错了什么。我安装了 Cloudera Manager，它已经在所有节点上自动安装了 ClouderaHadoop。我在我的终端上得到这个：

```
mark@*****:~/wordcount_classes$ javac WordCount.java
WordCount.java:6: package org.apache.hadoop.fs does not exist
import org.apache.hadoop.fs.Path;
                           ^
WordCount.java:7: package org.apache.hadoop.conf does not exist
import org.apache.hadoop.conf.*;
^
WordCount.java:8: package org.apache.hadoop.io does not exist
import org.apache.hadoop.io.*;
^
WordCount.java:9: package org.apache.hadoop.mapred does not exist
import org.apache.hadoop.mapred.*;
^
WordCount.java:10: package org.apache.hadoop.util does not exist
import org.apache.hadoop.util.*;
^
WordCount.java:14: cannot find symbol
symbol  : class MapReduceBase
location: class org.myorg.WordCount
  public static class Map extends MapReduceBase implements Mapper<LongWritable, Text, Text, IntWritable> {
                                  ^
WordCount.java:14: cannot find symbol
symbol  : class Mapper
location: class org.myorg.WordCount
  public static class Map extends MapReduceBase implements Mapper<LongWritable, Text, Text, IntWritable> {
                                                           ^
WordCount.java:14: cannot find symbol
symbol  : class LongWritable
location: class org.myorg.WordCount
  public static class Map extends MapReduceBase implements Mapper<LongWritable, Text, Text, IntWritable> {
                                                                  ^
WordCount.java:14: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount
  public static class Map extends MapReduceBase implements Mapper<LongWritable, Text, Text, IntWritable> {
                                                                                ^
WordCount.java:14: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount
  public static class Map extends MapReduceBase implements Mapper<LongWritable, Text, Text, IntWritable> {
                                                                                      ^
WordCount.java:14: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount
  public static class Map extends MapReduceBase implements Mapper<LongWritable, Text, Text, IntWritable> {
                                                                                            ^
WordCount.java:14: interface expected here
  public static class Map extends MapReduceBase implements Mapper<LongWritable, Text, Text, IntWritable> {
                                                                 ^
WordCount.java:15: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount.Map
    private final static IntWritable one = new IntWritable(1);
                         ^
WordCount.java:16: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount.Map
    private Text word = new Text();
            ^
WordCount.java:18: cannot find symbol
symbol  : class LongWritable
location: class org.myorg.WordCount.Map
    public void map(LongWritable key, Text value, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                    ^
WordCount.java:18: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount.Map
    public void map(LongWritable key, Text value, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                      ^
WordCount.java:18: cannot find symbol
symbol  : class OutputCollector
location: class org.myorg.WordCount.Map
    public void map(LongWritable key, Text value, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                                  ^
WordCount.java:18: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount.Map
    public void map(LongWritable key, Text value, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                                                  ^
WordCount.java:18: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount.Map
    public void map(LongWritable key, Text value, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                                                        ^
WordCount.java:18: cannot find symbol
symbol  : class Reporter
location: class org.myorg.WordCount.Map
    public void map(LongWritable key, Text value, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                                                                             ^
WordCount.java:28: cannot find symbol
symbol  : class MapReduceBase
location: class org.myorg.WordCount
  public static class Reduce extends MapReduceBase implements Reducer<Text, IntWritable, Text, IntWritable> {
                                     ^
WordCount.java:28: cannot find symbol
symbol  : class Reducer
location: class org.myorg.WordCount
  public static class Reduce extends MapReduceBase implements Reducer<Text, IntWritable, Text, IntWritable> {
                                                              ^
WordCount.java:28: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount
  public static class Reduce extends MapReduceBase implements Reducer<Text, IntWritable, Text, IntWritable> {
                                                                      ^
WordCount.java:28: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount
  public static class Reduce extends MapReduceBase implements Reducer<Text, IntWritable, Text, IntWritable> {
                                                                            ^
WordCount.java:28: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount
  public static class Reduce extends MapReduceBase implements Reducer<Text, IntWritable, Text, IntWritable> {
                                                                                         ^
WordCount.java:28: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount
  public static class Reduce extends MapReduceBase implements Reducer<Text, IntWritable, Text, IntWritable> {
                                                                                               ^
WordCount.java:28: interface expected here
  public static class Reduce extends MapReduceBase implements Reducer<Text, IntWritable, Text, IntWritable> {
                                                                     ^
WordCount.java:29: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount.Reduce
    public void reduce(Text key, Iterator<IntWritable> values, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                       ^
WordCount.java:29: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount.Reduce
    public void reduce(Text key, Iterator<IntWritable> values, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                          ^
WordCount.java:29: cannot find symbol
symbol  : class OutputCollector
location: class org.myorg.WordCount.Reduce
    public void reduce(Text key, Iterator<IntWritable> values, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                                               ^
WordCount.java:29: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount.Reduce
    public void reduce(Text key, Iterator<IntWritable> values, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                                                               ^
WordCount.java:29: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount.Reduce
    public void reduce(Text key, Iterator<IntWritable> values, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                                                                     ^
WordCount.java:29: cannot find symbol
symbol  : class Reporter
location: class org.myorg.WordCount.Reduce
    public void reduce(Text key, Iterator<IntWritable> values, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
                                                                                                          ^
WordCount.java:15: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount.Map
    private final static IntWritable one = new IntWritable(1);
                                               ^
WordCount.java:16: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount.Map
    private Text word = new Text();
                            ^
WordCount.java:32: operator + cannot be applied to int,IntWritable.get
        sum += values.next().get();
            ^
WordCount.java:32: inconvertible types
found   : <nulltype>
required: int
        sum += values.next().get();
                                ^
WordCount.java:34: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount.Reduce
      output.collect(key, new IntWritable(sum));
                              ^
WordCount.java:39: cannot find symbol
symbol  : class JobConf
location: class org.myorg.WordCount
    JobConf conf = new JobConf(WordCount.class);
    ^
WordCount.java:39: cannot find symbol
symbol  : class JobConf
location: class org.myorg.WordCount
    JobConf conf = new JobConf(WordCount.class);
                       ^
WordCount.java:42: cannot find symbol
symbol  : class Text
location: class org.myorg.WordCount
    conf.setOutputKeyClass(Text.class);
                           ^
WordCount.java:43: cannot find symbol
symbol  : class IntWritable
location: class org.myorg.WordCount
    conf.setOutputValueClass(IntWritable.class);
                             ^
WordCount.java:49: cannot find symbol
symbol  : class TextInputFormat
location: class org.myorg.WordCount
    conf.setInputFormat(TextInputFormat.class);
                        ^
WordCount.java:50: cannot find symbol
symbol  : class TextOutputFormat
location: class org.myorg.WordCount
    conf.setOutputFormat(TextOutputFormat.class);
                         ^
WordCount.java:52: cannot find symbol
symbol  : class Path
location: class org.myorg.WordCount
    FileInputFormat.setInputPaths(conf, new Path(args[0]));
                                            ^
WordCount.java:52: cannot find symbol
symbol  : variable FileInputFormat
location: class org.myorg.WordCount
    FileInputFormat.setInputPaths(conf, new Path(args[0]));
    ^
WordCount.java:53: cannot find symbol
symbol  : class Path
location: class org.myorg.WordCount
    FileOutputFormat.setOutputPath(conf, new Path(args[1]));
                                             ^
WordCount.java:53: cannot find symbol
symbol  : variable FileOutputFormat
location: class org.myorg.WordCount
    FileOutputFormat.setOutputPath(conf, new Path(args[1]));
    ^
WordCount.java:55: cannot find symbol
symbol  : variable JobClient
location: class org.myorg.WordCount
    JobClient.runJob(conf);
    ^
49 errors 
```

有人可以帮我运行 wordcount 程序或指导我应该做什么，或者如果有人知道我找不到的在线教程吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T08:01:35.873

您需要您的类路径上的依赖项（对应于您的导入语句）`javac`。

`hadoop classpath`使用 Hadoop，通过实用程序更容易做到这一点：

```
$ javac -classpath `hadoop classpath`:. WordCount.java 
```

`cannot find symbol`正确设置类路径后，您不应该遇到任何此类编译问题。

# ajax - 取消的 AJAX 请求会减慢后续导航

> ID：12373278
> 
> 赞同：5
> 
> 时间：2012-09-11T15:35:07.190
> 
> 标签：ajax, jquery

在我的应用程序中，当用户请求报告时`.load()`，会对执行大量数字运算和 mySQL 请求的文件进行 jquery AJAX（使用）调用。它通常需要 5-6 秒来加载，`.ajaxStart()`并`.ajaxStop()`用于在加载过程中显示加载 gif。

问题：

如果用户单击“生成报告”按钮，然后改变主意并尝试导航到另一个页面，应用程序将挂起，并且在 5-6 秒内没有导航到新页面。我可以从尝试导航到新页面时立即触发的加载 gif 的删除中看出`.ajaxStop()`，但似乎 ajax 请求在浏览器加载下一页之前完成。

这是正常行为吗？关于如何修复/重组它的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T18:39:23.250

我相信 .ajaxStop() 只有在 beforeSend 回调返回 false 时才会取消 ajax 请求。在这种情况下，呼叫尚未启动，服务器尚未收到请求。一旦请求被发送到服务器，页面将不再控制请求，直到它返回。.ajaxStop() 请求在离开页面时触发，因为最后一次 ajax 调用（如果有的话）成功完成并因此终止执行。

> 如果通过在 beforeSend 回调函数中返回 false 来取消最后一个未完成的 Ajax 请求，也会触发 ajaxStop 事件。

以上是[.ajaxStop()](http://api.jquery.com/ajaxStop/)命令的 jquery api 网站的摘录。看起来，一旦进行了调用并发送了请求，您的服务器正在完成调用，即使用户正在导航到不同的页面。如果它是一个大电话，它可能会导致您遇到的延迟。

希望这可以帮助。

# macos - 在 Mac App 的工具栏下方显示格式栏

> ID：12373283
> 
> 赞同：2
> 
> 时间：2012-09-11T15:35:21.720
> 
> 标签：macos, cocoa, toolbar

曾经是 iOS 开发者，第一次是 Mac 开发者。我正在尝试将格式栏添加到 Mac OS X 应用程序。与页面相同。带有按钮，位于工具栏下方，并且能够显示和隐藏。

![在此处输入图像描述](../Images/b6182a78b7ecbfb58fcaddff8a2759b2.png)

我开始创建自定义视图并将其添加为 MainMenu.xib > Window > View 的子视图，但我没有运气。

我在 AppDelegate 中为视图创建了一个出口，但我不太确定从这里去哪里。我可以显示和隐藏这个视图，但是调整下面所有视图和内容的大小会发生什么？在 Pages 中，它是一个非常动态的布局。

*   这个视图应该存在于 MasterVC 中，而不是 AppDelegate 中吗？
*   CustomView 甚至是正确的容器吗？它似乎与iOS完全不同。我什至无法为其设置背景颜色。

![在此处输入图像描述](../Images/a71a2790070a3f691168a85c350782fa.png)

我很感激有关如何进行的建议。我不得不假设这是一个非常常见的实现。我可能遗漏了一些明显的东西，这使它变得比需要的更难。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T02:16:33.163

我会使用 NSBox，而不是自定义视图作为您的起点——如果您将框类型设置为自定义，那么您可以设置填充颜色以及边框类型和颜色。至于调整所有视图的大小，您应该能够使用 IB 中的支柱和弹簧来做到这一点。而且，是的，这个视图应该在 MasterVC（或其他一些控制器对象）中，而不是在您的应用程序委托中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T15:23:05.323

似乎有一个名为[inspectorBar](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/nstextview_Class/Reference/Reference.html#//apple_ref/doc/uid/20000373-SW105)的 Apple 控件。可以在界面生成器中为 NSTextView 启用它，或者使用：

```
setUsesInspectorBar 
```

不幸的是，它似乎确实有[很多限制](https://stackoverflow.com/questions/11785350/positioning-inspector-bar-for-nstextview)。据我所知：

*   无法使用公共 API 显示/隐藏
*   无法自定义显示的按钮
*   仅适用于 NSTextView。拒绝 NSTextField

因此，虽然inspectorBar 直接解决了我最初的广泛问题，即显示在Pages 中看到的格式化工具，但我可能仍会接受rdelmar 的建议。

# android - AVD 分辨率与预期不同

> ID：12373286
> 
> 赞同：0
> 
> 时间：2012-09-11T15:35:32.510
> 
> 标签：android, canvas, resolution, avd

我有一些 AVD 表示分辨率（480x854）和（480x800）略有不同。当我使用方法来获取 Canvas 的大小 (getWidth()/getHeight()) 时，它们会正确报告它相应地为 480x854。

问题是，如果我运行图像下方的代码，则图像不在屏幕上：

```
SweepGradient sweepGrad = new SweepGradient(350, 350, 
new int[] { Color.RED, Color.YELLOW, Color.GREEN, Color.BLUE, Color.MAGENTA }, null);
circlePaint.setShader(sweepGrad);
canvas.drawCircle(350, 350, 50, circlePaint); 
```

最后一行中的 350、350、50 值表示：x 坐标、y 坐标和圆的半径。还发现半径为 50 的圆完全可见的最大“x”值为 270（这意味着画布 x 尺寸以某种方式为 320）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:47:25.037

恐怕我问错了问题。我在具有相同分辨率的真实设备上测试了该应用程序，但它也是错误的。

为此添加了一行：

```
<supports-screens android:anyDensity="true"/> 
```

在你的`AndroidManifest.xml`.

最后的问题是。为什么需要这条线？在我的情况下，画布中的 1 个像素似乎等于真实设备的 1.5 个像素。另外我认为这不是问题的正确解决方案，因为添加指定的行会产生巨大的后果（如果我的应用程序并不真正支持任何密度并且我仍然希望将一些图像放在精确的坐标处怎么办？）。

**这是答案：http:** [//developer.android.com/guide/practices/screens_support.html#DensityConsiderations](http://developer.android.com/guide/practices/screens_support.html#DensityConsiderations)

# jvm - 在 Solaris 上运行 Cassandra 1.1.3 时 JVM 崩溃。

> ID：12373292
> 
> 赞同：2
> 
> 时间：2012-09-11T15:35:43.557
> 
> 标签：jvm, cassandra, coredump

这是核心转储。当我们运行 2 节点 cassandra 集群时发生。当环中只有 1 个节点时工作正常。这是 Cassandra 1.1.3，我们之前在生产环境中运行 1.0.7，它工作得很好。关于可能导致这种情况的任何想法？

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGBUS (0xa) at pc=0xffffffff7e174780, pid=18537, tid=276
#
# JRE version: 6.0_27-b07
# Java VM: Java HotSpot(TM) 64-Bit Server VM (20.2-b06 mixed mode solaris-sparc compressed oops)
# Problematic frame:
# V  [libjvm.so+0x974780]  Unsafe_GetLong+0x120
#
# If you would like to submit a bug report, please visit:
#   http://java.sun.com/webapps/bugreport/crash.jsp
#

---------------  T H R E A D  ---------------

Current thread (0x000000010450f000):  JavaThread "Thrift:3" daemon [_thread_in_vm, id=276, stack(0xffffffff66000000,0xffffffff66100000)]

siginfo:si_signo=SIGBUS: si_errno=0, si_code=1 (BUS_ADRALN), si_addr=0xfffffffe719cc082

Registers:
 G1=0xffffffff7e484788 G2=0xffffffff7e484790 G3=0x000000000007a788 G4=0x000000000007a790
 G5=0x000000000007a400 G6=0xfffffffe6000e000 G7=0xffffffff74d0c200 Y=0x0000000000000000
 O0=0x0000000000000000 O1=0x0000000000000000 O2=0x0000000000080350 O3=0x0000000000080000
 O4=0x0000000000000000 O5=0x0000000030000000 O6=0xffffffff660fc9b1 O7=0xfffffffe719cc070
 L0=0x0000000103b8f720 L1=0xffffffff7e4847a0 L2=0x0000000000000000 L3=0x0000000000000006
 L4=0x0000000010450f00 L5=0x0000000000001ffc L6=0xffffffff660ff860 L7=0xffffffff7e48a350
 I0=0x0000000000000000 I1=0x000000010450f000 I2=0x0000000104551180 I3=0x0000000000000012
 I4=0xffffffff7bd00000 I5=0xffffffff7e40a000 I6=0xffffffff660fca61 I7=0xffffffff77c0e1f4
 PC=0xffffffff7e174780 nPC=0xffffffff7e174784

Top of Stack: (sp=0xffffffff660fd1b0)
0xffffffff660fd1b0:   0000000103b8f720 ffffffff7e4847a0
0xffffffff660fd1c0:   0000000000000000 0000000000000006
0xffffffff660fd1d0:   0000000010450f00 0000000000001ffc
0xffffffff660fd1e0:   ffffffff660ff860 ffffffff7e48a350
0xffffffff660fd1f0:   0000000000000000 000000010450f000
0xffffffff660fd200:   0000000104551180 0000000000000012
0xffffffff660fd210:   ffffffff7bd00000 ffffffff7e40a000
0xffffffff660fd220:   ffffffff660fca61 ffffffff77c0e1f4
0xffffffff660fd230:   0000000104551200 000000010450f000
0xffffffff660fd240:   0000000104551248 0000000104551208
0xffffffff660fd250:   ffffffff77c04f90 00000002719cbed8
0xffffffff660fd260:   ffffffff660fd408 0000000000000000
0xffffffff660fd270:   ffffffff600d7c70 ffffffff660fd518
0xffffffff660fd280:   ffffffff660fd410 ffffffff77c0af6c
0xffffffff660fd290:   ffffffff660fd410 000000010450f000
0xffffffff660fd2a0:   00000000000005f9 ffffffff660fd518 

Instructions: (pc=0xffffffff7e174780)
0xffffffff7e174760:   9e 10 20 00 f4 5d a0 10 10 80 00 05 e0 5d a0 08
0xffffffff7e174770:   de 5e a0 00 e0 5d a0 08 f4 5d a0 10 e4 5e a0 00
0xffffffff7e174780:   f0 5b c0 1b 02 c4 80 05 aa 10 20 07 7f e0 ca 99
0xffffffff7e174790:   90 10 00 1a f4 5d a0 10 f4 74 20 08 f8 5d a0 18 

Register to memory mapping:

G1=0xffffffff7e484788: __1cHnmethodG__vtbl_+0x1aa8 in /opt/app/t3atl1m5/tibco/tibcojre64/1.6.0_27/lib/sparcv9/server/libjvm.so at 0xffffffff7d800000
G2=0xffffffff7e484790: __1cHnmethodG__vtbl_+0x1ab0 in /opt/app/t3atl1m5/tibco/tibcojre64/1.6.0_27/lib/sparcv9/server/libjvm.so at 0xffffffff7d800000
G3=0x000000000007a788 is an unknown value
G4=0x000000000007a790 is an unknown value
G5=0x000000000007a400 is an unknown value
G6=0xfffffffe6000e000 is an unknown value
G7=0xffffffff74d0c200 is an unknown value

O0=0x0000000000000000 is an unknown value
O1=0x0000000000000000 is an unknown value
O2=0x0000000000080350 is an unknown value
O3=0x0000000000080000 is an unknown value
O4=0x0000000000000000 is an unknown value
O5=0x0000000030000000 is an unknown value
O6=0xffffffff660fc9b1 is pointing into the stack for thread: 0x000000010450f000
O7= 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-05-17T12:59:00.163

我知道它是一个旧问题，但我在 5.10 Generic_15xxx sun4u sparc SUNW,Sun-Fire-V240 上遇到了类似的 jdk 1.8.0 问题。

在这种情况下，我使用了 cassandra-all 2.0.3 依赖项来尝试 lz4 比较这个问题在[CASSANDRA-6628](https://issues.apache.org/jira/browse/CASSANDRA-6628)中讨论。阅读您需要使用 cassandra-all 较新的 2.0.5 和 lz4 1.3.0 的详细信息（覆盖 cassandra-all 2.0.5 女巫提供的仍然是 1.2.0）。请参阅[lz4 问题](https://github.com/lz4/lz4-java/issues/66)和[拉取请求](https://github.com/lz4/lz4-java/pull/33)。

使用以下 Maven 依赖项对我有用。

```
<dependency>
    <groupId>org.apache.cassandra</groupId>
    <artifactId>cassandra-all</artifactId>
    <version>2.0.16</version>
</dependency>
<dependency>
    <groupId>net.jpountz.lz4</groupId>
    <artifactId>lz4</artifactId>
    <version>1.3.0</version>
</dependency> 
```

我的崩溃日志

```
 #
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGBUS (0xa) at pc=0xffffffff7dd6f740, pid=15886, tid=0x000000000000000e
#
# JRE version: Java(TM) SE Runtime Environment (8.0_121-b13) (build 1.8.0_121-b13)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.121-b13 mixed mode solaris-sparc compressed oops)
# Problematic frame:
# V  [libjvm.so+0xd6f740]  Unsafe_GetInt+0x174
#
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
#
# An error report file with more information is saved as:
# /*****/hs_err_pid15886.log
Compiled method (nm)   44848 1811     n 0       sun.misc.Unsafe::getInt (native)
 total in heap  [0xffffffff6bff6190,0xffffffff6bff6570] = 992
 relocation     [0xffffffff6bff62b8,0xffffffff6bff62d8] = 32
 main code      [0xffffffff6bff62e0,0xffffffff6bff6568] = 648
 metadata       [0xffffffff6bff6568,0xffffffff6bff6570] = 8
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.java.com/bugreport/crash.jsp
# 
```

# c# - 如何使公共属性线程安全？

> ID：12373300
> 
> 赞同：2
> 
> 时间：2012-09-11T15:36:15.523
> 
> 标签：c#, .net, multithreading, thread-safety

`BackgroundWorker`由于某种原因，我正在实施替换，我必须实施以下公共属性：

```
public bool CancellationPending { get; private set; }
public bool IsBusy { get; private set; }
public bool WorkerReportsProgress { get; set; }
public bool WorkerSupportsCancellation { get; set; } 
```

我相信你知道它们的用途是什么`BackgroundWorker`。因此它们可能会被不同的线程访问/修改。我担心如何“保护”它们以进行多线程处理。我认为声明它们`volatile`就足够了，但`volatile`不能应用于自动属性。

我该怎么办？我应该为这些属性创建私有字段并声明它们`volatile`吗？或者我应该在每个和块中使用`lock`ing吗？`get``set`

我认为这应该是非常常见的场景 - 使属性（最好是自动属性）线程安全。请注意，此示例中的所有属性都是原子类型。

**编辑：**

为了澄清我需要什么：我需要确保所有线程始终读取属性的最新值。看到这个：[https ://stackoverflow.com/a/10797326/1081467](https://stackoverflow.com/a/10797326/1081467)

再说一遍，您是否建议使用`volatile`、 或`lock`ing 或其他任何东西？.. 当使用`bool`属性原子性得到保证时，只剩下第二个问题（读取最新值），那么您如何正确解决这个问题? 当你有非原始类型的属性时怎么办？你`lock`在每个`get`和`set`块中都放了 s 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T08:23:25.817

我想出了以下实现。请评论您是否认为这是最佳解决方案：

```
//========== Public properties ==================================================//

public bool CancellationPending { get { return _cancellationPending; } private set { _cancellationPending = value; } }

public bool IsBusy { get { return _isBusy; } private set { _isBusy = value; } }

public bool WorkerReportsProgress { get { return _workerReportsProgress; } set { _workerReportsProgress = value; } }

public bool WorkerSupportsCancellation { get { return _workerSupportsCancellation; } set { _workerSupportsCancellation = value; } }

//========== Private fields ==================================================//

private volatile bool _cancellationPending;
private volatile bool _isBusy;
private volatile bool _workerReportsProgress;
private volatile bool _workerSupportsCancellation; 
```

推理：原子性是由字段是 type 的事实确保的`bool`，因此不需要`lock`ing。制作它们`volatile`将确保任何线程都将读取当前值-未缓存-以防另一个线程对其进行了修改。我认为这是`volatile`关键字的确切用途（也是唯一有效的用途），对吧？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T15:50:06.373

```
public bool CancellationPending { get; private set; }
public bool IsBusy { get; private set; }
public bool WorkerReportsProgress { get; set; }
public bool WorkerSupportsCancellation { get; set; } 
```

> 因此它们可能会被不同的线程访问/修改

不，这仅适用于`CancellationPending`and `IsBusy`，不适用于其他人。
它们都是布尔值，保证是原子的。原子性在这里就足够了。

原始 Backgroundworker 的所有属性都被记录为**不是**线程安全的。[请参阅本页](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)
底部附近。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T15:58:27.703

尽管我认为那里有更好的选择，例如将 Tasks 与 svick 提到的另一个调度程序一起使用。

如果您想继续走这条路，您绝对应该使用锁定字段而不是 volatile 字段，因为[volatile 不会按照您的想法](http://www.bluebytesoftware.com/blog/2010/12/04/SayonaraVolatile.aspx)进行。 [哦，这家伙说了一些关于永远不要制造不稳定领域的事情......](http://blogs.msdn.com/b/ericlippert/archive/2011/06/16/atomicity-volatility-and-immutability-are-different-part-three.aspx)

您可以根据访问特性使用您最喜欢的同步原语（lock、Mutex、Interlocked、ReaderWriterLockSlim 等）代替 volatile。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T15:53:49.890

一种简单的方法是为您希望线程安全的每个属性设置互斥对象。在获取和设置属性中，使用 Monitor.Enter(declaredObjectMutext) 和 Monitor.Exit(declaredObjectMutex)。一旦完成，这将使您的属性线程安全（所有对 get 和 set 的调用都将阻塞调用，直到任何其他线程完成）。

另一种选择是使用互锁类，它允许对整数和布尔值进行线程安全修改。如果这就是您使用属性的全部内容，那么它是一个简单的解决方案。

# java - utf-8 转换并不总是有效

> ID：12373302
> 
> 赞同：0
> 
> 时间：2012-09-11T15:36:21.410
> 
> 标签：java, utf-8, screen-scraping

我之前搜索过其他堆栈以在这里输入，但没有找到类似的东西。我必须抓取包含类似文本的不同 utf-8 网页

“Oggi è una bellissima giornata”

问题出在字符“è”上

我使用 jtidy 和 xpath 查询表达式提取此文本并将其转换为

```
byte[] content = filteredEncodedString.getBytes("utf-8");
String result = new String(content,"utf-8"); 
```

其中filteredEncodedString 包含文本“Oggièuna bellissima giornata”。此过程适用于迄今为止分析的大多数网页，但在某些情况下它不会提取 utf-8 字符串。页面编码总是与文本相似。

**9月14日编辑**

我修改了我的代码，以获取 utf-8 编码的页面：

```
URL url = new URL(currentUrl);
        URLConnection conn = url.openConnection();
        conn.setRequestProperty("User-Agent", "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-GB; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 (.NET CLR 3.5.30729)");
        BufferedReader in = new BufferedReader(new InputStreamReader(conn.getInputStream(), getEncode()));

        String line="";
        String domString="";
        while((line = in.readLine()) != null) {
            domString+=line.toString();
        }

        byte[] bytes = domString.getBytes("UTF-8");
        in.close();

        return bytes;
        //return text.getBytes(); 
```

其中**getEncode()**返回页面编码，在这种情况下为 utf-8。但我仍然注意到 ì 或 é 没有正确读取。这段代码有问题吗？再次感谢！

**10月2日编辑**

这段代码似乎有效。问题出在我没有发布的 Dom 文档创建中（对此感到抱歉！），其中字节从上面的方法返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:54:39.233

事后您不能将字符串“转换”为 utf-8。如果字节被错误地转换为字符，那么您已经丢失了数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T17:45:40.847

您可以尝试将页面作为字节数组而不是字符串，然后使用[StringUtils](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/StringUtils.html "字符串实用程序")将其转换为 utf-8 字符串。

# linux - ps：只获取父进程的干净方法？

> ID：12373309
> 
> 赞同：10
> 
> 时间：2012-09-11T15:36:53.150
> 
> 标签：linux, bash, shell, command-line, ps

我用`ps ef`了`ps rf`很多。

这是一个示例输出`ps rf`：

```
 PID TTY      STAT   TIME COMMAND
 3476 pts/0    S      0:00 su ...
 3477 pts/0    S      0:02  \_ bash
 8062 pts/0    T      1:16      \_ emacs -nw ...
15733 pts/0    R+     0:00      \_ ps xf
15237 ?        S      0:00 uwsgi ...
15293 ?        S      0:00  \_ uwsgi ...
15294 ?        S      0:00  \_ uwsgi ... 
```

而今天我只需要在脚本中检索 uwsgi 的**主进程**（所以我只想要 15237 而不是 15293 或 15294）。

截至今天，我尝试了一些`ps rf | grep -v ' \\_ '`......但我想要一种**更清洁的方式**。

我还从 unix.com 的论坛中发现了另一个解决方案：

```
ps xf | sed '1d' | while read pid tty stat time command ; do [ -n "$(echo $command | egrep '^uwsgi')" ] && echo $pid ; done 
```

但仍然有**很多管道**和**丑陋的伎俩**。

真的没有`ps`选择或更清洁的技巧（可能使用**awk**）来实现吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-11T15:48:34.827

在与@netcoder 讨论了他的答案评论后，他使用了一个不错的技巧：D
使用`f`on`ps`将始终让父母处于领先地位，这很棒。

这应该只是工作：

```
$ ps hf -opid -C <process> | awk '{ print $1; exit }' 
```

正如我在评论中提到的，这将`pid`只返回一个进程。

* * *

我会去：

```
ps rf -opid,cmd -C <process-name> | awk '$2 !~ /^[|\\]/ { print $1 }' 
```

那是：

*   列出正在运行的进程`r`（或者`e`如果你想要一切）
*   连同父/子图`f`
*   只输出 pid 和命令名`-opid,cmd`
*   仅适用于给定的过程`-C <process>`

进而

*   如果第二个字段 - 即命令 ( `-opid,cmd`) - 不以 a 开头，`\`或者`|`它是父进程，则打印第一个字段 - 即 pid。

* * *

简单测试：

```
$ ps f -opid,cmd -Cchromium
  PID CMD
 2800 /usr/lib/chromium/chromium --type=zygote --enable-seccomp-sandbox
 2803  \_ /usr/lib/chromium/chromium --type=zygote --enable-seccomp-sandbox
 2899      \_ /usr/lib/chromium/chromium --type=renderer --enable-seccomp-sandbox --lang=en-US --force-fieldtrials=ConnCountImpact/conn_count_6/ConnnectB
 2906      |   \_ /usr/lib/chromium/chromium --type=renderer --enable-seccomp-sandbox --lang=en-US --force-fieldtrials=ConnCountImpact/conn_count_6/Connn
 [  ... snip ... ]
 2861      \_ /usr/lib/chromium/chromium --type=renderer --enable-seccomp-sandbox --lang=en-US --force-fieldtrials=ConnCountImpact/conn_count_6/ConnnectB
 2863          \_ /usr/lib/chromium/chromium --type=renderer --enable-seccomp-sandbox --lang=en-US --force-fieldtrials=ConnCountImpact/conn_count_6/Connn
 2794 /usr/lib/chromium/chromium --enable-seccomp-sandbox --memory-model=low --purge-memory-button --disk-cache-dir=/tmp/chromium
 2796  \_ /usr/lib/chromium/chromium --enable-seccomp-sandbox --memory-model=low --purge-memory-button --disk-cache-dir=/tmp/chromium
 3918  \_ /usr/lib/chromium/chromium --type=gpu-process --channel=2794.45.1891443837 --gpu-vendor-id=0x10de --gpu-device-id=0x0611 --gpu-driver-version -
25308  \_ [chromium] <defunct>
31932  \_ /usr/lib/chromium/chromium --type=plugin --plugin-path=/usr/lib/mozilla/plugins/libflashplayer.so --lang=en-US --channel=2794.1330.1990362572

$ ps f -opid,cmd -Cchromium | awk '$2 !~ /^[|\\]/ { print $1 }'
PID
2800
2794

$ # also supressing the header of ps (top line 'PID') -- add 'h' to ps
$ ps hf -opid,cmd -Cchromium | awk '$2 !~ /^[|\\]/ { print $1 }'
2800
2794 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-05-31T15:00:06.840

```
/usr/bin/pgrep -o <process_name> 
```

*其中“-o”是匹配过程中最早（最近开始的）*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-04T10:12:04.453

另一个解决方案（从[这里](http://pub.mouraf.org/blog/2010/09/bash-how-to-find-the-parent-process-name/)）：

```
ps -ocommand= -p $PPID | awk -F/ '{print $NF}' | awk '{print $1}' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T17:45:46.987

为什么不使用 --pidfile 选项简单地将 master 的 pid 保存在一个文件 (pidfile) 中？如果这不是一个可行的解决方案，您可以使用 --procname-master 为主进程提供自定义名称。

将 ps 用于此类事情是非常不可靠的（到处都是竞争条件，以及使解析规则无效的特殊情况......）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-15T11:45:16.670

这是获取进程的主进程 ID 的另一种解决方案。高，但很好。

```
pstree -p 1 |grep <proc_name>|sed -n 1p|tr -d "|,-"|sed 's/(/ /g'|sed 's/)/ /g'|tr -d "+"|awk {'print $2'}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-15T22:13:07.060

如果您可以安全地假设您只有一个具有 n 个子进程的父进程，或者您只关心几个父进程中的“最早的”（最低 PID），那么我认为这个更简单的解决方案就可以了。

```
ps h -opid -C<commandname> | head -1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-02T15:03:20.110

按文件名（输出父母的数量）：

```
o=""; for p in $(pgrep -f example.sh); do o="${o}$(pstree -lp | grep -nF \($p\))\n"; done; echo -e "$o" | cut -f2 -d: | cut -f2 -d- | sort -n | grep -vE ^$ | uniq -c | awk '$1>0' | wc -l 
```

**编辑：**我以前用过

```
| cut -f1 -d: | 
```

但显然不能保证子进程会一个接一个地跟随，所以我最终用父进程的名称和 pid 来计算父进程：

```
| cut -f2 -d: | cut -f2 -d- | 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-09-11T06:29:05.783

从关键词KEYWORD

```
ps aux | grep -i KEYWORD | grep -v grep | awk '{print $2}'|sort -h|head -1|xargs kill 
```

BTW，这个假设父进程ID是最小ID有效吗？？？？

# facebook-fql - Facebook 查询语言在页面上获得超过 20 次点赞和分享的评论

> ID：12373313
> 
> 赞同：0
> 
> 时间：2012-09-11T15:37:01.043
> 
> 标签：facebook-fql

我想从一个拥有超过 20 个赞和 20 个分享的页面中获取评论。我如何使用 FQL 做到这一点

还有任何 FQL 查询可以搜索用户的评论文本，例如

例如有一个帖子

买什么手机？

有一些评论，例如 1) “买苹果” 2) “买三星”

我想写一个查询，比如......

从喜欢 > 20 的页面中选择评论

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:26:59.280

是的。这将获取“Facebook”页面上所有超过 20 个赞的帖子，按赞数降序排列：

```
SELECT post_id, source_id, actor_id, message, comments, likes FROM stream 
  WHERE source_id = 20531316728 AND likes.count > 20 ORDER BY likes.count DESC 
```

当然，这取决于[流](https://developers.facebook.com/docs/reference/fql/stream/)FQL 表的正常限制。

要在评论中搜索，您需要使用从上面的查询中获得的查询`comments`表`post_id`。就像是：

```
SELECT post_id, from_id, time, text FROM comment WHERE post_id = XXXXX 
  AND strpos(text, "buy Apple") >= 0 
```

`strpos`功能非常有限。您最好将所有注释拉入您的脚本并使用更强大的文本处理功能来查找您感兴趣的字符串。

# android - 选择哪一个：Android Service 或 Intent Service 或 Async Task to Sync Files

> ID：12373314
> 
> 赞同：1
> 
> 时间：2012-09-11T15:37:03.290
> 
> 标签：android, android-asynctask, android-service, sync

我希望在原生 android 应用程序中根据用户需求从服务器同步或下载多个文件。我还需要更新有关正在进行的同步状态的 UI。因此，在这种情况下，应该使用以下哪个 android 组件。

*   服务
*   意向服务
*   异步任务

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:40:15.453

用于`AsyncTask`完成后台工作和更新 `onProgressUpdate()`任务中实现的 UI 元素。有关详细信息，请参阅[文档](http://developer.android.com/reference/android/os/AsyncTask.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:38:55.673

使用`AsyncTask`，它是专门为完全按照您的要求而构建的。那是

*   后台工作
*   在工作期间通知 UI。

所有三个选项都将起作用，但`AsyncTask`将是最简单和最适合的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:43:30.310

我认为使用帮助服务或 AsyncTask 下载您需要的文件，并使用帮助广播接收器更新 UI。

# python - 如何使用 Python 'unittest' 模块构建我的测试？

> ID：12373316
> 
> 赞同：4
> 
> 时间：2012-09-11T15:37:06.963
> 
> 标签：python, unit-testing, selenium

我正在尝试为 Selenium 和[unittest](https://docs.python.org/3/library/unittest.html)中的自动化 Web 测试构建一个测试框架，并且我想将我的测试构建成不同的脚本。

因此，我将其组织如下：

文件**base.py** - 现在将包含用于设置会话的基本 Selenium 测试用例类。

```
import unittest
from selenium import webdriver

# Base Selenium Test class from which all test cases inherit.
class BaseSeleniumTest(unittest.TestCase):
    def setUp(self):
        self.browser = webdriver.Firefox()
    def tearDown(self):
        self.browser.close() 
```

文件**main.py** - 我希望这是运行所有单个测试的整体测试套件。

```
import unittest
import test_example

if __name__ == "__main__":
    SeTestSuite = test_example.TitleSpelling()
    unittest.TextTestRunner(verbosity=2).run(SeTestSuite) 
```

文件**test_example.py** - 一个示例测试用例。让它们自己运行可能会很好。

```
from base import BaseSeleniumTest

# Test the spelling of the title
class TitleSpelling(BaseSeleniumTest):
    def test_a(self):
        self.assertTrue(False)

    def test_b(self):
        self.assertTrue(True) 
```

问题是当我运行*main.py*时，出现以下错误：

```
Traceback (most recent call last):
  File "H:\Python\testframework\main.py", line 5, in <module>
    SeTestSuite = test_example.TitleSpelling()
  File "C:\Python27\lib\unittest\case.py", line 191, in __init__
    (self.__class__, methodName))
ValueError: no such test method in <class 'test_example.TitleSpelling'>: runTest 
```

我怀疑这是由于`unittest`运行方式非常特殊，我一定错过了文档希望我如何构建测试的技巧。任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T17:33:32.983

我不是 100% 确定，但在 中`main.py`，您可能需要：

```
SeTestSuite = unittest.defaultTestLoader.discover(start_dir='.') 
```

跑步者线应该是（也许）：

```
# If your line didn't work
unittest.TextTestRunner(verbosity=2).run(unittest.TestSuite(SeTestSuite)) 
```

# android-layout - android ImageView 缩放以适应另一个视图

> ID：12373318
> 
> 赞同：4
> 
> 时间：2012-09-11T15:37:08.880
> 
> 标签：android-layout, scaling, android-imageview

我有一个包含 TextView 和 ImageView 的相对布局：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"/>
    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:adjustViewBounds="true"/>
</RelativeLayout> 
```

它看起来如下：

![在此处输入图像描述](../Images/803a053e1821d079ebedacfb34069071.png)

我想要实现的是：

![在此处输入图像描述](../Images/72522c4baf86871325447816eb35a75f.png)

这意味着我希望我的 ImageView 按高度缩放以适应 TextView。可以在 xml 中完成，而不需要 java 编码吗？如果我能写出类似的东西

```
android:layout_height="match_that_TextView" 
```

它会解决这个问题，但我猜这是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:39:53.977

在 RelativeLayout 中固定高度

# jquery - 点击时，代码执行了不止一次

> ID：12373324
> 
> 赞同：1
> 
> 时间：2012-09-11T15:37:34.443
> 
> 标签：jquery, html, click

为了让用户可以用阿拉伯语书写，我编写了以下代码 html：

```
<div id="clavier" style="display: none;" title="Clavier arabe">
   <table>
   <tr><td>
  <button value="ر" class="charachter">ر</button>
  <button value="ز" class="charachter">ز</button>
  <button value="ذ" class="charachter">ذ</button>
 <button value="د" class="charachter">د</button>
   <button value="خ" class="charachter">خ</button>
   <button value="ح" class="charachter">ح</button>
   <button value="ج" class="charachter">ج</button>
  <button value="ث" class="charachter">ث</button>
  <button value="ت" class="charachter">ت</button>
  <button value="ب" class="charachter">ب</button>
  <button value="ا" class="charachter">ا</button>
    <button value="mm" class="delete" style="width: 80px;">sup</button> </td></tr>
    <tr><td>
     <button value="ل" class="charachter" style="margin-left: 20px;">ل</button>
   <button value="ك" class="charachter">ك</button>
  <button value="ق" class="charachter" >ق</button>
 <button value="ف" class="charachter">ف</button>
   <button value="غ" class="charachter" >غ</button>
       <button value="ع" class="charachter">ع</button>
          <button value="ظ" class="charachter">ظ</button>
            <button value="ط" class="charachter">ط</button>
          <button value="ض" class="charachter">ض</button>
            <button value="ص" class="charachter">ص</button>
            <button value="ش" class="charachter">ش</button>
            <button value="س" class="charachter">س</button> 

             </td></tr>

  <tr><td>

    <button value="ى" class="charachter" style="margin-left: 40px;">ى</button>
   <button value="ئ" class="charachter">ئ</button>
   <button value="ؤ" class="charachter">ؤ</button>
   <button value="ء" class="charachter"  >ء</button>
   <button value="ة" class="charachter">ة</button>
   <button value="ي" class="charachter">ي</button>
   <button value="و" class="charachter">و</button>
   <button value="ه" class="charachter">ه</button>
   <button value="ن" class="charachter">ن</button>
   <button value="م" class="charachter">م</button>
   <button value="" class="clear">clear</button>

  </td></tr>

   <tr><td>
   <button value="" class="espace" style="height: 25px;width: 220px;margin-left: 60px;">espace</button>
   <button value="إ" class="charachter" >إ</button>
   <button value="أ" class="charachter">أ</button>
   <button value="آ" class="charachter">آ</button>
   <button value="ٱ" class="charachter">ٱ</button>

   </td></tr>
    </table>
    </div> 
```

jQuery：

```
$(".arab").live("click", function() {
    arabInput = $(this);
    $("#clavier").dialog({
        width: '43%'
    });
    $(".charachter").live("click", function() {
        alert($(this).val());
        var string = arabInput.val();
        alert(string + $(this).val());
        arabInput.val(string + $(this).val());
    });
    $(".delete").live("click", function() {
        var string = arabInput.val();
        arabInput.val(string.slice(0, -1));
    });
    $(".espace").live("click", function() {
        var string = arabInput.val();
        arabInput.val(string + " ");
    });
    $(".clear").live("click", function() {
        var string = arabInput.val();
        arabInput.val("");
    });
});​ 
```

问题是第一个输入工作正常，但是 onclick 到第二个输入我执行了两次代码，第三个输入写了两次相同的字符，它的树乘以任何想法，为什么我会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:48:17.713

它发生的次数是您单击它的次数，因为您每次单击时都在重新注册事件处理程序。您需要在添加新事件处理程序之前取消绑定事件处理程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T15:49:55.843

正如 J Torres 所说，这段代码第一次运行良好。但是，如果您再次单击输入，它会向按钮添加新事件。

您可以像这个小提琴一样简单地将事件移动到 $(".arab").click() 方法之外，或者像[这个](http://jsfiddle.net/HBYhg/7/)[小提琴](http://jsfiddle.net/HBYhg/2/)一样删除点击时的侦听器。

```
$(".arab").click(function(){
  arabInput = $(this);
  $("#clavier").show();

});

$(".charachter").click(function()
  { alert($(this).val());
  var string = arabInput.val();
  alert(string+$(this).val());
  arabInput.val(string+$(this).val());
});

$(".delete").click(function()
  { var string = arabInput.val();
  arabInput.val(string.slice(0, -1));
});

$(".espace").click(function()
  { var string = arabInput.val();
  arabInput.val(string+" ");
});

$(".clear").click(function()
  { var string = arabInput.val();
  arabInput.val("");
}); 
```

或者

```
$(".arab").live("click", function() {
    arabInput = $(this);
    $("#clavier").show();
    $(".charachter").unbind('click').on("click", function() {
        alert($(this).val());
        var string = arabInput.val();
        alert(string + $(this).val());
        arabInput.val(string + $(this).val());
    });
    $(".delete").unbind('click').on("click", function() {
        var string = arabInput.val();
        arabInput.val(string.slice(0, -1));
    });
    $(".espace").unbind('click').on("click", function() {
        var string = arabInput.val();
        arabInput.val(string + " ");
    });
    $(".clear").unbind('click').on("click", function() {
        var string = arabInput.val();
        arabInput.val("");
    });
}); 
```

# ios - 阅读 CGFontCache.plist 会被 AppStore 拒绝吗？

> ID：12373325
> 
> 赞同：1
> 
> 时间：2012-09-11T15:37:37.597
> 
> 标签：ios, fonts, appstore-approval, freetype

我的老板想要一个更小的包装尺寸。我们拥有的最大资源是大约 5MB 的后备字体（用于 CJK 字符）。目前我已经设法从手机中读取了后备字体。这是一个 OpenGL 应用程序，我们使用 FreeType 进行字体渲染，所以这就是我不使用 UIFont 的原因。我有有效的代码，但我想知道读取**/System/Library/Fonts/CGFontCache.plist**是否是被 AppStore 拒绝的理由：

```
void AddSystemFontToCache(const char* fontName, const int& fontStyle)
{
    NSString *nsFontName = [NSString stringWithCString:fontName encoding:NSASCIIStringEncoding];
    NSDictionary *nsFontsDict = [NSDictionary dictionaryWithContentsOfFile:@"/System/Library/Fonts/CGFontCache.plist"];
    NSDictionary *nsTraitsDict = [nsFontsDict valueForKey:@"TraitMappings"];
    NSDictionary *nsMappingDict = [nsTraitsDict valueForKey:nsFontName];
    NSDictionary *nsFaceNamesDict = [nsFontsDict valueForKey:@"Names"];
    NSString* nsFacePath = [nsFaceNamesDict valueForKey:[nsMappingDict valueForKey:nsFontStyle]];
    // This function uses FT_New_Face to read the font
    AddFontToCache(fontName, [nsFacePath cStringUsingEncoding:NSASCIIStringEncoding]);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:07:23.757

我在网上看到了很多关于人们在他们的应用程序中使用这个文件的帖子，但没有听到苹果拒绝它的消息。如果您使用私有 API 访问该文件，Apple 将拒绝，但由于您可以访问该文件并且只是从没有私有 API 的文件系统中读取它，我认为不会有问题。但是，根据经验，审核者可以自行决定是否拒绝应用程序。每个审稿人都不一样。如果它被拒绝，您可以随时将其发送给审查委员会。

这么简短的回答，不，我不觉得苹果会拒绝你的应用程序使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T17:39:03.870

[https://developer.apple.com/appstore/resources/approval/guidelines.html](https://developer.apple.com/appstore/resources/approval/guidelines.html)

**2.6** *应用程序在其指定容器区域之外读取或写入数据将被拒绝*

# asp.net - 在后面的代码中动态设置 ASP.NET 自动完成扩展器 contextKey

> ID：12373327
> 
> 赞同：0
> 
> 时间：2012-09-11T15:37:41.877
> 
> 标签：asp.net, autocomplete

我想在我的页面中使用 ASP.NET 自动完成功能。我使用我的内部对象来加载数据，并且应该使用作为实例页面字段值的参数来查询自动完成。因为我不能在静态自动完成扩展器方法中使用实例字段，所以我找到了一个[代码示例](http://mscoder.wordpress.com/2010/03/14/dynamically-set-the-autocompleteextender-contextkey/)，可以用来实现我的目标。

我在 asp.net 页面中有文本框和自动完成扩展器：

```
<asp:TextBox ID="PurchaseOrderItemsSearchTextBox" runat="server" EnableViewState="False"
                            SkinID="SalesReturnTextBox" AutoCompleteType="Disabled" 
                            AutoPostBack="True" OnTextChanged="PurchaseOrderItemsSearchTextBoxTextChanged" 
                            onload="PurchaseOrderItemsSearchTextBoxLoad" />
<ajax:AutoCompleteExtender runat="server" TargetControlID="PurchaseOrderItemsSearchTextBox" ID="OrderOrStockNumberExtender"
                            ServiceMethod="GetOrderOrStockNumbers" MinimumPrefixLength="2" CompletionInterval="1000" UseContextKey="True"/> 
```

在 PurchaseOrderItemsSearchTextBoxLoad 方法中，我想根据上面提到的示例通过 javascript 动态设置上下文键。

```
protected void PurchaseOrderItemsSearchTextBoxLoad(object sender, EventArgs e)
    {
        var textBox = sender as TextBox;
        if (textBox!=null)
        {                
            string sapCode = Customer.Company.SapCode;
            const string PURCHASE_ORGANIZATION = PURCHASE_ORGANIZATION_HP;
            string purchaseGroup = string.Empty;
            string firstDateTime = FirstDateTextBox.Text;
            const string SEPARATOR = "#";
            var contextStrings = new[]{sapCode,PURCHASE_ORGANIZATION,purchaseGroup,firstDateTime};
            string context =string.Join(SEPARATOR, contextStrings);
            const string ON_KEY_UP = "onkeyup";
            string attributevalue = "$find('" + OrderOrStockNumberExtender.ClientID + "').set_contextKey(" + context +
                                    ");";
            textBox.Attributes.Add(ON_KEY_UP, attributevalue);
        }
    } 
```

但是当我运行我的页面并在应该返回字符串数组的静态 Web 方法中设置断点时，我发现 contextKey 为空。

```
[WebMethod]
[ScriptMethod]
public static string[] GetOrderOrStockNumbers(string prefixText,int count, string contextKey)
{            
    string[] returnStrings = new string[] {"1","2"};
    return returnStrings;
} 
```

非常感谢您提供任何有用的答案，

鲁道夫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-11-13T02:33:14.653

这些都不起作用，然后我发现您可以在页面加载下的代码中设置上下文键

```
ExtenderID.ContextKey = Control.SelectedValue; 
```

它有效...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:46:31.133

我找到了解决方案。由属性值设置的 ContextKey 在 ASP.NET 中不起作用，因为我在本文中发现 .Net 4.0 在属性值中转义撇[号](http://forums.asp.net/t/1554455.aspx/)。

一种解决方案是在 Web 配置中禁用编码属性值，但这可能会产生安全问题。

```
<httpRuntime encoderType="HtmlAttributeEncodingNot"/> 
```

我宁愿改变我的方法并且没有按属性设置 contextKey 值，而是在文本框控件的预渲染事件中注册客户端脚本。

```
protected void PurchaseOrderItemsSearchTextBoxPreRender(object sender, EventArgs e)
    {
        var textBox = sender as TextBox;
        if (textBox != null)
        {
            string sapCode = Customer.Company.SapCode;
            const string PURCHASE_ORGANIZATION = PURCHASE_ORGANIZATION_HP;
            string purchaseGroup = string.Empty;
            string firstDateTime = FirstDateTextBox.Text;
            var contextStrings = new[] {sapCode, PURCHASE_ORGANIZATION, purchaseGroup, firstDateTime};
            string context = string.Join(SEPARATOR, contextStrings);
            const string ON_KEY_UP = "onkeyup";
            const string ON_KEY_UP_VALUE = "SetOrderOrStockExtenderContextKey();";
            textBox.Attributes.Add(ON_KEY_UP, ON_KEY_UP_VALUE);

            //disable autocomplete in firefox
            DisableAutocompleteInFirefox(textBox);

            const string ORDER_OR_STOCK_NUMBER_SCRIPT_KEY = "OrderOrStockNumberScript";
            if (!ClientScript.IsClientScriptBlockRegistered(ORDER_OR_STOCK_NUMBER_SCRIPT_KEY))
            {
                Type type = GetType();
                var scriptTextBuilder = new StringBuilder();
                const string FUNCTION_NAME = "function SetOrderOrStockExtenderContextKey()";
                scriptTextBuilder.AppendLine(FUNCTION_NAME);
                const string LEFT_BRACKET = "{";
                scriptTextBuilder.AppendLine(LEFT_BRACKET);
                const string FIND_COMMAND = "$find(\'";
                scriptTextBuilder.Append(FIND_COMMAND);
                scriptTextBuilder.Append(OrderOrStockNumberExtender.ClientID);
                const string SET_COTEXT_KEY = "\').set_contextKey('";
                scriptTextBuilder.Append(SET_COTEXT_KEY);
                scriptTextBuilder.Append(context);
                const string END_OF_COMMAND = "');";
                scriptTextBuilder.AppendLine(END_OF_COMMAND);
                const string RIGHT_BRACKET = "}";
                scriptTextBuilder.AppendLine(RIGHT_BRACKET);

                string setContextKeyFunction = scriptTextBuilder.ToString();

                ClientScript.RegisterClientScriptBlock(type, ORDER_OR_STOCK_NUMBER_SCRIPT_KEY, setContextKeyFunction,
                                                       true);
            }
        }
    } 
```

现在 contextKey 由 Javascript 正确设置，我可以在 GetOrderOrStockNumbers 方法中使用它的值。

# php - 如何让 PHP SOAP 客户端与通过 SSL 运行且证书无效的服务进行通信

> ID：12373328
> 
> 赞同：4
> 
> 时间：2012-09-11T15:37:44.060
> 
> 标签：php, soap, ssl

我正在尝试使用 PHP SOAP 客户端使用 SOAP 服务，但它失败并显示以下消息：

```
SoapFault: SOAP-ERROR: Parsing WSDL: Couldn't load from 'https://domain.com/webservice.asmx?wsdl' : failed to load external entity "https://domain.com/webservice.asmx?wsdl"\n in /Users/andrewdchancox/Projects/test/testsoap.php on line 10 
```

我已经下载了 wsdl 文件并从本地 apache 实例中提供了它，它加载时没有任何问题。我唯一能想到的可能是 Web 服务正在使用自签名证书通过 SSL 运行 - 当我 wget wsdl 时，我收到以下错误：

```
--2012-09-11 16:28:39--
https://domain.com/webservice.asmx?wsdl
Resolving domain.com (domain.com)... 11.111.111.11
Connecting to domain.com (domain.com)|11.111.111.11|:443... connected.
ERROR: The certificate of ‘domain.com’ is not trusted.
ERROR: The certificate of ‘domain.com’ hasn't got a known issuer. 
```

我已经搜索并彻底阅读了 PHP SOAP 客户端的 PHP 文档 - [http://php.net/manual/en/class.soapclient.php](http://php.net/manual/en/class.soapclient.php)和它的构造函数 - [http://www.php.net/manual/ en/soapclient.soapclient.php](http://www.php.net/manual/en/soapclient.soapclient.php)并没有找到任何帮助。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-12-10T16:22:25.543

这是两年前的事了，但我认为它值得回答。

PHP 中的 SoapClient 类使用 PHP 流通过 HTTP 进行通信。由于各种原因，SSL over PHP 流是不安全的^([1](http://phpsecurity.readthedocs.org/en/latest/Transport-Layer-Security-(HTTPS-SSL-and-TLS).html#php-streams))，但在这种情况下，您的问题是它太安全了。

解决方案的第一步是`stream_context`在构建 SoapClient ^([2](http://php.net/manual/en/soapclient.soapclient.php))时使用该选项。这将允许您指定更高级的 SSL 设置^([3](http://php.net/manual/en/context.ssl.php))：

```
// Taken from note 1 below.
$contextOptions = array(
    'ssl' => array(
        'verify_peer'   => true,
        'cafile'        => '/etc/ssl/certs/ca-certificates.crt',
        'verify_depth'  => 5,
        'CN_match'      => 'api.twitter.com',
        'disable_compression' => true,
        'SNI_enabled'         => true,
        'ciphers'             => 'ALL!EXPORT!EXPORT40!EXPORT56!aNULL!LOW!RC4'
    )
);
$sslContext = stream_context_create($contextOptions);
// Then use this context when creating your SoapClient.
$soap = new SoapClient('https://domain.com/webservice.asmx?wsdl', array('stream_context' => $sslContext)); 
```

您的问题的理想解决方案是创建您自己的 CA 证书，使用它来签署 SSL 证书，然后将您的 CA 证书添加到`cafile`. 更好的办法可能是*只*在 中拥有该证书`cafile`，以避免某些流氓 CA 为您的域签署其他人的证书，但这并不总是可行的。

如果您正在做的事情不需要安全（例如在测试期间），您还可以在流上下文中使用 SSL 设置来降低连接的安全性。该选项`allow_self_signed`将允许自签名证书：

```
$contextOptions = array(
    'ssl' => array(
        'allow_self_signed' => true,
    )
);
$sslContext = stream_context_create($contextOptions);
$soap = new SoapClient('https://domain.com/webservice.asmx?wsdl', array('stream_context' => $sslContext)); 
```

链接：

1.  [生存深渊：PHP 安全 - 传输层安全（HTTPS、SSL 和 TLS） - PHP 流](http://phpsecurity.readthedocs.org/en/latest/Transport-Layer-Security-(HTTPS-SSL-and-TLS).html#php-streams)
2.  [PHP: SoapClient::SoapClient](http://php.net/manual/en/soapclient.soapclient.php)
3.  [PHP：SSL 上下文选项](http://php.net/manual/en/context.ssl.php)

# ruby-on-rails - 声明式授权：只允许更新某些字段

> ID：12373330
> 
> 赞同：1
> 
> 时间：2012-09-11T15:37:52.233
> 
> 标签：ruby-on-rails, ruby, declarative-authorization

我正在使用声明式授权来管理应用程序中的用户权限。
我有一个帖子模型，它的所有者可以管理它。

```
has_permission_on :post, :to => :manage do
  if_attribute :creator_id => is{user.id}
end 
```

但是，我的模型中也有以下内容：

```
class Post < ActiveRecord::Base
  def publish!
    update_attributes(:published, true)
  end
end 
```

我想允许一些不是帖子创建者的用户发布它。
我不能只允许他们更新对象，他们不应该能够更改发布状态以外的其他字段。

不过，似乎没有办法只允许编辑模型中的某些字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T11:42:01.713

我已经通过使用模型授权和控制器授权解决了这个问题。
我允许所有创建者和管理员编辑帖子。
然后，在控制器中，我指定只有帖子创建者可以访问更新操作，并且只有管理员可以访问发布操作。

# javascript - 使用 jquery 突出显示相似的文本

> ID：12373338
> 
> 赞同：1
> 
> 时间：2012-09-11T15:38:39.113
> 
> 标签：javascript, jquery

我有大型文本容器，我想使用 jquery 比较和突出显示它们。这里回答的问题[用 jquery 突出显示一个单词](https://stackoverflow.com/questions/119441/highlight-a-word-with-jquery)是完美的，除了它包含重复的文本。这是一个例子

```
<div id="source">Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</div>
<div id="similar1">Lorem ipsum dolor</div>
<div id="similar2">consectetuer adipiscing elit</div> 
```

现在我想将similar1 和similar2 与源div 匹配。上述链接中的解决方案建议使用以下代码：

```
 $("#similar1").highlight("Lorem ipsum dolor sit amet, consectetuer adipiscing elit.");
 $("#similar2").highlight("Lorem ipsum dolor sit amet, consectetuer adipiscing elit."); 
```

如您所见，我每次都必须重复源文本。是否可以直接从源 div 获取内容？IE

```
 $("#similar1").highlight($('#source').val()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:39:49.923

`.val()`应仅用于输入字段，例如文本字段、下拉列表等

您应该使用`.text()`or`.html()`来获取元素的内容，例如`div/span/e.t.c`

试试下面，

```
$("#similar1").highlight($('#source').text()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T15:40:04.837

使用类和文本（）：

```
<div id="similar1" class="similar">Lorem ipsum dolor</div>
<div id="similar2" class="similar">consectetuer adipiscing elit</div>

$(".similar").highlight($('#source').text()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:41:51.497

您可以一次选择多个元素。

`$("#similar1, #similar2").highlight("Lorem ipsum dolor sit amet, consectetuer adipiscing elit.");`

您还可以使用[`.text()`](http://api.jquery.com/text/)来获取 div 的文本内容。

`$("#similar1, #similar2").highlight($("#source").text());`

# c++ - std::locale::global 会影响 printf() 函数吗？

> ID：12373341
> 
> 赞同：8
> 
> 时间：2012-09-11T15:39:00.203
> 
> 标签：c++, locale, printf, std, setlocale

我在我的电脑上使用俄语区域设置。
如果我要设置：

```
class numpunct_withpoint: public numpunct<char>
{
protected:
    /// Override the function that gives the decimal separator.
    char do_decimal_point() const
    {
        return '.';
    }
};
...
locale loc(std::locale::classic(), new numpunct_withpoint);
std::locale::global(loc); 
```

然后

```
printf("%f", 3.14); 
```

输出是：

```
3,14 
```

小数分隔符是“，”，不像 do_decimal_point 函数！如何使用 C++ 语言环境更改小数分隔符的 C 语言环境设置？

* * *

感谢您的回答！
但是，C setlocale 函数会对 C++ cout 对象产生影响吗？

```
setlocale(LC_NUMERIC, "C"); 
```

通过 cout 打印十进制值时这会影响吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T16:28:52.327

当您设置全局 C++ 语言环境时，C 语言环境也会被修改。如果您修改 C 语言环境，*则不会*修改全局 C++ 语言环境。

下面演示如何设置 C++ 全局语言环境。

```
#include <cstdio>
#include <clocale>
#include <fstream>

int main() {
    const char * locale_name = "French_France.1252"; // or "fr_Fr.UTF-8" on Unix
    double value = 1.2;

    std::locale::global(std::locale(locale_name));

    std::ofstream("out.txt") << "C++ " << value << '\n';

    if (FILE *f = std::fopen("out.txt", "a")) {
        std::fprintf(f, "C %1.1e\n", value);
        std::fclose(f);
    }
} 
```

C 和 C++ 输出都应使用逗号小数点。

> C++ 1,2
> C 1,2e+000

如果将设置 C++ 语言环境替换为设置 C 语言环境`std::setlocale(LC_ALL, locale_name);`，则输出应更改，以便只有 C 输出使用逗号十进制，而 C++ 输出仍使用默认句点十进制符号。

> C++ 1.2
> C 1,2e+000

但是，设置 C++ 语言环境会影响 C 语言环境这一事实并不能使 C 语言环境以 C++ 语言环境的方式可扩展。基于 C 语言环境的函数永远不会使用自定义 C++ 方面。相反，您必须依靠您的系统来支持某些具有您需要的功能的命名语言环境。

具体来说，`std::locale::global()`定义为使用您选择的 C++ 语言环境的名称来设置 C 语言环境（如果它有名称）。如果 C++ 语言环境没有名称，则行为由实现定义。此外，C++ 指定组合两个命名语言环境会产生一个命名语言环境。一些实现产生有用的组合名称，允许您通过设置 C++ 语言环境来混合 C 语言环境类别：

```
std::locale::global(std::locale(std::locale("ru_RU"), "C", std::locale::numeric)); 
```

使用 libstdc++，这会产生一个名为：

> LC_CTYPE=ru_RU;LC_NUMERIC=C;LC_TIME=ru_RU;LC_COLLATE=ru_RU;LC_MONETARY=ru_RU;LC_MESSAGES=ru_RU;LC_PAPER=ru_RU;LC_NAME=ru_RU;LC_ADDRESS=ru_RU;LC_TELEPHONE=ru_RU;LC_MEASUREMENT=ru_RU;LC_IDENTIFICATION=ru_RU LC_CTYPE=ru_RU ;LC_NUMERIC=C;LC_TIME=ru_RU;LC_COLLATE=ru_RU;LC_MONETARY=ru_RU;LC_MESSAGES=ru_RU;LC_PAPER=ru_RU;LC_NAME=ru_RU;LC_ADDRESS=ru_RU;LC_TELEPHONE=ru_RU;LC_MEASUREMENT=ru_RU;LC_IDENTIFICATION=ru_RU

因此，C 语言环境设置为与 C++ 语言环境相同的“ru_RU”和“C”语言环境之间的混合。

不幸的是，其他实现选择了不太有用的行为，但在技术上仍然是一致的。在 Visual Studio 中

```
std::locale::global(std::locale(std::locale("Russian_Russia.1251"), "C", std::locale::numeric)); 
```

生成名称为“C”的语言环境。因此，虽然 C++ 语言环境是俄语和 C 语言环境类别的适当混合，但 C 语言环境只是设置为“C”。所以在这些平台上混合 C 语言环境类别你必须直接设置 C 语言环境：

```
// set the C++ locale first
std::locale::global(std::locale(std::locale("Russian_Russia.1251"), "C", std::locale::numeric));

// set the C locale second, because it will not overwrite the changes you made to the C++ locale
std::setlocale(LC_ALL, "Russian_Russia.1251");
std::setlocale(LC_NUMERIC, "C"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:42:04.530

C 库不使用与 C++ 相同的语言环境设置。要覆盖 使用的语言环境`printf`，请使用[setlocale](http://pubs.opengroup.org/onlinepubs/009604499/functions/setlocale.html)：

```
setlocale(LC_NUMERIC, "POSIX"); 
```

或类似的。

# symfony - 主页前的欢迎页面

> ID：12373343
> 
> 赞同：0
> 
> 时间：2012-09-11T15:39:05.050
> 
> 标签：symfony, routing, symfony-2.1

我使用 Symfony2.1，我想做这样的事情：

[主页前的欢迎页面](http://www.liverpoolfc.com/)

当用户访问我的页面 / 我想将他重定向到 /welcome。当他单击 /welcome 中的链接时，他应该被重定向到 / 页面，但是他应该再次看到主页（/）而不是欢迎页面。我如何通过路由来做到这一点？是否可以？

在“普通”PHP 中，我使用会话来执行此操作，Symfony2 呢？

**编辑：**

我用这样的会话解决了这个问题：

我有两条路线：core_homepage（模式/）和welcome_homepage（模式/欢迎）。

```
//Controller for core:
public function indexAction()
    {
        $session = new Session();
        $session->start();

        if ($session->get('welcome_flag')=='0'){
            return $this->render('MarkCoreBundle:Default:index.html.twig');
        } else {
            return $this->redirect($this->generateUrl('welcome_homepage'));
        }  
    }

//Controller for welcome:
public function indexAction()
    {
        $session = new Session();
        $session->start();

        if ($session->get('welcome_flag') == '0'){
            return $this->redirect($this->generateUrl('core_homepage'));   
        } else {
            $session->set('welcome_flag', '0');
            return $this->render('MarkWelcomeBundle:Default:index.html.twig');
        }
    } 
```

如果有人有任何其他解决方案，请发布。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:44:45.583

您可以使用会话。在“/”路由的控制器中，检查会话中是否设置了标志。如果不是，请重定向到“/欢迎”页面。在“/welcome”路由的控制器中，在会话中设置此标志。

请注意，这只会在会话处于活动状态时持续。如果您想要一个更永久的设置，则必须将其保存到数据库或类似的东西中。

# foxpro - 在 Visual FoxPro 9 中删除尾随零和小数点

> ID：12373345
> 
> 赞同：2
> 
> 时间：2012-09-11T15:39:11.493
> 
> 标签：foxpro

我知道这种编程语言已经过时了，但我的公司仍在使用它，而且由于不受支持，很难在网上找到这类事情的具体帮助。我在这里搜索了一些选项，但一无所获。

这是我的数据的样子：8005551234.000000

这是我需要我的数据的样子：8005551234

它显示尾随零的原因是因为我假设当我通过 excel 将数据导入 FoxPro 时，字段上的添加是一个整数字段，而当它转换为 dbf 时，它需要是一个字符字段。

我已经玩过 TRANSFORM 函数了一点，但我似乎无法弄清楚。

如果有帮助，我的字段名称是“电话”...

提前感谢您的支持！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T09:08:50.190

使用STREXTRACT() 函数。它处理可能没有小数的情况和可能存在其他字符的情况。例如

```
? STREXTRACT("8005551234.000000", "", ".", 1, 2)  && returns 8005551234
? STREXTRACT("8005551234", "", ".", 1, 2)  && returns 8005551234
? STREXTRACT("800-555-1234", "", ".", 1, 2)  && returns 800-555-1234 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T20:08:33.633

If the field "phone" doesn't have hyphens in it as commented by Frank in another answer, you can always strip by using LEFT( x, at()).. such as

```
replace Phone with left( phone, at( ".", phone ) -1 );
    for at( ".", phone ) > 0 
```

If you have a format with decimals as place-holders for the phone, such as

1.800.TRY.MORE.

You might have to use the optional 3rd parameter of "AT()" function which indicates which "." instance you are interested in. In the example of 1.800... you could try

```
replace Phone with left( phone, at( ".", phone, 4) -1 );
    for at( ".", phone, 4 ) > 0 
```

AT() function is basically

Look for "X" found in string "Y" and optionally, look for the "n" instance such as AT( X, Y, n )

Hope this helps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-20T04:39:29.843

```
   *将数值转换为字符串值
   汝来=01230045600.00789000
   ?makestr(nilai) &&result => 1230045600.00789
   函数 makestr(nilai)
      cNum1=alltrim(str(int(nilai)))
      nNol=0
      对于 i=1 到 len(cNum1)
        如果右（左（cNum1，i），1）=“0”那么
          nNol=nNol+1
        万一
      结束
      cnilai=str(nilai,20,10)
      如果 nNol>0 则
        cnilai=alltrim(strtran(cnilai,"0","",nNol))
      别的
        cnilai=alltrim(strtran(cnilai,"0",""))
      万一
      cnilai=alltrim(strtran(cnilai," ","0"))
   返回 cnilai

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T17:23:40.957

如果这是一个数字试试这个。

```
MyNewValue = INT(8005551234.000000) 
```

或 MyNewValue = INT(MyTable.MyFieldName)

如果这是一个字符串，试试这个：

```
MyNewValue = INT(VAL("8005551234.000000")) 
```

或 MyNewValue = INT(VAL(MyTable.MyFieldName))

要查看它是什么类型，请在命令窗口中执行此操作：

```
USE myTableName
DISPLAY STRUCTURE 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-12T04:57:34.397

使用 STR() 函数。示例： 1\. 创建一个光标，其中包含一个代表您已导入数据的数字字段和一个用于转换的字符串字段 2\. 插入您的数字电话# 3\. 用字符串替换数字电话# 4\. 浏览结果

```
CREATE CURSOR xphone (nphone n(17,6), cphone c(10))
INSERT INTO xphone (nphone) VALUES (8005551234)
REPLACE cphone WITH STR(nphone)
BROWSE 
```

*   您可以将上述代码复制并粘贴到 vfp9 的程序窗口中，突出显示它，右键单击并选择执行选择，它将为您工作。

# apache - 单个域中文件夹分隔站点的 Apache VirtualHost 配置

> ID：12373347
> 
> 赞同：2
> 
> 时间：2012-09-11T15:39:17.363
> 
> 标签：apache

我想将 apache 配置为允许每个站点的 apache 日志记录（访问和错误）和每个主机的 php 变量分配。我有一个**域**，所有站点都可以通过它访问：

```
http://domain/site1
http://domain/site2
...

```

如果我以这种方式使用 Alias 指令...

```
别名 /site1 /var/www/vhosts/httpdocs/site1
别名 /site2 /var/www/vhosts/httpdocs/site2

```

...我既不能按站点设置自定义日志记录，也不能按站点设置 php 变量。

所以我尝试使用*VirtualHost*指令但无法使其工作。我尝试在每个 VirtualHost 上的 ServerAlias 中使用*domain/site1 ，但它不起作用。*我也尝试直接在 *VirtualHost指令中添加**/site1* ，但我认为这是不允许的。我尝试了很多组合，但没有任何效果。我知道 VirtuaHosts 专注于使用多个域，但我想有针对这种情况的解决方案。

 *我也尝试过使用*Directory*指令，但其中不允许使用 CustomLog。有任何想法吗？

谢谢您的帮助。

艾托

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:55:59.010

您是否将 vhost 定义插入到`$HTTP_PATH/conf.d/vhost.conf`Apache Web Server 的主配置文件所包含的 a 中：`$HTTP_PATH/conf/httpd.conf`？

您是否检查了与 的`php`集成`httpd.conf`？加载php模块等

您是否检查了`php.ini`有关您的申请`.htaccess`和`php`要求的文件？

制作别名确实是一种糟糕的做法，除非您的服务器上的任何主机名都可以访问该网站......但不要忘记它肯定会在任何搜索引擎上降低您的分数。

请向我们提供更多信息，并减去 /var/log/httpd/error_log。

你可以得到它`tail -f /path/to/error/log`

**补充：** 可以看httpd模块`mod_log_config`。默认日志行的格式如下：

```
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined 
```

将其更改为：

```
LogFormat "%v %h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined 
```

其中 %v 将在您的日志中插入虚拟主机的名称。这些名称将由下面指示的解析器显示和过滤。

并使用随 apache web 服务器分发的脚本来获取 virtualhosts 分隔的日志文件：著名的`/src/support/split-logfile.pl`：

```
#!/usr/bin/perl
#
# ====================================================================
# Copyright (c) 1995-1998 The Apache Group.  All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#
# 1\. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer. 
#
# 2\. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in
#    the documentation and/or other materials provided with the
#    distribution.
#
# 3\. All advertising materials mentioning features or use of this
#    software must display the following acknowledgment:
#    "This product includes software developed by the Apache Group
#    for use in the Apache HTTP server project (http://www.apache.org/)."
#
# 4\. The names "Apache Server" and "Apache Group" must not be used to
#    endorse or promote products derived from this software without
#    prior written permission.  For permission please contact
#    Apache@Apache.Org.
#
# 5\. Products derived from this software may not be called "Apache"
#    nor may "Apache" appear in their names without prior written
#    permission of the Apache Group.
#
# 6\. Redistributions of any form whatsoever must retain the following
#    acknowledgment:
#    "This product includes software developed by the Apache Group
#    for use in the Apache HTTP server project (http://www.apache.org/)."
#
# THIS SOFTWARE IS PROVIDED BY THE APACHE GROUP ``AS IS'' AND ANY
# EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
# PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE APACHE GROUP OR
# ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
# SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
# NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
# LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
# HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
# STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
# OF THE POSSIBILITY OF SUCH DAMAGE.
# ====================================================================
#
# This software consists of voluntary contributions made by many
# individuals on behalf of the Apache Group and was originally based
# on public domain software written at the National Center for
# Supercomputing Applications, University of Illinois, Urbana-Champaign.
# For more information on the Apache Group and the Apache HTTP server
# project, please see <http://www.apache.org/>.
#

#
# This script will take a combined Web server access
# log file and break its contents into separate files.
# It assumes that the first field of each line is the
# virtual host identity (put there by "%v"), and that
# the logfiles should be named that+".log" in the current
# directory.
#
# The combined log file is read from stdin. Records read
# will be appended to any existing log files.
#
%is_open = ();

while ($log_line = <STDIN>) {
    #
    # Get the first token from the log record; it's the
    # identity of the virtual host to which the record
    # applies.
    #
    ($vhost) = split (/\s/, $log_line);
    #
    # Normalize the virtual host name to all lowercase.
    # If it's blank, the request was handled by the default
    # server, so supply a default name.  This shouldn't
    # happen, but caution rocks.
    #
    $vhost = lc ($vhost) or "access";
    #
    # If the log file for this virtual host isn't opened
    # yet, do it now.
    #
    if (! $is_open{$vhost}) {
        open $vhost, ">>${vhost}.log"
            or die ("Can't open ${vhost}.log");
        $is_open{$vhost} = 1;
    }
    #
    # Strip off the first token (which may be null in the
    # case of the default server), and write the edited
    # record to the current log file.
    #
    $log_line =~ s/^\S*\s+//;
    printf $vhost "%s", $log_line;
}
exit 0; 
```

如果这些还不够，您可以使用以下[logcron脚本进行检查。](http://slacksite.com/apache/scripts/logcron)您可以按照[这些文章](http://slacksite.com/apache/logging.php)中的文字进行操作。*

# c# - 使用 Directory.Getfiles 并指定绝对路径

> ID：12373352
> 
> 赞同：4
> 
> 时间：2012-09-11T15:39:48.420
> 
> 标签：c#, asp.net

嗨，我想知道你们是否可以帮忙。

我正在编写一个应用程序，该应用程序将存在于多个服务器上，因此存在多个 IP，而不是使用确切的 IP 和目录结构，我只想从应用程序实际运行的位置“退回”一个文件夹。比如说……

文件夹结构是

\controls\ ---- 这包含将检查 xml 文件是否存在于 blogengine 文件夹中的 aspx 文件。

\blogengine\ 这应该包含 xml 文件

我正在使用的代码是......

```
string[] filePaths = Directory.GetFiles(@"\\94.175.237.35\inetpub$\wwwroot\mytest\BlogEngine\", "*.xml"); 
```

它将在特定服务器上找到文件，但我需要找到与运行应用程序的服务器相关的文件，这样我就不必不断更改文件路径。所以我需要类似的东西

```
string[] filePaths = Directory.GetFiles(@"..\BlogEngine\", "*.xml"); 
```

但是我找不到正确的语法来做到这一点？

有人知道吗？？

在此先感谢，克雷格

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T15:42:20.903

使用该`Server.MapPath()`方法将相对路径（基于当前目录或网站根目录）映射到绝对可访问路径。

例如：

```
string folderPath = Server.MapPath("~/BlogEngine");
string[] filePaths = Directory.GetFiles(folderPath, "*.xml"); 
```

波浪号字符代表您网站的根，如果您指定一个相对路径，那么它将被解析为相对于您的 ASP.NET 页面所在的目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:44:36.370

使用[Path.GetFullPath](http://msdn.microsoft.com/en-us/library/system.io.path.getfullpath.aspx)从您的相对路径中获取绝对路径。

因此，您的代码变为：

```
string[] filePaths = Directory.GetFiles(Path.GetFullPath(@"..\BlogEngine\"), "*.xml"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T15:42:17.733

在 ASP.Net 应用程序中，您可以调用`Server.MapPath("~/path")` 以解析磁盘上相对于应用程序根目录的路径。

# javascript - 从 json 子数组中获取数据

> ID：12373357
> 
> 赞同：0
> 
> 时间：2012-09-11T15:39:57.670
> 
> 标签：javascript, jquery, json

我正在遍历以下 json。我得到 id 和 name 很好，但是当我这样做时`json.templates[i].dailyemails.length`它总是返回 0。

这是我的json：

```
{
   "templates":[
      {
         "id":"2c1d99d9b6b2fb417601d24c10c9b041a7d6f37b",
         "dailyemails":[
            "saaa@aa.com",
            "aaa.aaa@gmail.com"
         ],
         "name":"Registration Report"             
      },
      {
         "id":"7d7cc642ca13cc4a998cad364dfe8e623fd95ae3",
         "dailyemails":[
            "saaa@ss.com"
         ],
         "name":"Live Report"
      }

   ]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:41:37.983

如果这是 JSON，即字符串，则必须对其进行解析并使用 javascript 对象：

```
var obj = JSON.parse(json); 
```

然后你可以查询`obj.templates[i].dailyemails`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:42:53.307

```
$.each(data.templates,function(index,item){
    alert(item.dailyemails.length)
}); 
```

示例：http: [//jsfiddle.net/JbF29/2/](http://jsfiddle.net/JbF29/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:42:05.607

[如本现场演示](http://jsfiddle.net/Zvta7/1/)中所见，这应该可以正常工作。确保您的实际 JSON 结构与您在问题中显示的结构相同。

# javascript - 如果 msgbox 回答为 YES，则 Javascript 完整表单

> ID：12373359
> 
> 赞同：0
> 
> 时间：2012-09-11T15:40:03.160
> 
> 标签：javascript, html

这是查询结果的一部分...

```
`Echo '<input type="text" name="amount" style="height:10px;width:15px;font-size:8px;"    value="1">
<input type="submit" style="height:10px;font-size:6px;" value="Xx"    onclick="confirmDeletec(\'items.php?del='.$item['Idi'].'&nr=1\')">'; ` 
```

这是javascript函数

```
 function confirmDeletec(delUrl3) {
     if (confirm("Are you sure you want to delete that item?")) {
      document.location = delUrl3;
     }
     } 
```

当我单击按钮时，它会询问我是否要删除该项目，如果我按是，它将从它的总数中删除 1...

现在的问题是我如何使 nr=textbox 值（例如：items.php?del=43&nr=5 其中 textboxvalue 为 5...）然后询问我是否要删除...

我试图制作一个表格，但我无法使用确认删除功能...

我提到每个mysql结果我都有一个文本框和一个提交按钮......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:45:16.383

**纯JS解决方案**

改变

```
onclick="confirmDeletec( 
```

至

```
onclick="return confirmDeletec( 
```

现在将功能更改为

```
function confirmDeletec(delUrl3) {
    if (!confirm("Are you sure you want to delete that item?")) {
        return false;
    }
    return true;
} 
```

如果可以使用 JQuery，请使用以下代码代替函数

```
$("#formid").submit(function(e){
    if (!confirm("Are you sure you want to delete that item?")) {
        e.preventDefault();
    }
}); 
```

# java - Struts 2 Validation 将字段错误添加到列表

> ID：12373362
> 
> 赞同：0
> 
> 时间：2012-09-11T15:40:08.343
> 
> 标签：java, validation, struts2, ognl

我的表单有一个参数，该参数由数据的网格/表（通过 s:iterator 呈现）以及我的操作类中表示的其他字段组成：

```
public class MyAction extends ActionSupport {
  private MyParameter param;

  public String execute() { ..... }
  // getter and setters 
} 
```

这是 MyParameter 类：

```
public class MyParameter {
  private List<GridData> gridDataList;
  private String subParam1;
  private String subParam2;
  // getters and setters here
} 
```

这是网格数据：

```
public class GridData {
  private String title;
  private String arg1;
  // etc... getters and setters...
} 
```

我能够成功提交网格数据的值以执行一些验证。我可以通过以下方式将字段错误添加到其他参数：

```
super.addFieldError("param.subParam1", "subParam1 error message");
super.addFieldError("param.subParam2", "subParam2 error message"); 
```

我想做的是遍历我的列表，并将错误消息添加到列表中的每个元素。我尝试执行以下操作，但似乎不起作用：

```
for(int intRow=0; intRow < param.griDataList.size(); intRow++) {
  super.addFieldError("param.gridDataList[" + intRow + "].arg1", "error message");
} 
```

然后，我使用迭代器在 JSP 中呈现了字段错误。我知道上述是可能的，因为当我在处理后检查生成的 HTML 时，该字段显示我在 JSP 中设置的“cssErrorClass”。那是：

```
<s:textfield
name="param.gridDataList[%{#outerStat}].data"
cssClass="grid_text_field"
cssErrorClass="error_field" maxlength="7"/> 
```

其中 outerStat 是迭代器中设置的状态（计数器）。这会产生：

```
<input
type="text"
name="param.gridDataList[0].data"
class="grid_text_field error_field"
maxlength="7"/> 
```

但是标签中没有生成字段错误消息：

```
<s:fielderror fieldName="param.gridDataList[%{#outerStat}].data"/> 
```

谁能指出我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:20:56.080

首先正确使用 fielderror 标签是`<s:fielderror fieldName="some_field_name"/>`. 并且 some_field_name 必须是 String 而不是表达式[http://struts.apache.org/2.x/docs/fielderror.html](http://struts.apache.org/2.x/docs/fielderror.html)。

一种方法是访问属性标签中的 fieldError 映射
`<s:property value="fieldErrors.param[%{index}].arg"/>`

# asp.net - 单击用户控件中的第二次单击之前不会触发单击事件

> ID：12373364
> 
> 赞同：0
> 
> 时间：2012-09-11T15:40:13.447
> 
> 标签：asp.net, c#-4.0, user-controls, master-pages

所以这里是场景......我有一个 ASP.NET 4.0 网站，其中包含一个 MasterPage，上面有一个用户控件。用户控件上有一个带有单击事件的按钮。使用此 MasterPage 的 web 表单在页面基础 OnPreInit 中动态分配此 MasterPage。网络表单正在使用正确的母版页，但是当单击用户控件中的按钮时，它不会触发，直到第二次单击。这肯定是因为母版页是动态分配的，但我不知道如何修复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:35:36.647

我想到了。我在页面库中动态设置 MasterPage，但前提是不是回发。一旦我删除了母版页的回发检查，它就会按预期工作。

# git - Git Diff，我怎样才能得到添加的行？

> ID：12373367
> 
> 赞同：1
> 
> 时间：2012-09-11T15:40:16.193
> 
> 标签：git

我的项目中有一些 sql 文件：

上一版本中一个文件的内容是：

```
line1...
line2...
line3... 
```

我当前提交中的同一文件具有：

```
line1...
line2...
line3...
line4...
line5... 
```

我想要一个 git 命令从所有“.sql”文件中获取所有新行。

我正在尝试：

```
git diff HEAD~1 HEAD *.sql

diff --git a/patch.sql b/patch.sql
index e654124..c5692e4 100644
--- a/patch.sql
+++ b/patch.sql
@@ -4,3 +4,7 @@ line2
line1...
line2...
line3...
+line4...
+line5... 
```

很好，但我只想：

```
line4...
line5... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:02:41.167

您可以将其通过管道传输到 grep：

```
git diff HEAD~1 HEAD -- *.sql | grep "^+[a-Z0-9]" 
```

您需要额外的正则表达式以避免匹配`+++ b/patch.sql`

# php - 在带有 DESCRIBE 的 PDO 准备语句中使用参数

> ID：12373368
> 
> 赞同：1
> 
> 时间：2012-09-11T15:40:17.410
> 
> 标签：php, mysql, pdo, schema

在我看来，这对于标准查询来说是可以的，但在涉及到 DESCRIBE 时则不行：

```
$q = $dbh->prepare("DESCRIBE ?");
$q->execute(array($this->ormTable));
$table_fields = $q->fetchAll(PDO::FETCH_ASSOC); 
```

任何人都可以确认吗？除了手动附加表名之外，还有其他解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:43:33.477

确保 ormTable 不会受到外部影响（SQL 注入等）或正确引用语法使用（不要为此使用 PDO::quote()）

```
$q = $dbh->prepare("DESCRIBE ".$this->ormTable);
$q->execute();
$table_fields = $q->fetchAll(PDO::FETCH_ASSOC); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:44:56.550

```
$q = $dbh->prepare(sprintf('DESCRIBE %s', $this->ormTable));
$q->execute();
$table_fields = $q->fetchAll(PDO::FETCH_ASSOC); 
```

# javascript - jQueryUI 进度条

> ID：12373373
> 
> 赞同：0
> 
> 时间：2012-09-11T15:41:00.610
> 
> 标签：javascript, jquery, jquery-ui, progress-bar, javascript-framework

我从未使用过 jQuery UI 进度条，但我想做一个基本上加载 jQuery UI 进度条的函数，运行 5 秒，然后执行另一个函数。

IE。

```
function test() {

show the jQuery UI progress bar for 5 seconds in div ("progressbar")

after 5 seconds has passed..... execute test2()

} 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:57:10.227

你可以这样做：

```
​&lt;button onclick="test()">Test</button>
<div id="progress"></div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

带动画：

```
function test(){
    var per = 0;
    progress(per);
    time = setTimeout(function(){ animate(per); }, 1000);
    setTimeout(function(){ $( "#progress" ).hide(); test2(); }, 5000);

}

function animate(per){

    clearTimeout(time);
    per = per+20;
    progress(per);

    time = setTimeout(function(){ animate(per); }, 1000);
}

function test2(){
    alert('test2');
}
function progress(per){
    $( "#progress" ).progressbar({
        value: per
    });        
} 
```

[JSFiddle 示例](http://jsfiddle.net/tnSyN/)

# svn - 设置 Subversion VPS Centos

> ID：12373377
> 
> 赞同：0
> 
> 时间：2012-09-11T15:41:10.157
> 
> 标签：svn, centos, vps

我在我的 VPS 上安装 subversion 时遇到一个奇怪的问题。我尝试通过以下步骤安装它：[http](http://www.directadmin.com/forum/showthread.php?t=30972&p=157056#post157056) ://www.directadmin.com/forum/showthread.php?t=30972&p=157056#post157056 。但是当我在完成这些步骤后尝试重新启动 apache 时出现错误：

```
httpd: Syntax error on line 166 of /etc/httpd/conf/httpd.conf: 
Cannot load /usr/lib/apache/mod_dav_svn.so into server:
/usr/lib/apache/mod_dav_svn.so: undefined symbol: svn_error_purge_tracing 
```

我现在正在研究它好几天，但真的无法让它工作。有人对这个问题有任何线索吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T08:42:59.030

现在可以工作了，但不是基于 Apache 的 mod_dav_svn 模块。遇到此问题的其他所有人都可以查看使用 SVNServe 进行 SVN 设置。

# ruby-on-rails - 如何在 activeadmin 中声明嵌套资源？

> ID：12373381
> 
> 赞同：16
> 
> 时间：2012-09-11T15:41:41.023
> 
> 标签：ruby-on-rails, activeadmin, rails-routing

我有一个名为 User 的资源和另一个名为 Order 的资源。

我希望 Order 嵌套在 Users 中，这样我就可以拥有这些路由：

```
/users
/users/:id
/users/:id/new
/users/:id/edit
/users/:user_id/orders
/users/:user_id/orders/:id
/users/:user_id/orders/:id/new
/users/:user_id/orders/:id/edit 
```

如何使用 activeadmin 做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-11T16:10:40.713

只需将 belongs_to 选项添加到 active_admin 资源页面

```
ActiveAdmin.register Order do
  belongs_to :user
end 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-06-14T20:33:10.977

@railscard 的答案部分正确，但如果您不想要 @bishma-stornelli 提到的 /order、/order/:id 等默认路由 - 您可以添加如下选项：

```
ActiveAdmin.register Order do
  belongs_to :user, :optional => true
end 
```

# c# - 在溢出的情况下向下滚动一个 ContextMenu

> ID：12373383
> 
> 赞同：2
> 
> 时间：2012-09-11T15:41:48.230
> 
> 标签：c#, .net, wpf, winforms, contextmenu

我正在 WPF 中创建一个应用程序。

我使用“System.Windows.Forms.NotifyIcon”包含了一个系统托盘图标

代码如下：

```
// Create WinForm notify icon
m_NotifyIcon = new System.Windows.Forms.NotifyIcon();
m_NotifyIcon.Icon = Properties.Resources.rocket;
m_NotifyIcon.Visible = true;
// Default Balloon title
m_NotifyIcon.BalloonTipTitle = "Greatest App ever";
m_NotifyIcon.ContextMenu = new System.Windows.Forms.ContextMenu();

// Append default menu items
List<MenuItem> itemList = new List<MenuItem>();
itemList.Insert(0, new MenuItem("Exit", OnExit_Click));
itemList.Insert(0, new MenuItem("-"));
itemList.Insert(0, new MenuItem("Refresh", RefreshConsoleList));
itemList.Insert(0, new MenuItem("Filter: \"" + (String.IsNullOrEmpty(m_Filter) ? "NONE" : m_Filter) + "\"", ChangeFilter_Click));
itemList.Insert(0, new MenuItem("-"));
m_NotifyIcon.ContextMenu.MenuItems.AddRange(itemList.ToArray()); 
```

结果如下所示：

[刷新前](http://yves.desgraupes.free.fr/shared/ContextMenu_beforeRefresh.png)

在刷新的情况下，我的应用程序会得到很多条目，然后将这些条目附加到 ContextMenu 中，菜单将如下所示：

[MenuItem 溢出](http://yves.desgraupes.free.fr/shared/ContextMenu_Overflow.png)

如您所见，MenuItem 过多，由于溢出，将显示 2 个箭头（ContextMenu 的顶部和底部）

现在如果用户想要退出应用程序，他必须向下滚动，然后单击退出。如果列表真的很大，它会惹恼用户。

为避免这种情况，我想在弹出时显示已经滚动到底部的 ContextMenu（第一个 MenuItem 可见）

但是我没有找到任何用于以编程方式向下滚动 ContextMenu 的事件或控件。

有可能吗？

问候

Yves Desgraupes

* * *

PS：由于我的声誉，我无法直接发布图片（这是我的第一篇文章），并且发布了两个以上的链接。

第三个例子在这里：

yves.desgraupes.free.fr/shared/ContextMenu_OverflowScroll.png

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T22:53:31.387

您可以做的是使用 NotifyIcon 的 WPF 实现。

*   [http://wpfcontrib.codeplex.com/wikipage?title=NotifyIcon&referringTitle=Home](http://wpfcontrib.codeplex.com/wikipage?title=NotifyIcon&referringTitle=Home)

然后你可以有一个 WPF 菜单，并且可以更好地控制你如何在菜单中实现你想要的行为。

因此，您可以为 ContextMenu 定义一个模板，并在 ContextMenu 模板中访问 ScrollViewer，然后在其上调用 ScrollToEnd()。

这是一个示例，展示了如何创建一个 WPF 上下文菜单，当它启动时会滚动到最后。您可以在 WPF NotifyIcon 中使用它。右键单击按钮以查看上下文菜单。

请注意，我已将其作为起点....您可以改进代码..减少一些重复...但它有效....例如..在菜单首次出现时解决故障显示它不会滚动到最后我不得不捕获 SizeChanged 事件。

```
<Window x:Class="WpfApplication15.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <Style TargetType="{x:Type ContextMenu}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ContextMenu}">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}"
BorderThickness="{TemplateBinding BorderThickness}">
                            <ScrollViewer x:Name="scrollviewer"
Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}"
CanContentScroll="True" >
                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" Margin="{TemplateBinding Padding}"
KeyboardNavigation.DirectionalNavigation="Cycle"/>
                            </ScrollViewer>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid>
        <Button x:Name="mybutton">
            <Button.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Test1"/>
                </ContextMenu>
            </Button.ContextMenu>
            Test Button
        </Button>       
    </Grid>
</Window> 
```

* * *

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Controls.Primitives;

namespace WpfApplication15
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public static T FindVisualChild<T>(DependencyObject depObj) where T : DependencyObject
        {
            if (depObj != null)
            {
                for (int i = 0; i < VisualTreeHelper.GetChildrenCount(depObj); i++)
                {
                    DependencyObject child = VisualTreeHelper.GetChild(depObj, i);
                    if (child != null && child is T)
                    {
                        return (T)child;
                    }

                    T childItem = FindVisualChild<T>(child);
                    if (childItem != null) return childItem;
                }
            }
            return null;
        }

        public MainWindow()
        {
            InitializeComponent();

            ContextMenu contextmenu = mybutton.ContextMenu;

            // Add 100 more items

            for (int i = 2; i <= 100; i++)
            {
                MenuItem mi = new MenuItem();
                mi.Header = "Item" + i.ToString();

                contextmenu.Items.Add(mi);
            }

            contextmenu.SizeChanged += new SizeChangedEventHandler(contextmenu_SizeChanged);
            contextmenu.Loaded += new RoutedEventHandler(contextmenu_Loaded);

            mybutton.ContextMenuOpening += new ContextMenuEventHandler(mybutton_ContextMenuOpening);
        }

        void contextmenu_SizeChanged(object sender, SizeChangedEventArgs e)
        {
            ContextMenu contextmenu = mybutton.ContextMenu;

            ScrollViewer sv = FindVisualChild<ScrollViewer>(contextmenu);
            if (sv != null)
            {
                sv.ScrollToEnd();
            }
        }

        void contextmenu_Loaded(object sender, RoutedEventArgs e)
        {
            ContextMenu contextmenu = mybutton.ContextMenu;

            ScrollViewer sv = FindVisualChild<ScrollViewer>(contextmenu);
            if (sv != null)
            {
                sv.ScrollToEnd();
            }
        }

        void mybutton_ContextMenuOpening(object sender, ContextMenuEventArgs e)
        {
            ContextMenu contextmenu = mybutton.ContextMenu;
            ScrollViewer sv = FindVisualChild<ScrollViewer>(contextmenu);
            if (sv != null)
            {
                sv.ScrollToEnd();
            }
        }
    }
} 
```

* * *

附带说明....您可能希望通过在此处设置 MaxHeight...demo 来限制 ContextMenu 的高度。

```
<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Grid>  
  <Button>
  <Button.ContextMenu>
  <ContextMenu MaxHeight="100">
  <MenuItem Header="Test1"/>
  <MenuItem Header="Test2"/>
  <MenuItem Header="Test3"/>
  <MenuItem Header="Test4"/>
  <MenuItem Header="Test5"/>
  <MenuItem Header="Test6"/>
  <MenuItem Header="Test7"/>
  <MenuItem Header="Test8"/>
  <MenuItem Header="Test9"/>
  </ContextMenu>
  </Button.ContextMenu>
  Test Button</Button>
  </Grid>
</Page> 
```

# coldfusion - 只使用Application.cfc 的一部分？

> ID：12373386
> 
> 赞同：2
> 
> 时间：2012-09-11T15:42:00.390
> 
> 标签：coldfusion, coldfusion-9, application.cfc

我没有在 Coldfusion 方面接受过任何正式培训，所以这样的事情真的让我很困惑，因为它们的工作方式与我想象的不同。

我的文件夹结构是这样的：

```
MainAppFolder
  |
  |_ApplicationFolder
    |
    |_SubAppFolder1
       |_Application.cfc
    |
    |_SubAppFolder2
       |_Application.cfc
    |
    |_Application.cfc 
```

主文件`ApplicationFolder`中包含的最后一个 Application.cfc 是我想要包含我的`<cflogin>`东西的 Application.cfc。那行得通，而且效果很好。但是，当我在`SubAppFolderx`. 这些Application.cfc 只需要包含一个`onRequestStart`事件。

```
<cffunction name="onRequestStart">
    <cfset Application.AppID = 4>
    <cfinvoke component="loc" 
              method="getAppName" 
              returnvariable="appName" />
     <cfset Application.AppName = appName>
</cffunction> 
```

我越是试图解决这个问题，我就越是把自己挖到一个洞里。我试图返回并了解有关如何操作 Application.cfc 的更多信息，但就教程而言，关于 Coldfusion 的信息并不多。虽然它的文档很棒，但它并不能帮助我理解在这种情况下我需要做什么。

那么我需要做什么来执行我在 in 中所做的`onRequestStart`事情`SubAppFolderx`？我敢肯定这是一个简单的答案，但就像我说的那样，我只是在这里自掘坟墓。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T19:33:33.337

虽然 cfinclude 可以，但它可能无法提供您所追求的功能（继承） 由于 Application.cfc 本身就是一个组件，您可以像使用任何其他 CFC 一样重载/覆盖这些方法。

我不会进入代码，因为被称为 Ben Nadel 的传奇人物已经为这个问题发布了一个完美的博客：

[http://www.bennadel.com/blog/1179-Ask-Ben-Extending-Application-cfc-And-OnRequestStart-With-SUPER.htm](http://www.bennadel.com/blog/1179-Ask-Ben-Extending-Application-cfc-And-OnRequestStart-With-SUPER.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:37:58.207

您可以将您的登录名放入 cfinclude 语句中，并将 Application.cfc 放入 SubAppFolder1

1.  包括所有 Application.cfc 通用的代码
2.  包含对 SubAppFolder1 自定义的代码

# java - 无法持久化格式映射的数据 在jdo中

> ID：12373389
> 
> 赞同：0
> 
> 时间：2012-09-11T15:42:04.287
> 
> 标签：java, google-app-engine, hashmap, google-cloud-datastore, jdo

我试图在 JDO 中持久化 Hashmap 数据。

最初我创建了一个像

```
Map<Integer,String> dat=new HashMap<Integer,String>(); 
```

这工作得很好，我能够保存数据。但是当我尝试

```
Map<Integer, ArrayList<String>> dat=new HashMap<Integer,ArrayList<String>>(); 
```

我收到类似以下数据的错误：java.util.ArrayList 不是受支持的属性类型。

我使用的是不受支持的数据类型吗？有没有更好的选择？？我只是为了学习目的而这样做......所以你的想法会很有帮助..ty

完整代码

servlet.java

```
public class JdocheckServlet extends HttpServlet {

public void doGet(HttpServletRequest req, HttpServletResponse resp)
        throws IOException {
    resp.setContentType("text/plain");

    Map<Integer, ArrayList<String>> dat=new HashMap<Integer,ArrayList<String>>();
    ArrayList<String> s=new ArrayList<String>();
    ArrayList<String> s2=new ArrayList<String>();
    s.add("abc");
    s.add("abc2");
    s.add("abc3");
    s2.add("ab4c");
    s2.add("ab4c2");
    s2.add("ab4c3");
    dat.put(23, s);
    dat.put(25, s2);

    System.out.println(dat);
    data d=new data();
    PersistenceManager pm=PMF.get().getPersistenceManager();
    d.setData(dat);
    pm.makePersistent(d);

}} 
```

数据.java

```
@PersistenceCapable
public class data {

@Persistent
private Map<Integer, ArrayList<String>> data;

public Map<Integer, ArrayList<String>> getData() {
    return data;
}

public void setData(Map<Integer, ArrayList<String>> dat) {
    this.data = dat;
}
} 
```

访问 servlet 时抛出的错误

```
HTTP ERROR 500
Problem accessing /jdocheck. Reason:
data: java.util.ArrayList is not a supported property type.
Caused by:

java.lang.IllegalArgumentException: data: java.util.ArrayList is not a supported property type.
at com.google.appengine.api.datastore.DataTypeUtils.checkSupportedSingleValue(DataTypeUtils.java:186)
at com.google.appengine.api.datastore.DataTypeUtils.checkSupportedValue(DataTypeUtils.java:151)
at com.google.appengine.api.datastore.DataTypeUtils.checkSupportedValue(DataTypeUtils.java:125)
at com.google.appengine.api.datastore.PropertyContainer.setProperty(PropertyContainer.java:102)
at com.google.appengine.datanucleus.EntityUtils.setEntityProperty(EntityUtils.java:172)
at com.google.appengine.datanucleus.StoreFieldManager.storeFieldInEntity(StoreFieldManager.java:360)
at com.google.appengine.datanucleus.StoreFieldManager.storeObjectField(StoreFieldManager.java:186)
at org.datanucleus.state.AbstractStateManager.providedObjectField(AbstractStateManager.java:1447)
at jc.data.jdoProvideField(data.java)
at jc.data.jdoProvideFields(data.java)
at org.datanucleus.state.AbstractStateManager.provideFields(AbstractStateManager.java:1515)
at com.google.appengine.datanucleus.DatastorePersistenceHandler.insertObjectsInternal(DatastorePersistenceHandler.java:242)
at com.google.appengine.datanucleus.BatchPutManager.processBatchState(BatchPutManager.java:34)
at com.google.appengine.datanucleus.BatchManager.finish(BatchManager.java:54)
at com.google.appengine.datanucleus.DatastorePersistenceHandler.batchEnd(DatastorePersistenceHandler.java:194)
at org.datanucleus.ObjectManagerImpl.persistObjects(ObjectManagerImpl.java:1723)
at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistentAll(JDOPersistenceManager.java:779)
at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistentAll(JDOPersistenceManager.java:764)
at jc.JdocheckServlet.doGet(JdocheckServlet.java:37)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:35)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:60)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:370)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:547)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T08:31:00.570

## 问：您在什么情况下收到错误？... 答：在编译期间...

对我来说，您的错误似乎发生在运行时。

## 我是否使用了不受支持的数据类型？

正如@DataNucleus 上面提到的，您的错误跟踪表明GAE 数据存储不支持此属性类型。

## 有更好的选择吗？

这取决于您希望代码做什么。

# oop - 访客模式——另一种实现

> ID：12373392
> 
> 赞同：1
> 
> 时间：2012-09-11T15:42:14.280
> 
> 标签：oop, design-patterns, model-view-controller, visitor-pattern

我有一些简单的应用程序，我用设计模式实现了这些应用程序。在我使用 MVC 分离实现它的过程中。

我有 View - MainForm 类，Controller - MainController 类。

Controller 是一个单例，因此 MainForm 会在需要时访问它。MainController 具有作为 IMainFormView 接口的组合。

MainForm 类实现 IMainFormView。

因此，当用户单击某个按钮时，MainForm 会向 MainController 传递一些请求，该请求会计算一些内容并在 IMainFormView 成员上执行回调以更新 MainForm。

是否有访问者模式：IMainFormView-IVisitor 和 MainForm-访问者？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T18:15:14.157

我不认为这可以被认为是访问者模式的一个很好的例子。在访问者模式中，对于每种特定类型，您都重载了访问者类中的方法。然后将此访问者传递给这些类型以执行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T20:54:36.530

我在这里感觉到了一种[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)。策略模式允许您在运行时选择特定算法，在您的情况下是实现 IMainFormView。

# javascript - 使用 javascript 查询 lucene 索引

> ID：12373398
> 
> 赞同：5
> 
> 时间：2012-09-11T15:42:27.410
> 
> 标签：javascript, lucene

我已经索引了一些数据，现在我有了生成的索引文件。除了 javascript 和 lucene 索引文件之外，有没有什么方法可以从 javascript 查询这个索引？

[这个项目](https://github.com/gsf/node-solr)让我从 javascript 查询索引，但我需要 solr。

场景是我需要在客户端查询索引，而我只有 javascript 和可用的索引文件。没有网络连接。

由于我不需要诸如提升、同义词等高级搜索功能，因此我正在考虑一种替代解决方案，在该解决方案中，我创建自己的倒排索引而不是使用 lucene 索引。[类似的](https://stackoverflow.com/questions/7531414/lucene-like-searching-through-json-objects-in-javascript)东西。

这听起来像是一个更好的主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-14T20:26:42.447

要查询 lucene 索引，您需要 lucene jar，如果您有 lucene jar，您可以编写自定义代码以从索引中查询。无需互联网连接

# hibernate - Hibernate 4 多租户

> ID：12373406
> 
> 赞同：0
> 
> 时间：2012-09-11T15:42:59.173
> 
> 标签：hibernate, multi-tenant

从提供的文件中，我了解到 hibernate4 允许在三个不同级别上进行多韧性。

虽然我无法理解的是，我们是否可以为不同的租户拥有不同的实体集。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T11:07:52.073

不，您不需要多组实体，多租户的重点是使用相同的关系结构（实体集）但有多个副本。基本上每个租户一份。

我写了一篇关于它的短文，您可以在此处找到[hibernate 3 中的多租户](http://noobjuggler.blogspot.in/2012/03/multitenant-mode-for-dddcqrs-base.html)

# c++ - 断开命名管道的 SybaseIQ 问题（在 LOAD TABLE 上）

> ID：12373408
> 
> 赞同：1
> 
> 时间：2012-09-11T15:43:06.923
> 
> 标签：c++, sap-iq

我在尝试使用 SybaseIQ 15.4 上的命名管道执行批量加载时遇到问题。代码是 C++ 并打开 Windows。

在批量结束时，在刷新缓冲区 ( *`FlushFileBuffers`*) 之后，当我尝试断开命名管道 ( *`DisconnectNamedPipe`*) 时，*`LOAD TABLE query`*虽然*`"I/O Error on file \\.\pipe\pipename"`*文档说：

`"The pipe writer must call FlushFileBuffers( ) and then DisconnectNamedPipe( ). (If you do not, Sybase IQ reports an exception from hos io::Read( ).) This issues a PIPE_NOT_CONNECTED error, which notifies Sybase IQ that the pipe was shut down in an orderly manner rather than an uncontrolled disconnect"`

请注意，如果我删除`DisconnectNamedPipe`，批量加载就可以了

这是代码的简历，感谢您的帮助

```
hPipe = CreateNamedPipe(strPipeName, PIPE_ACCESS_OUTBOUND, PIPE_TYPE_BYTE, 255, 65536, 65536, 100, NULL);

ConnectNamedPipe(hPipe, NULL);

// in another thread: LOAD TABLE myTable (...) USING CLIENT FILE strPipeName ...

WriteFile(hPipe, ...);

FlushFileBuffers(hPipe);
DisconnectNamedPipe(hPipe); // I/O Error on file \\.\pipe\pipename
CloseHandle(hPipe); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T09:19:50.843

这是一个 Sybase IQ 错误。使用 15.2 或使用 15.4 的最后一个 EBR，DisconnectNamedPipe 工作正常

# android - 如何在消息窗口上显示设备注册 ID

> ID：12373412
> 
> 赞同：0
> 
> 时间：2012-09-11T15:43:19.230
> 
> 标签：android, google-cloud-messaging

我有 Android 应用程序，我使用了 GCM，我想显示设备注册 ID 窗口或在 log cat 上测试应用程序，我在 log cat 上看到模拟器有注册 ID 但我需要查看它如何？？？

此外，当我在我的手机上测试应用程序时，停止的项目...消息出现了，虽然它没有出现在模拟器上，当我评论这些权限时

```
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <uses-permission android:name="android.permission.WRITE_SETTINGS" />
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" /> 
```

> 这条消息消失了

班级

```
package com.example.elarabygroup;

import com.google.android.gcm.GCMBaseIntentService;
import com.google.android.gcm.GCMRegistrar;

import android.content.Context;
import android.content.Intent;
import android.os.PowerManager;
import android.util.Log;

public class GCMIntenetService extends GCMBaseIntentService {
    private static final String GCM_SENDER_ID = "1111111111";

    public GCMIntenetService() {
        super();
    }

    @Override
    protected void onRegistered(Context context, String registrationId) {
        Log.i(TAG, "Device registered: regId = " + registrationId);
        GCMRegistrar.setRegisteredOnServer(context, true);
    }

    @Override
    protected void onUnregistered(Context context, String registrationId) {
        Log.i(TAG, "Device unregistered");
        if (GCMRegistrar.isRegisteredOnServer(context)) {
            String regId = "";
            Log.i(TAG, "unregistering device (regId = " + regId + ")");
            GCMRegistrar.setRegisteredOnServer(context, false);
        } else {
            // This callback results from the call to unregister made on
            // ServerUtilities when the registration to the server failed.
            Log.i(TAG, "Ignoring unregister callback");
        }
    }

    @Override
    protected void onError(Context context, String errorId) {
        // push error processing
    }

    @Override
    protected void onMessage(Context arg0, Intent arg1) {
        Log.i(TAG, "Received message");
        Log.i(TAG, "EXTRAS" + arg1.getExtras());
        //String message = getString(R.string.gcm_message);
        generateNotification(arg0, arg1.getStringExtra("Please download our new updates"));
        // notifies user about message

    }

    private void generateNotification(Context arg0, String stringExtra) {
        // TODO Auto-generated method stub

    }

    public static void registerInGCMService(Context context) {
        if (!checkIsGCMServiceAvailable(context)) {
            return;
        }
        final String regId = GCMRegistrar.getRegistrationId(context);
        if (regId.equals("")) {
            try {
                GCMRegistrar.register(context, GCM_SENDER_ID);
            } catch (Exception ex) {
            }
        } else {
            // Already registered
        }
    }

    public static boolean checkIsGCMServiceAvailable(Context context) {
        try {
            GCMRegistrar.checkDevice(context);
            GCMRegistrar.checkManifest(context);
            return true;
        } catch (Throwable th) {
            return false;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T18:02:09.363

`Settings.Secure#ANDROID_ID`将 Android ID 作为唯一的 64 位十六进制字符串返回。

```
import android.provider.Settings.Secure;

private String android_id = Secure.getString(getContext().getContentResolver(),
                                                        Secure.ANDROID_ID); 
```

`android_id`包含设备 ID。

作为示例，我仅将更改添加到 registerInGCMService() 方法。

```
public class GCMIntenetService extends GCMBaseIntentService {
    private static String GCM_SENDER_ID ;

    public GCMIntenetService() {
        super();
    }

    public static void registerInGCMService(Context context) {

         GCM_SENDER_ID =  Secure.getString(getContext().getContentResolver(),
                                                            Secure.ANDROID_ID); 

        if (!checkIsGCMServiceAvailable(context)) {
            return;
        }
        final String regId = GCMRegistrar.getRegistrationId(context);
        if (regId.equals("")) {
            try {
                GCMRegistrar.register(context, GCM_SENDER_ID);
            } catch (Exception ex) {
            }
        } else {
            // Already registered
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T11:48:58.913

您可以在您想要显示或弹出消息的活动中调用广播接收器，如 toast 。下面的代码做同样的事情

1）修改下面的onRegistered()方法

```
protected void onRegistered(Context context, String registrationId) 
{
        Log.i(TAG, "Device registered: regId = " + registrationId);
        GCMRegistrar.setRegisteredOnServer(context, true);
        CommonUtilities.displayMessage(context,registrationId);
} 
```

2) 更改常用工具的 displayMessage()，如下所示

```
static void displayMessage (Context context, String message,String senderID,String recieverId,String Type) 

{
            Intent intent = new Intent(DISPLAY_MESSAGE_ACTION);
            intent.putExtra(EXTRA_MESSAGE, message);
            context.sendBroadcast(intent);
} 
```

3）在编写主要活动时，我们制作了 Boradcaste 接收器，当应用程序向 gcm 注册时通知用户将代码放在主要活动中或您想要显示弹出窗口的位置

```
 @Override
        protected void onResume() {

            registerReceiver(mHandleMessageReceiver, new IntentFilter(
                    CommonUtilities.DISPLAY_MESSAGE_ACTION));

        }

    private final BroadcastReceiver mHandleMessageReceiver = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) 
            {
                        // you pop message display here when app. will get registered
Toast.makeText(context,getIntent().getExtras().getString(CommonUtilities.EXTRA_MESSAGE), 2).show();

            }
        };

    @Override
        protected void onStop() {
            // TODO Auto-generated method stub
            super.onPause();
            relaseMemory();
        } 
```

# java - 尽管有错误，你能强制编译吗

> ID：12373415
> 
> 赞同：0
> 
> 时间：2012-09-11T15:43:37.373
> 
> 标签：java, android

即使有错误和缺少类，是否可以构建和编译 Android 应用程序？（例如，假设错误出现在一轮测试期间不会使用的类中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:48:12.037

不。Java 和许多编译环境一样，希望在构建时编译整个源代码树，当然就像 Android 那样。

但是，如果目前不需要这些东西，大概您可以注释掉编译错误和对缺失类的引用，以获得干净的编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:48:24.113

不，这是不可能的。您可以暂时注释不完整的代码，这会阻止编译。

# jquery - 两个字段的 jQuery/JSON 自动完成

> ID：12373419
> 
> 赞同：2
> 
> 时间：2012-09-11T15:43:55.770
> 
> 标签：jquery, json, jquery-ui-autocomplete

我正在尝试 jQuery 的自动完成小部件，并且有点碰壁。将不胜感激一些输入/指导。

本质上，我有一个表单，有人将在其中输入一个人的名字……然后jQuery 将查询数据库并建议匹配项。该表单有两个字段需要从 JSON 数据中填充 - 名称字段和隐藏的 ID 字段。到目前为止，我可以让它只给出建议并在选择时填写名称字段，但没有运气让它更新隐藏的 ID 字段。我知道我必须从 jQuery 代码中遗漏一些关键，但还没有弄清楚。我曾尝试使用“选择”事件设置值，但没有运气。

这是相关的表格代码：

```
<div id="formblock" class="stack">
    <label>Project POC: <span class="error" name="proj_poc_error" id="proj_desc_error">This field is required.</span></label>
    <input type="text" name="proj_poc" id="proj_poc">
    <input type="hidden" name="proj_poc_id" id="proj_poc_id" value="NOT SET">   
</div> 
```

这是相关的jQuery代码：

```
$(function() {

        $( "#proj_poc" ).autocomplete({
            source: function(request, response){
                $.getJSON("/includes/AJAX/GetContactNames.php?callback=?", request, function(data){
                    var suggestions = [];
                    $.each(data, function(i, val){
                        suggestions.push(val.contacts);
                    });
                    response(suggestions);
                });
            },
            minLength: 2,
            select: function( event, ui ){
                       //Should display user ID a
                       alert(ui.item.id + ui.item.contacts);

            }

        });

}); 
```

这是来自 GetContactNames.php 的相关 PHP

```
//Initiate the session
session_start(); 

//Load custom classes
    include_once ('../../ops.inc.php');

//Get the search term from GET  
    $param = $_GET['term'];

//Create new dblink class and connect to db 
    $uplink = new dblink();
        $uplink->connect();

//Create new dbcontrol class    
    $control = new dbcontrol();

//Set the query to select ID and CONCAT'd NAME from Contact Table
    $control->query = "SELECT `id`, CONCAT_WS(\" \",`firstname`,`lastname`) AS 'contacts' FROM `addressbook` WHERE `firstname` REGEXP '^$param'";

//Execute the query 
    $control->execute();

//Set an iterator value to 0    
    $i = 0;

//Get the results into array, then iterate. 
    while($row = $control->toAssocArray()){

        foreach($row as $column=>$value){
            $results[$i][$column] = $value;
        }

        $i++;

    }

//Set the response string and encode for json   
    $response = $_GET['callback']."(".json_encode($results).")";

//Display the response string   
    echo $response;

//Disconnect from the database  
    $uplink->disconnect();

//Destroy classes   
    unset($uplink, $control); 
```

GetContactNames.php 结果的输出如下所示：

```
([{"id":"1","name":"Santa Clause"},{"id":"2","name":"Joe Blow"}]) 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:05:16.067

您在源函数中构建的数据结构必须包含具有标签和值字段的对象。标签字段是自动完成菜单中显示的内容，该值是在您选择一个值后将在文本字段中设置为值的内容。

这是一个示例，在搜索用户时：

```
success: function( data ) {
            response( $.map( data, function( item ) {
                return {
                label: item.username+" ("+item.firstname+" "+item.lastname+")",
                value: item.username
            };
    } 
```

在此示例中，显示的值将是用户名 + 名字和姓氏，而实际复制到文本字段中的值将只是用户名。

然后您可以在选择功能中执行此操作：

```
select: function( event, ui ) {
    alert(ui.item.value);
} 
```

另外，在您的代码中，我看不到`val.contacts`变量的来源，因为在您提供的 JSON 中，对象上没有“联系人”字段...

希望这可以帮助。

# facebook - 代表App（FB Graph API）在FB wall（业务页面）上发帖

> ID：12373421
> 
> 赞同：0
> 
> 时间：2012-09-11T15:44:03.517
> 
> 标签：facebook, facebook-graph-api, facebook-wall

我需要代表我的 FB 应用向 FB 业务页面（例如餐厅）发布消息。

用例如下： 1\. 用户去商店 2\. 用户在手机上收到通知并打开它 3\. 用户被重定向到商店的 FB 页面，在那里他可以登录并发布消息或只是发布消息代表应用程序

问题是：应该遵循哪些步骤才能让我的应用程序在商店的 FB 页面上发布？（我在 FB Graph API 文档中找不到这个案例的详细描述）。

任何人都可以建议最好的链接来阅读以获得这个答案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T12:54:27.280

我也尝试过类似的东西。如果您使用 page_id 和页面访问令牌，它可以工作，但在这种情况下，帖子是代表页面本身而不是用户发布的。使用用户访问令牌时，它不起作用。我在某处读到 Facebook 已弃用此类帖子，其中会话用户与发布的 ID 不同。直到现在找不到任何解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:49:45.327

这个： [https ://developers.facebook.com/docs/authentication/applications/](https://developers.facebook.com/docs/authentication/applications/)

虽然，如果您要发布到页面，您可能需要以用户身份进行身份验证，而不是以应用身份进行身份验证。在这种情况下，请参见此处： [https ://developers.facebook.com/docs/authentication/client-side/](https://developers.facebook.com/docs/authentication/client-side/)

此外，如果您以用户身份进行身份验证，您将需要`publish_stream`和`user_likes`权限。几乎不言而喻，用户需要“喜欢”该页面。

# php - Wordpress：首页上不同类别的不同循环

> ID：12373422
> 
> 赞同：0
> 
> 时间：2012-09-11T15:44:04.617
> 
> 标签：php, html, css, wordpress

当我为不同的类别使用不同的循环时，我的设计中出现了错误。[在此处查看实时预览](http://inmyownview.com/wordpress)。“WISHWISHWISH: WHEN IN STOCKHOLM”帖子与“FASHIONTOAST: SPACE CAMP”属于同一类别，但标签“blogger suit for dagen”位于最后提到的帖子的页面顶部！它应该放在帖子的图片下方，就像在“WISHWISHWISH：在斯德哥尔摩时”一样。为什么会这样？

我的代码：

```
<?php get_header(); ?>
<div id="columns">
<div id="frontpage" class="clearfix">   

    <?php 
    query_posts('posts_per_page=9' . '&orderby=date'); 
    while ( have_posts() ) : the_post(); 
    if ( in_category( 'Streetstyle' )) {
        if(condition){ ?>
            <div <?php post_class('pin'); ?>>
                <div class="reader-look">
                    <a href="<?php the_permalink(); ?>"><h1><?php the_title(); ?></h1>
                    <?php if ( has_post_thumbnail() ) {
                        the_post_thumbnail();
                    } 
                    ?> 
                    <div class="clearfix"><tag>Streetstyle</tag></div>
                    </a>
                </div>
            </div>
        <?php }
    } elseif ( in_category( array( 'blogger-outfit' ) )) { //du kan også bruke komma her eks: 'streetstyle', 'ukategorisert'
        if(condition){ ?>
                <div class="reader-look">
                    <a href="<?php the_permalink(); ?>"><h1><?php the_title(); ?></h1>
                    <?php if ( has_post_thumbnail() ) {
                        the_post_thumbnail();
                    } 
                    ?> 
                    <div class="clearfix"><tag>Blogger Outfit For dagen</tag></div>
                    </a>
                </div>

        <?php }
     }
     elseif ( in_category( array( 'video' ) )) { //du kan også bruke komma her eks: 'streetstyle', 'ukategorisert'
        if(condition){ ?>
                <div class="reader-look">
                    <a href="<?php the_permalink(); ?>"><h1><?php the_title(); ?></h1>
                    <?php if ( has_post_thumbnail() ) {
                        the_post_thumbnail();
                    } 
                    ?> 
                    <div class="clearfix"><tag>Video</tag></div>
                    </a>
                </div>

        <?php }
      }
     elseif ( in_category( array( 'tips' ) )) { //du kan også bruke komma her eks: 'streetstyle', 'ukategorisert'
        if(condition){ ?>
                <div class="reader-look">
                    <a href="<?php the_permalink(); ?>"><h1><?php the_title(); ?></h1>
                    <?php if ( has_post_thumbnail() ) {
                        the_post_thumbnail();
                    } 
                    ?> 
                    <div class="clearfix"><tag>Fashion tips</tag></div>
                    </a>
                </div>
        <?php }
      }
     else {
        if(condition){ ?>
        <a href="<?php the_permalink(); ?>">
            <div <?php post_class('pin'); ?>>
                <h1>
                    <?php the_title(); ?>
                </h1>
                <?php if ( has_post_thumbnail() ) {
                    the_post_thumbnail();
                } 
                the_content(' '); ?> 
            </div>
        </a>
    <?php } }
    ?>          
    <?php endwhile;
    // Reset Query
    wp_reset_query(); ?>
</div>
</div> 
```

风格：

```
 #wrapper #frontpage {
    position: relative;
    left: 15px;
}
#wrapper #columns {
    -moz-column-count: 3;
    -moz-column-gap: 40px;
    -moz-column-fill: auto;
    -webkit-column-count: 3;
    -webkit-column-gap: 10px;
    -webkit-column-fill: auto;
    column-count: 3;
    column-gap: 15px;
    column-fill: auto;
}
#wrapper #columns .pin { 
    -moz-column-break-inside: avoid; 
    -webkit-column-break-inside: avoid; 
    column-break-inside: avoid; 
    display: inline-block; 
    width: 360px;
    font: 100 12.5px 'Helvetica';
    line-height: 18px;
    color: #3a3a3a;
    margin-bottom: 20px;
}
.reader-look h1  {
    text-shadow: white 1px 1px 0px;
    margin-bottom: 10px;
    font: 100 24px 'Lato';
    color: #333;
    text-transform: uppercase;
    text-decoration: none;
}
.reader-look h1 a {
    color: #333;
    text-decoration: none !important;
}
.reader-look img {
    width: 360px;
    height: auto !important;
}
tag {
    background: #000;
    color: #FFF;
    padding: 10px;
    display: inline-block;
    font-weight: bold;
    text-transform: lowercase;
    font: 100 16px 'Lato';
    -webkit-font-smoothing: subpixel-antialiased;
    margin-bottom: 20px;
}
#wrapper #columns .pin .more-link {
    margin-top: 10px;
    color: #000;
}
#wrapper #columns .pin img {
    width: 360px;
    height: auto;
}
#wrapper #columns .pin iframe {
    width: 380px !important;
    height: auto !important;
}
#wrapper #columns .pin h1  {
    text-shadow: white 1px 1px 0px;
    margin-bottom: 10px;
    font: 100 24px 'Lato';
    color: #333;
    text-transform: uppercase;
}
#wrapper #columns .pin h1 a {
    color: #333;
    text-decoration: none;
}
#wrapper #columns .pin a {
    color: #333;
    text-decoration: none;
}
#wrapper .pin .heading {
  text-align:center;
  border-bottom:1px solid #dddddd;
  margin-bottom: 20px;
}
#wrapper .pin .heading h1 {
  display:inline-block;
  font: 100 21px 'Lato';
  position:relative;
  top: 12px;
  background:#fff;
  padding:0 12px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T17:24:45.000

您允许列在阅读器内部中断。将此添加到您的 CSS 中：

```
.reader-look{
    -moz-column-break-inside: avoid; 
    -webkit-column-break-inside: avoid; 
    column-break-inside: avoid; 
} 
```

并且您在支持它的浏览器上表现出色。

# java - 如何使用 JGit 遍历 Git 存储库并绘制图形

> ID：12373423
> 
> 赞同：4
> 
> 时间：2012-09-11T15:44:04.833
> 
> 标签：java, scala, jgit

我需要使用 JGit 从 Git 存储库中绘制图表。

我一直在考虑遍历提交的不同方法。我需要能够从分支/提交中绘制图形/图形，并且我还需要能够在任意范围内进行，比如从第 200 次提交到第 250 次提交（跳过最近提交的 200 次） .

我应该如何遍历存储库？使用`RevWalk`? 我想让它保持足够的性能，我想知道是否有一种明确的方法可以很好地做到这一点。

**更新：**基本上，我正在考虑制作类似的东西`git log --graph -n 50 --skip 200`，以创建顺序显示 200-250 次提交之间的存储库图表。现在我只想自己做这件事。:)

**更新 2：**如果我也可以遍历那些悬空的（没有引用），并用灰色绘制它们，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T14:47:19.757

是的，我同意你的看法，你应该使用 RevWalk。JGit 提供了类似于日志调用的瓷器 API，但它在较低层提供了有趣的入口点。

它可能比使用瓷器 API 或任何基于 Git 的方法更有效。

我真的不明白你所说的未引用提交是什么意思。那些不在一个分支？

另一件事是我不确定您是否可以一次查询所有提交，我的意思是您应该查询每个分支，但我想您已经想到了。我一直想知道是否有比查询每个分支更快的方法（如果它们很短并且有一个巨大的共同历史，那会浪费很多时间）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-28T11:10:07.937

我还没有给你答案，但我一直在重新讨论这个话题，因为我曾经有一个算法在 JGit 2.1.0 (2012-09-19) 上工作得相当好，但是几个月后回到我升级到 JGit 5.5.1 (2019-10-02) 并且图表开始看起来很奇怪和损坏。

我一直在研究 JGit 源代码以寻找线索和信息，这个非常冗长和详细的提交消息似乎深入描述了新算法，我只是还没有掌握它。

[https://github.com/eclipse/jgit/commit/7d6dcd4b34fef87d73d7137b2cf66b3e15216a2f](https://github.com/eclipse/jgit/commit/7d6dcd4b34fef87d73d7137b2cf66b3e15216a2f)

如果我这样做，我会尝试用更具体的东西更新这个答案。

# php - 网站迁移到雪豹服务器后出现“未选择数据库”

> ID：12373431
> 
> 赞同：0
> 
> 时间：2012-09-11T15:44:33.253
> 
> 标签：php, mysql, osx-snow-leopard

我正在将网站从 Windows 服务器迁移到雪豹服务器（确切地说是 OSX 10.6.8），并且我的 mysql 查询遇到了几个兼容性问题。每个查询都返回一个*“未选择数据库”*错误，我无法对其进行头脑或故事。我已经对此进行了一些研究，但无法找到我正在寻找的答案。以下是一些可能有助于解决我的问题的指标。

这是我的连接文件包括：

```
$link = mysql_connect("localhost", "username", "password") or die("Invalid query: " . mysql_error());
mysql_select_db("tradeport", $link) or die("Database Connection Error: ".mysql_error()); 
```

这是我的一个查询：

```
$sSQL="SELECT mainPhone FROM admins";
$result21=mysql_query($sSQL) or die ("MySQL err: ".mysql_error()."<br>".$sSQL);

if($row21 = mysql_fetch_array($result21))
{$phoneMain = $row21['mainPhone'];} 
```

我想补充的另一个注意事项是，当我开始在此站点上迁移时，所有 php 都显示在页面源代码中。我必须用更正式的括号替换所有 php 括号，如下所示：

```
<? //before

<?php //after 
```

我目前正在运行 PHP 5.3.8 版和 MySQL 5.0.92 版。

任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:47:58.837

尝试将数据库名称添加到查询中

```
"SELECT mainPhone FROM tradeport.admins" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:50:22.137

`mysql_*`在您的或`mysqli_*`（您应该使用的）函数调用中引用您的数据库连接始终是一个好习惯。

尝试：

```
$result21=mysql_query($sSQL, $link) or die ("MySQL err: ".mysql_error()."<br>".$sSQL); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T16:01:01.290

您说您看到错误消息“未选择数据库”，这让我想知道您是否真的在执行 mysql_select_db 代码行，因为它的错误消息是“数据库连接错误：”，然后是 mysql 错误代码。

另外，包含文件在哪里获取用户名和密码的值？您刚刚引用了文字字符串，起初我认为这是出于安全目的。

我认为您提供的代码片段并没有向我们展示全貌。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T16:07:29.977

> 我已经尝试过了，它给了我这个错误作为回报：SELECT command denied to user ''@'localhost' for table – Trig3rz 20 分钟前

检查数据库用户是否设置了正确的权限 GRANT SELECT ON db.* TO user@'localhost' IDENTIFIED BY 'pass';

您可能想检查原始服务器上的 php.ini 文件，看看有什么不同。 `<?`是 php 短标签，它在 php ini 文件中使用以下行启用：

```
short_open_tag=On 
```

# oracle - 在参数表单触发oracle报告后设置参数值

> ID：12373432
> 
> 赞同：1
> 
> 时间：2012-09-11T15:44:34.467
> 
> 标签：oracle, plsql, report

我正在尝试根据用户在参数表单中输入的参数将参数设置为一个值。在这个触发器中设置参数值的 PL/SQL 语法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:20:17.860

简单地，

```
:parameter_to_set := <some value>; 
```

如果“某个值”基于用户输入的参数，您可以以相同的方式引用该参数，即前面加一个冒号：

```
:parameter_to_set := :user_param; -- for example 
```

# selenium - 如何验收测试受验证码保护的 Web 应用程序功能？

> ID：12373434
> 
> 赞同：5
> 
> 时间：2012-09-11T15:44:34.530
> 
> 标签：selenium, captcha, pyramid, recaptcha, acceptance-testing

我想为我网站上的某个功能添加验证码，例如 reCaptcha。我该如何调整我的验收测试？

是在临时站点上禁用验证码的唯一解决方案吗？

澄清：

当然，我不是说暴力破解我自己的验证码，而是说一些选项可以从我的测试知道的服务器端将状态注入验证码。

PS 我的服务器端代码使用 Pyramid 框架，我的测试是使用 Selenium 编写的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T15:53:28.350

是的，唯一的选择是禁用验证码 - 有一个很好的理由。如果用 Selenium 很容易绕过它，那你为什么要首先使用 Captcha？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T02:10:35.320

重点不是用您的 Selenium 测试来测试 Captcha —— 为什么要花费大量精力来测试第三方工具？

相反，我会进行 Selenium 测试来验证您的验证码是否出现。这可以验证您的验证码是否存在且处于活动状态。在那次测试之后，我会关闭验证码并继续进行其他验证测试。我还有最后一步是重新打开 Captcha 并重复检测 Captcha 处于活动状态的测试。这样您就可以确保在重新激活验证码时不会错过任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-10T12:01:26.300

使用输入框中的测试代码禁用 CAPTCHA。如果验证码失败但与测试代码匹配，请继续。

# c# - 这会导致内存泄漏吗？

> ID：12373438
> 
> 赞同：0
> 
> 时间：2012-09-11T15:44:39.137
> 
> 标签：c#, memory-leaks

如果我在公共类中声明这样的静态队列：

```
public class c
{
  private string[] s={"a","b","c"};
  private static Queue<string> q = new Queue<string>(s);

  static private void SomeMethod()
  {
     private string[] s2 = {"123","345"};
     // somewhere in here I reassign the queue q = new Queue<string>(s2);
  }
} 
```

我的操作会导致 C# 中的内存泄漏吗？垃圾收集会收回可能未使用的内存吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T15:45:59.810

不会。没有任何东西会导致泄漏。

一旦`q`引用的对象不再在任何地方引用，它将被适当地垃圾收集。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-11T15:46:00.370

它不应该导致内存泄漏。原始队列由垃圾收集器释放。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T15:46:50.813

如果“q”引用的任何对象不再在任何地方引用，垃圾收集器将收集它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T15:56:45.957

您可能值得花时间阅读有关垃圾收集及其工作原理的众多文章之一，例如[http://msdn.microsoft.com/en-us/magazine/bb985010.aspx](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx)

不过，要回答您的问题，不 - 这不会导致内存泄漏。

# sql-server-2005 - 使用 ISNULL 的可选 where 子句

> ID：12373440
> 
> 赞同：1
> 
> 时间：2012-09-11T15:44:44.653
> 
> 标签：sql-server-2005

我有存储过程采用多个参数（在某些情况下最多 7 或 8 个）用于过滤结果集。这些参数是可选的（默认`NULL`）。传入的所有非 NULL 值都将在过滤器中使用（即它是 boolean`and`而不是 boolean `or`）。

这些查询通常最终看起来像这样......

```
SELECT *
FROM [MyTable]
WHERE (@Param1 IS NULL OR (@Param1 IS NOT NULL AND [Field1] = @Param1))
      AND (@Param2 IS NULL OR (@Param2 IS NOT NULL AND [Field2] = @Param2))
      AND (@Param3 ... 
```

我知道这是非常低效的，但是由于参数的数量，它不可能将它们分成单独的查询。

因此，我尝试执行以下操作...

```
SELECT *
FROM [MyTable]
WHERE [Field1] = ISNULL(@Param1, [Field1])
      AND [Field2] = ISNULL(@Param2, [Field2])
      AND [Field3] ... 
```

但是，当字段包含时会出现问题`NULL`，因此`=`运算符根本不起作用。

有没有一种简单而有效的方法来做到这一点，以便我可以使用多个“过滤器”参数进行单个查询？如果可能的话，我宁愿不使用动态 SQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:22:09.477

好吧，您可以将初始 SQL 简化为这个，因为您已经`NULL`在每个子句中进行了测试。

```
SELECT *
FROM [MyTable]
WHERE (@Param1 IS NULL OR [Field1] = @Param1)
      AND (@Param2 IS NULL OR [Field2] = @Param2)
      AND (@Param3 ... 
```

这不一定是低效的。如果您经常传入导致执行计划大相径庭的参数组合，您可能会明智地检查参数嗅探问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T18:52:21.193

使用“is null”的替代方法是进行此比较：

```
where coalesce(Field1, @Param1, '') = coalesce(@Param1, Field1, '') . . . 
```

如果 Field1 或 @Param1 之一具有值，则两个 COALESCE 返回该值。只有当两者都为 NULL 时，你才能进入第三个参数。

It so happens that you can convert `''` to any type, so that is also covered. However, the use of the function tends to preclude the user of indexes.

# xml - xsd 用于必需和可选元素

> ID：12373444
> 
> 赞同：1
> 
> 时间：2012-09-11T15:45:00.730
> 
> 标签：xml, xsd

支持以下 xml 的 xsd 定义是什么？

```
<xml>
    <RequiredElementA></RequiredElementA>
    <RequiredElementB></RequiredElementB>
    <RequiredElementC></RequiredElementC>
    <OptionalElementD></OptionalElementD>
    <OptionalElementE></OptionalElementE>
</xml> 
```

我希望前 3 个是必需的，但后两个是可选的。订单无关紧要（但订单是/否不是要求）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:11:49.310

如果孩子的顺序没有传达任何信息，通常最简单的方法是修复一个顺序。

```
<xs:complexType name="fixedOrder">
  <xs:sequence>
    <xs:element ref="RequiredElementA"/>
    <xs:element ref="RequiredElementB"/>
    <xs:element ref="RequiredElementC"/>
    <xs:element ref="RequiredElementD" minOccurs="0"/>
    <xs:element ref="RequiredElementE" minOccurs="0"/>
  </xs:sequence>
</xs:complexType> 
```

如果订单带有信息（例如，您正在记录用户的 A、B、C 等级排序，并带有包含 D 和 E 的选项），您可以使订单不受约束。

```
<xs:complexType name="variableOrder">
  <xs:all>
    <xs:element ref="RequiredElementA"/>
    <xs:element ref="RequiredElementB"/>
    <xs:element ref="RequiredElementC"/>
    <xs:element ref="RequiredElementD" minOccurs="0"/>
    <xs:element ref="RequiredElementE" minOccurs="0"/>
  </xs:all>
</xs:complexType> 
```

有些人想要不受约束的秩序，即使它没有传达任何信息；这使得数据源不必查找规定的顺序成为可能，但代价是验证更加复杂。

# mongodb - 了解 mongodb 中的实际块大小

> ID：12373445
> 
> 赞同：8
> 
> 时间：2012-09-11T15:45:01.107
> 
> 标签：mongodb, sharding

我试图在我的一个分片集合中找到所有块的大小。

我想知道**真正的** 大小，而不是作为我知道我可以找到的设置给 mongos 的提示：

```
use config
db.settings.find({_id : "chunksize"}) 
```

我尝试了几种解决方案，但*计数*操作非常慢，所以这并不容易。你知道解决方案吗？（shell、csharp、python、ruby、bash，我不在乎）

现在我已经测试了以下内容：

```
db.getSisterDB("config").chunks.find({ns : "mydb.mycollection"}).forEach(function(chunk) {
     db.getSisterDB("mydb").mycollection.find({},{_id : 0, partnerId , 1, id : 1}).min(chunk.min).max(chunk.max).count()
}) 
```

但这太慢了，我的印象是它不使用我的分片键上的索引（它是 on `{partnerId : 1, id : 1}`）。

我也用解释代替了*计数**，*但没有任何运气。我还用javascript *forEach替换了**计数*以手动计数（尝试使用不会命中磁盘的*indexOnly查询）。*

 ***我试图找到真正的大小，因为我看到有几个块远远高于作为提示给出的块大小（2Gb 而不是 64Mb）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T04:30:24.293

我认为最能帮助你的命令是[`datasize`](http://docs.mongodb.org/manual/reference/command/dataSize/)命令。这里仍然有一个警告，该命令将需要更长的时间才能在较大的集合中运行，因此您的里程可能会有所不同。

鉴于此，您可以尝试类似以下的操作：

```
var ns = "mydb.mycollection" //the full namespace of the collection
var key = {partnerId : 1, id : 1} //the shard key of the collection

db.getSiblingDB("config").chunks.find({ns : ns}).forEach(function(chunk) {
        var ds = db.getSiblingDB(ns.split(".")[0]).runCommand({datasize:chunk.ns,keyPattern:key,min:chunk.min,max:chunk.max});
        print("Chunk: "+chunk._id +" has a size of "+ds.size+", and includes "+ds.numObjects+" objects (took "+ds.millis+"ms)")
    }
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T08:03:03.333

经过一些尝试，没有比在 <2.2 版本中使用计数更简单的方法了以下是我与复合分片键 (partnerId, id) 一起使用的脚本。

```
var collection = "products";
var database = "products";
var ns =database+"."+collection;
rs.slaveOk(true)
db.getSiblingDB("config").chunks.find({ns : ns}).forEach(function(chunk) {
  pMin = chunk.min.partnerId
  pMax = chunk.max.partnerId
  midR = {partnerId : {$gt : pMin , $lt : pMax}}
  lowR = {partnerId  : pMin,  id : {$gte : chunk.min.id}}
  if (pMin == pMax) lowR.id = {$gte : chunk.min.id, $lt : chunk.max.id}
  upR  = {partnerId  : pMax,  id : {$lt : chunk.max.id}}
  a = db.getSiblingDB(database).runCommand({count : collection, query : lowR, fields :    {partnerId :1, _id : 0}}).n 
  b = db.getSiblingDB(database).runCommand({count : collection, query : midR, fields :    {partnerId :1, _id : 0}}).n 
  c=0
  if (pMin != pMax)
    c = db.getSiblingDB(database).runCommand({count : collection, query : upR, fields :    {partnerId :1, _id : 0}}).n 
  print(chunk.shard + "|"+tojson(chunk.min) +"|" +tojson(chunk.max)+"|"+a +"|"+b+"|"+ c     +"|"+(a+b+c))
  }) 
```***

# python - 正则表达式自动在函数输入上运行？

> ID：12373446
> 
> 赞同：1
> 
> 时间：2012-09-11T15:45:02.743
> 
> 标签：python, regex, function

所以，我搜索了一段时间，找不到任何东西，所以我决定求助于 SO 的专家来帮助我澄清发生了什么。

我正在学习 Python，在学习正则表达式的同时，我遇到了一些我不太明白的有趣语法。在此示例中，定义了一个函数，该函数在输入参数上运行正则表达式，将匹配的整数作为浮点数返回，或者如果输入与看起来像数字的内容不匹配，则抛出异常：

```
import re
def getNumber(token):
  r'-?[1-9][0-9]*.?[0-9]*'
  return float(token) 
```

这个函数可以这样调用：

```
print getNumber('123.123')
print getNumber('123.123')+40 
```

这将输出：

```
123.123
163.123 
```

我试图了解这是如何发生的机制。我知道我们正在通过调用 r'STRING' 来声明一个正则表达式对象，但不知何故，只是声明该正则表达式会导致令牌参数也被传递到表达式中。这是具有明确包含称为“令牌”参数的函数的特征吗？是否存在与多个参数相关的行为？似乎这里已经做了一些工作来提供 python 语法，我只想知道它是如何工作的以及将来如何使用它的细节。将我指向文档会很棒，因为我找不到有关该主题的任何内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T15:46:42.007

此函数没有在输入上运行正则表达式......它正在调用`float`将输入转换为浮点数的输入。函数上的“正则表达式”只不过是一个文档字符串。

请注意，`r"this is a string"`只需创建一个与正则表达式无关的“原始字符串”（`"\t"`是制表符，`r"\t"`而是文字字符`'\'`和`'t'`）。

# sql - SQL，两张表，一张共享主键

> ID：12373451
> 
> 赞同：1
> 
> 时间：2012-09-11T15:45:20.350
> 
> 标签：sql, shared-primary-key

我想要两个表，这样我就可以将旧记录移动到第二个表中，这样我就可以保持主表很小，但仍然希望能够使用一个 int 主键链接到两个表。

例如：（我已经根据我的真实表中的内容简化了这个示例）我正在跟踪会话并希望将过期的会话移动到 Expired_Sessions 表中，但我还将会话链接到像 Login_Attempts 表这样的日志表，但我没有不想破坏这些表的链接。

```
Sessions
--------------------
PKey       | int
Session_ID | varchar

Expired_Sessions
--------------------
PKey       | int
Session_ID | varchar

Login_Attempts
--------------------
Session_FKey | int
Count        | int 
```

我确实想到了两种可行的方法，但我认为应该有更好的方法来做到这一点？

一：在我的 sys_constants 表中存储一个主键计数器，并在每次添加记录时递增它。或者

二：添加另一个表，将会话表主键和过期会话主键链接到第三个主键，然后使用第三个主键链接到我的日志表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:57:41.647

您是否考虑过使用表分区？我对您的要求知之甚少，但可能值得调查。

> 当表和索引变得非常大时，分区可以通过将数据划分为更小、更易于管理的部分来提供帮助。本文重点关注水平分区，其中大组行将存储在多个单独的分区中。分区集的定义是根据您的需要定制、定义和管理的。Microsoft SQL Server 2005 允许您使用定义的范围或列表基于特定的数据使用模式对表进行分区。SQL Server 2005 还通过添加围绕新表和索引结构设计的功能，为分区表和索引的长期管理提供了许多选项。

[http://msdn.microsoft.com/en-us/library/ms345146(v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms345146%28v=sql.90%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:51:52.300

为什么不为每个表保留单独的主键，而是添加另一列作为会话的唯一标识符，无论它在哪个表中？我看到你有 Session_ID ...如果你索引它，你甚至可以用它来查找。

# email - 从目标文件夹/文件中提取电子邮件地址的批处理脚本

> ID：12373452
> 
> 赞同：3
> 
> 时间：2012-09-11T15:45:24.940
> 
> 标签：email, batch-file, cmd, extract

**程序：**命令提示符 (CMD) 批处理脚本

我有一个文件夹，里面有很多文件。在这些文件中，有许多电子邮件地址与其他杂项混合在一起。文字垃圾。我想要一种从**每个**文件中提取这些电子邮件地址并创建一个新文件 (.txt) 的方法，其中每个文件都尽可能清楚地列出。

我已经花了几个小时找到一个像样的正则表达式'代码'：“ **[.AZ-_] *@[.AZ-_]*** ”

这个表达来自似乎令人惊讶的是谷歌可以检测到的关于这个主题的唯一其他论坛主题——我觉得这很令人震惊。该线程可以在这里找到： [https ://stackoverflow.com/questions/7911482/extract-email-from-text-file-using-batch-job](https://stackoverflow.com/questions/7911482/extract-email-from-text-file-using-batch-job)

在那个线程上，一些名叫**Hand-E-Food**的人创建了以下 .bat 脚本来从选定的文件/文件夹中提取电子邮件地址：

```
@Echo Off
For /F "tokens=*" %%A In ('FindStr /R /I "[\.A-Z\-_]*@[\.A-Z\-_]*" "results.txt"') Do Call :ExtractEmail "%%A"
Exit /B

:ExtractEmail
Set "Email=%~1"
Set "Email=%Email:*<=%"
Set "Temp=%Email:*>=>%"
Call Set "Email=%%Email:%Temp%=%%"
Echo %Email%>emails.txt
Exit /B 
```

令人惊讶的是，他忽略了对他的代码进行完全错误测试，遗憾的是它不起作用 - 正如原始海报所提到的那样。恼人的是，他从来没有回应纠正他的错误，现在这个话题已经结束了。

这把我们带到了这里：一个新的话题，问同样的问题，本应在 2011 年回答，但没有。因此，如果任何人都可以帮助解决我认为可能是相当简单的代码，而我*认为这*是一种非常有用的能力，请向我们提供您的专业知识。

**PS**请不要像**Hand-E-Food**一样忽略仔细检查您的代码是否有效。此外，我在命令提示符方面有少量经验，但是许多查看此线程的用户将没有任何经验，因此请在您的代码中使用一些符号来解释 - 至少稍微解释一下 - 发生了什么。

记住：我们没有人知道我们现在所知道的一切，只有通过善良的人，他们向我们**充分**解释了如何做我们从一开始就学到的东西。请**充分**解释。

非常感谢，

一步步

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T16:51:18.370

好吧，这是一个可以解决问题的替代脚本：

```
@echo off
set INPUT_FILE=results.txt
set OUTPUT_FILE=emails.txt
set "REGEXP=[\.A-Z\-_][\.A-Z\-_]*@[\.A-Z\-_][\.A-Z\-_]*"
>nul copy nul %OUTPUT_FILE%
for /f "tokens=*" %%a in (%INPUT_FILE%) do for %%b in (%%a) do (
    for /f %%z in ('echo %%b ^| findstr /R /I "%REGEXP%"') do (
        echo %%z >> %OUTPUT_FILE%
    )
) 
```

这很简单：外部循环遍历 in 中每一行中以空格分隔的字符串，`INPUT_FILE`内部循环使用您的正则表达式过滤电子邮件并将它们附加到`OUTPUT_FILE`.

希望能帮助到你！

**编辑：**我改进了正则表达式，以便它更准确地捕获电子邮件模式。它仍然不完美，但如果您对更好的表达方式感兴趣，可以查看[此站点。](http://www.regular-expressions.info/email.html)

# html - 字体大小到底是多少？

> ID：12373460
> 
> 赞同：1
> 
> 时间：2012-09-11T15:45:42.023
> 
> 标签：html, css, web, photoshop, typography

> **可能重复：**
> [CSS 字体大小细节](https://stackoverflow.com/questions/11073602/css-font-size-specifics)

我一直想知道网页设计的字体大小到底是多少。
我的意思是，如果我将字体大小设置为 25px，我的文字高度会是 25px 吗？
因为我用 Photoshop 尝试过，如果我将字体大小设置为 30 像素，常规大写字母（例如：“B”）将是 24 像素高，常规字母（例如：“a”）将是 19 像素高和“j” " 将是 27px 高。
那么字体大小到底是什么意思呢？
编辑：我的问题可能不清楚，你如何根据 font-size 计算字母的高度？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T15:49:26.360

它表示以“I”等最高字母的顶部和“p”等下降字符的底部作为参考的大小

[您可以在此页面](http://css-tricks.com/css-font-size/)上找到更多信息

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T09:51:22.523

如果您想计算某个文本的高度，这可能会有所帮助：

[http://daipratt.co.uk/calculate-text-width-and-height-with-javascript/](http://daipratt.co.uk/calculate-text-width-and-height-with-javascript/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-11T16:46:03.600

如果您在 em 中设置字体大小，它将在所有浏览器中显示相同的大小，并且在缩放功能中也会显示。

Serif Serif 字体在某些字符（Times New Roman）的末端有小线宽度（Courier New、Lucida Console）

# javascript - 无法将 jQuery 转换为用户脚本的纯 Javascript

> ID：12373462
> 
> 赞同：0
> 
> 时间：2012-09-11T15:45:51.603
> 
> 标签：javascript, jquery, userscripts

好的，这就是交易：我正在尝试创建一个用户脚本以在 Greasemonkey/Chrome/人们用来管理这些东西的任何其他东西中使用。我想做的一部分是为我为这个特定脚本设计的图标创建标签。我至少对如何在 Jquery 中完成此任务有一个粗略的了解。我会使用的代码是这样的：

```
$('li.tab.iconic').each(function (i) {
    var spanName = $('this').attr(id);
    var toRemove = '_button';
    var spanNameCrop = spanName.replace(toRemove,'');
    $('this').append('<span class="tooltip_label">'+spanNameCrop+'</span>');
}); 
```

基本上，我想获取`id`each 的属性，`li`从中修剪短语“_button”，然后将剩余的文本插入将成为标签的跨度中。我的问题是我搜索了高低，但没有找到关于如何在 javascript 中执行这样的循环的明确说明。甚至可能吗？

或者，我正在设计的网站确实包含 Jquery 库。有没有办法告诉我的脚本在站点加载 jquery 后加载，以便 jquery 脚本可以工作？

编辑：感谢 Avladov 让它工作。这是最终的脚本。

```
var jQuery, $ = null;

function addJQuery(callback) {
var p = null;

if(window.opera || window.navigator.vendor.match(/Google/)) {
    var div = document.createElement("div");
    div.setAttribute("onclick", "return window;");
    p = div.onclick();
}
else {
    p = unsafeWindow;
}

jQuery = $ = p.jQuery.noConflict();
callback();
}

var myFunction = function() {
jQuery('#header .tab.iconic[id!="missinge_button"] a').css({"background-image":"url('http://i.imgur.com/2QmZG.png')"});

jQuery('#header .tab.iconic').each(function (i) {
    var tabID = jQuery(this).attr('id');
    var labelName = tabID.replace('_button','');
    if (jQuery(this).find('span[class="tooltip_label"]').length){
    }
    else{
    jQuery(this).append('<span class="tooltip_label">'+labelName+'</span>');
    jQuery('.tooltip_label').css({'text-transform':'capitalize'});
    }
});

};

addJQuery(myFunction); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:49:32.900

你不想使用`'this'`你想使用`this`，如果 id 不是一个带有值的变量字符串，你希望它是一个字符串：

```
$('li.tab.iconic').each(function (i) {
    var spanName = $(this).attr('id');
    var toRemove = '_button';
    var spanNameCrop = spanName.replace(toRemove,'');
    $('this').append('<span class="tooltip_label">'+spanNameCrop+'</span>');
}); 
```

如果该站点不使用 jQuery，您可以为它们包含 jQuery，例如：

```
if(!(window.jQuery && window.jQuery.fn.jquery == '1.8.1')) {var s = document.createElement('script');s.setAttribute('src', 'http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js');s.setAttribute('type', 'text/javascript');document.getElementsByTagName('head')[0].appendChild(s);} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:56:49.540

如果您的 Greasemonkey 脚本用于使用 jQuery 的站点，那么您可以在脚本中使用它。使用此代码：

```
var jQuery, $ = null;

function addJQuery(callback) {
    var p = null;

    if(window.opera || window.navigator.vendor.match(/Google/)) {
        var div = document.createElement("div");
        div.setAttribute("onclick", "return window;");
        p = div.onclick();
    }
    else {
        p = unsafeWindow;
    }

    jQuery = $ = p.jQuery.noConflict();
    callback();
} 
```

**回调是****Greasemonkey 脚本**中的一个函数。完成此操作后，您可以将**jQuery**与**jQuery**和**$**一起使用，就好像它是一个普通的网页 JavaScript。

这种方法的好处是它不仅适用于 Firefox，也适用于 Chrome 和 Opera。它也不会加载新的 jQuery 脚本，而是重用网页中的那个。

**例子：**

```
var myFunction = function() {
    // Your code here
};

addJQuery(myFunction); 
```

**编辑：**
有一种方法可以通过在脚本元数据块中使用**@include**和**@match来限制脚本。**
您可以在 GM Wiki 上阅读更多相关信息 - [http://wiki.greasespot.net/Metadata_Block](http://wiki.greasespot.net/Metadata_Block#.40include)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T15:48:42.790

在 document.ready 函数中添加您的 jquery 脚本

```
$(document).ready(function(){
$('li.tab.iconic').each(function (i) {
    var spanName = $('this').attr('id');
    var toRemove = '_button';
    var spanNameCrop = name.replace(toRemove,'');
    $(this).append('<span class="tooltip_label">'+spanNameCrop+'</span>');
});
}) 
```

当页面上的所有资源都被抓取时，代码现在将执行

你可以在这里阅读更多：http: [//api.jquery.com/ready/](http://api.jquery.com/ready/)

# wolfram-mathematica - 使用应用于每个元素的操作创建新列表？

> ID：12373467
> 
> 赞同：2
> 
> 时间：2012-09-11T15:46:06.033
> 
> 标签：wolfram-mathematica

我有一个包含元素的列表：

> 数据 = {{1, 2}, {2, 7}, {3, 14}}

这是 X 和 Y 坐标的列表，稍后用于 ListPlot。

对于所有 Y 坐标，我基本上想做 Y = 1 / Y，所以一个新列表变为：

> DataNew={{1, 1/2}, {2, 1/7}, {3, 1/14}}

我该怎么做这样的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-15T15:58:26.050

我`data = {{1, 2}, {2, 7}, {3, 14}}`建议：

```
{#, 1/#2} & @@@ data 
```

或者，您可以使用：

```
Replace[data, {x_, y_} :> {x, 1/y}, {1}] 
```

我建议不要使用以下任何一种：

```
data /. {x_, y_} -> {x, 1/y}

Cases[data, {x_, y_} -> {x, 1/y}] 
```

两者都错误地使用`Rule`而不是`RuleDelayed`，这意味着它们无法本地化命名模式。此外，第一个不好，因为它引入了歧义：

```
{{1, 2}, {2, 7}} /. {x_, y_} :> {x, 1/y} 
```

> ```
> {{1, 2}, {1/2, 1/7}} 
> ```

第二个不那么麻烦，但恕我直言，因为`Cases`它是一个过滤功能，它不应该在你真正想要的地方使用`Replace`，因为这会使代码不太清晰。

* * *

Leonid 提醒我们，我推荐的方法在可能的情况下不会自动编译（例如实数的打包数组）。如果性能很关键，通常使用`Transpose`下面比较的双重方法是最快的。

```
dat = RandomReal[99, {50000, 2}];

Do[ {#, 1/#2} & @@@ dat , {50}] // Timing

Do[ Transpose[{#, 1/#2} & @@ Transpose@dat] , {50}] // Timing 
```

> {2.074，空}
> 
> {0.032，空}

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T16:03:39.607

您可以使用 ：

```
{#[[1]], 1/#[[2]]} & /@ Data 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-11T16:47:01.010

Also for example:

```
data = {{1, 2}, {2, 7}, {3, 14}};
newData = data /. {x_, y_} -> {x, 1/y} 
```

or

```
newData = Cases[data, {x_, y_} -> {x, 1/y}] 
```

or

```
f[{a_, b_}] := {a, 1/b};
newData = f /@ data 
```

and zillions of other possibilities.

Remember to start all your defined names with lowercase letters!

# c# - 按下 Enter 键时防止对焦关闭按钮

> ID：12373472
> 
> 赞同：1
> 
> 时间：2012-09-11T15:46:23.720
> 
> 标签：c#, wpf

我正在处理 myDialog1_KeyDown 事件，如果按下 Enter 键，我的方法会将焦点移至下一个元素，如下所示：

```
UIElement focusedElement = Keyboard.FocusedElement as UIElement;
if (focusedElement != null)
{
    if(focusedElement.MoveFocus(newTraversalRequest(FocusNavigationDirection.Next)))
    e.Handled = true;
} 
```

myDialog1 是 myDockBase 对象。myDockBase 是一个扩展 DXWindow 的类，用于应用程序中的每个模态对话框。

然后问题是当用户位于最后一个字段时 - 当他按下 Enter 键焦点移动到关闭按钮（最小化和最大化按钮被隐藏）然后如果他再次按下 Enter 窗口将关闭。

编辑：我想要什么：如果关闭按钮被聚焦，则不允许用户在按下回车键时关闭窗口或不要将焦点移至关闭按钮

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T18:36:24.280

一个解决方案可能是禁止关闭按钮获得焦点，假设您不需要它。请参阅[可聚焦](http://msdn.microsoft.com/en-us/library/system.windows.iinputelement.focusable.aspx)属性。如果您在代码中创建按钮：`closeButton.Focusable = false`. 如果在 XAML 中：`<Button Focusable="false" Command="...">Close</Button>`. 这样，当您导航焦点时，关闭按钮不会出现在循环中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:13:28.873

你没有说你期望会发生什么。您可以检查当前控件是否是最后一个字段（您必须有一个 ID）。如果用户当前在最后一个字段中，请不要前进到下一个字段。

# asp.net - PDF文件的301重定向

> ID：12373482
> 
> 赞同：0
> 
> 时间：2012-09-11T15:46:50.833
> 
> 标签：asp.net, iis, redirect, iis-6

像这样重定向 URL 的最简单方法是什么：

```
http://domain.tld/my%20file.pdf 
```

到另一个网址：

```
http://anotherdomain.tld/another%20file.pdf 
```

这是一个网站，我可以访问 IIS (6)。有没有办法在 IIS 中做到这一点？

我读过一些关于 ISAPI 插件的文章，虽然我从来没有这样做过。这是唯一的方法吗？我已经收到了一个我还不能建立的网站（只是在 VS 2010 中使用 Open Website...。）所以我什至不确定我是否可以编写一个 HTTP 模块，如果这是另一种选择。我当前的错误与具有另一个 web.config 的英文部分有关。

**错误 6 在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。C:\path\to\site\englishsubdirectory\app\Web.config**

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-09-11T16:14:43.193

检查这个：[http ://microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/](http://microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/)

或者这个：[如何在 IIS 中重定向 URL 路径？](https://stackoverflow.com/questions/888325/how-to-redirect-a-url-path-in-iis)

# video - FFMpeg 生成静态视频

> ID：12373485
> 
> 赞同：1
> 
> 时间：2012-09-11T15:47:06.527
> 
> 标签：video, ffmpeg, thumbnails, ffprobe

我正在对 ffmpeg 做一个简单的测试。我想将它用于我正在开发的网站的缩略图生成/视频抓取。我目前正在使用 VLC 来抓取单帧然后生成缩略图，但它相当慢而且有点麻烦。

问题是我正在使用的视频（来自我自己的电脑）是由安全摄像头软件生成的，它的视频格式很奇怪。当我在 VLC 中打开它（.bvr）时，它播放得非常非常快。一个 10 秒的视频大约需要 2.5 秒。此外，使用 ffmpeg "ffmpeg -i test.bvr output.avi" 进行简单转换会生成适当长度的视频（10 秒），但视频帧永远不会改变。（这是静止图像）

测试文件和测试输出文件：

*   [https://dl.dropbox.com/u/95418255/test.bvr](https://dl.dropbox.com/u/95418255/test.bvr)
*   [https://dl.dropbox.com/u/95418255/output.avi](https://dl.dropbox.com/u/95418255/output.avi)

我认为这主要是由于 IP 摄像机可能只产生 5-7 fps 但安全软件不知道更好并且将其写入好像应该是 24/30 fps。

> FFMpeg 报告：[m4v @ 00000000002cec60] 从比特率估计持续时间，这可能是不准确的输入 #0，m4v，来自“test.bvr”：持续时间：N/A，开始：0.000000，比特率：N/A 流 #0:0 ：视频：mpeg4（简单配置文件）、yuv420p、640x480 [SAR 1:1 DAR 4:3]、5 tbr、1200k tbn、5 tbc 输出 #0、avi 到“output.avi”：元数据：ISFT
> ：Lavf54。 25.104 Stream #0:0: Video: mpeg4 (FMP4 / 0x34504D46), yuv420p, 640x480 [SAR 1:1 DAR 4:3], q=2-31, 200 kb/s, 5 tbn, 5 tbc 流映射：
> 
> Stream #0:0 -> #0:0 (mpeg4 -> mpeg4) 按 [q] 停止，按 [?] 寻求帮助 frame= 50 fps=0.0 q=2.0 Lsize= 244kB time=00:00:10.00 bitrate= 199.7kbits/s 视频：237kB 音频：0kB 字幕：0 全局标题：0kB 复用开销 2.877066%**

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:02:19.607

不是真正的编程问题。但无论如何，这是我的输入。产生的内容是 mpeg4 基本流。因此，vlc 无法以正确的帧速率播放它。

其次，您的视频是一个静态帧，仅具有一次照明变化，并且时间码在右下角从 21 秒增加到 32 秒。那么你是说你的输出视频没有右下角的时间码改变吗？

编辑：vlc 也无法为我播放。但是 ffplay 可以在我的最后播放它，你也可以使用 ffmpeg 在任何你想要的地方抓取缩略图。

编辑：这也适用于 vlc：

ffmpeg -i input.dvr -vcodec mpeg4 output.avi

这也适用于 vlc。一件事是你也应该给出目标比特率和分辨率。

# python - 如何使用 Cairo 将图像转换为灰度

> ID：12373489
> 
> 赞同：2
> 
> 时间：2012-09-11T15:47:21.733
> 
> 标签：python, cairo

我想将可能带有 alpha 通道的图像转换为 cairo。

我编写的代码将完全不透明的图像转换为灰度，但当图像包含 alpha 通道时失败：

```
import cairo
CAIRO_OPERATOR_HSL_LUMINOSITY = 28  # my py2cairo seems outdated

def convert_to_grayscale(img_in):
    img_out = img_in.create_similar(
        cairo.CONTENT_COLOR_ALPHA, img_in.get_width(), img_in.get_height())
    cr = cairo.Context(img_out)
    cr.set_source_rgba(1, 1, 1, 1)
    cr.paint()
    cr.set_source_surface(img_in)
    cr.set_operator(CAIRO_OPERATOR_HSL_LUMINOSITY)
    cr.paint()

    return img_out 
```

包含 RGBA 值（20、30、40、255）的图像将（正确）转换为（28、28、28、255）。但是，如果图像不是完全不透明，结果将是错误的，例如，如果我用颜色 (10, 15, 20, 128) 转换图像，我会返回 (141, 141, 141, 25)，当我期待 (14, 14, 14, 128)[*]。我怎样才能得到一个可以很好地处理半透明图像的 convert_to_grayscale 版本？

[*] 请注意，这些值的 RGB 值与它们的 alpha 值相乘，这在开罗很常见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T21:49:59.677

我今天也尝试做同样的事情，并想出了一种不同的方法来做到这一点。我实际上并没有在 Python 中这样做，实际上我根本不懂 Python，所以我无法提供任何代码。但是，这就是我所做的：

*   从原始图像创建表面
*   为该表面创建图案
*   使用 CAIRO_OPERATOR_HSL_SATURATION 应用 rgb 源（黑色），使用模式作为掩码

为了让事情更清楚，在 C 中它的意思是这样`s`的（新的 cairo_surface_t`cr`及其相关的 cairo_t 在哪里；假设您已经将原始图片放在那里）：

```
cairo_pattern_t *pattern = cairo_pattern_create_for_surface (s);
cairo_rectangle (cr, 0, 0, width, height);
cairo_set_source_rgb (cr, 0, 0, 0);
cairo_set_operator (cr, CAIRO_OPERATOR_HSL_SATURATION);
cairo_mask (cr, pattern);
cairo_pattern_destroy (pattern); 
```

在此处添加它以防万一/希望它可能对某些人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T10:38:16.563

我终于设法使用 NumPy 转换了尊重原始 alpha 的图像。我在 cairo 邮件列表中询问过，但我得到的唯一替代方案与我的版本有相同的问题（即，它不尊重原始 alpha 通道）。

这是我的解决方案：

```
import cairo
import numpy
import sys

def convert_to_grayscale(img_in):
    """Convert an image to grayscale.

    Arguments:
        img_in: (cairo.ImageSurface) input image.

    Return:
        (cairo.ImageSurface) image in grayscale, in ARGB32 mode.

    Timing:
        ~100ms to convert an image of 800x800

    Examples:
        # returns a B&W image
        >>> convert_to_grayscale(cairo.ImageSurface.create_from_png('test.png'))
    """
    a = numpy.frombuffer(img_in.get_data(), numpy.uint8)
    w, h = img_in.get_width(), img_in.get_height()
    a.shape = (w, h, 4)

    assert sys.byteorder == 'little', (
        'The luminosity vector needs to be switched if we\'re in a big endian architecture. '
        'The alpha channel will be at position 0 instead of 3.')
    alpha = a[:, :, 3]
    alpha.shape = (w, h, 1)

    luminosity_float = numpy.sum(a * numpy.array([.114, .587, .299, 0]), axis=2)
    luminosity_int = numpy.array(luminosity_float, dtype=numpy.uint8)
    luminosity_int.shape = (w, h, 1)
    grayscale_gbra = numpy.concatenate((luminosity_int, luminosity_int, luminosity_int, alpha),
                                       axis=2)
    stride = cairo.ImageSurface.format_stride_for_width(cairo.FORMAT_ARGB32, w)
    assert stride == 4 * w, 'We need to modify the numpy code if the stride is different'
    img_out = cairo.ImageSurface.create_for_data(grayscale_gbra, cairo.FORMAT_ARGB32, w, h, stride)

    return img_out 
```

# c#-4.0 - 使用 POCO 模型在 EF 4 中实现预加载的最佳实践

> ID：12373490
> 
> 赞同：0
> 
> 时间：2012-09-11T15:47:24.033
> 
> 标签：c#-4.0, entity-framework-4

假设下一个具有两个实体的数据模型场景：

商业规则

*   标识：整数
*   名称：字符串
*   规则：字符串
*   规则类型：规则类型

规则类型

*   标识：整数
*   名称：字符串
*   分组名称：字符串

该模型使用 Entity Framework 4.3 与模型优先方法和 T4 POCO 模板在 MVC 3 项目上进行映射。

现在，假设在控制器类的“Create”方法中您收到一个**BusinessRule**实例，但您需要根据与业务规则的**RuleType**关联的**GroupingName属性更改行为。**

 **获取 GroupingName 值的最佳方法是什么？

到目前为止，我一直在考虑将**RuleType**属性映射为预加载，但令我惊讶的是（我以前曾与 nHibernate 合作过），这似乎是不可能的。

仅查询*RuleType*的数据**上下文**的最佳方法是（按 Id）还是有更好的方法？

**编辑：**

到目前为止，我的解决方案是：

```
public ActionResult Create(BusinessRule businessrule)
{
    // It will be nice if I don't have to do this.
    // I will be much happier if something like businessrule.RuleType.GroupingName
    // would be possible
    RuleType businessRuleRuleType = db.RuleType.Where(rt => rt.Id == businessrule.RuleTypeId).Single();
    string businessRuleGroupingName = businessRuleRuleType.GroupingName; 
} 
```

所以，我希望这清楚地表明使用**Include**（据我所知）不是一种选择。我也知道这个解决方案有效，但我不确定它是否是“最好的”，所以这就是问题。如果答案是“不，没有更好的方法”，好吧，没关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:56:35.927

`.Include()`使用扩展，实体框架绝对可以进行急切加载。

在 4.0 中，这并不是[特别优雅](http://msdn.microsoft.com/en-us/library/bb896272%28v=vs.100%29.aspx)

```
MyObjectContext.BusinessRules.Where(br => br.Id = someId)
                         .Include("RuleType")
                         .FirstOrDefault(); 
```

在 4.1 及更高版本中，现在[键入](http://msdn.microsoft.com/en-us/data/jj574232.aspx)：

```
MyDbContext.BusinessRules.Where(br => br.Id = someId)
                         .Include(br => br.RuleType)
                         .FirstOrDefault(); 
```**

# objective-c - 获取浮点数的长度（Objective-C）

> ID：12373492
> 
> 赞同：-4
> 
> 时间：2012-09-11T15:47:33.050
> 
> 标签：objective-c

如何获得数字的整数长度？在这种情况下，我在 while 循环中使用它。那么，我怎样才能在浮动长度的同时得到一些东西呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:49:22.800

使用`sizeof()`：

```
float f = 123.0f;
for (unsigned i = 0; i < sizeof(f); i++)
{
    ...
} 
```

或者您的意思是变量中值的长度？

```
float f = 123.0f;
for (float i = 0.0f; i < f; i += 1.0f)
{
    ...
} 
```

# symfony - 将变量传递给表单 - Symfony2

> ID：12373493
> 
> 赞同：1
> 
> 时间：2012-09-11T15:47:33.453
> 
> 标签：symfony, doctrine-orm

我阅读了有关此主题的其他问题，但我的应用程序仍然无法运行:(

这是我的代码：

```
class ChooseCatType extends AbstractType
{
    protected $user;

    function __construct(\EM\MyFriendsBundle\Entity\User  $user) 
    {
        $this->user = $user;
    }

     public function buildForm(FormBuilder $builder, array $options)
    {
        $builder->add('name', 'entity', array(
            'class' => 'EMMyFriendsBundle:Category',
            'property' => 'name',
            'query_builder' => function ($repository) use ($user)
                { return $repository->createQueryBuilder('cat')
                                    ->select('cat')
                                    ->where('cat.user', ':user')
                                    ->setParameter('user', $user);
                },
                        ));
    }

    public function getName()
        {
            return 'choose_category';
        }
    } 
```

这是在我的控制器中：

```
$cat = new Category();

        $dd_form = $this->createForm(new \EM\MyFriendsBundle\Entity\ChooseCatType($user), $cat); 
```

但我收到一个错误：

```
Notice: Undefined variable: user in C:\xampp\htdocs\MyFriends\src\EM\MyFriendsBundle\Entity\ChooseCatType.php line 24 
```

这是使用语句的行。我的代码与他们使用具体存储库的其他相关问题的答案之间存在差异，但我认为这不应该是问题。或者它是？请帮助我找到解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:52:42.963

该错误告诉你所有你需要知道的：你正在使用一个从未定义过的变量（$user）。只需在 $builder->add 行之前添加它：

```
$user = $this->user; 
```

# algorithm - BFS与拓扑排序的关系

> ID：12373495
> 
> 赞同：6
> 
> 时间：2012-09-11T15:47:41.023
> 
> 标签：algorithm, data-structures, graph, graph-algorithm, directed-acyclic-graphs

拓扑排序既可以使用 DFS（边缘反转）也可以使用 queue 来完成。BFS 也可以使用队列来完成。使用队列进行 BFS 时元素的存储和检索方式与使用队列进行拓扑排序时的存储和检索方式之间是否存在任何关系。澄清将是有帮助的。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T14:44:08.587

不，不一定有任何关系。我假设您指的是来自[wikipedia/Topological_sorting#Algorithms](http://en.wikipedia.org/wiki/Topological_sorting#Algorithms)的 Kahn 的算法，维基百科指出：

> 请注意，反映结果排序的非唯一性，结构 S 可以简单地是一个集合、一个队列或一个堆栈。

因此，拓扑排序的“队列”实际上是“任何集合”结构，这个集合中的排序无关紧要；它可以是任何东西。另一方面，用于 BFS 的队列是关于顺序的；这样它就可以完成它的FIFO（先进先出）任务。更改此顺序将破坏 BFS 算法。

可能还有其他基于“队列”的拓扑排序算法，其中结构是队列确实很重要。如果您询问特定的此类算法，请澄清。

**编辑：**感兴趣的算法被澄清为[改进算法部分](http://faculty.simpson.edu/lydia.sinapova/www/cmsc250/LN250_Weiss/L20-TopSort.htm#impr)，与卡恩的相同。

**编辑：**我已经根据您链接的页面中的[改进算法部分](http://faculty.simpson.edu/lydia.sinapova/www/cmsc250/LN250_Weiss/L20-TopSort.htm#impr)编写了一些实现拓扑排序的代码。我将它使用的集合类型设为任意作为排序函数的参数。然后我制作了几种类型的此类集合，包括堆栈、队列、随机弹出集合和 python 集（它是一个哈希集，因此不保证顺序）。

然后我制作一个图表，并在每个集合上测试排序算法。然后我使用拓扑排序维基百科上列出的定义测试每个结果：

> .. 有向图的拓扑排序（有时缩写为 topsort 或 toposort）或拓扑排序是其顶点的线性排序，使得对于每条边 uv，u 在排序中排在 v 之前。
> 
> ——[维基百科](http://en.wikipedia.org/wiki/Topological_sorting)

代码是用python编写的，如下所示。结果来自[http://ideone.com](http://ideone.com)。[_](http://ideone.com/Z9m9J) 我不知道生成随机 DAG 以进行测试的好方法，所以我的测试图很蹩脚。随意评论/编辑一个好的 DAG 生成器。

**编辑：**现在我有一个不那么蹩脚的生成器，但它使用 networkx。该函数`nx_generate_random_dag`在代码中，但它在函数中导入了networkx。您可以取消注释 main 中的标记部分以生成图表。我将生成的图形硬编码到代码中，因此我们得到了更有趣的结果。

所有这些都是为了表明，“集合”数据结构（算法中的队列）的顺序可以是任何顺序。

```
from collections import deque
import random

def is_topsorted(V,E,sequence):
  sequence = list(sequence)
  #from wikipedia definition of top-sort
  #for every edge uv, u comes before v in the ordering
  for u,v in E:
    ui = sequence.index(u)
    vi = sequence.index(v)
    if not (ui < vi):
      return False
  return True 

#the collection_type should behave like a set:
# it must have add(), pop() and __len__() as members.
def topsort(V,E,collection_type):
  #out edges
  INS = {}

  #in edges
  OUTS = {}
  for v in V:
    INS[v] = set()
    OUTS[v] = set()

  #for each edge u,v,
  for u,v in E:
    #record the out-edge from u
    OUTS[u].add(v)
    #record the in-edge to v
    INS[v].add(u)

  #1\. Store all vertices with indegree 0 in a queue
  #We will start
  topvertices = collection_type()

  for v,in_vertices in INS.iteritems():
    if len(in_vertices) == 0:
      topvertices.add(v)

  result = []

  #4\. Perform steps 2 and 3 while the queue is not empty.
  while len(topvertices) != 0:  
    #2\. get a vertex U and place it in the sorted sequence (array or another queue).
    u = topvertices.pop()
    result.append(u)

    #3\. For all edges (U,V) update the indegree of V,
    # and put V in the queue if the updated indegree is 0.

    for v in OUTS[u]:
      INS[v].remove(u)
      if len(INS[v]) == 0:
        topvertices.add(v)

  return result

class stack_collection:
  def __init__(self):
    self.data = list()
  def add(self,v):
    self.data.append(v)
  def pop(self):
    return self.data.pop()
  def __len__(self):
    return len(self.data)

class queue_collection:
  def __init__(self):
    self.data = deque()
  def add(self,v):
    self.data.append(v)
  def pop(self):
    return self.data.popleft()
  def __len__(self):
    return len(self.data)

class random_orderd_collection:
  def __init__(self):
    self.data = []
  def add(self,v):
    self.data.append(v)
  def pop(self):    
    result = random.choice(self.data)
    self.data.remove(result)
    return result
  def __len__(self):
    return len(self.data)

"""
Poor man's graph generator.
Requires networkx.

Don't make the edge_count too high compared with the vertex count,
 otherwise it will run for a long time or forever.
"""
def nx_generate_random_dag(vertex_count,edge_count):
  import networkx as nx

  V = range(1,vertex_count+1)
  random.shuffle(V)

  G = nx.DiGraph()
  G.add_nodes_from(V)

  while nx.number_of_edges(G) < edge_count:

    u = random.choice(V)
    v = random.choice(V)
    if u == v:
      continue

    for tries in range(2):
      G.add_edge(u,v)
      if not nx.is_directed_acyclic_graph(G):
        G.remove_edge(u,v)
        u,v = v,u
  V = G.nodes()
  E = G.edges()

  assert len(E) == edge_count
  assert len(V) == vertex_count
  return V,E

def main():

  graphs = []

  V = [1,2,3,4,5]
  E = [(1,2),(1,5),(1,4),(2,4),(2,5),(3,4),(3,5)]

  graphs.append((V,E))

  """
  Uncomment this section if you have networkx.
  This will generate 3 random graphs.
  """
  """
  for i in range(3):
    G = nx_generate_random_dag(30,120)
    V,E = G
    print 'random E:',E
    graphs.append(G)
  """

  #This graph was generated using nx_generate_random_dag() from above
  V = range(1,31)
  E = [(1, 10), (1, 11), (1, 14), (1, 17), (1, 18), (1, 21), (1, 23),
       (1, 30), (2, 4), (2, 12), (2, 15), (2, 17), (2, 18), (2, 19),
       (2, 25), (3, 22), (4, 5), (4, 8), (4, 22), (4, 23), (4, 26),
       (5, 27), (5, 23), (6, 24), (6, 28), (6, 27), (6, 20), (6, 29),
       (7, 3), (7, 19), (7, 13), (8, 24), (8, 10), (8, 3), (8, 12),
       (9, 4), (9, 8), (9, 10), (9, 14), (9, 19), (9, 27), (9, 28),
       (9, 29), (10, 18), (10, 5), (10, 23), (11, 27), (11, 5),
       (12, 10), (13, 9), (13, 26), (13, 3), (13, 12), (13, 6), (14, 24),
       (14, 28), (14, 18), (14, 20), (15, 3), (15, 12), (15, 17), (15, 19),
       (15, 25), (15, 27), (16, 4), (16, 5), (16, 8), (16, 18), (16, 20), (16, 23),
       (16, 26), (16, 28), (17, 4), (17, 5), (17, 8), (17, 12), (17, 22), (17, 28),
       (18, 11), (18, 3), (19, 10), (19, 18), (19, 5), (19, 22), (20, 5), (20, 29),
       (21, 25), (21, 12), (21, 30), (21, 17), (22, 11), (24, 3), (24, 10),
       (24, 11), (24, 28), (25, 10), (25, 17), (25, 23), (25, 27), (26, 3),
       (26, 18), (26, 19), (28, 26), (28, 11), (28, 23), (29, 2), (29, 4),
       (29, 11), (29, 15), (29, 17), (29, 22), (29, 23), (30, 3), (30, 7),
       (30, 17), (30, 20), (30, 25), (30, 26), (30, 28), (30, 29)]

  graphs.append((V,E))

  #add other graphs here for testing

  for G in graphs:
    V,E = G

    #sets in python are unordered but in practice their hashes usually order integers.
    top_set = topsort(V,E,set)

    top_stack = topsort(V,E,stack_collection)

    top_queue = topsort(V,E,queue_collection)

    random_results = []
    for i in range(0,10):
      random_results.append(topsort(V,E,random_orderd_collection))

    print
    print 'V: ', V
    print 'E: ', E
    print 'top_set ({0}): {1}'.format(is_topsorted(V,E,top_set),top_set)
    print 'top_stack ({0}): {1}'.format(is_topsorted(V,E,top_stack),top_stack)
    print 'top_queue ({0}): {1}'.format(is_topsorted(V,E,top_queue),top_queue)

    for random_result in random_results:
      print 'random_result ({0}): {1}'.format(is_topsorted(V,E,random_result),random_result)
      assert is_topsorted(V,E,random_result)

    assert is_topsorted(V,E,top_set)
    assert is_topsorted(V,E,top_stack)
    assert is_topsorted(V,E,top_queue)

main() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-07-18T13:50:07.473

BFS从源节点逐级遍历，使得节点按照与源的距离顺序出现，这也意味着父节点出现在其*下一级*的子节点之前。

这可能看起来像我们在拓扑排序中所需要的，但是，请继续关注我。上一句中的*下一个级别*是关键，因为如果一个节点及其子节点与源处于同一级别，那么 BFS 不会强制执行遍历它们的顺序，这意味着它可能会将节点的子节点呈现在自身之前，这将是直接违规对于拓扑排序的规则，当我们想要拓扑排序时，排序确实很重要。

尽管 BFS 和拓扑排序之间似乎存在某种关系，但这种关系相当薄弱。

# frama-c - 数据流图

> ID：12373498
> 
> 赞同：0
> 
> 时间：2012-09-11T15:47:45.460
> 
> 标签：frama-c

是否有一个 frama-c 插件来输出过程间数据流/指向图？

我知道切片器插件中的 -pdg 将包​​含此信息，但想知道我是否可以单独获取它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T06:21:20.380

PDG 不是切片插件的一部分，如果您愿意，可以单独使用它。看 ：

```
$ frama-c -pdg-help 
```

（简短）选项列表，以及 Db.Pdg 模块（在 src/kernel/db.mli 中）中的 API，以便在您自己的程序中使用它。

# javascript - 如何在不重新加载 Java Script 的情况下重新加载网页？

> ID：12373500
> 
> 赞同：2
> 
> 时间：2012-09-11T15:47:53.003
> 
> 标签：javascript, html

目的：用于谷歌广告

我需要在不加载 js 内容（将在文件中）的情况下重新加载页面，因为 JS 的大小会更大，它只会在第一次加载时才会加载，而下一页只会重新加载动态内容（如广告、动态文本）会继续变化。有没有办法做到这一点 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T15:52:53.160

大多数浏览器会缓存 JavaScript 和 CSS 文件，只要文件的名称自上次访问页面以来没有更改。

此外，如果文件大小是个问题，请考虑缩小 JS 和 CSS 文件。这使用各种技术压缩文件，同时保持相同的功能。有各种在线工具可以做到这一点，我最喜欢的是[Online YUI Compressor](http://refresh-sf.com/yui/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-11T16:07:03.707

如果在 Linux 上，您可以使用 .htaccess 文件，例如：

看：

[http://www.samaxes.com/2008/04/htaccess-gzip-and-cache-your-site-for-faster-loading-and-bandwidth-saving/](http://www.samaxes.com/2008/04/htaccess-gzip-and-cache-your-site-for-faster-loading-and-bandwidth-saving/)

这很好用。

马蒂亚斯

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T15:52:29.943

有两种方法：

1.  您可以通过向浏览器发送适当的 HTTP 标头来确保可以缓存 JS 文件。

2.  如果用户在您的网站上停留很长时间并像使用桌面应用程序一样使用它，您可以创建一个初始页面并加载一次 JS。如果您将所有链接转换为发送仅替换页面内容部分的 AJAX 请求，则 JS 将不会再次加载，因为您永远不会“离开”页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T16:13:45.710

或者您可以使用 Ajax 刷新动态内容

[http://www.markvoss.net/scripts/ajax.asp](http://www.markvoss.net/scripts/ajax.asp)

这是一个选择

# jquery - 向多步表单添加基本分页

> ID：12373506
> 
> 赞同：0
> 
> 时间：2012-09-11T15:48:15.440
> 
> 标签：jquery, forms, each

我正在使用 jQuery 创建一个多 setep 表单。目前该功能是有限的 - 下一个按钮将成功引导用户进入下一组。我正在尝试实现某种分页，它将向用户显示他们当前所在的页面以及剩下的其他页面。

你可以在这里看到一个完整评论的 jsfiddle：http: [//jsfiddle.net/QmbNw/6/](http://jsfiddle.net/QmbNw/6/)

理想情况下，我希望当前页面的列表项有一个活动类，所以我可以设置不同的样式。当前显示的表单部分具有选定的类别。我需要想出一种方法来为每个列表项添加一个活动类，并具有与所选表单窗格的索引匹配的索引。请参阅 jsfiddle，这将是有意义的。

此外，这些列表项应链接到该部分，以便它们可以点击。

更新：

我在其中添加了以下 jQuery，希望它会为当前列表项添加一个活动状态：

```
if($(this).hasClass("visible")){
     $(this).parent().find("li:nth-child(" + pageNum+ ")").addClass("active");
} 
```

有关上下文，请参见 jsfiddle：http: [//jsfiddle.net/QmbNw/6/](http://jsfiddle.net/QmbNw/6/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T17:14:15.640

我使用附加索引解决了它。请看这个jsfiddle：http: [//jsfiddle.net/Azxjt/](http://jsfiddle.net/Azxjt/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:22:10.220

您可以使用[jQuery 选项卡插件](http://jqueryui.com/demos/tabs/)- 您使用 jQuery-UI 获得了一个很棒的插件。

为了序列化您的数据，请查看[Mike Alsup](http://malsup.com/jquery/form/) jquery 表单插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T16:19:37.953

我可以很容易地做到这一点：

*   创建一个名为 currentPage 的变量
*   创建一个函数来隐藏/显示基于 currentPage 的分页“选项卡”
*   创建 ID 和类来帮助 jquery 驱动页面操作

在这里更新前：http: [//jsfiddle.net/QmbNw/5/](http://jsfiddle.net/QmbNw/5/)

那是你要找的吗？

# php - 压缩从 mysql 查询生成的 xml 引用的图像

> ID：12373509
> 
> 赞同：0
> 
> 时间：2012-09-11T15:48:23.003
> 
> 标签：php, mysql, xml

好的，我会尽量让这一切变得容易理解！

**背景：**我正在创建一个 XML 提要，以使用 php 从 MySql 数据库中显示 ebay motor pro 上的汽车。我已经成功创建了包含所有相关详细信息的 xml 文件，这也是我的测试服务器的 ftp。

**问题：**每张汽车照片在数据库中记录为regnumber_1.jpg、regnumber_2.jpg；以此类推，并链接到每辆车。图像位于名为 autotrader 的文件夹中。

我无法将 autotrader 文件夹中的图像发布到 zip 文件中的 ebay 文件夹中。我只想从 mysql 查询中复制照片（即不是整个文件夹）。

我怀疑这是因为我没有正确完成 foreach 循环，但希望有人能够指出我正确的方向？这是代码：

```
//Photos bit...
$destination = 'tmp/ebay';
$filename = 'ebay-photos';

//images array
$row = array();
foreach ($result->images as $images) {
$images = explode(',', $row['images']);
foreach ( $images as $image ) {
copy('uploads/used-cars/autotrader/' . $image, $destination . $image);
$all_images[] = $image;
}
}

exec('zip  -g0 ' . $zip_filename . ' *.jpg *.jpeg');
foreach ( $all_images as $image ) {
@unlink($destination.$image);
}
$zip_filename = $filename . '.zip'; 

while ($row = @mysql_fetch_assoc($result)){  
$all_images->images as $images);
} 
```

XML 位有效，并且是：

```
while ($row = @mysql_fetch_assoc($result)){  
// XML  
$node = $dom->createElement("ad");  
$newnode = $parnode->appendChild($node);   
$newnode->setAttribute("vrm",$row['vrm']);
$newnode->setAttribute("make",$row['make']);
$newnode->setAttribute("model",$row['model']);
$newnode->setAttribute("type",$row['type']);
$newnode->setAttribute("consumerPrice",$row['consumerPrice']);
$newnode->setAttribute("numPreviousOwners",$row['numPreviousOwners']);
$newnode->setAttribute("transmission",$row['transmission']);
$newnode->setAttribute("images",$row['images']);
$newnode->setAttribute("numPreviousOwners",$row['numPreviousOwners']);
$newnode->setAttribute("color",$row['color']);
} 

$dom->save('tmp/ebay/ebay.xml');
echo $dom->saveXML(); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T13:04:23.477

我创建了一个单独的 php 文件来检索照片，然后 ftp 压缩文件。

现在可以关闭它了。

# television - DVD 播放器：谷歌电视频道列表

> ID：12373514
> 
> 赞同：1
> 
> 时间：2012-09-11T15:48:45.663
> 
> 标签：television

*   当 DVD 播放器连接到谷歌电视盒的 HDMI 时，频道列表（和频道更改）API 会返回什么。
*   有没有办法通过播放 Intent 来暂停 DVD 播放器的流？

示例应用程序：[http ://code.google.com/p/googletv-android-samples/source/browse/#git%2FChannelChangingSample](http://code.google.com/p/googletv-android-samples/source/browse/#git%2FChannelChangingSample)

抱歉，我无法访问谷歌电视或模拟器（尝试任何东西都太慢了）。否则，我本可以自己尝试一下。

# c# - 通过 C# 发出的命令打开另一个命令提示符

> ID：12373515
> 
> 赞同：0
> 
> 时间：2012-09-11T15:48:46.653
> 
> 标签：c#, .net

我正在使用这样的代码：

```
System.Diagnostics.Process process = new System.Diagnostics.Process();
System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();

startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
startInfo.FileName = "cmd.exe";
startInfo.Arguments = "/C SomeEXE inputfile.txt";
startInfo.UseShellExecute = false;
startInfo.RedirectStandardOutput = true;

process.StartInfo = startInfo;
process.Start();

// Now use streams to capture the output
StreamReader outputReader = process.StandardOutput;

process.WaitForExit();

String line = outputReader.ReadToEnd(); 
```

这工作正常。但是，发出的命令 (SomeEXE) 会导致打开另一个命令提示符，其中包含实际结果并等待回车符关闭。是否有可能获得此输出并发出回车？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:52:59.630

**直接启动 SomeEXE**

如果您直接启动 SomeEXE，而不是通过新的命令解释器，则通过将 stdout 重定向到*outputReader*来获取输出的现有代码将起作用。为此，请按如下方式更改您的代码：

```
startInfo.FileName = "SomeEXE";
startInfo.Arguments = "inputfile.txt"; 
```

您也可以将标准输入重定向到您自己的流，以便您可以发出回车：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardinput.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardinput.aspx)

关键点：

```
myProcess.StartInfo.RedirectStandardInput = true;
StreamWriter myStreamWriter = myProcess.StandardInput; 
```

将 Environment.NewLine 写入 myStreamWriter。

但是，由于您没有这样做，因此您正在捕获命令解释器的控制台。

**如果你控制 SomeEXE 的代码**

如果您可以控制 SomeEXE，您可以指示它附加到其父控制台：

[http://www.csharp411.com/console-output-from-winforms-application/](http://www.csharp411.com/console-output-from-winforms-application/)

请注意，MSDN 示例显示异常处理非常差。如果抛出异常，它们将无法关闭示例中的流。处理流的最简单方法是将它们包装在*using*语句中。

**如果 SomeEXE 产生一个子进程**

如果您无法控制 SomeEXE 的代码，并且 SomeEXE 正在生成一个子进程，那么从孙控制台获取标准输入/标准输出的任务就更难了。但是，这是可以做到的。

您需要[获取相关实际控制台窗口的进程 ID](http://www.howtogeek.com/howto/programming/get-a-list-of-running-processes-in-c/)。

然后，您可以使用 Win32 API [AttachConsole](http://msdn.microsoft.com/en-us/library/ms681952.aspx)将孙进程的控制台附加到您自己的控制台。

# c# - 实现基本接口问题

> ID：12373517
> 
> 赞同：3
> 
> 时间：2012-09-11T15:49:04.767
> 
> 标签：c#, generics, interface

我在基础库项目中定义了以下接口：

```
public interface IWorkContext {
    T User<T>() where T : IUser;

    // Note this method is kind of a shortcut so i don't
    // have to keep passing in T
    IUser User();
}

public interface IUser {
    int Id { get; }
    string UserName { get; }
} 
```

现在我有另一个项目，它使用以下类（实现 IUser）引用上面的项目。

```
public class User : IUser {
   public virtual int Id { get; set; }
   public virtual string UserName { get; set; }
   // ... Code removed for brevity
} 
```

现在我还需要实现 IWorkContext。这是我的第一次尝试：

```
public class DefaultWorkContext : IWorkContext {
    private readonly IUsersService _usersService;

    public DefaultWorkContext(IUsersService usersService) {
        _usersService = usersService;
    }

    public T User<T>() where T : IUser {
        return _usersService.GetUser<T>(1));
    }

    public User User() {
        return User<User>();
    }
} 
```

然而，这给出了错误：

> 类型“T”不能用作泛型类型或方法“...GetUser(int)”中的类型参数“T”。没有从“T”到“用户”的装箱转换或类型参数转换。

我确定我做错了一些基本的事情。我很感激有关此模型的任何建议都可以改进。谢谢

**编辑**（根据要求，这里是 GetUser 方法）：

```
public T GetUser<T>(int id) where T : User {
    return _session.Get<T>(id);
} 
```

注意：_session 是一个 NHibernate 会话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:08:07.450

这里的问题是您将泛型类型作为类型参数传递给您的`GetUser()`方法，这**可能**不满足您的`GetUser()`方法接受的泛型类型的继承条件。

编译器确保作为参数传递的类型始终满足类型条件。实际上，您可以编写 a `class NotUser`that implements`IUser`而不是`User`. 然后可以使用类型参数调用**您**的`User<T>()`方法，这将导致使用不继承自.**`NotUser``GetUser()``User`**

 **您的`GetUser()`方法只接受继承自的类型`User`。

您需要更改`GetUser()`原型以接受实现的泛型类型，`IUser`或者更改原型以`User<T>`仅接受继承自的泛型类型`User`。

要么：

```
public T GetUser<T>(int id) where T : IUser {
    return _session.Get<T>(id);
} 
```

或这个：

```
public T User<T>() where T : User {
    return _usersService.GetUser<T>(1));
} 
```

***编辑：*** 你应该选择第一种还是第二种方法取决于你想要做什么。

1）您希望您`IWorkContext`使用`IUser`界面，并且您接受该`GetUser()`方法返回 a `IUser`=> pick option 1

2）您希望该`GetUser()`方法采用继承自的类型`User`，并且您接受该`IWorkContext`接口使用`User`而不是`IUser`=> 选择选项 2，并修改该`IWorkContext`接口。

对我来说，选项 1) 更好，因为您不需要修改界面并且不会破坏通用性。但这取决于你想要做什么。**

# java - 2D array[row][] = str.split("\t") 未按预期运行

> ID：12373518
> 
> 赞同：1
> 
> 时间：2012-09-11T15:49:07.483
> 
> 标签：java, multidimensional-array

虽然我可以让它在 1 维数组 ( `String array[] = str.split(blah)`) 上工作，但我在 2D 数组上遇到了麻烦。我正在使用一个循环遍历 2D 数组的每一**行**并为其分配任何`str.split(\t)`内容。

例如：

```
John\tSmith\t23
James\tJones\t21 
```

我的 2D 数组看起来像这样：`{{John, Smith, 23}, {James, Jones, 21}}` 我才开始使用 Java，所以我不太确定 2D 数组的一些语法。

编辑：根据要求的一些代码

```
String str;
int row = 0;
String array[][];
while ((str = br.readLine()) != null)   {
    array[row] = str.split("\t");
    System.out.println(array[row][0]);
    row++;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:57:19.580

您需要按如下方式初始化数组：

```
int rowCount = ...;
String array[][] = new String[rowCount][]; 
```

或者如果您不知道行数，您可以使用 ArrayList 代替：

```
List<String[]> list = new ArrayList<String[]>();
String str;
while((str = br.readLine()) != null)
{
    String[] array = str.split("\t");
    list.add(array);
}
String[][] array2D = new String[list.size()][];
list.toArray(array2D); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:01:24.553

您必须使用`str.split("\\\\t");`split 方法接受正则表达式。
查看此[帖子以获取更多详细信息](https://stackoverflow.com/questions/1635764/string-parsing-in-java-with-delimeter-tab-t-using-split)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T16:02:22.137

您`String array[][]`必须在使用前进行初始化。

如果可以，请将您的代码移动到使用`List`s 以使其工作：

```
List<List<String>> array = new ArrayList<List<String>>();
while ((str = br.readLine()) != null)   {
    array.add(Arrays.asList(str.split("\t")));
} 
```

如果您不能使用`List`，请初始化您的数组

```
final int SIZE = ...; //some value that would be the max size of the array of arrays
String array[][] = new String[SIZE][]; 
```

# forms - 在 iframe 中使用用户名和密码自动登录外部网站

> ID：12373520
> 
> 赞同：0
> 
> 时间：2012-09-11T15:49:19.187
> 
> 标签：forms, iframe, submit, single-sign-on

我有一个项目，我希望能够创建一个 iframe。

在这个 iframe 中，将是一个 ftp 登录页面的外部页面（用户名和密码的位置）。

如何自动填充外部站点的用户名和密码字段，然后自动提交表单？

我遇到了麻烦。谢谢

![在此处输入图像描述](../Images/65b350cac35fdb78ea09c963547a2d98.png)

* * *

问题。这可以通过javascript注入实现吗？

[http://thetechnofreak.com/technofreak/modify-iframe-with-javascript/](http://thetechnofreak.com/technofreak/modify-iframe-with-javascript/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:52:12.040

使用 jQuery，您可以使用 .contents() 访问框架的内容

就像是

```
$("#YourFrameId").contents().find("#tbUsername").val("Admin") 
```

这可能有效，但出于安全考虑，某些浏览器不允许这样做（除非它正在访问同一域和端口中的字段）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:55:42.547

默认情况下，您只能在 iframe 中的页面位于同一域中时执行此操作。如果域不同，则托管 iframe 的页面可能不会与 iframe 内的页面文档交互。

如果您控制这两个页面，则可以将 iframe 源设置为`yourpage.aspx?username=xxx&password=yyy`并修改`yourpage.aspx`以检测此调用和登录。

您还可以在现代浏览器中使用[`postMessage`](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)Javascript 来在名人之间进行通信。

# mysql - 如何在 MySQL 中连接字符串 (xeround)

> ID：12373521
> 
> 赞同：2
> 
> 时间：2012-09-11T15:49:18.807
> 
> 标签：mysql, sql, xeround

我在一个存储过程中，我需要连接 3 个参数加上一个静态字符串来为表创建一个唯一 ID。

所以 SP 有，比方说，p1，p2 和 p3 作为 varchar 参数，我想在表中插入一个新行，其值为 p1，p2，p3，第 4 列将是 'ABC'+p1+p2+p3 . 我正在使用 || 但它不起作用。它返回 1。我如何在 MySQL (xeround) 中连接，而且，我是否需要像在事务 sql 中一样使用 @p1？我的意思是，使用 p1 对 INSERT 有效。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T15:51:25.933

**[`CONCAT`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)**用于连接`mysql`. 所以你的代码应该是，

```
CONCAT('ABC', p1, p2, p3) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:31:30.197

使用[这里](https://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)`GROUP_CONCAT()`进一步解释。

# iphone - 如何从文本字段中删除最后一个字符？

> ID：12373525
> 
> 赞同：0
> 
> 时间：2012-09-11T15:49:29.343
> 
> 标签：iphone, ios, ipad

我有一个 iPad 应用程序，我在其中添加了一个 calc 类型的键盘，带有 9 个数字和一个后退按钮。使用所有数字，我正在像这样颠覆文本字段的值`[number setText:[number.text stringByAppendingString:@"number"]];`。现在在回溯操作中，我需要删除最后添加的价值。我试过这个`[number.text substringToIndex:[number.text length]-2];`但是没有运气。有人能帮我实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:55:15.667

你对 substringToIndex 的结果做了什么？

你需要类似的东西，

```
[number setText:[number.text substringToIndex:[number.text length]-2]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:59:25.987

这是答案：

```
if ( [number.text length] > 0)
        number.text = [number.text substringToIndex:[number.text length] - 1]; 
```

# python - 解析python文件以检查它是否符合某些规则

> ID：12373526
> 
> 赞同：1
> 
> 时间：2012-09-11T15:49:30.390
> 
> 标签：python, regex, parsing

我的导师 Barry 总是因为我忘记在逗号、等号后面加空格以及在文件末尾留下太多行而责备我。我想练习一些 python 并编写一个解析器来检查我的文件，然后再将它们呈现给他。

```
#BarryParser v0.1

from re import findall, search

def comma_checker(line, lineno):
    """ Checks commas have a space after them """
    split_line =  line.split(', ')
    for string in split_line:
        found_error = findall('.*,.*', string)
        if found_error:
            print "BARRY ISSUE DETECTED: COMMA ERROR LINE: %s: %s" % (lineno, line)

def equals_checker(line, lineno):
    split_line =  line.split(' = ')
    for string in split_line:
    found_error = findall('.*==?.*', string)
    if found_error:
        print "BARRY ISSUE DETECTED: EQUALS ERROR LINE: %s: %s" % (lineno, line)

def too_many_blank_lines(lines):
    """if the last line is a new line and the line before is also a new line,
       rasises barry issue over too many blank lines
    """
    last_line = lines[len(lines)-1]
    second_to_last_line = lines[len(lines)-2]
    if last_line == "\n" and second_to_last_line == "\n":
        print "BARRY ISSUE DETECTED: TOO MANY BLANK LINES AT END OF TEXT"
    elif search('\t*\n{1}', last_line)and search('\t*\n{1}', second_to_last_line):
        print "BARRY ISSUE DETECTED: TOO MANY BLANK LINES AT END OF TEXT"
    elif search('\t*\n{1}', second_to_last_line) and last_line == "\n":
        print "BARRY ISSUE DETECTED: TOO MANY BLANK LINES AT END OF TEXT"

def main():
    file = open("test.txt")
    line_no = 0
    lines = file.readlines(100000) 
    too_many_blank_lines(lines) #CHECK FOR BLANK LINES AT END OF TEXT
    for line in lines:
        line_no +=1 
        if not line == "\n":
            if not line[:1] == "#":
                comma_checker(line, line_no) #CHECK COMMAS ARE DONE RIGHT
                equals_checker(line, line_no) #CHECK EQUALS HAVE SPACES AFTER & BEFORE

if __name__ == '__main__':
    main() 
```

它将解析python文件。问题是，我不知道如何让等号位以相同的方式处理 == 和 =。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:55:15.043

看看 pep8 模块。这会检查您的代码是否符合 pep8 编码标准。

见： http: [//www.python.org/dev/peps/pep-0008/](http://www.python.org/dev/peps/pep-0008/)

这是示例输出

```
thenh@localhost:~> pep8 *.py
1.py:11:1: W293 blank line contains whitespace
1.py:14:80: E501 line too long (81 characters)
1.py:24:1: E302 expected 2 blank lines, found 1
1.py:37:23: W291 trailing whitespace
1.py:90:27: E201 whitespace after '['
1.py:116:36: E701 multiple statements on one line (colon)
1.py:144:9: E303 too many blank lines (2)
2.py:22:1: W391 blank line at end of file
3.py:75:29: E231 missing whitespace after ',' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:52:13.890

使用[Pylint](http://pypi.python.org/pypi/pylint)为您检查程序。

# regex - inotifywait 根据修改的文件类型运行命令

> ID：12373528
> 
> 赞同：5
> 
> 时间：2012-09-11T15:49:38.307
> 
> 标签：regex, bash, inotify, watch, inotify-tools

我特别想在 2 个子目录中同时查看 2 个不同的文件类型：

  'js' 子目录
  中的 .coffee 文件类型 'css' 子目录中的 .styl 文件类型

我只知道这么多 bash，我正试图让这样的东西发挥作用

```
while inotifywait --format %w%f ./{css,js}/*.{styl,coffee}; do
  # regex pattern to match the file ending
  # and define it to $ending

  if[ $ending == coffee ]
  then
   coffee -c $file
  elif[ $ending == styl ]
  then
    stylus -c $file
  fi
done 
```

// 编辑 // 修改了这一行：

```
while inotifywait --format %w%f ./{css,js}/*.{styl,coffee}; do 
```

所以现在它会检查这两个文件，但如果 css 文件夹中没有 .coffee 文件，或者 js 中没有 .styl 文件，它会返回未找到文件的错误。

另外我注意到当我运行这个脚本时，它返回/运行以下 3 次

```
Setting up watches.
Watches established.
./css/styles.styl 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T17:32:38.120

不是最干净的解决方案，但有效

```
#!/bin/sh

while file=$(inotifywait -r -e modify --format "%w%f" ./); do
  EXT=${file##*.}
  if [ $EXT = "styl" ]
  then
    stylus -c $file
  fi
  if [ $EXT = "coffee" ]
  then
    coffee -c $file
  fi
done 
```

如果您有更好的解决方案，只观看我想要的文件，那么我全神贯注

# c# - C# 处理 LINQ 中的 System.UnauthorizedAccessException

> ID：12373529
> 
> 赞同：3
> 
> 时间：2012-09-11T15:49:42.863
> 
> 标签：c#, linq

我正在使用下面的 LINQ 查询来获取目录列表。我收到一个错误（System.UnauthorizedAccessException 未被用户代码处理）。如何仅加载我有权访问的目录。

```
var files = from f in System.IO.Directory.GetDirectories(@"\\testnetwork\abc$",
                                   "*.*",
                                   SearchOption.AllDirectories)
            select System.IO.Path.GetDirectoryName(f); 
```

错误：

拒绝访问路径 '\testnetwork\abc$\DemoFolder\'。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T18:20:39.177

您应该做的第一件事是更改您正在使用的方法：

```
var files = from f in System.IO.Directory.EnumerateDirectories(
        @"\\testnetwork\abc$",
        "*.*",
        SearchOption.AllDirectories)
select f; 
```

`EnumerateDirectories`效果更好，因为它会产生结果，并且如果它找到一个没有权限的文件夹，仍然会抛出相同的异常。它产生结果的事实允许我们在它的输出之上进行组合，所以如果我们添加一个这样的扩展方法：

```
static class ExceptionExtensions
{
    public static IEnumerable<TIn> Catch<TIn>(
                this IEnumerable<TIn> source,
                Type exceptionType)
    {   
        using (var e = source.GetEnumerator())
        while (true)
        {
            var ok = false;

            try
            {
                ok = e.MoveNext();
            }
            catch(Exception ex)
            {
                if (ex.GetType() != exceptionType)
                    throw;
                continue;
            }

            if (!ok)
                yield break;

            yield return e.Current;
        }
    }
} 
```

那么我们就可以这样写：

```
var files = from f in System.IO.Directory.EnumerateDirectories(
        @"\\testnetwork\abc$",
        "*.*",
        SearchOption.AllDirectories)
        .Catch(typeof(UnauthorizedAccessException))
select f; 
```

并且您的输出应该是预期的，同时仍保持 Linq 表达式的干净和可组合。该`Catch`方法的想法是在不阻止其他异常发生的情况下“吞下”您不想要的异常。这是一个实施草案，但你明白了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T15:56:20.813

我不明白你为什么需要 LINQ。保持简单可能有助于调试问题。尝试这样的事情：

```
DirectoryInfo[] directories = System.IO.Directory.GetDirectories(@"\\testnetwork\abc$",
                               "*.*",
                               SearchOption.AllDirectories);
foreach (DirectoryInfo dir in directories)
{
    try
    {
       Console.WriteLine(System.IO.Path.GetDirectoryName(f));
    }
    catch(Exception ex)
    {
       // report an error or something
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T15:55:12.927

我相信 System.IO 命名空间中的 File 和 Directory 类中有名为“CanRead”和“CanWrite”的属性。您可以使用这些来确定您是否拥有权利。

我知道的另一种方法是使用代码访问安全性并编写一个“要求”适当权限的方法......

抱歉，我正要参加一个会议，但我已经为你提供了足够的内容供 Google 使用。如果这个问题仍然没有可靠的答案，我稍后会写更多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T16:00:50.980

使用 Catch 捕获 UnauthorizedAccessException。.

```
 string[] directories = Directory.EnumerateDirectories(@"\\testnetwork\abc$","*.*", SearchOption.AllDirectories).Catch(typeof(UnauthorizedAccessException)).ToArray(); 
```

异常扩展：

```
 static class ExceptionExtensions
{
public static IEnumerable<TIn> Catch<TIn>(
            this IEnumerable<TIn> source,
            Type exceptionType)
{   
    using (var e = source.GetEnumerator())
    while (true)
    {
        var ok = false;

        try
        {
            ok = e.MoveNext();
        }
        catch(Exception ex)
        {
            if (ex.GetType() != exceptionType)
                throw;
            continue;
        }

        if (!ok)
            yield break;

        yield return e.Current;
    }
}
} 
```

# jquery - 从动态创建的 jQuery 对话框返回值

> ID：12373536
> 
> 赞同：0
> 
> 时间：2012-09-11T15:50:05.030
> 
> 标签：jquery, vb.net

我有以下代码，它显示一个带有一些字段、一个保存按钮和一个取消按钮的 jQuery 对话框。

对话框显示，没有问题。您可以在字段中输入文本。

但是如何将这些值返回到我的 VB.net MVC 代码中呢？谢谢。

```
enter code here<script type="text/javascript">
var $dialog;
var $currentForm;

$(document).ready(function () {
    $dialog = $('<div></div>')
        .html('<fieldset><ol>' +
            '<select>' +
            '<option value="CONTAINS">contains</option>' +
            '<option value="NOTCONTAINS">does not contain</option>' +
            '<option value="EQUAL">equals</option>' +
            '<option value="NOTEQUAL">does not equal</option>' +
            '<option value="GT">is greater than</option>' +
            '<option value="LT">is less than</option>' +
        '</select>' +
        '<li>' +
            '<form action="/" id="condition"><input type="text" id="con" name="con"/>' +
            '<input class="enterCondition" type="submit" value="Save Condition" /></form>' +
        '</li>' +
    '</ol>' +
'</fieldset>' +
'<p>Press Escape to cancel input.</p>')
        .dialog({
            autoOpen: false,
            buttons: {
                'Save Condition': function () {
                    alert($(this));
                    $(this).dialog('close');
                },
                'Cancel': function () {
                    $(this).dialog('close');
                }
            },
            modal: true,
            closeOnEscape: true,
            width: 520,
            resizable: false,
            title: "Generator Conditions",
            show: { effect: "fade", speed: "slow" },
            hide: { effect: "fade", speed: "slow" }
        });

    $('#enterCondition').click(function () {
        $currentForm = $(this).closest('Form')
        $dialog.dialog('open');
        return false; ////cancel eventbubbeling
    });

    function ShowResult(result) {
        alert(result);
    }
});

function showDialog() {
    $dialog.dialog('open');
    return false //cancel eventbubbeling
} 
```

它产生了 jQuery 弹出对话框没有问题，但是我如何将值返回到 VB.Net 视图/表单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:53:54.287

您最好的选择是使用`ajax`功能将数据发布到可以处理它的服务器上的脚本中。

# c - 警告：返回类型默认为 'int' [-Wreturn-type]

> ID：12373538
> 
> 赞同：25
> 
> 时间：2012-09-11T15:50:10.303
> 
> 标签：c, compiler-warnings

我是一名开始学习 C 的 Linux 用户，我正在尝试编译我输入的源代码：

```
#include <stdio.h>
main()
{
        float c,d;
        c = 10215.3;
        d = c / 3;
        printf("%3.2f\n",d);
        return 0;
} 
```

它使用我编写的makefile编译：

```
cc -Wall -g     printf.c   -o printf 
```

但我收到了这个警告：

> printf.c:2:1：警告：返回类型默认为 'int' [-Wreturn-type]

它编译代码并获得所需的输出，但我想了解这意味着什么

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-09-11T15:50:58.837

```
main() 
```

应该

```
int main() 
```

在 C89 中，默认返回类型假定为`int`，这就是它起作用的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-28T10:13:50.130

在 C89 中，默认返回类型是**int**。此默认值在 C99 中已删除，编译器有助于提醒您在**main()**之前没有**int**的 C 样式已过时。

 **请参阅 C89 规范第 3.5.2 节“类型说明符”：

*   “每个类型说明符列表应为以下集合之一：[...] + **int**、**signed**、**signed int**或*无类型说明符*”。

*   在语义的第二段中：“每个 [...] 集合都指定相同的类型，除了位域 [blabla]”。所以这意味着“无类型说明符”与**int**相同。

在 C99 中，删除了“或无类型说明符”部分。（但您仍然可以在没有**int部分的情况下编写****签名**。）

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-23T14:11:36.333

**解决方案：**您在哪里定义了您的功能。您必须**确定**变量的数据类型。

```
int function(n) 
```

应该：

```
int function(int n) 
```

在 C89 中，默认返回类型是 int。此默认值在 C99 中已删除，编译器有助于提醒您在 main() 之前没有 int 的 C 样式已过时。****

# wix - 卸载时未删除的许多产品的一个注册表项

> ID：12373540
> 
> 赞同：2
> 
> 时间：2012-09-11T15:50:21.117
> 
> 标签：wix, registry

`Software\$(var.Manufacturer)`我的公司有很多产品，如果我们的客户安装了多个产品（很可能），我们希望创建一个包含我们所有产品的注册表项，然后我想为我们的每个产品创建一个辅助密钥，这些产品将被删除卸载但主要的没有。我试图像下面那样实现这一点，但是我的主键被删除了，所以我的所有其他产品也从注册表中删除了。我知道这是微不足道的，但我找不到答案。

```
<DirectoryRef Id="TARGETDIR">
  <Component Id="Registry" Guid="*" MultiInstance="yes" Permanent="yes">
    <RegistryKey Root="HKLM" Key="Software\$(var.Manufacturer)" ForceCreateOnInstall="yes">
      <RegistryValue Type="string" Name="Default" Value="true" KeyPath="yes"/>
    </RegistryKey>
  </Component>
</DirectoryRef>

<DirectoryRef Id="TARGETDIR">
  <Component Id="RegistryEntries" Guid="*" MultiInstance="yes" >
    <RegistryKey Root="HKLM" Key="Software\$(var.Manufacturer)\[PRODUCTNAME]" Action="createAndRemoveOnUninstall">
      <RegistryValue Type="string" Name="Installed" Value="true" KeyPath="yes"/>
      <RegistryValue Type="string" Name="ProductName" Value="[PRODUCTNAME]"/>
    </RegistryKey>
  </Component>
</DirectoryRef> 
```

编辑：我已经让我的注册表项继续使用以下代码。但是，他们只是全部删除，所有产品都被删除，而不是根据需要一一删除。

```
<DirectoryRef Id="TARGETDIR">
  <Component Id="Registry" Guid="FF75CA48-27DE-430E-B78F-A1DC9468D699" Permanent="yes" Shared="yes" Win64="$(var.Win64)">
    <RegistryKey Root="HKLM" Key="Software\$(var.Manufacturer)" ForceCreateOnInstall="yes">
      <RegistryValue Type="string" Name="Default" Value="true" KeyPath="yes"/>
    </RegistryKey>
  </Component>
</DirectoryRef>

<DirectoryRef Id="TARGETDIR">
  <Component Id="RegistryEntries" Guid="D94FA576-970F-4503-B6C6-BA6FBEF8A60A" Win64="$(var.Win64)" >
    <RegistryKey Root="HKLM" Key="Software\$(var.Manufacturer)\[PRODUCTNAME]" ForceDeleteOnUninstall="yes">
      <RegistryValue Type="string" Name="Installed" Value="true" KeyPath="yes"/>
      <RegistryValue Type="string" Name="ProductName" Value="[PRODUCTNAME]"/>
    </RegistryKey>
  </Component>
</DirectoryRef> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T18:15:53.120

Guid="*" 在这里可能不适合您。您需要使用将 Shared 属性设置为 true 的静态 GUID（可能在一个片段中，以便它可以由多个产品共享）。您可以按照对子项执行此操作的方式执行此操作。

这样 MSI 将正确引用计数父键并知道何时删除它。

# c - 指向 C 中的函数的指针

> ID：12373545
> 
> 赞同：2
> 
> 时间：2012-09-11T15:50:25.810
> 
> 标签：c

我觉得我对 C 中的指针有很好的处理。大多数情况下，我使用它们将数组传递给函数。

但是我在查看许多不同的代码示例时注意到，看到指向函数的指针并不少见。我根本不清楚为什么这会有用？是否存在一些经典实例，其中指向函数模型的指针很方便或必须实现？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-11T15:52:40.270

[`qsort`经典示例是使用函数](http://linux.die.net/man/3/qsort)对元素数组进行排序。它的最后一个参数是一个函数指针，指向比较两个元素的例程，作为 void 指针传递。

```
void qsort(void *base,
           size_t nmemb,
           size_t size,
           int(*compar)(const void *, const void *)); 
```

在这里使用函数指针是必不可少的，因为无法使排序例程通用到足以知道您想要如何比较元素，因此函数指针本质上是排序函数用来让您扩展它的“回调”。

**[编辑]**例如，假设您定义了以下结构：

```
struct president {
    char * fname;
    char * lname;
    unsigned int number;
}; 
```

如果你想通过它们的“数字”字段对它们的数组进行排序，你可以实现一个“比较”（比较器）函数，如下所示：

```
int compare_presidents(const void * v1, const void * v2) {
    struct president p1 = * ((struct president *) v1);
    struct president p2 = * ((struct president *) v2);
    return (p1.number - p2.number); // Compare by number ascending.
} 
```

您可以对这样的结构数组进行排序：

```
qsort(presidents, num_presidents, sizeof(struct president), compare_presidents); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T15:53:19.380

将指向函数的指针视为实现（好吧，描述）我们现在优雅地称为回调的“石刀和熊皮”方式。这个类比并不完美，但这就是想法 - 通过指针引用提供一种快速但相当危险的方式来调用完全不同的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T16:24:16.517

启动线程是另一个例子。与 POSIX 类似，C11 具有用于启动线程的接口：

```
typedef int (*thrd_start_t)(void*);
int thrd_create(thrd_t *, thrd_start_t, void *); 
```

这里`thrd_start_t`函数指针指向将由新线程执行的函数，`void*`参数是传递给该函数的参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T15:53:57.043

一个明显的例子是`qsort`。您将一个指针传递给它将用于比较项目的函数。由于它不知道您要排序的数据类型，因此它无法真正独立完成该部分。

另一个常见的例子是进行数值积分的函数。您向它传递一个指向要集成的函数的指针以及上下限，然后它调用该函数来查找这些边界之间的各个点的值，从而为您提供答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-11T15:57:07.003

示例 1：想象有 5 种不同的排序算法。您只想在各种地方进行排序，但不想在每个地方的 5 个中进行选择。相反，您有一个指向排序算法的指针（它们都采用相同的参数、类型等）。只需选择一次算法（设置指针）并使用指针在任何地方进行排序。

示例 2：回调...一个函数在循环中执行某些操作，但每次迭代都需要应用程序反馈。对于该函数，回调是作为参数传递的函数指针。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-11T19:03:39.480

函数指针的另一个常见用例是插件。插件可以实现为可动态加载的库。当应用程序加载一个插件时，它可以调用一个预定义的函数，传入一个带有应用程序函数指针的结构体，并返回一个带有插件函数指针的结构体。现在插件和应用程序可以互相调用对方的函数了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-11T15:57:29.237

一个非常常见的用途是事件处理程序的回调函数。例如，考虑一个按钮按下处理程序。您的 button_update() 可能类似于：

```
void button_update(struct button* button, void* data) {
    if (button_pressed(button)) {
        button.callback(data);
    }
} 
```

在这种情况下， button.callback 将是一个函数指针。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-12T20:59:18.273

更重要的是：函数指针也有函数签名给出的类型。您还可以 [小心] 转换为特定的函数指针类型：

在 qsort 示例中，预期的比较器在签名中具有 const void*：

`int (*comparator)(const void *, const void *)`.

但是，如果您有*特定*（非 void*）ptr 类型的比较函数，您可以简单地将其转换为 qsort 预期签名：

`(int (*)(const void *, const void *))cmpr_specific`

类似地，typedef 可用于定义函数指针的签名，从而省去计算括号的痛苦：

`typedef int (*MYFUNC_T)(int arg);` `MYFUNC_T callptr = myfunc; callptr(10);`

，其中 myfunc 是具体的`int myfunc(int arg)`

现在想想它被定义为：`int (*fptr_arr[10])(int (*)(int));`?

好吧，typedef 使它清晰易读：`typedef int (*FUNC_T)(int arg); typedef int (*FUNC2_T)(FUNC_T func);` -- 一个接受函数指针参数的函数。

`FUNC2_T fptr_arr[10]; fptr_arr[0]=myfunc;`

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-09-11T18:06:50.880

另一个例子是一些重型系统编程或实时嵌入式编程。处理器中断向量表可以实现为函数指针数组。它们在汇编程序中以这种方式实现，如果您有一种（非 C 标准）指定函数表的内存位置的方式，也可以在 C 中完成。

# php - 快闪弹窗安装

> ID：12373547
> 
> 赞同：0
> 
> 时间：2012-09-11T15:50:37.760
> 
> 标签：php, javascript, jquery, html, flash

我一直在寻找解决方案一段时间，但没有找到合适的解决方案。
我希望你们能提供帮助...
我有一个使用 flash 的简单登录页面，我希望能够检测到此 LP 的访问者是否安装了 flash 来查看它，如果没有，我希望他们让他们能够通过下面的弹出窗口从这个登陆页面安装 Flash。

![弹出示例](../Images/df9a8788e4eb28cbfd705a169a2ff49d.png)

我怎样才能为 IE 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:01:43.600

[swfobject](http://code.google.com/p/swfobject/)提供此功能

您可以使用 hasPlayerVersion() 来检测版本：

```
if (swfobject.hasFlashPlayerVersion("9")) { } 
```

结帐此页面上的第 3 步：
[http](http://code.google.com/p/swfobject/wiki/documentation) ://code.google.com/p/swfobject/wiki/documentation 以了解如何使用 swfobject 运行插件安装程序

# javascript - 如何使用 Underscore.js 作为 Express v3 的视图引擎

> ID：12373548
> 
> 赞同：2
> 
> 时间：2012-09-11T15:50:40.607
> 
> 标签：javascript, node.js, express, underscore.js, viewengine

这里有一个问题回答 v2，但是 v3 ExpressJS api 完全不同，并且使用完全不同的布局系统。有没有人有使用 Underscore.js（如果需要使用 Consolidate.js）作为 Express v3 应用程序的主视图引擎并能够使用主布局的经验？

我把它作为主视图引擎，但没有布局工作（它只是打印出单个 html 文件）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-26T14:46:20.407

Express 3.x[移除了对 layout 和 partials 的支持](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x#view-system-changes)。如果您需要做与以前相同的事情，您可以随时使用“EJS”模板引擎，它与下划线使用的基本相同，并通过[express-partials](https://github.com/publicclass/express-partials)插件对其进行补充。

# ruby - Padrino 如何将 :index 映射到“/”？

> ID：12373550
> 
> 赞同：0
> 
> 时间：2012-09-11T15:50:45.623
> 
> 标签：ruby, metaprogramming, url-routing, padrino

我很好奇Padrino是如何完成映射的：

```
get :index do 
```

至：

```
get '/' do 
```

我很难在源中找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:58:34.887

它只是覆盖了该`get`方法，即：

```
alias old_get get

def get(path)
  if path == :index
    old_get '/'
  else
    old_get path
  end
end 
```

# jquery - Twitter Bootstrap 轮播不滑动

> ID：12373557
> 
> 赞同：1
> 
> 时间：2012-09-11T15:51:04.243
> 
> 标签：jquery, twitter-bootstrap

我尝试了 TwitterBootstrap 网站上的相同代码，但仍然无法正常工作。

在他们的网站上它滑动得很好，但在我的代码中它只是翻转图像。

编辑：在一些高分辨率屏幕中。例如：iPad 旋转木马闪烁，因此将以下 css 类添加到您的 css 文件中。希望这会有所帮助

```
.carousel .item {
-webkit-transform-style: preserve-3d;
-moz-transform-style: preserve-3d;
-ms-transform-style: preserve-3d;
-o-transform-style: preserve-3d;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T08:03:21.867

我遇到了同样的问题，发现我只包含了 javascripts 的一部分，并且缺少以下内容：

```
twitter/bootstrap/transition.js 
```

包含此内容后，轮播按预期使用动画。

# excel - 循环直到最后一个工作表

> ID：12373560
> 
> 赞同：1
> 
> 时间：2012-09-11T15:51:12.963
> 
> 标签：excel, vba

我正在尝试将格式应用于当前工作簿中的每个工作表。我尝试过“For Each”，并尝试循环遍历直到到达最后一个工作表，但由于不同的原因，这两个错误。有人可以告诉我我做错了什么吗？

方法1：它适用于第一个工作表，但不适用于其余工作表。

```
Sub format_worksheets()

    Dim ws As Worksheet
    For Each ws In Worksheets

        Columns("A:A").Select

           Selection.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
                TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
                Semicolon:=False, Comma:=True, Space:=False,     
                Other:=True,TrailingMinusNumbers:=True

        Range("A1").Select

    Next ws

End Sub 
```

方法 2：它不识别最后一个工作表。

```
Sub format_worksheets()

    Dim ws As Worksheet

    ws = Worksheet.Active

    Do

        code

    Loop Until ws = Sheets(Sheets.Count).Active

End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:55:17.730

在方法一中，尝试更改：

```
Columns("A:A").Select 
```

至

```
ws.Activate
ws.Columns("A:A").Select 
```

...激活工作表并指定要使用的工作表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T17:06:39.750

我试图弄清楚你想用方法 2 做什么，但我做不到。但这只是因为，这里有一个不适用于每个版本的工作版本。

```
Sub format_worksheets()
    dim x as Integer
    For x = 1 To Sheets.Count
        Sheets(x).Columns("A:A").TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
                    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
                    Semicolon:=False, Comma:=True, Space:=False, Other:=True, TrailingMinusNumbers:=True
    Next x
End Sub 
```

请注意，如果任何工作表在 A 列中没有数据，这将出错。我还省略了 select 语句，因为如果没有必要，最好避免使用它们。

# css - 如何在 joomla 的前端删除编辑配置文件

> ID：12373562
> 
> 赞同：-2
> 
> 时间：2012-09-11T15:51:33.283
> 
> 标签：css, joomla

当我登录网站时，我想删除或隐藏 joomla (versin2.5.6) 前端的“编辑配置文件”链接。是否可以删除它？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T11:33:38.833

转到 components/com_users/views/profile/tmp/default.php 并删除或注释掉：

```
//<a href="<?php echo JRoute::_('index.php?option=com_users&task=profile.edit&user_id='.(int) $this->data->id);?>">     <?php echo JText::_('COM_USERS_Edit_Profile'); ?></a> // 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-04T01:26:32.063

我能想到的最简单的方法是将以下内容添加到您的 CSS 中：

```
ul.actions{
display:none;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T23:49:47.080

隐藏或禁用是两件真正不同的事情。

如果您只想让按钮消失，请使用不包含它的布局覆盖。人们仍然可以访问该网址。

如果它是您的意思的配置文件插件，您可以将各个字段设置为在插件中显示或隐藏。

如果您想禁用更改密码的功能，我不确定这是否可行，尽管您可以通过覆盖使该字段消失。

# python - Python try 块不捕获 os.system 异常

> ID：12373563
> 
> 赞同：36
> 
> 时间：2012-09-11T15:51:36.033
> 
> 标签：python, try-catch, os.system, except

我有这个python代码：

```
import os
try:
  os.system('wrongcommand')
except:
  print("command does not work") 
```

代码打印：

```
wrongcommand: command not found 
```

而不是`command does not work`. 有谁知道为什么它不打印我的错误信息？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-09-11T15:56:44.310

如果你想在命令不存在时抛出异常，你应该使用`subprocess`：

```
import subprocess
try:
    subprocess.run(['wrongcommand'], check = True)
except subprocess.CalledProcessError:
    print ('wrongcommand does not exist') 
```

想一想，您可能应该使用`subprocess`而不是`os.system`无论如何...

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-09-11T15:54:59.360

因为 os.system() 通过方法的退出码表示失败

*   返回值 == 0 -> 一切正常
*   返回值！= 0 -> 一些错误

被调用命令的退出代码直接传回 Python。

有文档告诉您 os.system() 在失败的情况下会引发异常。os.system() 只是调用操作系统的底层 system() 调用并返回其返回值。

*请仔细*阅读 os.system() 文档。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2019-06-24T07:56:01.703

虽然 subprocess 可能是你最好的朋友。os.system 在某些地方仍然有用，尤其是对于玩 C/C++ 模式的程序员。

因此，代码将在下面。

```
import os

try:
  os_cmd = 'wrongcommand'
  if os.system(os_cmd) != 0:
      raise Exception('wrongcommand does not exist')
except:
  print("command does not work") 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-11T15:54:27.253

您的代码段中有两个问题。首先，永远不要只是做`try: ... except:`，总是要明确你想要处理的异常。否则，您的程序只会吞下任何类型的错误，包括那些您不期望的错误。在大多数情况下，这会在运行时的某个其他时间点导致意外行为。

此外，`os.system()`大多数时候调用应该被`subprocess`模块中的对应调用替换。

要查看出了什么问题，请忽略 try/except 块并实际查看回溯/异常。正如其他人指出的那样，您会注意到您的情况没有例外，这就是不打印自定义字符串的原因。

底线：考虑在您的代码块中可能发生哪些特定异常。仔细考虑由于某些原因您希望发生哪些情况并适当地处理这些情况。不要处理那些你不期望的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-11T15:54:09.957

`wrongcommand: command not found``os.system`是用于调用命令 的 shell 的输出。`os.system`没有抛出异常

编辑：由 mgilson 评论的复制和粘贴部分编辑

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-24T10:17:16.810

还有一种更简单的方法是：

```
import os

def dat():
        if os.system('date') == 0:
            print("Command successfully executed")
        else:
            print("Command failed to execute")

dat() 
```

# sublimetext2 - 是否有支持读写 Haskell 文件 (.lhs) 的 Sublime Text 2 包？

> ID：12373565
> 
> 赞同：3
> 
> 时间：2012-09-11T15:52:09.413
> 
> 标签：sublimetext2

我找到了在 Haskell 文件 (.hs) 上给我语法高亮但不识字 Haskell 文件 (.lhs) 的包。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T22:21:50.153

添加鸟样式很容易，只需编辑您`Literate Haskell.tmLanguage`添加以下内容：

```
<!-- ... -->
<string>Literate Haskell</string>
<key>patterns</key>
<array>
      <!-- Start here -->
      <dict>
            <key>begin</key>
            <string>^&gt;</string>
            <key>end</key>
            <string>$</string>
            <key>patterns</key>
            <array>
                  <dict>
                        <key>include</key>
                        <string>source.haskell</string>
                  </dict>
            </array>
      </dict>
<!-- ... --> 
```

这只是一个正则表达式，说“从 > 开始到换行符是源”。我不确定这有多强大（美元符号往往行为不端iirc），但我想这是朝着正确方向的暗示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-08T17:43:45.187

由于代表人数少，我无法发表评论。

在很大程度上基于大卫的回答，我为 Bird Style 制作了一个自定义的 .tmLanguge 文件，并将其上传到我的[bitbucket。](https://bitbucket.org/wrossmck/literate-haskell-bird-style)

要安装，只需下载提供的 .tmLanguage 文件，并将其移动到您的包文件夹中。

在 OSX 上，它位于`~/Library/Application Support/Sublime Text 2/Packages/Haskell/`

您可以访问您的包裹位置`Preferences -> Browse Packages...`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T09:23:54.533

从 2.0.1 开始，支持 literate Haskell，但仅支持 tex 而不是 Bird 样式。

# mysql - MySql INSERT WHERE 然后 SELECT 子查询

> ID：12373568
> 
> 赞同：1
> 
> 时间：2012-09-11T15:52:18.057
> 
> 标签：mysql

我试图将值插入到表中，其中行的 ID 只能通过在另一个表上执行 SELECT WHERE 来找到。以下是我的查询：

```
INSERT INTO wp_postmeta (meta_key, meta_value) 
VALUES ('editor_review','5') 
WHERE post_id=(SELECT ID from wp_posts 
               WHERE post_title 
              LIKE "%The Honest Kitchen ZEAL Grain Free Gluten Free All Life Stages Dog Food%"); 
```

有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:54:43.547

```
INSERT INTO wp_postmeta
    (post_id, meta_key, meta_value)
    SELECT id, 'editor_review', '5'
        FROM wp_posts
        WHERE post_title LIKE '%The Honest Kitchen ZEAL Grain Free Gluten Free All Life Stages Dog Food%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:54:52.797

您可以`INSERT INTO...SELECT`为此使用语句。

```
INSERT INTO wp_postmeta (meta_key, meta_value) 
SELECT colA, colB
FROM wp_posts 
WHERE post_title 
LIKE "%The Honest Kitchen ZEAL Grain Free Gluten Free All Life Stages Dog Food%" 
```

注意列数必须相互匹配（也是它们的数据类型）

# sql - SQL Server 2008 R2 Express 'Group by' 跨 2 个表

> ID：12373569
> 
> 赞同：1
> 
> 时间：2012-09-11T15:52:28.757
> 
> 标签：sql, sql-server

我有 2 个表，我正在尝试组合它们以便`group by`对它们执行功能。我处理这个问题的原因是这两个表的组合大于`10 GB`数据库限制`SQL Server Express`（每个表约为 9 GB）。第二张表只是第一张表的延续。它看起来像这样：

```
 CustId        Sale
    001         4.25
    002        15.24
    003         8.78
    004       122.99
    005        44.80
    ...         ... 
```

如果是一张桌子，我会使用这样的东西：

```
select CustId, sum(Sale) sumSale
from table1
group by CustId 
```

有没有办法纵向组合而不是横向组合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:57:05.977

您可以使用`union`：

```
select CustId, sum(Sale) sumSale
from (
    select CustId, Sale
    from table1
    union all
    select CustId, Sale
    from table2)
group by CustId 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T15:58:56.943

在我看来，工会在这里会有所帮助：

```
Select custId, sum(sale)
  from (select custid, sale
          from table1
         union 
        select custid, sale
          from table2)
 group by custId 
```

# c# - 当前数据透视页面的视觉元素

> ID：12373577
> 
> 赞同：0
> 
> 时间：2012-09-11T15:52:45.937
> 
> 标签：c#, silverlight, windows-phone-7, pivot, visual-tree

我正在为 Windows Phone 7 使用 C#、Silverlight、Visual Studio。

我有兴趣只获取在枢轴期间当前显示在屏幕上的视觉元素。例如，我的枢轴可能有 5 个 PivotItem，但我只想获取每次轻弹后显示的项目。

现在，我可以从可视化树中获取整个枢轴，显然我可以选择一个特定的 PivotItem。但我希望能够只获得屏幕上的当前枢轴。最终目标是获取屏幕上元素的绝对位置，而不考虑当前的 PivotItem。

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:25:26.653

`SelectedItem`和/或`SelectedIndex`在 Pivot 上将返回当前可见的 PivotItem。

示例代码为您说明我的观点：

XAML：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <!--Pivot Control-->
    <controls:Pivot x:Name="SomePivot" Title="MY SAMPLE PIVOT">
            <StackPanel>
                <Button Content="Button 0"/>
                <Button Content="Button 1"/>
                <Button Content="Button 2"/>
                <Button Content="Button 3"/>
                <Button Content="Button 4"/>
                <Button Content="Button 5"/>
                <Button Content="Button 6"/>
                <Button Content="Button 7"/>
                <Button Content="Button 8"/>
                <Button Content="Button 9"/>
                <Button Content="Button 0"/>
                <Button Content="Button 1"/>
                <Button Content="Button 2"/>
                <Button Content="Button 3"/>
                <Button Content="Button 4"/>
                <Button Content="Button 5"/>
                <Button Content="Button 6"/>
                <Button Content="Button 7"/>
                <Button Content="Button 8"/>
                <Button Content="Button 9"/>
            </StackPanel>
        </controls:PivotItem>
        <controls:PivotItem Header="item2">
            <Button Content="Button D" Name="B"/>
        </controls:PivotItem>
        <controls:PivotItem Header="item3">
            <Button Content="Button D" Name="C"/>
        </controls:PivotItem>
        <controls:PivotItem Header="item4">
            <Button Content="Button D" Name="D"/>
        </controls:PivotItem>
    </controls:Pivot>

    <Button Grid.Row="1" Content="Get Current Pivot Item" Click="GetCurrentPivotItem"/>
</Grid> 
```

代码隐藏：

```
private void GetCurrentPivotItem(object sender, RoutedEventArgs e)
{
    PivotItem pivotItem = (PivotItem)SomePivot.SelectedItem;
    Debug.WriteLine("Pivot Item : {0}", pivotItem.Header);
    foreach (var element in VisualTreeHelper.FindElementsInHostCoordinates(new Rect(20, 0, 480, 700), pivotItem))
    {
        if (element is Button)
        {
            Debug.WriteLine("{0}", ((Button)element).Content);
        }
    }
} 
```

这有帮助吗？

# javascript - JSON中的“Lorem ipsum”Web服务数据？

> ID：12373578
> 
> 赞同：0
> 
> 时间：2012-09-11T15:52:50.993
> 
> 标签：javascript, ajax, json, jsonp, lorem-ipsum

是否有任何通过 JSON 提供的示例 Web 服务？我想消耗一些用于测试和学习。我也不介意离线下载带有图像和内容的 JSON 文件。也许甚至还有我可以用来学习的实时公共数据。这将节省大量启动项目或原型的时间。任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T15:58:12.777

维基百科就是一个简单的例子。

这是一个漂亮的印刷版：

*   [http://en.wikipedia.org/w/api.php?action=query&titles=Albert%20Einstein&prop=info&format=jsonfm&callback=foo](http://en.wikipedia.org/w/api.php?action=query&titles=Albert%20Einstein&prop=info&format=jsonfm&callback=foo)

这是jsonp中的：

*   [http://en.wikipedia.org/w/api.php?action=query&titles=Albert%20Einstein&prop=info&format=json&callback=foo](http://en.wikipedia.org/w/api.php?action=query&titles=Albert%20Einstein&prop=info&format=json&callback=foo)

# linux - 如何来回反向搜索？

> ID：12373586
> 
> 赞同：146
> 
> 时间：2012-09-11T15:53:07.290
> 
> 标签：linux, bash, shell, search

我`reverse-i-search`经常使用，这很酷。有时，尽管多次按`CTRL`+时，我会*传递*我实际正在寻找的命令。因为+在历史上向后搜索，从最新到最旧，我必须：`r`*`CTRL``r`*

 *1.  取消，
2.  再次搜索并
3.  完全停在命令处，而不通过它。

在`reverse-i-search`提示时，是否可以向前搜索，即从我所在的位置到最新的位置。我天真地尝试了`CTRL`++ ，没有运气。我听说过+但这不是我在这里所期望的。有人有想法吗？`Shift``r``CTRL``g`

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2013-03-06T09:35:56.013

这里有一个类似的问题：

[bash 中的 Control-r reverse-i-search：如何“重置”Cygwin 中的搜索？](https://stackoverflow.com/questions/549810/control-r-reverse-i-search-in-cygwin-bash-how-do-you-reset-the-search)

在超级用户上找到另一个类似的问题：

[Bash 中的（反向搜索）](https://superuser.com/questions/159106/reverse-i-search-in-bash)

显然，两者都提到`Ctrl`+ `s`，这可能会奏效。

希望有帮助。我自己正在尝试找到一段代码`reverse-i-search`来检查它是如何实现的。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2016-03-31T10:42:51.617

`CTRL`+`S`

...使用后为我解决了...

```
stty -ixon 
```

如果 CTRL+S 对您不起作用是因为根据[Vincenzo Pii](https://stackoverflow.com/questions/17760474/reverse-intelligent-search-reverse-i-search-how-to-get-previous-result?rq=1)在另一个相关线程中接受的答案：

> 问题在于，在许多终端中，默认情况下使用此绑定来发送暂停传输代码（`XOF`）。
> 
> 如`man stty`：
> 
> > ```
> > [-]ixon
> >     enable XON/XOFF flow control 
> > ```
> 
> 因此，如果您在终端上启用了此选项（`stty -a`包含`ixon`前面`-`没有符号的输出），则不能在*reverse-i-search*的上下文中使用`CTRL`+ 。`S`
> 
>  *要禁用它，请使用以下命令：
> 
> ```
> stty -ixon 
> ```
> 
> 而`CTRL`+`S`会给你一个`(i-search)`（非反向）。*

 ** * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-01-27T22:04:48.320

尝试`delete`，神奇地工作。

其他人指向`CTRL`+ `s`，但它对我不起作用。**

# derby - 用 Apache 的 derby.jar 替换 Oracle 的 derby.jar

> ID：12373594
> 
> 赞同：0
> 
> 时间：2012-09-11T15:53:29.667
> 
> 标签：derby, javadb

简短版本：我可以用来自 Apache 的最新 derby.jar 替换我的 JDK（来自 Oracle）附带的 derby.jar 吗？

长版：几年来，我一直在使用 JDK 附带的 Java DB（Oracle 支持的 Apache Derby 开源数据库发行版）。我刚刚发现 Apache 仍然对 Derby 数据库库进行定期更新，2012 年 6 月的最新更新在[这里](http://db.apache.org/derby/releases/release-10.9.1.0.cgi)。最新的一个包含一些我想使用的功能。

但是 Oracle derby.jar 可以与 Apache derby.jar 互换吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:29:14.490

我认为您应该有一些问题，但请注意这将被视为升级，因此您应该花一些时间阅读[http://db.apache.org/derby/docs/10.9/devguide/cdevupgrades.html](http://db.apache.org/derby/docs/10.9/devguide/cdevupgrades.html)并获得对“软”和“硬”升级的概念感到满意。

也就是说，如果你真的希望这两个 jar 是“可互换的”，也就是说你想使用较新版本的 Derby，那么回到旧版本，然后确保只进行软升级，因为一旦你有了进行了硬升级，您无法回到旧版本。

我会说，我自己切换到较新的 Apache derby.jar，对现有数据库进行硬升级，并计划**不**回到旧版本的 Derby。

# python - 使用 sqlalchemy 和 mysql 执行批量插入

> ID：12373603
> 
> 赞同：0
> 
> 时间：2012-09-11T15:54:00.567
> 
> 标签：python, mysql, sqlalchemy

我正在动态创建批量插入查询。在我的应用程序中，我使用 sqlAlchemy，我想执行该插入。

问题出在我创建查询时。我想插入包含应该转义的特殊字符的数据。

使用 MysqlDb 模块有一个函数 MySQLdb.escape_string 可以转义特殊字符，但不幸的是不适用于 Unicode 字符。

我有哪些选择？

我想注意到创建查询并不容易

```
q = INSERT INTO table (a, b) VALUES (:a1, :b1), (:a2, :b2) 
q_dict = {(a1, b1), (a2, b2)} 
```

所以我可以执行 Session.execute(q, q_dict) 。

是否有一个接受字符串并转义所有需要为 Mysql 转义的字符的 python 函数？

想象一下，我想创建一个文件写入磁盘，然后通过 mysql 控制台执行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T09:21:17.457

这是解决方案：

首先获得一个 DBAPi 连接

```
 connection = engine. raw_connection() 
```

然后您可以使用以下命令转义字符串 v：

```
 connection.escape(v) 
```

# c++ - 在opengl中删除2个四边形相交处的白线

> ID：12373605
> 
> 赞同：3
> 
> 时间：2012-09-11T15:54:09.073
> 
> 标签：c++, opengl

我正在构建一个用户从内向外看的盒子，一个天空盒子或类似的东西。我这样做是通过取 6 个四边形并用它们创建一个立方体，然后将理论相机放在立方体内并用图像对立方体进行纹理处理。用户可以使用鼠标环顾四周，立方体旋转，看起来好像一个人在移动他们的头。我遇到了在两侧的交叉点出现白线的问题，我尝试在保持实际四边形大小相同的同时拉入四边形。我已经确定清晰的颜色是黑色的，我仍然得到白线。

这是我设置的属性：

```
glClearColor(0.0, 0.0, 0.0, 0.0); 
glEnable(GL_DEPTH_TEST);
glClear(GL_COLOR_BUFFER_BIT);

glClearDepth(1);
//S is the side length of the cube
float s = 5;
glShadeModel(GL_SMOOTH);
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

glHint(GL_POLYGON_SMOOTH, GL_NICEST);

glEnable(GL_POLYGON_SMOOTH);

glDisable(GL_COLOR_MATERIAL);
glDisable(GL_LIGHTING);

glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP);

glPixelStorei(GL_UNPACK_ALIGNMENT, 1); 
```

这是创建多维数据集的代码：

```
float s = 5; //S is the side length of each quad
glNewList(m_cube, GL_COMPILE);
    {
        glPushMatrix();
        {
            glEnable(GL_TEXTURE_2D);

            glPushMatrix();
            {

                glBegin(GL_QUADS);
                {

                    //front
                    {
                        glTexCoord2f(0.5f, (1.0f / 3.0f));
                        //       glColor3f(1, 0, 0);
                        glVertex3f(((s / 2.0f)), ((s / 2.0f)),
                                   -((s / 2.0f))); //1

                        glTexCoord2f(0.25f, (1.0f / 3.0f));
                        //       glColor3f(1, 1, 0);
                        glVertex3f(-((s / 2.0f)), ((s / 2.0f)),
                                   -((s / 2.0f))); //2
                        glTexCoord2f(0.25f, (2.0f / 3.0f));
                        //       glColor3f(1, 0, 1);
                        glVertex3f(-((s / 2.0f)), -((s / 2.0f)),
                                   -((s / 2.0f))); //3
                        glTexCoord2f(0.5f, (2.0f / 3.0f));
                        //       glColor3f(1, 1, 1);
                        glVertex3f(((s / 2.0f)), -((s / 2.0f)),
                                   -((s / 2.0f))); //4
                    }

                    //left
                    {
                        glTexCoord2f(0.25f, (1.0f / 3.0f));
                        //       glColor3f(1, 0, 0);
                        glVertex3f(-((s / 2.0f)), ((s / 2.0f)),
                                   -((s / 2.0f))); //2
                        glTexCoord2f(0.0f, (1.0f / 3.0f));
                        //       glColor3f(1, 1, 0);
                        glVertex3f(-((s / 2.0f)), ((s / 2.0f)),
                                   ((s / 2.0f))); //5
                        glTexCoord2f(0.0f, (2.0f / 3.0f));
                        //       glColor3f(1, 0, 1);
                        glVertex3f(-((s / 2.0f)), -((s / 2.0f)),
                                   ((s / 2.0f))); //6
                        glTexCoord2f(0.25f, (2.0f / 3.0f));
                        //       glColor3f(1, 1, 1);
                        glVertex3f(-((s / 2.0f)), -((s / 2.0f)),
                                   -((s / 2.0f))); //3
                    }

                    //right
                    {
                        glTexCoord2f(0.75f, (1.0f / 3.0f));
                        //       glColor3f(1, 0, 0);
                        glVertex3f(((s / 2.0f)), ((s / 2.0f)),
                                   ((s / 2.0f))); //7
                        glTexCoord2f(0.5f, (1.0f / 3.0f));
                        //       glColor3f(1, 1, 0);
                        glVertex3f(((s / 2.0f)), ((s / 2.0f)),
                                   -((s / 2.0f))); //1
                        glTexCoord2f(0.5f, (2.0f / 3.0f));
                        //       glColor3f(1, 0, 1);
                        glVertex3f(((s / 2.0f)), -((s / 2.0f)),
                                   -((s / 2.0f))); //4
                        glTexCoord2f(0.75f, (2.0f / 3.0f));
                        //       glColor3f(1, 1, 1);
                        glVertex3f(((s / 2.0f)), -((s / 2.0f)),
                                   ((s / 2.0f))); //8
                    }

                    //back
                    {
                        glTexCoord2f(1.0f, (1.0f / 3.0f));
                        //       glColor3f(1, 0, 0);
                        glVertex3f(-((s / 2.0f)), ((s / 2.0f)),
                                   ((s / 2.0f))); //5
                        glTexCoord2f(0.75f, (1.0f / 3.0f));
                        //       glColor3f(1, 1, 0);
                        glVertex3f(((s / 2.0f)), ((s / 2.0f)),
                                   ((s / 2.0f))); //7
                        glTexCoord2f(0.75f, (2.0f / 3.0f));
                        //       glColor3f(1, 0, 1);
                        glVertex3f(((s / 2.0f)), -((s / 2.0f)),
                                   ((s / 2.0f))); //8
                        glTexCoord2f(1.0f, (2.0f / 3.0f));
                        //       glColor3f(1, 1, 1);
                        glVertex3f(-((s / 2.0f)), -((s / 2.0f)),
                                   ((s / 2.0f))); //6
                    }

                    //top
                    {
                        glTexCoord2f(.5f, 1.0f);
                        //       glColor3f(1, 0, 0);
                        glVertex3f(((s / 2.0f)), -((s / 2.0f)),
                                   ((s / 2.0f))); //7
                        glTexCoord2f(0.25f, 1.0f);
                        //       glColor3f(1, 1, 0);
                        glVertex3f(-((s / 2.0f)), -((s / 2.0f)),
                                   ((s / 2.0f))); //5
                        glTexCoord2f(0.25f, (2.0f / 3.0f));
                        //       glColor3f(1, 0, 1);
                        glVertex3f(-((s / 2.0f)), -((s / 2.0f)),
                                   -((s / 2.0f))); //2
                        glTexCoord2f(.5f, (2.0f / 3.0f));
                        //       glColor3f(1, 1, 1);
                        glVertex3f(((s / 2.0f)), -((s / 2.0f)),
                                   -((s / 2.0f))); //1
                    }

                    //bottom
                    {
                        glTexCoord2f(.5f, (1.0f / 3.0f));
                        //       glColor3f(1, 0, 0);
                        glVertex3f(((s / 2.0f)), ((s / 2.0f)),
                                   -((s / 2.0f))); //4
                        glTexCoord2f(0.25f, (1.0f / 3.0f));
                        //       glColor3f(1, 1, 0);
                        glVertex3f(-((s / 2.0f)), ((s / 2.0f)),
                                   -((s / 2.0f))); //3
                        glTexCoord2f(0.25f, 0.0f);
                        //       glColor3f(1, 0, 1);
                        glVertex3f(-((s / 2.0f)), ((s / 2.0f)),
                                   ((s / 2.0f))); //6
                        glTexCoord2f(.5f, 0.0f);
                        //       glColor3f(1, 1, 1);
                        glVertex3f(((s / 2.0f)), ((s / 2.0f)),
                                   ((s / 2.0f))); //8
                    }

                }
                glEnd();

            }
            glPopMatrix();
            glDisable(GL_TEXTURE_2D);
        }
        glPopMatrix();
    }
    glEndList(); 
```

这是设置 camara 的代码：

```
float near_ = 1f;
float far_ = 10.0f;

float halfHeight = near_ * (Radian(m_fov)) / 2.0f;
float halfWidth = (static_cast<float>((m_width)) / static_cast<float>((m_height))) * halfHeight;
glViewport(0, 0, m_width, m_height);

glMatrixMode(GL_PROJECTION);
glLoadIdentity();

glFrustum(-halfWidth, halfWidth, -halfHeight, halfHeight, near_, far_);
glMatrixMode(GL_MODELVIEW);
glLoadIdentity(); 
```

这是呈现到屏幕的代码：

```
void VideoStreamer::render()
{
glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

float pitch = clamp(Degree(m_pitch), Degree(-(80.f)), Degree(80.f));
float yaw = wrap(m_yaw, Degree(0), Degree(360));
float roll = wrap(m_roll, Degree(0), Degree(360));
glPushMatrix();
{
    glLineWidth(5);
    glPushMatrix();
    {
        if (1)
        {
            glRotatef(pitch, 1.0, 0.0, 0.0);
            glRotatef(yaw, 0.0, 1.0, 0.0);
            glRotatef(roll, 0.0, 0.0, 1.0);
        }

        glCallList((m_cube));
    }
    glPopMatrix();
}
glPopMatrix();
SDL_GL_SwapBuffers();
}//end render 
```

这是正在发生的事情的屏幕截图，请注意蓝色和黑色四边形之间的白线：
![在此处输入图像描述](../Images/a12617bf9c42541f9467a00fb5e4d419.png)

这是我正在使用的纹理，分辨率为 600x450，但线条以多种分辨率出现：

![在此处输入图像描述](../Images/53d7d8a3a6d1d821cc08251fb9b10208.png)

我的问题是：我如何摆脱那条白线？

编辑：白线只出现在顶部和底部与左右相交的地方

编辑：更新代码以反映建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:44:55.937

我不能在评论部分给你这张图片，所以你能增加四边形的长度，同时让它们保持在与这张图片相同的平面高度吗？

![在此处输入图像描述](../Images/1db67b714913ff5c0a971390e6abccab.png)

您的 GPU 中的浮点精度是多少？

```
float near_ = 0.00000001f; 
```

所以你已经尝试过：

![在此处输入图像描述](../Images/8289a0a7cacaaa68474e98e42df83c20.png)

您使用的是什么[屏幕子空间划分技术？](http://en.wikipedia.org/wiki/Texture_mapping)

![在此处输入图像描述](../Images/ac38c97fcee69e404ccd6ee65c5525a8.png)

假设：您的虚线可能来自[Z-fighting](http://en.wikipedia.org/wiki/Z-fighting)

**Z-fighting**是 3D 渲染中的一种现象，当两个或多个图元在 z 缓冲区中具有相似值时会发生这种现象。它在共面多边形中尤为普遍，其中两个面基本上占据相同的空间，而前面都不在。受影响的像素用来自一个多边形或另一个多边形的片段任意渲染，其方式由**z-buffer**的精度决定。它也可以随着*场景或摄像机的变化而变化，导致一个多边形“赢得” z 测试*，然后是另一个，依此类推。整体效果是**两个多边形的闪烁、嘈杂的光栅化，它们“战斗”以着色屏幕像素**。这个问题通常是由有限**的亚像素精度**和浮点数和**定点舍入误差**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T19:46:58.927

您所看到的只是您的纹理中确实有白色。因此，面部边界上的片段最终会从白色部分获取（如果您在纹理上打开线性过滤器类型，您会更清楚地看到这一点）。

你可以做些什么来解决它：

1.  在展开的立方体纹理的边界处复制预期的颜色（在蓝色的左侧添加红色，在右侧添加黑色，在红色和黑色的顶部添加蓝色，等等底部...）
2.  或者更好的是，将您的代码切换为使用立方体贴图而不是 2d 贴图。它们在立方体面提供适当的过滤

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T19:41:52.727

问题在于纹理存在纹理泄漏，导致两侧之间出现边框颜色。我的数学是正确的，并放置了纹理纹素，但是我可以修复正在发生的浮点错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T16:55:07.090

这看起来有点像闪烁，这几乎总是由舍入误差引起的。您的四边形的大小看起来非常合理，但您的近平面的值非常小。当您将顶点乘以 MVP 矩阵时，这可能会导致较大的舍入误差。尝试将近平面设置为`.1f`。

**编辑**否则，请检查您的顶点创建代码是否存在可能的错误。我有点难以理解 - 例如，顶面是使用`-((s / 2.0f)-.1),`- 你为什么要减去 0.1 来计算的？

也许编写一个新函数来创建顶点并在值中硬编码将是一种快速测试这是否是问题的方法。

# java - 对接口重写方法的反思

> ID：12373607
> 
> 赞同：6
> 
> 时间：2012-09-11T15:54:10.317
> 
> 标签：java, generics, reflection, overriding

我有以下代码，其通用`ITest`接口由非通用接口扩展`ITestDouble`。该`op`方法被 覆盖`ITestDouble`。

当我尝试列出 的所有方法时`ITestDouble`，我得到`op`了两次。如何验证它们实际上是相同的方法？

```
public class Test {

    public static void main(String[] args) throws NoSuchMethodException {
        for (Method m : ITestDouble.class.getMethods()) {
            System.out.println(m.getDeclaringClass() + ": " + m + "(bridge: " + m.isBridge() + ")");
        }
    }

    public interface ITestDouble extends ITest<Double> {
        @Override
        public int op(Double value);

        @Override
        public void other();
    }

    public interface ITest<T extends Number> {
        public int op(T value);

        public void other();
    }
} 
```

输出：

```
interface Test$ITestDouble: public abstract int Test$ITestDouble.op(java.lang.Double)(bridge: false)
interface Test$ITestDouble: public abstract void Test$ITestDouble.other()(bridge: false)
interface Test$ITest: public abstract int Test$ITest.op(java.lang.Number)(bridge: false) 
```

[PS 我知道这与Java Class.getMethods() behavior on overridden methods](https://stackoverflow.com/questions/6204339/java-class-getmethods-behavior-on-overridden-methods)是同一个问题，但是这个问题没有得到真正的答案：`isBridge()`调用总是返回`false`。

编辑：我也可以使用任何可以`op`为我过滤掉“重复”方法的肮脏工作的库。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T08:29:33.117

不幸的是，您无法获得该信息，因为就**JVM**而言，它`ITestDouble`具有`op(Number)`完全独立于`op(Double)`. 实际上是您的 Java**编译器**确保方法始终一致。

这意味着您可以使用 JDK5 之前的编译器或动态代理创建`ITestDouble`具有完全不同实现的`op(Number)`病态实现：`op(Double)`

```
public static void main(String[] args) throws NoSuchMethodException {

    final Method opNumber = ITest.class.getMethod("op", Number.class);
    final Method opDouble = ITestDouble.class.getMethod("op", Double.class);
    final Method other = ITestDouble.class.getMethod("other");

    ITestDouble dynamic = (ITestDouble) Proxy.newProxyInstance(
            ITestDouble.class.getClassLoader(),
            new Class<?>[]{ITestDouble.class},
            new InvocationHandler() {
                @Override
                public Object invoke(Object proxy, Method m, Object[] args) throws Throwable {
                    if (opDouble.equals(m)) return 1;
                    if (opNumber.equals(m)) return 2;
                    // etc....

                    return null;
                }
            });

    System.out.println("op(Double): " + dynamic.op(null);            // prints 1.
    System.out.println("op(Number): " + ((ITest) dynamic).op(null);  // prints 2\. Compiler gives warning for raw types
} 
```

**编辑：** 刚刚了解了[Java ClassMate](https://github.com/cowtowncoder/java-classmate)。它是一个可以正确解析声明中所有类型变量的库。这是非常容易使用：

```
 TypeResolver typeResolver = new TypeResolver();
    MemberResolver memberResolver = new MemberResolver(typeResolver);

    ResolvedType type = typeResolver.resolve(ITestDouble.class);
    ResolvedTypeWithMembers members = memberResolver.resolve(type, null, null);
    ResolvedMethod[] methods = members.getMemberMethods(); 
```

现在，如果您遍历，`methods`您将看到以下内容：

```
void other();
int op(java.lang.Double);
int op(java.lang.Double); 
```

现在很容易过滤重复项：

```
public boolean canOverride(ResolvedMethod m1, ResolvedMethod m2) {
    if (!m1.getName().equals(m2.getName())) return false;

    int count = m1.getArgumentCount();
    if (count != m2.getArgumentCount()) return false;

    for (int i = 0; i < count; i++) {
        if (!m1.getArgumentType(i).equals(m2.getArgumentType(i))) return false;
    }

    return true;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-21T08:39:55.897

到目前为止，每个受访者都做出了积极贡献，但我会尝试将不同的想法总结成一个答案。理解发生了什么的关键是 Java 编译器和 JVM 如何实现泛型——这解释了桥，以及为什么它在接口中是错误的。

总之，虽然：

1.  `int op(Number)`签名兼容性和构建实现的桥接方法需要更通用的方法

2.  该`isBridge()`方法仅适用于具体类，而不适用于接口

3.  您选择这两种方法中的哪一种可能并不重要——它们在运行时中的工作方式相同。

好的，这是长答案：

**Java 的泛型实现**

当您有一个泛型类或接口时，编译器会在类文件中构造一个方法，其中每个泛型类型都替换为适当的具体类型。例如，`ITest`有一个方法：

```
int op(T value) 
```

其中类定义`T`为`T extends Number`，所以类文件有一个方法：

```
int op(Number); 
```

使用`ITest`时，编译器会为泛型解析为的每种类型创建额外的类。例如，如果有一行代码：

```
ITest<Double> t = new ... 
```

编译器使用以下方法生成一个类：

```
int op(Number);
int op(Double); 
```

但是JVM肯定只需要`int op(Double)`版本吗？编译器不确保`ITest<Double>`只接收调用`op(Double)`吗？

`int op(Number)`Java 需要该方法的原因有两个：

1.  面向对象要求无论你在哪里使用一个类，你都可以用一个子类*来*替换它（至少从类型安全的角度来看）。如果`int op(Number)`不存在，该类将不会提供超类（或超接口）签名的完整实现。

2.  Java 是一种同时具有强制转换和反射的动态语言，因此可能*会*调用错误类型的方法。在这一点上，Java 保证你得到一个类转换异常。

实际上，上面2.的实现是由编译器产生一个“桥接方法”来实现的。

**桥接方法有什么作用？**

当`ITest<Double>`is created from`ITest<T extends Number>`时，编译器创建该`int op(Number)`方法，其实现为：

```
public int op(Number n) {
    return this.op((Double) n);
} 
```

这个实现有两个属性：

1.  其中 n 是 a `Double`，它将调用委托给`int op(Double)`，并且

2.  当 n*不是*a `Double`时，它会导致`ClassCastException`。

此方法是从泛型类型到具体类型的“桥梁”。从本质上讲，*只有具体的方法才能成为桥梁*，所以`int op(Double)`子接口上的 只是一个签名。

**OP呢？**

在问题的示例中，`ITestDouble`编译器创建的子接口类文件具有两种方法：

```
int op(Number);
int op(Double); 
```

这`int op(Number)`是必需的，以便实现`ITestDouble`可以拥有它们的桥接方法 -**但此方法本身不是桥接**，因为它只是一个签名，而不是一个实现。可以说 Sun/Oracle 在这里错过了一个技巧，可能值得向他们提出一个错误。

**如何找到正确的方法？**

**首先，重要吗？**的所有实现都`ITestDouble`将由编译器自动插入桥接方法，并且桥接方法调用该`int op(Double)`方法。换句话说，调用哪个方法并不重要，只要选择一个即可。

其次，在运行时你很可能会被传递**实例**，而不是接口。当您执行 时`getMethods()`，您将能够区分桥接方法和实际实现。这是[约翰卡尔](https://stackoverflow.com/users/654187/johncarl)所说的。

第三，如果您确实需要通过询问接口来解决这个问题，您可能需要测试“最低”子类型的参数。例如，在元级别：

1.  收集所有同名的两个方法

2.  收集参数类型：`Method.getParameterTypes()[0]`

3.  使用`Class.isAssignableFrom(Class)`. 如果参数相同或者是调用该方法的类的子类，则该方法返回 true。

4.  使用参数是另一个方法参数的*子类*的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-20T08:08:10.150

这可能适用于您的需要。根据特定需求或任何失败情况对其进行调整。简而言之，它检查该方法是否与为所声明的类声明的确切“通用”类型匹配。如果您使用自己的泛型，这可能会失败。我建议将对 getDeclaringClass() 的调用与您自己的泛型逻辑结合起来。

```
public static boolean matchesGenericSignature(Method m) {
    Type[] parameters = m.getGenericParameterTypes();
    if (parameters.length == 0)
        return false;
    Class<?> declaring = m.getDeclaringClass();
    TypeVariable<?>[] types = declaring.getTypeParameters();
    for (TypeVariable<?> typeVariable : types) {
        for (Type parameter : parameters) {
            if (typeVariable.equals(parameter)) {
                return true;
            }
        }
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T16:17:54.457

更新：

对于您的解决方案，请尝试此方法 (Method.getGenericParameterTypes())：

```
public static void main(String[] args) {

    for (Method m : ITestDouble.class.getMethods()) {
        Type [] types = m.getGenericParameterTypes();
        System.out.println(m.getDeclaringClass() + ": " + m + "(genericParameterTypes: "
                + Arrays.toString(types) + ")"+" "+(types.length>0?types[0].getClass():""));

        Type t = types.length>0?types[0]:null;
        if(t instanceof TypeVariable){
            TypeVariable<?> v = (TypeVariable)t;
            System.out.println(v.getName()+": "+Arrays.toString(v.getBounds()));
        }
    }

} 
```

输出是：

```
interface FakeTest$ITestDouble: public abstract int FakeTest$ITestDouble.op(java.lang.Double)(genericParameterTypes: [class java.lang.Double]) class java.lang.Class
interface FakeTest$ITestDouble: public abstract void FakeTest$ITestDouble.other()(genericParameterTypes: []) 
interface FakeTest$ITest: public abstract int FakeTest$ITest.op(java.lang.Number)(genericParameterTypes: [T]) class sun.reflect.generics.reflectiveObjects.TypeVariableImpl
T: [class java.lang.Number] 
```

* * *

泛型在编译期间被删除。所以你真的有：

```
 public interface ITestDouble extends ITest {

        public int op(Double value);

        @Override
        public void other();
    }

    public interface ITest {
        public int op(Number value);

        public void other();
    } 
```

ITest 类不知道你有多少实现。所以它只有一个带有参数 Number 的方法 op。**您可以使用T extends Number**定义无限实现。（在你的 T = 双倍）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-14T18:15:21.470

您可以使用方法[getDeclaredMethods()](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getDeclaredMethods%28%29)而不是 getMethods() 来仅获取在您所反映的类（不是超类）上声明的方法。它解决了重复方法的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-11T16:58:03.283

我知道这可能无法回答您的问题或 100% 解决您的问题，但您可以使用 isBridge() 方法来确定具体类实现了哪些方法，以及哪些方法通常是“桥接”的：

```
public class Test {

    public static void main(String[] args) throws NoSuchMethodException {
        for (Method m : TestDouble.class.getMethods()) {
            System.out.println(m.getDeclaringClass() + ": " + m + "(bridge: " + m.isBridge() + ")");
        }
    }

    public class TestDouble extends ITestDouble{
        public int op(Double value) {
            return 0;
        }

        public void other() {
        }
    }

    public interface ITestDouble extends ITest<Double> {

        public int op(Double value);

        public void other();
    }

    public interface ITest<T extends Number> {
        public int op(T value);

        public void other();
    }
} 
```

输出：

```
class test.Test$TestDouble: public int test.Test$TestDouble.op(java.lang.Double)(bridge: false)
class test.Test$TestDouble: public int test.Test$TestDouble.op(java.lang.Number)(bridge: true)
class test.Test$TestDouble: public void test.Test$TestDouble.other()(bridge: false)
class java.lang.Object: public final native void java.lang.Object.wait(long) throws java.lang.InterruptedException(bridge: false)
class java.lang.Object: public final void java.lang.Object.wait(long,int) throws java.lang.InterruptedException(bridge: false)
class java.lang.Object: public final void java.lang.Object.wait() throws java.lang.InterruptedException(bridge: false)
class java.lang.Object: public boolean java.lang.Object.equals(java.lang.Object)(bridge: false)
class java.lang.Object: public java.lang.String java.lang.Object.toString()(bridge: false)
class java.lang.Object: public native int java.lang.Object.hashCode()(bridge: false)
class java.lang.Object: public final native java.lang.Class java.lang.Object.getClass()(bridge: false)
class java.lang.Object: public final native void java.lang.Object.notify()(bridge: false)
class java.lang.Object: public final native void java.lang.Object.notifyAll()(bridge: false) 
```

尤其：

```
Test$TestDouble.op(java.lang.Number)(bridge: true) 
```

# regex - AS3 Panda Tea Cups（递归解析、标记和正则表达式）

> ID：12373609
> 
> 赞同：3
> 
> 时间：2012-09-11T15:54:20.723
> 
> 标签：regex, actionscript-3, parsing, recursion

好吧，这个标题很吸引人。我会承认的。现在问题来了！

概述 我在一个项目中有一些代码，我正在处理带有 HTML 标记的标记文本（用于 Flash wiki）。我创建了一个独立的文件，我将在这个问题中重点关注它，以使事情更清楚。

我想做什么 我的输入是一个关键字列表和一个文本块。在这种情况下，输入是

```
["panda","tea","tea cup","panda tea cup"]; 
```

和

```
"Tea is good. I like tea cups, too. Pandas also like tea but need special panda tea cups to drink it."; 
```

预期的输出应该是这样的：

```
"<Tea> is good. I like <tea cups>, too. <Panda>s also like <tea> but need special <panda tea cups> to drink it. 
```

问题我以为我可以用一个简单的 replace() 函数来做到这一点，但很快意识到我最终会得到这个：

```
"<Tea> is good. I like <<tea> cups>, too. <Panda>s also like <tea> but need special <<panda> <<tea> cups>> to drink it." 
```

这是我不想要的。

我最终决定构建一个递归函数，将代码从最长的关键字开始分解到最小的关键字。虽然现在我完全糊涂了并且不断收到 recursiveParse 错误。

完整代码

```
//Setup
var kw:Array = ["panda","tea","tea cup","panda tea cup"];
var s:String = "Tea is good. I like tea cups, too. Pandas also like tea but need special panda tea cups to drink it.";
var openTag:String = "<<";
var closeTag:String = ">>";
var tS:Array = [];
//Sort by length (longest to shortest)
for (var i:int = 0; i<kw.length; i++) {
    for (var j:int = kw.length - 1; j > i; j--) {
        if (kw[j - 1].length < kw[j].length) {
            var temp:String = kw[j - 1];
            kw[j - 1] = kw[j];
            kw[j] = temp;
        }
    }
}
//Parse
tS[0] = s;
s = recursiveParse(s);
var n:int = 0;
function recursiveParse(m:String) {
    var tP = kw[n];
    if (m.length == 0) {
        return "test";
    }
    var p:RegExp = new RegExp(tP,"gi");
    m = m.replace(p,openTag + "$&" + closeTag);
    tP = "[<>]";
    p = new RegExp(tP);
    var b:Array = m.split(p);
    var fI:String = "";
    n++;
    for each (var f in b) {
        if (f.length > 0) {
            tS[tS.length] = recursiveParse(f);
        }
    }
    return fI;
}
trace(s); 
```

提前感谢您的出色回答！请记住，我在任何程度上都不关心上面的代码。如果您的答案是对代码进行简单的三行修复，或者您自己的 33 行代码不考虑我的工作，那我很好。只要输入变成输出。

更新：好的，我现在意识到 stackoverflow 隐藏了我的尖括号。必须解决这个问题。更新：固定尖括号。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T16:16:10.667

好吧，您不需要使用递归。首先，确保您的数组中搜索的字符串按复杂度递减顺序排列：

```
var kw:Array = ["panda tea cup","tea cup","panda","tea"]; 
```

也就是说，如果字符串 A 包含字符串 B，那么 A 必须先出现。然后，您可以使用此正则表达式：`/(panda tea cups|tea cups|tea|panda)/i`或者，在您的情况下，执行：

```
var p:RegExp = new RegExp("("+kw.join("|")+")","gi"); 
```

并用 替换匹配项`<$&>`，就像现在一样。

您可以在[此处](http://regexr.com?3248o)查看此正则表达式。

# asp.net-mvc - Asp mvc 不显示错误

> ID：12373610
> 
> 赞同：0
> 
> 时间：2012-09-11T15:54:21.083
> 
> 标签：asp.net-mvc

我有一个看起来像这样的控制器：

```
if (ModelState.IsValid)
            {
               ...
            }
            else
            {
                ViewBag.Msg = "error";
                return View();
            } 
```

我添加了`ViewBag.Msg`记录控制器的行为。如果表单无效，它应该根据模型验证器显示正确的错误消息，但它不起作用，因为“错误”字符串显示在视图上。

我如何跟踪错误。根据文档`ModelState`有一个属性`Errors`，但视觉工作室说这不是真的。

是否有另一种方法记录错误以及它可能是什么。

**编辑：**

我已经有了`@Html.ValidatorSumary(true)`，这就是这个案例的奇怪之处，我知道这`ModelState`是无效的，因为这`ViewBag.Msg`条线，但它没有显示任何东西。

**编辑2**

碰巧我对这样的一个助手有错误的价值

```
@Html.RadioButtonFor(x => x.BoolField, 1) 
```

和模型

```
public Nullable<Bool> boolField { get; set; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:56:56.347

您必须将模型返回视图以在视图中显示模型错误。如果要记录模型错误，可以检查`ViewData.ModelState.Values`集合以查看错误。

```
[Httpost]
public ActionResult Create(User model)
{
   if(ModelState.IsValid)
   {
     //save and redirect
   }
   else
   {
     foreach (var modelStateValue in ViewData.ModelState.Values)
     {
       foreach (var error in modelStateValue.Errors)
       {               
            var errorMessage = error.ErrorMessage;
            var exception = error.Exception;
           // You may log the errors if you want
       }
     }
   }         
   return View(model);
 }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:03:21.277

希望这可以帮助。

```
 public ActionResult SomeAction(SomeModel model)
            {
                if (!ModelState.IsValid)
                {
                    // validation error.. display model with error messages

                    return PartialView("partialview", model);
                }
                try
                {
                    //success
                    return Json(new { success = true });
                }
                catch (Exception ex)
                {
                    // show error in ValidationSummary

                    ModelState.AddModelError("", ex.Message);
                    return PartialView("partialview", model);
                } 
```

# c# - LINQ 的 Select(a => a) 有什么作用？

> ID：12373616
> 
> 赞同：0
> 
> 时间：2012-09-11T15:54:50.680
> 
> 标签：c#, linq

我正在查看以下代码

```
 public IEnumerable<RoleRecord> GetRoles() {
        var roles = _roleRepository.Table.Select(role => role);
        return roles.ToList();
    } 
```

`Table`是_`IQueryable<RoleRecord> Table { get; }`

有没有更好的方法来写这个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T15:55:44.887

有效地投射到自己身上——所以这里`Select(role => role)`基本上什么都不做。

```
return  _roleRepository.Table.ToList(); 
```

...将达到相同的效果，或者：

```
return _roleRepository.Table; 
```

如果您很高兴返回可枚举而不是已解决的列表。

这是在猜测`Table`是否有`IEnumerable<T>`资格获得`Select()`or `ToList()`。

将`ToList`完全迭代`Table`可枚举，但返回为`IEnumerable<T>`. 其消费者将迭代列表，这可能比迭代`Table`.

**更新：**`IEnumerable<T>`在与@servy 聊天后，返回 an （在您的情况下为 from `Select(role => role)`）和返回 a之间的一个重要区别`List<T>`是，使用 a `List<T>`，调用者可以将您的`IEnumerable<T>`背部转换为 a`List<T>`并对其进行变异：

```
IEnumerable<RoleRecord> results = GetRoles();
var asList = (List<RoleRecord>)results;
asList.Add(new RoleRecord());
asList.RemoveAt(0); 
```

但是请注意，自投影不是这里的决定因素，这是您使用迭代器块作为`IEnumerable<T>`实现而不是`List<T>`.

也就是说，这种特殊的行为差异在您的情况下不会很明显，因为您调用`ToList()`了 ，因此原始答案中的代码代表 - 它是等效的（并且在技术上稍快）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T15:56:27.370

如果没有任何过滤条件，则无需调用 Select。

就像是：

```
 public IEnumerable<RoleRecord> GetRoles() {
        return _roleRepository.Table.ToList();
    } 
```

会更简单吗？调用 .ToList() 显然会使集合水化，但我认为这就是你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T15:56:12.377

这应该简化为：

```
 public IEnumerable<RoleRecord> GetRoles() {
        return _roleRepository.Table.ToList();
    } 
```

基本上，`a => a`只是一个“身份”的投影，也就是`a`自己。在这种情况下，它真的不买任何东西。

在某些情况下，当您不想执行某项操作时，它有时可用作占位符。但是，在这种情况下，没有必要，因为最终结果只是对`ToList()`原始序列执行 a ，而无需`Select()`.

当然，这是假设原始方法中的两行之间没有其他任何事情发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T15:56:56.917

LINQ 的`Select(a => a)`作用是什么？

它将序列的每个元素投影到一个新形式中，该形式仅包含您指定的元素（您的“a”）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-11T15:58:55.643

我相信你可以写：

```
public IEnumerable<RoleRecord> GetRoles() {
    return _roleRepository.Table.ToList();
} 
```

如果没有，那你可以试试

```
return (from r in _roleRepository.Table select r).ToList(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-11T16:11:38.810

Select 方法返回一个“投影”——对源可枚举的每个单独元素的修改。在这种情况下，它将元素投影到自身，因此它是多余的。

如果我不得不猜测意图，我会说选择被包括在内，并且查询没有与其“ToList()”终止符内联（强制对 Linq 链的评估以产生所有元素），因此它可以更容易调试以准确查看查询生成了哪些元素。或者，这个查询可能最初是由精通 SQL 的人编写的，他认为所有 LINQ 查询都应该包含 SQL SELECT 查询的部分。

不管怎样，除了去掉 Select 之外，这个查询还可以内联在返回中：

```
public IEnumerable<RoleRecord> GetRoles() {
    return _roleRepository.Table.ToList();
} 
```

# excel - VBA将工作表保存到受密码保护的PDF

> ID：12373631
> 
> 赞同：3
> 
> 时间：2012-09-11T15:55:45.107
> 
> 标签：excel, pdf-generation, excel-2010, vba

以下将活动表另存为 PDF：

```
ActiveSheet.ExportAsFixedFormat _
                               Type:=xlTypePDF, _
                               Filename:="C:\blahblah2.pdf",  _
                               Quality:=xlQualityStandard, _
                               IgnorePrintAreas:=False, _
                               OpenAfterPublish:=False 
```

我需要能够创建受密码保护的 PDF - 这是否可以在不购买任何额外软件的情况下使用 VBA？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T21:17:17.563

我使用`PDFsharp`using `VS`- 我的项目在`C#`......这个免费库运行良好

# android - 在给定路径打开文件浏览器进行浏览（不选择）

> ID：12373633
> 
> 赞同：0
> 
> 时间：2012-09-11T15:55:56.947
> 
> 标签：android

这是我的场景。我的应用程序从 Internet 下载文件并将其保存到用户 ExternalStorageDirectory 中。我想让我的选项菜单按钮作为快捷按钮来访问`ExternalStorageDirectory`. 谁能告诉我它是如何完成的？以下是我的代码的一小部分。

我希望我的选项菜单按钮`onclick`转到我的文件的绝对路径。所以用户不需要手动退出应用，在外部目录中查找。

```
File sdCard = Environment.getExternalStorageDirectory();
File dir = new File (sdCard.getAbsolutePath() + "/Pictures/Screenshots");

@Override
    public boolean onMenuItemSelected(int featureId, MenuItem item) {
        switch (item.getItemId()) {
            case R.id.select_text:

                SelectText();
                return true;
            case R.id.show_downloads:
                Intent i = new Intent();

            i.setAction(Environment.getRootDirectory);

            startActivity(i); //<<-- Here !!

                return true;
        }

        return super.onMenuItemSelected(featureId, item);
    } 
```

我希望我的选项菜单按钮到这里。

![在此处输入图像描述](../Images/1cda031d957874fd38e655721d44609b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:25:12.053

通常在 android 中，您必须`Intent` `action`弹出一个可以处理该特定操作的活动（或显示活动选择器列表）。前段时间我曾搜索过这样的解决方案，但找不到`Intent`可以简单地将文件查看器打开到特定路径的解决方案；你有`action` `ACTION_GET_CONTENT`哪个可以打开文件浏览器，但是一旦用户点击一个文件，它就会返回到我们的活动。

所以我能想到的解决方案是，从您想要的目录中获取文件列表，并将其显示在您自己的应用程序中，可能是`ListView`. 一旦用户点击了一个项目，我们就可以继续用`ACTION_VIEW`.

我认为android没有这样一个选项的原因是，android没有默认的文件查看器；无法确定是否存在用于查看任何给定 android 手机中文件的应用程序。这就是为什么您应该在应用程序本身中拥有文件查看器的另一个原因。

# c# - C# 读取固定长度文件 - 修剪值中的空间

> ID：12373649
> 
> 赞同：5
> 
> 时间：2012-09-11T15:56:37.907
> 
> 标签：c#, oledb, fixed

当我读取固定长度文件时，该值始终没有空格。

示例：文件夹 c:\temp 包含 2 个文件

**fs.txt**

```
ITMHMC12-163 -0000153430.30
ITMHMC12-164 -0000000745.18 
```

**架构.ini**

```
[fs.txt]
ColNameHeader=False
Format=FixedLength
DateTimeFormat=yyyymmdd
Col1=RecordTypeSCFBody Text Width 3
Col2=InvoiceNumber Text Width 10
Col3=Amount Text Width 14 
```

**用于读取文件的 C# 代码...**

```
string fileName = @"C:\temp\fs.txt";
string dir = Path.GetDirectoryName(fileName);

DataTable dataTable;

using (OleDbConnection conn =
    new OleDbConnection(@"Provider=Microsoft.Jet.OleDb.4.0;" +
        "Data Source=" + dir + ";" +
        "Extended Properties=\"Text;\""))
{
conn.Open();

using (OleDbDataAdapter adapter = new OleDbDataAdapter("select * from " + fileName, conn))
{

    dataTable = new DataTable();
    adapter.Fill(dataTable);
}
conn.Close();
}

Console.Write(dataTable.Rows[0][1].ToString()); <-- this line ** 
```

-->这条线给了我“HMC12-163”，但我期待“HMC12-163”。**注意空间！**

感谢你的帮助。

非常感谢！-德布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:14:26.720

对于固定长度格式的文本文件，您应该在扩展属性中指定：

```
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:\txtFilesFolder\;Extended Properties="text;HDR=No;FMT=Fixed"; 
```

“HDR=是的；” 表示第一行包含列名，而不是数据。“HDR=否；” 表示相反。
要指定每个列的长度，请使用您的[Schema.ini](http://msdn.microsoft.com/en-us/library/ms709353.aspx)文件。

因此您的代码变为：

```
using (OleDbConnection conn =
    new OleDbConnection(@"Provider=Microsoft.Jet.OleDb.4.0;" +
        "Data Source=" + dir + ";" +
        "Extended Properties=\"Text;HDR=No;FMT=Fixed\"")) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T18:46:11.437

似乎没有任何记录在案的设置来控制此行为。如果尾随空格很重要，您可以在代码或 SQL 中明确填充正确数量的空格：

```
const int maxInvoiceLength = 10;
string fileName = @"C:\temp\fs.txt";
string dir = Path.GetDirectoryName(fileName);

DataTable dataTable;

using (OleDbConnection conn =
    new OleDbConnection(@"Provider=Microsoft.Jet.OleDb.4.0;" +
        "Data Source=" + dir + ";" +
        "Extended Properties=\"Text;\""))
    {
        conn.Open();

        string query = String.Format("SELECT RecordTypeSCFBody, LEFT(InvoiceNumber + SPACE({0}), {0}), Amount FROM {1}", maxInvoiceLength, fileName);
        using (OleDbDataAdapter adapter = new OleDbDataAdapter(query, conn))
        {
            dataTable = new DataTable();
            adapter.Fill(dataTable);
        }
    }

    Console.Write(dataTable.Rows[0][1].ToString()); 
```

# php - PHP在循环中比较数组键

> ID：12373660
> 
> 赞同：0
> 
> 时间：2012-09-11T15:56:56.783
> 
> 标签：php, mysql

我有一个如下所示的while循环。我想总结数据库中的所有字段，但忽略一组。这些被称为 id、summary 和 diff。

我已经在下面设置了我认为需要的内容，但不知道如何正确地将当前键与这些字段名称进行比较。

```
$sql = 'SELECT * FROM table';
$result = mysql_query($sql)
while ($row = mysql_fetch_array($result)){
//DOES KEY = an ignore field name?

//If No 
$i++
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:00:17.600

您可以从查询中排除相关的：

```
SELECT * FROM table WHERE `key` NOT IN ('id','summary','diff') 
```

或者，您可以`if`在 PHP 中使用一条语句：

```
if($row['key'] == 'id' || $row['key'] == 'summary' || $row['key'] == 'diff') continue; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:01:21.407

使用`in_array`. `if(in_array($row[i], $values)`您将不得不在行中循环以搜索每一列。只需构建一个包含您要搜索的所有字段的数组

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T17:45:48.473

```
$ignoreTheseColumns = array("id", "summary", "diff");
$sum = 0;
$sql = 'SELECT * FROM table';
$result = mysql_query($sql)
while ($row = mysql_fetch_array($result)){
    foreach($row as $key=>$value)
    {
        //DOES KEY = an ignore field name?
        if(!in_array($key, $ignoreTheseColumns))
        {
            $sum+= $value
        }
} 
```

# sql-server - 从 SQL Azure 迁移到 SQL Server

> ID：12373661
> 
> 赞同：6
> 
> 时间：2012-09-11T15:56:57.027
> 
> 标签：sql-server, sql-server-2008, azure, cloud, database-migration

众所周知，有很多工具可以将数据库从 SQL 服务器迁移到带有架构和数据的 SQL Azure。但是有没有办法将 SQL Azure 数据库迁移到带有数据的 SQL 服务器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T17:04:10.330

大多数数据库迁移工具都在[此处](http://msdn.microsoft.com/en-us/library/windowsazure/hh694043.aspx)进行了详细描述，请点击底部部分名称“在 SQL 数据库之间迁移”的链接，在这里您将看到以下工具描述以及安装指南以及屏幕截图来解释如何使用它们：

1.  数据层应用 DAC 包
2.  数据层应用程序 BACPAC 包
3.  生成脚本向导
4.  bcp
5.  SQL 数据库迁移向导
6.  SQL Server 集成服务
7.  SQL Server 导入和导出向导
8.  SQL Server 迁移助手

由于上述大多数工具都在您的本地计算机上运行（其中一些也在云中运行），因此一旦您在桌面和 SQL 数据库之间建立了连接，您就可以从一侧备份数据，即从 SQL 数据库备份数据到 SQL Server 数据库，反之亦然。

# java - 查询 SQLite 数据库的方法需要永远完成

> ID：12373662
> 
> 赞同：0
> 
> 时间：2012-09-11T15:57:02.310
> 
> 标签：java, performance, sqlite

我有一个 SQLite 数据库，其中的表有 ~90000 行。这是需要很长时间才能完成的方法。

```
void intilizeAyaHighlighShapes() {
        ayaShapes = new ArrayList<ArrayList<AyaShape>>();
        ArrayList<AyaShape> ayaRowsHighlight = new ArrayList<AyaShape>(); // contains the highligh shapes of a specific aya for all its rows

        int tmpAya = 1, tmpLineMin = 0, tmpLineMax = 0;
        int maxLeft = 0, maxRight = 0, maxTop = 0, maxBottom = 0;

        SQLiteDatabase db = SQLiteDatabase.openDatabase(Environment.getExternalStorageDirectory() + "/ayahinfo_800.db", null, SQLiteDatabase.OPEN_READONLY);
        Cursor cursor = null;

        while (tmpAya < Database.AyatNumberInSura[suraIndex]) {
            cursor = db.rawQuery("SELECT MIN(line_number) FROM glyphs WHERE(sura_number=" + Integer.toString(suraIndex + 1) + " AND ayah_number=" + Integer.toString(tmpAya) + ")",
                    null);
            cursor.moveToFirst();
            tmpLineMin = cursor.getInt(0);

            cursor = db.rawQuery("SELECT MAX(line_number) FROM glyphs WHERE(sura_number=" + Integer.toString(suraIndex + 1) + " AND ayah_number=" + Integer.toString(tmpAya) + ")",
                    null);
            cursor.moveToFirst();
            tmpLineMax = cursor.getInt(0);

            for (int i = tmpLineMin; i <= tmpLineMax; i++) {
                cursor = db.rawQuery("SELECT MAX(max_x) FROM glyphs WHERE (sura_number=" + Integer.toString(suraIndex + 1) + " AND ayah_number=" + Integer.toString(tmpAya)
                        + " AND line_number=" + Integer.toString(i) + ")", null);
                cursor.moveToFirst();
                maxRight = cursor.getInt(0);

                cursor = db.rawQuery("SELECT MIN(min_x) FROM glyphs WHERE (sura_number=" + Integer.toString(suraIndex + 1) + " AND ayah_number=" + Integer.toString(tmpAya)
                        + " AND line_number=" + Integer.toString(i) + ")", null);
                cursor.moveToFirst();
                maxLeft = cursor.getInt(0);

                cursor = db.rawQuery("SELECT MAX(max_y) FROM glyphs WHERE (sura_number=" + Integer.toString(suraIndex + 1) + " AND ayah_number=" + Integer.toString(tmpAya)
                        + " AND line_number=" + Integer.toString(i) + ")", null);
                cursor.moveToFirst();
                maxBottom = cursor.getInt(0);

                cursor = db.rawQuery("SELECT MIN(min_y) FROM glyphs WHERE (sura_number=" + Integer.toString(suraIndex + 1) + " AND ayah_number=" + Integer.toString(tmpAya)
                        + " AND line_number=" + Integer.toString(i) + ")", null);
                cursor.moveToFirst();
                maxTop = cursor.getInt(0);

                ayaRowsHighlight.add(new AyaShape(maxLeft, maxRight, maxTop, maxBottom));
            }

            ayaShapes.add(ayaRowsHighlight);
            ayaRowsHighlight.clear();
            tmpAya++;

        }

        cursor.close();
        db.close();

    } 
```

这段代码的哪些部分可能导致它需要这么长时间？
我应该在这里写下这段代码的目的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T17:53:53.983

您可以简单地将多个查询与相同的 WHERE 条件组合起来：

```
SELECT MIN(line_number), MAX(line_number)
 FROM glyphs
 WHERE sura_number = ? AND ayah_number = ? 
```

和：

```
SELECT MAX(max_x), MIN(min_x), MAX(max_y), MIN(min_y)
 FROM glyphs
 WHERE sura_number = ? AND ayah_number = ? AND line_number = ? 
```

但是，您的算法实际上并不需要它，`tmpLineMin`并且在处理各个字形边界*之前*`tmpLineMax`是已知的。因此，您可以通过使用单个查询然后单步执行结果行（每个行号一个）来进一步加快速度：

 *```
SELECT line_number, MAX(max_x), MIN(min_x), MAX(max_y), MIN(min_y)
 FROM glyphs
 WHERE sura_number = ? AND ayah_number = ?
 GROUP BY line_number
 ORDER BY line_number 
```*

# php - PHP向下钻取中的重复值

> ID：12373664
> 
> 赞同：-1
> 
> 时间：2012-09-11T15:57:05.740
> 
> 标签：php

我对 PHP 比较陌生。我已经通过数据库钻了几个级别，我遇到了一个障碍。我不知道为什么我只检索一个重复的记录，而应该只有 5 个不同的记录。我的代码在下面...

```
<?php 

    $sections = $_GET['rid'];
 // Connects to Database 
 mysql_connect("localhost", "root") or die(mysql_error()); 
 mysql_select_db("test") or die(mysql_error()); 
 $data = mysql_query("SELECT question_keywords.rfp_id, question_keywords.section_id, section_name FROM rfp, question_keywords, section WHERE question_keywords.rfp_id = rfp.rfp_id AND section.section_id = question_keywords.section_id AND section.section_id = '$sections'") 
 or die(mysql_error()); 
  echo "<table border=0 cellpadding=15>";
echo "<tr align = center bgcolor=white>
<td><b>Section ID</b></td><td><b>Section Name</b></td>" ; 
 while($row = mysql_fetch_array($data)){
      $sid = $row['section_id'];  //if you have the column names, replace 0 with 'column_name'
      $sname = $row['section_name'];
     # $status = $row['status'];

# inserts value into table as a hyperlink

echo "<tr align = center bgcolor=white><td>$sid</td><td><a href=view_section_detail.php?sid=$sid>$sname</a></td>";
}

# displays table

print '</table>';

 ?> 
```

任何帮助，将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:03:48.343

我猜您只是忘记添加两个`</tr>`s 如果您查看 HTML-Output 它应该在那里。尝试 ：

```
echo "<tr align = center bgcolor=white>
<td><b>Section ID</b></td><td><b>Section Name</b></td></tr>" ; 
```

和：

```
echo '</tr></table>'; 
```

正如已经说明的评论，尝试在 sql 命令（或 phpmyadmin）中针对数据库查询您的命令。

# visual-studio-2010 - VS2010升级后无法链接到lib（__cdecl vs __thiscall？）

> ID：12373667
> 
> 赞同：2
> 
> 时间：2012-09-11T15:57:11.633
> 
> 标签：visual-studio-2010, visual-studio, cdecl

非常感谢任何帮助，我的前额被擦伤了。

我们有一个大的开源`DICOM`库 ( `dcmtk`)，我们将其用作静态库。它是非托管 C++，我们从`C++ DLL`包装它的托管链接到它。它使用 CMake 来调整各种平台的构建指令。迁移到`VS2010`（从 2008 年开始）破坏了我们的构建，因此我们也借此机会更新了我们正在使用的库版本（应该更`VS2010`友好）。在对 lib 进行了一些修改之后，现在构建（给出或接受关于类型转换的无数警告）。但是现在使用它的代码不会链接到它。它引发了一堆未解决的外部符号错误。

它找到了库 OK（如果我更改了 lib 文件名，它会在前面使用适当的 msg 时出错）。

如果我使用 DUMPBIN 反汇编 lib 文件，我会看到相应的标记，例如：... 000000000000000E: C3 ret

`??1OFString@@QEAA@XZ (public: __cdecl OFString::~OFString(void))`：

```
0000000000000000: 40 53              push        rbx… 
```

但链接器没有找到它：

```
error LNK2001: unresolved external symbol "public: __thiscall OFString::~OFString(void)" (??1OFString@@QAE@XZ) 
```

我一直在研究这是`__cdecl vs. __thiscall`不匹配的理论，但无法让 VS 使用任何其他约定来构建库。（具有讽刺意味的是，2008 年的旧版本`emit __thiscall`似乎是用我认为的 /Gd 选项编译的`forces __cdecl`）。

有什么见解吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T16:56:48.213

您可以看到名称 mangling 是不同的。使用 undname.exe 可能有助于您的事业：

```
Undecoration of :- "??1OFString@@QEAA@XZ"
is :- "public: __cdecl OFString::~OFString(void) __ptr64" 
```

相对：

```
Undecoration of :- "??1OFString@@QAE@XZ"
is :- "public: __thiscall OFString::~OFString(void)" 
```

另外，您是在混合使用 x64 和 x86 吗？

# c# - 找不到 XapCacheFile.xml

> ID：12373669
> 
> 赞同：0
> 
> 时间：2012-09-11T15:57:22.863
> 
> 标签：c#, windows-phone-7

使用 Visual Studio 10 调试我的应用程序时，我收到以下错误...

```
" Error 1   Could not find file 'C:\Users\Aksi\Documents\Expression\Blend 4\Projects\vimol\vimol\obj\Debug\XapCacheFile.xml'. Please rebuild the solution and try again.".. 

" Error 1   Xap packaging failed. Object reference not set to an instance of an object. vimol" 
```

这是一个 Windows Phone 应用程序...我使用 Microsoft Expression Blend 制作的...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:39:49.200

关闭 Blend，打开`C:\Users\Aksi\Documents\Expression\Blend 4\Projects\vimol\vimol\`并删除这两个文件夹`bin`和`obj`子文件夹。

再次在 Blend 中打开项目并尝试构建它！

# java - 分别声明并分配给最终变量 - Java

> ID：12373673
> 
> 赞同：1
> 
> 时间：2012-09-11T15:57:37.850
> 
> 标签：java, variables, constants

我有一个类，里面有一些小类，它们充当常量的“存储单元”。问题是，我需要一些信息来为这些常量赋值，而我只能在构造函数中获取这些信息。不幸的是，miniclass 没有在构造函数中声明，NetBeans 告诉我不能分配给 final 变量，即使它只是被声明而不是初始化。我该怎么办？

编辑：一些会出现此问题的代码示例：

```
public class Car {
    class constants {
        public final String MAKE;
        public final String REGISTRATION_NUMBER;
    }
    public Car(String make, String regNumber) {
        constants.MAKE = make;
        constants.REGISTRATION_NUMBER = regNumber;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-11T16:05:25.097

您尝试做的事情是行不通的，因为您在`Constants`某处需要一个类的实例。一种方法是按照以下方式进行操作，但是那个常数并没有什么常数......

```
public class Car {
    class Constants {
        public final String MAKE;
        public final String REGISTRATION_NUMBER;
        private Constants(String make, String regNumber) {
            this.MAKE = make;
            this.REGISTRATION_NUMBER = regNumber;
        }
    }

    public final Constants constants;
    public Car(String make, String regNumber) {
        this.constants = new Constants(make, regNumber);
    }
} 
```

然后您可以致电：

```
Car car = new Car("abc", "def");
String make = car.constants.MAKE; 
```

注意：一个可能更好（和更简单）的设计是

```
public class Car {
    private final String make;
    private final String regNumber;

    public Car(String make, String regNumber) {
        this.make = make;
        this.regNumber = regNumber;
    }

    //getters
} 
```

# html - xslt xml html：如何区分有无子元素的相同元素？

> ID：12373677
> 
> 赞同：3
> 
> 时间：2012-09-11T15:57:57.600
> 
> 标签：html, xml, xslt

问题是我想区分不同情况的相同元素名称。例如：

```
<element>Hello StackOverFlow</element>
<element>
  <group>
     <ge>hello g1</ge>
     <ge>hello g2</ge>
  </group>
  <group>
     <ge>hello g3</ge>
     <ge>hello g4</ge>
  </group>
</element> 
```

我想让带有文本的元素转换成

```
<div class="text_element">Hello StackOverFlow</div> 
```

对于那些具有子节点的元素：

```
<div class="element">
  <ul class="group">
     <li>hello g1</li>
     <li>hello g2</li>
  </ul>
  <ul class="group">
     <li>hello g3</li>
     <li>hello g4</li>
  </ul>
</div> 
```

那么，问题是如何在编写模板时区分这两种元素呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T16:03:08.750

一种简单的方法：用 . 编写一个模板，`match="element[normalize-space(text())]"`用`match="element[*]`. 第一个匹配`element`带有文本节点子节点的元素，而不仅仅是空格；第二个将`element`元素与子元素匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T16:22:13.070

您可以使用计算后代元素来查看它是否有子元素，例如`count(descendant::group)=0`

`xml`XSLT（假设您的输入上有一个根节点）：

```
<xsl:stylesheet version="1.1" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="html" version="1.0" indent="yes"/>

    <xsl:template match="/xml">
        <xsl:apply-templates select="element"/>
    </xsl:template>

    <!-- No children -->
    <xsl:template match="element[count(descendant::group)=0]">
        <div class="text_element">
            <xsl:value-of select="text()"/>
        </div>
    </xsl:template>

    <!-- With children -->
    <xsl:template match="element[count(descendant::group)&gt;0]">
        <div class="element">
            <xsl:apply-templates select="group"/>
        </div>
    </xsl:template>

    <xsl:template match="group">
        <ul class="group">
            <xsl:apply-templates select="ge"/>
        </ul>
    </xsl:template>

    <xsl:template match="ge">
        <li>
            <xsl:value-of select="text()"/>
        </li>
    </xsl:template>

</xsl:stylesheet> 
```

给出输出

```
<div class="text_element">Hello StackOverFlow</div>
<div class="element">
  <ul class="group">
    <li>hello g1</li>
    <li>hello g2</li>
  </ul>
  <ul class="group">
    <li>hello g3</li>
    <li>hello g4</li>
  </ul>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T04:24:45.863

**这个更短更简单的转换：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="element[not(*)]">
   <div class="text_element"><xsl:apply-templates/></div>
 </xsl:template>

 <xsl:template match="element">
  <div class="element">
    <xsl:apply-templates/>
  </div>
 </xsl:template>

 <xsl:template match="group">
    <ul class="group">
      <xsl:apply-templates/>
    </ul>
 </xsl:template>

 <xsl:template match="ge">
  <li><xsl:apply-templates/></li>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于以下 XML 文档时**（将提供的 XML 片段包装到单个顶部元素中以成为格式良好的 XML 文档）：

```
<t>
    <element>Hello StackOverFlow</element>
    <element>
        <group>
            <ge>hello g1</ge>
            <ge>hello g2</ge>
        </group>
        <group>
            <ge>hello g3</ge>
            <ge>hello g4</ge>
        </group>
    </element>
</t> 
```

**产生想要的正确结果**：

```
<div class="text_element">Hello StackOverFlow</div>
<div class="element">
   <ul class="group">
      <li>hello g1</li>
      <li>hello g2</li>
   </ul>
   <ul class="group">
      <li>hello g3</li>
      <li>hello g4</li>
   </ul>
</div> 
```

# asp.net - 将文本输入和输出 ckeditor 的问题

> ID：12373678
> 
> 赞同：0
> 
> 时间：2012-09-11T15:57:59.580
> 
> 标签：asp.net, jquery-ui, jquery, ckeditor

在我们的网站中，我们创建了一个流程，管理员用户可以使用 jQuery-UI 对话框流程更改标签中显示的文本，当他们处于编辑模式时，单击文本区域（标签）会在对话框中显示该文本框，他们可以更改它，添加工具提示，甚至是日期范围。我们认为能够使用 ckeditor 来编辑更长的新闻项目或更长的指令标签会很棒。除了实际从数据库中获取要编辑的文本或在 ckeditor 实例中获取已编辑的文本并将其保存到数据库之外，一切正常。有很多代码，但与此同时，我将首先介绍 jQuery 代码，以及生成对话框的 .Net 标记。如果这个代码对每个人来说都不错，我会发布更多的幕后代码。

```
$(function () {
$("#dialog-markup").dialog(
{
    autoOpen: false,
    height: 600,
    width: 600,
    modal: true,
    buttons:
    {
        "Save": function () {
            var GuiText = $(".gui_markup_text").val();
            if (GuiText == "")
                GuiText == "&nbsp;";

            var GuiToolTipText = $(".gui_markup_tooltip").val();
            if (GuiToolTipText == "")
                GuiToolTipText == "&nbsp;";

            editableControl[0].innerHTML = GuiText;

            var guiKey = "";
            if ($(editableControl).attr('gui_key') != null)
                guiKey = $(editableControl).attr('gui_key');
            else
                guiKey = $(editableControl).attr('id');

            var MarkupGui = new Object();

            MarkupGui.key = guiKey;
            MarkupGui.levels = $('input.hidden_Levels').val();
            MarkupGui.effectiveDate = $('.gui_markup_date_eff').val();
            MarkupGui.terminationDate = $('.gui_markup_date_trm').val();
            MarkupGui.textValue = GuiText;
            MarkupGui.toolTip = GuiToolTipText;
            //MarkupGui.hidden = hidFlag

            var DTO = { 'mg': MarkupGui };

            $.ajax({
                type: "POST",
                url: "GuiConfigWS.asmx/SaveMarkupToDB",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                data: JSON.stringify(DTO),
                success: AjaxSuccess,
                error: AjaxFailure
            }); //end of ajax call

            $(this).dialog("close");
            return false;
        },
        "Cancel": function () {
            $(this).dialog("close");
        } //End of Cancel button
    } //end of buttons
}); //end of dialog 
```

}); //标记匿名函数结束

key 和 hidden_​​levels 是保存在我们数据库中的值，用于识别这是用于哪个标签以及将其应用到哪个区域。关键代码适用于我们拥有 asp.net 控件与标准 html 控件的情况。我们使用跨度的 id 作为数据库中的键值。在 Asp.net 控件上，我们添加了一个名为“gui_key”的属性，其作用类似于 id。

我们有类似的代码，它只是创建一个可以编辑的简单文本字符串，它就像一个魅力。您甚至可以为该文本添加标签，但我们更愿意让用户使用 ckeditor 而不必“知道” html 标签以进行特殊格式设置。

用于创建对话框的 .net 标记如下：

```
<div id="dialog-markup" class="markup" title="Edit Formated Text">
        <p>Use this editor below to add formated text.</p>
        <label id="lbl_Markup" for="txt_Markup">Formated Text: </label><br />
        <CKEditor:CKEditorControl ID="txt_Markup" CssClass="data gui_markup_text" runat="server" Toolbar="Source|Bold|Italic|Underline|Strike|-|Subscript|Superscript
                Cut|Copy|Paste|PasteText|PasteFromWord
                Undo|Redo|-|Find|Replace|-|RemoveFormat
                NumberedList|BulletedList|-|Outdent|Indent|Table
                /
                JustifyLeft|JustifyCenter|JustifyRight|JustifyBlock
         Styles|Format|Font|FontSize|TextColor|BGColor"></CKEditor:CKEditorControl>
        <label id="lbl_MarkupEffDate" for="txt_MarkupEffDate">Start Date: </label>
        <input id="txt_MarkupEffDate" type="text" name="Eff_Date" class="dateField data gui_markup_date_eff" /><br />
        <label id="lbl_MarkupTrmDate" for="txt_MarkupTrmDate">End Date: </label>
        <input id="txt_MarkupTrmDate" type="text" name="Trm_Date" class="dateField data gui_markup_date_trm"/><br />
        <label id="lbl_MaarkupToolTip" for="txt_MarkupToolTip">Tool Tip: </label>
        <input id="txt_MarkupToolTip" type="text" name="ToolTip" class="gui_markup_tooltip" />
    </div> 
```

我将在后续帖子中添加更多代码，用于 GuiConfigWS.asmx Web 服务、对此的示例调用以及处理该过程的类。

这是在代码中使用的示例：

```
<span id="info_Street1" class="editable markup" title="<%= GetGuiToolTip("info_Street1")%>"><%= GetGuiString("info_Street1")%></span> 
```

这是 GuiConfigWS.asmx：

```
<%@ WebService Language="C#" Class="GuiConfigWS" %>

using System;
using System.Web;
using System.Web.Services;
using System.Web.Services.Protocols;
using System.Collections.Generic;
using CKEditor;

[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.Web.Script.Services.ScriptService]
public class GuiConfigWS  : System.Web.Services.WebService 
{
    public class MarkupGui
    {
        public string typeOfDialog { get; set; }
        public string key { get; set; }
        public string levels { get; set; }
        public string effectiveDate { get; set; }
        public string terminationDate { get; set; }
        public string textValue { get; set; }
        public string toolTip { get; set; }
    }

    [System.Web.Script.Services.ScriptMethod]
    [WebMethod(EnableSession = true)]
    public string SaveMarkupToDB(MarkupGui mg) //removed 'static' after public on Dave Ward's advice...
    {
        GuiConfig gc = new GuiConfig("[REDACTED - CONNECTION STRING INFO");
        gc.SetValue(mg.key, mg.levels, mg.effectiveDate, mg.terminationDate, mg.textValue, mg.toolTip, 0); //Convert.ToInt32(mg.hidden));

        return "testString";  //temp return until the rest of the code is written.
    } //end of SaveMarkupToDB 
```

同样，我们有另一个完全可以工作的版本。我将推迟添加我们用来做这些事情的类，如果你们想看到它，在这里发布，我会发布它。但是，它很长，我想我已经在推动最大密度了……谢谢，布拉德。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:14:30.260

我曾尝试添加 ckeditor api 调用以根据需要获取和设置数据。我终于摆脱了 runat=server ，转而使用带有以下代码的编辑器的 html 版本：

```
<textarea id="editor1" name="editor1" class="data gui_markup_text" rows="5" cols="25"></textarea> 
```

和

```
<script type="text/javascript">
    //code to initialize the CKEditor, and setup it's toolbar.
    CKEDITOR.replace('editor1',
            {
                toolbar:
                [
                    { name: 'document', items: ['Source'] },
                    { name: 'clipboard', items: ['Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo'] },
                    { name: 'editing', items: ['Find', 'Replace'] },
                    { name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike', 'Subscript', 'Superscript', '-', 'RemoveFormat'] },
                    '/',
                    { name: 'paragraph', items: ['NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'JustifyLeft', 'JustiftyCenter', 'JustifyRight', 'JustifyBlock'] },
                    { name: 'insert', items: ['Table'] },
                    { name: 'styles', items: ['Styles', 'Format', 'Font', 'FontSize'] },
                    { name: 'colors', items: ['TextColor', 'BGColor'] }
                ]
            });
</script> 
```

然后这只是一个问题

```
CKEDITOR.instances.editor1.setData(jQueryElement.html().trim()); 
```

从要编辑的控件标签加载数据，并且：

```
var GuiText = CKEDITOR.instances.editor1.getData(); 
```

在我们的保存函数中保存数据。

# objective-c - 无法获得正确的 unicode 符号来显示

> ID：12373679
> 
> 赞同：0
> 
> 时间：2012-09-11T15:58:06.430
> 
> 标签：objective-c, ios, fonts

我在我的 iOS 应用程序中使用[http://symbolset.com](http://symbolset.com)作为图标，但无法正确显示相机符号。在符号集文档和 FontForge 中，它说 unicode 值为 1F4F7。

以下是相关代码：

```
[self setTitle:[NSString stringWithFormat:@"%C", (unichar)0x1F4F7] forState:controlState]; 
```

我也试过：

```
[self setTitle:[NSString stringWithFormat:@"%C", (unichar)0x0001F4F7] forState:controlState]; 
```

但是，这适用于复选标记符号：

```
[self setTitle:[NSString stringWithFormat:@"%C", (unichar)0x2713] forState:controlState]; 
```

字体为开放式。我也尝试将 unicode 值放在我的 Localizable.strings 文件中，但这没有奏效。我需要将其设为 TrueType 字体吗？

**更新：**我尝试转换为 TrueType 字体并遇到同样的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:11:13.977

问题是 unichar 只有 16 位，但您想要的字符在基本多语言平面 (BMP) 之外，因此需要 UTF-16 中的 2 个字符（代理对）。您可以找出这对，也可以执行以下操作：

```
UTF32Char c = 0x1F4F7;
NSData *utf32Data = [NSData dataWithBytes:&c length:sizeof(c)];
NSString *camera = [[NSString alloc] initWithData:utf32Data encoding:NSUTF32LittleEndianStringEncoding];

//do stuff with camera here and release if not using ARC 
```

# python - 无法使用 xlrd 在 python 中读取 .xls 文件

> ID：12373682
> 
> 赞同：0
> 
> 时间：2012-09-11T15:58:16.287
> 
> 标签：python

我的代码 -

```
import xlrd
xlrd.open_workbook('H:\DataSync\Projects\CV_Rec\Feed.xls') 
```

错误 -

```
Traceback (most recent call last):
XLRDError: Unsupported format, or corrupt file: Expected BOF record; found 'PK\x03\x04\x14\x00\x06\x00'
File "D:\ATHENA~1\RELEAS~1\build\ext\noarch/pylib\site-packages\xlrd\__init__.py", line 1545, in getbof
File "D:\ATHENA~1\RELEAS~1\build\ext\noarch/pylib\site-packages\xlrd\__init__.py", line 1539, in bof_error 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T07:41:52.340

好的..我发现了问题！我从那里获得此 Excel 表的人已将原始文件从“Feed.xlsx”重命名为“Feed.xls”。

这就是文件损坏的原因。

# android - 从生产 APK 中去除调试活动

> ID：12373687
> 
> 赞同：1
> 
> 时间：2012-09-11T15:58:31.127
> 
> 标签：android, debugging

我知道在 Android 工具的最新版本中，我们可以使用 if (BuildConfig.DEBUG == true)，我相信它会删除代码。

是否可以从生产版本 APK 中去除仅用于调试目的的活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:17:45.830

不，没有这样的功能。您可能可以尝试使用自定义构建脚本来做到这一点，但也许只需检查`debuggable`应用程序的标志就足够了：

```
Boolean isDebuggable = ((getApplicationInfo().flags & ApplicationInfo.FLAG_DEBUGGABLE) != 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:23:31.897

> 是否可以从生产版本 APK 中去除仅用于调试目的的活动？

从 Java 的角度来看，ProGuard 可能会通过适当的规则摆脱它们。但是，清单条目将保留，只有那些仅开发模式的活动才需要的任何资源也会保留，等等。这充其量只会增加膨胀。在最坏的情况下，如果清单条目已经导出了这些活动（例如，通过发布`<intent-filter>`），那么当某些东西试图运行这些活动时，您的应用程序将崩溃。

# java - JCheckBox 大小调整和触发动作

> ID：12373688
> 
> 赞同：1
> 
> 时间：2012-09-11T15:58:33.637
> 
> 标签：java, swing, action, jmenu, jmenuitem

我在从 JCheckBox 触发操作时遇到一些问题：

```
JMenu topMenu = new JMenu("Top Menu");

MyAction action1 = new MyAction("Action1");
MyAction action2 = new MyAction("A2");

JCheckBox checkBox1 = new JCheckBox( action1 );
JCheckBox checkBox2 = new JCheckBox( action2 );

topMenu.add( checkBox1 );
topMenu.add( checkBox2 ); 
```

将鼠标悬停在 topMenu 上时，它会展开并显示标有“Action1”和“A2”的 JCheckBox。单击复选框或文本可切换复选框。

这部分有点难解释：“A2”右侧有一个区域是空的——因为“Action1”占用了更多的空间，那么悬停在topMenu上时显示的子菜单将是“Action1”的宽度。“A2”行的宽度相同，但只有复选框和“A2”触发动作。

单击“A2”文本的右侧不会执行任何操作。我该如何以最简单的方式解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T16:29:54.753

不要将 JCheckBoxes 添加到菜单中。而是使用菜单变体：[JCheckBoxMenuItem](http://docs.oracle.com/javase/7/docs/api/javax/swing/JCheckBoxMenuItem.html)。[菜单教程](http://docs.oracle.com/javase/tutorial/uiswing/components/menu.html)将解释如何使用这些。

例如，

```
JMenu topMenu = new JMenu("Top Menu");

MyAction action1 = new MyAction("Action1");
MyAction action2 = new MyAction("A2");

JCheckBoxMenuItem checkBox1 = new JCheckBoxMenuItem( action1 );
JCheckBoxMenuItem checkBox2 = new JCheckBoxMenuItem( action2 );

topMenu.add( checkBox1 );
topMenu.add( checkBox2 ); 
```

# mysql - MySQL DML 触发器

> ID：12373690
> 
> 赞同：1
> 
> 时间：2012-09-11T15:58:38.487
> 
> 标签：mysql, triggers

我知道 MySQL 触发器只是 DML（更新、删除、插入）触发器。在 SQL Server 中，触发器可以在与执行它的语句相关的“之后”或“代替”中完成。SQL Server 不支持“之前”触发器。什么样的触发器被认为是 MySQL DML 触发器：“After”、“Instead of”或“Before”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:08:57.517

从[`CREATE TRIGGER`文档](http://dev.mysql.com/doc/refman/5.5/en/create-trigger.html)：

> `trigger_time`是触发动作时间。它可以是`BEFORE`或`AFTER`表示触发器在要修改的每一行之前或之后激活。

# post - 帖子上的 Tumblr 赞按钮无法重新定位？

> ID：12373692
> 
> 赞同：1
> 
> 时间：2012-09-11T15:58:43.257
> 
> 标签：post, themes, tumblr, social-media-like

我正在使用 ThinkingStiff 的这段代码

[http://like-button.tumblr.com/](http://like-button.tumblr.com/)

我不明白如何重新定位它。

我试图在这个主题上重新定位它[http://f1rst5.tumblr.com/](http://f1rst5.tumblr.com/) 但是当我点击like按钮时它会再次重新定位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T11:19:39.920

未按下按钮时，其类别为`my-like`，按下后类别更改为`my-liked`。因此，在您的 CSS 中，您定义了`my-like`和的样式`my-liked`。

在您提供的示例站点中，`my-liked`该类的样式设置如下：

```
margin-left: -5px;
margin-top: -251px; 
```

如果这是您的定位问题，那么只需将这些线取出，无论是否按下按钮，按钮都会保持在同一个位置。

无论哪种方式，如果您为其中一个类设置了某种样式，如果您想在按下和未按下状态下都保持该样式，则还必须将其设置为另一个。

（我希望这就是您在问题中的意思）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:04:59.640

从您链接的页面：

> 然后将以下按钮代码剪切并粘贴到您希望您的喜欢按钮所在的主题中（这必须在您的 {block:Posts}{/block:Posts} 块内）。

它可以在 {block:Posts} 和 {/block:Posts} 之间。在这些标签中，您可能会发现 headers(h1,h2,..., tags)、paragraphs(p)、Images(img) 等等。根据您放置它的位置，即在段落或图像之前或之后，按钮将获得其位置。

如果您需要更准确地重新定位它，也许最简单的方法是在 tumblr 可视化编辑器中创建一个表格（它应该有一个），这样您就可以更好地控制内容的布局。例如，您可以拥有一张桌子 | 正文 | 图片 | 喜欢button_code | 这样您就不仅限于某物上方或下方的定位，还可以进行内联定位。

希望这可以帮助。

# nhibernate - 带有 byte[] 参数的 NHibernate ISQLQuery 抛出错误

> ID：12373698
> 
> 赞同：1
> 
> 时间：2012-09-11T15:59:03.630
> 
> 标签：nhibernate, fluent-nhibernate, bytearray, isqlquery

所以，我正在尝试使用 nhibernate 来调用保存图像的存储过程。我的问题是查询失败并出现此错误：

> byte[] 值的长度超过了映射/参数中配置的长度。

这是我将参数附加到`ISQLQuery`. 参数是一个`Dictionary<string, object>`。

```
public void Execute()
{

    string sql = BuildSprocDefinition();
    var query = Session.CreateSQLQuery(sql);

    foreach (var parameter in Parameters)
    {
        if (parameter.Value is int)
            query.SetParameter<int>(parameter.Key, (int)parameter.Value);
        else if (parameter.Value is long)
            query.SetParameter<long>(parameter.Key, (long)parameter.Value);
        else if (parameter.Value is bool)
            query.SetParameter<bool>(parameter.Key, (bool)parameter.Value);
        else if (parameter.Value is byte[])
            query.SetBinary(parameter.Key, (byte[])parameter.Value);
        else
            query.SetParameter(parameter.Key, parameter.Value);
    }

    using (var tx = Session.BeginTransaction())
    {
        query.ExecuteUpdate();
        Session.Flush();
        tx.Commit();
    }
}

protected string BuildSprocDefinition()
{
    StringBuilder sql = new StringBuilder(String.Format("exec {0} ", storedProcName));

    foreach (var parameter in Parameters)
    {
        sql.Append(String.Format(":{0}, ", parameter.Key));
    }

    if (sql.ToString().EndsWith(", "))
    {
        sql = sql.Remove(sql.Length - 2, 2);
    }

    return sql.ToString();
} 
```

在数据库中，我的参数是类型`varbinary(max)`，我试图发送一个 'byte[]' 作为数据。

我尝试使用特定的`SetBinary`，但失败了。所有其他数据类型似乎都在工作。

我也尝试`query.SetParameter<byte[]>(parameter.Key, (byte[])parameter.Value);`过同样的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-02-17T12:17:11.983

这是一个有点老的问题，但我为新搜索者提供了答案。

对于 byte[] 参数，您可以通过这种方式指定长度

```
query.SetParameter(parameter.Key, parameter.Value, NHibernate.Type.TypeFactory.GetBinaryType(((byte[])parameter.Value).Length)); 
```

您需要确保过程参数有足够的长度

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T17:02:09.047

NHibernate 并不神奇地知道数据库中的数据类型是 varbinary(max)。您需要在映射中指定足够大的长度（我认为默认值为 8000 字节）。

# java - 将 RGBA、HSL 和 HSLA 颜色转换为 RGB（或在 java.awt.Color 对象中）

> ID：12373699
> 
> 赞同：1
> 
> 时间：2012-09-11T15:59:03.810
> 
> 标签：java, css, rgb, rgba, hsl

我正在寻找用于将 RGBA、HSL 和 HSLA 颜色转换为 RGB 颜色的算法的描述，或用于将它们转换为 java.awt.Color 对象的库。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T16:28:22.320

使用评论中的新信息，我将对其进行更改以反映您拥有的内容与您需要的内容。

首先，我们需要解析 rgb/hsl 字符串。这可以很容易地使用几个正则表达式和`String.split`：

```
private static final Pattern hexRegex = Pattern.compile("#[\\dA-Fa-f]{6}");
private static final Pattern rgbRegex = Pattern.compile("rgba?\\([^)]*\\)", Pattern.CASE_INSENSITIVE);
private static final Pattern hlsRegex = Pattern.compile("hlsa?\\([^)]*\\)", Pattern.CASE_INSENSITIVE); 
```

第一个`Pattern`匹配任何十六进制编码的值。第二个匹配`rgb(something)`或`rgba(something)`。第三个与第二个相同，但带有`hsl`and `hsla`。要使用这些：

```
public static int[] getRGB(String cssString) {
    if (hexRegex.matcher(cssString).matches())
        return getRgbFromHex(cssString);
    if (rgbRegex.matcher(cssString).matches())
        return getRgbFromRgb(cssString);
    if (hslRegex.matcher(cssString).matches())
        return getRgbFromHsl(cssString);
    return null; // no match
}

private static int[] getRgbFromHex(String hexString) {
    int rgb = Integer.decode(hexString);
    Color c = new Color(rgb);
    return new int[] { c.getRed(), c.getGreen(), c.getBlue(), c.getAlpha() };
}

private static int[] getRgbFromRgb(String rgbString) {
    String[] values = rgbString.split("[\\s,()]");
    // values[0] is just "rgb" or "rgba"
    String red = values[1];
    String green = values[2];
    String blue = values[3];
    String alpha = "1.0";
    if (values.length >= 5) {
        alpha = values[4];
    }
    return new int[] {
        parseValue(red, 255),
        parseValue(green, 255),
        parseValue(blue, 255),
        parseAlpha(alpha),
    };
}

private static int[] getRgbFromHsl(String hslString) {
    String[] values = hslString.split("[\\s,()]");
    // values[0] is just "hsl" or "hsla"
    String hue = values[1];
    String sat = values[2];
    String light = values[3];
    String alpha = "1.0";
    if (values.length >= 5) {
        alpha = values[4];
    }
    int h = parseValue(hue, 360);
    double s = parsePercent(sat);
    double l = parsePercent(light);
    int a = parseAlpha(alpha);
    return hslToRgb(h, s, l, a);
}

private static int[] hslToRgb(int h, double s, double l, int a) {
    // TODO Calculate me
    int r = 0;
    int g = 0;
    int b = 0;
    return new int[] { r, g, b, a };
}

private static int parseValue(String val, int max) {
    if (val.endsWith("%")) {
        return (int) (parsePercent(val) * max);
    }
    return Integer.parseInt(val);
}

private static double parsePercent(String perc) {
    return Integer.parseInt(perc.substring(0, perc.length() - 1)) / 100.0;
}

private static int parseAlpha(String alpha) {
    return (int) (Double.parseDouble(alpha) * 255);
} 
```

这就是一切：

*   `getRGB`- 获取 CSS 字符串，确定其格式，然后继续解析它。`null`如果无法确定格式（即无效）则返回。返回的数组将是 4 个元素，r、g、b 和 a，所有值都在 0 到 255 之间。
*   `getRgbFromHex`- 用于`Integer.decode`解析它，因为它`#`为我们生成十六进制数字，然后用于`Color`获取 RGB 值。
*   `getRgbFromRgb`- 解析`rgb`字符串中的值（包括`rgba`）。在空格、逗号或括号上拆分字符串，然后解析每个单独的值并从中创建一个数组。
*   `getRgbFromHsl`- 行为类似于`getRgbFromRgb`，但使用 HSL 值和适当的解析而不是 RGB 解析。
*   `hslToRgb`- 这是您在评论中说您已经完成的计算逻辑。只需在`int`这里从 h、s 和 l 计算 r、g 和 b 的值，这种方法就行了。
*   `parseValue`- 如果是百分比，则返回解析后的百分比乘以 的值`max`，否则，它只是将其解析为`int`using `Integer.parseInt`。
*   `parsePercent`- 解析字符串的整数部分并返回`double`除以 100 的值。
*   `parseAlpha`- 将 alpha 解析为 a`double`并返回 255 次。

使用 rgb/rgba 进行测试确认这是可行的：

```
public static void main(String[] args) {
    System.out.println(Arrays.toString(getRGB("#FF00CC")));
    System.out.println(Arrays.toString(getRGB("rgb(255,0,0)")));
    System.out.println(Arrays.toString(getRGB("rgba(255,0,0,0.5)")));
    System.out.println(Arrays.toString(getRGB("rgba(100%,0%,30%,0.5)")));
} 
```

这打印：

```
[255, 0, 204, 255]
[255, 0, 0, 255]
[255, 0, 0, 127]
[255, 0, 76, 127] 
```

您可能要考虑的另一件事是使用舍入而不是直接转换`int`为百分比内容。这将提高百分比的准确性。

如果您还有其他问题，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T17:51:09.733

您可以使用`Color.HSBtoRGB`和`Color.RGBtoHSB`。例如：

```
int r = 0, g = 255, b = 255;
float[] hsb = Color.RGBtoHSB(r, g, b, null);
for (float f : hsb) {
    System.out.println(f);
} 
```

这输出：

```
0.5
1.0
1.0 
```

这三个`float`值分别是 H、S 和 B 值。对于带有 alpha 的颜色，alpha 不会从 RGB 变为 HSB，因此`A == A`.

`Color`使用返回的数组创建一个：

```
Color color = Color.getHSBColor(hsb[0], hsb[1], hsb[2]); 
```

如果没有更多关于您到底想要什么作为输入和输出的详细信息，我无法为您提供更多帮助。

* * *

**编辑：**请参阅我的其他答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T09:24:05.070

您的正则表达式规则无法正常工作，因为它们允许不正确的字符串（例如 "rgba(1000,500%,500%,2)" ）并拒绝正确的形式（例如 "#fff" ）。

我写了更严格和正确的正则表达式规则：

```
 String keywords_color_regex = "^[a-z]*$";
    String hex_color_regex = "^#[0-9a-f]{3}([0-9a-f]{3})?$";
    String rgb_color_regex = "^rgb\\(\\s*(0|[1-9]\\d?|1\\d\\d?|2[0-4]\\d|25[0-5])\\s*,\\s*(0|[1-9]\\d?|1\\d\\d?|2[0-4]\\d|25[0-5])\\s*,\\s*(0|[1-9]\\d?|1\\d\\d?|2[0-4]\\d|25[0-5])\\s*\\)$";
    String rgba_color_regex = "^rgba\\(\\s*(0|[1-9]\\d?|1\\d\\d?|2[0-4]\\d|25[0-5])\\s*,\\s*(0|[1-9]\\d?|1\\d\\d?|2[0-4]\\d|25[0-5])\\s*,\\s*(0|[1-9]\\d?|1\\d\\d?|2[0-4]\\d|25[0-5])\\s*,\\s*((0.[1-9])|[01])\\s*\\)$";
    String hsl_color_regex = "^hsl\\(\\s*(0|[1-9]\\d?|[12]\\d\\d|3[0-5]\\d)\\s*,\\s*((0|[1-9]\\d?|100)%)\\s*,\\s*((0|[1-9]\\d?|100)%)\\s*\\)$"; 
```

对于 rgba 和 hsla，我的目标是计算实际显示的颜色。所以我想知道，给定一个 rgba/hsla 颜色及其背景颜色，是否有一种方法可以“混合”它们来计算显示的颜色......

# c# - Sharpzlib 读取带有简历的 ZipInputStream

> ID：12373700
> 
> 赞同：0
> 
> 时间：2012-09-11T15:59:06.243
> 
> 标签：c#, unzip, resume, sharpziplib, zipinputstream

我想要实现的是使应用程序能够提取大型远程文件（从 ftp 或 http），而无需完全下载它，并且在网络故障的情况下可以恢复提取。

按照这个例子

[http://wiki.sharpdevelop.net/SharpZipLib-Zip-Samples.ashx#Unpack_a_zip_using_ZipInputStream_eg_for_Unseekable_input_streams_5](http://wiki.sharpdevelop.net/SharpZipLib-Zip-Samples.ashx#Unpack_a_zip_using_ZipInputStream_eg_for_Unseekable_input_streams_5)

我可以提取文件，但如果出现网络故障，我无法恢复提取。我尝试使用 ZipInputStream.Skip(length) ，其中“length”是本地下载/解压缩文件的大小，但它似乎不起作用。它抛出异常，如：

在 ICSharpCode.SharpZipLib.dll 损坏的未压缩块中发生了“ICSharpCode.SharpZipLib.SharpZipBaseException”类型的第一次机会异常

任何想法？是否有可能实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T16:06:36.790

在他们的论坛上从 Sharpzlib 团队那里得到了答案。

这样做是可能的。这很简单。当实例化一个新的 ZipInputStream 时，您需要传递一个“专门的”流，它将包装一个 FTP 连接和一个由 FtpWebResponse 获得的流。

sharpzlib 团队在他们的 wiki 站点上添加了这个作为示例。看最后一个教程

[https://github.com/icsharpcode/SharpZipLib/wiki/Zip-Samples](https://github.com/icsharpcode/SharpZipLib/wiki/Zip-Samples)

# jsf - 集成 Spring MVC 和 JSF 2.1

> ID：12373701
> 
> 赞同：3
> 
> 时间：2012-09-11T15:59:11.497
> 
> 标签：jsf, rest, spring-mvc

我在 Spring MVC 和 Hibernate-Search 中构建了一个巨大的只读 RESTFUL 应用程序，它将一些数据编组为 json 和 xml，以供移动应用程序和监控应用程序使用。

我们的网址非常简单，我们有这个：

> 服务器：端口/实体/id/?marshalling=json

或者

> 服务器：端口/实体/id/?marshalling=xml

而有时

> 服务器：端口/实体/id/?marshalling=something&filterProp=entity.prop&ordering=desc

现在我需要使用 JSF 2.1 为此创建一个表示层并添加一些用户管理功能，我在想这样的事情：

> 服务器：端口/实体/id/?marshall=html

或者完全省略 marshall 请求参数。

现在。据我所知，您只能将 JSF 2.1 和 Spring Web Flow 结合起来，而不能直接结合 Spring MVC。有谁知道我怎样才能完成这个要求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T19:15:24.457

Spring MVC 和 JSF 都在单独的 servlet 上工作，这些 servlet 只能映射到不与另一个 servlet 冲突的上下文，所以这不能轻易完成，如果你成功了，那么它基本上是一个巨大的 hack。

如果我绝对必须这样做*（我不会这样做）*，那么我可能会使用 marshall servlet 克隆我的 JSF 请求，使用 WebClient 将该请求发送到我的 FacesServlet，然后将返回的 WebClient 响应复制到我的marshall servlet 响应并返回它。这对用户来说是透明的，但非常混乱并且可能不安全。

实现单独的基于 Web 的表示层的最佳方法是将对表示层的请求映射到 FacesServlet，这样您的 RESTFUL Web 服务就不会被直接调用。

Actor -> /admin/page.jsf -> FacesServlet -> JSF 视图 -> JSF 控制器 -> 业务逻辑层 -> RESTFUL Web 服务

通过这种方式，您的 RESTFUL Web 服务可以返回 XML 或 JSON 数据并充当您的 DAO，您的业务逻辑层可以在其上执行额外的逻辑。

# android - 获取图片库列表太慢——我需要快速的 BUCKET_DISPLAY_NAME 查询

> ID：12373708
> 
> 赞同：1
> 
> 时间：2012-09-11T15:59:40.530
> 
> 标签：android

我正在使用这种技术来获取 Android 中的照片桶或画廊列表

[获取 Android 上的照片库列表](https://stackoverflow.com/questions/4195660/get-list-of-photo-galleries-on-android)

但是，这会遍历每张图像，并且对于 1000 多张图像来说速度很慢。

有没有办法使用 SQL（可能是 DISTINCT 关键字？）更快地获取 BUCKET_DISPLAY_NAME 列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-04T16:17:29.213

以下解决方案对我有用。我发现在预测中做一个不同的不是媒体内容提供商的选择。此外，这似乎适用于 cursorLoader。

```
 // TODO Auto-generated method stub
    String[] projection = { Images.Media._ID, Images.Media.BUCKET_DISPLAY_NAME };

    HashMap<String, String> imagesGroups = new HashMap<String, String>();
    String ids = null;

    Cursor c = _myContext.getContentResolver().query(Images.Media.EXTERNAL_CONTENT_URI, projection, null, null, null);
    if (c.getCount() > 0)
    {
        c.moveToFirst();
        do
        {
            String bucketDisplayName = c.getString(c.getColumnIndex(Images.Media.BUCKET_DISPLAY_NAME));
            String _id = c.getString(c.getColumnIndex(Images.Media._ID));

            //here is where we ensure we get a unique image id for each distinct bucket display name
            if(!imagesGroups.containsKey(bucketDisplayName))
            {
                imagesGroups.put(bucketDisplayName, _id);

                if(ids == null)
                    ids = _id;
                else
                    ids += "," + _id;
            }
        }
        while (c.moveToNext());
    }

    c.close();

    String selection = Images.Media._ID + " IN (" + ids + ")";

    CursorLoader cursorLoader = new CursorLoader(this, Images.Media.EXTERNAL_CONTENT_URI, projection, selection, null, null);
    return cursorLoader; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:09:26.823

当使用更多图像时，我们必须使用延迟加载概念。如果你想看看[http://androidsnips.blogspot.in/2010/08/lazy-loading-of-images-in-list-view-in.html](http://androidsnips.blogspot.in/2010/08/lazy-loading-of-images-in-list-view-in.html)或[http://thinkandroid.wordpress。 com/2012/06/13/lazy-loading-images-from-urls-to-listviews/](http://thinkandroid.wordpress.com/2012/06/13/lazy-loading-images-from-urls-to-listviews/) 当使用这个概念时，第一次加载的图像被存储在内存中，如果再次获得相同的图像，它将无需再次加载即可直接查看和显示。希望这是你需要的

# c# - 如何将委托指向通过反射获得的方法

> ID：12373709
> 
> 赞同：1
> 
> 时间：2012-09-11T15:59:44.057
> 
> 标签：c#, reflection, delegates

我将程序集动态加载为：

```
 var assembly = Assembly.LoadFile("PathOFMyDll"); 
```

无论如何，该程序集`Filter`在类中具有静态方法`DynamicClass`。因此，一旦我拥有该程序集，我就会将该方法执行为：

```
 var filter = assembly.GetType("DyamicClass").GetMethod("Filter");

 // that method accepts a object as parameter
 filter.Invoke(null, new object[] { "test" }); 
```

* * *

**现在我的问题是：**

我有委托`delegate bool FilterDelegate(object item);`为什么不可能使该类型的委托指向该方法以便拥有：

```
 FilterDelegate myPointerToMethodFilter = (FilterDelegate)assembly.GetType("DyamicClass").GetMethod("Filter");
 bool result = myPointerToMethodFilter("test"); 
```

请注意，编译器仅在尝试编译时才会抱怨。我没有收到任何语法错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:01:48.127

可以从`MethodInfo`对象创建委托，但强制转换是不够的。

相反，使用[`Delegate.CreateDelegate()`](http://msdn.microsoft.com/en-us/library/53cz7sc6.aspx)：

```
MethodInfo myMethodFilter = assembly.GetType("DyamicClass").GetMethod("Filter");
FilterDelegate myPointerToMethodFilter = (FilterDelegate)Delegate.CreateDelegate(typeof (FilterDelegate), myMethodFilter); 
```

# sql - “，”附近的语法不正确 - Adapter.Update

> ID：12373711
> 
> 赞同：0
> 
> 时间：2012-09-11T15:59:53.617
> 
> 标签：sql, adapter

我有一个从 2 个表中提取数据的查询，例如：

```
select t1.col1,t1.col2,t2.col2,t2.col3 
from Table1 t1,Table2 t2 
where t1.col1=t2.col1 
```

我使用适配器来填充数据集。

我只在网格中显示 Table2 中的字段，并允许用户更新它们。

我为更新操作创建了一个 SqlCommand，并使用此命令仅在 Table2 上调用 adapter.update。

更新失败，针对用户更新的行给出“',' 附近的语法不正确”错误。

这个问题的原因可能是什么？

谢谢，桑托什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:04:02.557

使用`JOIN-Statement`：

```
SELECT t1.col1, t1.col2, t2.col2, t2.col3 
FROM Table1 t1
JOIN Table2 t2
ON t1.col1 = t2.col1 
```

# mysql - 在mysql中检索结果并格式化

> ID：12373712
> 
> 赞同：1
> 
> 时间：2012-09-11T16:00:06.023
> 
> 标签：mysql, sql

假设我有一列 col1，其中包含 5 个固定值，我使用一个字节字段来表示 ms sql server 中的每个值

```
1-value1...5-value5 
```

当我执行选择查询时，我得到的是gridview中的字节值

有没有办法让我可以更改输出以显示值？

而不是在gridview中显示1，我应该在gridview中看到value1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:09:51.153

使用[MySQL 的 CASE](http://dev.mysql.com/doc/refman/5.0/en/case.html)语句来打印字符串表示而不是字节值。如果您的字节设置了位，每个值一个，那么您需要使用按位与来查看是否设置了特定位，然后打印适当的字符串表示形式。否则我错过了什么吗？

# r - 将决策树规则应用于看不见的数据

> ID：12373717
> 
> 赞同：1
> 
> 时间：2012-09-11T16:00:36.503
> 
> 标签：r, weka, decision-tree

假设我使用来自 weka 的 rpart 或 J48 创建了一个简单的决策树，其中我的树有两个可能的终端输出。

而不是采用我可以直观地看到的树构建的规则并对其进行硬编码。如何动态读取我的 rpart 或 weka 对象，获取在我的训练数据上生成的规则并将其应用于我的测试数据？

# php - PHP中的数组输出

> ID：12373721
> 
> 赞同：-2
> 
> 时间：2012-09-11T16:00:47.707
> 
> 标签：php, javascript, arrays

我对 PHP 非常熟悉，所以这就是我正在尝试做的事情。我有一个数组

```
$companyStates = array("AR","TX","LA","OK","GA","NC","SC"); 
```

只是美国各州的列表。我需要对这个数组做两件简单的事情：1）以这种格式打印数组的值：ARTXLAOKGANCSC 没有空格，只是用于我正在使用的一些 javascript 的值。2) 然后，将数组中每个项目的数字 100 添加到字符串变量中，以逗号分隔。最终结果我需要两个变量，其值为 ARTXLAOKGANCSC 和 100,100,100,100,100,100,100

通常，我会做一个 for in 循环并推送到一个数组并列出数组的值，但我对 php 语法不够熟悉来完成这个.. 感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:03:14.353

1.

```
<?php

echo implode('', $companyStates); 
```

2.

```
<?php

echo implode(',', array_fill(0, count($companyStates), 100)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:03:48.950

第一个非常简单：[`implode`](http://php.net/implode)无需“胶水”即可使用：

```
echo implode($companyStates); 
```

第二个稍微复杂一些。我会`implode`再次使用，并结合[`array_fill`](http://php.net/array_fill)：

```
echo implode(',', array_fill(0, count($companyStates), '100')); 
```

`$companyStates`这会生成一个与所有元素都是 string 的长度相同的数组，然后在每个参数之间`100`用 a 折叠它们。`,`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T16:05:23.553

未经测试，但我认为它应该工作：

```
$companyStates = array("AR","TX","LA","OK","GA","NC","SC");
$nameList = implode('',$companyStates);
$numList = '';
for ($i = 0; $i < count($companyStates); $i++) {
    $numList .= ',100';
}
$numList = substr($numList,1,strlen($numList)); 
```

# haskell - 只做 GHC 类型检查？

> ID：12373722
> 
> 赞同：35
> 
> 时间：2012-09-11T16:00:48.373
> 
> 标签：haskell, ghc

有没有一种方法，无论是标准的还是聪明的 hack，都可以使在文件上调用 GHC 只运行类型检查器？例如

```
$ ghc --just-check-the-types x.hs
$ 
```

没有输出文件，没有 .hi 或 .o 等。不想/不能使用 GHC API。在这里只讨论命令行程序。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-09-11T16:24:05.563

怎么样`ghc -fno-code file.hs`。如果您的文件没有进行类型检查，它将不会生成其他文件并且会显示错误。

警告：这*不会*对详尽的模式匹配进行分析，因此如果您想要那些额外的有用警告，请不要单独使用此选项。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-11T16:23:42.647

这是一个黑客：

```
crabgrass:~/programming% ghc test.hs -e 'return 0'

test.hs:1:7:
    No instance for (Num (a0 -> t0))
      arising from the literal `3'
    Possible fix: add an instance declaration for (Num (a0 -> t0))
    In the expression: 3
    In the expression: 3 4
    In an equation for `foo': foo = 3 4
zsh: exit 1     ghc test.hs -e 'return 0' 
```

# sparql - SPARQL 过滤器 lang 'en' 提供其他语言

> ID：12373727
> 
> 赞同：11
> 
> 时间：2012-09-11T16:00:57.427
> 
> 标签：sparql, dbpedia

以下 SPARQL 查询没有得到我想要的结果，因为它们使用的是英语以外的其他语言，不管`filter lang 'en'`（请参阅查询中的过滤器）。

查询结果：

```
"Никола́й Ива́нович Буха́рин"@en    "Никола́й Буха́рин"@en  "Nikolai Bukharin"@en
"Gamal Abdel Nasser Hussein"@en     "جمال عبد الناصر"@en    "Gamal Abdel Nasser"@en 
```

我查看了DBpedia页面，看到有英文版的名字，但我不明白为什么过滤器不起作用！

有人可以帮我吗？

```
PREFIX dbo: <http://dbpedia.org/ontology/>
PREFIX dbpedia: <http://dbpedia.org/property/>
SELECT DISTINCT ?person ?birthname ?nameExact ?label
where {

     ?person rdf:type dbpedia-owl:Person .
     ?person rdfs:label ?label .
     OPTIONAL { ?person dbpedia-owl:birthName ?birthname . }
     OPTIONAL { ?person dbpprop:name ?nameExact . }

     FILTER (lang(?birthname) = 'en')
     FILTER (lang(?label) = 'en')
     FILTER (lang(?nameExact) = 'en')

}
LIMIT 300 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-05-09T22:15:24.443

请注意，要添加前缀，您必须在声明和查询中使用相同的前缀（`dbo`-> `dbo`，而不是`dbo`-> `dbpedia-owl`）

```
PREFIX dbo: <http://dbpedia.org/ontology/>
PREFIX dbp: <http://dbpedia.org/property/>

SELECT DISTINCT ?person ?birthname ?nameExact ?label
where {

     ?person rdf:type dbo:Person .
     ?person rdfs:label ?label .
     OPTIONAL { ?person dbo:birthName ?birthname . }
     OPTIONAL { ?person dbp:name ?nameExact . }

     FILTER (lang(?birthname) = 'en')
     FILTER (lang(?label) = 'en')
     FILTER (lang(?nameExact) = 'en')

}

LIMIT 300 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-11T18:22:01.790

语言标签是数据库中的注释。您的过滤器工作正常。数据库中的一些值`en`即使在不同的脚本中也会被注释。您需要编写自己的逻辑来选择最合适的属性。我可能只是使用该`rdfs:label`属性并切断括号中的任何内容（如`"Black Hawk (Sauk leader)"@en`）。这似乎提供了不错的结果。

另请注意，您需要将`FILTER`s for `?birthname`and`?nameExact` *放入*相应的`OPTIONAL`块中，否则它们最终将删除任何没有可选属性的匹配项。

# git - 暂存已删除的文件

> ID：12373733
> 
> 赞同：567
> 
> 时间：2012-09-11T16:01:03.350
> 
> 标签：git, git-add, git-rm, git-stage

假设我的 git 存储库中有一个名为`foo`.

假设它已用`rm`(not `git rm`) 删除。然后 git status 将显示：

```
Changes not staged for commit:

    deleted: foo 
```

如何暂存此单个文件删除？

如果我尝试：

```
git add foo 
```

它说：

```
'foo' did not match any files. 
```

**更新（9年后，哈哈）：**

这看起来已经在 git 2.x 中修复了：

```
$ git --version
git version 2.25.1

$ mkdir repo

$ cd repo

$ git init .
Initialized empty Git repository in repo/.git/

$ touch foo bar baz

$ git add foo bar baz

$ git commit -m "initial commit"
[master (root-commit) 79c736b] initial commit
3 files changed, 0 insertions(+), 0 deletions(-)
create mode 100644 bar
create mode 100644 baz
create mode 100644 foo

$ rm foo

$ git status
On branch master
Changes not staged for commit:
    deleted: foo

$ git add foo

$ git status
On branch master
Changes to be committed:
    deleted:    foo 
```

* * *

## 回答 #1

> 赞同：563
> 
> 时间：2012-09-11T16:02:24.133

用于`git rm foo`暂存文件以进行删除。（这也会从文件系统中删除该文件，如果它之前没有被删除。当然，它可以从 git 中恢复，因为它之前已签入。）

要暂存文件以进行删除而不将其从文件系统中删除，请使用`git rm --cached foo`

* * *

## 回答 #2

> 赞同：452
> 
> 时间：2012-09-11T16:36:45.327

即使使用是正确的`git rm [FILE]`，或者，您也可以使用`git add -u`.

根据`git-add`文档：

> -u --更新
> 
> 更新已经有匹配 [FILE] 条目的索引。这会删除并修改索引条目以匹配工作树，但不会添加新文件。
> 
> 如果使用 -u 选项时没有给出 [FILE]，则更新整个工作树中的所有跟踪文件（旧版本的 Git 用于限制对当前目录及其子目录的更新）。

之后将刷新索引并正确暂存文件。

* * *

## 回答 #3

> 赞同：187
> 
> 时间：2015-12-24T16:26:51.360

要暂存所有手动删除的文件，您可以使用：

```
git rm $(git ls-files --deleted) 
```

要将此命令的别名添加为`git rm-deleted`，请运行：

```
git config --global alias.rm-deleted '!git rm $(git ls-files --deleted)' 
```

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2017-03-27T20:52:11.853

从 Git 2.0.0 开始，`git add`也将暂存文件删除。

[Git 2.0.0 文档 - git-add](https://git-scm.com/docs/git-add/2.0.0)

> <路径规范>…</p>
> 
> 要从中添加内容的文件。可以给出 Fileglobs（例如 *.c）来添加所有匹配的文件。还可以给出一个前导目录名称（例如，添加 dir/file1 和 dir/file2 的 dir）以更新索引以匹配整个目录的当前状态（例如，指定 dir 将不仅记录文件 dir/file1 已修改在工作树中，一个文件 dir/file2 添加到工作树中，但也有一个文件 dir/file3 从工作树中删除。**请注意，旧版本的 Git 过去常常忽略删除的文件；如果您使用 --no-all 选项想要添加修改或新文件，但忽略已删除的文件。**

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2015-12-09T15:28:00.353

添加所有已删除的文件

```
git status -s | grep -E '^ D' | cut -d ' ' -f3 | xargs git add --all 
```

感谢检查以确保

```
git status 
```

你应该很高兴

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2019-11-13T13:14:03.320

你可以使用这个命令

```
git add `git ls-files --deleted` 
```

**解释：**

`git ls-files --deleted`- 此命令将返回所有已删除文件的文件名。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2015-01-16T14:34:20.050

您可以使用

`git rm -r --cached -- "path/to/directory"`

暂存已删除的目录。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-04-21T20:24:56.177

对于那些在 powershell 中使用 git 2.x+ 的人：

```
foreach ($filePath in (git ls-files --deleted)) { git add "$filePath" } 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2020-08-20T18:45:01.680

Ian Mackinnon 找到了答案，但使用 xargs 效果更好：

```
git ls-files --deleted -z | xargs -r0 git rm 
```

作为 git 别名：

```
git config --global alias.rm-deleted '!git ls-files --deleted -z | xargs -r0 git rm' 
```

这使用带有 NUL 终止的 xargs（保证不会出现在路径中的唯一字节）以及`git rm`如果文件列表为空则不运行的选项。

这种语法也兼容鱼。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2021-02-09T19:55:12.623

如果您只想将所有已删除的文件添加到阶段，那么您可以使用`git add .`

这是目前使用 git 最简单的方法`v2.27.0`。请注意，使用`*`和`.`是不同的方法。使用`git add *`只会添加当前存在的文件，而`git add .`还会暂存使用`rm`命令删除的文件。

很明显但值得一提的是，当您使用`git add .`.

# java - HashMap使用方式的设计实现

> ID：12373734
> 
> 赞同：0
> 
> 时间：2012-09-11T16:01:13.120
> 
> 标签：java, hashmap, concurrenthashmap

在 GUI 中显示帐户时，我需要显示主帐户（用于辅助帐户）每个主帐户可以有多个辅助帐户。

我正在尝试将主要到次要帐户信息保存在 HashMap 中。因为，这需要稍后检索。

在保存的同时，我还需要保存二级账户指令。所以，我需要保存两个带有键的对象作为主帐户。

```
1) Secondary Account
2) Secondary Instruction. 
```

我为帐户和指令对象覆盖了等于和哈希码。

我正在尝试使用主帐户哈希码作为键和值作为对象列表 [2]

-- 初始化

```
private static final Map<Integer, ArrayList<Object[]>> primaryToSecondaryAcct = new ConcurrentHashMap<Integer, ArrayList<Object[]>>(); 
```

-- 价值观

```
final Object[] acctInstr = new Object[2];
acctInstr[0] = acct;
acctInstr[1] = instr;
if(primaryToSecondaryAcct.get(getExistingAccount().hashCode()) != null) {
    primaryToSecondaryAcct.get(getExistingAccount().hashCode()).add(acctInstr);
} else {
    final ArrayList<Object[]> acctInstrList = new ArrayList<Object[]>();
    acctInstrList.add(acctInstr);
    primaryToSecondaryAcct.put(getExistingAccount().hashCode(), acctInstrList);
} 
```

*我想知道这是否正确以及是否有更好的方法。你能建议吗？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T16:06:43.410

代替：

```
Map<Integer, ArrayList<Object[]>> 
```

为什么没有

```
Map<Account, SecondaryInfo> 
```

目前，您正在针对密钥存储一个集合，当您从`Map`. 我认为创建一个合适的抽象并委托给它要好得多。该抽象将在一个位置处理验证、迭代等，而不是每次访问`Map`.

请记住 - OO 是关于*告诉对象为您做事*，而不是向他们询问信息并自己做。

我会用`Integer`特定`Account`对象替换您对帐户的表示。否则你将不得不管理大量代表不同类型的整数，而且很容易将它们混合在一起。键入它们（尽管使用一个普通的类）意味着您可以使用自动化工具轻松地重构并轻松确定类型，而无需诉诸命名约定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T16:15:16.613

我建议使用`Account`as key，因为对于两个不同的对象，hashcode 可以是相同的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T16:13:37.630

您想要的第一件事是[`MultiMap`](http://docs.guava-libraries.googlecode.com/git/javadoc/index.html?com/google/common/collect/Multimap.html)，您可以在Google的[Guava库中找到它。](https://code.google.com/p/guava-libraries/)这类似于 a `Map<K, Collection<V>>`，并为您将一个键映射到多个值，因此您不必重新发明它。

接下来，替换`Object[]`为您自己的自定义类：

```
public class SecondaryInformation {
    private SecondaryAccount secondaryAccount;
    private SecondaryInstruction secondaryInstruction;

    // Constructors, getters, setters, etc.
} 
```

所以你会有一个`MultiMap<Integer, SecondaryInformation>`. 这是[关于](https://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multimap)`MultiMap`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-11T16:34:16.337

如果对于`Primary`和`Secondary`帐户，您的课程如下：

```
public class PrimaryAccount 
{
    int id;
    private List<SecondaryAccount> secondaryAccounts;   
}

public class SecondaryAccount
{
    int id;
    private List<String> instructions;
    PrimaryAccount primaryAccount;
} 
```

那么，也许你甚至不需要`HashMap`. 但是，您可能仍希望保持`Hashmap`快速查找 Accounts: `HashMap<Integer,PrimaryAccoount>`，您将在其中存储帐户 ID 和主帐户。

这使得实现更干净。您是否确实需要为帐户编写`Primary`课程`Secondary`。

# configuration - TeamCity 的版本控制（例如在 TFS 中）构建配置 - 可能吗？

> ID：12373735
> 
> 赞同：6
> 
> 时间：2012-09-11T16:01:17.347
> 
> 标签：configuration, tfs, teamcity, versioning

我希望将我们的构建基础架构从 CC.NET 迁移到 TeamCity。诚然，在这一点上，TeamCity 非常环保。

一个潜在的阻碍是我们需要我们的构建配置与它构建的源代码一起进行版本控制。CC.NET 使这变得非常简单，并且是一个非常有用/强大的功能。

根据我的调查，您可以更改 TeamCity 存储其配置/数据的位置，但没有任何官方文档（也没有其他关于 SO 的主题）似乎提到将其放置在版本控制的位置，例如 TFS、Perforce 或 ClearCase。

**因此，我想知道这是否可能和/或它是“完成的事情”？**

如果 TeamCity 假定对任何配置文件进行 R/W 访问，并且底层 VCS 使文件 R/O 需要签入/签出语义，这是否会混淆 TeamCity 并使其停止工作。

这里有没有人有在 Team Foundation Server（或类似的）中控制 TeamCity 构建配置的经验？

谢谢，杰克

*仅供参考 -[一个版本如何控制 TeamCity 项目的配置？](https://stackoverflow.com/questions/3136165/how-does-one-version-control-the-configuration-of-a-teamcity-project)似乎是这里唯一类似的线程。 [http://confluence.jetbrains.net/display/TCD7/How+To](http://confluence.jetbrains.net/display/TCD7/How+To) ... 和相关的官方文档谈论迁移配置和/或备份它，这很接近，但并不是一回事。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T03:43:31.360

这不是答案，但...

我们向 JetBrains 询问了他们对此的建议，并得到了以下回复：

> 到目前为止，还没有将配置设置存储在版本控制中的功能。设置以 XML 格式存储在磁盘上（在 TeamCity 数据目录 - [http://confluence.jetbrains.net/display/TCD7/TeamCity+Data+Directory](http://confluence.jetbrains.net/display/TCD7/TeamCity+Data+Directory)中），理论上可以将目录与版本控制同步。您可能想为该功能投票或在我们的问题跟踪器中观看它：http: [//youtrack.jetbrains.com/issue/TW-2806](http://youtrack.jetbrains.com/issue/TW-2806)

我看不到任何优雅的解决方案，因此认为最好的解决方案（最差的解决方案......）是：

1.  将复杂的构建逻辑移动到版本控制的 MSBuild/Nant 脚本中；和
2.  如果您有时间，请在源代码管理和 TeamCity 数据目录之间实施自定义同步服务。在这种情况下，您可能必须准备好处理需要不时手动合并的故障（不好玩:-()。

祝你好运，如果你找到一个好的解决方案，请分享：-D

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-06T19:51:23.370

这已在 TeamCity 9 中引入：

[https://confluence.jetbrains.com/display/TCD9/Storing+Project+Settings+in+Version+Control](https://confluence.jetbrains.com/display/TCD9/Storing+Project+Settings+in+Version+Control)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-10T11:48:05.477

据我所知，这不受支持，但我推荐的一种方法是在构建期间调用存储在源代码管理中的批处理文件。批处理文件可以手动调用构建所需的命令，或者可以调用例如 FinalBuilder。这为构建过程提供了极大的灵活性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-23T09:30:59.823

很长一段时间以来，我一直想要一种源代码控制 TeamCity 配置的方法。我最终编写了一个 Windows 服务来监视配置目录并将更改提交到 git。

它不是 TFS，但源代码在 GitHub 上，因此您可以轻松地调整解决方案以满足您的需求。

该项目在 GitHub 上：[https ://github.com/grenade/teamcity-config-monitor](https://github.com/grenade/teamcity-config-monitor)

# c# - 如何在 HttpClient 的 HttpRequestMessage 上设置 cookie

> ID：12373738
> 
> 赞同：290
> 
> 时间：2012-09-11T16:01:28.967
> 
> 标签：c#, rest, asp.net-mvc-4, asp.net-web-api

我正在尝试使用 Web api`HttpClient`向需要以标识帐户的 HTTP cookie 的形式登录的端点发布帖子（这只是`#ifdef`发布版本中删除的内容）。

如何将 cookie 添加到`HttpRequestMessage`?

* * *

## 回答 #1

> 赞同：424
> 
> 时间：2012-09-11T16:57:35.643

以下是为请求设置自定义 cookie 值的方法：

```
var baseAddress = new Uri("http://example.com");
var cookieContainer = new CookieContainer();
using (var handler = new HttpClientHandler() { CookieContainer = cookieContainer })
using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
{
    var content = new FormUrlEncodedContent(new[]
    {
        new KeyValuePair<string, string>("foo", "bar"),
        new KeyValuePair<string, string>("baz", "bazinga"),
    });
    cookieContainer.Add(baseAddress, new Cookie("CookieName", "cookie_value"));
    var result = await client.PostAsync("/test", content);
    result.EnsureSuccessStatusCode();
} 
```

* * *

## 回答 #2

> 赞同：395
> 
> 时间：2012-11-08T10:31:34.973

在大多数情况下，接受的答案是正确的方法[。](/a/12374486/13552)但是，在某些情况下，您需要手动设置 cookie 标头。通常，如果您设置“Cookie”标头，它会被忽略，但这是因为`HttpClientHandler`默认使用其`CookieContainer`属性来存储 cookie。如果您禁用它，那么通过设置`UseCookies`您`false`可以手动设置 cookie 标头，它们将出现在请求中，例如

```
var baseAddress = new Uri("http://example.com");
using (var handler = new HttpClientHandler { UseCookies = false })
using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
{
    var message = new HttpRequestMessage(HttpMethod.Get, "/test");
    message.Headers.Add("Cookie", "cookie1=value1; cookie2=value2");
    var result = await client.SendAsync(message);
    result.EnsureSuccessStatusCode();
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-09-19T13:13:39.077

在这个问题上花了几个小时后，上面的答案都没有帮助我，所以我找到了一个非常有用的工具。

首先，我使用 Telerik 的 Fiddler 4 详细研究了我的 Web Requests

其次，我遇到了 Fiddler 这个有用的插件：

[https://github.com/sunilpottumuttu/FiddlerGenerateHttpClientCode](https://github.com/sunilpottumuttu/FiddlerGenerateHttpClientCode)

它只会为您生成 C# 代码。一个例子是：

```
 var uriBuilder = new UriBuilder("test.php", "test");
        var httpClient = new HttpClient();

        var httpRequestMessage = new HttpRequestMessage(HttpMethod.Post, uriBuilder.ToString());

        httpRequestMessage.Headers.Add("Host", "test.com");
        httpRequestMessage.Headers.Add("Connection", "keep-alive");
     //   httpRequestMessage.Headers.Add("Content-Length", "138");
        httpRequestMessage.Headers.Add("Pragma", "no-cache");
        httpRequestMessage.Headers.Add("Cache-Control", "no-cache");
        httpRequestMessage.Headers.Add("Origin", "test.com");
        httpRequestMessage.Headers.Add("Upgrade-Insecure-Requests", "1");
    //    httpRequestMessage.Headers.Add("Content-Type", "application/x-www-form-urlencoded");
        httpRequestMessage.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36");
        httpRequestMessage.Headers.Add("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8");
        httpRequestMessage.Headers.Add("Referer", "http://www.translationdirectory.com/");
        httpRequestMessage.Headers.Add("Accept-Encoding", "gzip, deflate");
        httpRequestMessage.Headers.Add("Accept-Language", "en-GB,en-US;q=0.9,en;q=0.8");
        httpRequestMessage.Headers.Add("Cookie", "__utmc=266643403; __utmz=266643403.1537352460.3.3.utmccn=(referral)|utmcsr=google.co.uk|utmcct=/|utmcmd=referral; __utma=266643403.817561753.1532012719.1537357162.1537361568.5; __utmb=266643403; __atuvc=0%7C34%2C0%7C35%2C0%7C36%2C0%7C37%2C48%7C38; __atuvs=5ba2469fbb02458f002");

        var httpResponseMessage = httpClient.SendAsync(httpRequestMessage).Result;

        var httpContent = httpResponseMessage.Content;
        string result = httpResponseMessage.Content.ReadAsStringAsync().Result; 
```

请注意，我必须注释掉两行，因为这个插件还不完全完美，但它仍然完成了工作。

免责声明：无论如何，我都没有得到 Telerik 或插件作者的关联或认可。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-08-19T20:54:14.117

对我来说，简单的解决方案可以在**HttpRequestMessage**对象中设置 cookie。

```
protected async Task<HttpResponseMessage> SendRequest(HttpRequestMessage requestMessage, CancellationToken cancellationToken = default(CancellationToken))
{
    requestMessage.Headers.Add("Cookie", $"<Cookie Name 1>=<Cookie Value 1>;<Cookie Name 2>=<Cookie Value 2>");

    return await _httpClient.SendAsync(requestMessage, cancellationToken).ConfigureAwait(false);
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-10-01T14:49:18.537

我有一个类似的问题，对于我的 AspNetCore 3.1 应用程序，这个问题的其他答案不起作用。我发现在我的配置中配置一个命名的 HttpClient`Startup.cs`并使用 Cookie 标头的标头传播效果很好。它还避免了有关正确处理您的处理程序和客户端的所有问题。请注意，如果请求 cookie 的传播不是您需要的（抱歉，操作），您可以在配置客户端工厂时设置自己的 cookie。

*   我使用了 Microsoft 的本指南 - [Make HTTP requests using IHttpClientFactory in ASP.NET Core](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/http-requests?view=aspnetcore-3.1)
*   本节介绍标头传播 -[标头传播中间件](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/http-requests?view=aspnetcore-3.1#header-propagation-middleware)

### 配置服务`IServiceCollection`

```
services.AddHttpClient("MyNamedClient").AddHeaderPropagation();
services.AddHeaderPropagation(options =>
{
    options.Headers.Add("Cookie");
}); 
```

### 配置为`IApplicationBuilder`

```
builder.UseHeaderPropagation(); 
```

*   注入`IHttpClientFactory`你的控制器或中间件。
*   创建您的客户`using var client = clientFactory.CreateClient("MyNamedClient");`

# logging - 解析 AWS S3 流日志以获取总带宽

> ID：12373740
> 
> 赞同：1
> 
> 时间：2012-09-11T16:01:33.413
> 
> 标签：logging, amazon-web-services, streaming

我正在解析一个 Amazon S3 流日志文件，以期获得视频和音频资产的每日累积流使用量。

但是，我能够从这些日志中提取的 8 月份总数至少是 AWS 仪表板账单所说使用量的一半。查看文档后，[日志](http://docs.amazonwebservices.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html)中提供的 sc 字节计数字段是截至事件发生时的运行总数（播放、暂停、停止、断开连接等）

我们的账单显示我们在 8 月份使用了 22GB 的数据，但捕获断开连接事件（这可能是该用户会话的最终字节数）显示了 10GB 的数据使用量。捕获 sc 字节计数的任何其他组合要么导致数字太高，要么至少是我们在 AWS 控制台中实际计费的一半。

有没有人创建过类似的东西，可以从日志文件中阐明什么准确代表会话中的使用流带宽，这些日志文件可以聚合以产生每日和以后的每月使用计数？

# java - 在 Java 中生成 MM7 Soap 请求

> ID：12373744
> 
> 赞同：2
> 
> 时间：2012-09-11T16:01:51.743
> 
> 标签：java, xml, mms, smil, mm7

我需要生成一个 MM7 Soap 消息，就像下面的一样。我可以生成 MM7 Soap，但 SMIL 消息部分和图像/文本附件存在问题。有谁知道如何生成这些零件？

```
<?xml version="1.0" encoding="UTF-8"?>
<P:Envelope xmlns:P="http://schemas.xmlsoap.org/soap/envelope/">
<P:Header>
<mm7:TransactionID   xmlns:mm7="http://www.3gpp.org/ftp/Specs/archive/23_series/23.140/schema/REL-6-MM7-1-0" P:mustUnderstand="1" >1343706064118205</mm7:TransactionID>
</P:Header>
<P:Body>
<mm7:SubmitReq xmlns:mm7="http://www.3gpp.org/ftp/Specs/archive/23_series/23.140/schema/REL-6-MM7-1-0">
<mm7:MM7Version>6.3.0</mm7:MM7Version>
<mm7:SenderIdentification>
<mm7:VASPID>1000</mm7:VASPID>
<mm7:VASID>0005</mm7:VASID>
<mm7:SenderAddress>
<mm7:Number>Dialog MMS</mm7:Number>
</mm7:SenderAddress>
</mm7:SenderIdentification>
<mm7:Recipients>
<mm7:Bcc>
<mm7:Number>94773087654/TYPE=PLMN</mm7:Number>
</mm7:Bcc>
</mm7:Recipients>
<mm7:ServiceCode>105</mm7:ServiceCode>
<mm7:DeliveryReport>true</mm7:DeliveryReport>
<mm7:Subject>DailyMirror News Service</mm7:Subject>
<mm7:ChargedParty>Neither</mm7:ChargedParty>
<mm7:ChargedPartyID></mm7:ChargedPartyID>
</mm7:SubmitReq></P:Body></P:Envelope> 
```

--==========fBS6FtL4PDKimRjInCAaIDytdJ9ulmContent-Transfer-Encoding: 8bitContent-Type: multipart/related; 类型=“应用程序/微笑”；开始=“”；边界=481bf3d684924bbee13179cd4576eda8--481bf3d684924bbee13179cd4576eda8Content-Transfer-Encoding: 8bitContent-ID: <35_1>Content-Type: text/plain; name="35_1.txt"内容配置：附件；filename="35_1.txt"1.ABC 2\. XYZ
--481bf3d684924bbee13179cd4576eda8 内容传输编码：8bitContent-ID：<35_2>Content-Type：image/jpeg；name="35_2.jpg"Content-Disposition：附件；文件名="35_2.jpg"......Exif..II*........Ducky.......<...... Adobe.d.................................

Content-Transfer-Encoding: 8bitContent-ID: Content-Type: application/smil; name="mms.smill"Content-Disposition：附件；文件名="mms.smill"

```
<?xml version="1.0" encoding="UTF-8"?>
<smil xmlns="http://www.w3.org/2000/SMIL20/CR/Language">
<head>
<layout>
  <root-layout width="300" height="300" background-color="white"/>
  <region id="Item0" top="125" left="1" width="99%" height="49%" fit="fill"/>
</layout>
</head>
<body>
<par dur="10s">
  <text region="Item0" src="cid:35_1"/>
  <img region="Item1" src="cid:35_2"/>
</par>

</body>
</smil> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T13:22:50.880

最终的请求应该像这样，注意哑剧边界部分

```
--mime-boundary-boundary1
Content-Type: text/xml; charset=utf-8
Content-ID: <mm7_msg>

<?xml version='1.0' ?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<soap:Header>
<mm7:TransactionID xmlns:mm7="http://www.3gpp.org/ftp/Specs/archive/23_series/23.140/schema/REL-5-MM7-1-2" soap:mustUnderstand="1">
1348056868070-1-
</mm7:TransactionID>
</soap:Header>
<soap:Body>
<SubmitReq xmlns="http://www.3gpp.org/ftp/Specs/archive/23_series/23.140/schema/REL-5-MM7-1-2">
<MM7Version>5.3.0</MM7Version>
<SenderIdentification>
<VASPID>Ejada</VASPID>
<VASID>Ejada</VASID>
</SenderIdentification>
<Recipients>
<To>
<Number>1111</Number>
</To>
</Recipients>
<DeliveryReport>true</DeliveryReport>
<Subject>Allah Akbar</Subject>
<Content href="cid:mms_cid" />
</SubmitReq>
</soap:Body>
</soap:Envelope>

--mime-boundary-boundary1
Content-Type: multipart/mixed; boundary="mime-boundary-boundary2"
Content-ID: <mms_cid1>

--mime-boundary-boundary2
Content-Type: text/plain
Content-ID: <contentId1.txt>
Content-location: contentlocation1.txt

test from jmeter, hello world!

--mime-boundary-boundary2
Content-Type: image/jpeg
Content-location: Ejada.jpg

(=================binary data for the image goes here)

--mime-boundary-boundary2
Content-Type: application/smil
Content-ID: <smil file>
Content-location: smil file

<smil>
    <head>
        <layout>
            <root-layout height="80" width="101"/>
            <region fit="hidden" height="50%" id="Text" left="0%" top="0%" width="100%"/>
            <region fit="hidden" height="50%" id="Image" left="0%" top="50%" width="100%"/>
        </layout>
    </head>
    <body>
      <par dur="5000ms">
        <img region="Image" src="Ejada.jpg"/>
        <text region="Text" src="sample.txt"/>
      </par>
    </body>
</smil>

----mime-boundary-boundary1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-14T13:15:42.633

使用 InstantCom 的 MM7 java 库[https://github.com/vnesek/instantcom-mm7](https://github.com/vnesek/instantcom-mm7)（无耻披露，我是维护者），您可以生成或多或少相同的请求：

```
 SubmitReq sr = new SubmitReq();
    sr.setNamespace("http://www.3gpp.org/ftp/Specs/archive/23_series/23.140/schema/REL-5-MM7-1-2");
    sr.setMm7Version("5.3.0");
    sr.setVaspId("Ejada");
    sr.setVasId("Ejada");
    sr.setSubject("Allah Akbar");
    sr.setDeliveryReport(true);
    sr.addRecipient(new Address("1111", RecipientType.TO));
    sr.setTransactionId("1348056868070-1-");

    // Attach a SMIL presentation
    BinaryContent smil = new BinaryContent("application/smil", load("smil-sample2.xml"));
    smil.setContentId("smil");

    // Attach a picture
    BinaryContent image = new BinaryContent("image/jpeg", load("lorena.jpg"));
    image.setContentId("image");

    // Attach a text
    TextContent text = new TextContent("Lorena sends a lots of hugs!");
    text.setContentId("text");

    // Pack it all up
    sr.setContent(new BasicContent(smil, image, text));

    MM7Message.save(sr, System.out, new MM7Context()); 
```

输出将是：

```
--==MM7-SOAP==5474f579-afe1-4b23-b8e2-0b162f89fd94
Content-Type: text/xml; charset="utf-8"
Content-ID: <mm7-soap>

<env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/">
  <env:Header>
    <mm7:TransactionID xmlns:mm7="http://www.3gpp.org/ftp/Specs/archive/23_series/23.140/schema/REL-5-MM7-1-2" env:mustUnderstand="1">1348056868070-1-</mm7:TransactionID>
  </env:Header>
  <env:Body>
    <mm7:SubmitReq xmlns:mm7="http://www.3gpp.org/ftp/Specs/archive/23_series/23.140/schema/REL-5-MM7-1-2">
      <mm7:MM7Version>5.3.0</mm7:MM7Version>
      <mm7:SenderIdentification>
        <mm7:VASPID>Ejada</mm7:VASPID>
        <mm7:VASID>Ejada</mm7:VASID>
      </mm7:SenderIdentification>
      <mm7:Recipients>
        <mm7:To>
          <mm7:Number>1111</mm7:Number>
        </mm7:To>
      </mm7:Recipients>
      <mm7:MessageClass>INFORMATIONAL</mm7:MessageClass>
      <mm7:DeliveryReport>true</mm7:DeliveryReport>
      <mm7:Subject>Allah Akbar</mm7:Subject>
      <mm7:Content href="cid:mm7-content" />
    </mm7:SubmitReq>
  </env:Body>
</env:Envelope>
--==MM7-SOAP==5474f579-afe1-4b23-b8e2-0b162f89fd94
Content-Type: multipart/related; start="<smil>"; type="application/smil"; boundary="==Multipart==7f92313b-8941-4e9e-8ea6-a0838d80e63b"
Content-ID: <mm7-content>

--==Multipart==7f92313b-8941-4e9e-8ea6-a0838d80e63b
Content-Type: application/smil
Content-ID: <smil>
Content-Transfer-Encoding: 7bit

<smil>
    <head>
        <layout>
            <root-layout height="80" width="101"/>
            <region fit="hidden" height="50%" id="Text" left="0%" top="0%" width="100%"/>
            <region fit="hidden" height="50%" id="Image" left="0%" top="50%" width="100%"/>
        </layout>
    </head>
    <body>
      <par dur="5000ms">
        <img region="Image" src="cid:image"/>
        <text region="Text" src="cid:text"/>
      </par>
    </body>
</smil>
--==Multipart==7f92313b-8941-4e9e-8ea6-a0838d80e63b
Content-Type: image/jpeg
Content-ID: <image>
Content-Transfer-Encoding: 8bit

<skipped binary content>
--==Multipart==7f92313b-8941-4e9e-8ea6-a0838d80e63b--
--==MM7-SOAP==5474f579-afe1-4b23-b8e2-0b162f89fd94-- 
```

# c# - MVC 中的日期时间格式

> ID：12373747
> 
> 赞同：0
> 
> 时间：2012-09-11T16:02:08.653
> 
> 标签：c#, asp.net-mvc, razor

我在 MVC c# 中工作。我想修改日期时间显示（项目包含一些日期）。

在我的课堂上：

```
public ActionResult Edit(long id){
        ...
        return View(project);
    }

[HttpPost]
public ActionResult Edit(Project _project){
        ...
        Save(_project);
        return View();
    } 
```

在编辑器模板中：

```
<%:Html.TextBox("", String.Format("{0:dd/MM/yyyy HH:mm}", Model.HasValue ? Model : DateTime.Today), new { @class = "dp" })%> 
```

这个版本很好用，当我尝试将格式修改为:`{0:dd/MM/yyyy - HH:mm}`时，_project 中的日期是错误的（我认为是默认值）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:05:02.507

你的`Project`模型是什么样的？因为在你的三元组中，如果它是你的模型，你正在传递你的模型`HasValue`。我认为那将是你的问题。

# mysql - 如何使用 sqlalchemy 获得奴隶滞后？

> ID：12373761
> 
> 赞同：0
> 
> 时间：2012-09-11T16:02:57.877
> 
> 标签：mysql, sqlalchemy

有没有办法使用 sql alchemy 获得当前的奴隶滞后？session.execute('show slave status') 似乎没有返回任何行：

```
In [0]: list(session.execute('show slave status'))

ResourceClosedError: This result object does not return rows. It has been closed automatically. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T01:59:45.600

```
from sqlalchemy import create_engine

engine = create_engine('mysql+pymysql://username:password@your.hostname.com/')
connection = engine.connect()
result = connection.execute("SHOW SLAVE STATUS") 
for row in result:
   for k in row.keys():
     print k, ' >>> ', row[k] 
```

# count - 我有两行具有不同的 id。我想添加这两行并将其显示为 One

> ID：12373768
> 
> 赞同：0
> 
> 时间：2012-09-11T16:03:26.673
> 
> 标签：count, group-by, sum, rows

我使用 count 和 group by 函数从两个不同的表中得到一个派生表，其输出是这样的。

```
Department   DeptID   Count(noofemployees)

HR            1          60
Accounting    19         7
Computers     4          67
Sys admin     6          5
Finance       3          15
Admin         9          12 
```

现在我正在尝试添加和显示

```
HR + Accounting + Finance = 10 + 7 + 13 = 30 as HR

Computers + Sys admin = 65 + 5 =70 as Computers

Department   DeptID   Count(noofemployees)

HR            1          30
Computers     4          70
Admin         9          12 
```

你能帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T17:10:03.250

我已经找到了这个问题的答案，

我无法在此调用部门名称，但只能显示总和`COUNT(Noofemployees)`，因为我们无法分组

我们可以用

```
SELECT SUM(CASE WHEN Department IN('HR','Accounting','Finance' THEN 1 ELSE 0)HR,
SUM(CASE WHEN Department IN('Computers','sys admin' THEN 1 ELSE 0)computers,
SUM(CASE WHEN Department IN('Admin' THEN 1 ELSE 0)Admin
FROM table_name. 
```

这会给我一个输出：

```
HR  Computers  Admin
30    70         12 
```

不是我正在寻找的输出，但现在有帮助。如果有人可以帮助我获得我正在寻找的输出，那就太好了。

谢谢

# mysql - 我忘记了分号“;” 在 MySQL 终端查询中。我该如何退出？

> ID：12373772
> 
> 赞同：15
> 
> 时间：2012-09-11T16:03:43.647
> 
> 标签：mysql, sql, macos, terminal

有时我忘记用分号“;”结束我的 SQL 查询 在我的 Mac 终端中。发生这种情况时，终端会`->`在开头设置 a，我无法退出或运行任何其他 SQL 命令。

我该如何退出？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2015-06-30T14:21:45.057

您不知道 mysql 终端的 5 种不同的报价模式。我建议您查看它们：

[https://dev.mysql.com/doc/refman/5.0/en/entering-queries.html](https://dev.mysql.com/doc/refman/5.0/en/entering-queries.html)

**上述链接的相关部分：**

下表显示了您可能会看到的每个提示，并总结了它们对 mysql 所处状态的含义。

```
Prompt  Meaning
mysql>  Ready for new command.

->      Waiting for next line of multiple-line command.

'>      Waiting for next line, waiting for completion of a string 
        that began with a single quote (“'”).

">      Waiting for next line, waiting for completion of a string 
        that began with a double quote (“"”).

`>      Waiting for next line, waiting for completion of an 
        identifier that began with a backtick (“`”).

/*>     Waiting for next line, waiting for completion of a 
        comment that began with /*. 
```

在 MySQL 5.0 系列中，`/*>`提示是在 MySQL 5.0.6 中实现的。

当您打算在单行上发出命令但忘记了终止分号时，多行语句通常会意外出现。在这种情况下，mysql 等待更多输入：

```
mysql> SELECT USER()
    -> 
```

如果这发生在你身上（你认为你已经输入了一个语句，但唯一的响应是 -> 提示符），很可能 mysql 正在等待分号。如果您没有注意到提示告诉您什么，您可能会坐在那里一段时间，然后才意识到您需要做什么。输入分号完成语句，mysql执行：

**TLDR：**

要退出，请键入`\c`、或。如果所有这些都失败了，请通过键入、或`;``ctrl-c``ctrl-d``'<enter>``"<enter>``*/<enter>`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-11T16:06:24.257

只需键入 \c 即可清除当前输入语句

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-11T16:08:23.523

只需输入“;” 然后按回车。在命令行模式下，您可以使用任意数量的输入行来完成查询。因此，您可以执行以下操作：

```
>SELECT
>*
>FROM
>table
>WHERE
>id=5
>; 
```

如果你喜欢。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-07-07T11:02:43.793

你可以试试`"\q"`这对我有用

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-06-05T22:44:06.680

使用以下任一键盘快捷键：`Ctrl+C`或`Ctrl+D`。这些可用于立即退出在命令提示符下运行的任何程序。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-10-01T22:55:11.713

使用 ctrl+c 它将转到下一行。

# sql - MSSQL 加速查询 365 万行

> ID：12373780
> 
> 赞同：0
> 
> 时间：2012-09-11T16:04:20.993
> 
> 标签：sql, sql-server, sql-server-2005

我的表中有大约 3.65 亿行，并且在数据使用一年后，我们每天都会添加额外的 10 万行，它会被移动到存档数据的不同表中。

我在 DataCollectionID 上有一个 PK 聚集索引。

我还有另一个索引：AssetID、DataPointID 和 DatapointDate 上的唯一非聚集索引

我需要非常快速地对表运行多个选择查询......这是我的选择查询：

```
SELECT [DataPointID]
  ,[SourceTag]
  ,[DatapointDate]
  ,[DataPointValue]
FROM DataCollection
Where 
  DatapointDate >= '2012-09-07' AND 
  DatapointDate < '2012-09-08' AND
  DataPointID = 1100
ORDER BY DatapointDate 
```

此查询应返回 8,640 行，但执行时间为 00:00:08（8 秒）。即使我说给我前 10 名，它仍然需要 8 秒。有人可以帮我加快这个过程吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:17:37.187

我认为帮助此查询的更有效索引将按 DataPointID、DataPointDate 的顺序排列。这将允许优化器在第一个索引列上使用相等运算符快速缩小字段范围，然后找到该集合内的日期范围。

这里有一些很好的索引和类似查询示例：

[http://sqlserverpedia.com/wiki/Index_Selectivity_and_Column_Order](http://sqlserverpedia.com/wiki/Index_Selectivity_and_Column_Order)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:10:03.987

如果这是动态 SQL，则应将其放入存储过程中，并记得使用`SET NOCOUNT ON`.

否则，这听起来像是硬件问题：在这种情况下，更多内存可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T16:28:12.903

您需要一个更好的覆盖索引，例如：

```
create index _idx ON DataCollection ( DataPointDate, DataPointId )
include ( SourceTag, DataPointValue ) 
```

您通常希望在索引的前面有最具选择性（即最独特）的列，因此这可能是 dataPointDate 或 dataPointId ，具体取决于您的数据。

# database - 使用 Microsoft dbase III 驱动程序和数字字段宽度创建表

> ID：12373782
> 
> 赞同：0
> 
> 时间：2012-09-11T16:04:45.737
> 
> 标签：database, odbc, dbase

我正在 dbase III (*.dbf) 文件中创建一个表。一切正常，但一些数字列需要特定的宽度和精度。如果我在 CREATE TABLE 语法中添加宽度和精度，例如 HEIGHT NUMERIC(8,2)，那么它就不起作用。我尝试了两个连接字符串...

```
CString connString = "Driver={Microsoft dBASE Driver (*.dbf)};DriverID=277;Dbq=" + directory;
CString connString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + directory + ";Extended Properties=dBASE III;"; 
```

当我尝试创建表时，第一个将导致错误，第二个将允许我创建表，但没有将宽度或精度应用于生成的 dbf 文件。

odbc creat table 语句的错误是... 代码 = 80040e14 代码含义 = IDispatch 错误 #3092 源 = 用于 ODBC 驱动程序的 Microsoft OLE DB 提供程序 描述 = [Microsoft][ODBC dBase 驱动程序] CREATE TABLE 语句中的语法错误。

任何人都知道我应该使用什么来创建具有特定字段宽度和精度的 dbf (dbaseIII) 文件？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-06T19:59:37.613

我迟到了，对不起；）

我想，你不能。查看 [ODBC 数据类型](http://msdn.microsoft.com/en-us/library/ms713987%28v=vs.85%29.aspx)

> 虽然 dBASE 允许使用 NUMERIC 数据类型指定精度和小数位数，但 ODBC dBASE 驱动程序不支持它。ODBC dBASE 驱动程序始终为 NUMERIC 数据类型返回 15 的精度和 0 的小数位数。

# java - 什么样的设计模式适合这种情况？

> ID：12373783
> 
> 赞同：0
> 
> 时间：2012-09-11T16:04:51.947
> 
> 标签：java, design-patterns

我有 2D 水力数据，这些数据是数千兆字节的文本文件，其中包含网格中每个点的深度和速度信息，分为时间步长。每个时间步包含网格中每个点的深度/速度值。因此，您可以在每个时间步中跟踪一个点，看看它的深度/速度如何变化。我想一次读取一个时间步长的数据，计算各种东西 - 网格单元达到的最大深度、最大速度、水深超过 2 英尺的第一个时间步长的数量等。每个结果这些计算将是一个网格 - 每个点的最大深度等。

到目前为止，这听起来像是装饰器模式。但是，我不确定如何从各种计算中得到结果——每次计算都会产生不同的网格。在创建每个装饰器后，我必须保留对它的引用，以便从中提取结果，或者添加一个`getResults()`返回不同结果的映射的方法，等等，这两种方法听起来都不理想。

另一种选择是策略模式。每个计算都是一种不同的算法，它在时间步长（当前深度/速度）和前几轮的结果（迄今为止的最大深度、迄今为止的最大速度等）上运行。然而，这些先前的结果对于每次计算都是不同的——这意味着算法类要么成为有状态的，要么成为调用者的工作来跟踪先前的结果并将它们输入。我也不喜欢策略模式，因为循环的行为timesteps 成为调用者的责任 - 我只想给“计算器”一个迭代器（根据需要从磁盘中获取它们）并让它产生它需要的结果。

附加约束：

*   输入很大并且从磁盘读取，因此按时间步只迭代一次是唯一实用的方法
*   网格很大，因此应尽可能就地进行计算

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T17:10:39.377

如果我理解你的问题是正确的，你有一个 grid_points 有很多时间步长并且每个时间步长都有深度和速度。现在有 GB 的数据。

我建议对数据进行一次传递并将解析的数据存储在 RDBMS 中。然后对此数据运行查询或存储过程。这样至少应用程序不会耗尽内存

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T17:19:45.637

首先，也许我没有很好地理解这个问题并且错过了我的回答中的重点，在这种情况下，我很抱歉占用您的时间。

乍一看，我会想到一种更类似于“策略模式”的方法，结合面向数据的基础，类似于以下伪代码：

```
foreach timeStamp

  readGridData

  foreach activeCalculator in activeCalculators

    useCalculatorPointerListToAccessSpecificStoredDataNeededForNewCalculation

    performCalculationOnFreshGridData

    updateUpdatableData

    presentUpdatedResultsToUser

    storeGridResultsInDataPool(OfResultBaseClassType)

    discardNoLongerNeededStoredGridResults

  next calculator
next timeStep 
```

再次，对不起，如果这是题外话。

# symfony - Symfony2 配置数据库存储会话

> ID：12373785
> 
> 赞同：3
> 
> 时间：2012-09-11T16:04:59.137
> 
> 标签：symfony

更新：问题已解决，请参阅评论（许多问题，版本差异只是其中之一）。

我正在尝试在 config.yml 文件中配置 Symfony2 中的会话。我有以下配置：

```
session:
    default_locale: %locale%
    lifetime:       7200
    auto_start:     true
    storage_id:     session.storage.pdo

parameters:
  pdo.db_options:
    db_table:    session
    db_id_col:   session_id
    db_data_col: session_value
    db_time_col: session_time

services:
  pdo:
    class: PDO
    arguments:
      - "mysql:dbname=%database_name%"
      - %database_user%
      - %database_password%

session.storage.pdo:
  class:     Symfony\Component\HttpFoundation\SessionStorage\PdoSessionStorage
  arguments: [@pdo, %session.storage.options%, %pdo.db_options%] 
```

它基于 Symfony2 的食谱[http://symfony.com/doc/2.0/cookbook/configuration/pdo_session_storage.html](http://symfony.com/doc/2.0/cookbook/configuration/pdo_session_storage.html)

我创建了与给定链接中完全相同的表。

但是，它不起作用。我收到一些“空白”错误（没有错误消息，但有“PDO 异常”和“错误异常”）。我承认我对配置 Symfony2 或任何信息知之甚少（这就是我使用说明书的原因）。我浪费了很多时间，在互联网上没有看到太多关于它的文档，更不用说互联网对这种情况非常沉默（将会话存储到 Symfony2 中的数据库表）。

我的 NetBeans 正在“大喊”最后一行：

```
 arguments: [@pdo, %session.storage.options%, %pdo.db_options%] 
```

“扫描下一个令牌时出现 ScannerException，我们发现此字符 @(64) 无法启动任何令牌”。

更新：嗯，现在我不确定它是否与配置有关。我可以看到 Symfony2 的说明书（使用...）示例实际上与 Symfony2 包中的文件结构不匹配。总之，没有这样的文件路径，但放上真正的文件路径后它仍然不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-11T17:58:34.080

Symfony 2.5 我和你有同样的问题。原来我的解决方案是在 php.ini 中禁用 session.auto_start。如果会话在 PDO 有机会控制它之前启动，则 PdoSessionStorage 将不会接管。起初我忽略了这一点，因为我修改了错误的（我有两个 php.ini 副本）。要检查这是否是您的问题，请运行以下命令：

```
echo ini_get('session.auto_start'); 
```

如果返回 '1' 或 'true'，请务必在 php.ini 中进行设置：

```
session.auto_start = 0 
```

因此，作为参考，这是我使用 Symfony 2.5 进行的设置：

**配置.yml**

```
framework:
    session:
        handler_id: session.handler.pdo

parameters:
    pdo.db_options:
        db_table:    session
        db_id_col:   session_id
        db_data_col: session_value
        db_time_col: session_time

services:
    session.handler.pdo:
        class:     Symfony\Component\HttpFoundation\Session\Storage\Handler\PdoSessionHandler
        arguments: ["@pdo", "%pdo.db_options%"]
    pdo:
        class: PDO
        arguments:
            dsn: "mysql:host=%database_host%;port=%database_port%;dbname=%database_name%"
            user: "%database_user%"
            password: "%database_password%"
        calls:
            - [setAttribute, [3, 2]] # \PDO::ATTR_ERRMODE, \PDO::ERRMODE_EXCEPTION 
```

# asp.net-mvc - 登录限制到期时如何进行重定向？

> ID：12373791
> 
> 赞同：0
> 
> 时间：2012-09-11T16:05:19.780
> 
> 标签：asp.net-mvc, jquery, session-timeout

在我的页面上，我对一些用户操作（在系统中发送消息、向文章添加评论等）使用了很多 Jquery-ajax。此功能仅允许已注册的登录用户使用。

例如：

```
[Authorize]
[HttpPost]
[AcceptVerbs(HttpVerbs.Post)]
public JsonResult AddArticleComment(Int64 idArticle, String articleComment)
{
  //process
}        
$(document).ready(function () {
$("#btnAddArticleComment").click(function () {
    showProgressBar();
    jQuery.ajax("/Articles/AddArticleComment",
                        { type: "POST",
                            data: { idArticle: $("#txtArticleId").val(), articleComment: $("#txtArticleComment").val() },
                            success: function (resultObj) {
                                hideProgressBar();
                                LoadArticles($("#txtArticleId").val());
                            },
                            error: function (xhr, status, index, anchor) {
                                hideProgressBar();
                                showInfoBox(false, "some error message");
                            },
                            async: false
                        });
        return false;
    });
}; 
```

在我的*web.config*中，我将登录超时设置为 30 分钟。当用户写了较长的评论并且登录限制到期时，应用程序不会重定向到登录（例如：）`http://localhost/Account/Logon?ReturnUrl....`。

在这种情况下如何进行重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:08:36.563

查看此博客文章：[http ://haacked.com/archive/2011/10/04/prevent-forms-authentication-login-page-redirect-when-you-donrsquot-want.aspx](http://haacked.com/archive/2011/10/04/prevent-forms-authentication-login-page-redirect-when-you-donrsquot-want.aspx)

它背后的想法是配置一个自定义模块，该模块将拦截 401 错误，而不是重定向到登录页面并以 200 状态代码结束，它只会将 401 状态代码传播给客户端。只有当它是一个 AJAX 请求时它才会这样做。这将允许您简单地订阅一个全局 AJAX 错误处理程序，并在状态代码为 401 时采取相应措施，这意味着用户未通过身份验证。

# oracle - 如何检查 Oracle 11 上的索引构建状态？

> ID：12373796
> 
> 赞同：9
> 
> 时间：2012-09-11T16:05:26.937
> 
> 标签：oracle, plsql, oracle11g, indexing, plsqldeveloper

我在创建 SQL 索引时犯了严重错误：

```
create index IDX_DATA_TABLE_CUSECO on DATA_TABLE (CUSTOMER_ID, SESSION_ID, CONTACT_ID)
  tablespace IDX_TABLESPACE LOCAL ; 
```

如您所见，我错过了关键字“ONLINE”来创建索引而不会阻塞具有 600m+ 记录的高使用率的 PRODUCTION 表。更正的 SQL 是：

```
create index IDX_DATA_TABLE_CUSECO on DATA_TABLE (CUSTOMER_ID, SESSION_ID, CONTACT_ID)
  tablespace IDX_TABLESPACE LOCAL ONLINE; 
```

我是在 PL/SQL Developer 下完成的。当我试图停止它时，程序停止响应并崩溃。

生产系统现在不能工作 9 个小时，我的老板想爆炸。:D

有没有机会查看 Oracle 11g 剩下多少秒/分钟/小时来处理这个索引创建？或者也许有机会看到 Oracle 是否仍在处理这个请求？（PL/SQL Developer 崩溃了）。

对于仇恨者：我知道我应该像这里提到的那样这样做：（[来源](http://searchoracle.techtarget.com/tip/Speed-up-Oracle-index-creation)）

```
CREATE INDEX cust_idx on customer(id) UNUSABLE LOCAL;
ALTER INDEX cust_idx REBUILD parallel 6 NOLOGGING ONLINE; 
```

* * *

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-11T16:20:42.503

您应该能够在`V$SESSION_LONGOPS`

```
SELECT sid, 
       serial#, 
       target, 
       target_desc, 
       sofar, 
       totalwork, 
       start_time, 
       time_remaining, 
       elapsed_seconds
  FROM v$session_longops
 WHERE time_remaining > 0 
```

当然，在生产系统中，我可能会在几小时前终止会话，而不是让 DDL 操作继续阻止用户访问应用程序。

# c# - 3 位货币代码到货币符号

> ID：12373800
> 
> 赞同：55
> 
> 时间：2012-09-11T16:05:48.547
> 
> 标签：c#, .net, sql-server-2008, currency

在 C# 中，是否可以从 3 个字符的货币代码（在本例中为“GBP”）中获取货币符号，例如“£”？

这在 SQL Server 或 C# 中是否可行？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2012-09-11T16:50:02.810

虽然有点蛮力而且不是特别优雅，但您可以这样做：

```
public bool TryGetCurrencySymbol(string ISOCurrencySymbol, out string symbol)
{
    symbol = CultureInfo
        .GetCultures(CultureTypes.AllCultures)
        .Where(c => !c.IsNeutralCulture)
        .Select(culture => {
            try{
                return new RegionInfo(culture.Name);
            }
            catch
            {
                return null;
            }
        })
        .Where(ri => ri!=null && ri.ISOCurrencySymbol == ISOCurrencySymbol)
        .Select(ri => ri.CurrencySymbol)
        .FirstOrDefault();
    return symbol != null;
} 
```

并按如下方式使用它：

```
string currSymbol;
if(TryGetCurrencySymbol("GBP",out currSymbol))
{
    Console.WriteLine("symbol is {0}", currSymbol);
} 
```

如果您预计会采用这种方法，那么最好预先构建一个缓存：

```
public static class CurrencyTools
{
    private static IDictionary<string,string> map;
    static CurrencyTools()
    {
        map = CultureInfo
            .GetCultures(CultureTypes.AllCultures)
            .Where(c => !c.IsNeutralCulture)
            .Select(culture => {
                try{
                    return new RegionInfo(culture.Name);
                }
                catch
                {
                    return null;
                }
            })
            .Where(ri => ri!=null)
            .GroupBy(ri => ri.ISOCurrencySymbol)
            .ToDictionary(x => x.Key, x => x.First().CurrencySymbol);
    }
    public static bool TryGetCurrencySymbol(
                          string ISOCurrencySymbol, 
                          out string symbol)
    {
        return map.TryGetValue(ISOCurrencySymbol,out symbol);
    }
} 
```

在撰写本文时，在我的机器等上，地图包含以下映射：

```
AED  د.إ.‏
AFN  ؋
ALL  Lekë
AMD  ֏
ANG  NAf.
AOA  Kz
ARS  $
AUD  $
AWG  Afl.
AZN  ₼
BAM  КМ
BBD  $
BDT  ৳
BGN  лв.
BHD  د.ب.‏
BIF  FBu
BMD  $
BND  $
BOB  Bs
BRL  R$
BSD  $
BTN  Nu.
BWP  P
BYN  Br
BZD  $
CAD  $
CDF  FC
CHF  CHF
CLP  $
CNY  ¥
COP  $
CRC  ₡
CUP  $
CVE  ​
CZK  Kč
DJF  Fdj
DKK  kr.
DOP  $
DZD  د.ج.‏
EGP  ج.م.‏
ERN  Nfk
ETB  Br
EUR  €
FJD  $
FKP  £
GBP  £
GEL  ₾
GHS  GH₵
GIP  £
GMD  D
GNF  FG
GTQ  Q
GYD  $
HKD  $
HNL  L
HRK  kn
HTG  G
HUF  Ft
IDR  Rp
ILS  ₪
INR  ₹
IQD  د.ع.‏
IRR  ريال
ISK  kr
JMD  $
JOD  د.ا.‏
JPY  ¥
KES  Ksh
KGS  сом
KHR  ៛
KMF  CF
KPW  ₩
KRW  ₩
KWD  د.ك.‏
KYD  $
KZT  ₸
LAK  ₭
LBP  ل.ل.‏
LKR  රු.
LRD  $
LYD  د.ل.‏
MAD  د.م.‏
MDL  L
MGA  Ar
MKD  ден
MMK  K
MNT  ₮
MOP  MOP$
MRU  MRU
MUR  Rs
MVR  ރ.
MWK  MK
MXN  $
MYR  RM
MZN  MTn
NAD  $
NGN  ₦
NIO  C$
NOK  kr
NPR  रु
NZD  $
OMR  ر.ع.‏
PAB  B/.
PEN  S/
PGK  K
PHP  ₱
PKR  Rs
PLN  zł
PYG  ₲
QAR  ر.ق.‏
RON  lei
RSD  дин.
RUB  ₽
RWF  RF
SAR  ر.س.‏
SBD  $
SCR  SR
SDG  ج.س.
SEK  kr
SGD  $
SHP  £
SLL  Le
SOS  S
SRD  $
SSP  £
STN  Db
SYP  ل.س.‏
SZL  E
THB  ฿
TJS  смн
TMT  m.
TND  د.ت.‏
TOP  T$
TRY  ₺
TTD  $
TWD  NT$
TZS  TSh
UAH  ₴
UGX  USh
USD  $
UYU  $
UZS  сўм
VES  Bs.S
VND  ₫
VUV  VT
WST  WS$
XAF  FCFA
XCD  EC$
XDR  XDR
XOF  CFA
XPF  FCFP
YER  ر.ي.‏
ZAR  R
ZMW  K 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-09-11T16:12:55.987

.NET 有`CultureInfo.NumberFormat.CurrencySymbol`

```
CultureInfo us = new CultureInfo("en-US");
CultureInfo gb = new CultureInfo("en-GB");
CultureInfo fr = new CultureInfo("fr-FR");

Console.Out.WriteLine(us.NumberFormat.CurrencySymbol); // $
Console.Out.WriteLine(gb.NumberFormat.CurrencySymbol); // £
Console.Out.WriteLine(fr.NumberFormat.CurrencySymbol); // € 
```

但这需要文化名称，而不是`"GBP"`. 据我所知，它不可能直接来自`"GBP"`等。

相同的信息也可通过`RegionInfo`以及货币代码获得：

```
RegionInfo us = new RegionInfo("en-US");
RegionInfo gb = new RegionInfo("en-GB");
RegionInfo fr = new RegionInfo("fr-FR");

Console.Out.WriteLine(us.CurrencySymbol); // $
Console.Out.WriteLine(gb.CurrencySymbol); // £
Console.Out.WriteLine(fr.CurrencySymbol); // €

Console.Out.WriteLine(us.ISOCurrencySymbol); // USD
Console.Out.WriteLine(gb.ISOCurrencySymbol); // GBP
Console.Out.WriteLine(fr.ISOCurrencySymbol); // EUR 
```

我想人们可以想象使用它来构建从 ISO 代码到符号的映射。

文化名称列表可[在此处](http://msdn.microsoft.com/en-us/goglobal/bb896001.aspx)获得。

**编辑：**这似乎有效：

```
public static class CurrencyCodeMapper
{
    private static readonly Dictionary<string, string> SymbolsByCode;

    public static string GetSymbol(string code) { return SymbolsByCode[code]; }

    static CurrencyCodeMapper()
    {
        SymbolsByCode = new Dictionary<string, string>();

        var regions = CultureInfo.GetCultures(CultureTypes.SpecificCultures)
                      .Select(x => new RegionInfo(x.LCID));

        foreach (var region in regions)
            if (!SymbolsByCode.ContainsKey(region.ISOCurrencySymbol))
                SymbolsByCode.Add(region.ISOCurrencySymbol, region.CurrencySymbol);
    }
} 
```

用法：

```
CurrencyCodeMapper.GetSymbol("USD") // $
CurrencyCodeMapper.GetSymbol("GBP") // £
CurrencyCodeMapper.GetSymbol("EUR") // € 
```

当然，请注意，这不会产生一个完整的列表。特别是，它不包括已被欧元取代的旧欧元区货币。我看不到任何解决方法，只能在需要时手动添加此类货币，例如`SymbolsByCode.Add("FRF", "₣");`法郎。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-11T16:11:17.207

RegionInfo 类有一个[CurrencySymbol 属性](http://msdn.microsoft.com/en-us/library/system.globalization.regioninfo.currencysymbol.aspx)，所以它在 C# 中是可行的。如果您想在 Sql Server 中执行此操作，您也许可以使用 C# 存储过程。

```
RegionInfo regionInfo = new RegionInfo("GB");
Console.WriteLine(regionInfo.CurrencySymbol); // £ 
```

（您需要使用[ISO 国家代码](http://www.iso.org/iso/country_codes/iso_3166_code_lists/country_names_and_code_elements.htm)）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-08-31T16:54:41.667

这不适用于 Windows Phone 应用程序，因为`CultureInfo.GetCultures`该平台上不可用（至少目前还没有）。因此，这是一个快速而肮脏的解决方案-在花费者的答案的帮助下完成，该答案包含当时的所有文化代码和货币。

```
public static class CurrencyHelper
{
    public static string GetCurrencySymbol(string code)
    {
        if (Currencies.ContainsKey(code))
        {
            return Currencies[code];
        }
        else
        {
            return code;
        }
    }

    public static Dictionary<string, string> Currencies = new Dictionary<string, string>() {
                                                    {"AED", "د.إ.‏"},
                                                    {"AFN", "؋ "},
                                                    {"ALL", "Lek"},
                                                    {"AMD", "դր."},
                                                    {"ARS", "$"},
                                                    {"AUD", "$"}, 
                                                    {"AZN", "man."}, 
                                                    {"BAM", "KM"}, 
                                                    {"BDT", "৳"}, 
                                                    {"BGN", "лв."}, 
                                                    {"BHD", "د.ب.‏ "},
                                                    {"BND", "$"}, 
                                                    {"BOB", "$b"}, 
                                                    {"BRL", "R$"}, 
                                                    {"BYR", "р."}, 
                                                    {"BZD", "BZ$"}, 
                                                    {"CAD", "$"}, 
                                                    {"CHF", "fr."}, 
                                                    {"CLP", "$"}, 
                                                    {"CNY", "¥"}, 
                                                    {"COP", "$"}, 
                                                    {"CRC", "₡"}, 
                                                    {"CSD", "Din."}, 
                                                    {"CZK", "Kč"}, 
                                                    {"DKK", "kr."}, 
                                                    {"DOP", "RD$"}, 
                                                    {"DZD", "DZD"}, 
                                                    {"EEK", "kr"}, 
                                                    {"EGP", "ج.م.‏ "},
                                                    {"ETB", "ETB"}, 
                                                    {"EUR", "€"}, 
                                                    {"GBP", "£"}, 
                                                    {"GEL", "Lari"}, 
                                                    {"GTQ", "Q"}, 
                                                    {"HKD", "HK$"}, 
                                                    {"HNL", "L."}, 
                                                    {"HRK", "kn"}, 
                                                    {"HUF", "Ft"}, 
                                                    {"IDR", "Rp"}, 
                                                    {"ILS", "₪"}, 
                                                    {"INR", "रु"}, 
                                                    {"IQD", "د.ع.‏ "},
                                                    {"IRR", "ريال "},
                                                    {"ISK", "kr."}, 
                                                    {"JMD", "J$"}, 
                                                    {"JOD", "د.ا.‏ "},
                                                    {"JPY", "¥"}, 
                                                    {"KES", "S"}, 
                                                    {"KGS", "сом"}, 
                                                    {"KHR", "៛"}, 
                                                    {"KRW", "₩"}, 
                                                    {"KWD", "د.ك.‏ "},
                                                    {"KZT", "Т"}, 
                                                    {"LAK", "₭"}, 
                                                    {"LBP", "ل.ل.‏ "},
                                                    {"LKR", "රු."}, 
                                                    {"LTL", "Lt"}, 
                                                    {"LVL", "Ls"}, 
                                                    {"LYD", "د.ل.‏ "},
                                                    {"MAD", "د.م.‏ "},
                                                    {"MKD", "ден."}, 
                                                    {"MNT", "₮"}, 
                                                    {"MOP", "MOP"}, 
                                                    {"MVR", "ރ."}, 
                                                    {"MXN", "$"}, 
                                                    {"MYR", "RM"}, 
                                                    {"NIO", "N"}, 
                                                    {"NOK", "kr"}, 
                                                    {"NPR", "रु"}, 
                                                    {"NZD", "$"}, 
                                                    {"OMR", "ر.ع.‏ "},
                                                    {"PAB", "B/."}, 
                                                    {"PEN", "S/."}, 
                                                    {"PHP", "PhP"}, 
                                                    {"PKR", "Rs"}, 
                                                    {"PLN", "zł"}, 
                                                    {"PYG", "Gs"}, 
                                                    {"QAR", "ر.ق.‏ "},
                                                    {"RON", "lei"}, 
                                                    {"RSD", "Din."}, 
                                                    {"RUB", "р."}, 
                                                    {"RWF", "RWF"}, 
                                                    {"SAR", "ر.س.‏ "},
                                                    {"SEK", "kr"}, 
                                                    {"SGD", "$"}, 
                                                    {"SYP", "ل.س.‏ "},
                                                    {"THB", "฿"}, 
                                                    {"TJS", "т.р."}, 
                                                    {"TMT", "m."}, 
                                                    {"TND", "د.ت.‏ "},
                                                    {"TRY", "TL"}, 
                                                    {"TTD", "TT$"}, 
                                                    {"TWD", "NT$"}, 
                                                    {"UAH", "₴"}, 
                                                    {"USD", "$"}, 
                                                    {"UYU", "$U"}, 
                                                    {"UZS", "so'm"}, 
                                                    {"VEF", "Bs. F."}, 
                                                    {"VND", "₫"}, 
                                                    {"XOF", "XOF"}, 
                                                    {"YER", "ر.ي.‏ "},
                                                    {"ZAR", "R"}, 
                                                    {"ZWL", "Z$"} };
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-15T11:22:30.930

试试这个代码。输入“USD”作为 CurrencyCode 和所有其他。

```
public string getCurrencySymbol(string CurrencyCode)    
{
        string symbol = string.Empty;
        CultureInfo[] cultures = CultureInfo.GetCultures(CultureTypes.SpecificCultures);
        IList Result = new ArrayList();
        foreach (CultureInfo ci in cultures)
        {
            RegionInfo ri = new RegionInfo(ci.LCID);
            if (ri.ISOCurrencySymbol == CurrencyCode)
            {
                symbol = ri.CurrencySymbol;
                return symbol;
            }
        }
        return symbol;

    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-08T13:42:02.737

在这个线程的帮助下，我做了一个短字符串扩展方法

```
public static string ToCurrencySymbol(this string ISOCurrency)
{            
    RegionInfo region = CultureInfo.GetCultures(CultureTypes.SpecificCultures).Select(x => new RegionInfo(x.LCID)).FirstOrDefault(p => p.ISOCurrencySymbol == ISOCurrency);
    return region?.ISOCurrencySymbol ?? ISOCurrency;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-17T17:52:37.293

这个答案将@spender 的代码稍作调整放在一个实用程序类中，该类尝试将三字母 ISO 货币代码转换为其当前流通的符号。为了提高效率，此类使用所有先前请求的内部缓存，@spender 也建议。

```
public static class CurrencySymbolMapper {
    /// <summary>An internal cache of previously looked up currencies.</summary>
    private static Dictionary<string, string> _currencySymbolsCache =
        new Dictionary<string, string> (StringComparer.CurrentCultureIgnoreCase);

    public static string TryGetCurrencySymbol(string threeLetterISOAlphabeticCode) {
        // TODO: Enhance to get rid of the silent exception that gets thrown when constructing a new RegionInfo(CultureInfo.LCID) temporary object

        if (threeLetterISOAlphabeticCode.Length != 3) return string.Empty;
        if (_currencySymbolsCache.ContainsKey(threeLetterISOAlphabeticCode))
            return _currencySymbolsCache[threeLetterISOAlphabeticCode];

        string currencySymbolSearchResult = string.Empty;
        try {
            currencySymbolSearchResult =
                CultureInfo.GetCultures(CultureTypes.AllCultures)
                            .Where(c => !c.IsNeutralCulture)
                            .Select(culture => {
                                try { return new RegionInfo(culture.LCID); }
                                catch { return null; } // Ignore this error, but enhance future implementation to get ride of this silent exception
                            })
                            .Where(ri => ri != null && string.Equals(ri.ISOCurrencySymbol, threeLetterISOAlphabeticCode, StringComparison.OrdinalIgnoreCase))
                            .Select(ri => ri.CurrencySymbol)
                            .FirstOrDefault();
        }
        catch (Exception e) {
            // TODO: Handle error
        }

        if (currencySymbolSearchResult == null) currencySymbolSearchResult = string.Empty;

        // Saves both valid and invalid search results, just in case users hammer this method with 
        // the same invalid request many times
        _currencySymbolsCache.Add(threeLetterISOAlphabeticCode, currencySymbolSearchResult);
        return currencySymbolSearchResult;
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-07T17:02:04.973

```
public static string GetCurrencySymbol(string code)  
{  
 System.Globalization.RegionInfo regionInfo = (from culture in System.Globalization.CultureInfo.GetCultures(System.Globalization.CultureTypes.InstalledWin32Cultures)  
              where culture.Name.Length > 0 && !culture.IsNeutralCulture  
              let region = new System.Globalization.RegionInfo(culture.LCID)  
              where String.Equals(region.ISOCurrencySymbol, code, StringComparison.InvariantCultureIgnoreCase)  
              select region).First();  

 return regionInfo.CurrencySymbol;  
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-05T11:37:37.987

这就是我获得 DECLARE @CultureCode varchar(10) = 'en-us' 的方式

SELECT SUBSTRING(FORMAT(CONVERT(money,0), 'C', @CultureCode ),1,1) CurrencySymbol

# facebook - 使用coldfusion（facebook-cf-sdk），每当用户取消授权时，我想在我的数据库中标记用户的记录

> ID：12373804
> 
> 赞同：0
> 
> 时间：2012-09-11T16:06:10.617
> 
> 标签：facebook, coldfusion

我发现这个例子使用 php，[Facebook 用户取消了应用程序的授权，](https://stackoverflow.com/questions/4859820/facebook-user-deauthorizes-the-app)但不幸的是，我在编码方面有点烂，不知道如何转换为冷融合。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T14:20:52.827

好的，所以在一个主要的 Derp 时刻之后，我意识到[facebook-cf-sdk 框架](http://facebooksdk.riaforge.org/)已经处理了 FB 签名的请求。我只需要通过执行以下操作来获取用户 ID：

```
if (APP_ID is "" or SECRET_KEY is "") {
// App not configured
facebookGraphAPI = new FacebookGraphAPI();
} else {
// Create facebookApp instance
facebookApp = new FacebookApp(appId=YOUR_APP_ID, secretKey=YOUR_SECRET_KEY);

// See if there is a user from a cookie or session
userId = facebookApp.getUserId(); 
```

感谢 Leigh 踢屁股 ;-)

# database - 是否应该使用 GAE Bloblstore 代替传统数据库

> ID：12373817
> 
> 赞同：0
> 
> 时间：2012-09-11T16:07:18.323
> 
> 标签：database, google-app-engine, blobstore

我正在编写一个需要数据库的 Web 应用程序，该数据库将具有用户、朋友等实体。由于**Cloud SQL**服务不是免费的，所以我正在寻找替代方案。**Amazon RDS**是一种选择，因为他们有一个免费套餐，可以在短期内满足我的需求，但在我开始使用它之前，我想了解更多关于 blobstore 的信息。

使用 blobstore 存储此类信息是否理想？有这样的问题：

1.  **读/写延迟**与传统数据库相比如何？
2.  如果我从 blobstore 开始，然后我想**转移到关系数据库**，我可能面临哪些问题？
3.  最重要的是，如果在我的场景**中使用 blobstore 是理想的。**

查看谷歌开发网站上的文档后，我发现 blobstore 用于存储大/中型文件，如图像和视频。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T16:29:16.890

您不能也不应该尝试将 blobstore 用于结构化数据。这就是[数据存储](https://developers.google.com/appengine/docs/python/datastore/)的用途。Blobstore 用于存储文件等非结构化数据。

# r - 建立网络的相关矩阵

> ID：12373821
> 
> 赞同：6
> 
> 时间：2012-09-11T16:07:39.513
> 
> 标签：r

我已经将 R 中的 MixOmics 包用于两个矩阵（典型相关分析），并且我有一个结果相关矩阵。我想根据获得的结果建立一个相关网络。我之前想过使用基因集相关性分析包，但我不知道如何安装它，并且互联网上没有资源可以在 R 中安装它（http://www.biostat.wisc.edu/~kendzior/GSCA /)。

您还可以建议我可以使用哪些其他软件包来构建以相关矩阵作为输入的网络吗？我想到了 Rgraphviz，但不知道是否可能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T16:41:39.743

[主要从我之前在https://stackoverflow.com/a/7600901/567015](https://stackoverflow.com/a/7600901/567015)的答案中复制此答案

该`qgraph`软件包主要用于将相关矩阵可视化为网络。这会将变量绘制为节点，将相关性绘制为连接节点的边。绿色边缘表示正相关，红色边缘表示负相关。边缘越宽越饱和，绝对相关性越强。

例如（这是帮助页面的第一个示例），以下代码将绘制 240 个变量数据集的相关矩阵。

```
library("qgraph")
data(big5)
data(big5groups)
qgraph(cor(big5),minimum=0.25,cut=0.4,vsize=2,groups=big5groups,legend=TRUE,borders=FALSE)
title("Big 5 correlations",line=-2,cex.main=2) 
```

![在此处输入图像描述](../Images/660ee5e43a969afbbbef091520f4d65e.png)

您还可以将强相关节点聚集在一起（使用 Fruchterman-Reingold），这样可以非常清晰地显示相关矩阵的结构实际上是什么样的：

![在此处输入图像描述](../Images/70b1d1c6cf302fcb96786082509d7aab.png)

有关详细介绍，请查看[http://www.jstatsoft.org/v48/i04/paper](http://www.jstatsoft.org/v48/i04/paper)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T18:29:02.317

您可能还想查看 CRAN 上的[`network`](http://cran.r-project.org/web/packages/network/)和[`sna`](http://cran.r-project.org/web/packages/sna/)包。两者都包括将矩阵转换为网络数据对象的工具。

# c# - 从数据库中检索压缩文件

> ID：12373822
> 
> 赞同：1
> 
> 时间：2012-09-11T16:07:40.943
> 
> 标签：c#, sql-server-2008, blob, compression

我有一个 SQL Server 2008-R2 数据库，其中有一个存储不同类型文件（Word Docs、PDF、TIF 等）的表，我可以使用以下方法从数据库中成功检索这些文件：

private void GetFilesFromDatabase() { try { const string connStr = @"Data Source=localhost\SQLInstance;Initial Catalog=MyData;Integrated Security=True;"; //初始化SQL Server连接。SqlConnection CN = new SqlConnection(connStr);

```
 //Initialize SQL adapter.
            SqlDataAdapter ADAP = new SqlDataAdapter("Select ole_id, ole_object From OLE Where ole_id = 21601", CN);

            //Initialize Dataset.
            DataSet DS = new DataSet();

            //Fill dataset with FilesStore table.
            ADAP.Fill(DS, "FilesStore");

            //Get File data from dataset row.
            byte[] FileData = (byte[])DS.Tables["FilesStore"].Rows[0]["ole_object"];

            string FileName = @"C:\Temp\Text.doc";
            //Write file data to selected file.
            using (FileStream fs = new FileStream(FileName, FileMode.Create))
            {
                fs.Write(FileData, 0, FileData.Length);
                fs.Close();
            }

        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString());
        }
    } 
```

根据该特定行中包含的其他信息，我正在检索的这个文件是一个 Word Doc 文件。当我在将文件检索到磁盘后尝试打开文件时，所有数据似乎都是乱码并且无法读取。现在我相信这些文件在保存到数据库之前已被压缩，但我不知道如何解压缩它们以便可以查看它们，关于如何实现这一点的任何想法？我的最终目标是将这些图像移动到另一个数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:15:59.080

您保存文​​件的代码看起来不错。假设您的原始数据是 .DOC 文件，并且在保存您的运气后得到了错误的文件。您可能想在二进制编辑器（即 Visual Studio 的编辑器）中查看文件的内容，以确认该文件不是明显不同的东西（文本/图像......）。

您需要询问文件如何存储在数据库中。无法远程回答这个问题，因为它可能被压缩、加密、分割成块，甚至被简单地破坏。

# mysql - SQL 请求 LEFT JOIN

> ID：12373828
> 
> 赞同：0
> 
> 时间：2012-09-11T16:08:07.137
> 
> 标签：mysql, sql, request, left-join

假设我有这些表：我的 sql 请求应该是什么才能获得预期的结果？

表用户组：

```
group_id          |   user_id       |   is_active
1                          2               1
1                          3               1
2                          2               1
4                          2               1 
```

表组：

```
id |     name
1       group1
2       group2
3       group3
4       group4
5       group5
6       group5 
```

预期结果

```
group_id       |      name      | user_id    |   is_active
 1                   group1         2               1
 2                   group2         2               1
 3                   group3         2               0
 4                   group4         2               1
 5                   group5         2               0
 6                   group6         2               0 
```

我试过

```
SELECT g.id, g.name, ug.user_id, ug.is_active
FROM group g
LEFT OUTER JOIN user_group uc ON ug.group_id = g.id
WHERE ug.user_id =2 
```

但我只有用户 2 所在的组（所以 group1、group2 和 group4）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T17:00:05.327

试试这个：

```
SELECT  id ,
        name ,
        COALESCE(user_ID, 2) user_id ,
        COALESCE(is_active, 0) is_active
FROM    tableGroup
        LEFT JOIN user_group ON id = group_id
                                AND user_Id = 2 
```

[你可以在这里](http://sqlfiddle.com/#!2/94eb8/8/0)摆弄这个

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:44:52.143

```
SELECT g.id, g.name, ug.user_id, ug.is_active 
FROM group g 
LEFT OUTER JOIN user_group uc ON ug.group_id = g.id AND ug.user_id =2 
```

当 where 子句中有条件时，将左连接变为内连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T16:11:00.013

```
SELECT table_group.*, user_group.user_id, IFNULL(user_group.is_active, 0)
FROM table_group
LEFT JOIN user_group ON table_group.id = user_group.group_id 
```

# python - django auth 未登录注册

> ID：12373831
> 
> 赞同：0
> 
> 时间：2012-09-11T16:08:28.633
> 
> 标签：python, django, authentication, redirect, login

在我非常基本的 django auth 登录系统中苦苦挣扎。当一个新用户注册时，他们首先被重定向到`/user/user_id`我想要的（用户也被很好地创建），但然后他们被重定向到`/login?next=/user/user_id/`@login_decorator 在`user`视图上完成的，（如果我问题停止了删除装饰器）。（nb。调试工具栏正在分解重定向序列供我查看）。但是，如果我随后手动包括下面的注册视图。我不明白为什么它在注册后没有立即登录。登录方法似乎都在那里：

```
def register(request):
    if request.method == 'POST':
        form = UserCreationForm(request.POST)
        if form.is_valid():
            new_user = form.save()
            new_user = authenticate(username = request.POST['username'],
                                    password = request.POST['password1'])
            login(request, new_user)
            context = RequestContext(request)    
            context['user_id'] = new_user.id`
            url = '/user/%s/' % new_user.id
            return HttpResponseRedirect(url)
    else:
        form = UserCreationForm()
    return render_to_response("registration/register.html", {'form': form},
                              context_instance=RequestContext(request)) 
```

你能帮我吗？谢谢。

# python - heapq 模块 python

> ID：12373837
> 
> 赞同：6
> 
> 时间：2012-09-11T16:08:53.070
> 
> 标签：python, list, priority-queue

我正在使用该`heapq`模块来确定列表中的最小项目。

我有下面的代码，但`heapq.heapify()`返回值为无。

如何在新列表中获得结果？

```
>>> a=heapq.heapify(lista)
>>> a
>>> lista=[1,2,3,4,5]
>>> a=heapq.heapify(lista)
>>> print(a)
None 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-11T16:09:53.587

`heapq.heapify`不返回任何内容，它将列表堆积到位；这样做效率更高：

```
>>> import heapq
>>> lista = [44, 42, 3, 89, 10]
>>> heapq.heapify(lista)
>>> lista
[3, 10, 44, 89, 42] 
```

如果您需要一个*新*列表，请先创建一个副本：

```
>>> lista = [44, 42, 3, 89, 10]
>>> newlist = lista[:]
>>> heapq.heapify(newlist)
>>> lista
[44, 42, 3, 89, 10]
>>> newlist
[3, 10, 44, 89, 42] 
```

当然，这在某种程度上违背了目的，因为复制列表也有（线性）成本。

如果您只需要列表中的最小项目，则该[`min()`函数](http://docs.python.org/library/functions.html#min)在仅定位一个最小元素时将同样快（同时扫描*输入*`heapify()`列表`min()`一次，因此 O(n) 成本）：

```
>>> min(lista)
3 
```

如果您需要多个最小值，请务必使用 a `heapq`，尤其是稍后添加项目时。如果您无法更改原始列表，需要几个最小的项目，请参阅[在 python 中寻找倒置堆以](https://stackoverflow.com/questions/12356564/looking-for-an-inverted-heap-in-python/12356586#12356586)获得有效实现，该实现从*只有*固定数量的最小值`nsmallest`的输入堆创建新堆。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-27T02:58:37.940

你必须使用 heapq.nsmallest(k,arr) 函数。//k 这里是 1，因为你想要一个最小值。

```
>>> a=heapq.heapify(lista)
>>> a
>>> lista=[1,2,3,4,5]
>>> a=heapq.nsmallest(1,lista)
>>> print(a)
1 
```*

# jquery - 检测引导轮播是前进还是后退

> ID：12373838
> 
> 赞同：4
> 
> 时间：2012-09-11T16:08:56.323
> 
> 标签：jquery, twitter-bootstrap, carousel

您如何判断 twitter 引导轮播是前进还是后退？我希望能够做类似的事情：

```
$('#myCarouse').on('slide', function(e) {
  if (fwd?) {do something}
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T18:06:21.590

Carousel 插件附加到**幻灯片**事件对象的唯一特殊信息是`relatedTarget`包含将要切换到的元素的属性。这可用于手动计算您将在轮播中移动的位置。

类似于以下内容：

```
$('#myCarousel').on('slide', function (e) {
  var $active = $(this).find('.item.active')
    , children = $active.parent().children()
    , activePos = children.index($active)
    , nextPos = children.index(e.relatedTarget)
    , diff = nextPos - activePos;

    if (diff === 1 || diff < -1 || diff === 0) {
        console.log('next');
    } else {
        console.log('prev');
    }
});​ 
```

那`diff === 0`是为了处理我在最后一张幻灯片上看到的奇怪行为并移至第一张幻灯片。出于某种原因，`activePos`结果`nextPos`是平等的。我无法理解它；它*只是*。

这是一个演示：

## [JSFiddle](http://jsfiddle.net/mmfansler/yaapK/)

# python - 如何从熊猫数据框中的列中减去最小值

> ID：12373840
> 
> 赞同：0
> 
> 时间：2012-09-11T16:08:58.950
> 
> 标签：python, pandas

我想找到自第一次观察到事件以来经过的时间。为此，我将每个观察结果保存在 CSV 文件中。每个事件都由唯一的哈希标识。

现在我正在做以下事情：

```
from pandas import *
from bz2 import BZ2File
events = DataFrame.from_csv(BZ2File('events.csv.bz2', 'r'), sep='\t', header=0, index_col=None)
m = events.groupby('hash')['timestamp'].min() 
```

此时我有一个由哈希和第一次观察的时间戳索引的系列。我将如何使用它来获取事件 DataFrame 中每一行的时间偏移量（简单的时间戳 - 分钟（时间戳））？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T17:09:03.083

让我在这里设置一个玩具示例：

```
In [38]: rng = pd.date_range('2012-8-1', freq='T', periods=100)
In [39]: hashes = np.random.randint(0, 10, len(rng))
In [40]: obs = np.arange(len(rng))
In [41]: df = DataFrame({'hash' : hashes, 'timestamp' : rng.asobject},
   ....:                index=obs) 
```

现在获取每个哈希的时间差：

```
In [42]: grouped = df.set_index('hash', append=True).groupby(level='hash')

In [44]: grouped.transform(lambda x: x-x.min())
Out[44]:
        timestamp
   hash
0  3      0:00:00
1  5      0:00:00
2  1      0:00:00
3  8      0:00:00
4  6      0:00:00
5  8      0:02:00
6  1      0:04:00
7  7      0:00:00
8  3      0:08:00
9  5      0:08:00
10 8      0:07:00
11 1      0:09:00
12 2      0:00:00
...
...
...
94 2      1:22:00
95 6      1:31:00
96 1      1:34:00
97 0      1:21:00
98 8      1:35:00
99 0      1:23:00 
```

# mongodb - 如何在 MongoVue 中使用 distinct？

> ID：12373842
> 
> 赞同：3
> 
> 时间：2012-09-11T16:09:00.723
> 
> 标签：mongodb

我需要使用 MongoVUE 在 MongoDB 中找出不同的值（例如：CreationDate 或 SourceSystem）。仅供参考，我只能使用相同的试用版。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T19:31:14.490

我认为你不能使用 MongoVUE 做到这一点。您可以通过运行如下命令的 MongoDB shell 来执行此操作：

```
db.[Collection Name].distinct({Property Name})
ex: db.students.distinct('age')
db.students.distinct('age').length; // gives you the record count 
```

我通常发现 SQL 到 Mongo 映射图表页面在这些情况下很有用（[http://www.mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart](http://www.mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:31:05.280

快速浏览一下，我也看不出你是怎么做到的，因为“查找”功能会强制你使用：

```
db.[collectionName].find({...}) 
```

所以不允许你这样做：

```
db.[collectionName].distinct({...}) 
```

我建议使用 Mongo 的普通命令行可执行文件而不是 MongoVUE，然后您可以使用 10Gen 文档中的命令： [http ://www.mongodb.org/display/DOCS/Aggregation#Aggregation-Distinct](http://www.mongodb.org/display/DOCS/Aggregation#Aggregation-Distinct)

# php - ffmpeg 终止而没有任何输出

> ID：12373844
> 
> 赞同：0
> 
> 时间：2012-09-11T16:09:14.710
> 
> 标签：php, video, ffmpeg

我正在使用 ffmpeg 将视频文件转换为 mp4。这是我的代码

```
 echo "converting ".basename($src)." --- to --- ".basename($dest).".mp4...<br />";
$command = FFMPEG.' -i ' . $src . ' -sameq -strict -2 -vcodec libx264 -ar 22050 -y ' . $dest.'.mp4 2>&1';   //
echo $command.'<br>';

exec($command,$output,$status);
echo '<pre>',join('<br>',$output),'</pre><br>';

if($status == 0) {              // Success
    echo 'Successfully converted to MP4!<br />';
} else {
    echo $status."<br>failed<br>";
} 
```

该代码在我的本地主机（Windows 7 + wamp）上运行良好。但在实时服务器上，只有 $command 被回显......并且脚本被终止。生成了输出文件，但它只有 4.5MB（应该是 17MB 左右）并且不完整......有时我得到以下输出......

```
 ffmpeg version 0.11.1 Copyright (c) 2000-2012 the FFmpeg developers  built on Sep 10 2012 00:38:24 with gcc 4.1.2 20080704 (Red Hat 4.1.2-52)  configuration: --prefix=/home/one01qsc/local --extra-cflags='-L/home/one01qsc/local/lib/ -I /home/one01qsc/local/include/' --extra-ldflags='-L/home/one01qsc/local/lib/ -Wl,-rpath,/home/one01qsc/local/lib/' --enable-libmp3lame --enable-libvorbis --enable-shared --disable-yasm --enable-libtheora --enable-libx264 --enable-gpl
  libavutil      51\. 54.100 / 51\. 54.100
  libavcodec     54\. 23.100 / 54\. 23.100
  libavformat    54\.  6.100 / 54\.  6.100
  libavdevice    54\.  0.100 / 54\.  0.100
  libavfilter     2\. 77.100 /  2\. 77.100
  libswscale      2\.  1.100 /  2\.  1.100
  libswresample   0\. 15.100 /  0\. 15.100
  libpostproc    52\.  0.100 / 52\.  0.100
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from '/home/one01qsc/public_html/temp/pending/1455-testing-mobidick.mov':
  Metadata:
    major_brand     : qt
    minor_version   : 537199360
    compatible_brands: qt
    creation_time   : 2012-09-08 16:00:41
  Duration: 00:00:23.13, start: 0.490000, bitrate: 6028 kb/s
    Stream #0:0: Video: h264 (High) (avc1 / 0x31637661), yuv420p, 1920x1080, 5331 kb/s, 29.97 fps, 29.97 tbr, 60k tbn, 59.94 tbc
    Metadata:
      creation_time   : 2012-09-08 16:00:41
      handler_name    : Apple Alias Data Handler
    Stream #0:1: Audio: aac (mp4a / 0x6134706D), 44100 Hz, stereo, s16, 192 kb/s
    Metadata:
      creation_time   : 2012-09-08 16:00:41
      handler_name    : Apple Alias Data Handler
[buffer @ 0x2405ce0] w:1920 h:1080 pixfmt:yuv420p tb:1/60000 sar:0/1 sws_param:flags=2
[buffersink @ 0x2429ec0] No opaque field provided
[aformat @ 0x23fa560] auto-inserting filter 'auto-inserted resampler 0' between the filter 'src' and the filter 'aformat'
[aresample @ 0x2402e60] chl:stereo fmt:s16 r:44100Hz -> chl:stereo fmt:flt r:22050Hz
[libx264 @ 0x24288e0] using cpu capabilities: none!
[libx264 @ 0x24288e0] profile High, level 4.0
[libx264 @ 0x24288e0] 264 - core 128 - H.264/MPEG-4 AVC codec - Copyleft 2003-2012 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=24 lookahead_threads=4 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to '/home/one01qsc/public_html/temp/1455-testing-mobidick.mp4':
  Metadata:
    major_brand     : qt
    minor_version   : 537199360
    compatible_brands: qt
    creation_time   : 2012-09-08 16:00:41
    encoder         : Lavf54.6.100
    Stream #0:0: Video: h264 (![0][0][0] / 0x0021), yuv420p, 1920x1080, q=-1--1, 30k tbn, 29.97 tbc
    Metadata:
      creation_time   : 2012-09-08 16:00:41
      handler_name    : Apple Alias Data Handler
    Stream #0:1: Audio: aac (@[0][0][0] / 0x0040), 22050 Hz, stereo, flt, 128 kb/s
    Metadata:
      creation_time   : 2012-09-08 16:00:41
      handler_name    : Apple Alias Data Handler
Stream mapping:
  Stream #0:0 -> #0:0 (h264 -> libx264)
  Stream #0:1 -> #0:1 (aac -> aac)
Press [q] to stop, [?] for help
frame=   18 fps=0.0 q=0.0 size=       0kB time=00:00:00.00 bitrate=   0.0kbits/s 
```

在这种情况下，为 $status 打印的值是 137。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:38:23.740

137 表示它收到了信号 9。因此，您必须在实时服务器上安装一个程序来检查单个进程可以消耗多少内存/CPU。如果超过该限制，它将被终止，这就是您的进程正在发生的事情。

# r - R中应用的边距向量

> ID：12373847
> 
> 赞同：0
> 
> 时间：2012-09-11T16:09:21.517
> 
> 标签：r, function, apply

我对应用中的边距向量感到困惑。假设我们在 R 中有标准数据集 Iris3，即 50x4x3。因此，对 3 个物种的 50 个标本进行了 4 次观察。为什么应用 c(2,3) 的边距给我按物种划分的每个变量的平均值。我只是不明白指定边距变量的逻辑。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T16:20:53.083

边距向量指定您想要`apply`在其他自由维度上保持固定的维度。`c(2,3)`因此，为其他两个维度（测量类型和物种）的每个组合指定要在第一个维度（每个维度 50 个观察值）上应用函数的状态边际。

```
> dim(iris3)
[1] 50  4  3
> apply(iris3,c(2,3),mean)
         Setosa Versicolor Virginica
Sepal L.  5.006      5.936     6.588
Sepal W.  3.428      2.770     2.974
Petal L.  1.462      4.260     5.552
Petal W.  0.246      1.326     2.026 
```

# excel - Excel：将行号存储在变量中

> ID：12373848
> 
> 赞同：2
> 
> 时间：2012-09-11T16:09:21.370
> 
> 标签：excel, vba

我有一个有 2 列的电子表格，第一列是唯一标识符，第二列是由“|”划定的列表 分配给该案件的人员的性格。我正在尝试编写一个宏，它使用文本到列将第二列分成多列，然后将它们全部复制到原始列的底部。我正在处理大约 46,000 行，我猜结果将有大约 70,000 行。一个例子如下：

**原始数据**

```
ColumnA ColumnB  
123     Adam | Jill | Bob
456     Brent | Bob | Betsy | Sam
789     Matt | Adam | Jill 
```

**所需数据**

```
ColumnA ColumnB 
123     Adam
456     Brent
789     Matt
123     Jill
456     Bob
789     Adam
123     Bob
456     Betsy
789     Jill
456     Sam 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:23:32.607

我认为这应该做你想要的：

```
Sub test()
    Dim inputRng As Range
    Set inputRng = ThisWorkbook.Sheets(1).Range("A1")

    Dim outputRng As Range
    Set outputRng = ThisWorkbook.Sheets(1).Range("D1")

    While inputRng.Value <> ""
        Dim names As Variant
        names = Split(inputRng.Offset(, 1).Value, "|")

        For Each nme In names
            outputRng.Value = inputRng.Value
            outputRng.Offset(, 1).Value = Trim(nme)
            Set outputRng = outputRng.Offset(1)
        Next

        Set inputRng = inputRng.Offset(1)
    Wend
End Sub 
```

将 inputRng 和 outputRng 调整到您想要的位置

代码所做的只是在 VBA 中拆分字符串值并遍历该列表，然后向下移动到下一行。它继续运行，直到找到一个空的 (Value == "") 单元格，然后停止。

# ios - 异步加载 UIViews

> ID：12373850
> 
> 赞同：2
> 
> 时间：2012-09-11T16:09:28.557
> 
> 标签：ios, multithreading, uiview, asynchronous, nsoperationqueue

我正在尝试异步加载视图。问题是要加载的视图的框架取决于异步加载的数据。换句话说，有一些很长的计算决定了在哪里实际显示 UIView。

我知道尝试在线程中实际显示 UIView 时会出现问题，并且您应该始终将它们加载回主线程中，所以这是我一直在尝试的代码：

```
asyncQueue = [[NSOperationQueue alloc] init];
[asyncQueue addOperationWithBlock:^{
    // Do work to load the UIViews and figure out where they should be
    UIButton *test = [[UIButton alloc] initWithFrame:[self doWorkToGetFrame]];

    [[NSOperationQueue mainQueue] addOperationWithBlock:^{
            [self addSubview:test];
        }
    }];
}]; 
```

这一切都驻留在 UIView 容器中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:48:09.473

尝试这样的事情：

```
UIButton *test = [[UIButton alloc] initWithFrame:CGRectZero];
test.hidden = YES;
test.alpha = 0.0f;
[self addSubview:test];

dispatch_queue_t downloadQueue = dispatch_queue_create("myDownloadQueue",NULL);
dispatch_async(downloadQueue, ^
{
  // do work to load UIViews and calculate frame
  CGRect frameButton = ...;

  dispatch_async(dispatch_get_main_queue(), ^
  {
    test.hidden = NO; 
    [UIView animateWithDuration:0.4f animations:^
    {
     test.frame = frameButton;
     test.alpha = 1.0f;
    } 
    completion:^(BOOL finished){}];

  });
});

dispatch_release(downloadQueue); 
```

这会将您的按钮添加到主线程中，但最初使其不可见。完成背景工作后，您将使其可见并使用动画设置框架。

# sql - 在 SQL 查询中从一个表中删除重复数据并合并数据

> ID：12373851
> 
> 赞同：2
> 
> 时间：2012-09-11T16:09:29.903
> 
> 标签：sql, sql-server, database

我想创建下表（表 1）：

```
CHANNEL    START    STOP    SIGNAL    NOISE
-------------------------------------------
chan1      0        1       A         B
chan2      10       20      C         D
... 
```

来自下表（表 2）：

```
CHANNEL    START    STOP    TYPE      VALUE
-------------------------------------------
chan1      0        1       signal    A
chan1      0        1       noise     B
chan2      10       20      signal    C
chan2      10       20      noise     D
... 
```

我正在尝试创建一个选择查询以从表 2 中获取相关信息并从中创建表 1。然后我会把它变成一个视图。

在这一点上，我基本上迷路了。我尝试执行以下操作：

```
select distinct 
    table2.CHANNEL as CHANNEL_ID
    , table2.START as START_FREQ
    , table2.STOP_FREQ as STOP_FREQ
    , SIGNAL = CASE
      WHEN table2.TYPE = 'signal' THEN table2.VALUE
      END
    , NOISE_OFFSET = CASE
      WHEN table2.TYPE = 'noise' THEN table2.VALUE
      END

from 
    table2 
```

这给出了有趣的结果，但这显然不是我想要的。我知道这是错误的查询，我可能应该使用联接来执行此操作，但是当我走那条路线时，查询将不会执行。我在这里放屁，非常感谢您的帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:12:32.667

你正在寻找这个：

```
SELECT
      A.CHANNEL AS CHANNEL_ID,
      A.START AS START,
      A.STOP AS STOP,
      A.VALUE AS SIGNAL,
      B.VALUE AS NOISE
FROM
      table2 as A
      JOIN table2 as B
      ON 
          A.CHANNEL = B.CHANNEL AND 
          A.START = B.START AND 
          A.STOP = B.STOP AND
          A.TYPE = 'signal' AND
          B.TYPE = 'noise' 
```

# php - PHP清除需要文件之间的变量？

> ID：12373852
> 
> 赞同：1
> 
> 时间：2012-09-11T16:09:29.840
> 
> 标签：php

我的 php 代码中需要一个文件。这要求在代码中存在两次。

```
require 'test.php';

echo $result;

require 'test.php'; 
```

有没有办法在完全相同的文件上运行第二个要求之前清除第一个要求设置的所有变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:13:13.007

如果您在要求的开头声明所有变量，例如：

```
$var = false;
$var2 = 0;
$var3 = '';
// etc... 
```

除了再次要求文件之外，您无需做任何事情 - 这些声明将自动将变量重置为初始状态。

话虽如此，您正在寻找一种不同的方法。根据您需要如何使用它，将该功能封装到一个函数或一个类中。基本上，如果您有一些代码在整个代码库中重复，您应该对其进行模块化，并且绝对不会使用仅用于该中间功能所需的变量来污染全局范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:13:27.470

`require`如果您不使用全局变量，则可以将其包装在一个函数中。在这种情况下，您创建的所有变量都将被限制在函数范围内。

```
function includeFile() {
    require 'test.php';
    echo $result;
}

includeFile();

includeFile(); 
```

但是按照评论中的建议创建一个类会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T16:15:04.847

你可以做两件事。 `unset()`将删除所有这些变量。这回答了你的问题。

您应该做的是研究 OOP 和类。创建一个类，然后创建该类的一个实例。然后，您可以创建一个新类并拥有完全不同的值和数据，最终不再需`unset()`要这样做`require`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T16:17:49.480

**我没有测试这段代码！**

要点是在包含之前获取已定义变量的列表，包含文件，在包含后获取已定义变量的列表，计算差异，根据该差异取消设置全局变量，包含文件。

[`get_defined_vars`](http://php.net/manual/en/function.get-defined-vars.php)请参阅和上的手册条目[`unset`](http://php.net/manual/en/function.unset.php)。

```
<?php

$old_vars = get_defined_vars();

require 'test.php';

$new_vars = get_defined_vars();

echo $result;

$diff_vars = array_diff_key($old_vars, $new_vars);
while ($var = key($diff_vars)) {
    unset($GLOBALS[$var]);
    next($diff_vars);
}
unset($old_vars, $new_vars, $diff_vars);

require 'test.php'; 
```

说得通？

# actionscript-3 - 剪辑留在屏幕上，而不是在时间轴上

> ID：12373854
> 
> 赞同：-1
> 
> 时间：2012-09-11T16:09:43.830
> 
> 标签：actionscript-3, flash, tween

我有一个特殊的问题：我有一个有 2 帧的 fla，在第 1 帧上有一个实例名称为“my_clip”的剪辑，在第 2 帧没有剪辑。如果我通过代码（如补间）“my_clip”移动，当我去到第 2 帧，剪辑仍在屏幕上，而第 2 帧在我的 fla 中完全是空的。

flash 在这个级别上是如何工作的？一旦剪辑被代码移动，他是否会停止将剪辑与 fla“同步”？如何在第 2 帧检查场景应该是空的？

（我使用的是 flash cs 5.5 和播放器 11）

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-12T10:33:19.477

@LondonDrugs_MediaServices：我无法发布我的代码和 fla，因为与问题无关的代码太多。

但是当我试图制作一个小 fla 来重现我的问题并将其展示给你时，我发现问题不是我认为的问题：我实际上是因为每次我开始拖动我的剪辑时我都在做一个setChildIndex 把它放在上面。正是 setChildIndex 将切断剪辑和 fla 时间线之间的“同步”。

无论如何感谢您的回答，它在某种程度上帮助了我:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T05:13:51.257

实际上，当我们试图改变深度或开始拖动以及一些更动态的功能时，FLASH 会在舞台上冻结目标影片剪辑。最终在 FLASH 中只有一个阶段，猜猜如果动画剪辑被冻结在阶段怎么办？它始终可见或可用。

所以在你的情况下也发生了同样的事情。剪辑刚刚冻结到舞台上。不用说，第二帧总是空的。您不需要检查第二帧。您需要做的就是在导航到下一帧或场景之前删除该剪辑。

# javascript - 不能在图像中的地图标签中使用花哨的框 jquery 插件作为区域标签

> ID：12373860
> 
> 赞同：0
> 
> 时间：2012-09-11T16:10:22.743
> 
> 标签：javascript, jquery, html, popup, fancybox

我正在使用 FancyBox Jquery 插件在我的网站中显示弹出窗口。它适用于所有锚标签。我还想将它用于地图标签中的区域标签，以便在单击图像的特定部分时显示弹出窗口。我尝试了以下代码，但它不起作用：

```
<script type="text/javascript"> 
 $(document).ready(function(){ 
  $("#tag_id").fancybox(); 
 });
</script>

<map name="question_img">
 <area id="tag_id" shape="rect" coords="0,0,200,200" href="http://domain.com/ajax.txt" alt="" />
</map>

<img src='http://domain.com/image.jpg' width='100%' height='100%' usemap='#question_img'> 
```

请告诉我需要在 Jquery 代码中进行哪些修改。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T17:40:35.633

我在图像地图的区域标签上使用了 fancybox，它可以工作。尝试

> $("area#tag_id").fancybox();

你可以在这个 url 上查看我的实现：[Fancybox on area tag](https://apps.facebook.com/tensportspk/)

# javascript - 跨域ajax请求

> ID：12373861
> 
> 赞同：0
> 
> 时间：2012-09-11T16:10:26.773
> 
> 标签：javascript, html, ajax, post, request

跨域 ajax 请求被拒绝，但我可以通过以下方式解决它：

```
$(document).ready(function () {
  var data = ...;
  $('<img>').attr('src', 'http://domain.com?data=' + escape(data)).appendTo('body');
}); 
```

因此，如果我真的想要，我可以**将**数据发送到另一个域。我也可以以相同的方式**获取**数据，但在加载时我可以将其移动到画布上，然后读取像素。

那么这个限制有什么意义，它可以从中节省什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:12:19.870

当图像来自另一个域时，您仍然无法在 javascript 中读取图像的像素。所以你什么都没绕。

如果没有服务器的协作，页面就无法操作甚至读取来自另一个域的内容。这可以保护用户免受许多操纵（谷歌 XSS 攻击）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T16:15:17.583

> 那么这个限制有什么意义，它可以从中节省什么？

关键是防止您的站点从远程站点**读取**数据，而不是阻止它发送数据。

例如，您不能让我的浏览器转到我的银行并获取我的帐户详细信息，以便将它们发送到您的网络服务器。

同源策略不会阻止您提交将资金转移到您的服务器的请求，但这就是站点必须实施针对[CSRF 攻击](http://en.wikipedia.org/wiki/Cross-site_request_forgery)的防御措施的原因。

# javascript - 通过 Javascript 设置 Telerik RadTreeView 属性，例如 OnClientNodeExpanded

> ID：12373865
> 
> 赞同：0
> 
> 时间：2012-09-11T16:10:45.030
> 
> 标签：javascript, telerik, radtreeview

我有一个 RadTreeView 可以被变量引用： *TV*

我不知道我是否可以只做 jQuery 来做 $(TV).attr("OnClientNodeExpanded","newvalue") 因为可能有一个我可能不知道的服务器端链接。

当我在标记中定义我的 RadTreeView 时，它有 2 个属性：OnClientNodeExpanded 和 OnClientNodeClicked，它们被设置为一些 javascript 函数。

我的问题如下：

有没有办法通过一些参考来改变 OnClientNodeExpanded 和 OnClientNodeClicked 指向的位置，例如：*TV.set_ClientNodeExpanded("NEW_FUNCTION");*

我想根据点击的内容让 RadTreeView 填充不同的材料。

编辑以帮助阐明我的目标：*asp.net 控件具有这些属性。这意味着这些函数实际上是 loadNode 和 clickedNode。我想要做的是更改上面列出的那些属性的引用以指向不同的函数。我不确定我是否想要一个中间“判断”函数来确定要调用哪些函数，而是一种覆盖当前声明的方法，即当 RadTreeView 事件发生时会触发什么。这说明清楚了吗？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T17:11:17.160

在您的 javascript`OnClientNodeClicked`函数中，您可以检查单击了哪个项目，然后调用所需的函数。

```
function OnClientNodeClicked(sender, eventArgs) {
    var node = eventArgs.get_node();

    if(yourConditionHere){
        callFunctionA();
    }
    else{
        callFunctionB();
    }
} 
```

我理解正确吗？

# sql - 使用 Group by 4 的 SQL 查询

> ID：12373866
> 
> 赞同：-1
> 
> 时间：2012-09-11T16:10:50.193
> 
> 标签：sql, oracle

我有如下所示的表格。员工表

```
Date        Employee ID   Employer ID     Salary
2/3/2011      10            20            45666
3/12/2009     43            53            2356 
```

雇主表

```
Employer ID     State
53                OH
42                MI 
```

尝试使用 group by 子句按月和按州获得总工资。但没有得到结果。我究竟做错了什么？？任何帮助表示赞赏

```
select date, sum(salary) from employee
group by to_char(date,'MON')

select sum(salary) from employee A, Employer B
where A.employer id=B.employer id
group by B.state 
```

我还需要根据他们的薪水获得前 10 名不同的员工 ID

```
select DISTINCT employee id from employee
where rownum<=10
order by salary desc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:27:21.113

您必须按选择列表中的确切表达式进行分组，例如，

```
select to_char(date,'MON'), sum(salary) 
  from employee 
 group by to_char(date,'MON'); 
```

您可能希望在第二个查询中包含状态：

```
select b.state, sum(salary) 
  from employee A, Employer B  
 where A.employer_id=B.employer_id  
 group by B.state; 
```

一般来说，在你的问题中说你“没有得到结果”对你寻求帮助的人来说并不是很有帮助。请提供描述“未获得结果”含义的任何错误消息或输出。

# tsql - 是否有可以在插入期间执行动态更新的 SSIS 组件？

> ID：12373868
> 
> 赞同：0
> 
> 时间：2012-09-11T16:10:59.653
> 
> 标签：tsql, ssis

我有一张可能有数十亿条记录的表。要求是将表中一组记录的某些字段设置为以前的值，直到该值更改，然后用新值替换以前的值。

考虑以下作为从原始来源检索的记录的示例：

EventSeqNo EventDesc DescId Desc2Id Desc3Id Desc4Id Desc5Id
1 EventOne 1 102 1 1 1
2 EventTwo 2862 1 1 1 131
3 EventThree 1 1 1 1 1
6 关闭 1 102 1 102 1
1 EventOne 1 105 1 1 1
2 EventTwo 2873 1 1 1 131
3 EventThree 1 101 106 1 1
6 Close 1 1 1 102 1

插入决赛桌后所需的输出为：

EventSeqNo EventDesc DescId Desc2Id Desc3Id Desc4Id Desc5Id
1 EventOne 1 102 1 1 1
2 EventTwo 2862 102 1 1 131
3 EventThree 2862 102 1 1 131
6 Close 2862 102 1 102 131
1 EventOne 1 105 1 1 1
2 EventTwo 2873 105 1 1 131
3 EventThree 2873 101 106 1 131
6 关闭 2873 101 106 102 131

如您所见，每个字段都应获取前一个字段记录的值，除非它的值为 1。此外，重复此规则的记录范围被分组，范围从 1 到 6 作为事件值。

是否有一个 SSIS 组件可以在初始记录插入期间以最小的复杂性优雅地完成此任务，而不是在填充后对表执行复杂的 SQL 更新？

有人建议我缓存转换任务可能是解决方案，但在阅读了如何实现它之后，它似乎不是解决问题的合适解决方案。

如果没有任何 SSIS 包任务可以作为解决方案，还有哪些其他可能的替代方案？我愿意接受任何合理的建议。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T18:13:44.963

假设您可以保证插入的顺序，我会将数据插入到一个临时表中，该表具有一个身份和一个父 ID 列（以空值开始）。然后我会在 SSIS 中使用 Execute SQL 任务来转换数据（首先设置父 id 值（因此每个相关任务都有一个列告诉它组中的第一个任务），使其更容易进行转换）。在对暂存表中的数据进行转换后，我会做一个从暂存表到最终表的简单数据流。但是，如果有任何机会更改 csv 以添加一列将记录分组在一起，我会坚持这一点，否则其中一些迟早会出现故障。

# spring - @Transactional(REQUIRES_NEW) 中的回滚是否会传播到外部事务？

> ID：12373872
> 
> 赞同：0
> 
> 时间：2012-09-11T16:11:19.280
> 
> 标签：spring, transactions

我有一个调用@Transactional(REQUIRES_NEW) 的@Transactional(REQUIRED) 方法。我看到的默认行为是内部事务正在回滚，但外部事务正在提交。这是预期的行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T17:55:24.693

是的，这是预期的行为。执行内部事务时，外部事务被挂起。一旦内部事务结束（无论是提交还是回滚），外部事务就会恢复。

顺便说一句，[文档](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#tx-propagation-requires_new)说：

> PROPAGATION_REQUIRES_NEW 与 PROPAGATION_REQUIRED 相比，对每个受影响的事务范围使用完全独立的事务。在这种情况下，底层物理事务是不同的，因此可以独立提交或回滚，外部事务不受内部事务回滚状态的影响。

# android - android ICS中的位置缓存？

> ID：12373873
> 
> 赞同：5
> 
> 时间：2012-09-11T16:11:20.963
> 
> 标签：android, android-4.0-ice-cream-sandwich

我的理解是，在姜饼及更低版本中，android 保留了 200 个 wifi 位置修复和 50 个单元位置修复的缓存。这些存储在 /data/data/com.google.android.location/files 的 cache.wifi 和 cache.cell 文件中，root 设备可以使用这样的应用程序查看这些位置[。](https://play.google.com/store/apps/details?id=ch.rrelmy.android.locationcachemap&hl=en)

但是，这些类型的应用程序不再适用于 ICS 设备。这是否意味着 android 不再缓存单元格/wifi 位置修复？或者它只是意味着没有人能够为 ICS 创建类似类型的应用程序，或者没有人能够弄清楚缓存的存储位置吗？

假设在设备上本地存储了一个缓存，那么当请求网络提供的位置时，android返回的位置是通过本地缓存检索的还是来自网络的新位置？我怎么知道它是新的还是来自缓存？

最后，网络提供的位置（启用/打开 wifi 无线电并打开数据连接）实际使用了多少网络数据？

谢谢， 多姆

# java - 替换存储在字符串数组中的换行符

> ID：12373876
> 
> 赞同：0
> 
> 时间：2012-09-11T16:11:36.003
> 
> 标签：java, arrays, string

> **可能重复：**
> [如何比较 Java 中的字符串？](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)

考虑以下二维字符串数组 a[5][5]，

我将三个值存储在数组“a”的前三个块中。当我打印我的数组时，我得到以下输出。

```
ABC

null

DEF

null 
```

这些值存在于一个文件中，我检索这些值并将它们存储在一个字符串数组中。

文件（“file.txt”）看起来像这样，

```
A B C

D E F 
```

这是我的代码，

宣言：

```
static String [][] a= new String [4][4];
public static String newline = System.getProperty("line.separator");
private static int i,j; 
```

主要代码：

```
i=j=0;
        FileInputStream fin;
        fin = new FileInputStream("file.txt");
        DataInputStream in = new DataInputStream (fin);
        BufferedReader br = new BufferedReader (new InputStreamReader (in));
        while((c = (char)br.read()) != (char)-1)
        {
            if (c != '  ' && c != (char)'\n')
            {
                a[i][j] = Character.toString(c);
                j++;
            }
            else if (c == '\n')
            {
                i++;
                j = 0;
            }
        }
        for (int i=0;i<5;i++)
        {
            for (int j=0;j<5;j++)
            {
                if (newline.equals(a[i][j]))
                {
                    mainArray[i][j] = null;
                }
            }
        } 
```

这是我打印数组的方式，

```
 for (int i=0;i<5;i++)
        {
            for (int j=0;j<5;j++)
            {
                System.out.print(a[i][j]);
            }
           System.out.println("");
        } 
```

我想要的输出应该是，

```
ABCnullnull

DEFnullnull 
```

有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:21:26.600

BufferedReader 有一个 readLine() 方法，该方法将返回一个字符串，其中包含 \n 或 \r 之前的所有字符。它还在流的末尾返回 null。

```
FileInputStream fin;
fin = new FileInputStream("file.txt");
DataInputStream in = new DataInputStream (fin);
BufferedReader br = new BufferedReader (new InputStreamReader (in));
List<String> list = new ArrayList<String>();
String line;
while ((line= br.readLine())!=null)
{
  list.add(line);  
} 
```

这将处理任意数量的返回和任意长度的字符串。

或者，如果您必须将每一行作为和数组

```
 FileInputStream fin;
        fin = new FileInputStream("file.txt");
        DataInputStream in = new DataInputStream(fin);
        BufferedReader br = new BufferedReader(new InputStreamReader(in));
        List<char[]> list = new ArrayList<char[]>();
        String line;
        while ((line = br.readLine()) != null) {
            if(!line.isEmpty()) list.add(line.toCharArray());
        } 
```

读取您的文件应导致列表大小为两个，每个包含 5 个字符的数组。['A','','B','','C'] 然后 ['D','','E','','F']

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:22:17.507

尝试

```
public static String newline = System.getProperty("line.separator");
for (int i=0;i<5;i++)
{
    if (newline.equals(a[i]))
    {
        a[i] = null;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T16:48:01.003

编辑答案：

通过阅读您的回复并查看您的预期输出，您最好做这样的事情......

```
pseudo-code
read entire line into String array index
Before printing, check length of String (a[i].length)
If length is less than 5, add 'null' to the end of the String for every character less than 5

Thus:
if(a[i].length < 5)
{
  int index = 5 - a[i].length;
  for( ; index > 0; index --)
  {
     a[i].concat("null");
  }
} 
```

原始答案............不确定我的评论是否已发送给您。您可能只是索引太远了。

尝试

```
for(int i = 0; i < 4; i++)
   System.print(a[i]); 
```

# asp.net-mvc-3 - 如何发送列表项以在 mvc3 中逐部分查看？

> ID：12373879
> 
> 赞同：0
> 
> 时间：2012-09-11T16:11:39.130
> 
> 标签：asp.net-mvc-3

我有一个产品列表，并希望在每次页面刷新时将它们发送到**部分**查看，每页 5 个。显示所有部分后，在下次刷新时从列表的开头重新开始。如果产品列表计数不是5的被除数，例如count = 23，回到第一个。即取 15-20，然后取 20-2（21、22、23、1 和 2）。然后，3-8又继续。

我不能将分页规则用作：

```
ViewBag.Result = db.Products.Skip( ( pageNo - 1 ) * 5).Take( 5 ).ToList(); 
```

因为，我会将所有操作中的 5 个产品发送到每个令人耳目一新的站点中的视图和更新。

我有一个想法，即采用随机索引并开始，但我需要知道最后一个发送索引，并且在每次刷新时，将其发送到控制器的当前操作。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:14:21.290

您需要在 HTTP 调用之间保留最后一个发送索引。由于***HTTP 是无状态***的，因此您需要一种媒介来将其保持在两者之间。您可以使用**会话**变量来做到这一点。

```
Session["LastIndexSent"]= 5;
return View(someITemList); 
```

还要**尽量避免在 ViewBag 中发送此类结果**。使用动态的东西，比如`ViewBag/ViewData`在控制器和视图之间传输数据会使你的代码变得丑陋。使用强类型的方法。

```
List<Product> productList=GetProductListFromSomeWhere();
return View(productList); 
```

在你的强类型视图中，

```
@model List<Product>
@foreach(var prod in Model)
{
  <p>@prod.Name</p>
} 
```

# java - 如何在 Java 中使用查询参数更改 HTTP 方法？

> ID：12373881
> 
> 赞同：0
> 
> 时间：2012-09-11T16:11:43.380
> 
> 标签：java, api, rest, jax-rs

我的应用程序 UI 客户端总是会执行 GET 请求。我正在构建一个 RESTful 服务。有什么方法可以添加中间件/过滤器，允许我通过读取传递的查询参数（即_method）来更改http方法。目的是我的服务器 REST API 代码不会因为它以标准方式运行而变得混乱。我将使用 JAX-RS 来构建 RESTful API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:16:10.603

您可能可以实现自己的 Servlet[过滤器](http://docs.oracle.com/javaee/5/api/javax/servlet/Filter.html)来执行此操作。[在您的过滤器中，您可以使用HttpServletRequestWrapper](http://docs.oracle.com/javaee/5/api/javax/servlet/http/HttpServletRequestWrapper.html)包装现有请求并根据需要更改方法/查询参数。

# python - Python - 使用大型 NumPy 数组计算分区函数的难度

> ID：12373894
> 
> 赞同：3
> 
> 时间：2012-09-11T16:12:39.747
> 
> 标签：python, numpy, physics

我有一种非常紧凑的方法来使用 itertools、lambda 函数和大型 NumPy 数组来计算类似 Ising 的模型的分区函数。给定一个由`N`节点和`Q`“状态”/节点组成的网络，我有两个数组，`h`-fields 和`J`-couplings，大小分别为`(N,Q)`和`(N,N,Q,Q)`。然而，J 是上三角形。使用这些数组，我一直在`Z`使用以下方法计算分区函数：

```
# Set up lambda functions and iteration tuples of the form (A_1, A_2, ..., A_n)
iters = itertools.product(range(Q),repeat=N)
hf = lambda s: h[range(N),s]
jf = lambda s: np.array([J[fi,fj,s[fi],s[fj]] \
                            for fi,fj in itertools.combinations(range(N),2)]).flatten()

# Initialize and populate partition function array
pf = np.zeros(tuple([Q for i in range(N)]))
for it in iters:
    hterms = np.exp(hf(it)).prod()
    jterms = np.exp(-jf(it)).prod()
    pf[it] = jterms * hterms

# Calculates partition function
Z = pf.sum() 
```

这种方法适用于小型`N`，`Q`比如说`(N,Q) = (5,2)`。但是，对于较大的系统，由于内存问题`(N,Q) = (18,3)`，此方法甚至无法创建数组，因为它具有非平凡元素。关于如何克服此内存问题或如何更改代码以在子数组上工作的任何想法？`pf``Q^N`

编辑：在定义中犯了一个小错误`jf`。它已得到纠正。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:38:32.073

您可以通过将 Z 初始化为 0 并`jterms * iterms`在每次迭代中递增它来避免大数组。但是，这仍然不会让您摆脱对 Q^N 数字的计算和求和。为此，您可能需要想办法以代数方式简化配分函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T10:14:16.180

不确定您要计算什么，但我使用 ChrisB 建议测试了您的代码，并且 jf 不适用于 Q=3。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-05-03T17:05:30.803

也许您不应该使用密集的 numpy 数组来编码您的函数？您可以尝试使用稀疏数组或直接使用 Numba 编译的 Python。 [这篇](http://matthewrocklin.com/blog/work/2015/02/28/Ising/)博文展示了在简单的 Ising 模型上使用 Numba 并具有良好的性能。

# algorithm - 如何选择所有可能的组合？

> ID：12373896
> 
> 赞同：-3
> 
> 时间：2012-09-11T16:12:43.823
> 
> 标签：algorithm, combinations

假设我们有如下的贷款用户列表：

*   贷款1
*   贷款2
*   贷款3
*   ...
*   贷款10

并且我们有可以接受 2 到 10 笔贷款的功能： `function(loans)`. 例如，以下是可能的：

*   `function(loan1, loan2)`
*   `function(loan1, loan3)`
*   `function(loan1, loan4)`
*   `function(loan1, loan2, loan3)`
*   `function(loan1, loan2, loan4)`
*   `function(loan1, loan2, loan3, loan4, loan5, loan6, loan7, loan8, loan9, loan10)`

如何编写代码以将**所有可能的组合**传递给该函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:25:14.430

在[RosettaCode 上](http://rosettacode.org/wiki/Combinations)，您已经实现了多种语言的生成组合，请自行选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:33:12.440

下面是我们如何在 ruby​​ 中做到这一点：

```
loans= ['loan1','loan2', ... , 'loan10']

def my_function(loans)
  array_of_loan_combinations = (0..arr.length).to_a.combination(2).map{|i,j| arr[i...j]}

  array_of_loan_combinations.each do |combination|
    //do something
  end
end 
```

致电：

```
my_function(loans); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T15:48:18.983

我编写了一个类来处理处理二项式系数的常用函数，这是您的问题所属的问题类型。它执行以下任务：

将任何 N 选择 K 的所有 K 索引以良好的格式输出到文件。K-indexes 可以替换为更具描述性的字符串或字母。这种方法使得解决这类问题变得非常简单。

将 K 索引转换为已排序二项式系数表中条目的正确索引。这种技术比依赖迭代的旧已发布技术快得多。它通过使用帕斯卡三角形固有的数学属性来做到这一点。我的论文谈到了这一点。我相信我是第一个发现并发表这种技术的人，但我可能是错的。

将已排序二项式系数表中的索引转换为相应的 K 索引。我相信它可能比您找到的链接更快。

使用 Mark Dominus 方法计算二项式系数，它不太可能溢出并且适用于更大的数字。

该类是用 .NET C# 编写的，并提供了一种通过使用通用列表来管理与问题相关的对象（如果有）的方法。此类的构造函数采用一个名为 InitTable 的 bool 值，当它为 true 时，将创建一个通用列表来保存要管理的对象。如果此值为 false，则不会创建表。无需创建表即可执行上述 4 种方法。提供了访问器方法来访问表。

有一个关联的测试类，它显示了如何使用该类及其方法。它已经用 2 个案例进行了广泛的测试，并且没有已知的错误。

要了解此类并下载代码，请参阅 Tablizing The Binomial Coeffieicent。

将此类转换为您选择的语言应该不难。

为了解决您的问题，您可能需要编写一个新的贷款函数，该函数将贷款对象数组作为输入，并使用 BinCoeff 类处理这些对象。在 C# 中，要获取每个唯一组合的贷款数组，可以使用类似于以下示例代码的内容：

```
void LoanCombinations(Loan[] Loans)
{
   // The Loans array contains all of the loan objects that need
   // to be handled.
   int LoansCount = Loans.Length;
   // Loop though all possible combinations of loan objects.
   // Start with 2 loan objects, then 3, 4, and so forth.
   for (int N = 2; N <= N; N++)
   {
      // Loop thru all the possible groups of combinations.
      for (int K = N - 1; K < N; K++)
      {
         // Create the bin coeff object required to get all
         // the combos for this N choose K combination.
         BinCoeff<int> BC = new BinCoeff<int>(N, K, false);
         int NumCombos = BinCoeff<int>.GetBinCoeff(N, K);
         int[] KIndexes = new int[K];
         // Loop thru all the combinations for this N choose K.
         for (int Combo = 0; Combo < NumCombos; Combo++)
         {
            // Get the k-indexes for this combination, which in this case
            // are the indexes to each loan in Loans.
            BC.GetKIndexes(Loop, KIndexes);
            // Create a new array of Loan objects that correspond to
            // this combination group.
            Loan[] ComboLoans = new Loan[K];
            for (int Loop = 0; Loop < K; Loop++)
               ComboLoans[Loop] = Loans[KIndexes[Loop]];
            // Call the ProcessLoans function with the loans to be processed.
            ProcessLoans(ComboLoans);
         }
      }
   }
} 
```

我没有测试过上面的代码，但总的来说它应该可以解决你的问题。

# android - SQLite 行限制

> ID：12373898
> 
> 赞同：0
> 
> 时间：2012-09-11T16:12:46.393
> 
> 标签：android, sqlite, syntax, triggers, primary-key

我试图将我的 SQLite Db 中的行数限制为一。我到处寻找合适的解决方案，但没有找到任何地方。我收到了很多建议（约束、触发器等），但还没有真正找到一个以我目前的技能水平易于实施的解决方案。我决定尝试触发器，但找不到正确编写代码的位置。我有结构，但不知道如何正确格式化语法。我的代码低于当然不起作用（编译错误）。任何指导如何正确地为 android 编写此代码的帮助将不胜感激。我已经浏览过 sqlite.org 网站 ( [http://www.sqlite.org/lang_createtrigger.html](http://www.sqlite.org/lang_createtrigger.html) )

```
 public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub      

        String sqlDataStore = "create table if not exists " +
        TABLE_NAME_CREDENTIALS + " ("+ BaseColumns._ID + " integer primary key " + " ON CONFLICT FAIL ,"

                    + COLUMN_NAME_USERNAME + " TEXT NOT NULL " + " UNIQUE,"
                    + COLUMN_NAME_PASSWORD + " TEXT NOT NULL " + " UNIQUE);";

        db.execSQL(CREATE TRIGGER  " row_limiter " +  " BEFORE INSERT "
               + " ON "
               + " TABLE_NAME_CREDENTIALS " 
               + " FOR EACH ROW WHEN " 
               + ( SELECT  + "_id" + FROM + " TABLE_NAME_CREDENTIALS ") > "1"
               +    BEGIN
                    DELETE  FROM + "TABLE_NAME_CREDENTIALS"  +  WHERE  + "_id " > "1";
                     END

        db.execSQL(sqlDataStore);
    } 
```

主键设置为表的数据库：

```
 String sqlDataStore = "create table if not exists " +
                    TABLE_NAME_CREDENTIALS + " ("+ BaseColumns._ID + " NOT NULL,"

                                + COLUMN_NAME_USERNAME + " TEXT NOT NULL, "
                                + COLUMN_NAME_PASSWORD + " TEXT NOT NULL, "
                                + " PRIMARY KEY (username, passcode))"; 
```

插入：

```
contentValues.put(LoginDB.COLUMN_NAME_USERNAME, rUsername);
contentValues.put(LoginDB.COLUMN_NAME_PASSWORD, rPasscode); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T17:20:25.667

也许将表限制为一行的最简单方法是使用表中的主键并确保在插入或更新时始终设置为常量值。不需要触发器或其他技巧。

```
CREATE TABLE `limited_table` (
  `id` int(11) NOT NULL,
  `value` text ,
  PRIMARY KEY (`id`)
) 
```

现在替换时，始终在 SQL 查询中使用常量

```
ContentValues args = new ContentValues();
args.put(KEY_ID, LIMITED_ID_CONST);
args.put(KEY_VALUE, value );
//Replace
db.replace(DATABASE_TABLE, null, args); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:19:27.230

为什么不在插入之前计算行号并保护它？为什么要坚持使用 SQL 命令？顺便说一句，另一种解决方法是预先创建行的限制并使用更新，而不是插入。

# c# - ASP.NET C# Entity Framework - 如何正确更新外键？

> ID：12373899
> 
> 赞同：1
> 
> 时间：2012-09-11T16:12:51.093
> 
> 标签：c#, asp.net, entity-framework-4

我对这个 EF 很陌生，但我认为我正在取得进展。无论如何，看来我不知道如何**更新**与外键**相关**的对象。

我的 DbRelation 是： ![在此处输入图像描述](../Images/868d8f2db8ea9aa42a7334be4954c7c5.png)

我正在尝试更新一个成员 LANGUAGEID，这是我调用的上下文：

```
public class ManagerBase
    {
        private static NoxonEntities _entities = null;

        public NoxonEntities Entities
        {
            get
            {
                if (_entities == null)
                    _entities = new NoxonEntities();

                return _entities;
            }
        }
    } 
```

我尝试过很多事情。这是一个：

1)

```
MemberManager currentMemberManager = new MemberManager();
var Mem = currentMemberManager.MyEntities.Member.SingleOrDefault(c => c.Id == 2);
var Lang = currentLanguageManager.Entities.Language.SingleOrDefault(c => c.Id == 1);

            Mem.Language = Lang;
//Or
            Mem.LanguageId = Lang.Id;
currentMemberManager.Save(Mem); 
```

在appreach 1中，我收到一个错误，例如

```
The changes to the database were committed successfully, but an error occurred while updating the object context. The ObjectContext might be in an inconsistent state. Inner exception message: A referential integrity constraint violation occurred: The property values that define the referential constraints are not consistent between principal and dependent objects in the relationship. 
```

2)

```
//Managers uses ManagerBase class as a Base class
MemberManager currentMemberManager = new MemberManager();
currentMemberManager.Save(Globals.CurrentMember.Id, Globals.CurrentLanguage.Id);
//These Global objects coming from a Http Session
//You may also say not to keep whole member object in session which I'll not after I figure this out

Here is my SAVE method and where I have the actual problem:

public void Save(Member entity)
        {
            var Data = base.Entities.Member.First(c => c.Id == entity.Id);
                    if (Data != null)
                    {
                        Data = entity;
                        base.Entities.SaveChanges();
                    }
                }
            } 
```

在 appreach 1 中，我在 EF 模型 edmx 文件中的此代码中出现错误

```
[EdmScalarPropertyAttribute(EntityKeyProperty=false, IsNullable=false)]
        [DataMemberAttribute()]
        public global::System.Int32 LanguageId
        {
            get
            {
                return _LanguageId;
            }
            set
            {
                OnLanguageIdChanging(value);
                ReportPropertyChanging("LanguageId");
                _LanguageId = StructuralObject.SetValidValue(value);
                ReportPropertyChanged("LanguageId");
                OnLanguageIdChanged();
            }
        } 
```

错误是

```
Object reference not set to an instance of an object. 
```

显然，我对 EF 的态度是错误的。

您能否帮助我并展示如何正确更新关系 ID (ForeignKeyId) ？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T16:21:53.663

是的，您以许多错误的方式使用 EF。首先，正如 Arran 所指出的，你永远不应该让你的数据上下文是静态的。我知道这似乎更容易，但这是一个大问题，因为数据上下文被设计为经常创建和销毁。

如果你不这样做，那么对象图会继续增长，直到应用程序池最终耗尽，而且你可能会遇到并发访问的各种问题。静态对象在所有线程之间共享，因此想象一下，如果两个用户同时使用您的应用程序，他们都将使用相同的数据上下文，并且会互相踩踏。

其次，您使用的是单例，这是最受诟病的模式之一，原因有很多。它们有它们的用途，但它们比大多数人使用的要少得多。

第三，根据错误消息，听起来您的数据模型可能与您的 EF 模型不同步，因此它变得混乱并引发异常。您是否在不更新 ef 模型的情况下更改了数据库结构？请记住，重新生成并不总是更新所有内容，有时您必须手动更新它，或者删除您的对象并重新添加它们。

第四，您真正的问题（相信我，我列出的问题也是真正的问题，在某些时候会在后面*咬*你）在于以下代码：

```
var Data = base.Entities.Member.First(c => c.Id == entity.Id);
if (Data != null)
{
    Data = entity;
    base.Entities.SaveChanges();
} 
```

您首先要意识到的是 EF 返回被跟踪的对象，这些对象在 EF 中有引用并跟踪发生的更改。您在这里所做的是获取一个对象，然后将其丢弃并用传入的未跟踪对象替换它。

您必须更新从 First 方法返回的对象，而不是用新方法替换它。

# php - WordPress $wpdb。插入多条记录

> ID：12373903
> 
> 赞同：32
> 
> 时间：2012-09-11T16:13:10.623
> 
> 标签：php, mysql, wordpress

有什么方法可以在 Wordpress 中使用`$wpdb->insert`or完成以下操作

`$wpdb->query($wpdb->prepare))`：

```
INSERT into TABLE (column1, column2, column3) 
VALUES
('value1', 'value2', 'value3'),
('otherval1', 'otherval2', 'otherval3'),
('anotherval1', 'anotherval2', 'anotherval3') 
```

...ETC

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-09-11T17:22:38.150

好的，我想通了！

为实际值和占位符设置数组

```
$values = array();
$place_holders = array(); 
```

初始查询：

```
$query = "INSERT INTO orders (order_id, product_id, quantity) VALUES "; 
```

然后遍历您要添加的值，并将它们插入适当的数组中：

```
foreach ( $_POST as $key => $value ) {
     array_push( $values, $value, $order_id );
     $place_holders[] = "('%d', '%d')" /* In my case, i know they will always be integers */
} 
```

然后将这些位添加到初始查询中：

```
$query .= implode( ', ', $place_holders );
$wpdb->query( $wpdb->prepare( "$query ", $values ) ); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-02-24T18:39:00.493

您也可以使用这种方式来构建查询：

```
$values = array();

// We're preparing each DB item on it's own. Makes the code cleaner.
foreach ( $items as $key => $value ) {
    $values[] = $wpdb->prepare( "(%d,%d)", $key, $value );
}

$query = "INSERT INTO orders (order_id, product_id, quantity) VALUES ";
$query .= implode( ",\n", $values ); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-11-20T12:19:08.090

我遇到了这个问题，并决定通过使用公认的答案来构建一个更改进的功能：

```
/**
 * A method for inserting multiple rows into the specified table
 * 
 *  Usage Example: 
 *
 *  $insert_arrays = array();
 *  foreach($assets as $asset) {
 *
 *  $insert_arrays[] = array(
 *  'type' => "multiple_row_insert",
 *  'status' => 1,
 *  'name'=>$asset,
 *  'added_date' => current_time( 'mysql' ),
 *  'last_update' => current_time( 'mysql' ));
 *
 *  }
 *
 *  wp_insert_rows($insert_arrays);
 *
 *
 * @param array $row_arrays
 * @param string $wp_table_name
 * @return false|int
 *
 * @author  Ugur Mirza ZEYREK
 * @source http://stackoverflow.com/a/12374838/1194797
 */

function wp_insert_rows($row_arrays = array(), $wp_table_name) {
    global $wpdb;
    $wp_table_name = esc_sql($wp_table_name);
    // Setup arrays for Actual Values, and Placeholders
    $values = array();
    $place_holders = array();
    $query = "";
    $query_columns = "";

    $query .= "INSERT INTO {$wp_table_name} (";

            foreach($row_arrays as $count => $row_array)
            {

                foreach($row_array as $key => $value) {

                    if($count == 0) {
                        if($query_columns) {
                        $query_columns .= ",".$key."";
                        } else {
                        $query_columns .= "".$key."";
                        }
                    }

                    $values[] =  $value;

                    if(is_numeric($value)) {
                        if(isset($place_holders[$count])) {
                        $place_holders[$count] .= ", '%d'";
                        } else {
                        $place_holders[$count] .= "( '%d'";
                        }
                    } else {
                        if(isset($place_holders[$count])) {
                        $place_holders[$count] .= ", '%s'";
                        } else {
                        $place_holders[$count] .= "( '%s'";
                        }
                    }
                }
                        // mind closing the GAP
                        $place_holders[$count] .= ")";
            }

    $query .= " $query_columns ) VALUES ";

    $query .= implode(', ', $place_holders);

    if($wpdb->query($wpdb->prepare($query, $values))){
        return true;
    } else {
        return false;
    }

} 
```

来源：[https ://github.com/mirzazeyrek/wp-multiple-insert](https://github.com/mirzazeyrek/wp-multiple-insert)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-12-11T10:00:06.407

除了使用 $wpdb 插入多行之外，如果您需要更新现有的行，以下代码段应该会有所帮助。这是上面提供的[@philipp](https://stackoverflow.com/users/313501/philipp)的更新片段。

```
$values = array();

// We're preparing each DB item on it's own. Makes the code cleaner.
foreach ( $items as $key => $value ) {
    $values[] = $wpdb->prepare( "(%d,%d)", $key, $value );
}

$values = implode( ",\n", $values );
$query = "INSERT INTO orders (order_id, product_id, quantity) VALUES {$values} ON DUPLICATE KEY UPDATE `quantity` = VALUES(quantity)"; 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2014-10-10T15:42:11.077

这有点晚了，但你也可以这样做。

```
 global $wpdb;
    $table_name = $wpdb->prefix . 'your_table';

    foreach ($your_array as $key => $value) {
          $result = $wpdb->insert( 
            $table_name, 
            array( 
              'colname_1' => $value[0], 
              'colname_2' => $value[1], 
              'colname_3' => $value[2], 
            ) 
          );
        }
  if (!$result) {
    print 'There was a error';
  } 
```

* * *

## 回答 #6

> 赞同：-8
> 
> 时间：2012-10-27T12:03:51.507

不是很好，但如果你知道你在做什么：

```
require_once('wp-load.php');
mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);  
@mysql_select_db(DB_NAME) or die();
mysql_query("INSERT into TABLE ('column1', 'column2', 'column3') VALUES 
                               ('value1', 'value2', 'value3'), 
                               ('otherval1', 'otherval2', 'otherval3'),
                               ('anotherval1', 'anotherval2', 'anotherval3)"); 
```

# sql-server - 从 MSSQL 中的日期字段中选择不同的年份

> ID：12373911
> 
> 赞同：0
> 
> 时间：2012-09-11T16:13:43.760
> 
> 标签：sql-server, tsql, asp-classic

我正在对旧的 Classic ASP 网站进行一些更新。有一个表格，其中包含几列文本数据和一个日期时间字段。我需要从表中的所有值中获取唯一年份的列表。我试过这个：

```
set objConnection = Server.CreateObject("ADODB.Connection")
objConnection.ConnectionString = "Provider=SQLNCLI10;Server=localhost;Database=mydb;Uid=myuser;Pwd=something;"
objConnection.Open

set objRst = objConnection.execute("SELECT DISTINCT(YEAR(report_date)) AS report_year FROM report;")
if not objRst.eof then
    do while not objRst.eof
        response.write objRst("report_year")
        objRst.movenext
    loop
end if 
```

但是当我在页面中运行这个脚本时，它什么也不做——最终脚本超时。

谁能建议如何做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:27:24.850

这将是索引问题或锁定问题（或两者兼而有之）。

首先，尝试使用 NOLOCK 提示选择数据——这意味着您的选择查询不会等待任何未提交的事务：

```
set objRst = objConnection.execute("SELECT YEAR(report_date) AS report_year FROM report (NOLOCK) GROUP BY YEAR(report_date)") 
do while not objRst.eof 
    response.write objRst("report_year") 
    objRst.movenext 
loop 
```

如果仍然挂起，则表明存在索引问题，要解决此问题，您需要在 SSMS 中运行查询（如果可以）并查看需要多长时间。如果在 SSMS 中需要很长时间，则建议您需要在 report_date 列上创建一个索引 - 如果在 SSMS 中它很快，那么它与您的 ASP 有关，即连接是否打开？你试过做一个简单的查询来确保它有效吗？IE

```
SELECT TOP 1 YEAR(report_date) 
FROM report 
```

**编辑：**刚刚注意到您对表中只有 5 行这一事实的评论 - 所以这可能不是索引问题！然而，`NOLOCK`提示和`GROUP BY`（相对于`DISTINCT`）可能会有所帮助。

看到这个的执行计划也会很有趣（即确保没有触发器减慢速度）

# android - 在这个简单的 Android 应用案例中，我需要 OAuth 2.0 提供什么？

> ID：12373914
> 
> 赞同：3
> 
> 时间：2012-09-11T16:13:53.600
> 
> 标签：android, oauth, oauth-2.0, google-play, subscription

***故事：***我正在制作一个允许用户购买订阅的 Android 应用程序，并且不需要用户拥有帐户或登录名。我想检查用户是否购买了订阅， [Google Play Android Developer API 似乎提供了这项服务](https://developers.google.com/android-publisher/v1/)。

***问题 (TL;DR)：***我应该将 OAuth 用作“Web 应用程序”、“已安装的应用程序”、“服务应用程序”，还是以上都不是？

***问题：***要开始这个，我被告知：

> 使用 OAuth 2.0 Web 服务器流对访问 Google Play Android Developer API 进行身份验证。在使用 API 之前，您需要设置 API 控制台项目、创建客户端 ID 并生成刷新令牌。[-资源](https://developers.google.com/android-publisher/authorization)

很公平。然后有设置说明继续说：

> 在第二个页面上，选择 Web 应用程序并设置重定向 URI 和 Javascript 来源。

我的应用程序确实可以访问 Internet，但它是已安装的 Android 应用程序，*而不是*Web 应用程序，因此我没有“重定向 URI”或“Javascript 来源”来链接它。此外，这将需要用户登录，我不希望并且在我的情况下没有必要（我只想检查用户是否购买了订阅）。

因此，如果我尝试创建“已安装的应用程序（Android）”而不是“Web 应用程序”，这仍然需要用户登录，才能管理用户的资源。

我不想要这个。还有第三种选择，称为“服务帐户”，不需要用户登录：

> 当您的服务想要处理其“自己的”资源（例如，管理 Compute Engine 资源的 App Engine 应用）而不是外部用户的资源（例如，标准 OAuth 流程）时，使用服务帐户. 使用服务帐户，应用程序将成为资源的所有者……如果您使用服务帐户，您将只能获得有关服务购买的数据。[-资源](https://stackoverflow.com/questions/12359824/what-is-the-difference-between-a-service-account-and-an-installed-application)

我不确定这是否是我想要的...

最后，还有这个选项：

> 最简单的流程是不需要最终用户授权的流程。您仍然需要使用 API 密钥来识别您的客户端应用程序。[-资源](https://code.google.com/p/google-api-java-client/wiki/OAuth2)

这看起来很完美！但是，最初有人告诉我，要使用 Google Play Android Developer API，我需要使用 OAuth 2.0 进行身份验证，并且这不使用我最初被告知我特别需要的客户端 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T07:22:34.907

您在这里尝试实现的目标至少有两个问题：

1.  由于您将在 Android 应用程序中处理服务器响应，因此您的代码中将包含以下内容：

    ```
    if (isSubscriptionValid()) 
    ```

    有人可能会在他的设备上篡改您应用程序的 APK（这很容易），只需将检查替换为：

    ```
    if (true) 
    ```

    然后，攻击者无需订阅即可访问您的内容。

2.  由于对 API 的调用必须由您的开发人员帐户授权，并且在每个用户设备上亲自登录显然是没有选择的，因此您必须使用服务帐户，因为您已经正确理解了。

    然而，这些仅适用于[服务器到服务器的交互](https://developers.google.com/accounts/docs/OAuth2ServiceAccount)，否则它将要求您将私钥存储在每个人的设备上，并且由于无法在 Android 设备上安全地存储数据，因此您将无法满足此要求：

    > 必须安全地存储和管理私钥。

[Google 建议](https://developer.android.com/guide/google/play/billing/billing_subscriptions.html#play-dev-api)您使用后端服务器来执行此类检查。因此，您可以在将内容移交给客户和其他事情之前确定订阅是否有效：

> 该 API 旨在从您的后端服务器使用，作为安全管理订阅以及扩展订阅并将订阅与其他服务集成的一种方式。

如果您没有可用的后端服务器，则必须依靠[In-app Billing Notifications](https://developer.android.com/guide/google/play/billing/billing_subscriptions.html#implementing)。

# tfs - TFS TeamBuild：AgentScope - 门控签入

> ID：12373918
> 
> 赞同：0
> 
> 时间：2012-09-11T16:14:14.287
> 
> 标签：tfs, tfsbuild, build-automation, gated-checkin

我这里有一个情况；我设计了我的 TFS Team Build 2012 构建模板，如下所示

1.  运行代理范围内的所有活动，门控签到除外
2.  在构建成功和失败的情况下发送邮件（邮件带有变更集详细信息
3.  自上次成功构建到此构建），发送邮件活动发生在 finally 块中（在代理范围内）
4.  门控登记（这通常是要执行的最后一步，在代理范围之外）

现在，我的问题是：

1.  如何在我的邮件通知中包含通过 Gated-Checkin 发生的变更集。
2.  我无法在 AgentScope 内推送 Gated Checkin 活动，也无法在 Agent Scope 外拉出发送电子邮件活动。

如何处理？

# .htaccess - 内部服务器错误 - 多深度 URL 字符串

> ID：12373920
> 
> 赞同：1
> 
> 时间：2012-09-11T16:14:20.687
> 
> 标签：.htaccess, mod-rewrite

我目前正在为我的网站使用这个 .htaccess 文件，

```
RewriteEngine On
RewriteRule ^u/([^/]+)/[^/]+)/[^/]+)/?$ /index.php?username=$1&content=$2&type=$3 [L,QSA]
RewriteRule ^u/([^/]+)/[^/]+)/?$ /index.php?username=$1&content=$2 [L,QSA]
RewriteRule ^u/([^/]+)/?$ /index.php?username=$1 [L,QSA] 
```

但我得到了错误

> 服务器遇到内部错误或配置错误，无法完成您的请求。

我想要实现的是打开这个网址

```
http://www.site.com/users/index.php?username=$1&content=$2&type=$3 
```

进入

```
http://www.site.com/users/username/followers/newest 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:17:49.313

您缺少一些左括号：

```
RewriteRule ^u/([^/]+)/[^/]+)/[^/]+)/?$ /index.php?username=$1&content=$2&type=$3 [L,QSA]
RewriteRule ^u/([^/]+)/[^/]+)/?$ /index.php?username=$1&content=$2 [L,QSA]
RewriteRule ^u/([^/]+)/?$ /index.php?username=$1 [L,QSA] 
```

需要是：

```
# missing "(" here ----v and --v
RewriteRule ^u/([^/]+)/([^/]+)/([^/]+)/?$ /index.php?username=$1&content=$2&type=$3 [L,QSA]
RewriteRule ^u/([^/]+)/([^/]+)/?$ /index.php?username=$1&content=$2 [L,QSA]
RewriteRule ^u/([^/]+)/?$ /index.php?username=$1 [L,QSA] 
```

此外，如果您希望您的 URL 看起来像，请将开头的`http://www.site.com/users/username/followers/newest`更改为。`^u/``^users/`

# javascript - 缩小javascript是什么意思？骨干网.js

> ID：12373933
> 
> 赞同：-2
> 
> 时间：2012-09-11T16:15:24.067
> 
> 标签：javascript, backbone.js, minify

另外，一个额外的，不是太无关紧要的问题，你有一个建议/资源/博客来加快 Backbone js 库的速度吗？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-11T16:35:58.673

minify javascript 用于压缩您的 javascript 代码：让我们看一个示例：这是一个普通的 javascript 函数

```
function editField(id){
    //hello hello hello
        var a = 1;
    var b = 2;
    var sum = a + b;

} 
```

当你缩小它看起来像：

```
function editField(f){var d=1;var c=2;var e=d+c;}; 
```

当您缩小注释和空格以提高代码性能时

你可以试试这个网络工具来缩小 javascript [链接 YUI Compressor](http://refresh-sf.com/yui/)

# java - UTF-16 到 Java 中的字符串

> ID：12373938
> 
> 赞同：0
> 
> 时间：2012-09-11T16:15:39.713
> 
> 标签：java, string, utf-16

假设我有“样本”这个词。在 UTF-16 BE 中，这表示为`00 53 00 61 00 6D 00 70 00 6C 00 65`. 当我有这个时，我想使用 Java 将它转换回“示例”。我该怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T16:16:56.267

[您可以使用new String(array, charset)](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#String%28byte%5B%5D,%20java.lang.String%29)将字节序列转换为具有指定字符集的字符串

> 通过使用指定的字符集解码指定的字节数组来构造一个新的字符串。新字符串的长度是字符集的函数，因此可能不等于字节数组的长度。

# cuda - 全局函数和设备函数的区别

> ID：12373940
> 
> 赞同：131
> 
> 时间：2012-09-11T16:15:52.150
> 
> 标签：cuda

谁能描述和之间的`__global__`区别`__device__`？

我应该什么时候使用`__device__`，什么时候使用`__global__`？

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2012-09-11T16:18:44.487

全局函数也称为“内核”。这是您可以使用 CUDA 内核调用语义 ( `<<<...>>>`) 从主机端调用的函数。

设备函数只能从其他设备或全局函数调用。`__device__`不能从主机代码调用函数。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-09-11T16:33:44.310

`__device__`和`__global__`函数之间的区别是：

`__device__`函数只能从设备调用，并且只能在设备中执行。

`__global__`可以从主机调用函数，并在设备中执行。

因此，您`__device__`可以从内核函数中调用函数，而不必设置内核设置。您还可以“重载”一个函数，例如：您可以声明`void foo(void)`and `__device__ foo (void)`，然后在主机上执行一个并且只能从主机函数调用。另一个在设备上执行，只能从设备或内核函数调用。

您还可以访问以下链接：[http](http://code.google.com/p/stanford-cs193g-sp2010/wiki/TutorialDeviceFunctions) ://code.google.com/p/stanford-cs193g-sp2010/wiki/TutorialDeviceFunctions ，它对我很有用。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2016-09-12T10:58:36.303

1.  `__global__`- 在 GPU 上运行，从 CPU 或 GPU* 调用。用`<<<dim3>>>`参数执行。
2.  `__device__`- 在 GPU 上运行，从 GPU 调用。也可以与变量一起使用。
3.  `__host__`- 在 CPU 上运行，从 CPU 调用。

*)`__global__`函数可以从 计算能力 3.5开始的其他`__global__`函数调用。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2014-02-11T09:49:04.710

我将用一个例子来解释它：

```
main()
{
    // Your main function. Executed by CPU
}

__global__ void calledFromCpuForGPU(...)
{
  //This function is called by CPU and suppose to be executed on GPU
}

__device__ void calledFromGPUforGPU(...)
{
  // This function is called by GPU and suppose to be executed on GPU
} 
```

即，当我们希望主机（CPU）函数调用设备（GPU）函数时，使用“**全局**”。阅读：“ [https://code.google.com/p/stanford-cs193g-sp2010/wiki/TutorialGlobalFunctions](https://code.google.com/p/stanford-cs193g-sp2010/wiki/TutorialGlobalFunctions) ”

当我们想要一个设备（GPU）函数（而不是内核）调用另一个内核函数时，我们使用“**设备**”。阅读此“ [https://code.google.com/p/stanford-cs193g-sp2010/wiki/TutorialDeviceFunctions](https://code.google.com/p/stanford-cs193g-sp2010/wiki/TutorialDeviceFunctions) ”

这应该足以理解差异。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2012-09-11T16:19:00.320

`__global__`用于 cuda 内核，可直接从主机调用的函数。`__device__`函数可以从`__global__`和`__device__`函数调用，但不能从主机调用。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-02-16T05:33:22.207

`__global__`函数是内核的定义。每当从 CPU 调用它时，该内核就会在 GPU 上启动。

然而，执行该内核的每个线程可能需要一次又一次地执行一些代码，例如交换两个整数。因此，在这里我们可以编写一个辅助函数，就像我们在 C 程序中所做的那样。对于在 GPU 上执行的线程，辅助函数应声明为`__device__`.

因此，设备函数是从内核的线程中调用的——一个线程一个实例。同时，从 CPU 线程调用全局函数。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-10-18T18:56:38.477

暂时在此记录一些毫无根据的推测（以后遇到权威资料我会佐证）...

1.  `__device__`函数可以具有除 void 以外的返回类型，但`__global__`函数必须始终返回 void。

2.  `__global__`可以从运行在 GPU 上的其他内核中调用函数以启动额外的 GPU 线程（作为 CUDA 动态并行模型 (aka CNP) 的一部分），而`__device__`函数与调用内核在同一线程上运行。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-07-02T06:04:17.027

`__global__`是一个 CUDA C 关键字（声明说明符），它表示该函数，

1.  在设备 (GPU) 上执行
2.  来自主机 (CPU) 代码的调用。

主机代码使用`<<< no_of_blocks , no_of threads_per_block>>>`. 每个线程通过其唯一的线程 ID 执行内核。

但是，`__device__`不能从主机代码调用函数。如果需要，请同时使用`__host__` `__device__`.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-29T00:33:18.820

全局函数只能从主机调用，它们没有返回类型，而设备函数只能从其他设备函数的内核函数调用，因此不需要内核设置

# opencv - 使用 IplImage 从图像中提取对象

> ID：12373942
> 
> 赞同：2
> 
> 时间：2012-09-11T16:15:56.160
> 
> 标签：opencv, detect

如何从图像中提取对象`IplImage`？

另外，如果我在对象所在的位置有带有白色像素的蒙版，如何获得对象的原始颜色？

我想要做的一个例子可以在[这里](http://bsd-noobz.com/opencv-guide/60-2-color-based-object-segmentation)找到，但`IplImage`不使用`mat`。

# java - 如何使用 hibernate.cfg.xml 创建数据库模式

> ID：12373944
> 
> 赞同：2
> 
> 时间：2012-09-11T16:16:06.427
> 
> 标签：java, hibernate, schema

使用

```
 < property name="hbm2ddl.auto"> create< / property > 
```

只创建表，并且每当模式不存在时，hibernate 无法创建表，因为模式不存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:26:51.847

Hibernate 不会为您创建模式，但也许您可以告诉您的 DBMS 在 hibernate 开始创建模式对象之前运行一些脚本。我在[这里](http://blog.solidcraft.eu/2011/01/hibernate-hbm2ddl-wont-create-schema.html)找到了一些东西，我认为您可以将其用作起点。

# git - 如何“git clone”包括无法从客户端主机访问的子模块？

> ID：12373949
> 
> 赞同：2
> 
> 时间：2012-09-11T16:16:43.683
> 
> 标签：git, proxy, git-submodules

我想克隆一个包含其子模块的存储库。

我已经了解了[这个问题](https://stackoverflow.com/questions/3796927/how-to-git-clone-including-submodules)`--recursive`的选项，但是这个解决方案要求子模块存储库可以从克隆主机访问。

是否有一些开关可以直接从可访问的主机克隆子模块？

有一个 https 代理，理论上我可以通过它访问子模块存储库，但是克隆主机没有安装所需的证书。因此，找到一种在用户空间中安装某个 https 证书的方法也可能是一种解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T19:36:36.610

如果远程服务器（您评论中的 host1）必须代表您执行克隆或获取，那么不，您不能这样做。

但是，由于子模块本身就是存储库，因此如果将它们克隆到 host1 上，您可以直接使用它们。克隆主存储库后，编辑`.gitmodules`文件并将 Github URL 更改为 host1:mainrepo 的相应子目录：

```
[submodule "submod1"]
        path = extern/sub1
        url = git://github.com/user/myproject 
```

更改为

```
[submodule "submod1"]
        path = extern/sub1
        url = host1:git/mainproject/extern/sub1 
```

然后，您可以使用这些`git submodules`命令来处理它们。

（但您必须小心：`.gitmodules`除非您真的有意，否则不要将您的更改提交或推送到 host1 上的子模块！）

* * *

对于您的替代问题，请查看 Git 配置设置`http.proxy`和`http.sslCert`. 您应该能够直接使用后者提供证书文件，而无需在系统 CA 路径中“安装”它。

# mysql - 如何使用MYSQL中的查询删除2个字符之间的文本

> ID：12373950
> 
> 赞同：1
> 
> 时间：2012-09-11T16:16:45.943
> 
> 标签：mysql

我有一个名为描述字段的表，其中包含如下文本

```
|Description                              |
|-----------------------------------------|
|This is a text <a>blah</a> <br/> <img /> |
|This is <b>second</b> <a>row</a>         | 
```

我想删除“ **<** ”和“ **>** ”之间的所有内容

## 所需输出

```
|Description                              |
|-----------------------------------------|
|This is a text blah                      |
|This is second row                       | 
```

无论如何我可以使用 MYSQL 查询来实现这一点。我目前无法使用存储过程，因为我没有权限。我已经请求访问使用存储过程，但这需要一些时间，我必须紧急完成这一点。

谢谢。

**更新：**我的问题类似于[从文本字符串中删除 2 个字符之间的字符串](https://stackoverflow.com/questions/9470142/remove-string-between-2-characters-from-text-string)，但我希望它在 MYSQL 查询中完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:18:54.520

简而言之，你不能，你需要一种更高级的语言，比如 PHP。您的 SQL 查询不是进行字符串操作的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:39:57.673

REPLACE() 使用通配符捕获左括号和右括号之间的未知文本怎么样？[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T16:48:31.523

如果你使用 php 作为你的服务器端语言，你可以使用[strip_tags](http://php.net/manual/en/function.strip-tags.php)函数来删除标签。我希望它可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-17T22:06:05.743

由于这个问题仍然在谷歌搜索结果中，也许答案可能对某人有所帮助：

替换两个字符之间的内容的快速功能。它也应该与文字一起使用，但我没有用文字对其进行测试。用于删除以下字符串：“this is a [demo]”

[ 和 ] 之间的字符串：

select deletestr("这是一个 [demo]" ,'[',']');

和功能：

```
 CREATE DEFINER=`replace_with_your_db`@`%` 
FUNCTION `deletestr` (`inputstr` TEXT CHARSET utf8, `fromstr` VARCHAR(10) CHARSET utf8, `tostr` VARCHAR(10) CHARSET utf8) RETURNS text CHARSET utf8
    NO SQL
RETURN
replace(inputstr,substr(inputstr, locate(fromstr,inputstr),locate(tostr,inputstr)-locate(fromstr,inputstr)+length(tostr)),'') 
```

# php - 使用 json_encode 通过 xmlhttp.responseText 发送特殊字符（即 caron）

> ID：12373951
> 
> 赞同：0
> 
> 时间：2012-09-11T16:16:47.313
> 
> 标签：php, javascript, ajax, json

我正在尝试从数据库中获取带有特殊字符（caron）的数据，并使用 json_encode 通过 xmlhttp.responseText 发送它以填充文本框。与包含特殊字符 (caron) 的数据关联的特定文本框不显示任何内容。其他文本框正在显示正确的数据。我尝试使用 Javascript 函数 encodeURIComponent，但文本框中只显示 null。任何帮助，将不胜感激。

主页代码：

```
function loadDoc()
{
   var xmlhttp;

   // code for IE7+, Firefox, Chrome, Opera, Safari
   if (window.XMLHttpRequest)
   {
      xmlhttp=new XMLHttpRequest();
   }
   // code for IE6, IE5
   else
   {
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
   }

   xmlhttp.onreadystatechange=function()
   {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
      {
         var a = JSON.parse(xmlhttp.responseText);
         document.getElementById("textbox").value=a.first;
         document.getElementById("textbox2").value=a.second;
         document.getElementById("textbox3").value=a.third;
         document.getElementById("textbox4").value=a.fourth;
         document.getElementById("textbox5").value=a.fifth;
         document.getElementById("textbox6").value=a.sixth;
      }
   }

   xmlhttp.open("GET","loadTextBox.php?id=4",true);
   xmlhttp.send();
} 
```

loadTextBox.php 代码：

```
<?php
header("Content-type: application/json");

---Placeholder for correct DB login info---

$result = $mysql->query(---Placeholder for correct SQL query---);

while ($row = $result->fetch_object())
{
   $queryResult[] = $row->colun_one;
}
$textboxValue = $queryResult[0];
$textboxValue2 = $queryResult[1];
$textboxValue3 = $queryResult[2];
$textboxValue4 = $queryResult[3];
$textboxValue5 = $queryResult[4];
$textboxValue6 = $queryResult[5];
echo    
json_encode(array('first'=>$textboxValue,'second'=>$textboxValue2,
'third'=>$textboxValue3,'fourth'=>$textboxValue4,'fifth'=>$textboxValue5,
'sixth'=>$textboxValue6));
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:22:44.020

在发送之前使用 UTF-8 对其进行编码。

`utf8_encode($variable);`

或尝试`array_map();`对数组进行编码；

```
$textboxValue = $queryResult[0];
$textboxValue2 = $queryResult[1];
$textboxValue3 = $queryResult[2];
$textboxValue4 = $queryResult[3];
$textboxValue5 = $queryResult[4];
$textboxValue6 = $queryResult[5];
$arrayToEncode = array('first'=>$textboxValue,'second'=>$textboxValue2,
'third'=>$textboxValue3,'fourth'=>$textboxValue4,'fifth'=>$textboxValue5,
'sixth'=>$textboxValue6);
$encodedArray = array_map('utf8_encode', $arrayToEncode);
echo json_encode($encodedArray); 
```

您可能还需要将您的`xmlhttp.request`设置`utf-8`为

```
xmlhttp.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
xmlhttp.open("GET","loadTextBox.php?id=4",true);
xmlhttp.send(); 
```

You may need to try one or the other or even both. You also want to confirm your DB is able to store special characters, if the DB is not storing the special chars then there is no way your application will be able to get them to encode them.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T04:59:29.823

Adding in the line $mysql->query("SET CHARACTER SET 'utf8'"); inside loadTextBox.php after connecting to the DB and before the SQL query fixed it.

# modelica - 算法部分语句的执行顺序

> ID：12373960
> 
> 赞同：4
> 
> 时间：2012-09-11T16:17:35.730
> 
> 标签：modelica

```
model try
discrete Integer x(start = 1);
algorithm
when time >= 3 then
  x:= x + 5;
end when;
x:= 5;
end try;

model try1
discrete Integer x(start = 1);
algorithm
x:= 5;
when time >= 3 then
  x:= x + 5;
end when;
end try; 
```

在 OpenModelica 上的两个模拟结果都是 x 总是等于 5。为什么？

看起来模型中的x`try`应该是5。但是为什么`try1`当时间等于3时模型中的x不是10呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T20:18:40.490

我有两条评论。首先，请记住，在处理子句时，使用运算符来明确说明您所指的值是新的还是以前的值`when`，通常是谨慎的。`pre(...)`我不知道在这种情况下是否是绝对必要的（即使我知道，我也不确定 Modelica 工具的所有开发人员是否都使用一致的语义），但如果只是明确说明一下是个好主意代码的读者。

另一个问题是算法的处理。`algorithm`通常，语句按照它们在该部分中出现的顺序执行。但是`when`子句有点棘手，因为它们具有异步性质。`when`同样，关于子句与模型中其他赋值语句的交错，我不清楚确切的语义是什么，但是`algorithm`像你这样写一个部分有点模棱两可。假设`when`语句被评估并被`x`赋予一个新值，您希望它保持该值多长时间？编译器在重复评估算法部分有自由度可能会在`when`调用子句后立即评估，在这种情况下`x`将被赋予一个新值`5`（也许甚至根本没有时间推进）。

我不确定你对这个模型的真正意图是什么。但是，如果您希望它以一个值开始，然后在 time>3 之后采用新值（基于旧值），我在 Modelica 中看到了两种实现方式，它们都涉及如何设置初始值价值。考虑以下模型：

```
 model InitAndEvent
    discrete Integer x(start=1);
  algorithm
    when initial() then
      x := 5;
    end when;
    when time >= 3 then
      x := pre(x) + 5;
    end when;
  end InitAndEvent; 
```

该模型使用`pre`运算符，但更重要的是，它还使用`initial()`事件为`x`. 通过这种方式，这避免了您在以前的模型中可能遇到的不断覆盖`x`to值的问题`5`。另一种方法可能是：

```
 model InitAndEvent
    discrete Integer x(start=1);
  initial algorithm
    x := 5;
  algorithm
    when time >= 3 then
      x := pre(x) + 5;
    end when;
  end InitAndEvent; 
```

尽管我承认我怀疑不同的工具可能对每个版本有不同的语义。我想说这个`when initial()`版本可能更普遍一致。

**更新：**

我认为您的误解来自于没有考虑*后续*评估的影响。在 的情况下`try1`，在 time==3 时，该`when`子句被评估并被`x`赋予一个新值。

但是下一次模型评估会发生什么？再次评估算法部分**并`x`设置回 5**。**在条件表达式变为假然后再次变为真之前，不会**再次评估该`when`子句。所以在这种情况下，它只触发一次！如果您希望对大于 3 的所有时间进行评估，则需要使用语句。**`if`**

 **`when`并记住这个问题......从执行子句到下一次模型评估（何时`x`重置）之间经过了多少模拟时间？很可能**没有**。您无法知道何时执行算法部分（这取决于事件、使用的积分器等）。因此，如果您想`x`在模拟开始时和在 时获得一个值`time==3`，那么您需要在模型中声明它（就像我在示例中所做的那样）。**

# mysql - 在 Wordpress 中加入查询

> ID：12373962
> 
> 赞同：2
> 
> 时间：2012-09-11T16:17:37.983
> 
> 标签：mysql, wordpress

我需要加入这两张桌子

*   表 1：wp_usermeta，我存储用户上次登录时间的地方
*   表 2：wp_chats，其中存储用户之间的聊天

此查询获取已登录用户并计算从该用户到当前用户的聊天记录。但是，如果该用户没有聊天，它将不会返回已登录的用户。

即使没有聊天，如何使此查询返回所有登录用户？

```
SELECT m.user_id, COUNT(c.from_id) as cnt 
FROM wp_chats c 
JOIN wp_usermeta m  ON  m.user_id=c.from_id
WHERE m.meta_key='user_last_login' 
 AND m.meta_value>=$time 
 AND c.to_id=$from_id 
 AND c.received=0 
GROUP BY c.from_id; 
```

[http://sqlfiddle.com/#!2/edc6b/1](http://sqlfiddle.com/#!2/edc6b/1)

用户 2、3、4、5、6 都已登录并且应该在输出中。用户 7 未登录且未出现。

然而，只有3、6个出现。我怎样才能让除了#7 之外的所有东西都出现在输出中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T19:47:34.750

**在小提琴[http://sqlfiddle.com/#!2/edc6b/12中](http://sqlfiddle.com/#!2/edc6b/12)**编辑完善的查询****

 **```
SELECT m.user_id, COUNT(c.from_id) as cnt 
FROM wp_usermeta m
LEFT JOIN wp_chats c   
  ON  m.user_id=c.from_id
  AND c.received=0
  AND c.to_id=2
WHERE m.meta_key='user_last_login' 
AND m.meta_value>=1347305273               
GROUP BY m.user_id; 
```**

# php - 在 PHP 文件中提供 CSS（使用 IIS）

> ID：12373965
> 
> 赞同：0
> 
> 时间：2012-09-11T16:17:46.223
> 
> 标签：php, css, iis

我正在尝试使用 PHP 输出 CSS 以通过 wordpress 设置使其更加动态，但我收到 500 个内部服务器错误。我将标题设置为 text/css，试图在 IIS 中添加处理程序，但它似乎不起作用。PHP 文件中没有错误，因为如果我删除我的代码，它不会改变。

```
<?php header("Content-type: text/css"); ?> 
```

而在 .htaccess 中添加以下内容适用于 apache 服务器

```
AddType application/x-httpd-php .html .htm .css
AddHandler application/x-httpd-php .html .htm .css 
```

这是我使用 IIS 得到的响应：

```
 HTTP/1.1 500 Internal Server Error

   Content-Type: text/css

   Server: Microsoft-IIS/7.0

   X-Powered-By: PHP/5.3.13

   Date: Tue, 11 Sep 2012 16:38:12 GMT

   Content-Length: 0 
```

知道如何让它在 IIS 下工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T17:24:03.463

该问题可能与 IIS 7 配置问题有关

`Static Content`从 Windows 添加和删除程序 - [IIS 7 Not Serving Static Files](http://brendan.enrick.com/post/IIS-7-Not-Serving-Static-Files.aspx)配置 IIS 时，确保在 Common HTTP Features 中启用。另一个参考 -[有趣的问题：Windows 7，IIS 7.5：图像，CSS 未显示！](http://gurustop.net/blog/2009/10/12/funny-problem-windows-7-iis-7-5-images-css-not-showing/)

或者尝试[通配符脚本映射和 IIS 7 集成管道](http://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/wildcard-script-mapping-and-iis-integrated-pipeline)，或者只是简单地重新安装 IIS。

# html - 浮动 div 在 Chrome 中 iframe 内的小程序上方不可见

> ID：12373972
> 
> 赞同：4
> 
> 时间：2012-09-11T16:17:57.067
> 
> 标签：html, css, google-chrome, iframe, applet

我正在加载一个在 iframe 中有一个小程序的外部页面。我需要在这个 iframe 上方显示一个浮动 div。如果我在包含的 div 上使用相对位置或绝对位置，在浮动 div 上使用更高的 z-index，它在 Firefox 中可以正常工作，但在 Chrome 或 IE 中不起作用。chrome 和 IE 都在小程序下方呈现浮动 div。
对此有任何指示吗？
如果我使用一些 iframe 中没有小程序的页面，那么它可以正常工作。
我遇到了类似的问题，看起来如果我将我的 div 放在与小程序相同的级别并提供更高的 z-index 它可以工作，但这是一个我加载的外部页面，我不能在那里放任何东西。

我的代码有点像这样：

```
<div id="div1" style="position: absolute; z-index:1;">
     <iframe src="http://xyz...." width="400" height="200" ></iframe>
</div>
<div id="div2" style="position: absolute; top:20; z-index:5">
    Floating div content
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T16:44:53.500

首先，请注意这几点..

1.  `<applet>`HTML5 不支持该标记。请改用`<object>`标签。
2.  该`<applet>`元素在 HTML 4.01 中已弃用。

然后，请确保浏览器的 java 插件 (JRE) 是最新的。Chrome 浏览器最近支持小程序标签。在此之前，它曾经不支持小程序标签。

# javascript - javascript 数组元素是否知道它们的封闭数组？

> ID：12373977
> 
> 赞同：1
> 
> 时间：2012-09-11T16:18:35.987
> 
> 标签：javascript, arrays

好的，我们有这个 sql 比较工具，它比较两个数据库并吐出 HTML 差异的报告。我需要解析它创建的 javascript 以了解有关差异的更多详细信息。例如，如果它显示 500 个更改的存储过程，我无法按更改的人或时间进行筛选。但是如果我可以解析 JS，我可以根据这些条件进行过滤。但是，它们的 JS 结构相当复杂，主要是嵌套数组，有时会低至 4 层。这是一个显示 4 条不同记录的示例。

```
var createsql  = new Array(

new Array(new Array(0, "Error, No SQL Availible")),

new Array (
  new Array(0,"-- Stored Procedure", " "),
  new Array(0,"", ""),
  new Array(1,"--------------------------------------------------------------------------------------", " "),
  new Array(1,"/*", " "),
  new Array(1,"Procedure        : Schema.p_procedure1", " "),
  new Array(1,"Description       : This process will do something", " "),
  new Array(1,"Creation Date  : 11/24/2009", " "),
  new Array(1,"Created By       : John Doe", " "),
  new Array(1,"Tables Updated : None", " "),
  new Array(1,"*/", " "),
  new Array(0, "", "")
),

new Array (  
  new Array(0,"-- Stored Procedure", " "),
  new Array(0,"", ""),
  new Array(1,"--------------------------------------------------------------------------------------", " "),
  new Array(1,"/*", " "),
  new Array(1,"Procedure        : Schema.p_procedure2", " "),
  new Array(1,"Description       : This process will do something", " "),
  new Array(1,"Creation Date  : 11/24/2011", " "),
  new Array(1,"Created By       : Jane Doe", " "),
  new Array(1,"Tables Updated : None", " "),
  new Array(1,"*/", " "),
  new Array(0, "", "")
),

new Array (
  new Array(0,"-- Stored Procedure", " "),
  new Array(0,"", ""),
  new Array(1,"--------------------------------------------------------------------------------------", " "),
  new Array(1,"/*", " "),
  new Array(1,"Procedure        : Schema.p_procedure3", " "),
  new Array(1,"Description       : This process will do something", " "),
  new Array(1,"Creation Date  : 11/24/2012", " "),
  new Array(1,"Created By       : Mark Doe", " "),
  new Array(1,"Tables Updated : None", " "),
  new Array(1,"*/", " "),
  new Array(0, "", "")
)

); 
```

我可以解析数组并使用这段代码得到我需要的东西

```
var match = "Jane Doe";
var createLength = createsql.length;
var matched;

for(var i = 0; i < createLength; i++){
    if(typeof createsql[i] === "object"){
        var firstArrayLength = createsql[i].length;
            for(var j = 0; j < firstArrayLength; j++){
                if(typeof createsql[i][j] === "object"){
                    var secondArrayLength = createsql[i][j].length;
                        for(var k = 0; k < secondArrayLength ; k++){
                            if(typeof createsql[i][j][k] === 'string'){
                                if((createsql[i][j][k].indexOf(match) != -1)){
                                    console.log(createsql[i][j][k]);
                                    console.log('matched');
                                    //need to grab the parent and search its elemets for the one that starts with the word "Procedure"
                                }
                            }
                        } 
                }

            }    
    }
} 
```

但我坚持的是如何获得我目前所在的数组的父级？例如，如果我的搜索字符串是`Jane Doe`，我想检索表示`"Procedure : Schema.p_procedure2"`同级数组中的第二个元素的元素。请不要拍我！

[这是小提琴](http://jsfiddle.net/DBM7H/1/)

PS：欢迎任何其他改进循环的建议，这只是一个示例，列表可能会更大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:25:47.680

我可能遗漏了一些东西，但我认为答案相对简单：由于您知道数组结构，因此您可以使用`createsql[i][4][1]`.

注意：如果你想动态搜索以“Procedure”开头的项目，你可以用更多的代码来做到这一点。我认为您的问题的关键答案是您刚开始`createsql[i]`从适当的父数组开始您的第二次搜索。

**小提琴：http:** [//jsfiddle.net/nate/DBM7H/2/](http://jsfiddle.net/nate/DBM7H/2/)

`console.log('Procedure', createsql[i][4][1]);`

**更新：**

这是一个如何动态查找程序项的示例。

**小提琴：http:** [//jsfiddle.net/nate/DBM7H/4/](http://jsfiddle.net/nate/DBM7H/4/)

创建一个函数来查找以“Procedure”开头的项目：

```
var findProcedure = function (record) {
    var i, length;
    for (i = 0, length = record.length; i < length; i += 1) {
        if (record[i][1].substring(0, 9) === 'Procedure') {
            return record[i][1];
        }
    }
} 
```

然后只需在代码中使用该函数和正确的记录：

```
// Find the procedure
console.log(findProcedure(createsql[i])); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:42:46.447

如果这些数组的形式是恒定的，我强烈建议将它们转换为原生 javascript 对象，以提高使用它们的简单性：

```
var sqlObjs = [];

for (var i = 0; i < createsql.length; i++){
    var item = createsql[i];     
    if (item.length != undefined && item.length > 1){
        sqlObjs.push({
            Procedure     : item[4][1].split(":")[1].trim(),
            Description   : item[5][1].split(":")[1].trim(), 
            CreationDate  : new Date(item[6][1].split(":")[1].trim()),
            CreatedBy     : item[7][1].split(":")[1].trim(),
            TablesUpdated : item[8][1].split(":")[1].trim(),
        });
    }
} 
```

然后，您可以以更简洁的方式搜索数组：

```
var match = "Jane Doe";

for (var i = 0; i < sqlObjs.length; i++){
    var item = sqlObjs[i];

    if (item.CreatedBy == match){
        console.log(item.Procedure);
        break;
    }
} 
```

你的生活会少一些。:)

你可以在这里看到这个工作：http: [//jsfiddle.net/5fVqZ/1/](http://jsfiddle.net/5fVqZ/1/)

您可以实现一个简单的搜索来查找您要查找的项目的值，如下所示：

```
function getValue(byName, arry){
    var val = "";
    // this search assumes that the value will always be in the second position of the array
    for (var i = 0; i < arry.length; i++){
        var aVal = arry[i][1];

        if (aVal.indexOf(byName) == 0){ // only grab the value if byName is at the start of the string
            val = aVal.split(":")[1].trim();
            return val;
        }
    }
    return val;
} 
```

像这样使用：

```
for (var i = 0; i < createsql.length; i++){
    var item = createsql[i];     
    if (item.length != undefined && item.length > 1){
        sqlObjs.push({
            Procedure     : getValue("Procedure", item),
            Description   : getValue("Description", item), 
            CreationDate  : new Date(getValue("Creation Date", item)),
            CreatedBy     : getValue("Created By", item),
            TablesUpdated : getValue("Tables Updated", item),
        });
    }
} 
```

[http://jsfiddle.net/5fVqZ/3/](http://jsfiddle.net/5fVqZ/3/)

# http - 更正用于登录 API 的 http 动词

> ID：12373986
> 
> 赞同：21
> 
> 时间：2012-09-11T16:19:00.027
> 
> 标签：http, rest

在开发 RESTful API 来处理登录信息时，应该使用什么“正确的 HTTP 动词”？可以从各种设备/平台访问此 API - 移动应用程序、桌面 Web 应用程序、桌面原生应用程序等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-11T17:22:05.793

我假设 API 登录是指一种对 API 用户和对 API 端点的任何调用进行身份验证的方法。

您可能可以使用 OAuth 或基本身份验证来执行此操作，或者假设您有一个 API 端点位于`api\authenticate`. 调用者将`POST`使用用户 ID 和密码或一些 API 密钥访问此端点。然后，该服务将返回一个 cookie 或身份验证令牌，每次调用其他 API 端点时都会发送该令牌。[HP Cloud Identity 服务](https://api-docs.hpcloud.com/hpcloud-identity-service/1.0/content/authenticate.html)的工作方式几乎相同。

# html - 为什么 IE 不遵守我的列宽？

> ID：12373987
> 
> 赞同：-2
> 
> 时间：2012-09-11T16:19:04.393
> 
> 标签：html, internet-explorer, internet-explorer-8

这一直让我疯狂地试图解决

代码： http: [//pastebin.com/rqyw35jG](http://pastebin.com/rqyw35jG)

首先，我在标准模式下渲染。我在 IE 中有一个表格，宽度 = 100%，表格中的所有列都具有指定宽度，**除了**最后一列。IE 的预期行为是调整最后一列的大小，使其延伸到页面。这或多或少有效。然而;

某些情况似乎会破坏表格宽度并导致 IE 随意调整表格大小。

1.  该表包含一个跨所有列合并的行和
2.  此合并行包含足够的文本以填充整个单元格和
3.  足够的文本被输入到其列具有未指定宽度的单元格之一中，导致文本换行。

当这 3 个条件发生时，所有列都会轻微移动。文本仍然换行，除非您测量它们，或者将页面与没有换行文本的版本进行比较，否则您通常不会注意到列的大小错误。

这甚至应该在标准模式下发生吗？

代码：

```
<%@ Page Language="VB" %>
<%@ Import Namespace="Microsoft.SharePoint.Client" %>
<%@ Import namespace="System.Data" %> 
<%@ Import Namespace="System.Data.SQLClient" %>

<script runat="server">
    Protected Sub Page_Load(sender As Object, e As System.EventArgs)

    End Sub
</script>

<%

 %>

<!DOCTYPE html />
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
<table style="width:100%;">
    <tr>
        <td style="width:500px;">egqwgw gqgqwgqg qwgqgqg qgwgqgqg qwgqgg</td>
        <td style="width:500px;">gqgqwgqg gqwgqgqgq gqgqgqg qgg</td>
        <td>If too much text is entered into this column, the column sizes will begin to change. wehwehweh hwehwh whhwhwh hwehwhwh</td>
    </tr>
    <tr>
        <td>a gqwgqwg gqgqw </td><td>gqgqgqg gqgqg</td><td></td>
    </tr>
    <tr>
        <td colspan="3">Columns only move if text on this line is filling out the whole width of the page. gqwgqwggqg qgqgqwgqg qgqwgqgqg gqgwqgqg gqgqgqgqg qgqgqgqg gqgggqg 
            qgwgqgqg gqgqgqwgwg qgqwgqgqgq gqgwgwgqg gqgwgq gqwgwgqgqwg qgwgqgqgqwg 
            qwgqwgqgqg qgwgqgqqg gqwgqwgqwgwqg gqgwgqgwg qwgqwgqgqgq qwgqgqgqg gwqgqgqg 
            qggqwgqg qggwqgqg
        </td>
    </tr>
</table>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:37:05.930

您的文档类型错误，我不确定它是否将 IE 置于怪癖模式，但听起来像。删除空格和反斜杠：`<!DOCTYPE html>`

确保在 doctype 之前也没有显示任何代码，因为这会使 IE 陷入怪癖。

这是否适用于现代浏览器，还是 IE 是唯一给您带来问题的浏览器？

# mysql - 是否可以在MySql中封装一个表

> ID：12373989
> 
> 赞同：1
> 
> 时间：2012-09-11T16:19:17.690
> 
> 标签：mysql, permissions, grant

我是数据库新手。我希望数据库中的更新仅通过存储过程发生。最终用户没有**但**有`GRANT UPDATE`一个`GRANT EXECUTE ON PROCEDURE`.

我以这种方式尝试过，但发现最终用户需要获得`UPDATE`许可。有没有其他方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:32:16.077

根据[文档](http://dev.mysql.com/doc/refman/5.0/en/stored-programs-security.html)：

> 任何对 p1 具有 EXECUTE 权限的用户都可以使用 CALL 语句调用它。但是，当 p1 执行时，它是在 DEFINER 安全上下文中执行的，因此以 'admin'@'localhost' 的权限执行，该帐户在 DEFINER 属性中命名。此帐户必须具有 p1 的 EXECUTE 权限以及表 t1 的 UPDATE 权限。否则，该过程将失败。

因此，您应该能够将 DEFINER 设置为授权用户帐户，并且只让您的最终用户能够执行该过程。

# android - 在另一个 TextView android 上添加阅读更多 TextView

> ID：12373991
> 
> 赞同：1
> 
> 时间：2012-09-11T16:19:20.540
> 
> 标签：android, textview, onclicklistener

我想在现有的 TextView 上添加一个简单的“阅读更多”/“阅读更少”按钮，并结合另一个..

我这样做了：

```
 this.announcer_description = (TextView) findViewById(R.id.announcer_description);
    this.readmore = (TextView) findViewById(R.id.readmore);
    this.readmore.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                if (readmore.getText().equals("Read More"))
                {
                    announcer_description.setText("");
                    announcer_description.setText(currentAnnouncer.getDescription_fr());
                    readmore.setText("");
                    readmore.append("Read less");
                }
                else if (readmore.getText().equals("Read less"))
                {
                    announcer_description.setText("");
                    announcer_description.setText(shortDesc);
                    readmore.setText("");
                    readmore.append("Read more");
                }
            }}); 
```

我的“announcer_description”TextView 被初始化为“Read more”..但这不起作用..我发现使用 Read more 和 Read Less 的唯一方法是在这个 OnClickListener 中嵌套一些 OnClickListener ..

有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:31:39.633

根本`"Read More"`不等于`"Read more"`，存在大小写差异，因此您的代码永远不会执行。

您应该在 String 中设置不变的值，例如`"Read More"`，以帮助防止这些类型的错误，最好在`strings.xml`.

创建一个类范围的变量，将其设置为`onCreate()`：

```
String readMoreString;
...
readMoreString = getResources().getText(R.string.read_more); 
```

一个简化的 OnClickListener：

```
this.readmore.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
        if (readmore.getText().toString().equals(readMoreString))
        {
            announcer_description.setText(currentAnnouncer.getDescription_fr());
            readmore.setText(readLessString);
        }
        else 
        {
            announcer_description.setText(shortDesc);
            readmore.setText(readMoreString);
        }
    }
}); 
```

另请注意我如何删除对 的冗余调用`setText()`，您无需使用`setText("")`.

# sql - 如何解析列并向表中添加更多记录？

> ID：12373993
> 
> 赞同：0
> 
> 时间：2012-09-11T16:19:25.523
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures

我有表 tb1(col1, col2)，col2 是 varchar(50)。例如，

```
col1    col2
item1   abc
item2   a
item3   ed 
```

我想编写一个存储过程来解析 col2 并创建一个临时表，如下所示：

```
col1    col2
item1   a
item1   b
item1   c
item2   a
item3   e
item3   d 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T17:50:55.883

如果你知道字符串的最大长度，最简单的方法是做一个简单的联合：

```
select col1, substring(col2, 1, 1) as col2
from t
where len(col2) >= 1 union all
select col1, substring(col2, 2, 1) as col2
from t
where len(col2) >= 2 union all
select col1, substring(col2, 3, 1) as col2
from t
where len(col2) >= 3 union all 
```

如果长度永远不会太长，您可以执行以下操作来简化查询：

```
select col1, substring(col2, nums.seqnum) as col2
from t cross join
     (select row_number() over (order by (select NULL)) as seqnum
      from Infromation_Schema.columns
     ) nums
where len(col2) <= nums.seqnum 
```

或者，您可以在 T-SQL 中的 while 循环中执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:29:55.073

试试这个：

您可以使用单个查询来获取它

```
SELECT COL1,SUBSTRING(COL2,NUMBER+1,1) AS COL2
FROM   YOURTABLE T
JOIN   MASTER..SPT_VALUES M
ON     LEN(COL2)>NUMBER
WHERE  M.TYPE='P' 
```

# svn - Subversion 服务器（VisualSVN、CollabNet、uberSVN 等）的比较？

> ID：12373995
> 
> 赞同：13
> 
> 时间：2012-09-11T16:19:28.567
> 
> 标签：svn, visualsvn-server, visualsvn, collabnet, ubersvn

我正在帮助我的业务部门设置 Subversion 服务器，并且正在评估一些选项，例如 VisualSVN Server、CollabNet Subversion Edge 和 uberSVN。

我已经尝试过 VisualSVN Server 的基本版本，它看起来相当不错。我还尝试了 uberSVN，很快就看到[无法批量添加现有存储库](http://suggest.wandisco.com/suggestions/149/discover-repositories)是多么令人沮丧。

有没有人对各种 Subversion 服务器产品进行逐点比较？我还没有找到像[CI 特征矩阵](http://confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix)在比较持续集成服务器方面所做的那样史诗和全面的东西。

任何人都可以总结各种 Subversion 服务器之间的差异化功能吗？还是它们很大程度上取决于个人品味？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T18:17:12.967

免责声明：我管理 SVN Edge 项目，也是 Apache Subversion 项目的提交者。

我觉得主要是口味问题。

这三个都是免费的，但只有 SVN Edge 是开源的。

VisualSVN Server 仅在 Windows 服务器上运行，如果您想使用它，这不是问题。无论如何，因为它只在 Windows 上运行，所以可以说它的集成度更高。

SVN Edge 和 UberSVN 提供网页浏览界面，VisualSVN Server 提供微软管理控制台插件。

SVN Edge 有一个名为“发现存储库”的功能，它会自动添加您拥有的所有现有存储库。您只需将其指向包含您的存储库的文件夹。SVN Edge 也有一个 REST API，所以你可以编写脚本来做一些事情，比如添加存储库。

请记住，所有这三个主要是为了帮助您配置和管理服务器。您的用户与之交互的实际服务器是 Apache + Subversion。所以不管你走哪条路，都是颠覆。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T12:56:13.217

首先，我应该明确表示我为 uberSVN 背后的公司 WANdisco 工作。

我不知道提到的产品的比较文件（尽管如果有人想写一个我很乐意提供帮助）。

谈到 uberSVN 和 Collabnet Edge，您会发现在功能方面有很多相似之处。正如马克所说，除了一些功能之外，这可能是个人品味的问题。

我们在 UI 上做了很多工作，试图让它尽可能简单和流畅，所以希望那里没有太多遗漏（如果有的话，我很乐意接受反馈）。@David W 请注意，Edge 现在也有一个 Web 前端。

功能方面的 uberSVN 具有更深入的 LDAP 和授权功能。您还可以获得 svn:// 支持、在 Subversion 1.6.x 和 1.7.x 之间切换的能力，以及设置 DAV 位置的能力。有一些付费应用程序也可以根据需要向 uberSVN 添加一系列 ALM 功能，而无需安装全新的产品（对于 Edge，我认为有些事情你必须走 Teamforge 路线） .

Edge 有一些 uberSVN 还没有的功能，比如一次添加多个 repo 和自动计划备份的能力。

Edge 也是这三个产品中唯一的开源产品，尽管我们计划在不久的将来某个时候发布一个 SDK，这将在一定程度上增加 uberSVN 的可定制性。

VisualSVN 对我来说很痛苦，因为您在免费版本中没有远程管理员，而且它只是 Windows。不过，如果这些对您来说不是问题，那么它又归结为个人品味。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-11T18:50:16.760

这是基本的：

*   这三个基本上都是 Subversion 编译的，可以与 Apache httpd 和所有必需的资源一起使用。我相信他们也都具有 LDAP 配置能力，但您必须为此支付额外费用。
*   uberSVN 和 VisualSVN 为 Subversion 维护和 Apache 配置提供前端。您可以设置团队并浏览您的存储库。
*   UberSVN 和 VisualSVN 都有各种各样的奖励铃。例如，UberSVN 有某种“社交”前端，它允许您对提交评论之外的文件进行推文评论。Wandisco 向我承认，这并不是一个真正被大量使用的功能。
*   这三者都将在各个层面提供支持。你付钱给他们，他们就是你的支持猴子。你付给他们的钱越多，他们就会做的越多。

CollabNet 没有 GUI 前端。您自己破解配置文件。它确实将 ViewVC 作为存储库 Web 浏览器，但无论如何我更喜欢 Sventon。我发现 Sventon 比 ViewVC 更快，并且它与更多第三方工具的集成更好。另外，我不必在我的 Subversion 服务器上运行它。说实话，大多数开发人员无论如何都不会使用 Web 界面。它主要用于在 Jira 或 Jenkins 中显示源代码。

我个人的偏好是 CollabNet。我不喜欢 VisualSVN 和 UberSVN 提供的前端。我是一个技术含量很高的人，我发现这些前端不断修改我所做的更改。但是，如果您没有技术专长，并且不想拿起它。~~你为什么是配置经理？进金融什么~~的。我的意思是，VisualSVN 和 UberSVN 提供的前端可能适合你。我真的看不出他们之间有太大的区别。主要问题是在安装后支持 Wandisco 或 VisualSVN Limited。

我发现设置 Apache httpd 或 Subversion 存储库并不令人生畏。`svnadmin create`创建您的存储库。Apache httpd 配置在[Subversion 在线手册](http://svnbook.com)中有详细记录。我从 Stackoverflow 和各种电子邮件列表中获得的支持比大多数付费支持要好。一旦你完成了所有设置，你无论如何都很少碰它。

但是，如果您需要一个 GUI，我会说它真的没有那么大的区别。我不知道 VisualSVNServer 是否适用于 Linux，所以这可能是个问题。但是，一旦您设置了所有内容，前端就没有多大用处。我想说你想用谁作为支持可能是一个比管理前端更重要的问题。

# windows - 在 Windows 中安装自动更新应用程序的正确方法是什么？

> ID：12373997
> 
> 赞同：0
> 
> 时间：2012-09-11T16:19:39.743
> 
> 标签：windows, installation

我正在向现有应用程序（通过 exe4j 启动的 java）添加自动更新功能。对于管理员来说一切正常，但非管理员将没有对已安装目录 ( `c:\program files\myApp`) 的写入权限。

我提出的所有解决方案都感觉有点邪恶，所以我想我会在这里问。以下是我到目前为止的想法：

*   授予每个人对我的程序安装目录（例如`c:\program files\myApp\bin`）中子目录的写入权限。
*   只安装一个小的boostrap到程序文件，其余的安装到用户家中（可能在AppData下）。这意味着每个用户都将拥有大部分应用程序的副本。
*   在用户的主目录中安装整个应用程序

处理这个问题的最正确/最不邪恶的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T16:46:29.230

I think the best way would be installing your app in **%userprofile%\AppData\Local**

If your app isn't very large, that's your best option. For example this is the way Google Chrome works.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T06:31:09.350

您的所有想法都有一个安全问题：任何人都可以轻松更改程序文件。谷歌浏览器也有同样的安全问题：恶意软件更容易修改其文件。

我绝对不建议更改`C:\Program Files\myApp\bin`.

如果你想防止重复，你可以使用`C:\ProgramData`，它对权限不那么严格，`Program Files`但具有相同的安全风险。

因此，如果您关心用户的安全，您应该将应用程序安装到`Program Files`. 因此，您可以得到系统保护，防止文件被无意修改。

您的更新程序应用程序在将新文件写入`Program Files`. 缺点是用户必须在 UAC 提示中单击*继续按钮。*如果更新相当少，这是最简单的方法。Mozilla Firefox 曾经使用这种方法：浏览器下载更新，在下次启动时显示 UAC 确认并将更新的文件写入`Program Files`.

最近 Firefox 改变了它的更新体验。他们安装了处理更新的服务。这样用户就不会被 UAC 确认所困扰，一切对他们来说都是透明的。他们启动 Firefox，如果有更新，则启动服务，因为该服务以系统权限运行，它对 Program Files 具有写入权限，更新文件，然后启动更新 Firefox，然后关闭服务（直到下一个更新）。

我更喜欢 Firefox 的方法：它的文件受到文件系统权限的保护，不会被无意修改。同时，现在它默默更新；在他们实施更新服务之前，我不介意每三个月在 UAC 提示中按一次*继续。*

# spring-security - Spring Security 角色层次结构不起作用

> ID：12373998
> 
> 赞同：1
> 
> 时间：2012-09-11T16:19:46.377
> 
> 标签：spring-security

我正在尝试使用 Spring Security 来保护使用角色层次结构的方法。显然，由于我在这里发帖，所以它不起作用。

首先，这是一个接口的定义：

```
@PreAuthorize("isFullyAuthenticated()")
List<RetainUser> getByLocation(String location); 
```

接下来，这是我试图用来测试它的单元测试：

```
@Test
public void getByLocation_anonymousUser_throwsAccessDeniedException() {

    AppUser anonymousUser = (AppUser) retainUserManager.loadUserByUsername("1111");

    Authentication auth = provider.authenticate(new PreAuthenticatedAuthenticationToken(anonymousUser, new AppAuthority(anonymousUser, "ROLE_ANONYMOUS")));
    SecurityContext context = new SecurityContextImpl();
    context.setAuthentication(auth);

    SecurityContextHolder.setContext(context);

    try {
        List<AppUser> testResult = appUserManager.getByLocation("DAYTON");
        fail("call by anonymous user should have thrown AccessDeniedException");
    } catch (AccessDeniedException ex) {
        System.out.println(ex.getMessage());
    }
} 
```

最后，我的 security.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:security="http://www.springframework.org/schema/security"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans 
          http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
          http://www.springframework.org/schema/security 
          http://www.springframework.org/schema/security/spring-security-3.1.xsd">

<security:global-method-security pre-post-annotations="enabled">
    <security:expression-handler ref="methodSecurityExpressionHandler"/>
</security:global-method-security>

<bean id="expressionHandler" class="org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler">
    <property name="roleHierarchy" ref="roleHierarchy" />
</bean>

<bean id="methodSecurityExpressionHandler" class="org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler">
    <property name="roleHierarchy" ref="roleHierarchy" />
</bean>

<!-- In order to use a role hierarchy with the Security expressions, the 
    hierarchy needs to be injected into the expression handler -->

<!-- Configure static resources to have no Spring Security filters applied 
    to them -->
<security:http pattern="/common/**" security="none" />
<security:http pattern="/**/*.png" security="none" />
<security:http pattern="/styles/**/*.css" security="none" />
<security:http pattern="/**/*.css" security="none" />
<security:http pattern="/**/*.js" security="none" />
<security:http pattern="/login.jsp" security="none" />

<security:http use-expressions="true" access-denied-page="/accountWizard.html"
    access-decision-manager-ref="accessDecisionManager">

    <security:anonymous />
    <security:x509 subject-principal-regex="CN=(.*?)," user-service-ref="retainUserManager" />
        <!-- Role Anonymous needs to be able to hit the index controller in order to be -->
        <!-- redirected to the account wizard (if necessary) -->
        <security:intercept-url pattern="/index.html*" access="hasRole('ROLE_ANONYMOUS')" />
        <security:intercept-url pattern="/**/acceptTerms.html*" access="hasRole('ROLE_ANONYMOUS')" />
        <security:intercept-url pattern="/**/accountWizardHome.html*" access="hasRole('ROLE_ANONYMOUS')"/>
        <security:intercept-url pattern="/**/accountPending.html*" access="hasRole('ROLE_ANONYMOUS')"/>
        <!-- Since roles are hierarchal, ROLE_FIELD and above are legal -->
        <security:intercept-url pattern="/**/*.html" access="hasRole('ROLE_FIELD')" />
    <security:session-management>
        <security:concurrency-control
            max-sessions="1" error-if-maximum-exceeded="false" />
    </security:session-management>
</security:http>

<security:authentication-manager alias="authenticationManager">
    <security:authentication-provider
        user-service-ref="appUserManager" />
</security:authentication-manager>

<bean id="accessDecisionManager" class="org.springframework.security.access.vote.AffirmativeBased">
    <property name="decisionVoters">
        <list>
            <ref bean="webExpressionVoter" />
            <ref bean="roleHierarchyVoter" />
        </list>
    </property>
</bean>

<bean id="webExpressionVoter" class="org.springframework.security.web.access.expression.WebExpressionVoter">
    <property name="expressionHandler">
        <bean
            class="org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler">
            <property name="roleHierarchy" ref="roleHierarchy" />
        </bean>
    </property>
</bean>

<bean id="roleHierarchyVoter"
    class="org.springframework.security.access.vote.RoleHierarchyVoter">
    <constructor-arg ref="roleHierarchy" />
</bean>

<bean id="roleHierarchy"
    class="org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl">
    <property name="hierarchy">
        <value>
            ROLE_SYSTEM > ROLE_MANAGER
            ROLE_MANAGER > ROLE_FIELD
            ROLE_FIELD > ROLE_ANONYMOUS
        </value>
    </property>
</bean>

<bean id="exceptionTranslationFilter"
    class="org.springframework.security.web.access.ExceptionTranslationFilter">
    <property name="authenticationEntryPoint" ref="authenticationEntryPoint" />
    <property name="accessDeniedHandler" ref="accessDeniedHandler" />
</bean>

<bean id="authenticationEntryPoint"
    class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">
    <property name="loginFormUrl" value="/login.jsp" />
    <property name="forceHttps" value="true" />
</bean>

<bean id="accessDeniedHandler"
    class="org.springframework.security.web.access.AccessDeniedHandlerImpl">
    <property name="errorPage" value="/403.jsp" />
</bean> 
```

在上面的测试中，我期待一个 AccessDeniedException，因为表达式是“hasRole('ROLE_FIELD')”，它高于 ROLE_ANONYMOUS。不幸的是，没有抛出异常。

任何人都可以帮忙吗？